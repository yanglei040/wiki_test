{"hands_on_practices": [{"introduction": "A cornerstone of the Local Density Approximation (LDA) is that the exchange-correlation potential at a point $\\mathbf{r}$ depends only on the electron density $n(\\mathbf{r})$ at that same point. This exercise provides fundamental practice in deriving the LDA exchange potential $v_x^{\\text{LDA}}$ from its corresponding energy density. By applying the derived potential to a simple, spatially varying electron density, you will analytically explore the non-linear relationship between density and potential, uncovering the phenomenon of harmonic generation that is characteristic of local functionals [@problem_id:3450841].", "problem": "In Density Functional Theory (DFT), the Local Density Approximation (LDA) models the exchange energy of an inhomogeneous electron system by approximating it locally with the exchange energy per particle of the homogeneous electron gas. Consider the exchange energy per particle of the homogeneous electron gas given by $e_{x}(n)=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$, where $n$ is the electron density. The exchange energy functional is $E_{x}[n]=\\int n(\\mathbf{r})\\,e_{x}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$, and the LDA exchange potential is defined as $v_{x}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{x}[n]}{\\delta n(\\mathbf{r})}$. \n\nStarting from these definitions and the given $e_{x}(n)$, perform the following:\n- Derive the explicit local expression $v_{x}^{\\text{LDA}}(n)$ as a function of $n$ by carrying out the functional derivative from first principles.\n- Evaluate $v_{x}^{\\text{LDA}}(\\mathbf{r})$ for the inhomogeneous one-dimensional modulation $n(\\mathbf{r})=n_{0}\\left[1+\\alpha\\cos(kx)\\right]$, where $n_{0}>0$, $|\\alpha|\\ll 1$, and $k>0$, by expanding in powers of $\\alpha$ up to and including terms of order $\\alpha^{2}$. Rewrite any powers of $\\cos(kx)$ using trigonometric identities to express the result in terms of $\\cos(kx)$ and $\\cos(2kx)$, and collect terms to expose harmonic generation in $v_{x}^{\\text{LDA}}$.\n\nProvide your final answer as a single closed-form analytic expression for $v_{x}^{\\text{LDA}}(\\mathbf{r})$ up to order $\\alpha^{2}$. No rounding is required, and no units should be included in the final expression.", "solution": "The problem statement is found to be scientifically grounded, well-posed, objective, and complete. It is a standard exercise in applying the fundamental principles of Density Functional Theory (DFT), specifically the Local Density Approximation (LDA). All provided definitions and expressions are correct and standard in the field. Therefore, the problem is valid, and a solution will be provided.\n\nThe problem is divided into two parts. The first part is to derive the general expression for the LDA exchange potential, $v_{x}^{\\text{LDA}}(n)$, as a function of the electron density $n$. The second part is to apply this result to a specific spatially varying density $n(\\mathbf{r})$ and find the resulting potential up to the second order in the modulation amplitude $\\alpha$.\n\nPart 1: Derivation of the LDA Exchange Potential $v_{x}^{\\text{LDA}}(n)$\n\nThe exchange energy functional in the LDA is given by\n$$E_{x}[n]=\\int n(\\mathbf{r})\\,e_{x}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$$\nwhere $e_{x}(n)$ is the exchange energy per particle of a homogeneous electron gas with density $n$. The problem provides the expression for $e_{x}(n)$:\n$$e_{x}(n)=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$$\nFor convenience, we define a constant $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$, so that $e_{x}(n) = -C_{x}n^{1/3}$.\nSubstituting this into the functional for $E_{x}[n]$, we obtain:\n$$E_{x}[n]=\\int n(\\mathbf{r})\\left(-C_{x}\\left(n(\\mathbf{r})\\right)^{1/3}\\right)d^{3}\\mathbf{r} = -C_{x}\\int \\left(n(\\mathbf{r})\\right)^{4/3}d^{3}\\mathbf{r}$$\nThe integrand is a local function of the density, of the form $f(n(\\mathbf{r})) = -C_{x}(n(\\mathbf{r}))^{4/3}$. The LDA exchange potential, $v_{x}^{\\text{LDA}}(\\mathbf{r})$, is defined as the functional derivative of the exchange energy functional with respect to the density:\n$$v_{x}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{x}[n]}{\\delta n(\\mathbf{r})}$$\nFor a local functional of the form $F[n] = \\int f(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$, the functional derivative is given by the ordinary derivative of the integrand's density dependence:\n$$\\frac{\\delta F[n]}{\\delta n(\\mathbf{r})} = \\frac{d f(n)}{dn}\\bigg|_{n=n(\\mathbf{r})}$$\nApplying this rule to our exchange functional $E_{x}[n]$:\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = \\frac{d}{dn}\\left(-C_{x}n^{4/3}\\right)\\bigg|_{n=n(\\mathbf{r})} = -C_{x}\\frac{d}{dn}\\left(n^{4/3}\\right)\\bigg|_{n=n(\\mathbf{r})}$$\nPerforming the differentiation gives:\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -C_{x}\\left(\\frac{4}{3}n^{1/3}\\right)\\bigg|_{n=n(\\mathbf{r})} = -\\frac{4}{3}C_{x}\\left(n(\\mathbf{r})\\right)^{1/3}$$\nThis gives the exchange potential as a local function of the density. Substituting the constant $C_{x}$ back in:\n$$v_{x}^{\\text{LDA}}(n) = -\\frac{4}{3}\\left(\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\right)n^{1/3} = -\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$$\nThis is the general expression for the LDA exchange potential as a function of the local electron density $n$.\n\nPart 2: Evaluation for $n(\\mathbf{r})=n_{0}\\left[1+\\alpha\\cos(kx)\\right]$\n\nWe are given the one-dimensional density modulation:\n$$n(\\mathbf{r}) = n(x) = n_{0}\\left[1+\\alpha\\cos(kx)\\right]$$\nwith $n_{0}>0$, $k>0$, and the perturbation amplitude $|\\alpha| \\ll 1$. We need to evaluate $v_{x}^{\\text{LDA}}(\\mathbf{r})$ using the expression derived in Part 1, expanding the result in powers of $\\alpha$ up to order $\\alpha^{2}$.\n\nSubstituting $n(\\mathbf{r})$ into the expression for $v_{x}^{\\text{LDA}}(n)$:\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(n(\\mathbf{r})\\right)^{1/3} = -\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(n_{0}\\left[1+\\alpha\\cos(kx)\\right]\\right)^{1/3}$$\nWe can separate the constant part:\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3}\\left[1+\\alpha\\cos(kx)\\right]^{1/3}$$\nSince $|\\alpha| \\ll 1$, we can perform a Taylor expansion of the term $\\left[1+\\alpha\\cos(kx)\\right]^{1/3}$. Let $u = \\alpha\\cos(kx)$. We use the binomial expansion for $(1+u)^{p}$ up to the second order in $u$:\n$$(1+u)^{p} \\approx 1 + pu + \\frac{p(p-1)}{2!}u^{2} + O(u^{3})$$\nIn our case, the exponent is $p = 1/3$. The coefficients are:\n- Zeroth order: $1$\n- First order: $p = 1/3$\n- Second order: $\\frac{p(p-1)}{2} = \\frac{(1/3)(1/3 - 1)}{2} = \\frac{(1/3)(-2/3)}{2} = -\\frac{1}{9}$\nSubstituting these coefficients and $u = \\alpha\\cos(kx)$, we get:\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx 1 + \\frac{1}{3}\\left(\\alpha\\cos(kx)\\right) - \\frac{1}{9}\\left(\\alpha\\cos(kx)\\right)^{2}$$\n$$ = 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{9}\\alpha^{2}\\cos^{2}(kx)$$\nThe problem requires the result to be expressed in terms of $\\cos(kx)$ and $\\cos(2kx)$. We use the trigonometric identity $\\cos^{2}(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$. Applying this to $\\cos^{2}(kx)$:\n$$\\cos^{2}(kx) = \\frac{1+\\cos(2kx)}{2}$$\nSubstituting this into our expansion:\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{9}\\alpha^{2}\\left(\\frac{1+\\cos(2kx)}{2}\\right)$$\n$$ = 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2} - \\frac{1}{18}\\alpha^{2}\\cos(2kx)$$\nNow, we collect the terms: a constant (zeroth harmonic), a term with $\\cos(kx)$ (fundamental harmonic), and a term with $\\cos(2kx)$ (second harmonic).\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx \\left(1 - \\frac{1}{18}\\alpha^{2}\\right) + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx)$$\nFinally, we substitute this expanded form back into the expression for $v_{x}^{\\text{LDA}}(\\mathbf{r})$:\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3} \\left[ \\left(1 - \\frac{1}{18}\\alpha^{2}\\right) + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx) \\right]$$\nThis is the final expression for the LDA exchange potential for the given density modulation, expanded to second order in $\\alpha$, demonstrating the generation of a second harmonic.", "answer": "$$ \\boxed{-\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3} \\left(1 - \\frac{1}{18}\\alpha^{2} + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx)\\right)} $$", "id": "3450841"}, {"introduction": "While the LDA provides a powerful and efficient computational framework, it is an approximation with known systematic deficiencies. Perhaps its most famous conceptual failure is the self-interaction error (SIE), where a single electron spuriously interacts with its own electrostatic field and exchange-correlation hole. This hands-on computational exercise tasks you with quantifying this error for the canonical case of a single electron in a harmonic trap [@problem_id:3450830]. By implementing the calculation of the Hartree and LDA exchange-correlation energies, you will directly observe how this unphysical self-interaction manifests and how its magnitude changes with the spatial confinement of the electron.", "problem": "Consider a single electron in a three-dimensional isotropic harmonic trap with angular frequency $\\omega$ in atomic units, where the electron mass $m=1$ and the reduced Planck constant $\\hbar=1$. The ground-state wavefunction is the normalized Gaussian\n$$\n\\psi(\\mathbf{r})=\\left(\\frac{\\alpha}{\\pi}\\right)^{3/4}\\exp\\left(-\\frac{\\alpha r^2}{2}\\right),\n$$\nand the corresponding electron density is\n$$\nn(\\mathbf{r})=\\left|\\psi(\\mathbf{r})\\right|^2=\\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp\\left(-\\alpha r^2\\right),\n$$\nwith $\\alpha\\equiv\\omega$. Using this density, compute the self-interaction error\n$$\nE_{\\text{SIE}}[n]=E_{\\text{H}}[n]+E_{xc}^{\\text{LDA}}[n],\n$$\nwhere $E_{\\text{H}}[n]$ is the Hartree energy and $E_{xc}^{\\text{LDA}}[n]$ is the exchange-correlation energy in the Local Density Approximation (LDA).\n\nStart from the following foundational definitions and facts:\n\n1. The Hartree energy functional is\n$$\nE_{\\text{H}}[n]=\\frac{1}{2}\\int d^3\\mathbf{r}\\int d^3\\mathbf{r}'\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|}.\n$$\n\n2. For a fully spin-polarized system ($n_\\uparrow=n, n_\\downarrow=0$), the Local Spin Density Approximation (LSDA) exchange energy is\n$$\nE_{x}^{\\text{LSDA}}[n]=-\\frac{3}{4}\\left(\\frac{6}{\\pi}\\right)^{1/3}\\int d^3\\mathbf{r}\\,n(\\mathbf{r})^{4/3}.\n$$\nFor a single electron, assume full spin polarization so that $n_\\uparrow(\\mathbf{r})=n(\\mathbf{r})$ and $n_\\downarrow(\\mathbf{r})=0$.\n\n3. The correlation energy in LSDA is given by\n$$\nE_{c}^{\\text{LSDA}}[n_\\uparrow,n_\\downarrow]=\\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\,\\varepsilon_c\\!\\left(r_s(\\mathbf{r}),\\zeta\\right),\n$$\nwhere the Wigner–Seitz radius is $r_s(\\mathbf{r})=\\left(\\frac{3}{4\\pi n(\\mathbf{r})}\\right)^{1/3}$ and the spin polarization is $\\zeta=\\frac{n_\\uparrow-n_\\downarrow}{n_\\uparrow+n_\\downarrow}$. For a single electron, take $\\zeta=1$. Use the Perdew–Zunger 1981 (PZ81) parameterization for the correlation energy per electron $\\varepsilon_c(r_s,\\zeta)$ for the fully spin-polarized case ($\\zeta=1$), namely:\n- For $r_s<1$,\n$$\n\\varepsilon_c(r_s,1)=A_p\\ln r_s + B_p + C_p r_s \\ln r_s + D_p r_s,\n$$\n- For $r_s\\ge 1$,\n$$\n\\varepsilon_c(r_s,1)=\\frac{\\gamma_p}{1+\\beta_{1p}\\sqrt{r_s}+\\beta_{2p}r_s},\n$$\nwith constants\n$$\nA_p=0.01555,\\quad B_p=-0.0269,\\quad C_p=0.0007,\\quad D_p=-0.0048,\n$$\n$$\n\\gamma_p=-0.0843,\\quad \\beta_{1p}=1.3981,\\quad \\beta_{2p}=0.2611.\n$$\n\nYour task is to implement a program that, for each specified value of $\\omega$, constructs $n(\\mathbf{r})$ and computes\n$$\nE_{\\text{SIE}}(\\omega)=E_{\\text{H}}[n]+E_{x}^{\\text{LSDA}}[n]+E_{c}^{\\text{LSDA}}[n],\n$$\nexpressed in Hartree (atomic units).\n\nTo ensure numerical robustness, exploit spherical symmetry where appropriate and use a stable numerical integration method for the correlation part. You may perform analytic simplifications when they follow from the above foundational definitions, but do not introduce any nonstandard approximations.\n\nPhysical units: Report all energies in Hartree. The final output must list the computed values as floats.\n\nTest suite:\n- Case 1: $\\omega=0.01$,\n- Case 2: $\\omega=0.10$,\n- Case 3: $\\omega=1.00$,\n- Case 4: $\\omega=5.00$,\n- Case 5: $\\omega=20.00$,\n- Case 6: $\\omega=50.00$.\n\nFinal output format:\nYour program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5,result6]\").", "solution": "The user-provided problem is valid as it is scientifically grounded in density functional theory, mathematically well-posed, and provides all necessary information for a unique solution.\n\nOur objective is to compute the self-interaction error, $E_{\\text{SIE}}$, for a single-electron system described by a Gaussian density. The self-interaction error is defined as the sum of the Hartree energy, $E_{\\text{H}}$, and the local density approximation (LDA) to the exchange-correlation energy, $E_{xc}^{\\text{LDA}}$. For a one-electron system, the exact exchange-correlation functional must precisely cancel the spurious Hartree self-interaction, leading to a total self-interaction energy of zero. The calculated $E_{\\text{SIE}}$ therefore quantifies the error of the LDA for this system.\n\nThe total self-interaction error is given by:\n$$\nE_{\\text{SIE}}(\\omega) = E_{\\text{H}}[n] + E_{x}^{\\text{LSDA}}[n] + E_{c}^{\\text{LSDA}}[n]\n$$\nThe electron density, $n(\\mathbf{r})$, for an electron in a $3$D isotropic harmonic trap with angular frequency $\\omega$ is given as:\n$$\nn(\\mathbf{r}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp\\left(-\\alpha r^2\\right)\n$$\nwhere $\\alpha \\equiv \\omega$ and $r = \\left\\|\\mathbf{r}\\right\\|$. The density is normalized such that $\\int n(\\mathbf{r}) d^3\\mathbf{r} = 1$. The calculation of each energy component is addressed below.\n\n**1. Hartree Energy, $E_{\\text{H}}[n]$**\n\nThe Hartree energy represents the classical electrostatic self-energy of the charge distribution $n(\\mathbf{r})$:\n$$\nE_{\\text{H}}[n]=\\frac{1}{2}\\int d^3\\mathbf{r}\\int d^3\\mathbf{r}'\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|}\n$$\nFor a spherically symmetric Gaussian charge distribution, this integral has a well-known analytical solution. First, we compute the electrostatic potential $\\phi(r)$ generated by the density $n(r)$:\n$$\n\\phi(r) = \\int d^3\\mathbf{r}' \\frac{n(r')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|} = \\frac{\\text{erf}(\\sqrt{\\alpha}r)}{r}\n$$\nwhere $\\text{erf}(x)$ is the error function. The Hartree energy is then:\n$$\nE_{\\text{H}}[n] = \\frac{1}{2} \\int n(\\mathbf{r}) \\phi(\\mathbf{r}) d^3\\mathbf{r} = \\frac{1}{2} \\int_0^\\infty 4\\pi r^2 dr \\, \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2} \\frac{\\text{erf}(\\sqrt{\\alpha}r)}{r}\n$$\nThis integral evaluates to:\n$$\nE_{\\text{H}}[n] = \\sqrt{\\frac{\\alpha}{2\\pi}}\n$$\nSince $\\alpha = \\omega$, the Hartree energy is $E_{\\text{H}} = \\sqrt{\\frac{\\omega}{2\\pi}}$.\n\n**2. Exchange Energy, $E_{x}^{\\text{LSDA}}[n]$**\n\nFor a single, fully spin-polarized electron, the LSDA exchange energy functional is:\n$$\nE_{x}^{\\text{LSDA}}[n] = -\\frac{3}{4}\\left(\\frac{6}{\\pi}\\right)^{1/3}\\int d^3\\mathbf{r}\\,n(\\mathbf{r})^{4/3}\n$$\nWe substitute the Gaussian density into this expression:\n$$\nn(\\mathbf{r})^{4/3} = \\left[\\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2}\\right]^{4/3} = \\left(\\frac{\\alpha}{\\pi}\\right)^2 e^{-\\frac{4\\alpha}{3} r^2}\n$$\nThe integral over all space becomes:\n$$\n\\int n(\\mathbf{r})^{4/3} d^3\\mathbf{r} = 4\\pi \\left(\\frac{\\alpha}{\\pi}\\right)^2 \\int_0^\\infty r^2 e^{-\\frac{4\\alpha}{3} r^2} dr\n$$\nThis is a standard Gaussian integral, which evaluates to $\\frac{\\sqrt{\\pi}}{4(4\\alpha/3)^{3/2}}$. The full integral is then $\\frac{3\\sqrt{3}}{8\\sqrt{\\pi}}\\sqrt{\\alpha}$.\nSubstituting this back into the expression for $E_{x}^{\\text{LSDA}}[n]$ yields the analytical result:\n$$\nE_{x}^{\\text{LSDA}}[n] = -\\frac{3^{17/6} \\cdot 2^{1/3}}{32 \\pi^{5/6}} \\sqrt{\\omega}\n$$\n\n**3. Correlation Energy, $E_{c}^{\\text{LSDA}}[n]$**\n\nThe correlation energy is given by an integral that must be evaluated numerically:\n$$\nE_{c}^{\\text{LSDA}}[n]=\\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\,\\varepsilon_c(r_s(\\mathbf{r}),1) = \\int_0^\\infty 4\\pi r^2 n(r) \\varepsilon_c(r_s(r),1) dr\n$$\nThe Wigner-Seitz radius $r_s$ depends on the local density $n(r)$:\n$$\nr_s(r) = \\left(\\frac{3}{4\\pi n(r)}\\right)^{1/3} = \\left(\\frac{3}{4\\pi} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{\\alpha r^2}\\right)^{1/3} = \\left(\\frac{3 \\pi^{1/2}}{4 \\alpha^{3/2}}\\right)^{1/3} e^{\\alpha r^2/3}\n$$\nThe correlation energy per particle, $\\varepsilon_c(r_s,1)$, is given by the Perdew-Zunger 1981 (PZ81) parameterization, which is a piecewise function depending on whether $r_s < 1$ (high-density regime) or $r_s \\ge 1$ (low-density regime).\n\nThe condition $r_s(r)=1$ defines a transition radius $r_t$. $r_s(r)$ is a monotonically increasing function of $r$. Its minimum value occurs at $r=0$. The value of $r_s(0)$ depends on $\\alpha$:\n$$\nr_s(0) = \\left(\\frac{3 \\pi^{1/2}}{4 \\alpha^{3/2}}\\right)^{1/3}\n$$\nA critical value of $\\alpha$, denoted $\\alpha_{\\text{crit}}$, exists where $r_s(0)=1$:\n$$\n\\alpha_{\\text{crit}} = \\left(\\frac{3\\sqrt{\\pi}}{4}\\right)^{2/3} \\approx 1.2106\n$$\n- If $\\omega = \\alpha \\le \\alpha_{\\text{crit}}$, then $r_s(r) \\ge 1$ for all $r \\ge 0$. The entire integration domain uses the low-density ($r_s \\ge 1$) formula for $\\varepsilon_c$.\n- If $\\omega = \\alpha > \\alpha_{\\text{crit}}$, then $r_s(r)$ crosses the value $1$ at a specific radius $r_t$. The integral must be split into two parts. The transition radius $r_t$ is found by solving $r_s(r_t)=1$:\n$$\nr_t = \\sqrt{\\frac{1}{\\alpha} \\ln\\left(\\frac{4 \\alpha^{3/2}}{3 \\pi^{1/2}}\\right)}\n$$\nFor $\\alpha > \\alpha_{\\text{crit}}$, the correlation energy is computed as:\n$$\nE_c = \\int_0^{r_t} 4\\pi r^2 n(r) \\varepsilon_c(r_s<1) dr + \\int_{r_t}^{\\infty} 4\\pi r^2 n(r) \\varepsilon_c(r_s\\ge1) dr\n$$\n\n**Numerical Algorithm**\nThe overall algorithm is as follows:\n1. For each given value of $\\omega$, set $\\alpha = \\omega$.\n2. Analytically calculate $E_{\\text{H}}$ and $E_{x}^{\\text{LSDA}}$ using their derived dependencies on $\\sqrt{\\omega}$.\n3. For $E_{c}^{\\text{LSDA}}$, determine if $\\alpha \\le \\alpha_{\\text{crit}}$ or $\\alpha > \\alpha_{\\text{crit}}$.\n4. Based on this condition, set up the appropriate numerical integral(s) for $E_c$ using the corresponding PZ81 formula(s). The integrals are efficiently computed using a quadrature method like `scipy.integrate.quad`. The infinite integration domain is truncated at a value $r_{\\text{max}}$ where the Gaussian density $n(r)$ becomes negligible (e.g., $\\alpha r_{\\text{max}}^2 \\approx 30$).\n5. Sum the three energy components: $E_{\\text{SIE}} = E_{\\text{H}} + E_{x}^{\\text{LSDA}} + E_{c}^{\\text{LSDA}}$.\n\nThis procedure provides a robust and accurate value for the self-interaction error for each specified frequency $\\omega$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the self-interaction error for a single electron in a 3D harmonic trap\n    using the Local Density Approximation (LDA) for exchange-correlation.\n    \"\"\"\n    \n    # Define the constants for the PZ81 correlation functional (spin-polarized case, zeta=1)\n    # High-density regime (rs < 1)\n    AP = 0.01555\n    BP = -0.0269\n    CP = 0.0007\n    DP = -0.0048\n    # Low-density regime (rs >= 1)\n    GAMMA_P = -0.0843\n    BETA_1P = 1.3981\n    BETA_2P = 0.2611\n\n    def calculate_sie(omega):\n        \"\"\"\n        Calculates E_SIE for a given angular frequency omega.\n        \"\"\"\n        alpha = float(omega)\n\n        # 1. Hartree Energy (analytical result)\n        # E_H = sqrt(alpha / (2*pi))\n        e_h = np.sqrt(alpha / (2 * np.pi))\n\n        # 2. Exchange Energy (analytical result for LSDA, spin-polarized)\n        # E_x = - (3**(17/6) * 2**(1/3)) / (32 * pi**(5/6)) * sqrt(alpha)\n        exch_coeff = (3**(17/6) * 2**(1/3)) / (32 * np.pi**(5/6))\n        e_x = -exch_coeff * np.sqrt(alpha)\n\n        # 3. Correlation Energy (numerical integration)\n        # Define helper functions for the integrand\n        def n_func(r, a):\n            # Electron density n(r)\n            return (a / np.pi)**1.5 * np.exp(-a * r**2)\n\n        def rs_func_direct(r, a):\n            # Wigner-Seitz radius r_s(r)\n            # This form is numerically stable and avoids underflow of n(r)\n            return ((3 * np.sqrt(np.pi)) / (4 * a**1.5))**(1/3) * np.exp(a * r**2 / 3)\n        \n        # Determine if the integral needs to be split\n        alpha_crit = (3 * np.sqrt(np.pi) / 4)**(2/3) # ~1.2106\n\n        e_c = 0.0\n        # The integration upper bound can be truncated as the Gaussian decays rapidly.\n        # A limit where alpha * r^2 = 35 is sufficient for double precision.\n        r_max_integration = np.sqrt(35 / alpha)\n\n        if alpha <= alpha_crit:\n            # For small alpha, rs >= 1 for all r. Use only the low-density formula.\n            def ec_integrand_low(r, a):\n                rs = rs_func_direct(r, a)\n                n_r = n_func(r, a)\n                eps_c = GAMMA_P / (1 + BETA_1P * np.sqrt(rs) + BETA_2P * rs)\n                return 4 * np.pi * r**2 * n_r * eps_c\n            \n            e_c, _ = integrate.quad(ec_integrand_low, 0, r_max_integration, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n        else:\n            # For large alpha, rs crosses 1. Split the integral at r_t.\n            r_t = np.sqrt((1/alpha) * np.log( (4 * alpha**1.5) / (3 * np.sqrt(np.pi)) ))\n\n            # Integrand for high-density regime (rs < 1)\n            def ec_integrand_high(r, a):\n                rs = rs_func_direct(r, a)\n                # rs can be very small, so log(rs) might be an issue, but quad handles it.\n                if rs == 0: return 0.0\n                n_r = n_func(r, a)\n                eps_c = AP * np.log(rs) + BP + CP * rs * np.log(rs) + DP * rs\n                return 4 * np.pi * r**2 * n_r * eps_c\n\n            # Integrand for low-density regime (rs >= 1)\n            def ec_integrand_low(r, a):\n                rs = rs_func_direct(r, a)\n                n_r = n_func(r, a)\n                eps_c = GAMMA_P / (1 + BETA_1P * np.sqrt(rs) + BETA_2P * rs)\n                return 4 * np.pi * r**2 * n_r * eps_c\n\n            # Part 1: Integral from 0 to r_t (high-density)\n            e_c1, _ = integrate.quad(ec_integrand_high, 0, r_t, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n            \n            # Part 2: Integral from r_t to infinity (low-density)\n            e_c2, _ = integrate.quad(ec_integrand_low, r_t, r_max_integration, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n\n            e_c = e_c1 + e_c2\n\n        # Total Self-Interaction Error\n        return e_h + e_x + e_c\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.01, 0.10, 1.00, 5.00, 20.00, 50.00]\n\n    results = []\n    for omega_val in test_cases:\n        result = calculate_sie(omega_val)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3450830"}, {"introduction": "To build a deeper understanding of an approximation's accuracy, it is invaluable to benchmark it against a known exact result. This practice moves from the one-electron case to a simple but non-trivial two-electron system, where the exact exchange energy has a simple, known form. Your task is to derive analytical expressions for both the exact and LDA exchange energies and potentials for this system [@problem_id:3450757]. By calculating quantitative error metrics, you will not only measure the degree of inaccuracy in LDA but also discover how these errors behave as a function of the system's confinement, revealing fundamental insights into the systematic nature of the approximation.", "problem": "Consider a two-electron spin-singlet system in three spatial dimensions confined by an isotropic harmonic potential of angular frequency $\\omega$ (atomic units: electron mass, elementary charge, reduced Planck constant, and $4\\pi\\varepsilon_0$ are set to $1$). The ground-state Kohn–Sham spatial orbital is the harmonic oscillator ground state, which yields a spherically symmetric electron density\n$$\nn_{\\omega}(r) = 2 \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2}, \\quad \\text{with } \\alpha = \\omega,\n$$\nand total electron number $N=2$. For any spin-singlet two-electron density, the exact exchange energy equals minus one-half of the Hartree (classical Coulomb) energy, and the exact exchange potential equals minus one-half of the Hartree potential:\n$$\nE_{x}^{\\text{exact}}[n] = -\\frac{1}{2} E_{H}[n], \\quad v_{x}^{\\text{exact}}(\\mathbf{r}) = -\\frac{1}{2} v_{H}(\\mathbf{r}).\n$$\nUse the following fundamental definitions and standard results as your starting point:\n- The Hartree energy is\n$$\nE_{H}[n] = \\frac{1}{2} \\int \\int \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} \\, d^3 r \\, d^3 r'.\n$$\n- In the Local Density Approximation (LDA) for the uniform electron gas in a spin-unpolarized system, the exchange energy density per volume is\n$$\ne_{x}^{\\text{LDA}}(n) = - C_{F} \\, n^{4/3}, \\quad \\text{with } C_{F} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3},\n$$\nand the LDA exchange potential is the functional derivative\n$$\nv_{x}^{\\text{LDA}}(n) = \\frac{\\partial e_{x}^{\\text{LDA}}(n)}{\\partial n} = -\\frac{4}{3} C_{F} \\, n^{1/3}.\n$$\n- The Hartree potential is\n$$\nv_{H}(\\mathbf{r}) = \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} \\, d^3 r'.\n$$\nTask. Derive analytic formulas for $E_{x}^{\\text{exact}}(\\omega)$, $E_{x}^{\\text{LDA}}(\\omega)$, $v_{x}^{\\text{exact}}(r;\\omega)$, and $v_{x}^{\\text{LDA}}(r;\\omega)$ for the Gaussian density $n_{\\omega}(r)$ given above. Then, for each test value of $\\omega$ listed below, compute three benchmarks:\n1. The relative exchange energy error\n$$\n\\delta_E(\\omega) = \\frac{E_{x}^{\\text{LDA}}(\\omega) - E_{x}^{\\text{exact}}(\\omega)}{\\left|E_{x}^{\\text{exact}}(\\omega)\\right|}.\n$$\nThis is dimensionless.\n2. The pointwise exchange potential error at the origin\n$$\n\\Delta v_0(\\omega) = v_{x}^{\\text{LDA}}(0;\\omega) - v_{x}^{\\text{exact}}(0;\\omega),\n$$\nexpressed in Hartrees.\n3. The density-weighted $L^2$ relative error of the exchange potential over all space,\n$$\n\\delta_{v}^{(2)}(\\omega) = \n\\left(\n\\frac{\\int \\left[v_{x}^{\\text{LDA}}(\\mathbf{r};\\omega) - v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)\\right]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}{\\int \\left[v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)\\right]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}\n\\right)^{1/2},\n$$\nwhich is dimensionless.\n\nYou must carry out the derivations from the above base definitions and facts. Express all energies and potentials in Hartrees and all lengths in Bohr radii.\n\nRequired test suite. Use the following four confinement strengths (atomic units): $\\omega \\in \\{0.05,\\,0.5,\\,2.0,\\,8.0\\}$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list corresponding to one $\\omega$ in the order given, with the three values $[\\delta_E(\\omega), \\Delta v_0(\\omega), \\delta_{v}^{(2)}(\\omega)]$ in that order. The line must have no spaces. For example: \"[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33],[x41,x42,x43]]\".", "solution": "The problem requires the derivation of exact and Local Density Approximation (LDA) exchange energies and potentials for a two-electron system with a Gaussian density, followed by the computation of three error metrics for specified confinement strengths $\\omega$.\n\nThe electron density for the two-electron spin-singlet system is given as:\n$$\nn_{\\omega}(r) = 2 \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2}, \\quad \\text{with } \\alpha = \\omega\n$$\nThe total number of electrons is $N=\\int n_{\\omega}(\\mathbf{r}) d^3r = 2$.\n\n**1. Derivation of Exact Exchange Quantities**\n\nThe problem states that for a two-electron spin-singlet system, the exact exchange energy $E_{x}^{\\text{exact}}$ and potential $v_{x}^{\\text{exact}}$ are directly related to the Hartree energy $E_{H}$ and potential $v_{H}$:\n$$\nE_{x}^{\\text{exact}}[n] = -\\frac{1}{2} E_{H}[n], \\quad v_{x}^{\\text{exact}}(\\mathbf{r}) = -\\frac{1}{2} v_{H}(\\mathbf{r})\n$$\nOur first task is to compute $E_{H}$ and $v_{H}$ for the given density $n_{\\omega}(r)$.\n\n**Hartree Potential, $v_{H}(\\mathbf{r})$**\nThe Hartree potential is the electrostatic potential generated by the charge distribution $n(\\mathbf{r})$:\n$$\nv_{H}(\\mathbf{r}) = \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} \\, d^3 r'\n$$\nFor a spherically symmetric Gaussian charge distribution with total charge $N$, $n(r) = N (\\frac{\\alpha}{\\pi})^{3/2} e^{-\\alpha r^2}$, the potential at a distance $r$ from the origin is a standard result from electrostatics:\n$$\nv_{H}(r) = \\frac{N}{r} \\text{erf}(\\sqrt{\\alpha}r)\n$$\nwhere $\\text{erf}(x)$ is the error function. Given $N=2$ and $\\alpha=\\omega$, we have:\n$$\nv_{H}(r;\\omega) = \\frac{2}{r} \\text{erf}(\\sqrt{\\omega}r)\n$$\nThe exact exchange potential is therefore:\n$$\nv_{x}^{\\text{exact}}(r;\\omega) = -\\frac{1}{2} v_{H}(r;\\omega) = -\\frac{1}{r} \\text{erf}(\\sqrt{\\omega}r)\n$$\n\n**Hartree Energy, $E_{H}[n]$**\nThe Hartree energy is the self-interaction energy of the density $n(\\mathbf{r})$:\n$$\nE_{H}[n] = \\frac{1}{2} \\int n(\\mathbf{r}) v_{H}(\\mathbf{r}) \\, d^3 r\n$$\nSubstituting the expressions for $n_{\\omega}(r)$ and $v_{H}(r;\\omega)$:\n$$\nE_{H}(\\omega) = \\frac{1}{2} \\int_{0}^{\\infty} \\left(2 \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} e^{-\\omega r^2}\\right) \\left(\\frac{2}{r} \\text{erf}(\\sqrt{\\omega}r)\\right) 4\\pi r^2 \\, dr\n$$\n$$\nE_{H}(\\omega) = 8\\pi \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} \\int_{0}^{\\infty} r e^{-\\omega r^2} \\text{erf}(\\sqrt{\\omega}r) \\, dr\n$$\nLet's perform a change of variables with $u = \\sqrt{\\omega}r$, so $r = u/\\sqrt{\\omega}$ and $dr = du/\\sqrt{\\omega}$.\n$$\nE_{H}(\\omega) = 8\\pi \\frac{\\omega^{3/2}}{\\pi^{3/2}} \\int_{0}^{\\infty} \\left(\\frac{u}{\\sqrt{\\omega}}\\right) e^{-u^2} \\text{erf}(u) \\left(\\frac{du}{\\sqrt{\\omega}}\\right) = \\frac{8\\sqrt{\\omega}}{\\sqrt{\\pi}} \\int_{0}^{\\infty} u e^{-u^2} \\text{erf}(u) \\, du\n$$\nThe definite integral $\\int_{0}^{\\infty} u e^{-u^2} \\text{erf}(u) \\, du$ can be solved using integration by parts, yielding $1/(2\\sqrt{2})$.\n$$\nE_{H}(\\omega) = \\frac{8\\sqrt{\\omega}}{\\sqrt{\\pi}} \\left(\\frac{1}{2\\sqrt{2}}\\right) = \\frac{4\\sqrt{\\omega}}{\\sqrt{2\\pi}} = 2\\sqrt{\\frac{2\\omega}{\\pi}}\n$$\nThe exact exchange energy is then:\n$$\nE_{x}^{\\text{exact}}(\\omega) = -\\frac{1}{2} E_{H}(\\omega) = -\\sqrt{\\frac{2\\omega}{\\pi}}\n$$\n\n**2. Derivation of LDA Exchange Quantities**\n\n**LDA Exchange Potential, $v_{x}^{\\text{LDA}}(r;\\omega)$**\nThe LDA exchange potential for a spin-unpolarized system is given by:\n$$\nv_{x}^{\\text{LDA}}(n) = -\\frac{4}{3} C_{F} \\, n^{1/3}, \\quad \\text{with } C_{F} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\nFirst, we find $n_{\\omega}(r)^{1/3}$:\n$$\nn_{\\omega}(r)^{1/3} = \\left(2 \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} e^{-\\omega r^2}\\right)^{1/3} = 2^{1/3} \\left(\\frac{\\omega}{\\pi}\\right)^{1/2} e^{-\\frac{\\omega r^2}{3}}\n$$\nSubstituting this into the expression for $v_{x}^{\\text{LDA}}$:\n$$\nv_{x}^{\\text{LDA}}(r;\\omega) = -\\frac{4}{3} \\left(\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\right) 2^{1/3} \\left(\\frac{\\omega}{\\pi}\\right)^{1/2} e^{-\\frac{\\omega r^2}{3}}\n$$\n$$\nv_{x}^{\\text{LDA}}(r;\\omega) = -\\left(\\frac{3}{\\pi}\\right)^{1/3} 2^{1/3} \\sqrt{\\frac{\\omega}{\\pi}} e^{-\\frac{\\omega r^2}{3}} = -\\left(\\frac{6}{\\pi}\\right)^{1/3} \\sqrt{\\frac{\\omega}{\\pi}} e^{-\\frac{\\omega r^2}{3}}\n$$\n\n**LDA Exchange Energy, $E_{x}^{\\text{LDA}}(\\omega)$**\nThe LDA exchange energy is the integral of the exchange energy density:\n$$\nE_{x}^{\\text{LDA}}(\\omega) = \\int e_{x}^{\\text{LDA}}(n_{\\omega}(\\mathbf{r})) \\, d^3 r = \\int -C_{F} n_{\\omega}(\\mathbf{r})^{4/3} \\, d^3 r\n$$\nWe can relate this to the potential via $e_{x}^{\\text{LDA}} = \\frac{3}{4} n v_{x}^{\\text{LDA}}$.\n$$\nE_{x}^{\\text{LDA}}(\\omega) = \\frac{3}{4} \\int n_{\\omega}(\\mathbf{r}) v_{x}^{\\text{LDA}}(\\mathbf{r}) \\, d^3 r\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = \\frac{3}{4} \\int_0^\\infty \\left(2 \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} e^{-\\omega r^2}\\right) \\left(-\\left(\\frac{6}{\\pi}\\right)^{1/3} \\sqrt{\\frac{\\omega}{\\pi}} e^{-\\frac{\\omega r^2}{3}}\\right) 4\\pi r^2 \\,dr\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -\\frac{3}{4} \\cdot 8\\pi \\cdot \\left(\\frac{\\omega}{\\pi}\\right)^2 \\left(\\frac{6}{\\pi}\\right)^{1/3} \\int_0^\\infty r^2 e^{-(\\omega + \\omega/3)r^2} \\,dr\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -6\\pi \\frac{\\omega^2}{\\pi^2} \\left(\\frac{6}{\\pi}\\right)^{1/3} \\int_0^\\infty r^2 e^{-\\frac{4\\omega}{3}r^2} \\,dr\n$$\nUsing the standard Gaussian integral $\\int_0^\\infty x^2 e^{-ax^2}dx = \\frac{\\sqrt{\\pi}}{4a^{3/2}}$ with $a = 4\\omega/3$:\n$$\n\\int_0^\\infty r^2 e^{-\\frac{4\\omega}{3}r^2} \\,dr = \\frac{\\sqrt{\\pi}}{4(4\\omega/3)^{3/2}} = \\frac{\\sqrt{\\pi}}{4 \\cdot 8/(3\\sqrt{3}) \\cdot \\omega^{3/2}} = \\frac{3\\sqrt{3\\pi}}{32\\omega^{3/2}}\n$$\nSubstituting this back:\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -6 \\frac{\\omega^2}{\\pi} \\left(\\frac{6}{\\pi}\\right)^{1/3} \\frac{3\\sqrt{3\\pi}}{32\\omega^{3/2}} = -\\frac{18\\sqrt{3}}{32} \\frac{\\sqrt{\\omega}}{\\sqrt{\\pi}} \\left(\\frac{6}{\\pi}\\right)^{1/3}\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -\\frac{9\\sqrt{3}}{16} \\frac{6^{1/3}}{\\pi^{1/3}} \\frac{\\sqrt{\\omega}}{\\pi^{1/2}} = -\\frac{9\\sqrt{3} \\cdot 6^{1/3}}{16\\pi^{5/6}} \\sqrt{\\omega}\n$$\n\n**3. Calculation of Benchmarks**\n\n**1. Relative Exchange Energy Error, $\\delta_E(\\omega)$**\nThe relative error is defined as:\n$$\n\\delta_E(\\omega) = \\frac{E_{x}^{\\text{LDA}}(\\omega) - E_{x}^{\\text{exact}}(\\omega)}{\\left|E_{x}^{\\text{exact}}(\\omega)\\right|}\n$$\nSince both energies are negative, $|E_{x}^{\\text{exact}}(\\omega)| = -E_{x}^{\\text{exact}}(\\omega)$. The error becomes:\n$$\n\\delta_E(\\omega) = \\frac{E_{x}^{\\text{LDA}}(\\omega)}{-E_{x}^{\\text{exact}}(\\omega)} - 1 = 1 - \\frac{E_{x}^{\\text{LDA}}(\\omega)}{E_{x}^{\\text{exact}}(\\omega)}\n$$\nSince both energy terms scale with $\\sqrt{\\omega}$, this factor cancels out, making $\\delta_E$ a constant independent of $\\omega$:\n$$\n\\delta_E = 1 - \\frac{-\\frac{9\\sqrt{3} \\cdot 6^{1/3}}{16\\pi^{5/6}}}{-\\sqrt{2/\\pi}} = 1 - \\frac{9\\sqrt{3} \\cdot 6^{1/3}}{16\\pi^{5/6}} \\sqrt{\\frac{\\pi}{2}} = 1 - \\frac{9}{16} \\left(\\frac{243}{2\\pi^2}\\right)^{1/6}\n$$\n\n**2. Pointwise Potential Error at Origin, $\\Delta v_0(\\omega)$**\nWe need the potentials at $r=0$. For $v_{x}^{\\text{exact}}$, we take the limit $r \\to 0$:\n$$\n\\lim_{r\\to 0} v_{x}^{\\text{exact}}(r;\\omega) = \\lim_{r\\to 0} -\\frac{1}{r} \\text{erf}(\\sqrt{\\omega}r)\n$$\nUsing the Taylor series $\\text{erf}(x) \\approx \\frac{2}{\\sqrt{\\pi}}x$ for small $x$:\n$$\nv_{x}^{\\text{exact}}(0;\\omega) = \\lim_{r\\to 0} -\\frac{1}{r} \\left(\\frac{2}{\\sqrt{\\pi}}\\sqrt{\\omega}r\\right) = -2\\sqrt{\\frac{\\omega}{\\pi}}\n$$\nFor $v_{x}^{\\text{LDA}}(r;\\omega)$, we set $r=0$:\n$$\nv_{x}^{\\text{LDA}}(0;\\omega) = -\\left(\\frac{6}{\\pi}\\right)^{1/3} \\sqrt{\\frac{\\omega}{\\pi}}\n$$\nThe error is:\n$$\n\\Delta v_0(\\omega) = v_{x}^{\\text{LDA}}(0;\\omega) - v_{x}^{\\text{exact}}(0;\\omega) = \\left(2 - \\left(\\frac{6}{\\pi}\\right)^{1/3}\\right) \\sqrt{\\frac{\\omega}{\\pi}}\n$$\n\n**3. Weighted $L^2$ Relative Potential Error, $\\delta_{v}^{(2)}(\\omega)$**\n$$\n\\delta_{v}^{(2)}(\\omega)^2 = \n\\frac{\\int [v_{x}^{\\text{LDA}}(\\mathbf{r};\\omega) - v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}{\\int [v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}\n$$\nWe perform a change of variables $u = \\sqrt{\\omega}r$. The volume element becomes $n_{\\omega}(r)d^3r = \\frac{8}{\\sqrt{\\pi}} u^2 e^{-u^2}du$. The potentials become:\n$v_{x}^{\\text{exact}}(r) = -\\frac{\\sqrt{\\omega}}{u}\\text{erf}(u) = \\sqrt{\\omega} V_{\\text{exact}}(u)$\n$v_{x}^{\\text{LDA}}(r) = -\\left(\\frac{6}{\\pi}\\right)^{1/3} \\frac{\\sqrt{\\omega}}{\\sqrt{\\pi}} e^{-u^2/3} = \\sqrt{\\omega} V_{\\text{LDA}}(u)$\nThe factor $\\sqrt{\\omega}^2 = \\omega$ appears in both the numerator and denominator integrals and thus cancels. Therefore, $\\delta_{v}^{(2)}$ is also a constant, independent of $\\omega$.\n$$\n\\delta_{v}^{(2)2} = \\frac{\\int_0^\\infty [V_{\\text{LDA}}(u) - V_{\\text{exact}}(u)]^2 u^2 e^{-u^2} \\, du}{\\int_0^\\infty [V_{\\text{exact}}(u)]^2 u^2 e^{-u^2} \\, du}\n$$\nThe integrands become:\nNumerator: $(-C u e^{-u^2/3} + \\text{erf}(u))^2 e^{-u^2}$, with $C = \\frac{(6/\\pi)^{1/3}}{\\sqrt{\\pi}}$.\nDenominator: $(\\text{erf}(u))^2 e^{-u^2}$.\nThese definite integrals are computed numerically.\n\nThe final formulas are implemented in the Python code below.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes benchmarks for the Local Density Approximation (LDA) applied to a \n    two-electron system in a harmonic potential.\n\n    The problem requires calculating three error metrics for the exchange energy and potential:\n    1. delta_E: Relative exchange energy error.\n    2. Delta v_0: Pointwise exchange potential error at the origin.\n    3. delta_v^(2): Density-weighted L^2 relative error of the exchange potential.\n\n    Based on the derivations in the solution text, delta_E and delta_v^(2) are fundamental\n    constants independent of the confinement strength omega, while Delta v_0 scales with sqrt(omega).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases_omega = [0.05, 0.5, 2.0, 8.0]\n\n    # Use high-precision value of pi\n    pi = np.pi\n\n    # --- Pre-calculate constant benchmarks ---\n\n    # 1. Calculate delta_E (constant)\n    # delta_E = 1 - (E_x^LDA / E_x^exact)\n    # E_x^LDA / E_x^exact = (9/16) * (243 / (2 * pi^2))^(1/6)\n    k_ratio = (9/16) * (243 / (2 * pi**2))**(1/6)\n    delta_E = 1.0 - k_ratio\n\n    # 3. Calculate delta_v^(2) (constant)\n    # This requires numerical integration of two definite integrals, I_num and I_den.\n    # delta_v^(2) = sqrt(I_num / I_den)\n\n    # Constant C in the numerator's integrand\n    # C = ( (6/pi)^(1/3) ) / sqrt(pi)\n    const_v_lda = (6/pi)**(1/3) / np.sqrt(pi)\n\n    def integrand_num(u):\n        \"\"\"Integrand for the numerator of delta_v^(2)^2.\"\"\"\n        # This form avoids division by u at u=0.\n        # [V_LDA(u) - V_exact(u)]^2 * u^2 = [-C * u * exp(-u^2/3) + erf(u)]^2\n        term1 = -const_v_lda * u * np.exp(-u**2 / 3)\n        term2 = erf(u)\n        return (term1 + term2)**2 * np.exp(-u**2)\n\n    def integrand_den(u):\n        \"\"\"Integrand for the denominator of delta_v^(2)^2.\"\"\"\n        # [V_exact(u)]^2 * u^2 = erf(u)^2\n        return erf(u)**2 * np.exp(-u**2)\n    \n    # Perform numerical integration from 0 to infinity.\n    # The integration returns a tuple (result, error_estimate). We only need the result.\n    I_num, _ = quad(integrand_num, 0, np.inf)\n    I_den, _ = quad(integrand_den, 0, np.inf)\n    \n    delta_v_sq = np.sqrt(I_num / I_den)\n    \n    # --- Compute benchmarks for each omega ---\n    \n    results = []\n    for omega in test_cases_omega:\n        # 2. Calculate Delta v_0(omega)\n        # Delta v_0(w) = (2 - (6/pi)^(1/3)) * sqrt(w/pi)\n        dv0_const = 2.0 - (6/pi)**(1/3)\n        delta_v0 = dv0_const * np.sqrt(omega / pi)\n        \n        # Assemble the results for the current omega\n        current_result = [delta_E, delta_v0, delta_v_sq]\n        results.append(current_result)\n\n    # Format the final output as a single string with no spaces as required.\n    # e.g., \"[[x11,x12,x13],[x21,x22,x23],...]\"\n    output_str = \"[\" + \",\".join([\"[\" + \",\".join(map(str, res)) + \"]\" for res in results]) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "3450757"}]}