{"hands_on_practices": [{"introduction": "Calculating the properties of point defects is a fundamental application of atomistic potentials. This first practice guides you through computing the vacancy formation energy, $E_f^{\\mathrm{vac}}$, a crucial parameter governing material behavior at finite temperatures [@problem_id:3448369]. By directly implementing the EAM energy expressions for perfect and defective supercells, you will gain hands-on experience with periodic boundary conditions and also investigate how the curvature of the embedding function, $F(\\rho)$, influences this key defect property.", "problem": "You are asked to implement a program that computes the vacancy formation energy in a face-centered cubic crystal using the Embedded Atom Method (EAM) at fixed volume, and to probe quantitatively how the result depends on the curvature of the embedding function. The program must evaluate the total energy for a perfect supercell with $N$ atoms and for the same supercell volume with a single atom removed (that is, $N-1$ atoms), and then compute the vacancy formation energy as a well-defined difference between these two energies. You must use only the definitions of the EAM model and basic geometric and periodic boundary conditions, without invoking any shortcut formulas.\n\nUse the following fundamental base in your derivation and implementation:\n- The total energy of a configuration of $N$ atoms at positions $\\{\\mathbf{r}_i\\}_{i=1}^N$ in the Embedded Atom Method (EAM) is\n$$\nE = \\sum_{ij} \\phi(r_{ij}) + \\sum_{i=1}^N F(\\rho_i),\n$$\nwhere $r_{ij} = \\lVert \\mathbf{r}_i - \\mathbf{r}_j \\rVert$ (with periodic boundary conditions and minimum image convention), $\\phi(r)$ is a pair interaction, $\\rho_i = \\sum_{j \\neq i} f(r_{ij})$ is an effective scalar electron density at atom $i$, and $F(\\rho)$ is the embedding energy. Interactions are truncated beyond a finite cutoff distance $r_c$.\n- The vacancy formation energy at fixed volume is defined as\n$$\nE_f^{\\mathrm{vac}} = E_{N-1}^{\\mathrm{vac}} - \\frac{N-1}{N} E_N^{\\mathrm{perf}},\n$$\nwhere $E_N^{\\mathrm{perf}}$ is the total energy of the perfect cell of $N$ atoms and $E_{N-1}^{\\mathrm{vac}}$ is the total energy of the same cell volume with one atom removed.\n\nImplement the model with the following physically plausible and self-consistent specifications:\n- Lattice and geometry:\n  - Use a face-centered cubic (fcc) lattice with cubic supercells of size $n \\times n \\times n$ conventional cells. The conventional cell has $4$ atoms at fractional positions $(0,0,0)$, $(0,\\tfrac{1}{2},\\tfrac{1}{2})$, $(\\tfrac{1}{2},0,\\tfrac{1}{2})$, $(\\tfrac{1}{2},\\tfrac{1}{2},0)$.\n  - The lattice parameter is $a_{\\mathrm{lat}} = 3.615$ Angstroms, and the cubic simulation box has side length $L = n \\, a_{\\mathrm{lat}}$ with periodic boundary conditions.\n  - Remove the atom whose position is closest to the box center $(\\tfrac{L}{2}, \\tfrac{L}{2}, \\tfrac{L}{2})$ to create a single vacancy while keeping the volume fixed.\n- Interaction functions:\n  - Pair potential (Morse form):\n  $$\n  \\phi(r) = D_e \\left[\\left(1 - e^{-a_m (r - r_e)}\\right)^2 - 1\\right], \\quad \\text{for } r \\le r_c,\n  $$\n  and $\\phi(r) = 0$ for $r  r_c$.\n  - Electron density contribution:\n  $$\n  f(r) = p_0 \\, e^{-\\beta (r - r_0)}, \\quad \\text{for } r \\le r_c,\n  $$\n  and $f(r) = 0$ for $r  r_c$.\n  - Embedding function with tunable curvature:\n  $$\n  F(\\rho) = A \\sqrt{\\max(\\rho, \\epsilon)} + \\frac{B}{2} \\left(\\rho - \\rho_{\\mathrm{ref}}\\right)^2.\n  $$\n  Here $\\epsilon$ is a small positive number to avoid evaluating the square root at zero, and $\\rho_{\\mathrm{ref}}$ is the average scalar density in the perfect configuration at the given parameter set, that is,\n  $$\n  \\rho_{\\mathrm{ref}} = \\frac{1}{N} \\sum_{i=1}^N \\rho_i^{\\mathrm{perf}}.\n  $$\n- Fixed parameters common to all test cases:\n  - $a_{\\mathrm{lat}} = 3.615$ Angstroms.\n  - $r_c = 6.000$ Angstroms.\n  - Morse parameters: $D_e = 0.150$ electronvolts, $a_m = 1.500$ inverse Angstroms, $r_e = \\frac{a_{\\mathrm{lat}}}{\\sqrt{2}}$ Angstroms.\n  - Density parameters: $p_0 = 1.000$ (dimensionless), $\\beta = 1.800$ inverse Angstroms, $r_0 = r_e$ Angstroms.\n  - Numerical parameter: $\\epsilon = 10^{-12}$ (dimensionless).\n- Variable parameters per test case:\n  - Supercell size $n \\in \\{2, 4\\}$.\n  - Embedding parameters $A$ and $B$ in electronvolts, where $A  0$ and $B \\ge 0$. Varying $B$ controls the curvature near $\\rho_{\\mathrm{ref}}$ and thus probes sensitivity as requested.\n\nTasks to implement:\n- For each test case, construct the $n \\times n \\times n$ fcc supercell with periodic boundary conditions and compute $E_N^{\\mathrm{perf}}$ using the definitions above, with interactions truncated at $r_c$.\n- Compute $\\rho_{\\mathrm{ref}}$ from the perfect configuration and hold it fixed when evaluating $E_{N-1}^{\\mathrm{vac}}$ for the defective configuration at the same volume.\n- Remove the atom closest to the box center to form a single vacancy and compute $E_{N-1}^{\\mathrm{vac}}$.\n- Compute the vacancy formation energy $E_f^{\\mathrm{vac}}$ using the definition above.\n- Express all energies in electronvolts, and report the final numbers rounded to six decimal places.\n\nProvide results for the following test suite of parameter sets:\n- Case $1$: $n = 4$, $A = -2.000$, $B = 0.000$.\n- Case $2$: $n = 4$, $A = -2.000$, $B = 0.500$.\n- Case $3$: $n = 4$, $A = -2.000$, $B = 2.000$.\n- Case $4$ (finite-size edge case): $n = 2$, $A = -2.000$, $B = 0.500$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4]$, where each $x_k$ is the vacancy formation energy in electronvolts for case $k$, rounded to six decimal places. No other text should be printed. Angles are not used. Distances are in Angstroms, and energies are in electronvolts.", "solution": "We proceed from the definition of the Embedded Atom Method (EAM) energy and the vacancy formation energy at fixed volume. The EAM energy for a configuration of $N$ atoms is\n$$\nE = \\sum_{ij} \\phi(r_{ij}) + \\sum_{i=1}^N F(\\rho_i),\n$$\nwhere $r_{ij} = \\lVert \\mathbf{r}_i - \\mathbf{r}_j \\rVert$ is computed under periodic boundary conditions using the minimum image convention, and $\\rho_i = \\sum_{j \\ne i} f(r_{ij})$ is the effective scalar electron density accumulated at site $i$ from other atoms within the cutoff $r_c$. The pair potential $\\phi(r)$ models screened two-body interactions, the function $f(r)$ models the electron density contribution, and $F(\\rho)$ is the energy to embed an atom into a host electron density. These are well-established components in the EAM formalism. Crucially, the vacancy formation energy at fixed volume is defined thermodynamically as\n$$\nE_f^{\\mathrm{vac}} = E_{N-1}^{\\mathrm{vac}} - \\frac{N-1}{N} E_N^{\\mathrm{perf}},\n$$\nwhich removes the contribution of the missing atom at the host chemical potential in the reference state, consistent with canonical fixed-volume conditions.\n\nAlgorithmic design based on first principles and definitions:\n- Geometry and periodic boundary conditions: Build an $n \\times n \\times n$ face-centered cubic (fcc) supercell with lattice parameter $a_{\\mathrm{lat}}$. The conventional fcc cell has $4$ atoms at fractional positions $(0,0,0)$, $(0,\\tfrac{1}{2},\\tfrac{1}{2})$, $(\\tfrac{1}{2},0,\\tfrac{1}{2})$, $(\\tfrac{1}{2},\\tfrac{1}{2},0)$. The absolute position of an atom in cell indices $(i,j,k)$ with fractional basis $\\mathbf{s}$ is $\\mathbf{r} = a_{\\mathrm{lat}} \\, (i,j,k + \\mathbf{s})$ within a cubic box of side length $L = n \\, a_{\\mathrm{lat}}$. Periodic boundary conditions are enforced by the minimum image convention. For two atoms at positions $\\mathbf{r}_i$ and $\\mathbf{r}_j$, define $\\Delta \\mathbf{r} = \\mathbf{r}_i - \\mathbf{r}_j$, then apply componentwise wrapping as $\\Delta \\mathbf{r} \\leftarrow \\Delta \\mathbf{r} - L \\, \\mathrm{round}(\\Delta \\mathbf{r}/L)$ before computing $r_{ij} = \\lVert \\Delta \\mathbf{r} \\rVert$.\n- Interaction truncation: Only include contributions where $r_{ij} \\le r_c$, consistent with a finite support for the potentials.\n- Energetics: The pair energy is evaluated by summing $\\phi(r_{ij})$ over $ij$ to avoid double-counting. The density at atom $i$ is $\\rho_i = \\sum_{j \\ne i, \\, r_{ij} \\le r_c} f(r_{ij})$. The embedding energy is $F(\\rho_i)$ and summed over $i$.\n- Reference density for curvature analysis: Define $\\rho_{\\mathrm{ref}}$ as the average of $\\rho_i$ in the perfect configuration for the given parameter set, $\\rho_{\\mathrm{ref}} = \\frac{1}{N}\\sum_{i=1}^N \\rho_i^{\\mathrm{perf}}$, and hold this reference fixed when evaluating the defective configuration energy. This isolates the effect of local density deficits around the vacancy without shifting the reference between the two states.\n- Vacancy construction: Remove the atom nearest to the box center $(\\tfrac{L}{2}, \\tfrac{L}{2}, \\tfrac{L}{2})$ to form a single vacancy at fixed volume and recompute the energy using the same potential parameters and $\\rho_{\\mathrm{ref}}$.\n\nSensitivity to the curvature of the embedding function:\n- The embedding function is $F(\\rho) = A \\sqrt{\\max(\\rho, \\epsilon)} + \\frac{B}{2}(\\rho - \\rho_{\\mathrm{ref}})^2$. Its curvature is captured by the second derivative with respect to $\\rho$:\n$$\nF'(\\rho) = \\frac{A}{2 \\sqrt{\\max(\\rho,\\epsilon)}} + B (\\rho - \\rho_{\\mathrm{ref}}),\n\\quad\nF''(\\rho) = -\\frac{A}{4 \\left(\\max(\\rho,\\epsilon)\\right)^{3/2}} + B.\n$$\nNear $\\rho \\approx \\rho_{\\mathrm{ref}}$ and for sufficiently large $\\rho$ such that $\\epsilon$ is negligible, the curvature is approximately $F''(\\rho_{\\mathrm{ref}}) \\approx -\\frac{A}{4 \\rho_{\\mathrm{ref}}^{3/2}} + B$. Since $A  0$, the first term is positive, but varying $B$ provides a direct linear handle on the curvature.\n- Consider the local density changes $\\delta \\rho_i$ induced by a vacancy, predominantly negative for atoms adjacent to the vacant site. A second-order Taylor expansion around the perfect-state densities gives the leading change in embedding energy near the vacancy as\n$$\n\\Delta E_{\\mathrm{emb}} \\approx \\sum_{i} \\left[ F'(\\rho_i^{\\mathrm{perf}}) \\, \\delta \\rho_i + \\frac{1}{2} F''(\\rho_i^{\\mathrm{perf}}) \\, (\\delta \\rho_i)^2 \\right].\n$$\nThe linear term partly cancels when summed over shells because the missing atom reduces the density locally and the system has no long-range density bias at fixed volume. The quadratic term, however, is strictly nonnegative and weighted by $F''(\\rho)$; hence, increasing the curvature $F''$ systematically increases the vacancy formation energy. In our parameterization, increasing $B$ directly increases $F''$ and should therefore increase $E_f^{\\mathrm{vac}}$ in the computed results.\n\nNumerical implementation details:\n- Use the Morse pair potential with parameters $D_e = 0.150$ electronvolts, $a_m = 1.500$ inverse Angstroms, and $r_e = a_{\\mathrm{lat}} / \\sqrt{2}$ Angstroms to align the well with the nearest-neighbor distance. This yields a physically reasonable short-range repulsion and an attractive tail.\n- Use the exponential density contribution $f(r) = p_0 e^{-\\beta (r - r_0)}$ with $p_0 = 1.000$ (dimensionless), $\\beta = 1.800$ inverse Angstroms, and $r_0 = r_e$ Angstroms, which is conventional in EAM parameterizations.\n- Apply a cutoff $r_c = 6.000$ Angstroms. This includes several coordination shells in the fcc lattice at $a_{\\mathrm{lat}} = 3.615$ Angstroms and ensures convergence of sums within a modest supercell.\n- Compute $E_N^{\\mathrm{perf}}$, determine $\\rho_{\\mathrm{ref}}$ from the perfect configuration, then compute $E_{N-1}^{\\mathrm{vac}}$ with the same $\\rho_{\\mathrm{ref}}$, and finally $E_f^{\\mathrm{vac}}$.\n\nTest suite design and coverage:\n- Case $1$ uses $n = 4$, $A = -2.000$, $B = 0.000$, probing the low-curvature limit dominated by the square-root term.\n- Case $2$ uses $n = 4$, $A = -2.000$, $B = 0.500$, a moderate curvature.\n- Case $3$ uses $n = 4$, $A = -2.000$, $B = 2.000$, a high-curvature regime, expected to yield a larger vacancy formation energy.\n- Case $4$ uses $n = 2$, $A = -2.000$, $B = 0.500$, testing finite-size and periodic image interactions of the vacancy as an edge case (the vacancy images are closer due to the smaller box).\n\nThe program aggregates results into a single line in the specified format. All energies are in electronvolts and are printed with six decimal places as required. This design adheres strictly to the fundamental definitions of EAM and vacancy formation energy at fixed volume, without introducing shortcut formulas.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_fcc_supercell(n, a_lat):\n    # Conventional fcc cell basis in fractional coordinates\n    basis = np.array([\n        [0.0, 0.0, 0.0],\n        [0.0, 0.5, 0.5],\n        [0.5, 0.0, 0.5],\n        [0.5, 0.5, 0.0],\n    ])\n    positions = []\n    for i in range(n):\n        for j in range(n):\n            for k in range(n):\n                cell_origin = np.array([i, j, k], dtype=float)\n                frac = basis + cell_origin\n                cart = frac * a_lat\n                positions.append(cart)\n    positions = np.vstack(positions)\n    return positions  # shape: (4*n^3, 3)\n\ndef minimum_image_displacement(dr, box_length):\n    # Apply minimum image convention for cubic box\n    return dr - box_length * np.round(dr / box_length)\n\ndef compute_pair_energy_and_density(positions, box_length, rc, phi_params, dens_params):\n    \"\"\"\n    Compute total pair energy (sum over ij) and per-atom scalar density rho_i.\n    positions: (N,3)\n    Returns: pair_energy (float), rho (N,)\n    \"\"\"\n    N = positions.shape[0]\n    rc2 = rc * rc\n    # Unpack parameters\n    De, a_m, r_e = phi_params\n    p0, beta, r0 = dens_params\n\n    pair_energy = 0.0\n    rho = np.zeros(N, dtype=float)\n\n    # Double loop over pairs\n    for i in range(N):\n        ri = positions[i]\n        for j in range(i+1, N):\n            rj = positions[j]\n            dr = ri - rj\n            dr = minimum_image_displacement(dr, box_length)\n            r2 = np.dot(dr, dr)\n            if r2 = rc2:\n                r = np.sqrt(r2)\n                # Pair potential (Morse), truncated\n                # phi(r) = De * [ (1 - exp(-a_m (r - r_e)))^2 - 1 ]\n                exp_term = np.exp(-a_m * (r - r_e))\n                phi = De * ((1.0 - exp_term) ** 2 - 1.0)\n                pair_energy += phi\n                # Density contributions are symmetric\n                # f(r) = p0 * exp(-beta (r - r0))\n                f = p0 * np.exp(-beta * (r - r0))\n                rho[i] += f\n                rho[j] += f\n    return pair_energy, rho\n\ndef embedding_energy(rho, A, B, rho_ref, eps=1e-12):\n    # F(rho) = A * sqrt(max(rho, eps)) + 0.5 * B * (rho - rho_ref)^2\n    # Vectorized evaluation\n    rho_clamped = np.maximum(rho, eps)\n    return np.sum(A * np.sqrt(rho_clamped) + 0.5 * B * (rho - rho_ref) ** 2)\n\ndef total_energy(positions, box_length, rc, phi_params, dens_params, A, B, rho_ref=None):\n    # Compute total EAM energy for given positions\n    pair_e, rho = compute_pair_energy_and_density(positions, box_length, rc, phi_params, dens_params)\n    if rho_ref is None:\n        rho_ref = float(np.mean(rho))\n    E_emb = embedding_energy(rho, A, B, rho_ref)\n    return pair_e + E_emb, rho_ref, rho\n\ndef remove_atom_closest_to_center(positions, box_length):\n    # Find the atom closest to the box center and remove it\n    center = np.array([0.5 * box_length, 0.5 * box_length, 0.5 * box_length])\n    # Compute minimum image distances to center\n    dr = positions - center\n    dr = dr - box_length * np.round(dr / box_length)\n    d2 = np.sum(dr**2, axis=1)\n    idx = int(np.argmin(d2))\n    mask = np.ones(positions.shape[0], dtype=bool)\n    mask[idx] = False\n    return positions[mask], idx\n\ndef solve():\n    # Fixed model parameters\n    a_lat = 3.615  # Angstrom\n    rc = 6.000     # Angstrom\n    De = 0.150     # eV\n    a_m = 1.500    # 1/Angstrom\n    r_e = a_lat / np.sqrt(2.0)  # Angstrom\n    p0 = 1.000     # dimensionless\n    beta = 1.800   # 1/Angstrom\n    r0 = r_e       # Angstrom\n\n    phi_params = (De, a_m, r_e)\n    dens_params = (p0, beta, r0)\n\n    # Test cases: (n, A, B)\n    test_cases = [\n        (4, -2.0, 0.0),   # Case 1: low curvature B=0\n        (4, -2.0, 0.5),   # Case 2: moderate curvature\n        (4, -2.0, 2.0),   # Case 3: high curvature\n        (2, -2.0, 0.5),   # Case 4: finite-size edge case\n    ]\n\n    results = []\n    for n, A, B in test_cases:\n        # Build perfect supercell\n        positions = build_fcc_supercell(n, a_lat)\n        N = positions.shape[0]\n        box_length = n * a_lat\n\n        # Perfect energy and rho_ref\n        E_perf, rho_ref, rho_perf = total_energy(\n            positions, box_length, rc, phi_params, dens_params, A, B, rho_ref=None\n        )\n\n        # Remove central atom, compute defective energy with rho_ref fixed from perfect\n        pos_def, removed_idx = remove_atom_closest_to_center(positions, box_length)\n        E_def, _, _ = total_energy(\n            pos_def, box_length, rc, phi_params, dens_params, A, B, rho_ref=rho_ref\n        )\n\n        # Vacancy formation energy at fixed volume:\n        # E_f^vac = E_{N-1}^vac - ((N-1)/N) * E_N^perf\n        E_vac = E_def - ((N - 1) / N) * E_perf\n\n        # Append rounded to six decimals\n        results.append(f\"{E_vac:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3448369"}, {"introduction": "Beyond static defects, EAM potentials are powerful tools for probing the mechanical stability of crystal structures and their transformation pathways. In this exercise, you will analyze the relative stability of the bcc and fcc phases by calculating the energy along the volume-preserving Bain path, a tetragonal deformation that connects the two structures [@problem_id:3448376]. By evaluating the second derivative of the energy with respect to strain, $E''(e)$, you will directly link the functional form of the embedding energy to the prediction of which phase is stable.", "problem": "Consider the Embedded Atom Method (EAM) energy per atom for a crystal at zero temperature $T=0$. The EAM energy is defined by the sum of an embedding term and a pair interaction term. Let the per-atom energy be $E(e) = F(\\rho(e)) + \\dfrac{1}{2} \\sum_{j} \\phi(r_j(e))$, where $e$ is a scalar Bain strain parameter controlling a volume-preserving tetragonal deformation, $F(\\rho)$ is the embedding energy as a function of the host electron density $\\rho$, $\\phi(r)$ is the pair potential as a function of interatomic distance $r$, and the sum is taken over all neighbor atoms $j$ of a reference atom.\n\nThe Bain strain parameter $e$ defines a homogeneous, volume-preserving deformation gradient $\\mathbf{A}(e) = \\mathrm{diag}\\!\\left(e^{-e/2}, e^{-e/2}, e^{e}\\right)$. Starting from a body-centered cubic (bcc) lattice of conventional cubic parameter $a_0$, this deformation maps bcc at $e=0$ to the body-centered tetragonal (bct) path; the face-centered cubic (fcc) structure is reached at $e = \\dfrac{1}{3}\\ln 2$, at which the tetragonality ratio satisfies $c/a = \\sqrt{2}$.\n\nLet the atomic volume be fixed to $V = 12$ in $\\mathrm{\\AA}^3$ per atom, so that the conventional cubic bcc parameter is $a_0 = (2V)^{1/3}$ in $\\mathrm{\\AA}$. Use a finite neighbor cutoff $r_{\\mathrm{cut}} = 8.0$ in $\\mathrm{\\AA}$ with a cosine taper switching function $S(r)$ defined as $S(r) = 1$ for $r \\le r_{\\mathrm{on}}$, $S(r) = \\dfrac{1}{2}\\left(1+\\cos\\left(\\pi \\dfrac{r - r_{\\mathrm{on}}}{r_{\\mathrm{cut}} - r_{\\mathrm{on}}}\\right)\\right)$ for $r_{\\mathrm{on}}  r  r_{\\mathrm{cut}}$, and $S(r) = 0$ for $r \\ge r_{\\mathrm{cut}}$, with $r_{\\mathrm{on}} = 6.5$ in $\\mathrm{\\AA}$. The pair potential and electron density contribution per neighbor are given by $\\phi(r) = S(r)\\left(A_{\\mathrm{e}} e^{-q r} - B_{\\mathrm{e}} e^{-2 q r}\\right)$ and $f(r) = S(r) f_0 e^{-p r}$, respectively, with positive constants $A_{\\mathrm{e}}, B_{\\mathrm{e}}, q, f_0, p$ in consistent units.\n\nDefine three embedding energy models $F(\\rho)$ to probe the effect of the second derivative $F''(\\rho)$:\n- Model 1: $F(\\rho) = A \\sqrt{\\rho}$ with $A0$ (this yields $F''(\\rho)  0$),\n- Model 2: $F(\\rho) = A \\sqrt{\\rho}$ with $A0$ (this yields $F''(\\rho)  0$),\n- Model 3: $F(\\rho) = A \\rho$ with $A0$ (this yields $F''(\\rho) = 0$).\n\nFor each model, compute the per-atom energy $E(e)$ as described by:\n- Generate neighbor vectors from a reference atom at the origin using the undeformed bcc lattice with basis positions at $(0,0,0)$ and $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$ multiplied by $a_0$ in $\\mathrm{\\AA}$. Include all lattice points within the spherical region of radius $r_{\\mathrm{cut}}$ after deformation. Exclude the self-interaction at distance zero.\n- Apply the deformation gradient $\\mathbf{A}(e)$ to each neighbor vector to obtain the deformed distance $r_j(e)$ in $\\mathrm{\\AA}$.\n- Compute the local electron density $\\rho(e) = \\sum_j f(r_j(e))$ and the pair energy $\\dfrac{1}{2}\\sum_j \\phi(r_j(e))$, both in electronvolts (eV) per atom, using the above definitions and the switching function $S(r)$.\n- Evaluate $E(e)$ at $e=0$ (bcc) and $e=\\dfrac{1}{3}\\ln 2$ (fcc), both in eV per atom.\n\nPerform a stability analysis along the Bain path by evaluating the second derivative $E''(e)$ with respect to the scalar strain $e$ at the bcc point $e=0$ and at the fcc point $e=\\dfrac{1}{3}\\ln 2$. Use a symmetric finite-difference formula with step $h = 10^{-3}$ (dimensionless) to approximate the second derivative,\n$$\nE''(e) \\approx \\frac{E(e+h) - 2 E(e) + E(e-h)}{h^2},\n$$\nin eV per atom.\n\nIn your program, use the following parameter values, which are scientifically plausible for short-ranged metallic interactions:\n- $f_0 = 1.0$ (dimensionless), $p = 2.0$ in $\\mathrm{\\AA}^{-1}$,\n- $A_{\\mathrm{e}} = 0.5$ in eV, $B_{\\mathrm{e}} = 0.25$ in eV, $q = 1.5$ in $\\mathrm{\\AA}^{-1}$,\n- $V = 12.0$ in $\\mathrm{\\AA}^3$, $r_{\\mathrm{on}} = 6.5$ in $\\mathrm{\\AA}$, $r_{\\mathrm{cut}} = 8.0$ in $\\mathrm{\\AA}$,\n- Embedding models:\n    1. $F(\\rho) = A \\sqrt{\\rho}$ with $A = +0.8$ in eV,\n    2. $F(\\rho) = A \\sqrt{\\rho}$ with $A = -0.8$ in eV,\n    3. $F(\\rho) = A \\rho$ with $A = +0.5$ in eV.\n\nFor each embedding model, compute and return the following quantities:\n- $E''_{\\mathrm{bcc}}$ evaluated at $e=0$ in eV per atom,\n- $E''_{\\mathrm{fcc}}$ evaluated at $e=\\dfrac{1}{3}\\ln 2$ in eV per atom,\n- $\\Delta E = E_{\\mathrm{fcc}} - E_{\\mathrm{bcc}}$ in eV per atom,\n- A boolean indicating whether bcc is locally stable along the Bain path (i.e., $E''_{\\mathrm{bcc}}  0$),\n- A boolean indicating whether fcc is locally stable along the Bain path (i.e., $E''_{\\mathrm{fcc}}  0$).\n\nThe test suite consists of the three embedding models above, which probe the \"happy path\" ($F''(\\rho)  0$), the flipped-curvature case ($F''(\\rho)  0$), and the boundary case ($F''(\\rho) = 0$). All calculations must use distances in $\\mathrm{\\AA}$ and energies in eV, and all derivatives are with respect to the dimensionless strain $e$ and thus in eV per atom.\n\nYour program should produce a single line of output containing the results for the three test cases in order as a comma-separated list enclosed in square brackets, where each test case result is itself a list of the form $[E''_{\\mathrm{bcc}}, E''_{\\mathrm{fcc}}, \\Delta E, \\text{bcc\\_stable}, \\text{fcc\\_stable}]$. For example, the final output must look like $[[x_1,y_1,z_1,b_1,c_1],[x_2,y_2,z_2,b_2,c_2],[x_3,y_3,z_3,b_3,c_3]]$, with numeric entries in eV and boolean entries in the programming language's boolean format.", "solution": "The problem requires an analysis of the structural stability of a body-centered cubic (bcc) and a face-centered cubic (fcc) crystal lattice within the framework of the Embedded Atom Method (EAM). The stability is probed along the volume-preserving Bain transformation path, which connects the bcc and fcc structures. The analysis will be performed for three different models of the EAM embedding energy function, $F(\\rho)$, to investigate the role of its curvature, $F''(\\rho)$, on the stability.\n\nThe total energy per atom, $E$, is given by the EAM expression:\n$$E(e) = F(\\rho(e)) + \\frac{1}{2} \\sum_{j} \\phi(r_j(e))$$\nwhere $e$ is the scalar Bain strain parameter. The first term, $F(\\rho)$, is the embedding energy, which depends on the local host electron density $\\rho(e)$ at the site of an atom. The second term is the pair interaction energy, summed over all neighboring atoms $j$.\n\nThe Bain path is described by a homogeneous deformation gradient tensor $\\mathbf{A}(e)$, which transforms the position vector of each atom $\\mathbf{r}_j^0$ in a reference bcc lattice to its new position $\\mathbf{r}_j(e) = \\mathbf{A}(e)\\mathbf{r}_j^0$. The tensor is given as:\n$$\\mathbf{A}(e) = \\mathrm{diag}\\!\\left(e^{-e/2}, e^{-e/2}, e^{e}\\right)$$\nThis transformation is volume-preserving since $\\det(\\mathbf{A}(e)) = e^{-e/2} \\cdot e^{-e/2} \\cdot e^{e} = e^{-e} \\cdot e^e = 1$. The path starts from the bcc structure at $e=0$ (where $\\mathbf{A}(0)=\\mathbf{I}$, the identity matrix) and reaches the fcc structure at $e = \\frac{1}{3}\\ln 2$. The atomic volume is held constant at $V = 12.0\\,\\mathrm{\\AA}^3$. For a bcc lattice, which has $2$ atoms per conventional cubic cell, the lattice parameter $a_0$ is derived from the cell volume $a_0^3 = 2V$, so $a_0 = (2V)^{1/3} \\approx 2.8845\\,\\mathrm{\\AA}$.\n\nThe calculation of the energy for a given strain $e$ proceeds as follows:\nFirst, a set of reference neighbor vectors $\\mathbf{r}_j^0$ for a central atom in the bcc lattice is generated. This set must be sufficiently large to include all atoms that might fall within the interaction cutoff radius $r_{\\mathrm{cut}} = 8.0\\,\\mathrm{\\AA}$ after deformation. A safe approach is to generate all bcc lattice points within a reference sphere of radius slightly larger than $r_{\\mathrm{cut}}$ times the largest stretch factor of the deformation. For each strain $e$, the reference vectors are deformed to obtain $\\mathbf{r}_j(e)$, and their magnitudes $r_j(e) = ||\\mathbf{r}_j(e)||$ are computed.\n\nThe interactions are governed by a pair potential $\\phi(r)$ and an electron density contribution function $f(r)$. Both are modulated by a smooth cosine-based switching function $S(r)$ that ramps the interaction to zero between $r_{\\mathrm{on}} = 6.5\\,\\mathrm{\\AA}$ and $r_{\\mathrm{cut}} = 8.0\\,\\mathrm{\\AA}$:\n$$ S(r) = \\begin{cases} 1  r \\le r_{\\mathrm{on}} \\\\ \\frac{1}{2}\\left(1+\\cos\\left(\\pi \\frac{r - r_{\\mathrm{on}}}{r_{\\mathrm{cut}} - r_{\\mathrm{on}}}\\right)\\right)  r_{\\mathrm{on}}  r  r_{\\mathrm{cut}} \\\\ 0  r \\ge r_{\\mathrm{cut}} \\end{cases} $$\nThe pair potential and density functions are defined as:\n$$ \\phi(r) = S(r)\\left(A_{\\mathrm{e}} e^{-q r} - B_{\\mathrm{e}} e^{-2 q r}\\right) $$\n$$ f(r) = S(r) f_0 e^{-p r} $$\nUsing the set of deformed distances $r_j(e)$ that satisfy $0  r_j(e)  r_{\\mathrm{cut}}$, the total host electron density $\\rho(e) = \\sum_j f(r_j(e))$ and the total pair energy $E_{\\mathrm{pair}}(e) = \\frac{1}{2}\\sum_j \\phi(r_j(e))$ are computed.\n\nThe final component is the embedding energy $F(\\rho)$, for which three models are tested to explore the effect of its second derivative, $F''(\\rho)$:\n1.  Model 1: $F(\\rho) = A \\sqrt{\\rho}$ with $A = 0.8  0$, yielding $F''(\\rho) = -A\\rho^{-3/2}/4  0$. This is the physically typical case for metals.\n2.  Model 2: $F(\\rho) = A \\sqrt{\\rho}$ with $A = -0.8  0$, yielding $F''(\\rho) = -A\\rho^{-3/2}/4  0$.\n3.  Model 3: $F(\\rho) = A \\rho$ with $A = 0.5  0$, yielding $F''(\\rho) = 0$.\n\nLocal mechanical stability of a structure at a specific strain $e^*$ requires the energy to be at a local minimum with respect to further strain, which mathematically means the second derivative of the energy must be positive, $E''(e^*)  0$. We evaluate the stability of the bcc ($e=0$) and fcc ($e=\\frac{1}{3}\\ln 2$) structures by computing $E''(e)$ at these points. The second derivative is approximated numerically using a symmetric finite-difference formula with a step size of $h=10^{-3}$:\n$$ E''(e) \\approx \\frac{E(e+h) - 2 E(e) + E(e-h)}{h^2} $$\n\nThe computational procedure for each of the three models is:\n1.  Define a core function that calculates the total energy $E(e)$ for a given strain $e$.\n2.  Calculate the energies $E_{\\mathrm{bcc}} = E(0)$ and $E_{\\mathrm{fcc}} = E(\\frac{1}{3}\\ln 2)$.\n3.  Compute the energy difference $\\Delta E = E_{\\mathrm{fcc}} - E_{\\mathrm{bcc}}$.\n4.  Use the finite-difference formula to compute $E''_{\\mathrm{bcc}}$ at $e=0$ by evaluating $E(-h)$, $E(0)$, and $E(h)$.\n5.  Similarly, compute $E''_{\\mathrm{fcc}}$ at $e=\\frac{1}{3}\\ln 2$ by evaluating $E(\\frac{1}{3}\\ln 2-h)$, $E(\\frac{1}{3}\\ln 2)$, and $E(\\frac{1}{3}\\ln 2+h)$.\n6.  Determine the stability of each structure: `bcc_stable` is true if $E''_{\\mathrm{bcc}}  0$, and `fcc_stable` is true if $E''_{\\mathrm{fcc}}  0$.\n7.  Collect these five values ($E''_{\\mathrm{bcc}}$, $E''_{\\mathrm{fcc}}$, $\\Delta E$, `bcc_stable`, `fcc_stable`) for each model and format them into the final specified output structure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs EAM stability analysis along the Bain path for three embedding models.\n    \"\"\"\n    \n    # --- Define problem parameters ---\n    V = 12.0  # Atomic volume in A^3\n    r_on = 6.5  # Tapering start radius in A\n    r_cut = 8.0  # Cutoff radius in A\n    h = 1e-3    # Finite difference step for derivatives\n\n    # Potential function parameters\n    f0 = 1.0    # dimensionless\n    p = 2.0     # A^-1\n    Ae = 0.5    # eV\n    Be = 0.25   # eV\n    q = 1.5     # A^-1\n\n    # Embedding models to be tested\n    test_cases = [\n        {'type': 'sqrt', 'A': 0.8},   # Model 1 (F''  0)\n        {'type': 'sqrt', 'A': -0.8},  # Model 2 (F''  0)\n        {'type': 'linear', 'A': 0.5}, # Model 3 (F'' = 0)\n    ]\n    \n    # --- Pre-computation of lattice and constants ---\n    a0 = (2 * V)**(1/3)  # bcc conventional lattice parameter\n    e_fcc = (1/3) * np.log(2)  # Bain strain for fcc\n\n    # Generate a superset of bcc lattice points to serve as reference neighbors.\n    # The search radius in the reference configuration must be large enough to \n    # contain all atoms within r_cut after the maximum deformation. A radius\n    # of 10.0 A is a safe choice.\n    search_radius_ref = 10.0\n    n_max = int(np.ceil(search_radius_ref / a0))\n    \n    # Create an integer grid for lattice indices\n    i, j, k = np.mgrid[-n_max:n_max+1, -n_max:n_max+1, -n_max:n_max+1]\n    \n    # Cartesian positions for the first simple cubic sub-lattice\n    vecs1 = np.stack([i.ravel(), j.ravel(), k.ravel()], axis=1) * a0\n    \n    # Cartesian positions for the second (shifted) sub-lattice\n    vecs2 = np.stack([(i.ravel() + 0.5), (j.ravel() + 0.5), (k.ravel() + 0.5)], axis=1) * a0\n    \n    # Combine and remove the central atom (self-interaction)\n    ref_vectors = np.concatenate((vecs1, vecs2), axis=0)\n    ref_vectors = ref_vectors[np.any(ref_vectors != 0, axis=1)]\n\n    # --- Helper functions for energy calculation ---\n    def switch_function(r):\n        \"\"\"Calculates the smooth cutoff switching function S(r).\"\"\"\n        s = np.zeros_like(r)\n        mask_on = r = r_on\n        mask_taper = (r  r_on)  (r  r_cut)\n        \n        s[mask_on] = 1.0\n        \n        r_taper = r[mask_taper]\n        s[mask_taper] = 0.5 * (1 + np.cos(np.pi * (r_taper - r_on) / (r_cut - r_on)))\n        \n        return s\n\n    def compute_energy(e, model_params):\n        \"\"\"\n        Computes the EAM energy per atom for a given Bain strain `e` and model.\n        \"\"\"\n        # 1. Apply deformation to reference neighbor vectors\n        A_e_mat = np.diag([np.exp(-e/2), np.exp(-e/2), np.exp(e)])\n        deformed_vectors = (A_e_mat @ ref_vectors.T).T\n        \n        # 2. Get distances and filter by cutoff radius\n        distances = np.linalg.norm(deformed_vectors, axis=1)\n        valid_distances = distances[distances  r_cut]\n        \n        if valid_distances.size == 0:\n            return 0.0\n\n        # 3. Calculate energy terms for valid neighbors\n        s_vals = switch_function(valid_distances)\n        \n        # Electron density contribution\n        f_r = f0 * np.exp(-p * valid_distances)\n        rho = np.sum(s_vals * f_r)\n        \n        # Pair potential energy\n        phi_r = Ae * np.exp(-q * valid_distances) - Be * np.exp(-2 * q * valid_distances)\n        pair_energy = 0.5 * np.sum(s_vals * phi_r)\n        \n        # Embedding energy based on the model\n        if model_params['type'] == 'sqrt':\n            embedding_energy = model_params['A'] * np.sqrt(rho) if rho  0 else 0.0\n        elif model_params['type'] == 'linear':\n            embedding_energy = model_params['A'] * rho\n        else:\n            raise ValueError(f\"Unknown model type: {model_params['type']}\")\n            \n        total_energy = embedding_energy + pair_energy\n        return total_energy\n\n    # --- Main calculation loop for each test case ---\n    all_results = []\n    for case in test_cases:\n        # Evaluate energies around bcc point (e=0)\n        e0 = 0.0\n        E0 = compute_energy(e0, case)\n        E0_plus_h = compute_energy(e0 + h, case)\n        E0_minus_h = compute_energy(e0 - h, case)\n        \n        # Evaluate energies around fcc point (e=e_fcc)\n        e1 = e_fcc\n        E1 = compute_energy(e1, case)\n        E1_plus_h = compute_energy(e1 + h, case)\n        E1_minus_h = compute_energy(e1 - h, case)\n        \n        # Calculate second derivatives via finite difference\n        E_double_prime_bcc = (E0_plus_h - 2 * E0 + E0_minus_h) / h**2\n        E_double_prime_fcc = (E1_plus_h - 2 * E1 + E1_minus_h) / h**2\n        \n        # Calculate fcc-bcc energy difference\n        delta_E = E1 - E0\n        \n        # Determine local stability\n        bcc_stable = E_double_prime_bcc  0\n        fcc_stable = E_double_prime_fcc  0\n        \n        case_results = [\n            E_double_prime_bcc,\n            E_double_prime_fcc,\n            delta_E,\n            bcc_stable,\n            fcc_stable,\n        ]\n        all_results.append(case_results)\n\n    # --- Format and print the final output ---\n    # The output must be a single line, with lists of lists, no spaces, \n    # and standard Python boolean representation (True/False).\n    formatted_results = ','.join([str(res).replace(' ', '') for res in all_results])\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```", "id": "3448376"}, {"introduction": "A key strength of computational materials science is its ability to bridge atomistic details with continuum-scale behavior. This practice focuses on extracting a continuum-level property—the elastic dipole tensor $P_{ij}$ of a vacancy—from atomistic EAM calculations under homogeneous strain [@problem_id:3448422]. You will then use this tensor to predict the interaction energy between the vacancy and a dislocation's strain field, verifying the principle of linear superposition against a full atomistic simulation and connecting the microscopic world to macroscopic elasticity.", "problem": "You are asked to implement a complete, runnable program that computes elastic dipole tensors of a point defect in a crystal modeled with the Embedded Atom Method (EAM), relates those dipoles to continuum-scale fields, and verifies superposition by comparing continuum interaction energies to explicit atomistic calculations of a dislocation–vacancy interaction. Work in two spatial dimensions for computational convenience, while maintaining physical consistency. Use the following fundamental basis and definitions:\n\n- The Embedded Atom Method (EAM) total energy of a monatomic system with atoms at positions $\\{\\mathbf{r}_i\\}$ is\n$$\nE = \\sum_{i} F(\\rho_i) + \\frac{1}{2}\\sum_{i\\neq j} \\phi(r_{ij}),\n$$\nwhere $r_{ij} = \\|\\mathbf{r}_j - \\mathbf{r}_i\\|$, $F(\\rho)$ is the embedding energy, $\\rho_i = \\sum_{j\\neq i} f(r_{ij})$ is the host electron density at atom $i$, and $\\phi(r)$ is the pair potential. You will use the specific functions defined below. Pairwise sums are restricted to a finite cutoff radius $r_c$.\n\n- The point-defect elastic dipole tensor $P_{ij}$ is defined thermodynamically as the negative derivative of the defect formation energy with respect to homogeneous strain at zero temperature:\n$$\nP_{ij} = -\\left.\\frac{\\partial E_{\\mathrm{form}}(\\boldsymbol{\\varepsilon})}{\\partial \\varepsilon_{ij}}\\right|_{\\boldsymbol{\\varepsilon}=\\mathbf{0}}.\n$$\nThe formation energy of a vacancy is given by the grand-canonical approximation\n$$\nE_{\\mathrm{form}}(\\boldsymbol{\\varepsilon}) = E_{\\mathrm{def}}(\\boldsymbol{\\varepsilon}) - \\frac{N-1}{N} E_{\\mathrm{perf}}(\\boldsymbol{\\varepsilon}),\n$$\nwhere $E_{\\mathrm{def}}$ is the energy of the strained defective supercell containing $N-1$ atoms, and $E_{\\mathrm{perf}}$ is the energy of the strained perfect supercell containing $N$ atoms. The homogeneous deformation is applied via $\\mathbf{x} \\mapsto (\\mathbf{I} + \\boldsymbol{\\varepsilon}) \\mathbf{x}$ using the symmetric small-strain tensor $\\boldsymbol{\\varepsilon}$. Compute the derivative numerically using central differences.\n\n- Within linear elasticity, the interaction energy between an elastic dipole $P_{ij}$ and an externally imposed small strain field $\\varepsilon_{ij}^{\\infty}(\\mathbf{x})$ is\n$$\nE_{\\mathrm{int}}(\\mathbf{x}) = - P_{ij} \\, \\varepsilon_{ij}^{\\infty}(\\mathbf{x}),\n$$\nwith summation over repeated indices. For an edge dislocation of Burgers vector magnitude $b$ along the $x$-direction, located at the origin, under plane strain in an isotropic infinite medium with Poisson ratio $\\nu$, the displacement field $(u_x,u_y)$ is well approximated by the classical Volterra solution. You may compute the associated small-strain tensor $\\varepsilon_{ij}^{\\infty}(\\mathbf{x}) = \\frac{1}{2}(\\partial_i u_j + \\partial_j u_i)$ by finite differences of the displacement field. All angles must be in radians.\n\n- To verify superposition, compare $E_{\\mathrm{int}}$ from the continuum expression above against an explicit atomistic calculation of the out-of-equilibrium interaction energy defined by\n$$\nE_{\\mathrm{int}}^{\\mathrm{atom}} = \\Big(E_{\\mathrm{disl+vac}} - E_{\\mathrm{disl}}\\Big) - \\Big(E_{\\mathrm{vac}} - E_{0}\\Big),\n$$\nwhere $E_{\\mathrm{disl}}$ is the EAM energy of a crystal whose atoms have been displaced by the linear-elastic edge-dislocation displacement field, $E_{\\mathrm{disl+vac}}$ is the energy of that same displaced crystal with a vacancy at a specified lattice site, $E_0$ is the energy of the undisplaced perfect crystal, and $E_{\\mathrm{vac}}$ is the energy of the undisplaced crystal with a vacancy at the same lattice site. No atomic relaxation is performed; you directly evaluate energies at these configurations to isolate the linear superposition regime.\n\nUse the following scientifically consistent, fixed model choices and parameters. All energies must be expressed in electronvolts (eV), all lengths in angstroms (Å), and all strains are dimensionless. Angles must be in radians.\n\n- Lattice and supercells:\n  - Two-dimensional triangular lattice with lattice constant $a = 2.5\\,\\mathrm{\\AA}$.\n  - Primitive lattice vectors: $\\mathbf{a}_1 = (a,0)$ and $\\mathbf{a}_2 = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}}{2}a\\right)$.\n  - Periodic supercell for dipole evaluation: $N_x = 6$, $N_y = 6$ primitive cells, so $N = N_x N_y$ atoms in the perfect cell. Remove the atom at $(i,j)=(\\lfloor N_x/2 \\rfloor,\\lfloor N_y/2 \\rfloor)$ to create a vacancy.\n  - Homogeneous strain perturbations: use central differences with step $\\delta = 10^{-4}$ applied separately to the three independent components $\\varepsilon_{xx}$, $\\varepsilon_{yy}$, and $\\varepsilon_{xy}$, holding fractional coordinates fixed and deforming the cell by $\\mathbf{I}+\\boldsymbol{\\varepsilon}$.\n\n- EAM potential (toy but physically plausible):\n  - Pair potential: $\\phi(r) = \\epsilon_\\phi \\left(\\frac{r_0}{r}\\right)^{m}$ with $\\epsilon_\\phi = 0.35\\,\\mathrm{eV}$, $m=12$, $r_0=a$.\n  - Electron density function: $f(r) = f_0 \\exp\\left(-\\beta\\left(\\frac{r}{r_0}-1\\right)\\right)$ with $f_0 = 1.0$ (dimensionless), $\\beta = 4.5$.\n  - Embedding energy: $F(\\rho) = -A_{\\mathrm{emb}} \\sqrt{\\max(\\rho,10^{-12})}$ with $A_{\\mathrm{emb}} = 1.8\\,\\mathrm{eV}$.\n  - Cutoff radius: $r_c = 1.35\\,a$, with interactions and density contributions set to zero for $r \\ge r_c$.\n\n- Dislocation field and interaction verification:\n  - Poisson ratio: $\\nu = 1/3$.\n  - Burgers vector magnitude: $b = a$ along the $x$-direction.\n  - Compute $\\varepsilon_{ij}^{\\infty}(\\mathbf{x})$ at specified points by finite-difference derivatives of the displacement field of an edge dislocation located at the origin. Use a symmetric finite-difference step size $h = 10^{-3} \\max(a, \\sqrt{x^2+y^2})$ to ensure numerical stability across distances.\n  - For atomistic verification, construct a finite, non-periodic triangular lattice domain covering $x \\in [20, 50]\\,\\mathrm{\\AA}$ and $y \\in [-15, 15]\\,\\mathrm{\\AA}$, populate it with the same lattice constant $a$, and apply the same EAM model without periodic boundary conditions. Apply the edge-dislocation displacement field to all atomic positions to generate the “dislocated” state. Choose the vacancy site by selecting the atom whose undeformed position is nearest to the target vacancy coordinates listed below; remove the same index in all four energies $E_{\\mathrm{disl+vac}}$, $E_{\\mathrm{disl}}$, $E_{\\mathrm{vac}}$, and $E_0$.\n\nTest suite. Your program must evaluate the following and aggregate the results:\n\n1) Compute the vacancy elastic dipole tensor components $P_{xx}$, $P_{yy}$, $P_{xy}$ in eV from the periodic supercell using the central-difference definition above.\n\n2) Continuum interaction energies $E_{\\mathrm{int}}(\\mathbf{x}) = -P_{ij}\\varepsilon_{ij}^{\\infty}(\\mathbf{x})$ in eV for two vacancy positions relative to an edge dislocation at the origin:\n   - Case A position: $\\mathbf{x}_A = (30.0\\,\\mathrm{\\AA}, 8.0\\,\\mathrm{\\AA})$.\n   - Case B position: $\\mathbf{x}_B = (30.0\\,\\mathrm{\\AA}, -8.0\\,\\mathrm{\\AA})$.\n\n3) Atomistic interaction energies $E_{\\mathrm{int}}^{\\mathrm{atom}}$ in eV for the same two positions, computed via the four-energy difference defined above on the finite open-boundary sample. For each position, report a boolean indicating whether $\\left|E_{\\mathrm{int}}^{\\mathrm{atom}} - E_{\\mathrm{int}}\\right| \\le 2\\times 10^{-2}\\,\\mathrm{eV}$, which serves as a verification of linear superposition in the chosen far-field regime.\n\nFinal output format. Your program should produce a single line of output containing a comma-separated Python-style list with the following nine elements in order:\n- $P_{xx}$, $P_{yy}$, $P_{xy}$, $E_{\\mathrm{int}}(\\mathbf{x}_A)$, $E_{\\mathrm{int}}^{\\mathrm{atom}}(\\mathbf{x}_A)$, boolean for Case A, $E_{\\mathrm{int}}(\\mathbf{x}_B)$, $E_{\\mathrm{int}}^{\\mathrm{atom}}(\\mathbf{x}_B)$, boolean for Case B.\n\nFor example, the output must look like: [value1,value2,value3,value4,value5,True,value7,value8,False]. All energies must be in eV, and the booleans must be unadorned True or False literals. No additional text should be printed.", "solution": "The problem requires a multiscale simulation to compute the elastic dipole tensor of a vacancy in a two-dimensional triangular crystal, and then use this continuum-scale property to predict the interaction energy with a dislocation, finally verifying this prediction against a direct atomistic calculation. The model is based on the Embedded Atom Method (EAM). The solution proceeds in three main stages: (1) calculation of the vacancy elastic dipole tensor $P_{ij}$ from atomistic simulations of a periodic supercell under strain; (2) calculation of the interaction energy $E_{\\mathrm{int}}$ between the dipole and a dislocation's strain field using continuum linear elasticity; and (3) a direct atomistic calculation of the interaction energy $E_{\\mathrm{int}}^{\\mathrm{atom}}$ to verify the continuum prediction.\n\nFirst, we define the computational model. The total energy $E$ of the system of atoms is given by the EAM formula:\n$$\nE = \\sum_{i} F(\\rho_i) + \\frac{1}{2}\\sum_{i\\neq j} \\phi(r_{ij})\n$$\nwhere $r_{ij}$ is the distance between atoms $i$ and $j$, $F$ is the embedding energy function, $\\phi$ is a pair potential, and $\\rho_i$ is the electron density at site $i$ from its neighbors, $\\rho_i = \\sum_{j\\neq i} f(r_{ij})$. The specific functional forms for $F(\\rho)$, $\\phi(r)$, and $f(r)$, along with all parameters ($a$, $\\epsilon_\\phi$, $m$, $r_0$, $f_0$, $\\beta$, $A_{\\mathrm{emb}}$, $r_c$), are provided. An energy calculation routine is implemented that computes $E$ for a given set of atomic coordinates. For periodic systems, interatomic distances $r_{ij}$ must be computed using the minimum image convention, which for the non-orthogonal cell defined by lattice vectors $\\mathbf{L}_1, \\mathbf{L}_2$ involves transforming the vector difference $\\Delta\\mathbf{r} = \\mathbf{r}_j - \\mathbf{r}_i$ into fractional coordinates, adjusting them to the range $[-0.5, 0.5]$, and transforming back to Cartesian coordinates.\n\nThe first major task is to compute the vacancy elastic dipole tensor $P_{ij}$. It is defined thermodynamically at zero temperature as:\n$$\nP_{ij} = -\\left.\\frac{\\partial E_{\\mathrm{form}}(\\boldsymbol{\\varepsilon})}{\\partial \\varepsilon_{ij}}\\right|_{\\boldsymbol{\\varepsilon}=\\mathbf{0}}\n$$\nwhere $E_{\\mathrm{form}}$ is the vacancy formation energy in a system under homogeneous strain $\\boldsymbol{\\varepsilon}$. We use the grand-canonical approximation for the formation energy:\n$$\nE_{\\mathrm{form}}(\\boldsymbol{\\varepsilon}) = E_{\\mathrm{def}}(\\boldsymbol{\\varepsilon}) - \\frac{N-1}{N} E_{\\mathrm{perf}}(\\boldsymbol{\\varepsilon})\n$$\nHere, $E_{\\mathrm{def}}$ is the energy of a strained supercell with $N-1$ atoms (containing one vacancy), and $E_{\\mathrm{perf}}$ is the energy of a strained perfect supercell with $N$ atoms. A $N_x \\times N_y = 6 \\times 6$ periodic supercell is constructed on the triangular lattice, yielding $N=36$ atoms. A vacancy is created by removing the central atom.\n\nThe derivative is computed numerically using a central-difference scheme. For diagonal components like $P_{xx}$, the formula is:\n$$\nP_{xx} \\approx -\\frac{E_{\\mathrm{form}}(\\varepsilon_{xx}=\\delta) - E_{\\mathrm{form}}(\\varepsilon_{xx}=-\\delta)}{2\\delta}\n$$\nwhere $E_{\\mathrm{form}}(\\varepsilon_{xx}=\\delta)$ is the formation energy calculated in a cell deformed by the strain tensor $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\delta  0 \\\\ 0  0 \\end{pmatrix}$. A similar expression applies for $P_{yy}$. For the off-diagonal component $P_{xy}$, care must be taken due to the symmetry of the stress and strain tensors. The interaction energy is $E_{\\mathrm{int}} = -P_{ij} \\varepsilon_{ij} = - (P_{xx}\\varepsilon_{xx} + P_{yy}\\varepsilon_{yy} + 2P_{xy}\\varepsilon_{xy})$. This implies that $P_{xy} = -\\frac{1}{2} \\frac{\\partial E_{\\mathrm{form}}}{\\partial \\varepsilon_{xy}}$. We therefore compute a numerical derivative with respect to $\\varepsilon_{xy}$ by applying a strain $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0  \\delta \\\\ \\delta  0 \\end{pmatrix}$ and include the factor of $1/2$:\n$$\nP_{xy} \\approx -\\frac{1}{2} \\left( \\frac{E_{\\mathrm{form}}(\\varepsilon_{xy}=\\delta) - E_{\\mathrm{form}}(\\varepsilon_{xy}=-\\delta)}{2\\delta} \\right)\n$$\n\nThe second task is to calculate the continuum interaction energy $E_{\\mathrm{int}}$ between this vacancy (now represented by its dipole tensor $P_{ij}$) and the strain field of an edge dislocation, $\\varepsilon_{ij}^{\\infty}(\\mathbf{x})$:\n$$\nE_{\\mathrm{int}}(\\mathbf{x}) = - P_{ij} \\, \\varepsilon_{ij}^{\\infty}(\\mathbf{x})\n$$\nThe strain field is derived from the classical Volterra displacement field for an edge dislocation with Burgers vector $\\mathbf{b}=(b,0)$ in an isotropic elastic medium with Poisson's ratio $\\nu$:\n$$\nu_x(x,y) = \\frac{b}{2\\pi} \\left[ \\arctan\\left(\\frac{y}{x}\\right) + \\frac{xy}{2(1-\\nu)(x^2+y^2)} \\right]\n$$\n$$\nu_y(x,y) = -\\frac{b}{2\\pi} \\left[ \\frac{1-2\\nu}{4(1-\\nu)} \\ln(x^2+y^2) + \\frac{x^2-y^2}{4(1-\\nu)(x^2+y^2)} \\right]\n$$\nThe strain components $\\varepsilon_{ij}^{\\infty} = \\frac{1}{2}(\\partial_i u_j + \\partial_j u_i)$ are calculated at the specified vacancy positions $\\mathbf{x}_A$ and $\\mathbf{x}_B$ using a central-difference approximation for the spatial derivatives with a position-dependent step size $h$ for numerical stability.\n\nThe third and final task is to validate this continuum prediction against a direct, fully atomistic calculation. The atomistic interaction energy is defined by the four-energy formula, which isolates the interaction term from the self-energies of the defects:\n$$\nE_{\\mathrm{int}}^{\\mathrm{atom}} = \\Big(E_{\\mathrm{disl+vac}} - E_{\\mathrm{disl}}\\Big) - \\Big(E_{\\mathrm{vac}} - E_{0}\\Big)\n$$\nThese four energies are computed using the EAM potential on a large, finite (non-periodic) block of atoms.\n- $E_0$: The energy of the perfect, undeformed finite crystal block.\n- $E_{\\mathrm{vac}}$: The energy of the same block with one atom removed at a site corresponding to the target position ($\\mathbf{x}_A$ or $\\mathbf{x}_B$).\n- $E_{\\mathrm{disl}}$: The energy of the perfect block after all atoms have been displaced according to the dislocation displacement field $u_i(\\mathbf{x})$.\n- $E_{\\mathrm{disl+vac}}$: The energy of the dislocated block with the same atom removed as for $E_{\\mathrm{vac}}$.\nCrucially, no atomic relaxation is performed, which ensures that we are testing the linear superposition hypothesis underlying the continuum model.\n\nFinally, the continuum prediction $E_{\\mathrm{int}}$ is compared to the atomistic result $E_{\\mathrm{int}}^{\\mathrm{atom}}$ for both positions. The validity of the linear elastic superposition approximation in this regime is confirmed if the absolute difference is within the specified tolerance of $2 \\times 10^{-2}\\,\\mathrm{eV}$. The program computes and aggregates all nine requested values: $P_{xx}, P_{yy}, P_{xy}$, the two pairs of interaction energies ($E_\\mathrm{int}, E_\\mathrm{int}^\\mathrm{atom}$), and the two boolean verification results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to perform the entire multiscale calculation.\n    \"\"\"\n    # --------------------------------------------------------------------------\n    # 1. Define Model Parameters and EAM Potential\n    # --------------------------------------------------------------------------\n    \n    # Lattice and supercell parameters\n    a = 2.5  # Angstrom\n    a1 = np.array([a, 0.0])\n    a2 = np.array([a / 2.0, a * np.sqrt(3.0) / 2.0])\n    \n    # EAM potential parameters\n    epsilon_phi = 0.35  # eV\n    m = 12\n    r0 = a\n    f0 = 1.0  # dimensionless\n    beta = 4.5\n    A_emb = 1.8  # eV\n    rc = 1.35 * a\n    \n    # Dislocation and continuum parameters\n    nu = 1.0 / 3.0\n    b = a\n    \n    # Numerical parameters\n    strain_delta = 1e-4\n\n    def get_eam_potential(rc_val, epsilon_phi_val, m_val, r0_val, f0_val, beta_val, A_emb_val):\n        \"\"\"Closure to provide EAM potential functions.\"\"\"\n        rc2 = rc_val ** 2\n        \n        def phi(r):\n            if r = rc_val:\n                return 0.0\n            return epsilon_phi_val * (r0_val / r) ** m_val\n\n        def f(r):\n            if r = rc_val:\n                return 0.0\n            return f0_val * np.exp(-beta_val * (r / r0_val - 1.0))\n\n        def F(rho):\n            return -A_emb_val * np.sqrt(max(rho, 1e-12))\n            \n        return phi, f, F, rc2\n\n    eam_phi, eam_f, eam_F, eam_rc2 = get_eam_potential(rc, epsilon_phi, m, r0, f0, beta, A_emb)\n\n    def calculate_eam_energy(positions, cell_matrix=None):\n        \"\"\"\n        Calculates the total EAM energy of a configuration.\n        `cell_matrix`: 2x2 matrix with cell vectors as columns. If None, open boundaries.\n        \"\"\"\n        n_atoms = positions.shape[0]\n        if n_atoms == 0:\n            return 0.0\n\n        pair_energy = 0.0\n        rhos = np.zeros(n_atoms)\n        \n        inv_cell_matrix = None\n        if cell_matrix is not None:\n            inv_cell_matrix = np.linalg.inv(cell_matrix)\n\n        for i in range(n_atoms):\n            for j in range(i + 1, n_atoms):\n                rij_vec = positions[j] - positions[i]\n\n                if cell_matrix is not None:\n                    frac_coords = inv_cell_matrix @ rij_vec\n                    frac_coords -= np.round(frac_coords)\n                    rij_vec = cell_matrix @ frac_coords\n                \n                r2 = np.dot(rij_vec, rij_vec)\n\n                if r2  eam_rc2:\n                    r = np.sqrt(r2)\n                    pair_energy += eam_phi(r)\n                    f_val = eam_f(r)\n                    rhos[i] += f_val\n                    rhos[j] += f_val\n        \n        embedding_energy = np.sum([eam_F(rho) for rho in rhos])\n        \n        return embedding_energy + pair_energy\n\n    # --------------------------------------------------------------------------\n    # 2. Calculate Elastic Dipole Tensor\n    # --------------------------------------------------------------------------\n\n    def calculate_dipole_tensor():\n        Nx, Ny = 6, 6\n        N = Nx * Ny\n        \n        # Generate perfect cell positions\n        indices = np.mgrid[0:Nx, 0:Ny].reshape(2, -1).T\n        perfect_pos = indices[:, 0, np.newaxis] * a1 + indices[:, 1, np.newaxis] * a2\n        \n        # Define periodic cell matrix\n        L1 = Nx * a1\n        L2 = Ny * a2\n        cell_matrix = np.array([L1, L2]).T\n        \n        # Create vacancy by removing central atom\n        vac_idx_i, vac_idx_j = Nx // 2, Ny // 2\n        vac_atom_index = vac_idx_i * Ny + vac_idx_j\n        defective_pos = np.delete(perfect_pos, vac_atom_index, axis=0)\n\n        def get_E_form(strain_tensor):\n            I_plus_eps = np.eye(2) + strain_tensor\n            \n            # Deform cell and positions\n            strained_cell_matrix = I_plus_eps @ cell_matrix\n            strained_perfect_pos = (I_plus_eps @ perfect_pos.T).T\n            strained_defective_pos = (I_plus_eps @ defective_pos.T).T\n            \n            # Calculate energies\n            E_perf = calculate_eam_energy(strained_perfect_pos, strained_cell_matrix)\n            E_def = calculate_eam_energy(strained_defective_pos, strained_cell_matrix)\n            \n            return E_def - ((N - 1) / N) * E_perf\n\n        # Calculate derivatives using central differences\n        # P_xx\n        strain_xx_p = np.array([[strain_delta, 0], [0, 0]])\n        strain_xx_m = np.array([[-strain_delta, 0], [0, 0]])\n        P_xx = -(get_E_form(strain_xx_p) - get_E_form(strain_xx_m)) / (2 * strain_delta)\n        \n        # P_yy\n        strain_yy_p = np.array([[0, 0], [0, strain_delta]])\n        strain_yy_m = np.array([[0, 0], [0, -strain_delta]])\n        P_yy = -(get_E_form(strain_yy_p) - get_E_form(strain_yy_m)) / (2 * strain_delta)\n        \n        # P_xy\n        strain_xy_p = np.array([[0, strain_delta], [strain_delta, 0]])\n        strain_xy_m = np.array([[0, -strain_delta], [-strain_delta, 0]])\n        # The factor of 1/2 is crucial due to E_int = -P_ij * eps_ij summation convention\n        P_xy = -0.5 * (get_E_form(strain_xy_p) - get_E_form(strain_xy_m)) / (2 * strain_delta)\n        \n        return np.array([[P_xx, P_xy], [P_xy, P_yy]])\n\n    P = calculate_dipole_tensor()\n\n    # --------------------------------------------------------------------------\n    # 3. Calculate Continuum and Atomistic Interaction Energies\n    # --------------------------------------------------------------------------\n    \n    def dislocation_displacement(x, y, b_val, nu_val):\n        x = np.atleast_1d(x)\n        y = np.atleast_1d(y)\n        r2 = x**2 + y**2\n        \n        # Handles singularity and prevents division by zero\n        r2[r2  1e-12] = 1e-12\n        \n        prefactor = b_val / (2 * np.pi)\n        term1_ux = np.arctan2(y, x)\n        term2_ux = (x * y) / (2 * (1 - nu_val) * r2)\n        ux = prefactor * (term1_ux + term2_ux)\n        \n        term1_uy = ((1 - 2 * nu_val) / (4 * (1 - nu_val))) * np.log(r2)\n        term2_uy = (x**2 - y**2) / (4 * (1 - nu_val) * r2)\n        uy = -prefactor * (term1_uy + term2_uy)\n        \n        return ux, uy\n\n    def dislocation_strain_field(x, y, b_val, nu_val, a_val):\n        r_dist = np.sqrt(x**2 + y**2)\n        h = 1e-3 * max(a_val, r_dist)\n        \n        ux_xp, _ = dislocation_displacement(x + h, y, b_val, nu_val)\n        ux_xm, _ = dislocation_displacement(x - h, y, b_val, nu_val)\n        ux_yp, _ = dislocation_displacement(x, y + h, b_val, nu_val)\n        ux_ym, _ = dislocation_displacement(x, y - h, b_val, nu_val)\n\n        _, uy_xp = dislocation_displacement(x + h, y, b_val, nu_val)\n        _, uy_xm = dislocation_displacement(x - h, y, b_val, nu_val)\n        _, uy_yp = dislocation_displacement(x, y + h, b_val, nu_val)\n        _, uy_ym = dislocation_displacement(x, y - h, b_val, nu_val)\n\n        eps_xx = (ux_xp - ux_xm) / (2 * h)\n        eps_yy = (uy_yp - uy_ym) / (2 * h)\n        eps_xy = 0.5 * ((ux_yp - uy_ym) / (2 * h) + (uy_xp - uy_xm) / (2 * h))\n        \n        return np.array([[eps_xx.item(), eps_xy.item()], [eps_xy.item(), eps_yy.item()]])\n\n    def generate_finite_atoms():\n        x_range, y_range = (20, 50), (-15, 15)\n        \n        # Estimate index ranges to slightly overfill the domain\n        y_min_j = int(2 * y_range[0] / (np.sqrt(3) * a)) - 2\n        y_max_j = int(2 * y_range[1] / (np.sqrt(3) * a)) + 2\n        \n        x_min_i = int(x_range[0] / a - y_max_j / 2) - 2\n        x_max_i = int(x_range[1] / a - y_min_j / 2) + 2\n\n        js = np.arange(y_min_j, y_max_j)\n        i_s = np.arange(x_min_i, x_max_i)\n\n        indices = np.array(np.meshgrid(i_s, js)).T.reshape(-1, 2)\n        all_pos = indices[:, 0, np.newaxis] * a1 + indices[:, 1, np.newaxis] * a2\n\n        x_coords, y_coords = all_pos[:, 0], all_pos[:, 1]\n        mask = (x_coords = x_range[0])  (x_coords = x_range[1])  \\\n               (y_coords = y_range[0])  (y_coords = y_range[1])\n        \n        return all_pos[mask]\n\n    finite_atoms_perf = generate_finite_atoms()\n\n    results = [P[0, 0], P[1, 1], P[0, 1]]\n    test_cases = [\n        {\"pos\": np.array([30.0, 8.0]), \"label\": \"A\"},\n        {\"pos\": np.array([30.0, -8.0]), \"label\": \"B\"},\n    ]\n\n    for case in test_cases:\n        x_vac, y_vac = case[\"pos\"]\n        \n        # Continuum Interaction Energy\n        eps_inf = dislocation_strain_field(x_vac, y_vac, b, nu, a)\n        E_int_continuum = -np.sum(P * eps_inf)\n\n        # Atomistic Interaction Energy\n        # Find atom to remove\n        distances = np.linalg.norm(finite_atoms_perf - case[\"pos\"], axis=1)\n        vac_atom_index = np.argmin(distances)\n\n        # E0: Perfect, undisplaced\n        E0 = calculate_eam_energy(finite_atoms_perf)\n        \n        # Evac: Vacancy, undisplaced\n        finite_atoms_vac = np.delete(finite_atoms_perf, vac_atom_index, axis=0)\n        E_vac = calculate_eam_energy(finite_atoms_vac)\n        \n        # Edisl: Perfect, displaced\n        dx, dy = dislocation_displacement(finite_atoms_perf[:, 0], finite_atoms_perf[:, 1], b, nu)\n        displacements = np.vstack((dx, dy)).T\n        finite_atoms_disl = finite_atoms_perf + displacements\n        E_disl = calculate_eam_energy(finite_atoms_disl)\n        \n        # Edisl_vac: Vacancy, displaced\n        finite_atoms_disl_vac = np.delete(finite_atoms_disl, vac_atom_index, axis=0)\n        E_disl_vac = calculate_eam_energy(finite_atoms_disl_vac)\n\n        E_int_atomistic = (E_disl_vac - E_disl) - (E_vac - E0)\n        \n        # Verification\n        is_verified = abs(E_int_atomistic - E_int_continuum) = 2e-2\n        \n        results.extend([E_int_continuum, E_int_atomistic, is_verified])\n\n    # --------------------------------------------------------------------------\n    # 4. Final Output\n    # --------------------------------------------------------------------------\n    output_str = f\"[{results[0]},{results[1]},{results[2]},{results[3]},{results[4]},{results[5]},{results[6]},{results[7]},{results[8]}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3448422"}]}