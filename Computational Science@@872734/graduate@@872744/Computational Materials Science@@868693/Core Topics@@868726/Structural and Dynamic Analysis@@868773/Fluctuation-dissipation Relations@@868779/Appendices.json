{"hands_on_practices": [{"introduction": "The Langevin harmonic oscillator serves as a cornerstone model for understanding the interplay between microscopic fluctuations and macroscopic dissipation. This exercise provides a foundational, hands-on derivation of the classical Fluctuation-Dissipation Theorem (FDT) from first principles [@problem_id:3452690]. By working through this problem, you will analytically connect the spectrum of spontaneous thermal fluctuations, quantified by the Power Spectral Density $S_{xx}(\\omega)$, to the system's dissipative response to an external force, captured by the imaginary part of the susceptibility $\\chi''_{xx}(\\omega)$. Mastering this derivation is essential for a deep understanding of how equilibrium systems respond to perturbations.", "problem": "Consider a one-dimensional Langevin harmonic oscillator modeling a single vibrational mode of a coarse-grained material degree of freedom coupled to a thermal bath, governed by the stochastic differential equation\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t),\n$$\nwhere $m$ is the mass, $\\gamma$ is the viscous damping coefficient, $k$ is the spring constant, and $\\xi(t)$ is a stationary random force representing thermal fluctuations. Assume thermal equilibrium at temperature $T$ and that $\\xi(t)$ is Gaussian white noise with zero mean and autocorrelation\n$$\n\\langle \\xi(t)\\,\\xi(t')\\rangle=2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'),\n$$\nwhere $k_{B}$ is the Boltzmann constant, and $\\langle\\cdot\\rangle$ denotes ensemble averaging. Define the Fourier transform by $x(\\omega)=\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\,\\exp(i\\omega t)\\,x(t)$ and adopt the two-sided Power Spectral Density (PSD) convention $\\langle a(\\omega)\\,b(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{ab}(\\omega)$, so that $S_{xx}(\\omega)$ and $S_{vv}(\\omega)$ are the PSDs of $x(t)$ and $v(t)=\\dot{x}(t)$, respectively. Introduce a weak external probe force $f(t)$ conjugate to $x(t)$ to define the causal linear susceptibility $\\chi_{xx}(\\omega)$ via the linear response $x(\\omega)=\\chi_{xx}(\\omega)\\,f(\\omega)$.\n\nStarting from these definitions and the Langevin dynamics, do the following:\n- Derive closed-form analytic expressions for the stationary PSDs $S_{xx}(\\omega)$ and $S_{vv}(\\omega)$ in terms of $m$, $\\gamma$, $k$, $\\omega$, $k_{B}$, and $T$.\n- Identify the absorptive part of the susceptibility $\\chi''_{xx}(\\omega)$ and explain the resonance behavior of $\\chi''_{xx}(\\omega)$, including how its peak frequency and width depend on $m$, $\\gamma$, and $k$ in the underdamped regime.\n- Explain how the Fluctuation-Dissipation Theorem (FDT) links $S_{xx}(\\omega)$ and $\\chi''_{xx}(\\omega)$ under the conventions stated above, making clear your sign convention for $\\chi''_{xx}(\\omega)$.\n\nExpress your final answer as the pair $(S_{xx}(\\omega),\\,S_{vv}(\\omega))$ in closed form. No numerical evaluation is required and no units should be reported in the final answer box.", "solution": "The problem statement has been validated and is deemed a valid, scientifically grounded, and well-posed problem in statistical physics.\n\nThe starting point is the one-dimensional Langevin equation for a harmonic oscillator:\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t)\n$$\nwhere $\\xi(t)$ is a white noise term with $\\langle \\xi(t) \\rangle = 0$ and autocorrelation $\\langle \\xi(t)\\,\\xi(t')\\rangle=2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t')$.\n\nWe first derive the Power Spectral Densities (PSDs) $S_{xx}(\\omega)$ and $S_{vv}(\\omega)$. We apply the Fourier transform, defined as $g(\\omega)=\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\,\\exp(i\\omega t)\\,g(t)$, to the Langevin equation. Using the property that the Fourier transform of a time derivative $\\frac{d^n g(t)}{dt^n}$ is $(-i\\omega)^n g(\\omega)$, we get:\n$$\n(m(-i\\omega)^2 + \\gamma(-i\\omega) + k)x(\\omega) = \\xi(\\omega)\n$$\n$$\n(-m\\omega^2 - i\\omega\\gamma + k)x(\\omega) = \\xi(\\omega)\n$$\nSolving for $x(\\omega)$, we find the relationship between the position and the random force in the frequency domain:\n$$\nx(\\omega) = \\frac{\\xi(\\omega)}{k - m\\omega^2 - i\\omega\\gamma}\n$$\nNext, we determine the PSD of the random force, $S_{\\xi\\xi}(\\omega)$. The problem defines the PSD via the relation $\\langle a(\\omega)\\,b(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{ab}(\\omega)$. We compute the correlation of the Fourier-transformed noise:\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = \\int_{-\\infty}^{\\infty}\\mathrm{d}t \\int_{-\\infty}^{\\infty}\\mathrm{d}t'\\, \\exp(i\\omega t)\\,\\exp(i\\omega' t')\\,\\langle \\xi(t)\\,\\xi(t')\\rangle\n$$\nSubstituting the given autocorrelation for $\\xi(t)$:\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = \\int_{-\\infty}^{\\infty}\\mathrm{d}t \\int_{-\\infty}^{\\infty}\\mathrm{d}t'\\, \\exp(i\\omega t)\\,\\exp(i\\omega' t')\\,(2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'))\n$$\n$$\n= 2\\,\\gamma\\,k_{B}\\,T \\int_{-\\infty}^{\\infty}\\mathrm{d}t\\, \\exp(i(\\omega+\\omega')t)\n$$\nUsing the integral representation of the Dirac delta function, $\\int_{-\\infty}^{\\infty}\\mathrm{d}t\\, \\exp(iKt) = 2\\pi\\delta(K)$, we get:\n$$\n\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle = 2\\,\\gamma\\,k_{B}\\,T\\,(2\\pi\\delta(\\omega+\\omega'))\n$$\nComparing this with the definition $\\langle \\xi(\\omega)\\,\\xi(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{\\xi\\xi}(\\omega)$, we identify the PSD of the noise as a constant (characteristic of white noise):\n$$\nS_{\\xi\\xi}(\\omega) = 2\\,\\gamma\\,k_{B}\\,T\n$$\nNow we can compute the PSD of the position, $S_{xx}(\\omega)$. We calculate the correlation $\\langle x(\\omega)x(\\omega') \\rangle$:\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\left\\langle \\frac{\\xi(\\omega)}{k - m\\omega^2 - i\\omega\\gamma} \\frac{\\xi(\\omega')}{k - m(\\omega')^2 - i\\omega'\\gamma} \\right\\rangle = \\frac{\\langle \\xi(\\omega)\\xi(\\omega') \\rangle}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(\\omega')^2 - i\\omega'\\gamma)}\n$$\nSubstituting the expression for $\\langle \\xi(\\omega)\\xi(\\omega') \\rangle$:\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(\\omega')^2 - i\\omega'\\gamma)}\n$$\nThe delta function $\\delta(\\omega+\\omega')$ enforces $\\omega' = -\\omega$. Applying this constraint:\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m(-\\omega)^2 - i(-\\omega)\\gamma)} = \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2 - i\\omega\\gamma)(k - m\\omega^2 + i\\omega\\gamma)}\n$$\n$$\n= \\frac{2\\pi\\delta(\\omega+\\omega') S_{\\xi\\xi}(\\omega)}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\nSubstituting $S_{\\xi\\xi}(\\omega) = 2\\,\\gamma\\,k_{B}\\,T$:\n$$\n\\langle x(\\omega)x(\\omega') \\rangle = 2\\pi\\delta(\\omega+\\omega') \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\nFrom the definition $\\langle x(\\omega)\\,x(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{xx}(\\omega)$, we obtain the PSD for position:\n$$\nS_{xx}(\\omega) = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\nTo find the PSD of the velocity, $S_{vv}(\\omega)$, we use the relation $v(t)=\\dot{x}(t)$, which in Fourier space is $v(\\omega) = -i\\omega x(\\omega)$. Then,\n$$\n\\langle v(\\omega)v(\\omega') \\rangle = \\langle (-i\\omega x(\\omega))(-i\\omega' x(\\omega')) \\rangle = (-i)^2\\omega\\omega'\\langle x(\\omega)x(\\omega') \\rangle = -\\omega\\omega' \\langle x(\\omega)x(\\omega') \\rangle\n$$\nSince $\\langle x(\\omega)x(\\omega') \\rangle$ contains $\\delta(\\omega+\\omega')$, we can replace $\\omega'$ with $-\\omega$:\n$$\n\\langle v(\\omega)v(\\omega') \\rangle = -\\omega(-\\omega) [2\\pi\\delta(\\omega+\\omega')S_{xx}(\\omega)] = \\omega^2 [2\\pi\\delta(\\omega+\\omega')S_{xx}(\\omega)]\n$$\nComparing with the definition $\\langle v(\\omega)\\,v(\\omega')\\rangle=2\\pi\\,\\delta(\\omega+\\omega')\\,S_{vv}(\\omega)$, we find:\n$$\nS_{vv}(\\omega) = \\omega^2 S_{xx}(\\omega) = \\frac{2\\,\\gamma\\,\\omega^2\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\nThis completes the first task. For the second task, we derive the susceptibility $\\chi_{xx}(\\omega)$. We add a weak external force $f(t)$ to the equation of motion:\n$$\nm\\,\\ddot{x}(t)+\\gamma\\,\\dot{x}(t)+k\\,x(t)=\\xi(t) + f(t)\n$$\nThe linear response is described by the ensemble average $\\langle x(t) \\rangle$, for which the noise term averages to zero, $\\langle \\xi(t) \\rangle = 0$. The equation for the average response is:\n$$\nm\\,\\frac{d^2\\langle x(t) \\rangle}{dt^2}+\\gamma\\,\\frac{d\\langle x(t) \\rangle}{dt}+k\\,\\langle x(t) \\rangle = f(t)\n$$\nFourier transforming this equation gives:\n$$\n(-m\\omega^2 - i\\omega\\gamma + k)\\langle x(\\omega) \\rangle = f(\\omega)\n$$\nThe susceptibility $\\chi_{xx}(\\omega)$ is defined by the linear relation $\\langle x(\\omega) \\rangle = \\chi_{xx}(\\omega) f(\\omega)$. Thus, we can identify:\n$$\n\\chi_{xx}(\\omega) = \\frac{1}{k - m\\omega^2 - i\\omega\\gamma}\n$$\nTo find the absorptive (imaginary) part, we multiply the numerator and denominator by the complex conjugate of the denominator:\n$$\n\\chi_{xx}(\\omega) = \\frac{k - m\\omega^2 + i\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} = \\frac{k - m\\omega^2}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} + i \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\nThe absorptive part is the imaginary part, which we denote $\\chi''_{xx}(\\omega)$. With our Fourier transform convention, dissipation is linked to a positive imaginary part. Our result is:\n$$\n\\chi''_{xx}(\\omega) = \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\nThis is my sign convention, which is positive for $\\omega>0$ and $\\gamma>0$.\nIn the underdamped regime ($\\gamma \\ll 2\\sqrt{mk}$), $\\chi''_{xx}(\\omega)$ exhibits a sharp resonance peak. The natural frequency of the oscillator is $\\omega_0 = \\sqrt{k/m}$. The denominator $m^2(\\omega_0^2-\\omega^2)^2 + \\gamma^2\\omega^2$ is sharply minimal near $\\omega = \\omega_0$. Due to the $\\omega$ factors, the peak of $\\chi''_{xx}(\\omega)$ is not exactly at $\\omega_0$, but for weak damping, it is very close to $\\omega_0$. The peak frequency $\\omega_{res}$ is approximately $\\omega_0 = \\sqrt{k/m}$. The width of this resonance peak can be analyzed by approximating the lineshape as a Lorentzian near $\\omega_0$. The full width at half maximum (FWHM) of the resonance is found to be $\\Gamma = \\gamma/m$. Thus, the peak frequency depends on the stiffness $k$ and mass $m$, while its width is determined by the damping $\\gamma$ and mass $m$.\n\nFinally, we explain the Fluctuation-Dissipation Theorem (FDT) by linking the derived $S_{xx}(\\omega)$ and $\\chi''_{xx}(\\omega)$:\n$$\nS_{xx}(\\omega) = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\n$$\n\\chi''_{xx}(\\omega) = \\frac{\\omega\\gamma}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}\n$$\nBy direct comparison, we can see a simple proportionality:\n$$\n\\frac{S_{xx}(\\omega)}{\\chi''_{xx}(\\omega)} = \\frac{2\\,\\gamma\\,k_{B}\\,T}{\\omega\\gamma} = \\frac{2\\,k_{B}\\,T}{\\omega}\n$$\nThis gives the classical Fluctuation-Dissipation Theorem for the chosen variables and conventions:\n$$\nS_{xx}(\\omega) = \\frac{2\\,k_{B}\\,T}{\\omega} \\chi''_{xx}(\\omega)\n$$\nThis theorem is a fundamental result in statistical physics. It establishes a quantitative link between two seemingly different phenomena: the spontaneous fluctuations of the system in thermal equilibrium (quantified by the PSD, $S_{xx}(\\omega)$) and the dissipative response of the system to a small external perturbation (quantified by the absorptive part of the susceptibility, $\\chi''_{xx}(\\omega)$). The physical basis for this connection is that both the dissipation of energy and the thermal fluctuations are manifestations of the same underlying microscopic processes of interaction between the degree of freedom $x$ and the thermal bath. The constant of proportionality involves the temperature $T$, indicating that the magnitude of equilibrium fluctuations is determined by the thermal energy scale $k_B T$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\,\\gamma\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2}  \\frac{2\\,\\gamma\\,\\omega^2\\,k_{B}\\,T}{(k - m\\omega^2)^2 + (\\omega\\gamma)^2} \\end{pmatrix}}\n$$", "id": "3452690"}, {"introduction": "While the continuous Langevin equation provides deep theoretical insight, computational simulations necessarily operate in discrete time steps. This practice bridges the gap between continuous theory and numerical implementation, addressing the critical challenge of preserving the Fluctuation-Dissipation Theorem within a discrete-time algorithm [@problem_id:3452632]. You will discover that a naive discretization can violate fundamental physical principles, leading to an incorrect system temperature. This exercise guides you through deriving the correctly modified noise amplitude for an integrator, ensuring that the simulated system accurately samples the desired thermodynamic ensemble and that the balance between fluctuation and dissipation is maintained.", "problem": "Consider a one-dimensional particle of mass $m$ in contact with a thermal bath at temperature $T$, modeled by the underdamped Langevin equation\n$$\nm \\,\\dot{v}(t) \\;=\\; -\\,\\gamma\\, v(t) \\;+\\; \\eta(t),\n$$\nwhere $\\gamma$ is the viscous friction coefficient and $\\eta(t)$ is a zero-mean Gaussian white-noise force. The Fluctuation-Dissipation Theorem (FDT) requires that the noise autocorrelation be\n$$\n\\langle \\eta(t)\\,\\eta(t') \\rangle \\;=\\; 2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'),\n$$\nwith $k_{B}$ the Boltzmann constant. Assume a force-free case (flat potential) so that the target stationary velocity distribution at equilibrium is Maxwell-Boltzmann,\n$$\np(v) \\;\\propto\\; \\exp\\!\\left(-\\frac{m\\,v^{2}}{2\\,k_{B}\\,T}\\right).\n$$\n\nYou discretize the equation over a finite timestep $\\Delta t$ using an explicit Euler update for the velocity,\n$$\n\\frac{m}{\\Delta t}\\,\\big(v_{n+1}-v_{n}\\big) \\;=\\; -\\,\\gamma\\,v_{n} \\;+\\; \\zeta_{n},\n$$\nwhere $\\zeta_{n}$ is a discrete, zero-mean Gaussian random force intended to represent the time-averaged thermal noise over the interval $[t_{n},t_{n}+\\Delta t]$. In this discrete representation, the white-noise autocorrelation is replaced by a Kronecker delta, and one may write\n$$\n\\langle \\zeta_{n}\\,\\zeta_{n'} \\rangle \\;=\\; A\\,\\delta_{n,n'},\n$$\nfor some amplitude $A$ to be determined. Equivalently, one can write the velocity update in the form\n$$\nv_{n+1} \\;=\\; \\left(1-\\frac{\\gamma\\,\\Delta t}{m}\\right) v_{n} \\;+\\; \\sigma_{\\Delta t}\\,\\xi_{n},\n$$\nwhere $\\xi_{n}$ are independent, standard normal random variables and $\\sigma_{\\Delta t}$ is the velocity-noise amplitude related to $A$ by $\\sigma_{\\Delta t} = (\\Delta t/m)\\sqrt{A}$.\n\nStarting from fundamental principles, namely the continuous-time FDT and the required Maxwell-Boltzmann stationary distribution for $v$, derive the discrete-time FDT that relates $A$ to the thermodynamic parameters and the timestep $\\Delta t$. Then, determine the modified velocity-noise amplitude $\\sigma_{\\Delta t}$ that guarantees the discrete-time Markov chain has the correct stationary variance $\\langle v^{2} \\rangle = k_{B}T/m$ for any finite $\\Delta t$.\n\nExpress your final answer as a single closed-form analytic expression for $\\sigma_{\\Delta t}$ in terms of $m$, $\\gamma$, $k_{B}$, $T$, and $\\Delta t$. If you numerically evaluate the expression, report the amplitude in meters per second. Do not include units in the boxed final answer.", "solution": "The problem statement is deemed valid as it is scientifically grounded, well-posed, and objective. It presents a standard problem in computational statistical mechanics concerning the discretization of a stochastic differential equation. All provided information is self-contained and consistent.\n\nThe objective is to determine the amplitude of the discrete noise, $\\sigma_{\\Delta t}$, such that the stationary velocity distribution of the discretized Langevin equation has the correct variance as dictated by the equipartition theorem, which follows from the specified Maxwell-Boltzmann distribution.\n\nThe discretized Langevin equation is given in the form of a velocity update rule:\n$$\nv_{n+1} \\;=\\; \\left(1-\\frac{\\gamma\\,\\Delta t}{m}\\right) v_{n} \\;+\\; \\sigma_{\\Delta t}\\,\\xi_{n}\n$$\nwhere $v_n$ is the velocity at discrete time step $n$, $m$ is the mass, $\\gamma$ is the friction coefficient, $\\Delta t$ is the time step, and $\\xi_n$ are independent and identically distributed random variables drawn from a standard normal distribution. The properties of $\\xi_n$ are:\n$$\n\\langle \\xi_n \\rangle = 0\n$$\n$$\n\\langle \\xi_n^2 \\rangle = 1\n$$\n$$\n\\langle \\xi_n \\xi_{n'} \\rangle = \\delta_{n,n'}\n$$\nwhere $\\delta_{n,n'}$ is the Kronecker delta.\n\nTo simplify the notation, let us define the constant coefficient $C$ as:\n$$\nC = 1-\\frac{\\gamma\\,\\Delta t}{m}\n$$\nThe update rule becomes:\n$$\nv_{n+1} = C v_n + \\sigma_{\\Delta t} \\xi_n\n$$\nWe are interested in the stationary variance of the velocity, $\\langle v^2 \\rangle$. At stationarity, the statistical moments of the distribution are constant in time, which means $\\langle v_{n+1}^2 \\rangle = \\langle v_n^2 \\rangle$. Let us denote this stationary variance as $\\langle v^2 \\rangle_{\\text{st}}$.\n\nWe compute the expectation of the square of $v_{n+1}$:\n$$\n\\langle v_{n+1}^2 \\rangle = \\langle (C v_n + \\sigma_{\\Delta t} \\xi_n)^2 \\rangle\n$$\nExpanding the square gives:\n$$\n\\langle v_{n+1}^2 \\rangle = \\langle C^2 v_n^2 + 2 C \\sigma_{\\Delta t} v_n \\xi_n + \\sigma_{\\Delta t}^2 \\xi_n^2 \\rangle\n$$\nUsing the linearity of the expectation operator:\n$$\n\\langle v_{n+1}^2 \\rangle = C^2 \\langle v_n^2 \\rangle + 2 C \\sigma_{\\Delta t} \\langle v_n \\xi_n \\rangle + \\sigma_{\\Delta t}^2 \\langle \\xi_n^2 \\rangle\n$$\nNow we evaluate the individual expectation terms. The velocity $v_n$ is a result of the noise terms up to step $n-1$. Since the noise term $\\xi_n$ is independent of all previous noise terms $\\xi_k$ for $k  n$, $v_n$ and $\\xi_n$ are uncorrelated. Therefore, the expectation of their product is the product of their expectations:\n$$\n\\langle v_n \\xi_n \\rangle = \\langle v_n \\rangle \\langle \\xi_n \\rangle\n$$\nThe mean velocity evolves according to $\\langle v_{n+1} \\rangle = C \\langle v_n \\rangle$. Assuming the system starts with zero mean velocity, or relaxes to it, the stationary mean velocity is $\\langle v \\rangle=0$. Consequently, $\\langle v_n \\rangle = 0$ for all $n$, which leads to:\n$$\n\\langle v_n \\xi_n \\rangle = 0\n$$\nSubstituting this and $\\langle \\xi_n^2 \\rangle = 1$ into the equation for $\\langle v_{n+1}^2 \\rangle$, we obtain the recurrence relation for the variance:\n$$\n\\langle v_{n+1}^2 \\rangle = C^2 \\langle v_n^2 \\rangle + \\sigma_{\\Delta t}^2\n$$\nAt stationarity, we have $\\langle v_{n+1}^2 \\rangle = \\langle v_n^2 \\rangle = \\langle v^2 \\rangle_{\\text{st}}$. The recurrence relation becomes an algebraic equation:\n$$\n\\langle v^2 \\rangle_{\\text{st}} = C^2 \\langle v^2 \\rangle_{\\text{st}} + \\sigma_{\\Delta t}^2\n$$\nSolving for $\\langle v^2 \\rangle_{\\text{st}}$ yields:\n$$\n\\langle v^2 \\rangle_{\\text{st}} (1 - C^2) = \\sigma_{\\Delta t}^2\n$$\n$$\n\\langle v^2 \\rangle_{\\text{st}} = \\frac{\\sigma_{\\Delta t}^2}{1 - C^2}\n$$\nThis is the variance that the discrete process will generate for a given noise amplitude $\\sigma_{\\Delta t}$.\n\nThe problem requires that this stationary variance matches the physical variance derived from the Maxwell-Boltzmann distribution at temperature $T$. According to the equipartition theorem for a single quadratic degree of freedom (the kinetic energy in one dimension), the average energy is $\\frac{1}{2} k_B T$:\n$$\n\\left\\langle \\frac{1}{2} m v^2 \\right\\rangle = \\frac{1}{2} k_B T\n$$\nThis implies that the required stationary variance is:\n$$\n\\langle v^2 \\rangle = \\frac{k_B T}{m}\n$$\nTo ensure the discrete simulation maintains the correct temperature, we must equate the variance produced by the algorithm with the physical variance:\n$$\n\\frac{\\sigma_{\\Delta t}^2}{1 - C^2} = \\frac{k_B T}{m}\n$$\nNow, we solve for $\\sigma_{\\Delta t}$:\n$$\n\\sigma_{\\Delta t}^2 = \\frac{k_B T}{m} (1 - C^2)\n$$\nSubstituting back the expression for $C = 1 - \\frac{\\gamma \\Delta t}{m}$:\n$$\n\\sigma_{\\Delta t}^2 = \\frac{k_B T}{m} \\left(1 - \\left(1 - \\frac{\\gamma \\Delta t}{m}\\right)^2\\right)\n$$\nExpanding the term inside the parenthesis:\n$$\n1 - \\left(1 - \\frac{2\\gamma \\Delta t}{m} + \\left(\\frac{\\gamma \\Delta t}{m}\\right)^2\\right) = \\frac{2\\gamma \\Delta t}{m} - \\left(\\frac{\\gamma \\Delta t}{m}\\right)^2\n$$\nSo, the expression for $\\sigma_{\\Delta t}^2$ is:\n$$\n\\sigma_{\\Delta t}^2 = \\frac{k_B T}{m} \\left(\\frac{2\\gamma \\Delta t}{m} - \\left(\\frac{\\gamma \\Delta t}{m}\\right)^2\\right)\n$$\nTaking the square root gives the final expression for the velocity-noise amplitude $\\sigma_{\\Delta t}$:\n$$\n\\sigma_{\\Delta t} = \\sqrt{\\frac{k_B T}{m} \\left(1 - \\left(1 - \\frac{\\gamma \\Delta t}{m}\\right)^2\\right)}\n$$\nThis is the discrete-time Fluctuation-Dissipation Theorem for this specific numerical integrator, ensuring that the correct equilibrium temperature is maintained for any finite time step $\\Delta t$ for which the integrator is stable (i.e., $|C|  1$, which requires $\\Delta t  2m/\\gamma$). This result differs from a naive discretization of the continuous-time noise, which would have led to an incorrect equilibrium temperature.", "answer": "$$\\boxed{\\sqrt{\\frac{k_{B} T}{m} \\left(1 - \\left(1 - \\frac{\\gamma \\Delta t}{m}\\right)^{2}\\right)}}$$", "id": "3452632"}, {"introduction": "This practice demonstrates a powerful, real-world application of the Fluctuation-Dissipation Theorem in computational materials science. You will learn how to extract the fundamental vibrational spectrum of a material—the Vibrational Density of States (VDOS)—from the time-correlation of atomic velocities, a direct application of the Wiener-Khinchin theorem [@problem_id:3452648]. This exercise constitutes a complete computational workflow, from processing a time-correlation function to calculating a macroscopic thermodynamic property. By linking the VDOS to the constant-volume specific heat ($C_V$), you will also incorporate principles of quantum statistical mechanics, gaining experience in how to predict temperature-dependent material properties from equilibrium simulation data.", "problem": "You are given the task, in the context of computational materials science, to use the fluctuation-dissipation relations to reconstruct a vibrational density of states from an equilibrium velocity autocorrelation and then predict the temperature dependence of the constant-volume specific heat. The fundamental base you should rely on is: the equilibrium velocity autocorrelation function definition, the normal-mode decomposition of harmonic vibrations, and the quantum statistical mechanics of the harmonic oscillator. In equilibrium, the velocity autocorrelation function is defined as $Z(t) = \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle / \\langle \\mathbf{v}(0)^2 \\rangle$, it is an even function in time, and in a harmonic system, the dynamics can be described by a superposition of normal modes. The fluctuation-dissipation principle connects equilibrium correlation functions to response spectra, ensuring that the spectral content extracted from $Z(t)$ represents the vibrational density relevant for thermodynamic predictions. You must not use shortcut formulas; instead, base your reconstruction and thermodynamic calculations on these definitions and principles.\n\nYour program must perform the following steps for each provided test case:\n\n1. Construct a synthetic, stationary equilibrium velocity autocorrelation function $Z(t)$ sampled over a uniform time grid using a finite sum of damped cosine contributions with prescribed weights and angular frequencies. Each test case specifies weights $\\{w_i\\}$ with $\\sum_i w_i = 1$, angular frequencies $\\{\\omega_i\\}$ in radians per picosecond, and a damping rate $\\gamma$ in inverse picoseconds. Use $Z(t) = \\mathrm{e}^{-\\gamma t} \\sum_i w_i \\cos(\\omega_i t)$ on $t \\in [0, t_{\\max}]$, where $t_{\\max}$ and the time step $\\Delta t$ are specified below. Ensure $Z(0) = 1$.\n\n2. Numerically reconstruct a one-sided vibrational density of states $g(\\omega)$ on a uniform angular-frequency grid by applying a windowed cosine transform to $Z(t)$ consistent with the fluctuation-dissipation framework. Use an apodization window that suppresses spectral leakage and yields a non-negative estimate. Normalize $g(\\omega)$ so that $\\int_0^{\\omega_{\\max}} g(\\omega)\\,\\mathrm{d}\\omega = 1$.\n\n3. Using the reconstructed and normalized $g(\\omega)$, compute the constant-volume specific heat per vibrational mode $C_V(T)$ in units of the Boltzmann constant $k_{\\mathrm{B}}$ at two temperatures $T_{\\mathrm{low}}$ and $T_{\\mathrm{high}}$ (both in kelvin) for each test case. Treat each vibrational mode as an independent quantum harmonic oscillator and use physically correct constants for the reduced Planck constant $\\hbar$ and the Boltzmann constant $k_{\\mathrm{B}}$, taking into account the unit conversion from radians per picosecond to radians per second when forming the dimensionless parameter $\\hbar \\omega / (k_{\\mathrm{B}} T)$. Also compute the classical constant-volume specific heat per mode at high temperature based on equipartition.\n\n4. For each test case, output four quantities: the low-temperature quantum specific heat $C_V(T_{\\mathrm{low}})$ in units of $k_{\\mathrm{B}}$, the high-temperature quantum specific heat $C_V(T_{\\mathrm{high}})$ in units of $k_{\\mathrm{B}}$, a boolean indicating whether the high-temperature quantum specific heat is within $0.05$ of the classical limit, and a boolean indicating whether the low-temperature quantum specific heat is less than $0.05$.\n\nImportant numerical and unit specifications:\n\n- Use the time grid $t \\in [0, t_{\\max}]$ with $t_{\\max} = 5.0$ picoseconds and $\\Delta t = 0.001$ picoseconds.\n- Use an angular-frequency grid $\\omega \\in [0, \\omega_{\\max}]$ with $\\omega_{\\max} = 100.0$ radians per picosecond and a uniform spacing that provides at least $2{,}000$ points.\n- Temperatures $T_{\\mathrm{low}}$ and $T_{\\mathrm{high}}$ are given in kelvin, and all reported specific heats must be in units of $k_{\\mathrm{B}}$ (dimensionless), not joules per kelvin.\n- Angular frequency must be treated in radians; ensure consistency of units when converting to the dimensionless $\\hbar \\omega / (k_{\\mathrm{B}} T)$.\n\nTest suite:\n\n- Case 1 (single Einstein mode, undamped): weights $\\{1.0\\}$, frequencies $\\{30.0\\}$ radians per picosecond, damping $\\gamma = 0.0$ inverse picoseconds, $T_{\\mathrm{low}} = 10$ kelvin, $T_{\\mathrm{high}} = 3000$ kelvin.\n- Case 2 (two Einstein modes, undamped): weights $\\{0.6, 0.4\\}$, frequencies $\\{20.0, 50.0\\}$ radians per picosecond, damping $\\gamma = 0.0$ inverse picoseconds, $T_{\\mathrm{low}} = 5$ kelvin, $T_{\\mathrm{high}} = 5000$ kelvin.\n- Case 3 (two Einstein modes, damped): weights $\\{0.5, 0.5\\}$, frequencies $\\{15.0, 40.0\\}$ radians per picosecond, damping $\\gamma = 5.0$ inverse picoseconds, $T_{\\mathrm{low}} = 5$ kelvin, $T_{\\mathrm{high}} = 5000$ kelvin.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order, for each case: $C_V(T_{\\mathrm{low}})$, $C_V(T_{\\mathrm{high}})$, boolean for the high-temperature classical-limit check, and boolean for the low-temperature suppression check. For example, the output should look like: \"[c1_low,c1_high,c1_high_ok,c1_low_ok,c2_low,c2_high,c2_high_ok,c2_low_ok,c3_low,c3_high,c3_high_ok,c3_low_ok]\".", "solution": "The problem statement submitted for consideration is valid. It is scientifically grounded in the principles of statistical mechanics, specifically the fluctuation-dissipation theorem, and is well-posed with a clear, self-contained set of instructions and parameters. The task, which involves reconstructing a vibrational density of states from a model velocity autocorrelation function and subsequently computing thermodynamic properties, is a standard and relevant exercise in computational materials science. The provided parameters and numerical specifications are physically realistic and computationally feasible.\n\nThe solution proceeds by implementing the sequence of steps outlined in the problem. The core of the methodology rests upon two fundamental connections:\n1.  **The Wiener-Khinchin theorem**, a specific manifestation of the fluctuation-dissipation framework, which states that the power spectral density of a wide-sense-stationary random process is the Fourier transform of its autocorrelation function. For atomic velocities, the power spectral density is proportional to the vibrational density of states (VDOS).\n2.  The principle from quantum statistical mechanics that the total macroscopic thermodynamic properties of a system of non-interacting oscillators (the harmonic approximation) can be calculated by integrating the property of a single oscillator over the distribution of oscillator frequencies, which is the VDOS.\n\nThe detailed derivation and numerical implementation are as follows.\n\n**1. Construction of the Velocity Autocorrelation Function ($Z(t)$)**\n\nThe problem provides a model for the normalized, one-sided equilibrium velocity autocorrelation function (VACF), $Z(t)$, for $t \\geq 0$:\n$$\nZ(t) = \\mathrm{e}^{-\\gamma t} \\sum_{i} w_i \\cos(\\omega_i t)\n$$\nHere, $\\{\\omega_i\\}$ represents the angular frequencies of the normal modes of vibration, $\\{w_i\\}$ are their respective weights in the velocity autocorrelation (with $\\sum_i w_i = 1$ to ensure $Z(0) = 1$), and $\\gamma$ is a phenomenological damping parameter that accounts for energy dissipation, leading to a finite lifetime of the vibrational modes. This function is constructed on a discrete time grid $t_k = k \\Delta t$ for $k = 0, 1, \\dots, (t_{\\max}/\\Delta t)$.\n\n**2. Reconstruction of the Vibrational Density of States ($g(\\omega)$)**\n\nThe VDOS, $g(\\omega)$, is proportional to the power spectrum of the velocity fluctuations. As $Z(t)$ is a real and even function of time (by its physical definition, although we only model it for $t \\ge 0$), its Fourier transform simplifies to a cosine transform:\n$$\ng(\\omega) \\propto \\int_{-\\infty}^{\\infty} Z(t) e^{-i\\omega t} \\, \\mathrm{d}t = 2 \\int_{0}^{\\infty} Z(t) \\cos(\\omega t) \\, \\mathrm{d}t\n$$\nIn a numerical setting with a finite-time signal from $t=0$ to $t=t_{\\max}$, this integral is approximated. Direct truncation of the integral leads to spectral artifacts (leakage). To mitigate this, $Z(t)$ is first multiplied by an apodization window function, $W(t)$, that smoothly goes to zero at the boundaries of the time interval. A Hann window is chosen for this purpose:\n$$\nW(t) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi t}{t_{\\max}}\\right)\\right) \\quad \\text{for } t \\in [0, t_{\\max}]\n$$\nThe raw, unnormalized VDOS, $g_{\\text{raw}}(\\omega)$, is then computed via a numerical cosine transform of the windowed VACF, $Z_w(t) = Z(t)W(t)$, using the trapezoidal rule for integration:\n$$\ng_{\\text{raw}}(\\omega) \\approx \\int_{0}^{t_{\\max}} Z_w(t) \\cos(\\omega t) \\, \\mathrm{d}t\n$$\nThe resulting spectrum is made strictly non-negative by clipping any small negative values that may arise from numerical imprecision. Finally, $g(\\omega)$ is normalized to represent a probability distribution of modes:\n$$\n\\int_{0}^{\\omega_{\\max}} g(\\omega) \\, \\mathrm{d}\\omega = 1\n$$\nThis is achieved by dividing $g_{\\text{raw}}(\\omega)$ by its total integral over the frequency domain $[0, \\omega_{\\max}]$.\n\n**3. Calculation of the Constant-Volume Specific Heat ($C_V(T)$)**\n\nThe constant-volume specific heat per vibrational mode, $C_V(T)$, is the average of the single-mode specific heat, $C_{V,\\text{SHO}}(\\omega, T)$, weighted by the VDOS, $g(\\omega)$:\n$$\nC_V(T) = \\int_{0}^{\\omega_{\\max}} C_{V,\\text{SHO}}(\\omega, T) g(\\omega) \\, \\mathrm{d}\\omega\n$$\nThe specific heat of a single quantum harmonic oscillator (SHO) of frequency $\\omega$ at temperature $T$, in units of the Boltzmann constant $k_{\\mathrm{B}}$, is given by:\n$$\n\\frac{C_{V,\\text{SHO}}(\\omega, T)}{k_{\\mathrm{B}}} = \\left(\\frac{\\hbar \\omega}{2k_{\\mathrm{B}}T}\\right)^2 \\frac{1}{\\sinh^2\\left(\\frac{\\hbar \\omega}{2 k_{\\mathrm{B}} T}\\right)}\n$$\nwhere $\\hbar$ is the reduced Planck constant. The dimensionless parameter $x = \\hbar \\omega / (k_{\\mathrm{B}} T)$ requires careful unit conversion, as $\\omega$ is given in radians per picosecond (rad/ps) and must be converted to radians per second ($1 \\text{ rad/ps} = 10^{12} \\text{ rad/s}$) to be consistent with the SI units of $\\hbar$ and $k_{\\mathrm{B}}$. The final integral for $C_V(T)$ is computed numerically using the trapezoidal rule over the discrete frequency grid.\n\n**4. High- and Low-Temperature Limits**\n\nThe computed specific heat values are compared against two physical limits:\n- **Classical Limit**: According to the equipartition theorem, at high temperatures ($k_{\\mathrm{B}} T \\gg \\hbar \\omega$), the specific heat of a one-dimensional harmonic oscillator approaches $k_{\\mathrm{B}}$. Therefore, $C_V(T_{\\mathrm{high}})/k_{\\mathrm{B}}$ is checked to be within $0.05$ of $1.0$.\n- **Low-Temperature Limit**: As $T \\to 0$, the vibrational modes \"freeze out\" and the specific heat must approach zero, a key prediction of quantum theory. $C_V(T_{\\mathrm{low}})/k_{\\mathrm{B}}$ is checked to be less than $0.05$.\n\nThe implementation combines these steps to process each test case and generate the required output quantities.", "answer": "```python\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It reconstructs the VDOS from a synthetic VACF and calculates specific heat.\n    \"\"\"\n\n    # --- Define Physical and Numerical Parameters ---\n    HBAR = constants.hbar  # Reduced Planck constant in J·s\n    KB = constants.k      # Boltzmann constant in J/K\n\n    T_MAX = 5.0      # Maximum correlation time in ps\n    DT = 0.001       # Time step in ps\n    OMEGA_MAX = 100.0  # Maximum angular frequency in rad/ps\n    N_OMEGA = 2001   # Number of points on the frequency grid\n\n    # Create the time and frequency grids\n    t_grid = np.arange(0, T_MAX + DT, DT)\n    omega_grid = np.linspace(0, OMEGA_MAX, N_OMEGA)\n\n    # --- Test Cases ---\n    test_cases = [\n        {'weights': [1.0], 'freqs': [30.0], 'gamma': 0.0, 'T_low': 10.0, 'T_high': 3000.0},\n        {'weights': [0.6, 0.4], 'freqs': [20.0, 50.0], 'gamma': 0.0, 'T_low': 5.0, 'T_high': 5000.0},\n        {'weights': [0.5, 0.5], 'freqs': [15.0, 40.0], 'gamma': 5.0, 'T_low': 5.0, 'T_high': 5000.0},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # --- Step 1: Construct Velocity Autocorrelation Function Z(t) ---\n        weights = np.array(case['weights'])\n        freqs = np.array(case['freqs'])\n        gamma = case['gamma']\n        \n        z_t = np.zeros_like(t_grid)\n        for w, f in zip(weights, freqs):\n            z_t += w * np.cos(f * t_grid)\n        z_t *= np.exp(-gamma * t_grid)\n\n        # --- Step 2: Reconstruct Vibrational Density of States g(omega) ---\n        # Apply a Hann window to Z(t) to suppress spectral leakage from signal truncation\n        hann_window = 0.5 * (1 - np.cos(2 * np.pi * t_grid / T_MAX))\n        z_t_windowed = z_t * hann_window\n\n        # Perform cosine transform via numerical integration (trapezoidal rule).\n        # This is done efficiently using NumPy broadcasting.\n        cos_matrix = np.cos(np.outer(t_grid, omega_grid))\n        integrand = z_t_windowed[:, np.newaxis] * cos_matrix\n        g_raw = integrate.trapezoid(integrand, t_grid, axis=0)\n        \n        # Ensure g(omega) is non-negative, clipping any numerical noise\n        g_raw[g_raw  0] = 0.0\n\n        # Normalize g(omega) such that its integral is 1\n        norm_const = integrate.trapezoid(g_raw, omega_grid)\n        g_omega = g_raw / norm_const if norm_const > 1e-12 else np.zeros_like(omega_grid)\n\n        # --- Step 3: Compute Constant-Volume Specific Heat Cv(T) ---\n        def calculate_cv_per_mode(T, vdos, omega_grid_rps):\n            if T = 0:\n                return 0.0\n            \n            # Convert omega from rad/ps to rad/s for use with SI unit constants\n            omega_grid_rs = omega_grid_rps * 1e12\n            \n            # Dimensionless parameter x = hbar*omega / (kB*T)\n            # Handle T=0 or omega=0 cases where x might be ill-defined\n            x = np.zeros_like(omega_grid_rs)\n            valid_T = T > 1e-9\n            if valid_T:\n                x = (HBAR * omega_grid_rs) / (KB * T)\n            \n            # Specific heat of a single quantum harmonic oscillator in units of kB\n            cv_sho_per_kb = np.ones_like(x)\n            non_zero_x = x > 1e-9\n            \n            arg = x[non_zero_x] / 2.0\n            cv_sho_per_kb[non_zero_x] = np.power(arg, 2) / np.power(np.sinh(arg), 2)\n            \n            # Total specific heat per mode is the average over the VDOS\n            total_cv_per_kb = integrate.trapezoid(cv_sho_per_kb * vdos, omega_grid_rps)\n            return total_cv_per_kb\n\n        cv_low = calculate_cv_per_mode(case['T_low'], g_omega, omega_grid)\n        cv_high = calculate_cv_per_mode(case['T_high'], g_omega, omega_grid)\n        \n        # --- Step 4: Perform Boolean Checks ---\n        # Classical limit for Cv per mode is 1.0 kB\n        classical_limit = 1.0\n        high_temp_check = abs(cv_high - classical_limit)  0.05\n        low_temp_check = cv_low  0.05\n        \n        all_results.extend([cv_low, cv_high, high_temp_check, low_temp_check])\n\n    # --- Final Output Formatting ---\n    # Format the results into a single comma-separated string as per problem specification.\n    # Boolean values are converted to lowercase strings 'true'/'false'.\n    final_list_str = []\n    for r in all_results:\n        if isinstance(r, bool):\n            final_list_str.append(str(r).lower())\n        else:\n            final_list_str.append(str(r))\n    \n    print(f\"[{','.join(final_list_str)}]\")\n\nsolve()\n```", "id": "3452648"}]}