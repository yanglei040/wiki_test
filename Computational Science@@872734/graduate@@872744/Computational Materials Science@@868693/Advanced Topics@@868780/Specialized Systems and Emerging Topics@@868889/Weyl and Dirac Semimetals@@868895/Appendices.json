{"hands_on_practices": [{"introduction": "A crucial aspect of studying topological materials is their stability and tunability. This exercise provides a hands-on simulation of how an intrinsic parameter, electron correlation, can control a topological phase. You will implement a minimal tight-binding model that captures how increasing the on-site Coulomb repulsion $U$, often treated in DFT+U calculations, can create, move, and ultimately annihilate pairs of Weyl nodes, providing a practical lesson in driving topological phase transitions. [@problem_id:3503605]", "problem": "You are asked to formalize a computational surrogate for Density Functional Theory with Hubbard $U$ (DFT+U) in a minimal tight-binding lattice model that captures the creation, motion, and annihilation of Weyl nodes in a ferromagnetic kagome metal such as cobalt stannide sulfide $\\text{Co}_3\\text{Sn}_2\\text{S}_2$. The goal is to assess the robustness of Weyl nodes as a function of the on-site Coulomb repulsion $U$ and to detect when pairs of nodes annihilate upon reaching high-symmetry planes in reciprocal space. The required output must be produced by a complete, runnable program.\n\nFundamental base and model definition:\n- Start from the Bloch theorem and the concept of a two-band Bloch Hamiltonian $H(\\mathbf{k};U)$ of the form\n$$\nH(\\mathbf{k};U) \\;=\\; d_x(\\mathbf{k})\\,\\sigma_x \\;+\\; d_y(\\mathbf{k})\\,\\sigma_y \\;+\\; d_z(\\mathbf{k};U)\\,\\sigma_z,\n$$\nwhere $\\sigma_x$, $\\sigma_y$, and $\\sigma_z$ are the Pauli matrices, and $\\mathbf{k}=(k_x,k_y,k_z)$ is the crystal momentum in the Brillouin zone. The components are chosen to capture the minimal ingredients for Weyl physics in a spin-polarized three-dimensional lattice:\n$$\nd_x(\\mathbf{k}) \\;=\\; t_x\\,\\sin k_x, \\quad\nd_y(\\mathbf{k}) \\;=\\; t_y\\,\\sin k_y,\n$$\n$$\nd_z(\\mathbf{k};U) \\;=\\; m(U) \\;-\\; t_z\\,\\cos k_z \\;-\\; t'\\,\\big(\\cos k_x + \\cos k_y\\big),\n$$\nwith $t_x$, $t_y$, $t_z$, and $t'$ real hopping parameters. The correlation strength $U$ enters through an effective mass term that mimics the band shift induced by DFT+U,\n$$\nm(U) \\;=\\; m_0 \\;+\\; \\alpha\\,U,\n$$\nwhere $m_0$ and $\\alpha$ are material-specific constants.\n\n- A Weyl node is defined at a crystal momentum $\\mathbf{k}_\\mathrm{W}$ where the two bands touch linearly in all directions, equivalently when\n$$\n\\mathbf{d}(\\mathbf{k}_\\mathrm{W};U) \\;=\\; \\big(d_x,d_y,d_z\\big)\\;=\\;\\mathbf{0}\n$$\nand the Jacobian matrix of $\\mathbf{d}$,\n$$\nJ_{ij}(\\mathbf{k};U) \\;=\\; \\frac{\\partial d_i}{\\partial k_j},\n$$\nhas a nonzero determinant at $\\mathbf{k}=\\mathbf{k}_\\mathrm{W}$. The chirality (topological charge) of the Weyl node is given by $\\chi=\\mathrm{sgn}\\big(\\det J(\\mathbf{k}_\\mathrm{W};U)\\big)$.\n\n- In this specific lattice model, solving $d_x(\\mathbf{k})=0$ and $d_y(\\mathbf{k})=0$ imposes $k_x\\in\\{0,\\pi\\}$ and $k_y\\in\\{0,\\pi\\}$, and the remaining condition $d_z(\\mathbf{k};U)=0$ yields\n$$\n\\cos k_z \\;=\\; \\frac{m(U) \\;-\\; t'\\,\\big(\\cos k_x + \\cos k_y\\big)}{t_z}.\n$$\nA real solution for $k_z$ exists if and only if the right-hand side lies in the interval $[-1,1]$. When the right-hand side reaches the boundary $\\pm 1$ at a given parameter $U=U_c$, the corresponding Weyl nodes meet on a high-symmetry plane ($k_z=0$ or $k_z=\\pi$), annihilate with their opposite-chirality partner, and disappear for $U>U_c$.\n\nParameter values, units, and numerical tolerances:\n- Use $t_x=t_y=t_z=1$, $t'=0.5$, $m_0=0.2$, and $\\alpha=0.7$.\n- Treat the on-site Coulomb repulsion $U$ in electronvolts (eV).\n- Angles $k_x$, $k_y$, and $k_z$ must be handled in radians.\n- When checking the existence of Weyl nodes, use the strict inequality condition $\\left|\\frac{m(U)-t'(\\cos k_x+\\cos k_y)}{t_z}\\right| < 1$ for existence. Detect annihilation at a given $U$ if any combination satisfies $\\left|\\frac{m(U)-t'(\\cos k_x+\\cos k_y)}{t_z}\\right|$ within a numerical tolerance $\\varepsilon=10^{-10}$ of $1$ (either $+1$ or $-1$). If no Weyl nodes exist for a given $U$, report the maximum absolute $k_z$ as $0.0$.\n\nRequired computations:\n- For each specified $U$, iterate over the four $(k_x,k_y)$ combinations with $k_x\\in\\{0,\\pi\\}$ and $k_y\\in\\{0,\\pi\\}$.\n- For each combination, check the existence condition and, when satisfied, compute the two Weyl nodes at $k_z=\\pm \\arccos\\left(\\frac{m(U)-t'(\\cos k_x+\\cos k_y)}{t_z}\\right)$ and determine their chiralities via $\\chi=\\mathrm{sgn}\\big(t_x t_y t_z \\cos k_x \\cos k_y \\sin k_z\\big)$.\n- Aggregate the total number of Weyl nodes $N$ per $U$ (count both $+k_z$ and $-k_z$ nodes), compute the maximum absolute value of $k_z$ over nodes, and detect whether an annihilation event occurs at that $U$ according to the tolerance criterion above.\n\nTest suite:\n- Evaluate the program for the following set of $U$ values (in electronvolts): $[0.0,\\;0.5,\\;1.1428571428571428,\\;1.5,\\;2.6]$. This suite covers a general case with several Weyl node pairs, a boundary case at the annihilation threshold, and edge cases with reduced or zero node counts.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case result encoded as a sublist of the form $[N,\\;K_\\mathrm{max},\\;A]$, where $N$ is an integer (the total number of Weyl nodes), $K_\\mathrm{max}$ is a float (the maximum absolute $k_z$ in radians), and $A$ is a boolean (true if an annihilation event is detected at that $U$, false otherwise). The overall output must therefore look like a list of lists, with no spaces in the final string, for example: $[[N_1,K_{\\mathrm{max},1},A_1],[N_2,K_{\\mathrm{max},2},A_2],\\dots]$.", "solution": "The user-provided problem has been rigorously validated and is determined to be a valid, well-posed, and scientifically sound problem in computational condensed matter physics. It is self-contained, with all necessary parameters, equations, and conditions clearly defined.\n\nThe problem asks for a computational analysis of a simplified two-band tight-binding model of a Weyl semimetal. The goal is to track the number, position, and annihilation of Weyl nodes as a function of an on-site Coulomb interaction parameter $U$, which mimics the effect of a DFT+U calculation.\n\nThe starting point is the two-band Bloch Hamiltonian in reciprocal space, given by $H(\\mathbf{k};U) = \\mathbf{d}(\\mathbf{k};U) \\cdot \\boldsymbol{\\sigma}$, where $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices and $\\mathbf{k}=(k_x, k_y, k_z)$ is the crystal momentum. The vector $\\mathbf{d}$ is defined as:\n$$\n\\mathbf{d}(\\mathbf{k};U) = (d_x(\\mathbf{k}), d_y(\\mathbf{k}), d_z(\\mathbf{k};U))\n$$\nwith components:\n$$\nd_x(\\mathbf{k}) = t_x \\sin k_x\n$$\n$$\nd_y(\\mathbf{k}) = t_y \\sin k_y\n$$\n$$\nd_z(\\mathbf{k};U) = m(U) - t_z \\cos k_z - t' (\\cos k_x + \\cos k_y)\n$$\nThe energy eigenvalues of this Hamiltonian are $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k};U)|$. Weyl nodes are points in the Brillouin zone where the two energy bands touch, which corresponds to $E_+ = E_- = 0$. This condition is met if and only if $\\mathbf{d}(\\mathbf{k};U) = \\mathbf{0}$.\n\nTo find the locations of the Weyl nodes, $\\mathbf{k}_\\mathrm{W}$, we must solve the system of three equations:\n$1$. $d_x(\\mathbf{k}) = t_x \\sin k_x = 0$\n$2$. $d_y(\\mathbf{k}) = t_y \\sin k_y = 0$\n$3$. $d_z(\\mathbf{k};U) = 0$\n\nAssuming non-zero hopping parameters $t_x$ and $t_y$, the first two equations restrict the possible $k_x$ and $k_y$ coordinates to integer multiples of $\\pi$. Within the first Brillouin zone, this means $k_x \\in \\{0, \\pi\\}$ and $k_y \\in \\{0, \\pi\\}$. This gives four high-symmetry lines along the $k_z$ direction where Weyl nodes can potentially exist.\n\nSubstituting these values of $k_x$ and $k_y$ into the third equation, $d_z(\\mathbf{k};U)=0$, we can solve for $\\cos k_z$:\n$$\nm(U) - t_z \\cos k_z - t' (\\cos k_x + \\cos k_y) = 0\n$$\n$$\n\\cos k_z = \\frac{m(U) - t'(\\cos k_x + \\cos k_y)}{t_z}\n$$\nHere, $m(U) = m_0 + \\alpha U$ captures the effect of electron correlations. Let's define the right-hand side of this equation as $C(k_x, k_y, U)$.\n\nThe algorithmic logic is derived directly from this central equation:\nA real solution for $k_z$ exists if and only if $C$ is in the interval $[-1, 1]$.\n$1$. **Existence of Weyl Nodes**: For a given pair $(k_x, k_y)$ and a value of $U$, a pair of Weyl nodes exists if the condition $|C(k_x, k_y, U)| < 1$ is strictly satisfied. If this holds, the $k_z$ coordinates of the nodes are $k_z = \\pm \\arccos(C)$. Each such pair contributes $2$ to the total count of Weyl nodes, $N$. The maximum absolute value of $k_z$ across all existing nodes, $K_\\mathrm{max}$, is tracked.\n\n$2$. **Annihilation of Weyl Nodes**: Weyl nodes are created or annihilated when $k_z$ becomes $0$ or $\\pi$. This occurs when $C$ reaches $\\pm 1$. An annihilation event is detected for a given $U$ if $|C(k_x, k_y, U)|$ is equal to $1$ for any of the four $(k_x, k_y)$ pairs. Due to floating-point arithmetic, this is checked using a numerical tolerance, $\\varepsilon = 10^{-10}$: an annihilation event is flagged if $|\\,|C(k_x, k_y, U)| - 1\\,| < \\varepsilon$. Note that at the precise moment of annihilation, the strict existence condition $|C| < 1$ is not met, so these points do not contribute to the node count $N$ at that specific $U$.\n\nThe algorithm proceeds as follows for each $U$ value in the test suite:\n1. Initialize the results for the current $U$: total nodes $N=0$, maximum $|k_z|$ as $K_\\mathrm{max}=0.0$, and annihilation flag $A=\\text{false}$.\n2. Calculate the mass term $m(U) = m_0 + \\alpha U$.\n3. Iterate through the four $(k_x, k_y)$ pairs: $(0,0)$, $(0,\\pi)$, $(\\pi,0)$, and $(\\pi,\\pi)$.\n4. In each iteration, calculate $C = (m(U) - t'(\\cos k_x + \\cos k_y)) / t_z$ using the given parameters ($t_x=t_y=t_z=1$, $t'=0.5$).\n5. Check for annihilation: if $|\\,|C| - 1\\,| < 10^{-10}$, set $A = \\text{true}$.\n6. Check for existence: if $|C| < 1$, increment $N$ by $2$ and update $K_\\mathrm{max} = \\max(K_\\mathrm{max}, \\arccos(C))$.\n7. After checking all four pairs, the triplet $[N, K_\\mathrm{max}, A]$ is stored. If $N=0$ at the end, $K_\\mathrm{max}$ is set to $0.0$ as specified.\n\nThis procedure is implemented in the provided Python code, which computes the results for the specified set of $U$ values and formats them into the required output string.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of Weyl nodes, max |k_z|, and annihilation events\n    for a simplified tight-binding model as a function of Hubbard U.\n    \"\"\"\n    # Define the physical and numerical parameters from the problem statement.\n    tx = 1.0\n    ty = 1.0\n    tz = 1.0\n    t_prime = 0.5\n    m0 = 0.2\n    alpha = 0.7\n    epsilon = 1e-10\n\n    # Define the test suite of U values.\n    test_cases_U = [0.0, 0.5, 1.1428571428571428, 1.5, 2.6]\n    \n    # Define the high-symmetry kx, ky points in the Brillouin zone.\n    k_pairs = [\n        (0.0, 0.0), \n        (0.0, np.pi), \n        (np.pi, 0.0), \n        (np.pi, np.pi)\n    ]\n\n    all_results = []\n\n    for u_val in test_cases_U:\n        # Initialize results for the current U value.\n        total_nodes = 0\n        max_kz = 0.0\n        annihilation_detected = False\n        \n        # Calculate the correlation-dependent mass term m(U).\n        m_u = m0 + alpha * u_val\n        \n        # Iterate over the four (kx, ky) channels.\n        for kx, ky in k_pairs:\n            cos_kx = np.cos(kx)\n            cos_ky = np.cos(ky)\n            \n            # Calculate the argument of arccos, C.\n            C = (m_u - t_prime * (cos_kx + cos_ky)) / tz\n            \n            # 1. Check for annihilation events.\n            # This occurs when |C| is numerically equal to 1.\n            if np.abs(np.abs(C) - 1.0) < epsilon:\n                annihilation_detected = True\n            \n            # 2. Check for the existence of Weyl nodes.\n            # This requires the strict inequality |C| < 1.\n            if np.abs(C) < 1.0:\n                # If nodes exist, a pair (+-kz) is created.\n                total_nodes += 2\n                \n                # Calculate the k_z coordinate (always positive via arccos).\n                kz = np.arccos(C)\n                \n                # Update the maximum absolute k_z value.\n                if kz > max_kz:\n                    max_kz = kz\n        \n        # Per problem specification, if no nodes exist, max_kz should be 0.0.\n        # This is already handled by initializing max_kz=0.0, but we make it explicit.\n        if total_nodes == 0:\n            max_kz = 0.0\n\n        # Collect the results for this U value.\n        all_results.append([total_nodes, max_kz, annihilation_detected])\n        \n    # Format the final output string as specified: [[N1,Kmax1,A1],[N2,Kmax2,A2],...]\n    # Booleans must be lowercase, and there should be no spaces.\n    results_str_list = []\n    for res in all_results:\n        # res[0] is int, res[1] is float, res[2] is bool\n        results_str_list.append(f\"[{res[0]},{res[1]},{str(res[2]).lower()}]\")\n    \n    final_output = f\"[{','.join(results_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3503605"}, {"introduction": "The defining feature of a Weyl semimetal is the topological charge, or chirality, carried by its Weyl nodes, which act as sources and sinks of Berry curvature in momentum space. This practice guides you through the implementation of the Wilson loop method, a powerful and standard numerical technique for computing the Chern number on 2D slices of the Brillouin zone. Mastering this method is an essential skill for computationally verifying the non-trivial topology of any material predicted to host Weyl points. [@problem_id:3503638]", "problem": "You are to implement a self-contained program that models a two-band Wannier tight-binding Hamiltonian for a Weyl semimetal on a simple cubic lattice and confirms nontrivial topological character via Wilson-loop calculations. Your program must be based on first principles of tight-binding band theory and Berry-phase topology, and must include numerical gauge consistency checks.\n\nStart from the well-tested tight-binding representation of a two-band model in momentum space derived from a nearest-neighbor Wannier basis. In momentum space, define the Hamiltonian on the Brillouin Zone (BZ) torus as\n$$\nH(\\mathbf{k}) = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z,\n$$\nwhere $\\sigma_x$, $\\sigma_y$, and $\\sigma_z$ are the Pauli matrices, $\\mathbf{k} = (k_x,k_y,k_z)$, and\n$$\nd_x(\\mathbf{k}) = \\sin(k_x),\\quad d_y(\\mathbf{k}) = \\sin(k_y),\\quad d_z(\\mathbf{k}) = m_0 - \\cos(k_x) - \\cos(k_y) - \\cos(k_z).\n$$\nHere $m_0$ is a real control parameter that tunes between phases with and without Weyl nodes. The suspected Weyl nodes occur at zero-energy points satisfying $\\sin(k_x)=\\sin(k_y)=0$ and $m_0 - \\cos(k_x) - \\cos(k_y) - \\cos(k_z) = 0$, which yields solutions at $k_x = 0$, $k_y = 0$, and $k_z = \\pm \\arccos(m_0 - 2)$ when $m_0 \\in (1,3)$.\n\nFor a fixed $k_z$ slice (a two-dimensional BZ parameterized by $(k_x,k_y)$), your task is to compute the Wilson loop (Berry holonomy) along the closed loop in $k_x$ for each value of $k_y$, and then extract the Chern number of the occupied band from the winding of the Wilson-loop phase versus $k_y$. Use the following fundamental definitions:\n\n- The occupied-band eigenvector $|u(\\mathbf{k})\\rangle$ is the normalized eigenvector of $H(\\mathbf{k})$ associated with the lower energy $E_-(\\mathbf{k}) = -\\sqrt{d_x^2 + d_y^2 + d_z^2}$.\n- For a discretized loop $\\{k_x^j\\}_{j=0}^{N_x-1}$ at fixed $(k_y,k_z)$ with periodic closure $k_x^{N_x} \\equiv k_x^0$, define the link variable at each segment as the overlap $\\mathcal{U}_j = \\langle u(k_x^{j+1},k_y,k_z)|u(k_x^{j},k_y,k_z)\\rangle$ and the normalized link variable $\\tilde{\\mathcal{U}}_j = \\mathcal{U}_j/|\\mathcal{U}_j|$.\n- The Wilson-loop phase at $(k_y,k_z)$ is\n$$\n\\phi(k_y;k_z) = \\arg\\!\\left(\\prod_{j=0}^{N_x-1}\\tilde{\\mathcal{U}}_j\\right).\n$$\n- The slice Chern number is obtained from the winding of $\\phi(k_y;k_z)$ as $k_y$ cycles a closed path:\n$$\nC(k_z) = \\frac{1}{2\\pi}\\,\\Delta \\phi(k_y;k_z),\n$$\nwhere $\\Delta \\phi$ is the net unwrapped change in $\\phi$ as $k_y$ goes from $0$ to $2\\pi$.\n\nYou must also implement numerical gauge consistency checks:\n- Unitarity check of raw overlap product along the loop: quantify the deviation of $\\left|\\prod_{j}\\mathcal{U}_j\\right|$ from unity. Report the maximum deviation over all $k_y$ as a nonnegative float.\n- Gauge invariance check: apply a random Unitary group of degree one (U(1)) phase $e^{i\\theta(\\mathbf{k})}$ independently at each $\\mathbf{k}$ to form $|u'(\\mathbf{k})\\rangle = e^{i\\theta(\\mathbf{k})}|u(\\mathbf{k})\\rangle$, recompute $\\phi'(k_y;k_z)$ using normalized link variables, and report the maximum absolute phase difference $|\\arg(e^{i(\\phi'-\\phi)})|$ over $k_y$ as a nonnegative float.\n\nCompute, for each specified test case, the following outputs in order:\n- The Chern number $C(k_z)$ of the slice as an integer derived from the Wilson-loop winding.\n- The minimum spectral gap over the $(k_x,k_y)$ slice as a float, defined as $2\\min_{\\mathbf{k}}|E_-(\\mathbf{k})|$ in the specified discretization.\n- The maximum unitarity deviation of the raw overlap product over $k_y$ as a float.\n- The maximum gauge invariance phase difference over $k_y$ as a float.\n\nAll angles must be in radians. Use uniform discretizations of $k_x$ and $k_y$ over $[0,2\\pi)$ with the provided grid sizes. Your program must not read any input and must use only internal data.\n\nTest Suite:\nCompute the outputs for the following parameter sets $(m_0,k_z,N_x,N_y)$:\n1. $(2.0,\\,0.3\\pi,\\,401,\\,101)$: a gapped slice expected to have nontrivial topology near the center of the region between suspected nodes.\n2. $(2.0,\\,\\pi,\\,401,\\,101)$: a gapped slice well outside the suspected nodal region.\n3. $(1.5,\\,0.6\\pi,\\,401,\\,101)$: a gapped slice just below the suspected nodal $k_z$ for $m_0=1.5$.\n4. $(1.5,\\,0.75\\pi,\\,401,\\,101)$: a gapped slice just above the suspected nodal $k_z$ for $m_0=1.5$.\n5. $(2.0,\\,\\frac{\\pi}{2},\\,401,\\,101)$: a boundary slice tuned exactly to a suspected nodal $k_z$, which challenges numerical stability.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list in the order [Chern,min_gap,max_unitarity_deviation,max_gauge_phase_difference]. For example, print\n$$\n[\\,[C_1,\\Delta_1,U_1,G_1],[C_2,\\Delta_2,U_2,G_2],\\dots,[C_5,\\Delta_5,U_5,G_5]\\,]\n$$\nwith numbers as decimals or integers, and with no spaces.", "solution": "The problem asks for the implementation of a numerical algorithm to characterize the topological properties of a two-band tight-binding model for a Weyl semimetal. The characterization is performed on two-dimensional slices of the three-dimensional Brillouin Zone (BZ) by computing the Chern number via the Wilson loop method. The validity and robustness of the numerical implementation are to be confirmed through specific consistency checks.\n\nThe physical system is described by a momentum-space Hamiltonian on a simple cubic lattice, given by:\n$$\nH(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma} = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z\n$$\nwhere $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ is the vector of Pauli matrices, $\\mathbf{k}=(k_x, k_y, k_z)$ is the crystal momentum, and the components of the $\\mathbf{d}$-vector are:\n$$\nd_x(\\mathbf{k}) = \\sin(k_x) \\\\\nd_y(\\mathbf{k}) = \\sin(k_y) \\\\\nd_z(\\mathbf{k}) = m_0 - \\cos(k_x) - \\cos(k_y) - \\cos(k_z)\n$$\nThis Hamiltonian has two energy bands with eigenvalues $E_\\pm(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm \\sqrt{d_x^2 + d_y^2 + d_z^2}$. The bands are degenerate at points where $\\mathbf{d}(\\mathbf{k})=\\mathbf{0}$, known as Weyl nodes. These nodes are topologically protected and act as sources or sinks of Berry curvature. The spectral gap on a given slice of the BZ is $2 \\min_{\\mathbf{k}} |\\mathbf{d}(\\mathbf{k})|$.\n\nThe topological invariant for a gapped two-dimensional slice (at fixed $k_z$) is the first Chern number, $C(k_z)$. It quantifies the winding of the $\\mathbf{d}$-vector on the unit sphere as $\\mathbf{k}$ covers the 2D BZ torus. A non-zero Chern number, $C(k_z) \\neq 0$, indicates that the slice is topologically non-trivial. The problem specifies a robust numerical method to compute $C(k_z)$ using Wilson loops.\n\nThe algorithm proceeds as follows:\nFirst, for a given test case specified by parameters $(m_0, k_z, N_x, N_y)$, we discretize the two-dimensional BZ slice into a grid of $(k_x, k_y)$ points. For each point on this grid, the occupied-band eigenvector $|u(\\mathbf{k})\\rangle$ corresponding to the lower energy eigenvalue $E_-(\\mathbf{k}) = -|\\mathbf{d}(\\mathbf{k})|$ is computed. Numerically, this is achieved by constructing the $2 \\times 2$ Hermitian matrix $H(\\mathbf{k})$ and using a standard eigensolver, such as `numpy.linalg.eigh`, which provides numerically stable and normalized eigenvectors. We also calculate the minimum spectral gap on the slice by tracking the minimum value of $2|\\mathbf{d}(\\mathbf{k})|$ over the entire grid.\n\nSecond, we compute the Wilson loop phase $\\phi(k_y; k_z)$ for each discrete value of $k_y$ in its grid. The Wilson loop is traced along a closed path in the $k_x$ direction. This involves computing a product of \"link variables\" $\\mathcal{U}_j = \\langle u(k_x^{j+1}, k_y, k_z) | u(k_x^j, k_y, k_z) \\rangle$. The inner product is taken between eigenvectors at adjacent points on the discretized $k_x$ path, including a final link from the last point back to the first to ensure closure. To ensure gauge invariance, each link variable is normalized before multiplication, yielding $\\tilde{\\mathcal{U}}_j = \\mathcal{U}_j / |\\mathcal{U}_j|$. The Wilson loop phase is then the argument of the full product:\n$$\n\\phi(k_y; k_z) = \\arg\\left(\\prod_{j=0}^{N_x-1} \\tilde{\\mathcal{U}}_j\\right)\n$$\n\nThird, the Chern number $C(k_z)$ is extracted from the winding of the Wilson loop phase $\\phi(k_y)$ as $k_y$ traverses its closed path from $0$ to $2\\pi$. This winding number is calculated by first unwrapping the phase $\\phi(k_y)$ to obtain a continuous function, and then determining its total change over the periodic path. The Chern number is this total change divided by $2\\pi$:\n$$\nC(k_z) = \\frac{1}{2\\pi} \\oint d\\phi = \\frac{1}{2\\pi} \\Delta\\phi_{\\text{total}}\n$$\nThe result, which must be an integer for a gapped system, is obtained by rounding the computed value.\n\nFourth, two numerical consistency checks are performed.\n1.  **Unitarity Check**: For a perfectly smooth gauge choice, the product of raw (un-normalized) link variables $\\prod_j \\mathcal{U}_j$ would have a magnitude of exactly $1$. Numerical discretization introduces deviations. We quantify this by calculating the maximum deviation $|1 - |\\prod_j \\mathcal{U}_j||$ across all computed Wilson loops (i.e., over all $k_y$).\n2.  **Gauge Invariance Check**: The computed Wilson loop phase $\\phi(k_y)$ must be invariant under a local U(1) gauge transformation of the eigenvectors, $|u'(\\mathbf{k})\\rangle = e^{i\\theta(\\mathbf{k})} |u(\\mathbf{k})\\rangle$, where $\\theta(\\mathbf{k})$ is a random phase at each point. This is because the random phases cancel telescopically in the product of normalized link variables. We verify this by applying such a random phase transformation, re-computing the Wilson loop phase $\\phi'(k_y)$, and finding the maximum phase difference $|\\arg(e^{i(\\phi'-\\phi)})|$ over all $k_y$. This difference should be close to zero, limited only by floating-point precision.\n\nThe implementation computes these four quantities—Chern number, minimum spectral gap, maximum unitarity deviation, and maximum gauge phase difference—for each of the provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    \n    # Test Suite:\n    # (m_0, k_z, N_x, N_y)\n    test_cases = [\n        (2.0, 0.3 * np.pi, 401, 101),\n        (2.0, np.pi, 401, 101),\n        (1.5, 0.6 * np.pi, 401, 101),\n        (1.5, 0.75 * np.pi, 401, 101),\n        (2.0, 0.5 * np.pi, 401, 101),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_slice_properties(*params)\n        results.append(result)\n\n    # Format the final output string as specified\n    result_str = \",\".join([f\"[{c},{g},{u},{gd}]\" for c, g, u, gd in results])\n    print(f\"[{result_str}]\")\n\n\ndef compute_slice_properties(m0, kz, Nx, Ny):\n    \"\"\"\n    Computes topological properties for a single (m0, kz) slice.\n\n    Args:\n        m0 (float): Model parameter.\n        kz (float): Momentum slice value.\n        Nx (int): Number of points in the kx grid.\n        Ny (int): Number of points in the ky grid.\n\n    Returns:\n        list: [Chern number, min_gap, max_unitarity_dev, max_gauge_phase_diff]\n    \"\"\"\n    # 1. Grid setup\n    kx_grid = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    ky_grid = np.linspace(0, 2 * np.pi, Ny, endpoint=False)\n    \n    cos_kx_vals = np.cos(kx_grid)\n    sin_kx_vals = np.sin(kx_grid)\n    cos_ky_vals = np.cos(ky_grid)\n    sin_ky_vals = np.sin(ky_grid)\n    cos_kz = np.cos(kz)\n\n    # Storage for eigenvectors and gap calculation\n    all_evecs = np.zeros((Ny, Nx, 2), dtype=np.complex128)\n    min_gap_slice = np.inf\n\n    # 2. Compute eigenvectors and minimum gap over the full (kx, ky) slice\n    H = np.zeros((2, 2), dtype=np.complex128)\n    for i in range(Ny):\n        for j in range(Nx):\n            # d-vector components\n            dx = sin_kx_vals[j]\n            dy = sin_ky_vals[i]\n            dz = m0 - cos_kx_vals[j] - cos_ky_vals[i] - cos_kz\n            \n            d_norm = np.sqrt(dx**2 + dy**2 + dz**2)\n            if 2 * d_norm < min_gap_slice:\n                min_gap_slice = 2 * d_norm\n\n            # Form Hamiltonian matrix\n            H[0, 0] = dz\n            H[1, 1] = -dz\n            H[0, 1] = dx - 1j * dy\n            H[1, 0] = dx + 1j * dy\n            \n            # Diagonalize and store the occupied eigenvector.\n            # np.linalg.eigh returns sorted eigenvalues; the first eigenvector\n            # corresponds to the lowest energy (occupied band).\n            _, evecs = np.linalg.eigh(H)\n            all_evecs[i, j, :] = evecs[:, 0]\n\n    # Generate random U(1) phases for the gauge invariance check\n    random_phases = np.random.rand(Ny, Nx) * 2 * np.pi\n    random_phase_factors = np.exp(1j * random_phases)\n\n    # Storage for Wilson loop results\n    wilson_phases = np.zeros(Ny, dtype=np.float64)\n    unitarity_devs = np.zeros(Ny, dtype=np.float64)\n    gauge_phase_diffs = np.zeros(Ny, dtype=np.float64)\n\n    # 3. Loop over ky to compute Wilson loops and perform checks\n    for i in range(Ny):\n        slice_evecs = all_evecs[i, :, :]\n        \n        # Calculate Wilson loop product\n        raw_product = 1.0 + 0.0j\n        norm_product = 1.0 + 0.0j\n        for j in range(Nx):\n            u_current = slice_evecs[j, :]\n            u_next = slice_evecs[(j + 1) % Nx, :]\n            \n            # Link variable U_j = <u(k_x^{j+1})|u(k_x^j)>\n            # np.vdot(a, b) is a.conj().T @ b = <a|b>\n            # The problem asks for <u(k_x^{j+1})|u(k_x^j)>, which means <u_next|u_current>.\n            # So, we call np.vdot(u_next, u_current).\n            link_var = np.vdot(u_next, u_current)\n            \n            raw_product *= link_var\n            abs_link = np.abs(link_var)\n            if abs_link > 1e-12: # Avoid division by zero if link is numerically zero\n                norm_product *= link_var / abs_link\n\n        wilson_phases[i] = np.angle(norm_product)\n        unitarity_devs[i] = np.abs(1.0 - np.abs(raw_product))\n\n        # Gauge invariance check\n        phased_slice_evecs = slice_evecs * random_phase_factors[i, :][:, np.newaxis]\n        norm_product_prime = 1.0 + 0.0j\n        for j in range(Nx):\n            u_current_p = phased_slice_evecs[j, :]\n            u_next_p = phased_slice_evecs[(j + 1) % Nx, :]\n            link_var_p = np.vdot(u_next_p, u_current_p)\n            abs_link_p = np.abs(link_var_p)\n            if abs_link_p > 1e-12:\n                norm_product_prime *= link_var_p / abs_link_p\n\n        phi_prime = np.angle(norm_product_prime)\n        phi = wilson_phases[i]\n        \n        # Phase difference wrapped to (-pi, pi]\n        delta_phi = phi_prime - phi\n        gauge_phase_diffs[i] = np.abs((delta_phi + np.pi) % (2 * np.pi) - np.pi)\n\n    # 4. Final calculations from collected data\n    max_unitarity_dev = np.max(unitarity_devs)\n    max_gauge_phase_diff = np.max(gauge_phase_diffs)\n    \n    # Chern number from winding of Wilson phase\n    unwrapped_phases = np.unwrap(wilson_phases)\n    # Add phase change from last point ky[-1] back to first ky[0] to close the loop\n    last_jump = (wilson_phases[0] - wilson_phases[-1] + np.pi) % (2 * np.pi) - np.pi\n    total_phase_change = (unwrapped_phases[-1] - unwrapped_phases[0]) + last_jump\n    \n    chern_number = int(np.round(total_phase_change / (2 * np.pi)))\n    \n    return [chern_number, min_gap_slice, max_unitarity_dev, max_gauge_phase_diff]\n\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3503638"}, {"introduction": "The remarkable transport phenomena in Weyl semimetals, such as the chiral anomaly, are direct consequences of the unique helical structure of their low-energy quasiparticles. This practice challenges you to connect band structure topology to physical observables by deriving, from first principles, how the spinor wavefunctions of Weyl fermions govern their scattering rates off impurities. This analytical exercise is key to understanding the mechanisms of chiral charge relaxation and the conditions under which novel transport signatures can be observed. [@problem_id:3503586]", "problem": "Consider an isotropic minimal model of a time-reversal-symmetry-broken Weyl semimetal with two Weyl nodes of opposite chirality located at crystal momenta $\\pm \\mathbf{b}$. In a low-energy description around each node, the Hamiltonian is $H_s=\\hbar v_F s\\, \\boldsymbol{\\sigma}\\cdot \\mathbf{q}$, where $s=\\pm 1$ is the chirality index, $\\mathbf{q}=\\mathbf{k}-s\\mathbf{b}$ is the crystal momentum measured from the node, $v_F$ is the Fermi velocity, and $\\boldsymbol{\\sigma}$ are the Pauli matrices acting on the pseudospin. The Fermi energy is $E_F>0$ measured from the nodes so that the Fermi surface consists of two spheres of radius $q_F=E_F/(\\hbar v_F)$ centered at $\\pm \\mathbf{b}$.\n\nAssume a scalar, delta-correlated, short-range impurity potential $V(\\mathbf{r})=\\sum_{i}u_{0}\\,\\delta(\\mathbf{r}-\\mathbf{R}_{i})$ with impurity number density $n_i$, and treat disorder within the first Born approximation and Fermi’s golden rule (FGR). You may assume that intervalley momentum transfer is allowed (i.e., the short-range potential does not suppress large momentum transfer), and that the densities of states at energy $E_F$ are identical for the two nodes.\n\nStarting from the Weyl projectors and the spinor structure implied by $H_s$ (do not assume any angular overlap factors without derivation), compute the total quasiparticle scattering rates at the Fermi energy due to the disorder for intranode scattering ($s\\to s$) and internode scattering ($s\\to -s$). Perform the angular integrations explicitly. Then provide the closed-form analytic expression for the ratio\n$$r=\\frac{\\Gamma_{\\text{inter}}}{\\Gamma_{\\text{intra}}}$$\nevaluated at $E_F$. Finally, based on your result for $r$, state briefly how the relative magnitude of the rates controls axial (chiral) charge relaxation and the suppression of the chiral-anomaly-induced longitudinal magnetoconductivity for delta-correlated disorder. Your final answer must be the single expression for $r$; no units are required.", "solution": "We begin with the isotropic Weyl Hamiltonian $H_{s}=\\hbar v_{F} s\\, \\boldsymbol{\\sigma}\\cdot \\mathbf{q}$. Its positive-energy eigenstates at energy $E=\\hbar v_{F} q$ have helicity aligned with $s\\,\\hat{\\mathbf{q}}$, where $\\hat{\\mathbf{q}}=\\mathbf{q}/q$. The projector onto the conduction-band spinor at node $s$ and direction $\\hat{\\mathbf{q}}$ is\n$$\nP_{s}(\\hat{\\mathbf{q}})=\\frac{1}{2}\\left( \\mathbb{I}+ s\\, \\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma}\\right).\n$$\nLet $\\lvert u_{s}(\\hat{\\mathbf{q}})\\rangle$ denote the corresponding normalized spinor. For scalar disorder, the spinor matrix element between initial state at node $s$ with direction $\\hat{\\mathbf{q}}$ and final state at node $s'$ with direction $\\hat{\\mathbf{q}}'$ enters the Fermi’s golden rule (FGR) rate through its modulus squared:\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}.\n$$\nA convenient way to evaluate this quantity is to use projectors. One has\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}\n= \\operatorname{Tr}\\!\\left[P_{s}(\\hat{\\mathbf{q}})\\, P_{s'}(\\hat{\\mathbf{q}}')\\right],\n$$\nbecause for rank-one projectors $P=\\lvert u\\rangle\\langle u\\rvert$ and $Q=\\lvert v\\rangle\\langle v\\rvert$, $\\operatorname{Tr}(PQ)=\\lvert\\langle v\\vert u\\rangle\\rvert^{2}$. Using Pauli matrix identities, in particular $\\operatorname{Tr}(\\sigma_{i})=0$, $\\operatorname{Tr}(\\sigma_{i}\\sigma_{j})=2\\delta_{ij}$, and expanding the product,\n$$\n\\operatorname{Tr}\\!\\left[P_{s}(\\hat{\\mathbf{q}})\\, P_{s'}(\\hat{\\mathbf{q}}')\\right]\n=\\frac{1}{4}\\operatorname{Tr}\\!\\left[ \\left(\\mathbb{I}+ s\\, \\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma}\\right)\\left(\\mathbb{I}+ s'\\, \\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma}\\right)\\right]\n=\\frac{1}{4}\\operatorname{Tr}\\!\\left[\\mathbb{I}+ s'\\, \\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma}+ s\\, \\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma}+ ss'\\, (\\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma})(\\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma})\\right].\n$$\nThe single-$\\boldsymbol{\\sigma}$ terms have zero trace, and $(\\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma})(\\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma})=\\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}' \\,\\mathbb{I}+ i(\\hat{\\mathbf{q}}\\times \\hat{\\mathbf{q}}')\\cdot \\boldsymbol{\\sigma}$, whose trace is $2\\,\\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}'$. Therefore,\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}\n=\\frac{1}{2}\\left(1+ ss'\\, \\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}'\\right).\n$$\n\nWe now compute total scattering rates at the Fermi energy using Fermi’s golden rule (FGR). The disorder potential is $V(\\mathbf{r})=\\sum_{i}u_{0}\\,\\delta(\\mathbf{r}-\\mathbf{R}_{i})$ with impurity density $n_{i}$, for which the squared matrix element averaged over impurity positions yields a constant $\\langle\\lvert V_{\\mathbf{q}'-\\mathbf{q}}\\rvert^{2}\\rangle = n_{i} \\lvert u_{0}\\rvert^{2}$, independent of the momentum transfer. The total rate for transitions $s\\to s'$ at energy $E$ is\n$$\n\\Gamma_{s\\to s'}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, \\int \\frac{d^{3}\\mathbf{q}'}{(2\\pi)^{3}}\\, \\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}\\, \\delta\\!\\left(\\hbar v_{F} q' - E\\right).\n$$\nThe initial direction $\\hat{\\mathbf{q}}$ can be fixed without loss of generality due to isotropy, and $q' = E/(\\hbar v_{F}) \\equiv q_{F}$ is fixed by the delta function. Performing the radial part of the integral using $\\delta(\\hbar v_{F} q' - E) = \\frac{1}{\\hbar v_{F}}\\, \\delta(q' - q_{F})$,\n$$\n\\Gamma_{s\\to s'}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, \\frac{q_{F}^{2}}{(2\\pi)^{3}}\\, \\frac{1}{\\hbar v_{F}} \\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}.\n$$\nDefine the Weyl density of states at energy $E$ per node, $D(E)=\\frac{E^{2}}{2\\pi^{2}(\\hbar v_{F})^{3}}=\\frac{q_{F}^{2}}{2\\pi^{2}\\hbar v_{F}}$. Then\n$$\n\\Gamma_{s\\to s'}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, D(E)\\, \\frac{1}{4\\pi}\\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}.\n$$\nIntroduce $\\theta$ as the angle between $\\hat{\\mathbf{q}}$ and $\\hat{\\mathbf{q}}'$, so that $\\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}'=\\cos\\theta$. Using the overlap found above,\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}=\\frac{1}{2}\\left(1+ ss'\\cos\\theta\\right).\n$$\nThe angular average over the unit sphere is\n$$\n\\frac{1}{4\\pi}\\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\frac{1}{2}\\left(1+ ss'\\cos\\theta\\right)\n=\\frac{1}{2}\\left(1+ ss'\\, \\frac{1}{4\\pi}\\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\cos\\theta\\right)\n=\\frac{1}{2}\\left(1+ ss'\\times 0\\right)\n=\\frac{1}{2},\n$$\nbecause $\\int d\\Omega\\, \\cos\\theta=0$ by symmetry. Therefore, both intranode ($s'=s$) and internode ($s'=-s$) total rates acquire the same angular factor of $\\frac{1}{2}$. Explicitly,\n$$\n\\Gamma_{\\text{intra}}(E)=\\Gamma_{s\\to s}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, D(E)\\, \\frac{1}{2},\\qquad\n\\Gamma_{\\text{inter}}(E)=\\Gamma_{s\\to -s}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, D(E)\\, \\frac{1}{2}.\n$$\nIt follows immediately that the ratio at the Fermi energy $E_{F}$ is\n$$\nr=\\frac{\\Gamma_{\\text{inter}}(E_{F})}{\\Gamma_{\\text{intra}}(E_{F})}=1.\n$$\n\nRegarding the influence on the chiral anomaly, the axial (chiral) charge relaxation time $\\tau_{v}$ is set by the internode rate, $\\tau_{v}^{-1}=\\Gamma_{\\text{inter}}$, because only internode processes relax the node population imbalance. Since for delta-correlated short-range disorder $\\Gamma_{\\text{inter}}$ is of the same magnitude as the intranode momentum-relaxing rate, there is no parametric separation between $\\tau_{v}$ and the transport time, implying strong suppression of the chiral-anomaly-induced longitudinal magnetoconductivity relative to cases with smooth disorder where $\\Gamma_{\\text{inter}}\\ll \\Gamma_{\\text{intra}}$.", "answer": "$$\\boxed{1}$$", "id": "3503586"}]}