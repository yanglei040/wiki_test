{"hands_on_practices": [{"introduction": "Accurately computing transport coefficients like shear viscosity ($\\eta$) and thermal conductivity ($\\kappa$) is a fundamental task in the simulation of amorphous materials. This exercise provides hands-on practice with two powerful but distinct approaches: the equilibrium Green-Kubo method, rooted in the fluctuation-dissipation theorem, and the direct application of external fields in Nonequilibrium Molecular Dynamics (NEMD). By working through this problem ([@problem_id:3432506]), you will not only implement these techniques but also learn to critically assess and quantify the systematic biases introduced by finite simulation sizes and times, a crucial skill for producing reliable computational results.", "problem": "Consider a model glassy material simulated under periodic boundary conditions at constant number of particles, volume, and temperature. Define the transport coefficients shear viscosity $\\eta$ and thermal conductivity $\\kappa$ in terms of time autocorrelation functions by the Green–Kubo (GK) relations derived from the fluctuation–dissipation theorem. Benchmark Green–Kubo (GK) against Nonequilibrium Molecular Dynamics (NEMD) steady-state methods and quantify bias induced by finite simulation time $t_{\\text{max}}$ and finite size $N$. Work in Lennard–Jones reduced units with number density $\\rho = 1$, so that lengths are in particle diameters, times in reduced time, and transport coefficients are dimensionless. All outputs must be expressed as dimensionless decimal numbers.\n\nFundamental base for derivation:\n- The Green–Kubo relation for a transport coefficient $\\chi$ (standing in for either $\\eta$ or $\\kappa$) expresses $\\chi$ as an integral over the equilibrium time autocorrelation function $C_{\\chi}(t)$: $$\\chi = \\int_{0}^{\\infty} C_{\\chi}(t)\\,dt.$$\n- In glassy materials, equilibrium autocorrelation functions often decay as stretched exponentials, a widely observed and well-tested characterization for amorphous relaxations: $$C_{\\chi}(t;N) = A_{\\chi}(N)\\,\\exp\\!\\bigl(-\\bigl(t/\\tau_{\\chi}(N)\\bigr)^{\\beta_{\\chi}}\\bigr),$$ where $A_{\\chi}(N)$ is the amplitude, $\\tau_{\\chi}(N)$ is the characteristic relaxation time, and $\\beta_{\\chi}\\in(0,1]$ is the stretching exponent.\n- Finite-size effects suppress long-wavelength modes via wavevector quantization $k_{\\min}=2\\pi/L$ with $L$ the box length. In reduced units with $\\rho=1$, $L(N)=N^{1/3}$. To leading order, model this suppression by $$A_{\\chi}(N) = A_{\\chi}^{(\\infty)}\\bigl(1 - s_{A,\\chi}\\,N^{-1/3}\\bigr),\\qquad \\tau_{\\chi}(N) = \\tau_{\\chi}^{(\\infty)}\\bigl(1 - s_{\\tau,\\chi}\\,N^{-1/3}\\bigr),$$ where $A_{\\chi}^{(\\infty)}$ and $\\tau_{\\chi}^{(\\infty)}$ are infinite-size baselines and $s_{A,\\chi}$, $s_{\\tau,\\chi}$ are small positive constants.\n- The Nonequilibrium Molecular Dynamics (NEMD) estimator for $\\eta$ under applied shear rate $\\dot{\\gamma}$ follows a Newtonian-to-non-Newtonian crossover; model shear-thinning in glasses by $$\\eta_{\\text{NEMD}}(N,\\dot{\\gamma},t_{\\text{max}}) = \\eta_{0}(N)\\,\\frac{1}{1+\\bigl(\\dot{\\gamma}\\,\\tau_{\\eta}(N)\\bigr)^{m}}\\Bigl(1 - e^{-t_{\\text{max}}/\\tau_{\\eta}(N)}\\Bigr),$$ where $m$ is a positive exponent and $\\eta_{0}(N)$ is the zero-shear viscosity of the finite system, defined consistently with equilibrium by $\\eta_{0}(N)=\\int_{0}^{\\infty} C_{\\eta}(t;N)\\,dt$. The factor $\\bigl(1 - e^{-t_{\\text{max}}/\\tau_{\\eta}(N)}\\bigr)$ captures incomplete approach to steady state over finite $t_{\\text{max}}$.\n- The NEMD estimator for $\\kappa$ under an imposed temperature gradient of magnitude $g=\\lVert\\nabla T\\rVert$ similarly shows nonlinear response for large $g$; model this by $$\\kappa_{\\text{NEMD}}(N,g,t_{\\text{max}}) = \\kappa_{0}(N)\\,\\frac{1}{1+\\bigl(g\\,\\tau_{\\kappa}(N)\\bigr)^{2}}\\Bigl(1 - e^{-t_{\\text{max}}/\\tau_{\\kappa}(N)}\\Bigr),$$ with $\\kappa_{0}(N)=\\int_{0}^{\\infty} C_{\\kappa}(t;N)\\,dt$ the zero-gradient conductivity of the finite system.\n\nYou are to compute and compare the following, using the above models:\n- The infinite-time, infinite-size baselines $$\\eta^{(\\infty)} = \\int_{0}^{\\infty} A_{\\eta}^{(\\infty)}\\,\\exp\\!\\bigl(-\\bigl(t/\\tau_{\\eta}^{(\\infty)}\\bigr)^{\\beta_{\\eta}}\\bigr)\\,dt,\\qquad \\kappa^{(\\infty)} = \\int_{0}^{\\infty} A_{\\kappa}^{(\\infty)}\\,\\exp\\!\\bigl(-\\bigl(t/\\tau_{\\kappa}^{(\\infty)}\\bigr)^{\\beta_{\\kappa}}\\bigr)\\,dt.$$\n- The Green–Kubo finite-time estimator for a system of size $N$: $$\\eta_{\\text{GK}}(N,t_{\\text{max}})=\\int_{0}^{t_{\\text{max}}} C_{\\eta}(t;N)\\,dt,\\qquad \\kappa_{\\text{GK}}(N,t_{\\text{max}})=\\int_{0}^{t_{\\text{max}}} C_{\\kappa}(t;N)\\,dt.$$\n- The Nonequilibrium Molecular Dynamics estimators $\\eta_{\\text{NEMD}}(N,\\dot{\\gamma},t_{\\text{max}})$ and $\\kappa_{\\text{NEMD}}(N,g,t_{\\text{max}})$ as given above.\n\nFor the stretched exponential, use the identity $$\\int_{0}^{\\infty}\\exp\\!\\bigl(-\\bigl(t/\\tau\\bigr)^{\\beta}\\bigr)\\,dt = \\frac{\\tau}{\\beta}\\,\\Gamma\\!\\bigl(1/\\beta\\bigr),$$ and for truncation at $t_{\\text{max}}$ $$\\int_{0}^{t_{\\text{max}}}\\exp\\!\\bigl(-\\bigl(t/\\tau\\bigr)^{\\beta}\\bigr)\\,dt = \\frac{\\tau}{\\beta}\\,\\gamma\\!\\bigl(1/\\beta,(t_{\\text{max}}/\\tau)^{\\beta}\\bigr),$$ where $\\Gamma$ is the gamma function and $\\gamma$ is the lower incomplete gamma function.\n\nDefine the relative biases (dimensionless) with respect to the infinite-time, infinite-size baselines: $$b_{\\eta}^{\\text{GK}} = \\frac{\\eta_{\\text{GK}}(N,t_{\\text{max}}) - \\eta^{(\\infty)}}{\\eta^{(\\infty)}},\\quad b_{\\kappa}^{\\text{GK}} = \\frac{\\kappa_{\\text{GK}}(N,t_{\\text{max}}) - \\kappa^{(\\infty)}}{\\kappa^{(\\infty)}},$$ $$b_{\\eta}^{\\text{NEMD}} = \\frac{\\eta_{\\text{NEMD}}(N,\\dot{\\gamma},t_{\\text{max}}) - \\eta^{(\\infty)}}{\\eta^{(\\infty)}},\\quad b_{\\kappa}^{\\text{NEMD}} = \\frac{\\kappa_{\\text{NEMD}}(N,g,t_{\\text{max}}) - \\kappa^{(\\infty)}}{\\kappa^{(\\infty)}}.$$\n\nParameter values for the test suite (in reduced units):\n- Baseline amplitudes and relaxation times: $A_{\\eta}^{(\\infty)} = 0.8$, $\\tau_{\\eta}^{(\\infty)} = 10.0$, $A_{\\kappa}^{(\\infty)} = 0.5$, $\\tau_{\\kappa}^{(\\infty)} = 5.0$.\n- Finite-size scaling coefficients: $s_{A,\\eta} = 0.5$, $s_{\\tau,\\eta} = 0.3$, $s_{A,\\kappa} = 0.3$, $s_{\\tau,\\kappa} = 0.2$.\n- Shear-thinning exponent: $m = 2$.\n\nTest cases (each case is a tuple $(N, t_{\\text{max}}, \\beta_{\\eta}, \\beta_{\\kappa}, \\dot{\\gamma}, g)$):\n- Case $1$: $(32768, 50.0, 0.6, 0.7, 0.01, 0.02)$.\n- Case $2$: $(2048, 5.0, 0.5, 0.5, 0.001, 0.005)$.\n- Case $3$: $(65536, 200.0, 1.0, 0.9, 0.05, 0.10)$.\n- Case $4$: $(1024, 20.0, 0.4, 0.6, 0.02, 0.05)$.\n\nYour task:\n- Implement a program that, for each test case, computes the four relative biases $b_{\\eta}^{\\text{GK}}$, $b_{\\eta}^{\\text{NEMD}}$, $b_{\\kappa}^{\\text{GK}}$, $b_{\\kappa}^{\\text{NEMD}}$ using the above models and formulae.\n- All quantities must be treated as dimensionless in reduced units, and all four biases must be returned as decimal numbers.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, flattening case-by-case results in the following order: for each case in the order listed, append $b_{\\eta}^{\\text{GK}}$, $b_{\\eta}^{\\text{NEMD}}$, $b_{\\kappa}^{\\text{GK}}$, $b_{\\kappa}^{\\text{NEMD}}$.\n\nThe output must therefore be a single list of $16$ floats (since there are $4$ test cases and $4$ biases per case), in the exact order specified, printed on one line as $[x_{1},x_{2},\\dots,x_{16}]$.", "solution": "### Solution Derivation\n\nThe objective is to calculate the four relative biases $b_{\\eta}^{\\text{GK}}$, $b_{\\eta}^{\\text{NEMD}}$, $b_{\\kappa}^{\\text{GK}}$, and $b_{\\kappa}^{\\text{NEMD}}$ for each specified test case. This requires calculating the ideal transport coefficients and their finite-system, finite-time estimators. Let $\\chi$ represent either the shear viscosity $\\eta$ or the thermal conductivity $\\kappa$.\n\n**1. Ideal Infinite-System Baseline Coefficients ($\\chi^{(\\infty)}$)**\n\nThe ideal transport coefficients in the thermodynamic ($N \\to \\infty$) and infinite-time ($t_{\\text{max}} \\to \\infty$) limit serve as the reference for calculating bias. Using the provided integral identity for the stretched exponential, we have:\n$$ \\eta^{(\\infty)} = \\int_{0}^{\\infty} A_{\\eta}^{(\\infty)}\\,\\exp\\!\\bigl(-\\bigl(t/\\tau_{\\eta}^{(\\infty)}\\bigr)^{\\beta_{\\eta}}\\bigr)\\,dt = A_{\\eta}^{(\\infty)} \\frac{\\tau_{\\eta}^{(\\infty)}}{\\beta_{\\eta}}\\,\\Gamma\\!\\bigl(1/\\beta_{\\eta}\\bigr) $$\n$$ \\kappa^{(\\infty)} = \\int_{0}^{\\infty} A_{\\kappa}^{(\\infty)}\\,\\exp\\!\\bigl(-\\bigl(t/\\tau_{\\kappa}^{(\\infty)}\\bigr)^{\\beta_{\\kappa}}\\bigr)\\,dt = A_{\\kappa}^{(\\infty)} \\frac{\\tau_{\\kappa}^{(\\infty)}}{\\beta_{\\kappa}}\\,\\Gamma\\!\\bigl(1/\\beta_{\\kappa}\\bigr) $$\nNote that the stretching exponents $\\beta_{\\eta}$ and $\\beta_{\\kappa}$ are provided on a per-case basis, so $\\eta^{(\\infty)}$ and $\\kappa^{(\\infty)}$ must be re-calculated for each test case.\n\n**2. Finite-Size Parameters ($A_{\\chi}(N)$, $\\tau_{\\chi}(N)$)**\n\nFor a finite system of $N$ particles, the amplitude and relaxation time are adjusted according to the given scaling relations:\n$$ A_{\\chi}(N) = A_{\\chi}^{(\\infty)}\\bigl(1 - s_{A,\\chi}\\,N^{-1/3}\\bigr) $$\n$$ \\tau_{\\chi}(N) = \\tau_{\\chi}^{(\\infty)}\\bigl(1 - s_{\\tau,\\chi}\\,N^{-1/3}\\bigr) $$\nThese finite-size parameters will be used for both the GK and NEMD estimators.\n\n**3. Green-Kubo (GK) Estimators ($\\chi_{\\text{GK}}$)**\n\nThe GK estimators are calculated by integrating the finite-size correlation function $C_{\\chi}(t;N)$ up to a finite time $t_{\\text{max}}$. Using the provided identity involving the lower incomplete gamma function, $\\gamma(s,x)$:\n$$ \\eta_{\\text{GK}}(N, t_{\\text{max}}) = \\int_{0}^{t_{\\text{max}}} A_{\\eta}(N)\\,\\exp\\!\\bigl(-\\bigl(t/\\tau_{\\eta}(N)\\bigr)^{\\beta_{\\eta}}\\bigr)\\,dt = A_{\\eta}(N) \\frac{\\tau_{\\eta}(N)}{\\beta_{\\eta}}\\,\\gamma\\!\\left(\\frac{1}{\\beta_{\\eta}},\\left(\\frac{t_{\\text{max}}}{\\tau_{\\eta}(N)}\\right)^{\\beta_{\\eta}}\\right) $$\n$$ \\kappa_{\\text{GK}}(N, t_{\\text{max}}) = \\int_{0}^{t_{\\text{max}}} A_{\\kappa}(N)\\,\\exp\\!\\bigl(-\\bigl(t/\\tau_{\\kappa}(N)\\bigr)^{\\beta_{\\kappa}}\\bigr)\\,dt = A_{\\kappa}(N) \\frac{\\tau_{\\kappa}(N)}{\\beta_{\\kappa}}\\,\\gamma\\!\\left(\\frac{1}{\\beta_{\\kappa}},\\left(\\frac{t_{\\text{max}}}{\\tau_{\\kappa}(N)}\\right)^{\\beta_{\\kappa}}\\right) $$\n\n**4. Nonequilibrium Molecular Dynamics (NEMD) Estimators ($\\chi_{\\text{NEMD}}$)**\n\nThe NEMD estimators are functions of the zero-perturbation coefficient $\\chi_0(N)$, a nonlinear response term, and a transient term.\n\nFirst, we define the zero-perturbation, finite-size coefficient $\\chi_0(N)$ by integrating the finite-size correlation function to infinity:\n$$ \\eta_{0}(N) = \\int_{0}^{\\infty} C_{\\eta}(t;N)\\,dt = A_{\\eta}(N) \\frac{\\tau_{\\eta}(N)}{\\beta_{\\eta}}\\,\\Gamma\\!\\bigl(1/\\beta_{\\eta}\\bigr) $$\n$$ \\kappa_{0}(N) = \\int_{0}^{\\infty} C_{\\kappa}(t;N)\\,dt = A_{\\kappa}(N) \\frac{\\tau_{\\kappa}(N)}{\\beta_{\\kappa}}\\,\\Gamma\\!\\bigl(1/\\beta_{\\kappa}\\bigr) $$\n\nThen, we apply the specified NEMD models:\nFor viscosity, the shear-thinning model is applied with shear rate $\\dot{\\gamma}$ and exponent $m=2$:\n$$ \\eta_{\\text{NEMD}}(N,\\dot{\\gamma},t_{\\text{max}}) = \\eta_{0}(N)\\,\\frac{1}{1+\\bigl(\\dot{\\gamma}\\,\\tau_{\\eta}(N)\\bigr)^{m}}\\Bigl(1 - e^{-t_{\\text{max}}/\\tau_{\\eta}(N)}\\Bigr) $$\nFor thermal conductivity, the nonlinear response model is applied with temperature gradient magnitude $g$:\n$$ \\kappa_{\\text{NEMD}}(N,g,t_{\\text{max}}) = \\kappa_{0}(N)\\,\\frac{1}{1+\\bigl(g\\,\\tau_{\\kappa}(N)\\bigr)^{2}}\\Bigl(1 - e^{-t_{\\text{max}}/\\tau_{\\kappa}(N)}\\Bigr) $$\n\n**5. Relative Biases ($b_{\\chi}$)**\n\nFinally, the four relative biases are computed by comparing each estimator to its corresponding ideal baseline value:\n$$ b_{\\eta}^{\\text{GK}} = \\frac{\\eta_{\\text{GK}}(N,t_{\\text{max}}) - \\eta^{(\\infty)}}{\\eta^{(\\infty)}} $$\n$$ b_{\\eta}^{\\text{NEMD}} = \\frac{\\eta_{\\text{NEMD}}(N,\\dot{\\gamma},t_{\\text{max}}) - \\eta^{(\\infty)}}{\\eta^{(\\infty)}} $$\n$$ b_{\\kappa}^{\\text{GK}} = \\frac{\\kappa_{\\text{GK}}(N,t_{\\text{max}}) - \\kappa^{(\\infty)}}{\\kappa^{(\\infty)}} $$\n$$ b_{\\kappa}^{\\text{NEMD}} = \\frac{\\kappa_{\\text{NEMD}}(N,g,t_{\\text{max}}) - \\kappa^{(\\infty)}}{\\kappa^{(\\infty)}} $$\n\nThese formulae provide a complete algorithm for solving the problem for each test case. The implementation requires functions for the gamma ($\\Gamma$) and lower incomplete gamma ($\\gamma$) functions, which are available in standard scientific computing libraries. The lower incomplete gamma function $\\gamma(a,x)$ is computed from the regularized incomplete gamma function $P(a,x)$ via the relation $\\gamma(a,x) = P(a,x)\\Gamma(a)$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gamma, gammainc\n\ndef solve():\n    \"\"\"\n    Computes and compares relative biases for transport coefficient estimators\n    in a model glassy material.\n    \"\"\"\n    \n    # Define constant parameters from the problem statement in reduced units.\n    # Baseline infinite-size amplitudes\n    A_eta_inf = 0.8\n    A_kappa_inf = 0.5\n    \n    # Baseline infinite-size relaxation times\n    tau_eta_inf = 10.0\n    tau_kappa_inf = 5.0\n    \n    # Finite-size scaling coefficients\n    s_A_eta = 0.5\n    s_tau_eta = 0.3\n    s_A_kappa = 0.3\n    s_tau_kappa = 0.2\n    \n    # Shear-thinning exponent for NEMD viscosity\n    m = 2.0\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (N, t_max, beta_eta, beta_kappa, gamma_dot, g)\n    test_cases = [\n        (32768, 50.0, 0.6, 0.7, 0.01, 0.02),\n        (2048, 5.0, 0.5, 0.5, 0.001, 0.005),\n        (65536, 200.0, 1.0, 0.9, 0.05, 0.10),\n        (1024, 20.0, 0.4, 0.6, 0.02, 0.05),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, t_max, beta_eta, beta_kappa, gamma_dot, g = case\n\n        # --- Shear Viscosity (eta) Calculations ---\n\n        # 1. Ideal infinite-system baseline (eta_inf)\n        # eta_inf = A_eta_inf * (tau_eta_inf / beta_eta) * Gamma(1 / beta_eta)\n        one_over_beta_eta = 1.0 / beta_eta\n        gamma_of_one_over_beta_eta = gamma(one_over_beta_eta)\n        eta_inf = A_eta_inf * (tau_eta_inf / beta_eta) * gamma_of_one_over_beta_eta\n\n        # 2. Finite-size parameters (A_eta_N, tau_eta_N)\n        N_inv_third = N**(-1.0/3.0)\n        A_eta_N = A_eta_inf * (1.0 - s_A_eta * N_inv_third)\n        tau_eta_N = tau_eta_inf * (1.0 - s_tau_eta * N_inv_third)\n\n        # 3. Green-Kubo estimator (eta_gk)\n        # The lower incomplete gamma function gamma(a,x) is computed from the \n        # regularized version P(a,x) = gammainc(a,x) as gamma(a,x) = P(a,x) * Gamma(a).\n        t_ratio_eta = t_max / tau_eta_N\n        gamma_arg_eta = t_ratio_eta**beta_eta\n        lower_inc_gamma_eta = gammainc(one_over_beta_eta, gamma_arg_eta) * gamma_of_one_over_beta_eta\n        eta_gk = A_eta_N * (tau_eta_N / beta_eta) * lower_inc_gamma_eta\n        \n        # 4. NEMD estimator (eta_nemd)\n        # First, calculate the zero-shear finite-size viscosity eta_0_N.\n        eta_0_N = A_eta_N * (tau_eta_N / beta_eta) * gamma_of_one_over_beta_eta\n        # Apply shear-thinning and transient factors.\n        shear_thinning_factor = 1.0 / (1.0 + (gamma_dot * tau_eta_N)**m)\n        transient_factor_eta = 1.0 - np.exp(-t_max / tau_eta_N)\n        eta_nemd = eta_0_N * shear_thinning_factor * transient_factor_eta\n\n        # 5. Relative biases for eta\n        b_eta_gk = (eta_gk - eta_inf) / eta_inf\n        b_eta_nemd = (eta_nemd - eta_inf) / eta_inf\n\n        # --- Thermal Conductivity (kappa) Calculations ---\n\n        # 1. Ideal infinite-system baseline (kappa_inf)\n        one_over_beta_kappa = 1.0 / beta_kappa\n        gamma_of_one_over_beta_kappa = gamma(one_over_beta_kappa)\n        kappa_inf = A_kappa_inf * (tau_kappa_inf / beta_kappa) * gamma_of_one_over_beta_kappa\n\n        # 2. Finite-size parameters (A_kappa_N, tau_kappa_N)\n        A_kappa_N = A_kappa_inf * (1.0 - s_A_kappa * N_inv_third)\n        tau_kappa_N = tau_kappa_inf * (1.0 - s_tau_kappa * N_inv_third)\n\n        # 3. Green-Kubo estimator (kappa_gk)\n        t_ratio_kappa = t_max / tau_kappa_N\n        gamma_arg_kappa = t_ratio_kappa**beta_kappa\n        lower_inc_gamma_kappa = gammainc(one_over_beta_kappa, gamma_arg_kappa) * gamma_of_one_over_beta_kappa\n        kappa_gk = A_kappa_N * (tau_kappa_N / beta_kappa) * lower_inc_gamma_kappa\n        \n        # 4. NEMD estimator (kappa_nemd)\n        # First, calculate the zero-gradient finite-size conductivity kappa_0_N.\n        kappa_0_N = A_kappa_N * (tau_kappa_N / beta_kappa) * gamma_of_one_over_beta_kappa\n        # Apply nonlinear response and transient factors.\n        nonlinear_response_factor = 1.0 / (1.0 + (g * tau_kappa_N)**2)\n        transient_factor_kappa = 1.0 - np.exp(-t_max / tau_kappa_N)\n        kappa_nemd = kappa_0_N * nonlinear_response_factor * transient_factor_kappa\n        \n        # 5. Relative biases for kappa\n        b_kappa_gk = (kappa_gk - kappa_inf) / kappa_inf\n        b_kappa_nemd = (kappa_nemd - kappa_inf) / kappa_inf\n\n        # Append results to the list in the specified order for each case\n        results.extend([b_eta_gk, b_eta_nemd, b_kappa_gk, b_kappa_nemd])\n\n    # Final print statement in the exact required format.\n    # The output is a single line: a list of 16 floats, comma-separated.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3432506"}, {"introduction": "Beyond simply measuring material properties, a key goal in glass science is to understand the nature of the glass transition itself. A central concept in this pursuit is kinetic fragility, which describes how sensitively a liquid's dynamics slow down upon cooling. This practice ([@problem_id:3432555]) challenges you to explore this concept by implementing a model that links the pressure-dependent fragility index ($m(P)$) to changes in the underlying atomic structure, specifically the mean coordination number ($\\langle Z(P) \\rangle$). The exercise provides a powerful example of how computational modeling can be used to test theories that forge connections between macroscopic behavior and microscopic arrangements.", "problem": "You are asked to develop a complete and runnable program that models how applied pressure alters the kinetic fragility of an amorphous material by coupling transport behavior to pressure-induced changes in mean atomic coordination. Your task is to implement, from first principles, an internally consistent, unit-aware, and testable computational pipeline that does all of the following.\n\n- Use a well-tested transport law for supercooled liquids that connects viscosity $\\,\\eta\\,$ to temperature $\\,T\\,$ and pressure $\\,P\\,$ through a pressure-dependent energy scale and an onset temperature. Adopt the parabolic transport law from Dynamic Facilitation (DF), written in natural logarithm form as $\\,\\ln \\eta(T,P) = \\ln \\eta_0 + J(P)\\,\\left(\\frac{1}{T} - \\frac{1}{T_0(P)}\\right)^2\\,$, where $\\,\\eta_0\\,$ is a reference viscosity, $\\,J(P)\\,$ is a pressure-dependent energy parameter with units chosen so that the argument of the exponential is dimensionless, and $\\,T_0(P)\\,$ is a pressure-dependent onset temperature marking the high-temperature crossover into activated dynamics. All temperatures must be in Kelvin (K), pressures in gigapascal (GPa), and viscosity in pascal·second (Pa·s).\n\n- Relate the pressure dependence of $\\,J(P)\\,$ to the pressure-induced increase in the mean coordination number $\\,\\langle Z(P)\\rangle\\,$. Use a saturating, monotonic coordination law $\\,\\langle Z(P)\\rangle = Z_0 + \\Delta Z_{\\max}\\,\\left(1 - e^{-P/P_c}\\right)\\,$ and couple $\\,J(P)\\,$ to $\\,\\langle Z(P)\\rangle\\,$ via a shifted power law above a critical coordination $\\,Z_c\\,$: $\\,J(P) = J_{\\min} + J_{\\text{coeff}}\\,\\max\\!\\left(\\langle Z(P)\\rangle - Z_c,\\,0\\right)^\\gamma\\,$. This encodes the expected stiffening with increased constraints. Use the following physically plausible constants for the model:\n  - $\\,Z_0 = 5.5\\,$, $\\,\\Delta Z_{\\max} = 2.0\\,$, $\\,P_c = 2.0\\,\\text{GPa}\\,$, $\\,Z_c = 6.0\\,$, $\\,\\gamma = 1.5\\,$.\n  - $\\,J_{\\min} = 5.0\\times 10^7\\,\\text{K}^2\\,$, $\\,J_{\\text{coeff}} = 3.0\\times 10^7\\,\\text{K}^2\\,$.\n  - $\\,T_0(P) = T_{00} + \\beta P\\,$ with $\\,T_{00} = 800\\,\\text{K}\\,$ and $\\,\\beta = 50\\,\\text{K}/\\text{GPa}\\,$.\n  - $\\,\\eta_0 = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}\\,$.\n  - Define the glass transition temperature $\\,T_g(P)\\,$ implicitly by $\\,\\eta\\!\\left(T_g(P),P\\right) = \\eta_g\\,$ with $\\,\\eta_g = 1.0\\times 10^{12}\\,\\text{Pa}\\cdot\\text{s}\\,$.\n\n- Starting only from the DF parabolic law and the above definitions, derive an algorithm to compute $\\,T_g(P)\\,$ and the Angell fragility index $\\,m(P)\\,$. The Angell fragility index $\\,m(P)\\,$ is defined as the derivative $\\,m(P) = \\left.\\frac{d \\log_{10}\\eta(T,P)}{d\\,(T_g(P)/T)}\\right|_{T=T_g(P)}\\,$. Your code must compute $\\,m(P)\\,$ for each specified pressure using this definition together with the DF law. All intermediate reasoning in your program should be faithful to these definitions, and all quantities must be handled with the stated units.\n\n- For numerical evaluation, adopt the conventional glass-transition criterion $\\,\\eta_g = 10^{12}\\,\\text{Pa}\\cdot\\text{s}\\,$ and the above $\\,\\eta_0\\,$. You may assume $\\,J(P) > 0\\,$ and $\\,T_0(P) > 0\\,$ for all $\\,P\\,$ in the test suite below, guaranteeing a unique, positive $\\,T_g(P)\\,$.\n\n- Test Suite. Evaluate your implementation for the following pressures (in gigapascal):\n  - $\\,P_1 = 0.0\\,\\text{GPa}\\,$,\n  - $\\,P_2 = 0.575364\\,\\text{GPa}\\,$,\n  - $\\,P_3 = 1.0\\,\\text{GPa}\\,$,\n  - $\\,P_4 = 2.0\\,\\text{GPa}\\,$,\n  - $\\,P_5 = 5.0\\,\\text{GPa}\\,$.\n  These values are chosen to cover a baseline case $\\,P_1\\,$, the boundary $\\,P_2\\,$ where $\\,\\langle Z(P_2)\\rangle = Z_c\\,$, intermediate cases $\\,P_3\\,$ and $\\,P_4\\,$, and a high-pressure case $\\,P_5\\,$ approaching saturation of $\\,\\langle Z(P)\\rangle\\,$.\n\n- Required outputs. For each $\\,P_i\\,$, compute and return:\n  - the fragility $\\,m(P_i)\\,$ (dimensionless),\n  - the mean coordination $\\,\\langle Z(P_i)\\rangle\\,$ (dimensionless).\n  In addition, compute the Pearson linear correlation coefficient between the lists $\\,\\{m(P_i)\\}\\,$ and $\\,\\{\\langle Z(P_i)\\rangle\\}\\,$ over the five pressures.\n\n- Final Output Format. Your program must produce a single line containing a Python-like list with three entries: the first is the list of $\\,m(P_i)\\,$, the second is the list of $\\,\\langle Z(P_i)\\rangle\\,$, and the third is the scalar correlation coefficient. All floating-point values must be rounded to $\\,6\\,$ decimal places. The exact format is:\n  - $\\,\\big[\\,[m(P_1),m(P_2),m(P_3),m(P_4),m(P_5)],\\,[\\langle Z(P_1)\\rangle,\\langle Z(P_2)\\rangle,\\langle Z(P_3)\\rangle,\\langle Z(P_4)\\rangle,\\langle Z(P_5)\\rangle],\\,r\\,\\big]\\,$,\n  where $\\,r\\,$ is the Pearson correlation coefficient between $\\,\\{m(P_i)\\}\\,$ and $\\,\\{\\langle Z(P_i)\\rangle\\}\\,$. No additional text may be printed. All angles, if any appear, must be in radians, but no angles are used here. All physical units have been specified; report only the dimensionless $\\,m(P)\\,$ and $\\,\\langle Z(P)\\rangle\\,$, and the dimensionless correlation coefficient in the final output, rounded to $\\,6\\,$ decimal places.", "solution": "The problem requires the development of a computational model to calculate the kinetic fragility of an amorphous material as a function of applied pressure. The model is based on the Dynamic Facilitation (DF) theory of glasses, which provides a specific mathematical form for the viscosity $\\eta$ as a function of temperature $T$ and pressure $P$. The core of the task is to derive expressions for the glass transition temperature $T_g(P)$ and the Angell fragility index $m(P)$ from the given physical laws and constants, and then to implement these derivations in a program to analyze the correlation between fragility and the mean atomic coordination number $\\langle Z(P) \\rangle$.\n\nThe solution proceeds in three main stages:\n1.  Derivation of an explicit formula for the glass transition temperature, $T_g(P)$.\n2.  Derivation of an explicit formula for the Angell fragility index, $m(P)$.\n3.  Specification of the complete computational algorithm, including the calculation of the Pearson correlation coefficient.\n\nFirst, we restate the governing equations and constants provided.\nThe viscosity $\\eta(T,P)$ follows the parabolic transport law:\n$$ \\ln \\eta(T,P) = \\ln \\eta_0 + J(P)\\,\\left(\\frac{1}{T} - \\frac{1}{T_0(P)}\\right)^2 $$\nThe pressure-dependent parameters are given by:\nMean coordination number: $\\langle Z(P)\\rangle = Z_0 + \\Delta Z_{\\max}\\,\\left(1 - e^{-P/P_c}\\right)$\nEnergy parameter: $J(P) = J_{\\min} + J_{\\text{coeff}}\\,\\max\\!\\left(\\langle Z(P)\\rangle - Z_c,\\,0\\right)^\\gamma$\nOnset temperature: $T_0(P) = T_{00} + \\beta P$\n\nThe constants are:\n$Z_0 = 5.5$, $\\Delta Z_{\\max} = 2.0$, $P_c = 2.0\\,\\text{GPa}$, $Z_c = 6.0$, $\\gamma = 1.5$.\n$J_{\\min} = 5.0\\times 10^7\\,\\text{K}^2$, $J_{\\text{coeff}} = 3.0\\times 10^7\\,\\text{K}^2$.\n$T_{00} = 800\\,\\text{K}$, $\\beta = 50\\,\\text{K}/\\text{GPa}$.\n$\\eta_0 = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$.\nThe glass transition is defined by the condition $\\eta(T_g, P) = \\eta_g = 1.0\\times 10^{12}\\,\\text{Pa}\\cdot\\text{s}$.\n\n**1. Derivation of the Glass Transition Temperature $T_g(P)$**\n\nThe glass transition temperature $T_g(P)$ is found by substituting the definition $\\eta(T_g(P), P) = \\eta_g$ into the transport law:\n$$ \\ln \\eta_g = \\ln \\eta_0 + J(P)\\,\\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 $$\nRearranging the terms to solve for the squared parenthesis gives:\n$$ \\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 = \\frac{\\ln(\\eta_g/\\eta_0)}{J(P)} $$\nTaking the square root of both sides yields two possible solutions:\n$$ \\frac{1}{T_g(P)} - \\frac{1}{T_0(P)} = \\pm \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nTo select the physically correct branch, we must consider the definition of the fragility index $m(P)$, which must be a positive quantity. As will be shown in the next section, the fragility is proportional to the term $\\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)$. Therefore, we must choose the positive root to ensure $m(P) > 0$. This implies that the physically relevant regime for this model is where $T_g(P) < T_0(P)$.\nSelecting the positive root:\n$$ \\frac{1}{T_g(P)} = \\frac{1}{T_0(P)} + \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nInverting this expression gives the explicit formula for the glass transition temperature:\n$$ T_g(P) = \\left( \\frac{1}{T_0(P)} + \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} \\right)^{-1} $$\nThe problem statement guarantees that $T_g(P)$ is positive and unique for the given pressures, which means the term on the right-hand side is well-defined and positive.\n\n**2. Derivation of the Angell Fragility Index $m(P)$**\n\nThe Angell fragility index is defined as the slope of the $\\log_{10}\\eta$ vs. $T_g/T$ curve evaluated at the glass transition, i.e., at $T=T_g(P)$:\n$$ m(P) = \\left.\\frac{d \\log_{10}\\eta(T,P)}{d\\,(T_g(P)/T)}\\right|_{T=T_g(P)} $$\nLet us define a dimensionless temperature variable $x = T_g(P)/T$. The derivative is with respect to $x$, evaluated at $x=1$. Note that $T_g(P)$ in the definition of $x$ is treated as a constant parameter during differentiation.\nFirst, we express $\\ln\\eta$ in terms of $x$. Since $1/T = x/T_g(P)$, we have:\n$$ \\ln \\eta(T(x), P) = \\ln \\eta_0 + J(P)\\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 $$\nTo compute the derivative of $\\log_{10}\\eta$, we use the change of base formula, $\\log_{10}\\eta = \\frac{\\ln\\eta}{\\ln 10}$.\n$$ m(P) = \\frac{1}{\\ln 10} \\left. \\frac{d}{dx} \\left[ \\ln \\eta_0 + J(P)\\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right)^2 \\right] \\right|_{x=1} $$\nApplying the chain rule:\n$$ \\frac{d}{dx}[\\dots] = J(P) \\cdot 2 \\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right) \\cdot \\frac{d}{dx}\\left(\\frac{x}{T_g(P)}\\right) = 2J(P)\\left(\\frac{x}{T_g(P)} - \\frac{1}{T_0(P)}\\right)\\frac{1}{T_g(P)} $$\nNow, we evaluate this derivative at $x=1$:\n$$ m(P) = \\frac{2J(P)}{\\ln 10 \\cdot T_g(P)} \\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right) $$\nFrom the previous derivation of $T_g(P)$, we substitute the expression for $\\left(\\frac{1}{T_g(P)} - \\frac{1}{T_0(P)}\\right)$:\n$$ \\frac{1}{T_g(P)} - \\frac{1}{T_0(P)} = \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nSubstituting this into the equation for $m(P)$:\n$$ m(P) = \\frac{2J(P)}{\\ln 10 \\cdot T_g(P)} \\sqrt{\\frac{\\ln(\\eta_g/\\eta_0)}{J(P)}} $$\nSimplifying by bringing $J(P)$ inside the square root:\n$$ m(P) = \\frac{2}{\\ln 10 \\cdot T_g(P)} \\sqrt{J(P) \\ln(\\eta_g/\\eta_0)} $$\nThis is the final, explicit formula for the fragility index $m(P)$. It is manifestly positive, consistent with physical expectations.\n\n**3. Computational Algorithm**\n\nThe complete algorithm to compute the required outputs for each pressure $P$ in the test suite is as follows:\n1.  Define all physical and model constants as provided. Pre-calculate the constant term $C_1 = \\ln(\\eta_g/\\eta_0) = \\ln(10^{15})$.\n2.  For each given pressure $P_i$:\n    a.  Calculate the mean coordination number: $\\langle Z(P_i)\\rangle = Z_0 + \\Delta Z_{\\max}\\,(1 - e^{-P_i/P_c})$.\n    b.  Calculate the onset temperature: $T_0(P_i) = T_{00} + \\beta P_i$.\n    c.  Calculate the pressure-dependent energy parameter: $J(P_i) = J_{\\min} + J_{\\text{coeff}}\\,\\max(\\langle Z(P_i) \\rangle - Z_c, 0)^\\gamma$.\n    d.  Calculate the glass transition temperature using the derived formula: $T_g(P_i) = \\left( \\frac{1}{T_0(P_i)} + \\sqrt{\\frac{C_1}{J(P_i)}} \\right)^{-1}$.\n    e.  Calculate the fragility index using its derived formula: $m(P_i) = \\frac{2}{\\ln 10} \\frac{\\sqrt{J(P_i) \\cdot C_1}}{T_g(P_i)}$.\n    f.  Store the computed values of $m(P_i)$ and $\\langle Z(P_i)\\rangle$.\n3.  After iterating through all pressures, assemble two lists: $M = [m(P_1), \\dots, m(P_5)]$ and $Z = [\\langle Z(P_1) \\rangle, \\dots, \\langle Z(P_5) \\rangle]$.\n4.  Compute the Pearson linear correlation coefficient, $r$, between the lists $M$ and $Z$. The formula is $r = \\frac{\\text{cov}(M, Z)}{\\sigma_M \\sigma_Z}$, which can be readily computed using standard numerical libraries.\n5.  Format the lists of results for $m(P_i)$ and $\\langle Z(P_i)$, and the scalar $r$, rounding each value to $6$ decimal places, and print them in the specified list-of-lists format.", "answer": "```python\nimport numpy as np\n\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Computes fragility and coordination number for an amorphous material model\n    under varying pressure, and calculates their correlation.\n    \"\"\"\n\n    # Define physical and model constants from the problem statement.\n    # Viscosity and thermodynamic constants\n    eta_0 = 1.0e-3  # Pa·s\n    eta_g = 1.0e12  # Pa·s\n    T00 = 800.0     # K\n    beta = 50.0     # K/GPa\n\n    # Coordination number model constants\n    Z0 = 5.5\n    Delta_Z_max = 2.0\n    Pc = 2.0        # GPa\n    Zc = 6.0\n\n    # Energy parameter J(P) model constants\n    J_min = 5.0e7   # K^2\n    J_coeff = 3.0e7 # K^2\n    gamma = 1.5\n\n    # Test suite of pressures\n    pressures = [\n        0.0,\n        0.575364,\n        1.0,\n        2.0,\n        5.0,\n    ]\n\n    # Pre-calculate constant factor in the equations\n    log_eta_ratio = np.log(eta_g / eta_0)\n    log_10 = np.log(10)\n\n    # Lists to store the results\n    m_values = []\n    z_values = []\n\n    for P in pressures:\n        # Step 1: Calculate the mean coordination number <Z(P)>\n        z_p = Z0 + Delta_Z_max * (1.0 - np.exp(-P / Pc))\n        z_values.append(z_p)\n\n        # Step 2: Calculate the onset temperature T0(P)\n        T0_p = T00 + beta * P\n\n        # Step 3: Calculate the energy parameter J(P)\n        z_diff = z_p - Zc\n        j_p = J_min + J_coeff * np.power(max(z_diff, 0), gamma)\n\n        # Step 4: Calculate the glass transition temperature Tg(P)\n        # We use the formula derived from the positive root for m > 0.\n        # 1/Tg(P) = 1/T0(P) + sqrt(ln(eta_g/eta_0) / J(P))\n        inv_Tg_p = (1.0 / T0_p) + np.sqrt(log_eta_ratio / j_p)\n        Tg_p = 1.0 / inv_Tg_p\n\n        # Step 5: Calculate the Angell fragility index m(P)\n        # m(P) = (2 / ln(10)) * sqrt(J(P) * ln(eta_g/eta_0)) / Tg(P)\n        m_p = (2.0 / log_10) * np.sqrt(j_p * log_eta_ratio) / Tg_p\n        m_values.append(m_p)\n\n    # Step 6: Calculate the Pearson correlation coefficient\n    # numpy.corrcoef returns a 2x2 matrix. The off-diagonal element is the correlation.\n    correlation_matrix = np.corrcoef(z_values, m_values)\n    r = correlation_matrix[0, 1]\n\n    # Step 7: Format the output as specified, rounding to 6 decimal places.\n    m_rounded = [f\"{val:.6f}\" for val in m_values]\n    z_rounded = [f\"{val:.6f}\" for val in z_values]\n    r_rounded = f\"{r:.6f}\"\n    \n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(m_rounded)}],[{','.join(z_rounded)}],{r_rounded}]\")\n\nsolve()\n```", "id": "3432555"}, {"introduction": "The relaxation dynamics of glass-forming liquids are famously complex, a fact hidden when one only considers bulk-averaged properties like viscosity. On a microscopic level, dynamics are highly heterogeneous, with some regions rearranging much faster than others. This practice introduces the advanced tools used to characterize these fluctuations, namely the four-point susceptibility ($\\chi_4$) and its associated dynamic correlation length ($\\xi_4$). By fitting a model to simulated structure factor data and performing a finite-size scaling analysis ([@problem_id:3432509]), you will learn how to extract the intrinsic length scale of these dynamical correlations, a key step toward a deeper understanding of the glass transition.", "problem": "Consider a supercooled liquid model in reduced Lennard-Jones units where length is measured in multiples of the particle diameter, denoted by $\\sigma$, and number density is denoted by $\\rho$. The goal is to assess finite-size effects on the peak of the four-point dynamical susceptibility, denoted by $\\chi_4^{\\text{max}}$, and on the associated dynamic correlation length, denoted by $\\xi_4$, as the number of particles $N$ varies, and to extrapolate $\\xi_4(N)$ to the asymptotic thermodynamic limit $N \\to \\infty$.\n\nThe fundamental base for this problem is as follows. The spatial field of dynamical overlap fluctuations at time $t$ may be characterized by a four-point correlation function in real space, denoted by $G_4(\\mathbf{r},t)$, which quantifies correlations between local dynamical activity at points separated by $\\mathbf{r}$. Its Fourier transform defines the four-point structure factor $S_4(\\mathbf{k},t)$ through\n$$\nS_4(\\mathbf{k},t) = \\int_{\\mathbb{R}^3} G_4(\\mathbf{r},t)\\, e^{-i \\mathbf{k}\\cdot \\mathbf{r}}\\, d^3 r.\n$$\nThe four-point dynamical susceptibility is defined by the spatial integral\n$$\n\\chi_4(t) = \\int_{\\mathbb{R}^3} G_4(\\mathbf{r},t)\\, d^3 r,\n$$\nwhich implies the identity\n$$\n\\chi_4(t) = S_4(\\mathbf{k}=\\mathbf{0},t).\n$$\nNear the time $t=t^\\star$ at which $\\chi_4(t)$ reaches its maximum, empirical evidence and the Ornstein–Zernike paradigm suggest that $G_4(\\mathbf{r},t^\\star)$ decays approximately exponentially with a characteristic correlation length $\\xi_4$, leading to a low-wavevector form\n$$\nS_4(k,t^\\star) \\approx \\frac{S_4(0,t^\\star)}{1 + (k \\, \\xi_4)^2},\n$$\nfor isotropic systems, where $k = \\|\\mathbf{k}\\|$ denotes the magnitude of the wavevector and $S_4(0,t^\\star) = \\chi_4^{\\text{max}}$ at the peak time.\n\nIn a cubic periodic simulation box of linear dimension $L$ containing $N$ particles at number density $\\rho$, the relation $L = (N/\\rho)^{1/3}$ holds, and allowed wavevectors are quantized with components $k_\\alpha = 2\\pi n_\\alpha / L$ where $n_\\alpha \\in \\mathbb{Z}$. The smallest nonzero wavevector magnitude is $k_{\\min} = 2\\pi/L$. As $N$ varies at fixed $\\rho$, the accessible small-$k$ range changes, potentially biasing fits used to estimate $\\xi_4$ and $\\chi_4^{\\text{max}}$.\n\nYour task is to write a complete, runnable program that, for each provided test case:\n- Treats the measured four-point structure factor data at $t^\\star$ as a set of pairs $\\{(k_i, S_4(k_i,t^\\star))\\}$ with associated uncertainties.\n- Fits the functional form $S_4(k,t^\\star) \\approx S_4(0,t^\\star) / \\left[1 + (k \\, \\xi_4)^2\\right]$ to estimate both $\\xi_4$ and $S_4(0,t^\\star)$, thereby yielding $\\xi_4$ and $\\chi_4^{\\text{max}}$ for that system size.\n- Uses the relation $L = (N/\\rho)^{1/3}$ to compute $L$ for each $N$, and then extrapolates the finite-size sequence $\\xi_4(N)$ to the thermodynamic limit by performing a linear regression of $\\xi_4$ versus $1/L$ and taking the intercept at $1/L \\to 0$ as the estimate of $\\xi_4(N\\to\\infty)$.\n\nAll lengths must be expressed in units of $\\sigma$ and must be output in $\\sigma$ units. The susceptibility $\\chi_4^{\\text{max}}$ is dimensionless. No angles are involved.\n\nUse the following test suite. The number density is $\\rho = 1.2\\,\\sigma^{-3}$. For each $N$, measured data are provided at the first four distinct wavevector shells determined by the integer triplets $(1,0,0)$, $(1,1,0)$, $(1,1,1)$, and $(2,0,0)$, which correspond to magnitudes $k = (2\\pi/L)\\,\\sqrt{n_x^2+n_y^2+n_z^2}$. For each $N$, the measured values of $S_4(k,t^\\star)$ and their one-standard-deviation uncertainties are:\n\n- $N = 500$. $S_4$ values: $[0.835,\\,0.427,\\,0.312,\\,0.234]$. Uncertainties: $[0.030,\\,0.030,\\,0.020,\\,0.020]$.\n- $N = 1000$. $S_4$ values: $[1.182,\\,0.688,\\,0.447,\\,0.370]$. Uncertainties: $[0.040,\\,0.030,\\,0.030,\\,0.020]$.\n- $N = 4000$. $S_4$ values: $[2.280,\\,1.469,\\,1.025,\\,0.842]$. Uncertainties: $[0.050,\\,0.040,\\,0.040,\\,0.030]$.\n- $N = 16000$. $S_4$ values: $[3.720,\\,2.610,\\,2.090,\\,1.670]$. Uncertainties: $[0.060,\\,0.050,\\,0.050,\\,0.040]$.\n\nFor each $N$, compute $L = (N/\\rho)^{1/3}$ in units of $\\sigma$, then compute the corresponding $k$ values for the four shells using the magnitudes described above.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order:\n- The four estimates of $\\xi_4$ (in $\\sigma$ units), corresponding to $N = 500,\\,1000,\\,4000,\\,16000$.\n- The extrapolated thermodynamic-limit estimate $\\xi_4(N\\to\\infty)$ (in $\\sigma$ units), obtained as the intercept of the linear fit of $\\xi_4$ versus $1/L$ at $1/L = 0$.\n- The four estimates of $\\chi_4^{\\text{max}}$ (dimensionless), corresponding to $N = 500,\\,1000,\\,4000,\\,16000$.\n\nThus the output format is $[\\xi_4(500),\\xi_4(1000),\\xi_4(4000),\\xi_4(16000),\\xi_4(\\infty),\\chi_4^{\\text{max}}(500),\\chi_4^{\\text{max}}(1000),\\chi_4^{\\text{max}}(4000),\\chi_4^{\\text{max}}(16000)]$. All numerical entries must be standard floating-point numbers. The line must contain no additional text.\n\nEnsure numerical stability and scientific realism by using a robust nonlinear least-squares fit with nonnegative parameter constraints for $S_4(0,t^\\star)$ and $\\xi_4$ and by using the provided uncertainties as weights in the fit. The extrapolation must be a standard linear least-squares regression in the variable $1/L$.\n\nThe program must be completely self-contained, require no user input, and use only the specified libraries.", "solution": "The problem requires a multi-step analysis of simulated data for a supercooled liquid to characterize finite-size effects on key dynamical properties. The core tasks are to extract the dynamic correlation length $\\xi_4$ and the peak four-point susceptibility $\\chi_4^{\\text{max}}$ for several system sizes, and then to extrapolate $\\xi_4$ to the thermodynamic limit ($N \\to \\infty$). The solution proceeds in three main stages: calculation of system-dependent parameters, non-linear fitting of the four-point structure factor for each system size, and finally, a linear extrapolation of the correlation length.\n\nFirst, we determine the physical parameters for each simulated system, characterized by the number of particles $N$. The system is contained in a cubic box of volume $V=L^3$ with periodic boundary conditions. The number density $\\rho$ is fixed at $\\rho = 1.2\\,\\sigma^{-3}$, where $\\sigma$ is the particle diameter. The box length $L$ is thus related to $N$ and $\\rho$ by\n$$\nL = \\left(\\frac{N}{\\rho}\\right)^{1/3}.\n$$\nDue to the periodic boundary conditions, the allowed wavevectors $\\mathbf{k}$ are quantized. Their components must be integer multiples of $2\\pi/L$, i.e., $k_\\alpha = 2\\pi n_\\alpha / L$ for $\\alpha \\in \\{x,y,z\\}$, where $n_\\alpha \\in \\mathbb{Z}$. The problem provides data for the first four distinct non-zero wavevector shells, corresponding to integer triplets $(n_x, n_y, n_z)$ with norms $\\sqrt{n_x^2+n_y^2+n_z^2}$ of $1$ (e.g., $(1,0,0)$), $\\sqrt{2}$ (e.g., $(1,1,0)$), $\\sqrt{3}$ (e.g., $(1,1,1)$), and $2$ (e.g., $(2,0,0)$). The corresponding wavevector magnitudes are given by\n$$\nk = \\frac{2\\pi}{L} \\sqrt{n_x^2 + n_y^2 + n_z^2}.\n$$\nFor each $N$, we compute $L$ and then the set of four $k_i$ values corresponding to $\\sqrt{n_x^2+n_y^2+n_z^2} \\in \\{1, \\sqrt{2}, \\sqrt{3}, 2\\}$.\n\nSecond, for each system size $N$, we analyze the provided four-point structure factor data, $\\{ (k_i, S_4(k_i,t^\\star)) \\}$, at the time $t^\\star$ of the susceptibility peak. The data are fitted to the Ornstein-Zernike (OZ) functional form, which is appropriate for describing correlations near a critical point or, in this context, growing dynamical heterogeneity:\n$$\nS_4(k) = \\frac{S_4(0)}{1 + (k \\xi_4)^2}.\n$$\nIn this model, $S_4(0)$ is the structure factor at zero wavevector, which by definition is the peak four-point susceptibility, $\\chi_4^{\\text{max}}$. The parameter $\\xi_4$ is the dynamic correlation length. The fitting process aims to determine the optimal values of $\\chi_4^{\\text{max}}$ and $\\xi_4$. This is a non-linear least-squares problem. To account for the varying precision of the data points, a weighted least-squares approach is employed, where the objective is to minimize the chi-squared function:\n$$\n\\chi^2 = \\sum_i \\left( \\frac{S_{4,i}^{\\text{data}} - S_4(k_i; \\chi_4^{\\text{max}}, \\xi_4)}{u_i} \\right)^2,\n$$\nwhere $S_{4,i}^{\\text{data}}$ are the measured values and $u_i$ are their corresponding uncertainties. This procedure is implemented using the `scipy.optimize.curve_fit` function. Physical constraints require that both $\\chi_4^{\\text{max}}$ and $\\xi_4$ be non-negative, which is enforced by setting bounds on the optimization parameters.\n\nThird, after obtaining the correlation length $\\xi_4(N)$ for each system size $N$, we perform an extrapolation to the thermodynamic limit ($N \\to \\infty$, or equivalently, $L \\to \\infty$). Finite-size effects in systems with periodic boundary conditions often exhibit a scaling behavior with the inverse of the linear system size, $1/L$. It is a standard assumption that for large $L$, the measured correlation length $\\xi_4(L)$ approaches its thermodynamic limit value $\\xi_4(\\infty)$ according to\n$$\n\\xi_4(L) \\approx \\xi_4(\\infty) + \\frac{C}{L},\n$$\nwhere $C$ is a constant. We can therefore estimate $\\xi_4(\\infty)$ by performing a linear regression on the computed pairs $(\\xi_4(N), 1/L)$. The intercept of the resulting line at $1/L = 0$ provides the extrapolated value for the correlation length in the thermodynamic limit, $\\xi_4(\\infty)$. This linear regression is implemented using `numpy.polyfit`.\n\nThe final program implements these three stages. It iterates through the dataset for each $N$, computes the $k$-vectors, performs the weighted non-linear fit to find $\\xi_4(N)$ and $\\chi_4^{\\text{max}}(N)$, and stores these results. After processing all system sizes, it performs the linear extrapolation for $\\xi_4(\\infty)$ and assembles all computed quantities into a single list for output, formatted as specified.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing finite-size effects on dynamical susceptibility\n    and correlation length in a supercooled liquid model.\n    \"\"\"\n\n    # Fixed parameter from the problem statement\n    rho = 1.2  # number density in units of sigma^-3\n\n    # Test suite data as provided in the problem statement\n    # Format: (N, S4_values, uncertainties)\n    test_cases = [\n        (500, np.array([0.835, 0.427, 0.312, 0.234]), np.array([0.030, 0.030, 0.020, 0.020])),\n        (1000, np.array([1.182, 0.688, 0.447, 0.370]), np.array([0.040, 0.030, 0.030, 0.020])),\n        (4000, np.array([2.280, 1.469, 1.025, 0.842]), np.array([0.050, 0.040, 0.040, 0.030])),\n        (16000, np.array([3.720, 2.610, 2.090, 1.670]), np.array([0.060, 0.050, 0.050, 0.040])),\n    ]\n\n    # Shell norms for the integer triplets (1,0,0), (1,1,0), (1,1,1), (2,0,0)\n    k_shell_norms = np.array([1.0, np.sqrt(2.0), np.sqrt(3.0), 2.0])\n\n    def oz_model(k, chi4_max, xi4):\n        \"\"\"\n        Ornstein-Zernike functional form for the four-point structure factor S4(k).\n        k: wavevector magnitude\n        chi4_max: S4(0), the peak of the four-point susceptibility\n        xi4: dynamic correlation length\n        \"\"\"\n        return chi4_max / (1.0 + (k * xi4)**2)\n\n    xi4_results = []\n    chi4_max_results = []\n    inv_L_values = []\n\n    for N, s4_data, s4_errors in test_cases:\n        # Step 1: Calculate system-specific parameters\n        # Box length L in units of sigma\n        L = (N / rho)**(1.0 / 3.0)\n        inv_L_values.append(1.0 / L)\n\n        # Wavevector magnitudes k for the given shells\n        k_values = (2.0 * np.pi / L) * k_shell_norms\n\n        # Step 2: Perform the non-linear least-squares fit\n        # Bounds to ensure physical parameters (non-negative)\n        bounds = ([0, 0], [np.inf, np.inf])\n        \n        # We use curve_fit to perform a weighted non-linear least-squares fit.\n        # The 'sigma' argument provides the uncertainties, causing curve_fit to\n        # minimize the sum of squared residuals weighted by 1/sigma^2.\n        popt, _ = curve_fit(\n            oz_model,\n            k_values,\n            s4_data,\n            sigma=s4_errors,\n            bounds=bounds,\n            absolute_sigma=True\n        )\n\n        chi4_max, xi4 = popt\n        chi4_max_results.append(chi4_max)\n        xi4_results.append(xi4)\n\n    # Step 3: Extrapolate xi4 to the thermodynamic limit (N -> infinity, L -> infinity, 1/L -> 0)\n    # Perform a linear regression of xi4 vs 1/L: xi4 = m*(1/L) + c\n    # The intercept 'c' is the extrapolated value xi4(infinity).\n    # np.polyfit returns coefficients [m, c] for a 1st degree polynomial.\n    slope, intercept = np.polyfit(inv_L_values, xi4_results, 1)\n    xi4_inf = intercept\n\n    # Assemble the final results in the specified order\n    final_results = xi4_results + [xi4_inf] + chi4_max_results\n    \n    # Print the final output in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```", "id": "3432509"}]}