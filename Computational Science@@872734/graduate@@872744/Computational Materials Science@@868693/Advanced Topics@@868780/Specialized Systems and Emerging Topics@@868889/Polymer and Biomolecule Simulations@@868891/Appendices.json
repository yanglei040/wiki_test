{"hands_on_practices": [{"introduction": "Understanding the mechanical properties of biopolymers like DNA is crucial for deciphering their biological functions. This practice explores the connection between the local, sequence-dependent elasticity of a DNA molecule and its macroscopic persistence length, a key measure of chain stiffness [@problem_id:3478841]. By deriving and applying formulas based on the elastic rod model and the equipartition theorem, you will gain hands-on experience in how local couplings, such as twist-bend effects, modulate the overall mechanical behavior of the polymer.", "problem": "You are tasked with studying sequence-dependent Deoxyribonucleic Acid (DNA) mechanics using a discrete elastic rod representation and comparing it to a continuous elastic rod model. The objective is to compute the persistence length and twist-bend coupling metrics for several sequences, each composed of a small number of coarse-grained steps with defined local elastic parameters. The problem should be solved by deriving all necessary formulas from fundamental principles and implementing the resulting algorithm in a complete, runnable program.\n\nConsider a sequence represented as a list of steps. At each step, small deformations are described by a three-component vector $x = (\\kappa_1, \\kappa_2, \\omega)$, where $\\,\\kappa_1\\,$ and $\\,\\kappa_2\\,$ are the principal curvatures (in $\\mathrm{nm}^{-1}$) and $\\,\\omega\\,$ is the twist rate (in $\\mathrm{nm}^{-1}$). The harmonic elastic energy density per step is modeled as a quadratic form\n$$\nE = \\frac{1}{2} \\, x^\\top K \\, x \\, ,\n$$\nwhere the local stiffness matrix $\\,K\\,$ has entries in $\\mathrm{pN}\\cdot\\mathrm{nm}^2$ and is defined by\n$$\nK = \\begin{pmatrix}\nA_1 & 0 & G \\\\\n0 & A_2 & 0 \\\\\nG & 0 & C\n\\end{pmatrix} ,\n$$\nwith $\\,A_1\\,$ and $\\,A_2\\,$ being the bending rigidities about the principal axes, $\\,C\\,$ the twist rigidity, and $\\,G\\,$ the twist-bend coupling constant. All steps have equal contour length, so simple arithmetic averages across steps represent length-weighted averages.\n\nFundamental base to use:\n- The equipartition theorem for harmonic systems and the Gaussian distribution of fluctuations implies that the equilibrium covariance matrix $\\,\\Sigma\\,$ of the deformation variables at a given step satisfies\n$$\n\\Sigma = k_\\mathrm{B} T \\, K^{-1} \\, ,\n$$\nwhere $\\,k_\\mathrm{B}\\,$ is the Boltzmann constant and $\\,T\\,$ the absolute temperature.\n- The Worm-Like Chain (WLC) model defines the persistence length $\\,L_p\\,$ as the bending rigidity divided by thermal energy, i.e., for an isotropic rod $\\,L_p = A / (k_\\mathrm{B} T)\\,$. For an anisotropic rod the effective isotropic bending rigidity can be taken as the average of the bending rigidities along the two principal axes, appropriately accounting for any coupling when present.\n- For Gaussian variables, rigorous marginalization over a subset of variables can be performed using linear algebra, and the effective stiffness of a retained variable in the presence of couplings is obtained by an appropriate operation on submatrices. You must use this fact to eliminate twist $\\,\\omega\\,$ when computing the effective bending stiffness of $\\,\\kappa_1\\,$ in the presence of a nonzero $\\,G$.\n\nYour tasks:\n1. From first principles, derive an algorithm that, given $\\,K\\,$ for each step, computes the equilibrium covariance matrix $\\,\\Sigma\\,$ and extracts the twist-bend covariance $\\,\\langle \\kappa_1 \\omega \\rangle\\,$ at that step. Aggregate the average twist-bend covariance across the sequence by arithmetic mean. Report this average as a scalar in $\\mathrm{nm}^{-2}$.\n2. Starting from the Gaussian energy and without using any shortcut formulas, eliminate $\\,\\omega\\,$ to obtain the effective bending stiffness for $\\,\\kappa_1\\,$ at each step. Combine this with the uncoupled $\\,\\kappa_2\\,$ stiffness to form an effective isotropic bending rigidity for the sequence via arithmetic averaging, and from it compute the sequence-level persistence length $\\,L_p^\\text{coupled} = A_\\text{eff}/(k_\\mathrm{B} T)\\,$, expressed in $\\mathrm{nm}$.\n3. Compute the elastic-rod baseline persistence length $\\,L_p^\\text{rod}\\,$ by ignoring all couplings (i.e., treating $\\,G=0\\,$ for all steps), using the mean of $\\,A_1\\,$ and $\\,A_2\\,$ across the sequence as the effective isotropic bending rigidity, and then dividing by $\\,k_\\mathrm{B}T\\,$ to obtain $\\,L_p^\\text{rod}\\,$ in $\\mathrm{nm}$.\n4. Implement a program that performs these computations for each of the provided test sequences and outputs the results in the required format.\n\nPhysical constants and units:\n- Use the Boltzmann constant $\\,k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}\\,$ and the conversion $\\,1\\,\\mathrm{J} = 10^{21}\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\,$, so that $\\,k_\\mathrm{B}\\,$ in $\\,\\mathrm{pN}\\cdot\\mathrm{nm/K}\\,$ is $\\,k_\\mathrm{B} = 1.380649\\times 10^{-2}\\,\\mathrm{pN}\\cdot\\mathrm{nm/K}\\,$. Use temperature $\\,T = 298\\,\\mathrm{K}\\,$ to compute $\\,k_\\mathrm{B}T\\,$ in $\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\,$.\n- All stiffness entries $\\,A_1\\,,\\,A_2\\,,\\,C\\,,\\,G\\,$ are provided in $\\,\\mathrm{pN}\\cdot\\mathrm{nm}^2\\,$. The covariance outputs $\\,\\langle \\kappa_1 \\omega \\rangle\\,$ must be expressed in $\\,\\mathrm{nm}^{-2}\\,$. Persistence lengths must be expressed in $\\,\\mathrm{nm}\\,$.\n\nTest suite:\nEach test case is a sequence represented as a list of steps, and each step is a tuple $\\, (A_1, A_2, C, G) \\,$ in $\\,\\mathrm{pN}\\cdot\\mathrm{nm}^2$. The five test cases are:\n\n- Case 1 (general, moderate coupling):\n    1. $\\, (180,\\,220,\\,100,\\,30)\\, $\n    2. $\\, (190,\\,210,\\,95,\\,28)\\, $\n    3. $\\, (185,\\,215,\\,105,\\,32)\\, $\n    4. $\\, (175,\\,225,\\,98,\\,29)\\, $\n- Case 2 (no coupling baseline):\n    1. $\\, (200,\\,200,\\,110,\\,0)\\, $\n    2. $\\, (210,\\,190,\\,105,\\,0)\\, $\n    3. $\\, (190,\\,210,\\,115,\\,0)\\, $\n- Case 3 (near twist-bend coupling stability boundary, but positive definite):\n    1. $\\, (120,\\,240,\\,130,\\,118)\\, $\n    2. $\\, (125,\\,235,\\,128,\\,120)\\, $\n    3. $\\, (115,\\,245,\\,132,\\,116)\\, $\n- Case 4 (strong anisotropy, moderate coupling):\n    1. $\\, (150,\\,300,\\,100,\\,40)\\, $\n    2. $\\, (140,\\,310,\\,95,\\,35)\\, $\n    3. $\\, (160,\\,290,\\,105,\\,38)\\, $\n    4. $\\, (130,\\,320,\\,98,\\,42)\\, $\n- Case 5 (single-step sanity check):\n    1. $\\, (220,\\,180,\\,110,\\,25)\\, $\n\nFinal output format:\n- Your program should produce a single line of output containing a comma-separated list enclosed in square brackets.\n- Each test case’s result must be a list of three values $\\,\\big[ L_p^\\text{coupled},\\, L_p^\\text{rod},\\, \\overline{\\langle \\kappa_1 \\omega \\rangle} \\big]\\,$, where $\\,L_p^\\text{coupled}\\,$ and $\\,L_p^\\text{rod}\\,$ are in $\\,\\mathrm{nm}\\,$ rounded to three decimals, and $\\,\\overline{\\langle \\kappa_1 \\omega \\rangle}\\,$ is the arithmetic mean twist-bend covariance across steps in $\\,\\mathrm{nm}^{-2}\\,$ rounded to six decimals.\n- The single line should look like $\\,[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]\\,$ with numerical values inserted accordingly.", "solution": "The problem is valid as it is scientifically grounded in the principles of statistical mechanics and polymer physics, well-posed with all necessary information provided, and objective in its formulation. The provided stiffness matrices are positive definite, ensuring a physically stable system. We now proceed to derive the necessary formulas from first principles.\n\nThe thermal energy scale is given by the product of the Boltzmann constant, $k_\\mathrm{B}$, and the absolute temperature, $T$. With the given values, $k_\\mathrm{B} = 1.380649\\times 10^{-2}\\,\\mathrm{pN}\\cdot\\mathrm{nm/K}$ and $T = 298\\,\\mathrm{K}$, the thermal energy is:\n$$k_\\mathrm{B}T = (1.380649 \\times 10^{-2}\\,\\mathrm{pN}\\cdot\\mathrm{nm/K}) \\times 298\\,\\mathrm{K} \\approx 4.114334\\,\\mathrm{pN}\\cdot\\mathrm{nm}$$\nThis value will be used as a constant in subsequent calculations.\n\n**1. Derivation of the Twist-Bend Covariance $\\overline{\\langle \\kappa_1 \\omega \\rangle}$**\n\nThe problem states that the equilibrium covariance matrix $\\Sigma$ of the deformation variables $x = (\\kappa_1, \\kappa_2, \\omega)^\\top$ is related to the stiffness matrix $K$ by the equipartition theorem for a system with harmonic energy $E = \\frac{1}{2} x^\\top K x$. The relation is:\n$$\n\\Sigma = k_\\mathrm{B} T \\, K^{-1}\n$$\nThe covariance matrix $\\Sigma$ contains the second moments of the fluctuations:\n$$\n\\Sigma = \n\\begin{pmatrix}\n\\langle \\kappa_1^2 \\rangle & \\langle \\kappa_1 \\kappa_2 \\rangle & \\langle \\kappa_1 \\omega \\rangle \\\\\n\\langle \\kappa_2 \\kappa_1 \\rangle & \\langle \\kappa_2^2 \\rangle & \\langle \\kappa_2 \\omega \\rangle \\\\\n\\langle \\omega \\kappa_1 \\rangle & \\langle \\omega \\kappa_2 \\rangle & \\langle \\omega^2 \\rangle\n\\end{pmatrix}\n$$\nThe value we seek, the twist-bend covariance $\\langle \\kappa_1 \\omega \\rangle$, is the $(1,3)$ element (or $(3,1)$ element) of $\\Sigma$. To find it, we must first compute the inverse of the stiffness matrix $K$.\nThe stiffness matrix for a single step is given as:\n$$\nK = \\begin{pmatrix}\nA_1 & 0 & G \\\\\n0 & A_2 & 0 \\\\\nG & 0 & C\n\\end{pmatrix}\n$$\nThe inverse $K^{-1}$ is calculated as the adjugate of $K$ divided by its determinant. The determinant of $K$ is:\n$$\n\\det(K) = A_1(A_2 C - 0) - 0(0 - 0) + G(0 - A_2 G) = A_2(A_1 C - G^2)\n$$\nThe adjugate matrix, which is the transpose of the cofactor matrix, is found to be:\n$$\n\\text{adj}(K) = \\begin{pmatrix}\nA_2 C & 0 & -A_2 G \\\\\n0 & A_1 C - G^2 & 0 \\\\\n-A_2 G & 0 & A_1 A_2\n\\end{pmatrix}\n$$\nTherefore, the inverse matrix $K^{-1}$ is:\n$$\nK^{-1} = \\frac{1}{\\det(K)} \\text{adj}(K) = \\frac{1}{A_2(A_1 C - G^2)} \\begin{pmatrix}\nA_2 C & 0 & -A_2 G \\\\\n0 & A_1 C - G^2 & 0 \\\\\n-A_2 G & 0 & A_1 A_2\n\\end{pmatrix}\n$$\n$$\nK^{-1} = \\begin{pmatrix}\n\\frac{C}{A_1 C - G^2} & 0 & \\frac{-G}{A_1 C - G^2} \\\\\n0 & \\frac{1}{A_2} & 0 \\\\\n\\frac{-G}{A_1 C - G^2} & 0 & \\frac{A_1}{A_1 C - G^2}\n\\end{pmatrix}\n$$\nFrom this, the $(1,3)$ element of the covariance matrix $\\Sigma$ for a single step is:\n$$\n\\langle \\kappa_1 \\omega \\rangle = \\Sigma_{13} = k_\\mathrm{B} T \\, (K^{-1})_{13} = -k_\\mathrm{B} T \\frac{G}{A_1 C - G^2}\n$$\nThe problem requires the arithmetic mean of this quantity over all $N$ steps in a sequence:\n$$\n\\overline{\\langle \\kappa_1 \\omega \\rangle} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( -k_\\mathrm{B} T \\frac{G_i}{A_{1,i} C_i - G_i^2} \\right)\n$$\n\n**2. Derivation of the Coupled Persistence Length $L_p^\\text{coupled}$**\n\nTo find the effective bending rigidity, we must marginalize the twist degree of freedom, $\\omega$. The elastic energy is:\n$$\nE = \\frac{1}{2} (A_1 \\kappa_1^2 + A_2 \\kappa_2^2 + C \\omega^2 + 2G \\kappa_1 \\omega)\n$$\nFor fixed curvatures $\\kappa_1$ and $\\kappa_2$, the energy is minimized with respect to $\\omega$ when $\\partial E / \\partial \\omega = 0$:\n$$\n\\frac{\\partial E}{\\partial \\omega} = C \\omega + G \\kappa_1 = 0 \\implies \\omega_\\text{min} = -\\frac{G}{C} \\kappa_1\n$$\nSubstituting this value of $\\omega$ back into the energy expression gives the effective energy for the remaining degrees of freedom:\n$$\nE_\\text{eff}(\\kappa_1, \\kappa_2) = \\frac{1}{2} \\left[ A_1 \\kappa_1^2 + A_2 \\kappa_2^2 + C\\left(-\\frac{G}{C} \\kappa_1\\right)^2 + 2G \\kappa_1 \\left(-\\frac{G}{C} \\kappa_1\\right) \\right]\n$$\n$$\nE_\\text{eff}(\\kappa_1, \\kappa_2) = \\frac{1}{2} \\left[ A_1 \\kappa_1^2 + A_2 \\kappa_2^2 + \\frac{G^2}{C} \\kappa_1^2 - \\frac{2G^2}{C} \\kappa_1^2 \\right]\n$$\n$$\nE_\\text{eff}(\\kappa_1, \\kappa_2) = \\frac{1}{2} \\left[ \\left(A_1 - \\frac{G^2}{C}\\right) \\kappa_1^2 + A_2 \\kappa_2^2 \\right]\n$$\nThis reveals the effective bending rigidities for the two principal axes at a single step:\n$$\nA_{1,\\text{eff}} = A_1 - \\frac{G^2}{C} \\quad \\text{and} \\quad A_{2,\\text{eff}} = A_2\n$$\nThe twist-bend coupling reduces the effective stiffness for bending in the first principal direction. The problem specifies that the effective isotropic bending rigidity for the step is the average of the two principal rigidities:\n$$\nA_{\\text{iso},i}^\\text{coupled} = \\frac{A_{1,\\text{eff},i} + A_{2,\\text{eff},i}}{2} = \\frac{1}{2} \\left( A_{1,i} - \\frac{G_i^2}{C_i} + A_{2,i} \\right)\n$$\nThe sequence-level effective rigidity, $A_\\text{eff}$, is the arithmetic mean across all $N$ steps:\n$$\nA_\\text{eff} = \\frac{1}{N} \\sum_{i=1}^{N} A_{\\text{iso},i}^\\text{coupled} = \\frac{1}{2N} \\sum_{i=1}^{N} \\left( A_{1,i} + A_{2,i} - \\frac{G_i^2}{C_i} \\right)\n$$\nThe coupled persistence length is then defined as this effective rigidity divided by the thermal energy:\n$$\nL_p^\\text{coupled} = \\frac{A_\\text{eff}}{k_\\mathrm{B} T}\n$$\n\n**3. Derivation of the Uncoupled Baseline Persistence Length $L_p^\\text{rod}$**\n\nThis calculation is a simplified version of the above, where all couplings are ignored by setting $G=0$ for all steps.\nIn this case, the bending rigidities are simply $A_{1,i}$ and $A_{2,i}$. The effective isotropic rigidity for a step is their average:\n$$\nA_{\\text{iso},i}^\\text{rod} = \\frac{A_{1,i} + A_{2,i}}{2}\n$$\nThe sequence-level rigidity, $A_\\text{rod}$, is the average over all $N$ steps:\n$$\nA_\\text{rod} = \\frac{1}{N} \\sum_{i=1}^{N} A_{\\text{iso},i}^\\text{rod} = \\frac{1}{2N} \\sum_{i=1}^{N} \\left( A_{1,i} + A_{2,i} \\right)\n$$\nThe uncoupled baseline persistence length is:\n$$\nL_p^\\text{rod} = \\frac{A_\\text{rod}}{k_\\mathrm{B} T}\n$$\n\nThese derived formulas provide a complete algorithm for solving the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sequence-dependent DNA mechanical properties based on a discrete elastic rod model.\n    \"\"\"\n    # Define physical constants\n    # Boltzmann constant in pN*nm/K\n    k_B = 1.380649e-2 \n    # Absolute temperature in K\n    T = 298.0\n    # Thermal energy in pN*nm\n    k_B_T = k_B * T\n\n    # Define the test cases from the problem statement.\n    # Each case is a list of steps, where each step is a tuple (A1, A2, C, G)\n    # in pN*nm^2.\n    test_cases = [\n        # Case 1 (general, moderate coupling)\n        [\n            (180., 220., 100., 30.),\n            (190., 210., 95., 28.),\n            (185., 215., 105., 32.),\n            (175., 225., 98., 29.),\n        ],\n        # Case 2 (no coupling baseline)\n        [\n            (200., 200., 110., 0.),\n            (210., 190., 105., 0.),\n            (190., 210., 115., 0.),\n        ],\n        # Case 3 (near twist-bend coupling stability boundary)\n        [\n            (120., 240., 130., 118.),\n            (125., 235., 128., 120.),\n            (115., 245., 132., 116.),\n        ],\n        # Case 4 (strong anisotropy, moderate coupling)\n        [\n            (150., 300., 100., 40.),\n            (140., 310., 95., 35.),\n            (160., 290., 105., 38.),\n            (130., 320., 98., 42.),\n        ],\n        # Case 5 (single-step sanity check)\n        [\n            (220., 180., 110., 25.),\n        ]\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Convert the list of tuples to a numpy array for vectorized operations\n        steps = np.array(case, dtype=np.float64)\n        \n        A1 = steps[:, 0]\n        A2 = steps[:, 1]\n        C = steps[:, 2]\n        G = steps[:, 3]\n\n        # Task 1: Compute average twist-bend covariance\n        # Formula: <k1 w>_i = -k_B*T * G_i / (A1_i * C_i - G_i^2)\n        # The denominator must be non-zero as K must be invertible.\n        # Problem validation ensures A1*C - G^2 > 0.\n        denominator_cov = A1 * C - G**2\n        \n        # Handle cases where G is zero to avoid division by zero and ensure correct result\n        if np.all(G == 0):\n             avg_cov = 0.0\n        else:\n             cov_per_step = -k_B_T * G / denominator_cov\n             avg_cov = np.mean(cov_per_step)\n\n        # Task 2: Compute coupled persistence length (Lp_coupled)\n        # Formula: A_eff_i = (A1_i + A2_i - G_i^2/C_i) / 2\n        # A_eff_avg = mean(A_eff_i)\n        # Lp_coupled = A_eff_avg / k_B_T\n        A_eff_per_step = (A1 + A2 - (G**2) / C) / 2.0\n        A_eff_avg = np.mean(A_eff_per_step)\n        Lp_coupled = A_eff_avg / k_B_T\n\n        # Task 3: Compute uncoupled baseline persistence length (Lp_rod)\n        # Formula: A_rod_i = (A1_i + A2_i) / 2\n        # A_rod_avg = mean(A_rod_i)\n        # Lp_rod = A_rod_avg / k_B_T\n        A_rod_per_step = (A1 + A2) / 2.0\n        A_rod_avg = np.mean(A_rod_per_step)\n        Lp_rod = A_rod_avg / k_B_T\n\n        # Format the results for this case as a string\n        # Lp values to 3 decimal places, covariance to 6 decimal places\n        result_str = f\"[{Lp_coupled:.3f},{Lp_rod:.3f},{avg_cov:.6f}]\"\n        all_results.append(result_str)\n\n    # Final print statement in the exact required format\n    # Example format: [[a1,b1,c1],[a2,b2,c2],...]\n    print(f\"[{','.join(all_results)}]\")\n\n# Execute the main function\nsolve()\n```", "id": "3478841"}, {"introduction": "The swelling behavior of hydrogels is a classic problem in polymer physics, governed by a balance of mixing thermodynamics and network elasticity. This exercise connects the microscopic world of molecular conformations to the macroscopic property of equilibrium swelling by employing the celebrated Flory-Rehner theory [@problem_id:3478929]. You will calculate the conformational entropy of polymer side chains and use it to parameterize the polymer-solvent interaction, thereby predicting the network's crosslink density from experimental swelling data.", "problem": "Consider a crosslinked hydrogel composed of polymer strands bearing flexible side chains. The hydrogel swells in a solvent and reaches an equilibrium polymer volume fraction denoted by $\\phi$ at a given absolute temperature $T$. The goal is to compute the conformational entropy of the flexible side chains from a discrete torsional-state model and then relate this entropy to swelling via parameter estimation in the Flory-Rehner theory.\n\nUse the following fundamental base.\n\n- Discrete torsional-state model for side-chain conformations: Each rotatable bond in a side chain can occupy either a trans state with energy $E_{\\mathrm{trans}}$ and degeneracy $g_{\\mathrm{trans}}$, or a gauche state with energy $E_{\\mathrm{gauche}}$ and degeneracy $g_{\\mathrm{gauche}}$. The single-torsion partition function at temperature $T$ is $Z = g_{\\mathrm{trans}} e^{-E_{\\mathrm{trans}}/(k_{\\mathrm{B}} T)} + g_{\\mathrm{gauche}} e^{-E_{\\mathrm{gauche}}/(k_{\\mathrm{B}} T)}$, where $k_{\\mathrm{B}}$ is the Boltzmann constant. The single-torsion state probabilities are $p_{\\mathrm{trans}} = \\dfrac{g_{\\mathrm{trans}} e^{-E_{\\mathrm{trans}}/(k_{\\mathrm{B}} T)}}{Z}$ and $p_{\\mathrm{gauche}} = \\dfrac{g_{\\mathrm{gauche}} e^{-E_{\\mathrm{gauche}}/(k_{\\mathrm{B}} T)}}{Z}$. The single-torsion conformational entropy is $S_{\\mathrm{tor}}(T) = - k_{\\mathrm{B}} \\left[ p_{\\mathrm{trans}} \\ln p_{\\mathrm{trans}} + p_{\\mathrm{gauche}} \\ln p_{\\mathrm{gauche}} \\right]$. For a side chain with $M$ independent rotatable bonds of the same type, the side-chain conformational entropy is $S_{\\mathrm{sc}}(T) = M \\, S_{\\mathrm{tor}}(T)$.\n\n- Flory-Huggins interaction parameter: Assume the temperature dependence of the Flory-Huggins parameter $\\chi(T)$ admits the decomposition $\\chi(T) = \\chi_{0} + \\dfrac{A}{T} + \\chi_{\\mathrm{S}}(T)$, where $\\chi_{0}$ and $A$ are constants and $\\chi_{\\mathrm{S}}(T)$ is an entropic contribution that depends on the side-chain conformational entropy. Model this entropic contribution as $\\chi_{\\mathrm{S}}(T) = - \\gamma \\, \\dfrac{S_{\\mathrm{sc}}(T)}{k_{\\mathrm{B}} \\, M}$, where $\\gamma$ is a dimensionless weighting factor representing the fraction of polymer–solvent contacts dominated by side-chain torsional degrees of freedom.\n\n- Flory-Rehner equilibrium swelling condition: The dimensionless equilibrium condition for an incompressible hydrogel network is\n$$\n\\ln(1 - \\phi) + \\phi + \\chi(T) \\, \\phi^{2} + \\lambda \\left( \\phi^{1/3} - \\frac{\\phi}{2} \\right) = 0,\n$$\nwhere $\\lambda$ is a dimensionless elastic-network parameter proportional to the elastically effective chain density. Define $\\lambda = \\nu \\, v_{1}$, where $\\nu$ is the elastically effective chain density in units of $\\mathrm{mol}/\\mathrm{m}^{3}$ and $v_{1}$ is the solvent molar volume in units of $\\mathrm{m}^{3}/\\mathrm{mol}$.\n\nYou will be provided test cases that each include multiple measurements of the equilibrium polymer volume fraction $\\phi$ at different temperatures $T$ for a single network. For each test case, compute the side-chain conformational entropy $S_{\\mathrm{sc}}(T)$, evaluate $\\chi(T)$, and estimate a single temperature-independent parameter $\\nu$ for the network by aggregating the information across the provided temperatures. To estimate $\\nu$, for each $(\\phi, T)$ pair compute an individual $\\lambda(T)$ that satisfies the equilibrium equation and then aggregate the $\\lambda(T)$ values by simple averaging to obtain $\\overline{\\lambda}$, and finally $\\nu = \\dfrac{\\overline{\\lambda}}{v_{1}}$. Express the final $\\nu$ values in $\\mathrm{mol}/\\mathrm{m}^{3}$.\n\nConstants and units to use:\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}/\\mathrm{K}$.\n- Avogadro constant $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$.\n- Energies specified in $\\mathrm{kJ}/\\mathrm{mol}$ must be converted to $\\mathrm{J}$ per molecule using $E_{\\mathrm{mol}} = \\dfrac{E_{\\mathrm{kJ/mol}} \\times 10^{3}}{N_{\\mathrm{A}}}$.\n\nGiven the above, construct a program that performs the following for each test case:\n1. For each $T$ in the test case, compute $S_{\\mathrm{sc}}(T)$ from the discrete torsional-state model with $E_{\\mathrm{trans}} = 0$, degeneracies $g_{\\mathrm{trans}} = 1$, $g_{\\mathrm{gauche}} = 2$, and $E_{\\mathrm{gauche}}$ specified by the test case.\n2. For each $T$, compute $\\chi(T) = \\chi_{0} + \\dfrac{A}{T} - \\gamma \\, \\dfrac{S_{\\mathrm{sc}}(T)}{k_{\\mathrm{B}} \\, M}$.\n3. For each pair $(\\phi, T)$, compute\n$$\n\\lambda(T) = - \\frac{ \\ln(1 - \\phi) + \\phi + \\chi(T) \\, \\phi^{2} }{ \\phi^{1/3} - \\frac{\\phi}{2} }.\n$$\n4. Aggregate $\\lambda(T)$ by averaging over the temperatures to obtain $\\overline{\\lambda}$, and compute $\\nu = \\dfrac{\\overline{\\lambda}}{v_{1}}$ in $\\mathrm{mol}/\\mathrm{m}^{3}$.\n\nYour program should implement the following test suite, which probes a general case, a high-flexibility boundary, and a low-flexibility edge case:\n\n- Test Case 1 (general hydrogel in water):\n    - $T$ values: $[298.15\\,\\mathrm{K}, 310.00\\,\\mathrm{K}, 320.00\\,\\mathrm{K}]$.\n    - Measured equilibrium polymer volume fractions: $[\\phi] = [0.10, 0.12, 0.11]$.\n    - Side-chain torsions $M = 4$.\n    - Gauche-state energy $E_{\\mathrm{gauche}} = 2.5\\,\\mathrm{kJ}/\\mathrm{mol}$.\n    - Degeneracies $g_{\\mathrm{trans}} = 1$, $g_{\\mathrm{gauche}} = 2$.\n    - Solvent molar volume $v_{1} = 18.0 \\times 10^{-6}\\,\\mathrm{m}^{3}/\\mathrm{mol}$.\n    - Parameters $\\chi_{0} = 0.40$, $A = 15.0\\,\\mathrm{K}$, $\\gamma = 0.30$.\n\n- Test Case 2 (high-flexibility boundary, $\\Delta E = 0$):\n    - $T$ values: $[298.15\\,\\mathrm{K}, 308.00\\,\\mathrm{K}, 318.00\\,\\mathrm{K}]$.\n    - Measured equilibrium polymer volume fractions: $[\\phi] = [0.08, 0.09, 0.085]$.\n    - Side-chain torsions $M = 10$.\n    - Gauche-state energy $E_{\\mathrm{gauche}} = 0.0\\,\\mathrm{kJ}/\\mathrm{mol}$.\n    - Degeneracies $g_{\\mathrm{trans}} = 1$, $g_{\\mathrm{gauche}} = 2$.\n    - Solvent molar volume $v_{1} = 18.0 \\times 10^{-6}\\,\\mathrm{m}^{3}/\\mathrm{mol}$.\n    - Parameters $\\chi_{0} = 0.40$, $A = 15.0\\,\\mathrm{K}$, $\\gamma = 0.30$.\n\n- Test Case 3 (stiff side chains edge case):\n    - $T$ values: $[298.15\\,\\mathrm{K}, 308.00\\,\\mathrm{K}, 318.00\\,\\mathrm{K}]$.\n    - Measured equilibrium polymer volume fractions: $[\\phi] = [0.15, 0.16, 0.155]$.\n    - Side-chain torsions $M = 3$.\n    - Gauche-state energy $E_{\\mathrm{gauche}} = 6.0\\,\\mathrm{kJ}/\\mathrm{mol}$.\n    - Degeneracies $g_{\\mathrm{trans}} = 1$, $g_{\\mathrm{gauche}} = 2$.\n    - Solvent molar volume $v_{1} = 18.0 \\times 10^{-6}\\,\\mathrm{m}^{3}/\\mathrm{mol}$.\n    - Parameters $\\chi_{0} = 0.40$, $A = 15.0\\,\\mathrm{K}$, $\\gamma = 0.30$.\n\nFinal output format:\n- Your program should produce a single line of output containing the estimated values of $\\nu$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$) for the three test cases as a comma-separated list enclosed in square brackets, for example, $\\left[ \\nu_{1}, \\nu_{2}, \\nu_{3} \\right]$.", "solution": "The solution proceeds by combining molecular-level conformational statistics with macroscopic network swelling thermodynamics, adhering to well-established frameworks.\n\nStep 1: Conformational entropy of side chains from the discrete torsional-state model.\n- For each rotatable bond, we consider two microstates: trans and gauche. Let $E_{\\mathrm{trans}} = 0$ and $E_{\\mathrm{gauche}}$ be specified. Degeneracies are $g_{\\mathrm{trans}} = 1$ and $g_{\\mathrm{gauche}} = 2$. The single-torsion partition function at temperature $T$ is\n$$\nZ(T) = g_{\\mathrm{trans}} e^{-E_{\\mathrm{trans}}/(k_{\\mathrm{B}} T)} + g_{\\mathrm{gauche}} e^{-E_{\\mathrm{gauche}}/(k_{\\mathrm{B}} T)} = 1 + 2 e^{-E_{\\mathrm{gauche}}/(k_{\\mathrm{B}} T)}.\n$$\n- The probabilities are\n$$\np_{\\mathrm{trans}}(T) = \\frac{1}{Z(T)}, \\quad p_{\\mathrm{gauche}}(T) = \\frac{2 e^{-E_{\\mathrm{gauche}}/(k_{\\mathrm{B}} T)}}{Z(T)}.\n$$\n- The single-torsion entropy is\n$$\nS_{\\mathrm{tor}}(T) = - k_{\\mathrm{B}} \\left[ p_{\\mathrm{trans}}(T) \\ln p_{\\mathrm{trans}}(T) + p_{\\mathrm{gauche}}(T) \\ln p_{\\mathrm{gauche}}(T) \\right].\n$$\n- For a side chain with $M$ independent torsions, the side-chain entropy is simply\n$$\nS_{\\mathrm{sc}}(T) = M \\, S_{\\mathrm{tor}}(T).\n$$\n\nStep 2: Relating side-chain entropy to the Flory-Huggins parameter.\n- The Flory-Huggins parameter $\\chi(T)$ encapsulates both enthalpic and entropic effects of polymer–solvent interactions. A commonly used temperature dependence is $\\chi(T) = \\chi_{0} + \\dfrac{A}{T} + \\chi_{\\mathrm{S}}(T)$. We model the entropic component attributable to side-chain torsions by\n$$\n\\chi_{\\mathrm{S}}(T) = - \\gamma \\, \\frac{S_{\\mathrm{sc}}(T)}{k_{\\mathrm{B}} \\, M} = - \\gamma \\, \\frac{S_{\\mathrm{tor}}(T)}{k_{\\mathrm{B}}}.\n$$\nThis form expresses the intuitive notion that greater conformational entropy of side chains, which enhances the number of accessible configurations contributing to local mixing, reduces $\\chi$ (making the solvent more favorable). The normalization by $M$ ensures we capture the per-torsion average and thus avoid scaling effects from side-chain length in the inferred $\\chi_{\\mathrm{S}}(T)$.\n\n- Therefore, for each $T$,\n$$\n\\chi(T) = \\chi_{0} + \\frac{A}{T} - \\gamma \\, \\frac{S_{\\mathrm{sc}}(T)}{k_{\\mathrm{B}} \\, M}.\n$$\n\nStep 3: Flory-Rehner equilibrium and estimating elastic-network parameter.\n- The Flory-Rehner equilibrium condition for an incompressible hydrogel network is\n$$\n\\ln(1 - \\phi) + \\phi + \\chi(T) \\, \\phi^{2} + \\lambda \\left( \\phi^{1/3} - \\frac{\\phi}{2} \\right) = 0,\n$$\nwhere $\\lambda = \\nu \\, v_{1}$ couples the effective network density $\\nu$ (in $\\mathrm{mol}/\\mathrm{m}^{3}$) to the solvent molar volume $v_{1}$ (in $\\mathrm{m}^{3}/\\mathrm{mol}$). This expression follows from equating the sum of the mixing osmotic pressure and the elastic retractive contribution to zero at equilibrium, with the elastic term derived from Gaussian chain statistics of the network strands under isotropic swelling.\n\n- For a given pair $(\\phi, T)$, this equation is linear in $\\lambda$ and can be rearranged to solve for $\\lambda$ directly:\n$$\n\\lambda(T) = - \\frac{ \\ln(1 - \\phi) + \\phi + \\chi(T) \\, \\phi^{2} }{ \\phi^{1/3} - \\frac{\\phi}{2} }.\n$$\n\nStep 4: Aggregating across temperatures to estimate a single network parameter.\n- For a single network (one test case), $\\nu$ should be temperature independent. The computed $\\lambda(T)$ will vary with $T$ only through $\\chi(T)$ and measurement variability. A statistically sensible estimator minimizing a least-squares objective for $\\lambda$ across the set of temperatures is the arithmetic mean:\n$$\n\\overline{\\lambda} = \\frac{1}{N_{T}} \\sum_{i=1}^{N_{T}} \\lambda(T_{i}),\n\\quad \\text{and} \\quad\n\\nu = \\frac{\\overline{\\lambda}}{v_{1}},\n$$\nwith $N_{T}$ equal to the number of temperature points within the test case.\n\nImplementation details and units:\n- Convert $E_{\\mathrm{gauche}}$ given in $\\mathrm{kJ}/\\mathrm{mol}$ to per-molecule energy in $\\mathrm{J}$ using $E_{\\mathrm{mol}} = \\dfrac{E_{\\mathrm{kJ/mol}} \\times 10^{3}}{N_{\\mathrm{A}}}$.\n- Use $k_{\\mathrm{B}}$ and $T$ in International System of Units (SI) to compute the Boltzmann factor $e^{-E_{\\mathrm{mol}}/(k_{\\mathrm{B}} T)}$ for each temperature.\n- Compute $S_{\\mathrm{sc}}(T)$, then $\\chi(T)$, then $\\lambda(T)$ for each pair $(\\phi, T)$, aggregate $\\overline{\\lambda}$, and compute $\\nu = \\dfrac{\\overline{\\lambda}}{v_{1}}$ in $\\mathrm{mol}/\\mathrm{m}^{3}$.\n\nThe program applies this procedure to the three provided test cases and outputs a single line containing the list of the three estimated $\\nu$ values in $\\mathrm{mol}/\\mathrm{m}^{3}$ as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants\nk_B = 1.380649e-23  # J/K\nN_A = 6.02214076e23  # 1/mol\n\ndef single_torsion_entropy(deltaE_kJ_per_mol: float, T: float) -> float:\n    \"\"\"\n    Compute the single-torsion conformational entropy S_tor(T) in J/K\n    using a two-state (trans/gauche) model with degeneracies g_trans=1, g_gauche=2,\n    E_trans=0, and E_gauche=deltaE.\n    \"\"\"\n    # Convert deltaE to J per molecule\n    E_gauche = (deltaE_kJ_per_mol * 1e3) / N_A  # J per molecule\n    # Boltzmann factors and degeneracies\n    g_trans = 1.0\n    g_gauche = 2.0\n    boltz_trans = g_trans * np.exp(0.0)  # E_trans = 0\n    boltz_gauche = g_gauche * np.exp(-E_gauche / (k_B * T))\n    Z = boltz_trans + boltz_gauche\n    p_trans = boltz_trans / Z\n    p_gauche = boltz_gauche / Z\n    # Entropy per torsion\n    # Guard against log(0) by clipping probabilities slightly away from 0 and 1\n    eps = 1e-300\n    p_trans = np.clip(p_trans, eps, 1.0 - eps)\n    p_gauche = np.clip(p_gauche, eps, 1.0 - eps)\n    S_tor = -k_B * (p_trans * np.log(p_trans) + p_gauche * np.log(p_gauche))\n    return S_tor\n\ndef chi_parameter(chi0: float, A: float, gamma: float, S_sc: float, M: int, T: float) -> float:\n    \"\"\"\n    Compute chi(T) = chi0 + A/T - gamma * (S_sc/(k_B * M)).\n    \"\"\"\n    chi_S = -gamma * (S_sc / (k_B * M))\n    chi_T = chi0 + (A / T) + chi_S\n    return chi_T\n\ndef lambda_from_FR(phi: float, chi_T: float) -> float:\n    \"\"\"\n    Compute lambda(T) from the Flory-Rehner equilibrium equation:\n    lambda(T) = - ( ln(1 - phi) + phi + chi_T * phi^2 ) / ( phi^(1/3) - phi/2 )\n    \"\"\"\n    # Ensure phi in (0,1)\n    if not (0.0 < phi < 1.0):\n        raise ValueError(\"phi must be in (0,1)\")\n    numerator = np.log(1.0 - phi) + phi + chi_T * (phi ** 2)\n    denom = np.cbrt(phi) - (phi / 2.0)\n    # denom should be positive for physically plausible phi\n    if denom <= 0.0:\n        raise ValueError(\"Denominator in lambda expression is non-positive; check phi.\")\n    lam = -numerator / denom\n    return lam\n\ndef estimate_nu_for_case(T_list, phi_list, M, deltaE_kJ_per_mol, v1, chi0, A, gamma):\n    \"\"\"\n    Estimate nu (mol/m^3) for a single test case by:\n    - computing S_sc(T) for each T,\n    - computing chi(T),\n    - computing lambda(T) for each (phi, T),\n    - averaging lambda(T) to get lambda_bar,\n    - dividing by v1 to get nu.\n    \"\"\"\n    lambdas = []\n    for T, phi in zip(T_list, phi_list):\n        S_tor = single_torsion_entropy(deltaE_kJ_per_mol, T)  # J/K per torsion\n        S_sc = M * S_tor  # J/K per side chain\n        chi_T = chi_parameter(chi0, A, gamma, S_sc, M, T)\n        lam = lambda_from_FR(phi, chi_T)\n        lambdas.append(lam)\n    lambda_bar = float(np.mean(lambdas))\n    nu = lambda_bar / v1  # mol/m^3\n    return nu\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            \"T_list\": [298.15, 310.00, 320.00],  # K\n            \"phi_list\": [0.10, 0.12, 0.11],\n            \"M\": 4,\n            \"deltaE_kJ_per_mol\": 2.5,  # kJ/mol\n            \"v1\": 18.0e-6,  # m^3/mol\n            \"chi0\": 0.40,\n            \"A\": 15.0,  # K\n            \"gamma\": 0.30,\n        },\n        # Test Case 2 (high flexibility, deltaE = 0)\n        {\n            \"T_list\": [298.15, 308.00, 318.00],  # K\n            \"phi_list\": [0.08, 0.09, 0.085],\n            \"M\": 10,\n            \"deltaE_kJ_per_mol\": 0.0,  # kJ/mol\n            \"v1\": 18.0e-6,  # m^3/mol\n            \"chi0\": 0.40,\n            \"A\": 15.0,  # K\n            \"gamma\": 0.30,\n        },\n        # Test Case 3 (stiff side chains)\n        {\n            \"T_list\": [298.15, 308.00, 318.00],  # K\n            \"phi_list\": [0.15, 0.16, 0.155],\n            \"M\": 3,\n            \"deltaE_kJ_per_mol\": 6.0,  # kJ/mol\n            \"v1\": 18.0e-6,  # m^3/mol\n            \"chi0\": 0.40,\n            \"A\": 15.0,  # K\n            \"gamma\": 0.30,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        nu = estimate_nu_for_case(\n            case[\"T_list\"],\n            case[\"phi_list\"],\n            case[\"M\"],\n            case[\"deltaE_kJ_per_mol\"],\n            case[\"v1\"],\n            case[\"chi0\"],\n            case[\"A\"],\n            case[\"gamma\"],\n        )\n        results.append(nu)\n\n    # Final print statement in the exact required format.\n    # Print floats with full precision; unit is mol/m^3 as specified in the problem.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3478929"}, {"introduction": "Calculating the free energy of transferring a molecule between different environments is a central task in computational biophysics. This practice delves into this challenge by asking you to build a continuum model to estimate the insertion free energy of a peptide into a lipid bilayer [@problem_id:3478902]. By deriving and implementing expressions for electrostatic (Born) and nonpolar (surface area) contributions, you will directly compare how different modeling paradigms—a detailed all-atom view versus a simplified coarse-grained one—represent the underlying physics.", "problem": "You are asked to design and implement a continuum-theory-based calculator for peptide insertion free energies into a lipid bilayer interior, using a physically grounded decomposition into a dielectric (electrostatic) contribution and a packing (nonpolar) contribution. The objective is to compare, for identical peptide characteristics and thermodynamic conditions, two modeling paradigms: an all-atom representation and a coarse-grained representation in the spirit of the Martini force field. Your program must compute, for each provided test case, the insertion free energy in kilojoules per mole for both paradigms, aggregate the results, and print them in the specified format.\n\nStart from the following fundamental bases and core definitions from continuum electrostatics and solvation thermodynamics:\n\n- The energy required to charge a spherical solute of net charge $q e$ and effective radius $r$ in a homogeneous dielectric medium of relative permittivity $\\varepsilon$ can be derived from the work of charging under electrostatic potential, given by the integral of the product of incremental charge and instantaneous potential. Coulomb’s law and linear dielectric response apply.\n- The nonpolar (packing) contribution to solvation is well-approximated, for convex solutes, by a term proportional to the solvent-accessible surface area, with proportionality constant equal to an effective surface tension. This captures the free energy cost of cavity creation and short-ranged dispersion in an averaged manner.\n\nAssume the peptide can be approximated as a sphere of radius $r$ (in nanometers) and net charge $q$ (in units of the elementary charge $e$). The bilayer interior is treated as a homogeneous hydrophobic dielectric medium. The insertion free energy is defined as the free energy in the membrane interior minus the free energy in bulk water. Under the assumptions above, express the insertion free energy as the sum of a dielectric (Born-type) term and a packing (surface-area) term. You must derive the required expressions from the stated bases, without introducing any formula not derivable from these bases.\n\nYou must use the following physical constants (treat these as exact for this problem):\n- Elementary charge: $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$.\n- Vacuum permittivity: $\\varepsilon_0 = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\cdot m^{-1}}$.\n- Avogadro’s number: $N_A = 6.02214076 \\times 10^{23} \\ \\mathrm{mol^{-1}}$.\n- Circle constant: $\\pi = 3.141592653589793$.\n\nModel parameterizations to be compared:\n- All-atom model:\n  - Water relative permittivity: $\\varepsilon_\\mathrm{w} = 78.5$.\n  - Membrane interior relative permittivity: $\\varepsilon_\\mathrm{m} = 2.0$.\n  - Water effective surface tension: $\\gamma_\\mathrm{w} = 3.0 \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot nm^{-2}}$.\n  - Membrane interior effective surface tension: $\\gamma_\\mathrm{m} = 0.5 \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot nm^{-2}}$.\n- Martini-like coarse-grained model:\n  - Water relative permittivity: $\\varepsilon_\\mathrm{w}^{CG} = 15.0$.\n  - Membrane interior relative permittivity: $\\varepsilon_\\mathrm{m}^{CG} = 15.0$.\n  - Water effective surface tension: $\\gamma_\\mathrm{w}^{CG} = 2.0 \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot nm^{-2}}$.\n  - Membrane interior effective surface tension: $\\gamma_\\mathrm{m}^{CG} = 0.3 \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot nm^{-2}}$.\n\nImplementation requirements:\n- For each environment $E \\in \\{\\mathrm{water}, \\mathrm{membrane}\\}$, compute the electrostatic charging free energy of a spherical solute of radius $r$ and charge $q e$ in medium $E$. Then compute the difference between membrane and water to obtain the dielectric contribution to insertion.\n- For the packing term, assume a surface-area proportional contribution with coefficient $\\gamma_E$, and compute the difference between membrane and water to obtain the packing contribution to insertion. Use the solvent-accessible surface area of a sphere, $A = 4 \\pi r^2$.\n- Ignore pressure–volume terms and any dispersion terms not captured by the surface-area proportional contribution.\n- All energies must be returned in kilojoules per mole, rounded to three decimal places.\n\nTest suite:\nYour program must evaluate the following four peptide cases, where each case is described by $(q, r)$ with $q$ unitless and $r$ in nanometers:\n- Case $1$: $(q, r) = (2, 0.6)$.\n- Case $2$: $(q, r) = (0, 0.8)$.\n- Case $3$: $(q, r) = (1, 0.2)$.\n- Case $4$: $(q, r) = (3, 1.2)$.\n\nFor each case, compute two numbers: the insertion free energy for the all-atom model and the insertion free energy for the Martini-like coarse-grained model. The program must aggregate the results in case order, with the all-atom result followed by the coarse-grained result for each case, flattened into a single list of length $8$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\"[x_1,x_2,\\dots,x_8]\"$.\n- Each number must be in kilojoules per mole, rounded to three decimal places, with standard rounding.\n- No additional text should be printed.", "solution": "The user's problem has been subjected to a rigorous validation process. All givens were extracted and analyzed. The problem is scientifically grounded in the established principles of continuum solvation theory (the Born model for electrostatics and a surface-area-proportional model for nonpolar effects), which are standard simplified models in computational biophysics. The problem is well-posed, providing all necessary physical constants, model parameters, and a clear, unambiguous objective. The language is objective and the setup is internally consistent and complete. Therefore, the problem is deemed **valid** and a solution is provided below.\n\nThe central task is to compute the insertion free energy, $\\Delta G_{ins}$, of a peptide from bulk water into the membrane interior. This energy is defined as the difference between the peptide's solvation free energy in the membrane ($G_{mem}$) and in water ($G_{w}$):\n$$\n\\Delta G_{ins} = G_{mem} - G_{w}\n$$\nThe problem specifies a decomposition of the solvation free energy in any medium $E$ into an electrostatic contribution, $G_{elec, E}$, and a nonpolar packing contribution, $G_{pack, E}$. Consequently, the insertion free energy can be written as the sum of the changes in these two components:\n$$\n\\Delta G_{ins} = (G_{elec, mem} - G_{elec, w}) + (G_{pack, mem} - G_{pack, w}) = \\Delta G_{elec} + \\Delta G_{pack}\n$$\nWe will now derive the expressions for $\\Delta G_{elec}$ and $\\Delta G_{pack}$ based on the provided fundamental principles.\n\n**1. Electrostatic Contribution ($\\Delta G_{elec}$)**\n\nThe electrostatic contribution is based on the Born model of ion solvation. The problem requires deriving this from the work of charging. Consider a conducting sphere of radius $r$ being charged from $0$ to a final charge $Q$. The electrostatic potential at the surface of the sphere when it holds an instantaneous charge $Q'$ is given by Coulomb's law as $V(Q') = \\frac{Q'}{4\\pi\\varepsilon r}$, where $\\varepsilon$ is the permittivity of the surrounding medium. The work $dW$ required to add an infinitesimal charge $dQ'$ is $V(Q')dQ'$. The total work to charge the sphere to $Q$ is the integral:\n$$\nG_{elec} = W = \\int_0^Q V(Q') dQ' = \\int_0^Q \\frac{Q'}{4\\pi\\varepsilon r} dQ' = \\frac{1}{4\\pi\\varepsilon r} \\left[ \\frac{Q'^2}{2} \\right]_0^Q = \\frac{Q^2}{8\\pi\\varepsilon r}\n$$\nThe medium's permittivity is $\\varepsilon = \\varepsilon_r \\varepsilon_0$, where $\\varepsilon_r$ is the relative permittivity and $\\varepsilon_0$ is the vacuum permittivity. The peptide has charge $Q = qe$, where $q$ is the charge number and $e$ is the elementary charge. Thus, the molar electrostatic free energy in a medium $E$ with relative permittivity $\\varepsilon_E$ is:\n$$\nG_{elec, E} = N_A \\frac{(qe)^2}{8\\pi \\varepsilon_E \\varepsilon_0 r}\n$$\nwhere $N_A$ is Avogadro's number. The electrostatic contribution to the insertion free energy is the difference between this energy in the membrane ($\\varepsilon_m$) and in water ($\\varepsilon_w$):\n$$\n\\Delta G_{elec} = G_{elec, mem} - G_{elec, w} = \\frac{N_A (qe)^2}{8\\pi \\varepsilon_0 r} \\left( \\frac{1}{\\varepsilon_m} - \\frac{1}{\\varepsilon_w} \\right)\n$$\nFor practical calculation, we use input units of $r$ in nanometers ($1 \\ \\mathrm{nm} = 10^{-9} \\ \\mathrm{m}$) and output units of kilojoules per mole ($1 \\ \\mathrm{kJ} = 1000 \\ \\mathrm{J}$). We can define a numerical prefactor $K_{elec}$:\n$$\nK_{elec} = \\frac{N_A e^2}{8000 \\pi \\varepsilon_0 \\cdot 10^{-9}} \\quad [\\mathrm{kJ \\cdot nm \\cdot mol^{-1}}]\n$$\nThe equation for the electrostatic contribution in the required units is then:\n$$\n\\Delta G_{elec} = K_{elec} \\frac{q^2}{r} \\left( \\frac{1}{\\varepsilon_m} - \\frac{1}{\\varepsilon_w} \\right)\n$$\n\n**2. Packing Contribution ($\\Delta G_{pack}$)**\n\nThe nonpolar packing contribution to solvation is stated to be proportional to the solvent-accessible surface area $A$, with the proportionality constant being an effective surface tension $\\gamma$. For a spherical peptide of radius $r$, the surface area is $A = 4\\pi r^2$. The molar packing free energy in a medium $E$ is:\n$$\nG_{pack, E} = \\gamma_E A = 4 \\pi \\gamma_E r^2\n$$\nThe packing contribution to the insertion free energy is the difference between the packing energy in the membrane ($\\gamma_m$) and in water ($\\gamma_w$):\n$$\n\\Delta G_{pack} = G_{pack, mem} - G_{pack, w} = 4 \\pi \\gamma_m r^2 - 4 \\pi \\gamma_w r^2 = 4 \\pi (\\gamma_m - \\gamma_w) r^2\n$$\nThe units are consistent, as $\\gamma$ is given in $\\mathrm{kJ \\cdot mol^{-1} \\cdot nm^{-2}}$ and $r$ in $\\mathrm{nm}$, yielding $\\Delta G_{pack}$ in $\\mathrm{kJ \\cdot mol^{-1}}$.\n\n**3. Total Insertion Free Energy and Model Specialization**\n\nCombining the two terms, the total insertion free energy is:\n$$\n\\Delta G_{ins}(r, q) = K_{elec} \\frac{q^2}{r} \\left(\\frac{1}{\\varepsilon_m} - \\frac{1}{\\varepsilon_w}\\right) + 4 \\pi (\\gamma_m - \\gamma_w) r^2\n$$\nThis general formula is now specialized for the two models.\n\n*   **All-Atom Model**: With parameters $(\\varepsilon_w, \\varepsilon_m) = (78.5, 2.0)$ and $(\\gamma_w, \\gamma_m) = (3.0, 0.5) \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot nm^{-2}}$, the insertion involves moving from a high-dielectric, high-tension environment to a low-dielectric, low-tension one. The term $(\\frac{1}{2.0} - \\frac{1}{78.5})$ is large and positive, creating a significant electrostatic penalty for charged species. The term $(\\gamma_m - \\gamma_w)$ is negative, providing a favorable packing contribution that drives insertion of nonpolar species.\n\n*   **Martini-like Coarse-Grained Model**: With parameters $(\\varepsilon_w^{CG}, \\varepsilon_m^{CG}) = (15.0, 15.0)$ and $(\\gamma_w^{CG}, \\gamma_m^{CG}) = (2.0, 0.3) \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot nm^{-2}}$, a critical feature emerges. The dielectric term becomes zero because the effective permittivities are identical: $\\left(\\frac{1}{15.0} - \\frac{1}{15.0}\\right) = 0$. This is a deliberate choice in such coarse-grained models, where electrostatic interactions are\n    tuned differently. Consequently, the insertion free energy is governed solely by the packing contribution:\n    $$\n    \\Delta G_{ins, CG}(r, q) = 4 \\pi (\\gamma_m^{CG} - \\gamma_w^{CG}) r^2\n    $$\nThe provided code implements these derived formulas to calculate the insertion free energies for the specified test cases under both modeling paradigms.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates peptide insertion free energies into a lipid bilayer using a continuum\n    model for both an all-atom and a coarse-grained representation.\n    \"\"\"\n\n    # Physical constants (treated as exact)\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n    AVOGADRO = 6.02214076e23     # Avogadro's number in mol^-1\n    PI = 3.141592653589793      # Circle constant\n\n    # Model parameterizations\n    params_all_atom = {\n        \"eps_w\": 78.5,    # Water relative permittivity\n        \"eps_m\": 2.0,     # Membrane interior relative permittivity\n        \"gamma_w\": 3.0,   # Water effective surface tension (kJ/mol/nm^2)\n        \"gamma_m\": 0.5,   # Membrane interior effective surface tension (kJ/mol/nm^2)\n    }\n\n    params_martini_cg = {\n        \"eps_w\": 15.0,\n        \"eps_m\": 15.0,\n        \"gamma_w\": 2.0,\n        \"gamma_m\": 0.3,\n    }\n\n    # Test suite: (q, r) where q is unitless charge, r is radius in nm\n    test_cases = [\n        (2.0, 0.6),\n        (0.0, 0.8),\n        (1.0, 0.2),\n        (3.0, 1.2),\n    ]\n\n    # Pre-calculate constant factors for efficiency and clarity.\n    # K_elec combines physical constants to work with r in nm and output in kJ/mol.\n    # Formula: N_A * e^2 / (8 * pi * eps_0) in J*m/mol\n    # Conversion: factor of 1000 for J->kJ, factor of 1e-9 for r(m)->r(nm)\n    k_elec = (AVOGADRO * E_CHARGE**2) / (8000 * PI * EPSILON_0 * 1e-9)\n\n    # K_pack is the geometric factor for the surface area of a sphere.\n    k_pack = 4 * PI\n\n    def calculate_free_energy(q, r, params):\n        \"\"\"\n        Calculates the insertion free energy for a given peptide and model.\n\n        Args:\n            q (float): Net charge of the peptide in units of elementary charge.\n            r (float): Effective radius of the peptide in nanometers.\n            params (dict): Dictionary of model parameters.\n\n        Returns:\n            float: The insertion free energy in kJ/mol.\n        \"\"\"\n        # Electrostatic (Born) contribution\n        # delta_G_elec = K_elec * (q^2 / r) * (1/eps_m - 1/eps_w)\n        dielectric_factor = (1 / params[\"eps_m\"]) - (1 / params[\"eps_w\"])\n        # Handle r=0 case, though not in test data. If q=0, the term is 0.\n        # If q!=0 and r=0, it would be infinite, but r>0 is a physical requirement.\n        delta_g_elec = k_elec * (q**2 / r) * dielectric_factor if r > 0 else 0.0\n\n        # Packing (surface area) contribution\n        # delta_G_pack = 4 * pi * (gamma_m - gamma_w) * r^2\n        packing_factor = params[\"gamma_m\"] - params[\"gamma_w\"]\n        delta_g_pack = k_pack * packing_factor * r**2\n\n        return delta_g_elec + delta_g_pack\n\n    results = []\n    for q, r in test_cases:\n        # Calculate for All-Atom model\n        g_ins_aa = calculate_free_energy(q, r, params_all_atom)\n        results.append(g_ins_aa)\n\n        # Calculate for Martini-like CG model\n        g_ins_cg = calculate_free_energy(q, r, params_martini_cg)\n        results.append(g_ins_cg)\n    \n    # Format the output string exactly as required.\n    # The f-string format specifier \"{:.3f}\" rounds to 3 decimal places.\n    # The default rounding mode (round half to even) is sufficient for these values.\n    output_str = f\"[{','.join(f'{res:.3f}' for res in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3478902"}]}