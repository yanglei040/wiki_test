{"hands_on_practices": [{"introduction": "The first step in analyzing a material's thermodynamic viability is to determine its stability relative to competing phases. This practice introduces the foundational concept of the \"energy above the convex hull,\" a critical metric that quantifies a phase's stability at zero Kelvin. By formulating this as a linear programming problem, you will learn to computationally determine whether a hypothetical material is stable or, if unstable, the energetic driving force for its decomposition [@problem_id:3441315].", "problem": "You are given a target phase with a composition vector and a total energy per atom, and a list of competing phases (excluding the target) each with its own composition vector and total energy per atom. Assume the thermodynamic temperature is effectively zero Kelvin so that Helmholtz free energy reduces to internal energy, and approximate the internal energy by the Density Functional Theory (DFT) total energy per atom. Use the following base principles to formalize the problem: (i) the convex hull of energy versus composition at zero Kelvin is the set of all convex combinations of competing phase energies as a function of composition, (ii) a phase is stable if and only if its energy lies on the lower convex envelope at its composition, and (iii) the energy above hull is the nonnegative difference between the phase energy and the hull energy at the same composition.\n\nFormally, let the target have composition vector $\\mathbf{x}_{t}\\in\\mathbb{R}^{d}$ with nonnegative components that sum to $1$, and energy per atom $E_{t}$ in electronvolts per atom. Let there be $n$ competing phases indexed by $i\\in\\{1,\\dots,n\\}$, each with composition vector $\\mathbf{x}_{i}\\in\\mathbb{R}^{d}$ with nonnegative components summing to $1$, and energy per atom $E_{i}$ in electronvolts per atom. Define the hull energy at composition $\\mathbf{x}_{t}$ as the optimal value of the linear program\n$$\n\\min_{\\mathbf{c}\\in\\mathbb{R}^{n}} \\sum_{i=1}^{n} c_{i} E_{i}\n$$\nsubject to the constraints\n$$\n\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t},\\quad \\sum_{i=1}^{n} c_{i} = 1,\\quad c_{i} \\ge 0\\ \\ \\forall i.\n$$\nDefine the energy above hull as\n$$\n\\Delta E_{\\mathrm{hull}} = \\max\\left(0,\\, E_{t} - \\min_{\\mathbf{c}} \\sum_{i=1}^{n} c_{i} E_{i}\\right).\n$$\nIf $\\Delta E_{\\mathrm{hull}} = 0$, the target is stable on the convex hull and the decomposition reaction is the null decomposition; in that case, report all decomposition coefficients as zeros. If $\\Delta E_{\\mathrm{hull}} > 0$, the optimal decomposition reaction coefficients are the components of the optimizer $\\mathbf{c}^{\\star}$ of the linear program above that attains the minimum.\n\nYour task is to write a program that, for each test case in the suite below, computes $\\Delta E_{\\mathrm{hull}}$ in millielectronvolts per atom and the corresponding optimal decomposition reaction coefficients. All energies $E$ are given in electronvolts per atom. Report $\\Delta E_{\\mathrm{hull}}$ in millielectronvolts per atom (meV/atom) as an integer rounded to the nearest integer. Report the decomposition coefficient vector as a list of floating-point numbers rounded to $6$ decimal places, ordered in the same sequence as the competing phases are provided in the test case. If the target is stable (i.e., $\\Delta E_{\\mathrm{hull}}=0$ within numerical tolerance), report a vector of zeros of length $n$.\n\nUse the following test suite. Each test case specifies a target and a list of competing phases. Each phase lists a composition vector and an energy per atom. All compositions are given as normalized fractions whose components sum to $1$.\n\nTest case $\\mathbf{1}$ (binary system $\\mathrm{A}$–$\\mathrm{B}$, stable target):\n- Target: composition $\\left[0.5,\\,0.5\\right]$, energy $-0.6\\ \\mathrm{eV/atom}$.\n- Competing phases in order: \n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$.\n\nTest case $\\mathbf{2}$ (binary system $\\mathrm{A}$–$\\mathrm{B}$, unstable target $\\mathrm{A}_{2}\\mathrm{B}$):\n- Target: composition $\\left[\\frac{2}{3},\\,\\frac{1}{3}\\right]$, energy $-0.3\\ \\mathrm{eV/atom}$.\n- Competing phases in order:\n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $3$: $\\mathrm{AB}$, composition $\\left[0.5,\\,0.5\\right]$, energy $-0.6\\ \\mathrm{eV/atom}$.\n\nTest case $\\mathbf{3}$ (ternary system $\\mathrm{A}$–$\\mathrm{B}$–$\\mathrm{C}$, stable ternary target):\n- Target: composition $\\left[\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3}\\right]$, energy $-0.65\\ \\mathrm{eV/atom}$.\n- Competing phases in order:\n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $3$: $\\mathrm{C}$, composition $\\left[0.0,\\,0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $4$: $\\mathrm{AB}$, composition $\\left[0.5,\\,0.5,\\,0.0\\right]$, energy $-0.6\\ \\mathrm{eV/atom}$;\n  $5$: $\\mathrm{AC}$, composition $\\left[0.5,\\,0.0,\\,0.5\\right]$, energy $-0.5\\ \\mathrm{eV/atom}$;\n  $6$: $\\mathrm{BC}$, composition $\\left[0.0,\\,0.5,\\,0.5\\right]$, energy $-0.55\\ \\mathrm{eV/atom}$.\n\nTest case $\\mathbf{4}$ (binary system $\\mathrm{A}$–$\\mathrm{B}$, unstable target at an endmember composition):\n- Target: composition $\\left[1.0,\\,0.0\\right]$, energy $0.05\\ \\mathrm{eV/atom}$.\n- Competing phases in order:\n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$.\n\nYour program must:\n- For each test case, set up and solve the linear program to obtain the minimum mixture energy at the target composition and the associated coefficients.\n- Compute $\\Delta E_{\\mathrm{hull}}$ in millielectronvolts per atom as an integer (round to the nearest integer).\n- For stable targets, report a decomposition coefficient vector of zeros; for unstable targets, report the optimal coefficients, each rounded to $6$ decimal places, ordered as specified.\n\nFinal output format: Your program should produce a single line of output containing a list of results, one per test case, with no extra spaces. Each result must be a two-element list of the form $\\left[\\Delta E_{\\mathrm{hull}}^{\\mathrm{meV/atom}},\\,[c_{1},c_{2},\\dots,c_{n}]\\right]$, where $\\Delta E_{\\mathrm{hull}}^{\\mathrm{meV/atom}}$ is an integer and the $c_{i}$ are floating-point numbers rounded to $6$ decimal places. For example, a line with two results would look like $\\left[[100,[0.333333,0.666667]],\\,[0,[0.000000,0.000000]]\\right]$.\n\nAssume numerical feasibility for each case, and use a nonnegativity tolerance of $10^{-9}$ and an equality constraint tolerance of $10^{-8}$ in deciding stability and rounding of coefficients.", "solution": "The problem is scientifically valid, well-posed, and formalizes a cornerstone concept in computational materials science: the prediction of thermodynamic phase stability. The task is to compute the energy above the convex hull, $\\Delta E_{\\mathrm{hull}}$, for a target phase relative to a set of competing phases. This quantity determines whether the target phase is stable or will decompose into a mixture of the competing phases at a temperature of $0\\ \\mathrm{K}$. The problem is reducible to solving a linear program (LP).\n\nThe state of a system at constant volume and a temperature of $0\\ \\mathrm{K}$ is described by its internal energy, $U$. A phase is thermodynamically stable if and only if it has the lowest possible energy for its given composition. We can visualize this by plotting energy versus composition. The set of all stable phases and their mixtures forms a \"lower convex envelope\" or \"convex hull\". Any phase whose energy-composition point lies on this hull is stable; any phase lying above it is unstable or metastable and has a driving force to decompose into the stable phases on the hull directly below it.\n\nThe problem defines the hull energy at a specific target composition $\\mathbf{x}_{t}$ as the minimum energy of any mixture of the $n$ competing phases that has the composition $\\mathbf{x}_{t}$. This is a classic constrained optimization problem. Let the coefficients of the mixture be $c_{1}, c_{2}, \\dots, c_{n}$, representing the molar fraction of each competing phase $i$ in the mixture. The mixture must satisfy three conditions:\n$1$. The overall composition of the mixture must equal the target composition: $\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t}$.\n$2$. The coefficients must sum to one, as they are fractions: $\\sum_{i=1}^{n} c_{i} = 1$.\n$3$. The coefficients must be non-negative, as we cannot have a negative amount of a phase: $c_{i} \\ge 0$ for all $i$.\n\nThe total energy of such a mixture is a weighted average of the energies of the competing phases: $E_{\\mathrm{mixture}} = \\sum_{i=1}^{n} c_{i} E_{i}$. Our goal is to find the set of coefficients $\\mathbf{c} = (c_1, \\dots, c_n)$ that satisfies the constraints while minimizing this energy. This is precisely the definition of the linear program provided:\n$$\nE_{\\mathrm{hull}}(\\mathbf{x}_t) = \\min_{\\mathbf{c}} \\sum_{i=1}^{n} c_{i} E_{i}\n$$\nsubject to:\n$$\n\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t}\n$$\n$$\n\\sum_{i=1}^{n} c_{i} = 1\n$$\n$$\nc_{i} \\ge 0\\ \\ \\forall i=1,\\dots,n\n$$\nBecause all composition vectors $\\mathbf{x}_{i}$ and $\\mathbf{x}_{t}$ are normalized (their components sum to $1$), the constraint $\\sum_{i=1}^{n} c_{i} = 1$ is mathematically redundant, as it is implied by the compositional constraint $\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t}$. However, when implementing a numerical solution, it is standard practice to work with a reduced set of composition variables to avoid linear dependencies. For a $d$-component system, we use the first $d-1$ components of each composition vector. In this reduced space, the constraint $\\sum_{i=1}^{n} c_{i} = 1$ is no longer redundant and must be explicitly included. This leads to a numerically stable and well-conditioned LP.\n\nThe LP is thus formulated as follows for a $d$-component system with $n$ competing phases:\nLet $\\mathbf{c}$ be the $n$-element vector of unknown coefficients.\nThe objective function to minimize is $\\mathbf{E}^T \\mathbf{c}$, where $\\mathbf{E}$ is the vector of energies $E_i$ of the competing phases.\nThe equality constraints are written as $A_{eq} \\mathbf{c} = \\mathbf{b}_{eq}$. We construct the $d \\times n$ matrix $A_{eq}$ and $d$-element vector $\\mathbf{b}_{eq}$ as:\n- The first $d-1$ rows of $A_{eq}$ are populated with the first $d-1$ components of the composition vectors $\\mathbf{x}_i$ of the competing phases.\n- The last row of $A_eq$ is composed of all ones.\n- The first $d-1$ elements of $\\mathbf{b}_{eq}$ are the first $d-1$ components of the target composition vector $\\mathbf{x}_t$.\n- The last element of $\\mathbf{b}_{eq}$ is $1$.\nThe non-negativity constraint is $c_i \\ge 0$, which defines the bounds for each variable.\n\nWe utilize the `scipy.optimize.linprog` function to solve this LP. The function returns the optimal value of the objective function, which is the hull energy $E_{\\mathrm{hull}}(\\mathbf{x}_t)$, and the optimal coefficient vector $\\mathbf{c}^{\\star}$ that achieves this minimum.\n\nThe energy above the hull is then calculated as $\\Delta E = E_{t} - E_{\\mathrm{hull}}(\\mathbf{x}_t)$. According to the problem's definition, we must report $\\Delta E_{\\mathrm{hull}} = \\max(0, \\Delta E)$. A numerical tolerance of $10^{-8}$ is used to assess stability: if $\\Delta E \\le 10^{-8}$, the phase is considered stable.\n- If stable, $\\Delta E_{\\mathrm{hull}}$ is reported as $0\\ \\mathrm{meV/atom}$, and the decomposition coefficients are reported as a vector of zeros, signifying a null decomposition.\n- If unstable ($\\Delta E > 10^{-8}$), $\\Delta E_{\\mathrm{hull}}$ is reported in meV/atom, rounded to the nearest integer. The decomposition coefficients are given by the optimizer $\\mathbf{c}^{\\star}$ from the LP, with each component rounded to $6$ decimal places. Small negative values in $\\mathbf{c}^{\\star}$ arising from floating-point inaccuracies are clipped to zero before rounding.\n\nThis systematic procedure is applied to each test case to generate the final results.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to solve the phase stability problem for all test cases.\n    \"\"\"\n    # Tolerances specified in the problem\n    STABILITY_TOLERANCE = 1e-8\n\n    test_cases = [\n        # Test case 1 (binary system A–B, stable target)\n        {\n            \"target\": (np.array([0.5, 0.5]), -0.6),\n            \"competitors\": [\n                (np.array([1.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0]), 0.0),\n            ]\n        },\n        # Test case 2 (binary system A–B, unstable target A2B)\n        {\n            \"target\": (np.array([2/3, 1/3]), -0.3),\n            \"competitors\": [\n                (np.array([1.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0]), 0.0),\n                (np.array([0.5, 0.5]), -0.6),\n            ]\n        },\n        # Test case 3 (ternary system A–B–C, stable ternary target)\n        {\n            \"target\": (np.array([1/3, 1/3, 1/3]), -0.65),\n            \"competitors\": [\n                (np.array([1.0, 0.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0, 0.0]), 0.0),\n                (np.array([0.0, 0.0, 1.0]), 0.0),\n                (np.array([0.5, 0.5, 0.0]), -0.6),\n                (np.array([0.5, 0.0, 0.5]), -0.5),\n                (np.array([0.0, 0.5, 0.5]), -0.55),\n            ]\n        },\n        # Test case 4 (binary system A–B, unstable target at an endmember composition)\n        {\n            \"target\": (np.array([1.0, 0.0]), 0.05),\n            \"competitors\": [\n                (np.array([1.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0]), 0.0),\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        target_comp, target_energy = case[\"target\"]\n        competitor_comps = [c[0] for c in case[\"competitors\"]]\n        competitor_energies = [c[1] for c in case[\"competitors\"]]\n\n        # --- Set up the linear program ---\n        # Number of competing phases\n        n_competitors = len(competitor_energies)\n        # Number of components in the chemical system\n        d_components = len(target_comp)\n\n        # Objective function vector (energies of competing phases)\n        c_obj = np.array(competitor_energies)\n\n        # Equality constraint matrix A_eq\n        # For a d-component system, we use d-1 composition constraints\n        # and 1 constraint for the sum of coefficients.\n        A_eq = np.zeros((d_components, n_competitors))\n        if d_components > 1:\n            A_eq[:-1, :] = np.array(competitor_comps)[:, :-1].T\n        A_eq[-1, :] = 1.0\n\n        # Equality constraint vector b_eq\n        b_eq = np.zeros(d_components)\n        if d_components > 1:\n            b_eq[:-1] = target_comp[:-1]\n        b_eq[-1] = 1.0\n\n        # Bounds for coefficients c_i >= 0\n        bounds = [(0, None) for _ in range(n_competitors)]\n        \n        # --- Solve the linear program ---\n        # The 'highs' method is robust and is the default in recent SciPy.\n        lp_result = linprog(c=c_obj, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n        if not lp_result.success:\n            # Problem statement guarantees feasibility. If this happens, it's an unexpected issue.\n            raise RuntimeError(\"Linear program solver failed for a test case.\")\n\n        hull_energy = lp_result.fun\n        optimal_coeffs = lp_result.x\n        \n        # --- Calculate energy above hull and determine stability ---\n        delta_E = target_energy - hull_energy\n\n        if delta_E = STABILITY_TOLERANCE:\n            # Phase is stable or on the hull\n            dE_mev = 0\n            # Per problem spec, report zero coefficients for stable phases\n            decomp_coeffs = [0.0] * n_competitors\n        else:\n            # Phase is unstable\n            # Convert to meV/atom and round to nearest integer\n            dE_mev = int(round(delta_E * 1000))\n            # Use the optimizer from the LP as decomposition coefficients.\n            # Clip small negative values due to float precision before rounding.\n            decomp_coeffs = np.round(np.maximum(0, optimal_coeffs), 6).tolist()\n            \n        results.append([dE_mev, decomp_coeffs])\n\n    # --- Format and print the final output string ---\n    # The output format must be a single line with no spaces.\n    formatted_results = []\n    for res in results:\n        dE_val, coeffs_list = res\n        coeffs_str = f\"[{','.join([f'{c:.6f}' for c in coeffs_list])}]\"\n        formatted_results.append(f\"[{dE_val},{coeffs_str}]\")\n    \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "3441315"}, {"introduction": "Knowing a material is unstable is only half the story; the crucial next step is to predict its decomposition products. This exercise builds on the concept of stability analysis by tasking you with finding the specific, stoichiometrically balanced reaction into which an unstable compound will decompose. You will use linear programming to identify the lowest-energy product mixture and then apply principles of chemical stoichiometry to determine the integer coefficients of the decomposition reaction [@problem_id:3441322].", "problem": "You are given a fixed set of candidate product phases in a three-component chemical system comprised of elements labeled $A$, $B$, and $C$. Each phase is specified by its composition vector, its formula-unit size, and its formation energy per atom. A single metastable ternary reactant is to be decomposed into a non-negative linear combination of these candidate products. Your task is to compute the stoichiometrically balanced reaction coefficients that minimize the reaction energy per atom, and then report the minimized reaction energy per atom together with the minimal integer reaction coefficients.\n\nThe fundamental base for this problem is as follows. In a three-component system, a phase with composition vector $\\mathbf{y} = (y_A,y_B,y_C)$ per atom lies on the Gibbs composition simplex defined by $y_A \\ge 0$, $y_B \\ge 0$, $y_C \\ge 0$, and $y_A + y_B + y_C = 1$. For a given metastable reactant with composition $\\mathbf{c}_R$ and formation energy per atom $E_R$, and a set of product phases indexed by $i$ with compositions $\\mathbf{y}_i$ and formation energies per atom $E_i$, the decomposition that minimizes the reaction energy per atom is obtained by solving the convex optimization problem\n$$\n\\min_{\\{w_i\\}_{i=1}^M} \\sum_{i=1}^M w_i E_i \\quad \\text{subject to} \\quad \\sum_{i=1}^M w_i \\mathbf{y}_i = \\mathbf{c}_R,\\; w_i \\ge 0,\n$$\nwhere $M$ is the number of candidate products and the equality is componentwise for $A$, $B$, and $C$. The reaction energy per atom is then\n$$\n\\Delta E = \\left(\\sum_{i=1}^M w_i E_i\\right) - E_R,\n$$\nwhich is minimized by the solution above. The non-negativity of the weights $w_i$ ensures that the products lie on the convex hull that maps the lowest energy combination of phases at the reactant composition.\n\nTo convert the continuous solution to stoichiometrically balanced integer reaction coefficients, let the reactant have a formula-unit size $s_R$ equal to the total number of atoms in its simplest integer formula representation, and let product $i$ have formula-unit size $s_i$ equal to the total number of atoms in its simplest integer formula. If $\\{w_i\\}$ is the optimal solution, then any positive integer $m$ produces a balanced reaction\n$$\n\\alpha \\cdot R \\to \\sum_{i=1}^M \\beta_i \\cdot P_i,\n$$\nwith $\\alpha = m$ and\n$$\n\\beta_i = m \\cdot \\frac{s_R}{s_i} \\, w_i.\n$$\nThe primitive integer reaction coefficients are obtained by choosing the smallest positive integer $m$ that makes all $\\beta_i$ integers, and then dividing all coefficients $(\\alpha,\\beta_1,\\dots,\\beta_M)$ by their greatest common divisor. This produces stoichiometrically balanced integer coefficients.\n\nAll energies are in electronvolts per atom (eV/atom). All composition vectors must be interpreted as atomic fractions. You must express the final reaction energy per atom in eV/atom, rounded to six decimal places.\n\nThe candidate product phases are fixed across all test cases and listed below. Each phase is specified by $(\\text{name}, \\mathbf{y}, s, E)$:\n- $A$: $(A, (1,0,0), 1, 0.0)$\n- $B$: $(B, (0,1,0), 1, 0.0)$\n- $C$: $(C, (0,0,1), 1, 0.0)$\n- $AB$: $(AB, (0.5,0.5,0), 2, -0.60)$\n- $AC$: $(AC, (0.5,0,0.5), 2, -0.50)$\n- $BC$: $(BC, (0,0.5,0.5), 2, -0.55)$\n\nYour program must solve the linear program for each test case, convert to the minimal integer reaction coefficients including the reactant coefficient, and output the results in the specified format. For each test case, you must output a list with two entries: the minimized reaction energy per atom $\\Delta E$ in eV/atom rounded to six decimal places, and the list of minimal integer reaction coefficients in the fixed order $[\\alpha, \\beta_{AB}, \\beta_{AC}, \\beta_{BC}, \\beta_{A}, \\beta_{B}, \\beta_{C}]$, where $\\alpha$ is the reactant coefficient and the remaining entries are the product coefficients.\n\nTest suite:\n- Case $1$: Reactant $A_2B_1C_1$ with $s_R = 4$, composition $\\mathbf{c}_R = (0.5,0.25,0.25)$, and $E_R = -0.40$.\n- Case $2$: Reactant $A_1B_1C_2$ with $s_R = 4$, composition $\\mathbf{c}_R = (0.25,0.25,0.5)$, and $E_R = -0.47$.\n- Case $3$: Reactant $A_3B_1C_1$ with $s_R = 5$, composition $\\mathbf{c}_R = (0.6,0.2,0.2)$, and $E_R = -0.40$.\n- Case $4$: Reactant $A_4B_3C_3$ with $s_R = 10$, composition $\\mathbf{c}_R = (0.4,0.3,0.3)$, and $E_R = -0.52$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all four cases as a comma-separated list enclosed in square brackets. Each case result must itself be a list of the form $[\\Delta E, [\\alpha, \\beta_{AB}, \\beta_{AC}, \\beta_{BC}, \\beta_{A}, \\beta_{B}, \\beta_{C}]]$. For example, the overall output should look like $[[\\Delta E_1,[\\alpha_1,\\dots]],[\\Delta E_2,[\\alpha_2,\\dots]],[\\Delta E_3,[\\alpha_3,\\dots]],[\\Delta E_4,[\\alpha_4,\\dots]]]$, with $\\Delta E_i$ rounded to six decimal places and all coefficients integers.", "solution": "The problem requires finding the decomposition products of a metastable reactant by identifying the lowest-energy mixture of stable phases that has the same overall composition. This is a classic chemical thermodynamics problem that can be formulated and solved as a linear program (LP).\n\n**1. Linear Programming Formulation**\nThe core of the problem is to find a set of non-negative weights, $\\{w_i\\}$, representing the molar fractions of the product phases in a mixture, that satisfies two conditions:\n- **Mass Conservation:** The weighted sum of the product compositions must equal the reactant's composition: $\\sum_{i=1}^M w_i \\mathbf{y}_i = \\mathbf{c}_R$.\n- **Energy Minimization:** The total formation energy of the mixture, $\\sum_{i=1}^M w_i E_i$, must be minimized.\n\nThis is an LP problem where the variables are the weights $\\{w_i\\}$. We solve this for the optimal weights $\\{w_i^*\\}$, which gives us the composition of the decomposing mixture. The minimized reaction energy per atom is then the difference between the mixture's energy and the reactant's energy: $\\Delta E = (\\sum_i w_i^* E_i) - E_R$. The LP is formulated with an objective function to minimize $\\mathbf{E}^T \\mathbf{w}$ (where $\\mathbf{E}$ is the vector of product energies and $\\mathbf{w}$ is the vector of weights) subject to the equality constraint $\\mathbf{Y} \\mathbf{w} = \\mathbf{c}_R$ (where $\\mathbf{Y}$ is the matrix of product compositions) and the non-negativity constraint $\\mathbf{w} \\ge 0$.\n\n**2. Conversion to Integer Stoichiometric Coefficients**\nThe continuous weights $\\{w_i^*\\}$ from the LP solution represent the decomposition products in terms of atomic fractions. To find the balanced chemical equation with integer coefficients, we must convert these weights. The reaction is of the form $\\alpha \\cdot R \\to \\sum_{i=1}^M \\beta_i \\cdot P_i$.\n\nThe relationship between the LP weights and the stoichiometric coefficients is given by $\\beta_i / \\alpha = (s_R / s_i) \\cdot w_i^*$, where $s_R$ and $s_i$ are the number of atoms in the formula units of the reactant and product $i$, respectively.\n\nTo find the minimal integer coefficients:\n- We calculate the rational ratios $q_i = (s_R / s_i) \\cdot w_i^*$. This is best done using high-precision rational number arithmetic to avoid floating-point errors.\n- We find the smallest integer multiplier, $m$, that makes all values $m \\cdot q_i$ integers. This $m$ is the least common multiple (LCM) of the denominators of the rational numbers $q_i$.\n- We set the initial reactant coefficient $\\alpha = m$ and product coefficients $\\beta_i = \\text{integer}(m \\cdot q_i)$.\n- Finally, we divide all coefficients $(\\alpha, \\beta_1, \\dots, \\beta_M)$ by their greatest common divisor (GCD) to obtain the minimal integer set.\n\nThis procedure is implemented for each test case to determine the decomposition reaction and its energy.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\nfrom fractions import Fraction\nimport math\n\ndef solve():\n    \"\"\"\n    Solves for the minimum reaction energy and stoichiometric coefficients for\n    the decomposition of metastable ternary compounds.\n    \"\"\"\n\n    # Define the fixed set of candidate product phases\n    # Order: [AB, AC, BC, A, B, C]\n    products = {\n        'names': ['AB', 'AC', 'BC', 'A', 'B', 'C'],\n        'energies': np.array([-0.60, -0.50, -0.55, 0.0, 0.0, 0.0]),  # E_i in eV/atom\n        'sizes': np.array([2, 2, 2, 1, 1, 1]),  # s_i\n        'compositions': np.array([ # y_i\n            [0.5, 0.5, 0.0],  # AB\n            [0.5, 0.0, 0.5],  # AC\n            [0.0, 0.5, 0.5],  # BC\n            [1.0, 0.0, 0.0],  # A\n            [0.0, 1.0, 0.0],  # B\n            [0.0, 0.0, 1.0],  # C\n        ])\n    }\n    \n    # A_eq matrix for the linear program (conservation of elements A, B, C)\n    A_eq = products['compositions'].T\n\n    # Define the test cases for the reactants\n    test_cases = [\n        # (s_R, c_R, E_R)\n        (4, np.array([0.5, 0.25, 0.25]), -0.40),    # Case 1: A2B1C1\n        (4, np.array([0.25, 0.25, 0.5]), -0.47),     # Case 2: A1B1C2\n        (5, np.array([0.6, 0.2, 0.2]), -0.40),       # Case 3: A3B1C1\n        (10, np.array([0.4, 0.3, 0.3]), -0.52),      # Case 4: A4B3C3\n    ]\n\n    results = []\n    \n    # Tolerance for treating a float as zero\n    TOL = 1e-9\n\n    for s_R, c_R, E_R in test_cases:\n        # Solve the linear program to find the optimal weights w_i\n        # min c*x s.t. A_eq*x = b_eq, x >= 0\n        res = linprog(c=products['energies'], A_eq=A_eq, b_eq=c_R, bounds=(0, None), method='highs')\n\n        if not res.success:\n            # This should not happen for this well-posed problem\n            raise RuntimeError(\"Linear programming failed to find a solution.\")\n\n        # The optimal weights for the products\n        w = res.x\n        \n        # The minimized formation energy of the product mixture\n        E_products = res.fun\n        \n        # The minimized reaction energy per atom\n        delta_E = E_products - E_R\n\n        # --- Convert continuous weights to minimal integer stoichiometric coefficients ---\n        \n        q_fractions = []\n        denominators = [1]\n        \n        for i in range(len(w)):\n            if w[i] > TOL:\n                # Convert float weight to a rational number\n                w_frac = Fraction.from_float(w[i]).limit_denominator()\n                \n                # Calculate the unscaled rational coefficient q_i\n                q_i = (Fraction(s_R) / Fraction(products['sizes'][i])) * w_frac\n                q_fractions.append(q_i)\n                denominators.append(q_i.denominator)\n            else:\n                q_fractions.append(Fraction(0))\n\n        # The multiplier m is the LCM of the denominators\n        m = math.lcm(*denominators)\n        \n        # The reactant coefficient\n        alpha = m\n        \n        # The product coefficients\n        betas = np.array([int(m * q) for q in q_fractions])\n\n        # Find the greatest common divisor (GCD) of all non-zero coefficients\n        all_coeffs = [alpha] + list(b for b in betas if b > 0)\n        common_divisor = math.gcd(*all_coeffs)\n        \n        # Reduce coefficients to their minimal integer form\n        final_alpha = alpha // common_divisor\n        final_betas = (betas // common_divisor).tolist()\n\n        # Assemble the final result for this case\n        case_result = [\n            round(delta_E, 6),\n            [final_alpha] + final_betas\n        ]\n        results.append(case_result)\n\n    # Format the final output string exactly as specified\n    final_output_string = str(results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n\n```", "id": "3441322"}, {"introduction": "Moving beyond analysis into the realm of materials design, we can ask a powerful inverse question: how can we engineer a material system to exhibit a desired phase equilibrium? This advanced practice challenges you to solve an inverse convex hull problem, where you find the smallest possible adjustments to material energies to make a specific three-phase region stable. This technique demonstrates how computational tools can be used not just to predict properties, but to guide the synthesis of new materials with targeted thermodynamic characteristics [@problem_id:3441334].", "problem": "You are given a finite set of candidate phases in a ternary composition space with coordinates on the standard simplex and reference formation energies per atom. You may perturb each candidate energy by an amount bounded in magnitude to attempt to realize a specified target three-phase tie-triangle as an exposed facet of the lower convex envelope (the formation-energy convex hull). Your task is to construct a program that, for each target, solves for the minimal total absolute perturbation consistent with the facet being exposed and reports feasibility and the minimized value.\n\nMathematical and physical bases:\n- The lower convex envelope of formation energy per atom as a function of composition is the pointwise minimum of all affine (planar) functions that lie above all empirical data points, with equality on stable vertices and along stable tie-lines or tie-triangles. In a ternary at zero temperature, a stable three-phase coexistence region corresponds to a planar facet supported by exactly three non-collinear phase points.\n- A supporting plane is an affine function that satisfies two conditions: it interpolates exactly the energies of the facet-defining points, and it lies at or below the energies of all other points when evaluated at their compositions. For a lower convex envelope, the inequality is reversed relative to the plane value: all points must lie on or above the plane.\n- You will model the energy perturbations as decision variables subject to a uniform bound and minimize the sum of absolute perturbations, which is a convex objective representable linearly via auxiliary variables.\n\nDefinitions and notation:\n- Let there be $N$ candidate phases indexed by $i \\in \\{0,1,\\dots,N-1\\}$, each with composition represented by barycentric coordinates $(x_i,y_i)$ such that the third component is $1 - x_i - y_i$, and a reference formation energy per atom $E_{0,i}$ in electronvolts per atom (eV/atom).\n- Let $\\Delta E_i$ denote the perturbation applied to $E_{0,i}$, subject to the bound $\\lvert \\Delta E_i \\rvert \\le \\delta$ for a given $\\delta \\ge 0$. For elemental reference phases, impose the physical constraint $\\Delta E_i = 0$.\n- Let $(u,v,w)$ parametrize a plane $E(x,y) = u x + v y + w$ in energy-composition space.\n- For a target triple of distinct, non-collinear indices $(p,q,r)$, enforce that the plane interpolates their perturbed energies, so that $u x_j + v y_j + w = E_{0,j} + \\Delta E_j$ for each $j \\in \\{p,q,r\\}$.\n- To expose this plane as a lower supporting plane of the convex envelope, require for all $m \\in \\{0,\\dots,N-1\\} \\setminus \\{p,q,r\\}$ that $E_{0,m} + \\Delta E_m \\ge u x_m + v y_m + w + \\varepsilon$, where $\\varepsilon  0$ is a strict margin to avoid degeneracy. The margin $\\varepsilon$ is provided.\n\nOptimization formulation to solve:\n- Minimize $\\sum_{i=0}^{N-1} \\lvert \\Delta E_i \\rvert$ subject to the linear constraints described above and the bound constraints $-\\delta \\le \\Delta E_i \\le \\delta$ for all non-elemental phases and $\\Delta E_i = 0$ for elemental references. Express the sum of absolute values using auxiliary variables $t_i \\ge 0$ with linear constraints $t_i \\ge \\Delta E_i$ and $t_i \\ge -\\Delta E_i$, so that the objective becomes $\\min \\sum_i t_i$.\n\nData set to use in all test cases:\n- Number of candidates $N = 9$.\n- Compositions $(x_i,y_i)$ and reference formation energies $E_{0,i}$ in eV/atom are:\n  - $i=0$: $(x_0,y_0) = (1.0,0.0)$, $E_{0,0} = 0.0$.\n  - $i=1$: $(x_1,y_1) = (0.0,1.0)$, $E_{0,1} = 0.0$.\n  - $i=2$: $(x_2,y_2) = (0.0,0.0)$, $E_{0,2} = 0.0$.\n  - $i=3$: $(x_3,y_3) = (0.5,0.5)$, $E_{0,3} = -0.30$.\n  - $i=4$: $(x_4,y_4) = (0.5,0.0)$, $E_{0,4} = -0.25$.\n  - $i=5$: $(x_5,y_5) = (0.0,0.5)$, $E_{0,5} = -0.28$.\n  - $i=6$: $(x_6,y_6) = (0.33,0.33)$, $E_{0,6} = -0.32$.\n  - $i=7$: $(x_7,y_7) = (0.20,0.30)$, $E_{0,7} = -0.27$.\n  - $i=8$: $(x_8,y_8) = (0.40,0.20)$, $E_{0,8} = -0.26$.\n- Elemental references are $i \\in \\{0,1,2\\}$ and must satisfy $\\Delta E_i = 0$.\n\nTest suite:\nFor each of the following test cases, you must solve the linear program and report feasibility and the minimized sum of absolute perturbations $\\sum_i \\lvert \\Delta E_i \\rvert$ in eV/atom, rounded to six decimals.\n- Test case $1$: target triple $(p,q,r) = (3,4,5)$, perturbation limit $\\delta = 0.04$, margin $\\varepsilon = 0.002$.\n- Test case $2$: target triple $(p,q,r) = (3,5,6)$, perturbation limit $\\delta = 0.03$, margin $\\varepsilon = 0.002$.\n- Test case $3$: target triple $(p,q,r) = (0,1,2)$, perturbation limit $\\delta = 0.03$, margin $\\varepsilon = 0.002$.\n- Test case $4$: target triple $(p,q,r) = (4,7,8)$, perturbation limit $\\delta = 0.005$, margin $\\varepsilon = 0.002$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a two-element list $[\\text{feasible}, S]$, where $\\text{feasible}$ is a boolean indicating whether a solution exists and $S$ is the minimized sum $\\sum_i \\lvert \\Delta E_i \\rvert$ in eV/atom rounded to six decimals if feasible, and $-1.000000$ otherwise. For example: $[[\\text{True},0.012345],[\\text{False},-1.000000],\\dots]$.\n\nAngle units are not relevant. All energies are in electronvolts per atom (eV/atom), and all reported floating-point values must be numeric without unit strings, rounded to six decimals as specified.", "solution": "The core task is to determine the minimum total perturbation of formation energies, $\\sum_i |\\Delta E_i|$, required to make a specific three-phase region (a tie-triangle) thermodynamically stable. Stability is defined by the target triangle forming a facet of the lower convex hull of formation energy versus composition. This translates into a set of linear constraints on the perturbed energies, $E_i = E_{0,i} + \\Delta E_i$. The problem can be solved by formulating and solving a linear program for each test case.\n\n**Linear Programming Formulation**\n\nA linear program seeks to minimize a linear objective function subject to linear equality and inequality constraints. We first define the decision variables, then the objective function, and finally the constraints.\n\n**Decision Variables**\nLet $N=9$ be the number of candidate phases. Our decision variables are:\n1.  The coefficients of the supporting plane in energy-composition space, $u, v, w$, which define the plane $E(x,y) = u x + v y + w$.\n2.  The energy perturbation for each phase, $\\Delta E_i$, for $i \\in \\{0, 1, \\dots, N-1\\}$.\n3.  A set of auxiliary variables, $t_i \\ge 0$, for each phase, used to linearize the absolute value in the objective function.\n\nThe complete vector of variables is $\\mathbf{z} \\in \\mathbb{R}^{3+2N}$:\n$$\n\\mathbf{z} = [u, v, w, \\Delta E_0, \\dots, \\Delta E_{N-1}, t_0, \\dots, t_{N-1}]^T\n$$\n\n**Objective Function**\nThe goal is to minimize the sum of the absolute values of the energy perturbations, $\\sum_{i=0}^{N-1} |\\Delta E_i|$. This non-linear objective can be made linear by introducing the auxiliary variables $t_i$ and the constraints $t_i \\ge \\Delta E_i$ and $t_i \\ge -\\Delta E_i$. With these, minimizing $\\sum t_i$ is equivalent to minimizing $\\sum |\\Delta E_i|$. The objective function in standard LP form is $\\min \\mathbf{c}^T \\mathbf{z}$, where the cost vector $\\mathbf{c}$ is:\n$$\n\\mathbf{c} = [\\underbrace{0, \\dots, 0}_{3+N \\text{ times}}, \\underbrace{1, \\dots, 1}_{N \\text{ times}}]^T\n$$\n\n**Constraints**\nThe problem is subject to several sets of linear constraints, which can be expressed as equalities ($\\mathbf{A}_{eq} \\mathbf{z} = \\mathbf{b}_{eq}$), inequalities ($\\mathbf{A}_{ub} \\mathbf{z} \\le \\mathbf{b}_{ub}$), and bounds on the variables.\n\n1.  **Facet Interpolation (Equality Constraints):** For the target tie-triangle defined by the three non-collinear phases with indices $j \\in \\{p, q, r\\}$, their perturbed energies must lie exactly on the supporting plane:\n    $$\n    u x_j + v y_j + w = E_{0,j} + \\Delta E_j \\quad \\forall j \\in \\{p, q, r\\}\n    $$\n    Rearranging this into the standard form gives three equality constraints:\n    $$\n    u x_j + v y_j + w - \\Delta E_j = E_{0,j} \\quad \\forall j \\in \\{p, q, r\\}\n    $$\n\n2.  **Phase Stability (Inequality Constraints):** For the tie-triangle $(p, q, r)$ to be a facet of the *lower* convex hull, all other phases must have perturbed energies that lie on or above the supporting plane. A strict margin $\\varepsilon  0$ is required to avoid degeneracies:\n    $$\n    E_{0,m} + \\Delta E_m \\ge u x_m + v y_m + w + \\varepsilon \\quad \\forall m \\in \\{0, \\dots, N-1\\} \\setminus \\{p, q, r\\}\n    $$\n    Rearranging into the standard form gives $N-3$ inequality constraints:\n    $$\n    u x_m + v y_m + w - \\Delta E_m \\le E_{0,m} - \\varepsilon \\quad \\forall m \\notin \\{p, q, r\\}\n    $$\n\n3.  **Objective Linearization (Inequality Constraints):** To ensure that minimizing $\\sum t_i$ is equivalent to minimizing $\\sum |\\Delta E_i|$, we add the following $2N$ constraints:\n    $$\n    \\Delta E_i - t_i \\le 0 \\quad \\forall i \\in \\{0, \\dots, N-1\\}\n    $$\n    $$\n    -\\Delta E_i - t_i \\le 0 \\quad \\forall i \\in \\{0, \\dots, N-1\\}\n    $$\n\n4.  **Bound Constraints:**\n    *   The plane parameters $u$, $v$, and $w$ are unbounded: $-\\infty  u, v, w  \\infty$.\n    *   The energy perturbations for non-elemental phases are bounded by $\\delta$: $-\\delta \\le \\Delta E_i \\le \\delta$.\n    *   The elemental reference phases ($i \\in \\{0, 1, 2\\}$) are physically constrained to have zero energy perturbation: $\\Delta E_i = 0$. This is enforced as a bound constraint: $0 \\le \\Delta E_i \\le 0$.\n    *   The auxiliary variables $t_i$ must be non-negative: $t_i \\ge 0$.\n\n**Implementation Strategy**\nThis linear programming problem is solved using the `scipy.optimize.linprog` function. For each test case defined by a target triple $(p,q,r)$, a perturbation limit $\\delta$, and a margin $\\varepsilon$, the following steps are performed:\n1.  Construct the cost vector $\\mathbf{c}$ of size $3+2N$.\n2.  Construct the equality constraint matrix $\\mathbf{A}_{eq}$ (shape $(3, 3+2N)$) and vector $\\mathbf{b}_{eq}$ (size $3$) from the facet interpolation conditions.\n3.  Construct the inequality constraint matrix $\\mathbf{A}_{ub}$ (shape $(N-3+2N, 3+2N)$) and vector $\\mathbf{b}_{ub}$ (size $N-3+2N$) from the phase stability and objective linearization conditions.\n4.  Define the list of `(min, max)` tuples for the bounds on each of the $3+2N$ variables according to the rules specified above.\n5.  Invoke `linprog` with these matrices and vectors. The `highs` solver method is used for its robustness.\n6.  The `success` attribute of the returned result object indicates feasibility. If `True`, the minimized objective value $\\sum |\\Delta E_i|$ is given by `result.fun`. If `False`, the problem is infeasible. The final output is formatted as specified, with the feasibility status and the objective value (or $-1.0$ for infeasible cases) rounded to six decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Sets up and solves the linear programming problem for each test case.\n    \"\"\"\n    \n    # Common data for all test cases\n    N = 9\n    compositions = np.array([\n        [1.0, 0.0],  # i=0 (elemental)\n        [0.0, 1.0],  # i=1 (elemental)\n        [0.0, 0.0],  # i=2 (elemental)\n        [0.5, 0.5],  # i=3\n        [0.5, 0.0],  # i=4\n        [0.0, 0.5],  # i=5\n        [0.33, 0.33],# i=6\n        [0.20, 0.30],# i=7\n        [0.40, 0.20] # i=8\n    ])\n    \n    energies_ref = np.array([\n        0.0,   # i=0\n        0.0,   # i=1\n        0.0,   # i=2\n        -0.30, # i=3\n        -0.25, # i=4\n        -0.28, # i=5\n        -0.32, # i=6\n        -0.27, # i=7\n        -0.26  # i=8\n    ])\n    \n    elemental_indices = {0, 1, 2}\n\n    test_cases = [\n        # (target_triple, delta, epsilon)\n        ((3, 4, 5), 0.04, 0.002),\n        ((3, 5, 6), 0.03, 0.002),\n        ((0, 1, 2), 0.03, 0.002),\n        ((4, 7, 8), 0.005, 0.002),\n    ]\n\n    results = []\n    for target_triple, delta, epsilon in test_cases:\n        result = solve_lp_case(N, compositions, energies_ref, elemental_indices,\n                               target_triple, delta, epsilon)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{'True' if res[0] else 'False'},{res[1]:.6f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef solve_lp_case(N, compositions, energies_ref, elemental_indices,\n                  target_triple, delta, epsilon):\n    \"\"\"\n    Constructs and solves the linear program for a single test case.\n\n    Variables vector z (size 3 + 2*N):\n    [u, v, w, dE_0, ..., dE_{N-1}, t_0, ..., t_{N-1}]\n    - Indices 0, 1, 2: u, v, w (plane parameters)\n    - Indices 3 to 3+N-1: dE_i (energy perturbations)\n    - Indices 3+N to 3+2N-1: t_i (for |dE_i|)\n    \"\"\"\n    num_vars = 3 + 2 * N\n    \n    # 1. Objective function: Minimize sum(t_i)\n    c = np.zeros(num_vars)\n    c[3 + N:] = 1.0\n\n    # 2. Equality constraints: A_eq @ z = b_eq\n    # Plane interpolation for target triple\n    A_eq = np.zeros((3, num_vars))\n    b_eq = np.zeros(3)\n    for i, j in enumerate(target_triple):\n        # u*x_j + v*y_j + w - dE_j = E_ref_j\n        A_eq[i, 0] = compositions[j, 0]\n        A_eq[i, 1] = compositions[j, 1]\n        A_eq[i, 2] = 1.0\n        A_eq[i, 3 + j] = -1.0\n        b_eq[i] = energies_ref[j]\n\n    # 3. Inequality constraints: A_ub @ z = b_ub\n    other_indices = set(range(N)) - set(target_triple)\n    num_stability_constraints = len(other_indices)\n    num_abs_val_constraints = 2 * N\n    A_ub = np.zeros((num_stability_constraints + num_abs_val_constraints, num_vars))\n    b_ub = np.zeros(num_stability_constraints + num_abs_val_constraints)\n\n    # Stability constraints for non-target phases\n    for i, m in enumerate(other_indices):\n        # u*x_m + v*y_m + w - dE_m = E_ref_m - epsilon\n        A_ub[i, 0] = compositions[m, 0]\n        A_ub[i, 1] = compositions[m, 1]\n        A_ub[i, 2] = 1.0\n        A_ub[i, 3 + m] = -1.0\n        b_ub[i] = energies_ref[m] - epsilon\n    \n    # Absolute value linearization constraints: t_i >= +/- dE_i\n    # dE_i - t_i = 0\n    # -dE_i - t_i = 0\n    row_offset = num_stability_constraints\n    for i in range(N):\n        # dE_i - t_i = 0\n        A_ub[row_offset + 2 * i, 3 + i] = 1.0\n        A_ub[row_offset + 2 * i, 3 + N + i] = -1.0\n        # -dE_i - t_i = 0\n        A_ub[row_offset + 2 * i + 1, 3 + i] = -1.0\n        A_ub[row_offset + 2 * i + 1, 3 + N + i] = -1.0\n\n    # 4. Bounds for variables\n    bounds = []\n    # u, v, w are unbounded\n    bounds.extend([(None, None)] * 3)\n    # dE_i bounds\n    for i in range(N):\n        if i in elemental_indices:\n            bounds.append((0, 0))\n        else:\n            bounds.append((-delta, delta))\n    # t_i bounds (t_i >= 0)\n    bounds.extend([(0, None)] * N)\n    \n    # Solve the linear program\n    res = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if res.success:\n        return [True, res.fun]\n    else:\n        return [False, -1.0]\n\n# Run the main function\nsolve()\n```", "id": "3441334"}]}