{"hands_on_practices": [{"introduction": "Classical Nucleation Theory (CNT) is built upon the competition between the energetic cost of forming a new interface and the free energy gain of forming a more stable bulk phase. This foundational exercise guides you through the derivation of the two most important quantities in CNT: the critical nucleus radius $r^{*}$ and the nucleation energy barrier $\\Delta G^{*}$. By working from first principles and then applying the theory to a realistic scenario, you will solidify your understanding of the physical origins of the nucleation barrier and explore its extreme sensitivity to the interfacial free energy, $\\gamma$, through error propagation [@problem_id:3437248].", "problem": "Consider homogeneous isothermal nucleation of a spherical solid nucleus from its melt as described by Classical Nucleation Theory (CNT). The reversible Gibbs free energy change to form a cluster of radius $r$ is modeled as a sum of a surface term proportional to the area and an energetics driving term proportional to the volume. Let the isotropic solid–liquid interfacial free energy be $\\gamma$ and the bulk Gibbs free energy change per unit volume (negative for the favored phase) be $\\Delta g_{v}$. Take the nucleus as a perfect sphere and neglect elastic, anisotropy, and curvature-dependent corrections.\n\nYou are given the following parameters that are scientifically consistent with a deeply undercooled metallic melt:\n- Interfacial free energy: $\\gamma = 0.25\\,\\mathrm{J\\,m^{-2}}$ with a $10\\%$ relative uncertainty (that is, the standard uncertainty is $0.10 \\times \\gamma$).\n- Bulk driving free energy density: $\\Delta g_{v} = -8.0 \\times 10^{8}\\,\\mathrm{J\\,m^{-3}}$.\n\nStarting from first principles for the spherical cluster’s free energy model, derive the expressions for the critical radius $r^{*}$ and the corresponding nucleation barrier $\\Delta G^{*}$, explain their physical origin, and then evaluate them numerically using the given $\\gamma$ and $\\Delta g_{v}$. Next, assess the impact of the $10\\%$ uncertainty in $\\gamma$ on $\\Delta G^{*}$ using first-order differential error propagation, assuming no uncertainty in $\\Delta g_{v}$. Report the propagated absolute uncertainty in $\\Delta G^{*}$.\n\nAnswer specification:\n- Express $r^{*}$ in $\\mathrm{nm}$.\n- Express $\\Delta G^{*}$ and its propagated absolute uncertainty in $\\mathrm{J}$.\n- Round each reported quantity to four significant figures.\n- Provide the final answer as a row matrix containing, in order, $r^{*}$, $\\Delta G^{*}$, and the propagated absolute uncertainty in $\\Delta G^{*}$ due to the $10\\%$ uncertainty in $\\gamma$.", "solution": "The problem is valid as it is scientifically grounded in Classical Nucleation Theory (CNT), is mathematically well-posed, and uses objective, precise language with physically plausible parameters. All necessary information is provided, and no contradictions are present.\n\nThe reversible Gibbs free energy change, $\\Delta G$, to form a spherical nucleus of radius $r$ from its melt is the sum of a positive surface energy term and a negative bulk energy term. The surface term represents the energy cost of creating a new solid-liquid interface, while the bulk term represents the energy gained by transforming a volume of the higher-energy liquid phase to the lower-energy solid phase.\n\n1.  **Derivation of Critical Radius ($r^*$) and Nucleation Barrier ($\\Delta G^*$)**\n\nThe surface area of the spherical nucleus is $A = 4\\pi r^2$, and its volume is $V = \\frac{4}{3}\\pi r^3$. Given the isotropic solid-liquid interfacial free energy $\\gamma$ and the bulk Gibbs free energy change per unit volume $\\Delta g_{v}$, the total free energy change $\\Delta G(r)$ is:\n$$\n\\Delta G(r) = (\\text{Surface Area}) \\times \\gamma + (\\text{Volume}) \\times \\Delta g_{v}\n$$\n$$\n\\Delta G(r) = 4\\pi r^2 \\gamma + \\frac{4}{3}\\pi r^3 \\Delta g_{v}\n$$\nThe competition between the positive $r^2$ term and the negative $r^3$ term (since $\\Delta g_v  0$) results in an energy barrier. The peak of this barrier corresponds to the critical nucleus size, $r^*$, and the nucleation barrier, $\\Delta G^*$. To find the critical radius, we find the maximum of the $\\Delta G(r)$ function by taking its derivative with respect to $r$ and setting it to zero.\n$$\n\\frac{d(\\Delta G(r))}{dr} = \\frac{d}{dr} \\left( 4\\pi r^2 \\gamma + \\frac{4}{3}\\pi r^3 \\Delta g_{v} \\right) = 8\\pi r \\gamma + 4\\pi r^2 \\Delta g_{v}\n$$\nSetting the derivative to zero for $r = r^*$:\n$$\n8\\pi r^* \\gamma + 4\\pi (r^*)^2 \\Delta g_{v} = 0\n$$\nSince $r^*=0$ corresponds to the initial state (no nucleus), we seek the non-trivial solution by dividing by $4\\pi r^*$:\n$$\n2\\gamma + r^* \\Delta g_{v} = 0\n$$\nSolving for $r^*$, we obtain the expression for the critical radius:\n$$\nr^* = -\\frac{2\\gamma}{\\Delta g_{v}}\n$$\nPhysically, $r^*$ is the radius at which a nucleus is in unstable equilibrium. Nuclei smaller than $r^*$ tend to shrink to reduce surface energy, while nuclei larger than $r^*$ tend to grow to reduce bulk free energy.\n\nThe nucleation barrier, $\\Delta G^*$, is the value of $\\Delta G(r)$ at $r=r^*$:\n$$\n\\Delta G^* = \\Delta G(r^*) = 4\\pi (r^*)^2 \\gamma + \\frac{4}{3}\\pi (r^*)^3 \\Delta g_{v}\n$$\nSubstituting the expression for $r^*$:\n$$\n\\Delta G^* = 4\\pi \\left(-\\frac{2\\gamma}{\\Delta g_{v}}\\right)^2 \\gamma + \\frac{4}{3}\\pi \\left(-\\frac{2\\gamma}{\\Delta g_{v}}\\right)^3 \\Delta g_{v}\n$$\n$$\n\\Delta G^* = 4\\pi \\left(\\frac{4\\gamma^2}{(\\Delta g_{v})^2}\\right) \\gamma + \\frac{4}{3}\\pi \\left(-\\frac{8\\gamma^3}{(\\Delta g_{v})^3}\\right) \\Delta g_{v}\n$$\n$$\n\\Delta G^* = \\frac{16\\pi\\gamma^3}{(\\Delta g_{v})^2} - \\frac{32\\pi\\gamma^3}{3(\\Delta g_{v})^2}\n$$\n$$\n\\Delta G^* = \\left( \\frac{48-32}{3} \\right) \\frac{\\pi\\gamma^3}{(\\Delta g_{v})^2} = \\frac{16\\pi\\gamma^3}{3(\\Delta g_{v})^2}\n$$\nThis is the energy barrier that must be overcome by thermal fluctuations for a stable nucleus to form.\n\n2.  **Numerical Evaluation**\n\nGiven the parameters:\n$\\gamma = 0.25\\,\\mathrm{J\\,m^{-2}}$\n$\\Delta g_{v} = -8.0 \\times 10^{8}\\,\\mathrm{J\\,m^{-3}}$\n\nWe calculate $r^*$:\n$$\nr^* = -\\frac{2 \\times 0.25}{-8.0 \\times 10^{8}} = \\frac{0.5}{8.0 \\times 10^{8}} = 0.625 \\times 10^{-9}\\,\\mathrm{m}\n$$\nConverting to nanometers ($1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m}$) and rounding to four significant figures:\n$$\nr^* = 0.6250\\,\\mathrm{nm}\n$$\nNext, we calculate $\\Delta G^*$:\n$$\n\\Delta G^* = \\frac{16\\pi (0.25)^3}{3(-8.0 \\times 10^{8})^2} = \\frac{16\\pi (0.015625)}{3(64 \\times 10^{16})} = \\frac{0.25\\pi}{192 \\times 10^{16}} \\approx 4.090615 \\times 10^{-19}\\,\\mathrm{J}\n$$\nRounding to four significant figures:\n$$\n\\Delta G^* = 4.091 \\times 10^{-19}\\,\\mathrm{J}\n$$\n\n3.  **Uncertainty Propagation**\n\nWe need to find the absolute uncertainty in $\\Delta G^*$, denoted $u(\\Delta G^*)$, resulting from the $10\\%$ relative uncertainty in $\\gamma$. We assume the uncertainty in $\\Delta g_v$ is zero. The relationship is $\\Delta G^* = C\\gamma^3$, where $C = \\frac{16\\pi}{3(\\Delta g_v)^2}$ is a constant.\n\nFor a function of the form $f(x) = ax^n$, the first-order propagation of relative uncertainty is given by:\n$$\n\\frac{u(f)}{|f|} = |n| \\frac{u(x)}{|x|}\n$$\nIn our case, $f = \\Delta G^*$, $x = \\gamma$, and $n=3$. The relative uncertainty in $\\gamma$ is given as $10\\%$, or $\\frac{u(\\gamma)}{\\gamma} = 0.10$.\nThe relative uncertainty in $\\Delta G^*$ is therefore:\n$$\n\\frac{u(\\Delta G^*)}{\\Delta G^*} = 3 \\times \\frac{u(\\gamma)}{\\gamma} = 3 \\times 0.10 = 0.30\n$$\nThe absolute uncertainty $u(\\Delta G^*)$ is $30\\%$ of the calculated value of $\\Delta G^*$:\n$$\nu(\\Delta G^*) = 0.30 \\times \\Delta G^* = 0.30 \\times (4.090615 \\times 10^{-19}\\,\\mathrm{J}) \\approx 1.227185 \\times 10^{-19}\\,\\mathrm{J}\n$$\nRounding to four significant figures:\n$$\nu(\\Delta G^*) = 1.227 \\times 10^{-19}\\,\\mathrm{J}\n$$\nThe final results to be reported are $r^* = 0.6250\\,\\mathrm{nm}$, $\\Delta G^* = 4.091 \\times 10^{-19}\\,\\mathrm{J}$, and $u(\\Delta G^*) = 1.227 \\times 10^{-19}\\,\\mathrm{J}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6250  4.091 \\times 10^{-19}  1.227 \\times 10^{-19}\n\\end{pmatrix}\n}\n$$", "id": "3437248"}, {"introduction": "While the nucleation barrier $\\Delta G^{*}$ defines the energetic obstacle to phase transformation, it does not by itself describe the kinetics of the process. This practice bridges the gap between the static energy landscape of CNT and the dynamic, stochastic reality of nucleation by modeling it as a Poisson process. You will derive the probability distribution for the waiting time until the first nucleation event occurs in a finite volume, thereby connecting the microscopic nucleation rate density $J$ to a directly measurable macroscopic quantity [@problem_id:3437202].", "problem": "Consider homogeneous, isothermal nucleation in a closed system of finite volume $V$, at fixed supersaturation and temperature, such that the steady-state nucleation rate density $J$ (number of supercritical clusters formed per unit volume per unit time) is constant in time and uniform in space. Assume that nucleation events are independent across disjoint space-time regions and that the probability of a single nucleation event occurring in a small time interval $[t,t+\\mathrm{d}t)$ within the volume $V$ is proportional to $\\mathrm{d}t$, with probability $J V \\,\\mathrm{d}t + o(\\mathrm{d}t)$, while the probability of two or more events in $[t,t+\\mathrm{d}t)$ is $o(\\mathrm{d}t)$. These assumptions define a homogeneous Poisson process of events in the volume with constant intensity.\n\nLet $T$ be the random waiting time from an initial observation time $t=0$ until the first nucleation event occurs in the volume $V$. Starting from the defining properties above, derive the probability distribution of $T$ by analyzing the survival probability for no events in $[0,t]$, and then compute the mean $\\mathbb{E}[T]$ and variance $\\mathrm{Var}(T)$ in closed form in terms of $J$ and $V$. Express the mean in seconds and the variance in seconds squared. Provide your final answer as exact analytic expressions; no numerical substitution or rounding is required.", "solution": "The scenario describes a homogeneous Poisson process of nucleation events in a finite volume $V$ with constant intensity $J$ per unit volume per unit time. For the whole volume, the event intensity (rate) is $\\lambda = J V$ with units of inverse seconds. We consider the waiting time $T$ to the first event after $t=0$.\n\nWe start from the defining properties of a homogeneous Poisson process: independent increments, stationarity of increments, and the small-interval probabilities that over $[t,t+\\mathrm{d}t)$ there is one event with probability $\\lambda \\,\\mathrm{d}t + o(\\mathrm{d}t)$ and two or more events with probability $o(\\mathrm{d}t)$, where $\\lambda = J V$.\n\nDefine the survival function $S(t) = \\mathbb{P}(T  t)$, which is the probability that no nucleation events have occurred in the interval $[0,t]$. Consider $S(t+\\mathrm{d}t)$ for an infinitesimal $\\mathrm{d}t  0$. The event of having no events in $[0,t+\\mathrm{d}t]$ can be decomposed into having no events in $[0,t]$ and no events in $[t,t+\\mathrm{d}t]$, with independence across disjoint intervals. Therefore,\n$$\nS(t+\\mathrm{d}t) = S(t)\\,\\mathbb{P}(\\text{no events in }[t,t+\\mathrm{d}t]) = S(t)\\,\\left(1 - \\lambda\\,\\mathrm{d}t + o(\\mathrm{d}t)\\right).\n$$\nSubtracting $S(t)$ from both sides and dividing by $\\mathrm{d}t$ gives\n$$\n\\frac{S(t+\\mathrm{d}t) - S(t)}{\\mathrm{d}t} = -\\lambda\\,S(t) + \\frac{o(\\mathrm{d}t)}{\\mathrm{d}t}.\n$$\nTaking the limit $\\mathrm{d}t \\to 0$ yields the ordinary differential equation\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = -\\lambda\\,S(t), \\quad S(0) = 1.\n$$\nSolving this linear differential equation gives\n$$\nS(t) = \\exp(-\\lambda t) = \\exp(-J V\\, t).\n$$\nThe cumulative distribution function of $T$ is $F_T(t) = 1 - S(t) = 1 - \\exp(-\\lambda t)$ for $t \\ge 0$, and the probability density function is the time derivative of $F_T(t)$,\n$$\nf_T(t) = \\frac{\\mathrm{d}}{\\mathrm{d}t}F_T(t) = \\lambda\\,\\exp(-\\lambda t) = J V\\,\\exp(-J V\\, t), \\quad t \\ge 0.\n$$\nThus $T$ is exponentially distributed with rate $\\lambda = J V$. The mean and variance follow from the exponential distribution, or can be computed directly via integrals. Compute the mean:\n$$\n\\mathbb{E}[T] = \\int_{0}^{\\infty} t\\, f_T(t)\\,\\mathrm{d}t = \\int_{0}^{\\infty} t\\, \\lambda\\, \\exp(-\\lambda t)\\,\\mathrm{d}t.\n$$\nUsing the standard integral $\\int_{0}^{\\infty} t\\, \\exp(-\\lambda t)\\,\\mathrm{d}t = \\frac{1}{\\lambda^{2}}$,\n$$\n\\mathbb{E}[T] = \\lambda \\cdot \\frac{1}{\\lambda^{2}} = \\frac{1}{\\lambda} = \\frac{1}{J V}.\n$$\nCompute the second moment:\n$$\n\\mathbb{E}[T^{2}] = \\int_{0}^{\\infty} t^{2}\\, \\lambda\\, \\exp(-\\lambda t)\\,\\mathrm{d}t.\n$$\nUsing $\\int_{0}^{\\infty} t^{2}\\, \\exp(-\\lambda t)\\,\\mathrm{d}t = \\frac{2}{\\lambda^{3}}$, we have\n$$\n\\mathbb{E}[T^{2}] = \\lambda \\cdot \\frac{2}{\\lambda^{3}} = \\frac{2}{\\lambda^{2}}.\n$$\nTherefore the variance is\n$$\n\\mathrm{Var}(T) = \\mathbb{E}[T^{2}] - \\left(\\mathbb{E}[T]\\right)^{2} = \\frac{2}{\\lambda^{2}} - \\frac{1}{\\lambda^{2}} = \\frac{1}{\\lambda^{2}} = \\frac{1}{J^{2} V^{2}}.\n$$\nIn summary, the mean waiting time is $\\mathbb{E}[T] = \\frac{1}{J V}$ (in seconds) and the variance is $\\mathrm{Var}(T) = \\frac{1}{J^{2} V^{2}}$ (in seconds squared), expressed exactly in terms of $J$ and $V$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{J V}  \\frac{1}{J^{2} V^{2}}\\end{pmatrix}}$$", "id": "3437202"}, {"introduction": "Calculating nucleation rates in molecular simulations is a formidable challenge due to the immense timescale separation between atomic vibrations and the rare nucleation event itself. This hands-on problem introduces Forward-Flux Sampling (FFS), a powerful computational method designed to overcome this \"rare event\" problem by breaking the process into a series of more probable steps. Beyond simply implementing the FFS algorithm, this exercise emphasizes the critical importance of rigorous uncertainty quantification, guiding you to construct statistically valid confidence intervals for the nucleation rate $J$ from the underlying Poisson and binomial statistics of the simulation data [@problem_id:3437239].", "problem": "You are asked to design and implement a complete computational procedure to estimate a nucleation rate using Forward-Flux Sampling (FFS) and to construct statistically justified confidence intervals. The setting is Classical Nucleation Theory (CNT), where the nucleation rate is defined as the expected number of successful nucleation events per unit time per unit volume.\n\nStart from the following base:\n- The nucleation rate $J$ in CNT is the expected number of successful transitions from the metastable basin to the stable phase per unit time per unit volume.\n- In FFS, an order parameter $\\lambda$ defines nested interfaces $\\lambda_0  \\lambda_1  \\cdots  \\lambda_K$ between the metastable basin and the stable phase. The metastable basin corresponds to $\\lambda  \\lambda_0$, and successful nucleation corresponds to reaching $\\lambda_K$ without returning to the basin.\n- Crossings from the basin to the first interface can be modeled as a Poisson process in time when events are rare and memoryless.\n- Conditional advancement from interface $\\lambda_i$ to $\\lambda_{i+1}$, given a crossing of $\\lambda_i$, can be modeled as independent Bernoulli trials, producing binomial data for the crossing probabilities.\n- The total exposure for the Poisson process is the product of observation time and sampling volume.\n\nYour task is to:\n1. Derive, from these base principles, a logically valid expression for $J$ in terms of a measurable flux across $\\lambda_0$ and a sequence of conditional crossing probabilities between successive interfaces. Justify each inference from the stated base without using any shortcut formulas or pre-supplied target expressions.\n2. Develop a method to construct a two-sided confidence interval for $J$ at overall coverage level $1 - \\alpha$, with $\\alpha = 0.05$, by combining uncertainty from the flux measurement and the crossing probabilities. Your interval construction must:\n   - Use an exact two-sided confidence interval for the Poisson rate of crossings across $\\lambda_0$, based on the observed count and total exposure.\n   - Use an exact two-sided confidence interval for each binomial proportion of conditional crossings between successive interfaces.\n   - Combine the component intervals into an overall interval for $J$ using a principled multiple-comparisons allocation of $\\alpha$ that ensures the overall coverage is at least $1 - \\alpha$ without assuming any special-case simplifications.\n3. Implement a program that, for each test case provided below, computes:\n   - A point estimate $\\hat{J}$ based on the observed flux and crossing proportions.\n   - A two-sided confidence interval $[J_{\\mathrm{low}}, J_{\\mathrm{up}}]$ at overall coverage level $0.95$, in the unit \"events per nanosecond per cubic nanometer\" (written as \"per ns per nm$^3$\").\n   The program must not require any input and must print the aggregated results for all test cases in a single line as a comma-separated list enclosed in square brackets, where each test case is represented as a list of three floats $[\\hat{J}, J_{\\mathrm{low}}, J_{\\mathrm{up}}]$.\n\nSpecifications for statistical construction and units:\n- The flux measurement is given by an observed crossing count $C_0$ across $\\lambda_0$ in observation time $T$ within sampling volume $V$. The flux per unit time per unit volume is defined as $C_0$ divided by the total exposure $T \\times V$. Express $J$ in \"per ns per nm$^3$\".\n- Use a two-sided exact interval for the Poisson rate of $C_0$ events per exposure $T \\times V$.\n- For each interface $i$, use a two-sided exact interval for the binomial proportion $p_i$ based on $S_i$ successes out of $N_i$ trials.\n- Use a principled multiple-comparisons approach to allocate $\\alpha$ across the flux and all crossing-probability components so that the combined interval for $J$ has overall coverage at least $0.95$.\n- Your program must compute and output the point estimates and intervals as raw floating-point numbers. Do not include units in the output; the unit is specified in this problem statement.\n\nTest suite of parameter values:\n- Case A (general case): $V = 1000$ nm$^3$, $T = 500$ ns, $C_0 = 120$, $K = 3$, $(N_1,N_2,N_3) = (200,150,100)$, $(S_1,S_2,S_3) = (60,45,20)$.\n- Case B (edge case with zero successes on last interface): $V = 10000$ nm$^3$, $T = 1000$ ns, $C_0 = 300$, $K = 3$, $(N_1,N_2,N_3) = (100,50,20)$, $(S_1,S_2,S_3) = (40,10,0)$.\n- Case C (near-deterministic crossings with small flux): $V = 500$ nm$^3$, $T = 100$ ns, $C_0 = 3$, $K = 2$, $(N_1,N_2) = (10,10)$, $(S_1,S_2) = (10,10)$.\n- Case D (zero flux count): $V = 2000$ nm$^3$, $T = 200$ ns, $C_0 = 0$, $K = 3$, $(N_1,N_2,N_3) = (50,50,50)$, $(S_1,S_2,S_3) = (25,10,5)$.\n- Case E (large counts and diverse probabilities): $V = 750$ nm$^3$, $T = 1000$ ns, $C_0 = 5000$, $K = 4$, $(N_1,N_2,N_3,N_4) = (1000,1000,1000,1000)$, $(S_1,S_2,S_3,S_4) = (900,500,100,20)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case, each entry being a list of three floats representing $[\\hat{J}, J_{\\mathrm{low}}, J_{\\mathrm{up}}]$ for that case. For example: \"[[0.00123,0.00085,0.00180],[...],...]\".", "solution": "The problem of estimating the nucleation rate $J$ and its confidence interval from Forward-Flux Sampling (FFS) data is addressed by first deriving the expression for $J$ from fundamental principles and then constructing a statistically rigorous confidence interval by combining uncertainties from all stochastic steps of the FFS process.\n\n### Step 1: Derivation of the Nucleation Rate Expression\n\nThe nucleation rate $J$ is defined as the expected number of successful nucleation events per unit time per unit volume. In the context of FFS, a successful event is a trajectory that originates in the metastable basin ($\\lambda  \\lambda_0$), crosses the first interface $\\lambda_0$, and subsequently reaches the final interface $\\lambda_K$ without returning to the basin.\n\nLet $\\Phi_0$ be the flux across the first interface $\\lambda_0$, defined as the rate of crossings per unit time and per unit volume. Let $P(\\lambda_K | \\lambda_0)$ be the conditional probability that a trajectory, having just crossed $\\lambda_0$, successfully reaches $\\lambda_K$. The overall rate of successful events, $J$, is the product of the initial flux and the probability of success:\n$$J = \\Phi_0 \\times P(\\lambda_K | \\lambda_0)$$\n\nThe FFS methodology relies on a sequence of interfaces $\\lambda_0  \\lambda_1  \\cdots  \\lambda_K$. The probability $P(\\lambda_K | \\lambda_0)$ can be decomposed using the chain rule of probability. A trajectory reaches $\\lambda_K$ from $\\lambda_0$ by successively crossing each intermediate interface. Let $E_i$ be the event of reaching interface $\\lambda_i$. The probability of success is $P(E_K | E_0)$.\n$$P(E_K | E_0) = P(E_1 | E_0) \\times P(E_2 | E_1, E_0) \\times \\cdots \\times P(E_K | E_{K-1}, \\dots, E_0)$$\n\nThe problem states that conditional advancements between interfaces are modeled as independent Bernoulli trials. This implies a memoryless or Markovian property, where the probability of advancing from $\\lambda_i$ to $\\lambda_{i+1}$ depends only on the system's state at $\\lambda_i$, not its prior history. Therefore, $P(E_{i+1} | E_i, \\dots, E_0) = P(E_{i+1} | E_i)$. Let us define the conditional crossing probability from interface $\\lambda_{i-1}$ to $\\lambda_i$ as $p_i = P(E_i | E_{i-1})$ for $i=1, \\dots, K$. The chain rule simplifies to a product of these independent probabilities:\n$$P(\\lambda_K | \\lambda_0) = P(E_1 | E_0) \\times P(E_2 | E_1) \\times \\cdots \\times P(E_K | E_{K-1}) = \\prod_{i=1}^{K} p_i$$\n\nSubstituting this into the expression for $J$, we arrive at the full expression for the nucleation rate in terms of measurable FFS quantities:\n$$J = \\Phi_0 \\prod_{i=1}^{K} p_i$$\n\n### Step 2: Point Estimate\n\nThe point estimate for $J$, denoted $\\hat{J}$, is constructed from the point estimates of its constituent parameters.\n1.  The flux $\\Phi_0$ is estimated from the observation of $C_0$ crossings of $\\lambda_0$ during a total time $T$ in a volume $V$. The total exposure is $E = T \\times V$. The estimator for the flux is:\n    $$\\hat{\\Phi}_0 = \\frac{C_0}{T \\times V}$$\n2.  Each conditional probability $p_i$ is estimated from $S_i$ successful advancements to $\\lambda_i$ out of $N_i$ trials initiated from $\\lambda_{i-1}$. The estimator for this binomial proportion is:\n    $$\\hat{p}_i = \\frac{S_i}{N_i}$$\n\nCombining these, the point estimate for the nucleation rate is:\n$$\\hat{J} = \\frac{C_0}{T \\times V} \\prod_{i=1}^{K} \\frac{S_i}{N_i}$$\n\n### Step 3: Confidence Interval Construction\n\nA two-sided confidence interval for $J$ at an overall coverage level of $1 - \\alpha$ is required. The rate $J$ is a product of $K+1$ independently estimated parameters: the flux $\\Phi_0$ and the $K$ probabilities $p_1, \\dots, p_K$. To ensure the overall coverage, we use the Bonferroni correction, a principled method for multiple comparisons.\n\nThe total significance level $\\alpha$ is distributed among the $m = K+1$ parameters. Each parameter's confidence interval will be constructed at a stricter confidence level of $1 - \\alpha'$, where $\\alpha' = \\alpha / m$. Let $[L_0, U_0]$ be the $(1 - \\alpha')$ confidence interval for $\\Phi_0$, and $[L_i, U_i]$ be the $(1 - \\alpha')$ confidence interval for each $p_i$. Since $J$ is a product of non-negative quantities, the combined confidence interval $[J_{\\mathrm{low}}, J_{\\mathrm{up}}]$ is constructed by multiplying the corresponding lower and upper bounds of the individual intervals:\n$$J_{\\mathrm{low}} = L_0 \\prod_{i=1}^{K} L_i$$\n$$J_{\\mathrm{up}} = U_0 \\prod_{i=1}^{K} U_i$$\n\nThis construction guarantees that the overall confidence level is at least $1 - \\alpha$.\n\n#### 3.1. Exact Confidence Interval for the Poisson Rate $\\Phi_0$\n\nThe number of initial crossings $C_0$ in a total exposure $E = T \\times V$ follows a Poisson distribution with mean $\\mu = \\Phi_0 \\times E$. We first find an exact $(1 - \\alpha')$ confidence interval for $\\mu$ given the observation $C_0$. This interval, known as the Garwood interval, is based on the relationship between the Poisson and chi-squared ($\\chi^2$) distributions.\nThe lower and upper bounds for $\\mu$ are:\n$$\\mu_{\\mathrm{low}} = \\frac{1}{2} \\chi^2_{2C_0}\\left(\\frac{\\alpha'}{2}\\right)$$\n$$\\mu_{\\mathrm{up}} = \\frac{1}{2} \\chi^2_{2(C_0+1)}\\left(1 - \\frac{\\alpha'}{2}\\right)$$\nwhere $\\chi^2_{\\nu}(q)$ is the $q$-quantile of the chi-squared distribution with $\\nu$ degrees of freedom. For the special case $C_0=0$, $\\mu_{\\mathrm{low}} = 0$.\nThe confidence interval for the rate $\\Phi_0$ is then obtained by dividing by the exposure $E$:\n$$[L_0, U_0] = \\left[\\frac{\\mu_{\\mathrm{low}}}{E}, \\frac{\\mu_{\\mathrm{up}}}{E}\\right]$$\n\n#### 3.2. Exact Confidence Interval for Binomial Proportions $p_i$\n\nFor each conditional probability $p_i$, we have $S_i$ successes in $N_i$ trials. An exact $(1 - \\alpha')$ confidence interval for the binomial proportion $p_i$ is given by the Clopper-Pearson interval. This interval is derived by inverting two one-sided binomial tests and can be expressed using quantiles of the Beta distribution.\nThe lower and upper bounds for $p_i$ are:\n$$L_i = \\mathrm{Beta}\\left(\\frac{\\alpha'}{2}; S_i, N_i - S_i + 1\\right)$$\n$$U_i = \\mathrm{Beta}\\left(1 - \\frac{\\alpha'}{2}; S_i + 1, N_i - S_i\\right)$$\nwhere $\\mathrm{Beta}(q; a, b)$ is the $q$-quantile of the Beta distribution with shape parameters $a$ and $b$.\nSpecial cases are handled as follows:\n- If $S_i = 0$, the lower bound $L_i = 0$.\n- If $S_i = N_i$, the upper bound $U_i = 1$.\n\nBy computing these individual intervals and combining their bounds as described, we obtain a statistically sound estimate for the range of plausible values for the nucleation rate $J$. The specified overall coverage of $0.95$ corresponds to $\\alpha = 0.05$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2, beta\n\ndef solve():\n    \"\"\"\n    Main function to compute nucleation rates and confidence intervals for all test cases.\n    \"\"\"\n    # Test suite of parameter values\n    # Each case: (V, T, C0, K, N_tuple, S_tuple)\n    # V: volume (nm^3)\n    # T: time (ns)\n    # C0: initial flux count\n    # K: number of subsequent interfaces\n    # N_tuple: tuple of trial counts (N1, N2, ...)\n    # S_tuple: tuple of success counts (S1, S2, ...)\n    test_cases = [\n        # Case A: general case\n        (1000, 500, 120, 3, (200, 150, 100), (60, 45, 20)),\n        # Case B: edge case with zero successes on last interface\n        (10000, 1000, 300, 3, (100, 50, 20), (40, 10, 0)),\n        # Case C: near-deterministic crossings with small flux\n        (500, 100, 3, 2, (10, 10), (10, 10)),\n        # Case D: zero flux count\n        (2000, 200, 0, 3, (50, 50, 50), (25, 10, 5)),\n        # Case E: large counts and diverse probabilities\n        (750, 1000, 5000, 4, (1000, 1000, 1000, 1000), (900, 500, 100, 20)),\n    ]\n\n    results = []\n    for case in test_cases:\n        V, T, C0, K, N_arr, S_arr = case\n        result_tuple = calculate_j_and_ci(V, T, C0, K, N_arr, S_arr)\n        results.append(list(result_tuple))\n\n    # Print the aggregated results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_j_and_ci(V, T, C0, K, N_arr, S_arr, alpha=0.05):\n    \"\"\"\n    Calculates the point estimate and confidence interval for the nucleation rate J.\n\n    Args:\n        V (float): Sampling volume in nm^3.\n        T (float): Observation time in ns.\n        C0 (int): Observed crossing count for the first interface.\n        K (int): Number of subsequent interfaces (len(N_arr)).\n        N_arr (tuple): Tuple of trial counts for each interface.\n        S_arr (tuple): Tuple of success counts for each interface.\n        alpha (float): Overall significance level for the confidence interval.\n\n    Returns:\n        tuple: (J_hat, J_low, J_up) for the nucleation rate.\n    \"\"\"\n    # Total exposure\n    exposure = V * T\n\n    # --- Point Estimate ---\n    if exposure == 0:\n        phi0_hat = 0.0\n    else:\n        phi0_hat = C0 / exposure\n    \n    p_hat_prod = 1.0\n    for S, N in zip(S_arr, N_arr):\n        if N == 0:\n             # This case should not happen with valid inputs but good practice to handle.\n            p_hat_prod = 0.0\n            break\n        p_hat_prod *= S / N\n    \n    J_hat = phi0_hat * p_hat_prod\n\n    # --- Confidence Interval ---\n    # Bonferroni correction for multiple comparisons\n    # There are K+1 parameters: one for the flux, K for the probabilities\n    m = K + 1\n    alpha_prime = alpha / m\n\n    # 1. Confidence interval for the flux rate phi0\n    if exposure == 0:\n        phi0_L, phi0_U = 0.0, float('inf')\n    else:\n        # Exact interval for Poisson mean mu = phi0 * exposure\n        if C0 == 0:\n            mu_L = 0.0\n        else:\n            mu_L = 0.5 * chi2.ppf(alpha_prime / 2, 2 * C0)\n        \n        mu_U = 0.5 * chi2.ppf(1 - alpha_prime / 2, 2 * (C0 + 1))\n        \n        phi0_L = mu_L / exposure\n        phi0_U = mu_U / exposure\n\n    # 2. Confidence intervals for the product of probabilities\n    p_prod_L = 1.0\n    p_prod_U = 1.0\n\n    for S, N in zip(S_arr, N_arr):\n        # Exact Clopper-Pearson interval for binomial proportion p\n        if S == 0:\n            p_L = 0.0\n        else:\n            p_L = beta.ppf(alpha_prime / 2, S, N - S + 1)\n        \n        if S == N:\n            p_U = 1.0\n        else:\n            p_U = beta.ppf(1 - alpha_prime / 2, S + 1, N - S)\n        \n        p_prod_L *= p_L\n        p_prod_U *= p_U\n        \n    # 3. Combine intervals for the final J interval\n    J_low = phi0_L * p_prod_L\n    J_up = phi0_U * p_prod_U\n\n    return J_hat, J_low, J_up\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3437239"}]}