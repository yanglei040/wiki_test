{"hands_on_practices": [{"introduction": "This first exercise reinforces the foundational principles of continuum mechanics that underpin the Finite Element Method. By starting with a simple, linear displacement field, you will trace the direct path from kinematics (calculating the strain tensor $\\boldsymbol{\\epsilon}$) to kinetics (determining the Cauchy stress tensor $\\boldsymbol{\\sigma}$) and finally verify mechanical equilibrium by checking the condition $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$. This practice is crucial for building intuition about how assumed displacement functions within an element relate to the physical state of stress and internal force balance [@problem_id:3452261].", "problem": "Consider a two-dimensional small-strain solid mechanics setting as used in the Finite Element Method (FEM) for computational materials science. Let the displacement field be $u(x,y) = \\begin{bmatrix} a x + b y \\\\ c x + d y \\end{bmatrix}$ where $a$, $b$, $c$, and $d$ are real constants. Assume an isotropic, homogeneous, linear elastic material under plane strain with Lamé parameters $\\lambda$ and $\\mu$, and no body forces (i.e., the body force vector $\\mathbf{f} = \\mathbf{0}$). \n\nStarting from the kinematics of small strain and the balance of linear momentum, derive the strain tensor $\\epsilon$ and the Cauchy stress tensor $\\sigma$ in terms of $a$, $b$, $c$, $d$, $\\lambda$, and $\\mu$. Then, compute the divergence of the stress field $\\nabla \\cdot \\sigma$ and, specializing to the case $b = 0$ (i.e., the coefficient multiplying $y$ in $u_{x}$ is zero), determine for which values of $a$, $c$, and $d$ the stress field is divergence-free.\n\nYour final answer must be a single row matrix whose entries are, in order, the three independent strain components $\\epsilon_{xx}$, $\\epsilon_{yy}$, $\\epsilon_{xy}$ (in terms of $a$, $b$, $c$, $d$), followed by the two components of the divergence of the stress field $\\left(\\nabla \\cdot \\sigma\\right)_{x}$ and $\\left(\\nabla \\cdot \\sigma\\right)_{y}$ evaluated under $b = 0$. No rounding is required, and no units should be included in the final answer.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   Displacement field: $\\mathbf{u}(x,y) = \\begin{bmatrix} u_x \\\\ u_y \\end{bmatrix} = \\begin{bmatrix} a x + b y \\\\ c x + d y \\end{bmatrix}$\n-   Constants: $a$, $b$, $c$, and $d$ are real constants.\n-   Material model: Isotropic, homogeneous, linear elastic.\n-   Material parameters: Lamé parameters $\\lambda$ and $\\mu$.\n-   Mechanical conditions: Two-dimensional ($2$D), small strain, plane strain.\n-   Body forces: $\\mathbf{f} = \\mathbf{0}$.\n-   Tasks:\n    1.  Derive the strain tensor $\\epsilon$.\n    2.  Derive the Cauchy stress tensor $\\sigma$.\n    3.  Compute the divergence of the stress field, $\\nabla \\cdot \\sigma$.\n    4.  For the special case $b=0$, determine the conditions on $a$, $c$, and $d$ for which $\\nabla \\cdot \\sigma = \\mathbf{0}$.\n    5.  Provide a final answer as a row matrix containing $\\epsilon_{xx}$, $\\epsilon_{yy}$, $\\epsilon_{xy}$, and the two components of $\\nabla \\cdot \\sigma$ evaluated at $b=0$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is firmly rooted in the fundamental principles of continuum mechanics. It employs the standard definitions of the small strain tensor, the constitutive law for a linear elastic isotropic material (Hooke's law), and the equation for mechanical equilibrium (balance of linear momentum). The specified linear displacement field is a valid and common case, representing a state of homogeneous deformation. The problem is scientifically correct.\n-   **Well-Posedness**: The problem is well-posed. It provides all necessary information (displacement field, material properties, and conditions) to uniquely determine the required quantities. The tasks are specified clearly and lead to a unique mathematical result.\n-   **Objectivity**: The problem is stated in precise, formal mathematical and physical language, free from any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe solution proceeds by first computing the strain tensor from the given displacement field, then the stress tensor using the constitutive law, and finally the divergence of the stress tensor.\n\n**1. Strain Tensor Calculation**\nThe small strain tensor, $\\epsilon$, is the symmetric part of the displacement gradient, $\\nabla \\mathbf{u}$. Its components are given by $\\epsilon_{ij} = \\frac{1}{2}(\\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i})$.\nThe given displacement field is $\\mathbf{u} = \\begin{bmatrix} u_x \\\\ u_y \\end{bmatrix} = \\begin{bmatrix} a x + b y \\\\ c x + d y \\end{bmatrix}$.\n\nFirst, we compute the displacement gradient tensor $\\nabla \\mathbf{u}$:\n$$\n\\nabla \\mathbf{u} = \\begin{bmatrix} \\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y} \\\\ \\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y} \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial}{\\partial x}(a x + b y)  \\frac{\\partial}{\\partial y}(a x + b y) \\\\ \\frac{\\partial}{\\partial x}(c x + d y)  \\frac{\\partial}{\\partial y}(c x + d y) \\end{bmatrix} = \\begin{bmatrix} a  b \\\\ c  d \\end{bmatrix}\n$$\nThe components of the strain tensor $\\epsilon$ are:\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = a\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = d\n$$\n$$\n\\epsilon_{xy} = \\epsilon_{yx} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}(b + c)\n$$\nUnder the plane strain condition, the out-of-plane strain components are zero: $\\epsilon_{zz} = \\epsilon_{xz} = \\epsilon_{yz} = 0$.\nThe strain tensor in the $x-y$ plane is:\n$$\n\\epsilon = \\begin{bmatrix} a  \\frac{1}{2}(b+c) \\\\ \\frac{1}{2}(b+c)  d \\end{bmatrix}\n$$\n\n**2. Stress Tensor Calculation**\nFor a homogeneous, isotropic, linear elastic material, the Cauchy stress tensor $\\sigma$ is related to the strain tensor $\\epsilon$ by the constitutive equation:\n$$\n\\sigma = \\lambda (\\text{tr}(\\epsilon)) \\mathbf{I} + 2\\mu\\epsilon\n$$\nwhere $\\mathbf{I}$ is the identity tensor, and $\\lambda$ and $\\mu$ are the Lamé parameters.\nFor plane strain, the trace of the strain tensor is $\\text{tr}(\\epsilon) = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz} = a + d + 0 = a+d$.\n\nThe components of the stress tensor are:\n$$\n\\sigma_{xx} = \\lambda (\\text{tr}(\\epsilon)) + 2\\mu \\epsilon_{xx} = \\lambda(a+d) + 2\\mu a\n$$\n$$\n\\sigma_{yy} = \\lambda (\\text{tr}(\\epsilon)) + 2\\mu \\epsilon_{yy} = \\lambda(a+d) + 2\\mu d\n$$\n$$\n\\sigma_{xy} = \\sigma_{yx} = 2\\mu \\epsilon_{xy} = 2\\mu \\left(\\frac{1}{2}(b+c)\\right) = \\mu(b+c)\n$$\nIt is noteworthy that the out-of-plane normal stress $\\sigma_{zz}$ is generally non-zero: $\\sigma_{zz} = \\lambda(\\text{tr}(\\epsilon)) + 2\\mu\\epsilon_{zz} = \\lambda(a+d)$.\n\nSince $a, b, c, d, \\lambda,$ and $\\mu$ are all constants, all components of the stress tensor $\\sigma$ are spatially constant.\n\n**3. Divergence of the Stress Field**\nThe balance of linear momentum in a static case with no body forces ($\\mathbf{f}=\\mathbf{0}$) requires that the stress field be divergence-free: $\\nabla \\cdot \\sigma = \\mathbf{0}$. We will compute the divergence explicitly to verify this.\n\nThe divergence of the stress tensor $\\sigma$ is a vector field whose components in Cartesian coordinates are:\n$$\n(\\nabla \\cdot \\sigma)_x = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y}\n$$\n$$\n(\\nabla \\cdot \\sigma)_y = \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y}\n$$\nSubstituting the expressions for the stress components:\n$$\n(\\nabla \\cdot \\sigma)_x = \\frac{\\partial}{\\partial x}(\\lambda(a+d) + 2\\mu a) + \\frac{\\partial}{\\partial y}(\\mu(b+c))\n$$\n$$\n(\\nabla \\cdot \\sigma)_y = \\frac{\\partial}{\\partial x}(\\mu(b+c)) + \\frac{\\partial}{\\partial y}(\\lambda(a+d) + 2\\mu d)\n$$\nSince all stress components are constant with respect to the spatial coordinates $x$ and $y$, their partial derivatives are zero.\n$$\n\\frac{\\partial}{\\partial x}(\\text{constant}) = 0, \\quad \\frac{\\partial}{\\partial y}(\\text{constant}) = 0\n$$\nTherefore,\n$$\n(\\nabla \\cdot \\sigma)_x = 0 + 0 = 0\n$$\n$$\n(\\nabla \\cdot \\sigma)_y = 0 + 0 = 0\n$$\nThis shows that $\\nabla \\cdot \\sigma = \\mathbf{0}$ for any values of the constants $a, b, c,$ and $d$.\n\n**4. Condition for Divergence-Free Stress**\nThe problem asks for the values of $a, c,$ and $d$ for which the stress field is divergence-free, under the specialization $b=0$. As demonstrated above, the divergence of the stress field is identically zero for *all* real values of $a, b, c,$ and $d$. Consequently, specializing to $b=0$ does not alter this result. The stress field is divergence-free for any choice of $a, c,$ and $d \\in \\mathbb{R}$.\n\n**5. Assembling the Final Answer**\nThe final answer requires a row matrix with five entries:\n1.  $\\epsilon_{xx} = a$\n2.  $\\epsilon_{yy} = d$\n3.  $\\epsilon_{xy} = \\frac{1}{2}(b+c)$\n4.  $(\\nabla \\cdot \\sigma)_{x}$ evaluated at $b=0$: As shown, this is $0$.\n5.  $(\\nabla \\cdot \\sigma)_{y}$ evaluated at $b=0$: As shown, this is $0$.\n\nThe resulting row matrix is composed of these five expressions.", "answer": "$$\n\\boxed{\\begin{pmatrix} a  d  \\frac{1}{2}(b+c)  0  0 \\end{pmatrix}}\n$$", "id": "3452261"}, {"introduction": "The power of FEM lies in its ability to model complex geometries using a mesh of simple \"parent\" elements. This hands-on coding practice delves into the heart of this process: the isoparametric mapping and its Jacobian matrix $\\mathbf{J}$. You will implement the calculation for the Jacobian determinant, $\\det \\mathbf{J}$, which is a critical measure that determines if an element is geometrically valid or unacceptably distorted, ensuring the physical sense of your simulation [@problem_id:3452244].", "problem": "Consider a four-node bilinear isoparametric quadrilateral finite element used in planar solid mechanics. Let the parent (natural) coordinates be denoted by $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and let the physical coordinates of the nodes be $(x_i,y_i)$ for nodes $i=1,2,3,4$ ordered consecutively around the boundary. The isoparametric mapping uses the same bilinear shape functions for geometry and displacement, and its Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$ maps differential lengths from the parent space to the physical space. The determinant $\\det \\mathbf{J}(\\xi,\\eta)$ has physical units of area and must remain strictly positive over the entire element for the mapping to be one-to-one (no inversion). This requirement is closely tied to geometric distortion and element convexity.\n\nYour task is to write a complete, runnable program that, for each given element, evaluates $\\det \\mathbf{J}$ at the standard $2\\times 2$ Gaussian quadrature points $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$ and applies a geometric distortion criterion that guarantees $\\det \\mathbf{J}(\\xi,\\eta)0$ throughout the element. Specifically, compute:\n- The list of four values of $\\det \\mathbf{J}$ at the $2\\times 2$ points in the order $[(\\xi,\\eta)=(-1/\\sqrt{3},-1/\\sqrt{3}),(\\xi,\\eta)=(+1/\\sqrt{3},-1/\\sqrt{3}),(\\xi,\\eta)=(+1/\\sqrt{3},+1/\\sqrt{3}),(\\xi,\\eta)=(-1/\\sqrt{3},+1/\\sqrt{3})]$.\n- A boolean indicating whether all four Gaussian-point values of $\\det \\mathbf{J}$ are strictly positive.\n- A boolean indicating whether the sufficient geometric distortion criterion for positivity of $\\det \\mathbf{J}$ everywhere is satisfied. For bilinear isoparametric quadrilaterals, use the theoretical property that $\\det \\mathbf{J}(\\xi,\\eta)$ is bilinear in $(\\xi,\\eta)$, and the minimum over the square $[-1,1]\\times[-1,1]$ occurs at one of the four corners. Therefore, evaluate $\\det \\mathbf{J}$ at the four corners $(\\xi,\\eta)\\in\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$ and declare the criterion satisfied if and only if the minimum of the four corner values is strictly positive.\n- The minimum of the four corner values of $\\det \\mathbf{J}$.\n\nAll physical coordinates are given in meters, and you must express $\\det \\mathbf{J}$ in square meters ($\\mathrm{m}^2$). Round each reported $\\det \\mathbf{J}$ value to $6$ decimal places. The boolean outputs must be strict: use $$ rather than $\\geq$ when checking positivity.\n\nUse the following test suite of elements, each defined by its node coordinates $(x_i,y_i)$ in meters, listed in node order $i=1,2,3,4$:\n1. Element A (convex, skewed): $[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(2.0,0.3),(x_3,y_3)=(1.8,1.6),(x_4,y_4)=(0.2,1.7)]$.\n2. Element B (parallelogram, moderate skew): $[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(1.2,0.3),(x_3,y_3)=(2.2,1.3),(x_4,y_4)=(1.0,1.0)]$.\n3. Element C (sliver, near-singular height): $[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(1.0,0.0),(x_3,y_3)=(1.001,0.001),(x_4,y_4)=(0.001,0.001)]$.\n4. Element D (twisted, bow-tie ordering): $[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(1.0,1.0),(x_3,y_3)=(0.0,1.0),(x_4,y_4)=(1.0,0.0)]$.\n\nYour program must produce a single line of output containing the results aggregated for all four test cases as a comma-separated list enclosed in square brackets. For each element, report a list of the form $[\\,[d_1,d_2,d_3,d_4],\\,b_{\\mathrm{GP}},\\,b_{\\mathrm{corner}},\\,d_{\\min,\\mathrm{corner}}\\,]$, where $d_1,\\dots,d_4$ are the four Gaussian-point values of $\\det \\mathbf{J}$ rounded to $6$ decimals in $\\mathrm{m}^2$, $b_{\\mathrm{GP}}$ is the boolean for Gaussian-point positivity, $b_{\\mathrm{corner}}$ is the boolean for the sufficient geometric distortion criterion based on corner positivity, and $d_{\\min,\\mathrm{corner}}$ is the minimum corner value rounded to $6$ decimals in $\\mathrm{m}^2$. The output format for all four elements together must be:\n$[\\,[\\,[d_1,d_2,d_3,d_4],b_{\\mathrm{GP}},b_{\\mathrm{corner}},d_{\\min,\\mathrm{corner}}],\\dots\\,]$.", "solution": "We begin from the isoparametric concept for a four-node bilinear quadrilateral. The mapping from parent coordinates $(\\xi,\\eta)$ to physical coordinates $(x,y)$ is defined as\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i,\n$$\nwhere the bilinear shape functions $N_i(\\xi,\\eta)$ are\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\nThe Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$ is the gradient of $(x,y)$ with respect to $(\\xi,\\eta)$:\n$$\n\\mathbf{J}(\\xi,\\eta)=\n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\\n\\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nx_{,\\xi}  y_{,\\xi} \\\\\nx_{,\\eta}  y_{,\\eta}\n\\end{bmatrix}.\n$$\nSince $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$ are linear combinations of the shape functions, and the shape functions are bilinear, their derivatives are linear in either $\\xi$ or $\\eta$:\n$$\nx_{,\\xi}(\\xi,\\eta)=\\sum_{i=1}^4 x_i\\,\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta),\\qquad\ny_{,\\xi}(\\xi,\\eta)=\\sum_{i=1}^4 y_i\\,\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta),\n$$\n$$\nx_{,\\eta}(\\xi,\\eta)=\\sum_{i=1}^4 x_i\\,\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta),\\qquad\ny_{,\\eta}(\\xi,\\eta)=\\sum_{i=1}^4 y_i\\,\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta).\n$$\nFor the bilinear shape functions above, the derivatives are\n$$\n\\frac{\\partial N_1}{\\partial \\xi}=-\\tfrac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_2}{\\partial \\xi}=+\\tfrac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_3}{\\partial \\xi}=+\\tfrac{1}{4}(1+\\eta),\\quad\n\\frac{\\partial N_4}{\\partial \\xi}=-\\tfrac{1}{4}(1+\\eta),\n$$\n$$\n\\frac{\\partial N_1}{\\partial \\eta}=-\\tfrac{1}{4}(1-\\xi),\\quad\n\\frac{\\partial N_2}{\\partial \\eta}=-\\tfrac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_3}{\\partial \\eta}=+\\tfrac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_4}{\\partial \\eta}=+\\tfrac{1}{4}(1-\\xi).\n$$\nThe determinant of the Jacobian is\n$$\n\\det \\mathbf{J}(\\xi,\\eta)=x_{,\\xi}(\\xi,\\eta)\\,y_{,\\eta}(\\xi,\\eta)-y_{,\\xi}(\\xi,\\eta)\\,x_{,\\eta}(\\xi,\\eta),\n$$\nwhich has units of area, specifically $\\mathrm{m}^2$ when $(x_i,y_i)$ are specified in meters. Because the shape function derivatives are linear in $\\xi$ and in $\\eta$, $\\det \\mathbf{J}(\\xi,\\eta)$ is a bilinear function of $(\\xi,\\eta)$, i.e.,\n$$\n\\det \\mathbf{J}(\\xi,\\eta)=a+b\\,\\xi+c\\,\\eta+d\\,\\xi\\,\\eta,\n$$\nwhere $a,b,c,d$ are constants determined by the nodal coordinates.\n\nWe now establish the geometric distortion criterion ensuring positivity of $\\det \\mathbf{J}$ throughout the element. A bilinear function on a rectangle attains its minimum and maximum at the corners of the rectangle. Specifically, for $f(\\xi,\\eta)=a+b\\,\\xi+c\\,\\eta+d\\,\\xi\\,\\eta$ on $[-1,1]\\times[-1,1]$, the extrema occur at $(\\xi,\\eta)\\in\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$. Therefore,\n$$\n\\min_{(\\xi,\\eta)\\in[-1,1]^2}\\det \\mathbf{J}(\\xi,\\eta)=\\min\\{\\det \\mathbf{J}(-1,-1),\\det \\mathbf{J}(+1,-1),\\det \\mathbf{J}(+1,+1),\\det \\mathbf{J}(-1,+1)\\}.\n$$\nA sufficient and necessary criterion for no inversion (one-to-one mapping over the parent square) is thus that the minimum of these four corner values be strictly positive. This condition is closely related to convexity and the absence of twisting; a twisted (bow-tie) element will violate the positivity at some corner or within the domain, and a near-singular sliver will yield corner values arbitrarily close to zero.\n\nAlgorithmic steps for each element:\n1. Read the nodal coordinates $(x_i,y_i)$ for $i=1,2,3,4$ in meters.\n2. For each Gaussian point $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$, compute $\\frac{\\partial N_i}{\\partial \\xi}$ and $\\frac{\\partial N_i}{\\partial \\eta}$, then evaluate $x_{,\\xi}$, $y_{,\\xi}$, $x_{,\\eta}$, $y_{,\\eta}$ and form $\\det \\mathbf{J}(\\xi,\\eta)=x_{,\\xi}y_{,\\eta}-y_{,\\xi}x_{,\\eta}$.\n3. Round each Gaussian-point $\\det \\mathbf{J}$ to $6$ decimal places and record the four values in the specified order. Check whether all four rounded values are strictly greater than $0$ and record the boolean $b_{\\mathrm{GP}}$.\n4. Evaluate $\\det \\mathbf{J}$ at the four corners $(\\xi,\\eta)\\in\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$ using the same procedure. Compute the minimum of these four corner values, round it to $6$ decimal places, and record the boolean $b_{\\mathrm{corner}}$ indicating whether this minimum is strictly greater than $0$.\n5. Aggregate the results for all elements into the final single-line output in the format $[\\,[\\,[d_1,d_2,d_3,d_4],b_{\\mathrm{GP}},b_{\\mathrm{corner}},d_{\\min,\\mathrm{corner}}],\\dots\\,]$.\n\nThe provided test suite covers:\n- A convex skewed element (Element A) expected to have strictly positive $\\det \\mathbf{J}$ at Gaussian points and corners.\n- A parallelogram (Element B) with moderate skew, also expected to be valid.\n- A near-singular sliver (Element C) that retains positivity but with very small $\\det \\mathbf{J}$ values, highlighting numerical sensitivity.\n- A twisted element (Element D) that fails the corner positivity criterion and likely exhibits negative $\\det \\mathbf{J}$ at some Gaussian points, demonstrating an inversion.\n\nThe program implements these steps and prints the required single-line output with $\\det \\mathbf{J}$ in $\\mathrm{m}^2$, rounded to $6$ decimals, along with the boolean indicators.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef dN_dxi_eta_bilinear(xi, eta):\n    \"\"\"\n    Compute derivatives of bilinear shape functions for a 4-node quadrilateral.\n    Order of nodes: 1:(-1,-1), 2:(+1,-1), 3:(+1,+1), 4:(-1,+1) in parent space.\n    \"\"\"\n    dN_dxi = np.array([\n        -0.25 * (1.0 - eta),   # dN1/dxi\n         0.25 * (1.0 - eta),   # dN2/dxi\n         0.25 * (1.0 + eta),   # dN3/dxi\n        -0.25 * (1.0 + eta)    # dN4/dxi\n    ])\n    dN_deta = np.array([\n        -0.25 * (1.0 - xi),    # dN1/deta\n        -0.25 * (1.0 + xi),    # dN2/deta\n         0.25 * (1.0 + xi),    # dN3/deta\n         0.25 * (1.0 - xi)     # dN4/deta\n    ])\n    return dN_dxi, dN_deta\n\ndef jacobian_det(xy_nodes, xi, eta):\n    \"\"\"\n    Compute det(J) at (xi, eta) for a 4-node bilinear quad with given physical nodes.\n    xy_nodes: array-like shape (4,2) with node coordinates [(x1,y1),...,(x4,y4)] in meters.\n    Returns detJ in m^2.\n    \"\"\"\n    dN_dxi, dN_deta = dN_dxi_eta_bilinear(xi, eta)\n    x = np.array([n[0] for n in xy_nodes])\n    y = np.array([n[1] for n in xy_nodes])\n\n    x_xi = float(np.dot(x, dN_dxi))\n    y_xi = float(np.dot(y, dN_dxi))\n    x_eta = float(np.dot(x, dN_deta))\n    y_eta = float(np.dot(y, dN_deta))\n\n    detJ = x_xi * y_eta - y_xi * x_eta\n    return detJ\n\ndef evaluate_element(xy_nodes):\n    \"\"\"\n    Evaluate detJ at 2x2 Gauss points and corner distortion criterion.\n    Returns:\n      [ [d1,d2,d3,d4], gp_ok, corner_ok, min_corner_detJ ]\n    where di are rounded to 6 decimals (m^2).\n    \"\"\"\n    g = 1.0 / np.sqrt(3.0)\n    gauss_pts = [(-g, -g), ( +g, -g), ( +g, +g), ( -g, +g)]\n    dets_gp = []\n    for (xi, eta) in gauss_pts:\n        det = jacobian_det(xy_nodes, xi, eta)\n        dets_gp.append(round(det, 6))\n\n    gp_ok = all(d > 0.0 for d in dets_gp)\n\n    corners = [(-1.0, -1.0), ( +1.0, -1.0), ( +1.0, +1.0), ( -1.0, +1.0)]\n    dets_corner = []\n    for (xi, eta) in corners:\n        det = jacobian_det(xy_nodes, xi, eta)\n        dets_corner.append(det)\n\n    min_corner = min(dets_corner)\n    min_corner_rounded = round(min_corner, 6)\n    corner_ok = (min_corner_rounded > 0.0)\n\n    return [dets_gp, gp_ok, corner_ok, min_corner_rounded]\n\ndef solve():\n    # Define the test cases from the problem statement (coordinates in meters).\n    test_cases = [\n        # Element A (convex, skewed)\n        [(0.0, 0.0), (2.0, 0.3), (1.8, 1.6), (0.2, 1.7)],\n        # Element B (parallelogram, moderate skew)\n        [(0.0, 0.0), (1.2, 0.3), (2.2, 1.3), (1.0, 1.0)],\n        # Element C (sliver, near-singular height)\n        [(0.0, 0.0), (1.0, 0.0), (1.001, 0.001), (0.001, 0.001)],\n        # Element D (twisted, bow-tie ordering)\n        [(0.0, 0.0), (1.0, 1.0), (0.0, 1.0), (1.0, 0.0)],\n    ]\n\n    results = []\n    for xy_nodes in test_cases:\n        res = evaluate_element(xy_nodes)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    # Ensure booleans and floats are printed in a single-line Python list representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3452244"}, {"introduction": "Real materials often deform plastically, a nonlinear behavior that is fundamental to computational materials science. This practice guides you through a pivotal step of an FEM simulation: updating the stress state at an integration point for an elastoplastic material using the von Mises yield criterion. You will implement the 'return mapping' algorithm, a core numerical technique used to enforce the yield condition and calculate plastic flow, providing a concrete understanding of how complex material models are integrated in time [@problem_id:3452269].", "problem": "A single Gauss integration point in a three-dimensional small-strain solid is advanced one load/time increment within a Finite Element Method (FEM) simulation. The material follows isotropic linear elasticity and rate-independent von Mises (also called $J_{2}$) plasticity with linear isotropic hardening. The constitutive definitions are as follows:\n\n- Small-strain kinematics with total strain increment from step $n$ to $n+1$ denoted by $\\Delta \\boldsymbol{\\varepsilon}$.\n- Hooke’s law for isotropic linear elasticity with Young’s modulus $E$ and Poisson’s ratio $\\nu$.\n- The Cauchy stress $\\boldsymbol{\\sigma}$ decomposes into hydrostatic and deviatoric parts $\\boldsymbol{\\sigma} = p \\mathbf{I} + \\boldsymbol{s}$, where $p = \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$ and $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\mathbf{I}$.\n- The von Mises equivalent stress is $\\sigma_{\\mathrm{eq}} = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$.\n- The yield function is $f(\\boldsymbol{\\sigma}, \\varepsilon_{p}^{\\mathrm{eq}}) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\varepsilon_{p}^{\\mathrm{eq}})$ with $\\sigma_{y}(\\varepsilon_{p}^{\\mathrm{eq}}) = \\sigma_{y0} + H\\,\\varepsilon_{p}^{\\mathrm{eq}}$, where $\\sigma_{y0}$ is the initial yield strength, $H$ is the isotropic hardening modulus, and $\\varepsilon_{p}^{\\mathrm{eq}}$ is the equivalent plastic strain.\n- Associated plastic flow: $\\Delta \\boldsymbol{\\varepsilon}_{p} = \\Delta \\gamma \\,\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$, where $\\Delta \\gamma \\ge 0$ is the plastic multiplier increment.\n\nAt the beginning of the step, the state is\n- Stress at step $n$: $\\boldsymbol{\\sigma}_{n} = \\mathbf{0}$,\n- Plastic strain at step $n$: $\\boldsymbol{\\varepsilon}_{p,n} = \\mathbf{0}$,\n- Equivalent plastic strain at step $n$: $\\varepsilon_{p,n}^{\\mathrm{eq}} = 0$.\n\nMaterial parameters:\n- Young’s modulus $E = 210 \\times 10^{3}\\,\\text{MPa}$,\n- Poisson’s ratio $\\nu = 0.3$,\n- Initial yield stress $\\sigma_{y0} = 250\\,\\text{MPa}$,\n- Isotropic hardening modulus $H = 1000\\,\\text{MPa}$.\n\nTotal strain increment over the step:\n$$\n\\Delta \\boldsymbol{\\varepsilon} = \\begin{pmatrix}\n0.004  0  0 \\\\\n0  -0.001  0 \\\\\n0  0  -0.001\n\\end{pmatrix}.\n$$\n\nTasks:\n1. Perform the elastic trial (predictor) step to compute the trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$.\n2. Evaluate the yield function at trial state to determine whether yielding occurs in this increment.\n3. If plastic yielding occurs, carry out the return mapping for associated $J_{2}$ plasticity with linear isotropic hardening to compute:\n   - The plastic multiplier increment $\\Delta \\gamma$,\n   - The updated Cauchy stress $\\boldsymbol{\\sigma}_{n+1}$,\n   - The updated plastic strain tensor $\\boldsymbol{\\varepsilon}_{p,n+1}$,\n   - The updated equivalent plastic strain $\\varepsilon_{p,n+1}^{\\mathrm{eq}}$.\n4. Express the stress components in $\\text{MPa}$ and strains as dimensionless quantities.\n5. For grading, report only the plastic multiplier increment $\\Delta \\gamma$ as the final answer. Round this reported number to four significant figures and provide it as a dimensionless quantity.", "solution": "The problem is validated as being scientifically grounded, well-posed, objective, and complete. It represents a standard exercise in computational plasticity. The solution proceeds by following the canonical operator-split algorithm for integrating elastoplastic constitutive models, which consists of an elastic predictor step followed by a plastic corrector (return mapping) step.\n\nFirst, we calculate the necessary elastic constants from the given Young's modulus $E = 210 \\times 10^{3}\\,\\text{MPa}$ and Poisson's ratio $\\nu = 0.3$.\nThe shear modulus $G$ is:\n$$G = \\frac{E}{2(1+\\nu)} = \\frac{210 \\times 10^{3}\\,\\text{MPa}}{2(1+0.3)} = \\frac{210000}{2.6}\\,\\text{MPa} = \\frac{105000}{1.3}\\,\\text{MPa}$$\nThe bulk modulus $K$ is:\n$$K = \\frac{E}{3(1-2\\nu)} = \\frac{210 \\times 10^{3}\\,\\text{MPa}}{3(1-2 \\times 0.3)} = \\frac{210000}{3 \\times 0.4} = \\frac{210000}{1.2}\\,\\text{MPa} = 175000\\,\\text{MPa}$$\nThe isotropic elastic stress-strain relationship is given by Hooke's law, $\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}_{e}$, where $\\mathbf{C}$ is the fourth-order elasticity tensor, $\\boldsymbol{\\sigma}$ is the Cauchy stress, and $\\boldsymbol{\\varepsilon}_{e}$ is the elastic strain. This can be conveniently split into volumetric and deviatoric parts:\n$$p = K \\operatorname{tr}(\\boldsymbol{\\varepsilon}_{e})$$\n$$\\boldsymbol{s} = 2G \\boldsymbol{e}_{e}$$\nwhere $p = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ is the hydrostatic stress, $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\mathbf{I}$ is the deviatoric stress, and $\\boldsymbol{e}_{e} = \\boldsymbol{\\varepsilon}_{e} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon}_{e})\\mathbf{I}$ is the deviatoric part of the elastic strain.\n\nThe initial state at step $n$ is fully specified: $\\boldsymbol{\\sigma}_{n} = \\mathbf{0}$, $\\boldsymbol{\\varepsilon}_{p,n} = \\mathbf{0}$, and $\\varepsilon_{p,n}^{\\mathrm{eq}} = 0$. The initial yield stress is thus $\\sigma_{y,n} = \\sigma_{y0} = 250\\,\\text{MPa}$.\n\n**1. Elastic Predictor Step**\nIn the trial step, we assume the entire strain increment $\\Delta\\boldsymbol{\\varepsilon}$ is purely elastic. The additive decomposition of strain is $\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}_{e} + \\Delta\\boldsymbol{\\varepsilon}_{p}$. Setting the plastic strain increment to zero ($\\Delta\\boldsymbol{\\varepsilon}_{p} = \\mathbf{0}$) gives the trial elastic strain increment as $\\Delta\\boldsymbol{\\varepsilon}_{e}^{\\mathrm{tr}} = \\Delta\\boldsymbol{\\varepsilon}$.\nThe trial stress at the end of the increment, $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$, is computed as:\n$$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon} = \\mathbf{0} + \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon} = \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}$$\nWe can compute the hydrostatic and deviatoric parts of the trial stress separately. The volumetric part of the strain increment is:\n$$\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 0.004 + (-0.001) + (-0.001) = 0.002$$\nThe trial hydrostatic stress is:\n$$p^{\\mathrm{tr}} = K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}) = (175000\\,\\text{MPa}) \\times 0.002 = 350\\,\\text{MPa}$$\nThe deviatoric part of the strain increment, $\\Delta\\boldsymbol{e} = \\Delta\\boldsymbol{\\varepsilon} - \\frac{1}{3}\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon})\\mathbf{I}$, is:\n$$\\Delta\\boldsymbol{e} = \\begin{pmatrix} 0.004  0  0 \\\\ 0  -0.001  0 \\\\ 0  0  -0.001 \\end{pmatrix} - \\frac{0.002}{3} \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0.004 - \\frac{0.002}{3}  0  0 \\\\ 0  -0.001 - \\frac{0.002}{3}  0 \\\\ 0  0  -0.001 - \\frac{0.002}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{0.01}{3}  0  0 \\\\ 0  -\\frac{0.005}{3}  0 \\\\ 0  0  -\\frac{0.005}{3} \\end{pmatrix}$$\nThe trial deviatoric stress is:\n$$\\boldsymbol{s}^{\\mathrm{tr}} = 2G \\Delta\\boldsymbol{e} = 2 \\left(\\frac{105000}{1.3}\\,\\text{MPa}\\right) \\begin{pmatrix} \\frac{0.01}{3}  0  0 \\\\ 0  -\\frac{0.005}{3}  0 \\\\ 0  0  -\\frac{0.005}{3} \\end{pmatrix} = \\frac{1}{1.3} \\begin{pmatrix} 700  0  0 \\\\ 0  -350  0 \\\\ 0  0  -350 \\end{pmatrix}\\,\\text{MPa}$$\n\n**2. Yield Condition Evaluation**\nWe evaluate the von Mises equivalent stress for the trial state, $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}$:\n$$\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}} = \\left(\\frac{700}{1.3}\\right)^2 + \\left(-\\frac{350}{1.3}\\right)^2 + \\left(-\\frac{350}{1.3}\\right)^2 = \\frac{1}{(1.3)^2} [700^2 + 2 \\times 350^2] = \\frac{350^2}{(1.3)^2} [2^2 + 2] = \\frac{6 \\times 350^2}{(1.3)^2}\\,\\text{MPa}^2$$\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} \\left( \\frac{6 \\times 350^2}{(1.3)^2} \\right)} = \\sqrt{\\frac{9 \\times 350^2}{(1.3)^2}} = \\frac{3 \\times 350}{1.3}\\,\\text{MPa} = \\frac{1050}{1.3}\\,\\text{MPa}$$\nNumerically, $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} \\approx 807.69\\,\\text{MPa}$.\nThe yield function at the trial state is $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y,n}$.\n$$f^{\\mathrm{tr}} = \\frac{1050}{1.3}\\,\\text{MPa} - 250\\,\\text{MPa} = \\frac{1050 - 250 \\times 1.3}{1.3}\\,\\text{MPa} = \\frac{1050-325}{1.3}\\,\\text{MPa} = \\frac{725}{1.3}\\,\\text{MPa} \\approx 557.69\\,\\text{MPa}$$\nSince $f^{\\mathrm{tr}}  0$, the elastic trial state is outside the yield surface, and plastic deformation occurs. A plastic correction is required.\n\n**3. Plastic Corrector (Return Mapping) Step**\nThe plastic correction is performed to return the stress state to the updated yield surface. For associated $J_2$ plasticity, the plastic flow is normal to the yield surface:\n$$\\Delta\\boldsymbol{\\varepsilon}_{p} = \\Delta\\gamma \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\gamma \\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\gamma \\left(\\frac{3}{2}\\frac{\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}}\\right)$$\nThe stress is updated as $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}_{p}$.\nSince plastic flow is isochoric ($\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}_{p}) = 0$), the hydrostatic stress is unaffected: $p_{n+1} = p^{\\mathrm{tr}}$.\nThe deviatoric stress is updated according to the radial return algorithm:\n$$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G\\Delta\\boldsymbol{\\varepsilon}_{p} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G \\Delta\\gamma \\left(\\frac{3}{2}\\frac{\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}} - 3G\\Delta\\gamma \\frac{\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}}$$\nThis relationship implies that $\\boldsymbol{s}_{n+1}$ is proportional to $\\boldsymbol{s}^{\\mathrm{tr}}$, thus:\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq},n+1} + 3G\\Delta\\gamma$$\nThis is the first key equation. The second is the consistency condition, $f(\\boldsymbol{\\sigma}_{n+1}, \\varepsilon_{p,n+1}^{\\mathrm{eq}}) = 0$:\n$$\\sigma_{\\mathrm{eq},n+1} = \\sigma_{y,n+1} = \\sigma_{y0} + H\\varepsilon_{p,n+1}^{\\mathrm{eq}}$$\nThe equivalent plastic strain increment $\\Delta\\varepsilon_{p}^{\\mathrm{eq}}$ is, for this model, equal to the plastic multiplier $\\Delta\\gamma$:\n$$\\Delta\\varepsilon_{p}^{\\mathrm{eq}} = \\sqrt{\\frac{2}{3}\\Delta\\boldsymbol{\\varepsilon}_{p}:\\Delta\\boldsymbol{\\varepsilon}_{p}} = \\sqrt{\\frac{2}{3}\\left(\\Delta\\gamma^2 \\frac{9}{4}\\frac{\\boldsymbol{s}_{n+1}:\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}^2}\\right)} = \\sqrt{\\frac{2}{3}\\Delta\\gamma^2 \\frac{9}{4}\\frac{\\frac{2}{3}\\sigma_{\\mathrm{eq},n+1}^2}{\\sigma_{\\mathrm{eq},n+1}^2}} = \\Delta\\gamma$$\nSince $\\varepsilon_{p,n}^{\\mathrm{eq}} = 0$, we have $\\varepsilon_{p,n+1}^{\\mathrm{eq}} = \\Delta\\gamma$. So the consistency condition becomes:\n$$\\sigma_{\\mathrm{eq},n+1} = \\sigma_{y0} + H\\Delta\\gamma$$\nSubstituting this into the radial return equation:\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = (\\sigma_{y0} + H\\Delta\\gamma) + 3G\\Delta\\gamma$$\nWe can now solve for the plastic multiplier increment $\\Delta\\gamma$:\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} = (3G + H)\\Delta\\gamma$$\n$$\\Delta\\gamma = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0}}{3G + H} = \\frac{f^{\\mathrm{tr}}}{3G + H}$$\nWe substitute the numerical values:\n$$3G + H = 3\\left(\\frac{105000}{1.3}\\,\\text{MPa}\\right) + 1000\\,\\text{MPa} = \\frac{315000 + 1300}{1.3}\\,\\text{MPa} = \\frac{316300}{1.3}\\,\\text{MPa}$$\n$$\\Delta\\gamma = \\frac{\\frac{725}{1.3}\\,\\text{MPa}}{\\frac{316300}{1.3}\\,\\text{MPa}} = \\frac{725}{316300}$$\nCalculating the numerical value:\n$$\\Delta\\gamma = 0.0022921277...$$\n\n**4. Final Answer Calculation**\nThe problem requests the plastic multiplier increment $\\Delta\\gamma$ rounded to four significant figures.\n$$\\Delta\\gamma \\approx 0.002292$$\nThis value is dimensionless, as required. Although not requested for the final answer, the other final state variables would be computed from this value. For example, $\\varepsilon_{p,n+1}^{\\mathrm{eq}} = \\Delta\\gamma$ and $\\boldsymbol{\\sigma}_{n+1} = p^{\\mathrm{tr}}\\mathbf{I} + \\boldsymbol{s}^{\\mathrm{tr}}(1 - 3G\\Delta\\gamma / \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}})$. The required final answer is only $\\Delta\\gamma$.", "answer": "$$\n\\boxed{0.002292}\n$$", "id": "3452269"}]}