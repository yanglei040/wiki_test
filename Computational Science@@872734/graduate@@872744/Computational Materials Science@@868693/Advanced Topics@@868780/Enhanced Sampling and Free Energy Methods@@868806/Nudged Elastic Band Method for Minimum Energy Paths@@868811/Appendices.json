{"hands_on_practices": [{"introduction": "The first step in any Nudged Elastic Band (NEB) calculation is to generate an initial guess for the minimum energy path. This is typically done by creating a series of \"images\" or replicas of the system that form a discrete path between the known initial and final states. This foundational exercise provides hands-on practice with this setup procedure, connecting abstract crystallographic coordinates to the concrete Cartesian positions of the images that form the initial band. By working through this example, you will also reinforce your understanding of handling periodic boundary conditions, a crucial skill in solid-state materials modeling [@problem_id:3471006].", "problem": "Consider a diffusion event in a hexagonal close-packed crystal under periodic boundary conditions, modeled within the Nudged Elastic Band (NEB) method, where the endpoints are fixed at two local minima. The crystal has lattice parameters $a$ and $c$, with primitive lattice vectors given by $\\mathbf{a}_{1} = (a, 0, 0)$, $\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}\\,a}{2}, 0\\right)$, and $\\mathbf{a}_{3} = (0, 0, c)$. A single interstitial hydrogen atom moves from a fractional coordinate $\\mathbf{s}_{A} = \\left(\\frac{1}{3}, \\frac{2}{3}, 0.25\\right)$ to $\\mathbf{s}_{B} = \\left(\\frac{2}{3}, \\frac{1}{3}, 0.25\\right)$, while all other atoms remain fixed. The Cartesian position of a point with fractional coordinate $\\mathbf{s} = (s_{x}, s_{y}, s_{z})$ is $\\mathbf{R} = s_{x}\\,\\mathbf{a}_{1} + s_{y}\\,\\mathbf{a}_{2} + s_{z}\\,\\mathbf{a}_{3}$. Use the minimum-image convention to choose the fractional displacement $\\Delta \\mathbf{s}$ such that each component lies in the interval $\\left[-\\frac{1}{2}, \\frac{1}{2}\\right]$.\n\nConstruct the initial NEB band of $M = 4$ intermediate images by linear interpolation in Cartesian coordinates between the fixed endpoints. Treat the NEB configuration-space distance as the standard Euclidean norm in $3N$ dimensions (with $N = 1$ mobile atom here). The lattice parameters are $a = 2.95\\,\\text{\\AA}$ and $c = 4.68\\,\\text{\\AA}$. Compute the set of inter-image distances $\\left\\|\\mathbf{R}_{i+1} - \\mathbf{R}_{i}\\right\\|$ for $i = 0, 1, 2, 3, 4$, where $\\mathbf{R}_{0}$ and $\\mathbf{R}_{5}$ are the fixed endpoints and $\\mathbf{R}_{1}, \\dots, \\mathbf{R}_{4}$ are the interpolated images. Express each distance in angstroms and round your results to four significant figures.", "solution": "The user wants to solve a problem based on the Nudged Elastic Band (NEB) method. The first step is to validate the problem statement.\n\n### Step 1: Extract Givens\n- **Crystal System**: Hexagonal close-packed (HCP)\n- **Lattice Parameters**: $a = 2.95\\,\\text{\\AA}$, $c = 4.68\\,\\text{\\AA}$\n- **Primitive Lattice Vectors**: $\\mathbf{a}_{1} = (a, 0, 0)$, $\\mathbf{a}_{2} = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}\\,a}{2}, 0\\right)$, $\\mathbf{a}_{3} = (0, 0, c)$\n- **Initial Fractional Coordinate**: $\\mathbf{s}_{A} = \\left(\\frac{1}{3}, \\frac{2}{3}, 0.25\\right)$\n- **Final Fractional Coordinate**: $\\mathbf{s}_{B} = \\left(\\frac{2}{3}, \\frac{1}{3}, 0.25\\right)$\n- **Coordinate Transformation**: $\\mathbf{R} = s_{x}\\,\\mathbf{a}_{1} + s_{y}\\,\\mathbf{a}_{2} + s_{z}\\,\\mathbf{a}_{3}$ for a fractional coordinate $\\mathbf{s} = (s_{x}, s_{y}, s_{z})$\n- **Periodic Boundary Conditions**: Use the minimum-image convention for the fractional displacement $\\Delta \\mathbf{s}$, with components in $\\left[-\\frac{1}{2}, \\frac{1}{2}\\right]$.\n- **NEB Setup**: $M = 4$ intermediate images. The path consists of endpoints $\\mathbf{R}_0 = \\mathbf{R}_A$ and $\\mathbf{R}_{M+1} = \\mathbf{R}_5 = \\mathbf{R}_B$.\n- **Interpolation Method**: Linear interpolation in Cartesian coordinates.\n- **Task**: Compute the set of inter-image distances $\\left\\|\\mathbf{R}_{i+1} - \\mathbf{R}_{i}\\right\\|$ for $i = 0, 1, 2, 3, 4$.\n- **Output Format**: Distances in angstroms, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the standard setup for an initial Nudged Elastic Band path for a diffusion process in a crystal. The HCP lattice, fractional coordinates, minimum-image convention, and linear interpolation are all standard concepts and practices in computational materials science. The provided lattice parameters are physically realistic. The problem is grounded in established scientific methods.\n- **Well-Posed**: The problem is well-defined. All necessary information (lattice parameters, coordinates, number of images, interpolation scheme) is provided to calculate the requested distances. The objective is clear, and a unique solution can be determined through a standard mathematical procedure.\n- **Objective**: The language is precise, quantitative, and free of any subjective or ambiguous terminology.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. The data is self-contained and consistent. The presence of the lattice parameter $c$ which is not used in the final calculation does not constitute a flaw; it is common for problems to include data that may not be relevant to test conceptual understanding.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution will be provided.\n\n### Solution\n\nThe relationship between a Cartesian position vector $\\mathbf{R} = (R_x, R_y, R_z)$ and a fractional coordinate vector $\\mathbf{s} = (s_x, s_y, s_z)$ is given by a linear transformation $\\mathbf{R} = \\mathbf{L}\\mathbf{s}$, where $\\mathbf{L}$ is the lattice matrix whose columns are the primitive lattice vectors $\\mathbf{a}_1$, $\\mathbf{a}_2$, and $\\mathbf{a}_3$.\n$$\n\\mathbf{L} = \\begin{pmatrix} a  \\frac{a}{2}  0 \\\\ 0  \\frac{\\sqrt{3}\\,a}{2}  0 \\\\ 0  0  c \\end{pmatrix}\n$$\nThe problem defines a path for a single atom from an initial position to a final position. The endpoints are given in fractional coordinates:\nInitial position: $\\mathbf{s}_0 = \\mathbf{s}_A = \\left(\\frac{1}{3}, \\frac{2}{3}, 0.25\\right)$\nFinal position: $\\mathbf{s}_{\\text{end}} = \\mathbf{s}_B = \\left(\\frac{2}{3}, \\frac{1}{3}, 0.25\\right)$\n\nWe must first find the shortest displacement vector connecting these two points under periodic boundary conditions, using the minimum-image convention. The raw displacement in fractional coordinates is:\n$$\n\\Delta \\mathbf{s}_{\\text{raw}} = \\mathbf{s}_B - \\mathbf{s}_A = \\left(\\frac{2}{3} - \\frac{1}{3}, \\frac{1}{3} - \\frac{2}{3}, 0.25 - 0.25\\right) = \\left(\\frac{1}{3}, -\\frac{1}{3}, 0\\right)\n$$\nEach component of $\\Delta \\mathbf{s}_{\\text{raw}}$ is already in the interval $\\left[-\\frac{1}{2}, \\frac{1}{2}\\right]$, so this is the minimum-image displacement vector, $\\Delta \\mathbf{s} = \\Delta \\mathbf{s}_{\\text{raw}}$.\n\nThe displacement vector in Cartesian coordinates, $\\Delta \\mathbf{R}$, is found by transforming $\\Delta \\mathbf{s}$:\n$$\n\\Delta \\mathbf{R} = \\mathbf{L} \\Delta \\mathbf{s} = \\frac{1}{3}\\mathbf{a}_1 - \\frac{1}{3}\\mathbf{a}_2 + 0\\mathbf{a}_3\n$$\nSubstituting the definitions of $\\mathbf{a}_1$ and $\\mathbf{a}_2$:\n$$\n\\Delta \\mathbf{R} = \\frac{1}{3}(a, 0, 0) - \\frac{1}{3}\\left(\\frac{a}{2}, \\frac{\\sqrt{3}\\,a}{2}, 0\\right) = \\left(\\frac{a}{3} - \\frac{a}{6}, -\\frac{\\sqrt{3}\\,a}{6}, 0\\right) = \\left(\\frac{a}{6}, -\\frac{\\sqrt{3}\\,a}{6}, 0\\right)\n$$\nThe magnitude of this total displacement vector is:\n$$\n\\|\\Delta \\mathbf{R}\\| = \\sqrt{\\left(\\frac{a}{6}\\right)^2 + \\left(-\\frac{\\sqrt{3}\\,a}{6}\\right)^2 + 0^2} = \\sqrt{\\frac{a^2}{36} + \\frac{3a^2}{36}} = \\sqrt{\\frac{4a^2}{36}} = \\sqrt{\\frac{a^2}{9}} = \\frac{a}{3}\n$$\nThe NEB path consists of $M+2 = 4+2 = 6$ images in total: $\\mathbf{R}_0, \\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3, \\mathbf{R}_4, \\mathbf{R}_5$. Here, $\\mathbf{R}_0$ is the initial state and $\\mathbf{R}_5$ is the final state. The path is constructed by linear interpolation in Cartesian coordinates. This means the total Cartesian displacement vector $\\Delta \\mathbf{R} = \\mathbf{R}_5 - \\mathbf{R}_0$ is divided into $M+1 = 5$ equal segments.\n\nThe position of the $i$-th image is given by:\n$$\n\\mathbf{R}_i = \\mathbf{R}_0 + \\frac{i}{M+1} \\Delta \\mathbf{R} = \\mathbf{R}_0 + \\frac{i}{5} \\Delta \\mathbf{R} \\quad \\text{for } i = 0, 1, \\dots, 5\n$$\nThe vector separating two consecutive images, $\\mathbf{R}_{i+1}$ and $\\mathbf{R}_i$, is:\n$$\n\\mathbf{R}_{i+1} - \\mathbf{R}_i = \\left(\\mathbf{R}_0 + \\frac{i+1}{5}\\Delta\\mathbf{R}\\right) - \\left(\\mathbf{R}_0 + \\frac{i}{5}\\Delta\\mathbf{R}\\right) = \\frac{1}{5}\\Delta\\mathbf{R}\n$$\nThis vector is constant for all segments of the initial band ($i = 0, 1, 2, 3, 4$). Therefore, the distance between any two consecutive images is also constant:\n$$\n\\|\\mathbf{R}_{i+1} - \\mathbf{R}_i\\| = \\left\\|\\frac{1}{5}\\Delta\\mathbf{R}\\right\\| = \\frac{1}{5}\\|\\Delta\\mathbf{R}\\|\n$$\nSubstituting the previously calculated magnitude $\\|\\Delta\\mathbf{R}\\| = \\frac{a}{3}$:\n$$\n\\|\\mathbf{R}_{i+1} - \\mathbf{R}_i\\| = \\frac{1}{5} \\left(\\frac{a}{3}\\right) = \\frac{a}{15}\n$$\nNow, we substitute the given numerical value for the lattice parameter $a = 2.95\\,\\text{\\AA}$:\n$$\n\\|\\mathbf{R}_{i+1} - \\mathbf{R}_i\\| = \\frac{2.95\\,\\text{\\AA}}{15} \\approx 0.196666\\dots\\,\\text{\\AA}\n$$\nRounding the result to four significant figures as requested gives $0.1967\\,\\text{\\AA}$.\n\nThe set of inter-image distances for $i=0, 1, 2, 3, 4$ is a set of five identical values.\n$\\|\\mathbf{R}_1 - \\mathbf{R}_0\\| = \\frac{a}{15} \\approx 0.1967\\,\\text{\\AA}$\n$\\|\\mathbf{R}_2 - \\mathbf{R}_1\\| = \\frac{a}{15} \\approx 0.1967\\,\\text{\\AA}$\n$\\|\\mathbf{R}_3 - \\mathbf{R}_2\\| = \\frac{a}{15} \\approx 0.1967\\,\\text{\\AA}$\n$\\|\\mathbf{R}_4 - \\mathbf{R}_3\\| = \\frac{a}{15} \\approx 0.1967\\,\\text{\\AA}$\n$\\|\\mathbf{R}_5 - \\mathbf{R}_4\\| = \\frac{a}{15} \\approx 0.1967\\,\\text{\\AA}$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1967  0.1967  0.1967  0.1967  0.1967 \\end{pmatrix}}\n$$", "id": "3471006"}, {"introduction": "The NEB method elegantly combines the true forces derived from the potential energy surface with artificial spring forces between adjacent images. A deep understanding of the method requires clearly distinguishing the roles of these two different force components. This idealized problem simplifies the system to one dimension to isolate the effect of the spring forces, revealing their fundamental purpose: to maintain an even distribution of images along the reaction path [@problem_id:3471048]. By showing that the equilibrium image spacing is independent of the spring constant $k_s$, this exercise demonstrates that the springs guide the relaxation process but do not dictate the final, converged minimum energy path.", "problem": "Consider a one-dimensional chain-of-states representation of a minimum energy path between two fixed endpoints in a quadratic potential. The potential energy is given by $V(x) = \\frac{1}{2} a x^{2}$ with $a  0$, and the endpoints are fixed at $x_{0} = -\\frac{L}{2}$ and $x_{N} = \\frac{L}{2}$, so that the total path length is $L = |x_{N} - x_{0}|$. The path is discretized into $N+1$ images $\\{x_{i}\\}_{i=0}^{N}$, including endpoints.\n\nIn the Nudged Elastic Band (NEB) method, the force on an interior image $i$ ($1 \\leq i \\leq N-1$) is decomposed into the component of the true force perpendicular to the path and the spring force along the tangent direction. In one spatial dimension, the perpendicular component of the true force vanishes under the NEB projection, so the interior images are governed solely by the tangential spring forces connecting nearest neighbors. Assume harmonic springs with constant spring constant $k_{s}  0$ between adjacent images, and that the equilibrium configuration minimizes the discrete spring energy subject to fixed endpoints.\n\nDerive, from first principles of the NEB projection and harmonic springs, the equilibrium condition for the interior images and show how the inter-image distances $\\Delta x_{i} = x_{i+1} - x_{i}$ are determined. Then, compute the effect on the equilibrium inter-image distances of doubling the spring constant from $k_{s}$ to $2 k_{s}$, with all other parameters ($a$, $L$, $N$) unchanged. Report the ratio $\\rho = \\frac{\\Delta x_{i}^{\\prime}}{\\Delta x_{i}}$, where $\\Delta x_{i}^{\\prime}$ denotes the equilibrium inter-image distance after doubling $k_{s}$. Express your final answer as a single dimensionless real number. No rounding is required.", "solution": "The problem is first validated to ensure it is self-contained, scientifically sound, and well-posed.\n\n**Step 1: Extract Givens**\n- Potential Energy: $V(x) = \\frac{1}{2} a x^{2}$ with $a  0$.\n- Path Endpoints: $x_{0} = -\\frac{L}{2}$ and $x_{N} = \\frac{L}{2}$.\n- Total Path Length: $L = |x_{N} - x_{0}| = \\frac{L}{2} - (-\\frac{L}{2}) = L$.\n- Path Discretization: $N+1$ images $\\{x_{i}\\}_{i=0}^{N}$.\n- NEB Force Rule: For interior images ($1 \\leq i \\leq N-1$), the force is composed of the perpendicular component of the true force and the tangential spring force.\n- 1D Simplification: The perpendicular component of the true force is zero. The interior images are governed solely by tangential spring forces.\n- Springs: Harmonic with spring constant $k_{s}  0$.\n- Equilibrium Condition: The configuration minimizes the discrete spring energy.\n- Task: Derive the equilibrium condition, determine the inter-image distances $\\Delta x_{i} = x_{i+1} - x_i$, and compute the ratio $\\rho = \\frac{\\Delta x_{i}^{\\prime}}{\\Delta x_{i}}$ where $\\Delta x_{i}^{\\prime}$ is the distance after changing $k_s$ to $2k_s$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it describes a simplified but valid application of the Nudged Elastic Band (NEB) method, a standard computational technique. It is well-posed, with a clear objective (minimizing spring energy) and constraints (fixed endpoints), which guarantees a unique solution. The language is objective and precise.\n\nA critical feature of the problem statement is the explicit instruction: \"In one spatial dimension, the perpendicular component of the true force vanishes... so the interior images are governed solely by the tangential spring forces connecting nearest neighbors.\" This instruction is self-consistent and directs us to disregard the forces derived from the potential $V(x)$ when determining the equilibrium positions of the images. The potential energy function $V(x)$ and its parameter $a$ are therefore irrelevant to the positioning of the images in this specific problem setup. The problem is a test of careful reading and adherence to a simplified physical model, not a \"pseudo-profound\" or trivial question, as this simplification is a key conceptual point. The problem is deemed valid.\n\n**Step 3: Derivation and Solution**\nThe problem states that the equilibrium configuration of the images $\\{x_i\\}$ is determined by minimizing the total discrete spring energy, subject to the fixed endpoints $x_0$ and $x_N$. The total spring energy $U_s$ of the chain of images is the sum of the potential energies of the individual harmonic springs connecting adjacent images:\n$$\nU_s = \\sum_{j=0}^{N-1} \\frac{1}{2} k_{s} (x_{j+1} - x_{j})^{2}\n$$\nTo find the equilibrium position of an arbitrary interior image $x_i$ (where $1 \\leq i \\leq N-1$), we must find the configuration that minimizes $U_s$. This is achieved by setting the partial derivative of $U_s$ with respect to $x_i$ to zero. The position $x_i$ only appears in the terms for the spring connecting images $i-1$ and $i$, and the spring connecting images $i$ and $i+1$.\n$$\n\\frac{\\partial U_s}{\\partial x_i} = \\frac{\\partial}{\\partial x_i} \\left[ \\frac{1}{2} k_{s} (x_{i} - x_{i-1})^{2} + \\frac{1}{2} k_{s} (x_{i+1} - x_{i})^{2} \\right]\n$$\nApplying the chain rule gives:\n$$\n\\frac{\\partial U_s}{\\partial x_i} = k_{s} (x_{i} - x_{i-1}) \\cdot (1) + k_{s} (x_{i+1} - x_{i}) \\cdot (-1) = k_{s} (x_{i} - x_{i-1}) - k_{s} (x_{i+1} - x_{i})\n$$\nThe force on image $i$ is $F_i = -\\frac{\\partial U_s}{\\partial x_i} = k_{s}(x_{i+1} - x_i) - k_{s}(x_i - x_{i-1})$. At equilibrium, this force is zero:\n$$\nF_i = k_{s}(x_{i+1} - 2x_i + x_{i-1}) = 0\n$$\nSince the spring constant $k_s  0$, the equilibrium condition for any interior image $i$ simplifies to:\n$$\nx_{i+1} - 2x_i + x_{i-1} = 0\n$$\nThis equation can be rewritten as:\n$$\nx_{i+1} - x_i = x_i - x_{i-1}\n$$\nThis is the derived equilibrium condition. It shows that the distance between image $i$ and its right neighbor $i+1$ is equal to the distance between image $i$ and its left neighbor $i-1$. This holds for all interior images, $i=1, 2, \\dots, N-1$.\n\nLet $\\Delta x_j = x_{j+1} - x_j$ be the inter-image distance. The condition $x_{i+1} - x_i = x_i - x_{i-1}$ is equivalent to $\\Delta x_i = \\Delta x_{i-1}$. Applying this recursively, we find that all inter-image distances must be equal:\n$$\n\\Delta x_0 = \\Delta x_1 = \\dots = \\Delta x_{N-1} = \\Delta x\n$$\nThe images are thus distributed uniformly along the path. To find the value of this constant distance $\\Delta x$, we use the total length of the path, $L$, which is spanned by $N$ such segments:\n$$\nL = x_N - x_0 = \\sum_{j=0}^{N-1} (x_{j+1} - x_j) = \\sum_{j=0}^{N-1} \\Delta x_j = N \\cdot \\Delta x\n$$\nFrom this, we determine the equilibrium inter-image distance:\n$$\n\\Delta x_i = \\Delta x = \\frac{L}{N}\n$$\nThis result is independent of the spring constant $k_s$ and the potential parameter $a$. It depends only on the total path length $L$ and the number of intervals $N$.\n\nNow, we consider the effect of doubling the spring constant to $k_s' = 2k_s$. The new equilibrium condition is found by setting the new net force on an image to zero:\n$$\nF_i' = k_s'(x_{i+1}' - 2x_i' + x_{i-1}') = 0\n$$\nSince $k_s' = 2k_s  0$, this leads to the exact same algebraic condition for the image positions:\n$$\nx_{i+1}' - 2x_i' + x_{i-1}' = 0 \\quad \\implies \\quad x_{i+1}' - x_i' = x_i' - x_{i-1}'\n$$\nTherefore, the new inter-image distances $\\Delta x_i'$ are also all equal to a constant, $\\Delta x'$. Using the same logic as before, with unchanged parameters $L$ and $N$:\n$$\n\\Delta x_i' = \\Delta x' = \\frac{L}{N}\n$$\nThe inter-image distance does not change when the spring constant is doubled.\n\nFinally, we compute the ratio $\\rho$:\n$$\n\\rho = \\frac{\\Delta x_{i}'}{\\Delta x_{i}} = \\frac{L/N}{L/N} = 1\n$$\nThe ratio is exactly $1$, as the equilibrium distribution of images in this simplified 1D NEB model is dictated by geometry alone, not the stiffness of the springs.", "answer": "$$\n\\boxed{1}\n$$", "id": "3471048"}, {"introduction": "In practical applications, NEB calculations can suffer from numerical instabilities, most notably \"kinking\" or \"zig-zagging,\" where images oscillate off the true minimum energy path instead of converging onto it. This issue is particularly common when the path tangent is estimated with a simple central-difference scheme on potential energy surfaces with sharp features or high curvature. This advanced coding exercise allows you to directly observe this instability on a cusp-like potential and implement algorithmic solutions to mitigate it [@problem_id:3471037]. By comparing a naive tangent definition with a more robust adaptive tangent, you will quantify how such refinements are critical for ensuring the stability and accuracy of NEB simulations.", "problem": "Design and implement a complete, runnable program that constructs a two-dimensional cusp-like potential energy surface and compares the maximum perpendicular force experienced by images along a discrete path under two variants of the Nudged Elastic Band (NEB) method: a naive central-difference tangent and an adaptive tangent. The goal is to quantify how smoothing of the potential energy surface or the use of an adaptive tangent reduces spurious zig-zagging of images by reducing the maximum perpendicular force. Your program must be self-contained and produce the required outputs without user input.\n\nStart from the following foundations and definitions.\n\n1. The potential energy surface is a function $V:\\mathbb{R}^2 \\to \\mathbb{R}$ given in an unsmoothed cusp form by $V(x,y) = |x| + \\tfrac{1}{2}k_y y^2$. Smooth the cusp by replacing $|x|$ with $\\sqrt{x^2 + \\varepsilon^2}$ for a smoothing parameter $\\varepsilon \\ge 0$, i.e., $V_{\\varepsilon}(x,y) = \\sqrt{x^2 + \\varepsilon^2} + \\tfrac{1}{2}k_y y^2$, with the convention that $V_0(x,y) = |x| + \\tfrac{1}{2}k_y y^2$. Use $k_y$ and $\\varepsilon$ as case-dependent parameters, specified below.\n\n2. The physical force is defined by $\\mathbf{F}(x,y) = -\\nabla V_{\\varepsilon}(x,y)$. For $\\varepsilon = 0$, define $\\partial V_0/\\partial x = \\operatorname{sign}(x)$ for $x \\ne 0$ and $0$ for $x=0$, and $\\partial V_0/\\partial y = k_y y$. For $\\varepsilon  0$, define $\\partial V_{\\varepsilon}/\\partial x = x/\\sqrt{x^2 + \\varepsilon^2}$ and $\\partial V_{\\varepsilon}/\\partial y = k_y y$.\n\n3. In the Nudged Elastic Band (NEB) method, images $\\mathbf{R}_i \\in \\mathbb{R}^2$, with indices $i=0,\\dots,N-1$, interpolate between fixed endpoints $\\mathbf{R}_0$ and $\\mathbf{R}_{N-1}$. Exclude endpoints from force calculations. Define the unit tangent $\\boldsymbol{\\tau}_i$ at image $i$ using one of two schemes:\n   - Naive central-difference tangent: $\\boldsymbol{\\tau}_i$ is the normalized vector $\\mathbf{R}_{i+1} - \\mathbf{R}_{i-1}$.\n   - Adaptive tangent (Henkelman–Jónsson style): Let $E_j = V_{\\varepsilon}(\\mathbf{R}_j)$, $\\Delta E^{+} = E_{i+1} - E_i$, and $\\Delta E^{-} = E_i - E_{i-1}$. If $\\Delta E^{+}  0$ and $\\Delta E^{-}  0$, choose $\\boldsymbol{\\tau}_i$ along $\\mathbf{R}_{i+1} - \\mathbf{R}_i$. If $\\Delta E^{+}  0$ and $\\Delta E^{-}  0$, choose $\\boldsymbol{\\tau}_i$ along $\\mathbf{R}_i - \\mathbf{R}_{i-1}$. Otherwise, choose the direction corresponding to the larger of $|\\Delta E^{+}|$ and $|\\Delta E^{-}|$.\n\n4. For any image $i$, define the perpendicular NEB force component from the physical force as $\\mathbf{F}_{\\perp,i} = \\mathbf{F}_i - (\\mathbf{F}_i \\cdot \\boldsymbol{\\tau}_i)\\,\\boldsymbol{\\tau}_i$, where $\\mathbf{F}_i = \\mathbf{F}(\\mathbf{R}_i)$. Define the metric of interest as $F_{\\perp}^{\\max} = \\max_{i=1,\\dots,N-2} \\|\\mathbf{F}_{\\perp,i}\\|_2$.\n\nConstruct images as follows. Fix the endpoints at $\\mathbf{R}_0 = (-1,0)$ and $\\mathbf{R}_{N-1} = (1,0)$. For $N$ images, place $x_i$ uniformly between $-1$ and $1$, i.e., $x_i = -1 + \\frac{2i}{N-1}$ for $i=0,\\dots,N-1$. Let $y_0 = y_{N-1} = 0$. For internal images, model spurious zig-zagging with an alternating transverse displacement $y_i = A \\cdot (-1)^i \\cdot \\exp(-\\alpha |x_i|)$, where $A$ and $\\alpha$ are specified per test case.\n\nImplement a program that:\n- Computes $F_{\\perp}^{\\max}$ for given parameters and a specified tangent scheme.\n- Compares configurations with and without smoothing (i.e., $\\varepsilon  0$ versus $\\varepsilon = 0$).\n- Quantifies the reduction in $F_{\\perp}^{\\max}$ via the ratio $r = F_{\\perp,\\text{baseline}}^{\\max} / F_{\\perp,\\text{improved}}^{\\max}$, where the baseline is the naive tangent on the unsmoothed potential.\n\nYour program must evaluate the following test suite. For each group, report both raw maxima and ratios in the required final output format.\n\n- Group 1 (happy path, moderate cusp and moderate zig-zag): use $N=21$, $A=0.2$, $\\alpha=2.0$, $k_y=2.0$, with and without smoothing ($\\varepsilon=0$ and $\\varepsilon=0.05$); compute:\n  1. $F_{\\perp,\\text{naive,unsm}}^{\\max}$,\n  2. $F_{\\perp,\\text{adapt,unsm}}^{\\max}$,\n  3. $r_{\\text{adapt}} = F_{\\perp,\\text{naive,unsm}}^{\\max} / F_{\\perp,\\text{adapt,unsm}}^{\\max}$,\n  4. $F_{\\perp,\\text{naive,sm}}^{\\max}$,\n  5. $r_{\\text{sm}} = F_{\\perp,\\text{naive,unsm}}^{\\max} / F_{\\perp,\\text{naive,sm}}^{\\max}$.\n\n- Group 2 (boundary case, sharper cusp due to stronger transverse stiffness): use $N=21$, $A=0.2$, $\\alpha=1.5$, $k_y=10.0$, with and without smoothing ($\\varepsilon=0$ and $\\varepsilon=0.1$); compute:\n  6. $F_{\\perp,\\text{naive,unsm}}^{\\max}$,\n  7. $F_{\\perp,\\text{adapt,unsm}}^{\\max}$,\n  8. $r_{\\text{adapt}}$,\n  9. $F_{\\perp,\\text{naive,sm}}^{\\max}$,\n  10. $r_{\\text{sm}}$.\n\n- Group 3 (edge case, minimal zig-zag): use $N=21$, $A=10^{-6}$, $\\alpha=2.0$, $k_y=2.0$, with no smoothing ($\\varepsilon=0$); compute:\n  11. $F_{\\perp,\\text{naive,unsm}}^{\\max}$,\n  12. $F_{\\perp,\\text{adapt,unsm}}^{\\max}$,\n  13. $r_{\\text{adapt}}$.\n\nFinal output format: Your program should produce a single line of output containing the $13$ results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,\\dots,x_{13}]$). All outputs must be real numbers (floats). No units are required for this problem. Angles, if any, must be in radians, but no angle specification is needed here.", "solution": "The problem presented is a valid computational task grounded in the principles of computational materials science, specifically concerning the Nudged Elastic Band (NEB) method for finding Minimum Energy Paths (MEPs). All parameters, functions, and algorithms are explicitly defined, rendering the problem self-contained, objective, and well-posed. There are no scientific or logical contradictions. The problem requires the implementation of a defined algorithm for a set of specified test cases, which is a standard procedure for numerical method validation. I will now provide a complete solution.\n\nThe core of the problem is to compute the maximum perpendicular force, $F_{\\perp}^{\\max}$, experienced by a series of points (called \"images\") that discretize a path on a two-dimensional potential energy surface (PES). This metric is used to quantify the \"kinkiness\" or spurious zig-zagging of the path, a common numerical artifact in NEB calculations. The problem asks for a comparison of $F_{\\perp}^{\\max}$ under different conditions: a sharp (\"cusp-like\") vs. a smoothed PES, and a \"naive\" vs. an \"adaptive\" method for calculating the path tangent.\n\n**1. Potential Energy Surface (PES) and Force**\n\nThe PES is given by $V_{\\varepsilon}(x,y) = \\sqrt{x^2 + \\varepsilon^2} + \\tfrac{1}{2}k_y y^2$. The parameter $\\varepsilon$ controls the smoothness of the potential along the $x$-axis.\n- For $\\varepsilon = 0$, this becomes $V_0(x,y) = |x| + \\tfrac{1}{2}k_y y^2$, which has a non-differentiable cusp at $x=0$.\n- For $\\varepsilon  0$, the cusp is smoothed into a differentiable function.\n\nThe physical force on a particle at position $\\mathbf{R}=(x,y)$ is the negative gradient of the potential, $\\mathbf{F}(\\mathbf{R}) = -\\nabla V_{\\varepsilon}(\\mathbf{R})$. The components of the force vector $\\mathbf{F} = (F_x, F_y)$ are:\n$F_x(x,y) = -\\frac{\\partial V_{\\varepsilon}}{\\partial x}$ and $F_y(x,y) = -\\frac{\\partial V_{\\varepsilon}}{\\partial y}$.\n\nThe partial derivatives are defined as:\n- For $\\varepsilon = 0$:\n  $$ \\frac{\\partial V_0}{\\partial x} = \\begin{cases} \\operatorname{sign}(x)  x \\ne 0 \\\\ 0  x = 0 \\end{cases}, \\quad \\frac{\\partial V_0}{\\partial y} = k_y y $$\n- For $\\varepsilon  0$:\n  $$ \\frac{\\partial V_{\\varepsilon}}{\\partial x} = \\frac{x}{\\sqrt{x^2 + \\varepsilon^2}}, \\quad \\frac{\\partial V_{\\varepsilon}}{\\partial y} = k_y y $$\n\n**2. Discretized Path (Images)**\n\nThe continuous path is discretized into a series of $N$ images, $\\mathbf{R}_i = (x_i, y_i)$, for $i=0, \\dots, N-1$. The endpoints $\\mathbf{R}_0 = (-1,0)$ and $\\mathbf{R}_{N-1} = (1,0)$ are fixed. The internal images are constructed to simulate a zig-zagging path, a scenario where the choice of tangent definition is critical.\nThe coordinates are given by:\n- $x_i = -1 + \\frac{2i}{N-1}$\n- $y_i = A \\cdot (-1)^i \\cdot \\exp(-\\alpha |x_i|)$ for $i=1, \\dots, N-2$, with $y_0=y_{N-1}=0$. The parameters $A$ and $\\alpha$ control the amplitude and decay of the zig-zag.\n\n**3. Tangent Vector Definitions**\n\nThe unit tangent vector, $\\boldsymbol{\\tau}_i$, at an internal image $\\mathbf{R}_i$ is crucial for decomposing the force. Two schemes are to be implemented.\n\n- **Naive Central-Difference Tangent**: The tangent is estimated using the positions of the neighboring images:\n  $$ \\mathbf{t}_i^{\\text{naive}} = \\mathbf{R}_{i+1} - \\mathbf{R}_{i-1} $$\n  This vector is then normalized to get the unit tangent $\\boldsymbol{\\tau}_i = \\mathbf{t}_i / \\|\\mathbf{t}_i\\|$. While simple, this method is known to exacerbate instabilities (kinks) in the path.\n\n- **Adaptive Tangent (Henkelman-Jónsson style)**: This more sophisticated scheme adjusts the tangent direction based on the energy landscape along the path. Let $E_j = V_{\\varepsilon}(\\mathbf{R}_j)$ be the energy of image $j$. The tangent is chosen as follows:\n  - If the path is monotonically increasing in energy around image $i$ (i.e., $E_{i-1}  E_i  E_{i+1}$), the tangent points forward: $\\mathbf{t}_i^{\\text{adapt}} = \\mathbf{R}_{i+1} - \\mathbf{R}_i$.\n  - If the path is monotonically decreasing (i.e., $E_{i-1}  E_i  E_{i+1}$), the tangent points in the uphill direction, which is backward: $\\mathbf{t}_i^{\\text{adapt}} = \\mathbf{R}_i - \\mathbf{R}_{i-1}$.\n  - Otherwise (image $i$ is at a local energy extremum along the path), the tangent points away from the neighbor with the closer energy. Let $\\Delta E^{+} = E_{i+1} - E_i$ and $\\Delta E^{-} = E_i - E_{i-1}$. The direction is chosen along $\\mathbf{R}_{i+1} - \\mathbf{R}_i$ if $|\\Delta E^{+}| \\geq |\\Delta E^{-}|$ and along $\\mathbf{R}_i - \\mathbf{R}_{i-1}$ if $|\\Delta E^{-}|  |\\Delta E^{+}|$.\n  Again, the chosen vector $\\mathbf{t}_i^{\\text{adapt}}$ is normalized to get $\\boldsymbol{\\tau}_i$.\n\n**4. Perpendicular Force and Evaluation Metric**\n\nThe NEB method aims to relax the images by driving the component of the physical force perpendicular to the path to zero. This perpendicular force component at image $i$ is calculated by projecting out the component parallel to the tangent:\n$$ \\mathbf{F}_{\\perp,i} = \\mathbf{F}_i - (\\mathbf{F}_i \\cdot \\boldsymbol{\\tau}_i)\\boldsymbol{\\tau}_i $$\nThe magnitude of this vector, $\\|\\mathbf{F}_{\\perp,i}\\|$, indicates how far the image is from the ideal path locally. The overall \"kinkiness\" of the path is measured by the maximum of these magnitudes over all internal images:\n$$ F_{\\perp}^{\\max} = \\max_{i=1, \\dots, N-2} \\|\\mathbf{F}_{\\perp,i}\\|_2 $$\n\n**5. Algorithmic Implementation and Test Cases**\n\nThe program will systematically compute $F_{\\perp}^{\\max}$ for the three groups of test parameters provided. For each group, it will:\n1. Generate the set of $N$ images based on the specified $A$ and $\\alpha$.\n2. Calculate the required $F_{\\perp}^{\\max}$ values by applying the corresponding potential (unsmoothed $\\varepsilon=0$ or smoothed $\\varepsilon0$) and tangent scheme ('naive' or 'adaptive').\n3. For groups 1 and 2, calculate the reduction ratios $r = F_{\\perp,\\text{baseline}}^{\\max} / F_{\\perp,\\text{improved}}^{\\max}$, where the baseline is the naive tangent on the unsmoothed potential.\n\nThe final code will implement helper functions for the potential, force, and image generation, and a main calculation function that evaluates all specified quantities and formats the output as a single comma-separated list.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the NEB perpendicular force calculations for all test groups.\n    \"\"\"\n\n    def potential_energy(R, k_y, epsilon):\n        \"\"\"Calculates the potential energy V(x,y) for a given image.\"\"\"\n        x, y = R\n        if epsilon == 0.0:\n            # Unsmoothed cusp potential\n            v_x = np.abs(x)\n        else:\n            # Smoothed cusp potential\n            v_x = np.sqrt(x**2 + epsilon**2)\n        return v_x + 0.5 * k_y * y**2\n\n    def physical_force(R, k_y, epsilon):\n        \"\"\"Calculates the physical force F = -grad(V) on a given image.\"\"\"\n        x, y = R\n        if epsilon == 0.0:\n            # Force from unsmoothed potential. np.sign(0) correctly returns 0.\n            dV_dx = np.sign(x)\n        else:\n            # Force from smoothed potential. Denominator is safe since epsilon  0.\n            dV_dx = x / np.sqrt(x**2 + epsilon**2)\n        \n        dV_dy = k_y * y\n        return np.array([-dV_dx, -dV_dy])\n\n    def generate_images(N, A, alpha):\n        \"\"\"Generates the coordinates of the N images along the zig-zag path.\"\"\"\n        images = np.zeros((N, 2))\n        x_coords = np.linspace(-1.0, 1.0, N)\n        images[:, 0] = x_coords\n\n        # Internal images (i=1 to N-2) have a zig-zag displacement.\n        # Endpoints (i=0, N-1) have y=0 as per initialization.\n        for i in range(1, N - 1):\n            x_i = x_coords[i]\n            images[i, 1] = A * ((-1)**i) * np.exp(-alpha * np.abs(x_i))\n            \n        return images\n\n    def calculate_f_perp_max(images, k_y, epsilon, tangent_scheme):\n        \"\"\"\n        Calculates the maximum perpendicular force component F_perp^max.\n        \"\"\"\n        N = len(images)\n        f_perp_magnitudes = []\n\n        for i in range(1, N - 1):  # Iterate over internal images only\n            R_im1, R_i, R_ip1 = images[i-1], images[i], images[i+1]\n\n            # Step 1: Calculate the tangent vector based on the specified scheme\n            if tangent_scheme == 'naive':\n                tangent_vec = R_ip1 - R_im1\n            elif tangent_scheme == 'adaptive':\n                E_im1 = potential_energy(R_im1, k_y, epsilon)\n                E_i = potential_energy(R_i, k_y, epsilon)\n                E_ip1 = potential_energy(R_ip1, k_y, epsilon)\n                \n                dE_plus = E_ip1 - E_i\n                dE_minus = E_i - E_im1\n\n                if dE_plus > 0 and dE_minus > 0:\n                    tangent_vec = R_ip1 - R_i\n                elif dE_plus  0 and dE_minus  0:\n                    tangent_vec = R_i - R_im1\n                else: \n                    if np.abs(dE_minus) > np.abs(dE_plus):\n                        tangent_vec = R_i - R_im1\n                    else: # Default to forward for tie-break\n                        tangent_vec = R_ip1 - R_i\n            else:\n                raise ValueError(\"Unknown tangent scheme.\")\n\n            # Step 2: Normalize to get the unit tangent\n            norm = np.linalg.norm(tangent_vec)\n            tau_i = tangent_vec / norm if norm > 0 else np.zeros_like(tangent_vec)\n\n            # Step 3: Calculate the physical force\n            F_i = physical_force(R_i, k_y, epsilon)\n\n            # Step 4: Calculate the perpendicular component of the force\n            F_parallel_mag = np.dot(F_i, tau_i)\n            F_perp_i = F_i - F_parallel_mag * tau_i\n            \n            f_perp_magnitudes.append(np.linalg.norm(F_perp_i))\n\n        return max(f_perp_magnitudes) if f_perp_magnitudes else 0.0\n\n    all_results = []\n\n    # --- Group 1: Moderate cusp and zig-zag ---\n    N, A, alpha, k_y, eps_sm = 21, 0.2, 2.0, 2.0, 0.05\n    eps_unsm = 0.0\n    images_g1 = generate_images(N, A, alpha)\n\n    f_naive_unsm_g1 = calculate_f_perp_max(images_g1, k_y, eps_unsm, 'naive')\n    f_adapt_unsm_g1 = calculate_f_perp_max(images_g1, k_y, eps_unsm, 'adaptive')\n    r_adapt_g1 = f_naive_unsm_g1 / f_adapt_unsm_g1\n    f_naive_sm_g1 = calculate_f_perp_max(images_g1, k_y, eps_sm, 'naive')\n    r_sm_g1 = f_naive_unsm_g1 / f_naive_sm_g1\n    all_results.extend([f_naive_unsm_g1, f_adapt_unsm_g1, r_adapt_g1, f_naive_sm_g1, r_sm_g1])\n\n    # --- Group 2: Sharper cusp ---\n    N, A, alpha, k_y, eps_sm = 21, 0.2, 1.5, 10.0, 0.1\n    images_g2 = generate_images(N, A, alpha)\n\n    f_naive_unsm_g2 = calculate_f_perp_max(images_g2, k_y, eps_unsm, 'naive')\n    f_adapt_unsm_g2 = calculate_f_perp_max(images_g2, k_y, eps_unsm, 'adaptive')\n    r_adapt_g2 = f_naive_unsm_g2 / f_adapt_unsm_g2\n    f_naive_sm_g2 = calculate_f_perp_max(images_g2, k_y, eps_sm, 'naive')\n    r_sm_g2 = f_naive_unsm_g2 / f_naive_sm_g2\n    all_results.extend([f_naive_unsm_g2, f_adapt_unsm_g2, r_adapt_g2, f_naive_sm_g2, r_sm_g2])\n\n    # --- Group 3: Minimal zig-zag ---\n    N, A, alpha, k_y = 21, 1e-6, 2.0, 2.0\n    images_g3 = generate_images(N, A, alpha)\n    \n    f_naive_unsm_g3 = calculate_f_perp_max(images_g3, k_y, eps_unsm, 'naive')\n    f_adapt_unsm_g3 = calculate_f_perp_max(images_g3, k_y, eps_unsm, 'adaptive')\n    r_adapt_g3 = f_naive_unsm_g3 / f_adapt_unsm_g3 if f_adapt_unsm_g3 > 0 else float('inf')\n    all_results.extend([f_naive_unsm_g3, f_adapt_unsm_g3, r_adapt_g3])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3471037"}]}