{"hands_on_practices": [{"introduction": "To begin our practical exploration, we tackle one of the hallmark predictions of mesoscopic physics: the quantization of conductance. This exercise connects the elementary quantum mechanical model of a 'particle in a box' to a measurable electrical property. By analyzing a two-dimensional electron gas confined to a narrow wire, you will derive firsthand how spatial confinement leads to discrete transverse modes, each acting as a distinct channel for electron flow [@problem_id:3494260]. This practice provides a concrete foundation for understanding the Landauer formula, where the total conductance is determined by simply counting the number of these 'open' channels at the Fermi energy.", "problem": "Consider a two-dimensional electron gas (2DEG) confined to a straight, uniform quantum wire of width $W$ along the transverse $y$-direction, with hard-wall boundaries at $y=0$ and $y=W$ such that the single-particle wavefunction vanishes at the boundaries. The longitudinal direction $x$ is assumed to be much longer than $W$, and the transport is phase-coherent and ballistic. The system is contacted adiabatically by macroscopic reservoirs that maintain a small electrochemical potential difference, and the temperature is effectively zero so that only states at the Fermi energy contribute. The 2DEG has a circular Fermi surface of radius $k_{F}$ in wavevector space. Assume that there is no valley degeneracy and that the spin degeneracy is two. Also assume that each open transverse mode has unit transmission probability in the ballistic limit.\n\nStarting from the transverse confinement boundary conditions and the definition of the Fermi surface, derive a closed-form analytic expression for the number of open propagating modes $N$ at the Fermi energy. Then, using the appropriate two-terminal expression for the ballistic conductance in terms of the sum of transmission probabilities over open modes, determine the corresponding linear-response conductance $G$.\n\nYour final answer should be a single row matrix containing both $N$ (dimensionless) and $G$ (expressed in siemens, S) as analytic expressions in terms of $k_{F}$, $W$, and fundamental constants. No numerical evaluation is required.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **System**: A two-dimensional electron gas (2DEG) confined to a straight, uniform quantum wire.\n- **Geometry**: The wire has width $W$ along the transverse $y$-direction and is much longer in the longitudinal $x$-direction.\n- **Boundary Conditions**: Hard-wall boundaries are imposed at $y=0$ and $y=W$, meaning the single-particle wavefunction vanishes at these boundaries.\n- **Transport Regime**: Transport is phase-coherent and ballistic.\n- **Contacts**: The system is connected to macroscopic reservoirs that maintain a small electrochemical potential difference.\n- **Temperature**: The temperature is effectively zero ($T=0$), so only states at the Fermi energy, $E_F$, contribute to transport.\n- **Fermi Surface**: The 2DEG has a circular Fermi surface of radius $k_F$ in wavevector space.\n- **Degeneracy**: Spin degeneracy is two ($2$); no valley degeneracy.\n- **Transmission**: Each open transverse mode has a transmission probability of unity ($1$).\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded (Critical)**: The problem is a standard, fundamental model in mesoscopic physics. It describes ballistic transport in a quantum wire, a concept firmly rooted in quantum mechanics and the Landauer-Büttiker formalism. All premises are scientifically sound.\n- **Well-Posed**: The problem is well-posed. It provides all necessary information—boundary conditions, transport regime, degeneracy, and transmission properties—to uniquely determine the number of modes and the conductance. The assumption of zero temperature and ballistic transport with unit transmission provides a clear, idealized limit that is standard for such problems.\n- **Objective (Critical)**: The language is precise, quantitative, and free from subjective or ambiguous terminology.\n- **Check for Flaws**:\n  1. **Scientific/Factual Unsoundness**: None. The model is a cornerstone of quantum transport theory.\n  2. **Non-Formalizable/Irrelevant**: None. The problem is a direct and formalizable application of quantum mechanics to condensed matter physics.\n  3. **Incomplete/Contradictory Setup**: None. The givens are self-contained and consistent.\n  4. **Unrealistic/Infeasible**: The assumptions (e.g., $T=0$, perfectly ballistic transport) are idealizations, but they are standard and physically meaningful approximations for clean systems at low temperatures.\n  5. **Ill-Posed/Poorly Structured**: None. The question leads to a unique, stable, and meaningful solution.\n  6. **Pseudo-Profound/Trivial**: None. The problem requires a solid understanding of quantum confinement and the Landauer formula, representing a core concept rather than a trivial exercise.\n  7. **Outside Scientific Verifiability**: None. The derivations are based on verifiable principles of quantum mechanics.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe problem requires the derivation of two quantities: the number of open propagating modes, $N$, and the corresponding linear-response conductance, $G$.\n\n**Part 1: Derivation of the Number of Open Modes ($N$)**\n\nThe electron motion is confined in the $y$-direction and free in the $x$-direction. The single-particle Schrödinger equation for an electron with effective mass $m^*$ is separable. The wavefunction can be written as $\\Psi(x, y) = \\phi(y) \\exp(i k_x x)$, where $k_x$ is the longitudinal wavevector.\n\nThe confinement in the $y$-direction is described by a one-dimensional \"particle in a box\" problem with hard-wall boundary conditions at $y=0$ and $y=W$. The transverse wavefunction $\\phi(y)$ must satisfy $\\phi(0) = 0$ and $\\phi(W) = 0$. The solutions are standing waves of the form:\n$$\n\\phi_n(y) = \\sqrt{\\frac{2}{W}} \\sin(k_y y)\n$$\nwhere the transverse wavevector $k_y$ is quantized to satisfy the boundary conditions:\n$$\nk_{y,n} = \\frac{n \\pi}{W}, \\quad \\text{for } n = 1, 2, 3, \\dots\n$$\nEach integer $n$ corresponds to a transverse mode, or \"subband\". The energy associated with this transverse motion is also quantized:\n$$\nE_n = \\frac{\\hbar^2 k_{y,n}^2}{2m^*} = \\frac{\\hbar^2 \\pi^2 n^2}{2m^* W^2}\n$$\nThe total energy of an electron in subband $n$ with longitudinal wavevector $k_x$ is the sum of the transverse confinement energy and the longitudinal kinetic energy:\n$$\nE(k_x, n) = \\frac{\\hbar^2 k_x^2}{2m^*} + E_n = \\frac{\\hbar^2 k_x^2}{2m^*} + \\frac{\\hbar^2 \\pi^2 n^2}{2m^* W^2}\n$$\nThe problem states that transport occurs at the Fermi energy, $E_F$. The Fermi energy is defined by the radius of the 2D Fermi circle, $k_F$, before confinement:\n$$\nE_F = \\frac{\\hbar^2 k_F^2}{2m^*}\n$$\nA subband $n$ is considered \"open\" or \"propagating\" if there are available states in that subband at the Fermi energy. This means there must be a real solution for $k_x$ when $E(k_x, n) = E_F$. This requires the longitudinal kinetic energy to be non-negative:\n$$\n\\frac{\\hbar^2 k_x^2}{2m^*} = E_F - E_n \\ge 0 \\implies E_F \\ge E_n\n$$\nSubstituting the expressions for $E_F$ and $E_n$:\n$$\n\\frac{\\hbar^2 k_F^2}{2m^*} \\ge \\frac{\\hbar^2 \\pi^2 n^2}{2m^* W^2}\n$$\nCanceling common terms ($\\hbar^2 / (2m^*)$), we obtain the condition on the allowed subband indices $n$:\n$$\nk_F^2 \\ge \\frac{n^2 \\pi^2}{W^2}\n$$\nSince $k_F$, $n$, and $W$ are positive, we can take the square root of both sides:\n$$\nk_F \\ge \\frac{n \\pi}{W} \\implies n \\le \\frac{k_F W}{\\pi}\n$$\nThe number of open propagating modes, $N$, is the total number of positive integers $n$ that satisfy this inequality. This is given by the floor function of the upper bound:\n$$\nN = \\left\\lfloor \\frac{k_F W}{\\pi} \\right\\rfloor\n$$\n\n**Part 2: Derivation of the Conductance ($G$)**\n\nThe linear-response conductance $G$ for a two-terminal device is given by the Landauer-Büttiker formula. For a system with spin degeneracy, the formula is:\n$$\nG = \\frac{2e^2}{h} T_{\\text{total}}\n$$\nwhere $e$ is the elementary charge, $h$ is Planck's constant, the factor of $2$ accounts for the given spin degeneracy, and $T_{\\text{total}}$ is the total transmission probability across the device at the Fermi energy.\n\nThe total transmission probability is the sum of the transmission probabilities $T_n$ over all available channels. The channels are the open propagating modes we identified.\n$$\nT_{\\text{total}} = \\sum_{n=1}^{N} T_n\n$$\nThe problem states that the transport is ballistic and that \"each open transverse mode has unit transmission probability\". Therefore, for each of the $N$ open modes, $T_n = 1$.\nThe total transmission is then simply the number of open modes:\n$$\nT_{\\text{total}} = \\sum_{n=1}^{N} 1 = N\n$$\nSubstituting this result into the Landauer formula for conductance gives:\n$$\nG = \\frac{2e^2}{h} N\n$$\nFinally, by substituting the expression for $N$ derived in the first part, we obtain the final expression for the conductance:\n$$\nG = \\frac{2e^2}{h} \\left\\lfloor \\frac{k_F W}{\\pi} \\right\\rfloor\n$$\n\nThe two required quantities are $N$ and $G$. In a row matrix, they are presented as $(\\begin{matrix} N  G \\end{matrix})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left\\lfloor \\frac{k_F W}{\\pi} \\right\\rfloor  \\frac{2e^2}{h} \\left\\lfloor \\frac{k_F W}{\\pi} \\right\\rfloor\n\\end{pmatrix}\n}\n$$", "id": "3494260"}, {"introduction": "Moving beyond ideal conductors, we now examine transport through a nanostructure with a discrete internal energy level, a scenario typical for quantum dots or molecular junctions. This problem introduces the Breit-Wigner formula, which describes the energy-dependent transmission through a resonant level, and explores how an applied bias can shift this level's energy [@problem_id:3494316]. By deriving the full current-voltage characteristic, you will uncover the conditions that give rise to negative differential conductance (NDC), a fascinating non-linear effect where current decreases as voltage increases, which is critical for designing novel electronic components like oscillators and switches.", "problem": "Consider a single, spin-degenerate resonant level in a phase-coherent two-terminal conductor, coupled to left and right wide-band electrodes. The level has an equilibrium energy $\\,\\epsilon_0\\,$ and is broadened by the electrode couplings $\\,\\Gamma_L\\,$ and $\\,\\Gamma_R\\,$, with total broadening $\\,\\Gamma=\\Gamma_L+\\Gamma_R\\,$. Assume zero temperature and elastic, ballistic transport. Under an applied bias $\\,V\\,$ with symmetric electrochemical potentials $\\,\\mu_L=+eV/2\\,$ and $\\,\\mu_R=-eV/2\\,$ (with $\\,e0\\,$ the elementary charge and the equilibrium Fermi energy taken as zero), the energy-dependent transmission is modeled by the Breit–Wigner form\n$$\nT(E,V)=\\frac{\\Gamma_L \\Gamma_R}{\\left[E-\\epsilon_0(V)\\right]^2+\\left(\\Gamma/2\\right)^2},\n$$\nwith a bias-induced level shift\n$$\n\\epsilon_0(V)=\\epsilon_0-\\alpha\\,eV,\n$$\nwhere $\\,\\alpha\\in[0,1]\\,$ is a capacitive division parameter describing how the local potential at the resonant level follows the applied bias.\n\nStarting from the Landauer–Büttiker (LB) expression for the current at zero temperature and using the assumptions above, derive a closed-form analytic expression for the current–voltage characteristic $\\,I(V)\\,$. Then, by differentiating your result with respect to $\\,V\\,$, analyze how the level shift encoded by $\\,\\alpha\\,$ can generate negative differential conductance, identifying the regime in which $\\,dI/dV0\\,$ can occur in terms of $\\,\\alpha\\,$ and the relative alignment of $\\,\\epsilon_0(V)\\,$ with $\\,\\mu_L\\,$ and $\\,\\mu_R\\,$.\n\nProvide the final result for $\\,I(V)\\,$ as a single closed-form expression in terms of $\\,e\\,$, $\\,h\\,$, $\\,\\Gamma_L\\,$, $\\,\\Gamma_R\\,$, $\\,\\Gamma\\,$, $\\,\\epsilon_0\\,$, $\\,\\alpha\\,$, and $\\,V\\,$. Do not substitute numerical values. You do not need to report units. The final answer must be a single analytic expression.", "solution": "The problem statement is validated as scientifically sound, well-posed, and self-contained.\n\n**Step 1: Extract Givens**\n\n*   **System**: A single, spin-degenerate resonant level in a two-terminal conductor.\n*   **Transport regime**: Phase-coherent, elastic, ballistic transport at zero temperature.\n*   **Electrodes**: Wide-band, with electrochemical potentials $\\mu_L = +eV/2$ and $\\mu_R = -eV/2$, where $e > 0$ is the elementary charge and the equilibrium Fermi energy is zero.\n*   **Resonant level**: Equilibrium energy $\\epsilon_0$, broadened by couplings $\\Gamma_L$ and $\\Gamma_R$. The total broadening is $\\Gamma = \\Gamma_L + \\Gamma_R$.\n*   **Transmission function**: A Breit–Wigner form, $T(E, V) = \\frac{\\Gamma_L \\Gamma_R}{[E - \\epsilon_0(V)]^2 + (\\Gamma/2)^2}$.\n*   **Bias-induced level shift**: The resonance energy depends on the applied bias $V$ as $\\epsilon_0(V) = \\epsilon_0 - \\alpha eV$, where $\\alpha \\in [0, 1]$ is a capacitive division parameter.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is a standard exercise in mesoscopic physics, specifically concerning the Landauer-Büttiker formalism applied to a resonant tunneling model.\n\n*   **Scientifically Grounded**: The Landauer-Büttiker formula, the Breit-Wigner transmission for a resonant level, and the concept of a bias-dependent level energy are all well-established principles in condensed matter and nanoelectronics. The setup is a cornerstone model for quantum dots and molecular junctions.\n*   **Well-Posed**: The problem asks for a derivation of the current-voltage characteristic and an analysis of a physical phenomenon (negative differential conductance) based on the provided model. This is a well-defined task with a unique solution derivable from the given premises.\n*   **Objective**: The language is precise and quantitative, free of any subjective or opinion-based statements.\n*   **Completeness**: All necessary functions, parameters, and conditions are provided to carry out the required derivation and analysis.\n\nThe problem is free of any of the invalidity flaws listed in the instructions. It is a valid, formalizable problem in theoretical physics.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Current-Voltage Characteristic $I(V)$**\n\nThe current $I$ through a two-terminal conductor is given by the Landauer-Büttiker formula. For a spin-degenerate channel at zero temperature ($T=0$), this is:\n$$\nI = \\frac{2e}{h} \\int_{-\\infty}^{\\infty} T(E) [f_L(E) - f_R(E)] dE\n$$\nwhere the factor of $2$ accounts for spin degeneracy, $e$ is the elementary charge, $h$ is Planck's constant, $T(E)$ is the energy-dependent transmission probability, and $f_{L/R}(E)$ are the Fermi-Dirac distributions in the left/right electrodes.\n\nAt zero temperature, the Fermi-Dirac distributions are step functions: $f(E) = \\theta(\\mu - E)$, where $\\theta(x)$ is the Heaviside step function. Given the electrochemical potentials $\\mu_L = +eV/2$ and $\\mu_R = -eV/2$, the difference in the Fermi functions is:\n$$\nf_L(E) - f_R(E) = \\theta(eV/2 - E) - \\theta(-eV/2 - E) =\n\\begin{cases}\n1  \\text{for } -eV/2 \\le E \\le +eV/2 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe integration for the current is therefore restricted to the energy window between $\\mu_R$ and $\\mu_L$, known as the bias window.\n$$\nI(V) = \\frac{2e}{h} \\int_{-eV/2}^{+eV/2} T(E,V) dE\n$$\nWe substitute the given Breit-Wigner transmission function, which includes the bias-dependent level shift $\\epsilon_0(V) = \\epsilon_0 - \\alpha eV$:\n$$\nI(V) = \\frac{2e}{h} \\int_{-eV/2}^{+eV/2} \\frac{\\Gamma_L \\Gamma_R}{[E - (\\epsilon_0 - \\alpha eV)]^2 + (\\Gamma/2)^2} dE\n$$\nThis is a standard integral. Let $u = E - (\\epsilon_0 - \\alpha eV)$, so $du = dE$. The limits of integration for $u$ are:\nUpper limit: $u_{upper} = +eV/2 - (\\epsilon_0 - \\alpha eV) = eV(\\alpha + 1/2) - \\epsilon_0$\nLower limit: $u_{lower} = -eV/2 - (\\epsilon_0 - \\alpha eV) = eV(\\alpha - 1/2) - \\epsilon_0$\n\nThe integral becomes:\n$$\n\\int \\frac{\\Gamma_L \\Gamma_R}{u^2 + (\\Gamma/2)^2} du = \\Gamma_L \\Gamma_R \\left[ \\frac{1}{\\Gamma/2} \\arctan\\left(\\frac{u}{\\Gamma/2}\\right) \\right] = \\frac{2\\Gamma_L \\Gamma_R}{\\Gamma} \\arctan\\left(\\frac{2u}{\\Gamma}\\right)\n$$\nEvaluating the definite integral from $u_{lower}$ to $u_{upper}$:\n$$\nI(V) = \\frac{2e}{h} \\left[ \\frac{2\\Gamma_L \\Gamma_R}{\\Gamma} \\arctan\\left(\\frac{2u}{\\Gamma}\\right) \\right]_{u_{lower}}^{u_{upper}}\n$$\n$$\nI(V) = \\frac{4e\\Gamma_L \\Gamma_R}{h\\Gamma} \\left[ \\arctan\\left(\\frac{2u_{upper}}{\\Gamma}\\right) - \\arctan\\left(\\frac{2u_{lower}}{\\Gamma}\\right) \\right]\n$$\nSubstituting the expressions for $u_{upper}$ and $u_{lower}$:\n$$\nI(V) = \\frac{4e\\Gamma_L \\Gamma_R}{h\\Gamma} \\left[ \\arctan\\left(\\frac{2}{\\Gamma}\\left(eV\\left(\\alpha + \\frac{1}{2}\\right) - \\epsilon_0\\right)\\right) - \\arctan\\left(\\frac{2}{\\Gamma}\\left(eV\\left(\\alpha - \\frac{1}{2}\\right) - \\epsilon_0\\right)\\right) \\right]\n$$\nThis is the closed-form analytic expression for the current-voltage characteristic $I(V)$.\n\n**Analysis of Negative Differential Conductance (NDC)**\n\nTo analyze NDC, we must compute the differential conductance $G(V) = dI/dV$ and find the conditions under which it becomes negative. We differentiate the expression for $I(V)$ with respect to $V$. Using the chain rule $\\frac{d}{dx}\\arctan(f(x)) = \\frac{f'(x)}{1+f(x)^2}$:\nLet $C = \\frac{4e\\Gamma_L \\Gamma_R}{h\\Gamma}$.\nLet $A_1(V) = \\frac{2}{\\Gamma}(eV(\\alpha + \\frac{1}{2}) - \\epsilon_0)$ and $A_2(V) = \\frac{2}{\\Gamma}(eV(\\alpha - \\frac{1}{2}) - \\epsilon_0)$.\nThen $I(V) = C[\\arctan(A_1(V)) - \\arctan(A_2(V))]$.\nThe derivatives of $A_1$ and $A_2$ are:\n$\\frac{dA_1}{dV} = \\frac{2e}{\\Gamma}(\\alpha + \\frac{1}{2})$ and $\\frac{dA_2}{dV} = \\frac{2e}{\\Gamma}(\\alpha - \\frac{1}{2})$.\nThe differential conductance is:\n$$\nG(V) = \\frac{dI}{dV} = C \\left[ \\frac{1}{1+A_1(V)^2}\\frac{dA_1}{dV} - \\frac{1}{1+A_2(V)^2}\\frac{dA_2}{dV} \\right]\n$$\n$$\nG(V) = \\frac{4e\\Gamma_L \\Gamma_R}{h\\Gamma} \\left[ \\frac{1}{1+A_1(V)^2} \\frac{2e}{\\Gamma}\\left(\\alpha + \\frac{1}{2}\\right) - \\frac{1}{1+A_2(V)^2} \\frac{2e}{\\Gamma}\\left(\\alpha - \\frac{1}{2}\\right) \\right]\n$$\nWe can relate the terms $\\frac{1}{1+A^2}$ back to the transmission function $T(E, V)$. Note that:\n$A_1(V)$ is the argument of the arctan related to the upper integration limit, $E = \\mu_L = +eV/2$.\n$A_2(V)$ is the argument related to the lower integration limit, $E = \\mu_R = -eV/2$.\nThe quantity $1 + A(V)^2$ evaluated at $E=\\mu_{L,R}$ is:\n$$\n1 + \\left(\\frac{2}{\\Gamma}(E - \\epsilon_0(V))\\right)^2 = 1 + \\frac{(E - \\epsilon_0(V))^2}{(\\Gamma/2)^2} = \\frac{(\\Gamma/2)^2 + (E - \\epsilon_0(V))^2}{(\\Gamma/2)^2} = \\frac{\\Gamma_L\\Gamma_R / T(E,V)}{(\\Gamma/2)^2}\n$$\nSo, $\\frac{1}{1+A(V)^2} = \\frac{(\\Gamma/2)^2}{\\Gamma_L\\Gamma_R} T(E,V)$.\nSubstituting this into the expression for $G(V)$:\n$$\nG(V) = \\frac{8e^2\\Gamma_L \\Gamma_R}{h\\Gamma^2} \\left[ \\frac{(\\Gamma/2)^2}{\\Gamma_L\\Gamma_R} T(\\mu_L, V) \\left(\\alpha + \\frac{1}{2}\\right) - \\frac{(\\Gamma/2)^2}{\\Gamma_L\\Gamma_R} T(\\mu_R, V) \\left(\\alpha - \\frac{1}{2}\\right) \\right]\n$$\nSimplifying the expression yields:\n$$\nG(V) = \\frac{2e^2}{h} \\left[ \\left(\\alpha + \\frac{1}{2}\\right) T(\\mu_L, V) - \\left(\\alpha - \\frac{1}{2}\\right) T(\\mu_R, V) \\right]\n$$\nFor negative differential conductance, we require $G(V)  0$:\n$$\n\\left(\\alpha + \\frac{1}{2}\\right) T(\\mu_L, V)  \\left(\\alpha - \\frac{1}{2}\\right) T(\\mu_R, V)\n$$\nLet's analyze this inequality. The transmission functions $T(E,V)$ are always non-negative.\nThe parameter $\\alpha$ is in the range $[0, 1]$.\n\nCase 1: $\\alpha \\in [0, 1/2]$. In this case, $(\\alpha + 1/2)  0$ and $(\\alpha - 1/2) \\le 0$. The inequality becomes $(\\text{positive number})  (\\text{non-positive number})$, which is impossible. Thus, NDC cannot occur for $\\alpha \\le 1/2$.\n\nCase 2: $\\alpha \\in (1/2, 1]$. In this case, both $(\\alpha + 1/2)$ and $(\\alpha - 1/2)$ are positive. The condition for NDC is:\n$$\n\\frac{T(\\mu_L, V)}{T(\\mu_R, V)}  \\frac{\\alpha - 1/2}{\\alpha + 1/2}\n$$\nSince $\\alpha  1/2$, the right-hand side is a positive number less than $1$. This condition requires that the transmission at the upper edge of the bias window, $T(\\mu_L, V)$, must be significantly smaller than the transmission at the lower edge, $T(\\mu_R, V)$.\n\nThe physical interpretation relates to the alignment of the resonance $\\epsilon_0(V)$ with the chemical potentials. The transmission $T(E,V)$ is a Lorentzian function of energy $E$ centered at $\\epsilon_0(V)$. It is maximum when $E = \\epsilon_0(V)$. The condition $T(\\mu_L, V)  T(\\mu_R, V)$ implies that the level $\\epsilon_0(V)$ must be closer in energy to $\\mu_R$ than to $\\mu_L$:\n$$\n|\\epsilon_0(V) - \\mu_R|  |\\epsilon_0(V) - \\mu_L|\n$$\nSubstituting the definitions $\\epsilon_0(V) = \\epsilon_0 - \\alpha eV$, $\\mu_R = -eV/2$, and $\\mu_L = +eV/2$:\n$$\n|\\epsilon_0 - \\alpha eV - (-eV/2)|  |\\epsilon_0 - \\alpha eV - (eV/2)|\n$$\n$$\n|\\epsilon_0 - eV(\\alpha - 1/2)|  |\\epsilon_0 - eV(\\alpha + 1/2)|\n$$\nThis inequality holds if and only if $\\epsilon_0 - \\alpha eV  0$, assuming $V>0$.\nThis means the shifted resonance $\\epsilon_0(V)$ must be pulled below the equilibrium Fermi energy (set to $0$).\n\nIn summary, the regime for NDC is:\n1.  A strong capacitive coupling, $\\alpha  1/2$, is necessary. This ensures that the resonance level shifts down with bias $V$ faster than the lower chemical potential $\\mu_R = -eV/2$.\n2.  The bias voltage must be large enough such that the resonance is pulled closer to $\\mu_R$ than to $\\mu_L$, which causes $T(\\mu_R, V)  T(\\mu_L, V)$.\n3.  Specifically, NDC occurs when the resonance is aligned sufficiently asymmetrically within the bias window to satisfy $\\frac{T(\\mu_L, V)}{T(\\mu_R, V)}  \\frac{\\alpha - 1/2}{\\alpha + 1/2}$. This typically happens when the voltage increases and pulls the resonance peak $\\epsilon_0(V)$ towards and past the lower edge of the bias window $\\mu_R$.", "answer": "$$\n\\boxed{\\frac{4e\\Gamma_L \\Gamma_R}{h\\Gamma} \\left[ \\arctan\\left(\\frac{2}{\\Gamma}\\left(eV\\left(\\alpha + \\frac{1}{2}\\right) - \\epsilon_0\\right)\\right) - \\arctan\\left(\\frac{2}{\\Gamma}\\left(eV\\left(\\alpha - \\frac{1}{2}\\right) - \\epsilon_0\\right)\\right) \\right]}\n$$", "id": "3494316"}, {"introduction": "Our final practice bridges the gap between analytical theory and practical, computational modeling—a core skill in modern materials science. We will implement the Landauer-Büttiker formalism within the powerful Non-Equilibrium Green's Function (NEGF) framework to simulate a tight-binding device [@problem_id:3494317]. The central task is to correctly model the connection to infinite source and drain contacts using the concept of self-energies. By comparing the results from this rigorous approach with a naive 'finite-box' approximation, you will gain a hands-on appreciation for why proper open boundary conditions are essential for avoiding spurious interference and obtaining physically meaningful simulation results.", "problem": "You will model coherent ballistic transport across a one-dimensional tight-binding device using the Landauer–Büttiker formalism. The device is an array of $N_\\mathrm{d}$ sites with nearest-neighbor hopping and a single on-site barrier at its center. The left and right contacts are identical one-dimensional nearest-neighbor tight-binding leads. You must implement open boundary conditions for the device region using proper contact self-energies that represent semi-infinite leads, and compare the resulting energy-resolved transmission to an “improper” finite-box treatment in which each contact is represented by a finite chain abruptly terminated by a hard wall. You must then quantify the spurious interference introduced by the finite-box treatment.\n\nFundamental basis to use:\n- The device and leads are described within a one-electron nearest-neighbor tight-binding Hamiltonian with on-site energies and hopping between nearest neighbors.\n- The retarded Green’s function and self-energy concepts from Non-Equilibrium Green’s Function (NEGF) theory are to be used, and the transmission function must be computed from quantities defined within NEGF and Landauer–Büttiker theory, starting from the definition of the retarded Green’s function, the coupling-induced broadenings, and the linear-response transmission.\n\nSystem specification (tight-binding units; all quantities are dimensionless):\n- Device:\n  - Number of device sites: $N_\\mathrm{d} = 7$.\n  - Nearest-neighbor hopping magnitude: $t = 1$ (i.e., Hamiltonian off-diagonals are $-t$ between nearest neighbors).\n  - On-site energies: zero everywhere except the central site, which has a barrier $U = 0.5$.\n- Leads (left and right):\n  - Identical to the device lattice in hopping and on-site energy (zero on-site energy, nearest-neighbor hopping magnitude $t = 1$).\n  - Coupling between device and each lead end site has magnitude equal to the lead hopping, i.e., $t_\\mathrm{c} = 1$.\n- Energy grid:\n  - Use a uniform grid of $N_E = 401$ energies from $E_\\mathrm{min} = -1.8$ to $E_\\mathrm{max} = 1.8$, inclusive.\n- Numerical broadening:\n  - Use a positive infinitesimal in the retarded prescription implemented as a fixed small number $\\eta = 10^{-9}$.\n\nTwo boundary condition treatments:\n1) Proper open boundary condition:\n   - Represent each semi-infinite lead by a self-energy acting only on the edge site of the device. The surface Green’s function of the semi-infinite one-dimensional lead must be used to construct the retarded self-energies for the left and right contacts.\n\n2) Improper finite-box leads:\n   - Replace each semi-infinite lead by a finite chain of $N_\\mathrm{f}$ sites with the same tight-binding parameters, terminated by a hard wall at the far end. Use the surface Green’s function of this finite chain to construct an energy-dependent self-energy acting on the device end site. This “finite-box” self-energy approximates the true open boundary poorly for small $N_\\mathrm{f}$ and produces reflections and Fabry–Pérot-like interference in the transmission.\n\nTasks you must implement:\n- Build the device Hamiltonian for the specified $N_\\mathrm{d}$ and $U$.\n- For each energy $E$ on the grid, compute the retarded device Green’s function for case (1) using correct semi-infinite self-energies for left and right contacts, and calculate the energy-resolved coherent transmission $T_\\mathrm{open}(E)$.\n- For each energy $E$ on the grid, compute the retarded device Green’s function for case (2) using finite-chain self-energies for four different finite chain lengths $N_\\mathrm{f}$, and calculate the corresponding $T_\\mathrm{box}(E; N_\\mathrm{f})$.\n- For each $N_\\mathrm{f}$ in the test suite below, quantify the spurious interference by computing two scalar diagnostics over the energy grid:\n  - The root-mean-square deviation $D_\\mathrm{rms}(N_\\mathrm{f})$ between $T_\\mathrm{box}(E; N_\\mathrm{f})$ and $T_\\mathrm{open}(E)$.\n  - The maximum absolute deviation $D_\\mathrm{max}(N_\\mathrm{f})$ between $T_\\mathrm{box}(E; N_\\mathrm{f})$ and $T_\\mathrm{open}(E)$.\n\nTest suite:\n- Use the following four finite-chain lengths for the improper finite-box lead model:\n  - $N_\\mathrm{f}^{(1)} = 200$ (near-converged reference for the finite approximation),\n  - $N_\\mathrm{f}^{(2)} = 40$,\n  - $N_\\mathrm{f}^{(3)} = 10$,\n  - $N_\\mathrm{f}^{(4)} = 3$.\n\nProgram requirements and final output:\n- Your program must compute $D_\\mathrm{rms}$ and $D_\\mathrm{max}$ for each of the four $N_\\mathrm{f}$ values.\n- Each result must be a pair of floats $[D_\\mathrm{rms}, D_\\mathrm{max}]$, each rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite and with each test case formatted as its own bracketed two-float list. For example: \"[[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\".\n- No physical units are involved; all quantities are dimensionless in the tight-binding convention used here.\n- Angles are not used.\n- The program must be self-contained and produce the output with no user input.\n\nNote: You must start from fundamental definitions of the retarded Green’s function, contact-induced self-energies, and the Landauer–Büttiker transmission in coherent, phase-preserving transport. You must not assume or use any pre-quoted “shortcut” formulas not derivable from these fundamentals within this context.", "solution": "The user wants to model ballistic quantum transport through a one-dimensional tight-binding device using the Non-Equilibrium Green's Function (NEGF) formalism, specifically within the Landauer-Büttiker framework. The core task is to compare two different treatments for the boundary conditions imposed by the contacts (leads): an exact treatment using semi-infinite leads and an approximate treatment using finite-sized leads (a \"finite box\"). The spurious interference introduced by the finite-box approximation must be quantified.\n\n### 1. Problem Validation\nThe problem statement is validated against the required criteria.\n\n**Step 1: Extract Givens**\n- **Device Model**: $N_\\mathrm{d} = 7$ sites, 1D tight-binding chain.\n- **Device Hamiltonian**: Nearest-neighbor hopping magnitude $t = 1$. On-site energies are zero, except for a barrier $U = 0.5$ at the central site.\n- **Leads**: Two identical semi-infinite 1D tight-binding chains (left and right).\n- **Leads Hamiltonian**: Nearest-neighbor hopping magnitude $t = 1$. On-site energies are zero.\n- **Device-Lead Coupling**: Hopping magnitude between the end of each lead and the corresponding end of the device is $t_\\mathrm{c} = 1$.\n- **Numerical Parameters**: Energy grid from $E_\\mathrm{min} = -1.8$ to $E_\\mathrm{max} = 1.8$ with $N_E = 401$ points. Retarded Green's function infinitesimal broadening $\\eta = 10^{-9}$.\n- **Boundary Condition Cases**:\n  1.  **Proper (Open)**: Leads are semi-infinite, modeled by an exact self-energy.\n  2.  **Improper (Finite-Box)**: Leads are finite chains of length $N_\\mathrm{f}$, modeled by a corresponding approximate self-energy.\n- **Task**: For each $N_\\mathrm{f}$ in the test suite $\\{200, 40, 10, 3\\}$, compute the root-mean-square deviation ($D_\\mathrm{rms}$) and maximum absolute deviation ($D_\\mathrm{max}$) between the transmission functions $T_\\mathrm{box}(E; N_\\mathrm{f})$ and $T_\\mathrm{open}(E)$.\n- **Output**: A list of $[D_\\mathrm{rms}, D_\\mathrm{max}]$ pairs, with values rounded to $6$ decimal places.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on standard, well-established principles of quantum transport theory (NEGF, Landauer-Büttiker formalism, tight-binding model). All aspects are scientifically sound.\n- **Well-Posed**: The problem is clearly defined with all necessary parameters provided. The objective is to perform a standard numerical experiment comparing two computational methods, for which a unique solution exists.\n- **Objective**: The language is precise and unbiased. All terms are standard in the field of computational condensed matter physics.\n- **Other Criteria**: The problem is formalizable, relevant to the topic, internally consistent, physically plausible (within a model context), and algorithmically solvable. It is a non-trivial problem that requires a correct implementation of the specified physical formalism.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A step-by-step solution will be developed.\n\n### 2. Principle-Based Solution Design\nThe solution is constructed following the fundamental principles of the NEGF formalism.\n\n**A. Device Hamiltonian ($H_\\mathrm{d}$)**\nThe device is a 1D chain of $N_\\mathrm{d} = 7$ sites. The Hamiltonian $H_\\mathrm{d}$ is a $7 \\times 7$ matrix. The matrix elements are $(H_\\mathrm{d})_{i,i} = \\epsilon_i$ and $(H_\\mathrm{d})_{i,i\\pm 1} = -t$. With $t=1$, the on-site energies $\\epsilon_i$ are $0$ everywhere except for the central site (index $3$ for $0$-based indexing), where $\\epsilon_3 = U = 0.5$.\n\n$$\nH_\\mathrm{d} = \\begin{pmatrix}\n0  -1  0  0  0  0  0 \\\\\n-1  0  -1  0  0  0  0 \\\\\n0  -1  0  -1  0  0  0 \\\\\n0  0  -1  0.5  -1  0  0 \\\\\n0  0  0  -1  0  -1  0 \\\\\n0  0  0  0  -1  0  -1 \\\\\n0  0  0  0  0  -1  0\n\\end{pmatrix}\n$$\n\n**B. Lead Self-Energy ($\\Sigma^R$)**\nThe effect of the semi-infinite leads is incorporated through a self-energy term $\\Sigma^R(E)$. For a lead coupled to a single device site, the self-energy is a matrix that is non-zero only at the element corresponding to that site. Here, the left lead couples to site $0$ and the right lead to site $N_\\mathrm{d}-1 = 6$.\nThe self-energy matrix element is given by $\\sigma(E) = t_\\mathrm{c}^2 g_s(E)$, where $g_s(E)$ is the surface Green's function of the isolated lead. The total self-energy is $\\Sigma^R = \\Sigma^R_L + \\Sigma^R_R$.\n\n1.  **Proper Self-Energy (Open Boundaries)**: For a semi-infinite 1D lead with hopping $t$, the surface Green's function $g_s(E)$ is the physical solution to the quadratic equation $t^2 g_s^2 - (E+i\\eta)g_s + 1 = 0$. The solution that ensures causality (retarded Green's function) and corresponds to outgoing waves is:\n    $$\n    g_s(E) = \\frac{(E+i\\eta) - \\sqrt{(E+i\\eta)^2 - 4t^2}}{2t^2}\n    $$\n    The complex square root must be handled carefully to select the correct physical branch, which depends on the sign of the energy $E$. Our implementation will correctly choose the branch that ensures $\\text{Im}[g_s(E)] \\le 0$. With $t=1$ and $t_c=1$, the self-energy matrix element becomes $\\sigma_\\mathrm{open}(E) = g_s(E)$.\n\n2.  **Improper Self-Energy (Finite-Box)**: For a lead approximated by a finite chain of $N_\\mathrm{f}$ sites, the surface Green's function is the $(0,0)$ element of the Green's function of that finite chain. This can be calculated efficiently using a continued fraction expansion derived from the recursive definition of the Green's function:\n    $$\n    g_1(E) = \\frac{1}{E+i\\eta}, \\quad g_n(E) = \\frac{1}{(E+i\\eta) - t^2 g_{n-1}(E)}\n    $$\n    We compute $g_{N_\\mathrm{f}}(E)$ iteratively. The self-energy element is then $\\sigma_\\mathrm{box}(E; N_\\mathrm{f}) = t_\\mathrm{c}^2 g_{N_\\mathrm{f}}(E)$.\n\n**C. Device Green's Function ($G^R$) and Transmission ($T(E)$)**\nThe retarded Green's function of the device, including the influence of the leads, is:\n$$\nG^R(E) = \\left[ (E+i\\eta)I - H_\\mathrm{d} - \\Sigma^R_L(E) - \\Sigma^R_R(E) \\right]^{-1}\n$$\nwhere $I$ is the identity matrix and $\\Sigma^R_{L/R}$ are the self-energy matrices for the left/right leads.\n\nThe transmission probability from the left to the right lead is given by the Landauer-Büttiker formula:\n$$\nT(E) = \\mathrm{Tr}\\left[ \\Gamma_R(E) G^R(E) \\Gamma_L(E) G^A(E) \\right]\n$$\nwhere $G^A(E) = [G^R(E)]^\\dagger$ is the advanced Green's function, and $\\Gamma_{L,R}(E)$ are the broadening matrices, defined as $\\Gamma_{L,R}(E) = i[\\Sigma^R_{L,R}(E) - \\Sigma^A_{L,R}(E)] = -2\\mathrm{Im}[\\Sigma^R_{L,R}(E)]$. For single-site coupling, this simplifies to the Fisher-Lee relation:\n$$\nT(E) = \\Gamma_L(E) \\Gamma_R(E) |G^R_{N_\\mathrm{d}-1, 0}(E)|^2\n$$\nwhere $\\Gamma_{L,R}$ are the scalar broadening values at the coupling sites, and $G^R_{N_\\mathrm{d}-1, 0}$ is the matrix element of the device Green's function connecting the first and last sites.\n\n**D. Algorithm**\n1.  Construct the device Hamiltonian $H_\\mathrm{d}$.\n2.  Define the energy grid.\n3.  Calculate the benchmark transmission array $T_\\mathrm{open}(E)$ by iterating over the energy grid. In each step, compute $\\sigma_\\mathrm{open}(E)$, then $G^R(E)$, and finally $T_\\mathrm{open}(E)$.\n4.  For each finite length $N_\\mathrm{f}$ in the test suite:\n    a. Calculate the transmission array $T_\\mathrm{box}(E; N_\\mathrm{f})$ similarly, using $\\sigma_\\mathrm{box}(E; N_\\mathrm{f})$.\n    b. Compute the Root-Mean-Square Deviation: $D_\\mathrm{rms}(N_\\mathrm{f}) = \\sqrt{\\frac{1}{N_E} \\sum_{i} [T_\\mathrm{box}(E_i; N_\\mathrm{f}) - T_\\mathrm{open}(E_i)]^2}$.\n    c. Compute the Maximum Absolute Deviation: $D_\\mathrm{max}(N_\\mathrm{f}) = \\max_i |T_\\mathrm{box}(E_i; N_\\mathrm{f}) - T_\\mathrm{open}(E_i)|$.\n5.  Collect and format the results $[D_\\mathrm{rms}, D_\\mathrm{max}]$ for each $N_\\mathrm{f}$ as specified.\n\nThis systematic procedure ensures that the solution is built from first principles and correctly implements the required physics.", "answer": "```python\n# The final answer must be a single, complete, standalone program.\n# Execution Environment: Python 3.12, numpy 1.23.5\n\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Models ballistic transport in a 1D tight-binding device using NEGF,\n    comparing proper open boundary conditions with improper finite-box leads.\n    \"\"\"\n    # --- System and Simulation Parameters ---\n    # These are the dimensionless parameters given in the problem statement.\n    Nd = 7         # Number of sites in the device\n    t = 1.0        # Nearest-neighbor hopping magnitude\n    U = 0.5        # On-site barrier potential at the center\n    tc = 1.0       # Hopping between device and leads\n    eta = 1e-9     # Infinitesimal for retarded Green's function\n\n    # Energy grid for transmission calculation\n    E_min, E_max, NE = -1.8, 1.8, 401\n    E_grid = np.linspace(E_min, E_max, NE)\n\n    # Test suite for the lengths of the \"finite-box\" leads\n    test_cases = [200, 40, 10, 3]\n\n    # --- Hamiltonian Construction ---\n    # The device Hamiltonian H_d is an Nd x Nd matrix. It is tridiagonal\n    # with on-site energies on the diagonal and -t on the off-diagonals.\n    H_d = np.zeros((Nd, Nd))\n    for i in range(Nd - 1):\n        H_d[i, i + 1] = -t\n        H_d[i + 1, i] = -t\n    \n    # The central site has an additional on-site potential U.\n    # For a 0-indexed array of length 7, the center is at index 3.\n    center_idx = Nd // 2\n    H_d[center_idx, center_idx] = U\n\n    # --- Self-Energy Functions ---\n    # The self-energy accounts for the effect of the semi-infinite leads\n    # on the device. It is constructed from the surface Green's function (g_s)\n    # of the lead. The self-energy element is sigma = tc^2 * g_s.\n\n    def get_sigma_open(E, Z):\n        \"\"\"\n        Calculates the self-energy for a semi-infinite lead. The surface\n        Green's function g_s is found from the quadratic equation that arises\n        from its recursive definition: t^2*g_s^2 - Z*g_s + 1 = 0.\n        The physical solution (retarded) is chosen by ensuring its imaginary\n        part is non-positive. This requires selecting the correct branch of the\n        complex square root.\n        \"\"\"\n        # Ensure correct branch cut for the complex square root.\n        # numpy's sqrt function on a complex number chooses the branch with a non-negative real part.\n        sqrt_term = np.sqrt(Z**2 - 4 * t**2)\n        \n        # The correct physical solution corresponds to the root that vanishes at large |Z|.\n        # This choice depends on the sign of the real part of Z (i.e., E).\n        if E >= 0:\n            sigma_val = (Z - sqrt_term) / (2 * t**2)\n        else:\n            sigma_val = (Z + sqrt_term) / (2 * t**2)\n        \n        return tc**2 * sigma_val\n\n    def get_sigma_box(E, Z, Nf):\n        \"\"\"\n        Calculates the self-energy for a finite lead of length Nf.\n        The surface Green's function is calculated iteratively using the\n        recursive relation g_n = 1 / (Z - t^2 * g_{n-1}), starting from g_1=1/Z.\n        \"\"\"\n        g = 1.0 / Z  # This is g_1 for an isolated site\n        for _ in range(Nf - 1):\n            g = 1.0 / (Z - (t**2) * g)\n            \n        return tc**2 * g\n\n    # --- Transmission Calculation Routine ---\n    def calculate_transmission(E_grid, H_d, eta, get_sigma_func):\n        \"\"\"\n        Calculates the transmission T(E) over a grid of energies.\n        \"\"\"\n        Nd_local = H_d.shape[0]\n        T_vals = np.zeros(len(E_grid))\n\n        for i, E in enumerate(E_grid):\n            Z = E + 1j * eta\n            \n            # Since leads are identical, sigma_L = sigma_R = sigma\n            sigma = get_sigma_func(E, Z)\n            \n            # Broadening functions Gamma = -2*Im(Sigma_R)\n            Gamma = -2 * np.imag(sigma)\n            \n            # Total retarded Green's function of the device: G_R = [Z*I - H_d - Sigma]^-1\n            M = Z * np.eye(Nd_local) - H_d\n            M[0, 0] -= sigma\n            M[Nd_local - 1, Nd_local - 1] -= sigma\n            \n            G_R = np.linalg.inv(M)\n            \n            # Fisher-Lee relation: T(E) = Gamma_L * Gamma_R * |G_R(Nd-1, 0)|^2\n            G_R_Nd0 = G_R[Nd_local - 1, 0]\n            T_E = Gamma * Gamma * np.abs(G_R_Nd0)**2\n            T_vals[i] = T_E\n            \n        return T_vals\n\n    # --- Main Calculation and Diagnostics ---\n    \n    # 1. Calculate the benchmark transmission T_open(E) using proper semi-infinite leads.\n    T_open = calculate_transmission(E_grid, H_d, eta, get_sigma_open)\n\n    results = []\n    # 2. For each finite-box length Nf, calculate T_box(E) and the deviations.\n    for Nf in test_cases:\n        get_sigma_func_box = lambda E, Z: get_sigma_box(E, Z, Nf)\n        T_box = calculate_transmission(E_grid, H_d, eta, get_sigma_func_box)\n        \n        # 3. Quantify spurious interference by computing deviation metrics.\n        diff = T_box - T_open\n        D_rms = np.sqrt(np.mean(diff**2))\n        D_max = np.max(np.abs(diff))\n        \n        results.append([round(D_rms, 6), round(D_max, 6)])\n\n    # --- Format and Print Final Output ---\n    output_str = '[' + ','.join([f\"[{r[0]},{r[1]}]\" for r in results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "3494317"}]}