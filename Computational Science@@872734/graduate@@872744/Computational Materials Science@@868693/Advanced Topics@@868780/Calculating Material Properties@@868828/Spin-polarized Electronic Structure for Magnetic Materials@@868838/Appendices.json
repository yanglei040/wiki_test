{"hands_on_practices": [{"introduction": "To understand magnetism in strongly correlated materials like transition metal oxides, we must first grasp how electron-electron interactions on a single atom give rise to local magnetic moments. This foundational exercise strips away the complexities of the crystal lattice to focus on the atomic limit of a correlated ion. By applying the Hubbard-Kanamori interaction Hamiltonian, you will derive from first principles how the interplay between on-site Coulomb repulsion ($U$) and Hund's exchange ($J$) not only stabilizes a high-spin state but also opens a Mott-Hubbard insulating gap, two of the most crucial phenomena in correlated electron physics. [@problem_id:3489189]", "problem": "Consider a minimal two-orbital tight-binding model for rocksalt nickel oxide (NiO) that captures the low-energy physics of the nickel ion in octahedral coordination. Nickel in NiO is nominally in the $d^{8}$ configuration, which, under an octahedral crystal field, splits into a filled $t_{2g}^{6}$ manifold and a partially filled $e_{g}^{2}$ manifold. In this minimal model, treat the $t_{2g}$ states as inert and model only the two degenerate $e_{g}$ orbitals on each nickel site. Assume a bipartite lattice and nearest-neighbor hopping that preserves orbital character, with hopping amplitude $t$ (you will not need the explicit band dispersion). The on-site electron-electron interaction in the $e_{g}$ subspace is described by the rotationally invariant Kanamori form, restricted to its density-density sector:\n$$\nH_{\\mathrm{int}} = U \\sum_{m} n_{m\\uparrow} n_{m\\downarrow} + U' \\sum_{m \\neq m'} n_{m\\uparrow} n_{m'\\downarrow} + (U' - J) \\sum_{m  m', \\sigma} n_{m\\sigma} n_{m'\\sigma},\n$$\nwhere $m \\in \\{a,b\\}$ labels the two $e_{g}$ orbitals, $U$ is the intraorbital Hubbard repulsion, $U'$ is the interorbital repulsion, $J$ is Hund's exchange, and the rotational invariance condition $U' = U - 2J$ holds. Neglect spin-flip and pair-hopping terms, and assume collinear antiferromagnetic order at zero temperature at half-filling of the $e_{g}$ sector (two electrons per nickel in $e_{g}$). Work in the strong-coupling atomic limit (set $t \\to 0$) so that the insulating gap is controlled by local many-body energetics.\n\nUsing only fundamental definitions and well-tested relations, compute from first principles:\n1) the insulating single-particle gap $E_{g}(U,J)$ defined as $E_{g} = \\mu^{+} - \\mu^{-}$ with $\\mu^{+} = E(N+1) - E(N)$ and $\\mu^{-} = E(N) - E(N-1)$ for $N=2$ electrons in the $e_{g}$ sector, and\n2) the saturated local spin magnetic moment $\\mu_{s}(U,J)$ (spin-only) in the antiferromagnetic ground state.\n\nAssume the ground state is the high-spin configuration stabilized by positive $J$, and ignore orbital polarization within the $e_{g}$ doublet. Express $E_{g}$ in electronvolts and $\\mu_{s}$ in Bohr magnetons. Provide your final answer as a single row matrix containing the two expressions in terms of $U$ and $J$ only. No numerical values are to be substituted. No rounding is required.", "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n- **System**: A minimal two-orbital tight-binding model for rocksalt nickel oxide (NiO).\n- **Ion Configuration**: Nickel is in the $d^{8}$ configuration.\n- **Crystal Field**: Octahedral crystal field splits the $d$ orbitals into a filled $t_{2g}^{6}$ manifold (treated as inert) and a partially filled $e_{g}^{2}$ manifold.\n- **Model Space**: Only the two degenerate $e_{g}$ orbitals, labeled $m \\in \\{a,b\\}$, on each nickel site are considered.\n- **Filling**: Half-filling of the $e_{g}$ sector, meaning $N=2$ electrons per nickel site.\n- **Hopping**: Nearest-neighbor hopping amplitude $t$. The problem is to be solved in the atomic limit, $t \\to 0$.\n- **On-site Interaction Hamiltonian**: The Kanamori form, restricted to its density-density sector:\n$$H_{\\mathrm{int}} = U \\sum_{m} n_{m\\uparrow} n_{m\\downarrow} + U' \\sum_{m \\neq m'} n_{m\\uparrow} n_{m'\\downarrow} + (U' - J) \\sum_{m  m', \\sigma} n_{m\\sigma} n_{m'\\sigma}$$\n- **Interaction Parameters**: $U$ (intraorbital Hubbard repulsion), $U'$ (interorbital repulsion), $J$ (Hund's exchange).\n- **Constraint**: Rotational invariance condition $U' = U - 2J$.\n- **Magnetic State**: Collinear antiferromagnetic order at zero temperature. The ground state for $N=2$ electrons is the high-spin configuration, stabilized by positive $J$.\n- **Orbital State**: Orbital polarization within the $e_{g}$ doublet is ignored.\n- **Quantity to Compute 1**: The insulating single-particle gap $E_{g}(U,J)$, defined as $E_{g} = \\mu^{+} - \\mu^{-}$, with $\\mu^{+} = E(N+1) - E(N)$ and $\\mu^{-} = E(N) - E(N-1)$ for $N=2$.\n- **Quantity to Compute 2**: The saturated local spin magnetic moment $\\mu_{s}(U,J)$ (spin-only) in the ground state.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is firmly based on standard models in condensed matter physics, namely the Hubbard-Kanamori model, which is a cornerstone for describing strongly correlated electron systems like transition metal oxides. The concepts of crystal field splitting, Hund's coupling, and Mott-Hubbard gaps are well-established. All premises are factually correct within the context of this widely used theoretical model.\n- **Well-Posed**: The problem provides all necessary definitions, parameters ($U, U', J$), constraints ($U' = U - 2J$), and a clear calculational framework (atomic limit $t \\to 0$). The quantities to be calculated ($E_g$, $\\mu_s$) are unambiguously defined. The assumption of a high-spin ground state for $N=2$ removes any ambiguity in identifying the reference state. A unique, stable, and meaningful solution exists.\n- **Objective**: The problem is stated in precise, formal language, free of subjectivity or opinion.\n- **Completeness**: The model is self-contained. The atomic limit simplification ($t \\to 0$) makes the problem solvable without needing details of the lattice or band dispersion. All required relations are provided.\n- **Consistency**: The givens are internally consistent. The Kanamori Hamiltonian, along with the rotational invariance condition and the assumption of a high-spin ground state for $J  0$, forms a coherent physical picture.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-posed, scientifically grounded problem from the field of theoretical condensed matter physics. The solution process can proceed.\n\n## Solution\n\nThe problem is set in the atomic limit ($t \\to 0$), which means the kinetic energy term of the Hamiltonian is zero. The total energy of the system is determined solely by the on-site electron-electron interaction Hamiltonian, $H_{\\mathrm{int}}$, for an isolated nickel ion's $e_g$ orbitals.\n\nThe interaction Hamiltonian for the two $e_g$ orbitals (labeled $a$ and $b$) is:\n$$H_{\\mathrm{int}} = U \\sum_{m \\in \\{a,b\\}} n_{m\\uparrow} n_{m\\downarrow} + U' \\sum_{m \\neq m'} n_{m\\uparrow} n_{m'\\downarrow} + (U' - J) \\sum_{m  m', \\sigma} n_{m\\sigma} n_{m'\\sigma}$$\nThe summation over $m  m'$ and $m \\neq m'$ in a two-orbital model corresponds to a single pair of orbitals $(a, b)$. The Hamiltonian simplifies to:\n$$H_{\\mathrm{int}} = U (n_{a\\uparrow} n_{a\\downarrow} + n_{b\\uparrow} n_{b\\downarrow}) + U' (n_{a\\uparrow} n_{b\\downarrow} + n_{a\\downarrow} n_{b\\uparrow}) + (U' - J) (n_{a\\uparrow} n_{b\\uparrow} + n_{a\\downarrow} n_{b\\downarrow})$$\nWe use the rotational invariance condition $U'=U-2J$ to express all energies in terms of $U$ and $J$.\n\n### 1) Calculation of the Insulating Gap $E_g$\n\nThe gap is defined as $E_g = \\mu^{+} - \\mu^{-}$, where $\\mu^{+} = E(N+1) - E(N)$ and $\\mu^{-} = E(N) - E(N-1)$. The problem specifies the neutral atom has $N=2$ electrons in the $e_g$ shell. Thus, we need to calculate the ground state energies $E(1)$, $E(2)$, and $E(3)$.\n\n**Ground State Energy for $N=1$ electron, $E(1)$:**\nThe ground state consists of a single electron in one of the orbitals, say $|a\\uparrow\\rangle$. The occupation numbers are $n_{a\\uparrow}=1$, and all others are zero. All terms in $H_{\\mathrm{int}}$ require at least two electrons. Therefore, the interaction energy is zero.\n$$E(1) = 0$$\n\n**Ground State Energy for $N=2$ electrons, $E(2)$:**\nThe problem states that for $N=2$, the ground state is a high-spin configuration. For two electrons in two degenerate orbitals, the high-spin state is a triplet ($S=1$) where each electron occupies a different orbital with parallel spins. A representative state is $|a\\uparrow, b\\uparrow\\rangle$.\nThe occupation numbers are $n_{a\\uparrow}=1$, $n_{b\\uparrow}=1$, and $n_{a\\downarrow}=n_{b\\downarrow}=0$.\nLet's calculate the energy of this state with $H_{\\mathrm{int}}$:\n- The intraorbital repulsion term $U (n_{a\\uparrow} n_{a\\downarrow} + n_{b\\uparrow} n_{b\\downarrow})$ is $0$ as there is no double occupancy.\n- The interorbital opposite-spin term $U' (n_{a\\uparrow} n_{b\\downarrow} + n_{a\\downarrow} n_{b\\uparrow})$ is $0$ as the electrons have parallel spins.\n- The interorbital same-spin term $(U' - J) (n_{a\\uparrow} n_{b\\uparrow} + n_{a\\downarrow} n_{b\\downarrow})$ is $(U' - J)(1 \\cdot 1 + 0 \\cdot 0) = U' - J$.\nSo, the ground state energy for $N=2$ is:\n$$E(2) = U' - J$$\nSubstituting $U' = U - 2J$:\n$$E(2) = (U - 2J) - J = U - 3J$$\n\n**Ground State Energy for $N=3$ electrons, $E(3)$:**\nThe ground state for $N=3$ electrons is formed by adding one electron to the $N=2$ ground state. The configuration will be two electrons in one orbital and one in the other, e.g., $|a\\uparrow, a\\downarrow, b\\uparrow\\rangle$.\nThe occupation numbers are $n_{a\\uparrow}=1$, $n_{a\\downarrow}=1$, and $n_{b\\uparrow}=1$.\nLet's calculate the energy of this state:\n- Intraorbital repulsion: $U (n_{a\\uparrow} n_{a\\downarrow} + n_{b\\uparrow} n_{b\\downarrow}) = U(1 \\cdot 1 + 1 \\cdot 0) = U$.\n- Interorbital opposite-spin: $U' (n_{a\\uparrow} n_{b\\downarrow} + n_{a\\downarrow} n_{b\\uparrow}) = U'(1 \\cdot 0 + 1 \\cdot 1) = U'$.\n- Interorbital same-spin: $(U' - J) (n_{a\\uparrow} n_{b\\uparrow} + n_{a\\downarrow} n_{b\\downarrow}) = (U' - J)(1 \\cdot 1 + 1 \\cdot 0) = U' - J$.\nThe total energy is the sum of these contributions:\n$$E(3) = U + U' + (U' - J) = U + 2U' - J$$\nSubstituting $U' = U - 2J$:\n$$E(3) = U + 2(U - 2J) - J = U + 2U - 4J - J = 3U - 5J$$\n\n**Calculating the Gap:**\nNow we can compute the chemical potentials and the gap.\nThe electron removal energy (ionization potential) is:\n$$\\mu^{-} = E(N) - E(N-1) = E(2) - E(1) = (U - 3J) - 0 = U - 3J$$\nThe electron addition energy (electron affinity) is:\n$$\\mu^{+} = E(N+1) - E(N) = E(3) - E(2) = (3U - 5J) - (U - 3J) = 2U - 2J$$\nThe single-particle gap is the difference between these two energies:\n$$E_g = \\mu^{+} - \\mu^{-} = (2U - 2J) - (U - 3J) = 2U - 2J - U + 3J$$\n$$E_g = U + J$$\n\n### 2) Calculation of the Saturated Local Spin Magnetic Moment $\\mu_s$\n\nThe saturated local spin magnetic moment is determined by the total spin quantum number, $S$, of the local ground state. As established, the ground state for $N=2$ electrons is the high-spin configuration $|a\\uparrow, b\\uparrow\\rangle$. This is a triplet state, formed by two spin-$1/2$ electrons with parallel spins.\nThe total spin angular momentum quantum number is $S = \\frac{1}{2} + \\frac{1}{2} = 1$.\nThe \"saturated\" moment refers to the maximum projection of the spin magnetic moment along a quantization axis. The spin-only magnetic moment is given by $\\vec{\\mu}_s = - g_s \\mu_B \\vec{S} / \\hbar$, where $\\mu_B$ is the Bohr magneton and $g_s \\approx 2$ is the electron g-factor.\nIn solid-state physics, the magnitude of the ordered moment on a site is conventionally given as $g_s S \\mu_B$.\nUsing $S=1$ and the approximation $g_s = 2$:\n$$\\mu_s = g_s S \\mu_B = 2 \\cdot 1 \\cdot \\mu_B = 2 \\mu_B$$\nThe magnitude of the local magnetic moment is $2$ in units of the Bohr magneton. This result depends only on the spin configuration of the ground state (which is fixed by the problem statement), not on the energy values of the parameters $U$ and $J$. The parameters $U$ and $J$ determine that this state is the ground state, but they do not alter its intrinsic spin quantum number.\n\nThe two requested quantities are $E_g = U+J$ and $\\mu_s = 2 \\mu_B$.", "answer": "$$\\boxed{\\begin{pmatrix} U + J  2 \\end{pmatrix}}$$", "id": "3489189"}, {"introduction": "While Density Functional Theory (DFT) can provide highly accurate total energies for various magnetic configurations, its results can be difficult to interpret directly in terms of simple physical interactions. This is where effective models like the Heisenberg Hamiltonian become invaluable for understanding magnetic ordering and excitations. This practice introduces the 'energy mapping' technique, a cornerstone of computational magnetism, where you will fit DFT energies to a Heisenberg model to extract the effective exchange coupling parameters ($J_1$ and $J_2$) that govern the interactions between neighboring spins. [@problem_id:3489162]", "problem": "Consider a classical collinear Heisenberg model on a simple cubic Bravais lattice. You are given three collinear spin configurations: ferromagnetic (FM), type-I antiferromagnetic (AFM-I), and type-II antiferromagnetic (AFM-II). Assume unit spin length so that each site has spin vector of magnitude $1$, and consider only the first and second neighbor exchange interactions. The Hamiltonian is defined as\n$$\nH \\;=\\; \\frac{1}{2}\\sum_{i\\neq j} J_{ij}\\,\\mathbf S_i\\cdot\\mathbf S_j \\,,\n$$\nwith $J_{ij}=J_1$ if $i$ and $j$ are nearest neighbors and $J_{ij}=J_2$ if $i$ and $j$ are next-nearest neighbors, and $J_{ij}=0$ otherwise. The factor $1/2$ avoids double counting of bonds. For configurational total energies computed by spin-polarized density functional theory (DFT), model the per-atom energy as\n$$\nE_{\\text{conf}} \\;=\\; E_0 \\;+\\; \\frac{1}{2}\\left(J_1 \\sum_{\\langle i,j\\rangle_1} s_i s_j \\;+\\; J_2 \\sum_{\\langle i,j\\rangle_2} s_i s_j\\right)\\,,\n$$\nwhere $E_0$ is a configuration-independent offset energy per atom, $s_i=\\pm 1$ encodes the collinear spin orientation at site $i$, the sum $\\sum_{\\langle i,j\\rangle_1}$ runs over bonds from a reference site to all its $z_1$ nearest neighbors, and $\\sum_{\\langle i,j\\rangle_2}$ runs over bonds from that site to all its $z_2$ next-nearest neighbors. For a simple cubic lattice, $z_1=6$ and $z_2=12$.\n\nThe three spin configurations are defined by a propagation vector $\\mathbf Q$ (angles in radians), with $s(\\mathbf R)\\in\\{+1,-1\\}$ determined by $s(\\mathbf R)=\\cos(\\mathbf Q\\cdot\\mathbf R)$ for lattice vector $\\mathbf R$:\n- FM: $\\mathbf Q_{\\text{FM}}=(0,0,0)$.\n- AFM-I: $\\mathbf Q_{\\text{I}}=(\\pi,0,0)$, which alternates spins between adjacent $(100)$ planes and keeps spins parallel within each plane.\n- AFM-II: $\\mathbf Q_{\\text{II}}=(\\pi,\\pi,\\pi)$, which alternates spins on every site in a checkerboard pattern.\n\nYour task is to write a program that, given DFT total energies per atom for the three configurations $\\{E_{\\text{FM}},E_{\\text{I}},E_{\\text{II}}\\}$ (expressed in millielectronvolts per atom, abbreviated meV/atom), extracts the exchange parameters $J_1$ and $J_2$ (in meV) by fitting to the Heisenberg model above. You must treat $E_0$ as an unknown to be fitted as well. You should proceed from first principles: use the Hamiltonian definition, the lattice coordination numbers, and the propagation vectors to derive the spin-correlation sums for each configuration, construct the resulting linear system relating $\\{E_{\\text{FM}},E_{\\text{I}},E_{\\text{II}}\\}$ to $\\{J_1,J_2,E_0\\}$, and then solve for $\\{J_1,J_2,E_0\\}$.\n\nAngles must be treated in radians. The exchange parameters $J_1$ and $J_2$ and the offset $E_0$ must be reported in millielectronvolts (meV), as floating-point numbers.\n\nTest suite. Use the following three independent test cases. For each case, the three input energies $(E_{\\text{FM}},E_{\\text{I}},E_{\\text{II}})$, in meV/atom, are:\n- Case A (general): $E_{\\text{FM}}=-118$, $E_{\\text{I}}=-114$, $E_{\\text{II}}=-58$.\n- Case B (boundary $J_1=0$): $E_{\\text{FM}}=21$, $E_{\\text{I}}=-7$, $E_{\\text{II}}=21$.\n- Case C (boundary $J_2=0$): $E_{\\text{FM}}=22$, $E_{\\text{I}}=14$, $E_{\\text{II}}=-2$.\n\nFinal output specification. Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of three floats $[J_1,J_2,E_0]$ in meV, each rounded to six decimal places, in the same order as the test cases above. For example, the output format must be\n\"[ [J1_A,J2_A,E0_A], [J1_B,J2_B,E0_B], [J1_C,J2_C,E0_C] ]\"\nwith no additional text or spaces beyond those needed for valid list syntax. Note that numerical values must be in meV and rounded to six decimal places.", "solution": "To extract the exchange parameters $J_1$ and $J_2$ and the offset $E_0$, we must first express the energy per atom for each of the three magnetic configurations (FM, AFM-I, AFM-II) in terms of these parameters. The model for the energy per atom is derived from the Heisenberg Hamiltonian and is given by:\n$$\nE_{\\text{conf}} = E_0 + \\frac{1}{2}\\left(J_1 \\sum_{\\text{NN}} s_i s_j + J_2 \\sum_{\\text{NNN}} s_i s_j\\right)\n$$\nwhere the sums run over the nearest neighbors (NN) and next-nearest neighbors (NNN) of a reference atom $i$. For a simple cubic lattice, a reference atom has $z_1=6$ nearest neighbors and $z_2=12$ next-nearest neighbors. We can choose our reference atom $i$ at the origin $\\mathbf R = (0,0,0)$, so its spin is $s_i = \\cos(\\mathbf Q \\cdot \\mathbf 0) = 1$ for all configurations. The sums then become $\\sum_{\\text{NN}} s_j$ and $\\sum_{\\text{NNN}} s_j$, where $s_j$ is the spin on a neighbor site $j$.\n\n1.  **Ferromagnetic (FM) configuration:**\n    - Propagation vector $\\mathbf Q_{\\text{FM}} = (0,0,0)$.\n    - The spin on any site $\\mathbf R$ is $s(\\mathbf R) = \\cos(0) = 1$. All spins are parallel.\n    - Sum over NN: All 6 NN have $s_j=1$. The sum is $6 \\times 1 = 6$.\n    - Sum over NNN: All 12 NNN have $s_j=1$. The sum is $12 \\times 1 = 12$.\n    - Energy: $E_{\\text{FM}} = E_0 + \\frac{1}{2}(J_1 \\cdot 6 + J_2 \\cdot 12) = E_0 + 3J_1 + 6J_2$.\n\n2.  **Type-I Antiferromagnetic (AFM-I) configuration:**\n    - Propagation vector $\\mathbf Q_{\\text{I}} = (\\pi,0,0)$.\n    - The spin on a site $\\mathbf R=(x,y,z)$ is $s(\\mathbf R) = \\cos(\\pi x) = (-1)^x$. Spins form ferromagnetic planes stacked antiferromagnetically along the x-axis.\n    - The 6 NN of the origin are at $(\\pm 1,0,0)$, $(0,\\pm 1,0)$, and $(0,0,\\pm 1)$.\n        - Spins at $(\\pm 1,0,0)$: $s = (-1)^1 = -1$. Contribution: $2 \\times (-1) = -2$.\n        - Spins at $(0,\\pm 1,0)$ and $(0,0,\\pm 1)$: $s = (-1)^0 = 1$. Contribution: $4 \\times 1 = 4$.\n        - Sum over NN: $-2 + 4 = 2$.\n    - The 12 NNN are at positions like $(\\pm 1, \\pm 1, 0)$.\n        - Spins at $(\\pm 1, \\pm 1, 0)$ and $(\\pm 1, 0, \\pm 1)$: $x=\\pm 1$, so $s=-1$. Contribution: $8 \\times (-1) = -8$.\n        - Spins at $(0, \\pm 1, \\pm 1)$: $x=0$, so $s=1$. Contribution: $4 \\times 1 = 4$.\n        - Sum over NNN: $-8 + 4 = -4$.\n    - Energy: $E_{\\text{I}} = E_0 + \\frac{1}{2}(J_1 \\cdot 2 + J_2 \\cdot (-4)) = E_0 + J_1 - 2J_2$.\n\n3.  **Type-II Antiferromagnetic (AFM-II) configuration:**\n    - Propagation vector $\\mathbf Q_{\\text{II}} = (\\pi,\\pi,\\pi)$.\n    - The spin on a site $\\mathbf R=(x,y,z)$ is $s(\\mathbf R) = \\cos(\\pi(x+y+z)) = (-1)^{x+y+z}$. This is a checkerboard pattern.\n    - The 6 NN have coordinates where one component is $\\pm 1$ and others are 0 (e.g., $(1,0,0)$). The sum $x+y+z$ is odd, so $s_j = -1$ for all 6 NN.\n        - Sum over NN: $6 \\times (-1) = -6$.\n    - The 12 NNN have coordinates where two components are $\\pm 1$ (e.g., $(1,1,0)$). The sum $x+y+z$ is even, so $s_j = 1$ for all 12 NNN.\n        - Sum over NNN: $12 \\times 1 = 12$.\n    - Energy: $E_{\\text{II}} = E_0 + \\frac{1}{2}(J_1 \\cdot (-6) + J_2 \\cdot 12) = E_0 - 3J_1 + 6J_2$.\n\nWe now have a system of three linear equations with three unknowns ($E_0, J_1, J_2$):\n$$\n\\begin{cases}\nE_{\\text{FM}} = E_0 + 3J_1 + 6J_2 \\\\\nE_{\\text{I}}   = E_0 + J_1 - 2J_2 \\\\\nE_{\\text{II}}  = E_0 - 3J_1 + 6J_2\n\\end{cases}\n$$\nThis system can be written in matrix form as $\\mathbf{b} = \\mathbf{A} \\mathbf{x}$, where $\\mathbf{b} = [E_{\\text{FM}}, E_{\\text{I}}, E_{\\text{II}}]^T$, $\\mathbf{x} = [E_0, J_1, J_2]^T$, and the matrix $\\mathbf{A}$ is:\n$$\n\\mathbf{A} = \n\\begin{pmatrix}\n1  3  6 \\\\\n1  1  -2 \\\\\n1  -3  6\n\\end{pmatrix}\n$$\nGiven the DFT energies $\\{E_{\\text{FM}}, E_{\\text{I}}, E_{\\text{II}}\\}$, we can solve this linear system for $\\{E_0, J_1, J_2\\}$. For instance, by subtracting the third equation from the first, we can directly find $J_1$:\n$E_{\\text{FM}} - E_{\\text{II}} = (E_0 + 3J_1 + 6J_2) - (E_0 - 3J_1 + 6J_2) = 6J_1 \\implies J_1 = (E_{\\text{FM}} - E_{\\text{II}}) / 6$.\nThe remaining parameters can be found by substitution or by inverting the matrix $\\mathbf{A}$. The provided program implements the numerical solution of this system.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Heisenberg exchange parameters J1, J2 and offset E0\n    from the total energies of FM, AFM-I, and AFM-II configurations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (E_FM, E_I, E_II) in meV/atom.\n    test_cases = [\n        (-118, -114, -58),  # Case A\n        (21, -7, 21),      # Case B\n        (22, 14, -2),      # Case C\n    ]\n\n    # The per-atom energies for the three configurations are given by the system:\n    # E_FM   = E0 + 3*J1 + 6*J2\n    # E_I    = E0 + 1*J1 - 2*J2\n    # E_II   = E0 - 3*J1 + 6*J2\n    #\n    # In matrix form A * x = b, where x = [E0, J1, J2]^T:\n    #\n    # [[1,  3,  6],   [E0],   [E_FM]\n    #  [1,  1, -2], * [J1], = [E_I]\n    #  [1, -3,  6]]   [J2]]   [E_II]\n    #\n    # We solve this linear system for x = [E0, J1, J2].\n    \n    # Coefficient matrix 'A'\n    A = np.array([\n        [1, 3, 6],\n        [1, 1, -2],\n        [1, -3, 6]\n    ])\n\n    results = []\n    for case in test_cases:\n        e_fm, e_i, e_ii = case\n        \n        # Right-hand side vector 'b'\n        b = np.array([e_fm, e_i, e_ii])\n        \n        # Solve the linear system A*x = b for x\n        x = np.linalg.solve(A, b)\n        \n        # The solution vector x is [E0, J1, J2]\n        e0, j1, j2 = x[0], x[1], x[2]\n        \n        # The problem requires the output order [J1, J2, E0].\n        # The values must be floats rounded to six decimal places.\n        result = [round(j1, 6), round(j2, 6), round(e0, 6)]\n        \n        results.append(result)\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3489162"}, {"introduction": "Magnetism in materials is not always described by localized atomic spins; in metals like iron or nickel, it arises as a collective phenomenon of the itinerant conduction electrons. This practice delves into the theory of itinerant ferromagnetism by simulating the results of constrained-moment DFT calculations, which provide the total energy as a function of a fixed total magnetic moment, $M$. By fitting this energy landscape to a Landau polynomial, such as $\\Delta F(M) = A M^2 + B M^4 + C M^6$, you will learn how to phenomenologically describe a magnetic phase transition and connect the macroscopic stability, governed by the sign of the coefficient $A$, to the microscopic Stoner criterion. [@problem_id:3489229]", "problem": "Consider an itinerant electron system whose spin-polarized ground state can be probed by constrained spin-moment calculations from Density Functional Theory (DFT), where the total energy as a function of imposed magnetization is computed. Near the paramagnetic state at magnetization $M = 0$, symmetry under spin inversion implies that the free-energy density difference $\\Delta F(M)$ can be represented by a linear combination of even powers of $M$ up to sixth order. In a Stoner-like picture, the proximity to a ferromagnetic instability is governed by the product of the effective exchange interaction parameter $I$ and the electronic density of states at the Fermi level $N(E_F)$, and the leading quadratic coefficient encodes the factor $1 - I\\,N(E_F)$ up to a proportionality constant determined by band-structure details. Your task is to extract the effective coefficients from DFT energy data and relate the leading coefficient to $1 - I\\,N(E_F)$.\n\nBase assumptions and definitions:\n- The magnetization $M$ is measured in Bohr magnetons per atom ($\\mu_B$/atom).\n- The energy differences $\\Delta E(M)$ are measured in millielectronvolts per atom (meV/atom) and are referenced to the $M=0$ energy, i.e., $\\Delta E(0) = 0$.\n- The free-energy density near $M=0$ is represented as a linear combination of the basis functions $\\{M^2, M^4, M^6\\}$ with unknown coefficients to be determined from the given data.\n- The Stoner criterion depends on the sign of $1 - I\\,N(E_F)$, where $I$ is given in electronvolts (eV), and $N(E_F)$ is given in states per electronvolt per atom per spin.\n\nFrom first principles, start from the invariance of the free energy under $M \\mapsto -M$, the notion of a Landau expansion in even powers of the order parameter, and the Stoner picture for itinerant magnetism. Derive the necessary relationships to:\n1. Fit the coefficients multiplying $M^2$, $M^4$, and $M^6$ from the DFT energy data using a least-squares method.\n2. Determine the equilibrium magnetization $M_0$ that minimizes the fitted free-energy representation, including the conditions for a ferromagnetic minimum to exist (nonzero $M_0$), and compute the free-energy difference at that minimum.\n3. Classify each case as ferromagnetic if a nonzero $M_0$ exists with a lower free energy than at $M=0$, otherwise classify as paramagnetic.\n4. Compute the quantity $1 - I\\,N(E_F)$ and an effective proportionality constant defined by the ratio of the fitted quadratic coefficient to $1 - I\\,N(E_F)$.\n\nExpress all outputs in the units specified above. Angles do not appear in this problem. No percentages appear in this problem.\n\nYour program must implement the above logic for the following test suite, which consists of three cases that probe a typical ferromagnetic scenario, a near-critical scenario, and a paramagnetic scenario:\n\n- Test Case A:\n  - Magnetizations $M$ (in $\\mu_B$/atom): $\\{0.0, 0.5, 1.0, 1.5, 2.0\\}$.\n  - Energy differences $\\Delta E(M)$ (in meV/atom): $\\{0.0, -6.84, -17.9, 6.10, 168.5\\}$.\n  - Exchange parameter $I$ (in eV): $0.9$.\n  - Density of states $N(E_F)$ (in states/(eV atom spin)): $1.2$.\n\n- Test Case B:\n  - Magnetizations $M$ (in $\\mu_B$/atom): $\\{0.0, 0.5, 1.0, 1.5\\}$.\n  - Energy differences $\\Delta E(M)$ (in meV/atom): $\\{0.0, 1.02, 12.1, 67.8\\}$.\n  - Exchange parameter $I$ (in eV): $0.8$.\n  - Density of states $N(E_F)$ (in states/(eV atom spin)): $1.22$.\n\n- Test Case C:\n  - Magnetizations $M$ (in $\\mu_B$/atom): $\\{0.0, 0.5, 1.0, 1.5\\}$.\n  - Energy differences $\\Delta E(M)$ (in meV/atom): $\\{0.0, 12.83, 55.9, 149.2\\}$.\n  - Exchange parameter $I$ (in eV): $0.5$.\n  - Density of states $N(E_F)$ (in states/(eV atom spin)): $1.1$.\n\nComputational requirements:\n- Use linear least squares to fit the coefficients multiplying $M^2$, $M^4$, and $M^6$.\n- Determine the nonzero stationary points by solving the equation for extrema of the fitted polynomial, and select the physical minimum with $M_0 \\ge 0$ when it exists.\n- Use the sign of $1 - I\\,N(E_F)$ to indicate whether Stoner theory predicts a ferromagnetic instability, and compare it with the classification obtained from the fitted free energy.\n\nFinal output specification:\n- For each test case, output a list containing eight entries in the following order:\n  1. The fitted quadratic coefficient (units meV/atom per $\\mu_B^2$).\n  2. The fitted quartic coefficient (units meV/atom per $\\mu_B^4$).\n  3. The fitted sixth-order coefficient (units meV/atom per $\\mu_B^6$).\n  4. The equilibrium magnetization $M_0$ (in $\\mu_B$/atom), taking $M_0 = 0$ if no ferromagnetic minimum exists.\n  5. The free-energy difference at $M_0$ (in meV/atom).\n  6. An integer indicator equal to $1$ if $1 - I\\,N(E_F)  0$ and $0$ otherwise.\n  7. An integer indicator equal to $1$ if the fitted free-energy classification is ferromagnetic (nonzero $M_0$ with lower free energy than at $M=0$) and $0$ otherwise.\n  8. The ratio of the fitted quadratic coefficient to $1 - I\\,N(E_F)$ (units meV/atom per $\\mu_B^2$), use a representation of \"not-a-number\" when the denominator is $0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one sublist per test case, for example: $[[\\dots],[\\dots],[\\dots]]$. No additional text or lines should be printed.", "solution": "The problem requires an analysis of spin-polarized electronic structure data derived from Density Functional Theory (DFT) within the framework of the Stoner model of itinerant ferromagnetism and Landau theory of phase transitions. The core tasks are to fit a model free-energy function to given energy-versus-magnetization data, analyze the minima of this function to determine the magnetic ground state, and relate the model parameters to quantities from the Stoner theory.\n\nFirst, we establish the theoretical model for the free-energy density difference, $\\Delta F(M)$, as a function of magnetization, $M$. The problem states that due to spin-inversion symmetry, where the energy is invariant under the transformation $M \\mapsto -M$, the expansion of $\\Delta F(M)$ around the paramagnetic state ($M=0$) contains only even powers of $M$. We truncate this expansion at the sixth order, as specified:\n$$ \\Delta F(M) = A M^2 + B M^4 + C M^6 $$\nHere, $\\Delta F(M)$ is the energy difference relative to the $M=0$ state, so $\\Delta F(0) = 0$, which is consistent with the model. The coefficients $A$, $B$, and $C$ are material-specific parameters to be determined. The provided DFT data points $(\\Delta E_i, M_i)$ are considered samples from this function, where $\\Delta E \\equiv \\Delta F$.\n\nThe first step is to determine the coefficients $A$, $B$, and $C$ from the given data sets. This is a linear least-squares problem. For a set of $N$ data points $(M_i, \\Delta E_i)$, excluding the trivial point $(0, 0)$, we seek to minimize the sum of squared residuals, $\\chi^2$:\n$$ \\chi^2 = \\sum_{i=1}^{N} \\left( \\Delta E_i - (A M_i^2 + B M_i^4 + C M_i^6) \\right)^2 $$\nThis can be formulated in matrix form. Let $\\mathbf{y}$ be the vector of energy differences $[\\Delta E_1, \\dots, \\Delta E_N]^T$, $\\mathbf{c}$ be the vector of unknown coefficients $[A, B, C]^T$, and $\\mathbf{X}$ be the design matrix:\n$$\n\\mathbf{X} =\n\\begin{pmatrix}\nM_1^2  M_1^4  M_1^6 \\\\\nM_2^2  M_2^4  M_2^6 \\\\\n\\vdots  \\vdots  \\vdots \\\\\nM_N^2  M_N^4  M_N^6\n\\end{pmatrix}\n$$\nThe problem is to solve the linear system $\\mathbf{X} \\mathbf{c} = \\mathbf{y}$ in the least-squares sense. The solution is given by the normal equations, $\\mathbf{X}^T \\mathbf{X} \\mathbf{c} = \\mathbf{X}^T \\mathbf{y}$, which yields $\\mathbf{c} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$. This is numerically solved using standard linear algebra routines.\n\nSecond, we determine the equilibrium magnetization $M_0$, which corresponds to the global minimum of the fitted free-energy function $\\Delta F(M)$ for $M \\ge 0$. The stationary points of $\\Delta F(M)$ are found by setting its derivative with respect to $M$ to zero:\n$$ \\frac{d(\\Delta F)}{dM} = 2AM + 4BM^3 + 6CM^5 = M(2A + 4BM^2 + 6CM^4) = 0 $$\nOne trivial solution is $M=0$, corresponding to the paramagnetic state. Non-zero solutions are found from the term in the parenthesis, which is a quadratic equation in $M^2$. Let $x = M^2$, we have:\n$$ 3Cx^2 + 2Bx + A = 0 $$\nThe solutions for $x = M^2$ are given by the quadratic formula:\n$$ x = M^2 = \\frac{-2B \\pm \\sqrt{(2B)^2 - 4(3C)(A)}}{2(3C)} = \\frac{-B \\pm \\sqrt{B^2 - 3AC}}{3C} $$\nFor a solution to be physically meaningful, $x = M^2$ must be a real and positive number. For each such valid solution $x_j  0$, we find a candidate magnetization $M_j = \\sqrt{x_j}$. To be a minimum, the second derivative must be positive:\n$$ \\frac{d^2(\\Delta F)}{dM^2} = 2A + 12BM^2 + 30CM^4 = 2A + 12Bx + 30Cx^2  0 $$\nThe ground state is identified by comparing the energy values $\\Delta F(M_j)$ for all stable minima (including the paramagnetic state at $M=0$, where $\\Delta F(0) = 0$). The equilibrium magnetization $M_0$ is the value of $M$ that corresponds to the lowest energy. A ferromagnetic ground state is declared if $M_0  0$ and its corresponding energy $\\Delta F(M_0)$ is negative. Otherwise, the ground state is paramagnetic, and we set $M_0 = 0$ with $\\Delta F(M_0) = 0$.\n\nThird, we connect our findings to the Stoner model of itinerant ferromagnetism. The Stoner criterion for a ferromagnetic instability is $I \\cdot N(E_F)  1$, where $I$ is the effective exchange interaction parameter and $N(E_F)$ is the density of states at the Fermi level for one spin channel. This is equivalent to the condition $1 - I N(E_F)  0$. We compute this value and an indicator (1 if negative, 0 otherwise). The problem states that the quadratic coefficient $A$ from the Landau expansion is proportional to this quantity: $A \\propto (1 - I N(E_F))$. This provides a link between the microscopic parameters ($I, N(E_F)$) and the phenomenological Landau coefficient ($A$). The sign of $A$ should therefore indicate magnetic stability: $A  0$ implies an unstable paramagnetic state, favoring ferromagnetism, consistent with $1 - I N(E_F)  0$. We compute the proportionality constant as the ratio $A / (1 - I N(E_F))$. If $1 - I N(E_F) = 0$, the system is at the critical point, and the ratio is undefined.\n\nFinally, we assemble the eight required output values for each test case: the fitted coefficients $A, B, C$; the equilibrium magnetization $M_0$ and its energy $\\Delta F(M_0)$; an indicator for the Stoner criterion fulfillment; an indicator for the ferromagnetic classification from the free energy analysis; and the computed proportionality ratio. All units will be handled as specified in the problem statement.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It orchestrates the analysis for each case and prints the final results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A: Ferromagnetic\n        {\n            \"M_data\": [0.0, 0.5, 1.0, 1.5, 2.0],\n            \"E_data\": [0.0, -6.84, -17.9, 6.10, 168.5],\n            \"I\": 0.9,\n            \"N_ef\": 1.2\n        },\n        # Test Case B: Near-critical\n        {\n            \"M_data\": [0.0, 0.5, 1.0, 1.5],\n            \"E_data\": [0.0, 1.02, 12.1, 67.8],\n            \"I\": 0.8,\n            \"N_ef\": 1.22\n        },\n        # Test Case C: Paramagnetic\n        {\n            \"M_data\": [0.0, 0.5, 1.0, 1.5],\n            \"E_data\": [0.0, 12.83, 55.9, 149.2],\n            \"I\": 0.5,\n            \"N_ef\": 1.1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_case(case[\"M_data\"], case[\"E_data\"], case[\"I\"], case[\"N_ef\"])\n        results.append(result)\n\n    # Format the final output as a string representing a list of lists.\n    # Each inner list represents the results for one test case.\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in results]) + \"]\"\n    print(output_str)\n\ndef analyze_case(M_data, E_data, I, N_ef):\n    \"\"\"\n    Analyzes a single test case accordingto the problem description.\n    \n    Args:\n        M_data (list): List of magnetization points in mu_B/atom.\n        E_data (list): List of energy differences in meV/atom.\n        I (float): Exchange parameter in eV.\n        N_ef (float): Density of states in states/(eV atom spin).\n        \n    Returns:\n        list: A list of 8 result values for the case.\n    \"\"\"\n    \n    # 1. Fit coefficients A, B, C using linear least squares.\n    # We exclude the (0,0) point as it provides no information to the fit\n    # for the given model F(M) = AM^2 + BM^4 + CM^6.\n    M = np.array(M_data[1:])\n    E = np.array(E_data[1:])\n\n    # Construct the design matrix X for the linear system X*c = E\n    # where c = [A, B, C] are the coefficients to be found.\n    X = np.vstack([M**2, M**4, M**6]).T\n    \n    # Solve the least-squares problem\n    coeffs, _, _, _ = np.linalg.lstsq(X, E, rcond=None)\n    A, B, C = coeffs\n\n    # 2. Determine the equilibrium magnetization M0.\n    # Initialize ground state as paramagnetic.\n    M0 = 0.0\n    E0 = 0.0\n    \n    # Find non-zero stationary points by solving 3C*x^2 + 2B*x + A = 0 for x=M^2.\n    # We must handle the case where C is close to zero (or exactly zero).\n    if np.isclose(C, 0):\n        # The equation for M^2 becomes linear: 2B*x + A = 0\n        if not np.isclose(B, 0):\n            x = -A / (2 * B)\n            roots = [x] if x > 0 else []\n        else: # B is also zero, no non-trivial solution\n            roots = []\n    else:\n        # Standard quadratic equation for x = M^2\n        discriminant = B**2 - 3 * A * C\n        if discriminant >= 0:\n            sqrt_disc = np.sqrt(discriminant)\n            x1 = (-B + sqrt_disc) / (3 * C)\n            x2 = (-B - sqrt_disc) / (3 * C)\n            roots = [r for r in [x1, x2] if r > 0]\n        else: # No real roots for M^2\n            roots = []\n\n    potential_minima = []\n    for x in roots:\n        # Second derivative test for a minimum\n        # d^2F/dM^2 = 2A + 12B*M^2 + 30C*M^4 = 2A + 12B*x + 30C*x^2\n        second_derivative = 2 * A + 12 * B * x + 30 * C * x**2\n        if second_derivative > 0:\n            M_cand = np.sqrt(x)\n            E_cand = (A + B * x + C * x**2) * x\n            potential_minima.append((E_cand, M_cand))\n            \n    if potential_minima:\n        # Find the minimum with the lowest energy\n        best_E, best_M = min(potential_minima, key=lambda item: item[0])\n        \n        # A ferromagnetic ground state must have lower energy than the paramagnetic state (E=0)\n        if best_E  E0:\n            E0 = best_E\n            M0 = best_M\n\n    # 3. Classify and compute derived quantities.\n    \n    # Stoner criterion\n    stoner_factor = 1.0 - I * N_ef\n    stoner_indicator = 1 if stoner_factor  0 else 0\n    \n    # Ferromagnetic classification based on energy minimization\n    # M0 > 0 implies E0  0 from the logic above.\n    fm_indicator = 1 if M0 > 0 else 0\n    \n    # Proportionality constant k = A / (1 - I*N_ef)\n    if np.isclose(stoner_factor, 0):\n        ratio = 'nan'\n    else:\n        # Convert A to eV/atom per mu_B^2 to match units of denominator\n        A_eV = A / 1000.0\n        ratio = A_eV / stoner_factor\n        # Problem asks for result in meV/atom units, so convert back\n        ratio = ratio * 1000.0\n\n    return [A, B, C, M0, E0, stoner_indicator, fm_indicator, ratio]\n\nsolve()\n```", "id": "3489229"}]}