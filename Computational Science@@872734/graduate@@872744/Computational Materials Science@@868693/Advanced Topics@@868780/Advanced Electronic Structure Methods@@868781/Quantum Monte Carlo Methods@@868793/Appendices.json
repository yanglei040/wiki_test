{"hands_on_practices": [{"introduction": "The accuracy and efficiency of Quantum Monte Carlo (QMC) methods hinge on the quality of the trial wavefunction, $\\Psi_T$. A crucial aspect of a high-quality wavefunction is its ability to correctly describe the system's behavior when two particles become infinitesimally close. At these \"coalescence points,\" the Coulomb potential diverges, yet the local energy, $E_L(\\mathbf{R}) = (H\\Psi_T)/\\Psi_T$, must remain finite for the total energy to be well-defined. This physical constraint imposes strict mathematical conditions on the wavefunction's local derivatives. This foundational practice guides you through the first-principles derivation of these Kato cusp conditions, starting from the time-independent Schrödinger equation [@problem_id:3482464]. Mastering this derivation provides a deep understanding of the analytical structure of wavefunctions and the theoretical basis for constructing effective Jastrow correlation factors.", "problem": "Consider a nonrelativistic many-electron system relevant to computational materials science within the Born–Oppenheimer approximation, where the nuclei are clamped at fixed positions. Work in atomic units so that $\\hbar = 1$, the electron mass $m_{e} = 1$, and the elementary charge $e = 1$. Let the total Hamiltonian be $H = T + V$, with the electronic kinetic energy operator $T = -\\frac{1}{2}\\sum_{i=1}^{N_{e}}\\nabla_{i}^{2}$ and Coulomb interactions $V = -\\sum_{i,\\alpha}\\frac{Z_{\\alpha}}{r_{i\\alpha}} + \\sum_{i<j}\\frac{1}{r_{ij}} + V_{\\text{reg}}$, where $r_{i\\alpha} = |\\mathbf{r}_{i} - \\mathbf{R}_{\\alpha}|$ is the electron–nucleus separation for nucleus $\\alpha$ with charge $Z_{\\alpha}$ and $r_{ij} = |\\mathbf{r}_{i} - \\mathbf{r}_{j}|$ is the interelectronic separation. The term $V_{\\text{reg}}$ collects all remaining potential energy contributions whose local behavior is finite (non-singular) as $r_{i\\alpha} \\to 0$ or $r_{ij} \\to 0$. Let $\\Psi$ be an exact electronic eigenfunction satisfying $H\\Psi = E\\Psi$, with finite energy $E$.\n\nIn the context of Quantum Monte Carlo (QMC), specifically Variational Monte Carlo (VMC) and Diffusion Monte Carlo (DMC), the variance reduction and bias control critically depend on enforcing the correct short-range boundary conditions of $\\Psi$ at Coulombic coalescence points. Starting solely from the time-independent Schrödinger equation with the above $H$, and using only the local analysis of the singular terms as $r_{i\\alpha} \\to 0$ and $r_{ij} \\to 0$:\n\n- Derive the limiting value of the logarithmic radial derivative $\\left.\\frac{\\partial \\ln \\Psi}{\\partial r_{i\\alpha}}\\right|_{r_{i\\alpha}=0}$ at an electron–nucleus coalescence.\n- Derive the limiting value of the logarithmic radial derivative $\\left.\\frac{\\partial \\ln \\Psi}{\\partial r_{ij}}\\right|_{r_{ij}=0}$ at an electron–electron coalescence for opposite-spin electrons.\n\nTreat the coalescing pair’s spherical average in the local coordinate about the coalescence point, and retain only the leading singular contributions from the Coulomb potentials and the corresponding singular part of the kinetic operator. Express your final answer as a single closed-form analytic expression containing the two cusp constants, in symbolic form. No numerical rounding is required and no units should be included in your answer.", "solution": "The task is to derive the short-range boundary conditions, commonly known as the Kato cusp conditions, for an exact electronic wavefunction $\\Psi$ at the points of particle coalescence. The derivation starts from the time-independent Schrödinger equation, $H\\Psi = E\\Psi$, and proceeds by analyzing the singularities that arise from the Coulomb potential terms and the kinetic energy operator. We will consider the electron-nucleus and electron-electron coalescence points separately. The analysis relies on the fact that since the total energy $E$ is finite and the wavefunction $\\Psi$ is well-behaved, the singular terms in the expression $(H-E)\\Psi=0$ must cancel each other out locally.\n\nFirst, we analyze the electron-nucleus coalescence. Let us consider electron $i$ approaching nucleus $\\alpha$. The distance between them is $r_{i\\alpha} = |\\mathbf{r}_{i} - \\mathbf{R}_{\\alpha}|$. We analyze the Schrödinger equation in the limit as $r_{i\\alpha} \\to 0$. The Hamiltonian is $H = T + V$, with $T = -\\frac{1}{2}\\sum_{k=1}^{N_{e}}\\nabla_{k}^{2}$ and $V = -\\sum_{k,\\beta}\\frac{Z_{\\beta}}{r_{k\\beta}} + \\sum_{k<l}\\frac{1}{r_{kl}} + V_{\\text{reg}}$.\n\nAs $r_{i\\alpha} \\to 0$, the dominant singular terms in the Hamiltonian involving the coordinates of electron $i$ are its kinetic energy, $-\\frac{1}{2}\\nabla_{i}^{2}$, and its Coulomb attraction to nucleus $\\alpha$, $-\\frac{Z_{\\alpha}}{r_{i\\alpha}}$. All other terms in the Hamiltonian, which we can denote collectively as $H_{\\text{rem}}$, are finite at this coalescence point. The Schrödinger equation can be written as:\n$$\n\\left( -\\frac{1}{2}\\nabla_{i}^{2} - \\frac{Z_{\\alpha}}{r_{i\\alpha}} \\right) \\Psi(\\mathbf{r}_1, \\dots, \\mathbf{r}_{N_e}) = \\left( E - H_{\\text{rem}} \\right) \\Psi(\\mathbf{r}_1, \\dots, \\mathbf{r}_{N_e})\n$$\nThe right-hand side of this equation remains finite as $r_{i\\alpha} \\to 0$. To analyze the left-hand side, we perform a spherical average of the Schrödinger equation over the solid angle $\\Omega_{i\\alpha}$ of the vector $\\mathbf{r}_i - \\mathbf{R}_\\alpha$, holding all other electronic coordinates and $r_{i\\alpha}$ fixed. Let $\\bar{\\Psi}(r_{i\\alpha})$ denote the spherical average of $\\Psi$ with respect to the coordinates of electron $i$ around nucleus $\\alpha$.\nIn spherical coordinates centered at $\\mathbf{R}_{\\alpha}$, the Laplacian for electron $i$ is $\\nabla_{i}^{2} = \\frac{1}{r_{i\\alpha}^2}\\frac{\\partial}{\\partial r_{i\\alpha}}\\left(r_{i\\alpha}^2 \\frac{\\partial}{\\partial r_{i\\alpha}}\\right) + \\frac{L_{i\\alpha}^2}{r_{i\\alpha}^2}$, where $L_{i\\alpha}^2$ is the squared angular momentum operator for electron $i$ relative to nucleus $\\alpha$. The spherical average of the $L_{i\\alpha}^2 \\Psi$ term vanishes, as it corresponds to the $l>0$ components. The spherical average of $\\nabla_i^2 \\Psi$ thus becomes $\\frac{1}{r_{i\\alpha}^2}\\frac{d}{d r_{i\\alpha}}\\left(r_{i\\alpha}^2 \\frac{d\\bar{\\Psi}}{d r_{i\\alpha}}\\right) = \\frac{1}{r_{i\\alpha}}\\frac{d^2}{d r_{i\\alpha}^2}\\left(r_{i\\alpha}\\bar{\\Psi}\\right)$.\nApplying the spherical average to the Schrödinger equation, we obtain:\n$$\n-\\frac{1}{2} \\frac{1}{r_{i\\alpha}} \\frac{d^2}{d r_{i\\alpha}^2} \\left(r_{i\\alpha} \\bar{\\Psi}(r_{i\\alpha})\\right) - \\frac{Z_{\\alpha}}{r_{i\\alpha}} \\bar{\\Psi}(r_{i\\alpha}) \\approx \\text{finite value}\n$$\nFor this equation to hold as $r_{i\\alpha} \\to 0$, the terms that are singular like $1/r_{i\\alpha}$ must cancel. This implies that the sum of their coefficients must vanish in this limit:\n$$\n\\lim_{r_{i\\alpha} \\to 0} \\left[ -\\frac{1}{2} \\frac{d^2}{d r_{i\\alpha}^2} \\left(r_{i\\alpha} \\bar{\\Psi}\\right) - Z_{\\alpha} \\bar{\\Psi} \\right] = 0\n$$\nAssuming $\\bar{\\Psi}$ is analytic near $r_{i\\alpha}=0$, we can write a Taylor expansion for $\\bar{\\Psi}(r_{i\\alpha})$ as $\\bar{\\Psi}(r_{i\\alpha}) = \\bar{\\Psi}(0) + r_{i\\alpha} \\left.\\frac{d\\bar{\\Psi}}{dr_{i\\alpha}}\\right|_{0} + \\mathcal{O}(r_{i\\alpha}^2)$, where $\\bar{\\Psi}(0) \\neq 0$ for an s-like state at the nucleus.\nThen, $r_{i\\alpha}\\bar{\\Psi}(r_{i\\alpha}) = r_{i\\alpha}\\bar{\\Psi}(0) + r_{i\\alpha}^2 \\left.\\frac{d\\bar{\\Psi}}{dr_{i\\alpha}}\\right|_{0} + \\dots$.\nThe derivatives are:\n$\\frac{d}{dr_{i\\alpha}}(r_{i\\alpha}\\bar{\\Psi}) = \\bar{\\Psi}(0) + 2r_{i\\alpha}\\left.\\frac{d\\bar{\\Psi}}{dr_{i\\alpha}}\\right|_{0} + \\dots$\n$\\frac{d^2}{dr_{i\\alpha}^2}(r_{i\\alpha}\\bar{\\Psi}) = 2\\left.\\frac{d\\bar{\\Psi}}{dr_{i\\alpha}}\\right|_{0} + \\mathcal{O}(r_{i\\alpha})$\nSubstituting this into the limiting condition:\n$$\n-\\frac{1}{2} \\left( 2 \\left.\\frac{d\\bar{\\Psi}}{dr_{i\\alpha}}\\right|_{0} \\right) - Z_{\\alpha} \\bar{\\Psi}(0) = 0\n$$\nThis simplifies to $\\left.\\frac{d\\bar{\\Psi}}{dr_{i\\alpha}}\\right|_{0} = -Z_{\\alpha} \\bar{\\Psi}(0)$. The quantity we seek is the logarithmic derivative:\n$$\n\\left.\\frac{\\partial \\ln \\Psi}{\\partial r_{i\\alpha}}\\right|_{r_{i\\alpha}=0} = \\left.\\frac{1}{\\bar{\\Psi}(r_{i\\alpha})}\\frac{d\\bar{\\Psi}(r_{i\\alpha})}{dr_{i\\alpha}}\\right|_{r_{i\\alpha}=0} = \\frac{\\left.\\frac{d\\bar{\\Psi}}{dr_{i\\alpha}}\\right|_{0}}{\\bar{\\Psi}(0)} = -Z_{\\alpha}\n$$\nThis is the electron-nucleus cusp condition.\n\nNext, we analyze the electron-electron coalescence. We consider two electrons, $i$ and $j$, with opposite spins, in the limit $r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j| \\to 0$. It is convenient to transform to the center-of-mass coordinate $\\mathbf{R}_{ij} = (\\mathbf{r}_i + \\mathbf{r}_j)/2$ and relative coordinate $\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$. The kinetic energy operator for this pair, $-\\frac{1}{2}\\nabla_i^2 - \\frac{1}{2}\\nabla_j^2$, transforms to $-\\frac{1}{4}\\nabla_{\\mathbf{R}_{ij}}^2 - \\nabla_{\\mathbf{r}_{ij}}^2$. The term $-\\nabla_{\\mathbf{r}_{ij}}^2$ is the kinetic energy for the relative motion of a particle with reduced mass $\\mu = (m_e m_e) / (m_e + m_e) = 1/2$.\nAs $r_{ij} \\to 0$, the singular terms in the Hamiltonian are the relative kinetic energy and the interelectronic Coulomb repulsion, $1/r_{ij}$. The Schrödinger equation becomes:\n$$\n\\left( -\\nabla_{\\mathbf{r}_{ij}}^{2} + \\frac{1}{r_{ij}} \\right) \\Psi = (E - H''_{\\text{rem}}) \\Psi\n$$\nwhere $H''_{\\text{rem}}$ contains all terms that are regular as $r_{ij} \\to 0$. The right-hand side is finite. We again perform a spherical average, this time over the solid angle of the relative vector $\\mathbf{r}_{ij}$. Let $\\bar{\\Psi}(r_{ij})$ be this average. The same analysis as before for the Laplacian gives:\n$$\n-\\frac{1}{r_{ij}} \\frac{d^2}{d r_{ij}^2}(r_{ij}\\bar{\\Psi}(r_{ij})) + \\frac{1}{r_{ij}}\\bar{\\Psi}(r_{ij}) \\approx \\text{finite value}\n$$\nCancellation of the $1/r_{ij}$ singularities requires:\n$$\n\\lim_{r_{ij} \\to 0} \\left[ -\\frac{d^2}{d r_{ij}^2}(r_{ij}\\bar{\\Psi}) + \\bar{\\Psi} \\right] = 0\n$$\nFor opposite-spin electrons, the Pauli principle does not require the wavefunction to be zero at coalescence, so we can assume $\\bar{\\Psi}(0) \\neq 0$. Using the Taylor expansion $\\bar{\\Psi}(r_{ij}) = \\bar{\\Psi}(0) + r_{ij}\\left.\\frac{d\\bar{\\Psi}}{dr_{ij}}\\right|_{0} + \\dots$:\n$r_{ij}\\bar{\\Psi} = r_{ij}\\bar{\\Psi}(0) + r_{ij}^2\\left.\\frac{d\\bar{\\Psi}}{dr_{ij}}\\right|_{0} + \\dots$\n$\\frac{d^2}{dr_{ij}^2}(r_{ij}\\bar{\\Psi}) = 2\\left.\\frac{d\\bar{\\Psi}}{dr_{ij}}\\right|_{0} + \\mathcal{O}(r_{ij})$\nSubstituting into the limiting condition gives:\n$$\n-2\\left.\\frac{d\\bar{\\Psi}}{dr_{ij}}\\right|_{0} + \\bar{\\Psi}(0) = 0\n$$\nThis simplifies to $\\left.\\frac{d\\bar{\\Psi}}{dr_{ij}}\\right|_{0} = \\frac{1}{2}\\bar{\\Psi}(0)$. The logarithmic derivative at coalescence is:\n$$\n\\left.\\frac{\\partial \\ln \\Psi}{\\partial r_{ij}}\\right|_{r_{ij}=0} = \\left.\\frac{1}{\\bar{\\Psi}(r_{ij})}\\frac{d\\bar{\\Psi}(r_{ij})}{dr_{ij}}\\right|_{r_{ij}=0} = \\frac{\\left.\\frac{d\\bar{\\Psi}}{dr_{ij}}\\right|_{0}}{\\bar{\\Psi}(0)} = \\frac{1}{2}\n$$\nThis is the electron-electron cusp condition for opposite-spin electrons. Note that for same-spin electrons, $\\Psi$ must vanish as $r_{ij} \\to 0$, leading to a different condition not requested here.\n\nThe two derived cusp constants are $-Z_{\\alpha}$ for electron-nucleus coalescence and $1/2$ for opposite-spin electron-electron coalescence.", "answer": "$$\n\\boxed{\\begin{pmatrix} -Z_{\\alpha} & \\frac{1}{2} \\end{pmatrix}}\n$$", "id": "3482464"}, {"introduction": "Having established the theoretical necessity of cusp conditions, a natural question arises: what are the practical consequences of getting them wrong? In Variational Monte Carlo (VMC), a primary indicator of a trial wavefunction's quality is the variance of the local energy, $\\text{Var}(E_L)$. This hands-on coding exercise [@problem_id:3482382] allows you to explore the direct, quantitative link between cusp errors and local energy variance. By implementing and analyzing a simplified, hypothetical model of particle coalescence, you will numerically verify the theoretical scaling of variance with the cusp error, solidifying your intuition about the critical role these conditions play in controlling statistical fluctuations and ensuring the computational efficiency of VMC simulations.", "problem": "You will implement and analyze a simplified Variational Monte Carlo (VMC) model that isolates and quantifies how violations of electron-electron and electron-ion cusp conditions in a two-body Jastrow factor $u(r)$ control the variance of the local energy $E_L(\\mathbf{R})$ near particle coalescence. Work in Hartree atomic units. The starting point must be the stationary Schrödinger equation and the definition of the local energy, together with the statement of the cusp conditions as consequences of the cancellation of Coulomb singularities at coalescence. Your analysis must begin from these bases and must not rely on any pre-stated shortcut formulas.\n\nModeling assumptions to implement in your program:\n- Consider a single interparticle separation $r = \\|\\mathbf{r}\\|$ in three spatial dimensions, and a two-body Jastrow factor $u(r)$ that is smooth with a finite one-sided derivative at $r=0$. Assume that near $r=0$ the logarithmic derivative of the many-electron wavefunction with respect to $r$ is dominated by the Jastrow contribution and satisfies $\\frac{d}{dr}\\ln\\Psi \\approx u'(r)$.\n- Let the exact cusp coefficient for a given pair type be $c$ and define a cusp error $\\varepsilon$ by $u'(0) = c + \\varepsilon$. Treat $\\varepsilon$ as a small real scalar parameter.\n- For all-electron silicon, use nuclear charge $Z = 14$ and Coulomb electron-ion potential $-Z/r$. For pseudopotential silicon, use a smooth electron-ion potential without a $1/r$ singularity. Electron-electron interactions are always Coulombic with $+1/r$.\n- Restrict attention to the near-coalescence region $0 \\le r \\le R$ for a given cutoff radius $R$, and assume that the relative coordinate is sampled uniformly in a ball of radius $R$ in three dimensions. Equivalently, the radial probability density is $p(r) = 3 r^2 / R^3$ for $r \\in [0,R]$.\n\nDerivation requirements your code must implement:\n- Starting from the time-independent Schrödinger equation and the definition $E_L(\\mathbf{R}) = (H\\Psi)/\\Psi$, derive the leading-order singular structure of the local energy near coalescence for the following pair types:\n  1. electron-ion (all-electron),\n  2. electron-electron (unlike-spin),\n  3. electron-ion (pseudopotential).\n  Express the leading singular term as a function of $u'(0)$ and the pair’s Coulomb singularity.\n- From this, show how the cusp conditions determine the exact values of the cusp coefficients $c$ for each pair type and obtain the dominant singular dependence of $E_L$ on the cusp error $\\varepsilon$.\n- Using the sampling model with density $p(r)$, compute the variance of the singular contribution to $E_L$ over $r\\in[0,R]$ as a function of $\\varepsilon$ and $R$, and determine the scaling exponent $p$ defined by $\\mathrm{Var}[E_L] \\propto \\varepsilon^{p}$, together with the prefactor $K(R)$ defined by $\\mathrm{Var}[E_L] = K(R)\\,\\varepsilon^{2}$ in the near-coalescence model.\n\nImplementation and numerical tasks:\n- For each test case below, treat the near-coalescence variance as coming from the singular term only and compute:\n  1. the log-log slope $p$ obtained by fitting $\\log \\mathrm{Var}[E_L]$ versus $\\log \\varepsilon$ over the given list of $\\varepsilon$ values using least squares,\n  2. the prefactor $K(R)$ estimated as the arithmetic mean over the list of $\\varepsilon$ values of the ratios $\\mathrm{Var}[E_L]/\\varepsilon^{2}$.\n- For the boundary case with $\\varepsilon = 0$, compute the variance of the singular contribution and report whether it is numerically zero within an absolute tolerance of $10^{-12}$.\n\nUse atomic units and report all floating-point outputs rounded to three decimal places.\n\nTest suite to cover different regimes:\n- Case A (all-electron electron-ion, silicon): $Z = 14$, $R = 0.1$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$.\n- Case B (all-electron electron-electron, unlike-spin): $R = 0.1$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$.\n- Case C (pseudopotential electron-ion, silicon): $R = 0.1$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$.\n- Case D (all-electron electron-ion, silicon; smaller coalescence radius): $Z = 14$, $R = 0.05$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$.\n- Case E (boundary check, all-electron electron-ion, silicon): $Z = 14$, $R = 0.1$, $\\varepsilon = 0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n  1. Case A: fitted exponent $p$,\n  2. Case A: prefactor $K(R)$,\n  3. Case B: fitted exponent $p$,\n  4. Case B: prefactor $K(R)$,\n  5. Case C: fitted exponent $p$,\n  6. Case C: prefactor $K(R)$,\n  7. Case D: prefactor $K(R)$,\n  8. Case E: a boolean indicating whether the boundary variance is numerically zero within tolerance.\nFor example, the output must look like $[p_A,K_A,p_B,K_B,p_C,K_C,K_D,\\mathrm{boolE}]$ with floats rounded to three decimals.", "solution": "The problem requires an analysis of the variance of the local energy, $E_L(\\mathbf{R})$, in Variational Monte Carlo (VMC) as a function of violations in the electron-electron and electron-ion cusp conditions. The derivation must start from the time-independent Schrödinger equation and proceed to derive the scaling of the variance with the cusp error, $\\varepsilon$.\n\nThe time-independent Schrödinger equation is $H\\Psi = E\\Psi$. The local energy for a trial wavefunction $\\Psi_T$ at a configuration $\\mathbf{R}$ is defined as $E_L(\\mathbf{R}) = (H\\Psi_T)/\\Psi_T$. If $\\Psi_T$ is an exact eigenfunction, $E_L$ is constant; otherwise, it fluctuates. We are interested in the singular behavior of $E_L$ as the distance $r$ between a pair of interacting particles approaches zero.\n\nThe many-body Hamiltonian in atomic units ($m_e=1, \\hbar=1, e=1, 4\\pi\\epsilon_0=1$) includes kinetic and potential energy terms. For a pair of particles with relative coordinate $\\mathbf{r}$ and reduced mass $\\mu$, the terms in the Hamiltonian that depend on their separation $r = |\\mathbf{r}|$ are the relative kinetic energy operator, $T_{\\text{rel}} = -\\frac{1}{2\\mu}\\nabla_{\\mathbf{r}}^2$, and their interaction potential, $V(r)$. As $r \\to 0$, the local energy is dominated by these terms:\n$$\nE_L(r) \\approx \\frac{1}{\\Psi_T} \\left( -\\frac{1}{2\\mu} \\nabla_{\\mathbf{r}}^2 \\Psi_T \\right) + V(r) + \\text{non-singular terms}\n$$\nThe kinetic energy term can be expanded as $\\frac{1}{\\Psi_T} \\nabla_{\\mathbf{r}}^2 \\Psi_T = \\nabla_{\\mathbf{r}} \\cdot (\\frac{\\nabla_{\\mathbf{r}}\\Psi_T}{\\Psi_T}) + |\\frac{\\nabla_{\\mathbf{r}}\\Psi_T}{\\Psi_T}|^2$. The problem provides the key simplifying assumption that near coalescence, the logarithmic derivative of the wavefunction is determined by the Jastrow factor $u(r)$, such that $\\frac{d}{dr}\\ln\\Psi_T \\approx u'(r)$. This implies the gradient vector is approximately radial: $\\frac{\\nabla_{\\mathbf{r}}\\Psi_T}{\\Psi_T} \\approx u'(r)\\hat{\\mathbf{r}}$.\nUsing the formula for the divergence in spherical coordinates, we get:\n$$\n\\nabla_{\\mathbf{r}} \\cdot (u'(r)\\hat{\\mathbf{r}}) = \\frac{1}{r^2}\\frac{d}{dr}(r^2 u'(r)) = u''(r) + \\frac{2}{r}u'(r)\n$$\nAs $r \\to 0$, and given that $u(r)$ is smooth (so $u'(r)$ and $u''(r)$ are finite at $r=0$), the most singular part of the kinetic energy term is $-\\frac{1}{2\\mu}\\frac{2}{r}u'(0)$. The singular part of the local energy is thus:\n$$\nE_L^{\\text{sing}}(r) = -\\frac{u'(0)}{\\mu r} + V(r)\n$$\nThe interaction potentials are Coulombic, of the form $V(r) = V_0/r$.\n$$\nE_L^{\\text{sing}}(r) = -\\frac{u'(0)}{\\mu r} + \\frac{V_0}{r} = \\frac{1}{r} \\left(V_0 - \\frac{u'(0)}{\\mu}\\right)\n$$\nFor an exact wavefunction, $E_L$ must be finite everywhere. This requires the singularity to vanish, leading to the Kato cusp condition:\n$V_0 - \\frac{u'(0)_{\\text{exact}}}{\\mu} = 0$. This defines the exact cusp coefficient, $c \\equiv u'(0)_{\\text{exact}} = \\mu V_0$.\n\nWe can now determine $c$ for the specified cases:\n1.  **electron-ion (all-electron, charge $Z$)**: The potential is $V(r) = -Z/r$, so $V_0 = -Z$. The reduced mass is $\\mu \\approx 1$ a.u. Thus, $c = (1)(-Z) = -Z$.\n2.  **electron-electron (unlike-spin)**: The potential is $V(r) = +1/r$, so $V_0 = 1$. The reduced mass is $\\mu = 1/2$. Thus, $c = (1/2)(1) = 1/2$.\n3.  **electron-ion (pseudopotential)**: The potential is smooth, meaning it has no $1/r$ singularity. Therefore, $V_0=0$, and $c=(1)(0)=0$.\n\nA trial wavefunction may violate this condition, with $u'(0) = c + \\varepsilon$, where $\\varepsilon$ is the cusp error. The singular part of the local energy becomes:\n$$\nE_L^{\\text{sing}}(r) = -\\frac{c + \\varepsilon}{\\mu r} + \\frac{V_0}{r} = -\\frac{\\mu V_0 + \\varepsilon}{\\mu r} + \\frac{V_0}{r} = -\\frac{V_0}{r} - \\frac{\\varepsilon}{\\mu r} + \\frac{V_0}{r} = -\\frac{\\varepsilon}{\\mu r}\n$$\nThe variance of this term is computed using the given radial probability density $p(r) = 3r^2/R^3$ for $r \\in [0, R]$. The variance is $\\mathrm{Var}[E_L^{\\text{sing}}] = \\langle (E_L^{\\text{sing}})^2 \\rangle - \\langle E_L^{\\text{sing}} \\rangle^2$.\n\nThe first moment (mean):\n$$\n\\langle E_L^{\\text{sing}} \\rangle = \\int_0^R \\left(-\\frac{\\varepsilon}{\\mu r}\\right) \\frac{3r^2}{R^3} dr = -\\frac{3\\varepsilon}{\\mu R^3} \\int_0^R r dr = -\\frac{3\\varepsilon}{\\mu R^3} \\frac{R^2}{2} = -\\frac{3\\varepsilon}{2\\mu R}\n$$\nThe second moment (mean square):\n$$\n\\langle(E_L^{\\text{sing}})^2\\rangle = \\int_0^R \\left(-\\frac{\\varepsilon}{\\mu r}\\right)^2 \\frac{3r^2}{R^3} dr = \\frac{3\\varepsilon^2}{\\mu^2 R^3} \\int_0^R 1 dr = \\frac{3\\varepsilon^2}{\\mu^2 R^2}\n$$\nThe variance is then:\n$$\n\\mathrm{Var}[E_L^{\\text{sing}}] = \\frac{3\\varepsilon^2}{\\mu^2 R^2} - \\left(-\\frac{3\\varepsilon}{2\\mu R}\\right)^2 = \\frac{3\\varepsilon^2}{\\mu^2 R^2} - \\frac{9\\varepsilon^2}{4\\mu^2 R^2} = \\left(3 - \\frac{9}{4}\\right)\\frac{\\varepsilon^2}{\\mu^2 R^2} = \\frac{3\\varepsilon^2}{4\\mu^2 R^2}\n$$\nFrom this formula, we see that $\\mathrm{Var}[E_L^{\\text{sing}}] \\propto \\varepsilon^2$, so the scaling exponent is $p=2$. The prefactor $K(R)$ defined by $\\mathrm{Var}[E_L^{\\text{sing}}] = K(R)\\varepsilon^2$ is:\n$$\nK(R) = \\frac{3}{4\\mu^2 R^2}\n$$\nThese formulae provide the basis for the numerical calculations in the subsequent implementation. For the numerical task of finding $p$ via a log-log fit of $\\mathrm{Var}$ vs $\\varepsilon$, the relationship $\\log(\\mathrm{Var}) = \\log(K) + 2\\log(\\varepsilon)$ shows that the slope will be exactly $2$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Implements and analyzes a simplified VMC model to quantify the effect\n    of cusp condition violations on the local energy variance.\n    \"\"\"\n\n    test_cases = [\n        # Case A: all-electron e-ion, silicon\n        {'case_id': 'A', 'mu': 1.0, 'R': 0.1, 'epsilons': [0.05, 0.1, 0.2], 'Z': 14},\n        # Case B: all-electron e-e, unlike-spin\n        {'case_id': 'B', 'mu': 0.5, 'R': 0.1, 'epsilons': [0.05, 0.1, 0.2]},\n        # Case C: pseudopotential e-ion, silicon\n        {'case_id': 'C', 'mu': 1.0, 'R': 0.1, 'epsilons': [0.05, 0.1, 0.2]},\n        # Case D: all-electron e-ion, silicon; smaller coalescence radius\n        {'case_id': 'D', 'mu': 1.0, 'R': 0.05, 'epsilons': [0.05, 0.1, 0.2], 'Z': 14},\n        # Case E: boundary check, all-electron e-ion, silicon\n        {'case_id': 'E', 'mu': 1.0, 'R': 0.1, 'epsilons': [0.0], 'Z': 14},\n    ]\n\n    results = []\n\n    def calculate_metrics(mu, R, epsilons):\n        \"\"\"\n        Calculates variance, scaling exponent p, and prefactor K.\n\n        Args:\n            mu (float): Reduced mass of the particle pair.\n            R (float): Cutoff radius for the near-coalescence region.\n            epsilons (list of float): List of cusp error values.\n\n        Returns:\n            A dictionary containing the calculated metrics.\n        \"\"\"\n        # Ensure epsilons are numpy arrays for vectorized operations.\n        epsilons = np.array(epsilons, dtype=float)\n\n        # Derived formula for variance: Var = 3 * epsilon^2 / (4 * mu^2 * R^2)\n        variances = (3 * epsilons**2) / (4 * mu**2 * R**2)\n\n        p = None\n        K = None\n        \n        # Filter out zero epsilon for log-fitting and K calculation.\n        non_zero_mask = epsilons > 0\n        \n        if np.any(non_zero_mask):\n            valid_epsilons = epsilons[non_zero_mask]\n            valid_variances = variances[non_zero_mask]\n\n            # Fit log(Var) vs log(epsilon) to find the exponent p\n            # The theoretical model is Var = K * epsilon^p, so log(Var) = log(K) + p * log(epsilon)\n            # This is a linear relationship y = c + m*x, where p is the slope m.\n            if len(valid_epsilons) > 1:\n                log_eps = np.log(valid_epsilons)\n                log_var = np.log(valid_variances)\n                # Use scipy.stats.linregress for a robust linear fit\n                slope, _, _, _, _ = stats.linregress(log_eps, log_var)\n                p = slope\n\n            # Estimate prefactor K as the mean of Var / epsilon^2\n            ratios = valid_variances / valid_epsilons**2\n            K = np.mean(ratios)\n\n        return {\n            'variances': variances,\n            'p': p,\n            'K': K\n        }\n\n    # Process each test case\n    for case in test_cases:\n        metrics = calculate_metrics(case['mu'], case['R'], case['epsilons'])\n        \n        if case['case_id'] == 'A':\n            results.append(f\"{metrics['p']:.3f}\")\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'B':\n            results.append(f\"{metrics['p']:.3f}\")\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'C':\n            # For Case C (pseudopotential), the Coulomb singularity V0=0, so the exact cusp coefficient is c=0.\n            # However, the derivation for the variance of the singular term E_L^sing = -eps/(mu*r)\n            # is independent of V0. The resulting K(R) is the same formula.\n            # But the problem states \"express the leading singular term as a function of u'(0) and the pair's Coulomb singularity\"\n            # and then get E_L dependence on epsilon. For pseudopotential, V(r) is not 1/r. So E_L^sing has no 1/r term\n            # to be canceled in the first place. A non-zero u'(0) would introduce a 1/r term, so our E_L^sing = -eps/(mu*r) logic still holds if we define eps=u'(0).\n            # So, mu=1.0 for e-ion is correct. The K calculation remains the same.\n            results.append(f\"{metrics['p']:.3f}\")\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'D':\n            # For Case D, only prefactor K is required in the output\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'E':\n            # For Case E, check if the variance is numerically zero\n            variance_at_zero_eps = metrics['variances'][0]\n            is_zero = np.isclose(variance_at_zero_eps, 0.0, atol=1e-12)\n            results.append(str(is_zero))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3482382"}, {"introduction": "After constructing a good trial wavefunction and running a simulation, we are left with a time series of observables like the local energy. To extract a final ground-state energy and a reliable error estimate, we must correctly handle the statistical nature of this data. Unlike independent measurements, data points generated by a Markov Chain Monte Carlo algorithm are serially correlated. Naively applying the standard error of the mean formula will drastically underestimate the true statistical uncertainty. This practice [@problem_id:3482381] walks you through the derivation of the correct formula for the statistical error in the presence of such correlations, introducing the key concept of the integrated autocorrelation time, $\\tau_{\\text{int}}$. It provides the essential statistical toolkit for analyzing any QMC simulation data with rigor and confidence.", "problem": "In a variational Monte Carlo (VMC) calculation for a periodic solid, the local energy $E_{L}(\\mathbf{R})$ is evaluated along a Markov chain $\\{\\mathbf{R}_{i}\\}_{i=1}^{M}$ generated by a Metropolis–Hastings sampler that leaves the target distribution $|\\Psi_{T}(\\mathbf{R})|^{2}$ invariant, where $\\Psi_{T}$ is a normalized trial wavefunction. Assume the chain is stationary and ergodic with a well-defined autocovariance function $C(t) \\equiv \\operatorname{Cov}(E_{L,i},E_{L,i+t})$ and normalized autocorrelation function $\\rho(t) \\equiv C(t)/C(0)$ for lag $t \\in \\mathbb{Z}_{\\ge 0}$. Define the integrated autocorrelation time by\n$$\n\\tau_{\\text{int}} \\equiv \\frac{1}{2} + \\sum_{t=1}^{\\infty} \\rho(t),\n$$\nprovided the series converges absolutely. The sample mean of the local energy is $\\bar{E} \\equiv \\frac{1}{M}\\sum_{i=1}^{M} E_{L,i}$, and let $\\operatorname{Var}(E_{L}) \\equiv C(0)$ denote the stationary variance.\n\nStarting from the definitions above and standard properties of stationary stochastic processes, derive an asymptotic expression for the standard error $\\sigma_{\\bar{E}}$ of the sample mean $\\bar{E}$ in terms of $\\tau_{\\text{int}}$, $\\operatorname{Var}(E_{L})$, and $M$. State clearly the minimal regularity conditions under which a central limit theorem for $\\bar{E}$ holds in this context, and explain how they are typically satisfied or violated in Variational Monte Carlo (VMC), Diffusion Monte Carlo (DMC), and Full Configuration Interaction Quantum Monte Carlo (FCIQMC).\n\nThen, using your derived expression, evaluate the numerical value of $\\sigma_{\\bar{E}}$ for the following parameters measured in a long-run VMC simulation: $\\tau_{\\text{int}}=15.0$, $\\operatorname{Var}(E_{L})=0.42$ Hartree$^{2}$, and $M=6.0\\times 10^{6}$. Express the final standard error in Hartree and round your answer to three significant figures.", "solution": "The problem is valid. It is scientifically grounded in the statistical analysis of Monte Carlo simulations, a cornerstone of computational materials science. The definitions provided are standard, and the problem is well-posed, objective, and self-contained. We will proceed with the solution in three parts: first, the derivation of the standard error; second, a discussion of the central limit theorem's applicability; and third, the numerical calculation.\n\nThe first step is to derive an asymptotic expression for the standard error, $\\sigma_{\\bar{E}}$, of the sample mean $\\bar{E}$. The standard error is defined as the square root of the variance of the sample mean, $\\sigma_{\\bar{E}} \\equiv \\sqrt{\\operatorname{Var}(\\bar{E})}$.\n\nThe sample mean is defined as $\\bar{E} \\equiv \\frac{1}{M}\\sum_{i=1}^{M} E_{L,i}$, where $E_{L,i} \\equiv E_{L}(\\mathbf{R}_i)$ are samples from a stationary stochastic process. The variance of $\\bar{E}$ is:\n$$\n\\operatorname{Var}(\\bar{E}) = \\operatorname{Var}\\left(\\frac{1}{M}\\sum_{i=1}^{M} E_{L,i}\\right) = \\frac{1}{M^{2}} \\operatorname{Var}\\left(\\sum_{i=1}^{M} E_{L,i}\\right)\n$$\nThe variance of a sum of random variables is the sum of all elements in their covariance matrix:\n$$\n\\operatorname{Var}\\left(\\sum_{i=1}^{M} E_{L,i}\\right) = \\sum_{i=1}^{M} \\sum_{j=1}^{M} \\operatorname{Cov}(E_{L,i}, E_{L,j})\n$$\nSince the Markov chain is assumed to be stationary, the covariance depends only on the time lag $t = |i-j|$, i.e., $\\operatorname{Cov}(E_{L,i}, E_{L,j}) = C(|i-j|)$. The double summation can be regrouped by the lag $t$:\n$$\n\\sum_{i=1}^{M} \\sum_{j=1}^{M} C(|i-j|) = \\sum_{i=1}^{M} C(0) + \\sum_{i \\ne j} C(|i-j|) = M C(0) + 2 \\sum_{t=1}^{M-1} (M-t) C(t)\n$$\nHere, the term $(M-t)$ counts the number of pairs $(i,j)$ with a lag of $t$. Substituting this back into the expression for $\\operatorname{Var}(\\bar{E})$ gives the exact result:\n$$\n\\operatorname{Var}(\\bar{E}) = \\frac{1}{M^{2}} \\left[ M C(0) + 2 \\sum_{t=1}^{M-1} (M-t) C(t) \\right] = \\frac{C(0)}{M} \\left[ 1 + 2 \\sum_{t=1}^{M-1} \\left(1 - \\frac{t}{M}\\right) \\frac{C(t)}{C(0)} \\right]\n$$\nWe are asked for an asymptotic expression for large $M$. In this limit, for any fixed lag $t$, the term $t/M \\to 0$. Since the process is ergodic, the autocovariance $C(t)$ must decay to $0$ as $t \\to \\infty$, and the sum is dominated by terms with small $t$. Thus, for large $M$, we can approximate $(1 - t/M) \\approx 1$ and extend the upper limit of the sum to infinity:\n$$\n\\operatorname{Var}(\\bar{E}) \\approx \\frac{C(0)}{M} \\left[ 1 + 2 \\sum_{t=1}^{\\infty} \\frac{C(t)}{C(0)} \\right]\n$$\nUsing the definitions $\\rho(t) \\equiv C(t)/C(0)$ and $\\operatorname{Var}(E_{L}) \\equiv C(0)$, we have:\n$$\n\\operatorname{Var}(\\bar{E}) \\approx \\frac{\\operatorname{Var}(E_{L})}{M} \\left[ 1 + 2 \\sum_{t=1}^{\\infty} \\rho(t) \\right]\n$$\nThe problem defines the integrated autocorrelation time as $\\tau_{\\text{int}} \\equiv \\frac{1}{2} + \\sum_{t=1}^{\\infty} \\rho(t)$. We can rearrange this to express the sum as $\\sum_{t=1}^{\\infty} \\rho(t) = \\tau_{\\text{int}} - \\frac{1}{2}$. Substituting this into our expression for the variance:\n$$\n\\operatorname{Var}(\\bar{E}) \\approx \\frac{\\operatorname{Var}(E_{L})}{M} \\left[ 1 + 2 \\left(\\tau_{\\text{int}} - \\frac{1}{2}\\right) \\right] = \\frac{\\operatorname{Var}(E_{L})}{M} [1 + 2\\tau_{\\text{int}} - 1] = \\frac{2 \\tau_{\\text{int}} \\operatorname{Var}(E_{L})}{M}\n$$\nThe standard error $\\sigma_{\\bar{E}}$ is the square root of the variance:\n$$\n\\sigma_{\\bar{E}} \\approx \\sqrt{\\frac{2 \\tau_{\\text{int}} \\operatorname{Var}(E_{L})}{M}}\n$$\nThis expression reveals that the variance of the mean is inflated by a factor of $2\\tau_{\\text{int}}$ compared to the case of $M$ independent samples. The quantity $M_{\\text{eff}} = M / (2\\tau_{\\text{int}})$ is often interpreted as the effective number of independent samples.\n\nNext, we discuss the minimal regularity conditions for a central limit theorem (CLT) for the sample mean $\\bar{E}$ to hold, and their status in VMC, DMC, and FCIQMC. The CLT for stationary, dependent processes states that $\\sqrt{M}(\\bar{E} - \\mathbb{E}[E_{L}])$ converges in distribution to a normal distribution $\\mathcal{N}(0, \\sigma^2_{\\text{CLT}})$ as $M \\to \\infty$. The minimal conditions for this are:\n1.  The process $\\{E_{L,i}\\}$ must be stationary and ergodic. This is given in the problem statement and is a design goal of the Metropolis-Hastings algorithm.\n2.  The variance of the local energy, $\\operatorname{Var}(E_{L}) = C(0)$, must be finite. More generally, some theorems require the existence of moments higher than the second, e.g., $\\mathbb{E}[|E_{L}|^{2+\\delta}] < \\infty$ for some $\\delta > 0$.\n3.  The correlations must decay sufficiently rapidly. A sufficient condition is the absolute summability of the autocovariance function, $\\sum_{t=0}^{\\infty} |C(t)| < \\infty$. This ensures that the variance of the limiting normal distribution, $\\sigma^2_{\\text{CLT}} = \\sum_{t=-\\infty}^{\\infty} C(t) = 2\\tau_{\\text{int}}\\operatorname{Var}(E_{L})$, is finite.\n\nDiscussion for specific QMC methods:\n-   **Variational Monte Carlo (VMC):** The local energy is $E_{L}(\\mathbf{R}) = (\\hat{H}\\Psi_T(\\mathbf{R}))/\\Psi_T(\\mathbf{R})$. If the nodes of the trial wavefunction $\\Psi_T$ do not match the nodes of the exact eigenstate, $E_L$ diverges at the nodal surface where $\\Psi_T(\\mathbf{R})=0$. While the sampling probability $|\\Psi_T|^2$ is also zero at the nodes, the sampler can approach arbitrarily close, leading to extremely large values of $E_L$. This can cause the distribution of $E_L$ to be heavy-tailed, potentially with infinite variance. Thus, condition (2) is not guaranteed and can be violated. In practice, for good quality wavefunctions, the variance is often treated as finite, but its formal existence can be questionable. Correlation decay (condition 3) is generally satisfied.\n-   **Diffusion Monte Carlo (DMC):** DMC suffers from the same issue. In fixed-node DMC, the local energy $E_L$ is used as an estimator. It diverges at the prescribed nodal surface of the guiding function $\\Psi_T$. This violation of condition (2) is a well-known, practical problem in DMC, especially for systems with deep core potentials, leading to unstable energy fluctuations and making the applicability of the standard CLT formally invalid. Statistical analysis often proceeds under the assumption that the CLT holds, but this is a practical choice rather than a rigorously justified one.\n-   **Full Configuration Interaction QMC (FCIQMC):** This method works in a discrete basis of Slater determinants. The energy is typically computed via a projected estimator, such as $E = \\langle \\Psi_{\\text{ref}} | H | \\Psi \\rangle / \\langle \\Psi_{\\text{ref}} | \\Psi \\rangle$, where $|\\Psi\\rangle$ is the stochastic representation of the wavefunction. The quantities being sampled are walker populations on determinants, and these estimators do not suffer from the divergences associated with real-space nodal surfaces. The variances of the numerator and denominator are typically finite. Therefore, the conditions for the CLT are generally met, assuming the simulation has reached stationarity. The primary statistical challenge in FCIQMC is often a large autocorrelation time $\\tau_{\\text{int}}$, not an infinite variance.\n\nFinally, we evaluate the numerical value of $\\sigma_{\\bar{E}}$ using the provided parameters.\nThe derived expression is $\\sigma_{\\bar{E}} = \\sqrt{\\frac{2 \\tau_{\\text{int}} \\operatorname{Var}(E_{L})}{M}}$.\nThe given parameters are:\n-   $\\tau_{\\text{int}} = 15.0$\n-   $\\operatorname{Var}(E_{L}) = 0.42 \\, \\text{Hartree}^2$\n-   $M = 6.0 \\times 10^{6}$\n\nSubstituting these values into the formula:\n$$\n\\sigma_{\\bar{E}} = \\sqrt{\\frac{2 \\times 15.0 \\times 0.42}{6.0 \\times 10^{6}}} \\, \\text{Hartree}\n$$\n$$\n\\sigma_{\\bar{E}} = \\sqrt{\\frac{12.6}{6.0 \\times 10^{6}}} \\, \\text{Hartree}\n$$\n$$\n\\sigma_{\\bar{E}} = \\sqrt{2.1 \\times 10^{-6}} \\, \\text{Hartree}\n$$\n$$\n\\sigma_{\\bar{E}} = \\sqrt{2.1} \\times 10^{-3} \\, \\text{Hartree} \\approx 1.449137... \\times 10^{-3} \\, \\text{Hartree}\n$$\nRounding the result to three significant figures, we get:\n$$\n\\sigma_{\\bar{E}} \\approx 1.45 \\times 10^{-3} \\, \\text{Hartree}\n$$", "answer": "$$\\boxed{1.45 \\times 10^{-3}}$$", "id": "3482381"}]}