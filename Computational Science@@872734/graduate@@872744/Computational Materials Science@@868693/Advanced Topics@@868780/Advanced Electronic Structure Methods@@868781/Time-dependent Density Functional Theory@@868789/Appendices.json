{"hands_on_practices": [{"introduction": "Time-dependent density functional theory offers two powerful computational frameworks: real-time propagation and linear-response theory. This exercise provides a foundational, hands-on demonstration of their formal equivalence by guiding you to compute optical oscillator strengths using both methods [@problem_id:3497347]. By verifying that the results from the time-domain delta-kick approach and the frequency-domain Casida formalism are identical in the independent-particle limit, you will gain a deeper appreciation for the connection between a system's dynamic response and its spectral properties.", "problem": "You are asked to implement, verify, and compare two equivalent formulations of optical oscillator strengths within Time-Dependent Density Functional Theory (TDDFT): the linear-response Casida formalism and the real-time delta-kick approach. Your goal is to derive from fundamental definitions the linear-response expression for oscillator strengths using Casida eigenvectors and then to demonstrate numerically that these oscillator strengths are equal to those extracted from the time-domain dipole dynamics after a weak impulsive field (delta-kick). Work in atomic units throughout so that energies are in Hartree, times are in atomic units of time, and dipole matrix elements are in Bohr. Oscillator strengths are dimensionless.\n\nStart from the following fundamental base:\n- The Time-Dependent Kohn–Sham (TDKS) equations for Kohn–Sham orbitals $\\{\\phi_{k}(\\mathbf{r},t)\\}$ with a time-dependent Kohn–Sham potential $v_{s}[\\rho](\\mathbf{r},t)$.\n- The definition of linear response as the first-order change of an observable due to a weak external perturbation.\n- The standard Casida equation structure for excitation energies in the particle–hole basis, with matrices $\\mathbf{A}$ and $\\mathbf{B}$ built from Kohn–Sham single-particle energy differences and two-particle interaction kernels.\n- The definition of oscillator strength in terms of transition dipole matrix elements between the ground state and excited states.\n- The real-time delta-kick method: applying an impulsive electric field at $t=0$ and recording the induced dipole moment $d_{\\alpha}(t)$ for $t0$, where $\\alpha \\in \\{x,y,z\\}$.\n\nYour implementation must proceed as follows:\n1. Implement the linear-response route in the independent-particle (no coupling kernel) limit. In this limit, the Casida $\\mathbf{A}$ matrix is diagonal with diagonal entries equal to Kohn–Sham transition energies $\\omega_{n}$ and $\\mathbf{B}=\\mathbf{0}$. The Casida eigenvectors then select individual transitions. Using this, compute the oscillator strengths from Casida eigenvectors and the provided Kohn–Sham transition dipole vectors $\\mathbf{d}_{n} = (d_{n,x}, d_{n,y}, d_{n,z})$. Compute isotropic oscillator strengths using all three Cartesian components.\n2. Implement the real-time route by applying a weak impulsive field of amplitude $k$ at $t=0$, recording the induced dipole components $d_{\\alpha}(t)$ for $t \\in (0,T]$ on a uniform grid of spacing $\\Delta t$. Assume the independent-particle regime so that the induced dipole is a superposition of sines at the Kohn–Sham transition energies. Use a least-squares projection onto the known sine basis at the known transition frequencies to extract component-resolved amplitudes and reconstruct oscillator strengths.\n3. Demonstrate equivalence by computing, for each test case, the maximum absolute difference between the oscillator strengths obtained from the Casida route and those extracted from the real-time route.\n\nUse the following scientifically consistent test suite. Each test case provides a set of transitions characterized by transition energies and transition dipole vectors. Use a common time grid for all cases with total duration $T = 6000$ (atomic units) and time step $\\Delta t = 0.5$ (atomic units), and a kick amplitude $k = 10^{-4}$ (atomic units). For each case, treat the directions $x$, $y$, and $z$ equivalently and include all three components of the transition dipole vector in the isotropic oscillator strength.\n\n- Test Case A (single transition, all components nonzero):\n  - Transitions: one transition with energy $\\omega_{1} = 0.7$ and dipole vector $\\mathbf{d}_{1} = (0.8, 0.3, 0.1)$.\n\n- Test Case B (multiple transitions with a symmetry-forbidden one):\n  - Transitions: three transitions with energies and dipole vectors\n    - $\\omega_{1} = 0.5$, $\\mathbf{d}_{1} = (0.6, 0, 0)$,\n    - $\\omega_{2} = 1.2$, $\\mathbf{d}_{2} = (0, 0, 0)$,\n    - $\\omega_{3} = 1.8$, $\\mathbf{d}_{3} = (0.2, 0.3, 0.4)$.\n\n- Test Case C (near-degenerate transitions to test frequency resolution):\n  - Transitions: three transitions with energies and dipole vectors\n    - $\\omega_{1} = 0.300$, $\\mathbf{d}_{1} = (0.4, 0.1, 0)$,\n    - $\\omega_{2} = 0.305$, $\\mathbf{d}_{2} = (0.1, 0.3, 0.05)$,\n    - $\\omega_{3} = 0.9$, $\\mathbf{d}_{3} = (0.2, 0, 0.1)$.\n\nRequirements and constraints:\n- Work strictly in the independent-particle limit for both routes.\n- In the linear-response route, construct the Casida problem in the particle–hole basis with $\\mathbf{A}$ diagonal elements equal to the given $\\omega_{n}$ and $\\mathbf{B}=\\mathbf{0}$, and use the definition of oscillator strength in terms of Casida amplitudes and transition dipoles to compute the isotropic oscillator strengths for all transitions in each test case.\n- In the real-time route, apply a delta-kick of amplitude $k$ at $t=0$ and record $d_{\\alpha}(t)$ on the grid $t_{m} = m \\Delta t$ for $m=1,2,\\dots,M$ such that $M \\Delta t = T$. Model the induced dipole as a linear superposition of sines at the known transition frequencies and recover the amplitude coefficients by least-squares projection. Use these coefficients to reconstruct isotropic oscillator strengths.\n- For each test case, compute a single scalar: the maximum absolute deviation between the set of oscillator strengths from linear response and from real time. These scalars are dimensionless and must be printed as decimal floats rounded to ten decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing a Python-like list literal of the three scalar results corresponding to Test Cases A, B, and C, in that order, rounded to ten decimal places, for example, \"[0.0000000001,0.0000000002,0.0000000003]\".\n- No additional text should be printed.\n\nPhysical units and conventions:\n- Use atomic units. Energies $\\omega_{n}$ are in Hartree, dipole components in Bohr, time in atomic units of time. Oscillator strengths are unitless.", "solution": "The problem is valid. It is scientifically grounded in the principles of time-dependent density functional theory, is well-posed with all necessary constants and conditions provided, and is formulated objectively. The task is to demonstrate the formal equivalence of the linear-response (Casida) and real-time (delta-kick) methods for calculating oscillator strengths in the simplified non-interacting particle limit.\n\nWe will first derive the expressions for the oscillator strength in each formalism and then describe the numerical procedure to verify their equivalence. We work exclusively in atomic units, where $\\hbar = m_e = e = 4\\pi\\varepsilon_0 = 1$.\n\n### Theoretical Framework\n\nThe oscillator strength, $f_{0 \\to I}$, for an electronic excitation from the ground state $\\Psi_0$ to an excited state $\\Psi_I$ with excitation energy $\\Omega_I = E_I - E_0$ is a dimensionless quantity that measures the transition probability. The isotropically averaged expression is given by:\n$$\nf_I = \\frac{2}{3} \\Omega_I \\sum_{\\alpha \\in \\{x,y,z\\}} |\\langle \\Psi_0 | \\hat{r}_\\alpha | \\Psi_I \\rangle|^2\n$$\nwhere $\\hat{\\mathbf{r}} = (\\hat{r}_x, \\hat{r}_y, \\hat{r}_z)$ is the position operator.\n\nThe problem requires us to evaluate this quantity using two different but equivalent approaches within the independent-particle approximation of TDDFT. In this limit, the interacting Kohn-Sham response kernel is ignored. The excited states $\\Psi_I$ are considered pure single particle-hole excitations from an occupied Kohn-Sham orbital $\\phi_i$ to a virtual orbital $\\phi_a$. We denote such a transition by the index $n=(i,a)$.\n\n#### 1. Linear-Response (Casida) Formulation\n\nIn the independent-particle limit, the Casida matrices $\\mathbf{A}$ and $\\mathbf{B}$ simplify significantly. The matrix $\\mathbf{B}$, which arises from exchange-correlation kernel interactions, becomes the zero matrix, $\\mathbf{B}=\\mathbf{0}$. The matrix $\\mathbf{A}$ becomes diagonal in the particle-hole basis, with its diagonal elements being the Kohn-Sham orbital energy differences, $A_{ia,jb} = (\\varepsilon_a - \\varepsilon_i) \\delta_{ij}\\delta_{ab} = \\omega_n \\delta_{n,m}$, where $n=(i,a)$ and $m=(j,b)$.\n\nConsequently, the TDDFT excitation energies $\\Omega_n$ become identical to the Kohn-Sham transition energies $\\omega_n$. The corresponding excited state $\\Psi_n$ is a single configuration state corresponding to the transition $n$. The transition dipole matrix element simplifies to:\n$$\n\\langle \\Psi_0 | \\hat{r}_\\alpha | \\Psi_n \\rangle \\rightarrow \\langle \\phi_i | \\hat{r}_\\alpha | \\phi_a \\rangle \\equiv d_{n,\\alpha}\n$$\nThe problem provides these transition energies $\\omega_n$ and dipole vectors $\\mathbf{d}_n = (d_{n,x}, d_{n,y}, d_{n,z})$ directly.\n\nSubstituting these into the fundamental expression for the oscillator strength, we obtain the formula for the linear-response route:\n$$\nf_{n, \\text{LR}} = \\frac{2}{3} \\omega_n \\sum_{\\alpha \\in \\{x,y,z\\}} |d_{n,\\alpha}|^2 = \\frac{2}{3} \\omega_n |\\mathbf{d}_n|^2\n$$\nThis provides a direct analytical result for the oscillator strengths based on the given transition properties.\n\n#### 2. Real-Time Delta-Kick Formulation\n\nThe real-time approach probes the system's dynamic response by applying a weak, impulsive electric field perturbation at time $t=0$ and observing the subsequent evolution of the dipole moment. We perform three separate simulations, one for each Cartesian direction $\\alpha \\in \\{x,y,z\\}$. The external electric field for a kick in direction $\\alpha$ is $\\mathbf{E}(t) = k \\delta(t) \\hat{\\mathbf{e}}_\\alpha$, where $k$ is the small kick strength.\n\nThis field corresponds to a time-dependent potential $V_{\\text{ext}}(t) = -\\mathbf{r} \\cdot \\mathbf{E}(t) = -k r_\\alpha \\delta(t)$. In first-order time-dependent perturbation theory, the state of the system at time $t>0$ is given by $\\Psi(t) = e^{-i\\hat{H}_0 t} \\Psi(0^+)$, where $\\hat{H}_0$ is the unperturbed Hamiltonian and $\\Psi(0^+) \\approx (1 + ik r_\\alpha) \\Psi_0$.\n\nThe induced dipole moment in direction $\\beta$ due to a kick in direction $\\alpha$, denoted $\\delta d_{\\beta}^{(\\alpha)}(t)$, is given by:\n$$\n\\delta d_{\\beta}^{(\\alpha)}(t) = \\langle \\Psi(t) | \\hat{r}_\\beta | \\Psi(t) \\rangle - \\langle \\Psi_0 | \\hat{r}_\\beta | \\Psi_0 \\rangle\n$$\nExpanding to first order in $k$ and assuming the ground state has no permanent dipole, we find:\n$$\n\\delta d_{\\beta}^{(\\alpha)}(t) = i k \\langle \\Psi_0 | [\\hat{r}_\\beta(t), \\hat{r}_\\alpha] | \\Psi_0 \\rangle\n$$\nwhere $\\hat{r}_\\beta(t) = e^{i\\hat{H}_0 t} \\hat{r}_\\beta e^{-i\\hat{H}_0 t}$ is the operator in the interaction picture. Inserting a complete set of eigenstates of $\\hat{H}_0$ and using the independent-particle approximation yields:\n$$\n\\delta d_{\\beta}^{(\\alpha)}(t) = 2k \\sum_n d_{n,\\beta} d_{n,\\alpha} \\sin(\\omega_n t)\n$$\nFor the procedure, we are interested in the response parallel to the kick, i.e., $\\beta = \\alpha$. The signal is:\n$$\nd_{\\alpha}^{(\\alpha)}(t) = 2k \\sum_n (d_{n,\\alpha})^2 \\sin(\\omega_n t)\n$$\nThis equation shows that the time-dependent dipole is a superposition of sine functions, oscillating at the system's natural transition frequencies $\\omega_n$. The amplitude of each sine component is directly proportional to the squared transition dipole moment component, $(d_{n,\\alpha})^2$.\n\n### Numerical Implementation and Verification\n\nThe strategy is to numerically extract the amplitudes from the simulated real-time signal and reconstruct the oscillator strengths, then compare them to the analytical linear-response results.\n\n1.  **Linear-Response Calculation**: For each test case, we iterate through its given transitions ($n$). For each transition, we compute the oscillator strength $f_{n, \\text{LR}}$ using the formula $f_{n, \\text{LR}} = \\frac{2}{3} \\omega_n |\\mathbf{d}_n|^2$.\n\n2.  **Real-Time Simulation and Extraction**:\n    *   We define a uniform time grid $t_m = m \\Delta t$ for $m=1, 2, \\dots, M$, where $M\\Delta t = T$.\n    *   We loop through the three Cartesian directions $\\alpha \\in \\{x,y,z\\}$.\n    *   For each direction $\\alpha$, we generate the \"measured\" dipole signal $y_m = d_{\\alpha}^{(\\alpha)}(t_m)$ using the formula derived above.\n    *   The signal can be written as a linear combination of basis functions: $y(t) = \\sum_n C_{n,\\alpha} \\sin(\\omega_n t)$, where the coefficients are $C_{n,\\alpha} = 2k (d_{n,\\alpha})^2$.\n    *   To find these coefficients from the signal, we solve a linear least-squares problem. We set up the system $\\mathbf{y} = \\mathbf{S} \\mathbf{c}_\\alpha$, where $\\mathbf{y}$ is the vector of signal values $[y_1, \\dots, y_M]^T$, $\\mathbf{S}$ is the basis matrix with elements $S_{mn} = \\sin(\\omega_n t_m)$, and $\\mathbf{c}_\\alpha$ is the vector of unknown coefficients $[C_{1,\\alpha}, C_{2,\\alpha}, \\dots]^T$. The least-squares solution $\\mathbf{c}_\\alpha = (\\mathbf{S}^T\\mathbf{S})^{-1}\\mathbf{S}^T\\mathbf{y}$ is computed numerically, for instance using `numpy.linalg.lstsq`.\n    *   From the recovered coefficients $C_{n,\\alpha}$, we calculate the squared transition dipole components: $(d_{n,\\alpha,\\text{RT}})^2 = C_{n,\\alpha} / (2k)$. This step is performed for each transition $n$.\n\n3.  **Reconstruction and Comparison**:\n    *   After iterating through all three kick directions, we have the numerically recovered dipole components $(d_{n,x,\\text{RT}})^2, (d_{n,y,\\text{RT}})^2, (d_{n,z,\\text{RT}})^2$ for each transition $n$.\n    *   We sum them to get the total squared dipole moment: $|\\mathbf{d}_{n,\\text{RT}}|^2 = \\sum_\\alpha (d_{n,\\alpha,\\text{RT}})^2$.\n    *   We then compute the real-time oscillator strengths: $f_{n, \\text{RT}} = \\frac{2}{3} \\omega_n |\\mathbf{d}_{n,\\text{RT}}|^2$.\n    *   Finally, for each test case, we compute the set of absolute differences $\\{|f_{n, \\text{LR}} - f_{n, \\text{RT}}|\\}$ for all its transitions and report the maximum value in this set. The long simulation time $T$ relative to the periods of oscillation ensures the basis functions are nearly orthogonal, leading to a stable least-squares fit and a final difference that is close to machine precision, thus demonstrating the equivalence of the two formalisms.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements, verifies, and compares linear-response and real-time formulations\n    of optical oscillator strengths within Time-Dependent Density Functional Theory (TDDFT)\n    in the independent-particle limit.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    T = 6000.0  # Total simulation time in atomic units\n    dt = 0.5    # Time step in atomic units\n    k = 1e-4    # Kick amplitude in atomic units\n\n    # --- Test Case Definitions ---\n    # Each case: list of transitions.\n    # Each transition: tuple of (energy, (dx, dy, dz))\n    test_cases = [\n        # Test Case A: single transition\n        [\n            (0.7, (0.8, 0.3, 0.1)),\n        ],\n        # Test Case B: multiple transitions, one forbidden\n        [\n            (0.5, (0.6, 0.0, 0.0)),\n            (1.2, (0.0, 0.0, 0.0)),\n            (1.8, (0.2, 0.3, 0.4)),\n        ],\n        # Test Case C: near-degenerate transitions\n        [\n            (0.300, (0.4, 0.1, 0.0)),\n            (0.305, (0.1, 0.3, 0.05)),\n            (0.9,   (0.2, 0.0, 0.1)),\n        ],\n    ]\n\n    # --- Time Grid ---\n    num_steps = int(T / dt)\n    time_grid = np.arange(1, num_steps + 1) * dt\n\n    final_results = []\n\n    for transitions in test_cases:\n        num_transitions = len(transitions)\n        omegas = np.array([t[0] for t in transitions])\n        dipoles = np.array([t[1] for t in transitions])\n\n        # --- Route 1: Linear-Response (Casida) Calculation ---\n        # f_n = (2/3) * omega_n * |d_n|^2\n        f_lr = (2.0 / 3.0) * omegas * np.sum(dipoles**2, axis=1)\n\n        # --- Route 2: Real-Time Delta-Kick Calculation ---\n        \n        # This will store the recovered squared dipole components [d_nx^2, d_ny^2, d_nz^2] for each transition n\n        d_sq_rt = np.zeros((num_transitions, 3))\n        \n        # Construct the sine basis matrix S: S_mn = sin(omega_n * t_m)\n        # S has shape (num_steps, num_transitions)\n        S = np.sin(np.outer(time_grid, omegas))\n        \n        # Perform calculations for each Cartesian direction (kick in x, y, z)\n        for alpha in range(3):  # 0:x, 1:y, 2:z\n            # Get the dipole components for the current direction\n            d_alpha_components = dipoles[:, alpha]\n            \n            # Generate the ideal time-domain dipole signal\n            # d_alpha(t) = 2 * k * sum_n [ d_{n,alpha}^2 * sin(omega_n * t) ]\n            d_alpha_sq = d_alpha_components**2\n            amplitudes = 2.0 * k * d_alpha_sq\n            \n            # Signal y is a vector of length num_steps\n            signal = S @ amplitudes\n            \n            # Solve the least-squares problem: S * c = signal\n            # np.linalg.lstsq returns a tuple; the first element is the solution vector c.\n            # rcond=None ensures use of machine precision for cutoff.\n            coeffs, _, _, _ = np.linalg.lstsq(S, signal, rcond=None)\n            \n            # Recover squared dipole components from coefficients: C_n,alpha = 2k * d_n,alpha^2\n            recovered_d_sq = coeffs / (2.0 * k)\n            d_sq_rt[:, alpha] = recovered_d_sq\n            \n        # Reconstruct oscillator strengths from the recovered dipole components\n        f_rt = (2.0 / 3.0) * omegas * np.sum(d_sq_rt, axis=1)\n        \n        # --- Comparison ---\n        # Calculate the maximum absolute deviation for the current test case\n        max_deviation = np.max(np.abs(f_lr - f_rt))\n        final_results.append(max_deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.10f}' for r in final_results])}]\")\n\nsolve()\n\n```", "id": "3497347"}, {"introduction": "A crucial step in mastering TDDFT is understanding its limitations, particularly the dramatic failure of local and semi-local approximations for charge-transfer (CT) excitations. This practice explores this fundamental issue using a model donor-acceptor system, where you will quantitatively analyze the error in the CT energy as a function of separation distance $R$ [@problem_id:3497374]. By contrasting the incorrect, distance-independent prediction of the adiabatic local density approximation (ALDA) with the physically correct $-1/R$ asymptotic behavior recovered by range-separated hybrids, you will see firsthand why the choice of exchange-correlation functional is critical for describing charge separation.", "problem": "Develop a program that models, analyzes, and quantifies the asymptotic behavior of charge-transfer excitation energies within time-dependent density functional theory (TDDFT) for a well-separated donor–acceptor pair. The aim is to compare the adiabatic local density approximation (ALDA) and a range-separated hybrid (RSH) formulation in the linear-response regime, focusing on the presence or absence of the long-range electron–hole attraction term that scales as $1/R$. All calculations must be performed in atomic units, with energy in Hartree and distance in Bohr. Your output must be a single line containing a comma-separated list enclosed in square brackets as specified below.\n\nFundamental base and modeling assumptions:\n- Consider a donor with ionization energy $I_D$ and an acceptor with electron affinity $A_A$. For large separation $R$ and negligible orbital overlap, the exact lowest charge-transfer excitation energy is modeled as\n$$\nE_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (I_D - A_A) - \\frac{1}{R},\n$$\nin atomic units.\n- Within linear-response TDDFT using an adiabatic local density approximation (ALDA) kernel, the kernel correction to the Kohn–Sham energy difference decays with overlap and can be neglected at large $R$. Let $\\Delta_{\\mathrm{xc}}$ denote the derivative discontinuity of the exchange–correlation potential. The ALDA prediction is then modeled as\n$$\nE_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) = (I_D - A_A) - \\Delta_{\\mathrm{xc}},\n$$\nindependent of $R$.\n- For a range-separated hybrid (RSH) with one hundred percent long-range exact exchange in the kernel, the long-range electron–hole attraction is recovered. Let $\\delta_{\\mathrm{RSH}}$ denote a constant short-range bias in the effective gap. The RSH prediction is modeled as\n$$\nE_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) = (I_D - A_A) - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}.\n$$\n\nFor each test case below, do the following:\n1. Define $E_{\\mathrm{gap}} \\equiv (I_D - A_A)$ as a given constant for that case. Compute the exact charge-transfer excitation $E_{\\mathrm{CT}}^{\\mathrm{exact}}(R)$ at each specified $R$.\n2. Compute the ALDA prediction $E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R)$ and the RSH prediction $E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R)$ at each $R$.\n3. Define the model errors as\n$$\n\\varepsilon_{\\mathrm{ALDA}}(R) = E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R), \\quad\n\\varepsilon_{\\mathrm{RSH}}(R) = E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R).\n$$\n4. For each method, perform a linear regression of error versus $x = 1/R$:\n$$\n\\varepsilon \\approx m x + b,\n$$\nand report the fitted slope $m$ and intercept $b$.\n5. For each method, compute the maximum absolute error over the set of $R$ values:\n$$\n\\varepsilon_{\\max} = \\max_{R} \\left| \\varepsilon(R) \\right|.\n$$\n\nTest suite (three independent parameter sets), all in atomic units (Hartree for energy, Bohr for distance):\n- Case $1$: $E_{\\mathrm{gap}} = 0.30$, $\\Delta_{\\mathrm{xc}} = 0.15$, $\\delta_{\\mathrm{RSH}} = 0.02$, $R \\in \\{ 5.0, 8.0, 12.0, 20.0 \\}$.\n- Case $2$: $E_{\\mathrm{gap}} = 0.22$, $\\Delta_{\\mathrm{xc}} = 0.00$, $\\delta_{\\mathrm{RSH}} = 0.01$, $R \\in \\{ 10.0, 15.0, 25.0, 50.0 \\}$.\n- Case $3$: $E_{\\mathrm{gap}} = 0.45$, $\\Delta_{\\mathrm{xc}} = 0.20$, $\\delta_{\\mathrm{RSH}} = 0.05$, $R \\in \\{ 3.0, 4.0, 5.0, 10.0 \\}$.\n\nRequired outputs per case:\n- The fitted slope and intercept for ALDA error, denoted $m_{\\mathrm{ALDA}}$ and $b_{\\mathrm{ALDA}}$.\n- The fitted slope and intercept for RSH error, denoted $m_{\\mathrm{RSH}}$ and $b_{\\mathrm{RSH}}$.\n- The maximum absolute error for ALDA, $\\varepsilon_{\\max}^{\\mathrm{ALDA}}$.\n- The maximum absolute error for RSH, $\\varepsilon_{\\max}^{\\mathrm{RSH}}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all three cases concatenated in order, as a comma-separated list enclosed in square brackets, with each floating-point number rounded to six decimal places. The per-case order is\n$$\n\\left[ m_{\\mathrm{ALDA}}, b_{\\mathrm{ALDA}}, m_{\\mathrm{RSH}}, b_{\\mathrm{RSH}}, \\varepsilon_{\\max}^{\\mathrm{ALDA}}, \\varepsilon_{\\max}^{\\mathrm{RSH}} \\right].\n$$\nAggregate the three cases sequentially into a single flat list. For example, the overall output structure is\n$$\n[ \\text{case 1 six values}, \\text{case 2 six values}, \\text{case 3 six values} ].\n$$", "solution": "The problem statement is evaluated based on the established criteria for validity.\n\n**Step 1: Extracted Givens**\n- **Exact Charge-Transfer (CT) Energy Model**: $E_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (I_D - A_A) - \\frac{1}{R}$\n- **Adiabatic Local Density Approximation (ALDA) CT Energy Model**: $E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) = (I_D - A_A) - \\Delta_{\\mathrm{xc}}$\n- **Range-Separated Hybrid (RSH) CT Energy Model**: $E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) = (I_D - A_A) - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}$\n- **Definition of Gap**: $E_{\\mathrm{gap}} \\equiv (I_D - A_A)$\n- **Definition of Errors**: $\\varepsilon_{\\mathrm{ALDA}}(R) = E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R)$ and $\\varepsilon_{\\mathrm{RSH}}(R) = E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R)$\n- **Analysis Tasks**:\n    1. Linear regression of error $\\varepsilon$ versus $x = 1/R$ to find slope $m$ and intercept $b$.\n    2. Calculation of maximum absolute error $\\varepsilon_{\\max} = \\max_{R} |\\varepsilon(R)|$.\n- **Test Case 1**: $E_{\\mathrm{gap}} = 0.30$, $\\Delta_{\\mathrm{xc}} = 0.15$, $\\delta_{\\mathrm{RSH}} = 0.02$, $R \\in \\{ 5.0, 8.0, 12.0, 20.0 \\}$.\n- **Test Case 2**: $E_{\\mathrm{gap}} = 0.22$, $\\Delta_{\\mathrm{xc}} = 0.00$, $\\delta_{\\mathrm{RSH}} = 0.01$, $R \\in \\{ 10.0, 15.0, 25.0, 50.0 \\}$.\n- **Test Case 3**: $E_{\\mathrm{gap}} = 0.45$, $\\Delta_{\\mathrm{xc}} = 0.20$, $\\delta_{\\mathrm{RSH}} = 0.05$, $R \\in \\{ 3.0, 4.0, 5.0, 10.0 \\}$.\n- **Units**: All quantities are specified to be in atomic units (Hartree for energy, Bohr for distance).\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective.\n1.  **Scientifically Grounded**: The problem addresses a well-known and fundamental issue in time-dependent density functional theory (TDDFT): the failure of local and semi-local exchange-correlation (xc) functionals to describe long-range charge-transfer excitations. The provided models for the exact, ALDA, and RSH excitation energies are standard, simplified representations used in the scientific literature to illustrate this concept. The term $(I_D - A_A) - 1/R$ correctly describes the energy of an electron-hole pair at large separation $R$. The ALDA model correctly omits the $1/R$ term, reflecting the lack of long-range response in the xc kernel, which leads to an erroneous, distance-independent excitation energy. The RSH model correctly reintroduces the $1/R$ term, reflecting the asymptotic correction provided by including a fraction of Hartree-Fock exchange at long range.\n2.  **Well-Posed**: The problem is fully specified. For each test case, all necessary parameters and variables ($E_{\\mathrm{gap}}$, $\\Delta_{\\mathrm{xc}}$, $\\delta_{\\mathrm{RSH}}$, and the set of $R$ values) are provided. The required calculations—computation of errors, linear regression, and determination of maximum error—are unambiguous and lead to a unique, stable, and meaningful solution.\n3.  **Objective**: The problem is stated in precise, quantitative terms. The models are presented as explicit assumptions. There are no subjective elements or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be provided.\n\n**Principle-Based Solution**\n\nThe objective is to analyze the error of two different TDDFT approximations (ALDA and RSH) for modeling charge-transfer excitations as a function of the donor-acceptor distance $R$. The analysis involves a linear regression of the error against the inverse distance, $x = 1/R$.\n\n**Theoretical Analysis of Model Errors**\n\nFirst, we derive the analytical form of the error for each approximation. Let $E_{\\mathrm{gap}} \\equiv I_D - A_A$.\n\nThe exact charge-transfer excitation energy is given by:\n$$\nE_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = E_{\\mathrm{gap}} - \\frac{1}{R}\n$$\n\nThe ALDA prediction is:\n$$\nE_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) = E_{\\mathrm{gap}} - \\Delta_{\\mathrm{xc}}\n$$\n\nThe RSH prediction is:\n$$\nE_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) = E_{\\mathrm{gap}} - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}\n$$\n\nThe error for the ALDA model, $\\varepsilon_{\\mathrm{ALDA}}(R)$, is defined as:\n$$\n\\varepsilon_{\\mathrm{ALDA}}(R) = E_{\\mathrm{CT}}^{\\mathrm{ALDA}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (E_{\\mathrm{gap}} - \\Delta_{\\mathrm{xc}}) - (E_{\\mathrm{gap}} - \\frac{1}{R})\n$$\n$$\n\\varepsilon_{\\mathrm{ALDA}}(R) = \\frac{1}{R} - \\Delta_{\\mathrm{xc}}\n$$\nThis expression reveals the fundamental failure of ALDA for CT states: the error grows linearly with $1/R$ and diverges as $R \\to \\infty$. When we perform a linear regression of this error against $x = 1/R$, we are fitting the model $\\varepsilon_{\\mathrm{ALDA}}(x) = m_{\\mathrm{ALDA}} x + b_{\\mathrm{ALDA}}$. By direct comparison with the derived error equation, the exact theoretical fit parameters are:\n$$\nm_{\\mathrm{ALDA}} = 1, \\quad b_{\\mathrm{ALDA}} = -\\Delta_{\\mathrm{xc}}\n$$\nThe slope of $1$ confirms that the error is dominated by the missing $-1/R$ electron-hole interaction term.\n\nThe error for the RSH model, $\\varepsilon_{\\mathrm{RSH}}(R)$, is defined as:\n$$\n\\varepsilon_{\\mathrm{RSH}}(R) = E_{\\mathrm{CT}}^{\\mathrm{RSH}}(R) - E_{\\mathrm{CT}}^{\\mathrm{exact}}(R) = (E_{\\mathrm{gap}} - \\delta_{\\mathrm{RSH}} - \\frac{1}{R}) - (E_{\\mathrm{gap}} - \\frac{1}{R})\n$$\n$$\n\\varepsilon_{\\mathrm{RSH}}(R) = -\\delta_{\\mathrm{RSH}}\n$$\nThis error is a constant, independent of the separation $R$. This demonstrates that the RSH functional correctly captures the long-range $1/R$ physics. The remaining error is a constant bias, $\\delta_{\\mathrm{RSH}}$, which may arise from inaccuracies in the short-range part of the functional or the underlying ground-state calculation. Fitting this error against $x = 1/R$ with the model $\\varepsilon_{\\mathrm{RSH}}(x) = m_{\\mathrm{RSH}} x + b_{\\mathrm{RSH}}$ yields exact theoretical fit parameters:\n$$\nm_{\\mathrm{RSH}} = 0, \\quad b_{\\mathrm{RSH}} = -\\delta_{\\mathrm{RSH}}\n$$\nThe slope of $0$ confirms the correct asymptotic behavior.\n\n**Computational Algorithm**\n\nThe program will implement the following steps for each test case provided:\n1.  Define the input parameters for the case: $E_{\\mathrm{gap}}$, $\\Delta_{\\mathrm{xc}}$, $\\delta_{\\mathrm{RSH}}$, and the list of distances $R$.\n2.  Construct the independent variable vector $x$ where each element is $x_i = 1/R_i$.\n3.  Compute the error vector for ALDA using the derived formula: $(\\varepsilon_{\\mathrm{ALDA}})_i = x_i - \\Delta_{\\mathrm{xc}}$.\n4.  Compute the error vector for RSH using the derived formula: $(\\varepsilon_{\\mathrm{RSH}})_i = -\\delta_{\\mathrm{RSH}}$ for all $i$.\n5.  Perform a linear regression on the point sets $(x_i, (\\varepsilon_{\\mathrm{ALDA}})_i)$ to find the slope $m_{\\mathrm{ALDA}}$ and intercept $b_{\\mathrm{ALDA}}$. Since the relationship is perfectly linear, the numerical regression will yield results identical to the theoretical predictions, up to machine precision. A polynomial fit of degree $1$ is sufficient for this task.\n6.  Similarly, perform a linear regression on $(x_i, (\\varepsilon_{\\mathrm{RSH}})_i)$ to find $m_{\\mathrm{RSH}}$ and $b_{\\mathrm{RSH}}$.\n7.  Calculate the maximum absolute error for ALDA by finding the maximum value in the array of absolute errors: $\\varepsilon_{\\max}^{\\mathrm{ALDA}} = \\max_i |(\\varepsilon_{\\mathrm{ALDA}})_i|$.\n8.  Calculate the maximum absolute error for RSH: $\\varepsilon_{\\max}^{\\mathrm{RSH}} = \\max_i |(\\varepsilon_{\\mathrm{RSH}})_i| = |-\\delta_{\\mathrm{RSH}}| = \\delta_{\\mathrm{RSH}}$.\n9.  Collect the six calculated values in the specified order: $[m_{\\mathrm{ALDA}}, b_{\\mathrm{ALDA}}, m_{\\mathrm{RSH}}, b_{\\mathrm{RSH}}, \\varepsilon_{\\max}^{\\mathrm{ALDA}}, \\varepsilon_{\\max}^{\\mathrm{RSH}}]$.\n10. After processing all cases, the collected results are flattened into a single list and formatted into a comma-separated string, with each number rounded to six decimal places.\n\nThis procedure will be applied to all three test cases to generate the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the asymptotic behavior of charge-transfer excitation energies\n    in TDDFT for ALDA and RSH models.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (E_gap, Delta_xc, delta_RSH, R_values)\n    # All values are in atomic units.\n    test_cases = [\n        (0.30, 0.15, 0.02, [5.0, 8.0, 12.0, 20.0]),\n        (0.22, 0.00, 0.01, [10.0, 15.0, 25.0, 50.0]),\n        (0.45, 0.20, 0.05, [3.0, 4.0, 5.0, 10.0]),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E_gap, Delta_xc, delta_RSH, R_list = case\n        \n        # Convert R_list to a numpy array for vectorized operations.\n        R = np.array(R_list)\n        \n        # The independent variable for regression is x = 1/R.\n        x = 1.0 / R\n        \n        # --- ALDA Analysis ---\n        \n        # The error for ALDA is derived as:\n        # epsilon_ALDA = E_ALDA - E_exact\n        #              = (E_gap - Delta_xc) - (E_gap - 1/R)\n        #              = 1/R - Delta_xc\n        error_alda = x - Delta_xc\n        \n        # Perform linear regression: error_alda = m * x + b\n        # Using numpy.polyfit for a degree-1 polynomial (a line).\n        # It returns [slope, intercept].\n        # Because the data is perfectly linear, the fit will be exact.\n        m_alda, b_alda = np.polyfit(x, error_alda, 1)\n        \n        # Calculate the maximum absolute error for ALDA.\n        max_err_alda = np.max(np.abs(error_alda))\n        \n        # --- RSH Analysis ---\n        \n        # The error for RSH is derived as:\n        # epsilon_RSH = E_RSH - E_exact\n        #             = (E_gap - delta_RSH - 1/R) - (E_gap - 1/R)\n        #             = -delta_RSH\n        # This is a constant error.\n        error_rsh = np.full_like(x, -delta_RSH)\n        \n        # Perform linear regression: error_rsh = m * x + b\n        # For constant data, the slope will be 0 and the intercept will be the constant value.\n        m_rsh, b_rsh = np.polyfit(x, error_rsh, 1)\n\n        # Calculate the maximum absolute error for RSH.\n        # Since the error is constant, it's just the absolute value of that constant.\n        max_err_rsh = np.max(np.abs(error_rsh))\n\n        # Append the six required values for the current case.\n        all_results.extend([\n            m_alda, b_alda, m_rsh, b_rsh, max_err_alda, max_err_rsh\n        ])\n\n    # Format the final output string as required.\n    # A single line, comma-separated, enclosed in brackets, with 6 decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in all_results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "3497374"}, {"introduction": "While range-separated hybrids correct the long-range behavior of the potential, all adiabatic approximations fail to capture electronic states with significant double-excitation character. This advanced practice introduces the solution: the frequency-dependent exchange-correlation kernel, $f_{xc}(\\omega)$ [@problem_id:3497323]. You will construct and solve a minimal TDDFT model where a pole in the kernel mimics the presence of a double excitation, leading to a mixing of states and demonstrating the 'level repulsion' phenomenon that is key to accurately predicting these complex quantum states.", "problem": "You are tasked with constructing and analyzing a minimal linear-response Time-Dependent Density Functional Theory (TDDFT) model for stretched hydrogen molecule $\\text{H}_2$ that can capture a double excitation by introducing a frequency-dependent exchange-correlation kernel. In Time-Dependent Density Functional Theory (TDDFT), the interacting density response function $\\chi(\\omega)$ is related to the Kohn-Sham (KS) response function $\\chi_s(\\omega)$ by a Dyson-like equation,\n$$\n\\chi(\\omega) = \\chi_s(\\omega) + \\chi_s(\\omega)\\left[f_H + f_{xc}(\\omega)\\right]\\chi(\\omega),\n$$\nwhere $f_H$ is the Hartree kernel and $f_{xc}(\\omega)$ is the exchange-correlation kernel, possibly frequency-dependent. The standard Casida formulation builds an eigenvalue problem in the basis of KS transitions, and in the Tamm-Dancoff Approximation (TDA) one solves a Hermitian eigenvalue problem involving the matrix elements $A_{qp}(\\omega)$ defined by\n$$\nA_{qp}(\\omega) = \\delta_{qp}\\,\\omega_q + K_{qp}(\\omega),\n$$\nwhere $\\omega_q$ is the KS transition energy and $K_{qp}(\\omega)$ contains the effective Hartree-exchange-correlation coupling. In the minimal single-transition subspace with one KS transition, the Tamm-Dancoff Approximation reduces the eigenvalue problem to a scalar nonlinear equation in the excitation energy $\\omega$.\n\nYour objective is to engineer a minimal model of a frequency-dependent kernel that contains a single pole to emulate the coupling to a double excitation and then analyze how the pole position shifts the Casida eigenvalues in this reduced model. Concretely:\n\n- Restrict to a single KS transition with energy $\\omega_q$.\n- Model the effective coupling entering $A(\\omega)$ with a frequency-dependent exchange-correlation kernel having a simple pole,\n$$\nf_{xc}(\\omega) = g + \\frac{\\beta}{\\omega - \\omega_0},\n$$\nwhere $g$ is a constant shift embodying adiabatic Hartree-exchange-correlation contributions, $\\beta$ is a positive coupling strength (with units of energy squared), and $\\omega_0$ is the pole position that mimics the double excitation energy in the Kohn-Sham spectrum or an effective auxiliary state.\n- In the single-transition Tamm-Dancoff Approximation, set the effective coupling $K(\\omega)$ equal to $f_{xc}(\\omega)$ and derive the scalar equation for the excitation energy $\\omega$ implied by the eigenvalue condition for $A(\\omega)$.\n\nStarting from these foundations:\n1. Derive the scalar equation satisfied by the excitation energy $\\omega$ in terms of $\\omega_q$, $g$, $\\beta$, and $\\omega_0$, showing explicitly that the presence of the pole in $f_{xc}(\\omega)$ leads to two real solutions for $\\omega$ when $\\beta > 0$, which can be interpreted as mixed single-double excitation energies within this minimal model.\n2. Show that the two solutions can be written in closed form and analyze qualitatively how varying $\\omega_0$ shifts the two solutions. In particular, discuss the limits $\\omega_0 \\to \\infty$ and $\\omega_0 \\to \\omega_q + g$ and how these limits relate to weak and strong mixing with the double excitation.\n3. Implement a complete, runnable program that, for each test case below, computes the two real solutions for $\\omega$ (the two Casida eigenvalues in this minimal model), sorts them in ascending order, and reports them. Express each excitation energy in electronvolts (eV), rounded to exactly three decimal places.\n\nPhysical units: All energies must be reported in $\\mathrm{eV}$, rounded to three decimal places.\n\nAngle units: Not applicable.\n\nPercentages: Not applicable.\n\nTest Suite:\nUse the following parameter sets, each represented as $(\\omega_q, g, \\beta, \\omega_0)$ with the appropriate units,\n- Case $1$: $(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 1.0\\,\\mathrm{eV}^2, 16.0\\,\\mathrm{eV})$,\n- Case $2$ (near-resonant pole): $(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 1.0\\,\\mathrm{eV}^2, 8.5\\,\\mathrm{eV})$,\n- Case $3$ (far pole): $(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 1.0\\,\\mathrm{eV}^2, 40.0\\,\\mathrm{eV})$,\n- Case $4$ (strong coupling): $(8.0\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}, 4.0\\,\\mathrm{eV}^2, 12.0\\,\\mathrm{eV})$,\n- Case $5$ (different KS gap): $(6.0\\,\\mathrm{eV}, 0.3\\,\\mathrm{eV}, 0.5\\,\\mathrm{eV}^2, 12.0\\,\\mathrm{eV})$.\n\nAnswer Specification and Final Output Format:\n- For each test case, compute the two real excitation energies $\\omega$ in $\\mathrm{eV}$, sorted in ascending order, rounded to exactly three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list corresponding to one test case. For example, the output should look like\n$[\\,[\\omega_{1,1},\\omega_{1,2}],\\,[\\omega_{2,1},\\omega_{2,2}],\\,\\dots\\,]$\nwith each $\\omega$ rounded to exactly three decimal places and expressed in $\\mathrm{eV}$.", "solution": "The problem is valid as it is scientifically grounded in the principles of time-dependent density functional theory (TDDFT), well-posed with a clear and complete set of definitions, and objective in its formulation. It presents a standard pedagogical model used to understand the limitations of adiabatic TDDFT and how frequency-dependent kernels can address them.\n\nThe objective is to find the excitation energies $\\omega$ within a minimal single-transition Tamm-Dancoff Approximation (TDA) model, where the exchange-correlation kernel $f_{xc}(\\omega)$ contains a pole to mimic coupling to a double excitation.\n\nFirst, we derive the scalar equation for the excitation energy $\\omega$. The Casida TDA eigenvalue problem in a single-transition subspace reduces to the scalar equation:\n$$\nA(\\omega) = \\omega\n$$\nwhere $\\omega$ is the excitation energy (the eigenvalue). The matrix element $A(\\omega)$ is given as:\n$$\nA(\\omega) = \\omega_q + K(\\omega)\n$$\nHere, $\\omega_q$ is the unperturbed Kohn-Sham (KS) transition energy. The problem specifies that the effective coupling $K(\\omega)$ is modeled by a frequency-dependent exchange-correlation kernel $f_{xc}(\\omega)$ of the form:\n$$\nK(\\omega) = f_{xc}(\\omega) = g + \\frac{\\beta}{\\omega - \\omega_0}\n$$\nwhere $g$ is a constant adiabatic contribution, $\\beta$ is a positive coupling strength, and $\\omega_0$ is the energy of an auxiliary state, typically a double excitation.\n\nSubstituting the expressions for $A(\\omega)$ and $K(\\omega)$ into the eigenvalue equation yields the central scalar equation for $\\omega$:\n$$\n\\omega_q + g + \\frac{\\beta}{\\omega - \\omega_0} = \\omega\n$$\nThis is a non-linear equation for $\\omega$. To analyze its solutions, we rearrange it into a polynomial form. We assume $\\omega \\neq \\omega_0$, as the pole itself is not a physical solution.\n$$\n\\omega - (\\omega_q + g) = \\frac{\\beta}{\\omega - \\omega_0}\n$$\nMultiplying by $(\\omega - \\omega_0)$ gives:\n$$\n(\\omega - (\\omega_q + g))(\\omega - \\omega_0) = \\beta\n$$\nExpanding this expression leads to a quadratic equation in $\\omega$:\n$$\n\\omega^2 - \\omega_0\\omega - (\\omega_q + g)\\omega + (\\omega_q + g)\\omega_0 = \\beta\n$$\n$$\n\\omega^2 - (\\omega_q + g + \\omega_0)\\omega + ((\\omega_q + g)\\omega_0 - \\beta) = 0\n$$\nThis is a standard quadratic equation of the form $a\\omega^2 + b\\omega + c = 0$, with coefficients $a = 1$, $b = -(\\omega_q + g + \\omega_0)$, and $c = ((\\omega_q + g)\\omega_0 - \\beta)$. The solutions for $\\omega$ are given by the quadratic formula. To demonstrate that there are two real solutions, we examine the discriminant, $\\Delta = b^2 - 4ac$:\n$$\n\\Delta = (-(\\omega_q + g + \\omega_0))^2 - 4(1)((\\omega_q + g)\\omega_0 - \\beta)\n$$\n$$\n\\Delta = (\\omega_q + g)^2 + 2(\\omega_q + g)\\omega_0 + \\omega_0^2 - 4(\\omega_q + g)\\omega_0 + 4\\beta\n$$\n$$\n\\Delta = (\\omega_q + g)^2 - 2(\\omega_q + g)\\omega_0 + \\omega_0^2 + 4\\beta\n$$\n$$\n\\Delta = ((\\omega_q + g) - \\omega_0)^2 + 4\\beta\n$$\nSince $(\\omega_q + g - \\omega_0)^2$ is a square of a real number, it is non-negative. The problem states that the coupling strength $\\beta$ is positive ($\\beta > 0$). Therefore, the discriminant $\\Delta$ is strictly positive ($\\Delta > 0$), which guarantees that the quadratic equation has two distinct real solutions for $\\omega$.\n\nNext, we provide the closed-form solutions and analyze their behavior. Using the quadratic formula, the two solutions, $\\omega_{1,2}$, are:\n$$\n\\omega_{1,2} = \\frac{-b \\pm \\sqrt{\\Delta}}{2a} = \\frac{(\\omega_q + g + \\omega_0) \\pm \\sqrt{(\\omega_q + g - \\omega_0)^2 + 4\\beta}}{2}\n$$\nThis expression is structurally identical to the eigenvalues of a $2 \\times 2$ symmetric matrix representing a coupled two-level system. The unperturbed \"bare\" energies are the adiabatic single excitation energy $\\omega'_q = \\omega_q + g$ and the double excitation energy $\\omega_0$. The coupling strength between these two states is given by $\\sqrt{\\beta}$. The two solutions $\\omega_{1,2}$ are the energies of the \"dressed\" or mixed states.\n\nWe analyze the behavior of these solutions in two important limits:\n1.  **Weak Mixing ($\\omega_0 \\to \\infty$):** When the double excitation energy $\\omega_0$ is much larger than the single excitation energy $\\omega'_q$. The square root term can be approximated using a Taylor expansion. A simpler approach is to use perturbation theory on the initial equation $\\omega = \\omega'_q + \\beta/(\\omega - \\omega_0)$.\n    -   One solution, $\\omega_1$, will be close to the unperturbed single excitation, $\\omega'_q$. We approximate $\\omega \\approx \\omega'_q$ in the denominator:\n        $$\n        \\omega_1 \\approx \\omega'_q + \\frac{\\beta}{\\omega'_q - \\omega_0}\n        $$\n        Since $\\omega_0$ is large, this solution is slightly shifted from $\\omega'_q$.\n    -   The other solution, $\\omega_2$, will be close to the pole, $\\omega_0$. We let $\\omega_2 = \\omega_0 + \\delta$:\n        $$\n        \\omega_0 + \\delta = \\omega'_q + \\frac{\\beta}{\\delta} \\implies (\\omega_0 - \\omega'_q + \\delta)\\delta = \\beta\n        $$\n        For large $\\omega_0$, this gives $\\delta \\approx \\beta / (\\omega_0 - \\omega'_q)$. The solution is slightly shifted from $\\omega_0$.\n    In this limit, the states are weakly mixed, and the resulting energies are close to the original unperturbed energies.\n\n2.  **Strong Mixing / Resonance ($\\omega_0 \\to \\omega'_q = \\omega_q + g$):** When the double excitation energy is degenerate or near-degenerate with the single excitation energy. In the case of exact resonance, $\\omega_0 = \\omega'_q$, the discriminant simplifies to $\\Delta = (0)^2 + 4\\beta = 4\\beta$. The solutions become:\n    $$\n    \\omega_{1,2} = \\frac{(\\omega'_q + \\omega'_q) \\pm \\sqrt{4\\beta}}{2} = \\frac{2\\omega'_q \\pm 2\\sqrt{\\beta}}{2} = \\omega'_q \\pm \\sqrt{\\beta}\n    $$\n    At resonance, the degeneracy is lifted, and the two states are maximally mixed, resulting in two new states split symmetrically around the original energy by an amount $2\\sqrt{\\beta}$. This demonstrates the \"level repulsion\" characteristic of coupled quantum systems.\n\nFinally, we implement a program to compute the two excitation energies $\\omega_{1,2}$ for the given test cases using the derived closed-form solution. The program will calculate the two roots, sort them in ascending order, and format the output as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the excitation energies in a minimal TDDFT model\n    with a frequency-dependent kernel for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (omega_q, g, beta, omega_0) in eV, eV, eV^2, eV.\n    test_cases = [\n        (8.0, 0.5, 1.0, 16.0),\n        (8.0, 0.5, 1.0, 8.5),\n        (8.0, 0.5, 1.0, 40.0),\n        (8.0, 0.5, 4.0, 12.0),\n        (6.0, 0.3, 0.5, 12.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        omega_q, g, beta, omega_0 = case\n\n        # The two solutions for the excitation energy omega are the roots of the quadratic equation:\n        # omega^2 - (omega_q + g + omega_0) * omega + ((omega_q + g) * omega_0 - beta) = 0\n        # The closed-form solution is:\n        # omega_1,2 = ( (omega_q + g + omega_0) +/- sqrt((omega_q + g - omega_0)^2 + 4*beta) ) / 2\n        \n        # Adiabatic single-excitation energy\n        omega_prime_q = omega_q + g\n        \n        # Sum and difference of the unperturbed energies\n        sum_energies = omega_prime_q + omega_0\n        diff_energies = omega_prime_q - omega_0\n        \n        # Calculate the term under the square root (related to the discriminant)\n        sqrt_term = np.sqrt(diff_energies**2 + 4 * beta)\n        \n        # Calculate the two solutions for omega\n        omega_1 = (sum_energies + sqrt_term) / 2.0\n        omega_2 = (sum_energies - sqrt_term) / 2.0\n        \n        # Sort the solutions in ascending order\n        solutions = sorted([omega_1, omega_2])\n        \n        all_results.append(solutions)\n\n    # Format the final output string as per the problem specification.\n    # Example format: [[w1_1,w1_2],[w2_1,w2_2],...] with no spaces.\n    formatted_cases = []\n    for sol_pair in all_results:\n        # Round each solution to exactly three decimal places and format as a string\n        formatted_pair = [f\"{s:.3f}\" for s in sol_pair]\n        # Create the string for the pair, e.g., '[7.500,9.500]'\n        formatted_cases.append(f\"[{','.join(formatted_pair)}]\")\n    \n    # Join all case strings into the final output format\n    final_output = f\"[{','.join(formatted_cases)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "3497323"}]}