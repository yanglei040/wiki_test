{"hands_on_practices": [{"introduction": "The helical trajectory of a charged particle in a uniform magnetic field is the foundational concept of magnetic confinement. This first exercise challenges you to derive the key parameters of this motion—gyrophase and parallel displacement—directly from the relativistic Lorentz force law, without relying on pre-derived formulas. Mastering this fundamental derivation [@problem_id:3710024] is crucial, as it builds the intuition for how high-energy particles, like fusion-born alpha particles, behave and are confined within a fusion device.", "problem": "A fusion-born ion moves in a region of a magnetically confined plasma where the magnetic field can be approximated as spatially uniform over a single Larmor orbit. Let the magnetic field be constant in space and time, with magnitude $B$ and unit direction $\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|$. Consider a single charged particle with charge $q$ and rest mass $m$ produced at time $t=0$ with initial velocity $\\mathbf{v}_{0}$ and initial gyrophase $\\phi_{0}$, where the gyrophase is defined as the polar angle of the perpendicular-velocity vector in an orthonormal basis $\\{\\hat{\\mathbf{e}}_{1},\\hat{\\mathbf{e}}_{2},\\hat{\\mathbf{b}}\\}$ with $\\hat{\\mathbf{e}}_{1}\\times\\hat{\\mathbf{e}}_{2}=\\hat{\\mathbf{b}}$ and $\\mathbf{v}_{0\\perp} = (\\mathbf{v}_{0} - (\\mathbf{v}_{0}\\cdot\\hat{\\mathbf{b}})\\hat{\\mathbf{b}})$ decomposed as $\\mathbf{v}_{0\\perp} = v_{0\\perp}(\\cos\\phi_{0}\\,\\hat{\\mathbf{e}}_{1}+\\sin\\phi_{0}\\,\\hat{\\mathbf{e}}_{2})$. Assume there is no electric field and neglect collisions.\n\nStarting from the Lorentz force law and conservation of energy, and without invoking any pre-stated formulas for the gyration frequency or period, derive an explicit, closed-form expression for:\n- the gyrophase $\\phi$ after $N$ full cyclotron periods, and\n- the net spatial displacement along the magnetic-field direction $\\Delta\\ell$ after those $N$ periods,\n\nexpressed in terms of $q$, $m$, $B$, $N$, $\\phi_{0}$, the speed of light $c$, and the initial velocity decomposition with $v_{0\\parallel} \\equiv \\mathbf{v}_{0}\\cdot\\hat{\\mathbf{b}}$ and $v_{0} \\equiv |\\mathbf{v}_{0}|$. Define one cyclotron period as the positive time required for the perpendicular-velocity vector to complete one full rotation by angle $2\\pi$ in the plane normal to $\\hat{\\mathbf{b}}$. Your final expressions must be valid for relativistic speeds and must make clear any dependence on the sign of $q$. Provide the final answer as a pair in a single row, in the order $\\phi$ then $\\Delta\\ell$. No numerical evaluation is required, and no units should be included in the final boxed answer.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It provides a self-contained, consistent setup for a standard problem in relativistic electrodynamics.\n\nThe motion of the charged particle is governed by the relativistic Lorentz force law. Since the electric field is zero, the equation of motion is:\n$$\n\\frac{d\\mathbf{p}}{dt} = q(\\mathbf{v} \\times \\mathbf{B})\n$$\nwhere $\\mathbf{p} = \\gamma m \\mathbf{v}$ is the relativistic momentum, $\\mathbf{v}$ is the particle's velocity, $q$ is its charge, and $m$ is its rest mass. The Lorentz factor is $\\gamma = (1 - v^2/c^2)^{-1/2}$, where $v = |\\mathbf{v}|$ is the particle's speed and $c$ is the speed of light in vacuum.\n\nFirst, we establish the constants of motion. The power delivered to the particle by the magnetic field is zero, as the magnetic force is always perpendicular to the velocity:\n$$\nP = \\mathbf{F} \\cdot \\mathbf{v} = q(\\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{v} = 0\n$$\nSince the power is zero, the kinetic energy of the particle is conserved. In relativistic mechanics, this means the total energy $E = \\gamma m c^2$ is constant. As $m$ and $c$ are constants, the Lorentz factor $\\gamma$ must also be constant throughout the motion. A constant $\\gamma$ implies that the particle's speed $v$ is also constant. Therefore, at any time $t$, $v(t) = v_{0} \\equiv |\\mathbf{v}_{0}|$ and $\\gamma(t) = \\gamma_{0} = (1 - v_{0}^2/c^2)^{-1/2}$.\n\nWith $\\gamma$ being a constant, the equation of motion simplifies to:\n$$\n\\gamma m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B})\n$$\nWe decompose the motion into components parallel and perpendicular to the magnetic field $\\mathbf{B} = B\\hat{\\mathbf{b}}$. Let $\\mathbf{v} = v_{\\parallel}\\hat{\\mathbf{b}} + \\mathbf{v}_{\\perp}$, where $v_{\\parallel} = \\mathbf{v} \\cdot \\hat{\\mathbf{b}}$.\n\nThe equation for the parallel component of the velocity is obtained by taking the dot product of the equation of motion with $\\hat{\\mathbf{b}}$:\n$$\n\\gamma m \\frac{d\\mathbf{v}}{dt} \\cdot \\hat{\\mathbf{b}} = q(\\mathbf{v} \\times \\mathbf{B}) \\cdot \\hat{\\mathbf{b}}\n$$\n$$\n\\gamma m \\frac{dv_{\\parallel}}{dt} = q B (\\mathbf{v} \\times \\hat{\\mathbf{b}}) \\cdot \\hat{\\mathbf{b}} = 0\n$$\nThis shows that $v_{\\parallel}$ is constant, so $v_{\\parallel}(t) = v_{0\\parallel}$ for all time $t$.\n\nThe equation for the perpendicular component of the velocity is:\n$$\n\\gamma m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})\n$$\nLet's analyze this equation in the orthonormal basis $\\{\\hat{\\mathbf{e}}_{1},\\hat{\\mathbf{e}}_{2},\\hat{\\mathbf{b}}\\}$. Let $\\mathbf{v}_{\\perp}(t) = v_{x}(t)\\hat{\\mathbf{e}}_{1} + v_{y}(t)\\hat{\\mathbf{e}}_{2}$. The cross product becomes:\n$$\n\\mathbf{v}_{\\perp} \\times \\mathbf{B} = (v_{x}\\hat{\\mathbf{e}}_{1} + v_{y}\\hat{\\mathbf{e}}_{2}) \\times (B\\hat{\\mathbf{b}}) = B(v_{x}(\\hat{\\mathbf{e}}_{1}\\times\\hat{\\mathbf{b}}) + v_{y}(\\hat{\\mathbf{e}}_{2}\\times\\hat{\\mathbf{b}}))\n$$\nUsing the cyclic property of the right-handed basis, $\\hat{\\mathbf{e}}_{1}\\times\\hat{\\mathbf{b}} = -\\hat{\\mathbf{e}}_{2}$ and $\\hat{\\mathbf{e}}_{2}\\times\\hat{\\mathbf{b}} = \\hat{\\mathbf{e}}_{1}$. Thus:\n$$\n\\mathbf{v}_{\\perp} \\times \\mathbf{B} = B(-v_{x}\\hat{\\mathbf{e}}_{2} + v_{y}\\hat{\\mathbf{e}}_{1})\n$$\nThe vector equation for $\\mathbf{v}_{\\perp}$ separates into two coupled scalar differential equations:\n$$\n\\gamma m \\frac{dv_x}{dt} = qBv_y\n$$\n$$\n\\gamma m \\frac{dv_y}{dt} = -qBv_x\n$$\nLet us define the signed cyclotron frequency $\\omega_c = \\frac{qB}{\\gamma m}$. The equations are:\n$$\n\\frac{dv_x}{dt} = \\omega_c v_y \\quad \\text{and} \\quad \\frac{dv_y}{dt} = -\\omega_c v_x\n$$\nDifferentiating the first equation with respect to time and substituting the second gives:\n$$\n\\frac{d^2v_x}{dt^2} = \\omega_c \\frac{dv_y}{dt} = \\omega_c(-\\omega_c v_x) = -\\omega_c^2 v_x\n$$\nThis is the equation for simple harmonic motion. The general solution is $v_x(t) = A\\cos(\\omega_c t) + C\\sin(\\omega_c t)$. Then $v_y(t) = \\frac{1}{\\omega_c}\\frac{dv_x}{dt} = -A\\sin(\\omega_c t) + C\\cos(\\omega_c t)$.\n\nWe apply the initial conditions at $t=0$. The problem states $\\mathbf{v}_{0\\perp} = v_{0\\perp}(\\cos\\phi_{0}\\,\\hat{\\mathbf{e}}_{1}+\\sin\\phi_{0}\\,\\hat{\\mathbf{e}}_{2})$, so $v_x(0) = v_{0\\perp}\\cos\\phi_{0}$ and $v_y(0) = v_{0\\perp}\\sin\\phi_{0}$.\nAt $t=0$, $v_x(0) = A = v_{0\\perp}\\cos\\phi_{0}$ and $v_y(0) = C = v_{0\\perp}\\sin\\phi_{0}$.\nSubstituting these into the general solutions:\n$$\nv_x(t) = v_{0\\perp}(\\cos\\phi_{0}\\cos(\\omega_c t) + \\sin\\phi_{0}\\sin(\\omega_c t)) = v_{0\\perp}\\cos(\\phi_{0} - \\omega_c t)\n$$\n$$\nv_y(t) = v_{0\\perp}(-\\cos\\phi_{0}\\sin(\\omega_c t) + \\sin\\phi_{0}\\cos(\\omega_c t)) = v_{0\\perp}\\sin(\\phi_{0} - \\omega_c t)\n$$\nThe perpendicular velocity vector is $\\mathbf{v}_{\\perp}(t) = v_{0\\perp}(\\cos(\\phi_{0} - \\omega_c t)\\hat{\\mathbf{e}}_{1} + \\sin(\\phi_{0} - \\omega_c t)\\hat{\\mathbf{e}}_{2})$.\nBy the problem's definition, the gyrophase $\\phi(t)$ is the polar angle of $\\mathbf{v}_{\\perp}(t)$. By inspection, we find:\n$$\n\\phi(t) = \\phi_{0} - \\omega_c t = \\phi_{0} - \\frac{qB}{\\gamma m}t\n$$\nThe problem defines one cyclotron period, $T$, as the time for the perpendicular-velocity vector to rotate by an angle of $2\\pi$. The rate of rotation is $|\\frac{d\\phi}{dt}| = |-\\omega_c| = |\\frac{qB}{\\gamma m}| = \\frac{|q|B}{\\gamma m}$.\nThe period is therefore $T = \\frac{2\\pi}{|d\\phi/dt|} = \\frac{2\\pi \\gamma m}{|q|B}$.\nThe total time for $N$ full cyclotron periods is $t_{N} = NT = N \\frac{2\\pi \\gamma m}{|q|B}$.\n\nThe gyrophase $\\phi$ after $N$ periods is found by evaluating $\\phi(t)$ at $t=t_N$:\n$$\n\\phi(t_N) = \\phi_{0} - \\frac{qB}{\\gamma m} t_N = \\phi_{0} - \\frac{qB}{\\gamma m} \\left(N \\frac{2\\pi \\gamma m}{|q|B}\\right) = \\phi_{0} - N \\frac{q}{|q|} 2\\pi\n$$\nUsing the signum function, $\\text{sgn}(q) = q/|q|$, the gyrophase is:\n$$\n\\phi = \\phi_{0} - \\text{sgn}(q) 2\\pi N\n$$\nThe net spatial displacement along the magnetic-field direction, $\\Delta\\ell$, after $N$ periods is found by integrating the constant parallel velocity $v_{0\\parallel}$ over the time $t_N$:\n$$\n\\Delta\\ell = v_{0\\parallel} t_N = v_{0\\parallel} \\left(N \\frac{2\\pi \\gamma m}{|q|B}\\right)\n$$\nWe must express this in terms of the specified initial parameters. We substitute the constant Lorentz factor $\\gamma = (1 - v_0^2/c^2)^{-1/2}$:\n$$\n\\Delta\\ell = \\frac{2\\pi N m v_{0\\parallel}}{|q|B} (1 - v_{0}^2/c^2)^{-1/2} = \\frac{2\\pi N m v_{0\\parallel}}{|q|B\\sqrt{1-\\frac{v_{0}^2}{c^2}}}\n$$\nThe two derived quantities are the gyrophase $\\phi$ and the parallel displacement $\\Delta\\ell$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\phi_{0} - \\operatorname{sgn}(q) 2\\pi N  \\frac{2\\pi N m v_{0\\parallel}}{|q|B\\sqrt{1-\\frac{v_{0}^{2}}{c^{2}}}} \\end{pmatrix}}\n$$", "id": "3710024"}, {"introduction": "Building on the principles of gyromotion, we now explore how particles gain or lose energy in the presence of both electric and magnetic fields. This practice requires you to calculate the average power transferred to a particle over one gyroperiod, considering an arbitrary orientation between the $\\mathbf{E}$ and $\\mathbf{B}$ fields. By solving this problem [@problem_id:3710047], you will uncover the fundamental mechanisms behind plasma heating, distinguishing between the effects of parallel and perpendicular electric fields.", "problem": "A single charged fusion ion with mass $m$ and charge $q$ moves in uniform, time-independent electric and magnetic fields $\\mathbf{E}$ and $\\mathbf{B}$, respectively. The magnetic field has magnitude $B$ and defines a unit vector $\\mathbf{b} = \\mathbf{B}/B$. The electric field has magnitude $E$ and is oriented at an arbitrary angle $\\theta$ relative to $\\mathbf{B}$, so that its parallel component is $E_{\\parallel} = E \\cos\\theta$ and its perpendicular component is $E_{\\perp} = E \\sin\\theta$. At time $t=0$, the particle’s parallel velocity is $v_{\\parallel 0}$, and the perpendicular velocity is an arbitrary gyration around $\\mathbf{b}$.\n\nStarting from the Lorentz force law $m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)$ and the kinematic definition $d\\mathbf{r}/dt = \\mathbf{v}$, derive the gyro-period average of the instantaneous power input $q\\,\\mathbf{E}\\cdot\\mathbf{v}$ over one cyclotron period $\\displaystyle T_c = \\frac{2\\pi m}{|q| B}$, for arbitrary $\\theta$. Express your final answer as a single closed-form analytic expression in terms of $q$, $m$, $B$, $E$, $\\theta$, and $v_{\\parallel 0}$, and then briefly interpret the physical meaning of each term in the result in the context of nuclear fusion plasmas. No numerical evaluation is required. The final answer must be a single analytic expression; do not include units in the final answer box.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It represents a fundamental calculation in plasma physics concerning the motion of charged particles in uniform electromagnetic fields, based on the Lorentz force law. No flaws are identified. We may therefore proceed with the derivation.\n\nThe objective is to calculate the gyro-period average of the instantaneous power input, $\\langle P \\rangle$, to a charged particle. The instantaneous power $P(t)$ delivered by the electric field $\\mathbf{E}$ to a particle of charge $q$ moving with velocity $\\mathbf{v}$ is given by\n$$P(t) = q \\mathbf{E} \\cdot \\mathbf{v}(t)$$\nThe gyro-period average is defined as\n$$\\langle P \\rangle = \\frac{1}{T_c} \\int_0^{T_c} P(t) \\,dt = \\frac{q}{T_c} \\int_0^{T_c} \\mathbf{E} \\cdot \\mathbf{v}(t) \\,dt$$\nwhere $T_c = \\frac{2\\pi m}{|q| B}$ is the cyclotron period.\n\nTo solve this, we decompose the vector quantities into components parallel ($\\parallel$) and perpendicular ($\\perp$) to the magnetic field $\\mathbf{B} = B\\mathbf{b}$.\nThe electric field is $\\mathbf{E} = \\mathbf{E}_{\\parallel} + \\mathbf{E}_{\\perp}$, where $\\mathbf{E}_{\\parallel} = (E \\cos\\theta) \\mathbf{b}$ and $|\\mathbf{E}_{\\perp}| = E \\sin\\theta$.\nThe particle's velocity is $\\mathbf{v}(t) = \\mathbf{v}_{\\parallel}(t) + \\mathbf{v}_{\\perp}(t)$, where $\\mathbf{v}_{\\parallel}(t) = v_{\\parallel}(t) \\mathbf{b}$.\n\nThe power expression can be expanded using these components:\n$$P(t) = q (\\mathbf{E}_{\\parallel} + \\mathbf{E}_{\\perp}) \\cdot (\\mathbf{v}_{\\parallel}(t) + \\mathbf{v}_{\\perp}(t))$$\nDue to the mutual orthogonality of parallel and perpendicular vectors (i.e., $\\mathbf{E}_{\\parallel} \\cdot \\mathbf{v}_{\\perp} = 0$ and $\\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\parallel} = 0$), this simplifies to:\n$$P(t) = q (\\mathbf{E}_{\\parallel} \\cdot \\mathbf{v}_{\\parallel}(t) + \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t)) = q(E_{\\parallel} v_{\\parallel}(t) + \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t))$$\nThe average power is the sum of the averages of these two terms:\n$$\\langle P \\rangle = \\frac{q}{T_c} \\int_0^{T_c} E_{\\parallel} v_{\\parallel}(t) \\,dt + \\frac{q}{T_c} \\int_0^{T_c} \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t) \\,dt$$\n\nLet's analyze each term separately by first considering the equations of motion derived from the Lorentz force law, $m\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$.\n\nThe parallel component of the equation of motion is:\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} \\cdot \\mathbf{b} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{b}$$\n$$m \\frac{dv_{\\parallel}}{dt} = q(\\mathbf{E}_{\\parallel} \\cdot \\mathbf{b}) + q(\\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{b}$$\nSince $\\mathbf{v} \\times \\mathbf{B}$ is perpendicular to $\\mathbf{B}$ (and thus to $\\mathbf{b}$), the second term vanishes. This leaves:\n$$m \\frac{dv_{\\parallel}}{dt} = q E_{\\parallel}$$\nThis describes constant acceleration in the direction parallel to $\\mathbf{B}$. Integrating with the initial condition $v_{\\parallel}(0) = v_{\\parallel 0}$ yields:\n$$v_{\\parallel}(t) = v_{\\parallel 0} + \\frac{q E_{\\parallel}}{m} t$$\nThe average power from the parallel component is:\n$$\\langle P_{\\parallel} \\rangle = \\frac{q E_{\\parallel}}{T_c} \\int_0^{T_c} \\left(v_{\\parallel 0} + \\frac{q E_{\\parallel}}{m} t\\right) \\,dt = \\frac{q E_{\\parallel}}{T_c} \\left[ v_{\\parallel 0} t + \\frac{q E_{\\parallel}}{2m} t^2 \\right]_0^{T_c}$$\n$$\\langle P_{\\parallel} \\rangle = \\frac{q E_{\\parallel}}{T_c} \\left( v_{\\parallel 0} T_c + \\frac{q E_{\\parallel}}{2m} T_c^2 \\right) = q E_{\\parallel} v_{\\parallel 0} + \\frac{q^2 E_{\\parallel}^2 T_c}{2m}$$\n\nThe perpendicular component of the equation of motion is:\n$$m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nThe power associated with this motion is $P_{\\perp}(t) = q\\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t)$. Let's consider the rate of change of the perpendicular kinetic energy, $K_{\\perp} = \\frac{1}{2} m v_{\\perp}^2 = \\frac{1}{2} m (\\mathbf{v}_{\\perp} \\cdot \\mathbf{v}_{\\perp})$.\n$$\\frac{dK_{\\perp}}{dt} = m \\mathbf{v}_{\\perp} \\cdot \\frac{d\\mathbf{v}_{\\perp}}{dt} = \\mathbf{v}_{\\perp} \\cdot \\left( q\\mathbfE_{\\perp} + q(\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\right)$$\n$$\\frac{dK_{\\perp}}{dt} = q \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp} + q \\mathbf{v}_{\\perp} \\cdot (\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nThe scalar triple product $\\mathbf{v}_{\\perp} \\cdot (\\mathbf{v}_{\\perp} \\times \\mathbf{B})$ is zero because the vector $(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$ is orthogonal to $\\mathbf{v}_{\\perp}$. Thus:\n$$\\frac{dK_{\\perp}}{dt} = q \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t) = P_{\\perp}(t)$$\nThe average perpendicular power $\\langle P_{\\perp} \\rangle$ is therefore:\n$$\\langle P_{\\perp} \\rangle = \\frac{1}{T_c} \\int_0^{T_c} P_{\\perp}(t) \\,dt = \\frac{1}{T_c} \\int_0^{T_c} \\frac{dK_{\\perp}}{dt} \\,dt = \\frac{K_{\\perp}(T_c) - K_{\\perp}(0)}{T_c}$$\nThe perpendicular velocity $\\mathbf{v}_{\\perp}(t)$ is the sum of the constant $\\mathbf{E} \\times \\mathbf{B}$ drift velocity, $\\mathbf{v}_D = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2}$, and a gyrating velocity $\\mathbf{u}_{\\perp}(t)$ which rotates with the cyclotron frequency $\\omega_c = |q|B/m$. After one full cyclotron period $T_c$, the gyrating component returns to its initial state, $\\mathbf{u}_{\\perp}(T_c) = \\mathbf{u}_{\\perp}(0)$. Consequently, the total perpendicular velocity is also periodic with period $T_c$, so $\\mathbf{v}_{\\perp}(T_c) = \\mathbf{v}_{\\perp}(0)$. This implies that the perpendicular kinetic energy is also periodic, $K_{\\perp}(T_c) = K_{\\perp}(0)$.\nTherefore, the change in perpendicular kinetic energy over one gyro-period is zero, and the average power from the perpendicular electric field is zero:\n$$\\langle P_{\\perp} \\rangle = 0$$\n\nThe total average power is simply the average power from the parallel motion:\n$$\\langle P \\rangle = \\langle P_{\\parallel} \\rangle = q E_{\\parallel} v_{\\parallel 0} + \\frac{q^2 E_{\\parallel}^2 T_c}{2m}$$\nTo express this in the requested variables, we substitute $E_{\\parallel} = E \\cos\\theta$ and $T_c = \\frac{2\\pi m}{|q| B}$:\n$$\\langle P \\rangle = q (E \\cos\\theta) v_{\\parallel 0} + \\frac{q^2 (E \\cos\\theta)^2}{2m} \\left( \\frac{2\\pi m}{|q| B} \\right)$$\nSince $q^2 = |q|^2$, the term $\\frac{q^2}{|q|}$ simplifies to $|q|$. The mass $m$ cancels from the second term.\n$$\\langle P \\rangle = q v_{\\parallel 0} E \\cos\\theta + \\frac{|q|^2 (E \\cos\\theta)^2}{B} \\frac{\\pi}{|q|} = q v_{\\parallel 0} E \\cos\\theta + \\frac{\\pi |q| E^2 \\cos^2\\theta}{B}$$\n\nThis final expression has two distinct terms. We are asked to interpret their physical meaning in the context of nuclear fusion plasmas.\n1.  The first term, $q v_{\\parallel 0} E \\cos\\theta = q v_{\\parallel 0} E_{\\parallel}$, represents the power delivered by the parallel electric field to the particle's guiding center, which is the initial component of its motion along the magnetic field. This is the standard power input for a charge moving through a potential difference. In fusion contexts, this corresponds to Ohmic heating, where an electric field parallel to the magnetic field drives a current and heats the plasma.\n2.  The second term, $\\frac{\\pi |q| E^2 \\cos^2\\theta}{B}$, results from the particle's continuous acceleration by the parallel electric field over the course of one gyro-period. This term is always non-negative, representing a net heating effect regardless of the signs of $q$, $E_{\\parallel}$, or $v_{\\parallel 0}$. It is quadratic in the parallel electric field strength. This form of heating is a type of transit-time heating, where a particle gains energy by interacting with a field during its transit. The dependence on $1/B$ indicates that for a weaker magnetic field, the gyro-period is longer, allowing the parallel electric field more time to accelerate the particle and thus deliver more energy per gyration cycle.", "answer": "$$\n\\boxed{q v_{\\parallel 0} E \\cos\\theta + \\frac{\\pi |q| E^2 \\cos^2\\theta}{B}}\n$$", "id": "3710047"}, {"introduction": "Analytical solutions provide deep insight, but much of modern plasma physics relies on computational modeling. This final practice bridges theory and computation by tasking you with simulating the motion of a particle in crossed electric and magnetic fields to numerically verify the famous $\\mathbf{E}\\times\\mathbf{B}$ drift. By implementing and comparing simple numerical integrators [@problem_id:2390224], you will gain practical skills in solving equations of motion and develop an appreciation for the methods used to analyze and validate complex simulation data in fusion research.", "problem": "A non-relativistic point particle of charge $q$ and mass $m$ moves in uniform, mutually perpendicular electric and magnetic fields. Let the particle’s position be $\\mathbf{r}(t)$ in meters and its velocity be $\\mathbf{v}(t)$ in meters per second. The fundamental base is Newton’s second law and the Lorentz force law: the total force is $\\mathbf{F} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$, so the equations of motion are the coupled ordinary differential equations (ODEs): $\\dfrac{d\\mathbf{r}}{dt} = \\mathbf{v}$ and $m\\dfrac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$. Assume all fields are spatially and temporally constant and given in the International System of Units (SI).\n\nYour task is to implement and use Euler methods for solving ODEs to numerically demonstrate the existence of the $\\mathbf{E}\\times\\mathbf{B}$ drift. Specifically:\n\n1. Starting only from Newton’s second law and the Lorentz force (the fundamental base given above), derive the form of the time-continuous drift velocity that arises when a constant perpendicular electric field $\\mathbf{E}$ and magnetic field $\\mathbf{B}$ act on the particle. Explain why this drift is independent of $q$ and $m$.\n2. Derive the forward Euler method and a semi-implicit Euler variant (update velocity first, then update position using the updated velocity) for the above ODE system. You must explicitly state the update rules you will implement.\n3. For robust numerical extraction of the drift in finite time without waiting for many gyrations, use the guiding-center position to filter out the cyclotron motion and isolate the drift. Define the guiding-center coordinate\n   $$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B},$$\n   and estimate the drift velocity as the finite-time difference quotient\n   $$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}.$$\n   Explain how this follows from the continuous-time dynamics and why it removes the fast gyromotion.\n4. Implement both methods and compute, for each test case below, the Euclidean norm of the difference (in meters per second) between your numerically estimated drift velocity $\\widehat{\\mathbf{v}}_{\\text{drift}}$ and the drift velocity you derive analytically from the continuous equations in part 1. For each test case, report two floats: the error using forward Euler followed by the error using the semi-implicit Euler variant.\n\nPhysical and numerical units: All vector components for $\\mathbf{E}$ are in volts per meter, $\\mathbf{B}$ in tesla, time in seconds, $\\mathbf{r}$ in meters, $\\mathbf{v}$ in meters per second, charge $q$ in coulombs, and mass $m$ in kilograms. Express all requested error magnitudes in meters per second as floating-point numbers.\n\nTest suite and initial conditions:\n- Use initial position $\\mathbf{r}(0) = (0,0,0)$ in meters for all cases.\n- Use the following four parameter sets, covering a general case, a boundary case, an edge case with very small magnetic field, and a sign reversal of charge:\n  1. Case A (happy path): $q = 1.0\\times 10^{-15}$, $m = 1.0\\times 10^{-12}$, $\\mathbf{E} = (2.0,0.0,0.0)$, $\\mathbf{B} = (0.0,0.0,0.5)$, $T = 10.0$, $\\Delta t = 0.05$, and $\\mathbf{v}(0) = (0.0,0.0,0.0)$.\n  2. Case B (boundary, no electric field): $q = 1.0\\times 10^{-15}$, $m = 1.0\\times 10^{-12}$, $\\mathbf{E} = (0.0,0.0,0.0)$, $\\mathbf{B} = (0.0,0.0,0.5)$, $T = 1.0$, $\\Delta t = 0.1$, and $\\mathbf{v}(0) = (0.0,0.0,0.0)$.\n  3. Case C (edge, very small magnetic field): $q = 1.0\\times 10^{-15}$, $m = 1.0\\times 10^{-12}$, $\\mathbf{E} = (0.01,0.0,0.0)$, $\\mathbf{B} = (0.0,0.0,1.0\\times 10^{-4})$, $T = 50.0$, $\\Delta t = 0.5$, and $\\mathbf{v}(0) = (0.0,0.0,0.0)$.\n  4. Case D (sign reversal of charge): $q = -1.0\\times 10^{-15}$, $m = 1.0\\times 10^{-12}$, $\\mathbf{E} = (2.0,0.0,0.0)$, $\\mathbf{B} = (0.0,0.0,0.5)$, $T = 10.0$, $\\Delta t = 0.05$, and $\\mathbf{v}(0) = (0.0,0.0,0.0)$.\n\nFinal output format:\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The list must contain, in order, for each case, two floating-point numbers: first the forward Euler error (in meters per second), then the semi-implicit Euler error (in meters per second). For the four cases, the output must thus be $8$ numbers in total, in the order $\\left[\\text{A-FE},\\text{A-SE},\\text{B-FE},\\text{B-SE},\\text{C-FE},\\text{C-SE},\\text{D-FE},\\text{D-SE}\\right]$.", "solution": "The problem presented is valid. It is grounded in the fundamental principles of classical electrodynamics, namely the Lorentz force law and Newton's second law, and it poses a well-defined initial value problem in computational physics. All necessary parameters and conditions are provided, and there are no scientific or logical contradictions. We shall proceed with a rigorous solution.\n\nThe motion of a charged particle in crossed electric and magnetic fields is a canonical problem. The trajectory is a superposition of a uniform motion parallel to the magnetic field, a circular gyration in the plane perpendicular to the magnetic field, and a steady drift of the center of this gyration, also perpendicular to the magnetic field. Our objective is to first derive this drift velocity analytically and then to demonstrate its existence numerically using two variants of the Euler method.\n\n**1. Analytical Derivation of the Drift Velocity**\n\nThe equation of motion for a particle of charge $q$ and mass $m$ is given by a combination of Newton's second law and the Lorentz force:\n$$m\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$$\nWe seek a solution for the velocity $\\mathbf{v}$. Let us decompose the velocity into components parallel and perpendicular to the magnetic field $\\mathbf{B}$: $\\mathbf{v} = \\mathbf{v}_{\\|} + \\mathbf{v}_{\\perp}$. The electric field is also decomposed as $\\mathbf{E} = \\mathbf{E}_{\\|} + \\mathbf{E}_{\\perp}$. The equation of motion separates into two parts:\n$$m\\frac{d\\mathbf{v}_{\\|}}{dt} = q\\mathbf{E}_{\\|}$$\n$$m\\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nThe problem states that the fields are mutually perpendicular, so $\\mathbf{E} \\cdot \\mathbf{B} = 0$, which implies $\\mathbf{E}_{\\|} = 0$. Consequently, $\\frac{d\\mathbf{v}_{\\|}}{dt} = 0$, and the velocity component parallel to $\\mathbf{B}$ is constant.\n\nThe perpendicular motion is more complex. We hypothesize that the perpendicular velocity $\\mathbf{v}_{\\perp}$ can be expressed as a sum of a constant drift velocity $\\mathbf{v}_D$ and a time-varying gyration velocity $\\mathbf{u}(t)$: $\\mathbf{v}_{\\perp} = \\mathbf{v}_D + \\mathbf{u}(t)$. The drift velocity represents a steady-state solution where the net force in the perpendicular plane is, on average, zero. A specific constant velocity $\\mathbf{v}_D$ can exist for which the electric and magnetic forces perfectly balance. We find this velocity by setting the perpendicular acceleration to zero and replacing $\\mathbf{v}_{\\perp}$ with $\\mathbf{v}_D$:\n$$0 = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_D \\times \\mathbf{B})$$\n$$\\mathbf{E}_{\\perp} = -(\\mathbf{v}_D \\times \\mathbf{B})$$\nTo solve for $\\mathbf{v}_D$, we take the cross product of this equation with $\\mathbf{B}$:\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -(\\mathbf{v}_D \\times \\mathbf{B}) \\times \\mathbf{B}$$\nUsing the vector triple product identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$, we get:\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[\\mathbf{B}(\\mathbf{v}_D \\cdot \\mathbf{B}) - \\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})]$$\nThe drift velocity $\\mathbf{v}_D$ is a response to perpendicular forces, so it must be perpendicular to $\\mathbf{B}$, meaning $\\mathbf{v}_D \\cdot \\mathbf{B} = 0$. The equation simplifies to:\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[-\\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})] = \\mathbf{v}_D \\|\\mathbf{B}\\|^2$$\nSince $\\mathbf{E}_{\\perp} = \\mathbf{E}$, we arrive at the expression for the $\\mathbf{E} \\times \\mathbf{B}$ drift velocity:\n$$\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$$\nThis derivation reveals that the drift velocity $\\mathbf{v}_D$ depends only on the electric and magnetic fields, $\\mathbf{E}$ and $\\mathbf{B}$. It is fundamentally independent of the particle's charge $q$ and mass $m$. The magnitude of the charge and mass only affect the characteristics of the superimposed gyromotion (its frequency and radius), not the velocity of the guiding center's drift. The sign of the charge $q$ reverses the direction of gyration, but the drift direction remains unchanged.\n\n**2. Derivation of Numerical Integration Schemes**\n\nThe system of equations to be solved is a set of two coupled first-order ordinary differential equations (ODEs):\n$$ \\frac{d\\mathbf{r}}{dt} = \\mathbf{v} $$\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m}(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) = \\mathbf{a}(\\mathbf{v}) $$\nWe discretize time with a constant step size $\\Delta t$, such that $t_n = n\\Delta t$. The state of the system at time $t_n$ is $(\\mathbf{r}_n, \\mathbf{v}_n)$.\n\nThe **Forward Euler (FE)** method is an explicit first-order method. It approximates the state at step $n+1$ using the derivative evaluated at step $n$:\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_n $$\nThis method is simple but is known for its poor stability properties, especially for oscillatory systems where it artificially increases the system's energy.\n\nThe **Semi-Implicit Euler (SE)** method, also known as the Euler-Cromer method, is a variant that improves stability. As specified, we first update the velocity and then use this newly computed velocity to update the position. This introduces an element of implicitness which significantly improves energy conservation for Hamiltonian systems. The update rules are:\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_{n+1} $$\nThis symplectic integrator is expected to yield a more accurate long-term trajectory for the gyrating particle compared to the forward Euler method.\n\n**3. Guiding-Center Position for Drift Estimation**\n\nThe full particle trajectory $\\mathbf{r}(t)$ is a complex cycloidal path resulting from the superposition of the fast gyromotion upon the slower guiding-center drift. To numerically extract the drift velocity, we must filter out the oscillatory gyromotion. The guiding-center position $\\mathbf{R}(t)$ represents the center of the particle's circular gyration. It is defined in the problem as:\n$$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B}$$\nThe second term, $\\boldsymbol{\\rho}_{est}(t) = \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B}$, is an approximation of the gyroradius vector, which is the vector from the guiding center to the particle's position. By subtracting this term from the particle's instantaneous position $\\mathbf{r}(t)$, we obtain an estimate of the guiding center's position. This subtraction effectively removes the largest component of the oscillatory motion from the position data.\n\nThe instantaneous velocity of this estimated guiding center, $\\frac{d\\mathbf{R}}{dt}$, is not perfectly constant. It contains the true guiding-center velocity ($\\mathbf{v}_D$ in our case, since $\\mathbf{v}_{\\|}(0)=0$) plus a residual oscillatory term at the cyclotron frequency. To eliminate this residual oscillation, we average the guiding-center velocity over the total simulation time $T$. This is accomplished by computing the finite-difference quotient:\n$$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}$$\nThis calculation is equivalent to $\\frac{1}{T}\\int_0^T \\frac{d\\mathbf{R}}{dt'} dt'$. Over a time $T$ that is long compared to the gyroperiod, the integral of the oscillatory part becomes negligible compared to the integral of the constant drift, yielding a numerically robust estimate of the average drift velocity. For the given initial conditions $\\mathbf{r}(0) = \\mathbf{0}$ and $\\mathbf{v}(0) = \\mathbf{0}$, the initial guiding-center position is $\\mathbf{R}(0) = \\mathbf{0}$, simplifying the estimate to $\\widehat{\\mathbf{v}}_{\\text{drift}} = \\mathbf{R}(T)/T$.\n\n**4. Computational Procedure**\n\nFor each test case, we perform the following steps:\n1.  Calculate the analytical drift velocity $\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$.\n2.  Run a simulation from $t=0$ to $t=T$ using the Forward Euler method to find the final state $(\\mathbf{r}_{FE}(T), \\mathbf{v}_{FE}(T))$.\n3.  Calculate the final guiding-center position $\\mathbf{R}_{FE}(T)$ and the numerical drift $\\widehat{\\mathbf{v}}_{\\text{drift, FE}} = (\\mathbf{R}_{FE}(T) - \\mathbf{R}(0))/T$.\n4.  Compute the error for the Forward Euler method as the Euclidean norm $E_{FE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, FE}} - \\mathbf{v}_D\\|$.\n5.  Repeat steps 2-4 using the Semi-Implicit Euler method to find $(\\mathbf{r}_{SE}(T), \\mathbf{v}_{SE}(T))$, $\\widehat{\\mathbf{v}}_{\\text{drift, SE}}$, and the corresponding error $E_{SE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, SE}} - \\mathbf{v}_D\\|$.\n6.  The pair of computed errors $(E_{FE}, E_{SE})$ constitutes the result for the test case. This procedure is repeated for all specified cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the error in numerically estimated E x B drift velocity\n    using Forward Euler and Semi-Implicit Euler methods.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case B (boundary, no electric field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 1.0, \"dt\": 0.1,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case C (edge, very small magnetic field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.01, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 1.0e-4]), \"T\": 50.0, \"dt\": 0.5,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case D (sign reversal of charge)\n        {\n            \"q\": -1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        q, m, E, B = case[\"q\"], case[\"m\"], case[\"E\"], case[\"B\"]\n        T, dt, v0, r0 = case[\"T\"], case[\"dt\"], case[\"v0\"], case[\"r0\"]\n\n        B_norm_sq = np.dot(B, B)\n\n        # Calculate analytical drift velocity\n        if B_norm_sq  0:\n            v_drift_analytical = np.cross(E, B) / B_norm_sq\n        else:\n            v_drift_analytical = np.array([0.0, 0.0, 0.0])\n            \n        num_steps = int(round(T / dt))\n\n        # --- Forward Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            r_next = r + v * dt\n            v_next = v + a * dt\n            r, v = r_next, v_next\n        \n        r_final_fe, v_final_fe = r, v\n        \n        # --- Semi-Implicit Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            v_next = v + a * dt\n            r_next = r + v_next * dt\n            r, v = r_next, v_next\n            \n        r_final_se, v_final_se = r, v\n\n        # --- Calculate errors ---\n        # Guiding center position R_0 at t=0 is r0 since v0 is zero\n        R0 = r0\n        \n        # Error for Forward Euler\n        if B_norm_sq  0:\n            R_T_fe = r_final_fe - (m / (q * B_norm_sq)) * np.cross(v_final_fe, B)\n        else: # Handle B=0 case, though not in test suite\n            R_T_fe = r_final_fe\n            \n        v_drift_fe_numerical = (R_T_fe - R0) / T\n        error_fe = np.linalg.norm(v_drift_fe_numerical - v_drift_analytical)\n        results.append(error_fe)\n\n        # Error for Semi-Implicit Euler\n        if B_norm_sq  0:\n            R_T_se = r_final_se - (m / (q * B_norm_sq)) * np.cross(v_final_se, B)\n        else: # Handle B=0 case\n            R_T_se = r_final_se\n\n        v_drift_se_numerical = (R_T_se - R0) / T\n        error_se = np.linalg.norm(v_drift_se_numerical - v_drift_analytical)\n        results.append(error_se)\n\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```", "id": "2390224"}]}