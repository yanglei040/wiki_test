{"hands_on_practices": [{"introduction": "To build a robust understanding of Alfvén waves, we begin with a foundational exercise. This practice involves deriving the properties of shear Alfvén waves from first principles within a simplified, yet canonical, geometry: a straight cylindrical plasma. By applying the linearized ideal Magnetohydrodynamics (MHD) equations and imposing boundary conditions from perfectly conducting walls, you will discover how these conditions lead to the quantization of wave frequencies, giving rise to a discrete spectrum of global shear Alfvén eigenmodes [@problem_id:3690757]. This exercise is crucial for developing intuition about the fundamental nature of these waves before tackling the complexities of more realistic fusion-relevant geometries.", "problem": "Consider a straight, finite-length, cylindrical plasma column of radius $a$ and length $L$, with uniform mass density $\\rho$ and a uniform equilibrium magnetic field $\\boldsymbol{B}_0 = B_0 \\,\\hat{\\boldsymbol{z}}$. The cylindrical side wall at $r=a$ and the axial endplates at $z=0$ and $z=L$ are perfectly conducting. Using the linearized, ideal Magnetohydrodynamics (MHD) equations as the fundamental base, derive the shear Alfvén eigenvalue problem for global modes in this geometry. Assume incompressible perturbations so that $\\nabla \\cdot \\boldsymbol{v} = 0$, and neglect equilibrium flow and pressure gradients. Employ the linearized ideal Ohm’s law and magnetic induction to eliminate the magnetic field perturbation in favor of the fluid velocity. Impose the perfectly conducting wall boundary condition that the perturbed parallel electric field $\\delta E_{\\parallel}$ vanishes at the wall, and any other boundary conditions implied by a perfect conductor.\n\nSolve the resulting eigenvalue problem to obtain the discrete set of global shear Alfvén eigenfrequencies sustained by the plasma column. Express the final eigenfrequency as a closed-form analytic expression in terms of $n$, $L$, $B_0$, $\\mu_0$, and $\\rho$, where $n$ is a positive integer labeling the axial standing-wave harmonic. Express the final result in radians per second. No numerical evaluation is required, and no rounding is to be performed.", "solution": "The problem requires the derivation and solution of the eigenvalue problem for global shear Alfvén modes in a finite, cylindrical, uniform plasma. The derivation will be based on the linearized, ideal Magnetohydrodynamics (MHD) equations under the specified assumptions.\n\nThe fundamental linearized ideal MHD equations for a plasma with equilibrium density $\\rho_0$, pressure $p_0$, magnetic field $\\boldsymbol{B}_0$, and zero equilibrium flow ($\\boldsymbol{v}_0=0$) are:\n\n1.  Momentum Equation:\n    $$ \\rho_0 \\frac{\\partial \\delta \\boldsymbol{v}}{\\partial t} = \\frac{1}{\\mu_0} (\\nabla \\times \\delta \\boldsymbol{B}) \\times \\boldsymbol{B}_0 - \\nabla \\delta p $$\n    Here, a uniform equilibrium is assumed ($\\nabla p_0 = 0$, $\\nabla \\times \\boldsymbol{B}_0 = 0$), and perturbed quantities are denoted by $\\delta$. The problem specifies a uniform mass density $\\rho_0=\\rho$ and a uniform magnetic field $\\boldsymbol{B}_0 = B_0 \\hat{\\boldsymbol{z}}$.\n\n2.  Induction Equation (from ideal Ohm's Law $\\delta \\boldsymbol{E} + \\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0 = 0$ and Faraday's Law):\n    $$ \\frac{\\partial \\delta \\boldsymbol{B}}{\\partial t} = \\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0) $$\n\n3.  Incompressibility Condition:\n    $$ \\nabla \\cdot \\delta \\boldsymbol{v} = 0 $$\n\n4.  Gauss's Law for Magnetism:\n    $$ \\nabla \\cdot \\delta \\boldsymbol{B} = 0 $$\n\nWe assume a harmonic time dependence for all perturbed quantities of the form $\\exp(-i\\omega t)$, so the time derivative operator becomes $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$.\n\nThe equations become:\n$$ -i\\omega \\rho \\delta \\boldsymbol{v} = \\frac{1}{\\mu_0} (\\nabla \\times \\delta \\boldsymbol{B}) \\times \\boldsymbol{B}_0 - \\nabla \\delta p $$\n$$ -i\\omega \\delta \\boldsymbol{B} = \\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0) $$\n\nAs instructed, we eliminate the perturbed magnetic field $\\delta \\boldsymbol{B}$. From the induction equation, we have:\n$$ \\delta \\boldsymbol{B} = \\frac{i}{\\omega} \\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0) $$\nSubstituting this into the momentum equation:\n$$ -i\\omega \\rho \\delta \\boldsymbol{v} = \\frac{1}{\\mu_0} \\left( \\nabla \\times \\left[ \\frac{i}{\\omega} \\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0) \\right] \\right) \\times \\boldsymbol{B}_0 - \\nabla \\delta p $$\nMultiplying by $i\\omega$ yields the wave equation for $\\delta \\boldsymbol{v}$:\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v} = \\frac{1}{\\mu_0} \\left( \\nabla \\times \\left[ \\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0) \\right] \\right) \\times \\boldsymbol{B}_0 - \\nabla \\delta p $$\nWe simplify the term $\\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0)$ using the vector identity $\\nabla \\times (\\boldsymbol{A} \\times \\boldsymbol{B}) = (\\boldsymbol{B} \\cdot \\nabla)\\boldsymbol{A} - (\\boldsymbol{A} \\cdot \\nabla)\\boldsymbol{B} + \\boldsymbol{A}(\\nabla \\cdot \\boldsymbol{B}) - \\boldsymbol{B}(\\nabla \\cdot \\boldsymbol{A})$. With $\\boldsymbol{A}=\\delta \\boldsymbol{v}$ and $\\boldsymbol{B}=\\boldsymbol{B}_0$, and noting that $\\boldsymbol{B}_0$ is a uniform field ($\\nabla \\boldsymbol{B}_0 = 0$, $\\nabla \\cdot \\boldsymbol{B}_0 = 0$) and the flow is incompressible ($\\nabla \\cdot \\delta \\boldsymbol{v} = 0$):\n$$ \\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0) = (\\boldsymbol{B}_0 \\cdot \\nabla)\\delta \\boldsymbol{v} $$\nSince $\\boldsymbol{B}_0 = B_0 \\hat{\\boldsymbol{z}}$, the operator $(\\boldsymbol{B}_0 \\cdot \\nabla)$ is $B_0 \\frac{\\partial}{\\partial z}$.\nThe wave equation becomes:\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v} = \\frac{1}{\\mu_0} \\left( \\nabla \\times \\left[ (\\boldsymbol{B}_0 \\cdot \\nabla)\\delta \\boldsymbol{v} \\right] \\right) \\times \\boldsymbol{B}_0 - \\nabla \\delta p $$\nThe operators $\\nabla$ and $(\\boldsymbol{B}_0 \\cdot \\nabla)$ commute because $\\boldsymbol{B}_0$ is a constant vector. Thus:\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v} = \\frac{1}{\\mu_0} \\left( (\\boldsymbol{B}_0 \\cdot \\nabla)[\\nabla \\times \\delta \\boldsymbol{v}] \\right) \\times \\boldsymbol{B}_0 - \\nabla \\delta p $$\nUsing the identity $(\\boldsymbol{A} \\times \\boldsymbol{B}) \\times \\boldsymbol{C} = (\\boldsymbol{A} \\cdot \\boldsymbol{C})\\boldsymbol{B} - (\\boldsymbol{B} \\cdot \\boldsymbol{C})\\boldsymbol{A}$ with $\\boldsymbol{A} = (\\boldsymbol{B}_0 \\cdot \\nabla)[\\nabla \\times \\delta \\boldsymbol{v}]$, $\\boldsymbol{B}=\\hat{\\boldsymbol{z}}$ and $\\boldsymbol{C}=\\hat{\\boldsymbol{z}}$ (conceptually), we project the equation parallel and perpendicular to $\\boldsymbol{B}_0$.\nThe parallel ($\\hat{\\boldsymbol{z}}$) component of the equation is:\n$$ \\omega^2 \\rho \\delta v_z = - \\frac{\\partial \\delta p}{\\partial z} $$\nThe perpendicular component is:\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v}_\\perp = \\frac{B_0}{\\mu_0} \\left( (\\boldsymbol{B}_0 \\cdot \\nabla)[\\nabla \\times \\delta \\boldsymbol{v}] \\right) \\times \\hat{\\boldsymbol{z}} - \\nabla_\\perp \\delta p $$\nShear Alfvén waves are characterized by fluid motion purely transverse to the magnetic field, meaning $\\delta \\boldsymbol{v} = \\delta \\boldsymbol{v}_\\perp$ and $\\delta v_z = 0$. With $\\delta v_z=0$, the parallel momentum equation gives $\\frac{\\partial \\delta p}{\\partial z} = 0$.\nFurthermore, the incompressibility condition $\\nabla \\cdot \\delta \\boldsymbol{v}=0$ becomes $\\nabla_\\perp \\cdot \\delta \\boldsymbol{v}_\\perp = 0$.\nThe vector term on the right-hand side simplifies. For $\\delta v_z=0$:\n$$ (\\nabla \\times \\delta \\boldsymbol{v})_x = -\\frac{\\partial \\delta v_y}{\\partial z} \\quad , \\quad (\\nabla \\times \\delta \\boldsymbol{v})_y = \\frac{\\partial \\delta v_x}{\\partial z} $$\nLet's re-evaluate the full expression more directly. Inserting $\\nabla \\times (\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0) = (\\boldsymbol{B}_0 \\cdot \\nabla)\\delta \\boldsymbol{v}$ back into the equation for $\\delta \\boldsymbol{B}$:\n$\\delta \\boldsymbol{B} = \\frac{i}{\\omega} (\\boldsymbol{B}_0 \\cdot \\nabla)\\delta \\boldsymbol{v}$. The momentum equation then becomes:\n$$ -i\\omega \\rho \\delta \\boldsymbol{v} = \\frac{1}{\\mu_0} \\left(\\nabla \\times \\left[\\frac{i}{\\omega}(\\boldsymbol{B}_0 \\cdot \\nabla)\\delta \\boldsymbol{v}\\right]\\right) \\times \\boldsymbol{B}_0 - \\nabla \\delta p $$\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v} = -\\frac{1}{\\mu_0} (\\boldsymbol{B}_0 \\cdot \\nabla) \\left( \\nabla \\times \\delta \\boldsymbol{v} \\right) \\times \\boldsymbol{B}_0 + \\nabla \\delta p $$\nThis can be simplified using a vector identity for the triple product:\n$\\left( (\\boldsymbol{B}_0 \\cdot \\nabla)[\\nabla \\times \\delta \\boldsymbol{v}] \\right) \\times \\boldsymbol{B}_0 = -(\\boldsymbol{B}_0 \\cdot \\nabla)^2 \\delta\\boldsymbol{v} + (\\boldsymbol{B}_0 \\cdot \\nabla)\\nabla(\\delta\\boldsymbol{v} \\cdot \\boldsymbol{B}_0)$.\nWith $\\delta \\boldsymbol{v} \\cdot \\boldsymbol{B}_0 = \\delta v_z B_0 = 0$, the second term vanishes.\nThe wave equation becomes:\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v} = \\frac{B_0^2}{\\mu_0} \\frac{\\partial^2 \\delta \\boldsymbol{v}}{\\partial z^2} + \\nabla \\delta p $$\nSeparating into perpendicular and parallel components and using $\\delta \\boldsymbol{v}=\\delta \\boldsymbol{v}_\\perp$:\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v}_\\perp = \\frac{B_0^2}{\\mu_0} \\frac{\\partial^2 \\delta \\boldsymbol{v}_\\perp}{\\partial z^2} + \\nabla_\\perp \\delta p $$\n$$ 0 = \\frac{\\partial \\delta p}{\\partial z} $$\nTaking the perpendicular divergence ($\\nabla_\\perp \\cdot$) of the first equation:\n$$ \\omega^2 \\rho (\\nabla_\\perp \\cdot \\delta \\boldsymbol{v}_\\perp) = \\frac{B_0^2}{\\mu_0} \\frac{\\partial^2}{\\partial z^2} (\\nabla_\\perp \\cdot \\delta \\boldsymbol{v}_\\perp) + \\nabla_\\perp^2 \\delta p $$\nUsing the incompressibility condition $\\nabla_\\perp \\cdot \\delta \\boldsymbol{v}_\\perp = 0$, this reduces to $\\nabla_\\perp^2 \\delta p = 0$. Since $\\delta p$ is also independent of $z$, and any regular solution nonsingular at $r=0$ to Laplace's equation in a cylinder is of the form $r^m \\cos(m\\theta)$ or $r^m \\sin(m\\theta)$, if the plasma fills the cylinder to $r=0$, the only bounded solution that is constant with $z$ is $\\delta p = \\text{constant}$. For a perturbation, we can set this constant to zero. Thus, for shear Alfvén waves, $\\delta p = 0$.\n\nThe resulting eigenvalue problem for the shear Alfvén wave is:\n$$ \\omega^2 \\rho \\delta \\boldsymbol{v}_\\perp = \\frac{B_0^2}{\\mu_0} \\frac{\\partial^2 \\delta \\boldsymbol{v}_\\perp}{\\partial z^2} $$\n$$ \\left( \\omega^2 + v_A^2 \\frac{\\partial^2}{\\partial z^2} \\right) \\delta \\boldsymbol{v}_\\perp = 0 $$\nwhere $v_A = B_0/\\sqrt{\\mu_0 \\rho}$ is the Alfvén speed.\n\nThe boundary conditions are determined by the perfectly conducting walls. On a perfect conductor, the tangential component of the electric field $\\delta \\boldsymbol{E}$ must vanish. From ideal Ohm's Law, $\\delta \\boldsymbol{E} = -\\delta \\boldsymbol{v} \\times \\boldsymbol{B}_0$.\nAt the axial endplates ($z=0$ and $z=L$), the tangential fields are $\\delta E_r$ and $\\delta E_\\theta$.\n$$ \\delta \\boldsymbol{E} = -(\\delta v_r \\hat{\\boldsymbol{r}} + \\delta v_\\theta \\hat{\\boldsymbol{\\theta}}) \\times (B_0 \\hat{\\boldsymbol{z}}) = B_0 \\delta v_\\theta \\hat{\\boldsymbol{r}} - B_0 \\delta v_r \\hat{\\boldsymbol{\\theta}} $$\nThe conditions $\\delta E_r(z=0,L)=0$ and $\\delta E_\\theta(z=0,L)=0$ imply $\\delta v_\\theta(z=0,L)=0$ and $\\delta v_r(z=0,L)=0$. Thus, the velocity perturbation itself must vanish at the ends:\n$$ \\delta \\boldsymbol{v}_\\perp(z=0) = 0 \\quad \\text{and} \\quad \\delta \\boldsymbol{v}_\\perp(z=L) = 0 $$\nThe equation is a second-order ordinary differential equation in $z$. We seek solutions of the form $\\delta \\boldsymbol{v}_\\perp(r,\\theta,z) = \\boldsymbol{V}(r,\\theta) Z(z)$. The equation for $Z(z)$ is:\n$$ v_A^2 \\frac{d^2 Z}{d z^2} + \\omega^2 Z = 0 $$\nThe general solution is $Z(z) = C_1 \\sin(k_z z) + C_2 \\cos(k_z z)$, where $k_z = \\omega/v_A$.\nApplying the boundary conditions:\n1.  $Z(0) = 0 \\implies C_1 \\sin(0) + C_2 \\cos(0) = 0 \\implies C_2=0$.\n2.  $Z(L) = 0 \\implies C_1 \\sin(k_z L) = 0$.\nFor a non-trivial solution ($C_1 \\neq 0$), we must have $\\sin(k_z L) = 0$. This quantizes the parallel wave number:\n$$ k_z L = n\\pi \\quad \\text{for} \\quad n = 1, 2, 3, \\dots $$\nThe integer $n$ must be positive for a non-trivial standing wave.\nSubstituting $k_z = \\omega_n / v_A$, we get:\n$$ \\frac{\\omega_n}{v_A} L = n\\pi $$\nSolving for the eigenfrequency $\\omega_n$:\n$$ \\omega_n = \\frac{n\\pi v_A}{L} $$\nFinally, substituting the expression for the Alfvén speed $v_A$:\n$$ \\omega_n = \\frac{n\\pi}{L} \\frac{B_0}{\\sqrt{\\mu_0 \\rho}} $$\nThe radial boundary condition, $\\delta v_r(r=a) = 0$, and the incompressibility condition, $\\nabla_\\perp \\cdot \\delta\\boldsymbol{v}_\\perp = 0$, constrain the radial and azimuthal form of the eigenfunction $\\boldsymbol{V}(r,\\theta)$, but do not affect the eigenfrequency in this ideal, uniform case. The eigenfrequency is degenerate with respect to the perpendicular mode structure. The specified problem only requests the expression for the eigenfrequency.", "answer": "$$\\boxed{\\frac{n\\pi B_0}{L\\sqrt{\\mu_0 \\rho}}}$$", "id": "3690757"}, {"introduction": "Real fusion plasmas are not uniform; their density and magnetic fields vary in space. This practice explores a critical consequence of this inhomogeneity: the Alfvén wave resonance, a phenomenon central to many plasma heating schemes. When a wave's frequency $\\omega$ matches the local Alfvén frequency $\\omega_{A}(x)$, ideal MHD predicts a singularity, which signals the breakdown of the ideal model and the onset of new physics. This exercise guides you through an asymptotic analysis to investigate how small amounts of dissipation, either resistivity ($\\eta$) or viscosity ($\\nu$), resolve this singularity by forming a thin \"dissipative layer\" where wave energy can be efficiently absorbed [@problem_id:3690816]. Mastering this concept is essential for understanding how energy is transferred from waves to the plasma in a targeted manner.", "problem": "Consider a planar, cold plasma appropriate to Magnetohydrodynamics (MHD) with a uniform equilibrium magnetic field $\\mathbf{B}_{0} = B_{0} \\hat{\\mathbf{z}}$ and a transverse inhomogeneity in mass density $\\rho_{0} = \\rho_{0}(x)$ on a macroscopic scale. Let a linear wave perturbation vary as $\\exp\\!\\left(\\mathrm{i} k_{y} y + \\mathrm{i} k_{z} z - \\mathrm{i} \\omega t\\right)$, with fixed real frequency $\\omega$ and wavenumbers $k_{y}$ and $k_{z}$. Define the local Alfvén frequency $\\omega_{A}(x) \\equiv k_{\\parallel} V_{A}(x)$, where $k_{\\parallel} \\equiv k_{z}$ for this geometry and $V_{A}(x) \\equiv B_{0}/\\sqrt{\\mu_{0} \\rho_{0}(x)}$. Assume small but finite magnetic diffusivity $\\eta$ (taken here as the magnetic diffusivity with units $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$) and kinematic viscosity $\\nu$ (units $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$), both spatially uniform. An Alfvén resonance occurs at a position $x = x_{A}$ where $\\omega^{2} = \\omega_{A}^{2}(x_{A})$. Near $x_{A}$, define \n$$\n\\Delta_{A} \\equiv \\left.\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\omega^{2} - \\omega_{A}^{2}(x)\\right)\\right|_{x_{A}}.\n$$\nYou may take $|\\Delta_{A}|$ to be nonzero and finite.\n\nUsing only the linearized resistive and viscous MHD equations and asymptotic reasoning near the resonance, compare the characteristic dissipative layers for resistive versus viscous regularization of the Alfvén singularity. In particular, estimate the leading-order scaling of the inner-layer width $\\delta_{\\eta}$ when resistivity dominates and $\\delta_{\\nu}$ when viscosity dominates, expressed in terms of $\\eta$, $\\nu$, $\\omega$, and $|\\Delta_{A}|$. Express your final layer widths in meters. Your final answer must be a single closed-form analytic expression and contain the two widths side by side. Do not use any numerical approximations; no rounding is required.", "solution": "The problem asks for the scaling of the characteristic dissipative layer widths, $\\delta_{\\eta}$ and $\\delta_{\\nu}$, for an Alfvén wave resonance regularized by resistivity and viscosity, respectively. The analysis will proceed by examining the structure of the governing magnetohydrodynamic (MHD) equations in the vicinity of the resonance.\n\nThe equilibrium is characterized by a uniform magnetic field $\\mathbf{B}_{0} = B_{0} \\hat{\\mathbf{z}}$ and an inhomogeneous mass density $\\rho_{0}(x)$. The Alfvén wave resonance occurs at a spatial location $x = x_{A}$ where the wave frequency $\\omega$ matches the local Alfvén frequency, $\\omega^{2} = \\omega_{A}^{2}(x_{A})$. The local Alfvén frequency is defined as $\\omega_{A}(x) \\equiv k_{z} V_{A}(x)$, with $V_{A}(x) = B_{0}/\\sqrt{\\mu_{0} \\rho_{0}(x)}$.\n\nNear the resonance, the quantity $\\omega^{2} - \\omega_{A}^{2}(x)$ can be linearized:\n$$\n\\omega^{2} - \\omega_{A}^{2}(x) \\approx (x - x_{A}) \\left. \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\omega^{2} - \\omega_{A}^{2}(x)) \\right|_{x_{A}} = (x - x_{A}) \\Delta_{A}\n$$\nIn ideal MHD (with $\\eta = 0$ and $\\nu = 0$), the linearized equations for shear Alfvén waves can be reduced to a second-order ordinary differential equation for a field variable, say $\\psi(x)$, which is singular at $x=x_{A}$. Schematically, this equation takes the form:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( (\\omega^{2} - \\omega_{A}^{2}(x)) \\frac{\\mathrm{d}\\psi}{\\mathrm{d}x} \\right) - k_y^2 (\\omega^{2} - \\omega_{A}^{2}(x)) \\psi = 0\n$$\nSubstituting the linear approximation for the resonant term, and focusing on the region near $x \\approx x_A$ where spatial scales are small (i.e., $\\frac{\\mathrm{d}}{\\mathrm{d}x} \\gg k_y$), the equation is dominated by the highest derivative terms:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\Delta_{A} (x - x_{A}) \\frac{\\mathrm{d}\\psi}{\\mathrm{d}x} \\right) \\approx 0\n$$\nThis equation exhibits a logarithmic singularity, which is non-physical and indicates that other physical effects must become important in a thin layer around $x_A$. We now analyze how resistivity and viscosity separately resolve this singularity.\n\n### Case 1: Resistive Layer Scaling ($\\delta_{\\eta}$)\nWhen magnetic diffusivity $\\eta$ is included, the ideal Ohm's law is replaced by $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{j}$. This modification introduces higher-order spatial derivatives into the governing wave equation. The full resistive MHD wave equation is of fourth order. In the vicinity of the resonance, the dominant balance is between the singular ideal term and the highest-order derivative term introduced by resistivity. The equation structure becomes:\n$$\n\\Delta_{A} (x - x_{A}) \\frac{\\mathrm{d}^2\\psi}{\\mathrm{d}x^2} \\sim \\mathrm{i} C_{\\eta} \\eta \\omega \\frac{\\mathrm{d}^4\\psi}{\\mathrm{d}x^4}\n$$\nwhere $C_{\\eta}$ is a constant of order unity. To find the characteristic width of the resistive layer, $\\delta_{\\eta}$, we perform a scaling analysis. Within this layer, we set the local coordinate $X = x - x_{A} \\sim \\delta_{\\eta}$ and the derivative operator $\\frac{\\mathrm{d}}{\\mathrm{d}x} \\sim \\frac{1}{\\delta_{\\eta}}$. Substituting these scales into the balanced equation:\n$$\n|\\Delta_{A}| \\delta_{\\eta} \\frac{1}{\\delta_{\\eta}^2} \\sim \\eta \\omega \\frac{1}{\\delta_{\\eta}^4}\n$$\n$$\n\\frac{|\\Delta_{A}|}{\\delta_{\\eta}} \\sim \\frac{\\eta \\omega}{\\delta_{\\eta}^4}\n$$\nSolving for $\\delta_{\\eta}$ yields:\n$$\n\\delta_{\\eta}^3 \\sim \\frac{\\eta \\omega}{|\\Delta_{A}|} \\implies \\delta_{\\eta} \\sim \\left( \\frac{\\eta \\omega}{|\\Delta_{A}|} \\right)^{1/3}\n$$\n\n### Case 2: Viscous Layer Scaling ($\\delta_{\\nu}$)\nWhen kinematic viscosity $\\nu$ is included, a viscous force term $\\rho_{0} \\nu \\nabla^2 \\mathbf{v}$ is added to the momentum equation. For perturbations varying as $\\exp(-\\mathrm{i}\\omega t)$, the momentum equation becomes $\\rho_0(-\\mathrm{i}\\omega \\mathbf{v}) = \\mathbf{F}_{\\text{ideal}} + \\rho_0 \\nu \\nabla^2 \\mathbf{v}$. This can be rearranged as $\\rho_0(-\\mathrm{i}\\omega - \\nu \\nabla^2)\\mathbf{v} = \\mathbf{F}_{\\text{ideal}}$. In the resonant layer, the perpendicular wavenumber $k_x \\sim 1/\\delta_{\\nu}$ becomes large, so $\\nabla^2 \\approx \\frac{\\mathrm{d}^2}{\\mathrm{d}x^2} \\sim -k_x^2$.\n\nThe effect of viscosity is to modify the inertia term. The term $\\omega^2$ in the ideal resonance condition $\\omega^2 - \\omega_A^2(x) = 0$ is effectively replaced by $\\omega(\\omega + \\mathrm{i}\\nu k_x^2)$. The resonance condition becomes a balance between the small real part and the new imaginary part:\n$$\n\\text{Re}[\\omega(\\omega + \\mathrm{i}\\nu k_x^2) - \\omega_A^2(x)] \\approx -\\text{Im}[\\omega(\\omega + \\mathrm{i}\\nu k_x^2) - \\omega_A^2(x)]\n$$\n$$\n\\omega^2 - \\omega_A^2(x) \\approx \\omega \\nu k_x^2\n$$\nIn the layer of width $\\delta_{\\nu}$, we have $x - x_A \\sim \\delta_{\\nu}$ and $k_x \\sim 1/\\delta_{\\nu}$. The left side is approximated as $\\Delta_A(x-x_A) \\sim |\\Delta_{A}| \\delta_{\\nu}$. The dominant balance gives:\n$$\n|\\Delta_{A}| \\delta_{\\nu} \\sim \\omega \\nu \\left( \\frac{1}{\\delta_{\\nu}} \\right)^2\n$$\n$$\n\\delta_{\\nu}^3 \\sim \\frac{\\omega \\nu}{|\\Delta_{A}|} \\implies \\delta_{\\nu} \\sim \\left( \\frac{\\omega \\nu}{|\\Delta_{A}|} \\right)^{1/3}\n$$\nThe scaling analysis reveals that both resistivity and viscosity lead to a dissipative layer width that scales as the cube root of the respective diffusivity.\n\nThe final expressions for the scaling of the layer widths are:\n$$\n\\delta_{\\eta} \\propto \\left( \\frac{\\eta \\omega}{|\\Delta_{A}|} \\right)^{1/3} \\quad \\text{and} \\quad \\delta_{\\nu} \\propto \\left( \\frac{\\nu \\omega}{|\\Delta_{A}|} \\right)^{1/3}\n$$\nThe units of the expressions are meters, as required. For $\\delta_\\eta$, the units are $[\\frac{(\\mathrm{m}^2/\\mathrm{s}) (\\mathrm{s}^{-1})}{(\\mathrm{s}^{-2}/\\mathrm{m})}]^{1/3} = [\\mathrm{m}^3]^{1/3} = \\mathrm{m}$. The same holds for $\\delta_\\nu$. The problem asks for the estimate of the widths, which corresponds to these leading-order scaling expressions.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left( \\frac{\\eta \\omega}{|\\Delta_{A}|} \\right)^{1/3}  \\left( \\frac{\\nu \\omega}{|\\Delta_{A}|} \\right)^{1/3}\n\\end{pmatrix}\n}\n$$", "id": "3690816"}, {"introduction": "Bridging the gap from idealized models to practical application, this final practice challenges you to simulate the propagation of Alfvén waves in a realistic tokamak environment. Since the plasma parameters ($v_A$, $\\mathbf{B}_0$) vary significantly throughout the device, we must employ the powerful geometric optics framework, where wave packets are treated as rays governed by Hamiltonian equations. This computational exercise involves deriving the ray equations from the shear and fast wave dispersion relations and then numerically integrating them within a defined tokamak equilibrium [@problem_id:3690797]. This capstone problem synthesizes theoretical concepts and computational skills to visualize how waves travel and refract through the complex magnetic landscape of a fusion device, a critical step in designing effective wave-based heating and current drive systems.", "problem": "Consider small-amplitude waves in a cold, magnetized plasma relevant to nuclear fusion devices. Assume the validity of ideal MagnetoHydroDynamics (MHD), characterized by the mass density $\\rho$, magnetic field $\\mathbf{B}$, electric field $\\mathbf{E}$, current density $\\mathbf{J}$, and fluid velocity $\\mathbf{v}$. The governing equations are mass conservation, Faraday’s law, Ampère’s law without displacement current, and the ideal Ohm’s law:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\, \\mathbf{v}) = 0,\n$$\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E},\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\, \\mathbf{J},\n$$\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = 0,\n$$\nwhere $\\mu_0$ is the vacuum permeability. Linearize about a static equilibrium with $\\mathbf{v}_0 = \\mathbf{0}$ and prescribed $\\mathbf{B}_0(\\mathbf{x})$ and $\\rho_0(\\mathbf{x})$. In the eikonal approximation, take wave solutions with phase $S(\\mathbf{x},t)$ so that the local wavevector is $\\mathbf{k} = \\nabla S$ and the frequency is $\\omega = -\\partial S/\\partial t$. For a cold plasma, the two Alfvén branches are:\n- Shear Alfvén branch: \n$$\n\\omega^2 = v_A^2(\\mathbf{x}) \\, k_\\parallel^2,\n$$ \nwhere $v_A(\\mathbf{x}) = \\frac{\\lVert \\mathbf{B}_0(\\mathbf{x}) \\rVert}{\\sqrt{\\mu_0 \\, \\rho_0(\\mathbf{x})}}$ and $k_\\parallel = \\mathbf{k}\\cdot \\mathbf{b}$ with $\\mathbf{b} = \\mathbf{B}_0/\\lVert\\mathbf{B}_0\\rVert$.\n- Compressional (fast) Alfvén branch in the cold limit: \n$$\n\\omega^2 = v_A^2(\\mathbf{x}) \\, \\lVert \\mathbf{k} \\rVert^2.\n$$\n\nUsing the standard Hamiltonian ray framework for dispersion relations $D(\\mathbf{x},\\mathbf{k},\\omega)=0$, derive the ray equations for each branch in the form\n$$\n\\frac{d\\mathbf{x}}{dt} = \\frac{\\partial \\omega}{\\partial \\mathbf{k}}, \\quad \\frac{d\\mathbf{k}}{dt} = -\\frac{\\partial \\omega}{\\partial \\mathbf{x}},\n$$\nwith $\\omega(\\mathbf{x},\\mathbf{k})$ inferred from the corresponding branch.\n\nThen, numerically integrate the ray equations in an axisymmetric, large-aspect-ratio tokamak equilibrium defined in cylindrical-like coordinates $\\{R,Z,\\varphi\\}$ as follows:\n- Major radius $R_0 = 1.7\\,\\mathrm{m}$, minor radius $a = 0.6\\,\\mathrm{m}$.\n- Toroidal magnetic field magnitude given by \n$$\nB_\\varphi(R) = B_0 \\frac{R_0}{R},\n$$ \nwith $B_0 = 5.0\\,\\mathrm{T}$.\n- Safety factor profile \n$$\nq(r) = q_0 + q_1 \\left(\\frac{r}{a}\\right)^2,\n$$ \nwith $q_0 = 1.0$ and $q_1 = 2.0$, where the minor radius $r$ is defined by \n$$\nr = \\sqrt{(R - R_0)^2 + Z^2}.\n$$\n- Poloidal magnetic field magnitude \n$$\nB_\\theta(r,R) = B_\\varphi(R)\\, \\frac{r}{R_0 \\; q(r)}.\n$$\n- Poloidal unit vector \n$$\n\\mathbf{e}_\\theta = (-\\sin \\theta,\\, \\cos \\theta,\\, 0),\n$$ \nwith poloidal angle \n$$\n\\theta = \\operatorname{atan2}(Z, R - R_0).\n$$\n- Magnetic field vector \n$$\n\\mathbf{B}_0(R,Z) = B_\\theta(r,R) \\, \\mathbf{e}_\\theta + B_\\varphi(R) \\, \\mathbf{e}_\\varphi,\n$$ \nunit vector \n$$\n\\mathbf{b}(R,Z) = \\frac{\\mathbf{B}_0}{\\lVert\\mathbf{B}_0\\rVert}.\n$$\n- Density profile \n$$\nn(r) = n_0 \\left[\\max\\left(0, 1 - \\left(\\frac{r}{a}\\right)^2 \\right)\\right]^\\alpha + f_n \\, n_0,\n$$ \nwith $n_0 = 1.0\\times 10^{20}\\,\\mathrm{m}^{-3}$, $\\alpha = 1$, and floor fraction $f_n = 0.15$; mass density \n$$\n\\rho_0(r) = m_i \\, n(r),\n$$ \nusing deuterium ion mass $m_i = 3.344\\times 10^{-27}\\,\\mathrm{kg}$; and Alfvén speed \n$$\nv_A(R,Z) = \\frac{\\lVert\\mathbf{B}_0(R,Z)\\rVert}{\\sqrt{\\mu_0 \\, \\rho_0(r)}}.\n$$\n\nImplement the ray equations as ordinary differential equations (ODEs) in the state $\\{R, Z, \\varphi, k_R, k_Z, k_\\varphi\\}$ for each branch:\n- Fast (compressional) branch with \n$$\n\\omega(\\mathbf{x},\\mathbf{k}) = v_A(\\mathbf{x}) \\, \\lVert \\mathbf{k} \\rVert,\n$$ \nimplying \n$$\n\\frac{d\\mathbf{x}}{dt} = v_A \\, \\frac{\\mathbf{k}}{\\lVert \\mathbf{k} \\rVert}, \\quad \\frac{d\\mathbf{k}}{dt} = -\\lVert \\mathbf{k} \\rVert \\, \\nabla v_A.\n$$\n- Shear branch with \n$$\n\\omega(\\mathbf{x},\\mathbf{k}) = v_A(\\mathbf{x}) \\, \\lvert \\mathbf{k}\\cdot \\mathbf{b}(\\mathbf{x}) \\rvert,\n$$ \nimplying \n$$\n\\frac{d\\mathbf{x}}{dt} = v_A \\, \\operatorname{sgn}(\\mathbf{k}\\cdot\\mathbf{b}) \\, \\mathbf{b}, \\quad \\frac{d\\mathbf{k}}{dt} = -\\lvert \\mathbf{k}\\cdot \\mathbf{b} \\rvert \\, \\nabla v_A - v_A \\, \\operatorname{sgn}(\\mathbf{k}\\cdot\\mathbf{b}) \\, (\\mathbf{k}\\cdot \\nabla)\\mathbf{b}.\n$$\nFor numerical implementation, compute $\\nabla v_A$ and the spatial derivatives of $\\mathbf{b}$ via finite differences in $R$ and $Z$, assuming axisymmetry so that $\\partial/\\partial \\varphi = 0$. Use a fixed-step, fourth-order Runge–Kutta method.\n\nAdopt the following launch and integration specifications. Angles must be provided and interpreted in radians. Frequencies must be in $\\mathrm{rad/s}$. Integrate each ray for a total physical time of $t_\\mathrm{final} = 2.0\\times 10^{-7}\\,\\mathrm{s}$ using a fixed time step $\\Delta t = 2.0\\times 10^{-10}\\,\\mathrm{s}$. Terminate integration early if the minor radius exceeds the last closed flux surface, i.e., if $r \\ge a$. The initial toroidal angle is $\\varphi(0) = 0$ for all cases.\n\nDefine the local outward radial unit vector in the poloidal plane at the launch point as\n$$\n\\mathbf{e}_r = (\\cos \\theta, \\, \\sin \\theta, \\, 0),\n$$\nand use $\\mathbf{e}_\\theta$ as above. A poloidal launch direction at angle $\\delta$ relative to $\\mathbf{e}_r$ is\n$$\n\\hat{\\mathbf{k}}_\\text{pol} = \\cos \\delta \\, \\mathbf{e}_r + \\sin \\delta \\, \\mathbf{e}_\\theta.\n$$\n\nUse the following test suite of four cases. For each case, construct the initial state $\\{R(0), Z(0), \\varphi(0), \\mathbf{k}(0)\\}$ as specified:\n- Case $1$ (fast branch): $r_0 = 0.18\\,\\mathrm{m}$, $\\theta_0 = 0$, $\\delta = \\pi$ (inward radial), $k_\\varphi$ fraction $= 0.0$; frequency $\\omega = 2\\pi \\times 10^6\\,\\mathrm{rad/s}$. Set $R(0) = R_0 + r_0 \\cos \\theta_0$, $Z(0) = r_0 \\sin \\theta_0$, and choose $\\lVert\\mathbf{k}(0)\\rVert = \\omega / v_A(R(0),Z(0))$ with poloidal direction $\\hat{\\mathbf{k}}_\\text{pol}$ and $k_\\varphi(0) = 0$.\n- Case $2$ (fast branch): $r_0 = 0.33\\,\\mathrm{m}$, $\\theta_0 = \\pi/2$, $\\delta = 0$ (outward radial), $k_\\varphi$ fraction $= 0.2$ so that $k_\\varphi(0) = 0.2\\,\\lVert\\mathbf{k}(0)\\rVert$ and the poloidal magnitude is $\\sqrt{\\lVert\\mathbf{k}(0)\\rVert^2 - k_\\varphi(0)^2}$; frequency $\\omega = 2\\pi \\times 10^6\\,\\mathrm{rad/s}$.\n- Case $3$ (shear branch): $r_0 = 0.18\\,\\mathrm{m}$, $\\theta_0 = 0$, $\\delta = \\pi$ (inward radial for perpendicular part); frequency $\\omega = 2\\pi \\times 10^6\\,\\mathrm{rad/s}$. Set parallel component $\\mathbf{k}_\\parallel(0) = (\\omega / v_A)\\, \\mathbf{b}(R(0),Z(0))$, and add a perpendicular component of magnitude $0.1\\,(\\omega / v_A)$ along $\\hat{\\mathbf{k}}_\\text{pol}$ in the poloidal plane; take $k_\\varphi(0) = 0$.\n- Case $4$ (shear branch): $r_0 = 0.06\\,\\mathrm{m}$, $\\theta_0 = \\pi$, $\\delta$ not applicable; frequency $\\omega = 2\\pi \\times 10^6\\,\\mathrm{rad/s}$. Set $\\mathbf{k}(0) = (\\omega / v_A)\\, \\mathbf{b}(R(0),Z(0))$.\n\nFor each case, integrate the corresponding ray equations and return the final minor radius $r_\\mathrm{final}$ in meters at $t = t_\\mathrm{final}$ or at the moment the ray exits with $r \\ge a$, whichever occurs first. Round each $r_\\mathrm{final}$ to three decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$), where each entry is a float in meters rounded to three decimals and angles are in radians as specified. No other output is permitted.", "solution": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Alfvén wave ray tracing problem in a tokamak equilibrium.\n    \"\"\"\n\n    # --- Constants and Parameters ---\n    MU0 = 4.0 * np.pi * 1e-7\n    M_D = 3.344e-27  # Deuterium ion mass in kg\n\n    R0 = 1.7  # Major radius [m]\n    A = 0.6   # Minor radius [m]\n    B0 = 5.0  # Magnetic field on axis [T]\n    \n    Q0 = 1.0\n    Q1 = 2.0\n    \n    N0 = 1.0e20  # Central density [m^-3]\n    ALPHA = 1.0\n    F_N = 0.15   # Density floor fraction\n\n    FD_H = 1e-6  # Finite difference step for gradients\n\n    class TokamakModel:\n        \"\"\"\n        A class to encapsulate tokamak equilibrium calculations.\n        This avoids repeated calculations of the same quantities.\n        \"\"\"\n        \n        def get_r_theta(self, R, Z):\n            r = np.sqrt((R - R0)**2 + Z**2)\n            theta = np.arctan2(Z, R - R0)\n            return r, theta\n\n        def get_q(self, r):\n            r_eff = min(r, A)\n            return Q0 + Q1 * (r_eff / A)**2\n\n        def get_rho(self, r):\n            if r = A:\n                n = N0 * F_N\n            else:\n                n = N0 * ((1.0 - (r / A)**2)**ALPHA) + F_N * N0\n            return M_D * n\n\n        def get_B_phi_val(self, R):\n            return B0 * R0 / R\n\n        def get_B_theta_val(self, r, R):\n            if r  1e-9:\n                return 0.0\n            return self.get_B_phi_val(R) * r / (R0 * self.get_q(r))\n\n        def get_B_vec(self, R, Z):\n            r, theta = self.get_r_theta(R, Z)\n            B_phi_val = self.get_B_phi_val(R)\n            B_theta_val = self.get_B_theta_val(r, R)\n            \n            B_R = -B_theta_val * np.sin(theta)\n            B_Z =  B_theta_val * np.cos(theta)\n            B_phi = B_phi_val\n            \n            return np.array([B_R, B_Z, B_phi])\n\n        def get_vA(self, R, Z):\n            B_vec = self.get_B_vec(R, Z)\n            B_mag = np.linalg.norm(B_vec)\n            r, _ = self.get_r_theta(R, Z)\n            rho_val = self.get_rho(r)\n            if rho_val = 0: return np.inf\n            return B_mag / np.sqrt(MU0 * rho_val)\n\n        def get_b_vec(self, R, Z):\n            B_vec = self.get_B_vec(R, Z)\n            B_mag = np.linalg.norm(B_vec)\n            if B_mag  1e-12: return np.array([0.0, 0.0, 0.0])\n            return B_vec / B_mag\n\n        def grad_vA(self, R, Z):\n            dvA_dR = (self.get_vA(R + FD_H, Z) - self.get_vA(R - FD_H, Z)) / (2 * FD_H)\n            dvA_dZ = (self.get_vA(R, Z + FD_H) - self.get_vA(R, Z - FD_H)) / (2 * FD_H)\n            return np.array([dvA_dR, dvA_dZ, 0.0])\n\n        def spatial_deriv_b(self, R, Z):\n            db_dR = (self.get_b_vec(R + FD_H, Z) - self.get_b_vec(R - FD_H, Z)) / (2 * FD_H)\n            db_dZ = (self.get_b_vec(R, Z + FD_H) - self.get_b_vec(R, Z - FD_H)) / (2 * FD_H)\n            return db_dR, db_dZ\n\n    model = TokamakModel()\n\n    def rhs_fast(t, y, model):\n        R, Z, _, kR, kZ, kphi = y\n        vA = model.get_vA(R, Z)\n        k_vec = np.array([kR, kZ, kphi])\n        k_mag = np.linalg.norm(k_vec)\n        \n        if k_mag  1e-12: return np.zeros(6)\n            \n        dxdt = vA * k_vec / k_mag\n        dkdt = -k_mag * model.grad_vA(R, Z)\n        \n        return np.concatenate((dxdt, dkdt))\n\n    def rhs_shear(t, y, model):\n        R, Z, _, kR, kZ, kphi = y\n        vA = model.get_vA(R, Z)\n        b = model.get_b_vec(R, Z)\n        k_vec = np.array([kR, kZ, kphi])\n        k_dot_b = np.dot(k_vec, b)\n        \n        sign_k_dot_b = np.sign(k_dot_b)\n        \n        dxdt = vA * sign_k_dot_b * b\n        \n        grad_vA_vec = model.grad_vA(R, Z)\n        term1 = -np.abs(k_dot_b) * grad_vA_vec\n\n        db_dR, db_dZ = model.spatial_deriv_b(R, Z)\n        k_dot_nabla_b = kR * db_dR + kZ * db_dZ\n        term2 = -vA * sign_k_dot_b * k_dot_nabla_b\n        \n        dkdt = term1 + term2\n        \n        return np.concatenate((dxdt, dkdt))\n\n    def rk4_step(func, t, y, dt, model):\n        k1 = func(t, y, model)\n        k2 = func(t + 0.5 * dt, y + 0.5 * dt * k1, model)\n        k3 = func(t + 0.5 * dt, y + 0.5 * dt * k2, model)\n        k4 = func(t + dt, y + dt * k3, model)\n        return y + (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n\n    def solve_case(case_params, model):\n        branch, r0, theta0, delta, k_phi_frac, k_perp_frac, omega, set_kphi_zero, t_final, dt = case_params\n\n        R_init = R0 + r0 * np.cos(theta0)\n        Z_init = r0 * np.sin(theta0)\n        phi_init = 0.0\n\n        vA_init = model.get_vA(R_init, Z_init)\n        \n        k_vec_init = np.zeros(3)\n        if branch == 'fast':\n            k_mag_init = omega / vA_init\n            k_phi_init = k_phi_frac * k_mag_init\n            k_pol_mag = np.sqrt(k_mag_init**2 - k_phi_init**2)\n            \n            e_r = np.array([np.cos(theta0), np.sin(theta0), 0.0])\n            e_theta = np.array([-np.sin(theta0), np.cos(theta0), 0.0])\n            k_pol_hat = np.cos(delta) * e_r + np.sin(delta) * e_theta\n            \n            k_vec_init[0] = k_pol_mag * k_pol_hat[0]\n            k_vec_init[1] = k_pol_mag * k_pol_hat[1]\n            k_vec_init[2] = k_phi_init\n\n        elif branch == 'shear':\n            b_init = model.get_b_vec(R_init, Z_init)\n            k_parallel_mag = omega / vA_init\n            k_parallel_vec = k_parallel_mag * b_init\n            \n            if k_perp_frac is not None: # Case 3\n                k_perp_mag = k_perp_frac * k_parallel_mag\n                e_r = np.array([np.cos(theta0), np.sin(theta0), 0.0])\n                e_theta = np.array([-np.sin(theta0), np.cos(theta0), 0.0])\n                k_pol_hat = np.cos(delta) * e_r + np.sin(delta) * e_theta\n                k_perp_vec = k_perp_mag * k_pol_hat\n                k_vec_init = k_parallel_vec + k_perp_vec\n                if set_kphi_zero:\n                    k_vec_init[2] = 0.0\n            else: # Case 4\n                k_vec_init = k_parallel_vec\n\n        y = np.array([R_init, Z_init, phi_init, k_vec_init[0], k_vec_init[1], k_vec_init[2]])\n        t = 0.0\n        n_steps = int(t_final / dt)\n        \n        rhs_func = rhs_fast if branch == 'fast' else rhs_shear\n\n        for _ in range(n_steps):\n            r_current, _ = model.get_r_theta(y[0], y[1])\n            if r_current = A:\n                break\n            y = rk4_step(rhs_func, t, y, dt, model)\n            t += dt\n            \n        final_r, _ = model.get_r_theta(y[0], y[1])\n        return final_r\n\n    omega = 2.0 * np.pi * 1e6\n    t_final = 2.0e-7\n    dt = 2.0e-10\n\n    test_cases = [\n        # (branch, r0, theta0, delta, kphi_frac, k_perp_frac, omega, set_kphi_zero, t_final, dt)\n        ('fast',  0.18, 0.0,       np.pi, 0.0, None, omega, False, t_final, dt),\n        ('fast',  0.33, np.pi/2.0, 0.0,   0.2, None, omega, False, t_final, dt),\n        ('shear', 0.18, 0.0,       np.pi, None, 0.1, omega, True, t_final, dt),\n        ('shear', 0.06, np.pi,     None,  None, None, omega, False, t_final, dt),\n    ]\n\n    results = []\n    for case_params in test_cases:\n        final_r = solve_case(case_params, model)\n        results.append(f\"{final_r:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "answer": "[0.198,0.600,0.180,0.060]", "id": "3690797"}]}