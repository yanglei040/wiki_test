{"hands_on_practices": [{"introduction": "A bolometer is fundamentally a tiny thermometer, and its ability to track rapid changes in plasma radiation is limited by its thermal properties. This first exercise explores the core principle of energy conservation that governs a bolometer's response. By modeling the detector as a simple thermal node, you will derive its characteristic time constant, a crucial parameter for understanding and interpreting measurements of dynamic plasma events like disruptions or ELMs. [@problem_id:3692180]", "problem": "A resistive foil bolometer used for measuring total radiated power in a toroidal magnetic confinement device is modeled as a single thermal node with heat capacity $C$ connected to a thermal sink at temperature $T_{\\mathrm{s}}$ through a thermal conductance $G$. The absorbed radiative power $P_{\\mathrm{abs}}(t)$ heats the foil, and the temperature $T(t)$ evolves according to energy conservation. The absorbed power is related to the incident radiative power $P_{\\mathrm{inc}}(t)$ by the absorption efficiency $\\eta$, so that $P_{\\mathrm{abs}}(t)=\\eta\\,P_{\\mathrm{inc}}(t)$.\n\nAssume the system is initially in steady state at time $t<0$ with constant incident power $P_{\\mathrm{inc},0}$ and corresponding absorbed power $P_{\\mathrm{abs},0}=\\eta P_{\\mathrm{inc},0}$. At $t=0$ the incident power steps to a new constant value such that the absorbed power increases by a known amount $\\Delta P_{\\mathrm{abs}}=10\\ \\mathrm{mW}$. Take $G=1\\ \\mathrm{mW/K}$, $C=10^{-3}\\ \\mathrm{J/K}$, and $\\eta=0.8$. \n\nStarting from first principles, derive the transient temperature $T(t)$ for $t\\ge 0$ in terms of the initial temperature $T(0^{-})$ and the given parameters. Then determine the time required for $T(t)$ to be within $5\\%$ of its new equilibrium temperature after the step. Express the final time in seconds and round your answer to four significant figures.", "solution": "The user wants me to solve a thermodynamics problem concerning a resistive foil bolometer.\n\n**1. Problem Validation**\n\n*   **Step 1: Extract Givens**\n    *   System Model: A single thermal node with heat capacity $C$ and thermal conductance $G$ to a sink at temperature $T_{\\mathrm{s}}$.\n    *   Absorbed power relation: $P_{\\mathrm{abs}}(t) = \\eta P_{\\mathrm{inc}}(t)$.\n    *   Initial Condition ($t<0$): System is in steady state with constant absorbed power $P_{\\mathrm{abs},0}$. Foil temperature is $T(0^{-})$.\n    *   Event ($t=0$): Absorbed power steps up by $\\Delta P_{\\mathrm{abs}} = 10 \\, \\mathrm{mW}$.\n    *   Parameters:\n        *   $G = 1 \\, \\mathrm{mW/K} = 1 \\times 10^{-3} \\, \\mathrm{W/K}$\n        *   $C = 10^{-3} \\, \\mathrm{J/K}$\n        *   $\\eta = 0.8$\n        *   $\\Delta P_{\\mathrm{abs}} = 10 \\, \\mathrm{mW} = 1 \\times 10^{-2} \\, \\mathrm{W}$\n    *   Task 1: Derive the transient temperature $T(t)$ for $t \\ge 0$ in terms of $T(0^{-})$ and given parameters.\n    *   Task 2: Determine the time for $T(t)$ to be within $5\\%$ of its new equilibrium temperature.\n    *   Output Requirement: Final time in seconds, rounded to four significant figures.\n\n*   **Step 2: Validate Using Extracted Givens**\n    *   **Scientific Grounding:** The problem is based on the principle of energy conservation and Newton's law of cooling, which are fundamental in thermodynamics and heat transfer. The \"lumped capacitance model\" used here is a standard and valid approximation for a thin foil bolometer. The application to fusion diagnostics is scientifically correct.\n    *   **Well-Posedness:** The problem sets up a first-order linear ordinary differential equation with a defined initial condition, which constitutes a well-posed initial value problem with a unique, stable solution. All parameters required for the solution ($C$, $G$, $\\Delta P_{\\mathrm{abs}}$) are provided.\n    *   **Objectivity & Clarity:** The problem is stated using precise, objective scientific language. The term \"within $5\\%$ of its new equilibrium temperature\" has a standard interpretation in the context of transient system response (referring to the completion of the transient change), which makes the problem unambiguous.\n    *   **Completeness & Consistency:** The problem is self-contained. The provided numerical values and their units are physically consistent. Note that the absorption efficiency $\\eta$ and the sink temperature $T_{\\mathrm{s}}$ are not required for the final calculation, but their presence in the problem description serves to provide physical context and does not create a contradiction.\n    *   **Realism:** The given values for heat capacity, thermal conductance, and power change are physically plausible for a micro-fabricated bolometer used in plasma physics experiments.\n\n*   **Step 3: Verdict and Action**\n    *   The problem is deemed **valid** as it is scientifically sound, well-posed, and internally consistent. I will proceed with the solution.\n\n**2. Solution Derivation**\n\nThe transient thermal behavior of the bolometer foil is governed by the principle of energy conservation. The rate of change of the foil's internal energy is equal to the absorbed power minus the power lost to the thermal sink.\n\nThe rate of change of internal energy is given by $C \\frac{dT(t)}{dt}$, where $C$ is the heat capacity and $T(t)$ is the foil's temperature. The power lost to the sink at temperature $T_{\\mathrm{s}}$ is given by Newton's law of cooling, $P_{\\mathrm{loss}}(t) = G(T(t) - T_{\\mathrm{s}})$, where $G$ is the thermal conductance. The absorbed power is $P_{\\mathrm{abs}}(t)$.\n\nThe energy balance equation is therefore:\n$$\nC \\frac{dT(t)}{dt} = P_{\\mathrm{abs}}(t) - G(T(t) - T_{\\mathrm{s}})\n$$\n\nFirst, we analyze the steady-state conditions.\nFor $t < 0$, the system is in an initial steady state. The temperature is constant, $T(t) = T(0^{-}) \\equiv T_0$, so $\\frac{dT}{dt} = 0$. The absorbed power is $P_{\\mathrm{abs}}(t) = P_{\\mathrm{abs},0}$. The energy balance equation becomes:\n$$\n0 = P_{\\mathrm{abs},0} - G(T_0 - T_{\\mathrm{s}}) \\implies P_{\\mathrm{abs},0} = G(T_0 - T_{\\mathrm{s}})\n$$\n\nAt $t=0$, the absorbed power steps to a new constant value, $P_{\\mathrm{abs, new}} = P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}$. The system will eventually reach a new, final steady state as $t \\to \\infty$. In this final state, the temperature is constant, $T(t) = T_f$, so $\\frac{dT}{dt} = 0$. The energy balance is:\n$$\n0 = (P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}) - G(T_f - T_{\\mathrm{s}}) \\implies P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}} = G(T_f - T_{\\mathrm{s}})\n$$\n\nNow, we solve for the transient behavior for $t \\ge 0$. The governing differential equation is:\n$$\nC \\frac{dT}{dt} = (P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}) - G(T - T_{\\mathrm{s}})\n$$\nWe can substitute the expression for the final equilibrium condition, $P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}} = G T_f - G T_{\\mathrm{s}}$, into the differential equation:\n$$\nC \\frac{dT}{dt} = (G T_f - G T_{\\mathrm{s}}) - (G T - G T_{\\mathrm{s}}) = G(T_f - T)\n$$\nThis is a first-order linear ordinary differential equation. We can rearrange it as:\n$$\n\\frac{dT}{T_f - T} = \\frac{G}{C} dt\n$$\nIntegrating both sides, with the initial condition that $T(0) = T_0$, we get:\n$$\n\\int_{T_0}^{T(t)} \\frac{dT'}{T_f - T'} = \\int_0^t \\frac{G}{C} dt'\n$$\n$$\n[-\\ln|T_f - T'|]_{T_0}^{T(t)} = \\frac{G}{C} t\n$$\n$$\n-\\ln|T_f - T(t)| + \\ln|T_f - T_0| = \\frac{G}{C} t\n$$\nSince the temperature $T(t)$ starts at $T_0$ and approaches $T_f$ from below (as power increases), we have $T_f > T(t) > T_0$. Thus, the absolute value signs can be removed.\n$$\n\\ln\\left(\\frac{T_f - T_0}{T_f - T(t)}\\right) = \\frac{G}{C} t\n$$\nLet's define the thermal time constant $\\tau = C/G$. The equation becomes:\n$$\n\\frac{T_f - T_0}{T_f - T(t)} = \\exp(t/\\tau)\n$$\nSolving for $T(t)$:\n$$\nT_f - T(t) = (T_f - T_0) \\exp(-t/\\tau)\n$$\n$$\nT(t) = T_f - (T_f - T_0) \\exp(-t/\\tau)\n$$\nThis can be rewritten in terms of the initial temperature $T_0 = T(0^{-})$:\n$$\nT(t) = T_0 + (T_f - T_0)(1 - \\exp(-t/\\tau))\n$$\nTo express this in terms of the given parameters, we find the total temperature rise, $T_f - T_0$. Subtracting the initial steady-state equation from the final one:\n$$\n(P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}) - P_{\\mathrm{abs},0} = G(T_f - T_{\\mathrm{s}}) - G(T_0 - T_{\\mathrm{s}})\n$$\n$$\n\\Delta P_{\\mathrm{abs}} = G(T_f - T_0) \\implies T_f - T_0 = \\frac{\\Delta P_{\\mathrm{abs}}}{G}\n$$\nSubstituting this into the expression for $T(t)$, we obtain the transient temperature for $t \\ge 0$ in terms of $T(0^{-})$ and the given parameters, as requested:\n$$\nT(t) = T(0^{-}) + \\frac{\\Delta P_{\\mathrm{abs}}}{G} \\left(1 - \\exp\\left(-\\frac{G}{C}t\\right)\\right)\n$$\n\nNext, we must determine the time $t$ required for $T(t)$ to be within $5\\%$ of its new equilibrium temperature $T_f$. This standardly means the remaining temperature difference $T_f - T(t)$ is $5\\%$ of the total temperature change $T_f - T_0$.\nThe condition is:\n$$\nT_f - T(t) \\le 0.05 \\times (T_f - T_0)\n$$\nFrom our solution $T_f - T(t) = (T_f - T_0) \\exp(-t/\\tau)$, we can substitute this into the condition:\n$$\n(T_f - T_0) \\exp(-t/\\tau) \\le 0.05 (T_f - T_0)\n$$\nSince $\\Delta P_{\\mathrm{abs}} > 0$, it follows that $T_f > T_0$, so we can divide by the positive quantity $(T_f - T_0)$:\n$$\n\\exp(-t/\\tau) \\le 0.05\n$$\nTo find the required time, we solve for the equality:\n$$\n\\exp(-t/\\tau) = 0.05\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\frac{t}{\\tau} = \\ln(0.05)\n$$\n$$\nt = -\\tau \\ln(0.05) = \\tau \\ln\\left(\\frac{1}{0.05}\\right) = \\tau \\ln(20)\n$$\nNow, we calculate the numerical value. First, we find the thermal time constant $\\tau$:\n$$\n\\tau = \\frac{C}{G} = \\frac{10^{-3} \\, \\mathrm{J/K}}{1 \\times 10^{-3} \\, \\mathrm{W/K}} = \\frac{10^{-3} \\, \\mathrm{J/K}}{10^{-3} \\, \\mathrm{J/(s \\cdot K)}} = 1 \\, \\mathrm{s}\n$$\nThe time $t$ is therefore:\n$$\nt = (1 \\, \\mathrm{s}) \\times \\ln(20) \\approx 2.995732 \\, \\mathrm{s}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nt \\approx 2.996 \\, \\mathrm{s}\n$$", "answer": "$$\n\\boxed{2.996}\n$$", "id": "3692180"}, {"introduction": "In a closed vessel, a bolometer does not just see the plasma directly; it also detects radiation that has bounced off the surrounding walls. This \"hall of mirrors\" effect can significantly inflate the measured signal, leading to an overestimation of the radiated power. This practice challenges you to build a model from first principles, using solid-angle geometry and energy conservation, to quantify this systematic error and derive a correction factor, highlighting the critical importance of accounting for the entire experimental environment. [@problem_id:3692237]", "problem": "Consider a closed toroidal vacuum vessel used for nuclear fusion experiments, instrumented with a broadband resistive bolometer to measure the total radiated power from the plasma. The bolometer views the plasma through a conical acceptance defined by the instrumentâ€™s Field of View (FOV), which has a half-angle $\\theta$. Assume the following physically realistic model:\n\n- The plasma emits radiation isotropically within the vessel and there is no re-absorption by the plasma.\n- The inner wall of the vessel is a diffuse (Lambertian) reflector characterized by a spectrally averaged albedo $A$, meaning that a fraction $A$ of incident radiative power is reflected isotropically back into the vessel, while a fraction $1-A$ is absorbed.\n- The bolometer detects any radiation entering its conical FOV, and all rays not entering the FOV either strike the wall or continue propagating until they strike the wall.\n- The vessel is closed, so the only sinks for radiation are wall absorption and bolometer detection.\n\nUsing energy conservation and solid-angle definitions, derive from first principles the multiplicative factor $M$ by which the detected power is increased due to multiple wall reflections, relative to the direct line-of-sight detection (i.e., no reflections counted). Then evaluate $M$ numerically for an albedo $A = 0.72$ and a FOV half-angle $\\theta = 14^\\circ$ (angles must be treated in degrees). Round your final answer for $M$ to four significant figures. Express $M$ as a dimensionless number.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- System: A closed toroidal vacuum vessel for nuclear fusion experiments.\n- Instrumentation: A broadband resistive bolometer.\n- Bolometer Field of View (FOV): A conical acceptance with a half-angle $\\theta$.\n- Plasma Emission: Isotropic radiation, no re-absorption.\n- Vessel Wall Properties: Diffuse (Lambertian) reflector with a spectrally averaged albedo $A$. A fraction $A$ of incident power is reflected isotropically; a fraction $1-A$ is absorbed.\n- Detection Condition: The bolometer detects all radiation entering its FOV. Rays not entering the FOV strike the wall.\n- Energy Sinks: Wall absorption and bolometer detection.\n- Required Derivation: The multiplicative factor $M$ by which the detected power is increased due to multiple wall reflections, relative to direct line-of-sight detection.\n- Numerical Values: $A = 0.72$, $\\theta = 14^\\circ$.\n- Final Answer Requirement: Round the numerical value of $M$ to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a simplified but standard model used in plasma diagnostics for interpreting bolometer measurements in fusion devices like tokamaks. The concepts of isotropic emission, Lambertian reflection, albedo, and solid angle are fundamental and correctly applied. The setup is scientifically realistic.\n- **Well-Posed**: The problem provides a clear physical model with all necessary parameters ($A$, $\\theta$) to derive the requested dimensionless factor $M$. The objective is well-defined, and a unique solution is expected.\n- **Objective**: The problem is stated in precise, technical language, free of subjectivity or ambiguity.\n- **Flaws**:\n    1.  **Scientific Unsoundness**: None. The model is a valid physical approximation.\n    2.  **Non-Formalizable/Irrelevant**: None. The problem is directly formalizable using principles of radiometry and geometry and is highly relevant to its stated field.\n    3.  **Incomplete/Contradictory**: None. The assumption of a closed system with isotropic sources (primary and secondary) makes the solution independent of the specific vessel geometry, thus no information is missing. The conditions are self-consistent.\n    4.  **Unrealistic/Infeasible**: None. The given values for albedo and FOV angle are typical and physically plausible.\n    5.  **Ill-Posed/Poorly Structured**: None. The quantity to be derived is clearly defined.\n    6.  **Pseudo-Profound/Trivial**: None. The problem requires a rigorous derivation involving a geometric series, which represents a standard but non-trivial physics problem.\n    7.  **Outside Scientific Verifiability**: None. The derivation is mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid, well-posed, and scientifically sound. A solution will be derived.\n\n### Solution Derivation\n\nLet $P_{rad}$ be the total power radiated isotropically by the plasma. Let $\\Omega_{bolo}$ be the solid angle subtended by the bolometer's conical field of view (FOV). For a cone with half-angle $\\theta$, this solid angle is given by:\n$$\n\\Omega_{bolo} = 2\\pi(1 - \\cos\\theta)\n$$\nThe total solid angle for isotropic emission is $4\\pi$ steradians. The fraction of the total radiated power that is directly incident on the bolometer, $f_{bolo}$, is the ratio of the bolometer's solid angle to the total solid angle.\n$$\nf_{bolo} = \\frac{\\Omega_{bolo}}{4\\pi} = \\frac{2\\pi(1 - \\cos\\theta)}{4\\pi} = \\frac{1 - \\cos\\theta}{2}\n$$\nThe remaining fraction of the power, $f_{wall}$, is initially incident on the vessel walls. Since the system is closed, the only sinks are the bolometer and the wall.\n$$\nf_{wall} = 1 - f_{bolo} = 1 - \\frac{1 - \\cos\\theta}{2} = \\frac{2 - (1 - \\cos\\theta)}{2} = \\frac{1 + \\cos\\theta}{2}\n$$\nThe total power detected by the bolometer, $P_{bolo}$, is the sum of the power detected directly from the plasma and the power detected after one or more reflections from the wall.\n\n1.  **Directly Detected Power ($P_0$)**: This is the power radiated from the plasma directly into the bolometer's FOV.\n    $$\n    P_0 = P_{rad} f_{bolo}\n    $$\n2.  **Power Detected after One Reflection ($P_1$)**:\n    -   The power initially striking the wall is $P_{rad} f_{wall}$.\n    -   A fraction $A$ of this power is reflected. The total reflected power is $A P_{rad} f_{wall}$.\n    -   Since the reflection is Lambertian (diffuse), this reflected power is radiated isotropically from the wall surface. The bolometer, which covers a fraction $f_{bolo}$ of the total $4\\pi$ solid angle, will detect a fraction $f_{bolo}$ of this reflected power.\n    -   Therefore, the power detected after one reflection is $P_1 = (A P_{rad} f_{wall}) f_{bolo}$.\n\n3.  **Power Detected after Two Reflections ($P_2$)**:\n    -   Of the power reflected in the first instance ($A P_{rad} f_{wall}$), a fraction $f_{wall}$ will strike the wall again.\n    -   This power, $(A P_{rad} f_{wall}) f_{wall}$, is reflected with albedo $A$, resulting in a second reflected power of $A (A P_{rad} f_{wall} f_{wall}) = P_{rad} (A f_{wall})^2$.\n    -   This power is also radiated isotropically, and the bolometer detects a fraction $f_{bolo}$ of it.\n    -   Therefore, the power detected after two reflections is $P_2 = P_{rad} (A f_{wall})^2 f_{bolo}$.\n\n4.  **Total Detected Power ($P_{bolo}$)**: The total detected power is the sum of an infinite geometric series:\n    $$\n    P_{bolo} = P_0 + P_1 + P_2 + \\dots = P_{rad} f_{bolo} + P_{rad} f_{bolo} (A f_{wall}) + P_{rad} f_{bolo} (A f_{wall})^2 + \\dots\n    $$\n    $$\n    P_{bolo} = P_{rad} f_{bolo} \\sum_{n=0}^{\\infty} (A f_{wall})^n\n    $$\n    The common ratio of this series is $r = A f_{wall}$. Since $0 \\le A < 1$ and $0 < f_{wall} < 1$, the condition $|r|<1$ is met, and the series converges to $\\frac{1}{1-r}$.\n    $$\n    P_{bolo} = P_{rad} f_{bolo} \\left(\\frac{1}{1 - A f_{wall}}\\right)\n    $$\nThe problem defines the multiplicative factor $M$ as the ratio of the total detected power ($P_{bolo}$) to the direct line-of-sight detected power ($P_0$).\n$$\nM = \\frac{P_{bolo}}{P_0} = \\frac{P_{rad} f_{bolo} \\left(\\frac{1}{1 - A f_{wall}}\\right)}{P_{rad} f_{bolo}} = \\frac{1}{1 - A f_{wall}}\n$$\nSubstituting the expression for $f_{wall}$:\n$$\nM = \\frac{1}{1 - A \\left(\\frac{1 + \\cos\\theta}{2}\\right)}\n$$\nThis is the final analytical expression for the multiplicative factor $M$.\n\n### Numerical Evaluation\n\nWe are given $A = 0.72$ and $\\theta = 14^\\circ$. The calculation requires the cosine of the angle in degrees.\n$$\n\\cos(14^\\circ) \\approx 0.970295726\n$$\nNow, substitute the values into the expression for $M$:\n$$\nM = \\frac{1}{1 - 0.72 \\left(\\frac{1 + 0.970295726}{2}\\right)}\n$$\n$$\nM = \\frac{1}{1 - 0.72 \\left(\\frac{1.970295726}{2}\\right)}\n$$\n$$\nM = \\frac{1}{1 - 0.72 \\times 0.985147863}\n$$\n$$\nM = \\frac{1}{1 - 0.709306461}\n$$\n$$\nM = \\frac{1}{0.290693539}\n$$\n$$\nM \\approx 3.4396788\n$$\nRounding the result to four significant figures, we get $3.440$.", "answer": "$$\n\\boxed{3.440}\n$$", "id": "3692237"}, {"introduction": "While essential for global power balance, the true power of a bolometer array lies in its ability to create spatial maps of plasma emissivity through tomographic inversion. This process is a classic inverse problem, and its solutions are never perfect. This advanced practice introduces the concept of the resolution matrix, a powerful diagnostic tool that quantifies the spatial blurring inherent in the reconstruction, allowing you to critically assess the \"sharpness\" and reliability of the resulting plasma radiation images. [@problem_id:3692195]", "problem": "You are given a one-dimensional discretized model of bolometric line-integration for total radiated power in a nuclear fusion plasma. The measurement model is that each bolometer channel records a line-integrated signal that is the path integral of the local emissivity along its line-of-sight. In a one-dimensional slab representation with spatial coordinate $x \\in [0,X]$, the continuous forward model is $s_k = \\int_{0}^{X} S_k(x)\\,\\varepsilon(x)\\,dx$ for channel index $k$, where $S_k(x)$ is the instrument sensitivity along the chord (treated here as a known function) and $\\varepsilon(x)$ is the volumetric emissivity. Discretize the domain $[0,X]$ into $N$ non-overlapping uniform voxels with centers $\\{x_i\\}_{i=1}^{N}$ and width $\\Delta x = X/N$, approximate $\\varepsilon(x)$ as piecewise constant over voxels, and form the discrete linear system $\\mathbf{s} = \\mathbf{A}\\,\\boldsymbol{\\varepsilon}$, where $\\mathbf{A} \\in \\mathbb{R}^{M \\times N}$ is the geometry/sensitivity matrix constructed from the voxel-averaged chord sensitivities and $\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^N$ is the vector of emissivity values. Consider the Tikhonov-regularized least squares estimator that minimizes $\\|\\mathbf{A}\\boldsymbol{\\varepsilon} - \\mathbf{s}\\|_2^2 + \\lambda \\| \\mathbf{L}\\boldsymbol{\\varepsilon} \\|_2^2$, where $\\lambda>0$ is the regularization parameter and $\\mathbf{L} \\in \\mathbb{R}^{(N-1)\\times N}$ is the first-difference operator enforcing smoothness.\n\nFrom first principles, construct the resolution matrix $\\mathbf{R} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1}\\,\\mathbf{A}^\\top \\mathbf{A}$, which maps the true discretized emissivity $\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$ to the reconstructed emissivity $\\widehat{\\boldsymbol{\\varepsilon}}$ via $\\widehat{\\boldsymbol{\\varepsilon}} = \\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$ when fitting in the absence of measurement noise. Interpret the spatial spread of the resolution matrix as follows: for each voxel index $j \\in \\{1,\\dots,N\\}$, consider the $j$-th column of $\\mathbf{R}$, denoted $\\mathbf{r}^{(j)} \\in \\mathbb{R}^{N}$. Define nonnegative, normalized weights by $w_i^{(j)} = \\max(r^{(j)}_i,0)\\big/\\sum_{\\ell=1}^{N}\\max(r^{(j)}_\\ell,0)$, and define the spatial resolution length for voxel $j$ as the root-mean-square spread around its center,\n$$\n\\ell_j = \\sqrt{\\sum_{i=1}^{N} \\big(x_i - x_j\\big)^2\\, w_i^{(j)}} \\quad \\text{in meters}.\n$$\nFinally, summarize the spatial resolution for a given configuration by the average resolution length,\n$$\n\\overline{\\ell} = \\frac{1}{N}\\sum_{j=1}^{N} \\ell_j \\quad \\text{in meters}.\n$$\n\nUse the following fundamental base to derive and implement the computation:\n- The linear forward model for line-integrated measurements $s_k = \\int_{0}^{X} S_k(x)\\,\\varepsilon(x)\\,dx$, its discretization $\\mathbf{s} = \\mathbf{A}\\,\\boldsymbol{\\varepsilon}$ with voxel-averaged chord sensitivities,\n- The Tikhonov-regularized least squares estimator minimizing $\\|\\mathbf{A}\\boldsymbol{\\varepsilon} - \\mathbf{s}\\|_2^2 + \\lambda \\| \\mathbf{L}\\boldsymbol{\\varepsilon} \\|_2^2$,\n- The definition of the resolution matrix $\\mathbf{R}$ and its interpretation as the mapping $\\widehat{\\boldsymbol{\\varepsilon}} = \\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$.\n\nIn this problem, for each channel $k \\in \\{1,\\dots,M\\}$, let the chord sensitivity be a Gaussian $S_k(x) = \\exp\\!\\big(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\big)$ with center $c_k$ and width $\\sigma_k$, and define the discrete sensitivity matrix entries by voxel-averaging,\n$$\nA_{k,i} = \\frac{1}{\\Delta x}\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx,\n$$\nwhere $x_i$ are voxel center positions uniformly spanning $[0,X]$ and $\\Delta x = X/N$.\n\nDefine the first-difference regularization operator $\\mathbf{L}$ by $(\\mathbf{L}\\boldsymbol{\\varepsilon})_j = \\varepsilon_{j} - \\varepsilon_{j+1}$ for $j \\in \\{1,\\dots,N-1\\}$, that is,\n$$\n\\mathbf{L} =\n\\begin{bmatrix}\n1 & -1 & 0 & \\cdots & 0\\\\\n0 & 1 & -1 & \\cdots & 0\\\\\n\\vdots & & \\ddots & \\ddots & \\vdots\\\\\n0 & \\cdots & 0 & 1 & -1\n\\end{bmatrix} \\in \\mathbb{R}^{(N-1)\\times N}.\n$$\n\nImplement a program to:\n- Construct $\\mathbf{A}$ and $\\mathbf{L}$ for each test case,\n- Compute $\\mathbf{R}$,\n- Compute $\\ell_j$ for all $j$ and then $\\overline{\\ell}$.\n\nYour program must use the test suite below and produce the final outputs with the required format and units. All spatial lengths must be expressed in meters. The final outputs must be rounded to four decimal places.\n\nTest Suite:\n- Case $1$ (happy path, moderately overdetermined, mild regularization): $X=1.0\\,\\mathrm{m}$, $N=8$, $M=12$, $c_k$ uniformly spaced in $[0,1]$ for $k=1,\\dots,M$, $\\sigma_k = 0.15\\,\\mathrm{m}$ for all $k$, $\\lambda = 10^{-3}$.\n- Case $2$ (underdetermined, stronger regularization): $X=1.0\\,\\mathrm{m}$, $N=8$, $M=4$, $c_k \\in \\{0.2, 0.4, 0.6, 0.8\\}\\,\\mathrm{m}$, $\\sigma_k = 0.20\\,\\mathrm{m}$ for all $k$, $\\lambda = 5\\times 10^{-2}$.\n- Case $3$ (oversmoothing, strong regularization): $X=1.0\\,\\mathrm{m}$, $N=8$, $M=12$, $c_k$ uniformly spaced in $[0,1]$ for $k=1,\\dots,M$, $\\sigma_k = 0.15\\,\\mathrm{m}$ for all $k$, $\\lambda = 1.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3]$, where each $r_i$ is the average resolution length $\\overline{\\ell}$ for the corresponding test case, in meters, rounded to four decimal places.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\n- **Domain**: One-dimensional spatial coordinate $x \\in [0,X]$.\n- **Continuous Forward Model**: $s_k = \\int_{0}^{X} S_k(x)\\,\\varepsilon(x)\\,dx$, where $s_k$ is the signal for channel $k$, $S_k(x)$ is the sensitivity function, and $\\varepsilon(x)$ is the emissivity.\n- **Discretization**: The domain $[0,X]$ is discretized into $N$ uniform, non-overlapping voxels. The voxel width is $\\Delta x = X/N$, and the voxel centers are $\\{x_i\\}_{i=1}^{N}$. Emissivity $\\varepsilon(x)$ is assumed to be piecewise constant over each voxel.\n- **Discrete Linear System**: $\\mathbf{s} = \\mathbf{A}\\,\\boldsymbol{\\varepsilon}$, where $\\mathbf{s} \\in \\mathbb{R}^M$ is the measurement vector, $\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^N$ is the discretized emissivity vector, and $\\mathbf{A} \\in \\mathbb{R}^{M \\times N}$ is the geometry/sensitivity matrix.\n- **Tikhonov Regularization**: The emissivity is estimated by minimizing the cost function $\\|\\mathbf{A}\\boldsymbol{\\varepsilon} - \\mathbf{s}\\|_2^2 + \\lambda \\| \\mathbf{L}\\boldsymbol{\\varepsilon} \\|_2^2$, where $\\lambda>0$ is the regularization parameter.\n- **First-Difference Operator**: $\\mathbf{L} \\in \\mathbb{R}^{(N-1)\\times N}$ is defined by $(\\mathbf{L}\\boldsymbol{\\varepsilon})_j = \\varepsilon_{j} - \\varepsilon_{j+1}$ for $j \\in \\{1,\\dots,N-1\\}$.\n- **Resolution Matrix**: Defined as $\\mathbf{R} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1}\\,\\mathbf{A}^\\top \\mathbf{A}$, which maps the true emissivity to the reconstructed one in the absence of noise: $\\widehat{\\boldsymbol{\\varepsilon}} = \\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$.\n- **Spatial Resolution Definition**:\n    - For the $j$-th column of $\\mathbf{R}$, denoted $\\mathbf{r}^{(j)}$, normalized non-negative weights are defined as $w_i^{(j)} = \\max(r^{(j)}_i,0)\\big/\\sum_{\\ell=1}^{N}\\max(r^{(j)}_\\ell,0)$.\n    - The resolution length for voxel $j$ is $\\ell_j = \\sqrt{\\sum_{i=1}^{N} \\big(x_i - x_j\\big)^2\\, w_i^{(j)}}$.\n    - The average resolution length is $\\overline{\\ell} = \\frac{1}{N}\\sum_{j=1}^{N} \\ell_j$.\n- **Sensitivity Function**: A Gaussian profile, $S_k(x) = \\exp\\!\\big(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\big)$.\n- **Matrix Entry Definition**: $A_{k,i} = \\frac{1}{\\Delta x}\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx$.\n- **Test Cases**:\n    - **Case 1**: $X=1.0\\,\\mathrm{m}$, $N=8$, $M=12$, $c_k$ uniformly spaced in $[0,1]$ for $k=1,\\dots,M$, $\\sigma_k = 0.15\\,\\mathrm{m}$ for all $k$, $\\lambda = 10^{-3}$.\n    - **Case 2**: $X=1.0\\,\\mathrm{m}$, $N=8$, $M=4$, $c_k \\in \\{0.2, 0.4, 0.6, 0.8\\}\\,\\mathrm{m}$, $\\sigma_k = 0.20\\,\\mathrm{m}$ for all $k$, $\\lambda = 5\\times 10^{-2}$.\n    - **Case 3**: $X=1.0\\,\\mathrm{m}$, $N=8$, $M=12$, $c_k$ uniformly spaced in $[0,1]$ for $k=1,\\dots,M$, $\\sigma_k = 0.15\\,\\mathrm{m}$ for all $k$, $\\lambda = 1.0$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is scientifically grounded in the well-established field of inverse problems, specifically tomographic reconstruction with Tikhonov regularization, a standard technique in plasma physics diagnostics. The problem is well-posed; it provides all necessary equations, parameters, and definitions to construct a unique, meaningful solution. The matrix $(\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})$ is invertible for $\\lambda>0$ because the entries of $\\mathbf{A}$ are strictly positive (integrals of a positive function), ensuring that the null space of $\\mathbf{A}$ and the null space of $\\mathbf{L}$ (constant vectors) do not intersect. The problem is objective, formalizable, and computationally verifiable. While phrases like \"uniformly spanning $[0,X]$\" for voxel centers require adopting a standard convention, this does not constitute a critical ambiguity. The standard convention is that the $N$ voxels tile the interval $[0,X]$ contiguously, leading to voxel centers at $x_i = (i-1/2)\\Delta x$ for $i=1,\\dots,N$. This interpretation is sound and consistent.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be developed.\n\n---\n\n### Solution Derivation\n\nThe objective is to calculate the average spatial resolution length, $\\overline{\\ell}$, for three distinct instrument and regularization configurations. The procedure is based on the provided first principles.\n\n**1. Spatial Discretization**\nThe domain $[0,X]$ is discretized into $N$ voxels. The width of each voxel is $\\Delta x = X/N$. To ensure the voxels perfectly tile the domain, we define the center of the $i$-th voxel (using $1$-based indexing for theory and $0$-based for implementation) as $x_i = (i - 1/2)\\Delta x$ for $i=1, \\dots, N$. The $i$-th voxel thus covers the spatial range $[(i-1)\\Delta x, i\\Delta x]$.\n\n**2. Construction of the Sensitivity Matrix $\\mathbf{A}$**\nThe entries $A_{k,i}$ of the sensitivity matrix are given by the voxel-averaged sensitivity function:\n$$\nA_{k,i} = \\frac{1}{\\Delta x}\\int_{(i-1)\\Delta x}^{i\\Delta x} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx\n$$\nThe integral of a Gaussian function is related to the error function, $\\mathrm{erf}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_0^z e^{-t^2} dt$. We can show that $\\int e^{-ax^2}dx = \\sqrt{\\frac{\\pi}{a}}\\frac{1}{2}\\mathrm{erf}(\\sqrt{a}x)$. With a change of variables, the definite integral of our specific Gaussian is:\n$$\n\\int_{a}^{b} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx = \\sigma_k\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{b-c_k}{\\sigma_k\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{a-c_k}{\\sigma_k\\sqrt{2}}\\right) \\right]\n$$\nSubstituting the voxel integration limits $a = (i-1)\\Delta x$ and $b = i\\Delta x$, we get the analytical expression for $A_{k,i}$:\n$$\nA_{k,i} = \\frac{\\sigma_k\\sqrt{\\pi/2}}{\\Delta x} \\left[ \\mathrm{erf}\\left(\\frac{i\\Delta x - c_k}{\\sigma_k\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{(i-1)\\Delta x - c_k}{\\sigma_k\\sqrt{2}}\\right) \\right]\n$$\nThis formula will be used to populate the $M \\times N$ matrix $\\mathbf{A}$.\n\n**3. Construction of the Regularization Operator $\\mathbf{L}$**\nThe first-difference operator $\\mathbf{L}$ is an $(N-1) \\times N$ matrix that computes the difference between adjacent emissivity values. As specified, it has the form:\n$$\n\\mathbf{L} =\n\\begin{bmatrix}\n1 & -1 & 0 & \\cdots & 0 & 0\\\\\n0 & 1 & -1 & \\cdots & 0 & 0\\\\\n\\vdots & & \\ddots & \\ddots & & \\vdots\\\\\n0 & 0 & 0 & \\cdots & 1 & -1\n\\end{bmatrix}\n$$\nThis matrix can be constructed efficiently by creating an identity matrix and subtracting a shifted version of it.\n\n**4. Computation of the Resolution Matrix $\\mathbf{R}$**\nThe resolution matrix $\\mathbf{R}$ describes how the \"true\" discretized emissivity profile $\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$ is smeared or blurred by the inversion process to produce the reconstructed estimate $\\widehat{\\boldsymbol{\\varepsilon}}$. The expression for the Tikhonov-regularized least-squares solution is $\\widehat{\\boldsymbol{\\varepsilon}} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1} \\mathbf{A}^\\top \\mathbf{s}$. Assuming no measurement noise, the measured data would be $\\mathbf{s} = \\mathbf{A}\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$. Substituting this into the solution gives $\\widehat{\\boldsymbol{\\varepsilon}} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1} \\mathbf{A}^\\top (\\mathbf{A}\\boldsymbol{\\varepsilon}_{\\mathrm{true}})$. This directly leads to the definition of the resolution matrix:\n$$\n\\mathbf{R} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1}\\,\\mathbf{A}^\\top \\mathbf{A}\n$$\nThe computation involves matrix multiplication, transposition, and inversion. The matrix $\\mathbf{H} = \\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L}$ is the Hessian of the cost function and is invertible for $\\lambda > 0$.\n\n**5. Calculation of Spatial Resolution Lengths**\nThe resolution length $\\ell_j$ for each voxel $j$ quantifies the spatial spread of its reconstruction. It is calculated based on the $j$-th column of the resolution matrix, $\\mathbf{r}^{(j)}$.\nFirst, non-negative weights are formed by taking the positive part of the column entries and normalizing:\n$$\nw_i^{(j)} = \\frac{\\max(r^{(j)}_i, 0)}{\\sum_{\\ell=1}^{N} \\max(r^{(j)}_\\ell, 0)}\n$$\nThis weighting gives a measure of how much the true emissivity in voxel $i$ contributes to the reconstructed emissivity in voxel $j$.\nNext, the spatial resolution length for voxel $j$ is computed as the root-mean-square spread of the voxel positions $x_i$ around the center $x_j$, using the weights $w_i^{(j)}$:\n$$\n\\ell_j = \\sqrt{\\sum_{i=1}^{N} \\big(x_i - x_j\\big)^2\\, w_i^{(j)}}\n$$\nThis is a measure of the width of the point-spread function associated with voxel $j$.\n\n**6. Averaging**\nFinally, the characteristic spatial resolution for the entire system is taken as the arithmetic mean of the individual voxel resolution lengths:\n$$\n\\overline{\\ell} = \\frac{1}{N}\\sum_{j=1}^{N} \\ell_j\n$$\nThis entire procedure is implemented for each of the three test cases provided.", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the bolometry resolution problem for a given set of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"X\": 1.0, \"N\": 8, \"M\": 12,\n            \"c_k_def\": (\"linspace\", (0.0, 1.0)),\n            \"sigma_k\": 0.15, \"lambda_val\": 1e-3,\n        },\n        {\n            \"X\": 1.0, \"N\": 8, \"M\": 4,\n            \"c_k_def\": (\"array\", [0.2, 0.4, 0.6, 0.8]),\n            \"sigma_k\": 0.20, \"lambda_val\": 5e-2,\n        },\n        {\n            \"X\": 1.0, \"N\": 8, \"M\": 12,\n            \"c_k_def\": (\"linspace\", (0.0, 1.0)),\n            \"sigma_k\": 0.15, \"lambda_val\": 1.0,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        X = case[\"X\"]\n        N = case[\"N\"]\n        M = case[\"M\"]\n        c_k_def = case[\"c_k_def\"]\n        sigma_k_val = case[\"sigma_k\"]\n        lambda_val = case[\"lambda_val\"]\n\n        # 1. Spatial Discretization\n        dx = X / N\n        # Voxel centers x_i at (i+0.5)*dx for i=0..N-1\n        x_coords = (np.arange(N) + 0.5) * dx\n        \n        # Channel centers c_k\n        if c_k_def[0] == \"linspace\":\n            c_k = np.linspace(c_k_def[1][0], c_k_def[1][1], M)\n        else:\n            c_k = np.array(c_k_def[1])\n            \n        sigma_k = np.full(M, sigma_k_val)\n\n        # 2. Construction of the Sensitivity Matrix A\n        A = np.zeros((M, N))\n        for k in range(M):  # Iterate over channels\n            for i in range(N):  # Iterate over voxels\n                # Voxel i spans from i*dx to (i+1)*dx\n                lower_bound = i * dx\n                upper_bound = (i + 1) * dx\n                \n                # Arguments for the error function\n                arg1 = (upper_bound - c_k[k]) / (sigma_k[k] * np.sqrt(2))\n                arg2 = (lower_bound - c_k[k]) / (sigma_k[k] * np.sqrt(2))\n                \n                integral_val = sigma_k[k] * np.sqrt(np.pi / 2.0) * (erf(arg1) - erf(arg2))\n                \n                A[k, i] = integral_val / dx\n\n        # 3. Construction of the Regularization Operator L\n        L = np.zeros((N - 1, N))\n        for j in range(N - 1):\n            L[j, j] = 1.0\n            L[j, j+1] = -1.0\n        \n        # 4. Computation of the Resolution Matrix R\n        AtA = A.T @ A\n        LtL = L.T @ L\n        \n        # Hessian of the cost function\n        H = AtA + lambda_val * LtL\n        \n        # Inverse of Hessian\n        H_inv = np.linalg.inv(H)\n        \n        R = H_inv @ AtA\n\n        # 5. Calculation of Spatial Resolution Lengths\n        ell_j_values = np.zeros(N)\n        for j in range(N):\n            # Get j-th column of R\n            r_j_col = R[:, j]\n            \n            # Form non-negative weights\n            r_j_pos = np.maximum(r_j_col, 0)\n            sum_r_j_pos = np.sum(r_j_pos)\n            \n            if sum_r_j_pos > 0:\n                w_j = r_j_pos / sum_r_j_pos\n            else:\n                # This case is unlikely but would result in undefined resolution.\n                # A resolution of 0 is a safe fallback if all contributions are non-positive.\n                w_j = np.zeros(N)\n\n            # RMS spread around voxel center x_j\n            x_j = x_coords[j]\n            squared_diffs = (x_coords - x_j)**2\n            \n            ell_j = np.sqrt(np.sum(squared_diffs * w_j))\n            ell_j_values[j] = ell_j\n        \n        # 6. Averaging\n        ell_bar = np.mean(ell_j_values)\n        results.append(ell_bar)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.4f}' for r in results)}]\")\n\nsolve()\n```", "id": "3692195"}]}