{"hands_on_practices": [{"introduction": "A cornerstone of plasma spectroscopy is the measurement of ion temperature, $T_i$, through the Doppler broadening of spectral lines. The thermal motion of emitting ions, governed by the Maxwell-Boltzmann distribution, causes shifts in the emitted photon wavelengths, resulting in a broadened line profile. This practice [@problem_id:3712967] guides you through the essential process of translating a measured, broadened spectral line into a quantitative value for $T_i$. You will start from first principles to deconvolve the instrumental broadening from the observed line shape, isolate the intrinsic Doppler width, and thereby deduce the temperature of the impurity ions.", "problem": "A spectrometer is used on a magnetically confined fusion plasma to observe a visible impurity emission line from doubly ionized carbon $\\mathrm{C}^{2+}$ near a central vacuum wavelength $\\lambda_{0} = 465.0\\,\\mathrm{nm}$. The measured line profile is well modeled as the convolution of two independent broadening mechanisms: the instrument response (assumed Gaussian) and the physical Doppler broadening due to the line-of-sight thermal velocity distribution of the emitting ions (assumed Gaussian). The measured Full Width at Half Maximum (FWHM) of the convolved line is $\\Delta\\lambda_{\\mathrm{meas}} = 0.3730\\,\\mathrm{nm}$, and the instrument response FWHM is $\\Delta\\lambda_{\\mathrm{inst}} = 0.1200\\,\\mathrm{nm}$.\n\nStarting from first principles, use the following bases:\n- The one-dimensional Maxwell–Boltzmann velocity distribution $f(v_{z}) \\propto \\exp\\!\\big(-m v_{z}^{2}/(2 k_{B} T)\\big)$ for the line-of-sight component $v_{z}$ of the ion velocity, where $m$ is the ion mass and $T$ is the ion temperature.\n- The nonrelativistic Doppler relation for small shifts $\\Delta\\lambda / \\lambda_{0} \\approx v_{z}/c$, where $c$ is the speed of light in vacuum.\n- The fact that the convolution of two Gaussian functions is Gaussian, with the total variance equal to the sum of the individual variances.\n\nDerive the expression relating the physical Doppler FWHM to the ion temperature, and then compute:\n1. The intrinsic physical Gaussian FWHM $\\Delta\\lambda_{\\mathrm{D}}$ of the line (the Doppler width), by removing the instrument width through the convolution principle.\n2. The corresponding ion temperature $T_{i}$ for the emitting impurity, expressed as the thermal energy $k_{B} T_{i}$ in kilo–electronvolts (keV).\n\nAssume $\\mathrm{C}^{2+}$ has mass $m = 12\\,u$, where $u = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$ is the atomic mass unit, $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$, Boltzmann’s constant $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$, and $1\\,\\mathrm{keV} = 1.602176634 \\times 10^{-16}\\,\\mathrm{J}$. Neglect all other broadening mechanisms (e.g., Zeeman, Stark, pressure) and any macroscopic flows or instrumental non-Gaussianities.\n\nExpress the intrinsic FWHM in nanometers and the ion temperature as $k_{B} T_{i}$ in keV. Round both quantities to four significant figures.", "solution": "The problem is evaluated to be scientifically grounded, well-posed, objective, and internally consistent, thus it is deemed valid. We proceed with the solution.\n\nThe problem requires a two-part calculation: first, to determine the intrinsic Doppler broadening full width at half maximum (FWHM), $\\Delta\\lambda_{\\mathrm{D}}$, of the impurity emission line by deconvolving the instrument broadening; and second, to use this intrinsic width to calculate the ion temperature, $T_{i}$, of the emitting $\\mathrm{C}^{2+}$ ions, expressed as a thermal energy $k_{B}T_{i}$ in kilo–electronvolts.\n\n**Part 1: Determination of the Intrinsic Doppler FWHM, $\\Delta\\lambda_{\\mathrm{D}}$**\n\nThe measured spectral line profile is the convolution of the intrinsic Doppler-broadened profile and the instrument response profile. Both are stated to be Gaussian. A fundamental property of the convolution of two Gaussian functions is that the resulting function is also a Gaussian. If the two initial Gaussian functions have variances $\\sigma_1^2$ and $\\sigma_2^2$, the convolved Gaussian has a variance $\\sigma_{\\mathrm{total}}^2$ that is the sum of the individual variances:\n$$ \\sigma_{\\mathrm{total}}^2 = \\sigma_1^2 + \\sigma_2^2 $$\nIn this problem, the measured profile corresponds to the total convolved profile, the intrinsic Doppler profile is one component, and the instrument response is the other. Let $\\sigma_{\\text{meas}}$, $\\sigma_{\\mathrm{D}}$, and $\\sigma_{\\text{inst}}$ be the standard deviations in wavelength corresponding to the measured, Doppler, and instrumental profiles, respectively. The relationship is:\n$$ \\sigma_{\\mathrm{meas}}^2 = \\sigma_{\\mathrm{D}}^2 + \\sigma_{\\text{inst}}^2 $$\nFor any Gaussian distribution, the FWHM, denoted by $\\Delta\\lambda$, is related to its standard deviation $\\sigma$ by a constant factor:\n$$ \\Delta\\lambda = 2\\sqrt{2\\ln 2} \\cdot \\sigma $$\nFrom this, we can express the variance $\\sigma^2$ in terms of the FWHM $\\Delta\\lambda$:\n$$ \\sigma^2 = \\frac{(\\Delta\\lambda)^2}{(2\\sqrt{2\\ln 2})^2} = \\frac{(\\Delta\\lambda)^2}{8\\ln 2} $$\nSubstituting this relationship back into the variance addition formula, we find:\n$$ \\frac{(\\Delta\\lambda_{\\mathrm{meas}})^2}{8\\ln 2} = \\frac{(\\Delta\\lambda_{\\mathrm{D}})^2}{8\\ln 2} + \\frac{(\\Delta\\lambda_{\\mathrm{inst}})^2}{8\\ln 2} $$\nThe constant factor $8\\ln 2$ cancels, yielding a simple quadratic relationship for the FWHMs:\n$$ (\\Delta\\lambda_{\\mathrm{meas}})^2 = (\\Delta\\lambda_{\\mathrm{D}})^2 + (\\Delta\\lambda_{\\mathrm{inst}})^2 $$\nWe can now solve for the intrinsic Doppler FWHM, $\\Delta\\lambda_{\\mathrm{D}}$:\n$$ \\Delta\\lambda_{\\mathrm{D}} = \\sqrt{(\\Delta\\lambda_{\\mathrm{meas}})^2 - (\\Delta\\lambda_{\\mathrm{inst}})^2} $$\nUsing the given values $\\Delta\\lambda_{\\mathrm{meas}} = 0.3730\\,\\mathrm{nm}$ and $\\Delta\\lambda_{\\mathrm{inst}} = 0.1200\\,\\mathrm{nm}$:\n$$ \\Delta\\lambda_{\\mathrm{D}} = \\sqrt{(0.3730\\,\\mathrm{nm})^2 - (0.1200\\,\\mathrm{nm})^2} $$\n$$ \\Delta\\lambda_{\\mathrm{D}} = \\sqrt{0.139129\\,\\mathrm{nm}^2 - 0.014400\\,\\mathrm{nm}^2} = \\sqrt{0.124729\\,\\mathrm{nm}^2} $$\n$$ \\Delta\\lambda_{\\mathrm{D}} \\approx 0.353170\\,\\mathrm{nm} $$\nRounding to four significant figures as requested, the intrinsic physical Gaussian FWHM is $\\Delta\\lambda_{\\mathrm{D}} = 0.3532\\,\\mathrm{nm}$.\n\n**Part 2: Derivation of Ion Temperature, $T_{i}$**\n\nThe second part of the problem is to relate this Doppler FWHM, $\\Delta\\lambda_{\\mathrm{D}}$, to the ion temperature, $T_{i}$. We start from the provided one-dimensional Maxwell–Boltzmann velocity distribution for the line-of-sight velocity component, $v_z$, of the ions:\n$$ f(v_z) \\propto \\exp\\left(-\\frac{m v_z^2}{2 k_B T_i}\\right) $$\nThis is a Gaussian distribution in $v_z$ with a mean of $0$ and variance $\\sigma_{v_z}^2 = k_B T_i / m$.\n\nThe nonrelativistic Doppler shift relates the line-of-sight velocity to the observed wavelength shift $\\Delta\\lambda = \\lambda - \\lambda_0$:\n$$ \\frac{\\Delta\\lambda}{\\lambda_0} = \\frac{v_z}{c} \\quad \\implies \\quad v_z = c \\frac{\\Delta\\lambda}{\\lambda_0} = c \\frac{\\lambda - \\lambda_0}{\\lambda_0} $$\nThe intensity profile of the spectral line, $I(\\lambda)$, as a function of wavelength $\\lambda$, is determined by this velocity distribution. By substituting the expression for $v_z$ into the Maxwell-Boltzmann distribution, we get the line shape:\n$$ I(\\lambda) \\propto \\exp\\left(-\\frac{m}{2 k_B T_i} \\left(c \\frac{\\lambda - \\lambda_0}{\\lambda_0}\\right)^2\\right) $$\n$$ I(\\lambda) \\propto \\exp\\left(-\\frac{m c^2}{2 k_B T_i \\lambda_0^2} (\\lambda - \\lambda_0)^2\\right) $$\nThis is a Gaussian function in $\\lambda$ of the form $\\exp(-(\\lambda - \\lambda_0)^2 / (2\\sigma_\\lambda^2))$, where $\\sigma_\\lambda$ is the standard deviation of the wavelength distribution. By comparing the exponents, we identify the variance $\\sigma_\\lambda^2$:\n$$ \\frac{1}{2\\sigma_\\lambda^2} = \\frac{m c^2}{2 k_B T_i \\lambda_0^2} \\quad \\implies \\quad \\sigma_\\lambda^2 = \\frac{k_B T_i \\lambda_0^2}{m c^2} $$\nNext, we relate this variance to the Doppler FWHM, $\\Delta\\lambda_{\\mathrm{D}}$. Using the standard FWHM formula for a Gaussian:\n$$ \\Delta\\lambda_{\\mathrm{D}} = 2\\sqrt{2\\ln 2} \\cdot \\sigma_\\lambda $$\nSquaring both sides and substituting the expression for $\\sigma_\\lambda^2$:\n$$ (\\Delta\\lambda_{\\mathrm{D}})^2 = (8\\ln 2) \\sigma_\\lambda^2 = (8\\ln 2) \\left(\\frac{k_B T_i \\lambda_0^2}{m c^2}\\right) $$\nThis equation provides the desired relationship between the Doppler FWHM and the ion temperature. We now solve for the thermal energy, $k_{B}T_{i}$:\n$$ k_B T_i = \\frac{m c^2}{8\\ln 2} \\left(\\frac{\\Delta\\lambda_{\\mathrm{D}}}{\\lambda_0}\\right)^2 $$\nWe can now substitute the numerical values to compute $k_B T_i$.\nThe mass of a $\\mathrm{C}^{2+}$ ion is given as $m = 12\\,u$:\n$$ m = 12 \\times (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) = 1.99264687992 \\times 10^{-26}\\,\\mathrm{kg} $$\nOther given values are:\n- $\\Delta\\lambda_{\\mathrm{D}} = 0.353170 \\times 10^{-9}\\,\\mathrm{m}$ (using the unrounded value for precision)\n- $\\lambda_0 = 465.0 \\times 10^{-9}\\,\\mathrm{m}$\n- $c = 2.99792458 \\times 10^8\\,\\mathrm{m/s}$\nPlugging these values into the expression for $k_B T_i$:\n$$ k_B T_i = \\frac{(1.992646... \\times 10^{-26}\\,\\mathrm{kg}) (2.99792458 \\times 10^8\\,\\mathrm{m/s})^2}{8\\ln 2} \\left(\\frac{0.353170 \\times 10^{-9}\\,\\mathrm{m}}{465.0 \\times 10^{-9}\\,\\mathrm{m}}\\right)^2 $$\n$$ k_B T_i \\approx \\frac{(1.79086 \\times 10^{-9}\\,\\mathrm{J})}{5.545177} \\left(7.59505 \\times 10^{-4}\\right)^2 $$\n$$ k_B T_i \\approx (3.22956 \\times 10^{-10}\\,\\mathrm{J}) (5.76848 \\times 10^{-7}) \\approx 1.86303 \\times 10^{-16}\\,\\mathrm{J} $$\nThe problem requires the answer in kilo–electronvolts (keV). Using the conversion factor $1\\,\\mathrm{keV} = 1.602176634 \\times 10^{-16}\\,\\mathrm{J}$:\n$$ k_B T_i (\\text{in keV}) = \\frac{1.86303 \\times 10^{-16}\\,\\mathrm{J}}{1.602176634 \\times 10^{-16}\\,\\mathrm{J/keV}} \\approx 1.16281\\,\\mathrm{keV} $$\nRounding to four significant figures, the ion thermal energy is $k_B T_i = 1.163\\,\\mathrm{keV}$.\n\nFinal results are:\n1. The intrinsic Doppler FWHM is $\\Delta\\lambda_{\\mathrm{D}} = 0.3532\\,\\mathrm{nm}$.\n2. The ion thermal energy is $k_{B}T_{i} = 1.163\\,\\mathrm{keV}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3532 & 1.163\n\\end{pmatrix}\n}\n$$", "id": "3712967"}, {"introduction": "While the width of a spectral line reveals temperature, its intensity, or brightness, provides information about the density of the emitting species and the local plasma environment. The emissivity of a transition is determined by the population of the upper atomic level, which is itself governed by a complex balance of collisional and radiative processes. This exercise [@problem_id:3712972] delves into this relationship using a simplified two-level Collisional-Radiative model, allowing you to calculate the population of an excited state and predict the volumetric emissivity of a line based on electron density, temperature, and fundamental atomic rates.", "problem": "Consider a trace impurity ion in a magnetically confined fusion plasma described by the Collisional-Radiative (CR) model. Assume a two-level system for a single ionization stage of carbon (triply ionized carbon, C III), with a lower level labeled $1$ and an upper level labeled $2$. The electron population is Maxwellian. The plasma is optically thin, and stimulated emission, cascades from higher levels, ionization and recombination are neglected for the two-level subsystem so that the upper level $2$ is populated only by electron-impact excitation from level $1$ and depopulated by electron-impact de-excitation to level $1$ and spontaneous radiative decay to level $1$.\n\nYou are given:\n- Electron density $n_e = 3.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$.\n- Electron temperature $T_e = 20\\,\\mathrm{eV}$.\n- Total number density of the considered ionization stage (sum over levels $1$ and $2$) $N = n_1 + n_2 = 2.0 \\times 10^{16}\\,\\mathrm{m}^{-3}$.\n- Degeneracies $g_1 = 1$ and $g_2 = 3$.\n- Upper-to-lower transition energy $\\Delta E = E_2 - E_1 = 3.0\\,\\mathrm{eV}$ (so the emitted photon energy is $h\\nu = \\Delta E$).\n- Einstein spontaneous emission coefficient $A_{21} = 1.0 \\times 10^{8}\\,\\mathrm{s}^{-1}$.\n- Electron-impact excitation rate coefficient from level $1$ to level $2$ at the given electron temperature $C_{12}(T_e) = 2.0 \\times 10^{-8}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$.\n\nUse the principle of detailed balance for Maxwellian electrons to relate the de-excitation rate coefficient $C_{21}(T_e)$ to $C_{12}(T_e)$, the degeneracies, and $T_e$. Then, using steady-state for the level populations, compute the upper-level population $n_2$ and predict the volumetric emissivity (power per unit volume) of the $2 \\rightarrow 1$ transition,\n$$\n\\varepsilon = n_2\\,A_{21}\\,h\\nu\n$$,\nexpressed in $\\mathrm{W}\\,\\mathrm{m}^{-3}$. Take the electron-volt to Joule conversion $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$.\n\nRound your final numerical answer for $\\varepsilon$ to four significant figures, and express it in $\\mathrm{W}\\,\\mathrm{m}^{-3}$. Report only the emissivity as your final answer.", "solution": "The problem is evaluated as scientifically grounded, well-posed, and objective. It is based on the standard Collisional-Radiative model for atomic level populations in a plasma, a fundamental tool in plasma spectroscopy. All necessary data are provided, and the requested calculation is straightforward. The problem is therefore deemed valid.\n\nThe solution proceeds in three main steps:\n1.  Determine the electron-impact de-excitation rate coefficient $C_{21}(T_e)$ from the excitation rate coefficient $C_{12}(T_e)$ using the principle of detailed balance.\n2.  Establish the steady-state rate balance equation for the upper level population, $n_2$, and solve for $n_2$ in terms of the given parameters.\n3.  Calculate the volumetric emissivity, $\\varepsilon$, using the formula provided.\n\n**Step 1: Detailed Balance**\n\nFor a system in thermodynamic equilibrium with a Maxwellian electron distribution at temperature $T_e$, the rates of a process and its reverse must be equal. For electron-impact excitation (rate $n_1 n_e C_{12}$) and de-excitation (rate $n_2 n_e C_{21}$), this requires:\n$$n_1^{\\text{eq}} n_e C_{12}(T_e) = n_2^{\\text{eq}} n_e C_{21}(T_e)$$\nwhere $n_1^{\\text{eq}}$ and $n_2^{\\text{eq}}$ are the population densities in thermodynamic equilibrium, related by the Boltzmann distribution:\n$$\\frac{n_2^{\\text{eq}}}{n_1^{\\text{eq}}} = \\frac{g_2}{g_1} \\exp\\left(-\\frac{\\Delta E}{k_B T_e}\\right)$$\nHere, $g_1$ and $g_2$ are the statistical weights (degeneracies) of the lower and upper levels, respectively, $\\Delta E = E_2 - E_1$ is the energy difference between the levels, and $k_B$ is the Boltzmann constant.\n\nCombining these two equations gives the principle of detailed balance for the rate coefficients:\n$$C_{12}(T_e) = \\frac{g_2}{g_1} C_{21}(T_e) \\exp\\left(-\\frac{\\Delta E}{k_B T_e}\\right)$$\nWe can rearrange this to find the de-excitation rate coefficient $C_{21}(T_e)$:\n$$C_{21}(T_e) = \\frac{g_1}{g_2} C_{12}(T_e) \\exp\\left(\\frac{\\Delta E}{k_B T_e}\\right)$$\nSince $\\Delta E$ and $T_e$ are both given in units of electron-volts ($\\mathrm{eV}$), the ratio $\\Delta E/(k_B T_e)$ can be computed directly as the ratio of their numerical values, effectively treating $k_B$ as $1$ in these units.\n\n**Step 2: Steady-State Level Population**\n\nThe problem states that in steady-state ($\\frac{dn_2}{dt} = 0$), the population of the upper level ($2$) is balanced by electron-impact excitation from level $1$ and depopulation by electron-impact de-excitation to level $1$ and spontaneous radiative decay to level $1$. The rate balance equation is:\n$$(\\text{Population Rate}) = (\\text{Depopulation Rate})$$\n$$n_1 n_e C_{12}(T_e) = n_2 n_e C_{21}(T_e) + n_2 A_{21}$$\nwhere $A_{21}$ is the Einstein coefficient for spontaneous emission.\n\nWe are given the total number density of the ion, $N = n_1 + n_2$. We can express $n_1$ as $n_1 = N - n_2$ and substitute this into the rate equation:\n$$(N - n_2) n_e C_{12}(T_e) = n_2 (n_e C_{21}(T_e) + A_{21})$$\nNow, we solve for $n_2$:\n$$N n_e C_{12} - n_2 n_e C_{12} = n_2 (n_e C_{21} + A_{21})$$\n$$N n_e C_{12} = n_2 (n_e C_{12} + n_e C_{21} + A_{21})$$\n$$n_2 = \\frac{N n_e C_{12}(T_e)}{n_e (C_{12}(T_e) + C_{21}(T_e)) + A_{21}}$$\nSubstituting the expression for $C_{21}$ from Step 1 gives:\n$$n_2 = \\frac{N n_e C_{12}(T_e)}{n_e C_{12}(T_e) \\left(1 + \\frac{g_1}{g_2} \\exp\\left(\\frac{\\Delta E}{k_B T_e}\\right)\\right) + A_{21}}$$\n\n**Step 3: Volumetric Emissivity**\n\nThe volumetric emissivity, $\\varepsilon$, is the power radiated per unit volume. For the $2 \\rightarrow 1$ transition, it is given by the product of the upper level population density $n_2$, the spontaneous emission rate $A_{21}$, and the energy of each emitted photon, $h\\nu = \\Delta E$:\n$$\\varepsilon = n_2 A_{21} \\Delta E$$\nTo obtain the emissivity in units of $\\mathrm{W}\\,\\mathrm{m}^{-3}$, the photon energy $\\Delta E$ must be converted from electron-volts to Joules.\n\n**Numerical Calculation**\n\nWe are given the following values:\n- $n_e = 3.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n- $T_e = 20\\,\\mathrm{eV}$\n- $N = 2.0 \\times 10^{16}\\,\\mathrm{m}^{-3}$\n- $g_1 = 1$, $g_2 = 3$\n- $\\Delta E = 3.0\\,\\mathrm{eV}$\n- $A_{21} = 1.0 \\times 10^{8}\\,\\mathrm{s}^{-1}$\n- $C_{12}(T_e) = 2.0 \\times 10^{-8}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$\n- $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$\n\nFirst, calculate the exponential term's argument:\n$$\\frac{\\Delta E}{k_B T_e} = \\frac{3.0\\,\\mathrm{eV}}{20\\,\\mathrm{eV}} = 0.15$$\nNext, calculate the de-excitation rate coefficient $C_{21}(T_e)$:\n$$C_{21}(T_e) = \\frac{1}{3} (2.0 \\times 10^{-8}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}) \\exp(0.15)$$\n$$C_{21}(T_e) \\approx (\\frac{2}{3} \\times 10^{-8}) \\times 1.1618342 = 7.745561 \\times 10^{-9}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$$\nNow, we calculate the terms in the expression for $n_2$:\nNumerator:\n$$N n_e C_{12} = (2.0 \\times 10^{16}\\,\\mathrm{m}^{-3})(3.0 \\times 10^{19}\\,\\mathrm{m}^{-3})(2.0 \\times 10^{-8}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}) = 1.2 \\times 10^{28}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$$\nDenominator:\n$$n_e(C_{12} + C_{21}) + A_{21} = (3.0 \\times 10^{19})(2.0 \\times 10^{-8} + 7.745561 \\times 10^{-9}) + 1.0 \\times 10^{8}$$\n$$= (3.0 \\times 10^{19})(2.7745561 \\times 10^{-8}) + 1.0 \\times 10^{8}$$\n$$= 8.3236683 \\times 10^{11} + 1.0 \\times 10^{8} = 8.3246683 \\times 10^{11}\\,\\mathrm{s}^{-1}$$\nCalculate $n_2$:\n$$n_2 = \\frac{1.2 \\times 10^{28}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}}{8.3246683 \\times 10^{11}\\,\\mathrm{s}^{-1}} \\approx 1.441490 \\times 10^{16}\\,\\mathrm{m}^{-3}$$\nFinally, calculate the emissivity $\\varepsilon$. First, convert $\\Delta E$ to Joules:\n$$\\Delta E = 3.0\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 4.806529902 \\times 10^{-19}\\,\\mathrm{J}$$\n$$\\varepsilon = n_2 A_{21} \\Delta E = (1.441490 \\times 10^{16}\\,\\mathrm{m}^{-3})(1.0 \\times 10^{8}\\,\\mathrm{s}^{-1})(4.806529902 \\times 10^{-19}\\,\\mathrm{J})$$\n$$\\varepsilon \\approx 6.92823 \\times 10^{5}\\,\\mathrm{W}\\,\\mathrm{m}^{-3}$$\nRounding to four significant figures as requested, we get:\n$$\\varepsilon \\approx 6.928 \\times 10^{5}\\,\\mathrm{W}\\,\\mathrm{m}^{-3}$$", "answer": "$$\\boxed{6.928 \\times 10^{5}}$$", "id": "3712972"}, {"introduction": "Real-world spectroscopic analysis rarely involves a single, isolated line. Instead, an experimentalist is often faced with a complex spectrum containing multiple peaks from various unknown impurities. This advanced practice [@problem_id:3712950] challenges you to synthesize the principles of line broadening and intensity with other effects, such as Zeeman splitting, to build a computational tool for impurity identification. By creating a scoring algorithm that compares observed spectral features to a catalog of potential ions, you will develop a practical understanding of how multiple physical constraints are combined to solve the inverse problem of identifying the contents of a high-temperature plasma.", "problem": "You are given a catalog of candidate impurity ions and a set of observed spectral peaks from photon spectroscopy in a magnetized fusion plasma. Your task is to construct a program that, for each observation set, identifies the most likely impurity ion by matching observed peaks to the catalog using wavelength tolerances, line strengths, and predicted Zeeman or Stark patterns, while incorporating line broadening due to ion temperature. The program must implement a matching procedure derived from first principles of spectroscopy and statistical mechanics, starting from foundational physical laws, and must not assume any shortcut formulas that are not derived from these.\n\nYou must treat each candidate ion as a hypothesis and compute a score for how well the ion explains the observed peaks. The hypothesis with the highest score above a specified threshold is selected; otherwise, report no match.\n\nFundamental base to be used in your derivation and implementation:\n- Maxwell–Boltzmann statistics for particle velocities and the Doppler effect along the line of sight.\n- Gaussian convolution properties for independent broadening mechanisms.\n- Magnetic-field-induced spectral line splitting (Zeeman effect) and coarse-grained modeling of electric-field-induced patterns (Stark effect) as catalog-predicted patterns.\n- Conservation of energy and photon frequency-wavelength relations to connect frequency shifts and wavelength shifts.\n- Standard physical constants: electron charge $e$, electron mass $m_e$, atomic mass unit $m_u$, Boltzmann constant $k_B$, and speed of light $c$.\n\nCatalog definition (ion identifiers are integers to ensure machine-verifiable outputs):\n- Ion $0$ (mass number $12$):\n  - Base line at $\\lambda_0 = 465.0\\,\\mathrm{nm}$ with strength $0.6$, pattern: Zeeman triplet with effective Landé factor $g_\\mathrm{eff} = 1.0$.\n  - Base line at $\\lambda_0 = 529.0\\,\\mathrm{nm}$ with strength $0.4$, pattern: single (no splitting).\n- Ion $1$ (mass number $16$):\n  - Base line at $\\lambda_0 = 465.3\\,\\mathrm{nm}$ with strength $0.5$, pattern: single.\n  - Base line at $\\lambda_0 = 529.5\\,\\mathrm{nm}$ with strength $0.5$, pattern: Zeeman triplet with $g_\\mathrm{eff} = 1.2$.\n- Ion $2$ (mass number $2$):\n  - Base line at $\\lambda_0 = 486.0\\,\\mathrm{nm}$ with strength $0.7$, pattern: Stark multiplet with fixed splitting $\\Delta\\lambda_S = 0.08\\,\\mathrm{nm}$ into three components with equal intensity ratios.\n  - Base line at $\\lambda_0 = 656.3\\,\\mathrm{nm}$ with strength $0.3$, pattern: Stark multiplet with fixed splitting $\\Delta\\lambda_S = 0.12\\,\\mathrm{nm}$ into three components with equal intensity ratios.\n\nAssumptions and model requirements:\n- Observed peaks are provided as a list of triplets $(\\lambda_\\mathrm{obs}, I_\\mathrm{obs}, \\mathrm{FWHM}_\\mathrm{obs})$, where $\\lambda_\\mathrm{obs}$ is the wavelength in $\\mathrm{nm}$, $I_\\mathrm{obs}$ is a nonnegative relative intensity, and $\\mathrm{FWHM}_\\mathrm{obs}$ is the full width at half maximum in $\\mathrm{nm}$. Within each observation set, intensities must be treated as normalized so that their sum is $1.0$; if not, your program must normalize them internally.\n- Instrumental broadening is Gaussian with a specified $\\mathrm{FWHM}_\\mathrm{instr}$ in $\\mathrm{nm}$, known for each observation set.\n- For each candidate ion hypothesis with mass $M = A\\,m_u$ (where $A$ is the mass number), estimate the ion temperature $T_i$ in Kelvin from the observed widths by inverting the Doppler broadening relation for each observed line (after deconvolving instrumental width in quadrature) and taking a robust central estimate (use the median over observed lines). Use this $T_i$ to predict Doppler widths for all catalog lines of that ion.\n- Patterns:\n  - Zeeman triplet: a central component at $\\lambda_0$ (the $\\pi$ component) and two symmetrically shifted components (the $\\sigma^\\pm$ components) at $\\lambda_0 \\pm \\Delta\\lambda_Z$ with intensity ratios $[1,2,1]$ before normalization. The magnetic splitting magnitude $\\Delta\\lambda_Z$ must be derived from first principles based on magnetic field $B$ (in $\\mathrm{T}$), electron charge $e$, electron mass $m_e$, speed of light $c$, the base wavelength $\\lambda_0$, and $g_\\mathrm{eff}$. You must determine the correct relation between frequency splitting and wavelength splitting. The observation angle is not provided, so assume an unpolarized collection yielding the $[1,2,1]$ ratio model.\n  - Stark multiplet: use the catalog-specified splitting $\\Delta\\lambda_S$ and three components at $\\lambda_0$ and $\\lambda_0 \\pm \\Delta\\lambda_S$ with equal intensities.\n  - Resolution rule: If a pattern’s splitting is small compared to the predicted total Gaussian standard deviation $\\sigma_\\lambda$ for that line, treat the pattern as unresolved and collapse it into a single component at $\\lambda_0$ with the base line’s total strength. Specifically, if the splitting magnitude $\\Delta\\lambda$ satisfies $\\Delta\\lambda \\le \\epsilon\\,\\sigma_\\lambda$ with $\\epsilon = 0.5$, collapse the pattern; otherwise, keep the components resolved with the specified intensity ratios.\n- For matching predicted components to observed peaks:\n  - Compute the total predicted Gaussian standard deviation in wavelength $\\sigma_\\lambda$ by convolving in quadrature the Doppler width and the instrumental width (convert $\\mathrm{FWHM}$ to $\\sigma$ using the Gaussian relation).\n  - Define a wavelength tolerance $\\tau = K\\,\\sigma_\\lambda$ with $K = 3.0$. A predicted component may be matched to at most one observed peak whose $|\\lambda_\\mathrm{obs} - \\lambda_\\mathrm{pred}| \\le \\tau$. Use a greedy assignment: process predicted components in descending order of predicted strength and, for each, choose the available observed peak that maximizes the wavelength Gaussian factor.\n  - Let $s_\\mathrm{pred}$ denote the predicted component’s fractional strength (normalized over all predicted components of the ion), $I_\\mathrm{obs}$ the matched observed peak’s normalized intensity, $\\sigma_\\lambda$ the predicted total standard deviation, and $\\sigma_\\mathrm{obs}$ the observed standard deviation. Define:\n    - Wavelength match factor $f_\\lambda = \\exp\\!\\left(-\\dfrac{(\\Delta\\lambda)^2}{2\\,\\sigma_\\lambda^2}\\right)$ with $\\Delta\\lambda = \\lambda_\\mathrm{obs} - \\lambda_\\mathrm{pred}$.\n    - Intensity match factor $f_I = \\exp\\!\\left(-\\dfrac{|I_\\mathrm{obs} - s_\\mathrm{pred}|}{\\alpha}\\right)$ with $\\alpha = 0.25$.\n    - Width match factor $f_W = \\exp\\!\\left(-\\dfrac{|\\sigma_\\mathrm{obs} - \\sigma_\\lambda|}{\\beta}\\right)$ with $\\beta = 0.05\\,\\mathrm{nm}$.\n  - The total score for a candidate ion is the sum over all matched components of $s_\\mathrm{pred}\\,f_\\lambda\\,f_I\\,f_W$, minus penalties for unmatched items: subtract $p\\,s_\\mathrm{pred}$ for each unmatched predicted component, with $p = 0.25$, and subtract $q\\,I_\\mathrm{obs}$ for each observed peak left unmatched, with $q = 0.15$.\n  - Select the ion whose score is maximal and exceeds the threshold $\\theta = 0.25$. If no ion exceeds the threshold, report no match with the integer $-1$.\n\nConstants for implementation (use these precise values in SI units within your code):\n- Speed of light $c = 299792458\\,\\mathrm{m/s}$.\n- Electron charge $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$.\n- Electron mass $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$.\n- Atomic mass unit $m_u = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n- Boltzmann constant $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$.\n- Gaussian relation between $\\mathrm{FWHM}$ and standard deviation: $\\sigma = \\dfrac{\\mathrm{FWHM}}{2\\sqrt{2\\ln 2}}$.\n\nTest suite:\nProvide a program that processes the following four independent observation sets. For each set, you are given the list of observed peaks $(\\lambda_\\mathrm{obs}\\,\\mathrm{nm}, I_\\mathrm{obs}, \\mathrm{FWHM}_\\mathrm{obs}\\,\\mathrm{nm})$, the instrumental $\\mathrm{FWHM}_\\mathrm{instr}$ in $\\mathrm{nm}$, and the magnetic field $B$ in $\\mathrm{T}$.\n\n- Case $1$ (expected to match ion near $\\lambda_0$ at $465.0\\,\\mathrm{nm}$ and $529.0\\,\\mathrm{nm}$):\n  - Observed peaks:\n    - $(465.01,\\, 0.62,\\, 0.278)$,\n    - $(528.99,\\, 0.38,\\, 0.315)$.\n  - $\\mathrm{FWHM}_\\mathrm{instr} = 0.05$,\n  - $B = 5.0$.\n- Case $2$ (expected to match ion near $\\lambda_0$ at $465.3\\,\\mathrm{nm}$ and $529.5\\,\\mathrm{nm}$):\n  - Observed peaks:\n    - $(465.30,\\, 0.50,\\, 0.310)$,\n    - $(529.52,\\, 0.50,\\, 0.355)$.\n  - $\\mathrm{FWHM}_\\mathrm{instr} = 0.05$,\n  - $B = 3.0$.\n- Case $3$ (hydrogenic impurity-like Stark multiplets around $\\lambda_0 = 486.0\\,\\mathrm{nm}$ and $\\lambda_0 = 656.3\\,\\mathrm{nm}$):\n  - Observed peaks:\n    - $(485.92,\\, 0.2333,\\, 0.193)$,\n    - $(486.00,\\, 0.2333,\\, 0.193)$,\n    - $(486.08,\\, 0.2334,\\, 0.193)$,\n    - $(656.18,\\, 0.1000,\\, 0.258)$,\n    - $(656.30,\\, 0.1000,\\, 0.258)$,\n    - $(656.42,\\, 0.1000,\\, 0.258)$.\n  - $\\mathrm{FWHM}_\\mathrm{instr} = 0.05$,\n  - $B = 2.0$.\n- Case $4$ (no catalog match expected):\n  - Observed peaks:\n    - $(600.00,\\, 1.0,\\, 0.080)$.\n  - $\\mathrm{FWHM}_\\mathrm{instr} = 0.05$,\n  - $B = 4.0$.\n\nUnits and output:\n- All wavelengths must be treated in $\\mathrm{nm}$; magnetic field in $\\mathrm{T}$; full widths at half maximum in $\\mathrm{nm}$; temperature internally in $\\mathrm{K}$ (no temperature is required in the output).\n- Your program should produce a single line of output containing the identified ion identifier for each case as a comma-separated list enclosed in square brackets. Use integer identifiers for ions as defined above, and use $-1$ for no match. For example, an output could look like $[0,1,2,-1]$.\n\nYour program must be a single, complete, runnable script that takes no input and prints exactly one line in the specified format.", "solution": "The user requires a program to identify impurity ions in a fusion plasma from spectroscopic data. The process involves validating a hypothesis for each candidate ion against a set of observed spectral peaks. This validation will be performed by deriving a scoring model from first principles of physics and statistical mechanics, as stipulated. The problem is scientifically sound, well-posed, and provides all necessary information for a complete solution.\n\n### Step 1: Derivation of Physical Models from First Principles\n\nThe core of the problem lies in comparing predicted spectral features to observed ones. This requires models for line broadening and splitting.\n\n**1.1. Doppler Broadening and Ion Temperature ($T_i$)**\n\nIn a plasma at thermal equilibrium, ions move with velocities described by the Maxwell-Boltzmann distribution. The velocity component along the line of sight, $v_x$, follows a Gaussian distribution with probability density $f(v_x) \\propto \\exp(-M v_x^2 / (2 k_B T_i))$, where $M$ is the ion mass, $k_B$ is the Boltzmann constant, and $T_i$ is the ion temperature. The standard deviation of this velocity distribution is $\\sigma_v = \\sqrt{k_B T_i / M}$.\n\nThe first-order Doppler effect relates the observed wavelength shift $\\Delta\\lambda = \\lambda - \\lambda_0$ to the ion's velocity: $\\Delta\\lambda / \\lambda_0 \\approx v_x/c$, where $\\lambda_0$ is the rest-frame wavelength and $c$ is the speed of light. Since the distribution of $v_x$ is Gaussian, the distribution of $\\Delta\\lambda$ is also Gaussian. The standard deviation of the wavelength distribution due to Doppler broadening, $\\sigma_{\\lambda,D}$, is:\n$$\n\\sigma_{\\lambda,D} = \\frac{\\lambda_0}{c} \\sigma_v = \\frac{\\lambda_0}{c} \\sqrt{\\frac{k_B T_i}{M}}\n$$\nThe full width at half maximum (FWHM) of a Gaussian profile is related to its standard deviation $\\sigma$ by $\\mathrm{FWHM} = 2\\sqrt{2\\ln 2}\\,\\sigma$. Thus, the Doppler FWHM is $\\mathrm{FWHM}_D = 2\\sqrt{2\\ln 2}\\,\\sigma_{\\lambda,D}$.\n\nTo estimate $T_i$ from an observed line profile, we must first isolate the Doppler contribution. The observed line width, $\\mathrm{FWHM}_\\mathrm{obs}$, is a convolution of the intrinsic Doppler width $\\mathrm{FWHM}_D$ and the instrumental broadening $\\mathrm{FWHM}_\\mathrm{instr}$. Assuming both are Gaussian, their FWHMs add in quadrature:\n$$\n\\mathrm{FWHM}_\\mathrm{obs}^2 = \\mathrm{FWHM}_D^2 + \\mathrm{FWHM}_\\mathrm{instr}^2\n$$\nFrom this, we find the Doppler width: $\\mathrm{FWHM}_D = \\sqrt{\\mathrm{FWHM}_\\mathrm{obs}^2 - \\mathrm{FWHM}_\\mathrm{instr}^2}$. Note that this requires $\\mathrm{FWHM}_\\mathrm{obs} > \\mathrm{FWHM}_\\mathrm{instr}$. If not, we infer $\\mathrm{FWHM}_D = 0$.\n\nBy rearranging the Doppler broadening formula, we can solve for $T_i$:\n$$\nT_i = M \\left( \\frac{c}{\\lambda_0} \\sigma_{\\lambda,D} \\right)^2 \\frac{1}{k_B} = M \\left( \\frac{c}{\\lambda_0} \\frac{\\mathrm{FWHM}_D}{2\\sqrt{2\\ln 2}} \\right)^2 \\frac{1}{k_B}\n$$\nFor each observed line, we can compute an estimate for $T_i$. A robust central estimate for the plasma's ion temperature is obtained by taking the median of these individual estimates.\n\n**1.2. Zeeman Splitting**\n\nIn a magnetic field $B$, an atomic energy level splits. The energy shift of a sublevel is given by $\\Delta E = g_\\mathrm{eff} \\mu_B B m_J$, where $g_\\mathrm{eff}$ is the effective Landé g-factor and $\\mu_B = e\\hbar/(2m_e)$ is the Bohr magneton. The selection rules for electric dipole transitions allow changes in the magnetic quantum number $\\Delta m_J = 0, \\pm 1$. The frequency shift for the $\\sigma$ components ($\\Delta m_J = \\pm 1$) is:\n$$\n\\Delta\\nu_Z = \\frac{\\Delta E}{h} = \\frac{g_\\mathrm{eff} \\mu_B B}{h} = \\frac{g_\\mathrm{eff} e \\hbar B}{2 m_e h} = \\frac{g_\\mathrm{eff} e B}{4 \\pi m_e}\n$$\nThe relationship between a small frequency shift $\\Delta\\nu$ and the corresponding wavelength shift $\\Delta\\lambda$ around a central wavelength $\\lambda_0$ is derived from $\\lambda = c/\\nu$: $d\\lambda = -c/\\nu^2 d\\nu$, which gives $|\\Delta\\lambda| \\approx (\\lambda_0^2/c)|\\Delta\\nu|$. Therefore, the magnitude of the Zeeman wavelength splitting is:\n$$\n\\Delta\\lambda_Z = \\frac{\\lambda_0^2}{c} \\Delta\\nu_Z = \\frac{\\lambda_0^2}{c} \\left( \\frac{g_\\mathrm{eff} e B}{4 \\pi m_e} \\right)\n$$\nThis results in three components: an unshifted $\\pi$ component at $\\lambda_0$ and two $\\sigma$ components at $\\lambda_0 \\pm \\Delta\\lambda_Z$. The problem specifies pre-normalization intensity ratios of $[1, 2, 1]$, which corresponds to fractional intensities of $1/4$ for $\\lambda_0 - \\Delta\\lambda_Z$, $2/4$ for $\\lambda_0$, and $1/4$ for $\\lambda_0 + \\Delta\\lambda_Z$.\n\n**1.3. Total Predicted Line Shape**\n\nThe total predicted line profile for each component is a Gaussian, resulting from the convolution of the Doppler and instrumental broadening profiles. The standard deviation of the total predicted profile, $\\sigma_\\lambda$, is:\n$$\n\\sigma_\\lambda = \\sqrt{\\sigma_{\\lambda,D}^2 + \\sigma_\\mathrm{instr}^2}\n$$\nwhere $\\sigma_{\\lambda,D}$ is calculated using the estimated median $T_i$, and $\\sigma_\\mathrm{instr} = \\mathrm{FWHM}_\\mathrm{instr} / (2\\sqrt{2\\ln 2})$.\n\n### Step 2: Algorithmic Procedure for Hypothesis Testing\n\nFor each test case, we evaluate every candidate ion from the catalog as a hypothesis.\n\n1.  **Preprocessing:** All input values specified in nanometers ($\\mathrm{nm}$), such as wavelengths and FWHMs, are converted to SI units (meters, $\\mathrm{m}$) to ensure consistency with the physical constants. Observed intensities $I_\\mathrm{obs}$ are normalized to sum to $1.0$.\n\n2.  **Ion Temperature Estimation:** For a given ion hypothesis (mass $M = A m_u$), we estimate $T_i$.\n    -   For each observed peak $(\\lambda_{\\mathrm{obs},i}, I_{\\mathrm{obs},i}, \\mathrm{FWHM}_{\\mathrm{obs},i})$:\n        -   Convert FWHMs to sigmas: $\\sigma_\\mathrm{obs} = \\mathrm{FWHM}_\\mathrm{obs} / (2\\sqrt{2\\ln 2})$ and $\\sigma_\\mathrm{instr} = \\mathrm{FWHM}_\\mathrm{instr} / (2\\sqrt{2\\ln 2})$.\n        -   Deconvolve the instrumental width to find the Doppler width standard deviation: $\\sigma_{D, i} = \\sqrt{\\max(0, \\sigma_{\\mathrm{obs},i}^2 - \\sigma_\\mathrm{instr}^2)}$.\n        -   Calculate a temperature estimate using the inverted Doppler formula: $T_{\\mathrm{est},i} = M (c \\sigma_{D,i} / \\lambda_{\\mathrm{obs},i})^2 / k_B$.\n    -   The final temperature for the hypothesis, $T_i$, is the median of all non-zero $T_{\\mathrm{est},i}$. If all are zero, $T_i = 0$.\n\n3.  **Predicted Spectrum Generation:** Using the estimated $T_i$, we generate the full predicted spectrum for the candidate ion.\n    -   For each base line in the ion's catalog:\n        -   Calculate the predicted Doppler width $\\sigma_{\\lambda,D}$ using $T_i$ and the line's rest-frame wavelength $\\lambda_0$.\n        -   Calculate the total predicted width $\\sigma_\\lambda = \\sqrt{\\sigma_{\\lambda,D}^2 + \\sigma_\\mathrm{instr}^2}$.\n        -   Calculate the splitting magnitude ($\\Delta\\lambda_Z$ for Zeeman, or use given $\\Delta\\lambda_S$ for Stark).\n        -   Apply the resolution rule: if the splitting $\\Delta\\lambda \\le \\epsilon \\sigma_\\lambda$ (with $\\epsilon=0.5$), treat the line as a single unresolved component. Otherwise, generate the multiple components with their respective wavelengths and fractional intensities.\n    -   After generating all components for the ion, their strengths are normalized to sum to $1.0$, yielding the final predicted strengths $s_\\mathrm{pred}$.\n\n4.  **Matching and Scoring:** The predicted components are matched to observed peaks using a greedy algorithm.\n    -   Predicted components are sorted in descending order of strength $s_\\mathrm{pred}$.\n    -   For each predicted component, we search for an available (unmatched) observed peak that maximizes the wavelength match factor $f_\\lambda = \\exp(-(\\Delta\\lambda)^2 / (2\\sigma_\\lambda^2))$, provided the peak is within a tolerance of $\\tau = K \\sigma_\\lambda$ (with $K=3.0$).\n    -   If a match is found, a score contribution is calculated: $s_\\mathrm{pred} \\cdot f_\\lambda \\cdot f_I \\cdot f_W$, where $f_I$ and $f_W$ are the intensity and width match factors, respectively.\n        -   $f_I = \\exp(-|I_\\mathrm{obs} - s_\\mathrm{pred}| / \\alpha)$, with $\\alpha = 0.25$.\n        -   $f_W = \\exp(-|\\sigma_\\mathrm{obs} - \\sigma_\\lambda| / \\beta)$, with $\\beta = 0.05\\,\\mathrm{nm}$.\n    -   After the matching loop, penalties are subtracted from the total score: $p s_\\mathrm{pred}$ for each unmatched predicted component (with $p=0.25$), and $q I_\\mathrm{obs}$ for each unmatched observed peak (with $q=0.15$).\n\n5.  **Final Selection:** The scores for all ion hypotheses are computed. The ion with the highest score is chosen as the best candidate. If this maximum score exceeds a threshold $\\theta = 0.25$, its identifier is reported. Otherwise, no match is found, and $-1$ is reported. This process is repeated for each test case.", "answer": "$$\\boxed{[0,1,2,-1]}$$", "id": "3712950"}]}