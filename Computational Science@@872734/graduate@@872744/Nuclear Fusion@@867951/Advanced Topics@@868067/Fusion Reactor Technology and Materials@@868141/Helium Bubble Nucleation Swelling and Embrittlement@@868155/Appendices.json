{"hands_on_practices": [{"introduction": "Understanding the behavior of helium in fusion materials begins with characterizing the state of individual bubbles. This foundational exercise connects the macroscopic, measurable properties of a helium bubble, such as its internal pressure and temperature, to its microscopic composition. By applying the ideal gas law, you will calculate the critical ratio of helium atoms to vacancies ($n/m$), a key parameter that governs the bubble's stability and the equation of state for helium under extreme confinement [@problem_id:3702315].", "problem": "A plasma-facing tungsten wall in a Deuterium–Tritium (DT) fusion environment accumulates helium and forms nanometric helium bubbles, often described as complexes of $\\text{He}_nV_m$, where $n$ is the number of helium atoms and $m$ is the number of vacancies comprising the cavity. Consider a single, spherical $\\text{He}_nV_m$ bubble embedded in tungsten at mechanical equilibrium with negligible external hydrostatic stress. The bubble interior contains helium at pressure $p$ and temperature $T$. Assume the helium is sufficiently dilute to be treated as an ideal monatomic gas, the bubble volume is approximately the sum of $m$ vacancy volumes, and the bubble’s surface energy induces capillarity consistent with mechanical equilibrium for a sphere.\n\nGiven:\n- Internal bubble pressure $p = 1.20 \\times 10^{9}$ $\\mathrm{Pa}$,\n- Bubble temperature $T = 1200$ $\\mathrm{K}$,\n- Vacancy volume in tungsten $\\Omega_{v} = 1.60 \\times 10^{-29}$ $\\mathrm{m}^{3}$,\n- Boltzmann’s constant $k_{B} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$.\n\nTasks:\n1. Compute the helium number density inside the bubble, defined as the number of helium atoms per unit volume, using $\\mathrm{m}^{-3}$ as the unit. Round this intermediate result to three significant figures.\n2. Using the volume additivity of vacancies at mechanical equilibrium and the definition of the helium number density, derive an analytic expression for the helium atoms per vacancy, $n/m$, for the $\\text{He}_nV_m$ complex and evaluate it numerically with the provided parameters. Express the final value of $n/m$ as a pure number (no units) and round it to three significant figures.\n\nIn your final answer, report only the value of $n/m$.", "solution": "The solution is developed in two parts as requested by the problem statement.\n\nFirst, we compute the helium number density, $\\rho_{He}$, inside the bubble. The problem states that the helium can be treated as an ideal monatomic gas. The ideal gas law relates the pressure $p$, temperature $T$, and number density $\\rho_{He}$ via Boltzmann's constant $k_B$:\n$$p = \\rho_{He} k_B T$$\nSolving for the number density $\\rho_{He}$ yields:\n$$\\rho_{He} = \\frac{p}{k_B T}$$\nWe are given the following values:\n- Internal bubble pressure $p = 1.20 \\times 10^{9}$ $\\mathrm{Pa}$\n- Bubble temperature $T = 1200$ $\\mathrm{K}$\n- Boltzmann’s constant $k_{B} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$\n\nSubstituting these values into the expression for $\\rho_{He}$:\n$$\\rho_{He} = \\frac{1.20 \\times 10^{9}}{(1.380649 \\times 10^{-23}) \\times 1200} \\ \\mathrm{m}^{-3}$$\n$$\\rho_{He} \\approx 7.2428 \\times 10^{28} \\ \\mathrm{m}^{-3}$$\nAs requested for the intermediate result, rounding to three significant figures gives:\n$$\\rho_{He} \\approx 7.24 \\times 10^{28} \\ \\mathrm{m}^{-3}$$\n\nSecond, we derive an analytic expression for the ratio of helium atoms to vacancies, $n/m$, and evaluate it.\nThe number density $\\rho_{He}$ is defined as the number of helium atoms, $n$, per unit volume, $V$:\n$$\\rho_{He} = \\frac{n}{V}$$\nThe problem states that the bubble volume $V$ is approximated as the sum of the volumes of the $m$ vacancies that comprise it. The volume of a single vacancy is given as $\\Omega_v$. Therefore, the total bubble volume is:\n$$V = m \\Omega_v$$\nSubstituting this expression for $V$ into the definition of number density gives:\n$$\\rho_{He} = \\frac{n}{m \\Omega_v}$$\nWe are asked to find the ratio $n/m$. Rearranging the above equation provides the desired analytic expression:\n$$\\frac{n}{m} = \\rho_{He} \\Omega_v$$\nTo evaluate this numerically, we substitute the expression for $\\rho_{He}$ derived from the ideal gas law:\n$$\\frac{n}{m} = \\left(\\frac{p}{k_B T}\\right) \\Omega_v$$\nWe use the given values, including the vacancy volume in tungsten $\\Omega_v = 1.60 \\times 10^{-29}$ $\\mathrm{m}^3$. For higher precision in the final result, we use the unrounded value of $\\rho_{He}$:\n$$\\frac{n}{m} = (7.2428... \\times 10^{28} \\ \\mathrm{m}^{-3}) \\times (1.60 \\times 10^{-29} \\ \\mathrm{m}^{3})$$\n$$\\frac{n}{m} \\approx 1.15885$$\nThe problem requires the final value to be rounded to three significant figures.\n$$\\frac{n}{m} \\approx 1.16$$\nThis ratio is a dimensionless quantity, as expected.", "answer": "$$\\boxed{1.16}$$", "id": "3702315"}, {"introduction": "Building on the static description of a bubble, this practice explores the thermodynamic principles that drive its evolution. You will calculate the reversible work required to compress a bubble, carefully distinguishing between the work done on the gas and the change in the bubble's surface free energy. This problem illuminates the energetic competition between internal pressure, which favors expansion, and surface tension, which favors shrinkage, providing insight into the fundamental stability criteria for nanometer-scale cavities in solids [@problem_id:3702292].", "problem": "A helium bubble embedded in a fusion plasma–irradiated tungsten matrix is modeled as a spherical cavity of radius $r$ containing $N$ helium atoms at temperature $T$. Assume the helium behaves as a classical ideal gas, the bubble remains spherical during compression, and the interface between helium and the tungsten matrix has a constant interfacial energy per unit area $\\gamma$ (independent of $r$). Neglect elastic strain energy of the surrounding solid and any plastic dissipation in the matrix. The bubble is compressed quasistatically from an initial radius $r_1$ to a final radius $r_2$ with $r_2 < r_1$, at constant $N$ and $T$.\n\nStarting from a valid thermodynamic base for this setting—namely, the ideal gas law $pV = N k_B T$, the definitions $V(r) = \\frac{4}{3}\\pi r^3$ and $A(r) = 4\\pi r^2$ for a sphere, and the differential Helmholtz free energy for a system with a surface at fixed $T$ and $N$—derive the minimum reversible work required to perform this compression by explicitly accounting for the pressure–volume work and the change in interfacial (surface) free energy. Then, briefly discuss the thermodynamic conditions under which this work is equal to the change in Helmholtz free energy and when additional work would be required.\n\nExpress your final answer as a single closed-form analytic expression in terms of $N$, $T$, $\\gamma$, $r_1$, $r_2$, $k_B$, and $\\pi$. Do not evaluate numerically and do not round. Express the work in Joules. Your final answer must be a single analytic expression.", "solution": "### Solution Derivation\nThe problem asks for the minimum reversible work, $W_{\\text{rev}}$, required to compress the helium bubble from radius $r_1$ to $r_2$ at constant temperature $T$ and number of atoms $N$. This work can be calculated by integrating the differential work done on the system during a quasistatic process.\n\nThe total differential work, $dW$, done *on* this system is the sum of the work done to compress the gas volume and the work done to change the surface area of the interface.\nThe differential work done on a gas by an external pressure $p$ is $dW_{\\text{volume}} = -p dV$.\nThe differential work done to create a new surface area $dA$ with interfacial energy $\\gamma$ is $dW_{\\text{surface}} = \\gamma dA$.\n\nFor a reversible (quasistatic) process, the system is always in equilibrium. Therefore, the total differential work done on the system is the sum of these two contributions:\n$$dW_{\\text{rev}} = dW_{\\text{volume}} + dW_{\\text{surface}} = -p dV + \\gamma dA$$\nThis expression is equivalent to the change in Helmholtz free energy $dF$ at constant temperature, confirming that the reversible work is equal to $\\Delta F$. We will proceed by direct integration as requested.\n\nTo integrate, we express all variables as a function of a single variable, the radius $r$.\nThe volume is $V(r) = \\frac{4}{3}\\pi r^3$, so its differential is $dV = \\frac{d}{dr}(\\frac{4}{3}\\pi r^3) dr = 4\\pi r^2 dr$.\nThe surface area is $A(r) = 4\\pi r^2$, so its differential is $dA = \\frac{d}{dr}(4\\pi r^2) dr = 8\\pi r dr$.\nThe pressure $p$ of the ideal gas depends on the radius $r$ through the volume:\n$$p(r) = \\frac{N k_B T}{V(r)} = \\frac{N k_B T}{\\frac{4}{3}\\pi r^3} = \\frac{3 N k_B T}{4\\pi r^3}$$\n\nSubstituting these expressions into the differential work equation:\n$$dW_{\\text{rev}} = -\\left(\\frac{3 N k_B T}{4\\pi r^3}\\right) (4\\pi r^2 dr) + \\gamma (8\\pi r dr)$$\nSimplifying the terms within the differential:\n$$dW_{\\text{rev}} = \\left(-\\frac{3 N k_B T}{r} + 8\\pi \\gamma r\\right) dr$$\n\nTo find the total work required for the compression from $r_1$ to $r_2$, we integrate $dW_{\\text{rev}}$ with respect to $r$ over the path from the initial radius $r_1$ to the final radius $r_2$:\n$$W_{\\text{rev}} = \\int_{r_1}^{r_2} \\left(-\\frac{3 N k_B T}{r} + 8\\pi \\gamma r\\right) dr$$\nWe perform the integration term by term:\n$$W_{\\text{rev}} = -3 N k_B T \\int_{r_1}^{r_2} \\frac{1}{r} dr + 8\\pi \\gamma \\int_{r_1}^{r_2} r dr$$\nThe integrals are standard: $\\int \\frac{1}{r} dr = \\ln|r|$ and $\\int r dr = \\frac{r^2}{2}$. Evaluating the definite integrals:\n$$W_{\\text{rev}} = -3 N k_B T \\left[ \\ln(r) \\right]_{r_1}^{r_2} + 8\\pi \\gamma \\left[ \\frac{r^2}{2} \\right]_{r_1}^{r_2}$$\n$$W_{\\text{rev}} = -3 N k_B T (\\ln(r_2) - \\ln(r_1)) + 4\\pi \\gamma (r_2^2 - r_1^2)$$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$, we get:\n$$W_{\\text{rev}} = -3 N k_B T \\ln\\left(\\frac{r_2}{r_1}\\right) + 4\\pi \\gamma (r_2^2 - r_1^2)$$\nTo make the logarithmic term positive for the compression case ($r_1 > r_2$), we can use the property $-\\ln(x) = \\ln(1/x)$:\n$$W_{\\text{rev}} = 3 N k_B T \\ln\\left(\\frac{r_1}{r_2}\\right) + 4\\pi \\gamma (r_2^2 - r_1^2)$$\nThis is the final expression for the minimum reversible work done *on* the system to compress the bubble. The first term is the work required to compress the ideal gas, which is positive since $r_1 > r_2$. The second term is the energy change associated with the surface, which is negative since the surface area decreases ($r_2 < r_1$).\n\n### Discussion\nThe thermodynamic conditions under which this work is equal to the change in Helmholtz free energy are precisely the conditions assumed in the derivation: the process must be **reversible** (or **quasistatic**) and occur at **constant temperature** and **constant number of particles**. In such a process, the system moves through a continuous sequence of equilibrium states, and no energy is lost to dissipative forces. The work done on the system changes its capacity to do work, which at constant $T$ is measured by the Helmholtz free energy, $F$. Thus, for a reversible isothermal process, $W_{\\text{rev}} = \\Delta F$.\n\n**Additional work** would be required if the process is **irreversible**. Any real process occurring at a finite rate will involve dissipative effects (e.g., internal friction in the gas, rapid deformation of the matrix if its viscosity were considered, etc.), which generate entropy. According to the second law of thermodynamics for isothermal processes, the actual work $W_{\\text{actual}}$ done on the system must satisfy the inequality:\n$$W_{\\text{actual}} \\geq \\Delta F$$\nThe equality holds only for the reversible case. For an irreversible process, $W_{\\text{actual}} > \\Delta F = W_{\\text{rev}}$. The additional work, $W_{\\text{actual}} - W_{\\text{rev}}$, is converted into heat and dissipated into the surrounding thermal reservoir, representing a loss of useful work. Therefore, any compression performed in finite time (i.e., not quasistatically) would require more work than the minimum reversible work derived above.", "answer": "$$\n\\boxed{3 N k_B T \\ln\\left(\\frac{r_1}{r_2}\\right) + 4\\pi \\gamma (r_2^2 - r_1^2)}\n$$", "id": "3702292"}, {"introduction": "This advanced computational practice transitions from the thermodynamics of a single bubble to the kinetics of an entire population. You will implement a Cluster Dynamics model to simulate how helium bubbles nucleate and grow over time from individual helium atoms and vacancies. By translating atomistic binding energies into a system of rate equations, this exercise provides a powerful, hands-on introduction to the mesoscale modeling techniques used to predict the time-dependent evolution of microstructure and property changes in materials under irradiation [@problem_id:3702297].", "problem": "You are given Density Functional Theory (DFT) binding energies for helium atoms attached to a single lattice vacancy in a body-centered cubic refractory metal relevant to nuclear fusion plasma-facing components. The task is to use these binding energies to construct a physically grounded parameter set for a Cluster Dynamics (CD) model and then quantify the sensitivity of helium bubble nucleation to variations in an effective trapping energy. Your program must implement the resulting CD rate equations, integrate them over time, and report the bubble number density for several test cases. All answers must be expressed in per cubic meter ($\\mathrm{m}^{-3}$) as floating-point numbers.\n\nFundamental base and assumptions:\n- Begin from the principle of detailed balance between forward (attachment) and reverse (emission) reactions for a cluster growth step, and the diffusion-limited reaction rate for spherical absorbers.\n- Use the Arrhenius form for diffusion and the Maxwell–Boltzmann factor for equilibrium constants arising from binding energies.\n- The Cluster Dynamics model tracks concentrations $C_n(t)$ of clusters containing $n$ helium atoms bound to a single vacancy (denoted $\\mathrm{V}\\text{--}\\mathrm{He}_n$), and the mobile helium monomer concentration $C_{\\mathrm{He}}(t)$. For computational tractability, consider $n$ up to a finite maximum $N$.\n\nGiven data and parameter construction:\n1. DFT binding energies for the first four sizes $\\mathrm{V}\\text{--}\\mathrm{He}_n$ are provided (for a representative plasma-facing metal), in electronvolts ($\\mathrm{eV}$):\n   - $E_b(1) = 1.10$, $E_b(2) = 1.00$, $E_b(3) = 0.90$, $E_b(4) = 0.85$.\n2. For $n \\gt 4$, define $E_b(n)$ by a logarithmic continuation that captures the monotonic weakening of additional helium binding as the cluster grows:\n   $$E_b(n) = \\max\\left(E_b(4) - \\alpha \\ln\\left(\\frac{n}{4}\\right),\\, E_{\\min}\\right),$$\n   with $\\alpha = 0.05$ and $E_{\\min} = 0.50$ (both in $\\mathrm{eV}$).\n3. Define the effective binding energy as $E_b^{\\mathrm{eff}}(n) = E_b(n) + E_t$, where $E_t$ is a tunable trapping energy accounting for extrinsic stabilization effects (e.g., stress fields, impurities, or local defect configurations). Vary $E_t$ across the test suite to demonstrate sensitivity.\n4. The helium monomer diffusion coefficient obeys an Arrhenius law:\n   $$D_{\\mathrm{He}}(T) = D_0 \\exp\\left(-\\frac{E_m}{k_B T}\\right),$$\n   with $D_0 = 10^{-6}\\ \\mathrm{m}^2/\\mathrm{s}$, $E_m = 0.06\\ \\mathrm{eV}$, Boltzmann constant $k_B = 8.617333262\\times 10^{-5}\\ \\mathrm{eV/K}$, and absolute temperature $T$ in $\\mathrm{K}$.\n5. The diffusion-limited helium capture coefficient for cluster size $n$ is\n   $$k_n(T) = 4 \\pi D_{\\mathrm{He}}(T)\\, a_n,$$\n   where the capture radius scales as $a_n = r_0 n^{1/3}$ with $r_0 = 2.5\\times 10^{-10}\\ \\mathrm{m}$.\n6. Enforce detailed balance by relating the emission coefficient $e_n(T)$ for $\\mathrm{V}\\text{--}\\mathrm{He}_n \\to \\mathrm{V}\\text{--}\\mathrm{He}_{n-1} + \\mathrm{He}$ to the attachment coefficient for the reverse step via the equilibrium constant from $E_b^{\\mathrm{eff}}(n)$:\n   $$e_n(T) = k_{n-1}(T)\\, c_{\\mathrm{ref}} \\exp\\left(-\\frac{E_b^{\\mathrm{eff}}(n)}{k_B T}\\right),\\quad n\\ge 2,$$\n   with $c_{\\mathrm{ref}} = 1/\\Omega$ the atomic number density, and $\\Omega = 3.18\\times 10^{-29}\\ \\mathrm{m}^3$ the atomic volume (so $c_{\\mathrm{ref}} \\approx 3.145\\times 10^{28}\\ \\mathrm{m}^{-3}$).\n7. The governing Cluster Dynamics ordinary differential equations (ODEs) for $n = 1,\\dots,N$ and the monomer are:\n   - Monomer balance:\n     $$\\frac{dC_{\\mathrm{He}}}{dt} = G - k_{\\mathrm{sink}} C_{\\mathrm{He}} - \\sum_{n=1}^{N} k_n C_n C_{\\mathrm{He}} + \\sum_{n=2}^{N} e_n C_n.$$\n   - Cluster balances:\n     $$\\frac{dC_1}{dt} = -k_1 C_1 C_{\\mathrm{He}} + e_2 C_2,$$\n     $$\\frac{dC_n}{dt} = k_{n-1} C_{n-1} C_{\\mathrm{He}} - e_n C_n - k_n C_n C_{\\mathrm{He}} + e_{n+1} C_{n+1},\\quad 2\\le n\\le N-1,$$\n     $$\\frac{dC_N}{dt} = k_{N-1} C_{N-1} C_{\\mathrm{He}} - e_N C_N.$$\n   Here $G$ is the volumetric helium generation rate, and $k_{\\mathrm{sink}}$ is a monomer sink rate that represents loss to extended sinks such as grain boundaries and dislocations. Assume immobile clusters (no cluster sink terms).\n8. Use the following fixed parameters unless varied per test case:\n   - Maximum cluster size $N = 30$.\n   - Bubble threshold size $n_{\\mathrm{bub}} = 10$; report bubble number density as $\\sum_{n=n_{\\mathrm{bub}}}^{N} C_n$.\n   - Monomer sink rate $k_{\\mathrm{sink}} = 10^{3}\\ \\mathrm{s}^{-1}$.\n   - Helium generation rate $G = 10^{20}\\ \\mathrm{m}^{-3}\\mathrm{s}^{-1}$.\n   - Initial conditions: $C_{\\mathrm{He}}(0) = 0$, $C_1(0) = f_{\\mathrm{vac}} c_{\\mathrm{ref}}$, $C_n(0) = 0$ for $n\\ge 2$, with $f_{\\mathrm{vac}} = 10^{-7}$ the initial vacancy fraction.\n\nTasks:\n1. Construct $E_b(n)$ for $n=1,\\dots,N$ using the provided DFT values and the logarithmic continuation.\n2. For each test case, build $k_n(T)$ and $e_n(T)$ using the rules above, implement the ODE system, and numerically integrate from $t=0$ to $t=t_{\\mathrm{end}}$ with a stiff solver.\n3. Compute the bubble number density at $t_{\\mathrm{end}}$ as $\\sum_{n=n_{\\mathrm{bub}}}^{N} C_n(t_{\\mathrm{end}})$, and express it in $\\mathrm{m}^{-3}$.\n\nTest suite:\n- Case $1$ (baseline with no extrinsic trapping): $T=900$, $E_t=0.00$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$.\n- Case $2$ (moderate trapping): $T=900$, $E_t=0.20$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$.\n- Case $3$ (strong trapping): $T=900$, $E_t=0.40$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$.\n- Case $4$ (strong trapping at elevated temperature): $T=1200$, $E_t=0.40$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$.\n\nAnswer specification:\n- For each test case, the answer is a single floating-point number equal to the bubble number density in $\\mathrm{m}^{-3}$ at $t_{\\mathrm{end}}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$r_1$,$r_2$,$r_3$,$r_4$]\"), where each $r_i$ is the bubble number density for the corresponding case, expressed in $\\mathrm{m}^{-3}$ as a floating-point number.", "solution": "This problem involves constructing and solving a Cluster Dynamics (CD) model, a standard mesoscale method for tracking the evolution of defect populations. The solution requires parameterizing the model from physical principles, formulating the rate equations, and integrating them numerically.\n\n**Step 1: Parameterization of the Cluster Dynamics Model**\n\nThe model's core consists of parameters describing reaction rates between helium atoms and vacancy-helium clusters ($\\mathrm{V}\\text{--}\\mathrm{He}_n$), derived from the provided data.\n\nFirst, the binding energy $E_b(n)$ is calculated for all cluster sizes $n$ from $1$ to $N=30$. For $n \\le 4$, the given Density Functional Theory (DFT) values are used. For $n > 4$, a logarithmic continuation formula models the weakening of binding:\n$$E_b(n) = \\max\\left(E_b(4) - \\alpha \\ln\\left(\\frac{n}{4}\\right),\\, E_{\\min}\\right)$$\nwith $\\alpha = 0.05 \\text{ eV}$ and $E_{\\min} = 0.50 \\text{ eV}$. An effective binding energy, $E_b^{\\mathrm{eff}}(n) = E_b(n) + E_t$, incorporates a tunable trapping energy $E_t$.\n\nSecond, the forward reaction rate coefficient for helium capture ($\\mathrm{V}\\text{--}\\mathrm{He}_{n-1} + \\mathrm{He} \\to \\mathrm{V}\\text{--}\\mathrm{He}_n$) is given by a diffusion-limited model:\n$$k_{n-1}(T) = 4 \\pi D_{\\mathrm{He}}(T)\\, a_{n-1}$$\nwhere $a_{n-1} = r_0 (n-1)^{1/3}$ is the capture radius, and $D_{\\mathrm{He}}(T)$ is the helium diffusion coefficient following an Arrhenius relationship:\n$$D_{\\mathrm{He}}(T) = D_0 \\exp\\left(-\\frac{E_m}{k_B T}\\right)$$\n\nThird, the reverse reaction rate for thermal emission ($\\mathrm{V}\\text{--}\\mathrm{He}_n \\to \\mathrm{V}\\text{--}\\mathrm{He}_{n-1} + \\mathrm{He}$), $e_n(T)$, is determined by detailed balance to ensure thermodynamic consistency:\n$$e_n(T) = k_{n-1}(T)\\, c_{\\mathrm{ref}} \\exp\\left(-\\frac{E_b^{\\mathrm{eff}}(n)}{k_B T}\\right)$$\nfor $n \\ge 2$, where $c_{\\mathrm{ref}} = 1/\\Omega$ is the atomic site density.\n\n**Step 2: Formulation of the ODE System**\n\nThe evolution of the concentrations of mobile helium, $C_{\\mathrm{He}}(t)$, and of each cluster size, $C_n(t)$, is governed by a system of coupled first-order ODEs.\n\n1.  **Helium Monomer Balance**:\n    $$\\frac{dC_{\\mathrm{He}}}{dt} = G - k_{\\mathrm{sink}} C_{\\mathrm{He}} - \\sum_{n=1}^{N} k_n C_n C_{\\mathrm{He}} + \\sum_{n=2}^{N} e_n C_n$$\n\n2.  **Cluster Balance**:\n    *   For $n=1$:\n        $$\\frac{dC_1}{dt} = -k_1 C_1 C_{\\mathrm{He}} + e_2 C_2$$\n    *   For $2 \\le n \\le N-1$:\n        $$\\frac{dC_n}{dt} = \\left( k_{n-1} C_{n-1} C_{\\mathrm{He}} - e_n C_n \\right) - \\left( k_n C_n C_{\\mathrm{He}} - e_{n+1} C_{n+1} \\right)$$\n    *   For $n=N$:\n        $$\\frac{dC_N}{dt} = k_{N-1} C_{N-1} C_{\\mathrm{He}} - e_N C_N$$\n\n**Step 3: Numerical Integration and Solution**\n\nThis stiff system of $N+1$ ODEs is solved as an initial value problem using a suitable numerical solver. Initial conditions at $t=0$ are: $C_{\\mathrm{He}}(0) = 0$, $C_1(0) = f_{\\mathrm{vac}} c_{\\mathrm{ref}}$, and $C_n(0) = 0$ for $n \\ge 2$. For each test case, the corresponding parameters ($T$, $E_t$, $G$) are used to calculate the rate coefficients, and the ODE system is integrated to $t_{\\mathrm{end}} = 1000 \\text{ s}$.\n\nThe total bubble number density is then computed by summing the concentrations of clusters with size $n \\ge n_{\\mathrm{bub}} = 10$:\n$$N_{\\mathrm{bubble}} = \\sum_{n=n_{\\mathrm{bub}}}^{N} C_n(t_{\\mathrm{end}})$$\n\nThe following Python code implements this solution procedure.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the cluster dynamics model for helium bubble nucleation.\n    \"\"\"\n\n    # --- Fixed physical and model parameters ---\n    N_max = 30  # Maximum cluster size\n    n_bub = 10  # Threshold size for a cluster to be a \"bubble\"\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    D0 = 1e-6  # He diffusion pre-factor in m^2/s\n    E_m = 0.06  # He migration energy in eV\n    r0 = 2.5e-10  # Capture radius scaling factor in m\n    Omega = 3.18e-29  # Atomic volume in m^3\n    c_ref = 1.0 / Omega  # Atomic number density in m^-3\n    f_vac = 1e-7  # Initial vacancy fraction\n    k_sink = 1e3  # Monomer sink rate in s^-1\n\n    # --- Test suite definition ---\n    test_cases = [\n        # (T [K], E_t [eV], G [m^-3s^-1], t_end [s])\n        (900.0, 0.00, 1e20, 1000.0),\n        (900.0, 0.20, 1e20, 1000.0),\n        (900.0, 0.40, 1e20, 1000.0),\n        (1200.0, 0.40, 1e20, 1000.0),\n    ]\n\n    # --- Pre-calculate size-dependent binding energies E_b(n) ---\n    Eb = np.zeros(N_max)\n    Eb_dft = {1: 1.10, 2: 1.00, 3: 0.90, 4: 0.85}\n    alpha = 0.05\n    E_min = 0.50\n    for n in range(1, N_max + 1):\n        if n in Eb_dft:\n            Eb[n - 1] = Eb_dft[n]\n        else:\n            Eb[n - 1] = max(Eb_dft[4] - alpha * np.log(n / 4.0), E_min)\n\n    def get_ode_params(T, Et):\n        \"\"\"Calculates temperature-dependent reaction coefficients.\"\"\"\n        # Helium diffusion coefficient\n        D_He = D0 * np.exp(-E_m / (k_B * T))\n\n        # Capture coefficients k_n for V-He_n clusters\n        n_vals = np.arange(1, N_max + 1)\n        a_n = r0 * n_vals**(1 / 3.0)\n        k_n = 4.0 * np.pi * D_He * a_n\n\n        # Emission coefficients e_n from V-He_n clusters\n        Eb_eff = Eb + Et\n        e_n = np.zeros(N_max - 1)  # For n=2 to N_max\n        for n in range(2, N_max + 1):\n            # e_n corresponds to e_n[n-2]\n            # k_{n-1} corresponds to k_n[n-2]\n            # E_b^{eff}(n) corresponds to Eb_eff[n-1]\n            e_n[n - 2] = k_n[n - 2] * c_ref * np.exp(-Eb_eff[n - 1] / (k_B * T))\n\n        return k_n, e_n\n\n    def ode_system(t, C, G_case, k_sink_const, k, e):\n        \"\"\"Defines the system of ODEs for cluster dynamics.\"\"\"\n        dCdt = np.zeros_like(C)\n        C_He = C[0]\n        # C_clusters represents C_1, C_2, ..., C_N\n        C_clusters = C[1:]\n\n        # --- Monomer (C_He) Balance ---\n        # Net flux from capture by all clusters\n        he_capture_flux = np.sum(k * C_clusters * C_He)\n        # Total flux from emission from clusters C_2 to C_N\n        he_emission_flux = np.sum(e * C_clusters[1:])\n        dCdt[0] = G_case - k_sink_const * C_He - he_capture_flux + he_emission_flux\n\n        # --- Cluster Balances ---\n        # C_1 balance: dC1/dt = -k1*C1*C_He + e2*C2\n        dCdt[1] = -k[0] * C_clusters[0] * C_He + e[0] * C_clusters[1]\n\n        # C_2 to C_{N-1} balance: dCn/dt = J_n - J_{n+1}\n        # where J_n = k_{n-1}*C_{n-1}*C_He - e_n*C_n\n        for n in range(2, N_max):\n            # n is the cluster size, runs from 2 to N_max-1\n            # C[n] is C_clusters[n-1]\n            # k[n-1] is k_n\n            # e[n-2] is e_n\n            J_n = k[n - 2] * C_clusters[n - 2] * C_He - e[n - 2] * C_clusters[n - 1]\n            J_n_plus_1 = k[n - 1] * C_clusters[n - 1] * C_He - e[n - 1] * C_clusters[n]\n            dCdt[n] = J_n - J_n_plus_1\n\n        # C_N balance: dCN/dt = J_N\n        n = N_max\n        J_N = k[n - 2] * C_clusters[n - 2] * C_He - e[n - 2] * C_clusters[n - 1]\n        dCdt[n] = J_N\n\n        return dCdt\n\n    results = []\n    # --- Loop over test cases ---\n    for case in test_cases:\n        T_case, Et_case, G_case, t_end_case = case\n\n        # Calculate rate coefficients for the current case\n        k_coeffs, e_coeffs = get_ode_params(T_case, Et_case)\n\n        # Set initial conditions\n        C0 = np.zeros(N_max + 1)\n        C0[1] = f_vac * c_ref  # Initial concentration of V-He_1 (vacancies)\n\n        # Numerically integrate the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, t_end_case],\n            y0=C0,\n            method='Radau',  # Stiff solver\n            args=(G_case, k_sink, k_coeffs, e_coeffs),\n            dense_output=True\n        )\n\n        # Extract final concentrations at t_end\n        C_final = sol.sol(t_end_case)\n\n        # Calculate bubble number density (sum from n_bub to N_max)\n        # C_final[i] corresponds to C_i\n        bubble_density = np.sum(C_final[n_bub:])\n        results.append(bubble_density)\n\n    # Print results in the specified format\n    # This print statement is for local execution and is not part of the final XML.\n    # print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n    return results\n\nresults = solve()\n```", "answer": "[1.83984852e+15,1.55184288e+20,3.13689037e+21,3.13098906e+21]", "id": "3702297"}]}