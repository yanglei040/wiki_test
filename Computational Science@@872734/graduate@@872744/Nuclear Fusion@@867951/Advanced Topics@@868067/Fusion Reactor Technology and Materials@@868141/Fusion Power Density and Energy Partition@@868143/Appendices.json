{"hands_on_practices": [{"introduction": "To determine if a fusion plasma can sustain itself, we must start with the most fundamental principle: energy conservation. This first exercise [@problem_id:3700254] guides you through building a zero-dimensional (0-D) power balance model, which treats the plasma as a single point with uniform properties. By implementing this model from first principles, you will gain quantitative intuition for the delicate interplay between alpha particle heating ($P_{\\alpha}$), radiation losses ($P_{\\text{brem}}$), and energy transport losses ($P_{\\tau}$), ultimately allowing you to determine the conditions necessary for ignition.", "problem": "Design and implement a complete, runnable program that evaluates zero-dimensional (0-D) power balance and ignition in a deuterium-tritium (D-T) fusion plasma, with explicit modeling of power density and energy partition among reaction products and loss channels. The problem is to decide, for several specified steady-state plasma parameter sets, whether ignition is achieved under total power balance, and whether the electrons alone can be power balanced without auxiliary heating, given a simplified but scientifically plausible model. All results must be obtained from first principles of energy conservation and standard plasma radiation and reaction-rate modeling, without relying on any external data.\n\nThe fundamental base for the derivation shall begin from the following laws and core definitions:\n- Energy conservation in steady state: net heating equals losses for each species or for the total plasma.\n- Fusion reactivity definition: the reaction rate density is the product of reactant densities and the thermally averaged cross section.\n- Power density from fusion reactions: the power density equals reaction rate density times the energy per reaction deposited in the plasma.\n- Bremsstrahlung radiation: fully ionized, nonrelativistic electron-ion bremsstrahlung scales with the square of electron density and the square root of electron temperature.\n- Thermal energy content and transport loss: the transported power density equals stored thermal energy density divided by an energy confinement time.\n\nUse the following modeling assumptions and numerical inputs:\n- The fuel is a $50/50$ deuterium-tritium mixture with no external heating. The reaction is $\\mathrm{D} + \\mathrm{T} \\rightarrow \\alpha \\, (3.5\\,\\mathrm{MeV}) + n \\, (14.1\\,\\mathrm{MeV})$. The alpha particle energy $3.5\\,\\mathrm{MeV}$ is assumed to be fully deposited in the plasma, while the neutron energy escapes.\n- Quasi-neutrality with negligible impurity density contribution to the electron density is assumed, so the electron density $n_e$ is equal to the total main-ion density, and $n_{\\mathrm{D}} = n_{\\mathrm{T}} = n_e/2$. Denote the effective charge number as $Z_{\\mathrm{eff}}$, which only affects bremsstrahlung.\n- The electron and ion temperatures are assumed equal, $T_e = T_i = T$, expressed in $\\mathrm{keV}$.\n- The energy partition of alpha power to electrons and ions is modeled by a constant fraction: a fraction $f_e = 0.85$ of the alpha power is deposited to electrons, and a fraction $f_i = 1 - f_e = 0.15$ to ions. This approximates Coulomb slowing down of fast alphas on electrons and ions at temperatures in the multi-$\\mathrm{keV}$ range.\n- The thermally averaged D-T fusion reactivity $\\langle \\sigma v \\rangle$ as a function of $T$ (in $\\mathrm{keV}$) must be obtained by log-log linear interpolation of the following tabulated values (with $\\langle \\sigma v \\rangle$ in $\\mathrm{m}^3/\\mathrm{s}$):\n  - $T = 5$: $\\langle \\sigma v \\rangle = 1.1 \\times 10^{-23}$\n  - $T = 10$: $\\langle \\sigma v \\rangle = 1.1 \\times 10^{-22}$\n  - $T = 15$: $\\langle \\sigma v \\rangle = 3.2 \\times 10^{-22}$\n  - $T = 20$: $\\langle \\sigma v \\rangle = 6.0 \\times 10^{-22}$\n  - $T = 25$: $\\langle \\sigma v \\rangle = 9.8 \\times 10^{-22}$\n  For any $T$ lying strictly between the tabulated points, use log-log linear interpolation; for $T$ equal to a table point, use the corresponding value. The inputs will not require extrapolation outside the tabulated range.\n- The electron-ion bremsstrahlung power density is modeled as\n  $$ P_{\\mathrm{brem}} = C_b \\, Z_{\\mathrm{eff}} \\, n_e^2 \\, \\sqrt{T_e[\\mathrm{eV}]}, $$\n  where $C_b = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m}^3\\,\\mathrm{eV}^{-1/2}$, $T_e[\\mathrm{eV}] = 10^3 \\, T[\\mathrm{keV}]$, and $n_e$ is in $\\mathrm{m}^{-3}$.\n- The alpha heating power density is\n  $$ P_\\alpha = R \\, E_\\alpha, \\quad R = n_{\\mathrm{D}} n_{\\mathrm{T}} \\langle \\sigma v \\rangle = \\frac{n_e^2}{4} \\langle \\sigma v \\rangle, $$\n  with $E_\\alpha = 3.5 \\times 10^6 \\,\\mathrm{eV}$ converted to joules by the elementary charge $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}$.\n- The thermal transport loss power density for the total plasma is\n  $$ P_{\\tau,\\mathrm{tot}} = \\frac{U_{\\mathrm{tot}}}{\\tau_E}, \\quad U_{\\mathrm{tot}} = \\frac{3}{2} n_e k_B T_e + \\frac{3}{2} n_i k_B T_i = 3 \\, n_e \\, k_B \\, T, $$\n  where $k_B$ is Boltzmann’s constant expressed in joules per electron volt via $k_B T[\\mathrm{J}] = T[\\mathrm{eV}] \\times e$, and $\\tau_E$ is the energy confinement time in seconds. For species-resolved bookkeeping, you may also use $P_{\\tau,e} = \\frac{3}{2} n_e k_B T / \\tau_E$ and $P_{\\tau,i} = \\frac{3}{2} n_i k_B T / \\tau_E$.\n- The total ignition condition (no auxiliary power) is defined by the nonnegativity of net total power:\n  $$ \\text{Ignition (total)} \\iff P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}. $$\n  The electron-alone balance (without invoking electron-ion energy exchange) is defined by\n  $$ \\text{Ignition (electrons)} \\iff f_e \\, P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,e}. $$\n- The critical energy confinement time for total power balance at given $n_e$ and $T$ is defined (if meaningful) by solving\n  $$ P_\\alpha = P_{\\mathrm{brem}} + \\frac{3 \\, n_e \\, k_B \\, T}{\\tau_{E,\\mathrm{crit,tot}}}, $$\n  namely\n  $$ \\tau_{E,\\mathrm{crit,tot}} = \\frac{3 \\, n_e \\, k_B \\, T}{P_\\alpha - P_{\\mathrm{brem}}}, $$\n  provided $P_\\alpha > P_{\\mathrm{brem}}$; otherwise define $\\tau_{E,\\mathrm{crit,tot}} = \\infty$.\n  Similarly, for the electron-alone condition,\n  $$ \\tau_{E,\\mathrm{crit,e}} = \\frac{\\tfrac{3}{2} \\, n_e \\, k_B \\, T}{f_e \\, P_\\alpha - P_{\\mathrm{brem}}}, $$\n  provided $f_e \\, P_\\alpha > P_{\\mathrm{brem}}$; otherwise define $\\tau_{E,\\mathrm{crit,e}} = \\infty$.\n- Define the net total margin as the dimensionless decimal\n  $$ \\mathcal{M}_{\\mathrm{tot}} = \\frac{P_\\alpha - \\left(P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}\\right)}{P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}}. $$\n\nTasks:\n1. Implement the above physical model using only the provided inputs and constants. Perform calculations in strict International System of Units (SI) where applicable. Express temperatures internally in joules when combining with $n_e$ and $\\tau_E$. Use the given interpolation approach for $\\langle \\sigma v \\rangle$.\n2. For each test case below, compute:\n   - The boolean ignition under total balance,\n   - The boolean ignition for electrons alone,\n   - The critical confinement times $\\tau_{E,\\mathrm{crit,tot}}$ and $\\tau_{E,\\mathrm{crit,e}}$ in seconds,\n   - The net total margin $\\mathcal{M}_{\\mathrm{tot}}$ as a decimal.\n   Round all finite floating-point outputs to six significant digits. If a critical time is $+\\infty$, output it as $+\\infty$.\n3. Use the following test suite of parameter values (each tuple is $(n_e[\\mathrm{m}^{-3}], T[\\mathrm{keV}], \\tau_E[\\mathrm{s}], Z_{\\mathrm{eff}})$):\n   - Case A (edge, bremsstrahlung-dominated): $(1.0 \\times 10^{20}, 10, 3.0, 1.0)$\n   - Case B (happy path, near threshold): $(1.0 \\times 10^{20}, 15, 3.0, 1.0)$\n   - Case C (impurity penalty): $(1.0 \\times 10^{20}, 15, 3.0, 2.0)$\n   - Case D (higher density, reduced confinement): $(2.0 \\times 10^{20}, 15, 1.5, 1.0)$\n   - Case E (low temperature, long confinement): $(1.0 \\times 10^{20}, 5, 10.0, 1.0)$\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each case’s result must be a list of the form\n  $$ [\\text{ignite\\_total}, \\text{ignite\\_electron}, \\tau_{E,\\mathrm{crit,tot}}[\\mathrm{s}], \\tau_{E,\\mathrm{crit,e}}[\\mathrm{s}], \\mathcal{M}_{\\mathrm{tot}}], $$\n  where the booleans are literal $\\text{True}$ or $\\text{False}$, the times are finite floats rounded to six significant digits or $+\\infty$ if infinite, and the margin is a float rounded to six significant digits. The final output should thus look like\n  $$ [[b_1, b_2, t_1, t_2, m_1],[b_1', b_2', t_1', t_2', m_1'],\\ldots] $$\n  where $b_i$ are booleans and $t_i, m_i$ are numbers. All times must be expressed in $\\mathrm{s}$ and all calculations must be self-consistent with SI units.", "solution": "The problem has been meticulously validated against the specified criteria and is determined to be **valid**. It is scientifically grounded, well-posed, and objective. The provided physical model, constants, and parameters form a self-contained and consistent basis for a unique and meaningful solution. We may therefore proceed with the derivation and implementation.\n\nThe core of the problem is to evaluate the power balance in a deuterium-tritium ($D-T$) fusion plasma under steady-state conditions. The analysis hinges on comparing the plasma heating power sources against the power loss channels. All calculations will be performed in SI units to ensure consistency.\n\nThe primary heating source is the energy from fusion-born alpha particles ($\\alpha$). The D-T fusion reaction is $\\mathrm{D} + \\mathrm{T} \\rightarrow \\alpha + n$. The alpha particle carries an energy of $E_\\alpha = 3.5\\,\\mathrm{MeV}$ and is assumed to be fully confined, depositing its energy into the plasma. The neutron, with energy $14.1\\,\\mathrm{MeV}$, escapes. The energy per reaction deposited in the plasma is thus $E_{\\alpha,J} = (3.5 \\times 10^6\\,\\mathrm{eV}) \\times e$, where $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}$ is the elementary charge.\n\nThe fusion reaction rate density, $R$, for a plasma with deuterium density $n_D$ and tritium density $n_T$ is given by $R = n_D n_T \\langle \\sigma v \\rangle$. For the specified $50/50$ D-T fuel mix, we have $n_D = n_T = n_e/2$, where $n_e$ is the electron density. Thus, $R = \\frac{n_e^2}{4} \\langle \\sigma v \\rangle$. The corresponding alpha heating power density, $P_\\alpha$, is:\n$$\nP_\\alpha = R \\cdot E_{\\alpha,J} = \\frac{n_e^2}{4} \\langle \\sigma v \\rangle(T) E_{\\alpha,J}\n$$\nThe quantity $\\langle \\sigma v \\rangle(T)$ is the D-T fusion reactivity, which is a strong function of the plasma temperature $T$. As specified, its value is determined by log-log linear interpolation of the provided tabulated data. If we let $x = \\log T$ and $y = \\log \\langle \\sigma v \\rangle$, for a temperature $T$ between tabulated points $(T_1, \\langle \\sigma v \\rangle_1)$ and $(T_2, \\langle \\sigma v \\rangle_2)$, the value is found by linear interpolation in log-space:\n$$\n\\log \\langle \\sigma v \\rangle(T) = \\log \\langle \\sigma v \\rangle_1 + \\frac{\\log T - \\log T_1}{\\log T_2 - \\log T_1} (\\log \\langle \\sigma v \\rangle_2 - \\log \\langle \\sigma v \\rangle_1)\n$$\n\nThe plasma loses energy through two primary channels: radiation and transport. The radiation loss is modeled as electron-ion bremsstrahlung, with power density $P_{\\mathrm{brem}}$ given by:\n$$\nP_{\\mathrm{brem}} = C_b \\, Z_{\\mathrm{eff}} \\, n_e^2 \\, \\sqrt{T_e[\\mathrm{eV}]}\n$$\nHere, $C_b = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m}^3\\,\\mathrm{eV}^{-1/2}$ is the bremsstrahlung constant, $Z_{\\mathrm{eff}}$ is the effective ion charge, and the electron temperature $T_e$ is related to the common temperature $T$ (in keV) by $T_e[\\mathrm{eV}] = 1000 \\times T[\\mathrm{keV}]$.\n\nThe transport loss power density, $P_{\\tau,\\mathrm{tot}}$, is characterized by the energy confinement time $\\tau_E$. It is the rate at which thermal energy is lost from the plasma volume:\n$$\nP_{\\tau,\\mathrm{tot}} = \\frac{U_{\\mathrm{tot}}}{\\tau_E}\n$$\nThe total thermal energy density, $U_{\\mathrm{tot}}$, for a plasma with equal electron and ion temperatures ($T_e=T_i=T$) and equal electron and total ion densities ($n_i = n_D+n_T = n_e$) is:\n$$\nU_{\\mathrm{tot}} = U_e + U_i = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T = 3 n_e k_B T\n$$\nThe term $k_B T$ represents the thermal energy in Joules, calculated as $k_B T[\\mathrm{J}] = (1000 \\times T[\\mathrm{keV}]) \\times e$. Therefore, the total transport loss is:\n$$\nP_{\\tau,\\mathrm{tot}} = \\frac{3 n_e k_B T}{\\tau_E}\n$$\nThe electron-specific transport loss, $P_{\\tau,e}$, is defined as $P_{\\tau,e} = \\frac{U_e}{\\tau_E} = \\frac{\\frac{3}{2} n_e k_B T}{\\tau_E}$, which is simply half of the total transport loss.\n\nWith these definitions, we can evaluate the two ignition conditions. Total ignition is achieved if the alpha heating can overcome all losses without auxiliary heating:\n$$\n\\text{Ignition (total)} \\iff P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}\n$$\nThe second condition assesses whether electrons alone can be power-balanced. A fraction $f_e = 0.85$ of the alpha power is coupled to electrons. This electron heating must balance the losses from the electron channel (bremsstrahlung and electron transport):\n$$\n\\text{Ignition (electrons)} \\iff f_e \\, P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,e}\n$$\n\nThe critical energy confinement times are derived by setting the respective power balance equations to equality and solving for $\\tau_E$. For total power balance, we solve $P_\\alpha = P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}(\\tau_{E,\\mathrm{crit,tot}})$:\n$$\n\\tau_{E,\\mathrm{crit,tot}} = \\frac{3 n_e k_B T}{P_\\alpha - P_{\\mathrm{brem}}}\n$$\nThis is physically meaningful only if the alpha heating exceeds the bremsstrahlung loss, i.e., $P_\\alpha > P_{\\mathrm{brem}}$. Otherwise, ignition is impossible regardless of confinement, and $\\tau_{E,\\mathrm{crit,tot}}$ is defined as $\\infty$.\n\nSimilarly, for the electron-only balance, from $f_e P_\\alpha = P_{\\mathrm{brem}} + P_{\\tau,e}(\\tau_{E,\\mathrm{crit,e}})$:\n$$\n\\tau_{E,\\mathrm{crit,e}} = \\frac{\\frac{3}{2} n_e k_B T}{f_e P_\\alpha - P_{\\mathrm{brem}}}\n$$\nThis requires $f_e P_\\alpha > P_{\\mathrm{brem}}$, otherwise $\\tau_{E,\\mathrm{crit,e}}$ is defined as $\\infty$.\n\nFinally, the net total margin, $\\mathcal{M}_{\\mathrm{tot}}$, quantifies the excess or deficit of power relative to the losses:\n$$\n\\mathcal{M}_{\\mathrm{tot}} = \\frac{P_\\alpha - \\left(P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}\\right)}{P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}}\n$$\nA non-negative margin ($\\mathcal{M}_{\\mathrm{tot}} \\ge 0$) is equivalent to the total ignition condition being met.\n\nFor each test case, we substitute the given parameters $(n_e, T, \\tau_E, Z_{\\mathrm{eff}})$ into these equations to compute the required boolean flags and numerical metrics. The implementation will systematically calculate each power term and then evaluate the final quantities, ensuring correct unit conversions and adherence to the specified interpolation and rounding rules.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 0-D fusion power balance problem for a set of test cases.\n    \"\"\"\n    # Define physical constants and problem parameters\n    E_ALPHA_EV = 3.5e6  # Alpha particle energy in eV\n    E_CHARGE = 1.602176634e-19  # Elementary charge in J/eV\n    C_B = 1.69e-38  # Bremsstrahlung constant in W m^3 eV^(-1/2)\n    F_E = 0.85  # Fraction of alpha power to electrons\n\n    E_ALPHA_J = E_ALPHA_EV * E_CHARGE  # Alpha particle energy in Joules\n\n    # Tabulated D-T reactivity data\n    # T in keV, <sigma v> in m^3/s\n    T_TABLE = np.array([5.0, 10.0, 15.0, 20.0, 25.0])\n    SV_TABLE = np.array([1.1e-23, 1.1e-22, 3.2e-22, 6.0e-22, 9.8e-22])\n    \n    # Pre-calculate logs for interpolation\n    LOG_T_TABLE = np.log(T_TABLE)\n    LOG_SV_TABLE = np.log(SV_TABLE)\n\n    # Test suite of plasma parameters\n    # (n_e [m^-3], T [keV], tau_E [s], Z_eff)\n    test_cases = [\n        (1.0e20, 10.0, 3.0, 1.0),  # Case A\n        (1.0e20, 15.0, 3.0, 1.0),  # Case B\n        (1.0e20, 15.0, 3.0, 2.0),  # Case C\n        (2.0e20, 15.0, 1.5, 1.0),  # Case D\n        (1.0e20, 5.0, 10.0, 1.0),  # Case E\n    ]\n\n    def _calculate_power_balance(n_e, T_kev, tau_E, Z_eff):\n        \"\"\"\n        Calculates all required metrics for a single plasma parameter set.\n        \"\"\"\n        # 1. Calculate fusion reactivity <sigma v> via log-log interpolation\n        log_sv = np.interp(np.log(T_kev), LOG_T_TABLE, LOG_SV_TABLE)\n        sv = np.exp(log_sv)\n        \n        # 2. Convert temperature to eV and calculate k_B*T in Joules\n        T_ev = T_kev * 1000.0\n        kBT_J = T_ev * E_CHARGE\n\n        # 3. Calculate power density terms in SI units (W/m^3)\n        p_alpha = (n_e**2 / 4.0) * sv * E_ALPHA_J\n        p_brem = C_B * Z_eff * n_e**2 * np.sqrt(T_ev)\n        \n        U_tot = 3.0 * n_e * kBT_J\n        U_e = 1.5 * n_e * kBT_J\n        \n        p_tau_tot = U_tot / tau_E\n        p_tau_e = U_e / tau_E\n        \n        # 4. Evaluate ignition conditions\n        total_losses = p_brem + p_tau_tot\n        ignite_total = p_alpha >= total_losses\n        \n        electron_losses = p_brem + p_tau_e\n        ignite_electron = (F_E * p_alpha) >= electron_losses\n\n        # 5. Calculate critical confinement times\n        # Total\n        denom_tot = p_alpha - p_brem\n        tau_crit_tot = U_tot / denom_tot if denom_tot > 0 else float('inf')\n        \n        # Electron\n        denom_e = F_E * p_alpha - p_brem\n        tau_crit_e = U_e / denom_e if denom_e > 0 else float('inf')\n\n        # 6. Calculate net total margin\n        margin_tot = (p_alpha - total_losses) / total_losses\n\n        return ignite_total, ignite_electron, tau_crit_tot, tau_crit_e, margin_tot\n\n    def format_value(v):\n        \"\"\"Formats a numerical value to 6 significant digits or '+inf'.\"\"\"\n        if v == float('inf'):\n            return '+inf'\n        return f'{v:.6g}'\n\n    all_results_str = []\n    for case in test_cases:\n        ignite_total, ignite_electron, tau_crit_tot, tau_crit_e, margin_tot = _calculate_power_balance(*case)\n        \n        case_result_str = [\n            str(ignite_total),\n            str(ignite_electron),\n            format_value(tau_crit_tot),\n            format_value(tau_crit_e),\n            format_value(margin_tot)\n        ]\n        \n        all_results_str.append(f\"[{','.join(case_result_str)}]\")\n\n    print(f\"[{','.join(all_results_str)}]\")\n\n\nsolve()\n```", "id": "3700254"}, {"introduction": "While 0-D models provide a foundational understanding, real plasmas are not uniform; their density and temperature peak at the core and decrease toward the edge. This second practice [@problem_id:3700259] explores the profound impact of these spatial and temporal profiles on fusion power production, a consequence of the fusion rate's dependence on the square of the density ($R \\propto n^2$). You will analytically derive and then implement formulas for \"peaking factors,\" which quantify the power enhancement from peaked profiles, a crucial insight for realistic reactor performance assessment.", "problem": "Consider a Deuterium–Tritium (D-T) plasma confined in a right circular cylinder of radius $R$ and length $L$. Let the deuterium number density be $n_D(r,t)$ and the tritium number density be $n_T(r,t)$. Assume identical, separable space-time profiles for both species given by $n_D(r,t) = n_{D,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$ and $n_T(r,t) = n_{T,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$, with\n$$\nS_r(r;\\alpha) = \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{\\alpha}, \\quad 0 \\le r \\le R, \\quad \\alpha \\ge 0,\n$$\nand\n$$\nS_t(t;\\sigma,t_0) = \\exp\\left(-\\frac{(t - t_0)^2}{2 \\sigma^2}\\right), \\quad \\sigma > 0.\n$$\nAssume a spatially and temporally uniform Maxwellian-averaged reactivity equal to the constant $\\langle \\sigma v \\rangle_0$ for the D-T reaction. The D-T fusion releases a total energy per reaction $E_{\\text{tot}} = 17.6\\,\\text{MeV}$, partitioned as $E_{\\alpha} = 3.5\\,\\text{MeV}$ to charged alpha particles and $E_{n} = 14.1\\,\\text{MeV}$ to neutrons. Use $1\\,\\text{eV} = 1.602176634\\times 10^{-19}\\,\\text{J}$ for unit conversion.\n\nThe local reaction rate density is defined by the well-tested relation\n$$\nR(r,t) = n_D(r,t)\\, n_T(r,t)\\, \\langle \\sigma v \\rangle_0,\n$$\nand the corresponding local fusion power densities for the charged and neutron partitions are\n$$\np_{\\alpha}(r,t) = R(r,t)\\, E_{\\alpha}, \\quad p_{n}(r,t) = R(r,t)\\, E_{n},\n$$\nafter converting $E_{\\alpha}$ and $E_{n}$ to joules.\n\nDefine the volume average of any quantity $X(r,t)$ over the cylindrical volume $V = \\pi R^2 L$ as\n$$\n\\langle X \\rangle_V(t) = \\frac{1}{V} \\int_V X(r,t)\\, \\mathrm{d}V = \\frac{1}{\\pi R^2 L} \\int_{0}^{L} \\int_{0}^{R} \\int_{0}^{2\\pi} X(r,t)\\, r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r\\, \\mathrm{d}z,\n$$\nand the time average of a time-dependent quantity $Y(t)$ over a window of duration $\\Delta t$ centered at $t_0$,\n$$\n\\langle Y \\rangle_T = \\frac{1}{\\Delta t} \\int_{t_0 - \\frac{\\Delta t}{2}}^{t_0 + \\frac{\\Delta t}{2}} Y(t)\\, \\mathrm{d}t.\n$$\n\nDefine the spatial peaking factor at time $t$ as\n$$\nPF_r(t) = \\frac{p_{\\text{tot}}(r=0,t)}{\\langle p_{\\text{tot}} \\rangle_V(t)}, \\quad p_{\\text{tot}}(r,t) = p_{\\alpha}(r,t) + p_{n}(r,t),\n$$\nand the temporal peaking factor at $r=0$ as\n$$\nPF_t = \\frac{p_{\\text{tot}}(r=0,t_0)}{\\langle p_{\\text{tot}}(r=0,\\cdot) \\rangle_T}.\n$$\nThe global space-time peaking factor is\n$$\nPF_{\\text{global}} = PF_r(t_0)\\, PF_t.\n$$\n\nStarting only from the definitions above and the provided well-tested relations, derive expressions for the volume average and the time average of the shape factors associated with $S_r(r;\\alpha)$ and $S_t(t;\\sigma,t_0)$, and then use these to obtain closed-form formulas for $\\langle p_{\\alpha} \\rangle_{V,T}$, $\\langle p_{n} \\rangle_{V,T}$, $PF_r(t_0)$, $PF_t$, and $PF_{\\text{global}}$.\n\nYour program must implement these derived formulas and compute, for each test case specified below, the following three quantities:\n- The space-time averaged charged fusion power density $\\langle p_{\\alpha} \\rangle_{V,T}$ in $\\mathrm{W}/\\mathrm{m}^3$.\n- The space-time averaged neutron fusion power density $\\langle p_{n} \\rangle_{V,T}$ in $\\mathrm{W}/\\mathrm{m}^3$.\n- The global peaking factor $PF_{\\text{global}}$ as a dimensionless float.\n\nAll calculations must be performed using the input parameters as provided. Use $t_0 = 0\\,\\text{s}$ for all cases. The cylindrical geometry parameters $R$ and $L$ are included for completeness but cancel from the averages for the given profiles; do not assume any additional geometry beyond what is stated.\n\nTest suite (each tuple lists $(n_{D,0}, n_{T,0}, \\alpha, \\sigma, \\Delta t, \\langle \\sigma v \\rangle_0)$ with units ($\\mathrm{m}^{-3}$, $\\mathrm{m}^{-3}$, $-$, $\\mathrm{s}$, $\\mathrm{s}$, $\\mathrm{m}^3/\\mathrm{s}$)):\n- Case A (uniform space-time profile): $(5.0\\times 10^{19},\\ 5.0\\times 10^{19},\\ 0.0,\\ 100.0,\\ 1.0,\\ 1.0\\times 10^{-22})$.\n- Case B (moderately peaked in space and time): $(5.0\\times 10^{19},\\ 5.0\\times 10^{19},\\ 1.0,\\ 0.05,\\ 0.5,\\ 1.0\\times 10^{-22})$.\n- Case C (strong temporal peaking, spatially peaked): $(1.0\\times 10^{20},\\ 1.0\\times 10^{20},\\ 2.0,\\ 0.005,\\ 1.0,\\ 1.2\\times 10^{-22})$.\n- Case D (strong spatial peaking, short pulse): $(3.0\\times 10^{19},\\ 3.0\\times 10^{19},\\ 9.0,\\ 0.04,\\ 0.2,\\ 8.0\\times 10^{-23})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of the three floats $[\\langle p_{\\alpha} \\rangle_{V,T}, \\langle p_{n} \\rangle_{V,T}, PF_{\\text{global}}]$, and the program must output the list of these per-case lists in the order of the test suite, for example, $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$.", "solution": "The user has provided a valid, well-posed problem that is scientifically grounded in the principles of nuclear fusion plasma physics. All necessary definitions, parameters, and constants are provided to derive the required formulas and compute the numerical results. We proceed with the derivation.\n\nThe core of the problem is to compute space-time averages of the fusion power density and related peaking factors. The power density is derived from the reaction rate, which in turn depends on the square of the particle number densities. Given the separable nature of the density profiles, the problem simplifies into calculating independent spatial and temporal averaging factors. We begin by formulating the local power density.\n\nThe deuterium and tritium number densities are given by $n_D(r,t) = n_{D,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$ and $n_T(r,t) = n_{T,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$, respectively. The local reaction rate density is $R(r,t) = n_D(r,t)\\, n_T(r,t)\\, \\langle \\sigma v \\rangle_0$. Substituting the density profiles yields:\n$$\nR(r,t) = n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 [S_r(r;\\alpha)]^2 [S_t(t;\\sigma,t_0)]^2\n$$\nThe local power densities for alpha particles and neutrons are $p_{\\alpha}(r,t) = R(r,t) E_{\\alpha}$ and $p_{n}(r,t) = R(r,t) E_{n}$. The total power density is $p_{\\text{tot}}(r,t) = p_{\\alpha}(r,t) + p_{n}(r,t) = R(r,t) E_{\\text{tot}}$.\n\nThe space-time averaged power density for a species $j$ (where $j$ is $\\alpha$ or $n$) is $\\langle p_j \\rangle_{V,T} = \\langle \\langle p_j(r,t) \\rangle_V \\rangle_T$. Due to the separability of the spatial and temporal profiles, this can be written as:\n$$\n\\langle p_j \\rangle_{V,T} = (n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_j) \\cdot \\langle [S_r(r;\\alpha)]^2 \\rangle_V \\cdot \\langle [S_t(t;\\sigma,t_0)]^2 \\rangle_T\n$$\nThe term $n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_j$ is the peak power density $p_{j,peak}$, occurring at $r=0$ and $t=t_0$. The problem reduces to finding the volume average of $[S_r]^2$ and the time average of $[S_t]^2$.\n\nFirst, we derive the volume average of the spatial shape factor squared, $\\langle [S_r(r;\\alpha)]^2 \\rangle_V$.\n$$\n\\langle [S_r]^2 \\rangle_V = \\frac{1}{V} \\int_V [S_r(r;\\alpha)]^2\\, \\mathrm{d}V = \\frac{1}{\\pi R^2 L} \\int_{0}^{L} \\int_{0}^{R} \\int_{0}^{2\\pi} \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{2\\alpha} r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r\\, \\mathrm{d}z\n$$\nThe integrand is independent of $z$ and $\\theta$, so the integration over these variables yields a factor of $2\\pi L$.\n$$\n\\langle [S_r]^2 \\rangle_V = \\frac{2\\pi L}{\\pi R^2 L} \\int_{0}^{R} \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{2\\alpha} r\\, \\mathrm{d}r = \\frac{2}{R^2} \\int_{0}^{R} \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{2\\alpha} r\\, \\mathrm{d}r\n$$\nLet $u = (r/R)^2$. Then $\\mathrm{d}u = 2r/R^2 \\mathrm{d}r$, and the integration limits change from $[0, R]$ to $[0, 1]$.\n$$\n\\langle [S_r]^2 \\rangle_V = \\int_{0}^{1} (1-u)^{2\\alpha} \\mathrm{d}u = \\left[-\\frac{(1-u)^{2\\alpha+1}}{2\\alpha+1}\\right]_0^1 = 0 - \\left(-\\frac{1}{2\\alpha+1}\\right) = \\frac{1}{2\\alpha+1}\n$$\nThis result is valid for $\\alpha > -1/2$, which is satisfied by the problem constraint $\\alpha \\ge 0$.\n\nSecond, we derive the time average of the temporal shape factor squared, $\\langle [S_t(t;\\sigma,t_0)]^2 \\rangle_T$.\n$$\n\\langle [S_t]^2 \\rangle_T = \\frac{1}{\\Delta t} \\int_{t_0 - \\frac{\\Delta t}{2}}^{t_0 + \\frac{\\Delta t}{2}} \\left[\\exp\\left(-\\frac{(t - t_0)^2}{2 \\sigma^2}\\right)\\right]^2 \\mathrm{d}t = \\frac{1}{\\Delta t} \\int_{t_0 - \\frac{\\Delta t}{2}}^{t_0 + \\frac{\\Delta t}{2}} \\exp\\left(-\\frac{(t - t_0)^2}{\\sigma^2}\\right) \\mathrm{d}t\n$$\nLet $u = (t - t_0)/\\sigma$. Then $\\mathrm{d}t = \\sigma \\mathrm{d}u$, and the integration limits change to $[-\\frac{\\Delta t}{2\\sigma}, \\frac{\\Delta t}{2\\sigma}]$.\n$$\n\\langle [S_t]^2 \\rangle_T = \\frac{\\sigma}{\\Delta t} \\int_{-\\frac{\\Delta t}{2\\sigma}}^{\\frac{\\Delta t}{2\\sigma}} e^{-u^2} \\mathrm{d}u\n$$\nThe integral is related to the error function, $\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x e^{-t^2} \\mathrm{d}t$, noting that $\\int_{-a}^{a} f(u) \\mathrm{d}u = 2 \\int_0^a f(u) \\mathrm{d}u$ for an even function $f(u)$ like $e^{-u^2}$.\n$$\n\\int_{-\\frac{\\Delta t}{2\\sigma}}^{\\frac{\\Delta t}{2\\sigma}} e^{-u^2} \\mathrm{d}u = \\sqrt{\\pi} \\, \\mathrm{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\n$$\nThus, the temporal averaging factor is:\n$$\n\\langle [S_t]^2 \\rangle_T = \\frac{\\sigma\\sqrt{\\pi}}{\\Delta t} \\mathrm{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\n$$\nNow we can write the final expressions for the space-time averaged power densities:\n$$\n\\langle p_{\\alpha} \\rangle_{V,T} = (n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{\\alpha}) \\left(\\frac{1}{2\\alpha+1}\\right) \\left(\\frac{\\sigma\\sqrt{\\pi}}{\\Delta t} \\mathrm{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\\right)\n$$\n$$\n\\langle p_{n} \\rangle_{V,T} = (n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{n}) \\left(\\frac{1}{2\\alpha+1}\\right) \\left(\\frac{\\sigma\\sqrt{\\pi}}{\\Delta t} \\mathrm{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\\right)\n$$\nwhere $E_{\\alpha}$ and $E_n$ must be converted from MeV to Joules.\n\nNext, we derive the peaking factors. The spatial peaking factor at time $t_0$ is:\n$$\nPF_r(t_0) = \\frac{p_{\\text{tot}}(r=0, t_0)}{\\langle p_{\\text{tot}} \\rangle_V(t_0)}\n$$\nAt $r=0$ and $t=t_0$, the shape factors are $S_r(0;\\alpha)=1$ and $S_t(t_0;\\sigma,t_0)=1$.\n$p_{\\text{tot}}(r=0, t_0) = n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{\\text{tot}}$.\n$\\langle p_{\\text{tot}} \\rangle_V(t_0) = n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{\\text{tot}} \\cdot \\langle [S_r]^2 \\rangle_V \\cdot [S_t(t_0)]^2 = p_{\\text{tot}}(r=0,t_0) \\cdot \\frac{1}{2\\alpha+1} \\cdot 1$.\n$$\nPF_r(t_0) = \\frac{p_{\\text{tot}}(r=0, t_0)}{p_{\\text{tot}}(r=0, t_0) \\cdot \\frac{1}{2\\alpha+1}} = 2\\alpha+1\n$$\nThe temporal peaking factor is:\n$$\nPF_t = \\frac{p_{\\text{tot}}(r=0, t_0)}{\\langle p_{\\text{tot}}(r=0,\\cdot) \\rangle_T}\n$$\nThe denominator is $\\langle p_{\\text{tot}}(r=0,t) \\rangle_T = \\langle p_{\\text{tot}}(r=0,t_0) [S_t(t)]^2 \\rangle_T = p_{\\text{tot}}(r=0,t_0) \\langle [S_t]^2 \\rangle_T$.\n$$\nPF_t = \\frac{p_{\\text{tot}}(r=0,t_0)}{p_{\\text{tot}}(r=0,t_0) \\langle [S_t]^2 \\rangle_T} = \\frac{1}{\\langle [S_t]^2 \\rangle_T} = \\frac{\\Delta t}{\\sigma\\sqrt{\\pi} \\mathrm{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)}\n$$\nFinally, the global space-time peaking factor is the product of the two:\n$$\nPF_{\\text{global}} = PF_r(t_0) \\cdot PF_t = (2\\alpha+1) \\left(\\frac{\\Delta t}{\\sigma\\sqrt{\\pi} \\mathrm{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)}\\right)\n$$\nThese derived formulas will be implemented in the program to compute the required quantities for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the fusion power density problem by deriving and applying\n    closed-form formulas for space-time averaged power densities and peaking factors.\n    \"\"\"\n    \n    # Define physical constants and conversion factors.\n    EV_TO_J = 1.602176634e-19\n    E_ALPHA_MEV = 3.5  # MeV\n    E_NEUTRON_MEV = 14.1 # MeV\n    \n    # Convert energies to Joules.\n    e_alpha_j = E_ALPHA_MEV * 1e6 * EV_TO_J\n    e_neutron_j = E_NEUTRON_MEV * 1e6 * EV_TO_J\n    \n    # Define the test cases from the problem statement.\n    # Each tuple: (n_D0 [m^-3], n_T0 [m^-3], alpha [-], sigma [s], delta_t [s], sv0 [m^3/s])\n    test_cases = [\n        (5.0e19, 5.0e19, 0.0, 100.0, 1.0, 1.0e-22), # Case A\n        (5.0e19, 5.0e19, 1.0, 0.05, 0.5, 1.0e-22),  # Case B\n        (1.0e20, 1.0e20, 2.0, 0.005, 1.0, 1.2e-22), # Case C\n        (3.0e19, 3.0e19, 9.0, 0.04, 0.2, 8.0e-23)   # Case D\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        n_d0, n_t0, alpha, sigma, delta_t, sv0 = case\n        \n        # Calculate the peak power density coefficients (at r=0, t=t0).\n        peak_power_coeff = n_d0 * n_t0 * sv0\n        p_alpha_peak = peak_power_coeff * e_alpha_j\n        p_neutron_peak = peak_power_coeff * e_neutron_j\n        \n        # Calculate the spatial averaging factor for power (proportional to S_r^2).\n        # F_space = <S_r^2>_V = 1 / (2*alpha + 1)\n        f_space = 1.0 / (2.0 * alpha + 1.0)\n        \n        # Calculate the temporal averaging factor for power (proportional to S_t^2).\n        # F_time = <S_t^2>_T = (sigma*sqrt(pi)/delta_t) * erf(delta_t/(2*sigma))\n        arg_erf = delta_t / (2.0 * sigma)\n        f_time = (sigma * np.sqrt(np.pi) / delta_t) * erf(arg_erf)\n        \n        # Calculate the space-time averaged power densities in W/m^3.\n        p_alpha_avg = p_alpha_peak * f_space * f_time\n        p_neutron_avg = p_neutron_peak * f_space * f_time\n        \n        # Calculate the global peaking factor.\n        # PF_global = PF_r * PF_t = (1/F_space) * (1/F_time)\n        # Avoid division by zero if f_space or f_time are zero, although not expected here.\n        if f_space > 0 and f_time > 0:\n            pf_global = 1.0 / (f_space * f_time)\n        else:\n            pf_global = float('inf') # Should not occur for the given constraints.\n\n        all_results.append([p_alpha_avg, p_neutron_avg, pf_global])\n\n    # Format the final output string to match the problem specification\n    # e.g., [[x1,y1,z1],[x2,y2,z2],...] with no spaces inside sub-lists.\n    sublist_strings = []\n    for result_list in all_results:\n        # Convert each float in the sublist to its string representation\n        # and join them with a comma.\n        formatted_sublist = f\"[{','.join(map(str, result_list))}]\"\n        sublist_strings.append(formatted_sublist)\n    \n    final_output_string = f\"[{','.join(sublist_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "3700259"}]}