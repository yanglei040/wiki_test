{"hands_on_practices": [{"introduction": "This first practice lays the groundwork for understanding resistive MHD by deriving the key parameters from first principles. By starting with the linearized MHD equations, we will extract the characteristic time for ideal plasma dynamics, the Alfvén time ($\\tau_A$), and the time for magnetic fields to dissipate due to resistance, the magnetic diffusion time ($\\tau_R$). This exercise [@problem_id:3707898] demonstrates how their ratio naturally gives rise to the Lundquist number ($S$), the single most important dimensionless parameter for classifying the behavior of a magnetized plasma.", "problem": "A straight, axisymmetric fusion plasma column of minor radius $L$ is modeled by the single-fluid, resistive Magnetohydrodynamics (MHD) equations. The column is permeated by a uniform axial magnetic field of magnitude $B_0$, and has uniform mass density $\\rho$ set by a $50$–$50$ deuterium–tritium ion mixture. The plasma is fully ionized, electrically neutral, and the electron mass is negligible compared to the ion mass. Assume small-amplitude, incompressible perturbations and neglect viscosity and pressure gradients for the purposes of wave dynamics.\n\nStarting from the resistive MHD momentum equation and induction equation, derive expressions for the characteristic Alfvén speed $v_A$, Alfvén time $\\tau_A$ over the scale $L$, and the magnetic diffusion time $\\tau_R$ over the same scale. Using these, derive the dimensionless Lundquist number $S$ as a ratio of the diffusion time scale to the Alfvén time scale. Then evaluate $S$ numerically for the following parameters:\n- Characteristic length $L = 0.50\\,\\mathrm{m}$,\n- Background magnetic field $B_0 = 5.0\\,\\mathrm{T}$,\n- Ion number density $n_i = 1.00 \\times 10^{20}\\,\\mathrm{m}^{-3}$,\n- Average ion mass for a $50$–$50$ deuterium–tritium mixture $m_i = 2.5\\,m_u$, where $m_u = 1.66054 \\times 10^{-27}\\,\\mathrm{kg}$,\n- Parallel Spitzer resistivity $\\eta = 1.00 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$,\n- Vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H}/\\mathrm{m}$.\n\nUse $\\rho = n_i m_i$ for the mass density. Express your final answer as a dimensionless number, and round your result to three significant figures.", "solution": "The problem requires the derivation of the Alfvén speed $v_A$, Alfvén time $\\tau_A$, magnetic diffusion time $\\tau_R$, and the Lundquist number $S$, followed by a numerical evaluation of $S$ for a given set of parameters for a fusion plasma. The analysis is based on the single-fluid, resistive Magnetohydrodynamics (MHD) equations under specific assumptions.\n\nThe fundamental equations for small, incompressible perturbations ($\\mathbf{v}_1$, $\\mathbf{B}_1$) around a static ($\\mathbf{v}_0=0$), uniform equilibrium with magnetic field $\\mathbf{B}_0$ and mass density $\\rho$ are:\nThe linearized momentum equation:\n$$ \\rho \\frac{\\partial \\mathbf{v}_1}{\\partial t} = \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0 $$\nThe linearized induction equation, including resistivity $\\eta$:\n$$ \\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0) + \\frac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B}_1 $$\nWe used the fact that for a uniform field $\\mathbf{B}_0$, its curl is zero ($\\nabla \\times \\mathbf{B}_0 = 0$), and for a uniform resistivity $\\eta$, the resistive term simplifies as shown, using the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$ and the solenoidal condition $\\nabla \\cdot \\mathbf{B} = 0$.\n\nFirst, we derive the characteristic Alfvén speed, $v_A$. This is derived in the ideal MHD limit, where resistivity is neglected ($\\eta=0$). The induction equation becomes:\n$$ \\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0) $$\nWe can perform a dimensional analysis of the two ideal equations over a characteristic length scale $L$ and time scale $\\tau$.\nFrom the momentum equation: $\\rho \\frac{v}{t} \\sim \\frac{B^2}{\\mu_0 L}$. In our case, this is $\\rho \\frac{|\\mathbf{v}_1|}{\\tau} \\sim \\frac{|\\mathbf{B}_1| |\\mathbf{B}_0|}{\\mu_0 L}$.\nFrom the ideal induction equation: $\\frac{B}{t} \\sim \\frac{vB}{L}$. This is $\\frac{|\\mathbf{B}_1|}{\\tau} \\sim \\frac{|\\mathbf{v}_1||\\mathbf{B}_0|}{L}$.\nFrom the second relation, we can express $|\\mathbf{B}_1|$ as $|\\mathbf{B}_1| \\sim \\frac{\\tau |\\mathbf{v}_1| |\\mathbf{B}_0|}{L}$. Substituting this into the first relation gives:\n$$ \\rho \\frac{|\\mathbf{v}_1|}{\\tau} \\sim \\frac{1}{\\mu_0 L} \\left(\\frac{\\tau |\\mathbf{v}_1| |\\mathbf{B}_0|}{L}\\right) |\\mathbf{B}_0| $$\n$$ \\rho \\sim \\frac{\\tau^2 B_0^2}{\\mu_0 L^2} $$\nThe characteristic time scale derived from this balance is the Alfvén time, $\\tau_A$, so we set $\\tau = \\tau_A$. The characteristic speed is the Alfvén speed, $v_A = L/\\tau_A$. Solving for $v_A$:\n$$ v_A^2 = \\frac{L^2}{\\tau_A^2} = \\frac{B_0^2}{\\mu_0 \\rho} $$\nThus, the Alfvén speed is:\n$$ v_A = \\frac{B_0}{\\sqrt{\\mu_0 \\rho}} $$\nThe Alfvén time, $\\tau_A$, is the time for an Alfvén wave to travel the characteristic distance $L$:\n$$ \\tau_A = \\frac{L}{v_A} = \\frac{L\\sqrt{\\mu_0 \\rho}}{B_0} $$\n\nNext, we derive the magnetic diffusion time, $\\tau_R$. This time scale governs the dissipation of magnetic fields due to resistivity. We consider the induction equation in the absence of fluid motion ($\\mathbf{v}=0$):\n$$ \\frac{\\partial \\mathbf{B}}{\\partial t} = \\frac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B} $$\nThis is a diffusion equation with a magnetic diffusivity $D_m = \\eta/\\mu_0$. Performing a dimensional analysis:\n$$ \\frac{|\\mathbf{B}|}{\\tau_R} \\sim \\frac{\\eta}{\\mu_0} \\frac{|\\mathbf{B}|}{L^2} $$\nSolving for the diffusion time $\\tau_R$:\n$$ \\tau_R = \\frac{\\mu_0 L^2}{\\eta} $$\n\nThe Lundquist number, $S$, is the dimensionless ratio of the magnetic diffusion time to the Alfvén time. It quantifies the relative importance of ideal MHD dynamics versus resistive dissipation.\n$$ S = \\frac{\\tau_R}{\\tau_A} $$\nSubstituting the derived expressions for $\\tau_R$ and $\\tau_A$:\n$$ S = \\frac{\\mu_0 L^2 / \\eta}{L\\sqrt{\\mu_0 \\rho} / B_0} = \\frac{\\mu_0 L^2 B_0}{\\eta L \\sqrt{\\mu_0 \\rho}} = \\frac{L B_0 \\sqrt{\\mu_0}}{\\eta \\sqrt{\\rho}} $$\n\nNow, we evaluate $S$ numerically using the given parameters:\n- $L = 0.50\\,\\mathrm{m}$\n- $B_0 = 5.0\\,\\mathrm{T}$\n- Ion number density $n_i = 1.00 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n- Average ion mass for a $50$–$50$ D-T mixture $m_i = 2.5\\,m_u$, where $m_u = 1.66054 \\times 10^{-27}\\,\\mathrm{kg}$. So, $m_i = 2.5 \\times 1.66054 \\times 10^{-27}\\,\\mathrm{kg} = 4.15135 \\times 10^{-27}\\,\\mathrm{kg}$.\n- Parallel Spitzer resistivity $\\eta = 1.00 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$\n- Vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H}/\\mathrm{m}$\n\nFirst, calculate the plasma mass density $\\rho$ using the provided relation $\\rho = n_i m_i$:\n$$ \\rho = (1.00 \\times 10^{20}\\,\\mathrm{m}^{-3}) \\times (4.15135 \\times 10^{-27}\\,\\mathrm{kg}) = 4.15135 \\times 10^{-7}\\,\\mathrm{kg \\cdot m^{-3}} $$\nNow, we can substitute all values into the expression for $S$:\n$$ S = \\frac{(0.50\\,\\mathrm{m}) \\times (5.0\\,\\mathrm{T}) \\times \\sqrt{4\\pi \\times 10^{-7}\\,\\mathrm{H/m}}}{(1.00 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}) \\times \\sqrt{4.15135 \\times 10^{-7}\\,\\mathrm{kg \\cdot m^{-3}}}} $$\n$$ S = \\frac{2.5 \\times \\sqrt{4\\pi \\times 10^{-7}}}{1.00 \\times 10^{-8} \\times \\sqrt{4.15135 \\times 10^{-7}}} = \\frac{2.5 \\times 10^8 \\times \\sqrt{4\\pi \\times 10^{-7}}}{\\sqrt{4.15135 \\times 10^{-7}}} $$\n$$ S = 2.5 \\times 10^8 \\times \\sqrt{\\frac{4\\pi \\times 10^{-7}}{4.15135 \\times 10^{-7}}} = 2.5 \\times 10^8 \\times \\sqrt{\\frac{4\\pi}{4.15135}} $$\n$$ S \\approx 2.5 \\times 10^8 \\times \\sqrt{\\frac{12.56637}{4.15135}} \\approx 2.5 \\times 10^8 \\times \\sqrt{3.0270} $$\n$$ S \\approx 2.5 \\times 10^8 \\times 1.73983 $$\n$$ S \\approx 4.34957 \\times 10^8 $$\nRounding the result to three significant figures, we get $4.35 \\times 10^8$. The large value of $S$ confirms that for a typical fusion plasma, the ideal MHD model is an excellent approximation on macroscopic scales and fast timescales, as resistive effects are comparatively very slow.", "answer": "$$\\boxed{4.35 \\times 10^8}$$", "id": "3707898"}, {"introduction": "Building on our foundational understanding of the Lundquist number, this exercise delves into the underlying physics that determines its value in a real fusion plasma. We will connect the macroscopic parameter of resistivity ($\\eta$) to the microscopic world of electron-ion collisions, justifying its strong dependence on electron temperature ($T_e$) and impurity content ($Z_{\\text{eff}}$). This practice [@problem_id:3707896] highlights why hot, clean plasmas are essential for good confinement, as it allows you to quantify how changes in plasma conditions dramatically alter the balance between ideal behavior and resistive diffusion.", "problem": "A toroidally confined plasma in a magnetic confinement fusion device is modeled within the framework of Resistive Magnetohydrodynamics (MHD). The plasma is predominantly deuterium with a small admixture of fully ionized high-$Z$ impurities such that the mass density is dominated by the deuterium ions and remains effectively constant across the scenarios considered. Assume quasineutrality and that collisional transport is governed by Coulomb interactions with a constant Coulomb logarithm. Consider the following two steady-state scenarios in the same device, with identical magnetic geometry and magnetic field:\n\n- Scenario A (baseline): electron temperature $T_{e,1} = 10\\,\\text{keV}$, effective ion charge $Z_{\\text{eff},1} = 1.6$, electron number density $n_{e,1} = 8.0 \\times 10^{19}\\,\\text{m}^{-3}$, magnetic field $B = 5.0\\,\\text{T}$, characteristic length $L = 0.60\\,\\text{m}$.\n- Scenario B (impurity-enriched, cooler): electron temperature $T_{e,2} = 6.0\\,\\text{keV}$, effective ion charge $Z_{\\text{eff},2} = 2.4$, electron number density $n_{e,2} = 8.0 \\times 10^{19}\\,\\text{m}^{-3}$, same $B$ and $L$ as Scenario A.\n\nStarting from the electron momentum balance and kinetic theory of Coulomb collisions, justify the temperature and impurity (through $Z_{\\text{eff}}$) dependence of the electrical resistivity, and then express the Lundquist number $S$ in terms of appropriate plasma and magnetic parameters together with the resistivity. Treat the Coulomb logarithm as a constant across scenarios, and assume the mass density $\\rho$ is unchanged between scenarios to leading order.\n\nCompute the ratio of Lundquist numbers $S_{2}/S_{1}$ for Scenario B relative to Scenario A. Round your final ratio to three significant figures. The ratio is dimensionless; do not include any units in your final answer.", "solution": "The problem requires a three-part response: first, a justification of the physical dependence of plasma electrical resistivity on temperature and impurity content; second, an expression for the Lundquist number; and third, the calculation of the ratio of Lundquist numbers for two distinct plasma scenarios.\n\nFirst, we address the electrical resistivity, denoted by $\\eta$. In the framework of magnetohydrodynamics (MHD), resistivity arises from the transfer of momentum between electrons and ions during collisions. The starting point is the steady-state electron momentum balance equation:\n$$0 = -e n_e (\\mathbf{E} + \\mathbf{v}_e \\times \\mathbf{B}) - \\nabla p_e - \\mathbf{R}_{ei}$$\nwhere $e$ is the elementary charge, $n_e$ is the electron number density, $\\mathbf{E}$ is the electric field, $\\mathbf{v}_e$ is the electron fluid velocity, $\\mathbf{B}$ is the magnetic field, $p_e$ is the electron pressure, and $\\mathbf{R}_{ei}$ is the total momentum transfer rate per unit volume from electrons to ions due to collisions (the collisional friction force).\n\nOhm's law relates the electric field to the current density, $\\mathbf{j}$. In a simplified form, ignoring Hall and pressure gradient terms, the component parallel to the magnetic field is $\\mathbf{E}_{\\parallel} = \\eta \\mathbf{j}_{\\parallel}$. From the electron momentum balance, taking the component parallel to $\\mathbf{B}$, the $\\mathbf{v}_e \\times \\mathbf{B}$ term vanishes, leaving $e n_e E_{\\parallel} = -R_{ei, \\parallel}$. The parallel current density is carried primarily by the electrons, so $\\mathbf{j}_{\\parallel} \\approx -e n_e \\mathbf{v}_{e,\\parallel}$, assuming the ions are stationary. Thus, the resistivity is given by:\n$$\\eta = \\frac{E_{\\parallel}}{j_{\\parallel}} = \\frac{-R_{ei, \\parallel} / (e n_e)}{-e n_e v_{e,\\parallel}} = \\frac{R_{ei, \\parallel}}{e^2 n_e^2 v_{e,\\parallel}}$$\nwhere $v_{e,\\parallel}$ is the parallel electron fluid velocity relative to the ions.\n\nThe friction force $\\mathbf{R}_{ei}$ is the net result of electron collisions with all ion species present in the plasma. For a single ion species '$s$' with charge $Z_s e$ and number density $n_s$, the friction force is proportional to the momentum lost by an electron per collision and the rate of collisions. It can be expressed as $\\mathbf{R}_{es} = -m_e n_e \\nu_{es} \\mathbf{v}_{e,rel}$, where $m_e$ is the electron mass, $\\nu_{es}$ is the collision frequency of electrons with ion species '$s$', and $\\mathbf{v}_{e,rel}$ is the relative drift velocity between electrons and ions. Summing over all ion species, the total friction force is $\\mathbf{R}_{ei} = \\sum_s \\mathbf{R}_{es}$.\n\nFrom kinetic theory for Coulomb collisions, the collision frequency $\\nu_{es}$ for electrons with thermal velocity $v_{th,e}$ colliding with ions of species '$s$' scales as:\n$$\\nu_{es} \\propto \\frac{n_s (Z_s e)^2 e^2 \\ln \\Lambda}{m_e^2 v_{th,e}^3}$$\nwhere $\\ln \\Lambda$ is the Coulomb logarithm, which we treat as constant. The electron thermal velocity is related to the electron temperature $T_e$ by $\\frac{1}{2}m_e v_{th,e}^2 \\propto k_B T_e$, so $v_{th,e} \\propto T_e^{1/2}$. This leads to the characteristic temperature dependence of the collision frequency: $\\nu_{es} \\propto n_s Z_s^2 T_e^{-3/2}$.\n\nThe total friction force relevant for resistivity involves a sum over all ion species: the total momentum transfer rate is proportional to $\\sum_s n_s Z_s^2$. This sum is conveniently expressed using the effective ion charge, $Z_{\\text{eff}}$, defined as:\n$$Z_{\\text{eff}} = \\frac{\\sum_s n_s Z_s^2}{n_e}$$\nCombining these results, the total effective electron-ion collision frequency scales as $\\nu_{ei,eff} \\propto Z_{\\text{eff}} n_e T_e^{-3/2}$. The resistivity is $\\eta \\propto \\nu_{ei,eff}/n_e$. Therefore, the resistivity scaling is:\n$$\\eta \\propto \\frac{Z_{\\text{eff}} n_e T_e^{-3/2}}{n_e} = \\frac{Z_{\\text{eff}}}{T_e^{3/2}}$$\nThis is the well-known Spitzer resistivity scaling. It shows that resistivity increases with impurity content (higher $Z_{\\text{eff}}$) and decreases strongly with increasing electron temperature.\n\nSecond, we express the Lundquist number, $S$. This dimensionless number represents the ratio of the resistive diffusion timescale, $\\tau_R$, to the Alfvén transit timescale, $\\tau_A$.\n$$S = \\frac{\\tau_R}{\\tau_A}$$\nThe resistive diffusion time is the characteristic time for the magnetic field to diffuse over a length scale $L$. In SI units, this is given by $\\tau_R = \\frac{\\mu_0 L^2}{\\eta}$, where $\\mu_0$ is the vacuum permeability.\nThe Alfvén transit time is the time for an Alfvén wave to propagate across the length scale $L$, given by $\\tau_A = \\frac{L}{v_A}$. The Alfvén speed, $v_A$, is defined as:\n$$v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$$\nwhere $\\rho$ is the plasma mass density.\nCombining these expressions, the Lundquist number is:\n$$S = \\frac{\\mu_0 L^2 / \\eta}{L / v_A} = \\frac{\\mu_0 L v_A}{\\eta} = \\frac{\\mu_0 L}{\\eta} \\left( \\frac{B}{\\sqrt{\\mu_0 \\rho}} \\right) = \\frac{L B \\sqrt{\\mu_0}}{\\eta \\sqrt{\\rho}}$$\n\nThird, we compute the ratio of the Lundquist numbers for Scenario B to Scenario A, $S_2/S_1$. Using the derived expression for $S$:\n$$S_1 = \\frac{L_1 B_1 \\sqrt{\\mu_0}}{\\eta_1 \\sqrt{\\rho_1}} \\quad \\text{and} \\quad S_2 = \\frac{L_2 B_2 \\sqrt{\\mu_0}}{\\eta_2 \\sqrt{\\rho_2}}$$\nThe problem states that the characteristic length $L$, magnetic field $B$, and mass density $\\rho$ are identical in both scenarios ($L_1=L_2$, $B_1=B_2$, $\\rho_1=\\rho_2$). The constant $\\mu_0$ is universal. Therefore, the ratio simplifies to:\n$$\\frac{S_2}{S_1} = \\frac{\\eta_1}{\\eta_2}$$\nUsing the resistivity scaling $\\eta \\propto Z_{\\text{eff}} T_e^{-3/2}$ (since the Coulomb logarithm is assumed constant), we have:\n$$\\frac{\\eta_1}{\\eta_2} = \\frac{C \\cdot Z_{\\text{eff},1} / T_{e,1}^{3/2}}{C \\cdot Z_{\\text{eff},2} / T_{e,2}^{3/2}} = \\frac{Z_{\\text{eff},1}}{Z_{\\text{eff},2}} \\left( \\frac{T_{e,2}}{T_{e,1}} \\right)^{3/2}$$\nSo, the ratio of Lundquist numbers is:\n$$\\frac{S_2}{S_1} = \\frac{Z_{\\text{eff},1}}{Z_{\\text{eff},2}} \\left( \\frac{T_{e,2}}{T_{e,1}} \\right)^{3/2}$$\nWe are given the following values:\n$Z_{\\text{eff},1} = 1.6$, $T_{e,1} = 10.0\\,\\text{keV}$\n$Z_{\\text{eff},2} = 2.4$, $T_{e,2} = 6.0\\,\\text{keV}$\nSubstituting these values into the ratio expression:\n$$\\frac{S_2}{S_1} = \\frac{1.6}{2.4} \\left( \\frac{6.0\\,\\text{keV}}{10.0\\,\\text{keV}} \\right)^{3/2} = \\frac{2}{3} (0.6)^{3/2}$$\nNow, we calculate the numerical value:\n$$(0.6)^{3/2} = 0.6 \\times \\sqrt{0.6} \\approx 0.6 \\times 0.77459667 = 0.46475800$$\n$$\\frac{S_2}{S_1} = \\frac{2}{3} \\times 0.46475800 \\approx 0.30983867$$\nRounding the result to three significant figures, we get $0.310$. This indicates that the plasma in Scenario B is significantly more resistive (shows faster magnetic diffusion) relative to its Alfvén timescale compared to Scenario A, primarily due to the lower temperature and higher impurity content.", "answer": "$$\\boxed{0.310}$$", "id": "3707896"}, {"introduction": "This final practice applies our knowledge of magnetic diffusion to a critical, time-dependent process in tokamak operation: the penetration of the plasma current during start-up. We will model the so-called \"skin effect,\" where the current initially flows only on the plasma surface before slowly diffusing inwards. This computational exercise [@problem_id:3707901] provides a tangible understanding of the magnetic diffusion time ($\\tau_R$) and skin depth ($\\delta(t)$), illustrating how different plasma parameters can lead to vastly different current profiles and operational scenarios.", "problem": "A single-fluid Magnetohydrodynamics (MHD) approximation is applied to a toroidal plasma during current start-up, focusing on magnetic diffusion and the skin effect. Consider a slab representation of the tokamak minor radius, modeled as a one-dimensional semi-infinite conducting medium occupying $x \\ge 0$, with the plasma initially at rest. A step excitation at $x=0$ is applied at $t=0$ such that the magnetic field at the boundary changes abruptly and drives current diffusion into the plasma. The plasma is characterized by resistivity $\\eta$ (electrical resistivity in $\\Omega \\cdot \\mathrm{m}$), mass density $\\rho$ (in $\\mathrm{kg}/\\mathrm{m}^3$), magnetic permeability of free space $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H}/\\mathrm{m}$, and background magnetic field $B$ (in $\\mathrm{T}$). The tokamak minor radius is represented by a characteristic length scale $L$ (in $\\mathrm{m}$).\n\nStarting from fundamental relations:\n- Maxwell–Faraday law $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$,\n- Ampère’s law without displacement current $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$,\n- Ohm’s law $\\mathbf{E} = \\eta \\mathbf{J}$,\nderive the governing equation for magnetic diffusion in the plasma under the assumption of negligible plasma flow and toroidal symmetry. From this, identify the diffusion coefficient in terms of $\\eta$ and $\\mu_0$. Then, for a step change at the boundary, determine the time-dependent current penetration profile and define a skin depth $\\delta(t)$ in terms of the diffusion coefficient by the criterion $J(\\delta(t),t)/J(0,t) = e^{-1}$.\n\nThe Lundquist number $S$ is defined as the ratio of the magnetic diffusion time $\\tau_R$ to the Alfvén transit time $\\tau_A$, with $\\tau_R$ set by magnetic diffusion across the characteristic length $L$ and $\\tau_A$ set by the Alfvén speed. The Alfvén speed $V_A$ is defined by $V_A = B/\\sqrt{\\mu_0 \\rho}$. Use these definitions to express $S$ in terms of $\\mu_0$, $L$, $V_A$, and $\\eta$.\n\nImplement a program that, for each test case, computes:\n1. The Lundquist number $S$ (dimensionless).\n2. The magnetic diffusion time $\\tau_R$ in seconds.\n3. The skin depth $\\delta(t)$ at three specified times $t_1$, $t_2$, and $t_3$ in meters, based on the skin effect for a step boundary excitation and the diffusion equation.\n4. The ratio $r = J(\\delta(t_3), t_3)/J(0, t_3)$ (dimensionless), which should equal $e^{-1}$ if the derivation and computation are consistent.\n\nUse the following test suite values (all in the International System of Units (SI)):\n\n- Test case 1 (high confinement core-like parameters):\n  - $L = 1.0\\,\\mathrm{m}$,\n  - $B = 5.0\\,\\mathrm{T}$,\n  - $n_i = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$,\n  - $m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$,\n  - $\\eta = 1.0 \\times 10^{-8}\\,\\Omega \\cdot \\mathrm{m}$,\n  - $t_1 = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, $t_2 = 1.0 \\times 10^{-3}\\,\\mathrm{s}$, $t_3 = 1.0 \\times 10^{-1}\\,\\mathrm{s}$.\n\n- Test case 2 (edge-like parameters with higher resistivity):\n  - $L = 0.5\\,\\mathrm{m}$,\n  - $B = 2.0\\,\\mathrm{T}$,\n  - $n_i = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$,\n  - $m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$,\n  - $\\eta = 1.0 \\times 10^{-5}\\,\\Omega \\cdot \\mathrm{m}$,\n  - $t_1 = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, $t_2 = 1.0 \\times 10^{-3}\\,\\mathrm{s}$, $t_3 = 1.0 \\times 10^{-1}\\,\\mathrm{s}$.\n\n- Test case 3 (small-scale, high-resistivity transient):\n  - $L = 0.05\\,\\mathrm{m}$,\n  - $B = 1.0\\,\\mathrm{T}$,\n  - $n_i = 1.0 \\times 10^{18}\\,\\mathrm{m}^{-3}$,\n  - $m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$,\n  - $\\eta = 1.0 \\times 10^{-3}\\,\\Omega \\cdot \\mathrm{m}$,\n  - $t_1 = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, $t_2 = 1.0 \\times 10^{-3}\\,\\mathrm{s}$, $t_3 = 1.0 \\times 10^{-1}\\,\\mathrm{s}$.\n\nFor all computations:\n- Use $\\rho = n_i m_i$.\n- Express $\\tau_R$ in $\\mathrm{s}$, $\\delta(t)$ in $\\mathrm{m}$, and $S$ as dimensionless.\n- Round every reported float to six decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1, result_2, \\ldots]$).\n- Append the results of the test cases in order. For each test case, append six numbers in the sequence $[S, \\tau_R, \\delta(t_1), \\delta(t_2), \\delta(t_3), r]$.\n- The single final line must therefore contain $18$ comma-separated numbers enclosed in one pair of square brackets.", "solution": "The objective is to connect magnetic diffusion and the Lundquist number in a tokamak-relevant setting and to produce a computational implementation for a defined test suite. The derivation proceeds from core electrodynamics and the Magnetohydrodynamics (MHD) reduction.\n\nStarting point and assumptions:\n- The plasma is treated as a conducting medium with resistivity $\\eta$ and is initially at rest, so advection by flow is negligible during the start-up diffusion ($\\mathbf{v} \\approx \\mathbf{0}$).\n- We adopt a one-dimensional slab geometry for the minor radius, $x \\ge 0$, which captures the radial diffusion of magnetic fields and current.\n\nFrom Maxwell–Faraday law, Ohm’s law, and Ampère’s law:\n- Maxwell–Faraday: $\\nabla \\times \\mathbf{E} = -\\dfrac{\\partial \\mathbf{B}}{\\partial t}$.\n- Ohm: $\\mathbf{E} = \\eta \\mathbf{J}$.\n- Ampère (no displacement current): $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$.\n\nElimination of $\\mathbf{E}$ and $\\mathbf{J}$ yields the induction equation. Taking the curl of Ohm’s law and substituting via Ampère’s law:\n$$\n\\nabla \\times \\mathbf{E} = \\nabla \\times (\\eta \\mathbf{J}) = \\eta \\nabla \\times \\mathbf{J} = \\eta \\nabla \\times \\left(\\dfrac{1}{\\mu_0} \\nabla \\times \\mathbf{B}\\right).\n$$\nUsing Maxwell–Faraday:\n$$\n-\\dfrac{\\partial \\mathbf{B}}{\\partial t} = \\dfrac{\\eta}{\\mu_0} \\nabla \\times (\\nabla \\times \\mathbf{B}).\n$$\nFor homogeneous $\\eta$ and in the absence of magnetic monopoles ($\\nabla \\cdot \\mathbf{B} = 0$), the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B}$ reduces this to:\n$$\n\\dfrac{\\partial \\mathbf{B}}{\\partial t} = \\dfrac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B}.\n$$\nThis is the magnetic diffusion equation, identical in form to the heat equation with diffusion coefficient\n$$\nD = \\dfrac{\\eta}{\\mu_0}.\n$$\n\nSkin effect for a step boundary excitation:\nConsider a semi-infinite domain $x \\ge 0$ with an abrupt boundary change of magnetic field at $x=0$ applied at $t=0$. The diffusion equation with boundary condition $B(0,t) = B_0$ for $t \\ge 0$ and initial condition $B(x,0) = 0$ has the similarity solution\n$$\nB(x,t) = B_0 \\,\\mathrm{erfc}\\!\\left(\\dfrac{x}{2\\sqrt{D t}}\\right),\n$$\nwhere $\\mathrm{erfc}$ is the complementary error function. The associated current density profile, using Ampère’s law in slab form ($\\partial B/\\partial x = \\mu_0 J$ for appropriate orientation), is\n$$\nJ(x,t) = \\dfrac{1}{\\mu_0}\\dfrac{\\partial B}{\\partial x} = \\dfrac{B_0}{\\mu_0} \\left[-\\dfrac{1}{\\sqrt{\\pi D t}} \\exp\\!\\left(-\\dfrac{x^2}{4 D t}\\right)\\right].\n$$\nUp to a sign that depends on the chosen orientation of $\\mathbf{B}$ and the current direction, the magnitude of $J$ decays as a Gaussian in $x$ with a time-dependent scale set by $D t$. The ratio of the profile to its boundary value is\n$$\n\\dfrac{J(x,t)}{J(0,t)} = \\exp\\!\\left(-\\dfrac{x^2}{4 D t}\\right).\n$$\nDefine the skin depth $\\delta(t)$ by the $1/e$ criterion:\n$$\n\\dfrac{J(\\delta(t),t)}{J(0,t)} = e^{-1} \\quad \\Rightarrow \\quad \\exp\\!\\left(-\\dfrac{\\delta(t)^2}{4 D t}\\right) = e^{-1}.\n$$\nSolving for $\\delta(t)$ gives\n$$\n\\delta(t) = 2\\sqrt{D t}.\n$$\nThis is the transient skin depth for step excitation in a diffusive conductor.\n\nMagnetic diffusion time and Lundquist number:\nA characteristic magnetic diffusion time across a length scale $L$ is\n$$\n\\tau_R = \\dfrac{\\mu_0 L^2}{\\eta}.\n$$\nThe Alfvén speed is defined by\n$$\nV_A = \\dfrac{B}{\\sqrt{\\mu_0 \\rho}},\n$$\nand the Alfvén transit time is $\\tau_A = L / V_A$. The Lundquist number is the ratio of these times,\n$$\nS = \\dfrac{\\tau_R}{\\tau_A} = \\dfrac{\\mu_0 L V_A}{\\eta}.\n$$\nThis dimensionless number compares ideal, wave-mediated transport to resistive diffusion. Large $S$ indicates the dominance of ideal MHD effects over resistive diffusion on the scale $L$.\n\nAlgorithmic design:\n- Input parameters per test case: $L$, $B$, $n_i$, $m_i$, $\\eta$, and times $t_1$, $t_2$, $t_3$.\n- Compute mass density $\\rho = n_i m_i$.\n- Compute Alfvén speed $V_A = B / \\sqrt{\\mu_0 \\rho}$.\n- Compute magnetic diffusion time $\\tau_R = \\mu_0 L^2 / \\eta$.\n- Compute Lundquist number $S = \\mu_0 L V_A / \\eta$.\n- Compute diffusion coefficient $D = \\eta / \\mu_0$.\n- Compute skin depths $\\delta(t_k) = 2 \\sqrt{D t_k}$ for $k \\in \\{1,2,3\\}$.\n- Compute ratio $r = \\exp\\!\\left(-\\dfrac{\\delta(t_3)^2}{4 D t_3}\\right)$, which should be exactly $e^{-1}$ in the ideal derivation. Numerical rounding will produce $r \\approx e^{-1}$.\n- Round all outputs to six decimal places before printing.\n- Produce a single-line output containing the concatenated results from all test cases in the order $[S, \\tau_R, \\delta(t_1), \\delta(t_2), \\delta(t_3), r]$ for each case.\n\nScientific realism:\nThe parameter choices reflect plausible tokamak core, edge, and small-scale high-resistivity transient conditions. The diffusion coefficient values and resulting skin depths span orders of magnitude, testing both rapid and slow diffusion regimes. The Lundquist numbers range from very large (typical core) to moderately small, checking both ideal-like and resistive-dominated regimes.\n\nEdge cases and coverage:\n- Test case 1 validates high-$S$ behavior with slow diffusion and small transient skin depth.\n- Test case 2 examines intermediate-$S$ behavior with increased resistivity and significant transient skin depth.\n- Test case 3 probes fast diffusion at small scale with high resistivity, where $\\tau_R$ is very short and $\\delta(t)$ quickly exceeds $L$.\n\nAll reported quantities are dimensionally consistent:\n- $S$ is dimensionless,\n- $\\tau_R$ is in seconds,\n- $\\delta(t)$ is in meters,\n- $r$ is dimensionless.\n\nThe final program computes these values directly from the derived expressions and produces the specified single-line output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_case(L, B, n_i, m_i, eta, times):\n    \"\"\"\n    Compute S, tau_R, delta(t1), delta(t2), delta(t3), r for a given test case.\n    All calculations use SI units.\n    \"\"\"\n    mu0 = 4.0 * np.pi * 1e-7  # H/m\n    rho = n_i * m_i           # kg/m^3\n    # Alfvén speed\n    VA = B / np.sqrt(mu0 * rho)\n    # Magnetic diffusion time\n    tau_R = mu0 * L**2 / eta\n    # Lundquist number\n    S = mu0 * L * VA / eta\n    # Diffusion coefficient\n    D = eta / mu0\n    # Skin depths at specified times\n    deltas = [2.0 * np.sqrt(D * t) for t in times]\n    # Ratio at the last time using derived current profile\n    t_last = times[-1]\n    delta_last = deltas[-1]\n    r = np.exp(- (delta_last**2) / (4.0 * D * t_last))\n    return S, tau_R, deltas, r\n\ndef format_number(x):\n    # Format float to six decimal places without scientific notation if possible.\n    return f\"{x:.6f}\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L [m], B [T], n_i [1/m^3], m_i [kg], eta [Ohm*m], [t1, t2, t3] [s])\n        (1.0, 5.0, 1.0e20, 3.344e-27, 1.0e-8, [1.0e-6, 1.0e-3, 1.0e-1]),\n        (0.5, 2.0, 5.0e19, 3.344e-27, 1.0e-5, [1.0e-6, 1.0e-3, 1.0e-1]),\n        (0.05, 1.0, 1.0e18, 3.344e-27, 1.0e-3, [1.0e-6, 1.0e-3, 1.0e-1]),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, B, n_i, m_i, eta, times = case\n        S, tau_R, deltas, r = compute_case(L, B, n_i, m_i, eta, times)\n        # Append in the specified order: S, tau_R, delta(t1), delta(t2), delta(t3), r\n        results.extend([\n            format_number(S),\n            format_number(tau_R),\n            format_number(deltas[0]),\n            format_number(deltas[1]),\n            format_number(deltas[2]),\n            format_number(r),\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3707901"}]}