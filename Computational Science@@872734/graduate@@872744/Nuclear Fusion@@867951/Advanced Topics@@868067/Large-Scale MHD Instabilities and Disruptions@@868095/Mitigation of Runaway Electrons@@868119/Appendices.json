{"hands_on_practices": [{"introduction": "To effectively mitigate runaway electrons, a primary strategy is to rapidly increase the plasma density through massive impurity injection, enhancing collisional drag. This exercise provides practical experience in performing the essential calculations needed to size such a system for a large tokamak like ITER. By working through this problem, you will connect fundamental principles of particle conservation to the real-world engineering challenge of delivering a required mass of impurities within the critical timescale of a plasma disruption ([@problem_id:3709741]).", "problem": "Runaway electron suppression in tokamak disruptions relies on rapidly increasing the free electron density to enhance collisional drag. Consider a pre-disruption International Thermonuclear Experimental Reactor (ITER) plasma with volume $V = 8.30 \\times 10^{2}\\ \\mathrm{m^3}$ and electron density $n_{e,0} = 1.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$. To mitigate runaway electrons, the operational target is $n_{e,\\mathrm{target}} = 1.0 \\times 10^{21}\\ \\mathrm{m^{-3}}$ during the Current Quench (CQ). An impurity injection using neon is planned via Shattered Pellet Injection (SPI), with an assimilation fraction $f_{a} = 0.30$ (meaning only a fraction of injected atoms ablate and ionize in the plasma) and an average of $q_{e} = 8$ free electrons produced per ionized neon atom during the CQ interval. Assume neon atomic mass number $A = 20$ and the atomic mass unit $m_{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$. The CQ timescale is $t_{\\mathrm{CQ}} = 4.0 \\times 10^{-2}\\ \\mathrm{s}$. A single SPI shot can deliver a mass $M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$ of neon over a deposition duration $t_{\\mathrm{dep}} = 8.0 \\times 10^{-3}\\ \\mathrm{s}$.\n\nStarting from conservation of particle number and the definition of electron density $n_{e} = N_{e}/V$, derive the impurity mass $M_{\\mathrm{req}}$ required to raise the free electron density from $n_{e,0}$ to $n_{e,\\mathrm{target}}$ under the given assimilation and ionization assumptions. Then, compute the minimum mass injection rate $R_{\\mathrm{req}}$ needed to achieve this increase within $t_{\\mathrm{CQ}}$, and compare it to the SPI capability $R_{\\mathrm{SPI}} = M_{\\mathrm{SPI}}/t_{\\mathrm{dep}}$ to assess whether SPI can deliver the required mass within the CQ timescale.\n\nExpress the final answer as the required impurity mass $M_{\\mathrm{req}}$ in $\\mathrm{kg}$. Round your final numerical value to $3$ significant figures.", "solution": "The user has requested a solution to a problem in plasma physics concerning the mitigation of runaway electrons in a tokamak. I will first validate the problem statement and then provide a complete, reasoned solution if it is deemed valid.\n\n### Step 1: Extract Givens\n- Plasma volume: $V = 8.30 \\times 10^{2}\\ \\mathrm{m^3}$\n- Initial electron density: $n_{e,0} = 1.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$\n- Target electron density: $n_{e,\\mathrm{target}} = 1.0 \\times 10^{21}\\ \\mathrm{m^{-3}}$\n- Impurity: Neon\n- Assimilation fraction: $f_{a} = 0.30$\n- Average free electrons per ionized neon atom: $q_{e} = 8$\n- Neon atomic mass number: $A = 20$\n- Atomic mass unit: $m_{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$\n- Current Quench (CQ) timescale: $t_{\\mathrm{CQ}} = 4.0 \\times 10^{-2}\\ \\mathrm{s}$\n- Mass per single SPI shot: $M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$\n- Deposition duration for SPI: $t_{\\mathrm{dep}} = 8.0 \\times 10^{-3}\\ \\mathrm{s}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with a standard runaway electron mitigation technique (impurity injection) in fusion plasmas. The physical principles involved are particle conservation and basic definitions of density and mass. The given values for plasma parameters (volume, density) are consistent with a large tokamak like ITER. The problem is quantitatively stated, well-posed, objective, and self-contained, with all necessary information provided. There are no contradictions, scientific flaws, or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe problem requires the derivation and calculation of the impurity mass needed to increase the plasma electron density, followed by an assessment of the injection system's capability.\n\n1.  **Calculate the Required Number of Additional Electrons**\n    The electron density $n_e$ is defined as the total number of free electrons $N_e$ per unit volume $V$, such that $n_e = N_e / V$.\n    The initial number of free electrons in the plasma is $N_{e,0} = n_{e,0} V$.\n    The target number of free electrons is $N_{e,\\mathrm{target}} = n_{e,\\mathrm{target}} V$.\n    The required increase in the number of free electrons, $\\Delta N_e$, is the difference between the target and initial numbers:\n    $$ \\Delta N_e = N_{e,\\mathrm{target}} - N_{e,0} = (n_{e,\\mathrm{target}} - n_{e,0})V $$\n    Substituting the given values:\n    $$ \\Delta N_e = (1.0 \\times 10^{21}\\ \\mathrm{m^{-3}} - 1.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) \\times (8.30 \\times 10^{2}\\ \\mathrm{m^3}) $$\n    $$ \\Delta N_e = (9.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) \\times (8.30 \\times 10^{2}\\ \\mathrm{m^3}) = 7.47 \\times 10^{23} $$\n\n2.  **Derive the Required Impurity Mass, $M_{\\mathrm{req}}$**\n    The additional electrons, $\\Delta N_e$, are supplied by the ionization of injected neon atoms.\n    Let $N_{\\mathrm{Ne, injected}}$ be the total number of neon atoms injected into the plasma.\n    The assimilation fraction, $f_a$, is the fraction of these atoms that are successfully assimilated (ablated and ionized). The number of assimilated neon atoms is $N_{\\mathrm{Ne, assim}} = f_a N_{\\mathrm{Ne, injected}}$.\n    Each assimilated neon atom contributes an average of $q_e$ free electrons. The total number of electrons added is therefore:\n    $$ \\Delta N_e = q_e N_{\\mathrm{Ne, assim}} = q_e f_a N_{\\mathrm{Ne, injected}} $$\n    We can now solve for the required number of injected neon atoms:\n    $$ N_{\\mathrm{Ne, injected}} = \\frac{\\Delta N_e}{q_e f_a} = \\frac{(n_{e,\\mathrm{target}} - n_{e,0})V}{q_e f_a} $$\n    The mass of a single neon atom, $m_{\\mathrm{Ne}}$, is its atomic mass number $A$ multiplied by the atomic mass unit $m_u$:\n    $$ m_{\\mathrm{Ne}} = A m_u $$\n    The total required mass of neon, $M_{\\mathrm{req}}$, is the number of injected atoms multiplied by the mass per atom:\n    $$ M_{\\mathrm{req}} = N_{\\mathrm{Ne, injected}} \\times m_{\\mathrm{Ne}} = \\frac{(n_{e,\\mathrm{target}} - n_{e,0})V A m_u}{q_e f_a} $$\n    Substituting the numerical values into this expression:\n    $$ M_{\\mathrm{req}} = \\frac{(9.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) \\times (8.30 \\times 10^{2}\\ \\mathrm{m^3}) \\times 20 \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg})}{8 \\times 0.30} $$\n    $$ M_{\\mathrm{req}} = \\frac{(7.47 \\times 10^{23}) \\times 20 \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg})}{2.4} $$\n    $$ M_{\\mathrm{req}} = \\frac{2.48085... \\times 10^{-2}\\ \\mathrm{kg}}{2.4} \\approx 1.0336875 \\times 10^{-2}\\ \\mathrm{kg} $$\n    Rounding to $3$ significant figures as requested, the required impurity mass is:\n    $$ M_{\\mathrm{req}} \\approx 1.03 \\times 10^{-2}\\ \\mathrm{kg} $$\n\n3.  **Assess Injection Capability**\n    Next, we compute the minimum required mass injection rate, $R_{\\mathrm{req}}$, needed to deliver this mass within the Current Quench (CQ) timescale, $t_{\\mathrm{CQ}} = 4.0 \\times 10^{-2}\\ \\mathrm{s}$:\n    $$ R_{\\mathrm{req}} = \\frac{M_{\\mathrm{req}}}{t_{\\mathrm{CQ}}} = \\frac{1.0336875 \\times 10^{-2}\\ \\mathrm{kg}}{4.0 \\times 10^{-2}\\ \\mathrm{s}} \\approx 0.258\\ \\mathrm{kg/s} $$\n    Now, we compute the capability of the Shattered Pellet Injection (SPI) system. The mass delivered in a single shot is $M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$, and the deposition duration is $t_{\\mathrm{dep}} = 8.0 \\times 10^{-3}\\ \\mathrm{s}$. The SPI system's mass injection rate is:\n    $$ R_{\\mathrm{SPI}} = \\frac{M_{\\mathrm{SPI}}}{t_{\\mathrm{dep}}} = \\frac{2.0 \\times 10^{-1}\\ \\mathrm{kg}}{8.0 \\times 10^{-3}\\ \\mathrm{s}} = 25\\ \\mathrm{kg/s} $$\n    To assess if the SPI system is adequate, we compare the requirements with the capabilities:\n    -   **Mass Comparison**: $M_{\\mathrm{req}} \\approx 1.03 \\times 10^{-2}\\ \\mathrm{kg}$ versus $M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$. Since $M_{\\mathrm{SPI}}  M_{\\mathrm{req}}$, a single SPI shot contains sufficient mass.\n    -   **Rate Comparison**: $R_{\\mathrm{req}} \\approx 0.258\\ \\mathrm{kg/s}$ versus $R_{\\mathrm{SPI}} = 25\\ \\mathrm{kg/s}$. Since $R_{\\mathrm{SPI}} \\gg R_{\\mathrm{req}}$, the SPI system can inject mass at a rate far exceeding the minimum required rate.\n    The time it would take for the SPI system to inject the required mass is $t_{\\mathrm{inject}} = M_{\\mathrm{req}} / R_{\\mathrm{SPI}} \\approx (1.03 \\times 10^{-2}\\ \\mathrm{kg}) / (25\\ \\mathrm{kg/s}) \\approx 4.1 \\times 10^{-4}\\ \\mathrm{s}$. This time is much shorter than the allowed CQ timescale ($t_{\\mathrm{inject}} \\ll t_{\\mathrm{CQ}}$). Therefore, the SPI system is fully capable of delivering the required mass within the specified CQ timescale.\n\nThe final answer is the required impurity mass $M_{\\mathrm{req}}$.", "answer": "$$\n\\boxed{1.03 \\times 10^{-2}}\n$$", "id": "3709741"}, {"introduction": "Beyond increasing collisional drag, another powerful mitigation technique is to deconfine runaway electrons by deliberately destroying the magnetic flux surfaces, enhancing their radial transport. This practice explores the physics of runaway transport in a stochastic magnetic field, which can be induced by external coils. You will apply a random walk model to derive a runaway diffusion coefficient and estimate the characteristic confinement time, a key parameter for assessing whether runaways can be removed faster than they are generated by the avalanche mechanism ([@problem_id:3709752]).", "problem": "Runaway electrons (REs) in magnetically confined fusion plasmas can experience cross-field transport due to stochastic magnetic perturbations created for mitigation. Consider a plasma with a small-amplitude magnetic perturbation characterized by a relative fluctuation $\\delta B / B$ and a parallel correlation length $L_{c}$. A runaway electron travels predominantly along the magnetic field at speed $v_{\\parallel} \\approx c$, where $c$ is the speed of light in vacuum. Model the radial transport as a random walk produced by decorrelated field-line segments of length $L_{c}$ along the magnetic field, with each step producing a radial displacement determined by the local ratio of perturbation to total magnetic field.\n\nStarting from the following fundamental bases:\n- Field-aligned guiding-center motion with $ds/dt = v_{\\parallel}$, where $s$ is the coordinate along the magnetic field.\n- The small-ripple approximation for the radial component of the field, $dr/ds \\sim B_{r}/B \\sim \\delta B/B$, so that the typical radial step accumulated over one parallel correlation length is of order $\\Delta r \\sim (\\delta B/B)\\,L_{c}$.\n- The uncorrelated-step random-walk relation for the diffusion coefficient in one dimension, $D \\sim (\\Delta r)^{2}/(2\\,\\tau_{c})$, where $\\tau_{c}$ is the step decorrelation time.\n\nDerive an expression for the runaway-electron radial diffusion coefficient $D_{r}$ in terms of $v_{\\parallel}$, $L_{c}$, and $\\delta B/B$. Then, using the one-dimensional mean-square displacement relation $\\langle r^{2}\\rangle = 2 D_{r} t$, obtain a characteristic diffusive confinement time $\\tau_{\\mathrm{conf}}$ to traverse a radial distance of order the minor radius $a$.\n\nFor numerical evaluation, use:\n- $\\delta B/B = 10^{-3}$,\n- $L_{c} = 5\\ \\mathrm{m}$,\n- $a = 0.5\\ \\mathrm{m}$,\n- $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$,\n- A representative avalanche multiplication growth rate $\\gamma_{\\mathrm{ava}} = 3.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$.\n\nCompute the following, rounding each to four significant figures:\n1. The diffusion coefficient $D_{r}$ (express in $\\mathrm{m^{2}/s}$).\n2. The confinement time $\\tau_{\\mathrm{conf}}$ (express in $\\mathrm{s}$).\n3. The dimensionless comparison metric $\\gamma_{\\mathrm{ava}}\\,\\tau_{\\mathrm{conf}}$.\n\nProvide the final answer as a single row matrix containing these three quantities in the order listed above. Do not include units inside the matrix; use the units specified above in your working.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the established theory of particle transport in stochastic magnetic fields, a key topic in fusion plasma physics. The problem is well-posed, with a clear objective and sufficient data to derive a unique solution. The language is objective and free of ambiguity.\n\nThe derivation and calculation proceed as follows.\n\nFirst, we derive an expression for the runaway-electron radial diffusion coefficient, $D_{r}$. The problem provides a model based on a random walk. The three fundamental bases are:\n$1.$ The decorrelation time, $\\tau_{c}$, is the time it takes for a runaway electron moving at speed $v_{\\parallel}$ to travel one parallel correlation length, $L_{c}$. From the relation $ds/dt = v_{\\parallel}$, for a distance $\\Delta s = L_{c}$, the time interval is $\\Delta t = \\tau_{c} = \\frac{L_{c}}{v_{\\parallel}}$.\n$2.$ The characteristic radial step size, $\\Delta r$, over this length is given by $\\Delta r \\sim (\\delta B/B)\\,L_{c}$. We formalize this model by treating the proportionality as an equality: $\\Delta r = \\left(\\frac{\\delta B}{B}\\right)L_{c}$.\n$3.$ The radial diffusion coefficient is given by the one-dimensional random-walk relation $D \\sim (\\Delta r)^{2}/(2\\,\\tau_{c})$. Again, we treat this as an equality for our model: $D_{r} = \\frac{(\\Delta r)^{2}}{2\\tau_{c}}$.\n\nSubstituting the expressions for $\\Delta r$ and $\\tau_{c}$ into the formula for $D_{r}$:\n$$\nD_{r} = \\frac{\\left[ \\left(\\frac{\\delta B}{B}\\right)L_{c} \\right]^{2}}{2\\left(\\frac{L_{c}}{v_{\\parallel}}\\right)} = \\frac{\\left(\\frac{\\delta B}{B}\\right)^{2}L_{c}^{2}}{\\frac{2L_{c}}{v_{\\parallel}}}\n$$\nSimplifying the expression yields:\n$$\nD_{r} = \\frac{1}{2} L_{c} v_{\\parallel} \\left(\\frac{\\delta B}{B}\\right)^{2}\n$$\nThe problem states that runaway electrons travel predominantly along the magnetic field at speed $v_{\\parallel} \\approx c$, where $c$ is the speed of light. Thus, we substitute $v_{\\parallel} = c$:\n$$\nD_{r} = \\frac{1}{2} L_{c} c \\left(\\frac{\\delta B}{B}\\right)^{2}\n$$\nThis is the required expression for the runaway-electron radial diffusion coefficient.\n\nNext, we derive the characteristic diffusive confinement time, $\\tau_{\\mathrm{conf}}$. We are given the one-dimensional mean-square displacement relation $\\langle r^{2}\\rangle = 2 D_{r} t$. The confinement time $\\tau_{\\mathrm{conf}}$ is defined as the time $t$ required for the root-mean-square displacement, $\\sqrt{\\langle r^{2}\\rangle}$, to become equal to the minor radius, $a$.\n$$\n\\sqrt{\\langle r^{2}\\rangle} = a \\implies \\langle r^{2}\\rangle = a^{2}\n$$\nSubstituting this into the displacement relation at $t = \\tau_{\\mathrm{conf}}$:\n$$\na^{2} = 2 D_{r} \\tau_{\\mathrm{conf}}\n$$\nSolving for $\\tau_{\\mathrm{conf}}$:\n$$\n\\tau_{\\mathrm{conf}} = \\frac{a^{2}}{2D_{r}}\n$$\nSubstituting our previously derived expression for $D_{r}$:\n$$\n\\tau_{\\mathrm{conf}} = \\frac{a^{2}}{2 \\left[ \\frac{1}{2} L_{c} c \\left(\\frac{\\delta B}{B}\\right)^{2} \\right]} = \\frac{a^{2}}{L_{c} c \\left(\\frac{\\delta B}{B}\\right)^{2}}\n$$\nThis is the required expression for the confinement time.\n\nFinally, we compute the numerical values for $D_{r}$, $\\tau_{\\mathrm{conf}}$, and the dimensionless metric $\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}}$ using the provided data:\n- $\\delta B/B = 10^{-3}$\n- $L_{c} = 5\\ \\mathrm{m}$\n- $a = 0.5\\ \\mathrm{m}$\n- $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$\n- $\\gamma_{\\mathrm{ava}} = 3.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$\n\n$1.$ Calculation of the diffusion coefficient $D_{r}$:\n$$\nD_{r} = \\frac{1}{2} (5) (2.998 \\times 10^{8}) (10^{-3})^{2} = (2.5) (2.998 \\times 10^{8}) (10^{-6}) = 7.495 \\times 10^{2} = 749.5\\ \\mathrm{m^{2}/s}\n$$\nRounding to four significant figures, $D_{r} = 749.5\\ \\mathrm{m^{2}/s}$.\n\n$2.$ Calculation of the confinement time $\\tau_{\\mathrm{conf}}$:\nUsing the expression in terms of $D_r$ for precision:\n$$\n\\tau_{\\mathrm{conf}} = \\frac{a^{2}}{2D_{r}} = \\frac{(0.5)^{2}}{2(749.5)} = \\frac{0.25}{1499} \\approx 1.6677785 \\times 10^{-4}\\ \\mathrm{s}\n$$\nRounding to four significant figures, $\\tau_{\\mathrm{conf}} = 1.668 \\times 10^{-4}\\ \\mathrm{s}$.\n\n$3.$ Calculation of the dimensionless comparison metric $\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}}$:\n$$\n\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}} = (3.0 \\times 10^{3}) \\times (1.6677785 \\times 10^{-4}) \\approx 0.50033355\n$$\nRounding to four significant figures, $\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}} = 0.5003$. This metric compares the timescale for runaway loss ($\\tau_{\\mathrm{conf}}$) with the timescale for avalanche multiplication ($1/\\gamma_{\\mathrm{ava}}$). A value below unity suggests that mitigation is effective.\n\nThe final numerical results, rounded to four significant figures, are:\n- $D_{r} = 749.5\\ \\mathrm{m^{2}/s}$\n- $\\tau_{\\mathrm{conf}} = 1.668 \\times 10^{-4}\\ \\mathrm{s}$\n- $\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}} = 0.5003$", "answer": "$$\n\\boxed{\\begin{pmatrix} 749.5  1.668 \\times 10^{-4}  0.5003 \\end{pmatrix}}\n$$", "id": "3709752"}, {"introduction": "The ultimate success of any mitigation strategy depends on the dynamic interplay between the generation and loss of runaway electrons over the course of a disruption. This final exercise moves from static analysis to dynamic modeling, challenging you to implement a numerical model of the runaway avalanche process. By integrating the avalanche growth rate over time with evolving plasma conditions, you will simulate a mitigation scenario and directly compute the final runaway current, providing a quantitative measure of the mitigation system's effectiveness ([@problem_id:3709726]).", "problem": "Consider a spatially uniform, fully ionized plasma column in which a background electric field $E(t)$ and electron number density $n_e(t)$ vary in time but are uniform in space. Assume that newly runaway electrons move ultrarelativistically along the electric field direction with speed $c$ once generated, and neglect pitch-angle dynamics, radiation reaction, partial screening, and spatial transport. Starting from the Lorentz force and the classical Coulomb collision picture for relativistic electrons, derive the time-dependent avalanche multiplication rate $\\gamma_{\\mathrm{ava}}(t)$ under the Rosenbluth–Putvinski avalanche mechanism assumptions, expressed in terms of fundamental constants, the Coulomb logarithm, the classical electron radius, and the critical electric field obtained by balancing electric acceleration and collisional drag. Use this derived $\\gamma_{\\mathrm{ava}}(t)$ to compute the exponential amplification of an initial seed population of runaway electrons.\n\nDefinitions and assumptions to use:\n- The elementary charge is $e$, the electron mass is $m_e$, the vacuum permittivity is $\\varepsilon_0$, and the speed of light is $c$.\n- The classical electron radius is $r_e = \\dfrac{e^2}{4\\pi \\varepsilon_0 m_e c^2}$.\n- The Coulomb logarithm is a given constant $\\ln\\Lambda$.\n- The critical electric field $E_c(t)$ is defined by equating the electric acceleration force $e E(t)$ to the relativistic collisional drag force for electrons moving at speed $c$.\n- Let the initial runaway electron fraction be $f_{\\mathrm{seed}}$, defined as $f_{\\mathrm{seed}} = \\dfrac{n_{\\mathrm{RE}}(0)}{n_e(0)}$.\n- The runaway electron number evolves as $n_{\\mathrm{RE}}(t) = n_{\\mathrm{RE}}(0)\\exp\\left(\\int_0^t \\gamma_{\\mathrm{ava}}(t')\\,\\mathrm{d}t'\\right)$ in the avalanche regime; if $E(t) \\le E_c(t)$ the avalanche source should not amplify, consistent with the derived expression.\n- Define the final runaway current fraction at final time $T$ as $f_I(T) = \\dfrac{j_{\\mathrm{RE}}(T)}{e n_e(T) c}$, which reduces under the ultrarelativistic assumption to $f_I(T) = \\dfrac{n_{\\mathrm{RE}}(T)}{n_e(T)}$. Express $f_I(T)$ as a dimensionless decimal.\n\nNumerical requirements:\n- All inputs and computations must use the International System of Units (SI). The electric field $E$ must be in $\\mathrm{V/m}$, time in $\\mathrm{s}$, density in $\\mathrm{m^{-3}}$, and the final output $f_I(T)$ is dimensionless.\n- Use numerical time integration over a supplied discrete time grid $\\{t_k\\}_{k=0}^{N-1}$ with uniform or nonuniform spacing to evaluate $\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t$ by a consistent quadrature scheme.\n- For each test case, compute $f_I(T)$ as a float.\n\nTest suite:\nImplement the following three test cases. Each test case provides $t_k$, $E(t_k)$, $n_e(t_k)$, $\\ln\\Lambda$, and $f_{\\mathrm{seed}}$. The final time is $T = t_{N-1}$ in each case.\n\n- Test case $1$ (mitigation via density spike and electric field reduction):\n  - Time grid: $t_k$ uniformly spanning $[0, 10^{-2}]\\,\\mathrm{s}$ with $N = 1001$ points.\n  - Electric field $E(t)$: $E(t) = 1.0\\,\\mathrm{V/m}$ for $t  4\\times 10^{-3}\\,\\mathrm{s}$, and $E(t) = 0.1\\,\\mathrm{V/m}$ for $t \\ge 4\\times 10^{-3}\\,\\mathrm{s}$.\n  - Electron density $n_e(t)$: $n_e(t) = 5\\times 10^{19}\\,\\mathrm{m^{-3}}$ for $t  4\\times 10^{-3}\\,\\mathrm{s}$; $n_e(t) = 1\\times 10^{21}\\,\\mathrm{m^{-3}}$ for $4\\times 10^{-3}\\,\\mathrm{s} \\le t  8\\times 10^{-3}\\,\\mathrm{s}$; $n_e(t) = 7\\times 10^{20}\\,\\mathrm{m^{-3}}$ for $t \\ge 8\\times 10^{-3}\\,\\mathrm{s}$.\n  - Coulomb logarithm: $\\ln\\Lambda = 15.0$.\n  - Initial seed fraction: $f_{\\mathrm{seed}} = 1.0\\times 10^{-8}$.\n\n- Test case $2$ (subcritical electric field, no avalanche growth):\n  - Time grid: $t_k$ uniformly spanning $[0, 5\\times 10^{-3}]\\,\\mathrm{s}$ with $N = 1001$ points.\n  - Electric field $E(t)$: $E(t) = 2.0\\times 10^{-2}\\,\\mathrm{V/m}$ for all $t$.\n  - Electron density $n_e(t)$: $n_e(t) = 5\\times 10^{19}\\,\\mathrm{m^{-3}}$ for all $t$.\n  - Coulomb logarithm: $\\ln\\Lambda = 15.0$.\n  - Initial seed fraction: $f_{\\mathrm{seed}} = 1.0\\times 10^{-6}$.\n\n- Test case $3$ (no seed, supercritical field):\n  - Time grid: $t_k$ uniformly spanning $[0, 10^{-2}]\\,\\mathrm{s}$ with $N = 1001$ points.\n  - Electric field $E(t)$: $E(t) = 1.0\\,\\mathrm{V/m}$ for all $t$.\n  - Electron density $n_e(t)$: $n_e(t) = 1\\times 10^{20}\\,\\mathrm{m^{-3}}$ for all $t$.\n  - Coulomb logarithm: $\\ln\\Lambda = 15.0$.\n  - Initial seed fraction: $f_{\\mathrm{seed}} = 0.0$.\n\nComputation details and final output:\n- For each test case, compute the time-dependent avalanche growth rate $\\gamma_{\\mathrm{ava}}(t_k)$ and numerically evaluate $\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t$. Use that to compute $n_{\\mathrm{RE}}(T)$ and then $f_I(T) = \\dfrac{n_{\\mathrm{RE}}(T)}{n_e(T)}$. Because $f_{\\mathrm{seed}} = \\dfrac{n_{\\mathrm{RE}}(0)}{n_e(0)}$, it follows that $f_I(T) = f_{\\mathrm{seed}}\\exp\\left(\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t\\right)\\dfrac{n_e(0)}{n_e(T)}$ under the stated assumptions.\n- Your program should produce a single line of output containing the three final fractions for the test cases as a comma-separated list enclosed in square brackets, in the order of the test cases given above (for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$). Each $\\text{result}_i$ must be a single floating-point number.", "solution": "The derivation proceeds from fundamental electrodynamics and collisional kinetics. An electron subject to an electric field $E$ experiences an electric acceleration force $F_E = e E$. In a plasma, a fast electron also experiences a collisional slowing-down force due to Coulomb interactions with background electrons and ions. In the relativistic limit at speed $v \\approx c$, the collisional drag can be expressed in terms of an effective slowing-down frequency $\\nu_s$ as $F_{\\mathrm{drag}} \\approx m_e c\\,\\nu_s$, where the frequency $\\nu_s$ is determined by Coulomb scattering.\n\nWithin the small-angle Coulomb collision approximation and using a Fokker–Planck description, the effective slowing-down frequency for relativistic electrons due to electron–electron collisions is\n$$\n\\nu_s \\approx \\frac{n_e e^4 \\ln\\Lambda}{4\\pi \\varepsilon_0^2 m_e^2 c^3}.\n$$\nThis expression comes from integrating the Rutherford differential cross-section over impact parameters between a minimum $b_{\\min}$ and maximum $b_{\\max}$, leading to the Coulomb logarithm $\\ln\\Lambda = \\ln(b_{\\max}/b_{\\min})$. Equating the electric acceleration and the collisional drag at criticality, $e E_c = m_e c\\,\\nu_s$, yields the Connor–Hastie critical electric field\n$$\nE_c(t) = \\frac{n_e(t) e^3 \\ln\\Lambda}{4\\pi \\varepsilon_0^2 m_e c^2}.\n$$\nThis $E_c(t)$ separates the regimes: for $E(t) \\le E_c(t)$, friction exceeds electric acceleration and avalanching is not sustained; for $E(t)  E_c(t)$, electric acceleration can overcome drag and avalanche multiplication proceeds.\n\nThe Rosenbluth–Putvinski avalanche mechanism considers secondary runaway generation via close collisions between existing runaways and thermal electrons. In this mechanism, the avalanche source rate is proportional to the flux of collisional encounters, which is the product of the background density $n_e$, the characteristic relative speed $c$, and the effective Coulomb (Møller) scattering cross-section. Integrating the small-angle Coulomb cross-section over scattering angles and impact parameters produces an effective cross-section scaling as $4\\pi r_e^2 \\ln\\Lambda$, where the classical electron radius $r_e$ is\n$$\nr_e = \\frac{e^2}{4\\pi \\varepsilon_0 m_e c^2}.\n$$\nConsequently, the avalanche growth rate (the multiplicative rate of runaway density per existing runaway) is\n$$\n\\gamma_{\\mathrm{ava}}(t) = n_e(t)\\,c\\,\\left(4\\pi r_e^2 \\ln\\Lambda\\right)\\,\\left[\\frac{E(t)}{E_c(t)} - 1\\right]_+,\n$$\nwhere $[x]_+ = \\max(x,0)$ is the Heaviside-gated linear dependence that enforces zero growth when $E(t) \\le E_c(t)$. This expression has physical dimensions of $\\mathrm{s^{-1}}$ since $n_e$ has units $\\mathrm{m^{-3}}$, $c$ has units $\\mathrm{m/s}$, and $r_e^2$ has units $\\mathrm{m^2}$, making $n_e c r_e^2$ have units $\\mathrm{s^{-1}}$; $\\ln\\Lambda$ and $\\frac{E}{E_c}-1$ are dimensionless.\n\nGiven $\\gamma_{\\mathrm{ava}}(t)$, the runaway electron number density $n_{\\mathrm{RE}}(t)$ evolves as a multiplicative process:\n$$\nn_{\\mathrm{RE}}(t) = n_{\\mathrm{RE}}(0)\\,\\exp\\left(\\int_0^t \\gamma_{\\mathrm{ava}}(t')\\,\\mathrm{d}t'\\right),\n$$\nwhere $n_{\\mathrm{RE}}(0) = f_{\\mathrm{seed}}\\,n_e(0)$. Under the ultrarelativistic assumption, the runaway current density is $j_{\\mathrm{RE}}(t) \\approx e\\,n_{\\mathrm{RE}}(t)\\,c$. The final runaway current fraction at time $T$ relative to the maximum current density if all electrons were runaways is\n$$\nf_I(T) = \\frac{j_{\\mathrm{RE}}(T)}{e\\,n_e(T)\\,c} = \\frac{n_{\\mathrm{RE}}(T)}{n_e(T)} = f_{\\mathrm{seed}}\\,\\exp\\left(\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t\\right)\\,\\frac{n_e(0)}{n_e(T)}.\n$$\nAlgorithmic steps for the program:\n- Construct the discrete time grid $\\{t_k\\}$ and arrays $E_k = E(t_k)$, $n_{e,k} = n_e(t_k)$ for each test case.\n- Compute $E_{c,k} = E_c(t_k)$ using $E_c(t) = \\dfrac{n_e(t) e^3 \\ln\\Lambda}{4\\pi \\varepsilon_0^2 m_e c^2}$.\n- Compute $\\gamma_k = n_{e,k}\\,c\\,\\left(4\\pi r_e^2 \\ln\\Lambda\\right)\\,\\max\\left(\\dfrac{E_k}{E_{c,k}} - 1, 0\\right)$.\n- Numerically integrate $\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t$ using a consistent quadrature such as the trapezoidal rule applied to $(t_k,\\gamma_k)$.\n- Compute $f_I(T) = f_{\\mathrm{seed}}\\,\\exp\\left(\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t\\right)\\,\\dfrac{n_e(0)}{n_e(T)}$.\n- Report $f_I(T)$ for each test case in the required single-line output format.\n\nQualitative expectations for the test suite:\n- In test case $1$, the initial phase with $E(t)  E_c(t)$ produces some avalanche multiplication. The subsequent density spike increases $E_c(t)$ and the reduced $E(t)$ ensures $E(t)  E_c(t)$, terminating avalanche growth; the final fraction remains small due to modest integrated growth and the increase in $n_e(T)$.\n- In test case $2$, the electric field is subcritical for all times, so $\\gamma_{\\mathrm{ava}}(t) = 0$ and the final fraction equals $f_{\\mathrm{seed}}$.\n- In test case $3$, the field is supercritical, but with zero seed ($f_{\\mathrm{seed}} = 0$), the purely multiplicative avalanche model yields no growth from zero, so the final fraction is zero.\n\nAll computations are performed in $\\mathrm{SI}$ units, the final fractions are dimensionless decimals, and the single-line output lists the three floats in order.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants in SI units\ne = 1.602176634e-19       # Coulomb\nm_e = 9.1093837015e-31    # kg\nepsilon0 = 8.854187817e-12  # F/m\nc = 299792458.0           # m/s\n\ndef classical_electron_radius():\n    # r_e = e^2 / (4*pi*epsilon0*m_e*c^2)\n    return e**2 / (4.0 * np.pi * epsilon0 * m_e * c**2)\n\ndef critical_field(n_e, lnLambda):\n    # E_c = n_e * e^3 * lnLambda / (4*pi*epsilon0^2 * m_e * c^2)\n    return n_e * e**3 * lnLambda / (4.0 * np.pi * (epsilon0**2) * m_e * c**2)\n\ndef avalanche_growth_rate(E, n_e, lnLambda):\n    # gamma_ava(t) = n_e * c * (4*pi*r_e^2 * lnLambda) * max(E/E_c - 1, 0)\n    # Handle E_c safely even if extremely small.\n    r_e = classical_electron_radius()\n    E_c = critical_field(n_e, lnLambda)\n    ratio = np.zeros_like(E)\n    # Avoid division by zero: where E_c == 0, ratio stays 0\n    mask = E_c > 0\n    ratio[mask] = E[mask] / E_c[mask] - 1.0\n    ratio = np.maximum(ratio, 0.0)\n    prefactor = n_e * c * (4.0 * np.pi * (r_e**2) * lnLambda)\n    return prefactor * ratio\n\ndef integrate_trapezoid(y, x):\n    # Robust trapezoidal integration for arrays\n    return np.trapz(y, x)\n\ndef final_runaway_fraction(times, E_t, ne_t, lnLambda, f_seed):\n    # Compute gamma_ava(t)\n    gamma_t = avalanche_growth_rate(E_t, ne_t, lnLambda)\n    # Integrate over time\n    integral_gamma = integrate_trapezoid(gamma_t, times)\n    # n_RE(0) = f_seed * n_e(0); f_I(T) = n_RE(T)/n_e(T)\n    # => f_I(T) = f_seed * exp(integral_gamma) * n_e(0)/n_e(T)\n    ne0 = float(ne_t[0])\n    neT = float(ne_t[-1])\n    # If final density is zero (unphysical here), guard against division by zero\n    if neT == 0.0:\n        return 0.0\n    f_final = f_seed * np.exp(integral_gamma) * (ne0 / neT)\n    return float(f_final)\n\ndef build_test_case_1():\n    # Test case 1: mitigation via density spike and E reduction\n    T = 10e-3\n    N = 1001\n    times = np.linspace(0.0, T, N)\n    # Electric field profile\n    E = np.where(times  4e-3, 1.0, 0.1)  # V/m\n    # Density profile\n    ne = np.zeros_like(times)\n    ne[times  4e-3] = 5e19\n    mask_mid = (times >= 4e-3)  (times  8e-3)\n    ne[mask_mid] = 1e21\n    ne[times >= 8e-3] = 7e20\n    lnLambda = 15.0\n    f_seed = 1e-8\n    return times, E, ne, lnLambda, f_seed\n\ndef build_test_case_2():\n    # Test case 2: subcritical field, no avalanche\n    T = 5e-3\n    N = 1001\n    times = np.linspace(0.0, T, N)\n    E = np.full_like(times, 2.0e-2)  # V/m\n    ne = np.full_like(times, 5e19)   # m^-3\n    lnLambda = 15.0\n    f_seed = 1e-6\n    return times, E, ne, lnLambda, f_seed\n\ndef build_test_case_3():\n    # Test case 3: no seed, supercritical field\n    T = 10e-3\n    N = 1001\n    times = np.linspace(0.0, T, N)\n    E = np.full_like(times, 1.0)     # V/m\n    ne = np.full_like(times, 1e20)   # m^-3\n    lnLambda = 15.0\n    f_seed = 0.0\n    return times, E, ne, lnLambda, f_seed\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        build_test_case_1(),\n        build_test_case_2(),\n        build_test_case_3(),\n    ]\n\n    results = []\n    for times, E, ne, lnLambda, f_seed in test_cases:\n        result = final_runaway_fraction(times, E, ne, lnLambda, f_seed)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3709726"}]}