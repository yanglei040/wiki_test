{"hands_on_practices": [{"introduction": "Many disruption pathways begin with instabilities deep within the plasma core. This first practice focuses on the sawtooth oscillation, a periodic crash in central temperature triggered by the $m/n=1/1$ internal kink mode. By working through the ideal MHD energy principle and resistive reconnection models, you will establish the fundamental instability criterion, $q_0 \\lesssim 1$, and calculate the characteristic timescale for the crash, providing a firm grasp on this key precursor event. [@problem_id:3708729]", "problem": "Consider a large-aspect-ratio, circular-cross-section tokamak of major radius $R_0$ and minor radius $a$, with a monotonic safety factor profile $q(r)$ such that $q(0)=q_0$ and $q(r_1)=1$ at the radius $r_1$. Assume an equilibrium with dominant toroidal magnetic field $B_{\\phi}$ and poloidal magnetic field $B_{\\theta}(r)$ related to the safety factor by $q(r)=r B_{\\phi}/\\left(R_0 B_{\\theta}(r)\\right)$. The pressure profile $p(r)$ is smooth, and the equilibrium is in the low-plasma-beta limit so that magnetic field line bending dominates compressibility. Using the ideal magnetohydrodynamic (MHD) energy principle, take a helical trial displacement localized at the $q=1$ surface of the form $\\boldsymbol{\\xi}(r,\\theta,\\phi)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{r}\\,\\cos(\\theta-\\phi)$ with poloidal mode number $m=1$ and toroidal mode number $n=1$, and with $\\xi(r)$ strongly peaked around $r=r_1$. Starting from the ideal MHD energy principle and consistently applying the large-aspect-ratio ordering, derive the condition under which the change in potential energy $\\delta W$ for this $m=n=1$ internal kink perturbation becomes negative. State the resulting sawtooth crash criterion in terms of $q_0$ and the local properties at $r=r_1$, explicitly identifying the physical mechanism that sets the sign of $\\delta W$.\n\nNext, estimate the reconnection time in resistive magnetohydrodynamics (MHD) for the sawtooth crash, modeling the reconnection as a Sweet–Parker-type process at the $q=1$ rational surface. Use the reconnecting magnetic field to be the poloidal field at $r=r_1$, $B_{\\theta}(r_1)$, and take the characteristic current-sheet length to be the poloidal circumference $L=2\\pi r_1$. Define the Alfvén speed based on the reconnecting field as $v_{A\\theta}=B_{\\theta}(r_1)/\\sqrt{\\mu_0 \\rho}$, with mass density $\\rho=n_i m_i$. The reconnection time may be expressed in terms of the Alfvén time $\\tau_A=L/v_{A\\theta}$ and the Lundquist number $S=\\mu_0 L v_{A\\theta}/\\eta$, where $\\eta$ is the resistivity. For the following typical tokamak parameters:\n- $R_0=1.7 \\ \\mathrm{m}$,\n- $a=0.6 \\ \\mathrm{m}$,\n- $r_1=0.30 \\ \\mathrm{m}$,\n- $B_{\\phi}=3.0 \\ \\mathrm{T}$,\n- $q(r_1)=1$,\n- ion number density $n_i=5.0\\times 10^{19} \\ \\mathrm{m}^{-3}$,\n- ion mass $m_i=2 m_p$ with proton mass $m_p=1.6726\\times 10^{-27} \\ \\mathrm{kg}$,\n- magnetic permeability $\\mu_0=4\\pi\\times 10^{-7} \\ \\mathrm{H/m}$,\n- resistivity $\\eta=1.0\\times 10^{-6} \\ \\Omega \\cdot \\mathrm{m}$,\ncompute the reconnection time $t_{\\mathrm{rec}}$ using Sweet–Parker scaling and express the final numerical answer in millisecond (ms). Round your answer to three significant figures. The final answer must be a single real-valued number.", "solution": "The problem presents two distinct parts: first, a derivation of the ideal magnetohydrodynamic (MHD) instability criterion for the $m=n=1$ internal kink mode, which triggers the sawtooth crash; and second, a calculation of the reconnection time during the crash phase using the resistive MHD model of Sweet and Parker. The problem is scientifically grounded, well-posed, and all necessary parameters are provided for a complete solution.\n\n**Part 1: Ideal MHD Instability Criterion for the Sawtooth Crash**\n\nThe stability of the plasma against an ideal MHD perturbation $\\boldsymbol{\\xi}$ is determined by the sign of the change in potential energy, $\\delta W$. The system is unstable if a physically permissible displacement exists for which $\\delta W  0$. The general expression for $\\delta W$ is:\n$$ \\delta W = \\frac{1}{2} \\int \\left[ \\frac{|\\delta \\boldsymbol{B}|^2}{\\mu_0} - \\boldsymbol{J}_0 \\cdot (\\boldsymbol{\\xi} \\times \\delta \\boldsymbol{B}) + (\\boldsymbol{\\xi} \\cdot \\nabla p_0) (\\nabla \\cdot \\boldsymbol{\\xi}) + \\gamma p_0 (\\nabla \\cdot \\boldsymbol{\\xi})^2 \\right] dV $$\nwhere $\\delta \\boldsymbol{B} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\boldsymbol{B}_0)$, and subscript $0$ denotes equilibrium quantities.\n\nFor a helical perturbation of the form $\\boldsymbol{\\xi} \\propto \\exp(i(m\\theta - n\\phi))$, the perturbed magnetic field contains a parallel wavevector component $k_{||} \\propto (m - nq(r))$. The dominant contribution to $\\delta W$ typically comes from the field line bending term, $|\\delta \\boldsymbol{B}|^2$, which scales as $k_{||}^2$. For the $m=n=1$ internal kink mode, this term is minimized at the rational surface $r=r_1$ where $q(r_1)=1$, making $k_{||}=0$. This allows for a large-amplitude perturbation with a relatively small energy cost.\n\nTo derive the instability criterion, we analyze $\\delta W$ for the specified trial function $\\boldsymbol{\\xi}(r,\\theta,\\phi)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{r}\\,\\cos(\\theta-\\phi)$, localized at the $q=1$ surface. In the large-aspect-ratio, circular-cross-section approximation, the analysis of $\\delta W$ shows that the energy change can be split into a contribution from the core region ($r  r_1$) and the outer region ($r  r_1$). The plasma in the outer region is stable to this mode, so any displacement there would cost a large amount of energy. Thus, the ideal mode is confined to the region $r \\le r_1$, and the displacement is taken to be zero for $rr_1$.\n\nWithin the core ($r  r_1$), the displacement that minimizes the energy is a quasi-rigid, \"top-hat\" motion of the entire plasma column, meaning $\\xi(r)$ is approximately constant for $r  r_1$ and drops sharply to zero at $r=r_1$. For such a displacement, $\\delta W$ consists of two main competing terms:\n1.  A stabilizing magnetic energy term, which is positive and depends on the deviation of the safety factor from unity within the core. This term is proportional to an integral over the volume $r  r_1$ of $(1-1/q)^2$.\n2.  A destabilizing pressure gradient term, which is negative (since $dp/dr  0$) and arises from the release of thermal energy as the plasma core shifts and expands into a region of weaker toroidal magnetic field.\n\nThe instability occurs when the destabilizing pressure term overcomes the stabilizing magnetic term. A key observation is that the stabilizing term is highly sensitive to the shape of the $q$-profile. If $q(0)=q_0$ is very close to $1$, then $q(r)$ remains close to $1$ throughout the core region $rr_1$. This makes the stabilizing integral $\\int_0^{r_1} (1-1/q)^2 r^3 dr$ extremely small. In this situation, any finite pressure gradient inside the $q=1$ surface is sufficient to make the total $\\delta W$ negative. Therefore, while the full condition (known as the Bussac criterion) involves a detailed balance depending on the pressure and current profiles, the practical criterion for instability in a realistic tokamak with finite pressure is that the safety factor on the magnetic axis, $q_0$, drops below unity.\n\nThe physical mechanism that sets the sign of $\\delta W$ is the competition between the stabilizing magnetic field line bending energy and the destabilizing potential energy available from the plasma pressure gradient in the toroidal geometry. The condition for the sawtooth crash trigger is thus $\\delta W  0$, which practically reduces to the criterion $q_0 \\lesssim 1$.\n\n**Part 2: Reconnection Time Calculation**\n\nThe sawtooth crash itself involves magnetic reconnection at the $q=1$ surface, a process governed by resistive MHD. We model this using the Sweet–Parker theory. The reconnection time $t_{\\mathrm{rec}}$ is given by the geometric mean of the resistive diffusion time $\\tau_R = \\mu_0 L^2 / \\eta$ and the Alfvén time $\\tau_A = L/v_{A\\theta}$. An equivalent expression for the reconnection time is $t_{\\mathrm{rec}} = \\tau_A \\sqrt{S}$, where $S$ is the Lundquist number. We are given the definitions $\\tau_A = L/v_{A\\theta}$ and $S = \\mu_0 L v_{A\\theta}/\\eta$, confirming that $t_{\\mathrm{rec}} = \\tau_A \\sqrt{S}$.\n\nFirst, we calculate the required physical quantities from the given parameters.\nThe characteristic length of the current sheet is the poloidal circumference at $r=r_1$:\n$$ L = 2\\pi r_1 = 2\\pi(0.30 \\ \\mathrm{m}) = 0.6\\pi \\ \\mathrm{m} $$\nThe reconnecting magnetic field is the poloidal field $B_{\\theta}(r_1)$. From the definition of the safety factor, $q(r)=r B_{\\phi}/\\left(R_0 B_{\\theta}(r)\\right)$, and with $q(r_1)=1$:\n$$ B_{\\theta}(r_1) = \\frac{r_1 B_{\\phi}}{R_0} = \\frac{(0.30 \\ \\mathrm{m})(3.0 \\ \\mathrm{T})}{1.7 \\ \\mathrm{m}} = \\frac{0.9}{1.7} \\ \\mathrm{T} $$\nThe plasma mass density $\\rho$ is given by $\\rho=n_i m_i$:\n$$ \\rho = (5.0 \\times 10^{19} \\ \\mathrm{m}^{-3}) \\times (2 \\times 1.6726 \\times 10^{-27} \\ \\mathrm{kg}) = 1.6726 \\times 10^{-7} \\ \\mathrm{kg \\cdot m^{-3}} $$\nThe Alfvén speed based on the reconnecting field, $v_{A\\theta}$, is:\n$$ v_{A\\theta} = \\frac{B_{\\theta}(r_1)}{\\sqrt{\\mu_0 \\rho}} = \\frac{0.9/1.7 \\ \\mathrm{T}}{\\sqrt{(4\\pi \\times 10^{-7} \\ \\mathrm{H/m})(1.6726 \\times 10^{-7} \\ \\mathrm{kg/m^3})}} \\approx 1.1548 \\times 10^6 \\ \\mathrm{m/s} $$\nThe Alfvén time $\\tau_A$ is:\n$$ \\tau_A = \\frac{L}{v_{A\\theta}} = \\frac{0.6\\pi \\ \\mathrm{m}}{1.1548 \\times 10^6 \\ \\mathrm{m/s}} \\approx 1.6323 \\times 10^{-6} \\ \\mathrm{s} $$\nThe Lundquist number $S$ is:\n$$ S = \\frac{\\mu_0 L v_{A\\theta}}{\\eta} = \\frac{(4\\pi \\times 10^{-7} \\ \\mathrm{H/m})(0.6\\pi \\ \\mathrm{m})(1.1548 \\times 10^6 \\ \\mathrm{m/s})}{1.0 \\times 10^{-6} \\ \\Omega \\cdot \\mathrm{m}} \\approx 2.7334 \\times 10^6 $$\nFinally, we compute the Sweet–Parker reconnection time $t_{\\mathrm{rec}}$:\n$$ t_{\\mathrm{rec}} = \\tau_A \\sqrt{S} = (1.6323 \\times 10^{-6} \\ \\mathrm{s}) \\sqrt{2.7334 \\times 10^6} \\approx 2.6989 \\times 10^{-3} \\ \\mathrm{s} $$\nConverting to milliseconds and rounding to three significant figures, we get:\n$$ t_{\\mathrm{rec}} \\approx 2.70 \\ \\mathrm{ms} $$", "answer": "$$\\boxed{2.70}$$", "id": "3708729"}, {"introduction": "While a sawtooth crash can be benign on its own, its primary danger often lies in triggering other, larger-scale instabilities. This exercise explores the critical concept of mode coupling, where the core perturbation from a sawtooth provides a \"seed\" for a Neoclassical Tearing Mode (NTM) at an outer rational surface, such as $q=2$. You will implement a reduced predictive model to quantify this link, gaining practical experience in how simplified, physics-based models are used to forecast the evolution of a discharge toward a disruptive state. [@problem_id:3708752]", "problem": "Consider a large-aspect-ratio, circular tokamak with major radius $R$, minor radius $a$, and constant toroidal magnetic field $B_t$. The safety factor profile is measured and well-fit near the magnetic axis by a polynomial in the normalized minor radius $x = r/a$:\n$$\nq(r) = q_0 + c_2 x^2 + c_4 x^4,\n$$\nwhere $q_0$, $c_2$, and $c_4$ are nonnegative constants, and $r \\in [0,a]$. The magnetic shear is defined as\n$$\ns(r) = \\frac{r}{q(r)} \\frac{dq}{dr}.\n$$\nFor the polynomial model above, compute $\\frac{dq}{dr}$ and $s(r)$ explicitly in terms of $x$, $q_0$, $c_2$, $c_4$, and $a$. The poloidal magnetic field for a large-aspect-ratio tokamak is approximated by\n$$\nB_\\theta(r) = \\frac{r B_t}{R q(r)}.\n$$\n\nWe wish to assess susceptibility to sawtooth-triggered neoclassical tearing mode (NTM) seeding when the on-axis safety factor is slightly above unity. In a reduced analytic forecast model, we define the following steps:\n\n1. Hypothesize a small safety-factor decrement $\\delta_q > 0$ due to slow current diffusion between sawtooth events and define the prospective $q=1$ surface radius $r_1$ as the solution in $[0,a]$ of\n$$\nq(r) - \\delta_q = 1.\n$$\nIn terms of $x=r/a$, let $y = x^2$. Then $r_1$ exists if and only if the equation\n$$\nc_4 y^2 + c_2 y - D = 0, \\quad \\text{where} \\quad D = 1 + \\delta_q - q_0,\n$$\nhas a solution $y$ with $0 \\le y \\le 1$. If $c_4 = 0$, the equation reduces to $c_2 y - D = 0$. If $D \\le 0$ or the computed $y$ is not in $[0,1]$, then no prospective $q=1$ surface forms under the hypothesized decrement. In that case, define the internal kink marginality as stable by setting the marginality index to $1$ and the seed island width to $0$.\n\n2. If $r_1$ exists, evaluate the magnetic shear at $r_1$,\n$$\ns_1 = s(r_1),\n$$\nand define an effective poloidal beta inside the $q=1$ core using a global poloidal field scale and a core volume scaling:\n$$\n\\beta_{p,\\mathrm{eff}} = \\left( \\frac{2 \\mu_0 p_0}{B_\\theta(a)^2} \\right) \\left( \\frac{r_1}{a} \\right)^2,\n$$\nwhere $\\mu_0$ is the magnetic permeability of free space and $p_0$ is the central pressure. Using an energy-principle-inspired reduced model, define the internal kink marginality index as\n$$\n\\mathcal{M} = 1 - \\frac{\\beta_{p,\\mathrm{eff}}}{\\frac{1}{2} s_1^2}.\n$$\nHere, $\\mathcal{M} \\approx 0$ indicates marginality, $\\mathcal{M}  0$ indicates instability under the hypothesized decrement, and $\\mathcal{M}  0$ indicates stability.\n\n3. For NTM seeding, focus on the $m/n = 2/1$ rational surface (that is, the $q=2$ surface). Define $r_s$ as any solution in $[0,a]$ of\n$$\nq(r_s) = 2.\n$$\nIn terms of $y = x^2$, this is\n$$\nc_4 y^2 + c_2 y + (q_0 - 2) = 0,\n$$\nwith $y \\in [0,1]$. If there is no such $r_s$, set the seed island width to $0$.\n\n4. If both $r_1$ and $r_s$ exist, define a reduced coupling model for the sawtooth-seeded initial island half-width at the $q=2$ surface:\n$$\nw_{\\mathrm{seed}} = C \\, \\frac{r_1^2}{R} \\, \\frac{B_\\theta(r_1)}{B_\\theta(r_s)} \\, \\frac{1}{\\sqrt{s(r_s)}},\n$$\nwhere $C$ is a dimensionless coupling constant set to $C = 10$ to represent finite-$m$ coupling efficiency from the core crash to the outer rational surface in a large-aspect-ratio device. This model is dimensionally consistent and scales seed size with the core displacement scale $r_1$, the field-line pitch ratio, and local shear at the $q=2$ surface.\n\nUsing the above definitions, implement a program that, for each test case, computes:\n- The internal kink marginality index $\\mathcal{M}$ (dimensionless).\n- The associated seed island width $w_{\\mathrm{seed}}$ at the $q=2$ surface in meters.\n\nExpress $w_{\\mathrm{seed}}$ in meters and round both outputs to six decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the pair for one test case in the form $[\\mathcal{M}, w_{\\mathrm{seed}}]$. For example, the output format must be:\n$$\n[\\,[\\mathcal{M}_1, w_{\\mathrm{seed},1}], [\\mathcal{M}_2, w_{\\mathrm{seed},2}], \\dots ]\n$$\n\nTest Suite:\nUse the following parameter sets, each defined by $(R, a, B_t, p_0, q_0, c_2, c_4, \\delta_q)$ with $R$ in meters, $a$ in meters, $B_t$ in tesla, $p_0$ in pascals, and $\\delta_q$ dimensionless:\n- Case 1: $(3.0, 1.0, 5.0, 1.2 \\times 10^5, 1.03, 0.9, 0.4, 0.04)$\n- Case 2: $(2.8, 0.9, 5.3, 1.8 \\times 10^5, 1.01, 1.1, 0.6, 0.02)$\n- Case 3 (no $q=1$ crossing under the decrement): $(3.2, 1.1, 4.8, 1.0 \\times 10^5, 1.10, 0.7, 0.3, 0.05)$\n- Case 4 (no $q=2$ surface in the profile): $(2.7, 0.95, 5.5, 1.5 \\times 10^5, 1.02, 0.5, 0.1, 0.03)$\n\nYour program must:\n- Implement the above reduced model consistently.\n- Use the magnetic permeability of free space $\\mu_0 = 4 \\pi \\times 10^{-7} \\, \\mathrm{N \\, A^{-2}}$.\n- Return $[\\mathcal{M}, w_{\\mathrm{seed}}]$ for each case, rounding to six decimal places.\n- Print a single line containing a list of these pairs for all test cases in the exact format described above.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\n**Constants and Variables:**\n- Major radius: $R$ (m)\n- Minor radius: $a$ (m)\n- Toroidal magnetic field: $B_t$ (T)\n- Central pressure: $p_0$ (Pa)\n- Safety factor on-axis: $q_0$ (dimensionless)\n- Safety factor profile coefficients: $c_2, c_4$ (dimensionless)\n- Safety-factor decrement: $\\delta_q$ (dimensionless)\n- Normalized minor radius: $x = r/a$, where $r \\in [0, a]$ is the minor radius coordinate.\n- Magnetic permeability of free space: $\\mu_0 = 4 \\pi \\times 10^{-7} \\, \\mathrm{N \\, A^{-2}}$\n- Dimensionless coupling constant: $C=10$\n\n**Model Definitions:**\n1.  **Safety factor profile:** $q(r) = q_0 + c_2 x^2 + c_4 x^4$\n2.  **Magnetic shear:** $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$\n3.  **Poloidal magnetic field (large-aspect-ratio):** $B_\\theta(r) = \\frac{r B_t}{R q(r)}$\n4.  **Prospective $q=1$ surface radius ($r_1$):** Defined as the solution to $q(r_1) - \\delta_q = 1$. This is equivalent to solving $c_4 y^2 + c_2 y - D = 0$ for $y = (r_1/a)^2$, where $D = 1 + \\delta_q - q_0$.\n    -   **Condition:** A valid $r_1$ exists if and only if a solution $y$ exists in the range $[0, 1]$.\n    -   **No-$r_1$ case:** If $D \\le 0$ or the computed $y \\notin [0,1]$, the marginality index is set to $\\mathcal{M}=1$ and the seed island width to $w_{\\mathrm{seed}}=0$.\n5.  **Magnetic shear at $r_1$:** $s_1 = s(r_1)$\n6.  **Effective poloidal beta:** $\\beta_{p,\\mathrm{eff}} = \\left( \\frac{2 \\mu_0 p_0}{B_\\theta(a)^2} \\right) \\left( \\frac{r_1}{a} \\right)^2$\n7.  **Internal kink marginality index:** $\\mathcal{M} = 1 - \\frac{\\beta_{p,\\mathrm{eff}}}{\\frac{1}{2} s_1^2}$\n8.  **$q=2$ surface radius ($r_s$):** Defined as any solution to $q(r_s) = 2$ within $[0,a]$. This is equivalent to solving $c_4 y^2 + c_2 y + (q_0 - 2) = 0$ for $y=(r_s/a)^2 \\in [0,1]$.\n    -   **No-$r_s$ case:** If no such $r_s$ exists, set $w_{\\mathrm{seed}}=0$.\n9.  **Seed island width:** $w_{\\mathrm{seed}} = C \\, \\frac{r_1^2}{R} \\, \\frac{B_\\theta(r_1)}{B_\\theta(r_s)} \\, \\frac{1}{\\sqrt{s(r_s)}}$ (if both $r_1$ and $r_s$ exist).\n\n**Test Suite:**\n- Case 1: $(R, a, B_t, p_0, q_0, c_2, c_4, \\delta_q) = (3.0, 1.0, 5.0, 1.2 \\times 10^5, 1.03, 0.9, 0.4, 0.04)$\n- Case 2: $(2.8, 0.9, 5.3, 1.8 \\times 10^5, 1.01, 1.1, 0.6, 0.02)$\n- Case 3: $(3.2, 1.1, 4.8, 1.0 \\times 10^5, 1.10, 0.7, 0.3, 0.05)$\n- Case 4: $(2.7, 0.95, 5.5, 1.5 \\times 10^5, 1.02, 0.5, 0.1, 0.03)$\n\n**Outputs:**\n- For each case, compute the internal kink marginality index $\\mathcal{M}$ and the seed island width $w_{\\mathrm{seed}}$ (in meters).\n- Round both outputs to six decimal places.\n- The final output is a single line: `[[M1,w1],[M2,w2],...]`\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded:** The problem is set in the context of tokamak plasma stability, a well-established subfield of nuclear fusion research. The concepts used—safety factor ($q$), magnetic shear ($s$), poloidal beta ($\\beta_p$), neoclassical tearing modes (NTMs), and sawteeth—are standard. The equations provided constitute a \"reduced analytic forecast model,\" which is a common approach in physics to capture essential dynamics with simplified, yet physically motivated, formulas. The polynomial form for $q(r)$ near the axis and the large-aspect-ratio approximation for $B_\\theta(r)$ are standard textbook material. The model for $\\mathcal{M}$ is described as \"energy-principle-inspired,\" and the model for $w_{\\mathrm{seed}}$ includes physically relevant scaling with core displacement ($r_1^2/R$), field line pitch ratio ($B_\\theta(r_1)/B_\\theta(r_s)$), and local magnetic shear ($s(r_s)$). The problem is scientifically sound within its stated scope as a reduced model.\n\n2.  **Well-Posed:** The problem provides a complete, step-by-step algorithm for computing the outputs. It explicitly defines all variables and relationships. Crucially, it provides clear instructions for handling all contingencies, such as the non-existence of the $q=1$ or $q=2$ surfaces. The conditions for the existence of these surfaces are unambiguously defined through the solvability of quadratic equations within a specific physical domain ($y \\in [0,1]$). This structure ensures that a unique and meaningful solution can be computed for any valid set of input parameters.\n\n3.  **Objective:** The problem statement uses precise, quantitative, and objective language. There are no subjective claims or opinions. The purpose of the model as a \"reduced analytic forecast model\" is an objective characterization.\n\n4.  **Other Flaws:** The problem is self-contained, with all necessary data and constants provided. The parameters in the test cases are physically plausible for tokamak experiments. There are no contradictions, circular reasoning, or ambiguities.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is scientifically grounded, well-posed, objective, and complete. I will now proceed with the solution.\n\n### Solution Derivations and Algorithm\n\nFirst, we derive the explicit expressions required for the calculation. Given the safety factor profile in terms of $x=r/a$:\n$$\nq(x) = q_0 + c_2 x^2 + c_4 x^4\n$$\nThe derivative with respect to $r$ is found using the chain rule, $\\frac{dq}{dr} = \\frac{dq}{dx} \\frac{dx}{dr}$:\n$$\n\\frac{dq}{dx} = 2 c_2 x + 4 c_4 x^3\n$$\n$$\n\\frac{dx}{dr} = \\frac{1}{a}\n$$\nThus,\n$$\n\\frac{dq}{dr} = \\frac{1}{a} (2 c_2 x + 4 c_4 x^3)\n$$\nThe magnetic shear $s(r)$ is then:\n$$\ns(r) = \\frac{r}{q(r)} \\frac{dq}{dr} = \\frac{ax}{q(x)} \\frac{1}{a}(2 c_2 x + 4 c_4 x^3) = \\frac{2 c_2 x^2 + 4 c_4 x^4}{q_0 + c_2 x^2 + c_4 x^4}\n$$\nThe algorithm for each test case proceeds as follows:\n\n1.  **Initialize:** Set the marginality index $\\mathcal{M} = 1.0$ and seed width $w_{\\mathrm{seed}} = 0.0$. These are the default values if the prospective $q=1$ surface does not form.\n\n2.  **Find the prospective $q=1$ surface ($r_1$):**\n    a. Calculate $D = 1 + \\delta_q - q_0$.\n    b. If $D \\le 0$, the $q=1$ surface does not form. The algorithm terminates for this case, retaining the default outputs.\n    c. If $D  0$, solve for $y_1 = (r_1/a)^2$ from the equation $c_4 y^2 + c_2 y - D = 0$. Since $c_2, c_4 \\ge 0$ and we require a physical solution $y_1 \\ge 0$, the correct root is $y_1 = \\frac{-c_2 + \\sqrt{c_2^2 + 4c_4 D}}{2c_4}$ for $c_4  0$, and $y_1 = D/c_2$ for $c_4=0$.\n    d. If a positive solution $y_1$ exists and $y_1 \\in [0,1]$, then a valid $r_1$ exists. We proceed to the next steps. Otherwise, we retain the default outputs.\n\n3.  **Calculate the marginality index ($\\mathcal{M}$):**\n    a. The shear at $r_1$ is $s_1 = s(r_1)$. Using $x_1^2 = y_1$ and $q(r_1) = 1+\\delta_q$, the shear expression simplifies to $s_1 = \\frac{2c_2 y_1 + 4c_4 y_1^2}{1+\\delta_q}$.\n    b. The safety factor at the plasma edge ($r=a$, $x=1$) is $q(a) = q_0 + c_2 + c_4$.\n    c. The poloidal field at the edge is $B_\\theta(a) = \\frac{a B_t}{R q(a)}$.\n    d. The effective poloidal beta is $\\beta_{p,\\mathrm{eff}} = \\left( \\frac{2 \\mu_0 p_0}{B_\\theta(a)^2} \\right) y_1$.\n    e. The marginality index is $\\mathcal{M} = 1 - \\frac{\\beta_{p,\\mathrm{eff}}}{0.5 s_1^2}$. This value overwrites the default $\\mathcal{M}=1.0$.\n\n4.  **Find the $q=2$ surface ($r_s$):**\n    a. Solve for $y_s = (r_s/a)^2$ from the equation $c_4 y^2 + c_2 y + (q_0 - 2) = 0$. For a physical solution to exist ($y_s0$), we must have $q_0-2  0$. The correct root is $y_s = \\frac{-c_2 + \\sqrt{c_2^2 - 4c_4(q_0-2)}}{2c_4}$ for $c_40$, and $y_s = (2-q_0)/c_2$ for $c_4=0$.\n    b. Check if a solution exists and $y_s \\in [0,1]$. If not, $w_{\\mathrm{seed}}$ remains $0.0$.\n\n5.  **Calculate the seed island width ($w_{\\mathrm{seed}}$):**\n    a. This step is performed only if valid $r_1$ and $r_s$ were found.\n    b. The ratio of poloidal fields is $\\frac{B_\\theta(r_1)}{B_\\theta(r_s)} = \\frac{r_1 q(r_s)}{r_s q(r_1)} = \\frac{a \\sqrt{y_1} \\cdot 2}{a \\sqrt{y_s} (1+\\delta_q)} = \\frac{2 \\sqrt{y_1}}{\\sqrt{y_s} (1+\\delta_q)}$.\n    c. The shear at $r_s$ is $s(r_s) = \\frac{2c_2 y_s + 4c_4 y_s^2}{q(r_s)} = \\frac{2c_2 y_s + 4c_4 y_s^2}{2} = c_2 y_s + 2c_4 y_s^2$.\n    d. The seed width is calculated as $w_{\\mathrm{seed}} = C \\frac{r_1^2}{R} \\frac{B_\\theta(r_1)}{B_\\theta(r_s)} \\frac{1}{\\sqrt{s(r_s)}} = 10 \\frac{a^2 y_1}{R} \\frac{2\\sqrt{y_1}}{\\sqrt{y_s}(1+\\delta_q)} \\frac{1}{\\sqrt{c_2 y_s + 2c_4 y_s^2}}$. This value overwrites the default $w_{\\mathrm{seed}}=0.0$.\n\n6.  **Finalize:** The computed values of $\\mathcal{M}$ and $w_{\\mathrm{seed}}$ are rounded to six decimal places.\n\nThis procedure is implemented for each test case provided.", "answer": "[[0.334033,0.013442],[-0.147915,0.011884],[1.0,0.0],[0.816405,0.0]]", "id": "3708752"}, {"introduction": "The final step in many MHD-driven disruptions is mode locking, where a large tearing mode island ceases to rotate and locks to the wall, leading to a rapid thermal and current quench. This practice examines the torques that govern this process, arising from the interaction between the mode, intrinsic machine error fields, and externally applied Resonant Magnetic Perturbations (RMPs). By determining the optimal RMP phase to minimize the locking threshold, you will explore the foundational principles behind active disruption mitigation and error field correction techniques. [@problem_id:3708780]", "problem": "Consider a large-aspect-ratio tokamak with a single resonant surface at poloidal/toroidal mode numbers $m/n$, interacting with a static intrinsic error field and a single-helicity external Resonant Magnetic Perturbation (RMP). Let the complex resonant radial field at the rational surface induced by the intrinsic error be $\\tilde{b}_{i} = b_{i} \\exp(i \\phi_{i})$, where $b_{i}  0$ and $\\phi_{i}$ is the intrinsic field phase. The external RMP coils produce a vacuum field with real amplitude $b_{c}  0$ and coil phase $\\phi_{c}$. The linear plasma response at the resonant surface is modeled by a complex transfer function $H(\\omega_{0}) = |H| \\exp(i \\phi_{H})$, evaluated at the pre-lock rotation frequency $\\omega_{0}$, so that the RMP contribution to the resonant field is $\\tilde{b}_{\\mathrm{RMP}} = H(\\omega_{0})\\, b_{c} \\exp(i \\phi_{c})$. The total complex resonant field at the surface is thus $\\tilde{b}_{r} = \\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}}$.\n\nLet $\\delta$ denote the helical phase of the tearing layer relative to a fixed reference, and assume the electromagnetic interaction energy between the layer and the resonant field can be written as $U(\\delta) = -K\\, \\mathrm{Re}\\left\\{\\tilde{b}_{r} \\exp(-i \\delta)\\right\\}$ with a positive constant $K$ determined by the layer geometry and current channel. The corresponding electromagnetic torque on the layer is $T_{\\mathrm{EM}}(\\delta) = -\\partial U/\\partial \\delta$. The background rotation is maintained by a constant driving torque $T_{\\mathrm{rot}} = D \\,\\omega_{0}$, with $D  0$. Penetration and locking can occur if the maximum magnitude of the electromagnetic torque over the helical phase can balance the driving torque, i.e., if $\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| \\ge T_{\\mathrm{rot}}$.\n\n(a) Starting from first principles and the definitions above, derive the phase-dependent electromagnetic torque $T_{\\mathrm{EM}}(\\delta)$ in terms of $b_{i}$, $\\phi_{i}$, $b_{c}$, $\\phi_{c}$, $|H|$, and $\\phi_{H}$.\n\n(b) By enforcing the locking threshold condition $\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| = T_{\\mathrm{rot}}$, express the critical coil amplitude $b_{c,\\mathrm{crit}}(\\phi_{c})$ as a function of the coil phase $\\phi_{c}$ and the parameters $b_{i}$, $|H|$, $K$, $D$, and $\\omega_{0}$. You may define $B_{c} \\equiv T_{\\mathrm{rot}}/K$ to simplify notation.\n\n(c) Determine the coil phase $\\phi_{\\mathrm{opt}}$ that minimizes $b_{c,\\mathrm{crit}}(\\phi_{c})$, and give your final answer for $\\phi_{\\mathrm{opt}}$ as a single closed-form expression in radians in terms of $\\phi_{i}$ and $\\phi_{H}$ only. Your final boxed answer must contain only this expression for $\\phi_{\\mathrm{opt}}$.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of Magnetohydrodynamics (MHD) as applied to tokamak plasmas, specifically the theory of magnetic island locking. The problem is well-posed, objective, self-contained, and all terms are formally defined. The question builds logically from derivation to optimization and admits a unique, meaningful solution under a reasonable physical inference implied by the problem's context.\n\n(a) Derivation of the electromagnetic torque $T_{\\mathrm{EM}}(\\delta)$.\n\nThe electromagnetic interaction energy is given as $U(\\delta) = -K\\, \\mathrm{Re}\\left\\{\\tilde{b}_{r} \\exp(-i \\delta)\\right\\}$, where $K$ is a positive constant, $\\tilde{b}_{r}$ is the total complex resonant field, and $\\delta$ is the helical phase of the tearing layer.\n\nThe corresponding electromagnetic torque on the layer is defined as $T_{\\mathrm{EM}}(\\delta) = -\\partial U/\\partial \\delta$.\nLet $\\tilde{b}_{r} = |\\tilde{b}_{r}| \\exp(i \\phi_{r})$, where $|\\tilde{b}_{r}|$ and $\\phi_{r}$ are the magnitude and phase of the total resonant field, respectively.\nThen, the energy can be written as:\n$$U(\\delta) = -K\\, \\mathrm{Re}\\left\\{|\\tilde{b}_{r}| \\exp(i \\phi_{r}) \\exp(-i \\delta)\\right\\} = -K |\\tilde{b}_{r}| \\mathrm{Re}\\left\\{\\exp(i (\\phi_{r} - \\delta))\\right\\}$$\n$$U(\\delta) = -K |\\tilde{b}_{r}| \\cos(\\phi_{r} - \\delta)$$\nDifferentiating with respect to $\\delta$ to find the torque:\n$$T_{\\mathrm{EM}}(\\delta) = -\\frac{\\partial}{\\partial \\delta} \\left[-K |\\tilde{b}_{r}| \\cos(\\phi_{r} - \\delta)\\right] = K |\\tilde{b}_{r}| \\frac{\\partial}{\\partial \\delta} \\cos(\\phi_{r} - \\delta)$$\n$$T_{\\mathrm{EM}}(\\delta) = K |\\tilde{b}_{r}| \\left[-\\sin(\\phi_{r} - \\delta) \\cdot (-1)\\right] = K |\\tilde{b}_{r}| \\sin(\\phi_{r} - \\delta)$$\nThis can be expressed using the imaginary part of a complex exponential:\n$$T_{\\mathrm{EM}}(\\delta) = K |\\tilde{b}_{r}| \\mathrm{Im}\\left\\{\\exp(i(\\phi_{r} - \\delta))\\right\\} = K \\mathrm{Im}\\left\\{|\\tilde{b}_{r}|\\exp(i\\phi_{r}) \\exp(-i \\delta)\\right\\} = K \\mathrm{Im}\\left\\{\\tilde{b}_{r} \\exp(-i \\delta)\\right\\}$$\nNow, we substitute the expression for the total field $\\tilde{b}_{r} = \\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}}$.\nThe intrinsic error field is $\\tilde{b}_{i} = b_{i} \\exp(i \\phi_{i})$.\nThe RMP contribution is $\\tilde{b}_{\\mathrm{RMP}} = H(\\omega_{0}) b_{c} \\exp(i \\phi_{c}) = |H| \\exp(i \\phi_{H}) b_{c} \\exp(i \\phi_{c}) = |H| b_{c} \\exp(i(\\phi_{c} + \\phi_{H}))$.\nSo, the torque becomes:\n$$T_{\\mathrm{EM}}(\\delta) = K \\mathrm{Im}\\left\\{\\left(b_{i} \\exp(i \\phi_{i}) + |H| b_{c} \\exp(i(\\phi_{c} + \\phi_{H}))\\right) \\exp(-i \\delta)\\right\\}$$\n$$T_{\\mathrm{EM}}(\\delta) = K \\mathrm{Im}\\left\\{b_{i} \\exp(i(\\phi_{i} - \\delta)) + |H| b_{c} \\exp(i(\\phi_{c} + \\phi_{H} - \\delta))\\right\\}$$\nUsing the property $\\mathrm{Im}(z_1 + z_2) = \\mathrm{Im}(z_1) + \\mathrm{Im}(z_2)$, we get the final expression for the torque in terms of the given parameters:\n$$T_{\\mathrm{EM}}(\\delta) = K \\left[b_{i} \\sin(\\phi_{i} - \\delta) + |H| b_{c} \\sin(\\phi_{c} + \\phi_{H} - \\delta)\\right]$$\n\n(b) Derivation of the critical coil amplitude $b_{c,\\mathrm{crit}}(\\phi_{c})$.\n\nThe locking threshold is given by the condition $\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| = T_{\\mathrm{rot}}$.\nFrom the intermediate expression $T_{\\mathrm{EM}}(\\delta) = K |\\tilde{b}_{r}| \\sin(\\phi_{r} - \\delta)$, the maximum absolute value is achieved when $|\\sin(\\phi_{r} - \\delta)| = 1$. Thus:\n$$\\max_{\\delta} |T_{\\mathrm{EM}}(\\delta)| = K |\\tilde{b}_{r}|$$\nThe locking condition becomes $K |\\tilde{b}_{r}| = T_{\\mathrm{rot}}$. Using the provided definition $B_{c} \\equiv T_{\\mathrm{rot}}/K$, this simplifies to:\n$$|\\tilde{b}_{r}| = B_{c}$$\nWe need to solve this for the coil amplitude $b_{c}$. Let's express $|\\tilde{b}_{r}|^2$:\n$$|\\tilde{b}_{r}|^2 = |\\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}}|^2 = (\\tilde{b}_{i} + \\tilde{b}_{\\mathrm{RMP}})(\\tilde{b}_{i}^* + \\tilde{b}_{\\mathrm{RMP}}^*)$$\n$$|\\tilde{b}_{r}|^2 = |\\tilde{b}_{i}|^2 + |\\tilde{b}_{\\mathrm{RMP}}|^2 + 2\\,\\mathrm{Re}\\{\\tilde{b}_{i} \\tilde{b}_{\\mathrm{RMP}}^*\\}$$\nSubstituting the definitions:\n$|\\tilde{b}_{i}|^2 = b_{i}^2$\n$|\\tilde{b}_{\\mathrm{RMP}}|^2 = (|H| b_{c})^2$\n$\\tilde{b}_{i} \\tilde{b}_{\\mathrm{RMP}}^* = b_{i} \\exp(i\\phi_{i}) \\cdot |H| b_{c} \\exp(-i(\\phi_{c} + \\phi_{H})) = b_{i} |H| b_{c} \\exp(i(\\phi_{i} - \\phi_{c} - \\phi_{H}))$\nSo, $2\\,\\mathrm{Re}\\{\\tilde{b}_{i} \\tilde{b}_{\\mathrm{RMP}}^*\\} = 2 b_{i} |H| b_{c} \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c})$.\nThe locking condition $|\\tilde{b}_{r}|^2 = B_{c}^2$ yields a quadratic equation for $b_{c}$:\n$$B_{c}^2 = b_{i}^2 + |H|^2 b_{c}^2 + 2 b_{i} |H| b_{c} \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c})$$\n$$|H|^2 b_{c}^2 + \\left(2 b_{i} |H| \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c})\\right) b_{c} + (b_{i}^2 - B_{c}^2) = 0$$\nSolving for $b_{c}$ with the quadratic formula and requiring $b_{c}  0$ selects the positive root:\n$$b_{c,\\mathrm{crit}}(\\phi_{c}) = \\frac{-2 b_{i} |H| \\cos(\\theta) + \\sqrt{(2 b_{i} |H| \\cos(\\theta))^2 - 4 |H|^2 (b_{i}^2 - B_{c}^2)}}{2|H|^2}$$\nwhere $\\theta = \\phi_{i} - \\phi_{H} - \\phi_{c}$.\n$$b_{c,\\mathrm{crit}}(\\phi_{c}) = \\frac{-b_{i} \\cos(\\theta) + \\sqrt{b_{i}^2 \\cos^2(\\theta) - (b_{i}^2 - B_{c}^2)}}{|H|}$$\n$$b_{c,\\mathrm{crit}}(\\phi_{c}) = \\frac{-b_{i} \\cos(\\phi_{i} - \\phi_{H} - \\phi_{c}) + \\sqrt{B_{c}^2 - b_{i}^2 \\sin^2(\\phi_{i} - \\phi_{H} - \\phi_{c})}}{|H|}$$\n\n(c) Determination of the optimal coil phase $\\phi_{\\mathrm{opt}}$.\n\nThe goal is to find the coil phase $\\phi_{c}$ that minimizes the required coil amplitude $b_{c,\\mathrm{crit}}$. This is a geometric optimization problem. We are seeking to make the total resonant field $\\tilde{b}_{r}$ have a magnitude of $B_{c}$ by adding an RMP-induced field $\\tilde{b}_{\\mathrm{RMP}}$ to the intrinsic field $\\tilde{b}_{i}$, using the minimum possible RMP amplitude, which means minimizing $|\\tilde{b}_{\\mathrm{RMP}}|=|H| b_{c}$.\nThe vector relationship is $\\tilde{b}_{\\mathrm{RMP}} = \\tilde{b}_{r} - \\tilde{b}_{i}$. We want to minimize $|\\tilde{b}_{\\mathrm{RMP}}|$.\nHere, $\\tilde{b}_{i}$ is a fixed vector in the complex plane, and $\\tilde{b}_{r}$ can be any vector whose tip lies on a circle of radius $B_{c}$ centered at the origin. We want to find the point on this circle that is closest to the tip of the vector $\\tilde{b}_{i}$.\nThe minimum distance between a point and a circle occurs along the line connecting the point to the center of the circle. The minimum value of $|\\tilde{b}_{r} - \\tilde{b}_{i}|$ is therefore $||\\tilde{b}_{r}| - |\\tilde{b}_{i}|| = |B_{c} - b_{i}|$.\nThis minimum is achieved when $\\tilde{b}_{r}$ and $\\tilde{b}_{i}$ are collinear. The phase of the required $\\tilde{b}_{\\mathrm{RMP}}$ vector determines the optimal coil phase.\n\nThe problem states that the plasma has a pre-lock rotation frequency $\\omega_{0}$. This implies that the intrinsic error field $\\tilde{b}_{i}$ by itself is insufficient to cause mode locking. The maximum torque from the intrinsic field alone is $K|\\tilde{b}_{i}| = K b_{i}$. For the mode to remain unlocked, this torque must be less than the driving torque $T_{\\mathrm{rot}}$.\n$$K b_{i}  T_{\\mathrm{rot}}$$\nUsing the definition $B_{c} = T_{\\mathrm{rot}}/K$, this implies:\n$$K b_{i}  K B_{c} \\implies b_{i}  B_{c}$$\nThis physical constraint is critical. Since $b_{i}  B_{c}$, the magnitude of the intrinsic field is less than the target magnitude for locking. To minimize the applied field amplitude $|\\tilde{b}_{\\mathrm{RMP}}|$, we must apply a field that is \"constructive\", i.e., aligned with the intrinsic error field, to increase the total field magnitude most efficiently.\nThe minimum required $|\\tilde{b}_{\\mathrm{RMP}}|$ is $|B_{c} - b_{i}| = B_{c} - b_{i}$. This occurs when $\\tilde{b}_{r}$ and $\\tilde{b}_{i}$ are collinear and point in the same direction.\nIn this optimal case, the phase of $\\tilde{b}_{\\mathrm{RMP}} = \\tilde{b}_{r} - \\tilde{b}_{i}$ must be the same as the phase of $\\tilde{b}_{i}$.\n$$\\mathrm{phase}(\\tilde{b}_{\\mathrm{RMP}}) = \\mathrm{phase}(\\tilde{b}_{i})$$\nThe phase of the RMP contribution is given by $\\phi_{c} + \\phi_{H}$, and the phase of the intrinsic field is $\\phi_{i}$. For the optimal setting, $\\phi_{c} = \\phi_{\\mathrm{opt}}$:\n$$\\phi_{\\mathrm{opt}} + \\phi_{H} = \\phi_{i}$$\nSolving for the optimal coil phase gives the final answer:\n$$\\phi_{\\mathrm{opt}} = \\phi_{i} - \\phi_{H}$$\nThis corresponds to error field *amplification*, where the phase of the applied RMP is set to match the phase of the amplified plasma response to the intrinsic error field itself, thereby reinforcing it to cross the locking threshold.", "answer": "$$\n\\boxed{\\phi_i - \\phi_H}\n$$", "id": "3708780"}]}