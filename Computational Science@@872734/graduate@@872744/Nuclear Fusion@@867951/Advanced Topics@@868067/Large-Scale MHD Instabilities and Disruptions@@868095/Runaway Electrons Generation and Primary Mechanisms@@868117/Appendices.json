{"hands_on_practices": [{"introduction": "The genesis of a runaway electron lies in a fundamental contest between the accelerating force of a parallel electric field and the frictional drag from Coulomb collisions. This exercise drills down into this core concept, asking you to determine the critical momentum an electron must have for its acceleration to outpace collisional drag under a specific electric field strength. Mastering this calculation solidifies the understanding of the relativistic effects on collisional friction, which is the cornerstone of runaway electron theory [@problem_id:3717557].", "problem": "Consider a homogeneous, fully ionized plasma relevant to magnetic confinement nuclear fusion, with electron number density $n_{e}$, effective ion charge $Z_{\\mathrm{eff}}$, and Coulomb logarithm (the natural logarithm of the ratio of maximum to minimum impact parameters in Coulomb collisions, denoted $\\ln\\Lambda$). A test electron experiences small-angle binary Coulomb collisions with background electrons, leading to a relativistic parallel drag force. Starting from the standard slowing-down picture in which the collisional slowing-down frequency scales as $\\nu_{s}\\propto n_{e}e^{4}\\ln\\Lambda/\\left(4\\pi\\epsilon_{0}^{2}m_{e}^{2}v^{3}\\right)$, and using $F_{\\parallel}^{\\mathrm{coll}}(v)=m_{e}v\\,\\nu_{s}$, derive the momentum-dependent parallel collisional drag $F_{\\parallel}^{\\mathrm{coll}}(v)$ for a relativistic test electron with speed $v$, expressed in terms of the asymptotic balance at $v\\rightarrow c$. Define the Connor–Hastie critical electric field $E_{c}$ as the constant parallel field for which the electric force $eE_{c}$ equals the asymptotic ($v\\rightarrow c$) collisional drag. Then, for a given parallel electric field $E_{\\parallel}$, define the critical momentum $p_{c}$ by the condition of force balance $eE_{\\parallel}=F_{\\parallel}^{\\mathrm{coll}}(p_{c})$.\n\nAssume that radiation reaction forces (e.g., synchrotron and bremsstrahlung) are negligible and that energy drag is dominated by electron–electron collisions. For the specific case $E_{\\parallel}=2E_{c}$, compute $p_{c}$ and express your final numerical value in the International System of Units (SI) as $\\mathrm{kg\\,m\\,s^{-1}}$, rounded to four significant figures. Finally, within the adopted model, discuss the sensitivity of $p_{c}$ to variations in $Z_{\\mathrm{eff}}$ and $\\ln\\Lambda$.", "solution": "The problem asks for the derivation of the relativistic parallel collisional drag force, the calculation of a critical momentum $p_c$ under a specific electric field, and a discussion of the result's sensitivity to plasma parameters.\n\nFirst, we validate the problem statement.\nThe givens are: a homogeneous, fully ionized plasma with electron number density $n_e$, effective ion charge $Z_{\\mathrm{eff}}$, and Coulomb logarithm $\\ln\\Lambda$. The non-relativistic collisional slowing-down frequency is given to scale as $\\nu_{s}\\propto n_{e}e^{4}\\ln\\Lambda/\\left(4\\pi\\epsilon_{0}^{2}m_{e}^{2}v^{3}\\right)$, and the associated drag force is $F_{\\parallel}^{\\mathrm{coll}}(v)=m_{e}v\\,\\nu_{s}$. The Connor-Hastie critical field $E_c$ is defined by the balance between the electric force $eE_c$ and the asymptotic collisional drag at $v\\rightarrow c$. The critical momentum $p_c$ is defined by the force balance $eE_{\\parallel}=F_{\\parallel}^{\\mathrm{coll}}(p_{c})$ for a given parallel electric field $E_{\\parallel}$. Radiation effects are considered negligible, and energy drag is dominated by electron-electron collisions. The specific case to be analyzed is $E_{\\parallel}=2E_{c}$.\n\nThe problem is scientifically grounded in the established theory of collisional transport and runaway electron dynamics in fusion plasmas. It is well-posed, as the definitions are precise and the parameters required for a numerical answer cancel out, making it self-contained. The language is objective and the assumptions are standard simplifications in this context. The problem is therefore deemed valid.\n\nWe begin by formalizing the parallel collisional drag force, $F_{\\parallel}^{\\mathrm{coll}}$. The problem provides the non-relativistic scaling $\\nu_{s} \\propto v^{-3}$, leading to a force $F_{\\parallel}^{\\mathrm{coll}} \\propto v^{-2}$. This serves as the low-energy limit. The correct relativistic generalization for the magnitude of the parallel collisional drag force on a test electron with momentum $p$ and Lorentz factor $\\gamma = \\sqrt{1 + p^2/(m_e^2 c^2)}$, assuming energy drag is dominated by electron-electron collisions, is given by:\n$$\n|F_{\\parallel}^{\\mathrm{coll}}(p)| = \\frac{n_{e}e^{4}\\ln\\Lambda}{4\\pi\\epsilon_{0}^{2}m_{e}c^{2}} \\frac{\\gamma^2}{\\gamma^2-1}\n$$\nThis formula describes the drag force from background electrons, which dominates the energy loss as specified in the problem.\n\nThe first task is to express this force in terms of its asymptotic value as $v \\rightarrow c$. As $v \\rightarrow c$, the momentum $p \\rightarrow \\infty$ and the Lorentz factor $\\gamma \\rightarrow \\infty$. In this limit, the term $\\gamma^2/(\\gamma^2-1)$ approaches $1$. The asymptotic drag force, which we denote $F_{\\mathrm{asym}}$, is therefore:\n$$\nF_{\\mathrm{asym}} = \\lim_{p\\to\\infty} |F_{\\parallel}^{\\mathrm{coll}}(p)| = \\frac{n_{e}e^{4}\\ln\\Lambda}{4\\pi\\epsilon_{0}^{2}m_{e}c^{2}}\n$$\nNow, we can express the momentum-dependent drag force in terms of $F_{\\mathrm{asym}}$. Using the relativistic relation $p^2 = (\\gamma^2 - 1)m_e^2 c^2$, we can write the factor $\\gamma^2/(\\gamma^2-1)$ in terms of momentum $p$:\n$$\n\\frac{\\gamma^2}{\\gamma^2-1} = \\frac{1 + p^2/(m_e^2 c^2)}{p^2/(m_e^2 c^2)} = 1 + \\frac{m_e^2 c^2}{p^2}\n$$\nSubstituting this back into the expression for the drag force, we obtain the desired form:\n$$\n|F_{\\parallel}^{\\mathrm{coll}}(p)| = F_{\\mathrm{asym}} \\left(1 + \\frac{m_e^2 c^2}{p^2}\\right)\n$$\nThis expression shows how the drag force decreases from an infinite value at $p=0$ towards its constant asymptotic value $F_{\\mathrm{asym}}$ as $p \\rightarrow \\infty$.\n\nNext, we use the problem's definition for the critical electric field $E_c$. It is defined by the condition that the electric force $eE_c$ balances the asymptotic collisional drag:\n$$\neE_c = F_{\\mathrm{asym}}\n$$\nThe problem then asks to find the critical momentum $p_c$ for an applied parallel electric field $E_{\\parallel} = 2E_c$. The critical momentum $p_c$ is determined by the force balance between the accelerating electric field and the collisional drag:\n$$\neE_{\\parallel} = |F_{\\parallel}^{\\mathrm{coll}}(p_c)|\n$$\nSubstituting $E_{\\parallel} = 2E_c$ into the balance equation:\n$$\ne(2E_c) = |F_{\\parallel}^{\\mathrm{coll}}(p_c)|\n$$\nNow we replace $|F_{\\parallel}^{\\mathrm{coll}}(p_c)|$ with its derived expression in terms of $F_{\\mathrm{asym}}$ and $p_c$:\n$$\n2(eE_c) = F_{\\mathrm{asym}} \\left(1 + \\frac{m_e^2 c^2}{p_c^2}\\right)\n$$\nUsing the definition $eE_c = F_{\\mathrm{asym}}$, the equation simplifies significantly:\n$$\n2F_{\\mathrm{asym}} = F_{\\mathrm{asym}} \\left(1 + \\frac{m_e^2 c^2}{p_c^2}\\right)\n$$\nSince $F_{\\mathrm{asym}}$ is non-zero, we can divide both sides by it:\n$$\n2 = 1 + \\frac{m_e^2 c^2}{p_c^2}\n$$\nSolving for $p_c$:\n$$\n1 = \\frac{m_e^2 c^2}{p_c^2} \\implies p_c^2 = m_e^2 c^2 \\implies p_c = m_e c\n$$\nThe critical momentum is simply the product of the electron rest mass and the speed of light.\n\nTo find the numerical value, we use the CODATA recommended values for the electron rest mass, $m_e = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$, and the speed of light in vacuum, $c = 299792458\\,\\mathrm{m\\,s^{-1}}$.\n$$\np_c = (9.1093837 \\times 10^{-31}\\,\\mathrm{kg}) \\times (299792458\\,\\mathrm{m\\,s^{-1}}) \\approx 2.7309245 \\times 10^{-22}\\,\\mathrm{kg\\,m\\,s^{-1}}\n$$\nRounding to four significant figures as requested:\n$$\np_c \\approx 2.731 \\times 10^{-22}\\,\\mathrm{kg\\,m\\,s^{-1}}\n$$\n\nFinally, we discuss the sensitivity of $p_c$ to variations in $Z_{\\mathrm{eff}}$ and $\\ln\\Lambda$. In our derivation, the equation that determined $p_c$ was $2 = 1 + m_e^2 c^2 / p_c^2$. The parameters characterizing the plasma—$n_e$ and $\\ln\\Lambda$—were all contained within the term $F_{\\mathrm{asym}}$. The parameter $Z_{\\mathrm{eff}}$ did not appear in the correct drag formula. Because $F_{\\mathrm{asym}}$ appeared as a common factor on both sides of the force balance equation, it canceled out. As a result, the value of $p_c = m_e c$ is entirely independent of $n_e$, $Z_{\\mathrm{eff}}$, and $\\ln\\Lambda$. Within the adopted model, the sensitivity of $p_c$ to variations in $Z_{\\mathrm{eff}}$ and $\\ln\\Lambda$ is exactly zero. This is a consequence of defining the critical momentum relative to the asymptotic drag force, which is itself scaled by the same plasma parameters.", "answer": "$$\\boxed{2.731 \\times 10^{-22}}$$", "id": "3717557"}, {"introduction": "The most dramatic runaway electron phenomenon is the avalanche, where a single high-energy electron can generate a cascade of secondaries. To model this, we must translate the physics of individual large-angle scattering events into a source term within a kinetic equation. This practice guides you through the formal derivation of the avalanche source term, starting from the Møller scattering cross section, providing a crucial link between microscopic collision physics and the macroscopic description of the runaway population [@problem_id:3717592].", "problem": "Consider a homogeneous, magnetized plasma relevant to nuclear fusion that contains a population of primary runaway electrons. Let the electron momentum be denoted by $p = \\gamma m_{e} v$, with $m_{e}$ the electron mass, $v$ the speed, and $\\gamma = (1-v^{2}/c^{2})^{-1/2}$ the Lorentz factor, where $c$ is the speed of light. Define the pitch-angle cosine as $\\xi = p_{\\parallel}/p$, where $p_{\\parallel}$ is the component of momentum along the accelerating electric field. The primary runaway electron distribution is $f(p,\\xi)$, assumed gyrotropic so that there is azimuthal symmetry about the field direction. Secondary (avalanche) runaway electrons are generated by large-angle electron-electron collisions governed by the Møller scattering cross section. The plasma consists of ions with number densities $n_{i}$ and charge states $Z_{i}$ and electrons with total free-electron density $n_{e}$. Define the effective ion charge as $Z_{\\mathrm{eff}} = \\sum_{i} n_{i} Z_{i}^{2} / n_{e}$ (effective ion charge), and the classical electron radius $r_{e} = e^{2}/(4\\pi \\epsilon_{0} m_{e} c^{2})$, where $e$ is the elementary charge and $\\epsilon_{0}$ is the vacuum permittivity. Let $\\ln \\Lambda$ be the Coulomb logarithm.\n\nStarting from the Boltzmann source term for binary collisions and using the Møller differential cross section in the laboratory frame (with the target electron initially at rest), derive the homogeneous-plasma avalanche source term $S_{\\mathrm{av}}(p,\\xi)$, expressed as an integral over the primary distribution $f(p_{1},\\xi_{1})$ and the Møller differential cross section. Clearly identify the kinematic measure and any delta functions needed to ensure energy-momentum conservation, but do not assume a specific explicit form of the Møller cross section.\n\nThen, using first principles of force balance between electric-field acceleration and collisional friction for relativistic electrons, show how $Z_{\\mathrm{eff}}$ modifies the effective target electron density and the linear avalanche growth rate. In particular, define the Connor–Hastie critical electric field $E_{c}(Z_{\\mathrm{eff}})$ and provide the dependence of the linear avalanche growth rate $\\Gamma_{\\mathrm{av}}(E,Z_{\\mathrm{eff}})$ on the applied electric field $E$ and $Z_{\\mathrm{eff}}$, keeping the dependence on the Møller cross section and $\\ln \\Lambda$ explicit and scientifically justified.\n\nExpress your final answers symbolically in terms of $n_{e}$, $f$, $v$, $r_{e}$, $e$, $m_{e}$, $c$, $\\epsilon_{0}$, $\\ln \\Lambda$, and the Møller differential cross section $d\\sigma_{\\mathrm{M}}/d\\Omega$ in the laboratory frame. Return your final answer as a row matrix containing, in order: the derived source term $S_{\\mathrm{av}}(p,\\xi)$, the effective target density $n_{\\mathrm{t,eff}}$, and the linear avalanche growth rate $\\Gamma_{\\mathrm{av}}(E,Z_{\\mathrm{eff}})$. No numerical evaluation is required.", "solution": "The problem is assessed to be valid as it is scientifically grounded in established principles of plasma physics and relativistic mechanics, is well-posed, objective, and contains sufficient information for a formal derivation.\n\nThe problem asks for three quantities to be derived: the avalanche source term $S_{\\mathrm{av}}(p,\\xi)$, the effective target density for avalanche $n_{\\mathrm{t,eff}}$, and the linear avalanche growth rate $\\Gamma_{\\mathrm{av}}(E,Z_{\\mathrm{eff}})$.\n\n### Part 1: Avalanche Source Term $S_{\\mathrm{av}}(p,\\xi)$\n\nThe avalanche source term $S_{\\mathrm{av}}(p,\\xi)$ describes the rate of generation of electrons per unit volume in the phase space element $d^3p = 2\\pi p^2 dp d\\xi$. These new electrons are generated when primary runaway electrons, described by the distribution function $f(p_1, \\xi_1)$, collide with stationary target electrons in the background plasma. The target electrons have a number density $n_e$. The collision process is Møller scattering ($e^- + e^- \\to e^- + e^-$).\n\nLet a primary runaway electron have momentum $\\vec{p}_1$ and velocity $\\vec{v}_1$. The rate at which these electrons cause scattering events in a volume $dV$ is $n_e v_1 f(p_1, \\xi_1) d^3p_1 dV$. Each scattering event is characterized by the differential cross section $\\frac{d\\sigma_{\\mathrm{M}}}{d\\Omega_{out}}$, where $\\Omega_{out}$ is the solid angle of one of the outgoing electrons in the laboratory frame.\n\nFor a given initial momentum $\\vec{p}_1$ and a given scattering solid angle $\\Omega_{out}$, the momenta of the two outgoing electrons, $\\vec{p}_A$ and $\\vec{p}_B$, are uniquely determined by energy and momentum conservation. Since electrons are indistinguishable, the Møller cross-section formalism accounts for both the \"scattered\" and \"recoil\" electrons.\n\nThe source term $S_{\\mathrm{av}}(\\vec{p})$ at a specific momentum $\\vec{p}$ is obtained by integrating over all possible initial runaway electron states $(\\vec{p}_1)$ and all possible scattering outcomes $(\\Omega_{out})$ that can produce an electron with final momentum $\\vec{p}$. This can be formally expressed using Dirac delta functions to enforce the kinematic constraints.\n\n$S_{\\mathrm{av}}(\\vec{p}) = \\int d^3p_1 \\int d\\Omega_{out} \\, n_e v_1 f(\\vec{p}_1) \\frac{d\\sigma_{\\mathrm{M}}}{d\\Omega_{out}} \\left[ \\delta^{(3)}(\\vec{p} - \\vec{p}_A(\\vec{p}_1, \\Omega_{out})) + \\delta^{(3)}(\\vec{p} - \\vec{p}_B(\\vec{p}_1, \\Omega_{out})) \\right]$\n\nThe problem assumes azimuthal symmetry (gyrotropy), so the source term depends only on the momentum magnitude $p$ and the pitch-angle cosine $\\xi$. We obtain $S_{\\mathrm{av}}(p, \\xi)$ by averaging $S_{\\mathrm{av}}(\\vec{p})$ over the azimuthal angle $\\phi$ corresponding to the direction of $\\vec{p}$. The phase space volume element is $d^3p = p^2 dp d\\Omega_p = 2\\pi p^2 dp d\\xi$. The source term is a density in $(p, \\xi)$ space, so we must also normalize by the Jacobian of this transformation.\n\nThe resulting expression for the gyrotropic source term is:\n$S_{\\mathrm{av}}(p, \\xi) = \\frac{1}{2\\pi p^2} \\int d^3p_1 \\int d\\Omega_{out} \\, n_e v_1 f(p_1, \\xi_1) \\frac{d\\sigma_{\\mathrm{M}}}{d\\Omega_{out}} \\left[ \\delta(p - p_A) \\delta(\\xi - \\xi_A) + \\delta(p - p_B) \\delta(\\xi - \\xi_B) \\right]$\nIn this expression, $p_A, \\xi_A, p_B, \\xi_B$ are scalar functions representing the final momenta and pitch-angle cosines of the two outgoing electrons. These are determined by the initial state $(p_1, \\xi_1)$ and the collision geometry encapsulated by $\\Omega_{out}$, after averaging over the initial and final azimuthal angles to enforce gyrotropy. The kinematic measure is $d^3p_1 \\, d\\Omega_{out}$, and the delta functions enforce energy-momentum conservation for each scattering event contributing to the source at $(p, \\xi)$.\n\n### Part 2: Effective Target Density and Critical Electric Field\n\nThe linear avalanche growth rate is determined by the interplay between acceleration by the electric field $E$ and deceleration by collisional friction (drag). A runaway electron is subject to drag from both background electrons and ions.\n\nThe drag force $F_{\\mathrm{drag}}$ on a highly relativistic electron ($v \\approx c$) due to small-angle Coulomb collisions is the sum of forces from electrons and ions:\n$F_{\\mathrm{drag}} = F_{e} + \\sum_i F_{i}$\nThe force from a species $s$ is proportional to its density $n_s$ and the square of its charge $Z_s^2$. Assuming a common Coulomb logarithm $\\ln \\Lambda$ for high-energy interactions:\n$F_{\\mathrm{drag}} \\propto n_e e^2 + \\sum_i n_i (Z_i e)^2 = e^2 \\left( n_e + \\sum_i n_i Z_i^2 \\right)$\nUsing the definition of the effective ion charge, $Z_{\\mathrm{eff}} = \\sum_i n_i Z_i^2 / n_e$, we can write:\n$F_{\\mathrm{drag}} \\propto e^2 (n_e + n_e Z_{\\mathrm{eff}}) = e^2 n_e (1+Z_{\\mathrm{eff}})$\nThis shows that for collisional drag, the plasma acts like a medium of particles with total \"charge-squared density\" corresponding to an effective density of $n_e(1+Z_{\\mathrm{eff}})$.\n\nHowever, the question asks for the **effective target electron density for avalanche generation**. The avalanche mechanism is Møller scattering, which is an electron-electron collision. Ions do not participate as targets for producing secondary electrons. Therefore, the density of targets for the avalanche process is simply the free electron density $n_e$.\n$n_{\\mathrm{t,eff}} = n_e$\n\nThe Connor-Hastie critical electric field, here denoted $E_c(Z_{\\mathrm{eff}})$, is the field required to balance the collisional drag force on a relativistic electron, thereby preventing it from running away.\n$e E_c(Z_{\\mathrm{eff}}) = F_{\\mathrm{drag}}(\\gamma \\to \\infty)$\nThe drag force on a relativistic electron is given by:\n$F_{\\mathrm{drag}} = \\frac{e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e c^2} \\left[ n_e + \\sum_i n_i Z_i^2 \\right] = \\frac{n_e e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e c^2}(1+Z_{\\mathrm{eff}})$\nThus, the critical field is:\n$E_c(Z_{\\mathrm{eff}}) = \\frac{n_e e^3 \\ln \\Lambda}{4\\pi\\epsilon_0^2 m_e c^2}(1+Z_{\\mathrm{eff}})$\n\n### Part 3: Linear Avalanche Growth Rate $\\Gamma_{\\mathrm{av}}(E, Z_{\\mathrm{eff}})$\n\nThe avalanche growth rate $\\Gamma_{\\mathrm{av}}$ is the rate at which new runaway electrons are produced per existing runaway electron. A secondary electron can become a runaway only if its initial energy after the collision is above a certain critical energy, $\\mathcal{E}_{\\mathrm{crit}}$.\n\nThe critical energy is the energy at which the accelerating force from the applied electric field $E$ balances the collisional drag force $F_{\\mathrm{drag}}(\\mathcal{E})$.\n$eE = F_{\\mathrm{drag}}(\\mathcal{E}_{\\mathrm{crit}})$\nFor a relativistic electron with Lorentz factor $\\gamma$, the drag force is approximately $F_{\\mathrm{drag}}(\\gamma) \\approx e E_c(Z_{\\mathrm{eff}}) \\frac{\\gamma^2}{\\gamma^2-1}$.\nThe balance equation becomes $E/E_c(Z_{\\mathrm{eff}}) = \\gamma_{\\mathrm{crit}}^2 / (\\gamma_{\\mathrm{crit}}^2 - 1)$, which is valid for $E > E_c(Z_{\\mathrm{eff}})$. This yields the critical Lorentz factor:\n$\\gamma_{\\mathrm{crit}} = \\left(1 - \\frac{E_c(Z_{\\mathrm{eff}})}{E}\\right)^{-1/2}$\nThe corresponding critical kinetic energy is $\\mathcal{E}_{\\mathrm{crit}} = (\\gamma_{\\mathrm{crit}} - 1)m_e c^2$.\n\nThe growth rate is the rate of Møller collisions per primary runaway that produce a secondary with energy $W > \\mathcal{E}_{\\mathrm{crit}}$. Assuming the primary runaway is highly relativistic ($v_1 \\approx c$), this rate is:\n$\\Gamma_{\\mathrm{av}} = n_e v_1 \\int_{\\mathcal{E}_{\\mathrm{crit}}}^{\\mathcal{E}_1/2} \\frac{d\\sigma_{\\mathrm{M}}}{dW} dW \\approx n_e c \\int_{\\mathcal{E}_{\\mathrm{crit}}}^{\\infty} \\frac{d\\sigma_{\\mathrm{M}}}{dW} dW$\nwhere $d\\sigma_{\\mathrm{M}}/dW$ is the Møller differential cross section with respect to the kinetic energy $W$ transferred to the target electron. The upper integration limit is taken to infinity, assuming the primary electron energy $\\mathcal{E}_1 \\gg \\mathcal{E}_{\\mathrm{crit}}$. The cross section $d\\sigma_{\\mathrm{M}}/dW$ is kinematically related to the given $d\\sigma_{\\mathrm{M}}/d\\Omega$ but is more suitable for this calculation. The dependence on the Møller cross section is kept explicit via this integral. For $E \\le E_c(Z_{\\mathrm{eff}})$, the critical energy is infinite or undefined, and the growth rate is zero.\n\nThe three requested quantities are summarized in the final answer.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{n_e}{2\\pi p^2} \\int d^3p_1 \\int d\\Omega_{out} \\, v_1 f(p_1, \\xi_1) \\frac{d\\sigma_{\\mathrm{M}}}{d\\Omega_{out}} \\left[ \\delta(p - p_A) \\delta(\\xi - \\xi_A) + \\delta(p - p_B) \\delta(\\xi - \\xi_B) \\right]  n_e  n_e c \\int_{(\\gamma_{crit} - 1)m_e c^2}^{\\infty} \\frac{d\\sigma_{\\mathrm{M}}}{dW} dW \\end{pmatrix} } $$", "id": "3717592"}, {"introduction": "To understand the full impact of runaway electrons during a tokamak disruption, we must consider the feedback between the growing runaway population and the plasma's overall electromagnetic environment. This computational exercise challenges you to implement a self-consistent model that couples the kinetic equations for runaway current growth with the L-R circuit equation governing the total plasma current. This practice demonstrates how the theoretical concepts of critical fields and avalanche growth are integrated into a predictive, time-dependent simulation, bridging the gap between theory and practical modeling [@problem_id:3717577].", "problem": "You must design and implement a self-consistent time-integration scheme that couples a reduced kinetic model of runaway-electron current to a lumped-element inductance–resistance ($L\\!-\\!R$) circuit model of the plasma to compute the parallel electric field $E_{\\parallel}(t)$ during a disruption-like transient. The modeling must be built from the following fundamental base without invoking any shortcut formulas that presuppose the desired result.\n\nFundamental base and definitions:\n- Maxwell–Faraday law (integral form): the line integral of the electric field $E_{\\parallel}$ around the plasma loop relates to the rate of change of magnetic flux and any applied transformer drive. In a lumped-element representation, this motivates the standard $L\\!-\\!R$ circuit equation for the total plasma current $I_{\\mathrm{tot}}(t)$ when represented by a self-inductance $L$ and a time-dependent effective thermal resistance $R_{\\mathrm{th}}(t)$.\n- Total plasma current decomposition: $I_{\\mathrm{tot}}(t) = I_{\\mathrm{th}}(t) + I_{\\mathrm{re}}(t)$, where $I_{\\mathrm{th}}(t)$ is the collisional thermal-electron current and $I_{\\mathrm{re}}(t)$ is the runaway-electron current.\n- Circuit dynamics with transformer drive $V_{\\mathrm{tr}}(t)$:\n  $$ L \\, \\frac{d I_{\\mathrm{tot}}}{d t} + R_{\\mathrm{th}}(t) \\, I_{\\mathrm{th}}(t) = V_{\\mathrm{tr}}(t). $$\n- Definition of the parallel electric field felt by the bulk (collisional) electrons:\n  $$ E_{\\parallel}(t) = \\frac{R_{\\mathrm{th}}(t)}{\\ell} \\, I_{\\mathrm{th}}(t), $$\n  where $\\ell$ is the effective toroidal loop length over which the parallel field is taken, assumed spatially uniform for this zero-dimensional model.\n- Reduced kinetic runaway-electron current model (zeroth-moment closure of a Fokker–Planck picture): the runaway-electron current evolves according to a source–growth model driven by the parallel electric field,\n  $$ \\frac{d I_{\\mathrm{re}}}{d t} = \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}\\right) \\, I_{\\mathrm{re}} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}\\right), $$\n  where the avalanche growth rate is modeled as\n  $$ \\gamma_{\\mathrm{ava}}(E_{\\parallel}) = \\frac{1}{\\tau_{\\mathrm{ava}}} \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right), $$\n  and the primary (seed) source is modeled as\n  $$ S_{\\mathrm{pri}}(E_{\\parallel}) = S_0 \\, \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right). $$\n  Here $E_{\\mathrm{c}}$ is the critical electric field and $\\tau_{\\mathrm{ava}}$ and $S_0$ are model parameters.\n\nDesign a numerically stable, self-consistent time-stepping scheme on $t \\in [0, T_{\\text{end}}]$ that simultaneously updates $I_{\\mathrm{re}}$, $I_{\\mathrm{tot}}$, and $E_{\\parallel}$. Your scheme must:\n- Use the circuit equation to implicitly update $I_{\\mathrm{tot}}$ at each step to avoid stiffness from the $L\\!-\\!R$ term, while using the most recent updated $I_{\\mathrm{re}}$ in that step.\n- Use the kinetic equations to update $I_{\\mathrm{re}}$ using the parallel field from the previous substep in the same time step to maintain causality and monotonic stability.\n- Close the system by computing $I_{\\mathrm{th}} = I_{\\mathrm{tot}} - I_{\\mathrm{re}}$, and then $E_{\\parallel} = \\left(R_{\\mathrm{th}}/\\ell\\right) I_{\\mathrm{th}}$ at each substep to feed back into the kinetics.\n\nA single time step from $t_n$ to $t_{n+1} = t_n + \\Delta t$ must therefore proceed in the order:\n1. Evaluate $E_{\\parallel}^{(n)} = \\left(R_{\\mathrm{th}}^{(n)}/\\ell \\right) \\left(I_{\\mathrm{tot}}^{(n)} - I_{\\mathrm{re}}^{(n)}\\right)$.\n2. Update $I_{\\mathrm{re}}$ explicitly with $E_{\\parallel}^{(n)}$:\n   $$ I_{\\mathrm{re}}^{(n+1)} = I_{\\mathrm{re}}^{(n)} + \\Delta t \\left[ \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}^{(n)}\\right) I_{\\mathrm{re}}^{(n)} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}^{(n)}\\right) \\right]. $$\n3. Update $I_{\\mathrm{tot}}$ implicitly using backward Euler on the circuit:\n   $$ I_{\\mathrm{tot}}^{(n+1)} = \\frac{ I_{\\mathrm{tot}}^{(n)} + \\frac{\\Delta t}{L} \\left( V_{\\mathrm{tr}}^{(n+1)} + R_{\\mathrm{th}}^{(n+1)} I_{\\mathrm{re}}^{(n+1)} \\right)}{ 1 + \\frac{\\Delta t}{L} R_{\\mathrm{th}}^{(n+1)} }. $$\n4. Compute $I_{\\mathrm{th}}^{(n+1)} = I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}$ and $E_{\\parallel}^{(n+1)} = \\left(R_{\\mathrm{th}}^{(n+1)}/\\ell\\right) I_{\\mathrm{th}}^{(n+1)}$.\n\nAll physical quantities must be in the International System of Units. Angles do not appear. If any ratio is demanded that could be a percentage, express it in decimal form.\n\nImplement the above scheme as a complete, runnable program that computes the evolution for a specified finite set of test cases, each defined by parameters $\\{L, \\ell, R_{\\mathrm{th}}(t), V_{\\mathrm{tr}}(t), E_{\\mathrm{c}}, \\tau_{\\mathrm{ava}}, S_0, I_{\\mathrm{tot}}(0), I_{\\mathrm{re}}(0), T_{\\text{end}}, \\Delta t\\}$.\n\nTest suite to cover distinct behaviors:\n- Case A (sub-threshold decay, no avalanche): $L = 10^{-3}\\,\\mathrm{H}$, $\\ell = 2 \\pi \\times 3\\,\\mathrm{m}$, $R_{\\mathrm{th}}(t) = 10^{-5}\\,\\Omega$ for all $t$, $V_{\\mathrm{tr}}(t) = 0\\,\\mathrm{V}$, $E_{\\mathrm{c}} = 0.05\\,\\mathrm{V/m}$, $\\tau_{\\mathrm{ava}} = 0.01\\,\\mathrm{s}$, $S_0 = 100\\,\\mathrm{A/s}$, $I_{\\mathrm{tot}}(0) = 5 \\times 10^{4}\\,\\mathrm{A}$, $I_{\\mathrm{re}}(0) = 0\\,\\mathrm{A}$, $T_{\\text{end}} = 0.02\\,\\mathrm{s}$, $\\Delta t = 10^{-5}\\,\\mathrm{s}$.\n- Case B (slightly supercritical, weak avalanche): $L = 10^{-3}\\,\\mathrm{H}$, $\\ell = 2 \\pi \\times 3\\,\\mathrm{m}$, $R_{\\mathrm{th}}(t) = 10^{-5}\\,\\Omega$ for all $t$, $V_{\\mathrm{tr}}(t) = 0\\,\\mathrm{V}$, $E_{\\mathrm{c}} = 0.05\\,\\mathrm{V/m}$, $\\tau_{\\mathrm{ava}} = 0.01\\,\\mathrm{s}$, $S_0 = 200\\,\\mathrm{A/s}$, $I_{\\mathrm{tot}}(0) = 10^{5}\\,\\mathrm{A}$, $I_{\\mathrm{re}}(0) = 1\\,\\mathrm{A}$, $T_{\\text{end}} = 0.02\\,\\mathrm{s}$, $\\Delta t = 10^{-5}\\,\\mathrm{s}$.\n- Case C (thermal quench jump in resistance, strong avalanche): $L = 10^{-3}\\,\\mathrm{H}$, $\\ell = 2 \\pi \\times 3\\,\\mathrm{m}$, $R_{\\mathrm{th}}(t) = 10^{-5}\\,\\Omega$ for $t  10^{-3}\\,\\mathrm{s}$ and $R_{\\mathrm{th}}(t) = 5\\times 10^{-4}\\,\\Omega$ for $t \\ge 10^{-3}\\,\\mathrm{s}$, $V_{\\mathrm{tr}}(t) = 0\\,\\mathrm{V}$, $E_{\\mathrm{c}} = 0.05\\,\\mathrm{V/m}$, $\\tau_{\\mathrm{ava}} = 5\\times 10^{-3}\\,\\mathrm{s}$, $S_0 = 500\\,\\mathrm{A/s}$, $I_{\\mathrm{tot}}(0) = 8 \\times 10^{4}\\,\\mathrm{A}$, $I_{\\mathrm{re}}(0) = 0\\,\\mathrm{A}$, $T_{\\text{end}} = 0.005\\,\\mathrm{s}$, $\\Delta t = 10^{-6}\\,\\mathrm{s}$.\n\nRequired outputs:\n- For each case, at $t = T_{\\text{end}}$, report the triple $[E_{\\parallel}(T_{\\text{end}}), I_{\\mathrm{re}}(T_{\\text{end}}), I_{\\mathrm{tot}}(T_{\\text{end}})]$ where $E_{\\parallel}$ is expressed in $\\mathrm{V/m}$ and the currents in $\\mathrm{A}$.\n- Round $E_{\\parallel}(T_{\\text{end}})$ to six digits after the decimal point. Round $I_{\\mathrm{re}}(T_{\\text{end}})$ and $I_{\\mathrm{tot}}(T_{\\text{end}})$ to the nearest integer.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one triple per test case, for example: $[[e_1,i_{\\mathrm{re},1},i_{\\mathrm{tot},1}],[e_2,i_{\\mathrm{re},2},i_{\\mathrm{tot},2}],\\ldots]$, where each item is a number as specified above.", "solution": "The user requests the design and implementation of a time-integration scheme to model the evolution of runaway-electron current in a tokamak plasma during a disruption. The model couples a zero-dimensional kinetic description for the runaway current with a lumped-element $L-R$ circuit model for the total plasma current. The problem is well-posed, scientifically grounded in established plasma physics models, and provides all necessary parameters and a specific numerical algorithm to be implemented.\n\n**1. Physical and Mathematical Model**\n\nThe system's dynamics are governed by a set of coupled differential-algebraic equations.\n\n**a. Circuit Dynamics:**\nThe plasma is modeled as a toroidal conductor with self-inductance $L$ and a time-varying thermal resistance $R_{\\mathrm{th}}(t)$. The evolution of the total plasma current $I_{\\mathrm{tot}}(t)$ is described by the $L-R$ circuit equation, which is a consequence of the Maxwell-Faraday law of induction:\n$$\nL \\, \\frac{d I_{\\mathrm{tot}}}{d t} + R_{\\mathrm{th}}(t) \\, I_{\\mathrm{th}}(t) = V_{\\mathrm{tr}}(t)\n$$\nHere, $V_{\\mathrm{tr}}(t)$ is an externally applied voltage from the tokamak's central solenoid (transformer). The total current, $I_{\\mathrm{tot}}(t)$, is the sum of the current carried by the collisional thermal electrons, $I_{\\mathrm{th}}(t)$, and the current carried by the relativistic runaway electrons, $I_{\\mathrm{re}}(t)$:\n$$\nI_{\\mathrm{tot}}(t) = I_{\\mathrm{th}}(t) + I_{\\mathrm{re}}(t)\n$$\nThe parallel electric field, $E_{\\parallel}(t)$, which accelerates the electrons, is assumed to be spatially uniform and is related to the thermal current via Ohm's law:\n$$\nE_{\\parallel}(t) = \\frac{R_{\\mathrm{th}}(t)}{\\ell} \\, I_{\\mathrm{th}}(t)\n$$\nwhere $\\ell$ is the effective toroidal path length.\n\n**b. Runaway-Electron Kinetics:**\nThe runaway-electron current evolves according to a reduced kinetic model that accounts for two main generation mechanisms: primary (or Dreicer) generation and secondary (or avalanche) generation. The rate of change of the runaway current is given by:\n$$\n\\frac{d I_{\\mathrm{re}}}{d t} = \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}\\right) \\, I_{\\mathrm{re}} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}\\right)\n$$\nThis is the zeroth moment of the Fokker-Planck equation for runaway electrons. Both the avalanche growth rate, $\\gamma_{\\mathrm{ava}}$, and the primary source term, $S_{\\mathrm{pri}}$, are activated only when the parallel electric field $E_{\\parallel}$ exceeds a critical field $E_{\\mathrm{c}}$. The simplified models used are:\n$$\n\\gamma_{\\mathrm{ava}}(E_{\\parallel}) = \\frac{1}{\\tau_{\\mathrm{ava}}} \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right)\n$$\n$$\nS_{\\mathrm{pri}}(E_{\\parallel}) = S_0 \\, \\max\\!\\left(0, \\frac{E_{\\parallel}}{E_{\\mathrm{c}}} - 1 \\right)\n$$\nwhere $\\tau_{\\mathrm{ava}}$ is the characteristic avalanche timescale and $S_0$ is the primary source strength coefficient.\n\n**2. Numerical Integration Scheme**\n\nTo solve this system of coupled equations for the state variables $I_{\\mathrm{tot}}(t)$ and $I_{\\mathrm{re}}(t)$, we employ a semi-implicit time-stepping scheme. This approach is dictated by the problem statement and is suitable for handling the potential stiffness arising from a small $L/R_{\\mathrm{th}}$ time constant. The time domain $[0, T_{\\text{end}}]$ is discretized into steps of size $\\Delta t$. A single step from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ proceeds as follows, where a superscript $(n)$ denotes a quantity at time $t_n$:\n\n**Step 1: Evaluate state at $t_n$.**\nFirst, we compute the parallel electric field $E_{\\parallel}^{(n)}$ using the known values of the currents at the beginning of the time step:\n$$\nI_{\\mathrm{th}}^{(n)} = I_{\\mathrm{tot}}^{(n)} - I_{\\mathrm{re}}^{(n)}\n$$\n$$\nE_{\\parallel}^{(n)} = \\frac{R_{\\mathrm{th}}^{(n)}}{\\ell} \\, I_{\\mathrm{th}}^{(n)}\n$$\nwhere $R_{\\mathrm{th}}^{(n)} = R_{\\mathrm{th}}(t_n)$.\n\n**Step 2: Explicit update of runaway current.**\nThe runaway kinetic equation is integrated forward using an explicit (forward Euler) method. The source and growth rates are calculated using the electric field from the previous step, $E_{\\parallel}^{(n)}$, ensuring causality.\n$$\nI_{\\mathrm{re}}^{(n+1)} = I_{\\mathrm{re}}^{(n)} + \\Delta t \\left[ \\gamma_{\\mathrm{ava}}\\!\\left(E_{\\parallel}^{(n)}\\right) I_{\\mathrm{re}}^{(n)} + S_{\\mathrm{pri}}\\!\\left(E_{\\parallel}^{(n)}\\right) \\right]\n$$\nThis explicit treatment is stable provided $\\Delta t$ is sufficiently small compared to the physical timescales (e.g., $1/\\gamma_{\\mathrm{ava}}$).\n\n**Step 3: Implicit update of total current.**\nThe circuit equation is discretized using an implicit (backward Euler) method to ensure numerical stability for the potentially fast resistive decay. The equation is:\n$$\nL \\, \\frac{I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{tot}}^{(n)}}{\\Delta t} + R_{\\mathrm{th}}^{(n+1)} \\, I_{\\mathrm{th}}^{(n+1)} = V_{\\mathrm{tr}}^{(n+1)}\n$$\nSubstituting $I_{\\mathrm{th}}^{(n+1)} = I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}$ and rearranging for $I_{\\mathrm{tot}}^{(n+1)}$ yields the update rule. Note that we use the just-computed value $I_{\\mathrm{re}}^{(n+1)}$ from Step 2.\n$$\nL \\, \\left(I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{tot}}^{(n)}\\right) + \\Delta t \\, R_{\\mathrm{th}}^{(n+1)} \\, \\left(I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}\\right) = \\Delta t \\, V_{\\mathrm{tr}}^{(n+1)}\n$$\nSolving for $I_{\\mathrm{tot}}^{(n+1)}$ gives the prescribed formula:\n$$\nI_{\\mathrm{tot}}^{(n+1)} = \\frac{ I_{\\mathrm{tot}}^{(n)} + \\frac{\\Delta t}{L} \\left( V_{\\mathrm{tr}}^{(n+1)} + R_{\\mathrm{th}}^{(n+1)} I_{\\mathrm{re}}^{(n+1)} \\right)}{ 1 + \\frac{\\Delta t}{L} R_{\\mathrm{th}}^{(n+1)} }\n$$\nwhere $R_{\\mathrm{th}}^{(n+1)} = R_{\\mathrm{th}}(t_{n+1})$ and $V_{\\mathrm{tr}}^{(n+1)} = V_{\\mathrm{tr}}(t_{n+1})$.\n\n**Step 4: Close the system.**\nWith the updated currents $I_{\\mathrm{re}}^{(n+1)}$ and $I_{\\mathrm{tot}}^{(n+1)}$, the remaining quantities at $t_{n+1}$ can be found, preparing the state for the next time step.\n$$\nI_{\\mathrm{th}}^{(n+1)} = I_{\\mathrm{tot}}^{(n+1)} - I_{\\mathrm{re}}^{(n+1)}\n$$\n$$\nE_{\\parallel}^{(n+1)} = \\frac{R_{\\mathrm{th}}^{(n+1)}}{\\ell} \\, I_{\\mathrm{th}}^{(n+1)}\n$$\nThis sequence of operations is repeated for the required number of time steps until $t = T_{\\text{end}}$. The final values of $E_{\\parallel}$, $I_{\\mathrm{re}}$, and $I_{\\mathrm{tot}}$ are then reported.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation for all test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            'name': 'A',\n            'params': {\n                'L': 1e-3,\n                'ell': 2 * np.pi * 3,\n                'R_th_func': lambda t: 1e-5,\n                'V_tr_func': lambda t: 0.0,\n                'Ec': 0.05,\n                'tau_ava': 0.01,\n                'S0': 100,\n                'I_tot_0': 5e4,\n                'I_re_0': 0.0,\n                'T_end': 0.02,\n                'dt': 1e-5,\n            }\n        },\n        {\n            'name': 'B',\n            'params': {\n                'L': 1e-3,\n                'ell': 2 * np.pi * 3,\n                'R_th_func': lambda t: 1e-5,\n                'V_tr_func': lambda t: 0.0,\n                'Ec': 0.05,\n                'tau_ava': 0.01,\n                'S0': 200,\n                'I_tot_0': 1e5,\n                'I_re_0': 1.0,\n                'T_end': 0.02,\n                'dt': 1e-5,\n            }\n        },\n        {\n            'name': 'C',\n            'params': {\n                'L': 1e-3,\n                'ell': 2 * np.pi * 3,\n                'R_th_func': lambda t: 1e-5 if t  1e-3 else 5e-4,\n                'V_tr_func': lambda t: 0.0,\n                'Ec': 0.05,\n                'tau_ava': 5e-3,\n                'S0': 500,\n                'I_tot_0': 8e4,\n                'I_re_0': 0.0,\n                'T_end': 0.005,\n                'dt': 1e-6,\n            }\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result_tuple = run_simulation(**case['params'])\n        results.append(result_tuple)\n\n    # Format the results for the final output string\n    output_parts = []\n    for E_p, I_re, I_tot in results:\n        e_str = f\"{E_p:.6f}\"\n        ire_str = str(int(round(I_re)))\n        itot_str = str(int(round(I_tot)))\n        output_parts.append(f\"[{e_str},{ire_str},{itot_str}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\n\ndef run_simulation(L, ell, R_th_func, V_tr_func, Ec, tau_ava, S0, I_tot_0, I_re_0, T_end, dt):\n    \"\"\"\n    Executes the time-integration for a single set of parameters.\n\n    Args:\n        L (float): Plasma inductance (H).\n        ell (float): Effective toroidal loop length (m).\n        R_th_func (callable): Function R_th(t) for thermal resistance (Ohm).\n        V_tr_func (callable): Function V_tr(t) for transformer voltage (V).\n        Ec (float): Critical electric field (V/m).\n        tau_ava (float): Avalanche timescale (s).\n        S0 (float): Primary runaway source coefficient (A/s).\n        I_tot_0 (float): Initial total current (A).\n        I_re_0 (float): Initial runaway current (A).\n        T_end (float): Simulation end time (s).\n        dt (float): Time step (s).\n\n    Returns:\n        tuple: A tuple containing (E_parallel, I_re, I_tot) at T_end.\n    \"\"\"\n    \n    num_steps = int(round(T_end / dt))\n    \n    # Initialize state variables\n    I_tot = I_tot_0\n    I_re = I_re_0\n\n    for n in range(num_steps):\n        t_n = n * dt\n\n        # Step 1: Evaluate E_parallel at t_n\n        R_th_n = R_th_func(t_n)\n        I_th_n = I_tot - I_re\n        E_parallel_n = (R_th_n / ell) * I_th_n\n\n        # Evaluate runaway source terms based on E_parallel_n\n        E_ratio_minus_1 = E_parallel_n / Ec - 1.0\n        if E_ratio_minus_1  0:\n            gamma_ava = (1.0 / tau_ava) * E_ratio_minus_1\n            S_pri = S0 * E_ratio_minus_1\n        else:\n            gamma_ava = 0.0\n            S_pri = 0.0\n\n        # Step 2: Update I_re to t_{n+1} using explicit Euler\n        I_re_np1 = I_re + dt * (gamma_ava * I_re + S_pri)\n        \n        # Step 3: Update I_tot to t_{n+1} using implicit Euler\n        t_np1 = (n + 1) * dt\n        V_tr_np1 = V_tr_func(t_np1)\n        R_th_np1 = R_th_func(t_np1)\n        \n        dt_over_L = dt / L\n        numerator = I_tot + dt_over_L * (V_tr_np1 + R_th_np1 * I_re_np1)\n        denominator = 1.0 + dt_over_L * R_th_np1\n        I_tot_np1 = numerator / denominator\n\n        # Update state for the next iteration\n        I_tot = I_tot_np1\n        I_re = I_re_np1\n\n    # After the loop, calculate the final E_parallel at T_end\n    t_final = num_steps * dt\n    R_th_final = R_th_func(t_final)\n    I_th_final = I_tot - I_re\n    E_parallel_final = (R_th_final / ell) * I_th_final\n\n    return E_parallel_final, I_re, I_tot\n\nsolve()\n```", "id": "3717577"}]}