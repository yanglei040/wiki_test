{"hands_on_practices": [{"introduction": "This exercise bridges the gap between experimental observation and theoretical models. By analyzing the splitting of the heat flux footprint on the divertor—a key diagnostic signature—you will work backward to determine the properties of the magnetic island at the plasma edge [@problem_id:3705598]. This practice is crucial for interpreting experimental data and validating the physics of resonant magnetic perturbations.", "problem": "A single-null tokamak uses externally applied Resonant Magnetic Perturbations (RMP) to control edge heat flux via an island divertor topology. A heat-flux imaging diagnostic on the outer divertor target measures a primary footprint splitting: the arclength separation between the two dominant maxima along the strike-line coordinate is $\\Delta s = 0.180~\\text{m}$. The local magnetic incidence angle of the field lines on the target is $\\beta = 5.0^\\circ$. The poloidal magnetic field magnitude at the outboard midplane is $B_{p}^{\\mathrm{mid}} = 0.12~\\text{T}$, and at the divertor target in the strike region it is $B_{p}^{\\mathrm{div}} = 0.020~\\text{T}$.\n\nNear the resonant surface, the edge field-line dynamics can be modeled in a straight-field-line slab with Cartesian coordinates $(x,y,z)$, where $x$ is the radial-like coordinate with the rational surface at $x=0$, $y$ is the binormal coordinate, and $z$ is the coordinate along the equilibrium field-line direction. The equilibrium parallel field varies linearly as $B_{z}(x) \\approx B_{z}'\\,x$, and an $m$-poloidal-mode helical perturbation produces a radial field component $b_{x}(x,y,z) = b_{r} \\sin(k_{y} y - k_{z} z)$ with $k_{y} = m/r_{s}$. Here $m=27$ and the resonant surface major radius is $r_{s} = 0.85~\\text{m}$. The effective linear parallel-field gradient is $B_{z}' = 3.2~\\text{T/m}$. Assume the resonance is satisfied so that the field-line equations reduce to the standard pendulum form near $x=0$.\n\nStarting from first principles applicable to magnetized plasmas and field-line mapping, do the following:\n\n1. Use magnetic flux conservation for a thin flux tube and the geometric projection at the divertor target to derive the relation between a small radial displacement at the outboard midplane, $\\delta r$, and the corresponding arclength displacement along the strike line at the divertor, $\\delta s$. Show that this implies a mapping $ds/dr$ in terms of the flux expansion and the incidence angle.\n\n2. Interpret the measured splitting $\\Delta s$ as twice the mapped island half-width and obtain the island width $w$ at the resonant surface.\n\n3. Starting from the slab field-line equations in the vicinity of the rational surface and the single-harmonic perturbation, derive the magnetic island width in terms of the perturbation amplitude $b_{r}$, the binormal wavenumber $k_{y}$, and the parallel-field gradient $B_{z}'$. Invert this relation to compute $b_{r}$ from your inferred $w$.\n\nCarry out the full derivation symbolically before substituting the given numerical values. Round your final numerical results to four significant figures. Express $b_{r}$ in $\\text{T}$ and $w$ in $\\text{m}$. Provide your final answer as the ordered pair $\\left(b_{r},\\,w\\right)$.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe following data and definitions are provided in the problem statement:\n- Arclength separation between dominant heat flux maxima: $\\Delta s = 0.180~\\text{m}$\n- Local magnetic incidence angle on the divertor target: $\\beta = 5.0^\\circ$\n- Poloidal magnetic field magnitude at the outboard midplane: $B_{p}^{\\mathrm{mid}} = 0.12~\\text{T}$\n- Poloidal magnetic field magnitude at the divertor target: $B_{p}^{\\mathrm{div}} = 0.020~\\text{T}$\n- Slab coordinates: $(x,y,z)$ for radial-like, binormal, and parallel directions, respectively.\n- Equilibrium parallel field variation near resonance ($x=0$): $B_{z}(x) \\approx B_{z}'\\,x$\n- Radial magnetic field perturbation: $b_{x}(x,y,z) = b_{r} \\sin(k_{y} y - k_{z} z)$\n- Binormal wavenumber: $k_{y} = m/r_{s}$\n- Poloidal mode number: $m=27$\n- Major radius of the resonant surface: $r_{s} = 0.85~\\text{m}$\n- Effective linear parallel-field gradient: $B_{z}' = 3.2~\\text{T/m}$\n- The resonance condition is satisfied.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed based on the established criteria.\n- **Scientifically Grounded:** The problem is based on standard, well-established principles of plasma physics and magnetic confinement fusion. The concepts of resonant magnetic perturbations (RMPs), island divertors, magnetic flux conservation, flux expansion, magnetic shear, and the pendulum model for magnetic island formation are all central to the field of tokamak physics. The provided numerical values are physically plausible for a medium-sized tokamak.\n- **Well-Posed:** The problem is clearly structured into three distinct parts that guide the derivation and calculation. It provides a complete set of parameters necessary to arrive at a unique solution for the requested quantities, the magnetic island width $w$ and the perturbation amplitude $b_{r}$.\n- **Objective:** The problem is stated in precise, quantitative, and objective scientific language, free of any subjective or non-formalizable content.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, self-contained, and well-posed. No flaws are identified. Therefore, the problem is deemed **valid**, and a full solution will be provided.\n\n### Solution Derivation\n\nThe solution will be developed in three parts as requested by the problem statement.\n\n**Part 1: Derivation of the Midplane-to-Divertor Mapping**\n\nWe begin by considering the conservation of magnetic flux for a thin flux tube connecting the outboard midplane to the divertor target. In a tokamak, the poloidal magnetic flux $\\Psi_p$ is conserved along the flux tube. For a narrow tube bounded by two adjacent flux surfaces separated by a small radial distance $\\delta r$ at the midplane, the enclosed poloidal flux is approximately:\n$$ \\delta\\Psi_p \\approx B_{p}^{\\mathrm{mid}} \\delta A_{\\perp, \\mathrm{mid}} $$\nwhere $\\delta A_{\\perp, \\mathrm{mid}}$ is the cross-sectional area of the tube perpendicular to the poloidal magnetic field. Assuming a toroidal length $L_T$, this area is $\\delta A_{\\perp, \\mathrm{mid}} = L_T \\delta r$.\n\nAt the divertor, the same amount of poloidal flux $\\delta\\Psi_p$ is contained between the strike points of the same two flux surfaces. Here, the poloidal field is $B_{p}^{\\mathrm{div}}$ and the perpendicular separation of the surfaces is $\\delta r_{\\mathrm{div}}$. The corresponding area is $\\delta A_{\\perp, \\mathrm{div}} = L_T \\delta r_{\\mathrm{div}}$.\nConservation of poloidal flux, $\\delta\\Psi_p$, implies:\n$$ B_{p}^{\\mathrm{mid}} (L_T \\delta r) = B_{p}^{\\mathrm{div}} (L_T \\delta r_{\\mathrm{div}}) $$\n$$ B_{p}^{\\mathrm{mid}} \\delta r = B_{p}^{\\mathrm{div}} \\delta r_{\\mathrm{div}} $$\nThis gives the mapping of a radial separation from the midplane to a perpendicular separation at the divertor:\n$$ \\delta r_{\\mathrm{div}} = \\left(\\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}}\\right) \\delta r $$\nThe term $f_{exp} = B_{p}^{\\mathrm{mid}}/B_{p}^{\\mathrm{div}}$ is known as the magnetic flux expansion factor.\n\nThe quantity $\\delta r_{\\mathrm{div}}$ is the separation between the field lines in the poloidal plane, perpendicular to the poloidal field direction at the divertor. The problem asks for the displacement $\\delta s$ along the surface of the divertor target. The magnetic field lines strike the target at a shallow incidence angle $\\beta$. The relationship between the perpendicular separation $\\delta r_{\\mathrm{div}}$ and the arclength separation $\\delta s$ along the target surface is given by simple trigonometry:\n$$ \\sin(\\beta) = \\frac{\\delta r_{\\mathrm{div}}}{\\delta s} $$\n$$ \\delta s = \\frac{\\delta r_{\\mathrm{div}}}{\\sin(\\beta)} $$\nSubstituting the expression for $\\delta r_{\\mathrm{div}}$:\n$$ \\delta s = \\frac{1}{\\sin(\\beta)} \\left(\\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}}\\right) \\delta r $$\nThis gives the desired relation. The mapping differential requested is:\n$$ \\frac{ds}{dr} = \\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}} \\sin(\\beta)} $$\n\n**Part 2: Calculation of the Magnetic Island Width $w$**\n\nThe measured splitting $\\Delta s$ between the two dominant heat flux maxima at the divertor is interpreted as the mapping of the full radial width of the magnetic island, $w$, from the resonant surface near the midplane. Therefore, we set $\\delta r = w$ and $\\delta s = \\Delta s$ in the relation derived in Part 1:\n$$ \\Delta s = \\frac{w}{\\sin(\\beta)} \\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}} $$\nSolving for the island width $w$:\n$$ w = \\Delta s \\left(\\frac{B_{p}^{\\mathrm{div}}}{B_{p}^{\\mathrm{mid}}}\\right) \\sin(\\beta) $$\nSubstituting the given numerical values:\n$ \\Delta s = 0.180~\\text{m} $, $ B_{p}^{\\mathrm{div}} = 0.020~\\text{T} $, $ B_{p}^{\\mathrm{mid}} = 0.12~\\text{T} $, and $ \\beta = 5.0^\\circ $.\n$$ w = (0.180~\\text{m}) \\left(\\frac{0.020~\\text{T}}{0.12~\\text{T}}\\right) \\sin(5.0^\\circ) $$\n$$ w = (0.030~\\text{m}) \\sin(5.0^\\circ) \\approx 0.00261467~\\text{m} $$\nRounding to four significant figures, the island width is $w \\approx 0.002615~\\text{m}$.\n\n**Part 3: Derivation and Calculation of Perturbation Amplitude $b_r$**\n\nWe derive the magnetic island width in the specified slab model. The formation of magnetic islands is governed by a Hamiltonian system describing the field-line trajectories. In the vicinity of a rational surface, the field-line equations can be cast into a pendulum-like form. A constant of motion, or Hamiltonian, for the field lines can be written as:\n$$ H(x, \\alpha) = \\frac{1}{2} k_y B_z' x^2 + b_r \\cos(\\alpha) $$\nwhere $\\alpha = k_y y - k_z z$ is the helical phase angle, $x$ is the radial coordinate from the resonant surface, $B_z'$ is the magnetic shear parameter (given as the parallel-field gradient), $k_y$ is the binormal wavenumber, and $b_r$ is the amplitude of the radial magnetic field perturbation.\n\nThe magnetic surfaces are contours of constant $H$. The island separatrix is the special contour that passes through the X-points (unstable fixed points). The fixed points occur where the \"forces\" are zero, which corresponds to the stationary points of the Hamiltonian. These are found at $x=0$, where $\\partial H / \\partial x = 0$. The X-points correspond to the maximum of the potential energy term, i.e., at $\\cos(\\alpha)=1$, so $\\alpha=0, 2\\pi, ...$. The Hamiltonian value on the separatrix is thus:\n$$ H_{\\mathrm{sep}} = H(x=0, \\alpha=0) = \\frac{1}{2} k_y B_z' (0)^2 + b_r \\cos(0) = b_r $$\nThe full width of the island, $w$, is the maximum radial separation of the separatrix, which is $2$ times the maximum radial extent, $x_{\\mathrm{max}}$. This maximum extent occurs at the phase of the O-point (stable fixed point), where $\\cos(\\alpha)=-1$, so $\\alpha=\\pi, 3\\pi, ...$. Setting the Hamiltonian on this trajectory equal to $H_{\\mathrm{sep}}$:\n$$ H(x_{\\mathrm{max}}, \\alpha=\\pi) = \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 + b_r \\cos(\\pi) = H_{\\mathrm{sep}} $$\n$$ \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 - b_r = b_r $$\n$$ \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 = 2 b_r $$\n$$ x_{\\mathrm{max}}^2 = \\frac{4 b_r}{k_y B_z'} \\implies x_{\\mathrm{max}} = 2\\sqrt{\\frac{b_r}{k_y B_z'}} $$\nThe full island width $w$ is twice the half-width $x_{\\mathrm{max}}$:\n$$ w = 2 x_{\\mathrm{max}} = 4\\sqrt{\\frac{b_r}{k_y B_z'}} $$\nThis is the desired expression for the island width. To find the perturbation amplitude $b_r$, we invert this relation:\n$$ w^2 = 16 \\frac{b_r}{k_y B_z'} $$\n$$ b_r = \\frac{w^2 k_y B_z'}{16} $$\nNow we substitute the numerical values. First, we compute the binormal wavenumber $k_y$:\n$ m=27 $ and $ r_s = 0.85~\\text{m} $.\n$$ k_y = \\frac{m}{r_s} = \\frac{27}{0.85~\\text{m}} \\approx 31.7647~\\text{m}^{-1} $$\nUsing the unrounded value for $w \\approx 0.00261467~\\text{m}$ and the given $B_z' = 3.2~\\text{T/m}$:\n$$ b_r = \\frac{(0.00261467~\\text{m})^2 (31.7647~\\text{m}^{-1}) (3.2~\\text{T/m})}{16} $$\n$$ b_r \\approx \\frac{(6.8365 \\times 10^{-6}~\\text{m}^2) (31.7647~\\text{m}^{-1}) (3.2~\\text{T/m})}{16} \\approx \\frac{6.9508 \\times 10^{-4}~\\text{T}}{16} $$\n$$ b_r \\approx 4.34427 \\times 10^{-5}~\\text{T} $$\nRounding to four significant figures, the required perturbation amplitude is $b_r \\approx 4.344 \\times 10^{-5}~\\text{T}$.\n\n### Final Numerical Results\n- Perturbation amplitude: $b_r = 4.344 \\times 10^{-5}~\\text{T}$\n- Island width: $w = 0.002615~\\text{m}$\nThe final answer is presented as the ordered pair $(b_r, w)$.", "answer": "$$\n\\boxed{(4.344 \\times 10^{-5}, 0.002615)}\n$$", "id": "3705598"}, {"introduction": "Effective heat flux control requires not only understanding the underlying physics but also assessing its impact and limitations at a system level. This problem utilizes a practical, empirically supported model to quantify how increasing the magnetic island width reduces the peak heat flux on the divertor [@problem_id:3705584]. The exercise emphasizes a critical engineering trade-off: the benefit of divertor protection versus the potential degradation of core plasma confinement.", "problem": "A tokamak equipped with an Island Divertor (ID) operates with a saturated magnetic island at the plasma edge to broaden the heat-flux footprint on the divertor target. In steady state, assume the peak target heat flux is set by conservation of energy and geometric spreading of the power over the wetted area. Let the power entering the scrape-off layer (SOL) be $P_{\\mathrm{sep}}$, and the fraction flowing to a single outer divertor target be $f_{\\mathrm{div}}$, so the target power is $P_{t} = f_{\\mathrm{div}} P_{\\mathrm{sep}}$. For a circular tokamak of major radius $R$, model the effective wetted area as $A_{\\mathrm{eff}} = 2 \\pi R \\lambda_{q,\\mathrm{eff}}$, where $\\lambda_{q,\\mathrm{eff}}$ is the effective heat-flux width on the target. In the presence of a saturated island of width $w$, take the empirically supported broadening\n$$\n\\lambda_{q,\\mathrm{eff}} = \\lambda_{q0} + \\beta w\n$$\nwith $\\lambda_{q0}$ the baseline heat-flux width without the island and $\\beta$ a geometry/mapping coefficient representing field-line spreading through the island.\n\nStarting from conservation of energy and these definitions, derive the dependence of the peak target heat flux $q_{t}$ on $w$. Then, for the following parameters,\n- $P_{\\mathrm{sep}} = 20 \\,\\mathrm{MW}$,\n- $f_{\\mathrm{div}} = 0.5$,\n- $R = 3.0 \\,\\mathrm{m}$,\n- $\\lambda_{q0} = 0.020 \\,\\mathrm{m}$,\n- $\\beta = 0.50$,\n- $w_{0} = 0.060 \\,\\mathrm{m}$,\n\ncompute the fractional change\n$$\n\\delta = \\frac{q_{t}(2 w_{0}) - q_{t}(w_{0})}{q_{t}(w_{0})}\n$$\nwhen the island width is doubled from $w_{0}$ to $2 w_{0}$. Express $\\delta$ as a decimal number (unitless) and round your final answer to four significant figures.\n\nFinally, interpret this result by discussing, from first principles of transport and confinement, the trade-off between reducing $q_{t}$ via increased $w$ and the impact on core energy confinement.", "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of plasma physics and heat transport in tokamaks, well-posed with sufficient information for a unique solution, and objective in its formulation. We may proceed with the solution.\n\nThe problem asks for a three-part solution: first, to derive the dependence of the peak target heat flux, $q_{t}$, on the magnetic island width, $w$; second, to compute the fractional change in $q_t$ when the island width is doubled; and third, to provide a physical interpretation of the trade-offs involved.\n\nFirst, we derive the expression for $q_t(w)$. The peak target heat flux is defined by the conservation of energy, where the power arriving at the target, $P_t$, is spread over an effective area, $A_{\\mathrm{eff}}$.\n$$\nq_{t} = \\frac{P_{t}}{A_{\\mathrm{eff}}}\n$$\nThe problem provides expressions for both $P_t$ and $A_{\\mathrm{eff}}$. The power to the target is a fraction $f_{\\mathrm{div}}$ of the total power crossing the separatrix $P_{\\mathrm{sep}}$:\n$$\nP_{t} = f_{\\mathrm{div}} P_{\\mathrm{sep}}\n$$\nThe effective wetted area is given for a circular tokamak of major radius $R$ as:\n$$\nA_{\\mathrm{eff}} = 2 \\pi R \\lambda_{q,\\mathrm{eff}}\n$$\nwhere $\\lambda_{q,\\mathrm{eff}}$ is the effective heat-flux width. The model for the broadening of this width due to the presence of a magnetic island of width $w$ is given by the empirical relation:\n$$\n\\lambda_{q,\\mathrm{eff}} = \\lambda_{q0} + \\beta w\n$$\nHere, $\\lambda_{q0}$ is the intrinsic heat-flux width without the island, and $\\beta$ is a coefficient that quantifies the effectiveness of the island in spreading the heat flux.\n\nSubstituting these expressions into the equation for $q_t$, we obtain the dependence of the peak target heat flux on the island width $w$:\n$$\nq_{t}(w) = \\frac{f_{\\mathrm{div}} P_{\\mathrm{sep}}}{2 \\pi R (\\lambda_{q0} + \\beta w)}\n$$\nThis expression shows that $q_t$ is inversely proportional to a linear function of $w$. As the island width $w$ increases, the denominator increases, and thus the peak heat flux $q_t$ decreases, which is the intended purpose of the island divertor.\n\nNext, we compute the fractional change $\\delta$ when the island width is doubled from an initial value $w_{0}$ to $2w_{0}$. The definition of $\\delta$ is:\n$$\n\\delta = \\frac{q_{t}(2 w_{0}) - q_{t}(w_{0})}{q_{t}(w_{0})} = \\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} - 1\n$$\nUsing our derived expression for $q_t(w)$, we can form the ratio:\n$$\n\\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} = \\frac{\\frac{f_{\\mathrm{div}} P_{\\mathrm{sep}}}{2 \\pi R (\\lambda_{q0} + \\beta (2w_{0}))}}{\\frac{f_{\\mathrm{div}} P_{\\mathrm{sep}}}{2 \\pi R (\\lambda_{q0} + \\beta w_{0})}}\n$$\nThe constant terms $f_{\\mathrm{div}}$, $P_{\\mathrm{sep}}$, $2$, $\\pi$, and $R$ cancel, leaving:\n$$\n\\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} = \\frac{\\lambda_{q0} + \\beta w_{0}}{\\lambda_{q0} + 2\\beta w_{0}}\n$$\nSubstituting this back into the expression for $\\delta$:\n$$\n\\delta = \\frac{\\lambda_{q0} + \\beta w_{0}}{\\lambda_{q0} + 2\\beta w_{0}} - 1\n$$\nWe are given the following numerical values: $\\lambda_{q0} = 0.020 \\,\\mathrm{m}$, $\\beta = 0.50$, and $w_{0} = 0.060 \\,\\mathrm{m}$. We substitute these values into the expression for $\\delta$.\nFirst, let's calculate the term $\\beta w_0$:\n$$\n\\beta w_0 = (0.50)(0.060 \\,\\mathrm{m}) = 0.030 \\,\\mathrm{m}\n$$\nNow, we can evaluate the numerator and denominator of the fraction:\n$$\n\\lambda_{q0} + \\beta w_0 = 0.020 \\,\\mathrm{m} + 0.030 \\,\\mathrm{m} = 0.050 \\,\\mathrm{m}\n$$\n$$\n\\lambda_{q0} + 2\\beta w_0 = 0.020 \\,\\mathrm{m} + 2(0.030 \\,\\mathrm{m}) = 0.020 \\,\\mathrm{m} + 0.060 \\,\\mathrm{m} = 0.080 \\,\\mathrm{m}\n$$\nThe ratio is therefore:\n$$\n\\frac{q_{t}(2 w_{0})}{q_{t}(w_{0})} = \\frac{0.050}{0.080} = \\frac{5}{8} = 0.625\n$$\nFinally, we compute $\\delta$:\n$$\n\\delta = 0.625 - 1 = -0.375\n$$\nRounding to four significant figures as requested, we get $\\delta = -0.3750$. This signifies a $37.5\\%$ reduction in the peak target heat flux when the island width is doubled.\n\nFinally, we discuss the physical trade-off between reducing $q_t$ and its impact on core energy confinement. The computed result, $\\delta  0$, confirms that increasing the island width is effective at reducing the peak heat flux on the divertor. The physical mechanism behind this is the modification of the magnetic field topology at the plasma edge. A magnetic island is a region where magnetic flux surfaces are broken and reformed into a new, insular topology. This structure intersects the open field lines of the scrape-off layer, effectively \"braiding\" them and guiding the outflowing plasma and heat over a much larger area of the target plate. This spreading directly increases $\\lambda_{q,\\mathrm{eff}}$ and reduces $q_t$.\n\nHowever, this benefit comes at a cost to core plasma performance. The nested, concentric magnetic flux surfaces of a standard tokamak configuration are essential for providing thermal insulation, thereby confining the hot core plasma. A magnetic island is fundamentally a perturbation—a \"hole\"—in this ideal insulating structure. The transport of heat and particles is extremely rapid along magnetic field lines and much slower across them. Within a magnetic island, the field-line structure provides a \"short-circuit\" for transport across the radial extent of the island, leading to a flattening of the local temperature and density profiles.\n\nWhen a large island is induced at the plasma edge, it degrades the steep pressure gradient in the edge transport barrier (the \"pedestal\") that is characteristic of high-confinement mode (H-mode) operation. This enhanced edge transport signifies a greater leakage of energy and particles from the main plasma. Consequently, the global energy confinement time, $\\tau_E$, defined as the ratio of the total stored energy to the total heating power, is reduced. A lower $\\tau_E$ means that for a given heating power, a lower core temperature and pressure can be sustained, which is detrimental to the overall performance of the fusion device and its prospects for achieving net energy gain.\n\nIn summary, the trade-off is fundamental: increasing the island width $w$ beneficially reduces the peak divertor heat flux $q_t$ to protect material components, but it simultaneously degrades energy confinement by increasing transport at the plasma edge. The optimal operation of an island divertor tokamak involves finding a delicate balance: an island just large enough to keep $q_t$ within material limits, but small enough to not excessively compromise the core confinement required for efficient fusion power production.", "answer": "$$\n\\boxed{-0.3750}\n$$", "id": "3705584"}, {"introduction": "This final practice integrates several key physics concepts into a comprehensive computational model, providing an end-to-end view of island divertor control. Starting from the properties of external magnetic coils, you will calculate how the plasma screens the applied perturbation, determine the resulting island size, and ultimately predict the heat flux on the divertor target [@problem_id:3705560]. This exercise simulates the complete cause-and-effect chain, from the control actuator to the final engineering objective.", "problem": "Consider a sheared-slab edge model for an Island Divertor configuration in a nuclear fusion device. The aim is to quantify how externally applied coil spectra are plasma-screened, how the resultant magnetic islands form, and how these islands modify the divertor target heat-flux density. Use the following physically grounded approximations that start from Resistive Magnetohydrodynamics (MHD), Faraday's law, Ampère's law, and Ohm's law, and a local sheared slab approximation for field-line geometry.\n\nFundamental base:\n- Faraday's law: $\\nabla \\times \\mathbf{E} = - \\partial \\mathbf{B}/\\partial t$.\n- Ampère's law (magnetostatic form for the perturbation current density): $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$.\n- Resistive Ohm's law in the plasma: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}$, where $\\eta$ is the Spitzer resistivity.\n- In a uniform conductor subject to a harmonic magnetic perturbation of angular frequency $\\omega$ (representing the field's rotation relative to the plasma), electromagnetic diffusion yields a skin depth $\\delta = \\sqrt{2 \\eta / (\\mu_0 \\omega)}$, which controls exponential attenuation of the perturbation amplitude with depth.\n\nGeometry and island formation model:\n- Adopt a local sheared slab with guide field $\\mathbf{B}_0 = B_0 \\hat{z}$ and constant magnetic shear $s$ such that field lines have local pitch variation characterized by $s$.\n- An externally applied resonant radial field harmonic with poloidal wavenumber $k_y$ produces a perturbed flux function $\\tilde{\\psi}$ related to the radial field amplitude $b_r$ via $b_r \\approx k_y \\tilde{\\psi}$.\n- Near a rational surface, the field-line Hamiltonian reduces to a pendulum-like form, leading to the standard sheared-slab island half-width $w = 4 \\sqrt{|\\tilde{\\psi}|/(|B_0 s|)}$. Eliminating $\\tilde{\\psi}$ using $b_r \\approx k_y \\tilde{\\psi}$ gives\n$$\nw = 4 \\sqrt{\\frac{|b_r|}{|k_y| B_0 s}}\n$$\n\nScreening and heat-flux model:\n- Let a harmonic at the plasma boundary have edge amplitude $b_{r,\\mathrm{edge}}$ and angular frequency $\\omega$. The distance from the boundary to the rational surface is $L$. Plasma screening (skin effect) yields the screened amplitude at the rational surface:\n$$\nb_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}} \\exp\\!\\left(-\\frac{L}{\\delta}\\right), \\quad \\delta = \\begin{cases}\n\\sqrt{\\dfrac{2 \\eta}{\\mu_0 \\omega}},  \\omega  0, \\\\\n\\infty,  \\omega = 0,\n\\end{cases}\n$$\nso that static perturbations ($\\omega = 0$) are unscreened in this approximation.\n- For a harmonic with poloidal mode number $m$ and rational surface radius $r_s$, take $k_y = m/r_s$.\n- For multiple harmonics, assume additive broadening of the divertor heat-flux width by a geometric mapping factor $\\gamma$ times the sum of island half-widths, giving an effective target width\n$$\n\\lambda_{\\mathrm{eff}} = \\lambda_q + \\gamma \\sum_h w_h ,\n$$\nwhere $\\lambda_q$ is the baseline heat-flux width without islands and $w_h$ is the half-width of harmonic $h$.\n- The divertor target heat-flux density is modeled as the axisymmetric input power $P_{\\mathrm{in}}$ spread over an effective area $2 \\pi R \\lambda_{\\mathrm{eff}}$, yielding\n$$\nq_t = \\frac{P_{\\mathrm{in}}}{2 \\pi R \\lambda_{\\mathrm{eff}}} .\n$$\n\nTask:\n- Implement a program that, for each test case described below, computes for each harmonic the plasma-screened $b_{r,\\mathrm{scr}}$, the island half-width $w_h$, and then the effective width $\\lambda_{\\mathrm{eff}}$ and the target heat flux $q_t$.\n- Use $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n- The final numeric answers for $q_t$ must be expressed in $\\mathrm{W/m^2}$.\n- Angle units do not appear; do not introduce angles.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\mathrm{[result1,result2,result3]}$), in the order of the test cases below.\n\nTest suite:\n- Test case $\\#1$ (general, moderate screening):\n  - Coil harmonics: $\\{(m = 8,\\ b_{r,\\mathrm{edge}} = 3.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 800\\,\\mathrm{s^{-1}}),\\ (m = 10,\\ b_{r,\\mathrm{edge}} = 2.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 1200\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 1.2 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.15\\,\\mathrm{m}$, $r_s = 1.05\\,\\mathrm{m}$, $B_0 = 2.5\\,\\mathrm{T}$, $s = 3.5\\,\\mathrm{m^{-1}}$, $\\gamma = 1.8$, $\\lambda_q = 6.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.2\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 6.5 \\times 10^{6}\\,\\mathrm{W}$.\n- Test case $\\#2$ (high-frequency, strong screening):\n  - Coil harmonics: $\\{(m = 9,\\ b_{r,\\mathrm{edge}} = 2.5 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 6000\\,\\mathrm{s^{-1}}),\\ (m = 12,\\ b_{r,\\mathrm{edge}} = 1.5 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 9000\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 8.0 \\times 10^{-7}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.20\\,\\mathrm{m}$, $r_s = 1.00\\,\\mathrm{m}$, $B_0 = 3.0\\,\\mathrm{T}$, $s = 4.0\\,\\mathrm{m^{-1}}$, $\\gamma = 2.0$, $\\lambda_q = 5.0 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.0\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 5.5 \\times 10^{6}\\,\\mathrm{W}$.\n- Test case $\\#3$ (static perturbation, no screening):\n  - Coil harmonics: $\\{(m = 7,\\ b_{r,\\mathrm{edge}} = 4.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 0\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 1.0 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.12\\,\\mathrm{m}$, $r_s = 0.95\\,\\mathrm{m}$, $B_0 = 2.2\\,\\mathrm{T}$, $s = 3.0\\,\\mathrm{m^{-1}}$, $\\gamma = 1.5$, $\\lambda_q = 7.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 2.8\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 4.8 \\times 10^{6}\\,\\mathrm{W}$.\n- Test case $\\#4$ (short penetration distance, weak screening):\n  - Coil harmonics: $\\{(m = 10,\\ b_{r,\\mathrm{edge}} = 5.0 \\times 10^{-5}\\,\\mathrm{T},\\ \\omega = 400\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 2.0 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.03\\,\\mathrm{m}$, $r_s = 1.10\\,\\mathrm{m}$, $B_0 = 2.7\\,\\mathrm{T}$, $s = 2.5\\,\\mathrm{m^{-1}}$, $\\gamma = 1.7$, $\\lambda_q = 4.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.1\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 7.0 \\times 10^{6}\\,\\mathrm{W}$.\n\nYour program should implement the computations exactly as defined above and output a single line containing a Python-style list of the four $q_t$ values in $\\mathrm{W/m^2}$ for the test cases in the order given, with no additional text.", "solution": "The problem is valid as it is scientifically grounded in established plasma physics principles (resistive MHD, magnetic island theory), well-posed with all necessary data provided, and formulated objectively. The provided parameters are within physically plausible ranges for nuclear fusion devices.\n\nThe task is to calculate the peak heat flux density $q_t$ on a divertor target, considering the broadening effect of magnetic islands induced by external resonant magnetic perturbations (RMPs). The calculation proceeds by applying a series of physics-based models for plasma screening, island formation, and heat flux deposition. The procedure is executed for each test case, which may involve one or more RMP harmonics.\n\nThe core physical principle governing the penetration of time-varying magnetic fields into a conducting plasma is the skin effect. An externally applied magnetic perturbation with angular frequency $\\omega$ relative to the plasma is attenuated as it penetrates. The characteristic length scale for this attenuation is the electromagnetic skin depth $\\delta$. For a plasma with resistivity $\\eta$ and vacuum permeability $\\mu_0$, the skin depth is given by\n$$\n\\delta = \\sqrt{\\frac{2 \\eta}{\\mu_0 \\omega}}\n$$\nThis formula is applicable for non-static perturbations, where $\\omega  0$. For a static perturbation, $\\omega = 0$, the skin depth is effectively infinite, $\\delta \\to \\infty$, meaning the field is not screened by this mechanism. A harmonic with amplitude $b_{r,\\mathrm{edge}}$ at the plasma edge, located a distance $L$ from the resonant rational surface, will have its amplitude screened to $b_{r,\\mathrm{scr}}$ at the rational surface according to:\n$$\nb_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}} \\exp\\left(-\\frac{L}{\\delta}\\right)\n$$\nFor the static case ($\\omega=0$), the exponential term becomes $\\exp(0) = 1$, and thus $b_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}}$.\n\nOnce the screened radial magnetic field amplitude $b_{r,\\mathrm{scr}}$ is known at the rational surface, the size of the resulting magnetic island can be calculated. In a sheared-slab geometry with a uniform guide field $B_0$ and constant magnetic shear $s$, the island half-width $w$ for a single harmonic is given by:\n$$\nw = 4 \\sqrt{\\frac{|b_{r,\\mathrm{scr}}|}{|k_y| B_0 s}}\n$$\nHere, $k_y$ is the poloidal wavenumber of the perturbation. For a harmonic with poloidal mode number $m$ at a rational surface of radius $r_s$, the wavenumber is approximated as $k_y = m/r_s$.\n\nThe presence of these magnetic islands alters the transport of heat to the divertor target. The model assumes that the intrinsic heat-flux width, $\\lambda_q$, is broadened by the islands. The total effective heat-flux width, $\\lambda_{\\mathrm{eff}}$, is calculated by summing the contributions from all applied harmonics $h$:\n$$\n\\lambda_{\\mathrm{eff}} = \\lambda_q + \\gamma \\sum_h w_h\n$$\nwhere $w_h$ is the half-width of the island created by harmonic $h$, and $\\gamma$ is a geometric mapping factor that relates the island width in the plasma core to its footprint on the divertor target.\n\nFinally, the peak heat-flux density on the target, $q_t$, is determined by assuming the total input power $P_{\\mathrm{in}}$ is distributed over an effective area defined by the major radius $R$ and the effective width $\\lambda_{\\mathrm{eff}}$. This yields the expression:\n$$\nq_t = \\frac{P_{\\mathrm{in}}}{2 \\pi R \\lambda_{\\mathrm{eff}}}\n$$\n\nThe computational procedure for each test case is as follows:\n1.  Initialize a variable for the total island width contribution, $\\sum_h w_h = 0$.\n2.  For each harmonic $h$ specified in the test case:\n    a.  Retrieve the harmonic's parameters: mode number $m$, edge amplitude $b_{r,\\mathrm{edge}}$, and angular frequency $\\omega$.\n    b.  If $\\omega  0$, calculate the skin depth $\\delta$ using the plasma resistivity $\\eta$ and $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$. Then, compute the screened amplitude $b_{r,\\mathrm{scr}}$ using the penetration depth $L$.\n    c.  If $\\omega = 0$, set $b_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}}$.\n    d.  Calculate the poloidal wavenumber $k_y = m/r_s$.\n    e.  Calculate the island half-width $w_h$ using $b_{r,\\mathrm{scr}}$, $k_y$, the guide field $B_0$, and the magnetic shear $s$.\n    f.  Add $w_h$ to the running sum $\\sum_h w_h$.\n3.  After iterating through all harmonics, calculate the effective heat-flux width $\\lambda_{\\mathrm{eff}}$ using the baseline width $\\lambda_q$ and the geometric factor $\\gamma$.\n4.  Compute the final target heat-flux density $q_t$ using the input power $P_{\\mathrm{in}}$ and major radius $R$.\n5.  This value of $q_t$ is the result for the test case. The process is repeated for all test cases provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to solve the island divertor heat flux problem for all test cases.\n    \"\"\"\n    \n    # Define the constant mu_0\n    MU_0 = 4 * np.pi * 1e-7\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case #1 (general, moderate screening)\n        {\n            \"harmonics\": [\n                {\"m\": 8, \"b_r_edge\": 3.0e-4, \"omega\": 800},\n                {\"m\": 10, \"b_r_edge\": 2.0e-4, \"omega\": 1200},\n            ],\n            \"params\": {\n                \"eta\": 1.2e-6, \"L\": 0.15, \"r_s\": 1.05, \"B0\": 2.5, \"s\": 3.5,\n                \"gamma\": 1.8, \"lambda_q\": 6.5e-3, \"R\": 3.2, \"P_in\": 6.5e6,\n            }\n        },\n        # Test case #2 (high-frequency, strong screening)\n        {\n            \"harmonics\": [\n                {\"m\": 9, \"b_r_edge\": 2.5e-4, \"omega\": 6000},\n                {\"m\": 12, \"b_r_edge\": 1.5e-4, \"omega\": 9000},\n            ],\n            \"params\": {\n                \"eta\": 8.0e-7, \"L\": 0.20, \"r_s\": 1.00, \"B0\": 3.0, \"s\": 4.0,\n                \"gamma\": 2.0, \"lambda_q\": 5.0e-3, \"R\": 3.0, \"P_in\": 5.5e6,\n            }\n        },\n        # Test case #3 (static perturbation, no screening)\n        {\n            \"harmonics\": [\n                {\"m\": 7, \"b_r_edge\": 4.0e-4, \"omega\": 0},\n            ],\n            \"params\": {\n                \"eta\": 1.0e-6, \"L\": 0.12, \"r_s\": 0.95, \"B0\": 2.2, \"s\": 3.0,\n                \"gamma\": 1.5, \"lambda_q\": 7.5e-3, \"R\": 2.8, \"P_in\": 4.8e6,\n            }\n        },\n        # Test case #4 (short penetration distance, weak screening)\n        {\n            \"harmonics\": [\n                {\"m\": 10, \"b_r_edge\": 5.0e-5, \"omega\": 400},\n            ],\n            \"params\": {\n                \"eta\": 2.0e-6, \"L\": 0.03, \"r_s\": 1.10, \"B0\": 2.7, \"s\": 2.5,\n                \"gamma\": 1.7, \"lambda_q\": 4.5e-3, \"R\": 3.1, \"P_in\": 7.0e6,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        harmonics = case[\"harmonics\"]\n        params = case[\"params\"]\n\n        # Unpack parameters for clarity\n        eta = params[\"eta\"]\n        L = params[\"L\"]\n        r_s = params[\"r_s\"]\n        B0 = params[\"B0\"]\n        s = params[\"s\"]\n        gamma = params[\"gamma\"]\n        lambda_q = params[\"lambda_q\"]\n        R = params[\"R\"]\n        P_in = params[\"P_in\"]\n        \n        total_island_width = 0.0\n\n        for h in harmonics:\n            m = h[\"m\"]\n            b_r_edge = h[\"b_r_edge\"]\n            omega = h[\"omega\"]\n\n            # Step 1: Calculate the plasma-screened radial field amplitude b_r_scr\n            if omega == 0:\n                # Static case: no screening by this mechanism\n                b_r_scr = b_r_edge\n            else:\n                # Skin depth delta\n                delta = np.sqrt(2 * eta / (MU_0 * omega))\n                # Screened field amplitude\n                b_r_scr = b_r_edge * np.exp(-L / delta)\n\n            # Step 2: Calculate the island half-width w_h\n            # Poloidal wavenumber k_y\n            k_y = m / r_s\n            \n            # Island half-width\n            numerator = np.abs(b_r_scr)\n            denominator = np.abs(k_y) * B0 * s\n            \n            if denominator == 0:\n                 w_h = 0.0\n            else:\n                 w_h = 4 * np.sqrt(numerator / denominator)\n\n            total_island_width += w_h\n\n        # Step 3: Calculate the effective target width lambda_eff\n        lambda_eff = lambda_q + gamma * total_island_width\n\n        # Step 4: Calculate the target heat flux q_t\n        q_t = P_in / (2 * np.pi * R * lambda_eff)\n        \n        results.append(q_t)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3705560"}]}