{"hands_on_practices": [{"introduction": "A primary motivation for operator splitting is to handle stiff equations, where different physical processes evolve on vastly different time scales. This exercise tackles this concept head-on by analyzing a simple yet illustrative stiff Ordinary Differential Equation ($ODE$). By applying a Lie splitting that treats the fast, stiff linear term exactly and the slower nonlinear term explicitly, you will derive the stability constraint for the overall scheme and discover a key benefit of this approach [@problem_id:3612316].", "problem": "Consider the scalar Ordinary Differential Equation (ODE) $u_{t}=\\lambda u+g(u)$ modeling a stiff attenuation-reaction process in a geophysical medium, where $\\lambda\\ll -1$ represents a strong linear attenuation rate and $g(u)$ is a nonlinear reaction term that is twice continuously differentiable on a bounded invariant set $\\mathcal{D}\\subset\\mathbb{R}$. A first-order Lie splitting is used over a time step $\\Delta t>0$: first integrate the linear attenuation subproblem exactly over $\\Delta t$, and then advance the nonlinear reaction subproblem explicitly over $\\Delta t$.\n\nStarting only from the fundamental definition of the Lie splitting step and a linearization-based absolute stability criterion for explicit one-step schemes, derive an estimate for the largest stable time step for the explicit nonlinear stage in terms of the supremum of the magnitude of the Jacobian $g'(u)$ on $\\mathcal{D}$. Demonstrate whether and how this stability constraint depends on $\\lambda$.\n\nThen, specialize to the nonlinear reaction $g(u)=-\\alpha u^{3}$ with $\\alpha>0$, assuming the dynamics remain in the set $\\mathcal{D}=\\{u\\in\\mathbb{R}:\\,|u|\\leq U\\}$ for a given amplitude bound $U>0$. Compute the maximal admissible time step $\\Delta t_{\\max}$ for the explicit stage in the Lie splitting in terms of $\\alpha$ and $U$. Express your final answer in seconds. No rounding is required, and your final answer must be a single closed-form analytic expression.", "solution": "The problem asks for an analysis of the stability of a first-order Lie splitting scheme applied to the scalar Ordinary Differential Equation (ODE) $u_{t}=\\lambda u+g(u)$. The parameter $\\lambda \\ll -1$ represents a strong linear attenuation, making the ODE stiff. The term $g(u)$ is a nonlinear reaction, and the solution $u(t)$ is assumed to remain within a bounded invariant set $\\mathcal{D} \\subset \\mathbb{R}$.\n\nFirst, we formalize the Lie splitting scheme. Over a time step $\\Delta t > 0$, starting from an approximation $u_n$ to $u(t_n)$, we compute $u_{n+1} \\approx u(t_n+\\Delta t)$ in two stages.\n\nStage 1: Solve the linear attenuation subproblem.\nWe solve the ODE $v_t = \\lambda v$ over the interval $[0, \\Delta t]$ with the initial condition $v(0) = u_n$. The problem specifies this integration is performed exactly. The solution is $v(t) = u_n \\exp(\\lambda t)$. Evaluating this at $t=\\Delta t$ gives the intermediate value $u^*$:\n$$u^* = u_n \\exp(\\lambda \\Delta t)$$\n\nStage 2: Solve the nonlinear reaction subproblem.\nWe solve the ODE $w_t = g(w)$ over $[0, \\Delta t]$ with the initial condition $w(0) = u^*$. The problem states this is done \"explicitly\". The most fundamental first-order explicit method is the Forward Euler scheme. Applying one step of the Forward Euler method gives the final value $u_{n+1}$:\n$$u_{n+1} = u^* + \\Delta t \\, g(u^*)$$\n\nThe core of the problem is to determine the stability constraint on $\\Delta t$ arising from this second, explicit stage. The problem specifies a linearization-based absolute stability criterion. For an explicit one-step method applied to a scalar ODE $w_t = f(w)$, the stability is analyzed by linearizing the ODE around a reference solution, leading to the condition that $\\Delta t$ multiplied by the Jacobian of $f$ must lie within the method's stability region.\n\nFor the Forward Euler method, the stability region for a complex number $z$ is the disk in the complex plane defined by $|1 + z| \\leq 1$. In our case, the function is $g(u)$, its Jacobian is the scalar derivative $g'(u)$, and the variable $z$ corresponds to $\\Delta t \\, g'(u)$. Since $g(u)$ is a real-valued function of a real variable, $g'(u)$ is real. The stability condition thus becomes:\n$$|1 + \\Delta t \\, g'(u)| \\leq 1$$\nThis inequality for a real value $x = \\Delta t \\, g'(u)$ is equivalent to $-1 \\leq 1 + x \\leq 1$, which simplifies to:\n$$-2 \\leq \\Delta t \\, g'(u) \\leq 0$$\n\nThis condition must hold for any value of $u$ that is provided as an input to the function $g$ in the second stage. The input is $u^* = u_n \\exp(\\lambda \\Delta t)$. Since $u_n$ is in the invariant set $\\mathcal{D}$ and the problem states $\\lambda \\ll -1$, we have $0 < \\exp(\\lambda \\Delta t) \\ll 1$. Thus, $|u^*| = |u_n| \\exp(\\lambda \\Delta t) \\leq |u_n|$. If $\\mathcal{D}$ is an interval centered at $0$, like $\\{u \\in \\mathbb{R}: |u| \\leq U\\}$, then $u_n \\in \\mathcal{D}$ implies $u^* \\in \\mathcal{D}$. To ensure stability for all possible states, the condition must hold for all $u \\in \\mathcal{D}$.\n\nThe condition $-2 \\leq \\Delta t \\, g'(u) \\leq 0$ for all $u \\in \\mathcal{D}$ implies two separate constraints:\n1.  $\\Delta t \\, g'(u) \\leq 0$: Since $\\Delta t > 0$, this requires $g'(u) \\leq 0$ for all $u \\in \\mathcal{D}$. This is a necessary condition on the physics of the reaction term for the Forward Euler method to be stable at all.\n2.  $\\Delta t \\, g'(u) \\geq -2$: This implies $\\Delta t \\leq \\frac{-2}{g'(u)}$ for any $u \\in \\mathcal{D}$ where $g'(u) < 0$.\n\nTo ensure this inequality holds for all $u \\in \\mathcal{D}$, $\\Delta t$ must be smaller than the minimum possible value of $\\frac{-2}{g'(u)}$. This minimum occurs when the denominator $g'(u)$ is most negative, i.e., when $|g'(u)| = -g'(u)$ is at its maximum. Let $L_g = \\sup_{u \\in \\mathcal{D}} |g'(u)|$. The most restrictive constraint is then:\n$$\\Delta t \\leq \\frac{2}{L_g}$$\nThe maximal stable time step is therefore $\\Delta t_{\\max} = \\frac{2}{\\sup_{u \\in \\mathcal{D}} |g'(u)|}$.\n\nNow, we address whether this stability constraint depends on $\\lambda$. The derived estimate $\\Delta t \\leq 2/L_g$ depends only on the supremum of the magnitude of the Jacobian of the nonlinear term, $g'(u)$, over the invariant set $\\mathcal{D}$. The parameter $\\lambda$ does not appear in this expression. This demonstrates a key advantage of the Lie splitting method for stiff problems: the stability constraint associated with the stiff linear term (which would be approximately $\\Delta t \\leq 2/|\\lambda|$ for a fully explicit method) is removed by integrating that part of the system exactly. The overall stability is governed only by the non-stiff part, allowing for a much larger time step.\n\nFinally, we specialize this result to the given nonlinear reaction $g(u) = -\\alpha u^3$ with $\\alpha > 0$, on the invariant set $\\mathcal{D} = \\{u\\in\\mathbb{R}:\\,|u|\\leq U\\}$ for a given $U > 0$.\n\nFirst, we compute the derivative $g'(u)$:\n$$g'(u) = \\frac{d}{du}(-\\alpha u^3) = -3\\alpha u^2$$\nSince $\\alpha > 0$ and $u^2 \\geq 0$, we have $g'(u) \\leq 0$ for all $u$. This satisfies the necessary condition for stability.\n\nNext, we find the supremum of $|g'(u)|$ on the set $\\mathcal{D}$:\n$$L_g = \\sup_{u \\in \\mathcal{D}} |g'(u)| = \\sup_{|u| \\leq U} |-3\\alpha u^2| = \\sup_{|u| \\leq U} 3\\alpha u^2$$\nThe function $3\\alpha u^2$ is an upward-opening parabola with its vertex at $u=0$. Over the symmetric interval $[-U, U]$, its maximum value is attained at the endpoints, $u = \\pm U$.\n$$L_g = 3\\alpha U^2$$\n\nSubstituting this into our expression for the maximal time step gives:\n$$\\Delta t_{\\max} = \\frac{2}{L_g} = \\frac{2}{3\\alpha U^2}$$\nThe problem asks for the answer to be expressed in seconds. If we assume the unit of $u$ is $X$ and the unit of time is seconds ($s$), then from $u_t = g(u)$, the units of $g(u)$ must be $X/s$. From $g(u) = -\\alpha u^3$, the units of $\\alpha$ must be $(X/s)/X^3 = X^{-2}s^{-1}$. The unit of $U$ is $X$. Therefore, the unit of the expression $\\frac{2}{3\\alpha U^2}$ is $1/(X^{-2}s^{-1} \\cdot X^2) = 1/s^{-1} = s$. The result is dimensionally consistent.", "answer": "$$\\boxed{\\frac{2}{3\\alpha U^2}}$$", "id": "3612316"}, {"introduction": "Moving from $ODE$s to Partial Differential Equations ($PDE$s), this practice explores the stability of a split scheme for the fundamental advection-diffusion equation. Combining an explicit upwind scheme for advection with an implicit scheme for diffusion is a common strategy, but the stability of the resulting composite operator is not obvious. Through a rigorous von Neumann stability analysis, you will determine the precise time step restriction for this Lie-split method, gaining essential skills in analyzing the numerical properties of split integrators [@problem_id:3612346].", "problem": "Consider the linear advectionâ€“diffusion equation $u_{t} + c\\,u_{x} = \\nu\\,u_{xx}$, where $c \\in \\mathbb{R}$ is a constant advection speed with $c \\neq 0$, and $\\nu \\ge 0$ is a constant kinematic viscosity. Let the spatial domain be periodic with period $L > 0$, discretized on a uniform grid $x_{j} = j\\,\\Delta x$ with constant spacing $\\Delta x > 0$. Consider a Lie splitting time integrator over a single time step $\\Delta t > 0$ that applies:\n\n- an explicit advection step using forward Euler in time and a first-order upwind spatial discretization consistent with the sign of $c$, followed by\n- an implicit diffusion step using backward Euler in time and a second-order centered finite difference for $u_{xx}$.\n\nAssume periodic boundary conditions so that discrete Fourier modes are eigenfunctions of the update operator. Perform a von Neumann analysis (Fourier stability analysis) of the composed one-step map (from time level $n$ to $n+1$ via advection then diffusion), and derive the necessary and sufficient stability condition that the spectral amplification factor magnitude is bounded by $1$ for all wavenumbers. From this, determine the largest allowable time step $\\Delta t_{\\max}$ as an explicit algebraic expression in terms of $c$, $\\nu$, and $\\Delta x$ such that the Lie-split scheme is von Neumann stable for all Fourier modes. Express your final answer as a single closed-form expression for $\\Delta t_{\\max}$. Do not provide a numerical value; if you were to evaluate it numerically, you would express the time in seconds (SI units), but here you must give a symbolic expression only.", "solution": "The solution proceeds by analyzing the amplification factor of the combined two-step Lie splitting scheme. Let $u_j^n$ denote the numerical solution at time $t_n = n\\Delta t$ and spatial position $x_j = j\\Delta x$. The scheme updates the solution from time level $n$ to $n+1$ via an intermediate step, which we denote by $*$.\n\nThe total scheme is $u^n \\xrightarrow{\\text{Advection}} u^* \\xrightarrow{\\text{Diffusion}} u^{n+1}$.\n\n**1. Analysis of the Advection Step**\nThe advection equation is $u_t + c u_x = 0$. The scheme uses Forward Euler in time and a first-order upwind discretization for the spatial derivative $u_x$. The upwind discretization depends on the sign of the advection speed $c$.\n\nLet $\\alpha = \\frac{|c|\\Delta t}{\\Delta x}$ be the Courant number, which is non-negative.\n- If $c > 0$, the upwind difference is $\\frac{u_j - u_{j-1}}{\\Delta x}$. The Forward Euler update is:\n$$ \\frac{u_j^* - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0 \\implies u_j^* = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_j^n - u_{j-1}^n) = (1-\\alpha)u_j^n + \\alpha u_{j-1}^n $$\n- If $c < 0$, the upwind difference is $\\frac{u_{j+1} - u_j}{\\Delta x}$. The Forward Euler update is:\n$$ \\frac{u_j^* - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0 \\implies u_j^* = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_{j+1}^n - u_j^n) = (1+\\frac{c\\Delta t}{\\Delta x})u_j^n - \\frac{c\\Delta t}{\\Delta x}u_{j+1}^n = (1-\\alpha)u_j^n + \\alpha u_{j+1}^n $$\nWe perform a von Neumann analysis by substituting a single Fourier mode $u_j^n = \\hat{u}^n(k) \\exp(i k x_j) = \\hat{u}^n(k) \\exp(i j \\theta)$, where $k$ is the wavenumber and $\\theta = k \\Delta x$ is the dimensionless wavenumber or phase shift per grid cell. The amplification factor for the advection step, $G_A(\\theta)$, is defined by $\\hat{u}^*(k) = G_A(\\theta) \\hat{u}^n(k)$.\n\n- For $c > 0$: $\\hat{u}^* \\exp(ij\\theta) = (1-\\alpha)\\hat{u}^n \\exp(ij\\theta) + \\alpha \\hat{u}^n \\exp(i(j-1)\\theta)$. Dividing by $\\hat{u}^n \\exp(ij\\theta)$ yields $G_A(\\theta) = (1-\\alpha) + \\alpha \\exp(-i\\theta)$.\n- For $c < 0$: $\\hat{u}^* \\exp(ij\\theta) = (1-\\alpha)\\hat{u}^n \\exp(ij\\theta) + \\alpha \\hat{u}^n \\exp(i(j+1)\\theta)$. Dividing by $\\hat{u}^n \\exp(ij\\theta)$ yields $G_A(\\theta) = (1-\\alpha) + \\alpha \\exp(i\\theta)$.\n\nThe squared magnitude of the amplification factor, $|G_A(\\theta)|^2$, is identical in both cases. For $c>0$:\n$$ |G_A(\\theta)|^2 = |(1-\\alpha) + \\alpha(\\cos\\theta - i\\sin\\theta)|^2 = |(1-\\alpha(1-\\cos\\theta)) - i\\alpha\\sin\\theta|^2 $$\n$$ |G_A(\\theta)|^2 = (1-\\alpha(1-\\cos\\theta))^2 + (\\alpha\\sin\\theta)^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-\\cos\\theta)^2 + \\alpha^2\\sin^2\\theta $$\n$$ |G_A(\\theta)|^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1 - 2\\cos\\theta + \\cos^2\\theta + \\sin^2\\theta) = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(2 - 2\\cos\\theta) $$\n$$ |G_A(\\theta)|^2 = 1 - 2(1-\\cos\\theta)(\\alpha-\\alpha^2) $$\nThis expression for $|G_A(\\theta)|^2$ holds for any $c \\neq 0$.\n\n**2. Analysis of the Diffusion Step**\nThe diffusion equation is $u_t = \\nu u_{xx}$. The scheme uses Backward Euler in time and a second-order centered difference for $u_{xx}$, which is $\\frac{u_{j+1} - 2u_j + u_{j-1}}{(\\Delta x)^2}$. The update from the intermediate state $u^*$ to the final state $u^{n+1}$ is:\n$$ \\frac{u_j^{n+1} - u_j^*}{\\Delta t} = \\nu \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} $$\nLet $\\beta = \\frac{\\nu\\Delta t}{(\\Delta x)^2}$ be the diffusion number. Since $\\nu \\ge 0$, we have $\\beta \\ge 0$.\n$$ u_j^* = u_j^{n+1} - \\beta(u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) $$\nSubstituting the Fourier mode $u_j = \\hat{u}(k) \\exp(ij\\theta)$ for both time levels $*$ and $n+1$:\n$$ \\hat{u}^* = \\hat{u}^{n+1} - \\beta(\\hat{u}^{n+1}\\exp(i\\theta) - 2\\hat{u}^{n+1} + \\hat{u}^{n+1}\\exp(-i\\theta)) $$\n$$ \\hat{u}^* = \\hat{u}^{n+1} (1 - \\beta(\\exp(i\\theta) + \\exp(-i\\theta) - 2)) = \\hat{u}^{n+1}(1 - \\beta(2\\cos\\theta - 2)) $$\n$$ \\hat{u}^* = \\hat{u}^{n+1}(1 + 2\\beta(1-\\cos\\theta)) $$\nThe amplification factor for the diffusion step, $G_D(\\theta)$, is defined by $\\hat{u}^{n+1}(k) = G_D(\\theta) \\hat{u}^*(k)$.\n$$ G_D(\\theta) = \\frac{1}{1 + 2\\beta(1-\\cos\\theta)} $$\nSince $\\beta \\ge 0$ and $1-\\cos\\theta \\ge 0$, the denominator is always greater than or equal to $1$. Thus, $|G_D(\\theta)| \\le 1$ for all $\\theta$, verifying that this step is unconditionally stable on its own.\n\n**3. Stability of the Combined Scheme**\nFor the full operator splitting step, the total amplification factor is the product $G(\\theta) = G_A(\\theta) G_D(\\theta)$. The stability condition requires $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$.\n$$ |G(\\theta)|^2 = |G_A(\\theta)|^2 |G_D(\\theta)|^2 \\le 1 $$\n$$ \\frac{1 - 2(1-\\cos\\theta)(\\alpha-\\alpha^2)}{(1 + 2\\beta(1-\\cos\\theta))^2} \\le 1 $$\nLet $X = 1-\\cos\\theta$. For $\\theta \\in [-\\pi, \\pi]$, we have $X \\in [0, 2]$. The inequality becomes:\n$$ 1 - 2X(\\alpha-\\alpha^2) \\le (1+2\\beta X)^2 = 1 + 4\\beta X + 4\\beta^2 X^2 $$\n$$ -2X(\\alpha-\\alpha^2) \\le 4\\beta X + 4\\beta^2 X^2 $$\n$$ 0 \\le 4\\beta X + 4\\beta^2 X^2 + 2X(\\alpha-\\alpha^2) $$\nFor $X=0$ (i.e., $\\theta=0$), the inequality is $0 \\le 0$, which is trivially true. For $X > 0$, we can divide by $X$:\n$$ 0 \\le 4\\beta + 4\\beta^2 X + 2(\\alpha-\\alpha^2) $$\nLet $f(X) = 4\\beta^2 X + (4\\beta + 2\\alpha - 2\\alpha^2)$. This inequality must hold for all $X \\in (0, 2]$. The function $f(X)$ is linear in $X$. Its slope is $4\\beta^2 \\ge 0$, so $f(X)$ is a non-decreasing function. The minimum value of $f(X)$ on the interval $[0, 2]$ occurs at $X=0$. Therefore, the condition is satisfied for all $X$ if it is satisfied at $X=0$:\n$$ 4\\beta + 2\\alpha - 2\\alpha^2 \\ge 0 $$\n$$ 2\\beta + \\alpha - \\alpha^2 \\ge 0 $$\nNow, we substitute the definitions of $\\alpha$ and $\\beta$:\n$$ 2\\left(\\frac{\\nu\\Delta t}{(\\Delta x)^2}\\right) + \\frac{|c|\\Delta t}{\\Delta x} - \\left(\\frac{|c|\\Delta t}{\\Delta x}\\right)^2 \\ge 0 $$\nSince we are looking for a non-trivial time step $\\Delta t > 0$, we can divide the inequality by $\\Delta t$:\n$$ \\frac{2\\nu}{(\\Delta x)^2} + \\frac{|c|}{\\Delta x} - \\frac{|c|^2 \\Delta t}{(\\Delta x)^2} \\ge 0 $$\nWe solve for $\\Delta t$ to find the stability bound:\n$$ \\frac{|c|^2 \\Delta t}{(\\Delta x)^2} \\le \\frac{2\\nu}{(\\Delta x)^2} + \\frac{|c|}{\\Delta x} $$\nMultiplying by $(\\Delta x)^2$ gives:\n$$ |c|^2 \\Delta t \\le 2\\nu + |c|\\Delta x $$\nSince $c \\neq 0$, $|c|^2 > 0$, and we can divide by it:\n$$ \\Delta t \\le \\frac{2\\nu + |c|\\Delta x}{|c|^2} $$\nThe largest allowable time step, $\\Delta t_{\\max}$, is the upper bound of this inequality.\n\n$$ \\Delta t_{\\max} = \\frac{2\\nu + |c|\\Delta x}{|c|^2} $$\nThis can also be written as $\\Delta t_{\\max} = \\frac{\\Delta x}{|c|} + \\frac{2\\nu}{|c|^2}$. This shows that the stable time step for the pure advection CFL condition ($\\Delta x/|c|$) is increased by a term proportional to the viscosity $\\nu$.", "answer": "$$\\boxed{\\frac{2\\nu + |c|\\Delta x}{|c|^2}}$$", "id": "3612346"}, {"introduction": "Operator splitting is widely used for wave propagation models, which often take the form of first-order hyperbolic systems. This exercise applies a leapfrog-like Strang splitting to the acoustic wave equations on a staggered grid, a setup central to computational seismology. Beyond deriving the update rules, the core task is to investigate the scheme's effect on a discrete energy, revealing how splitting can impact the conservation properties of the underlying physical system [@problem_id:3612339].", "problem": "Consider the one-dimensional linear acoustic system with constant bulk modulus $K>0$ and density $\\rho>0$,\n$$\np_{t} + K\\,u_{x} = 0, \\qquad u_{t} + \\frac{1}{\\rho}\\,p_{x} = 0,\n$$\nposed on a periodic interval of length $L$. Let the spatial domain be discretized on a uniform staggered grid with spacing $\\Delta x = L/J$ for some integer $J$. Define discrete pressure samples $p_{j}^{n} \\approx p(j\\,\\Delta x, n\\,\\Delta t)$ at integer spatial indices $j \\in \\{0,1,\\dots,J-1\\}$ and discrete velocity samples $u_{j+1/2}^{n} \\approx u\\!\\left((j+\\tfrac{1}{2})\\,\\Delta x, n\\,\\Delta t\\right)$ at half-integer spatial indices $j+1/2$, with periodic wrap-around in $j$. Let $\\Delta t>0$ be the time step. Introduce the centered difference operators that map between the staggered and non-staggered grids,\n$$\n(\\delta_{x} u)_{j} := \\frac{u_{j+1/2} - u_{j-1/2}}{\\Delta x}, \\qquad (\\delta_{x} p)_{j+1/2} := \\frac{p_{j+1} - p_{j}}{\\Delta x},\n$$\nand assume periodic boundary conditions so that discrete summation-by-parts holds,\n$$\n\\sum_{j=0}^{J-1} p_{j}\\,(\\delta_{x} u)_{j}\\,\\Delta x \\;=\\; - \\sum_{j=0}^{J-1} u_{j+1/2}\\,(\\delta_{x} p)_{j+1/2}\\,\\Delta x.\n$$\nDefine the discrete acoustic energy at time level $n$ by\n$$\nE^{n} := \\sum_{j=0}^{J-1} \\left(\\frac{1}{2K}\\,(p_{j}^{n})^{2} + \\frac{\\rho}{2}\\,(u_{j+1/2}^{n})^{2}\\right)\\,\\Delta x.\n$$\nApply a leapfrog-like Strang splitting over one full time step $\\Delta t$ formed by the composition of three substeps: (i) a half-step that advances $p$ while freezing $u$, (ii) a full step that advances $u$ while freezing $p$, and (iii) a half-step that advances $p$ while freezing $u$. Starting from $(p^{n},u^{n})$, derive explicit update formulas for the intermediate pressure $p^{n+1/2}$, the next-step velocity $u^{n+1}$, and the next-step pressure $p^{n+1}$ in terms of $K$, $\\rho$, $\\Delta x$, $\\Delta t$, and the centered difference operators. Then, using only the definitions above and the periodic summation-by-parts property, compute the discrete energy balance over the step, that is, the value of $E^{n+1}-E^{n}$, as a closed-form analytic expression. Your final answer must consist of the three update formulas together with the single expression for the one-step discrete energy change. No numerical evaluation is required.", "solution": "The problem asks for the derivation of the update formulas for a Strang splitting scheme applied to the 1D acoustic system and for the calculation of the one-step change in discrete energy.\n\nThe system of PDEs can be split into two sub-problems.\nSub-problem A (evolution of $p$): $p_t = -K u_x$, $u_t = 0$.\nSub-problem B (evolution of $u$): $p_t = 0$, $u_t = - \\frac{1}{\\rho} p_x$.\n\nThe discretized versions of these sub-problems are:\nSub-problem A: $\\frac{d p_j}{dt} = -K (\\delta_x u)_j$, $\\frac{d u_{j+1/2}}{dt} = 0$.\nSub-problem B: $\\frac{d p_j}{dt} = 0$, $\\frac{d u_{j+1/2}}{dt} = - \\frac{1}{\\rho} (\\delta_x p)_{j+1/2}$.\n\nThe Strang splitting scheme applies these operators sequentially using forward Euler steps.\n\n**(i) First half-step for $p$ over $\\Delta t/2$:**\nWe advance $p$ from time level $n$ to $n+1/2$, keeping $u$ fixed at $u^n$. The step size is $\\Delta t/2$.\n$$\np_j^{n+1/2} = p_j^n + \\frac{\\Delta t}{2} \\left( -K (\\delta_x u^n)_j \\right) = p_j^n - \\frac{K \\Delta t}{2} (\\delta_x u^n)_j\n$$\nThe state after this step is $(p^{n+1/2}, u^n)$.\n\n**(ii) Full step for $u$ over $\\Delta t$:**\nWe advance $u$ from time level $n$ to $n+1$, keeping $p$ fixed at the intermediate value $p^{n+1/2}$. The step size is $\\Delta t$.\n$$\nu_{j+1/2}^{n+1} = u_{j+1/2}^n + \\Delta t \\left( - \\frac{1}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2} \\right) = u_{j+1/2}^n - \\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2}\n$$\nThe state after this step is $(p^{n+1/2}, u^{n+1})$.\n\n**(iii) Second half-step for $p$ over $\\Delta t/2$:**\nWe advance $p$ from the intermediate level $n+1/2$ to $n+1$, keeping $u$ fixed at its new value $u^{n+1}$. The step size is $\\Delta t/2$.\n$$\np_j^{n+1} = p_j^{n+1/2} + \\frac{\\Delta t}{2} \\left( -K (\\delta_x u^{n+1})_j \\right) = p_j^{n+1/2} - \\frac{K \\Delta t}{2} (\\delta_x u^{n+1})_j\n$$\nThe final state is $(p^{n+1}, u^{n+1})$.\n\nThese are the three requested update formulas.\n\nWe now compute the discrete energy balance, $E^{n+1} - E^n$.\n$$\nE^{n+1} - E^n = \\sum_{j=0}^{J-1} \\left( \\frac{1}{2K} \\left((p_j^{n+1})^2 - (p_j^n)^2\\right) + \\frac{\\rho}{2} \\left((u_{j+1/2}^{n+1})^2 - (u_{j+1/2}^n)^2\\right) \\right) \\Delta x\n$$\nLet's analyze the two terms in the sum separately.\n\nFor the pressure term, we use the results from substeps (i) and (iii).\n$(p_j^{n+1})^2 = \\left(p_j^{n+1/2} - \\frac{K \\Delta t}{2} (\\delta_x u^{n+1})_j\\right)^2 = (p_j^{n+1/2})^2 - K \\Delta t \\, p_j^{n+1/2} (\\delta_x u^{n+1})_j + \\left(\\frac{K \\Delta t}{2}\\right)^2 ((\\delta_x u^{n+1})_j)^2$\nFrom (i), $p_j^n = p_j^{n+1/2} + \\frac{K \\Delta t}{2} (\\delta_x u^n)_j$.\n$(p_j^{n})^2 = \\left(p_j^{n+1/2} + \\frac{K \\Delta t}{2} (\\delta_x u^n)_j\\right)^2 = (p_j^{n+1/2})^2 + K \\Delta t \\, p_j^{n+1/2} (\\delta_x u^n)_j + \\left(\\frac{K \\Delta t}{2}\\right)^2 ((\\delta_x u^n)_j)^2$\nSubtracting these two expressions gives:\n$(p_j^{n+1})^2 - (p_j^n)^2 = -K \\Delta t \\, p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j + \\left(\\frac{K \\Delta t}{2}\\right)^2 \\left( ((\\delta_x u^{n+1})_j)^2 - ((\\delta_x u^n)_j)^2 \\right)$\n\nFor the velocity term, we use $a^2-b^2=(a-b)(a+b)$ and the result from substep (ii):\n$(u_{j+1/2}^{n+1})^2 - (u_{j+1/2}^n)^2 = (u_{j+1/2}^{n+1} - u_{j+1/2}^n)(u_{j+1/2}^{n+1} + u_{j+1/2}^n)$\n$= \\left(-\\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2}\\right) (u_{j+1/2}^{n+1} + u_{j+1/2}^n)$\n\nNow, substitute these back into the expression for $E^{n+1} - E^n$:\n$E^{n+1} - E^n = \\sum_{j=0}^{J-1} \\Delta x \\left[ \\frac{1}{2K} \\left( -K \\Delta t \\, p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j + \\frac{K^2 (\\Delta t)^2}{4} \\left( ((\\delta_x u^{n+1})_j)^2 - ((\\delta_x u^n)_j)^2 \\right) \\right) \\right. \\\\ \\left. + \\frac{\\rho}{2} \\left( -\\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2} (u_{j+1/2}^{n+1} + u_{j+1/2}^n) \\right) \\right]$\n\nSimplifying the coefficients:\n$E^{n+1} - E^n = \\sum_{j=0}^{J-1} \\Delta x \\left[ -\\frac{\\Delta t}{2} p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j + \\frac{K (\\Delta t)^2}{8} \\left( ((\\delta_x u^{n+1})_j)^2 - ((\\delta_x u^n)_j)^2 \\right) \\right. \\\\ \\left. - \\frac{\\Delta t}{2} (u_{j+1/2}^{n+1} + u_{j+1/2}^n) (\\delta_x p^{n+1/2})_{j+1/2} \\right]$\n\nLet's group the terms. The first and third terms involve products of field variables.\nTerm 1: $-\\frac{\\Delta t}{2} \\sum_j p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j \\Delta x$\nTerm 3: $-\\frac{\\Delta t}{2} \\sum_j (u_{j+1/2}^{n+1} + u_{j+1/2}^n) (\\delta_x p^{n+1/2})_{j+1/2} \\Delta x$\n\nWe apply the given summation-by-parts property to Term 1, with identifications $p_j \\to p_j^{n+1/2}$ and $u_{j+1/2} \\to (u^{n+1} + u^n)_{j+1/2}$.\n$\\sum_j p_j^{n+1/2} (\\delta_x (u^{n+1} + u^n))_j \\Delta x = - \\sum_j (u^{n+1} + u^n)_{j+1/2} (\\delta_x p^{n+1/2})_{j+1/2} \\Delta x$\nSubstituting this into the expression for Term 1:\nTerm 1 = $-\\frac{\\Delta t}{2} \\left( - \\sum_j (u^{n+1} + u^n)_{j+1/2} (\\delta_x p^{n+1/2})_{j+1/2} \\Delta x \\right) = +\\frac{\\Delta t}{2} \\sum_j (u_{j+1/2}^{n+1} + u_{j+1/2}^n) (\\delta_x p^{n+1/2})_{j+1/2} \\Delta x$\n\nWe observe that this transformed Term 1 is exactly the negative of Term 3. Therefore, their sum is zero.\nTerm 1 + Term 3 = $0$.\n\nThe only remaining term in the energy balance is:\n$$\nE^{n+1} - E^n = \\sum_{j=0}^{J-1} \\frac{K (\\Delta t)^2}{8} \\left( ((\\delta_x u^{n+1})_j)^2 - ((\\delta_x u^n)_j)^2 \\right) \\Delta x\n$$\nThis is a valid closed-form expression. We can write it in a slightly more elegant form by relating $(\\delta_x u)_j$ back to the pressure updates.\nFrom our update formulas, we have:\n$(\\delta_x u^n)_j = -\\frac{2}{K\\Delta t}(p_j^{n+1/2} - p_j^n)$\n$(\\delta_x u^{n+1})_j = -\\frac{2}{K\\Delta t}(p_j^{n+1} - p_j^{n+1/2})$\nSubstituting these into the energy balance expression:\n$E^{n+1} - E^n = \\frac{K (\\Delta t)^2}{8} \\sum_{j=0}^{J-1} \\left[ \\left(-\\frac{2}{K\\Delta t}(p_j^{n+1} - p_j^{n+1/2})\\right)^2 - \\left(-\\frac{2}{K\\Delta t}(p_j^{n+1/2} - p_j^n)\\right)^2 \\right] \\Delta x$\n$E^{n+1} - E^n = \\frac{K (\\Delta t)^2}{8} \\frac{4}{K^2 (\\Delta t)^2} \\sum_{j=0}^{J-1} \\left[ (p_j^{n+1} - p_j^{n+1/2})^2 - (p_j^{n+1/2} - p_j^n)^2 \\right] \\Delta x$\n$$\nE^{n+1} - E^n = \\frac{1}{2K} \\sum_{j=0}^{J-1} \\left( (p_j^{n+1} - p_j^{n+1/2})^2 - (p_j^{n+1/2} - p_j^n)^2 \\right) \\Delta x\n$$\nThis final expression is compact and clearly shows that the scheme is not exactly energy-conserving. The energy change depends on the difference in the squared pressure increments from the two half-steps of the splitting scheme.", "answer": "$$\n\\boxed{\n\\begin{gathered}\np_j^{n+1/2} = p_j^n - \\frac{K \\Delta t}{2} (\\delta_x u^n)_j \\\\\nu_{j+1/2}^{n+1} = u_{j+1/2}^n - \\frac{\\Delta t}{\\rho} (\\delta_x p^{n+1/2})_{j+1/2} \\\\\np_j^{n+1} = p_j^{n+1/2} - \\frac{K \\Delta t}{2} (\\delta_x u^{n+1})_j \\\\\nE^{n+1} - E^n = \\frac{1}{2K} \\sum_{j=0}^{J-1} \\left( (p_j^{n+1} - p_j^{n+1/2})^2 - (p_j^{n+1/2} - p_j^n)^2 \\right) \\Delta x\n\\end{gathered}\n}\n$$", "id": "3612339"}]}