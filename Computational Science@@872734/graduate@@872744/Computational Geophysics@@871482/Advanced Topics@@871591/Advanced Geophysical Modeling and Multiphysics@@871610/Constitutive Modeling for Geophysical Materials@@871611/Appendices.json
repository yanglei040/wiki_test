{"hands_on_practices": [{"introduction": "Before we can model the forces within a deforming geophysical material, we must have a robust language to describe the deformation itself. This practice grounds your understanding in the fundamental kinematics of finite strain theory, which is essential when materials undergo large shape changes, a common scenario in tectonics and rock mechanics. By working through the relationship between principal stretches and logarithmic strains, you will solidify your grasp of how to properly quantify deformation in a way that is consistent for complex loading paths [@problem_id:3581287].", "problem": "Consider an isotropic, compressible, hyperelastic geophysical material undergoing a finite, homogeneous deformation characterized by principal stretches $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ along three orthogonal principal directions. Starting from continuum kinematics, use the deformation gradient $\\mathbf{F}$, its polar decomposition into a proper orthogonal rotation $\\mathbf{R}$ and a left stretch tensor $\\mathbf{V}$ such that $\\mathbf{F}=\\mathbf{R}\\mathbf{V}$, and the Eulerian logarithmic (Hencky) strain tensor defined by the matrix logarithm of $\\mathbf{V}$, to derive the relationship between the principal values of the logarithmic strain and the principal stretches. Further, use the definition of the Jacobian $J=\\det\\mathbf{F}$ and invariance properties of the determinant under rotations to obtain the corresponding volumetric logarithmic strain in terms of $J$. Then, evaluate these quantities for a finite pure stretch with principal stretches $\\lambda_{1}=1.1$, $\\lambda_{2}=0.9$, and $\\lambda_{3}=1.0$. Report the three principal logarithmic strains and the volumetric logarithmic strain as dimensionless numbers. Round your answers to six significant figures.", "solution": "The foundational kinematics of continuum mechanics define the deformation gradient $\\mathbf{F}$ via the relation $\\mathrm{d}\\mathbf{x}=\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}$, where $\\mathbf{X}$ denotes material coordinates and $\\mathbf{x}$ denotes spatial coordinates. The polar decomposition theorem states that any invertible $\\mathbf{F}$ can be written as $\\mathbf{F}=\\mathbf{R}\\mathbf{V}$, where $\\mathbf{R}$ is a proper orthogonal tensor (a rotation with $\\det\\mathbf{R}=1$) and $\\mathbf{V}$ is the left stretch tensor, a symmetric positive-definite tensor that encodes stretches in the current configuration.\n\nThe Eulerian logarithmic (Hencky) strain tensor $\\mathbf{H}$ is defined as the matrix logarithm of the left stretch tensor,\n$$\n\\mathbf{H}=\\ln\\mathbf{V}.\n$$\nBecause $\\mathbf{V}$ is symmetric positive-definite, it admits a spectral decomposition\n$$\n\\mathbf{V}=\\sum_{i=1}^{3}\\lambda_{i}\\,\\mathbf{n}_{i}\\otimes\\mathbf{n}_{i},\n$$\nwhere $\\lambda_{i}0$ are the principal stretches and $\\{\\mathbf{n}_{i}\\}$ are the associated orthonormal principal directions. The matrix logarithm respects this spectral decomposition for positive-definite tensors, yielding\n$$\n\\mathbf{H}=\\ln\\mathbf{V}=\\sum_{i=1}^{3}\\ln(\\lambda_{i})\\,\\mathbf{n}_{i}\\otimes\\mathbf{n}_{i}.\n$$\nThus, the principal values of the logarithmic strain are\n$$\n\\epsilon_{i}=\\ln\\lambda_{i},\\quad i=1,2,3.\n$$\n\nThe volumetric change is measured by the Jacobian\n$$\nJ=\\det\\mathbf{F}.\n$$\nUsing the polar decomposition, we have\n$$\nJ=\\det(\\mathbf{R}\\mathbf{V})=\\det\\mathbf{R}\\,\\det\\mathbf{V}=\\det\\mathbf{V},\n$$\nsince $\\det\\mathbf{R}=1$ for a proper rotation. For a diagonalizable positive-definite tensor, $\\det\\mathbf{V}=\\prod_{i=1}^{3}\\lambda_{i}$. The volumetric logarithmic strain (also called the logarithmic measure of volume change) is defined by\n$$\n\\epsilon_{v}=\\ln J=\\ln(\\det\\mathbf{V}).\n$$\nUsing properties of logarithms and determinants for positive-definite tensors,\n$$\n\\epsilon_{v}=\\ln\\left(\\prod_{i=1}^{3}\\lambda_{i}\\right)=\\sum_{i=1}^{3}\\ln\\lambda_{i}=\\operatorname{tr}(\\mathbf{H}),\n$$\nwhich connects the volumetric logarithmic strain to the trace of the Hencky strain tensor.\n\nNow, evaluate these for the given principal stretches $\\lambda_{1}=1.1$, $\\lambda_{2}=0.9$, and $\\lambda_{3}=1.0$. First compute the principal logarithmic strains:\n$$\n\\epsilon_{1}=\\ln(1.1),\\qquad \\epsilon_{2}=\\ln(0.9),\\qquad \\epsilon_{3}=\\ln(1.0).\n$$\nSince $\\ln(1.0)=0$, we have $\\epsilon_{3}=0$. Numerically evaluating and rounding to six significant figures:\n$$\n\\epsilon_{1}=\\ln(1.1)\\approx 0.0953102,\n$$\n$$\n\\epsilon_{2}=\\ln(0.9)\\approx -0.105361,\n$$\n$$\n\\epsilon_{3}=\\ln(1.0)=0.\n$$\nNext compute the Jacobian\n$$\nJ=\\lambda_{1}\\lambda_{2}\\lambda_{3}=1.1\\times 0.9\\times 1.0=0.99,\n$$\nand the volumetric logarithmic strain\n$$\n\\epsilon_{v}=\\ln(J)=\\ln(0.99)\\approx -0.0100503,\n$$\nrounded to six significant figures.\n\nCollecting the results and expressing them as dimensionless numbers:\n$$\n\\epsilon_{1}\\approx 0.0953102,\\quad \\epsilon_{2}\\approx -0.105361,\\quad \\epsilon_{3}=0,\\quad \\epsilon_{v}\\approx -0.0100503.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.0953102  -0.105361  0  -0.0100503\\end{pmatrix}}$$", "id": "3581287"}, {"introduction": "Many geophysical processes, such as post-seismic relaxation or mantle convection, involve materials that behave as both solids and fluids over different timescales. This hands-on exercise introduces you to linear viscoelasticity, a powerful framework for capturing this time-dependent rheology, using the generalized Maxwell model. You will derive the governing differential equation for stress evolution and implement a numerically stable exponential integrator, two core skills for developing robust computational models of viscoelastic phenomena [@problem_id:3581349].", "problem": "Consider a small-strain, uniaxial generalized Maxwell solid composed of an equilibrium spring in parallel with a set of Maxwell branches. Each Maxwell branch consists of a linear elastic spring in series with a linear viscous dashpot. The fundamental base for modeling is the combination of Hooke’s law for a spring and Newton’s law of viscosity for a dashpot, together with series and parallel connection rules for mechanical elements. Specifically, for a spring, the stress is related to the elastic strain by $\\sigma = E \\, \\epsilon^{e}$, and for a dashpot, the stress is related to the viscous strain rate by $\\sigma = \\eta \\, \\dot{\\epsilon}^{v}$. For a series connection, the stress is equal in both elements while strains add; for a parallel connection, the strains are equal across branches while stresses add.\n\nYou are to derive the evolution equations for the internal stresses carried by the Maxwell branches and to construct an unconditionally stable exponential time-integration update for a strain step that proceeds linearly from a known strain at the beginning of the step to a known strain at the end of the step.\n\nTasks:\n- Starting from the fundamental laws and definitions stated above, and without introducing any target formula a priori, derive the first-order linear ordinary differential equation governing the time evolution of the stress carried by a single Maxwell branch subject to an imposed strain history $\\epsilon(t)$ under small strain conditions. Clearly state any assumptions used.\n- Using a constant strain rate over a time step $\\Delta t$ from time $t_n$ to time $t_{n+1}$, where $\\epsilon(t)$ varies linearly as $\\epsilon(t) = \\epsilon_n + \\dfrac{t - t_n}{\\Delta t} \\, \\Delta \\epsilon$, derive the exact exponential-update expression for advancing the Maxwell branch stress from time $t_n$ to time $t_{n+1}$ for that branch. Your derivation must be based on solving the derived differential equation with an integrating factor and evaluating the resulting convolution exactly for the piecewise-linear strain within the step.\n- Extend the result to two Maxwell branches in parallel with an equilibrium spring of modulus $E_{\\mathrm{eq}}$, and express the total Cauchy stress at the end of the step as the sum of the equilibrium spring stress and the Maxwell branch stresses. Define all quantities unambiguously.\n- Implement the resulting update in a program that takes, for each test case, the following inputs:\n  - Equilibrium spring modulus $E_{\\mathrm{eq}}$ in $\\mathrm{Pa}$.\n  - For each of two Maxwell branches $i \\in \\{1,2\\}$: spring modulus $E_i$ in $\\mathrm{Pa}$ and viscosity $\\eta_i$ in $\\mathrm{Pa \\cdot s}$.\n  - Initial strain $\\epsilon_n$ (dimensionless), strain increment $\\Delta \\epsilon$ over the step (dimensionless), and initial branch stresses $s_{i,n}$ in $\\mathrm{Pa}$.\n  - Time step $\\Delta t$ in $\\mathrm{s}$.\n- Your program must compute, for each test case, the updated branch stresses $s_{1,n+1}$ and $s_{2,n+1}$ in $\\mathrm{Pa}$, and the updated total stress $\\sigma_{n+1}$ in $\\mathrm{Pa}$, assuming a linear-in-time strain path over the step.\n- Express all stresses in $\\mathrm{Pa}$, time in $\\mathrm{s}$, and strain as dimensionless. The angle unit is not applicable. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list of three floating-point numbers $[s_{1,n+1}, s_{2,n+1}, \\sigma_{n+1}]$; aggregate all test-case results into a single list on a single line, for example $[[a,b,c],[d,e,f]]$. It is acceptable to round each number to six digits after the decimal point.\n\nUse the following scientifically consistent test suite, chosen to exercise typical, small-step, large-step, zero-increment, and mixed-sign loading behaviors. For any case where a branch modulus $E_i$ is zero, treat that branch as inactive with zero stress.\n\nTest Suite:\n- Case A (moderate step; single active Maxwell branch):\n  - $E_{\\mathrm{eq}} = 3 \\times 10^{10} \\ \\mathrm{Pa}$, $E_1 = 1 \\times 10^{10} \\ \\mathrm{Pa}$, $\\eta_1 = 1 \\times 10^{14} \\ \\mathrm{Pa \\cdot s}$, $E_2 = 0 \\ \\mathrm{Pa}$, $\\eta_2 = 1 \\ \\mathrm{Pa \\cdot s}$,\n  - $\\epsilon_n = 0$, $\\Delta \\epsilon = 1 \\times 10^{-5}$, $s_{1,n} = 0 \\ \\mathrm{Pa}$, $s_{2,n} = 0 \\ \\mathrm{Pa}$, $\\Delta t = 1 \\times 10^{3} \\ \\mathrm{s}$.\n- Case B (zero strain increment; relaxation only):\n  - $E_{\\mathrm{eq}} = 3 \\times 10^{10} \\ \\mathrm{Pa}$, $E_1 = 5 \\times 10^{9} \\ \\mathrm{Pa}$, $\\eta_1 = 1 \\times 10^{12} \\ \\mathrm{Pa \\cdot s}$, $E_2 = 2 \\times 10^{9} \\ \\mathrm{Pa}$, $\\eta_2 = 5 \\times 10^{11} \\ \\mathrm{Pa \\cdot s}$,\n  - $\\epsilon_n = 1 \\times 10^{-4}$, $\\Delta \\epsilon = 0$, $s_{1,n} = 5 \\times 10^{5} \\ \\mathrm{Pa}$, $s_{2,n} = -1 \\times 10^{5} \\ \\mathrm{Pa}$, $\\Delta t = 1 \\times 10^{5} \\ \\mathrm{s}$.\n- Case C (very small time step; nearly elastic response in Maxwell branches):\n  - $E_{\\mathrm{eq}} = 0 \\ \\mathrm{Pa}$, $E_1 = 2 \\times 10^{10} \\ \\mathrm{Pa}$, $\\eta_1 = 1 \\times 10^{16} \\ \\mathrm{Pa \\cdot s}$, $E_2 = 8 \\times 10^{9} \\ \\mathrm{Pa}$, $\\eta_2 = 4 \\times 10^{15} \\ \\mathrm{Pa \\cdot s}$,\n  - $\\epsilon_n = 0$, $\\Delta \\epsilon = 1 \\times 10^{-6}$, $s_{1,n} = 0 \\ \\mathrm{Pa}$, $s_{2,n} = 0 \\ \\mathrm{Pa}$, $\\Delta t = 1 \\ \\mathrm{s}$.\n- Case D (very large time step; dashpot-dominated response approaches viscosity times strain rate):\n  - $E_{\\mathrm{eq}} = 0 \\ \\mathrm{Pa}$, $E_1 = 5 \\times 10^{9} \\ \\mathrm{Pa}$, $\\eta_1 = 1 \\times 10^{10} \\ \\mathrm{Pa \\cdot s}$, $E_2 = 3 \\times 10^{9} \\ \\mathrm{Pa}$, $\\eta_2 = 3 \\times 10^{10} \\ \\mathrm{Pa \\cdot s}$,\n  - $\\epsilon_n = 0$, $\\Delta \\epsilon = 1 \\times 10^{-2}$, $s_{1,n} = 0 \\ \\mathrm{Pa}$, $s_{2,n} = 0 \\ \\mathrm{Pa}$, $\\Delta t = 1 \\times 10^{5} \\ \\mathrm{s}$.\n- Case E (mixed signs and partial relaxation):\n  - $E_{\\mathrm{eq}} = 1 \\times 10^{10} \\ \\mathrm{Pa}$, $E_1 = 7 \\times 10^{9} \\ \\mathrm{Pa}$, $\\eta_1 = 7 \\times 10^{12} \\ \\mathrm{Pa \\cdot s}$, $E_2 = 1 \\times 10^{9} \\ \\mathrm{Pa}$, $\\eta_2 = 1 \\times 10^{11} \\ \\mathrm{Pa \\cdot s}$,\n  - $\\epsilon_n = 2 \\times 10^{-4}$, $\\Delta \\epsilon = -5 \\times 10^{-5}$, $s_{1,n} = 1 \\times 10^{6} \\ \\mathrm{Pa}$, $s_{2,n} = -2 \\times 10^{5} \\ \\mathrm{Pa}$, $\\Delta t = 5 \\times 10^{2} \\ \\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one sublist per case in the same order as above. Each sublist must be of the form $[s_{1,n+1}, s_{2,n+1}, \\sigma_{n+1}]$ in $\\mathrm{Pa}$, with each number rounded to six digits after the decimal point, for example $[[x_{A,1}, x_{A,2}, x_{A,3}],[x_{B,1}, x_{B,2}, x_{B,3}],\\ldots]$.", "solution": "### Derivation of the Governing Equation for a Maxwell Branch\n\nA single Maxwell branch consists of a linear elastic spring and a linear viscous dashpot connected in series. Let $s$ be the uniaxial stress in the branch and $\\epsilon$ be the total uniaxial strain across the branch.\n\n**Assumptions:**\n1.  The material behavior is described under the small-strain assumption.\n2.  The material parameters, namely the spring modulus $E$ and the dashpot viscosity $\\eta$, are constant.\n3.  The stress and strain are in a uniaxial state.\n\n**Fundamental Laws and Definitions:**\n-   For a series connection, the stress is uniform throughout the elements, and the total strain is the sum of the individual strains. Let $\\epsilon^e$ be the strain in the spring and $\\epsilon^v$ be the strain in the dashpot.\n    $$s = s^e = s^v$$\n    $$\\epsilon = \\epsilon^e + \\epsilon^v$$\n-   Hooke's Law for the spring relates stress to elastic strain:\n    $$s = E \\epsilon^e \\implies \\epsilon^e = \\frac{s}{E}$$\n-   Newton's Law of Viscosity for the dashpot relates stress to the rate of viscous strain:\n    $$s = \\eta \\dot{\\epsilon}^v \\implies \\dot{\\epsilon}^v = \\frac{s}{\\eta}$$\n    where the dot represents differentiation with respect to time $t$, i.e., $\\dot{\\epsilon}^v = \\frac{d\\epsilon^v}{dt}$.\n\n**Derivation:**\nTo find the relationship between the total strain history $\\epsilon(t)$ and the stress response $s(t)$ of the branch, we differentiate the total strain equation with respect to time:\n$$\\dot{\\epsilon} = \\dot{\\epsilon}^e + \\dot{\\epsilon}^v$$\nWe can express the strain rates on the right-hand side in terms of the stress $s$. Differentiating the spring's constitutive law with respect to time gives:\n$$\\dot{\\epsilon}^e = \\frac{d}{dt}\\left(\\frac{s}{E}\\right) = \\frac{1}{E}\\dot{s}$$\nThe dashpot's law already provides the viscous strain rate:\n$$\\dot{\\epsilon}^v = \\frac{s}{\\eta}$$\nSubstituting these two expressions into the time-differentiated total strain equation yields:\n$$\\dot{\\epsilon}(t) = \\frac{1}{E}\\dot{s}(t) + \\frac{1}{\\eta}s(t)$$\nMultiplying by $E$ and rearranging terms, we obtain the governing first-order linear ordinary differential equation (ODE) for the stress $s(t)$ in a Maxwell branch subjected to a strain history $\\epsilon(t)$:\n$$\\dot{s}(t) + \\frac{E}{\\eta}s(t) = E\\dot{\\epsilon}(t)$$\nIt is customary to define the relaxation time of the Maxwell branch as $\\tau = \\eta/E$. With this definition, the ODE becomes:\n$$\\dot{s}(t) + \\frac{1}{\\tau}s(t) = E\\dot{\\epsilon}(t)$$\nThis is the required evolution equation.\n\n### Derivation of the Exponential Time-Integration Update\n\nWe are tasked with solving this ODE over a discrete time step of duration $\\Delta t = t_{n+1} - t_n$, where the strain varies linearly from $\\epsilon_n$ at time $t_n$ to $\\epsilon_{n+1}$ at time $t_{n+1}$.\nThe strain history within the step is given by:\n$$\\epsilon(t) = \\epsilon_n + \\frac{t - t_n}{\\Delta t}\\Delta\\epsilon \\quad \\text{for } t \\in [t_n, t_{n+1}]$$\nwhere $\\Delta\\epsilon = \\epsilon_{n+1} - \\epsilon_n$. The strain rate over this interval is therefore constant:\n$$\\dot{\\epsilon}(t) = \\frac{d\\epsilon}{dt} = \\frac{\\Delta\\epsilon}{\\Delta t}$$\nSubstituting this constant strain rate into the governing ODE, we have for $t \\in [t_n, t_{n+1}]$:\n$$\\dot{s}(t) + \\frac{1}{\\tau}s(t) = E\\frac{\\Delta\\epsilon}{\\Delta t}$$\nThis is a first-order linear inhomogeneous ODE with constant coefficients. We solve it using an integrating factor, as requested. The integrating factor $I(t)$ is:\n$$I(t) = \\exp\\left(\\int \\frac{1}{\\tau} dt\\right) = e^{t/\\tau}$$\nMultiplying the ODE by $I(t)$:\n$$e^{t/\\tau}\\dot{s}(t) + \\frac{1}{\\tau}e^{t/\\tau}s(t) = E\\frac{\\Delta\\epsilon}{\\Delta t}e^{t/\\tau}$$\nThe left side is the derivative of a product:\n$$\\frac{d}{dt}\\left(s(t)e^{t/\\tau}\\right) = E\\frac{\\Delta\\epsilon}{\\Delta t}e^{t/\\tau}$$\nWe integrate both sides from $t_n$ to $t_{n+1}$:\n$$\\int_{t_n}^{t_{n+1}} \\frac{d}{dt}\\left(s(t)e^{t/\\tau}\\right) dt = \\int_{t_n}^{t_{n+1}} E\\frac{\\Delta\\epsilon}{\\Delta t}e^{t/\\tau} dt$$\n$$[s(t)e^{t/\\tau}]_{t_n}^{t_{n+1}} = E\\frac{\\Delta\\epsilon}{\\Delta t} [\\tau e^{t/\\tau}]_{t_n}^{t_{n+1}}$$\n$$s(t_{n+1})e^{t_{n+1}/\\tau} - s(t_n)e^{t_n/\\tau} = E\\frac{\\Delta\\epsilon}{\\Delta t} \\tau (e^{t_{n+1}/\\tau} - e^{t_n/\\tau})$$\nDenoting $s(t_n) = s_n$ and $s(t_{n+1}) = s_{n+1}$, and solving for $s_{n+1}$:\n$$s_{n+1} = s_n e^{(t_n-t_{n+1})/\\tau} + E\\tau\\frac{\\Delta\\epsilon}{\\Delta t}(1 - e^{(t_n-t_{n+1})/\\tau})$$\nUsing the fact that $t_n - t_{n+1} = -\\Delta t$, the final expression for the updated stress is:\n$$s_{n+1} = s_n e^{-\\Delta t/\\tau} + E\\tau\\frac{\\Delta\\epsilon}{\\Delta t}(1 - e^{-\\Delta t/\\tau})$$\nFor numerical implementation, especially for small values of the dimensionless time step $\\Delta t/\\tau$, it is advantageous to rewrite the equation as:\n$$s_{n+1} = s_n e^{-\\Delta t/\\tau} + E\\Delta\\epsilon \\left( \\frac{1 - e^{-\\Delta t/\\tau}}{\\Delta t/\\tau} \\right)$$\nThis form isolates the term in parentheses, which approaches $1$ as $\\Delta t/\\tau \\to 0$ and is well-behaved, preventing loss of precision. This update is exact for a piecewise-linear strain path and is unconditionally stable for any positive $\\Delta t$ and $\\tau$.\n\n### Extension to the Generalized Maxwell Model\n\nThe model consists of an equilibrium spring (modulus $E_{\\mathrm{eq}}$) in parallel with two Maxwell branches (indexed $i=1,2$).\n-   For a parallel connection, the strain is the same across all elements, and the total stress is the sum of the stresses in each element.\n-   The total strain applied to the system at time $t$ is $\\epsilon(t)$. This is the strain experienced by the equilibrium spring and both Maxwell branches.\n-   The total Cauchy stress $\\sigma(t)$ is the sum of the equilibrium stress $s_{\\mathrm{eq}}(t)$ and the stresses in the two Maxwell branches, $s_1(t)$ and $s_2(t)$.\n    $$\\sigma(t) = s_{\\mathrm{eq}}(t) + s_1(t) + s_2(t)$$\n\n**Stress Update at time $t_{n+1}$:**\nThe total stress at the end of the time step, $\\sigma_{n+1}$, is:\n$$\\sigma_{n+1} = s_{\\mathrm{eq},n+1} + s_{1,n+1} + s_{2,n+1}$$\nThe individual components are calculated as follows:\n1.  **Equilibrium Spring Stress:** The equilibrium spring is purely elastic. Its stress at time $t_{n+1}$ depends only on the strain at that time, $\\epsilon_{n+1} = \\epsilon_n + \\Delta\\epsilon$.\n    $$s_{\\mathrm{eq},n+1} = E_{\\mathrm{eq}}\\epsilon_{n+1} = E_{\\mathrm{eq}}(\\epsilon_n + \\Delta\\epsilon)$$\n2.  **Maxwell Branch Stresses:** The stress in each Maxwell branch $i \\in \\{1,2\\}$ is updated using the derived exponential formula. For each branch $i$ with parameters $E_i, \\eta_i$ and initial stress $s_{i,n}$:\n    -   First, we handle the case specified in the problem where a branch may be inactive. If $E_i = 0$, the branch stress $s_{i,n+1}$ is set to $0$.\n    -   If $E_i  0$, we compute its relaxation time $\\tau_i = \\eta_i/E_i$. The updated stress $s_{i,n+1}$ is then:\n        $$s_{i,n+1} = s_{i,n} e^{-\\Delta t/\\tau_i} + E_i \\Delta\\epsilon \\left( \\frac{1 - e^{-\\Delta t/\\tau_i}}{\\Delta t/\\tau_i} \\right)$$\n        This formula holds provided $\\tau_i  0$. If $\\tau_i = 0$ (i.e., $\\eta_i=0$), the stress $s_{i,n+1}$ is $0$. If $\\Delta t=0$, $s_{i,n+1} = s_{i,n}$ assuming $\\Delta\\epsilon=0$. Our implementation will handle the case where the argument $\\Delta t/\\tau_i$ is zero.\n\nThe program will implement these three calculations for each provided test case to find $s_{1,n+1}$, $s_{2,n+1}$, and $\\sigma_{n+1}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the viscoelastic stress update problem for a series of test cases.\n    The model is a generalized Maxwell solid with one equilibrium spring and two\n    Maxwell branches in parallel. The stress update is derived for a linear\n    strain increment over a time step.\n    \"\"\"\n\n    test_cases = [\n        # Case A\n        {'E_eq': 3e10, 'E1': 1e10, 'eta1': 1e14, 'E2': 0, 'eta2': 1.0,\n         'eps_n': 0.0, 'd_eps': 1e-5, 's1_n': 0.0, 's2_n': 0.0, 'dt': 1e3},\n        # Case B\n        {'E_eq': 3e10, 'E1': 5e9, 'eta1': 1e12, 'E2': 2e9, 'eta2': 5e11,\n         'eps_n': 1e-4, 'd_eps': 0.0, 's1_n': 5e5, 's2_n': -1e5, 'dt': 1e5},\n        # Case C\n        {'E_eq': 0.0, 'E1': 2e10, 'eta1': 1e16, 'E2': 8e9, 'eta2': 4e15,\n         'eps_n': 0.0, 'd_eps': 1e-6, 's1_n': 0.0, 's2_n': 0.0, 'dt': 1.0},\n        # Case D\n        {'E_eq': 0.0, 'E1': 5e9, 'eta1': 1e10, 'E2': 3e9, 'eta2': 3e10,\n         'eps_n': 0.0, 'd_eps': 1e-2, 's1_n': 0.0, 's2_n': 0.0, 'dt': 1e5},\n        # Case E\n        {'E_eq': 1e10, 'E1': 7e9, 'eta1': 7e12, 'E2': 1e9, 'eta2': 1e11,\n         'eps_n': 2e-4, 'd_eps': -5e-5, 's1_n': 1e6, 's2_n': -2e5, 'dt': 500.0}\n    ]\n\n    def compute_branch_stress_update(s_n, E, eta, d_eps, dt):\n        \"\"\"\n        Computes the updated stress for a single Maxwell branch.\n        \"\"\"\n        # Per problem statement, if E_i = 0, the branch is inactive and stress is 0.\n        if E == 0.0:\n            return 0.0\n\n        # The relaxation time tau = eta / E. If eta is 0, tau is 0.\n        # If tau is 0, the dashpot offers no resistance, so stress is 0.\n        if eta == 0.0:\n            return 0.0\n\n        tau = eta / E\n        \n        # Dimensionless time step x = dt / tau\n        x = dt / tau\n\n        # The update formula is s_{n+1} = s_n * exp(-x) + E * d_eps * F(x)\n        # where F(x) = (1 - exp(-x)) / x.\n        # This can be unstable for small x. We use a stable formulation.\n        if x == 0.0:\n            # L'Hopital's rule on F(x) gives 1 as x - 0.\n            # This corresponds to a purely elastic increment.\n            F = 1.0\n        else:\n            # np.expm1(y) computes exp(y) - 1 with high accuracy for small y.\n            # F(x) = - (exp(-x) - 1) / x = -expm1(-x) / x\n            F = -np.expm1(-x) / x\n        \n        s_n_plus_1 = s_n * np.exp(-x) + E * d_eps * F\n        return s_n_plus_1\n\n    results = []\n    for params in test_cases:\n        s1_n_plus_1 = compute_branch_stress_update(\n            params['s1_n'], params['E1'], params['eta1'], params['d_eps'], params['dt']\n        )\n\n        s2_n_plus_1 = compute_branch_stress_update(\n            params['s2_n'], params['E2'], params['eta2'], params['d_eps'], params['dt']\n        )\n        \n        # Calculate total strain at the end of the step\n        eps_n_plus_1 = params['eps_n'] + params['d_eps']\n        \n        # Calculate stress in the equilibrium spring\n        s_eq_n_plus_1 = params['E_eq'] * eps_n_plus_1\n        \n        # Total stress is the sum of stresses in parallel components\n        sigma_n_plus_1 = s_eq_n_plus_1 + s1_n_plus_1 + s2_n_plus_1\n        \n        results.append([s1_n_plus_1, s2_n_plus_1, sigma_n_plus_1])\n    \n    # Format the output string as required: [[r1,r2,r3],[r4,r5,r6],...]\n    # with 6 digits after the decimal point and no spaces.\n    outer_parts = []\n    for r in results:\n        inner_parts = [f\"{v:.6f}\" for v in r]\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    final_string = f\"[{','.join(outer_parts)}]\"\n\n    print(final_string)\n\nsolve()\n```", "id": "3581349"}, {"introduction": "Beyond elastic and viscous effects, many geomaterials exhibit permanent, irreversible deformation when subjected to sufficient stress, a behavior known as plasticity. This practice challenges you to implement a return-mapping algorithm for the classic Mohr-Coulomb model, a cornerstone of computational geomechanics used to predict failure in soils and rocks. Mastering this algorithm provides you with a foundational tool for numerically simulating processes involving material yielding and failure, from landslide initiation to crustal faulting [@problem_id:3581296].", "problem": "Consider small-strain, rate-independent elastoplasticity for a cohesion-frictional geomaterial obeying the Mohr–Coulomb criterion under an axisymmetric compression state. Adopt the compression-positive sign convention for stress. The elastic response is isotropic with bulk modulus $K$ and shear modulus $G$. Let the principal stresses satisfy $\\sigma_1 \\ge \\sigma_2 = \\sigma_3$ and assume the loading and return-mapping steps preserve the principal directions. Define the first invariant of stress (mean stress) as $p = (\\sigma_1 + \\sigma_2 + \\sigma_3)/3$, the deviatoric stress tensor $\\mathbf{s} = \\boldsymbol{\\sigma} - p \\mathbf{I}$, and the second invariant $J_2 = \\tfrac{1}{2} \\mathbf{s}:\\mathbf{s}$. Define the deviatoric stress measure $q = \\sqrt{3 J_2}$. Under axisymmetric compression with $\\sigma_2 = \\sigma_3$, it is a fundamental fact that $q = \\sigma_1 - \\sigma_3$ and $p = (\\sigma_1 + 2 \\sigma_3)/3$.\n\nLet the Mohr–Coulomb yield function along the triaxial compression meridian be posed in the invariant form $f(p,q) = q - M_c p - k_c$, where the friction dependence is $M_c = \\dfrac{6 \\sin \\phi}{3 - \\sin \\phi}$ and the cohesion-dependent intercept is $k_c = \\dfrac{6 c \\cos \\phi}{3 - \\sin \\phi}$. Consider non-associative plastic flow with plastic potential $g(p,q) = q - M_g p$, where $M_g = \\dfrac{6 \\sin \\psi}{3 - \\sin \\psi}$ uses the dilation angle $\\psi$. The return-mapping step updates a trial stress state to satisfy the yield condition and the consistency condition while obeying isotropic elasticity and the flow rule.\n\nStarting from the fundamental definitions above (isotropic linear elasticity, invariants $p$ and $q$, yield condition $f(p,q) \\le 0$, plastic potential $g(p,q)$, and $\\dot{\\boldsymbol{\\sigma}} = \\mathbb{D} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^p)$ with $\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda} \\, \\partial g/\\partial \\boldsymbol{\\sigma}$), derive from first principles a closed-form return-mapping update for an axisymmetric trial state on the triaxial compression meridian. Specifically, for a given trial principal stress state $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}})$ with $\\sigma_2^{\\text{tr}} = \\sigma_3^{\\text{tr}}$, material parameters $(\\phi, c, \\psi)$, and elastic moduli $(K, G)$, determine:\n- the plastic multiplier increment $\\Delta \\gamma$ obtained from the consistency condition,\n- the updated principal stresses $(\\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}})$ in the same principal basis.\n\nIf the trial state satisfies the yield condition strictly ($f(p^{\\text{tr}}, q^{\\text{tr}}) lt; 0$ within numerical tolerance), the update must leave the stress unchanged and use $\\Delta \\gamma = 0$.\n\nAngles $\\phi$ and $\\psi$ must be interpreted in degrees for input and converted to radians for trigonometric evaluations. All stresses and moduli must be treated in megapascal (MPa). The final answers for updated stresses must be expressed in MPa. The program must output each test case result as a list $[\\Delta \\gamma, \\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}}]$ of floats rounded to six decimal places.\n\nTest Suite:\n- Case $1$ (elastic interior): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 30$ MPa, $\\psi = 5$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (50, 45, 45)$ MPa.\n- Case $2$ (plastic return to smooth meridian): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 5$ MPa, $\\psi = 10$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (28, 1, 1)$ MPa.\n- Case $3$ (on the yield surface, boundary): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 5$ MPa, $\\psi = 10$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (33.928, 5.536, 5.536)$ MPa.\n- Case $4$ (plastic return, zero dilation): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 5$ MPa, $\\psi = 0$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (28, 1, 1)$ MPa.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[\\Delta \\gamma, \\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}}]$ for a test case, in the same order as the cases listed above. For example, the output should look like:\n$[[\\Delta \\gamma_1,\\sigma_{1,1}^{\\text{new}},\\sigma_{2,1}^{\\text{new}},\\sigma_{3,1}^{\\text{new}}],[\\Delta \\gamma_2,\\sigma_{1,2}^{\\text{new}},\\sigma_{2,2}^{\\text{new}},\\sigma_{3,2}^{\\text{new}}],\\ldots]$\nAll reported numbers must be rounded to six decimal places. Angles are in degrees, and all stresses and moduli are in MPa. The angle unit has been explicitly specified as degrees; do not use radians in inputs.", "solution": "The problem requires the derivation and implementation of a closed-form return-mapping algorithm for a small-strain, rate-independent elastoplastic material governed by the Mohr-Coulomb yield criterion with a non-associative flow rule. The analysis is specialized for an axisymmetric compression stress state.\n\nThe foundation of the algorithm lies in the operator split methodology common in computational plasticity, where a total strain increment is first assumed to produce a purely elastic stress response, yielding a \"trial\" stress state. If this trial state violates the yield condition, a plastic corrector step is applied to return the stress state to the updated yield surface. This process is discretized using a backward Euler integration scheme for its unconditional stability.\n\nThe fundamental relationship between stress rate $\\dot{\\boldsymbol{\\sigma}}$, elastic stiffness tensor $\\mathbb{D}$, total strain rate $\\dot{\\boldsymbol{\\varepsilon}}$, and plastic strain rate $\\dot{\\boldsymbol{\\varepsilon}}^p$ is given by:\n$$ \\dot{\\boldsymbol{\\sigma}} = \\mathbb{D} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^p) $$\nIntegrating over a time step $\\Delta t$, we obtain the incremental update. The trial stress state, $\\boldsymbol{\\sigma}^{\\text{tr}}$, is defined as the stress that would be reached if the entire strain increment $\\Delta\\boldsymbol{\\varepsilon}$ were purely elastic:\n$$ \\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}^{\\text{old}} + \\mathbb{D} : \\Delta\\boldsymbol{\\varepsilon} $$\nwhere $\\boldsymbol{\\sigma}^{\\text{old}}$ is the stress at the beginning of the step. The updated stress, $\\boldsymbol{\\sigma}^{\\text{new}}$, is then related to the trial stress by correcting for the plastic strain increment, $\\Delta\\boldsymbol{\\varepsilon}^p$:\n$$ \\boldsymbol{\\sigma}^{\\text{new}} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbb{D} : \\Delta\\boldsymbol{\\varepsilon}^p $$\nThe plastic strain increment is determined by the flow rule. For a backward Euler scheme, the flow rule is evaluated at the end-of-step state:\n$$ \\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\, \\left. \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\right|_{\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{new}}} $$\nwhere $\\Delta\\gamma$ is the non-negative plastic multiplier increment and $g$ is the plastic potential function. The final stress state $\\boldsymbol{\\sigma}^{\\text{new}}$ must satisfy the yield condition, known as the consistency condition: $f(\\boldsymbol{\\sigma}^{\\text{new}}) = 0$.\n\nFor isotropic elasticity and pressure-dependent plasticity models, it is advantageous to decompose the stress and strain tensors into volumetric and deviatoric components. The elastic constitutive relations are given by:\n$$ p = K \\varepsilon_v^e $$\n$$ \\mathbf{s} = 2G \\mathbf{e}^e $$\nwhere $p$ is the mean stress, $\\mathbf{s}$ is the deviatoric stress tensor, $\\varepsilon_v^e$ is the elastic volumetric strain, $\\mathbf{e}^e$ is the elastic deviatoric strain tensor, $K$ is the bulk modulus, and $G$ is the shear modulus. The stress update equations can be written in terms of invariants:\n$$ p^{\\text{new}} = p^{\\text{tr}} - K \\Delta\\varepsilon_v^p $$\n$$ \\mathbf{s}^{\\text{new}} = \\mathbf{s}^{\\text{tr}} - 2G \\Delta\\mathbf{e}^p $$\nThe plastic strain increments are derived from the plastic potential $g(p, q)$, where $q = \\sqrt{3J_2}$ is the deviatoric stress measure. The required derivatives are:\n$$ \\Delta\\varepsilon_v^p = \\Delta\\gamma \\frac{\\partial g}{\\partial p} $$\n$$ \\Delta\\mathbf{e}^p = \\Delta\\gamma \\frac{\\partial g}{\\partial \\mathbf{s}} = \\Delta\\gamma \\frac{\\partial g}{\\partial q} \\frac{\\partial q}{\\partial \\mathbf{s}} $$\nThe plastic potential is $g(p,q) = q - M_g p$. Its derivatives are:\n$$ \\frac{\\partial g}{\\partial p} = -M_g $$\n$$ \\frac{\\partial g}{\\partial q} = 1 $$\nSubstituting these into the invariant update equations:\n$$ p^{\\text{new}} = p^{\\text{tr}} - K (\\Delta\\gamma (-M_g)) = p^{\\text{tr}} + K M_g \\Delta\\gamma $$\nFor the deviatoric update, we note that $\\frac{\\partial q}{\\partial \\mathbf{s}} = \\frac{3}{2q}\\mathbf{s}$. Therefore, $\\Delta\\mathbf{e}^p = \\Delta\\gamma \\frac{3}{2q^{\\text{new}}}\\mathbf{s}^{\\text{new}}$. The update is:\n$$ \\mathbf{s}^{\\text{new}} = \\mathbf{s}^{\\text{tr}} - 2G \\left( \\Delta\\gamma \\frac{3}{2q^{\\text{new}}}\\mathbf{s}^{\\text{new}} \\right) \\implies \\mathbf{s}^{\\text{new}}\\left(1 + \\frac{3G\\Delta\\gamma}{q^{\\text{new}}}\\right) = \\mathbf{s}^{\\text{tr}} $$\nThis indicates that $\\mathbf{s}^{\\text{new}}$ is collinear with $\\mathbf{s}^{\\text{tr}}$, allowing us to write a scalar update for $q$:\n$$ q^{\\text{new}} = q^{\\text{tr}} - 3G\\Delta\\gamma $$\nWe now have two update equations for the invariants $(p^{\\text{new}}, q^{\\text{new}})$ and one unknown, $\\Delta\\gamma$. The final piece is the consistency condition, $f(p^{\\text{new}}, q^{\\text{new}}) = 0$. The Mohr-Coulomb yield function is $f(p,q) = q - M_c p - k_c$. Substituting the expressions for $p^{\\text{new}}$ and $q^{\\text{new}}$:\n$$ (q^{\\text{tr}} - 3G\\Delta\\gamma) - M_c (p^{\\text{tr}} + K M_g \\Delta\\gamma) - k_c = 0 $$\nRearranging the terms yields an explicit expression for the plastic multiplier $\\Delta\\gamma$:\n$$ q^{\\text{tr}} - M_c p^{\\text{tr}} - k_c = \\Delta\\gamma(3G + K M_c M_g) $$\nThe term on the left is the value of the yield function at the trial state, $f^{\\text{tr}} = f(p^{\\text{tr}}, q^{\\text{tr}})$. Thus, we solve for $\\Delta\\gamma$:\n$$ \\Delta\\gamma = \\frac{f^{\\text{tr}}}{3G + K M_c M_g} $$\nThis calculation is performed only if $f^{\\text{tr}}  0$. If $f^{\\text{tr}} \\le 0$, the step is elastic and $\\Delta\\gamma = 0$, resulting in $\\boldsymbol{\\sigma}^{\\text{new}} = \\boldsymbol{\\sigma}^{\\text{tr}}$.\n\nOnce $\\Delta\\gamma$ is determined for a plastic step, the updated invariants are calculated. Finally, the principal stresses are reconstructed from the updated invariants $(p^{\\text{new}}, q^{\\text{new}})$. For the specified axisymmetric compression state ($\\sigma_1 \\ge \\sigma_2 = \\sigma_3$), the relationships are:\n$$ p = \\frac{\\sigma_1 + 2\\sigma_3}{3}, \\quad q = \\sigma_1 - \\sigma_3 $$\nInverting this system gives the principal stresses as a function of the invariants:\n$$ \\sigma_1 = p + \\frac{2}{3}q $$\n$$ \\sigma_3 = p - \\frac{1}{3}q $$\n$$ \\sigma_2 = \\sigma_3 $$\nThe updated principal stresses $(\\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}})$ are thus found by substituting $(p^{\\text{new}}, q^{\\text{new}})$ into these reconstruction formulas.\n\nThe complete algorithm is as follows:\n1.  Given material parameters $(K, G, \\phi, c, \\psi)$ and a trial stress state $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}})$.\n2.  Calculate the Mohr-Coulomb parameters $M_c$ and $k_c$ and the non-associative flow parameter $M_g$. The input angles $\\phi$ and $\\psi$ in degrees must be converted to radians for trigonometric functions.\n3.  Compute the trial invariants $p^{\\text{tr}}$ and $q^{\\text{tr}}$.\n4.  Evaluate the yield function $f^{\\text{tr}} = q^{\\text{tr}} - M_c p^{\\text{tr}} - k_c$.\n5.  If $f^{\\text{tr}} \\le \\epsilon$ (where $\\epsilon$ is a small tolerance, e.g., $10^{-9}$), the step is elastic. Set $\\Delta\\gamma = 0$ and $\\boldsymbol{\\sigma}^{\\text{new}} = \\boldsymbol{\\sigma}^{\\text{tr}}$.\n6.  If $f^{\\text{tr}}  \\epsilon$, the step is plastic. Compute $\\Delta\\gamma = f^{\\text{tr}} / (3G + K M_c M_g)$.\n7.  Update the invariants: $p^{\\text{new}} = p^{\\text{tr}} + K M_g \\Delta\\gamma$ and $q^{\\text{new}} = q^{\\text{tr}} - 3G\\Delta\\gamma$.\n8.  Reconstruct the new principal stresses: $\\sigma_1^{\\text{new}} = p^{\\text{new}} + \\frac{2}{3}q^{\\text{new}}$ and $\\sigma_2^{\\text{new}} = \\sigma_3^{\\text{new}} = p^{\\text{new}} - \\frac{1}{3}q^{\\text{new}}$.\n9.  The final output for a case is the list $[\\Delta\\gamma, \\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}}]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_update(K, G, phi_deg, c, psi_deg, sigma_tr):\n    \"\"\"\n    Performs a return-mapping update for a Mohr-Coulomb material in axisymmetric compression.\n\n    Args:\n        K (float): Bulk modulus in MPa.\n        G (float): Shear modulus in MPa.\n        phi_deg (float): Friction angle in degrees.\n        c (float): Cohesion in MPa.\n        psi_deg (float): Dilation angle in degrees.\n        sigma_tr (tuple): Trial principal stresses (s1, s2, s3) in MPa.\n\n    Returns:\n        list: A list containing [delta_gamma, s1_new, s2_new, s3_new].\n    \"\"\"\n    # 1. Convert angles to radians\n    phi_rad = np.deg2rad(phi_deg)\n    psi_rad = np.deg2rad(psi_deg)\n\n    # 2. Calculate material constants\n    sin_phi = np.sin(phi_rad)\n    cos_phi = np.cos(phi_rad)\n    sin_psi = np.sin(psi_rad)\n\n    denominator_mc = 3.0 - sin_phi\n    Mc = (6.0 * sin_phi) / denominator_mc\n    kc = (6.0 * c * cos_phi) / denominator_mc\n\n    denominator_mg = 3.0 - sin_psi\n    Mg = (6.0 * sin_psi) / denominator_mg\n\n    # 3. Trial state from principal stresses\n    s1_tr, s2_tr, s3_tr = sigma_tr\n\n    # Calculate trial invariants\n    p_tr = (s1_tr + s2_tr + s3_tr) / 3.0\n    # For axisymmetric compression with s1 = s3, q = s1 - s3\n    q_tr = s1_tr - s3_tr\n\n    # 4. Evaluate yield function at trial state\n    f_tr = q_tr - Mc * p_tr - kc\n\n    # 5. Check for plasticity. Use a small tolerance for floating-point comparison.\n    if f_tr = 1e-9:\n        # Elastic step or on the yield surface\n        delta_gamma = 0.0\n        s1_new, s2_new, s3_new = s1_tr, s2_tr, s3_tr\n    else:\n        # Plastic step: perform return mapping\n        # Calculate plastic multiplier increment\n        denominator_dg = 3.0 * G + K * Mc * Mg\n        delta_gamma = f_tr / denominator_dg\n\n        # Update invariants\n        p_new = p_tr + K * Mg * delta_gamma\n        q_new = q_tr - 3.0 * G * delta_gamma\n\n        # Reconstruct updated principal stresses from new invariants\n        s1_new = p_new + (2.0 / 3.0) * q_new\n        s3_new = p_new - (1.0 / 3.0) * q_new\n        s2_new = s3_new\n\n    return [delta_gamma, s1_new, s2_new, s3_new]\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (K, G, phi, c, psi, (s1_tr, s2_tr, s3_tr))\n        (5000.0, 3000.0, 30.0, 30.0, 5.0, (50.0, 45.0, 45.0)),\n        (5000.0, 3000.0, 30.0, 5.0, 10.0, (28.0, 1.0, 1.0)),\n        (5000.0, 3000.0, 30.0, 5.0, 10.0, (33.928, 5.536, 5.536)),\n        (5000.0, 3000.0, 30.0, 5.0, 0.0, (28.0, 1.0, 1.0)),\n    ]\n\n    all_results_formatted = []\n    for case in test_cases:\n        K, G, phi, c, psi, sigma_tr = case\n        result = calculate_update(K, G, phi, c, psi, sigma_tr)\n        \n        # Format each number to 6 decimal places and create the list string\n        formatted_numbers = [f\"{num:.6f}\" for num in result]\n        all_results_formatted.append(f\"[{','.join(formatted_numbers)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```", "id": "3581296"}]}