{"hands_on_practices": [{"introduction": "A creep test, where a constant stress is applied and strain is measured over time, is a cornerstone of material characterization. This exercise [@problem_id:3613072] provides a foundational analytical experience by exploring this test on a poroviscoelastic material, where a simple viscoelastic skeleton (the Kelvin-Voigt model) is saturated with a pore fluid. By deriving the apparent modulus for both drained and undrained scenarios, you will gain a clear, quantitative understanding of how fluid-solid interaction fundamentally alters the time-dependent mechanical response.", "problem": "Consider an isothermal, homogeneous, isotropic, fully saturated poroviscoelastic solid subjected to unconfined axial compression at small strain. The solid skeleton obeys a Kelvin–Voigt rheology in uniaxial form with drained uniaxial modulus $E$ and dashpot viscosity $\\eta_{s}$, so that the uniaxial effective stress $\\sigma^{\\prime}$ and the axial strain $\\epsilon_{z}$ satisfy $\\sigma^{\\prime}(t) = E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\dot{\\epsilon}_{z}(t)$. Fluid–solid coupling follows the linear theory of Biot poroelasticity, with Biot coefficient $\\alpha$ and Biot modulus $M$. The total Cauchy stress in the axial direction is $\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha\\,p(t)$, where $p(t)$ is the pore pressure. Adopt the standard poroelastic fluid content relation $\\zeta(t) = \\alpha\\,\\epsilon_{v}(t) + p(t)/M$, where $\\epsilon_{v}$ is the volumetric strain. The sample’s lateral surfaces are traction-free, and the skeleton has Poisson’s ratio equal to zero so that $\\epsilon_{x}(t) = \\epsilon_{y}(t) = 0$ and $\\epsilon_{v}(t) = \\epsilon_{z}(t)$. Inertia is neglected.\n\nAt time $t=0^{+}$, apply and hold a uniform compressive axial stress step $\\sigma_{z}(t) = -\\sigma_{0}\\,H(t)$ with $\\sigma_{0} > 0$ and $H(t)$ the Heaviside step function. Define the measured time-dependent effective (apparent) axial modulus as $E_{\\mathrm{eff}}(t) = -\\sigma_{z}(t)/\\epsilon_{z}(t)$.\n\nCompute, in closed analytic form, the two functions:\n- the undrained apparent modulus $E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t)$ corresponding to the condition of no change in fluid content, $\\zeta(t) \\equiv 0$ for all $t \\ge 0$;\n- the drained apparent modulus $E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t)$ corresponding to vanishing pore pressure, $p(t) \\equiv 0$ for all $t \\ge 0$.\n\nExpress your final answer symbolically in terms of $E$, $\\eta_{s}$, $\\alpha$, $M$, and $t$. No numerical evaluation is required.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\nThe following relations and parameters are provided verbatim:\n- Solid skeleton rheology (uniaxial Kelvin-Voigt): $\\sigma^{\\prime}(t) = E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\dot{\\epsilon}_{z}(t)$\n- Drained uniaxial modulus: $E$\n- Skeleton dashpot viscosity: $\\eta_{s}$\n- Total axial Cauchy stress: $\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha\\,p(t)$\n- Biot coefficient: $\\alpha$\n- Pore pressure: $p(t)$\n- Biot modulus: $M$\n- Fluid content relation: $\\zeta(t) = \\alpha\\,\\epsilon_{v}(t) + p(t)/M$\n- Kinematic condition from zero Poisson's ratio: $\\epsilon_{v}(t) = \\epsilon_{z}(t)$\n- Applied stress: $\\sigma_{z}(t) = -\\sigma_{0}\\,H(t)$, where $\\sigma_{0} > 0$ and $H(t)$ is the Heaviside step function.\n- Apparent axial modulus definition: $E_{\\mathrm{eff}}(t) = -\\sigma_{z}(t)/\\epsilon_{z}(t)$\n- Condition for undrained response: $\\zeta(t) \\equiv 0$ for $t \\ge 0$\n- Condition for drained response: $p(t) \\equiv 0$ for $t \\ge 0$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the linear theory of poroviscoelasticity, a well-established field in continuum mechanics and geophysics. It combines the Kelvin-Voigt model for linear viscoelasticity and Biot's theory for linear poroelasticity. These are standard and widely used models. The setup describes a classical creep test.\n- **Well-Posed:** The problem is well-posed. The governing equations are linear ordinary differential equations with constant coefficients. For the specified step loading, a unique and stable solution for the strain $\\epsilon_{z}(t)$ exists. The two quantities to be computed are derived from this solution under two distinct and clearly defined physical limits (undrained and drained).\n- **Objective:** The problem statement is formulated using precise mathematical and physical terminology. All relationships are given as equations, and all terms are defined, leaving no room for subjective interpretation.\n- **Consistency and Completeness:** The problem is self-contained. The simplification arising from a zero Poisson's ratio ($\\epsilon_{v} = \\epsilon_{z}$) is explicitly stated and correctly applied, making the one-dimensional analysis consistent. All necessary parameters ($E$, $\\eta_s$, $\\alpha$, $M$) and relationships are provided to solve for the two requested apparent moduli.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Solution Derivation\n\nThe objective is to find the apparent axial modulus $E_{\\mathrm{eff}}(t) = -\\sigma_{z}(t)/\\epsilon_{z}(t)$ under both undrained and drained conditions. For $t > 0$, the applied stress is constant, $\\sigma_{z}(t) = -\\sigma_{0}$. Thus, the definition simplifies to $E_{\\mathrm{eff}}(t) = \\sigma_{0}/\\epsilon_{z}(t)$. The core of the problem is to find the axial strain response $\\epsilon_{z}(t)$ for each case.\n\n#### 1. Undrained Apparent Modulus, $E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t)$\nThe undrained condition is characterized by zero change in fluid content, $\\zeta(t) = 0$. Using the fluid content relation with the kinematic simplification $\\epsilon_{v}(t) = \\epsilon_{z}(t)$:\n$$0 = \\alpha\\,\\epsilon_{z}(t) + \\frac{p(t)}{M}$$\nFrom this, we express the pore pressure $p(t)$ as a function of the axial strain $\\epsilon_{z}(t)$:\n$$p(t) = -M\\,\\alpha\\,\\epsilon_{z}(t)$$\nNext, we substitute this into the total stress definition:\n$$\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha\\,(-M\\,\\alpha\\,\\epsilon_{z}(t)) = \\sigma^{\\prime}(t) + M\\,\\alpha^{2}\\,\\epsilon_{z}(t)$$\nNow, we replace the effective stress $\\sigma^{\\prime}(t)$ with the Kelvin-Voigt constitutive law:\n$$\\sigma_{z}(t) = \\left(E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt}\\right) + M\\,\\alpha^{2}\\,\\epsilon_{z}(t)$$\nGrouping terms, we obtain the governing ordinary differential equation (ODE) for the strain $\\epsilon_{z}(t)$ under undrained conditions:\n$$\\sigma_{z}(t) = (E + M\\,\\alpha^{2})\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt}$$\nLet's define the undrained uniaxial modulus as $E_{u} = E + M\\,\\alpha^{2}$. For $t > 0$, $\\sigma_{z}(t) = -\\sigma_{0}$, so the ODE becomes:\n$$\\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt} + E_{u}\\,\\epsilon_{z}(t) = -\\sigma_{0}$$\nThis is a creep test scenario. The initial condition, enforced by the viscous element (dashpot) which cannot deform instantaneously, is $\\epsilon_{z}(0) = 0$. The solution to this first-order linear ODE is:\n$$\\epsilon_{z}(t) = -\\frac{\\sigma_{0}}{E_{u}}\\left(1 - \\exp\\left(-\\frac{E_{u}}{\\eta_{s}}t\\right)\\right)$$\nSubstituting back the expression for $E_{u}$:\n$$\\epsilon_{z}(t) = -\\frac{\\sigma_{0}}{E + M\\,\\alpha^{2}}\\left(1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)\\right)$$\nFinally, we compute the undrained apparent modulus using its definition $E_{\\mathrm{eff}}(t) = \\sigma_{0}/\\epsilon_{z}(t)$. Since a modulus is a positive physical quantity, we use the magnitude of the stress and strain, or ensure the sign convention is consistent. The provided definition $E_{\\mathrm{eff}}(t) = -\\sigma_z/\\epsilon_z$ with a compressive (negative) stress $\\sigma_z$ and compressive (negative) strain $\\epsilon_z$ yields a positive modulus.\n$$E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t) = \\frac{-\\sigma_{z}(t)}{\\epsilon_{z}(t)} = \\frac{-(-\\sigma_{0})}{-\\frac{\\sigma_{0}}{E + M\\,\\alpha^{2}}\\left(1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)\\right)}$$\n$$E_{\\mathrm{eff}}^{\\mathrm{(undrained)}}(t) = \\frac{E + M\\,\\alpha^{2}}{1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)}$$\n\n#### 2. Drained Apparent Modulus, $E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t)$\nThe drained condition is characterized by zero pore pressure, $p(t) = 0$.\nThe total stress definition becomes:\n$$\\sigma_{z}(t) = \\sigma^{\\prime}(t) - \\alpha(0) = \\sigma^{\\prime}(t)$$\nSubstituting the Kelvin-Voigt law directly for the total stress:\n$$\\sigma_{z}(t) = E\\,\\epsilon_{z}(t) + \\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt}$$\nFor $t > 0$, we have $\\sigma_{z}(t) = -\\sigma_{0}$. The governing ODE for the strain $\\epsilon_{z}(t)$ under drained conditions is:\n$$\\eta_{s}\\,\\frac{d\\epsilon_{z}}{dt} + E\\,\\epsilon_{z}(t) = -\\sigma_{0}$$\nThis ODE is of the same form as the undrained case but with the drained modulus $E$ instead of $E_{u}$. The initial condition is again $\\epsilon_{z}(0)=0$. The solution is therefore:\n$$\\epsilon_{z}(t) = -\\frac{\\sigma_{0}}{E}\\left(1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)\\right)$$\nThe drained apparent modulus is then computed using the same definition:\n$$E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t) = \\frac{-\\sigma_{z}(t)}{\\epsilon_{z}(t)} = \\frac{-(-\\sigma_{0})}{-\\frac{\\sigma_{0}}{E}\\left(1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)\\right)}$$\n$$E_{\\mathrm{eff}}^{\\mathrm{(drained)}}(t) = \\frac{E}{1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)}$$\nThe two requested functions have been derived in closed analytic form.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{E + M\\,\\alpha^{2}}{1 - \\exp\\left(-\\frac{(E + M\\,\\alpha^{2})t}{\\eta_{s}}\\right)}  \\frac{E}{1 - \\exp\\left(-\\frac{Et}{\\eta_{s}}\\right)}\n\\end{pmatrix}\n}\n$$", "id": "3613072"}, {"introduction": "While analytical solutions provide deep insight, realistic geophysical problems require numerical simulation, which introduces its own artifacts such as numerical dispersion. This practice [@problem_id:3613014] tackles this challenge head-on by guiding you in designing a grid for a finite-difference simulation of slow P-waves in a poroviscoelastic medium. You will derive a crucial grid-resolution requirement that ensures the numerical phase velocity error remains bounded by the physical attenuation of the wave, a key principle for obtaining physically meaningful simulation results.", "problem": "Consider a two-dimensional, homogeneous, isotropic poroviscoelastic medium governed by conservation of linear momentum and mass for a fluid-saturated solid, with the solid skeleton exhibiting Standard Linear Solid (SLS) viscoelasticity. The slow compressional wave (slow P-wave) is modeled under a plane-wave ansatz with small attenuation, so that its complex wavenumber can be written as $k_{s}(\\omega) = k_{r}(\\omega)\\left(1 + i\\,\\delta(\\omega)\\right)$, where $\\delta(\\omega)$ is a given, small, frequency-dependent dimensionless attenuation parameter defined by $\\delta(\\omega) = \\operatorname{Im}\\{k_{s}(\\omega)\\}/\\operatorname{Re}\\{k_{s}(\\omega)\\}$ and $k_{r}(\\omega) > 0$. The physical slow P-wave phase velocity is $v_{s}(\\omega) = \\omega/k_{r}(\\omega)$.\n\nAssume the solid skeleton bulk response entering the slow-wave storage is described by a $J$-mechanism Standard Linear Solid with high-frequency modulus $M_{\\infty} > 0$, relaxation strengths $r_{j} \\in (0,1)$, and relaxation times $\\tau_{j} > 0$ for $j=1,\\dots,J$, so that the complex storage modulus is\n$$\nM_{s}(\\omega) = M_{\\infty}\\left(1 - \\sum_{j=1}^{J}\\frac{r_{j}}{1 + i\\,\\omega\\,\\tau_{j}}\\right),\n$$\nand the effective inertia of the slow wave is approximated by a constant $\\rho_{\\text{eff}} > 0$. Under small-loss conditions, the slow P-wave phase velocity may be approximated by\n$$\nv_{s}(\\omega) \\approx \\sqrt{\\frac{\\operatorname{Re}\\{M_{s}(\\omega)\\}}{\\rho_{\\text{eff}}}} = \\sqrt{\\frac{M_{\\infty}\\left(1 - \\sum_{j=1}^{J}\\frac{r_{j}}{1 + (\\omega\\,\\tau_{j})^{2}}\\right)}{\\rho_{\\text{eff}}}}.\n$$\n\nYou discretize the first-order velocity-stress poroviscoelastic system on a uniform staggered grid with spatial spacing $\\Delta x = \\Delta y$ using a centered, explicit spatial finite-difference operator of order $2m$ ($m \\in \\mathbb{N}$, $m \\geq 1$) for each Cartesian derivative. Let the leading-order truncation constant of the one-dimensional staggered derivative symbol be $\\beta_{m} > 0$, so that for a directional propagation angle $\\theta$ (measured from the $x$-axis), the magnitude of the discrete wavenumber satisfies the small-$k\\,\\Delta x$ expansion\n$$\n|\\hat{k}(\\theta)| \\approx k_{r}(\\omega)\\left[1 - \\beta_{m}\\big(k_{r}(\\omega)\\,\\Delta x\\big)^{2m}\\left(\\cos^{2m+2}\\theta + \\sin^{2m+2}\\theta\\right)\\right].\n$$\nConsequently, the numerical phase velocity error for the slow P-wave is, to leading order in $(k_{r}(\\omega)\\,\\Delta x)$,\n$$\n\\varepsilon(\\theta,\\omega) \\equiv \\frac{v_{\\text{num}}(\\theta,\\omega) - v_{s}(\\omega)}{v_{s}(\\omega)} \\approx \\beta_{m}\\big(k_{r}(\\omega)\\,\\Delta x\\big)^{2m}\\left(\\cos^{2m+2}\\theta + \\sin^{2m+2}\\theta\\right).\n$$\n\nDesign a conservative grid-resolution requirement by enforcing that the worst-case directional numerical phase velocity error over $\\theta \\in [0,\\pi/2]$ does not exceed the physical attenuation parameter, namely $\\max_{\\theta}\\varepsilon(\\theta,\\omega) \\leq \\delta(\\omega)$. Derive, in closed form, the maximum admissible grid spacing $\\Delta x_{\\max}(\\omega)$ in terms of $\\delta(\\omega)$, $\\omega$, $m$, $\\beta_{m}$, $\\rho_{\\text{eff}}$, $M_{\\infty}$, $\\{r_{j}\\}_{j=1}^{J}$, and $\\{\\tau_{j}\\}_{j=1}^{J}$, using the above approximations and assuming small $\\delta(\\omega)$.\n\nYour final answer must be a single analytical expression for $\\Delta x_{\\max}(\\omega)$, simplified as far as possible. No numerical evaluation is required. If you introduce any additional notation, define it precisely. Express the final answer in terms of the quantities specified in this statement. Units are not required in the final boxed expression, but the grid spacing is physically a length.", "solution": "The problem requires the derivation of a closed-form expression for the maximum admissible grid spacing, $\\Delta x_{\\max}(\\omega)$, for a numerical simulation of slow P-waves in a poroviscoelastic medium. The criterion for this grid resolution is that the worst-case numerical phase velocity error, $\\varepsilon(\\theta,\\omega)$, must not exceed the physical attenuation parameter, $\\delta(\\omega)$.\n\nThe given constraint is:\n$$\n\\max_{\\theta \\in [0,\\pi/2]} \\varepsilon(\\theta,\\omega) \\leq \\delta(\\omega)\n$$\nThe numerical phase velocity error is provided as:\n$$\n\\varepsilon(\\theta,\\omega) \\approx \\beta_{m}\\big(k_{r}(\\omega)\\,\\Delta x\\big)^{2m}\\left(\\cos^{2m+2}\\theta + \\sin^{2m+2}\\theta\\right)\n$$\nwhere $k_r(\\omega)$ is the real part of the physical wavenumber, $\\Delta x$ is the grid spacing, $\\beta_m > 0$ is a constant related to the finite-difference scheme of order $2m$ ($m \\ge 1$), and $\\theta$ is the propagation angle.\n\nSubstituting the expression for $\\varepsilon(\\theta,\\omega)$ into the constraint, we have:\n$$\n\\max_{\\theta \\in [0,\\pi/2]} \\left[ \\beta_{m}\\big(k_{r}(\\omega)\\,\\Delta x\\big)^{2m}\\left(\\cos^{2m+2}\\theta + \\sin^{2m+2}\\theta\\right) \\right] \\leq \\delta(\\omega)\n$$\nThe terms $\\beta_{m}$, $k_{r}(\\omega)$, and $\\Delta x$ are independent of the angle $\\theta$. Therefore, we can move them outside the maximization operator:\n$$\n\\beta_{m}\\big(k_{r}(\\omega)\\,\\Delta x\\big)^{2m} \\max_{\\theta \\in [0,\\pi/2]} \\left(\\cos^{2m+2}\\theta + \\sin^{2m+2}\\theta\\right) \\leq \\delta(\\omega)\n$$\nTo proceed, we must find the maximum value of the angular function $g(\\theta) = \\cos^{2m+2}\\theta + \\sin^{2m+2}\\theta$ over the interval $\\theta \\in [0, \\pi/2]$. We find the critical points by taking the derivative of $g(\\theta)$ with respect to $\\theta$ and setting it to zero.\n$$\n\\frac{dg}{d\\theta} = (2m+2)\\cos^{2m+1}\\theta(-\\sin\\theta) + (2m+2)\\sin^{2m+1}\\theta(\\cos\\theta)\n$$\n$$\n\\frac{dg}{d\\theta} = (2m+2)\\sin\\theta\\cos\\theta \\left( \\sin^{2m}\\theta - \\cos^{2m}\\theta \\right)\n$$\nSetting $\\frac{dg}{d\\theta} = 0$ for $\\theta \\in [0, \\pi/2]$, we find critical points where $\\sin\\theta = 0$ (i.e., $\\theta=0$), $\\cos\\theta=0$ (i.e., $\\theta=\\pi/2$), or $\\sin^{2m}\\theta = \\cos^{2m}\\theta$. The last condition implies $\\tan^{2m}\\theta = 1$, which gives $\\tan\\theta = 1$, so $\\theta = \\pi/4$.\n\nNow, we evaluate $g(\\theta)$ at these critical points:\n\\begin{itemize}\n    \\item At $\\theta=0$: $g(0) = \\cos^{2m+2}(0) + \\sin^{2m+2}(0) = 1^{2m+2} + 0 = 1$.\n    \\item At $\\theta=\\pi/2$: $g(\\pi/2) = \\cos^{2m+2}(\\pi/2) + \\sin^{2m+2}(\\pi/2) = 0 + 1^{2m+2} = 1$.\n    \\item At $\\theta=\\pi/4$: $g(\\pi/4) = \\cos^{2m+2}(\\pi/4) + \\sin^{2m+2}(\\pi/4) = \\left(\\frac{1}{\\sqrt{2}}\\right)^{2m+2} + \\left(\\frac{1}{\\sqrt{2}}\\right)^{2m+2} = 2 \\cdot \\left(\\frac{1}{2}\\right)^{m+1} = \\frac{2}{2^{m+1}} = \\frac{1}{2^m}$.\n\\end{itemize}\nSince $m \\geq 1$, we have $2^m \\geq 2$, which implies $\\frac{1}{2^m} \\leq \\frac{1}{2}$. Thus, the maximum value of $g(\\theta)$ on the interval $[0, \\pi/2]$ is $1$. The worst-case error occurs for waves propagating along the grid axes.\n\nSubstituting this maximum value back into the inequality, we get:\n$$\n\\beta_{m}\\big(k_{r}(\\omega)\\,\\Delta x\\big)^{2m} \\cdot 1 \\leq \\delta(\\omega)\n$$\nWe now solve for $\\Delta x$. Rearranging the terms gives:\n$$\n\\big(k_{r}(\\omega)\\,\\Delta x\\big)^{2m} \\leq \\frac{\\delta(\\omega)}{\\beta_{m}}\n$$\nTaking the $(2m)^{\\text{th}}$ root of both sides (all quantities are positive, so the inequality is preserved):\n$$\nk_{r}(\\omega)\\,\\Delta x \\leq \\left(\\frac{\\delta(\\omega)}{\\beta_{m}}\\right)^{\\frac{1}{2m}}\n$$\nIsolating $\\Delta x$:\n$$\n\\Delta x \\leq \\frac{1}{k_{r}(\\omega)} \\left(\\frac{\\delta(\\omega)}{\\beta_{m}}\\right)^{\\frac{1}{2m}}\n$$\nThe maximum admissible grid spacing, $\\Delta x_{\\max}(\\omega)$, is the upper bound of this inequality:\n$$\n\\Delta x_{\\max}(\\omega) = \\frac{1}{k_{r}(\\omega)} \\left(\\frac{\\delta(\\omega)}{\\beta_{m}}\\right)^{\\frac{1}{2m}}\n$$\nThe next step is to express $k_{r}(\\omega)$ in terms of the given physical parameters. We are given the relation for the physical phase velocity $v_{s}(\\omega) = \\omega/k_{r}(\\omega)$, which implies $1/k_{r}(\\omega) = v_{s}(\\omega)/\\omega$.\nWe are also given the small-loss approximation for the phase velocity:\n$$\nv_{s}(\\omega) \\approx \\sqrt{\\frac{\\operatorname{Re}\\{M_{s}(\\omega)\\}}{\\rho_{\\text{eff}}}}\n$$\nAnd the real part of the complex storage modulus:\n$$\n\\operatorname{Re}\\{M_{s}(\\omega)\\} = M_{\\infty}\\left(1 - \\sum_{j=1}^{J}\\frac{r_{j}}{1 + (\\omega\\tau_{j})^{2}}\\right)\n$$\nCombining these, we obtain an expression for $1/k_{r}(\\omega)$:\n$$\n\\frac{1}{k_{r}(\\omega)} \\approx \\frac{v_{s}(\\omega)}{\\omega} \\approx \\frac{1}{\\omega} \\sqrt{\\frac{\\operatorname{Re}\\{M_{s}(\\omega)\\}}{\\rho_{\\text{eff}}}} = \\frac{1}{\\omega} \\sqrt{\\frac{M_{\\infty}}{\\rho_{\\text{eff}}}\\left(1 - \\sum_{j=1}^{J}\\frac{r_{j}}{1 + (\\omega\\tau_{j})^{2}}\\right)}\n$$\nFinally, substituting this expression for $1/k_{r}(\\omega)$ into the equation for $\\Delta x_{\\max}(\\omega)$ yields the final result:\n$$\n\\Delta x_{\\max}(\\omega) = \\left(\\frac{\\delta(\\omega)}{\\beta_{m}}\\right)^{\\frac{1}{2m}} \\frac{1}{\\omega} \\sqrt{\\frac{M_{\\infty}}{\\rho_{\\text{eff}}}\\left(1 - \\sum_{j=1}^{J}\\frac{r_{j}}{1 + (\\omega\\tau_{j})^{2}}\\right)}\n$$\nThis expression provides the maximum allowed grid spacing as a function of frequency $\\omega$ and the physical and numerical parameters of the problem, consistent with the specified constraint.", "answer": "$$\n\\boxed{\\left(\\frac{\\delta(\\omega)}{\\beta_{m}}\\right)^{\\frac{1}{2m}} \\frac{1}{\\omega} \\sqrt{\\frac{M_{\\infty}}{\\rho_{\\text{eff}}}\\left(1 - \\sum_{j=1}^{J}\\frac{r_{j}}{1 + (\\omega\\tau_{j})^{2}}\\right)}}\n$$", "id": "3613014"}, {"introduction": "Moving from simulating physical processes (forward modeling) to inferring Earth properties from data (inverse modeling) requires efficient methods for calculating model sensitivities. This advanced exercise [@problem_id:3613028] guides you through the derivation of the adjoint-state equations for a poroviscoelastic system using the Lagrangian method, a cornerstone of modern full-waveform inversion. The practice culminates in the \"adjoint test,\" a fundamental verification step whose outcome is zero by definition, reinforcing the deep mathematical duality between the forward and adjoint systems.", "problem": "Consider one-dimensional, time-domain poroviscoelasticity under Biot-type assumptions on a bounded interval $x \\in [0,L]$ and a finite time window $t \\in [0,T]$. The solid displacement is $u(x,t)$, the fluid relative flux (Darcy flux) is $w(x,t)$, and the pore pressure is $p(x,t)$. The mass density of the saturated composite is $\\rho$, the fluid density is $\\rho_{f}$, the Lamé parameters of the solid skeleton are $\\lambda$ and $\\mu$, the solid viscosity (Kelvin–Voigt dashpot) is $\\eta_{s}$, the Biot coefficient is $\\alpha$, the Biot modulus is $M$, the fluid dynamic viscosity is $\\eta_{f}$, and the permeability is $k$. All coefficients are positive constants and spatially homogeneous. The external body-force source applied to the solid momentum equation is $s_{u}(x,t)$, and the initial conditions are $u(x,0)=0$, $w(x,0)=0$, and $p(x,0)=0$.\n\nThe governing equations are derived from linear momentum balance for the skeleton, Darcy’s law for the fluid flux, and fluid mass conservation, combined with a Kelvin–Voigt viscoelastic constitutive law for the skeleton with stress\n$$\n\\sigma(x,t) = \\big(\\lambda + 2\\mu\\big)\\,\\partial_{x} u(x,t) + 2\\eta_{s}\\,\\partial_{x} \\dot{u}(x,t) - \\alpha\\,p(x,t),\n$$\nand the constraints\n$$\n\\rho\\,\\ddot{u}(x,t) - \\partial_{x}\\sigma(x,t) = s_{u}(x,t),\n$$\n$$\nw(x,t) + \\frac{k}{\\eta_{f}}\\Big(\\partial_{x} p(x,t) + \\rho_{f}\\,\\ddot{u}(x,t)\\Big) = 0,\n$$\n$$\n\\dot{p}(x,t) - M\\Big(\\alpha\\,\\partial_{x}\\dot{u}(x,t) - \\partial_{x} w(x,t)\\Big) = 0.\n$$\nThe spatial boundary conditions are homogeneous Dirichlet for $u$ and $w$, $u(0,t)=u(L,t)=0$, $w(0,t)=w(L,t)=0$, along with homogeneous Neumann for $p$, $\\partial_{x}p(0,t)=\\partial_{x}p(L,t)=0$. Let a receiver at location $x_{r}\\in(0,L)$ measure the solid displacement $u(x_{r},t)$. Define the least-squares misfit functional\n$$\nJ[u] = \\frac{1}{2}\\int_{0}^{T}\\big(u(x_{r},t) - d_{\\mathrm{obs}}(t)\\big)^{2}\\,\\mathrm{d}t,\n$$\nwhere $d_{\\mathrm{obs}}(t)$ is the observed time series.\n\nTask 1: Using the conservation laws and constitutive relations stated above as the fundamental base, construct a Lagrangian by enforcing the three forward constraints with adjoint fields $\\lambda_{u}(x,t)$, $\\lambda_{w}(x,t)$, and $\\lambda_{p}(x,t)$. From first principles, derive the adjoint-state equations for $\\lambda_{u}$, $\\lambda_{w}$, and $\\lambda_{p}$, including terminal conditions at $t=T$ and spatial boundary conditions consistent with the forward ones. Your derivation must be fully self-contained, and you must not quote or assume any target adjoint formulas.\n\nTask 2: Define the linear forward operator $\\mathcal{F}$ that maps the source $s_{u}(x,t)$ to the receiver data $d(t)=u(x_{r},t)$ through the forward system. Let $\\mathcal{F}^{*}$ be the operator mapping a test time series $y(t)$ to the corresponding adjoint equivalent source $\\tilde{s}_{u}(x,t)$ entering the adjoint system derived in Task 1. Using the inner products\n$$\n\\langle a,b\\rangle_{t} = \\int_{0}^{T} a(t)\\,b(t)\\,\\mathrm{d}t,\\qquad\n\\langle f,g\\rangle_{x,t} = \\int_{0}^{T}\\int_{0}^{L} f(x,t)\\,g(x,t)\\,\\mathrm{d}x\\,\\mathrm{d}t,\n$$\nand choosing specific smooth test functions\n$$\ns_{u}(x,t) = \\sin\\!\\Big(\\frac{\\pi x}{L}\\Big)\\,\\sin(\\omega t),\\qquad y(t) = \\exp\\!\\Big(-\\frac{t}{T}\\Big),\n$$\ndefine the normalized adjoint test scalar\n$$\nS = \\frac{\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t} - \\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}}{\\max\\Big(\\big|\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t}\\big|,\\,\\big|\\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}\\big|\\Big)}.\n$$\nCompute $S$ and provide its value. The final answer must be a single real number. No rounding is required because $S$ is dimensionless and, under exact arithmetic, attains its analytical value.", "solution": "The problem is divided into two tasks. The first is to derive the adjoint-state equations for a given one-dimensional poroviscoelastic system. The second is to compute a normalized quantity, $S$, which represents an adjoint test.\n\nThe foundation of the derivation is the method of Lagrange multipliers, applied to the system of partial differential equations (PDEs) that constitute the forward model. We construct a Lagrangian functional, $\\mathcal{L}$, by augmenting the quantity of interest with the governing equations, enforced by adjoint fields. The adjoint equations are then derived by finding the stationary point of the Lagrangian with respect to the forward-state variables.\n\nFirst, let us write the governing equations as a set of constraints, $C_i = 0$:\nThe stress in the Kelvin-Voigt solid skeleton is given by\n$$ \\sigma(x,t) = \\big(\\lambda + 2\\mu\\big)\\,\\partial_{x} u(x,t) + 2\\eta_{s}\\,\\partial_{x} \\dot{u}(x,t) - \\alpha\\,p(x,t) $$\nThe three constraint equations are:\n$$ C_u \\equiv \\rho\\,\\ddot{u} - \\partial_{x}\\sigma - s_{u} = 0 $$\n$$ C_w \\equiv w + \\frac{k}{\\eta_{f}}\\Big(\\partial_{x} p + \\rho_{f}\\,\\ddot{u}\\Big) = 0 $$\n$$ C_p \\equiv \\dot{p} - M\\Big(\\alpha\\,\\partial_{x}\\dot{u} - \\partial_{x} w\\Big) = 0 $$\nwhere time derivatives are denoted by a dot, e.g., $\\dot{u} = \\partial_t u$, and spatial derivatives by $\\partial_x$.\n\nTask 1: Derivation of the Adjoint-State System\n\nFor the derivation of the adjoint equations, the misfit functional $J[u]$ is the starting point. The source of the adjoint system is derived from the Fréchet derivative of $J$ with respect to the state variables. The general form of the Lagrangian, $\\mathcal{L}$, is constructed by adding $J[u]$ to the inner products of the adjoint fields with the corresponding constraint equations. Let the adjoint fields (Lagrange multipliers) be $\\lambda_u(x,t)$, $\\lambda_w(x,t)$, and $\\lambda_p(x,t)$.\n$$ \\mathcal{L}[u, w, p, \\lambda_u, \\lambda_w, \\lambda_p] = J[u] + \\int_0^T\\int_0^L \\Big( \\lambda_u C_u + \\lambda_w C_w + \\lambda_p C_p \\Big) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe adjoint equations are found by requiring the Fréchet derivative of $\\mathcal{L}$ with respect to the state variables $u$, $w$, and $p$ to be zero. This is equivalent to finding the variation $\\delta\\mathcal{L}$ with respect to perturbations $\\delta u$, $\\delta w$, and $\\delta p$, and setting the terms multiplying these perturbations to zero.\n\nThe variation $\\delta\\mathcal{L}$ is:\n$$ \\delta\\mathcal{L} = \\delta J[u] + \\int_0^T\\int_0^L \\Big( \\lambda_u \\delta C_u + \\lambda_w \\delta C_w + \\lambda_p \\delta C_p \\Big) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe variation of the misfit functional is:\n$$ \\delta J[u] = \\int_0^T \\big(u(x_r, t) - d_{\\mathrm{obs}}(t)\\big) \\delta u(x_r, t) \\,\\mathrm{d}t = \\int_0^T\\int_0^L \\delta(x-x_r)\\big(u(x, t) - d_{\\mathrm{obs}}(t)\\big) \\delta u(x, t) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe variations of the constraints are:\n$$ \\delta C_u = \\rho\\,\\delta\\ddot{u} - \\partial_{x}\\left( (\\lambda+2\\mu)\\partial_x\\delta u + 2\\eta_s\\partial_x\\delta\\dot{u} - \\alpha\\delta p \\right) $$\n$$ \\delta C_w = \\delta w + \\frac{k}{\\eta_f}\\left(\\partial_x\\delta p + \\rho_f\\delta\\ddot{u}\\right) $$\n$$ \\delta C_p = \\delta\\dot{p} - M(\\alpha\\partial_x\\delta\\dot{u} - \\partial_x\\delta w) $$\nWe collect all terms in $\\delta\\mathcal{L}$ and integrate by parts to transfer all temporal and spatial derivatives from the perturbations ($\\delta u, \\delta w, \\delta p$) to the adjoint fields ($\\lambda_u, \\lambda_w, \\lambda_p$).\n\nLet's group terms by the perturbation field:\nTerms with $\\delta u$:\n$$ \\int_0^T\\int_0^L \\left[ \\delta(x-x_r)(u - d_{\\mathrm{obs}}) \\delta u + \\lambda_u \\Big(\\rho\\,\\delta\\ddot{u} - \\partial_x\\big((\\lambda+2\\mu)\\partial_x\\delta u + 2\\eta_s\\partial_x\\delta\\dot{u}\\big)\\Big) + \\lambda_w\\frac{k\\rho_f}{\\eta_f}\\delta\\ddot{u} - \\lambda_p M\\alpha\\partial_x\\delta\\dot{u} \\right] \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nTerms with $\\delta w$:\n$$ \\int_0^T\\int_0^L \\left[ \\lambda_w \\delta w + \\lambda_p M\\partial_x\\delta w \\right] \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nTerms with $\\delta p$:\n$$ \\int_0^T\\int_0^L \\left[ \\lambda_u \\partial_x(\\alpha\\delta p) + \\lambda_w \\frac{k}{\\eta_f}\\partial_x\\delta p + \\lambda_p\\delta\\dot{p} \\right] \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nAfter performing integration by parts and collecting terms multiplying $\\delta u$, $\\delta w$, and $\\delta p$ in the volume integral, we obtain the adjoint equations by setting these kernels to zero.\n\nThe adjoint equation from the $\\delta w$ terms:\n$$ \\int_0^T\\int_0^L \\big( \\lambda_w - M\\partial_x\\lambda_p \\big) \\delta w \\,\\mathrm{d}x\\,\\mathrm{d}t + \\int_0^T \\big[M\\lambda_p \\delta w\\big]_0^L \\,\\mathrm{d}t = 0 $$\nThe forward boundary condition $w(0,t)=w(L,t)=0$ implies $\\delta w(0,t)=\\delta w(L,t)=0$, so the boundary term vanishes. The resulting adjoint equation is an algebraic relation:\n$$ \\lambda_w(x,t) - M\\partial_x\\lambda_p(x,t) = 0 $$\n\nThe adjoint equation from the $\\delta p$ terms:\n$$ \\int_0^T\\int_0^L \\big( -\\dot{\\lambda}_p - \\alpha\\partial_x\\lambda_u - \\frac{k}{\\eta_f}\\partial_x\\lambda_w \\big) \\delta p \\,\\mathrm{d}x\\,\\mathrm{d}t + \\text{B.T.} = 0 $$\nThe boundary terms are $\\int_0^L[\\lambda_p\\delta p]_0^T\\,\\mathrm{d}x$ and $\\int_0^T[\\alpha\\lambda_u\\delta p + \\frac{k}{\\eta_f}\\lambda_w\\delta p]_0^L\\,\\mathrm{d}t$. The forward initial condition $p(x,0)=0$ implies $\\delta p(x,0)=0$. We enforce a terminal condition $\\lambda_p(x,T)=0$ to nullify the time boundary term. For the spatial boundary term, the forward condition $\\partial_xp(0,t)=\\partial_xp(L,t)=0$ does not constrain $\\delta p$ at the boundary. Thus, we must impose a boundary condition on the adjoint variables: $\\alpha\\lambda_u + \\frac{k}{\\eta_f}\\lambda_w = 0$ at $x=0,L$. The adjoint equation for $\\lambda_p$ is:\n$$ \\dot{\\lambda}_p + \\alpha\\partial_x\\lambda_u + \\frac{k}{\\eta_f}\\partial_x\\lambda_w = 0 $$\n\nThe adjoint equation from the $\\delta u$ terms:\nThe process of integration by parts for the $\\delta u$ terms is more involved. It yields the following kernel, after accounting for all contributions:\n$$ \\rho\\ddot{\\lambda}_u + \\frac{k\\rho_f}{\\eta_f}\\ddot{\\lambda}_w - (\\lambda+2\\mu)\\partial_{xx}\\lambda_u + 2\\eta_s\\partial_{xx}\\dot{\\lambda}_u - M\\alpha\\partial_x\\dot{\\lambda}_p = -\\delta(x-x_r)(u-d_{\\mathrm{obs}}) $$\nNote the sign change on the viscous term's time derivative, characteristic of adjoints of dissipative systems. The operator $\\partial_t$ becomes $-\\partial_t$ on the adjoint variable.\nThe time boundary terms require $\\lambda_u(x,T)=0$ and $\\dot{\\lambda}_u(x,T)=0$. The spatial boundary terms associated with $\\delta u$ and its derivatives are handled by imposing $\\lambda_u(0,t)=\\lambda_u(L,t)=0$, which is the natural adjoint boundary condition corresponding to the Dirichlet condition on $u$.\n\nSummary of the Adjoint System:\nWe substitute $\\lambda_w = M\\partial_x\\lambda_p$ into the other equations.\nAdjoint Equations (running backward in time from $t=T$ to $t=0$):\n1. $\\lambda_w(x,t) = M\\partial_x\\lambda_p(x,t)$\n2. $\\dot{\\lambda}_p + \\alpha\\partial_x\\lambda_u + \\frac{k M}{\\eta_f}\\partial_{xx}\\lambda_p = 0$\n3. $\\rho\\ddot{\\lambda}_u + \\frac{k\\rho_f M}{\\eta_f}\\partial_x\\ddot{\\lambda}_p - (\\lambda+2\\mu)\\partial_{xx}\\lambda_u + 2\\eta_s\\partial_{xx}\\dot{\\lambda}_u - M\\alpha\\partial_x\\dot{\\lambda}_p = -\\delta(x-x_r)(u(x,t)-d_{\\mathrm{obs}}(t))$\n\nTerminal Conditions at $t=T$:\n$\\lambda_u(x,T)=0$, $\\dot{\\lambda}_u(x,T)=0$, $\\lambda_p(x,T)=0$.\nThese imply $\\lambda_w(x,T)=0$ and its time derivatives are also determined.\n\nSpatial Boundary Conditions at $x=0,L$:\n1. $\\lambda_u(0,t)=0, \\lambda_u(L,t)=0$ (Dirichlet)\n2. From $\\lambda_w = M\\partial_x\\lambda_p$ and the required $\\alpha\\lambda_u + \\frac{k}{\\eta_f}\\lambda_w=0$ at $x=0,L$, the condition becomes $\\frac{k}{\\eta_f}M\\partial_x\\lambda_p=0$, since $\\lambda_u=0$ at the boundary. As $k, M, \\eta_f$ are positive, this leads to $\\partial_x\\lambda_p(0,t)=0, \\partial_x\\lambda_p(L,t)=0$ (Neumann).\nThis completes Task 1.\n\nTask 2: Computation of the Adjoint Test Scalar $S$\n\nThe adjoint test is a validation that the derived adjoint operator is indeed the mathematical adjoint of the forward operator. The linear forward operator $\\mathcal{F}$ maps the source $s_u(x,t)$ to the observation $d(t) = u(x_r,t)$. The adjoint operator $\\mathcal{F}^*$ is defined by the property:\n$$ \\langle \\mathcal{F}(s_u), y \\rangle_t = \\langle s_u, \\mathcal{F}^*(y) \\rangle_{x,t} $$\nfor any functions $s_u(x,t)$ and $y(t)$ in the appropriate spaces. The inner products are defined in the problem statement. The left side is an inner product in time, and the right side is an inner product in spacetime.\n\nThe entire derivation of the adjoint-state equations in Task 1 is precisely the construction of an operator $\\mathcal{F}^*$ that satisfies this identity. Let's demonstrate this.\nLet $X = (u,w,p)^T$ and $\\Lambda = (\\lambda_u, \\lambda_w, \\lambda_p)^T$. The forward system is $L X = S_u$ where $S_u = (s_u,0,0)^T$. The adjoint system is $L^* \\Lambda = F_y$ where $F_y = (\\delta(x-x_r)y(t), 0, 0)^T$. Note that the adjoint source is defined by the second argument of the data-space inner product, $y(t)$.\nThe defining property of the adjoint operator $L^*$ is that for any $X, \\Lambda$ satisfying the respective homogeneous boundary conditions, the following identity holds:\n$$ \\langle LX, \\Lambda \\rangle_{x,t} = \\langle X, L^*\\Lambda \\rangle_{x,t} $$\nThis is Green's identity. The boundary and initial/terminal conditions derived in Task 1 are specifically chosen to ensure that all boundary terms from the integration by parts vanish, making this identity exact.\nLet's apply this identity to our specific case.\n$$ \\langle S_u, \\Lambda \\rangle_{x,t} = \\langle X, F_y \\rangle_{x,t} $$\nExpanding the inner products:\n$$ \\int_0^T\\int_0^L s_u(x,t) \\lambda_u(x,t) \\,\\mathrm{d}x\\,\\mathrm{d}t = \\int_0^T\\int_0^L u(x,t) \\delta(x-x_r) y(t) \\,\\mathrm{d}x\\,\\mathrm{d}t $$\nThe left side is $\\langle s_u, \\lambda_u \\rangle_{x,t}$. The right side is $\\int_0^T u(x_r,t) y(t) \\,\\mathrm{d}t = \\langle \\mathcal{F}(s_u), y \\rangle_t$.\nFrom the definition of the adjoint state method, the output of the adjoint operator, $\\mathcal{F}^*(y)$, is the solution field $\\lambda_u(x,t)$ obtained by solving the adjoint system with source $F_y$ constructed from $y$. Therefore, $\\mathcal{F}^*(y) = \\lambda_u(x,t)$.\nSubstituting this into our equation, we get:\n$$ \\langle s_u, \\mathcal{F}^*(y) \\rangle_{x,t} = \\langle \\mathcal{F}(s_u), y \\rangle_t $$\nThis demonstrates that the two terms in the numerator of the expression for $S$ are equal by construction. The phrasing of the problem, particularly the definition of $\\tilde{s}_u(x,t)$, is potentially ambiguous, but the fundamental duality relationship of the adjoint-state method is unequivocal.\n\nThe scalar $S$ is defined as:\n$$ S = \\frac{\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t} - \\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}}{\\max\\Big(\\big|\\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t}\\big|,\\,\\big|\\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t}\\big|\\Big)} $$\nSince we have established that $\\langle \\mathcal{F}(s_u), y \\rangle_t = \\langle s_u, \\mathcal{F}^*(y) \\rangle_{x,t}$, the numerator is identically zero.\n$$ \\big\\langle \\mathcal{F}\\big(s_{u}\\big),\\,y\\big\\rangle_{t} - \\big\\langle s_{u},\\,\\mathcal{F}^{*}\\big(y\\big)\\big\\rangle_{x,t} = 0 $$\nThe denominator involves the maximum of the absolute values of these two equal terms. For the given non-trivial test functions $s_{u}(x,t) = \\sin(\\pi x/L)\\sin(\\omega t)$ and $y(t) = \\exp(-t/T)$, the physical system will produce a non-zero response $u(x_r,t)$, and the adjoint system will produce a non-zero field $\\lambda_u(x,t)$. Thus, the inner products will be non-zero in general. The denominator is therefore non-zero.\nConsequently, the value of $S$ is:\n$$ S = \\frac{0}{\\text{non-zero value}} = 0 $$\nThe computation of $S$ is therefore a conceptual exercise based on the successful derivation of the adjoint system in Task 1, confirming the understanding of the adjoint-state method's core principle.", "answer": "$$\\boxed{0}$$", "id": "3613028"}]}