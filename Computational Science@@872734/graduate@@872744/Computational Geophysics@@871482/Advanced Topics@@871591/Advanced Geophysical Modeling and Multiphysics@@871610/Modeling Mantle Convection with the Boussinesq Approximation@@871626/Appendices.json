{"hands_on_practices": [{"introduction": "Before building complex numerical models, it is crucial to understand the fundamental physics governing the onset of convection. Linear stability analysis provides a powerful tool to determine the critical conditions at which a static, conductive fluid layer becomes unstable and begins to overturn. This practice provides a hands-on derivation of the critical Rayleigh number ($Ra_c$) and wavenumber ($k_c$) for an idealized case, building physical intuition about the balance between buoyant driving forces and viscous and thermal dissipation that lies at the heart of mantle convection [@problem_id:3610794].", "problem": "Consider a horizontally infinite layer of incompressible, Newtonian mantle fluid of thickness $H$, heated from below and cooled from above, modeled under the Boussinesq approximation. Gravity $\\boldsymbol{g}= -g\\,\\hat{\\boldsymbol{z}}$ acts downward. Let the density be $\\rho$, kinematic viscosity $\\nu$, thermal diffusivity $\\kappa$, thermal expansivity $\\alpha$, and the imposed temperature difference across the layer be $\\Delta T0$. Non-dimensionalize using the thermal diffusion time $H^{2}/\\kappa$ for time, the layer thickness $H$ for length, and the imposed temperature difference $\\Delta T$ for temperature, so that the non-dimensional vertical coordinate is $z\\in[0,1]$ and the Rayleigh number is $Ra = \\dfrac{\\alpha g \\Delta T H^{3}}{\\nu \\kappa}$.\n\nAssume the infinite Prandtl number limit appropriate for mantle convection, so that inertia is negligible in the linearized momentum equation. Let the basic conductive state be $T_{0}(z)=1-z$ and $\\boldsymbol{u}_{0}=\\boldsymbol{0}$. Consider infinitesimal perturbations $(\\boldsymbol{u},p,\\theta)$ about this base state, with $\\theta$ the temperature perturbation. Impose isothermal boundary conditions on the temperature perturbation, and free-slip boundary conditions on the velocity, at both plates:\n- $z=0$ and $z=1$: $\\,\\theta=0$, $\\,w=0$, $\\,\\partial^{2} w/\\partial z^{2}=0$, where $w$ is the vertical velocity.\n\nStarting from the non-dimensional linearized Boussinesq equations about the conductive state,\n- incompressibility: $\\nabla\\cdot\\boldsymbol{u}=0$;\n- Stokes momentum balance: $\\boldsymbol{0}=-\\nabla p+\\nabla^{2}\\boldsymbol{u}+Ra\\,\\theta\\,\\hat{\\boldsymbol{z}}$;\n- heat: $\\dfrac{\\partial \\theta}{\\partial t}=\\nabla^{2}\\theta+w$,\nperform a normal-mode linear stability analysis by seeking solutions proportional to $\\exp\\!\\big(i k x+\\sigma t\\big)$ with horizontal wavenumber $k0$, growth rate $\\sigma$, and vertical structure functions of $z$. Derive the ordinary differential eigenvalue problem for the vertical velocity amplitude $W(z)$ and temperature amplitude $\\Theta(z)$ under the stated boundary conditions, determine the neutrally stable dispersion relation $Ra=Ra(k)$ for the fundamental vertical mode, and minimize $Ra(k)$ over $k0$ to obtain the critical Rayleigh number $Ra_{c}$ and the corresponding critical wavenumber $k_{c}$ for the onset of stationary convection for free-slip, isothermal plates.\n\nThen, explain qualitatively (in words, not in formulas) how and why these critical values differ from the rigid, no-slip, isothermal case at both plates.\n\nProvide as your final answer the exact, closed-form expressions for the nondimensional pair $\\big(Ra_{c},\\,k_{c}\\big)$ for the free-slip, isothermal case, written as a single row using the LaTeX $\\pmatrix$ convention, with no numerical rounding.", "solution": "The problem asks for a linear stability analysis of Rayleigh-Bénard convection in a horizontally infinite fluid layer of thickness $H$ with free-slip, isothermal boundary conditions. We are to find the critical Rayleigh number $Ra_c$ and critical wavenumber $k_c$ for the onset of stationary convection.\n\nFirst, we begin with the provided non-dimensional linearized Boussinesq equations for the perturbations of velocity $\\boldsymbol{u}=(u,v,w)$, pressure $p$, and temperature $\\theta$ about the quiescent, conductive base state. The problem is set in a coordinate system where $\\hat{\\boldsymbol{z}}$ points upward, so the vertical coordinate $z$ spans from $0$ to $1$. The equations are:\n1. Incompressibility: $\\nabla\\cdot\\boldsymbol{u}=0$\n2. Stokes momentum balance (infinite Prandtl number): $\\boldsymbol{0}=-\\nabla p+\\nabla^{2}\\boldsymbol{u}+Ra\\,\\theta\\,\\hat{\\boldsymbol{z}}$\n3. Heat transport: $\\dfrac{\\partial \\theta}{\\partial t}=\\nabla^{2}\\theta+w$\n\nHere, $Ra = \\frac{\\alpha g \\Delta T H^3}{\\nu \\kappa}$ is the Rayleigh number.\n\nWe perform a normal-mode analysis, seeking solutions that are periodic in the horizontal direction and grow or decay exponentially in time. We can, without loss of generality due to Squire's theorem, consider two-dimensional rolls oriented along the $y$-axis, so all variables are independent of $y$ and the velocity component $v=0$. The perturbations are written as:\n$$w(x,z,t) = W(z) \\exp(i k x + \\sigma t)$$\n$$u(x,z,t) = U(z) \\exp(i k x + \\sigma t)$$\n$$\\theta(x,z,t) = \\Theta(z) \\exp(i k x + \\sigma t)$$\n$$p(x,z,t) = P(z) \\exp(i k x + \\sigma t)$$\nwhere $k0$ is the horizontal wavenumber and $\\sigma$ is the complex growth rate. Substituting these forms into the governing equations transforms the partial differential equations into ordinary differential equations (ODEs) for the amplitude functions $W(z)$, $U(z)$, $\\Theta(z)$, and $P(z)$. Let $D \\equiv \\frac{d}{dz}$.\n\nThe incompressibility equation $\\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0$ becomes:\n$$ikU + DW = 0 \\quad \\implies \\quad U = \\frac{i}{k} DW$$\n\nThe momentum equations become:\nx-component: $0 = -ikP + (D^2 - k^2)U$\nz-component: $0 = -DP + (D^2 - k^2)W + Ra\\,\\Theta$\n\nThe heat transport equation becomes:\n$$\\sigma \\Theta = (D^2 - k^2)\\Theta + W$$\n\nOur next step is to eliminate $U$ and $P$ to obtain a system for $W$ and $\\Theta$.\nSubstitute $U = \\frac{i}{k}DW$ into the x-momentum equation:\n$$0 = -ikP + (D^2 - k^2)\\left(\\frac{i}{k}DW\\right) \\implies P = \\frac{1}{k^2}(D^2 - k^2)DW$$\nNow, substitute this expression for $P$ into the z-momentum equation by first differentiating it with respect to $z$:\n$$DP = \\frac{1}{k^2}(D^2 - k^2)D^2W$$\nThe z-momentum equation is then:\n$$0 = -\\frac{1}{k^2}(D^2 - k^2)D^2W + (D^2 - k^2)W + Ra\\,\\Theta$$\nMultiplying by $k^2$ and rearranging gives:\n$$k^2Ra\\,\\Theta = (D^2 - k^2)D^2W - k^2(D^2 - k^2)W = (D^2 - k^2)(D^2W - k^2W)$$\nThis simplifies to a single fourth-order ODE coupling $W$ and $\\Theta$:\n$$(D^2 - k^2)^2 W = k^2 Ra\\,\\Theta \\quad (*)$$\n\nWe are looking for the onset of stationary convection, which corresponds to the marginal stability case where the growth rate is purely real and equals zero ($\\sigma=0$). This is justified by the principle of exchange of stabilities, which holds for this problem. Setting $\\sigma=0$ in the heat transport equation gives the second ODE:\n$$(D^2 - k^2)\\Theta = -W \\quad (**)$$\n\nWe now have a coupled system of ODEs for $W(z)$ and $\\Theta(z)$. The boundary conditions at the top and bottom plates ($z=0$ and $z=1$) are given as isothermal ($\\theta=0$), impermeable ($w=0$), and free-slip. The free-slip condition ($\\frac{\\partial u}{\\partial z}=0$ at the boundaries), combined with incompressibility, leads to $\\frac{\\partial^2 w}{\\partial z^2}=0$. Thus, the boundary conditions on the amplitude functions are:\n$$W(0) = W(1) = 0$$\n$$\\Theta(0) = \\Theta(1) = 0$$\n$$D^2W(0) = D^2W(1) = 0$$\n\nThese particular boundary conditions are all satisfied by sinusoidal functions. Let's try a solution of the form $W(z) = A \\sin(n\\pi z)$ for an integer $n \\ge 1$.\n- $W(0) = A \\sin(0) = 0$ and $W(1) = A \\sin(n\\pi) = 0$.\n- $D^2W = -A(n\\pi)^2 \\sin(n\\pi z)$, so $D^2W(0)=0$ and $D^2W(1)=0$.\nThis form is a valid eigenfunction for the system.\n\nNow we substitute $W(z) = A \\sin(n\\pi z)$ into equations $(*)$ and $(**)$ to find the eigenvalue $Ra$.\nFrom $(**)$, we find $\\Theta(z)$:\n$$(D^2 - k^2)\\Theta = -A \\sin(n\\pi z)$$\nSince $D^2[\\sin(n\\pi z)] = -(n\\pi)^2 \\sin(n\\pi z)$, we can assume $\\Theta(z) = B \\sin(n\\pi z)$. Substituting this gives:\n$$(-(n\\pi)^2 - k^2)B \\sin(n\\pi z) = -A \\sin(n\\pi z)$$\n$$B = \\frac{A}{(n\\pi)^2 + k^2}$$\nSo, $\\Theta(z) = \\frac{A}{(n\\pi)^2 + k^2}\\sin(n\\pi z)$. This form also satisfies the boundary condition $\\Theta(0)=\\Theta(1)=0$.\n\nNow, substitute both $W(z)$ and $\\Theta(z)$ into equation $(*)$:\n$$(D^2 - k^2)^2 (A \\sin(n\\pi z)) = k^2 Ra \\left( \\frac{A}{(n\\pi)^2 + k^2}\\sin(n\\pi z) \\right)$$\nLet's evaluate the left-hand side operator:\n$$(D^2 - k^2)(A \\sin(n\\pi z)) = (-(n\\pi)^2 - k^2)A \\sin(n\\pi z)$$\n$$(D^2 - k^2)^2(A \\sin(n\\pi z)) = (-(n\\pi)^2 - k^2)^2 A \\sin(n\\pi z) = ((n\\pi)^2 + k^2)^2 A \\sin(n\\pi z)$$\nSubstituting this back into the main equation:\n$$((n\\pi)^2 + k^2)^2 A \\sin(n\\pi z) = k^2 Ra \\frac{A}{(n\\pi)^2 + k^2} \\sin(n\\pi z)$$\nFor a non-trivial solution ($A \\neq 0$), we can cancel $A\\sin(n\\pi z)$ to obtain the dispersion relation for $Ra$ as a function of $k$ and $n$:\n$$Ra(k,n) = \\frac{((n\\pi)^2 + k^2)^3}{k^2}$$\nThe onset of convection corresponds to the minimum possible Rayleigh number. We must minimize $Ra$ with respect to the mode number $n$ and the wavenumber $k$. For any fixed $k0$, the function $Ra(k,n)$ is minimized by choosing the smallest possible integer value for $n$, which is $n=1$ (the fundamental mode).\n$$Ra(k) = \\frac{(\\pi^2 + k^2)^3}{k^2}$$\nTo find the critical wavenumber $k_c$ that minimizes $Ra(k)$, we compute the derivative with respect to $k$ and set it to zero. It is easier to use $x=k^2$ as the variable:\n$$Ra(x) = \\frac{(\\pi^2 + x)^3}{x}$$\n$$\\frac{dRa}{dx} = \\frac{3(\\pi^2+x)^2 \\cdot x - (\\pi^2+x)^3 \\cdot 1}{x^2} = 0$$\nFor a minimum, the numerator must be zero. Since $x=k^20$, $\\pi^2+x \\neq 0$, so we can divide by $(\\pi^2+x)^2$:\n$$3x - (\\pi^2+x) = 0$$\n$$2x - \\pi^2 = 0 \\implies x = \\frac{\\pi^2}{2}$$\nThus, the critical wavenumber squared is $k_c^2 = \\frac{\\pi^2}{2}$, which gives the critical wavenumber:\n$$k_c = \\sqrt{\\frac{\\pi^2}{2}} = \\frac{\\pi}{\\sqrt{2}}$$\nFinally, we substitute this value back into the expression for $Ra(k)$ to find the critical Rayleigh number $Ra_c$:\n$$Ra_c = \\frac{(\\pi^2 + k_c^2)^3}{k_c^2} = \\frac{(\\pi^2 + \\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}}$$\n$$Ra_c = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^6}{8} \\cdot \\frac{2}{\\pi^2} = \\frac{27\\pi^4}{4}$$\nSo, for free-slip, isothermal boundaries, the critical values for the onset of stationary convection are $k_c = \\frac{\\pi}{\\sqrt{2}}$ and $Ra_c = \\frac{27\\pi^4}{4}$. Numerically, these are $k_c \\approx 2.221$ and $Ra_c \\approx 657.51$.\n\nQualitative comparison with the rigid, no-slip, isothermal case:\n\nFor rigid (no-slip) boundaries, the boundary conditions for the vertical velocity amplitude become $W=0$ and $DW=0$ at $z=0$ and $z=1$. These more restrictive conditions lead to critical values of $Ra_c \\approx 1707.76$ and $k_c \\approx 3.117$.\n\nThe critical Rayleigh number ($Ra_c$) is significantly higher for rigid boundaries compared to free-slip boundaries ($1708$ vs. $657.5$). The Rayleigh number represents the ratio of buoyant driving forces to dissipative forces (viscous and thermal). Rigid, no-slip boundaries introduce strong viscous drag near the top and bottom of the fluid layer, dissipating kinetic energy far more effectively than free-slip boundaries, where the fluid can move horizontally without shear stress. This enhanced viscous dissipation stabilizes the conductive state, meaning a much stronger buoyancy force (and thus a higher $Ra$) is required to overcome the resistance and initiate convective motion.\n\nThe critical wavenumber ($k_c$) is larger for rigid boundaries compared to free-slip boundaries ($3.12$ vs. $2.22$). The wavenumber is inversely related to the horizontal wavelength of the convection cells at their onset ($\\lambda_c = 2\\pi/k_c$). A larger $k_c$ implies narrower convection cells. The no-slip condition strongly constrains the fluid flow in the vertical direction near the boundaries. The fluid must slow down and come to a stop. To accommodate this strong vertical shear, the flow organizes into narrower cells. In contrast, with free-slip boundaries, the lack of viscous resistance at the top and bottom allows the fluid to complete its overturning circulation over a wider horizontal distance with less effort, resulting in broader convection cells and a smaller critical wavenumber.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{27\\pi^4}{4}  \\frac{\\pi}{\\sqrt{2}}\n\\end{pmatrix}\n}\n$$", "id": "3610794"}, {"introduction": "To solve the governing equations of mantle flow numerically, we must first translate them into a form that a computer can handle. The Finite Element Method (FEM) achieves this by recasting the partial differential equations into a \"weak\" or variational form, which is then discretized. This exercise guides you through the essential first step of deriving this weak formulation for the Stokes equations and then asks you to identify which discrete velocity-pressure element pairs are mathematically stable, a critical consideration for developing a robust and accurate convection code [@problem_id:3610779].", "problem": "Consider a two-dimensional mantle convection model under the Boussinesq approximation, posed on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^2$ with boundary $\\Gamma$. The fluid is incompressible and Newtonian with a temperature-dependent viscosity $\\eta(T)$ and density variations retained only in the buoyancy force. The governing equations are the steady Stokes momentum balance and incompressibility:\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho_0 \\alpha \\left( T - T_{\\mathrm{ref}} \\right) \\mathbf{g} = \\mathbf{0}, \\quad \\nabla \\cdot \\mathbf{u} = 0 \\quad \\text{in } \\Omega,\n$$\nwhere $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u})$ is the Cauchy stress, $p$ is the dynamic pressure, $\\mathbf{u}$ is the velocity, $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2} \\left( \\nabla \\mathbf{u} + \\left( \\nabla \\mathbf{u} \\right)^{\\top} \\right)$ is the symmetric gradient, $\\rho_0$ is a constant reference density, $\\alpha$ is the thermal expansivity, $T$ is the temperature field, $T_{\\mathrm{ref}}$ is a reference temperature, and $\\mathbf{g}$ is the gravitational acceleration vector. Assume free-slip, impermeable boundaries, i.e., $\\mathbf{u} \\cdot \\mathbf{n} = 0$ and $\\mathbf{t} \\cdot \\left( \\boldsymbol{\\sigma} \\mathbf{n} \\right) = 0$ on $\\Gamma$, where $\\mathbf{n}$ and $\\mathbf{t}$ denote unit normal and tangential directions on $\\Gamma$.\n\nStarting from these governing laws and boundary conditions, derive the weak (variational) formulation appropriate for a Galerkin-type Finite Element Method (FEM). Clearly specify the velocity and pressure trial and test spaces, including any constraints needed for pressure uniqueness, and identify the bilinear and linear forms that arise.\n\nThen, focusing on the discrete mixed formulation, select all finite element velocity–pressure space pairs that satisfy the Ladyzhenskaya–Babuška–Brezzi (LBB) inf–sup condition for pressure stability without any additional stabilization terms, on shape-regular meshes under their standard assumptions:\n\nA. Taylor–Hood $P_2$–$P_1$ (continuous quadratic velocity, continuous linear pressure on triangles)\n\nB. Equal-order continuous $P_1$–$P_1$ (linear velocity, linear pressure on triangles)\n\nC. MINI element: $P_1$ enriched with one interior bubble per triangle for velocity, with $P_1$ continuous pressure\n\nD. Quadrilateral $Q_2$–$Q_1$ (biquadratic velocity, bilinear pressure on quadrilaterals)\n\nE. Equal-order continuous $P_2$–$P_2$ (quadratic velocity, quadratic pressure on triangles)\n\nF. Scott–Vogelius $P_k$–$P_{k-1}$ (continuous piecewise polynomials of degree $k$ for velocity and degree $k-1$ for pressure) on barycentrically refined triangular meshes with $k \\ge 3$ in $2$-D\n\nG. Crouzeix–Raviart nonconforming $P_1$ velocity with piecewise constant $P_0$ pressure on triangles", "solution": "### Derivation of the Weak Formulation\n\nThe goal is to find a solution pair $(\\mathbf{u}, p)$ for velocity and pressure that satisfies the governing equations and boundary conditions. The weak formulation is derived by multiplying the governing equations by suitable test functions and integrating over the domain $\\Omega$.\n\nLet the trial space for velocity be $V$ and for pressure be $Q$. Similarly, the test space for velocity is $V$ and for pressure is $Q$. The velocity trial and test functions, $\\mathbf{u}$ and $\\mathbf{v}$, must belong to a space that is sufficiently regular for the integrals to be well-defined and that incorporates the essential (Dirichlet-type) boundary conditions. The pressure trial and test functions, $p$ and $q$, must belong to a space appropriate for the problem.\n\nThe impermeable boundary condition, $\\mathbf{u} \\cdot \\mathbf{n} = 0$, is an essential condition that must be built into the velocity function space. The free-slip condition, $\\mathbf{t} \\cdot (\\boldsymbol{\\sigma} \\mathbf{n}) = 0$, is a natural condition that will arise from the weak formulation.\n\nThe appropriate function spaces are Sobolev spaces. The velocity space $V$ is defined as:\n$$\nV = \\{ \\mathbf{v} \\in [H^1(\\Omega)]^2 \\mid \\mathbf{v} \\cdot \\mathbf{n} = 0 \\text{ on } \\Gamma \\}\n$$\nAnd the pressure space $Q$ is defined as:\n$$\nQ = L^2_0(\\Omega) = \\left\\{ q \\in L^2(\\Omega) \\mid \\int_{\\Omega} q \\, d\\Omega = 0 \\right\\}\n$$\nThe condition $\\int_{\\Omega} q \\, d\\Omega = 0$ is imposed to ensure the uniqueness of the pressure solution, which is otherwise only determined up to an arbitrary additive constant.\n\n**1. Weak Form of the Momentum Equation**\n\nWe start with the momentum balance equation:\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0} \\quad \\text{in } \\Omega\n$$\nwhere $\\mathbf{f} = \\rho_0 \\alpha (T - T_{\\mathrm{ref}}) \\mathbf{g}$ represents the buoyancy force. We multiply this equation by an arbitrary test function $\\mathbf{v} \\in V$ and integrate over the domain $\\Omega$:\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{v} \\, d\\Omega + \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = 0\n$$\nApplying integration by parts (Green's first identity for vectors) to the first term gives:\n$$\n-\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{v} \\, d\\Omega + \\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma + \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = 0\n$$\nThe boundary integral $\\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma$ must be evaluated. Any vector on the boundary can be decomposed into its normal and tangential components. Since $\\mathbf{v} \\in V$, it satisfies $\\mathbf{v} \\cdot \\mathbf{n} = 0$ on $\\Gamma$. This means $\\mathbf{v}$ is purely tangential on the boundary. Let $\\mathbf{t}$ be the unit tangent vector on $\\Gamma$. Then $\\mathbf{v} = (\\mathbf{v} \\cdot \\mathbf{t}) \\mathbf{t}$. The integrand becomes:\n$$\n(\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} = (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot ((\\mathbf{v} \\cdot \\mathbf{t}) \\mathbf{t}) = (\\mathbf{v} \\cdot \\mathbf{t}) (\\boldsymbol{\\sigma}\\mathbf{n} \\cdot \\mathbf{t})\n$$\nThe free-slip boundary condition is precisely that the tangential traction is zero: $\\mathbf{t} \\cdot (\\boldsymbol{\\sigma}\\mathbf{n}) = 0$. Therefore, the entire boundary integral vanishes:\n$$\n\\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma = 0\n$$\nThe momentum equation weak form simplifies to:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\nNow, we substitute the definition of the Cauchy stress tensor, $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u})$:\n$$\n\\int_{\\Omega} \\left( -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\right) : \\nabla \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\nThe term involving pressure is $-p\\mathbf{I} : \\nabla\\mathbf{v} = -p \\sum_{i} \\frac{\\partial v_i}{\\partial x_i} = -p (\\nabla \\cdot \\mathbf{v})$.\nThe viscous term is $2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{v}$. Since $\\boldsymbol{\\varepsilon}(\\mathbf{u})$ is a symmetric tensor, its inner product with the skew-symmetric part of $\\nabla \\mathbf{v}$ is zero. Thus, $\\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{v} = \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v})$.\nThis yields the final weak form of the momentum equation:\n$$\n\\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\n\n**2. Weak Form of the Incompressibility Equation**\n\nThe incompressibility constraint is $\\nabla \\cdot \\mathbf{u} = 0$. We multiply by a pressure test function $q \\in Q$ and integrate over $\\Omega$:\n$$\n\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega = 0\n$$\n\n**3. The Complete Variational Problem**\n\nThe complete problem is to find $(\\mathbf{u}, p) \\in V \\times Q$ such that for all test functions $(\\mathbf{v}, q) \\in V \\times Q$:\n$$\n\\begin{cases}\n\\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega \\\\\n\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega = 0\n\\end{cases}\n$$\nWe can identify the bilinear and linear forms:\n*   Viscous bilinear form: $a(\\mathbf{u}, \\mathbf{v}) = \\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega$\n*   Pressure-velocity coupling bilinear form: $b(\\mathbf{v}, p) = - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega$\n*   Load linear form: $L(\\mathbf{v}) = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\rho_0 \\alpha (T - T_{\\mathrm{ref}}) \\mathbf{g} \\cdot \\mathbf{v} \\, d\\Omega$\n\nThe variational problem is: Find $(\\mathbf{u}, p) \\in V \\times Q$ such that:\n$$\n\\begin{cases}\na(\\mathbf{u}, \\mathbf{v}) + b(\\mathbf{v}, p) = L(\\mathbf{v}) \\quad \\forall \\mathbf{v} \\in V \\\\\nb(\\mathbf{u}, q) = 0 \\quad \\forall q \\in Q\n\\end{cases}\n$$\nNote that the standard definition of $b(\\cdot, \\cdot)$ implies $b(\\mathbf{u}, q) = -\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega$, so $b(\\mathbf{u}, q) = 0$ is equivalent to the weak form of the incompressibility constraint.\n\n### Evaluation of Finite Element Pairs\n\nThe stability of a discrete mixed formulation for the Stokes equations is governed by the Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition. A velocity-pressure pair $(V_h, Q_h)$ is LBB-stable if there exists a constant $\\beta  0$, independent of the mesh size $h$, such that:\n$$\n\\inf_{q_h \\in Q_h \\setminus \\{0\\}} \\sup_{\\mathbf{v}_h \\in V_h \\setminus \\{\\mathbf{0}\\}} \\frac{-\\int_{\\Omega} q_h (\\nabla \\cdot \\mathbf{v}_h) \\, d\\Omega}{\\|\\mathbf{v}_h\\|_{V} \\|q_h\\|_{Q}} \\ge \\beta\n$$\nPairs that satisfy this condition can be used without additional stabilization terms. We now evaluate the given options.\n\nA. **Taylor–Hood $P_2$–$P_1$ (continuous quadratic velocity, continuous linear pressure on triangles)**: This is the archetypal LBB-stable element pair. The velocity space is richer than the pressure space, satisfying the LBB condition.\n**Verdict: Correct**\n\nB. **Equal-order continuous $P_1$–$P_1$ (linear velocity, linear pressure on triangles)**: This is a classic example of an LBB-unstable element. The pressure space is too large relative to the velocity space, leading to spurious pressure oscillations. Stabilization techniques are required for this pair to work.\n**Verdict: Incorrect**\n\nC. **MINI element: $P_1$ enriched with one interior bubble per triangle for velocity, with $P_1$ continuous pressure**: This element, also known as $P_1b$-$P_1$, enriches the linear velocity space with a cubic \"bubble\" function that vanishes on the element boundary. This enrichment is sufficient to stabilize the linear pressure. It satisfies the LBB condition.\n**Verdict: Correct**\n\nD. **Quadrilateral $Q_2$–$Q_1$ (biquadratic velocity, bilinear pressure on quadrilaterals)**: This is the quadrilateral analogue of the Taylor–Hood element. It is a well-known LBB-stable pair for quadrilateral meshes.\n**Verdict: Correct**\n\nE. **Equal-order continuous $P_2$–$P_2$ (quadratic velocity, quadratic pressure on triangles)**: Similar to the $P_1$–$P_1$ element, this equal-order continuous pair is LBB-unstable and produces spurious pressure modes without stabilization.\n**Verdict: Incorrect**\n\nF. **Scott–Vogelius $P_k$–$P_{k-1}$ (continuous piecewise polynomials of degree $k$ for velocity and degree $k-1$ for pressure) on barycentrically refined triangular meshes with $k \\ge 3$ in $2$-D**: The Scott–Vogelius pair typically refers to continuous velocity ($P_k$) and *discontinuous* pressure ($P_{k-1}$). While the parenthetical description mentions continuous pressure, the specific conditions on the mesh and polynomial degree strongly point to the case of discontinuous pressure, for which stability is non-trivial. For general meshes, this pair is not LBB-stable. However, under specific mesh conditions, such as the specified barycentric refinement, it has been proven to be stable for $k \\ge 3$ in $2$ dimensions.\n**Verdict: Correct**\n\nG. **Crouzeix–Raviart nonconforming $P_1$ velocity with piecewise constant $P_0$ pressure on triangles**: This element uses linear polynomials for velocity that are continuous only at edge midpoints (making it nonconforming as it is not in $H^1(\\Omega)$), paired with piecewise constant pressures. This pair satisfies a modified LBB condition suitable for nonconforming methods and is a well-known stable choice for the Stokes problem.\n**Verdict: Correct**", "answer": "$$\\boxed{ACDFG}$$", "id": "3610779"}, {"introduction": "After discretizing the Stokes equations into a system of linear algebraic equations, a subtle feature of the physics creates a significant numerical hurdle. Because pressure only appears as a gradient in the momentum equation, its absolute value is undetermined in a closed domain, leading to a singular matrix system with no unique solution. This exercise explores this \"pressure nullspace\" problem and compares standard techniques for removing the singularity, a practical necessity for obtaining a valid solution from any incompressible flow solver [@problem_id:3610784].", "problem": "Consider incompressible Stokes flow for mantle convection under the Boussinesq approximation, where temperature-dependent buoyancy drives motion but density variations are neglected except in the buoyancy term. Let the domain be a closed, connected region $\\Omega \\subset \\mathbb{R}^d$ with impermeable boundaries (no normal flow), and assume appropriate velocity boundary conditions so that mass is conserved. The governing equations in nondimensional form are the momentum balance and incompressibility,\n$$\n- \\nabla \\cdot \\left( 2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u}) \\right) + \\nabla p = \\mathrm{Ra}\\, T(\\mathbf{x})\\, \\hat{\\mathbf{z}}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\nwhere $\\mathbf{u}(\\mathbf{x})$ is velocity, $p(\\mathbf{x})$ is pressure, $\\eta(\\mathbf{x})$ is viscosity, $\\mathbf{D}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top})$ is the rate-of-strain tensor, $\\mathrm{Ra}$ is the Rayleigh number, $T(\\mathbf{x})$ is temperature, and $\\hat{\\mathbf{z}}$ is the unit vector in the buoyancy direction. A stable mixed finite element discretization (e.g., Taylor–Hood) leads to a linear algebraic saddle-point system\n$$\n\\begin{bmatrix}\n\\mathbf{A}  \\mathbf{B}^{\\top} \\\\\n\\mathbf{B}  \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u} \\\\\n\\mathbf{p}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{bmatrix},\n$$\nwhere $\\mathbf{A}$ represents the viscous bilinear form, $\\mathbf{B}$ represents the discrete divergence, $\\mathbf{u}$ is the coefficient vector of velocity basis functions, $\\mathbf{p}$ is the coefficient vector of pressure basis functions, and $\\mathbf{f}$ represents the buoyancy forcing and boundary terms. In a closed, connected domain, this system possesses a pressure nullspace because only $\\nabla p$ appears in the momentum equation. Two common strategies to remove this nullspace and render the system uniquely solvable are: (i) fixing the mean pressure by imposing the global constraint $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$, and (ii) pinning the pressure at a single node by setting $p(\\mathbf{x}_\\star) = 0$ for a chosen mesh node $\\mathbf{x}_\\star$ and eliminating the corresponding degree of freedom from $\\mathbf{p}$. \n\nWhich of the following statements best describes how these strategies remove the pressure nullspace and their effect on the conditioning and structure of the resulting linear system?\n\nA. Because the momentum equation depends on $\\nabla p$, adding any constant to $p$ leaves the equations unchanged, so the discrete pressure vector has a $1$-dimensional nullspace spanned by the constant vector. Imposing the zero-mean constraint $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ removes this nullspace without altering $\\mathbf{u}$, preserves the symmetric indefinite saddle-point structure, and typically yields slightly better conditioning than pinning a single node because the constraint is global and orthogonal to the constant mode.\n\nB. Pinning the pressure at a single node converts the saddle-point matrix into a symmetric positive definite system and improves conditioning compared to fixing the mean pressure, because eliminating a degree of freedom always increases minimal singular values.\n\nC. Adding a pressure penalty $\\alpha \\int_{\\Omega} p^2 \\,\\mathrm{d}\\Omega$ with large $\\alpha$ to the weak form is equivalent to fixing the mean pressure and maintains optimal conditioning while preserving the original physics.\n\nD. Fixing the mean pressure $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ alters the velocity solution $\\mathbf{u}$ by introducing effective compressibility that changes the discrete divergence constraint, so it is unsuitable for closed domains.\n\nSelect the correct option(s).", "solution": "### Derivation and Option Analysis\n\nThe core of the problem lies in the fact that the pressure $p$ in the continuous momentum equation, $- \\nabla \\cdot \\left( 2 \\eta \\mathbf{D}(\\mathbf{u}) \\right) + \\nabla p = \\mathbf{f}_{\\text{body}}$, is only defined up to an arbitrary additive constant. If $p(\\mathbf{x})$ is a solution, then $p(\\mathbf{x}) + c$ for any constant $c \\in \\mathbb{R}$ is also a solution, because $\\nabla(p+c) = \\nabla p$. The velocity field $\\mathbf{u}$, however, is uniquely determined by $\\nabla p$.\n\nIn the discrete setting, this translates to a nullspace in the saddle-point matrix. The matrix $\\mathbf{B}^\\top$ is the discrete analogue of the gradient operator. For a constant pressure field, represented by a vector $\\mathbf{p}_c$ (e.g., a vector of all ones for a standard nodal basis), the discrete gradient is zero: $\\mathbf{B}^{\\top}\\mathbf{p}_c = \\mathbf{0}$. Consequently, the full saddle-point matrix $\\mathbf{K} = \\begin{bmatrix} \\mathbf{A}  \\mathbf{B}^{\\top} \\\\ \\mathbf{B}  \\mathbf{0} \\end{bmatrix}$ is singular, as it possesses a null vector $\\begin{bmatrix} \\mathbf{0} \\\\ \\mathbf{p}_c \\end{bmatrix}$:\n$$\n\\begin{bmatrix}\n\\mathbf{A}  \\mathbf{B}^{\\top} \\\\\n\\mathbf{B}  \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n\\mathbf{p}_c\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}^{\\top} \\mathbf{p}_c \\\\\n\\mathbf{0}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n\\mathbf{0}\n\\end{bmatrix}\n$$\nThe system is therefore not uniquely solvable for the pressure vector $\\mathbf{p}$. To make it so, we must impose an additional constraint on $\\mathbf{p}$ to remove this constant mode.\n\n**Analysis of Option A:**\nThis option states that the pressure nullspace is $1$-dimensional, spanned by the constant vector. This is correct, as explained above.\nIt claims that imposing $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ removes this nullspace. This is also correct. This constraint is equivalent to requiring the pressure solution to be orthogonal to the constant function, thereby eliminating the nullspace component from the solution space.\nIt claims that this does not alter the velocity solution $\\mathbf{u}$. This is correct. The velocity solution $\\mathbf{u}$ depends on the pressure gradient, which is unaffected by adding a constant to the pressure. Selecting a specific constant (the one that makes the mean zero) only selects one pressure solution from an infinite family of valid solutions, all of which correspond to the same unique velocity field.\nIt claims the method preserves the symmetric indefinite saddle-point structure. This is correct. The constraint can be implemented in ways (e.g., via projection or a Lagrange multiplier) that maintain the overall structure of the system, making it suitable for specialized solvers. The original matrix is symmetric, and the modified (but solvable) system can be kept symmetric. It is indefinite due to the $\\mathbf{0}$ block on the diagonal.\nFinally, it claims this method typically yields better conditioning than pinning. This is a well-established principle in numerical analysis. The global integral constraint is \"gentler\" and more mathematically elegant than the \"brute-force\" local constraint of pinning a node. It is orthogonal to the singular mode, which is the ideal way to remove it, and generally leads to better-conditioned systems.\nAll parts of this statement are accurate.\n**Verdict: Correct.**\n\n**Analysis of Option B:**\nThis option claims that pinning the pressure converts the system to a symmetric positive definite (SPD) one. This is incorrect. Pinning the pressure involves removing one row and column from the pressure part of the system. The resulting matrix still has the structure $\\begin{bmatrix} \\mathbf{A}  \\tilde{\\mathbf{B}}^{\\top} \\\\ \\tilde{\\mathbf{B}}  \\mathbf{0} \\end{bmatrix}$. The zero block on the diagonal remains, which makes the matrix indefinite, not positive definite. An SPD matrix must have all positive eigenvalues, whereas this saddle-point matrix has both positive and negative eigenvalues.\nIt also claims that pinning improves conditioning compared to fixing the mean. As discussed for Option A, this is generally false. Pinning is a local constraint that can artificially stress the solution and typically leads to worse conditioning than a global constraint.\nThe reasoning \"because eliminating a degree of freedom always increases minimal singular values\" is a flawed and overly general assertion. While removing a null mode does make the minimal *non-zero* singular value the new minimal singular value, it does not guarantee that this specific method of removal (pinning) is optimal or that it improves conditioning relative to other methods.\n**Verdict: Incorrect.**\n\n**Analysis of Option C:**\nThis option proposes adding a penalty term $\\alpha \\int_{\\Omega} p^2 \\,\\mathrm{d}\\Omega$. In the weak formulation, this would add a term $\\alpha \\int_{\\Omega} p q \\, \\mathrm{d}\\Omega$ to the pressure equation, where $q$ is the pressure test function. This modifies the discrete incompressibility constraint from $\\mathbf{B}\\mathbf{u} = \\mathbf{0}$ to $\\mathbf{B}\\mathbf{u} + \\alpha \\mathbf{M}_p \\mathbf{p} = \\mathbf{0}$, where $\\mathbf{M}_p$ is the pressure mass matrix. This is equivalent to changing the continuous incompressibility equation to $\\nabla \\cdot \\mathbf{u} + \\alpha p = 0$.\nThe claim that this is \"equivalent to fixing the mean pressure\" is false. It is a regularization technique that fundamentally alters the physics by introducing a form of artificial compressibility. The original problem is for an incompressible fluid ($\\nabla \\cdot \\mathbf{u} = 0$), while this modified problem is for a slightly compressible one.\nThe claim that it \"maintains optimal conditioning\" is false. Penalty methods are known to degrade conditioning as the penalty parameter (here, $\\alpha$) becomes large, with the condition number of the system matrix typically scaling with $\\alpha$.\nThe claim that it \"preserv[es] the original physics\" is false, as it changes the incompressibility constraint.\n**Verdict: Incorrect.**\n\n**Analysis of Option D:**\nThis option claims that fixing the mean pressure \"alters the velocity solution $\\mathbf{u}$\". This is false. As explained in the analysis of Option A, the velocity solution is unique and is not dependent on the arbitrary constant in the pressure field. Fixing this constant does not change $\\mathbf{u}$.\nIt claims the method \"introduc[es] effective compressibility that changes the discrete divergence constraint\". This is also false. Fixing the mean pressure is a constraint on the pressure space $Q$ alone. It does not alter the divergence constraint $\\mathbf{B}\\mathbf{u} = \\mathbf{0}$, which involves the velocity space. It is penalty methods (like the one in Option C) that can introduce effective compressibility.\nThe conclusion that it is \"unsuitable for closed domains\" is therefore based on false premises. In fact, it is one of the most suitable, standard, and theoretically-backed methods for closed domains.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "3610784"}]}