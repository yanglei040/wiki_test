{"hands_on_practices": [{"introduction": "Before modeling the complex, time-dependent dynamics of earthquakes, it is essential to understand the system's baseline response. This exercise [@problem_id:3587297] focuses on deriving the steady-state friction, which describes how a fault's resistance to slip behaves when sliding at a constant velocity over long periods. By working through this derivation for both the \"aging\" and \"slip\" state evolution laws, you will prove a fundamental result in rate-and-state friction theory: while their transient behaviors differ, both models converge to the same steady-state friction law, providing a unified framework for long-term fault behavior.", "problem": "Consider a single-degree-of-freedom spring-slider fault patch subject to constant normal stress, governed by Rate-and-State Friction (RSF). The RSF friction coefficient is defined as\n$$\\mu = \\mu_{0} + a \\ln\\!\\left(\\frac{V}{V_{0}}\\right) + b \\ln\\!\\left(\\frac{\\theta V_{0}}{D_{c}}\\right),$$\nwhere $V$ is the slip rate, $\\theta$ is the state variable, $D_{c}$ is the characteristic slip distance, $a$ and $b$ are dimensionless parameters, $\\mu_{0}$ is a reference friction coefficient, and $V_{0}$ is a reference slip rate.\n\nTwo widely used state evolution laws are:\n1. The Dieterich \"aging\" law:\n$$\\frac{d\\theta}{dt} = 1 - \\frac{V \\theta}{D_{c}}.$$\n2. The Ruina \"slip\" law:\n$$\\frac{d\\theta}{dt} = - \\frac{V \\theta}{D_{c}} \\ln\\!\\left(\\frac{V \\theta}{D_{c}}\\right).$$\n\nStarting from these definitions and evolution laws, derive the steady-state condition $\\dot{\\theta} = 0$ for each law and solve for the steady-state state variable $\\theta_{ss}(V)$ as a function of slip rate $V$. Then substitute $\\theta_{ss}(V)$ into the RSF friction relation to eliminate $\\theta$ and derive a closed-form expression for the steady-state friction $\\mu_{ss}(V)$.\n\nFinally, for the parameter set $D_{c} = 5.0 \\times 10^{-6}\\ \\mathrm{m}$, $a = 1.2 \\times 10^{-2}$, $b = 1.8 \\times 10^{-2}$, $\\mu_{0} = 6.0 \\times 10^{-1}$, $V_{0} = 1.0 \\times 10^{-6}\\ \\mathrm{m/s}$, and slip rate $V = 2.5 \\times 10^{-7}\\ \\mathrm{m/s}$, evaluate the steady-state friction $\\mu_{ss}(V)$. Round your final numerical answer to six significant figures. Express the final friction coefficient as a pure number (dimensionless).", "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\nThe given information from the problem statement is:\n- **Rate-and-State Friction (RSF) Law**: $\\mu = \\mu_{0} + a \\ln\\!\\left(\\frac{V}{V_{0}}\\right) + b \\ln\\!\\left(\\frac{\\theta V_{0}}{D_{c}}\\right)$\n- **Dieterich \"Aging\" Law**: $\\frac{d\\theta}{dt} = 1 - \\frac{V \\theta}{D_{c}}$\n- **Ruina \"Slip\" Law**: $\\frac{d\\theta}{dt} = - \\frac{V \\theta}{D_{c}} \\ln\\!\\left(\\frac{V \\theta}{D_{c}}\\right)$\n- **Condition**: Steady-state, where $\\dot{\\theta} = \\frac{d\\theta}{dt} = 0$.\n- **Constants and Parameters**:\n  - Characteristic slip distance: $D_{c} = 5.0 \\times 10^{-6}\\ \\mathrm{m}$\n  - RSF parameter a: $a = 1.2 \\times 10^{-2}$\n  - RSF parameter b: $b = 1.8 \\times 10^{-2}$\n  - Reference friction coefficient: $\\mu_{0} = 6.0 \\times 10^{-1}$\n  - Reference slip rate: $V_{0} = 1.0 \\times 10^{-6}\\ \\mathrm{m/s}$\n- **Evaluation Point**:\n  - Slip rate: $V = 2.5 \\times 10^{-7}\\ \\mathrm{m/s}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is validated against the defined criteria:\n- **Scientifically Grounded**: The problem is based on the Rate-and-State Friction model, which is a cornerstone of modern seismology and rock mechanics for describing earthquake nucleation and rupture. The specified \"aging\" and \"slip\" laws are the two canonical forms of state evolution. The given equations and parameters are standard in the field. The problem is scientifically sound.\n- **Well-Posed**: The problem clearly defines the governing equations and asks for a specific derivation (steady-state friction) and a subsequent numerical evaluation. The steps are logical, and a unique solution exists.\n- **Objective**: The problem statement is composed of objective, technical definitions and a clear, unambiguous task. There is no subjective or opinion-based content.\n- **Flaw Checklist**: The problem does not violate any of the specified flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, or trivial.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Solution Derivation\nThe goal is to find the steady-state friction coefficient, $\\mu_{ss}$, which occurs when the state variable $\\theta$ is no longer changing with time, i.e., $\\frac{d\\theta}{dt} = 0$. We will perform this for both the aging and slip laws.\n\n**1. Steady-State under the Dieterich \"Aging\" Law**\n\nFirst, we set the state evolution equation to zero to find the steady-state condition:\n$$ \\frac{d\\theta}{dt} = 1 - \\frac{V \\theta_{ss}}{D_{c}} = 0 $$\nHere, $\\theta_{ss}$ denotes the steady-state value of the state variable. Solving for $\\theta_{ss}$ as a function of the slip rate $V$:\n$$ \\frac{V \\theta_{ss}}{D_{c}} = 1 $$\n$$ \\theta_{ss}(V) = \\frac{D_{c}}{V} $$\nThis expression shows that at steady-state, the state variable (which can be interpreted as the average age of asperity contacts) is inversely proportional to the slip rate.\n\nNext, we substitute this expression for $\\theta_{ss}$ into the general friction law to find the steady-state friction $\\mu_{ss}(V)$:\n$$ \\mu_{ss}(V) = \\mu_{0} + a \\ln\\left(\\frac{V}{V_{0}}\\right) + b \\ln\\left(\\frac{\\theta_{ss} V_{0}}{D_{c}}\\right) $$\n$$ \\mu_{ss}(V) = \\mu_{0} + a \\ln\\left(\\frac{V}{V_{0}}\\right) + b \\ln\\left(\\frac{(D_{c}/V) V_{0}}{D_{c}}\\right) $$\nSimplifying the term inside the second logarithm:\n$$ \\mu_{ss}(V) = \\mu_{0} + a \\ln\\left(\\frac{V}{V_{0}}\\right) + b \\ln\\left(\\frac{V_{0}}{V}\\right) $$\nUsing the logarithmic identity $\\ln(x/y) = -\\ln(y/x)$:\n$$ \\mu_{ss}(V) = \\mu_{0} + a \\ln\\left(\\frac{V}{V_{0}}\\right) - b \\ln\\left(\\frac{V}{V_{0}}\\right) $$\nFactoring out the logarithmic term, we arrive at the closed-form expression for steady-state friction:\n$$ \\mu_{ss}(V) = \\mu_{0} + (a-b) \\ln\\left(\\frac{V}{V_{0}}\\right) $$\n\n**2. Steady-State under the Ruina \"Slip\" Law**\n\nWe repeat the process for the slip law. Set the state evolution equation to zero:\n$$ \\frac{d\\theta}{dt} = - \\frac{V \\theta_{ss}}{D_{c}} \\ln\\left(\\frac{V \\theta_{ss}}{D_{c}}\\right) = 0 $$\nFor this equation to hold, one of its factors must be zero. Since $V$ and $D_c$ are positive physical constants and $\\theta_{ss}$ represents a characteristic time (and is also positive), the term $-\\frac{V \\theta_{ss}}{D_{c}}$ cannot be zero. Therefore, the logarithmic term must be zero:\n$$ \\ln\\left(\\frac{V \\theta_{ss}}{D_{c}}\\right) = 0 $$\nThis implies that the argument of the logarithm must be equal to $1$:\n$$ \\frac{V \\theta_{ss}}{D_{c}} = 1 $$\nSolving for $\\theta_{ss}(V)$:\n$$ \\theta_{ss}(V) = \\frac{D_{c}}{V} $$\nThis is the same steady-state state variable we found for the aging law. Consequently, substituting this into the friction equation will yield the exact same expression for steady-state friction as before:\n$$ \\mu_{ss}(V) = \\mu_{0} + (a-b) \\ln\\left(\\frac{V}{V_{0}}\\right) $$\nThis is a fundamental result in rate-and-state friction theory: while the transient behavior differs, both the aging and slip laws predict the same steady-state friction response.\n\n**3. Numerical Evaluation**\n\nNow, we evaluate $\\mu_{ss}(V)$ using the given parameter values:\n- $a = 1.2 \\times 10^{-2} = 0.012$\n- $b = 1.8 \\times 10^{-2} = 0.018$\n- $\\mu_{0} = 6.0 \\times 10^{-1} = 0.6$\n- $V_{0} = 1.0 \\times 10^{-6}\\ \\mathrm{m/s}$\n- $V = 2.5 \\times 10^{-7}\\ \\mathrm{m/s}$\n\nFirst, calculate the difference $(a-b)$:\n$$ a-b = 0.012 - 0.018 = -0.006 $$\nNext, calculate the ratio of slip rates $V/V_{0}$:\n$$ \\frac{V}{V_{0}} = \\frac{2.5 \\times 10^{-7}\\ \\mathrm{m/s}}{1.0 \\times 10^{-6}\\ \\mathrm{m/s}} = 0.25 $$\nNow, substitute these values into the steady-state friction equation:\n$$ \\mu_{ss} = 0.6 + (-0.006) \\ln(0.25) $$\nLet's compute the value of the natural logarithm:\n$$ \\ln(0.25) = \\ln(1/4) = -\\ln(4) \\approx -1.386294361 $$\nFinally, calculate $\\mu_{ss}$:\n$$ \\mu_{ss} \\approx 0.6 + (-0.006) \\times (-1.386294361) $$\n$$ \\mu_{ss} \\approx 0.6 + 0.008317766167 $$\n$$ \\mu_{ss} \\approx 0.608317766167 $$\nThe problem requires the answer to be rounded to six significant figures.\n$$ \\mu_{ss} \\approx 0.608318 $$\nThe friction coefficient is a dimensionless quantity.", "answer": "$$\n\\boxed{0.608318}\n$$", "id": "3587297"}, {"introduction": "A central question in seismology is what determines whether a small slip event dies out or grows into a large earthquake. This practice [@problem_id:3587353] explores this question through the powerful technique of linear stability analysis, applied to a fault within an elastic medium. You will derive the famous critical nucleation half-length, $h^*$, a physical scale that connects frictional properties ($a$, $b$, $D_c$) and elastic stiffness ($G$) to the stability of the fault, and then verify your analytical result with a numerical computation.", "problem": "You are asked to work from first principles to linearize the boundary integral formulation for a spatially one-dimensional fault governed by rate-and-state friction, derive the eigenvalue spectrum of the linearized system, obtain the stability boundary as a function of the frictional and elastic parameters, and numerically verify the predicted critical nucleation half-length. The fundamental base you must use comprises: (i) the elastostatic convolution for an interface in an elastic continuum in Fourier space, (ii) the logarithmic rate-and-state friction law, and (iii) the state evolution law with the aging form. Your derivation must start from these base elements and proceed to a linearization about uniform steady sliding. Your program must then implement the derived linearized dynamics to compute eigenvalues, identify the stability boundary, and verify the analytical prediction numerically. All intermediate and final results must be scientific and physically consistent.\n\nStart with the following fundamental statements.\n\n- For anti-plane slip on a planar interface in a homogeneous elastic medium, the Fourier transform of the shear traction perturbation satisfies $\\Delta \\tau(k) = - K(k) \\, \\Delta u(k)$ with $K(k) = \\dfrac{G}{2} \\, |k|$, where $G$ is the shear modulus and $k$ is the spatial wavenumber. Assume a periodic domain of length $L$, so that admissible wavenumbers are $k_n = \\dfrac{2 \\pi n}{L}$ for integer $n \\ge 1$.\n\n- The friction coefficient is $\\mu = \\mu_0 + a \\ln \\left( \\dfrac{V}{V_0} \\right) + b \\ln \\left( \\dfrac{\\theta V_0}{D_c} \\right)$, where $a$ and $b$ are nondimensional rate-and-state parameters, $V$ is slip speed, $V_0$ is steady reference slip speed, $\\theta$ is state, $D_c$ is the characteristic slip distance, and $\\mu_0$ is a constant. The shear traction is $\\tau = \\sigma \\, \\mu$, where $\\sigma$ is the effective normal stress.\n\n- The state evolution (aging) law is $\\dfrac{d \\theta}{d t} = 1 - \\dfrac{V \\, \\theta}{D_c}$.\n\nLinearize the equations about uniform steady sliding with $V = V_0$ and $\\theta = D_c / V_0$. Introduce a single spatial Fourier mode with wavenumber $k$ and assume small perturbations of the form $\\Delta u(x,t) = U \\, e^{i k x + s t}$, $\\Delta V(x,t) = s U \\, e^{i k x + s t}$, and $\\Delta \\theta(x,t) = \\Theta \\, e^{i k x + s t}$, where $s$ is the temporal eigenvalue to be determined. Ignore inertial effects and adopt the quasi-static force balance in which the elastic traction balances the frictional traction at each instant.\n\nYour tasks are:\n\n- Derive the linearized algebraic system for the perturbation amplitudes, and from it, obtain the characteristic equation for $s$ as a function of $K(k)$, $a$, $b$, $D_c$, $\\sigma$, and $V_0$. From the characteristic equation, derive the analytical stability boundary condition separating decaying from growing perturbations for velocity-weakening friction ($b  a$). Based on this boundary, define the critical wavenumber magnitude $|k^*|$ at which the fundamental mode loses stability, and the corresponding critical nucleation half-length $h^*$ in terms of the given parameters.\n\n- Implement a program that, for a given parameter set, computes the eigenvalues $s$ for the fundamental mode $n = 1$ (with $k_1 = \\dfrac{2 \\pi}{L}$) using your derived characteristic equation, and uses a robust root-finding approach to numerically identify the domain length $L^*$ at which the real part of the most unstable eigenvalue crosses zero. From this, compute the numerical estimate of the critical half-length $h^*_{\\text{num}} = \\dfrac{L^*}{2}$.\n\n- Compare the analytical prediction $h^*$ with the numerical estimate $h^*_{\\text{num}}$ by reporting the relative error $\\left| h^*_{\\text{num}} - h^* \\right| / h^*$. Report all half-lengths in meters and the relative errors as decimal numbers (unitless).\n\nTest suite. Use the following three parameter sets to test your derivation and implementation. In all cases, take the steady reference slip speed to be $V_0 = 1 \\times 10^{-6} \\, \\mathrm{m/s}$.\n\n- Case A (happy path): $a = 5 \\times 10^{-3}$, $b = 1 \\times 10^{-2}$, $D_c = 1 \\times 10^{-3} \\, \\mathrm{m}$, $\\sigma = 5 \\times 10^{7} \\, \\mathrm{Pa}$, $G = 3 \\times 10^{10} \\, \\mathrm{Pa}$.\n\n- Case B (different scale): $a = 8 \\times 10^{-3}$, $b = 1.2 \\times 10^{-2}$, $D_c = 5 \\times 10^{-4} \\, \\mathrm{m}$, $\\sigma = 1 \\times 10^{8} \\, \\mathrm{Pa}$, $G = 2 \\times 10^{10} \\, \\mathrm{Pa}$.\n\n- Case C (near-boundary velocity-weakening): $a = 9.5 \\times 10^{-3}$, $b = 1 \\times 10^{-2}$, $D_c = 1 \\times 10^{-3} \\, \\mathrm{m}$, $\\sigma = 5 \\times 10^{7} \\, \\mathrm{Pa}$, $G = 3 \\times 10^{10} \\, \\mathrm{Pa}$.\n\nOutput specification. Your program should produce a single line of output containing the relative errors for the three cases as a comma-separated list enclosed in square brackets. For example, the output must look like \"[x1,x2,x3]\" where $x1$, $x2$, and $x3$ are the relative errors for Cases A, B, and C, respectively, expressed as decimal numbers (not percentages). The program must be completely self-contained and must not read any external input.\n\nAngle units, if any appear, must be in radians. All physical quantities must be expressed in the International System of Units (SI). The final half-lengths you compute internally should be in $\\mathrm{m}$, and the final reported relative errors are dimensionless. Ensure numerical robustness by using a bracketing method for the root search that is guaranteed to converge for the given cases, and round only in the final printout if you choose to round. The test suite is designed so that, for each case, the most unstable mode is the fundamental mode with $n = 1$, and the numerical and analytical critical half-lengths are finite and well within typical computational ranges.", "solution": "The problem requires a linear stability analysis of a one-dimensional fault obeying elastostatics and rate-and-state friction to derive the critical nucleation half-length, followed by a numerical verification.\n\nFirst, we state the governing physical laws provided.\n$1$. The quasi-static elastic response of the medium relates a perturbation in shear traction, $\\Delta \\tau$, to a perturbation in slip, $\\Delta u$, on the fault. In the spatial Fourier domain, this is given by:\n$$\\Delta \\tau(k) = -K(k) \\Delta u(k)$$\nwhere $k$ is the spatial wavenumber and the stiffness kernel $K(k)$ for an anti-plane fault is:\n$$K(k) = \\frac{G}{2}|k|$$\nHere, $G$ is the shear modulus. For a periodic domain of length $L$, the admissible wavenumbers are $k_n = \\frac{2\\pi n}{L}$ for integers $n \\geq 1$.\n\n$2$. The fault friction is described by the logarithmic rate-and-state friction law, where the friction coefficient $\\mu$ depends on the slip velocity $V$ and a state variable $\\theta$:\n$$\\mu = \\mu_0 + a \\ln\\left(\\frac{V}{V_0}\\right) + b \\ln\\left(\\frac{\\theta V_0}{D_c}\\right)$$\nThe shear traction is $\\tau = \\sigma \\mu$, with $\\sigma$ being the effective normal stress. The parameters $a$ and $b$ are dimensionless material constants, $D_c$ is a characteristic slip distance, and $V_0$ is a reference velocity.\n\n$3$. The evolution of the state variable $\\theta$ is governed by the aging law:\n$$\\frac{d\\theta}{dt} = 1 - \\frac{V\\theta}{D_c}$$\n\nThe analysis proceeds by linearizing these equations about a steady-state sliding solution. In steady state, all time derivatives are zero. For a constant slip velocity $V = V_0$, the state evolution law yields the steady-state value of $\\theta$, denoted $\\theta_{ss}$:\n$$0 = 1 - \\frac{V_0 \\theta_{ss}}{D_c} \\implies \\theta_{ss} = \\frac{D_c}{V_0}$$\nThe corresponding steady-state traction is $\\tau_{ss} = \\sigma \\mu_0$.\n\nWe introduce small, time-dependent perturbations: $V = V_0 + \\Delta V$, $\\theta = \\theta_{ss} + \\Delta \\theta$, and $\\tau = \\tau_{ss} + \\Delta \\tau$. We linearize the governing equations for these perturbations.\n\nLinearization of the friction law, $\\tau = \\sigma\\mu$, yields:\n$$\\Delta \\tau \\approx \\sigma \\left( \\frac{\\partial \\mu}{\\partial V} \\bigg|_{ss} \\Delta V + \\frac{\\partial \\mu}{\\partial \\theta} \\bigg|_{ss} \\Delta \\theta \\right)$$\nThe partial derivatives evaluated at the steady state ($V=V_0, \\theta=\\theta_{ss}$) are:\n$$\\frac{\\partial \\mu}{\\partial V} = \\frac{a}{V} \\implies \\frac{a}{V_0}$$\n$$\\frac{\\partial \\mu}{\\partial \\theta} = \\frac{b}{\\theta} \\implies \\frac{b}{\\theta_{ss}} = \\frac{b V_0}{D_c}$$\nThus, the linearized friction law is:\n$$\\Delta \\tau = \\sigma \\left( \\frac{a}{V_0} \\Delta V + \\frac{b V_0}{D_c} \\Delta \\theta \\right)$$\n\nLinearization of the state evolution law gives:\n$$\\frac{d\\Delta\\theta}{dt} = -\\frac{\\partial}{\\partial V}\\left(\\frac{V\\theta}{D_c}\\right)\\bigg|_{ss} \\Delta V - \\frac{\\partial}{\\partial \\theta}\\left(\\frac{V\\theta}{D_c}\\right)\\bigg|_{ss} \\Delta \\theta = -\\frac{\\theta_{ss}}{D_c}\\Delta V - \\frac{V_0}{D_c}\\Delta\\theta$$\nSubstituting $\\theta_{ss} = D_c/V_0$, we obtain:\n$$\\frac{d\\Delta\\theta}{dt} = -\\frac{1}{V_0}\\Delta V - \\frac{V_0}{D_c}\\Delta\\theta$$\n\nWe now analyze the system's stability by considering perturbations of the form of a single Fourier-Laplace mode:\n$$\\Delta u(x,t) = U e^{ikx + st}, \\quad \\Delta V(x,t) = sU e^{ikx + st}, \\quad \\Delta \\theta(x,t) = \\Theta e^{ikx + st}$$\nHere, $s$ is the complex growth rate (eigenvalue) to be determined. In this basis, the operator $\\frac{d}{dt}$ is replaced by multiplication by $s$. The linearized equations become an algebraic system for the amplitudes $U$ and $\\Theta$:\n\nFrom the friction law, with $\\Delta \\tau = T e^{ikx + st}$ and the elastostatic relation $T = -K(k)U$:\n$$-K(k)U = \\sigma \\left( \\frac{a}{V_0} (sU) + \\frac{b V_0}{D_c} \\Theta \\right)$$\n\nFrom the state evolution law:\n$$s\\Theta = -\\frac{1}{V_0}(sU) - \\frac{V_0}{D_c}\\Theta \\implies \\Theta\\left(s+\\frac{V_0}{D_c}\\right) = -\\frac{sU}{V_0}$$\nSolving for $\\Theta$ in terms of $U$:\n$$\\Theta = -\\frac{sU}{V_0(s+V_0/D_c)}$$\nSubstituting this expression for $\\Theta$ into the friction equation eliminates $\\Theta$:\n$$-K(k)U = \\sigma \\left( \\frac{asU}{V_0} - \\frac{bV_0}{D_c} \\frac{sU}{V_0(s+V_0/D_c)} \\right)$$\nFor a non-trivial solution ($U \\neq 0$), we can divide by $U$ and rearrange the terms to find the characteristic equation for $s$:\n$$-K(k) = \\frac{\\sigma s}{V_0} \\left( a - \\frac{bV_0/D_c}{s+V_0/D_c} \\right) = \\frac{\\sigma s}{V_0} \\frac{as + (a-b)V_0/D_c}{s+V_0/D_c}$$\n$$-K(k)V_0(s+V_0/D_c) = \\sigma s(as + (a-b)V_0/D_c)$$\n$$-K(k)V_0s - \\frac{K(k)V_0^2}{D_c} = \\sigma a s^2 + \\sigma(a-b)\\frac{V_0}{D_c}s$$\nThis yields the quadratic characteristic equation for $s$:\n$$(\\sigma a)s^2 + \\left[ \\sigma(a-b)\\frac{V_0}{D_c} + K(k)V_0 \\right]s + K(k)\\frac{V_0^2}{D_c} = 0$$\nThis is an equation of the form $As^2 + Bs + C = 0$, with coefficients:\n$$A = \\sigma a$$\n$$B = \\sigma(a-b)\\frac{V_0}{D_c} + K(k)V_0$$\n$$C = K(k)\\frac{V_0^2}{D_c}$$\nThe roots of this equation determine the stability of the system. An instability, corresponding to a growing perturbation, occurs if the real part of any root $s$ is positive. The real parts of the roots are given by $\\text{Re}(s) = \\frac{-B}{2A}$. Since $A = \\sigma a  0$, instability requires $B  0$. The stability boundary is therefore defined by the condition $B=0$:\n$$\\sigma(a-b)\\frac{V_0}{D_c} + K(k)V_0 = 0$$\nFor velocity-weakening friction ($b  a$), the term $a-b$ is negative, allowing for instability. At the stability boundary, the stiffness $K(k)$ reaches a critical value. Solving for $K(k)$:\n$$K(k) = -\\sigma(a-b)\\frac{1}{D_c} = \\frac{\\sigma(b-a)}{D_c}$$\nThis critical stiffness, $K_c = \\frac{\\sigma(b-a)}{D_c}$, defines the threshold for instability. Any mode with $K(k)  K_c$ is unstable. Substituting the expression for $K(k)$:\n$$\\frac{G|k|}{2} = \\frac{\\sigma(b-a)}{D_c}$$\nThis gives the critical wavenumber $|k^*|$:\n$$|k^*| = \\frac{2\\sigma(b-a)}{G D_c}$$\nThe system is unstable for all wavenumbers $|k|  |k^*|$. The first mode to become unstable as the domain size $L$ is increased is the fundamental mode, with wavenumber $|k_1| = \\frac{2\\pi}{L}$. The critical length $L^*$ is reached when $|k_1| = |k^*|$:\n$$\\frac{2\\pi}{L^*} = \\frac{2\\sigma(b-a)}{G D_c} \\implies L^* = \\frac{\\pi G D_c}{\\sigma(b-a)}$$\nThe critical nucleation half-length $h^*$ is half of this critical length:\n$$h^* = \\frac{L^*}{2} = \\frac{\\pi G D_c}{2\\sigma(b-a)}$$\nThis is the analytical prediction. For numerical verification, we find the root $L^*$ of the equation $\\text{Re}(s_{\\text{max}}(L))=0$, which is equivalent to finding the root of $B(L)=0$. The numerical estimate $h^*_{\\text{num}} = L^*/2$ can then be compared to the analytical result $h^*$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for the relative error between analytical and numerical critical\n    nucleation half-lengths for three test cases of fault stability analysis.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # V0 is constant for all cases.\n    V0 = 1.0e-6  # m/s\n\n    test_cases = [\n        # Case A\n        {'name': 'A', 'a': 5e-3, 'b': 1e-2, 'Dc': 1e-3, 'sigma': 5e7, 'G': 3e10, 'V0': V0},\n        # Case B\n        {'name': 'B', 'a': 8e-3, 'b': 1.2e-2, 'Dc': 5e-4, 'sigma': 1e8, 'G': 2e10, 'V0': V0},\n        # Case C\n        {'name': 'C', 'a': 9.5e-3, 'b': 1e-2, 'Dc': 1e-3, 'sigma': 5e7, 'G': 3e10, 'V0': V0}\n    ]\n\n    results = []\n    for params in test_cases:\n        p = params # Use a shorter alias for the parameters dictionary\n\n        # Analytical calculation of the critical nucleation half-length h*\n        # h* = (pi * G * Dc) / (2 * sigma * (b-a))\n        # Condition b  a must hold for a physically meaningful (positive) h*.\n        if p['b'] = p['a']:\n            # This case corresponds to velocity strengthening or neutral behavior,\n            # which is stable for all wavelengths. The critical length is infinite.\n            # This case does not occur in the provided test suite.\n            relative_error = 0.0\n        else:\n            h_star_analytic = (np.pi * p['G'] * p['Dc']) / (2.0 * p['sigma'] * (p['b'] - p['a']))\n\n            # Numerical calculation of the critical nucleation half-length h*_num.\n            # This involves finding the root L* of the function B(L) = 0, where\n            # the real part of the largest eigenvalue is -B/(2A).\n            # B(L) = sigma*(a-b)*V0/Dc + K(k)*V0, with k = 2*pi/L.\n            # The term V0 is a common factor and can be cancelled.\n            # We solve for the root of B(L)/V0 = 0.\n            \n            def B_divided_by_V0(L, p_dict):\n                \"\"\"\n                Represents the B coefficient of the characteristic equation,\n                divided by V0, as a function of domain length L.\n                The root of this function gives the critical length L*.\n                \"\"\"\n                sigma_val = p_dict['sigma']\n                a_val = p_dict['a']\n                b_val = p_dict['b']\n                Dc_val = p_dict['Dc']\n                G_val = p_dict['G']\n                \n                term1 = sigma_val * (a_val - b_val) / Dc_val\n                # Stiffness term K(k) = G*|k|/2 = G*pi/L for the fundamental mode k=2*pi/L.\n                term2 = (G_val * np.pi) / L\n                return term1 + term2\n\n            # Use a robust bracketing root-finding method to find L*.\n            # The bracket [L_min, L_max] must contain the root.\n            # For small L, B_divided_by_V0  0 (stable). For large L, B_divided_by_V0  0 (unstable).\n            # So a bracket like [1e-3, 1e7] is safe for the expected values.\n            L_min, L_max = 1e-3, 1e7 # meters\n            \n            L_star_numeric = optimize.brentq(B_divided_by_V0, L_min, L_max, args=(p,))\n            \n            h_star_numeric = L_star_numeric / 2.0\n            \n            # Calculate the relative error.\n            # The analytical solution is the exact root, so the error should be near\n            # machine precision, limited by the tolerance of the root-finder.\n            if h_star_analytic == 0:\n                relative_error = 0.0 if h_star_numeric == 0 else np.inf\n            else:\n                relative_error = np.abs(h_star_numeric - h_star_analytic) / h_star_analytic\n        \n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    # Using high precision to show the error is close to zero.\n    print(f\"[{','.join(f'{err:.15e}' for err in results)}]\")\n\nsolve()\n\n```", "id": "3587353"}, {"introduction": "Simulating the full earthquake cycle, with its vast range of time scales from geologic loading (years) to dynamic rupture (seconds), presents a significant computational challenge known as stiffness. This practice [@problem_id:3587338] addresses this issue directly by guiding you through the formulation and implementation of a robust Implicit-Explicit (IMEX) numerical scheme. This approach is essential for developing stable and efficient models that can capture the full spectrum of fault behavior, making it a cornerstone of modern computational seismology.", "problem": "You are given a single-degree-of-freedom spring-slider representation of a fault patch subject to shear loading and governed by rate-and-state friction. The state variable follows the aging law, and an elastic traction couples slip rate into stress evolution. Your task is to derive a stable implicit-explicit scheme and implement it for time integration of the coupled system, including a robust nonlinear solve at each time step.\n\nStart from the following well-tested model equations, which are standard in computational geophysics:\n\n- Shear traction evolution due to a linear elastic spring attached to a loader moving at constant speed: $$\\dot{\\tau}(t) = k\\left(V_{\\mathrm{pl}} - V(t)\\right),$$ where $k$ is the shear stiffness (in $\\mathrm{Pa}/\\mathrm{m}$), $V_{\\mathrm{pl}}$ is the constant plate speed (in $\\mathrm{m}/\\mathrm{s}$), and $V(t)$ is the slip rate (in $\\mathrm{m}/\\mathrm{s}$).\n- Rate-and-state friction coefficient (the Dieterich-Ruina form): $$\\mu\\left(V,\\theta\\right) = \\mu_0 + a \\ln\\left(\\frac{V}{V_0}\\right) + b \\ln\\left(\\frac{\\theta V_0}{L}\\right),$$ where $\\mu_0$ is a reference friction coefficient, $a$ and $b$ are the direct and evolution effect parameters (dimensionless), $V_0$ is a reference slip rate (in $\\mathrm{m}/\\mathrm{s}$), $\\theta$ is the state variable (in $\\mathrm{s}$), and $L$ is the characteristic slip distance (in $\\mathrm{m}$).\n- Aging law for the state variable: $$\\dot{\\theta}(t) = 1 - \\frac{V(t)\\,\\theta(t)}{L}.$$\n- Quasi-dynamic force balance relating shear traction to friction and radiation damping: $$\\tau(t) = \\sigma_n\\,\\mu\\left(V(t),\\theta(t)\\right) + \\eta\\,V(t),$$ where $\\sigma_n$ is the effective normal stress (in $\\mathrm{Pa}$) and $\\eta$ is the radiation damping coefficient (in $\\mathrm{Pa}\\cdot \\mathrm{s}/\\mathrm{m}$).\n\nYou must formulate an Implicit-Explicit (IMEX) time-stepping scheme, where Implicit-Explicit (IMEX) means that stiff terms are discretized implicitly to enhance stability while non-stiff terms are discretized explicitly to maintain efficiency. Justify, based on time-scale and stiffness considerations, which terms should be treated implicitly versus explicitly. Then, implement the scheme with the following requirements:\n\n- Use a first-order Implicit-Explicit scheme over time increments of size $\\Delta t$ that integrates until a final time $T$.\n- Treat the linear elastic loading contribution in the traction equation implicitly with respect to $V$, and treat the linear decay term in the aging law implicitly with respect to $\\theta$ while using an explicit slip rate for that step in the state update. Use the frictional logarithms explicitly in the state update but solve the nonlinear algebraic traction-friction balance implicitly for the slip rate at the new time level.\n- Enforce $V  0$ by regularization with a small floor $V_{\\min}  0$ in all logarithms to avoid singularities. Choose $V_{\\min}$ sufficiently small to not pollute the physical solution while maintaining numerical robustness.\n- Initialize at steady sliding: set $\\theta(0) = L/V_{\\mathrm{pl}}$ and $V(0)=V_{\\mathrm{pl}}$, and compute $\\tau(0)$ consistently from the force balance.\n- Use a robust one-dimensional nonlinear root finder at each time step to determine the slip rate that satisfies the implicit traction-friction relation. Your algorithm must reliably bracket the root and then solve it.\n- Ensure scientific realism and consistency of units, and explain the choice of implicit versus explicit treatment by comparing characteristic time scales and linearity.\n\nYour program should implement the time integration for the following three test cases. For each case, produce the slip rate at final time $T$ in $\\mathrm{m}/\\mathrm{s}$, rounded to $6$ significant figures.\n\nTest suite (all quantities in SI units):\n\n- Case $1$ (happy path):\n  - $k = 10^8\\,\\mathrm{Pa}/\\mathrm{m}$,\n  - $\\sigma_n = 5\\times 10^7\\,\\mathrm{Pa}$,\n  - $\\eta = 10^7\\,\\mathrm{Pa}\\cdot\\mathrm{s}/\\mathrm{m}$,\n  - $\\mu_0 = 0.6$,\n  - $a = 0.01$,\n  - $b = 0.015$,\n  - $V_0 = 10^{-6}\\,\\mathrm{m}/\\mathrm{s}$,\n  - $L = 10^{-2}\\,\\mathrm{m}$,\n  - $V_{\\mathrm{pl}} = 10^{-9}\\,\\mathrm{m}/\\mathrm{s}$,\n  - $\\Delta t = 1\\,\\mathrm{s}$,\n  - $T = 10^4\\,\\mathrm{s}$,\n  - $V_{\\min} = 10^{-12}\\,\\mathrm{m}/\\mathrm{s}$.\n- Case $2$ (stiff elastic and small characteristic slip distance):\n  - $k = 10^9\\,\\mathrm{Pa}/\\mathrm{m}$,\n  - $\\sigma_n = 10^8\\,\\mathrm{Pa}$,\n  - $\\eta = 5\\times 10^7\\,\\mathrm{Pa}\\cdot\\mathrm{s}/\\mathrm{m}$,\n  - $\\mu_0 = 0.6$,\n  - $a = 0.01$,\n  - $b = 0.015$,\n  - $V_0 = 10^{-6}\\,\\mathrm{m}/\\mathrm{s}$,\n  - $L = 10^{-4}\\,\\mathrm{m}$,\n  - $V_{\\mathrm{pl}} = 10^{-9}\\,\\mathrm{m}/\\mathrm{s}$,\n  - $\\Delta t = 0.1\\,\\mathrm{s}$,\n  - $T = 5\\times 10^3\\,\\mathrm{s}$,\n  - $V_{\\min} = 10^{-12}\\,\\mathrm{m}/\\mathrm{s}$.\n- Case $3$ (velocity-weakening with moderate stiffness):\n  - $k = 5\\times 10^8\\,\\mathrm{Pa}/\\mathrm{m}$,\n  - $\\sigma_n = 8\\times 10^7\\,\\mathrm{Pa}$,\n  - $\\eta = 2\\times 10^7\\,\\mathrm{Pa}\\cdot\\mathrm{s}/\\mathrm{m}$,\n  - $\\mu_0 = 0.6$,\n  - $a = 0.005$,\n  - $b = 0.015$,\n  - $V_0 = 10^{-6}\\,\\mathrm{m}/\\mathrm{s}$,\n  - $L = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - $V_{\\mathrm{pl}} = 10^{-9}\\,\\mathrm{m}/\\mathrm{s}$,\n  - $\\Delta t = 0.5\\,\\mathrm{s}$,\n  - $T = 10^4\\,\\mathrm{s}$,\n  - $V_{\\min} = 10^{-12}\\,\\mathrm{m}/\\mathrm{s}$.\n\nFinal output format requirement:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $$[r_1,r_2,r_3],$$ where $r_i$ are the final slip rates at $T$ for the cases above, each in $\\mathrm{m}/\\mathrm{s}$ rounded to $6$ significant figures, with no additional text printed. Angles are not part of this problem. Do not use percentage signs; all numerical answers must be plain decimal numbers. The only line printed by your program must be the final list in the specified format.", "solution": "The problem requires the formulation and implementation of a first-order Implicit-Explicit (IMEX) time-stepping scheme to solve the equations of motion for a single-degree-of-freedom spring-slider system governed by rate-and-state friction. The solution must be scientifically grounded, explaining the rationale behind the numerical design choices, and computationally robust.\n\nThe system is described by a set of coupled ordinary differential equations (ODEs) and an algebraic constraint. Let the state of the system at time $t$ be described by the shear traction $\\tau(t)$, the slip rate $V(t)$, and the state variable $\\theta(t)$. The governing equations are:\n1.  Shear traction evolution: $\\dot{\\tau}(t) = k\\left(V_{\\mathrm{pl}} - V(t)\\right)$\n2.  State variable evolution (aging law): $\\dot{\\theta}(t) = 1 - \\frac{V(t)\\,\\theta(t)}{L}$\n3.  Force balance with rate-and-state friction: $\\tau(t) = \\sigma_n\\left[\\mu_0 + a \\ln\\left(\\frac{V(t)}{V_0}\\right) + b \\ln\\left(\\frac{\\theta(t) V_0}{L}\\right)\\right] + \\eta\\,V(t)$\n\nThese equations exhibit stiffness, meaning they involve processes occurring on vastly different time scales. During inter-seismic periods, changes are slow (years), driven by the plate loading rate $V_{\\mathrm{pl}}$. During co-seismic slip, changes can be extremely rapid (seconds or less). Explicit time integration schemes are numerically unstable for stiff systems unless the time step $\\Delta t$ is prohibitively small, dictated by the fastest time scale in the system. An IMEX scheme mitigates this by treating stiff terms implicitly for stability while treating non-stiff terms explicitly for efficiency and simplicity.\n\nOur strategy is to discretize the ODEs over a time step $\\Delta t$, advancing the solution from time $t_n = n\\Delta t$ to $t_{n+1} = (n+1)\\Delta t$. The state at step $n$ is denoted by $(\\tau_n, V_n, \\theta_n)$ and at step $n+1$ by $(\\tau_{n+1}, V_{n+1}, \\theta_{n+1})$.\n\n**Discretization of the Governing Equations**\n\n*   **State Variable Evolution ($\\dot{\\theta}$):**\n    The evolution equation for $\\theta$ is $\\dot{\\theta} = 1 - V\\theta/L$. The term $-V\\theta/L$ can be stiff when the slip rate $V$ is large, as the characteristic time scale $L/V$ becomes very small. Following the problem's prescription, we treat the dependence on $\\theta$ implicitly and the dependence on $V$ explicitly. This is a standard IMEX approach that decouples the $\\theta$ update from the main nonlinear solve for $V_{n+1}$. Using a first-order backward difference for the time derivative and evaluating the terms on the right-hand side as specified gives:\n    $$ \\frac{\\theta_{n+1} - \\theta_n}{\\Delta t} = 1 - \\frac{V_n \\theta_{n+1}}{L} $$\n    This is a linear equation for $\\theta_{n+1}$ which can be solved algebraically:\n    $$ \\theta_{n+1} \\left(1 + \\frac{\\Delta t V_n}{L}\\right) = \\theta_n + \\Delta t $$\n    $$ \\theta_{n+1} = \\frac{\\theta_n + \\Delta t}{1 + \\frac{\\Delta t V_n}{L}} $$\n    This update is computationally explicit as it only depends on known quantities from step $n$. It is unconditionally stable for the linear decay term, a key benefit of the implicit treatment of $\\theta_{n+1}$. For numerical robustness in the subsequent friction law calculation, we regularize the slip rate $V_n$ by enforcing a minimum value $V_{\\min}$, so we compute with $\\max(V_n, V_{\\min})$.\n\n*   **Shear Traction Evolution ($\\dot{\\tau}$):**\n    The traction evolution is given by $\\dot{\\tau} = k(V_{\\mathrm{pl}} - V)$. The term $-kV$ represents the elastic unloading of the fault. For large shear stiffness $k$, this term is highly stiff. An explicit treatment would impose a severe stability constraint $\\Delta t  C/k$ for some constant $C$. To overcome this, we treat the dependence on $V$ implicitly, as requested.\n    $$ \\frac{\\tau_{n+1} - \\tau_n}{\\Delta t} = k(V_{\\mathrm{pl}} - V_{n+1}) $$\n    Rearranging for $\\tau_{n+1}$ yields an expression that depends on the yet-unknown slip rate $V_{n+1}$:\n    $$ \\tau_{n+1} = \\tau_n + \\Delta t \\, k(V_{\\mathrm{pl}} - V_{n+1}) $$\n\n*   **Force Balance and Nonlinear Solve for $V_{n+1}$:**\n    The core of the time step is to enforce the algebraic force balance equation at the new time level $t_{n+1}$:\n    $$ \\tau_{n+1} = \\sigma_n\\,\\mu(V_{n+1}, \\theta_{n+1}) + \\eta\\,V_{n+1} $$\n    Substituting the expressions for $\\tau_{n+1}$ and the friction coefficient $\\mu(V_{n+1}, \\theta_{n+1})$ gives a single, nonlinear algebraic equation for $V_{n+1}$:\n    $$ \\tau_n + \\Delta t \\, k(V_{\\mathrm{pl}} - V_{n+1}) = \\sigma_n\\left[\\mu_0 + a \\ln\\left(\\frac{V_{n+1}}{V_0}\\right) + b \\ln\\left(\\frac{\\theta_{n+1} V_0}{L}\\right)\\right] + \\eta\\,V_{n+1} $$\n    Here, $\\tau_n$ is known from the previous step, and $\\theta_{n+1}$ is pre-computed using its update rule derived earlier. The only unknown is $V_{n+1}$. We define a residual function $R(V)$ whose root is the desired solution $V_{n+1}$. Let $V \\equiv V_{n+1}$:\n    $$ R(V) = \\left(\\tau_n + \\Delta t k V_{\\mathrm{pl}}\\right) - \\left( (\\eta + \\Delta t k)V + \\sigma_n\\mu_0 + \\sigma_n a \\ln\\left(\\frac{V}{V_0}\\right) + \\sigma_n b \\ln\\left(\\frac{\\theta_{n+1} V_0}{L}\\right) \\right) = 0 $$\n    To facilitate the root-finding procedure, we can regroup the terms that depend on $V$:\n    $$ R(V) = \\sigma_n a \\ln\\left(\\frac{V}{V_0}\\right) + (\\eta + k \\Delta t)V - C = 0 $$\n    where $C$ is a constant within the time step:\n    $$ C = \\tau_n + k \\Delta t V_{\\mathrm{pl}} - \\sigma_n \\mu_0 - \\sigma_n b \\ln\\left(\\frac{\\theta_{n+1} V_0}{L}\\right) $$\n    The function $f(V) = \\sigma_n a \\ln(V/V_0) + (\\eta + k \\Delta t)V$ is strictly monotonic for $V  0$, since its derivative $f'(V) = \\sigma_n a / V + (\\eta + k \\Delta t)$ is always positive (given $a, \\sigma_n, \\eta, k, \\Delta t  0$). This guarantees a unique solution for $V_{n+1}$, which we can find using a standard bracketing root-finder like Brent's method. The logarithm terms require $V  0$, which is enforced by regularizing with a small positive floor $V_{\\min}$.\n\n**Algorithm Summary**\n\nThe complete algorithm for advancing the solution from $t=0$ to $T$ is as follows:\n\n1.  **Initialization ($t=0$):**\n    The system is initialized at steady-state sliding with slip rate $V_{\\mathrm{pl}}$.\n    a.  Set the initial slip rate $V(0) = V_{\\mathrm{pl}}$.\n    b.  From $\\dot{\\theta}=0$, we get $\\theta(0) = L/V_{\\mathrm{pl}}$.\n    c.  Compute the initial traction $\\tau_0$ from the force balance. With $V(0)=V_{\\mathrm{pl}}$ and $\\theta(0)=L/V_{\\mathrm{pl}}$, the steady-state friction law gives:\n        $\\tau_0 = \\sigma_n \\left[ \\mu_0 + (a-b) \\ln\\left(\\frac{V_{\\mathrm{pl}}}{V_0}\\right) \\right] + \\eta V_{\\mathrm{pl}}$.\n    d.  Set the current state $(\\tau, V, \\theta)$ to $(\\tau_0, V(0), \\theta(0))$.\n\n2.  **Time-stepping Loop:**\n    For each time step from $n=0$ until $t_{n+1}  T$:\n    a.  Retrieve the current state $(\\tau_n, V_n, \\theta_n)$.\n    b.  **Update State Variable:** Calculate $\\theta_{n+1}$ using the explicit update derived from the semi-implicit discretization:\n        $$ \\theta_{n+1} = \\frac{\\theta_n + \\Delta t}{1 + \\frac{\\Delta t \\max(V_n, V_{\\min})}{L}} $$\n    c.  **Solve for Slip Rate:** Find the root $V_{n+1}$ of the nonlinear residual equation $R(V) = 0$.\n        i.   Construct the constant $C$ for the current step.\n        ii.  Define the residual function $R(V) = \\sigma_n a \\ln\\left(\\frac{\\max(V, V_{\\min})}{V_0}\\right) + (\\eta + k \\Delta t)V - C$.\n        iii. Find a bracketing interval $[V_a, V_b]$ such that $R(V_a) \\cdot R(V_b)  0$. Since $R(V) \\to -\\infty$ as $V \\to 0^+$ and $R(V) \\to +\\infty$ as $V \\to \\infty$, an interval can always be found. A practical choice is to start with $[V_{\\min}, 1.0]$ and expand the upper bound if necessary.\n        iv. Use a numerical solver (e.g., `scipy.optimize.brentq`) to find $V_{n+1}$ within the bracket.\n    d.  **Update Shear Traction:** Calculate $\\tau_{n+1}$ using its backward-Euler update rule:\n        $$ \\tau_{n+1} = \\tau_n + \\Delta t \\, k(V_{\\mathrm{pl}} - V_{n+1}) $$\n    e.  **Advance State:** Set $(\\tau_n, V_n, \\theta_n) \\leftarrow (\\tau_{n+1}, V_{n+1}, \\theta_{n+1})$ for the next iteration.\n\n3.  **Final Result:**\n    After the loop terminates, the final computed slip rate is the answer. This value is rounded to $6$ significant figures.\nThis IMEX scheme robustly handles the stiffness inherent in the rate-and-state friction model, allowing for computationally feasible time steps while maintaining accuracy for this first-order method.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the simulation for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path)\n        {\n            \"k\": 1e8, \"sigma_n\": 5e7, \"eta\": 1e7, \"mu0\": 0.6, \"a\": 0.01,\n            \"b\": 0.015, \"V0\": 1e-6, \"L\": 1e-2, \"V_pl\": 1e-9, \"dt\": 1.0,\n            \"T\": 1e4, \"V_min\": 1e-12\n        },\n        # Case 2 (stiff elastic and small characteristic slip distance)\n        {\n            \"k\": 1e9, \"sigma_n\": 1e8, \"eta\": 5e7, \"mu0\": 0.6, \"a\": 0.01,\n            \"b\": 0.015, \"V0\": 1e-6, \"L\": 1e-4, \"V_pl\": 1e-9, \"dt\": 0.1,\n            \"T\": 5e3, \"V_min\": 1e-12\n        },\n        # Case 3 (velocity-weakening with moderate stiffness)\n        {\n            \"k\": 5e8, \"sigma_n\": 8e7, \"eta\": 2e7, \"mu0\": 0.6, \"a\": 0.005,\n            \"b\": 0.015, \"V0\": 1e-6, \"L\": 5e-3, \"V_pl\": 1e-9, \"dt\": 0.5,\n            \"T\": 1e4, \"V_min\": 1e-12\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        final_v = run_simulation(**params)\n        # Format to 6 significant figures\n        results.append(f\"{final_v:.6g}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(k, sigma_n, eta, mu0, a, b, V0, L, V_pl, dt, T, V_min):\n    \"\"\"\n    Runs a single simulation for a given set of parameters using an IMEX scheme.\n\n    Args:\n        k (float): Shear stiffness (Pa/m)\n        sigma_n (float): Effective normal stress (Pa)\n        eta (float): Radiation damping coefficient (Pa*s/m)\n        mu0 (float): Reference friction coefficient\n        a (float): Direct effect parameter\n        b (float): Evolution effect parameter\n        V0 (float): Reference slip rate (m/s)\n        L (float): Characteristic slip distance (m)\n        V_pl (float): Constant plate speed (m/s)\n        dt (float): Time step size (s)\n        T (float): Final integration time (s)\n        V_min (float): Regularization floor for slip rate (m/s)\n\n    Returns:\n        float: The final slip rate V(T).\n    \"\"\"\n\n    # 1. Initialization at steady state\n    v_n = V_pl\n    theta_n = L / V_pl\n    tau_n = sigma_n * (mu0 + (a - b) * np.log(V_pl / V0)) + eta * V_pl\n\n    # Time-stepping loop\n    current_time = 0.0\n    while current_time  T:\n        \n        # Ensure the final step does not overshoot T\n        time_step = min(dt, T - current_time)\n        if time_step = 0:\n            break\n\n        # 2a. Update state variable theta (explicitly in V, implicitly in theta)\n        v_n_reg = max(v_n, V_min)\n        theta_next = (theta_n + time_step) / (1.0 + time_step * v_n_reg / L)\n\n        # 2b. Set up the nonlinear root-finding problem for V_next\n        \n        # Constant term C in the residual equation\n        # R(V) = (sigma_n*a*log(V/V0) + (eta + k*dt)*V) - C = 0\n        C = (tau_n + k * time_step * V_pl - sigma_n * mu0\n             - sigma_n * b * np.log(theta_next * V0 / L))\n\n        def residual(v):\n            \"\"\"Residual function R(V)=0 to be solved for V_next.\"\"\"\n            # Regularize V inside the logarithm\n            v_reg = max(v, V_min)\n            return (sigma_n * a * np.log(v_reg / V0) +\n                    (eta + k * time_step) * v - C)\n\n        # Find a bracketing interval for the root\n        v_lower = V_min\n        v_upper = 1.0  # An initial guess for the upper bound (high slip rate)\n        \n        # Expand upper bound until root is bracketed\n        # residual(v_lower) is expected to be negative\n        while residual(v_upper)  0:\n            v_upper *= 10.0\n            if v_upper > 1e10: # Safety break for runaway search\n                raise RuntimeError(\"Failed to bracket the root for V.\")\n\n        # Solve for V_next using Brent's method\n        try:\n             v_next = brentq(residual, v_lower, v_upper, xtol=1e-20, rtol=1e-15)\n        except ValueError:\n            # This can happen if the interval is not bracketing, though the logic above should prevent it.\n            raise RuntimeError(f\"Root finding failed. Interval: [{v_lower}, {v_upper}], \"\n                               f\"f(a)={residual(v_lower)}, f(b)={residual(v_upper)}\")\n\n\n        # 2c. Update shear traction tau\n        tau_next = tau_n + time_step * k * (V_pl - v_next)\n\n        # 2d. Advance state for the next iteration\n        v_n = v_next\n        theta_n = theta_next\n        tau_n = tau_next\n\n        current_time += time_step\n\n    return v_n\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3587338"}]}