{"hands_on_practices": [{"introduction": "The equations governing flow and transport in porous media are formulated at a continuum scale, yet the medium itself is complex and heterogeneous at the pore scale. This practice explores the fundamental concept of the Representative Elementary Volume (REV), which defines the minimum averaging volume required to obtain stable, meaningful macroscopic properties. By deriving the relationship between microscopic statistical properties and the REV size from first principles [@problem_id:3617636], you will gain a deeper appreciation for the assumptions underpinning continuum models.", "problem": "A heterogeneous sandstone can be modeled as a statistically stationary and ergodic random field of porosity, denoted by $n(\\mathbf{x})$, with constant mean $\\langle n(\\mathbf{x}) \\rangle = n$ where $n = 0.25$. Consider computing the spatial average of porosity over a cubic measurement window of side length $L$ and volume $V = L^{3}$, namely\n$$\n\\bar{n}_{V} = \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x}.\n$$\nLet the two-point covariance of porosity fluctuations be $C(\\mathbf{r}) = \\langle \\big(n(\\mathbf{x}) - n\\big)\\big(n(\\mathbf{x}+\\mathbf{r}) - n\\big) \\rangle$, assumed integrable and decaying sufficiently fast so that the covariance integral\n$$\n\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}\n$$\nexists and is finite. The Representative Elementary Volume (REV) is defined here as the smallest cube size $L$ for which the relative porosity fluctuation of the volume-averaged porosity satisfies\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n}  \\epsilon,\n$$\nwith tolerance $\\epsilon = 0.01$. Starting from the fundamental definition of the variance of a spatial average in terms of the covariance function, and using only the stated assumptions, derive the asymptotic scaling of $\\mathrm{Var}[\\bar{n}_{V}]$ with $V$ for large $L$, and then determine the minimum $L$ that meets the REV criterion.\n\nYour final answer must be a single closed-form analytic expression for the minimum $L$ in terms of $n$, $\\epsilon$, and $\\sigma_{0}$, with the numerical values $n = 0.25$ and $\\epsilon = 0.01$ substituted. Express the length scale in meters. No rounding is required.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- The porosity field $n(\\mathbf{x})$ is a statistically stationary and ergodic random field.\n- The mean porosity is constant: $\\langle n(\\mathbf{x}) \\rangle = n = 0.25$.\n- The spatial average of porosity is defined over a cubic measurement window of side length $L$ and volume $V = L^{3}$:\n$$\n\\bar{n}_{V} = \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x}.\n$$\n- The two-point covariance of porosity fluctuations is $C(\\mathbf{r}) = \\langle \\big(n(\\mathbf{x}) - n\\big)\\big(n(\\mathbf{x}+\\mathbf{r}) - n\\big) \\rangle$.\n- The covariance function $C(\\mathbf{r})$ is integrable and decays sufficiently fast.\n- The covariance integral is defined as $\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}$, which is finite.\n- The Representative Elementary Volume (REV) criterion is defined by the relative porosity fluctuation:\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n}  \\epsilon,\n$$\n- The specified tolerance is $\\epsilon = 0.01$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on fundamental principles of statistical mechanics and geostatistics as applied to porous media, a core topic in computational geophysics and hydrogeology. The concepts of spatial averaging, covariance, ergodicity, and the definition of an REV are standard and scientifically sound.\n- **Well-Posed:** The problem is well-posed. It asks for the derivation of a standard asymptotic result and its application. All necessary definitions, variables ($n, \\epsilon, \\sigma_0$), and assumptions (stationarity, ergodicity, integrable covariance) are provided to uniquely determine the required analytical expression. The \"large $L$\" condition properly defines the asymptotic regime for the derivation.\n- **Objective:** The problem is stated using precise, objective mathematical and scientific language, free from ambiguity or subjective claims.\n- **Completeness and Consistency:** The problem is self-contained and internally consistent. The definitions and constraints do not contradict one another. Dimensional analysis confirms consistency: since porosity $n$ is dimensionless, its covariance $C(\\mathbf{r})$ is also dimensionless. The integral $\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}$ therefore has units of volume, $[L]^3$. The variance of the averaged porosity, $\\mathrm{Var}[\\bar{n}_{V}]$, must be dimensionless. The derived scaling law, $\\mathrm{Var}[\\bar{n}_{V}] \\propto \\sigma_{0}^{2}/V$, is dimensionally consistent ($[L]^3/[L]^3$). The final expression for length $L$ will correctly depend on $\\sigma_0$ (which has units of $[L]^{3/2}$).\n- **Other Flaws:** The problem is a standard, non-trivial exercise in statistical physics and does not suffer from being ill-posed, unrealistic, or tautological.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to find the minimum side length $L$ of a cubic volume $V=L^3$ that satisfies the Representative Elementary Volume (REV) criterion. This requires deriving the asymptotic behavior of the variance of the volume-averaged porosity, $\\mathrm{Var}[\\bar{n}_{V}]$.\n\nFirst, we express $\\mathrm{Var}[\\bar{n}_{V}]$ in terms of the covariance function $C(\\mathbf{r})$. The variance is defined as $\\mathrm{Var}[\\bar{n}_{V}] = \\langle (\\bar{n}_{V} - \\langle \\bar{n}_{V} \\rangle)^2 \\rangle$. We compute the expected value of the averaged porosity $\\bar{n}_{V}$ by leveraging the linearity of the expectation operator and the integral:\n$$\n\\langle \\bar{n}_{V} \\rangle = \\left\\langle \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x} \\right\\rangle = \\frac{1}{V} \\int_{V} \\langle n(\\mathbf{x}) \\rangle \\, d^{3}\\mathbf{x}\n$$\nSince the field is statistically stationary, the mean porosity $\\langle n(\\mathbf{x}) \\rangle = n$ is constant.\n$$\n\\langle \\bar{n}_{V} \\rangle = \\frac{1}{V} \\int_{V} n \\, d^{3}\\mathbf{x} = \\frac{n}{V} \\int_{V} d^{3}\\mathbf{x} = \\frac{n}{V} V = n\n$$\nThe variance is therefore $\\mathrm{Var}[\\bar{n}_{V}] = \\langle (\\bar{n}_{V} - n)^2 \\rangle$. Let us define the porosity fluctuation as $n'(\\mathbf{x}) = n(\\mathbf{x}) - n$. The term $(\\bar{n}_{V} - n)$ can be written as:\n$$\n\\bar{n}_{V} - n = \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x} - n = \\frac{1}{V} \\int_{V} (n(\\mathbf{x}) - n) \\, d^{3}\\mathbf{x} = \\frac{1}{V} \\int_{V} n'(\\mathbf{x}) \\, d^{3}\\mathbf{x}\n$$\nSubstituting this into the variance expression:\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\left\\langle \\left( \\frac{1}{V} \\int_{V} n'(\\mathbf{x}) \\, d^{3}\\mathbf{x} \\right)^2 \\right\\rangle = \\frac{1}{V^2} \\left\\langle \\left( \\int_{V} n'(\\mathbf{x}) \\, d^{3}\\mathbf{x} \\right) \\left( \\int_{V} n'(\\mathbf{y}) \\, d^{3}\\mathbf{y} \\right) \\right\\rangle\n$$\nThis can be written as a double integral:\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\left\\langle \\int_{V} \\int_{V} n'(\\mathbf{x}) n'(\\mathbf{y}) \\, d^{3}\\mathbf{x} \\, d^{3}\\mathbf{y} \\right\\rangle\n$$\nUsing the linearity of the expectation operator once more:\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{V} \\int_{V} \\langle n'(\\mathbf{x}) n'(\\mathbf{y}) \\rangle \\, d^{3}\\mathbf{x} \\, d^{3}\\mathbf{y}\n$$\nThe term $\\langle n'(\\mathbf{x}) n'(\\mathbf{y}) \\rangle$ is the definition of the two-point covariance function. Due to statistical stationarity, it depends only on the separation vector $\\mathbf{r} = \\mathbf{y} - \\mathbf{x}$. Thus, $\\langle n'(\\mathbf{x}) n'(\\mathbf{y}) \\rangle = C(\\mathbf{y}-\\mathbf{x})$.\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{V} \\int_{V} C(\\mathbf{y}-\\mathbf{x}) \\, d^{3}\\mathbf{x} \\, d^{3}\\mathbf{y}\n$$\nTo evaluate this six-dimensional integral in the limit of large volume $V$, we perform a change of variables. Let $\\mathbf{r} = \\mathbf{y} - \\mathbf{x}$ and $\\mathbf{s} = \\mathbf{x}$. The Jacobian of this transformation is unity. The domain of integration changes from $\\mathbf{x} \\in V, \\mathbf{y} \\in V$ to $\\mathbf{s} \\in V, \\mathbf{s}+\\mathbf{r} \\in V$. This is equivalent to $\\mathbf{s} \\in V \\cap V_{-\\mathbf{r}}$, where $V_{-\\mathbf{r}}$ is the volume $V$ shifted by vector $-\\mathbf{r}$.\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) \\left( \\int_{V \\cap V_{-\\mathbf{r}}} d^3\\mathbf{s} \\right) d^3\\mathbf{r}\n$$\nThe inner integral is the volume of the intersection of $V$ with itself shifted by $-\\mathbf{r}$, often denoted as the geometric factor $\\gamma_V(\\mathbf{r}) = \\mathrm{Vol}(V \\cap V_{-\\mathbf{r}})$.\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) \\gamma_V(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\nThe problem asks for an asymptotic scaling for large $L$. This corresponds to the case where the dimensions of the volume $V$ are much larger than the correlation length of the porosity field. The correlation length is the characteristic scale over which $C(\\mathbf{r})$ is significantly different from zero. The problem states that $C(\\mathbf{r})$ decays \"sufficiently fast\".\nFor values of $|\\mathbf{r}|$ much smaller than $L$, the intersection volume $\\gamma_V(\\mathbf{r})$ is approximately equal to $V$. As $|\\mathbf{r}|$ increases, $\\gamma_V(\\mathbf{r})$ decreases, becoming zero when the two volumes no longer overlap.\nSince $C(\\mathbf{r})$ decays rapidly, the main contribution to the integral comes from small $|\\mathbf{r}|$. In this region, we can approximate $\\gamma_V(\\mathbf{r}) \\approx V$. This approximation becomes exact in the limit $V \\to \\infty$.\n$$\n\\mathrm{Var}[\\bar{n}_{V}] \\approx \\frac{1}{V^2} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) V \\, d^3\\mathbf{r} = \\frac{1}{V} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\nUsing the given definition $\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}$, we arrive at the asymptotic scaling law for the variance:\n$$\n\\mathrm{Var}[\\bar{n}_{V}] \\approx \\frac{\\sigma_{0}^{2}}{V}\n$$\nThis result shows that the variance of the spatial average decays inversely with the averaging volume.\n\nNow, we use this scaling law to determine the minimum size $L$ for the REV. The criterion is:\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n}  \\epsilon\n$$\nThe minimum size $L$ is found by considering the equality limit:\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n} = \\epsilon\n$$\nSubstituting the asymptotic expression for the variance and $V = L^3$:\n$$\n\\frac{\\sqrt{\\sigma_{0}^{2}/L^3}}{n} = \\epsilon\n$$\nAssuming $\\sigma_{0} \\ge 0$ as $\\sigma_0^2$ is an integral of a generally non-negative covariance function:\n$$\n\\frac{\\sigma_{0} / L^{3/2}}{n} = \\epsilon\n$$\nWe now solve for $L$:\n$$\nL^{3/2} = \\frac{\\sigma_{0}}{n \\epsilon}\n$$\n$$\nL = \\left( \\frac{\\sigma_{0}}{n \\epsilon} \\right)^{2/3}\n$$\nThis is the minimum side length of the cubic REV. The problem requires substituting the given numerical values for $n$ and $\\epsilon$:\n$$\nn = 0.25, \\quad \\epsilon = 0.01\n$$\nThe product $n\\epsilon$ is:\n$$\nn \\epsilon = 0.25 \\times 0.01 = 0.0025 = \\frac{1}{400}\n$$\nSubstituting this into the expression for $L$:\n$$\nL = \\left( \\frac{\\sigma_{0}}{0.0025} \\right)^{2/3} = \\left( 400 \\sigma_{0} \\right)^{2/3}\n$$\nThis expression gives the minimum REV side length $L$ in meters, provided that the parameter $\\sigma_0$ is given in the corresponding SI unit of m$^{3/2}$.", "answer": "$$\n\\boxed{\\left(400 \\sigma_0\\right)^{2/3}}\n$$", "id": "3617636"}, {"introduction": "Solving the advection-dispersion equation computationally requires discretizing the continuous governing equations, a process that can introduce numerical artifacts. This exercise delves into one of the most common artifacts: numerical diffusion, which arises from simple upwind schemes for advection. Through a modified equation analysis [@problem_id:3617641], you will learn to quantify this artificial dispersion and understand how it can impact the accuracy of a simulation, a crucial skill for developing and interpreting computational transport models.", "problem": "Consider one-dimensional transport of a conservative solute in a homogeneous, saturated porous medium. The concentration field $C(x,t)$ obeys the advection–dispersion equation\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^{2} C}{\\partial x^{2}},\n$$\nwhere $v$ is the average pore velocity and $D$ is the physical hydrodynamic dispersion coefficient (including both molecular diffusion and mechanical dispersion). A common spatial discretization for the advective flux on a uniform grid of spacing $\\Delta x$ uses first-order upwind differencing, leading to a semi-discrete equation at grid index $i$ of the form\n$$\n\\frac{d C_{i}}{d t} + v\\,\\frac{C_{i} - C_{i-1}}{\\Delta x} = D\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}.\n$$\nUsing a modified equation analysis based on Taylor series expansions about $x_{i}$, derive the leading-order continuum equation that this semi-discrete scheme solves and identify the coefficient of the leading artificial diffusion term induced by the upwind discretization of the advective flux. Then, for a computational mesh with $\\Delta x = 0.050\\,\\text{m}$, average pore velocity $v = 1.2 \\times 10^{-4}\\,\\text{m}\\,\\text{s}^{-1}$, and physical hydrodynamic dispersion $D = 1.0 \\times 10^{-6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$, compute the numerical artificial diffusion induced by the upwind discretization and the ratio of this artificial diffusion to the physical dispersion.\n\nReport your final answer as the ordered pair $\\left(D_{\\text{num}},\\,D_{\\text{num}}/D\\right)$, where $D_{\\text{num}}$ is expressed in $\\text{m}^{2}\\,\\text{s}^{-1}$. Round your answer to three significant figures.", "solution": "The problem requires the derivation of the modified equation for a semi-discrete form of the one-dimensional advection-dispersion equation, the identification and calculation of the associated artificial diffusion, and the ratio of this artificial diffusion to the physical dispersion.\n\nThe governing partial differential equation (PDE) is:\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^{2} C}{\\partial x^{2}}\n$$\nThe provided semi-discrete finite difference approximation on a uniform grid with spacing $\\Delta x$ at grid node $i$ is:\n$$\n\\frac{d C_{i}}{d t} + v\\,\\frac{C_{i} - C_{i-1}}{\\Delta x} = D\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}\n$$\nHere, $C_{i}(t)$ is the approximation of the continuous concentration $C(x_i, t)$. The term $v\\,\\frac{C_{i} - C_{i-1}}{\\Delta x}$ is a first-order upwind difference approximation for the advection term $v\\,\\frac{\\partial C}{\\partial x}$ (assuming $v  0$), and $D\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}$ is a second-order central difference approximation for the dispersion term $D\\,\\frac{\\partial^{2} C}{\\partial x^{2}}$.\n\nTo derive the modified equation, we perform a Taylor series expansion of the discrete terms $C_{i-1}$ and $C_{i+1}$ around the point $x_i$, where we associate $C_i$ with the continuous function $C(x_i, t)$. Let $\\frac{\\partial^n C}{\\partial x^n} \\big|_{i}$ denote the $n$-th spatial derivative of $C$ evaluated at $(x_i, t)$.\n\nThe Taylor series expansions are:\n$$\nC_{i-1} = C(x_i - \\Delta x, t) = C_i - \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2!} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} - \\frac{\\Delta x^3}{3!} \\frac{\\partial^3 C}{\\partial x^3} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\n$$\nC_{i+1} = C(x_i + \\Delta x, t) = C_i + \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2!} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\frac{\\Delta x^3}{3!} \\frac{\\partial^3 C}{\\partial x^3} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\nNow, we substitute these expansions into the spatial difference terms of the semi-discrete equation.\n\nFirst, consider the advection term:\n$$\nv\\,\\frac{C_{i} - C_{i-1}}{\\Delta x} = v\\,\\frac{1}{\\Delta x} \\left[ C_i - \\left( C_i - \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} - \\dots \\right) \\right]\n$$\n$$\n= v\\,\\frac{1}{\\Delta x} \\left[ \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} - \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^3) \\right]\n$$\n$$\n= v \\frac{\\partial C}{\\partial x} \\bigg|_{i} - \\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^2)\n$$\nThe first term on the right-hand side, $v \\frac{\\partial C}{\\partial x} \\big|_{i}$, is the original advection term. The second term, $-\\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} \\big|_{i}$, is the leading-order truncation error, which has the form of a diffusion term.\n\nNext, consider the dispersion term:\n$$\nD\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}\n$$\nWe compute the numerator $C_{i+1} - 2 C_{i} + C_{i-1}$:\n$$\n\\left( C_i + \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\dots \\right) - 2C_i + \\left( C_i - \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} - \\dots \\right)\n$$\nCombining like terms, we get:\n$$\n(C_i - 2C_i + C_i) + (\\Delta x - \\Delta x)\\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\left(\\frac{\\Delta x^2}{2} + \\frac{\\Delta x^2}{2}\\right)\\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\n$$\n= \\Delta x^2 \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\nSo the discrete dispersion term becomes:\n$$\nD\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}} = D\\,\\frac{\\Delta x^2 \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)}{\\Delta x^{2}} = D \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^2)\n$$\nThis term approximates the physical dispersion term with second-order accuracy.\n\nNow, we substitute these continuous representations back into the semi-discrete equation, replacing $\\frac{dC_i}{dt}$ with $\\frac{\\partial C}{\\partial t}$:\n$$\n\\frac{\\partial C}{\\partial t} + \\left( v \\frac{\\partial C}{\\partial x} - \\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2) \\right) = D \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2)\n$$\nRearranging the terms to group derivatives of the same order, we obtain the modified equation:\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^2 C}{\\partial x^2} + \\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2)\n$$\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} = \\left( D + \\frac{v \\Delta x}{2} \\right) \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2)\n$$\nThis is the leading-order continuum equation that the numerical scheme actually solves. The scheme introduces an artificial diffusion (or numerical diffusion) term. The coefficient of this artificial diffusion, denoted $D_{\\text{num}}$, is the leading-order error term from the upwind discretization of advection.\nFrom the modified equation, we identify the artificial diffusion coefficient as:\n$$\nD_{\\text{num}} = \\frac{v \\Delta x}{2}\n$$\nThe total effective dispersion coefficient of the numerical scheme is $D_{\\text{eff}} = D + D_{\\text{num}}$.\n\nNow, we compute the numerical value of $D_{\\text{num}}$ and its ratio to the physical dispersion $D$ using the given values:\n$\\Delta x = 0.050\\,\\text{m}$\n$v = 1.2 \\times 10^{-4}\\,\\text{m}\\,\\text{s}^{-1}$\n$D = 1.0 \\times 10^{-6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n\nCalculation of $D_{\\text{num}}$:\n$$\nD_{\\text{num}} = \\frac{(1.2 \\times 10^{-4}\\,\\text{m}\\,\\text{s}^{-1}) \\times (0.050\\,\\text{m})}{2} = \\frac{6.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}}{2} = 3.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\nCalculation of the ratio $D_{\\text{num}}/D$:\n$$\n\\frac{D_{\\text{num}}}{D} = \\frac{3.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}}{1.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}} = 3.0\n$$\nThe problem asks for the answer to be rounded to three significant figures.\n$D_{\\text{num}} = 3.00 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}$\n$D_{\\text{num}}/D = 3.00$\n\nThe final answer is the ordered pair $(D_{\\text{num}},\\,D_{\\text{num}}/D)$.", "answer": "$$\n\\boxed{(3.00 \\times 10^{-6}, 3.00)}\n$$", "id": "3617641"}, {"introduction": "While forward modeling predicts outcomes from known parameters, a central challenge in geophysics is the inverse problem: inferring unknown subsurface properties from limited data. This capstone practice guides you through the construction of a complete Bayesian inversion framework to tackle this challenge for a complex transport model involving spatially variable sorption and mass transfer. By implementing a forward simulator and a linearized inversion [@problem_id:3617700], you will learn to assess the identifiability of parameters from breakthrough curve data, a critical step in designing effective field experiments and interpreting their results.", "problem": "You are asked to construct a complete, runnable program that performs a Bayesian inversion to assess the identifiability of spatially heterogeneous sorption and multi-rate mass transfer parameters from limited breakthrough curve data at multiple observation points in a one-dimensional porous medium. The underlying physics, forward simulator, and inversion must be derived from first principles of conservation of mass and Bayesian probability.\n\nConsider a one-dimensional domain of length $L$ discretized into $N$ control volumes with uniform spacing $\\Delta x = L/N$. Let the mobile aqueous concentration be $c_m(x,t)$, with an equilibrium linear sorption isotherm characterized by a spatially heterogeneous distribution coefficient $K_d(x)$ and a mobile-immobile mass exchange modeled as a two-rate Multi-Rate Mass Transfer (MRMT) process scaled by a spatially heterogeneous exchange coefficient $\\alpha(x)$. Assume a constant pore-water advective velocity $v$ and hydrodynamic dispersion coefficient $D$. The local mass balance for the mobile phase is governed by the following method-of-lines semi-discrete system derived from conservation of mass in each control volume:\n$$\n\\left(\\phi_m + \\rho_b K_d(x_i)\\right)\\,\\frac{d c_{m,i}}{dt}\n= - v\\,\\frac{c_{m,i}-c_{m,i-1}}{\\Delta x}\n+ D\\,\\frac{c_{m,i+1}-2c_{m,i}+c_{m,i-1}}{\\Delta x^2}\n- \\phi_{im}\\,\\sum_{k=1}^2 w_k\\,\\alpha_k(x_i)\\,\\left(c_{m,i}-c_{im,k,i}\\right),\n$$\nwhere $i \\in \\{0,\\dots,N-1\\}$ indexes the cell centers at positions $x_i = (i+0.5)\\,\\Delta x$, $\\phi_m$ is the mobile porosity, $\\phi_{im}$ is the immobile porosity, $\\rho_b$ is the bulk density, the MRMT employs two immobile domains with fixed nonnegative weights $w_1$ and $w_2$ satisfying $w_1+w_2=1$, and exchange rates $\\alpha_k(x_i)=r_k\\,\\alpha(x_i)$ with fixed multipliers $r_1$ and $r_2$. The immobile concentrations satisfy:\n$$\n\\frac{d c_{im,k,i}}{dt} = \\alpha_k(x_i)\\,\\left(c_{m,i} - c_{im,k,i}\\right), \\quad k\\in\\{1,2\\}.\n$$\nImpose a Dirichlet inlet condition at the left boundary $x=0$ with an injection of amplitude $c_{\\mathrm{inj}}$ over a finite duration $T_{\\mathrm{inj}}$,\n$$\nc_m(0,t) = \\begin{cases}\nc_{\\mathrm{inj}},  0 \\le t \\le T_{\\mathrm{inj}},\\\\\n0,  t  T_{\\mathrm{inj}},\n\\end{cases}\n$$\nand a zero-gradient condition at the right boundary $\\partial c_m/\\partial x |_{x=L}=0$. Initialize all concentrations at $t=0$ to zero. The spatial discretization should use an upwind scheme for the advective term and a centered scheme for the diffusive term. The temporal integration should treat the resulting semi-discrete system as a stiff system of ordinary differential equations.\n\nYou will parameterize the unknown fields through a log-parameter vector\n$$\n\\theta = \\left(\\log K_{d,0}, \\dots, \\log K_{d,N-1}, \\log \\alpha_0, \\dots, \\log \\alpha_{N-1}\\right) \\in \\mathbb{R}^{2N}.\n$$\nAssume a zero-mean Gaussian noise model for the observed data. Adopt a Gaussian prior on $\\theta$ with a squared-exponential (Gaussian) covariance kernel applied separately to the $K_d$ and $\\alpha$ blocks:\n$$\n\\mathrm{Cov}\\left(\\log K_{d,i}, \\log K_{d,j}\\right) = \\sigma_{\\log K}^2\\,\\exp\\!\\left(-\\frac{(x_i-x_j)^2}{2\\ell^2}\\right),\n\\quad\n\\mathrm{Cov}\\left(\\log \\alpha_i, \\log \\alpha_j\\right) = \\sigma_{\\log \\alpha}^2\\,\\exp\\!\\left(-\\frac{(x_i-x_j)^2}{2\\ell^2}\\right),\n$$\nand zero cross-covariance between $\\log K_d$ and $\\log \\alpha$. Let the prior mean be spatially constant at specified values for both $\\log K_d$ and $\\log \\alpha$. Use a first-order linearization of the forward map with respect to $\\theta$ evaluated at the prior mean and construct a Gaussian approximation to the posterior distribution. From that posterior, define an identifiability score for each of the two parameter groups $K_d$ and $\\alpha$ as the average shrinkage factor:\n$$\nS_{K_d} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\frac{\\sqrt{\\mathrm{Var}_{\\text{post}}(\\log K_{d,i})}}{\\sqrt{\\mathrm{Var}_{\\text{prior}}(\\log K_{d,i})}},\n\\qquad\nS_{\\alpha} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\frac{\\sqrt{\\mathrm{Var}_{\\text{post}}(\\log \\alpha_i)}}{\\sqrt{\\mathrm{Var}_{\\text{prior}}(\\log \\alpha_i)}}.\n$$\nDeclare the joint inversion identifiable if and only if both $S_{K_d}$ and $S_{\\alpha}$ are strictly less than a given threshold $\\tau$.\n\nYou must implement:\n- The forward simulator as a method-of-lines integrator for the above semi-discrete equations producing breakthrough curves at specified observation cells and times.\n- The linearized Bayesian inversion at the prior mean using a finite-difference Jacobian of the forward map with respect to $\\theta$.\n- The identifiability decision for each test case based on the shrinkage factors.\n\nUse the following physically plausible constants and their units:\n- Domain length $L = 1.0\\,\\mathrm{m}$, number of cells $N = 6$, grid is uniform with $\\Delta x = L/N$.\n- Pore-water velocity $v = 1.0\\times 10^{-4}\\,\\mathrm{m/s}$, dispersion $D = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$.\n- Mobile porosity $\\phi_m = 0.2$, immobile porosity $\\phi_{im} = 0.05$, bulk density $\\rho_b = 1500.0\\,\\mathrm{kg/m^3}$.\n- Injection amplitude $c_{\\mathrm{inj}} = 1.0$ (dimensionless concentration), two-rate MRMT multipliers $r_1 = 0.1$, $r_2 = 10.0$, and weights $w_1 = 0.3$, $w_2 = 0.7$ (with $w_1+w_2=1$).\n\nUse the following prior and numerical settings:\n- Prior means: $\\log K_d$ mean equal to $\\log(2.0\\times 10^{-4}\\,\\mathrm{m^3/kg})$ everywhere and $\\log \\alpha$ mean equal to $\\log(8.0\\times 10^{-6}\\,\\mathrm{s^{-1}})$ everywhere.\n- Prior standard deviations in log-space: $\\sigma_{\\log K} = 0.5$, $\\sigma_{\\log \\alpha} = 0.5$.\n- Squared-exponential kernel length-scale $\\ell = 0.3\\,\\mathrm{m}$.\n- Finite-difference step for the Jacobian in log-space $h = 1.0\\times 10^{-3}$.\n- Identifiability threshold $\\tau = 0.6$ (dimensionless).\n- For the temporal integrator, set the final time $T_{\\mathrm{end}}$ to match the largest observation time in each test and use a stiff integrator.\n\nGenerate synthetic “ground-truth” fields to define the data-generating scenario (these are used to define the test suite and do not need to be inverted explicitly because identifiability is assessed via the linearization at the prior mean but they anchor the physical plausibility of the test design):\n- True $K_d$ field (in $\\mathrm{m^3/kg}$): $[2.0\\times 10^{-4},\\, 2.0\\times 10^{-4},\\, 3.0\\times 10^{-4},\\, 3.0\\times 10^{-4},\\, 1.5\\times 10^{-4},\\, 1.5\\times 10^{-4}]$.\n- True $\\alpha$ field (in $\\mathrm{s^{-1}}$): $[8.0\\times 10^{-6},\\, 8.0\\times 10^{-6},\\, 5.0\\times 10^{-6},\\, 5.0\\times 10^{-6},\\, 1.0\\times 10^{-5},\\, 1.0\\times 10^{-5}]$.\n\nDefine the observation operator for each test case as follows: at specified observation cell indices (using $0$-based indexing), extract the mobile concentration $c_{m,i}(t)$ at specified times $t$ and stack them into a single data vector by looping first over observation points in their given order and, for each point, stacking its time series in chronological order.\n\nTest suite. Implement three distinct test cases designed to probe identifiability under different data limitations. For each case, specify the injection duration $T_{\\mathrm{inj}}$ in seconds, the observation cells, the number of observation times and their range, the noise standard deviation $\\sigma_n$ in the same units as concentration, and the identifiability threshold $\\tau$ to be used (the same $\\tau$ for all tests):\n1. Case A (limited spatial coverage, moderate noise): $T_{\\mathrm{inj}}=4000\\,\\mathrm{s}$; observation cells $[2,\\,5]$; $25$ evenly spaced observation times from $0\\,\\mathrm{s}$ to $40000\\,\\mathrm{s}$; $\\sigma_n=1.0\\times 10^{-2}$; $\\tau=0.6$.\n2. Case B (better spatial coverage, lower noise): $T_{\\mathrm{inj}}=8000\\,\\mathrm{s}$; observation cells $[1,\\,3,\\,5]$; $50$ evenly spaced observation times from $0\\,\\mathrm{s}$ to $40000\\,\\mathrm{s}$; $\\sigma_n=5.0\\times 10^{-3}$; $\\tau=0.6$.\n3. Case C (single far-downstream point, higher noise): $T_{\\mathrm{inj}}=4000\\,\\mathrm{s}$; observation cell $[5]$; $25$ evenly spaced observation times from $0\\,\\mathrm{s}$ to $40000\\,\\mathrm{s}$; $\\sigma_n=2.0\\times 10^{-2}$; $\\tau=0.6$.\n\nYour program must:\n- Construct the forward model once per Jacobian column perturbation and compute the finite-difference Jacobian of the observation vector with respect to $\\theta$ at the prior mean for each test case.\n- Assemble the Gaussian prior covariance for $\\theta$ using the specified kernel and hyperparameters.\n- Assemble the Gaussian noise covariance $\\sigma_n^2 I$.\n- Compute the Gaussian posterior covariance under a first-order linearization at the prior mean.\n- Compute $S_{K_d}$ and $S_{\\alpha}$ and return a boolean identifiability decision per case equal to $\\mathrm{True}$ if both shrinkage factors are strictly less than $\\tau$, and $\\mathrm{False}$ otherwise.\n\nFinal Output Format. Your program should produce a single line of output containing the identifiability decisions for the three test cases as a comma-separated Python-style list of booleans in the order [Case A, Case B, Case C], enclosed in square brackets (for example, $[\\mathrm{True},\\mathrm{False},\\mathrm{True}]$). No other text should be printed. Angles are not used. Units for all dimensional inputs must be as specified above; the identifiability booleans are dimensionless and require no units.", "solution": "The user requests a complete program to assess the identifiability of spatially heterogeneous sorption and mass transfer parameters in a one-dimensional solute transport model. The assessment is based on a linearized Bayesian inversion framework.\n\n### 1. Problem Validation\n\n**1.1. Givens Extraction**\n\n-   **Governing Equations (Method-of-Lines, cell $i$):**\n    -   Mobile phase:\n        $$\n        \\left(\\phi_m + \\rho_b K_d(x_i)\\right)\\,\\frac{d c_{m,i}}{dt}\n        = - v\\,\\frac{c_{m,i}-c_{m,i-1}}{\\Delta x}\n        + D\\,\\frac{c_{m,i+1}-2c_{m,i}+c_{m,i-1}}{\\Delta x^2}\n        - \\phi_{im}\\,\\sum_{k=1}^2 w_k\\,\\alpha_k(x_i)\\,\\left(c_{m,i}-c_{im,k,i}\\right)\n        $$\n    -   Immobile phase ($k \\in \\{1,2\\}$):\n        $$\n        \\frac{d c_{im,k,i}}{dt} = \\alpha_k(x_i)\\,\\left(c_{m,i} - c_{im,k,i}\\right), \\quad \\text{with } \\alpha_k(x_i) = r_k\\,\\alpha(x_i)\n        $$\n\n-   **Domain and Discretization:**\n    -   Length $L = 1.0\\,\\mathrm{m}$\n    -   Number of cells $N = 6$\n    -   Grid spacing $\\Delta x = L/N$\n    -   Cell centers $x_i = (i+0.5)\\,\\Delta x$ for $i \\in \\{0, \\dots, N-1\\}$.\n\n-   **Boundary and Initial Conditions:**\n    -   Inlet (Dirichlet, $x=0$): $c_m(0,t) = c_{\\mathrm{inj}}$ for $0 \\le t \\le T_{\\mathrm{inj}}$, and $0$ for $t  T_{\\mathrm{inj}}$.\n    -   Outlet (Neumann, $x=L$): $\\partial c_m/\\partial x |_{x=L}=0$.\n    -   Initial ($t=0$): All concentrations are zero.\n\n-   **Physical and Model Constants:**\n    -   Velocity $v = 1.0\\times 10^{-4}\\,\\mathrm{m/s}$\n    -   Dispersion $D = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$\n    -   Mobile porosity $\\phi_m = 0.2$\n    -   Immobile porosity $\\phi_{im} = 0.05$\n    -   Bulk density $\\rho_b = 1500.0\\,\\mathrm{kg/m^3}$\n    -   Injection concentration $c_{\\mathrm{inj}} = 1.0$ (dimensionless)\n    -   MRMT rates: $r_1 = 0.1$, $r_2 = 10.0$\n    -   MRMT weights: $w_1 = 0.3$, $w_2 = 0.7$\n\n-   **Parameterization and Inversion:**\n    -   Parameter vector: $\\theta = \\left(\\log K_{d,0}, \\dots, \\log K_{d,N-1}, \\log \\alpha_0, \\dots, \\log \\alpha_{N-1}\\right) \\in \\mathbb{R}^{2N}$.\n    -   Prior means: $\\mathbb{E}[\\log K_d(x)] = \\log(2.0\\times 10^{-4})$, $\\mathbb{E}[\\log \\alpha(x)] = \\log(8.0\\times 10^{-6})$.\n    -   Prior covariance: Squared-exponential kernel with $\\sigma_{\\log K} = 0.5$, $\\sigma_{\\log \\alpha} = 0.5$, and length-scale $\\ell = 0.3\\,\\mathrm{m}$. Zero cross-covariance.\n    -   Data noise: Zero-mean Gaussian with standard deviation $\\sigma_n$.\n    -   Numerical: FD step for Jacobian $h = 1.0\\times 10^{-3}$.\n\n-   **Identifiability Metric:**\n    -   Shrinkage factors: $S_{K_d} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\frac{\\sqrt{\\mathrm{Var}_{\\text{post}}(\\log K_{d,i})}}{\\sqrt{\\mathrm{Var}_{\\text{prior}}(\\log K_{d,i})}}$, $S_{\\alpha} = \\frac{1}{N}\\sum_{i=0}^{N-1} \\frac{\\sqrt{\\mathrm{Var}_{\\text{post}}(\\log \\alpha_i)}}{\\sqrt{\\mathrm{Var}_{\\text{prior}}(\\log \\alpha_i)}}$.\n    -   Decision threshold: $\\tau = 0.6$.\n    -   Identifiable if and only if $S_{K_d}  \\tau$ and $S_{\\alpha}  \\tau$.\n\n-   **Test Cases:**\n    1.  **Case A:** $T_{\\mathrm{inj}}=4000\\,\\mathrm{s}$, obs. cells $[2, 5]$, $25$ times on $[0, 40000]\\,\\mathrm{s}$, $\\sigma_n=1.0\\times 10^{-2}$.\n    2.  **Case B:** $T_{\\mathrm{inj}}=8000\\,\\mathrm{s}$, obs. cells $[1, 3, 5]$, $50$ times on $[0, 40000]\\,\\mathrm{s}$, $\\sigma_n=5.0\\times 10^{-3}$.\n    3.  **Case C:** $T_{\\mathrm{inj}}=4000\\,\\mathrm{s}$, obs. cell $[5]$, $25$ times on $[0, 40000]\\,\\mathrm{s}$, $\\sigma_n=2.0\\times 10^{-2}$.\n\n**1.2. Validation of Givens**\n\n-   **Scientifically Grounded:** The problem is based on the advection-dispersion-reaction equation, a fundamental model in transport phenomena. The inclusion of linear sorption and multi-rate mass transfer (MRMT) represents standard, well-established physics in hydrogeology.\n-   **Well-Posed:** The system of partial differential equations is supplied with well-defined initial and boundary conditions. The inversion methodology, a linearized Bayesian update, is a standard technique for parameter estimation and uncertainty quantification. The problem is specified in sufficient detail to permit a unique computational solution.\n-   **Objective:** All parameters, equations, and conditions are stated quantitatively and precisely, with no subjective or ambiguous language.\n-   **Completeness and Consistency:** The problem is self-contained. It provides all necessary physical constants, model parameters, numerical settings, and test case definitions to construct a full solution. There are no apparent contradictions.\n-   **Realism:** The provided physical constants are plausible for a laboratory-scale column experiment in hydrogeology.\n\n**1.3. Verdict**\n\nThe problem is **valid**. It is a complex but rigorously defined computational science task that is scientifically sound, internally consistent, and fully specified.\n\n### 2. Solution Design\n\nThe solution is implemented by following a structured, principle-based approach.\n\n**2.1. Forward Model**\n\nThe heart of the solution is a forward simulator that solves the governing equations. We use the Method of Lines, which converts the system of partial differential equations (PDEs) into a large system of coupled ordinary differential equations (ODEs) in time.\n\n-   **State Vector:** The state of the system at any time $t$ is described by a vector $y(t)$ containing the mobile and immobile concentrations for all $N$ cells:\n    $$\n    y(t) = [c_{m,0}, \\dots, c_{m,N-1}, c_{im,1,0}, \\dots, c_{im,1,N-1}, c_{im,2,0}, \\dots, c_{im,2,N-1}]^T \\in \\mathbb{R}^{3N}.\n    $$\n-   **ODE System Function `dydt(t, y)`:** This function computes the time derivative of the state vector, $dy/dt$.\n    -   **Discretization:** The spatial derivatives are approximated using finite differences as specified.\n        -   Advection: First-order upwind scheme. At cell $i$, the term is $- v (c_{m,i} - c_{m,i-1}) / \\Delta x$. For the first cell ($i=0$), $c_{m,-1}$ is replaced by the time-dependent boundary concentration $c_{\\mathrm{inj}}(t)$.\n        -   Dispersion: Second-order centered scheme. At cell $i$, the term is $D (c_{m,i+1} - 2c_{m,i} + c_{m,i-1}) / \\Delta x^2$. The boundary conditions are handled using ghost points:\n            -   At the inlet ($i=0$), $c_{m,-1}$ is set to $c_{\\mathrm{inj}}(t)$.\n            -   At the outlet ($i=N-1$), the zero-gradient condition $\\partial c_m/\\partial x = 0$ is implemented by setting the ghost point concentration $c_{m,N} = c_{m,N-1}$.\n    -   **Right-Hand Side (RHS) Assembly:** For each cell $i$, the derivatives $dc_{m,i}/dt$, $dc_{im,1,i}/dt$, and $dc_{im,2,i}/dt$ are calculated. The change in mobile concentration, $dc_{m,i}/dt$, is scaled by the inverse of the retardation factor, $1/(\\phi_m + \\rho_b K_{d,i})$.\n-   **Temporal Integration:** The resulting ODE system is stiff due to the different timescales of advection, dispersion, and multi-rate mass transfer. We employ a suitable implicit integrator, `scipy.integrate.solve_ivp` with `method='BDF'`, to solve the system from $t=0$ to $T_{\\mathrm{end}}$.\n\n**2.2. Bayesian Inversion Framework**\n\nThe identifiability is assessed using a linearized Gaussian approximation to the Bayesian posterior distribution.\n\n-   **Parameter Vector:** The $2N$ unknown parameters are the log-transformed distribution coefficients and mass transfer rates, $\\theta = (\\log K_d, \\log \\alpha)$.\n-   **Prior Distribution:** A Gaussian prior $p(\\theta) \\sim \\mathcal{N}(\\theta_{\\text{mean}}, C_{\\text{prior}})$ is assumed.\n    -   The prior mean $\\theta_{\\text{mean}}$ is based on the provided constant mean values.\n    -   The prior covariance matrix $C_{\\text{prior}}$ is a block-diagonal matrix. The two blocks, for $\\log K_d$ and $\\log \\alpha$, are constructed using the specified squared-exponential kernel, which introduces spatial correlation among the parameters. Diagonal elements are $\\mathrm{Var}_{\\text{prior}}(\\log K_{d,i}) = \\sigma_{\\log K}^2$ and $\\mathrm{Var}_{\\text{prior}}(\\log \\alpha_i) = \\sigma_{\\log \\alpha}^2$.\n-   **Likelihood and Linearization:** The observation model is $d = G(\\theta) + \\epsilon$, where $G$ is the forward model mapping parameters to observations, and $\\epsilon \\sim \\mathcal{N}(0, C_{\\text{noise}})$ is the measurement noise. $C_{\\text{noise}} = \\sigma_n^2 I$. By linearizing $G$ around the prior mean $\\theta_{\\text{mean}}$, we get $d \\approx G(\\theta_{\\text{mean}}) + J (\\theta - \\theta_{\\text{mean}}) + \\epsilon$, where $J = \\nabla_\\theta G|_{\\theta_{\\text{mean}}}$ is the Jacobian (sensitivity) matrix.\n-   **Jacobian Matrix ($J$):** The Jacobian relates changes in the parameters to changes in the observations. It is computed numerically using a central finite-difference scheme. Each column $j$ of the Jacobian is approximated by:\n    $$\n    J_{\\cdot, j} = \\frac{G(\\theta_{\\text{mean}} + h e_j) - G(\\theta_{\\text{mean}} - h e_j)}{2h}\n    $$\n    where $e_j$ is the $j$-th standard basis vector and $h$ is a small perturbation size. This requires $2 \\times (2N)$ runs of the forward model for each test case's observation setup.\n-   **Posterior Covariance:** Under the linear-Gaussian assumption, the posterior distribution is also Gaussian, with a covariance matrix given by:\n    $$\n    C_{\\text{post}} = \\left( J^T C_{\\text{noise}}^{-1} J + C_{\\text{prior}}^{-1} \\right)^{-1}\n    $$\n    This matrix quantifies the uncertainty in the parameters after conditioning on the data.\n\n**2.3. Identifiability Analysis**\n\n-   **Shrinkage Factor:** The degree of parameter identifiability is measured by the \"shrinkage factor,\" which is the average ratio of the posterior standard deviation to the prior standard deviation for a group of parameters. A value close to $0$ indicates high identifiability (large uncertainty reduction), while a value close to $1$ indicates poor identifiability (little to no uncertainty reduction).\n    $$\n    S_{K_d} = \\frac{1}{N \\sigma_{\\log K}} \\sum_{i=0}^{N-1} \\sqrt{(C_{\\text{post}})_{i,i}} \\qquad\n    S_{\\alpha} = \\frac{1}{N \\sigma_{\\log \\alpha}} \\sum_{i=0}^{N-1} \\sqrt{(C_{\\text{post}})_{N+i, N+i}}\n    $$\n-   **Decision:** For each test case, the joint inversion is deemed identifiable if and only if both shrinkage factors, $S_{K_d}$ and $S_{\\alpha}$, are strictly less than the specified threshold $\\tau = 0.6$. The program computes these factors for each case and returns the corresponding boolean decision.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.linalg import block_diag\n\ndef solve():\n    \"\"\"\n    Performs a Bayesian inversion to assess the identifiability of solute transport parameters.\n    \"\"\"\n    # 1. DEFINE CONSTANTS AND DOMAIN\n    L = 1.0  # m\n    N = 6    # number of cells\n    dx = L / N # m\n    x_centers = (np.arange(N) + 0.5) * dx # m\n\n    # Physical parameters\n    v = 1.0e-4  # m/s\n    D = 1.0e-6  # m^2/s\n    phi_m = 0.2\n    phi_im = 0.05\n    rho_b = 1500.0  # kg/m^3\n    c_inj_val = 1.0\n\n    # MRMT parameters\n    r1, r2 = 0.1, 10.0\n    w1, w2 = 0.3, 0.7\n\n    # 2. DEFINE PRIOR AND NUMERICAL SETTINGS\n    log_Kd_mean_val = np.log(2.0e-4) # m^3/kg\n    log_alpha_mean_val = np.log(8.0e-6) # s^-1\n    sigma_logK = 0.5\n    sigma_logA = 0.5\n    ell = 0.3  # m\n    fd_h = 1.0e-3\n    tau = 0.6\n\n    theta_mean = np.concatenate([\n        np.full(N, log_Kd_mean_val),\n        np.full(N, log_alpha_mean_val)\n    ])\n\n    # 3. DEFINE TEST CASES\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"T_inj\": 4000.0, \"obs_cells\": [2, 5],\n            \"n_times\": 25, \"T_end\": 40000.0, \"sigma_n\": 1.0e-2\n        },\n        {\n            \"name\": \"Case B\",\n            \"T_inj\": 8000.0, \"obs_cells\": [1, 3, 5],\n            \"n_times\": 50, \"T_end\": 40000.0, \"sigma_n\": 5.0e-3\n        },\n        {\n            \"name\": \"Case C\",\n            \"T_inj\": 4000.0, \"obs_cells\": [5],\n            \"n_times\": 25, \"T_end\": 40000.0, \"sigma_n\": 2.0e-2\n        }\n    ]\n\n    # 4. HELPER FUNCTIONS\n    def build_C_prior(N, dx, sigma_logK, sigma_logA, l):\n        \"\"\"Builds the prior covariance matrix.\"\"\"\n        x_coords = (np.arange(N) + 0.5) * dx\n        dist_matrix = np.abs(x_coords[:, np.newaxis] - x_coords[np.newaxis, :])\n        \n        C_kd = (sigma_logK**2) * np.exp(-dist_matrix**2 / (2 * l**2))\n        C_alpha = (sigma_logA**2) * np.exp(-dist_matrix**2 / (2 * l**2))\n        \n        return block_diag(C_kd, C_alpha)\n\n    def odefun(t, y, theta, p):\n        \"\"\"Defines the ODE system dy/dt = f(t, y).\"\"\"\n        # Unpack parameters\n        c_m = y[0:p['N']]\n        c_im1 = y[p['N']:2*p['N']]\n        c_im2 = y[2*p['N']:3*p['N']]\n        \n        log_Kd = theta[0:p['N']]\n        log_alpha = theta[p['N']:2*p['N']]\n        K_d = np.exp(log_Kd)\n        alpha = np.exp(log_alpha)\n\n        # Inlet boundary condition\n        c_in = p['c_inj_val'] if t = p['T_inj'] else 0.0\n\n        # --- Vectorized calculation of dc_m/dt ---\n        # Advection term (upwind)\n        c_m_upwind = np.roll(c_m, 1)\n        c_m_upwind[0] = c_in\n        advection_term = -p['v'] * (c_m - c_m_upwind) / p['dx']\n\n        # Diffusion term (centered) with ghost points\n        c_m_prev = np.roll(c_m, 1)\n        c_m_prev[0] = c_in\n        c_m_next = np.roll(c_m, -1)\n        c_m_next[-1] = c_m[-1]  # Zero-gradient BC\n        diffusion_term = p['D'] * (c_m_next - 2 * c_m + c_m_prev) / p['dx']**2\n\n        # MRMT term\n        alpha1 = p['r1'] * alpha\n        alpha2 = p['r2'] * alpha\n        mrmt_term = -p['phi_im'] * (p['w1'] * alpha1 * (c_m - c_im1) + \\\n                                    p['w2'] * alpha2 * (c_m - c_im2))\n        \n        # Retardation factor\n        retardation = p['phi_m'] + p['rho_b'] * K_d\n        \n        dc_m_dt = (advection_term + diffusion_term + mrmt_term) / retardation\n        \n        # --- Vectorized calculation of dc_im/dt ---\n        dc_im1_dt = alpha1 * (c_m - c_im1)\n        dc_im2_dt = alpha2 * (c_m - c_im2)\n        \n        return np.concatenate([dc_m_dt, dc_im1_dt, dc_im2_dt])\n\n    def run_forward_model(theta, case_params, model_params):\n        \"\"\"Runs the forward model for a given parameter set theta.\"\"\"\n        p_all = {**case_params, **model_params}\n        \n        y0 = np.zeros(3 * N)\n        obs_times = np.linspace(0, case_params['T_end'], case_params['n_times'])\n        \n        sol = solve_ivp(\n            odefun,\n            (0, case_params['T_end']),\n            y0,\n            method='BDF',\n            t_eval=obs_times,\n            args=(theta, p_all)\n        )\n        \n        c_m_sol = sol.y[0:N, :]\n        \n        observations = []\n        for cell_idx in case_params['obs_cells']:\n            observations.append(c_m_sol[cell_idx, :])\n            \n        return np.concatenate(observations)\n\n    # 5. MAIN LOOP OVER TEST CASES\n    results = []\n    C_prior = build_C_prior(N, dx, sigma_logK, sigma_logA, ell)\n    C_prior_inv = np.linalg.inv(C_prior)\n    \n    model_params = {\n        'L': L, 'N': N, 'dx': dx, 'v': v, 'D': D, 'phi_m': phi_m,\n        'phi_im': phi_im, 'rho_b': rho_b, 'c_inj_val': c_inj_val,\n        'r1': r1, 'r2': r2, 'w1': w1, 'w2': w2\n    }\n\n    for case in test_cases:\n        # Compute Jacobian J\n        num_params = 2 * N\n        num_obs = len(case['obs_cells']) * case['n_times']\n        J = np.zeros((num_obs, num_params))\n        \n        for j in range(num_params):\n            theta_plus = theta_mean.copy()\n            theta_plus[j] += fd_h\n            \n            theta_minus = theta_mean.copy()\n            theta_minus[j] -= fd_h\n            \n            obs_plus = run_forward_model(theta_plus, case, model_params)\n            obs_minus = run_forward_model(theta_minus, case, model_params)\n            \n            J[:, j] = (obs_plus - obs_minus) / (2 * fd_h)\n\n        # Compute posterior covariance C_post\n        C_noise_inv = np.eye(num_obs) / (case['sigma_n']**2)\n        C_post_inv = J.T @ C_noise_inv @ J + C_prior_inv\n        C_post = np.linalg.inv(C_post_inv)\n        \n        # Compute shrinkage factors\n        post_std_devs = np.sqrt(np.diag(C_post))\n        \n        S_Kd = np.mean(post_std_devs[0:N]) / sigma_logK\n        S_alpha = np.mean(post_std_devs[N:2*N]) / sigma_logA\n        \n        # Identifiability decision\n        is_identifiable = (S_Kd  tau) and (S_alpha  tau)\n        results.append(is_identifiable)\n\n    # 6. PRINT FINAL RESULTS\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3617700"}]}