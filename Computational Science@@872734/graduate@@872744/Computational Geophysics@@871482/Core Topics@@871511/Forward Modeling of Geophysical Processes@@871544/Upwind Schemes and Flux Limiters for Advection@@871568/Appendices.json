{"hands_on_practices": [{"introduction": "Before any explicit numerical scheme can be considered useful for simulating physical phenomena, it must be proven to be stable. This foundational exercise guides you through a von Neumann stability analysis to derive the renowned Courant-Friedrichs-Lewy (CFL) condition for the first-order upwind scheme [@problem_id:3618319]. Understanding this derivation is an essential prerequisite for building and analyzing more complex, high-resolution methods for advection problems.", "problem": "A one-dimensional passive tracer in a geophysical flow is modeled by the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a0$. Consider a uniform spatial grid with spacing $\\Delta x$ and explicit time marching using the forward Euler method. For $a0$, the first-order upwind spatial discretization uses the left-biased difference. Assume a spatially periodic domain so that Fourier modes are admissible.\n\nStarting from the continuous equation and the discrete update that results from forward Euler in time and first-order upwind in space, analyze the amplification of a single Fourier mode and derive the stability requirement that the time step $\\Delta t$ must satisfy so that the numerical solution remains bounded for all wavenumbers. Then, using the derived condition, compute the maximum allowable time step for $a = 1$ m/s and $\\Delta x = 100$ m. Express the final time step in seconds and round your answer to four significant figures.", "solution": "The problem requires the derivation of the stability condition for a numerical scheme applied to the linear advection equation, and subsequently, the calculation of a maximum allowable time step for given parameters.\n\nThe governing partial differential equation (PDE) is the one-dimensional linear advection equation:\n$$ u_t + a u_x = 0 $$\nwhere $u(x, t)$ is the concentration of a passive tracer at position $x$ and time $t$, and $a$ is the constant wave speed, given as $a  0$.\n\nWe discretize this equation on a uniform grid where $x_j = j \\Delta x$ and $t^n = n \\Delta t$. Let $u_j^n$ denote the numerical approximation of $u(x_j, t^n)$.\n\nThe time derivative $u_t$ is discretized using the explicit forward Euler method:\n$$ u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t} $$\nThe spatial derivative $u_x$ is discretized using the first-order upwind scheme. Since the wave speed $a$ is positive ($a0$), the \"upwind\" direction is to the left (in the direction of decreasing $x$). This corresponds to a first-order backward difference:\n$$ u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x} $$\nSubstituting these discrete approximations into the PDE gives the finite difference equation:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0 $$\nWe can rearrange this equation to solve for the solution at the next time step, $u_j^{n+1}$:\n$$ u_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( u_j^n - u_{j-1}^n \\right) $$\nIt is standard to define the Courant number, $C$, as the non-dimensional ratio:\n$$ C = \\frac{a \\Delta t}{\\Delta x} $$\nUsing the Courant number, the update scheme becomes:\n$$ u_j^{n+1} = u_j^n - C (u_j^n - u_{j-1}^n) = (1 - C) u_j^n + C u_{j-1}^n $$\nTo analyze the stability of this scheme, we perform a von Neumann stability analysis. We consider the behavior of a single Fourier mode of the solution, which can be written in the form:\n$$ u_j^n = \\hat{u}^n(k) e^{i k x_j} $$\nwhere $k$ is the wavenumber, $i = \\sqrt{-1}$, and $\\hat{u}^n(k)$ is the amplitude of the mode at time step $n$. Substituting this into the discrete equation yields:\n$$ \\hat{u}^{n+1} e^{i k x_j} = (1 - C) \\hat{u}^n e^{i k x_j} + C \\hat{u}^n e^{i k x_{j-1}} $$\nSince $x_{j-1} = x_j - \\Delta x$, we have $e^{i k x_{j-1}} = e^{i k (x_j - \\Delta x)} = e^{i k x_j} e^{-i k \\Delta x}$. Substituting this and dividing the entire equation by the common factor $e^{i k x_j}$ (which is non-zero), we get:\n$$ \\hat{u}^{n+1} = (1 - C) \\hat{u}^n + C \\hat{u}^n e^{-i k \\Delta x} $$\nThe amplification factor, $G(k)$, is defined as the ratio of the amplitudes at successive time steps, $G(k) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n}$:\n$$ G(k) = 1 - C + C e^{-i k \\Delta x} $$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber $k$. That is, $|G(k)| \\le 1$.\nLet's analyze the magnitude of $G(k)$. Using Euler's formula, $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$, with $\\theta = k \\Delta x$:\n$$ G(k) = (1 - C) + C (\\cos(k \\Delta x) - i \\sin(k \\Delta x)) $$\n$$ G(k) = [1 - C + C \\cos(k \\Delta x)] - i [C \\sin(k \\Delta x)] $$\nThe squared magnitude of $G(k)$ is the sum of the squares of its real and imaginary parts:\n$$ |G(k)|^2 = [1 - C + C \\cos(k \\Delta x)]^2 + [-C \\sin(k \\Delta x)]^2 $$\n$$ |G(k)|^2 = (1-C)^2 + 2C(1-C)\\cos(k\\Delta x) + C^2\\cos^2(k\\Delta x) + C^2\\sin^2(k\\Delta x) $$\nUsing the identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$ |G(k)|^2 = (1-C)^2 + 2C(1-C)\\cos(k\\Delta x) + C^2 $$\n$$ |G(k)|^2 = (1 - 2C + C^2) + 2C\\cos(k\\Delta x) - 2C^2\\cos(k\\Delta x) + C^2 $$\n$$ |G(k)|^2 = 1 - 2C + 2C^2 + (2C - 2C^2)\\cos(k\\Delta x) $$\n$$ |G(k)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos(k\\Delta x) = 1 + 2C(1-C)(\\cos(k\\Delta x) - 1) $$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get $\\cos(k\\Delta x) - 1 = -2\\sin^2(k\\Delta x/2)$.\n$$ |G(k)|^2 = 1 - 4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\nThe stability condition is $|G(k)|^2 \\le 1$. Applying this to our expression:\n$$ 1 - 4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 1 $$\n$$ -4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 0 $$\n$$ C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\ge 0 $$\nThe term $\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)$ is always non-negative for any real $k$ and $\\Delta x$. The Courant number $C = \\frac{a \\Delta t}{\\Delta x}$ is also non-negative, since $a  0$, $\\Delta t  0$, and $\\Delta x  0$. Therefore, for the inequality to hold, we must have:\n$$ 1 - C \\ge 0 \\implies C \\le 1 $$\nThus, the stability requirement for the first-order upwind scheme with forward Euler time stepping is $0 \\le C \\le 1$. This is the Courant-Friedrichs-Lewy (CFL) condition for this particular scheme.\n$$ \\frac{a \\Delta t}{\\Delta x} \\le 1 $$\nThis implies that the time step $\\Delta t$ must satisfy:\n$$ \\Delta t \\le \\frac{\\Delta x}{a} $$\nThe maximum allowable time step, $\\Delta t_{\\text{max}}$, is obtained when the equality holds:\n$$ \\Delta t_{\\text{max}} = \\frac{\\Delta x}{a} $$\nThe problem provides the following values:\n$$ a = 1 \\text{ m/s} $$\n$$ \\Delta x = 100 \\text{ m} $$\nSubstituting these values into the expression for the maximum time step:\n$$ \\Delta t_{\\text{max}} = \\frac{100 \\text{ m}}{1 \\text{ m/s}} = 100 \\text{ s} $$\nThe problem requires the answer to be expressed in seconds and rounded to four significant figures. The calculated value is exactly $100$. To represent this with four significant figures, we write it as $100.0$.", "answer": "$$\n\\boxed{100.0}\n$$", "id": "3618319"}, {"introduction": "While the first-order upwind scheme is stable under the CFL condition, it suffers from significant numerical diffusion, which smears out sharp features common in geophysical flows. To achieve higher accuracy, we turn to second-order Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) that use flux limiters to control oscillations. This hands-on practice [@problem_id:3618311] demystifies the procedure by providing a concrete, step-by-step calculation, showing how components like the smoothness indicator $r$, the limiter function $\\phi(r)$, and slope reconstruction work together in a conservative update.", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ for a non-dimensional passive tracer $u(x,t)$ advected by a constant positive velocity $a0$ along a straight transect in a computational geophysics setting. Assume a conservative finite-volume semi-discrete formulation on a uniform grid with cell averages $u_{i}(t)$ located at cell centers $x_{i}$ and cell size $\\Delta x$, advanced in time with an explicit step $\\Delta t$.\n\nStarting from the conservation law and a consistent upwind Godunov flux for $a0$, employ a second-order Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) piecewise-linear reconstruction with a total variation diminishing flux limiter. Use the van Leer limiter defined by\n$$\n\\phi(r) = \\frac{r + |r|}{1 + |r|}.\n$$\nDefine the local smoothness indicator at cell $i$ by the ratio\n$$\nr_{i} = \\frac{u_{i}^{n} - u_{i-1}^{n}}{u_{i+1}^{n} - u_{i}^{n}},\n$$\nand construct a limited slope in cell $i$ using $\\phi(r_{i})$. For $a0$, reconstruct the left state at interface $x_{i+1/2}$ from cell $i$, and similarly reconstruct the left state at $x_{i-1/2}$ from cell $i-1$, then update $u_{i}$ via the conservative flux difference.\n\nGiven the following numerically plausible data at time level $n$:\n- Advection speed $a = 1.5$,\n- Grid spacing $\\Delta x = 10$,\n- Time step $\\Delta t = 4$,\n- Neighboring cell averages $u_{i-2}^{n} = 0.80$, $u_{i-1}^{n} = 1.00$, $u_{i}^{n} = 1.10$, $u_{i+1}^{n} = 0.90$,\n\nderive, from first principles, the finite-volume interface reconstructions implied by the MUSCL strategy with the van Leer limiter, compute $r_{i}$ and the limited slope controlling the interface $x_{i+1/2}$ for $a0$, form the upwind numerical fluxes, and perform one explicit update of $u_{i}$ to obtain $u_{i}^{n+1}$. Report the final updated value $u_{i}^{n+1}$ as a pure number without units. If you choose to approximate, round your answer to six significant figures; otherwise, provide an exact value.", "solution": "The problem requires the computation of an updated cell average, $u_{i}^{n+1}$, using a second-order MUSCL finite-volume scheme for the linear advection equation $u_{t} + a\\,u_{x} = 0$.\n\nThe finite-volume method updates the cell average $u_i$ according to the conservative semi-discrete form:\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\nwhere $F_{i \\pm 1/2}$ are the numerical fluxes at the cell interfaces $x_{i \\pm 1/2}$. Using an explicit forward Euler time step $\\Delta t$, the fully discrete update is:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2}^n - F_{i-1/2}^n)\n$$\nThe physical flux function is $f(u) = a u$. Since the advection velocity $a  0$, the information propagates from left to right. The upwind Godunov flux at an interface is determined by the state on the left side of the interface, denoted $u^L$. Thus, the numerical fluxes are:\n$$\nF_{i+1/2}^n = f(u_{i+1/2}^L) = a u_{i+1/2}^L\n$$\n$$\nF_{i-1/2}^n = f(u_{i-1/2}^L) = a u_{i-1/2}^L\n$$\nSubstituting these into the update formula yields:\n$$\nu_i^{n+1} = u_i^n - \\frac{a \\Delta t}{\\Delta x} (u_{i+1/2}^L - u_{i-1/2}^L)\n$$\nThe term $C = \\frac{a \\Delta t}{\\Delta x}$ is the Courant number.\n\nThe Monotone Upstream-centered Schemes for Conservation Laws (MUSCL) approach achieves second-order accuracy by reconstructing a piecewise-linear solution within each cell at time $t^n$. In a generic cell $j$, the solution is approximated as:\n$$\nu(x) = u_j^n + s_j (x - x_j) = u_j^n + \\frac{\\sigma_j}{\\Delta x} (x - x_j)\n$$\nwhere $x_j$ is the center of cell $j$, $s_j$ is the slope, and $\\sigma_j = s_j \\Delta x$ is the limited variation across the cell.\n\nThe upwind state $u_{i+1/2}^L$ is the value at the right boundary of cell $i$, reconstructed using the data from cell $i$:\n$$\nu_{i+1/2}^L = u(x_{i+1/2}) = u_i^n + \\frac{\\sigma_i}{\\Delta x}(x_{i+1/2} - x_i) = u_i^n + \\frac{\\sigma_i}{\\Delta x}\\left(\\frac{\\Delta x}{2}\\right) = u_i^n + \\frac{1}{2}\\sigma_i\n$$\nSimilarly, the upwind state $u_{i-1/2}^L$ is the value at the right boundary of cell $i-1$, reconstructed using data from cell $i-1$:\n$$\nu_{i-1/2}^L = u(x_{i-1/2}) = u_{i-1}^n + \\frac{\\sigma_{i-1}}{\\Delta x}(x_{i-1/2} - x_{i-1}) = u_{i-1}^n + \\frac{\\sigma_{i-1}}{\\Delta x}\\left(\\frac{\\Delta x}{2}\\right) = u_{i-1}^n + \\frac{1}{2}\\sigma_{i-1}\n$$\n\nTo maintain stability and prevent spurious oscillations, the variation $\\sigma_j$ is limited. The problem specifies the van Leer flux limiter. The limited variation $\\sigma_j$ is constructed using the smoothness indicator $r_j$ and the limiter function $\\phi(r)$:\n$$\nr_j = \\frac{u_j^n - u_{j-1}^n}{u_{j+1}^n - u_j^n}\n$$\n$$\n\\phi(r) = \\frac{r + |r|}{1 + |r|}\n$$\nThe limited variation in cell $j$ is computed as $\\sigma_j = \\phi(r_j)(u_{j+1}^n - u_j^n)$.\n\nNow, we apply this framework to the given data:\n- Advection speed: $a = 1.5$\n- Grid spacing: $\\Delta x = 10$\n- Time step: $\\Delta t = 4$\n- Cell averages: $u_{i-2}^{n} = 0.80$, $u_{i-1}^{n} = 1.00$, $u_{i}^{n} = 1.10$, $u_{i+1}^{n} = 0.90$\n\nFirst, we calculate the Courant number:\n$$\nC = \\frac{a \\Delta t}{\\Delta x} = \\frac{1.5 \\times 4}{10} = \\frac{6}{10} = 0.6\n$$\nThe update equation is $u_i^{n+1} = u_i^n - 0.6(u_{i+1/2}^L - u_{i-1/2}^L)$. To proceed, we must compute $u_{i+1/2}^L$ and $u_{i-1/2}^L$, which requires finding $\\sigma_i$ and $\\sigma_{i-1}$.\n\nStep 1: Compute the smoothness indicator $r_i$ for cell $i$.\nThe required differences are:\n$$\nu_i^n - u_{i-1}^n = 1.10 - 1.00 = 0.10\n$$\n$$\nu_{i+1}^n - u_i^n = 0.90 - 1.10 = -0.20\n$$\nSo, the smoothness indicator is:\n$$\nr_i = \\frac{0.10}{-0.20} = -0.5\n$$\n\nStep 2: Compute the limited variation $\\sigma_i$ and the limited slope $s_i$.\nApply the van Leer limiter function $\\phi(r_i)$:\n$$\n\\phi(r_i) = \\phi(-0.5) = \\frac{-0.5 + |-0.5|}{1 + |-0.5|} = \\frac{-0.5 + 0.5}{1 + 0.5} = \\frac{0}{1.5} = 0\n$$\nThe limited variation in cell $i$ is:\n$$\n\\sigma_i = \\phi(r_i) (u_{i+1}^n - u_i^n) = 0 \\times (-0.20) = 0\n$$\nThe limited slope in cell $i$, which controls the reconstruction for interface $x_{i+1/2}$, is $s_i = \\sigma_i / \\Delta x = 0 / 10 = 0$. The zero slope indicates that the reconstruction in cell $i$ is piecewise constant, a result of theTVD scheme detecting a local extremum at $u_i^n$.\n\nStep 3: Compute the smoothness indicator $r_{i-1}$ for cell $i-1$.\nThe required differences are:\n$$\nu_{i-1}^n - u_{i-2}^n = 1.00 - 0.80 = 0.20\n$$\n$$\nu_i^n - u_{i-1}^n = 1.10 - 1.00 = 0.10\n$$\nSo, the smoothness indicator for cell $i-1$ is:\n$$\nr_{i-1} = \\frac{0.20}{0.10} = 2\n$$\n\nStep 4: Compute the limited variation $\\sigma_{i-1}$.\nApply the van Leer limiter function $\\phi(r_{i-1})$:\n$$\n\\phi(r_{i-1}) = \\phi(2) = \\frac{2 + |2|}{1 + |2|} = \\frac{2+2}{1+2} = \\frac{4}{3}\n$$\nThe limited variation in cell $i-1$ is:\n$$\n\\sigma_{i-1} = \\phi(r_{i-1}) (u_i^n - u_{i-1}^n) = \\frac{4}{3} \\times (0.10) = \\frac{4}{3} \\times \\frac{1}{10} = \\frac{4}{30} = \\frac{2}{15}\n$$\n\nStep 5: Reconstruct the interface states $u_{i+1/2}^L$ and $u_{i-1/2}^L$.\n$$\nu_{i+1/2}^L = u_i^n + \\frac{1}{2}\\sigma_i = 1.10 + \\frac{1}{2}(0) = 1.10\n$$\n$$\nu_{i-1/2}^L = u_{i-1}^n + \\frac{1}{2}\\sigma_{i-1} = 1.00 + \\frac{1}{2}\\left(\\frac{2}{15}\\right) = 1 + \\frac{1}{15} = \\frac{16}{15}\n$$\n\nStep 6: Compute the final updated value $u_i^{n+1}$.\nSubstitute the reconstructed states and the Courant number into the update formula:\n$$\nu_i^{n+1} = u_i^n - C (u_{i+1/2}^L - u_{i-1/2}^L)\n$$\n$$\nu_i^{n+1} = 1.10 - 0.6 \\left( 1.10 - \\frac{16}{15} \\right)\n$$\nTo maintain precision, we work with fractions: $1.10 = \\frac{11}{10}$ and $0.6 = \\frac{6}{10} = \\frac{3}{5}$.\n$$\nu_i^{n+1} = \\frac{11}{10} - \\frac{3}{5} \\left( \\frac{11}{10} - \\frac{16}{15} \\right)\n$$\nFind a common denominator for the term in the parentheses:\n$$\n\\frac{11}{10} - \\frac{16}{15} = \\frac{11 \\times 3}{30} - \\frac{16 \\times 2}{30} = \\frac{33 - 32}{30} = \\frac{1}{30}\n$$\nNow substitute back:\n$$\nu_i^{n+1} = \\frac{11}{10} - \\frac{3}{5} \\left( \\frac{1}{30} \\right) = \\frac{11}{10} - \\frac{3}{150} = \\frac{11}{10} - \\frac{1}{50}\n$$\nFinally, compute the result:\n$$\nu_i^{n+1} = \\frac{11 \\times 5}{50} - \\frac{1}{50} = \\frac{55 - 1}{50} = \\frac{54}{50} = \\frac{27}{25}\n$$\nAs a decimal, this exact value is $1.08$.", "answer": "$$\n\\boxed{1.08}\n$$", "id": "3618311"}, {"introduction": "After learning how to implement a flux-limited scheme, the next critical step is understanding how to select the appropriate limiter for a given problem. This advanced exercise [@problem_id:3618340] moves from application to analysis, exploring the theoretical bounds of Total Variation Diminishing (TVD) schemes. By investigating where a highly compressive limiter like 'superbee' saturates these bounds, you will gain crucial insight into the fundamental trade-off between sharply resolving discontinuities and the tendency to generate numerical artifacts like \"staircasing.\"", "problem": "Consider the one-dimensional linear advection of a passive geophysical tracer described by the partial differential equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a0$. Adopt a uniform finite-volume discretization on a grid with spacing $\\Delta x$ and an explicit time step $\\Delta t$ satisfying $0\\nu \\leq 1$, where $\\nu = a\\,\\Delta t/\\Delta x$ is the Courant number. Use a high-resolution Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) reconstruction with a flux-limiter function $\\phi(r)$ applied to the limited slope, where the smoothness indicator $r_i$ for cell $i$ is defined as the ratio of consecutive solution differences, $r_i = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i}$.\n\nStarting from the definitions of total variation and the Total Variation Diminishing (TVD) requirement $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^{n})$ for the discrete update, derive the admissible upper bound $\\Phi_{\\mathrm{UB}}(r)$ on the limiter $\\phi(r)$ as constrained by TVD for $r \\ge 0$. Then, using only principles that follow from these TVD constraints and the requirement that the limiter be the most compressive while remaining TVD, determine for which values of $r \\ge 0$ the so-called “superbee” limiter saturates the upper TVD bound, that is, $\\phi_{\\mathrm{SB}}(r) = \\Phi_{\\mathrm{UB}}(r)$.\n\nFinally, as part of your reasoning, explain what this saturation implies for the scheme’s ability to resolve sharp geophysical fronts versus its propensity to generate staircasing in advected tracer profiles. Express the final set of values of $r$ as a union of closed intervals in terms of $r$. No rounding is required and there are no units in the final answer.", "solution": "### Derivation and Analysis\n\nA general high-resolution, second-order TVD scheme for the linear advection equation can be cast into a form involving a flux limiter function $\\phi(r)$. The finite volume update for the cell-averaged quantity $u_i$ is given by\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2})$$\nwhere $F_{i\\pm 1/2}$ are the numerical fluxes at the cell interfaces. For a MUSCL-type scheme with constant $a0$, the flux depends on the reconstructed value at the left of the interface, $u_{i+1/2}^L$. The update can be expressed in terms of the cell values at time level $n$. A common form, which is a correction to the first-order upwind scheme, is:\n$$u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n) + \\text{correction terms}$$\nThe TVD property imposes constraints on these correction terms, which translate into constraints on the flux limiter function $\\phi(r)$.\n\nFor a scheme to be TVD, the flux limiter $\\phi(r)$ associated with the reconstruction must satisfy certain conditions. For a scheme written in the conventional flux-limiter form, and based on the standard smoothness indicator $r = (u_i-u_{i-1})/(u_{i+1}-u_i)$, the sufficient conditions for the scheme to be TVD for $r \\ge 0$ are given by the constraints that $\\phi(r)$ must lie within the region defined by:\n1.  $\\phi(r) \\ge 0$\n2.  $\\phi(r) \\le 2r$\n3.  $\\phi(r) \\le 2$\n\nThese conditions are derived from requiring that the scheme does not introduce new local extrema and ensures that the total variation of the solution does not increase. The region in the $(r, \\phi)$ plane defined by these inequalities is known as the Sweby-Davis TVD region.\n\n**1. Admissible Upper Bound $\\Phi_{\\mathrm{UB}}(r)$**\n\nFrom the TVD constraints, the limiter $\\phi(r)$ must be non-negative, but bounded from above by both $2r$ and $2$. To satisfy both upper bounds simultaneously, $\\phi(r)$ must be less than or equal to the minimum of the two. Therefore, the admissible upper bound, $\\Phi_{\\mathrm{UB}}(r)$, is:\n$$\\Phi_{\\mathrm{UB}}(r) = \\min(2, 2r)$$\nWe can express this piecewise for $r \\ge 0$:\n-   For $0 \\le r  1$, we have $2r  2$. Thus, $\\Phi_{\\mathrm{UB}}(r) = 2r$.\n-   For $r \\ge 1$, we have $2r \\ge 2$. Thus, $\\Phi_{\\mathrm{UB}}(r) = 2$.\n\nSo, the upper bound is:\n$$\\Phi_{\\mathrm{UB}}(r) = \\begin{cases} 2r  \\text{for } 0 \\le r  1 \\\\ 2  \\text{for } r \\ge 1 \\end{cases}$$\nA limiter that lies on this boundary, such as the UMIST limiter, is maximally compressive while remaining TVD.\n\n**2. Saturation of the Bound by the Superbee Limiter**\n\nThe superbee flux limiter is defined as:\n$$\\phi_{\\mathrm{SB}}(r) = \\max(0, \\min(1, 2r), \\min(r, 2))$$\nWe need to determine for which values of $r \\ge 0$ this function is equal to the upper bound $\\Phi_{\\mathrm{UB}}(r)$. For $r \\ge 0$, all terms inside the $\\max$ function are non-negative, so we can simplify the expression to:\n$$\\phi_{\\mathrm{SB}}(r) = \\max(\\min(1, 2r), \\min(r, 2))$$\nLet us analyze this function in a piecewise manner:\n-   For $0 \\le r  1/2$: $\\min(1, 2r) = 2r$ and $\\min(r, 2) = r$. Thus, $\\phi_{\\mathrm{SB}}(r) = \\max(2r, r) = 2r$.\n-   For $1/2 \\le r  1$: $\\min(1, 2r) = 1$ and $\\min(r, 2) = r$. Thus, $\\phi_{\\mathrm{SB}}(r) = \\max(1, r) = 1$.\n-   For $1 \\le r  2$: $\\min(1, 2r) = 1$ and $\\min(r, 2) = r$. Thus, $\\phi_{\\mathrm{SB}}(r) = \\max(1, r) = r$.\n-   For $r \\ge 2$: $\\min(1, 2r) = 1$ and $\\min(r, 2) = 2$. Thus, $\\phi_{\\mathrm{SB}}(r) = \\max(1, 2) = 2$.\n\nNow, we compare $\\phi_{\\mathrm{SB}}(r)$ with $\\Phi_{\\mathrm{UB}}(r) = \\min(2, 2r)$ in each interval:\n-   For $0 \\le r \\le 1/2$: $\\phi_{\\mathrm{SB}}(r) = 2r$. The upper bound is $\\Phi_{\\mathrm{UB}}(r) = \\min(2, 2r) = 2r$. They are equal in this interval, including the endpoints.\n-   For $1/2  r  1$: $\\phi_{\\mathrm{SB}}(r) = 1$. The upper bound is $\\Phi_{\\mathrm{UB}}(r) = 2r$. Since $r  1/2$, $2r  1$, so $\\phi_{\\mathrm{SB}}(r)  \\Phi_{\\mathrm{UB}}(r)$. They are not equal.\n-   For $1 \\le r  2$: $\\phi_{\\mathrm{SB}}(r) = r$. The upper bound is $\\Phi_{\\mathrm{UB}}(r) = \\min(2, 2r) = 2$. Since $r  2$, $\\phi_{\\mathrm{SB}}(r)  \\Phi_{\\mathrm{UB}}(r)$. They are not equal.\n-   For $r \\ge 2$: $\\phi_{\\mathrm{SB}}(r) = 2$. The upper bound is $\\Phi_{\\mathrm{UB}}(r) = \\min(2, 2r) = 2$. They are equal in this interval.\n\nCombining these results, the superbee limiter saturates the upper TVD bound, $\\phi_{\\mathrm{SB}}(r) = \\Phi_{\\mathrm{UB}}(r)$, for $r \\in [0, 1/2]$ and $r \\in [2, \\infty)$. The set of values is the union of these two closed intervals.\n\n**3. Implications of Saturation**\n\nThe saturation of the TVD upper bound, $\\phi(r) = \\Phi_{\\mathrm{UB}}(r)$, signifies that the numerical scheme is maximally compressive, or minimally dissipative, for that particular ratio of gradients $r$. This has direct consequences for the simulation of advected geophysical tracers.\n\n-   **Resolution of Sharp Fronts**: Maximal compression is highly effective at resolving sharp features like fronts, shocks, or contact discontinuities. By using the steepest possible slopes allowed within the TVD framework, the scheme counteracts the smearing effect of numerical diffusion. The superbee limiter is well-known for producing very sharp and crisp profiles for discontinuities, which is a direct result of its compressive nature, particularly in the regions where it saturates the TVD bound ($r \\le 1/2$ and $r \\ge 2$). These values of $r$ correspond to regions where the gradient is changing rapidly, such as at the edges of a square wave.\n\n-   **Propensity for Staircasing**: The trade-off for high compression is a tendency to produce numerical artifacts, most notably \"staircasing.\" This phenomenon occurs when a smooth, monotonic profile is artificially steepened into a series of flat plateaus and sharp steps. While the superbee limiter is TVD and does not generate overshoots, its aggressive nature can distort smooth solutions. The behavior in the regions where it does *not* saturate the bound, $r \\in (1/2, 2)$, which corresponds to more smoothly varying data, contributes to this. The limiter's choices in this range can lead to the flattening of gentle slopes into horizontal segments, forming the characteristic staircase pattern.\n\nIn summary, the saturation of the TVD bound by the superbee limiter in specific regimes of $r$ makes it an excellent choice for problems dominated by sharp discontinuities, but this same compressive property can introduce staircasing artifacts in smoother regions of the flow.\n\nThe set of values of $r \\ge 0$ for which the superbee limiter saturates the upper TVD bound is $[0, 1/2] \\cup [2, \\infty)$.", "answer": "$$\\boxed{[0, 1/2] \\cup [2, \\infty)}$$", "id": "3618340"}]}