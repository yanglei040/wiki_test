{"hands_on_practices": [{"introduction": "Before tackling complex numerical implementations, it is crucial to build a strong physical intuition for how boundary conditions shape wave behavior. This first practice uses a simplified one-dimensional model to explore the fundamental differences between a traction-free and a clamped surface. By analytically solving for the eigenfrequencies and mode shapes in each case, you will directly observe how the free-surface condition alters the resonant spectrum and concentrates wave energy near the surface, a key characteristic of surface-guided waves [@problem_id:3598388].", "problem": "Consider the one-dimensional shear-horizontal elastodynamic motion in a homogeneous, isotropic elastic layer of thickness $H$ occupying $z \\in [0,H]$. Let the displacement field be $u(z,t)$, representing a horizontal shear component that varies only with depth $z$ and time $t$. The governing equation follows from linear momentum balance and Hooke’s law for an isotropic elastic solid,\n$$\n\\rho \\,\\frac{\\partial^2 u}{\\partial t^2} = \\mu \\,\\frac{\\partial^2 u}{\\partial z^2},\n$$\nwhere $\\rho$ is the mass density, $\\mu$ is the shear modulus, and $v_s = \\sqrt{\\mu/\\rho}$ is the shear-wave speed.\n\nAssume a rigid base at $z=H$ modeled by the kinematic boundary condition $u(H,t)=0$. Consider two alternative boundary conditions at the free surface $z=0$:\n- Traction-free surface: $\\sigma_{xz}(0,t) = \\mu \\,\\frac{\\partial u}{\\partial z}(0,t) = 0$, equivalently $\\frac{\\partial u}{\\partial z}(0,t)=0$.\n- Clamped surface: $u(0,t)=0$.\n\nSeek time-harmonic solutions $u(z,t) = \\phi(z)\\,e^{i\\,\\omega t}$, with angular frequency $\\omega$, which leads to the eigenvalue problem\n$$\n- v_s^2\\,\\frac{d^2 \\phi}{dz^2} = \\omega^2 \\,\\phi,\n$$\nsubject to either the mixed boundary conditions $\\frac{d\\phi}{dz}(0)=0$ and $\\phi(H)=0$ (traction-free at $z=0$ and rigid at $z=H$), or the clamped boundary conditions $\\phi(0)=0$ and $\\phi(H)=0$.\n\nYour task is to write a complete, runnable program that:\n1. Starting from the above fundamental laws and definitions, computes the first three angular eigenfrequencies for both boundary condition sets by solving the eigenvalue problem in closed form.\n2. Orders eigenfrequencies by increasing magnitude for each boundary condition set independently.\n3. Compares the spectra by computing, for mode indices $n\\in\\{1,2,3\\}$ when ordered by increasing frequency in each set, the differences $\\Delta \\omega_n = \\omega^{\\text{(traction-free)}}_n - \\omega^{\\text{(clamped)}}_n$ and the ratios $R_n = \\omega^{\\text{(traction-free)}}_n / \\omega^{\\text{(clamped)}}_n$.\n4. Quantifies near-surface mode localization for the first mode in each boundary condition set by computing the energy fraction in a near-surface sublayer of thickness $h_0$, defined as\n$$\nF = \\frac{\\int_{0}^{h_0} |\\phi(z)|^2 \\, dz}{\\int_{0}^{H} |\\phi(z)|^2 \\, dz},\n$$\nand reports $F_{\\text{traction-free, first mode}}$, $F_{\\text{clamped, first mode}}$, and their difference $\\Delta F = F_{\\text{traction-free}} - F_{\\text{clamped}}$, together with a boolean indicating whether $F_{\\text{traction-free}}  F_{\\text{clamped}}$.\n5. Express all angular frequencies in radians per second (rad/s) and all lengths in meters (m). All angles used inside trigonometric functions must be interpreted in radians. All reported fractions must be decimals (not percentages).\n\nImplement the program to produce results for the following test suite, which is designed to cover a typical case, a boundary case, and an extreme edge case:\n- Test case $1$: $H=1000\\,\\text{m}$, $v_s=2000\\,\\text{m/s}$, $h_0=100\\,\\text{m}$.\n- Test case $2$: $H=50\\,\\text{m}$, $v_s=1000\\,\\text{m/s}$, $h_0=50\\,\\text{m}$.\n- Test case $3$: $H=100\\,\\text{m}$, $v_s=1500\\,\\text{m/s}$, $h_0=10^{-6}\\,\\text{m}$.\n\nFor each test case, your program must compute and return a list containing, in order:\n- $\\Delta \\omega_1$, $\\Delta \\omega_2$, $\\Delta \\omega_3$ (floats in rad/s),\n- $R_1$, $R_2$, $R_3$ (dimensionless floats),\n- $F_{\\text{traction-free, first mode}}$ and $F_{\\text{clamped, first mode}}$ (decimals),\n- $\\Delta F$ (decimal),\n- a boolean indicating whether $F_{\\text{traction-free, first mode}}  F_{\\text{clamped, first mode}}$.\n\nFinal output format requirement: Your program should produce a single line of output containing the results as a comma-separated list of the three per-case lists enclosed in square brackets, for example, $[ [\\dots], [\\dots], [\\dots] ]$.", "solution": "The problem requires the analysis of one-dimensional shear-horizontal (SH) wave propagation in an elastic layer, governed by the wave equation. We are tasked with finding and comparing the angular eigenfrequencies and mode shapes for two distinct sets of boundary conditions at the free surface $z=0$, while the base at $z=H$ is rigid.\n\nThe governing partial differential equation for the displacement $u(z,t)$ is\n$$\n\\rho \\,\\frac{\\partial^2 u}{\\partial t^2} = \\mu \\,\\frac{\\partial^2 u}{\\partial z^2}\n$$\nIntroducing the shear-wave speed $v_s = \\sqrt{\\mu/\\rho}$, this becomes\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = v_s^2 \\,\\frac{\\partial^2 u}{\\partial z^2}\n$$\nWe seek time-harmonic solutions of the form $u(z,t) = \\phi(z)e^{i\\omega t}$. Substituting this into the wave equation yields a second-order ordinary differential equation for the mode shape $\\phi(z)$:\n$$\n-\\omega^2 \\phi(z) = v_s^2 \\frac{d^2\\phi}{dz^2}\n$$\nwhich can be rearranged into the standard form of a Helmholtz equation, representing an eigenvalue problem for the angular frequency $\\omega$:\n$$\n\\frac{d^2\\phi}{dz^2} + k^2 \\phi = 0, \\quad \\text{where } k = \\frac{\\omega}{v_s}\n$$\nThe general solution to this ordinary differential equation is\n$$\n\\phi(z) = A \\cos(kz) + B \\sin(kz)\n$$\nwhere $A$ and $B$ are constants determined by the boundary conditions. The base at $z=H$ is rigid, which imposes the condition $\\phi(H)=0$ in all cases.\n\nWe analyze the two sets of boundary conditions separately to find their respective eigenfrequencies and eigenfunctions.\n\n### Case 1: Traction-Free Surface at $z=0$\nThe boundary conditions are:\n1.  Traction-free at $z=0$: $\\frac{d\\phi}{dz}(0) = 0$\n2.  Rigid base at $z=H$: $\\phi(H) = 0$\n\nFirst, we compute the derivative of the general solution:\n$$\n\\frac{d\\phi}{dz}(z) = -Ak\\sin(kz) + Bk\\cos(kz)\n$$\nApplying the first boundary condition at $z=0$:\n$$\n\\frac{d\\phi}{dz}(0) = -Ak\\sin(0) + Bk\\cos(0) = Bk = 0\n$$\nFor a non-trivial solution, we require $k \\neq 0$ (and thus $\\omega \\neq 0$), which implies $B=0$. The solution simplifies to $\\phi(z) = A \\cos(kz)$.\n\nNext, we apply the second boundary condition at $z=H$:\n$$\n\\phi(H) = A \\cos(kH) = 0\n$$\nFor a non-trivial eigenfunction, $A \\neq 0$, so we must have $\\cos(kH)=0$. This condition is satisfied when the argument of the cosine function is an odd integer multiple of $\\pi/2$:\n$$\nkH = \\frac{(2n-1)\\pi}{2}, \\quad \\text{for } n = 1, 2, 3, \\dots\n$$\nThis gives the quantized wavenumbers $k_n^{\\text{(tf)}} = \\frac{(2n-1)\\pi}{2H}$. The corresponding angular eigenfrequencies are found from $\\omega = k v_s$:\n$$\n\\omega_n^{\\text{(traction-free)}} = \\frac{(2n-1)\\pi v_s}{2H}, \\quad n=1, 2, 3, \\dots\n$$\nThe eigenfunctions (mode shapes) for this case are, setting the arbitrary amplitude to $1$:\n$$\n\\phi_n^{\\text{(traction-free)}}(z) = \\cos\\left(\\frac{(2n-1)\\pi z}{2H}\\right)\n$$\n\n### Case 2: Clamped Surface at $z=0$\nThe boundary conditions are:\n1.  Clamped at $z=0$: $\\phi(0) = 0$\n2.  Rigid base at $z=H$: $\\phi(H) = 0$\n\nApplying the first boundary condition to the general solution $\\phi(z) = A \\cos(kz) + B \\sin(kz)$:\n$$\n\\phi(0) = A\\cos(0) + B\\sin(0) = A = 0\n$$\nThe solution simplifies to $\\phi(z) = B \\sin(kz)$.\n\nApplying the second boundary condition at $z=H$:\n$$\n\\phi(H) = B \\sin(kH) = 0\n$$\nFor a non-trivial eigenfunction, $B \\neq 0$, so we must have $\\sin(kH)=0$. This condition holds when the argument of the sine function is an integer multiple of $\\pi$:\n$$\nkH = n\\pi, \\quad \\text{for } n = 1, 2, 3, \\dots\n$$\nThis gives the quantized wavenumbers $k_n^{\\text{(clamped)}} = \\frac{n\\pi}{H}$. The corresponding angular eigenfrequencies are:\n$$\n\\omega_n^{\\text{(clamped)}} = \\frac{n\\pi v_s}{H}, \\quad n=1, 2, 3, \\dots\n$$\nThe eigenfunctions for this case are, again setting the amplitude to $1$:\n$$\n\\phi_n^{\\text{(clamped)}}(z) = \\sin\\left(\\frac{n\\pi z}{H}\\right)\n$$\n\n### Comparison of Spectra\nWe compute the differences $\\Delta \\omega_n = \\omega_n^{\\text{(traction-free)}} - \\omega_n^{\\text{(clamped)}}$ and ratios $R_n = \\omega_n^{\\text{(traction-free)}} / \\omega_n^{\\text{(clamped)}}$ for $n \\in \\{1, 2, 3\\}$.\n\nThe difference is:\n$$\n\\Delta \\omega_n = \\frac{(2n-1)\\pi v_s}{2H} - \\frac{n\\pi v_s}{H} = \\frac{\\pi v_s}{H} \\left(\\frac{2n-1}{2} - n\\right) = \\frac{\\pi v_s}{H} \\left(n - \\frac{1}{2} - n\\right) = -\\frac{\\pi v_s}{2H}\n$$\nInterestingly, the difference in eigenfrequencies is constant for all modes $n$.\n\nThe ratio is:\n$$\nR_n = \\frac{\\omega_n^{\\text{(traction-free)}}}{\\omega_n^{\\text{(clamped)}}} = \\frac{(2n-1)\\pi v_s / (2H)}{n\\pi v_s / H} = \\frac{2n-1}{2n} = 1 - \\frac{1}{2n}\n$$\n\n### Near-Surface Energy Fraction\nThe energy density is proportional to $|\\phi(z)|^2$. We compute the fraction of energy in the sublayer $z \\in [0, h_0]$ for the first mode ($n=1$) of each case.\n$$\nF = \\frac{\\int_{0}^{h_0} |\\phi(z)|^2 \\, dz}{\\int_{0}^{H} |\\phi(z)|^2 \\, dz}\n$$\n\nFor the **traction-free** case ($n=1$), $\\phi_1^{\\text{(tf)}}(z) = \\cos(\\frac{\\pi z}{2H})$.\nThe denominator is $\\int_{0}^{H} \\cos^2(\\frac{\\pi z}{2H}) \\, dz = \\int_{0}^{H} \\frac{1}{2}(1 + \\cos(\\frac{\\pi z}{H})) \\, dz = \\frac{1}{2}\\left[z + \\frac{H}{\\pi}\\sin(\\frac{\\pi z}{H})\\right]_0^H = \\frac{H}{2}$.\nThe numerator is $\\int_{0}^{h_0} \\cos^2(\\frac{\\pi z}{2H}) \\, dz = \\frac{1}{2}\\left[z + \\frac{H}{\\pi}\\sin(\\frac{\\pi z}{H})\\right]_0^{h_0} = \\frac{h_0}{2} + \\frac{H}{2\\pi}\\sin(\\frac{\\pi h_0}{H})$.\nThe fraction is:\n$$\nF_{\\text{traction-free}} = \\frac{\\frac{h_0}{2} + \\frac{H}{2\\pi}\\sin(\\frac{\\pi h_0}{H})}{H/2} = \\frac{h_0}{H} + \\frac{1}{\\pi}\\sin\\left(\\frac{\\pi h_0}{H}\\right)\n$$\n\nFor the **clamped** case ($n=1$), $\\phi_1^{\\text{(clamped)}}(z) = \\sin(\\frac{\\pi z}{H})$.\nThe denominator is $\\int_{0}^{H} \\sin^2(\\frac{\\pi z}{H}) \\, dz = \\int_{0}^{H} \\frac{1}{2}(1 - \\cos(\\frac{2\\pi z}{H})) \\, dz = \\frac{1}{2}\\left[z - \\frac{H}{2\\pi}\\sin(\\frac{2\\pi z}{H})\\right]_0^H = \\frac{H}{2}$.\nThe numerator is $\\int_{0}^{h_0} \\sin^2(\\frac{\\pi z}{H}) \\, dz = \\frac{1}{2}\\left[z - \\frac{H}{2\\pi}\\sin(\\frac{2\\pi z}{H})\\right]_0^{h_0} = \\frac{h_0}{2} - \\frac{H}{4\\pi}\\sin(\\frac{2\\pi h_0}{H})$.\nThe fraction is:\n$$\nF_{\\text{clamped}} = \\frac{\\frac{h_0}{2} - \\frac{H}{4\\pi}\\sin(\\frac{2\\pi h_0}{H})}{H/2} = \\frac{h_0}{H} - \\frac{1}{2\\pi}\\sin\\left(\\frac{2\\pi h_0}{H}\\right)\n$$\nThe difference $\\Delta F = F_{\\text{traction-free}} - F_{\\text{clamped}}$ and the boolean check $F_{\\text{traction-free}} > F_{\\text{clamped}}$ are then computed directly. These derived closed-form expressions are implemented in the following program to compute the required quantities for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases and print the results.\n    \"\"\"\n\n    def calculate_metrics(H, vs, h0):\n        \"\"\"\n        Computes the required metrics for a single test case.\n\n        Args:\n            H (float): Layer thickness in meters.\n            vs (float): Shear-wave speed in m/s.\n            h0 (float): Near-surface sublayer thickness in meters.\n\n        Returns:\n            list: A list containing 10 metric values in the specified order.\n        \"\"\"\n        pi = np.pi\n\n        # Task 3: Compare spectra\n        # The difference in angular frequencies is constant for all modes.\n        delta_omega_n = -pi * vs / (2.0 * H)\n        delta_omegas = [delta_omega_n, delta_omega_n, delta_omega_n]\n\n        # The ratio of angular frequencies depends on the mode index n.\n        ratios = [1.0 - 1.0 / (2.0 * n) for n in range(1, 4)]\n\n        # Task 4: Quantify near-surface mode localization\n        h0_over_H = h0 / H\n\n        # For the traction-free case, first mode (n=1)\n        arg_tf = pi * h0_over_H\n        F_tf = h0_over_H + np.sin(arg_tf) / pi\n\n        # For the clamped case, first mode (n=1)\n        arg_clamped = 2.0 * pi * h0_over_H\n        F_clamped = h0_over_H - np.sin(arg_clamped) / (2.0 * pi)\n\n        # Difference in energy fractions\n        delta_F = F_tf - F_clamped\n\n        # Boolean comparison of energy fractions\n        is_Ftf_gt_Fclamped = F_tf  F_clamped\n\n        return delta_omegas + ratios + [F_tf, F_clamped, delta_F, is_Ftf_gt_Fclamped]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (H, vs, h0)\n        (1000.0, 2000.0, 100.0),      # Test case 1\n        (50.0, 1000.0, 50.0),         # Test case 2\n        (100.0, 1500.0, 1e-6),        # Test case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        H_val, vs_val, h0_val = case\n        case_results = calculate_metrics(H_val, vs_val, h0_val)\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list includes spaces after commas, e.g., '[1.0, 2.0]'.\n    # Joining these string representations with a comma produces the required output format,\n    # e.g., '[[1.0, 2.0],[3.0, 4.0]]'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3598388"}, {"introduction": "Translating the continuous free-surface condition into a discrete numerical model requires careful formulation to maintain accuracy and stability. This practice addresses this core challenge within the context of the widely-used staggered-grid finite-difference method. You will derive a specialized, one-sided difference operator that enforces the zero-traction condition at the surface while preserving the overall second-order accuracy of the scheme, and verify its correctness by analyzing the discrete energy balance [@problem_id:3598357].", "problem": "Consider Shear-Horizontal (SH) elastodynamics in a homogeneous, isotropic half-space occupying $z \\ge 0$, with a free surface at $z=0$. Let the material density be $\\rho$ and the shear modulus be $\\mu$, both constant. In SH motion, the out-of-plane displacement is $u_y(x,z,t)$ and the only nonzero stresses are $\\sigma_{xy}$ and $\\sigma_{yz}$. The continuous governing equations are\n$$\n\\rho \\, \\frac{\\partial^2 u_y}{\\partial t^2} \\;=\\; \\mu \\left( \\frac{\\partial^2 u_y}{\\partial x^2} + \\frac{\\partial^2 u_y}{\\partial z^2} \\right),\n\\quad\n\\sigma_{xy} \\;=\\; \\mu \\, \\frac{\\partial u_y}{\\partial x},\n\\quad\n\\sigma_{yz} \\;=\\; \\mu \\, \\frac{\\partial u_y}{\\partial z},\n$$\nwith the traction-free boundary condition at the free surface,\n$$\n\\sigma_{yz}(x,0,t) \\;=\\; 0.\n$$\n\nDiscretize the half-space on a uniform Cartesian staggered grid with spacings $\\Delta x$ and $\\Delta z$, where $u_y$ and $v_y=\\partial u_y/\\partial t$ are collocated at integer grid points $(x_i,z_j)=(i\\Delta x,j\\Delta z)$, the stress $\\sigma_{xy}$ is collocated at $(x_{i+\\frac{1}{2}},z_j)$, and the stress $\\sigma_{yz}$ is collocated at $(x_i,z_{j+\\frac{1}{2}})$. In the interior, use centered differences for spatial derivatives; for example,\n$$\n\\sigma_{yz}(i,j+\\tfrac{1}{2},t) \\;=\\; \\mu \\, \\frac{u_y(i,j+1,t) - u_y(i,j,t)}{\\Delta z}.\n$$\n\nAt the free surface, $z=0$, you must construct a one-sided difference stencil for the vertical derivative that enforces the traction-free condition $\\sigma_{yz}(x,0,t)=0$ while maintaining the global second-order accuracy of the interior scheme. Define the one-sided discrete derivative at the surface by\n$$\nD_z^{+} u_y(i,0,t) \\;=\\; \\frac{1}{\\Delta z} \\left( c_0 \\, u_y(i,0,t) + c_1 \\, u_y(i,1,t) + c_2 \\, u_y(i,2,t) \\right),\n$$\nand impose $\\sigma_{yz}(i,0,t) = \\mu \\, D_z^{+} u_y(i,0,t) = 0$.\n\nStarting from the continuous governing equations and using Taylor expansion about $z=0$ as the fundamental base for accuracy analysis, derive the values of $c_0$, $c_1$, and $c_2$ such that $D_z^{+} u_y(i,0,t)$ approximates $\\partial u_y/\\partial z$ at $z=0$ with error $\\mathcal{O}(\\Delta z^2)$, ensuring that the global accuracy of the scheme is not degraded relative to the interior centered differences. Then, verify the discrete energy balance for the semi-discrete system in the absence of sources and lateral fluxes, showing that the rate of change of the discrete total energy equals the net discrete boundary flux and that the traction-free boundary condition with your one-sided stencil annihilates the surface flux at $z=0$.\n\nYour final answer must be the row matrix of the three coefficients $\\left(c_0, c_1, c_2\\right)$ in the definition of $D_z^{+} u_y(i,0,t)$ above. No numerical rounding is required, and no units are needed in the final boxed expression.", "solution": "The problem requires the derivation of coefficients for a second-order accurate, one-sided finite difference stencil and a subsequent analysis of the scheme's energy balance at the boundary.\n\n**Part 1: Derivation of the Stencil Coefficients**\n\nThe objective is to find coefficients $c_0$, $c_1$, and $c_2$ such that the discrete operator $D_z^{+}$ approximates the continuous first derivative $\\frac{\\partial}{\\partial z}$ at the surface $z=0$ with a truncation error of $\\mathcal{O}(\\Delta z^2)$.\nThe operator is defined as:\n$$D_z^{+} u_y(i,0,t) = \\frac{1}{\\Delta z} \\left( c_0 \\, u_y(i,0,t) + c_1 \\, u_y(i,1,t) + c_2 \\, u_y(i,2,t) \\right)$$\nFor simplicity, let us analyze a generic smooth function $u(z)$ and its derivatives at $z=0$. Let $u_j = u(j\\Delta z)$. The problem is to approximate $u'(0)$.\nWe use Taylor series expansions of $u(z)$ around $z=0$ for the points $z_1=\\Delta z$ and $z_2=2\\Delta z$:\n$$u_1 = u(\\Delta z) = u(0) + \\Delta z \\, u'(0) + \\frac{\\Delta z^2}{2} u''(0) + \\frac{\\Delta z^3}{6} u'''(0) + \\mathcal{O}(\\Delta z^4)$$\n$$u_2 = u(2\\Delta z) = u(0) + 2\\Delta z \\, u'(0) + \\frac{(2\\Delta z)^2}{2} u''(0) + \\frac{(2\\Delta z)^3}{6} u'''(0) + \\mathcal{O}(\\Delta z^4)$$\nSubstituting these expansions into the definition of the discrete operator:\n$$\\Delta z \\, D_z^{+} u(0) = c_0 u(0) + c_1 \\left( u(0) + \\Delta z \\, u'(0) + \\frac{\\Delta z^2}{2} u''(0) + \\dots \\right) + c_2 \\left( u(0) + 2\\Delta z \\, u'(0) + \\frac{4\\Delta z^2}{2} u''(0) + \\dots \\right)$$\nWe group terms by the order of the derivative of $u$ at $z=0$:\n$$D_z^{+} u(0) = \\frac{1}{\\Delta z}(c_0 + c_1 + c_2)u(0) + (c_1 + 2c_2)u'(0) + \\frac{\\Delta z}{2}(c_1 + 4c_2)u''(0) + \\frac{\\Delta z^2}{6}(c_1 + 8c_2)u'''(0) + \\mathcal{O}(\\Delta z^3)$$\nFor this expression to be a second-order accurate approximation of $u'(0)$, we must match the coefficients of the derivatives to those of the target expression, $u'(0) + \\mathcal{O}(\\Delta z^2)$. This yields a system of linear equations for $c_0, c_1, c_2$:\n1.  The coefficient of $u(0)$ must be zero:\n    $$c_0 + c_1 + c_2 = 0$$\n2.  The coefficient of $u'(0)$ must be one:\n    $$c_1 + 2c_2 = 1$$\n3.  The coefficient of the $\\Delta z \\cdot u''(0)$ term must be zero to ensure the error is at least $\\mathcal{O}(\\Delta z^2)$:\n    $$\\frac{1}{2}(c_1 + 4c_2) = 0 \\implies c_1 + 4c_2 = 0$$\n\nWe now solve this system of three linear equations for the three unknown coefficients.\nFrom equation (3), we find $c_1 = -4c_2$.\nSubstituting this into equation (2):\n$$-4c_2 + 2c_2 = 1 \\implies -2c_2 = 1 \\implies c_2 = -\\frac{1}{2}$$\nNow, we find $c_1$:\n$$c_1 = -4c_2 = -4\\left(-\\frac{1}{2}\\right) = 2$$\nFinally, using equation (1), we find $c_0$:\n$$c_0 = -c_1 - c_2 = -2 - \\left(-\\frac{1}{2}\\right) = -\\frac{3}{2}$$\nThus, the coefficients for the second-order accurate one-sided stencil are:\n$$c_0 = -\\frac{3}{2}, \\quad c_1 = 2, \\quad c_2 = -\\frac{1}{2}$$\nThe leading term of the truncation error is given by the coefficient of $u'''(0)$:\n$$\\text{Error} = \\frac{\\Delta z^2}{6}(c_1 + 8c_2)u'''(0) = \\frac{\\Delta z^2}{6}\\left(2 + 8\\left(-\\frac{1}{2}\\right)\\right)u'''(0) = \\frac{\\Delta z^2}{6}(2 - 4)u'''(0) = -\\frac{1}{3}\\Delta z^2 u'''(0)$$\nThe error is indeed of order $\\mathcal{O}(\\Delta z^2)$, as required.\n\n**Part 2: Discrete Energy Balance Verification**\n\nThe problem requires a verification of the discrete energy balance and the role of the free-surface boundary condition. The total energy $E$ of the elastic medium is the sum of the kinetic energy $E_{kin}$ and the potential (strain) energy $E_{pot}$. The rate of change of the total energy within a volume $V$ is equal to the negative of the energy flux across its boundary $\\partial V$.\n$$\\frac{dE}{dt} = \\frac{d}{dt} \\int_V \\left( \\frac{1}{2}\\rho \\left(\\frac{\\partial u_y}{\\partial t}\\right)^2 + \\frac{\\mu}{2} (\\nabla u_y \\cdot \\nabla u_y) \\right) dV = - \\oint_{\\partial V} (\\mathbf{v} \\cdot \\mathbf{t}) \\, dS$$\nHere, $\\mathbf{v} = \\frac{\\partial u_y}{\\partial t} \\mathbf{e}_y$ is the particle velocity vector and $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ is the traction vector on the surface with normal $\\mathbf{n}$. The term $\\mathbf{v} \\cdot \\mathbf{t}$ represents the rate of work done by stresses at the boundary, i.e., the energy flux.\n\nAt the free surface $z=0$, the outward normal is $\\mathbf{n} = -\\mathbf{e}_z$. The traction vector component in the $y$-direction is $t_y = (\\boldsymbol{\\sigma}\\cdot\\mathbf{n})_y = \\sigma_{yx}n_x + \\sigma_{yy}n_y + \\sigma_{yz}n_z$. For our geometry, this simplifies to $t_y = \\sigma_{yz}(-1) = -\\sigma_{yz}$.\nThe energy flux through the free surface is $v_y t_y = -v_y \\sigma_{yz}$.\n\nThe continuous boundary condition is $\\sigma_{yz}(x,0,t) = 0$. This directly implies that the energy flux through the free surface is zero:\n$$\\text{Flux}|_{z=0} = -v_y(x,0,t) \\sigma_{yz}(x,0,t) = -v_y(x,0,t) \\cdot 0 = 0$$\nThus, a perfect free surface neither radiates nor absorbs energy.\n\nNow we consider the discrete system. A well-constructed numerical scheme should mimic this energy conservation property. The rate of change of the total discrete energy, summed over the grid, must equal the net flux through the domain boundaries.\nThe problem specifies the numerical implementation of the boundary condition at the free surface node $(i,0)$ as:\n$$\\sigma_{yz}(i,0,t) = \\mu D_z^{+} u_y(i,0,t) = 0$$\nThis is an enforcement of the traction-free condition at the discrete level. The discrete energy flux across the surface at grid column $i$ is the product of the discrete velocity $v_y(i,0,t)$ and the discrete traction associated with this surface. Following the continuous analogue, the discrete flux is proportional to $v_y(i,0,t)\\sigma_{yz}(i,0,t)$.\nBy imposing the condition $\\sigma_{yz}(i,0,t) = 0$, we explicitly set one of the factors in the discrete flux term to zero.\n$$\\text{Discrete Flux}|_{z=0, \\text{node }i} \\propto v_y(i,0,t) \\cdot \\sigma_{yz}(i,0,t) = v_y(i,0,t) \\cdot 0 = 0$$\nTherefore, the implementation of the traction-free boundary condition using the derived one-sided stencil ensures that the numerical energy flux through the discrete free surface is zero. This prevents the accumulation of non-physical energy at the boundary and contributes to the overall stability and accuracy of the numerical simulation, ensuring the discrete system conserves energy (in the absence of other fluxes or sources).", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{3}{2}  2  -\\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "3598357"}, {"introduction": "The definitive test of any numerical free-surface implementation is its ability to correctly simulate Rayleigh waves, whose existence is a direct consequence of this boundary condition. This capstone practice focuses on verification, challenging you to compare a numerically simulated Rayleigh wave against its exact analytical solution derived from elastodynamic theory. By confirming the wave's phase speed and characteristic retrograde elliptical particle motion, you will validate that your model accurately captures the essential physics of wave propagation along a free surface [@problem_id:3598445].", "problem": "Consider an isotropic, homogeneous, linearly elastic half-space occupying $z \\ge 0$ with a traction-free boundary at $z=0$. Let the medium be characterized by Lamé parameters $\\lambda$ and $\\mu$, mass density $\\rho$, compressional-wave speed $V_p = \\sqrt{(\\lambda + 2 \\mu)/\\rho}$, and shear-wave speed $V_s = \\sqrt{\\mu/\\rho}$. Let the Poisson’s ratio be defined by $\\nu = \\lambda/[2(\\lambda + \\mu)]$. A horizontally propagating Rayleigh surface wave travels along $x$ at phase speed $c_R$ and decays exponentially with depth $z$, with $z=0$ being a free surface.\n\nStarting from the elastodynamic Navier equation $\\rho \\, \\partial^2 \\mathbf{u} / \\partial t^2 = (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}$ and the traction-free boundary conditions at $z=0$, derive the free-surface secular condition that determines the Rayleigh wave speed $c_R$ as a function of $V_p$ and $V_s$. Use the potential representation with a scalar potential $\\phi$ and a vector potential reduced to a scalar $\\psi$ for two-dimensional in-plane motion, and enforce the traction-free conditions $\\sigma_{xz}(z=0)=0$ and $\\sigma_{zz}(z=0)=0$. Show that the displacement components at the free surface are phase-shifted by $\\pi/2$ (radians), resulting in elliptical particle motion, and derive the closed-form expression for the ratio of the vertical to horizontal semi-axis lengths of this ellipse at $z=0$ as a function of $c_R$, $V_p$, and $V_s$.\n\nYour program must implement two independent pathways for validation as functions of the Poisson’s ratio $\\nu$:\n\n1. A “computed” pathway that numerically solves, by root-finding, the traction-free secular condition for the dimensionless Rayleigh speed $\\beta = c_R/V_s$ and then numerically estimates the particle-motion ellipse at $z=0$ by sampling the time evolution $u_x(t)$ and $u_z(t)$ over one period to obtain the semi-axis lengths from the maximum absolute values. Use angles in radians. Let the horizontal wavenumber be $k = 1$ rad/m and the shear-wave speed be $V_s = 2000$ m/s. Use the non-dispersive relation $\\omega = k \\, c_R$ for the sampling.\n\n2. An “analytic” pathway that obtains $c_R$ by solving the Rayleigh-wave cubic polynomial for $w = \\beta^2$ arising from elimination of the radicals in the secular condition, selecting the physically admissible root with $0  w  1$, and then evaluates the closed-form expression for the ellipse semi-axis ratio from the free-surface eigenvector implied by the traction-free conditions.\n\nUsing these two pathways, for each test case compute:\n- The relative error in the Rayleigh speed, defined as $|c_R^{\\text{comp}} - c_R^{\\text{anal}}| / c_R^{\\text{anal}}$ (dimensionless).\n- The absolute error in the ellipse semi-axis ratio at the surface, defined as $|R^{\\text{comp}} - R^{\\text{anal}}|$ (dimensionless).\n\nPhysical units must be used where appropriate:\n- Express all speeds internally in $\\text{m/s}$.\n- Use angles in radians for any trigonometric evaluation.\n\nTest Suite:\n- Case 1: $\\nu = 0.00$\n- Case 2: $\\nu = 0.25$\n- Case 3: $\\nu = 0.33$\n- Case 4: $\\nu = 0.49$\n\nFor each case, set $V_s = 2000$ m/s and $k = 1$ rad/m. Compute $V_p$ from $\\nu$ via isotropic elasticity: $V_p / V_s = \\sqrt{ 2 (1 - \\nu) / (1 - 2 \\nu) }$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list $[e_{\\text{speed}}, e_{\\text{ratio}}]$ with the two errors defined above. For example, the output should have the form:\n[[e_speed_case1,e_ratio_case1],[e_speed_case2,e_ratio_case2],[e_speed_case3,e_ratio_case3],[e_speed_case4,e_ratio_case4]]", "solution": "The problem requires the derivation and numerical implementation of the solution for Rayleigh waves propagating along the free surface of a homogeneous, isotropic, linearly elastic half-space. This involves deriving the secular equation that governs the wave speed and the expression for the particle motion at the surface. The solution is validated by comparing a numerical root-finding approach with an analytical polynomial-based approach.\n\nThe starting point is the elastodynamic Navier equation for the displacement vector $\\mathbf{u}(\\mathbf{x}, t)$:\n$$ \\rho \\, \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} $$\nwhere $\\rho$ is the mass density and $\\lambda, \\mu$ are the Lamé parameters. We use the Helmholtz decomposition to represent the displacement field in terms of a scalar potential $\\phi$ and a vector potential $\\boldsymbol{\\psi}$:\n$$ \\mathbf{u} = \\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi} $$\nwith the gauge condition $\\nabla \\cdot \\boldsymbol{\\psi} = 0$. Substituting this into the Navier equation decouples it into two wave equations:\n$$ \\nabla^2\\phi = \\frac{1}{V_p^2} \\frac{\\partial^2\\phi}{\\partial t^2} \\quad , \\quad \\nabla^2\\boldsymbol{\\psi} = \\frac{1}{V_s^2} \\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} $$\nwhere $V_p = \\sqrt{(\\lambda+2\\mu)/\\rho}$ is the compressional-wave speed and $V_s = \\sqrt{\\mu/\\rho}$ is the shear-wave speed.\n\nFor two-dimensional motion in the $x-z$ plane, with propagation along the $x$-axis, we have $\\mathbf{u} = (u_x(x,z,t), 0, u_z(x,z,t))$. The vector potential can be simplified to $\\boldsymbol{\\psi} = (0, \\psi(x,z,t), 0)$. The displacement components are:\n$$ u_x = \\frac{\\partial\\phi}{\\partial x} - \\frac{\\partial\\psi}{\\partial z} \\quad , \\quad u_z = \\frac{\\partial\\phi}{\\partial z} + \\frac{\\partial\\psi}{\\partial x} $$\nWe seek harmonic wave solutions propagating in the $x$-direction with phase speed $c_R$ and angular frequency $\\omega=kc_R$, where $k$ is the wavenumber. For a surface wave, the amplitudes must decay with depth $z \\ge 0$. The potential solutions are:\n$$ \\phi(x,z,t) = A \\exp(-q_p z) \\exp[i(kx - \\omega t)] $$\n$$ \\psi(x,z,t) = B \\exp(-q_s z) \\exp[i(kx - \\omega t)] $$\nwhere $A$ and $B$ are complex amplitudes. Substituting these into the wave equations yields the vertical decay constants:\n$$ q_p = \\sqrt{k^2 - \\frac{\\omega^2}{V_p^2}} = k \\sqrt{1 - \\frac{c_R^2}{V_p^2}} $$\n$$ q_s = \\sqrt{k^2 - \\frac{\\omega^2}{V_s^2}} = k \\sqrt{1 - \\frac{c_R^2}{V_s^2}} $$\nFor the wave to be confined to the surface, the decay constants $q_p$ and $q_s$ must be real and positive, which requires $c_R  V_s  V_p$.\n\nThe boundary at $z=0$ is traction-free, meaning the stress components $\\sigma_{xz}$ and $\\sigma_{zz}$ are zero. The stress-strain relations for an isotropic medium are:\n$$ \\sigma_{xz} = \\mu \\left( \\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x} \\right) $$\n$$ \\sigma_{zz} = \\lambda \\left( \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_z}{\\partial z} \\right) + 2\\mu \\frac{\\partial u_z}{\\partial z} = \\lambda \\nabla^2\\phi + 2\\mu \\left( \\frac{\\partial^2\\phi}{\\partial z^2} + \\frac{\\partial^2\\psi}{\\partial x \\partial z} \\right) $$\nSubstituting the potential solutions and evaluating at $z=0$:\n$$ \\sigma_{xz}|_{z=0} = \\mu \\left[ 2ik(-q_p)A + (k^2+q_s^2)B \\right] \\exp[i(kx-\\omega t)] = 0 $$\n$$ \\sigma_{zz}|_{z=0} = \\left[ A(-\\lambda k^2 - \\lambda q_p^2 + 2\\mu q_p^2) + B(2\\mu ik q_s) \\right] \\exp[i(kx-\\omega t)] = 0 $$\nThe coefficient of $A$ in the $\\sigma_{zz}$ equation simplifies to $-\\mu(k^2+q_s^2)$. This leads to the linear system for amplitudes $A$ and $B$:\n$$ -2ikq_p A - (k^2+q_s^2) B = 0 $$\n$$ (k^2+q_s^2) A - 2ikq_s B = 0 $$\nThis is a homogeneous linear system for the amplitudes $A$ and $B$. For a non-trivial solution, the determinant of the coefficient matrix must be zero:\n$$ (-2ikq_p)(-2ikq_s) - (-(k^2+q_s^2))(k^2+q_s^2) = 0 $$\n$$ -4k^2q_p q_s + (k^2+q_s^2)^2 = 0 \\implies (2-\\beta^2)^2 = 4\\sqrt{1-\\beta^2}\\sqrt{1-\\gamma^2\\beta^2} $$\nThis is the secular equation for the Rayleigh wave speed, expressed in terms of the dimensionless speed $\\beta = c_R/V_s$ and the speed ratio $\\gamma = V_s/V_p$. The term $\\gamma^2$ can be expressed as a function of Poisson's ratio $\\nu$: $\\gamma^2 = V_s^2/V_p^2 = (1-2\\nu)/(2(1-\\nu))$. This transcendental equation forms the basis for the \"computed\" pathway by numerical root-finding.\n\nSquaring the secular equation eliminates the radicals and, after algebraic manipulation and division by a factor of $w=\\beta^2$, yields a cubic polynomial in $w$:\n$$ w^3 - 8w^2 + (24 - 16\\gamma^2)w + 16(\\gamma^2-1) = 0 $$\nThis polynomial has one physically meaningful real root $w_0 \\in (0,1)$. Solving this cubic for $w_0$ and taking the square root gives $\\beta = \\sqrt{w_0}$, which is the basis for the \"analytic\" pathway.\n\nNext, we analyze the particle motion at the free surface $z=0$. The displacement components are:\n$$ u_x(x,0,t) = (ikA - (-q_s)B) e^{i(kx-\\omega t)} = (ikA + q_s B) e^{i(kx-\\omega t)} $$\n$$ u_z(x,0,t) = (-q_pA + ikB) e^{i(kx-\\omega t)} $$\nLet's choose $x=0$ and a real amplitude. The physical displacements are the real parts of the complex expressions. A standard derivation shows that if the horizontal displacement is $u_x(t) = H \\cos(\\omega t)$, the vertical displacement will be $u_z(t) = V \\sin(\\omega t)$, where $H$ and $V$ are the positive semi-axis lengths. At $t=0$, the particle is at $(H, 0)$. At $t=T/4$ (a quarter period later), it is at $(0, V)$. The motion is counter-clockwise, which is the characteristic **retrograde** motion of a Rayleigh wave. The presence of a $\\pi/2$ phase shift (quadrature) between the components results in elliptical motion. The ratio of the vertical to horizontal semi-axis lengths, $R = V/H$, is:\n$$ R = \\frac{2\\sqrt{1-\\gamma^2\\beta^2}}{2-\\beta^2} $$\nUsing the secular equation, this can be rewritten in a simpler form:\n$$ R = \\frac{2-\\beta^2}{2\\sqrt{1-\\beta^2}} $$\nThis closed-form expression will be used in the \"analytic\" pathway to calculate the semi-axis ratio. For the \"computed\" pathway, the ratio will be determined by numerically computing the maximum amplitudes of $u_x(t)$ and $u_z(t)$ time series over one period, as specified.\n\nThe two computational pathways are:\n1.  **Computed Pathway**: For a given $\\nu$, calculate $\\gamma^2$. Numerically solve the transcendental secular equation for $\\beta^{\\text{comp}} \\in (0,1)$ using a root-finder. Calculate $c_R^{\\text{comp}} = \\beta^{\\text{comp}} V_s$. Then, determine the complex amplitudes of the potentials $\\phi$ and $\\psi$, construct the time-domain signals for $u_x(t)$ and $u_z(t)$ at $z=0$, find their maximum absolute values, and compute their ratio $R^{\\text{comp}}$.\n2.  **Analytic Pathway**: For a given $\\nu$, calculate $\\gamma^2$ and form the coefficients of the cubic polynomial in $w=\\beta^2$. Find the roots of the polynomial and select the single physical root $w_0 \\in (0,1)$. Calculate $\\beta^{\\text{anal}} = \\sqrt{w_0}$ and $c_R^{\\text{anal}} = \\beta^{\\text{anal}} V_s$. Finally, use the closed-form expression $R^{\\text{anal}} = (2-w_0)/(2\\sqrt{1-w_0})$ to find the semi-axis ratio.\n\nThe relative error in speed, $|c_R^{\\text{comp}} - c_R^{\\text{anal}}| / c_R^{\\text{anal}}$, and the absolute error in the ratio, $|R^{\\text{comp}} - R^{\\text{anal}}|$, will serve as a verification of the consistency between the two methods and the correctness of the implementation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for Rayleigh wave properties using two different pathways\n    and computes the errors between them for a suite of test cases.\n    \"\"\"\n\n    def computed_pathway(nu, Vs, k):\n        \"\"\"\n        Computes Rayleigh speed and ellipse ratio via numerical root-finding\n        of the secular equation and time-series sampling of particle motion.\n        \n        Args:\n            nu (float): Poisson's ratio.\n            Vs (float): Shear wave speed in m/s.\n            k (float): Wavenumber in rad/m.\n\n        Returns:\n            tuple: (c_R_comp, R_comp)\n                   c_R_comp: Computed Rayleigh wave speed (m/s).\n                   R_comp: Computed ratio of vertical to horizontal semi-axes.\n        \"\"\"\n        if nu = 0.5:\n             # Vp - infinity, gamma_sq - 0. Handle this limit case.\n             gamma_sq = 0.0\n        else:\n             gamma_sq = (1.0 - 2.0 * nu) / (2.0 * (1.0 - nu))\n\n        # Secular function f(beta) = 0\n        def secular_function(beta):\n            beta_sq = beta**2\n            # Avoid domain errors for sqrt by checking arguments\n            if beta_sq = 1.0 or gamma_sq * beta_sq = 1.0:\n                # Return a large number outside the valid domain of beta in (0,1)\n                return 1e18  \n            return (2.0 - beta_sq)**2 - 4.0 * np.sqrt(1.0 - beta_sq) * np.sqrt(1.0 - gamma_sq * beta_sq)\n\n        # Find the root beta = c_R/V_s in the interval (0, 1)\n        # The root is known to be in (0.87, 0.96) for nu in [0, 0.5]\n        try:\n            beta_comp = optimize.brentq(secular_function, 0.1, 0.999)\n        except ValueError:\n            # Fallback if root is not in bracket, though it should be\n            return np.nan, np.nan\n            \n        c_R_comp = beta_comp * Vs\n\n        # Numerically estimate the ellipse ratio by sampling particle motion\n        omega = k * c_R_comp\n        T = 2.0 * np.pi / omega\n        num_samples = 2000\n        t = np.linspace(0, T, num_samples)\n\n        # Amplitudes derived from the boundary condition system\n        # Set arbitrary potential amplitude A=1\n        A_pot = 1.0 + 0.0j \n        beta_comp_sq = beta_comp**2\n        \n        qp = k * np.sqrt(1.0 - gamma_sq * beta_comp_sq)\n        qs = k * np.sqrt(1.0 - beta_comp_sq)\n        \n        # Relation from boundary conditions: B_pot = A_pot * (k^2+qs^2) / (2*i*k*qs)\n        B_pot = A_pot * (k**2 + qs**2) / (2.0j * k * qs)\n\n        # Displacement components at z=0 are u_x = ik*phi + qs*psi, u_z = -qp*phi + ik*psi\n        # (This corresponds to u = grad(phi) + curl(psi) with curl(psi) = (-dpsi/dz, 0, dpsi/dx))\n        # and potentials phi = A_pot * exp(...), psi = B_pot * exp(...)\n        \n        ux_complex_amp = 1.0j * k * A_pot + qs * B_pot\n        uz_complex_amp = -qp * A_pot + 1.0j * k * B_pot\n        \n        ux_t = np.real(ux_complex_amp * np.exp(-1.0j * omega * t))\n        uz_t = np.real(uz_complex_amp * np.exp(-1.0j * omega * t))\n\n        # Semi-axis lengths are max absolute values\n        H_comp = np.max(np.abs(ux_t))\n        V_comp = np.max(np.abs(uz_t))\n        \n        R_comp = V_comp / H_comp if H_comp != 0 else np.inf\n\n        return c_R_comp, R_comp\n\n    def analytic_pathway(nu, Vs):\n        \"\"\"\n        Computes Rayleigh speed and ellipse ratio by solving the cubic\n        polynomial and using the closed-form expression for the ratio.\n\n        Args:\n            nu (float): Poisson's ratio.\n            Vs (float): Shear wave speed in m/s.\n\n        Returns:\n            tuple: (c_R_anal, R_anal)\n                   c_R_anal: Analytic Rayleigh wave speed (m/s).\n                   R_anal: Analytic ratio of vertical to horizontal semi-axes.\n        \"\"\"\n        if nu = 0.5:\n             gamma_sq = 0.0\n        else:\n             gamma_sq = (1.0 - 2.0 * nu) / (2.0 * (1.0 - nu))\n\n        # Coefficients of the cubic polynomial w^3 - 8w^2 + (24-16g^2)w + 16(g^2-1) = 0\n        coeffs = [1.0, -8.0, 24.0 - 16.0 * gamma_sq, 16.0 * gamma_sq - 16.0]\n        roots = np.roots(coeffs)\n        \n        # Find the physically admissible root w = (c_R/V_s)^2, which is real and in (0,1)\n        w_anal = -1.0\n        for r in roots:\n            if np.isclose(r.imag, 0) and 0  r.real  1:\n                w_anal = r.real\n                break\n\n        if w_anal  0:\n            return np.nan, np.nan # Should not happen for physical nu\n\n        beta_anal = np.sqrt(w_anal)\n        c_R_anal = beta_anal * Vs\n        \n        # Closed-form expression for the semi-axis ratio\n        R_anal = (2.0 - w_anal) / (2.0 * np.sqrt(1.0 - w_anal))\n\n        return c_R_anal, R_anal\n\n    # --- Main execution loop ---\n    test_cases = [\n        0.00,  # Case 1\n        0.25,  # Case 2\n        0.33,  # Case 3\n        0.49,  # Case 4\n    ]\n\n    Vs = 2000.0  # m/s\n    k = 1.0      # rad/m\n\n    results = []\n    for nu in test_cases:\n        c_R_comp, R_comp = computed_pathway(nu, Vs, k)\n        c_R_anal, R_anal = analytic_pathway(nu, Vs)\n        \n        # Calculate errors\n        # Relative error in speed\n        if c_R_anal != 0:\n            e_speed = np.abs(c_R_comp - c_R_anal) / c_R_anal\n        else:\n            e_speed = np.nan\n        \n        # Absolute error in ratio\n        e_ratio = np.abs(R_comp - R_anal)\n        \n        results.append([e_speed, e_ratio])\n\n    # Format output as specified in the problem\n    # Using a simple string representation for the lists\n    output_str_parts = []\n    for res in results:\n        output_str_parts.append(f\"[{res[0]},{res[1]}]\")\n    \n    print(f\"[{','.join(output_str_parts)}]\")\n\n\nsolve()\n```", "id": "3598445"}]}