{"hands_on_practices": [{"introduction": "Understanding wave kinematics begins with the fundamental concepts of phase velocity ($v_p$) and group velocity ($v_g$). This exercise solidifies these definitions by applying them to a general power-law dispersion relation, $\\omega = \\beta k^n$. By deriving expressions for $v_p$ and $v_g$ directly from this relationship, you will explore the conditions that define a dispersive medium and uncover the direct mathematical connection between these two crucial velocities [@problem_id:3585604].", "problem": "Consider a one-dimensional, linear, nondissipative, and isotropic elastic medium in which small-amplitude plane waves are described by the wavefield $u(x,t)=\\Re\\{A \\exp(i[k x - \\omega t])\\}$, where $A$ is a constant complex amplitude, $k$ is the wavenumber, and $\\omega$ is the angular frequency. Suppose the medium is characterized by a power-law dispersion relation of the form $\\omega=\\beta k^{n}$ with constants $\\beta0$ and $n0$. A narrowband wave packet centered at wavenumber $k$ propagates according to the kinematics implied by this dispersion relation.\n\nUsing only the fundamental definitions of phase velocity and group velocity, where phase velocity is $v_{p}$ defined by the ratio of angular frequency to wavenumber and group velocity is $v_{g}$ defined by the derivative of angular frequency with respect to wavenumber, derive closed-form expressions for $v_{p}(k)$ and $v_{g}(k)$ as functions of $k$, $\\beta$, and $n$. Then, analyze the special cases $n=1$ and $n=2$ in terms of whether the medium is dispersive and the relative magnitudes of $v_{p}$ and $v_{g}$.\n\nExpress your final answer as a row matrix containing three entries $\\bigl[v_{p}(k),\\,v_{g}(k),\\,v_{g}(k)/v_{p}(k)\\bigr]$. No numerical evaluation is required, and no units are to be included in the final answer. Do not round; provide exact expressions. Any qualitative discussion belongs in your derivation, not in the final answer.", "solution": "The problem asks for the derivation of phase and group velocities for a wave governed by a power-law dispersion relation, followed by an analysis of specific cases. The problem is well-posed, scientifically grounded, and provides all necessary definitions and constraints for a rigorous solution.\n\nThe given dispersion relation is $\\omega(k) = \\beta k^{n}$, where $\\omega$ is the angular frequency, $k$ is the wavenumber, and $\\beta$ and $n$ are positive constants. The wavefield is given by $u(x,t)=\\Re\\{A \\exp(i[k x - \\omega t])\\}$.\n\nFirst, we derive the phase velocity, $v_p$. The definition provided is the ratio of angular frequency to wavenumber:\n$$v_p(k) = \\frac{\\omega(k)}{k}$$\nSubstituting the given dispersion relation into this definition yields:\n$$v_p(k) = \\frac{\\beta k^{n}}{k}$$\nUsing the laws of exponents, this simplifies to:\n$$v_p(k) = \\beta k^{n-1}$$\nThis is the closed-form expression for the phase velocity as a function of $k$, $\\beta$, and $n$.\n\nNext, we derive the group velocity, $v_g$. The definition provided is the derivative of the angular frequency with respect to the wavenumber:\n$$v_g(k) = \\frac{d\\omega(k)}{dk}$$\nSubstituting the dispersion relation and performing the differentiation using the power rule, where $\\beta$ and $n$ are constants:\n$$v_g(k) = \\frac{d}{dk} (\\beta k^{n})$$\n$$v_g(k) = \\beta \\frac{d}{dk} (k^{n})$$\n$$v_g(k) = \\beta (n k^{n-1})$$\n$$v_g(k) = n \\beta k^{n-1}$$\nThis is the closed-form expression for the group velocity.\n\nFrom these two results, we can observe a direct relationship between the group and phase velocities:\n$$v_g(k) = n (\\beta k^{n-1}) = n v_p(k)$$\nThus, the ratio of the group velocity to the phase velocity is simply the constant exponent $n$:\n$$\\frac{v_g(k)}{v_p(k)} = n$$\n\nNow, we analyze the two special cases requested.\n\nCase 1: $n=1$\nFor this case, the dispersion relation is linear: $\\omega = \\beta k$.\nThe phase velocity is:\n$$v_p(k) = \\beta k^{1-1} = \\beta k^{0} = \\beta$$\nThe group velocity is:\n$$v_g(k) = (1) \\beta k^{1-1} = \\beta k^{0} = \\beta$$\nHere, $v_p = v_g = \\beta$. The phase velocity is a constant, independent of the wavenumber $k$. This is the defining characteristic of a non-dispersive medium. In such a medium, all frequency components of a wave packet travel at the same velocity, so the packet propagates without distortion of its shape.\n\nCase 2: $n=2$\nFor this case, the dispersion relation is quadratic: $\\omega = \\beta k^2$.\nThe phase velocity is:\n$$v_p(k) = \\beta k^{2-1} = \\beta k$$\nThe group velocity is:\n$$v_g(k) = (2) \\beta k^{2-1} = 2 \\beta k$$\nIn this case, $v_g = 2 v_p$. Since the phase velocity $v_p$ is a function of the wavenumber $k$ (specifically, $v_p(k) \\propto k$), the medium is dispersive. Different frequency components travel at different phase velocities, causing a wave packet to spread out or \"disperse\" as it propagates. For this type of dispersion, higher wavenumber (shorter wavelength) components have a higher phase velocity.\n\nThe final answer requires the general expressions for $v_p(k)$, $v_g(k)$, and their ratio, presented in a row matrix.\nThe three entries are:\n1. $v_p(k) = \\beta k^{n-1}$\n2. $v_g(k) = n \\beta k^{n-1}$\n3. $\\frac{v_g(k)}{v_p(k)} = n$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\beta k^{n-1}  n \\beta k^{n-1}  n\n\\end{pmatrix}\n}\n$$", "id": "3585604"}, {"introduction": "This practice bridges the gap between continuous physical theory and the discrete world of numerical simulation. When we model wave propagation on a computer using methods like the Finite Difference Time Domain (FDTD), the grid itself introduces errors that manifest as *numerical dispersion*. This exercise provides a crucial, hands-on opportunity to quantify this phenomenon by deriving and computing the numerical phase and group velocities and comparing them to their true physical counterparts, a vital skill for validating and understanding the limitations of any wave-based simulation [@problem_id:3585666].", "problem": "Consider the one-dimensional acoustic wave equation $u_{tt} = c^{2} u_{xx}$, where $c$ is the wave speed in meters per second. A standard explicit second-order Finite Difference Time Domain (FDTD) discretization in time and space yields a numerical dispersion relation implicit in the plane wave ansatz $u^{n}_{j} = \\exp\\left(i (k j \\Delta x - \\omega n \\Delta t)\\right)$, where $k$ is the spatial wavenumber in radians per meter, $\\omega$ is the angular frequency in radians per second, $\\Delta x$ is the spatial grid spacing in meters, and $\\Delta t$ is the time step in seconds. Under this ansatz, the numerical dispersion curve $\\omega_{h}(k)$ associated with the discretization is defined implicitly by the relation\n$$\n\\sin^{2}\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = \\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)^{2}\\,\\sin^{2}\\left(\\frac{k\\,\\Delta x}{2}\\right).\n$$\nAdopt the principal branch of the inverse sine so that $\\omega_{h}(k) \\in \\left[0,\\frac{\\pi}{\\Delta t}\\right]$.\n\nUsing the definitions of phase velocity $v_{p,h}(k) = \\omega_{h}(k)/k$ and group velocity $v_{g,h}(k) = d\\omega_{h}(k)/dk$, compute $v_{p,h}$ and $v_{g,h}$ for given parameter sets, and quantify their deviation from the continuous nondispersive target in which $\\omega(k) = c\\,k$, $v_{p} = c$, and $v_{g} = c$. Use analytic differentiation for $d\\omega_{h}/dk$ based on the implicit numerical dispersion relation above. Express velocities in meters per second and use radians for all angles. Report deviations as decimals (not with a percentage sign), defined as $(v_{p,h} - c)/c$ for phase velocity and $(v_{g,h} - c)/c$ for group velocity.\n\nYour program must compute the following for each test case:\n- $v_{p,h}$ in meters per second,\n- $v_{g,h}$ in meters per second,\n- the relative deviation of $v_{p,h}$ with respect to $c$, i.e., $(v_{p,h} - c)/c$,\n- the relative deviation of $v_{g,h}$ with respect to $c$, i.e., $(v_{g,h} - c)/c$.\n\nUse the following test suite, where all angles are in radians and all distances are in meters:\n- Test case $1$: $c = 2500$, $\\Delta x = 10$, $\\Delta t = 0.002$, $k = \\frac{\\pi}{40}$.\n- Test case $2$: $c = 2500$, $\\Delta x = 10$, $\\Delta t = 0.0036$, $k = \\frac{\\pi}{20}$.\n- Test case $3$: $c = 2500$, $\\Delta x = 10$, $\\Delta t = 0.003996$, $k = 10^{-6}$.\n- Test case $4$: $c = 2500$, $\\Delta x = 10$, $\\Delta t = 0.0036$, $k = \\frac{\\pi}{10} - 10^{-9}$.\n- Test case $5$: $c = 2500$, $\\Delta x = 10$, $\\Delta t = 0.0004$, $k = \\frac{\\pi}{30}$.\n\nDesign for coverage:\n- Test case $1$ is a general mid-wavenumber, moderate Courant–Friedrichs–Lewy (CFL) number scenario.\n- Test case $2$ uses a higher CFL number and higher wavenumber.\n- Test case $3$ probes the small-wavenumber limit near $k \\to 0^{+}$ under near-CFL-limit conditions.\n- Test case $4$ explores behavior near the Nyquist wavenumber $k_{\\text{N}} = \\frac{\\pi}{\\Delta x}$, where numerical group velocity tends toward $0$.\n- Test case $5$ examines a low CFL number regime.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$[v_{p,h}^{(1)}, v_{g,h}^{(1)}, \\delta v_{p}^{(1)}, \\delta v_{g}^{(1)}, v_{p,h}^{(2)}, v_{g,h}^{(2)}, \\delta v_{p}^{(2)}, \\delta v_{g}^{(2)}, \\dots, v_{p,h}^{(5)}, v_{g,h}^{(5)}, \\delta v_{p}^{(5)}, \\delta v_{g}^{(5)}]$,\nwhere superscripts index the test cases from $1$ through $5$. All velocity values must be in meters per second, and deviations must be decimal values relative to $c$.", "solution": "The user-provided problem has been analyzed and validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Governing Equation**: One-dimensional acoustic wave equation, $u_{tt} = c^{2} u_{xx}$.\n- **Physical/Numerical Parameters**: Wave speed $c$ (m/s), spatial wavenumber $k$ (rad/m), angular frequency $\\omega$ (rad/s), spatial grid spacing $\\Delta x$ (m), time step $\\Delta t$ (s).\n- **Plane Wave Ansatz**: $u^{n}_{j} = \\exp\\left(i (k j \\Delta x - \\omega n \\Delta t)\\right)$.\n- **Implicit Numerical Dispersion Relation**: $\\sin^{2}\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = \\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)^{2}\\,\\sin^{2}\\left(\\frac{k\\,\\Delta x}{2}\\right)$.\n- **Branch Constraint**: $\\omega_{h}(k) \\in \\left[0,\\frac{\\pi}{\\Delta t}\\right]$.\n- **Velocity Definitions**: Numerical phase velocity $v_{p,h}(k) = \\omega_{h}(k)/k$, numerical group velocity $v_{g,h}(k) = d\\omega_{h}(k)/dk$.\n- **Continuous (Target) Velocities**: $v_{p} = c$, $v_{g} = c$.\n- **Deviation Definitions**: Phase velocity deviation $\\delta v_{p} = (v_{p,h} - c)/c$, group velocity deviation $\\delta v_{g} = (v_{g,h} - c)/c$.\n- **Computational Requirement**: Use analytic differentiation for $d\\omega_{h}/dk$.\n- **Test Cases**:\n    1.  $c = 2500$ m/s, $\\Delta x = 10$ m, $\\Delta t = 0.002$ s, $k = \\frac{\\pi}{40}$ rad/m.\n    2.  $c = 2500$ m/s, $\\Delta x = 10$ m, $\\Delta t = 0.0036$ s, $k = \\frac{\\pi}{20}$ rad/m.\n    3.  $c = 2500$ m/s, $\\Delta x = 10$ m, $\\Delta t = 0.003996$ s, $k = 10^{-6}$ rad/m.\n    4.  $c = 2500$ m/s, $\\Delta x = 10$ m, $\\Delta t = 0.0036$ s, $k = \\frac{\\pi}{10} - 10^{-9}$ rad/m.\n    5.  $c = 2500$ m/s, $\\Delta x = 10$ m, $\\Delta t = 0.0004$ s, $k = \\frac{\\pi}{30}$ rad/m.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound.\n- **Scientifically Grounded**: The problem addresses the analysis of numerical dispersion for a standard second-order finite-difference scheme applied to the acoustic wave equation. This is a canonical topic in computational geophysics and numerical analysis of partial differential equations. All equations and definitions are standard and correct.\n- **Well-Posed**: The problem is clearly stated with all necessary parameters provided. For a solution to exist, the numerical scheme must be stable, which requires the Courant–Friedrichs–Lewy (CFL) condition to be met. The CFL number is $S = c \\Delta t / \\Delta x$. For stability, $S \\le 1$. An analysis of the test cases confirms that $S \\le 1$ for all of them ($0.5$, $0.9$, $0.999$, $0.9$, and $0.1$, respectively), ensuring that the argument of the inverse sine in the dispersion relation does not exceed $1$ in magnitude, guaranteeing a real-valued solution for $\\omega_h(k)$.\n- **Objective**: The problem is expressed with precise, objective, and quantitative language, free of any subjectivity.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution is provided below.\n\n### Principle-Based Solution Derivation\nThe objective is to derive explicit expressions for the numerical phase velocity, $v_{p,h}(k)$, and group velocity, $v_{g,h}(k)$, from the given implicit dispersion relation, and then use these to compute the required quantities for the specified test cases.\n\nThe implicit dispersion relation is:\n$$ \\sin^{2}\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = S^2\\,\\sin^{2}\\left(\\frac{k\\,\\Delta x}{2}\\right) $$\nwhere $S = \\frac{c\\,\\Delta t}{\\Delta x}$ is the Courant number.\n\n**1. Derivation of Numerical Phase Velocity ($v_{p,h}$)**\n\nFirst, we solve the dispersion relation for $\\omega_h(k)$. Taking the square root of both sides gives:\n$$ \\left|\\sin\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right)\\right| = |S|\\,\\left|\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right| $$\nBy convention, $c$, $\\Delta t$, and $\\Delta x$ are positive, so $S$ is positive. The wavenumber $k$ is typically considered in the range $[0, k_{\\text{N}}]$, where the Nyquist wavenumber is $k_{\\text{N}} = \\pi/\\Delta x$. In this range, $k \\Delta x / 2 \\in [0, \\pi/2]$, so $\\sin(k \\Delta x / 2) \\ge 0$. The problem states $\\omega_{h}(k) \\in [0, \\pi/\\Delta t]$, which implies $\\omega_{h} \\Delta t / 2 \\in [0, \\pi/2]$, so $\\sin(\\omega_{h} \\Delta t / 2) \\ge 0$. We can thus drop the absolute value signs:\n$$ \\sin\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = S\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right) $$\nApplying the inverse sine function (principal branch, as specified) yields:\n$$ \\frac{\\omega_{h}(k)\\,\\Delta t}{2} = \\arcsin\\left(S\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right) $$\nSolving for the numerical angular frequency $\\omega_h(k)$:\n$$ \\omega_{h}(k) = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{c\\,\\Delta t}{\\Delta x}\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right) $$\nThe numerical phase velocity is defined as $v_{p,h}(k) = \\omega_{h}(k)/k$. Substituting the expression for $\\omega_h(k)$ gives:\n$$ v_{p,h}(k) = \\frac{2}{k\\,\\Delta t} \\arcsin\\left(\\frac{c\\,\\Delta t}{\\Delta x}\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right) $$\nDue to the non-linear relationship between $\\omega_h$ and $k$, $v_{p,h}$ is a function of $k$, a phenomenon known as numerical dispersion. For this scheme, it can be shown that $v_{p,h}(k) \\le c$, indicating that numerical waves lag behind the true physical waves.\n\n**2. Derivation of Numerical Group Velocity ($v_{g,h}$)**\n\nThe numerical group velocity is $v_{g,h}(k) = d\\omega_{h}(k)/dk$. We differentiate the explicit expression for $\\omega_h(k)$ with respect to $k$ using the chain rule. Let $u(k) = S \\sin(k \\Delta x / 2)$. Then $\\omega_h(k) = (2/\\Delta t) \\arcsin(u(k))$.\n$$ v_{g,h}(k) = \\frac{d\\omega_h}{dk} = \\frac{2}{\\Delta t} \\frac{d}{dk}\\left(\\arcsin(u)\\right) = \\frac{2}{\\Delta t} \\frac{1}{\\sqrt{1 - u^2}} \\frac{du}{dk} $$\nThe derivative of $u(k)$ is:\n$$ \\frac{du}{dk} = \\frac{d}{dk}\\left(S \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) = S \\cos\\left(\\frac{k\\Delta x}{2}\\right) \\frac{\\Delta x}{2} $$\nSubstituting back into the expression for $v_{g,h}(k)$:\n$$ v_{g,h}(k) = \\frac{2}{\\Delta t} \\frac{1}{\\sqrt{1 - S^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}} \\left(S \\cos\\left(\\frac{k\\Delta x}{2}\\right) \\frac{\\Delta x}{2}\\right) $$\nSimplifying and substituting $S = c \\Delta t / \\Delta x$, which implies $S \\Delta x / \\Delta t = c$:\n$$ v_{g,h}(k) = \\frac{S\\,\\Delta x}{\\Delta t} \\frac{\\cos\\left(\\frac{k\\Delta x}{2}\\right)}{\\sqrt{1 - S^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}} = c \\frac{\\cos\\left(\\frac{k\\Delta x}{2}\\right)}{\\sqrt{1 - \\left(\\frac{c\\Delta t}{\\Delta x}\\right)^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}} $$\nThis expression shows that $v_{g,h}$ is also dependent on $k$. As $k \\to k_{\\text{N}} = \\pi/\\Delta x$, the term $\\cos(k \\Delta x / 2) \\to \\cos(\\pi/2) = 0$, causing the group velocity to vanish, $v_{g,h} \\to 0$. This means that high-frequency wave packets are poorly propagated by the grid. In the low-wavenumber limit ($k \\to 0$), both $v_{p,h}$ and $v_{g,h}$ approach the physical speed $c$.\n\n**3. Deviation Calculation**\n\nThe relative deviations are calculated as specified:\n- Relative phase velocity deviation: $\\delta v_{p} = \\frac{v_{p,h}(k) - c}{c}$\n- Relative group velocity deviation: $\\delta v_{g} = \\frac{v_{g,h}(k) - c}{c}$\n\nThese formulas will be implemented for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical phase and group velocities and their deviations\n    for a 1D FDTD scheme for the acoustic wave equation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (c, delta_x, delta_t, k)\n        (2500.0, 10.0, 0.002, np.pi / 40.0),\n        (2500.0, 10.0, 0.0036, np.pi / 20.0),\n        (2500.0, 10.0, 0.003996, 1e-6),\n        (2500.0, 10.0, 0.0036, np.pi / 10.0 - 1e-9),\n        (2500.0, 10.0, 0.0004, np.pi / 30.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        c, dx, dt, k = case\n\n        # Calculate the Courant number, S\n        S = c * dt / dx\n\n        # --- Phase Velocity Calculation ---\n        # Argument for the arcsin function\n        arg_asin = S * np.sin(k * dx / 2.0)\n\n        # The problem setup ensures S = 1 and k = pi/dx, so arg_asin is in [-1, 1].\n        # Numerical angular frequency omega_h(k)\n        omega_h = (2.0 / dt) * np.arcsin(arg_asin)\n\n        # Numerical phase velocity v_p,h(k) = omega_h / k\n        # For k - 0, the limit is c. Direct computation is fine for k=1e-6.\n        v_ph = omega_h / k\n\n        # --- Group Velocity Calculation ---\n        # Numerator of the group velocity expression\n        v_gh_num = c * np.cos(k * dx / 2.0)\n        \n        # Denominator of the group velocity expression\n        v_gh_den = np.sqrt(1.0 - arg_asin**2)\n        \n        # Numerical group velocity v_g,h(k)\n        v_gh = v_gh_num / v_gh_den\n        \n        # --- Deviation Calculation ---\n        # Relative deviation of phase velocity\n        dev_vph = (v_ph - c) / c\n        \n        # Relative deviation of group velocity\n        dev_vgh = (v_gh - c) / c\n        \n        results.extend([v_ph, v_gh, dev_vph, dev_vgh])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3585666"}, {"introduction": "This final practice demonstrates the power of dispersion analysis in a real-world geophysical inversion scenario. Here, the dispersion relation is not merely an object of study but a source of data for inferring properties of the medium itself. By attempting to match \"observed\" dispersion data from surface gravity waves to a theoretical model, you will use the Gauss-Newton method to update a model parameter—in this case, water depth—which showcases how wave kinematics form the basis for powerful remote sensing techniques [@problem_id:3585654].", "problem": "Consider linear gravity waves propagating at the surface of a homogeneous, inviscid, incompressible fluid of constant depth. Begin from the governing assumptions of irrotational flow and the linearized free-surface and bottom boundary conditions. Use these principles to derive the dispersion relation that connects angular frequency $\\omega$ and wavenumber $k$ through the fluid depth $h$ and gravitational acceleration $g$. The phase velocity is defined by $c = \\omega / k$. Your task is to compute synthetic dispersion curves $c(\\omega; h)$ for two candidate depth models, and then compute a single linearized Gauss-Newton step to update the depth parameter to reduce the least-squares misfit with respect to a set of \"observed\" phase velocities generated from a known \"true\" depth.\n\nRequirements and definitions:\n1. Use the linear gravity wave theory under the assumptions stated. Define the dispersion relation between $\\omega$ and $k$ based on these assumptions. The phase velocity is $c = \\omega / k$.\n2. For each angular frequency $\\omega$, compute the wavenumber $k$ by solving the dispersion relation equation for $k$ given $\\omega$, $h$, and $g$. The function in $k$ is monotonic, has a unique positive root, and must be solved numerically.\n3. Define the Root Mean Square (RMS) misfit between observed and modeled phase velocities as\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^N \\left(c_{\\mathrm{obs}, i} - c_{\\mathrm{mod}, i}(h)\\right)^2},\n$$\nwhere $N$ is the number of angular frequencies.\n4. Perform a single Gauss-Newton step to update the scalar parameter $h$ by minimizing the sum of squared residuals $\\sum_i r_i^2$ with $r_i = c_{\\mathrm{obs}, i} - c_{\\mathrm{mod}, i}(h)$. Use the linearization $r(h_0 + \\Delta h) \\approx r(h_0) - J \\Delta h$, where $J_i = \\partial c_i / \\partial h$ is evaluated at the current parameter $h_0$. For the single-parameter case, the update is\n$$\n\\Delta h = (J^\\top J)^{-1} J^\\top r.\n$$\nAfter the update, enforce physical positivity of depth by clamping $h \\leftarrow \\max(h_0 + \\Delta h, \\epsilon)$ for a small positive constant $\\epsilon$ in meters.\n5. All physical quantities must use explicit units: depth $h$ in meters (m), gravitational acceleration $g$ in meters per second squared (m/s$^2$), angular frequency $\\omega$ in radians per second (rad/s), and phase velocity $c$ in meters per second (m/s). Input frequencies are provided in Hertz (Hz) and must be converted to radians per second using $\\omega = 2\\pi f$.\n6. Observed phase velocities $c_{\\mathrm{obs}}$ are generated synthetically from the \"true\" depth $h_{\\mathrm{true}}$ by solving the dispersion relation exactly, with no added noise.\n\nTest suite specification:\nFor each test case, compute the following outputs in order:\n- $\\mathrm{RMS}_A$ in m/s for candidate depth $h_A$ before update.\n- $\\mathrm{RMS}_B$ in m/s for candidate depth $h_B$ before update.\n- $h_A^{\\mathrm{updated}}$ in m after one Gauss-Newton step from $h_A$.\n- $\\mathrm{RMS}_A^{\\mathrm{updated}}$ in m/s after the update for $h_A$.\n- $h_B^{\\mathrm{updated}}$ in m after one Gauss-Newton step from $h_B$.\n- $\\mathrm{RMS}_B^{\\mathrm{updated}}$ in m/s after the update for $h_B$.\n\nUse gravitational acceleration $g = 9.81$ m/s$^2$. Use a positivity clamp $\\epsilon = 10^{-6}$ m.\n\nProvide three test cases to exercise different regimes:\n1. Shallow-water biased regime:\n   - $h_{\\mathrm{true}} = 10$ m\n   - Candidate depths: $h_A = 5$ m, $h_B = 15$ m\n   - Frequencies in Hertz: $[0.05, 0.10, 0.20, 0.50]$\n2. Mixed regime with both shallow and deep behavior:\n   - $h_{\\mathrm{true}} = 50$ m\n   - Candidate depths: $h_A = 30$ m, $h_B = 80$ m\n   - Frequencies in Hertz: $[0.05, 0.10, 0.20, 0.50, 1.00]$\n3. Deep-water dominated regime:\n   - $h_{\\mathrm{true}} = 4000$ m\n   - Candidate depths: $h_A = 2000$ m, $h_B = 6000$ m\n   - Frequencies in Hertz: $[0.20, 0.50, 1.00]$\n\nFinal output format:\nYour program should produce a single line of output containing all results from the test suite as a comma-separated list enclosed in square brackets, in the order:\n$$\n[\\mathrm{RMS}_A^{(1)}, \\mathrm{RMS}_B^{(1)}, h_A^{\\mathrm{updated}(1)}, \\mathrm{RMS}_A^{\\mathrm{updated}(1)}, h_B^{\\mathrm{updated}(1)}, \\mathrm{RMS}_B^{\\mathrm{updated}(1)}, \\mathrm{RMS}_A^{(2)}, \\mathrm{RMS}_B^{(2)}, h_A^{\\mathrm{updated}(2)}, \\mathrm{RMS}_A^{\\mathrm{updated}(2)}, h_B^{\\mathrm{updated}(2)}, \\mathrm{RMS}_B^{\\mathrm{updated}(2)}, \\mathrm{RMS}_A^{(3)}, \\mathrm{RMS}_B^{(3)}, h_A^{\\mathrm{updated}(3)}, \\mathrm{RMS}_A^{\\mathrm{updated}(3)}, h_B^{\\mathrm{updated}(3)}, \\mathrm{RMS}_B^{\\mathrm{updated}(3)}].\n$$\nAll RMS entries are in m/s and all depth entries are in m.", "solution": "The user-provided problem is evaluated as scientifically sound, well-posed, and self-contained. It describes a standard exercise in geophysical inversion based on the established linear theory of surface gravity waves. All necessary constants, equations, and test parameters are provided. The task is to derive the governing equations and implement a numerical solution for a single-parameter inversion problem.\n\n### 1. Theoretical Foundation: The Dispersion Relation\n\nThe problem concerns linear surface gravity waves in a homogeneous, inviscid, incompressible fluid of constant depth $h$. Under the assumption of irrotational flow, a velocity potential $\\Phi(x, z, t)$ exists and satisfies the Laplace equation:\n$$\n\\nabla^2 \\Phi = \\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{\\partial^2 \\Phi}{\\partial z^2} = 0\n$$\nHere, $x$ is the horizontal coordinate, $z$ is the vertical coordinate (with $z=0$ at the mean free surface and $z=-h$ at the bottom), and $t$ is time.\n\nThe flow is subject to boundary conditions:\n1.  **Bottom Boundary Condition**: No flow normal to the flat seabed at $z = -h$.\n    $$\n    \\frac{\\partial \\Phi}{\\partial z} = 0 \\quad \\text{at} \\quad z = -h\n    $$\n2.  **Linearized Kinematic Free-Surface Condition**: Fluid particles on the surface, $z = \\eta(x, t)$, remain on the surface. For small-amplitude waves, this is evaluated at $z=0$.\n    $$\n    \\frac{\\partial \\eta}{\\partial t} = \\frac{\\partial \\Phi}{\\partial z} \\quad \\text{at} \\quad z = 0\n    $$\n3.  **Linearized Dynamic Free-Surface Condition**: The pressure at the free surface is constant. From the linearized Bernoulli equation:\n    $$\n    \\frac{\\partial \\Phi}{\\partial t} + g\\eta = 0 \\quad \\text{at} \\quad z = 0\n    $$\n    where $g$ is the acceleration due to gravity.\n\nWe seek a traveling wave solution of the form $\\Phi(x, z, t) = Z(z) e^{i(kx - \\omega t)}$, where $k$ is the wavenumber and $\\omega$ is the angular frequency. Substituting into the Laplace equation yields an ordinary differential equation for $Z(z)$:\n$$\nZ''(z) - k^2 Z(z) = 0\n$$\nThe general solution is $Z(z) = A e^{kz} + B e^{-kz}$. Applying the bottom boundary condition, $Z'(-h) = 0$, allows us to relate $A$ and $B$, leading to a solution of the form $Z(z) = C \\cosh(k(z+h))$ for some constant $C$.\n\nThe two free-surface conditions can be combined by eliminating $\\eta(x,t)$. Differentiating the dynamic condition with respect to $t$ and substituting the kinematic condition gives a single boundary condition at $z=0$:\n$$\n\\frac{\\partial^2 \\Phi}{\\partial t^2} + g \\frac{\\partial \\Phi}{\\partial z} = 0 \\quad \\text{at} \\quad z=0\n$$\nSubstituting our potential form $\\Phi(x, z, t) \\propto \\cosh(k(z+h)) e^{i(kx - \\omega t)}$ into this combined condition yields:\n$$\n(-\\omega^2) \\cosh(kh) + g (k \\sinh(kh)) = 0\n$$\nRearranging gives the celebrated dispersion relation for linear surface gravity waves:\n$$\n\\omega^2 = gk \\tanh(kh)\n$$\n\n### 2. The Forward Problem: Calculating Phase Velocity\n\nThe phase velocity is defined as $c = \\omega / k$. To compute the phase velocity $c(\\omega; h)$ for a given angular frequency $\\omega$ and depth $h$, we must first find the corresponding wavenumber $k$ by solving the dispersion relation. The equation to be solved for $k$ is:\n$$\nF(k) = gk \\tanh(kh) - \\omega^2 = 0\n$$\nThis transcendental equation does not have a closed-form solution for $k$. However, for a given $\\omega  0$, $h  0$, and $g  0$, the function $F(k)$ is strictly monotonic for $k  0$, ensuring a unique positive root. This root can be found numerically, for example, using the Newton-Raphson method. The iteration is given by:\n$$\nk_{n+1} = k_n - \\frac{F(k_n)}{F'(k_n)}\n$$\nwhere the derivative is $F'(k) = g \\tanh(kh) + gkh \\text{ sech}^2(kh)$. A suitable initial guess is the deep-water approximation $k_0 = \\omega^2/g$. Once $k$ is found, the modeled phase velocity is calculated as $c_{\\mathrm{mod}} = \\omega / k$.\n\n### 3. The Inverse Problem: Gauss-Newton Update for Depth\n\nThe goal is to update an initial estimate of the depth, $h_0$, to better fit a set of observed phase velocities, $c_{\\mathrm{obs},i}$, at various frequencies $\\omega_i$. We aim to minimize the sum of squared residuals, $S(h) = \\sum_i r_i^2$, where the residual is $r_i(h) = c_{\\mathrm{obs}, i} - c_{\\mathrm{mod}, i}(h)$.\n\nThe Gauss-Newton method is an iterative optimization algorithm that linearizes the residual function around the current estimate $h_0$:\n$$\nr_i(h_0 + \\Delta h) \\approx r_i(h_0) + \\frac{\\partial c_{\\mathrm{mod}, i}}{\\partial h}\\bigg|_{h_0} (-\\Delta h)\n$$\nIn matrix form, this is $r(h_0 + \\Delta h) \\approx r(h_0) - J \\Delta h$, where $J$ is the Jacobian matrix whose entries are $J_i = \\partial c_i / \\partial h$ evaluated at $h_0$. The least-squares solution for the update step $\\Delta h$ is:\n$$\n\\Delta h = (J^\\top J)^{-1} J^\\top r\n$$\nFor this single-parameter problem, the formula simplifies to a scalar equation:\n$$\n\\Delta h = \\frac{\\sum_i J_i r_i}{\\sum_i J_i^2}\n$$\nTo compute the Jacobian entries $J_i = \\partial c_i / \\partial h$, we use implicit differentiation on the dispersion relation $\\omega^2 = gk \\tanh(kh)$. Since $\\omega$ is a fixed independent variable, differentiating with respect to $h$ yields:\n$$\n0 = g \\frac{\\partial k}{\\partial h} \\tanh(kh) + gk \\left( \\text{sech}^2(kh) \\cdot \\left(k + h \\frac{\\partial k}{\\partial h}\\right) \\right)\n$$\nSolving for $\\partial k / \\partial h$:\n$$\n\\frac{\\partial k}{\\partial h} = -\\frac{gk^2 \\text{ sech}^2(kh)}{g \\tanh(kh) + gkh \\text{ sech}^2(kh)} = - \\frac{k^2 \\text{ sech}^2(kh)}{\\tanh(kh) + kh \\text{ sech}^2(kh)}\n$$\nNow, we find the derivative of the phase velocity $c = \\omega/k$:\n$$\n\\frac{\\partial c}{\\partial h} = -\\frac{\\omega}{k^2} \\frac{\\partial k}{\\partial h} = -\\frac{\\omega}{k^2} \\left( - \\frac{k^2 \\text{ sech}^2(kh)}{\\tanh(kh) + kh \\text{ sech}^2(kh)} \\right) = \\frac{\\omega \\text{ sech}^2(kh)}{\\tanh(kh) + kh \\text{ sech}^2(kh)}\n$$\nEach Jacobian entry $J_i$ is computed using this formula, with $\\omega_i$ and the corresponding $k_i$ (calculated using the current depth estimate $h_0$).\n\nAfter computing $\\Delta h$, the updated depth is $h_{\\mathrm{new}} = h_0 + \\Delta h$. To ensure physical plausibility, the depth is clamped to be non-negative: $h_{\\mathrm{updated}} = \\max(h_{\\mathrm{new}}, \\epsilon)$, where $\\epsilon$ is a small positive constant.\n\n### 4. Computational Algorithm\n\nThe overall procedure for each test case is as follows:\n1.  Given a set of frequencies $f_i$, convert them to angular frequencies $\\omega_i = 2\\pi f_i$.\n2.  Generate the \"observed\" data $c_{\\mathrm{obs}, i}$ by solving the forward problem for each $\\omega_i$ using the true depth $h_{\\mathrm{true}}$. This involves numerically finding $k_i$ from $\\omega_i^2 = gk_i \\tanh(k_i h_{\\mathrm{true}})$ and then computing $c_{\\mathrm{obs}, i} = \\omega_i/k_i$.\n3.  For each candidate starting depth $h_0$ (e.g., $h_A$ or $h_B$):\n    a.  Compute the initial modeled phase velocities $c_{\\mathrm{mod}, i}(h_0)$ and the initial RMS misfit, $\\sqrt{\\frac{1}{N}\\sum_i (c_{\\mathrm{obs},i} - c_{\\mathrm{mod},i}(h_0))^2}$.\n    b.  Compute the residual vector $r_i = c_{\\mathrm{obs}, i} - c_{\\mathrm{mod}, i}(h_0)$.\n    c.  Compute the Jacobian vector $J_i = \\partial c_i / \\partial h$ evaluated at $h_0$ and the corresponding wavenumbers $k_i(h_0)$.\n    d.  Calculate the depth update $\\Delta h = (\\sum_i J_i r_i) / (\\sum_i J_i^2)$. Handle the case where the denominator is near zero (deep-water regime) by setting $\\Delta h=0$.\n    e.  Calculate the updated depth $h_{\\mathrm{updated}} = \\max(h_0 + \\Delta h, \\epsilon)$.\n    f.  Compute the new modeled phase velocities $c_{\\mathrm{mod}, i}(h_{\\mathrm{updated}})$ and the new RMS misfit.\n4.  Collect and report all computed values as specified.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import newton\n\ndef solve():\n    \"\"\"\n    Main function to run the inversion for all specified test cases.\n    \"\"\"\n    G = 9.81\n    EPSILON = 1e-6\n    # For numerical stability, to avoid division by near-zero.\n    JACOBIAN_FLOOR = 1e-20 \n    \n    test_cases = [\n        {\n            \"h_true\": 10.0, \"h_A\": 5.0, \"h_B\": 15.0, \"f_hz\": [0.05, 0.10, 0.20, 0.50]\n        },\n        {\n            \"h_true\": 50.0, \"h_A\": 30.0, \"h_B\": 80.0, \"f_hz\": [0.05, 0.10, 0.20, 0.50, 1.00]\n        },\n        {\n            \"h_true\": 4000.0, \"h_A\": 2000.0, \"h_B\": 6000.0, \"f_hz\": [0.20, 0.50, 1.00]\n        },\n    ]\n\n    def solve_k(omega, h, g):\n        \"\"\"Numerically solves the dispersion relation for wavenumber k.\"\"\"\n        if h = 0 or omega = 0:\n            return np.inf\n\n        # Function whose root is sought: F(k) = gk*tanh(kh) - omega^2\n        func = lambda k: g * k * np.tanh(k * h) - omega**2\n        \n        # Derivative of F(k) w.r.t. k\n        fprime = lambda k: g * np.tanh(k * h) + g * k * h / np.cosh(k * h)**2\n        \n        # Initial guess from deep-water approximation\n        k_guess = omega**2 / g\n        \n        try:\n            k_sol = newton(func, k_guess, fprime=fprime, tol=1e-9, maxiter=50)\n        except RuntimeError:\n            k_sol = np.inf # Newton's method might fail if guess is poor, though unlikely here\n            \n        return k_sol\n\n    def compute_c_array(omegas, h, g):\n        \"\"\"Computes phase velocities for an array of frequencies.\"\"\"\n        ks = np.array([solve_k(om, h, g) for om in omegas])\n        return omegas / ks\n\n    def compute_jacobian_entry(omega, h, g, k):\n        \"\"\"Computes a single entry of the Jacobian vector, dc/dh.\"\"\"\n        tanh_kh = np.tanh(k * h)\n        sech_kh = 1.0 / np.cosh(k * h)\n        \n        numerator = omega * sech_kh**2\n        denominator = tanh_kh + k * h * sech_kh**2\n        \n        if abs(denominator)  JACOBIAN_FLOOR:\n            return 0.0\n            \n        return numerator / denominator\n\n    def process_candidate(omegas, c_obs, h_0, g, epsilon):\n        \"\"\"\n        Performs one Gauss-Newton step for a single candidate depth.\n        Returns: initial RMS, updated h, and updated RMS.\n        \"\"\"\n        # 1. Compute initial model and misfit\n        ks_0 = np.array([solve_k(om, h_0, g) for om in omegas])\n        c_mod_0 = omegas / ks_0\n        rms_0 = np.sqrt(np.mean((c_obs - c_mod_0)**2))\n\n        # 2. Compute residuals and Jacobian\n        residuals = c_obs - c_mod_0\n        jacobian = np.array([compute_jacobian_entry(om, h_0, g, k) for om, k in zip(omegas, ks_0)])\n        \n        # 3. Compute the Gauss-Newton update step\n        JTJ = np.sum(jacobian**2)\n        if JTJ  JACOBIAN_FLOOR:\n            # Data is insensitive to the parameter (e.g., deep water)\n            delta_h = 0.0\n        else:\n            JTr = np.sum(jacobian * residuals)\n            delta_h = JTr / JTJ\n            \n        # 4. Apply update and positivity clamp\n        h_updated = max(h_0 + delta_h, epsilon)\n\n        # 5. Compute updated model and misfit\n        c_mod_updated = compute_c_array(omegas, h_updated, g)\n        rms_updated = np.sqrt(np.mean((c_obs - c_mod_updated)**2))\n\n        return rms_0, h_updated, rms_updated\n\n    all_results = []\n    for case in test_cases:\n        h_true = case[\"h_true\"]\n        freqs_hz = np.array(case[\"f_hz\"])\n        omegas = 2 * np.pi * freqs_hz\n\n        # Generate \"observed\" data from true depth\n        c_obs = compute_c_array(omegas, h_true, G)\n        \n        # Process candidate A\n        h_A = case[\"h_A\"]\n        rms_A, h_A_updated, rms_A_updated = process_candidate(omegas, c_obs, h_A, G, EPSILON)\n        \n        # Process candidate B\n        h_B = case[\"h_B\"]\n        rms_B, h_B_updated, rms_B_updated = process_candidate(omegas, c_obs, h_B, G, EPSILON)\n\n        all_results.extend([\n            rms_A,\n            rms_B,\n            h_A_updated,\n            rms_A_updated,\n            h_B_updated,\n            rms_B_updated\n        ])\n    \n    print(f\"[{','.join(f'{x:.8f}' for x in all_results)}]\")\n\nsolve()\n```", "id": "3585654"}]}