{"hands_on_practices": [{"introduction": "A cornerstone of analyzing large-scale geophysical flows is the control volume approach, which applies fundamental conservation laws to a finite region of fluid. This method allows us to relate integrated quantities, such as the net force exerted by the boundaries of a channel, to the fluxes of momentum and pressure at the inlets and outlets. This practice [@problem_id:3597053] provides direct experience in applying this powerful integral balance to a canonical problem: the flow through a strait with varying geometry, a scenario directly applicable to many oceanographic and hydrological systems.", "problem": "A short, rectangular geophysical strait of horizontal axis connects two large basins. At a chosen control volume spanning the strait between two vertical cross-sections, the width varies from $B_1$ at the upstream section to $B_2$ at the downstream section, and the still-water depths at those sections are $h_1$ and $h_2$, respectively. Assume an incompressible fluid of density $\\rho$ with a free surface open to a uniform ambient pressure at both sections, hydrostatic vertical pressure distribution at each section, and depth-averaged, laterally uniform streamwise velocities at the two sections. Let the steady volumetric flow rate be $Q0$ from section $1$ to section $2$. To account for nonuniformity of the actual velocity profiles in the cross-sections, include momentum-correction coefficients $\\beta_1$ and $\\beta_2$ at sections $1$ and $2$, respectively.\n\nUsing Newton’s second law for a continuum and the steady integral momentum balance applied to the control volume, derive from first principles an expression for the net streamwise force that the solid boundaries of the strait (bed and sidewalls) exert on the fluid within the control volume, $F_w$, taking positive in the downstream direction. Express your final result entirely in terms of $\\rho$, $g$, $Q$, $B_1$, $B_2$, $h_1$, $h_2$, $\\beta_1$, and $\\beta_2$. Treat pressure as a gauge pressure relative to the common ambient reference.\n\nAs part of your derivation, clearly state the physical conditions, expressed in terms of appropriate nondimensional parameters and scale analysis, under which viscous contributions to the momentum balance may be neglected for such a control volume in a geophysical strait. Your final answer must be a single closed-form analytic expression for $F_w$ as specified above. Do not include units in the final boxed answer.", "solution": "The problem is first validated and found to be a well-posed, scientifically grounded problem in geophysical fluid dynamics. The derivation of the net streamwise force, $F_w$, exerted by the solid boundaries of the strait on the fluid within the control volume will proceed from first principles using the integral form of the steady momentum equation.\n\nThe integral momentum equation for a steady flow in a fixed control volume (CV) is a statement of Newton's second law for a continuum. In the streamwise direction, which we denote as the $x$-direction, the equation is:\n$$ \\sum F_x = \\iint_{CS} (\\rho \\mathbf{v} \\cdot \\mathbf{n}) v_x \\, dA $$\nHere, $\\sum F_x$ represents the sum of all external forces acting on the fluid within the CV in the $x$-direction. The right-hand side represents the net rate of momentum flux out of the CV across the control surface (CS), where $\\rho$ is the fluid density, $\\mathbf{v}$ is the velocity vector, $\\mathbf{n}$ is the outward-pointing unit normal vector to the control surface, and $v_x$ is the $x$-component of the velocity.\n\nThe control volume is defined as the fluid contained between the upstream cross-section $1$ and the downstream cross-section $2$. The control surface consists of the inlet area $A_1$, the outlet area $A_2$, the free surface, and the solid boundaries (bed and sidewalls).\n\nThe external forces acting on the fluid in the CV in the $x$-direction are:\n$1$. The pressure force at the upstream section $1$, $F_{p1}$, acting in the positive $x$-direction.\n$2$. The pressure force at the downstream section $2$, $F_{p2}$, acting in the negative $x$-direction.\n$3$. The net force from the solid boundaries (bed and sidewalls) on the fluid, $F_w$. This is the quantity to be determined, defined as positive in the downstream ($+x$) direction.\n\nWe assume the strait has a horizontal axis, so there is no component of gravitational force in the streamwise direction. We also neglect wind shear on the free surface, as it is stated to be open to a uniform ambient pressure. Thus, the sum of forces is:\n$$ \\sum F_x = F_{p1} - F_{p2} + F_w $$\n\nThe problem states a hydrostatic pressure distribution at sections $1$ and $2$. Working with gauge pressure, the pressure at a depth $z$ below the free surface is $p = \\rho g (h-z)$, where $h$ is the total water depth at that section. The pressure force on a rectangular cross-section of width $B$ and depth $h$ is the integral of this pressure over the area:\n$$ F_p = \\int_A p \\, dA = \\int_0^h (\\rho g (h-z)) B \\, dz = \\rho g B \\left[ hz - \\frac{z^2}{2} \\right]_0^h = \\frac{1}{2} \\rho g B h^2 $$\nApplying this to sections $1$ and $2$:\n$$ F_{p1} = \\frac{1}{2} \\rho g B_1 h_1^2 $$\n$$ F_{p2} = \\frac{1}{2} \\rho g B_2 h_2^2 $$\n\nNext, we evaluate the momentum flux term. The flux occurs only through the inlet and outlet, as there is no flow through the solid boundaries or the free surface.\nThe net rate of momentum flux out of the CV is:\n$$ \\text{Net Momentum Flux} = \\left. \\int_{A_2} \\rho v_2^2 \\, dA \\right|_{\\text{outlet}} - \\left. \\int_{A_1} \\rho v_1^2 \\, dA \\right|_{\\text{inlet}} $$\nwhere $v_1$ and $v_2$ are the local streamwise velocities at sections $1$ and $2$.\nThe problem provides depth-averaged velocities and momentum-correction coefficients $\\beta_1$ and $\\beta_2$. The momentum-correction coefficient $\\beta$ is defined to relate the true momentum flux to the flux calculated using the cross-sectionally averaged velocity, $U$, as:\n$$ \\int_A \\rho v^2 \\, dA = \\rho \\beta U^2 A $$\nThe average velocities $U_1$ and $U_2$ are related to the steady volumetric flow rate $Q$ and the cross-sectional areas $A_1 = B_1 h_1$ and $A_2 = B_2 h_2$ by the continuity equation for incompressible flow:\n$$ U_1 = \\frac{Q}{A_1} = \\frac{Q}{B_1 h_1} $$\n$$ U_2 = \\frac{Q}{A_2} = \\frac{Q}{B_2 h_2} $$\nThe net momentum flux can therefore be expressed as:\n$$ \\text{Net Momentum Flux} = \\rho \\beta_2 U_2^2 A_2 - \\rho \\beta_1 U_1^2 A_1 $$\nSubstituting the expressions for $U_1$ and $U_2$:\n$$ \\text{Net Momentum Flux} = \\rho \\beta_2 \\left(\\frac{Q}{A_2}\\right)^2 A_2 - \\rho \\beta_1 \\left(\\frac{Q}{A_1}\\right)^2 A_1 = \\rho Q^2 \\left(\\frac{\\beta_2}{A_2} - \\frac{\\beta_1}{A_1}\\right) $$\nSubstituting the geometric expressions for the areas:\n$$ \\text{Net Momentum Flux} = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) $$\n\nNow, we assemble the full momentum balance equation:\n$$ \\sum F_x = \\text{Net Momentum Flux} $$\n$$ F_{p1} - F_{p2} + F_w = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) $$\nSubstituting the expressions for the pressure forces:\n$$ \\frac{1}{2} \\rho g B_1 h_1^2 - \\frac{1}{2} \\rho g B_2 h_2^2 + F_w = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) $$\nFinally, we solve for the desired force, $F_w$:\n$$ F_w = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) - \\frac{1}{2} \\rho g B_1 h_1^2 + \\frac{1}{2} \\rho g B_2 h_2^2 $$\nRearranging the terms for clarity, we get the final expression for the force exerted by the solid boundaries on the fluid:\n$$ F_w = \\frac{1}{2} \\rho g (B_2 h_2^2 - B_1 h_1^2) + \\rho Q^2 \\left( \\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1} \\right) $$\n\nThe problem also requires stating the conditions under which viscous contributions to the momentum balance may be neglected. The derived force $F_w$ represents the total integrated force from the solid boundaries, which is a sum of pressure forces on non-parallel boundaries (form drag) and viscous shear forces (skin friction). The question asks when the skin friction component is negligible. This can be assessed through scale analysis.\n\n$1$. **High Reynolds Number**: The primary condition for viscous effects to be unimportant in the bulk flow dynamics (away from boundaries) is that the flow must have a high Reynolds number. For open-channel flow, the relevant Reynolds number is typically based on the hydraulic depth or hydraulic radius. Let $H$ be the characteristic water depth and $U$ be the characteristic velocity. The Reynolds number is $Re_H = \\frac{\\rho U H}{\\mu}$, where $\\mu$ is the dynamic viscosity of the fluid. For $Re_H \\gg 1$, inertial forces dominate over viscous forces in the bulk of the flow. The flow becomes turbulent, and viscous effects are confined to a thin boundary layer near the solid surfaces. Geophysical flows in straits almost always satisfy this condition, with $Re_H$ often being $O(10^6)$ or greater.\n\n$2$. **Short Control Volume with Dominant Form Effects**: While a high Reynolds number confines viscous action to the boundary layer, the integrated effect of boundary shear (skin friction) over the length of the control volume, $L$, may still be significant. The total viscous friction force on the wetted area is $F_{visc} \\approx \\tau_w A_{wetted}$, where $\\tau_w$ is the average wall shear stress and $A_{wetted}$ is the wetted surface area of the boundaries. $\\tau_w$ is often parameterized using a friction factor, $f$, as $\\tau_w \\propto f \\rho U^2$. The friction force is then $F_{visc} \\propto f \\rho U^2 P L$, where $P$ is the wetted perimeter.\n\nFor this viscous force to be negligible, it must be much smaller than the other terms in the momentum balance: the change in momentum flux, $\\Delta(\\rho \\beta U^2 A)$, and the net pressure force, $\\Delta(\\frac{1}{2}\\rho g B h^2)$. The relative importance of friction is often assessed by comparing the friction term to the inertial term:\n$$ \\frac{\\text{Friction Force}}{\\text{Inertial Force}} \\sim \\frac{f \\rho U^2 P L}{\\rho U^2 A} = \\frac{f L}{A/P} = \\frac{f L}{R_h} $$\nwhere $R_h$ is the hydraulic radius. Therefore, the condition to neglect the integrated viscous friction force is $\\frac{fL}{R_h} \\ll 1$. This means the control volume must be \"short\" relative to a characteristic friction length scale, $R_h/f$. In such a short, rapidly varying channel, the momentum change is dominated by acceleration/deceleration due to geometric changes (form drag and inertial effects), and the contribution from skin friction along the short length is minor.\n\nIn summary, viscous contributions can be neglected when the Reynolds number is very large ($Re_H \\gg 1$) and the geometry is such that form effects dominate skin friction, a condition quantified by the strait being short relative to its hydraulic radius ($fL/R_h \\ll 1$).", "answer": "$$\n\\boxed{\\frac{1}{2} \\rho g (B_2 h_2^2 - B_1 h_1^2) + \\rho Q^2 \\left( \\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1} \\right)}\n$$", "id": "3597053"}, {"introduction": "Models of geophysical flows, particularly in oceanography and atmospheric science, rely on simplifying approximations to remain computationally tractable. The Boussinesq approximation, which assumes density variations are small enough to be neglected except when coupled with gravity, is one of the most fundamental. This exercise [@problem_id:3597130] moves beyond simple application by challenging you to analytically derive and computationally quantify the error introduced by this approximation, a critical skill for any researcher who needs to understand the domain of validity for their numerical simulations.", "problem": "Consider a single-layer turbidity current of uniform thickness $H$ flowing horizontally into an ambient fluid of reference density $\\rho_0$. The current has uniform velocity $U$ and uniform density $\\rho$, where the density contrast is $\\Delta \\rho = \\rho - \\rho_0$. Assume the flow is incompressible and sufficiently well-mixed that a depth-averaged description is appropriate. Begin from the variable-density incompressible mass and momentum balances,\n$$\\nabla \\cdot \\mathbf{u} = 0,$$\n$$\\frac{\\partial}{\\partial t}(\\rho \\mathbf{u}) + \\nabla \\cdot (\\rho \\mathbf{u}\\mathbf{u}) = -\\nabla p + \\rho \\mathbf{g} + \\nabla \\cdot \\boldsymbol{\\tau},$$\nand the Boussinesq approximation in which $\\rho$ is replaced by $\\rho_0$ everywhere except in the buoyancy term, where the buoyancy is modeled as $b = \\dfrac{g \\Delta \\rho}{\\rho_0}$. The turbidity current is characterized by the Froude number (Fr) based on the Boussinesq reduced gravity, defined by\n$$Fr = \\frac{U}{\\sqrt{g' H}}, \\quad g' = \\frac{g \\Delta \\rho}{\\rho_0}.$$\nIn a control volume description for a uniform layer of thickness $H$ and velocity $U$, define the following depth-integrated flux budgets per unit width:\n- The exact momentum flux $\\mathcal{F}_M^{\\text{exact}} = \\int_0^H \\rho u^2 \\, dz$ and the momentum flux under the Boussinesq approximation $\\mathcal{F}_M^{\\text{B}} = \\int_0^H \\rho_0 u^2 \\, dz$.\n- The exact buoyancy acceleration entering the budget $b^{\\text{exact}} = \\dfrac{g \\Delta \\rho}{\\rho}$ and the Boussinesq buoyancy $b^{\\text{B}} = \\dfrac{g \\Delta \\rho}{\\rho_0}$.\n\nYour task is to derive, from the above fundamental balances, expressions for the following three dimensionless error measures, and then implement them in a program:\n1. The relative error in the momentum budget due to using $\\rho_0$ in the inertia, defined as\n$$\\varepsilon_M = \\frac{\\mathcal{F}_M^{\\text{B}} - \\mathcal{F}_M^{\\text{exact}}}{\\mathcal{F}_M^{\\text{exact}}}.$$\n2. The relative error in the buoyancy budget due to using $\\rho_0$ in the denominator of $b$, defined as\n$$\\varepsilon_B = \\frac{b^{\\text{B}} - b^{\\text{exact}}}{b^{\\text{exact}}}.$$\n3. A dimensionless closure residual that quantifies the mismatch between the inertial-to-buoyancy ratio computed with the exact density and the squared Froude number defined with the Boussinesq reduced gravity, for the same $U$ inferred from $Fr$ and $g'$:\n$$\\mathcal{R} = \\frac{\\rho U^2}{g \\Delta \\rho \\, H} - Fr^2.$$\n\nAll quantities must be expressed in International System of Units (SI): densities in $\\mathrm{kg/m^3}$, gravity $g$ in $\\mathrm{m/s^2}$, layer thickness $H$ in $\\mathrm{m}$, and velocity $U$ in $\\mathrm{m/s}$. The output errors $\\varepsilon_M$, $\\varepsilon_B$, and $\\mathcal{R}$ must be reported as decimal numbers (not percentages).\n\nUse the following constants in your calculations: $\\rho_0 = 1025 \\ \\mathrm{kg/m^3}$, $g = 9.81 \\ \\mathrm{m/s^2}$, and $H = 10 \\ \\mathrm{m}$. You are given a test suite of four cases, each specifying the density contrast ratio $\\Delta \\rho / \\rho$ and the Froude number $Fr$ defined with $g' = \\dfrac{g \\Delta \\rho}{\\rho_0}$:\n- Case $1$: $\\Delta \\rho / \\rho = 0$, $Fr = 0$.\n- Case $2$: $\\Delta \\rho / \\rho = 0.02$, $Fr = 1.0$.\n- Case $3$: $\\Delta \\rho / \\rho = 0.05$, $Fr = 1.5$.\n- Case $4$: $\\Delta \\rho / \\rho = 0.10$, $Fr = 0.8$.\n\nFor each case, treat $\\Delta \\rho / \\rho$ as fundamental; infer $\\rho$ from $\\rho_0$ and $\\Delta \\rho / \\rho$, and then infer $\\Delta \\rho$. Use the given $Fr$ and $g'$ to infer $U$ when needed. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list in the order $[\\varepsilon_M,\\varepsilon_B,\\mathcal{R}]$. Express all outputs as decimal numbers rounded to six decimal places. For example, the final output should look like\n$$\\big[\\,[\\varepsilon_M^{(1)},\\varepsilon_B^{(1)},\\mathcal{R}^{(1)}],\\ldots,[\\varepsilon_M^{(4)},\\varepsilon_B^{(4)},\\mathcal{R}^{(4)}]\\,\\big].$$", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and self-contained. There are no contradictions, ambiguities, or factual errors. The problem is a standard exercise in geophysical fluid dynamics, addressing the quantitative impact of the Boussinesq approximation. We may therefore proceed with the solution.\n\nThe objective is to derive expressions for three dimensionless error metrics ($\\varepsilon_M$, $\\varepsilon_B$, and $\\mathcal{R}$) that quantify discrepancies arising from the Boussinesq approximation in a model of a turbidity current. The derivations will begin from the fundamental definitions provided. Once derived, these expressions will be used to compute the metrics for a given set of test cases.\n\nThe flow is assumed to be a uniform layer of thickness $H$ with constant velocity $U$ and density $\\rho$. The ambient fluid has density $\\rho_0$. All mathematical symbols, variables, and numbers will be rendered in LaTeX as per the formatting requirements.\n\n**1. Derivation of the Momentum Budget Error, $\\varepsilon_M$**\n\nThe relative error in the momentum budget is defined as:\n$$\n\\varepsilon_M = \\frac{\\mathcal{F}_M^{\\text{B}} - \\mathcal{F}_M^{\\text{exact}}}{\\mathcal{F}_M^{\\text{exact}}}\n$$\nThe terms $\\mathcal{F}_M^{\\text{exact}}$ and $\\mathcal{F}_M^{\\text{B}}$ represent the depth-integrated momentum fluxes per unit width. Given the uniform velocity profile $u(z) = U$ and uniform density $\\rho$ within the layer (from $z=0$ to $z=H$), the integrals are evaluated as follows:\n$$\n\\mathcal{F}_M^{\\text{exact}} = \\int_0^H \\rho u^2 \\, dz = \\int_0^H \\rho U^2 \\, dz = \\rho U^2 H\n$$\n$$\n\\mathcal{F}_M^{\\text{B}} = \\int_0^H \\rho_0 u^2 \\, dz = \\int_0^H \\rho_0 U^2 \\, dz = \\rho_0 U^2 H\n$$\nSubstituting these expressions into the definition of $\\varepsilon_M$:\n$$\n\\varepsilon_M = \\frac{\\rho_0 U^2 H - \\rho U^2 H}{\\rho U^2 H}\n$$\nAssuming the current is in motion ($U \\neq 0$), we can cancel the term $U^2 H$:\n$$\n\\varepsilon_M = \\frac{\\rho_0 - \\rho}{\\rho} = -\\frac{\\rho - \\rho_0}{\\rho}\n$$\nUsing the definition of the density contrast, $\\Delta \\rho = \\rho - \\rho_0$, we arrive at the final expression:\n$$\n\\varepsilon_M = -\\frac{\\Delta \\rho}{\\rho}\n$$\nThis expression is independent of velocity $U$ and thus holds even in the limit $U \\to 0$. The error is simply the negative of the specified input ratio $\\Delta \\rho / \\rho$.\n\n**2. Derivation of the Buoyancy Budget Error, $\\varepsilon_B$**\n\nThe relative error in the buoyancy budget is defined as:\n$$\n\\varepsilon_B = \\frac{b^{\\text{B}} - b^{\\text{exact}}}{b^{\\text{exact}}}\n$$\nThe exact and Boussinesq buoyancy accelerations are given as:\n$$\nb^{\\text{exact}} = \\frac{g \\Delta \\rho}{\\rho}\n$$\n$$\nb^{\\text{B}} = \\frac{g \\Delta \\rho}{\\rho_0}\n$$\nSubstituting these into the definition of $\\varepsilon_B$:\n$$\n\\varepsilon_B = \\frac{\\frac{g \\Delta \\rho}{\\rho_0} - \\frac{g \\Delta \\rho}{\\rho}}{\\frac{g \\Delta \\rho}{\\rho}}\n$$\nAssuming a non-zero density contrast ($\\Delta \\rho \\neq 0$), we can cancel the term $g \\Delta \\rho$:\n$$\n\\varepsilon_B = \\frac{\\frac{1}{\\rho_0} - \\frac{1}{\\rho}}{\\frac{1}{\\rho}} = \\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right) \\rho = \\frac{\\rho}{\\rho_0} - 1 = \\frac{\\rho - \\rho_0}{\\rho_0}\n$$\nThus, we find:\n$$\n\\varepsilon_B = \\frac{\\Delta \\rho}{\\rho_0}\n$$\nFor computational purposes, it is useful to express $\\varepsilon_B$ in terms of the input ratio $\\Delta \\rho / \\rho$. We start with the identity $\\Delta \\rho / \\rho = 1 - \\rho_0 / \\rho$. Rearranging gives $\\rho_0 / \\rho = 1 - \\Delta \\rho / \\rho$, which implies $\\rho / \\rho_0 = (1 - \\Delta \\rho / \\rho)^{-1}$. Substituting this into our expression for $\\varepsilon_B$:\n$$\n\\varepsilon_B = \\frac{\\rho}{\\rho_0} - 1 = \\frac{1}{1 - \\frac{\\Delta \\rho}{\\rho}} - 1 = \\frac{1 - (1 - \\frac{\\Delta \\rho}{\\rho})}{1 - \\frac{\\Delta \\rho}{\\rho}} = \\frac{\\frac{\\Delta \\rho}{\\rho}}{1 - \\frac{\\Delta \\rho}{\\rho}}\n$$\nThis form is computationally robust, particularly for the case $\\Delta \\rho / \\rho = 0$, where it correctly evaluates to $\\varepsilon_B = 0$.\n\n**3. Derivation of the Closure Residual, $\\mathcal{R}$**\n\nThe dimensionless closure residual is defined as:\n$$\n\\mathcal{R} = \\frac{\\rho U^2}{g \\Delta \\rho \\, H} - Fr^2\n$$\nThe Froude number, $Fr$, is defined using the Boussinesq reduced gravity $g' = g \\Delta \\rho / \\rho_0$:\n$$\nFr = \\frac{U}{\\sqrt{g' H}} \\implies U = Fr \\sqrt{g' H} = Fr \\sqrt{\\frac{g \\Delta \\rho}{\\rho_0} H}\n$$\nSquaring this expression for $U$ gives:\n$$\nU^2 = Fr^2 \\left(\\frac{g \\Delta \\rho}{\\rho_0} H\\right)\n$$\nNow, substitute this expression for $U^2$ into the definition of $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{\\rho}{g \\Delta \\rho H} \\left(Fr^2 \\frac{g \\Delta \\rho H}{\\rho_0}\\right) - Fr^2\n$$\nAssuming $g \\neq 0$, $H \\neq 0$, and $\\Delta \\rho \\neq 0$, we can cancel terms:\n$$\n\\mathcal{R} = \\frac{\\rho}{\\rho_0} Fr^2 - Fr^2 = \\left(\\frac{\\rho}{\\rho_0} - 1\\right) Fr^2\n$$\nWe recognize the term $(\\rho / \\rho_0 - 1)$ as being equal to $\\varepsilon_B$:\n$$\n\\mathcal{R} = \\varepsilon_B Fr^2\n$$\nUsing the expression for $\\varepsilon_B$ in terms of $\\Delta \\rho / \\rho$, we obtain the final computational formula:\n$$\n\\mathcal{R} = \\left(\\frac{\\frac{\\Delta \\rho}{\\rho}}{1 - \\frac{\\Delta \\rho}{\\rho}}\\right) Fr^2\n$$\nThis final form depends only on the given parameters for each test case, $\\Delta \\rho / \\rho$ and $Fr$.\n\n**Summary of Computational Formulas**\nFor each test case, defined by a value for $\\Delta \\rho / \\rho$ and $Fr$, the three required quantities are computed as follows:\n1. $\\varepsilon_M = -(\\Delta \\rho / \\rho)$\n2. $\\varepsilon_B = \\frac{\\Delta \\rho / \\rho}{1 - \\Delta \\rho / \\rho}$\n3. $\\mathcal{R} = \\varepsilon_B \\cdot Fr^2 = \\left(\\frac{\\Delta \\rho / \\rho}{1 - \\Delta \\rho / \\rho}\\right) Fr^2$\n\nThese formulas are implemented in the provided Python code to generate the final results. The constants $\\rho_0$, $g$, and $H$ are not directly needed for computing the dimensionless error metrics once these simplified expressions are derived, showcasing the power of nondimensionalization.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates three dimensionless error metrics related to the Boussinesq\n    approximation for a set of test cases describing a turbidity current.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (density_contrast_ratio, froude_number).\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Δρ/ρ = 0, Fr = 0\n        (0.02, 1.0), # Case 2: Δρ/ρ = 0.02, Fr = 1.0\n        (0.05, 1.5), # Case 3: Δρ/ρ = 0.05, Fr = 1.5\n        (0.10, 0.8), # Case 4: Δρ/ρ = 0.10, Fr = 0.8\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_rho_over_rho, fr = case\n\n        # 1. Calculate the relative error in the momentum budget, ε_M.\n        # ε_M = -Δρ/ρ\n        epsilon_M = -delta_rho_over_rho\n\n        # 2. Calculate the relative error in the buoyancy budget, ε_B.\n        # This handles the case where delta_rho_over_rho is 0, avoiding division by zero.\n        # ε_B = (Δρ/ρ) / (1 - Δρ/ρ)\n        if delta_rho_over_rho == 1.0:\n            # This would correspond to rho_0 = 0, a physical impossibility\n            # and mathematical singularity in the formula.\n            epsilon_B = float('inf')\n        else:\n            epsilon_B = delta_rho_over_rho / (1.0 - delta_rho_over_rho)\n\n        # 3. Calculate the dimensionless closure residual, R.\n        # R = ε_B * Fr^2\n        residual_R = epsilon_B * (fr ** 2)\n        \n        # Round results to six decimal places as required.\n        # Note: round() provides standard rounding behavior.\n        # For Case 1, -0.0 rounds to -0.0. We will store it as 0.0 for cleaner representation.\n        if epsilon_M == -0.0:\n            epsilon_M = 0.0\n            \n        res_list = [\n            round(epsilon_M, 6),\n            round(epsilon_B, 6),\n            round(residual_R, 6)\n        ]\n        results.append(res_list)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Example: [[-0.0, 0.0, 0.0],[-0.02, 0.020408, 0.020408]]\n    # map(str, results) converts each sublist to its string representation.\n    # ','.join() concatenates these strings with a comma.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3597130"}, {"introduction": "A profound challenge in computational geophysics lies in accurately representing continuous physical laws within a discrete numerical framework. Kelvin's circulation theorem, which dictates the conservation of circulation for an ideal fluid, is a perfect example of such a law. This advanced practice [@problem_id:3597047] guides you through building a numerical experiment from the ground up to test the theorem, forcing you to confront and measure the errors introduced by essential components of any fluid solver, such as spatial interpolation and time-integration schemes. This provides invaluable insight into the fidelity of computational fluid dynamics simulations.", "problem": "You are tasked with constructing and evaluating a discrete test of Kelvin’s circulation theorem within a two-dimensional incompressible, inviscid setting that is appropriate for computational geophysics and fluid dynamics focusing on Navier–Stokes and Stokes regimes. The context is the incompressible Euler equations on a periodic square domain, and the quantity of interest is the circulation along a material contour. Your implementation must be a complete, runnable program and must follow the numerical specifications and output protocol described below.\n\nFundamental base and physical setting:\n- Consider the incompressible, inviscid Euler equations for a two-dimensional velocity field $\\mathbf{u}(\\mathbf{x},t)$ on a periodic square domain $\\Omega = [0,1]^2$ in meters with time in seconds. The equations are\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} = -\\nabla p/\\rho,\n\\quad \\nabla\\cdot \\mathbf{u} = 0,\n$$\nwhere $p$ is the pressure and $\\rho$ is the constant density. The circulation along a closed contour $\\mathcal{C}(t)$ advected by the flow is defined by\n$$\n\\Gamma(t) = \\oint_{\\mathcal{C}(t)} \\mathbf{u}(\\mathbf{x},t)\\cdot d\\mathbf{x},\n$$\nwith $d\\mathbf{x}$ denoting the differential element along the contour.\n\nDiscrete setup to test circulation conservation:\n- Use a steady, divergence-free velocity field on $\\Omega$ representing solid-body rotation about the center $\\mathbf{c} = (0.5,0.5)$ meters with constant angular speed $\\Omega$ (radians per second):\n$$\n\\mathbf{u}(\\mathbf{x}) = \\left(-\\Omega(y - 0.5),\\ \\Omega(x - 0.5)\\right).\n$$\n- Implement a uniform, periodic Cartesian grid with $N\\times N$ nodes and grid spacing $h = 1/N$ meters.\n- Sample the velocity field $\\mathbf{u}(\\mathbf{x})$ at the grid nodes and use periodic bilinear interpolation to obtain $\\mathbf{u}$ at arbitrary positions inside $\\Omega$.\n\nMaterial contour representation and advection:\n- Initialize a closed material contour $\\mathcal{C}(0)$ as a circle of radius $R$ meters centered at $\\mathbf{c}$, discretized by $M$ equally spaced points with $M=200$ (integer).\n- Implement two time-integration schemes to advect the contour points:\n  1. Forward Euler (first-order explicit) method.\n  2. Classical fourth-order Runge–Kutta method.\n- Use periodic boundary conditions on positions after each update so that all point coordinates remain within $[0,1)$ meters by modular wrapping.\n\nDiscrete circulation evaluation:\n- At each time step, approximate the line integral by the midpoint rule along the polygonal contour:\n$$\n\\Gamma_{\\Delta}(t) \\approx \\sum_{i=0}^{M-1} \\mathbf{u}\\big(\\mathbf{x}_{i+\\frac{1}{2}}(t)\\big)\\cdot\\big(\\mathbf{x}_{i+1}(t)-\\mathbf{x}_{i}(t)\\big),\n$$\nwhere $\\mathbf{x}_{i}(t)$ are the contour point positions, $\\mathbf{x}_{i+\\frac{1}{2}}(t)$ is the midpoint of segment $i$, and indices are taken modulo $M$. Ensure segments crossing the periodic boundary use the minimal periodic displacement in each coordinate when evaluating $\\mathbf{x}_{i+1}(t)-\\mathbf{x}_{i}(t)$ so the integral reflects the proper physical path.\n\nError quantification:\n- Define the discrete initial circulation $\\Gamma_{\\Delta}(0)$ computed with the same midpoint rule and interpolated velocity.\n- Over the evolution from time $t=0$ to $t=T$, measure the maximum relative conservation error as a dimensionless decimal float:\n$$\n\\varepsilon = \\max_{0 \\le t \\le T}\\ \\frac{\\left|\\Gamma_{\\Delta}(t) - \\Gamma_{\\Delta}(0)\\right|}{\\left|\\Gamma_{\\Delta}(0)\\right|}.\n$$\nReport $\\varepsilon$ for each test case. Time integration parameters are $\\Delta t = 2.5\\times 10^{-3}$ seconds and $T = 0.5$ seconds.\n\nUnits and constants:\n- Spatial coordinates are in meters, time in seconds, velocity in meters per second, and circulation in meter squared per second. Angular speed is $\\Omega = 2$ radians per second. All reported errors $\\varepsilon$ must be dimensionless decimal floats.\n\nTest suite:\n- Use $M=200$ points for the contour in all cases. For each test below, vary grid resolution $N$, advection scheme, and radius $R$:\n  1. Case $1$: $N=32$, scheme $=$ Forward Euler, $R=0.2$ meters.\n  2. Case $2$: $N=128$, scheme $=$ Forward Euler, $R=0.2$ meters.\n  3. Case $3$: $N=32$, scheme $=$ Runge–Kutta $4$, $R=0.2$ meters.\n  4. Case $4$: $N=128$, scheme $=$ Runge–Kutta $4$, $R=0.2$ meters.\n  5. Case $5$: $N=32$, scheme $=$ Forward Euler, $R=0.05$ meters.\n  6. Case $6$: $N=64$, scheme $=$ Runge–Kutta $4$, $R=0.4$ meters.\n\nAlgorithmic requirements:\n- Implement periodic bilinear interpolation on the grid to evaluate $\\mathbf{u}$ at arbitrary positions.\n- Implement both advection schemes for evolving the contour points.\n- Compute the discrete circulation at every step using the midpoint rule and minimal periodic displacement for segments.\n- For each test case, compute and record the single scalar $\\varepsilon$.\n\nFinal output format:\n- Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5,r6]\"), where each $r_i$ is the computed $\\varepsilon$ for case $i$ as a decimal float.", "solution": "The appropriate fundamental base begins with the incompressible inviscid Euler equations and the definition of circulation. The governing equations for a two-dimensional velocity field $\\mathbf{u}(\\mathbf{x},t)$ and pressure $p(\\mathbf{x},t)$ with constant density $\\rho$ are\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} = -\\nabla p/\\rho,\\qquad \\nabla\\cdot \\mathbf{u} = 0.\n$$\nLet $\\mathcal{C}(t)$ be a closed material contour advected by the flow, so the points on $\\mathcal{C}(t)$ satisfy the ordinary differential equation (ODE) $d\\mathbf{x}/dt = \\mathbf{u}(\\mathbf{x},t)$. The circulation along $\\mathcal{C}(t)$ is\n$$\n\\Gamma(t) = \\oint_{\\mathcal{C}(t)} \\mathbf{u}(\\mathbf{x},t)\\cdot d\\mathbf{x}.\n$$\nTo connect to Kelvin’s circulation theorem, differentiate $\\Gamma(t)$ with respect to time and use the transport of line integrals along an advected curve:\n$$\n\\frac{d}{dt}\\Gamma(t) = \\oint_{\\mathcal{C}(t)} \\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{u}\\right)\\cdot d\\mathbf{x}.\n$$\nSubstituting the inviscid Euler equations yields\n$$\n\\frac{d}{dt}\\Gamma(t) = \\oint_{\\mathcal{C}(t)} -\\nabla\\left(\\frac{p}{\\rho}\\right)\\cdot d\\mathbf{x}.\n$$\nFor barotropic fluids with conservative body forces (absorbed into a potential), the integrand is an exact gradient, and the integral of a gradient around a closed contour is zero. Thus, under these assumptions,\n$$\n\\frac{d}{dt}\\Gamma(t) = 0,\n$$\nwhich is Kelvin’s circulation theorem: circulation along a material curve is conserved.\n\nFor the solid-body rotation field used here, define $\\mathbf{c}=(0.5,0.5)$ and angular speed $\\Omega$. The velocity is\n$$\n\\mathbf{u}(\\mathbf{x}) = \\left(-\\Omega(y - 0.5),\\ \\Omega(x - 0.5)\\right).\n$$\nIts vorticity is $\\omega = \\partial_x u_y - \\partial_y u_x = 2\\Omega$, constant in space and time. The pressure that makes this a steady solution of the Euler equations can be found from the centrifugal acceleration: $(\\mathbf{u}\\cdot \\nabla)\\mathbf{u} = \\Omega^2(x-0.5,\\ y-0.5)$, which is the gradient of $\\frac{1}{2}\\Omega^2\\left[(x-0.5)^2+(y-0.5)^2\\right]$. Choosing $p/\\rho$ equal to that potential (up to a constant) yields $\\partial_t \\mathbf{u} = \\mathbf{0}$ and ensures the Euler equations hold. Therefore, the continuous circulation $\\Gamma(t)$ along any material loop remains constant.\n\nNumerical discretization and sources of error:\n- Spatial discretization: The velocity field is sampled on a uniform periodic grid with spacing $h=1/N$ and interpolated using bilinear interpolation to evaluate $\\mathbf{u}$ at arbitrary positions. Bilinear interpolation introduces a local spatial error that is typically $\\mathcal{O}(h^2)$ for smooth fields when evaluating pointwise values, but the effective error on advected trajectories and line integrals depends on path geometry and sampling.\n- Time integration of contour points: The points of the loop are advanced by either forward Euler (a first-order method) or classical Runge–Kutta $4$ (a fourth-order method). The local truncation error is $\\mathcal{O}(\\Delta t^2)$ for forward Euler and $\\mathcal{O}(\\Delta t^5)$ for Runge–Kutta $4$, leading to global errors scaling as $\\mathcal{O}(\\Delta t)$ and $\\mathcal{O}(\\Delta t^4)$, respectively.\n- Line integral approximation: The circulation integral is approximated via the midpoint rule along the polygonal contour, which introduces a quadrature error that decays with the segment size. With $M$ equally spaced points, the segment length scales as $\\mathcal{O}(1/M)$ and the midpoint rule error along smooth curves scales as $\\mathcal{O}(M^{-2})$ for the segments if the velocity is sufficiently smooth.\n\nAlgorithmic design:\n1. Define the periodic domain $\\Omega = [0,1)^2$ and angular speed $\\Omega = 2$ (radians per second).\n2. Construct a uniform grid of size $N\\times N$ and sample $\\mathbf{u}$ at grid nodes $\\{(x_i,y_j)\\}$ with $x_i = i/N$, $y_j = j/N$, $i,j\\in\\{0,\\dots,N-1\\}$, storing arrays $u_x[i,j] = -\\Omega(y_j-0.5)$ and $u_y[i,j] = \\Omega(x_i-0.5)$.\n3. Implement periodic bilinear interpolation: for a point $(x,y)$, compute fractional indices $\\xi = xN - \\lfloor xN\\rfloor$, $\\eta = yN - \\lfloor yN\\rfloor$, wrap integer indices modulo $N$, and form the bilinear combination of the four surrounding grid-node values for $u_x$ and $u_y$.\n4. Initialize a circular loop of radius $R$ centered at $\\mathbf{c}$ with $M=200$ points parametrized by angle $\\theta_k = 2\\pi k/M$, $k=0,\\dots,M-1$, and positions $\\mathbf{x}_k(0) = \\mathbf{c} + R(\\cos\\theta_k,\\sin\\theta_k)$ modulo the periodic domain.\n5. Implement two time-stepping schemes to advance the positions:\n   - Forward Euler: $\\mathbf{x}_k^{n+1} = \\mathrm{mod}_1\\left(\\mathbf{x}_k^{n} + \\Delta t\\,\\mathbf{u}(\\mathbf{x}_k^{n})\\right)$.\n   - Runge–Kutta $4$: with stages $\\mathbf{k}_1=\\mathbf{u}(\\mathbf{x}_k^n)$, $\\mathbf{k}_2=\\mathbf{u}(\\mathbf{x}_k^n + \\tfrac{1}{2}\\Delta t\\,\\mathbf{k}_1)$, $\\mathbf{k}_3=\\mathbf{u}(\\mathbf{x}_k^n + \\tfrac{1}{2}\\Delta t\\,\\mathbf{k}_2)$, $\\mathbf{k}_4=\\mathbf{u}(\\mathbf{x}_k^n + \\Delta t\\,\\mathbf{k}_3)$, update $\\mathbf{x}_k^{n+1} = \\mathrm{mod}_1\\left(\\mathbf{x}_k^n + \\tfrac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\\right)$.\n6. Compute discrete circulation by the midpoint rule at each time step:\n   - For segment $i$ from $\\mathbf{x}_i$ to $\\mathbf{x}_{i+1}$ with indices modulo $M$, enforce minimal periodic displacement component-wise: define $\\Delta \\mathbf{x}_i$ so each component lies in $[-0.5,0.5]$ by adding or subtracting $1$ if necessary. Set midpoint $\\mathbf{x}_{i+\\frac{1}{2}} = \\mathrm{mod}_1\\left(\\mathbf{x}_i + \\tfrac{1}{2}\\Delta \\mathbf{x}_i\\right)$. Evaluate $\\mathbf{u}$ at the midpoint via interpolation and accumulate $\\mathbf{u}(\\mathbf{x}_{i+\\frac{1}{2}})\\cdot \\Delta \\mathbf{x}_i$.\n   - The sum over all segments yields $\\Gamma_{\\Delta}(t)$ with units of meter squared per second.\n7. For each test case, compute $\\Gamma_{\\Delta}(0)$ and evolve until $T=0.5$ seconds with time step $\\Delta t = 2.5\\times 10^{-3}$ seconds. Compute the maximum relative conservation error $\\varepsilon = \\max_{t\\in[0,T]} |\\Gamma_{\\Delta}(t)-\\Gamma_{\\Delta}(0)|/|\\Gamma_{\\Delta}(0)|$.\n\nScientific rationale:\n- Kelvin’s circulation theorem guarantees exact conservation of circulation for the continuous Euler solution. Deviations observed numerically are due to discretization: interpolation, time-stepping, and line-integration quadrature.\n- With bilinear interpolation on a smooth linear velocity field, the interpolation error arises from sampling onto a grid and is reduced with increasing $N$; Runge–Kutta $4$ decreases time-stepping error relative to forward Euler. The midpoint rule along a sufficiently resolved loop ($M=200$) produces small quadrature error.\n\nThe program aggregates the six $\\varepsilon$ values into the required single-line output format. No external input is required, and all units are handled as specified. The test suite targets different aspects: lower versus higher grid resolution ($N$), advection scheme order (Forward Euler versus Runge–Kutta $4$), and loop size $R$ (including a small-loop edge case with $R=0.05$ meters and a larger loop with $R=0.4$ meters that emphasizes periodic geometry).", "answer": "```python\nimport numpy as np\n\n# Computational test of discrete Kelvin's circulation conservation under solid-body rotation.\n# Environment: Python 3.12, numpy 1.23.5. No external input.\n\ndef build_velocity_grid(N, Omega=2.0, center=(0.5, 0.5)):\n    \"\"\"\n    Sample the analytic solid-body rotation velocity on an NxN periodic grid.\n    u(x,y) = (-Omega*(y - cy), Omega*(x - cx))\n    \"\"\"\n    cx, cy = center\n    # Grid coordinates (nodes), periodic domain [0,1)\n    x = np.linspace(0.0, 1.0, N, endpoint=False)\n    y = np.linspace(0.0, 1.0, N, endpoint=False)\n    X, Y = np.meshgrid(x, y, indexing='ij')\n    ux = -Omega * (Y - cy)\n    uy =  Omega * (X - cx)\n    return ux, uy\n\ndef bilinear_interp_periodic(x, y, ux, uy):\n    \"\"\"\n    Periodic bilinear interpolation of velocity from uniform grid arrays ux, uy.\n    Positions x, y assumed in [0,1). Returns velocity at (x,y) as array [u_x, u_y].\n    \"\"\"\n    N = ux.shape[0]\n    # Convert to fractional grid indices\n    gx = x * N\n    gy = y * N\n    i = int(np.floor(gx)) % N\n    j = int(np.floor(gy)) % N\n    ip1 = (i + 1) % N\n    jp1 = (j + 1) % N\n    fx = gx - np.floor(gx)\n    fy = gy - np.floor(gy)\n\n    # Bilinear weights\n    w00 = (1.0 - fx) * (1.0 - fy)\n    w10 = fx * (1.0 - fy)\n    w01 = (1.0 - fx) * fy\n    w11 = fx * fy\n\n    uxi = w00 * ux[i, j] + w10 * ux[ip1, j] + w01 * ux[i, jp1] + w11 * ux[ip1, jp1]\n    uyi = w00 * uy[i, j] + w10 * uy[ip1, j] + w01 * uy[i, jp1] + w11 * uy[ip1, jp1]\n    return np.array([uxi, uyi])\n\ndef interp_field(points, ux, uy):\n    \"\"\"\n    Vectorized interpolation of velocity at multiple points using bilinear periodic interpolation.\n    points: array of shape (M,2) with coordinates in [0,1).\n    Returns array of shape (M,2) with velocities.\n    \"\"\"\n    M = points.shape[0]\n    vel = np.empty_like(points)\n    N = ux.shape[0]\n    # Compute grid indices and fractions\n    gx = points[:, 0] * N\n    gy = points[:, 1] * N\n    i = np.floor(gx).astype(int) % N\n    j = np.floor(gy).astype(int) % N\n    ip1 = (i + 1) % N\n    jp1 = (j + 1) % N\n    fx = gx - np.floor(gx)\n    fy = gy - np.floor(gy)\n\n    # Gather corner values\n    ux00 = ux[i, j]\n    ux10 = ux[ip1, j]\n    ux01 = ux[i, jp1]\n    ux11 = ux[ip1, jp1]\n    uy00 = uy[i, j]\n    uy10 = uy[ip1, j]\n    uy01 = uy[i, jp1]\n    uy11 = uy[ip1, jp1]\n\n    # Bilinear weights\n    w00 = (1.0 - fx) * (1.0 - fy)\n    w10 = fx * (1.0 - fy)\n    w01 = (1.0 - fx) * fy\n    w11 = fx * fy\n\n    vel[:, 0] = w00 * ux00 + w10 * ux10 + w01 * ux01 + w11 * ux11\n    vel[:, 1] = w00 * uy00 + w10 * uy10 + w01 * uy01 + w11 * uy11\n    return vel\n\ndef advance_points(points, dt, ux, uy, scheme=\"euler\"):\n    \"\"\"\n    Advance contour points by one time step with periodic wrapping.\n    scheme: \"euler\" or \"rk4\".\n    \"\"\"\n    if scheme == \"euler\":\n        k1 = interp_field(points, ux, uy)\n        new_points = points + dt * k1\n    elif scheme == \"rk4\":\n        k1 = interp_field(points, ux, uy)\n        k2 = interp_field(points + 0.5 * dt * k1, ux, uy)\n        k3 = interp_field(points + 0.5 * dt * k2, ux, uy)\n        k4 = interp_field(points + dt * k3, ux, uy)\n        new_points = points + (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n    else:\n        raise ValueError(\"Unknown scheme: {}\".format(scheme))\n    # Periodic wrapping to [0,1)\n    new_points = new_points % 1.0\n    return new_points\n\ndef minimal_periodic_delta(a, b):\n    \"\"\"\n    Compute minimal periodic displacement vector from a to b in [0,1)^2.\n    Returns vector d such that each component lies in [-0.5, 0.5].\n    \"\"\"\n    d = b - a\n    # Adjust per component\n    for k in range(2):\n        if d[k] > 0.5:\n            d[k] -= 1.0\n        elif d[k]  -0.5:\n            d[k] += 1.0\n    return d\n\ndef compute_circulation(points, ux, uy):\n    \"\"\"\n    Compute discrete circulation using midpoint rule along polygonal contour.\n    points: array (M,2)\n    ux, uy: grid arrays for velocity\n    Returns scalar Gamma in m^2/s.\n    \"\"\"\n    M = points.shape[0]\n    total = 0.0\n    for i in range(M):\n        p = points[i]\n        q = points[(i + 1) % M]\n        # Minimal periodic segment displacement\n        dq = minimal_periodic_delta(p, q)\n        mid = (p + 0.5 * dq) % 1.0\n        umid = bilinear_interp_periodic(mid[0], mid[1], ux, uy)\n        total += umid[0] * dq[0] + umid[1] * dq[1]\n    return total\n\ndef initialize_circle(M, R, center=(0.5, 0.5)):\n    \"\"\"\n    Initialize M-point circle of radius R centered at center within [0,1)^2.\n    \"\"\"\n    cx, cy = center\n    k = np.arange(M)\n    theta = (2.0 * np.pi) * (k / M)\n    x = cx + R * np.cos(theta)\n    y = cy + R * np.sin(theta)\n    points = np.column_stack((x, y)) % 1.0\n    return points\n\ndef run_case(N, scheme, R, M=200, dt=2.5e-3, T=0.5, Omega=2.0):\n    \"\"\"\n    Run a single test case and return the maximum relative conservation error epsilon.\n    \"\"\"\n    # Build velocity grid\n    ux, uy = build_velocity_grid(N, Omega=Omega)\n    # Initialize contour\n    points = initialize_circle(M, R)\n    # Initial discrete circulation\n    Gamma0 = compute_circulation(points, ux, uy)\n    # Time loop\n    steps = int(np.round(T / dt))\n    max_rel_err = 0.0\n    for _ in range(steps):\n        points = advance_points(points, dt, ux, uy, scheme=scheme)\n        Gamma = compute_circulation(points, ux, uy)\n        rel_err = abs(Gamma - Gamma0) / (abs(Gamma0) + 1e-16)\n        if rel_err > max_rel_err:\n            max_rel_err = rel_err\n    return max_rel_err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N, scheme, R)\n    test_cases = [\n        (32, \"euler\", 0.2),   # Case 1\n        (128, \"euler\", 0.2),  # Case 2\n        (32, \"rk4\", 0.2),     # Case 3\n        (128, \"rk4\", 0.2),    # Case 4\n        (32, \"euler\", 0.05),  # Case 5\n        (64, \"rk4\", 0.4),     # Case 6\n    ]\n\n    results = []\n    for N, scheme, R in test_cases:\n        epsilon = run_case(N, scheme, R)\n        results.append(epsilon)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3597047"}]}