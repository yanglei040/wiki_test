{"hands_on_practices": [{"introduction": "When we discretize a partial differential equation, the resulting numerical scheme rarely solves the original equation exactly. A powerful technique to understand the scheme's true behavior is modified equation analysis. This exercise guides you through deriving the modified PDE for the forward-Euler time integration of an upwind-discretized advection equation, revealing how the leading-order truncation errors manifest as a physical-like term: numerical diffusion. Mastering this analysis provides deep insight into a method's dissipative properties and is a fundamental skill for diagnosing the behavior of numerical simulations. [@problem_id:3590104]", "problem": "Consider one-dimensional passive tracer transport in computational geophysics governed by the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a0$. On a uniform spatial grid with spacing $\\Delta x$, adopt the first-order upwind finite difference for the spatial derivative consistent with $a0$, and then integrate the resulting semi-discrete ordinary differential equation in time using the explicit forward Euler one-step method with time step $h$. Let $u_{i}^{n}$ denote the numerical approximation to $u(x_{i}, t_{n})$ at grid point $x_{i}$ and time level $t_{n}$.\n\nStarting from the conservation law and the stated discretizations, derive the modified partial differential equation that the fully discrete scheme satisfies to leading nontrivial order in $h$ and $\\Delta x$ by systematically expanding both the temporal and spatial discretizations for a smooth $u(x,t)$, and using the original partial differential equation to eliminate time derivatives in favor of spatial derivatives. From your modified equation, identify the leading-order artificial diffusion term and quantify its coefficient solely in terms of $a$, $h$, and $\\Delta x$.\n\nProvide your final answer as the closed-form analytic expression for the coefficient of the leading-order numerical diffusion term. No rounding is required, and no units should be included in the final expression.", "solution": "The problem requires the derivation of the coefficient of the leading-order artificial diffusion term for a numerical scheme applied to the one-dimensional linear advection equation. The derivation proceeds by analyzing the modified partial differential equation that the discrete scheme satisfies.\n\nThe governing partial differential equation (PDE) is the linear advection equation:\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nwhere $u = u(x, t)$ is the transported quantity, $t$ is time, $x$ is the spatial coordinate, and $a0$ is a constant advection speed.\n\nThe numerical scheme is constructed on a uniform grid with spatial step $\\Delta x$ and time step $h$.\nThe spatial derivative $u_x$ is discretized using the first-order upwind finite difference. Since the advection speed $a$ is positive, the \"upwind\" direction is to the left (in the direction of decreasing $x$), so a first-order backward difference is used:\n$$\nu_{x}(x_{i}, t_{n}) \\approx \\frac{u(x_{i}, t_{n}) - u(x_{i} - \\Delta x, t_{n})}{\\Delta x} = \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}\n$$\nSubstituting this into the governing PDE gives the semi-discrete system of ordinary differential equations (ODEs):\n$$\n\\frac{du_{i}(t)}{dt} + a \\left( \\frac{u_{i}(t) - u_{i-1}(t)}{\\Delta x} \\right) = 0\n$$\nThis system is then integrated in time using the explicit forward Euler method. For an ODE of the form $\\frac{dy}{dt} = f(y)$, the forward Euler method is given by $\\frac{y^{n+1} - y^{n}}{h} = f(y^{n})$. Applying this to our semi-discrete system, we have:\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{h} = -a \\left( \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} \\right)\n$$\nThis is the fully discrete finite difference equation for the scheme.\n\nTo derive the modified PDE, we perform a Taylor series expansion of each term in the fully discrete equation around the grid point $(x_{i}, t_{n})$. We assume that the solution $u(x,t)$ is sufficiently smooth.\n\nThe expansion for the time-dependent term $u_{i}^{n+1}$ is:\n$$\nu_{i}^{n+1} = u(x_{i}, t_{n}+h) = u(x_i, t_n) + h \\frac{\\partial u}{\\partial t} + \\frac{h^{2}}{2!} \\frac{\\partial^{2} u}{\\partial t^{2}} + O(h^{3})\n$$\nThe expansion for the spatially-displaced term $u_{i-1}^{n}$ is:\n$$\nu_{i-1}^{n} = u(x_{i}-\\Delta x, t_{n}) = u(x_i, t_n) - \\Delta x \\frac{\\partial u}{\\partial x} + \\frac{(\\Delta x)^{2}}{2!} \\frac{\\partial^{2} u}{\\partial x^{2}} - \\frac{(\\Delta x)^{3}}{3!} \\frac{\\partial^{3} u}{\\partial x^{3}} + O((\\Delta x)^{4})\n$$\nUsing subscript notation for partial derivatives (e.g., $u_t = \\frac{\\partial u}{\\partial t}$), and evaluating all derivatives at $(x_i, t_n)$, the expansions are:\n$$\nu_{i}^{n+1} = u + h u_{t} + \\frac{h^{2}}{2} u_{tt} + O(h^{3})\n$$\n$$\nu_{i-1}^{n} = u - \\Delta x u_{x} + \\frac{(\\Delta x)^{2}}{2} u_{xx} + O((\\Delta x)^{3})\n$$\nNow, substitute these expansions into the discrete scheme. Let's first re-arrange the scheme as:\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{h} + a\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = 0\n$$\nSubstituting the expansions for the two terms:\nThe time-difference term becomes:\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{h} = \\frac{1}{h} \\left( \\left( u + h u_{t} + \\frac{h^{2}}{2} u_{tt} + \\dots \\right) - u \\right) = u_{t} + \\frac{h}{2} u_{tt} + O(h^{2})\n$$\nThe space-difference term becomes:\n$$\na\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = \\frac{a}{\\Delta x} \\left( u - \\left( u - \\Delta x u_{x} + \\frac{(\\Delta x)^{2}}{2} u_{xx} - \\dots \\right) \\right) = \\frac{a}{\\Delta x} \\left( \\Delta x u_{x} - \\frac{(\\Delta x)^{2}}{2} u_{xx} + \\dots \\right) = a u_{x} - \\frac{a \\Delta x}{2} u_{xx} + O((\\Delta x)^{2})\n$$\nCombining these expanded terms back into the equation:\n$$\n\\left(u_{t} + \\frac{h}{2} u_{tt} + \\dots \\right) + \\left(a u_{x} - \\frac{a \\Delta x}{2} u_{xx} + \\dots \\right) = 0\n$$\nGrouping the terms, we get:\n$$\n(u_{t} + a u_{x}) + \\left( \\frac{h}{2} u_{tt} - \\frac{a \\Delta x}{2} u_{xx} \\right) + \\text{H.O.T.} = 0\n$$\nwhere H.O.T. stands for higher-order terms. For a smooth solution $u$ that satisfies the original PDE, the term $(u_{t} + a u_{x})$ is exactly zero. The remaining terms represent the truncation error of the numerical scheme. The modified PDE is the equation that the numerical solution effectively solves, which is the original PDE plus the leading-order truncation error terms:\n$$\nu_{t} + a u_{x} = - \\left( \\frac{h}{2} u_{tt} - \\frac{a \\Delta x}{2} u_{xx} \\right) + \\text{H.O.T.} = \\frac{a \\Delta x}{2} u_{xx} - \\frac{h}{2} u_{tt} + \\text{H.O.T.}\n$$\nThe problem requires that we eliminate time derivatives in favor of spatial derivatives using the original PDE, $u_t = -a u_x$. Assuming sufficient smoothness of $u$, we can differentiate this relation to find an expression for $u_{tt}$:\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(u_{t}) = \\frac{\\partial}{\\partial t}(-a u_{x})\n$$\nSince $a$ is constant and derivatives commute for a smooth function ($u_{tx} = u_{xt}$), we have:\n$$\nu_{tt} = -a \\frac{\\partial}{\\partial t} \\left(\\frac{\\partial u}{\\partial x}\\right) = -a \\frac{\\partial}{\\partial x} \\left(\\frac{\\partial u}{\\partial t}\\right) = -a \\frac{\\partial}{\\partial x}(u_{t})\n$$\nSubstitute $u_t = -a u_x$ again:\n$$\nu_{tt} = -a \\frac{\\partial}{\\partial x}(-a u_{x}) = a^{2} \\frac{\\partial^{2} u}{\\partial x^{2}} = a^{2} u_{xx}\n$$\nNow, substitute this result for $u_{tt}$ back into the modified equation:\n$$\nu_{t} + a u_{x} = \\frac{a \\Delta x}{2} u_{xx} - \\frac{h}{2} (a^{2} u_{xx}) + \\text{H.O.T.}\n$$\nCombining the terms with $u_{xx}$:\n$$\nu_{t} + a u_{x} = \\left( \\frac{a \\Delta x}{2} - \\frac{a^{2} h}{2} \\right) u_{xx} + \\text{H.O.T.}\n$$\nThis is the modified advection-diffusion equation. The term on the right-hand side, proportional to $u_{xx}$, is the leading-order artificial diffusion (or numerical diffusion) term. The coefficient of this term is the artificial diffusion coefficient.\nBy inspection, the coefficient of the $u_{xx}$ term is:\n$$\nD_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^{2} h}{2}\n$$\nThis is the required expression for the coefficient of the leading-order numerical diffusion term.", "answer": "$$\\boxed{\\frac{a \\Delta x}{2} - \\frac{a^{2} h}{2}}$$", "id": "3590104"}, {"introduction": "For explicit time-stepping methods applied to wave propagation problems, stability is paramount, as exceeding a critical time step size can cause numerical solutions to grow without bound. This hands-on problem challenges you to perform a complete linear stability analysis from first principles by combining the properties of the time integrator with those of the spatial discretization. By deriving the maximum stable time step for a third-order Runge-Kutta method applied to the advection equation, you will master the connection between a method's stability region and the spectrum of the spatial operator, a critical skill for any computational scientist. [@problem_id:3590090]", "problem": "Consider the linear one-dimensional advection equation $u_t + a\\,u_x = 0$ with constant wave speed $a0$ on a periodic domain, discretized in space on a uniform grid with spacing $\\Delta x0$ by the first-order upwind difference. Denote the semi-discrete state vector by $y(t) \\in \\mathbb{C}^N$ collecting the grid point values, and the semi-discretization by $y'(t) = A\\,y(t)$, where $A \\in \\mathbb{C}^{N \\times N}$ is the circulant matrix associated with the upwind stencil. You will advance this ordinary differential equation (ODE) in time using the third-order, three-stage Strong Stability Preserving Runge–Kutta method (SSPRK(3,3)). The time-step $h0$ is said to be linearly stable if, for the linear constant-coefficient system $y' = A\\,y$, the one-step amplification factor defined by the SSPRK(3,3) stability polynomial $R(z)$ satisfies $\\lvert R(h\\,\\lambda_k) \\rvert \\le 1$ for all eigenvalues $\\lambda_k$ of $A$.\n\nStarting from the fundamental bases:\n- The semi-discretization $y' = A\\,y$ of $u_t + a\\,u_x = 0$ using the upwind difference with periodic boundary conditions produces a normal circulant matrix $A$ that is diagonalizable by the discrete Fourier transform, with eigenvalues that depend on the Fourier wave numbers.\n- The stability requirement for an explicit one-step method applied to a linear system $y' = A\\,y$ is that the method’s stability polynomial $R(z)$ satisfies $\\lvert R(h\\,\\lambda_k) \\rvert \\le 1$ for all eigenvalues $\\lambda_k$ of $A$.\n\nYour task is to derive, from first principles and without invoking any pre-stated formulas for $R(z)$ or for the eigenvalues of $A$, the maximal stable time step $h_{\\max}$ in seconds for the SSPRK(3,3) method applied to this semi-discretization, expressed in terms of $a$ and $\\Delta x$. Then, implement a program that computes $h_{\\max}$ for each of the specified test cases below. Express every $h_{\\max}$ in seconds, rounded to eight decimal places.\n\nThe required final output format is a single line containing a comma-separated list enclosed in square brackets, for example, \"[0.12345678,0.87654321]\". There must be no spaces in the list.\n\nUse the following test suite of parameter values, each interpreted as $(a,\\Delta x)$ in units of meters per second for $a$ and meters for $\\Delta x$:\n1. $(1.0,\\,1.0)$\n2. $(2.0,\\,1.0)$\n3. $(0.5,\\,0.1)$\n4. $(1000.0,\\,1.0)$\n5. $(1.0,\\,10^{-3})$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered corresponding to the above test cases, each entry equal to $h_{\\max}$ in seconds rounded to eight decimal places.", "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a standard, solvable problem in the numerical analysis of partial differential equations. We will now proceed with a formal derivation from first principles.\n\nThe objective is to find the maximum stable time step, $h_{\\max}$, for the third-order Strong Stability Preserving Runge-Kutta (SSPRK(3,3)) method applied to the semi-discretization of the linear advection equation, $u_t + a u_x = 0$, with constant wave speed $a0$. The spatial discretization uses the first-order upwind scheme on a periodic domain with grid spacing $\\Delta x$.\n\nThe derivation proceeds in four principal steps:\n1.  Derive the stability polynomial $R(z)$ for the SSPRK(3,3) method.\n2.  Derive the eigenvalues $\\lambda_k$ of the spatial discretization matrix $A$.\n3.  Establish the stability condition by relating the eigenvalues of the discretized system to the stability region of the time-stepping method.\n4.  Solve for the maximal Courant-Friedrichs-Lewy (CFL) number and subsequently for $h_{\\max}$.\n\n**1. The SSPRK(3,3) Stability Polynomial**\n\nThe SSPRK(3,3) method is defined by the following three stages for an ODE $y'(t) = f(y(t))$:\n$$ y^{(1)} = y_n + h f(y_n) $$\n$$ y^{(2)} = \\frac{3}{4} y_n + \\frac{1}{4} \\left( y^{(1)} + h f(y^{(1)}) \\right) $$\n$$ y_{n+1} = \\frac{1}{3} y_n + \\frac{2}{3} \\left( y^{(2)} + h f(y^{(2)}) \\right) $$\nTo find the stability polynomial, we apply this method to the linear test equation $y' = \\lambda y$, where $\\lambda \\in \\mathbb{C}$. In this context, $f(y) = \\lambda y$. Let $z = h\\lambda$. The stages become:\n$$ y^{(1)} = y_n + z y_n = (1+z) y_n $$\n$$ y^{(2)} = \\frac{3}{4} y_n + \\frac{1}{4} (y^{(1)} + z y^{(1)}) = \\frac{3}{4} y_n + \\frac{1}{4}(1+z)y^{(1)} = \\left[ \\frac{3}{4} + \\frac{1}{4}(1+z)^2 \\right] y_n $$\nExpanding the term in the brackets:\n$$ \\frac{3}{4} + \\frac{1}{4}(1 + 2z + z^2) = \\frac{3}{4} + \\frac{1}{4} + \\frac{1}{2}z + \\frac{1}{4}z^2 = 1 + \\frac{1}{2}z + \\frac{1}{4}z^2 $$\nSo, $y^{(2)} = (1 + \\frac{1}{2}z + \\frac{1}{4}z^2) y_n$. Finally, the third stage gives $y_{n+1}$:\n$$ y_{n+1} = \\frac{1}{3} y_n + \\frac{2}{3}(y^{(2)} + z y^{(2)}) = \\frac{1}{3} y_n + \\frac{2}{3}(1+z)y^{(2)} $$\nSubstituting the expression for $y^{(2)}$:\n$$ y_{n+1} = \\left[ \\frac{1}{3} + \\frac{2}{3}(1+z)\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2\\right) \\right] y_n $$\nThe amplification factor, or stability polynomial $R(z)$, is the expression in the brackets, $y_{n+1}/y_n$. Expanding this polynomial:\n$$ R(z) = \\frac{1}{3} + \\frac{2}{3}\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2 + z + \\frac{1}{2}z^2 + \\frac{1}{4}z^3\\right) $$\n$$ R(z) = \\frac{1}{3} + \\frac{2}{3}\\left(1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3\\right) $$\n$$ R(z) = \\frac{1}{3} + \\frac{2}{3} + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3 $$\nThus, the stability polynomial for SSPRK(3,3) is:\n$$ R(z) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3 $$\nThis is the third-order Taylor series expansion of $e^z$, consistent with a third-order method.\n\n**2. Eigenvalues of the Semi-Discretization Matrix**\n\nThe advection equation is $u_t + a u_x = 0$. We discretize in space on a uniform grid $x_j = j \\Delta x$ for $j=0, \\dots, N-1$. Since the wave speed $a0$, the first-order upwind difference for the spatial derivative $u_x$ at grid point $j$ is given by:\n$$ u_x \\approx \\frac{u(x_j) - u(x_{j-1})}{\\Delta x} $$\nLetting $y_j(t) \\approx u(x_j, t)$, the semi-discrete system of ODEs is:\n$$ \\frac{dy_j}{dt} + a \\frac{y_j - y_{j-1}}{\\Delta x} = 0 \\quad \\implies \\quad y_j'(t) = -\\frac{a}{\\Delta x} (y_j - y_{j-1}) $$\nThis system can be written in matrix form $y'(t) = A y(t)$. For a periodic domain, the index $j-1$ is interpreted modulo $N$, so for $j=0$, $y_{j-1} = y_{-1} \\equiv y_{N-1}$. This results in a circulant matrix $A \\in \\mathbb{C}^{N \\times N}$ where each row contains the coefficients of the stencil. The $j$-th row of $A$ has the value $-\\frac{a}{\\Delta x}$ at column $j$ and $+\\frac{a}{\\Delta x}$ at column $j-1$ (with wrap-around).\n\nThe eigenvalues of any circulant matrix are found by applying it to the discrete Fourier modes, which form its eigenvectors. An eigenvector $v_k$ has components $(v_k)_j = e^{i (2\\pi k j / N)}$ for $k, j \\in \\{0, \\dots, N-1\\}$. Applying the operator to the $j$-th component of $v_k$:\n$$ (A v_k)_j = -\\frac{a}{\\Delta x} \\left( (v_k)_j - (v_k)_{j-1} \\right) = -\\frac{a}{\\Delta x} \\left( e^{i \\frac{2\\pi k j}{N}} - e^{i \\frac{2\\pi k (j-1)}{N}} \\right) $$\n$$ (A v_k)_j = -\\frac{a}{\\Delta x} e^{i \\frac{2\\pi k j}{N}} \\left( 1 - e^{-i \\frac{2\\pi k}{N}} \\right) = \\lambda_k (v_k)_j $$\nThe eigenvalue $\\lambda_k$ corresponding to the eigenvector $v_k$ is therefore:\n$$ \\lambda_k = -\\frac{a}{\\Delta x} \\left( 1 - e^{-i \\phi_k} \\right) $$\nwhere $\\phi_k = \\frac{2\\pi k}{N}$ is the discrete wavenumber normalized by $\\Delta x$, ranging from $\\phi_0=0$ to nearly $2\\pi$. As $k$ varies, these eigenvalues trace a circle in the complex plane. The expression $\\lambda_k + \\frac{a}{\\Delta x} = \\frac{a}{\\Delta x} e^{-i\\phi_k}$ shows that this is a circle of radius $\\frac{a}{\\Delta x}$ centered at $-\\frac{a}{\\Delta x}$ on the real axis.\n\n**3. Stability Analysis**\n\nFor the numerical method to be stable, the one-step amplification factor must have a magnitude no greater than $1$ for all modes present in the system. This means that for all eigenvalues $\\lambda_k$ of $A$, the condition $|R(h\\lambda_k)| \\le 1$ must be met.\n\nLet $z_k = h\\lambda_k$. The set of all such scaled eigenvalues is the spectrum of the operator $hA$.\n$$ z_k = -h \\frac{a}{\\Delta x} \\left( 1 - e^{-i \\phi_k} \\right) $$\nWe define the Courant-Friedrichs-Lewy (CFL) number as $\\nu = \\frac{a h}{\\Delta x}$. With this, the scaled eigenvalues become:\n$$ z_k = -\\nu \\left( 1 - e^{-i \\phi_k} \\right) $$\nThis equation describes a circle in the complex plane centered at $-\\nu$ with radius $\\nu$. The stability condition requires this entire circle to lie within the stability region of the SSPRK(3,3) method, defined as the set $\\mathcal{S} = \\{ z \\in \\mathbb{C} : |R(z)| \\le 1 \\}$.\n\nTo find the maximal stable CFL number, $\\nu_{\\max}$, we must find the largest $\\nu  0$ for which this circle is contained in $\\mathcal{S}$. A rigorous analysis would involve finding the point of tangency between the expanding circle and the boundary of $\\mathcal{S}$. However, for this specific combination of upwind differencing and the RK3 method, it is a common and valid simplification to assume that the stability limit is dictated by the point on the eigenvalue circle that lies furthest on the negative real axis. This point corresponds to the highest frequency spatial mode, where $\\phi_k = \\pi$.\nFor $\\phi_k = \\pi$, $e^{-i\\pi} = -1$, so the scaled eigenvalue is:\n$$ z = -\\nu(1 - (-1)) = -2\\nu $$\nWe must find the boundary of the stability region on the negative real axis. This boundary is given by $|R(z)|=1$. Since $R(z)$ is real for real $z$, this means $R(z)=1$ or $R(z)=-1$. For $z0$, $R(z)=1$ only at $z=0$. The stability limit is therefore determined by the first negative root of $R(z)=-1$.\n$$ 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3 = -1 $$\n$$ \\frac{1}{6}z^3 + \\frac{1}{2}z^2 + z + 2 = 0 $$\nMultiplying by $6$ gives the polynomial equation for the stability boundary on the negative real axis:\n$$ z^3 + 3z^2 + 6z + 12 = 0 $$\nThe maximal stable time step is reached when the point $z = -2\\nu$ lies on this boundary. Substituting $z = -2\\nu_{\\max}$ into this equation:\n$$ (-2\\nu_{\\max})^3 + 3(-2\\nu_{\\max})^2 + 6(-2\\nu_{\\max}) + 12 = 0 $$\n$$ -8\\nu_{\\max}^3 + 12\\nu_{\\max}^2 - 12\\nu_{\\max} + 12 = 0 $$\nDividing by $-4$, we obtain the cubic equation for the maximal CFL number, $\\nu_{\\max}$:\n$$ 2\\nu_{\\max}^3 - 3\\nu_{\\max}^2 + 3\\nu_{\\max} - 3 = 0 $$\n\n**4. Calculation of the Maximal Time Step**\n\nThis cubic equation does not have a simple rational root and must be solved numerically. The physically meaningful root is the single real root, which can be found using a numerical solver. The value is:\n$$ \\nu_{\\max} \\approx 1.2638360341943411 $$\nFrom the definition of the CFL number, $\\nu_{\\max} = \\frac{a h_{\\max}}{\\Delta x}$, we can express the maximal stable time step $h_{\\max}$ as:\n$$ h_{\\max} = \\nu_{\\max} \\frac{\\Delta x}{a} $$\nUsing the calculated value of $\\nu_{\\max}$, the final formula is:\n$$ h_{\\max} \\approx 1.26383603 \\times \\frac{\\Delta x}{a} $$\nThis formula will be implemented to compute the required values for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Calculates the maximal stable time step h_max for the SSPRK(3,3) method\n    applied to the 1D advection equation with first-order upwind discretization.\n    \"\"\"\n    \n    # As derived in the solution, the maximal stable CFL number, nu_max, is the\n    # real root of the cubic equation 2*nu^3 - 3*nu^2 + 3*nu - 3 = 0.\n    # We solve this equation numerically.\n    def poly_for_nu(nu):\n        \"\"\"Cubic polynomial defining the maximal CFL number.\"\"\"\n        return 2 * nu**3 - 3 * nu**2 + 3 * nu - 3\n\n    # The root is known to be between 1.0 and 2.0. We use a bracketing method\n    # for robustness.\n    try:\n        sol = root_scalar(poly_for_nu, bracket=[1.0, 2.0], method='brentq')\n        nu_max = sol.root\n    except (ImportError, ValueError):\n        # Fallback to a hardcoded value if scipy fails, though this should not happen\n        # in the specified environment. The value is pre-calculated to high precision.\n        nu_max = 1.2638360341943411\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (a, delta_x) in units of m/s and m, respectively.\n    test_cases = [\n        (1.0, 1.0),\n        (2.0, 1.0),\n        (0.5, 0.1),\n        (1000.0, 1.0),\n        (1.0, 10**-3)\n    ]\n\n    results = []\n    for a, delta_x in test_cases:\n        # The formula for the maximal stable time step is h_max = nu_max * (delta_x / a).\n        if a = 0 or delta_x = 0:\n            raise ValueError(\"Wave speed 'a' and grid spacing 'delta_x' must be positive.\")\n        \n        h_max = nu_max * (delta_x / a)\n        \n        # Format the result to eight decimal places as required.\n        results.append(f\"{h_max:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3590090"}, {"introduction": "The theoretical order of accuracy for a one-step method relies on the assumption that the problem's solution is sufficiently smooth, but this often breaks down in real-world geophysical applications involving abrupt changes. This exercise challenges you to think critically about the consequences of integrating across such discontinuities, such as a well shutting in or an earthquake fault rupturing. By analyzing the phenomenon of order reduction and evaluating strategies to detect and handle these events, you will gain crucial insights into building robust adaptive solvers that maintain accuracy in non-ideal conditions. [@problem_id:3590073]", "problem": "In a time-dependent poroelastic compaction model used in computational geophysics, the volumetric strain rate is driven by a forcing that can change abruptly when an injection well is shut in. A simplified ordinary differential equation representation for a representative scalar state variable $u(t)$ is\n$$\n\\frac{du}{dt} = f(t,u) = -\\lambda u + s(t),\n$$\nwhere $\\lambda  0$ is a constant material parameter and $s(t)$ is a piecewise smooth source. Consider a single finite jump discontinuity in the source at an unknown time $t_d \\in (0,T)$,\n$$\ns(t) = \\begin{cases}\ns_-  \\text{for } t  t_d,\\\\\ns_+  \\text{for } t  t_d,\n\\end{cases}\n$$\nwith $s_- \\neq s_+$. You integrate this initial value problem with an explicit one-step method of order $p$ (for example, an explicit Runge–Kutta method of order $p$), with adaptive step size $h_n = t_{n+1} - t_n$, but without a priori knowledge of $t_d$.\n\nIt is observed in practice that when a time step $[t_n, t_{n+1}]$ straddles the jump at $t_d$, accuracy deteriorates. To preserve accuracy, a strategy is proposed to detect such discontinuities and align step endpoints with them.\n\nWhich of the following statements about order reduction and step-size control in this setting are correct?\n\nA. If a single step $[t_n, t_{n+1}]$ straddles the jump in $s(t)$ and the step endpoint is not aligned at $t_d$, then the local truncation error on that step is $\\mathcal{O}(h_n)$, independent of the method order $p$.\n\nB. For a single jump in $s(t)$ as described, even if one step straddles the jump, the global error over a finite time interval $[0,T]$ still scales as $\\mathcal{O}(h^p)$ for a method of order $p$, because only one step is affected.\n\nC. If the step-size controller ensures that a step endpoint coincides exactly with $t_d$ (no step crosses the discontinuity) and $s(t)$ is smooth on each side, then the nominal order $p$ is recovered on both subintervals and the global error scales as $\\mathcal{O}(h^p)$.\n\nD. A robust practical strategy for maintaining accuracy is to monitor a discontinuity indicator such as\n$$\nD_n \\equiv \\left\\| f\\!\\left(t_{n+1}, y_{n+1}^{\\mathrm{pred}}\\right) - f(t_n, y_n) \\right\\|,\n$$\nwhere $y_{n+1}^{\\mathrm{pred}}$ is the method’s predictor at $t_{n+1}$. If $D_n$ exceeds a threshold proportional to the user tolerance, the controller reduces $h_n$, brackets the jump by shrinking the step until $t_d \\in [t_n, t_{n+1}]$ is detected, and then applies a scalar root-finding procedure (for example, bisection or secant) on a suitable indicator to locate $t_d$ to accuracy $\\mathcal{O}(h^{p+1})$ before forcing a step endpoint at $t_d$. This preserves global $\\mathcal{O}(h^p)$ accuracy.\n\nE. If $f(t,u)$ is continuous at $t_d$ but its first partial derivative with respect to time, $\\partial f/\\partial t$, has a finite jump at $t_d$, then any explicit one-step method suffers local errors of order $\\mathcal{O}(h_n)$ on a step that straddles $t_d$, leading to global error $\\mathcal{O}(h)$ unless steps are aligned.\n\nF. If $f(t,u)$ is continuous at $t_d$ but has a finite jump in $\\partial f/\\partial t$ at $t_d$, then, in the absence of alignment, the attainable global order is at most $\\mathcal{O}(h^2)$: methods with $p \\leq 2$ retain their nominal order, while methods with $p  2$ reduce to second order.\n\nG. The embedded error estimator available in standard explicit one-step pairs is sufficient to both detect and exactly locate $t_d$ without any additional logic, because the estimator is zero if and only if the step endpoint coincides with the discontinuity.\n\nSelect all that apply.", "solution": "The user wants a critical analysis of several statements concerning the numerical integration of an ordinary differential equation (ODE) with a discontinuous forcing term, a common problem in computational science and engineering fields like geophysics.\n\n### Step 1: Extract Givens\n\n-   **ODE**: The scalar state variable $u(t)$ is governed by $\\frac{du}{dt} = f(t,u) = -\\lambda u + s(t)$.\n-   **Constant**: $\\lambda  0$.\n-   **Source Term**: $s(t)$ is a piecewise smooth function with a single finite jump discontinuity at an unknown time $t_d \\in (0,T)$.\n-   **Jump Definition**: $s(t) = \\begin{cases} s_-  \\text{for } t  t_d \\\\ s_+  \\text{for } t  t_d \\end{cases}$, with $s_- \\neq s_+$.\n-   **Numerical Method**: An explicit one-step method of order $p$, with adaptive step size $h_n = t_{n+1} - t_n$.\n-   **Scenario**: The time $t_d$ is unknown a priori, and the analysis focuses on the case where a time step $[t_n, t_{n+1}]$ straddles the discontinuity (i.e., $t_n  t_d  t_{n+1}$).\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding**: The problem is scientifically grounded. The ODE $\\frac{du}{dt} = -\\lambda u + s(t)$ is a standard linear first-order ODE, a fundamental model for relaxation phenomena subject to external forcing. The presence of a jump discontinuity in the forcing term $s(t)$ is a mathematically and physically meaningful scenario (e.g., switching a system on or off). The questions posed relate to the core theory of numerical analysis for ODEs, specifically concerning error analysis and adaptive stepping in the presence of non-smoothness. No scientific principles are violated.\n-   **Well-Posed**: The problem is well-posed. It presents a clear initial value problem scenario and asks for an evaluation of standard concepts in numerical analysis, such as local truncation error, global error, and discontinuity handling strategies. The questions are precise enough to have definite answers based on established theory.\n-   **Objective**: The problem is stated in objective, formal language common to numerical analysis and computational mathematics. Terms like \"order $p$\", \"local truncation error\", and \"global error\" have precise definitions. The context of \"poroelastic compaction\" serves as motivation but does not introduce subjectivity.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is self-contained, scientifically sound, and poses clear, objective questions within the established framework of numerical analysis. Proceeding to solution derivation and option analysis.\n\n### Principle-Based Derivation and Option-by-Option Analysis\n\nThe core of the problem lies in understanding how the smoothness of the right-hand side function $f(t,u)$ affects the smoothness of the solution $u(t)$ and, consequently, the accuracy of a numerical method. The order $p$ of a one-step method is achieved only if the solution $u(t)$ is sufficiently smooth (typically, $u \\in C^{p+1}$).\n\nFirst, let's analyze the smoothness of the solution $u(t)$ at the discontinuity $t_d$. The ODE is $u'(t) = -\\lambda u(t) + s(t)$.\nSince $u(t)$ must be a continuous function of time (as a physical state variable), the jump in $s(t)$ at $t_d$ directly causes a jump in the derivative $u'(t)$:\n$$\n\\lim_{t \\to t_d^+} u'(t) - \\lim_{t \\to t_d^-} u'(t) = (-\\lambda u(t_d) + s_+) - (-\\lambda u(t_d) + s_-) = s_+ - s_- \\neq 0.\n$$\nBecause $u'(t)$ has a jump discontinuity at $t_d$, the solution $u(t)$ is continuous ($u \\in C^0$) but not continuously differentiable ($u \\notin C^1$). The first derivative that is not continuous is $u'(t)$ itself. In the standard classification of discontinuity order, this corresponds to a solution smoothness of $q=1$ (i.e., $u^{(q-1)}=u^{(0)}=u$ is continuous, but $u^{(q)}=u^{(1)}$ is not). All higher derivatives, $u''(t), u'''(t)$, etc., do not exist at $t_d$ in the classical sense.\n\n**A. If a single step $[t_n, t_{n+1}]$ straddles the jump in $s(t)$ and the step endpoint is not aligned at $t_d$, then the local truncation error on that step is $\\mathcal{O}(h_n)$, independent of the method order $p$.**\n\nThe Local Truncation Error (LTE) for a one-step method is defined as $LTE_n = u(t_{n+1}) - y_{n+1}^{\\text{exact}}$, where $y_{n+1}^{\\text{exact}}$ is the result of one step starting from the exact solution $u(t_n)$. For a method of order $p$, the LTE is typically $\\mathcal{O}(h_n^{p+1})$, which relies on $u(t)$ being sufficiently smooth.\nWhen the step $[t_n, t_{n+1}]$ straddles $t_d$, the solution is not smooth. Let's analyze the error:\n$LTE_n = \\left(u(t_n) + \\int_{t_n}^{t_{n+1}} u'(\\tau) d\\tau \\right) - \\left(u(t_n) + h_n \\Phi(t_n, u(t_n), h_n)\\right) = \\int_{t_n}^{t_{n+1}} u'(\\tau) d\\tau - h_n \\Phi_n$.\nThe one-step method's increment function, $\\Phi_n$, approximates the integral of $u'(\\tau)$ using a fixed set of points within the interval. Since $u'(\\tau)$ has a jump discontinuity within the integration interval, any such fixed-point quadrature rule fails to capture the jump correctly. The error in approximating the integral of a function with a jump discontinuity by any standard quadrature rule is $\\mathcal{O}(h_n)$. For example, for the forward Euler method ($p=1$), the local error is $\\int_{t_n}^{t_{n+1}} (u'(\\tau) - u'(t_n))d\\tau$. This integral contains the jump and is of size $\\mathcal{O}(h_n)$. The same reasoning applies to higher-order methods; they cannot \"see\" the jump and commit an error proportional to the step size $h_n$ and the magnitude of the jump $s_+ - s_-$. Thus, the LTE degrades to $\\mathcal{O}(h_n)$ regardless of the nominal order $p$.\n**Verdict: Correct.**\n\n**B. For a single jump in $s(t)$ as described, even if one step straddles the jump, the global error over a finite time interval $[0,T]$ still scales as $\\mathcal{O}(h^p)$ for a method of order $p$, because only one step is affected.**\n\nThis statement is incorrect. A single local error of size $\\mathcal{O}(h_n)$ is introduced at the step straddling the discontinuity. For a stable ODE and method, this error is not isolated; it propagates and pollutes the solution for all subsequent time steps. The error at a later time $t_k$ is the sum of the propagated initial error and the accumulation of subsequent local errors. An initial error of $\\mathcal{O}(h)$ at time $t_{n+1}$ will, in general, result in an error of at least $\\mathcal{O}(h)$ at the final time $T$. The total global error is the sum of this propagated large error and the smaller $\\mathcal{O}(h^p)$ errors accumulated over the rest of the interval. The final result is dominated by the large error, leading to a global error of $\\mathcal{O}(h)$.\n**Verdict: Incorrect.**\n\n**C. If the step-size controller ensures that a step endpoint coincides exactly with $t_d$ (no step crosses the discontinuity) and $s(t)$ is smooth on each side, then the nominal order $p$ is recovered on both subintervals and the global error scales as $\\mathcal{O}(h^p)$.**\n\nThis is the standard, textbook strategy for handling known discontinuities. The integration interval $[0,T]$ is split into two subintervals, $[0, t_d]$ and $[t_d, T]$.\n1.  Integrate from $t=0$ to $t=t_d$. On this subinterval, the ODE is $u' = -\\lambda u + s_-$, which is smooth. A method of order $p$ will achieve a global error of $\\mathcal{O}(h^p)$ at $t_d$.\n2.  Start a new integration from $t=t_d$ to $t=T$, using the computed value at $t_d$ as the initial condition. On this second subinterval, the ODE is $u' = -\\lambda u + s_+$, which is also smooth. The local errors will again be of order $\\mathcal{O}(h^{p+1})$, leading to an accumulated error of $\\mathcal{O}(h^p)$ over this subinterval.\nThe total global error at time $T$ is a combination of the error at $t_d$ (propagated to $T$) and the error accumulated on $[t_d, T]$. Both contributions are $\\mathcal{O}(h^p)$, so the total global error is $\\mathcal{O}(h^p)$.\n**Verdict: Correct.**\n\n**D. A robust practical strategy for maintaining accuracy is... [describes an algorithm involving a discontinuity indicator, bracketing, root-finding to accuracy $\\mathcal{O}(h^{p+1})$, and forcing a step]. This preserves global $\\mathcal{O}(h^p)$ accuracy.**\n\nThis statement describes a complete and correct algorithm for adaptively handling unknown discontinuities.\n1.  **Detection**: The indicator $D_n \\equiv \\left\\| f(t_{n+1}, y_{n+1}^{\\mathrm{pred}}) - f(t_n, y_n) \\right\\|$ is a valid way to detect the jump. In a smooth region, $D_n = \\mathcal{O}(h_n)$. If the step straddles the jump, $f$ changes by an $\\mathcal{O}(1)$ amount due to $s(t)$, so $D_n$ becomes $\\mathcal{O}(1)$ and will trigger a threshold.\n2.  **Location**: Once detected, the jump can be localized by a bracketing procedure (e.g., bisection on the time step). A root-finding method can then be applied to a suitable function that isolates the discontinuity to find its location $t_d$.\n3.  **Accuracy Requirement**: The crucial part is locating $t_d$ with an approximation $t_d^*$ such that $|t_d - t_d^*| = \\mathcal{O}(h^{p+1})$. If we then force a step to end at $t_d^*$, the small part of the interval $[t_d, t_d^*]$ (or $[t_d^*, t_d]$) where the wrong source term is used has length $\\mathcal{O}(h^{p+1})$. The error incurred in this tiny segment is proportional to its length, making the local error $\\mathcal{O}(h^{p+1})$.\n4.  **Preservation of Order**: An induced local error of $\\mathcal{O}(h^{p+1})$ is consistent with the method's nominal local truncation error. Therefore, it does not degrade the global order, which remains $\\mathcal{O}(h^p)$. The described strategy is sound.\n**Verdict: Correct.**\n\n**E. If $f(t,u)$ is continuous at $t_d$ but its first partial derivative with respect to time, $\\partial f/\\partial t$, has a finite jump at $t_d$, then any explicit one-step method suffers local errors of order $\\mathcal{O}(h_n)$ on a step that straddles $t_d$, leading to global error $\\mathcal{O}(h)$ unless steps are aligned.**\n\nIn this case, $u'(t) = f(t, u(t))$ is continuous. The second derivative is $u''(t) = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial u} f(t,u)$. Since $\\frac{\\partial f}{\\partial t}$ has a jump and other terms are continuous, $u''(t)$ has a jump discontinuity. The solution $u(t)$ is continuously differentiable ($u \\in C^1$) but not twice continuously differentiable ($u \\notin C^2$). The smoothness index is $q=2$. According to the standard theory of order reduction, the global error for a method of order $p$ is $\\mathcal{O}(h^{\\min(p,q)})$. Here, the global error is $\\mathcal{O}(h^{\\min(p,2)})$. This is not, in general, $\\mathcal{O}(h)$. For any method with $p \\ge 2$, the global order is $\\mathcal{O}(h^2)$, which is better than $\\mathcal{O}(h)$. The local error analysis also shows a less severe degradation than claimed. The statement is therefore incorrect.\n**Verdict: Incorrect.**\n\n**F. If $f(t,u)$ is continuous at $t_d$ but has a finite jump in $\\partial f/\\partial t$ at $t_d$, then, in the absence of alignment, the attainable global order is at most $\\mathcal{O}(h^2)$: methods with $p \\leq 2$ retain their nominal order, while methods with $p  2$ reduce to second order.**\n\nThis statement accurately describes the consequences of the scenario from option E. As established, a jump in $\\partial f/\\partial t$ implies the solution smoothness is $q=2$ ($u''$ has a jump). The global order of a method of order $p$ is limited to $\\mathcal{O}(h^{\\min(p,q)})$. Substituting $q=2$, the global order is $\\mathcal{O}(h^{\\min(p,2)})$.\n-   If $p \\leq 2$, $\\min(p,2) = p$. The method retains its nominal global order $\\mathcal{O}(h^p)$.\n-   If $p  2$, $\\min(p,2) = 2$. The method's order is reduced to $2$, resulting in a global error of $\\mathcal{O}(h^2)$.\nThe statement accurately summarizes this analysis.\n**Verdict: Correct.**\n\n**G. The embedded error estimator available in standard explicit one-step pairs is sufficient to both detect and exactly locate $t_d$ without any additional logic, because the estimator is zero if and only if the step endpoint coincides with the discontinuity.**\n\nThis statement contains several falsehoods.\n1.  **Detection**: An embedded error estimator (e.g., the difference between a $p$-th and a $(p-1)$-th order solution) estimates the LTE. When straddling a jump in $f$, the LTE for both methods becomes large, so their difference (the estimator) also becomes large. This can be used to *detect* a problem on the step, but it is not the only way.\n2.  **Location**: The estimator provides a single value for the entire step $[t_n, t_{n+1}]$. It signals that the step was \"bad\" but provides no information about *where* within the step the discontinuity occurred. Additional logic, such as the bisection/root-finding described in option D, is required to locate $t_d$.\n3.  **Zero Estimator**: The claim that the estimator is zero if the step endpoint hits the discontinuity is false. If a step ends exactly at $t_d$, i.e., $[t_n, t_d]$, the problem is smooth on that interval. The estimator will return its normal, non-zero value, which is a small quantity of order $\\mathcal{O}(h^{p})$ or $\\mathcal{O}(h^{p+1})$. An estimator is generally not zero unless the method is exact for the given problem, which is not the case here.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{ACDF}$$", "id": "3590073"}]}