{"hands_on_practices": [{"introduction": "A fundamental skill in computational geophysics is diagnosing the source of numerical stiffness in models of fluid dynamics. This exercise uses the classic linearized shallow-water equations to demonstrate how spatial discretization via the method of lines transforms a partial differential equation system into a large system of ordinary differential equations [@problem_id:3617571]. By performing a discrete Fourier analysis, you will directly compute the eigenvalue spectrum of the system matrix, revealing the mathematical origin of physically distinct fast-moving gravity waves and slow-moving geostrophic modes, and understand how the fastest waves impose severe constraints on the time step of explicit methods.", "problem": "Consider the one-dimensional, linearized shallow-water equations on an $f$-plane for small free-surface displacement $\\,\\eta(x,t)\\,$ and horizontal velocity components $\\,u(x,t)\\,$ (zonal) and $\\,v(x,t)\\,$ (meridional), with constant mean depth $\\,H0\\,$, gravitational acceleration $\\,g0\\,$, and constant Coriolis parameter $\\,f\\,$. The continuous system is\n$$\n\\eta_{t} + H\\,u_{x} = 0,\\qquad\nu_{t} + g\\,\\eta_{x} - f\\,v = 0,\\qquad\nv_{t} + f\\,u = 0,\n$$\nwhere subscripts denote partial derivatives. Discretize space on a periodic domain of length $\\,L\\,$ with $\\,N\\,$ uniformly spaced grid points and spacing $\\,h=L/N\\,$, using second-order central differences for spatial derivatives. Let the semi-discrete method-of-lines (MOL) ordinary differential equation (ODE) be written in the compact form $\\,\\dot{\\mathbf{y}}=\\mathbf{J}\\,\\mathbf{y}\\,$ for the stacked state vector $\\,\\mathbf{y}=[\\eta_{1},\\dots,\\eta_{N},\\,u_{1},\\dots,u_{N},\\,v_{1},\\dots,v_{N}]^{\\mathsf{T}}\\,$.\n\nTasks:\n- Derive the MOL ODE $\\,\\dot{\\mathbf{y}}=\\mathbf{J}\\,\\mathbf{y}\\,$ explicitly in terms of the second-order central-difference operator applied to $\\,u\\,$ and $\\,\\eta\\,$.\n- Using discrete Fourier analysis under periodic boundary conditions, obtain the eigenvalues of the symbol $\\,\\mathbf{J}(\\theta)\\,$ for a discrete Fourier mode with nondimensional wavenumber $\\,\\theta=2\\pi m/N\\,$, where $\\,m\\in\\{0,1,\\dots,N-1\\}\\,$. Identify which eigenvalues are fast and which are slow, in the sense of their imaginary-part magnitudes across the discrete spectrum.\n- Infer the qualitative effect of these fast and slow eigenvalues on explicit time stepping stability constraints for oscillatory problems in computational geophysics, focusing on how the largest imaginary-part magnitude controls the most restrictive explicit time step.\n\nProvide as your final answer the closed-form analytic expression, in terms of $\\,g\\,$, $\\,H\\,$, $\\,h\\,$, and $\\,f\\,$, for the largest magnitude of the imaginary part of the eigenvalues of $\\,\\mathbf{J}\\,$ across all discrete Fourier modes. Express the final answer as a symbolic expression with no units.", "solution": "The problem is valid. It is a well-posed problem in the field of computational geophysics, specifically concerning the stability analysis of a numerical method applied to the linearized shallow-water equations. All premises are scientifically grounded and all necessary information for a solution is provided.\n\nThe continuous system of one-dimensional linearized shallow-water equations is given by:\n$$\n\\eta_{t} + H\\,u_{x} = 0\n$$\n$$\nu_{t} + g\\,\\eta_{x} - f\\,v = 0\n$$\n$$\nv_{t} + f\\,u = 0\n$$\n\nThe state vector at each grid point $j$ is $(\\eta_j, u_j, v_j)^{\\mathsf{T}}$. The domain is periodic with length $L$ and is discretized into $N$ points, with grid spacing $h=L/N$.\n\n**Task 1: Derive the Method-of-Lines (MOL) ODE**\nWe discretize the spatial derivatives using a second-order central difference operator:\n$$\n\\left(\\frac{\\partial w}{\\partial x}\\right)_{j} \\approx \\frac{w_{j+1} - w_{j-1}}{2h}\n$$\nApplying this to the system of PDEs, we obtain a system of ordinary differential equations (ODEs) for the variables at each grid point $j \\in \\{1, \\dots, N\\}$. The periodic boundary conditions mean that indices are interpreted modulo $N$; for example, $u_{N+1} = u_1$ and $u_{0} = u_N$.\n\nThe semi-discretized system is:\n$$\n\\frac{d\\eta_j}{dt} = -H \\left(\\frac{u_{j+1} - u_{j-1}}{2h}\\right)\n$$\n$$\n\\frac{du_j}{dt} = -g \\left(\\frac{\\eta_{j+1} - \\eta_{j-1}}{2h}\\right) + fv_j\n$$\n$$\n\\frac{dv_j}{dt} = -fu_j\n$$\nThis system of $3N$ coupled ODEs represents the MOL form $\\dot{\\mathbf{y}}=\\mathbf{J}\\,\\mathbf{y}$ for the state vector $\\mathbf{y}=[\\eta_{1},\\dots,\\eta_{N},\\,u_{1},\\dots,u_{N},\\,v_{1},\\dots,v_{N}]^{\\mathsf{T}}$. The matrix $\\mathbf{J}$ is a large, sparse block matrix composed of circulant blocks representing the central difference operator and identity matrices for the Coriolis terms.\n\n**Task 2: Eigenvalues of the Symbol $\\mathbf{J}(\\theta)$**\nTo find the eigenvalues of $\\mathbf{J}$, we perform a discrete Fourier analysis. We consider a single Fourier mode of the form:\n$$\n\\begin{pmatrix} \\eta_j(t) \\\\ u_j(t) \\\\ v_j(t) \\end{pmatrix} = \\begin{pmatrix} \\hat{\\eta}(k) \\\\ \\hat{u}(k) \\\\ \\hat{v}(k) \\end{pmatrix} e^{i(kx_j - \\omega t)}\n$$\nwhere $x_j=jh$ is the position of the $j$-th grid point, and $k$ is the wavenumber. Due to the periodicity on a grid with $N$ points, the discrete wavenumbers are $k = 2\\pi m / L = 2\\pi m / (Nh)$ for integer $m \\in \\{0, 1, \\dots, N-1\\}$. The time derivative is $\\frac{d}{dt} \\to -i\\omega$. The problem asks for the eigenvalues of the Jacobian $\\mathbf{J}$, which we denote by $\\lambda = -i\\omega$. Therefore, $\\frac{d}{dt} \\to \\lambda$.\n\nThe action of the central difference operator on a Fourier mode is:\n$$\n\\frac{w_{j+1} - w_{j-1}}{2h} = \\frac{\\hat{w}e^{ik(j+1)h} - \\hat{w}e^{ik(j-1)h}}{2h} = \\frac{\\hat{w}e^{ikjh}}{2h}(e^{ikh} - e^{-ikh}) = \\hat{w}e^{ikjh} \\left(\\frac{2i\\sin(kh)}{2h}\\right) = \\frac{i\\sin(kh)}{h} w_j\n$$\nSubstituting the Fourier modes into the semi-discretized equations, we obtain a system for the Fourier amplitudes $(\\hat{\\eta}, \\hat{u}, \\hat{v})^{\\mathsf{T}}$:\n$$\n\\lambda \\hat{\\eta} = -H \\left(\\frac{i\\sin(kh)}{h}\\right) \\hat{u}\n$$\n$$\n\\lambda \\hat{u} = -g \\left(\\frac{i\\sin(kh)}{h}\\right) \\hat{\\eta} + f\\hat{v}\n$$\n$$\n\\lambda \\hat{v} = -f\\hat{u}\n$$\nThis can be written as a matrix equation $\\lambda \\hat{\\mathbf{y}} = \\hat{\\mathbf{J}}(k) \\hat{\\mathbf{y}}$, where $\\hat{\\mathbf{y}}=(\\hat{\\eta}, \\hat{u}, \\hat{v})^{\\mathsf{T}}$ and $\\hat{\\mathbf{J}}(k)$ is the $3 \\times 3$ symbol of the Jacobian operator for wavenumber $k$:\n$$\n\\hat{\\mathbf{J}}(k) = \\begin{pmatrix}\n0  -H \\frac{i\\sin(kh)}{h}  0 \\\\\n-g \\frac{i\\sin(kh)}{h}  0  f \\\\\n0  -f  0\n\\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $\\hat{\\mathbf{J}}(k)$ are found from the characteristic equation $\\det(\\hat{\\mathbf{J}}(k) - \\lambda\\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix}\n-\\lambda  -H \\frac{i\\sin(kh)}{h}  0 \\\\\n-g \\frac{i\\sin(kh)}{h}  -\\lambda  f \\\\\n0  -f  -\\lambda\n\\end{pmatrix} = 0\n$$\nExpanding the determinant:\n$$\n-\\lambda \\left( (-\\lambda)(-\\lambda) - (f)(-f) \\right) - \\left(-H \\frac{i\\sin(kh)}{h}\\right) \\left( \\left(-g \\frac{i\\sin(kh)}{h}\\right)(-\\lambda) - 0 \\right) = 0\n$$\n$$\n-\\lambda(\\lambda^2 + f^2) + H \\frac{i\\sin(kh)}{h} \\left(\\lambda g \\frac{i\\sin(kh)}{h}\\right) = 0\n$$\n$$\n-\\lambda(\\lambda^2 + f^2) - \\lambda gH \\frac{\\sin^2(kh)}{h^2} = 0\n$$\n$$\n-\\lambda \\left( \\lambda^2 + f^2 + gH \\frac{\\sin^2(kh)}{h^2} \\right) = 0\n$$\nThis equation yields three eigenvalues for each wavenumber $k$:\n1.  $\\lambda_0 = 0$\n2.  $\\lambda^2 = - \\left( f^2 + gH \\frac{\\sin^2(kh)}{h^2} \\right) \\implies \\lambda_{\\pm} = \\pm i \\sqrt{f^2 + gH \\frac{\\sin^2(kh)}{h^2}}$\n\nUsing the problem's notation $\\theta = kh = 2\\pi m/N$, the eigenvalues of the symbol $\\mathbf{J}(\\theta)$ are:\n$$\n\\lambda_0 = 0, \\qquad \\lambda_{\\pm}(\\theta) = \\pm i \\sqrt{f^2 + gH \\frac{\\sin^2(\\theta)}{h^2}}\n$$\n\n**Task 3: Fast and Slow Eigenvalues  Stability Implications**\nThe eigenvalues represent the growth rates (real part) and frequencies of oscillation (imaginary part) of the discrete modes. Here, all eigenvalues are purely imaginary, corresponding to purely oscillatory behavior.\n\n-   The eigenvalue $\\lambda_0 = 0$ corresponds to a stationary mode. This represents the discrete version of the geostrophic balance, which is a steady state. This is the \"slowest\" possible mode.\n-   The eigenvalues $\\lambda_{\\pm}$ correspond to discrete inertia-gravity waves. Their frequency of oscillation is $\\omega_k = |\\operatorname{Im}(\\lambda_{\\pm})| = \\sqrt{f^2 + gH \\frac{\\sin^2(kh)}{h^2}}$.\n-   \"Slow\" waves are those with low frequency. For long wavelengths ($k \\to 0$), $\\sin(kh) \\approx kh$, and the frequency approaches $\\omega_k \\approx \\sqrt{f^2 + gHk^2}$. As $k \\to 0$, $\\omega_k \\to |f|$, the frequency of inertial oscillations. These are relatively slow.\n-   \"Fast\" waves are those with high frequency. The frequency $\\omega_k$ is maximized when the term $\\sin^2(kh)$ is maximized. These high-frequency modes correspond to the discrete gravity waves.\n\nFor an explicit time integration scheme (e.g., Forward Euler, Runge-Kutta), the stability is governed by a Courant-Friedrichs-Lewy (CFL)-type condition. The time step $\\Delta t$ must be small enough to resolve the fastest oscillations in the system. The stability region of an explicit scheme for oscillatory problems requires $|\\lambda| \\Delta t \\le C$, where $C$ is a constant specific to the scheme (the \"stability boundary\" on the imaginary axis). This means the maximum allowable time step is constrained by the eigenvalue with the largest magnitude:\n$$\n\\Delta t \\le \\frac{C}{\\max_k |\\lambda_k|}\n$$\nIn our case, the eigenvalues are purely imaginary, so $|\\lambda| = |\\operatorname{Im}(\\lambda)|$. The most restrictive constraint on $\\Delta t$ comes from the eigenvalue with the largest imaginary part, which corresponds to the fastest wave in the discretized system. We must find the maximum of $\\omega_k$ over all discrete wavenumbers.\n\nTo find this maximum, we need to maximize the expression for $\\omega_k$:\n$$\n\\max_k \\left( \\sqrt{f^2 + gH \\frac{\\sin^2(kh)}{h^2}} \\right)\n$$\nSince $f^2$, $g$, $H$, and $h^2$ are positive constants, maximizing this expression is equivalent to maximizing the $\\sin^2(kh)$ term over the allowed discrete wavenumbers $k = 2\\pi m/(Nh)$ for $m \\in \\{0, 1, \\dots, N-1\\}$. The maximum value of the function $\\sin^2(x)$ is $1$. This maximum is achieved when its argument $x$ is an odd multiple of $\\pi/2$. For a sufficiently large grid size $N$, there will be a discrete mode $m$ such that $kh = 2\\pi m/N$ is very close to $\\pi/2$, if not exactly equal to it (which occurs if $N$ is a multiple of $4$). In the context of determining the most restrictive stability limit, one considers the absolute maximum over the continuous spectrum of representable wavenumbers. Thus, we take the maximum value of $\\sin^2(kh)$ to be $1$.\n\nThe largest magnitude of the imaginary part of the eigenvalues is therefore:\n$$\n|\\operatorname{Im}(\\lambda)|_{\\text{max}} = \\sqrt{f^2 + gH \\frac{1}{h^2}} = \\sqrt{f^2 + \\frac{gH}{h^2}}\n$$\nThis is the final expression required. It shows that the stability limit is determined by a combination of the rotational frequency $f$ and the frequency of the fastest gravity wave resolvable on the grid, whose speed is characterized by $\\sqrt{gH}$ and wavelength by the grid spacing $h$.", "answer": "$$\\boxed{\\sqrt{f^{2} + \\frac{gH}{h^{2}}}}$$", "id": "3617571"}, {"introduction": "Once stiffness is identified, the next step is to employ a numerical method that can handle it efficiently. This practice focuses on Implicit-Explicit (IMEX) schemes, a powerful class of methods that partition a system into its stiff and nonstiff components, treating each with an appropriate integrator [@problem_id:3617586]. You will derive a first-order IMEX scheme from basic principles and perform a linear stability analysis to show precisely how this approach overcomes the stringent time-step limitations of fully explicit methods, making it a workhorse for many geophysical simulations.", "problem": "Consider a semi-discrete model arising in computational geophysics for a thermochemical field in the Earth's mantle, where advection is nonstiff but compositional relaxation is stiff. After spatial discretization by the method of lines, the temporal evolution of a scalar state variable is modeled by the ordinary differential equation $y'(t) = f(y(t)) + g(y(t))$, where $f$ represents the nonstiff advective and source contributions and $g$ represents a stiff linear relaxation arising from fast local equilibration processes. Assume $f$ and $g$ are sufficiently smooth to admit a consistent first-order time integrator.\n\nTask 1. Starting from the definition of the forward Euler method for nonstiff terms and the backward Euler method for stiff terms, derive a first-order Implicit-Explicit (IMEX) Euler scheme for $y'(t) = f(y(t)) + g(y(t))$ with time step $\\Delta t  0$. Your derivation must clearly state which term is treated explicitly and which is treated implicitly, and must provide a closed-form update for $y^{n+1}$ in terms of $y^{n}$, $\\Delta t$, $f$, and $g$.\n\nTask 2. Perform a linear stability analysis of the derived IMEX Euler scheme on the scalar test equation $y'(t) = \\lambda y(t) + \\mu y(t)$, where $\\lambda \\in \\mathbb{C}$ models the nonstiff contribution and $\\mu \\in \\mathbb{C}$ models the stiff contribution with $\\operatorname{Re}(\\mu) \\ll 0$. Let $z = \\Delta t\\,\\lambda$ and $w = \\Delta t\\,\\mu$. Derive the one-step amplification factor $R(z,w)$ such that $y^{n+1} = R(z,w)\\,y^{n}$, and write $R(z,w)$ as a single closed-form analytic expression in terms of $z$ and $w$. Based on $R(z,w)$, discuss the implications for stability with respect to the stiff component when $w$ satisfies $\\operatorname{Re}(w)  0$ and $|w|$ is large.\n\nAnswer format requirement: Provide the final answer as the single closed-form expression for $R(z,w)$. No numerical evaluation is required, and no units are involved. The final answer must be given exactly, not approximated.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   The governing ordinary differential equation (ODE) is $y'(t) = f(y(t)) + g(y(t))$.\n-   $f(y(t))$ represents nonstiff contributions.\n-   $g(y(t))$ represents a stiff linear relaxation.\n-   The time step is $\\Delta t  0$.\n-   The scalar test equation for linear stability analysis is $y'(t) = \\lambda y(t) + \\mu y(t)$.\n-   $\\lambda \\in \\mathbb{C}$ corresponds to the nonstiff part.\n-   $\\mu \\in \\mathbb{C}$ corresponds to the stiff part, with the property $\\operatorname{Re}(\\mu) \\ll 0$.\n-   Normalized parameters are defined as $z = \\Delta t\\,\\lambda$ and $w = \\Delta t\\,\\mu$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-posed and grounded in the established theory of numerical methods for ordinary differential equations. The setup involving a partitioned ODE with stiff and nonstiff components is a canonical model used to analyze Implicit-Explicit (IMEX) schemes. The use of a scalar test equation to study linear stability is a standard, fundamental technique in numerical analysis. The terms and concepts, such as \"stiff,\" \"nonstiff,\" \"IMEX,\" and \"amplification factor,\" are all well-defined within the field. The problem statement is self-contained, unambiguous, and does not violate any scientific principles or logical consistency. It is a formal mathematical problem that admits a unique, verifiable solution.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\n### Task 1: Derivation of the IMEX Euler Scheme\n\nThe problem describes a first-order Implicit-Explicit (IMEX) scheme, also known as a semi-implicit scheme. The core idea is to treat different parts of the ODE with different time-stepping methods tailored to their characteristics. Specifically, the nonstiff term $f(y)$ is treated explicitly, and the stiff term $g(y)$ is treated implicitly.\n\nWe start with the ODE:\n$$y'(t) = f(y(t)) + g(y(t))$$\nLet $y^n$ be the numerical approximation of the solution $y(t_n)$ at time $t_n = n \\Delta t$. We approximate the time derivative using a first-order forward difference:\n$$y'(t_n) \\approx \\frac{y^{n+1} - y^n}{\\Delta t}$$\nSubstituting this into the ODE, we evaluate the right-hand side using the IMEX approach. The nonstiff term $f$ is evaluated at the current, known time level $t_n$, which is an explicit treatment (specifically, forward Euler). The stiff term $g$ is evaluated at the future, unknown time level $t_{n+1}$, which is an implicit treatment (specifically, backward Euler). This leads to the following discrete equation:\n$$\\frac{y^{n+1} - y^n}{\\Delta t} = f(y^n) + g(y^{n+1})$$\nThe problem states that $g$ represents a \"stiff linear relaxation,\" which implies that $g$ is a linear function of its argument. We can therefore write $g(y) = G y$ for some linear operator $G$. In a multidimensional system, $G$ would be a matrix. Substituting this linear form for $g$ into our scheme gives:\n$$\\frac{y^{n+1} - y^n}{\\Delta t} = f(y^n) + G y^{n+1}$$\nTo find a closed-form update for $y^{n+1}$, we rearrange the equation to isolate $y^{n+1}$ on one side. First, multiply by $\\Delta t$:\n$$y^{n+1} - y^n = \\Delta t f(y^n) + \\Delta t G y^{n+1}$$\nNext, gather all terms involving $y^{n+1}$ on the left-hand side and all other terms on the right-hand side:\n$$y^{n+1} - \\Delta t G y^{n+1} = y^n + \\Delta t f(y^n)$$\nFactor out $y^{n+1}$ on the left-hand side. This involves the identity operator $I$:\n$$(I - \\Delta t G) y^{n+1} = y^n + \\Delta t f(y^n)$$\nFinally, to solve for $y^{n+1}$, we apply the inverse of the operator $(I - \\Delta t G)$ to both sides:\n$$y^{n+1} = (I - \\Delta t G)^{-1} \\left( y^n + \\Delta t f(y^n) \\right)$$\nThis is the closed-form update for the first-order IMEX Euler scheme applied to an ODE with a linear stiff part.\n\n### Task 2: Linear Stability Analysis\n\nWe now perform a linear stability analysis on the scalar test equation:\n$$y'(t) = \\lambda y(t) + \\mu y(t)$$\nHere, the nonstiff contribution is identified as $f(y) = \\lambda y$, and the stiff linear contribution is $g(y) = \\mu y$. For this scalar case, the operator $G$ is simply multiplication by the complex number $\\mu$, and the identity operator $I$ is multiplication by $1$.\n\nWe apply the derived IMEX Euler scheme to this test equation. Substituting $f(y^n) = \\lambda y^n$ and $g(y^{n+1}) = \\mu y^{n+1}$ into the basic form of the scheme:\n$$\\frac{y^{n+1} - y^n}{\\Delta t} = \\lambda y^n + \\mu y^{n+1}$$\nOur goal is to find the amplification factor $R(z,w)$ such that $y^{n+1} = R(z,w) y^n$. We rearrange the equation to solve for $y^{n+1}$ in terms of $y^n$:\n$$y^{n+1} - y^n = \\Delta t \\lambda y^n + \\Delta t \\mu y^{n+1}$$\n$$y^{n+1} - \\Delta t \\mu y^{n+1} = y^n + \\Delta t \\lambda y^n$$\nFactor out $y^{n+1}$ and $y^n$:\n$$y^{n+1} (1 - \\Delta t \\mu) = y^n (1 + \\Delta t \\lambda)$$\nIsolating $y^{n+1}$ gives:\n$$y^{n+1} = \\left( \\frac{1 + \\Delta t \\lambda}{1 - \\Delta t \\mu} \\right) y^n$$\nBy definition, the amplification factor is the term in the parenthesis. Using the given substitutions $z = \\Delta t \\lambda$ and $w = \\Delta t \\mu$, we obtain the expression for $R(z,w)$:\n$$R(z,w) = \\frac{1 + z}{1 - w}$$\nThe stability of the scheme requires $|R(z,w)| \\le 1$. The problem asks for the implications for stability with respect to the stiff component, where $\\operatorname{Re}(\\mu) \\ll 0$ and $|w|$ is large.\nSince $\\Delta t  0$, $\\operatorname{Re}(\\mu)  0$ implies $\\operatorname{Re}(w)  0$. The stability region for the stiff component alone (by setting $z=0$) is given by $|R(0,w)| = |\\frac{1}{1-w}| \\le 1$, which simplifies to $|1-w| \\ge 1$. This region is the exterior of the unit circle centered at $w=1$ in the complex plane. This region contains the entire left half-plane, $\\{w \\in \\mathbb{C} \\mid \\operatorname{Re}(w) \\le 0\\}$. Since our stiff component satisfies $\\operatorname{Re}(w)  0$, the method is unconditionally stable for the stiff part. This property is known as A-stability.\nAs $|w| \\to \\infty$ (while maintaining $\\operatorname{Re}(w)0$), the denominator $|1-w| \\to \\infty$. Consequently, for any fixed $z$, the amplification factor's magnitude approaches zero:\n$$\\lim_{|w|\\to\\infty, \\operatorname{Re}(w)0} |R(z,w)| = \\lim_{|w|\\to\\infty} \\frac{|1+z|}{|1-w|} = 0$$\nThis demonstrates that the method is not only stable but also strongly dissipative (L-stable) for infinitely stiff components. The time step $\\Delta t$ is not restricted by the stiffness parameter $\\mu$, but rather by the nonstiff parameter $\\lambda$, for which the stability region $|1+z| \\le |1-w|$ resembles that of the explicit forward Euler method. This is the primary motivation for using IMEX schemes.\nThe requested final answer is the closed-form expression for $R(z,w)$.", "answer": "$$\\boxed{\\frac{1+z}{1-w}}$$", "id": "3617586"}, {"introduction": "For complex multi-physics problems, such as reactive transport, operator splitting offers an elegant and modular way to construct a time integrator. This advanced exercise explores the Lie splitting scheme, where the full evolution is approximated by solving for transport and reaction in separate substeps [@problem_id:3617594]. Your task goes beyond analyzing the stability of each substep; you must also quantify the leading-order splitting error, which arises from the fact that the transport and reaction operators do not commute, and determine how this error constrains the time step.", "problem": "Consider a one-dimensional, periodic, two-species reactive transport model on the interval $\\left[0,L\\right]$ with $L=1$. A uniform grid with $N=100$ points is used, yielding grid spacing $\\Delta x=L/N$. Let $\\mathbf{u}(x,t)\\in\\mathbb{R}^{2}$ denote the species concentrations. After semi-discretization by the method of lines, the evolution of the grid-cell concentrations is governed by the linear ordinary differential equation\n$$\n\\frac{d\\mathbf{y}}{dt}=\\left(A+B\\right)\\mathbf{y},\n$$\nwhere $A$ represents the advection–diffusion transport and $B$ represents local reactions. The transport operator is\n$$\nA=A_{\\mathrm{adv}}\\otimes I_{2}+L\\otimes D,\n$$\nwhere $A_{\\mathrm{adv}}$ is the first-order upwind discrete advection operator for constant velocity $c=0.1$, $I_{2}$ is the $2\\times 2$ identity matrix acting on species, $L$ is the second-order centered finite-difference discrete Laplacian with periodic boundary conditions, and $D=\\mathrm{diag}\\!\\left(\\kappa_{1},\\kappa_{2}\\right)$ with $\\kappa_{1}=10^{-3}$ and $\\kappa_{2}=5\\times 10^{-4}$. The reaction operator is block-diagonal across grid cells,\n$$\nB=I_{N}\\otimes R,\n$$\nwith a stiff reaction matrix\n$$\nR=\\begin{pmatrix}\n-500  200\\\\\n50  -300\n\\end{pmatrix}.\n$$\nA Lie splitting is used per time step: first apply the reaction substep (solved by backward Euler), then apply the transport substep (solved by an explicit stabilized Runge–Kutta–Chebyshev (RKC) method with $s=20$ stages). As a well-tested fact for explicit stabilized RKC methods, the linear stability interval along the negative real axis scales approximately as $\\left[-2s^{2},0\\right]$. For the discrete Laplacian $L$ on a periodic grid with spacing $\\Delta x$, its eigenvalues are $\\mu(k)=-\\frac{4}{\\Delta x^{2}}\\sin^{2}\\!\\left(\\frac{\\pi k}{N}\\right)$ for $k=0,1,\\dots,N-1$, and the spectral radius is $\\rho(L)=\\frac{4}{\\Delta x^{2}}$.\n\nAssume the advection contribution to the stability constraint is negligible compared to diffusion for the chosen parameters and stages. The time step $h$ must be chosen to satisfy both of the following:\n\n- The explicit stabilized transport substep’s real-axis stability requirement, using the largest diffusive eigenvalue.\n- A bound on the leading-order local splitting error per step, derived from the Baker–Campbell–Hausdorff series and the commutator $[A,B]$, such that the ratio of the local splitting error norm to the initial norm does not exceed a prescribed tolerance $\\varepsilon=10^{-2}$.\n\nCompute the largest time step $h$ (in seconds) that satisfies both constraints. Round your answer to four significant figures and express it in seconds.", "solution": "The problem requires finding the largest time step $h$ for a Lie splitting scheme that satisfies two distinct constraints: one for the stability of the explicit transport substep and one for the accuracy of the operator splitting. We will determine the maximum time step allowed by each constraint, $h_{\\text{stability}}$ and $h_{\\text{error}}$, respectively. The overall maximum allowed time step will be the minimum of these two values, $h = \\min(h_{\\text{stability}}, h_{\\text{error}})$.\n\nFirst, we establish the given parameters. The domain has length $L=1$ discretized with $N=100$ points, so the grid spacing is $\\Delta x = L/N = 1/100 = 0.01$. The diffusion coefficients are $\\kappa_1 = 10^{-3}$ and $\\kappa_2 = 5 \\times 10^{-4}$. The explicit transport substep is solved with an RKC method of $s=20$ stages. The splitting error tolerance is $\\varepsilon = 10^{-2}$.\n\n**Constraint 1: Stability of the Transport Substep**\n\nThe transport substep involves solving the ODE $\\frac{d\\mathbf{z}}{dt} = A\\mathbf{z}$ using an explicit RKC method. The stability of this method depends on the eigenvalues of the operator $A$. The problem specifies that the contribution from advection can be neglected for the stability analysis, so we consider the diffusion part of the operator, $A \\approx L \\otimes D$.\n\nThe eigenvalues of the Kronecker product $L \\otimes D$ are the products of the eigenvalues of $L$ and $D$.\nThe eigenvalues of the diagonal matrix $D = \\mathrm{diag}(\\kappa_1, \\kappa_2)$ are its diagonal entries, $\\kappa_1=10^{-3}$ and $\\kappa_2=5 \\times 10^{-4}$.\nThe problem states the eigenvalues of the discrete Laplacian $L$ on a periodic grid are $\\mu(k) = -\\frac{4}{\\Delta x^2}\\sin^2(\\frac{\\pi k}{N})$ for $k=0, \\dots, N-1$. This is consistent with the stability region for the RKC method being specified along the negative real axis.\n\nThe eigenvalues of the diffusion operator $L \\otimes D$ are thus $\\lambda_{k,j} = \\mu_k \\kappa_j$, which are all real and non-positive. Stability of the explicit scheme is governed by the most negative eigenvalue, $\\lambda_{\\min}$, which has the largest magnitude. This occurs for the largest magnitude eigenvalue of $L$ and the largest eigenvalue of $D$.\n\nThe spectral radius of $L$ is $\\rho(L) = \\max_k |\\mu_k|$. For $k=N/2$ (since $N=100$ is even), $\\sin^2(\\pi(N/2)/N) = \\sin^2(\\pi/2) = 1$, so the eigenvalue with the largest magnitude is $\\lambda_{\\min}(L) = -4/\\Delta x^2$.\nNumerically, $\\lambda_{\\min}(L) = -\\frac{4}{(0.01)^2} = -\\frac{4}{10^{-4}} = -4 \\times 10^4$.\nThe largest diffusion coefficient is $\\kappa_{\\max} = \\max(\\kappa_1, \\kappa_2) = 10^{-3}$.\n\nThe most negative eigenvalue of the approximate transport operator is:\n$$\n\\lambda_{\\min}(L \\otimes D) = \\lambda_{\\min}(L) \\cdot \\kappa_{\\max} = (-4 \\times 10^4) \\cdot (10^{-3}) = -40\n$$\nThe stability interval for the $s=20$ stage RKC method is given as approximately $[-2s^2, 0]$. The stability condition requires that the product of the time step $h$ and any eigenvalue $\\lambda$ of the system matrix lies within this interval. For the most restrictive eigenvalue $\\lambda_{\\min}(L \\otimes D)$, we need:\n$$\nh \\cdot \\lambda_{\\min}(L \\otimes D) \\ge -2s^2\n$$\n$$\nh \\cdot (-40) \\ge -2 \\cdot (20)^2 = -2 \\cdot 400 = -800\n$$\nSolving for $h$, we find the stability-imposed limit:\n$$\nh \\le \\frac{-800}{-40} = 20\n$$\nSo, $h_{\\text{stability}} = 20$ seconds.\n\n**Constraint 2: Splitting Error**\n\nThe Lie splitting scheme is a first-order operator splitting method. The local error for a single time step $h$ is given by the Baker-Campbell-Hausdorff (BCH) formula. The exact evolution operator is $\\exp(h(A+B))$, while the Lie splitting operator is $\\exp(hB)\\exp(hA)$. The leading-order error term is:\n$$\n\\mathcal{E}(h) = \\exp(hB)\\exp(hA) - \\exp(h(A+B)) \\approx \\frac{h^2}{2}[A,B]\n$$\nwhere $[A,B] = AB-BA$ is the commutator of the operators. The constraint is that the norm of the local error vector, relative to the solution norm, must not exceed $\\varepsilon$:\n$$\n\\frac{\\|\\frac{h^2}{2}[A,B]\\mathbf{y}\\|}{\\|\\mathbf{y}\\|} \\le \\varepsilon\n$$\nThis is bounded by $\\frac{h^2}{2}\\|[A,B]\\|_2 \\le \\varepsilon$. We will use the spectral norm (2-norm). The constraint on $h$ is then:\n$$\nh \\le \\sqrt{\\frac{2\\varepsilon}{\\|[A,B]\\|_2}}\n$$\nWe need to compute the commutator $[A,B]$. Given $A = A_{\\mathrm{adv}} \\otimes I_2 + L \\otimes D$ and $B = I_N \\otimes R$, we use properties of the Kronecker product:\n$$\nAB = (A_{\\mathrm{adv}} \\otimes I_2 + L \\otimes D)(I_N \\otimes R) = A_{\\mathrm{adv}} \\otimes R + L \\otimes (DR)\n$$\n$$\nBA = (I_N \\otimes R)(A_{\\mathrm{adv}} \\otimes I_2 + L \\otimes D) = A_{\\mathrm{adv}} \\otimes R + L \\otimes (RD)\n$$\nThe commutator is:\n$$\n[A,B] = AB - BA = (A_{\\mathrm{adv}} \\otimes R + L \\otimes DR) - (A_{\\mathrm{adv}} \\otimes R + L \\otimes RD) = L \\otimes (DR - RD) = L \\otimes [D,R]\n$$\nNow we compute the matrix commutator $[D,R]$:\n$D = \\begin{pmatrix} 10^{-3}  0 \\\\ 0  5 \\times 10^{-4} \\end{pmatrix}$, $R = \\begin{pmatrix} -500  200 \\\\ 50  -300 \\end{pmatrix}$.\n$$\nDR = \\begin{pmatrix} 10^{-3}  0 \\\\ 0  5 \\times 10^{-4} \\end{pmatrix} \\begin{pmatrix} -500  200 \\\\ 50  -300 \\end{pmatrix} = \\begin{pmatrix} -0.5  0.2 \\\\ 0.025  -0.15 \\end{pmatrix}\n$$\n$$\nRD = \\begin{pmatrix} -500  200 \\\\ 50  -300 \\end{pmatrix} \\begin{pmatrix} 10^{-3}  0 \\\\ 0  5 \\times 10^{-4} \\end{pmatrix} = \\begin{pmatrix} -0.5  0.1 \\\\ 0.05  -0.15 \\end{pmatrix}\n$$\n$$\n[D,R] = DR - RD = \\begin{pmatrix} 0  0.1 \\\\ -0.025  0 \\end{pmatrix}\n$$\nNext, we find the norm $\\|[A,B]\\|_2 = \\|L \\otimes [D,R]\\|_2$. Using the property $\\|P \\otimes Q\\|_2 = \\|P\\|_2 \\|Q\\|_2$:\n$\\|L\\|_2 = \\rho(L) = \\frac{4}{\\Delta x^2} = \\frac{4}{(0.01)^2} = 4 \\times 10^4$.\nTo find $\\|[D,R]\\|_2$, we compute its largest singular value, which is the square root of the largest eigenvalue of $[D,R]^T[D,R]$. Let $C = [D,R]$.\n$$\nC^T C = \\begin{pmatrix} 0  -0.025 \\\\ 0.1  0 \\end{pmatrix} \\begin{pmatrix} 0  0.1 \\\\ -0.025  0 \\end{pmatrix} = \\begin{pmatrix} (-0.025)^2  0 \\\\ 0  (0.1)^2 \\end{pmatrix} = \\begin{pmatrix} 6.25 \\times 10^{-4}  0 \\\\ 0  10^{-2} \\end{pmatrix}\n$$\nThe eigenvalues are $6.25 \\times 10^{-4}$ and $10^{-2}$. The largest is $10^{-2}$.\n$\\|[D,R]\\|_2 = \\sqrt{10^{-2}} = 0.1$.\nSo, the norm of the full commutator is:\n$$\n\\|[A,B]\\|_2 = \\|L\\|_2 \\cdot \\|[D,R]\\|_2 = (4 \\times 10^4) \\cdot 0.1 = 4 \\times 10^3\n$$\nNow we can compute the time step limit from the error constraint:\n$$\nh^2 \\le \\frac{2\\varepsilon}{\\|[A,B]\\|_2} = \\frac{2 \\cdot 10^{-2}}{4 \\times 10^3} = 0.5 \\times 10^{-5} = 5 \\times 10^{-6}\n$$\n$$\nh \\le \\sqrt{5 \\times 10^{-6}} = \\sqrt{5} \\times 10^{-3} \\approx 2.2360679... \\times 10^{-3}\n$$\nSo, $h_{\\text{error}} \\approx 2.236 \\times 10^{-3}$ seconds.\n\n**Conclusion**\n\nWe must satisfy both constraints, so the maximum permissible time step $h$ is the minimum of the two derived bounds:\n$$\nh_{\\max} = \\min(h_{\\text{stability}}, h_{\\text{error}}) = \\min(20, 2.236 \\times 10^{-3}) = 2.236 \\times 10^{-3}\n$$\nThe splitting error is the limiting factor. The problem asks for the answer rounded to four significant figures.\n$h_{\\max} \\approx 2.236 \\times 10^{-3}$ seconds.\n\nA note on the splitting error term: The leading order error term for Lie splitting $e^{hB}e^{hA}$ is $\\frac{h^2}{2}[B,A]$, not $\\frac{h^2}{2}[A,B]$. Since $[B,A] = -[A,B]$, the norm is the same. The provided solution used `[A,B]` and had a leading term of $-\\frac{h^2}{2}[A,B]$, which is the error for the alternate Lie splitting $e^{hA}e^{hB}$. The problem does not specify the order, but the solution correctly calculates the commutator norm and the resulting time step. The result is numerically identical. We retain the solution's logic for consistency.", "answer": "$$\\boxed{2.236 \\times 10^{-3}}$$", "id": "3617594"}]}