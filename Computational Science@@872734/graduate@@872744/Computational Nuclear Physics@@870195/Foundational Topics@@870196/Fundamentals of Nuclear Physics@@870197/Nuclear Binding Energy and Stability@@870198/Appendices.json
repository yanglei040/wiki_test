{"hands_on_practices": [{"introduction": "The semi-empirical mass formula (SEMF) is a cornerstone of nuclear physics, providing a powerful, physically motivated description of nuclear binding energies across the entire chart of nuclides. While its functional form is derived from the liquid-drop model, its true predictive power comes from coefficients fitted to experimental data. This exercise [@problem_id:3573765] guides you through the fundamental process of determining these coefficients from raw atomic mass data, a core task in computational physics that blends theoretical modeling with statistical data analysis.", "problem": "You are asked to design and implement a complete numerical pipeline to estimate nuclear binding energy model coefficients from atomic mass data at advanced graduate level, using principle-based reasoning and a reproducible linear regression. The coefficients to be determined are the volume coefficient $a_v$, the surface coefficient $a_s$, the Coulomb coefficient $a_c$, the asymmetry coefficient $a_a$, and the pairing amplitude $a_p$ under a chosen pairing prescription. The derivation must start from foundational principles and scaling laws appropriate to the liquid-drop description and must explicitly construct a linear model whose parameters are fitted by ordinary least squares.\n\nThe fundamental base you must use consists of:\n- The mass-energy equivalence $E = mc^2$.\n- The definition of nuclear binding energy $B$ for a nucleus with proton number $Z$ and neutron number $N$: $B = Z m_p c^2 + N m_n c^2 - M_{\\text{nuc}} c^2$, where $m_p$ and $m_n$ are the free proton and neutron masses and $M_{\\text{nuc}}$ is the nuclear mass.\n- Conversion from atomic mass $M_{\\text{atom}}$ (neutral atom with $Z$ bound electrons) to nuclear mass $M_{\\text{nuc}}$ via removal of $Z$ electron rest masses with addition of total electron binding energy $E_e(Z)$: $M_{\\text{nuc}} = M_{\\text{atom}} - Z m_e + E_e(Z)/c^2$, where $m_e$ is the electron mass. Use a consistent smooth electron binding correction model $E_e(Z)$ for neutral atoms with magnitude that scales plausibly with $Z$; adopt $E_e(Z) = \\alpha Z^2$ with $\\alpha$ specified below.\n\nYou must construct a linear regression model of $B$ in terms of features derived from physically motivated scaling laws. The features should emerge from the following considerations, without shortcut formulas provided in the problem statement:\n- A volume-like contribution that scales with $A = Z + N$.\n- A surface-like contribution that scales with the surface area of a nearly incompressible liquid drop, hence proportional to a power of $A$.\n- A Coulomb self-energy contribution of a finite-size charged distribution, dependent on $Z$ and the nuclear radius scaling.\n- An asymmetry contribution related to the neutron-proton imbalance and Fermi statistics.\n- A pairing contribution that depends on the parity of $Z$ and $N$, with a chosen magnitude scaling function in $A$ and a sign prescription for even-even, odd-odd, and odd-$A$ nuclei.\n\nYou must implement the following pairing prescription: define the signed pairing feature $g(A,Z,N) = s(A,Z,N) A^{-1/2}$, where $s(A,Z,N) = +1$ for even-even nuclei (both $Z$ and $N$ even), $s(A,Z,N) = -1$ for odd-odd nuclei (both $Z$ and $N$ odd), and $s(A,Z,N) = 0$ for odd-$A$ nuclei ($A$ odd). The unknown coefficient $a_p$ multiplies $g(A,Z,N)$.\n\nUnits and constants:\n- Express all energies in megaelectronvolts (MeV).\n- Use the atomic mass unit to energy conversion $u c^2$ equal to $931.49410242$ MeV per atomic mass unit $u$.\n- Use $m_p = 1.007276466621$ $u$, $m_n = 1.00866491588$ $u$, and $m_e = 0.000548579909065$ $u$.\n- Use the electron binding correction model $E_e(Z) = \\alpha Z^2$, with $\\alpha = 14.4381$ electronvolts. Convert $E_e(Z)$ to MeV using $1$ electronvolt $= 10^{-6}$ MeV. Therefore, $E_e(Z) = (1.44381 \\times 10^{-5}) Z^2$ MeV.\n\nData:\nUse the following dataset of neutral atomic masses $M_{\\text{atom}}$ in atomic mass units $u$ for isotopes with $(Z,N,A)$, where $A = Z + N$, and the indicated atomic masses. Every number below is a decimal quantity in $u$.\n- Deuterium: $(Z,N,A) = (1,1,2)$, $M_{\\text{atom}} = 2.01410177812$.\n- Helium-$3$: $(Z,N,A) = (2,1,3)$, $M_{\\text{atom}} = 3.01602932265$.\n- Helium-$4$: $(Z,N,A) = (2,2,4)$, $M_{\\text{atom}} = 4.00260325413$.\n- Carbon-$12$: $(Z,N,A) = (6,6,12)$, $M_{\\text{atom}} = 12.0$.\n- Nitrogen-$14$: $(Z,N,A) = (7,7,14)$, $M_{\\text{atom}} = 14.00307400443$.\n- Oxygen-$16$: $(Z,N,A) = (8,8,16)$, $M_{\\text{atom}} = 15.99491461957$.\n- Calcium-$40$: $(Z,N,A) = (20,20,40)$, $M_{\\text{atom}} = 39.96259098$.\n- Calcium-$48$: $(Z,N,A) = (20,28,48)$, $M_{\\text{atom}} = 47.95252276$.\n- Iron-$56$: $(Z,N,A) = (26,30,56)$, $M_{\\text{atom}} = 55.93493633$.\n- Nickel-$58$: $(Z,N,A) = (28,30,58)$, $M_{\\text{atom}} = 57.9353429$.\n- Zirconium-$90$: $(Z,N,A) = (40,50,90)$, $M_{\\text{atom}} = 89.9047037$.\n- Lead-$208$: $(Z,N,A) = (82,126,208)$, $M_{\\text{atom}} = 207.9766521$.\n\nTasks:\n1. From the fundamental base described, derive a linear model for $B$ in terms of a feature vector that yields a design matrix suitable for ordinary least squares, with unknown parameters $(a_v,a_s,a_c,a_a,a_p)$ each expressed in MeV.\n2. Convert each $M_{\\text{atom}}$ to $M_{\\text{nuc}}$ using the electron binding correction $E_e(Z)$ and compute the experimental binding energies $B$ in MeV for all isotopes.\n3. Implement ordinary least squares to fit $(a_v,a_s,a_c,a_a,a_p)$.\n\nTest suite:\nRun the fitting under three configurations to test the pipeline:\n- Case $1$: Use the full dataset listed above and include the electron binding correction $E_e(Z)$.\n- Case $2$: Use only the even-even subset of the dataset (those with both $Z$ and $N$ even) and include the electron binding correction $E_e(Z)$.\n- Case $3$: Use the full dataset but omit the electron binding correction (equivalently set $E_e(Z) = 0$), while still subtracting $Z m_e$ to convert $M_{\\text{atom}}$ to $M_{\\text{nuc}}$.\n\nFor each case, return the fitted coefficients $(a_v,a_s,a_c,a_a,a_p)$ as floating-point values in MeV along with the root-mean-square error (RMSE) of the residuals in MeV, computed as $\\sqrt{\\frac{1}{n}\\sum_i (B_i - \\hat{B}_i)^2}$ where $n$ is the number of isotopes in the case, $B_i$ are experimental binding energies, and $\\hat{B}_i$ are the model predictions. The RMSE must be expressed in MeV.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated nested list enclosed in square brackets, with one inner list per case in the order Case $1$, Case $2$, Case $3$. Each inner list must contain the six floating-point results in MeV with six digits after the decimal point, in the order $[a_v,a_s,a_c,a_a,a_p,\\text{RMSE}]$. For example, the printed structure must be of the form\n$[[a_v^{(1)},a_s^{(1)},a_c^{(1)},a_a^{(1)},a_p^{(1)},\\text{RMSE}^{(1)}],[a_v^{(2)},a_s^{(2)},a_c^{(2)},a_a^{(2)},a_p^{(2)},\\text{RMSE}^{(2)}],[a_v^{(3)},a_s^{(3)},a_c^{(3)},a_a^{(3)},a_p^{(3)},\\text{RMSE}^{(3)}]]$.", "solution": "The problem requires the design and implementation of a numerical pipeline to determine the coefficients of the semi-empirical mass formula (SEMF) from a given dataset of atomic masses. The process involves three main stages: the theoretical derivation of a linear model for nuclear binding energy based on the liquid-drop model, the processing of raw atomic mass data to calculate experimental binding energies, and the application of ordinary least squares (OLS) regression to fit the model coefficients.\n\nFirst, we establish the theoretical foundation for the linear model. The binding energy $B$ of a nucleus with mass number $A$, proton number $Z$, and neutron number $N = A - Z$ is defined as the energy required to disassemble it into its constituent free nucleons. Based on the principle of mass-energy equivalence, $E=mc^2$, this is given by:\n$$B = Z m_p c^2 + N m_n c^2 - M_{\\text{nuc}} c^2$$\nwhere $m_p$ is the proton rest mass, $m_n$ is the neutron rest mass, and $M_{\\text{nuc}}$ is the mass of the nucleus. The provided data are for neutral atoms, $M_{\\text{atom}}$, which include $Z$ electrons. The nuclear mass $M_{\\text{nuc}}$ is obtained by subtracting the mass of these $Z$ electrons and adding back their total binding energy, $E_e(Z)$:\n$$M_{\\text{nuc}} = M_{\\text{atom}} - Z m_e + \\frac{E_e(Z)}{c^2}$$\nHere, $m_e$ is the electron rest mass. The problem specifies a model for the total electron binding energy, $E_e(Z) = \\alpha Z^2$, with $\\alpha = 1.44381 \\times 10^{-5}$ MeV. Combining these, the experimental binding energy in units of MeV is calculated as:\n$$B_{exp} = \\left( Z m_p + N m_n - \\left( M_{\\text{atom}} - Z m_e + \\frac{E_e(Z)}{u c^2} \\right) \\right) u c^2$$\nwhere all masses are expressed in atomic mass units ($u$) and $u c^2 = 931.49410242$ MeV is the energy equivalent of one atomic mass unit.\n\nThe semi-empirical mass formula, derived from the liquid-drop model of the nucleus, expresses the binding energy $B$ as a sum of five terms with coefficients $(a_v, a_s, a_c, a_a, a_p)$ that we aim to determine:\n$$B(A, Z) = a_v f_v - a_s f_s - a_c f_c - a_a f_a + a_p f_p$$\nThe functional forms of the features ($f_v, f_s, f_c, f_a, f_p$) are derived from physical arguments:\n1.  Volume Term ($f_v$): The strong nuclear force is short-ranged and saturates. Thus, each nucleon primarily interacts with its nearest neighbors. The total binding energy is therefore approximately proportional to the total number of nucleons, $A$. This term represents the bulk binding of the nuclear \"liquid\".\n    $$f_v(A, Z) = A$$\n2.  Surface Term ($f_s$): Nucleons on the surface of the nucleus have fewer neighbors than those in the interior, which reduces the total binding energy. This effect is proportional to the surface area of the nucleus. Assuming a spherical nucleus of constant density, the volume $V \\propto A$. Since $V \\propto R^3$, the radius $R \\propto A^{1/3}$. The surface area is proportional to $R^2$.\n    $$f_s(A, Z) = A^{2/3}$$\n3.  Coulomb Term ($f_c$): The electrostatic repulsion between protons also reduces the binding energy. The potential energy of a distribution of $Z$ protons in a sphere of radius $R$ is proportional to the number of proton pairs, $Z(Z-1)/2$, and inversely proportional to the radius $R$. Using $Z(Z-1)$ is more accurate for small $Z$ than the approximation $Z^2$.\n    $$f_c(A, Z) = \\frac{Z(Z-1)}{A^{1/3}}$$\n4.  Asymmetry Term ($f_a$): The Pauli exclusion principle favors a symmetric nucleus with $N=Z$. For a fixed mass number $A$, deviating from this symmetry (i.e., having a neutron excess $N-Z \\neq 0$) requires placing nucleons in higher energy levels, which costs energy and reduces binding. This energy penalty is proportional to the square of the neutron-proton imbalance and inversely proportional to the total volume.\n    $$f_a(A, Z) = \\frac{(N-Z)^2}{A} = \\frac{(A-2Z)^2}{A}$$\n5.  Pairing Term ($f_p$): Nucleons exhibit a tendency to form pairs of identical particles with opposite spins, which increases binding energy. This leads to a correction term that depends on the even-odd character of $Z$ and $N$. The problem specifies the functional form for this feature:\n    $$f_p(A, Z, N) = s(A,Z,N) A^{-1/2}$$\n    where $s(A,Z,N) = +1$ for even-even nuclei, $s(A,Z,N) = -1$ for odd-odd nuclei, and $s(A,Z,N) = 0$ for odd-A nuclei.\n\nThis model is linear in the coefficients $(a_v, a_s, a_c, a_a, a_p)$. For a set of $n$ nuclei, we can write the system of equations in matrix form as $\\boldsymbol{Y} = \\mathbf{X}\\boldsymbol{\\beta}$, where:\n-   $\\boldsymbol{Y}$ is an $n \\times 1$ column vector of the experimental binding energies, $B_{exp,i}$.\n-   $\\boldsymbol{\\beta}$ is a $5 \\times 1$ column vector of the unknown coefficients to be fitted: $[a_v, a_s, a_c, a_a, a_p]^T$.\n-   $\\mathbf{X}$ is the $n \\times 5$ design matrix, where the $i$-th row corresponds to the $i$-th nucleus and is constructed from the model terms with their conventional signs absorbed:\n    $$\\mathbf{X}_i = \\left[ A_i, \\quad -A_i^{2/3}, \\quad -\\frac{Z_i(Z_i-1)}{A_i^{1/3}}, \\quad -\\frac{(A_i-2Z_i)^2}{A_i}, \\quad s(A_i,Z_i,N_i)A_i^{-1/2} \\right]$$\nThe ordinary least squares (OLS) estimate for the coefficients, $\\hat{\\boldsymbol{\\beta}}$, is the one that minimizes the sum of squared residuals, and is given by the solution to the normal equations:\n$$\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\boldsymbol{Y}$$\nThis solution will be computed numerically using a stable linear least-squares solver.\n\nThe pipeline proceeds as follows for each of the three test cases:\n1.  Select the appropriate subset of the isotopic data.\n2.  For each isotope, calculate the experimental binding energy $B_{exp}$ to form the vector $\\boldsymbol{Y}$. This involves applying the electron mass and, where specified, the electron binding energy corrections.\n3.  For each isotope, calculate the five feature values to form the design matrix $\\mathbf{X}$.\n4.  Solve the linear system $\\boldsymbol{Y} = \\mathbf{X}\\boldsymbol{\\beta}$ for $\\boldsymbol{\\beta}$ using OLS.\n5.  With the fitted coefficients $\\hat{\\boldsymbol{\\beta}}$, calculate the predicted binding energies $\\hat{\\boldsymbol{Y}} = \\mathbf{X}\\hat{\\boldsymbol{\\beta}}$.\n6.  Compute the root-mean-square error (RMSE) of the fit, defined as $\\text{RMSE} = \\sqrt{\\frac{1}{n}\\sum_{i=1}^{n} (Y_i - \\hat{Y}_i)^2}$.\nThe resulting coefficients $(a_v,a_s,a_c,a_a,a_p)$ and the RMSE, all in units of MeV, constitute the final output for each case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants are defined at the module level for clarity and reuse.\nUC2_MEV = 931.49410242\nM_P_U = 1.007276466621\nM_N_U = 1.00866491588\nM_E_U = 0.000548579909065\nALPHA_MEV = 1.44381e-5\n\ndef get_pairing_s(Z, N):\n    \"\"\"\n    Determines the sign coefficient for the pairing term based on proton and neutron numbers.\n    s = +1 for even-even, -1 for odd-odd, 0 for odd-A nuclei.\n    \"\"\"\n    if Z % 2 == 0 and N % 2 == 0:\n        return 1.0\n    elif Z % 2 != 0 and N % 2 != 0:\n        return -1.0\n    else:  # Odd-A nuclei\n        return 0.0\n\ndef run_semf_fit(dataset, use_electron_binding):\n    \"\"\"\n    Constructs the design matrix and target vector, then performs OLS regression.\n\n    Args:\n        dataset (list): A list of tuples, where each tuple contains\n                        (Z, N, A, M_atom_u) for a nucleus.\n        use_electron_binding (bool): Flag to include electron binding\n                                     energy correction.\n\n    Returns:\n        list: A list containing the fitted coefficients [a_v, a_s, a_c, a_a, a_p]\n              and the RMSE of the fit, all in MeV.\n    \"\"\"\n    num_isotopes = len(dataset)\n    # Design matrix X (n_samples, n_features) and target vector Y (n_samples,)\n    X = np.zeros((num_isotopes, 5))\n    Y = np.zeros(num_isotopes)\n\n    for i, datum in enumerate(dataset):\n        Z_f, N_f, A_f, M_atom_u = datum\n        Z, N, A = int(Z_f), int(N_f), int(A_f)\n\n        # 1. Calculate experimental binding energy (target vector Y)\n        E_e_mev = ALPHA_MEV * Z**2 if use_electron_binding else 0.0\n        M_nuc_u = M_atom_u - Z * M_E_U + E_e_mev / UC2_MEV\n        B_mev = (Z * M_P_U + N * M_N_U - M_nuc_u) * UC2_MEV\n        Y[i] = B_mev\n        \n        # 2. Construct features for the design matrix X\n        # The model is B = a_v*f_v + a_s*(-f_s) + a_c*(-f_c) + a_a*(-f_a) + a_p*f_p\n        # where f_v=A, f_s=A^(2/3), etc.\n        # We absorb the signs into the design matrix.\n        f_v = float(A)\n        f_s = -A**(2/3)\n        # Use Z*(Z-1) for Coulomb term, more accurate for small Z\n        f_c = -Z * (Z - 1) / A**(1/3) if A > 0 else 0.0\n        # Asymmetry term (N-Z)^2/A = (A-2Z)^2/A\n        f_a = -(A - 2*Z)**2 / A if A > 0 else 0.0\n        \n        s = get_pairing_s(Z, N)\n        f_p = s * A**(-1/2) if A > 0 else 0.0\n        \n        X[i, :] = [f_v, f_s, f_c, f_a, f_p]\n\n    # 3. Perform Ordinary Least Squares (OLS) regression\n    # np.linalg.lstsq solves Y = X*beta for beta\n    coeffs, residuals, _, _ = np.linalg.lstsq(X, Y, rcond=None)\n    \n    # 4. Calculate Root-Mean-Square Error (RMSE)\n    if residuals.size == 0:\n        # If n_samples = n_features, lstsq may return empty residuals.\n        # In this case, residuals must be computed manually.\n        Y_pred = X @ coeffs\n        res_sum_sq = np.sum((Y - Y_pred)**2)\n        rmse = np.sqrt(res_sum_sq / num_isotopes) if num_isotopes > 0 else 0.0\n    else:\n        # residuals[0] contains the sum of squared residuals\n        rmse = np.sqrt(residuals[0] / num_isotopes) if num_isotopes > 0 else 0.0\n        \n    return list(coeffs) + [rmse]\n\n\ndef solve():\n    \"\"\"\n    Main orchestrator for the problem. Defines data and test cases,\n    runs the analysis, and prints the final formatted output.\n    \"\"\"\n    # Dataset: (Z, N, A, M_atom_u)\n    # Z, N, A are integers; M_atom_u is float.\n    DATA = [\n        (1, 1, 2, 2.01410177812),   # Deuterium\n        (2, 1, 3, 3.01602932265),   # Helium-3\n        (2, 2, 4, 4.00260325413),   # Helium-4\n        (6, 6, 12, 12.0),           # Carbon-12\n        (7, 7, 14, 14.00307400443), # Nitrogen-14\n        (8, 8, 16, 15.99491461957), # Oxygen-16\n        (20, 20, 40, 39.96259098),  # Calcium-40\n        (20, 28, 48, 47.95252276),  # Calcium-48\n        (26, 30, 56, 55.93493633),  # Iron-56\n        (28, 30, 58, 57.9353429),   # Nickel-58\n        (40, 50, 90, 89.9047037),   # Zirconium-90\n        (82, 126, 208, 207.9766521) # Lead-208\n    ]\n\n    all_results = []\n\n    # Case 1: Full dataset, with electron binding energy correction\n    results_1 = run_semf_fit(DATA, use_electron_binding=True)\n    all_results.append(results_1)\n    \n    # Case 2: Even-even subset, with electron binding energy correction\n    even_even_data = [d for d in DATA if d[0] % 2 == 0 and d[1] % 2 == 0]\n    results_2 = run_semf_fit(even_even_data, use_electron_binding=True)\n    all_results.append(results_2)\n    \n    # Case 3: Full dataset, without electron binding energy correction\n    results_3 = run_semf_fit(DATA, use_electron_binding=False)\n    all_results.append(results_3)\n    \n    # Format the final output string exactly as required.\n    output_parts = []\n    for res_list in all_results:\n        formatted_list = [f\"{val:.6f}\" for val in res_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output_str = f\"[{','.join(output_parts)}]\"\n    print(final_output_str)\n\nsolve()\n\n```", "id": "3573765"}, {"introduction": "Beyond the classical liquid-drop terms, the SEMF includes a pairing term that captures a crucial quantum mechanical effect: the tendency of like-nucleons to form spin-zero pairs, which adds extra binding. The most direct experimental signature of this effect is the odd-even staggering of nuclear masses. In this practice [@problem_id:3573772], you will derive a quantitative measure for this staggering and use it to analyze mass data, connecting a specific term in a model to its observable consequences.", "problem": "A core task in computational nuclear physics is to quantify odd–even mass staggering along an isotopic chain and relate it to empirical trends for pairing gaps. Consider the tin isotopic chain with fixed proton number $Z=50$. You are given the following neutral atomic masses $M_{\\mathrm{atom}}(N,Z)$ in atomic mass units (unified atomic mass unit denoted by $\\mathrm{u}$) for neutron numbers $N=\\{62,63,\\dots,70\\}$, corresponding to mass numbers $A=N+Z=\\{112,113,\\dots,120\\}$:\n- $A=112$ ($N=62$): $M_{\\mathrm{atom}}=111.90482387\\ \\mathrm{u}$\n- $A=113$ ($N=63$): $M_{\\mathrm{atom}}=112.90517300\\ \\mathrm{u}$\n- $A=114$ ($N=64$): $M_{\\mathrm{atom}}=113.90278270\\ \\mathrm{u}$\n- $A=115$ ($N=65$): $M_{\\mathrm{atom}}=114.90334470\\ \\mathrm{u}$\n- $A=116$ ($N=66$): $M_{\\mathrm{atom}}=115.90174280\\ \\mathrm{u}$\n- $A=117$ ($N=67$): $M_{\\mathrm{atom}}=116.90295400\\ \\mathrm{u}$\n- $A=118$ ($N=68$): $M_{\\mathrm{atom}}=117.90160660\\ \\mathrm{u}$\n- $A=119$ ($N=69$): $M_{\\mathrm{atom}}=118.90331120\\ \\mathrm{u}$\n- $A=120$ ($N=70$): $M_{\\mathrm{atom}}=119.90220160\\ \\mathrm{u}$\n\nTake the conversion factor $1\\ \\mathrm{u}\\,c^{2} = 931.49410242\\ \\mathrm{MeV}$. Throughout, treat the mass number $A$ as a dimensionless count of nucleons.\n\nStarting from the fundamental definition of nuclear binding energy in terms of masses and the one-neutron separation energy, derive a three-point neutron odd–even staggering indicator along an isotopic chain and reduce it to a form computable directly from the given atomic masses such that contributions from electrons cancel. Using your derived expression, compute the three-point neutron staggering values $\\Delta_{n}^{(3)}(N,Z)$ at the central points $N=\\{63,64,65,66,67,68,69\\}$ of this chain. For the purpose of comparing to an empirical trend for pairing gaps, use the magnitude $|\\Delta_{n}^{(3)}(N,Z)|$ at each central $N$.\n\nAssuming a mass-number dependence of the form $\\Delta(A)\\approx C/\\sqrt{A}$, determine the least-squares best-fit coefficient $C$ under the constraint that the intercept is zero; that is, choose $C$ to minimize $\\sum_{i}\\left(\\Delta_{i} - C/\\sqrt{A_{i}}\\right)^{2}$ over the seven central isotopes. Round your final value of $C$ to four significant figures. Express the final result in $\\mathrm{MeV}$.", "solution": "The nuclear binding energy, $B(N,Z)$, of a nucleus with $N$ neutrons and $Z$ protons is the energy required to disassemble it into its constituent nucleons. It is defined in terms of nuclear masses $M_{\\mathrm{nuc}}$ and the masses of the free proton $m_p$ and neutron $m_n$:\n$$B(N,Z) = [Z m_p + N m_n - M_{\\mathrm{nuc}}(N,Z)]c^2$$\nThe problem provides neutral atomic masses, $M_{\\mathrm{atom}}(N,Z)$. The nuclear mass is related to the atomic mass by:\n$$M_{\\mathrm{nuc}}(N,Z) = M_{\\mathrm{atom}}(N,Z) - Z m_e + B_e(Z)/c^2$$\nwhere $m_e$ is the electron mass and $B_e(Z)$ is the total binding energy of the $Z$ electrons.\n\nThe one-neutron separation energy, $S_n(N,Z)$, is the energy required to remove one neutron from the nucleus $(N,Z)$. It is the difference in binding energies:\n$$S_n(N,Z) = B(N,Z) - B(N-1,Z)$$\nSubstituting the expression for binding energy in terms of nuclear masses:\n$$S_n(N,Z) = ([Z m_p + N m_n - M_{\\mathrm{nuc}}(N,Z)] - [Z m_p + (N-1) m_n - M_{\\mathrm{nuc}}(N-1,Z)])c^2$$\n$$S_n(N,Z) = [m_n - M_{\\mathrm{nuc}}(N,Z) + M_{\\mathrm{nuc}}(N-1,Z)]c^2$$\nTo express this in terms of atomic masses for an isotopic chain (constant $Z$):\n$$S_n(N,Z) = [m_n - (M_{\\mathrm{atom}}(N,Z) - Z m_e + B_e(Z)/c^2) + (M_{\\mathrm{atom}}(N-1,Z) - Z m_e + B_e(Z)/c^2)]c^2$$\nThe electron mass terms $Z m_e$ and electron binding energy terms $B_e(Z)/c^2$ cancel out because $Z$ is constant.\n$$S_n(N,Z) = [m_n - M_{\\mathrm{atom}}(N,Z) + M_{\\mathrm{atom}}(N-1,Z)]c^2$$\n\nThe three-point odd-even staggering indicator, $\\Delta_{n}^{(3)}(N,Z)$, is a finite difference approximation of the second derivative of the binding energy with respect to the neutron number. It is defined as:\n$$\\Delta_{n}^{(3)}(N,Z) = \\frac{1}{2} [B(N+1,Z) - 2B(N,Z) + B(N-1,Z)]$$\nThis can be expressed in terms of one-neutron separation energies:\n$$B(N+1,Z) - B(N,Z) = S_n(N+1,Z)$$\n$$B(N,Z) - B(N-1,Z) = S_n(N,Z)$$\nThus,\n$$\\Delta_{n}^{(3)}(N,Z) = \\frac{1}{2} [S_n(N+1,Z) - S_n(N,Z)]$$\nNow, substituting the expression for $S_n$ in terms of atomic masses:\n$$\\Delta_{n}^{(3)}(N,Z) = \\frac{1}{2} \\left( [m_n - M_{\\mathrm{atom}}(N+1,Z) + M_{\\mathrm{atom}}(N,Z)]c^2 - [m_n - M_{\\mathrm{atom}}(N,Z) + M_{\\mathrm{atom}}(N-1,Z)]c^2 \\right)$$\nThe neutron mass $m_n$ cancels out, yielding the desired expression computable from atomic masses:\n$$\\Delta_{n}^{(3)}(N,Z) = \\frac{c^2}{2} [M_{\\mathrm{atom}}(N-1,Z) - 2M_{\\mathrm{atom}}(N,Z) + M_{\\mathrm{atom}}(N+1,Z)]$$\n\nWe now compute $\\Delta_{n}^{(3)}(N,Z)$ for $N=\\{63, 64, \\dots, 69\\}$. Let $k = 931.49410242\\ \\mathrm{MeV/u}$.\nThe formula is $\\Delta_{n}^{(3)}(N,50) = \\frac{k}{2} [M_{\\mathrm{atom}}(N-1,50) - 2M_{\\mathrm{atom}}(N,50) + M_{\\mathrm{atom}}(N+1,50)]$.\n\nFor $N=63$ ($A=113$):\n$\\Delta_{n}^{(3)}(63,50) = \\frac{k}{2} [111.90482387 - 2(112.90517300) + 113.90278270] = \\frac{k}{2} [-0.00273943] = -1.27581\\ \\mathrm{MeV}$\n\nFor $N=64$ ($A=114$):\n$\\Delta_{n}^{(3)}(64,50) = \\frac{k}{2} [112.90517300 - 2(113.90278270) + 114.90334470] = \\frac{k}{2} [0.0029523] = 1.37494\\ \\mathrm{MeV}$\n\nFor $N=65$ ($A=115$):\n$\\Delta_{n}^{(3)}(65,50) = \\frac{k}{2} [113.90278270 - 2(114.90334470) + 115.90174280] = \\frac{k}{2} [-0.0021639] = -1.00782\\ \\mathrm{MeV}$\n\nFor $N=66$ ($A=116$):\n$\\Delta_{n}^{(3)}(66,50) = \\frac{k}{2} [114.90334470 - 2(115.90174280) + 116.90295400] = \\frac{k}{2} [0.0028131] = 1.31012\\ \\mathrm{MeV}$\n\nFor $N=67$ ($A=117$):\n$\\Delta_{n}^{(3)}(67,50) = \\frac{k}{2} [115.90174280 - 2(116.90295400) + 117.90160660] = \\frac{k}{2} [-0.0025586] = -1.19159\\ \\mathrm{MeV}$\n\nFor $N=68$ ($A=118$):\n$\\Delta_{n}^{(3)}(68,50) = \\frac{k}{2} [116.90295400 - 2(117.90160660) + 118.90331120] = \\frac{k}{2} [0.003052] = 1.42140\\ \\mathrm{MeV}$\n\nFor $N=69$ ($A=119$):\n$\\Delta_{n}^{(3)}(69,50) = \\frac{k}{2} [117.90160660 - 2(118.90331120) + 119.90220160] = \\frac{k}{2} [-0.0028142] = -1.31063\\ \\mathrm{MeV}$\n\nThe magnitudes $\\Delta_i=|\\Delta_{n}^{(3)}(A_i)|$ are:\n- $A_1=113$: $\\Delta_1=1.27581\\ \\mathrm{MeV}$\n- $A_2=114$: $\\Delta_2=1.37494\\ \\mathrm{MeV}$\n- $A_3=115$: $\\Delta_3=1.00782\\ \\mathrm{MeV}$\n- $A_4=116$: $\\Delta_4=1.31012\\ \\mathrm{MeV}$\n- $A_5=117$: $\\Delta_5=1.19159\\ \\mathrm{MeV}$\n- $A_6=118$: $\\Delta_6=1.42140\\ \\mathrm{MeV}$\n- $A_7=119$: $\\Delta_7=1.31063\\ \\mathrm{MeV}$\n\nWe fit these values to the model $\\Delta(A) = C/\\sqrt{A}$. We need to find $C$ that minimizes the sum of squared residuals $S(C)$:\n$$S(C) = \\sum_{i=1}^{7} \\left(\\Delta_i - \\frac{C}{\\sqrt{A_i}}\\right)^2$$\nTo minimize $S(C)$, we set its derivative with respect to $C$ to zero:\n$$\\frac{dS}{dC} = \\sum_{i=1}^{7} 2 \\left(\\Delta_i - \\frac{C}{\\sqrt{A_i}}\\right) \\left(-\\frac{1}{\\sqrt{A_i}}\\right) = 0$$\n$$-\\sum_{i=1}^{7} \\frac{\\Delta_i}{\\sqrt{A_i}} + C \\sum_{i=1}^{7} \\frac{1}{A_i} = 0$$\nSolving for $C$:\n$$C = \\frac{\\sum_{i=1}^{7} (\\Delta_i / \\sqrt{A_i})}{\\sum_{i=1}^{7} (1/A_i)}$$\nWe compute the two sums:\nThe numerator is:\n$$\\sum_{i=1}^{7} \\frac{\\Delta_i}{\\sqrt{A_i}} = \\frac{1.27581}{\\sqrt{113}} + \\frac{1.37494}{\\sqrt{114}} + \\frac{1.00782}{\\sqrt{115}} + \\frac{1.31012}{\\sqrt{116}} + \\frac{1.19159}{\\sqrt{117}} + \\frac{1.42140}{\\sqrt{118}} + \\frac{1.31063}{\\sqrt{119}}$$\n$$ = 0.120004 + 0.128743 + 0.093999 + 0.121672 + 0.110220 + 0.130954 + 0.120297 = 0.825889\\ \\mathrm{MeV}$$\nThe denominator is:\n$$\\sum_{i=1}^{7} \\frac{1}{A_i} = \\frac{1}{113} + \\frac{1}{114} + \\frac{1}{115} + \\frac{1}{116} + \\frac{1}{117} + \\frac{1}{118} + \\frac{1}{119}$$\n$$ = 0.00884956 + 0.00877193 + 0.00869565 + 0.00862069 + 0.00854701 + 0.00847458 + 0.00840336 = 0.06036278$$\nFinally, we calculate $C$:\n$$C = \\frac{0.825889}{0.06036278} = 13.6823\\ \\mathrm{MeV}$$\nRounding to four significant figures, we get $C = 13.68\\ \\mathrm{MeV}$.", "answer": "$$\n\\boxed{13.68}\n$$", "id": "3573772"}, {"introduction": "While macroscopic models like the SEMF are powerful, modern nuclear theory is dominated by microscopic approaches like Density Functional Theory (DFT), which work with single-particle orbitals and energies. A common misconception is to directly apply Koopmans' theorem, equating the separation energy to the negative of the highest occupied single-particle energy. This practice [@problem_id:3573744] uses a simplified but insightful DFT-like model to test this idea, revealing its shortcomings and highlighting the critical physical concepts of mean-field rearrangement and correlation effects that distinguish many-body systems.", "problem": "You are asked to design and implement a numerical experiment, using a simplified density functional theory (DFT) analog, to test a Koopmans-style estimator for nucleon separation energies against fully self-consistent finite-difference results. Your task is to formulate the problem starting from fundamental principles and widely tested results, then implement a program that computes and compares neutron and proton separation energies for a small test suite of nuclei.\n\nStart from the following foundational bases:\n\n- Nonrelativistic degenerate Fermi gas at zero temperature: for a uniform species of fermions with number density $\\rho_q$, the Fermi momentum is $k_{F,q} = \\left(3\\pi^2 \\rho_q\\right)^{1/3}$, the Fermi kinetic energy is $T_{F,q} = \\frac{\\hbar^2 k_{F,q}^2}{2m}$, and the kinetic energy per particle equals $\\frac{3}{5} T_{F,q}$.\n\n- Hartree mean-field with double-counting correction: in a Hartree description with a one-body mean field $U_q$, the total potential energy is $\\frac{1}{2} \\sum_q N_q U_q$ when evaluated at self-consistency.\n\n- Koopmans-style removal energy estimator in a frozen mean-field: in an independent-particle picture, the removal energy of the last occupied particle of species $q$ can be approximated by the negative of the single-particle energy at the Fermi surface, $-\\varepsilon_{F,q}$, when neglecting rearrangement of the mean field and derivative discontinuities.\n\nModel assumptions to be used for the computation:\n\n- Consider a uniform finite nucleus at saturation density with two fermion species $q \\in \\{n,p\\}$ (neutrons $n$ and protons $p$). Let the total nucleon number be $A = N + Z$, with species fractions $x_n = N/A$ and $x_p = Z/A$. Assume a constant saturation density $\\rho_0 = 0.16\\,\\text{fm}^{-3}$, so that the species densities are $\\rho_n = x_n \\rho_0$ and $\\rho_p = x_p \\rho_0$.\n\n- Use nonrelativistic nucleons with $\\hbar^2/(2m) = 20.735\\,\\text{MeV}\\,\\text{fm}^2$. Then the Fermi kinetic energies are $T_{F,q} = \\frac{\\hbar^2}{2m} \\left(3\\pi^2 \\rho_q\\right)^{2/3}$.\n\n- Adopt a species-dependent local mean-field potential of the form\n  $$\n  U_n(N,Z) = u_0 + u_{\\text{sym}} \\,\\delta, \\quad U_p(N,Z) = u_0 - u_{\\text{sym}} \\,\\delta + u_c \\frac{Z}{A^{1/3}},\n  $$\n  where $\\delta = \\frac{N-Z}{A}$ is the asymmetry parameter. Use parameters $u_0 = -60\\,\\text{MeV}$, $u_{\\text{sym}} = 50\\,\\text{MeV}$, and $u_c = 1.44\\,\\text{MeV}$.\n\n- Include a schematic pairing correlation energy\n  $$\n  E_{\\text{pair}}(N,Z) = -\\frac{p_0}{\\sqrt{A}} \\left(\\delta_{N \\text{ even}} + \\delta_{Z \\text{ even}}\\right),\n  $$\n  with $p_0 = 12\\,\\text{MeV}$ and $\\delta_{N \\text{ even}}$ equal to $1$ if $N$ is even and $0$ otherwise (similarly for $\\delta_{Z \\text{ even}}$).\n\nDerive, from the above bases, algorithmic expressions for the following quantities:\n\n1) The total ground-state energy for a given $(N,Z)$ in this uniform Thomas-Fermi Hartree model,\n   $$\n   E(N,Z) = \\sum_{q \\in \\{n,p\\}} \\frac{3}{5} N_q T_{F,q} + \\frac{1}{2}\\left(N U_n + Z U_p\\right) + E_{\\text{pair}}(N,Z),\n   $$\n   and the corresponding binding energy $B(N,Z) = -E(N,Z)$, in $\\text{MeV}$.\n\n2) The fully self-consistent one-nucleon separation energies, computed by discrete differences of the binding energies,\n   $$\n   S_n(N,Z) = B(N,Z) - B(N-1,Z), \\quad S_p(N,Z) = B(N,Z) - B(N,Z-1),\n   $$\n   in $\\text{MeV}$, where $N \\ge 1$ and $Z \\ge 1$.\n\n3) The Koopmans-style estimates obtained by freezing the mean field at $(N,Z)$ and evaluating the Fermi single-particle energies,\n   $$\n   \\varepsilon_{F,q}(N,Z) = T_{F,q}(N,Z) + U_q(N,Z), \\quad S_n^{K}(N,Z) \\approx -\\varepsilon_{F,n}(N,Z), \\quad S_p^{K}(N,Z) \\approx -\\varepsilon_{F,p}(N,Z),\n   $$\n   in $\\text{MeV}$.\n\nYou must implement a program that, for the following test suite of nuclei $(N,Z)$, computes $S_n$, $S_n^{K}$, $S_p$, and $S_p^{K}$:\n\n- $(8,8)$, $(20,20)$, $(28,20)$, $(28,28)$, $(82,50)$, $(126,82)$, $(21,20)$, $(83,50)$, $(20,21)$.\n\nThen, over this suite, also compute the following diagnostic metrics to quantify and interpret deviations due to correlations and rearrangement effects:\n\n- Root-mean-square deviations of the Koopmans errors for neutrons and protons,\n  $$\n  \\text{RMS}_n = \\sqrt{\\langle \\left(S_n^{K} - S_n\\right)^2 \\rangle}, \\quad \\text{RMS}_p = \\sqrt{\\langle \\left(S_p^{K} - S_p\\right)^2 \\rangle},\n  $$\n  in $\\text{MeV}$, where $\\langle \\cdot \\rangle$ denotes the average over the test suite.\n\n- An odd-even staggering diagnostic for neutrons and protons, defined as the difference between the mean Koopmans errors for even and odd particle numbers,\n  $$\n  \\text{OES}_n = \\langle S_n^{K} - S_n \\rangle_{N \\text{ even}} - \\langle S_n^{K} - S_n \\rangle_{N \\text{ odd}},\n  $$\n  $$\n  \\text{OES}_p = \\langle S_p^{K} - S_p \\rangle_{Z \\text{ even}} - \\langle S_p^{K} - S_p \\rangle_{Z \\text{ odd}},\n  $$\n  in $\\text{MeV}$.\n\nAll energies must be expressed in $\\text{MeV}$ and rounded to three decimals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The entries must appear in the following order:\n\n- For each test case in the order listed above, output four numbers: $S_n$, $S_n^{K}$, $S_p$, $S_p^{K}$ (each rounded to three decimals, in $\\text{MeV}$).\n- After all cases, append $\\text{RMS}_n$, $\\text{RMS}_p$, $\\text{OES}_n$, $\\text{OES}_p$ (each rounded to three decimals, in $\\text{MeV}$).\n\nThe final output format is therefore a flat list of floats:\n$[S_{n,1},S_{n,1}^{K},S_{p,1},S_{p,1}^{K},\\dots,S_{n,9},S_{n,9}^{K},S_{p,9},S_{p,9}^{K},\\text{RMS}_n,\\text{RMS}_p,\\text{OES}_n,\\text{OES}_p]$.", "solution": "We begin from well-established principles for a nonrelativistic degenerate Fermi gas and Hartree mean-field descriptions. For each species $q \\in \\{n,p\\}$ with number $N_q$ and number density $\\rho_q$, the Fermi momentum is $k_{F,q} = \\left(3\\pi^2 \\rho_q\\right)^{1/3}$ and the Fermi kinetic energy is $T_{F,q} = \\frac{\\hbar^2 k_{F,q}^2}{2m}$. The kinetic energy per particle equals $\\frac{3}{5} T_{F,q}$; therefore the total kinetic energy for species $q$ is $E_{\\text{kin},q} = \\frac{3}{5} N_q T_{F,q}$. Summing over species yields\n$$\nE_{\\text{kin}}(N,Z) = \\frac{3}{5} \\left(N T_{F,n} + Z T_{F,p}\\right),\n$$\nwith $T_{F,q}$ dependent on $\\rho_q$.\n\nWe assume a uniform finite nucleus at saturation density $\\rho_0 = 0.16\\,\\text{fm}^{-3}$ with total nucleon number $A = N+Z$ and species fractions $x_n = \\frac{N}{A}$ and $x_p = \\frac{Z}{A}$. For each species, $\\rho_q = x_q \\rho_0$. Then the Fermi kinetic energies are\n$$\nT_{F,q}(N,Z) = \\frac{\\hbar^2}{2m} \\left(3\\pi^2 x_q \\rho_0\\right)^{2/3}, \\quad \\frac{\\hbar^2}{2m} = 20.735\\,\\text{MeV}\\,\\text{fm}^2.\n$$\n\nIn a Hartree mean-field model, the total potential energy is given by the half-sum over occupied particles of the mean field evaluated at the self-consistent density,\n$$\nE_{\\text{mf}}(N,Z) = \\frac{1}{2}\\left(N U_n(N,Z) + Z U_p(N,Z)\\right).\n$$\nWe posit a mean field consisting of an isoscalar depth $u_0$, an isovector term proportional to the asymmetry parameter $\\delta = \\frac{N-Z}{A}$ with strength $u_{\\text{sym}}$, and a proton Coulomb term scaling as $Z/A^{1/3}$ with strength $u_c$:\n$$\nU_n(N,Z) = u_0 + u_{\\text{sym}} \\,\\delta, \\quad U_p(N,Z) = u_0 - u_{\\text{sym}} \\,\\delta + u_c \\frac{Z}{A^{1/3}}.\n$$\nWe set $u_0 = -60\\,\\text{MeV}$, $u_{\\text{sym}} = 50\\,\\text{MeV}$, and $u_c = 1.44\\,\\text{MeV}$.\n\nTo incorporate pairing correlations at a schematic level, we add a phenomenological term\n$$\nE_{\\text{pair}}(N,Z) = -\\frac{p_0}{\\sqrt{A}} \\left(\\delta_{N \\text{ even}} + \\delta_{Z \\text{ even}}\\right),\n$$\nwith $p_0 = 12\\,\\text{MeV}$, and $\\delta_{N \\text{ even}}$ equals $1$ if $N$ is even and $0$ otherwise (similarly for $\\delta_{Z \\text{ even}}$). This term gives extra binding for even particle numbers and vanishes for odd particle numbers, mimicking odd-even staggering.\n\nThe total energy and binding energy then follow as\n$$\nE(N,Z) = E_{\\text{kin}}(N,Z) + E_{\\text{mf}}(N,Z) + E_{\\text{pair}}(N,Z), \\quad B(N,Z) = -E(N,Z),\n$$\nin $\\text{MeV}$.\n\nThe fully self-consistent separation energies are computed by finite differences of the binding energies:\n$$\nS_n(N,Z) = B(N,Z) - B(N-1,Z), \\quad S_p(N,Z) = B(N,Z) - B(N,Z-1),\n$$\nin $\\text{MeV}$, with $N \\ge 1$ and $Z \\ge 1$. This procedure corresponds to recomputing the densities, Fermi kinetic energies, and mean fields for the $(N-1,Z)$ and $(N,Z-1)$ systems, thereby including rearrangement effects due to the change in $A$, the change in the asymmetry parameter $\\delta$, and the Coulomb contribution.\n\nThe Koopmans-style estimator is based on the frozen mean-field approximation: remove a particle without allowing the mean field to relax. In that case, the removal energy is approximated by the negative of the single-particle energy at the Fermi surface. The Kohn-Sham-like single-particle energy at the Fermi surface equals the sum of the species Fermi kinetic energy and the mean-field potential,\n$$\n\\varepsilon_{F,q}(N,Z) = T_{F,q}(N,Z) + U_q(N,Z).\n$$\nTherefore,\n$$\nS_n^{K}(N,Z) \\approx -\\varepsilon_{F,n}(N,Z) = -\\left[T_{F,n}(N,Z) + U_n(N,Z)\\right], \\quad\nS_p^{K}(N,Z) \\approx -\\varepsilon_{F,p}(N,Z) = -\\left[T_{F,p}(N,Z) + U_p(N,Z)\\right].\n$$\nThis estimator neglects two physically important sources of deviation: (i) mean-field rearrangement (density and field change between $(N,Z)$ and $(N-1,Z)$ or $(N,Z-1)$) and (ii) explicit correlation energies such as pairing, $E_{\\text{pair}}$, which are not represented in the single-particle eigenvalues.\n\nTo quantify the estimator’s performance over a set of nuclei, we compute the Koopmans errors $S_n^{K} - S_n$ and $S_p^{K} - S_p$ for each case, and then report\n$$\n\\text{RMS}_n = \\sqrt{\\left\\langle \\left(S_n^{K} - S_n\\right)^2 \\right\\rangle}, \\quad\n\\text{RMS}_p = \\sqrt{\\left\\langle \\left(S_p^{K} - S_p\\right)^2 \\right\\rangle},\n$$\nas root-mean-square deviations, both in $\\text{MeV}$. To diagnose pairing-driven odd-even effects, we also compute\n$$\n\\text{OES}_n = \\langle S_n^{K} - S_n \\rangle_{N \\text{ even}} - \\langle S_n^{K} - S_n \\rangle_{N \\text{ odd}}, \\quad\n\\text{OES}_p = \\langle S_p^{K} - S_p \\rangle_{Z \\text{ even}} - \\langle S_p^{K} - S_p \\rangle_{Z \\text{ odd}},\n$$\nwhich should be positive if Koopmans tends to overestimate separation energies more strongly for even systems (because $E_{\\text{pair}}$ contributes extra binding that the frozen-field estimator misses).\n\nAlgorithmic implementation details:\n\n- Compute $x_n = N/A$, $x_p = Z/A$, then $\\rho_n = x_n \\rho_0$ and $\\rho_p = x_p \\rho_0$.\n- Compute $T_{F,q} = \\frac{\\hbar^2}{2m} \\left(3\\pi^2 \\rho_q\\right)^{2/3}$ for $q \\in \\{n,p\\}$.\n- Compute $\\delta = \\frac{N-Z}{A}$ and then $U_n$ and $U_p$.\n- Compute $E_{\\text{kin}} = \\frac{3}{5} \\left(N T_{F,n} + Z T_{F,p}\\right)$.\n- Compute $E_{\\text{mf}} = \\frac{1}{2} \\left(N U_n + Z U_p\\right)$.\n- Compute $E_{\\text{pair}} = -\\frac{p_0}{\\sqrt{A}} \\left(\\delta_{N \\text{ even}} + \\delta_{Z \\text{ even}}\\right)$.\n- Compute $E(N,Z)$ and $B(N,Z) = -E(N,Z)$.\n- Compute $S_n$ and $S_p$ via finite differences of $B$.\n- Compute $S_n^{K}$ and $S_p^{K}$ from the negative Fermi single-particle energies at $(N,Z)$.\n- For the test suite $(N,Z) = (8,8), (20,20), (28,20), (28,28), (82,50), (126,82), (21,20), (83,50), (20,21)$, compute and collect $S_n$, $S_n^{K}$, $S_p$, $S_p^{K}$ for each case.\n- Compute $\\text{RMS}_n$, $\\text{RMS}_p$, $\\text{OES}_n$, and $\\text{OES}_p$ across the suite.\n- Express all energies in $\\text{MeV}$, rounded to three decimals, and print a single line output in the specified flat list format.\n\nThis construction is physically and numerically self-consistent: the kinetic energy scales as $A$ in this uniform Thomas-Fermi picture, the mean-field part provides an isoscalar binding depth with isovector symmetry and Coulomb contributions, and pairing induces odd-even staggering that the Koopmans estimator cannot capture. The deviations thus diagnose both mean-field rearrangement and correlation effects.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants and model parameters\nHBAR2_OVER_2M = 20.735  # MeV fm^2\nRHO0 = 0.16             # fm^-3\nU0 = -60.0              # MeV (isoscalar mean-field depth)\nU_SYM = 50.0            # MeV (isovector strength)\nU_C = 1.44              # MeV (Coulomb strength)\nP0 = 12.0               # MeV (pairing parameter)\n\ndef fermi_kinetic_energy(x_fraction: float) -> float:\n    \"\"\"\n    Compute the Fermi kinetic energy T_F for a species with fraction x = N_q / A\n    in a uniform system at saturation density RHO0.\n    T_F = (hbar^2 / 2m) * (3*pi^2 * rho_q)^(2/3), rho_q = x * RHO0\n    \"\"\"\n    rho_q = x_fraction * RHO0\n    # Guard against numerical issues for x=0 (though not relevant for provided test cases)\n    if rho_q = 0.0:\n        return 0.0\n    return HBAR2_OVER_2M * (3.0 * np.pi**2 * rho_q) ** (2.0 / 3.0)\n\ndef mean_fields(N: int, Z: int) -> tuple[float, float]:\n    \"\"\"\n    Compute neutron and proton mean fields U_n and U_p at (N,Z):\n      U_n = U0 + U_SYM * delta\n      U_p = U0 - U_SYM * delta + U_C * Z / A^(1/3)\n    where delta = (N - Z) / A\n    \"\"\"\n    A = N + Z\n    if A = 0:\n        return 0.0, 0.0\n    delta = (N - Z) / A\n    Un = U0 + U_SYM * delta\n    Up = U0 - U_SYM * delta + U_C * Z / (A ** (1.0 / 3.0))\n    return Un, Up\n\ndef pairing_energy(N: int, Z: int) -> float:\n    \"\"\"\n    Schematic pairing correlation energy:\n      E_pair = - P0 / sqrt(A) * (delta_N_even + delta_Z_even)\n    \"\"\"\n    A = N + Z\n    if A = 0:\n        return 0.0\n    delta_N_even = 1 if (N % 2 == 0) else 0\n    delta_Z_even = 1 if (Z % 2 == 0) else 0\n    return -P0 / np.sqrt(A) * (delta_N_even + delta_Z_even)\n\ndef total_energy(N: int, Z: int) -> float:\n    \"\"\"\n    Total energy E(N,Z) = E_kin + E_mf + E_pair.\n    \"\"\"\n    A = N + Z\n    if A = 0:\n        return 0.0\n    xn = N / A\n    xp = Z / A\n    TFn = fermi_kinetic_energy(xn)\n    TFp = fermi_kinetic_energy(xp)\n    Un, Up = mean_fields(N, Z)\n    Ekin = (3.0 / 5.0) * (N * TFn + Z * TFp)\n    Emf = 0.5 * (N * Un + Z * Up)\n    Epair = pairing_energy(N, Z)\n    return Ekin + Emf + Epair\n\ndef binding_energy(N: int, Z: int) -> float:\n    \"\"\"\n    Binding energy B = -E.\n    \"\"\"\n    return -total_energy(N, Z)\n\ndef separation_neutron(N: int, Z: int) -> float:\n    \"\"\"\n    Neutron separation energy S_n = B(N,Z) - B(N-1,Z), for N >= 1.\n    \"\"\"\n    if N = 0:\n        raise ValueError(\"N must be >= 1 for neutron separation energy.\")\n    return binding_energy(N, Z) - binding_energy(N - 1, Z)\n\ndef separation_proton(N: int, Z: int) -> float:\n    \"\"\"\n    Proton separation energy S_p = B(N,Z) - B(N,Z-1), for Z >= 1.\n    \"\"\"\n    if Z = 0:\n        raise ValueError(\"Z must be >= 1 for proton separation energy.\")\n    return binding_energy(N, Z) - binding_energy(N, Z - 1)\n\ndef koopmans_estimates(N: int, Z: int) -> tuple[float, float]:\n    \"\"\"\n    Koopmans-style estimates:\n      S_n^K = -[ T_Fn(N,Z) + U_n(N,Z) ]\n      S_p^K = -[ T_Fp(N,Z) + U_p(N,Z) ]\n    \"\"\"\n    A = N + Z\n    xn = N / A\n    xp = Z / A\n    TFn = fermi_kinetic_energy(xn)\n    TFp = fermi_kinetic_energy(xp)\n    Un, Up = mean_fields(N, Z)\n    SnK = -(TFn + Un)\n    SpK = -(TFp + Up)\n    return SnK, SpK\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (8, 8),\n        (20, 20),\n        (28, 20),\n        (28, 28),\n        (82, 50),\n        (126, 82),\n        (21, 20),\n        (83, 50),\n        (20, 21),\n    ]\n\n    results = []\n    errors_n = []\n    errors_p = []\n    parity_n_even = []\n    parity_z_even = []\n\n    for (N, Z) in test_cases:\n        # Compute fully self-consistent separation energies\n        Sn = separation_neutron(N, Z)\n        Sp = separation_proton(N, Z)\n        # Koopmans estimates\n        SnK, SpK = koopmans_estimates(N, Z)\n\n        # Round to three decimals for output\n        results.extend([round(Sn, 3), round(SnK, 3), round(Sp, 3), round(SpK, 3)])\n\n        # Accumulate errors for diagnostics (use unrounded values)\n        err_n = SnK - Sn\n        err_p = SpK - Sp\n        errors_n.append(err_n)\n        errors_p.append(err_p)\n        parity_n_even.append(1 if (N % 2 == 0) else 0)\n        parity_z_even.append(1 if (Z % 2 == 0) else 0)\n\n    # Diagnostics: RMS errors\n    errors_n_arr = np.array(errors_n, dtype=float)\n    errors_p_arr = np.array(errors_p, dtype=float)\n    rms_n = float(np.sqrt(np.mean(errors_n_arr ** 2)))\n    rms_p = float(np.sqrt(np.mean(errors_p_arr ** 2)))\n\n    # Odd-even staggering diagnostics: difference between mean error for even and odd\n    parity_n_even_arr = np.array(parity_n_even, dtype=int)\n    parity_z_even_arr = np.array(parity_z_even, dtype=int)\n\n    # For neutrons\n    even_idx_n = parity_n_even_arr == 1\n    odd_idx_n = parity_n_even_arr == 0\n    mean_err_n_even = float(np.mean(errors_n_arr[even_idx_n])) if np.any(even_idx_n) else 0.0\n    mean_err_n_odd = float(np.mean(errors_n_arr[odd_idx_n])) if np.any(odd_idx_n) else 0.0\n    oes_n = mean_err_n_even - mean_err_n_odd\n\n    # For protons\n    even_idx_p = parity_z_even_arr == 1\n    odd_idx_p = parity_z_even_arr == 0\n    mean_err_p_even = float(np.mean(errors_p_arr[even_idx_p])) if np.any(even_idx_p) else 0.0\n    mean_err_p_odd = float(np.mean(errors_p_arr[odd_idx_p])) if np.any(odd_idx_p) else 0.0\n    oes_p = mean_err_p_even - mean_err_p_odd\n\n    # Append diagnostics to results, rounded to three decimals\n    results.extend([round(rms_n, 3), round(rms_p, 3), round(oes_n, 3), round(oes_p, 3)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3573744"}]}