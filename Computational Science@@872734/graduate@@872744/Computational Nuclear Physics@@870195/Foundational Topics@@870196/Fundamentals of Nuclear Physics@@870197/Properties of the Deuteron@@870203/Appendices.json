{"hands_on_practices": [{"introduction": "To understand the properties of the deuteron, we must first be able to solve its governing quantum mechanical equation. This practice [@problem_id:3582617] guides you through the foundational task of converting the radial Schrödinger equation into a matrix eigenvalue problem, which can be solved numerically. You will implement and compare two powerful techniques—the finite-difference and spectral methods—to gain hands-on experience with the trade-offs in accuracy and computational approach for a given nuclear potential.", "problem": "Consider the bound-state of the proton–neutron system (the deuteron) in the nonrelativistic limit, modeled by the radial time-independent Schrödinger equation for the reduced radial wave function $u(r)$ in the $S$-wave channel:\n$$\n-\\frac{\\hbar^2}{2\\mu}\\frac{d^2 u(r)}{dr^2} + V(r)\\,u(r) = E\\,u(r),\n$$\nwith boundary conditions $u(0)=0$ and $u(r)\\to 0$ as $r\\to \\infty$. Here, $\\mu$ is the reduced mass of the proton–neutron system, and $E$ is the binding energy (negative for a bound state). Work in units where lengths are in femtometers and energies are in mega-electronvolts. The reduced mass $\\mu$ is computed from the proton mass $m_p$ and neutron mass $m_n$ via $\\mu = \\frac{m_p m_n}{m_p + m_n}$.\n\nAssume the nuclear interaction is given by a One-Pion Exchange (OPE) central Yukawa potential plus a regulated contact interaction, consistent with low-energy chiral effective field theory, defined by\n$$\nV(r) = V_{\\text{Y}}(r) + V_{\\text{C}}(r),\n$$\nwhere the central Yukawa potential is\n$$\nV_{\\text{Y}}(r) = -C_Y \\frac{e^{-m_\\pi r}}{r},\n$$\nand the regulated contact interaction is\n$$\nV_{\\text{C}}(r) = C_0 \\exp\\left(-\\left(\\frac{r}{R_0}\\right)^2\\right).\n$$\nUse the following constants:\n- $\\hbar c = 197.3269804$ MeV fm,\n- $m_p = 938.2720813$ MeV,\n- $m_n = 939.5654133$ MeV,\n- $m_\\pi = 138.0$ MeV,\n- $C_Y = 40.0$ MeV fm,\n- $C_0 = -300.0$ MeV,\n- $R_0 = 0.6$ fm.\n\nConvert the pion mass $m_\\pi$ to inverse femtometer using $m_\\pi^{(\\text{fm}^{-1})} = \\frac{m_\\pi}{\\hbar c}$ for use in the Yukawa factor. The box size is $L$ fm, and the problem is posed on the interval $r\\in[0,L]$ with Dirichlet boundary conditions $u(0)=0$ and $u(L)=0$ to approximate $u(r\\to\\infty)=0$.\n\nImplement two numerical methods to approximate the ground-state binding energy:\n1. A standard second-order central finite-difference discretization on a uniform grid with $N$ interior points and spacing $\\Delta r = \\frac{L}{N+1}$, yielding a tridiagonal Hamiltonian matrix with\n$$\nH_{jj} = \\frac{\\hbar^2}{\\mu \\Delta r^2} + V(r_j), \\quad H_{j,j\\pm 1} = -\\frac{\\hbar^2}{2\\mu \\Delta r^2},\n$$\nfor interior grid points $r_j = j \\Delta r$ with $j = 1,2,\\dots,N$, and $V(r_j)$ evaluated at those points.\n2. A spectral Galerkin method using the Fourier sine basis (pseudospectral collocation) on $[0,L]$ with $N$ basis functions $\\{\\phi_n(r)\\}_{n=1}^N$, where\n$$\n\\phi_n(r) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi r}{L}\\right).\n$$\nThe kinetic-energy operator is diagonal in this basis with eigenvalues\n$$\nT_n = \\frac{\\hbar^2}{2\\mu}\\left(\\frac{n\\pi}{L}\\right)^2.\n$$\nApproximate the potential matrix elements by uniform quadrature on the same $N$ interior points $r_j = j \\Delta r$, using\n$$\nV_{nm} \\approx \\Delta r \\sum_{j=1}^N \\phi_n(r_j)\\,V(r_j)\\,\\phi_m(r_j),\n$$\nto form a dense Hamiltonian matrix $H_{nm} = T_n \\delta_{nm} + V_{nm}$.\n\nFor both methods, compute the smallest eigenvalue of the respective Hamiltonian and interpret it as the ground-state energy $E$, in mega-electronvolts. Define a high-accuracy reference solution $E_{\\text{ref}}$ by the spectral Galerkin method with a large basis size on the same box size $L$.\n\nYour program must:\n- Use the constants above and compute the reduced mass $\\mu$ from $m_p$ and $m_n$.\n- Implement both numerical methods described.\n- Compute a reference ground-state energy $E_{\\text{ref}}$ using the spectral method with $N_{\\text{ref}} = 512$ and the box size $L = 20.0$ fm.\n- Evaluate the absolute error $|E - E_{\\text{ref}}|$ for the following test suite:\n    - Case $1$: $L = 20.0$ fm, $N = 64$,\n    - Case $2$: $L = 20.0$ fm, $N = 128$,\n    - Case $3$: $L = 20.0$ fm, $N = 256$.\nFor each case, compute the absolute error for both the finite-difference and spectral methods.\n\nExpress all energies and errors in mega-electronvolts, and round the reported errors to six decimal places. Angles do not appear in this problem. Your program should produce a single line of output containing the six results in a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\;|E_{\\text{FD}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(256)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(256)} - E_{\\text{ref}}|\\;],\n$$\nwhere $E_{\\text{FD}}^{(N)}$ and $E_{\\text{SP}}^{(N)}$ denote the ground-state energies obtained by the finite-difference and spectral methods using $N$ interior points or basis functions, respectively, on the box $[0,L]$. The final output must be in the exact format \"[result1,result2,result3,result4,result5,result6]\".", "solution": "The starting point is the nonrelativistic radial Schrödinger equation for the $S$-wave deuteron, which reads\n$$\n-\\frac{\\hbar^2}{2\\mu}\\frac{d^2 u(r)}{dr^2} + V(r)\\,u(r) = E\\,u(r),\n$$\nwith boundary conditions $u(0)=0$ and $u(r\\to\\infty)=0$, and $l=0$ so that there is no centrifugal term. The reduced mass $\\mu$ of the proton–neutron system is computed from the proton mass $m_p$ and neutron mass $m_n$ by\n$$\n\\mu = \\frac{m_p m_n}{m_p + m_n}.\n$$\nWe work on a finite interval $[0,L]$ and enforce Dirichlet boundary conditions $u(0)=0$ and $u(L)=0$ to approximate the bound-state condition.\n\nThe nuclear potential is modeled as a sum of a One-Pion Exchange (OPE) central Yukawa term and a regulated contact interaction. The OPE central Yukawa term is\n$$\nV_{\\text{Y}}(r) = -C_Y \\frac{e^{-m_\\pi r}}{r},\n$$\nwhere $m_\\pi$ is the pion mass in inverse femtometers. To use $m_\\pi$ given in mega-electronvolts, we convert via\n$$\nm_\\pi^{(\\text{fm}^{-1})} = \\frac{m_\\pi^{(\\text{MeV})}}{\\hbar c},\n$$\nwith $\\hbar c$ in mega-electronvolt femtometers. The regulated contact interaction mimics short-range physics and is chosen as a Gaussian regulator:\n$$\nV_{\\text{C}}(r) = C_0 \\exp\\left(-\\left(\\frac{r}{R_0}\\right)^2\\right).\n$$\nHence, the total potential is\n$$\nV(r) = -C_Y \\frac{e^{-m_\\pi r}}{r} + C_0 \\exp\\left(-\\left(\\frac{r}{R_0}\\right)^2\\right).\n$$\n\nTo compute the bound-state energy numerically, we discretize the problem and solve the corresponding matrix eigenvalue problem. Two methods are employed:\n\n1. Finite-Difference Method (FDM):\nWe define a uniform grid with $N$ interior points and spacing\n$$\n\\Delta r = \\frac{L}{N+1},\n$$\nwith grid points $r_j = j \\Delta r$ for $j=1,2,\\dots,N$. The second derivative is approximated using the standard central finite difference:\n$$\n\\frac{d^2 u}{dr^2}\\bigg|_{r_j} \\approx \\frac{u_{j+1} - 2 u_j + u_{j-1}}{\\Delta r^2}.\n$$\nThe kinetic operator $-\\frac{\\hbar^2}{2\\mu}\\frac{d^2}{dr^2}$ then leads to a tridiagonal matrix with elements\n$$\nH_{jj} = \\frac{\\hbar^2}{\\mu \\Delta r^2} + V(r_j), \\quad H_{j,j\\pm 1} = -\\frac{\\hbar^2}{2\\mu \\Delta r^2}.\n$$\nThis $N\\times N$ tridiagonal Hamiltonian captures the Dirichlet boundary conditions implicitly via the absence of points at $r=0$ and $r=L$. The smallest eigenvalue of this matrix approximates the ground-state energy $E$.\n\n2. Spectral Galerkin Method with Fourier Sine Basis:\nWe use the orthonormal basis functions on $[0,L]$,\n$$\n\\phi_n(r) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi r}{L}\\right), \\quad n=1,2,\\dots,N.\n$$\nThese basis functions satisfy the Dirichlet boundary conditions $\\phi_n(0)=\\phi_n(L)=0$. The kinetic energy operator is diagonal in this basis with eigenvalues\n$$\nT_n = \\frac{\\hbar^2}{2\\mu}\\left(\\frac{n\\pi}{L}\\right)^2.\n$$\nThe potential matrix elements are given by the integral\n$$\nV_{nm} = \\int_0^L \\phi_n(r)\\,V(r)\\,\\phi_m(r)\\,dr.\n$$\nWe approximate this integral by uniform quadrature (Riemann sum) over the same $N$ interior points $r_j = j \\Delta r$:\n$$\nV_{nm} \\approx \\Delta r \\sum_{j=1}^N \\phi_n(r_j)\\,V(r_j)\\,\\phi_m(r_j).\n$$\nThe resulting Hamiltonian matrix in this basis is\n$$\nH_{nm} = T_n \\delta_{nm} + V_{nm}.\n$$\nWe then compute the smallest eigenvalue of this dense symmetric matrix to approximate the ground-state energy $E$.\n\nReference Solution:\nTo gauge accuracy, we compute a high-accuracy reference ground-state energy $E_{\\text{ref}}$ using the spectral Galerkin method with $N_{\\text{ref}}=512$ basis functions on the box of size $L=20.0$ femtometer. This provides a benchmark against which we can compute absolute errors for other discretizations:\n$$\n\\text{error} = |E - E_{\\text{ref}}|.\n$$\n\nAlgorithmic Steps:\n- Compute constants: $\\hbar c$, $m_p$, $m_n$, and the reduced mass $\\mu = \\frac{m_p m_n}{m_p + m_n}$.\n- Convert $m_\\pi$ from mega-electronvolts to inverse femtometers via $m_\\pi^{(\\text{fm}^{-1})} = \\frac{m_\\pi}{\\hbar c}$.\n- Implement a function to evaluate $V(r)$ at any $r>0$ using the given $C_Y$, $C_0$, and $R_0$.\n- Implement the FDM Hamiltonian construction for given $N$ and $L$, and compute its smallest eigenvalue using a tridiagonal eigensolver.\n- Implement the spectral Galerkin Hamiltonian using the sine basis for given $N$ and $L$, assembling the diagonal kinetic energy and quadrature-based potential matrix, and compute its smallest eigenvalue using a dense symmetric eigensolver.\n- Compute $E_{\\text{ref}}$ using the spectral method with $N_{\\text{ref}}=512$ and $L=20.0$.\n- For the test suite cases $(N,L) = (64,20.0)$, $(128,20.0)$, and $(256,20.0)$, compute the finite-difference and spectral ground-state energies and their absolute errors relative to $E_{\\text{ref}}$.\n- Round each error to six decimal places and print them in the specified single-line list format.\n\nScientific Rationale:\nThe Schrödinger equation is the fundamental law governing the bound-state wave function of the deuteron in the nonrelativistic regime. The OPE central Yukawa potential emerges as the leading long-range component of the nuclear force in chiral effective field theory, while short-range physics is captured by regulated contact interactions. The finite-difference method discretizes the Laplacian operator on a uniform grid, providing a simple and systematic approximation. The spectral Galerkin method exploits known eigenfunctions of the kinetic operator that satisfy the boundary conditions, offering rapid convergence for smooth potentials. Comparing both methods against a high-resolution spectral reference quantifies accuracy and convergence behavior as $N$ increases while holding the box size fixed.\n\nUnits:\nAll energies (including $E$ and $E_{\\text{ref}}$) and errors must be expressed in mega-electronvolts and reported as decimal floats. The final output must be the single line\n$$\n[\\;|E_{\\text{FD}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(256)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(256)} - E_{\\text{ref}}|\\;],\n$$\nwith each float rounded to six decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\nfrom numpy.linalg import eigh\n\n# Constants (in MeV and fm units)\nHBAR_C = 197.3269804  # MeV*fm\nM_P = 938.2720813     # MeV\nM_N = 939.5654133     # MeV\n\n# Reduced mass (MeV) in natural units (c=1)\nMU = (M_P * M_N) / (M_P + M_N)\n\n# Potential parameters\nM_PI_MEV = 138.0                 # MeV\nM_PI_FM_INV = M_PI_MEV / HBAR_C  # 1/fm\nC_Y = 40.0                       # MeV*fm for Yukawa\nC0 = -300.0                      # MeV for contact\nR0 = 0.6                         # fm for contact regulator\n\ndef potential(r):\n    \"\"\"\n    Compute the nuclear potential V(r) = Yukawa + Gaussian contact at radial distance r (fm).\n    Returns energy in MeV.\n    \"\"\"\n    # Avoid division by zero; r is never zero on interior points.\n    vy = -C_Y * np.exp(-M_PI_FM_INV * r) / r\n    vc = C0 * np.exp(-(r / R0) ** 2)\n    return vy + vc\n\ndef fd_ground_energy(N, L):\n    \"\"\"\n    Finite-difference method ground-state energy for given N interior points and box size L (fm).\n    Returns the smallest eigenvalue (MeV).\n    \"\"\"\n    dr = L / (N + 1)\n    r = (np.arange(1, N + 1)) * dr\n    V = potential(r)\n\n    # Kinetic prefactor: - (hbar^2 / (2 mu)) d^2/dr^2\n    # For the discrete Hamiltonian, diag and off-diagonal entries as per central difference.\n    kinetic_diag = (HBAR_C ** 2) / (MU * dr * dr)   # MeV\n    kinetic_off = - (HBAR_C ** 2) / (2.0 * MU * dr * dr)  # MeV\n\n    d = kinetic_diag + V                # main diagonal\n    e = np.full(N - 1, kinetic_off)     # off-diagonal entries\n\n    # Compute eigenvalues of tridiagonal symmetric matrix\n    evals = eigh_tridiagonal(d, e, select='i', select_range=(0, 0))[0]\n    return float(evals[0])\n\ndef spectral_ground_energy(N, L):\n    \"\"\"\n    Spectral Galerkin method using Fourier sine basis with N modes on [0, L] (fm).\n    Constructs the Hamiltonian in the sine basis and returns the smallest eigenvalue (MeV).\n    \"\"\"\n    dr = L / (N + 1)\n    r = (np.arange(1, N + 1)) * dr  # interior points\n    V = potential(r)\n\n    # Build the basis function values Phi[j, n] = sqrt(2/L) * sin(n*pi*r_j/L)\n    n_idx = np.arange(1, N + 1)\n    k = (n_idx * np.pi) / L\n    Phi = np.sqrt(2.0 / L) * np.sin(np.outer(r, k))  # shape (N, N)\n\n    # Kinetic energy diagonal in the sine basis: T_n = (hbar^2 / (2 mu)) * k_n^2\n    T_diag = (HBAR_C ** 2) * (k ** 2) / (2.0 * MU)\n\n    # Potential matrix via quadrature: V_nm ≈ dr * sum_j Phi[j,n] * V(r_j) * Phi[j,m]\n    # Compute S = sqrt(dr) * Phi, then V_nm = (S^T * diag(V) * S) for numerical stability\n    # But since dr is scalar, we can do directly:\n    # temp = (V[:, None] * Phi) has shape (N, N)\n    temp = V[:, None] * Phi\n    V_mat = dr * (Phi.T @ temp)  # (N, N)\n\n    # Hamiltonian in the basis\n    H = V_mat + np.diag(T_diag)\n\n    # Dense symmetric eigenvalue problem\n    evals = eigh(H)[0]\n    return float(evals[0])\n\ndef solve():\n    # Box size for all test cases\n    L = 20.0\n\n    # Reference energy using spectral method with high resolution\n    N_ref = 512\n    E_ref = spectral_ground_energy(N_ref, L)\n\n    # Test suite: (N, L) values\n    test_cases = [\n        (64, L),\n        (128, L),\n        (256, L),\n    ]\n\n    results = []\n    for N, L_case in test_cases:\n        E_fd = fd_ground_energy(N, L_case)\n        E_sp = spectral_ground_energy(N, L_case)\n        err_fd = abs(E_fd - E_ref)\n        err_sp = abs(E_sp - E_ref)\n        # Round to six decimal places as required\n        results.append(round(err_fd, 6))\n        results.append(round(err_sp, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3582617"}, {"introduction": "A calculated wavefunction is only useful if it can predict physically measurable quantities. This exercise [@problem_id:3582638] bridges the gap between theory and experiment by tasking you with computing key deuteron observables, such as the electric quadrupole moment and the asymptotic $D/S$ ratio, from a model wavefunction. This practice highlights how the deuteron's non-spherical shape, a direct consequence of the nuclear tensor force, is encoded in its $S$- and $D$-state components.", "problem": "You are tasked with writing a complete, runnable program to compute the asymptotic deuteron $D/S$ ratio and to cross-check the consistency of the quadrupole moment with the deuteron quadrupole form factor at zero momentum transfer. Work in nonrelativistic quantum mechanics for the deuteron, and assume proton charge $e$ and a neutral neutron so that the intrinsic quadrupole operator reduces to the relative coordinate operator with appropriate center-of-mass factors. Use natural units conventions only where explicitly specified below.\n\nStart from the following well-tested bases:\n\n- The deuteron binding energy is $B = 2.224566$ MeV, proton mass is $m_p = 938.2720813$ MeV, neutron mass is $m_n = 939.5654133$ MeV, and the conversion constant is $\\hbar c = 197.3269804$ MeV fm. The deuteron mass is $M_d = m_p + m_n - B$ in MeV. The reduced mass is $\\mu = \\dfrac{m_p m_n}{m_p + m_n}$ in MeV. The bound-state wave number is $\\gamma = \\dfrac{\\sqrt{2 \\mu B}}{\\hbar c}$ in fm$^{-1}$.\n- The deuteron quadrupole moment in the nonrelativistic impulse approximation (neglecting meson-exchange currents and relativistic corrections) can be computed from the $S$- and $D$-state reduced radial wavefunctions $u(r)$ and $w(r)$, normalized to $\\int_0^\\infty \\left[u(r)^2 + w(r)^2\\right]\\,dr = 1$, by the integral\n  $$Q_d = \\int_0^\\infty dr\\, r^2\\, \\frac{\\sqrt{8}\\,u(r)\\,w(r) - w(r)^2}{20},$$\n  which returns the value of $Q_d$ in fm$^2$ when $r$ is in fm and $u,w$ have the usual deuteron normalization. Express $Q_d$ in fm$^2$.\n- The deuteron quadrupole form factor at zero momentum transfer is related to the quadrupole moment by\n  $$G_Q(0) = \\frac{M_d^2}{(\\hbar c)^2}\\, Q_d,$$\n  where $M_d$ is in MeV, $\\hbar c$ in MeV fm, and $Q_d$ in fm$^2$, yielding $G_Q(0)$ dimensionless. The same relation defines the experimental target $G_Q^{\\text{exp}}(0)$ from the measured quadrupole moment $Q_d^{\\text{exp}}$.\n- At large $r$, the deuteron $S$- and $D$-wave components behave as $u(r) \\propto e^{-\\gamma r}$ and $w(r) \\propto \\left(1 + \\dfrac{3}{\\gamma r} + \\dfrac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}$. The asymptotic $D/S$ ratio is $\\eta = \\lim_{r\\to\\infty} \\dfrac{w(r)}{u(r)}$ after dividing $w(r)$ by the known polynomial prefactor $\\left(1 + \\dfrac{3}{\\gamma r} + \\dfrac{3}{(\\gamma r)^2}\\right)$.\n\nRather than solving the coupled-channel Schrödinger equation, approximate the deuteron reduced radial wavefunctions by a physically regularized ansatz that reproduces the correct asymptotic tail and near-origin behavior:\n- For a given short-distance regulator scale $\\beta$ (in fm$^{-1}$) and a model asymptotic ratio parameter $\\eta_{\\text{model}}$, define for $r > 0$,\n  $$u_{\\text{raw}}(r;\\beta,\\eta_{\\text{model}}) = \\left(1 - e^{-\\beta r}\\right) e^{-\\gamma r},$$\n  $$w_{\\text{raw}}(r;\\beta,\\eta_{\\text{model}}) = \\eta_{\\text{model}}\\,\\left(1 - e^{-\\beta r}\\right)^{5} \\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}.$$\n- Normalize these functions to obtain $u(r)$ and $w(r)$ such that $\\int_0^\\infty \\left[u(r)^2 + w(r)^2\\right]\\,dr = 1$. This overall normalization does not change the asymptotic ratio.\n\nYour tasks for each test case parameter set $(\\beta, \\eta_{\\text{model}})$ are:\n\n1. Compute and report the asymptotic $D/S$ ratio estimate $\\eta_{\\text{num}}$ by sampling the corrected ratio\n   $$\\frac{w(r)}{u(r)\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)}$$\n   uniformly over $r \\in [15$ fm, $25$ fm], taking the median of the samples to mitigate residual numerical variation, and reporting the result as a float. This is dimensionless.\n2. Compute and report the deuteron quadrupole moment $Q_d$ using the integral above. Use the following numerical prescriptions to ensure well-defined results:\n   - Use a lower cutoff $r_{\\min} = 10^{-5}$ fm to avoid the singular point at $r=0$.\n   - Integrate to $r_{\\max} = 50$ fm with a uniform spacing no larger than $\\Delta r = 5\\times 10^{-3}$ fm, using a composite Simpson rule or an equivalently accurate method.\n   - Report $Q_d$ in fm$^2$ as a float.\n3. Compute and report $G_Q(0)$ from your $Q_d$ via $G_Q(0) = \\dfrac{M_d^2}{(\\hbar c)^2}\\,Q_d$ as a float (dimensionless).\n4. Using the measured quadrupole moment $Q_d^{\\text{exp}} = 0.2859$ fm$^2$, compute $G_Q^{\\text{exp}}(0) = \\dfrac{M_d^2}{(\\hbar c)^2}\\,Q_d^{\\text{exp}}$ and determine whether your computed $G_Q(0)$ is consistent within a relative tolerance of $0.15$ compared to $G_Q^{\\text{exp}}(0)$; that is, check whether\n   $$\\frac{\\left|G_Q(0) - G_Q^{\\text{exp}}(0)\\right|}{G_Q^{\\text{exp}}(0)} \\le 0.15.$$\n   Report this consistency as an integer $1$ (true) or $0$ (false).\n\nPhysical constants to use (do not modify):\n- $B = 2.224566$ MeV,\n- $m_p = 938.2720813$ MeV,\n- $m_n = 939.5654133$ MeV,\n- $\\hbar c = 197.3269804$ MeV fm,\n- $Q_d^{\\text{exp}} = 0.2859$ fm$^2$.\n\nTest suite of parameter sets $(\\beta, \\eta_{\\text{model}})$ to evaluate:\n- Case A (happy path): $(\\beta, \\eta_{\\text{model}}) = (1.20, 0.0256)$ with $\\beta$ in fm$^{-1}$.\n- Case B (low $D$-state edge): $(\\beta, \\eta_{\\text{model}}) = (1.20, 0.0100)$.\n- Case C (high $D$-state edge): $(\\beta, \\eta_{\\text{model}}) = (1.50, 0.0500)$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list in the order A, B, C. Each sub-list must be of the form\n  $$\\left[\\eta_{\\text{num}},\\, Q_d,\\, G_Q(0),\\, \\text{pass}\\right],$$\n  where the first three entries are floats and the last entry is the integer pass flag. For example, an acceptable output line would look like\n  $$\\big[\\,[0.025600,\\,0.286000,\\,25.500000,\\,1],\\,[\\dots],\\,[\\dots]\\,\\big].$$\n- Express $Q_d$ in fm$^2$, and all angle-like quantities (if any) must be in radians. Round all floats to six decimal places in your printed output.", "solution": "The problem requires a computational analysis of a non-relativistic model for the deuteron. The core of the task is to use a specific analytical ansatz for the deuteron's $S$- and $D$-state radial wavefunctions, $u(r)$ and $w(r)$, to compute several physical observables for three different sets of model parameters. These observables are the asymptotic $D/S$ state ratio ($\\eta$), the electric quadrupole moment ($Q_d$), and the quadrupole form factor at zero momentum transfer ($G_Q(0)$). The computed quadrupole moment is then compared against the experimental value for consistency.\n\nThe solution proceeds by first establishing the necessary physical constants and derived parameters. Then, for each parameter set, a sequence of numerical calculations is performed: wavefunction normalization, computation of the asymptotic ratio, and numerical integration to find the quadrupole moment. Finally, the consistency with experimental data is evaluated.\n\nFirst, we define the given physical constants:\n- Deuteron binding energy: $B = 2.224566\\,\\mathrm{MeV}$\n- Proton mass: $m_p = 938.2720813\\,\\mathrm{MeV}$\n- Neutron mass: $m_n = 939.5654133\\,\\mathrm{MeV}$\n- Conversion constant: $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$\n- Experimental deuteron quadrupole moment: $Q_d^{\\text{exp}} = 0.2859\\,\\mathrm{fm}^2$\n\nFrom these, we derive other essential parameters that are constant across all test cases:\n- The deuteron mass $M_d = m_p + m_n - B \\approx 1875.612929\\,\\mathrm{MeV}$.\n- The reduced mass of the proton-neutron system $\\mu = \\dfrac{m_p m_n}{m_p + m_n} \\approx 469.458995\\,\\mathrm{MeV}$.\n- The bound-state wave number (or inverse decay length) $\\gamma = \\dfrac{\\sqrt{2 \\mu B}}{\\hbar c} \\approx 0.231647\\,\\mathrm{fm}^{-1}$. This parameter governs the exponential decay of the wavefunctions at large distances, a universal feature of a bound state in a short-range potential.\n\nThe methodology for each test case, parameterized by a short-distance regulator scale $\\beta$ and a model asymptotic ratio $\\eta_{\\text{model}}$, is as follows:\n\n1.  **Wavefunction Ansatz and Normalization**:\n    The problem provides a physically-motivated, regularized ansatz for the unnormalized radial wavefunctions, $u_{\\text{raw}}(r)$ and $w_{\\text{raw}}(r)$:\n    $$u_{\\text{raw}}(r) = \\left(1 - e^{-\\beta r}\\right) e^{-\\gamma r}$$\n    $$w_{\\textraw}(r) = \\eta_{\\text{model}}\\,\\left(1 - e^{-\\beta r}\\right)^{5} \\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}$$\n    These functions are constructed to have the correct behavior at large $r$ (asymptotic solution of the Schrödinger equation) and to be regular at the origin ($r=0$), where they vanish. The factors of $(1 - e^{-\\beta r})$ model the effects of the nuclear potential at short distances.\n    For these wavefunctions to represent a quantum state, they must be normalized such that the total probability of finding the deuteron in any configuration is unity:\n    $$\\int_0^\\infty \\left[u(r)^2 + w(r)^2\\right]\\,dr = 1$$\n    This is achieved by computing a normalization constant $N$ from the raw functions:\n    $$N = \\left( \\int_0^\\infty \\left[u_{\\text{raw}}(r)^2 + w_{\\text{raw}}(r)^2\\right]\\,dr \\right)^{-1/2}$$\n    The normalized wavefunctions are then $u(r) = N \\cdot u_{\\text{raw}}(r)$ and $w(r) = N \\cdot w_{\\text{raw}}(r)$. The integral for $N$ is computed numerically using a composite Simpson's rule over a sufficiently large radial grid, from $r_{\\min} = 10^{-5}\\,\\mathrm{fm}$ to $r_{\\max} = 50\\,\\mathrm{fm}$, with a step size $\\Delta r \\approx 5 \\times 10^{-3}\\,\\mathrm{fm}$. This range is adequate as the wavefunctions decay exponentially, making contributions beyond $r_{\\max}$ negligible.\n\n2.  **Asymptotic D/S Ratio ($\\eta_{\\text{num}}$)**:\n    The asymptotic $D/S$ ratio, $\\eta$, is defined by the large-$r$ behavior of the wavefunctions. The problem specifies a numerical estimation, $\\eta_{\\text{num}}$, by sampling the ratio $\\frac{w(r)}{u(r)\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)}$ for $r \\in [15, 25]\\,\\mathrm{fm}$. Since the normalization constant $N$ cancels in this ratio, we can use the raw functions. Substituting the ansatz expressions, the ratio simplifies analytically:\n    $$ \\frac{w_{\\text{raw}}(r)}{u_{\\text{raw}}(r)\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)} = \\frac{\\eta_{\\text{model}}\\,\\left(1 - e^{-\\beta r}\\right)^{5} \\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}}{\\left(1 - e^{-\\beta r}\\right) e^{-\\gamma r}\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)} = \\eta_{\\text{model}}\\left(1 - e^{-\\beta r}\\right)^4 $$\n    This simplified expression is evaluated on a uniform grid of points in the interval $[15, 25]\\,\\mathrm{fm}$, and the median of these values is taken as the result for $\\eta_{\\text{num}}$. For the specified range of $r$, the term $e^{-\\beta r}$ is exceedingly small, so we expect $\\eta_{\\text{num}}$ to be very close to $\\eta_{\\text{model}}$.\n\n3.  **Deuteron Quadrupole Moment ($Q_d$)**:\n    The electric quadrupole moment $Q_d$ is a measure of the deviation of the deuteron's charge distribution from spherical symmetry. It is computed via the integral:\n    $$Q_d = \\int_0^\\infty dr\\, r^2\\, \\frac{\\sqrt{8}\\,u(r)\\,w(r) - w(r)^2}{20}$$\n    This integral is evaluated numerically using the normalized wavefunctions, $u(r)$ and $w(r)$, over the same grid and with the same Simpson's rule integration method used for normalization. The result is in units of $\\mathrm{fm}^2$. The integrand is well-behaved, vanishing polynomially as $r\\to 0$.\n\n4.  **Quadrupole Form Factor ($G_Q(0)$)**:\n    The quadrupole form factor at zero momentum transfer, $G_Q(0)$, is a dimensionless quantity related to $Q_d$ by the conventional scaling:\n    $$G_Q(0) = \\frac{M_d^2}{(\\hbar c)^2}\\, Q_d$$\n    This is a direct calculation using the computed value of $Q_d$ and the previously determined constants.\n\n5.  **Consistency Check**:\n    To assess the physical reasonableness of the model, the computed $G_Q(0)$ is compared to the value derived from the experimental quadrupole moment, $G_Q^{\\text{exp}}(0) = \\frac{M_d^2}{(\\hbar c)^2}\\, Q_d^{\\text{exp}}$. The model is deemed consistent if the relative deviation is within a specified tolerance of $15\\%$:\n    $$\\frac{\\left|G_Q(0) - G_Q^{\\text{exp}}(0)\\right|}{G_Q^{\\text{exp}}(0)} \\le 0.15$$\n    The result of this check is reported as an integer, $1$ for true (consistent) and $0$ for false (inconsistent).\n\nThe implementation will be a Python script utilizing the `numpy` library for array operations and `scipy.integrate.simpson` for numerical integration, adhering to the specified numerical parameters. A function will encapsulate the logic for a single test case, and a main routine will iterate through the provided parameter sets, collect the results, and format them into the required output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Computes deuteron properties for given model parameters and checks\n    consistency with experimental data.\n    \"\"\"\n    # Physical constants\n    B = 2.224566  # MeV\n    m_p = 938.2720813  # MeV\n    m_n = 939.5654133  # MeV\n    hbar_c = 197.3269804  # MeV*fm\n    Qd_exp = 0.2859  # fm^2\n\n    # Derived constants\n    mu = (m_p * m_n) / (m_p + m_n)  # Reduced mass in MeV\n    M_d = m_p + m_n - B  # Deuteron mass in MeV\n    gamma = np.sqrt(2 * mu * B) / hbar_c  # Bound-state wave number in fm^-1\n\n    # Define test cases\n    test_cases = [\n        (1.20, 0.0256),  # Case A\n        (1.20, 0.0100),  # Case B\n        (1.50, 0.0500),  # Case C\n    ]\n\n    # Pre-calculate experimental G_Q(0)\n    GQ0_exp = (M_d**2 / hbar_c**2) * Qd_exp\n    \n    results = []\n    \n    # Numerical integration parameters\n    r_min = 1e-5\n    r_max = 50.0\n    num_points = 10001\n    r_grid = np.linspace(r_min, r_max, num_points)\n\n    for beta, eta_model in test_cases:\n        # --- TASK 1: Compute asymptotic D/S ratio eta_num ---\n        # The ratio simplifies to eta_model * (1 - exp(-beta*r))^4.\n        # Sample this expression and take the median.\n        r_sample = np.linspace(15.0, 25.0, 1001)\n        eta_samples = eta_model * (1 - np.exp(-beta * r_sample))**4\n        eta_num = np.median(eta_samples)\n\n        # --- Normalization and Wavefunction setup ---\n        # Define the polynomial prefactor for the D-wave\n        # Avoid division by zero at r=0, although r_grid starts at r_min > 0.\n        P_r = 1 + 3 / (gamma * r_grid) + 3 / (gamma**2 * r_grid**2)\n        \n        # Define unnormalized (raw) wavefunctions\n        exp_gamma_r = np.exp(-gamma * r_grid)\n        regulator_u = 1 - np.exp(-beta * r_grid)\n        regulator_w = regulator_u**5\n\n        u_raw = regulator_u * exp_gamma_r\n        w_raw = eta_model * regulator_w * P_r * exp_gamma_r\n\n        # Calculate normalization constant N\n        # N = (integral[u_raw^2 + w_raw^2] dr)^(-1/2)\n        norm_integrand = u_raw**2 + w_raw**2\n        norm_integral = simpson(norm_integrand, r_grid)\n        N = 1.0 / np.sqrt(norm_integral)\n\n        # Normalized wavefunctions\n        u = N * u_raw\n        w = N * w_raw\n\n        # --- TASK 2: Compute deuteron quadrupole moment Qd ---\n        # Qd = integral[ r^2 * (sqrt(8)*u*w - w^2) / 20 ] dr\n        Qd_integrand = r_grid**2 * (np.sqrt(8) * u * w - w**2) / 20.0\n        Qd = simpson(Qd_integrand, r_grid)\n\n        # --- TASK 3: Compute G_Q(0) ---\n        GQ0 = (M_d**2 / hbar_c**2) * Qd\n\n        # --- TASK 4: Consistency check ---\n        relative_error = np.abs(GQ0 - GQ0_exp) / GQ0_exp\n        pass_flag = 1 if relative_error <= 0.15 else 0\n\n        # Append results for this case\n        results.append(f\"[{eta_num:.6f},{Qd:.6f},{GQ0:.6f},{pass_flag:d}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3582638"}, {"introduction": "State-of-the-art nuclear theory calculations are often performed within a finite computational volume, introducing systematic effects that must be understood and corrected. This practice [@problem_id:3582632] delves into this critical aspect by having you compute the deuteron's binding energy in a periodic cubic box. By analyzing the energy shift as a function of box size, you will verify the famous exponential scaling of finite-volume corrections and numerically extract the deuteron's binding momentum, a cornerstone result of modern lattice calculations.", "problem": "Consider a two-nucleon bound state (the deuteron) in nonrelativistic quantum mechanics described by the time-independent Schrödinger equation for the relative coordinate with reduced mass $\\mu$. Work in three spatial dimensions. Use the Lippmann–Schwinger equation in momentum space for the bound state and adopt a rank-one separable Yamaguchi interaction with form factor $g(\\mathbf{q})$ and coupling strength $\\lambda$ given by\n$V(\\mathbf{k},\\mathbf{k}') = -\\lambda\\, g(\\mathbf{k})\\, g(\\mathbf{k}'), \\quad g(\\mathbf{q}) = \\dfrac{1}{\\mathbf{q}^2 + \\beta^2},$\nwhere $\\beta$ is a fixed positive parameter expressed in inverse femtometers. Let $\\hbar$ denote the reduced Planck constant and $c$ the speed of light. Use the following physical constants and parameters:\n- $\\hbar c = 197.3269804$ MeV fm,\n- proton mass $m_p = 938.2720813$ MeV/c$^2$,\n- neutron mass $m_n = 939.5654133$ MeV/c$^2$,\n- reduced mass $\\mu = \\dfrac{m_p m_n}{m_p + m_n}$,\n- Yamaguchi range parameter $\\beta = 1.4$ fm$^{-1}$,\n- target infinite-volume deuteron binding energy $B_d^{(\\infty)} = 2.224575$ MeV.\n\nIn infinite volume, the bound-state condition follows from the homogeneous Lippmann–Schwinger equation for the $T$-matrix and reduces, for the chosen separable interaction, to the pole condition\n$1 + \\lambda\\, J_{\\infty}(E) = 0,$\nwhere $E$ is the total energy in the center-of-mass frame (negative for a bound state) and\n$J_{\\infty}(E) = \\int \\dfrac{d^3 q}{(2\\pi)^3}\\, \\dfrac{g(\\mathbf{q})^2}{E - \\dfrac{(\\hbar c)^2 \\mathbf{q}^2}{2\\mu}}\\ .$\nIn finite volume with periodic boundary conditions in a cubic box of side $L$, the integral is replaced by a discrete sum over momenta $\\mathbf{q} = \\dfrac{2\\pi}{L}\\, \\mathbf{n}$ where $\\mathbf{n} \\in \\mathbb{Z}^3$, namely\n$J_{L}(E) = \\dfrac{1}{L^3} \\sum_{\\mathbf{n}\\in\\mathbb{Z}^3} \\dfrac{g\\!\\left(\\dfrac{2\\pi}{L}\\mathbf{n}\\right)^2}{E - \\dfrac{(\\hbar c)^2}{2\\mu}\\left(\\dfrac{2\\pi}{L}\\right)^2 \\|\\mathbf{n}\\|^2}\\ .$\nThe infinite-volume coupling $\\lambda$ must be chosen to reproduce the target binding energy $B_d^{(\\infty)}$ via the condition $1 + \\lambda\\, J_{\\infty}(-B_d^{(\\infty)}) = 0$. Then, for each finite $L$, the finite-volume binding energy $B_d(L)$ is defined by the unique negative-energy solution $E=-B_d(L)$ of $1 + \\lambda\\, J_L(E)=0$.\n\nAs $L \\to \\infty$, the finite-volume shift $\\Delta B_d(L) = B_d(L) - B_d^{(\\infty)}$ is expected to be exponentially small and controlled by the infinite-volume binding momentum $\\kappa = \\sqrt{\\dfrac{2\\mu B_d^{(\\infty)}}{(\\hbar c)^2}}$, with an asymptotic form $\\Delta B_d(L) \\propto \\dfrac{e^{-\\kappa L}}{L}$ up to subleading corrections. Your task is to implement a program that numerically:\n- calibrates $\\lambda$ from the infinite-volume condition at $E=-B_d^{(\\infty)}$ using the above $J_{\\infty}(E)$,\n- computes $B_d(L)$ for several $L$ values by solving $1 + \\lambda\\, J_L(E)=0$ with $E<0$,\n- estimates the finite-volume shifts $\\Delta B_d(L)$ and verifies the exponential-over-$L$ scaling by fitting $\\ln\\!\\big(\\Delta B_d(L)\\, L\\big)$ versus $L$ to a straight line and extracting a numerical estimate of the slope $-\\,\\kappa_{\\text{fit}}$,\n- compares $\\kappa_{\\text{fit}}$ to the $\\kappa$ computed directly from $B_d^{(\\infty)}$ and $\\mu$.\n\nUse the following computational details to ensure a well-posed and self-contained calculation:\n- Use the discrete sum definition of $J_L(E)$ with a spherical momentum cutoff $\\Lambda$ in inverse femtometers applied to $\\|\\mathbf{q}\\| \\le \\Lambda$. Choose $\\Lambda = 6.0$ fm$^{-1}$. Truncate the sum to all integer triplets $\\mathbf{n}$ such that $\\left\\|\\dfrac{2\\pi}{L}\\mathbf{n}\\right\\| \\le \\Lambda$; this ensures a finite and systematically improvable approximation to $J_L(E)$. No further extrapolation in $\\Lambda$ is required.\n- For $J_{\\infty}(E)$, perform the three-dimensional integral in spherical coordinates, i.e., $J_{\\infty}(E) = \\dfrac{1}{2\\pi^2}\\int_{0}^{\\infty} dq\\, \\dfrac{q^2}{E - \\dfrac{(\\hbar c)^2 q^2}{2\\mu}}\\dfrac{1}{(q^2+\\beta^2)^2}$, using a reliable numerical quadrature over $q \\in [0,\\infty)$ with sufficient accuracy to determine $\\lambda$.\n- Solve for $E=-B_d(L)$ at fixed $L$ by robust one-dimensional root finding in the negative-energy domain, using a bracket that safely encloses the root.\n\nAdopt the following test suite of box sizes (in femtometers):\n- Set $\\mathcal{A}$: $L \\in \\{12.0, 14.0, 16.0\\}$,\n- Set $\\mathcal{B}$: $L \\in \\{8.0, 10.0, 12.0\\}$,\n- Set $\\mathcal{C}$: $L \\in \\{6.0, 7.0, 8.0\\}$.\n\nFor each set, compute $\\Delta B_d(L)$ at the listed $L$ values, perform a linear least-squares fit of $y(L) = \\ln\\!\\big(\\Delta B_d(L)\\, L\\big)$ versus $L$, and extract $\\kappa_{\\text{fit}}$ as the negative of the fitted slope. Also compute the reference $\\kappa$ from the reduced mass and $B_d^{(\\infty)}$ via $\\kappa = \\sqrt{\\dfrac{2\\mu B_d^{(\\infty)}}{(\\hbar c)^2}}$. All values of $\\kappa$ must be reported in inverse femtometers.\n\nPhysical and numerical units:\n- Energies must be computed and handled in MeV.\n- Lengths and momentum-space cutoffs must be handled in fm and fm$^{-1}$, respectively.\n- The final outputs must be expressed in fm$^{-1}$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The required output is the list\n$[\\kappa,\\ \\kappa_{\\text{fit}}(\\mathcal{A}),\\ \\kappa_{\\text{fit}}(\\mathcal{B}),\\ \\kappa_{\\text{fit}}(\\mathcal{C})]$,\nin that order. Each entry must be a floating-point number in fm$^{-1}$. The program must not read any input and must use the constants and parameters specified above. You may format the floating-point results with a fixed number of decimal places, but you must ensure they are valid decimal numerals. No other text should be printed.", "solution": "The user wants to solve a computational nuclear physics problem about the deuteron bound state in finite volume.\n\n### Problem Validation\n\n1.  **Givens Extraction**:\n    *   **System**: Deuteron (two-nucleon bound state) in non-relativistic quantum mechanics.\n    *   **Interaction**: Rank-one separable Yamaguchi potential, $V(\\mathbf{k},\\mathbf{k}') = -\\lambda\\, g(\\mathbf{k})\\, g(\\mathbf{k}')$, with form factor $g(\\mathbf{q}) = 1/(\\mathbf{q}^2 + \\beta^2)$.\n    *   **Physical Constants**: $\\hbar c = 197.3269804\\ \\text{MeV}\\cdot\\text{fm}$, $m_p = 938.2720813\\ \\text{MeV}/c^2$, $m_n = 939.5654133\\ \\text{MeV}/c^2$.\n    *   **Model Parameters**: Yamaguchi range $\\beta = 1.4\\ \\text{fm}^{-1}$, deuteron binding energy in infinite volume $B_d^{(\\infty)} = 2.224575\\ \\text{MeV}$.\n    *   **Derived Quantities**: Reduced mass $\\mu = (m_p m_n)/(m_p + m_n)$, binding momentum $\\kappa = \\sqrt{2\\mu B_d^{(\\infty)}/(\\hbar c)^2}$.\n    *   **Core Equations**: The bound-state conditions are $1 + \\lambda\\, J_{\\infty}(E) = 0$ for infinite volume and $1 + \\lambda\\, J_L(E) = 0$ for a cubic box of side $L$.\n    *   **Kernel Functions**:\n        *   $J_{\\infty}(E) = \\int \\frac{d^3 q}{(2\\pi)^3}\\, \\frac{g(\\mathbf{q})^2}{E - \\frac{(\\hbar c)^2 \\mathbf{q}^2}{2\\mu}} = \\frac{1}{2\\pi^2}\\int_{0}^{\\infty} dq\\, \\frac{q^2}{(q^2+\\beta^2)^2}\\frac{1}{E - \\frac{(\\hbar c)^2 q^2}{2\\mu}}$.\n        *   $J_{L}(E) = \\frac{1}{L^3} \\sum_{\\mathbf{n}\\in\\mathbb{Z}^3} \\frac{g((2\\pi/L)\\mathbf{n})^2}{E - \\frac{(\\hbar c)^2}{2\\mu}(\\frac{2\\pi}{L})^2 \\|\\mathbf{n}\\|^2}$.\n    *   **Computational Constraints**: The finite-volume sum is truncated by a spherical momentum cutoff $\\|\\mathbf{q}\\| \\le \\Lambda$ with $\\Lambda = 6.0\\ \\text{fm}^{-1}$.\n    *   **Task**:\n        1.  Calibrate the coupling strength $\\lambda$ using the infinite-volume condition at $E = -B_d^{(\\infty)}$.\n        2.  For given sets of $L$, solve for the finite-volume binding energy $B_d(L) = -E$.\n        3.  Calculate the energy shift $\\Delta B_d(L) = B_d(L) - B_d^{(\\infty)}$.\n        4.  For each set of $L$ values, perform a linear fit of $y(L) = \\ln(\\Delta B_d(L) \\cdot L)$ versus $x(L) = L$ to find the slope $m$.\n        5.  Extract the fitted binding momentum as $\\kappa_{\\text{fit}} = -m$.\n    *   **Test Cases**: Set $\\mathcal{A}: L \\in \\{12, 14, 16\\}$ fm; Set $\\mathcal{B}: L \\in \\{8, 10, 12\\}$ fm; Set $\\mathcal{C}: L \\in \\{6, 7, 8\\}$ fm.\n    *   **Output**: A list containing the theoretical $\\kappa$ and the three fitted values $\\kappa_{\\text{fit}}(\\mathcal{A})$, $\\kappa_{\\text{fit}}(\\mathcal{B})$, and $\\kappa_{\\text{fit}}(\\mathcal{C})$, all in $\\text{fm}^{-1}$.\n\n2.  **Validation Analysis**:\n    *   **Scientific Grounding**: The problem is well-grounded in non-relativistic quantum mechanics and effective field theory. The Lippmann-Schwinger equation, separable potentials, and the study of finite-volume effects are standard topics in theoretical and computational nuclear physics. The equations provided are correct representations within this framework.\n    *   **Well-Posedness**: The problem is mathematically and computationally well-posed. It provides all necessary constants, parameters, and a clear, step-by-step procedure for obtaining a unique numerical result. The task of finding the finite-volume binding energy involves solving a monotonic function for its root, which guarantees a unique solution.\n    *   **Objectivity**: The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n    *   **Consistency Check**: A potential issue arises from the term $\\ln(\\Delta B_d(L) \\cdot L)$, which requires $\\Delta B_d(L) = B_d(L) - B_d^{(\\infty)}$ to be positive. A naive physical intuition might suggest that confinement reduces binding energy, making $\\Delta B_d(L)$ negative. However, a more detailed analysis shows that for this specific (attractive Yamaguchi) potential, the discretization of momentum space in a finite volume leads to $J_L(E) < J_{\\infty}(E)$ for any given energy $E < 0$. Since $J_L(E)$ is a monotonically decreasing function of $E$ for $E < 0$ and the bound state condition is $J(-B) = -1/\\lambda$, it follows that $-B_d(L) < -B_d^{(\\infty)}$, which implies $B_d(L) > B_d^{(\\infty)}$. Thus, $\\Delta B_d(L)$ is indeed positive, and the problem is internally consistent.\n\n3.  **Verdict**: The problem is **valid**.\n\n### Solution Methodology\n\nThe solution will be constructed following a sequence of computational steps derived from the theoretical framework provided.\n\n**1. Constants and Initial Calculations**\nFirst, we define all physical constants and model parameters as specified.\n- $\\hbar c = 197.3269804\\ \\text{MeV}\\cdot\\text{fm}$\n- $m_p = 938.2720813\\ \\text{MeV}/c^2$\n- $m_n = 939.5654133\\ \\text{MeV}/c^2$\n- $B_d^{(\\infty)} = 2.224575\\ \\text{MeV}$\n- $\\beta = 1.4\\ \\text{fm}^{-1}$\n- $\\Lambda = 6.0\\ \\text{fm}^{-1}$\n\nFrom these, we compute the reduced mass $\\mu$ and the theoretical infinite-volume binding momentum $\\kappa$.\n$$ \\mu = \\frac{m_p m_n}{m_p + m_n} $$\n$$ \\kappa = \\sqrt{\\frac{2\\mu B_d^{(\\infty)}}{(\\hbar c)^2}} $$\nThe value of $\\kappa$ serves as the benchmark for our numerical fits.\n\n**2. Calibration of the Coupling Strength $\\lambda$**\nThe coupling $\\lambda$ is fixed by requiring the model to reproduce the experimental deuteron binding energy in infinite volume. This is enforced by the pole condition of the $T$-matrix, $1 + \\lambda\\, J_{\\infty}(-B_d^{(\\infty)}) = 0$. This gives:\n$$ \\lambda = -\\frac{1}{J_{\\infty}(-B_d^{(\\infty)})} $$\nTo calculate this, we must first evaluate the integral $J_{\\infty}(E)$ at $E = -B_d^{(\\infty)}$. The problem provides the expression in spherical coordinates:\n$$ J_{\\infty}(E) = \\frac{1}{2\\pi^2} \\int_0^{\\infty} dq\\, \\frac{q^2}{(q^2+\\beta^2)^2} \\frac{1}{E - \\frac{(\\hbar c)^2 q^2}{2\\mu}} $$\nwhere $q = \\|\\mathbf{q}\\|$. For $E < 0$, the integrand is well-defined and non-singular for all $q \\ge 0$. We will perform this one-dimensional integration using a robust numerical quadrature routine (`scipy.integrate.quad`). Since $E < 0$, the term $E - \\frac{(\\hbar c)^2 q^2}{2\\mu}$ is always negative, making the integral $J_{\\infty}(E)$ negative. Consequently, $\\lambda$ will be positive, corresponding to an attractive potential.\n\n**3. Finite-Volume Binding Energy Calculation**\nIn a cubic volume of side $L$ with periodic boundary conditions, the continuous momentum integral is replaced by a discrete sum over allowed momentum vectors $\\mathbf{q}_{\\mathbf{n}} = \\frac{2\\pi}{L}\\mathbf{n}$ with $\\mathbf{n} \\in \\mathbb{Z}^3$. The kernel $J_L(E)$ is given by:\n$$ J_{L}(E) = \\frac{1}{L^3} \\sum_{\\mathbf{n}\\in\\mathbb{Z}^3, \\, \\|\\mathbf{q}_{\\mathbf{n}}\\| \\le \\Lambda} \\frac{g(\\mathbf{q}_{\\mathbf{n}})^2}{E - \\frac{(\\hbar c)^2}{2\\mu}\\left(\\frac{2\\pi}{L}\\right)^2 \\|\\mathbf{n}\\|^2} $$\nThe sum is truncated by the cutoff condition $\\|\\frac{2\\pi}{L}\\mathbf{n}\\| \\le \\Lambda$, which translates to $\\|\\mathbf{n}\\|^2 \\le (\\frac{L\\Lambda}{2\\pi})^2$. The sum is implemented by iterating over integer vectors $\\mathbf{n}=(n_x, n_y, n_z)$ within this spherical bound.\n\nFor each given box size $L$, the finite-volume binding energy $B_d(L)$ is found by solving the equation $f(E) = 1 + \\lambda J_L(E) = 0$ for the energy $E < 0$. The derivative of the kernel with respect to energy is $\\frac{dJ_L}{dE} = -\\frac{1}{L^3} \\sum_{\\mathbf{n}} \\frac{g(\\mathbf{q}_{\\mathbf{n}})^2}{(E - E_{\\mathbf{n}})^2}$, which is strictly negative for $E < 0$. This ensures that $f(E)$ is a monotonically decreasing function of $E$ in the negative energy domain. As $E \\to 0^-$, the term for $\\mathbf{n}=\\mathbf{0}$ causes $J_L(E) \\to -\\infty$, so $f(E) \\to -\\infty$. As $E \\to -\\infty$, $J_L(E) \\to 0$, so $f(E) \\to 1$. A unique root $E = -B_d(L)$ is therefore guaranteed for $E<0$. We find this root using a numerical solver like `scipy.optimize.brentq`, which requires a bracket where the function changes sign, for instance $[-10, -0.1]$ MeV.\n\n**4. Extraction of $\\kappa_{\\text{fit}}$ via Linear Regression**\nThe leading-order asymptotic behavior of the finite-volume energy shift for large $L$ is expected to be exponential:\n$$ \\Delta B_d(L) = B_d(L) - B_d^{(\\infty)} \\approx C \\frac{e^{-\\kappa L}}{L} $$\nwhere $C$ is a constant. This can be rewritten by taking the natural logarithm:\n$$ \\ln(\\Delta B_d(L) \\cdot L) \\approx \\ln(C) - \\kappa L $$\nThis shows a linear relationship between $y(L) = \\ln(\\Delta B_d(L) \\cdot L)$ and $x(L) = L$, with a slope of $-\\kappa$.\nFor each given set of $L$ values ($\\mathcal{A}$, $\\mathcal{B}$, $\\mathcal{C}$), we first compute the corresponding finite-volume binding energies $B_d(L)$. Then, we construct the data points $(x_i, y_i) = (L_i, \\ln((B_d(L_i) - B_d^{(\\infty)}) \\cdot L_i))$. A linear least-squares fit is performed on these points to find the best-fit line $y = m x + c$. The desired parameter $\\kappa_{\\text{fit}}$ is then given by the negative of the slope:\n$$ \\kappa_{\\text{fit}} = -m $$\nThis procedure is repeated for all three sets of $L$ values. The final result is a list containing the theoretically derived $\\kappa$ and the three numerically fitted values $\\kappa_{\\text{fit}}(\\mathcal{A})$, $\\kappa_{\\text{fit}}(\\mathcal{B})$, and $\\kappa_{\\text{fit}}(\\mathcal{C})$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the deuteron finite-volume binding energy problem as specified.\n    \"\"\"\n    # Physical constants and parameters\n    HBARC = 197.3269804  # MeV * fm\n    M_P = 938.2720813    # MeV/c^2\n    M_N = 939.5654133    # MeV/c^2\n    BETA = 1.4           # fm^-1\n    B_D_INF = 2.224575   # MeV\n    LAMBDA_CUTOFF = 6.0  # fm^-1\n\n    # Derived constants\n    MU = (M_P * M_N) / (M_P + M_N)\n    TWO_MU_OVER_HBARC_SQ = (2.0 * MU) / (HBARC**2) # fm^-2 / MeV\n\n    # --- Step 1: Calculate theoretical kappa ---\n    kappa_theory = np.sqrt(TWO_MU_OVER_HBARC_SQ * B_D_INF)\n    \n    # --- Step 2: Calibrate lambda from infinite-volume condition ---\n    \n    def integrand_J_infty(q, E):\n        \"\"\"Integrand for the J_infty integral.\"\"\"\n        # Using the formulation J = 1/(2pi^2) * int(...) dq\n        # The equation for J_infty in the problem is per d^3q/(2pi)^3\n        # J_inf = 1/(2pi^2) integral_0^inf dq q^2 * g(q)^2 / (E-T(q))\n        # This matches the provided spherical coordinate version.\n        g_q_sq = (1.0 / (q**2 + BETA**2))**2\n        T_q = q**2 / TWO_MU_OVER_HBARC_SQ\n        return (1.0 / (2.0 * np.pi**2)) * q**2 * g_q_sq / (E - T_q)\n\n    # Calculate J_infty at E = -B_d_inf\n    val_J_infty, _ = quad(integrand_J_infty, 0, np.inf, args=(-B_D_INF,), epsabs=1e-12, epsrel=1e-12)\n    \n    # Calculate lambda\n    lambda_coupling = -1.0 / val_J_infty\n\n    # --- Step 3: Functions for finite-volume calculation ---\n\n    # Store J_L results to avoid re-computation\n    j_l_cache = {}\n\n    def calc_J_L(E, L):\n        \"\"\"Calculates the finite-volume sum J_L(E).\"\"\"\n        if (E, L) in j_l_cache:\n            return j_l_cache[(E, L)]\n\n        n_sq_max_val = (L * LAMBDA_CUTOFF / (2.0 * np.pi))**2\n        n_max = int(np.floor(np.sqrt(n_sq_max_val)))\n        \n        total_sum = 0.0\n        \n        # Precompute constants for the loop\n        q_sq_factor = (2.0 * np.pi / L)**2\n        E_kin_factor = q_sq_factor / TWO_MU_OVER_HBARC_SQ\n\n        for nx in range(-n_max, n_max + 1):\n            for ny in range(-n_max, n_max + 1):\n                for nz in range(-n_max, n_max + 1):\n                    n_sq = float(nx**2 + ny**2 + nz**2)\n                    \n                    if n_sq > n_sq_max_val:\n                        continue\n                        \n                    q_sq = n_sq * q_sq_factor\n                    g_q_sq = (1.0 / (q_sq + BETA**2))**2\n                    \n                    E_kin = n_sq * E_kin_factor\n                    \n                    denominator = E - E_kin\n                    # The n=0 contribution has a pole at E=0.\n                    # This check is for robustness, though brentq should avoid E=0.\n                    if abs(denominator)  1e-15:\n                        total_sum += np.inf # Should signal issues\n                    else:\n                        total_sum += g_q_sq / denominator\n                        \n        result = total_sum / L**3\n        j_l_cache[(E, L)] = result\n        return result\n\n    def root_function(E, L):\n        \"\"\"Function whose root E gives the finite-volume energy.\"\"\"\n        return 1.0 + lambda_coupling * calc_J_L(E, L)\n\n    # --- Step 4: Calculate B_d(L) and fit for kappa ---\n\n    def calculate_kappa_fit(L_values):\n        \"\"\"\n        Calculates B_d(L) for a list of L values and performs the linear fit\n        to extract kappa_fit.\n        \"\"\"\n        delta_B_vals = []\n        \n        for L in L_values:\n            # Find the root E for B_d(L) = -E\n            # Bracket [-10, -0.1] safely encloses the root away from the E=0 pole.\n            try:\n                E_L = brentq(root_function, -10.0, -0.1, args=(L,), xtol=1e-12, rtol=1e-12)\n            except ValueError:\n                # This would happen if the function doesn't change sign in the bracket\n                print(f\"Error: Root not bracketed for L={L}.\")\n                return np.nan\n            \n            Bd_L = -E_L\n            delta_B = Bd_L - B_D_INF\n            delta_B_vals.append(delta_B)\n\n        y_fit = np.log(np.array(delta_B_vals) * np.array(L_values))\n        x_fit = np.array(L_values)\n        \n        # Perform linear fit: y = m*x + c\n        # np.polyfit returns [m, c]\n        slope, _ = np.polyfit(x_fit, y_fit, 1)\n        \n        kappa_fit = -slope\n        return kappa_fit\n\n    # Define test sets\n    test_sets = {\n        'A': [12.0, 14.0, 16.0],\n        'B': [8.0, 10.0, 12.0],\n        'C': [6.0, 7.0, 8.0]\n    }\n    \n    results = [kappa_theory]\n    for key in ['A', 'B', 'C']:\n        L_vals = test_sets[key]\n        kappa_fit = calculate_kappa_fit(L_vals)\n        results.append(kappa_fit)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda x: f'{x:.8f}', results))}]\")\n\nsolve()\n```", "id": "3582632"}]}