{"hands_on_practices": [{"introduction": "The power of the Lanczos algorithm lies in its ability to transform an enormous eigenvalue problem into a much smaller one involving a tridiagonal matrix, $T_k$. This exercise provides direct practice with this core concept by having you diagonalize a small $T_k$ matrix to find its Ritz values. Crucially, you will then calculate the associated residual norms, which provide a tangible measure of how well these Ritz values approximate the true eigenvalues of the full Hamiltonian [@problem_id:3603131].", "problem": "In large-scale diagonalization of the nuclear shell-model Hamiltonian, one employs the Lanczos algorithm to construct an orthonormal Krylov basis and a projected symmetric tridiagonal matrix. Consider a real, symmetric Hamiltonian $H$ acting on a Hilbert space of dimension $N \\gg 4$, and a Lanczos run initiated from a normalized starting vector $v_{1}$ that produces the $4$-step orthonormal Lanczos basis $Q_{4} = [v_{1}, v_{2}, v_{3}, v_{4}]$ and the associated symmetric tridiagonal matrix $T_{4} \\in \\mathbb{R}^{4 \\times 4}$ with diagonal entries $\\alpha_{i}$ and sub/superdiagonal entries $\\beta_{i}$ as determined by the three-term recurrence. Let the coefficients be specified by\n$$\n\\alpha_{1}=\\alpha_{2}=\\alpha_{3}=\\alpha_{4}=0,\\quad \\beta_{1}=\\beta_{2}=\\beta_{3}=1,\\quad \\beta_{4}=\\frac{1}{100}.\n$$\nThus,\n$$\nT_{4}=\\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}.\n$$\nStarting from the Lanczos three-term recurrence for $H$ and the orthonormality of the Lanczos vectors, derive the residual form for a Ritz pair $(\\lambda,y)$ obtained by diagonalizing $T_{4}$ and embedding $y$ back to the full space via $x=Q_{4}y$. Then, for the given $T_{4}$:\n- Compute the four eigenvalues of $T_{4}$ and the corresponding normalized eigenvectors $y$.\n- Using the derived residual expression, evaluate the four residual norms for the embedded Ritz pairs in terms of the last component $y_{4}$ of each normalized eigenvector and the given $\\beta_{4}=\\frac{1}{100}$.\n\nExpress all eigenvalues and residual norms in exact closed form, not as numerical approximations. Report your final answer as a single row matrix containing the four eigenvalues in ascending order followed by the four corresponding residual norms in the same order. No units are required, and no rounding is permitted.", "solution": "The present problem requires the derivation of the Lanczos residual norm and its evaluation for the Ritz pairs found from a specific $4 \\times 4$ tridiagonal matrix $T_4$.\n\nFirst, we derive the general expression for the residual norm of a Ritz pair. The Lanczos algorithm generates a sequence of orthonormal vectors $v_j$, called Lanczos vectors, via a three-term recurrence relation. This recurrence is defined by applying the Hamiltonian $H$ to each vector $v_j$ and orthogonalizing the result against the previous two vectors. For a real, symmetric Hamiltonian $H$, the recurrence is:\n$$Hv_j = \\beta_{j-1}v_{j-1} + \\alpha_j v_j + \\beta_j v_{j+1}$$\nwhere $v_0=0$, $v_1$ is a chosen normalized starting vector, and the coefficients $\\alpha_j$ and $\\beta_j$ are given by:\n$$\\alpha_j = v_j^T H v_j$$\n$$\\beta_j = \\| H v_j - \\alpha_j v_j - \\beta_{j-1}v_{j-1} \\|$$\nAfter $k$ steps, this process generates an orthonormal basis $Q_k = [v_1, v_2, \\dots, v_k]$ and a real symmetric tridiagonal matrix $T_k$ with diagonal entries $\\alpha_j$ and off-diagonal entries $\\beta_j$. The recurrence relations can be written in matrix form as:\n$$HQ_k = Q_k T_k + r_k e_k^T$$\nwhere $r_k = \\beta_k v_{k+1}$ is the residual vector of the $k$-step Lanczos process, and $e_k$ is the $k$-th standard basis vector in $\\mathbb{R}^k$, i.e., $e_k = (0, \\dots, 0, 1)^T$.\n\nA Ritz pair $(\\lambda, x)$ is an approximation to an eigenpair of $H$. It is obtained by diagonalizing the projected matrix $T_k$:\n$$T_k y = \\lambda y$$\nwhere $y$ is a normalized eigenvector of $T_k$ and $\\lambda$ is the corresponding eigenvalue (the Ritz value). The Ritz vector $x$ is the projection of $y$ back into the full Hilbert space:\n$$x = Q_k y$$\nThe residual for the Ritz pair $(\\lambda, x)$ is defined as $R = Hx - \\lambda x$. We seek its norm $\\|R\\|$. Substituting the expressions for $x$ and $HQ_k$:\n$$R = H(Q_k y) - \\lambda(Q_k y) = (HQ_k)y - Q_k(\\lambda y)$$\n$$R = (Q_k T_k + r_k e_k^T)y - Q_k(T_k y)$$\nUsing $T_k y = \\lambda y$, the second term becomes $Q_k(\\lambda y)$. As matrix multiplication is associative, this is equal to $Q_k T_k y$.\n$$R = Q_k T_k y + r_k e_k^T y - Q_k T_k y = r_k e_k^T y$$\nSubstituting $r_k = \\beta_k v_{k+1}$:\n$$R = (\\beta_k v_{k+1}) (e_k^T y)$$\nThe term $e_k^T y$ is the scalar product of $e_k$ and $y$, which extracts the $k$-th component of the vector $y$, denoted $y_k$.\n$$R = \\beta_k y_k v_{k+1}$$\nThe norm of the residual is then:\n$$\\|R\\| = \\|\\beta_k y_k v_{k+1}\\| = |\\beta_k| |y_k| \\|v_{k+1}\\|$$\nSince the Lanczos vectors are orthonormal, $\\|v_{k+1}\\|=1$. Therefore, the residual norm is given by:\n$$\\|R\\| = |\\beta_k| |y_k|$$\nFor this problem, $k=4$, so the residual norm for a given Ritz pair is $\\|R\\| = |\\beta_4| |y_4|$.\n\nNext, we must find the eigenvalues and eigenvectors of the given matrix $T_4$:\n$$T_4 = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix}$$\nThe characteristic polynomial is $P(\\lambda) = \\det(T_4 - \\lambda I)$:\n$$P(\\lambda) = \\det \\begin{pmatrix} -\\lambda & 1 & 0 & 0 \\\\ 1 & -\\lambda & 1 & 0 \\\\ 0 & 1 & -\\lambda & 1 \\\\ 0 & 0 & 1 & -\\lambda \\end{pmatrix}$$\nExpanding along the first row:\n$$P(\\lambda) = -\\lambda \\det \\begin{pmatrix} -\\lambda & 1 & 0 \\\\ 1 & -\\lambda & 1 \\\\ 0 & 1 & -\\lambda \\end{pmatrix} - 1 \\det \\begin{pmatrix} 1 & 1 & 0 \\\\ 0 & -\\lambda & 1 \\\\ 0 & 1 & -\\lambda \\end{pmatrix}$$\n$$P(\\lambda) = -\\lambda(-\\lambda(\\lambda^2-1) - 1(-\\lambda)) - 1(1(\\lambda^2-1))$$\n$$P(\\lambda) = -\\lambda(-\\lambda^3 + 2\\lambda) - (\\lambda^2-1) = \\lambda^4 - 2\\lambda^2 - \\lambda^2 + 1 = \\lambda^4 - 3\\lambda^2 + 1$$\nLet $u = \\lambda^2$. The characteristic equation becomes a quadratic equation in $u$: $u^2 - 3u + 1 = 0$.\nThe solutions for $u$ are:\n$$u = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$$\nSo, $\\lambda^2 = \\frac{3 + \\sqrt{5}}{2}$ or $\\lambda^2 = \\frac{3 - \\sqrt{5}}{2}$.\nThese values are related to the square of the golden ratio, $\\phi = \\frac{1+\\sqrt{5}}{2}$. Specifically, $\\phi^2 = \\frac{3+\\sqrt{5}}{2}$ and $(1/\\phi)^2 = (\\frac{\\sqrt{5}-1}{2})^2 = \\frac{3-\\sqrt{5}}{2}$.\nThe four eigenvalues are $\\lambda = \\pm \\phi$ and $\\lambda = \\pm 1/\\phi$.\nIn ascending order, the eigenvalues $\\lambda_1, \\lambda_2, \\lambda_3, \\lambda_4$ are:\n$$\\lambda_1 = -\\frac{1+\\sqrt{5}}{2}, \\quad \\lambda_2 = -\\frac{\\sqrt{5}-1}{2} = \\frac{1-\\sqrt{5}}{2}, \\quad \\lambda_3 = \\frac{\\sqrt{5}-1}{2}, \\quad \\lambda_4 = \\frac{1+\\sqrt{5}}{2}$$\n\nNow we find the corresponding normalized eigenvectors $y$. For an eigenvalue $\\lambda$, the unnormalized eigenvector can be written as $y \\propto (1, \\lambda, \\lambda^2-1, \\lambda^3-2\\lambda)^T$. The squared norm of this vector simplifies to $S(\\lambda) = 2\\lambda^2+2$.\nThe fourth component of the normalized eigenvector is $y_4 = \\frac{\\lambda^3-2\\lambda}{\\sqrt{2\\lambda^2+2}}$. We can also use the fact that for the last component of the eigenvector equation, $y_3 - \\lambda y_4 = 0$, so $y_4 = y_3/\\lambda$. With $y_1=1$, we have $y_3 = \\lambda^2-1$, so the fourth component of the unnormalized vector is $y_4^{unnorm} = (\\lambda^2-1)/\\lambda = \\lambda - 1/\\lambda$.\nThe normalized fourth component is $|y_4| = \\frac{|\\lambda - 1/\\lambda|}{\\sqrt{2\\lambda^2+2}}$.\n\nFor the extremal eigenvalues $\\lambda_1 = -\\phi$ and $\\lambda_4 = \\phi$, we have $\\lambda^2 = \\phi^2 = \\frac{3+\\sqrt{5}}{2}$.\n$|\\lambda - 1/\\lambda| = |\\pm\\phi - (\\pm 1/\\phi)| = |\\phi-1/\\phi| = 1$.\nThe normalization factor denominator is $\\sqrt{2\\phi^2+2} = \\sqrt{2(\\frac{3+\\sqrt{5}}{2})+2} = \\sqrt{3+\\sqrt{5}+2} = \\sqrt{5+\\sqrt{5}}$.\nSo, for these two eigenvalues, $|y_4| = \\frac{1}{\\sqrt{5+\\sqrt{5}}}$.\nThe residual norm is $\\|R\\| = |\\beta_4||y_4| = \\frac{1}{100} \\frac{1}{\\sqrt{5+\\sqrt{5}}}$.\n\nFor the inner eigenvalues $\\lambda_2 = -1/\\phi$ and $\\lambda_3 = 1/\\phi$, we have $\\lambda^2 = (1/\\phi)^2 = \\frac{3-\\sqrt{5}}{2}$.\n$|\\lambda - 1/\\lambda| = |\\pm 1/\\phi - (\\pm\\phi)| = |- (\\phi-1/\\phi)| = 1$.\nThe normalization factor denominator is $\\sqrt{2(1/\\phi)^2+2} = \\sqrt{2(\\frac{3-\\sqrt{5}}{2})+2} = \\sqrt{3-\\sqrt{5}+2} = \\sqrt{5-\\sqrt{5}}$.\nSo, for these two eigenvalues, $|y_4| = \\frac{1}{\\sqrt{5-\\sqrt{5}}}$.\nThe residual norm is $\\|R\\| = |\\beta_4||y_4| = \\frac{1}{100} \\frac{1}{\\sqrt{5-\\sqrt{5}}}$.\n\nThe final results are ordered according to ascending eigenvalues.\nEigenvalues:\n$\\lambda_1 = -\\frac{1+\\sqrt{5}}{2}$\n$\\lambda_2 = \\frac{1-\\sqrt{5}}{2}$\n$\\lambda_3 = \\frac{\\sqrt{5}-1}{2}$\n$\\lambda_4 = \\frac{1+\\sqrt{5}}{2}$\n\nCorresponding residual norms:\nFor $\\lambda_1$: $R_1 = \\frac{1}{100\\sqrt{5+\\sqrt{5}}}$\nFor $\\lambda_2$: $R_2 = \\frac{1}{100\\sqrt{5-\\sqrt{5}}}$\nFor $\\lambda_3$: $R_3 = \\frac{1}{100\\sqrt{5-\\sqrt{5}}}$\nFor $\\lambda_4$: $R_4 = \\frac{1}{100\\sqrt{5+\\sqrt{5}}}$\nThese are the exact, closed-form expressions requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1+\\sqrt{5}}{2} & \\frac{1-\\sqrt{5}}{2} & \\frac{\\sqrt{5}-1}{2} & \\frac{1+\\sqrt{5}}{2} & \\frac{1}{100\\sqrt{5+\\sqrt{5}}} & \\frac{1}{100\\sqrt{5-\\sqrt{5}}} & \\frac{1}{100\\sqrt{5-\\sqrt{5}}} & \\frac{1}{100\\sqrt{5+\\sqrt{5}}}\n\\end{pmatrix}\n}\n$$", "id": "3603131"}, {"introduction": "Understanding the performance of an algorithm is as important as understanding its mathematical basis. This practice guides you through a 'back-of-the-envelope' calculation to determine the computational cost, measured in Floating-Point Operations (FLOPs), of a single Lanczos iteration. By breaking down the cost of each step, you will discover that the Hamiltonian-vector product, $y \\leftarrow H v$, is the bottleneck, a critical insight that motivates the design of efficient shell model codes [@problem_id:3603207].", "problem": "You are implementing the Lanczos algorithm to compute extremal eigenpairs of a large, sparse nuclear shell-model Hamiltonian in the magnetic quantum number scheme (m-scheme). The Hamiltonian $H$ is represented as the sum of one-body and two-body parts, and is applied to a state vector via a precomputed link list over nonzero couplings between Slater determinants. The dimension of the many-body basis is $N$, the number of one-body links is $M_{1}$, and the number of two-body links is $M_{2}$. Each link contributes one multiplication and one addition when accumulating $y \\leftarrow H v$, so the cost of $y \\leftarrow H v$ is $2(M_{1} + M_{2})$ Floating-Point Operations (FLOPs), where a Floating-Point Operation (FLOP) is defined as one addition or one multiplication. In one Lanczos iteration, you perform the following steps on vectors in $\\mathbb{R}^{N}$: \n(1) $y \\leftarrow H v$, \n(2) $\\alpha \\leftarrow v^{\\top} y$, \n(3) $y \\leftarrow y - \\alpha v - \\beta_{\\mathrm{prev}} v_{\\mathrm{prev}}$, \n(4) $\\beta \\leftarrow \\| y \\|_{2}$, and \n(5) $v_{\\mathrm{next}} \\leftarrow y / \\beta$. \nAssume the following FLOP model: each addition or multiplication costs $1$ FLOP, each division costs $d$ FLOPs, and each square root costs $s$ FLOPs. There is no reorthogonalization and no restart overhead. Starting only from these definitions and the standard structure of the Lanczos iteration, derive a closed-form analytic expression for the total per-iteration FLOP count $C_{\\mathrm{iter}}$ in terms of $M_{1}$, $M_{2}$, $N$, $d$, and $s$. Then, under the assumption that the two-body term dominates in the m-scheme implementation, i.e., $M_{2} \\gg M_{1}$ and $M_{2} \\gg N$, simplify $C_{\\mathrm{iter}}$ to its leading term. Express your final answer as the leading-order analytic expression for $C_{\\mathrm{iter}}$.", "solution": "The problem requires the derivation of the total per-iteration Floating-Point Operation (FLOP) count, denoted as $C_{\\mathrm{iter}}$, for a standard Lanczos iteration applied to a nuclear shell-model Hamiltonian. Subsequently, this expression must be simplified to its leading term under a specified dominance condition.\n\nThe analysis will proceed by breaking down one full Lanczos iteration into its five constituent steps, as provided in the problem statement. For each step, we will count the number of floating-point operations (additions, multiplications, divisions, square roots) based on the given FLOP model, where additions and multiplications cost $1$ FLOP, divisions cost $d$ FLOPs, and square roots cost $s$ FLOPs. All vectors are in $\\mathbb{R}^{N}$.\n\n1.  **Step 1: Hamilton-vector product, $y \\leftarrow H v$**\n    The problem statement specifies that the cost of applying the Hamiltonian $H$ to a vector $v$ is determined by the number of one-body ($M_1$) and two-body ($M_2$) links in the precomputed data structure. Each link corresponds to one multiplication and one addition.\n    The total FLOP count for this step is explicitly given as:\n    $$C_1 = 2(M_1 + M_2)$$\n\n2.  **Step 2: Dot product, $\\alpha \\leftarrow v^{\\top} y$**\n    This step calculates the dot product of two vectors, $v$ and $y$, of dimension $N$. The dot product is defined as $\\alpha = \\sum_{i=1}^{N} v_i y_i$. This computation involves $N$ multiplications (for each term $v_i y_i$) and $N-1$ additions to sum these products.\n    The total FLOP count for this step is:\n    $$C_2 = N + (N-1) = 2N - 1$$\n\n3.  **Step 3: Vector update (orthogonalization), $y \\leftarrow y - \\alpha v - \\beta_{\\mathrm{prev}} v_{\\mathrm{prev}}$**\n    This operation updates the vector $y$ by subtracting scaled versions of the current and previous Lanczos vectors, $v$ and $v_{\\mathrm{prev}}$. This update is performed component-wise. For each component $i$ from $1$ to $N$, the operation is $y_i \\leftarrow y_i - \\alpha v_i - \\beta_{\\mathrm{prev}} (v_{\\mathrm{prev}})_i$. This requires two multiplications (to find $\\alpha v_i$ and $\\beta_{\\mathrm{prev}} (v_{\\mathrm{prev}})_i$) and two subtractions. Since a subtraction costs $1$ FLOP, the total cost for $N$ components is $2N$ multiplications and $2N$ subtractions.\n    The total FLOP count for this step is:\n    $$C_3 = 2N + 2N = 4N$$\n\n4.  **Step 4: Vector norm, $\\beta \\leftarrow \\| y \\|_{2}$**\n    This step calculates the Euclidean norm (or $2$-norm) of the updated vector $y$, which is $\\beta = \\sqrt{\\sum_{i=1}^{N} y_i^2}$. The calculation proceeds as follows:\n    -   Compute the square of each component $y_i^2$: $N$ multiplications.\n    -   Sum the squares: $N-1$ additions.\n    -   Take the square root of the sum: $1$ square root operation.\n    The total FLOP count for this step is:\n    $$C_4 = N + (N-1) + s = 2N - 1 + s$$\n\n5.  **Step 5: Vector normalization, $v_{\\mathrm{next}} \\leftarrow y / \\beta$**\n    This step normalizes the vector $y$ to produce the next Lanczos vector $v_{\\mathrm{next}}$. The operation consists of dividing each of the $N$ components of vector $y$ by the scalar $\\beta$. This constitutes $N$ separate division operations.\n    The total FLOP count for this step, given that each division costs $d$ FLOPs, is:\n    $$C_5 = N d$$\n\nThe total per-iteration FLOP count, $C_{\\mathrm{iter}}$, is the sum of the costs of these five steps:\n$$C_{\\mathrm{iter}} = C_1 + C_2 + C_3 + C_4 + C_5$$\n$$C_{\\mathrm{iter}} = (2(M_1 + M_2)) + (2N - 1) + (4N) + (2N - 1 + s) + (Nd)$$\nCombining the terms, we obtain the closed-form analytic expression:\n$$C_{\\mathrm{iter}} = 2M_1 + 2M_2 + 8N + Nd + s - 2$$\n\nThe second part of the problem asks to simplify this expression to its leading term under the assumption that the two-body part of the interaction dominates. This is stated by the conditions $M_2 \\gg M_1$ and $M_2 \\gg N$. These conditions signify that $M_2$ is the largest parameter characterizing the problem size. We analyze the behavior of $C_{\\mathrm{iter}}$ in the asymptotic limit where $M_2$ is large.\n\nThe expression for $C_{\\mathrm{iter}}$ is a sum of several terms: $2M_2$, $2M_1$, $8N$, $Nd$, and $s-2$.\n- The term $2M_2$ is proportional to $M_2$.\n- The term $2M_1$ is negligible compared to $2M_2$ because $M_2 \\gg M_1$.\n- The term $8N$ is negligible compared to $2M_2$ because $M_2 \\gg N$.\n- The term $Nd$ is also negligible compared to $2M_2$ because $M_2 \\gg N$ and $d$ is a fixed constant.\n- The term $s-2$ is a constant and is therefore negligible for large $M_2$.\n\nFormally, we can write $C_{\\mathrm{iter}}$ as:\n$$C_{\\mathrm{iter}} = 2M_2 \\left(1 + \\frac{M_1}{M_2} + \\frac{4N}{M_2} + \\frac{Nd}{2M_2} + \\frac{s-2}{2M_2}\\right)$$\nIn the limit as $M_2 \\rightarrow \\infty$, the ratios $\\frac{M_1}{M_2}$, $\\frac{N}{M_2}$, and $\\frac{1}{M_2}$ all approach zero. Thus, the expression in the parenthesis approaches $1$. The dominant, or leading-order, term in the expression for $C_{\\mathrm{iter}}$ is the one that grows most rapidly with the problem size, which is the term proportional to $M_2$.\n\nTherefore, the leading-order analytic expression for the per-iteration FLOP count is:\n$$C_{\\mathrm{iter}} \\approx 2M_2$$\nThis result reflects the well-known fact that in large-scale shell-model calculations, the computational cost is overwhelmingly dominated by the application of the two-body part of the Hamiltonian.", "answer": "$$\\boxed{2M_2}$$", "id": "3603207"}, {"introduction": "Idealized algorithms often need modification to run on real-world hardware with finite resources. This exercise addresses one of the most common practical challenges in large-scale Lanczos calculations: limited memory. You will design a thick-restart strategy by determining a practical restart window size that balances the physics requirement for convergence with a fixed memory budget, illustrating a fundamental trade-off in high-performance scientific computing [@problem_id:3603169].", "problem": "Consider a large-scale Configuration Interaction shell-model calculation in the calcium region using a proton-neutron $pf$-shell valence space (comprising the single-particle orbitals $0f_{7/2}$, $0f_{5/2}$, $1p_{3/2}$, and $1p_{1/2}$). The many-body Hamiltonian is Hermitian and sparse in the $M$-scheme basis, and diagonalization is performed with the Lanczos algorithm using a thick-restart strategy to compute the $k$ lowest-lying eigenstates.\n\nAssume the following scientifically realistic scenario and constraints:\n- The working basis dimension after fixing total projection quantum numbers is $N = 2.4 \\times 10^{7}$.\n- The algorithm uses double precision storage, so each vector component occupies $8$ bytes.\n- Thick-restart keeps $w$ Ritz vectors on restart and requires three additional full-length working vectors for recurrence and reorthogonalization.\n- A memory budget of $M_{\\text{vec}} = 20\\,\\mathrm{GB}$ is reserved exclusively to hold these Lanczos vectors and no other arrays contribute at this scale.\n- You aim to compute $k = 30$ lowest eigenstates.\n- In typical $pf$-shell spaces with clustered low-energy spectra, robust convergence with thick-restart is achieved by maintaining a guard band of $g = 20$ additional Ritz vectors beyond the target $k$ to buffer near-degenerate or tightly clustered states.\n\nStarting from the definition of the Lanczos Krylov subspace and the thick-restart mechanism, and using fundamental storage accounting, determine a practical restart window size $w$ consistent with the memory budget and anticipated convergence behavior. Express the final answer as the integer value of $w$. Do not include units in your final answer.", "solution": "The problem asks to determine a practical restart window size, denoted by $w$, for a thick-restart Lanczos algorithm. This value must be consistent with both the required convergence behavior and the available memory budget.\n\nFirst, we determine the restart window size $w$ needed from a physics and convergence perspective. The goal is to compute $k=30$ eigenstates. To ensure robust convergence, especially in a space with a potentially dense low-lying spectrum like the $pf$-shell, a \"guard band\" of additional Ritz vectors must be tracked. The problem specifies a guard band of $g=20$ vectors. Therefore, the number of Ritz vectors that should be kept upon restart is the sum of the target states and the guard band:\n$$ w = k + g = 30 + 20 = 50 $$\nThis means we will keep the 50 lowest Ritz vectors at each restart.\n\nNext, we must verify if this choice of $w=50$ is feasible within the given memory budget. The total number of full-length vectors that must be stored in memory simultaneously, $n_{\\text{vec}}$, includes the $w$ Ritz vectors kept at restart and the three additional working vectors required for the Lanczos recurrence and reorthogonalization:\n$$ n_{\\text{vec}} = w + 3 = 50 + 3 = 53 \\text{ vectors} $$\n\nThe memory required to store a single vector, $S_{\\text{vec}}$, depends on the basis dimension, $N = 2.4 \\times 10^7$, and the use of double precision (8 bytes per component):\n$$ S_{\\text{vec}} = N \\times 8\\,\\text{bytes} = (2.4 \\times 10^7) \\times 8\\,\\text{bytes} = 1.92 \\times 10^8\\,\\text{bytes} $$\n\nThe total memory required for all vectors, $M_{\\text{req}}$, is the product of the number of vectors and the size of each one:\n$$ M_{\\text{req}} = n_{\\text{vec}} \\times S_{\\text{vec}} = 53 \\times (1.92 \\times 10^8\\,\\text{bytes}) = 1.0176 \\times 10^{10}\\,\\text{bytes} $$\n\nFinally, we compare this required memory to the available budget, $M_{\\text{vec}} = 20\\,\\mathrm{GB}$. Using the conversion $1\\,\\mathrm{GB} = 10^9\\,\\text{bytes}$, the budget is $2.0 \\times 10^{10}\\,\\text{bytes}$.\nSince $M_{\\text{req}} = 1.0176 \\times 10^{10}\\,\\text{bytes}$ is less than $M_{\\text{vec}} = 2.0 \\times 10^{10}\\,\\text{bytes}$, the memory requirement is well within the budget.\n\nThus, a practical restart window size that satisfies both the convergence criteria and the memory constraints is $w=50$.", "answer": "$$\\boxed{50}$$", "id": "3603169"}]}