{"hands_on_practices": [{"introduction": "Before tackling complex computations, it is essential to have a firm grasp of the fundamental structure of the harmonic oscillator shell model. This foundational exercise focuses on enumerating the single-particle states within a given major shell, a process that reveals the origin of the first \"magic numbers\". By applying the rules governing the principal quantum number $N$, orbital angular momentum $l$, and total angular momentum $j$, you will build the shell structure from the ground up, calculating the parity and degeneracy of each level [@problem_id:3607427].", "problem": "Consider the single-particle shell model for nucleons in a Three-Dimensional Isotropic Harmonic Oscillator (3D IHO) potential of angular frequency $\\omega$. The harmonic oscillator quantum number is defined by $N = 2n + l$, where $n$ is the radial node count (a nonnegative integer) and $l$ is the orbital angular momentum. Each nucleon has intrinsic spin $s = \\tfrac{1}{2}$, and total angular momentum $j$ arises from coupling $l$ and $s$. The spatial parity of a state is determined by $\\pi = (-1)^{l}$. For the major shell with $N=2$, enumerate all allowed $(n,l,j)$ states together with their parities. Using first principles of angular momentum coupling and state counting, compute the total number of distinct single-particle states in the $N=2$ shell when spin degeneracy is included. Express the final answer as an exact integer with no units.", "solution": "The starting point is the structure of the Three-Dimensional Isotropic Harmonic Oscillator (3D IHO) in the single-particle shell model, where the major shell quantum number is $N = 2n + l$, with $n \\in \\{0,1,2,\\dots\\}$ and $l \\in \\{0,1,2,\\dots\\}$. For a given $N$, the allowed pairs $(n,l)$ are those for which $2n + l = N$. The parity of the spatial wave function is given by $\\pi = (-1)^{l}$. The nucleon carries spin $s = \\tfrac{1}{2}$, and the total angular momentum $j$ is obtained by angular momentum coupling, namely\n$$\nj \\in \\left\\{\\, l - \\tfrac{1}{2},\\, l + \\tfrac{1}{2} \\,\\right\\},\n$$\nsubject to $j \\ge 0$, and with the special case for $l=0$ yielding only $j=\\tfrac{1}{2}$. Each level with given $j$ has $(2j+1)$ magnetic substates due to projection $m_{j} \\in \\{-j,-j+1,\\dots,j\\}$, and these $(2j+1)$ states account for spin degeneracy implicitly because $j$ already reflects the coupling of $l$ with $s$.\n\nWe enumerate the allowed $(n,l)$ for $N=2$ by solving $2n + l = 2$ with nonnegative integers:\n- If $l=0$, then $2n=2 \\Rightarrow n=1$. This gives $(n,l) = (1,0)$.\n- If $l=1$, then $2n=1 \\Rightarrow n=\\tfrac{1}{2}$, which is not allowed.\n- If $l=2$, then $2n=0 \\Rightarrow n=0$. This gives $(n,l) = (0,2)$.\n- If $l \\ge 3$, then $l  2$ forces $2n = 2 - l  0$, which is impossible.\n\nThus the only allowed pairs for $N=2$ are $(n,l) = (1,0)$ and $(n,l) = (0,2)$.\n\nNext, determine the possible $j$ values and parities:\n1. For $(n,l) = (1,0)$:\n   - Parity is $\\pi = (-1)^{0} = +1$ (positive).\n   - With $l=0$ and $s=\\tfrac{1}{2}$, the only total angular momentum is $j = \\tfrac{1}{2}$.\n   - This orbit is commonly labeled $2s_{1/2}$ (where the radial node count $n=1$ indicates the second $s$-wave in the harmonic oscillator).\n\n2. For $(n,l) = (0,2)$:\n   - Parity is $\\pi = (-1)^{2} = +1$ (positive).\n   - With $l=2$ and $s=\\tfrac{1}{2}$, the allowed total angular momenta are $j = \\tfrac{3}{2}$ and $j = \\tfrac{5}{2}$.\n   - These orbits are commonly labeled $1d_{3/2}$ and $1d_{5/2}$ (where the radial node count $n=0$ indicates the first $d$-wave in the harmonic oscillator).\n\nWe now compute the number of single-particle states including spin degeneracy by summing the magnetic substate counts $(2j+1)$ over all distinct $j$ values in the $N=2$ shell:\n- For $2s_{1/2}$: $2j+1 = 2 \\cdot \\tfrac{1}{2} + 1 = 2$.\n- For $1d_{3/2}$: $2j+1 = 2 \\cdot \\tfrac{3}{2} + 1 = 4$.\n- For $1d_{5/2}$: $2j+1 = 2 \\cdot \\tfrac{5}{2} + 1 = 6$.\n\nSumming these,\n$$\n2 + 4 + 6 = 12.\n$$\n\nAs a consistency check grounded in the known structure of the 3D IHO, the spatial degeneracy (excluding spin) of the $N$th shell is\n$$\ng_{N}^{\\text{space}} = \\frac{(N+1)(N+2)}{2}.\n$$\nFor $N=2$, this gives $g_{2}^{\\text{space}} = \\frac{(3)(4)}{2} = 6$. Including the two spin projections for spin $\\tfrac{1}{2}$ doubles this number to $12$, which matches the sum over $(2j+1)$ obtained via explicit angular momentum coupling.\n\nTherefore, the total count of single-particle states in the $N=2$ shell, including spin degeneracy, is $12$.", "answer": "$$\\boxed{12}$$", "id": "3607427"}, {"introduction": "The simple isotropic harmonic oscillator correctly predicts the first few magic numbers but fails for heavier nuclei. The crucial missing ingredient, introduced by Maria Goeppert Mayer and J. Hans D. Jensen, is the spin-orbit interaction, which splits the degenerate levels. This computational practice challenges you to model this effect by adding a spin-orbit term $V_{\\text{so}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$ to the Hamiltonian [@problem_id:3607470]. You will derive the energy splittings using first-order perturbation theory and compare them to the results of an exact numerical diagonalization, providing a powerful check on your understanding of operator representations and basis transformations.", "problem": "Consider a single spin-$\\tfrac{1}{2}$ nucleon in a Three-Dimensional (3D) isotropic harmonic oscillator potential, modeled in the single-particle shell model. The unperturbed Hamiltonian is given by $H_{0}=\\dfrac{\\mathbf{p}^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}r^{2}$, with eigenstates labeled by the radial quantum number $n\\in\\{0,1,2,\\dots\\}$, the orbital angular momentum $\\ell\\in\\{0,1,2,\\dots\\}$, and its projection $m_{\\ell}\\in\\{-\\ell,-\\ell+1,\\dots,\\ell\\}$. The spin operator corresponds to spin $s=\\tfrac{1}{2}$ with projection $m_{s}\\in\\{-\\tfrac{1}{2},\\tfrac{1}{2}\\}$. Use natural units with $\\hbar=1$, $m=1$, and $\\omega=1$, so that energies are expressed in units of $\\hbar\\omega$ and are dimensionless. In these units, the unperturbed energy is $E_{0}(n,\\ell)=2n+\\ell+\\tfrac{3}{2}$.\n\nA weak spin-orbit interaction is added as a perturbation $V_{\\text{so}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$, where $\\lambda$ is a real scalar coupling parameter measured in units of $\\hbar\\omega$. The total Hamiltonian is $H=H_{0}+\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$. For fixed $(n,\\ell)$, the Hilbert space of interest factorizes as the tensor product of the orbital subspace spanned by $\\{|\\,\\ell,m_{\\ell}\\rangle\\}$ and the spin subspace spanned by $\\{|\\,s=\\tfrac{1}{2},m_{s}\\rangle\\}$, with total dimension $2(2\\ell+1)$.\n\nTask:\n- Derive, from first principles starting with standard angular momentum algebra and time-independent perturbation theory to first order, the analytic first-order perturbative energy shifts $\\Delta E_{n\\ell j}$ for states of good total angular momentum $j\\in\\{\\ell-\\tfrac{1}{2},\\ell+\\tfrac{1}{2}\\}$ when $\\ell\\ge 1$ and $j=\\tfrac{1}{2}$ when $\\ell=0$. Do not assume any pre-derived “shortcut” expression; start from core definitions of angular momentum operators and their commutation relations.\n- Implement an exact numerical diagonalization of the Hamiltonian $H$ within the $(n,\\ell)$ block by constructing the matrix of $\\mathbf{L}\\cdot\\mathbf{S}$ in the uncoupled basis $\\{|\\,\\ell,m_{\\ell}\\rangle\\otimes|\\,\\tfrac{1}{2},m_{s}\\rangle\\}$ using the ladder-operator actions and selection rules, and adding $E_{0}(n,\\ell)$ to the diagonal. Specifically, use the identities for the ladder operators $L_{\\pm}$ and $S_{\\pm}$:\n  - $L_{\\pm}|\\,\\ell,m_{\\ell}\\rangle=\\sqrt{\\ell(\\ell+1)-m_{\\ell}(m_{\\ell}\\pm 1)}\\,|\\,\\ell,m_{\\ell}\\pm 1\\rangle$,\n  - $S_{\\pm}|\\,\\tfrac{1}{2},m_{s}\\rangle=\\sqrt{\\tfrac{1}{2}(\\tfrac{1}{2}+1)-m_{s}(m_{s}\\pm 1)}\\,|\\,\\tfrac{1}{2},m_{s}\\pm 1\\rangle$,\n  and construct $\\mathbf{L}\\cdot\\mathbf{S}=L_{z}S_{z}+\\tfrac{1}{2}(L_{+}S_{-}+L_{-}S_{+})$ in this basis.\n- For each specified parameter set $(n,\\ell,\\lambda)$, compute:\n  - the sorted list of exact eigenvalues of $H$ from numerical diagonalization, and\n  - the sorted list of first-order perturbative predictions for all states in the $(n,\\ell)$ block, respecting the multiplicities $2j+1$.\n- For each parameter set, compute the maximum absolute deviation between the two lists (as a single scalar), i.e., the largest absolute difference between corresponding entries of the sorted lists of energies. Report this deviation in units of $\\hbar\\omega$.\n\nUse the following test suite of parameter values to assess different regimes (including small $\\lambda$, vanishing splitting, negative $\\lambda$, and larger couplings):\n- Case $1$: $(n,\\ell,\\lambda)=(0,1,0.0)$,\n- Case $2$: $(n,\\ell,\\lambda)=(0,0,0.2)$,\n- Case $3$: $(n,\\ell,\\lambda)=(0,1,0.5)$,\n- Case $4$: $(n,\\ell,\\lambda)=(0,3,-0.3)$,\n- Case $5$: $(n,\\ell,\\lambda)=(2,2,1.0)$,\n- Case $6$: $(n,\\ell,\\lambda)=(4,5,0.75)$.\n\nYour program must compute, for each case in the above order, the single float equal to the maximum absolute deviation (in units of $\\hbar\\omega$) between the numerical diagonalization results and the first-order perturbative predictions within the $(n,\\ell)$ block. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_{1},x_{2},\\dots,x_{6}]$). All energies and deviations must be expressed in units of $\\hbar\\omega$ (dimensionless). No user input is allowed; the program must run as-is and print the final result line. Angles, if any appear internally, must be in radians; however, no angle needs to be reported.", "solution": "The problem requires an analysis of the single-particle shell model for a spin-$1/2$ nucleon in a 3D isotropic harmonic oscillator potential with a spin-orbit interaction, $V_{\\text{so}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$. We are tasked with deriving the first-order energy shifts analytically and comparing them to the exact eigenvalues obtained by numerical diagonalization of the Hamiltonian within a degenerate $(n,\\ell)$ manifold. The entire analysis is performed in natural units where $\\hbar=1$, $m=1$, and $\\omega=1$.\n\n### 1. Analytical Derivation of First-Order Energy Shifts\n\nThe unperturbed Hamiltonian $H_{0}=\\dfrac{\\mathbf{p}^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}r^{2}$ has eigenvalues $E_{0}(n,\\ell)=2n+\\ell+\\tfrac{3}{2}$ for a given radial quantum number $n$ and orbital angular momentum $\\ell$. For a fixed pair $(n,\\ell)$, all $2(2\\ell+1)$ states corresponding to different projections $m_{\\ell}$ and $m_s$ are degenerate. We introduce the perturbation $V_{\\text{so}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$. According to degenerate perturbation theory, the first-order energy corrections are the eigenvalues of the perturbation matrix constructed within this degenerate subspace.\n\nA convenient way to find these eigenvalues is to switch to a basis that diagonalizes $V_{\\text{so}}$. The \"good\" basis states are the eigenstates of total angular momentum $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$, denoted by $|\\ell, s; j, m_j\\rangle$. To show why this basis diagonalizes the perturbation, we express $\\mathbf{L}\\cdot\\mathbf{S}$ in terms of the conserved quantities $\\mathbf{J}^2$, $\\mathbf{L}^2$, and $\\mathbf{S}^2$.\n\nWe start from the definition $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$. Squaring this vector operator yields:\n$$\n\\mathbf{J}^2 = \\mathbf{J} \\cdot \\mathbf{J} = (\\mathbf{L} + \\mathbf{S}) \\cdot (\\mathbf{L} + \\mathbf{S}) = \\mathbf{L}^2 + \\mathbf{S}^2 + \\mathbf{L}\\cdot\\mathbf{S} + \\mathbf{S}\\cdot\\mathbf{L}\n$$\nThe orbital angular momentum operator $\\mathbf{L}$ acts on the spatial part of the wavefunction, while the spin operator $\\mathbf{S}$ acts on the internal spin part. Thus, they operate on different Hilbert spaces, and their components commute: $[L_i, S_k] = 0$ for $i,k \\in \\{x,y,z\\}$. This implies $\\mathbf{L}\\cdot\\mathbf{S} = \\sum_i L_iS_i = \\sum_i S_iL_i = \\mathbf{S}\\cdot\\mathbf{L}$. The expression for $\\mathbf{J}^2$ simplifies to:\n$$\n\\mathbf{J}^2 = \\mathbf{L}^2 + \\mathbf{S}^2 + 2\\mathbf{L}\\cdot\\mathbf{S}\n$$\nRearranging this equation gives the standard expression for the spin-orbit operator:\n$$\n\\mathbf{L}\\cdot\\mathbf{S} = \\frac{1}{2} (\\mathbf{J}^2 - \\mathbf{L}^2 - \\mathbf{S}^2)\n$$\nThe states $|\\ell, s; j, m_j\\rangle$ are, by definition, simultaneous eigenstates of $\\mathbf{J}^2$ (eigenvalue $j(j+1)$), $\\mathbf{L}^2$ (eigenvalue $\\ell(\\ell+1)$), and $\\mathbf{S}^2$ (eigenvalue $s(s+1)$). Therefore, applying the operator $\\mathbf{L}\\cdot\\mathbf{S}$ to these states gives a scalar multiple of the state itself:\n$$\n\\mathbf{L}\\cdot\\mathbf{S} |\\ell, s; j, m_j\\rangle = \\frac{1}{2} [j(j+1) - \\ell(\\ell+1) - s(s+1)] |\\ell, s; j, m_j\\rangle\n$$\nThe first-order energy shift $\\Delta E_{n\\ell j}$ is the expectation value of the perturbation $V_{\\text{so}}$ in this basis, which is simply $\\lambda$ times the eigenvalue of $\\mathbf{L}\\cdot\\mathbf{S}$:\n$$\n\\Delta E_{n\\ell j} = \\lambda \\frac{1}{2} [j(j+1) - \\ell(\\ell+1) - s(s+1)]\n$$\nFor a spin-$1/2$ nucleon, $s=1/2$, so $s(s+1) = 3/4$. For a given $\\ell$, the possible values of total angular momentum are $j=\\ell \\pm 1/2$ (if $\\ell \\ge 1$) or $j=1/2$ (if $\\ell=0$).\n\nCase 1: $\\ell \\ge 1$\n- For $j = \\ell + 1/2$:\n$$\n\\Delta E_{n\\ell, j=\\ell+1/2} = \\frac{\\lambda}{2} \\left[ \\left(\\ell+\\frac{1}{2}\\right)\\left(\\ell+\\frac{3}{2}\\right) - \\ell(\\ell+1) - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} \\left[ \\ell^2 + 2\\ell + \\frac{3}{4} - \\ell^2 - \\ell - \\frac{3}{4} \\right] = \\frac{\\lambda\\ell}{2}\n$$\nThe degeneracy of this level is $2j+1 = 2(\\ell+1/2)+1 = 2\\ell+2$.\n\n- For $j = \\ell - 1/2$:\n$$\n\\Delta E_{n\\ell, j=\\ell-1/2} = \\frac{\\lambda}{2} \\left[ \\left(\\ell-\\frac{1}{2}\\right)\\left(\\ell+\\frac{1}{2}\\right) - \\ell(\\ell+1) - \\frac{3}{4} \\right] = \\frac{\\lambda}{2} \\left[ \\ell^2 - \\frac{1}{4} - \\ell^2 - \\ell - \\frac{3}{4} \\right] = -\\frac{\\lambda(\\ell+1)}{2}\n$$\nThe degeneracy of this level is $2j+1 = 2(\\ell-1/2)+1 = 2\\ell$.\n\nCase 2: $\\ell = 0$\n- In this case, $\\mathbf{L}=0$, so $\\mathbf{L}\\cdot\\mathbf{S}=0$. The only possible value for $j$ is $s=1/2$. The energy shift is $\\Delta E_{n,0,1/2} = 0$. The degeneracy is $2j+1=2$.\n\nThe total first-order perturbed energy levels are $E_{n\\ell j}^{(1)} = E_0(n,\\ell) + \\Delta E_{n\\ell j}$.\n\n### 2. Numerical Diagonalization\n\nThe problem requires an exact diagonalization of the total Hamiltonian $H = H_0 + V_{\\text{so}}$ within the $(n,\\ell)$ subspace. Since $H_0$ is a constant scalar multiple of the identity operator ($E_0(n,\\ell)I$) in this subspace, we only need to construct the matrix for the perturbation $V_{\\text{so}} = \\lambda \\mathbf{L}\\cdot\\mathbf{S}$ and then add $E_0(n,\\ell)$ to its eigenvalues.\n\nWe construct the matrix in the uncoupled basis $\\{|\\ell, m_\\ell\\rangle \\otimes |s, m_s\\rangle\\}$, ordered for convenience. The total dimension of this space is $D=2(2\\ell+1)$. We use the representation $\\mathbf{L}\\cdot\\mathbf{S} = L_z S_z + \\frac{1}{2}(L_+ S_- + L_- S_+)$. The matrix elements are $\\langle \\ell, m'_\\ell; s, m'_s | \\mathbf{L}\\cdot\\mathbf{S} | \\ell, m_\\ell; s, m_s \\rangle$.\n\n- **Diagonal elements ($L_z S_z$):**\nThis term is diagonal in the uncoupled basis.\n$$\n\\langle m'_\\ell, m'_s | L_z S_z | m_\\ell, m_s \\rangle = m_\\ell m_s \\, \\delta_{m'_\\ell, m_\\ell} \\delta_{m'_s, m_s}\n$$\n\n- **Off-diagonal elements ($L_+ S_-$ and $L_- S_+$):**\nThese terms connect different basis states.\nThe $L_+ S_-$ operator connects $|m_\\ell, m_s=1/2\\rangle$ to $|m_\\ell+1, m_s=-1/2\\rangle$:\n$$\n\\frac{1}{2}\\langle m_\\ell+1, -1/2 | L_+ S_- | m_\\ell, 1/2 \\rangle = \\frac{1}{2} \\sqrt{\\ell(\\ell+1)-m_\\ell(m_\\ell+1)}\n$$\nThe $L_- S_+$ operator connects $|m_\\ell, m_s=-1/2\\rangle$ to $|m_\\ell-1, m_s=1/2\\rangle$:\n$$\n\\frac{1}{2}\\langle m_\\ell-1, 1/2 | L_- S_+ | m_\\ell, -1/2 \\rangle = \\frac{1}{2} \\sqrt{\\ell(\\ell+1)-m_\\ell(m_\\ell-1)}\n$$\nAll other matrix elements of the off-diagonal terms are zero. The full Hamiltonian matrix is then $H_{matrix} = E_0(n,\\ell)I + \\lambda (\\mathbf{L}\\cdot\\mathbf{S})_{matrix}$.\n\n### 3. Comparison and Rationale\n\nThe \"first-order perturbative predictions\" are obtained by applying degenerate perturbation theory. This theory stipulates that the correct first-order energy shifts are the eigenvalues of the perturbation matrix restricted to the degenerate subspace. The analytical derivation in Section 1 is a method to find these eigenvalues by using a basis that diagonalizes the perturbation. The numerical diagonalization in Section 2 is a direct construction and diagonalization of this exact same perturbation matrix.\n\nTherefore, the two methods are mathematically equivalent. The \"exact eigenvalues of $H$\" obtained by numerical diagonalization and the \"first-order perturbative predictions\" should be identical. Any observed deviation will be due to floating-point numerical precision limits. The problem thus serves as a rigorous verification of the correct implementation of the quantum mechanical operators and diagonalization procedures. The maximum absolute deviation is expected to be close to zero for all test cases.\n\nThe algorithm is as follows:\n1. For each parameter set $(n, \\ell, \\lambda)$, calculate the unperturbed energy $E_0(n,\\ell)$.\n2. Construct the list of first-order perturbed energies using the analytical formulas for $j=\\ell\\pm 1/2$, respecting the $(2j+1)$ multiplicity of each level. Sort this list.\n3. Construct the $2(2\\ell+1) \\times 2(2\\ell+1)$ matrix for the full Hamiltonian $H$ in the uncoupled basis, using the ladder operator identities.\n4. Numerically diagonalize this matrix to find its eigenvalues. `numpy.linalg.eigvalsh` is suitable as the matrix is Hermitian and returns sorted real eigenvalues.\n5. Compute the element-wise absolute difference between the sorted lists of energies from steps 2 and 4. The final result is the maximum of these differences.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Execution environment details:\n# language: Python\n# version: 3.12\n# libraries:\n#     - name: numpy, version: 1.23.5\n#     - name: scipy, version: 1.11.4 (not used)\n\ndef _solve_case(n: int, l: int, lam: float) - float:\n    \"\"\"\n    Computes the maximum absolute deviation between analytical and numerical\n    energy eigenvalues for a single set of parameters (n, l, lambda).\n\n    Args:\n        n: The radial quantum number.\n        l: The orbital angular momentum quantum number.\n        lam: The spin-orbit coupling parameter.\n\n    Returns:\n        The maximum absolute deviation between the two sets of energies.\n    \"\"\"\n    # Unperturbed energy for the (n, l) shell in units of hbar*omega\n    E0 = 2 * n + l + 1.5\n\n    # --- 1. First-Order Perturbative Calculation ---\n    # According to degenerate perturbation theory, the first-order corrections\n    # are the eigenvalues of the perturbation V_so within the degenerate subspace.\n    # These are found analytically using the coupled basis |l,s;j,mj.\n    pert_energies = []\n    if l == 0:\n        # For l=0, L=0, so L.S=0. The energy shift is zero.\n        # The total angular momentum j can only be s=1/2. \n        # The multiplicity is 2j+1 = 2.\n        pert_energies.extend([E0] * 2)\n    else:\n        # For l  0, j can be j_plus = l + 1/2 and j_minus = l - 1/2.\n        \n        # Case j = l + 1/2:\n        # Delta_E = lambda * l / 2\n        e_plus = E0 + lam * l / 2.0\n        mult_plus = int(2 * (l + 0.5) + 1)\n        pert_energies.extend([e_plus] * mult_plus)\n\n        # Case j = l - 1/2:\n        # Delta_E = -lambda * (l + 1) / 2\n        e_minus = E0 - lam * (l + 1) / 2.0\n        mult_minus = int(2 * (l - 0.5) + 1)\n        pert_energies.extend([e_minus] * mult_minus)\n    \n    # The list of perturbative energies must be sorted for comparison.\n    pert_energies = np.array(sorted(pert_energies))\n\n    # --- 2. Exact Numerical Diagonalization ---\n    # The dimension of the Hilbert space for fixed (l, s=1/2)\n    dim = 2 * (2 * l + 1)\n    \n    # The Hamiltonian matrix H = E0*I + lambda * (L.S)_matrix.\n    # We construct the matrix for L.S in the uncoupled basis |l, ml |s, ms.\n    \n    # Create the basis states and a mapping from state to index for convenience.\n    basis_states = []\n    state_to_idx = {}\n    m_s_vals = [-0.5, 0.5]\n    idx = 0\n    for ml in range(-l, l + 1):\n        for ms in m_s_vals:\n            state = (ml, ms)\n            basis_states.append(state)\n            state_to_idx[state] = idx\n            idx += 1\n            \n    # Matrix for L.S operator. It is real and symmetric.\n    L_dot_S_matrix = np.zeros((dim, dim), dtype=np.float64)\n\n    for k_col, state_ket in enumerate(basis_states):\n        ml_ket, ms_ket = state_ket\n        \n        # Diagonal part: Lz * Sz\n        L_dot_S_matrix[k_col, k_col] += ml_ket * ms_ket\n        \n        # Off-diagonal part: 0.5 * (L+S- + L-S+)\n        # S- acts on spin up (ms=0.5), turning it to spin down (ms=-0.5). Coeff=1.\n        # S+ acts on spin down (ms=-0.5), turning it to spin up (ms=0.5). Coeff=1.\n        \n        # L+S- term (acts on ket |ml, 0.5)\n        if ms_ket == 0.5 and ml_ket  l:\n            # Target \"bra\" state is |ml+1, -0.5\n            state_bra = (ml_ket + 1, -0.5)\n            k_row = state_to_idx[state_bra]\n            # Matrix element of L+\n            coeff_L_plus = np.sqrt(l * (l + 1) - ml_ket * (ml_ket + 1))\n            L_dot_S_matrix[k_row, k_col] += 0.5 * coeff_L_plus\n            \n        # L-S+ term (acts on ket |ml, -0.5)\n        if ms_ket == -0.5 and ml_ket  -l:\n            # Target \"bra\" state is |ml-1, 0.5\n            state_bra = (ml_ket - 1, 0.5)\n            k_row = state_to_idx[state_bra]\n            # Matrix element of L-\n            coeff_L_minus = np.sqrt(l * (l + 1) - ml_ket * (ml_ket - 1))\n            L_dot_S_matrix[k_row, k_col] += 0.5 * coeff_L_minus\n            \n    # The full Hamiltonian matrix\n    H_matrix = E0 * np.identity(dim) + lam * L_dot_S_matrix\n\n    # Find eigenvalues. np.linalg.eigvalsh is used for Hermitian matrices\n    # and returns sorted real eigenvalues.\n    exact_energies = np.linalg.eigvalsh(H_matrix)\n    \n    # --- 3. Compute Deviation ---\n    # Calculate the maximum absolute difference between the sorted lists of energies.\n    deviation = np.max(np.abs(exact_energies - pert_energies))\n    \n    return deviation\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n, l, lambda)\n        (0, 1, 0.0),\n        (0, 0, 0.2),\n        (0, 1, 0.5),\n        (0, 3, -0.3),\n        (2, 2, 1.0),\n        (4, 5, 0.75),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, l, lam = case\n        result = _solve_case(n, l, lam)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3607470"}, {"introduction": "A key challenge in using an independent-particle framework like the shell model is that the external potential well breaks the translational invariance of the system, leading to a spurious, unphysical motion of the nucleus's center of mass. To compute meaningful observables like the nuclear radius, this spurious motion must be removed. This practice guides you through the process of deriving and implementing the correction for the center-of-mass motion, a classic problem that has an elegant analytical solution within the harmonic oscillator model [@problem_id:3607452]. Successfully completing this exercise is a critical step toward understanding how to extract physically meaningful results from mean-field theories.", "problem": "Consider a system of $A$ nonrelativistic nucleons of mass $m$ moving independently in a spherically symmetric three-dimensional harmonic oscillator (HO) mean-field potential. The single-particle Hamiltonian is $H_{\\text{sp}} = \\frac{\\mathbf{p}^2}{2m} + \\frac{1}{2} m \\omega^2 \\mathbf{r}^2$, and the many-body Hamiltonian is the sum of independent single-particle Hamiltonians. The single-particle states are characterized by the HO quantum numbers $(n,l)$ and their major shell quantum number $N = 2n + l$. The root-mean-square (RMS) radius is defined from the mean-square radius $\\langle r^2 \\rangle$ as $\\sqrt{\\langle r^2 \\rangle}$.\n\nCenter-of-mass (COM) spuriosities arise when one computes observables like $\\langle r^2 \\rangle$ from naive sums of single-particle densities without removing the COM motion. In a HO mean-field picture with a common oscillator length parameter $b = \\sqrt{\\hbar/(m \\omega)}$ for all nucleons, the many-body dynamics can be separated into COM and intrinsic parts. The intrinsic RMS radius per nucleon must exclude COM motion.\n\nStarting only from the harmonic oscillator Hamiltonian, the definitions of the COM coordinate $\\mathbf{R}_{\\text{cm}} = \\frac{1}{A} \\sum_{i=1}^A \\mathbf{r}_i$ and the intrinsic coordinates $\\boldsymbol{\\rho}_i = \\mathbf{r}_i - \\mathbf{R}_{\\text{cm}}$, and the definition of the RMS radius, derive expressions appropriate for computing:\n- the naive mean-square matter radius per nucleon, $\\langle r^2 \\rangle_{\\text{naive}}$, obtained by averaging the single-particle $\\langle r^2 \\rangle$ over all occupied states;\n- the center-of-mass corrected intrinsic mean-square matter radius per nucleon, $\\langle r^2 \\rangle_{\\text{intr}}$, which removes the COM contribution from $\\langle r^2 \\rangle_{\\text{naive}}$.\n\nYou must then implement a program to compute, for specified test cases, the naive RMS radius $\\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$, the COM-corrected intrinsic RMS radius $\\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$, and the absolute difference between them $\\Delta = \\sqrt{\\langle r^2 \\rangle_{\\text{naive}}} - \\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$. Assume a common oscillator length $b$ for all occupied states. Express all RMS radii and differences in femtometers (fm) as floats.\n\nUse the following test suite where each case is specified by the total number of nucleons $A$, the oscillator length $b$ in femtometers (fm), and the occupation numbers for the HO major shells $N$ (where the occupation count is the total number of nucleons occupying that shell across both proton and neutron species and both spin orientations):\n\n- Case 1 (boundary condition, single particle): $A = 1$, $b = 1.70\\,\\text{fm}$, occupations $\\{N=0:1\\}$.\n- Case 2 (closed $N=0$ shell for both species): $A = 4$, $b = 1.70\\,\\text{fm}$, occupations $\\{N=0:4\\}$.\n- Case 3 (closed $N=0,1$ shells for both species): $A = 16$, $b = 1.65\\,\\text{fm}$, occupations $\\{N=0:4,\\,N=1:12\\}$.\n- Case 4 (closed $N=0,1,2$ shells for both species): $A = 40$, $b = 1.90\\,\\text{fm}$, occupations $\\{N=0:4,\\,N=1:12,\\,N=2:24\\}$.\n- Case 5 (closed $N=0,1,2,3,4$ shells for both species): $A = 140$, $b = 2.00\\,\\text{fm}$, occupations $\\{N=0:4,\\,N=1:12,\\,N=2:24,\\,N=3:40,\\,N=4:60\\}$.\n\nYour program must verify that the sum of the occupation numbers equals $A$ for each case. For each case, compute:\n- $\\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$ in fm,\n- $\\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$ in fm,\n- $\\Delta$ in fm.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes three numbers in the order specified above. For the five cases, this results in a flat list of fifteen floats: $[\\text{case1\\_naive},\\text{case1\\_intr},\\text{case1\\_delta},\\text{case2\\_naive},\\ldots,\\text{case5\\_delta}]$.", "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded, well-posed, objective, and internally consistent.\n\n### 1. Theoretical Derivation\n\nThe goal is to derive expressions for the naive mean-square matter radius per nucleon, $\\langle r^2 \\rangle_{\\text{naive}}$, and the center-of-mass (COM) corrected intrinsic mean-square matter radius per nucleon, $\\langle r^2 \\rangle_{\\text{intr}}$, for a system of $A$ independent nucleons in a common three-dimensional harmonic oscillator (HO) potential.\n\n#### 1.1. Single-Particle Expectation Value of $\\mathbf{r}^2$\n\nThe single-particle Hamiltonian for a nucleon of mass $m$ in a harmonic oscillator potential with angular frequency $\\omega$ is:\n$$\nH_{\\text{sp}} = \\frac{\\mathbf{p}^2}{2m} + \\frac{1}{2} m \\omega^2 \\mathbf{r}^2 = T + V\n$$\nThe energy eigenvalues of this Hamiltonian depend only on the major shell quantum number $N = 2n + l$, where $n$ is the radial quantum number and $l$ is the orbital angular momentum quantum number. The energy for a state in shell $N$ is:\n$$\nE_N = \\left(N + \\frac{3}{2}\\right) \\hbar \\omega\n$$\nAccording to the virial theorem for a potential of the form $V \\propto r^k$, the expectation values of the kinetic energy $\\langle T \\rangle$ and potential energy $\\langle V \\rangle$ are related by $2\\langle T \\rangle = k\\langle V \\rangle$. For the harmonic oscillator, the potential is proportional to $r^2$, so $k=2$, which implies $\\langle T \\rangle = \\langle V \\rangle$.\n\nThe total energy of a state is the sum of the expectation values of kinetic and potential energy, $E_N = \\langle T \\rangle + \\langle V \\rangle$. Thus, we have $E_N = 2\\langle V \\rangle$. Substituting the expression for the potential energy:\n$$\nE_N = 2 \\left\\langle \\frac{1}{2} m \\omega^2 \\mathbf{r}^2 \\right\\rangle = m \\omega^2 \\langle \\mathbf{r}^2 \\rangle\n$$\nSolving for the expectation value of the squared radius, $\\langle \\mathbf{r}^2 \\rangle_N$, for a single particle in a state corresponding to the major shell $N$:\n$$\n\\langle \\mathbf{r}^2 \\rangle_N = \\frac{E_N}{m \\omega^2} = \\frac{(N + 3/2)\\hbar\\omega}{m \\omega^2} = \\left(N + \\frac{3}{2}\\right) \\frac{\\hbar}{m\\omega}\n$$\nThe problem defines the oscillator length parameter as $b = \\sqrt{\\hbar/(m \\omega)}$, which means $b^2 = \\hbar/(m\\omega)$. Substituting this into the expression for $\\langle \\mathbf{r}^2 \\rangle_N$ yields:\n$$\n\\langle \\mathbf{r}^2 \\rangle_N = \\left(N + \\frac{3}{2}\\right) b^2\n$$\n\n#### 1.2. Naive Mean-Square Radius\n\nThe naive mean-square matter radius is calculated by averaging the single-particle expectation values $\\langle \\mathbf{r}^2 \\rangle_N$ over all $A$ occupied nucleon states. The operator for the total squared radius of the system is $\\sum_{i=1}^A \\mathbf{r}_i^2$. In an independent particle model, its expectation value is the sum of single-particle expectation values: $\\langle \\sum_{i=1}^A \\mathbf{r}_i^2 \\rangle = \\sum_{i \\in \\text{occ}} \\langle \\mathbf{r}^2 \\rangle_i$.\n\nThe mean-square radius per nucleon is this total value divided by $A$:\n$$\n\\langle r^2 \\rangle_{\\text{naive}} = \\frac{1}{A} \\sum_{i \\in \\text{occ}} \\langle \\mathbf{r}^2 \\rangle_i\n$$\nLet $d_N$ be the number of nucleons occupying states in the major shell $N$. The sum can be grouped by shells:\n$$\n\\langle r^2 \\rangle_{\\text{naive}} = \\frac{1}{A} \\sum_{N} d_N \\langle \\mathbf{r}^2 \\rangle_N = \\frac{1}{A} \\sum_{N} d_N \\left(N + \\frac{3}{2}\\right) b^2\n$$\nThis is the formula for the naive mean-square radius. The naive root-mean-square (RMS) radius is $\\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$.\n\n#### 1.3. Intrinsic Mean-Square Radius (COM Correction)\n\nThe positions of the nucleons $\\mathbf{r}_i$ can be expressed in terms of the center-of-mass coordinate $\\mathbf{R}_{\\text{cm}}$ and intrinsic coordinates $\\boldsymbol{\\rho}_i$:\n$$\n\\mathbf{R}_{\\text{cm}} = \\frac{1}{A} \\sum_{i=1}^A \\mathbf{r}_i \\quad \\text{and} \\quad \\boldsymbol{\\rho}_i = \\mathbf{r}_i - \\mathbf{R}_{\\text{cm}}\n$$\nThe sum of squares of the particle coordinates can be related to the intrinsic coordinates and the COM coordinate. We start with $\\mathbf{r}_i = \\boldsymbol{\\rho}_i + \\mathbf{R}_{\\text{cm}}$ and sum over all particles:\n$$\n\\sum_{i=1}^A \\mathbf{r}_i^2 = \\sum_{i=1}^A (\\boldsymbol{\\rho}_i + \\mathbf{R}_{\\text{cm}})^2 = \\sum_{i=1}^A (\\boldsymbol{\\rho}_i^2 + 2\\boldsymbol{\\rho}_i \\cdot \\mathbf{R}_{\\text{cm}} + \\mathbf{R}_{\\text{cm}}^2) = \\left(\\sum_{i=1}^A \\boldsymbol{\\rho}_i^2\\right) + 2\\mathbf{R}_{\\text{cm}} \\cdot \\left(\\sum_{i=1}^A \\boldsymbol{\\rho}_i\\right) + A\\mathbf{R}_{\\text{cm}}^2\n$$\nBy definition of the intrinsic coordinates, their sum is zero: $\\sum_{i=1}^A \\boldsymbol{\\rho}_i = \\sum_{i=1}^A (\\mathbf{r}_i - \\mathbf{R}_{\\text{cm}}) = A\\mathbf{R}_{\\text{cm}} - A\\mathbf{R}_{\\text{cm}} = 0$. Thus, the cross-term vanishes, and we obtain the fundamental relation:\n$$\n\\sum_{i=1}^A \\mathbf{r}_i^2 = \\sum_{i=1}^A \\boldsymbol{\\rho}_i^2 + A\\mathbf{R}_{\\text{cm}}^2\n$$\nTaking the expectation value of this operator equation:\n$$\n\\left\\langle \\sum_{i=1}^A \\mathbf{r}_i^2 \\right\\rangle = \\left\\langle \\sum_{i=1}^A \\boldsymbol{\\rho}_i^2 \\right\\rangle + \\left\\langle A\\mathbf{R}_{\\text{cm}}^2 \\right\\rangle\n$$\nThe total Hamiltonian for $A$ independent nucleons in a common HO potential can be exactly separated into a part describing the COM motion and a part describing the intrinsic motion: $H = H_{\\text{cm}} + H_{\\text{intr}}$. The COM Hamiltonian is that of a single particle of mass $Am$ in the same oscillator potential:\n$$\nH_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2(Am)} + \\frac{1}{2}(Am)\\omega^2 \\mathbf{R}_{\\text{cm}}^2\n$$\nwhere $\\mathbf{P}_{\\text{cm}} = \\sum_i \\mathbf{p}_i$. The ground state of the many-body system corresponds to the COM being in its own ground state, which is an $N=0$ state. The energy of this state is $E_{\\text{cm},0} = (3/2)\\hbar\\omega$. Using the same virial theorem logic as for the single-particle case, the expectation value of the COM potential energy is half its total energy:\n$$\n\\left\\langle \\frac{1}{2}(Am)\\omega^2 \\mathbf{R}_{\\text{cm}}^2 \\right\\rangle = \\frac{1}{2} E_{\\text{cm},0} = \\frac{1}{2} \\left(\\frac{3}{2}\\hbar\\omega\\right) = \\frac{3}{4}\\hbar\\omega\n$$\nFrom this, we find the expectation value $\\langle \\mathbf{R}_{\\text{cm}}^2 \\rangle$:\n$$\n\\langle \\mathbf{R}_{\\text{cm}}^2 \\rangle = \\frac{3\\hbar\\omega}{2(Am)\\omega^2} = \\frac{3}{2A} \\frac{\\hbar}{m\\omega} = \\frac{3}{2A} b^2\n$$\nSubstituting this back into the expectation value equation:\n$$\nA \\langle r^2 \\rangle_{\\text{naive}} = A \\langle r^2 \\rangle_{\\text{intr}} + A \\left( \\frac{3}{2A} b^2 \\right) = A \\langle r^2 \\rangle_{\\text{intr}} + \\frac{3}{2} b^2\n$$\nDividing by $A$, we get the relationship between the per-nucleon mean-square radii:\n$$\n\\langle r^2 \\rangle_{\\text{naive}} = \\langle r^2 \\rangle_{\\text{intr}} + \\frac{3}{2A} b^2\n$$\nSolving for the intrinsic mean-square radius gives the desired correction formula:\n$$\n\\langle r^2 \\rangle_{\\text{intr}} = \\langle r^2 \\rangle_{\\text{naive}} - \\frac{3}{2A} b^2\n$$\nThe intrinsic RMS radius is $\\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$.\n\n### 2. Algorithmic Design\n\nThe program will implement the derived formulas for each test case provided.\n\n1.  **Input Data**: The test cases consist of the total nucleon number $A$, the oscillator length $b$ in femtometers (fm), and a dictionary of occupations $\\{N: d_N, \\ldots\\}$, where $d_N$ is the number of nucleons in the major shell $N$.\n\n2.  **Validation**: For each test case, the program will first verify that the sum of the occupation numbers equals the given nucleon number $A$, i.e., $\\sum_N d_N = A$.\n\n3.  **Calculation of Naive Radius**:\n    a.  Compute the sum $S = \\sum_N d_N (N + 3/2)$ over all provided occupations.\n    b.  Calculate the naive mean-square radius using the formula $\\langle r^2 \\rangle_{\\text{naive}} = \\frac{S}{A} b^2$.\n    c.  Compute the naive RMS radius: $R_{\\text{naive}} = \\sqrt{\\langle r^2 \\rangle_{\\text{naive}}}$.\n\n4.  **Calculation of Intrinsic Radius**:\n    a.  Calculate the intrinsic mean-square radius using the correction formula: $\\langle r^2 \\rangle_{\\text{intr}} = \\langle r^2 \\rangle_{\\text{naive}} - \\frac{3 b^2}{2 A}$.\n    b.  Compute the intrinsic RMS radius: $R_{\\text{intr}} = \\sqrt{\\langle r^2 \\rangle_{\\text{intr}}}$.\n\n5.  **Calculation of Difference**: Compute the absolute difference $\\Delta = R_{\\text{naive}} - R_{\\text{intr}}$.\n\n6.  **Output**: The three computed values ($R_{\\text{naive}}$, $R_{\\text{intr}}$, $\\Delta$) for each test case will be collected into a single flat list. This list will be formatted into the required comma-separated string enclosed in square brackets.\n\nThis procedure will be applied to all five test cases to generate the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the naive and intrinsic RMS radii for nuclei in the harmonic oscillator shell model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, b, occupations_dict)\n    # A: total number of nucleons\n    # b: oscillator length in fm\n    # occupations_dict: {major_shell_N: nucleon_count_d_N}\n    test_cases = [\n        (1, 1.70, {0: 1}),\n        (4, 1.70, {0: 4}),\n        (16, 1.65, {0: 4, 1: 12}),\n        (40, 1.90, {0: 4, 1: 12, 2: 24}),\n        (140, 2.00, {0: 4, 1: 12, 2: 24, 3: 40, 4: 60})\n    ]\n\n    results = []\n    \n    for A, b, occupations in test_cases:\n        # Step 1: Verify that the sum of occupation numbers equals A.\n        if sum(occupations.values()) != A:\n            raise ValueError(f\"Inconsistent data for A={A}: sum of occupations is {sum(occupations.values())}\")\n        \n        # Step 2: Calculate the sum S = sum[d_N * (N + 3/2)] over all shells.\n        # This is a key intermediate quantity for the naive mean-square radius.\n        s_val = 0.0\n        for N, d_N in occupations.items():\n            s_val += d_N * (N + 1.5)\n            \n        b_squared = b**2\n        \n        # Step 3: Calculate the naive mean-square radius per nucleon.\n        # r^2_naive = (b^2 / A) * S\n        r2_naive = (b_squared / A) * s_val\n        \n        # Step 4: Calculate the COM-corrected intrinsic mean-square radius per nucleon.\n        # r^2_intr = r^2_naive - (3 * b^2) / (2 * A)\n        r2_intr = r2_naive - (1.5 * b_squared) / A\n        \n        # Ensure that the intrinsic radius squared is non-negative before taking the square root.\n        # For a single particle (A=1), r2_intr should be exactly 0.\n        if r2_intr  0 and np.isclose(r2_intr, 0):\n            r2_intr = 0.0\n\n        if r2_intr  0:\n            raise ValueError(f\"Calculated intrinsic r^2 is negative ({r2_intr}) for A={A}, b={b}, occupations={occupations}\")\n\n        # Step 5: Compute the RMS radii by taking the square root.\n        rms_naive = np.sqrt(r2_naive)\n        rms_intr = np.sqrt(r2_intr)\n        \n        # Step 6: Compute the absolute difference.\n        delta = rms_naive - rms_intr\n        \n        # Step 7: Append the three results for the current case.\n        results.extend([rms_naive, rms_intr, delta])\n\n    # Final print statement in the exact required format.\n    # Create a comma-separated string of the flattened list of results.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3607452"}]}