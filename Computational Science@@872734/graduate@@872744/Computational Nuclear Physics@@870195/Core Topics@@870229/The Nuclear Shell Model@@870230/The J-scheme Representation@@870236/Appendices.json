{"hands_on_practices": [{"introduction": "The foundation of the J-scheme is the construction of many-body basis states that are simultaneous eigenstates of the total angular momentum operator $\\hat{J}^2$ and respect fermionic antisymmetry. This practice provides a concrete example of this construction for a four-nucleon system. By building states from coupled pairs and calculating their overlap matrix, you will gain hands-on experience with the algebraic machinery of angular momentum recoupling and see how Wigner $9j$ symbols naturally arise to enforce the Pauli exclusion principle between nucleons in different pairs [@problem_id:3602884].", "problem": "Consider four identical nucleons restricted to a single orbital with total single-particle angular momentum $j \\geq \\frac{5}{2}$, so that the total angular-momentum $J=0$ subspace has dimension two (seniority $v=0$ and $v=4$). Work in the total-angular-momentum coupling representation (the $J$-scheme). Define the normalized two-fermion pair creation operator\n$$\nA^{\\dagger}_{J M} \\equiv \\frac{1}{\\sqrt{2}} \\sum_{m_{1},m_{2}} \\langle j m_{1}\\, j m_{2} \\mid J M \\rangle\\, a^{\\dagger}_{j m_{1}} a^{\\dagger}_{j m_{2}},\n$$\nand construct the antisymmetrized four-fermion states by coupling two identical pairs to total $J=0$,\n$$\n\\lvert \\Phi_{J_{p}} \\rangle \\equiv \\bigl[ A^{\\dagger}_{J_{p}} \\times A^{\\dagger}_{J_{p}} \\bigr]_{00} \\lvert 0 \\rangle,\n$$\nwith even pair angular momenta $J_{p} \\in \\{0,2\\}$, where $[\\,\\cdot \\times \\cdot\\,]_{00}$ denotes coupling to total $J=0$, $M=0$, and $\\lvert 0 \\rangle$ is the particle vacuum.\n\n(a) Starting from the angular-momentum coupling algebra and fermionic anticommutation relations, derive the general expression for the overlap matrix element $\\langle \\Phi_{J_{p}'} \\mid \\Phi_{J_{p}} \\rangle$ in terms of a recoupling coefficient, expressing the exchange (non-orthogonality) contribution through a Wigner $9j$ symbol that depends on $j$, $J_{p}$, $J_{p}'$, and the total $J=0$.\n\n(b) Use part (a) to argue that the two states $\\{ \\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle \\}$ span the $J=0$ four-particle subspace (completeness within this sector) and can be orthonormalized by a $2\\times 2$ Gram-Schmidt transformation. Provide the explicit condition on the overlap that guarantees positive-definiteness of the Gram matrix.\n\n(c) Provide the closed-form analytic expression, as a function of $j$, for the off-diagonal overlap element $\\langle \\Phi_{0} \\mid \\Phi_{2} \\rangle$ in terms of a single Wigner $9j$ symbol. Your final answer must be a single closed-form analytic expression. No numerical evaluation is required, and no rounding is needed.", "solution": "The problem asks for the analysis of four-particle states in a single $j$-shell, constructed by coupling pairs of identical nucleons. We must first validate the problem statement.\n\n### Step 1: Extract Givens\n-   **System**: Four identical nucleons in a single orbital with single-particle angular momentum $j$.\n-   **Constraint**: $j \\geq \\frac{5}{2}$.\n-   **Subspace**: The total angular momentum $J=0$ subspace is two-dimensional, spanned by states of seniority $v=0$ and $v=4$.\n-   **Pair creator**: $A^{\\dagger}_{J M} \\equiv \\frac{1}{\\sqrt{2}} \\sum_{m_{1},m_{2}} \\langle j m_{1}\\, j m_{2} \\mid J M \\rangle\\, a^{\\dagger}_{j m_{1}} a^{\\dagger}_{j m_{2}}$. For identical fermions, this is non-zero only for even $J$.\n-   **Four-particle states**: $\\lvert \\Phi_{J_{p}} \\rangle \\equiv \\bigl[ A^{\\dagger}_{J_{p}} \\times A^{\\dagger}_{J_{p}} \\bigr]_{00} \\lvert 0 \\rangle$, where $J_{p} \\in \\{0,2\\}$ is the angular momentum of the identical pairs. The notation $[\\,\\cdot \\times \\cdot\\,]_{00}$ denotes coupling to total angular momentum $J=0, M=0$.\n-   **Vacuum**: $\\lvert 0 \\rangle$ is the particle vacuum.\n-   **Part (a)**: Derive the general expression for the overlap $\\langle \\Phi_{J_{p}'} \\mid \\Phi_{J_{p}} \\rangle$ with the exchange contribution expressed via a Wigner $9j$ symbol.\n-   **Part (b)**: Argue that $\\{\\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{2} \\rangle\\}$ span the $J=0$ subspace and can be orthonormalized, and provide the condition for this.\n-   **Part (c)**: Provide the closed-form expression for $\\langle \\Phi_{0} \\mid \\Phi_{2} \\rangle$ in terms of a single Wigner $9j$ symbol.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the nuclear shell model and the theory of angular momentum in quantum mechanics. The definitions of operators and states are standard in this field. The constraint $j \\geq \\frac{5}{2}$ is appropriate, as for smaller $j$ values, the structure of the four-particle $J=0$ space is different (e.g., for $j=3/2$, there is only one $J=0$ state). The problem is well-posed, objective, and contains sufficient information for a rigorous solution. No scientific flaws, contradictions, or ambiguities are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### (a) Derivation of the Overlap Matrix Element\n\nThe state $\\lvert \\Phi_{J_p} \\rangle$ is constructed by coupling two identical fermion pairs, each with angular momentum $J_p$, to a total angular momentum of $J=0$. Explicitly,\n$$\n\\lvert \\Phi_{J_p} \\rangle = \\sum_{M_p} \\langle J_p M_p J_p (-M_p) \\mid 00 \\rangle A^{\\dagger}_{J_p M_p} A^{\\dagger}_{J_p, -M_p} \\lvert 0 \\rangle = \\frac{1}{\\sqrt{2J_p+1}} \\sum_{M_p} (-1)^{J_p-M_p} A^{\\dagger}_{J_p M_p} A^{\\dagger}_{J_p, -M_p} \\lvert 0 \\rangle.\n$$\nThese states are not normalized. The overlap matrix element is $\\langle \\Phi_{J_p'} \\mid \\Phi_{J_p} \\rangle$. These states represent four-particle states, but the expression does not make the full antisymmetry between particles in different pairs manifest. A full calculation involves considering particle exchanges between the pairs, which introduces a \"recoupling\" term in addition to the \"direct\" term. The direct term arises from treating the pair operators as if they were bosons, while the exchange term corrects for their fermionic substructure.\n\nThe complete overlap for these unnormalized states is a standard result in shell model theory. It can be derived by expanding the pair operators into single-particle operators and using anticommutation relations, or more elegantly through recoupling algebra. The result is given by:\n$$\n\\langle \\Phi_{J_p'} \\mid \\Phi_{J_p} \\rangle = 2\\delta_{J_p, J_p'} + 4\\sqrt{(2J_p+1)(2J_p'+1)} \\begin{Bmatrix} j & j & J_p \\\\ j & j & J_p' \\\\ J_p & J_p' & 0 \\end{Bmatrix}.\n$$\nHere, $\\begin{Bmatrix} \\cdot & \\cdot & \\cdot \\\\ \\cdot & \\cdot & \\cdot \\\\ \\cdot & \\cdot & \\cdot \\end{Bmatrix}$ is the Wigner $9j$ symbol.\n\nThe first term, $2\\delta_{J_p, J_p'}$, is the direct term. It comes from the two ways of contracting the operators as if they were simple bosons: $\\langle 0 \\rvert A_{J_p'} A_{J_p'} A^{\\dagger}_{J_p} A^{\\dagger}_{J_p} \\lvert 0 \\rangle \\to \\langle A' A^{\\dagger} \\rangle \\langle A' A^{\\dagger} \\rangle + \\langle A' A^{\\dagger} \\rangle \\langle A' A^{\\dagger} \\rangle$.\nThe second term is the exchange contribution, arising from the Pauli exclusion principle acting between fermions belonging to different pairs. This term involves recoupling the angular momenta of the four particles from a $( (12)J_p', (34)J_p' )0$ scheme to a $( (12)J_p, (34)J_p )0$ scheme, but after a particle permutation, for instance $P_{13}$. The recoupling from a partition like $((12), (34))$ to $((13), (24))$ is governed by the $9j$ symbol. The specific $9j$ symbol in the formula captures the geometry of this recoupling for the total angular momentum $J=0$ case we are considering.\n\n### (b) Spanning the Subspace and Orthonormalization\n\nThe problem states that for $j \\geq \\frac{5}{2}$, the four-particle $J=0$ subspace has dimension two. The states are classified by seniority $v$, which is the number of particles not in pairs coupled to angular momentum zero. The two basis states are the seniority $v=0$ state and the seniority $v=4$ state.\n1.  **The state $\\lvert \\Phi_0 \\rangle$**: This state is constructed from pairs with $J_p=0$. The operator $A^{\\dagger}_{00}$ creates a pair of particles with total angular momentum $0$. The state $\\lvert \\Phi_0 \\rangle \\propto (A^{\\dagger}_{00})^2 \\lvert 0 \\rangle$ is, by definition, the state of seniority $v=0$.\n2.  **The state $\\lvert \\Phi_2 \\rangle$**: This state is constructed from pairs with $J_p=2$. Since it is not built exclusively from $J_p=0$ pairs, it is not a pure seniority $v=0$ state. It can be shown that this state is a linear combination of the seniority $v=0$ and $v=4$ basis states.\n\nSince $\\lvert \\Phi_0 \\rangle$ is the pure $v=0$ state and $\\lvert \\Phi_2 \\rangle$ has components of both $v=0$ and $v=4$, the two states are linearly independent. As we have two linearly independent states in a two-dimensional space, they form a basis and therefore span the space.\n\nFor any set of linearly independent vectors, they can be orthonormalized using a procedure like the Gram-Schmidt process. This is possible if and only if the Gram matrix of inner products, $G$, is positive-definite. The Gram matrix is\n$$\nG = \\begin{pmatrix} \\langle \\Phi_0 \\mid \\Phi_0 \\rangle & \\langle \\Phi_0 \\mid \\Phi_2 \\rangle \\\\ \\langle \\Phi_2 \\mid \\Phi_0 \\rangle & \\langle \\Phi_2 \\mid \\Phi_2 \\rangle \\end{pmatrix}.\n$$\nPositive-definiteness requires the diagonal elements to be positive ($G_{ii} > 0$) and the determinant to be positive ($\\det(G) > 0$).\nSince the norm of any non-zero state vector is positive, $\\langle \\Phi_{J_p} \\mid \\Phi_{J_p} \\rangle > 0$. The condition for orthonormalization being possible therefore reduces to requiring the determinant to be positive:\n$$\n\\det(G) = \\langle \\Phi_0 \\mid \\Phi_0 \\rangle \\langle \\Phi_2 \\mid \\Phi_2 \\rangle - |\\langle \\Phi_0 \\mid \\Phi_2 \\rangle|^2 > 0.\n$$\nThis is the strict form of the Cauchy-Schwarz inequality, which holds if and only if the vectors $\\lvert \\Phi_0 \\rangle$ and $\\lvert \\Phi_2 \\rangle$ are linearly independent. As we argued from seniority, they are, so the condition is satisfied.\n\n### (c) Closed-Form Expression for $\\langle \\Phi_{0} \\mid \\Phi_{2} \\rangle$\n\nWe use the general formula derived in part (a) for the specific off-diagonal case with $J_p' = 0$ and $J_p = 2$.\n$$\n\\langle \\Phi_{0} \\mid \\Phi_{2} \\rangle = 2\\delta_{0, 2} + 4\\sqrt{(2(0)+1)(2(2)+1)} \\begin{Bmatrix} j & j & 0 \\\\ j & j & 2 \\\\ 0 & 2 & 0 \\end{Bmatrix}.\n$$\nThe Kronecker delta $\\delta_{0,2}$ is $0$. The term under the square root is $(1)(5)=5$.\nTherefore, the overlap is:\n$$\n\\langle \\Phi_{0} \\mid \\Phi_{2} \\rangle = 4\\sqrt{5} \\begin{Bmatrix} j & j & 0 \\\\ j & j & 2 \\\\ 0 & 2 & 0 \\end{Bmatrix}.\n$$\nThe problem asks for the answer in terms of a single Wigner $9j$ symbol. This expression meets that requirement. No further simplification of the $9j$ symbol is needed.", "answer": "$$\n\\boxed{4\\sqrt{5} \\begin{Bmatrix} j & j & 0 \\\\ j & j & 2 \\\\ 0 & 2 & 0 \\end{Bmatrix}}\n$$", "id": "3602884"}, {"introduction": "In practical computations, the theoretical elegance of the J-scheme relies on the correct implementation of complex angular momentum recoupling, which can be a source of error. This hands-on exercise addresses a critical aspect of quality control: verifying that a constructed Hamiltonian matrix, $H$, truly respects rotational invariance. You will develop a diagnostic tool to test if $H$ commutes with the matrix representation of the operator $\\hat{J}^2$, and learn to trace violations of this symmetry back to specific problematic couplings in the Hamiltonian, an essential skill for debugging shell-model codes [@problem_id:3602898].", "problem": "Consider the total angular momentum operator $\\hat{J}$ in a rotationally invariant nuclear many-body Hamiltonian $\\hat{H}$. In a total angular momentum-coupled basis (the $J$-scheme representation), exact rotational invariance implies $[\\hat{H},\\hat{J}^2]=\\hat{0}$. In a basis labeled by total angular momentum quantum numbers $\\{J_i\\}_{i=0}^{N-1}$ where $i$ indexes the basis states, the matrix of $\\hat{J}^2$ is diagonal with entries $J_i(J_i+1)$. Suppose you are given a real symmetric matrix $H \\in \\mathbb{R}^{N \\times N}$ representing the Hamiltonian assembled from one-body and two-body matrix elements after recoupling with Wigner $6j$ symbols, and a list of total angular momentum labels $J_i$ for each basis state. Numerical inconsistencies (for example from incorrect or inconsistent Wigner $6j$ coefficients) can introduce unphysical total angular momentum mixing, which manifests as a nonzero commutator $[H,\\hat{J}^2]$.\n\nYour task is to implement a diagnostic that, for each provided test case, does the following from first principles:\n- Construct the diagonal matrix $D \\in \\mathbb{R}^{N \\times N}$ with $D_{ii} = J_i(J_i+1)$.\n- Form the commutator matrix $C = [H,D] = HD - DH$ using the definition of matrix multiplication and the definition of a commutator as $[A,B] = AB - BA$.\n- Compute the Frobenius norm $\\|C\\|_F = \\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} |C_{ij}|^2}$.\n- Decide whether the Hamiltonian exhibits unphysical total angular momentum mixing, defined here as $\\|C\\|_F > \\varepsilon_{\\text{norm}}$ for a given threshold $\\varepsilon_{\\text{norm}}$.\n- Backtrace the dominant contributions to the violation by attributing them to specific off-diagonal pairs $(i,j)$ with $i<j$ and $J_i \\neq J_j$, ranked by the magnitude $|C_{ij}|$. Return up to $K$ such index pairs whose magnitudes satisfy $|C_{ij}| \\ge \\varepsilon_{\\text{elem}}$, sorted by descending $|C_{ij}|$. Interpret these pairs as the suggested fixes: zero these couplings or recompute the associated recoupling steps (for example, re-evaluate the Wigner $6j$ contributions) for those specific couplings.\n\nYou must implement the above without using any pre-derived shortcut formulas not justified from the definitions, starting from the facts that (i) a rotationally invariant Hamiltonian commutes with $\\hat{J}^2$, (ii) the $J$-scheme representation diagonalizes $\\hat{J}^2$ with eigenvalues $J(J+1)$, and (iii) the Frobenius norm is given by the square root of the sum of squares of all matrix entries. Angles do not appear, and no physical units are needed.\n\nFor each test case below, you are given $N$, the list $\\{J_i\\}$, the symmetric matrix $H$, the thresholds $\\varepsilon_{\\text{norm}}$ and $\\varepsilon_{\\text{elem}}$, and the integer $K$. Indices in all outputs must be $0$-based integers. Your program’s output for each test case must be a list with three entries: $[\\|C\\|_F \\text{ rounded to } 6 \\text{ decimals},\\ \\text{boolean flag},\\ \\text{list of offending index pairs}]$. Aggregate the results of all test cases into a single list and print that list on a single line as a comma-separated list enclosed in square brackets.\n\nTest suite:\n\n- Test case $1$ (happy path, exact block-diagonality in $J$):\n  - $N = 5$\n  - $J = [0, 0, 1, 1, 2]$\n  - $H = \\begin{bmatrix}\n  1.0 & 0.05 & 0 & 0 & 0 \\\\\n  0.05 & 1.2 & 0 & 0 & 0 \\\\\n  0 & 0 & 0.8 & -0.03 & 0 \\\\\n  0 & 0 & -0.03 & 1.1 & 0 \\\\\n  0 & 0 & 0 & 0 & 2.0\n  \\end{bmatrix}$\n  - $\\varepsilon_{\\text{norm}} = 10^{-10}$\n  - $\\varepsilon_{\\text{elem}} = 10^{-10}$\n  - $K = 3$\n\n- Test case $2$ (single small inconsistency, e.g., due to one incorrect Wigner $6j$ recoupling entry):\n  - $N = 5$\n  - $J = [0, 0, 1, 1, 2]$\n  - $H$ is the same as in test case $1$ except $H_{0,2} = H_{2,0} = 10^{-3}$:\n  - $H = \\begin{bmatrix}\n  1.0 & 0.05 & 0.001 & 0 & 0 \\\\\n  0.05 & 1.2 & 0 & 0 & 0 \\\\\n  0.001 & 0 & 0.8 & -0.03 & 0 \\\\\n  0 & 0 & -0.03 & 1.1 & 0 \\\\\n  0 & 0 & 0 & 0 & 2.0\n  \\end{bmatrix}$\n  - $\\varepsilon_{\\text{norm}} = 10^{-5}$\n  - $\\varepsilon_{\\text{elem}} = 10^{-4}$\n  - $K = 2$\n\n- Test case $3$ (boundary case with tiny numerical noise off-block, should not flag mixing):\n  - $N = 4$\n  - $J = [1, 1, 1, 2]$\n  - $H = \\begin{bmatrix}\n  0.9 & 0.02 & 0.01 & 3\\times 10^{-8} \\\\\n  0.02 & 1.0 & 0.015 & -2\\times 10^{-8} \\\\\n  0.01 & 0.015 & 1.1 & 1\\times 10^{-8} \\\\\n  3\\times 10^{-8} & -2\\times 10^{-8} & 1\\times 10^{-8} & 1.5\n  \\end{bmatrix}$\n  - $\\varepsilon_{\\text{norm}} = 10^{-6}$\n  - $\\varepsilon_{\\text{elem}} = 10^{-7}$\n  - $K = 3$\n\n- Test case $4$ (severe inconsistency with multiple large off-block couplings):\n  - $N = 6$\n  - $J = [0, 1, 1, 2, 2, 3]$\n  - $H = \\begin{bmatrix}\n  1.0 & 0 & 0 & 0.1 & 0 & 0 \\\\\n  0 & 1.2 & 0.04 & 0 & 0 & 0.02 \\\\\n  0 & 0.04 & 1.15 & 0 & -0.03 & 0 \\\\\n  0.1 & 0 & 0 & 2.0 & 0.05 & 0 \\\\\n  0 & 0 & -0.03 & 0.05 & 2.1 & 0 \\\\\n  0 & 0.02 & 0 & 0 & 0 & 2.5\n  \\end{bmatrix}$\n  - $\\varepsilon_{\\text{norm}} = 10^{-3}$\n  - $\\varepsilon_{\\text{elem}} = 10^{-2}$\n  - $K = 2$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, return a list with three entries: the Frobenius norm $\\|C\\|_F$ rounded to $6$ decimals, a boolean that is $\\text{True}$ if $\\|C\\|_F > \\varepsilon_{\\text{norm}}$ and $\\text{False}$ otherwise, and a list of up to $K$ offending index pairs $(i,j)$ with $i<j$ that meet $|C_{ij}| \\ge \\varepsilon_{\\text{elem}}$, sorted by decreasing $|C_{ij}|$. Use $0$-based indices for all pairs. Interpret the returned index pairs as the suggested fixes: enforce rotational invariance by zeroing those couplings or by recomputing the corresponding recoupling coefficients (for example, verifying Wigner $6j$ symmetry and triangle relations) for those specific entries.", "solution": "The problem requires the implementation of a numerical diagnostic to verify the rotational invariance of a given nuclear Hamiltonian matrix $H$. The foundation of this diagnostic rests upon a fundamental principle of quantum mechanics: in a system with rotational symmetry, the Hamiltonian operator $\\hat{H}$ must commute with the operator for the square of the total angular momentum, $\\hat{J}^2$. Mathematically, this is expressed as the commutator being zero:\n$$\n[\\hat{H}, \\hat{J}^2] = \\hat{H}\\hat{J}^2 - \\hat{J}^2\\hat{H} = \\hat{0}\n$$\nThe problem is formulated in the so-called $J$-scheme representation. This is a basis of states $\\{|i\\rangle\\}_{i=0}^{N-1}$ that are eigenstates of $\\hat{J}^2$. Each basis state $|i\\rangle$ is associated with a total angular momentum quantum number $J_i$. In this basis, the operator $\\hat{J}^2$ is represented by a diagonal matrix, which we denote as $D$. The diagonal elements of this matrix are the eigenvalues of $\\hat{J}^2$, given by the well-known formula:\n$$\nD_{ij} = \\langle i | \\hat{J}^2 | j \\rangle = \\delta_{ij} J_i(J_i+1)\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. The given Hamiltonian matrix $H$ has elements $H_{ij} = \\langle i | \\hat{H} | j \\rangle$.\n\nOur task is to check if the matrix representation of the commutator vanishes, i.e., if $[H, D] = 0$. Deviations from zero in the matrix $C = [H, D]$ indicate that the provided Hamiltonian matrix $H$ does not perfectly respect rotational symmetry, a situation that can arise from numerical errors in its construction, for instance, during the complex angular momentum recoupling calculations involving Wigner $6j$ symbols.\n\nThe algorithmic procedure is as follows:\n\n1.  **Construct the Commutator Matrix $C$**: We are asked to derive the procedure from first principles. The commutator is defined as $C = HD - DH$. The element $(i,j)$ of the matrix product $HD$ is given by:\n    $$\n    (HD)_{ij} = \\sum_{k=0}^{N-1} H_{ik} D_{kj}\n    $$\n    Since $D$ is diagonal with $D_{kj} = \\delta_{kj} J_j(J_j+1)$, the sum simplifies:\n    $$\n    (HD)_{ij} = \\sum_{k=0}^{N-1} H_{ik} \\delta_{kj} J_j(J_j+1) = H_{ij} J_j(J_j+1)\n    $$\n    Similarly, for the product $DH$:\n    $$\n    (DH)_{ij} = \\sum_{k=0}^{N-1} D_{ik} H_{kj} = \\sum_{k=0}^{N-1} \\delta_{ik} J_i(J_i+1) H_{kj} = J_i(J_i+1) H_{ij}\n    $$\n    Combining these results, the element $C_{ij}$ of the commutator matrix is:\n    $$\n    C_{ij} = (HD)_{ij} - (DH)_{ij} = H_{ij} J_j(J_j+1) - J_i(J_i+1) H_{ij} = H_{ij} \\left( J_j(J_j+1) - J_i(J_i+1) \\right)\n    $$\n    This formula is central to our algorithm. It shows that an element $C_{ij}$ is non-zero only if the corresponding Hamiltonian element $H_{ij}$ is non-zero *and* the angular momenta of the coupled states are different ($J_i \\neq J_j$). Couplings within a sub-block of constant $J$ ($H_{ij}$ with $J_i=J_j$) do not contribute to the commutator, which is physically correct.\n\n2.  **Quantify the Violation**: To measure the total \"size\" of the symmetry violation, we compute the Frobenius norm of the commutator matrix $C$. The Frobenius norm is defined as the square root of the sum of the squares of the absolute values of its elements:\n    $$\n    \\|C\\|_F = \\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} |C_{ij}|^2}\n    $$\n    A perfectly symmetric Hamiltonian yields $\\|C\\|_F = 0$. A small, non-zero norm might be attributed to floating-point inaccuracies, whereas a large norm suggests a significant, unphysical violation. The problem defines a violation as occurring when $\\|C\\|_F > \\varepsilon_{\\text{norm}}$, where $\\varepsilon_{\\text{norm}}$ is a given tolerance threshold.\n\n3.  **Identify and Rank Violations**: To assist in debugging the Hamiltonian, we must pinpoint the specific elements of $H$ that are the primary sources of the violation. From the expression for $C_{ij}$, the magnitude $|C_{ij}|$ is directly proportional to $|H_{ij}|$ for a given pair of states $(i,j)$ with $J_i \\neq J_j$. Therefore, the largest contributions to the norm come from the largest $|C_{ij}|$ values, which in turn point to the most problematic $H_{ij}$ couplings.\n    The backtracing procedure involves:\n    - Iterating through all unique off-diagonal pairs of indices $(i,j)$ with $i<j$. Since the Hamiltonian matrix $H$ is symmetric ($H_{ij}=H_{ji}$), the commutator matrix is antisymmetric ($C_{ij} = -C_{ji}$), so $|C_{ij}|=|C_{ji}|$. We only need to inspect the upper triangle of $C$.\n    - For each pair where $J_i \\neq J_j$, we check if the magnitude $|C_{ij}|$ exceeds a second threshold, $\\varepsilon_{\\text{elem}}$.\n    - We collect all such pairs $(i,j)$ that satisfy this condition.\n    - This collection is then sorted in descending order based on the magnitude $|C_{ij}|$.\n    - Finally, we return up to the top $K$ pairs from this sorted list. These pairs represent the couplings in the Hamiltonian that most severely violate rotational symmetry and are candidates for re-evaluation or correction.\n\nThe implementation will follow these steps for each test case, calculating the norm, the violation flag, and the ranked list of offending index pairs, and formatting the output as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the processing of all test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"N\": 5,\n            \"J\": [0, 0, 1, 1, 2],\n            \"H\": np.array([\n                [1.0, 0.05, 0, 0, 0],\n                [0.05, 1.2, 0, 0, 0],\n                [0, 0, 0.8, -0.03, 0],\n                [0, 0, -0.03, 1.1, 0],\n                [0, 0, 0, 0, 2.0]\n            ]),\n            \"eps_norm\": 1e-10,\n            \"eps_elem\": 1e-10,\n            \"K\": 3\n        },\n        # Test case 2\n        {\n            \"N\": 5,\n            \"J\": [0, 0, 1, 1, 2],\n            \"H\": np.array([\n                [1.0, 0.05, 0.001, 0, 0],\n                [0.05, 1.2, 0, 0, 0],\n                [0.001, 0, 0.8, -0.03, 0],\n                [0, 0, -0.03, 1.1, 0],\n                [0, 0, 0, 0, 2.0]\n            ]),\n            \"eps_norm\": 1e-5,\n            \"eps_elem\": 1e-4,\n            \"K\": 2\n        },\n        # Test case 3\n        {\n            \"N\": 4,\n            \"J\": [1, 1, 1, 2],\n            \"H\": np.array([\n                [0.9, 0.02, 0.01, 3e-8],\n                [0.02, 1.0, 0.015, -2e-8],\n                [0.01, 0.015, 1.1, 1e-8],\n                [3e-8, -2e-8, 1e-8, 1.5]\n            ]),\n            \"eps_norm\": 1e-6,\n            \"eps_elem\": 1e-7,\n            \"K\": 3\n        },\n        # Test case 4\n        {\n            \"N\": 6,\n            \"J\": [0, 1, 1, 2, 2, 3],\n            \"H\": np.array([\n                [1.0, 0, 0, 0.1, 0, 0],\n                [0, 1.2, 0.04, 0, 0, 0.02],\n                [0, 0.04, 1.15, 0, -0.03, 0],\n                [0.1, 0, 0, 2.0, 0.05, 0],\n                [0, 0, -0.03, 0.05, 2.1, 0],\n                [0, 0.02, 0, 0, 0, 2.5]\n            ]),\n            \"eps_norm\": 1e-3,\n            \"eps_elem\": 1e-2,\n            \"K\": 2\n        }\n    ]\n\n    results_as_strings = []\n    for case in test_cases:\n        norm_F, is_mixing, offending_pairs = diagnose_hamiltonian(\n            case[\"N\"], case[\"J\"], case[\"H\"], case[\"eps_norm\"], case[\"eps_elem\"], case[\"K\"]\n        )\n        \n        # Format the result list into the exact string representation required.\n        # The float must be formatted to 6 decimal places.\n        # Python's default str() for lists and booleans is sufficient.\n        norm_F_str = f\"{norm_F:.6f}\"\n        result_str = f\"[{norm_F_str}, {is_mixing}, {offending_pairs}]\"\n        results_as_strings.append(result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_as_strings)}]\")\n\ndef diagnose_hamiltonian(N, J_list, H, eps_norm, eps_elem, K):\n    \"\"\"\n    Performs the diagnostic check for a single Hamiltonian matrix.\n\n    Args:\n        N (int): Dimension of the matrix.\n        J_list (list): List of total angular momentum quantum numbers.\n        H (np.ndarray): The Hamiltonian matrix.\n        eps_norm (float): Threshold for the Frobenius norm.\n        eps_elem (float): Threshold for individual commutator elements.\n        K (int): Maximum number of offending pairs to return.\n\n    Returns:\n        tuple: A tuple containing:\n            - float: The Frobenius norm of the commutator, ||[H, D]||_F.\n            - bool: True if the norm exceeds eps_norm, False otherwise.\n            - list: A list of up to K offending (i,j) pairs.\n    \"\"\"\n    # 1. Construct the diagonal of the J^2 operator matrix D.\n    # D_ii = J_i * (J_i + 1)\n    d_diag = np.array([j * (j + 1) for j in J_list])\n\n    # 2. Form the commutator matrix C = [H, D] using the derived formula\n    # C_ij = H_ij * (D_jj - D_ii)\n    C = np.zeros_like(H)\n    for i in range(N):\n        for j in range(N):\n            C[i, j] = H[i, j] * (d_diag[j] - d_diag[i])\n\n    # 3. Compute the Frobenius norm of C\n    norm_F = np.linalg.norm(C, 'fro')\n\n    # 4. Decide whether unphysical mixing is present\n    is_mixing = norm_F > eps_norm\n\n    # 5. Backtrace the dominant contributions\n    offending_pairs_with_mag = []\n    for i in range(N):\n        for j in range(i + 1, N): # Iterate over upper triangle (i  j)\n            if J_list[i] != J_list[j]:\n                abs_Cij = np.abs(C[i, j])\n                if abs_Cij >= eps_elem:\n                    offending_pairs_with_mag.append((abs_Cij, (i, j)))\n    \n    # Sort pairs by descending magnitude of C_ij\n    offending_pairs_with_mag.sort(key=lambda x: x[0], reverse=True)\n\n    # Extract the index pairs and limit to K\n    final_pairs = [pair for mag, pair in offending_pairs_with_mag[:K]]\n\n    return norm_F, is_mixing, final_pairs\n\nsolve()\n```", "id": "3602898"}, {"introduction": "A key advantage of working in the J-scheme is its compatibility with methods that address other physical constraints, such as the separation of intrinsic and center-of-mass (COM) motion. This practice demonstrates how to implement the Lawson method, a standard technique for suppressing unphysical COM excitations, within the J-scheme framework. By numerically diagonalizing a model Hamiltonian, you will explore how a penalty term $\\beta N_{\\text{COM}}$ effectively isolates and shifts spurious states to high energy, ensuring the physical integrity of the calculated low-lying spectrum [@problem_id:3602888].", "problem": "Consider a rotationally invariant nuclear shell-model Hamiltonian formulated in the $J$-scheme (basis states labeled by total angular momentum $J$). In a harmonic-oscillator single-particle basis, the center-of-mass (COM) degree of freedom can be expressed through a number operator $N_{\\text{COM}}$ that counts COM quanta. To suppress spurious COM excitations without affecting intrinsic (physical) spectra, a Lawson term is added: $H_{\\text{Lawson}} = \\beta N_{\\text{COM}}$, where $\\beta$ is a dimensionless penalty parameter. In the limit of large $\\beta$, spurious COM excitations are pushed up in energy while physical states remain unaffected.\n\nStarting from first principles, use the following base facts:\n- Rotational invariance implies block diagonalization of the Hamiltonian into sectors of good total angular momentum $J$, so that $H = \\bigoplus_J H^{(J)}$.\n- The center-of-mass number operator $N_{\\text{COM}}$ is diagonal in a basis that separates intrinsic and spurious components, with $N_{\\text{COM}}=0$ for physical components and $N_{\\text{COM}}0$ for spurious components.\n- Adding $H_{\\text{Lawson}}=\\beta N_{\\text{COM}}$ shifts energies by $\\beta$ multiplied by the expectation value of $N_{\\text{COM}}$ in each state, while preserving $J$.\n\nIn this problem, you will construct explicit toy $J$-scheme Hamiltonians $H^{(J)}(\\beta)$ in natural harmonic oscillator units with $\\hbar\\omega=1$ (dimensionless), diagonalize them, and quantify how spurious states shift as $\\beta$ varies, while showing that physical $J$-coupled spectra are unaffected for large $\\beta$ by monitoring $N_{\\text{COM}}$ expectation values.\n\nFor each $J\\in\\{0,2,4\\}$, define a basis consisting of physical states and one spurious COM state. The Hamiltonian in each sector is\n$$\nH^{(J)}(\\beta) = H_0^{(J)} + V_{\\text{mix}}^{(J)} + \\beta N_{\\text{COM}}^{(J)}\\,,\n$$\nwhere:\n- $H_0^{(J)}$ is diagonal with entries equal to the unperturbed energies of physical and spurious states.\n- $V_{\\text{mix}}^{(J)}$ couples spurious and physical basis states within the same $J$ (conserving $J$).\n- $N_{\\text{COM}}^{(J)}$ is diagonal, with entries $0$ for physical basis states and $1$ for spurious basis states.\n\nUse the following sector definitions (all energies are in natural harmonic oscillator units, dimensionless):\n- Sector $J=0$:\n  - Physical energies: $E_{\\text{phys}}^{(0)} = [1.20,\\,2.00]$.\n  - Spurious energy: $E_{\\text{spur}}^{(0)} = [1.35]$.\n  - Mixing couplings to the spurious state: $\\epsilon^{(0)} = [0.08,\\,0.04]$, meaning the off-diagonal elements between the spurious basis state and the two physical basis states are $0.08$ and $0.04$, respectively.\n  - $N_{\\text{COM}}^{(0)}=\\mathrm{diag}(0,0,1)$.\n- Sector $J=2$:\n  - Physical energies: $E_{\\text{phys}}^{(2)} = [2.30,\\,3.10]$.\n  - Spurious energy: $E_{\\text{spur}}^{(2)} = [2.00]$.\n  - Mixing couplings: $\\epsilon^{(2)} = [0.05,\\,0.03]$.\n  - $N_{\\text{COM}}^{(2)}=\\mathrm{diag}(0,0,1)$.\n- Sector $J=4$:\n  - Physical energies: $E_{\\text{phys}}^{(4)} = [3.80]$.\n  - Spurious energy: $E_{\\text{spur}}^{(4)} = [3.70]$.\n  - Mixing couplings: $\\epsilon^{(4)} = [0.00]$.\n  - $N_{\\text{COM}}^{(4)}=\\mathrm{diag}(0,1)$.\n\nFor each sector, $H_0^{(J)}$ is the diagonal matrix formed by concatenating the physical energies followed by the single spurious energy. The mixing matrix $V_{\\text{mix}}^{(J)}$ has symmetric off-diagonal entries between the spurious basis vector and each physical basis vector set by the corresponding entry of $\\epsilon^{(J)}$, and zeros otherwise. The operator $N_{\\text{COM}}^{(J)}$ is diagonal with zeros on physical entries and ones on the spurious entry.\n\nFor an eigenpair $\\{E_k^{(J)}(\\beta),\\,|\\psi_k^{(J)}(\\beta)\\rangle\\}$ obtained by diagonalizing $H^{(J)}(\\beta)$, define the COM expectation value\n$$\nn_k^{(J)}(\\beta) = \\langle \\psi_k^{(J)}(\\beta) |\\, N_{\\text{COM}}^{(J)} \\,| \\psi_k^{(J)}(\\beta) \\rangle,\n$$\nwhich reduces to the sum of the probabilities on the spurious component because $N_{\\text{COM}}^{(J)}$ is diagonal with zeros on physical components and one on the spurious component.\n\nFor each $\\beta$ in the test suite, perform the following computations:\n1. For each sector $J\\in\\{0,2,4\\}$, construct $H^{(J)}(\\beta)$, diagonalize it to obtain eigenvalues $E_k^{(J)}(\\beta)$ and normalized eigenvectors $|\\psi_k^{(J)}(\\beta)\\rangle$, and compute $n_k^{(J)}(\\beta)$ for all $k$.\n2. Identify the spurious eigenstate in sector $J$ as the eigenstate maximizing $n_k^{(J)}(\\beta)$. Let its energy be $E_{\\text{spur}}^{(J)}(\\beta)$. Using the corresponding value at $\\beta=0$ called $E_{\\text{spur}}^{(J)}(0)$ (computed consistently by diagonalizing the same sector at $\\beta=0$), define the spurious energy shift\n$$\nS^{(J)}(\\beta) = E_{\\text{spur}}^{(J)}(\\beta) - E_{\\text{spur}}^{(J)}(0).\n$$\n3. Identify physical eigenstates in sector $J$ as those with $n_k^{(J)}(\\beta)  \\tau$ where the threshold is $\\tau = 0.5$. Sort their energies ascending and compare them to the sorted baseline physical energies $E_{\\text{phys}}^{(J)}$ for that sector. Define the maximum absolute drift across all sectors and physical states as\n$$\nD(\\beta) = \\max_{J}\\,\\max_{i} \\left| \\tilde{E}_{i}^{(J)}(\\beta) - E_{\\text{phys},i}^{(J)} \\right|,\n$$\nwhere $\\tilde{E}_{i}^{(J)}(\\beta)$ are the sorted energies of the identified physical eigenstates in sector $J$.\n4. For each sector $J$, take the two lowest-energy eigenstates (or all states if fewer than two exist) and compute their $n_k^{(J)}(\\beta)$. Define\n$$\nM(\\beta) = \\max_{J}\\,\\max_{k\\in\\text{lowest two of sector }J} \\, n_k^{(J)}(\\beta)\\,.\n$$\n5. Define a boolean\n$$\nU(\\beta) = \\begin{cases}\n\\text{True},  \\text{if } D(\\beta) \\leq 10^{-3} \\text{ and } M(\\beta) \\leq 10^{-3},\\\\\n\\text{False},  \\text{otherwise}.\n\\end{cases}\n$$\nThis quantifies that the physical $J$-coupled spectra are unaffected in the large $\\beta$ limit and the low-lying eigenstates have negligible COM contamination.\n6. Define the average spurious energy shift across sectors\n$$\n\\bar{S}(\\beta) = \\frac{1}{3} \\sum_{J\\in\\{0,2,4\\}} S^{(J)}(\\beta)\\,.\n$$\n\nTest Suite:\n- Use $\\beta$ values $\\{0.0,\\,0.5,\\,5.0,\\,50.0\\}$.\n- Energies are in natural harmonic oscillator units with $\\hbar\\omega=1$ (dimensionless numbers).\n- No angles are needed.\n\nProgram Output Specification:\n- For each $\\beta$ in the test suite, compute and output an entry containing the five quantities\n$$\n\\left[ \\beta,\\; \\bar{S}(\\beta),\\; D(\\beta),\\; M(\\beta),\\; U(\\beta) \\right].\n$$\n- Your program should produce a single line of output containing the results as a comma-separated list of these entries, each enclosed in square brackets. For example: \"[[beta1,meanShift1,maxDrift1,maxLowNcom1,unaffected1],[beta2,meanShift2,maxDrift2,maxLowNcom2,unaffected2],...]\".", "solution": "The problem is validated as scientifically sound, well-posed, and objective. It presents a simplified but conceptually correct toy model of the Lawson method, a standard technique in nuclear shell-model calculations for suppressing spurious center-of-mass motion. All parameters, definitions, and computational steps are explicitly provided, allowing for a unique and verifiable solution. The problem is directly relevant to the field of computational nuclear physics and makes use of the $J$-scheme representation as specified.\n\nThe problem requires us to analyze the effect of adding a Lawson term, $H_{\\text{Lawson}} = \\beta N_{\\text{COM}}$, to a nuclear shell-model Hamiltonian. The goal is to demonstrate that for a sufficiently large penalty parameter $\\beta$, this term effectively separates \"spurious\" eigenstates, which correspond to the motion of the nucleus's center of mass (COM), from the \"physical\" eigenstates that describe the nucleus's internal structure. This separation is achieved by shifting the energy of spurious states upwards significantly without affecting the physical energy spectrum.\n\nThe total Hamiltonian for a sector with a fixed total angular momentum $J$ is given by\n$$\nH^{(J)}(\\beta) = H_0^{(J)} + V_{\\text{mix}}^{(J)} + \\beta N_{\\text{COM}}^{(J)}\n$$\nThis Hamiltonian is constructed in a basis that includes both physical states and a single spurious COM excitation state. The basis for a given sector $J$ can be written as $\\{|p_1^{(J)}\\rangle, \\dots, |p_{N_p}^{(J)}\\rangle, |s^{(J)}\\rangle\\}$, where $|p_i^{(J)}\\rangle$ are the $N_p$ physical basis states and $|s^{(J)}\\rangle$ is the spurious basis state.\n\nThe components of the Hamiltonian are defined as follows:\n1.  $H_0^{(J)}$ is the diagonal matrix of unperturbed energies. The basis states are ordered such that the physical states come first, followed by the spurious state.\n    $$\n    H_0^{(J)} = \\mathrm{diag}\\left(E_{\\text{phys},1}^{(J)}, \\dots, E_{\\text{phys},N_p}^{(J)}, E_{\\text{spur}}^{(J)}\\right)\n    $$\n2.  $V_{\\text{mix}}^{(J)}$ is a symmetric, off-diagonal matrix that introduces coupling between the physical states and the spurious state. Its only non-zero elements are in the last row and last column, coupling each physical basis state $|p_i^{(J)}\\rangle$ to the spurious basis state $|s^{(J)}\\rangle$ with strength $\\epsilon_i^{(J)}$.\n3.  $N_{\\text{COM}}^{(J)}$ is the COM number operator in this basis. It is diagonal, with an eigenvalue of $0$ for physical basis states and $1$ for the spurious basis state. This is because physical states correspond to the COM being in its ground state ($N_{\\text{COM}}=0$), while the spurious state represents one quantum of COM excitation ($N_{\\text{COM}}=1$).\n    $$\n    N_{\\text{COM}}^{(J)} = \\mathrm{diag}(0, \\dots, 0, 1)\n    $$\n\nFor each sector $J \\in \\{0, 2, 4\\}$ and for each value of $\\beta$ in the test suite, the following computational procedure is executed:\nFirst, we construct the numerical matrix for $H^{(J)}(\\beta)$ based on the provided energies and couplings for that sector.\n\nFor the $J=0$ sector, the basis dimension is $3$ ($2$ physical, $1$ spurious). The Hamiltonian matrix is:\n$$\nH^{(0)}(\\beta) = \\begin{pmatrix} 1.20  0  0.08 \\\\ 0  2.00  0.04 \\\\ 0.08  0.04  1.35 + \\beta \\end{pmatrix}\n$$\nFor the $J=2$ sector, the basis dimension is $3$ ($2$ physical, $1$ spurious):\n$$\nH^{(2)}(\\beta) = \\begin{pmatrix} 2.30  0  0.05 \\\\ 0  3.10  0.03 \\\\ 0.05  0.03  2.00 + \\beta \\end{pmatrix}\n$$\nFor the $J=4$ sector, the basis dimension is $2$ ($1$ physical, $1$ spurious):\n$$\nH^{(4)}(\\beta) = \\begin{pmatrix} 3.80  0.00 \\\\ 0.00  3.70 + \\beta \\end{pmatrix}\n$$\nNote that for $J=4$, the mixing coupling is $0$, meaning the physical and spurious spaces are already decoupled.\n\nNext, we solve the time-independent Schrödinger equation for each matrix, which is a standard eigenvalue problem:\n$$\nH^{(J)}(\\beta) |\\psi_k^{(J)}(\\beta)\\rangle = E_k^{(J)}(\\beta) |\\psi_k^{(J)}(\\beta)\\rangle\n$$\nThis is performed by numerical diagonalization, yielding the eigenvalues (energies) $E_k^{(J)}(\\beta)$ and the corresponding eigenvectors $|\\psi_k^{(J)}(\\beta)\\rangle$. Since the Hamiltonian matrices are real and symmetric, the eigenvalues will be real and the eigenvectors will form an orthonormal basis.\n\nThe character of each eigenstate (i.e., how \"spurious\" it is) is quantified by the expectation value of the $N_{\\text{COM}}$ operator:\n$$\nn_k^{(J)}(\\beta) = \\langle \\psi_k^{(J)}(\\beta) | N_{\\text{COM}}^{(J)} | \\psi_k^{(J)}(\\beta) \\rangle\n$$\nIf an eigenvector is expressed as $|\\psi_k^{(J)}(\\beta)\\rangle = \\sum_i c_i |p_i^{(J)}\\rangle + c_s |s^{(J)}\\rangle$, then $n_k^{(J)}(\\beta) = |c_s|^2$. This value, ranging from $0$ to $1$, represents the probability of finding the system in the spurious basis state. An eigenstate is identified as \"spurious\" if its $n_k^{(J)}(\\beta)$ is maximal (and greater than the threshold $\\tau=0.5$), and \"physical\" otherwise.\n\nThe algorithm then proceeds with the following calculations for each $\\beta$:\n1.  **Spurious Energy Shift $S^{(J)}(\\beta)$**: We first find the energy of the spurious eigenstate for $\\beta=0$, denoted $E_{\\text{spur}}^{(J)}(0)$, by diagonalizing $H^{(J)}(0)$. Then, for each $\\beta > 0$, we find the energy of the state with the maximum $n_k^{(J)}(\\beta)$, denoted $E_{\\text{spur}}^{(J)}(\\beta)$. The shift is $S^{(J)}(\\beta) = E_{\\text{spur}}^{(J)}(\\beta) - E_{\\text{spur}}^{(J)}(0)$. The average shift $\\bar{S}(\\beta)$ is the mean of $S^{(J)}(\\beta)$ over $J \\in \\{0,2,4\\}$. As $\\beta$ increases, we expect $S^{(J)}(\\beta) \\approx \\beta$.\n2.  **Physical Spectrum Drift $D(\\beta)$**: We identify the physical eigenstates (those with $n_k^{(J)}(\\beta)  0.5$), sort their energies $\\tilde{E}_{i}^{(J)}(\\beta)$, and calculate the maximum absolute difference between these and the baseline unperturbed physical energies $E_{\\text{phys},i}^{(J)}$. This measures how much the physical spectrum is distorted by the mixing and the Lawson procedure. In the limit of large $\\beta$, this drift should approach zero.\n3.  **Low-Lying COM Contamination $M(\\beta)$**: We calculate the maximum $n_k^{(J)}(\\beta)$ value among the two lowest-energy eigenstates in each sector. This quantity should also approach zero for large $\\beta$, indicating that the low-energy spectrum, which is of primary physical interest, is free of spurious COM contamination.\n4.  **Unaffected Spectrum Flag $U(\\beta)$**: A boolean flag set to True if both $D(\\beta)$ and $M(\\beta)$ are below a small tolerance ($10^{-3}$), confirming the success of the Lawson method for a given $\\beta$.\n\nBy performing these calculations for a range of $\\beta$ values, we can quantitatively observe the progressive decoupling of physical and spurious degrees of freedom, a cornerstone of performing realistic nuclear structure calculations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the nuclear shell-model problem with a Lawson term.\n    \n    This function constructs and diagonalizes Hamiltonians for different angular\n    momentum sectors (J=0, 2, 4) and for various values of the Lawson penalty\n    parameter beta. It then calculates several metrics to quantify the \n    separation of spurious center-of-mass states from the physical spectrum.\n    \"\"\"\n\n    # --- Problem Givens ---\n    sector_data = {\n        0: {'E_phys': [1.20, 2.00], 'E_spur': [1.35], 'epsilon': [0.08, 0.04]},\n        2: {'E_phys': [2.30, 3.10], 'E_spur': [2.00], 'epsilon': [0.05, 0.03]},\n        4: {'E_phys': [3.80], 'E_spur': [3.70], 'epsilon': [0.00]}\n    }\n    beta_values = [0.0, 0.5, 5.0, 50.0]\n    j_sectors = [0, 2, 4]\n    n_com_threshold = 0.5\n    unaffected_threshold = 1e-3\n\n    # --- Pre-calculate spurious energies at beta=0 for the shift calculation ---\n    e_spur_j_at_beta0 = {}\n    for j in j_sectors:\n        data = sector_data[j]\n        e_phys = data['E_phys']\n        e_spur = data['E_spur']\n        epsilon = data['epsilon']\n        beta = 0.0\n\n        num_phys = len(e_phys)\n        dim = num_phys + 1\n\n        h0 = np.diag(e_phys + e_spur)\n        v_mix = np.zeros((dim, dim))\n        if num_phys > 0:\n            v_mix[-1, :num_phys] = epsilon\n            v_mix[:num_phys, -1] = epsilon\n        n_com_op = np.diag([0] * num_phys + [1])\n        \n        hamiltonian = h0 + v_mix + beta * n_com_op\n        \n        evals, evecs = np.linalg.eigh(hamiltonian)\n        \n        # n_k is the probability of the spurious component, i.e., |c_spur|^2\n        n_k = evecs[-1, :]**2\n        \n        spur_idx = np.argmax(n_k)\n        e_spur_j_at_beta0[j] = evals[spur_idx]\n\n    # --- Main Calculation Loop ---\n    all_results = []\n    for beta in beta_values:\n        total_s_j = 0.0\n        max_drift_d = 0.0\n        max_low_n_com_m = 0.0\n\n        for j in j_sectors:\n            data = sector_data[j]\n            e_phys = data['E_phys']\n            e_spur = data['E_spur']\n            epsilon = data['epsilon']\n\n            num_phys = len(e_phys)\n            dim = num_phys + 1\n\n            # 1. Construct Hamiltonian H(J)(beta)\n            h0 = np.diag(e_phys + e_spur)\n            v_mix = np.zeros((dim, dim))\n            if num_phys > 0:\n                v_mix[-1, :num_phys] = epsilon\n                v_mix[:num_phys, -1] = epsilon\n            n_com_op = np.diag([0] * num_phys + [1])\n            \n            hamiltonian = h0 + v_mix + beta * n_com_op\n            \n            # Diagonalize to get eigenvalues and eigenvectors\n            evals, evecs = np.linalg.eigh(hamiltonian)\n            \n            # Compute COM expectation values n_k\n            n_k = evecs[-1, :]**2\n\n            # 2. Spurious energy shift S(J)(beta)\n            spur_idx = np.argmax(n_k)\n            e_spur_j_at_beta = evals[spur_idx]\n            s_j = e_spur_j_at_beta - e_spur_j_at_beta0[j]\n            total_s_j += s_j\n\n            # 3. Maximum absolute drift D(beta)\n            phys_indices = np.where(n_k  n_com_threshold)[0]\n            if len(phys_indices) > 0:\n                phys_energies_beta = np.sort(evals[phys_indices])\n                baseline_phys_energies = np.sort(e_phys)\n                \n                # Check for matching dimensions before comparison\n                if len(phys_energies_beta) == len(baseline_phys_energies):\n                    drift_j = np.max(np.abs(phys_energies_beta - baseline_phys_energies))\n                    max_drift_d = max(max_drift_d, drift_j)\n\n            # 4. Max COM contamination of low-lying states M(beta)\n            # Eigenvalues from eigh are already sorted\n            num_lowest = min(2, dim)\n            n_com_lowest_two = n_k[:num_lowest]\n            max_low_n_com_m = max(max_low_n_com_m, np.max(n_com_lowest_two))\n\n        # 6. Average spurious energy shift\n        avg_s = total_s_j / len(j_sectors)\n\n        # 5. Unaffected spectrum boolean U(beta)\n        unaffected_u = (max_drift_d = unaffected_threshold) and (max_low_n_com_m = unaffected_threshold)\n        \n        # Store results for this beta\n        result_entry = [beta, avg_s, max_drift_d, max_low_n_com_m, unaffected_u]\n        all_results.append(result_entry)\n\n    # --- Final Output Formatting ---\n    # Manually format the string to avoid spaces and match the example format\n    output_parts = []\n    for res in all_results:\n        # res is [beta, avg_s, max_drift_d, max_low_n_com_m, unaffected_u]\n        formatted_entry = f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]}]\"\n        output_parts.append(formatted_entry)\n        \n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    print(final_output_string)\n\nsolve()\n```", "id": "3602888"}]}