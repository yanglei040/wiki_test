{"hands_on_practices": [{"introduction": "The cornerstone of any model space calculation is the effective Hamiltonian, which is designed to reproduce the physics of a large Hilbert space within a smaller, computationally tractable subspace. This first exercise [@problem_id:3570129] guides you through the foundational derivation of an effective Hamiltonian using the Feshbach projection formalism in a simple two-level system. By explicitly constructing the exact, energy-dependent effective Hamiltonian and comparing its predictions to a common energy-independent approximation, you will gain a concrete understanding of how information from the excluded space is folded into the model space and the nature of the approximations involved.", "problem": "Consider a two-level toy Hamiltonian in a basis $\\{|p\\rangle, |q\\rangle\\}$ with projection operators $P = |p\\rangle\\langle p|$ and $Q = |q\\rangle\\langle q|$, where $P$ has dimension $1$ and $Q$ has dimension $1$. The full Hamiltonian in this basis is\n$$\nH \\equiv \\begin{pmatrix}\n\\epsilon_{p} & v \\\\\nv & \\epsilon_{q}\n\\end{pmatrix},\n$$\nwith parameters $\\epsilon_{p} = 0\\,\\mathrm{MeV}$, $\\epsilon_{q} = 10\\,\\mathrm{MeV}$, and $v = 2\\,\\mathrm{MeV}$. Starting from the time-independent Schrödinger equation $H|\\Psi\\rangle = E|\\Psi\\rangle$ and the fundamental projection operator identities $P + Q = \\mathbb{1}$, $P^{2} = P$, $Q^{2} = Q$, and $PQ = QP = 0$, derive the energy-dependent effective Hamiltonian $H_{\\text{eff}}(E)$ acting in the $P$-space that reproduces the exact $P$-space component of the eigenvalue problem. Use this $H_{\\text{eff}}(E)$ to obtain the corresponding $P$-space eigenvalue associated with the lower-energy exact solution.\n\nThen, to illustrate the effect of truncation, define a truncated, energy-independent $P$-space Hamiltonian by replacing the energy $E$ in $H_{\\text{eff}}(E)$ with the unperturbed $P$-space energy $\\epsilon_{p}$, and compute the approximate truncated $P$-space eigenvalue. Compare the exact lower eigenvalue of the full Hamiltonian with this truncated $P$-space eigenvalue by computing the absolute difference between them.\n\nExpress the final absolute difference in mega-electronvolts (MeV). Round your answer to six significant figures.", "solution": "The problem requires the derivation of an energy-dependent effective Hamiltonian, its application to find an exact eigenvalue, the calculation of an approximate eigenvalue from a truncated version of this Hamiltonian, and finally, the computation of the absolute difference between these two eigenvalues.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- Basis: $\\{|p\\rangle, |q\\rangle\\}$.\n- Projection operators: $P = |p\\rangle\\langle p|$, $Q = |q\\rangle\\langle q|$.\n- Dimension of $P$-space: $1$.\n- Dimension of $Q$-space: $1$.\n- Full Hamiltonian matrix: $H \\equiv \\begin{pmatrix} \\epsilon_{p} & v \\\\ v & \\epsilon_{q} \\end{pmatrix}$.\n- Hamiltonian parameters: $\\epsilon_{p} = 0\\,\\mathrm{MeV}$, $\\epsilon_{q} = 10\\,\\mathrm{MeV}$, $v = 2\\,\\mathrm{MeV}$.\n- Governing equation: Time-independent Schrödinger equation, $H|\\Psi\\rangle = E|\\Psi\\rangle$.\n- Projection operator identities: $P + Q = \\mathbb{1}$, $P^2 = P$, $Q^2 = Q$, $PQ = QP = 0$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the well-established Feshbach projection formalism used to derive effective Hamiltonians in quantum mechanics and many-body theory, particularly in nuclear physics. It is a standard textbook example.\n- **Well-Posed:** The problem is clearly stated, provides all necessary data, and asks for a specific, computable result. A unique solution exists.\n- **Objective:** The language is formal and unambiguous.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\nThe starting point is the time-independent Schrödinger equation for a state $|\\Psi\\rangle$ with energy eigenvalue $E$:\n$$H|\\Psi\\rangle = E|\\Psi\\rangle$$\nWe use the completeness relation $\\mathbb{1} = P+Q$ to decompose the state vector $|\\Psi\\rangle$ into its components in the $P$-space and the $Q$-space: $|\\Psi\\rangle = \\mathbb{1}|\\Psi\\rangle = (P+Q)|\\Psi\\rangle = P|\\Psi\\rangle + Q|\\Psi\\rangle$. Let's denote $|\\Psi_P\\rangle = P|\\Psi\\rangle$ and $|\\Psi_Q\\rangle = Q|\\Psi\\rangle$.\n\nWe can write the Schrödinger equation as two coupled equations by projecting onto the $P$ and $Q$ subspaces:\n$$\nP(H(P+Q)|\\Psi\\rangle) = E(P|\\Psi\\rangle) \\implies PHP|\\Psi_P\\rangle + PHQ|\\Psi_Q\\rangle = E|\\Psi_P\\rangle\n$$\n$$\nQ(H(P+Q)|\\Psi\\rangle) = E(Q|\\Psi\\rangle) \\implies QHP|\\Psi_P\\rangle + QHQ|\\Psi_Q\\rangle = E|\\Psi_Q\\rangle\n$$\nFrom the second equation, we solve for $|\\Psi_Q\\rangle$:\n$$\n(E\\mathbb{1}_Q - QHQ)|\\Psi_Q\\rangle = QHP|\\Psi_P\\rangle\n$$\n$$\n|\\Psi_Q\\rangle = (E\\mathbb{1}_Q - QHQ)^{-1} QHP|\\Psi_P\\rangle\n$$\nHere, $\\mathbb{1}_Q$ is the identity operator in the $Q$-space. The inverse $(E\\mathbb{1}_Q - QHQ)^{-1}$ is well-defined as long as $E$ is not an eigenvalue of the $Q$-space Hamiltonian $QHQ$.\n\nNext, we substitute this expression for $|\\Psi_Q\\rangle$ back into the first equation:\n$$\nPHP|\\Psi_P\\rangle + PHQ\\left((E\\mathbb{1}_Q - QHQ)^{-1} QHP\\right)|\\Psi_P\\rangle = E|\\Psi_P\\rangle\n$$\nThis can be written as an effective eigenvalue problem entirely within the $P$-space:\n$$\nH_{\\text{eff}}(E)|\\Psi_P\\rangle = E|\\Psi_P\\rangle\n$$\nwhere the energy-dependent effective Hamiltonian, $H_{\\text{eff}}(E)$, is defined as:\n$$\nH_{\\text{eff}}(E) = PHP + PHQ(E\\mathbb{1}_Q - QHQ)^{-1}QHP\n$$\nIn the provided basis, the $P$-space is spanned by $|p\\rangle$ and the $Q$-space by $|q\\rangle$. The operators become scalars (or $1 \\times 1$ matrices):\n- $PHP \\to \\langle p|H|p\\rangle = \\epsilon_p$\n- $QHQ \\to \\langle q|H|q\\rangle = \\epsilon_q$\n- $PHQ \\to \\langle p|H|q\\rangle = v$\n- $QHP \\to \\langle q|H|p\\rangle = v$\n\nThus, the scalar form of the effective Hamiltonian is:\n$$\nH_{\\text{eff}}(E) = \\epsilon_p + v \\frac{1}{E - \\epsilon_q} v = \\epsilon_p + \\frac{v^2}{E - \\epsilon_q}\n$$\nThe exact eigenvalues of the full Hamiltonian $H$ are the values of $E$ that satisfy the self-consistent condition $H_{\\text{eff}}(E) = E$:\n$$\nE = \\epsilon_p + \\frac{v^2}{E - \\epsilon_q}\n$$\nRearranging this equation gives a quadratic equation for $E$:\n$$\nE(E - \\epsilon_q) = \\epsilon_p(E - \\epsilon_q) + v^2\n$$\n$$\nE^2 - E\\epsilon_q - E\\epsilon_p + \\epsilon_p\\epsilon_q - v^2 = 0\n$$\n$$\nE^2 - (\\epsilon_p + \\epsilon_q)E + (\\epsilon_p\\epsilon_q - v^2) = 0\n$$\nThis is the characteristic equation of the original matrix $H$. We solve for $E$ using the quadratic formula:\n$$\nE = \\frac{(\\epsilon_p + \\epsilon_q) \\pm \\sqrt{(\\epsilon_p + \\epsilon_q)^2 - 4(\\epsilon_p\\epsilon_q - v^2)}}{2} = \\frac{\\epsilon_p + \\epsilon_q}{2} \\pm \\frac{\\sqrt{(\\epsilon_p - \\epsilon_q)^2 + 4v^2}}{2}\n$$\nThe problem asks for the eigenvalue associated with the lower-energy solution, which we denote $E_{\\text{exact,low}}$:\n$$\nE_{\\text{exact,low}} = \\frac{\\epsilon_p + \\epsilon_q}{2} - \\frac{1}{2}\\sqrt{(\\epsilon_p - \\epsilon_q)^2 + 4v^2}\n$$\nSubstituting the given values $\\epsilon_p = 0\\,\\mathrm{MeV}$, $\\epsilon_q = 10\\,\\mathrm{MeV}$, and $v = 2\\,\\mathrm{MeV}$:\n$$\nE_{\\text{exact,low}} = \\frac{0 + 10}{2} - \\frac{1}{2}\\sqrt{(0 - 10)^2 + 4(2^2)} = 5 - \\frac{1}{2}\\sqrt{100 + 16} = 5 - \\frac{\\sqrt{116}}{2}\n$$\nSince $\\sqrt{116} = \\sqrt{4 \\times 29} = 2\\sqrt{29}$, we have:\n$$\nE_{\\text{exact,low}} = 5 - \\sqrt{29}\\,\\mathrm{MeV}\n$$\nNext, we define the truncated, energy-independent Hamiltonian $H_{\\text{trunc}}$ by replacing $E$ in the denominator of $H_{\\text{eff}}(E)$ with the unperturbed $P$-space energy, $\\omega = \\epsilon_p$.\n$$\nH_{\\text{trunc}} = H_{\\text{eff}}(E=\\epsilon_p) = \\epsilon_p + \\frac{v^2}{\\epsilon_p - \\epsilon_q}\n$$\nThe eigenvalue of this truncated Hamiltonian, $E_{\\text{trunc}}$, is simply its scalar value:\n$$\nE_{\\text{trunc}} = \\epsilon_p + \\frac{v^2}{\\epsilon_p - \\epsilon_q}\n$$\nThis corresponds to the second-order perturbation theory correction to the energy $\\epsilon_p$. Substituting the given values:\n$$\nE_{\\text{trunc}} = 0 + \\frac{2^2}{0 - 10} = \\frac{4}{-10} = -0.4\\,\\mathrm{MeV}\n$$\nFinally, we compute the absolute difference $\\Delta E$ between the exact lower eigenvalue and the truncated eigenvalue:\n$$\n\\Delta E = |E_{\\text{exact,low}} - E_{\\text{trunc}}| = |(5 - \\sqrt{29}) - (-0.4)| = |5.4 - \\sqrt{29}|\\,\\mathrm{MeV}\n$$\nTo obtain the numerical value, we use $\\sqrt{29} \\approx 5.385164807$.\n$$\n\\Delta E = |5.4 - 5.385164807| = 0.014835193\\,\\mathrm{MeV}\n$$\nRounding this result to six significant figures gives $0.0148352$.", "answer": "$$\n\\boxed{0.0148352}\n$$", "id": "3570129"}, {"introduction": "In practical applications, such as the nuclear shell model, calculations are performed in a truncated basis of many-body states built from single-particle orbitals, often from a harmonic oscillator potential. While convenient, truncating this basis can break fundamental symmetries of the underlying nuclear interaction, such as translational invariance. This practice [@problem_id:3570101] addresses the resulting artifact known as center-of-mass contamination, where the internal (intrinsic) motion of the nucleus becomes spuriously coupled to its overall motion. You will derive and implement a quantitative diagnostic, based on the expectation value of the center-of-mass Hamiltonian $\\langle H_{\\text{cm}}\\rangle$, to measure the degree of this contamination in calculated nuclear wave functions.", "problem": "A translationally invariant nuclear many-body Hamiltonian built in a single-particle Harmonic Oscillator (HO) basis has a natural separation into intrinsic and center-of-mass (CM) motion when the model space is complete with respect to total HO quanta. In a truncated model space that does not preserve this completeness, eigenstates may acquire admixtures of CM excitations, producing spurious contributions. A well-defined diagnostic can be constructed using the expectation value of the CM Hamiltonian to quantify the degree of CM contamination in both ground and excited states obtained from truncated calculations. The goal is to derive, implement, and test such a diagnostic starting from first principles.\n\nFundamental base and definitions:\n- Consider a system of $A$ nucleons, each of mass $m$, described in a HO single-particle basis of frequency $\\Omega$, with reduced Planck constant $\\hbar$. The CM position and momentum operators are $\\mathbf{R}_{\\text{cm}} = \\frac{1}{A}\\sum_{i=1}^{A} \\mathbf{r}_i$ and $\\mathbf{P}_{\\text{cm}} = \\sum_{i=1}^{A} \\mathbf{p}_i$, respectively.\n- The CM Hamiltonian is\n$$\nH_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2,\n$$\nwhose spectrum in $d$ spatial dimensions is that of a $d$-dimensional HO:\n$$\nE_{\\text{cm}}(n) = \\left(n + \\frac{d}{2}\\right)\\hbar \\Omega, \\quad n \\in \\{0,1,2,\\dots\\}.\n$$\n- For a translationally invariant intrinsic Hamiltonian $H_{\\text{int}}$ that depends only on relative coordinates and momenta, one has $[H_{\\text{int}}, H_{\\text{cm}}]=0$ in a complete HO space. Physical eigenstates then factorize as a CM Gaussian ground state times an intrinsic state, yielding the CM ground-state expectation value $\\langle H_{\\text{cm}}\\rangle = \\frac{d}{2}\\hbar \\Omega$ independent of the intrinsic excitation. In truncated spaces that do not preserve CM-invariance of total quanta, this factorization may be broken.\n\nTask:\n- Starting from the definitions above and the orthonormality of HO eigenstates, derive a dimensionless diagnostic that quantifies CM contamination of a computed eigenstate in terms of its CM excitations. The diagnostic must:\n  1. Be a nonnegative scalar that equals $0$ for perfectly factorized states with CM in the HO ground state.\n  2. Increase monotonically with the admixture of CM excitations.\n  3. Be computable from the probabilities $\\{p_n\\}_{n=0}^{N}$ of finding the CM in HO quanta $n$ extracted from the (truncated) eigenstate, with $\\sum_{n=0}^{N} p_n = 1$ after normalization.\n- Implement an algorithm that, given $d$, $\\hbar \\Omega$ (expressed in megaelectronvolts, abbreviated MeV), and a finite list of nonnegative weights $\\{p_n\\}_{n=0}^{N}$ (not necessarily normalized), returns:\n  1. The CM expectation value $\\langle H_{\\text{cm}}\\rangle$ in MeV.\n  2. The dimensionless contamination diagnostic defined as item $1$ of this task normalized by $\\hbar \\Omega$ so that it is unitless.\n  3. A boolean flag indicating whether the contamination is acceptable for practical purposes, where you must adopt the threshold $\\tau = 0.05$ for acceptability.\n- You must renormalize $\\{p_n\\}$ to satisfy $\\sum_n p_n = 1$ if the provided weights do not already sum to $1$. If $\\sum_n p_n = 0$, treat the input as invalid.\n\nScientific realism and constraints:\n- Assume $d = 3$ spatial dimensions, consistent with physical nuclei.\n- The diagnostic should apply equally to ground and excited intrinsic states; a purely intrinsic excitation without CM excitation is not contaminated and should produce the same CM expectation value as the ground state.\n- Express all energy outputs for $\\langle H_{\\text{cm}}\\rangle$ in MeV, rounded to $6$ decimal places. Express the diagnostic as a decimal rounded to $6$ decimal places. The boolean flag must be exact.\n\nTest suite:\nEvaluate the algorithm for the following parameter sets, which collectively test the happy path, boundary conditions, and edge cases. For each case, use $d=3$ and the specified $\\hbar\\Omega$ and CM weight list $\\{p_n\\}$:\n- Case $1$ (complete decoupling, ground state): $\\hbar\\Omega = 20$ MeV, $p_0 = 1.0$.\n- Case $2$ (mild contamination, ground state): $\\hbar\\Omega = 20$ MeV, $p_0 = 0.9$, $p_1 = 0.1$.\n- Case $3$ (moderate contamination, excited intrinsic state): $\\hbar\\Omega = 14$ MeV, $p_0 = 0.7$, $p_2 = 0.3$.\n- Case $4$ (unnormalized input, boundary check): $\\hbar\\Omega = 20$ MeV, $p_0 = 0.95$, $p_1 = 0.10$.\n- Case $5$ (equal mixture of CM ground and first excited quanta): $\\hbar\\Omega = 20$ MeV, $p_0 = 0.5$, $p_1 = 0.5$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated Python-style list of lists. Each inner list must be ordered as $[\\langle H_{\\text{cm}}\\rangle~\\text{(MeV)}, \\text{diagnostic}, \\text{boolean}]$, for the test cases in the order given above. For example, a valid output format is\n$[[30.000000,0.000000,True],[\\dots],\\dots]$.", "solution": "The problem requires the derivation and implementation of a diagnostic for center-of-mass (CM) contamination in truncated nuclear many-body calculations. The solution proceeds in two stages: first, the derivation of the necessary formulae from first principles; second, the algorithmic implementation for the specified test cases.\n\n**Part 1: Derivation of the Diagnostic and Expectation Value**\n\nA computed eigenstate of a nuclear system from a truncated harmonic oscillator (HO) basis can be viewed as a mixed state with respect to its CM motion. We are given that the probability of finding the CM of the system in the $n$-th excited state of a CM HO Hamiltonian is $p_n$. The set of probabilities $\\{p_n\\}_{n=0}^{N}$ completely characterizes the CM state for the purpose of this analysis. The total probability must be unity, so we enforce the normalization condition $\\sum_{n=0}^{N} p_n = 1$. If the provided weights do not sum to $1$, they must be normalized.\n\nThe CM Hamiltonian is given as:\n$$\nH_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2\n$$\nIts energy eigenvalues in $d$ spatial dimensions are:\n$$\nE_{\\text{cm}}(n) = \\left(n + \\frac{d}{2}\\right)\\hbar \\Omega, \\quad n \\in \\{0, 1, 2, \\dots\\}\n$$\nwhere $n$ is the principal quantum number of the CM HO.\n\nThe expectation value of the CM Hamiltonian, $\\langle H_{\\text{cm}}\\rangle$, for a state described by the probabilities $\\{p_n\\}$ is the weighted average of the energy eigenvalues:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\sum_{n=0}^{N} p_n E_{\\text{cm}}(n)\n$$\nSubstituting the expression for $E_{\\text{cm}}(n)$:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\sum_{n=0}^{N} p_n \\left(n + \\frac{d}{2}\\right)\\hbar \\Omega\n$$\nThis can be expanded as:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\hbar \\Omega \\sum_{n=0}^{N} n p_n + \\frac{d}{2}\\hbar \\Omega \\sum_{n=0}^{N} p_n\n$$\nUsing the normalization condition $\\sum_{n=0}^{N} p_n = 1$, the expression simplifies to:\n$$\n\\langle H_{\\text{cm}}\\rangle = \\hbar \\Omega \\left( \\sum_{n=0}^{N} n p_n + \\frac{d}{2} \\right)\n$$\nThis formula allows the computation of the CM energy expectation value given the probabilities $\\{p_n\\}$.\n\nNext, we derive the dimensionless diagnostic for CM contamination. A state is considered free of contamination if its CM motion is purely in the ground state. This corresponds to the probability distribution $p_0=1$ and $p_n=0$ for all $n > 0$. For such a pure state, the CM energy is the ground-state energy, $\\langle H_{\\text{cm}}\\rangle_{\\text{pure}}$:\n$$\n\\langle H_{\\text{cm}}\\rangle_{\\text{pure}} = E_{\\text{cm}}(0) = \\left(0 + \\frac{d}{2}\\right)\\hbar \\Omega = \\frac{d}{2}\\hbar \\Omega\n$$\nContamination is the presence of components with $n>0$. A natural measure of this contamination is the excess energy in the CM motion above its ground-state minimum. We define this excess energy, $\\Delta E_{\\text{cm}}$, as:\n$$\n\\Delta E_{\\text{cm}} = \\langle H_{\\text{cm}}\\rangle - \\langle H_{\\text{cm}}\\rangle_{\\text{pure}}\n$$\nSubstituting the derived expressions:\n$$\n\\Delta E_{\\text{cm}} = \\left[ \\hbar \\Omega \\left( \\sum_{n=0}^{N} n p_n + \\frac{d}{2} \\right) \\right] - \\left[ \\frac{d}{2}\\hbar \\Omega \\right] = \\hbar \\Omega \\sum_{n=0}^{N} n p_n\n$$\nThis quantity, $\\Delta E_{\\text{cm}}$, satisfies the requirements for a contamination measure:\n1.  It is non-negative, since $\\hbar\\Omega > 0$, $n \\ge 0$, and $p_n \\ge 0$.\n2.  It equals $0$ for a pure state where $p_0=1$ and $p_n=0$ for $n>0$, as the sum $\\sum n p_n$ becomes $0$.\n3.  It increases monotonically as probability weight is shifted to higher $n$ states.\n\nThe problem requires a dimensionless diagnostic, which can be obtained by normalizing the excess energy by the characteristic energy scale of the CM excitations, which is $\\hbar\\Omega$. We define the dimensionless diagnostic, denoted $\\mathcal{C}$, as:\n$$\n\\mathcal{C} = \\frac{\\Delta E_{\\text{cm}}}{\\hbar \\Omega} = \\frac{\\hbar \\Omega \\sum_{n=0}^{N} n p_n}{\\hbar \\Omega} = \\sum_{n=0}^{N} n p_n\n$$\nThis diagnostic $\\mathcal{C}$ is simply the expectation value of the CM principal quantum number, $\\langle n \\rangle$. It is a non-negative scalar, is $0$ for a pure CM ground state, and increases with the admixture of excited CM quanta.\n\n**Part 2: Algorithm and Implementation**\n\nThe algorithm to be implemented takes as input the number of dimensions $d$, the HO energy $\\hbar\\Omega$ in MeV, and a list of weights $\\{p_n\\}_{n=0}^{N}$. For this problem, we are given $d=3$.\n\n1.  **Input Processing**: Given the list of weights $\\{p_n\\}$, first compute their sum, $S = \\sum_n p_n$.\n    *   If $S=0$, the input is invalid.\n    *   If $S \\ne 1$, renormalize each weight: $p_n' = p_n / S$. Otherwise, use the weights as is.\n\n2.  **Diagnostic Calculation**: Using the (normalized) weights, compute the dimensionless diagnostic $\\mathcal{C}$:\n    $$\n    \\mathcal{C} = \\sum_{n=0}^{N} n p_n\n    $$\n\n3.  **Expectation Value Calculation**: Compute the CM expectation value $\\langle H_{\\text{cm}}\\rangle$ in MeV using the previously computed $\\mathcal{C}$ and $d=3$:\n    $$\n    \\langle H_{\\text{cm}}\\rangle = \\hbar\\Omega \\left( \\mathcal{C} + \\frac{3}{2} \\right)\n    $$\n\n4.  **Acceptability Check**: Compare the diagnostic $\\mathcal{C}$ against the given threshold $\\tau = 0.05$. The contamination is acceptable if $\\mathcal{C} \\le \\tau$. This yields a boolean flag.\n\n5.  **Output Formatting**:\n    *   The value of $\\langle H_{\\text{cm}}\\rangle$ is rounded to $6$ decimal places.\n    *   The value of $\\mathcal{C}$ is rounded to $6$ decimal places.\n    *   The final result for each test case is a list: $[\\langle H_{\\text{cm}}\\rangle, \\mathcal{C}, \\text{boolean flag}]$.\n\nThis procedure is applied to each test case provided in the problem statement.", "answer": "[[30.000000,0.000000,True],[32.000000,0.100000,False],[29.400000,0.600000,False],[31.904762,0.095238,False],[40.000000,0.500000,False]]", "id": "3570101"}, {"introduction": "Building on the concept of broken symmetries, this exercise explores a more subtle but profound consequence of ill-chosen model spaces. When a truncation does not respect a discrete symmetry of the full system, such as parity, the resulting Bloch-Horowitz effective Hamiltonian can become non-Hermitian. This practice [@problem_id:3570078] provides a hands-on computational exploration of this phenomenon, challenging you to analyze its physical consequences, including the appearance of complex energy eigenvalues and the critical distinction between left and right eigenvectors required for calculating transition matrix elements in a biorthogonal basis.", "problem": "Consider a finite-dimensional Hamiltonian model designed to isolate the impact of symmetry-violating model-space truncations on effective interactions and observables derived via the Bloch–Horowitz construction. Work in a four-dimensional Hilbert space spanned by a basis ordered as $\\{|e_0\\rangle, |e_1\\rangle, |o_0\\rangle, |o_1\\rangle\\}$, where the labels $e$ and $o$ denote even and odd parity, respectively. The full-space Hamiltonian $\\hat{H}$ conserves parity and is specified in this basis by a block-diagonal real-symmetric matrix\n$$\nH \\equiv \\begin{pmatrix}\nH_{\\mathrm{even}} & 0 \\\\\n0 & H_{\\mathrm{odd}}\n\\end{pmatrix},\\quad\nH_{\\mathrm{even}}=\\begin{pmatrix}-2.0 & -0.3\\\\ -0.3 & -1.0\\end{pmatrix},\\quad\nH_{\\mathrm{odd}}=\\begin{pmatrix}-0.5 & -0.2\\\\ -0.2 & 0.3\\end{pmatrix}.\n$$\nConsider also a Hermitian transition operator $\\hat{T}$ that is odd under parity, i.e., it connects even-parity to odd-parity states but has vanishing blocks within a fixed-parity sector. In the same basis, define\n$$\nT \\equiv \\begin{pmatrix}\n0 & C \\\\\nC^{\\mathsf{T}} & 0\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}0.8 & 0.1\\\\ 0.05 & 0.6\\end{pmatrix}.\n$$\nUse the Feshbach projection formalism with orthogonal complementary projectors $\\hat{P}$ and $\\hat{Q}$ satisfying $\\hat{P}+\\hat{Q}=\\mathbb{I}$, $\\hat{P}\\hat{Q}=0$, and define the Bloch–Horowitz effective Hamiltonian in the model space,\n$$\nH_{\\mathrm{eff}}(E) \\equiv P H P + P H Q\\,\\big(E - Q H Q\\big)^{-1} Q H P,\n$$\nwhere $P$ and $Q$ are the matrix representations of $\\hat{P}$ and $\\hat{Q}$ in the chosen basis, and $E$ is a (generally complex) energy argument. Introduce an infinitesimal imaginary regulator $E \\to E + i\\,\\eta$ with $\\eta>0$ to render the resolvent well-defined and to expose possible non-Hermiticity when the projection violates a good symmetry. Throughout, use dimensionless units.\n\nStarting from these definitions and using only linear algebra, proceed as follows for each specified test case below.\n\n1. Construct $P$ by selecting a subset of basis indices as the model space, with $Q$ as its complement. Extract the blocks $P H P$, $P H Q$, $Q H Q$, and $Q H P$ from $H$ accordingly. Define $T_{PP}\\equiv P T P$ as the restriction of the transition operator to the model space.\n2. Choose a real reference energy $E$ equal to the lowest eigenvalue of $P H P$ for the given choice of $P$. Form the complex energy $E+i\\,\\eta$ for the specified $\\eta$.\n3. Compute the Bloch–Horowitz effective Hamiltonian $H_{\\mathrm{eff}}(E+i\\,\\eta)$ in the model space using the above expression. Quantify its non-Hermiticity by the Frobenius norm of its anti-Hermitian part,\n$$\n\\Delta_{\\mathrm{AH}} \\equiv \\big\\| H_{\\mathrm{eff}} - H_{\\mathrm{eff}}^{\\dagger}\\big\\|_{\\mathrm{F}}.\n$$\n4. Diagonalize $H_{\\mathrm{eff}}$ to obtain its right eigenpairs $\\{(\\lambda_k, |R_k\\rangle)\\}$. Order the eigenpairs by increasing real part $\\mathrm{Re}\\,\\lambda_k$. Compute also the left eigenvectors $\\{\\langle L_k|\\}$, defined by $\\langle L_k| H_{\\mathrm{eff}} = \\lambda_k \\langle L_k|$, by diagonalizing $H_{\\mathrm{eff}}^{\\dagger}$ and matching conjugate eigenvalues. Normalize them so that they are biorthonormal, i.e., $\\langle L_i \\vert R_j\\rangle = \\delta_{ij}$.\n5. Using these eigenvectors, define two transition strengths between the ground state ($k=0$) and first excited state ($k=1$) inside the model space:\n   - The biorthogonal strength $S_{\\mathrm{bi}}\\equiv \\big|\\langle L_0 \\vert T_{PP}\\vert R_1\\rangle\\big|^2$.\n   - The naive Hermitian-strength proxy $S_{\\mathrm{naive}}\\equiv \\big|\\langle R_0 \\vert T_{PP}\\vert R_1\\rangle\\big|^2$.\n   The difference $\\Delta_T \\equiv \\big|S_{\\mathrm{bi}}-S_{\\mathrm{naive}}\\big|$ isolates a non-Hermiticity-induced artifact, which must vanish if $H_{\\mathrm{eff}}$ is Hermitian.\n6. As a spectral non-Hermiticity diagnostic, compute $\\Sigma_{\\mathrm{Im}}\\equiv \\sum_k \\big|\\mathrm{Im}\\,\\lambda_k\\big|$.\n\nImplement a program that carries out the above for the following three test cases, all using zero-based indices for basis states:\n\n- Test case A (symmetry-preserving model space): $P=\\{0,1\\}$, so that the model space contains the full even-parity sector. Use $\\eta=10^{-8}$.\n- Test case B (symmetry-violating model space, weak regulator): $P=\\{0,2\\}$, mixing one even and one odd basis state. Use $\\eta=10^{-3}$.\n- Test case C (symmetry-violating model space, stronger regulator): $P=\\{0,2\\}$, with $\\eta=10^{-1}$.\n\nFor each test case, the program must output the triple of floating-point diagnostics $[\\Delta_{\\mathrm{AH}},\\ \\Sigma_{\\mathrm{Im}},\\ \\Delta_T]$, with each value rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list of these triples enclosed in square brackets in the order [A,B,C], for example, \"[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3]]\". No additional text is permitted in the output.", "solution": "The problem is valid as it is scientifically grounded in the principles of quantum mechanics and many-body theory, specifically the Feshbach projection formalism and the Bloch–Horowitz effective Hamiltonian. The setup is well-posed, with all necessary matrices, parameters, and computational steps clearly defined, allowing for a unique and verifiable solution.\n\nThe task is to analyze the effects of model-space truncations on a simple four-dimensional quantum system. We are given a parity-conserving Hamiltonian $\\hat{H}$ and a parity-odd transition operator $\\hat{T}$. We will study the properties of an effective Hamiltonian $\\hat{H}_{\\mathrm{eff}}$ constructed within a truncated model space defined by a projector $\\hat{P}$. The analysis focuses on three diagnostic quantities: the non-Hermiticity of the effective Hamiltonian, $\\Delta_{\\mathrm{AH}}$; a measure of the complex nature of its spectrum, $\\Sigma_{\\mathrm{Im}}$; and the difference between a biorthogonal and a naive transition strength, $\\Delta_T$.\n\nThe full-space Hamiltonian $H$ and transition operator $T$ are given in the basis $\\{|e_0\\rangle, |e_1\\rangle, |o_0\\rangle, |o_1\\rangle\\}$ (indices $0,1,2,3$ respectively) as:\n$$\nH = \\begin{pmatrix} -2.0 & -0.3 & 0 & 0 \\\\ -0.3 & -1.0 & 0 & 0 \\\\ 0 & 0 & -0.5 & -0.2 \\\\ 0 & 0 & -0.2 & 0.3 \\end{pmatrix}, \\quad T = \\begin{pmatrix} 0 & 0 & 0.8 & 0.1 \\\\ 0 & 0 & 0.05 & 0.6 \\\\ 0.8 & 0.05 & 0 & 0 \\\\ 0.1 & 0.6 & 0 & 0 \\end{pmatrix}\n$$\nThe Bloch–Horowitz effective Hamiltonian is defined for a complex energy $E$ as:\n$$\nH_{\\mathrm{eff}}(E) \\equiv P H P + P H Q (E - Q H Q)^{-1} Q H P\n$$\nwhere $P$ is the projector onto the model space and $Q = \\mathbb{I} - P$ is its complement. The energy argument is regularized as $E \\to E + i\\eta$.\n\nThe general procedure for each test case is as follows:\n1.  Define the projection operators $P$ and $Q$ based on the specified model-space indices. Partition the matrices $H$ and $T$ into the relevant blocks ($PHP$, $PHQ$, etc.).\n2.  Determine the reference energy $E$ as the lowest eigenvalue of the bare model-space Hamiltonian, $PHP$.\n3.  Construct the complex effective Hamiltonian $H_{\\mathrm{eff}}(E+i\\eta)$.\n4.  Compute the three diagnostic quantities: $\\Delta_{\\mathrm{AH}} = \\|H_{\\mathrm{eff}} - H_{\\mathrm{eff}}^{\\dagger}\\|_{\\mathrm{F}}$, $\\Sigma_{\\mathrm{Im}} = \\sum_k |\\mathrm{Im}\\,\\lambda_k|$, and $\\Delta_T = |S_{\\mathrm{bi}} - S_{\\mathrm{naive}}|$. This requires diagonalizing $H_{\\mathrm{eff}}$ to find its eigenvalues $\\lambda_k$ and its corresponding left $\\langle L_k|$ and right $|R_k\\rangle$ eigenvectors, which are normalized to be biorthonormal, $\\langle L_i|R_j\\rangle = \\delta_{ij}$.\n\n**Test Case A: Symmetry-Preserving Truncation**\n- **Model Space:** The model space is defined by $P$ projecting onto indices $\\{0, 1\\}$, which corresponds to the even-parity sector $\\{|e_0\\rangle, |e_1\\rangle\\}$. The complementary space $Q$ is the odd-parity sector, indices $\\{2, 3\\}$.\n- **Effective Hamiltonian:** The full Hamiltonian $H$ is block-diagonal with respect to parity. Therefore, the off-diagonal blocks $PHQ$ and $QHP$ are null matrices. The formula for the effective Hamiltonian simplifies dramatically:\n  $$\n  H_{\\mathrm{eff}} = PHP + \\mathbf{0} \\cdot (E+i\\eta - QHQ)^{-1} \\cdot \\mathbf{0} = PHP = H_{\\mathrm{even}} = \\begin{pmatrix}-2.0 & -0.3 \\\\ -0.3 & -1.0\\end{pmatrix}\n  $$\n- **Analysis:** The resulting $H_{\\mathrm{eff}}$ is a real, symmetric matrix, and thus Hermitian. For any Hermitian matrix:\n    - The anti-Hermitian part $H_{\\mathrm{eff}} - H_{\\mathrm{eff}}^{\\dagger}$ is zero, so $\\Delta_{\\mathrm{AH}} = 0$.\n    - The eigenvalues are purely real, so $\\Sigma_{\\mathrm{Im}} = 0$.\n    - The left and right eigenvectors are identical (i.e., $\\langle L_k| = \\langle R_k|$), which means $S_{\\mathrm{bi}} = S_{\\mathrm{naive}}$ and thus $\\Delta_T = 0$.\n- **Result:** For the symmetry-preserving case, all non-Hermiticity diagnostics are identically zero, as expected. The result is $[0.0, 0.0, 0.0]$.\n\n**Test Cases B and C: Symmetry-Violating Truncation**\n- **Model Space:** The model space is defined by $P$ projecting onto indices $\\{0, 2\\}$, a mixture of an even-parity state ($|e_0\\rangle$) and an odd-parity state ($|o_0\\rangle$). The $Q$-space contains indices $\\{1, 3\\}$. This truncation explicitly breaks parity conservation within the model space.\n- **Matrix Blocks:**\n  $PHP = \\begin{pmatrix} -2.0 & 0 \\\\ 0 & -0.5 \\end{pmatrix}$, $QHQ = \\begin{pmatrix} -1.0 & 0 \\\\ 0 & 0.3 \\end{pmatrix}$, $PHQ = \\begin{pmatrix} -0.3 & 0 \\\\ 0 & -0.2 \\end{pmatrix}$, $T_{PP} = \\begin{pmatrix} 0 & 0.8 \\\\ 0.8 & 0 \\end{pmatrix}$.\n- **Effective Hamiltonian:** The lowest eigenvalue of $PHP$ is $E = -2.0$. The correction term $\\Delta H = PHQ(E+i\\eta - QHQ)^{-1}QHP$ is computed. Due to the specific diagonal structure of the extracted blocks, $\\Delta H$ is also diagonal:\n  $$\n  \\Delta H = \\begin{pmatrix} \\frac{(-0.3)^2}{-2.0+i\\eta - (-1.0)} & 0 \\\\ 0 & \\frac{(-0.2)^2}{-2.0+i\\eta - 0.3} \\end{pmatrix} = \\begin{pmatrix} \\frac{0.09}{-1.0+i\\eta} & 0 \\\\ 0 & \\frac{0.04}{-2.3+i\\eta} \\end{pmatrix}\n  $$\n  $H_{\\mathrm{eff}} = PHP + \\Delta H$ is thus a diagonal but non-Hermitian matrix, as its diagonal elements are complex for $\\eta>0$.\n- **Analysis:**\n    - Since $H_{\\mathrm{eff}}$ is non-Hermitian, its anti-Hermitian part is non-zero, yielding $\\Delta_{\\mathrm{AH}} > 0$. Its eigenvalues are complex, so $\\Sigma_{\\mathrm{Im}} > 0$. Both values increase with $\\eta$.\n    - A crucial feature of this specific problem is that the resulting $H_{\\mathrm{eff}}$ is a diagonal matrix. Any diagonal matrix is also a *normal matrix* (it commutes with its own conjugate transpose: $H_{\\mathrm{eff}}H_{\\mathrm{eff}}^{\\dagger} = H_{\\mathrm{eff}}^{\\dagger}H_{\\mathrm{eff}}$). A fundamental theorem of linear algebra states that a matrix is normal if and only if it possesses a complete orthonormal set of eigenvectors. This implies that its left and right eigenvectors are the same. In this case, the right eigenvectors are the standard basis vectors $|R_0\\rangle=(1,0)^T$ and $|R_1\\rangle=(0,1)^T$, and the left eigenvectors are identical.\n    - Because $\\langle L_k| = \\langle R_k|$, the two definitions of transition strength become identical: $S_{\\mathrm{bi}} \\equiv |\\langle L_0 | T_{PP} | R_1\\rangle|^2 = |\\langle R_0 | T_{PP} | R_1\\rangle|^2 \\equiv S_{\\mathrm{naive}}$.\n    - Therefore, their difference $\\Delta_T$ is exactly zero, even though $H_{\\mathrm{eff}}$ is non-Hermitian. This illustrates that non-Hermiticity alone is not sufficient to guarantee $\\Delta_T \\neq 0$; the effective Hamiltonian must also be non-normal, which is the more general outcome of symmetry-violating truncations.\n- **Result:** For cases B ($\\eta=10^{-3}$) and C ($\\eta=10^{-1}$), we compute non-zero values for $\\Delta_{\\mathrm{AH}}$ and $\\Sigma_{\\mathrm{Im}}$, while $\\Delta_T$ remains zero. The larger regulator $\\eta$ in case C results in larger values for the non-Hermiticity measures.", "answer": "[[0.000000, 0.000000, 0.000000],[0.000181, 0.000098, 0.000000],[0.018063, 0.009756, 0.000000]]", "id": "3570078"}]}