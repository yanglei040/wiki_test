{"hands_on_practices": [{"introduction": "Before employing the Woods-Saxon potential in complex quantum mechanical calculations, it is essential to build an intuition for its shape and the physical meaning of its parameters. This first exercise provides a direct way to probe the potential's form by calculating its value at three critical locations: the center of the nucleus, the characteristic nuclear radius, and a point within the diffuse surface region. By performing these calculations, you will solidify your understanding of how the parameters $V_0$, $R$, and $a$ govern the potential's depth, extent, and surface thickness, respectively [@problem_id:3608484].", "problem": "In the mean-field description of finite nuclei, the central single-particle potential is widely modeled by the Woods–Saxon form, which follows the same functional dependence as the two-parameter Fermi distribution for the nuclear density. The central potential is taken as\n$$\nV(r) \\equiv -\\frac{V_{0}}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)},\n$$\nwhere $V_{0}0$ is the depth, $a$ is the surface diffuseness, and $R$ is the geometric radius parameter given by the empirical scaling law\n$$\nR \\equiv r_{0} A^{1/3},\n$$\nwith $A$ the mass number and $r_{0}$ a constant of order a femtometer. Starting from these definitions and the physical picture of a saturated interior density with a diffuse surface, derive $V(r)$ evaluated at $r=0$, $r=R$, and $r=R+2a$ for a heavy nucleus with $A=208$, $r_{0}=1.25\\,\\mathrm{fm}$, $a=0.65\\,\\mathrm{fm}$, and $V_{0}=50\\,\\mathrm{MeV}$. Compute numerical values for $V(0)$, $V(R)$, and $V(R+2a)$.\n\nReport your three answers as energies in $\\mathrm{MeV}$ and round each to four significant figures. Briefly interpret the three values in terms of the interior saturation and surface diffuseness intrinsic to the Woods–Saxon form. Your final numerical answers must appear in the order $V(0)$, $V(R)$, $V(R+2a)$.", "solution": "The problem is validated as follows.\n\n**Step 1: Extract Givens**\nThe givens are:\n-   The Woods-Saxon potential form: $V(r) \\equiv -\\frac{V_{0}}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)}$\n-   Potential depth: $V_{0}  0$\n-   Surface diffuseness: $a$\n-   Geometric radius parameter: $R \\equiv r_{0} A^{1/3}$\n-   Mass number: $A = 208$\n-   Radius constant: $r_{0}=1.25\\,\\mathrm{fm}$\n-   Surface diffuseness value: $a=0.65\\,\\mathrm{fm}$\n-   Potential depth value: $V_{0}=50\\,\\mathrm{MeV}$\nThe task is to compute numerical values for $V(0)$, $V(R)$, and $V(R+2a)$ and interpret the results.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. The Woods-Saxon potential is a standard and physically well-motivated phenomenological model for the nuclear mean field, derived from the observed saturation of nuclear density in the interior and a diffuse surface. The functional form, the radius parameterization $R = r_{0}A^{1/3}$, and the specific numerical values provided for $V_{0}$, $a$, $r_{0}$, and $A$ are all standard and realistic for a heavy nucleus like $^{208}\\mathrm{Pb}$. The problem is well-posed, as it asks for the evaluation of a defined function at specific points, for which a unique solution exists. The problem is also objective, stated in precise mathematical and physical terms without ambiguity. No flaws, such as scientific unsoundness, incompleteness, or vagueness, are present.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe objective is to calculate the potential $V(r)$ at three radial distances, $r=0$, $r=R$, and $r=R+2a$, using the provided parameters for a heavy nucleus.\n\nFirst, we calculate the nuclear radius parameter $R$ for the nucleus with mass number $A=208$.\nUsing the given formula $R = r_{0} A^{1/3}$ and the values $r_{0}=1.25\\,\\mathrm{fm}$ and $A=208$:\n$$\nR = (1.25\\,\\mathrm{fm}) \\times (208)^{1/3}\n$$\nThe cube root of $208$ is approximately $5.9252$.\n$$\nR \\approx 1.25 \\times 5.9252 \\,\\mathrm{fm} \\approx 7.4065\\,\\mathrm{fm}\n$$\nWe will use this value for $R$ in the subsequent calculations.\n\nNext, we evaluate the potential $V(r)$ at the three specified points.\n\n**1. Potential at the center, $V(0)$**\nWe set $r=0$ in the Woods-Saxon formula:\n$$\nV(0) = -\\frac{V_{0}}{1+\\exp\\left(\\frac{0-R}{a}\\right)} = -\\frac{V_{0}}{1+\\exp\\left(-\\frac{R}{a}\\right)}\n$$\nLet's evaluate the argument of the exponential, $-R/a$:\n$$\n-\\frac{R}{a} \\approx -\\frac{7.4065\\,\\mathrm{fm}}{0.65\\,\\mathrm{fm}} \\approx -11.3946\n$$\nSince $R \\gg a$, this is a large negative number. The exponential term $\\exp(-R/a)$ will be very close to zero.\n$$\n\\exp(-11.3946) \\approx 1.1258 \\times 10^{-5}\n$$\nThis demonstrates that for a heavy nucleus, the potential at the center is very close to the full depth $-V_{0}$. Substituting the values:\n$$\nV(0) = -\\frac{50\\,\\mathrm{MeV}}{1+\\exp(-11.3946)} \\approx -\\frac{50\\,\\mathrm{MeV}}{1+1.1258 \\times 10^{-5}} \\approx -\\frac{50\\,\\mathrm{MeV}}{1.000011258} \\approx -49.999437\\,\\mathrm{MeV}\n$$\nRounding to four significant figures, we get $V(0) = -50.00\\,\\mathrm{MeV}$.\n\n**2. Potential at the radius $R$, $V(R)$**\nWe set $r=R$ in the Woods-Saxon formula:\n$$\nV(R) = -\\frac{V_{0}}{1+\\exp\\left(\\frac{R-R}{a}\\right)} = -\\frac{V_{0}}{1+\\exp\\left(\\frac{0}{a}\\right)} = -\\frac{V_{0}}{1+\\exp(0)}\n$$\nSince $\\exp(0) = 1$, the expression simplifies exactly to:\n$$\nV(R) = -\\frac{V_{0}}{1+1} = -\\frac{V_{0}}{2}\n$$\nSubstituting the value $V_{0}=50\\,\\mathrm{MeV}$:\n$$\nV(R) = -\\frac{50\\,\\mathrm{MeV}}{2} = -25\\,\\mathrm{MeV}\n$$\nTo four significant figures, this is $V(R) = -25.00\\,\\mathrm{MeV}$.\n\n**3. Potential at $r=R+2a$, $V(R+2a)$**\nWe set $r=R+2a$ in the Woods-Saxon formula:\n$$\nV(R+2a) = -\\frac{V_{0}}{1+\\exp\\left(\\frac{(R+2a)-R}{a}\\right)} = -\\frac{V_{0}}{1+\\exp\\left(\\frac{2a}{a}\\right)} = -\\frac{V_{0}}{1+\\exp(2)}\n$$\nThis expression is independent of the specific values of $R$ and $a$, as they cancel in the exponent. Substituting $V_{0}=50\\,\\mathrm{MeV}$ and using the value of $e \\approx 2.71828$:\n$$\nV(R+2a) = -\\frac{50\\,\\mathrm{MeV}}{1+e^2} \\approx -\\frac{50\\,\\mathrm{MeV}}{1+7.389056} = -\\frac{50\\,\\mathrm{MeV}}{8.389056} \\approx -5.9599\\,\\mathrm{MeV}\n$$\nRounding to four significant figures, we get $V(R+2a) = -5.960\\,\\mathrm{MeV}$.\n\n**Interpretation of the Results**\n\n-   $V(0) \\approx -50.00\\,\\mathrm{MeV}$: The potential at the center of the nucleus is almost equal to the maximum depth $-V_{0}$. This reflects the physical picture of nuclear saturation, where the nuclear density is constant deep within a heavy nucleus. The condition $R \\gg a$ ensures that the potential well has a flat bottom, characteristic of the saturated nuclear interior.\n\n-   $V(R) = -25.00\\,\\mathrm{MeV}$: The potential at the radius $r=R$ is exactly half of the central potential depth. This is by definition of the radius parameter $R$ in this context, which corresponds to the \"half-potential radius\". This point is conventionally taken to define the effective boundary or \"surface\" of the nucleus.\n\n-   $V(R+2a) \\approx -5.960\\,\\mathrm{MeV}$: This point lies in the \"surface\" region, a distance $2a$ beyond the half-potential radius. The potential has fallen to approximately $12\\%$ of its central value ($|-5.960|/|-50| \\approx 0.119$). The diffuseness parameter $a$ quantifies the thickness of this surface region over which the potential (and the underlying nuclear density) transitions from its interior value towards zero. The rapid decay of the potential illustrates the diffuse but relatively thin nature of the nuclear surface.", "answer": "$$\n\\boxed{\\begin{pmatrix} -50.00  -25.00  -5.960 \\end{pmatrix}}\n$$", "id": "3608484"}, {"introduction": "A primary application of the Woods-Saxon potential is to determine the allowed energy levels of a nucleon within the nuclear mean field. This practice guides you through the complete numerical solution of the radial Schrödinger equation to find the energy of a bound state ($E \\lt 0$). You will discretize the quantum mechanical problem using a finite-difference scheme, construct the Hamiltonian matrix, and solve the resulting eigenvalue problem [@problem_id:3608501]. This exercise is not only fundamental to computational nuclear structure but also introduces the critical concept of numerical convergence by asking you to quantify the sensitivity of your results to the artificial boundary of the computational domain.", "problem": "You are asked to write a complete, runnable program that computes bound-state properties for a single nucleon moving in a spherically symmetric Woods–Saxon potential and verifies the normalization of the reduced radial wavefunction while quantifying the sensitivity of the lowest eigenvalue to the placement of the outer boundary. The underlying physics is the time-independent radial Schrödinger equation for a single particle of reduced mass $\\mu$ in a central potential with orbital angular momentum quantum number $l$, written for the reduced radial wavefunction $u_l(r)$ as\n$$\n\\left[-\\frac{\\hbar^2}{2\\mu}\\frac{d^2}{dr^2} + V_{\\text{WS}}(r) + \\frac{\\hbar^2 l(l+1)}{2\\mu r^2}\\right] u_l(r) = E \\, u_l(r),\n$$\nwith boundary conditions $u_l(0)=0$ and $u_l(r\\to\\infty)=0$. The Woods–Saxon potential is\n$$\nV_{\\text{WS}}(r) = -\\frac{V_0}{1+\\exp\\left(\\frac{r - R_0}{a}\\right)},\n$$\nwhere $V_00$ is the depth, $R_0$ is a radius, and $a$ is the diffuseness. In this problem, you will use the constant $c \\equiv \\hbar^2/(2\\mu)$ in units of megaelectronvolts femtometer squared ($\\text{MeV}\\cdot\\text{fm}^2$) appropriate for a nucleon in a heavy nucleus; take $c = 20.73553\\,\\text{MeV}\\cdot\\text{fm}^2$. All lengths must be in femtometers ($\\text{fm}$) and all energies must be in megaelectronvolts ($\\text{MeV}$). Angles do not appear in this one-dimensional radial reduction, so no angle unit is required. You must enforce the normalization for the reduced radial wavefunction $u_l(r)$ as\n$$\n\\int_{0}^{\\infty} |u_l(r)|^2 \\, dr = 1.\n$$\nIn numerical practice, the domain is truncated to $[0, R_{\\max}]$ with $u_l(0)=0$ and $u_l(R_{\\max})=0$. You must:\n- Discretize the operator on a uniform radial grid to form a symmetric tridiagonal representation of the Hamiltonian using a second-order finite-difference scheme or an algorithm of equivalent or higher accuracy derived from first principles. Solve for the lowest bound-state eigenvalue $E0$ and the associated eigenvector (the reduced radial wavefunction samples) for each specified parameter set and outer boundary $R_{\\max}$. Do not assume any shortcut formulas not derived from the radial Schrödinger equation.\n- Verify the normalization by rescaling the discrete eigenvector so that a numerical quadrature approximating $\\int_0^{R_{\\max}} |u_l(r)|^2 \\, dr$ equals $1$ to within numerical precision. Report the absolute deviation from unity after your normalization as a nonnegative float for each case.\n- Quantify the sensitivity of the lowest eigenvalue to the outer boundary by computing the absolute difference between the energies obtained with two different outer boundaries $R_{\\max}^{(1)}$ and $R_{\\max}^{(2)}$, i.e., report $|E(R_{\\max}^{(2)}) - E(R_{\\max}^{(1)})|$ in $\\text{MeV}$.\n\nYou must implement the physics and numerics from the following fundamental base:\n- The time-independent Schrödinger equation in radial form with the centrifugal term as written above.\n- The Woods–Saxon central potential as written above.\n- Standard second-order finite-difference discretization of the second derivative on a uniform grid and Dirichlet boundary conditions at $r=0$ and $r=R_{\\max}$.\n- Linear algebra for symmetric tridiagonal eigenproblems to obtain the smallest eigenvalue and corresponding eigenvector.\n\nYou must not use any unphysical shortcuts and you must not assume any energy eigenvalue formula not derived from the operator discretization.\n\nImplement your program to handle the following test suite of three cases. In each case, compute the lowest bound-state energy for two outer boundaries $R_{\\max}^{(1)}$ and $R_{\\max}^{(2)}$, verify the normalization for each, and report:\n- The maximum absolute deviation from unity across the two normalizations, i.e., $\\max\\left(\\left|\\int_0^{R_{\\max}^{(1)}} |u_l(r)|^2 dr - 1\\right|,\\left|\\int_0^{R_{\\max}^{(2)}} |u_l(r)|^2 dr - 1\\right|\\right)$, as a float in dimensionless units.\n- The absolute energy difference $|E(R_{\\max}^{(2)}) - E(R_{\\max}^{(1)})|$ in $\\text{MeV}$ as a float.\n\nUse the following parameter sets (all lengths in $\\text{fm}$, energies in $\\text{MeV}$):\n- Case A (a typical medium nucleus and $s$-wave): $V_0 = 50$, $R_0 = 4.27$, $a = 0.65$, $l = 0$, $R_{\\max}^{(1)} = 15$, $R_{\\max}^{(2)} = 25$, with $N = 1800$ interior grid points for both $R_{\\max}^{(1)}$ and $R_{\\max}^{(2)}$.\n- Case B (a heavy nucleus and higher $l$): $V_0 = 50$, $R_0 = 7.40$, $a = 0.65$, $l = 3$, $R_{\\max}^{(1)} = 20$, $R_{\\max}^{(2)} = 30$, with $N = 2200$ interior grid points for both $R_{\\max}^{(1)}$ and $R_{\\max}^{(2)}$.\n- Case C (a near-threshold shallow case): $V_0 = 40$, $R_0 = 4.50$, $a = 0.70$, $l = 0$, $R_{\\max}^{(1)} = 20$, $R_{\\max}^{(2)} = 30$, with $N = 2200$ interior grid points for both $R_{\\max}^{(1)}$ and $R_{\\max}^{(2)}$.\n\nNumerical requirements:\n- Use a uniform grid of $N$ interior points in $(0, R_{\\max})$ with Dirichlet boundaries at $r=0$ and $r=R_{\\max}$.\n- Use a symmetric tridiagonal representation of the kinetic-energy operator derived from the second-order central difference for $d^2/dr^2$ and add the Woods–Saxon and centrifugal terms to the diagonal.\n- Use a reliable symmetric tridiagonal eigensolver to extract the smallest eigenvalue and corresponding eigenvector. Ensure you select the bound state (negative energy). If your discretization yields only positive energies for a case, your program must still complete; for this test suite, physically sensible bound states are expected with the provided parameters.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The entries must be ordered as follows: for Case A, the normalization deviation, then the energy sensitivity; for Case B, the normalization deviation, then the energy sensitivity; for Case C, the normalization deviation, then the energy sensitivity. In total, six floats.\n- Each float must be printed in scientific notation with six digits after the decimal point.\n- The final line must look like $[x_1,x_2,x_3,x_4,x_5,x_6]$ where each $x_i$ is a float as specified above.\n\nAll energies must be reported in $\\text{MeV}$ and all lengths in $\\text{fm}$, and all normalization integrals are dimensionless. No user input is permitted; all parameters are hardcoded as specified above. The algorithmic design must start from and be justified by the fundamental equations listed earlier, without shortcut formulas provided by this problem statement.", "solution": "The problem requires the numerical solution of the one-dimensional, time-independent radial Schrödinger equation for a single nucleon of reduced mass $\\mu$ in a spherically symmetric potential. The governing equation for the reduced radial wavefunction $u_l(r)$ is:\n$$\n\\left[-\\frac{\\hbar^2}{2\\mu}\\frac{d^2}{dr^2} + V_{\\text{eff}, l}(r)\\right] u_l(r) = E \\, u_l(r)\n$$\nwhere $E$ is the energy eigenvalue. The effective potential $V_{\\text{eff}, l}(r)$ is the sum of the Woods–Saxon potential $V_{\\text{WS}}(r)$ and the centrifugal potential $V_{\\text{cent}, l}(r)$:\n$$\nV_{\\text{eff}, l}(r) = V_{\\text{WS}}(r) + V_{\\text{cent}, l}(r) = -\\frac{V_0}{1+\\exp\\left(\\frac{r - R_0}{a}\\right)} + \\frac{\\hbar^2 l(l+1)}{2\\mu r^2}\n$$\nUsing the provided constant $c \\equiv \\hbar^2/(2\\mu)$, the Schrödinger equation can be rewritten as:\n$$\n-c \\frac{d^2u_l(r)}{dr^2} + \\left( V_{\\text{WS}}(r) + c\\frac{l(l+1)}{r^2} \\right) u_l(r) = E \\, u_l(r)\n$$\nThe physical boundary conditions for a bound state are $u_l(0) = 0$ and $u_l(r \\to \\infty) = 0$. For a numerical solution, we truncate the infinite domain to a finite interval $[0, R_{\\max}]$ and impose the Dirichlet boundary conditions $u_l(0) = 0$ and $u_l(R_{\\max}) = 0$.\n\nThe first step in the numerical solution is to discretize the radial domain. We use a uniform grid with $N$ interior points. Let the total number of grid intervals be $N+1$. The grid spacing is then $h = R_{\\max} / (N+1)$. The grid points are $r_i = i \\cdot h$ for $i = 0, 1, \\dots, N+1$. The wavefunction values at these points are denoted by $u_i \\equiv u_l(r_i)$. The boundary conditions impose $u_0 = 0$ and $u_{N+1} = 0$. We need to solve for the wavefunction at the $N$ interior points $r_1, \\dots, r_N$.\n\nThe second derivative term, $d^2u_l/dr^2$, is approximated using the second-order central finite-difference formula:\n$$\n\\frac{d^2u_l}{dr^2}\\bigg|_{r=r_i} \\approx \\frac{u_l(r_{i+1}) - 2u_l(r_i) + u_l(r_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\nSubstituting this approximation into the Schrödinger equation for each interior grid point $r_i$ ($i = 1, \\dots, N$) yields a system of linear algebraic equations:\n$$\n-c \\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} \\right) + V_{\\text{eff}, l}(r_i) u_i = E u_i\n$$\nRearranging the terms, we get:\n$$\n-\\frac{c}{h^2}u_{i-1} + \\left( \\frac{2c}{h^2} + V_{\\text{eff}, l}(r_i) \\right) u_i - \\frac{c}{h^2}u_{i+1} = E u_i\n$$\nThis system of $N$ equations can be written in matrix form as a standard eigenvalue problem, $\\mathbf{H}\\vec{u} = E\\vec{u}$, where $\\vec{u} = (u_1, u_2, \\dots, u_N)^T$ is the vector of wavefunction values at the interior grid points, and $\\mathbf{H}$ is the discretized Hamiltonian matrix. The matrix $\\mathbf{H}$ is a real, symmetric, and tridiagonal matrix. Its elements are:\n- Diagonal elements:\n$$\nH_{ii} = \\frac{2c}{h^2} + V_{\\text{eff}, l}(r_i) = \\frac{2c}{h^2} - \\frac{V_0}{1+\\exp\\left(\\frac{r_i - R_0}{a}\\right)} + c\\frac{l(l+1)}{r_i^2}\n$$\n- Off-diagonal elements ($|i-j|=1$):\n$$\nH_{i,i+1} = H_{i+1,i} = -\\frac{c}{h^2}\n$$\nAll other elements are zero. Note that for $l=0$, the centrifugal term vanishes. For $l0$, the term is well-defined as our interior grid starts at $r_1 = h  0$.\n\nWe solve this matrix eigenvalue problem to find the eigenvalues (energy levels) and eigenvectors (wavefunctions). The problem specifically asks for the lowest bound state, which corresponds to the smallest eigenvalue of the matrix $\\mathbf{H}$. Specialized numerical libraries provide efficient eigensolvers for symmetric tridiagonal matrices, such as `scipy.linalg.eigh_tridiagonal`. This function returns the eigenvalues in ascending order, so the first eigenvalue is the desired ground state energy $E$.\n\nThe corresponding eigenvector $\\vec{v} = (v_1, \\dots, v_N)^T$ must be normalized according to the physical condition $\\int_0^{R_{\\max}} |u_l(r)|^2 dr = 1$. The numerical eigenvectors are typically returned with a unit L2-norm, i.e., $\\sum_{i=1}^N v_i^2 = 1$. To connect this to the physical normalization, we must approximate the integral. Using the trapezoidal rule for the integral on the grid points $r_0, \\dots, r_{N+1}$ and using the boundary conditions $u_0 = u_{N+1} = 0$, we have:\n$$\n\\int_0^{R_{\\max}} |u_l(r)|^2 dr \\approx h \\sum_{i=1}^N |u_i|^2 = 1\n$$\nThe relationship between our numerically calculated state vector $\\vec{u}$ and the solver-provided eigenvector $\\vec{v}$ is $\\vec{u} = K\\vec{v}$ where $K$ is a normalization constant. Substituting this into the integral approximation gives $h \\sum_{i=1}^N (K v_i)^2 = K^2 h \\sum_{i=1}^N v_i^2 = 1$. Since $\\sum_{i=1}^N v_i^2 = 1$, we find $K^2 h = 1$, so $K = 1/\\sqrt{h}$. Thus, the correctly normalized discrete wavefunction is $u_i = v_i / \\sqrt{h}$.\n\nFor verification of the normalization, we compute the integral numerically after this scaling:\n$$\nI_{\\text{norm}} = h \\sum_{i=1}^N u_i^2 = h \\sum_{i=1}^N \\left(\\frac{v_i}{\\sqrt{h}}\\right)^2 = \\sum_{i=1}^N v_i^2\n$$\nThe absolute deviation from unity is $|I_{\\text{norm}} - 1| = |\\sum_{i=1}^N v_i^2 - 1|$. As the eigensolver returns an eigenvector with $\\sum_i v_i^2$ already very close to $1$, this deviation is expected to be on the order of machine precision. For each case, we compute this for both $R_{\\max}^{(1)}$ and $R_{\\max}^{(2)}$ and report the maximum of the two deviations.\n\nFinally, for each set of physical parameters, we perform the entire calculation for two different outer boundaries, $R_{\\max}^{(1)}$ and $R_{\\max}^{(2)}$, obtaining two ground state energies, $E(R_{\\max}^{(1)})$ and $E(R_{\\max}^{(2)})$. The sensitivity to the boundary placement is quantified by the absolute difference $|E(R_{\\max}^{(2)}) - E(R_{\\max}^{(1)})|$. This entire procedure is repeated for each of the three test cases provided.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to solve the Woods-Saxon potential problem for all test cases.\n    \"\"\"\n    \n    # Define the physical constant and test cases.\n    # c = hbar^2 / (2*mu) in MeV*fm^2\n    C_CONST = 20.73553\n\n    test_cases = [\n        # Case A: V0, R0, a, l, Rmax1, Rmax2, N\n        (50.0, 4.27, 0.65, 0, 15.0, 25.0, 1800),\n        # Case B: V0, R0, a, l, Rmax1, Rmax2, N\n        (50.0, 7.40, 0.65, 3, 20.0, 30.0, 2200),\n        # Case C: V0, R0, a, l, Rmax1, Rmax2, N\n        (40.0, 4.50, 0.70, 0, 20.0, 30.0, 2200),\n    ]\n\n    results = []\n    \n    for case_params in test_cases:\n        v0, r0, a_diff, l, r_max1, r_max2, n_points = case_params\n\n        # Calculate properties for the first boundary R_max^(1)\n        energy1, norm_dev1 = compute_eigenstate(\n            v0, r0, a_diff, l, r_max1, n_points, C_CONST\n        )\n        \n        # Calculate properties for the second boundary R_max^(2)\n        energy2, norm_dev2 = compute_eigenstate(\n            v0, r0, a_diff, l, r_max2, n_points, C_CONST\n        )\n        \n        # Calculate the required outputs for the case\n        max_norm_deviation = max(norm_dev1, norm_dev2)\n        energy_sensitivity = abs(energy2 - energy1)\n        \n        results.extend([max_norm_deviation, energy_sensitivity])\n        \n    # Format and print the final results as specified.\n    print(f\"[{','.join(['{:.6e}'.format(x) for x in results])}]\")\n\n\ndef compute_eigenstate(v0, r0, a_diff, l, r_max, n_points, c):\n    \"\"\"\n    Solves the radial Schrodinger equation for a given set of parameters.\n\n    Args:\n        v0 (float): Potential depth in MeV.\n        r0 (float): Nuclear radius in fm.\n        a_diff (float): Diffuseness parameter in fm.\n        l (int): Orbital angular momentum quantum number.\n        r_max (float): Outer boundary of the radial grid in fm.\n        n_points (int): Number of interior grid points.\n        c (float): Constant hbar^2 / (2*mu) in MeV*fm^2.\n\n    Returns:\n        tuple: A tuple containing:\n            - E_min (float): The lowest energy eigenvalue in MeV.\n            - norm_deviation (float): The absolute deviation of the eigenvector's\n                                      squared norm from 1.\n    \"\"\"\n    # 1. Set up the radial grid\n    # h is the uniform grid spacing. N interior points mean N+1 intervals.\n    h = r_max / (n_points + 1)\n    # r is the array of interior grid points r_1, r_2, ..., r_N\n    r = np.arange(1, n_points + 1) * h\n    \n    # 2. Define the potential on the grid\n    # Woods-Saxon potential\n    v_ws = -v0 / (1.0 + np.exp((r - r0) / a_diff))\n    \n    # Centrifugal potential. This is safe as r  0 for all points.\n    if l  0:\n        v_cent = c * l * (l + 1) / (r**2)\n    else:\n        v_cent = 0.0\n    \n    v_eff = v_ws + v_cent\n\n    # 3. Construct the Hamiltonian matrix elements\n    # The matrix is symmetric and tridiagonal. We only need the diagonal\n    # and the first off-diagonal.\n    \n    # Kinetic energy term contribution to the diagonal\n    kinetic_diag = 2.0 * c / (h**2)\n    \n    # Full diagonal of the Hamiltonian matrix\n    diagonal = kinetic_diag + v_eff\n    \n    # Off-diagonal elements (constant for a uniform grid)\n    off_diagonal = np.full(n_points - 1, -c / (h**2))\n    \n    # 4. Solve the eigenvalue problem\n    # eigh_tridiagonal is a specialized solver for symmetric tridiagonal matrices.\n    # It returns eigenvalues in ascending order and corresponding eigenvectors.\n    eigenvalues, eigenvectors = eigh_tridiagonal(diagonal, off_diagonal)\n\n    # 5. Extract results for the lowest bound state\n    # The lowest eigenvalue is the ground state energy\n    e_min = eigenvalues[0]\n    \n    # The corresponding eigenvector is the first column of the result\n    v_min = eigenvectors[:, 0]\n    \n    # 6. Verify normalization\n    # The solver returns eigenvectors normalized to have a vector L2 norm of 1.\n    # The normalization integral is approx sum(v_i^2), so the deviation\n    # is |sum(v_i^2) - 1|.\n    norm_sq = np.sum(v_min**2)\n    norm_deviation = np.abs(norm_sq - 1.0)\n    \n    return e_min, norm_deviation\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3608501"}, {"introduction": "While bound states represent the stable energy levels of a nucleus, much of nuclear dynamics involves quasi-stable, short-lived states known as resonances, which exist at positive energies ($E \\gt 0$). This advanced practice introduces a powerful computational technique, the stabilization method, to identify these resonances. By solving the Schrödinger equation within a finite box and systematically varying the box size, you can distinguish true physical resonances, whose energies remain stable, from unphysical \"box states\" that are mere artifacts of the boundary conditions [@problem_id:3608560]. This exercise provides hands-on experience with a method crucial for studying reactions and the structure of nuclei far from stability.", "problem": "Consider a single nucleon moving in a spherically symmetric mean-field described by the Woods–Saxon potential. The nucleon is confined to a spherical box of radius $R_{\\text{box}}$ by imposing Dirichlet boundary conditions at $r=0$ and $r=R_{\\text{box}}$. The aim is to quantify box-discretization artifacts by studying the dependence of positive-energy pseudostate eigenvalues on $R_{\\text{box}}$ and to distinguish true resonances from box states based on stabilization with respect to $R_{\\text{box}}$.\n\nFundamental base: The reduced radial wavefunction $u_{\\ell}(r)$ for orbital angular momentum $\\ell$ satisfies the radial time-independent Schrödinger equation\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2 u_{\\ell}(r)}{dr^2} + \\left[V(r) + \\frac{\\hbar^2 \\ell(\\ell+1)}{2 m r^2}\\right] u_{\\ell}(r) = E\\, u_{\\ell}(r),\n$$\nwith boundary conditions $u_{\\ell}(0)=0$ and $u_{\\ell}(R_{\\text{box}})=0$. The Woods–Saxon potential is defined by\n$$\nV(r) = -\\frac{V_0}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)},\n$$\nwhere $V_0$ is the depth, $R$ is the radius parameter, and $a$ is the diffuseness. Use the standard single-nucleon constant $\\frac{\\hbar^2}{2m} = 20.735\\ \\text{MeV fm}^2$.\n\nTask: Discretize the radial Schrödinger equation on a uniform grid in $r \\in (0,R_{\\text{box}})$ using second-order central differences to approximate $\\frac{d^2}{dr^2}$ and enforce Dirichlet boundary conditions at the box edges. Construct the tridiagonal Hamiltonian matrix corresponding to the operator $-\\frac{\\hbar^2}{2m}\\frac{d^2}{dr^2} + V_{\\text{eff}}(r)$, where $V_{\\text{eff}}(r)=V(r)+\\frac{\\hbar^2 \\ell(\\ell+1)}{2mr^2}$, and compute its eigenvalues $\\{E_n\\}$.\n\nResonance identification criterion: A true resonance manifests as a positive-energy eigenvalue that is approximately independent of $R_{\\text{box}}$. For a given set of $R_{\\text{box}}$ values, identify clusters of positive eigenvalues across all boxes such that the maximum energy spread within a cluster does not exceed a tolerance $\\Delta E_{\\text{cluster}}$. A cluster that contains at least one eigenvalue from each distinct $R_{\\text{box}}$ in the set and satisfies the spread criterion is to be counted as a resonance. The energies are measured in $\\text{MeV}$, and the clustering tolerance must be specified in $\\text{MeV}$.\n\nNumerical details that must be followed:\n- Use a uniform radial grid spacing $h$ (in $\\text{fm}$). Start the grid at $r=h$ and end at $r=R_{\\text{box}}-h$ so that Dirichlet boundary conditions at $0$ and $R_{\\text{box}}$ are enforced implicitly.\n- Use the constant $\\frac{\\hbar^2}{2m} = 20.735\\ \\text{MeV fm}^2$ and compute all energies in $\\text{MeV}$.\n- Only positive eigenvalues are considered pseudostates; bound states with $E0$ must be excluded from clustering.\n- To reject high-energy box states, only include positive eigenvalues up to a cap $E_{\\max}$ (in $\\text{MeV}$) when forming clusters.\n\nTest suite and parameter coverage: Implement the program for the following three test cases that probe different physical and numerical regimes. For all cases use $h=0.05\\ \\text{fm}$, $a=0.65\\ \\text{fm}$, $r_0=1.25\\ \\text{fm}$, $A=40$, so that $R=r_0 A^{1/3}$, $V_0=50\\ \\text{MeV}$, and $E_{\\max}=15\\ \\text{MeV}$. Use a clustering tolerance $\\Delta E_{\\text{cluster}}=0.25\\ \\text{MeV}$.\n\n- Case $1$ (happy path, expected resonance stabilization): $\\ell=1$, $R_{\\text{box}} \\in \\{12\\ \\text{fm}, 14\\ \\text{fm}, 16\\ \\text{fm}, 18\\ \\text{fm}\\}$.\n- Case $2$ (contrast without centrifugal barrier): $\\ell=0$, $R_{\\text{box}} \\in \\{12\\ \\text{fm}, 14\\ \\text{fm}, 16\\ \\text{fm}, 18\\ \\text{fm}\\}$.\n- Case $3$ (boundary condition stress test with small boxes): $\\ell=1$, $R_{\\text{box}} \\in \\{8\\ \\text{fm}, 9\\ \\text{fm}, 10\\ \\text{fm}\\}$.\n\nRequired final output format: For each case, compute the integer count of detected resonance clusters that meet the criterion above. Your program should produce a single line of output containing the counts for the three cases as a comma-separated list enclosed in square brackets, for example $[n_1,n_2,n_3]$, where $n_1$, $n_2$, and $n_3$ are integers. No other text should be printed. Energies used internally must be handled in $\\text{MeV}$, radii in $\\text{fm}$, and the final outputs are unitless integers.", "solution": "The user has provided a problem statement that is scientifically sound, well-posed, and complete. All parameters, physical constants, equations, numerical methods, and conditions for identifying resonances are explicitly defined. The problem describes a standard technique in computational nuclear physics, the stabilization method, for identifying quantum resonances by observing the behavior of positive-energy eigenvalues of a system confined to an artificial box as a function of the box size. The task is to implement this method and apply it to three distinct test cases. The problem is valid and can be solved as stated.\n\nThe solution proceeds in two main stages: first, for each test case, the radial Schrödinger equation is solved numerically to find the energy eigenvalues for a set of box radii; second, these eigenvalues are analyzed using a specific clustering algorithm to identify and count resonances.\n\n**1. Numerical Solution of the Radial Schrödinger Equation**\n\nThe problem concerns a single nucleon with orbital angular momentum $\\ell$ in a potential. The state of the nucleon is described by the reduced radial wavefunction $u_{\\ell}(r)$, which satisfies the time-independent radial Schrödinger equation:\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2 u_{\\ell}(r)}{dr^2} + V_{\\text{eff}}(r) u_{\\ell}(r) = E u_{\\ell}(r)\n$$\nwhere $E$ is the energy eigenvalue and $V_{\\text{eff}}(r)$ is the effective potential, composed of the nuclear Woods-Saxon potential $V(r)$ and the centrifugal potential:\n$$\nV_{\\text{eff}}(r) = V(r) + \\frac{\\hbar^2 \\ell(\\ell+1)}{2 m r^2} = -\\frac{V_0}{1+\\exp\\!\\left(\\frac{r-R}{a}\\right)} + \\frac{\\hbar^2 \\ell(\\ell+1)}{2 m r^2}\n$$\nThe nucleon is confined within a spherical box of radius $R_{\\text{box}}$, meaning the wavefunction must vanish at the boundaries, $u_{\\ell}(0)=0$ and $u_{\\ell}(R_{\\text{box}})=0$.\n\nTo solve this equation numerically, we discretize the radial coordinate $r$ on a uniform grid. As specified, the grid points are $r_i = i \\cdot h$ for $i = 1, 2, \\dots, N-1$, where $h$ is the grid spacing and $R_{\\text{box}} = N \\cdot h$. The boundary conditions $u_{\\ell}(0)=0$ and $u_{\\ell}(R_{\\text{box}})=0$ are enforced by considering the wavefunction $u_i = u_{\\ell}(r_i)$ only at these interior points and setting $u_0 = u_N = 0$.\n\nThe second derivative operator $\\frac{d^2}{dr^2}$ is approximated at each grid point $r_i$ using a second-order central difference formula:\n$$\n\\frac{d^2 u_{\\ell}(r)}{dr^2}\\bigg|_{r=r_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\nSubstituting this into the Schrödinger equation and rearranging terms for each grid point $r_i$ gives:\n$$\n-\\frac{\\hbar^2}{2m h^2} u_{i-1} + \\left(\\frac{\\hbar^2}{m h^2} + V_{\\text{eff}}(r_i)\\right) u_i - \\frac{\\hbar^2}{2m h^2} u_{i+1} = E u_i\n$$\nThis transforms the differential equation into a matrix eigenvalue problem, $H\\mathbf{u} = E\\mathbf{u}$, where $\\mathbf{u}$ is the vector of wavefunction values $[u_1, u_2, \\dots, u_{N-1}]^T$, and $H$ is a real, symmetric, tridiagonal matrix. The elements of the Hamiltonian matrix $H$ are, letting $C = \\frac{\\hbar^2}{2m} = 20.735\\ \\text{MeV fm}^2$:\n- Diagonal elements: $H_{ii} = \\frac{2C}{h^2} + V_{\\text{eff}}(r_i) = \\frac{2C}{h^2} - \\frac{V_0}{1+\\exp\\!\\left(\\frac{r_i-R}{a}\\right)} + \\frac{C \\ell(\\ell+1)}{r_i^2}$\n- Off-diagonal elements: $H_{i, i+1} = H_{i, i-1} = -\\frac{C}{h^2}$\n\nThis tridiagonal matrix is constructed for each specified value of $R_{\\text{box}}$. We then compute its eigenvalues using a numerically stable and efficient algorithm, such as the one provided by `scipy.linalg.eigh_tridiagonal`. The resulting eigenvalues $\\{E_n\\}$ are the quantized energy levels for the nucleon in the given potential and box.\n\n**2. Resonance Identification via Clustering**\n\nAccording to the problem, a resonance is identified as a stable positive-energy state. This stability manifests as an energy eigenvalue that is largely insensitive to the variation of the box radius $R_{\\text{box}}$. The provided algorithm to formalize this is as follows:\nFirst, for each $R_{\\text{box}}$ in a given test case, we compute the eigenvalues and filter them, keeping only the positive energies below the energy cap $E_{\\max}$: $\\{E \\mid 0  E  E_{\\max}\\}$. This gives us a set of relevant eigenvalues for each box size.\n\nA resonance cluster must contain at least one eigenvalue from each of the different box configurations. To find these clusters, we adopt a robust, graph-based approach.\n\n- **Step 1: Generate Candidate Clusters**: We generate all possible combinations of eigenvalues where each combination consists of exactly one eigenvalue from each box. This is achieved using `itertools.product` on the lists of filtered eigenvalues.\n- **Step 2: Filter by Spread**: Each combination is a candidate for a resonance cluster. We filter these candidates by applying the spread criterion: a combination $(e_1, e_2, \\dots, e_k)$ is valid if its energy spread, $\\max(e_i) - \\min(e_i)$, does not exceed the tolerance $\\Delta E_{\\text{cluster}}$.\n- **Step 3: Group Valid Combinations**: A single physical resonance may correspond to multiple valid combinations, especially if some boxes produce multiple, very close eigenvalues in the resonance region. To avoid overcounting, we group all intersecting valid combinations. We can model this as a graph problem: each valid combination is a node in a graph, and an edge exists between two nodes (combinations) if they share at least one common eigenvalue. A physical resonance corresponds to a connected component in this graph.\n- **Step 4: Count Clusters**: The total number of resonances is the number of connected components in the graph. This can be found using a standard graph traversal algorithm like Breadth-First Search (BFS) or Depth-First Search (DFS). We iterate through all nodes; if a node has not yet been visited, we increment a counter and start a traversal to find and mark all nodes in its component as visited.\n\nThis procedure is applied to each of the three test cases, and the resulting count of resonances for each case is reported. All numerical parameters ($h, V_0, a, r_0, A, E_{\\max}, \\Delta E_{\\text{cluster}}$) are used as specified in the problem. The radius parameter of the Woods-Saxon potential is calculated as $R = r_0 A^{1/3}$ with $A=40$.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\nimport itertools\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the final result.\n    \"\"\"\n\n    def calculate_resonances(l_angular, R_box_list, V0, R_nuc, a_diff, h, C, E_max, delta_E_cluster):\n        \"\"\"\n        Calculates eigenvalues for each box and counts resonance clusters.\n        \n        Args:\n            l_angular (int): Orbital angular momentum.\n            R_box_list (list): List of box radii in fm.\n            V0 (float): Woods-Saxon potential depth in MeV.\n            R_nuc (float): Woods-Saxon potential radius in fm.\n            a_diff (float): Woods-Saxon potential diffuseness in fm.\n            h (float): Grid spacing in fm.\n            C (float): Constant hbar^2 / (2m) in MeV fm^2.\n            E_max (float): Maximum energy to consider for pseudostates in MeV.\n            delta_E_cluster (float): Energy spread tolerance for clustering in MeV.\n            \n        Returns:\n            int: The number of detected resonance clusters.\n        \"\"\"\n        energies_per_box = []\n\n        for R_box in R_box_list:\n            # 1. Setup grid and potential\n            r = np.arange(h, R_box, h)\n            if r.size == 0:\n                energies_per_box.append([])\n                continue\n            \n            V_ws = -V0 / (1 + np.exp((r - R_nuc) / a_diff))\n            V_cent = (C * l_angular * (l_angular + 1)) / (r**2)\n            V_eff = V_ws + V_cent\n\n            # 2. Construct and diagonalize the Hamiltonian matrix\n            diag = (2 * C / h**2) + V_eff\n            offdiag = np.full(len(diag) - 1, -C / h**2)\n            \n            eigenvalues = eigh_tridiagonal(diag, offdiag, eigvals_only=True)\n            \n            # 3. Filter for positive energy pseudostates below E_max\n            positive_energies = eigenvalues[(eigenvalues  0)  (eigenvalues  E_max)]\n            energies_per_box.append(list(positive_energies))\n\n        return count_clusters(energies_per_box, delta_E_cluster)\n\n    def count_clusters(energies_per_box, delta_E_cluster):\n        \"\"\"\n        Counts resonance clusters using a graph-based connected components algorithm.\n        \"\"\"\n        # A resonance requires at least one eigenvalue from each box.\n        if any(not e_list for e_list in energies_per_box):\n            return 0\n        \n        # Step 1: Generate all combinations with one eigenvalue from each box.\n        all_combinations = list(itertools.product(*energies_per_box))\n        \n        # Step 2: Filter combinations based on the energy spread criterion.\n        valid_combinations = [\n            combo for combo in all_combinations \n            if (max(combo) - min(combo)) = delta_E_cluster\n        ]\n        \n        if not valid_combinations:\n            return 0\n\n        # Step 3: Build a graph where nodes are valid combinations and edges\n        # connect combinations that share an eigenvalue.\n        num_combos = len(valid_combinations)\n        adj = [[] for _ in range(num_combos)]\n        combo_sets = [set(c) for c in valid_combinations]\n\n        for i in range(num_combos):\n            for j in range(i + 1, num_combos):\n                if not combo_sets[i].isdisjoint(combo_sets[j]):\n                    adj[i].append(j)\n                    adj[j].append(i)\n\n        # Step 4: Count connected components in the graph using BFS.\n        visited = [False] * num_combos\n        num_clusters = 0\n        for i in range(num_combos):\n            if not visited[i]:\n                num_clusters += 1\n                q = [i]\n                visited[i] = True\n                while q:\n                    u = q.pop(0)\n                    for v in adj[u]:\n                        if not visited[v]:\n                            visited[v] = True\n                            q.append(v)\n                            \n        return num_clusters\n\n    # General parameters for all test cases\n    h = 0.05  # fm\n    a = 0.65  # fm\n    r0 = 1.25 # fm\n    A = 40.0\n    R = r0 * (A**(1 / 3.0))\n    V0 = 50.0  # MeV\n    E_max = 15.0  # MeV\n    delta_E_cluster = 0.25  # MeV\n    hbar2_over_2m = 20.735  # MeV fm^2\n\n    # Define the test cases\n    test_cases = [\n        {'l': 1, 'R_box_values': [12.0, 14.0, 16.0, 18.0]},\n        {'l': 0, 'R_box_values': [12.0, 14.0, 16.0, 18.0]},\n        {'l': 1, 'R_box_values': [8.0, 9.0, 10.0]},\n    ]\n    \n    results = []\n    for case in test_cases:\n        resonance_count = calculate_resonances(\n            l_angular=case['l'],\n            R_box_list=case['R_box_values'],\n            V0=V0,\n            R_nuc=R,\n            a_diff=a,\n            h=h,\n            C=hbar2_over_2m,\n            E_max=E_max,\n            delta_E_cluster=delta_E_cluster\n        )\n        results.append(resonance_count)\n\n    # Print the final output in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3608560"}]}