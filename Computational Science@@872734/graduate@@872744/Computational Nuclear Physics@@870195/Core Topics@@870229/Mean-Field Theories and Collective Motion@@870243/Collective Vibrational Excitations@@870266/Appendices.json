{"hands_on_practices": [{"introduction": "This first practice establishes a cornerstone of linear response theory: the connection between a system's static response to an external field and its dynamic excitation spectrum, encapsulated by sum rules. By implementing a constrained Hartree-Fock calculation for a simple harmonic oscillator model, you will derive and compute the inverse-energy-weighted sum rule, $m_{-1}$, from the static polarizability. This exercise provides a hands-on understanding of how properties of giant resonances, like the centroid energy, can be inferred from ground-state calculations without needing to solve the full, complex Random Phase Approximation (RPA) problem. [@problem_id:3550607]", "problem": "Consider a one-dimensional independent-particle mean-field model of a nucleus in which each nucleon moves in a spherical harmonic oscillator potential. Let the single-particle Hamiltonian be $H = \\frac{p^{2}}{2m} + \\frac{1}{2} m \\omega^{2} x^{2}$ and the isoscalar monopole operator be $F = \\sum_{i=1}^{A} x_{i}^{2}$, where $m$ is the nucleon mass, $\\omega$ is the oscillator angular frequency, and $A$ is the number of particles. In the constrained Hartree-Fock / Hartree-Fock-Bogoliubov (HF/HFB) method, one introduces a static external field $- \\lambda F$ and computes the static response of the ground-state expectation value $\\langle F \\rangle$ to infer the inverse-energy-weighted sum rule $m_{-1}$. Using linear response theory and the definitions of energy-weighted sum rules, derive from first principles how the inverse-energy-weighted sum rule $m_{-1}$ is obtained from the static constrained response, and how the centroid energy of the giant monopole resonance is connected to the energy-weighted and inverse-energy-weighted sum rules without invoking any shortcut formulas.\n\nYou will implement the following computational tasks for the above model:\n- Use a central finite difference in the constraint strength $\\lambda$ to evaluate the static susceptibility $\\chi(0) = \\left.\\frac{\\partial \\langle F \\rangle}{\\partial \\lambda}\\right|_{\\lambda=0}$ and then obtain $m_{-1}$ by an appropriate proportionality factor derived from first principles.\n- Evaluate the energy-weighted sum rule $m_{1}$ via the double-commutator definition $m_{1} = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle$ for the many-body ground state in the harmonic oscillator mean field.\n- From the derived relation, compute a well-defined expression for the centroid energy of the collective monopole mode in terms of $m_{1}$ and $m_{-1}$.\n\nAssume a spin degeneracy $g$, and fill the lowest single-particle oscillator levels $n = 0, 1, 2, \\dots$ following the Pauli principle until $A$ particles are accommodated. For each level $n$, the single-particle expectation value in the unperturbed ground state is $\\langle n | x^{2} | n \\rangle = \\frac{\\hbar}{2 m \\omega} (2n + 1)$, and in the presence of the constraint $- \\lambda x^{2}$ it becomes $\\langle n | x^{2} | n \\rangle_{\\lambda} = \\frac{\\hbar}{2 m \\omega_{\\lambda}} (2n + 1)$ with $\\omega_{\\lambda} = \\sqrt{\\omega^{2} - \\frac{2 \\lambda}{m}}$. For the static susceptibility, use a small central-difference step $\\delta$ such that $\\omega_{\\lambda}^{2}  0$ for both $+\\delta$ and $-\\delta$.\n\nFundamental base you must use:\n- Canonical commutation relations $[x, p] = i \\hbar$.\n- Linear response theory connection between static susceptibility and inverse-energy-weighted sum rule.\n- Energy-weighted sum rule definition via the double commutator $m_{1} = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle$.\n- Nonrelativistic independent-particle filling of harmonic oscillator levels with spin degeneracy.\n\nPhysical and numerical units:\n- Use energies in mega-electron-volts (MeV), lengths in femtometers (fm), and $\\hbar = 197.3269804$ MeV·fm.\n- The mass $m$ is given in MeV (setting the speed of light $c = 1$), the oscillator parameter is specified by $\\hbar \\omega$ in MeV, and the program must internally convert to $\\omega$ via $\\omega = (\\hbar \\omega)/\\hbar$.\n- Express the centroid energy of the collective monopole mode in MeV, rounded to six decimal places.\n- Express $m_{-1}$ in $\\text{fm}^{4}/\\text{MeV}$, rounded to six decimal places.\n\nTest suite:\nFor each test case, the input parameters are $(m, \\hbar, \\hbar \\omega, A, g)$, where $m$ is the nucleon mass in MeV, $\\hbar$ is fixed to $197.3269804$ MeV·fm, $\\hbar \\omega$ is the oscillator energy quantum in MeV, $A$ is the particle number, and $g$ is the spin degeneracy. Use the following test cases:\n- Case $1$: $(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 10.000, A = 8, g = 2)$.\n- Case $2$: $(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 7.000, A = 3, g = 2)$.\n- Case $3$: $(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 13.000, A = 1, g = 2)$.\n- Case $4$: $(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 15.000, A = 20, g = 2)$.\n\nAlgorithmic specifications:\n- Compute the occupancy of each oscillator level $n$ up to the number of particles $A$ with degeneracy $g$. For a level $n$, the occupancy is an integer between $0$ and $g$.\n- Compute the sum factor $S = \\sum_{\\text{levels } n} \\text{occ}(n) (2n + 1)$ using the occupancy.\n- Use $S$ to compute $\\langle F \\rangle_{\\lambda} = \\frac{\\hbar}{2 m \\omega_{\\lambda}} S$ at $\\lambda = +\\delta$ and $\\lambda = -\\delta$, where $\\delta = 10^{-5} m \\omega^{2}$ ensures $\\omega_{\\lambda}^{2}  0$ for both signs.\n- Estimate $\\chi(0) = \\frac{\\langle F \\rangle_{+\\delta} - \\langle F \\rangle_{-\\delta}}{2 \\delta}$ and then $m_{-1}$ via its proportional relationship to $\\chi(0)$ derived from first principles.\n- Compute $m_{1}$ via the double-commutator expression in terms of ground-state expectations.\n- Compute the centroid energy using the relationship you derived between $m_{1}$ and $m_{-1}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, for each test case in order, two floats: first $m_{-1}$ in $\\text{fm}^{4}/\\text{MeV}$ rounded to six decimal places, then the centroid energy in MeV rounded to six decimal places. For example, the output should look like $[m_{-1}^{(1)},E_{\\text{centroid}}^{(1)},m_{-1}^{(2)},E_{\\text{centroid}}^{(2)},\\dots]$ where the superscript denotes the test case index.", "solution": "The problem requires the derivation of relationships between sum rules and static response for a one-dimensional harmonic oscillator model, followed by a computational implementation. The solution is presented in two parts: first, the theoretical derivations from first principles, and second, the design of the algorithm based on these principles.\n\n### Part 1: First-Principles Derivations\n\nThe solution hinges on three key relationships that must be derived: the connection between the static susceptibility $\\chi(0)$ and the inverse-energy-weighted sum rule $m_{-1}$; the evaluation of the energy-weighted sum rule $m_1$ using the double-commutator formalism; and the relationship between the centroid energy $E_{\\text{centroid}}$, $m_1$, and $m_{-1}$.\n\n**1. Static Susceptibility and Inverse-Energy-Weighted Sum Rule ($m_{-1}$)**\n\nLinear response theory provides the framework to connect the response of a system to a perturbation with its intrinsic excitation spectrum. The energy-weighted sum rules are moments of this spectrum. The $k$-th moment, $m_k$, for an operator $F$ is defined as:\n$$ m_k = \\sum_{j \\neq 0} (E_j - E_0)^k |\\langle j | F | 0 \\rangle|^2 $$\nwhere $|0\\rangle$ is the ground state with energy $E_0$, and $|j\\rangle$ are the excited states with energies $E_j$. We are interested in the inverse-energy-weighted sum rule, $m_{-1}$:\n$$ m_{-1} = \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_j - E_0} $$\nThe response of the system to a static perturbation of the form $H' = H - \\lambda F$ is characterized by the static susceptibility, $\\chi(0)$, defined as the first derivative of the expectation value of $F$ with respect to the constraint parameter $\\lambda$, evaluated at $\\lambda=0$:\n$$ \\chi(0) = \\left.\\frac{\\partial \\langle F \\rangle_\\lambda}{\\partial \\lambda}\\right|_{\\lambda=0} $$\nFrom time-independent perturbation theory, the first-order change in the ground-state wavefunction $|0\\rangle$ due to the perturbation $-\\lambda F$ is given by:\n$$ |0\\rangle_\\lambda \\approx |0\\rangle + \\lambda \\sum_{j \\neq 0} \\frac{\\langle j | F | 0 \\rangle}{E_0 - E_j} |j\\rangle $$\nThe expectation value of $F$ in the perturbed ground state, up to first order in $\\lambda$, is:\n$$ \\langle F \\rangle_\\lambda = \\langle 0 |_\\lambda F | 0 \\rangle_\\lambda \\approx \\langle 0 | F | 0 \\rangle + 2\\lambda \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_0 - E_j} = \\langle F \\rangle_0 - 2\\lambda \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_j - E_0} $$\nTaking the derivative with respect to $\\lambda$ and evaluating at $\\lambda=0$:\n$$ \\chi(0) = \\left.\\frac{\\partial \\langle F \\rangle_\\lambda}{\\partial \\lambda}\\right|_{\\lambda=0} = -2 \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{-(E_j - E_0)} = 2 \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_j - E_0} $$\nComparing this with the definition of $m_{-1}$, we arrive at the fundamental relationship:\n$$ \\chi(0) = 2 m_{-1} \\implies m_{-1} = \\frac{1}{2} \\chi(0) = \\frac{1}{2} \\left.\\frac{\\partial \\langle F \\rangle}{\\partial \\lambda}\\right|_{\\lambda=0} $$\nThis provides the \"proportionality factor\" of $1/2$ to obtain $m_{-1}$ from the computed static susceptibility.\n\n**2. Energy-Weighted Sum Rule ($m_1$) via Double Commutator**\n\nThe problem requires the evaluation of $m_1 = \\sum_{j \\neq 0} (E_j - E_0) |\\langle j | F | 0 \\rangle|^2$ using the double-commutator identity $m_1 = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle$. The many-body Hamiltonian is $H = \\sum_{i=1}^A H_i$ and the operator is $F = \\sum_{i=1}^A x_i^2$, where $H_i = p_i^2/(2m) + \\frac{1}{2}m\\omega^2 x_i^2$. Since operators for different particles commute, the commutator reduces to a sum over single-particle commutators: $[H, F] = \\sum_i [H_i, x_i^2]$.\n\nFirst commutator, $[H_i, x_i^2]$:\n$$ [H_i, x_i^2] = \\left[\\frac{p_i^2}{2m} + \\frac{1}{2}m\\omega^2 x_i^2, x_i^2\\right] = \\frac{1}{2m} [p_i^2, x_i^2] $$\nUsing $[A,B^2] = [A,B]B+B[A,B]$ and the canonical commutation relation $[x_i, p_i] = i\\hbar$:\n$$ [p_i, x_i^2] = [p_i, x_i]x_i + x_i[p_i, x_i] = (-i\\hbar)x_i + x_i(-i\\hbar) = -2i\\hbar x_i $$\n$$ [p_i^2, x_i^2] = [p_i, x_i^2]p_i + p_i[p_i, x_i^2] = (-2i\\hbar x_i)p_i + p_i(-2i\\hbar x_i) = -2i\\hbar(x_i p_i + p_i x_i) $$\nThus, $[H,F] = \\sum_i \\frac{1}{2m} (-2i\\hbar(x_i p_i + p_i x_i)) = -\\frac{i\\hbar}{m} \\sum_i (x_i p_i + p_i x_i)$.\n\nSecond commutator, $[F, [H, F]]$:\n$$ [F, [H, F]] = \\left[\\sum_j x_j^2, -\\frac{i\\hbar}{m} \\sum_i (x_i p_i + p_i x_i)\\right] = -\\frac{i\\hbar}{m}\\sum_i [x_i^2, x_i p_i + p_i x_i] $$\nWe evaluate $[x_i^2, x_i p_i + p_i x_i] = x_i[x_i, x_i p_i + p_i x_i] + [x_i, x_i p_i + p_i x_i]x_i$. A more direct approach uses $[AB, C] = A[B,C] + [A,C]B$:\n$$ [x_i^2, p_i] = x_i[x_i, p_i] + [x_i, p_i]x_i = x_i(i\\hbar) + (i\\hbar)x_i = 2i\\hbar x_i $$\n$$ [x_i^2, x_i p_i + p_i x_i] = [x_i^2, x_i p_i] + [x_i^2, p_i x_i] = x_i[x_i^2, p_i] + [x_i^2, p_i]x_i = x_i(2i\\hbar x_i) + (2i\\hbar x_i)x_i = 4i\\hbar x_i^2 $$\nSubstituting this back into the double commutator:\n$$ [F, [H, F]] = -\\frac{i\\hbar}{m} \\sum_i (4i\\hbar x_i^2) = \\frac{4\\hbar^2}{m} \\sum_i x_i^2 = \\frac{4\\hbar^2}{m} F $$\nFinally, we obtain the expression for $m_1$:\n$$ m_1 = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle = \\frac{1}{2} \\left\\langle 0 \\left| \\frac{4\\hbar^2}{m} F \\right| 0 \\right\\rangle = \\frac{2\\hbar^2}{m} \\langle 0 | F | 0 \\rangle $$\nwhere $\\langle 0 | F | 0 \\rangle$ is the ground-state expectation value of the operator $F$.\n\n**3. Centroid Energy**\n\nThe centroid energy of a collective excitation is a model-dependent concept. For a strength distribution that is sharply peaked or dominated by a single collective state, a robust definition is $E_{\\text{centroid}} = \\sqrt{m_1/m_{-1}}$. In the harmonic oscillator model, the operator $F=\\sum x_i^2$ can only excite states at an energy $2\\hbar\\omega$ above the ground state. This is because $x^2$ contains ladder operators that change the principal quantum number $n$ by $\\pm 2$. Thus, the \"single state dominance\" approximation is exact here.\n$$ \\frac{m_1}{m_{-1}} = \\frac{\\sum_{j \\neq 0} E_{j0} |\\langle j | F | 0 \\rangle|^2}{\\sum_{j \\neq 0} E_{j0}^{-1} |\\langle j | F | 0 \\rangle|^2} $$\nSince all $E_{j0} = 2\\hbar\\omega$ for any state $|j\\rangle$ with non-zero transition strength:\n$$ \\frac{m_1}{m_{-1}} = \\frac{2\\hbar\\omega \\sum_{j \\neq 0} |\\langle j | F | 0 \\rangle|^2}{(2\\hbar\\omega)^{-1} \\sum_{j \\neq 0} |\\langle j | F | 0 \\rangle|^2} = (2\\hbar\\omega)^2 $$\nTherefore, the centroid energy is given by:\n$$ E_{\\text{centroid}} = \\sqrt{\\frac{m_1}{m_{-1}}} = 2\\hbar\\omega $$\nThis derivation confirms that the expression $E_{\\text{centroid}} = \\sqrt{m_1/m_{-1}}$ is the correct one for this problem, as it correctly yields the exact excitation energy of the collective monopole mode.\n\n### Part 2: Algorithmic Design and Implementation\n\nThe computational task is to implement the derived relations for the given test cases. The numerical quantities $m$ (mass) and $\\hbar$ (Planck's constant) are provided as $mc^2$ and $\\hbar c$ respectively, a common convention in nuclear physics. The formulas must be adapted accordingly.\n- $\\langle n|x^2|n\\rangle = \\frac{\\hbar}{2m\\omega}(2n+1) = \\frac{(\\hbar c)^2}{2(mc^2)(\\hbar\\omega)}(2n+1)$.\n- $m_1 = \\frac{2\\hbar^2}{m}\\langle F\\rangle_0 = \\frac{2(\\hbar c)^2}{mc^2}\\langle F\\rangle_0$.\n- The constrained frequency $\\omega_\\lambda = \\sqrt{\\omega^2 - 2\\lambda/m}$ implies $(\\hbar\\omega_\\lambda)^2 = (\\hbar\\omega)^2 - 2\\lambda\\hbar^2/m = (\\hbar\\omega)^2 - 2\\lambda(\\hbar c)^2/(mc^2)$.\n\nThe algorithm proceeds as follows:\n1.  **Parse Inputs:** For each test case, take the parameters $(mc^2, \\hbar c, \\hbar \\omega, A, g)$.\n2.  **Determine Occupancies:** Calculate the occupation number $\\text{occ}(n)$ for each harmonic oscillator level $n=0, 1, 2, \\ldots$ by filling levels sequentially according to the Pauli principle until all $A$ particles are placed, respecting the degeneracy $g$.\n3.  **Compute Sum Factor $S$:** Calculate the structure-dependent factor $S = \\sum_n \\text{occ}(n)(2n+1)$. This factor appears in all expectation values of $F$.\n4.  **Calculate $m_{-1}$:**\n    a.  Compute the finite difference step $\\delta=10^{-5}m\\omega^2 = 10^{-5}(mc^2)(\\hbar\\omega/\\hbar c)^2$.\n    b.  Calculate the perturbed oscillator energies $\\hbar\\omega_{+\\delta}$ and $\\hbar\\omega_{-\\delta}$ using the formula above.\n    c.  Calculate the constrained expectation values $\\langle F \\rangle_{+\\delta}$ and $\\langle F \\rangle_{-\\delta}$ using $\\langle F \\rangle_\\lambda = \\frac{(\\hbar c)^2 S}{2(mc^2)(\\hbar\\omega_\\lambda)}$.\n    d.  Estimate the static susceptibility using the central difference formula: $\\chi(0) \\approx \\frac{\\langle F \\rangle_{+\\delta} - \\langle F \\rangle_{-\\delta}}{2\\delta}$.\n    e.  Obtain $m_{-1}$ using the derived relation: $m_{-1} = \\frac{1}{2}\\chi(0)$.\n5.  **Calculate $m_1$:**\n    a.  First, calculate the unperturbed ground-state expectation value $\\langle F \\rangle_0 = \\frac{(\\hbar c)^2 S}{2(mc^2)(\\hbar\\omega)}$.\n    b.  Then, use the derived double-commutator result: $m_1 = \\frac{2(\\hbar c)^2}{mc^2} \\langle F \\rangle_0$.\n6.  **Calculate Centroid Energy:** Compute the centroid energy using the derived formula $E_{\\text{centroid}} = \\sqrt{m_1/m_{-1}}$. The result should be very close to $2\\hbar\\omega$ due to the high accuracy of the finite difference method with a small $\\delta$.\n7.  **Format Output:** For each test case, collect the values of $m_{-1}$ and $E_{\\text{centroid}}$, round them to six decimal places, and format them into the required final string.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a given set of test cases.\n    \n    The function calculates the inverse-energy-weighted sum rule (m_{-1}) and\n    the centroid energy of the giant monopole resonance for a 1D harmonic oscillator\n    model of a nucleus.\n    \"\"\"\n\n    test_cases = [\n        # (m [MeV], hbarc [MeV*fm], hbar_omega [MeV], A, g)\n        (938.920, 197.3269804, 10.000, 8, 2),\n        (938.920, 197.3269804, 7.000, 3, 2),\n        (938.920, 197.3269804, 13.000, 1, 2),\n        (938.920, 197.3269804, 15.000, 20, 2),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m_en, h_c, e_osc, A, g = case\n        \n        # Step 1: Determine occupancies and compute the sum factor S.\n        # S = sum_{levels n} occ(n) * (2n + 1)\n        s_factor = 0\n        particles_placed = 0\n        n = 0\n        while particles_placed  A:\n            occupancy = min(g, A - particles_placed)\n            if occupancy > 0:\n                s_factor += occupancy * (2 * n + 1)\n                particles_placed += occupancy\n            n += 1\n            \n        # Step 2: Compute m_{-1} via static susceptibility using finite differences.\n        # The external field is -lambda * F, so the perturbed Hamiltonian has\n        # a modified frequency.\n        \n        # Central difference step for lambda. delta is chosen to be small and safe.\n        delta = 1e-5 * m_en * (e_osc / h_c)**2\n        \n        lambda_plus = delta\n        lambda_minus = -delta\n        \n        # Perturbed oscillator energy (squared): (hbar*omega_lambda)^2\n        # (h_w_l)^2 = (h_w)^2 - 2*lambda*(h_c)^2/m_en\n        common_term_lambda = 2 * h_c**2 / m_en\n        \n        e_osc_lambda_plus_sq = e_osc**2 - common_term_lambda * lambda_plus\n        e_osc_lambda_minus_sq = e_osc**2 - common_term_lambda * lambda_minus\n        \n        e_osc_lambda_plus = np.sqrt(e_osc_lambda_plus_sq)\n        e_osc_lambda_minus = np.sqrt(e_osc_lambda_minus_sq)\n        \n        # Expectation value F_lambda = (h_c^2 * S) / (2 * m_en * hbar*omega_lambda)\n        common_term_F = (h_c**2 * s_factor) / (2 * m_en)\n        \n        F_plus = common_term_F / e_osc_lambda_plus\n        F_minus = common_term_F / e_osc_lambda_minus\n        \n        # Static susceptibility chi(0) and m_{-1}\n        # chi(0) = dF/d(lambda) | at lambda=0\n        chi_0 = (F_plus - F_minus) / (2 * delta)\n        # From first principles, m_{-1} = 0.5 * chi(0)\n        m_minus_1 = 0.5 * chi_0\n\n        # Step 3: Compute the energy-weighted sum rule m_1.\n        # From the double commutator, m_1 = (2*h_c^2/m_en) * F_0\n        F_0 = common_term_F / e_osc\n        m_1 = (2 * h_c**2 / m_en) * F_0\n        \n        # Step 4: Compute the centroid energy.\n        # For a single collective mode, E_centroid = sqrt(m_1 / m_{-1})\n        E_centroid = np.sqrt(m_1 / m_minus_1)\n        \n        results.append(f\"{m_minus_1:.6f}\")\n        results.append(f\"{E_centroid:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3550607"}, {"introduction": "While sum rules provide exact, model-independent relations, many-body methods like the Random Phase Approximation (RPA) involve approximations that may or may not preserve them. This exercise challenges you to build and solve the RPA equations for a schematic interacting system and compute sum rules by explicitly summing over the resulting discrete spectrum. You will then compare these results against the exact sum rules calculated via the double-commutator and constrained mean-field methods, providing direct insight into the validity and consistency of the quasi-boson approximation underlying RPA. [@problem_id:3550542]", "problem": "Consider a finite system of $A$ noninteracting identical fermions moving in a one-dimensional harmonic oscillator mean field with angular frequency $\\Omega$ and mass set to $m=1$ and reduced Planck constant set to $\\hbar=1$ (dimensionless units). The single-particle Hamiltonian is $h = p^2/2 + \\tfrac{1}{2}\\Omega^2 x^2$ with eigenenergies $\\varepsilon_n = \\Omega\\left(n + \\tfrac{1}{2}\\right)$ for $n \\in \\mathbb{N}_0$. Assume a spin degeneracy $g$ so that each orbital can host $g$ fermions, and fill $n_F$ orbitals, giving $A = g\\,n_F$ particles. Consider the isoscalar monopole-like one-body operator $F = \\sum_{i=1}^{A} x_i^2$. To model residual collectivity in the Random Phase Approximation (RPA), include a schematic separable two-body interaction $V = \\tfrac{\\kappa}{2} F^2$ with real coupling constant $\\kappa \\ge 0$.\n\nYour tasks are:\n1. Derive from first principles and then implement a computational method to compute the discrete RPA spectrum and strengths for $F$, using the quasi-boson approximation in the particle-hole basis built from $n \\to n+2$ excitations of the harmonic oscillator. In this basis, the particle-hole energy differences are $\\Delta E_n = \\varepsilon_{n+2} - \\varepsilon_n = 2\\Omega$, and the one-body matrix elements of $x^2$ are $\\langle n | x^2 | n+2 \\rangle = \\sqrt{(n+1)(n+2)}/(2\\Omega)$. Incorporate the spin degeneracy $g$ by scaling these matrix elements with a factor $\\sqrt{g}$.\n2. Form the RPA matrices $A$ and $B$ as\n$$ A_{mn} = \\Delta E_m\\,\\delta_{mn} + \\kappa\\,f_m f_n,\\quad B_{mn} = \\kappa\\,f_m f_n, $$\nwhere $f_n = \\sqrt{g}\\,\\langle n | x^2 | n+2 \\rangle$. Then build the $2N \\times 2N$ RPA matrix\n$$ \\mathcal{M} = \\begin{pmatrix} A  B \\\\ -B  -A \\end{pmatrix}, $$\ndiagonalize it, select the positive eigenfrequencies $\\omega_\\nu  0$, and obtain the corresponding normalized eigenvectors $(X^{(\\nu)}, Y^{(\\nu)})$ satisfying the quasi-boson norm $X^{(\\nu)T} X^{(\\nu)} - Y^{(\\nu)T} Y^{(\\nu)} = 1$.\n3. For each RPA mode, compute the transition amplitude of $F$ as $T_\\nu = \\sum_n f_n\\left(X^{(\\nu)}_n + Y^{(\\nu)}_n\\right)$, and the corresponding strength $S_\\nu = |T_\\nu|^2$. Then compute the discrete RPA sum rules\n$$ m_k^{\\text{RPA}} = \\sum_\\nu \\omega_\\nu^{\\,k} S_\\nu, $$\nfor $k \\in \\{-1,0,1\\}$.\n4. Independently evaluate the energy-weighted sum rule $m_1$ via the double-commutator technique starting from the fundamental commutator identity $[x,[p,x]] = i$ and canonical commutation relations. Show that for the harmonic oscillator mean field and the operator $F = \\sum_i x_i^2$, one obtains\n$$ [F,[H,F]] = 4 \\sum_{i=1}^{A} x_i^2, $$\nso that\n$$ m_1^{\\text{DC}} = \\frac{1}{2}\\langle 0 | [F,[H,F]] | 0 \\rangle = 2 \\langle 0 | F | 0 \\rangle. $$\nEvaluate $\\langle 0 | F | 0 \\rangle$ in terms of $\\Omega$, $g$, and $n_F$ and provide an explicit closed-form expression for $m_1^{\\text{DC}}$.\n5. Evaluate the inverse energy-weighted sum rule $m_{-1}$ using the constrained Hartree-Fock-Bogoliubov (HFB) (here, Hartree-Fock due to closed shells and no pairing) technique: introduce a constraint by adding $+\\lambda F$ to the mean-field Hamiltonian, derive the perturbed frequency $\\Omega'(\\lambda)$, compute $\\langle F \\rangle(\\lambda)$ in the constrained ground state, and use the dielectric theorem to obtain\n$$ m_{-1}^{\\text{CHF}} = -\\frac{1}{2}\\left.\\frac{d\\langle F \\rangle(\\lambda)}{d\\lambda}\\right|_{\\lambda=0}. $$\nExpress $m_{-1}^{\\text{CHF}}$ explicitly in terms of $\\Omega$, $g$, and $n_F$.\n\nYou must implement a single, complete, runnable program that:\n- Constructs and solves the RPA problem as specified.\n- Computes $m_{-1}^{\\text{RPA}}$, $m_{0}^{\\text{RPA}}$, and $m_{1}^{\\text{RPA}}$.\n- Computes the reference $m_{1}^{\\text{DC}}$ and $m_{-1}^{\\text{CHF}}$ analytically.\n- Reports the relative differences for each test case:\n  - $\\delta_1 = \\left|m_{1}^{\\text{RPA}} - m_{1}^{\\text{DC}}\\right| / m_{1}^{\\text{DC}}$,\n  - $\\delta_2 = \\left|m_{-1}^{\\text{RPA}} - m_{-1}^{\\text{CHF}}\\right| / m_{-1}^{\\text{CHF}}$.\n\nScientific and mathematical bases required:\n- Canonical commutation relations for quantum mechanics, linear response theory, and the quasi-boson approximation for RPA.\n- Harmonic oscillator expectation values and matrix elements for $x^2$.\n- The dielectric theorem for constrained Hartree-Fock-Bogoliubov (HFB), which links static polarizability to $m_{-1}$.\n\nUnits: All quantities are in dimensionless units consistent with $\\hbar = 1$, $m = 1$, and energies in units of $\\Omega$. No physical unit conversion is required.\n\nAngle units: Not applicable.\n\nPercentages: Not applicable.\n\nTest suite:\nUse the following parameter sets $(n_F, g, \\Omega, \\kappa)$ to test different regimes and edge cases:\n- Case 1 (happy path, moderate collectivity): $(2, 2, 1.25, 0.5)$.\n- Case 2 (increased filling, moderate coupling): $(3, 2, 1.0, 0.4)$.\n- Case 3 (larger $n_F$, weaker coupling): $(5, 1, 2.2, 0.3)$.\n- Case 4 (boundary near Tamm-Dancoff limit): $(3, 1, 1.8, 1\\times 10^{-6})$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\"), where the results are the sequence of floats $\\delta_1, \\delta_2$ for each case, in the order of the test cases above, totaling eight floats.", "solution": "The user has provided a detailed problem in computational nuclear physics, requiring the calculation and comparison of spectral sum rules within the Random Phase Approximation (RPA) and other theoretical frameworks.\n\n### Step 1: Problem Validation\n\nI will first extract the givens and validate the problem statement according to the specified criteria.\n\n**Extracted Givens:**\n\n1.  **System**: A system of $A$ identical non-interacting fermions in a 1D harmonic oscillator (HO) mean field.\n2.  **Constants**: Mass $m=1$, reduced Planck constant $\\hbar=1$.\n3.  **Mean Field**: Single-particle Hamiltonian $h = p^2/2 + \\tfrac{1}{2}\\Omega^2 x^2$ with eigenenergies $\\varepsilon_n = \\Omega(n + \\tfrac{1}{2})$ for $n \\in \\mathbb{N}_0$.\n4.  **Configuration**: Spin degeneracy $g$. Number of filled orbitals is $n_F$, so the total number of particles is $A = g\\,n_F$.\n5.  **Operator**: Isoscalar monopole-like operator $F = \\sum_{i=1}^{A} x_i^2$.\n6.  **Residual Interaction**: $V = \\tfrac{\\kappa}{2} F^2$ with real coupling constant $\\kappa \\ge 0$.\n7.  **RPA Basis**: Particle-hole (p-h) excitations of the form $n \\to n+2$, where $n \\in \\{0, 1, \\dots, n_F-1\\}$.\n8.  **Matrix Elements and Energies**:\n    -   Particle-hole energy difference: $\\Delta E_n = \\varepsilon_{n+2} - \\varepsilon_n = 2\\Omega$.\n    -   Single-particle matrix element of $x^2$: $\\langle n | x^2 | n+2 \\rangle = \\sqrt{(n+1)(n+2)}/(2\\Omega)$.\n    -   RPA matrix element definition: $f_n = \\sqrt{g}\\,\\langle n | x^2 | n+2 \\rangle$.\n9.  **RPA Matrices ($A, B$) and Supermatrix ($\\mathcal{M}$)**:\n    -   $A_{mn} = \\Delta E_m\\,\\delta_{mn} + \\kappa\\,f_m f_n = 2\\Omega\\,\\delta_{mn} + \\kappa\\,f_m f_n$.\n    -   $B_{mn} = \\kappa\\,f_m f_n$.\n    -   $\\mathcal{M} = \\begin{pmatrix} A  B \\\\ -B  -A \\end{pmatrix}$.\n10. **RPA Solution and Properties**:\n    -   Diagonalize $\\mathcal{M}$ to find positive eigenfrequencies $\\omega_\\nu  0$.\n    -   Normalized eigenvectors $(X^{(\\nu)}, Y^{(\\nu)})$ with quasi-boson norm $X^{(\\nu)T} X^{(\\nu)} - Y^{(\\nu)T} Y^{(\\nu)} = 1$.\n    -   Transition amplitude: $T_\\nu = \\sum_n f_n\\left(X^{(\\nu)}_n + Y^{(\\nu)}_n\\right)$.\n    -   Strength: $S_\\nu = |T_\\nu|^2$.\n    -   RPA sum rules: $m_k^{\\text{RPA}} = \\sum_\\nu \\omega_\\nu^{\\,k} S_\\nu$ for $k \\in \\{-1, 0, 1\\}$.\n11. **Double-Commutator (DC) Sum Rule ($m_1^{\\text{DC}}$)**:\n    -   Identity to use: $[F,[H,F]] = 4 \\sum_{i=1}^{A} x_i^2 = 4F$.\n    -   Formula: $m_1^{\\text{DC}} = \\frac{1}{2}\\langle 0 | [F,[H,F]] | 0 \\rangle = 2 \\langle 0 | F | 0 \\rangle$.\n12. **Constrained Hartree-Fock (CHF) Sum Rule ($m_{-1}^{\\text{CHF}}$)**:\n    -   Constrained Hamiltonian: $H' = H_0 + \\lambda F$.\n    -   Formula (dielectric theorem): $m_{-1}^{\\text{CHF}} = -\\frac{1}{2}\\left.\\frac{d\\langle F \\rangle(\\lambda)}{d\\lambda}\\right|_{\\lambda=0}$.\n13. **Test Cases**: $(n_F, g, \\Omega, \\kappa)$ for four scenarios:\n    -   Case 1: $(2, 2, 1.25, 0.5)$\n    -   Case 2: $(3, 2, 1.0, 0.4)$\n    -   Case 3: $(5, 1, 2.2, 0.3)$\n    -   Case 4: $(3, 1, 1.8, 1\\times 10^{-6})$\n14. **Final Output**: Relative differences $\\delta_1 = |m_1^{\\text{RPA}} - m_1^{\\text{DC}}| / m_1^{\\text{DC}}$ and $\\delta_2 = |m_{-1}^{\\text{RPA}} - m_{-1}^{\\text{CHF}}| / m_{-1}^{\\text{CHF}}$ for each case.\n\n**Validation Using Extracted Givens:**\n\n1.  **Scientific or Factual Unsoundness**: The problem is well-grounded in the principles of quantum mechanics and nuclear many-body theory. The RPA, commutator methods, and constrained mean-field theory are standard techniques. The harmonic oscillator is a cornerstone model, and the separable interaction is a widely used schematic model. No violations are found.\n2.  **Non-Formalizable or Irrelevant**: The problem is a formal, quantitative task directly related to collective vibrational excitations in nuclear physics. It is not metaphorical or irrelevant. No violations are found.\n3.  **Incomplete or Contradictory Setup**: The problem provides all necessary definitions, constants, and formulae to construct and solve the RPA equations, as well as to derive the analytical sum rules for comparison. The truncation of the particle-hole space to only $n \\to n+2$ excitations is an explicit model definition, not an omission. No contradictions are found.\n4.  **Unrealistic or Infeasible**: The use of dimensionless units and the specified parameters are physically and computationally reasonable. No violations are found.\n5.  **Ill-Posed or Poorly Structured**: The RPA equations for a separable interaction are well-posed and lead to a unique set of collective modes. The problem is structured to guide the user through a logical sequence of derivations and computations. No violations are found.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem is conceptually deep, requiring an understanding of why the results from different valid theoretical approaches (RPA, DC, CHF) might differ. These differences arise from the approximations inherent in the RPA (e.g., quasi-boson commutation relations, truncated model space), making the comparison non-trivial. No violations are found.\n7.  **Outside Scientific Verifiability**: All calculations and derivations are based on verifiable mathematical and physical principles. No violations are found.\n\n**Verdict and Action:**\nThe problem is **valid**. It is a well-defined and challenging exercise in theoretical and computational physics. I will proceed with deriving the solution and implementing the program.\n\n### Step 2: Principle-Based Solution and Algorithmic Design\n\nThe solution requires a combination of analytical derivations and numerical computation. I will first establish the analytical forms for the reference sum rules and then outline the numerical procedure for the RPA calculation.\n\n**Analytical Derivations**\n\n**A. Energy-Weighted Sum Rule ($m_1^{\\text{DC}}$)**\nThe problem provides the sum rule formula $m_1^{\\text{DC}} = 2 \\langle 0 | F | 0 \\rangle$. The task is to evaluate the ground-state expectation value of $F = \\sum_i x_i^2$. The ground state $|0\\rangle$ is a Slater determinant of the lowest $n_F$ harmonic oscillator orbitals, each occupied by $g$ fermions.\n\nThe expectation value of $F$ is the sum of single-particle expectation values over all occupied states:\n$$ \\langle 0 | F | 0 \\rangle = \\sum_{\\text{occupied } k} \\langle k | x^2 | k \\rangle $$\nWith a spin degeneracy of $g$, this becomes:\n$$ \\langle 0 | F | 0 \\rangle = g \\sum_{n=0}^{n_F-1} \\langle n | x^2 | n \\rangle $$\nFor a 1D harmonic oscillator state $|n\\rangle$, the expectation value is $\\langle n | x^2 | n \\rangle = \\frac{1}{\\Omega}\\left(n + \\frac{1}{2}\\right)$.\nSubstituting this and evaluating the sum:\n$$ \\langle 0 | F | 0 \\rangle = \\frac{g}{\\Omega} \\sum_{n=0}^{n_F-1} \\left(n + \\frac{1}{2}\\right) = \\frac{g}{\\Omega} \\left( \\frac{(n_F-1)n_F}{2} + \\frac{n_F}{2} \\right) = \\frac{g}{\\Omega} \\frac{n_F^2}{2} = \\frac{g n_F^2}{2\\Omega} $$\nTherefore, the double-commutator sum rule is:\n$$ m_1^{\\text{DC}} = 2 \\langle 0 | F | 0 \\rangle = \\frac{g n_F^2}{\\Omega} $$\n\n**B. Inverse Energy-Weighted Sum Rule ($m_{-1}^{\\text{CHF}}$)**\nThis sum rule is evaluated using the static polarizability of the mean-field ground state. The mean-field Hamiltonian is perturbed by a constraining field $+\\lambda F$. The single-particle Hamiltonian becomes:\n$$ h' = h + \\lambda x^2 = \\frac{p^2}{2} + \\frac{1}{2}\\Omega^2 x^2 + \\lambda x^2 = \\frac{p^2}{2} + \\frac{1}{2}(\\Omega^2 + 2\\lambda)x^2 $$\nThis is the Hamiltonian of a harmonic oscillator with a modified frequency $\\Omega'(\\lambda) = \\sqrt{\\Omega^2 + 2\\lambda}$.\n\nThe expectation value $\\langle F \\rangle(\\lambda)$ is computed in the ground state of this constrained system. This state is formed by filling the lowest $n_F$ orbitals of the new oscillator. The calculation is analogous to the one for $\\langle 0|F|0\\rangle$, but with $\\Omega$ replaced by $\\Omega'(\\lambda)$:\n$$ \\langle F \\rangle(\\lambda) = \\frac{g n_F^2}{2\\Omega'(\\lambda)} = \\frac{g n_F^2}{2\\sqrt{\\Omega^2 + 2\\lambda}} $$\nAccording to the dielectric theorem as formulated in the problem, we need the derivative with respect to $\\lambda$:\n$$ \\frac{d\\langle F \\rangle(\\lambda)}{d\\lambda} = \\frac{g n_F^2}{2} \\frac{d}{d\\lambda}(\\Omega^2 + 2\\lambda)^{-1/2} = \\frac{g n_F^2}{2} \\left[ -\\frac{1}{2}(\\Omega^2 + 2\\lambda)^{-3/2} \\cdot 2 \\right] = -\\frac{g n_F^2}{2}(\\Omega^2 + 2\\lambda)^{-3/2} $$\nEvaluating at $\\lambda = 0$:\n$$ \\left.\\frac{d\\langle F \\rangle(\\lambda)}{d\\lambda}\\right|_{\\lambda=0} = -\\frac{g n_F^2}{2\\Omega^3} $$\nThe constrained sum rule is then:\n$$ m_{-1}^{\\text{CHF}} = -\\frac{1}{2}\\left.\\frac{d\\langle F \\rangle(\\lambda)}{d\\lambda}\\right|_{\\lambda=0} = -\\frac{1}{2} \\left( -\\frac{g n_F^2}{2\\Omega^3} \\right) = \\frac{g n_F^2}{4\\Omega^3} $$\n\n**Numerical RPA Calculation**\n\nThe core of the numerical task is to solve the RPA matrix equation $\\mathcal{M}Z = \\omega Z$.\n\n1.  **Setup**: For a given parameter set $(n_F, g, \\Omega, \\kappa)$, the dimension of the p-h space is $N = n_F$.\n2.  **Matrix Construction**:\n    -   First, compute the vector $f$ of size $N$ with elements $f_n = \\sqrt{g} \\frac{\\sqrt{(n+1)(n+2)}}{2\\Omega}$ for $n=0, \\dots, N-1$.\n    -   The matrices $A$ and $B$ are $N \\times N$. Using the separable nature of the interaction:\n        -   $B = \\kappa \\, f f^T$ (outer product).\n        -   $A = (2\\Omega) I_N + B$, where $I_N$ is the identity matrix.\n    -   Construct the $2N \\times 2N$ RPA matrix $\\mathcal{M} = \\begin{pmatrix} A  B \\\\ -B  -A \\end{pmatrix}$.\n3.  **Diagonalization**:\n    -   Solve the eigenvalue problem for $\\mathcal{M}$. Since $\\mathcal{M}$ is a real, non-symmetric \"Hamiltonian matrix\", its eigenvalues will appear in $\\pm \\omega$ pairs. We use a standard numerical library function (e.g., `scipy.linalg.eig`).\n4.  **Extract Physical Solutions**:\n    -   Iterate through the computed eigenvalues and eigenvectors.\n    -   Select only the solutions with a positive real eigenvalue, $\\omega_\\nu  0$.\n    -   For each such solution, extract the corresponding eigenvector $Z^{(\\nu)} = (X^{(\\nu)}_u, Y^{(\\nu)}_u)^T$. The vectors from a standard eigensolver are typically L2-normalized, i.e., $(X^{(\\nu)}_u)^\\dagger X^{(\\nu)}_u + (Y^{(\\nu)}_u)^\\dagger Y^{(\\nu)}_u = 1$.\n5.  **Normalization and Strength Calculation**:\n    -   For each physical eigenvector, compute the square of the quasi-boson norm: $N_q^2 = (X^{(\\nu)}_u)^T X^{(\\nu)}_u - (Y^{(\\nu)}_u)^T Y^{(\\nu)}_u$. For physical states, this must be positive.\n    -   The correctly normalized RPA amplitudes are $X^{(\\nu)} = X^{(\\nu)}_u / \\sqrt{N_q^2}$ and $Y^{(\\nu)} = Y^{(\\nu)}_u / \\sqrt{N_q^2}$.\n    -   Compute the transition amplitude $T_\\nu = \\sum_{n=0}^{N-1} f_n(X^{(\\nu)}_n + Y^{(\\nu)}_n) = f^T(X^{(\\nu)} + Y^{(\\nu)})$.\n    -   Compute the transition strength $S_\\nu = |T_\\nu|^2$.\n6.  **RPA Sum Rule Calculation**:\n    -   Sum the contributions from all physical modes $\\nu$ to obtain the RPA sum rules:\n        -   $m_1^{\\text{RPA}} = \\sum_\\nu \\omega_\\nu S_\\nu$\n        -   $m_{-1}^{\\text{RPA}} = \\sum_\\nu \\omega_\\nu^{-1} S_\\nu$\n7.  **Comparison**:\n    -   Finally, compute the relative differences $\\delta_1$ and $\\delta_2$ using the analytically derived $m_1^{\\text{DC}}$ and $m_{-1}^{\\text{CHF}}$ as references. These differences quantify the effects of the approximations made in this specific RPA model (i.e., treating p-h pairs as bosons and truncating the p-h space).\n\nThis detailed procedure forms the basis for the Python implementation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n_F, g, Omega, kappa)\n        (2, 2, 1.25, 0.5),      # Case 1\n        (3, 2, 1.0, 0.4),       # Case 2\n        (5, 1, 2.2, 0.3),       # Case 3\n        (3, 1, 1.8, 1e-6),      # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        delta1, delta2 = solve_case(*case)\n        results.extend([delta1, delta2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\ndef solve_case(nF, g, Omega, kappa):\n    \"\"\"\n    Solves the RPA problem for one set of parameters (nF, g, Omega, kappa).\n\n    Returns:\n        tuple[float, float]: The relative differences (delta1, delta2).\n    \"\"\"\n    # Dimension of the particle-hole space\n    N = nF\n\n    # Task 1  2: Construct and solve the RPA problem\n    # Vector of transition matrix elements f_n\n    n_values = np.arange(N)\n    f_vec = np.sqrt(g) * np.sqrt((n_values + 1) * (n_values + 2)) / (2 * Omega)\n\n    # Construct RPA matrices A and B\n    # The interaction is separable, so B is a rank-1 matrix.\n    B = kappa * np.outer(f_vec, f_vec)\n    \n    # The particle-hole energies are constant Delta_E = 2*Omega for all n\n    delta_E = 2 * Omega\n    A = delta_E * np.eye(N) + B\n\n    # Build the 2N x 2N RPA matrix M\n    M = np.block([\n        [A, B],\n        [-B, -A]\n    ])\n\n    # Diagonalize M to find eigenvalues (omega) and eigenvectors (X, Y)\n    eigenvalues, eigenvectors = eig(M)\n\n    # Task 3: Compute RPA sum rules\n    m_minus_1_rpa = 0.0\n    m_0_rpa = 0.0\n    m_1_rpa = 0.0\n\n    for i in range(2 * N):\n        omega_nu = eigenvalues[i]\n\n        # Select physical solutions, which have positive real eigenfrequencies\n        # A small tolerance is used to handle floating point inaccuracies\n        if np.isreal(omega_nu) and np.real(omega_nu) > 1e-9:\n            omega_nu = np.real(omega_nu)\n            \n            # Since M is real, eigenvectors can be chosen to be real\n            eigenvector = np.real(eigenvectors[:, i])\n\n            # Extract forward (X) and backward (Y) amplitudes\n            X_u = eigenvector[:N]\n            Y_u = eigenvector[N:]\n\n            # The eigenvectors from scipy.linalg.eig are L2-normalized: X_u.T @ X_u + Y_u.T @ Y_u = 1.\n            # We must re-normalize them to the quasi-boson norm: X.T @ X - Y.T @ Y = 1.\n            norm_q_sq = X_u.T @ X_u - Y_u.T @ Y_u\n\n            # Physical solutions must have a positive norm\n            if norm_q_sq > 0:\n                norm_q = np.sqrt(norm_q_sq)\n                X_norm = X_u / norm_q\n                Y_norm = Y_u / norm_q\n\n                # Compute transition amplitude T_nu and strength S_nu\n                T_nu = np.sum(f_vec * (X_norm + Y_norm))\n                S_nu = T_nu**2\n\n                # Accumulate the RPA sum rules\n                m_1_rpa += omega_nu * S_nu\n                m_0_rpa += S_nu\n                m_minus_1_rpa += S_nu / omega_nu\n\n    # Task 4: Compute the analytical energy-weighted sum rule (m1) from DC\n    m1_dc = g * (nF**2) / Omega\n\n    # Task 5: Compute the analytical inverse energy-weighted sum rule (m-1) from CHF\n    m_minus_1_chf = g * (nF**2) / (4 * Omega**3)\n\n    # Final step: Report the relative differences\n    # Handle the potential for division by zero if a reference sum rule is zero\n    delta1 = abs(m_1_rpa - m1_dc) / m1_dc if abs(m1_dc) > 1e-12 else 0.0\n    delta2 = abs(m_minus_1_rpa - m_minus_1_chf) / m_minus_1_chf if abs(m_minus_1_chf) > 1e-12 else 0.0\n    \n    return delta1, delta2\n\n# Execute the main function to produce the final output.\nsolve()\n```", "id": "3550542"}, {"introduction": "A critical challenge in nuclear structure calculations is the contamination of physical excitations by spurious modes arising from broken symmetries of the mean field, such as translational invariance. This practice provides a hands-on guide to addressing the spurious center-of-mass motion that pollutes the isovector giant dipole resonance. You will implement and compare two standard correction techniques—operator projection and the use of a translationally invariant operator—demonstrating how to ensure that computed observables correspond to true internal nuclear excitations. [@problem_id:3550546]", "problem": "Consider the isovector electric dipole collective vibration in a finite nucleus within the Random Phase Approximation (RPA) framework (Random Phase Approximation (RPA)). In a translationally invariant Hamiltonian, the center-of-mass (CM) motion appears as a spurious mode with excitation energy arbitrarily close to zero. In practice, a naive dipole operator couples to this spurious mode unless corrected, contaminating the computed strength. The physically correct observable must exclude any CM contribution.\n\nModel the RPA problem in a linear-algebra form. Let there be a one-particle–one-hole space of dimension $M$ that factorizes into proton and neutron sectors. Construct a set of $K$ orthonormal excitation vectors $\\{v_k\\}_{k=0}^{K-1}$ in $\\mathbb{R}^M$, with the spurious CM eigenvector $v_s$ included explicitly. Assume $v_s$ is the normalized uniform vector $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$, which represents an equal translation of all nucleons. Define the naive isovector dipole operator as a vector $d_{\\text{naive}}$ that assigns $+1$ to proton components and $-1$ to neutron components. The dipole strength carried by the mode $v_k$ for an operator $d$ is the squared amplitude $S_k(d) = |\\langle v_k, d \\rangle|^2 = |v_k^\\top d|^2$, and the total strength is $S_{\\text{tot}}(d) = \\sum_{k=0}^{K-1} S_k(d)$.\n\nTwo scientifically justified procedures exist to remove spurious CM contamination from the isovector dipole strength:\n\n- Orthogonality enforcement: Modify the operator by projecting it onto the subspace orthogonal to $v_s$, $d_{\\perp} = d_{\\text{naive}} - (v_s^\\top d_{\\text{naive}}) v_s$, so that $v_s^\\top d_{\\perp} = 0$.\n- Translationally invariant operator: Use the translationally invariant isovector dipole operator $d_{\\text{TI}}$ that, in single-particle form, subtracts the center-of-mass coordinate. In a proton–neutron decomposition this yields effective charges $e_p = \\frac{N}{A}$ for protons and $e_n = -\\frac{Z}{A}$ for neutrons, where $Z$ is the proton number, $N$ is the neutron number, and $A = Z + N$ is the mass number. In this model, $d_{\\text{TI}}$ assigns $+\\frac{N}{A}$ to proton components and $-\\frac{Z}{A}$ to neutron components, ensuring $v_s^\\top d_{\\text{TI}} = 0$.\n\nYour task is to devise and implement a computational procedure that, for a given nucleus $(Z,N)$, constructs $K$ orthonormal excitation vectors that include the spurious CM vector $v_s$, computes the dipole strengths for three operators $d_{\\text{naive}}$, $d_{\\perp}$, and $d_{\\text{TI}}$, and quantifies the residual spurious contamination as the fraction\n$$\nf_{\\text{spur}}(d) = \\frac{S_s(d)}{S_{\\text{tot}}(d)},\n$$\nwhere $S_s(d) = S_{k=s}(d)$ is the strength carried by the spurious CM mode. The final numerical outputs must be dimensionless floats and booleans.\n\nImplement the following precise, reproducible procedure in a program:\n\n1. Build the spurious CM vector $v_s \\in \\mathbb{R}^{M}$ as the normalized uniform vector $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$.\n2. Generate $K-1$ random vectors in $\\mathbb{R}^{M}$ from a standard normal distribution, then orthogonalize each to $v_s$ by subtracting its projection onto $v_s$, and perform a thin $\\mathsf{QR}$ decomposition to obtain an orthonormal set $\\{q_j\\}_{j=0}^{K-2}$ that spans the subspace orthogonal to $v_s$.\n3. Form the excitation set $\\{v_k\\}$ by taking $v_0 = v_s$ and $v_{k} = q_{k-1}$ for $k = 1,\\dots,K-1$.\n4. Define $d_{\\text{naive}} \\in \\mathbb{R}^{M}$ by assigning $+1$ to the first $Z$ components (protons) and $-1$ to the remaining $N$ components (neutrons).\n5. Define $d_{\\perp} = d_{\\text{naive}} - (v_s^\\top d_{\\text{naive}}) v_s$.\n6. Define $d_{\\text{TI}}$ by assigning $+\\frac{N}{A}$ to the first $Z$ components and $-\\frac{Z}{A}$ to the remaining $N$ components.\n7. For each operator $d \\in \\{d_{\\text{naive}}, d_{\\perp}, d_{\\text{TI}}\\}$, compute the strengths $S_k(d) = |v_k^\\top d|^2$ for $k=0,\\dots,K-1$, the total strength $S_{\\text{tot}}(d)$, and the spurious fraction $f_{\\text{spur}}(d)$.\n8. Define a tolerance $\\varepsilon = 10^{-12}$ and booleans $b_{\\perp} = (f_{\\text{spur}}(d_{\\perp})  \\varepsilon)$ and $b_{\\text{TI}} = (f_{\\text{spur}}(d_{\\text{TI}})  \\varepsilon)$.\n\nTest suite. Use the following three parameter sets that must be hard-coded in the program:\n\n- Case $1$: $Z=82$, $N=126$, $A=208$, $K=21$, seed $= 12345$.\n- Case $2$: $Z=20$, $N=20$, $A=40$, $K=15$, seed $= 54321$.\n- Case $3$: $Z=8$, $N=40$, $A=48$, $K=18$, seed $= 2023$.\n\nFor each case, the program must compute and return a list with five entries in the exact order $[f_{\\text{spur}}(d_{\\text{naive}}), f_{\\text{spur}}(d_{\\perp}), f_{\\text{spur}}(d_{\\text{TI}}), b_{\\perp}, b_{\\text{TI}}]$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list of the three case results enclosed in square brackets, where each case result is itself a comma-separated list enclosed in square brackets. For example, the output must look like $[[x_1,x_2,x_3,x_4,x_5],[y_1,y_2,y_3,y_4,y_5],[z_1,z_2,z_3,z_4,z_5]]$ with numerical values and booleans inserted. No physical units are required because all returned values are dimensionless. Angles are not used.", "solution": "The isovector electric dipole vibration reflects a collective out-of-phase proton–neutron motion. A translationally invariant Hamiltonian possesses a symmetry-generated spurious state associated with the center-of-mass (CM) translation. In the Random Phase Approximation (RPA), this spurious state appears as an eigenvector with energy near zero and is proportional to the generator of translations. When one uses a naive dipole operator $\\hat{D} = \\sum_{i \\in p} z_i - \\sum_{j \\in n} z_j$ without subtracting the CM motion, the operator couples to the spurious mode, producing artificial strength at zero energy. The remedy is to enforce translational invariance either by explicitly projecting out the CM component from the operator or by using a translationally invariant operator that assigns effective charges ensuring no CM coupling.\n\nPrinciples. The fundamental base is translational invariance of the Hamiltonian and the linear-response construction of RPA modes. The CM spurious eigenvector is the uniform translation of all coordinates. In a discretized one-particle–one-hole basis, we model this spurious eigenvector as $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$. The coupling amplitude of an operator $d$ to a normalized mode $v_k$ is $a_k(d) = v_k^\\top d$, and the dipole strength is $S_k(d) = |a_k(d)|^2$. Because strength is quadratic in the operator, projecting the operator to eliminate its component along $v_s$ eliminates any coupling to the spurious mode without altering physical couplings within the orthogonal subspace. Separately, translational invariance of the isovector dipole operator yields the well-known effective charges $e_p = \\frac{N}{A}$ and $e_n = -\\frac{Z}{A}$, corresponding to\n$$\n\\hat{D}_{\\text{TI}} = \\sum_{i \\in p} e_p (z_i - Z_{\\text{CM}}) + \\sum_{j \\in n} e_n (z_j - Z_{\\text{CM}}), \\quad Z_{\\text{CM}} = \\frac{1}{A} \\sum_{k=1}^{A} z_k,\n$$\nwhich in vector form assigns $+\\frac{N}{A}$ weight to proton components and $-\\frac{Z}{A}$ weight to neutron components. This construction ensures $v_s^\\top d_{\\text{TI}} = 0$ because the sum of weights is zero: $Z \\cdot \\frac{N}{A} + N \\cdot \\left(-\\frac{Z}{A}\\right) = 0$.\n\nAlgorithmic design.\n\n1. Construct $v_s \\in \\mathbb{R}^{M}$ as $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$, guaranteeing $\\|v_s\\|_2 = 1$.\n2. Generate $K-1$ random column vectors $w_j \\in \\mathbb{R}^{M}$ sampled from a standard normal distribution. Enforce orthogonality to $v_s$ by setting $\\tilde{w}_j = w_j - (v_s^\\top w_j) v_s$ for all $j$. This ensures $v_s^\\top \\tilde{w}_j = 0$.\n3. Compute the thin $\\mathsf{QR}$ decomposition of the $M \\times (K-1)$ matrix $\\tilde{W} = [\\tilde{w}_0,\\dots,\\tilde{w}_{K-2}]$ to obtain $\\tilde{W} = Q R$ with $Q^\\top Q = I_{K-1}$. Take the columns of $Q$ as an orthonormal set $\\{q_j\\}_{j=0}^{K-2}$ spanning the subspace orthogonal to $v_s$.\n4. Define the excitation vectors $v_0 = v_s$ and $v_k = q_{k-1}$ for $k=1,\\dots,K-1$. The set $\\{v_k\\}_{k=0}^{K-1}$ is orthonormal by construction.\n5. Define the naive operator $d_{\\text{naive}}$ as an $M$-vector with $+1$ for the first $Z$ entries (protons) and $-1$ for the remaining $N$ entries (neutrons). This operator generally has nonzero overlap with $v_s$ if $Z \\neq N$ because $v_s^\\top d_{\\text{naive}} \\propto \\sum_i d_{\\text{naive},i} = Z - N$.\n6. Project the naive operator orthogonal to $v_s$: $d_{\\perp} = d_{\\text{naive}} - (v_s^\\top d_{\\text{naive}}) v_s$. This guarantees $v_s^\\top d_{\\perp} = 0$ and hence $S_s(d_{\\perp}) = |v_s^\\top d_{\\perp}|^2 = 0$ up to numerical precision.\n7. Construct the translationally invariant operator $d_{\\text{TI}}$ by setting its entries to $+\\frac{N}{A}$ for proton components and $-\\frac{Z}{A}$ for neutron components. The sum of components is zero, so $v_s^\\top d_{\\text{TI}} = 0$ and $S_s(d_{\\text{TI}}) = 0$ up to numerical precision.\n8. For each operator $d \\in \\{d_{\\text{naive}}, d_{\\perp}, d_{\\text{TI}}\\}$, compute $S_k(d) = |v_k^\\top d|^2$ for $k=0,\\dots,K-1$ and $S_{\\text{tot}}(d) = \\sum_{k=0}^{K-1} S_k(d)$. Quantify spurious contamination as\n$$\nf_{\\text{spur}}(d) = \\frac{S_s(d)}{S_{\\text{tot}}(d)}.\n$$\nBecause $d_{\\perp}$ and $d_{\\text{TI}}$ are orthogonal to $v_s$, $f_{\\text{spur}}(d_{\\perp})$ and $f_{\\text{spur}}(d_{\\text{TI}})$ should be numerically very small, ideally close to $0$.\n9. Define a numerical tolerance $\\varepsilon = 10^{-12}$ and report booleans $b_{\\perp} = (f_{\\text{spur}}(d_{\\perp})  \\varepsilon)$ and $b_{\\text{TI}} = (f_{\\text{spur}}(d_{\\text{TI}})  \\varepsilon)$ indicating successful removal of spurious strength.\n\nTest suite rationale.\n\n- Case $1$ ($Z=82$, $N=126$, $A=208$): An asymmetric nucleus representative of a heavy system (such as lead) where $v_s^\\top d_{\\text{naive}} \\neq 0$; significant spurious contamination is expected for $d_{\\text{naive}}$. Both corrections should suppress it.\n- Case $2$ ($Z=20$, $N=20$, $A=40$): A symmetric nucleus where $Z = N$ implies $\\sum_i d_{\\text{naive},i} = 0$, and thus $v_s^\\top d_{\\text{naive}} = 0$; naive operator already has negligible spurious contamination, providing a boundary check.\n- Case $3$ ($Z=8$, $N=40$, $A=48$): A highly asymmetric light system where naive contamination is strong; both corrections should remove it.\n\nImplementation notes.\n\n- The orthonormalization via $\\mathsf{QR}$ ensures numerical stability and an exact orthonormal set in floating point arithmetic.\n- Strengths $S_k(d)$ are non-negative by construction. The fractions $f_{\\text{spur}}(d)$ are dimensionless and lie in $[0,1]$.\n- Since scaling $d$ by a constant multiplies both $S_s(d)$ and $S_{\\text{tot}}(d)$ by the same factor, $f_{\\text{spur}}(d)$ is invariant under uniform scaling of $d$.\n\nThe final program must hard-code the three cases and produce a single-line output of the form $[[f_{\\text{naive}},f_{\\perp},f_{\\text{TI}},b_{\\perp},b_{\\text{TI}}]_{\\text{case 1}},[f_{\\text{naive}},f_{\\perp},f_{\\text{TI}},b_{\\perp},b_{\\text{TI}}]_{\\text{case 2}},[f_{\\text{naive}},f_{\\perp},f_{\\text{TI}},b_{\\perp},b_{\\text{TI}}]_{\\text{case 3}}]$ with numeric values and booleans. No physical units are required because all returned values are dimensionless.", "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\ndef build_spurious_vector(M: int) - np.ndarray:\n    \"\"\"Return normalized uniform spurious CM vector of length M.\"\"\"\n    v = np.ones(M, dtype=float)\n    return v / np.linalg.norm(v)\n\ndef orthonormal_modes(M: int, K: int, seed: int) - np.ndarray:\n    \"\"\"\n    Construct K orthonormal excitation vectors in R^M that include the spurious CM vector.\n    v0 is the spurious vector; the remaining K-1 vectors are orthonormal and orthogonal to it.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    v_s = build_spurious_vector(M)\n    # Generate K-1 random vectors\n    W = rng.normal(size=(M, K-1))\n    # Orthogonalize each to v_s\n    proj_coeffs = v_s @ W  # shape (K-1,)\n    W_tilde = W - np.outer(v_s, proj_coeffs)\n    # QR decomposition to obtain orthonormal columns\n    Q, _ = np.linalg.qr(W_tilde, mode='reduced')  # Q is M x (K-1)\n    # Compose modes: first column is v_s, then Q's columns\n    V = np.empty((M, K), dtype=float)\n    V[:, 0] = v_s\n    V[:, 1:] = Q\n    # Sanity: ensure orthonormality\n    # V^T V should be identity; minor numerical deviations are acceptable\n    return V\n\ndef build_naive_operator(Z: int, N: int) - np.ndarray:\n    \"\"\"Naive isovector dipole operator: +1 for protons, -1 for neutrons.\"\"\"\n    A = Z + N\n    d = np.empty(A, dtype=float)\n    d[:Z] = 1.0\n    d[Z:] = -1.0\n    return d\n\ndef build_ti_operator(Z: int, N: int) - np.ndarray:\n    \"\"\"Translationally invariant isovector dipole operator with effective charges.\"\"\"\n    A = Z + N\n    d = np.empty(A, dtype=float)\n    d[:Z] = N / A\n    d[Z:] = -Z / A\n    return d\n\ndef project_operator(d: np.ndarray, v_s: np.ndarray) - np.ndarray:\n    \"\"\"Project operator d onto subspace orthogonal to v_s.\"\"\"\n    coeff = float(v_s @ d)\n    return d - coeff * v_s\n\ndef strengths(V: np.ndarray, d: np.ndarray) - np.ndarray:\n    \"\"\"Compute strengths S_k(d) = |v_k^T d|^2 for all modes.\"\"\"\n    amps = V.T @ d  # shape (K,)\n    return np.square(np.abs(amps))\n\ndef spurious_fraction(V: np.ndarray, d: np.ndarray, spur_index: int = 0) - float:\n    \"\"\"Compute spurious fraction f_spur(d) = S_spur / S_tot.\"\"\"\n    S = strengths(V, d)\n    S_tot = float(np.sum(S))\n    S_spur = float(S[spur_index])\n    # Guard against round-off leading to zero total strength\n    if S_tot == 0.0:\n        return 0.0\n    return S_spur / S_tot\n\ndef case_result(Z: int, N: int, K: int, seed: int, tol: float = 1e-12):\n    \"\"\"Compute [f_naive, f_proj, f_ti, b_proj, b_ti] for one test case.\"\"\"\n    A = Z + N\n    V = orthonormal_modes(A, K, seed)\n    v_s = V[:, 0]\n    d_naive = build_naive_operator(Z, N)\n    d_proj = project_operator(d_naive, v_s)\n    d_ti = build_ti_operator(Z, N)\n\n    f_naive = spurious_fraction(V, d_naive, spur_index=0)\n    f_proj = spurious_fraction(V, d_proj, spur_index=0)\n    f_ti = spurious_fraction(V, d_ti, spur_index=0)\n\n    b_proj = f_proj  tol\n    b_ti = f_ti  tol\n    return [f_naive, f_proj, f_ti, b_proj, b_ti]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Z, N, K, seed)\n        (82, 126, 21, 12345),  # Case 1: A=208\n        (20, 20, 15, 54321),   # Case 2: A=40, symmetric\n        (8, 40, 18, 2023),     # Case 3: A=48, asymmetric\n    ]\n\n    results = []\n    for Z, N, K, seed in test_cases:\n        results.append(case_result(Z, N, K, seed, tol=1e-12))\n\n    # Final print statement in the exact required format.\n    # Booleans and floats will be printed as Python literals; this matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3550546"}]}