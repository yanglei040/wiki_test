{"hands_on_practices": [{"introduction": "The heart of any mean-field theory is the iterative loop that seeks a self-consistent solution, where the fields generated by the nucleons and the single-particle states that occupy them are in equilibrium. This fundamental practice guides you through implementing a robust solver for the relativistic mean-field equations that determine the nucleon effective mass. You will explore essential numerical techniques like damped iteration (mixing) and preconditioning, which are critical for ensuring stable and efficient convergence in realistic calculations [@problem_id:3554475].", "problem": "You are to implement and analyze a self-consistent nonlinear fixed-point solver for a simplified covariant mean-field model grounded in the Covariant Energy Density Functional (CEDF) framework and the Relativistic Mean Field (RMF) approximation. The computational task is to solve for the self-consistent scalar effective mass at a given baryon density, using a damped, diagonally preconditioned iteration, and to quantify convergence and stability across a set of axial quadrupole deformations. The problem is posed entirely in mathematical and algorithmic terms, and you must adhere to physically consistent units throughout.\n\nThe fundamental base consists of the following widely accepted relations for cold, uniform, isospin-symmetric nuclear matter in the RMF approximation:\n1. The baryon density is given by $ \\rho_{B} = \\dfrac{\\gamma\\,k_{F}^{3}}{6\\pi^{2}} $, where $ \\gamma $ is the spin-isospin degeneracy and $ k_{F} $ is the Fermi momentum.\n2. The scalar density is given by\n$$\n\\rho_{S}(m^{\\ast},k_{F}) = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} \\dfrac{p^{2}\\,m^{\\ast}}{\\sqrt{p^{2} + m^{\\ast 2}}}\\,dp,\n$$\nwhere $ m^{\\ast} $ is the effective Dirac mass in units of inverse femtometers.\n3. The self-consistent scalar mass relation (Hartree level, local density approximation) is\n$$\nm^{\\ast} = m - C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}),\n$$\nwhere $ m $ is the bare mass in inverse femtometers and $ C_{S} $ is the scalar coupling constant combination $ g_{S}^{2}/m_{S}^{2} $ in square femtometers.\n4. The vector potential is given by\n$$\nv_{0} = C_{V}\\,\\rho_{B},\n$$\nwith $ C_{V} = g_{V}^{2}/m_{V}^{2} $ in square femtometers.\n5. The chemical potential (single-particle Fermi energy) in natural units is\n$$\n\\mu = \\sqrt{k_{F}^{2} + m^{\\ast 2}} + v_{0}.\n$$\n\nYou must use natural units with $ \\hbar = c = 1 $, keeping momenta and masses in inverse femtometers and densities in inverse cubic femtometers (i.e., $ \\mathrm{fm}^{-3} $). When reporting any energy-like quantity in megaelectronvolts, convert using $ \\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm} $.\n\nThe nonlinear equation for $ m^{\\ast} $ is to be solved iteratively using a damped, diagonally preconditioned fixed-point update\n$$\nm^{\\ast}_{n+1} = m^{\\ast}_{n} - \\alpha\\,P(m^{\\ast}_{n})\\,r(m^{\\ast}_{n}),\n$$\nwhere $ r(m^{\\ast}) = m^{\\ast} - m + C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}) $ is the residual, $ \\alpha \\in (0,1] $ is the mixing parameter, and $ P(m^{\\ast}) $ is a diagonal preconditioner based on the linearization. The Jacobian of the residual is\n$$\nJ(m^{\\ast}) = \\dfrac{dr}{dm^{\\ast}} = 1 + C_{S}\\,\\dfrac{d\\rho_{S}}{dm^{\\ast}},\n$$\nwith\n$$\n\\dfrac{d\\rho_{S}}{dm^{\\ast}} = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} p^{2} \\left(\\dfrac{1}{\\sqrt{p^{2} + m^{\\ast 2}}} - \\dfrac{m^{\\ast 2}}{\\left(p^{2} + m^{\\ast 2}\\right)^{3/2}}\\right) dp.\n$$\nSet the diagonal preconditioner to $ P(m^{\\ast}) = 1/J(m^{\\ast}) $ when preconditioning is enabled, and $ P(m^{\\ast}) = 1 $ when preconditioning is disabled.\n\nDefine convergence using both an absolute residual tolerance and a relative change tolerance. Let the absolute tolerance be $ \\varepsilon_{\\mathrm{abs}} = 10^{-8}\\,\\mathrm{fm}^{-1} $ on $ |r(m^{\\ast})| $ and the relative change tolerance be $ \\varepsilon_{\\mathrm{rel}} = 10^{-8} $ on $ |m^{\\ast}_{n+1} - m^{\\ast}_{n}|/|m^{\\ast}_{n}| $. The solver should stop when both criteria are satisfied or when a maximum of $ N_{\\max} = 100 $ iterations is reached. The iteration stability can be quantified by the local spectral radius factor\n$$\n\\sigma = \\left|1 - \\alpha\\,P(m^{\\ast})\\,J(m^{\\ast})\\right|,\n$$\nevaluated at the last iterate; the iteration is linearly stable if $ \\sigma < 1 $.\n\nTo emulate deformation effects within a Local Density Approximation (LDA) across axial quadrupole deformations, use a density model\n$$\n\\rho_{B}(\\beta_{2}) = \\rho_{0}\\,\\left(1 - c\\,\\beta_{2}^{2}\\right),\n$$\nwith $ \\rho_{0} = 0.16\\,\\mathrm{fm}^{-3} $ and $ c = 0.8 $, which provides a scientifically plausible monotonic reduction of local density with increasing magnitude of the deformation parameter $ \\beta_{2} $.\n\nParameters to be used:\n- Bare nucleon mass: $ M = 939\\,\\mathrm{MeV} $, converted to inverse femtometers by $ m = M/(\\hbar c) $.\n- Degeneracy: $ \\gamma = 4 $.\n- Scalar coupling combination: $ C_{S} = 11.0\\,\\mathrm{fm}^{2} $.\n- Vector coupling combination: $ C_{V} = 7.0\\,\\mathrm{fm}^{2} $.\n- Natural unit conversion: $ \\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm} $.\n\nYour program must implement:\n1. Computation of $ k_{F}(\\rho_{B}) = \\left(\\dfrac{6\\pi^{2}\\rho_{B}}{\\gamma}\\right)^{1/3} $.\n2. Numerical quadrature for $ \\rho_{S}(m^{\\ast},k_{F}) $ and $ \\dfrac{d\\rho_{S}}{dm^{\\ast}}(m^{\\ast},k_{F}) $.\n3. The iterative solver with the specified mixing and optional preconditioning.\n4. Convergence detection and stability quantification via $ \\sigma $.\n5. Reporting of the effective mass ratio $ M^{\\ast}/M $, where $ M^{\\ast} = m^{\\ast}\\,(\\hbar c) $.\n\nExpress any energy-like outputs in $ \\mathrm{MeV} $. Express densities in $ \\mathrm{fm}^{-3} $. Angles do not appear in this problem. Any fractions should be provided in decimal form.\n\nTest suite:\nEvaluate the solver for the following four test cases, each specified by a tuple $ (\\beta_{2}, \\alpha, \\text{preconditioning}) $:\n1. $ (\\beta_{2} = 0.0, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $\n2. $ (\\beta_{2} = 0.3, \\alpha = 0.2, \\text{preconditioning} = \\text{True}) $\n3. $ (\\beta_{2} = -0.3, \\alpha = 1.0, \\text{preconditioning} = \\text{False}) $\n4. $ (\\beta_{2} = 0.6, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $\n\nFor each test case, your program must output a list with the following five entries:\n- Converged status as a boolean,\n- Number of iterations as an integer,\n- The effective mass ratio $ M^{\\ast}/M $ as a float,\n- Stability status as a boolean indicating whether $ \\sigma < 1 $,\n- The spectral radius factor $ \\sigma $ as a float.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case’s result itself being a list in the order specified above. For example, the output must look like $ [\\,[\\ldots],\\,[\\ldots],\\,[\\ldots],\\,[\\ldots]\\,] $.", "solution": "The problem is situated within the Covariant Energy Density Functional (CEDF) framework and uses the Relativistic Mean Field (RMF) approximation for cold, uniform nuclear matter. The aim is to construct a self-consistent, iterative solver for the scalar effective mass $ m^{\\ast} $ based purely on established formulas.\n\nFoundational relations:\n- In uniform matter, the baryon density $ \\rho_{B} $ and Fermi momentum $ k_{F} $ satisfy $ \\rho_{B} = \\dfrac{\\gamma\\,k_{F}^{3}}{6\\pi^{2}} $, a direct consequence of filling plane-wave states up to $ k_{F} $ with degeneracy $ \\gamma $ in three dimensions. Solving for $ k_{F} $ yields $ k_{F} = \\left(\\dfrac{6\\pi^{2}\\rho_{B}}{\\gamma}\\right)^{1/3} $.\n- The scalar density $ \\rho_{S} $ emerges from the expectation value of the scalar bilinear in occupied states. In momentum space, for uniform matter at zero temperature in natural units $ \\hbar = c = 1 $, it is given by $ \\rho_{S}(m^{\\ast},k_{F}) = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} \\dfrac{p^{2}\\,m^{\\ast}}{\\sqrt{p^{2} + m^{\\ast 2}}}\\,dp $. This formula is well-tested and underlies the Hartree approximation to RMF.\n- The mean-field self-consistency equates the effective mass to its bare value minus the scalar field contribution: $ m^{\\ast} = m - C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}) $, with $ C_{S} = g_{S}^{2}/m_{S}^{2} $ in square femtometers. This expresses the equilibrium of the single-particle dynamics with the fields generated by the medium.\n\nAlgorithmic design:\n1. For a given axial quadrupole deformation parameter $ \\beta_{2} $, define the local baryon density as $ \\rho_{B}(\\beta_{2}) = \\rho_{0}\\,(1 - c\\,\\beta_{2}^{2}) $, with $ \\rho_{0} = 0.16\\,\\mathrm{fm}^{-3} $ and $ c = 0.8 $. This simple Local Density Approximation (LDA)-motivated model reflects the reduction of central density due to deformation while maintaining physical plausibility.\n2. Compute $ k_{F} = \\left(\\dfrac{6\\pi^{2}\\rho_{B}}{\\gamma}\\right)^{1/3} $, ensuring units are in inverse femtometers.\n3. Formulate the nonlinear residual $ r(m^{\\ast}) = m^{\\ast} - m + C_{S}\\,\\rho_{S}(m^{\\ast},k_{F}) $. The root of this residual gives the self-consistent solution for $ m^{\\ast} $.\n4. Implement numerical quadrature for the scalar density:\n   - $ \\rho_{S}(m^{\\ast},k_{F}) = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} \\dfrac{p^{2}\\,m^{\\ast}}{\\sqrt{p^{2} + m^{\\ast 2}}}\\,dp $,\n   using adaptive quadrature with the appropriate tolerances to resolve the integrable behavior near $ p = 0 $.\n5. For diagonal preconditioning, compute the Jacobian $ J(m^{\\ast}) $ by differentiating $ r $:\n   - $ J(m^{\\ast}) = 1 + C_{S}\\,\\dfrac{d\\rho_{S}}{dm^{\\ast}} $,\n   and the derivative of the scalar density is obtained via\n   - $ \\dfrac{d\\rho_{S}}{dm^{\\ast}} = \\dfrac{\\gamma}{2\\pi^{2}} \\int_{0}^{k_{F}} p^{2}\\left(\\dfrac{1}{\\sqrt{p^{2} + m^{\\ast 2}}} - \\dfrac{m^{\\ast 2}}{\\left(p^{2} + m^{\\ast 2}\\right)^{3/2}}\\right)dp $.\n   The diagonal preconditioner is $ P(m^{\\ast}) = 1/J(m^{\\ast}) $ when enabled; otherwise $ P(m^{\\ast}) = 1 $.\n6. Use a damped fixed-point update:\n   - $ m^{\\ast}_{n+1} = m^{\\ast}_{n} - \\alpha\\,P(m^{\\ast}_{n})\\,r(m^{\\ast}_{n}) $,\n   where $ \\alpha $ is the mixing parameter that controls the step size and thus the damping of the iteration.\n7. Convergence criteria are twofold:\n   - Absolute residual tolerance $ |r(m^{\\ast})| \\le \\varepsilon_{\\mathrm{abs}} $ with $ \\varepsilon_{\\mathrm{abs}} = 10^{-8}\\,\\mathrm{fm}^{-1} $,\n   - Relative change tolerance $ \\left|m^{\\ast}_{n+1} - m^{\\ast}_{n}\\right|/\\left|m^{\\ast}_{n}\\right| \\le \\varepsilon_{\\mathrm{rel}} $ with $ \\varepsilon_{\\mathrm{rel}} = 10^{-8} $.\n   The iteration stops when both are satisfied or when the maximum iteration count $ N_{\\max} = 100 $ is reached.\n8. Stability quantification:\n   - The linearized iteration near a fixed point $ m^{\\ast}_{\\star} $ has amplification factor $ \\lambda = 1 - \\alpha\\,P(m^{\\ast}_{\\star})\\,J(m^{\\ast}_{\\star}) $,\n   - The spectral radius factor $ \\sigma = |\\lambda| $ indicates stability; the iteration is linearly stable if $ \\sigma < 1 $.\n   This measure is computed at the last iterate to provide a diagnostic of robustness with respect to the chosen $ \\alpha $ and the presence or absence of preconditioning.\n\nPhysical units and outputs:\n- Convert $ M = 939\\,\\mathrm{MeV} $ to inverse femtometers via $ m = M/(\\hbar c) $ with $ \\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm} $.\n- After solving, report $ M^{\\ast}/M = (m^{\\ast}\\,\\hbar c)/M $ as a dimensionless float.\n- The vector potential $ v_{0} = C_{V}\\,\\rho_{B} $ and chemical potential $ \\mu = \\sqrt{k_{F}^{2} + m^{\\ast 2}} + v_{0} $ are computable but not required in the final output.\n\nTest suite coverage rationale:\n- $ (\\beta_{2} = 0.0, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $: A typical, well-behaved case near normal nuclear density to test the \"happy path\".\n- $ (\\beta_{2} = 0.3, \\alpha = 0.2, \\text{preconditioning} = \\text{True}) $: Small mixing to assess slow but stable convergence under damping.\n- $ (\\beta_{2} = -0.3, \\alpha = 1.0, \\text{preconditioning} = \\text{False}) $: High mixing without preconditioning to probe potential instability and convergence sensitivity.\n- $ (\\beta_{2} = 0.6, \\alpha = 0.7, \\text{preconditioning} = \\text{True}) $: Larger deformation with reduced density to test robustness across a wider parameter range.\n\nFinal output format:\nYour program must print a single line containing a comma-separated list enclosed in square brackets, where each element is itself a list containing, in order: the converged status as a boolean, the number of iterations as an integer, the effective mass ratio $ M^{\\ast}/M $ as a float, the stability status as a boolean, and the spectral radius factor $ \\sigma $ as a float. The output thus aggregates the results of all test cases into one line as $ [\\,[\\cdot],\\,[\\cdot],\\,[\\cdot],\\,[\\cdot]\\,] $.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Constants in natural units and physical parameters\nHC_MEV_FM = 197.3269804  # hbar*c in MeV*fm\nM_MEV = 939.0            # nucleon mass in MeV\nm_fm_inv = M_MEV / HC_MEV_FM  # bare mass in 1/fm\n\ngamma = 4.0              # spin-isospin degeneracy\nCS_fm2 = 11.0            # scalar coupling combination g_s^2/m_s^2 in fm^2\nCV_fm2 = 7.0             # vector coupling combination g_v^2/m_v^2 in fm^2\n\nrho0 = 0.16              # saturation density in fm^-3\nc_def = 0.8              # deformation density reduction coefficient\n\n# Convergence parameters\nEPS_ABS = 1e-8           # absolute residual tolerance in 1/fm\nEPS_REL = 1e-8           # relative change tolerance (dimensionless)\nMAX_ITER = 100           # maximum iterations\n\ndef kF_from_rho(rhoB: float) -> float:\n    \"\"\"Compute Fermi momentum k_F (1/fm) from baryon density rho_B (1/fm^3).\"\"\"\n    return ((6.0 * np.pi**2 * rhoB) / gamma) ** (1.0 / 3.0)\n\ndef rhoS(mstar: float, kF: float) -> float:\n    \"\"\"Compute scalar density rho_S (1/fm^3) for given m* (1/fm) and k_F (1/fm).\"\"\"\n    # Integrand: p^2 * m* / sqrt(p^2 + m*^2)\n    def integrand(p):\n        return (p**2) * (mstar) / np.sqrt(p**2 + mstar**2)\n    val, _ = quad(integrand, 0.0, kF, epsabs=1e-10, epsrel=1e-10, limit=200)\n    return (gamma / (2.0 * np.pi**2)) * val\n\ndef drhoS_dm(mstar: float, kF: float) -> float:\n    \"\"\"Compute derivative d rho_S / d m* (1/fm^2) at given m* and k_F.\"\"\"\n    # Integrand: p^2 * (1/E - m*^2 / E^3)\n    def integrand(p):\n        E = np.sqrt(p**2 + mstar**2)\n        return p**2 * (1.0 / E - (mstar**2) / (E**3))\n    val, _ = quad(integrand, 0.0, kF, epsabs=1e-10, epsrel=1e-10, limit=200)\n    return (gamma / (2.0 * np.pi**2)) * val\n\ndef residual(mstar: float, m_bare: float, kF: float) -> float:\n    \"\"\"Residual r(m*) = m* - m + C_S * rho_S(m*, kF). Units: 1/fm.\"\"\"\n    return mstar - m_bare + CS_fm2 * rhoS(mstar, kF)\n\ndef jacobian(mstar: float, kF: float) -> float:\n    \"\"\"Jacobian dr/dm* = 1 + C_S * d rho_S / d m*. Dimensionless.\"\"\"\n    return 1.0 + CS_fm2 * drhoS_dm(mstar, kF)\n\ndef vector_potential(rhoB: float) -> float:\n    \"\"\"Vector potential v0 in 1/fm.\"\"\"\n    return CV_fm2 * rhoB\n\ndef solve_case(beta2: float, alpha: float, use_precond: bool):\n    \"\"\"Solve for m* given beta2, mixing alpha, and preconditioning flag.\"\"\"\n    # Local density model\n    rhoB = rho0 * (1.0 - c_def * (beta2 ** 2))\n    kF = kF_from_rho(rhoB)\n\n    # Initial guess: start from bare mass\n    mstar = m_fm_inv\n    converged = False\n    iterations = 0\n\n    # Iteration\n    for it in range(1, MAX_ITER + 1):\n        r = residual(mstar, m_fm_inv, kF)\n        J = jacobian(mstar, kF)\n        P = (1.0 / J) if use_precond else 1.0\n\n        # Update with mixing and (optional) preconditioning\n        m_next = mstar - alpha * P * r\n\n        # Check convergence criteria\n        abs_ok = abs(r) <= EPS_ABS\n        rel_ok = abs(m_next - mstar) / max(abs(mstar), 1e-16) <= EPS_REL\n\n        iterations = it\n        mstar = m_next\n\n        if abs_ok and rel_ok:\n            converged = True\n            break\n\n    # Compute stability measure at last iterate\n    J_final = jacobian(mstar, kF)\n    P_final = (1.0 / J_final) if use_precond else 1.0\n    spectral_radius = abs(1.0 - alpha * P_final * J_final)\n    is_stable = spectral_radius < 1.0\n\n    # Effective mass ratio M*/M\n    Mstar_M_ratio = (mstar * HC_MEV_FM) / M_MEV\n\n    return [converged, iterations, float(Mstar_M_ratio), is_stable, float(spectral_radius)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.7, True),\n        (0.3, 0.2, True),\n        (-0.3, 1.0, False),\n        (0.6, 0.7, True),\n    ]\n\n    results = []\n    for beta2, alpha, precond in test_cases:\n        result = solve_case(beta2, alpha, precond)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Print as a single comma-separated list of lists enclosed in square brackets.\n    def format_elem(elem):\n        if isinstance(elem, list):\n            return \"[\" + \",\".join(format_elem(x) for x in elem) + \"]\"\n        elif isinstance(elem, bool):\n            return \"True\" if elem else \"False\"\n        else:\n            return str(elem)\n\n    print(\"[\" + \",\".join(format_elem(r) for r in results) + \"]\")\n\nsolve()\n```", "id": "3554475"}, {"introduction": "While covariant energy density functionals are built on a relativistic foundation, their physical content must connect with the familiar non-relativistic description of the nucleus. This analytical exercise bridges this conceptual gap by using a Foldy-Wouthuysen reduction, a technique for obtaining a non-relativistic Hamiltonian from the Dirac equation. By mapping a simple point-coupling covariant functional onto a non-relativistic Skyrme-like form, you will see how fundamental nuclear properties like the spin-orbit interaction emerge naturally from the Lorentz structure of the theory [@problem_id:3554423].", "problem": "Consider a covariant point-coupling Energy Density Functional (EDF) in the Hartree (no Fock exchange) approximation with isoscalar scalar, isoscalar vector, and isovector vector contact channels. The Lagrangian density for the nucleon field $\\psi$ of mass $m$ is\n$$\n\\mathcal{L} \\;=\\; \\bar{\\psi}\\big(i\\gamma^{\\mu}\\partial_{\\mu} - m\\big)\\psi \\;-\\; \\frac{1}{2}\\alpha_{S}\\big(\\bar{\\psi}\\psi\\big)^{2} \\;-\\; \\frac{1}{2}\\alpha_{V}\\big(\\bar{\\psi}\\gamma_{\\mu}\\psi\\big)\\big(\\bar{\\psi}\\gamma^{\\mu}\\psi\\big) \\;-\\; \\frac{1}{2}\\alpha_{TV}\\big(\\bar{\\psi}\\gamma_{\\mu}\\vec{\\tau}\\psi\\big)\\cdot\\big(\\bar{\\psi}\\gamma^{\\mu}\\vec{\\tau}\\psi\\big),\n$$\nwith isoscalar scalar coupling $\\alpha_{S}$, isoscalar vector coupling $\\alpha_{V}$, and isovector vector coupling $\\alpha_{TV}$. In static systems and at the mean-field level, the nucleon experiences a Lorentz-scalar field $S$ and a time-like vector field $V^{0}_{q}$,\n$$\nS \\;=\\; \\alpha_{S}\\,\\rho_{S}, \\qquad V^{0}_{q} \\;=\\; \\alpha_{V}\\,\\rho \\;+\\; \\alpha_{TV}\\,t_{q}\\,\\rho_{1},\n$$\nwhere $q\\in\\{n,p\\}$ labels neutrons and protons, $t_{n}=+1$, $t_{p}=-1$, the isoscalar (baryon) density is $\\rho=\\rho_{n}+\\rho_{p}$, the isovector density is $\\rho_{1}=\\rho_{n}-\\rho_{p}$, and the scalar density is $\\rho_{S}=\\langle\\bar{\\psi}\\psi\\rangle$. Assume a time-reversal invariant, slowly varying system so that spatial vector currents vanish and gradients are small. Work at leading order in the gradient expansion and to leading order in $|S|/m$, replacing $m^{\\ast}=m+S$ by $m$ in denominators.\n\n1) Starting from the Dirac equation in the background fields $S$ and $V^{0}_{q}$, perform a Foldy–Wouthuysen (FW) reduction up to order $1/m^{2}$ and extract the single-particle nonrelativistic Hamiltonian to this order. Show that the spin–orbit operator for nucleons of isospin $q$ takes the form\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} \\;=\\; \\frac{1}{4m^{2}}\\Big[\\nabla\\big(V^{0}_{q}-S\\big)\\times\\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma},\n$$\nto leading order in gradients and $|S|/m$, and using $\\rho_{S}\\approx \\rho$ at this order.\n\n2) In a standard nonrelativistic Skyrme-type EDF, the time-even spin–orbit and tensor parts of the energy density are written as\n$$\n\\mathcal{E}_{\\mathrm{so}} \\;=\\; -\\sum_{t=0,1} C_{t}^{\\nabla J}\\,\\rho_{t}\\,\\nabla\\cdot\\mathbf{J}_{t}, \n\\qquad\n\\mathcal{E}_{T} \\;=\\; \\sum_{t=0,1} C_{t}^{J}\\,\\mathbf{J}_{t}^{2},\n$$\nwhere the isoscalar density $\\rho_{0}=\\rho_{n}+\\rho_{p}$ and isovector density $\\rho_{1}=\\rho_{n}-\\rho_{p}$, and the corresponding spin–orbit (spin-current) densities are $\\mathbf{J}_{0}=\\mathbf{J}_{n}+\\mathbf{J}_{p}$ and $\\mathbf{J}_{1}=\\mathbf{J}_{n}-\\mathbf{J}_{p}$. By functional variation, the single-particle spin–orbit field for nucleon species $q$ is\n$$\n\\mathbf{W}_{q} \\;=\\; 2\\,C_{0}^{\\nabla J}\\,\\nabla\\rho \\;+\\; 2\\,t_{q}\\,C_{1}^{\\nabla J}\\,\\nabla\\rho_{1},\n$$\nand the resulting single-particle spin–orbit operator reads\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} \\;=\\; \\frac{1}{2}\\Big[\\mathbf{W}_{q}\\times\\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n\\;=\\; \\Big[C_{0}^{\\nabla J}\\,\\nabla\\rho \\;+\\; t_{q}\\,C_{1}^{\\nabla J}\\,\\nabla\\rho_{1}\\Big]\\times\\hat{\\mathbf{p}}\\cdot\\boldsymbol{\\sigma}.\n$$\n\n3) By comparing the covariant FW-reduced spin–orbit operator from part 1) to the Skyrme spin–orbit operator in part 2), determine the explicit mapping for the Skyrme spin–orbit coupling constants $C_{0}^{\\nabla J}$ and $C_{1}^{\\nabla J}$ in terms of the covariant couplings $\\alpha_{S}$, $\\alpha_{V}$, $\\alpha_{TV}$, and the nucleon mass $m$. Under the stated assumptions and to the specified order, determine also the Skyrme tensor couplings $C_{0}^{J}$ and $C_{1}^{J}$ generated by this covariant point-coupling EDF. State clearly your final result as a $1\\times 4$ row matrix \n$$\n\\big(C_{0}^{\\nabla J}\\;\\; C_{1}^{\\nabla J}\\;\\; C_{0}^{J}\\;\\; C_{1}^{J}\\big).\n$$\n\nExpress your final answer as exact symbolic expressions; no numerical values or rounding are required. Define any symbol you introduce, and spell out any acronyms on first use, such as Energy Density Functional (EDF) and Foldy–Wouthuysen (FW).", "solution": "The problem asks for the determination of specific coupling constants of a non-relativistic Skyrme-type Energy Density Functional (EDF) by mapping from a parent covariant point-coupling EDF. The solution proceeds in three logical steps as laid out in the problem statement. Acronyms will be defined on first use, such as Foldy-Wouthuysen (FW).\n\nPart 1: Derivation of the non-relativistic spin-orbit operator.\n\nThe starting point is the provided relativistic Lagrangian density for a nucleon field $\\psi$ of mass $m$:\n$$\n\\mathcal{L} \\;=\\; \\bar{\\psi}\\big(i\\gamma^{\\mu}\\partial_{\\mu} - m\\big)\\psi \\;-\\; \\frac{1}{2}\\alpha_{S}\\big(\\bar{\\psi}\\psi\\big)^{2} \\;-\\; \\frac{1}{2}\\alpha_{V}\\big(\\bar{\\psi}\\gamma_{\\mu}\\psi\\big)\\big(\\bar{\\psi}\\gamma^{\\mu}\\psi\\big) \\;-\\; \\frac{1}{2}\\alpha_{TV}\\big(\\bar{\\psi}\\gamma_{\\mu}\\vec{\\tau}\\psi\\big)\\cdot\\big(\\bar{\\psi}\\gamma^{\\mu}\\vec{\\tau}\\psi\\big)\n$$\nIn the Hartree (mean-field) approximation for a static, time-reversal invariant system, the many-body self-energy is replaced by local, density-dependent potentials. The equation of motion derived from this Lagrangian for a single nucleon of isospin $q$ (where $q \\in \\{n,p\\}$) is the Dirac equation:\n$$\n\\big[i\\gamma^{\\mu}\\partial_{\\mu} - m - \\Sigma^{(q)}\\big]\\psi_q = 0\n$$\nThe self-energy $\\Sigma^{(q)}$ is obtained from functional variation of the interaction energy density. For the given Lagrangian, the self-energy is composed of a Lorentz-scalar part $S$ and a time-like Lorentz-vector part $V_q^0$:\n$$\n\\Sigma^{(q)} = S - \\gamma^{0}V_{q}^{0}\n$$\nwhere $S = \\alpha_{S}\\rho_{S}$ and $V_{q}^{0} = \\alpha_{V}\\rho + \\alpha_{TV}t_{q}\\rho_{1}$. The densities are the scalar density $\\rho_{S} = \\langle\\bar{\\psi}\\psi\\rangle$, the baryon density $\\rho = \\langle\\psi^{\\dagger}\\psi\\rangle$, and the isovector density $\\rho_{1} = \\rho_n - \\rho_p$. The spatial components of the vector self-energy vanish in a static system with time-reversal invariance.\nThe Dirac equation can be written in Hamiltonian form $i\\partial_t \\psi_q = \\hat{H}_{D}^{(q)}\\psi_q$, with the single-particle Dirac Hamiltonian:\n$$\n\\hat{H}_{D}^{(q)} = \\vec{\\alpha} \\cdot \\hat{\\mathbf{p}} + \\beta (m+S) + V_{q}^{0}\n$$\nwhere we used $\\gamma^0 = \\beta$, $\\vec{\\gamma} = \\beta\\vec{\\alpha}$, and $\\hat{\\mathbf{p}} = -i\\vec{\\nabla}$. The scalar field $S$ couples to the mass term, defining an effective mass $m^{\\ast} = m+S$.\n\nTo obtain the non-relativistic Hamiltonian, we perform a Foldy-Wouthuysen (FW) reduction on $\\hat{H}_{D}^{(q)}$. The standard result of the FW transformation for a Dirac Hamiltonian of this form, expanded to order $1/m^2$, yields a spin-orbit term given by:\n$$\n\\hat{H}_{\\mathrm{so}} = \\frac{1}{4(m+S)^2} \\Big[\\vec{\\nabla}V_{q}^{0} \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma} - \\frac{1}{4(m+S)^2} \\Big[\\vec{\\nabla}S \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n$$\nThe problem specifies that we work to leading order in $|S|/m$ and replace the effective mass $m^\\ast = m+S$ with the bare mass $m$ in denominators. Applying this approximation, we get:\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} \\approx \\frac{1}{4m^2} \\Big[\\vec{\\nabla}V_{q}^{0} \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma} - \\frac{1}{4m^2} \\Big[\\vec{\\nabla}S \\times \\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n$$\nCombining the terms, we arrive at the form requested in the problem statement:\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\frac{1}{4m^{2}}\\Big[\\nabla\\big(V^{0}_{q}-S\\big)\\times\\hat{\\mathbf{p}}\\Big]\\cdot\\boldsymbol{\\sigma}\n$$\nThis completes the demonstration required in part 1).\n\nPart 2 & 3: Comparison with Skyrme EDF and determination of couplings.\n\nTo compare this result with the Skyrme parameterization, we first express the fields $V_q^0$ and $S$ in terms of the baryon and isovector densities. The problem states to use the approximation $\\rho_{S} \\approx \\rho$ at the considered order. This approximation is justified as the leading non-relativistic reduction gives $\\rho_S = \\rho - O(p^2/m^2)$.\nWith this, the scalar field is $S \\approx \\alpha_S \\rho$. The gradient of the spin-orbit potential becomes:\n$$\n\\nabla(V_q^0 - S) \\approx \\nabla(\\alpha_V \\rho + \\alpha_{TV} t_q \\rho_1 - \\alpha_S \\rho) = (\\alpha_V - \\alpha_S)\\nabla\\rho + \\alpha_{TV} t_q \\nabla\\rho_1\n$$\nSubstituting this into our expression for the spin-orbit Hamiltonian gives:\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\frac{1}{4m^2} \\Big[ \\big( (\\alpha_V - \\alpha_S)\\nabla\\rho + \\alpha_{TV}t_q\\nabla\\rho_1 \\big) \\times \\hat{\\mathbf{p}} \\Big]\\cdot\\boldsymbol{\\sigma}\n$$\nThis can be rearranged to highlight the coefficients of the density gradients:\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\left[ \\frac{\\alpha_V - \\alpha_S}{4m^2}\\nabla\\rho + t_q \\frac{\\alpha_{TV}}{4m^2}\\nabla\\rho_1 \\right] \\times \\hat{\\mathbf{p}} \\cdot \\boldsymbol{\\sigma}\n$$\nNow, we compare this with the single-particle spin-orbit operator from a generic Skyrme EDF, given in part 2) of the problem:\n$$\n\\hat{H}_{\\mathrm{so}}^{(q)} = \\Big[C_{0}^{\\nabla J}\\,\\nabla\\rho \\;+\\; t_{q}\\,C_{1}^{\\nabla J}\\,\\nabla\\rho_{1}\\Big]\\times\\hat{\\mathbf{p}}\\cdot\\boldsymbol{\\sigma}\n$$\nBy equating the coefficients of the corresponding terms ($\\nabla\\rho$ and $t_q\\nabla\\rho_1$), we find the mapping for the Skyrme spin-orbit coupling constants:\n$$\nC_{0}^{\\nabla J} = \\frac{\\alpha_V - \\alpha_S}{4m^2} \\qquad \\text{and} \\qquad C_{1}^{\\nabla J} = \\frac{\\alpha_{TV}}{4m^2}\n$$\nNext, we must determine the Skyrme tensor couplings $C_0^J$ and $C_1^J$, which are coefficients of the spin-current terms $\\mathcal{E}_T = \\sum_{t=0,1} C_t^J \\mathbf{J}_t^2$ in the energy density. These terms depend on the spin-current density $\\mathbf{J}_q$.\nSuch terms in a non-relativistic framework typically arise from interactions involving spin operators. In the relativistic framework, we must examine the provided Lagrangian in the Hartree approximation. The interaction terms contain four-fermion vertices of the scalar-scalar and vector-vector type. The vector part is $\\big(\\bar{\\psi}\\gamma_{\\mu}\\psi\\big)\\big(\\bar{\\psi}\\gamma^{\\mu}\\psi\\big) = (\\bar{\\psi}\\gamma_0\\psi)^2 - (\\bar{\\psi}\\vec{\\gamma}\\psi)^2$.\nIn the Hartree mean-field theory for a static, time-reversal invariant system, one replaces operators with their expectation values. The expectation value of the baryon density $\\rho = \\langle\\bar{\\psi}\\gamma_0\\psi\\rangle$ is non-zero, but the expectation value of the spatial vector current (baryon current) $\\vec{j} = \\langle\\bar{\\psi}\\vec{\\gamma}\\psi\\rangle$ is zero. The same reasoning applies to the isovector currents.\nConsequently, the terms in the interaction Lagrangian involving spatial vector currents, such as $(\\bar{\\psi}\\vec{\\gamma}\\psi)^2$ and $(\\bar{\\psi}\\vec{\\gamma}\\vec{\\tau}\\psi)^2$, do not contribute to the energy density at the Hartree level. The spin-current density $\\mathbf{J}$ is related to the non-relativistic limit of the spatial part of the relativistic pseudovector current, but the provided Lagrangian does not contain fundamental pseudovector or tensor couplings. The spin-orbit interaction derived above arises purely from the relativistic kinematics of a Dirac particle in scalar and vector potentials, not from an explicit spin-dependent interaction vertex.\nSince the specified covariant model at the Hartree level does not generate any terms in the energy density that are quadratic in the spin-current density $\\mathbf{J}$, the corresponding Skyrme couplings must be zero.\nTherefore, we conclude:\n$$\nC_{0}^{J} = 0 \\qquad \\text{and} \\qquad C_{1}^{J} = 0\n$$\nCombining all four results, we can write the final answer as the requested $1 \\times 4$ row matrix.\n$$\n\\big(C_{0}^{\\nabla J}\\;\\; C_{1}^{\\nabla J}\\;\\; C_{0}^{J}\\;\\; C_{1}^{J}\\big) = \\left(\\frac{\\alpha_V - \\alpha_S}{4m^2} \\;\\; \\frac{\\alpha_{TV}}{4m^2} \\;\\; 0 \\;\\; 0\\right)\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\alpha_{V} - \\alpha_{S}}{4m^{2}} & \\frac{\\alpha_{TV}}{4m^{2}} & 0 & 0 \\end{pmatrix}}\n$$", "id": "3554423"}, {"introduction": "Beyond the mean field, pairing correlations are essential for accurately describing open-shell nuclei, but simple models often introduce a problematic dependence on unphysical parameters like an energy cutoff. This computational exercise tackles this challenge head-on by demonstrating how observables can vary with the cutoff and then implementing a renormalization procedure to remove this dependency. By ensuring that physical quantities like two-neutron separation energies and nuclear radii remain stable, you will practice a crucial technique for building predictive and robust nuclear models [@problem_id:3554465].", "problem": "Consider a simplified, spherically symmetric covariant energy density functional description of an even-even nucleus in which pairing correlations are treated by the Bardeen–Cooper–Schrieffer (BCS) method with a zero-range interaction regulated by an energy cutoff. The single-particle spectrum is taken as a fixed set of discrete levels with energies $\\epsilon_k$, shell degeneracies $g_k$, and level-specific squared radii $r_k^2$, all independent of the pairing cutoff. Pairing acts only within an energy window of width $2\\Lambda$ around the chemical potential, and the running pairing strength $G(\\Lambda)$ may depend on $\\Lambda$. The occupation probabilities for level $k$ are $v_k^2$, and the quasiparticle energies are $E_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}$, where $\\mu$ is the chemical potential and $\\Delta$ is the pairing gap. The BCS number equation is\n$$\nN \\;=\\; \\sum_{k} g_k \\, v_k^2, \\quad v_k^2 \\;=\\; \\frac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right),\n$$\nand the BCS gap equation with a sharp energy cutoff is\n$$\n\\frac{1}{G(\\Lambda)} \\;=\\; \\sum_{k: \\, |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2\\,E_k}.\n$$\nWe consider the two-neutron separation energy $S_{2n}$ in the mean-field approximation as twice the chemical potential,\n$$\nS_{2n} \\;\\approx\\; 2\\,\\mu,\n$$\nand the matter root-mean-square radius defined from the occupancies,\n$$\n\\langle r^2 \\rangle \\;=\\; \\frac{\\sum_k g_k \\, v_k^2 \\, r_k^2}{N}, \\qquad r_{\\mathrm{rms}} \\;=\\; \\sqrt{\\langle r^2 \\rangle}.\n$$\n\nYour task is to study the sensitivity of dripline predictions, quantified by $S_{2n}$, and radii to the pairing cutoff $\\Lambda$, and to implement a renormalization scheme that keeps $S_{2n}$ and $r_{\\mathrm{rms}}$ invariant as $\\Lambda$ varies. The renormalization scheme must enforce a fixed target gap $\\Delta_0$ by appropriately running $G(\\Lambda)$, while $\\mu$ is determined by the number equation. In contrast, the unrenormalized scheme keeps $G$ fixed to a reference value determined at a specified reference cutoff.\n\nUse the following discrete spectrum and parameters, which are common to all test cases:\n- Levels indexed by $k=0,1,\\dots,49$ with energies in $\\mathrm{MeV}$ given by $\\epsilon_k = -25 + k$.\n- Degeneracies $g_k = 2$ for all $k$.\n- Squared radii in $\\mathrm{fm}^2$ given by $r_k^2 = 9.0 + 0.04\\,(\\epsilon_k + 25)$.\n\nDefine the following algorithms and observables:\n- Renormalized scheme for a given nucleus $(N)$ and cutoff $\\Lambda$:\n  1. Impose the fixed target gap $\\Delta = \\Delta_0$ (in $\\mathrm{MeV}$).\n  2. Determine $\\mu$ from the BCS number equation at this $\\Delta$.\n  3. Compute $G(\\Lambda)$ from the gap equation at this $\\mu$ and $\\Delta$.\n  4. Compute $S_{2n} = 2\\mu$ (in $\\mathrm{MeV}$) and $r_{\\mathrm{rms}}$ (in $\\mathrm{fm}$).\n- Unrenormalized scheme for a given nucleus $(N)$ and cutoff $\\Lambda$:\n  1. Fix $G$ to a reference value $G_{\\mathrm{ref}}$ obtained for the reference nucleus $N_{\\mathrm{ref}}$ at the reference cutoff $\\Lambda_{\\mathrm{ref}}$ when enforcing $\\Delta = \\Delta_0$.\n  2. For the target nucleus $(N)$ and chosen $\\Lambda$, solve simultaneously the BCS number equation and gap equation for $(\\mu, \\Delta)$.\n  3. Compute $S_{2n} = 2\\mu$ and $r_{\\mathrm{rms}}$.\n\nUse the following numerical values:\n- Target gap $\\Delta_0 = 1.2$ $\\mathrm{MeV}$.\n- Reference cutoff $\\Lambda_{\\mathrm{ref}} = 20$ $\\mathrm{MeV}$.\n- Reference nucleus $N_{\\mathrm{ref}} = 52$.\n- Cutoff set $\\Lambda \\in \\{5, 10, 20\\}$ $\\mathrm{MeV}$.\n\nTest suite nuclei defined by neutron numbers:\n- Case A: $N = 44$ (intermediate, \"happy path\").\n- Case B: $N = 52$ (reference nucleus, consistency check).\n- Case C: $N = 60$ (near edge, larger occupation, more sensitive).\n\nFor each test case nucleus and each cutoff in the set, compute both the renormalized and unrenormalized observables. For each scheme, compute the maximum absolute deviation across the cutoff set relative to the reference-cutoff values at $\\Lambda_{\\mathrm{ref}}$ for that nucleus:\n- $\\max_{\\Lambda \\in \\{5,10,20\\}} |S_{2n}(\\Lambda) - S_{2n}(\\Lambda_{\\mathrm{ref}})|$ in $\\mathrm{MeV}$.\n- $\\max_{\\Lambda \\in \\{5,10,20\\}} |r_{\\mathrm{rms}}(\\Lambda) - r_{\\mathrm{rms}}(\\Lambda_{\\mathrm{ref}})|$ in $\\mathrm{fm}$.\n\nYour program must produce a single line of output containing twelve floating point numbers in a comma-separated list enclosed in square brackets, in the following order:\n- Renormalized scheme deviations for Case A: $[dS_{2n}^{\\mathrm{ren}}(A), d r_{\\mathrm{rms}}^{\\mathrm{ren}}(A)]$,\n- Renormalized scheme deviations for Case B: $[dS_{2n}^{\\mathrm{ren}}(B), d r_{\\mathrm{rms}}^{\\mathrm{ren}}(B)]$,\n- Renormalized scheme deviations for Case C: $[dS_{2n}^{\\mathrm{ren}}(C), d r_{\\mathrm{rms}}^{\\mathrm{ren}}(C)]$,\n- Unrenormalized scheme deviations for Case A: $[dS_{2n}^{\\mathrm{unren}}(A), d r_{\\mathrm{rms}}^{\\mathrm{unren}}(A)]$,\n- Unrenormalized scheme deviations for Case B: $[dS_{2n}^{\\mathrm{unren}}(B), d r_{\\mathrm{rms}}^{\\mathrm{unren}}(B)]$,\n- Unrenormalized scheme deviations for Case C: $[dS_{2n}^{\\mathrm{unren}}(C), d r_{\\mathrm{rms}}^{\\mathrm{unren}}(C)]$.\n\nAngle units do not apply. Energies must be treated in $\\mathrm{MeV}$ and radii in $\\mathrm{fm}$. The final output must strictly adhere to the specified single-line format. Design your code to robustly solve the nonlinear equations, ensuring numerical stability for the given test suite, and to handle boundary conditions where the gap equation may become stiff at small cutoffs. No external input is allowed; all data must be defined within the program.", "solution": "The user has provided a problem in computational nuclear physics concerning the Bardeen–Cooper–Schrieffer (BCS) model of pairing correlations. The problem is validated against the required criteria.\n\n### Step 1: Extract Givens\n- **Model Framework**: Spherically symmetric covariant energy density functional for an even-even nucleus. Pairing is treated via the BCS method with a zero-range interaction and a sharp energy cutoff $\\Lambda$.\n- **Single-Particle Spectrum**: A fixed, discrete set of levels indexed by $k \\in \\{0, 1, \\dots, 49\\}$.\n    - Energies: $\\epsilon_k = -25 + k$ in $\\mathrm{MeV}$.\n    - Degeneracies: $g_k = 2$ for all $k$.\n    - Squared radii: $r_k^2 = 9.0 + 0.04(\\epsilon_k + 25)$ in $\\mathrm{fm}^2$.\n- **BCS Equations**:\n    - Quasiparticle energy: $E_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}$.\n    - Occupation probability: $v_k^2 = \\frac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right)$.\n    - Number equation: $N = \\sum_{k} g_k v_k^2$.\n    - Gap equation: $\\frac{1}{G(\\Lambda)} = \\sum_{k: |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2 E_k}$.\n- **Observables**:\n    - Two-neutron separation energy: $S_{2n} = 2\\mu$.\n    - RMS radius: $r_{\\mathrm{rms}} = \\sqrt{\\langle r^2 \\rangle}$, with $\\langle r^2 \\rangle = \\frac{\\sum_k g_k v_k^2 r_k^2}{N}$.\n- **Schemes**:\n    - **Renormalized**: For a given nucleus ($N$) and cutoff ($\\Lambda$):\n        1. Fix the pairing gap at a target value $\\Delta = \\Delta_0$.\n        2. Determine the chemical potential $\\mu$ from the number equation.\n        3. The pairing strength $G(\\Lambda)$ is then implicitly defined by the gap equation but not used to determine observables.\n        4. Compute $S_{2n}$ and $r_{\\mathrm{rms}}$.\n    - **Unrenormalized**: For a given nucleus ($N$) and cutoff ($\\Lambda$):\n        1. Fix the pairing strength to a reference value $G_{\\mathrm{ref}}$.\n        2. $G_{\\mathrm{ref}}$ is determined for a reference nucleus $N_{\\mathrm{ref}}$ at a reference cutoff $\\Lambda_{\\mathrm{ref}}$ by enforcing $\\Delta = \\Delta_0$.\n        3. Solve the coupled number and gap equations simultaneously for $(\\mu, \\Delta)$.\n        4. Compute $S_{2n}$ and $r_{\\mathrm{rms}}$.\n- **Numerical Parameters**:\n    - Target gap: $\\Delta_0 = 1.2$ MeV.\n    - Reference cutoff: $\\Lambda_{\\mathrm{ref}} = 20$ MeV.\n    - Reference nucleus: $N_{\\mathrm{ref}} = 52$.\n    - Set of cutoffs for analysis: $\\Lambda \\in \\{5, 10, 20\\}$ MeV.\n- **Test Cases**: Nuclei with neutron numbers $N \\in \\{44, 52, 60\\}$.\n- **Task**: For each scheme and each test case nucleus, compute the maximum absolute deviation of $S_{2n}$ and $r_{\\mathrm{rms}}$ across the set of cutoffs, relative to the values obtained at the reference cutoff $\\Lambda_{\\mathrm{ref}}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a standard, albeit simplified, application of BCS theory in nuclear structure physics. The concepts of pairing, cutoffs, and renormalization are central to the field. The model is well-founded in established principles.\n2.  **Well-Posed**: The problem is mathematically well-defined. The BCS number equation $N(\\mu) = \\sum_k g_k v_k^2$ defines a monotonically increasing function of $\\mu$, ensuring a unique solution for $\\mu$ when other parameters are fixed. The coupled system of equations for $(\\mu, \\Delta)$ is a standard nonlinear system in physics, for which numerical solutions can be reliably found. The problem is structured to yield a unique, meaningful solution.\n3.  **Objective**: All terms are defined with mathematical precision. The problem is free of subjective or ambiguous language.\n4.  **Scientific or Factual Unsoundness**: No violations are present. The use of $S_{2n} = 2\\mu$ is a specified convention within the problem's context, consistent with analyzing the dripline where $S_{2n}$ changes sign.\n5.  **Non-Formalizable or Irrelevant**: The problem is directly formalizable into a computational algorithm and is highly relevant to the specified physics domain.\n6.  **Incomplete or Contradictory Setup**: All necessary data and definitions are provided. The two schemes are clearly specified and do not contradict each other.\n7.  **Unrealistic or Infeasible**: The numerical parameters are plausible for a model of this type. The neutron numbers and energy levels are within a reasonable physical range for studying medium-mass nuclei.\n8.  **Ill-Posed or Poorly Structured**: The problem is well-structured and does not exhibit any features of an ill-posed problem, such as circular reasoning or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A computational solution will be developed.\n\n### Solution\n\nThe objective is to implement and compare two different treatments of the pairing cutoff $\\Lambda$ in a BCS model: a renormalized scheme designed to yield stable observables, and an unrenormalized scheme where observables depend on the cutoff.\n\n**Model Specification**\nThe single-particle basis consists of $50$ levels, indexed by $k=0, \\dots, 49$. The energy of level $k$ is $\\epsilon_k = -25 + k$ MeV, with degeneracy $g_k = 2$. The associated squared radius is $r_k^2 = 9.0 + 0.04k$ fm$^2$.\nThe core of the model lies in the BCS equations for the number of particles $N$ and the pairing gap $\\Delta$:\n$$ N = \\sum_{k=0}^{49} g_k \\cdot \\frac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{\\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}}\\right) $$\n$$ \\frac{1}{G(\\Lambda)} = \\sum_{k: |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2 \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}} $$\nThe observables, two-neutron separation energy $S_{2n}$ and root-mean-square radius $r_{\\mathrm{rms}}$, are calculated from the resulting chemical potential $\\mu$ and occupation probabilities $v_k^2$.\n\n**Computational Strategy: Renormalized Scheme**\nThis scheme is designed to make the primary observables independent of the cutoff $\\Lambda$.\n1.  For a given nucleus with particle number $N$, the pairing gap is fixed to the target value $\\Delta = \\Delta_0 = 1.2$ MeV.\n2.  The chemical potential $\\mu$ is determined by solving the number equation, which we can write as a root-finding problem $f(\\mu) = 0$, where\n    $$ f(\\mu) = \\left( \\sum_{k=0}^{49} g_k v_k^2(\\mu, \\Delta_0) \\right) - N $$\n    This equation is independent of the cutoff $\\Lambda$. Consequently, for a given $N$, the solution for $\\mu$ is also independent of $\\Lambda$. This one-dimensional nonlinear equation is solved using the robust Brent's method.\n3.  Since $\\mu$ and $\\Delta$ are constant across the set of cutoffs $\\{\\Lambda\\}$, the occupation probabilities $v_k^2$ are also constant.\n4.  As a direct result, the observables $S_{2n} = 2\\mu$ and $r_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_k g_k v_k^2 r_k^2}$ are invariant with respect to $\\Lambda$.\n5.  The maximum absolute deviations for both observables are therefore expected to be zero (within machine precision). The only quantity that \"runs\" with $\\Lambda$ is the pairing strength $G(\\Lambda)$, which adapts to maintain the fixed $\\Delta_0$.\n\n**Computational Strategy: Unrenormalized Scheme**\nIn this scheme, the pairing strength is held constant, and the physical parameters $(\\mu, \\Delta)$ adjust with the cutoff $\\Lambda$.\n\n1.  **Reference Pairing Strength Calculation**: The constant pairing strength $G_{\\mathrm{ref}}$ is calculated once. We use the reference nucleus $N_{\\mathrm{ref}} = 52$ and the reference cutoff $\\Lambda_{\\mathrm{ref}} = 20$ MeV.\n    a. We first fix $\\Delta = \\Delta_0 = 1.2$ MeV and solve the number equation for $N_{\\mathrm{ref}}$ to find the corresponding chemical potential, $\\mu_{\\mathrm{ref}}$.\n    b. With $\\mu_{\\mathrm{ref}}$ and $\\Delta_0$, we evaluate the right-hand side of the gap equation at $\\Lambda_{\\mathrm{ref}}$ to find $1/G_{\\mathrm{ref}}$.\n    $$ \\frac{1}{G_{\\mathrm{ref}}} = \\sum_{k: |\\epsilon_k - \\mu_{\\mathrm{ref}}| \\le \\Lambda_{\\mathrm{ref}}} \\frac{g_k}{2 \\sqrt{(\\epsilon_k - \\mu_{\\mathrm{ref}})^2 + \\Delta_0^2}} $$\n\n2.  **Coupled Equations Solution**: For each test nucleus $(N)$ and each cutoff $(\\Lambda)$, we fix $G = G_{\\mathrm{ref}}$ and solve the following system of two coupled nonlinear equations for the two unknowns $(\\mu, \\Delta)$:\n    $$\n    \\begin{cases}\n    \\sum_k g_k v_k^2(\\mu, \\Delta) - N = 0 \\\\\n    \\left( \\sum_{k: |\\epsilon_k - \\mu| \\le \\Lambda} \\frac{g_k}{2 E_k(\\mu, \\Delta)} \\right) - \\frac{1}{G_{\\mathrm{ref}}} = 0\n    \\end{cases}\n    $$\n    This $2 \\times 2$ system is solved numerically using a multi-dimensional root-finder based on the Levenberg-Marquardt algorithm. A robust initial guess is supplied by first solving the (simpler) renormalized problem for the given $N$ to find an approximate $\\mu$, using that with $\\Delta_0$ as the starting point $(\\mu_{\\mathrm{guess}}, \\Delta_0)$.\n3.  Because the gap equation explicitly depends on $\\Lambda$ through the summation range, the solution pair $(\\mu, \\Delta)$ will vary with $\\Lambda$. This leads to a cutoff-dependence in the observables $S_{2n}$ and $r_{\\mathrm{rms}}$.\n\n**Deviation Analysis**\nFor each scheme and each nucleus, we compute the observables for each $\\Lambda \\in \\{5, 10, 20\\}$ MeV. We identify the results at $\\Lambda_{\\mathrm{ref}} = 20$ MeV as the reference values for that nucleus. The final reported quantities are the maximum absolute differences between the values at $\\Lambda \\in \\{5, 10\\}$ MeV and the reference value at $\\Lambda = 20$ MeV:\n$$ dS_{2n} = \\max_{\\Lambda \\in \\{5, 10, 20\\}} | S_{2n}(\\Lambda) - S_{2n}(\\Lambda_{\\mathrm{ref}}) | $$\n$$ dr_{\\mathrm{rms}} = \\max_{\\Lambda \\in \\{5, 10, 20\\}} | r_{\\mathrm{rms}}(\\Lambda) - r_{\\mathrm{rms}}(\\Lambda_{\\mathrm{ref}}) | $$\nThis analysis quantifies the stability of the observables against variations in the unphysical cutoff parameter $\\Lambda$. As predicted, the renormalized scheme yields zero deviation, demonstrating its success in removing this spurious dependence. The unrenormalized scheme, by contrast, exhibits non-zero deviations, highlighting its theoretical deficiency.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq, root\n\ndef solve():\n    \"\"\"\n    Solves the nuclear BCS problem to compare renormalized and unrenormalized schemes.\n    \"\"\"\n    \n    # --- Problem Constants and Setup ---\n    DELTA_0 = 1.2  # MeV\n    LAMBDA_REF = 20.0  # MeV\n    N_REF = 52\n    \n    # Single-particle spectrum\n    K_VALUES = np.arange(50)\n    EPSILON = -25.0 + K_VALUES  # MeV\n    G_DEGEN = 2.0 * np.ones_like(EPSILON)\n    R_SQ = 9.0 + 0.04 * K_VALUES  # fm^2\n    \n    # Analysis parameters\n    CUTOFFS = np.array([5.0, 10.0, 20.0])\n    CASES = {'A': 44, 'B': 52, 'C': 60}\n    CASE_ORDER = ['A', 'B', 'C']\n\n    # --- Core Physics Functions ---\n\n    def get_v_sq_and_E(mu, delta, eps):\n        \"\"\"Calculates occupation probabilities v_k^2 and quasiparticle energies E_k.\"\"\"\n        # Add a small epsilon to denominator to prevent division by zero if delta=0\n        # although delta > 0 is expected for physical solutions.\n        E = np.sqrt((eps - mu)**2 + delta**2 + 1e-30)\n        v_sq = 0.5 * (1.0 - (eps - mu) / E)\n        return v_sq, E\n\n    def calculate_observables(mu, delta, N, eps, g, r_sq):\n        \"\"\"Calculates S_2n and r_rms from mu, delta, and N.\"\"\"\n        v_sq, _ = get_v_sq_and_E(mu, delta, eps)\n        s_2n = 2.0 * mu\n        r_sq_mean = np.sum(g * v_sq * r_sq) / N\n        r_rms = np.sqrt(r_sq_mean)\n        return s_2n, r_rms\n\n    # --- Renormalized Scheme ---\n\n    ren_deviations = {}\n    for case_name in CASE_ORDER:\n        N = CASES[case_name]\n        \n        # In the renormalized scheme, mu is found for a fixed Delta_0.\n        # The number equation is independent of Lambda.\n        def number_eq_residual(mu):\n            v_sq, _ = get_v_sq_and_E(mu, DELTA_0, EPSILON)\n            return np.sum(G_DEGEN * v_sq) - N\n            \n        # Find mu. The search interval is robust for the given N values.\n        mu_ren = brentq(number_eq_residual, -30.0, 30.0)\n        \n        # Since mu and delta are constant, observables are constant.\n        s_2n_ren, r_rms_ren = calculate_observables(mu_ren, DELTA_0, N, EPSILON, G_DEGEN, R_SQ)\n        \n        # Deviations are zero by construction.\n        ren_deviations[case_name] = (0.0, 0.0)\n\n    # --- Unrenormalized Scheme ---\n\n    # 1. Calculate G_ref\n    def number_eq_residual_ref(mu):\n        v_sq, _ = get_v_sq_and_E(mu, DELTA_0, EPSILON)\n        return np.sum(G_DEGEN * v_sq) - N_REF\n    \n    mu_ref_for_g = brentq(number_eq_residual_ref, -30.0, 30.0)\n    \n    _, E_ref_for_g = get_v_sq_and_E(mu_ref_for_g, DELTA_0, EPSILON)\n    pairing_window_mask = np.abs(EPSILON - mu_ref_for_g) <= LAMBDA_REF\n    \n    inv_g_ref = np.sum((G_DEGEN / (2.0 * E_ref_for_g))[pairing_window_mask])\n\n    # 2. Solve for each case and cutoff\n    unren_results = {}\n    unren_deviations = {}\n\n    for case_name in CASE_ORDER:\n        N = CASES[case_name]\n        unren_results[case_name] = {}\n        \n        # Robust initial guess using the mu from renormalized scheme for this N\n        mu_guess = brentq(lambda mu: np.sum(G_DEGEN * get_v_sq_and_E(mu, DELTA_0, EPSILON)[0]) - N, -30, 30)\n\n        for Lambda in CUTOFFS:\n            def system_equations(x):\n                mu, delta = x[0], x[1]\n                \n                if delta <= 0: # Enforce physical gap\n                    return [1e6, 1e6]\n                \n                v_sq, E = get_v_sq_and_E(mu, delta, EPSILON)\n                \n                # Equation 1: Number conservation\n                res1 = np.sum(G_DEGEN * v_sq) - N\n                \n                # Equation 2: Gap equation\n                window_mask = np.abs(EPSILON - mu) <= Lambda\n                res2 = np.sum((G_DEGEN / (2.0 * E))[window_mask]) - inv_g_ref\n                \n                return [res1, res2]\n\n            # Solve the 2D system\n            sol = root(system_equations, [mu_guess, DELTA_0], method='lm')\n            mu_unren, delta_unren = sol.x\n            \n            s_2n_unren, r_rms_unren = calculate_observables(\n                mu_unren, delta_unren, N, EPSILON, G_DEGEN, R_SQ)\n            \n            unren_results[case_name][Lambda] = (s_2n_unren, r_rms_unren)\n\n        # 3. Calculate deviations for unrenormalized scheme\n        s2n_ref_val = unren_results[case_name][LAMBDA_REF][0]\n        r_rms_ref_val = unren_results[case_name][LAMBDA_REF][1]\n        \n        max_ds2n = 0.0\n        max_dr_rms = 0.0\n        \n        for Lambda in CUTOFFS:\n            s2n_val, r_rms_val = unren_results[case_name][Lambda]\n            max_ds2n = max(max_ds2n, abs(s2n_val - s2n_ref_val))\n            max_dr_rms = max(max_dr_rms, abs(r_rms_val - r_rms_ref_val))\n        \n        unren_deviations[case_name] = (max_ds2n, max_dr_rms)\n\n    # --- Format and Print Final Output ---\n    final_output = []\n    for case_name in CASE_ORDER:\n        final_output.extend(ren_deviations[case_name])\n    for case_name in CASE_ORDER:\n        final_output.extend(unren_deviations[case_name])\n\n    # The final print statement must produce only the specified single-line format.\n    print(f\"[{','.join(f'{x:.8f}' for x in final_output)}]\")\n\nsolve()\n```", "id": "3554465"}]}