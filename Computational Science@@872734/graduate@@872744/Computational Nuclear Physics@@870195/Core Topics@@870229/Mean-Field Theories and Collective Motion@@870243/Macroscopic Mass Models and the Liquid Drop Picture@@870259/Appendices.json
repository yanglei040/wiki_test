{"hands_on_practices": [{"introduction": "Before diving into complex computational fitting, it is essential to develop an intuition for the relative scales of the different contributions to nuclear binding energy. This exercise provides a direct, hands-on calculation that contrasts the magnitude of the pairing energy, a subtle quantum-mechanical correction, with the dominant macroscopic surface and Coulomb terms. By working through this comparison [@problem_id:3568545], you will gain a tangible sense of the energy hierarchy within the liquid drop model and appreciate why certain terms, though small, are crucial for explaining specific nuclear phenomena.", "problem": "A central element of macroscopic mass models based on the liquid drop picture is the semi-empirical mass formula, which decomposes the nuclear binding energy into bulk, surface, Coulomb, asymmetry, and pairing contributions. One manifestation of pairing correlations is the odd-even staggering of nuclear binding energies. For mid-shell nuclei, the empirical neutron or proton pairing gap is often characterized by a baseline scaling $\\Delta \\approx 12/\\sqrt{A}$ MeV, consistent with a broad range of data. In the liquid drop parameterization, the pairing contribution is conventionally written as $\\delta(A,Z) = \\pm a_p A^{-1/2}$, where $a_p$ is a constant pairing coefficient, with the $+$ sign for even-even nuclei, $0$ for odd-$A$, and $-$ for odd-odd nuclei. \n\nStarting from the above baseline and the liquid drop picture, use the odd-even mass staggering concept to estimate the pairing coefficient $a_p$ in the pairing term $\\delta(A,Z)$. Then, for a representative mid-shell nucleus with $A=120$ and $Z=50$, quantify how the typical even-even pairing energy scale compares to the surface and Coulomb contributions by computing the following dimensionless ratio:\n$$\nR \\equiv \\frac{|\\delta_{\\text{even-even}}|}{a_s A^{2/3} + a_c \\frac{Z(Z-1)}{A^{1/3}}}\\,,\n$$\nwhere $a_s$ and $a_c$ are the surface and Coulomb coefficients, respectively. Use the representative values $a_s = 17.23$ MeV and $a_c = 0.714$ MeV for this estimate. \n\nAssume the mass-number dependence of $A^{\\pm 1/3}$ is sufficiently smooth that $A$ can be treated as constant across the odd-even staggering used to connect $\\Delta$ with $a_p$. Express your final answer as the numerical value of $R$, rounded to four significant figures. The final answer must be dimensionless (no units).", "solution": "The problem is subjected to validation before proceeding.\n\n### Step 1: Extract Givens\n- **Model:** Macroscopic mass models, liquid drop picture, semi-empirical mass formula.\n- **Pairing Gap Baseline:** $\\Delta \\approx 12/\\sqrt{A}$ in megaelectronvolts (MeV).\n- **Pairing Term Formula:** $\\delta(A,Z) = \\pm a_p A^{-1/2}$, where the sign is $+$ for even-even, $0$ for odd-$A$, and $-$ for odd-odd nuclei.\n- **Coefficient `a_p`:** A constant pairing coefficient to be estimated.\n- **Target Nucleus:** A mid-shell nucleus with mass number $A=120$ and proton number $Z=50$.\n- **Ratio to Compute:** $R \\equiv \\frac{|\\delta_{\\text{even-even}}|}{a_s A^{2/3} + a_c \\frac{Z(Z-1)}{A^{1/3}}}$.\n- **Surface Coefficient:** $a_s = 17.23$ MeV.\n- **Coulomb Coefficient:** $a_c = 0.714$ MeV.\n- **Assumption:** The mass number $A$ can be treated as constant across the odd-even staggering used to connect $\\Delta$ with $a_p$.\n- **Final Answer requirement:** Numerical value of $R$, rounded to four significant figures, presented as a dimensionless quantity.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in the principles of nuclear physics, specifically the liquid drop model and the semi-empirical mass formula (SEMF). The provided formulas and constants are standard representations used in this field. It is free of pseudoscience.\n- **Well-Posed:** The problem is well-posed. It requests the estimation of a parameter, $a_p$, based on a given empirical relation and then uses this parameter to calculate a well-defined dimensionless ratio for a specific nucleus. All necessary information is provided.\n- **Objective:** The problem is phrased in objective, scientific language. The provided values are representative of those found in nuclear physics literature.\n- **Completeness and Consistency:** The problem is self-contained. The provided data for $A$, $Z$, $a_s$, and $a_c$ are consistent. The assumption to treat $A$ as constant is a standard simplification for this type of estimation.\n- **Realism:** The values for the coefficients and the description of the pairing phenomena are scientifically plausible and standard in the context of the SEMF.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a standard, well-posed problem in nuclear physics that can be solved using the provided information and established principles. A complete solution will be provided.\n\n### Solution\nThe solution proceeds in two parts: first, we estimate the pairing coefficient $a_p$, and second, we compute the ratio $R$.\n\n**Part 1: Estimation of the Pairing Coefficient $a_p$**\n\nThe semi-empirical mass formula includes a pairing term, $\\delta(A,Z)$, to account for the observed odd-even staggering in nuclear binding energies. This problem defines the pairing term as a contribution to the *binding energy*. This term reflects the fact that nuclei with an even number of protons and/or neutrons are more tightly bound than those with odd numbers. The pairing energy, $\\delta(A,Z)$, is given as:\n$$\n\\delta(A,Z) =\n\\begin{cases}\n+a_p A^{-1/2}  \\text{for even-even nuclei} \\\\\n0  \\text{for odd-}A\\text{ nuclei} \\\\\n-a_p A^{-1/2}  \\text{for odd-odd nuclei}\n\\end{cases}\n$$\nThe empirical pairing gap, $\\Delta$, quantifies the magnitude of this staggering. It represents the energy gained by having a complete pair of nucleons (protons or neutrons) versus having an unpaired nucleon. The problem states that for mid-shell nuclei, this gap is empirically found to be $\\Delta \\approx 12 A^{-1/2}$ MeV.\n\nThe pairing term for an even-even nucleus, $\\delta_{\\text{even-even}} = +a_p A^{-1/2}$, represents precisely this extra binding energy gained due to the presence of both even protons and even neutrons, relative to the smooth average described by the other terms in the mass formula. Therefore, we can directly equate the magnitude of the pairing energy for an even-even system with the empirical pairing gap $\\Delta$.\n$$\n\\delta_{\\text{even-even}} = \\Delta\n$$\nSubstituting the given expressions:\n$$\na_p A^{-1/2} \\approx 12 A^{-1/2}\\text{ MeV}\n$$\nFrom this comparison, we can directly estimate the pairing coefficient $a_p$:\n$$\na_p = 12\\text{ MeV}\n$$\n\n**Part 2: Calculation of the Ratio $R$**\n\nWe are asked to compute the dimensionless ratio $R$ for a nucleus with mass number $A=120$ and proton number $Z=50$.\n$$\nR = \\frac{|\\delta_{\\text{even-even}}|}{a_s A^{2/3} + a_c \\frac{Z(Z-1)}{A^{1/3}}}\n$$\nThe nucleus has $Z=50$ (even) and the number of neutrons is $N = A - Z = 120 - 50 = 70$ (even). Thus, it is an even-even nucleus.\n\nFirst, we calculate the numerator, which is the magnitude of the pairing energy for this even-even nucleus.\n$$\n|\\delta_{\\text{even-even}}| = |+a_p A^{-1/2}| = a_p A^{-1/2}\n$$\nUsing our estimated $a_p = 12$ MeV and the given $A=120$:\n$$\n|\\delta_{\\text{even-even}}| = 12 \\times (120)^{-1/2} = \\frac{12}{\\sqrt{120}}\\text{ MeV} \\approx 1.095445\\text{ MeV}\n$$\n\nNext, we calculate the denominator, which is the sum of the surface energy ($E_s$) and the Coulomb energy ($E_c$).\nThe surface energy term is:\n$$\nE_s = a_s A^{2/3} = 17.23 \\times (120)^{2/3}\\text{ MeV}\n$$\n$$\nE_s \\approx 17.23 \\times 24.328703\\text{ MeV} \\approx 419.18453\\text{ MeV}\n$$\nThe Coulomb energy term is:\n$$\nE_c = a_c \\frac{Z(Z-1)}{A^{1/3}} = 0.714 \\times \\frac{50(50-1)}{(120)^{1/3}}\\text{ MeV}\n$$\n$$\nE_c = 0.714 \\times \\frac{50 \\times 49}{(120)^{1/3}}\\text{ MeV} = \\frac{0.714 \\times 2450}{(120)^{1/3}}\\text{ MeV}\n$$\n$$\nE_c \\approx \\frac{1749.3}{4.932424}\\text{ MeV} \\approx 354.65993\\text{ MeV}\n$$\nThe total energy in the denominator is:\n$$\n\\text{Denominator} = E_s + E_c \\approx 419.18453 + 354.65993\\text{ MeV} \\approx 773.84446\\text{ MeV}\n$$\n\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{1.095445}{773.84446} \\approx 0.00141558\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nR \\approx 0.001416\n$$\nThis result quantifies that for a typical mid-shell heavy nucleus, the pairing energy is a very small correction (about $0.14\\%$) compared to the dominant macroscopic liquid-drop terms like the surface and Coulomb energies.", "answer": "$$\\boxed{0.001416}$$", "id": "3568545"}, {"introduction": "Moving from analytical understanding to computational modeling is a critical step in modern physics. This practice guides you through translating the semi-empirical mass formula into a functional computer program, a core skill for any computational physicist. The exercise then uses this implementation to investigate a physical hypothesis: whether adding a Wigner term, proportional to $|N-Z|$, improves the description of light nuclei [@problem_id:3568504]. This task encapsulates the fundamental workflow of computational science: implementing a model, generating predictions, and evaluating its performance against data to test physical assumptions.", "problem": "You are asked to construct and evaluate a macroscopic nuclear mass model rooted in the liquid drop picture. For a nucleus characterized by proton number $Z$ and neutron number $N$, let the mass number be $A=Z+N$. The macroscopic (liquid-drop-like) binding energy $E_{\\text{macro}}(Z,N)$ is modeled as a sum of physically motivated contributions whose scaling follows well-tested facts: a volume term proportional to $A$, a surface term proportional to $A^{2/3}$, a Coulomb repulsion term proportional to $Z(Z-1)/A^{1/3}$, an asymmetry term proportional to $(N-Z)^2/A$, and a pairing term whose magnitude scales as $A^{-1/2}$ and whose sign depends on the parity of $Z$ and $N$. You will extend this macroscopic energy with a Wigner term $E_W=W|N-Z|$, where $W$ is a real-valued coefficient in megaelectronvolts (MeV). All energies in this problem must be expressed in megaelectronvolts (MeV).\n\nStarting from the above scaling laws and physical rationale, instantiate the coefficients with the following scientifically standard values in MeV:\n- Volume coefficient $a_v=15.75$\n- Surface coefficient $a_s=17.80$\n- Coulomb coefficient $a_c=0.711$\n- Asymmetry coefficient $a_a=23.00$\n- Pairing coefficient $a_p=11.00$\n\nUse the conventional pairing rule: define $\\delta$ by $\\delta=+a_p A^{-1/2}$ if both $Z$ and $N$ are even, $\\delta=-a_p A^{-1/2}$ if both $Z$ and $N$ are odd, and $\\delta=0$ otherwise. The macroscopic binding energy to be evaluated is\n$$\nE_{\\text{macro}}(Z,N;W) = a_v A - a_s A^{2/3} - a_c \\frac{Z(Z-1)}{A^{1/3}} - a_a \\frac{(N-Z)^2}{A} + \\delta + W|N-Z|.\n$$\n\nYour task is to test whether including the Wigner term improves the description of light nuclei without degrading the global fit quality. To do this, compute root-mean-square (RMS) deviations between theoretical and experimental binding energies for:\n- A light-nuclei subset defined by $A \\le 40$.\n- The full dataset defined below.\n\nDefine the Root-Mean-Square (RMS) deviation as\n$$\n\\text{RMS} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M}\\left(E_{\\text{macro}}(Z_i,N_i;W)-E_{\\text{exp},i}\\right)^2},\n$$\nwhere $M$ is the number of nuclei in the subset, and $E_{\\text{exp},i}$ is the experimental binding energy of nucleus $i$.\n\nUse the following test suite consisting of nuclei with their experimental binding energies $E_{\\text{exp}}$ in MeV. Each item is a triplet $(A,Z,E_{\\text{exp}})$; $N$ should be internally computed as $A-Z$:\n- $(3,1,8.482)$\n- $(3,2,7.718)$\n- $(4,2,28.296)$\n- $(12,6,92.162)$\n- $(16,8,127.620)$\n- $(20,10,160.647)$\n- $(24,12,198.257)$\n- $(40,20,342.052)$\n- $(56,26,492.253)$\n- $(58,28,506.459)$\n- $(90,40,783.894)$\n- $(120,50,1021.800)$\n- $(208,82,1636.430)$\n\nEvaluate the model for the following four Wigner-term coefficients $W$ (in MeV):\n- $W=0.0$\n- $W=1.0$\n- $W=2.0$\n- $W=3.0$\n\nFor each value of $W$, compute:\n- The light-subset RMS in MeV, using all nuclei with $A \\le 40$ from the dataset.\n- The global RMS in MeV, using all nuclei from the dataset.\n\nDefine the decision for each $W$ as a boolean that is true if and only if the light-subset RMS strictly decreases relative to the baseline $W=0.0$ case, and the global RMS does not increase (i.e., global RMS at this $W$ is less than or equal to the global RMS at $W=0.0$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Represent each test case result as a list of the form $[W,\\text{RMS}_{\\text{light}},\\text{RMS}_{\\text{global}},\\text{decision}]$, where $W$, $\\text{RMS}_{\\text{light}}$, and $\\text{RMS}_{\\text{global}}$ are floats in MeV rounded to six decimal places, and $\\text{decision}$ is a boolean. For example, the final output format must look like\n$$\n[[0.0, r_l^{(0)}, r_g^{(0)}, \\text{False}],[1.0, r_l^{(1)}, r_g^{(1)}, \\text{True}],\\dots]\n$$\nwith actual numeric values replacing $r_l^{(k)}$ and $r_g^{(k)}$ for each $W$ in the test suite.", "solution": "We begin from the liquid drop picture, which models the nucleus as a uniform, incompressible fluid of nucleons. The macroscopic binding energy is constructed by adding contributions that arise from fundamental physical effects, each with a characteristic scaling in the mass number $A=Z+N$ and proton number $Z$.\n\nThe volume term reflects the saturation of the nuclear force, yielding an energy that is proportional to the number of nucleons. This is modeled as $a_v A$, where $a_v$ captures the binding per nucleon in the bulk. The surface term arises because nucleons at the surface have fewer neighbors, reducing the binding; the surface area scales like $A^{2/3}$, giving $-a_s A^{2/3}$. The Coulomb term accounts for electrostatic repulsion among protons and, for spherical drops of approximately constant density, scales as $-a_c Z(Z-1)/A^{1/3}$. The asymmetry term penalizes deviations from equal neutron and proton numbers due to the Pauli principle and the isospin dependence of the nuclear force, modeled as $-a_a (N-Z)^2/A$. The pairing term $\\delta$ captures the empirically observed odd-even staggering; pairing enhances binding for even-even nuclei (both $Z$ and $N$ even), reduces binding for odd-odd nuclei (both odd), and vanishes otherwise. Its magnitude scales as $A^{-1/2}$, so we adopt $\\delta = +a_p A^{-1/2}$ for even-even, $\\delta = -a_p A^{-1/2}$ for odd-odd, and $\\delta = 0$ otherwise.\n\nThese scaling laws are widely accepted features of the semi-empirical mass formula, a cornerstone in macroscopic nuclear modeling. To probe isospin-dependent residual effects, a Wigner term is introduced: $E_W = W|N-Z|$, with $W$ in MeV. Physically, this term favors nuclei closer to $N=Z$ and is particularly relevant for light nuclei where isospin symmetry effects are strongest.\n\nPutting these together, the macroscopic binding energy is\n$$\nE_{\\text{macro}}(Z,N;W) = a_v A - a_s A^{2/3} - a_c \\frac{Z(Z-1)}{A^{1/3}} - a_a \\frac{(N-Z)^2}{A} + \\delta + W|N-Z|.\n$$\nWe instantiate the coefficients in MeV as $a_v=15.75$, $a_s=17.80$, $a_c=0.711$, $a_a=23.00$, and $a_p=11.00$.\n\nTo evaluate fit quality, we compute the Root-Mean-Square (RMS) deviation between theoretical and experimental binding energies:\n$$\n\\text{RMS}(W;\\mathcal{S}) = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M}\\left(E_{\\text{macro}}(Z_i,N_i;W)-E_{\\text{exp},i}\\right)^2},\n$$\nwhere $\\mathcal{S}$ is either the light-subset ($A \\le 40$) or the full dataset, and $M$ is the number of nuclei in the subset.\n\nAlgorithmic steps:\n1. Parse the dataset, computing $N_i=A_i-Z_i$ for each nucleus $i$, and store the experimental binding energies $E_{\\text{exp},i}$.\n2. Implement a function to compute $\\delta$ for given $(Z,N)$, using parity checks on $Z$ and $N$:\n   - If $Z$ and $N$ are both even, $\\delta=+a_p A^{-1/2}$.\n   - If $Z$ and $N$ are both odd, $\\delta=-a_p A^{-1/2}$.\n   - Else, $\\delta=0$.\n3. Implement $E_{\\text{macro}}(Z,N;W)$ using the formula above.\n4. For each $W$ in the test suite $\\{0.0,1.0,2.0,3.0\\}$, compute:\n   - $\\text{RMS}_{\\text{light}}(W)$ over the subset with $A\\le 40$.\n   - $\\text{RMS}_{\\text{global}}(W)$ over all nuclei in the dataset.\n5. Determine the decision boolean for each $W$:\n   - Compute the baseline RMS values at $W=0.0$, namely $\\text{RMS}_{\\text{light}}(0.0)$ and $\\text{RMS}_{\\text{global}}(0.0)$.\n   - For each $W$, set decision to true if $\\text{RMS}_{\\text{light}}(W)  \\text{RMS}_{\\text{light}}(0.0)$ and $\\text{RMS}_{\\text{global}}(W) \\le \\text{RMS}_{\\text{global}}(0.0)$; otherwise set false.\n6. Format each case’s results as $[W,\\text{RMS}_{\\text{light}},\\text{RMS}_{\\text{global}},\\text{decision}]$, rounding the RMS values to six decimal places, and aggregate into a single list. Print the final list on one line as specified.\n\nThis design integrates the physics of macroscopic nuclear binding with a quantitative test of the Wigner term’s utility. The use of RMS aligns with standard statistical measures in model assessment. The chosen dataset covers very light, medium, and heavy nuclei, providing sensitivity to the Wigner term for $N\\approx Z$ in light nuclei while ensuring that global performance is monitored. The edge case $W=0.0$ serves as the baseline without the Wigner term, and larger $W$ probe the effect strength.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef pairing_delta(A: int, Z: int, N: int, a_p: float) - float:\n    \"\"\"\n    Compute pairing term delta for given A, Z, N.\n    + a_p / sqrt(A) for even-even\n    - a_p / sqrt(A) for odd-odd\n    0 otherwise\n    \"\"\"\n    even_Z = (Z % 2 == 0)\n    even_N = (N % 2 == 0)\n    if even_Z and even_N:\n        return a_p / np.sqrt(A)\n    elif (not even_Z) and (not even_N):\n        return -a_p / np.sqrt(A)\n    else:\n        return 0.0\n\ndef macro_binding_energy(A: int, Z: int, W: float,\n                         a_v: float, a_s: float, a_c: float, a_a: float, a_p: float) - float:\n    \"\"\"\n    Compute macroscopic binding energy E_macro(Z,N;W) in MeV.\n    \"\"\"\n    N = A - Z\n    delta = pairing_delta(A, Z, N, a_p)\n    # Terms per the semi-empirical mass formula scalings with Wigner term\n    volume = a_v * A\n    surface = -a_s * (A ** (2.0 / 3.0))\n    coulomb = -a_c * (Z * (Z - 1)) / (A ** (1.0 / 3.0)) if A > 0 else 0\n    asymmetry = -a_a * ((N - Z) ** 2) / A if A > 0 else 0\n    wigner = W * abs(N - Z)\n    return volume + surface + coulomb + asymmetry + delta + wigner\n\ndef rms_deviation(dataset, W: float,\n                  a_v: float, a_s: float, a_c: float, a_a: float, a_p: float,\n                  subset_filter=None) - float:\n    \"\"\"\n    Compute RMS deviation for the given dataset and Wigner coefficient W.\n    subset_filter: callable that takes (A, Z, Eexp) and returns True if included.\n                   If None, include all.\n    \"\"\"\n    residuals = []\n    for (A, Z, Eexp) in dataset:\n        if subset_filter is None or subset_filter(A, Z, Eexp):\n            Emac = macro_binding_energy(A, Z, W, a_v, a_s, a_c, a_a, a_p)\n            resid = Emac - Eexp\n            residuals.append(resid)\n    if len(residuals) == 0:\n        return float('nan')\n    residuals = np.array(residuals, dtype=float)\n    return float(np.sqrt(np.mean(residuals ** 2)))\n\ndef solve():\n    # Coefficients (MeV)\n    a_v = 15.75\n    a_s = 17.80\n    a_c = 0.711\n    a_a = 23.00\n    a_p = 11.00\n\n    # Dataset: (A, Z, E_exp in MeV)\n    dataset = [\n        (3, 1, 8.482),\n        (3, 2, 7.718),\n        (4, 2, 28.296),\n        (12, 6, 92.162),\n        (16, 8, 127.620),\n        (20, 10, 160.647),\n        (24, 12, 198.257),\n        (40, 20, 342.052),\n        (56, 26, 492.253),\n        (58, 28, 506.459),\n        (90, 40, 783.894),\n        (120, 50, 1021.800),\n        (208, 82, 1636.430),\n    ]\n\n    # Define light subset: A = 40\n    light_filter = lambda A, Z, Eexp: A = 40\n\n    # Test suite for W\n    test_W = [0.0, 1.0, 2.0, 3.0]\n\n    # Baseline RMS at W=0.0\n    baseline_light_rms = rms_deviation(dataset, 0.0, a_v, a_s, a_c, a_a, a_p, subset_filter=light_filter)\n    baseline_global_rms = rms_deviation(dataset, 0.0, a_v, a_s, a_c, a_a, a_p, subset_filter=None)\n\n    results = []\n    for W in test_W:\n        rms_light = rms_deviation(dataset, W, a_v, a_s, a_c, a_a, a_p, subset_filter=light_filter)\n        rms_global = rms_deviation(dataset, W, a_v, a_s, a_c, a_a, a_p, subset_filter=None)\n        decision = (rms_light  baseline_light_rms) and (rms_global = baseline_global_rms)\n        # Round floats to six decimals in output\n        results.append([float(W), round(rms_light, 6), round(rms_global, 6), decision])\n\n    # Final print statement in the exact required format.\n    # Ensure proper list formatting with values as specified.\n    # We want floats printed as strings with fixed decimals, booleans as True/False.\n    formatted_items = []\n    for item in results:\n        W_val, rl_val, rg_val, dec_val = item\n        W_str = f\"{W_val:.1f}\"\n        rl_str = f\"{rl_val:.6f}\"\n        rg_str = f\"{rg_val:.6f}\"\n        dec_str = str(dec_val)\n        formatted_items.append(f\"[{W_str}, {rl_str}, {rg_str}, {dec_str}]\")\n    print(f\"[{','.join(formatted_items)}]\")\n\nsolve()\n```", "id": "3568504"}, {"introduction": "A powerful aspect of computational modeling is the ability to quantitatively compare competing physical theories. This exercise elevates the previous practices by introducing model fitting via least squares, a cornerstone of data analysis. You will construct and fit two distinct models for the nuclear symmetry energy—one with a pure volume dependence and another including a surface-symmetry correction—to a set of synthetic data [@problem_id:3568528]. By assessing each model's ability to predict a highly sensitive observable, the two-neutron separation energy $S_{2n}$, you will learn a standard methodology for discriminating between models and understanding how different physical effects manifest in nuclear data.", "problem": "You are to implement, fit, and assess two macroscopic nuclear mass models grounded in the liquid drop picture. The goal is to compare a pure volume-symmetry parameterization to a mixed volume-plus-surface symmetry parameterization by fitting the nuclear binding energy and testing residuals of the Two-Neutron Separation Energy (S2n). You must produce a complete, runnable program that performs the specified computations and outputs the required metrics in the exact format described below.\n\nFundamental base and definitions:\n- The nuclear binding energy for a nucleus with mass number $A$, proton number $Z$, and neutron number $N=A-Z$ can be modeled by a macroscopic expansion consistent with the liquid drop picture. This expansion includes leading contributions from volume, surface, Coulomb, symmetry energy, and pairing. Finite-size effects motivate an additional surface-symmetry contribution that modifies the neutron–proton asymmetry energy in finite nuclei.\n- The macroscopic binding energy model can be represented as a linear combination of basis functions $g_j(A,Z)$ with unknown coefficients $c_j$, allowing estimation by ordinary least squares.\n\nModels to be compared:\n- Model $\\mathcal{M}_1$ (pure volume-symmetry): Uses the basis set\n  $$\n  \\{ g_1(A,Z)=A,\\; g_2(A,Z)=A^{2/3},\\; g_3(A,Z)=\\frac{Z(Z-1)}{A^{1/3}},\\; g_4(A,Z)=\\frac{(N-Z)^2}{A},\\; g_5(A,Z)=\\frac{s(A,Z)}{A^{1/2}} \\},\n  $$\n  where $s(A,Z)$ is the pairing-sign factor.\n- Model $\\mathcal{M}_2$ (mixed volume-plus-surface symmetry): Extends $\\mathcal{M}_1$ with an additional basis function\n  $$\n  g_6(A,Z)=\\frac{(N-Z)^2}{A^{4/3}},\n  $$\n  which represents a surface-symmetry contribution to the symmetry energy.\n\nDataset and synthetic \"experimental\" binding energies:\n- Consider only even-even nuclei so that the pairing-sign factor is $s(A,Z)=+1$ for all entries. Use the following set of isotopes:\n  - Calcium chain: $(A,Z)\\in\\{(40,20),(42,20),(44,20),(46,20),(48,20)\\}$.\n  - Nickel chain: $(A,Z)\\in\\{(56,28),(58,28),(60,28),(62,28),(64,28)\\}$.\n  - Tin chain: $(A,Z)\\in\\{(100,50),(102,50),(104,50),(106,50),(108,50)\\}$.\n  - Lead chain: $(A,Z)\\in\\{(204,82),(206,82),(208,82)\\}$.\n- Define the \"experimental\" binding energy $B_{\\mathrm{exp}}(A,Z)$ by an extended macroscopic model with known ground-truth constants and a simple schematic shell correction at selected magic neutron numbers:\n  $$\n  B_{\\mathrm{exp}}(A,Z) \\equiv a_v^{\\star} A \\;-\\; a_s^{\\star} A^{2/3} \\;-\\; a_c^{\\star} \\frac{Z(Z-1)}{A^{1/3}} \\;-\\; a_a^{\\star} \\frac{(N-Z)^2}{A} \\;-\\; a_{ss}^{\\star} \\frac{(N-Z)^2}{A^{4/3}} \\;+\\; a_p^{\\star} \\frac{s(A,Z)}{A^{1/2}} \\;+\\; S_{\\mathrm{magic}}(N),\n  $$\n  with constants\n  $$\n  a_v^{\\star}=15.75\\,\\mathrm{MeV},\\quad a_s^{\\star}=17.80\\,\\mathrm{MeV},\\quad a_c^{\\star}=0.711\\,\\mathrm{MeV},\\quad a_a^{\\star}=23.0\\,\\mathrm{MeV},\\quad a_{ss}^{\\star}=12.0\\,\\mathrm{MeV},\\quad a_p^{\\star}=12.0\\,\\mathrm{MeV},\n  $$\n  and a schematic shell correction\n  $$\n  S_{\\mathrm{magic}}(N)=\n  \\begin{cases}\n  2.0\\,\\mathrm{MeV},  \\text{if } N \\in \\{20,28,50,82,126\\},\\\\\n  0.0\\,\\mathrm{MeV},  \\text{otherwise}.\n  \\end{cases}\n  $$\n  All energies are in megaelectronvolts (MeV).\n\nFitting task:\n- For each model $\\mathcal{M}_1$ and $\\mathcal{M}_2$, estimate the coefficients $c_j$ by minimizing the sum of squared residuals\n  $$\n  \\sum_{i} \\left[ B_{\\mathrm{exp}}(A_i,Z_i) - \\sum_{j} c_j\\, g_j(A_i,Z_i) \\right]^2,\n  $$\n  using ordinary least squares across the full dataset.\n\nTwo-Neutron Separation Energy (S2n):\n- For a fixed proton number $Z$, the Two-Neutron Separation Energy (S2n) is defined as\n  $$\n  S_{2n}(A,Z) \\equiv B(A,Z) - B(A-2,Z),\n  $$\n  where $B$ denotes a binding energy from either the experimental definition or a model prediction. Compute $S_{2n,\\mathrm{exp}}(A,Z)$ from $B_{\\mathrm{exp}}(A,Z)$ and $S_{2n,\\mathrm{th}}(A,Z)$ from each fitted model $B_{\\mathrm{th}}(A,Z)=\\sum_j c_j g_j(A,Z)$.\n\nTest suite:\n- Evaluate $S_{2n}$ residuals for the following isotopic-chain pairs (each pair is a valid $(A,Z)$ with $(A-2,Z)$ present in the dataset):\n  - Calcium: $(A,Z)\\in\\{(42,20),(44,20),(46,20),(48,20)\\}$.\n  - Nickel: $(A,Z)\\in\\{(58,28),(60,28),(62,28),(64,28)\\}$.\n  - Tin: $(A,Z)\\in\\{(102,50),(104,50),(106,50),(108,50)\\}$.\n  - Lead: $(A,Z)\\in\\{(206,82),(208,82)\\}$.\n- For each model, compute the root-mean-square (RMS) of the $S_{2n}$ residuals across all pairs:\n  $$\n  \\mathrm{RMS} \\equiv \\sqrt{\\frac{1}{M}\\sum_{k=1}^{M}\\left[S_{2n,\\mathrm{th}}(A_k,Z_k)-S_{2n,\\mathrm{exp}}(A_k,Z_k)\\right]^2},\n  $$\n  where $M$ is the total number of pairs in the test suite.\n\nOutput specification:\n- Your program must produce a single line containing a comma-separated list enclosed in square brackets with three floating-point numbers rounded to six decimal places:\n  1. The RMS of $S_{2n}$ residuals for $\\mathcal{M}_1$ in $\\mathrm{MeV}$.\n  2. The RMS of $S_{2n}$ residuals for $\\mathcal{M}_2$ in $\\mathrm{MeV}$.\n  3. The difference $\\Delta$ defined by $\\Delta=\\mathrm{RMS}_{\\mathcal{M}_1}-\\mathrm{RMS}_{\\mathcal{M}_2}$ in $\\mathrm{MeV}$.\n- The units are megaelectronvolts (MeV). The final output format must be exactly of the form\n  $$\n  [\\mathrm{RMS}_{\\mathcal{M}_1},\\mathrm{RMS}_{\\mathcal{M}_2},\\Delta],\n  $$\n  for example, \"[0.123456,0.078901,0.044555]\".\n\nImplementation constraints:\n- The program must be self-contained, require no user input, read no external files, and produce the exact single-line output described. Use a deterministic computation of $B_{\\mathrm{exp}}(A,Z)$ according to the definition above. Use double-precision floating-point arithmetic.", "solution": "The problem requires a comparative analysis of two macroscopic nuclear mass models, $\\mathcal{M}_1$ and $\\mathcal{M}_2$, both derived from the liquid drop picture. The assessment involves fitting these models to a synthetic dataset of nuclear binding energies and then evaluating their predictive accuracy for the Two-Neutron Separation Energy ($S_{2n}$). The models differ in their treatment of the symmetry energy: $\\mathcal{M}_1$ uses a pure volume-symmetry term, while $\\mathcal{M}_2$ adds a surface-symmetry correction.\n\nThe solution proceeds in four main stages:\n1.  **Generation of Synthetic Experimental Data**: We first compute the \"experimental\" binding energies, $B_{\\mathrm{exp}}(A,Z)$, for a specified set of $18$ even-even nuclei.\n2.  **Model Fitting via Ordinary Least Squares (OLS)**: For each model, $\\mathcal{M}_1$ and $\\mathcal{M}_2$, we determine the optimal set of coefficients by fitting the model's theoretical binding energy formula to the synthetic data.\n3.  **Calculation of Two-Neutron Separation Energies**: Using both the synthetic data and the fitted models, we compute the $S_{2n}$ values for a specified test suite of nuclei.\n4.  **Performance Evaluation**: We calculate the root-mean-square (RMS) error of the predicted $S_{2n}$ values for each model and compare their performance.\n\n**1. Synthetic Experimental Binding Energy, $B_{\\mathrm{exp}}(A,Z)$**\n\nThe problem provides a precise formula for the synthetic \"experimental\" binding energy $B_{\\mathrm{exp}}(A,Z)$ for a nucleus with mass number $A$ and proton number $Z$. Let $N = A - Z$ be the neutron number. The formula is:\n$$\nB_{\\mathrm{exp}}(A,Z) = a_v^{\\star} A - a_s^{\\star} A^{2/3} - a_c^{\\star} \\frac{Z(Z-1)}{A^{1/3}} - a_a^{\\star} \\frac{(N-Z)^2}{A} - a_{ss}^{\\star} \\frac{(N-Z)^2}{A^{4/3}} + a_p^{\\star} \\frac{s(A,Z)}{A^{1/2}} + S_{\\mathrm{magic}}(N)\n$$\nThe constants are given as $a_v^{\\star}=15.75$, $a_s^{\\star}=17.80$, $a_c^{\\star}=0.711$, $a_a^{\\star}=23.0$, $a_{ss}^{\\star}=12.0$, and $a_p^{\\star}=12.0$, all in units of $\\mathrm{MeV}$. Since all nuclei in the dataset are even-even, the pairing-sign factor is $s(A,Z)=+1$. The schematic shell correction $S_{\\mathrm{magic}}(N)$ is $2.0\\,\\mathrm{MeV}$ for magic neutron numbers $N \\in \\{20,28,50,82,126\\}$ and $0$ otherwise. We first compute these $B_{\\mathrm{exp}}$ values for all nuclei in the dataset, which serve as the ground truth for the fitting procedure.\n\n**2. Model Formulation and Ordinary Least Squares (OLS) Fitting**\n\nThe theoretical binding energy, $B_{\\mathrm{th}}(A,Z)$, for both models is expressed as a linear combination of basis functions $g_j(A,Z)$:\n$$\nB_{\\mathrm{th}}(A,Z) = \\sum_{j} c_j g_j(A,Z)\n$$\nThe coefficients $c_j$ are unknown parameters to be determined. This problem structure lends itself to a solution using ordinary least squares (OLS). For a dataset of $n$ nuclei, we can construct a linear system $\\mathbf{y} \\approx \\mathbf{X}\\mathbf{c}$, where:\n- $\\mathbf{y}$ is a column vector of size $n$ containing the experimental binding energies, $y_i = B_{\\mathrm{exp}}(A_i, Z_i)$.\n- $\\mathbf{X}$ is the $n \\times k$ design matrix, where $k$ is the number of basis functions in the model. Each entry $X_{ij}$ is the value of the $j$-th basis function for the $i$-th nucleus, $X_{ij} = g_j(A_i, Z_i)$.\n- $\\mathbf{c}$ is the column vector of the $k$ unknown coefficients $c_j$.\n\nThe OLS method finds the vector $\\mathbf{c}$ that minimizes the sum of squared residuals, $\\|\\mathbf{y} - \\mathbf{X}\\mathbf{c}\\|^2$. The solution is given by $\\mathbf{c} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$.\n\n**Model $\\mathcal{M}_1$ (Volume Symmetry):**\nThis model uses $k=5$ basis functions:\n- Volume: $g_1(A,Z) = A$\n- Surface: $g_2(A,Z) = -A^{2/3}$\n- Coulomb: $g_3(A,Z) = -\\frac{Z(Z-1)}{A^{1/3}}$\n- Symmetry (volume): $g_4(A,Z) = -\\frac{(N-Z)^2}{A}$\n- Pairing: $g_5(A,Z) = \\frac{s(A,Z)}{A^{1/2}} = A^{-1/2}$ (since $s(A,Z)=+1$)\n\nWe construct the $18 \\times 5$ design matrix $\\mathbf{X}_1$ and the target vector $\\mathbf{y}$ from the dataset of $18$ nuclei. We then solve for the coefficient vector $\\mathbf{c}_1$.\n\n**Model $\\mathcal{M}_2$ (Volume + Surface Symmetry):**\nThis model extends $\\mathcal{M}_1$ with a sixth basis function ($k=6$), representing the surface contribution to the symmetry energy:\n- Symmetry (surface): $g_6(A,Z) = -\\frac{(N-Z)^2}{A^{4/3}}$\n\nWe construct the $18 \\times 6$ design matrix $\\mathbf{X}_2$ and solve for the coefficient vector $\\mathbf{c}_2$ using the same target vector $\\mathbf{y}$.\n\nA numerically robust implementation for solving these linear systems is `numpy.linalg.lstsq`, which we utilize. Note that we define the basis functions to match the signs in the formula (e.g., $B = c_1 g_1 + c_2 g_2 + ...$) where the coefficients $c_j$ are expected to be positive values close to the ground-truth constants.\n\n**3. Calculation of Two-Neutron Separation Energy ($S_{2n}$)**\n\nThe Two-Neutron Separation Energy is defined as the energy required to remove two neutrons from a nucleus:\n$$\nS_{2n}(A,Z) = B(A,Z) - B(A-2,Z)\n$$\nWe compute this quantity for the specified test suite of $M=14$ nuclei pairs.\n- $S_{2n,\\mathrm{exp}}(A,Z)$ is calculated using the synthetic $B_{\\mathrm{exp}}$ values.\n- $S_{2n,\\mathrm{th},1}(A,Z)$ is calculated using the theoretical binding energies $B_{\\mathrm{th},1}(A,Z) = \\sum_{j=1}^{5} c_{1,j} g_j(A,Z)$ with the fitted coefficients $\\mathbf{c}_1$.\n- $S_{2n,\\mathrm{th},2}(A,Z)$ is calculated using $B_{\\mathrm{th},2}(A,Z) = \\sum_{j=1}^{6} c_{2,j} g_j(A,Z)$ with coefficients $\\mathbf{c}_2$.\n\n**4. Performance Evaluation via RMS Error**\n\nThe final step is to quantify how well each model reproduces the experimental $S_{2n}$ values. We use the root-mean-square (RMS) of the residuals for this purpose. For each model $\\mathcal{M}_k$:\n$$\n\\mathrm{RMS}_{\\mathcal{M}_k} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M}\\left[S_{2n,\\mathrm{th},k}(A_i,Z_i) - S_{2n,\\mathrm{exp}}(A_i,Z_i)\\right]^2}\n$$\nThe sum runs over the $M=14$ pairs in the $S_{2n}$ test suite. We compute $\\mathrm{RMS}_{\\mathcal{M}_1}$ and $\\mathrm{RMS}_{\\mathcal{M}_2}$. The difference, $\\Delta = \\mathrm{RMS}_{\\mathcal{M}_1} - \\mathrm{RMS}_{\\mathcal{M}_2}$, provides a direct measure of the improvement gained by including the surface-symmetry term. A positive $\\Delta$ indicates that model $\\mathcal{M}_2$ is more accurate. The shell correction term $S_{\\mathrm{magic}}(N)$ in the synthetic data is not part of either model's basis set, acting as a source of unmodeled physics. The ability of each model to handle this missing physics, particularly in a differential quantity like $S_{2n}$, is the core of this test.\n\nThe program implements these steps sequentially, ensuring all calculations are performed with double-precision floating-point arithmetic, and formats the final results as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements, fits, and assesses two macroscopic nuclear mass models.\n    \"\"\"\n    # Ground-truth constants for synthetic experimental data in MeV\n    A_V_STAR = 15.75\n    A_S_STAR = 17.80\n    A_C_STAR = 0.711\n    A_A_STAR = 23.0\n    A_SS_STAR = 12.0\n    A_P_STAR = 12.0\n\n    # Dataset of even-even nuclei for fitting (A, Z)\n    fit_dataset = [\n        (40, 20), (42, 20), (44, 20), (46, 20), (48, 20),  # Calcium\n        (56, 28), (58, 28), (60, 28), (62, 28), (64, 28),  # Nickel\n        (100, 50), (102, 50), (104, 50), (106, 50), (108, 50),  # Tin\n        (204, 82), (206, 82), (208, 82)  # Lead\n    ]\n\n    # Test suite for S2n residuals (A, Z)\n    s2n_test_suite = [\n        (42, 20), (44, 20), (46, 20), (48, 20),\n        (58, 28), (60, 28), (62, 28), (64, 28),\n        (102, 50), (104, 50), (106, 50), (108, 50),\n        (206, 82), (208, 82)\n    ]\n\n    magic_neutron_numbers = {20, 28, 50, 82, 126}\n\n    # Helper functions for basis functions g_j(A, Z)\n    # s(A,Z) is +1 for all nuclei in the dataset.\n    def g1(A, Z): return A  # Volume\n    def g2(A, Z): return -A**(2/3)  # Surface\n    def g3(A, Z): return -Z * (Z - 1) / A**(1/3)  # Coulomb\n    def g4(A, Z):  # Symmetry (volume)\n        N = A - Z\n        return -(N - Z)**2 / A\n    def g5(A, Z): return A**(-1/2)  # Pairing\n    def g6(A, Z):  # Symmetry (surface)\n        N = A - Z\n        return -(N - Z)**2 / A**(4/3)\n\n    # Function to calculate synthetic experimental binding energy\n    def calculate_b_exp(A, Z):\n        N = A - Z\n        s_magic = 2.0 if N in magic_neutron_numbers else 0.0\n        \n        b_exp = (A_V_STAR * g1(A, Z) +\n                 A_S_STAR * g2(A, Z) +\n                 A_C_STAR * g3(A, Z) +\n                 A_A_STAR * g4(A, Z) +\n                 A_SS_STAR * g6(A, Z) +\n                 A_P_STAR * g5(A, Z) +\n                 s_magic)\n        return b_exp\n\n    # --- Generate synthetic \"experimental\" data ---\n    y_exp = np.array([calculate_b_exp(A, Z) for A, Z in fit_dataset])\n    b_exp_map = {nucleus: b for nucleus, b in zip(fit_dataset, y_exp)}\n\n    rms_results = []\n    models = {\n        'M1': [g1, g2, g3, g4, g5],\n        'M2': [g1, g2, g3, g4, g5, g6]\n    }\n\n    for model_name, basis_functions in models.items():\n        # --- Model Fitting via OLS ---\n        # Construct the design matrix X\n        X = np.array([[func(A, Z) for func in basis_functions] for A, Z in fit_dataset])\n        \n        # Solve for coefficients c using least squares\n        coeffs, _, _, _ = np.linalg.lstsq(X, y_exp, rcond=None)\n        \n        # --- Calculate Theoretical Binding Energies ---\n        b_th_map = {}\n        # Re-construct X with all nuclei, not just fit_dataset, to get theoretical values\n        all_nuclei = sorted(list(set(fit_dataset)))\n        X_all = np.array([[func(A, Z) for func in basis_functions] for A, Z in all_nuclei])\n\n        b_th_values = np.dot(X_all, coeffs)\n        b_th_map = {nucleus: b for nucleus, b in zip(all_nuclei, b_th_values)}\n\n        # --- Calculate S2n and Residuals ---\n        s2n_residuals = []\n        for A, Z in s2n_test_suite:\n            A_minus_2 = A - 2\n            \n            # S2n experimental\n            s2n_exp = b_exp_map[(A, Z)] - b_exp_map[(A_minus_2, Z)]\n            \n            # S2n theoretical\n            s2n_th = b_th_map[(A, Z)] - b_th_map[(A_minus_2, Z)]\n            \n            s2n_residuals.append(s2n_th - s2n_exp)\n            \n        # --- Performance Evaluation (RMS) ---\n        rms = np.sqrt(np.mean(np.square(s2n_residuals)))\n        rms_results.append(rms)\n\n    rms_m1 = rms_results[0]\n    rms_m2 = rms_results[1]\n    delta = rms_m1 - rms_m2\n\n    print(f\"[{rms_m1:.6f},{rms_m2:.6f},{delta:.6f}]\")\n\nsolve()\n```", "id": "3568528"}]}