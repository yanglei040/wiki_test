{"hands_on_practices": [{"introduction": "This practice explores the fundamental connection between the microscopic description of nuclear matter and the macroscopic properties that shape a potential energy surface. We will see how nuclear surface tension, a key quantity governing deformation energy, can be derived from a simplified Energy Density Functional (EDF). By implementing a model based on this principle [@problem_id:3580504], you will quantify how changes in the underlying functional, specifically its gradient terms, directly impact the stiffness of the nucleus against deformation.", "problem": "You are asked to implement a complete, runnable program that quantifies how perturbations in the gradient term of a nuclear Energy Density Functional (EDF) modify the topology of the potential energy surface (PES) for a uniform-density finite nucleus undergoing quadrupole-like deformations. The objective is to anchor the calculation to first principles and well-tested constructs in computational nuclear physics while deriving algorithmic steps from these foundations.\n\nThe fundamental base is the following. Consider an EDF whose local part is a Landau double-well free-energy density for uniform nuclear matter and whose nonlocal part is a gradient term. The three-dimensional energy functional is\n$$\n\\mathcal{E}[\\rho] \\;=\\; \\int d^3 r \\left[ \\frac{C_{\\nabla}}{2}\\,\\lvert \\nabla \\rho(\\mathbf{r}) \\rvert^2 \\;+\\; f(\\rho(\\mathbf{r})) \\right],\n$$\nwhere $C_{\\nabla}$ is the gradient coefficient and $f(\\rho)$ is the bulk free-energy density. We take the bulk term to be\n$$\nf(\\rho) \\;=\\; K\\,\\rho^2 \\left(1 - \\frac{\\rho}{\\rho_0}\\right)^2,\n$$\nwhere $K$ and $\\rho_0$ are constants with $K$ in $\\mathrm{MeV}\\,\\mathrm{fm}^3$ and $\\rho_0$ in $\\mathrm{fm}^{-3}$. This $f(\\rho)$ has two degenerate minima at $\\rho = 0$ (vacuum) and $\\rho = \\rho_0$ (saturated nuclear matter), representing coexistence at zero pressure.\n\nFrom the calculus of variations and mechanical equilibrium across a planar interface, the one-dimensional stationary profile $\\rho(x)$ connecting $\\rho=0$ and $\\rho=\\rho_0$ satisfies the Euler-Lagrange equation with appropriate boundary conditions, and admits a first integral that relates the gradient term to the bulk term. The nuclear surface tension $\\sigma$ is the excess energy per unit area of this interface, defined by the integral of the stationary interface energy density along the normal direction. Your program must obtain $\\sigma$ from this principle, not by assumption.\n\nTo connect the surface tension to finite-nucleus deformation energetics, use the leptodermous liquid-drop approximation. For a uniform-density droplet with fixed volume, the deformation energy is approximated by the surface contribution\n$$\nE_{\\text{def}}(s) \\;=\\; \\sigma\\, S(s),\n$$\nwhere $S(s)$ is the surface area of the deformed shape and $s$ is a dimensionless shape parameter. Constrain the shape to be an axisymmetric spheroid (ellipsoid of revolution) with axes $a = b$ (equatorial) and $c$ (polar), and impose volume conservation equal to that of a sphere of radius $R_0$, i.e., $V = \\frac{4\\pi}{3} R_0^3 = \\frac{4\\pi}{3} a^2 c$. Use the axis ratio $s = c/a$ as the deformation parameter and enforce $a^2 c = R_0^3$, i.e.,\n$$\na \\;=\\; R_0\\, s^{-1/3}, \\qquad c \\;=\\; R_0\\, s^{2/3}.\n$$\nThe spheroidal surface area $S(s)$ is to be computed using standard geometry. For $s > 1$ (prolate, $c > a$) define the eccentricity $e = \\sqrt{1 - \\frac{a^2}{c^2}}$ and use\n$$\nS_{\\text{pro}} \\;=\\; 2\\pi a^2 \\left(1 + \\frac{c}{a e} \\arcsin e \\right).\n$$\nFor $s < 1$ (oblate, $c < a$) define the eccentricity $e = \\sqrt{1 - \\frac{c^2}{a^2}}$ and use\n$$\nS_{\\text{obl}} \\;=\\; 2\\pi a^2 \\left(1 + \\frac{1 - e^2}{e} \\operatorname{artanh} e \\right).\n$$\nFor $s = 1$ (sphere), use\n$$\nS(1) \\;=\\; 4\\pi R_0^2.\n$$\n\nYou will study the dependence of the PES topology on the gradient term by perturbing $C_{\\nabla}$. Let the perturbed gradient coefficient be\n$$\nC_{\\nabla}^{(\\delta)} \\;=\\; C_{\\nabla}\\,(1 + \\delta),\n$$\nwith $\\delta$ a dimensionless perturbation that must satisfy $1+\\delta > 0$ to keep the interface well-defined. The bulk term $f(\\rho)$ and saturation density $\\rho_0$ are held fixed. You must relate changes in PES topology to changes in the effective surface tension $\\sigma$ and hence to deformation energy.\n\nYour program must, for each test case, perform the following tasks:\n\n- Compute the effective surface tension $\\sigma$ in $\\mathrm{MeV}/\\mathrm{fm}^2$ from the stationary planar interface implied by the above functional, expressed in terms of $C_{\\nabla}^{(\\delta)}$, $K$, and $\\rho_0$.\n- Compute the deformation energy differences $\\Delta E_{\\text{pro}} = E_{\\text{def}}(s_{\\text{pro}}) - E_{\\text{def}}(1)$ and $\\Delta E_{\\text{obl}} = E_{\\text{def}}(s_{\\text{obl}}) - E_{\\text{def}}(1)$ in $\\mathrm{MeV}$ at two probe deformations $s_{\\text{pro}} = 1.20$ and $s_{\\text{obl}} = 0.80$.\n- Compute the local quadratic curvature of the PES at $s = 1$ in $\\mathrm{MeV}$ via a central finite-difference second derivative:\n$$\n\\left.\\frac{d^2 E_{\\text{def}}}{d s^2}\\right|_{s=1} \\;\\approx\\; \\frac{E_{\\text{def}}(1+h) - 2\\,E_{\\text{def}}(1) + E_{\\text{def}}(1-h)}{h^2},\n$$\nwith step size $h = 10^{-3}$.\n\nAll energies must be reported in $\\mathrm{MeV}$, all lengths in $\\mathrm{fm}$, and surface tensions in $\\mathrm{MeV}/\\mathrm{fm}^2$. Angles, if any arise during computation, must be in radians.\n\nTest suite (each tuple lists $(C_{\\nabla}, \\delta, R_0, \\rho_0, K)$):\n\n- Case $1$ (happy path): $(60.0, 0.0, 6.7, 0.16, 400.0)$.\n- Case $2$ (increased gradient): $(60.0, 0.50, 6.7, 0.16, 400.0)$.\n- Case $3$ (near-vanishing gradient, edge case): $(60.0, -0.90, 6.7, 0.16, 400.0)$.\n- Case $4$ (different nucleus size): $(60.0, 0.20, 5.5, 0.16, 400.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a four-element list $[\\sigma, \\Delta E_{\\text{pro}}, \\Delta E_{\\text{obl}}, \\text{curvature}]$. For example, it should look like $[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\dots]$ with no spaces.", "solution": "The problem requires the analysis of a potential energy surface (PES) for a finite nucleus, based on an Energy Density Functional (EDF). The task is to quantify how perturbations to the gradient term of the EDF affect the PES topology. This involves deriving the nuclear surface tension from first principles and then applying it within the leptodermous liquid-drop approximation for a spheroidal nucleus.\n\nThe provided energy functional is\n$$\n\\mathcal{E}[\\rho] = \\int d^3 r \\left[ \\frac{C_{\\nabla}^{(\\delta)}}{2}\\,\\lvert \\nabla \\rho(\\mathbf{r}) \\rvert^2 + f(\\rho(\\mathbf{r})) \\right]\n$$\nwhere the perturbed gradient coefficient is $C_{\\nabla}^{(\\delta)} = C_{\\nabla}(1+\\delta)$, and the bulk energy density is $f(\\rho) = K\\,\\rho^2 (1 - \\rho/\\rho_0)^2$. For dimensional consistency within the integrand, where the energy density must have units of $\\mathrm{MeV}\\,\\mathrm{fm}^{-3}$, and given that $\\rho$ is in $\\mathrm{fm}^{-3}$ and $K$ is in $\\mathrm{MeV}\\,\\mathrm{fm}^3$, the coefficient $C_{\\nabla}$ must have units of $\\mathrm{MeV}\\,\\mathrm{fm}^5$. All calculations will proceed under this necessary assumption. The constraint $1+\\delta > 0$ ensures $C_{\\nabla}^{(\\delta)} > 0$, a requirement for the stability of a uniform phase.\n\nThe core of the problem consists of two main theoretical steps: first, deriving the surface tension $\\sigma$ from the EDF, and second, using $\\sigma$ to construct the deformation energy of a finite nucleus.\n\n**1. Derivation of the Nuclear Surface Tension ($\\sigma$)**\n\nThe surface tension $\\sigma$ is defined as the excess energy per unit area of a stationary planar interface separating two coexisting phases. Here, the phases are the vacuum ($\\rho=0$) and saturated nuclear matter ($\\rho=\\rho_0$). For a one-dimensional profile $\\rho(x)$ along the direction normal to the interface, the energy per unit area is\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left[ \\frac{C_{\\nabla}^{(\\delta)}}{2} \\left(\\frac{d\\rho}{dx}\\right)^2 + f(\\rho(x)) \\right] dx\n$$\nThe stationary profile $\\rho(x)$ that minimizes this energy functional is determined by the Euler-Lagrange equation. Since the integrand, $L(\\rho, \\rho') = \\frac{C_{\\nabla}^{(\\delta)}}{2}(\\rho')^2 + f(\\rho)$, does not depend explicitly on the coordinate $x$, a first integral of motion exists (the Beltrami identity):\n$$\nL - \\rho' \\frac{\\partial L}{\\partial \\rho'} = \\text{constant}\n$$\nSubstituting the expression for $L$ yields:\n$$\n\\left(\\frac{C_{\\nabla}^{(\\delta)}}{2}(\\rho')^2 + f(\\rho)\\right) - \\rho' (C_{\\nabla}^{(\\delta)}\\rho') = -\\frac{C_{\\nabla}^{(\\delta)}}{2}(\\rho')^2 + f(\\rho) = \\text{constant}\n$$\nThe boundary conditions for the interface are $\\rho(x) \\to 0$ as $x \\to -\\infty$ and $\\rho(x) \\to \\rho_0$ as $x \\to +\\infty$. In both limits, the density is uniform, so its derivative $\\rho'$ is zero. Furthermore, the bulk term is constructed such that $f(0) = 0$ and $f(\\rho_0) = 0$. Therefore, the constant of integration must be zero. This gives the crucial equipartition relation for the stationary path:\n$$\nf(\\rho) = \\frac{C_{\\nabla}^{(\\delta)}}{2} \\left(\\frac{d\\rho}{dx}\\right)^2\n$$\nThis relation states that along the an energy-minimizing path, the potential energy density is equal to the gradient energy density. Using this, we can rewrite the integral for $\\sigma$:\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left[f(\\rho) + f(\\rho)\\right] dx = 2 \\int_{-\\infty}^{\\infty} f(\\rho(x)) dx\n$$\nAn alternative, more direct path to the solution is to rearrange the equipartition relation to find $dx = d\\rho / \\rho'$:\n$$\n\\frac{d\\rho}{dx} = \\sqrt{\\frac{2 f(\\rho)}{C_{\\nabla}^{(\\delta)}}} \\implies dx = \\sqrt{\\frac{C_{\\nabla}^{(\\delta)}}{2 f(\\rho)}} d\\rho\n$$\nWe can express $\\sigma$ as an integral over the density $\\rho$ from $0$ to $\\rho_0$.\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\sqrt{2 C_{\\nabla}^{(\\delta)} f(\\rho)} \\left(\\frac{d\\rho}{dx}\\right) dx = \\int_{0}^{\\rho_0} \\sqrt{2 C_{\\nabla}^{(\\delta)} f(\\rho)} \\, d\\rho\n$$\nNow, we substitute the specific functional form for $f(\\rho)$:\n$$\nf(\\rho) = K\\,\\rho^2 \\left(1 - \\frac{\\rho}{\\rho_0}\\right)^2\n$$\nFor $\\rho \\in [0, \\rho_0]$, the term $(1 - \\rho/\\rho_0)$ is non-negative, so we can write:\n$$\n\\sqrt{f(\\rho)} = \\sqrt{K} \\, \\rho \\left(1 - \\frac{\\rho}{\\rho_0}\\right)\n$$\nThe integral for $\\sigma$ becomes:\n$$\n\\sigma = \\int_{0}^{\\rho_0} \\sqrt{2 C_{\\nabla}^{(\\delta)} K} \\left( \\rho - \\frac{\\rho^2}{\\rho_0} \\right) d\\rho\n$$\n$$\n\\sigma = \\sqrt{2 C_{\\nabla}^{(\\delta)} K} \\left[ \\frac{\\rho^2}{2} - \\frac{\\rho^3}{3\\rho_0} \\right]_{0}^{\\rho_0} = \\sqrt{2 C_{\\nabla}^{(\\delta)} K} \\left( \\frac{\\rho_0^2}{2} - \\frac{\\rho_0^2}{3} \\right)\n$$\nThis yields the final analytical expression for the surface tension:\n$$\n\\sigma = \\frac{\\rho_0^2}{6} \\sqrt{2 K C_{\\nabla}^{(\\delta)}} = \\frac{\\rho_0^2}{6} \\sqrt{2 K C_{\\nabla} (1+\\delta)}\n$$\n\n**2. Deformation Energy and Potential Energy Surface Analysis**\n\nThe problem uses the leptodermous liquid-drop approximation, where the deformation energy is solely dependent on the change in surface area, with the surface tension $\\sigma$ acting as the constant of proportionality:\n$$\nE_{\\text{def}}(s) = \\sigma S(s)\n$$\nHere, $s=c/a$ is the dimensionless axis ratio of an axisymmetric spheroid with volume conservation $a^2c = R_0^3$. The semi-axes are $a = R_0 s^{-1/3}$ and $c = R_0 s^{2/3}$. The surface area $S(s)$ is given by standard geometric formulas, which depend on whether the shape is prolate ($s>1$), oblate ($s<1$), or spherical ($s=1$).\n\nThe specific calculations required are:\n-   **Deformation energies**: $\\Delta E_{\\text{pro}} = E_{\\text{def}}(s_{\\text{pro}}) - E_{\\text{def}}(1)$ and $\\Delta E_{\\text{obl}} = E_{\\text{def}}(s_{\\text{obl}}) - E_{\\text{def}}(1)$ for $s_{\\text{pro}} = 1.20$ and $s_{\\text{obl}} = 0.80$. These are computed as $\\Delta E = \\sigma (S(s) - S(1))$, where $S(1) = 4\\pi R_0^2$.\n-   **PES curvature at $s=1$**: The local curvature is the second derivative of the deformation energy, evaluated at the spherical point $s=1$. It is calculated using a central finite-difference scheme:\n$$\nC = \\left.\\frac{d^2 E_{\\text{def}}}{d s^2}\\right|_{s=1} \\approx \\frac{E_{\\text{def}}(1+h) - 2E_{\\text{def}}(1) + E_{\\text{def}}(1-h)}{h^2}\n$$\nwith a small step size $h=10^{-3}$. This can be rewritten as:\n$$\nC \\approx \\sigma \\left[ \\frac{S(1+h) - 2S(1) + S(1-h)}{h^2} \\right]\n$$\nwhere $S(1+h)$ is calculated using the prolate formula and $S(1-h)$ using the oblate formula.\n\n**3. Algorithmic Procedure**\n\nFor each given test case tuple $(C_{\\nabla}, \\delta, R_0, \\rho_0, K)$, the algorithm proceeds as follows:\n1.  Compute the perturbed gradient coefficient $C_{\\nabla}^{(\\delta)} = C_{\\nabla}(1+\\delta)$.\n2.  Compute the surface tension $\\sigma$ using the derived formula $\\sigma = \\frac{\\rho_0^2}{6} \\sqrt{2 K C_{\\nabla}^{(\\delta)}}$.\n3.  Implement a function `spheroid_surface_area(s, R0)` that correctly computes the surface area using the provided formulae for prolate ($s>1$), oblate ($s<1$), and spherical ($s=1$) shapes.\n4.  Calculate the required surface areas: $S(1.20)$, $S(0.80)$, and $S(1) = 4\\pi R_0^2$.\n5.  Compute the deformation energy differences: $\\Delta E_{\\text{pro}} = \\sigma (S(1.20) - S(1))$ and $\\Delta E_{\\text{obl}} = \\sigma (S(0.80) - S(1))$.\n6.  For the curvature calculation, compute $S(1+h)$ and $S(1-h)$ with $h=10^{-3}$, and then apply the finite-difference formula to find $C$.\n7.  Collect the four computed values $[\\sigma, \\Delta E_{\\text{pro}}, \\Delta E_{\\text{obl}}, C]$ for the current test case.\n8.  Repeat for all test cases and format the final output as a list of lists.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear physics problem by calculating surface tension, deformation\n    energies, and PES curvature for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (C_nabla, delta, R0, rho0, K)\n        (60.0, 0.0, 6.7, 0.16, 400.0),\n        (60.0, 0.50, 6.7, 0.16, 400.0),\n        (60.0, -0.90, 6.7, 0.16, 400.0),\n        (60.0, 0.20, 5.5, 0.16, 400.0),\n    ]\n\n    s_pro = 1.20\n    s_obl = 0.80\n    h = 1e-3\n\n    def spheroid_surface_area(s, R0):\n        \"\"\"\n        Calculates the surface area of an axisymmetric spheroid with volume conservation.\n        s: axis ratio c/a\n        R0: radius of the equivalent sphere\n        \"\"\"\n        if s == 1.0:\n            return 4.0 * np.pi * R0**2\n        \n        a = R0 * s**(-1/3)\n        c = R0 * s**(2/3)\n        \n        if s > 1.0:  # Prolate\n            e = np.sqrt(1.0 - (a**2 / c**2))\n            return 2.0 * np.pi * a**2 * (1.0 + (c / (a * e)) * np.arcsin(e))\n        else:  # Oblate (s < 1.0)\n            e = np.sqrt(1.0 - (c**2 / a**2))\n            # Note on formula: (1 - e^2) = s^2 for oblate spheroids\n            return 2.0 * np.pi * a**2 * (1.0 + ((1 - e**2) / e) * np.arctanh(e))\n\n    results = []\n    for C_nabla, delta, R0, rho0, K in test_cases:\n        # Validate perturbation parameter\n        if 1.0 + delta <= 0:\n            raise ValueError(\"Invalid perturbation: 1+delta must be positive.\")\n\n        # 1. Compute surface tension sigma\n        C_nabla_delta = C_nabla * (1.0 + delta)\n        sigma = (rho0**2 / 6.0) * np.sqrt(2.0 * K * C_nabla_delta)\n\n        # 2. Compute deformation energy differences\n        S_sphere = spheroid_surface_area(1.0, R0)\n        S_pro = spheroid_surface_area(s_pro, R0)\n        S_obl = spheroid_surface_area(s_obl, R0)\n        \n        delta_E_pro = sigma * (S_pro - S_sphere)\n        delta_E_obl = sigma * (S_obl - S_sphere)\n\n        # 3. Compute PES curvature at s=1\n        S_plus_h = spheroid_surface_area(1.0 + h, R0)\n        S_minus_h = spheroid_surface_area(1.0 - h, R0)\n        \n        S_double_prime = (S_plus_h - 2.0 * S_sphere + S_minus_h) / h**2\n        curvature = sigma * S_double_prime\n        \n        # Store results for this case\n        case_results = [sigma, delta_E_pro, delta_E_obl, curvature]\n        results.append(case_results)\n\n    # Format the final output string\n    str_results = []\n    for res in results:\n        str_results.append(f\"[{','.join(map(str, res))}]\")\n    \n    final_output = f\"[{','.join(str_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3580504"}, {"introduction": "A multi-dimensional potential energy surface is typically calculated point-by-point by constraining the system's shape. However, the choice of constraint operator can introduce unphysical artifacts, a challenge known as 'gauge dependence'. This exercise demonstrates the critical importance of rotational invariance in building a physically meaningful PES [@problem_id:3580409], showing how reconstructions based on non-invariant coordinates fail and how a robust method succeeds by using a basis of true rotational invariants like $\\beta^2$ and $\\beta^3 \\cos(3\\gamma)$.", "problem": "Consider a two-dimensional potential energy surface (PES) for quadrupole collective degrees of freedom in the intrinsic frame of a nucleus. The surface is defined in terms of the quadrupole deformation magnitude $ \\beta \\ge 0 $ and the triaxiality angle $ \\gamma \\in [0,\\pi/3] $ (radians). The true PES is constructed from rotationally invariant scalars of the quadrupole tensor through a Landau-type expansion up to fourth order,\n$$\nV_{\\mathrm{true}}(\\beta,\\gamma) = a\\,\\beta^2 + b\\,\\beta^3 \\cos(3\\gamma) + c\\,\\beta^4,\n$$\nwith dimensionless coefficients $ a > 0 $, $ c > 0 $, and $ b $ allowed to be positive, zero, or negative. Define the operator-projected coordinates\n$$\nq_{20} = \\beta \\cos\\gamma,\\qquad q_{22} = \\beta \\sin\\gamma,\n$$\nwhich are surrogates for constraints along the axial $(\\hat{Q}_{20})$ and triaxial $(\\hat{Q}_{22})$ directions, respectively.\n\nYour tasks are:\n\n1. Construct two gauge-dependent reconstructions of the PES from one-dimensional cuts:\n   - The $ \\hat{Q}_{20} $ gauge: Along the line $ \\gamma = 0 $, generate a data set $ \\{(\\beta_i, V_{\\mathrm{true}}(\\beta_i,0))\\} $ for $ \\beta_i $ uniformly spaced in $ [0,\\beta_{\\max}] $. Fit a univariate quartic-without-constant/linear polynomial\n     $$\n     f_{20}(q) \\approx \\alpha_2 q^2 + \\alpha_3 q^3 + \\alpha_4 q^4\n     $$\n     by least squares to the relation $ V_{\\mathrm{true}}(\\beta,0) \\approx f_{20}(q_{20}) $ using the generated data. Define the gauge-dependent reconstruction over the whole domain by\n     $$\n     V^{(20)}_{\\mathrm{gd}}(\\beta,\\gamma) = \\alpha_2\\,(\\beta\\cos\\gamma)^2 + \\alpha_3\\,(\\beta\\cos\\gamma)^3 + \\alpha_4\\,(\\beta\\cos\\gamma)^4.\n     $$\n   - The $ \\hat{Q}_{22} $ gauge: Along the line $ \\gamma = \\pi/3 $, generate a data set $ \\{(\\beta_i, V_{\\mathrm{true}}(\\beta_i,\\pi/3))\\} $ for the same $ \\beta_i $. Fit\n     $$\n     f_{22}(q) \\approx \\delta_2 q^2 + \\delta_3 q^3 + \\delta_4 q^4\n     $$\n     by least squares to the relation $ V_{\\mathrm{true}}(\\beta,\\pi/3) \\approx f_{22}(q_{22}) $. Define the gauge-dependent reconstruction over the whole domain by\n     $$\n     V^{(22)}_{\\mathrm{gd}}(\\beta,\\gamma) = \\delta_2\\,(\\beta\\sin\\gamma)^2 + \\delta_3\\,(\\beta\\sin\\gamma)^3 + \\delta_4\\,(\\beta\\sin\\gamma)^4.\n     $$\n\n2. Quantify the gauge dependence between these two reconstructions by the root-mean-square (RMS) difference over a uniform evaluation grid $ \\beta \\in [0,\\beta_{\\max}] $, $ \\gamma \\in [0,\\pi/3] $:\n   $$\n   D_{\\mathrm{gauge}} = \\sqrt{\\frac{1}{N_\\beta N_\\gamma}\\sum_{j=1}^{N_\\beta}\\sum_{k=1}^{N_\\gamma} \\left( V^{(20)}_{\\mathrm{gd}}(\\beta_j,\\gamma_k) - V^{(22)}_{\\mathrm{gd}}(\\beta_j,\\gamma_k) \\right)^2 }.\n   $$\n\n3. Propose and implement a coordinate-invariant reconstruction that uses the invariant basis $ \\{\\beta^2,\\,\\beta^3 \\cos(3\\gamma),\\,\\beta^4\\} $. Fit coefficients $ A, B, C $ by least squares using the combined data from the two one-dimensional cuts $ \\gamma=0 $ and $ \\gamma=\\pi/3 $:\n   $$\n   V_{\\mathrm{true}}(\\beta,\\gamma) \\approx A\\,\\beta^2 + B\\,\\beta^3 \\cos(3\\gamma) + C\\,\\beta^4.\n   $$\n   Then define\n   $$\n   V_{\\mathrm{inv}}(\\beta,\\gamma) = A\\,\\beta^2 + B\\,\\beta^3 \\cos(3\\gamma) + C\\,\\beta^4,\n   $$\n   and compute its RMS error relative to the true PES over the same evaluation grid:\n   $$\n   E_{\\mathrm{inv}} = \\sqrt{\\frac{1}{N_\\beta N_\\gamma}\\sum_{j=1}^{N_\\beta}\\sum_{k=1}^{N_\\gamma} \\left( V_{\\mathrm{inv}}(\\beta_j,\\gamma_k) - V_{\\mathrm{true}}(\\beta_j,\\gamma_k) \\right)^2 }.\n   $$\n\nUse the following numerical specifications (dimensionless units):\n- Angle unit must be radians.\n- Use $ \\beta_{\\max} = 0.5 $.\n- For fitting the one-dimensional functions, use $ M = 301 $ equally spaced samples $ \\beta_i $ in $ [0,\\beta_{\\max}] $.\n- For evaluating $ D_{\\mathrm{gauge}} $ and $ E_{\\mathrm{inv}} $, use a uniform grid with $ N_\\beta = 41 $ points in $ [0,\\beta_{\\max}] $ and $ N_\\gamma = 61 $ points in $ [0,\\pi/3] $.\n\nTest suite:\nEvaluate the pair $ (D_{\\mathrm{gauge}}, E_{\\mathrm{inv}}) $ for the following three parameter sets $ (a,b,c) $:\n- Test 1 (generic triaxial-coupled surface): $ a=2.0 $, $ b=0.8 $, $ c=5.0 $.\n- Test 2 (no cubic invariant, boundary case): $ a=2.0 $, $ b=0.0 $, $ c=5.0 $.\n- Test 3 (strong oblate-driving cubic term): $ a=1.0 $, $ b=-1.2 $, $ c=8.0 $.\n\nYour program must produce a single line of output containing the six floating-point results for the three tests in order, rounded to six decimal places, as a comma-separated list enclosed in square brackets, with no spaces. The order is\n$$\n[ D_{\\mathrm{gauge}}^{(1)}, E_{\\mathrm{inv}}^{(1)}, D_{\\mathrm{gauge}}^{(2)}, E_{\\mathrm{inv}}^{(2)}, D_{\\mathrm{gauge}}^{(3)}, E_{\\mathrm{inv}}^{(3)} ].\n$$", "solution": "` text. I will be careful with the LaTeX formatting rule - every single mathematical entity.\n\nExample formatting:\n`The variable $k_x$`\n`The number $5$`\n`The function $f(x)$`\n`The operator $\\hat{Q}_{20}$`\n\nLooking at the problem statement again: `quartic-without-constant/linear polynomial`. This means the polynomial form starts with the quadratic term. I have correctly used `q^2, q^3, q^4` as basis functions for the fits, so this is handled.\n\nFinal check on the numerical constants:\n`beta_max = 0.5`\n`M = 301`\n`N_beta = 41`\n`N_gamma = 61`\nAll seem reasonable. I'll define these as constants in the Python code for clarity.\nThe output format is clear.\n\nThe final answer should contain the code block, with imports, the `solve()` function defining the test cases, the main logic, and the final print statement.\n\nI will write the solution and the final answer. The solution part will be a detailed explanation of the method, and the final_answer part will be the python code.\nThis problem is scientifically valid and well-posed. The solution proceeds as follows.\n\nThe problem investigates methods for reconstructing a two-dimensional potential energy surface (PES), $V(\\beta, \\gamma)$, from one-dimensional data sets. This scenario is common in nuclear physics, particularly in constrained mean-field calculations, where the choice of constraint operator (the \"gauge\") can affect the resulting multi-dimensional PES. We will implement and compare two \"gauge-dependent\" reconstructions and one \"gauge-invariant\" reconstruction.\n\nFirst, we define numeric constants from the problem statement: $\\beta_{\\max} = 0.5$, $M=301$ for fitting, and $N_\\beta=41$, $N_\\gamma=61$ for evaluation. The true PES is given by $V_{\\mathrm{true}}(\\beta,\\gamma) = a\\,\\beta^2 + b\\,\\beta^3 \\cos(3\\gamma) + c\\,\\beta^4$.\n\n**1. Gauge-Dependent Reconstructions ($V^{(20)}_{\\mathrm{gd}}$ and $V^{(22)}_{\\mathrm{gd}}$)**\n\nThis approach models the PES based on data from a single one-dimensional cut.\n- For the $\\hat{Q}_{20}$ gauge, we generate a dataset by evaluating $V_{\\mathrm{true}}$ along the line $\\gamma=0$. On this line, the projected coordinate is $q_{20} = \\beta\\cos(0) = \\beta$, and the potential is $V_{\\mathrm{true}}(\\beta,0) = a\\beta^2 + b\\beta^3 + c\\beta^4$. We generate $M$ data points $\\{(\\beta_i, V_{\\mathrm{true}}(\\beta_i,0))\\}$ for $\\beta_i \\in [0, \\beta_{\\max}]$. We then perform a least-squares fit of a polynomial $f_{20}(q) = \\alpha_2 q^2 + \\alpha_3 q^3 + \\alpha_4 q^4$ to this data, where $q = q_{20} = \\beta$. This is a linear regression problem, where the unknown coefficients vector $\\vec{\\alpha} = (\\alpha_2, \\alpha_3, \\alpha_4)^T$ is solved from the system $X \\vec{\\alpha} = \\vec{y}$. The design matrix $X$ has rows $[q_i^2, q_i^3, q_i^4]$ and the target vector $\\vec{y}$ has elements $V_{\\mathrm{true}}(\\beta_i,0)$. We use `numpy.linalg.lstsq` to find $\\vec{\\alpha}$. The reconstructed PES, $V^{(20)}_{\\mathrm{gd}}(\\beta,\\gamma) = \\alpha_2(\\beta\\cos\\gamma)^2 + \\alpha_3(\\beta\\cos\\gamma)^3 + \\alpha_4(\\beta\\cos\\gamma)^4$, extrapolates this $1$D fit by assuming the potential depends solely on $q_{20}$.\n\n- For the $\\hat{Q}_{22}$ gauge, the procedure is analogous. We use the line $\\gamma=\\pi/3$. Here, the projected coordinate is $q_{22} = \\beta\\sin(\\pi/3) = \\beta\\sqrt{3}/2$, and the potential is $V_{\\mathrm{true}}(\\beta,\\pi/3) = a\\beta^2 - b\\beta^3 + c\\beta^4$. We fit a polynomial $f_{22}(q) = \\delta_2 q^2 + \\delta_3 q^3 + \\delta_4 q^4$ to the data $\\{(\\beta_i, V_{\\mathrm{true}}(\\beta_i,\\pi/3))\\}$ with $q = q_{22}(\\beta_i)$. The resulting coefficients $\\vec{\\delta} = (\\delta_2, \\delta_3, \\delta_4)^T$ are used to define the second reconstruction, $V^{(22)}_{\\mathrm{gd}}(\\beta,\\gamma) = \\delta_2(\\beta\\sin\\gamma)^2 + \\delta_3(\\beta\\sin\\gamma)^3 + \\delta_4(\\beta\\sin\\gamma)^4$.\n\n**2. Gauge Dependence ($D_{\\mathrm{gauge}}$)**\n\nThe two gauge-dependent reconstructions, $V^{(20)}_{\\mathrm{gd}}$ and $V^{(22)}_{\\mathrm{gd}}$, are generally not equal, as they are based on different, and fundamentally incomplete, assumptions about the structure of the PES. The discrepancy between them is a measure of the \"gauge dependence\". We quantify this by computing the root-mean-square (RMS) difference, $D_{\\mathrm{gauge}}$, over a uniform evaluation grid in the $(\\beta, \\gamma)$ plane with $N_\\beta \\times N_\\gamma$ points.\n\n**3. Coordinate-Invariant Reconstruction ($V_{\\mathrm{inv}}$)**\n\nA more robust method is to use a fitting model that respects the underlying symmetries of the problem. The true potential is built from rotational invariants: $\\beta^2$, $\\beta^3\\cos(3\\gamma)$, and $\\beta^4$. The invariant reconstruction, $V_{\\mathrm{inv}}(\\beta,\\gamma) = A\\beta^2 + B\\beta^3\\cos(3\\gamma) + C\\beta^4$, uses this correct functional form. To determine the coefficients $A$, $B$, and $C$, we need data that samples the dependence on both $\\beta$ and $\\gamma$. We use the combined data from the two previous cuts ($\\gamma=0$ and $\\gamma=\\pi/3$). This gives a system of $2M$ linear equations for the $3$ unknown coefficients $(A,B,C)^T$.\nThe design matrix for this combined fit is constructed by stacking the basis functions evaluated at each point. For each $\\beta_i$:\n- For the $\\gamma=0$ cut: the basis functions are $(\\beta_i^2, \\beta_i^3\\cos(0), \\beta_i^4) = (\\beta_i^2, \\beta_i^3, \\beta_i^4)$.\n- For the $\\gamma=\\pi/3$ cut: the basis functions are $(\\beta_i^2, \\beta_i^3\\cos(\\pi), \\beta_i^4) = (\\beta_i^2, -\\beta_i^3, \\beta_i^4)$.\nSince the data is generated directly from $V_{\\mathrm{true}}(\\beta,\\gamma) = a\\,\\beta^2 + b\\,\\beta^3 \\cos(3\\gamma) + c\\,\\beta^4$ and the fitting model $V_{\\mathrm{inv}}$ has the identical functional form, the least-squares fit will perfectly recover the original coefficients, i.e., $A=a$, $B=b$, and $C=c$, up to machine precision. Consequently, $V_{\\mathrm{inv}}$ will be identical to $V_{\\mathrm{true}}$, and the RMS error, $E_{\\mathrm{inv}}$, will be zero (or numerically indistinguishable from zero).\n\nThe overall algorithm proceeds by iterating through each test case $(a,b,c)$, performing the fits for $\\vec{\\alpha}$ and $\\vec{\\delta}$, calculating $D_{\\mathrm{gauge}}$, then performing the fit for $(A, B, C)$ and calculating $E_{\\mathrm{inv}}$. The results are collected and formatted as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear physics PES reconstruction problem for three test cases.\n    \"\"\"\n    \n    # Numerical specifications\n    BETA_MAX = 0.5\n    M_SAMPLES = 301  # For fitting\n    N_BETA_EVAL = 41    # For evaluation grid\n    N_GAMMA_EVAL = 61   # For evaluation grid\n\n    test_cases = [\n        (2.0, 0.8, 5.0),  # Test 1: generic triaxial\n        (2.0, 0.0, 5.0),  # Test 2: no cubic term\n        (1.0, -1.2, 8.0), # Test 3: strong oblate-driving cubic\n    ]\n\n    final_results = []\n    for a, b, c in test_cases:\n        # --- Task 1: Gauge-dependent reconstructions ---\n\n        # Generate fitting samples\n        beta_fit = np.linspace(0, BETA_MAX, M_SAMPLES)\n\n        # 1.1: Q_20 gauge (gamma = 0)\n        gamma_20 = 0.0\n        q20_fit = beta_fit * np.cos(gamma_20)\n        V_true_20_cut = a * beta_fit**2 + b * beta_fit**3 * np.cos(3 * gamma_20) + c * beta_fit**4\n        \n        # Design matrix for f_20(q) = alpha_2*q^2 + alpha_3*q^3 + alpha_4*q^4\n        X_20 = np.vstack([q20_fit**2, q20_fit**3, q20_fit**4]).T\n        alpha_coeffs, _, _, _ = np.linalg.lstsq(X_20, V_true_20_cut, rcond=None)\n        alpha_2, alpha_3, alpha_4 = alpha_coeffs\n\n        # 1.2: Q_22 gauge (gamma = pi/3)\n        gamma_22 = np.pi / 3.0\n        q22_fit = beta_fit * np.sin(gamma_22)\n        V_true_22_cut = a * beta_fit**2 + b * beta_fit**3 * np.cos(3 * gamma_22) + c * beta_fit**4\n\n        # Design matrix for f_22(q) = delta_2*q^2 + delta_3*q^3 + delta_4*q^4\n        X_22 = np.vstack([q22_fit**2, q22_fit**3, q22_fit**4]).T\n        delta_coeffs, _, _, _ = np.linalg.lstsq(X_22, V_true_22_cut, rcond=None)\n        delta_2, delta_3, delta_4 = delta_coeffs\n\n        # --- Task 2: Quantify gauge dependence D_gauge ---\n        \n        # evaluation grid\n        beta_eval = np.linspace(0, BETA_MAX, N_BETA_EVAL)\n        gamma_eval = np.linspace(0, np.pi / 3.0, N_GAMMA_EVAL)\n        BETA_grid, GAMMA_grid = np.meshgrid(beta_eval, gamma_eval)\n\n        # Reconstructed PES on the grid\n        q20_eval = BETA_grid * np.cos(GAMMA_grid)\n        V_gd_20 = alpha_2 * q20_eval**2 + alpha_3 * q20_eval**3 + alpha_4 * q20_eval**4\n        \n        q22_eval = BETA_grid * np.sin(GAMMA_grid)\n        V_gd_22 = delta_2 * q22_eval**2 + delta_3 * q22_eval**3 + delta_4 * q22_eval**4\n\n        # Calculate D_gauge\n        diff_sq_gauge = (V_gd_20 - V_gd_22)**2\n        D_gauge = np.sqrt(np.mean(diff_sq_gauge))\n\n        # --- Task 3: Coordinate-invariant reconstruction and E_inv ---\n        \n        # Combine data from both cuts\n        # Basis functions for gamma=0 cut\n        X_inv_0 = np.vstack([beta_fit**2, beta_fit**3 * np.cos(3 * gamma_20), beta_fit**4]).T\n        # Basis functions for gamma=pi/3 cut\n        X_inv_pi3 = np.vstack([beta_fit**2, beta_fit**3 * np.cos(3 * gamma_22), beta_fit**4]).T\n        \n        # Combined design matrix and target vector\n        X_inv = np.vstack([X_inv_0, X_inv_pi3])\n        V_inv_fit_data = np.concatenate([V_true_20_cut, V_true_22_cut])\n        \n        # Perform fit for A, B, C\n        ABC_coeffs, _, _, _ = np.linalg.lstsq(X_inv, V_inv_fit_data, rcond=None)\n        A, B, C = ABC_coeffs\n        \n        # Evaluate reconstructed and true PES on the grid to find E_inv\n        V_inv_grid = A * BETA_grid**2 + B * BETA_grid**3 * np.cos(3 * GAMMA_grid) + C * BETA_grid**4\n        V_true_grid = a * BETA_grid**2 + b * BETA_grid**3 * np.cos(3 * GAMMA_grid) + c * BETA_grid**4\n        \n        # Calculate E_inv\n        diff_sq_inv = (V_inv_grid - V_true_grid)**2\n        E_inv = np.sqrt(np.mean(diff_sq_inv))\n        \n        final_results.extend([D_gauge, E_inv])\n\n    # Format and print the final output\n    formatted_results = [f\"{x:.6f}\" for x in final_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3580409"}, {"introduction": "A potential energy surface sets the static landscape for nuclear dynamics, but motion across this terrain is governed by both the potential $V(\\mathbf{q})$ and the collective inertia tensor $B_{ij}(\\mathbf{q})$, which defines the metric of the collective space. This practice delves into the semiclassical description of quantum tunneling, a process central to phenomena like spontaneous fission. You will work with the Wentzel-Kramers-Brillouin (WKB) action for tunneling in a multi-dimensional space, implementing a numerical calculation [@problem_id:3580448] to see how the potential and inertia together determine the optimal tunneling path, known as the instanton.", "problem": "Consider a collective Hamiltonian for large-amplitude nuclear motion on a potential energy surface (PES), where the collective coordinates are the axially symmetric mass quadrupole and octupole deformations $\\mathbf{q} \\equiv (q_{20}, q_{30})$, and the inertia is characterized by the symmetric, positive-definite collective inertia tensor $B_{ij}(\\mathbf{q})$. In the semiclassical tunneling regime, the probability amplitude across a barrier is governed by an action integral. Starting from the semiclassical Wentzel–Kramers–Brillouin (WKB) approximation and the Euclidean (imaginary-time) path integral formulation, derive how the tunneling action accumulated along a parameterized path $\\mathbf{q}(s)$ through the classically forbidden region depends on the PES $E(\\mathbf{q})$, the collective inertia tensor $B_{ij}(\\mathbf{q})$, and the path derivatives $\\mathrm{d}\\mathbf{q}/\\mathrm{d}s$. Clearly state the assumptions required for the derivation to be valid in this context.\n\nThen, implement a program to numerically compute the WKB action along piecewise-linear paths and validate the result against an instanton (saddle-point of the Euclidean action) calculation for a separable quadratic barrier PES. Specifically, consider the two-dimensional PES\n$$\nE(\\mathbf{q}) = V_b - \\frac{1}{2} k_b \\, q_{20}^2 + \\frac{1}{2} k_t \\, q_{30}^2,\n$$\nwith constant, diagonal collective inertia tensor\n$$\nB_{ij}(\\mathbf{q}) = \\begin{pmatrix} B_{20} & 0 \\\\ 0 & B_{30} \\end{pmatrix},\n$$\nand a reference energy $E_0$ below the barrier top $V_b$. Energies $V_b$, $E_0$, and stiffnesses $k_b$, $k_t$ must be treated in megaelectron-volts (MeV), the collective coordinates $(q_{20}, q_{30})$ are dimensionless deformations, and the inertia components are in $\\mathrm{MeV}^{-1}$. The tunneling action is dimensionless.\n\nYour program must:\n- Numerically evaluate the WKB action along a given piecewise-linear path $\\mathbf{q}(s)$ using Gaussian quadrature, where the integrand depends on the local barrier height $E(\\mathbf{q}) - E_0$ and the quadratic form induced by $B_{ij}(\\mathbf{q})$ on $\\mathrm{d}\\mathbf{q}$. The path should be restricted to the classically forbidden region, with endpoints at the classical turning points defined by solving $E(\\mathbf{q}) = E_0$ along the specified path.\n- Analytically evaluate the instanton action for the separable quadratic barrier under the same assumptions, and use it as a validation reference where applicable.\n- Report quantitative comparisons for the following test suite.\n\nTest suite (energies in MeV, inertia in $\\mathrm{MeV}^{-1}$, deformations dimensionless):\n1. General case (straight minimal path along $q_{30}=0$):\n   - $V_b = 6$, $E_0 = 1$, $k_b = 4$, $k_t = 3$, $B_{20} = 10$, $B_{30} = 10$.\n   - Path: $\\mathbf{q}(s)$ is a straight line along $q_{30}=0$ from the inner to outer turning points determined by $E(q_{20},0) = E_0$.\n   - Output the WKB action for this path and the absolute difference to the analytic instanton action.\n2. Anisotropic inertia (straight minimal path along $q_{30}=0$):\n   - $V_b = 6$, $E_0 = 2$, $k_b = 5$, $k_t = 3$, $B_{20} = 4$, $B_{30} = 16$.\n   - Path: $\\mathbf{q}(s)$ along $q_{30}=0$ between turning points given by $E(q_{20},0) = E_0$.\n   - Output the WKB action and the absolute difference to the analytic instanton action.\n3. Curved path penalty (non-minimal straight line with slope in $(q_{20}, q_{30})$ plane):\n   - $V_b = 6$, $E_0 = 1$, $k_b = 4$, $k_t = 8$, $B_{20} = 10$, $B_{30} = 10$.\n   - Path: straight line with $q_{30} = \\beta \\, q_{20}$ for $\\beta = 0.5$, between turning points satisfying $E(q_{20}, \\beta q_{20}) = E_0$.\n   - Output a boolean indicating whether the WKB action along this curved path exceeds the analytic instanton action for the straight path along $q_{30}=0$ under the same $(V_b, E_0, k_b, B_{20})$.\n4. Near-barrier limit (straight minimal path along $q_{30}=0$ with $E_0$ very close to $V_b$):\n   - $V_b = 10$, $E_0 = 9.999$, $k_b = 6$, $k_t = 3$, $B_{20} = 7$, $B_{30} = 7$.\n   - Path: along $q_{30}=0$ between turning points given by $E(q_{20},0) = E_0$.\n   - Output the absolute difference between the WKB action and the analytic instanton action.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\"). The list entries must be, in order:\n- Test 1 WKB action as a float,\n- Test 1 absolute difference to analytic instanton as a float,\n- Test 2 WKB action as a float,\n- Test 2 absolute difference to analytic instanton as a float,\n- Test 3 comparison boolean,\n- Test 4 absolute difference to analytic instanton as a float.\n\nAll numerical answers must be dimensionless and reported as raw decimal numbers (no percentage signs).", "solution": "The problem requires the derivation of the semiclassical Wentzel–Kramers–Brillouin (WKB) action for a particle tunneling through a multi-dimensional potential barrier, described by a collective Hamiltonian. Following the derivation, a numerical implementation must be developed to compute this action for specific paths and parameters, and the results validated against an analytical solution for an instanton path.\n\n### 1. Derivation of the Semiclassical Tunneling Action\n\nThe starting point is the classical Lagrangian for a system described by collective coordinates $\\mathbf{q} \\equiv (q_i)$ with a coordinate-dependent inertia tensor $B_{ij}(\\mathbf{q})$ and a potential energy surface (PES) $E(\\mathbf{q})$.\n$$ L(\\mathbf{q}, \\dot{\\mathbf{q}}) = T - V = \\frac{1}{2} \\sum_{i,j} B_{ij}(\\mathbf{q}) \\dot{q}_i \\dot{q}_j - E(\\mathbf{q}) $$\nwhere $\\dot{q}_i = \\mathrm{d}q_i/\\mathrm{d}t$.\n\nTunneling is a classically forbidden process. The semiclassical description is formulated in Euclidean spacetime by performing a Wick rotation to imaginary time, $\\tau = it$. Consequently, the time derivative becomes $\\mathrm{d}/\\mathrm{d}t = i\\,\\mathrm{d}/\\mathrm{d}\\tau$, and hence $\\dot{q}_i = i\\,\\mathrm{d}q_i/\\mathrm{d}\\tau$. The kinetic energy term transforms as:\n$$ T = \\frac{1}{2} \\sum_{i,j} B_{ij} (i\\,\\frac{\\mathrm{d}q_i}{\\mathrm{d}\\tau})(i\\,\\frac{\\mathrm{d}q_j}{\\mathrm{d}\\tau}) = -\\frac{1}{2} \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}\\tau} \\frac{\\mathrm{d}q_j}{\\mathrm{d}\\tau} \\equiv -T_E $$\nThe action integral $\\int L\\,\\mathrm{d}t$ becomes $iS_E$, where $S_E$ is the Euclidean action:\n$$ S_E = \\int L_E \\,\\mathrm{d}\\tau = \\int \\left( T_E + E(\\mathbf{q}) \\right) \\mathrm{d}\\tau $$\nThe system is assumed to tunnel at a constant energy $E_0$. The corresponding Euclidean equations of motion describe a classical particle moving in an inverted potential $V_{inverted} = -E(\\mathbf{q})$ with a conserved total energy of $-E_0$. The conservation of energy in the Euclidean formalism is expressed as:\n$$ H_E = T_E - E(\\mathbf{q}) = -E_0 $$\nThis leads to the fundamental relation valid along the classical trajectory in the forbidden region:\n$$ T_E = \\frac{1}{2} \\sum_{i,j} B_{ij}(\\mathbf{q}) \\frac{\\mathrm{d}q_i}{\\mathrm{d}\\tau} \\frac{\\mathrm{d}q_j}{\\mathrm{d}\\tau} = E(\\mathbf{q}) - E_0 $$\nThis equation is meaningful only in the classically forbidden region where $E(\\mathbf{q}) > E_0$.\n\nThe WKB tunneling action, which appears in the exponent of the tunneling probability $P \\propto e^{-2S/\\hbar}$, is identified with the Euclidean action $S_E$ (with $\\hbar = 1$ for a dimensionless action). We can express $S_E$ in a form that is independent of the time parametrization. Using $T_E = E(\\mathbf{q}) - E_0$ along the path, we can write $S_E = \\int (T_E + E(\\mathbf{q}))\\,\\mathrm{d}\\tau = \\int (E(\\mathbf{q}) - E_0 + E(\\mathbf{q}))\\,\\mathrm{d}\\tau$ which is not the most direct route. Instead, leveraging Maupertuis's principle in the Euclidean space, the action is given by the integral of the Euclidean momentum along the path, $S_E = \\int \\mathbf{p}_E \\cdot \\mathrm{d}\\mathbf{q}$. A more convenient form is obtained by re-parameterizing the path $\\mathbf{q}$ with an arbitrary parameter $s$, such that $\\mathbf{q} = \\mathbf{q}(s)$.\nThe energy conservation equation gives:\n$$ \\frac{1}{2} \\left(\\frac{\\mathrm{d}s}{\\mathrm{d}\\tau}\\right)^2 \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s} = E(\\mathbf{q}(s)) - E_0 $$\nSolving for $\\mathrm{d}\\tau$:\n$$ \\mathrm{d}\\tau = \\mathrm{d}s / \\frac{\\mathrm{d}s}{\\mathrm{d}\\tau} = \\sqrt{\\frac{\\frac{1}{2} \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s}}{E(\\mathbf{q}(s)) - E_0}} \\,\\mathrm{d}s $$\nThe action can be expressed as $S = \\int 2T_E \\,\\mathrm{d}\\tau$. Substituting the expressions for $T_E$ and $\\mathrm{d}\\tau$:\n$$ S[\\mathbf{q}(s)] = \\int_{s_{start}}^{s_{end}} 2 \\left( E(\\mathbf{q}(s)) - E_0 \\right) \\sqrt{\\frac{\\frac{1}{2} \\sum_{i,j} B_{ij} \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s}}{E(\\mathbf{q}(s)) - E_0}} \\,\\mathrm{d}s $$\n$$ S[\\mathbf{q}(s)] = \\int_{s_{start}}^{s_{end}} \\sqrt{2 \\left(E(\\mathbf{q}(s)) - E_0\\right) \\left(\\sum_{i,j} B_{ij}(\\mathbf{q}(s)) \\frac{\\mathrm{d}q_i}{\\mathrm{d}s} \\frac{\\mathrm{d}q_j}{\\mathrm{d}s}\\right)} \\,\\mathrm{d}s $$\nThis is the final expression for the WKB tunneling action along an arbitrary parameterized path $\\mathbf{q}(s)$ from a starting point $s_{start}$ to an ending point $s_{end}$, typically the classical turning points where $E(\\mathbf{q}) = E_0$.\n\nThe key assumptions for this derivation are:\n1.  **Semiclassical Approximation**: The potential $E(\\mathbf{q})$ is slowly varying compared to the local de Broglie wavelength of the collective motion.\n2.  **Adiabatic Motion**: The collective degrees of freedom $\\mathbf{q}$ are assumed to be decoupled from intrinsic nucleonic excitations (no dissipation).\n3.  **Validity of the Collective Model**: The nuclear dynamics are well-described by a small number of collective coordinates.\n4.  **Imaginary Time Formalism**: The tunneling amplitude is dominated by a single classical path (the instanton) in imaginary time.\n\n### 2. Analytical Instanton Action for a Separable Quadratic Barrier\n\nThe instanton is the path that minimizes the action functional $S[\\mathbf{q}(s)]$. For the given PES $E(\\mathbf{q}) = V_b - \\frac{1}{2} k_b q_{20}^2 + \\frac{1}{2} k_t q_{30}^2$ and diagonal inertia tensor $B_{ij}$, the action is:\n$$ S = \\int \\sqrt{2 \\left(V_b - E_0 - \\frac{1}{2}k_b q_{20}^2 + \\frac{1}{2}k_t q_{30}^2\\right)\\left(B_{20}\\left(\\frac{\\mathrm{d}q_{20}}{\\mathrm{d}s}\\right)^2 + B_{30}\\left(\\frac{\\mathrm{d}q_{30}}{\\mathrm{d}s}\\right)^2\\right)} \\,\\mathrm{d}s $$\nTo minimize the action, the path must pass through the lowest possible potential energy. The term $\\frac{1}{2}k_t q_{30}^2$ increases the potential energy as $|q_{30}|$ increases. Therefore, the path of least action (the instanton) must lie along the $q_{30}=0$ axis.\nSetting $q_{30}(s)=0$, the action simplifies. We can parameterize the path by $q_{20}$ itself, so $s=q_{20}$:\n$$ S_{inst} = \\int_{q_{20,a}}^{q_{20,b}} \\sqrt{2 \\left(V_b - E_0 - \\frac{1}{2}k_b q_{20}^2\\right) B_{20}} \\,\\mathrm{d}q_{20} $$\nThe classical turning points $q_{20,a}$ and $q_{20,b}$ are found by setting the argument of the square root to zero:\n$$ V_b - E_0 - \\frac{1}{2}k_b q_{20}^2 = 0 \\implies q_{20} = \\pm \\sqrt{\\frac{2(V_b - E_0)}{k_b}} \\equiv \\pm q_{20,m} $$\nThe integral is standard:\n$$ S_{inst} = \\sqrt{2 B_{20}} \\int_{-q_{20,m}}^{q_{20,m}} \\sqrt{(V_b - E_0) - \\frac{k_b}{2} q_{20}^2} \\,\\mathrm{d}q_{20} $$\nThis integral evaluates to $\\frac{\\pi}{2} (V_b - E_0) \\sqrt{2/k_b}$. Combining terms:\n$$ S_{inst} = \\sqrt{2 B_{20}} \\cdot \\frac{\\pi}{2} (V_b - E_0) \\sqrt{\\frac{2}{k_b}} = \\pi (V_b - E_0) \\sqrt{\\frac{B_{20}}{k_b}} $$\nThis is the analytical formula for the instanton action, which serves as a reference for the numerical calculations.\n\n### 3. Numerical Evaluation and Test Cases\n\nFor a generic straight-line path between two turning points $\\mathbf{q}_A$ and $\\mathbf{q}_B$, we use the parameterization $\\mathbf{q}(s) = \\mathbf{q}_A + s(\\mathbf{q}_B - \\mathbf{q}_A)$ for $s \\in [0, 1]$. The path derivative $\\mathrm{d}\\mathbf{q}/\\mathrm{d}s = \\mathbf{q}_B - \\mathbf{q}_A \\equiv \\Delta\\mathbf{q}$ is constant. The action integral becomes:\n$$ S = \\sqrt{B_{20}(\\Delta q_{20})^2 + B_{30}(\\Delta q_{30})^2} \\int_0^1 \\sqrt{2\\left(E(\\mathbf{q}(s)) - E_0\\right)} \\,\\mathrm{d}s $$\nThis one-dimensional integral can be efficiently and accurately computed using Gaussian quadrature.\n\n**Test Case 1 & 2 & 4:** The specified path is along $q_{30}=0$. This is the instanton path. The numerical WKB action calculation should therefore agree with the analytical instanton formula up to numerical precision. The absolute difference is expected to be near zero.\n\n**Test Case 3:** The specified path is $q_{30} = 0.5 q_{20}$, which is not the instanton path. According to the principle of least action, the action along any path other than the instanton must be greater than the instanton action. Thus, we expect the WKB action along this \"curved\" path (so-called because $q_{30} \\neq 0$) to be greater than the analytic instanton action calculated with the same barrier parameters ($V_b, E_0, k_b, B_{20}$). The comparison should yield `True`.\n\nThe program below implements these calculations, using `scipy.integrate.quad` for numerical integration.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef calculate_wkb_action(Vb, E0, kb, kt, B20, B30, path_type, beta=None):\n    \"\"\"\n    Numerically computes the WKB action along a specified straight-line path.\n\n    The path is parameterized by s in [0, 1] from turning point A to B.\n    \"\"\"\n    if Vb - E0 < 0:\n        return 0.0\n\n    if path_type == 'straight':\n        # Path along q30 = 0\n        if kb <= 0: return np.inf\n        \n        q20_m = np.sqrt(2 * (Vb - E0) / kb)\n        qA = np.array([-q20_m, 0.0])\n        qB = np.array([q20_m, 0.0])\n\n    elif path_type == 'curved':\n        # Path along q30 = beta * q20\n        k_eff = kb - kt * beta**2\n        if k_eff <= 0:\n            # No real turning points or path is not under a barrier\n            return np.inf\n        \n        q20_m = np.sqrt(2 * (Vb - E0) / k_eff)\n        qA = np.array([-q20_m, -beta * q20_m])\n        qB = np.array([q20_m, beta * q20_m])\n    else:\n        raise ValueError(\"Unknown path type\")\n\n    delta_q = qB - qA\n    B_metric_term = B20 * delta_q[0]**2 + B30 * delta_q[1]**2\n    if B_metric_term < 0: return np.inf # Should not happen with positive B_ij\n    \n    # Define the integrand for the action integral\n    def integrand(s):\n        q20_s = qA[0] + s * delta_q[0]\n        q30_s = qA[1] + s * delta_q[1]\n        \n        potential_at_s = Vb - 0.5 * kb * q20_s**2 + 0.5 * kt * q30_s**2\n        energy_diff = potential_at_s - E0\n        \n        # Clamp to zero to handle potential floating-point inaccuracies\n        # at the endpoints where energy_diff should be exactly zero.\n        if energy_diff < 0:\n            return 0.0\n            \n        return np.sqrt(2 * energy_diff)\n\n    integral_val, _ = quad(integrand, 0, 1)\n\n    action = np.sqrt(B_metric_term) * integral_val\n    return action\n\ndef calculate_instanton_action(Vb, E0, kb, B20):\n    \"\"\"\n    Analytically computes the instanton action for the separable quadratic barrier.\n    \"\"\"\n    if Vb - E0 < 0 or kb <= 0 or B20 < 0:\n        return 0.0\n    return np.pi * (Vb - E0) * np.sqrt(B20 / kb)\n\ndef solve():\n    # Test suite: (Vb, E0, kb, kt, B20, B30)\n    test_cases = {\n        1: {'params': (6, 1, 4, 3, 10, 10), 'path': 'straight', 'beta': None},\n        2: {'params': (6, 2, 5, 3, 4, 16), 'path': 'straight', 'beta': None},\n        3: {'params': (6, 1, 4, 8, 10, 10), 'path': 'curved', 'beta': 0.5},\n        4: {'params': (10, 9.999, 6, 3, 7, 7), 'path': 'straight', 'beta': None},\n    }\n\n    results = []\n\n    # Test 1\n    case1 = test_cases[1]\n    Vb1, E01, kb1, _, B201, _ = case1['params']\n    wkb1 = calculate_wkb_action(*case1['params'], path_type=case1['path'])\n    inst1 = calculate_instanton_action(Vb1, E01, kb1, B201)\n    diff1 = np.abs(wkb1 - inst1)\n    results.extend([wkb1, diff1])\n\n    # Test 2\n    case2 = test_cases[2]\n    Vb2, E02, kb2, _, B202, _ = case2['params']\n    wkb2 = calculate_wkb_action(*case2['params'], path_type=case2['path'])\n    inst2 = calculate_instanton_action(Vb2, E02, kb2, B202)\n    diff2 = np.abs(wkb2 - inst2)\n    results.extend([wkb2, diff2])\n\n    # Test 3\n    case3 = test_cases[3]\n    Vb3, E03, kb3, _, B203, _ = case3['params']\n    wkb3_curved = calculate_wkb_action(*case3['params'], path_type=case3['path'], beta=case3['beta'])\n    inst3_straight = calculate_instanton_action(Vb3, E03, kb3, B203)\n    comp3 = wkb3_curved > inst3_straight\n    results.append(comp3)\n    \n    # Test 4\n    case4 = test_cases[4]\n    Vb4, E04, kb4, _, B204, _ = case4['params']\n    wkb4 = calculate_wkb_action(*case4['params'], path_type=case4['path'])\n    inst4 = calculate_instanton_action(Vb4, E04, kb4, B204)\n    diff4 = np.abs(wkb4 - inst4)\n    results.append(diff4)\n\n    # Format and print the final output\n    # Boolean must be 'True' or 'False' which str() handles correctly\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3580448"}]}