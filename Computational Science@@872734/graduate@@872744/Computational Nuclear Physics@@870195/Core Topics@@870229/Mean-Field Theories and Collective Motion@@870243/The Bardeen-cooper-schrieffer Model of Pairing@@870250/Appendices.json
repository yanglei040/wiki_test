{"hands_on_practices": [{"introduction": "To truly grasp the Bardeen-Cooper-Schrieffer (BCS) framework, it is invaluable to start with a simplified model that permits an exact analytical solution. This first practice explores a symmetric two-level system, a classic textbook case that allows for a complete, pen-and-paper derivation of the pairing gap and ground-state energy. By then comparing the BCS result to the exact energy obtained from direct diagonalization, you will gain direct insight into the nature and limitations of the BCS mean-field approximation, particularly in small, finite systems [@problem_id:3594122].", "problem": "Consider a symmetric two-level constant-pairing model for like nucleons in two shell-model orbits straddling the Fermi energy. The single-particle levels are at energies $+\\epsilon$ and $-\\epsilon$ relative to the chemical potential, each with pair degeneracy $\\Omega$ (that is, each level contains $\\Omega$ time-reversed pair orbitals). The pairing Hamiltonian is\n$$\nH \\;=\\; \\sum_{j=\\pm} \\epsilon_{j} \\, N_{j} \\;-\\; G \\sum_{j,l=\\pm} P_{j}^{\\dagger} P_{l},\n$$\nwhere $\\epsilon_{+} = +\\epsilon$, $\\epsilon_{-} = -\\epsilon$, $N_{j}$ counts particles in level $j$, and $P_{j}^{\\dagger} \\equiv \\sum_{m0} c_{j m}^{\\dagger} c_{j \\bar{m}}^{\\dagger}$ creates a pair in level $j$ ($c_{j m}^{\\dagger}$ creates a nucleon in single-particle state $m$ of level $j$ and $c_{j \\bar{m}}^{\\dagger}$ its time-reversed partner). The system is half-filled in pairs, $N_{\\text{pairs}} = \\Omega$, so exactly half of the total pair capacity $2\\Omega$ is occupied.\n\nUsing the Bardeen-Cooper-Schrieffer (BCS) variational framework with a uniform pairing strength $G0$:\n\n- Derive from first principles (starting from the BCS variational ansatz and its self-consistency conditions) the analytical solution of the BCS equations for this symmetric two-level model at half filling. In particular, establish the value of the chemical potential by symmetry and obtain a closed-form expression for the pairing gap $\\Delta$ in terms of $\\epsilon$, $G$, and $\\Omega$.\n\n- Starting from the BCS expectation value of $H$ and the gap self-consistency relation, derive an analytic closed-form expression for the BCS ground-state energy $E_{\\text{BCS}}$ in this two-level model that depends only on $\\epsilon$, $G$, and $\\Omega$ (no intermediate $u_{j}$, $v_{j}$, or $\\mu$).\n\n- For the finite system with $\\Omega = 1$, compute the exact seniority-zero ground-state energy $E_{\\text{exact}}$ by diagonalizing $H$ in the one-pair subspace spanned by $\\{\\,|1\\rangle = P_{-}^{\\dagger} |0\\rangle,\\; |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\,\\}$. Then evaluate the fractional energy error\n$$\n\\delta \\;=\\; \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|},\n$$\nfor parameter values $\\epsilon = 0.50 \\text{ MeV}$ and $G = 0.60 \\text{ MeV}$. Round your final numerical value for $\\delta$ to four significant figures. Express the final number as a pure decimal (no percent sign).", "solution": "### BCS Solution for the Two-Level Model\n\nThe BCS theory employs a variational ansatz for the ground state of a paired system. The ground state is approximated by a product of pair-correlated states for each level $j$:\n$$\n|\\text{BCS}\\rangle = \\prod_{j, m0} (u_j + v_j c_{jm}^{\\dagger} c_{j\\bar{m}}^{\\dagger}) |0\\rangle\n$$\nwhere $u_j$ and $v_j$ are real variational parameters satisfying the normalization condition $u_j^2 + v_j^2 = 1$. The parameter $v_j^2$ represents the probability that a pair-orbital $(m, \\bar{m})$ in shell $j$ is occupied, and $u_j^2$ is the probability that it is empty.\n\nTo find the optimal $u_j$ and $v_j$, we minimize the expectation value of the grand potential operator $\\hat{K} = H - \\mu N$, where $H$ is the Hamiltonian and $N = \\sum_j N_j$ is the total particle number operator, with $\\mu$ being the chemical potential.\n\nThe expectation values of the number and pair operators in the BCS state are:\n$$\n\\langle N_j \\rangle = 2\\Omega v_j^2 \\quad \\text{and} \\quad \\langle P_j^\\dagger \\rangle = \\langle P_j \\rangle = \\Omega u_j v_j\n$$\nThe factor of $2$ in $\\langle N_j \\rangle$ is because $N_j$ counts particles, not pairs, and there are $\\Omega$ pair states in level $j$.\nIn the mean-field approximation, the expectation value of the pairing term is $\\langle \\sum_{j,l} P_j^\\dagger P_l \\rangle \\approx (\\sum_j \\langle P_j^\\dagger \\rangle)(\\sum_l \\langle P_l \\rangle)$.\nThe expectation value of the grand potential is:\n$$\n\\langle \\hat{K} \\rangle = \\sum_{j=\\pm} \\langle \\epsilon_j N_j - \\mu N_j \\rangle - G \\left( \\sum_{j=\\pm} \\langle P_j^\\dagger \\rangle \\right) \\left( \\sum_{l=\\pm} \\langle P_l \\rangle \\right) \\\\\n= \\sum_{j=\\pm} 2\\Omega (\\epsilon_j - \\mu) v_j^2 - G \\left( \\sum_{j=\\pm} \\Omega u_j v_j \\right)^2\n$$\nThe pairing gap $\\Delta$ is defined by the self-consistency relation $\\Delta = G \\sum_j \\langle P_j \\rangle = G \\sum_j \\Omega u_j v_j$. Substituting this, we get:\n$$\n\\langle \\hat{K} \\rangle = \\sum_{j=\\pm} 2\\Omega (\\epsilon_j - \\mu) v_j^2 - \\frac{\\Delta^2}{G}\n$$\nMinimizing $\\langle \\hat{K} \\rangle$ with respect to the $v_j$ (and $u_j = \\sqrt{1-v_j^2}$), subject to the definition of $\\Delta$, yields the standard BCS equations:\n$$\nu_j^2 = \\frac{1}{2} \\left(1 + \\frac{\\epsilon_j - \\mu}{E_j}\\right), \\quad v_j^2 = \\frac{1}{2} \\left(1 - \\frac{\\epsilon_j - \\mu}{E_j}\\right), \\quad u_j v_j = \\frac{\\Delta}{2E_j}\n$$\nwhere $E_j = \\sqrt{(\\epsilon_j - \\mu)^2 + \\Delta^2}$ is the quasiparticle energy for level $j$.\n\nThe self-consistency conditions for $\\mu$ and $\\Delta$ are the number equation and the gap equation.\nThe total number of particles is $N = 2 N_{\\text{pairs}} = 2\\Omega$.\n$$\nN = \\sum_{j=\\pm} \\langle N_j \\rangle = \\sum_{j=\\pm} 2\\Omega v_j^2 = 2\\Omega \\implies \\sum_{j=\\pm} v_j^2 = 1\n$$\n$$\nv_-^2 + v_+^2 = \\frac{1}{2} \\left(1 - \\frac{-\\epsilon - \\mu}{E_-}\\right) + \\frac{1}{2} \\left(1 - \\frac{\\epsilon - \\mu}{E_+}\\right) = 1\n$$\n$$\n1 - \\frac{1}{2} \\left( \\frac{-\\epsilon - \\mu}{E_-} + \\frac{\\epsilon - \\mu}{E_+} \\right) = 1 \\implies \\frac{\\epsilon + \\mu}{E_-} + \\frac{\\epsilon - \\mu}{E_+} = 0\n$$\nwhere $E_- = \\sqrt{(-\\epsilon-\\mu)^2 + \\Delta^2} = \\sqrt{(\\epsilon+\\mu)^2 + \\Delta^2}$ and $E_+ = \\sqrt{(\\epsilon-\\mu)^2 + \\Delta^2}$.\nThe equation becomes $(\\epsilon + \\mu)E_+ = -(\\epsilon - \\mu)E_-$. Squaring both sides:\n$$\n(\\epsilon + \\mu)^2 E_+^2 = (\\epsilon - \\mu)^2 E_-^2 \\\\\n(\\epsilon + \\mu)^2 [(\\epsilon - \\mu)^2 + \\Delta^2] = (\\epsilon - \\mu)^2 [(\\epsilon + \\mu)^2 + \\Delta^2] \\\\\n(\\epsilon + \\mu)^2 \\Delta^2 = (\\epsilon - \\mu)^2 \\Delta^2\n$$\nAssuming a non-trivial pairing solution ($\\Delta \\neq 0$), we must have $(\\epsilon + \\mu)^2 = (\\epsilon - \\mu)^2$. This gives two possibilities: $\\epsilon + \\mu = \\epsilon - \\mu$, which implies $\\mu = 0$, or $\\epsilon + \\mu = -(\\epsilon - \\mu)$, which implies $\\epsilon = 0$. As $\\epsilon$ is a given parameter, the solution is $\\mu = 0$. This result is expected due to the symmetric level placement and the half-filling condition.\n\nWith $\\mu=0$, the gap equation $\\Delta = G \\sum_j \\Omega u_j v_j$ becomes:\n$$\n\\Delta = G \\sum_{j=\\pm} \\Omega \\frac{\\Delta}{2E_j} \\implies 1 = \\frac{G\\Omega}{2} \\sum_{j=\\pm} \\frac{1}{E_j}\n$$\nWith $\\mu=0$, $E_j = \\sqrt{\\epsilon_j^2 + \\Delta^2}$. Since $\\epsilon_-^2 = (-\\epsilon)^2 = \\epsilon^2$ and $\\epsilon_+^2 = \\epsilon^2$, both quasiparticle energies are equal: $E_- = E_+ = \\sqrt{\\epsilon^2 + \\Delta^2}$.\n$$\n1 = \\frac{G\\Omega}{2} \\left( \\frac{1}{\\sqrt{\\epsilon^2 + \\Delta^2}} + \\frac{1}{\\sqrt{\\epsilon^2 + \\Delta^2}} \\right) = \\frac{G\\Omega}{2} \\frac{2}{\\sqrt{\\epsilon^2 + \\Delta^2}} = \\frac{G\\Omega}{\\sqrt{\\epsilon^2 + \\Delta^2}}\n$$\nSolving for $\\Delta$:\n$$\n\\sqrt{\\epsilon^2 + \\Delta^2} = G\\Omega \\implies \\epsilon^2 + \\Delta^2 = (G\\Omega)^2 \\implies \\Delta^2 = (G\\Omega)^2 - \\epsilon^2\n$$\nThis gives the analytical expression for the pairing gap:\n$$\n\\Delta = \\sqrt{(G\\Omega)^2 - \\epsilon^2}\n$$\nThis solution exists for $G\\Omega > \\epsilon$. If $G\\Omega \\le \\epsilon$, the only solution is $\\Delta=0$ (the normal, non-superfluid state).\n\n### BCS Ground-State Energy\n\nThe BCS ground-state energy $E_{\\text{BCS}}$ is the expectation value of the Hamiltonian $H$ in the BCS state:\n$$\nE_{\\text{BCS}} = \\langle H \\rangle = \\sum_{j=\\pm} \\epsilon_j \\langle N_j \\rangle - G \\left( \\sum_{j=\\pm} \\langle P_j \\rangle \\right)^2 = \\sum_{j=\\pm} 2\\Omega \\epsilon_j v_j^2 - \\frac{\\Delta^2}{G}\n$$\nUsing $\\mu=0$, $v_j^2 = \\frac{1}{2} (1 - \\epsilon_j/E_j)$ with $E_j = \\sqrt{\\epsilon_j^2+\\Delta^2}$.\n$$\nE_{\\text{BCS}} = \\sum_{j=\\pm} 2\\Omega \\epsilon_j \\frac{1}{2} \\left(1 - \\frac{\\epsilon_j}{E_j}\\right) - \\frac{\\Delta^2}{G} = \\Omega \\sum_{j=\\pm} \\left( \\epsilon_j - \\frac{\\epsilon_j^2}{E_j} \\right) - \\frac{\\Delta^2}{G}\n$$\nLet's evaluate the sum:\n$$\n\\sum_{j=\\pm} \\left( \\epsilon_j - \\frac{\\epsilon_j^2}{E_j} \\right) = \\left( \\epsilon_+ - \\frac{\\epsilon_+^2}{E_+} \\right) + \\left( \\epsilon_- - \\frac{\\epsilon_-^2}{E_-} \\right)\n$$\nWith $\\epsilon_+ = \\epsilon$, $\\epsilon_- = -\\epsilon$, and $E_+ = E_- = \\sqrt{\\epsilon^2+\\Delta^2} = E$:\n$$\n= \\left( \\epsilon - \\frac{\\epsilon^2}{E} \\right) + \\left( -\\epsilon - \\frac{(-\\epsilon)^2}{E} \\right) = \\epsilon - \\frac{\\epsilon^2}{E} -\\epsilon - \\frac{\\epsilon^2}{E} = -\\frac{2\\epsilon^2}{E}\n$$\nSubstituting this back into the expression for $E_{\\text{BCS}}$:\n$$\nE_{\\text{BCS}} = \\Omega \\left( -\\frac{2\\epsilon^2}{E} \\right) - \\frac{\\Delta^2}{G} = -\\frac{2\\Omega\\epsilon^2}{\\sqrt{\\epsilon^2+\\Delta^2}} - \\frac{\\Delta^2}{G}\n$$\nNow, we substitute the results from the gap equation: $\\sqrt{\\epsilon^2+\\Delta^2} = G\\Omega$ and $\\Delta^2 = (G\\Omega)^2 - \\epsilon^2$.\n$$\nE_{\\text{BCS}} = -\\frac{2\\Omega\\epsilon^2}{G\\Omega} - \\frac{(G\\Omega)^2 - \\epsilon^2}{G} = -\\frac{2\\epsilon^2}{G} - \\frac{G^2\\Omega^2 - \\epsilon^2}{G}\n$$\n$$\nE_{\\text{BCS}} = \\frac{-2\\epsilon^2 - G^2\\Omega^2 + \\epsilon^2}{G} = \\frac{-\\epsilon^2 - G^2\\Omega^2}{G} = -\\frac{\\epsilon^2}{G} - G\\Omega^2\n$$\n\n### Exact Solution for $\\Omega = 1$ and Fractional Error\n\nFor $\\Omega = 1$, the system contains $N_{\\text{pairs}}=1$ pair. The basis for seniority-zero states with one pair is $\\{|1\\rangle = P_{-}^{\\dagger} |0\\rangle, |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\}$. We construct the Hamiltonian matrix in this basis.\nThe single-particle part of the Hamiltonian gives diagonal matrix elements $\\langle 1 | H_{sp} | 1 \\rangle = -2\\epsilon$ and $\\langle 2 | H_{sp} | 2 \\rangle = 2\\epsilon$.\nThe pairing interaction term, $-G \\sum_{j,l} P_j^\\dagger P_l$, has matrix elements:\n- $\\langle 1 | H_p | 1 \\rangle = -G \\langle 0 | P_- (P_+^\\dagger+P_-^\\dagger)(P_++P_-) P_-^\\dagger|0\\rangle = -G \\langle 0 | P_- P_-^\\dagger P_- P_-^\\dagger|0\\rangle = -G$.\n- $\\langle 2 | H_p | 2 \\rangle = -G \\langle 0 | P_+ (P_+^\\dagger+P_-^\\dagger)(P_++P_-) P_+^\\dagger|0\\rangle = -G \\langle 0 | P_+ P_+^\\dagger P_+ P_+^\\dagger|0\\rangle = -G$.\n- $\\langle 1 | H_p | 2 \\rangle = -G \\langle 0 | P_- (P_+^\\dagger+P_-^\\dagger)(P_++P_-) P_+^\\dagger|0\\rangle = -G \\langle 0 | P_- P_-^\\dagger P_+ P_+^\\dagger|0\\rangle = -G$.\nBy hermiticity, $H_{21} = H_{12}^* = -G$.\n\nThe Hamiltonian matrix is:\n$$\n\\mathbf{H} = \\begin{pmatrix} -2\\epsilon - G  -G \\\\ -G  2\\epsilon - G \\end{pmatrix}\n$$\nThe eigenvalues $E$ are found from $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$:\n$$\n(-2\\epsilon - G - E)(2\\epsilon - G - E) - G^2 = 0 \\\\\n(-(G+E) - 2\\epsilon)(-(G+E) + 2\\epsilon) - G^2 = 0 \\\\\n(G+E)^2 - (2\\epsilon)^2 - G^2 = 0 \\\\\n(G+E)^2 = 4\\epsilon^2 + G^2 \\\\\nG+E = \\pm\\sqrt{4\\epsilon^2 + G^2} \\implies E = -G \\pm \\sqrt{4\\epsilon^2 + G^2}\n$$\nThe exact ground-state energy is the lower eigenvalue:\n$$\nE_{\\text{exact}} = -G - \\sqrt{4\\epsilon^2 + G^2}\n$$\n\nNow, we calculate the fractional error $\\delta$ for $\\epsilon = 0.50 \\text{ MeV}$, $G = 0.60 \\text{ MeV}$, and $\\Omega = 1$.\n\nBCS energy:\n$$\nE_{\\text{BCS}} = -\\frac{\\epsilon^2}{G} - G\\Omega^2 = -\\frac{(0.50)^2}{0.60} - (0.60)(1)^2 = -\\frac{0.25}{0.60} - 0.60 = -0.416667 - 0.60 = -1.016667 \\text{ MeV}\n$$\nExact energy:\n$$\nE_{\\text{exact}} = -0.60 - \\sqrt{4(0.50)^2 + (0.60)^2} = -0.60 - \\sqrt{4(0.25) + 0.36} = -0.60 - \\sqrt{1.00 + 0.36} = -0.60 - \\sqrt{1.36}\n$$\n$$\nE_{\\text{exact}} \\approx -0.60 - 1.166190 = -1.766190 \\text{ MeV}\n$$\nThe fractional error $\\delta$:\n$$\n\\delta = \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|} = \\frac{-1.016667 - (-1.766190)}{|-1.766190|} = \\frac{0.749523}{1.766190} \\approx 0.424360\n$$\nRounding to four significant figures, we get $\\delta = 0.4244$.", "answer": "$$\n\\boxed{0.4244}\n$$", "id": "3594122"}, {"introduction": "A core feature of the BCS state is that, being a product of pair-correlated states, it does not have a definite number of particles, which contrasts with the fixed nucleon number of a real nucleus. This exercise moves from evaluating the energy to quantifying this fundamental property by deriving and calculating the particle-number variance, $\\sigma_{N}^{2}$. Understanding this variance is not just an academic formality; it is essential for critically evaluating the applicability of BCS theory to finite nuclei and appreciating the motivation for developing number-conserving pairing theories [@problem_id:3594137].", "problem": "Consider a finite valence space appropriate for a medium-mass nucleus, spanned by $K$ time-reversed pairs of single-particle states $\\{k,\\bar{k}\\}$ (Kramers degeneracy). The Bardeen-Cooper-Schrieffer (BCS) state is defined as the normalized product state\n$$\n|\\Phi\\rangle \\equiv \\prod_{k=1}^{K} \\left(u_{k} + v_{k}\\,a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger}\\right)|0\\rangle,\n$$\nwhere $a_{k}^{\\dagger}$ creates a nucleon in state $k$, $a_{\\bar{k}}^{\\dagger}$ creates its time-reversed partner, and the real BCS amplitudes satisfy $u_{k}^{2} + v_{k}^{2} = 1$. The particle-number operator is\n$$\n\\hat{N} \\equiv \\sum_{k=1}^{K}\\left(a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}\\right).\n$$\nStarting only from these definitions, the canonical anticommutation relations for fermions, and standard properties of expectation values in product states, do the following:\n\n1) Derive an explicit expression for the particle-number variance\n$$\n\\sigma_{N}^{2} \\equiv \\langle \\Phi|\\hat{N}^{2}|\\Phi\\rangle - \\langle \\Phi|\\hat{N}|\\Phi\\rangle^{2}\n$$\npurely in terms of $\\{u_{k},v_{k}\\}$.\n\n2) Now specialize to a schematic constant-gap mean field characterized by a real pairing gap $\\Delta$ and chemical potential $\\mu$, with quasiparticle energies $E_{k}$ that depend on the single-particle energy offsets $\\xi_{k} \\equiv \\epsilon_{k} - \\mu$. Consider a model space with $K = 6$ pair orbitals whose offsets are\n$$\n\\{\\xi_{k}\\} = \\{-1.5,\\,-1.0,\\,-0.5,\\,+0.5,\\,+1.0,\\,+1.5\\}\\ \\text{MeV},\n$$\nand take $\\Delta = 0.80\\ \\text{MeV}$ and $\\mu = 0\\ \\text{MeV}$. Using only standard BCS relations between $\\{u_{k},v_{k}\\}$, $\\{\\xi_{k}\\}$, and $\\{E_{k}\\}$, evaluate the variance $\\sigma_{N}^{2}$ for this model space.\n\nReport your final result for $\\sigma_{N}^{2}$ as a pure number (dimensionless), rounded to four significant figures. Do not include units in your final answer.", "solution": "The problem is divided into two parts. The first part requires the derivation of a general expression for the particle-number variance, $\\sigma_{N}^{2}$, in a Bardeen-Cooper-Schrieffer (BCS) state. The second part requires the numerical evaluation of this variance for a specific model system.\n\n### Part 1: Derivation of Particle-Number Variance\n\nThe particle-number variance is defined as $\\sigma_{N}^{2} \\equiv \\langle \\Phi|\\hat{N}^{2}|\\Phi\\rangle - \\langle \\Phi|\\hat{N}|\\Phi\\rangle^{2}$. We will compute the two terms separately.\n\nThe BCS state is given by $|\\Phi\\rangle = \\prod_{k=1}^{K} (u_{k} + v_{k}a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger})|0\\rangle$. Let's denote the state for a single pair level $k$ as $|\\phi_k\\rangle = (u_{k} + v_{k}a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger})|0\\rangle$. The total state is $|\\Phi\\rangle = \\prod_{k=1}^{K} |\\phi_k\\rangle$. The normalization condition $u_k^2 + v_k^2 = 1$ ensures that each $|\\phi_k\\rangle$ is normalized, i.e., $\\langle\\phi_k|\\phi_k\\rangle = u_k^2 + v_k^2 = 1$, which in turn ensures that the total state $|\\Phi\\rangle$ is normalized.\n\nThe particle-number operator is $\\hat{N} = \\sum_{j=1}^{K} \\hat{n}_j$, where $\\hat{n}_j = a_{j}^{\\dagger}a_{j} + a_{\\bar{j}}^{\\dagger}a_{\\bar{j}}$ is the number operator for the pair level $j$.\n\nFirst, we calculate the expectation value of the total number operator, $\\langle\\hat{N}\\rangle$.\n$$\n\\langle\\hat{N}\\rangle = \\langle\\Phi|\\sum_{k=1}^{K} \\hat{n}_k |\\Phi\\rangle = \\sum_{k=1}^{K} \\langle\\Phi| \\hat{n}_k |\\Phi\\rangle\n$$\nSince the state is a product state and $\\hat{n}_k$ only acts on the states within level $k$, this simplifies to:\n$$\n\\langle\\hat{n}_k\\rangle = \\langle\\phi_k| \\hat{n}_k |\\phi_k\\rangle = \\langle 0 | (u_{k} + v_{k} a_{\\bar{k}}a_{k}) (a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}) (u_{k} + v_{k}a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger})|0\\rangle\n$$\nThe only terms that yield a non-zero inner product with the vacuum bra $\\langle 0|$ on the left are those created by the $v_k^2$ cross-term.\n$$\n\\langle\\hat{n}_k\\rangle = v_k^2 \\langle 0 | a_{\\bar{k}}a_{k} (a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}) a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger} |0\\rangle\n$$\nThe state $a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger}|0\\rangle$ is an eigenstate of $a_{k}^{\\dagger}a_{k}$ with eigenvalue $1$ and of $a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}$ with eigenvalue $1$. Therefore, it is an eigenstate of $\\hat{n}_k$ with eigenvalue $1+1=2$.\n$$\n\\langle\\hat{n}_k\\rangle = v_k^2 \\langle 0 | a_{\\bar{k}}a_{k} (2) a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger} |0\\rangle = 2v_k^2 \\langle 0 | a_{\\bar{k}}a_{k} a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger} |0\\rangle = 2v_k^2\n$$\nThe total average particle number is the sum over all pair levels:\n$$\n\\langle\\hat{N}\\rangle = \\sum_{k=1}^{K} 2v_k^2\n$$\nNext, we calculate the expectation value of $\\hat{N}^2$.\n$$\n\\langle\\hat{N}^2\\rangle = \\langle\\Phi| \\left(\\sum_{k=1}^{K} \\hat{n}_k\\right)^2 |\\Phi\\rangle = \\langle\\Phi| \\left(\\sum_{k=1}^{K} \\hat{n}_k^2 + \\sum_{k \\neq j} \\hat{n}_k \\hat{n}_j\\right) |\\Phi\\rangle\n$$\n$$\n\\langle\\hat{N}^2\\rangle = \\sum_{k=1}^{K} \\langle\\Phi|\\hat{n}_k^2|\\Phi\\rangle + \\sum_{k \\neq j} \\langle\\Phi|\\hat{n}_k \\hat{n}_j|\\Phi\\rangle\n$$\nSince the operators for different levels $k$ and $j$ act on different, independent parts of the product state $|\\Phi\\rangle$, the expectation value of the product is the product of the expectation values: $\\langle\\hat{n}_k \\hat{n}_j\\rangle = \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle$ for $k \\neq j$.\n$$\n\\langle\\hat{N}^2\\rangle = \\sum_{k=1}^{K} \\langle\\hat{n}_k^2\\rangle + \\sum_{k \\neq j} \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle\n$$\nNow we compute the variance:\n$$\n\\sigma_{N}^{2} = \\langle\\hat{N}^2\\rangle - \\langle\\hat{N}\\rangle^2 = \\left(\\sum_k \\langle\\hat{n}_k^2\\rangle + \\sum_{k \\neq j} \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle\\right) - \\left(\\sum_k \\langle\\hat{n}_k\\rangle\\right)^2\n$$\nThe square of the sum is $\\left(\\sum_k \\langle\\hat{n}_k\\rangle\\right)^2 = \\sum_k \\langle\\hat{n}_k\\rangle^2 + \\sum_{k \\neq j} \\langle\\hat{n}_k\\rangle\\langle\\hat{n}_j\\rangle$.\nSubstituting this into the variance expression, the cross-terms cancel:\n$$\n\\sigma_{N}^{2} = \\sum_k \\langle\\hat{n}_k^2\\rangle - \\sum_k \\langle\\hat{n}_k\\rangle^2 = \\sum_k \\left(\\langle\\hat{n}_k^2\\rangle - \\langle\\hat{n}_k\\rangle^2\\right) = \\sum_k \\sigma_{\\hat{n}_k}^2\n$$\nThe total variance is the sum of the variances for each pair level. The state for level $k$ is a superposition of having $0$ particles (with probability $u_k^2$) and $2$ particles (with probability $v_k^2$). We can calculate $\\langle\\hat{n}_k^2\\rangle$ from this property.\n$$\n\\langle\\hat{n}_k^2\\rangle = (0^2) u_k^2 + (2^2) v_k^2 = 4v_k^2\n$$\nThe variance for level $k$ is:\n$$\n\\sigma_{\\hat{n}_k}^2 = \\langle\\hat{n}_k^2\\rangle - \\langle\\hat{n}_k\\rangle^2 = 4v_k^2 - (2v_k^2)^2 = 4v_k^2 - 4v_k^4 = 4v_k^2(1 - v_k^2)\n$$\nUsing the normalization $u_k^2 + v_k^2 = 1$, we get $1 - v_k^2 = u_k^2$.\n$$\n\\sigma_{\\hat{n}_k}^2 = 4u_k^2v_k^2\n$$\nThe total particle-number variance is the sum over all levels:\n$$\n\\sigma_{N}^{2} = \\sum_{k=1}^{K} 4u_k^2v_k^2\n$$\nThis completes the first part of the problem.\n\n### Part 2: Numerical Evaluation\n\nFor the second part, we must relate the BCS amplitudes $\\{u_k, v_k\\}$ to the physical parameters of the model. The standard relations in BCS theory are:\n$$\nv_k^2 = \\frac{1}{2}\\left(1 - \\frac{\\xi_k}{E_k}\\right) \\quad \\text{and} \\quad u_k^2 = \\frac{1}{2}\\left(1 + \\frac{\\xi_k}{E_k}\\right)\n$$\nwhere $E_k = \\sqrt{\\xi_k^2 + \\Delta^2}$ is the quasiparticle energy for level $k$, $\\xi_k = \\epsilon_k - \\mu$ is the single-particle energy relative to the chemical potential $\\mu$, and $\\Delta$ is the pairing gap.\n\nWe substitute these relations into the expression for $\\sigma_N^2$:\n$$\n4u_k^2v_k^2 = 4 \\left[\\frac{1}{2}\\left(1 + \\frac{\\xi_k}{E_k}\\right)\\right] \\left[\\frac{1}{2}\\left(1 - \\frac{\\xi_k}{E_k}\\right)\\right] = \\left(1 - \\frac{\\xi_k^2}{E_k^2}\\right)\n$$\nNow, using $E_k^2 = \\xi_k^2 + \\Delta^2$:\n$$\n4u_k^2v_k^2 = 1 - \\frac{\\xi_k^2}{\\xi_k^2 + \\Delta^2} = \\frac{(\\xi_k^2 + \\Delta^2) - \\xi_k^2}{\\xi_k^2 + \\Delta^2} = \\frac{\\Delta^2}{\\xi_k^2 + \\Delta^2}\n$$\nThe total variance is then given by the sum:\n$$\n\\sigma_{N}^{2} = \\sum_{k=1}^{K} \\frac{\\Delta^2}{\\xi_k^2 + \\Delta^2}\n$$\nNow we use the numerical values provided: $K = 6$, $\\Delta = 0.80\\ \\text{MeV}$, and $\\{\\xi_{k}\\} = \\{-1.5, -1.0, -0.5, +0.5, +1.0, +1.5\\}\\ \\text{MeV}$.\nThe square of the pairing gap is $\\Delta^2 = (0.80)^2 = 0.64\\ \\text{MeV}^2$.\nThe values for $\\xi_k^2$ are $\\{2.25, 1.00, 0.25, 0.25, 1.00, 2.25\\}\\ \\text{MeV}^2$.\nThe sum for $\\sigma_{N}^{2}$ consists of contributions from each of the $K=6$ levels. Due to the $\\xi_k^2$ dependence, the levels with $\\xi_k = \\pm c$ contribute equally.\n$$\n\\sigma_N^2 = \\frac{0.64}{(-1.5)^2 + 0.64} + \\frac{0.64}{(-1.0)^2 + 0.64} + \\frac{0.64}{(-0.5)^2 + 0.64} + \\frac{0.64}{(0.5)^2 + 0.64} + \\frac{0.64}{(1.0)^2 + 0.64} + \\frac{0.64}{(1.5)^2 + 0.64}\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{1.5^2 + 0.64} + \\frac{0.64}{1.0^2 + 0.64} + \\frac{0.64}{0.5^2 + 0.64} \\right)\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{2.25 + 0.64} + \\frac{0.64}{1.00 + 0.64} + \\frac{0.64}{0.25 + 0.64} \\right)\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{2.89} + \\frac{0.64}{1.64} + \\frac{0.64}{0.89} \\right)\n$$\nEvaluating the terms numerically:\n$$\n\\frac{0.64}{2.89} \\approx 0.221453\n$$\n$$\n\\frac{0.64}{1.64} \\approx 0.390244\n$$\n$$\n\\frac{0.64}{0.89} \\approx 0.719101\n$$\nSumming these contributions and multiplying by $2$:\n$$\n\\sigma_N^2 \\approx 2 (0.221453 + 0.390244 + 0.719101) = 2 (1.330798) = 2.661596\n$$\nRounding to four significant figures, we obtain $\\sigma_N^2 = 2.662$.", "answer": "$$\\boxed{2.662}$$", "id": "3594137"}, {"introduction": "We now transition from analytical and conceptual exercises to a computational application that addresses a key phenomenon in nuclear structure. Nuclear \"magic numbers\" correspond to large energy gaps between major shells, which lead to exceptionally stable nuclei. This practice involves a computational study to demonstrate how these shell gaps suppress pairing correlations, a behavior observed experimentally. By solving the BCS equations numerically, you will investigate the critical conditions under which pairing can be restored, providing a tangible link between the model's parameters and the physical reality of nuclear structure [@problem_id:3594147].", "problem": "You are tasked with writing a complete, runnable program that demonstrates suppression of pairing correlations at a closed (magic) shell in a nuclear two-shell model using the Bardeen-Cooper-Schrieffer (BCS) framework and quantifies how a small increase in the constant pairing strength or inclusion of cross-shell coupling restores a nonzero pairing gap. The physical content must be implemented in a mathematically explicit and unit-consistent way so that the logic alone suffices to produce correct numerical outputs.\n\nAssume a reduced Bardeen-Cooper-Schrieffer (BCS) Hamiltonian with a constant pairing interaction of magnitude $G$ that scatters time-reversed pairs among single-particle levels. Consider a two-shell model with single-particle energies $\\{\\epsilon_k\\}$ measured in megaelectronvolts (MeV), pair-degeneracies $\\{\\Omega_k\\}$ (the number of distinct time-reversed pairs in level $k$), and a total particle number $N$. At zero temperature, the BCS equations are\n$$\n\\Delta = G \\sum_{k} \\Omega_k u_k v_k,\n$$\n$$\nN = 2 \\sum_{k} \\Omega_k v_k^2,\n$$\nwith\n$$\nu_k^2 = \\tfrac{1}{2}\\left(1 + \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nv_k^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2},\n$$\nwhere $\\Delta$ is the pairing gap and $\\mu$ is the chemical potential. For a constant interaction, one can eliminate the explicit $u_k v_k$ factors and write the gap equation in the standard form\n$$\n1 = G \\sum_{k} \\frac{\\Omega_k}{2 E_k}.\n$$\nFor a closed (magic) shell in a two-shell model with a large major shell gap, if only the lower shell is included (no cross-shell matrix elements), the lower shell is completely filled and the upper shell is absent from the pairing space; in that case, no scattering of pairs across the shell gap is possible and the only self-consistent solution is $\\Delta = 0$.\n\nBy contrast, when both the lower and upper shells are included in the pairing space (cross-shell matrix elements are included), a nontrivial solution $\\Delta \\neq 0$ appears only if the pairing strength exceeds a critical value determined by the linearized gap equation at $\\Delta \\to 0$. For a two-level model with energies $\\epsilon_L = -E_{\\text{gap}}/2$ and $\\epsilon_U = +E_{\\text{gap}}/2$ and pair-degeneracies $\\Omega_L$ and $\\Omega_U$, at the magic number $N = 2 \\Omega_L$ the chemical potential $\\mu$ lies in the gap at $\\Delta = 0$, and the critical coupling is\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}.\n$$\nFor $G \\le G_c$ the only solution is $\\Delta = 0$; for $G  G_c$ a finite $\\Delta$ emerges from the self-consistent solution of the coupled equations for $\\Delta$ and $\\mu$.\n\nYour program must:\n- Implement the zero-temperature Bardeen-Cooper-Schrieffer (BCS) equations above in a two-shell model and solve for $\\Delta$ and $\\mu$ self-consistently when the nontrivial solution exists.\n- Detect suppression of pairing at a magic number with a large shell gap when the upper shell is excluded (no cross-shell coupling).\n- Quantify restoration of a nonzero $\\Delta$ under two distinct changes: (i) inclusion of cross-shell matrix elements at fixed $G$, and (ii) a small increase of $G$ across the critical threshold when cross-shell coupling is included.\n- Use the units megaelectronvolts (MeV) consistently and report the pairing gap in MeV.\n\nNumerical method requirements:\n- When both shells are included, you must determine whether a nontrivial solution exists by analyzing the linearized gap equation at $\\Delta \\to 0$. For the two-shell case described above, use the mid-gap chemical potential $\\mu = 0$ to evaluate the linearized criterion. If $G \\le G_c$, return $\\Delta = 0$. If $G  G_c$, solve the coupled equations numerically for $\\Delta$ and $\\mu$.\n- When only the lower shell is included (no cross-shell coupling) at the magic particle number, return $\\Delta = 0$ without attempting a numerical solution.\n- For a nontrivial solution, solve the coupled equations for $\\Delta$ and $\\mu$ by any robust numerical method suitable for nonlinear systems. The final reported $\\Delta$ must be accurate to within $10^{-6}$ MeV.\n\nTest suite:\nUse the following four test cases. In every case, the energies are measured in MeV and the output must be the pairing gap $\\Delta$ in MeV. The particle number is set to the magic value corresponding to a completely filled lower shell.\n\n- Test case A (suppression at magic number without cross-shell coupling):\n  - Lower shell only: $\\{\\epsilon_L\\} = \\{-2.0\\}$, $\\{\\Omega_L\\} = \\{8\\}$.\n  - Upper shell excluded.\n  - Major shell gap parameter for reference: $E_{\\text{gap}} = 4.0$.\n  - Particle number: $N = 2 \\Omega_L = 16$.\n  - Pairing strength: $G = 0.18$.\n  - Expected behavior: $\\Delta = 0$.\n\n- Test case B (restoration by including cross-shell coupling at fixed $G$):\n  - Both shells included: $\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$, so $E_{\\text{gap}} = 4.0$.\n  - Particle number: $N = 16$.\n  - Pairing strength: $G = 0.18$.\n  - Expected behavior: $G  G_c = E_{\\text{gap}}/(\\Omega_L+\\Omega_U) = 4.0/(8+16) = 0.166\\overline{6}$, so $\\Delta  0$.\n\n- Test case C (below-threshold $G$ with cross-shell coupling):\n  - Both shells included: $\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$.\n  - Particle number: $N = 16$.\n  - Pairing strength: $G = 0.16$.\n  - Expected behavior: $G  G_c$, so $\\Delta = 0$.\n\n- Test case D (small increase of $G$ across threshold with cross-shell coupling):\n  - Both shells included: $\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$.\n  - Particle number: $N = 16$.\n  - Pairing strength: $G = 0.17$.\n  - Expected behavior: $G  G_c$ by a small margin, so $\\Delta  0$ but small.\n\nFinal output requirements:\n- For each test case, compute the pairing gap $\\Delta$ in MeV.\n- Express each $\\Delta$ as a float rounded to exactly six decimal places (MeV).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [A, B, C, D]. For example, a valid output format is\n\"[0.000000,0.123456,0.000000,0.012345]\".", "solution": "The problem requires the implementation and solution of the zero-temperature Bardeen-Cooper-Schrieffer (BCS) equations for a two-shell nuclear model to demonstrate and quantify pairing correlations. We must solve for the pairing gap $\\Delta$ and the chemical potential $\\mu$ under different physical conditions.\n\nThe fundamental equations governing the system are the BCS gap equation and the number conservation equation. For a set of single-particle levels indexed by $k$, with energies $\\epsilon_k$ and pair-degeneracies $\\Omega_k$ (i.e., the number of pairs that can occupy the level), the equations are:\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 E_k} \\quad (\\text{for } \\Delta \\neq 0)\n$$\n$$\nN = \\sum_{k} \\Omega_k \\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right)\n$$\nwhere $G$ is the constant pairing strength, $N$ is the total number of particles, $\\mu$ is the chemical potential, and $E_k$ is the quasiparticle energy for level $k$:\n$$\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}\n$$\nThe variables to be solved for are the pairing gap $\\Delta$ and the chemical potential $\\mu$. The pairing gap $\\Delta$ is, by convention, a non-negative quantity.\n\nThe problem specifies four test cases which fall into distinct physical scenarios. We will analyze each scenario based on the provided model parameters.\n\n**Scenario 1: Single Filled Shell (Test Case A)**\nThis case involves a single shell, designated as the lower shell ($L$), with energy $\\epsilon_L = -2.0$ MeV and pair-degeneracy $\\Omega_L = 8$. The particle number is $N = 16$. This number corresponds exactly to filling the shell, since $N = 2 \\Omega_L = 2 \\times 8 = 16$. The upper shell is explicitly excluded from the model space.\n\nIn the BCS model, pairing arises from the scattering of pairs of particles between different single-particle levels. When only one shell is present and it is completely filled, there are no available empty states for pairs to scatter into, and no pairs from other levels to scatter from. This situation is known as \"blocking\". The pairing interaction is rendered ineffective, and no pairing correlation can be established. The only self-consistent solution to the BCS equations in this configuration is a trivial one, where the pairing gap is zero.\nTherefore, for Test Case A, we conclude $\\Delta = 0$ MeV without the need for a numerical calculation.\n\n**Scenario 2: Two-Shell Model at Magic Number (Test Cases B, C, D)**\nThese cases involve a two-shell model with a lower shell ($L$) and an upper shell ($U$). The parameters are:\n-   Energies: $\\epsilon_L = -2.0$ MeV, $\\epsilon_U = +2.0$ MeV. The major shell gap is $E_{\\text{gap}} = \\epsilon_U - \\epsilon_L = 4.0$ MeV.\n-   Degeneracies: $\\Omega_L = 8$, $\\Omega_U = 16$.\n-   Particle Number: $N = 16 = 2 \\Omega_L$. This is a \"magic\" number corresponding to a filled lower shell.\n\nIn this scenario, even though the lower shell is filled, the presence of the empty upper shell provides states into which pairs can scatter. A non-trivial pairing solution ($\\Delta  0$) can exist if the pairing strength $G$ is sufficiently large to overcome the energy cost of promoting pairs across the shell gap $E_{\\text{gap}}$.\n\nThe transition from a trivial solution ($\\Delta = 0$) to a non-trivial one ($\\Delta  0$) occurs at a critical pairing strength, $G_c$. To find $G_c$, we analyze the gap equation in the limit $\\Delta \\to 0$. In this limit, the equation becomes:\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 |\\epsilon_k - \\mu|}\n$$\nFor the specific particle number $N = 2 \\Omega_L$ in a symmetric two-level model ($\\epsilon_L = -\\epsilon_U$), the chemical potential at the onset of pairing lies exactly in the middle of the gap, i.e., $\\mu = 0$. Substituting the parameters for the two-shell model:\n$$\n\\frac{1}{G_c} = \\frac{\\Omega_L}{2 |\\epsilon_L - 0|} + \\frac{\\Omega_U}{2 |\\epsilon_U - 0|} = \\frac{\\Omega_L}{2 (\\frac{E_{\\text{gap}}}{2})} + \\frac{\\Omega_U}{2 (\\frac{E_{\\text{gap}}}{2})} = \\frac{\\Omega_L + \\Omega_U}{E_{\\text{gap}}}\n$$\nThis gives the critical coupling:\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}\n$$\nFor our specific parameters, $E_{\\text{gap}} = 4.0$ MeV, $\\Omega_L = 8$, and $\\Omega_U = 16$, the critical strength is:\n$$\nG_c = \\frac{4.0}{8 + 16} = \\frac{4.0}{24} = \\frac{1}{6} \\approx 0.166667 \\text{ MeV}\n$$\nThe formal condition is:\n-   If $G \\le G_c$, the only solution is the trivial one, $\\Delta = 0$.\n-   If $G  G_c$, a non-trivial solution with $\\Delta  0$ exists and must be found by solving the coupled BCS equations numerically.\n\nWe now apply this criterion to the remaining test cases.\n\n**Test Case C:** $G = 0.16$ MeV.\nSince $0.16  1/6$, the pairing strength is sub-critical. Thus, $\\Delta = 0$ MeV.\n\n**Test Cases B and D:** $G = 0.18$ MeV and $G = 0.17$ MeV, respectively.\nIn both cases, the pairing strength $G$ is greater than $G_c \\approx 0.166667$ MeV. Therefore, a non-trivial solution with $\\Delta  0$ exists. To find it, we must solve the following system of two non-linear equations for the two unknowns, $\\Delta$ and $\\mu$:\n$$\nf_1(\\Delta, \\mu) = \\frac{1}{G} - \\frac{\\Omega_L}{2 \\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}} - \\frac{\\Omega_U}{2 \\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}} = 0\n$$\n$$\nf_2(\\Delta, \\mu) = N - \\Omega_L \\left(1 - \\frac{\\epsilon_L - \\mu}{\\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}}\\right) - \\Omega_U \\left(1 - \\frac{\\epsilon_U - \\mu}{\\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}}\\right) = 0\n$$\nThis system is solved using a numerical root-finding algorithm, such as `scipy.optimize.root` in Python. An appropriate initial guess for the solver is essential. Since we are near the critical point, we expect $\\Delta$ to be small and $\\mu$ to be close to $0$. A reasonable initial guess is $(\\Delta_0, \\mu_0) = (0.1, 0.0)$. The solver iteratively refines this guess until the residuals $f_1$ and $f_2$ are simultaneously close to zero, meeting the specified tolerance of $10^{-6}$ MeV for the final $\\Delta$.\n\n**Summary of Approach per Case:**\n-   **Case A**: One filled shell, no upper shell. Pairing is blocked. Result: $\\Delta = 0.0$.\n-   **Case B**: Two shells, $G=0.18  G_c$. A non-trivial pairing gap $\\Delta  0$ forms. Result: Solve numerically.\n-   **Case C**: Two shells, $G=0.16  G_c$. Pairing is sub-critical. Result: $\\Delta = 0.0$.\n-   **Case D**: Two shells, $G=0.17  G_c$. Pairing is just super-critical, forming a small but non-zero gap $\\Delta  0$. Result: Solve numerically.\n\nThe implementation will follow this logic precisely, using `scipy.optimize.root` for the numerical solutions required in Cases B and D.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the BCS equations for four test cases representing pairing suppression\n    and restoration in a nuclear two-shell model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Lower shell only, magic number\n        {\n            \"name\": \"A\",\n            \"shells\": {\"eps\": np.array([-2.0]), \"omg\": np.array([8])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"one_shell_magic\"\n        },\n        # Case B: Both shells, G > Gc\n        {\n            \"name\": \"B\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"two_shell\"\n        },\n        # Case C: Both shells, G  Gc\n        {\n            \"name\": \"C\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.16,\n            \"type\": \"two_shell\"\n        },\n        # Case D: Both shells, G slightly > Gc\n        {\n            \"name\": \"D\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.17,\n            \"type\": \"two_shell\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        delta_val = 0.0\n        \n        if case[\"type\"] == \"one_shell_magic\":\n            # For a single, completely filled shell, pairing is blocked.\n            # The particle number N = 16 equals 2 * Omega_L = 2 * 8.\n            # The only solution is the trivial one.\n            delta_val = 0.0\n        \n        elif case[\"type\"] == \"two_shell\":\n            eps = case[\"shells\"][\"eps\"]\n            omg = case[\"shells\"][\"omg\"]\n            G = case[\"G\"]\n            N = case[\"N\"]\n            \n            # For a two-shell model at the magic number N=2*Omega_L, a non-trivial\n            # solution exists only if G > Gc.\n            E_gap = eps[1] - eps[0]\n            G_c = E_gap / np.sum(omg)\n            \n            if G = G_c:\n                # Pairing strength is sub-critical.\n                delta_val = 0.0\n            else:\n                # Pairing strength is super-critical. Solve the coupled equations.\n                \n                def bcs_system(variables, G_val, eps_vals, omg_vals, N_val):\n                    \"\"\"\n                    Defines the system of coupled BCS equations to be solved.\n                    variables = [Delta, mu]\n                    \"\"\"\n                    delta, mu = variables[0], variables[1]\n                    \n                    # Ensure Delta is positive, as it appears squared.\n                    # The solver might take a negative step, but the physical gap is positive.\n                    # Also handles the case where delta is ~0 to avoid division by zero.\n                    if np.isclose(delta, 0.0):\n                        delta = 1e-12 \n\n                    # Quasiparticle energies\n                    E_k = np.sqrt((eps_vals - mu)**2 + delta**2)\n                    \n                    # Gap equation residual\n                    # 1/G = sum(Omega_k / (2*E_k))\n                    gap_eq_residual = 1.0/G_val - np.sum(omg_vals / (2.0 * E_k))\n                    \n                    # Number equation residual\n                    # N = sum(Omega_k * (1 - (eps_k-mu)/E_k))\n                    num_eq_residual = N_val - np.sum(omg_vals * (1.0 - (eps_vals - mu) / E_k))\n                    \n                    return [gap_eq_residual, num_eq_residual]\n\n                # Initial guess [Delta, mu]. Near the critical point, Delta is small\n                # and mu is close to the mid-gap value (0).\n                initial_guess = [0.1, 0.0]\n                \n                # Solve the system of non-linear equations\n                solution = root(\n                    bcs_system, \n                    initial_guess, \n                    args=(G, eps, omg, N),\n                    method='hybr',  # A robust method for such problems\n                    tol=1e-9       # Tolerance for high accuracy\n                )\n                \n                if solution.success:\n                    # The pairing gap Delta is conventionally taken as positive.\n                    delta_val = abs(solution.x[0])\n                else:\n                    # This should not happen for the given well-posed problems.\n                    # As a fallback, report a negative value to indicate solver failure.\n                    delta_val = -1.0 \n\n        results.append(delta_val)\n\n    # Format the results to exactly six decimal places and print in the specified format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3594147"}]}