{"hands_on_practices": [{"introduction": "This first exercise provides a direct link between the abstract formalism of the scattering matrix ($S$-matrix) and tangible physical observables. Given a numerically computed $S$-matrix element for a single partial wave, you will apply the principle of flux conservation (unitarity) to determine the transmission coefficient $T_l(E)$. This practice [@problem_id:3548631] reinforces the fundamental concept that transmission represents the probability of non-elastic processes, or flux lost from the elastic channel, and connects it directly to the reaction cross section.", "problem": "In the optical-model description of nucleon–nucleus scattering, the partial-wave scattering matrix (scattering matrix, S-matrix) for angular momentum $l$ at energy $E$ can be written as $S_{l}(E)=\\eta_{l}(E)\\exp\\!\\big(2 i \\delta_{l}(E)\\big)$, where $0 \\le \\eta_{l}(E) \\le 1$ encodes inelasticity and $\\delta_{l}(E)$ is a real phase shift. The transmission coefficient $T_{l}(E)$ represents the probability for reaction (non-elastic processes) in the $l$th partial wave and is constrained by flux conservation. The contribution of a single partial wave $l$ to the reaction cross section $\\Delta \\sigma_{\\text{reac}}$ depends on $T_{l}(E)$ and the wave number $k$.\n\nA numerical computation for a complex optical potential yields $S_{l}(E)=0.7\\,\\exp(2 i \\tau)$ at wave number $k=1.0\\ \\text{fm}^{-1}$ for $l=2$, where $\\tau$ is a real number. Starting from the standard partial-wave unitarity and flux-conservation principles, determine the transmission coefficient $T_{l}(E)$ for this partial wave and the corresponding single-partial-wave contribution $\\Delta \\sigma_{\\text{reac}}$ to the reaction cross section. Express $\\Delta \\sigma_{\\text{reac}}$ in millibarns, using $1\\ \\text{barn}=100\\ \\text{fm}^{2}$ and $1\\ \\text{millibarn}=10^{-3}\\ \\text{barn}$. Round the reaction cross section contribution to four significant figures. Provide your final result as two values: $T_{l}(E)$ and $\\Delta \\sigma_{\\text{reac}}$ in millibarns.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard calculation within the framework of quantum scattering theory and the nuclear optical model. All provided information is consistent and sufficient for a unique solution.\n\nThe problem asks for the calculation of two quantities for a specific partial wave: the transmission coefficient $T_{l}(E)$ and the contribution to the reaction cross section $\\Delta \\sigma_{\\text{reac}}$. We are given the partial-wave scattering matrix element $S_{l}(E)$ for angular momentum $l=2$ at a wave number $k=1.0\\ \\text{fm}^{-1}$.\n\nThe scattering matrix element is given in its general form as $S_{l}(E)=\\eta_{l}(E)\\exp\\!\\big(2 i \\delta_{l}(E)\\big)$, where $\\eta_{l}(E)$ is the inelasticity parameter and $\\delta_{l}(E)$ is the real phase shift. The value provided by a numerical computation is $S_{l=2}(E)=0.7\\,\\exp(2 i \\tau)$, where $\\tau$ is a real number. By comparing the general form with the given value, we can identify the inelasticity parameter for this specific partial wave and energy:\n$$\n\\eta_{l=2}(E) = |S_{l=2}(E)| = |0.7\\,\\exp(2 i \\tau)| = 0.7\n$$\nThe condition $0 \\le \\eta_{l}(E) \\le 1$ is satisfied, as $0 \\le 0.7 \\le 1$. An inelasticity parameter less than $1$ signifies that there is flux loss from the elastic channel, which corresponds to the occurrence of reactions (non-elastic processes).\n\nThe transmission coefficient, $T_{l}(E)$, represents the probability that an incident particle in the partial wave $l$ will undergo a reaction. From the principle of flux conservation (unitarity of the S-matrix), the total probability for an incident particle must be unity. The particle can either scatter elastically or react. The probability of elastic scattering for a given partial wave is given by $|S_{l}(E)|^2$. Therefore, the probability of reaction must be the remaining fraction:\n$$\nT_{l}(E) = 1 - |S_{l}(E)|^2\n$$\nUsing the relationship $|S_{l}(E)| = \\eta_{l}(E)$, this can be written as:\n$$\nT_{l}(E) = 1 - \\eta_{l}(E)^2\n$$\nFor the given partial wave $l=2$, we have $\\eta_{l=2}(E) = 0.7$. Substituting this value into the equation for the transmission coefficient:\n$$\nT_{l=2}(E) = 1 - (0.7)^2 = 1 - 0.49 = 0.51\n$$\nThis is the first required quantity.\n\nThe second required quantity is the contribution of this single partial wave to the total reaction cross section, denoted as $\\Delta \\sigma_{\\text{reac}}$. The standard formula for the partial-wave reaction cross section is:\n$$\n\\Delta \\sigma_{\\text{reac}} = \\sigma_{\\text{reac}, l} = \\frac{\\pi}{k^2} (2l+1) T_{l}(E)\n$$\nWe are given the wave number $k=1.0\\ \\text{fm}^{-1}$, the angular momentum quantum number $l=2$, and we have just calculated the transmission coefficient $T_{l=2}(E) = 0.51$. Substituting these values into the formula:\n$$\n\\Delta \\sigma_{\\text{reac}} = \\frac{\\pi}{(1.0\\ \\text{fm}^{-1})^2} (2(2)+1) (0.51)\n$$\n$$\n\\Delta \\sigma_{\\text{reac}} = \\frac{\\pi}{1.0\\ \\text{fm}^{-2}} (5) (0.51)\n$$\n$$\n\\Delta \\sigma_{\\text{reac}} = 2.55 \\pi\\ \\text{fm}^2\n$$\nNow, we must convert this result into the requested units of millibarns (mb). The conversion factors are given:\n$1\\ \\text{barn} = 100\\ \\text{fm}^2$\n$1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn}$\n\nFrom these, we can derive the direct conversion between $\\text{fm}^2$ and $\\text{mb}$:\n$$\n1\\ \\text{mb} = 10^{-3} \\times (100\\ \\text{fm}^2) = 10^{-1}\\ \\text{fm}^2 = 0.1\\ \\text{fm}^2\n$$\nTherefore, to convert from $\\text{fm}^2$ to $\\text{mb}$, we must multiply by a factor of $10$:\n$$\n1\\ \\text{fm}^2 = 10\\ \\text{mb}\n$$\nApplying this conversion to our result for $\\Delta \\sigma_{\\text{reac}}$:\n$$\n\\Delta \\sigma_{\\text{reac}} = (2.55 \\pi\\ \\text{fm}^2) \\times \\left(\\frac{10\\ \\text{mb}}{1\\ \\text{fm}^2}\\right) = 25.5 \\pi\\ \\text{mb}\n$$\nCalculating the numerical value:\n$$\n\\Delta \\sigma_{\\text{reac}} \\approx 25.5 \\times 3.14159265... \\text{ mb} \\approx 80.110612... \\text{ mb}\n$$\nThe problem requires this value to be rounded to four significant figures. The first four significant figures are $8$, $0$, $1$, and $1$. The fifth digit is $0$, so we do not round up.\n$$\n\\Delta \\sigma_{\\text{reac}} \\approx 80.11\\ \\text{mb}\n$$\nThe two final values are $T_{l=2}(E) = 0.51$ and $\\Delta \\sigma_{\\text{reac}} = 80.11\\ \\text{mb}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.51 & 80.11 \\end{pmatrix}}\n$$", "id": "3548631"}, {"introduction": "Building on the conceptual foundation, this practice moves into the realm of computational physics by having you implement the workhorse of 1D scattering problems: the transfer matrix method. You will construct a program from first principles to calculate the transmission coefficient through a symmetric double-barrier potential, a quantum system rich with phenomena like resonant tunneling. This hands-on coding exercise [@problem_id:3548674] is essential for developing an intuitive feel for how wave interference governs transmission and for building a reusable tool for more complex scattering scenarios.", "problem": "You are asked to design and implement a complete, runnable program that computes one-dimensional quantum transmission coefficients through a symmetric double-barrier potential that serves as a toy model of two-step nuclear fission. The model should capture coherent interference across an intermediate well and reveal conditions under which destructive interference suppresses tunneling. Work strictly in natural units where $\\hbar^2/(2m)=1$, so that energy, length, and wave number are dimensionless. Transmission is dimensionless and must be reported as a decimal number. Angles must be interpreted in radians.\n\nStarting from the stationary one-dimensional Schrödinger equation $-\\dfrac{d^2\\psi}{dx^2}+V(x)\\psi=E\\psi$, use continuity of the wave function and its spatial derivative at interfaces to derive an algorithm to compute the transmission coefficient $T(E)$ for a piecewise-constant potential composed of planar layers. Your implementation must support complex wave numbers for classically forbidden regions and track phase accumulation across each region.\n\nConstruct a symmetric double-barrier potential with two identical rectangular barriers of height $V_0$ and width $a$, separated by a central well of width $b$ and potential $V_w$. The left and right leads are free regions with $V=0$. All quantities are dimensionless in the chosen units.\n\nYour program must implement a numerically stable, general transfer approach based on the fundamental boundary conditions of the Schrödinger equation. The algorithm should accept any list of contiguous layers $(V_j,d_j)$ and compute $T(E)$ by matching plane-wave solutions across all interfaces, forming a total transfer operator from the left lead to the right lead, and using flux normalization in the leads to obtain the transmission coefficient. Do not use any pre-tabulated special-case formulas; derive your relations directly from continuity and plane waves.\n\nTest suite. Use the following parameter sets and energies. Compute and aggregate the specified outputs in the exact order. All numbers given are dimensionless.\n\n- Set $\\mathrm{S1}$ (symmetric double barrier): $V_0=5.0$, $a=1.0$, $V_w=0.0$, $b=4.0$. Evaluate at two energies:\n  - $E_{\\mathrm{S1},d}=3.853981633974483$.\n  - $E_{\\mathrm{S1},c}=2.4674011002723395$.\n  For $\\mathrm{S1}$, report:\n  - $T(E_{\\mathrm{S1},d})$.\n  - $T(E_{\\mathrm{S1},c})$.\n  - A boolean indicating whether $T(E_{\\mathrm{S1},d})/T(E_{\\mathrm{S1},c})<0.01$.\n\n- Set $\\mathrm{S2}$ (barrier merging limit): $V_0=5.0$, $a=1.0$, $V_w=0.0$, $b=1.0\\times 10^{-6}$. At $E=1.0$, compute:\n  - $T_{\\mathrm{dbl}}$, the transmission of the symmetric double barrier with $b=1.0\\times 10^{-6}$.\n  - $T_{\\mathrm{sgl}}$, the transmission of a single rectangular barrier of height $V_0=5.0$ and width $2a=2.0$ between the same leads.\n  Report a boolean indicating $\\lvert T_{\\mathrm{dbl}}-T_{\\mathrm{sgl}}\\rvert<10^{-6}$.\n\n- Set $\\mathrm{S3}$ (high-energy limit using $\\mathrm{S1}$ geometry): with $V_0=5.0$, $a=1.0$, $V_w=0.0$, $b=4.0$ at $E=50.0$, report $T(50.0)$.\n\n- Set $\\mathrm{S4}$ (raised intermediate well): $V_0=5.0$, $a=1.0$, $V_w=1.0$, $b=4.0$ at $E_{\\mathrm{S4},d}=4.853981633974483$, report $T(E_{\\mathrm{S4},d})$.\n\nFinal output format. Your program should produce a single line of output containing a comma-separated list enclosed in square brackets with the following entries in order:\n- $T(E_{\\mathrm{S1},d})$,\n- $T(E_{\\mathrm{S1},c})$,\n- the boolean for suppression in $\\mathrm{S1}$,\n- the boolean for the barrier-merging limit $\\mathrm{S2}$,\n- $T(50.0)$ for $\\mathrm{S3}$,\n- $T(E_{\\mathrm{S4},d})$ for $\\mathrm{S4}$.\n\nFor example, the output format must look like $[x_1,x_2,\\mathrm{True},\\mathrm{False},x_5,x_6]$ with the actual numerical values for the floats in place of $x_j$.\n\nThe quantities to report are dimensionless; do not attach units. All angles used internally are in radians. The final program must be self-contained and must not read input files or require user interaction. The final printed line should be exactly in the specified bracketed list format.", "solution": "The problem requires the design and implementation of an algorithm to calculate the quantum mechanical transmission coefficient, $T(E)$, for a particle of energy $E$ incident on a one-dimensional piecewise-constant potential. The method must be derived from first principles, namely the time-independent Schrödinger equation and the continuity of the wave function and its derivative. We work in a system of natural units where $\\hbar^2/(2m)=1$.\n\nThe one-dimensional time-independent Schrödinger equation for a particle of mass $m$ and energy $E$ in a potential $V(x)$ is:\n$$-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)$$\nIn the specified units, this simplifies to:\n$$-\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x) \\quad \\implies \\quad \\frac{d^2\\psi(x)}{dx^2} = -(E - V(x))\\psi(x)$$\n\nFor a piecewise-constant potential, the spatial domain is divided into regions where $V(x)$ is a constant, say $V_j$. Within each such region $j$, the equation becomes:\n$$\\frac{d^2\\psi_j(x)}{dx^2} = -k_j^2 \\psi_j(x)$$\nwhere the wave number $k_j$ is defined as $k_j = \\sqrt{E - V_j}$. If $E < V_j$, $k_j$ is a purely imaginary number, $k_j = i\\kappa_j$ where $\\kappa_j = \\sqrt{V_j - E}$. To handle all cases uniformly, we treat $k_j$ as a complex number. The general solution in region $j$ is a superposition of forward and backward traveling plane waves:\n$$\\psi_j(x) = A_j e^{ik_j x} + B_j e^{-ik_j x}$$\n\nThe core of the specified algorithm is the transfer matrix method. This method relates the state of the wave function—described by the vector of its value and its spatial derivative, $\\mathbf{S}(x) = \\begin{pmatrix} \\psi(x) \\\\ \\psi'(x) \\end{pmatrix}$—at two different points in space.\n\nConsider a single potential layer $j$ of constant potential $V_j$ extending from $x_{j-1}$ to $x_j$, with width $d_j = x_j - x_{j-1}$. We can establish a matrix relationship between the state vector at the beginning and the end of this layer.\nThe state vector at any point $x$ within the layer can be expressed in terms of the coefficients $A_j$ and $B_j$ (using a local coordinate $x' = x-x_{j-1}$):\n$$\\psi_j(x') = A_j e^{ik_j x'} + B_j e^{-ik_j x'}$$\n$$\\psi'_j(x') = ik_j(A_j e^{ik_j x'} - B_j e^{-ik_j x'})$$\n\nBy algebraic manipulation, we can express the state vector at $x' = d_j$ in terms of the state vector at $x' = 0$:\n$$\\psi_j(d_j) = \\psi_j(0) \\cos(k_j d_j) + \\psi'_j(0) \\frac{\\sin(k_j d_j)}{k_j}$$\n$$\\psi'_j(d_j) = -\\psi_j(0) k_j \\sin(k_j d_j) + \\psi'_j(0) \\cos(k_j d_j)$$\nThis can be written in matrix form:\n$$\\begin{pmatrix} \\psi(x_j) \\\\ \\psi'(x_j) \\end{pmatrix} = \\mathbf{M}_j \\begin{pmatrix} \\psi(x_{j-1}) \\\\ \\psi'(x_{j-1}) \\end{pmatrix}$$\nwhere $\\mathbf{M}_j$ is the transfer matrix for the layer $j$:\n$$\\mathbf{M}_j = \\begin{pmatrix} \\cos(k_j d_j) & \\frac{\\sin(k_j d_j)}{k_j} \\\\ -k_j \\sin(k_j d_j) & \\cos(k_j d_j) \\end{pmatrix}$$\nThis form is numerically stable and general. For the special case where $E=V_j$, one has $k_j=0$. In this limit, $\\cos(k_j d_j) \\to 1$, and $\\sin(k_j d_j)/k_j \\to d_j$, yielding the matrix $\\mathbf{M}_j = \\begin{pmatrix} 1 & d_j \\\\ 0 & 1 \\end{pmatrix}$, which corresponds to the solution of $\\psi''=0$. The determinant of $\\mathbf{M}_j$ is always $1$.\n\nFor a potential composed of $N$ contiguous layers starting at $x=0$ and ending at $x=L$, the total transfer matrix $\\mathbf{M}_{\\mathrm{total}}$ is the product of the individual layer matrices:\n$$\\mathbf{M}_{\\mathrm{total}} = \\mathbf{M}_N \\mathbf{M}_{N-1} \\cdots \\mathbf{M}_1$$\nThis total matrix relates the state vector at the beginning of the structure ($x=0$) to the end ($x=L$):\n$$\\begin{pmatrix} \\psi(L) \\\\ \\psi'(L) \\end{pmatrix} = \\mathbf{M}_{\\mathrm{total}} \\begin{pmatrix} \\psi(0) \\\\ \\psi'(0) \\end{pmatrix}$$\n\nTo find the transmission coefficient $T$, we apply boundary conditions in the leads (where $V=0$). Let the potential structure be confined between $x=0$ and $x=L$.\n- For $x<0$ (left lead), the wave function is a sum of an incident wave (amplitude $A_0=1$) and a reflected wave (amplitude $B_0$):\n  $\\psi_{L}(x) = e^{ik_0 x} + B_0 e^{-ik_0 x}$, where $k_0 = \\sqrt{E}$.\n- For $x>L$ (right lead), there is only a transmitted wave (amplitude $C_N$), as particles are incident from the left:\n  $\\psi_{R}(x) = C_N e^{ik_0 (x-L)}$.\n\nAt the boundaries, the state vectors are:\n- At $x=0$: $\\psi(0) = 1 + B_0$, $\\psi'(0) = ik_0(1-B_0)$.\n- At $x=L$: $\\psi(L) = C_N$, $\\psi'(L) = ik_0 C_N$.\n\nTo find the transmission amplitude $t=C_N/A_0 = C_N$, it is more convenient to use the inverse relation:\n$$\\begin{pmatrix} \\psi(0) \\\\ \\psi'(0) \\end{pmatrix} = \\mathbf{M}_{\\mathrm{total}}^{-1} \\begin{pmatrix} \\psi(L) \\\\ \\psi'(L) \\end{pmatrix}$$\nSince $\\det(\\mathbf{M}_{\\mathrm{total}})=1$, the inverse is simple. Let $\\mathbf{M}_{\\mathrm{total}} = \\begin{pmatrix} M_{11} & M_{12} \\\\ M_{21} & M_{22} \\end{pmatrix}$, then $\\mathbf{M}_{\\mathrm{total}}^{-1} = \\begin{pmatrix} M_{22} & -M_{12} \\\\ -M_{21} & M_{11} \\end{pmatrix}$.\nSubstituting the boundary conditions:\n$$\\begin{pmatrix} 1+B_0 \\\\ ik_0(1-B_0) \\end{pmatrix} = \\begin{pmatrix} M_{22} & -M_{12} \\\\ -M_{21} & M_{11} \\end{pmatrix} \\begin{pmatrix} C_N \\\\ ik_0 C_N \\end{pmatrix}$$\nThis yields two equations:\n$1+B_0 = (M_{22} - ik_0 M_{12})C_N$\n$ik_0(1-B_0) = (-M_{21} + ik_0 M_{11})C_N$\nAdding $ik_0$ times the first equation to the second eliminates $B_0$:\n$ik_0(1+B_0) + ik_0(1-B_0) = ik_0(M_{22} - ik_0 M_{12})C_N + (-M_{21} + ik_0 M_{11})C_N$\n$2ik_0 = [ik_0 M_{22} + k_0^2 M_{12} - M_{21} + ik_0 M_{11}]C_N$\nSolving for the transmission amplitude $t = C_N$:\n$$t = \\frac{2ik_0}{(k_0^2 M_{12} - M_{21}) + i k_0 (M_{11} + M_{22})}$$\nThe transmission coefficient is the modulus squared of the amplitude, $T = |t|^2$:\n$$T(E) = \\frac{4 k_0^2}{|(k_0^2 M_{12} - M_{21}) + i k_0 (M_{11} + M_{22})|^2} = \\frac{4 k_0^2}{(k_0^2 M_{12} - M_{21})^2 + k_0^2 (M_{11} + M_{22})^2}$$\n\nThis provides a general algorithm. For each test case, we define the sequence of layers $(V_j, d_j)$, construct the total transfer matrix $\\mathbf{M}_{\\mathrm{total}}$, and then use the final formula to compute $T(E)$. Complex arithmetic is used throughout for $k_j$ and the matrix elements to ensure generality. The provided test cases probe specific physical phenomena: resonant tunneling ($T(E_{\\mathrm{S1},c})$), destructive interference ($T(E_{\\mathrm{S1},d})$, $T(E_{\\mathrm{S4},d})$), the merging of potential barriers (S2), and the high-energy limit (S3).", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum transmission problem for various potential configurations.\n    \"\"\"\n\n    def compute_transmission(energy, layers):\n        \"\"\"\n        Computes the transmission coefficient T(E) for a given energy and potential.\n\n        Args:\n            energy (float): The energy of the incident particle.\n            layers (list of tuples): A list of (potential, width) for each layer.\n\n        Returns:\n            float: The transmission coefficient T.\n        \"\"\"\n        # Ensure energy is a float to avoid type issues.\n        E = float(energy)\n\n        # Wave number in the leads (V=0)\n        # Use complex argument in sqrt to handle E<0 if necessary, though problem uses E>0.\n        k0 = np.sqrt(E + 0j)\n        if E == 0:\n            return 0.0\n\n        # Initialize total transfer matrix as identity\n        M_total = np.identity(2, dtype=complex)\n\n        # Multiply transfer matrices for each layer\n        for V, d in layers:\n            # Wave number in the layer\n            # Added 0j to ensure complex result for E < V\n            k = np.sqrt(E - V + 0j)\n\n            # Handle the case E = V where k = 0\n            if np.isclose(k, 0):\n                M_layer = np.array([[1, d],\n                                    [0, 1]], dtype=complex)\n            else:\n                # Use numpy.sinc which is sin(pi*x)/(pi*x)\n                # We need sin(k*d)/k = d * sin(k*d)/(k*d) = d * sinc(k*d/pi)\n                sinc_val = d * np.sinc(k * d / np.pi)\n                cos_val = np.cos(k * d)\n                \n                M_layer = np.array([[cos_val, sinc_val],\n                                    [-k * k * sinc_val, cos_val]], dtype=complex)\n\n            # Note the order of multiplication: new matrix is on the left\n            M_total = M_layer @ M_total\n\n        M11, M12 = M_total[0, 0], M_total[0, 1]\n        M21, M22 = M_total[1, 0], M_total[1, 1]\n\n        # Transmission amplitude t = C_N / A_0 (with A_0=1)\n        # t = (2*1j*k0) / ((k0**2 * M12 - M21) + 1j*k0*(M11 + M22))\n        denominator = (k0**2 * M12 - M21) + 1j * k0 * (M11 + M22)\n        \n        # Avoid division by zero, although physically unlikely for non-trivial barriers\n        if np.isclose(abs(denominator), 0):\n            # This would imply infinite transmission, a perfect resonance.\n            # However, due to finite precision, it's better to return a high value or handle based on context.\n            # The calculation of |t|^2 below will handle this by becoming large.\n            pass\n\n        transmission_amplitude = (2 * 1j * k0) / denominator\n        \n        # Transmission coefficient T = |t|^2\n        T = np.abs(transmission_amplitude)**2\n        return T\n\n    results = []\n\n    # --- Test Case S1: Symmetric Double Barrier ---\n    V0_s1, a_s1, Vw_s1, b_s1 = 5.0, 1.0, 0.0, 4.0\n    layers_s1 = [(V0_s1, a_s1), (Vw_s1, b_s1), (V0_s1, a_s1)]\n    \n    E_s1_d = 3.853981633974483\n    E_s1_c = 2.4674011002723395\n    \n    T_s1_d = compute_transmission(E_s1_d, layers_s1)\n    T_s1_c = compute_transmission(E_s1_c, layers_s1)\n    \n    results.append(T_s1_d)\n    results.append(T_s1_c)\n    \n    # Check for suppression\n    suppression_s1 = (T_s1_d / T_s1_c < 0.01) if T_s1_c > 1e-9 else False\n    results.append(suppression_s1)\n\n    # --- Test Case S2: Barrier Merging Limit ---\n    V0_s2, a_s2, Vw_s2, b_s2 = 5.0, 1.0, 0.0, 1.0e-6\n    E_s2 = 1.0\n    \n    # Double barrier with a tiny well\n    layers_s2_dbl = [(V0_s2, a_s2), (Vw_s2, b_s2), (V0_s2, a_s2)]\n    T_dbl = compute_transmission(E_s2, layers_s2_dbl)\n\n    # Single merged barrier\n    layers_s2_sgl = [(V0_s2, 2 * a_s2)]\n    T_sgl = compute_transmission(E_s2, layers_s2_sgl)\n\n    # Check for merging\n    merging_s2 = abs(T_dbl - T_sgl) < 1e-6\n    results.append(merging_s2)\n\n    # --- Test Case S3: High-Energy Limit ---\n    # Use S1 geometry\n    E_s3 = 50.0\n    T_s3 = compute_transmission(E_s3, layers_s1)\n    results.append(T_s3)\n    \n    # --- Test Case S4: Raised Intermediate Well ---\n    V0_s4, a_s4, Vw_s4, b_s4 = 5.0, 1.0, 1.0, 4.0\n    layers_s4 = [(V0_s4, a_s4), (Vw_s4, b_s4), (V0_s4, a_s4)]\n    E_s4_d = 4.853981633974483\n    \n    T_s4_d = compute_transmission(E_s4_d, layers_s4)\n    results.append(T_s4_d)\n\n\n    # Final print statement in the exact required format.\n    formatted_results = []\n    for res in results:\n        if isinstance(res, bool):\n            formatted_results.append(str(res))\n        else:\n            formatted_results.append(f\"{res:.8f}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3548674"}, {"introduction": "Our final practice tackles the challenges of modeling realistic nuclear interactions, which are often described by continuous, complex optical potentials. This exercise extends the transfer matrix method by discretizing the potential and, crucially, addresses the numerical instabilities that plague naive implementations due to the growth of evanescent waves in absorptive or classically forbidden regions. By implementing a robust QR stabilization algorithm [@problem_id:3548698], you will gain experience with a professional-grade computational technique required for accurate scattering calculations in nuclear physics.", "problem": "Consider one-dimensional stationary scattering of a proton of mass $m_p$ from a finite slab of nuclear matter modeled by a complex optical potential. The proton is incident from the left ($x < 0$) on a region $0 \\le x \\le L$ in which the potential is spatially varying and complex, and then exits into free space ($x > L$). Use the time-independent Schrödinger equation in one dimension,\n$$\n-\\frac{\\hbar^2}{2 m_p} \\frac{d^2 \\psi(x)}{dx^2} + U(x)\\,\\psi(x) = E\\,\\psi(x),\n$$\nwhere $E$ is the laboratory-frame kinetic energy, $U(x)$ is the complex nuclear optical potential, and $\\psi(x)$ is the wavefunction. Adopt natural units where $c = 1$ and use $\\hbar c$ explicitly, with all energies in $\\mathrm{MeV}$ and all lengths in $\\mathrm{fm}$. The slab potential is a repulsive-real and absorptive-imaginary Woods–Saxon form,\n$$\nU(x) = \\frac{V_0}{1 + \\exp\\!\\left(\\frac{x - L/2}{a}\\right)} - i\\,\\frac{W_0}{1 + \\exp\\!\\left(\\frac{x - L/2}{a}\\right)},\n$$\nwith $V_0 > 0$ and $W_0 > 0$. This form emulates an effective repulsive barrier (e.g., Coulombic contribution for a proton) together with absorptive nuclear loss in the interaction region.\n\nApproximate $U(x)$ by piecewise-constant slices: partition the interval $[0,L]$ into $N$ uniform slices, each of thickness $d = L/N$. In each slice $j$ with midpoint $x_j$, take $U_j = U(x_j)$ to be constant. Let the left and right asymptotic regions ($x<0$ and $x>L$) have $U(x)=0$. Define the complex local wave number\n$$\nk_j = \\sqrt{\\frac{2 m_p \\left(E - U_j\\right)}{\\hbar^2}},\n$$\nand in the asymptotic regions $k_0 = k_R = \\sqrt{\\frac{2 m_p E}{\\hbar^2}}$, using the principal branch of the complex square root for $k_j$.\n\nImplement the transfer-matrix formalism that enforces continuity of $\\psi(x)$ and $d\\psi/dx$ at each slice interface. For a piecewise-constant segment of thickness $d$ and wave number $k$, there is a propagation matrix, and for each interface from wave number $k_{\\mathrm{in}}$ to $k_{\\mathrm{out}}$, there is an interface matching matrix. By multiplying these $2\\times 2$ matrices across all slices and interfaces, obtain the total transfer matrix that maps the incident and reflected amplitudes on the left to the transmitted and incoming-from-the-right amplitudes on the right. From the total transfer matrix, compute the transmission coefficient $T(E)$ defined as the ratio of transmitted to incident flux, expressed as a dimensionless decimal number.\n\nYour program must compute $T(E)$ for three test energies using two algorithms:\n- A naive algorithm that forms the full transfer matrix by direct left-to-right multiplication of the $2\\times 2$ matrices.\n- A stabilized algorithm that uses repeated orthonormalization via the $QR$ decomposition at each multiplication step to prevent numerical overflow due to evanescent growth, followed by a carefully rescaled reconstruction of the full transfer matrix.\n\nDemonstrate numerical instability due to evanescent growth and its mitigation by $QR$ stabilization by computing both the naive and stabilized transmission coefficients for each energy. Use the following fixed physical and numerical parameters:\n- $m_p = 938.2720813~\\mathrm{MeV}$,\n- $\\hbar c = 197.3269804~\\mathrm{MeV\\,fm}$,\n- $L = 20.0~\\mathrm{fm}$,\n- $a = 0.6~\\mathrm{fm}$,\n- $V_0 = 40.0~\\mathrm{MeV}$,\n- $W_0 = 20.0~\\mathrm{MeV}$,\n- $N = 800$ (so $d = L/N$).\n\nUse the following test suite of incident energies, all in $\\mathrm{MeV}$:\n- $E_1 = 5.0$ (strongly sub-barrier with significant absorption),\n- $E_2 = 40.0$ (near the top of the repulsive barrier),\n- $E_3 = 200.0$ (well above the barrier).\n\nFor each energy $E_i$, compute two floats: the naive transmission coefficient and the stabilized transmission coefficient. Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, in the order\n$$\n[T_{\\mathrm{naive}}(E_1), T_{\\mathrm{stab}}(E_1), T_{\\mathrm{naive}}(E_2), T_{\\mathrm{stab}}(E_2), T_{\\mathrm{naive}}(E_3), T_{\\mathrm{stab}}(E_3)].\n$$\nAll numbers must be dimensionless decimals. Angles in any intermediate exponentials must be treated in radians. Ensure scientific realism in the implementation and use complex arithmetic consistently throughout.", "solution": "The user-provided problem is a valid and well-posed exercise in computational quantum mechanics, specifically focusing on one-dimensional scattering through a complex optical potential. It requires the implementation of the transfer-matrix method to solve the time-independent Schrödinger equation and highlights the critical numerical issue of evanescent wave instability, which is addressed via a QR stabilization algorithm. All physical parameters, numerical specifications, and theoretical models are scientifically sound and standard within the field of nuclear physics.\n\nThe solution proceeds by first establishing the theoretical framework of the transfer-matrix method for a piecewise-constant potential. Subsequently, two computational algorithms are developed: a naive, direct multiplication approach and a numerically stabilized approach using QR decomposition.\n\n### Theoretical Framework\n\nThe problem is governed by the one-dimensional time-independent Schrödinger equation:\n$$\n-\\frac{\\hbar^2}{2 m_p} \\frac{d^2 \\psi(x)}{dx^2} + U(x)\\,\\psi(x) = E\\,\\psi(x)\n$$\nThis can be rearranged into the form of a simple harmonic oscillator equation for each region of constant potential:\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + k^2 \\psi(x) = 0\n$$\nwhere $k$ is the complex wave number, defined as:\n$$\nk(x) = \\sqrt{\\frac{2 m_p (E - U(x))}{\\hbar^2}} = \\sqrt{\\frac{2 m_p (E - U(x))}{(\\hbar c)^2}}\n$$\nWe use the constant factor $\\alpha = 2 m_p / (\\hbar c)^2 \\approx 0.0482936~\\mathrm{MeV}^{-1}\\mathrm{fm}^{-2}$ for convenience. The potential $U(x)$ is discretized into $N$ slices of thickness $d=L/N$. In the $j$-th slice ($j \\in \\{1, \\dots, N\\}$), the potential is constant, $U_j = U(x_j)$, where $x_j = (j - 1/2)d$. This results in a constant complex wave number $k_j$ for each slice. In the asymptotic regions $x<0$ and $x>L$, the potential is $U=0$, and the wave number is $k_0 = \\sqrt{\\alpha E}$, which is real.\n\nFor each slice $j$, the general solution for the wavefunction is a superposition of a forward-propagating wave and a backward-propagating wave:\n$$\n\\psi_j(x) = A_j e^{i k_j (x - x_{j-1})} + B_j e^{-i k_j (x - x_{j-1})}\n$$\nwhere $A_j$ and $B_j$ are complex amplitudes and $x_{j-1} = (j-1)d$ is the left boundary of the slice. The state of the system can be represented by a vector of these amplitudes, $\\mathbf{c}_j = \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix}$.\n\nThe transfer-matrix method connects the amplitude vectors of adjacent regions by enforcing the continuity of the wavefunction $\\psi(x)$ and its derivative $d\\psi/dx$ at each interface. At an interface $x=x_j$ between a region with wave number $k_j$ and a region with wave number $k_{j+1}$, this continuity condition leads to a matrix relationship:\n$$\n\\begin{pmatrix} A_{j+1} \\\\ B_{j+1} \\end{pmatrix} = T^{(j)} \\begin{pmatrix} A_j \\\\ B_j \\end{pmatrix}\n$$\nThe matrix $T^{(j)}$ is a product of an interface matrix $I_{j+1 \\leftarrow j}$ and a propagation matrix $P'_j$:\n$$\nT^{(j)} = I_{j+1 \\leftarrow j} P'_j = \\frac{1}{2} \\begin{pmatrix} 1+\\frac{k_j}{k_{j+1}} & 1-\\frac{k_j}{k_{j+1}} \\\\ 1-\\frac{k_j}{k_{j+1}} & 1+\\frac{k_j}{k_{j+1}} \\end{pmatrix} \\begin{pmatrix} e^{ik_j d} & 0 \\\\ 0 & e^{-ik_j d} \\end{pmatrix}\n$$\nBy composing these matrices across all $N$ slices and the initial interface at $x=0$, we obtain the total transfer matrix $M_{\\text{tot}}$ that relates the amplitudes in the incident region ($x<0$) to those in the final transmitted region ($x>L$):\n$$\n\\begin{pmatrix} A_{\\text{out}} \\\\ B_{\\text{out}} \\end{pmatrix} = M_{\\text{tot}} \\begin{pmatrix} A_{\\text{in}} \\\\ B_{\\text{in}} \\end{pmatrix} \\quad \\text{where} \\quad M_{\\text{tot}} = T^{(N)} T^{(N-1)} \\cdots T^{(1)} T^{(0)}\n$$\nHere, $T^{(0)}$ is the matrix for the first interface at $x=0$ (which lacks a preceding propagation part), and $T^{(j)}$ for $j \\in \\{1, \\dots, N\\}$ are the matrices for the subsequent slices.\n\nFor a scattering problem, we set the incident amplitude $A_{\\text{in}}=1$ and require no incoming wave from the right, so $B_{\\text{out}}=0$. Let $M_{\\text{tot}} = \\begin{pmatrix} m_{00} & m_{01} \\\\ m_{10} & m_{11} \\end{pmatrix}$. The condition $B_{\\text{out}}=0$ yields $0 = m_{10}(1) + m_{11}B_{\\text{in}}$, from which the reflection amplitude is $B_{\\text{in}} = -m_{10}/m_{11}$. The transmitted amplitude is $A_{\\text{out}} = m_{00}(1) + m_{01}B_{\\text{in}} = (m_{00}m_{11} - m_{01}m_{10})/m_{11} = \\det(M_{\\text{tot}})/m_{11}$. A key property of this formulation is that $\\det(M_{\\text{tot}})=1$, so the transmission amplitude is simply $t = A_{\\text{out}} = 1/m_{11}$.\n\nThe transmission coefficient $T(E)$ is the ratio of the transmitted probability flux to the incident probability flux. For plane waves, this simplifies to $T(E) = |t|^2 = |1/m_{11}|^2$.\n\n### Numerical Algorithms\n\n#### Naive Algorithm\nThis algorithm computes $M_{\\text{tot}}$ by straightforwardly multiplying the sequence of $N+1$ single-step matrices, $T^{(j)}$. While direct, this method is prone to numerical instability. In regions where the energy $E$ is less than the real part of the potential $U(x)$ (a classically forbidden region), the wave number $k_j$ has a significant positive imaginary component, $\\text{Im}(k_j) = \\gamma_j > 0$. The propagation matrix $P'_j$ contains a term $e^{-ik_j d} = e^{\\gamma_j d} e^{-i\\text{Re}(k_j)d}$, which grows exponentially. The repeated multiplication of matrices containing these large exponential factors causes one column of the resulting matrix $M_{\\text{tot}}$ to grow much faster than the other. This leads to a numerically singular (ill-conditioned) matrix, where the smaller components are lost due to finite floating-point precision. The calculated value of $m_{11}$ becomes unreliable, often resulting in overflow, underflow, or significant error, rendering the computed transmission coefficient meaningless.\n\n#### Stabilized Algorithm using QR Decomposition\nTo circumvent this instability, we must prevent the matrix columns from diverging in magnitude during the multiplication process. A robust method is to apply QR decomposition at each step. The product $M_{\\text{tot}} = A_N A_{N-1} \\cdots A_0$ is computed iteratively.\nLet the sequence of matrices be $\\{A_j\\}_{j=0}^N$.\n1.  Initialize by decomposing the first matrix: $A_0 = Q_0 R_0$.\n2.  At each subsequent step $j=1, \\dots, N$, compute the intermediate matrix $C_j = A_j Q_{j-1}$.\n3.  Decompose this intermediate matrix: $C_j = Q_j R_j$.\n4.  The total matrix up to this step is $A_j \\cdots A_0 = (A_j Q_{j-1})(R_{j-1} \\cdots R_0) = (Q_j R_j)(R_{j-1} \\cdots R_0) = Q_j (R_j R_{j-1} \\cdots R_0)$.\n\nAfter iterating through all matrices, the final transfer matrix is given by $M_{\\text{tot}} = Q_N R_{\\text{prod}}$, where $R_{\\text{prod}} = R_N R_{N-1} \\cdots R_0$. The $Q_j$ matrices are unitary and thus well-conditioned. The large exponential growth is isolated into the upper-triangular $R_j$ matrices. The product of these $R_j$ matrices can be computed without loss of precision. The final reconstruction $M_{\\text{tot}} = Q_N R_{\\text{prod}}$ is performed only once at the end. While this final step can still involve large numbers, it avoids the compounding loss of precision from repeated multiplications of ill-conditioned matrices. This method provides a numerically stable result for $m_{11}$ and hence for the transmission coefficient $T$.\n\nThe provided Python code implements both algorithms, demonstrating the failure of the naive method and the success of the stabilized QR method, particularly for the low-energy case ($E_1=5.0~\\mathrm{MeV}$) where the wave is strongly evanescent.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import qr\n\ndef solve():\n    # Define the test cases from the problem statement.\n    \n    # Physical and numerical parameters\n    m_p = 938.2720813  # Proton mass in MeV\n    hbar_c = 197.3269804  # h-bar * c in MeV fm\n    L = 20.0  # Slab thickness in fm\n    a = 0.6  # Diffuseness parameter in fm\n    V0 = 40.0  # Real potential strength in MeV\n    W0 = 20.0  # Imaginary potential strength in MeV\n    N = 800   # Number of slices\n    d = L / N # Slice thickness in fm\n\n    # Pre-calculate constant factor for wave number calculation\n    alpha = 2 * m_p / hbar_c**2\n\n    # Test suite of incident energies in MeV\n    energies = [5.0, 40.0, 200.0]\n\n    # Function to define the complex optical potential U(x)\n    def potential(x, L_val, a_val, V0_val, W0_val):\n        return (V0_val - 1j * W0_val) / (1 + np.exp((x - L_val / 2) / a_val))\n\n    # Calculate midpoints of the N slices for potential calculation\n    x_slices = (np.arange(N) + 0.5) * d\n    \n    # Pre-calculate potentials for all slices as they are energy-independent\n    U_slices = potential(x_slices, L, a, V0, W0)\n\n    def get_step_matrices(E, alpha_val, U_slices_val, d_val, N_val):\n        \"\"\"\n        Generates the sequence of transfer matrices for each step.\n        Returns a list of N+1 matrices [T_0, T_1, ..., T_N].\n        \"\"\"\n        # Asymptotic wave number (in regions with U=0)\n        k0 = np.sqrt(alpha_val * E)\n        \n        # Wave numbers inside the slices\n        k_slices = np.sqrt(alpha_val * (E - U_slices_val))\n        \n        # Full array of wave numbers: k_left, k_1, ..., k_N, k_right\n        k_all = np.concatenate(([k0], k_slices, [k0]))\n        \n        matrices = []\n        \n        # T_0: Matrix for the first interface (x=0) from region 0 to slice 1\n        k_prev, k_curr = k_all[0], k_all[1]\n        term = k_prev / k_curr\n        interface_matrix_0 = 0.5 * np.array([\n            [1 + term, 1 - term],\n            [1 - term, 1 + term]\n        ], dtype=np.complex128)\n        matrices.append(interface_matrix_0)\n        \n        # T_1 to T_N: Matrices for prop. through slice j and interface to j+1\n        for i in range(N_val):\n            # Propagate through slice j (k_all[i+1]) and interface to slice j+1 (k_all[i+2])\n            k_prev = k_all[i + 1]\n            k_curr = k_all[i + 2]\n            \n            # Propagation matrix P'_j\n            prop_matrix = np.array([\n                [np.exp(1j * k_prev * d_val), 0],\n                [0, np.exp(-1j * k_prev * d_val)]\n            ], dtype=np.complex128)\n            \n            # Interface matrix I_{j+1 <- j}\n            term = k_prev / k_curr\n            interface_matrix = 0.5 * np.array([\n                [1 + term, 1 - term],\n                [1 - term, 1 + term]\n            ], dtype=np.complex128)\n\n            # Combined step matrix T_j = I_{j+1 <- j} @ P'_j\n            step_matrix = interface_matrix @ prop_matrix\n            matrices.append(step_matrix)\n            \n        return matrices\n\n    results = []\n    \n    for E in energies:\n        # Get the list of N+1 matrices to be multiplied\n        # M_total = A_N @ ... @ A_1 @ A_0\n        step_matrices = get_step_matrices(E, alpha, U_slices, d, N)\n        \n        # --- Naive Algorithm ---\n        # Direct multiplication M_total = A_N @ ( ... @ (A_1 @ A_0))\n        m_naive = step_matrices[0]\n        for i in range(1, N + 1):\n             m_naive = step_matrices[i] @ m_naive\n        \n        # Calculate transmission coefficient T = 1 / |m_11|^2 (0-indexed)\n        m11_naive = m_naive[1, 1]\n        # Handle potential overflow/underflow where m_11 becomes inf or 0\n        if np.isinf(m11_naive) or m11_naive == 0:\n            t_naive = 0.0\n        else:\n            t_naive = 1.0 / np.abs(m11_naive)**2\n        results.append(t_naive)\n        \n        # --- Stabilized Algorithm (QR Decomposition) ---\n        # M_total = Q_N @ (R_N @ ... @ R_1 @ R_0)\n        \n        # Initialize with the first matrix A_0\n        Q_accum, R_prod = qr(step_matrices[0])\n        \n        # Loop through the remaining matrices A_1 to A_N\n        for i in range(1, N + 1):\n            C = step_matrices[i] @ Q_accum\n            Q_accum, R_step = qr(C)\n            R_prod = R_step @ R_prod\n\n        # Reconstruct the full, stable matrix M_stab = Q_accum @ R_prod\n        m_stab = Q_accum @ R_prod\n        \n        # Calculate transmission coefficient from the stabilized matrix\n        m11_stab = m_stab[1, 1]\n        t_stab = 1.0 / np.abs(m11_stab)**2\n        results.append(t_stab)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```", "id": "3548698"}]}