{"hands_on_practices": [{"introduction": "This first practice provides a direct, hands-on implementation of the core Hauser-Feshbach formalism. By translating the theoretical cross section formula, derived from quantum statistical principles, into a working computation, you will gain a foundational understanding of how reaction outcomes are determined. This exercise requires summing contributions over various compound nucleus states characterized by total angular momentum and parity, $J^\\pi$, illustrating how nuclear structure information, embedded in transmission coefficients, governs the branching ratios between different reaction channels [@problem_id:3551257].", "problem": "You are tasked with deriving and implementing a computation of the compound-nucleus reaction cross section for the neutron-induced proton-emission reaction on iron, specifically the $n + {}^{56}\\mathrm{Fe} \\to p + {}^{56}\\mathrm{Mn}$ channel at incident neutron energy $E_n = 1\\,\\mathrm{MeV}$. The calculation must be based on the compound-nucleus (Hauser-Feshbach) framework using fundamental principles: conservation of angular momentum and parity, statistical formation probability of the compound nucleus weighted by spin degeneracies, and average branching ratios expressed via transmission coefficients. No pre-derived formulas may be used in the problem statement; instead, you must start from these principles and derive the necessary expressions within your solution.\n\nKnown physical inputs:\n- The target is ${}^{56}\\mathrm{Fe}$ in its ground state with spin-parity $I^\\pi = 0^+$.\n- The projectile neutron has spin $s_n = \\tfrac{1}{2}$.\n- The incident neutron laboratory energy is $E_n = 1\\,\\mathrm{MeV}$.\n- Use the nonrelativistic wave number computed with the reduced mass and center-of-mass energy:\n  - The neutron mass is $m_n = 939.5654133\\,\\mathrm{MeV}/c^2$.\n  - The atomic mass of ${}^{56}\\mathrm{Fe}$ is $m_{\\mathrm{Fe}} = 55.9349375\\,\\mathrm{u}$, and $1\\,\\mathrm{u} = 931.49410242\\,\\mathrm{MeV}/c^2$.\n  - The reduced mass is $\\mu = \\dfrac{m_n m_{\\mathrm{Fe}}}{m_n + m_{\\mathrm{Fe}}}$.\n  - The center-of-mass energy is $E_{\\mathrm{cm}} = E_n \\dfrac{m_{\\mathrm{Fe}}}{m_n + m_{\\mathrm{Fe}}}$.\n  - Use $\\hbar c = 197.3269804\\,\\mathrm{MeV}\\,\\mathrm{fm}$ to obtain the wave number $k = \\sqrt{2 \\mu E_{\\mathrm{cm}}}/(\\hbar c)$ in $\\mathrm{fm}^{-1}$.\n- The reaction cross section must be expressed in barns; recall that $1\\,\\mathrm{barn} = 100\\,\\mathrm{fm}^2$.\n\nNuclear-reaction modeling inputs:\n- For each accessible compound-nucleus state labeled by total spin $J$ and parity $\\pi$, you are given dimensionless transmission coefficients $T_c^{J\\pi}$ for channels $c \\in \\{n, p, \\alpha, \\gamma\\}$ at the compound excitation corresponding to the specified $E_n$. These transmission coefficients represent the average coupling probability to each channel and must be combined with the appropriate spin statistical weight and an average branching ratio derived from the $T_c^{J\\pi}$.\n- You must include the correct entrance-channel spin statistical factor based on $s_n$ and $I$ and sum over all provided $J^\\pi$.\n- Assume the absence of width fluctuation corrections (i.e., use an average-statistical treatment without additional correlation factors), and assume the tabulated $T_c^{J\\pi}$ already incorporate any relevant orbital-angular-momentum averaging in the entrance channel.\n\nTest suite:\nImplement your program to compute the $(n,p)$ cross section $\\sigma_{n,p}$ for the following four parameter sets. In each set, a list of compound-nucleus states $(J^\\pi)$ is provided, along with channel transmission coefficients $T_n^{J\\pi}$, $T_p^{J\\pi}$, $T_\\alpha^{J\\pi}$, and $T_\\gamma^{J\\pi}$. All $T$ values are dimensionless.\n\n- Test case $1$ (multiple contributing $J^\\pi$ with small but open proton transmission):\n  - $J^\\pi = \\tfrac{1}{2}^+$: $T_n = 0.90$, $T_p = 0.002$, $T_\\alpha = 1\\times 10^{-5}$, $T_\\gamma = 0.05$.\n  - $J^\\pi = \\tfrac{3}{2}^+$: $T_n = 0.80$, $T_p = 0.003$, $T_\\alpha = 2\\times 10^{-5}$, $T_\\gamma = 0.06$.\n  - $J^\\pi = \\tfrac{5}{2}^-$: $T_n = 0.10$, $T_p = 0.0005$, $T_\\alpha = 1\\times 10^{-6}$, $T_\\gamma = 0.02$.\n- Test case $2$ (proton channel effectively closed at this energy):\n  - $J^\\pi = \\tfrac{1}{2}^+$: $T_n = 0.85$, $T_p = 0.0$, $T_\\alpha = 1\\times 10^{-5}$, $T_\\gamma = 0.04$.\n  - $J^\\pi = \\tfrac{3}{2}^-$: $T_n = 0.60$, $T_p = 0.0$, $T_\\alpha = 1\\times 10^{-5}$, $T_\\gamma = 0.03$.\n- Test case $3$ (mixed parity set with one inaccessible entrance component reflected by $T_n = 0$):\n  - $J^\\pi = \\tfrac{1}{2}^-$: $T_n = 0.50$, $T_p = 0.002$, $T_\\alpha = 5\\times 10^{-6}$, $T_\\gamma = 0.10$.\n  - $J^\\pi = \\tfrac{3}{2}^+$: $T_n = 0.0$, $T_p = 0.004$, $T_\\alpha = 1\\times 10^{-5}$, $T_\\gamma = 0.08$.\n  - $J^\\pi = \\tfrac{5}{2}^+$: $T_n = 0.20$, $T_p = 0.0002$, $T_\\alpha = 1\\times 10^{-5}$, $T_\\gamma = 0.05$.\n- Test case $4$ (edge case with very small transmissions):\n  - $J^\\pi = \\tfrac{1}{2}^+$: $T_n = 0.01$, $T_p = 1\\times 10^{-6}$, $T_\\alpha = 1\\times 10^{-7}$, $T_\\gamma = 0.001$.\n  - $J^\\pi = \\tfrac{3}{2}^-$: $T_n = 0.02$, $T_p = 2\\times 10^{-6}$, $T_\\alpha = 1\\times 10^{-7}$, $T_\\gamma = 0.0015$.\n\nProgramming and output requirements:\n- Derive the cross section expression from the stated principles and implement it.\n- Use the given physical constants and definitions to compute the entrance-channel wave number $k$ and the geometrical prefactor.\n- For each test case, compute the $(n,p)$ cross section $\\sigma_{n,p}$ in barns.\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places, for example, `[x_1,x_2,x_3,x_4]`.", "solution": "The problem requires the derivation and implementation of the compound-nucleus reaction cross section for the reaction $n + {}^{56}\\mathrm{Fe} \\to p + {}^{56}\\mathrm{Mn}$ using the Hauser-Feshbach statistical model. The derivation must originate from fundamental principles of quantum mechanics and statistical physics, as specified.\n\n### Derivation of the Hauser-Feshbach Formula\n\nThe calculation of the angle-integrated cross section $\\sigma_{n,p}$ for the reaction proceeding from an entrance channel $n$ to an exit channel $p$ through a compound nucleus follows a two-step process as proposed by Bohr's independence hypothesis.\n1.  Formation of the compound nucleus ($^{57}\\mathrm{Fe}^*$) from the target ${}^{56}\\mathrm{Fe}$ and projectile neutron $n$.\n2.  Decay of the compound nucleus into the exit channel, consisting of the residual nucleus ${}^{56}\\mathrm{Mn}$ and an emitted proton $p$.\n\nThe cross section is calculated by summing the contributions from all possible intermediate states of the compound nucleus, which are characterized by a total angular momentum $J$ and parity $\\pi$. The total cross section is given by:\n$$\n\\sigma_{n,p} = \\sum_{J,\\pi} \\sigma_{\\mathrm{CN}}(J^\\pi) \\cdot P_{p}(J^\\pi)\n$$\nwhere $\\sigma_{\\mathrm{CN}}(J^\\pi)$ is the cross section for forming the compound nucleus in a state with spin-parity $J^\\pi$, and $P_{p}(J^\\pi)$ is the branching ratio, or probability, that this state decays into the proton channel.\n\n**1. Compound Nucleus Formation Cross Section**\nThe cross section for the formation of the compound nucleus state $J^\\pi$ from the entrance channel (neutron + ${}^{56}\\mathrm{Fe}$) is given by the partial wave reaction cross section. For an unpolarized beam and target, it is expressed as:\n$$\n\\sigma_{\\mathrm{CN}}(J^\\pi) = \\frac{\\pi}{k^2} g_J T_n^{J\\pi}\n$$\nHere, $k$ is the wave number of the relative motion in the entrance channel center-of-mass frame. The term $\\pi/k^2$ is the geometric limit for the s-wave reaction cross section.\n\nThe term $g_J$ is the spin statistical factor, representing the probability that the projectile spin $s_n$, target spin $I$, and their relative orbital angular momentum couple to the total angular momentum $J$. It is given by:\n$$\ng_J = \\frac{2J+1}{(2s_n+1)(2I+1)}\n$$\nFor this problem, the target is ${}^{56}\\mathrm{Fe}$ with ground-state spin $I=0$, and the projectile is a neutron with spin $s_n = \\tfrac{1}{2}$. The spin statistical factor denominator is therefore $(2 \\cdot \\tfrac{1}{2} + 1)(2 \\cdot 0 + 1) = 2$.\n\nThe quantity $T_n^{J\\pi}$ is the transmission coefficient for the entrance neutron channel. It represents the probability that a neutron, having reached the nuclear surface with the correct angular momentum and parity to form the state $J^\\pi$, will be absorbed to form the compound nucleus. The problem states that these coefficients are provided and already average over the contributing orbital angular momenta.\n\nThe wave number $k$ is calculated non-relativistically:\n$$\nk = \\frac{\\sqrt{2\\mu E_{\\mathrm{cm}}}}{\\hbar}\n$$\nwhere $\\mu$ is the reduced mass of the $n$-${}^{56}\\mathrm{Fe}$ system, $E_{\\mathrm{cm}}$ is the center-of-mass energy, and $\\hbar$ is the reduced Planck constant. The problem provides $\\hbar c$, so we use the equivalent form $k = \\sqrt{2\\mu E_{\\mathrm{cm}}}/(\\hbar c)$. The necessary masses and energies are:\n- Reduced mass: $\\mu = \\dfrac{m_n m_{\\mathrm{Fe}}}{m_n + m_{\\mathrm{Fe}}}$\n- Center-of-mass energy: $E_{\\mathrm{cm}} = E_n \\dfrac{m_{\\mathrm{Fe}}}{m_n + m_{\\mathrm{Fe}}}$, with $E_n = 1\\,\\mathrm{MeV}$.\n\n**2. Compound Nucleus Decay Probability (Branching Ratio)**\nOnce formed, the compound nucleus state $J^\\pi$ can decay into any energetically accessible channel $c$ (e.g., $n, p, \\alpha, \\gamma$). The statistical model assumes that the decay is independent of the formation. The probability of decay into a specific channel $p$ is given by the ratio of the partial decay width for that channel, $\\Gamma_p^{J\\pi}$, to the total decay width, $\\Gamma_{\\mathrm{tot}}^{J\\pi}$, which is the sum of all partial widths:\n$$\nP_p(J^\\pi) = \\frac{\\Gamma_p^{J\\pi}}{\\Gamma_{\\mathrm{tot}}^{J\\pi}} = \\frac{\\Gamma_p^{J\\pi}}{\\sum_c \\Gamma_c^{J\\pi}}\n$$\nA fundamental tenet of the statistical model is that the average partial width $\\langle\\Gamma_c^{J\\pi}\\rangle$ is directly proportional to the transmission coefficient $T_c^{J\\pi}$ for that channel. Since we are dealing with average cross sections (no width fluctuation corrections), we can replace the widths with the transmission coefficients:\n$$\nP_p(J^\\pi) \\approx \\frac{T_p^{J\\pi}}{\\sum_c T_c^{J\\pi}}\n$$\nThe problem specifies four decay channels: elastic/inelastic neutron scattering ($n$), proton emission ($p$), alpha emission ($\\alpha$), and gamma decay ($\\gamma$). The total transmission is therefore $T_{\\mathrm{tot}}^{J\\pi} = T_n^{J\\pi} + T_p^{J\\pi} + T_\\alpha^{J\\pi} + T_\\gamma^{J\\pi}$. The branching ratio into the proton channel becomes:\n$$\nP_p(J^\\pi) = \\frac{T_p^{J\\pi}}{T_{\\mathrm{tot}}^{J\\pi}}\n$$\n\n**3. Total (n,p) Cross Section**\nCombining the expressions for formation and decay, and summing over all contributing states $J^\\pi$:\n$$\n\\sigma_{n,p} = \\sum_{J,\\pi} \\left[ \\frac{\\pi}{k^2} \\frac{2J+1}{(2s_n+1)(2I+1)} T_n^{J\\pi} \\right] \\left[ \\frac{T_p^{J\\pi}}{T_n^{J\\pi} + T_p^{J\\pi} + T_\\alpha^{J\\pi} + T_\\gamma^{J\\pi}} \\right]\n$$\nFactoring out the terms that do not depend on the summation index $(J,\\pi)$, we arrive at the final expression for the cross section:\n$$\n\\sigma_{n,p} = \\frac{\\pi}{k^2} \\frac{1}{(2s_n+1)(2I+1)} \\sum_{J,\\pi} (2J+1) \\frac{T_n^{J\\pi} T_p^{J\\pi}}{\\sum_c T_c^{J\\pi}}\n$$\n\n### Implementation\nThe algorithm proceeds by first calculating the constant prefactor and then, for each test case, summing the contributions from each specified compound nucleus state.\n\n**Constants and Prefactor Calculation:**\nUsing the provided physical constants:\n- $m_n = 939.5654133\\,\\mathrm{MeV}/c^2$\n- $m_{\\mathrm{Fe}} = 55.9349375\\,\\mathrm{u} \\times 931.49410242\\,\\mathrm{MeV}/c^2/\\mathrm{u} \\approx 52101.4081\\,\\mathrm{MeV}/c^2$\n- $E_n = 1\\,\\mathrm{MeV}$\n- $\\hbar c = 197.3269804\\,\\mathrm{MeV}\\,\\mathrm{fm}$\n- $s_n = \\tfrac{1}{2}$, $I=0$\n\nThe derived quantities are:\n- $\\mu = \\dfrac{m_n m_{\\mathrm{Fe}}}{m_n + m_{\\mathrm{Fe}}} \\approx 922.9550\\,\\mathrm{MeV}/c^2$\n- $E_{\\mathrm{cm}} = E_n \\dfrac{m_{\\mathrm{Fe}}}{m_n + m_{\\mathrm{Fe}}} \\approx 0.982286\\,\\mathrm{MeV}$\n- $k^2 = \\dfrac{2 \\mu E_{\\mathrm{cm}}}{(\\hbar c)^2} \\approx \\dfrac{2 \\cdot 922.9550 \\cdot 0.982286}{(197.3269804)^2} \\approx 0.0465696\\,\\mathrm{fm}^{-2}$\n- Spin factor denominator: $(2s_n+1)(2I+1) = 2$\n\nThe overall prefactor for the cross section is:\n$$\n\\text{Prefactor} = \\frac{\\pi}{k^2} \\frac{1}{2} \\approx \\frac{\\pi}{0.0465696} \\frac{1}{2} \\approx 33.7441\\,\\mathrm{fm}^2\n$$\nTo express the final result in barns, we use the conversion $1\\,\\mathrm{barn} = 100\\,\\mathrm{fm}^2$.\n$$\n\\text{Prefactor (barns)} = 33.7441\\,\\mathrm{fm}^2 \\times \\frac{1\\,\\mathrm{barn}}{100\\,\\mathrm{fm}^2} \\approx 0.337441\\,\\mathrm{barns}\n$$\n\n**Computation for Test Cases:**\nFor each test case, we compute the sum:\n$$\nS = \\sum_{J,\\pi} (2J+1) \\frac{T_n^{J\\pi} T_p^{J\\pi}}{T_{\\mathrm{tot}}^{J\\pi}}\n$$\nThe final cross section for that case is $\\sigma_{n,p} = \\text{Prefactor (barns)} \\times S$. The provided Python code implements this logic precisely, calculating the prefactor and then iterating through the test cases to compute and format the results. Note that if $T_n^{J\\pi}$ or $T_p^{J\\pi}$ is zero, or if a state is inaccessible through the entrance channel (as indicated by $T_n^{J\\pi} = 0$), its contribution to the sum is zero.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the compound-nucleus reaction cross section for\n    n + 56-Fe - p + 56-Mn at E_n = 1 MeV using the Hauser-Feshbach framework.\n    \"\"\"\n    \n    # --- Part 1: Define physical constants and calculate prefactor ---\n    \n    # Known physical inputs from the problem statement\n    M_N_MEV = 939.5654133      # Neutron mass in MeV/c^2\n    M_FE_U = 55.9349375       # 56Fe mass in atomic mass units (u)\n    U_TO_MEV = 931.49410242    # Conversion factor from u to MeV/c^2\n    HBARC_MEV_FM = 197.3269804 # h-bar * c in MeV*fm\n    BARN_TO_FM2 = 100.0         # 1 barn = 100 fm^2\n    \n    E_N_LAB_MEV = 1.0           # Incident neutron laboratory energy in MeV\n    S_N = 0.5                   # Neutron spin\n    I_TGT = 0.0                 # Target 56Fe spin\n\n    # Calculate derived quantities for the prefactor\n    m_fe_mev = M_FE_U * U_TO_MEV\n    \n    # Reduced mass of the n-56Fe system in MeV/c^2\n    mu_mev = (M_N_MEV * m_fe_mev) / (M_N_MEV + m_fe_mev)\n    \n    # Center-of-mass energy in MeV\n    e_cm_mev = E_N_LAB_MEV * m_fe_mev / (M_N_MEV + m_fe_mev)\n    \n    # Square of the wave number in the entrance channel, in fm^-2\n    k_squared_fm_inv2 = (2 * mu_mev * e_cm_mev) / (HBARC_MEV_FM ** 2)\n    \n    # Spin statistical factor denominator: (2*s_n + 1) * (2*I + 1)\n    spin_stat_denom = (2 * S_N + 1) * (2 * I_TGT + 1)\n    \n    # Overall prefactor for the cross section formula, converted to barns.\n    # The formula is sigma = (pi/k^2) * (1/spin_stat_denom) * sum(...)\n    prefactor_barns = (np.pi / k_squared_fm_inv2) / spin_stat_denom / BARN_TO_FM2\n\n    # --- Part 2: Define test cases ---\n    # Each test case is a list of dictionaries, where each dictionary\n    # represents a compound nucleus state (J^pi) and its transmission coefficients.\n    test_cases = [\n        # Test case 1\n        [\n            {'J': 0.5, 'Tn': 0.90, 'Tp': 0.002, 'Ta': 1e-5, 'Tg': 0.05},\n            {'J': 1.5, 'Tn': 0.80, 'Tp': 0.003, 'Ta': 2e-5, 'Tg': 0.06},\n            {'J': 2.5, 'Tn': 0.10, 'Tp': 0.0005, 'Ta': 1e-6, 'Tg': 0.02},\n        ],\n        # Test case 2\n        [\n            {'J': 0.5, 'Tn': 0.85, 'Tp': 0.0, 'Ta': 1e-5, 'Tg': 0.04},\n            {'J': 1.5, 'Tn': 0.60, 'Tp': 0.0, 'Ta': 1e-5, 'Tg': 0.03},\n        ],\n        # Test case 3\n        [\n            {'J': 0.5, 'Tn': 0.50, 'Tp': 0.002, 'Ta': 5e-6, 'Tg': 0.10},\n            {'J': 1.5, 'Tn': 0.0, 'Tp': 0.004, 'Ta': 1e-5, 'Tg': 0.08},\n            {'J': 2.5, 'Tn': 0.20, 'Tp': 0.0002, 'Ta': 1e-5, 'Tg': 0.05},\n        ],\n        # Test case 4\n        [\n            {'J': 0.5, 'Tn': 0.01, 'Tp': 1e-6, 'Ta': 1e-7, 'Tg': 0.001},\n            {'J': 1.5, 'Tn': 0.02, 'Tp': 2e-6, 'Ta': 1e-7, 'Tg': 0.0015},\n        ]\n    ]\n\n    results = []\n    # --- Part 3: Calculate the cross section for each test case ---\n    for case_states in test_cases:\n        sum_term = 0.0\n        for state in case_states:\n            J = state['J']\n            Tn = state['Tn']\n            Tp = state['Tp']\n            Ta = state['Ta']\n            Tg = state['Tg']\n            \n            T_total = Tn + Tp + Ta + Tg\n            \n            # The contribution is non-zero only if Tn  0, Tp  0, and T_total  0.\n            # We check T_total  0 to avoid division by zero in the unlikely event\n            # that all transmission coefficients are zero.\n            if T_total  0:\n                # This is the term inside the sum: (2J+1) * (Tn * Tp) / T_total\n                sum_term += (2 * J + 1) * (Tn * Tp) / T_total\n        \n        # Final cross section in barns is the prefactor times the summed term.\n        cross_section_barns = prefactor_barns * sum_term\n        results.append(f\"{cross_section_barns:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3551257"}, {"introduction": "To deepen our understanding of the Hauser-Feshbach theory, this practice focuses on a comparative study. A key strength of the theory is its rigorous conservation of angular momentum $J$ and parity $\\pi$ at each stage of the reaction. You will quantify the physical importance of this constraint by implementing and comparing the full Hauser-Feshbach result against the simpler Weisskopf-Ewing approximation, which neglects the $J^\\pi$ dependence of the decay probabilities, thereby revealing the conditions under which such simplifications are invalid [@problem_id:3551261].", "problem": "Construct a program that, for a specified set of compound nucleus formation and decay parameters, computes two reaction cross sections for a single exit channel: one that fully respects the dependence on total angular momentum and parity, denoted by $J^\\pi$, and one that removes this dependence in the spirit of the Weisskopf-Ewing assumption. The objective is to quantify the error incurred by neglecting $J^\\pi$ dependence in a reaction exhibiting strong spin selectivity. The program must compute, for each test case, the relative error defined as $(\\sigma_{\\mathrm{WE}} - \\sigma_{\\mathrm{HF}})/\\sigma_{\\mathrm{HF}}$, expressed as a decimal number rounded to six decimal places.\n\nThe fundamental base that must be used in the derivation and implementation consists of the following widely accepted principles and definitions:\n- Conservation of angular momentum and parity in compound nucleus reactions, implying that entrance and exit processes proceed through compound states labeled by $J$ and $\\pi$.\n- The statistical nature of compound nucleus decay, treating each decay channel via transmission coefficients that are functions of the microscopic interaction and available phase space.\n- The definition of the wave number $k$ in the center-of-mass frame, given by $k = \\sqrt{2 \\mu E}/(\\hbar c)$, where $E$ is the center-of-mass energy, $\\mu$ is the reduced mass, and $\\hbar c$ is a constant.\n- The spin statistical factor that accounts for the number of initial spin orientations, based on the projectile spin $s_a$ and target spin $I_A$.\n\nThe program must implement both models:\n- The model with $J^\\pi$ dependence uses the full dependence of formation and decay on $J$ and $\\pi$ when computing the cross section for the chosen exit channel.\n- The Weisskopf-Ewing-type model removes $J^\\pi$ dependence in the branching probabilities by using a $J^\\pi$-independent average emission probability for the exit channel, while retaining the correct formation cross section.\n\nYou must adhere to the following algorithmic and numerical requirements:\n1. For each test case, compute the reduced mass $\\mu$ using the projectile mass $m_a$ and target mass $m_A$, and then compute the wave number $k$. Use $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$. Masses are provided in $\\mathrm{MeV}/c^2$, and energies are provided in $\\mathrm{MeV}$. Treat $c=1$.\n2. Use the spin statistical factor appropriate for the entrance configuration, constructed from the projectile spin $s_a$ and target spin $I_A$.\n3. In the $J^\\pi$-dependent model, aggregate over the provided $J^\\pi$ states, each with an entrance transmission coefficient $T_a^{J\\pi}$, an exit-channel transmission coefficient $T_b^{J\\pi}$, and a competing transmission coefficient $T_{\\mathrm{rest}}^{J\\pi}$. The total transmission for decay is $T_{\\mathrm{tot}}^{J\\pi} = T_b^{J\\pi} + T_{\\mathrm{rest}}^{J\\pi}$. Only the specified $J^\\pi$ states contribute, consistent with spin selectivity.\n4. In the Weisskopf-Ewing-type model, construct a $J^\\pi$-independent branching probability for the exit channel from the provided $J^\\pi$ transmissions, then multiply this by the correctly computed formation cross section.\n5. Convert areas from $\\mathrm{fm}^2$ to barns in the final cross sections, using $1\\,\\mathrm{barn} = 100\\,\\mathrm{fm}^2$.\n6. For each test case, compute the relative error $(\\sigma_{\\mathrm{WE}} - \\sigma_{\\mathrm{HF}})/\\sigma_{\\mathrm{HF}}$ and round to six decimal places.\n\nPhysical units: Report cross sections internally in barns, and output only the unitless relative error as a decimal rounded to six decimal places.\n\nAngle unit: Not applicable.\n\nPercentages: The relative error must be expressed as a decimal number, not a percentage.\n\nTest suite and parameters:\n- Common constants for all cases: $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$; projectile is a neutron with $s_a = \\tfrac{1}{2}$ and $m_a = 939.565\\,\\mathrm{MeV}/c^2$; target parity $\\pi_A = +1$. The target mass is given by $m_A = A \\times 931.494\\,\\mathrm{MeV}/c^2$, with $A=59$.\n- For each case, specify the target spin $I_A$, the center-of-mass energy $E$, and the list of contributing $(J,\\pi)$ states and their transmission coefficients $(T_a^{J\\pi}, T_b^{J\\pi}, T_{\\mathrm{rest}}^{J\\pi})$. All transmission coefficients are dimensionless and lie between $0$ and $1$.\n\nTest cases:\n1. General strong selectivity case:\n   - $I_A = \\tfrac{7}{2}$, $E = 2.0\\,\\mathrm{MeV}$.\n   - States:\n     - $(J=\\tfrac{7}{2}, \\pi=+1): T_a^{J\\pi}=0.6, T_b^{J\\pi}=0.3, T_{\\mathrm{rest}}^{J\\pi}=0.5$.\n     - $(J=\\tfrac{9}{2}, \\pi=+1): T_a^{J\\pi}=0.9, T_b^{J\\pi}=0.05, T_{\\mathrm{rest}}^{J\\pi}=0.7$.\n     - $(J=\\tfrac{11}{2}, \\pi=+1): T_a^{J\\pi}=0.2, T_b^{J\\pi}=0.4, T_{\\mathrm{rest}}^{J\\pi}=0.3$.\n2. Extreme single-$J$ selectivity case:\n   - $I_A = \\tfrac{7}{2}$, $E = 1.0\\,\\mathrm{MeV}$.\n   - States:\n     - $(J=\\tfrac{7}{2}, \\pi=+1): T_a^{J\\pi}=0.95, T_b^{J\\pi}=0.02, T_{\\mathrm{rest}}^{J\\pi}=0.90$.\n     - $(J=\\tfrac{9}{2}, \\pi=+1): T_a^{J\\pi}=0.0, T_b^{J\\pi}=0.40, T_{\\mathrm{rest}}^{J\\pi}=0.20$.\n     - $(J=\\tfrac{11}{2}, \\pi=+1): T_a^{J\\pi}=0.0, T_b^{J\\pi}=0.10, T_{\\mathrm{rest}}^{J\\pi}=0.40$.\n3. Weak selectivity (uniform entrance) case:\n   - $I_A = \\tfrac{7}{2}$, $E = 3.0\\,\\mathrm{MeV}$.\n   - States (negative parity dominance):\n     - $(J=\\tfrac{7}{2}, \\pi=-1): T_a^{J\\pi}=0.5, T_b^{J\\pi}=0.25, T_{\\mathrm{rest}}^{J\\pi}=0.25$.\n     - $(J=\\tfrac{9}{2}, \\pi=-1): T_a^{J\\pi}=0.5, T_b^{J\\pi}=0.25, T_{\\mathrm{rest}}^{J\\pi}=0.25$.\n     - $(J=\\tfrac{11}{2}, \\pi=-1): T_a^{J\\pi}=0.5, T_b^{J\\pi}=0.25, T_{\\mathrm{rest}}^{J\\pi}=0.25$.\n4. Parity-filtered entrance case:\n   - $I_A = \\tfrac{7}{2}$, $E = 2.0\\,\\mathrm{MeV}$.\n   - States (only negative parity formed):\n     - $(J=\\tfrac{7}{2}, \\pi=+1): T_a^{J\\pi}=0.0, T_b^{J\\pi}=0.30, T_{\\mathrm{rest}}^{J\\pi}=0.40$.\n     - $(J=\\tfrac{9}{2}, \\pi=-1): T_a^{J\\pi}=0.8, T_b^{J\\pi}=0.10, T_{\\mathrm{rest}}^{J\\pi}=0.60$.\n     - $(J=\\tfrac{11}{2}, \\pi=-1): T_a^{J\\pi}=0.6, T_b^{J\\pi}=0.20, T_{\\mathrm{rest}}^{J\\pi}=0.50$.\n5. Competing-channel-dominated case:\n   - $I_A = \\tfrac{7}{2}$, $E = 4.0\\,\\mathrm{MeV}$.\n   - States:\n     - $(J=\\tfrac{7}{2}, \\pi=+1): T_a^{J\\pi}=0.7, T_b^{J\\pi}=0.01, T_{\\mathrm{rest}}^{J\\pi}=0.90$.\n     - $(J=\\tfrac{9}{2}, \\pi=+1): T_a^{J\\pi}=0.4, T_b^{J\\pi}=0.05, T_{\\mathrm{rest}}^{J\\pi}=0.95$.\n     - $(J=\\tfrac{11}{2}, \\pi=+1): T_a^{J\\pi}=0.3, T_b^{J\\pi}=0.02, T_{\\mathrm{rest}}^{J\\pi}=0.98$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\"), where each entry is the relative error for the corresponding test case, rounded to six decimal places as specified above.", "solution": "The problem has been meticulously validated and is determined to be scientifically grounded, well-posed, and complete. All provided parameters are physically reasonable, and the theoretical framework is standard in nuclear reaction theory. The problem is therefore deemed **valid**.\n\nThe core of this problem is to compare two models for calculating the cross section of a compound nucleus reaction, $A(a, b)B$. The first model is the full Hauser-Feshbach (HF) formalism, which respects the conservation of total angular momentum $J$ and parity $\\pi$ for each step of the reaction. The second is a simplified Weisskopf-Ewing (WE) type model, which averages over the decay properties, thus breaking the strict correlation between the formation and decay channels for a given $J^\\pi$.\n\nFirst, we define quantities common to both models. The reaction is viewed in the center-of-mass frame. The reduced mass $\\mu$ of the entrance channel (projectile $a$ on target $A$) is given by:\n$$ \\mu = \\frac{m_a m_A}{m_a + m_A} $$\nwhere $m_a$ and $m_A$ are the masses of the projectile and target, respectively. The center-of-mass wave number $k$ is then:\n$$ k = \\frac{\\sqrt{2 \\mu E}}{\\hbar c} $$\nwhere $E$ is the center-of-mass energy and $\\hbar c$ is the Planck constant-speed of light product.\n\nThe cross section for forming a compound nucleus in a state with specific quantum numbers $(J, \\pi)$ from an initial channel with projectile spin $s_a$ and target spin $I_A$ is given by:\n$$ \\sigma_{CN}^{J\\pi} = \\frac{\\pi}{k^2} \\frac{2J+1}{(2s_a+1)(2I_A+1)} T_a^{J\\pi} $$\nHere, $T_a^{J\\pi}$ is the transmission coefficient for the entrance channel '$a$' leading to the compound state $(J, \\pi)$. The term $\\frac{2J+1}{(2s_a+1)(2I_A+1)}$ is the spin statistical factor.\n\n**1. The Hauser-Feshbach ($J^\\pi$-Dependent) Model ($\\sigma_{\\mathrm{HF}}$)**\n\nThe Hauser-Feshbach theory posits that the reaction proceeds in two independent steps: formation of the compound nucleus and its subsequent decay. However, the decay probabilities are specific to the $(J, \\pi)$ of the decaying state. The cross section for the reaction going to a specific exit channel '$b$' is the formation cross section multiplied by the branching ratio for that decay:\n$$ \\sigma_{ab}^{J\\pi} = \\sigma_{CN}^{J\\pi} \\times P_b^{J\\pi} $$\nThe branching ratio $P_b^{J\\pi}$ is the ratio of the transmission coefficient for channel $b$, $T_b^{J\\pi}$, to the sum of transmission coefficients for all possible decay channels:\n$$ P_b^{J\\pi} = \\frac{T_b^{J\\pi}}{\\sum_c T_c^{J\\pi}} = \\frac{T_b^{J\\pi}}{T_{\\mathrm{tot}}^{J\\pi}} $$\nThe problem provides $T_b^{J\\pi}$ for the channel of interest and a single lumped coefficient $T_{\\mathrm{rest}}^{J\\pi}$ for all other competing channels, such that $T_{\\mathrm{tot}}^{J\\pi} = T_b^{J\\pi} + T_{\\mathrm{rest}}^{J\\pi}$.\n\nThe total cross section, $\\sigma_{\\mathrm{HF}}$, is the incoherent sum over all contributing compound nucleus states $(J, \\pi)$:\n$$ \\sigma_{\\mathrm{HF}} = \\sum_{J,\\pi} \\sigma_{ab}^{J\\pi} = \\frac{\\pi}{k^2} \\frac{1}{(2s_a+1)(2I_A+1)} \\sum_{J,\\pi} (2J+1) T_a^{J\\pi} \\frac{T_b^{J\\pi}}{T_b^{J\\pi} + T_{\\mathrm{rest}}^{J\\pi}} $$\n\n**2. The Weisskopf-Ewing (Approximation) Model ($\\sigma_{\\mathrm{WE}}$)**\n\nThe Weisskopf-Ewing model introduces a key simplification: the decay of the compound nucleus is independent of its formation mode, including its specific $J$ and $\\pi$. The cross section is thus given by the total formation cross section multiplied by a single, $J^\\pi$-independent branching ratio.\n\nFirst, the total formation cross section $\\sigma_{CN}$ is the sum of all partial formation cross sections:\n$$ \\sigma_{CN} = \\sum_{J,\\pi} \\sigma_{CN}^{J\\pi} = \\frac{\\pi}{k^2} \\frac{1}{(2s_a+1)(2I_A+1)} \\sum_{J,\\pi} (2J+1) T_a^{J\\pi} $$\nNext, we construct a $J^\\pi$-independent average branching probability $P_b^{\\mathrm{WE}}$. This is achieved by summing the spin-weighted transmission coefficients for the exit channel '$b$' and dividing by the sum of all spin-weighted total decay transmission coefficients:\n$$ P_b^{\\mathrm{WE}} = \\frac{\\sum_{J,\\pi}(2J+1)T_b^{J\\pi}}{\\sum_{J,\\pi}(2J+1)T_{\\mathrm{tot}}^{J\\pi}} = \\frac{\\sum_{J,\\pi}(2J+1)T_b^{J\\pi}}{\\sum_{J,\\pi}(2J+1)(T_b^{J\\pi} + T_{\\mathrm{rest}}^{J\\pi})} $$\nThe WE cross section is the product of these two quantities:\n$$ \\sigma_{\\mathrm{WE}} = \\sigma_{CN} \\times P_b^{\\mathrm{WE}} = \\left( \\frac{\\pi}{k^2} \\frac{\\sum_{J,\\pi} (2J+1) T_a^{J\\pi}}{(2s_a+1)(2I_A+1)} \\right) \\times \\left( \\frac{\\sum_{J,\\pi}(2J+1)T_b^{J\\pi}}{\\sum_{J,\\pi}(2J+1)T_{\\mathrm{tot}}^{J\\pi}} \\right) $$\n\n**3. Relative Error Calculation**\n\nThe objective is to compute the relative error, $\\epsilon$, defined as:\n$$ \\epsilon = \\frac{\\sigma_{\\mathrm{WE}} - \\sigma_{\\mathrm{HF}}}{\\sigma_{\\mathrm{HF}}} $$\nNotice that both $\\sigma_{\\mathrm{HF}}$ and $\\sigma_{\\mathrm{WE}}$ contain the common factor $C = \\frac{\\pi}{k^2} \\frac{1}{(2s_a+1)(2I_A+1)}$. When calculating the relative error, this factor cancels out.\nLet $S_{\\mathrm{HF}} = \\sum_{J,\\pi} (2J+1) T_a^{J\\pi} \\frac{T_b^{J\\pi}}{T_{\\mathrm{tot}}^{J\\pi}}$.\nLet $S_{\\mathrm{form}} = \\sum_{J,\\pi} (2J+1) T_a^{J\\pi}$.\nLet $S_{\\mathrm{decay},b} = \\sum_{J,\\pi} (2J+1) T_b^{J\\pi}$.\nLet $S_{\\mathrm{decay,tot}} = \\sum_{J,\\pi} (2J+1) T_{\\mathrm{tot}}^{J\\pi}$.\nThen $\\sigma_{\\mathrm{HF}} = C \\cdot S_{\\mathrm{HF}}$ and $\\sigma_{\\mathrm{WE}} = C \\cdot S_{\\mathrm{form}} \\frac{S_{\\mathrm{decay},b}}{S_{\\mathrm{decay,tot}}}$.\nThe relative error simplifies to:\n$$ \\epsilon = \\frac{S_{\\mathrm{form}} \\cdot S_{\\mathrm{decay},b} / S_{\\mathrm{decay,tot}}}{S_{\\mathrm{HF}}} - 1 $$\nThis avoids the need to calculate the prefactor $C$ and the conversion from $\\mathrm{fm}^2$ to barns, as they are irrelevant for the final unitless quantity. The implementation will compute these intermediate sums for each test case and then the relative error, which is rounded to six decimal places as required.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative error between the Hauser-Feshbach and Weisskopf-Ewing\n    cross section models for several test cases of compound nucleus reactions.\n    \"\"\"\n    \n    # Define physical constants and common parameters\n    HBARC = 197.3269804  # MeV fm\n    M_NEUTRON = 939.565  # MeV/c^2\n    MASS_PER_AMU = 931.494 # MeV/c^2\n    \n    # Common parameters for all test cases\n    s_a = 0.5  # Projectile (neutron) spin\n    m_a = M_NEUTRON\n    A_target = 59.0\n    m_A = A_target * MASS_PER_AMU\n    # Reduced mass is not needed as the prefactor cancels in relative error.\n    # mu = (m_a * m_A) / (m_a + m_A)\n\n    test_cases = [\n        {\n            \"I_A\": 7.0/2.0, \"E\": 2.0,\n            \"states\": [\n                {\"J\": 7.0/2.0, \"Ta\": 0.6, \"Tb\": 0.3, \"Trest\": 0.5},\n                {\"J\": 9.0/2.0, \"Ta\": 0.9, \"Tb\": 0.05, \"Trest\": 0.7},\n                {\"J\": 11.0/2.0, \"Ta\": 0.2, \"Tb\": 0.4, \"Trest\": 0.3},\n            ]\n        },\n        {\n            \"I_A\": 7.0/2.0, \"E\": 1.0,\n            \"states\": [\n                {\"J\": 7.0/2.0, \"Ta\": 0.95, \"Tb\": 0.02, \"Trest\": 0.90},\n                {\"J\": 9.0/2.0, \"Ta\": 0.0, \"Tb\": 0.40, \"Trest\": 0.20},\n                {\"J\": 11.0/2.0, \"Ta\": 0.0, \"Tb\": 0.10, \"Trest\": 0.40},\n            ]\n        },\n        {\n            \"I_A\": 7.0/2.0, \"E\": 3.0,\n            \"states\": [\n                {\"J\": 7.0/2.0, \"Ta\": 0.5, \"Tb\": 0.25, \"Trest\": 0.25},\n                {\"J\": 9.0/2.0, \"Ta\": 0.5, \"Tb\": 0.25, \"Trest\": 0.25},\n                {\"J\": 11.0/2.0, \"Ta\": 0.5, \"Tb\": 0.25, \"Trest\": 0.25},\n            ]\n        },\n        {\n            \"I_A\": 7.0/2.0, \"E\": 2.0,\n            \"states\": [\n                {\"J\": 7.0/2.0, \"Ta\": 0.0, \"Tb\": 0.30, \"Trest\": 0.40},\n                {\"J\": 9.0/2.0, \"Ta\": 0.8, \"Tb\": 0.10, \"Trest\": 0.60},\n                {\"J\": 11.0/2.0, \"Ta\": 0.6, \"Tb\": 0.20, \"Trest\": 0.50},\n            ]\n        },\n        {\n            \"I_A\": 7.0/2.0, \"E\": 4.0,\n            \"states\": [\n                {\"J\": 7.0/2.0, \"Ta\": 0.7, \"Tb\": 0.01, \"Trest\": 0.90},\n                {\"J\": 9.0/2.0, \"Ta\": 0.4, \"Tb\": 0.05, \"Trest\": 0.95},\n                {\"J\": 11.0/2.0, \"Ta\": 0.3, \"Tb\": 0.02, \"Trest\": 0.98},\n            ]\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Sums for the unscaled cross sections\n        sum_hf = 0.0\n        sum_form_we = 0.0\n        sum_decay_b_we = 0.0\n        sum_decay_tot_we = 0.0\n\n        for state in case[\"states\"]:\n            J = state[\"J\"]\n            Ta = state[\"Ta\"]\n            Tb = state[\"Tb\"]\n            Trest = state[\"Trest\"]\n            \n            J_weight = 2 * J + 1\n            T_tot = Tb + Trest\n\n            # Hauser-Feshbach sum\n            if T_tot  1e-12: # Avoid division by zero\n                branch_ratio_hf = Tb / T_tot\n                sum_hf += J_weight * Ta * branch_ratio_hf\n            \n            # Weisskopf-Ewing sums\n            sum_form_we += J_weight * Ta\n            sum_decay_b_we += J_weight * Tb\n            sum_decay_tot_we += J_weight * T_tot\n            \n        # Calculate the unscaled cross section terms\n        sigma_hf_unscaled = sum_hf\n        \n        if sum_decay_tot_we  1e-12:\n             branch_ratio_we = sum_decay_b_we / sum_decay_tot_we\n        else:\n            branch_ratio_we = 0.0\n        \n        sigma_we_unscaled = sum_form_we * branch_ratio_we\n\n        # Calculate relative error\n        if abs(sigma_hf_unscaled)  1e-12:\n            # If sigma_hf is zero, sigma_we is also zero under non-pathological\n            # conditions. The relative error is defined as 0.\n            relative_error = 0.0\n        else:\n            relative_error = (sigma_we_unscaled - sigma_hf_unscaled) / sigma_hf_unscaled\n            \n        results.append(round(relative_error, 6))\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3551261"}, {"introduction": "This advanced practice moves beyond the average-width picture of the basic Hauser-Feshbach model to explore the underlying statistical nature of the compound nucleus. The transmission coefficients used in the theory represent averages over a dense spectrum of fluctuating resonances. In this exercise, you will construct a Monte Carlo simulation that models these fluctuations explicitly using the physically-motivated Porter-Thomas distribution for partial decay widths, and use this more microscopic picture to verify a fundamental symmetry of nature—time-reversal invariance, via the principle of detailed balance [@problem_id:3551295].", "problem": "A compound nucleus reaction is modeled as resonant scattering between entrance and exit channels mediated by a dense spectrum of compound states. The microscopic dynamics are built upon the following principles: time-reversal invariance of the scattering matrix, unitarity of the scattering matrix, and the resonance picture of compound nucleus formation. Consider two open channels labeled $a$ and $b$ among a set of modeled channels indexed by $c \\in \\{1,\\dots,C\\}$. For each resonance labeled by $j$, assign a resonance centroid energy $E_{R,j}$ and partial widths $\\Gamma_{c,j}$ for the modeled channels. The total width for resonance $j$ is $\\Gamma_{j} = \\sum_{c=1}^{C} \\Gamma_{c,j} + \\Gamma_{\\text{miss}}$, where $\\Gamma_{\\text{miss}}$ aggregates the contribution from unmodeled channels as a constant optical absorption width per resonance. The reduced angle-integrated transition cross section for $a \\to b$ due to resonance $j$ at energy $E$ is constructed from the Breit-Wigner resonance form without the entrance channel statistical factor,\n$$\n\\tilde{\\sigma}_{a\\to b}^{(j)}(E) = \\frac{\\pi}{k_a^2} \\frac{\\Gamma_{a,j}\\,\\Gamma_{b,j}}{(E - E_{R,j})^2 + \\Gamma_{j}^2 / 4}\\,,\n$$\nwhere $k_a$ is the wave number in channel $a$. The ensemble- and energy-averaged reduced cross section is then defined as an arithmetic average over an energy grid $E \\in [E_0 - \\Delta E/2, E_0 + \\Delta E/2]$ and over the resonance ensemble.\n\nTo incorporate Width Fluctuation Corrections (WFC), the partial widths $\\Gamma_{c,j}$ must fluctuate across resonances. Model these fluctuations at fixed mean by drawing channel-specific amplitude variables $A_{c,j}$ from a zero-mean normal distribution and set $\\Gamma_{c,j} = A_{c,j}^2$, which yields a Porter-Thomas distribution (PT) for widths with one degree of freedom. The mean of the partial widths for channel $c$ is linked to the transmission coefficient $T_c$ and level density $\\rho$ via Fermi’s Golden Rule for compound nucleus decay, $T_c = 2\\pi \\rho \\,\\langle \\Gamma_c \\rangle$, so $\\langle \\Gamma_c \\rangle = T_c/(2\\pi \\rho)$. The unmodeled channels are represented by a constant optical absorption width $\\Gamma_{\\text{miss}} = T_{\\text{miss}}/(2\\pi \\rho)$, where $T_{\\text{miss}}$ is the aggregate transmission of the omitted channels.\n\nDefine the entrance-channel statistical factor $g_a$ for channel $a$. Time-reversal invariance and reciprocity imply the detailed balance condition\n$$\n\\tilde{\\sigma}_{a\\to b}\\, g_a\\, k_b^2 = \\tilde{\\sigma}_{b\\to a}\\, g_b\\, k_a^2\\,,\n$$\nwhere $\\tilde{\\sigma}_{a\\to b}$ and $\\tilde{\\sigma}_{b\\to a}$ are the energy- and ensemble-averaged reduced cross sections computed without the entrance statistical factor. The goal is to verify this equality numerically under WFC when only a subset of channels is modeled and the rest are absorbed into $\\Gamma_{\\text{miss}}$.\n\nYour task is to implement a complete, runnable program that:\n- Constructs an ensemble of $N_{\\text{res}}$ resonances with centroid energies $E_{R,j}$ uniformly distributed over an interval of width $\\Delta E$ centered at $E_0$ (in megaelectronvolts, $\\mathrm{MeV}$).\n- For each resonance and modeled channel $c$, draws amplitudes $A_{c,j}$ from a zero-mean normal distribution with variance $\\langle \\Gamma_c \\rangle$ and sets $\\Gamma_{c,j} = A_{c,j}^2$.\n- Uses an energy grid of $N_E$ points to compute the reduced cross sections $\\tilde{\\sigma}_{a\\to b}(E)$ and $\\tilde{\\sigma}_{b\\to a}(E)$ and then averages them over the grid to obtain $\\tilde{\\sigma}_{a\\to b}$ and $\\tilde{\\sigma}_{b\\to a}$.\n- Verifies the detailed balance equality by computing the dimensionless relative deviation\n$$\nD = \\frac{\\left| \\tilde{\\sigma}_{a\\to b}\\, g_a\\, k_b^2 - \\tilde{\\sigma}_{b\\to a}\\, g_b\\, k_a^2 \\right|}{\\tfrac{1}{2}\\left( \\left| \\tilde{\\sigma}_{a\\to b}\\, g_a\\, k_b^2 \\right| + \\left| \\tilde{\\sigma}_{b\\to a}\\, g_b\\, k_a^2 \\right| \\right)}\\,.\n$$\nThe program should output $D$ for each provided test case.\n\nUnits:\n- Energies $E$, $E_{R,j}$, and widths $\\Gamma$ must be handled in $\\mathrm{MeV}$.\n- Wave numbers $k_a$ and $k_b$ must be provided in inverse femtometers, $\\mathrm{fm}^{-1}$.\n- Level density $\\rho$ must be provided in states per $\\mathrm{MeV}$.\n- Transmission coefficients $T_c$ and $T_{\\text{miss}}$ are dimensionless.\n\nTest Suite:\nProvide the following test cases to evaluate correctness under different conditions. For each case, the program must compute $D$ as a floating-point number.\n\n- Case $1$ (happy path, all channels modeled):\n    - Modeled channels $C = 3$, indices $a=1$, $b=2$.\n    - $k = [\\,0.8,\\,1.2,\\,0.9\\,]$ in $\\mathrm{fm}^{-1}$ for channels $1,2,3$ respectively.\n    - $g = [\\,1.0,\\,2.0,\\,1.0\\,]$ for channels $1,2,3$ respectively.\n    - $T = [\\,0.4,\\,0.4,\\,0.2\\,]$, $T_{\\text{miss}} = 0.0$.\n    - $\\rho = 80$ in $\\mathrm{MeV}^{-1}$, $E_0 = 0.0$ in $\\mathrm{MeV}$, $\\Delta E = 0.2$ in $\\mathrm{MeV}$.\n    - $N_{\\text{res}} = 600$, $N_E = 600$.\n\n- Case $2$ (subset modeled, moderate absorption in missing channels):\n    - Modeled channels $C = 2$, indices $a=1$, $b=2$.\n    - $k = [\\,0.5,\\,1.5\\,]$ in $\\mathrm{fm}^{-1}$.\n    - $g = [\\,3.0,\\,1.0\\,]$.\n    - $T = [\\,0.3,\\,0.6\\,]$, $T_{\\text{miss}} = 0.1$.\n    - $\\rho = 50$ in $\\mathrm{MeV}^{-1}$, $E_0 = 0.0$ in $\\mathrm{MeV}$, $\\Delta E = 0.3$ in $\\mathrm{MeV}$.\n    - $N_{\\text{res}} = 800$, $N_E = 600$.\n\n- Case $3$ (edge case, strongly asymmetric transmissions and wave numbers):\n    - Modeled channels $C = 2$, indices $a=1$, $b=2$.\n    - $k = [\\,0.2,\\,1.8\\,]$ in $\\mathrm{fm}^{-1}$.\n    - $g = [\\,5.0,\\,1.0\\,]$.\n    - $T = [\\,10^{-3},\\,0.7\\,]$, $T_{\\text{miss}} = 0.3$.\n    - $\\rho = 100$ in $\\mathrm{MeV}^{-1}$, $E_0 = 0.0$ in $\\mathrm{MeV}$, $\\Delta E = 0.3$ in $\\mathrm{MeV}$.\n    - $N_{\\text{res}} = 800$, $N_E = 600$.\n\n- Case $4$ (boundary case, few resonances and no missing channels):\n    - Modeled channels $C = 2$, indices $a=1$, $b=2$.\n    - $k = [\\,1.0,\\,1.0\\,]$ in $\\mathrm{fm}^{-1}$.\n    - $g = [\\,1.0,\\,1.0\\,]$.\n    - $T = [\\,0.5,\\,0.5\\,]$, $T_{\\text{miss}} = 0.0$.\n    - $\\rho = 10$ in $\\mathrm{MeV}^{-1}$, $E_0 = 0.0$ in $\\mathrm{MeV}$, $\\Delta E = 0.1$ in $\\mathrm{MeV}$.\n    - $N_{\\text{res}} = 50$, $N_E = 200$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example,\n$$\n[\\,D_1, D_2, D_3, D_4\\,]\n$$\nwhere each $D_i$ is the floating-point relative deviation computed for the corresponding test case. No other text should be printed.", "solution": "The user's request is to validate and solve a problem in computational nuclear physics. The problem asks for a numerical verification of the detailed balance principle in the context of compound nucleus reactions, including the effect of width fluctuation corrections (WFC).\n\n**Problem Validation**\n\nThe problem statement has been critically examined and is determined to be **valid**.\n\n1.  **Givens Extraction**: All necessary parameters are provided for the model and the test cases: channel indices ($a, b, c$), number of modeled channels ($C$), wave numbers ($k_c$), statistical factors ($g_c$), transmission coefficients ($T_c, T_{\\text{miss}}$), level density ($\\rho$), energy range parameters ($E_0, \\Delta E$), and simulation parameters ($N_{\\text{res}}, N_E$).\n2.  **Scientific Grounding**: The problem is based on the well-established statistical theory of nuclear reactions (Hauser-Feshbach theory). Key concepts such as the Breit-Wigner resonance formula, the Porter-Thomas distribution for partial widths (arising from Width Fluctuation Corrections), the relationship between mean widths and transmission coefficients ($T_c = 2\\pi\\rho\\langle\\Gamma_c\\rangle$), and the principle of detailed balance are all standard and correctly formulated.\n3.  **Well-Posedness**: The problem is well-posed. The objective is to compute a dimensionless relative deviation $D$, and the formula for $D$ is explicitly provided. The computational steps are clearly outlined, leading to a unique numerical result for a given random seed.\n4.  **Consistency**: There are no internal contradictions. While the number of simulated resonances $N_{\\text{res}}$ in the energy window $\\Delta E$ implies a density $N_{\\text{res}}/\\Delta E$ that may not equal the input level density $\\rho$, this is not a contradiction. The parameter $\\rho$ is used solely to define the mean partial widths from the transmission coefficients, representing a property of the physical system being modeled. The parameter $N_{\\text{res}}$ is a numerical choice for the simulation's statistical quality within the window $\\Delta E$.\n5.  **Clarity**: The problem is expressed in precise scientific language. All terms are standard within the field of nuclear reaction theory.\n\nThe problem is a valid, well-defined task in computational physics.\n\n**Principle-Based Solution Design**\n\nThe goal is to numerically verify the detailed balance relation for channel-to-channel transitions, $a \\to b$, in a compound nucleus reaction. This relation, a consequence of time-reversal invariance, states:\n$$\n\\tilde{\\sigma}_{a\\to b}\\, g_a\\, k_b^2 = \\tilde{\\sigma}_{b\\to a}\\, g_b\\, k_a^2\n$$\nwhere $\\tilde{\\sigma}_{a\\to b}$ is the energy- and ensemble-averaged reduced cross section (i.e., without the entrance channel statistical factor $g_a$), $g_a$ is the statistical factor for the entrance channel, and $k_a$ is the wave number. The verification will be performed via a Monte Carlo simulation of the reaction process based on a statistical resonance model.\n\n**1. Modeling the Compound Nucleus Resonances**\n\nThe compound nucleus is modeled as a set of $N_{\\text{res}}$ discrete resonant states. Each resonance $j$ is characterized by its energy $E_{R,j}$ and its partial decay widths $\\Gamma_{c,j}$ into the various open channels $c$.\n\n-   **Resonance Energies**: The $N_{\\text{res}}$ resonance centroid energies $E_{R,j}$ are sampled from a uniform distribution over an energy interval $[E_0 - \\Delta E/2, E_0 + \\Delta E/2]$.\n\n-   **Partial Widths and Width Fluctuation Corrections (WFC)**: The partial widths $\\Gamma_{c,j}$ are not constant but fluctuate from one resonance to another. This is a crucial physical effect. We model this by assuming the partial width amplitudes $A_{c,j}$ are drawn from a zero-mean Gaussian distribution. The partial width is then $\\Gamma_{c,j} = A_{c,j}^2$. This results in the partial widths following a Porter-Thomas distribution (a $\\chi^2$ distribution with one degree of freedom). The mean of this distribution, $\\langle\\Gamma_c\\rangle$, is determined by the channel's transmission coefficient $T_c$ and the nuclear level density $\\rho$ through the relation:\n    $$\n    \\langle \\Gamma_c \\rangle = \\frac{T_c}{2\\pi\\rho}\n    $$\n    To generate widths with this mean, the amplitudes $A_{c,j}$ for a channel $c$ are sampled from a normal distribution $\\mathcal{N}(0, \\sigma_c^2)$ with variance $\\sigma_c^2 = \\langle\\Gamma_c\\rangle$.\n\n-   **Total Widths**: The total decay width of a resonance $j$, $\\Gamma_j$, is the sum of its partial widths over all channels, including both the explicitly modeled channels ($c=1, \\dots, C$) and any unmodeled channels. The contribution from unmodeled channels is treated as a constant absorption width $\\Gamma_{\\text{miss}}$, calculated similarly from an aggregate transmission coefficient $T_{\\text{miss}}$:\n    $$\n    \\Gamma_j = \\left( \\sum_{c=1}^{C} \\Gamma_{c,j} \\right) + \\Gamma_{\\text{miss}} \\quad \\text{where} \\quad \\Gamma_{\\text{miss}} = \\frac{T_{\\text{miss}}}{2\\pi\\rho}\n    $$\n\n**2. Calculating the Cross Section**\n\nThe contribution of a single resonance $j$ to the reduced cross section for the transition $a \\to b$ at an incident energy $E$ is given by the Breit-Wigner formula:\n$$\n\\tilde{\\sigma}_{a\\to b}^{(j)}(E) = \\frac{\\pi}{k_a^2} \\frac{\\Gamma_{a,j}\\,\\Gamma_{b,j}}{(E - E_{R,j})^2 + \\Gamma_{j}^2 / 4}\n$$\nThe total reduced cross section at energy $E$ is the incoherent sum of contributions from all resonances:\n$$\n\\tilde{\\sigma}_{a\\to b}(E) = \\sum_{j=1}^{N_{\\text{res}}} \\tilde{\\sigma}_{a\\to b}^{(j)}(E)\n$$\nThis represents the cross section that would be observed experimentally at energy $E$. To obtain the averaged cross section $\\tilde{\\sigma}_{a\\to b}$ required for the detailed balance check, we compute the arithmetic mean of $\\tilde{\\sigma}_{a\\to b}(E)$ over a fine grid of $N_E$ energy points spanning the interval $[E_0 - \\Delta E/2, E_0 + \\Delta E/2]$.\n\n**3. Algorithmic Implementation**\n\nThe simulation will be implemented using Python and the `numpy` library for efficient vectorized computation. A fixed random seed ensures reproducibility.\n\nThe algorithm proceeds as follows for each test case:\n1.  **Initialization**: Based on the input parameters ($T_c, \\rho, T_{\\text{miss}}$), calculate the mean partial widths $\\langle\\Gamma_c\\rangle$ and the missing width $\\Gamma_{\\text{miss}}$.\n2.  **Ensemble Generation**:\n    -   Generate an array of $N_{\\text{res}}$ resonance energies $E_{R,j}$ using `numpy.random.uniform`.\n    -   For each of the $C$ modeled channels, generate an array of $N_{\\text{res}}$ partial width amplitudes $A_{c,j}$ from $\\mathcal{N}(0, \\langle\\Gamma_c\\rangle)$. This is done by sampling from a standard normal distribution and scaling by $\\sqrt{\\langle\\Gamma_c\\rangle}$.\n    -   Square the amplitudes to get the partial widths $\\Gamma_{c,j}$. This yields a matrix of size $(N_{\\text{res}}, C)$.\n    -   Compute the array of total widths $\\Gamma_j$ by summing the partial widths for each resonance and adding $\\Gamma_{\\text{miss}}$.\n3.  **Cross Section Calculation**:\n    -   Define an energy grid of $N_E$ points.\n    -   Using `numpy` broadcasting, the calculation of $\\tilde{\\sigma}_{a\\to b}^{(j)}(E_i)$ for all resonances $j$ and energy points $i$ is performed in a vectorized manner, avoiding explicit loops over energy or resonances. A matrix of cross section contributions of size $(N_E, N_{\\text{res}})$ is computed.\n    -   The total cross section at each energy, $\\tilde{\\sigma}_{a\\to b}(E_i)$, is found by summing this matrix along the resonance axis.\n    -   The final averaged cross section, $\\tilde{\\sigma}_{a\\to b}$, is the mean of the resulting array of energy-dependent cross sections.\n    -   This process is repeated for the reverse reaction, $\\tilde{\\sigma}_{b\\to a}$.\n4.  **Verification**: The dimensionless relative deviation $D$ is computed using the provided formula:\n    $$\n    D = \\frac{\\left| \\tilde{\\sigma}_{a\\to b}\\, g_a\\, k_b^2 - \\tilde{\\sigma}_{b\\to a}\\, g_b\\, k_a^2 \\right|}{\\tfrac{1}{2}\\left( \\left| \\tilde{\\sigma}_{a\\to b}\\, g_a\\, k_b^2 \\right| + \\left| \\tilde{\\sigma}_{b\\to a}\\, g_b\\, k_a^2 \\right| \\right)}\n    $$\n    A small value of $D$ indicates that the detailed balance principle holds, within the statistical uncertainty of the simulation.\n\nThis computational approach provides a direct numerical test of a fundamental symmetry principle within a standard, physically motivated statistical model.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Use a fixed random seed for reproducibility of the Monte Carlo simulation.\n    RANDOM_SEED = 42\n    \n    # Test cases as defined in the problem statement.\n    test_cases = [\n        # Case 1: happy path, all channels modeled\n        {\n            \"C\": 3, \"a\": 1, \"b\": 2,\n            \"k\": np.array([0.8, 1.2, 0.9]),\n            \"g\": np.array([1.0, 2.0, 1.0]),\n            \"T\": np.array([0.4, 0.4, 0.2]),\n            \"T_miss\": 0.0,\n            \"rho\": 80.0, \"E0\": 0.0, \"DeltaE\": 0.2,\n            \"N_res\": 600, \"N_E\": 600,\n        },\n        # Case 2: subset modeled, moderate absorption in missing channels\n        {\n            \"C\": 2, \"a\": 1, \"b\": 2,\n            \"k\": np.array([0.5, 1.5]),\n            \"g\": np.array([3.0, 1.0]),\n            \"T\": np.array([0.3, 0.6]),\n            \"T_miss\": 0.1,\n            \"rho\": 50.0, \"E0\": 0.0, \"DeltaE\": 0.3,\n            \"N_res\": 800, \"N_E\": 600,\n        },\n        # Case 3: edge case, strongly asymmetric transmissions and wave numbers\n        {\n            \"C\": 2, \"a\": 1, \"b\": 2,\n            \"k\": np.array([0.2, 1.8]),\n            \"g\": np.array([5.0, 1.0]),\n            \"T\": np.array([1e-3, 0.7]),\n            \"T_miss\": 0.3,\n            \"rho\": 100.0, \"E0\": 0.0, \"DeltaE\": 0.3,\n            \"N_res\": 800, \"N_E\": 600,\n        },\n        # Case 4: boundary case, few resonances and no missing channels\n        {\n            \"C\": 2, \"a\": 1, \"b\": 2,\n            \"k\": np.array([1.0, 1.0]),\n            \"g\": np.array([1.0, 1.0]),\n            \"T\": np.array([0.5, 0.5]),\n            \"T_miss\": 0.0,\n            \"rho\": 10.0, \"E0\": 0.0, \"DeltaE\": 0.1,\n            \"N_res\": 50, \"N_E\": 200,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = _compute_deviation(params, seed=RANDOM_SEED)\n        results.append(result)\n\n    # Format the final output as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _compute_deviation(params, seed):\n    \"\"\"\n    Computes the relative deviation D for a single test case.\n    \"\"\"\n    # Unpack parameters\n    C = params[\"C\"]\n    a_idx, b_idx = params[\"a\"] - 1, params[\"b\"] - 1\n    k, g, T = params[\"k\"], params[\"g\"], params[\"T\"]\n    T_miss, rho = params[\"T_miss\"], params[\"rho\"]\n    E0, DeltaE = params[\"E0\"], params[\"DeltaE\"]\n    N_res, N_E = params[\"N_res\"], params[\"N_E\"]\n\n    rng = np.random.default_rng(seed)\n\n    # 1. Calculate mean widths and missing width\n    mean_Gamma_c = T / (2.0 * np.pi * rho)\n    Gamma_miss = T_miss / (2.0 * np.pi * rho)\n\n    # 2. Generate resonance ensemble\n    # Resonance energies\n    E_R_j = rng.uniform(low=E0 - DeltaE / 2.0, high=E0 + DeltaE / 2.0, size=N_res)\n\n    # Partial widths (from Porter-Thomas distribution)\n    # Amplitudes A_cj are drawn from N(0, mean_Gamma_c)\n    # std_dev = sqrt(variance), variance = mean_Gamma_c\n    std_dev_c = np.sqrt(mean_Gamma_c)\n    # Generate standard normal variates and scale them\n    A_cj = rng.normal(loc=0.0, scale=1.0, size=(N_res, C)) * std_dev_c\n    Gamma_cj = A_cj**2  # Shape: (N_res, C)\n\n    # Total widths\n    Gamma_j = np.sum(Gamma_cj, axis=1) + Gamma_miss # Shape: (N_res,)\n\n    # 3. Calculate energy-averaged cross sections\n    # Energy grid\n    E_grid = np.linspace(E0 - DeltaE / 2.0, E0 + DeltaE / 2.0, N_E)\n\n    # Use broadcasting for vectorized calculation\n    # Reshape for broadcasting: E_grid (N_E, 1), E_R_j (N_res,), Gamma_j (N_res,)\n    E_grid_reshaped = E_grid[:, np.newaxis] \n\n    # Breit-Wigner denominator term, shape (N_E, N_res)\n    denominator = (E_grid_reshaped - E_R_j)**2 + (Gamma_j**2) / 4.0\n\n    # Numerator term for a-b cross section, shape (N_res,)\n    Gamma_a_j = Gamma_cj[:, a_idx]\n    Gamma_b_j = Gamma_cj[:, b_idx]\n    numerator_ab = Gamma_a_j * Gamma_b_j\n\n    # Reduced cross section for a-b, shape (N_E, N_res)\n    k_a = k[a_idx]\n    sigma_j_ab_matrix = (np.pi / k_a**2) * (numerator_ab / denominator)\n\n    # Total cross section at each energy by summing over resonances, shape (N_E,)\n    sigma_E_ab = np.sum(sigma_j_ab_matrix, axis=1)\n    \n    # Energy-averaged cross section\n    avg_sigma_ab = np.mean(sigma_E_ab)\n\n    # Repeat for b-a. Numerator is the same, just k_b is different.\n    k_b = k[b_idx]\n    sigma_j_ba_matrix = (np.pi / k_b**2) * (numerator_ab / denominator)\n    sigma_E_ba = np.sum(sigma_j_ba_matrix, axis=1)\n    avg_sigma_ba = np.mean(sigma_E_ba)\n\n    # 4. Compute detailed balance deviation D\n    g_a, g_b = g[a_idx], g[b_idx]\n\n    lhs = avg_sigma_ab * g_a * k_b**2\n    rhs = avg_sigma_ba * g_b * k_a**2\n\n    numerator_D = np.abs(lhs - rhs)\n    denominator_D = 0.5 * (np.abs(lhs) + np.abs(rhs))\n    \n    # Handle case where denominator is zero to avoid division errors\n    if denominator_D == 0:\n        return 0.0\n    else:\n        return numerator_D / denominator_D\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3551295"}]}