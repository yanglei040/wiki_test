{"hands_on_practices": [{"introduction": "The journey of a supernova explosion begins with a powerful shockwave born from the core's rebound. However, this shock quickly loses energy as it plows through the dense, iron-rich outer layers of the star. This exercise provides a crucial quantitative look at this energy loss by calculating the energy required to dissociate iron nuclei into free protons and neutrons, a process known as photodisintegration. By comparing this dissociation energy to the shock's kinetic energy, you will gain a fundamental understanding of why the initial shock stalls, setting the stage for the \"delayed\" explosion mechanism [@problem_id:3570479].", "problem": "In computational models of core-collapse supernovae, the accretion shock propagating into iron-group nuclei loses energy to nuclear dissociation, which acts as a sink in the shock energy budget. Consider an upstream flow composed entirely of iron-56 nuclei that is instantaneously dissociated into free nucleons at the shock. The upstream mass density is $\\rho_1 = 10^{10}\\,\\mathrm{g\\,cm^{-3}}$ and the upstream speed is $v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$. Treat the upstream kinetic energy as nonrelativistic. Use the following data:\n- Iron binding energy per nucleon $E_b = 8.8\\,\\mathrm{MeV}$.\n- Electron volt definition $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$.\n- Atomic mass unit (nucleon mass) $m_u = 1.66053906660 \\times 10^{-24}\\,\\mathrm{g}$.\n- Centimeter-gram-second (CGS) units throughout.\n\nCompute the fraction of the incoming upstream kinetic energy per unit mass that is consumed by iron dissociation across the shock. Express your final answer as a decimal number without units, and round your answer to three significant figures.", "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n-   Upstream medium composition: Iron-56 nuclei ($^{56}\\mathrm{Fe}$).\n-   Upstream mass density: $\\rho_1 = 10^{10}\\,\\mathrm{g\\,cm^{-3}}$.\n-   Upstream speed: $v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$.\n-   Kinetic energy model: Nonrelativistic.\n-   Binding energy of iron-56 per nucleon: $E_b = 8.8\\,\\mathrm{MeV}$.\n-   Conversion constant: $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$.\n-   Atomic mass unit (used as nucleon mass): $m_u = 1.66053906660 \\times 10^{-24}\\,\\mathrm{g}$.\n-   Task: Compute the fraction of incoming kinetic energy per unit mass consumed by iron dissociation.\n-   Output format: Decimal number rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem describes the energy cost of nuclear dissociation in a supernova shock, a standard and critical process in astrophysics. The provided physical values for density, velocity, and binding energy are realistic for this environment. The non-relativistic assumption for a speed of $v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$ (which is approximately $0.067c$, where $c$ is the speed of light) is a reasonable approximation. The problem is clearly stated, provides all necessary data for its solution, and does not contain scientific or logical contradictions. The upstream density $\\rho_1$ is contextual information and not required for the calculation of the requested ratio of energies per unit mass, which does not render the problem invalid. The problem is deemed valid.\n\n**Step 3: Proceed to Solution**\n\nThe goal is to compute the fraction $f$, defined as the ratio of the energy consumed by dissociation per unit mass, $\\mathcal{E}_{diss}$, to the incoming kinetic energy per unit mass, $\\mathcal{K}_1$.\n$$\nf = \\frac{\\mathcal{E}_{diss}}{\\mathcal{K}_1}\n$$\n\nFirst, we calculate the incoming kinetic energy per unit mass, $\\mathcal{K}_1$. Based on the non-relativistic approximation, the kinetic energy of a parcel of mass $m$ is $K_1 = \\frac{1}{2} m v_1^2$. The kinetic energy per unit mass is therefore:\n$$\n\\mathcal{K}_1 = \\frac{K_1}{m} = \\frac{1}{2} v_1^2\n$$\nSubstituting the given value for $v_1$:\n$$\n\\mathcal{K}_1 = \\frac{1}{2} \\left(2 \\times 10^9\\,\\mathrm{cm\\,s^{-1}}\\right)^2 = \\frac{1}{2} \\left(4 \\times 10^{18}\\,\\mathrm{cm^2\\,s^{-2}}\\right) = 2 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}\n$$\nNote that in CGS units, $1\\,\\mathrm{erg} = 1\\,\\mathrm{g\\,cm^2\\,s^{-2}}$.\n\nNext, we calculate the energy consumed by dissociation per unit mass, $\\mathcal{E}_{diss}$. The upstream material is specified as iron-56, which is dissociated into free nucleons. The energy cost for this process is given by the binding energy. The provided binding energy is $E_b = 8.8\\,\\mathrm{MeV}$ per nucleon. The energy required to dissociate a mass $m$ of iron is this energy per nucleon multiplied by the number of nucleons in that mass. The number of nucleons in a mass $m$ is $m/m_{nucleon}$, where $m_{nucleon}$ is the mass of a single nucleon, which we are to approximate as $m_u$.\nTherefore, the dissociation energy per unit mass is the binding energy per nucleon divided by the mass of a nucleon.\n$$\n\\mathcal{E}_{diss} = \\frac{E_b}{m_u}\n$$\nWe must convert $E_b$ from units of $\\mathrm{MeV}$ to ergs to maintain consistency in the CGS system.\nThe binding energy per nucleon in ergs is:\n$$\nE_b = 8.8\\,\\mathrm{MeV} = 8.8 \\times 10^6\\,\\mathrm{eV} \\times \\left(\\frac{1.602176634 \\times 10^{-12}\\,\\mathrm{erg}}{1\\,\\mathrm{eV}}\\right)\n$$\n$$\nE_b = 1.40991543792 \\times 10^{-5}\\,\\mathrm{erg}\n$$\nNow, we can compute $\\mathcal{E}_{diss}$ using the given value for $m_u$:\n$$\n\\mathcal{E}_{diss} = \\frac{1.40991543792 \\times 10^{-5}\\,\\mathrm{erg}}{1.66053906660 \\times 10^{-24}\\,\\mathrm{g}} \\approx 8.4907106 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}\n$$\n\nFinally, we compute the desired fraction $f$ by taking the ratio of $\\mathcal{E}_{diss}$ to $\\mathcal{K}_1$:\n$$\nf = \\frac{\\mathcal{E}_{diss}}{\\mathcal{K}_1} = \\frac{8.4907106 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}}{2 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}}\n$$\n$$\nf \\approx 4.2453553\n$$\nThe result being greater than $1$ has a profound physical implication: the kinetic energy of the infalling material is insufficient to power its own dissociation. This is a primary reason why the accretion shock stalls in supernova models, necessitating an additional energy-driving mechanism (such as neutrino heating) for a successful explosion.\n\nThe problem asks for the answer to be rounded to three significant figures.\n$$\nf \\approx 4.25\n$$", "answer": "$$\n\\boxed{4.25}\n$$", "id": "3570479"}, {"introduction": "With the supernova shock stalled, a new energy source is required to revive it and power the explosion. The leading theory points to the immense flux of neutrinos pouring out of the newly-formed proto-neutron star. This practice guides you through a fundamental calculation in supernova theory: estimating the rate at which neutrinos deposit energy in the \"gain region\" behind the shock and the characteristic timescale for this heating to overcome the gravitational binding of the material [@problem_id:3570457]. This exercise demonstrates the viability of the neutrino-driven mechanism and highlights the key physical parameters that govern its efficiency.", "problem": "Consider neutrino heating in the gain region of a core-collapse supernova surrounding a Proto-Neutron Star (PNS). Assume free-streaming electron neutrinos with luminosity $L_{\\nu_e}$ and a luminosity-weighted mean-squared neutrino energy $\\langle E_{\\nu_e}^2\\rangle$. The dominant heating channel is charged-current absorption of electron neutrinos on free neutrons, $\\nu_e + n \\rightarrow p + e^{-}$, in optically thin conditions. Adopt the standard low-energy charged-current cross section approximation $\\sigma_{\\mathrm{abs}}(E_{\\nu}) \\approx \\sigma_0 \\left(E_{\\nu}/\\mathrm{MeV}\\right)^2$ with $\\sigma_0 = 9.2\\times 10^{-44}\\,\\mathrm{cm^2}$, neglecting weak magnetism, recoil, and final-state blocking. Assume the matter is a free nucleon gas with electron fraction $Y_e$, so the free neutron fraction is $Y_n = 1 - Y_e$. Take the baryon mass to be $m_b$ and the enclosed mass to be $M$. The neutrino energy flux at radius $r$ is $F_{E,\\nu_e} = L_{\\nu_e}/(4\\pi r^2)$. Work in the optically thin limit so that the energy deposition per unit mass is given by the product of the absorption coefficient and the energy flux.\n\nStarting from these fundamentals and the definition of the number density of neutrons $n_n = Y_n \\rho/m_b$, derive the expression for the specific heating rate $\\dot{q}$ (energy deposition rate per unit mass) in terms of $L_{\\nu_e}$, $r$, $Y_n$, $\\langle E_{\\nu_e}^2\\rangle$, $\\sigma_0$, and $m_b$. Carefully justify any spectral averaging that you use. Then evaluate $\\dot{q}$ numerically for\n- $L_{\\nu_e} = 3.0\\times 10^{52}\\,\\mathrm{erg\\,s^{-1}}$,\n- $\\langle E_{\\nu_e}^2\\rangle = (12\\,\\mathrm{MeV})^2$,\n- $r = 150\\,\\mathrm{km}$,\n- $\\rho = 10^9\\,\\mathrm{g\\,cm^{-3}}$,\n- $Y_e = 0.5$ (so $Y_n = 0.5$),\n- $m_b = 1.674\\times 10^{-24}\\,\\mathrm{g}$,\n- $M = 1.4\\,M_{\\odot}$ with $M_{\\odot} = 1.98847\\times 10^{33}\\,\\mathrm{g}$,\n- Newton’s gravitational constant $G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$.\n\nUsing the gravitational binding energy per baryon $e_{\\mathrm{bind}} = G M m_b / r$, compute the heating timescale $t_{\\mathrm{heat}} = |e_{\\mathrm{bind}}|/\\dot{q}_b$, where $\\dot{q}_b$ is the heating rate per baryon. Express your answers as follows:\n- $\\dot{q}$ in $\\mathrm{erg\\,g^{-1}\\,s^{-1}}$,\n- $t_{\\mathrm{heat}}$ in $\\mathrm{s}$.\n\nRound both answers to three significant figures.", "solution": "We begin from the energy deposition per unit volume due to charged-current absorption of electron neutrinos on free neutrons in the optically thin regime. The energy absorbed per unit volume per unit time is\n$$\n\\dot{Q}_{\\mathrm{vol}} \\;=\\; \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu})\\, \\sigma_{\\mathrm{abs}}(E_{\\nu})\\, n_n,\n$$\nwhere $E_{\\nu}$ is the neutrino energy, $\\Phi_{\\nu}(E_{\\nu})$ is the differential number flux (number per unit area per unit time per unit energy), $\\sigma_{\\mathrm{abs}}(E_{\\nu})$ is the absorption cross section, and $n_n = Y_n \\rho/m_b$ is the neutron number density. The specific heating rate (per unit mass) is $\\dot{q} = \\dot{Q}_{\\mathrm{vol}}/\\rho$, hence\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b} \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu})\\, \\sigma_{\\mathrm{abs}}(E_{\\nu}).\n$$\n\nUsing the low-energy cross section approximation $\\sigma_{\\mathrm{abs}}(E_{\\nu}) = \\sigma_0 \\left(E_{\\nu}/\\mathrm{MeV}\\right)^2$, we write\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0 \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) \\left(\\frac{E_{\\nu}}{\\mathrm{MeV}}\\right)^2.\n$$\nDefine the energy flux $F_{E,\\nu_e} = \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) = L_{\\nu_e}/(4\\pi r^2)$. To connect the cross section’s $E_{\\nu}^2$ dependence to a single spectral parameter, introduce the luminosity-weighted mean-squared energy\n$$\n\\langle E_{\\nu_e}^2 \\rangle \\;\\equiv\\; \\frac{\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu})}{\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu} \\Phi_{\\nu}(E_{\\nu})}.\n$$\nThis is the natural average for processes where the cross section scales as $E_{\\nu}^2$ and the quantity transported is energy. With this definition,\n$$\n\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu}) \\;=\\; \\langle E_{\\nu_e}^2 \\rangle \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu} \\Phi_{\\nu}(E_{\\nu}) \\;=\\; \\langle E_{\\nu_e}^2 \\rangle\\, F_{E,\\nu_e}.\n$$\nHowever, care is required with units. The cross section is expressed as $\\sigma_0 (E_{\\nu}/\\mathrm{MeV})^2$, with $\\sigma_0$ in $\\mathrm{cm^2}$. Let $\\alpha \\equiv 1\\,\\mathrm{MeV}$ expressed in ergs, so $\\alpha = 1.602176634\\times 10^{-6}\\,\\mathrm{erg}$. Then $(E_{\\nu}/\\mathrm{MeV})^2 = (E_{\\nu}/\\alpha)^2$, and\n$$\n\\int \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) \\left(\\frac{E_{\\nu}}{\\mathrm{MeV}}\\right)^2\n\\;=\\; \\alpha^{-2} \\int \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu})\n\\;=\\; \\alpha^{-2}\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}}\\, F_{E,\\nu_e},\n$$\nwhere $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}}$ is the luminosity-weighted mean-squared energy computed with $E_{\\nu}$ in ergs. Since $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}} = \\alpha^2 \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}$, the $\\alpha$ factors cancel, yielding the compact result\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}\\, F_{E,\\nu_e}\n\\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}\\, \\frac{L_{\\nu_e}}{4\\pi r^2}.\n$$\nThus, in the optically thin limit, $\\dot{q}$ is independent of the mass density $\\rho$; the explicit factor of $\\rho$ from $n_n$ cancels when dividing by $\\rho$ to obtain the specific rate.\n\nNext, we compute the heating rate per unit mass numerically. Insert the data:\n- $L_{\\nu_e} = 3.0\\times 10^{52}\\,\\mathrm{erg\\,s^{-1}}$,\n- $r = 150\\,\\mathrm{km} = 1.50\\times 10^{7}\\,\\mathrm{cm}$,\n- $Y_e = 0.5$ so $Y_n = 0.5$,\n- $m_b = 1.674\\times 10^{-24}\\,\\mathrm{g}$,\n- $\\sigma_0 = 9.2\\times 10^{-44}\\,\\mathrm{cm^2}$,\n- $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}} = (12\\,\\mathrm{MeV})^2 = 144\\,\\mathrm{MeV^2}$.\n\nCompute the energy flux:\n$$\nF_{E,\\nu_e} \\;=\\; \\frac{L_{\\nu_e}}{4\\pi r^2}\n\\;=\\; \\frac{3.0\\times 10^{52}}{4\\pi\\,(1.50\\times 10^{7})^2}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}\n\\;=\\; \\frac{3.0\\times 10^{52}}{2.827433388\\times 10^{15}}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}\n\\;\\approx\\; 1.06103\\times 10^{37}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}.\n$$\nCompute the effective absorption coefficient per unit mass:\n$$\n\\kappa_a \\;=\\; \\frac{Y_n}{m_b}\\,\\sigma_0\\,\\langle E_{\\nu_e}^2\\rangle_{\\mathrm{MeV}}\n\\;=\\; \\frac{0.5}{1.674\\times 10^{-24}} \\times (9.2\\times 10^{-44}) \\times 144 \\;\\mathrm{cm^2\\,g^{-1}}\n\\;\\approx\\; 3.96\\times 10^{-18}\\,\\mathrm{cm^2\\,g^{-1}}.\n$$\nTherefore,\n$$\n\\dot{q} \\;=\\; \\kappa_a\\, F_{E,\\nu_e}\n\\;\\approx\\; (3.96\\times 10^{-18}) \\times (1.06103\\times 10^{37})\\;\\mathrm{erg\\,g^{-1}\\,s^{-1}}\n\\;\\approx\\; 4.20\\times 10^{19}\\,\\mathrm{erg\\,g^{-1}\\,s^{-1}}.\n$$\n\nFor the heating timescale, the problem defines the gravitational binding energy per baryon as $e_{\\mathrm{bind}} = G M m_b / r$. The heating timescale based on per-baryon energetics is $t_{\\mathrm{heat}} = |e_{\\mathrm{bind}}|/\\dot{q}_b$, where $\\dot{q}_b$ is the heating rate per baryon. Noting that $\\dot{q}_b = \\dot{q}\\, m_b$ and $e_{\\mathrm{bind}} = (G M/r)\\, m_b$, the factor of $m_b$ cancels, so the timescale can equivalently be computed using the per-mass binding energy $e_{\\mathrm{bind}}^{\\mathrm{(mass)}} = G M / r$:\n$$\nt_{\\mathrm{heat}} \\;=\\; \\frac{G M / r}{\\dot{q}}.\n$$\nNow evaluate $G M / r$ with $M = 1.4\\,M_{\\odot}$, $M_{\\odot} = 1.98847\\times 10^{33}\\,\\mathrm{g}$, $G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$, and $r = 1.50\\times 10^{7}\\,\\mathrm{cm}$:\n$$\nM \\;=\\; 1.4 \\times 1.98847\\times 10^{33}\\,\\mathrm{g} \\;=\\; 2.783858\\times 10^{33}\\,\\mathrm{g},\n$$\n$$\n\\frac{G M}{r} \\;=\\; \\frac{6.67430\\times 10^{-8}\\times 2.783858\\times 10^{33}}{1.50\\times 10^{7}}\\,\\mathrm{erg\\,g^{-1}}\n\\;\\approx\\; 1.23869\\times 10^{19}\\,\\mathrm{erg\\,g^{-1}}.\n$$\nThus,\n$$\nt_{\\mathrm{heat}} \\;=\\; \\frac{1.23869\\times 10^{19}}{4.20\\times 10^{19}}\\,\\mathrm{s}\n\\;\\approx\\; 0.295\\,\\mathrm{s}.\n$$\n\nTo summarize with the requested rounding to three significant figures:\n- $\\dot{q} \\approx 4.20\\times 10^{19}\\,\\mathrm{erg\\,g^{-1}\\,s^{-1}}$,\n- $t_{\\mathrm{heat}} \\approx 0.295\\,\\mathrm{s}$.\n\nThese values are physically plausible for gain-region heating by electron neutrinos at the given radius and luminosity, and the cancellation of $\\rho$ in the specific heating rate reflects the optically thin, absorption-limited regime.", "answer": "$$\\boxed{\\begin{pmatrix}4.20\\times 10^{19}  0.295\\end{pmatrix}}$$", "id": "3570457"}, {"introduction": "Bridging the gap between physical theory and practical simulation requires building numerical schemes that respect fundamental conservation laws. This problem challenges you to design and implement a method for evolving electron lepton number, a quantity that must be conserved by the weak interactions that mediate neutrino production and absorption. You will construct an operator-split, implicit-explicit (IMEX) scheme to handle both fluid advection and stiff reaction source terms, verifying that your implementation conserves the total lepton number to machine precision [@problem_id:3570423]. This is a core task in computational astrophysics that underscores the importance of robust and conservative algorithms.", "problem": "You are tasked with designing and implementing a numerically conservative implicit-explicit scheme for stiff weak-interaction source terms in a one-dimensional model of electron lepton number evolution relevant to core-collapse supernovae. Your goal is to construct a method that conserves the total electron lepton number to machine precision and to verify this conservation by tracking the spatial integral of the total electron lepton content over time. All quantities are nondimensionalized; express all final numerical results as dimensionless floating-point numbers.\n\nConsider a one-dimensional periodic domain of length $L$, discretized into $N$ uniform finite-volume cells of width $\\Delta x = L/N$, with cell centers at $x_i$. Let $\\rho(x,t)$ denote the mass density, $Y_e(x,t)$ denote the electron fraction (electrons per baryon), and $Y_{\\nu_e}(x,t)$ denote the electron neutrino fraction (electron neutrino number per baryon). The velocity field $u(x)$ is prescribed and time-independent, representing a compressible inflow pattern. Weak interactions are modeled by a stiff electron-capture source that transfers electron lepton number from electrons to electron neutrinos without leakage, so that the local source terms form a conservative pair.\n\nThe governing equations in conservation form are:\n- Continuity: $\\partial_t \\rho + \\partial_x (\\rho u) = 0$.\n- Electron fraction: $\\partial_t(\\rho Y_e) + \\partial_x(\\rho Y_e u) = - \\rho \\, \\mathcal{R}$.\n- Electron neutrino fraction: $\\partial_t(\\rho Y_{\\nu_e}) + \\partial_x(\\rho Y_{\\nu_e} u) = + \\rho \\, \\mathcal{R}$.\n\nHere $\\mathcal{R}$ is a stiff interaction rate. Assume the following physically motivated but simplified closure:\n- The velocity is $u(x) = - U_0 \\sin(2\\pi x/L)$.\n- The reaction rate is $\\mathcal{R} = \\lambda(\\rho)\\, \\big(Y_e - Y_e^{\\mathrm{eq}}(\\rho)\\big)$ with $\\lambda(\\rho) = \\lambda_0 \\rho$ and $Y_e^{\\mathrm{eq}}(\\rho) = 0.05 + 0.45\\,[1 + (\\rho/5)^2]^{-1}$.\n\nInitial conditions at $t=0$ are:\n- $\\rho(x,0) = 1.0 + 0.1 \\cos(2\\pi x/L)$,\n- $Y_e(x,0) = 0.45 + 0.05 \\sin(2\\pi x/L)$,\n- $Y_{\\nu_e}(x,0) = 10^{-6}$.\n\nAll numbers are dimensionless.\n\nDesign an implicit-explicit time-stepping method as follows:\n- Use a first-order conservative upwind finite-volume method to discretize the advective fluxes for $\\rho$, $\\rho Y_e$, and $\\rho Y_{\\nu_e}$, taken explicitly in time with a Courant–Friedrichs–Lewy (CFL) time step constraint.\n- Treat the stiff source terms with a fully implicit update at each cell that preserves the local sum $Y_e + Y_{\\nu_e}$ during the source substep to machine precision. Your derivation must start only from the governing equations and the definition of the reaction rate; do not assume any pre-derived update formula.\n\nLet $\\mathcal{L}(t)$ denote the conserved total electron lepton content, defined by the mass-weighted spatial integral\n$$\n\\mathcal{L}(t) = \\int_0^L \\rho(x,t)\\,\\big(Y_e(x,t) + Y_{\\nu_e}(x,t)\\big)\\, dx.\n$$\nUnder periodic boundary conditions and in the absence of lepton leakage, the equations imply that $\\mathcal{L}(t)$ is conserved in time. Your numerical method must preserve $\\mathcal{L}(t)$ to within round-off error for arbitrary stiffness controlled by $\\lambda_0$.\n\nImplementation requirements:\n- Use a uniform grid with periodic boundary conditions.\n- Use a time step $\\Delta t$ given by the CFL condition $\\Delta t = \\mathrm{CFL} \\, \\Delta x / \\max_i |u_{i+\\frac{1}{2}}|$, where $u_{i+\\frac{1}{2}}$ is the velocity at face $i+\\frac{1}{2}$, approximated by the analytic $u(x)$ evaluated at face locations. When $\\max_i |u_{i+\\frac{1}{2}}| = 0$, set $\\Delta t$ to the remaining time to reach final time $T$ in a single step.\n- Use a first-order Godunov upwind flux for each conserved field. For example, the flux of a conserved field $q$ through face $i+\\frac{1}{2}$ is $F_{i+\\frac{1}{2}} = u_{i+\\frac{1}{2}} \\, q^{\\mathrm{up}}_{i+\\frac{1}{2}}$ with the upwind state chosen from the left cell if $u_{i+\\frac{1}{2}} \\ge 0$ and from the right cell otherwise.\n- Use operator splitting: apply the explicit advection step to $\\rho$, $\\rho Y_e$, and $\\rho Y_{\\nu_e}$, then apply the implicit reaction step locally at each cell to $Y_e$ and $Y_{\\nu_e}$ with $\\rho$ held fixed during the source substep.\n\nVerification target:\n- For each test case, compute the initial value $\\mathcal{L}(0)$ and the final value $\\mathcal{L}(T)$. Report the absolute relative drift $|\\mathcal{L}(T) - \\mathcal{L}(0)| / \\mathcal{L}(0)$ as a floating-point number.\n\nTest suite:\nProvide a single program that runs the following four test cases and outputs the four drifts in a single line, in the specified order. Use $L = 1$.\n- Case $1$ (stiff, moderate advection): $N = 256$, $\\mathrm{CFL} = 0.8$, $U_0 = 0.3$, $\\lambda_0 = 10^6$, $T = 1.0$.\n- Case $2$ (no reaction, advection only): $N = 64$, $\\mathrm{CFL} = 0.9$, $U_0 = 0.1$, $\\lambda_0 = 0.0$, $T = 2.0$.\n- Case $3$ (coarse, strong inflow): $N = 8$, $\\mathrm{CFL} = 0.5$, $U_0 = 0.9$, $\\lambda_0 = 10^2$, $T = 0.5$.\n- Case $4$ (single cell, reaction only): $N = 1$, $\\mathrm{CFL} = 0.9$, $U_0 = 0.0$, $\\lambda_0 = 10^{12}$, $T = 1.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each result is the absolute relative drift for the corresponding test case, expressed as a floating-point number in dimensionless units.", "solution": "The problem is valid as it presents a well-posed, scientifically grounded computational physics problem. It is self-contained, with all necessary equations, parameters, and numerical requirements clearly specified. The task is to implement a numerically conservative scheme for a system of advection-reaction equations, which is a standard and verifiable problem in scientific computing.\n\nThe solution is constructed based on an operator-splitting approach, where the advection and reaction processes are handled in separate substeps. This allows for the use of different numerical methods tailored to the character of each process: an explicit method for the non-stiff advection and an implicit method for the stiff weak-interaction source terms.\n\nThe governing equations in one spatial dimension are:\n$$ \\partial_t \\rho + \\partial_x (\\rho u) = 0 $$\n$$ \\partial_t(\\rho Y_e) + \\partial_x(\\rho Y_e u) = - \\rho \\, \\mathcal{R} $$\n$$ \\partial_t(\\rho Y_{\\nu_e}) + \\partial_x(\\rho Y_{\\nu_e} u) = + \\rho \\, \\mathcal{R} $$\nwhere $\\rho$ is the mass density, $Y_e$ is the electron fraction, $Y_{\\nu_e}$ is the electron neutrino fraction, $u(x) = - U_0 \\sin(2\\pi x/L)$ is the prescribed velocity field, and $\\mathcal{R} = \\lambda(\\rho)\\, \\big(Y_e - Y_e^{\\mathrm{eq}}(\\rho)\\big)$ is the reaction rate. The problem specifies $\\lambda(\\rho) = \\lambda_0 \\rho$.\n\nThe total electron lepton number content, $\\mathcal{L}(t)$, is defined as\n$$ \\mathcal{L}(t) = \\int_0^L \\rho(x,t)\\,\\big(Y_e(x,t) + Y_{\\nu_e}(x,t)\\big)\\, dx $$\nAdding the equations for $\\rho Y_e$ and $\\rho Y_{\\nu_e}$ yields\n$$ \\partial_t\\big(\\rho(Y_e + Y_{\\nu_e})\\big) + \\partial_x\\big(\\rho(Y_e + Y_{\\nu_e})u\\big) = 0 $$\nThis is a conservation law for the quantity $\\rho(Y_e + Y_{\\nu_e})$. Integrating over the periodic domain $[0, L]$ shows that $d\\mathcal{L}/dt = 0$, meaning $\\mathcal{L}(t)$ is a conserved quantity. The numerical scheme must preserve this property to machine precision.\n\nThe domain is discretized into $N$ finite-volume cells of uniform width $\\Delta x = L/N$. The cell-averaged value of a quantity $q$ in cell $i$ (centered at $x_i$) at time $t_n$ is denoted $q_i^n$. The time step is $\\Delta t$.\n\nThe overall update from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ is performed using operator splitting:\n1.  **Advection Substep (Explicit):**\n    First, we solve the advection part of the equations for all three conserved quantities $(\\rho, \\rho Y_e, \\rho Y_{\\nu_e})$. For a generic conserved quantity $q$, the equation is $\\partial_t q + \\partial_x (q u) = 0$. Using a first-order upwind finite-volume method, the update from state $n$ to an intermediate state $*$ is:\n    $$ q_i^* = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\n    where $F_{i+1/2}$ is the numerical flux at the face between cell $i$ and cell $i+1$. For the first-order Godunov method, the flux is determined by the upwind state:\n    $$ F_{i+1/2} = u_{i+1/2} \\, q_{i+1/2}^{\\mathrm{up}} = \\begin{cases} u_{i+1/2} \\, q_i^n  \\text{if } u_{i+1/2} \\ge 0 \\\\ u_{i+1/2} \\, q_{i+1}^n  \\text{if } u_{i+1/2}  0 \\end{cases} $$\n    where $u_{i+1/2}$ is the velocity at the face. Due to the telescoping nature of the sum of fluxes and the periodic boundary conditions, this step exactly conserves the total amount of each quantity, $\\sum_i q_i \\Delta x$. Therefore, the total lepton number $\\sum_i (\\rho Y_e + \\rho Y_{\\nu_e})_i \\Delta x$ is conserved during the advection substep.\n\n2.  **Reaction Substep (Implicit):**\n    Next, we apply the source terms locally in each cell, updating the state from $*$ to $n+1$. During this substep, $\\rho$ is held constant, $\\rho_i^{n+1} = \\rho_i^*$. The reactions only modify $Y_e$ and $Y_{\\nu_e}$. The local ODE system for each cell $i$ is:\n    $$ \\frac{d Y_{e,i}}{dt} = -\\mathcal{R}_i = -\\lambda(\\rho_i^*) \\left( Y_{e,i} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    $$ \\frac{d Y_{\\nu_e,i}}{dt} = +\\mathcal{R}_i = +\\lambda(\\rho_i^*) \\left( Y_{e,i} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    This system implies $\\frac{d}{dt}(Y_{e,i} + Y_{\\nu_e,i}) = 0$, so the sum $Y_{e,i} + Y_{\\nu_e,i}$ must be conserved within each cell.\n    To handle the stiffness of the reaction rate $\\mathcal{R}$, we use a fully implicit (Backward Euler) discretization for the $Y_e$ equation. Starting from the primitives $Y_{e,i}^* = (\\rho Y_e)_i^*/\\rho_i^*$, the update is:\n    $$ \\frac{Y_{e,i}^{n+1} - Y_{e,i}^*}{\\Delta t} = -\\lambda(\\rho_i^*) \\left( Y_{e,i}^{n+1} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    Solving for $Y_{e,i}^{n+1}$ gives the update formula:\n    $$ Y_{e,i}^{n+1} = \\frac{Y_{e,i}^* + \\Delta t \\, \\lambda_i^* Y_{e,i}^{\\mathrm{eq},*}}{1 + \\Delta t \\, \\lambda_i^*} $$\n    where $\\lambda_i^* = \\lambda(\\rho_i^*)$ and $Y_{e,i}^{\\mathrm{eq},*} = Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*)$. This scheme is unconditionally stable for any stiffness parameter $\\lambda_0$ and time step $\\Delta t$.\n    To ensure conservation, we update $Y_{\\nu_e,i}$ not by discretizing its own ODE, but by using the conservation property. The change in $Y_e$ must be balanced by the change in $Y_{\\nu_e}$: $\\Delta Y_{\\nu_e,i} = - \\Delta Y_{e,i}$. Therefore:\n    $$ Y_{\\nu_e,i}^{n+1} = Y_{\\nu_e,i}^* - (Y_{e,i}^{n+1} - Y_{e,i}^*) $$\n    This guarantees that $Y_{e,i}^{n+1} + Y_{\\nu_e,i}^{n+1} = Y_{e,i}^* + Y_{\\nu_e,i}^*$ to machine precision.\n    The updated conserved quantities are then $(\\rho Y_e)_i^{n+1} = \\rho_i^{n+1} Y_{e,i}^{n+1}$ and $(\\rho Y_{\\nu_e})_i^{n+1} = \\rho_i^{n+1} Y_{\\nu_e,i}^{n+1}$. Since $\\rho_i^{n+1} = \\rho_i^*$ and $(Y_e+Y_{\\nu_e})$ is conserved, the cell-wise quantity $(\\rho Y_e + \\rho Y_{\\nu_e})_i$ is conserved through the reaction step.\n\nSince both the advection and reaction substeps conserve the total electron lepton number, the full numerical scheme conserves $\\mathcal{L}(t)$ up to floating-point round-off errors. The implementation computes the initial value $\\mathcal{L}(0)$ and the final value $\\mathcal{L}(T)$ and reports the absolute relative drift $|\\mathcal{L}(T) - \\mathcal{L}(0)| / \\mathcal{L}(0)|$, which is expected to be on the order of machine epsilon.", "answer": "```python\nimport numpy as np\n\ndef advect(q, u_at_faces, dt, dx):\n    \"\"\"\n    Advects a cell-centered quantity q using a first-order upwind scheme.\n\n    Args:\n        q (np.ndarray): Array of the cell-centered quantity, shape (N,).\n        u_at_faces (np.ndarray): Array of velocities at cell faces, shape (N+1,).\n        dt (float): Time step.\n        dx (float): Cell width.\n\n    Returns:\n        np.ndarray: The advected quantity, shape (N,).\n    \"\"\"\n    N = len(q)\n    # Extend q for periodic boundaries to get states at all faces\n    # q_ext[i] is the state to the left of face i (q_{i-1})\n    # q_ext[i+1] is the state to the right of face i (q_i)\n    q_ext = np.concatenate(([q[-1]], q, [q[0]]))\n    \n    # States to the left and right of each of the N+1 faces\n    q_left_states = q_ext[:-1]\n    q_right_states = q_ext[1:]\n    \n    # Calculate fluxes at N+1 faces using the upwind rule\n    fluxes = np.where(u_at_faces = 0, u_at_faces * q_left_states, u_at_faces * q_right_states)\n    \n    # Update cell-centered quantities using fluxes at cell boundaries.\n    # For cell i, the boundaries are face i and face i+1.\n    q_new = q - (dt/dx) * (fluxes[1:] - fluxes[:-1])\n    \n    return q_new\n\ndef run_simulation(N, CFL, U0, lambda0, T, L=1.0):\n    \"\"\"\n    Runs a single simulation case for the advection-reaction system.\n    \"\"\"\n    # 1. Grid setup\n    dx = L / N\n    x_centers = (np.arange(N) + 0.5) * dx\n    x_faces = np.arange(N + 1) * dx\n\n    # 2. Initial conditions\n    rho = 1.0 + 0.1 * np.cos(2 * np.pi * x_centers / L)\n    Ye = 0.45 + 0.05 * np.sin(2 * np.pi * x_centers / L)\n    Ynue = np.full(N, 1e-6)\n    \n    # Conserved variables\n    rhoYe = rho * Ye\n    rhoYnue = rho * Ynue\n\n    # 3. Calculate initial total lepton number\n    L0 = np.sum(rhoYe + rhoYnue) * dx\n\n    # 4. Main time loop\n    t = 0.0\n    while t  T:\n        # Calculate time step from CFL condition\n        u_at_faces = -U0 * np.sin(2 * np.pi * x_faces / L)\n        u_max = np.max(np.abs(u_at_faces))\n        \n        if u_max == 0.0:\n            dt = T - t\n        else:\n            dt = CFL * dx / u_max\n        \n        # Ensure the final time is not overshot\n        if t + dt  T:\n            dt = T - t\n\n        # Substep 1: Advection (Explicit)\n        rho_star = advect(rho, u_at_faces, dt, dx)\n        rhoYe_star = advect(rhoYe, u_at_faces, dt, dx)\n        rhoYnue_star = advect(rhoYnue, u_at_faces, dt, dx)\n\n        # Substep 2: Reaction (Implicit)\n        # Primitives at intermediate state\n        rho_star_safe = np.maximum(rho_star, 1e-100) # Avoid division by zero\n        Ye_star = rhoYe_star / rho_star_safe\n        Ynue_star = rhoYnue_star / rho_star_safe\n\n        # Reaction parameters\n        lambda_val = lambda0 * rho_star\n        Ye_eq = 0.05 + 0.45 / (1.0 + (rho_star / 5.0)**2)\n        \n        # Implicit update for Ye\n        dt_lambda = dt * lambda_val\n        Ye_new = (Ye_star + dt_lambda * Ye_eq) / (1.0 + dt_lambda)\n\n        # Conservative update for Ynue\n        delta_Ye = Ye_new - Ye_star\n        Ynue_new = Ynue_star - delta_Ye\n\n        # Update conserved variables for the next time step\n        rho = rho_star # Density is constant during the reaction step\n        rhoYe = rho * Ye_new\n        rhoYnue = rho * Ynue_new\n\n        # Update time\n        t += dt\n\n    # 5. Calculate final total lepton number\n    LT = np.sum(rhoYe + rhoYnue) * dx\n    \n    # 6. Compute and return absolute relative drift\n    if np.abs(L0)  1e-15:\n        drift = np.abs(LT - L0) / np.abs(L0)\n    else:\n        drift = np.abs(LT - L0)\n      \n    return drift\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (N, CFL, U0, lambda0, T)\n        (256, 0.8, 0.3, 1e6, 1.0),\n        (64, 0.9, 0.1, 0.0, 2.0),\n        (8, 0.5, 0.9, 1e2, 0.5),\n        (1, 0.9, 0.0, 1e12, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, CFL, U0, lambda0, T = case\n        drift = run_simulation(N, CFL, U0, lambda0, T)\n        results.append(drift)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3570423"}]}