{"hands_on_practices": [{"introduction": "Before simulating how neutrinos move, we must first understand the properties of the neutrino gas itself. In dense astrophysical environments, neutrinos and antineutrinos form a thermal gas governed by Fermi-Dirac statistics. This foundational exercise [@problem_id:3572170] will guide you through the process of calculating key statistical properties of the neutrino energy spectrum, such as the mean energy $\\langle E \\rangle$ and the spectral hardness $h$, from first principles. Performing these calculations is essential for correctly characterizing the source term in transport simulations and for developing an intuition for how temperature and chemical potential shape the energy distribution of the particles being transported.", "problem": "Consider an ultrarelativistic, isotropic population of neutrinos in an astrophysical environment, modeled as a Fermi-Dirac distribution with temperature $T$ and neutrino chemical potential $\\mu_\\nu$. Assume a single species of neutrinos, negligible rest mass, and natural units where Boltzmann's constant, the speed of light, and the reduced Planck constant satisfy $k_{\\mathrm{B}}=c=\\hbar=1$. In these units, both energy and temperature are measured in mega-electron volts (MeV). The occupation probability is given by the Fermi-Dirac function $f(E)=\\left[\\exp\\left(\\frac{E-\\mu_\\nu}{T}\\right)+1\\right]^{-1}$. For an ultrarelativistic, isotropic gas, the phase-space density-of-states weighting per unit energy is proportional to $E^2$. The neutrino number spectrum $n(E)$ is proportional to $E^2 f(E)$, and the normalization cancels from ratios of moments.\n\nStarting from fundamental definitions of statistical averages over continuous distributions, the mean energy $\\langle E \\rangle$ and mean squared energy $\\langle E^2 \\rangle$ are defined by the ratios of energy-weighted integrals over the number spectrum,\n$$\n\\langle E \\rangle = \\frac{\\int_{0}^{\\infty} E \\, n(E) \\, dE}{\\int_{0}^{\\infty} n(E) \\, dE}, \\quad\n\\langle E^2 \\rangle = \\frac{\\int_{0}^{\\infty} E^2 \\, n(E) \\, dE}{\\int_{0}^{\\infty} n(E) \\, dE},\n$$\nwith $n(E) \\propto E^2 f(E)$ and $f(E)=\\left[\\exp\\left(\\frac{E-\\mu_\\nu}{T}\\right)+1\\right]^{-1}$. Your task is to implement a numerically stable algorithm to evaluate these integrals and compute $\\langle E \\rangle$ and $\\langle E^2 \\rangle$ for given $T$ and $\\mu_\\nu$. Then, define the spectral hardness $h$ as the dimensionless ratio\n$$\nh = \\frac{\\sqrt{\\langle E^2 \\rangle}}{\\langle E \\rangle}.\n$$\nExplain, in the accompanying solution, how the degeneracy parameter $\\eta=\\mu_\\nu/T$ modifies the spectral hardness, based on first principles and the structure of the Fermi-Dirac distribution.\n\nPhysical units requirement: express $\\langle E \\rangle$ in MeV, $\\langle E^2 \\rangle$ in $\\mathrm{MeV}^2$, and $h$ as a dimensionless number. In the final output, round each floating-point result to $6$ decimal places.\n\nTo ensure meaningful coverage, implement the program to compute results for the following test suite of $(T,\\mu_\\nu)$ values, which probes nondegenerate, moderately degenerate, negatively degenerate, strongly degenerate, and small-temperature cases:\n- Case $1$: $T=4$ MeV, $\\mu_\\nu=0$ MeV.\n- Case $2$: $T=4$ MeV, $\\mu_\\nu=8$ MeV.\n- Case $3$: $T=4$ MeV, $\\mu_\\nu=-4$ MeV.\n- Case $4$: $T=1$ MeV, $\\mu_\\nu=20$ MeV.\n- Case $5$: $T=0.5$ MeV, $\\mu_\\nu=1.0$ MeV.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, one per case, in the order above. Each inner list must be of the form $[\\langle E \\rangle,\\langle E^2 \\rangle,h]$, with $\\langle E \\rangle$ in MeV, $\\langle E^2 \\rangle$ in $\\mathrm{MeV}^2$, and $h$ dimensionless, all rounded to $6$ decimal places. For example, the output format should be like\n$$\n[[e_1,e^2_1,h_1],[e_2,e^2_2,h_2],\\ldots,[e_5,e^2_5,h_5]],\n$$\nwhere each $e_i$, $e^2_i$, and $h_i$ are floating-point numbers rounded to $6$ decimal places.", "solution": "The user's problem is subjected to validation.\n\n### Step 1: Extract Givens\n- **Model**: Ultrarelativistic, isotropic population of neutrinos.\n- **Distribution**: Fermi-Dirac with temperature $T$ and neutrino chemical potential $\\mu_\\nu$.\n- **Assumptions**: Single neutrino species, negligible rest mass.\n- **Units**: Natural units where $k_{\\mathrm{B}}=c=\\hbar=1$. Energy and temperature are in mega-electron volts (MeV).\n- **Occupation Probability**: $f(E)=\\left[\\exp\\left(\\frac{E-\\mu_\\nu}{T}\\right)+1\\right]^{-1}$.\n- **Phase-space density-of-states weighting**: Proportional to $E^2$.\n- **Neutrino number spectrum**: $n(E) \\propto E^2 f(E)$.\n- **Mean Energy**: $\\langle E \\rangle = \\frac{\\int_{0}^{\\infty} E \\, n(E) \\, dE}{\\int_{0}^{\\infty} n(E) \\, dE}$.\n- **Mean Squared Energy**: $\\langle E^2 \\rangle = \\frac{\\int_{0}^{\\infty} E^2 \\, n(E) \\, dE}{\\int_{0}^{\\infty} n(E) \\, dE}$.\n- **Spectral Hardness**: $h = \\frac{\\sqrt{\\langle E^2 \\rangle}}{\\langle E \\rangle}$.\n- **Degeneracy Parameter**: $\\eta=\\mu_\\nu/T$.\n- **Task**: Implement a numerically stable algorithm to compute $\\langle E \\rangle$ and $\\langle E^2 \\rangle$, and explain how $\\eta$ modifies $h$.\n- **Output Units**: $\\langle E \\rangle$ in MeV, $\\langle E^2 \\rangle$ in $\\mathrm{MeV}^2$, $h$ dimensionless.\n- **Output Formatting**: All results rounded to $6$ decimal places.\n- **Test Cases**:\n    1.  $T=4$ MeV, $\\mu_\\nu=0$ MeV.\n    2.  $T=4$ MeV, $\\mu_\\nu=8$ MeV.\n    3.  $T=4$ MeV, $\\mu_\\nu=-4$ MeV.\n    4.  $T=1$ MeV, $\\mu_\\nu=20$ MeV.\n    5.  $T=0.5$ MeV, $\\mu_\\nu=1.0$ MeV.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in standard statistical mechanics and its application to astrophysics. The use of the Fermi-Dirac distribution for fermions like neutrinos, the definition of statistical moments, and the model of an ultrarelativistic gas are all fundamental concepts in physics.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary definitions, constants, and parameters to calculate the required quantities. The integrals are well-defined (convergent Fermi-Dirac integrals), ensuring a unique and meaningful solution exists for each test case.\n- **Objectivity**: The problem is stated in precise, objective, and quantitative terms, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe core of the problem is to compute statistical moments for a neutrino energy spectrum. The neutrino number spectrum $n(E)$ is given as proportional to the product of the phase-space density of states (proportional to $E^2$ for an ultrarelativistic isotropic gas) and the Fermi-Dirac occupation probability $f(E)$. Thus, $n(E) \\propto E^2 f(E)$, where the proportionality constant is irrelevant as it cancels in the ratios defining the moments.\n\nSubstituting $n(E)$ into the definitions for the mean energy $\\langle E \\rangle$ and mean squared energy $\\langle E^2 \\rangle$:\n$$\n\\langle E \\rangle = \\frac{\\int_{0}^{\\infty} E \\cdot E^2 f(E) \\, dE}{\\int_{0}^{\\infty} E^2 f(E) \\, dE} = \\frac{\\int_{0}^{\\infty} E^3 f(E) \\, dE}{\\int_{0}^{\\infty} E^2 f(E) \\, dE}\n$$\n$$\n\\langle E^2 \\rangle = \\frac{\\int_{0}^{\\infty} E^2 \\cdot E^2 f(E) \\, dE}{\\int_{0}^{\\infty} E^2 f(E) \\, dE} = \\frac{\\int_{0}^{\\infty} E^4 f(E) \\, dE}{\\int_{0}^{\\infty} E^2 f(E) \\, dE}\n$$\nwhere $f(E)=\\left[\\exp\\left(\\frac{E-\\mu_\\nu}{T}\\right)+1\\right]^{-1}$.\n\nTo simplify these integrals and reveal their dependence on the system's physical parameters, we perform a change of variables. Let $x = E/T$ be the dimensionless energy, so $E = xT$ and $dE = Tdx$. We also define the degeneracy parameter $\\eta = \\mu_\\nu/T$. The general integral in the numerators and denominators takes the form:\n$$\n\\int_{0}^{\\infty} E^k f(E) \\, dE = \\int_{0}^{\\infty} (xT)^k \\left[\\exp\\left(\\frac{xT-\\mu_\\nu}{T}\\right)+1\\right]^{-1} Tdx = T^{k+1} \\int_{0}^{\\infty} \\frac{x^k}{e^{x-\\eta}+1} \\, dx\n$$\nThis defines the complete Fermi-Dirac integral of order $k$ as $F_k(\\eta) = \\int_{0}^{\\infty} \\frac{x^k}{e^{x-\\eta}+1} \\, dx$.\nUsing this definition, the moments can be expressed as:\n$$\n\\langle E \\rangle = \\frac{T^4 F_3(\\eta)}{T^3 F_2(\\eta)} = T \\frac{F_3(\\eta)}{F_2(\\eta)}\n$$\n$$\n\\langle E^2 \\rangle = \\frac{T^5 F_4(\\eta)}{T^3 F_2(\\eta)} = T^2 \\frac{F_4(\\eta)}{F_2(\\eta)}\n$$\nThe spectral hardness $h$ is then:\n$$\nh = \\frac{\\sqrt{\\langle E^2 \\rangle}}{\\langle E \\rangle} = \\frac{\\sqrt{T^2 \\frac{F_4(\\eta)}{F_2(\\eta)}}}{T \\frac{F_3(\\eta)}{F_2(\\eta)}} = \\frac{T \\sqrt{\\frac{F_4(\\eta)}{F_2(\\eta)}}}{T \\frac{F_3(\\eta)}{F_2(\\eta)}} = \\frac{\\sqrt{F_4(\\eta) F_2(\\eta)}}{F_3(\\eta)}\n$$\nNotably, the spectral hardness $h$ depends only on the degeneracy parameter $\\eta$ and not on the temperature $T$ directly.\n\nThe integrals $F_k(\\eta)$ do not have a general closed-form expression in terms of elementary functions and must be evaluated numerically. A robust numerical quadrature method is suitable for this task. The algorithm for each test case $(T, \\mu_\\nu)$ is as follows:\n1.  Calculate the degeneracy parameter $\\eta = \\mu_\\nu / T$.\n2.  Numerically compute the integrals $F_2(\\eta)$, $F_3(\\eta)$, and $F_4(\\eta)$ over the interval $[0, \\infty)$.\n3.  Use these values to calculate $\\langle E \\rangle$, $\\langle E^2 \\rangle$, and $h$ using the expressions derived above.\n\nNow, we analyze the dependence of the spectral hardness $h$ on the degeneracy parameter $\\eta$. The parameter $h$ is the ratio of the root-mean-square energy to the mean energy, $h = E_{rms} / \\langle E \\rangle$, which is a measure of the relative width of the energy spectrum.\n-   **Non-degenerate limit ($\\eta \\ll 0$):** When $\\mu_\\nu$ is large and negative compared to $T$, the term $e^{(E-\\mu_\\nu)/T}$ is very large. The $+1$ in the denominator of $f(E)$ becomes negligible, so $f(E) \\approx e^{-(E-\\mu_\\nu)/T}$. This is the Maxwell-Boltzmann limit. The number spectrum becomes $n(E) \\propto E^2 e^{-E/T}$. In this limit, the ratio of moments is independent of $\\eta$. The integrals $F_k(\\eta)$ become proportional to the Gamma function, $F_k(\\eta) \\approx e^{\\eta} \\Gamma(k+1) = e^{\\eta} k!$. The hardness $h$ approaches a constant value:\n    $$\n    h \\approx \\frac{\\sqrt{e^{\\eta} 4! \\cdot e^{\\eta} 2!}}{e^{\\eta} 3!} = \\frac{\\sqrt{24 \\cdot 2}}{6} = \\frac{\\sqrt{48}}{6} = \\frac{4\\sqrt{3}}{6} = \\frac{2\\sqrt{3}}{3} \\approx 1.1547\n    $$\n-   **Highly degenerate limit ($\\eta \\gg 0$):** When $\\mu_\\nu$ is large and positive compared to $T$, the distribution approaches a step function (the zero-temperature limit). $f(E) \\approx 1$ for $E  \\mu_\\nu$ and $f(E) \\approx 0$ for $E > \\mu_\\nu$. The integrals can be approximated by integrating up to the Fermi level: $F_k(\\eta) \\approx \\int_0^\\eta x^k dx = \\frac{\\eta^{k+1}}{k+1}$. The hardness $h$ again approaches a constant, but a different one:\n    $$\n    h \\approx \\frac{\\sqrt{\\frac{\\eta^5}{5} \\cdot \\frac{\\eta^3}{3}}}{\\frac{\\eta^4}{4}} = \\frac{\\eta^4/\\sqrt{15}}{\\eta^4/4} = \\frac{4}{\\sqrt{15}} \\approx 1.0328\n    $$\n-   **Interpretation:** The spectral hardness $h$ decreases as the degeneracy parameter $\\eta$ increases from negative to positive values. A non-degenerate gas ($\\eta \\ll 0$) has a broad, thermal energy distribution, leading to a larger relative width and thus a higher $h$. In contrast, a highly degenerate gas ($\\eta \\gg 0$) has its particles concentrated in states up to the Fermi energy $\\mu_\\nu$, resulting in a spectrum that is more sharply peaked relative to its mean energy, yielding a smaller $h$. Therefore, a higher degree of degeneracy corresponds to a 'harder' spectrum in the sense of being more narrowly distributed.\n\nThe provided Python code implements this algorithm using `scipy.integrate.quad` for numerical integration, calculates the required quantities for the given test cases, and formats the output as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the neutrino statistics problem for a given set of test cases.\n\n    This function calculates the mean energy E, mean squared energy E^2,\n    and spectral hardness h for an ultrarelativistic Fermi-Dirac distributed\n    neutrino gas, based on temperature T and chemical potential mu_nu.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T in MeV, mu_nu in MeV).\n    test_cases = [\n        (4.0, 0.0),    # Case 1: Non-degenerate\n        (4.0, 8.0),    # Case 2: Moderately degenerate\n        (4.0, -4.0),   # Case 3: Negatively degenerate\n        (1.0, 20.0),   # Case 4: Strongly degenerate\n        (0.5, 1.0),    # Case 5: Small-temperature, moderately degenerate\n    ]\n\n    results = []\n    for T, mu_nu in test_cases:\n        # The degeneracy parameter eta = mu_nu / T.\n        eta = mu_nu / T\n\n        # The integrand for the Fermi-Dirac integral of order k is x^k / (exp(x-eta) + 1).\n        # We define a generic function for the integrand.\n        def fermi_dirac_integrand(x, k, eta_val):\n            # The denominator exp(x-eta) + 1.\n            # np.exp is used for numerical stability with large arguments.\n            return np.power(x, k) / (np.exp(x - eta_val) + 1)\n\n        # Numerically compute the Fermi-Dirac integrals F_k(eta) for k=2, 3, 4.\n        # quad integrates from 0 to infinity.\n        # The 'args' tuple passes the additional parameters (k, eta) to the integrand.\n        F2, _ = quad(fermi_dirac_integrand, 0, np.inf, args=(2, eta))\n        F3, _ = quad(fermi_dirac_integrand, 0, np.inf, args=(3, eta))\n        F4, _ = quad(fermi_dirac_integrand, 0, np.inf, args=(4, eta))\n\n        # Check for non-physical results (e.g., F2=0) to prevent division by zero.\n        if F2 == 0:\n            # This case shouldn't happen for T  0.\n            E_mean = 0.0\n            E2_mean = 0.0\n            h = 0.0\n        else:\n            # Calculate mean energy E = T * F3(eta) / F2(eta).\n            E_mean = T * (F3 / F2)\n    \n            # Calculate mean squared energy E^2 = T^2 * F4(eta) / F2(eta).\n            E2_mean = T**2 * (F4 / F2)\n    \n            # Calculate spectral hardness h = sqrt(E^2) / E.\n            # Avoid division by zero if E_mean is zero.\n            if E_mean == 0:\n                h = 0.0\n            else:\n                h = np.sqrt(E2_mean) / E_mean\n        \n        # Round the results to 6 decimal places as required.\n        E_mean_rounded = round(E_mean, 6)\n        E2_mean_rounded = round(E2_mean, 6)\n        h_rounded = round(h, 6)\n\n        results.append([E_mean_rounded, E2_mean_rounded, h_rounded])\n\n    # Format the final results into a single string as specified in the problem.\n    # The output should be a list of lists, e.g., [[e1,e2_1,h1],[e2,e2_2,h2],...].\n    output_str = f\"[{','.join(f'[{v[0]},{v[1]},{v[2]}]' for v in results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "3572170"}, {"introduction": "To ensure that a complex numerical transport code is working correctly, it must first be validated against problems with known analytic solutions. The uniform radiating sphere is a cornerstone benchmark problem in the field of radiative transfer, providing a \"ground truth\" for both moment methods and discrete ordinate schemes. In this practice [@problem_id:3572218], you will derive the exact radiation field at the surface of the sphere as a function of the system's optical depth $\\tau$. This exercise provides invaluable insight into the physical origins of the flux factor $f$ and Eddington factor $\\chi$, quantities that are central to computationally efficient moment-based transport methods.", "problem": "Consider a homogeneous, spherically symmetric, radiating sphere of radius $R$ embedded in vacuum. Inside the sphere, the neutrino specific intensity $I$ obeys the time-independent radiative transfer equation along a straight characteristic, $dI/ds = -\\kappa I + j$, with constant absorption opacity $\\kappa$ and constant isotropic emissivity $j$ in a single energy group. Outside the sphere, $\\kappa = 0$ and there is no incoming radiation.\n\nLet the dimensionless total optical depth of the sphere be defined as $\\tau = \\kappa R$. Assume straight-line propagation (no scattering), special relativity with constant speed of light $c$, and that all quantities are steady-state and frequency-integrated over a single group so that frequency labels can be suppressed. On the outer boundary at $r=R$, the path length available inside the sphere for an outward ray with direction cosine $\\mu \\in [0,1]$ is $s_{\\mathrm{in}}(\\mu) = 2 R \\mu$, whereas for inward directions ($\\mu \\in [-1,0)$) there is no incoming radiation.\n\nStarting from the radiative transfer equation and the definitions of angular moments in spherical symmetry,\n- energy density $E(R) = \\dfrac{2\\pi}{c} \\int_{0}^{1} I(R,\\mu)\\, d\\mu$,\n- radial energy flux $F(R) = 2\\pi \\int_{0}^{1} \\mu\\, I(R,\\mu)\\, d\\mu$,\n- radial radiation pressure $P_{rr}(R) = \\dfrac{2\\pi}{c} \\int_{0}^{1} \\mu^2\\, I(R,\\mu)\\, d\\mu$,\n\nderive expressions for the flux factor $f(\\tau) = F(R)/(c\\,E(R))$ and the Eddington factor $\\chi(\\tau) = P_{rr}(R)/E(R)$ as functions of the optical depth $\\tau$.\n\nNext, define a dimensionless leakage fraction for the group as\n$$\nL(\\tau) = \\frac{F(R)}{2\\pi\\, j\\, R},\n$$\nwhich represents the fraction of the homogeneous volumetric emissivity that leaks out through the surface. Derive an analytic expression for $L(\\tau)$ from first principles based on the same setup.\n\nThen, implement a numerical quadrature on $\\mu \\in [0,1]$ to approximate\n$$\nF(R) \\approx 2\\pi \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I(R,\\mu_i),\n$$\nwith $N$ quadrature points and weights $\\{(\\mu_i,w_i)\\}$ defined by a Gauss-Legendre mapping to $[0,1]$, and form a numerical estimate $L_{\\mathrm{num}}(\\tau)$ of the leakage fraction using the same normalization. Compare the analytic $L(\\tau)$ and the numerical $L_{\\mathrm{num}}(\\tau)$ for several optical depths that mimic energy groups with different opacities.\n\nYour program must:\n- Use the analytic expressions you derived for $f(\\tau)$ and $\\chi(\\tau)$ at $r=R$.\n- Compute $L_{\\mathrm{num}}(\\tau)$ by quadrature with a specified $N$.\n- For the boundary case $\\tau = 0$, use the appropriate limiting values implied by the radiative transfer equation and geometry. All requested outputs are dimensionless; report them as pure numbers without units.\n\nTest Suite:\n- Use the following set of optical depths $\\tau$: $[0.0, 0.1, 1.0, 10.0, 50.0]$. These represent, respectively, a transparent limit, optically thin, moderate, optically thick, and very optically thick (high-energy group) cases.\n- Use $N = 64$ for the Gauss-Legendre quadrature on $\\mu \\in [0,1]$.\n\nFinal Output Format:\n- For each $\\tau$ in the order given, compute and return a list $[f(\\tau), \\chi(\\tau), L(\\tau), L_{\\mathrm{num}}(\\tau), |L(\\tau) - L_{\\mathrm{num}}(\\tau)|]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to the result list for each test case, in order. For example: \n\"[[f_0,chi_0,L_0,Lnum_0,diff_0],[f_1,chi_1,L_1,Lnum_1,diff_1],...]\".", "solution": "The user has provided a problem in single-group, steady-state, spherically symmetric radiative transfer. The request is to validate the problem, derive several analytical quantities, and compare one of them to a numerical approximation.\n\n### Problem Validation\n\n1.  **Extract Givens**:\n    -   **System**: A homogeneous, spherically symmetric sphere of radius $R$ in vacuum.\n    -   **Radiative Transfer Equation (RTE)**: Inside the sphere, $\\frac{dI}{ds} = -\\kappa I + j$, where opacity $\\kappa$ and emissivity $j$ are constant. Outside, $\\kappa=0$.\n    -   **Boundary Condition**: No incoming radiation from vacuum.\n    -   **Geometry**: For a ray exiting at $r=R$ with direction cosine $\\mu \\in [0,1]$, the path length inside the sphere is $s_{\\mathrm{in}}(\\mu) = 2R\\mu$. For $\\mu \\in [-1,0)$, $I(R, \\mu)=0$.\n    -   **Optical Depth**: $\\tau = \\kappa R$.\n    -   **Moment Definitions at $r=R$**:\n        -   Energy Density: $E(R) = \\frac{2\\pi}{c} \\int_{0}^{1} I(R,\\mu)\\, d\\mu$\n        -   Radial Energy Flux: $F(R) = 2\\pi \\int_{0}^{1} \\mu\\, I(R,\\mu)\\, d\\mu$\n        -   Radial Radiation Pressure: $P_{rr}(R) = \\frac{2\\pi}{c} \\int_{0}^{1} \\mu^2\\, I(R,\\mu)\\, d\\mu$\n    -   **Derived Quantities**:\n        -   Flux Factor: $f(\\tau) = F(R) / (c\\,E(R))$\n        -   Eddington Factor: $\\chi(\\tau) = P_{rr}(R) / E(R)$\n        -   Leakage Fraction (Analytic): $L(\\tau) = \\frac{F(R)}{2\\pi j R}$\n        -   Leakage Fraction (Numerical): from $F(R) \\approx 2\\pi \\sum_{i=1}^{N} w_i \\mu_i I(R, \\mu_i)$\n    -   **Numerical Parameters**: Gauss-Legendre quadrature with $N=64$ points on $\\mu \\in [0,1]$.\n    -   **Test Suite**: $\\tau \\in [0.0, 0.1, 1.0, 10.0, 50.0]$.\n\n2.  **Validate Using Extracted Givens**:\n    -   **Scientifically Grounded**: The problem is a standard, albeit simplified, model for radiative transfer (the uniform source sphere), which is a fundamental concept in astrophysics and related fields. The RTE and the geometrical setup are correct. The model is scientifically sound.\n    -   **Well-Posed**: The problem is well-defined. The RTE is a first-order linear ODE with specified coefficients and boundary conditions, leading to a unique solution for the specific intensity $I$. All required quantities are defined precisely.\n    -   **Objective**: The language is precise and objective.\n    -   **Completeness**: All necessary information ($\\kappa, j$ constant, geometry, boundary conditions) is provided to solve for the intensity and its moments at the boundary.\n    -   The definitions for the moments $E(R)$, $F(R)$, and $P_{rr}(R)$ use an integration range of $[0,1]$ for $\\mu$. This is consistent with the physical situation at the boundary where there is no incoming radiation, i.e., $I(R,\\mu)=0$ for $\\mu  0$. Therefore, integrating over $[-1,1]$ would yield the same result.\n\n3.  **Verdict**: The problem is **valid**. It is a well-posed, self-contained, and scientifically sound problem in computational physics.\n\n### Derivation and Solution\n\nThe solution proceeds in two main parts: first, the derivation of analytic expressions for the requested quantities, and second, the formulation of the numerical approximation.\n\n#### Part 1: Analytic Derivations\n\n**Step 1.1: Formal Solution of the Radiative Transfer Equation**\nThe steady-state RTE along a characteristic path $s$ is given by:\n$$ \\frac{dI}{ds} = -\\kappa I + j $$\nThis is a first-order linear ODE. Its formal solution, assuming constant $\\kappa$ and $j$, is:\n$$ I(s) = I(0)e^{-\\kappa s} + \\frac{j}{\\kappa}(1 - e^{-\\kappa s}) $$\nwhere $I(0)$ is the intensity at the start of the path segment ($s=0$).\nFor a ray exiting the sphere at radius $r=R$ with an outward direction cosine $\\mu \\in [0,1]$, the ray originates from the other side of the sphere. Since the sphere is embedded in a vacuum with no incoming radiation, the intensity at the starting point of the path segment inside the sphere is $I(0)=0$. The total path length of the ray inside the sphere is given as $s_{\\text{in}}(\\mu) = 2R\\mu$.\nThus, the specific intensity at the surface for an outgoing ray is:\n$$ I(R, \\mu) = \\frac{j}{\\kappa}(1 - e^{-2\\kappa R \\mu}) $$\nUsing the definition of the total optical depth $\\tau = \\kappa R$, we have:\n$$ I(R, \\mu) = \\frac{j}{\\kappa}(1 - e^{-2\\tau\\mu}) \\quad \\text{for } \\mu \\in [0, 1] $$\nFor inward directions $\\mu  0$, $I(R,\\mu) = 0$.\n\n**Step 1.2: Calculation of Angular Moments**\nWe substitute the expression for $I(R, \\mu)$ into the given definitions for the moments.\n\n-   **Energy Density, $E(R)$**:\n    $$ E(R) = \\frac{2\\pi}{c} \\int_{0}^{1} I(R, \\mu) d\\mu = \\frac{2\\pi j}{c\\kappa} \\int_{0}^{1} (1 - e^{-2\\tau\\mu}) d\\mu $$\n    $$ E(R) = \\frac{2\\pi j}{c\\kappa} \\left[ \\mu + \\frac{e^{-2\\tau\\mu}}{2\\tau} \\right]_0^1 = \\frac{2\\pi j}{c\\kappa} \\left( 1 + \\frac{e^{-2\\tau}}{2\\tau} - \\frac{1}{2\\tau} \\right) = \\frac{\\pi j}{c\\kappa\\tau} (2\\tau - 1 + e^{-2\\tau}) $$\n\n-   **Radial Energy Flux, $F(R)$**:\n    $$ F(R) = 2\\pi \\int_{0}^{1} \\mu I(R, \\mu) d\\mu = \\frac{2\\pi j}{\\kappa} \\int_{0}^{1} \\mu(1 - e^{-2\\tau\\mu}) d\\mu $$\n    Integration by parts yields:\n    $$ F(R) = \\frac{2\\pi j}{\\kappa} \\left( \\frac{1}{2} - \\left[ -\\frac{\\mu e^{-2\\tau\\mu}}{2\\tau} - \\frac{e^{-2\\tau\\mu}}{4\\tau^2} \\right]_0^1 \\right) = \\frac{2\\pi j}{\\kappa} \\left( \\frac{1}{2} + \\frac{e^{-2\\tau}}{2\\tau} + \\frac{e^{-2\\tau}}{4\\tau^2} - \\frac{1}{4\\tau^2} \\right) $$\n    $$ F(R) = \\frac{\\pi j}{2\\kappa\\tau^2} (2\\tau^2 - 1 + (2\\tau+1)e^{-2\\tau}) $$\n\n-   **Radial Radiation Pressure, $P_{rr}(R)$**:\n    $$ P_{rr}(R) = \\frac{2\\pi}{c} \\int_{0}^{1} \\mu^2 I(R, \\mu) d\\mu = \\frac{2\\pi j}{c\\kappa} \\int_{0}^{1} \\mu^2(1 - e^{-2\\tau\\mu}) d\\mu $$\n    A second integration by parts gives:\n    $$ P_{rr}(R) = \\frac{2\\pi j}{c\\kappa} \\left( \\frac{1}{3} - \\left[ -\\frac{\\mu^2 e^{-2\\tau\\mu}}{2\\tau} - \\frac{\\mu e^{-2\\tau\\mu}}{2\\tau^2} - \\frac{e^{-2\\tau\\mu}}{4\\tau^3} \\right]_0^1 \\right) $$\n    $$ P_{rr}(R) = \\frac{\\pi j}{6c\\kappa\\tau^3} (4\\tau^3 - 3 + (6\\tau^2+6\\tau+3)e^{-2\\tau}) $$\n\n**Step 1.3: Derivation of Dimensionless Factors $f(\\tau)$, $\\chi(\\tau)$, and $L(\\tau)$**\nUsing the moments derived above and the definitions provided:\n\n-   **Flux Factor, $f(\\tau)$**:\n    $$ f(\\tau) = \\frac{F(R)}{cE(R)} = \\frac{\\frac{\\pi j}{2\\kappa\\tau^2} (2\\tau^2 - 1 + (2\\tau+1)e^{-2\\tau})}{c \\cdot \\frac{\\pi j}{c\\kappa\\tau} (2\\tau - 1 + e^{-2\\tau})} = \\frac{1}{2\\tau} \\frac{2\\tau^2 - 1 + (2\\tau+1)e^{-2\\tau}}{2\\tau - 1 + e^{-2\\tau}} $$\n\n-   **Eddington Factor, $\\chi(\\tau)$**:\n    $$ \\chi(\\tau) = \\frac{P_{rr}(R)}{E(R)} = \\frac{\\frac{\\pi j}{6c\\kappa\\tau^3} (4\\tau^3 - 3 + (6\\tau^2+6\\tau+3)e^{-2\\tau})}{\\frac{\\pi j}{c\\kappa\\tau} (2\\tau - 1 + e^{-2\\tau})} = \\frac{1}{6\\tau^2} \\frac{4\\tau^3 - 3 + (6\\tau^2+6\\tau+3)e^{-2\\tau}}{2\\tau - 1 + e^{-2\\tau}} $$\n\n-   **Leakage Fraction, $L(\\tau)$**:\n    $$ L(\\tau) = \\frac{F(R)}{2\\pi j R} = \\frac{\\frac{\\pi j}{2\\kappa\\tau^2} (2\\tau^2 - 1 + (2\\tau+1)e^{-2\\tau})}{2\\pi j (\\tau/\\kappa)} = \\frac{1}{4\\tau^3}(2\\tau^2 - 1 + (2\\tau+1)e^{-2\\tau}) $$\n\n**Step 1.4: Limiting Case ($\\tau \\to 0$)**\nFor $\\tau = 0$, the expressions are indeterminate. We must take the limit $\\tau \\to 0$. By expanding the exponential terms, we find:\n-   $f(0) = \\lim_{\\tau\\to 0} f(\\tau) = 2/3$\n-   $\\chi(0) = \\lim_{\\tau\\to 0} \\chi(\\tau) = 1/2$\n-   $L(0) = \\lim_{\\tau\\to 0} L(\\tau) = 2/3$\n\n#### Part 2: Numerical Approximation\n\nThe numerical leakage fraction $L_{\\mathrm{num}}(\\tau)$ is computed via numerical quadrature of the flux $F(R)$.\n$$ F(R) \\approx F_{\\mathrm{num}}(R) = 2\\pi \\sum_{i=1}^{N} w_i \\mu_i I(R, \\mu_i) $$\nwhere $(\\mu_i, w_i)$ are the points and weights of a Gauss-Legendre quadrature rule on the interval $[0,1]$. These can be obtained by mapping the standard $[-1,1]$ points $(x_j, w'_j)$ via $\\mu_i = (x_i+1)/2$ and $w_i = w'_j/2$. Substituting the expression for $I(R, \\mu_i)$:\n$$ F_{\\mathrm{num}}(R) = 2\\pi \\frac{j}{\\kappa} \\sum_{i=1}^{N} w_i \\mu_i (1 - e^{-2\\tau\\mu_i}) $$\nThen, $L_{\\mathrm{num}}(\\tau)$ is:\n$$ L_{\\mathrm{num}}(\\tau) = \\frac{F_{\\mathrm{num}}(R)}{2\\pi j R} = \\frac{2\\pi \\frac{j}{\\kappa} \\sum_{i=1}^{N} w_i \\mu_i (1 - e^{-2\\tau\\mu_i})}{2\\pi j (\\tau/\\kappa)} = \\frac{1}{\\tau} \\sum_{i=1}^{N} w_i \\mu_i (1 - e^{-2\\tau\\mu_i}) $$\nFor the case $\\tau = 0$, taking the limit of the summand:\n$$ \\lim_{\\tau\\to 0} \\frac{1 - e^{-2\\tau\\mu_i}}{\\tau} = 2\\mu_i $$\nTherefore, for the transparent limit:\n$$ L_{\\mathrm{num}}(0) = \\sum_{i=1}^{N} w_i \\mu_i (2\\mu_i) = 2 \\sum_{i=1}^{N} w_i \\mu_i^2 $$\nThis is a numerical approximation of $2 \\int_0^1 \\mu^2 d\\mu = 2/3$, which agrees with the analytic limit.\n\nFor implementation, to maintain numerical stability for small $\\tau  0$, the expressions should be formulated using `expm1(x)`, which computes $e^x-1$ accurately. For example, $2\\tau - 1 + e^{-2\\tau}$ is rewritten as $2\\tau + \\text{expm1}(-2\\tau)$.\n\nThe Python implementation will calculate these quantities for the specified $\\tau$ values and present the results as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the radiative transfer problem for a homogeneous sphere.\n    \n    This function computes analytic solutions for the flux factor f(τ),\n    Eddington factor χ(τ), and leakage fraction L(τ) at the surface of a\n    radiating sphere. It also computes a numerical estimate of the leakage\n    fraction, L_num(τ), using Gauss-Legendre quadrature and compares it\n    to the analytic result.\n    \"\"\"\n\n    def analytic_f(tau):\n        \"\"\"Computes the analytic flux factor f(τ).\"\"\"\n        if tau == 0.0:\n            return 2.0 / 3.0\n        \n        # Numerically stable formulation using expm1(x) = exp(x) - 1\n        exp_m2t = np.exp(-2.0 * tau)\n        expm1_m2t = np.expm1(-2.0 * tau)\n        \n        # Numerator: 2*τ^2 - 1 + (2*τ+1)*exp(-2*τ) - 2*τ^2 + (exp(-2*τ)-1) + 2*τ*exp(-2*τ)\n        num_term = 2.0 * tau**2 + expm1_m2t + 2.0 * tau * exp_m2t\n        # Denominator: 2*τ - 1 + exp(-2*τ) - 2*τ + (exp(-2*τ)-1)\n        den_term = 2.0 * tau + expm1_m2t\n        \n        # Avoid division by zero if den_term is numerically zero\n        if den_term == 0.0:\n            return 2.0 / 3.0 # Fallback to the known limit\n        \n        return (1.0 / (2.0 * tau)) * (num_term / den_term)\n\n    def analytic_chi(tau):\n        \"\"\"Computes the analytic Eddington factor χ(τ).\"\"\"\n        if tau == 0.0:\n            return 0.5\n        \n        exp_m2t = np.exp(-2.0 * tau)\n        expm1_m2t = np.expm1(-2.0 * tau)\n        \n        # Numerator: 4*τ^3 - 3 + (6*τ^2+6*τ+3)*exp(-2*τ) - 4*τ^3 + 3*(exp(-2*τ)-1) + (6*τ^2+6*τ)*exp(-2*τ)\n        num_term = 4.0 * tau**3 + 3.0 * expm1_m2t + (6.0 * tau**2 + 6.0 * tau) * exp_m2t\n        # Denominator: 2*τ + (exp(-2τ)-1)\n        den_term = 2.0 * tau + expm1_m2t\n\n        if den_term == 0.0:\n            return 0.5 # Fallback to the known limit\n            \n        return (1.0 / (6.0 * tau**2)) * (num_term / den_term)\n\n    def analytic_L(tau):\n        \"\"\"Computes the analytic leakage fraction L(τ).\"\"\"\n        if tau == 0.0:\n            return 2.0 / 3.0\n            \n        exp_m2t = np.exp(-2.0 * tau)\n        expm1_m2t = np.expm1(-2.0 * tau)\n\n        # Numerator: 2*τ^2 - 1 + (2*τ+1)*exp(-2*τ) - 2*τ^2 + (exp(-2*τ)-1) + 2*τ*exp(-2*τ)\n        num_term = 2.0 * tau**2 + expm1_m2t + 2.0 * tau * exp_m2t\n        \n        return (1.0 / (4.0 * tau**3)) * num_term\n\n    def numeric_L(tau, mu, w):\n        \"\"\"Computes the numerical leakage fraction L_num(τ) via quadrature.\"\"\"\n        if tau == 0.0:\n            # Limiting case: L_num(0) = 2 * integral(mu^2 dmu) from 0 to 1\n            # Which is approximated by 2 * sum(w_i * mu_i^2)\n            summand = w * mu**2\n            return 2.0 * np.sum(summand)\n        \n        # Stable form: sum(w_i * mu_i * (1 - exp(-2*tau*mu_i))) / tau\n        # (1 - exp(x)) = -expm1(x)\n        summand = w * mu * (-np.expm1(-2.0 * tau * mu))\n        return np.sum(summand) / tau\n\n    # --- Main Execution ---\n    \n    # Define the test cases from the problem statement.\n    test_cases = [0.0, 0.1, 1.0, 10.0, 50.0]\n    N_quad = 64\n\n    # Generate Gauss-Legendre quadrature points and weights\n    # Standard interval is [-1, 1], map to [0, 1] for mu\n    x_std, w_std = np.polynomial.legendre.leggauss(N_quad)\n    mu_points = 0.5 * (x_std + 1.0)\n    w_points = 0.5 * w_std\n\n    results = []\n    for tau in test_cases:\n        f_val = analytic_f(tau)\n        chi_val = analytic_chi(tau)\n        L_val = analytic_L(tau)\n        L_num_val = numeric_L(tau, mu_points, w_points)\n        diff = np.abs(L_val - L_num_val)\n        \n        results.append([f_val, chi_val, L_val, L_num_val, diff])\n\n    # Build the final output string to match the exact required format.\n    # The format is a list of lists, with no spaces inside the inner lists.\n    output_parts = []\n    for res_list in results:\n        # Format each list as a string \"[v1,v2,v3,...]\" without spaces\n        res_str = f\"[{','.join(map(str, res_list))}]\"\n        output_parts.append(res_str)\n    \n    # Join the list-strings with commas and enclose in outer brackets.\n    final_str = f\"[{','.join(output_parts)}]\"\n    print(final_str)\n\nsolve()\n\n```", "id": "3572218"}, {"introduction": "Solving the full Boltzmann transport equation is often computationally prohibitive, leading to the widespread use of more efficient moment methods. These methods, however, rely on a \"closure relation\" to approximate the pressure tensor, which can introduce unphysical artifacts, especially in the free-streaming limit. This exercise [@problem_id:3572208] implements a challenging benchmark test involving a neutrino beam striking a discontinuity at an oblique angle to expose the weaknesses of two common closures. By quantifying spurious radiation fluxes, you will gain a practical understanding of the limitations of these important approximations and the reasons why developing high-fidelity closures remains a critical area of research.", "problem": "Consider the two-moment formulation of neutrino transport in the free-streaming limit (no collision terms). Let $E(\\mathbf{x},t)$ denote the neutrino energy density, $\\mathbf{F}(\\mathbf{x},t)$ the neutrino energy flux, and $\\mathsf{P}(\\mathbf{x},t)$ the neutrino pressure tensor. In the absence of sources and absorption, the governing equations are the conservation laws\n$$\n\\partial_t E + \\nabla \\cdot \\mathbf{F} = 0, \\qquad \\partial_t \\mathbf{F} + c^2 \\nabla \\cdot \\mathsf{P} = 0,\n$$\nwhere $c$ is the speed of light. To close the system, one uses an algebraic Eddington tensor closure of the form\n$$\n\\mathsf{P} = \\mathsf{D} E, \\quad \\mathsf{D} = \\frac{1 - \\chi(f)}{2} \\, \\mathsf{I} + \\frac{3 \\chi(f) - 1}{2} \\, \\mathbf{n} \\mathbf{n},\n$$\nwhere $\\mathsf{I}$ is the identity tensor, the flux factor $f$ is defined by $f \\equiv \\frac{\\lVert \\mathbf{F} \\rVert}{c E}$, and $\\mathbf{n}$ is the unit vector in the flux direction $\\mathbf{n} \\equiv \\mathbf{F} / \\lVert \\mathbf{F} \\rVert$. The function $\\chi(f)$ (the Eddington factor) depends on the chosen moment closure. In this problem you will compare two standard closures:\n- The Levermore (first-order moment (M1)) closure:\n$$\n\\chi_{\\mathrm{Lev}}(f) = \\frac{3 + 4 f^2}{5 + 2 \\sqrt{4 - 3 f^2}}.\n$$\n- The Kershaw closure:\n$$\n\\chi_{\\mathrm{Ker}}(f) = \\frac{1 + 2 f^2}{3}.\n$$\n\nWe design a free-streaming, oblique-incidence test across a density discontinuity that induces a step in neutrino energy density while keeping the propagation direction uniform. Consider a two-dimensional Cartesian setting with coordinates $(x,y)$ and a planar discontinuity in $E$ across $x = 0$. Let the left and right states be $E_L$ for $x  0$ and $E_R$ for $x \\ge 0$, both constant in $y$. Within a representative interface control volume of width $\\Delta x$ centered on $x = 0$, define:\n- The local gradient $\\mathbf{g} \\equiv \\nabla E = \\big((E_R - E_L)/\\Delta x,\\, 0\\big)$.\n- The beam direction unit vector $\\mathbf{n} = (\\cos \\theta, \\sin \\theta)$, with $\\theta$ specified in radians.\n- The local apparent flux factor $f_{\\mathrm{app}} \\in (0, 1]$ modeling numerical angular smearing at oblique incidence near the discontinuity.\n- The local initial state at the interface center $E_0 \\equiv (E_L + E_R)/2$, $\\mathbf{F}_0 \\equiv c \\, f_{\\mathrm{app}} \\, E_0 \\, \\mathbf{n}$.\n\nUsing a single forward Euler step of size $\\Delta t$, advance the moments according to the closed system:\n$$\nE_1 = E_0 + \\Delta t \\left( - \\nabla \\cdot \\mathbf{F}_0 \\right), \\qquad \\mathbf{F}_1 = \\mathbf{F}_0 + \\Delta t \\left( - c^2 \\nabla \\cdot \\mathsf{P}_0 \\right),\n$$\nwith\n$$\n\\nabla \\cdot \\mathbf{F}_0 = c \\, f_{\\mathrm{app}} \\, (\\mathbf{n} \\cdot \\mathbf{g}), \\qquad \\mathsf{P}_0 = \\mathsf{D}(f_{\\mathrm{app}}) \\, E_0, \\qquad \\nabla \\cdot \\mathsf{P}_0 = \\left[\\frac{1 - \\chi(f_{\\mathrm{app}})}{2}\\right] \\mathbf{g} + \\left[\\frac{3 \\chi(f_{\\mathrm{app}}) - 1}{2}\\right] \\mathbf{n} \\, (\\mathbf{n} \\cdot \\mathbf{g}),\n$$\nwhere $\\chi(f)$ is the Eddington factor for the chosen closure and $\\mathsf{D}(f)$ is evaluated using $f_{\\mathrm{app}}$ and $\\mathbf{n}$.\n\nDefine the two diagnostics to quantify closure-induced artifacts at oblique incidence:\n- The dimensionless lateral flux magnitude\n$$\nL \\equiv \\frac{\\lVert \\mathbf{F}_{1,\\perp} \\rVert}{c E_0}, \\quad \\text{where} \\quad \\mathbf{F}_{1,\\perp} \\equiv \\mathbf{F}_1 - (\\mathbf{n} \\cdot \\mathbf{F}_1) \\mathbf{n},\n$$\nwhich measures spurious lateral flux relative to the characteristic free-streaming scale $c E_0$ and should be zero for perfectly beam-like free streaming across the discontinuity.\n- The flux-factor error after one step\n$$\n\\varepsilon_f \\equiv f_1 - 1, \\quad \\text{where} \\quad f_1 \\equiv \\frac{\\lVert \\mathbf{F}_1 \\rVert}{c E_1},\n$$\nwhich measures the deviation from the beam limit $f = 1$ induced by the closure in the presence of the discontinuity and oblique incidence.\n\nImplement a program that, for each closure, computes $L$ and $\\varepsilon_f$ for the following test suite. Use the physical speed of light $c = 2.99792458 \\times 10^{10} \\ \\mathrm{cm} \\ \\mathrm{s}^{-1}$. All energies $E$ are in $\\mathrm{erg} \\ \\mathrm{cm}^{-3}$, distances $\\Delta x$ in $\\mathrm{cm}$, times $\\Delta t$ in $\\mathrm{s}$, and $\\theta$ in radians. Report $L$ and $\\varepsilon_f$ as dimensionless real numbers.\n\nTest suite (each tuple is $(E_L, E_R, \\Delta x, \\theta, f_{\\mathrm{app}}, \\Delta t)$):\n- Case $1$: $\\left(1.0 \\times 10^{20}, \\ 0.5 \\times 10^{20}, \\ 1.0 \\times 10^{5}, \\ \\frac{\\pi}{4}, \\ 0.85, \\ 1.0 \\times 10^{-7}\\right)$.\n- Case $2$: $\\left(1.0 \\times 10^{20}, \\ 0.2 \\times 10^{20}, \\ 5.0 \\times 10^{4}, \\ 0.08726646259971647, \\ 0.70, \\ 5.0 \\times 10^{-8}\\right)$.\n- Case $3$: $\\left(1.0 \\times 10^{20}, \\ 0.9 \\times 10^{20}, \\ 1.0 \\times 10^{5}, \\ 1.48352986419518, \\ 0.90, \\ 1.0 \\times 10^{-7}\\right)$.\n\nFinal output specification:\n- For each case, compute the pair $(L_{\\mathrm{Lev}}, \\varepsilon_{f,\\mathrm{Lev}})$ using the Levermore closure and the pair $(L_{\\mathrm{Ker}}, \\varepsilon_{f,\\mathrm{Ker}})$ using the Kershaw closure.\n- Your program should produce a single line of output containing the results for all cases concatenated in order as a comma-separated list enclosed in square brackets, with each case contributing the four values in the order $\\left[L_{\\mathrm{Lev}}, \\varepsilon_{f,\\mathrm{Lev}}, L_{\\mathrm{Ker}}, \\varepsilon_{f,\\mathrm{Ker}}\\right]$. For example, the overall output format is\n$$\n\\left[ L_{\\mathrm{Lev}}^{(1)}, \\varepsilon_{f,\\mathrm{Lev}}^{(1)}, L_{\\mathrm{Ker}}^{(1)}, \\varepsilon_{f,\\mathrm{Ker}}^{(1)}, \\ L_{\\mathrm{Lev}}^{(2)}, \\varepsilon_{f,\\mathrm{Lev}}^{(2)}, L_{\\mathrm{Ker}}^{(2)}, \\varepsilon_{f,\\mathrm{Ker}}^{(2)}, \\ L_{\\mathrm{Lev}}^{(3)}, \\varepsilon_{f,\\mathrm{Lev}}^{(3)}, L_{\\mathrm{Ker}}^{(3)}, \\varepsilon_{f,\\mathrm{Ker}}^{(3)} \\right].\n$$\nAll floating-point values should be printed in default numeric formatting without additional text.", "solution": "## Problem Validation ##\nThe problem statement is critically evaluated against the specified criteria.\n\n### Step 1: Extract Givens\n**Governing Equations (free-streaming, no sources):**\n- Conservation of energy density $E$: $\\partial_t E + \\nabla \\cdot \\mathbf{F} = 0$\n- Conservation of energy flux $\\mathbf{F}$: $\\partial_t \\mathbf{F} + c^2 \\nabla \\cdot \\mathsf{P} = 0$\n\n**Closure Relation (Algebraic Eddington Tensor):**\n- Pressure tensor $\\mathsf{P} = \\mathsf{D} E$\n- Eddington tensor $\\mathsf{D} = \\frac{1 - \\chi(f)}{2} \\, \\mathsf{I} + \\frac{3 \\chi(f) - 1}{2} \\, \\mathbf{n} \\mathbf{n}$\n- Flux factor $f = \\frac{\\lVert \\mathbf{F} \\rVert}{c E}$\n- Flux direction $\\mathbf{n} = \\mathbf{F} / \\lVert \\mathbf{F} \\rVert$\n\n**Eddington Factor Models ($\\chi(f)$):**\n- Levermore (M1): $\\chi_{\\mathrm{Lev}}(f) = \\frac{3 + 4 f^2}{5 + 2 \\sqrt{4 - 3 f^2}}$\n- Kershaw: $\\chi_{\\mathrm{Ker}}(f) = \\frac{1 + 2 f^2}{3}$\n\n**Test Case Setup (2D Cartesian):**\n- Discontinuity in $E$ at $x=0$: $E_L$ for $x  0$, $E_R$ for $x \\ge 0$.\n- Local gradient: $\\mathbf{g} \\equiv \\nabla E = \\big((E_R - E_L)/\\Delta x,\\, 0\\big)$.\n- Beam direction unit vector: $\\mathbf{n} = (\\cos \\theta, \\sin \\theta)$.\n- Local apparent flux factor: $f_{\\mathrm{app}} \\in (0, 1]$.\n- Initial state at interface center: $E_0 \\equiv (E_L + E_R)/2$, $\\mathbf{F}_0 \\equiv c \\, f_{\\mathrm{app}} \\, E_0 \\, \\mathbf{n}$.\n\n**Time Integration (Forward Euler Step):**\n- $E_1 = E_0 + \\Delta t \\left( - \\nabla \\cdot \\mathbf{F}_0 \\right)$\n- $\\mathbf{F}_1 = \\mathbf{F}_0 + \\Delta t \\left( - c^2 \\nabla \\cdot \\mathsf{P}_0 \\right)$\n\n**Divergence Approximations:**\n- $\\nabla \\cdot \\mathbf{F}_0 = c \\, f_{\\mathrm{app}} \\, (\\mathbf{n} \\cdot \\mathbf{g})$\n- $\\nabla \\cdot \\mathsf{P}_0 = \\left[\\frac{1 - \\chi(f_{\\mathrm{app}})}{2}\\right] \\mathbf{g} + \\left[\\frac{3 \\chi(f_{\\mathrm{app}}) - 1}{2}\\right] \\mathbf{n} \\, (\\mathbf{n} \\cdot \\mathbf{g})$\n\n**Diagnostics:**\n- Lateral flux magnitude: $L \\equiv \\frac{\\lVert \\mathbf{F}_{1,\\perp} \\rVert}{c E_0}$, where $\\mathbf{F}_{1,\\perp} \\equiv \\mathbf{F}_1 - (\\mathbf{n} \\cdot \\mathbf{F}_1) \\mathbf{n}$.\n- Flux-factor error: $\\varepsilon_f \\equiv f_1 - 1$, where $f_1 \\equiv \\frac{\\lVert \\mathbf{F}_1 \\rVert}{c E_1}$.\n\n**Constants and Parameters:**\n- Speed of light: $c = 2.99792458 \\times 10^{10} \\ \\mathrm{cm} \\ \\mathrm{s}^{-1}$.\n- Test suite (as tuples of $(E_L, E_R, \\Delta x, \\theta, f_{\\mathrm{app}}, \\Delta t)$):\n    1.  $(1.0 \\times 10^{20}, \\ 0.5 \\times 10^{20}, \\ 1.0 \\times 10^{5}, \\ \\frac{\\pi}{4}, \\ 0.85, \\ 1.0 \\times 10^{-7})$\n    2.  $(1.0 \\times 10^{20}, \\ 0.2 \\times 10^{20}, \\ 5.0 \\times 10^{4}, \\ 0.08726646259971647, \\ 0.70, \\ 5.0 \\times 10^{-8})$\n    3.  $(1.0 \\times 10^{20}, \\ 0.9 \\times 10^{20}, \\ 1.0 \\times 10^{5}, \\ 1.48352986419518, \\ 0.90, \\ 1.0 \\times 10^{-7})$\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on the well-established moment formulation of radiation transport, a standard technique in computational astrophysics and physics. The governing equations are the first two moments of the Boltzmann transport equation. The M1 (Levermore) and Kershaw closures are standard, widely used algebraic closures. The test setup, involving oblique incidence on a discontinuity, is a common method for evaluating the performance of such closures. The problem is scientifically sound.\n2.  **Well-Posed:** All required equations, initial conditions, constants, and parameters are explicitly provided. The sequence of calculations is clearly defined, leading to a unique numerical result for each test case. The problem is well-posed.\n3.  **Objective:** The problem is stated in precise mathematical and physical terms, free of subjectivity or ambiguity.\n4.  **Completeness and Consistency:** The problem is self-contained. The provided formula for $\\nabla \\cdot \\mathsf{P}_0$ is a correct application of the product rule for divergence on $\\mathsf{P} = \\mathsf{D} E$, under the assumption that the Eddington tensor $\\mathsf{D}$ is constant across the control volume, which is a reasonable approximation for this single-step analysis. All components are consistent.\n5.  **Realism and Feasibility:** The values provided for energy densities, lengths, and times are characteristic of astrophysical environments like supernova explosions or neutron star mergers where neutrino transport is significant. The problem is physically plausible and computationally feasible.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-defined computational problem in nuclear astrophysics, conforming to all validation criteria. A solution will be provided.\n\n## Solution ##\nThe solution requires implementing the time-evolution of the neutrino energy density $E$ and energy flux $\\mathbf{F}$ for a single forward Euler step and then computing the specified diagnostics. The calculation is performed for two different moment closure schemes, Levermore and Kershaw.\n\nWe begin by establishing the state variables and parameters for a given test case $(E_L, E_R, \\Delta x, \\theta, f_{\\mathrm{app}}, \\Delta t)$. The speed of light is $c = 2.99792458 \\times 10^{10} \\ \\mathrm{cm} \\ \\mathrm{s}^{-1}$.\n\n**1. Initial State and Discretized Gradients**\n\nThe initial state is defined at the center of a control volume straddling the discontinuity at $x=0$.\nThe initial energy density $E_0$ is the average of the left and right states:\n$$\nE_0 = \\frac{E_L + E_R}{2}\n$$\nThe neutrino beam propagates in a direction given by the unit vector $\\mathbf{n}$:\n$$\n\\mathbf{n} = (\\cos\\theta, \\sin\\theta)^T\n$$\nThe initial energy flux $\\mathbf{F}_0$ is constructed using the given apparent flux factor $f_{\\mathrm{app}}$, which models the state at the interface:\n$$\n\\mathbf{F}_0 = c \\, f_{\\mathrm{app}} \\, E_0 \\, \\mathbf{n}\n$$\nThe finite difference approximation of the energy density gradient $\\mathbf{g} = \\nabla E$ across the control volume of width $\\Delta x$ is:\n$$\n\\mathbf{g} = \\left(\\frac{E_R - E_L}{\\Delta x}, 0\\right)^T\n$$\nThis vector represents the spatial change in energy density.\n\n**2. Divergence Term Calculation**\n\nThe forward Euler update requires the divergence of the flux, $\\nabla \\cdot \\mathbf{F}_0$, and the divergence of the pressure tensor, $\\nabla \\cdot \\mathsf{P}_0$.\nThe problem provides the expression for the divergence of the flux, which arises from assuming $\\mathbf{F} = c f_{\\mathrm{app}} E \\mathbf{n}$ with constant $f_{\\mathrm{app}}$ and $\\mathbf{n}$:\n$$\n\\nabla \\cdot \\mathbf{F}_0 = \\nabla \\cdot (c f_{\\mathrm{app}} E_0 \\mathbf{n}) = c f_{\\mathrm{app}} \\mathbf{n} \\cdot \\nabla E_0 = c f_{\\mathrm{app}} (\\mathbf{n} \\cdot \\mathbf{g})\n$$\nThe divergence of the pressure tensor is given by:\n$$\n\\nabla \\cdot \\mathsf{P}_0 = \\left[\\frac{1 - \\chi(f_{\\mathrm{app}})}{2}\\right] \\mathbf{g} + \\left[\\frac{3 \\chi(f_{\\mathrm{app}}) - 1}{2}\\right] \\mathbf{n} (\\mathbf{n} \\cdot \\mathbf{g})\n$$\nThis term's value depends on the Eddington factor $\\chi(f_{\\mathrm{app}})$, which is calculated using the specified closure model:\n- **Levermore Closure:** $\\chi_{\\mathrm{Lev}}(f_{\\mathrm{app}}) = \\frac{3 + 4 f_{\\mathrm{app}}^2}{5 + 2 \\sqrt{4 - 3 f_{\\mathrm{app}}^2}}$\n- **Kershaw Closure:** $\\chi_{\\mathrm{Ker}}(f_{\\mathrm{app}}) = \\frac{1 + 2 f_{\\mathrm{app}}^2}{3}$\nWe perform the subsequent steps for each closure separately.\n\n**3. Forward Euler Time Step**\n\nThe energy density and flux are updated from time $t_0$ to $t_1 = t_0 + \\Delta t$ using the discretized conservation laws:\n$$\nE_1 = E_0 - \\Delta t (\\nabla \\cdot \\mathbf{F}_0)\n$$\n$$\n\\mathbf{F}_1 = \\mathbf{F}_0 - \\Delta t \\, c^2 (\\nabla \\cdot \\mathsf{P}_0)\n$$\n\n**4. Diagnostic Calculation**\n\nAfter computing the updated state $(E_1, \\mathbf{F}_1)$, we calculate the two diagnostics.\n\n- **Dimensionless Lateral Flux Magnitude, $L$:**\nThis diagnostic quantifies the spurious flux generated perpendicular to the intended beam direction $\\mathbf{n}$. First, we project $\\mathbf{F}_1$ onto $\\mathbf{n}$ to find its parallel component, $(\\mathbf{n} \\cdot \\mathbf{F}_1)\\mathbf{n}$. The perpendicular component is then:\n$$\n\\mathbf{F}_{1,\\perp} = \\mathbf{F}_1 - (\\mathbf{n} \\cdot \\mathbf{F}_1)\\mathbf{n}\n$$\nThe dimensionless magnitude is its norm, scaled by the characteristic flux $c E_0$:\n$$\nL = \\frac{\\lVert \\mathbf{F}_{1,\\perp} \\rVert}{c E_0}\n$$\n\n- **Flux-Factor Error, $\\varepsilon_f$:**\nThis diagnostic measures how far the updated state deviates from the free-streaming limit ($f=1$). We first compute the new flux factor $f_1$:\n$$\nf_1 = \\frac{\\lVert \\mathbf{F}_1 \\rVert}{c E_1}\n$$\nThe error is the difference from the ideal value of $1$:\n$$\n\\varepsilon_f = f_1 - 1\n$$\nThis entire procedure is repeated for each of the three test cases, and for each case, both the Levermore and Kershaw closures are used to compute the pair of diagnostics $(L, \\varepsilon_f)$. The final output concatenates these results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes closure-induced artifacts in a two-moment neutrino transport test.\n    \"\"\"\n    # Physical constants\n    c = 2.99792458e10  # Speed of light in cm/s\n\n    # Test suite: (E_L, E_R, delta_x, theta, f_app, delta_t)\n    test_cases = [\n        (1.0e20, 0.5e20, 1.0e5, np.pi/4, 0.85, 1.0e-7),\n        (1.0e20, 0.2e20, 5.0e4, 0.08726646259971647, 0.70, 5.0e-8), # theta approx 5 deg\n        (1.0e20, 0.9e20, 1.0e5, 1.48352986419518, 0.90, 1.0e-7),    # theta approx 85 deg\n    ]\n\n    all_results = []\n\n    # Define Eddington factor functions\n    def chi_levermore(f):\n        # The M1 closure requires 4 - 3f^2 = 0, or |f| = 2/sqrt(3) approx 1.1547.\n        # The problem statement guarantees f_app in (0, 1], so this is safe.\n        return (3.0 + 4.0 * f**2) / (5.0 + 2.0 * np.sqrt(4.0 - 3.0 * f**2))\n\n    def chi_kershaw(f):\n        return (1.0 + 2.0 * f**2) / 3.0\n\n    closure_funcs = {\n        'levermore': chi_levermore,\n        'kershaw': chi_kershaw,\n    }\n\n    for case in test_cases:\n        E_L, E_R, delta_x, theta, f_app, delta_t = case\n\n        # 1. Initial State and Discretized Gradients\n        E0 = (E_L + E_R) / 2.0\n        g_vec = np.array([(E_R - E_L) / delta_x, 0.0])\n        n_vec = np.array([np.cos(theta), np.sin(theta)])\n        F0_vec = c * f_app * E0 * n_vec\n\n        # 2. Divergence Term Calculation\n        # This part is common to both closures\n        n_dot_g = np.dot(n_vec, g_vec)\n        div_F0 = c * f_app * n_dot_g\n\n        # Perform calculations for each closure\n        for closure_name in ['levermore', 'kershaw']:\n            chi_func = closure_funcs[closure_name]\n            chi = chi_func(f_app)\n\n            # Calculate divergence of pressure tensor\n            term1_coeff = (1.0 - chi) / 2.0\n            term2_coeff = (3.0 * chi - 1.0) / 2.0\n            div_P0_vec = term1_coeff * g_vec + term2_coeff * n_vec * n_dot_g\n            \n            # 3. Forward Euler Time Step\n            E1 = E0 - delta_t * div_F0\n            F1_vec = F0_vec - delta_t * c**2 * div_P0_vec\n\n            # 4. Diagnostic Calculation\n            # Lateral Flux Magnitude (L)\n            F1_perp_vec = F1_vec - np.dot(n_vec, F1_vec) * n_vec\n            L = np.linalg.norm(F1_perp_vec) / (c * E0)\n\n            # Flux-Factor Error (eps_f)\n            # Handle potential E1=0 case to avoid division by zero\n            if E1 == 0.0:\n                 # In this specific problem setup E1 will not realistically be zero.\n                f1 = np.inf if np.linalg.norm(F1_vec)  0 else 0.0\n            else:\n                f1 = np.linalg.norm(F1_vec) / (c * E1)\n            \n            eps_f = f1 - 1.0\n\n            all_results.extend([L, eps_f])\n            \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3572208"}]}