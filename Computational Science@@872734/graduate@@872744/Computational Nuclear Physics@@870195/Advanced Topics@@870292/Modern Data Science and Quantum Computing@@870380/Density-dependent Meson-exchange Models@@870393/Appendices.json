{"hands_on_practices": [{"introduction": "Understanding how a many-body system responds to compression is fundamental to its equation of state. This practice guides you through the analytical derivation of the incompressibility modulus, $K$, a key quantity characterizing the stiffness of nuclear matter. By working through this problem [@problem_id:3555155], you will directly engage with the rearrangement self-energy, $\\Sigma^R$, which is a necessary consequence of density-dependent interactions and is crucial for maintaining thermodynamic consistency.", "problem": "Consider symmetric, infinite nuclear matter at zero temperature in a relativistic mean-field model with density-dependent meson-nucleon couplings (density-dependent relativistic mean field, also called density-dependent meson-exchange). Nucleons of bare mass $M$ interact via an isoscalar-scalar meson field $\\sigma$ and an isoscalar-vector meson field $\\omega_{\\mu}$, with density-dependent couplings $g_{\\sigma}(\\rho)$ and $g_{\\omega}(\\rho)$. The meson masses $m_{\\sigma}$ and $m_{\\omega}$ are constants. Work in the Hartree (mean-field) approximation and assume spatially uniform matter, so only the time component $\\omega_{0}$ is nonzero. Let the couplings depend on the baryon density $\\rho$ through the exponential parametrization\n$$\ng_{\\sigma}(\\rho) = g_{\\sigma 0}\\,\\exp\\!\\left[-a\\left(\\frac{\\rho}{\\rho_{0}}-1\\right)\\right], \n\\qquad\ng_{\\omega}(\\rho) = g_{\\omega 0}\\,\\exp\\!\\left[-b\\left(\\frac{\\rho}{\\rho_{0}}-1\\right)\\right],\n$$\nwhere $g_{\\sigma 0}=g_{\\sigma}(\\rho_{0})$ and $g_{\\omega 0}=g_{\\omega}(\\rho_{0})$, and $a$ and $b$ are dimensionless parameters. Consider symmetric nuclear matter with spin-isospin degeneracy $\\gamma=4$, Fermi momentum $k_{F}$ related to density by $\\rho = 2 k_{F}^{3}/(3\\pi^{2})$, Dirac effective mass $M^{*} = M - g_{\\sigma}(\\rho)\\,\\sigma$, and Fermi energy $E_{F}^{*}=\\sqrt{k_{F}^{2}+M^{*2}}$. The scalar density is\n$$\n\\rho_{s}(k_{F},M^{*})=\\frac{\\gamma M^{*}}{4\\pi^{2}}\\left[k_{F}E_{F}^{*}-M^{*2}\\ln\\!\\left(\\frac{k_{F}+E_{F}^{*}}{M^{*}}\\right)\\right],\n$$\nand the mean fields satisfy the static field equations\n$$\nm_{\\sigma}^{2}\\,\\sigma = g_{\\sigma}(\\rho)\\,\\rho_{s}, \n\\qquad\nm_{\\omega}^{2}\\,\\omega_{0} = g_{\\omega}(\\rho)\\,\\rho.\n$$\nThe rearrangement self-energy required by thermodynamic consistency is\n$\n\\Sigma^{R}(\\rho)=\\frac{\\partial g_{\\omega}}{\\partial \\rho}\\,\\omega_{0}\\,\\rho - \\frac{\\partial g_{\\sigma}}{\\partial \\rho}\\,\\sigma\\,\\rho_{s}.\n$\nThe zero-temperature chemical potential is\n$\n\\mu(\\rho)=E_{F}^{*} + g_{\\omega}(\\rho)\\,\\omega_{0}(\\rho) + \\Sigma^{R}(\\rho).\n$\nDefine the incompressibility modulus at the saturation density $\\rho_{0}$ by $K=9\\,\\left.\\frac{\\partial P}{\\partial \\rho}\\right|_{\\rho_{0}}$, and use the zero-temperature identity $P=\\rho\\,\\mu-\\varepsilon$ with $\\mu=\\partial \\varepsilon/\\partial \\rho$ to write $K=9\\,\\rho\\,\\partial \\mu/\\partial \\rho$ evaluated at $\\rho_{0}$.\n\nStarting only from the definitions above and the stated parametrization, derive an analytic expression for $K$ at $\\rho_{0}$ that makes explicit how the density derivatives of the couplings enter. Your derivation must keep the dependence on the first derivatives $g_{\\sigma}'(\\rho_{0})$ and $g_{\\omega}'(\\rho_{0})$, and you must consistently include the rearrangement self-energy. Express the final result entirely in terms of the quantities evaluated at $\\rho_{0}$: $k_{F0}$, $E_{0}\\equiv E_{F0}^{*}$, $M_{0}^{*}$, $\\rho_{0}$, $\\rho_{s0}$, $\\sigma_{0}$, $m_{\\sigma}$, $m_{\\omega}$, $g_{\\sigma 0}$, $g_{\\omega 0}$, and the parameters $a$ and $b$, together with the functions and partial derivatives of $\\rho_{s}$ with respect to $k_{F}$ and $M^{*}$. For clarity, you may define intermediate quantities that appear in the final expression, but your final answer must be a single closed-form analytic expression for $K$ in terms of these standard functions and parameters.\n\nDo not substitute any numerical values. The final answer must be an analytic expression and must not include units. If you introduce any shorthand, define it explicitly. Round nothing; no numerical approximation is required.", "solution": "The user wants to derive the incompressibility modulus, $K$, at saturation density $\\rho_0$ for a density-dependent relativistic mean-field model.\n\n### Step 1: Extract Givens\n-   Model: Symmetric, infinite nuclear matter at zero temperature.\n-   Nucleon bare mass: $M$.\n-   Meson fields: Isoscalar-scalar $\\sigma$, isoscalar-vector $\\omega_{\\mu}$.\n-   Meson masses: $m_{\\sigma}$, $m_{\\omega}$ (constants).\n-   Approximation: Hartree (mean-field), spatially uniform matter ($\\omega_{k}=0$).\n-   Density-dependent couplings: $g_{\\sigma}(\\rho) = g_{\\sigma 0}\\,\\exp[-a(\\frac{\\rho}{\\rho_{0}}-1)]$ and $g_{\\omega}(\\rho) = g_{\\omega 0}\\,\\exp[-b(\\frac{\\rho}{\\rho_{0}}-1)]$.\n-   Constants: $g_{\\sigma 0}=g_{\\sigma}(\\rho_{0})$, $g_{\\omega 0}=g_{\\omega}(\\rho_{0})$, $a$, $b$.\n-   Degeneracy factor: $\\gamma=4$.\n-   Baryon density: $\\rho = \\frac{2 k_{F}^{3}}{3\\pi^{2}}$.\n-   Dirac effective mass: $M^{*} = M - g_{\\sigma}(\\rho)\\,\\sigma$.\n-   Fermi energy: $E_{F}^{*}=\\sqrt{k_{F}^{2}+M^{*2}}$.\n-   Scalar density: $\\rho_{s}(k_{F},M^{*})=\\frac{\\gamma M^{*}}{4\\pi^{2}}\\left[k_{F}E_{F}^{*}-M^{*2}\\ln\\left(\\frac{k_{F}+E_{F}^{*}}{M^{*}}\\right)\\right]$.\n-   Mean-field equations: $m_{\\sigma}^{2}\\,\\sigma = g_{\\sigma}(\\rho)\\,\\rho_{s}$ and $m_{\\omega}^{2}\\,\\omega_{0} = g_{\\omega}(\\rho)\\,\\rho$.\n-   Rearrangement self-energy: $\\Sigma^{R}(\\rho)=\\frac{\\partial g_{\\omega}}{\\partial \\rho}\\,\\omega_{0}\\,\\rho - \\frac{\\partial g_{\\sigma}}{\\partial \\rho}\\,\\sigma\\,\\rho_{s}$.\n-   Chemical potential: $\\mu(\\rho)=E_{F}^{*} + g_{\\omega}(\\rho)\\,\\omega_{0}(\\rho) + \\Sigma^{R}(\\rho)$.\n-   Incompressibility modulus: $K=9\\,\\left.\\frac{\\partial P}{\\partial \\rho}\\right|_{\\rho_{0}}$, which is equivalent to $K=9\\,\\rho\\,\\left.\\frac{\\partial \\mu}{\\partial \\rho}\\right|_{\\rho_{0}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard exercise in computational nuclear physics concerning density-dependent relativistic mean-field models. The provided equations are standard definitions within this framework. The problem is well-posed, objective, and self-contained. It asks for a specific analytical derivation, which is a formalizable and solvable task. There are no contradictions, ambiguities, or unrealistic assumptions. The problem is valid.\n\n### Step 3: Derivation of the Incompressibility Modulus $K$\n\nThe incompressibility modulus at saturation density $\\rho_0$ is defined as $K = 9\\rho_0 \\left(\\frac{d\\mu}{d\\rho}\\right)_{\\rho_0}$. Our goal is to calculate the derivative of the chemical potential $\\mu$ with respect to the baryon density $\\rho$ and evaluate it at $\\rho_0$.\n\nFirst, let's write the full expression for the chemical potential $\\mu$. We substitute the field equations and the definition of $\\Sigma^R$ into the expression for $\\mu$:\n$$\n\\mu(\\rho) = E_{F}^{*} + g_{\\omega}(\\rho)\\omega_{0} + \\Sigma^{R}(\\rho)\n$$\nUsing $\\omega_0 = \\frac{g_\\omega(\\rho)\\rho}{m_\\omega^2}$, $\\sigma = \\frac{g_\\sigma(\\rho)\\rho_s}{m_\\sigma^2}$, and $\\Sigma^R = g_\\omega' \\omega_0 \\rho - g_\\sigma' \\sigma \\rho_s$, where $g' = dg/d\\rho$:\n$$\n\\mu(\\rho) = E_{F}^{*} + \\frac{g_{\\omega}^2(\\rho)\\rho}{m_{\\omega}^2} + \\frac{g_\\omega(\\rho)g_\\omega'(\\rho)\\rho^2}{m_\\omega^2} - \\frac{g_\\sigma(\\rho)g_\\sigma'(\\rho)\\rho_s^2}{m_\\sigma^2}\n$$\nWe differentiate this expression for $\\mu(\\rho)$ with respect to $\\rho$.\n$$\n\\frac{d\\mu}{d\\rho} = \\frac{dE_F^*}{d\\rho} + \\frac{d}{d\\rho}\\left(\\frac{g_{\\omega}^2\\rho}{m_{\\omega}^2} + \\frac{g_\\omega g_\\omega'\\rho^2}{m_\\omega^2}\\right) - \\frac{d}{d\\rho}\\left(\\frac{g_\\sigma g_\\sigma'\\rho_s^2}{m_\\sigma^2}\\right)\n$$\nLet's analyze each term.\n\nThe $\\omega$-meson contribution to $d\\mu/d\\rho$:\nThe derivative for the $\\omega$ part is:\n$$\n\\frac{d}{d\\rho}\\left(\\frac{g_{\\omega}^2\\rho + g_\\omega g_\\omega'\\rho^2}{m_\\omega^2}\\right) = \\frac{1}{m_\\omega^2} \\left[ (2g_\\omega g_\\omega' \\rho + g_\\omega^2) + ( (g_\\omega')^2+g_\\omega g_\\omega'')\\rho^2 + g_\\omega g_\\omega' (2\\rho) \\right]\n$$\n$$\n= \\frac{1}{m_\\omega^2} \\left[ g_\\omega^2 + 4\\rho g_\\omega g_\\omega' + \\rho^2 \\left( (g_\\omega')^2 + g_\\omega g_\\omega'' \\right) \\right]\n$$\nFor the given parametrization $g_i(\\rho) = g_{i0}\\exp[-x_i(\\rho/\\rho_0-1)]$, we have the derivatives:\n$g_i'(\\rho) = -\\frac{x_i}{\\rho_0} g_i(\\rho)$ and $g_i''(\\rho) = \\left(\\frac{x_i}{\\rho_0}\\right)^2 g_i(\\rho)$.\nAt $\\rho=\\rho_0$, we have $g_i(\\rho_0)=g_{i0}$, $g_i'(\\rho_0) = -x_i g_{i0}/\\rho_0$, and $g_i''(\\rho_0) = x_i^2 g_{i0}/\\rho_0^2$.\nSubstituting these for the $\\omega$ meson ($i=\\omega, x_i=b$) at $\\rho_0$:\n$$\n\\left(\\frac{d\\mu}{d\\rho}\\right)_{\\omega, \\rho_0} = \\frac{1}{m_\\omega^2} \\left[ g_{\\omega 0}^2 + 4\\rho_0 g_{\\omega 0} \\left(-\\frac{b g_{\\omega 0}}{\\rho_0}\\right) + \\rho_0^2 \\left( \\left(-\\frac{b g_{\\omega 0}}{\\rho_0}\\right)^2 + g_{\\omega 0} \\left(\\frac{b^2 g_{\\omega 0}}{\\rho_0^2}\\right) \\right) \\right] = \\frac{g_{\\omega 0}^2}{m_\\omega^2} (1 - 4b + 2b^2)\n$$\n\nThe kinetic and $\\sigma$-meson contributions to $d\\mu/d\\rho$:\nThis part is more involved due to the self-consistency of the effective mass $M^*$.\n$$\n\\frac{d}{d\\rho} \\left(E_F^* - \\frac{g_\\sigma g_\\sigma'\\rho_s^2}{m_\\sigma^2}\\right) = \\frac{dE_F^*}{d\\rho} - \\frac{1}{m_\\sigma^2} \\frac{d}{d\\rho}(g_\\sigma g_\\sigma'\\rho_s^2)\n$$\nThe derivative of $E_F^* = \\sqrt{k_F^2+M^{*2}}$ is:\n$$\n\\frac{dE_F^*}{d\\rho} = \\frac{\\partial E_F^*}{\\partial k_F}\\frac{dk_F}{d\\rho} + \\frac{\\partial E_F^*}{\\partial M^*}\\frac{dM^*}{d\\rho} = \\frac{k_F}{E_F^*}\\left(\\frac{k_F}{3\\rho}\\right) + \\frac{M^*}{E_F^*}\\frac{dM^*}{d\\rho} = \\frac{k_F^2}{3\\rho E_F^*} + \\frac{M^*}{E_F^*}\\frac{dM^*}{d\\rho}\n$$\nThe derivative of the $\\sigma$ rearrangement term is:\n$$\n- \\frac{1}{m_\\sigma^2} \\frac{d}{d\\rho}(g_\\sigma g_\\sigma'\\rho_s^2) = - \\frac{1}{m_\\sigma^2} \\left[ ((g_\\sigma')^2 + g_\\sigma g_\\sigma'')\\rho_s^2 + g_\\sigma g_\\sigma'(2\\rho_s \\frac{d\\rho_s}{d\\rho}) \\right]\n$$\nTo find $\\frac{dM^*}{d\\rho}$ and $\\frac{d\\rho_s}{d\\rho}$, we differentiate the self-consistency equation for $M^*$:\n$$\nM^* = M - \\frac{g_\\sigma^2(\\rho)}{m_\\sigma^2} \\rho_s(k_F(\\rho), M^*(\\rho))\n$$\nDifferentiating w.r.t. $\\rho$:\n$$\n\\frac{dM^*}{d\\rho} = - \\frac{1}{m_\\sigma^2} \\left[ 2g_\\sigma g_\\sigma' \\rho_s + g_\\sigma^2 \\frac{d\\rho_s}{d\\rho} \\right]\n$$\nUsing the chain rule for $\\rho_s$: $\\frac{d\\rho_s}{d\\rho} = \\frac{\\partial\\rho_s}{\\partial k_F}\\frac{dk_F}{d\\rho} + \\frac{\\partial\\rho_s}{\\partial M^*}\\frac{dM^*}{d\\rho} = \\frac{\\partial\\rho_s}{\\partial k_F}\\frac{k_F}{3\\rho} + \\frac{\\partial\\rho_s}{\\partial M^*}\\frac{dM^*}{d\\rho}$.\nSubstituting this into the equation for $\\frac{dM^*}{d\\rho}$ and solving for it:\n$$\n\\frac{dM^*}{d\\rho} \\left(1 + \\frac{g_\\sigma^2}{m_\\sigma^2}\\frac{\\partial\\rho_s}{\\partial M^*}\\right) = - \\frac{1}{m_\\sigma^2} \\left( 2g_\\sigma g_\\sigma' \\rho_s + g_\\sigma^2 \\frac{\\partial\\rho_s}{\\partial k_F}\\frac{k_F}{3\\rho} \\right)\n$$\n$$\n\\frac{dM^*}{d\\rho} = - \\frac{2g_\\sigma g_\\sigma' \\rho_s + g_\\sigma^2 \\frac{\\partial\\rho_s}{\\partial k_F}\\frac{k_F}{3\\rho}}{m_\\sigma^2 + g_\\sigma^2 \\frac{\\partial\\rho_s}{\\partial M^*}}\n$$\nLet's assemble the kinetic and $\\sigma$ contributions to $\\frac{d\\mu}{d\\rho}$. We collect terms that multiply $\\frac{dM^*}{d\\rho}$:\n$$\nC_{M^*} = \\frac{M^*}{E_F^*} - \\frac{2g_\\sigma g_\\sigma' \\rho_s}{m_\\sigma^2}\\frac{\\partial\\rho_s}{\\partial M^*}\n$$\nThe remaining terms are:\n$$\nR_\\sigma = \\frac{k_F^2}{3\\rho E_F^*} - \\frac{1}{m_\\sigma^2} \\left[ ((g_\\sigma')^2 + g_\\sigma g_\\sigma'')\\rho_s^2 + 2g_\\sigma g_\\sigma' \\rho_s \\frac{\\partial\\rho_s}{\\partial k_F}\\frac{k_F}{3\\rho} \\right]\n$$\nSo, the total kinetic and $\\sigma$ contribution is $R_\\sigma + C_{M^*} \\frac{dM^*}{d\\rho}$.\n\nNow, we evaluate all these expressions at $\\rho=\\rho_0$. We use the subscript '0' to denote quantities at saturation density (e.g., $k_{F0}$, $M_0^*=M_0^*(\\rho_0)$, etc.), and keep the explicit '0' on derivatives of $\\rho_s$.\nFor the $\\sigma$ meson ($i=\\sigma, x_i=a$): $g_{\\sigma 0}' = -a g_{\\sigma 0}/\\rho_0$ and $g_{\\sigma 0}'' = a^2 g_{\\sigma 0}/\\rho_0^2$.\n$$\n(g_{\\sigma 0}')^2 + g_{\\sigma 0}g_{\\sigma 0}'' = (-a \\frac{g_{\\sigma 0}}{\\rho_0})^2 + g_{\\sigma 0} (a^2 \\frac{g_{\\sigma 0}}{\\rho_0^2}) = \\frac{2a^2 g_{\\sigma 0}^2}{\\rho_0^2}\n$$\nSo, evaluated at $\\rho_0$:\n$$\nR_{\\sigma 0} = \\frac{k_{F0}^2}{3\\rho_0 E_0^*} - \\frac{1}{m_\\sigma^2} \\left[ \\frac{2a^2 g_{\\sigma 0}^2}{\\rho_0^2}\\rho_{s0}^2 + 2\\left(-\\frac{a g_{\\sigma 0}}{\\rho_0}\\right)g_{\\sigma 0} \\rho_{s0} \\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0\\frac{k_{F0}}{3\\rho_0} \\right]\n$$\n$$\nR_{\\sigma 0} = \\frac{k_{F0}^2}{3\\rho_0 E_0^*} - \\frac{2a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0^2} \\left[ a\\rho_{s0} - \\frac{k_{F0}}{3} \\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\right]\n$$\nThe coefficient $C_{M^*}$ at $\\rho_0$ is:\n$$\nC_{M^*0} = \\frac{M_0^*}{E_0^*} - \\frac{2(-\\frac{a g_{\\sigma 0}}{\\rho_0}) g_{\\sigma 0} \\rho_{s0}}{m_\\sigma^2}\\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0 = \\frac{M_0^*}{E_0^*} + \\frac{2a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0}\\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0\n$$\nAnd $(\\frac{dM^*}{d\\rho})_0$:\n$$\n\\left(\\frac{dM^*}{d\\rho}\\right)_{\\rho_0} = - \\frac{2(-\\frac{a g_{\\sigma 0}}{\\rho_0}) g_{\\sigma 0} \\rho_{s0} + g_{\\sigma 0}^2 \\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\frac{k_{F0}}{3\\rho_0}}{m_\\sigma^2 + g_{\\sigma 0}^2 \\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0} = \\frac{\\frac{g_{\\sigma 0}^2}{\\rho_0} \\left[ 2a\\rho_{s0} - \\frac{k_{F0}}{3}\\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\right]}{m_\\sigma^2 + g_{\\sigma 0}^2 \\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0}\n$$\nSumming all contributions to $(\\frac{d\\mu}{d\\rho})_{\\rho_0}$:\n$$\n\\left(\\frac{d\\mu}{d\\rho}\\right)_{\\rho_0} = R_{\\sigma 0} + C_{M^*0} \\left(\\frac{dM^*}{d\\rho}\\right)_{\\rho_0} + \\left(\\frac{d\\mu}{d\\rho}\\right)_{\\omega, \\rho_0}\n$$\nFinally, the incompressibility is $K = 9\\rho_0 (\\frac{d\\mu}{d\\rho})_{\\rho_0}$.\n$$\nK = 9\\rho_0 \\left( R_{\\sigma 0} + C_{M^*0} \\left(\\frac{dM^*}{d\\rho}\\right)_{\\rho_0} + \\frac{g_{\\omega 0}^2}{m_\\omega^2}(1-4b+2b^2) \\right)\n$$\nSubstituting the expressions for $R_{\\sigma 0}$, $C_{M^*0}$ and $(\\frac{dM^*}{d\\rho})_0$:\n$$\nK = 9\\rho_0 \\left\\{ \\frac{k_{F0}^2}{3\\rho_0 E_0^*} - \\frac{2a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0^2} \\left[ a\\rho_{s0} - \\frac{k_{F0}}{3} \\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\right] + \\frac{g_{\\omega 0}^2}{m_\\omega^2}(1-4b+2b^2) \\right\\} + 9\\rho_0 C_{M^*0} \\left(\\frac{dM^*}{d\\rho}\\right)_{\\rho_0}\n$$\n$$\nK = \\frac{3k_{F0}^2}{E_0^*} - \\frac{18a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0} \\left[ a\\rho_{s0} - \\frac{k_{F0}}{3} \\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\right] + \\frac{9\\rho_0 g_{\\omega 0}^2}{m_\\omega^2}(1-4b+2b^2) + 9\\rho_0 C_{M^*0} \\left(\\frac{dM^*}{d\\rho}\\right)_{\\rho_0}\n$$\nThe last term is:\n$$\n9\\rho_0 C_{M^*0} \\left(\\frac{dM^*}{d\\rho}\\right)_{\\rho_0} = 9\\rho_0 \\left[ \\frac{M_0^*}{E_0^*} + \\frac{2a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0}\\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0 \\right] \\left( \\frac{\\frac{g_{\\sigma 0}^2}{\\rho_0} \\left[ 2a\\rho_{s0} - \\frac{k_{F0}}{3}\\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\right]}{m_\\sigma^2 + g_{\\sigma 0}^2 \\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0} \\right)\n$$\nCombining everything yields the final expression for $K$.\n\nFor clarity in the final expression, let's define the denominator term:\n$D_{M^*0} = m_\\sigma^2 + g_{\\sigma 0}^2 \\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0$.\n\nThe final expression is the sum of all these pieces.\n$$\nK = \\frac{3k_{F0}^2}{E_0^*} + \\frac{9\\rho_0 g_{\\omega 0}^2}{m_\\omega^2}(1-4b+2b^2) - \\frac{18a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0} \\left( a\\rho_{s0} - \\frac{k_{F0}}{3}\\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\right) + 9 \\left[ \\frac{M_0^*}{E_0^*} + \\frac{2a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0}\\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0 \\right] \\frac{g_{\\sigma 0}^2 \\left( 2a\\rho_{s0} - \\frac{k_{F0}}{3}\\left(\\frac{\\partial\\rho_s}{\\partial k_F}\\right)_0 \\right)}{D_{M^*0}}\n$$\nThis expression is intricate, but correctly includes all required terms, particularly the rearrangement contributions stemming from the density-dependent couplings.", "answer": "$$\n\\boxed{\n\\frac{3k_{F0}^2}{E_{0}^{*}} + \\frac{9\\rho_0 g_{\\omega 0}^2}{m_\\omega^2}(1-4b+2b^2) - \\frac{18a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0} \\left[ a\\rho_{s0} - \\frac{k_{F0}}{3}\\left(\\frac{\\partial \\rho_s}{\\partial k_F}\\right)_0 \\right] + \\frac{9 g_{\\sigma 0}^2 \\left[ 2a\\rho_{s0} - \\frac{k_{F0}}{3}\\left(\\frac{\\partial \\rho_s}{\\partial k_F}\\right)_0 \\right]}{m_{\\sigma}^2 + g_{\\sigma 0}^2 \\left(\\frac{\\partial \\rho_s}{\\partial M^*}\\right)_0} \\left[ \\frac{M_0^*}{E_0^*} + \\frac{2a g_{\\sigma 0}^2 \\rho_{s0}}{m_\\sigma^2 \\rho_0}\\left(\\frac{\\partial\\rho_s}{\\partial M^*}\\right)_0 \\right]\n}\n$$", "id": "3555155"}, {"introduction": "Theoretical models in nuclear physics are brought to life through computation, translating complex equations into predictive power. This exercise [@problem_id:3555086] is a foundational step in building a robust Relativistic Mean-Field (RMF) solver, the workhorse for studying the nuclear equation of state. You will implement the core self-consistent fixed-point iteration to solve for the nucleon effective mass $M^*$ and self-energies, gaining hands-on experience with practical details like convergence criteria and unit management.", "problem": "Implement a program that, for uniform, isospin-symmetric nuclear matter at zero temperature within Relativistic Mean Field (RMF) theory with density-dependent couplings, solves the coupled Dirac and meson mean-field equations self-consistently by fixed-point iteration and reports converged scalar and vector self-energies. Begin from the following well-tested base in Quantum Hadrodynamics (QHD):\n\n- The Dirac equation in the mean-field approximation reads\n$$\\left[\\gamma^\\mu \\left(i \\partial_\\mu - \\Sigma_V \\delta_{\\mu 0}\\right) - \\left(M - \\Sigma_S\\right)\\right] \\psi = 0,$$\nwhere $M$ is the free nucleon mass, $\\Sigma_S$ is the scalar self-energy, and $\\Sigma_V$ is the time-like component of the vector self-energy.\n\n- In uniform matter, the meson fields are constants, and their mean-field equations are\n$$m_\\sigma^2 \\, \\phi_\\sigma = g_\\sigma(\\rho_B) \\, \\rho_S, \\qquad m_\\omega^2 \\, V_0 = g_\\omega(\\rho_B) \\, \\rho_B,$$\nwhere $m_\\sigma$ and $m_\\omega$ are the meson masses, $\\phi_\\sigma$ is the scalar meson field, $V_0$ is the time-like component of the vector meson field, $g_\\sigma(\\rho_B)$ and $g_\\omega(\\rho_B)$ are density-dependent coupling functions, $\\rho_B$ is the baryon density, and $\\rho_S$ is the scalar density.\n\n- The self-energies entering the Dirac equation are\n$$\\Sigma_S = g_\\sigma(\\rho_B) \\, \\phi_\\sigma,$$\n$$\\Sigma_V = g_\\omega(\\rho_B) \\, V_0 + \\Sigma_R,$$\nwhere $\\Sigma_R$ is the rearrangement contribution required by thermodynamic consistency for density-dependent couplings. In uniform, isospin-symmetric matter, a standard expression is\n$$\\Sigma_R = \\frac{\\partial g_\\sigma}{\\partial \\rho_B} \\, \\phi_\\sigma \\, \\rho_S + \\frac{\\partial g_\\omega}{\\partial \\rho_B} \\, V_0 \\, \\rho_B.$$\n\n- The effective Dirac mass is\n$$M^* = M - \\Sigma_S.$$\n\n- For isospin-symmetric matter (two spin states and two isospin states), the baryon density relates to the Fermi momentum by\n$$\\rho_B = \\frac{2 k_F^3}{3 \\pi^2}, \\qquad \\text{so} \\qquad k_F = \\left(\\frac{3 \\pi^2}{2} \\rho_B\\right)^{1/3}.$$\n\n- The scalar density at zero temperature is\n$$\\rho_S = \\frac{M^*}{\\pi^2}\\left[k_F E_F^* - (M^*)^2 \\ln\\left(\\frac{k_F + E_F^*}{M^*}\\right)\\right], \\qquad E_F^* = \\sqrt{k_F^2 + (M^*)^2},$$\nwhich follows directly from the definition $\\rho_S = \\frac{4}{(2\\pi)^3} \\int_{|\\mathbf{k}|\\le k_F} d^3k \\, \\frac{M^*}{\\sqrt{k^2+(M^*)^2}}$.\n\nUnit handling must be consistent and explicit. Use natural units with $\\hbar = c = 1$, but express final energies in megaelectronvolts (MeV) and densities in inverse cubic femtometers ($\\mathrm{fm}^{-3}$). The conversion constant is $(\\hbar c) = 197.3269804 \\, \\mathrm{MeV} \\cdot \\mathrm{fm}$. In the numerical implementation, treat momenta and masses in inverse femtometers ($\\mathrm{fm}^{-1}$) for the integrals, and convert final self-energies and effective masses to megaelectronvolts (MeV) for output.\n\nDensity-dependent couplings to be implemented are specified by\n$$g_i(\\rho_B) = g_{i0} \\, \\exp\\!\\left[-a_i \\left(\\frac{\\rho_B}{\\rho_0} - 1\\right)\\right], \\qquad i \\in \\{\\sigma,\\omega\\},$$\nwith derivatives\n$$\\frac{\\partial g_i}{\\partial \\rho_B} = -\\frac{a_i}{\\rho_0} \\, g_i(\\rho_B).$$\n\nImplement a self-consistent fixed-point iteration for $M^*$ at fixed $\\rho_B$:\n1. Initialize $M^*$ to $M$.\n2. Given $M^*$, compute $k_F$, then $\\rho_S$, then $\\phi_\\sigma$ and $V_0$, then $\\Sigma_S$ and $\\Sigma_V$, and update $M^* \\leftarrow M - \\Sigma_S$.\n3. Optionally apply linear mixing $M^* \\leftarrow \\lambda M^*_{\\text{new}} + (1-\\lambda) M^*_{\\text{old}}$ for a chosen $0 \\le \\lambda \\le 1$ to enhance convergence.\n4. Repeat until convergence.\n\nConvergence must be decided using physically motivated criteria based on changes in the self-energies. Specifically, stop when both\n$$|\\Delta \\Sigma_S| < \\epsilon_S, \\qquad |\\Delta \\Sigma_V| < \\epsilon_V,$$\nwhere $\\Delta$ denotes the change between two successive iterations and $\\epsilon_S$ and $\\epsilon_V$ are user-specified tolerances in megaelectronvolts (MeV). Impose a maximum number of iterations to avoid infinite loops, and ensure $M^*$ remains strictly positive during iteration.\n\nUse the following physical constants in megaelectronvolts (MeV): $M = 939.0$, $m_\\sigma = 550.0$, $m_\\omega = 783.0$. Convert these to inverse femtometers ($\\mathrm{fm}^{-1}$) internally using $(\\hbar c)$ as specified above.\n\nYour program must solve the problem for the test suite below, producing results for each case as a list containing four entries: the converged effective mass $M^*$ in megaelectronvolts (MeV), the converged scalar self-energy $\\Sigma_S$ in megaelectronvolts (MeV), the converged vector self-energy $\\Sigma_V$ in megaelectronvolts (MeV), and the integer number of iterations taken. Round all reported energies to six decimal places. The final output must be a single line containing a list of these per-case lists, with no additional text.\n\nTest suite parameter sets (each case specifies $(\\rho_B, \\rho_0, g_{\\sigma 0}, a_\\sigma, g_{\\omega 0}, a_\\omega, \\epsilon_S, \\epsilon_V, \\lambda, N_{\\max})$):\n- Case 1 (typical saturation density, decreasing couplings): $\\rho_B = 0.16 \\, \\mathrm{fm}^{-3}$, $\\rho_0 = 0.16 \\, \\mathrm{fm}^{-3}$, $g_{\\sigma 0} = 10.0$, $a_\\sigma = 0.30$, $g_{\\omega 0} = 12.0$, $a_\\omega = 0.15$, $\\epsilon_S = 1 \\times 10^{-6} \\, \\mathrm{MeV}$, $\\epsilon_V = 1 \\times 10^{-6} \\, \\mathrm{MeV}$, $\\lambda = 0.6$, $N_{\\max} = 300$.\n- Case 2 (very low density boundary): $\\rho_B = 1.0 \\times 10^{-6} \\, \\mathrm{fm}^{-3}$, $\\rho_0 = 0.16 \\, \\mathrm{fm}^{-3}$, $g_{\\sigma 0} = 10.0$, $a_\\sigma = 0.30$, $g_{\\omega 0} = 12.0$, $a_\\omega = 0.15$, $\\epsilon_S = 1 \\times 10^{-8} \\, \\mathrm{MeV}$, $\\epsilon_V = 1 \\times 10^{-8} \\, \\mathrm{MeV}$, $\\lambda = 0.8$, $N_{\\max} = 300$.\n- Case 3 (high density, three times saturation): $\\rho_B = 0.48 \\, \\mathrm{fm}^{-3}$, $\\rho_0 = 0.16 \\, \\mathrm{fm}^{-3}$, $g_{\\sigma 0} = 10.0$, $a_\\sigma = 0.30$, $g_{\\omega 0} = 12.0$, $a_\\omega = 0.15$, $\\epsilon_S = 1 \\times 10^{-6} \\, \\mathrm{MeV}$, $\\epsilon_V = 1 \\times 10^{-6} \\, \\mathrm{MeV}$, $\\lambda = 0.5$, $N_{\\max} = 500$.\n- Case 4 (moderate density with increasing couplings): $\\rho_B = 0.32 \\, \\mathrm{fm}^{-3}$, $\\rho_0 = 0.16 \\, \\mathrm{fm}^{-3}$, $g_{\\sigma 0} = 9.5$, $a_\\sigma = -0.05$, $g_{\\omega 0} = 11.0$, $a_\\omega = -0.02$, $\\epsilon_S = 1 \\times 10^{-6} \\, \\mathrm{MeV}$, $\\epsilon_V = 1 \\times 10^{-6} \\, \\mathrm{MeV}$, $\\lambda = 0.7$, $N_{\\max} = 400$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of per-case lists, enclosed in square brackets. For example, the format must be\n$$[\\,[M^*_1,\\Sigma_{S,1},\\Sigma_{V,1},N_1],\\,[M^*_2,\\Sigma_{S,2},\\Sigma_{V,2},N_2],\\,\\ldots\\,],$$\nwith all $M^*_i$, $\\Sigma_{S,i}$, and $\\Sigma_{V,i}$ in megaelectronvolts (MeV) rounded to six decimal places, and $N_i$ integers.", "solution": "The task is to construct a self-consistent solution of the Dirac and meson mean-field equations for uniform isospin-symmetric nuclear matter with density-dependent couplings. The foundation is the Relativistic Mean Field (RMF) model derived from Quantum Hadrodynamics (QHD). The nucleon experiences scalar and vector mean fields from the exchange of a scalar meson (commonly denoted by the Greek letter sigma) and a vector meson (commonly denoted by the lowercase Greek letter omega). The mean-field approximation replaces the meson fields by their ground-state expectation values, which are constant in uniform matter. We detail the steps to design the algorithm from first principles.\n\n1. Fundamental setup and units:\n   The starting Dirac equation in the mean-field is\n   $$\\left[\\gamma^\\mu \\left(i \\partial_\\mu - \\Sigma_V \\delta_{\\mu 0}\\right) - \\left(M - \\Sigma_S\\right)\\right] \\psi = 0.$$\n   Here $M$ is the free nucleon mass, $\\Sigma_S$ is the scalar self-energy, and $\\Sigma_V$ is the time-like vector self-energy. The mean-field meson equations are\n   $$m_\\sigma^2 \\, \\phi_\\sigma = g_\\sigma(\\rho_B) \\, \\rho_S, \\qquad m_\\omega^2 \\, V_0 = g_\\omega(\\rho_B) \\, \\rho_B,$$\n   with $g_\\sigma(\\rho_B)$ and $g_\\omega(\\rho_B)$ the density-dependent meson-nucleon couplings. The self-energies are\n   $$\\Sigma_S = g_\\sigma(\\rho_B) \\, \\phi_\\sigma, \\qquad \\Sigma_V = g_\\omega(\\rho_B) \\, V_0 + \\Sigma_R,$$\n   with the rearrangement term\n   $$\\Sigma_R = \\frac{\\partial g_\\sigma}{\\partial \\rho_B} \\, \\phi_\\sigma \\, \\rho_S + \\frac{\\partial g_\\omega}{\\partial \\rho_B} \\, V_0 \\, \\rho_B.$$\n   The rearrangement term arises from the functional dependence of the couplings on density and is required to ensure energy-momentum conservation and thermodynamic consistency.\n\n   All computations will be carried out in natural units with $\\hbar = c = 1$ internally (which is convenient for field theory), but inputs and outputs will be translated to and from the common nuclear physics units using $(\\hbar c) = 197.3269804 \\, \\mathrm{MeV} \\cdot \\mathrm{fm}$. Specifically:\n   - Densities $\\rho_B$ and $\\rho_S$ are in $\\mathrm{fm}^{-3}$.\n   - Momenta and masses inside integrals are in $\\mathrm{fm}^{-1}$.\n   - Self-energies and effective masses reported are converted to megaelectronvolts (MeV) at the end by multiplying $\\mathrm{fm}^{-1}$ values by $(\\hbar c)$.\n\n   The free nucleon mass and meson masses are taken as\n   $$M = 939.0 \\, \\mathrm{MeV}, \\qquad m_\\sigma = 550.0 \\, \\mathrm{MeV}, \\qquad m_\\omega = 783.0 \\, \\mathrm{MeV}.$$\n   Internally we use\n   $$M_{\\mathrm{fm}} = \\frac{M}{\\hbar c}, \\qquad m_{\\sigma,\\mathrm{fm}} = \\frac{m_\\sigma}{\\hbar c}, \\qquad m_{\\omega,\\mathrm{fm}} = \\frac{m_\\omega}{\\hbar c},$$\n   in units of $\\mathrm{fm}^{-1}$.\n\n2. Density-dependent couplings:\n   We are given\n   $$g_i(\\rho_B) = g_{i0} \\, \\exp\\!\\left[-a_i \\left(\\frac{\\rho_B}{\\rho_0} - 1\\right)\\right], \\qquad i \\in \\{\\sigma,\\omega\\},$$\n   and thus\n   $$\\frac{\\partial g_i}{\\partial \\rho_B} = -\\frac{a_i}{\\rho_0} \\, g_i(\\rho_B).$$\n   These functions are dimensionless and monotonic depending on the sign of $a_i$. The chosen forms are standard in density-dependent RMF parametrizations.\n\n3. Fermi momentum and densities:\n   For isospin-symmetric matter with two spin states and two isospin states (protons and neutrons), the total baryon density relates to the Fermi momentum by\n   $$\\rho_B = \\frac{2 k_F^3}{3 \\pi^2} \\quad \\Rightarrow \\quad k_F = \\left(\\frac{3 \\pi^2}{2} \\rho_B\\right)^{1/3},$$\n   with $k_F$ in $\\mathrm{fm}^{-1}$.\n\n   The scalar density at zero temperature is\n   $$\\rho_S = \\frac{4}{(2\\pi)^3} \\int_{|\\mathbf{k}|\\le k_F} d^3k \\, \\frac{M^*}{\\sqrt{k^2+(M^*)^2}}.$$\n   Spherical integration using $d^3k = 4\\pi k^2 \\, dk$ and the degeneracy factor $\\gamma = 4$ gives\n   $$\\rho_S = \\frac{\\gamma}{(2\\pi)^3} 4\\pi \\int_0^{k_F} dk \\, k^2 \\frac{M^*}{\\sqrt{k^2+(M^*)^2}} = \\frac{\\gamma}{2\\pi^2} \\int_0^{k_F} dk \\, k^2 \\frac{M^*}{\\sqrt{k^2+(M^*)^2}}.$$\n   With $\\gamma = 4$, we obtain the well-known closed form\n   $$\\rho_S = \\frac{M^*}{\\pi^2}\\left[k_F E_F^* - (M^*)^2 \\ln\\left(\\frac{k_F + E_F^*}{M^*}\\right)\\right], \\qquad E_F^* = \\sqrt{k_F^2 + (M^*)^2},$$\n   which we will use to avoid numerical quadrature and to ensure both efficiency and accuracy. All quantities in this expression are in $\\mathrm{fm}^{-1}$, and the resulting density is in $\\mathrm{fm}^{-3}$.\n\n4. Meson fields and self-energies:\n   Given $\\rho_S$ and $\\rho_B$, we solve the meson field equations algebraically in the mean-field:\n   $$\\phi_\\sigma = \\frac{g_\\sigma(\\rho_B)}{m_{\\sigma,\\mathrm{fm}}^2} \\, \\rho_S, \\qquad V_0 = \\frac{g_\\omega(\\rho_B)}{m_{\\omega,\\mathrm{fm}}^2} \\, \\rho_B.$$\n   The self-energies in $\\mathrm{fm}^{-1}$ are then\n   $$\\Sigma_S = g_\\sigma(\\rho_B) \\, \\phi_\\sigma = \\frac{g_\\sigma(\\rho_B)^2}{m_{\\sigma,\\mathrm{fm}}^2} \\, \\rho_S,$$\n   $$\\Sigma_R = \\left(-\\frac{a_\\sigma}{\\rho_0} g_\\sigma\\right) \\phi_\\sigma \\rho_S + \\left(-\\frac{a_\\omega}{\\rho_0} g_\\omega\\right) V_0 \\rho_B,$$\n   $$\\Sigma_V = g_\\omega(\\rho_B) \\, V_0 + \\Sigma_R = \\frac{g_\\omega(\\rho_B)^2}{m_{\\omega,\\mathrm{fm}}^2} \\, \\rho_B + \\Sigma_R.$$\n   Finally, the effective mass is updated by\n   $$M^* = M_{\\mathrm{fm}} - \\Sigma_S.$$\n   We take care to keep $M^* > 0$ to avoid numerical issues in $E_F^*$, imposing a small positive lower bound if necessary for stability (in practice, the chosen physical parameters keep $M^*$ well above zero).\n\n5. Fixed-point iteration and convergence:\n   The fixed-point map for $M^*$ at fixed $\\rho_B$ is\n   $$\\mathcal{F}[M^*] = M_{\\mathrm{fm}} - \\frac{g_\\sigma(\\rho_B)^2}{m_{\\sigma,\\mathrm{fm}}^2} \\, \\rho_S(M^*),$$\n   where $\\rho_S(M^*)$ is the known monotonic function given above. We iterate\n   $$M^*_{n+1} = \\mathcal{F}[M^*_n],$$\n   with optional linear mixing\n   $$M^*_{n+1} \\leftarrow \\lambda M^*_{n+1} + (1-\\lambda) M^*_n,$$\n   where $0 \\le \\lambda \\le 1$ controls damping to enhance convergence. At each step we compute $\\Sigma_S$ and $\\Sigma_V$ (both in $\\mathrm{fm}^{-1}$), and convert them to megaelectronvolts (MeV) by multiplying $(\\hbar c)$ for monitoring convergence. We stop when both\n   $$|\\Delta \\Sigma_S| < \\epsilon_S, \\qquad |\\Delta \\Sigma_V| < \\epsilon_V,$$\n   with $\\epsilon_S$ and $\\epsilon_V$ specified in MeV. A maximum iteration count $N_{\\max}$ is enforced. This criterion is physically motivated because the Dirac equation depends on $\\Sigma_S$ and $\\Sigma_V$, so convergence in these quantities ensures self-consistency of the fields and the single-particle spectrum.\n\n6. Algorithmic steps:\n   - Convert $M$, $m_\\sigma$, $m_\\omega$ to $\\mathrm{fm}^{-1}$ via division by $(\\hbar c)$.\n   - For each test case, compute $k_F$ from $\\rho_B$ using $k_F = \\left(\\frac{3 \\pi^2}{2} \\rho_B\\right)^{1/3}$.\n   - Initialize $M^* \\leftarrow M_{\\mathrm{fm}}$.\n   - Loop:\n     - Compute $g_\\sigma(\\rho_B)$ and $g_\\omega(\\rho_B)$, and their derivatives.\n     - Compute $\\rho_S(M^*)$ from the closed form.\n     - Compute $\\phi_\\sigma$ and $V_0$.\n     - Compute $\\Sigma_S$ and $\\Sigma_V$ in $\\mathrm{fm}^{-1}$; convert to MeV for convergence checks.\n     - Update $M^*_{\\text{new}} = M_{\\mathrm{fm}} - \\Sigma_S$, apply mixing, and protect positivity.\n     - Check $|\\Delta \\Sigma_S|$ and $|\\Delta \\Sigma_V|$ against tolerances; break if both are below.\n     - Repeat until convergence or reaching $N_{\\max}$.\n   - Report $M^*$ and self-energies in MeV, rounded to six decimals, along with the iteration count.\n\n7. Edge cases and coverage:\n   - At very low density ($\\rho_B \\to 0$), $k_F \\to 0$, so $\\rho_S \\to 0$ and $\\Sigma_S, \\Sigma_V \\to 0$, thus $M^* \\to M$ and convergence is immediate; the algorithm handles the logarithm via the closed form smoothly ($\\ln(1)=0$).\n   - At high density, monotonicity of $\\rho_S(M^*)$ and damping via mixing ensure convergence.\n   - Changing signs of $a_\\sigma$ and $a_\\omega$ tests non-decreasing couplings and the rearrangement contribution; the convergence criterion based on $\\Sigma_S$ and $\\Sigma_V$ remains applicable.\n\n8. Output specification:\n   The program prints a single line with a list of per-case lists\n   $$[\\,[M^*_1,\\Sigma_{S,1},\\Sigma_{V,1},N_1],\\,[M^*_2,\\Sigma_{S,2},\\Sigma_{V,2},N_2],\\,\\ldots\\,],$$\n   where $M^*_i$, $\\Sigma_{S,i}$, and $\\Sigma_{V,i}$ are in megaelectronvolts (MeV), rounded to six decimal places, and $N_i$ is the integer iteration count.\n\nThis design rigorously follows from the RMF framework with density-dependent couplings, implements a principled fixed-point iteration using physically meaningful convergence metrics ($\\Sigma_S$ and $\\Sigma_V$), and respects unit consistency essential for computational nuclear physics.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants and conversions\nHC_MEGAEV_FM = 197.3269804  # (hbar c) in MeV*fm\n\n# Nucleon and meson masses in MeV\nM_NUCL_MEVE = 939.0\nM_SIGMA_MEVE = 550.0\nM_OMEGA_MEVE = 783.0\n\n# Convert masses to fm^{-1} for internal calculations\nM_NUCL_FM = M_NUCL_MEVE / HC_MEGAEV_FM\nM_SIGMA_FM = M_SIGMA_MEVE / HC_MEGAEV_FM\nM_OMEGA_FM = M_OMEGA_MEVE / HC_MEGAEV_FM\n\ndef kF_from_rhoB(rhoB):\n    \"\"\"\n    Compute Fermi momentum k_F from baryon density rho_B for isospin-symmetric matter.\n    rhoB: baryon density in fm^{-3}\n    Returns k_F in fm^{-1}\n    \"\"\"\n    return (1.5 * (np.pi**2) * rhoB) ** (1.0 / 3.0)\n\ndef g_density_dependent(rhoB, g0, a, rho0):\n    \"\"\"\n    Density-dependent coupling g(rho) = g0 * exp(-a (rho/rho0 - 1))\n    and its derivative dg/drho = -(a/rho0) * g(rho)\n    \"\"\"\n    g = g0 * np.exp(-a * (rhoB / rho0 - 1.0))\n    dg_drho = -(a / rho0) * g\n    return g, dg_drho\n\ndef rhoS_closed_form(Mstar_fm, kF):\n    \"\"\"\n    Scalar density in fm^{-3} using the closed form:\n    rho_S = (M*/pi^2) [ k_F E_F* - M*^2 ln( (k_F + E_F*) / M* ) ]\n    with E_F* = sqrt(k_F^2 + M*^2)\n    All inputs in fm^{-1}, output in fm^{-3}.\n    \"\"\"\n    # Guard against non-physical negative or zero Mstar\n    Mstar_fm = max(Mstar_fm, 1e-12)\n    EFstar = np.sqrt(kF * kF + Mstar_fm * Mstar_fm)\n    # Handle very small kF to avoid numerical issues\n    if kF < 1e-12:\n        return 0.0\n    term_log = np.log((kF + EFstar) / Mstar_fm)\n    rhoS = (Mstar_fm / (np.pi**2)) * (kF * EFstar - (Mstar_fm**2) * term_log)\n    return rhoS\n\ndef self_consistent_iteration(rhoB, rho0, gsig0, asig, gom0, aom, epsS_MeV, epsV_MeV, mix, max_iter):\n    \"\"\"\n    Perform fixed-point iteration to solve for M* and the self-energies.\n    Inputs:\n      - rhoB: baryon density in fm^{-3}\n      - rho0: reference density in fm^{-3}\n      - gsig0, asig: sigma coupling parameters\n      - gom0, aom: omega coupling parameters\n      - epsS_MeV, epsV_MeV: convergence tolerances in MeV\n      - mix: linear mixing parameter in [0,1]\n      - max_iter: maximum iterations\n    Returns:\n      - Mstar_MeV, SigmaS_MeV, SigmaV_MeV, iterations\n    \"\"\"\n    # Fermi momentum\n    kF = kF_from_rhoB(rhoB)\n    # Initialize effective mass in fm^{-1}\n    Mstar = M_NUCL_FM\n\n    # Previous self-energies for convergence tracking (in fm^{-1})\n    prev_SigmaS_fm = None\n    prev_SigmaV_fm = None\n\n    iterations = 0\n    for it in range(1, max_iter + 1):\n        iterations = it\n        # Couplings and derivatives at current rhoB\n        gsig, dgsig_drho = g_density_dependent(rhoB, gsig0, asig, rho0)\n        gom, dgom_drho = g_density_dependent(rhoB, gom0, aom, rho0)\n\n        # Scalar density in fm^{-3}\n        rhoS = rhoS_closed_form(Mstar, kF)\n\n        # Meson fields in fm^{-1}\n        phi_sigma = (gsig / (M_SIGMA_FM**2)) * rhoS\n        V0 = (gom / (M_OMEGA_FM**2)) * rhoB\n\n        # Self-energies in fm^{-1}\n        SigmaS_fm = gsig * phi_sigma  # = gsig^2/m_sigma^2 * rhoS\n        # Rearrangement contribution in fm^{-1}\n        SigmaR_fm = (dgsig_drho * phi_sigma * rhoS) + (dgom_drho * V0 * rhoB)\n        SigmaV_fm = (gom * V0) + SigmaR_fm  # = g_omega^2/m_omega^2 * rhoB + SigmaR\n\n        # Update M* with optional mixing; ensure positivity\n        Mstar_new = M_NUCL_FM - SigmaS_fm\n        Mstar = mix * Mstar_new + (1.0 - mix) * Mstar\n        if Mstar <= 0.0:\n            # Protect against numerical issues; clamp to small positive\n            Mstar = 1e-12\n\n        # Check convergence in MeV\n        if prev_SigmaS_fm is not None and prev_SigmaV_fm is not None:\n            deltaS_MeV = abs((SigmaS_fm - prev_SigmaS_fm) * HC_MEGAEV_FM)\n            deltaV_MeV = abs((SigmaV_fm - prev_SigmaV_fm) * HC_MEGAEV_FM)\n            if (deltaS_MeV < epsS_MeV) and (deltaV_MeV < epsV_MeV):\n                # Converged\n                prev_SigmaS_fm = SigmaS_fm\n                prev_SigmaV_fm = SigmaV_fm\n                break\n\n        prev_SigmaS_fm = SigmaS_fm\n        prev_SigmaV_fm = SigmaV_fm\n\n    # Convert outputs to MeV\n    Mstar_MeV = Mstar * HC_MEGAEV_FM\n    SigmaS_MeV = prev_SigmaS_fm * HC_MEGAEV_FM if prev_SigmaS_fm is not None else 0.0\n    SigmaV_MeV = prev_SigmaV_fm * HC_MEGAEV_FM if prev_SigmaV_fm is not None else 0.0\n\n    # Round energies to six decimals\n    Mstar_MeV = float(np.round(Mstar_MeV, 6))\n    SigmaS_MeV = float(np.round(SigmaS_MeV, 6))\n    SigmaV_MeV = float(np.round(SigmaV_MeV, 6))\n\n    return Mstar_MeV, SigmaS_MeV, SigmaV_MeV, iterations\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (rhoB, rho0, gsig0, asig, gom0, aom, epsS_MeV, epsV_MeV, mix, max_iter)\n    test_cases = [\n        (0.16, 0.16, 10.0, 0.30, 12.0, 0.15, 1e-6, 1e-6, 0.6, 300),\n        (1.0e-6, 0.16, 10.0, 0.30, 12.0, 0.15, 1e-8, 1e-8, 0.8, 300),\n        (0.48, 0.16, 10.0, 0.30, 12.0, 0.15, 1e-6, 1e-6, 0.5, 500),\n        (0.32, 0.16, 9.5, -0.05, 11.0, -0.02, 1e-6, 1e-6, 0.7, 400),\n    ]\n\n    results = []\n    for case in test_cases:\n        rhoB, rho0, gsig0, asig, gom0, aom, epsS, epsV, mix, max_iter = case\n        Mstar_MeV, SigmaS_MeV, SigmaV_MeV, iterations = self_consistent_iteration(\n            rhoB, rho0, gsig0, asig, gom0, aom, epsS, epsV, mix, max_iter\n        )\n        results.append([Mstar_MeV, SigmaS_MeV, SigmaV_MeV, iterations])\n\n    # Final print statement in the exact required format.\n    # Ensure the output is a single line with the list of lists.\n    print(f\"[{','.join(str(item) for item in results)}]\")\n\nsolve()\n```", "id": "3555086"}, {"introduction": "A powerful test of any nuclear model is its ability to explain experimental observations across the nuclear chart. This practice challenges you to connect the abstract concept of the infinite nuclear matter equation of state to the measured energies of the Giant Monopole Resonance (GMR) in finite nuclei [@problem_id:3555094]. Using the Local Density Approximation as a bridge, you will perform a data-driven analysis to extract fundamental parameters like the incompressibility $K_{\\infty}$ and assess how different assumptions for the density dependence affect predictions for an entire isotopic chain.", "problem": "You are given a set of isotopes in the tin chain $^{112}\\mathrm{Sn}$ to $^{124}\\mathrm{Sn}$ and the lead isotope $^{208}\\mathrm{Pb}$, together with representative isoscalar Giant Monopole Resonance (GMR) energies. The goal is to extract the saturation incompressibility $K_{\\infty}$ of nuclear matter from Random Phase Approximation (RPA) scaling arguments and quantify how different density dependences in a density-dependent meson-exchange description control the isotopic trend of the GMR energy $E_{\\mathrm{GMR}}$.\n\nFundamental base to be used:\n- The Random Phase Approximation (RPA) energy-weighted sum rules connect the collective breathing mode to the compressional response of the finite nucleus.\n- The finite-nucleus incompressibility $K_A$ arises from the local-density response, and the isotopic trend is controlled by the isoscalar and isovector (asymmetry) components of the equation of state.\n- In the local density approximation, spatial integrals are constructed from a physically plausible density profile and a normalized weight that reflects a compressional strain field.\n\nYou must implement the following physically sound and self-consistent model ingredients:\n1. Density profile: Use a two-parameter Fermi (2pF) form for the nucleon density,\n   $$\\rho(r) = \\frac{\\rho_c}{1 + \\exp\\!\\left(\\frac{r-c}{a}\\right)},$$\n   with half-density radius $c = r_0 A^{1/3}$ and diffuseness $a = 0.55\\,\\mathrm{fm}$ for all nuclei, and $r_0 = 1.2\\,\\mathrm{fm}$. The central density parameter $\\rho_c$ must be chosen to satisfy the normalization condition\n   $$4\\pi\\int_{0}^{\\infty} r^2 \\rho(r)\\,dr = A,$$\n   for each nucleus with mass number $A$. The saturation density is a fixed constant $\\rho_{\\mathrm{sat}} = 0.16\\,\\mathrm{fm}^{-3}$, and must not be altered by the normalization of $\\rho(r)$.\n\n2. Asymmetry:\n   $$\\delta = \\frac{N - Z}{A},$$\n   with $A$ the mass number, $Z$ the proton number, and $N$ the neutron number of the nucleus.\n\n3. Density-dependent incompressibility in a Density-Dependent Meson-Exchange (DD-ME) style ansatz:\n   $$K(\\rho,\\delta) = K_s(\\rho) - K_{\\mathrm{asy}}(\\rho)\\,\\delta^2,$$\n   with isoscalar part\n   $$K_s(\\rho) = K_{\\infty} + C_1\\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1\\right) + C_2\\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1\\right)^2,$$\n   and isovector asymmetry reduction\n   $$K_{\\mathrm{asy}}(\\rho) = K_{\\tau,0}\\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}}\\right)^{\\eta}.$$\n   Here, $K_{\\infty}$ and $K_{\\tau,0}$ are parameters to be extracted from the data for each specified density dependence, while $C_1$, $C_2$, and $\\eta$ define the density dependence and are specified below.\n\n4. Finite-nucleus averaging in the local-density approximation:\n   Implement the normalized compressional weight\n   $$w(r) \\propto r^2 \\rho(r),$$\n   with the normalization fixed by the integral over the volume element $d^3r = 4\\pi r^2 dr$. Use this to define a weighted average for any function $g(\\rho)$ as\n   $$\\langle g(\\rho)\\rangle = \\frac{4\\pi\\int_{0}^{\\infty} r^4 \\rho(r)\\,g(\\rho(r))\\,dr}{4\\pi\\int_{0}^{\\infty} r^4 \\rho(r)\\,dr},$$\n   and the mean-square radius\n   $$\\langle r^2 \\rangle = \\frac{4\\pi\\int_{0}^{\\infty} r^4 \\rho(r)\\,dr}{A}.$$\n\n5. Link to the Giant Monopole Resonance:\n   Use the scaling relation between the isoscalar Giant Monopole Resonance energy $E_{\\mathrm{GMR}}$ and the finite-nucleus incompressibility $K_A$ that follows from the RPA energy-weighted sum rules and the compressional mode scaling. Your program should first invert the measured $E_{\\mathrm{GMR}}$ to obtain $K_A$ per nucleus, and then use the local-density model above to regressively extract $K_{\\infty}$ and $K_{\\tau,0}$ for a given density dependence. All energies must be expressed in $\\mathrm{MeV}$, all lengths in $\\mathrm{fm}$, and you must adopt natural units with $c=1$.\n\nRPA test suite and data:\n- Physical constants to use:\n  - Reduced Planck constant times speed of light: $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$,\n  - Nucleon mass: $m = 938.918\\,\\mathrm{MeV}$.\n- Isotopes and representative GMR energies (in $\\mathrm{MeV}$):\n  - $^{112}\\mathrm{Sn}$: $A=112$, $Z=50$, $E_{\\mathrm{GMR}}=16.1$,\n  - $^{114}\\mathrm{Sn}$: $A=114$, $Z=50$, $E_{\\mathrm{GMR}}=15.9$,\n  - $^{116}\\mathrm{Sn}$: $A=116$, $Z=50$, $E_{\\mathrm{GMR}}=15.7$,\n  - $^{118}\\mathrm{Sn}$: $A=118$, $Z=50$, $E_{\\mathrm{GMR}}=15.6$,\n  - $^{120}\\mathrm{Sn}$: $A=120$, $Z=50$, $E_{\\mathrm{GMR}}=15.5$,\n  - $^{122}\\mathrm{Sn}$: $A=122$, $Z=50$, $E_{\\mathrm{GMR}}=15.4$,\n  - $^{124}\\mathrm{Sn}$: $A=124$, $Z=50$, $E_{\\mathrm{GMR}}=15.3$,\n  - $^{208}\\mathrm{Pb}$: $A=208$, $Z=82$, $E_{\\mathrm{GMR}}=13.9$.\n- Density dependence scenarios to test (each defines a parameter set $\\{C_1, C_2, \\eta\\}$):\n  1. Soft: $C_1=-100\\,\\mathrm{MeV}$, $C_2=+50\\,\\mathrm{MeV}$, $\\eta=0.7$,\n  2. Moderate: $C_1=-50\\,\\mathrm{MeV}$, $C_2=+30\\,\\mathrm{MeV}$, $\\eta=0.6$,\n  3. Stiff: $C_1=+50\\,\\mathrm{MeV}$, $C_2=+10\\,\\mathrm{MeV}$, $\\eta=0.5$.\n\nAlgorithmic requirements:\n- For each nucleus, construct $\\rho(r)$ on a radial grid sufficiently large to ensure numerical convergence of all integrals. You must explicitly normalize $\\rho(r)$ to $A$.\n- For each scenario, compute the weighted averages $\\langle (\\rho/\\rho_{\\mathrm{sat}} - 1) \\rangle$, $\\langle (\\rho/\\rho_{\\mathrm{sat}} - 1)^2 \\rangle$, and $\\langle (\\rho/\\rho_{\\mathrm{sat}})^{\\eta} \\rangle$ for each nucleus. Using the inverted $K_A$ obtained from the measured $E_{\\mathrm{GMR}}$, perform a linear least-squares extraction of $K_{\\infty}$ and $K_{\\tau,0}$ across the full isotope set.\n- With the extracted parameters, compute the model-predicted $E_{\\mathrm{GMR}}$ for each nucleus and the root-mean-square deviation over the eight nuclei (expressed in $\\mathrm{MeV}$).\n\nFinal output format:\n- Your program should produce a single line of output containing a comma-separated Python list in the form\n  $$[K_{\\infty}^{\\mathrm{soft}},K_{\\infty}^{\\mathrm{moderate}},K_{\\infty}^{\\mathrm{stiff}},\\mathrm{RMS}_{\\mathrm{soft}},\\mathrm{RMS}_{\\mathrm{moderate}},\\mathrm{RMS}_{\\mathrm{stiff}},\\mathrm{best\\_index}],$$\n  where $K_{\\infty}^{\\mathrm{scenario}}$ are in $\\mathrm{MeV}$, $\\mathrm{RMS}_{\\mathrm{scenario}}$ are in $\\mathrm{MeV}$, and $\\mathrm{best\\_index}$ is the integer index $0$ for soft, $1$ for moderate, or $2$ for stiff corresponding to the scenario with the smallest root-mean-square deviation. All quantities must be computed exactly as described above with the specified units.", "solution": "The user has provided a valid, well-posed problem in computational nuclear physics. The task is to determine the nuclear matter incompressibility at saturation, $K_{\\infty}$, and the asymmetry incompressibility parameter, $K_{\\tau,0}$, by fitting a theoretical model to experimental Giant Monopole Resonance (GMR) energies for a set of tin and lead isotopes. The procedure involves a multi-step, principle-based approach rooted in the Local Density Approximation (LDA) and Random Phase Approximation (RPA) sum rules.\n\nThe solution proceeds in four main stages:\n1.  **Inversion of Experimental Data**: The experimental GMR energy, $E_{\\mathrm{GMR}}$, for each nucleus is used to determine its finite-nucleus incompressibility, $K_A$.\n2.  **Theoretical Modeling**: A theoretical expression for $K_A$ is constructed based on a density-dependent meson-exchange (DD-ME) style ansatz for the incompressibility of nuclear matter, $K(\\rho, \\delta)$, and a realistic nucleon density profile, $\\rho(r)$.\n3.  **Parameter Extraction**: By equating the experimental and theoretical values of $K_A$ across the set of isotopes, a system of linear equations is formed. A least-squares regression is performed to extract the fundamental parameters $K_{\\infty}$ and $K_{\\tau,0}$ for three different density-dependence scenarios.\n4.  **Model Evaluation**: The quality of each scenario's fit is quantified by calculating the root-mean-square (RMS) deviation between the model-predicted GMR energies and the experimental data.\n\n**1. From Observable to Nuclear Incompressibility ($E_{\\mathrm{GMR}} \\rightarrow K_A$)**\n\nThe Isoscalar Giant Monopole Resonance (GMR) is the fundamental compressional \"breathing\" mode of a nucleus. Within the framework of RPA energy-weighted sum rules, the energy of this collective excitation, $E_{\\mathrm{GMR}}$, is related to the incompressibility of the finite nucleus, $K_A$, through the scaling relation:\n$$E_{\\mathrm{GMR}} = \\sqrt{\\frac{\\hbar^2 K_A}{m \\langle r^2 \\rangle}}$$\nwhere $m$ is the nucleon mass and $\\langle r^2 \\rangle$ is the mean-square matter radius of the nucleus. The values for the physical constants are given as $mc^2 = 938.918\\,\\mathrm{MeV}$ and $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$. This relation can be inverted to obtain an \"experimental\" value of $K_A$ for each nucleus, provided $\\langle r^2 \\rangle$ is known:\n$$K_A = \\frac{(mc^2) \\langle r^2 \\rangle E_{\\mathrm{GMR}}^2}{(\\hbar c)^2}$$\nThe mean-square radius $\\langle r^2 \\rangle$ must be calculated from the nuclear density distribution.\n\n**2. Theoretical Model for Finite-Nucleus Incompressibility**\n\nThe theoretical model for $K_A$ is built upon the Local Density Approximation, which treats the nucleus as a non-uniform system whose properties at a point $r$ are determined by the local nucleon density $\\rho(r)$.\n\n**2.1. Nucleon Density Profile**\nThe nucleon density is described by a two-parameter Fermi (2pF) distribution:\n$$\\rho(r) = \\frac{\\rho_c}{1 + \\exp\\left(\\frac{r-c}{a}\\right)}$$\nThe diffuseness is fixed at $a = 0.55\\,\\mathrm{fm}$, and the half-density radius is given by $c = r_0 A^{1/3}$ with $r_0 = 1.2\\,\\mathrm{fm}$ and $A$ being the mass number. The central density $\\rho_c$ is not a free parameter; it is determined for each nucleus by the normalization condition that the total number of nucleons is $A$:\n$$A = 4\\pi\\int_{0}^{\\infty} r^2 \\rho(r)\\,dr = \\rho_c \\left( 4\\pi\\int_{0}^{\\infty} \\frac{r^2}{1 + \\exp\\left(\\frac{r-c}{a}\\right)}\\,dr \\right)$$\nThis integral must be computed numerically for each nucleus to find the correct $\\rho_c$.\n\n**2.2. Averaging Procedure**\nThe finite-nucleus incompressibility $K_A$ represents an average of the infinite nuclear matter incompressibility $K(\\rho, \\delta)$ over the nuclear volume. The average is weighted by a compressional strain field, which in this model is $r^2 \\rho(r)$. For an arbitrary function $g(\\rho)$, its average value is defined as:\n$$\\langle g(\\rho)\\rangle = \\frac{\\int r^2 g(\\rho(r)) \\rho(r) d^3r}{\\int r^2 \\rho(r) d^3r} = \\frac{4\\pi\\int_{0}^{\\infty} r^4 \\rho(r)\\,g(\\rho(r))\\,dr}{4\\pi\\int_{0}^{\\infty} r^4 \\rho(r)\\,dr}$$\nUsing this definition, the mean-square radius is:\n$$\\langle r^2 \\rangle = \\frac{\\int r^2 \\rho(r) d^3r}{\\int \\rho(r) d^3r} = \\frac{4\\pi\\int_{0}^{\\infty} r^4 \\rho(r)\\,dr}{A}$$\n\n**2.3. Density-Dependent Incompressibility Ansatz**\nThe incompressibility of nuclear matter, $K(\\rho, \\delta)$, depends on both the density $\\rho$ and the neutron-proton asymmetry $\\delta = (N-Z)/A$. The provided ansatz is:\n$$K(\\rho,\\delta) = K_s(\\rho) - K_{\\mathrm{asy}}(\\rho)\\,\\delta^2$$\nThe isoscalar part, $K_s(\\rho)$, describes symmetric matter ($\\delta=0$) and is expanded around the saturation density $\\rho_{\\mathrm{sat}} = 0.16\\,\\mathrm{fm}^{-3}$:\n$$K_s(\\rho) = K_{\\infty} + C_1\\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1\\right) + C_2\\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1\\right)^2$$\nThe isovector part, $K_{\\mathrm{asy}}(\\rho)$, captures the reduction in incompressibility for asymmetric matter:\n$$K_{\\mathrm{asy}}(\\rho) = K_{\\tau,0}\\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}}\\right)^{\\eta}$$\nThe parameters to be extracted are $K_\\infty$ (the incompressibility of symmetric nuclear matter at saturation density) and $K_{\\tau,0}$. The parameters $\\{C_1, C_2, \\eta\\}$ define the model's density dependence and are given for three distinct scenarios.\n\n**3. Parameter Extraction via Linear Regression**\n\nThe theoretical finite-nucleus incompressibility is the weighted average of $K(\\rho, \\delta)$:\n$$K_A^{\\text{model}} = \\langle K(\\rho,\\delta) \\rangle = \\langle K_s(\\rho) \\rangle - \\langle K_{\\mathrm{asy}}(\\rho) \\rangle \\delta^2$$\nSince $K_\\infty, K_{\\tau,0}, C_1, C_2$ are constants and $\\delta$ is constant for a given nucleus, we can expand the average:\n$$K_A^{\\text{model}} = K_\\infty + C_1\\left\\langle \\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1 \\right\\rangle + C_2\\left\\langle \\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1\\right)^2 \\right\\rangle - K_{\\tau,0} \\delta^2 \\left\\langle \\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}}\\right)^{\\eta} \\right\\rangle$$\nBy setting the experimental $K_A$ equal to the theoretical $K_A^{\\text{model}}$ for each nucleus $i$, we obtain a system of equations. To solve for $K_\\infty$ and $K_{\\tau,0}$, we rearrange the equation into the standard linear form $Y_i = M X_i + B$:\n$$K_{A,i} - C_1\\left\\langle \\dots \\right\\rangle_{1,i} - C_2\\left\\langle \\dots \\right\\rangle_{2,i} = K_\\infty + K_{\\tau,0} \\left( -\\delta_i^2 \\left\\langle \\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}}\\right)^{\\eta} \\right\\rangle_i \\right)$$\nFor each nucleus $i$, we define:\n-   $Y_i = K_{A,i} - C_1\\left\\langle \\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1 \\right\\rangle_i - C_2\\left\\langle \\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}} - 1\\right)^2 \\right\\rangle_i$\n-   $X_i = -\\delta_i^2 \\left\\langle \\left(\\frac{\\rho}{\\rho_{\\mathrm{sat}}}\\right)^{\\eta} \\right\\rangle_i$\n\nA linear least-squares regression of $Y$ on $X$ over all nuclei yields the intercept $B=K_\\infty$ and the slope $M=K_{\\tau,0}$. This procedure is performed for each of the three scenarios (soft, moderate, stiff).\n\n**4. Model Evaluation and Algorithmic Summary**\n\nThe numerical implementation proceeds as follows:\n1.  A fine radial grid is established to ensure convergence of numerical integrals.\n2.  For each nucleus, the 2pF density profile is normalized to its mass number $A$.\n3.  The mean-square radius $\\langle r^2 \\rangle$ and the \"experimental\" $K_A$ are calculated.\n4.  The necessary averages, $\\langle \\dots \\rangle$, are computed.\n5.  For each of the three scenarios, the regression variables $X_i$ and $Y_i$ are constructed, and a linear fit is performed to extract $K_\\infty$ and $K_{\\tau,0}$.\n6.  Using the fitted parameters, the model-predicted $E_{\\mathrm{GMR}}^{\\text{model}}$ is calculated for each nucleus.\n7.  The root-mean-square (RMS) deviation, $\\mathrm{RMS} = \\sqrt{\\frac{1}{N_{\\text{nuclei}}}\\sum_i (E_{\\mathrm{GMR}, i}^{\\text{model}} - E_{\\mathrm{GMR}, i}^{\\text{exp}})^2}$, is computed for each scenario to quantify its agreement with the data. The scenario with the lowest RMS is identified as the best fit.\n\nThe final output compiles the extracted $K_\\infty$ and the RMS deviation for each scenario, along with an index indicating the best-fitting model.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.linalg import lstsq\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem to extract nuclear matter\n    incompressibility parameters from GMR data.\n    \"\"\"\n    \n    # Physical constants\n    HBARC = 197.3269804  # MeV fm\n    M_NUCLEON = 938.918    # MeV (mc^2)\n    \n    # Model constants\n    RHO_SAT = 0.16  # fm^-3\n    A_DIFF = 0.55   # fm\n    R0 = 1.2        # fm\n\n    # Isotope data: (A, Z, E_GMR in MeV)\n    isotopes_data = [\n        (112, 50, 16.1),\n        (114, 50, 15.9),\n        (116, 50, 15.7),\n        (118, 50, 15.6),\n        (120, 50, 15.5),\n        (122, 50, 15.4),\n        (124, 50, 15.3),\n        (208, 82, 13.9),\n    ]\n\n    # Density dependence scenarios: (C1, C2, eta)\n    scenarios = [\n        (-100.0, 50.0, 0.7),  # Soft\n        (-50.0, 30.0, 0.6),   # Moderate\n        (50.0, 10.0, 0.5),    # Stiff\n    ]\n\n    # Numerical integration grid\n    r = np.linspace(0, 25, 2501) # r in fm, dr = 0.01 fm\n\n    # Pre-calculate nucleus-dependent properties\n    nuclear_properties = []\n    for A, Z, E_gmr_exp in isotopes_data:\n        N = A - Z\n        delta = (N - Z) / A\n        c = R0 * A**(1/3)\n\n        # Unnormalized 2pF density profile\n        rho_unnorm = 1 / (1 + np.exp((r - c) / A_DIFF))\n        \n        # Integrand for normalization: 4*pi*r^2 * rho_unnorm\n        integrand_norm = 4 * np.pi * r**2 * rho_unnorm\n        norm_integral = np.trapz(integrand_norm, r)\n        \n        # Calculate central density rho_c and normalized density rho(r)\n        rho_c = A / norm_integral\n        rho = rho_c * rho_unnorm\n\n        # Calculate denominator for weighted averages: 4*pi*Integral(r^4*rho*dr)\n        integrand_denom_avg = 4 * np.pi * r**4 * rho\n        denom_avg = np.trapz(integrand_denom_avg, r)\n\n        # Calculate mean-square radius <r^2>\n        r_sq_mean = denom_avg / A\n        \n        # Calculate \"experimental\" K_A from GMR energy\n        K_A_exp = (M_NUCLEON * r_sq_mean * E_gmr_exp**2) / (HBARC**2)\n\n        # Calculate scenario-INDEPENDENT averages\n        g1 = (rho / RHO_SAT) - 1\n        g2 = g1**2\n        \n        integrand_g1 = 4 * np.pi * r**4 * rho * g1\n        integrand_g2 = 4 * np.pi * r**4 * rho * g2\n        \n        avg_g1 = np.trapz(integrand_g1, r) / denom_avg\n        avg_g2 = np.trapz(integrand_g2, r) / denom_avg\n\n        nuclear_properties.append({\n            'A': A, 'Z': Z, 'E_gmr_exp': E_gmr_exp, 'r_sq_mean': r_sq_mean,\n            'delta': delta, 'rho': rho, 'denom_avg': denom_avg,\n            'K_A_exp': K_A_exp, 'avg_g1': avg_g1, 'avg_g2': avg_g2,\n        })\n\n    results = []\n    rms_values = []\n\n    # Main loop over scenarios\n    for C1, C2, eta in scenarios:\n        y_vals = []\n        x_vals = []\n        \n        # Store scenario-dependent averages to avoid re-calculation\n        avg_g3_per_nucleus = []\n\n        # Construct variables for linear regression\n        for props in nuclear_properties:\n            rho = props['rho']\n            # Calculate scenario-DEPENDENT average\n            g3 = (rho / RHO_SAT)**eta\n            integrand_g3 = 4 * np.pi * r**4 * rho * g3\n            avg_g3 = np.trapz(integrand_g3, r) / props['denom_avg']\n            avg_g3_per_nucleus.append(avg_g3)\n            \n            y = props['K_A_exp'] - C1 * props['avg_g1'] - C2 * props['avg_g2']\n            x = -props['delta']**2 * avg_g3\n            \n            y_vals.append(y)\n            x_vals.append(x)\n            \n        # Perform linear least-squares regression: y = K_inf + K_tau_0 * x\n        A_matrix = np.vstack([np.ones(len(x_vals)), x_vals]).T\n        fit_params, _, _, _ = lstsq(A_matrix, y_vals, rcond=None)\n        K_inf, K_tau_0 = fit_params\n        \n        results.append(K_inf)\n\n        # Calculate RMS deviation\n        sq_errors = []\n        for i, props in enumerate(nuclear_properties):\n            avg_g3 = avg_g3_per_nucleus[i]\n            \n            # Calculate model-predicted K_A\n            K_A_model = K_inf + C1 * props['avg_g1'] + C2 * props['avg_g2'] - K_tau_0 * props['delta']**2 * avg_g3\n            \n            # Calculate model-predicted E_GMR\n            if K_A_model < 0: # Physically non-sensical, but handle for stability\n               E_gmr_model = 0\n            else:\n               E_gmr_model = np.sqrt(K_A_model * HBARC**2 / (M_NUCLEON * props['r_sq_mean']))\n            \n            sq_errors.append((E_gmr_model - props['E_gmr_exp'])**2)\n            \n        rms = np.sqrt(np.mean(sq_errors))\n        rms_values.append(rms)\n\n    results.extend(rms_values)\n    best_index = np.argmin(rms_values)\n    results.append(best_index)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3555094"}]}