{"hands_on_practices": [{"introduction": "To simulate a nuclear many-body system on a quantum computer, we must first translate its fermionic Hamiltonian into the language of qubits. The Jordan-Wigner transformation is a foundational method for achieving this mapping. This exercise provides direct, hands-on practice with the mechanics of this transformation for a physically significant interaction, the pairing term, building crucial intuition for how fermionic operators manifest as multi-qubit Pauli strings [@problem_id:3583328].", "problem": "Consider a nuclear shell-model pairing Hamiltonian term acting on spin-orbitals, where each orbital index $r \\in \\{1,\\dots,M\\}$ corresponds to two spin-orbitals labeled by qubits $2r-1$ (spin-down) and $2r$ (spin-up). Define the pair creation operator at orbital $p$ as $P_{p}^{\\dagger} \\equiv \\hat{a}_{2p-1}^{\\dagger}\\hat{a}_{2p}^{\\dagger}$ and the pair annihilation operator at orbital $q$ as $P_{q} \\equiv \\hat{a}_{2q}\\hat{a}_{2q-1}$, with $p \\neq q$. The fermionic creation and annihilation operators satisfy the canonical anticommutation relations $\\{\\hat{a}_{j},\\hat{a}_{k}^{\\dagger}\\} = \\delta_{jk}$ and $\\{\\hat{a}_{j},\\hat{a}_{k}\\} = \\{\\hat{a}_{j}^{\\dagger},\\hat{a}_{k}^{\\dagger}\\}=0$. Under the Jordan–Wigner (JW) mapping, the fermionic operators are represented on a qubit register as $\\hat{a}_{j}^{\\dagger} = \\tfrac{1}{2}\\left(X_{j} - i Y_{j}\\right)\\prod_{k=1}^{j-1} Z_{k}$ and $\\hat{a}_{j} = \\tfrac{1}{2}\\left(X_{j} + i Y_{j}\\right)\\prod_{k=1}^{j-1} Z_{k}$, where $X_{j}$, $Y_{j}$, and $Z_{j}$ denote the Pauli matrices acting on qubit $j$ and $i$ is the imaginary unit.\n\nStarting from the above definitions and assuming $p<q$ to fix the qubit ordering, construct the explicit Pauli-operator decomposition of the non-Hermitian operator $P_{p}^{\\dagger}P_{q}$ under the Jordan–Wigner mapping, expressed as a sum of tensor-product Pauli strings on the four involved qubits $\\{2p-1,2p,2q,2q-1\\}$ with complex coefficients, and determine the total number of distinct Pauli strings that appear in this decomposition. Provide your final answer as the count of distinct strings (an integer). No rounding is necessary.", "solution": "The user wants to find the Pauli-operator decomposition of the operator $P_{p}^{\\dagger}P_{q}$ under a specific Jordan-Wigner (JW) mapping and count the number of resulting Pauli strings.\n\n### Step 1: Problem Validation\n\nThe problem is evaluated against the specified criteria.\n\n**1. Extract Givens:**\n- Pair creation operator at orbital $p$: $P_{p}^{\\dagger} \\equiv \\hat{a}_{2p-1}^{\\dagger}\\hat{a}_{2p}^{\\dagger}$.\n- Pair annihilation operator at orbital $q$: $P_{q} \\equiv \\hat{a}_{2q}\\hat{a}_{2q-1}$.\n- Constraint on orbital indices: $p < q$.\n- Fermionic anticommutation relations: $\\{\\hat{a}_{j},\\hat{a}_{k}^{\\dagger}\\} = \\delta_{jk}$, $\\{\\hat{a}_{j},\\hat{a}_{k}\\} = \\{\\hat{a}_{j}^{\\dagger},\\hat{a}_{k}^{\\dagger}\\}=0$.\n- Jordan-Wigner mapping:\n  - Creation operator: $\\hat{a}_{j}^{\\dagger} = \\tfrac{1}{2}\\left(X_{j} - i Y_{j}\\right)\\prod_{k=1}^{j-1} Z_{k}$.\n  - Annihilation operator: $\\hat{a}_{j} = \\tfrac{1}{2}\\left(X_{j} + i Y_{j}\\right)\\prod_{k=1}^{j-1} Z_{k}$.\n- $X_j, Y_j, Z_j$ are Pauli matrices acting on qubit $j$.\n\n**2. Validate Using Extracted Givens:**\n- **Scientific Grounding:** The problem is firmly rooted in the principles of quantum mechanics, specifically the second quantization formalism for many-body systems and its mapping to spin systems (qubits). The pairing Hamiltonian and Jordan-Wigner transformation are standard concepts in computational nuclear physics and condensed matter theory.\n- **Well-Posedness:** The problem is clearly defined with all necessary information. The definitions of operators and the JW mapping are explicit. The constraint $p<q$ ensures a fixed ordering of the qubits, leading to a unique solution. The task is specific: find the Pauli decomposition and count the terms.\n- **Objectivity:** The problem is stated in precise, formal mathematical language, free from any subjectivity or ambiguity.\n\n**3. Verdict and Action:**\nThe problem is valid. It is scientifically sound, well-posed, and objective. A rigorous solution can be derived from the provided information. I will now proceed with the solution.\n\n### Step 2: Derivation of the Pauli Decomposition\n\nThe operator to be transformed is $O = P_{p}^{\\dagger}P_{q} = \\hat{a}_{2p-1}^{\\dagger}\\hat{a}_{2p}^{\\dagger}\\hat{a}_{2q}\\hat{a}_{2q-1}$. The constraint $p<q$ with integer-valued $p, q$ implies $2p < 2q-1$. Thus, the indices of the involved qubits are ordered as $2p-1 < 2p < 2q-1 < 2q$.\n\nLet us define the local Pauli parts of the JW mapping for clarity:\n- $P_j = \\frac{1}{2}(X_j - iY_j)$\n- $A_j = \\frac{1}{2}(X_j + iY_j)$\nAnd the JW string part:\n- $S_j = \\prod_{k=1}^{j-1} Z_k$\n\nThe fermionic operators are then $\\hat{a}_j^\\dagger = P_j S_j$ and $\\hat{a}_j = A_j S_j$. The full operator is a product of four such terms:\n$$O = (\\hat{a}_{2p-1}^{\\dagger})(\\hat{a}_{2p}^{\\dagger})(\\hat{a}_{2q})(\\hat{a}_{2q-1})$$\n\nTo find the resulting Pauli operator, we determine its action on each qubit $k$. The operator on qubit $k$ is the product of the operators from each of the four fermionic terms acting on that qubit.\nLet $T_1 = \\hat{a}_{2p-1}^{\\dagger}$, $T_2 = \\hat{a}_{2p}^{\\dagger}$, $T_3 = \\hat{a}_{2q}$, $T_4 = \\hat{a}_{2q-1}$. The operator on qubit $k$ is $O(k) = T_1(k) T_2(k) T_3(k) T_4(k)$.\n\nLet's analyze the operator on each qubit site $k$:\n- For $k > 2q$: All four operators act as the identity $I$. $O(k) = I \\cdot I \\cdot I \\cdot I = I$.\n- For $k = 2q$: $T_1$, $T_2$, and $T_4$ act as $I$, while $T_3$ acts as $A_{2q}$. $O(2q) = I \\cdot I \\cdot A_{2q} \\cdot I = A_{2q}$.\n- For $2q-1 < k < 2q$: This range is empty as $k$ must be an integer.\n- For $k = 2q-1$: $T_1, T_2$ act as $I$. $T_3$ acts as $Z_{2q-1}$. $T_4$ acts as $A_{2q-1}$. $O(2q-1) = I \\cdot I \\cdot Z_{2q-1} \\cdot A_{2q-1} = Z_{2q-1} A_{2q-1}$.\n- For $2p < k < 2q-1$: $T_1, T_2$ act as $I$. $T_3, T_4$ act as $Z_k$. $O(k) = I \\cdot I \\cdot Z_k \\cdot Z_k = Z_k^2 = I$.\n- For $k = 2p$: $T_1$ acts as $I$. $T_2$ acts as $P_{2p}$. $T_3, T_4$ act as $Z_{2p}$. $O(2p) = I \\cdot P_{2p} \\cdot Z_{2p} \\cdot Z_{2p} = P_{2p} Z_{2p}^2 = P_{2p}$.\n- For $k = 2p-1$: $T_1$ acts as $P_{2p-1}$. $T_2, T_3, T_4$ act as $Z_{2p-1}$. $O(2p-1) = P_{2p-1} \\cdot Z_{2p-1} \\cdot Z_{2p-1} \\cdot Z_{2p-1} = P_{2p-1} Z_{2p-1}^3 = P_{2p-1} Z_{2p-1}$.\n- For $k < 2p-1$: All four operators act as $Z_k$. $O(k) = Z_k \\cdot Z_k \\cdot Z_k \\cdot Z_k = Z_k^4 = I$.\n\nThe operator $O$ only has non-trivial components on the four qubits $2p-1, 2p, 2q-1, 2q$. The full operator is the tensor product of these components, ordered by increasing qubit index:\n$$O = (P_{2p-1} Z_{2p-1}) \\otimes P_{2p} \\otimes (Z_{2q-1} A_{2q-1}) \\otimes A_{2q}$$\n\nNow, we simplify the local product terms using standard Pauli algebra ($XY=iZ, YZ=iX, ZX=iY$ and anticommutation for different indices, e.g., $XZ=-ZX$).\n- For $P_j Z_j$:\n$$P_j Z_j = \\frac{1}{2}(X_j - iY_j)Z_j = \\frac{1}{2}(X_j Z_j - iY_j Z_j) = \\frac{1}{2}(-iY_j - i(iX_j)) = \\frac{1}{2}(X_j - iY_j) = P_j$$\n- For $Z_j A_j$:\n$$Z_j A_j = Z_j \\frac{1}{2}(X_j + iY_j) = \\frac{1}{2}(Z_j X_j + iZ_j Y_j) = \\frac{1}{2}(iY_j + i(-iX_j)) = \\frac{1}{2}(X_j + iY_j) = A_j$$\nThese simplifications are a direct consequence of the specific, albeit unconventional, definitions provided for $\\hat{a}_j^\\dagger$ and $\\hat{a}_j$.\n\nSubstituting these simplified expressions back into the operator $O$:\n$$O = P_{2p-1} \\otimes P_{2p} \\otimes A_{2q-1} \\otimes A_{2q}$$\n\nFinally, we substitute the definitions of $P_j$ and $A_j$ to obtain the explicit Pauli decomposition:\n$$O = \\frac{1}{2}(X_{2p-1}-iY_{2p-1}) \\otimes \\frac{1}{2}(X_{2p}-iY_{2p}) \\otimes \\frac{1}{2}(X_{2q-1}+iY_{2q-1}) \\otimes \\frac{1}{2}(X_{2q}+iY_{2q})$$\n$$O = \\frac{1}{16} (X_{2p-1}-iY_{2p-1}) \\otimes (X_{2p}-iY_{2p}) \\otimes (X_{2q-1}+iY_{2q-1}) \\otimes (X_{2q}+iY_{2q})$$\n\nTo find the total number of distinct Pauli strings, we expand this expression. Each of the four tensor factors is a sum of two distinct Pauli operators ($X$ and $Y$). The expansion of this product results in a sum of terms, where each term is a tensor product of one operator chosen from each factor. For example, one such term is $\\frac{1}{16}(1)(1)(1)(1) X_{2p-1} \\otimes X_{2p} \\otimes X_{2q-1} \\otimes X_{2q}$. Another is $\\frac{1}{16}(-i)(1)(i)(1) Y_{2p-1} \\otimes X_{2p} \\otimes Y_{2q-1} \\otimes X_{2q}$.\n\nThe number of terms is the product of the number of choices from each factor. There are $2$ choices for each of the $4$ qubits.\n- From $(X_{2p-1}-iY_{2p-1})$: $X_{2p-1}$ or $-iY_{2p-1}$\n- From $(X_{2p}-iY_{2p})$: $X_{2p}$ or $-iY_{2p}$\n- From $(X_{2q-1}+iY_{2q-1})$: $X_{2q-1}$ or $iY_{2q-1}$\n- From $(X_{2q}+iY_{2q})$: $X_{2q}$ or $iY_{2q}$\n\nSince the operators in each factor ($X_j, Y_j$) act on distinct qubits, all resulting tensor products of Pauli matrices are unique. The coefficient of each resulting Pauli string is a product of non-zero complex numbers, so no term vanishes.\nThe total number of distinct Pauli strings is therefore $2 \\times 2 \\times 2 \\times 2 = 2^4 = 16$.", "answer": "$$\n\\boxed{16}\n$$", "id": "3583328"}, {"introduction": "Once a Hamiltonian is expressed as a sum of Pauli strings, a primary task in many quantum algorithms is to measure its expectation value. Measuring each term individually is prohibitively expensive, so a key optimization is to group terms that can be measured simultaneously. This practice problem challenges you to apply the principles of operator commutativity to partition a Hamiltonian into minimal measurement groups, a critical skill for designing efficient experiments on near-term quantum devices [@problem_id:3583285].", "problem": "You are given a fermion-to-qubit mapped effective nuclear many-body Hamiltonian expressed as a sum of weighted Pauli strings on $4$ qubits, $H=\\sum_{i=1}^{12} h_i P_i$, where each $h_i \\in \\mathbb{R}$ and each $P_i$ is a length-$4$ tensor product over $\\{I,X,Y,Z\\}$. The $12$ Pauli strings $\\{P_i\\}$ are:\n- $P_{1}=X\\otimes X\\otimes I\\otimes I$,\n- $P_{2}=X\\otimes Y\\otimes I\\otimes I$,\n- $P_{3}=Y\\otimes X\\otimes I\\otimes I$,\n- $P_{4}=Y\\otimes Y\\otimes I\\otimes I$,\n- $P_{5}=X\\otimes I\\otimes Z\\otimes I$,\n- $P_{6}=I\\otimes X\\otimes I\\otimes Z$,\n- $P_{7}=I\\otimes Y\\otimes Z\\otimes I$,\n- $P_{8}=X\\otimes I\\otimes I\\otimes Z$,\n- $P_{9}=Y\\otimes I\\otimes Z\\otimes I$,\n- $P_{10}=I\\otimes X\\otimes Z\\otimes I$,\n- $P_{11}=Y\\otimes I\\otimes I\\otimes Z$,\n- $P_{12}=I\\otimes Y\\otimes I\\otimes Z$.\n\nAssume measurements are performed in a tensor-product basis defined by single-qubit basis choices. A set $\\mathcal{S}$ of Pauli strings is called tensor-product commuting (TPC) if there exists, for each qubit $k\\in\\{1,2,3,4\\}$, a choice $p_k\\in\\{I,X,Y,Z\\}$ such that every $P\\in\\mathcal{S}$ has at qubit $k$ either $I$ or $p_k$. Equivalently, for any pair $P,Q\\in\\mathcal{S}$ and any qubit $k$, either at least one has $I$ on qubit $k$, or they have the same non-identity Pauli on qubit $k$. All terms in a TPC set can be simultaneously estimated from a single tensor-product measurement setting via appropriate single-qubit basis rotations.\n\nTask:\n1. Using only the definition of TPC and standard operator commutation rules for Pauli matrices, construct a minimal partition of the given $12$ terms into TPC sets by reasoning from first principles. Justify the minimality of your partition by identifying a lower bound on the number of TPC sets, and then exhibiting an explicit partition that attains this lower bound.\n2. Let $N_{\\text{terms}}$ denote the number of terms (here $12$) and let $N_{\\text{TPC}}$ denote the minimal number of TPC sets from your partition. Define the fractional reduction in measurement settings relative to naive termwise measurement as $r = 1 - \\frac{N_{\\text{TPC}}}{N_{\\text{terms}}}$. Compute $r$.\n\nExpress the final value of $r$ as a decimal rounded to four significant figures.", "solution": "The problem requires partitioning a given set of $12$ Pauli strings into a minimal number of Tensor-Product Commuting (TPC) sets, and then calculating a fractional reduction in measurement settings. The validation of the problem statement is the first step.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- A set of $N_{\\text{terms}}=12$ Pauli strings $\\{P_i\\}_{i=1}^{12}$ on $4$ qubits:\n  - $P_{1}=X\\otimes X\\otimes I\\otimes I$\n  - $P_{2}=X\\otimes Y\\otimes I\\otimes I$\n  - $P_{3}=Y\\otimes X\\otimes I\\otimes I$\n  - $P_{4}=Y\\otimes Y\\otimes I\\otimes I$\n  - $P_{5}=X\\otimes I\\otimes Z\\otimes I$\n  - $P_{6}=I\\otimes X\\otimes I\\otimes Z$\n  - $P_{7}=I\\otimes Y\\otimes Z\\otimes I$\n  - $P_{8}=X\\otimes I\\otimes I\\otimes Z$\n  - $P_{9}=Y\\otimes I\\otimes Z\\otimes I$\n  - $P_{10}=I\\otimes X\\otimes Z\\otimes I$\n  - $P_{11}=Y\\otimes I\\otimes I\\otimes Z$\n  - $P_{12}=I\\otimes Y\\otimes I\\otimes Z$\n- Definition of a Tensor-Product Commuting (TPC) set $\\mathcal{S}$: For each qubit $k \\in \\{1, 2, 3, 4\\}$, there exists a Pauli operator $p_k \\in \\{I, X, Y, Z\\}$ such that for every $P \\in \\mathcal{S}$, the $k$-th operator in the tensor product for $P$ is either $I$ or $p_k$.\n- Task 1: Construct a minimal partition of $\\{P_i\\}$ into TPC sets, justifying minimality with a lower bound.\n- Task 2: Compute $r = 1 - \\frac{N_{\\text{TPC}}}{N_{\\text{terms}}}$, where $N_{\\text{TPC}}$ is the size of the minimal partition, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses standard concepts from quantum information and computational physics, namely qubits, Pauli operators, and Hamiltonian term grouping for efficient measurement. The TPC condition is a valid and well-defined mathematical criterion for grouping.\n- **Well-Posed:** The set of Pauli strings is finite and explicitly defined. The TPC condition is unambiguous. The task is to find a minimal partition, which is a solvable combinatorial problem.\n- **Objective:** The problem is stated in precise mathematical language, free from subjectivity.\n\nThe problem is scientifically sound, formally stated, and self-contained. It does not violate any of the invalidity criteria. Therefore, the problem is deemed **valid**.\n\n### Solution\n\n**Part 1: Minimal Partition into TPC Sets**\n\nThe core of the task is to partition the set of $12$ Pauli strings, which we denote $\\mathcal{P} = \\{P_1, \\ldots, P_{12}\\}$, into the minimum number of disjoint subsets, where each subset is a TPC set. This is a partitioning problem that can be mapped to a graph coloring problem.\n\nLet's define a conflict graph $G = (V, E)$, where the vertices $V$ are the Pauli strings in $\\mathcal{P}$. An edge $(P_i, P_j) \\in E$ exists if the strings $P_i$ and $P_j$ cannot belong to the same TPC set. Two Pauli strings, $P_i = \\otimes_{k=1}^4 \\sigma_i^{(k)}$ and $P_j = \\otimes_{k=1}^4 \\sigma_j^{(k)}$, are in conflict if there exists at least one qubit position $k$ where both have a non-identity operator, but these operators are different. That is, $\\sigma_i^{(k)} \\neq \\sigma_j^{(k)}$ and both $\\sigma_i^{(k)}, \\sigma_j^{(k)} \\in \\{X, Y, Z\\}$.\n\nThe problem of finding a minimal partition of $\\mathcal{P}$ into TPC sets is equivalent to finding the chromatic number $\\chi(G)$ of the conflict graph $G$, which is the minimum number of colors needed to color the vertices of $G$ such that no two adjacent vertices share the same color. A lower bound on the chromatic number is the clique number $\\omega(G)$, the size of the largest clique (a subset of vertices where every two distinct vertices are adjacent).\n\nLet's identify a clique in $G$. Consider the first four Pauli strings:\n- $P_1 = X \\otimes X \\otimes I \\otimes I$\n- $P_2 = X \\otimes Y \\otimes I \\otimes I$\n- $P_3 = Y \\otimes X \\otimes I \\otimes I$\n- $P_4 = Y \\otimes Y \\otimes I \\otimes I$\n\nLet's check for conflicts among them:\n- $P_1$ vs $P_2$: Conflict at qubit $2$ ($X$ vs $Y$).\n- $P_1$ vs $P_3$: Conflict at qubit $1$ ($X$ vs $Y$).\n- $P_1$ vs $P_4$: Conflict at qubit $1$ ($X$ vs $Y$) and qubit $2$ ($X$ vs $Y$).\n- $P_2$ vs $P_3$: Conflict at qubit $1$ ($X$ vs $Y$) and qubit $2$ ($Y$ vs $X$).\n- $P_2$ vs $P_4$: Conflict at qubit $1$ ($X$ vs $Y$).\n- $P_3$ vs $P_4$: Conflict at qubit $2$ ($X$ vs $Y$).\n\nEvery pair in the set $\\{P_1, P_2, P_3, P_4\\}$ is in conflict. Thus, this set forms a $4$-clique in the conflict graph $G$. This implies that the clique number $\\omega(G) \\ge 4$, and therefore the chromatic number $\\chi(G) \\ge 4$. The minimum number of TPC sets required, $N_{\\text{TPC}}$, must be at least $4$.\n\nNow, we need to show that a partition into $4$ sets is possible. If we can construct such a partition, we will have proven that $N_{\\text{TPC}} = 4$. We can attempt to build these four sets, $\\mathcal{S}_1, \\mathcal{S}_2, \\mathcal{S}_3, \\mathcal{S}_4$, by assigning each member of the $4$-clique to a different set. Let's make an assignment based on the operators on the first two qubits:\n- $\\mathcal{S}_1$ corresponds to a measurement basis with $(X, X, \\dots)$ for qubits $(1,2)$. It contains $P_1$.\n- $\\mathcal{S}_2$ corresponds to a measurement basis with $(X, Y, \\dots)$ for qubits $(1,2)$. It contains $P_2$.\n- $\\mathcal{S}_3$ corresponds to a measurement basis with $(Y, X, \\dots)$ for qubits $(1,2)$. It contains $P_3$.\n- $\\mathcal{S}_4$ corresponds to a measurement basis with $(Y, Y, \\dots)$ for qubits $(1,2)$. It contains $P_4$.\n\nWe now distribute the remaining $8$ Pauli strings into these four sets according to the TPC condition. A term $P = \\sigma^{(1)}\\otimes\\sigma^{(2)}\\otimes\\sigma^{(3)}\\otimes\\sigma^{(4)}$ can be placed in a set with a target measurement basis $(p_1, p_2, p_3, p_4)$ if for all $k \\in \\{1,2,3,4\\}$, $\\sigma^{(k)}$ is either $I$ or $p_k$.\n\nLet's try to construct the sets:\n- **Set $\\mathcal{S}_1$ (Basis pattern $X,X, \\dots$):**\n  - We start with $P_1=XXII$.\n  - Which other terms can fit? We need terms where $\\sigma^{(1)} \\in \\{I,X\\}$ and $\\sigma^{(2)} \\in \\{I,X\\}$.\n  - $P_5=XIZI$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(X,I)$.\n  - $P_6=IXIZ$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(I,X)$.\n  - Let's form $\\mathcal{S}_1 = \\{P_1, P_5, P_6\\} = \\{XXII, XIZI, IXIZ\\}$.\n  - Let's check if this is a TPC set. For each qubit, the set of non-identity operators must be a singleton or empty.\n    - Qubit 1: $\\{X\\}$ from $P_1, P_5$. OK.\n    - Qubit 2: $\\{X\\}$ from $P_1, P_6$. OK.\n    - Qubit 3: $\\{Z\\}$ from $P_5$. OK.\n    - Qubit 4: $\\{Z\\}$ from $P_6$. OK.\n  - $\\mathcal{S}_1$ is a valid TPC set.\n\n- **Set $\\mathcal{S}_2$ (Basis pattern $X,Y, \\dots$):**\n  - We start with $P_2=XYII$.\n  - We need terms where $\\sigma^{(1)} \\in \\{I,X\\}$ and $\\sigma^{(2)} \\in \\{I,Y\\}$.\n  - $P_7=IYZI$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(I,Y)$.\n  - $P_8=XIIZ$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(X,I)$.\n  - Let's form $\\mathcal{S}_2 = \\{P_2, P_7, P_8\\} = \\{XYII, IYZI, XIIZ\\}$.\n  - Check TPC condition:\n    - Qubit 1: $\\{X\\}$ from $P_2, P_8$. OK.\n    - Qubit 2: $\\{Y\\}$ from $P_2, P_7$. OK.\n    - Qubit 3: $\\{Z\\}$ from $P_7$. OK.\n    - Qubit 4: $\\{Z\\}$ from $P_8$. OK.\n  - $\\mathcal{S}_2$ is a valid TPC set.\n\n- **Set $\\mathcal{S}_3$ (Basis pattern $Y,X, \\dots$):**\n  - We start with $P_3=YXII$.\n  - We need terms where $\\sigma^{(1)} \\in \\{I,Y\\}$ and $\\sigma^{(2)} \\in \\{I,X\\}$.\n  - $P_9=YIZI$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(Y,I)$.\n  - $P_{10}=IXZI$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(I,X)$.\n  - Let's form $\\mathcal{S}_3 = \\{P_3, P_9, P_{10}\\} = \\{YXII, YIZI, IXZI\\}$.\n  - Check TPC condition:\n    - Qubit 1: $\\{Y\\}$ from $P_3, P_9$. OK.\n    - Qubit 2: $\\{X\\}$ from $P_3, P_{10}$. OK.\n    - Qubit 3: $\\{Z\\}$ from $P_9, P_{10}$. OK.\n    - Qubit 4: {}. All $I$. OK.\n  - $\\mathcal{S}_3$ is a valid TPC set.\n\n- **Set $\\mathcal{S}_4$ (Basis pattern $Y,Y, \\dots$):**\n  - We start with $P_4=YYII$.\n  - We need terms where $\\sigma^{(1)} \\in \\{I,Y\\}$ and $\\sigma^{(2)} \\in \\{I,Y\\}$.\n  - $P_{11}=YIIZ$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(Y,I)$.\n  - $P_{12}=IYIZ$: Fits. $(\\sigma^{(1)},\\sigma^{(2)})=(I,Y)$.\n  - Let's form $\\mathcal{S}_4 = \\{P_4, P_{11}, P_{12}\\} = \\{YYII, YIIZ, IYIZ\\}$.\n  - Check TPC condition:\n    - Qubit 1: $\\{Y\\}$ from $P_4, P_{11}$. OK.\n    - Qubit 2: $\\{Y\\}$ from $P_4, P_{12}$. OK.\n    - Qubit 3: {}. All $I$. OK.\n    - Qubit 4: $\\{Z\\}$ from $P_{11}, P_{12}$. OK.\n  - $\\mathcal{S}_4$ is a valid TPC set.\n\nWe have successfully partitioned all $12$ Pauli strings into $4$ valid TPC sets. Since we established a lower bound of $4$, this partition is minimal.\nThus, $N_{\\text{TPC}} = 4$. The minimal partition is:\n- $\\mathcal{S}_1 = \\{X\\otimes X\\otimes I\\otimes I, X\\otimes I\\otimes Z\\otimes I, I\\otimes X\\otimes I\\otimes Z\\}$\n- $\\mathcal{S}_2 = \\{X\\otimes Y\\otimes I\\otimes I, I\\otimes Y\\otimes Z\\otimes I, X\\otimes I\\otimes I\\otimes Z\\}$\n- $\\mathcal{S}_3 = \\{Y\\otimes X\\otimes I\\otimes I, Y\\otimes I\\otimes Z\\otimes I, I\\otimes X\\otimes Z\\otimes I\\}$\n- $\\mathcal{S}_4 = \\{Y\\otimes Y\\otimes I\\otimes I, Y\\otimes I\\otimes I\\otimes Z, I\\otimes Y\\otimes I\\otimes Z\\}$\n\n**Part 2: Calculation of the Fractional Reduction**\n\nThe fractional reduction in measurement settings, $r$, is defined as $r = 1 - \\frac{N_{\\text{TPC}}}{N_{\\text{terms}}}$.\nFrom the problem statement, the total number of terms is $N_{\\text{terms}} = 12$.\nFrom our analysis in Part 1, the minimal number of TPC sets is $N_{\\text{TPC}} = 4$.\n\nSubstituting these values into the formula for $r$:\n$$r = 1 - \\frac{4}{12} = 1 - \\frac{1}{3} = \\frac{2}{3}$$\nThe problem requires this value as a decimal rounded to four significant figures.\n$$r = \\frac{2}{3} \\approx 0.666666...$$\nRounding to four significant figures gives $0.6667$.", "answer": "$$\\boxed{0.6667}$$", "id": "3583285"}, {"introduction": "While variational algorithms rely on measuring Hamiltonian terms, more advanced methods like quantum phase estimation require the Hamiltonian operator $H$ itself to be coherently applied within a circuit. Block encoding is the modern paradigm for embedding a non-unitary operator like $H$ into a larger unitary operation that a quantum computer can execute. By working through this exercise [@problem_id:3583310], you will determine the fundamental resource costs of a block encoding based on the Linear Combination of Unitaries (LCU) method, connecting the structure of the physical Hamiltonian to the concrete requirements of ancilla qubits and gate operations.", "problem": "Consider a two-body nuclear Hamiltonian encoded on a system register of $n$ qubits as a linear combination of Pauli strings,\n$$\nH \\;=\\; \\sum_{k=0}^{L-1} h_k\\, P_k,\n$$\nwhere each $P_k$ is a tensor product of single-qubit Pauli operators from $\\{I, X, Y, Z\\}$ acting on the $n$-qubit system, and the $h_k \\in \\mathbb{R}$ are real coefficients that may be positive or negative. In a truncated shell-model setting, suppose the decomposition contains $L = 48$ distinct Pauli strings, with $L_{\\mathrm{two}} = 30$ two-body strings (each has exactly two non-identity single-qubit Pauli factors acting on distinct qubits) and $L_{\\mathrm{one}} = 18$ one-body strings (each has exactly one non-identity single-qubit Pauli factor).\n\nYou will design a block-encoding of $H$ using the Linear Combination of Unitaries (LCU) framework with binary-address multiplexed unitaries. The block-encoding unitary $U$ must satisfy\n$$\n\\left(\\langle 0^{m}|\\otimes I\\right) U \\left(|0^{m}\\rangle\\otimes I\\right) \\;=\\; \\frac{H}{\\alpha}\n$$\nfor some normalization constant $\\alpha > 0$, where $|0^{m}\\rangle$ initializes an $m$-qubit ancilla index register. The construction uses the following building blocks:\n- A state-preparation operator $\\mathrm{PREPARE}$ on the $m$-qubit index register that prepares the coherent superposition with amplitudes proportional to $|h_k|$.\n- A multiplexer (the $\\mathrm{SELECT}$ operator) that applies the corresponding Pauli string $P_k$ to the system register conditioned on the index register being in basis state $|k\\rangle$.\n- The adjoint $\\mathrm{PREPARE}^{\\dagger}$ to uncompute the index register.\n\nAssume the following implementation details:\n- The binary encoding is used for the index register, so that $|k\\rangle$ encodes integer $k \\in \\{0,\\dots,L-1\\}$ on $m$ qubits.\n- Signs of $h_k$ are implemented as a diagonal phase on the index register and do not incur any additional single-qubit Pauli operations on the system register.\n- Each non-identity single-qubit Pauli factor that appears within a $P_k$ is implemented inside $\\mathrm{SELECT}$ as one multi-controlled single-qubit Pauli operation, conditioned on the index register being exactly $|k\\rangle$.\n- No additional ancillas beyond the $m$-qubit index register are used for the block-encoding; in particular, $\\mathrm{PREPARE}$ and $\\mathrm{PREPARE}^{\\dagger}$ act only on the index register, and the $\\mathrm{SELECT}$ operator acts only by conditional single-qubit Pauli applications on the system register.\n\nStarting from the definitions of block-encoding and the above resource model, determine:\n1. The minimal number $m$ of ancilla qubits required in the index register.\n2. The total number $N_{\\mathrm{cP}}$ of controlled single-qubit Pauli applications inside a single invocation of the $\\mathrm{SELECT}$ operator.\n\nProvide your final answer as a two-entry row matrix containing $m$ and $N_{\\mathrm{cP}}$. No rounding is needed. No units are required for the counts.", "solution": "The problem is well-posed and contains all the necessary information to determine the minimal number of ancilla qubits, $m$, and the total number of controlled single-qubit Pauli applications, $N_{\\mathrm{cP}}$, for the described block-encoding procedure.\n\nThe problem asks for two quantities:\n1. The minimal number of ancilla qubits, $m$, for the index register.\n2. The total number of controlled single-qubit Pauli applications, $N_{\\mathrm{cP}}$, within the $\\mathrm{SELECT}$ operator.\n\nWe address each question sequentially.\n\n1. Determination of the minimal number of ancilla qubits $m$:\nThe Hamiltonian $H$ is given as a linear combination of $L$ distinct Pauli strings, $H = \\sum_{k=0}^{L-1} h_k P_k$. The problem states that the total number of Pauli strings is $L=48$. The Linear Combination of Unitaries (LCU) framework uses an ancilla register, which we call the index register, to label each of the $L$ terms in the sum. The states of this register, denoted $|k\\rangle$, correspond to the integers $k$ from $0$ to $L-1$.\n\nThe problem states that a binary encoding is used for the index register. An $m$-qubit register can represent $2^m$ distinct basis states. To uniquely represent all $L$ terms of the Hamiltonian, the number of available basis states in the index register must be at least equal to $L$. Therefore, we must satisfy the inequality:\n$$\n2^m \\ge L\n$$\nGiven that $L=48$, we need to find the smallest integer $m$ that satisfies:\n$$\n2^m \\ge 48\n$$\nWe can test integer powers of $2$:\nFor $m=5$, we have $2^5 = 32$. Since $32 < 48$, $5$ qubits are insufficient.\nFor $m=6$, we have $2^6 = 64$. Since $64 \\ge 48$, $6$ qubits are sufficient.\n\nThus, the minimal number of ancilla qubits required for the index register is $m=6$.\n\n2. Determination of the total number of controlled Pauli applications $N_{\\mathrm{cP}}$:\nThe $\\mathrm{SELECT}$ operator is the core of the block-encoding circuit. Its function is to apply the Pauli string $P_k$ to the system register, conditioned on the index register being in the state $|k\\rangle$. This can be formally written as:\n$$\n\\mathrm{SELECT} = \\sum_{k=0}^{L-1} |k\\rangle\\langle k| \\otimes P_k\n$$\nThe problem specifies the resource cost for implementing this operator: \"Each non-identity single-qubit Pauli factor that appears within a $P_k$ is implemented inside $\\mathrm{SELECT}$ as one multi-controlled single-qubit Pauli operation, conditioned on the index register being exactly $|k\\rangle$.\"\n\nThis means that for a given Pauli string $P_k$, the number of controlled operations required to implement its action is equal to the number of non-identity Pauli operators (i.e., operators from $\\{X, Y, Z\\}$) in its tensor product definition. This quantity is also known as the weight of the Pauli string, which we can denote as $w(P_k)$.\n\nThe total number of controlled single-qubit Pauli applications, $N_{\\mathrm{cP}}$, in a single invocation of the $\\mathrm{SELECT}$ operator is the sum of the weights of all the Pauli strings in the Hamiltonian decomposition:\n$$\nN_{\\mathrm{cP}} = \\sum_{k=0}^{L-1} w(P_k)\n$$\nThe problem provides a breakdown of the $L=48$ Pauli strings based on their type:\n- There are $L_{\\mathrm{one}} = 18$ one-body strings. By definition, each of these has exactly one non-identity single-qubit Pauli factor. Therefore, for each of these $18$ strings, the weight is $w(P_k) = 1$.\n- There are $L_{\\mathrm{two}} = 30$ two-body strings. By definition, each of these has exactly two non-identity single-qubit Pauli factors. Therefore, for each of these $30$ strings, the weight is $w(P_k) = 2$.\n\nWe can now calculate the total sum $N_{\\mathrm{cP}}$ by summing the contributions from each type of string:\n$$\nN_{\\mathrm{cP}} = (\\text{Number of one-body strings}) \\times (\\text{Weight per one-body string}) + (\\text{Number of two-body strings}) \\times (\\text{Weight per two-body string})\n$$\n$$\nN_{\\mathrm{cP}} = (L_{\\mathrm{one}} \\times 1) + (L_{\\mathrm{two}} \\times 2)\n$$\nSubstituting the given values $L_{\\mathrm{one}} = 18$ and $L_{\\mathrm{two}} = 30$:\n$$\nN_{\\mathrm{cP}} = (18 \\times 1) + (30 \\times 2)\n$$\n$$\nN_{\\mathrm{cP}} = 18 + 60\n$$\n$$\nN_{\\mathrm{cP}} = 78\n$$\nTherefore, the total number of controlled single-qubit Pauli applications inside the $\\mathrm{SELECT}$ operator is $78$.\n\nThe two determined values are $m=6$ and $N_{\\mathrm{cP}}=78$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6 & 78\n\\end{pmatrix}\n}\n$$", "id": "3583310"}]}