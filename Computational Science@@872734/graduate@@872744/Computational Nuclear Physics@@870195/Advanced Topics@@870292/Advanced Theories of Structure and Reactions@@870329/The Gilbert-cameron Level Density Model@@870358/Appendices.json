{"hands_on_practices": [{"introduction": "Before implementing any model, it's crucial to understand its theoretical underpinnings and limitations. This first practice explores the mathematical behavior of the Constant-Temperature and Fermi-Gas level density formulas, focusing on the microcanonical entropy and temperature. By analyzing their limits and derivatives, you will uncover the fundamental reasons why a hybrid approach like the Gilbert-Cameron model is necessary for a physically consistent description across a wide energy range. [@problem_id:3601137]", "problem": "Consider the composite level density framework of Gilbert–Cameron (GC), in which the effective excitation energy is defined by the pairing backshift as $U = E - \\Delta$ with $E \\ge \\Delta$, where $\\Delta > 0$ is the pairing backshift. The nuclear level density is modeled by a constant-temperature (CT) expression at low effective excitation energies and by a backshifted Fermi-gas (FG) expression at higher effective excitation energies. Assume the following widely used and well-tested forms:\n- For the CT region $0 \\le U \\le U_{x}$, the level density is $ \\rho_{\\mathrm{CT}}(U) = C_{\\mathrm{CT}} \\exp\\!\\left(\\frac{U}{T_{0}}\\right)$ with $C_{\\mathrm{CT}} > 0$ and $T_{0} > 0$ constant.\n- For the FG region $U \\ge U_{x}$, the level density is $ \\rho_{\\mathrm{FG}}(U) = C\\, U^{-5/4} \\exp\\!\\left(2\\sqrt{a\\,U}\\right)$ with $C > 0$ and $a > 0$ the level-density parameter.\n\nThe microcanonical entropy is defined by $S(U) = \\ln \\rho(U)$ and the microcanonical temperature is defined by $T_{\\mu}(U) = \\left(\\frac{\\partial S}{\\partial U}\\right)^{-1}$. Throughout, treat $C_{\\mathrm{CT}}$, $C$, $T_{0}$, $a$, and $\\Delta$ as positive constants and ignore spin and parity structure.\n\n(a) Starting from these definitions, analyze the limiting behavior of $S(U)$ as $U \\to 0^{+}$ in both the CT and FG forms and discuss which branch must be used near threshold to ensure $S(U) < \\infty$.\n\n(b) The GC construction matches the CT branch to the FG branch at $U = U_{x} > 0$. To avoid unphysical non-monotonicity of the microcanonical temperature, require that $T_{\\mu}(U)$ be monotonically non-decreasing for all $U \\ge 0$ when the FG branch is used (i.e., once $U \\ge U_{x}$). Determine, in closed form, the minimal matching excitation energy above the ground state, $E_{x}^{\\min}$, as a function of the level-density parameter $a$ and pairing backshift $\\Delta$, such that the FG branch used for $U \\ge U_{x}$ guarantees $T_{\\mu}(U)$ is monotonically non-decreasing. Express your final answer for $E_{x}^{\\min}$ in $\\mathrm{MeV}$. No numerical evaluation is required.", "solution": "The problem asks for an analysis of the Gilbert-Cameron (GC) level density model in two parts. First, we examine the behavior of the microcanonical entropy near the excitation energy threshold. Second, we determine the minimal matching energy that ensures the microcanonical temperature is physically well-behaved in the Fermi-gas region.\n\nPart (a): Analysis of Microcanonical Entropy as $U \\to 0^{+}$\n\nThe microcanonical entropy is defined as $S(U) = \\ln \\rho(U)$. We will analyze the limiting behavior of $S(U)$ for both the constant-temperature (CT) and Fermi-gas (FG) forms as the effective excitation energy $U$ approaches $0$ from the positive side.\n\nFor the constant-temperature (CT) model, the level density is given by $\\rho_{\\mathrm{CT}}(U) = C_{\\mathrm{CT}} \\exp\\left(\\frac{U}{T_{0}}\\right)$. The corresponding entropy is:\n$$S_{\\mathrm{CT}}(U) = \\ln \\left[ C_{\\mathrm{CT}} \\exp\\left(\\frac{U}{T_{0}}\\right) \\right] = \\ln(C_{\\mathrm{CT}}) + \\frac{U}{T_{0}}$$\nWe can now evaluate the limit as $U \\to 0^{+}$:\n$$ \\lim_{U \\to 0^{+}} S_{\\mathrm{CT}}(U) = \\lim_{U \\to 0^{+}} \\left( \\ln(C_{\\mathrm{CT}}) + \\frac{U}{T_{0}} \\right) = \\ln(C_{\\mathrm{CT}}) $$\nSince $C_{\\mathrm{CT}} > 0$ is a positive constant, its logarithm $\\ln(C_{\\mathrm{CT}})$ is a finite real number. Thus, the entropy in the CT model approaches a finite value at the threshold.\n\nFor the backshifted Fermi-gas (FG) model, the level density is given by $\\rho_{\\mathrm{FG}}(U) = C\\, U^{-5/4} \\exp\\left(2\\sqrt{a\\,U}\\right)$. The corresponding entropy is:\n$$ S_{\\mathrm{FG}}(U) = \\ln \\left[ C\\, U^{-5/4} \\exp\\left(2\\sqrt{a\\,U}\\right) \\right] = \\ln(C) + \\ln(U^{-5/4}) + \\ln\\left(\\exp\\left(2\\sqrt{a\\,U}\\right)\\right) $$\n$$ S_{\\mathrm{FG}}(U) = \\ln(C) - \\frac{5}{4}\\ln(U) + 2\\sqrt{a\\,U} $$\nWe now evaluate the limit as $U \\to 0^{+}$:\n$$ \\lim_{U \\to 0^{+}} S_{\\mathrm{FG}}(U) = \\lim_{U \\to 0^{+}} \\left( \\ln(C) - \\frac{5}{4}\\ln(U) + 2\\sqrt{a\\,U} \\right) $$\nAs $U \\to 0^{+}$, the term $2\\sqrt{a\\,U} \\to 0$. However, the term $\\ln(U) \\to -\\infty$. Consequently, the term $-\\frac{5}{4}\\ln(U) \\to +\\infty$. The entire expression therefore diverges:\n$$ \\lim_{U \\to 0^{+}} S_{\\mathrm{FG}}(U) = +\\infty $$\nPhysically, the entropy, representing the logarithm of the number of available quantum states, should be finite for any finite excitation energy, including the limit approaching the ground state. A divergent entropy at $U=0$ is unphysical. Therefore, to ensure that the entropy $S(U)$ remains finite as $U \\to 0^{+}$, the constant-temperature (CT) branch of the level density model must be used in the low-energy region near the threshold. The Fermi-gas model is not applicable at these very low energies due to this divergence.\n\nPart (b): Determination of the Minimal Matching Energy $E_{x}^{\\min}$\n\nWe are tasked with finding the minimal matching excitation energy $E_{x}^{\\min}$ such that the microcanonical temperature $T_{\\mu}(U)$ derived from the FG branch is monotonically non-decreasing for all $U \\ge U_{x}$. The condition is $\\frac{d T_{\\mu, \\mathrm{FG}}(U)}{dU} \\ge 0$ for $U \\ge U_x$.\n\nFirst, we must derive the expression for the microcanonical temperature $T_{\\mu, \\mathrm{FG}}(U)$. The temperature is the inverse of the derivative of the entropy with respect to energy.\nThe FG entropy is $S_{\\mathrm{FG}}(U) = \\ln(C) - \\frac{5}{4}\\ln(U) + 2\\sqrt{a}U^{1/2}$.\nThe derivative with respect to $U$ is:\n$$ \\frac{\\partial S_{\\mathrm{FG}}}{\\partial U} = \\frac{d}{dU} \\left( \\ln(C) - \\frac{5}{4}\\ln(U) + 2\\sqrt{a}U^{1/2} \\right) = -\\frac{5}{4U} + 2\\sqrt{a} \\left(\\frac{1}{2}U^{-1/2}\\right) = \\frac{\\sqrt{a}}{\\sqrt{U}} - \\frac{5}{4U} $$\nThe microcanonical temperature is the reciprocal of this expression:\n$$ T_{\\mu, \\mathrm{FG}}(U) = \\left(\\frac{\\partial S_{\\mathrm{FG}}}{\\partial U}\\right)^{-1} = \\left( \\frac{\\sqrt{a}}{\\sqrt{U}} - \\frac{5}{4U} \\right)^{-1} = \\left( \\frac{4\\sqrt{aU} - 5}{4U} \\right)^{-1} = \\frac{4U}{4\\sqrt{aU} - 5} $$\nNext, to find the region where $T_{\\mu, \\mathrm{FG}}(U)$ is monotonically non-decreasing, we compute its derivative with respect to $U$ and set it to be non-negative. We use the quotient rule for differentiation, $\\frac{d}{dx}\\left(\\frac{f}{g}\\right) = \\frac{f'g - fg'}{g^2}$.\nLet $f(U) = 4U$ and $g(U) = 4\\sqrt{a}U^{1/2} - 5$.\nThen $f'(U) = 4$ and $g'(U) = 4\\sqrt{a}\\left(\\frac{1}{2}U^{-1/2}\\right) = \\frac{2\\sqrt{a}}{\\sqrt{U}}$.\nThe derivative of the temperature is:\n$$ \\frac{d T_{\\mu, \\mathrm{FG}}}{dU} = \\frac{(4)(4\\sqrt{aU} - 5) - (4U)\\left(\\frac{2\\sqrt{a}}{\\sqrt{U}}\\right)}{\\left(4\\sqrt{aU} - 5\\right)^2} $$\n$$ \\frac{d T_{\\mu, \\mathrm{FG}}}{dU} = \\frac{16\\sqrt{aU} - 20 - 8\\sqrt{aU}}{\\left(4\\sqrt{aU} - 5\\right)^2} = \\frac{8\\sqrt{aU} - 20}{\\left(4\\sqrt{aU} - 5\\right)^2} $$\nThe condition for the temperature to be monotonically non-decreasing is $\\frac{d T_{\\mu, \\mathrm{FG}}}{dU} \\ge 0$. The denominator, being a square, is non-negative. Thus, the sign of the derivative is determined by the numerator. We require:\n$$ 8\\sqrt{aU} - 20 \\ge 0 $$\n$$ 8\\sqrt{aU} \\ge 20 $$\n$$ \\sqrt{aU} \\ge \\frac{20}{8} = \\frac{5}{2} $$\nSince both sides are non-negative, we can square the inequality without changing its direction:\n$$ aU \\ge \\left(\\frac{5}{2}\\right)^2 = \\frac{25}{4} $$\n$$ U \\ge \\frac{25}{4a} $$\nThis result indicates that the function $T_{\\mu, \\mathrm{FG}}(U)$ is non-decreasing for all $U$ in the interval $[\\frac{25}{4a}, \\infty)$. The problem requires that this property holds for the entire FG domain of application, which is $U \\ge U_{x}$. To guarantee this, the starting point $U_x$ must be within the region of non-decreasing temperature. This implies the condition $U_x \\ge \\frac{25}{4a}$.\nWe are looking for the minimal possible matching energy. This corresponds to the smallest possible value for $U_x$ that satisfies the condition. Therefore, the minimal matching effective excitation energy is:\n$$ U_{x}^{\\min} = \\frac{25}{4a} $$\nThe problem asks for the minimal matching excitation energy above the ground state, $E_{x}^{\\min}$. This is related to the effective excitation energy $U_{x}^{\\min}$ by the pairing backshift $\\Delta$:\n$$ E_{x} = U_{x} + \\Delta $$\nSubstituting the expression for $U_{x}^{\\min}$, we find:\n$$ E_{x}^{\\min} = \\frac{25}{4a} + \\Delta $$\nThis is the minimal matching energy, expressed as a function of the level-density parameter $a$ and the pairing backshift $\\Delta$. The parameters $a$ and $\\Delta$ are typically given in units of $\\mathrm{MeV}^{-1}$ and $\\mathrm{MeV}$ respectively, making the resulting $E_{x}^{\\min}$ naturally expressed in $\\mathrm{MeV}$.", "answer": "$$\n\\boxed{\\frac{25}{4a} + \\Delta}\n$$", "id": "3601137"}, {"introduction": "With a solid theoretical motivation for the hybrid model, the next step is to put it into practice and test its validity against experimental data. This exercise guides you through a full implementation of the Gilbert-Cameron model, challenging you to compare its predictions with two distinct types of nuclear data: the known discrete levels at low energy and the average resonance spacing near the neutron separation energy. Successfully completing this task demonstrates a core competency in computational nuclear physics: connecting a theoretical model to real-world observables. [@problem_id:3601162]", "problem": "You are to implement and validate a computational realization of the Gilbert–Cameron level density model by comparing integrated level densities in two energy regions to independent reference quantities. The Gilbert–Cameron construction uses a Constant Temperature (CT) form at low excitation energy and a Fermi Gas (FG) form at higher excitation energy with a back-shift to account for pairing. Your task is to derive the required mathematical expressions from first principles and then encode them in a single program that computes specified validation metrics for a set of test cases.\n\nBegin from the following fundamental bases:\n- The cumulative number of quantum levels up to excitation energy $U$ is $N(U)=\\int_0^{U}\\rho(U')\\,dU'$, where $\\rho(U)$ is the level density in units of inverse megaelectronvolts (MeV$^{-1}$).\n- The Constant Temperature model is motivated by a canonical ensemble with approximately constant nuclear temperature at low excitation energies and must be constructed from the canonical partition function and the relation between microcanonical and canonical ensembles.\n- The Fermi Gas model is motivated by a microcanonical many-fermion counting with saddle-point approximation (Bethe formula) and must incorporate a physically motivated back-shift to represent pairing correlations at low excitation energies.\n- At the neutron separation energy $S_n$, the average $s$-wave resonance spacing $D_0$ (in electronvolts, eV) can be converted to an estimate of the total level density via the spin distribution of states characterized by a spin cutoff parameter $\\sigma$. The spin distribution for a given total spin $J$ must be used to relate the resonance spacing to the density of all available compound-nuclear states of the relevant spins near $U=S_n$.\n\nImplement the following validation computations for each test case:\n1. Compute the integral $\\int_0^{U_m} \\rho_{\\mathrm{CT}}(U)\\,dU$ and compare it to the provided count of known discrete levels $N_d$. Report the fractional deviation defined as $\\delta_{\\mathrm{low}}=\\left(\\int_0^{U_m} \\rho_{\\mathrm{CT}}(U)\\,dU - N_d\\right)/N_d$.\n2. Compute the integral $\\int_{U_m}^{S_n} \\rho_{\\mathrm{FG}}(U)\\,dU$ and compare it to an effective resonance count estimated from resonance data. To construct this reference count, first convert $D_0$ from electronvolts to megaelectronvolts by $D_0^{\\mathrm{MeV}} = D_0^{\\mathrm{eV}}\\times 10^{-6}$. Then, compute the total level density at $U=S_n$ using the spin distribution with cutoff $\\sigma$ and target spin $I$ for $s$-wave capture, where accessible compound-nuclear spins are $J_+=I+\\tfrac{1}{2}$ and $J_-=I-\\tfrac{1}{2}$ (include only nonnegative $J$). Use the canonical spin distribution to obtain the total density factor $g(J,\\sigma)$ and then define $\\rho_{\\mathrm{res}}(S_n)=\\left[D_0^{\\mathrm{MeV}}\\left(g(J_+,\\sigma)+g(J_-,\\sigma)\\right)\\right]^{-1}$. Form an effective reference count by assuming this density is representative across the interval, $N_{\\mathrm{ref}}=\\rho_{\\mathrm{res}}(S_n)\\,\\left(S_n - U_m\\right)$, and report the fractional deviation $\\delta_{\\mathrm{high}}=\\left(\\int_{U_m}^{S_n} \\rho_{\\mathrm{FG}}(U)\\,dU - N_{\\mathrm{ref}}\\right)/N_{\\mathrm{ref}}$.\n\nAdopt the following tolerance criteria for pass/fail flags:\n- Low-energy CT validation passes if $\\left|\\delta_{\\mathrm{low}}\\right|\\le \\tau_{\\mathrm{CT}}$, with $\\tau_{\\mathrm{CT}}=0.1$.\n- High-energy FG validation passes if $\\left|\\delta_{\\mathrm{high}}\\right|\\le \\tau_{\\mathrm{FG}}$, with $\\tau_{\\mathrm{FG}}=0.3$.\n\nUnits and definitions to be strictly used:\n- Energies $U$, $U_m$, $S_n$, $E_0$, and $\\delta$ must be handled in megaelectronvolts (MeV).\n- Level densities $\\rho(U)$ must be in inverse megaelectronvolts (MeV$^{-1}$).\n- The resonance spacing $D_0$ is provided in electronvolts (eV) and must be converted to megaelectronvolts (MeV) using $1\\,\\mathrm{eV}=10^{-6}\\,\\mathrm{MeV}$.\n- The level density parameter $a$ must be handled in $\\mathrm{MeV}^{-1}$.\n- Spins $I$ and $J$ are dimensionless. The spin cutoff parameter $\\sigma$ is dimensionless.\n- Angles do not appear; no angle unit is required.\n- All outputs must be dimensionless numbers or booleans as specified.\n\nYour program must:\n- Derive and implement the Constant Temperature and Fermi Gas forms based solely on the above fundamental bases without relying on shortcut formulas provided in the problem statement.\n- Perform the required integrals with numerical stability and scientific soundness.\n- For each test case, produce a list containing four entries in the order $[\\delta_{\\mathrm{low}},\\delta_{\\mathrm{high}},\\mathrm{pass}_{\\mathrm{low}},\\mathrm{pass}_{\\mathrm{high}}]$, where the first two are floating-point values and the last two are booleans.\n- The final output must be a single line containing a comma-separated list of these per-case lists, enclosed in square brackets, for example, $[\\,[x_1,y_1,\\mathrm{True},\\mathrm{False}],[x_2,y_2,\\mathrm{True},\\mathrm{True}]\\,]$.\n\nTest suite (each case lists parameters in the order: mass number $A$, Constant Temperature parameters $T_{\\mathrm{CT}}$ and $E_0$, Fermi Gas parameters $a$ and $\\delta$, matching energy $U_m$, neutron separation energy $S_n$, discrete-level count $N_d$, target spin $I$, spin cutoff parameter $\\sigma$, average $s$-wave resonance spacing $D_0$):\n- Case $1$: $A=60$, $T_{\\mathrm{CT}}=0.9\\,\\mathrm{MeV}$, $E_0=1.5\\,\\mathrm{MeV}$, $a=7.5\\,\\mathrm{MeV}^{-1}$, $\\delta=1.0\\,\\mathrm{MeV}$, $U_m=4.5\\,\\mathrm{MeV}$, $S_n=8.0\\,\\mathrm{MeV}$, $N_d=28$, $I=0$, $\\sigma=3.0$, $D_0=500\\,\\mathrm{eV}$.\n- Case $2$: $A=95$, $T_{\\mathrm{CT}}=0.7\\,\\mathrm{MeV}$, $E_0=2.0\\,\\mathrm{MeV}$, $a=12.0\\,\\mathrm{MeV}^{-1}$, $\\delta=1.1\\,\\mathrm{MeV}$, $U_m=6.0\\,\\mathrm{MeV}$, $S_n=6.2\\,\\mathrm{MeV}$, $N_d=300$, $I=1.5$, $\\sigma=4.0$, $D_0=200\\,\\mathrm{eV}$.\n- Case $3$: $A=200$, $T_{\\mathrm{CT}}=0.6\\,\\mathrm{MeV}$, $E_0=1.0\\,\\mathrm{MeV}$, $a=25.0\\,\\mathrm{MeV}^{-1}$, $\\delta=1.5\\,\\mathrm{MeV}$, $U_m=2.5\\,\\mathrm{MeV}$, $S_n=5.5\\,\\mathrm{MeV}$, $N_d=12$, $I=0.5$, $\\sigma=6.0$, $D_0=5.0\\,\\mathrm{eV}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case contributing one list in the order described above. For example, the output must be exactly of the form $[[\\delta_{\\mathrm{low}}^{(1)},\\delta_{\\mathrm{high}}^{(1)},\\mathrm{pass}_{\\mathrm{low}}^{(1)},\\mathrm{pass}_{\\mathrm{high}}^{(1)}],[\\delta_{\\mathrm{low}}^{(2)},\\delta_{\\mathrm{high}}^{(2)},\\mathrm{pass}_{\\mathrm{low}}^{(2)},\\mathrm{pass}_{\\mathrm{high}}^{(2)}],[\\delta_{\\mathrm{low}}^{(3)},\\delta_{\\mathrm{high}}^{(3)},\\mathrm{pass}_{\\mathrm{low}}^{(3)},\\mathrm{pass}_{\\mathrm{high}}^{(3)}]]$.", "solution": "The problem statement has been critically reviewed and is determined to be valid. It is scientifically grounded in the principles of nuclear statistical mechanics, specifically the Gilbert-Cameron level density model. The problem is well-posed, providing all necessary parameters and a clear, objective procedure for calculation and validation. It is free of contradictions, ambiguities, and requires the derivation and application of standard, verifiable physical models. We may therefore proceed with the solution.\n\nThe solution requires the derivation and implementation of three core components of nuclear level density theory: the Constant Temperature model, the Fermi Gas model, and the spin distribution of nuclear levels.\n\n**1. Derivation of the Models**\n\n**1.1. Constant Temperature (CT) Model**\nThe CT model is appropriate for low excitation energies where the nucleus exhibits properties analogous to a macroscopic object with a constant temperature. Its form is derived from the fundamental thermodynamic relationship between entropy $S$ and excitation energy $U$, which is $dS/dU = 1/T$, where $T$ is the nuclear temperature. The entropy is related to the level density $\\rho(U)$ via the Boltzmann formula, $S(U) = k_B \\ln(\\Omega(U))$, where $\\Omega(U)$ is the number of states in a small energy interval $\\Delta E$ around $U$, i.e., $\\Omega(U) = \\rho(U)\\Delta E$. For our purposes, we can work with the definition $S(U) \\approx \\ln(\\rho(U))$, absorbing constants.\n\nIf the temperature $T$ is assumed to be constant, $T=T_{\\mathrm{CT}}$, we can integrate the thermodynamic relation:\n$$\n\\frac{dS}{dU} = \\frac{1}{T_{\\mathrm{CT}}} \\implies S(U) = \\frac{U}{T_{\\mathrm{CT}}} + C\n$$\nwhere $C$ is an integration constant. Substituting $S(U) = \\ln(\\rho(U))$:\n$$\n\\ln(\\rho_{\\mathrm{CT}}(U)) = \\frac{U}{T_{\\mathrm{CT}}} + C \\implies \\rho_{\\mathrm{CT}}(U) = e^C e^{U/T_{\\mathrm{CT}}}\n$$\nThis shows the exponential dependence of the level density on energy. To account for the fact that this model should not be applied down to the ground state ($U=0$), an energy shift parameter, $E_0$, is introduced. This parameter effectively shifts the energy scale, representing the energy at which the constant temperature regime begins. The form becomes $\\rho_{\\mathrm{CT}}(U) \\propto \\exp((U-E_0)/T_{\\mathrm{CT}})$. The normalization is conventionally set such that the integral of the level density gives the cumulative number of levels. A common and simple form for the level density is:\n$$\n\\rho_{\\mathrm{CT}}(U) = \\frac{1}{T_{\\mathrm{CT}}} \\exp\\left(\\frac{U - E_0}{T_{\\mathrm{CT}}}\\right)\n$$\nThis is the functional form we shall use.\n\n**1.2. Fermi Gas (FG) Model**\nAt higher excitation energies, the nucleus is better described as a gas of non-interacting fermions (protons and neutrons) occupying single-particle levels. The level density is derived by applying statistical mechanics to this system. The starting point is the calculation of the number of ways to distribute the excitation energy $U$ among the nucleons. Using a saddle-point approximation to evaluate the inverse Laplace transform that connects the partition function to the density of states (the Bethe formula), one arrives at the following expression for the total level density:\n$$\n\\rho(U') = \\frac{\\sqrt{\\pi}}{12 a^{1/4} (U')^{5/4}} \\exp(2\\sqrt{aU'})\n$$\nHere, $a$ is the level density parameter, which is proportional to the single-particle level density at the Fermi surface, and $U'$ is the effective excitation energy. To account for pairing correlations, which are significant at low energies and reduce the number of available states, the excitation energy $U$ is corrected by a back-shift parameter $\\delta$. The effective energy becomes $U' = U - \\delta$. This shift effectively sets the ground state of the Fermi gas model at an energy $\\delta$ above the true nuclear ground state. The final form of the back-shifted Fermi Gas (BSFG) model is:\n$$\n\\rho_{\\mathrm{FG}}(U) = \\frac{\\sqrt{\\pi}}{12 a^{1/4} (U - \\delta)^{5/4}} \\exp(2\\sqrt{a(U - \\delta)})\n$$\nThis formula is valid for $U > \\delta$.\n\n**1.3. Spin Distribution and Resonance Density**\nThe expressions for $\\rho_{\\mathrm{CT}}(U)$ and $\\rho_{\\mathrm{FG}}(U)$ represent the total density of levels, summed over all possible total angular momenta $J$ and both parities. The density of levels with a specific spin $J$ is given by $\\rho(U, J) = \\rho(U) f(J, \\sigma)$, where $f(J, \\sigma)$ is the spin distribution function. For a spherical nucleus, assuming that the projections of the angular momenta of individual nucleons are uncorrelated and normally distributed, the spin distribution is given by:\n$$\nf(J, \\sigma) = \\frac{2J+1}{2\\sigma^2} \\exp\\left(-\\frac{(J+1/2)^2}{2\\sigma^2}\\right)\n$$\nThe problem asks for a function $g(J, \\sigma)$, which we identify with $f(J, \\sigma)$. The quantity $\\sigma$ is the spin cutoff parameter, which characterizes the width of the spin distribution and is energy-dependent, but for this problem, it is treated as a constant parameter evaluated at $S_n$.\n\nAt the neutron separation energy $S_n$, experimental data from slow neutron resonances provide a measure of the level density. For $s$-wave ($l=0$) neutrons bombarding a target nucleus with spin $I$, the compound nucleus can be formed with total spins $J_+ = I + 1/2$ and $J_- = |I - 1/2|$ (or just $J_- = I-1/2$ for $I \\ge 1/2$). The experimentally observed average spacing of these resonances, $D_0$, is the inverse of the density of levels with these specific spins:\n$$\n\\frac{1}{D_0^{\\mathrm{MeV}}} = \\sum_{J \\in \\{J_+, J_-\\}, J \\ge 0} \\rho(S_n, J) = \\rho(S_n) \\sum_{J \\in \\{J_+, J_-\\}, J \\ge 0} g(J, \\sigma)\n$$\nFrom this, one can infer the total level density at $S_n$ from the resonance data:\n$$\n\\rho_{\\mathrm{res}}(S_n) = \\frac{1}{D_0^{\\mathrm{MeV}} \\left( \\sum_{J \\in \\{J_+, J_-\\}, J \\ge 0} g(J, \\sigma) \\right)}\n$$\nNote that for a target with spin $I=0$, $J_+=1/2$ and $J_-=-1/2$. As spin must be non-negative, only the $J=1/2$ states are considered.\n\n**2. Validation Computations**\n\nFor each test case, we perform two validation calculations.\n\n**2.1. Low-Energy Validation ($\\delta_{\\mathrm{low}}$)**\nWe calculate the cumulative number of levels predicted by the CT model up to the matching energy $U_m$ and compare it to the known number of discrete levels, $N_d$.\nThe predicted number is the integral of the CT density:\n$$\nN_{\\mathrm{CT}} = \\int_0^{U_m} \\rho_{\\mathrm{CT}}(U) \\, dU = \\int_0^{U_m} \\frac{1}{T_{\\mathrm{CT}}} \\exp\\left(\\frac{U - E_0}{T_{\\mathrm{CT}}}\\right) \\, dU\n$$\nThis integral is analytic:\n$$\nN_{\\mathrm{CT}} = \\left[ \\exp\\left(\\frac{U - E_0}{T_{\\mathrm{CT}}}\\right) \\right]_0^{U_m} = \\exp\\left(\\frac{U_m - E_0}{T_{\\mathrm{CT}}}\\right) - \\exp\\left(\\frac{-E_0}{T_{\\mathrm{CT}}}\\right)\n$$\nThe fractional deviation is then computed as $\\delta_{\\mathrm{low}} = (N_{\\mathrm{CT}} - N_d) / N_d$. The validation passes if $|\\delta_{\\mathrm{low}}| \\le \\tau_{\\mathrm{CT}} = 0.1$.\n\n**2.2. High-Energy Validation ($\\delta_{\\mathrm{high}}$)**\nWe calculate the number of levels in the energy range from $U_m$ to $S_n$ using the FG model and compare it to a reference count derived from resonance data.\nThe number of levels from the FG model is:\n$$\nN_{\\mathrm{FG}} = \\int_{U_m}^{S_n} \\rho_{\\mathrm{FG}}(U) \\, dU = \\int_{U_m}^{S_n} \\frac{\\sqrt{\\pi}}{12 a^{1/4} (U - \\delta)^{5/4}} \\exp(2\\sqrt{a(U - \\delta)}) \\, dU\n$$\nThis integral must be computed numerically.\nThe reference count is constructed by first calculating $\\rho_{\\mathrm{res}}(S_n)$ as derived above, using the provided parameters $D_0$, $I$, and $\\sigma$. Then, an effective reference count $N_{\\mathrm{ref}}$ is estimated by assuming this density is representative of the average density over the interval $[U_m, S_n]$:\n$$\nN_{\\mathrm{ref}} = \\rho_{\\mathrm{res}}(S_n) \\times (S_n - U_m)\n$$\nThe fractional deviation is $\\delta_{\\mathrm{high}} = (N_{\\mathrm{FG}} - N_{\\mathrm{ref}}) / N_{\\mathrm{ref}}$. The validation passes if $|\\delta_{\\mathrm{high}}| \\le \\tau_{\\mathrm{FG}} = 0.3$.\n\nThe implementation will now proceed following these derived formulae and computational steps.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Implements and validates the Gilbert-Cameron level density model.\n    \"\"\"\n    \n    # Test cases: A, T_CT, E0, a, delta, Um, Sn, Nd, I, sigma, D0\n    test_cases = [\n        # Case 1: A=60, T_CT=0.9, E0=1.5, a=7.5, delta=1.0, Um=4.5, Sn=8.0, Nd=28, I=0, sigma=3.0, D0=500\n        (60, 0.9, 1.5, 7.5, 1.0, 4.5, 8.0, 28, 0.0, 3.0, 500.0),\n        # Case 2: A=95, T_CT=0.7, E0=2.0, a=12.0, delta=1.1, Um=6.0, Sn=6.2, Nd=300, I=1.5, sigma=4.0, D0=200\n        (95, 0.7, 2.0, 12.0, 1.1, 6.0, 6.2, 300, 1.5, 4.0, 200.0),\n        # Case 3: A=200, T_CT=0.6, E0=1.0, a=25.0, delta=1.5, Um=2.5, Sn=5.5, Nd=12, I=0.5, sigma=6.0, D0=5.0\n        (200, 0.6, 1.0, 25.0, 1.5, 2.5, 5.5, 12, 0.5, 6.0, 5.0),\n    ]\n\n    results = []\n    \n    # Tolerance criteria\n    tau_ct = 0.1\n    tau_fg = 0.3\n\n    def g_spin_dist(J, sigma):\n        \"\"\"\n        Calculates the spin distribution factor g(J, sigma).\n        \"\"\"\n        if sigma <= 0:\n            return 0.0\n        return (2 * J + 1) / (2 * sigma**2) * np.exp(-(J + 0.5)**2 / (2 * sigma**2))\n\n    def rho_fg(U, a, delta):\n        \"\"\"\n        Calculates the Fermi Gas level density rho_FG(U).\n        \"\"\"\n        U_eff = U - delta\n        if U_eff <= 0:\n            # Below the effective ground state, density is zero.\n            return 0.0\n        \n        numerator = np.exp(2 * np.sqrt(a * U_eff)) * np.sqrt(np.pi)\n        denominator = 12 * (a**0.25) * (U_eff**1.25)\n        \n        if denominator == 0:\n            return np.inf\n\n        return numerator / denominator\n\n    for case in test_cases:\n        A, T_CT, E0, a, delta, Um, Sn, Nd, I, sigma, D0 = case\n\n        # 1. Low-energy validation (CT model)\n        # Analytically integrated level count from the CT model\n        N_ct = np.exp((Um - E0) / T_CT) - np.exp(-E0 / T_CT)\n        \n        # Fractional deviation\n        if Nd == 0:\n            delta_low = np.inf if N_ct != 0 else 0.0\n        else:\n            delta_low = (N_ct - Nd) / Nd\n        \n        pass_low = abs(delta_low) <= tau_ct\n\n        # 2. High-energy validation (FG model)\n        # Numerically integrate FG density\n        N_fg, _ = integrate.quad(rho_fg, Um, Sn, args=(a, delta))\n\n        # Construct reference count from resonance data\n        # Convert D0 from eV to MeV\n        D0_mev = D0 * 1e-6\n        \n        # Calculate sum of spin distribution factors\n        J_plus = I + 0.5\n        J_minus = I - 0.5\n        \n        g_sum = g_spin_dist(J_plus, sigma)\n        if J_minus >= 0:\n            g_sum += g_spin_dist(J_minus, sigma)\n            \n        # Calculate total level density at Sn from resonance data\n        if D0_mev <= 0 or g_sum <= 0:\n            rho_res_sn = np.inf\n        else:\n            rho_res_sn = 1.0 / (D0_mev * g_sum)\n        \n        # Estimate reference count\n        N_ref = rho_res_sn * (Sn - Um)\n\n        # Fractional deviation\n        if N_ref == 0:\n            delta_high = np.inf if N_fg != 0 else 0.0\n        else:\n            delta_high = (N_fg - N_ref) / N_ref\n            \n        pass_high = abs(delta_high) <= tau_fg\n        \n        results.append([delta_low, delta_high, pass_low, pass_high])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3601162"}, {"introduction": "A successful level density model can be used to derive other important thermodynamic quantities, such as the microcanonical heat capacity. However, the simple joining of the Constant-Temperature and Fermi-Gas models creates unphysical discontinuities in the derivatives of the entropy, which manifest as singularities in the heat capacity. This advanced practice challenges you to compute the heat capacity and implement a sophisticated smoothing technique to create a more physically realistic and numerically robust model. [@problem_id:3601178]", "problem": "You are to implement, analyze, and quantify the microcanonical heat capacity in the Gilbert–Cameron hybrid level-density model by blending the slopes of the Constant-Temperature and Fermi-Gas regimes. All mathematical symbols, variables, functions, operators, and numbers must be interpreted in the usual physics sense. Use Energy in megaelectronvolts (MeV) and Temperature in megaelectronvolts (MeV), with Boltzmann’s constant set to unity, so that the microcanonical heat capacity is dimensionless.\n\nStarting point and definitions:\n- The microcanonical entropy is defined as $S(U)=\\ln \\rho(U)$, where $\\rho(U)$ is the level density as a function of excitation energy $U$.\n- The microcanonical temperature is defined by $T_{\\mu}(U)=\\left(\\dfrac{dS}{dU}\\right)^{-1}$.\n- The microcanonical heat capacity is defined by $C(U)=\\dfrac{dU}{dT_{\\mu}(U)}$.\n- In the Constant-Temperature (CT) branch, take $S_{\\mathrm{CT}}(U)=\\dfrac{U-E_{0}}{T_{c}}+\\mathrm{const}$ where $T_{c}>0$ is constant and $E_{0}$ is an offset that does not affect derivatives.\n- In the Fermi-Gas (FG) branch with back-shift $\\Delta$ and level-density parameter $a>0$, use the well-tested leading-asymptotic expression for the entropy,\n$$\nS_{\\mathrm{FG}}(U)=2\\sqrt{a\\,(U-\\Delta)}-\\frac{5}{4}\\ln(U-\\Delta)+\\mathrm{const}\\quad \\text{for } U>\\Delta,\n$$\nwhich yields a slope (microcanonical inverse temperature) that is well-defined for $U>\\Delta$.\n\nConstruct the Gilbert–Cameron (GC) hybrid as follows:\n- Let the hybrid transition (matching) energy be $U_{x}$ with $U_{x}>\\Delta$. Define the unsmoothed hybrid slope (microcanonical inverse temperature) $\\beta_{\\mathrm{hyb}}(U)=\\dfrac{dS}{dU}$ piecewise by the CT slope below $U_{x}$ and the FG slope above $U_{x}$, enforcing continuity of the slope at $U_{x}$ by the choice of $T_{c}$:\n$$\n\\beta_{\\mathrm{CT}}=\\frac{1}{T_{c}},\\quad \\beta_{\\mathrm{FG}}(U)=\\frac{dS_{\\mathrm{FG}}}{dU},\\quad \\beta_{\\mathrm{hyb}}(U)=\n\\begin{cases}\n\\beta_{\\mathrm{CT}}, & U\\le U_{x},\\\\\n\\beta_{\\mathrm{FG}}(U), & U>U_{x},\n\\end{cases}\n$$\nwith $T_{c}=\\left[\\beta_{\\mathrm{FG}}(U_{x})\\right]^{-1}$ so that $\\beta_{\\mathrm{CT}}=\\beta_{\\mathrm{FG}}(U_{x})$.\n- The smoothed slope $\\beta_{\\mathrm{sm}}(U)$ is to be constructed by a hyperbolic-tangent blending of slopes across a width parameter $\\Delta_{U}>0$:\n$$\nw(U)=\\frac{1}{2}\\left[1-\\tanh\\!\\left(\\frac{U-U_{x}}{\\Delta_{U}}\\right)\\right],\\qquad\n\\beta_{\\mathrm{sm}}(U)=w(U)\\,\\beta_{\\mathrm{CT}}+\\left[1-w(U)\\right]\\beta_{\\mathrm{FG}}(U).\n$$\n\nTasks:\n1) From the above foundations, derive a formula for $T_{\\mu}(U)$ and $C(U)$ in terms of $\\beta(U)=\\dfrac{dS}{dU}$ and its derivative $\\beta'(U)=\\dfrac{d^{2}S}{dU^{2}}$, and implement both the unsmoothed hybrid and the smoothed (tanh-blended) case. All energies must be in $\\mathrm{MeV}$ and all temperatures in $\\mathrm{MeV}$; report heat capacities as dimensionless.\n2) For the FG branch, starting from $S_{\\mathrm{FG}}(U)$ given above, compute analytically $\\beta_{\\mathrm{FG}}(U)$ and $\\beta'_{\\mathrm{FG}}(U)$ for $U>\\Delta$. Use these to define both the unsmoothed and smoothed hybrids. For the CT branch, note that $\\beta_{\\mathrm{CT}}$ is constant and its derivative is zero.\n3) Using a uniform energy grid $U\\in[U_{x}-W,\\,U_{x}+W]$ with $N$ points, where $N$ is a positive integer and $W>0$ is chosen per test case, evaluate the following quantitative diagnostics that assess discontinuity removal by smoothing:\n   - The unsmoothed hybrid derivative jump at the transition,\n     $$\n     J_{1}=\\left|\\beta'_{\\mathrm{hyb}}(U_{x}^{-})-\\beta'_{\\mathrm{hyb}}(U_{x}^{+})\\right|.\n     $$\n   - The corresponding smoothed hybrid one-sided derivative mismatch across the transition, approximated by a small symmetric offset $\\varepsilon>0$,\n     $$\n     J_{2}=\\left|\\beta'_{\\mathrm{sm}}(U_{x}-\\varepsilon)-\\beta'_{\\mathrm{sm}}(U_{x}+\\varepsilon)\\right|.\n     $$\n   - A boolean indicating whether any microcanonical heat capacity value is non-finite on the grid for the unsmoothed hybrid (use the exact analytic derivatives; if division by zero occurs, treat it as non-finite).\n   - A boolean indicating whether any microcanonical heat capacity value is non-finite on the grid for the smoothed hybrid.\n   - The maximum absolute value of the smoothed microcanonical heat capacity on the grid, restricted to finite values.\n   - The microcanonical temperature continuity error at the transition for the unsmoothed hybrid,\n     $$\n     \\Delta T=\\left|T_{\\mu}(U_{x}-\\varepsilon)-T_{\\mu}(U_{x}+\\varepsilon)\\right|.\n     $$\n   Use $\\varepsilon$ that is small compared with $\\Delta_{U}$ and $W$.\n4) Your implementation must use the following fixed numerical settings across all test cases to ensure consistent evaluation: choose $N=2001$ points uniformly across the window and set $\\varepsilon=10^{-6}\\,\\mathrm{MeV}$. All computations must be carried out in $\\mathrm{MeV}$.\n5) For each test case below, compute and return a list of the six diagnostics in the order specified above. Aggregate the results for all cases into a single list.\n\nTest suite (each tuple is $(a,\\Delta,U_{x},\\Delta_{U},W)$, with all energies in $\\mathrm{MeV}$ and $a$ in $\\mathrm{MeV}^{-1}$):\n- Case A: $(12.5,\\,1.0,\\,8.0,\\,0.5,\\,3.0)$.\n- Case B: $(20.0,\\,1.2,\\,6.0,\\,0.4,\\,2.0)$.\n- Case C: $(5.0,\\,1.8,\\,3.0,\\,0.3,\\,0.9)$.\n- Case D: $(25.0,\\,0.8,\\,12.0,\\,0.8,\\,4.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a list in the order $[J_{1},J_{2},\\text{any\\_inf\\_unsmoothed},\\text{any\\_inf\\_smoothed},\\max|C|_{\\mathrm{smoothed}},\\Delta T]$. For example, a valid output for two cases would look like $[[x_{1},x_{2},b_{1},b_{2},x_{3},x_{4}],[y_{1},y_{2},b_{3},b_{4},y_{3},y_{4}]]$ with $x_{i},y_{i}$ real numbers and $b_{i}$ booleans.", "solution": "The problem requires the implementation and analysis of the microcanonical heat capacity, $C(U)$, within the Gilbert-Cameron (GC) hybrid level-density model. This involves deriving expressions for physical quantities, constructing unsmoothed and smoothed versions of the model, and calculating a set of diagnostics for given parameter sets.\n\n**Task 1: General Formulas for Temperature and Heat Capacity**\n\nThe microcanonical entropy is given as $S(U) = \\ln \\rho(U)$, where $\\rho(U)$ is the level density at excitation energy $U$. The inverse microcanonical temperature, $\\beta(U)$, is the slope of the entropy:\n$$\n\\beta(U) = \\frac{dS}{dU}\n$$\nFrom this definition, the microcanonical temperature $T_{\\mu}(U)$ is immediately found to be:\n$$\nT_{\\mu}(U) = \\left(\\frac{dS}{dU}\\right)^{-1} = \\frac{1}{\\beta(U)}\n$$\nThe microcanonical heat capacity is defined as $C(U) = \\frac{dU}{dT_{\\mu}(U)}$. To express this in terms of $\\beta(U)$ and its derivative $\\beta'(U) = \\frac{d\\beta}{dU}$, we first compute the derivative of $T_{\\mu}(U)$ with respect to $U$ using the chain rule:\n$$\n\\frac{dT_{\\mu}}{dU} = \\frac{d}{dU}\\left(\\frac{1}{\\beta(U)}\\right) = -\\frac{1}{\\beta(U)^2} \\frac{d\\beta}{dU} = -\\frac{\\beta'(U)}{\\beta(U)^2}\n$$\nThe heat capacity is the reciprocal of this quantity:\n$$\nC(U) = \\left(\\frac{dT_{\\mu}}{dU}\\right)^{-1} = -\\frac{\\beta(U)^2}{\\beta'(U)}\n$$\nThis fundamental relationship allows the calculation of the heat capacity for any model where $\\beta(U)$ and its derivative $\\beta'(U)$ are known.\n\n**Task 2: Analytical Derivatives for the Fermi-Gas (FG) Model**\n\nThe Fermi-Gas (FG) entropy for $U > \\Delta$ is given by:\n$$\nS_{\\mathrm{FG}}(U) = 2\\sqrt{a(U-\\Delta)} - \\frac{5}{4}\\ln(U-\\Delta) + \\mathrm{const}\n$$\nwhere $a > 0$ is the level-density parameter and $\\Delta$ is the back-shift.\n\nThe first derivative, $\\beta_{\\mathrm{FG}}(U) = \\frac{dS_{\\mathrm{FG}}}{dU}$, is found by differentiating with respect to $U$:\n$$\n\\beta_{\\mathrm{FG}}(U) = \\frac{d}{dU} \\left[ 2\\sqrt{a}(U-\\Delta)^{1/2} - \\frac{5}{4}\\ln(U-\\Delta) \\right]\n$$\n$$\n\\beta_{\\mathrm{FG}}(U) = 2\\sqrt{a} \\cdot \\frac{1}{2}(U-\\Delta)^{-1/2} - \\frac{5}{4}(U-\\Delta)^{-1} = \\sqrt{\\frac{a}{U-\\Delta}} - \\frac{5}{4(U-\\Delta)}\n$$\nThe second derivative, $\\beta'_{\\mathrm{FG}}(U) = \\frac{d\\beta_{\\mathrm{FG}}}{dU}$, is found by differentiating $\\beta_{\\mathrm{FG}}(U)$:\n$$\n\\beta'_{\\mathrm{FG}}(U) = \\frac{d}{dU} \\left[ \\sqrt{a}(U-\\Delta)^{-1/2} - \\frac{5}{4}(U-\\Delta)^{-1} \\right]\n$$\n$$\n\\beta'_{\\mathrm{FG}}(U) = \\sqrt{a} \\left(-\\frac{1}{2}\\right)(U-\\Delta)^{-3/2} - \\frac{5}{4}(-1)(U-\\Delta)^{-2} = -\\frac{\\sqrt{a}}{2(U-\\Delta)^{3/2}} + \\frac{5}{4(U-\\Delta)^2}\n$$\nFor the Constant-Temperature (CT) branch, the entropy is $S_{\\mathrm{CT}}(U) = \\frac{U-E_0}{T_c} + \\mathrm{const}$. The inverse temperature is constant, $\\beta_{\\mathrm{CT}} = \\frac{1}{T_c}$, and its derivative is zero, $\\beta'_{\\mathrm{CT}} = 0$.\n\n**Hybrid Model Construction**\n\nThe problem specifies two hybrid models based on these components.\n\n*   **Unsmoothed Hybrid Model:** The inverse temperature $\\beta_{\\mathrm{hyb}}(U)$ is defined piecewise. For $U \\le U_x$, it uses the CT form, and for $U > U_x$, it uses the FG form. Continuity of $\\beta(U)$ at the matching energy $U_x$ is enforced by setting $\\beta_{\\mathrm{CT}} = \\beta_{\\mathrm{FG}}(U_x)$. The derivative, $\\beta'_{\\mathrm{hyb}}(U)$, is consequently discontinuous:\n    $$\n    \\beta'_{\\mathrm{hyb}}(U) = \\begin{cases} \\beta'_{\\mathrm{CT}} = 0, & U < U_{x} \\\\ \\beta'_{\\mathrm{FG}}(U), & U > U_{x} \\end{cases}\n    $$\n    At $U=U_x$, the derivative is undefined due to the jump.\n\n*   **Smoothed Hybrid Model:** To remove the discontinuity in the derivative, a hyperbolic-tangent smoothing is introduced. The smoothed inverse temperature $\\beta_{\\mathrm{sm}}(U)$ is a weighted average of the CT and FG slopes:\n    $$\n    \\beta_{\\mathrm{sm}}(U) = w(U)\\beta_{\\mathrm{CT}} + [1-w(U)]\\beta_{\\mathrm{FG}}(U)\n    $$\n    where the weighting function is $w(U) = \\frac{1}{2}\\left[1-\\tanh\\left(\\frac{U-U_x}{\\Delta_U}\\right)\\right]$. Its derivative is $w'(U) = -\\frac{1}{2\\Delta_U}\\text{sech}^2\\left(\\frac{U-U_x}{\\Delta_U}\\right)$.\n    Using the product rule, the derivative $\\beta'_{\\mathrm{sm}}(U)$ is:\n    $$\n    \\beta'_{\\mathrm{sm}}(U) = \\frac{d}{dU}\\left(w(U)\\beta_{\\mathrm{CT}} + [1-w(U)]\\beta_{\\mathrm{FG}}(U)\\right)\n    $$\n    $$\n    \\beta'_{\\mathrm{sm}}(U) = w'(U)\\beta_{\\mathrm{CT}} - w'(U)\\beta_{\\mathrm{FG}}(U) + [1-w(U)]\\beta'_{\\mathrm{FG}}(U)\n    $$\n    $$\n    \\beta'_{\\mathrm{sm}}(U) = w'(U)[\\beta_{\\mathrm{CT}} - \\beta_{\\mathrm{FG}}(U)] + [1-w(U)]\\beta'_{\\mathrm{FG}}(U)\n    $$\n    This expression is continuous and well-defined everywhere, provided $U > \\Delta$.\n\n**Tasks 3-5: Diagnostic Calculations**\n\nFor each test case $(a, \\Delta, U_x, \\Delta_U, W)$, the following six diagnostics are computed on a uniform energy grid $U \\in [U_x - W, U_x + W]$ with $N=2001$ points and using $\\varepsilon=10^{-6}\\,\\mathrm{MeV}$.\n\n1.  **$J_1$: Unsmoothed Derivative Jump:** This measures the magnitude of the discontinuity in $\\beta'_{\\mathrm{hyb}}(U)$ at $U_x$.\n    $$\n    J_1 = |\\beta'_{\\mathrm{hyb}}(U_x^{-}) - \\beta'_{\\mathrm{hyb}}(U_x^{+})| = |0 - \\beta'_{\\mathrm{FG}}(U_x)| = |\\beta'_{\\mathrm{FG}}(U_x)|\n    $$\n    We calculate this using the analytical formula for $\\beta'_{\\mathrm{FG}}(U)$.\n\n2.  **$J_2$: Smoothed Derivative Mismatch:** This approximates the sharpness of the change in the smoothed derivative across $U_x$.\n    $$\n    J_2 = |\\beta'_{\\mathrm{sm}}(U_x - \\varepsilon) - \\beta'_{\\mathrm{sm}}(U_x + \\varepsilon)|\n    $$\n    We compute this using the analytical formula for $\\beta'_{\\mathrm{sm}}(U)$ evaluated at the two specified points.\n\n3.  **Non-finite $C(U)$ in Unsmoothed Hybrid:** The unsmoothed heat capacity is $C_{\\mathrm{hyb}}(U) = -\\beta_{\\mathrm{hyb}}(U)^2 / \\beta'_{\\mathrm{hyb}}(U)$. For the entire CT branch ($U \\le U_x$), $\\beta'_{\\mathrm{hyb}}(U) = 0$. Since the energy grid includes this region, division by zero will occur. Thus, this diagnostic will always be `True`.\n\n4.  **Non-finite $C(U)$ in Smoothed Hybrid:** The smoothed heat capacity is $C_{\\mathrm{sm}}(U) = -\\beta_{\\mathrm{sm}}(U)^2 / \\beta'_{\\mathrm{sm}}(U)$. Non-finite values arise if $\\beta'_{\\mathrm{sm}}(U)$ becomes zero at any point on the grid. This is checked numerically by calculating $C_{\\mathrm{sm}}(U)$ across the grid and testing for the presence of `inf` or `nan` values.\n\n5.  **Maximum Absolute Smoothed Heat Capacity:** This is $\\max|C_{\\mathrm{sm}}(U)|$ calculated over all grid points where $C_{\\mathrm{sm}}(U)$ is finite.\n\n6.  **$\\Delta T$: Temperature Continuity Error:** This measures the change in temperature for the unsmoothed model across $U_x$ over a small interval $2\\varepsilon$.\n    $$\n    \\Delta T = |T_{\\mu}(U_x - \\varepsilon) - T_{\\mu}(U_x + \\varepsilon)|\n    $$\n    For the unsmoothed hybrid, $T_{\\mu}(U_x - \\varepsilon) = 1/\\beta_{\\mathrm{hyb}}(U_x - \\varepsilon) = 1/\\beta_{\\mathrm{CT}}$ and $T_{\\mu}(U_x + \\varepsilon) = 1/\\beta_{\\mathrm{hyb}}(U_x + \\varepsilon) = 1/\\beta_{\\mathrm{FG}}(U_x+\\varepsilon)$. Since $\\beta_{\\mathrm{CT}} = \\beta_{\\mathrm{FG}}(U_x)$, this becomes:\n    $$\n    \\Delta T = \\left|\\frac{1}{\\beta_{\\mathrm{FG}}(U_x)} - \\frac{1}{\\beta_{\\mathrm{FG}}(U_x+\\varepsilon)}\\right|\n    $$\n    This value is computed directly using the formula for $\\beta_{\\mathrm{FG}}(U)$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and analyzes the microcanonical heat capacity in the\n    Gilbert-Cameron hybrid level-density model.\n    \"\"\"\n\n    # Helper functions for Fermi-Gas (FG) model quantities\n    def beta_fg(U, a, delta):\n        \"\"\"Calculates beta_FG(U) = dS_FG/dU.\"\"\"\n        term = U - delta\n        # Ensure term > 0 for physical validity\n        safe_term = np.where(term > 0, term, np.nan)\n        return np.sqrt(a / safe_term) - (5.0 / 4.0) / safe_term\n\n    def beta_prime_fg(U, a, delta):\n        \"\"\"Calculates beta'_FG(U) = d^2S_FG/dU^2.\"\"\"\n        term = U - delta\n        # Ensure term > 0 for physical validity\n        safe_term = np.where(term > 0, term, np.nan)\n        return -0.5 * np.sqrt(a) * safe_term**(-1.5) + (5.0 / 4.0) * safe_term**(-2.0)\n\n    # Helper functions for the smoothed model\n    def w_func(U, Ux, delta_U):\n        \"\"\"Calculates the smoothing weight function w(U).\"\"\"\n        return 0.5 * (1.0 - np.tanh((U - Ux) / delta_U))\n\n    def w_prime_func(U, Ux, delta_U):\n        \"\"\"Calculates the derivative of the weight function w'(U).\"\"\"\n        arg = (U - Ux) / delta_U\n        return -0.5 / delta_U * (1.0 / np.cosh(arg))**2\n\n    def beta_sm(U, Ux, delta_U, a, delta, beta_ct):\n        \"\"\"Calculates the smoothed inverse temperature beta_sm(U).\"\"\"\n        w = w_func(U, Ux, delta_U)\n        b_fg = beta_fg(U, a, delta)\n        return w * beta_ct + (1.0 - w) * b_fg\n\n    def beta_prime_sm(U, Ux, delta_U, a, delta, beta_ct):\n        \"\"\"Calculates the derivative of the smoothed inverse temperature beta'_sm(U).\"\"\"\n        w = w_func(U, Ux, delta_U)\n        w_p = w_prime_func(U, Ux, delta_U)\n        b_fg = beta_fg(U, a, delta)\n        b_p_fg = beta_prime_fg(U, a, delta)\n        return w_p * (beta_ct - b_fg) + (1.0 - w) * b_p_fg\n\n    # Fixed numerical settings\n    N = 2001\n    epsilon = 1.0e-6\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, delta, Ux, delta_U, W)\n        (12.5, 1.0, 8.0, 0.5, 3.0),  # Case A\n        (20.0, 1.2, 6.0, 0.4, 2.0),  # Case B\n        (5.0, 1.8, 3.0, 0.3, 0.9),   # Case C\n        (25.0, 0.8, 12.0, 0.8, 4.0), # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        a, delta, Ux, delta_U, W = case\n\n        # --- Diagnostic 1: J1 (Unsmoothed derivative jump) ---\n        # J1 = |beta'_hyb(Ux-) - beta'_hyb(Ux+)| = |0 - beta'_fg(Ux)|\n        beta_p_fg_at_Ux = beta_prime_fg(Ux, a, delta)\n        J1 = np.abs(beta_p_fg_at_Ux)\n\n        # --- Diagnostic 2: J2 (Smoothed derivative mismatch) ---\n        # J2 = |beta'_sm(Ux - eps) - beta'_sm(Ux + eps)|\n        beta_ct = beta_fg(Ux, a, delta)\n        beta_p_sm_minus = beta_prime_sm(Ux - epsilon, Ux, delta_U, a, delta, beta_ct)\n        beta_p_sm_plus = beta_prime_sm(Ux + epsilon, Ux, delta_U, a, delta, beta_ct)\n        J2 = np.abs(beta_p_sm_minus - beta_p_sm_plus)\n\n        # --- Diagnostic 3: any_inf_unsmoothed ---\n        # C_unsmoothed = -beta_hyb^2 / beta'_hyb. For U <= Ux, beta'_hyb is 0.\n        # The grid always contains points <= Ux, causing division by zero.\n        any_inf_unsmoothed = True\n\n        # --- Diagnostics 4 & 5: Smoothed heat capacity analysis ---\n        U_grid = np.linspace(Ux - W, Ux + W, N)\n        \n        # Calculate smoothed beta and its derivative on the grid\n        b_sm_grid = beta_sm(U_grid, Ux, delta_U, a, delta, beta_ct)\n        b_p_sm_grid = beta_prime_sm(U_grid, Ux, delta_U, a, delta, beta_ct)\n        \n        # Calculate smoothed heat capacity, ignoring division by zero warnings\n        with np.errstate(divide='ignore', invalid='ignore'):\n            C_sm_grid = -np.square(b_sm_grid) / b_p_sm_grid\n            \n        # Diagnostic 4: any_inf_smoothed\n        any_inf_smoothed = not np.all(np.isfinite(C_sm_grid))\n        \n        # Diagnostic 5: max|C|_smoothed\n        finite_C_sm = C_sm_grid[np.isfinite(C_sm_grid)]\n        if finite_C_sm.size > 0:\n            max_abs_C_smoothed = np.max(np.abs(finite_C_sm))\n        else:\n            max_abs_C_smoothed = 0.0\n\n        # --- Diagnostic 6: Delta T (Temperature continuity error) ---\n        # Delta T = |T_mu(Ux - eps) - T_mu(Ux + eps)| for unsmoothed hybrid\n        # T_mu(U) = 1/beta_hyb(U). T_mu(Ux - eps) = 1/beta_ct\n        T_mu_minus = 1.0 / beta_ct \n        # T_mu(Ux + eps) = 1/beta_fg(Ux + eps)\n        T_mu_plus = 1.0 / beta_fg(Ux + epsilon, a, delta)\n        delta_T = np.abs(T_mu_minus - T_mu_plus)\n        \n        # Assemble results for the current test case\n        case_results = [J1, J2, any_inf_unsmoothed, any_inf_smoothed, max_abs_C_smoothed, delta_T]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default string representation of lists in Python matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3601178"}]}