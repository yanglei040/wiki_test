{"hands_on_practices": [{"introduction": "The single-folding model provides a powerful bridge between nuclear structure, encapsulated in the nucleon density $\\rho(\\mathbf{r})$, and nuclear reaction dynamics, described by the optical potential $U(\\mathbf{r},E)$. This first exercise provides foundational practice in implementing this model, starting from a given effective interaction and target density. By calculating the volume integral $J_V(E)$, a key bulk property of the potential, you will discover a crucial analytical simplification and learn to benchmark your microscopic result against established phenomenological values [@problem_id:3569722].", "problem": "You are given a microscopic folding representation of the central optical potential for nucleon scattering from a spherical nucleus based on an effective interaction (the $g$-matrix) and the nuclear ground-state density. The optical potential is defined by the three-dimensional spatial convolution\n$$\nU(\\mathbf{r},E) = \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big),\n$$\nwhere $U(\\mathbf{r},E)$ is the complex optical potential at projectile energy $E$, $\\rho(\\mathbf{r})$ is the ground-state density of the target, and $g(s;E)$ is the central part of the effective nucleon-nucleon interaction (the $g$-matrix) at separation $s$ and energy $E$. The central volume integral to be computed is\n$$\nJ_V(E) = \\int d^3 r \\,\\Re U(\\mathbf{r},E),\n$$\nwhere $\\Re U(\\mathbf{r},E)$ denotes the real part of $U(\\mathbf{r},E)$. All quantities must be treated in a spherically symmetric approximation, and all final numerical answers for $J_V(E)$ must be expressed in $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$.\n\nFor the calcium-40 ($^{40}\\mathrm{Ca}$) target, use the following physically consistent model inputs:\n\n1. The ground-state density is a two-parameter Fermi (also known as Woods-Saxon) form,\n$$\n\\rho(r) = \\frac{\\rho_0}{1+\\exp\\left(\\frac{r-c}{a}\\right)},\n$$\nwith $c=3.67\\,\\mathrm{fm}$ and $a=0.55\\,\\mathrm{fm}$. The parameter $\\rho_0$ must be determined by the normalization condition\n$$\n\\int d^3 r \\,\\rho(r) = A,\n$$\nwith $A=40$. You must compute $\\rho_0$ numerically so that the normalized density integrates to $A$ within the numerical accuracy of your quadrature.\n\n2. The real central part of the effective interaction (the $g$-matrix) is modeled as a single-range Gaussian with energy dependence,\n$$\n\\Re g(s;E) = V_0(E)\\,\\exp\\!\\left(-\\frac{s^2}{\\beta^2}\\right),\n$$\nwhere $\\beta = 1.0\\,\\mathrm{fm}$, $V_0(E)$ is the energy-dependent strength given by\n$$\nV_0(E) = \\frac{V_{00}}{1 + E/E_0},\n$$\nwith $V_{00} = -120\\,\\mathrm{MeV}$ and $E_0 = 100\\,\\mathrm{MeV}$. The imaginary part of $g(s;E)$ is not needed for this task.\n\nYour task is to implement a numerically stable computation of $J_V(E)$, using spherically symmetric radial quadratures on a finite domain $[0,R_{\\max}]$ with a uniform step $dr$. All intermediate radial integrations should be performed using standard numerical quadrature on the chosen grid. Ensure numerical convergence by choosing physically reasonable $R_{\\max}$ and $dr$ values as specified in the test suite. Report $J_V(E)$ and derived quantities in the units $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$ as required.\n\nTest Suite. Your program must compute the following outputs for the parameter values listed below:\n\n- Use $R_{\\max} = 12\\,\\mathrm{fm}$ throughout unless otherwise specified.\n- Use the $^{40}\\mathrm{Ca}$ parameters $A=40$, $c=3.67\\,\\mathrm{fm}$, $a=0.55\\,\\mathrm{fm}$, $\\beta=1.0\\,\\mathrm{fm}$, $V_{00}=-120\\,\\mathrm{MeV}$, $E_0=100\\,\\mathrm{MeV}$.\n\nDefine and compute the following seven results:\n1. For $E=50\\,\\mathrm{MeV}$ and $dr=0.01\\,\\mathrm{fm}$, compute the total central volume integral $J_V(50\\,\\mathrm{MeV})$ in $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$.\n2. For $E=50\\,\\mathrm{MeV}$ and $dr=0.01\\,\\mathrm{fm}$, compute the per-nucleon volume integral $J_V(50\\,\\mathrm{MeV})/A$ in $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$.\n3. For $E=50\\,\\mathrm{MeV}$ and $dr=0.01\\,\\mathrm{fm}$, compare $J_V(50\\,\\mathrm{MeV})/A$ to a phenomenological benchmark window typical for medium-mass nuclei at this energy, namely $[-550,-350]\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^3$. Output a boolean indicating whether $J_V(50\\,\\mathrm{MeV})/A$ lies in this interval.\n4. For $E=0\\,\\mathrm{MeV}$ and $dr=0.01\\,\\mathrm{fm}$, compute $J_V(0\\,\\mathrm{MeV})/A$ in $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$.\n5. For $E=200\\,\\mathrm{MeV}$ and $dr=0.01\\,\\mathrm{fm}$, compute $J_V(200\\,\\mathrm{MeV})/A$ in $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$.\n6. With $dr=0.01\\,\\mathrm{fm}$, compute the numerically obtained normalization $\\int d^3 r\\, \\rho(r)$ to verify it is close to $A=40$. Output this value as a float.\n7. A grid sensitivity check at $E=50\\,\\mathrm{MeV}$: compute $J_V(50\\,\\mathrm{MeV})/A$ with $dr=0.01\\,\\mathrm{fm}$ (“fine”) and $dr=0.20\\,\\mathrm{fm}$ (“coarse”), and output the absolute difference between these two per-nucleon values in $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$.\n\nFinal Output Format. Your program should produce a single line of output containing the seven results described above, in order, as a comma-separated list enclosed in square brackets, for example\n$$\n[\\text{J50\\_total},\\text{J50\\_perA},\\text{in\\_window},\\text{J0\\_perA},\\text{J200\\_perA},\\text{A\\_computed},\\text{grid\\_diff}].\n$$\nThe first, second, fourth, fifth, and seventh entries must be floats in $\\mathrm{MeV}\\cdot\\mathrm{fm}^3$, the third entry must be a boolean, and the sixth entry must be a float representing the computed normalization (dimensionless, expected near $40$).", "solution": "The problem requires the computation of the central volume integral $J_V(E)$ of the real part of a microscopic optical potential, $U(\\mathbf{r},E)$. The potential is constructed via a folding model, representing the convolution of a target-nucleon density $\\rho(\\mathbf{r}')$ and an effective nucleon-nucleon interaction $g$.\n\nThe central volume integral is defined as:\n$$\nJ_V(E) = \\int d^3 r \\,\\Re U(\\mathbf{r},E)\n$$\nThe optical potential $U(\\mathbf{r},E)$ is given by the convolution integral:\n$$\nU(\\mathbf{r},E) = \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big)\n$$\nSubstituting the expression for $U(\\mathbf{r},E)$ into the definition of $J_V(E)$ and taking the real part yields:\n$$\nJ_V(E) = \\int d^3 r \\, \\Re \\left( \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big) \\right)\n$$\nSince the nuclear density $\\rho(\\mathbf{r}')$ is a real quantity, we can move the real part operator $\\Re$ to act only on the complex interaction $g$:\n$$\nJ_V(E) = \\int d^3 r \\int d^3 r' \\,\\rho(\\mathbf{r}')\\, \\Re g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big)\n$$\nThe functions $\\rho$ and $\\Re g$ are well-behaved, allowing for the interchange of the order of integration (Fubini's theorem):\n$$\nJ_V(E) = \\int d^3 r' \\,\\rho(\\mathbf{r}') \\left( \\int d^3 r \\, \\Re g\\big(|\\mathbf{r}-\\mathbf{r}'|;E\\big) \\right)\n$$\nLet's analyze the inner integral. We introduce a change of variables $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$, which implies $d^3 s = d^3 r$. The inner integral becomes:\n$$\n\\int d^3 s \\, \\Re g(s;E)\n$$\nwhere $s = |\\mathbf{s}|$. This integral represents the volume integral of the real part of the effective interaction. Critically, its value does not depend on $\\mathbf{r}'$. Therefore, it can be factored out of the outer integral:\n$$\nJ_V(E) = \\left( \\int d^3 r' \\,\\rho(\\mathbf{r}') \\right) \\left( \\int d^3 s \\, \\Re g(s;E) \\right)\n$$\nThis separation is the key to simplifying the computation. The problem is reduced from a complex six-dimensional convolution to the product of two independent three-dimensional integrals.\n\nThe first term is the volume integral of the nuclear density. By definition, this integral is normalized to the mass number $A$:\n$$\n\\int d^3 r' \\,\\rho(\\mathbf{r}') = A\n$$\nThe second term is the volume integral of the real part of the interaction, which we denote as $j_V(E)$:\n$$\nj_V(E) = \\int d^3 s \\, \\Re g(s;E)\n$$\nThus, the total central volume integral is simply:\n$$\nJ_V(E) = A \\cdot j_V(E)\n$$\nFrom this, the per-nucleon volume integral is immediately identified as $j_V(E) = J_V(E)/A$.\n\nThe problem requires a numerical implementation on a finite radial grid. The two integrals will be computed numerically using the trapezoidal rule, which is a standard and suitable method for a uniform grid.\n\n**Numerical Implementation Steps:**\n\n1.  **Grid Setup**: A uniform radial grid is established from $r=0$ to $R_{\\max}=12\\,\\mathrm{fm}$ with a step size $dr$. Both integrals will be performed over this grid. This finite range is an excellent approximation because both the density $\\rho(r)$ and interaction $\\Re g(s)$ decay exponentially and are negligible for radii larger than $R_{\\max}$.\n\n2.  **Density Normalization**: The ground-state density for $^{40}\\mathrm{Ca}$ is given by the two-parameter Fermi function:\n    $$\n    \\rho(r) = \\frac{\\rho_0}{1+\\exp\\left(\\frac{r-c}{a}\\right)}\n    $$\n    with parameters $c=3.67\\,\\mathrm{fm}$ and $a=0.55\\,\\mathrm{fm}$. The normalization constant $\\rho_0$ is not given and must be determined by enforcing the condition that the total number of nucleons is $A=40$. In spherical coordinates, this is:\n    $$\n    \\int_0^{R_{\\max}} 4\\pi r^2 \\rho(r) dr = A\n    $$\n    We first numerically compute the integral of the unnormalized part, $I_{unnorm} = \\int_0^{R_{\\max}} 4\\pi r^2 \\left(1+\\exp\\left(\\frac{r-c}{a}\\right)\\right)^{-1} dr$. Then, $\\rho_0$ is found via $\\rho_0 = A/I_{unnorm}$. For tasks requiring the total volume integral $J_V(E)$, we will use the numerically computed normalization, $A_{\\text{comp}} = \\int_0^{R_{\\max}} 4\\pi r^2 \\rho(r) dr$, to ensure consistency.\n\n3.  **Interaction Volume Integral**: The per-nucleon volume integral $j_V(E)$ is computed by integrating the given real part of the $g$-matrix:\n    $$\n    \\Re g(s;E) = V_0(E)\\,\\exp\\!\\left(-\\frac{s^2}{\\beta^2}\\right), \\quad \\text{with} \\quad V_0(E) = \\frac{V_{00}}{1 + E/E_0}\n    $$\n    The parameters are $\\beta=1.0\\,\\mathrm{fm}$, $V_{00}=-120\\,\\mathrm{MeV}$, and $E_0=100\\,\\mathrm{MeV}$. The integral in spherical coordinates is:\n    $$\n    j_V(E) = \\int_0^{R_{\\max}} 4\\pi s^2 \\, \\Re g(s;E) ds\n    $$\n    This integral is computed numerically for each required energy $E$.\n\n4.  **Final Quantities**: The required quantities for the test suite are assembled from these intermediate calculations. The total volume integral is $J_V(E) = A_{\\text{comp}} \\cdot j_V(E)$, and the per-nucleon volume integral is $j_V(E)$. The other tests involve comparing these values under different conditions ($E$ and $dr$) as specified.\n    - Test 1: $J_V(50\\,\\mathrm{MeV})$\n    - Test 2: $J_V(50\\,\\mathrm{MeV})/A \\approx j_V(50\\,\\mathrm{MeV})$\n    - Test 3: Check if $j_V(50\\,\\mathrm{MeV}) \\in [-550,-350]\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^3$\n    - Test 4: $j_V(0\\,\\mathrm{MeV})$\n    - Test 5: $j_V(200\\,\\mathrm{MeV})$\n    - Test 6: $A_{\\text{comp}}$\n    - Test 7: The absolute difference in $j_V(50\\,\\mathrm{MeV})$ computed with $dr=0.01\\,\\mathrm{fm}$ and $dr=0.20\\,\\mathrm{fm}$.\n\nThis approach is computationally efficient, numerically stable, and correctly interprets the physics of the folding model and its volume integral.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the volume integral of a microscopic optical potential and derived quantities.\n    \"\"\"\n    \n    # Define physical and model constants for Ca-40\n    A = 40.0\n    c = 3.67      # fm (radius parameter of Woods-Saxon)\n    a = 0.55      # fm (diffuseness parameter of Woods-Saxon)\n    beta = 1.0    # fm (range of the Gaussian interaction)\n    V00 = -120.0  # MeV (strength of the interaction at E=0)\n    E0 = 100.0    # MeV (energy dependence scale)\n    R_max = 12.0  # fm (radial integration cutoff)\n\n    def compute_all(E, dr):\n        \"\"\"\n        Helper function to perform the core numerical calculations for a given\n        energy E and grid spacing dr.\n\n        Returns:\n            j_V_num (float): Per-nucleon volume integral in MeV*fm^3.\n            J_V_total (float): Total volume integral in MeV*fm^3.\n            A_comp (float): Numerically computed normalization of the density.\n        \"\"\"\n        # 1. Create the uniform radial grid\n        # Use np.arange with a small addition to ensure R_max is included.\n        r_grid = np.arange(0, R_max + dr / 2.0, dr)\n        \n        # 2. Normalize the nuclear density\n        # Integrand for the unnormalized density: 4*pi*r^2 * rho_unnormalized(r)\n        rho_unnorm_integrand = 4.0 * np.pi * r_grid**2 / (1.0 + np.exp((r_grid - c) / a))\n        \n        # Integrate using the trapezoidal rule\n        I_rho_unnorm = np.trapz(rho_unnorm_integrand, x=r_grid)\n        \n        # Determine the normalization constant rho_0\n        rho_0 = A / I_rho_unnorm\n        \n        # 3. Compute the volume integral of the interaction (j_V)\n        # This is the per-nucleon volume integral J_V/A.\n        V0 = V00 / (1.0 + E / E0)\n        \n        # Integrand for j_V: 4*pi*s^2 * Re(g(s; E))\n        # The integration variable is s, but we use the same radial grid.\n        g_integrand = 4.0 * np.pi * r_grid**2 * V0 * np.exp(-r_grid**2 / beta**2)\n        \n        # Integrate using the trapezoidal rule\n        j_V_num = np.trapz(g_integrand, x=r_grid)\n        \n        # 4. Compute the actual numerical normalization achieved (A_comp)\n        # This serves as a consistency check and is required for Test 6.\n        rho_norm_integrand = rho_0 * (4.0 * np.pi * r_grid**2 / (1.0 + np.exp((r_grid - c) / a)))\n        A_comp = np.trapz(rho_norm_integrand, x=r_grid)\n        \n        # 5. Compute the total volume integral (J_V)\n        # We use A_comp for full numerical consistency.\n        J_V_total = A_comp * j_V_num\n        \n        return j_V_num, J_V_total, A_comp\n\n    # --- Execute the Test Suite ---\n    \n    dr_fine = 0.01\n\n    # Tests 1, 2, 3, 6 are based on E=50 MeV, dr=0.01 fm\n    j50_perA_fine, J50_total, A_computed_fine = compute_all(E=50.0, dr=dr_fine)\n    \n    # Result 1: Total central volume integral J_V(50 MeV)\n    result1 = J50_total\n    \n    # Result 2: Per-nucleon volume integral J_V(50 MeV)/A\n    result2 = j50_perA_fine\n    \n    # Result 3: Check if J_V(50 MeV)/A is in the benchmark window\n    result3 = -550.0 = j50_perA_fine = -350.0\n    \n    # Result 6: The numerically obtained normalization integral\n    result6 = A_computed_fine\n\n    # Test 4: Per-nucleon volume integral at E=0 MeV\n    j0_perA, _, _ = compute_all(E=0.0, dr=dr_fine)\n    result4 = j0_perA\n\n    # Test 5: Per-nucleon volume integral at E=200 MeV\n    j200_perA, _, _ = compute_all(E=200.0, dr=dr_fine)\n    result5 = j200_perA\n    \n    # Test 7: Grid sensitivity check\n    dr_coarse = 0.20\n    j50_perA_coarse, _, _ = compute_all(E=50.0, dr=dr_coarse)\n    \n    # Absolute difference between fine and coarse grid results\n    result7 = abs(j50_perA_fine - j50_perA_coarse)\n\n    # --- Final Output Formatting ---\n    \n    # Assemble the final list of results in the specified order\n    final_results = [result1, result2, result3, result4, result5, result6, result7]\n\n    # Format the list into the required string format\n    # Booleans must be lowercase 'true' or 'false'.\n    formatted_results = []\n    for res in final_results:\n        if isinstance(res, (bool, np.bool_)):\n            formatted_results.append(str(res).lower())\n        else:\n            formatted_results.append(f\"{res:.8f}\")\n\n    # Print the final output string in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3569722"}, {"introduction": "The optical potential is not a static object; its real and imaginary parts, $V(E)$ and $W(E)$, are deeply connected through the principle of causality. This connection is formally expressed by the Kramers-Kronig dispersion relation, which dictates how the absorptive potential $W(E)$ at all energies generates a dispersive contribution to the real potential $V(E)$. This practice will guide you through the numerical implementation of this relation, highlighting the importance of high-energy constraints and the mathematical technique of subtraction needed to ensure a convergent result [@problem_id:3569748].", "problem": "You are asked to build and execute a complete program that numerically verifies the convergence properties of the Kramers–Kronig dispersion integral relating the real and imaginary parts of a microscopic optical model potential in nuclear physics. The optical model potential is written as $U(E) = V(E) + i\\,W(E)$, where $V(E)$ and $W(E)$ are the real and imaginary parts, respectively, of a retarded self-energy. By causality and analyticity, these parts are related by dispersion integrals. The enforcement of high-energy constraints is crucial for numerical convergence. Your task is to implement a once-subtracted dispersion relation about the Fermi energy and quantify the ultraviolet sensitivity of computed results near the Fermi energy.\n\nFundamental base:\n- Retarded response functions in many-body theory are analytic in the upper-half complex energy plane, which by Cauchy’s integral theorem implies that their real and imaginary parts are connected by dispersion relations.\n- A subtraction at a reference energy removes ultraviolet sensitivity by exploiting the fact that differences of Hilbert kernels improve the integrable decay of the integrand.\n\nDefinitions and models:\n- Let the Fermi energy be $E_F$ (in $\\mathrm{MeV}$).\n- Let the absorption threshold be $E_t$ (in $\\mathrm{MeV}$), with $W(E) = 0$ for $E  E_t$. This models the particle-channel absorption in a nucleus when only positive-energy excitations contribute above threshold.\n- Consider the following two models for the imaginary part $W(E)$ (in $\\mathrm{MeV}$), parameterized by $W_0  0$, $a  0$, and $E_c  0$ (all in $\\mathrm{MeV}$):\n  1. Model A (non-decaying tail for $E \\to +\\infty$):\n     $$W_A(E) = \\begin{cases}\n     0,  E  E_t,\\\n$$4pt]\n     -W_0 \\dfrac{(E - E_t)^2}{(E - E_t)^2 + a^2},  E \\ge E_t.\n     \\end{cases}$$\n     This satisfies $W_A(E) \\to -W_0$ as $E \\to +\\infty$.\n  2. Model B (high-energy constrained, damped tail):\n     $$W_B(E) = \\begin{cases}\n     0,  E  E_t,\\\n$$4pt]\n     -W_0 \\dfrac{(E - E_t)^2}{(E - E_t)^2 + a^2}\\,\\dfrac{1}{1 + \\left(\\dfrac{E - E_t}{E_c}\\right)^2},  E \\ge E_t.\n     \\end{cases}$$\n     This satisfies $W_B(E) \\to 0$ as $E \\to +\\infty$ with asymptotic decay $\\propto E^{-2}$.\n\nTasks you must implement:\n- From analyticity of the retarded self-energy and the requirement that $W(E)$ describes absorptive strength, derive and implement the once-subtracted dispersion relation for the real part about the Fermi energy. Let $\\Lambda  E_t$ be an ultraviolet cutoff (in $\\mathrm{MeV}$). For numerical evaluation, approximate the semi-infinite integral by truncating at $E' = \\Lambda$ and compute the subtracted real part near $E_F$.\n- Also implement the corresponding unsubtracted integral truncated at $E' = \\Lambda$ on the interval $[E_t,\\Lambda]$ to quantify ultraviolet sensitivity.\n\nNumerical requirements:\n- All energies must be in $\\mathrm{MeV}$.\n- Angles do not appear.\n- You must produce floating-point results in $\\mathrm{MeV}$ rounded to exactly six decimal places.\n\nTest suite:\nUse the following fixed parameters, all in $\\mathrm{MeV}$:\n- $E_F = -8.0$\n- $E_t = 0.0$\n- $W_0 = 25.0$\n- $a = 40.0$\n- $E_c = 200.0$\nDefine the evaluation energy near the Fermi energy as $E_\\star = E_F + 5.0$. Use the following ultraviolet cutoffs $\\Lambda \\in \\{200.0, 400.0, 800.0\\}$.\n\nCompute the following six quantities in the stated order:\n1. Using Model A and the unsubtracted dispersion integral truncated at $\\Lambda$, compute the difference\n   $$\\Delta_{\\mathrm{unsub}}^{A} \\equiv V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=200.0),$$\n   expressed in $\\mathrm{MeV}$.\n2. Using Model A and the once-subtracted dispersion integral truncated at $\\Lambda$, compute\n   $$V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=200.0),\\quad V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=400.0),\\quad V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=800.0),$$\n   each in $\\mathrm{MeV}$.\n3. Using Model B and the unsubtracted dispersion integral truncated at $\\Lambda$, compute the difference\n   $$\\Delta_{\\mathrm{unsub}}^{B} \\equiv V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=400.0),$$\n   in $\\mathrm{MeV}$.\n4. Using Model A and the once-subtracted dispersion integral truncated at $\\Lambda=400.0$, compute\n   $$V_{\\mathrm{sub}}^{A}(E_F;\\Lambda=400.0),$$\n   in $\\mathrm{MeV}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places and interpreted in $\\mathrm{MeV}$, in the exact order specified above. For example:\n\"[x1,x2,x3,x4,x5,x6]\" where each xi is a float with six digits after the decimal point.", "solution": "The problem requires the numerical verification of convergence properties of dispersion integrals for a microscopic optical model potential in nuclear physics. We begin by establishing the theoretical framework and deriving the necessary formulae.\n\nThe optical potential, denoted as $U(E) = V(E) + i\\,W(E)$, is a retarded self-energy. A fundamental property of retarded response functions in quantum many-body theory is their analyticity in the upper-half of the complex energy plane. This property, a consequence of causality, allows the application of Cauchy's integral theorem, leading to the Kramers-Kronig dispersion relations that connect the real part $V(E)$ and the imaginary part $W(E)$ of the potential.\n\nThe unsubtracted dispersion relation is given by:\n$$ V(E) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{W(E')}{E' - E} dE' $$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value. The problem specifies that the imaginary part $W(E)$ is non-zero only for energies above an absorption threshold $E_t$, i.e., $W(E) = 0$ for $E  E_t$. The integral thus reduces to:\n$$ V(E) = \\frac{1}{\\pi} \\mathcal{P} \\int_{E_t}^{\\infty} \\frac{W(E')}{E' - E} dE' $$\nThe evaluation energies specified in the problem, $E_\\star$ and $E_F$, are both less than the threshold $E_t=0.0\\,\\mathrm{MeV}$. Therefore, the pole at $E' = E$ never lies within the integration domain, and the principal value operator $\\mathcal{P}$ can be omitted. For numerical computation with an ultraviolet cutoff $\\Lambda$, the unsubtracted potential is:\n$$ V_{\\mathrm{unsub}}(E; \\Lambda) = \\frac{1}{\\pi} \\int_{E_t}^{\\Lambda} \\frac{W(E')}{E' - E} dE' $$\nThis integral is convergent only if $W(E')$ vanishes sufficiently rapidly as $E' \\to \\infty$. Model A, where $W_A(E) \\to -W_0$ as $E \\to \\infty$, does not satisfy this condition, as the integrand behaves as $1/E'$, leading to a logarithmic divergence with $\\Lambda$. This demonstrates ultraviolet sensitivity.\n\nTo remedy this divergence, a once-subtracted dispersion relation is employed. The subtraction is performed at a reference energy, chosen here to be the Fermi energy $E_F$. We subtract the expression for $V(E_F)$ from $V(E)$:\n$$ V(E) - V(E_F) = \\frac{1}{\\pi} \\int_{E_t}^{\\infty} W(E') \\left( \\frac{1}{E' - E} - \\frac{1}{E' - E_F} \\right) dE' $$\nCombining the terms in the parenthesis, we get:\n$$ V(E) - V(E_F) = \\frac{E - E_F}{\\pi} \\int_{E_t}^{\\infty} \\frac{W(E')}{(E' - E)(E' - E_F)} dE' $$\nThe right-hand side of this equation represents the energy-dependent dispersive correction to the real potential, relative to its value at the Fermi energy. We identify this correction, truncated at the cutoff $\\Lambda$, as the \"subtracted real part\" $V_{\\mathrm{sub}}(E; \\Lambda)$ requested in the problem:\n$$ V_{\\mathrm{sub}}(E; \\Lambda) = \\frac{E - E_F}{\\pi} \\int_{E_t}^{\\Lambda} \\frac{W(E')}{(E' - E)(E' - E_F)} dE' $$\nThe integrand in this form now behaves as $1/(E')^2$ for large $E'$ even for Model A, ensuring the convergence of the integral as $\\Lambda \\to \\infty$. This procedure removes the ultraviolet sensitivity associated with the unsubtracted form. An important consequence of this definition is that for $E=E_F$, the prefactor $(E-E_F)$ becomes zero, meaning $V_{\\mathrm{sub}}(E_F; \\Lambda) = 0$ for any $\\Lambda$.\n\nWe will now outline the specific calculations using the provided parameters: $E_F = -8.0\\,\\mathrm{MeV}$, $E_t = 0.0\\,\\mathrm{MeV}$, $W_0 = 25.0\\,\\mathrm{MeV}$, $a = 40.0\\,\\mathrm{MeV}$, $E_c = 200.0\\,\\mathrm{MeV}$, and $E_\\star = E_F + 5.0 = -3.0\\,\\mathrm{MeV}$.\n\nThe imaginary potential models are:\n$$ W_A(E') = -25.0 \\frac{(E')^2}{(E')^2 + 40.0^2} \\quad \\text{for } E' \\ge 0 $$\n$$ W_B(E') = W_A(E') \\frac{1}{1 + (E'/200.0)^2} \\quad \\text{for } E' \\ge 0 $$\n\nThe six quantities to be computed are:\n\n1.  $\\Delta_{\\mathrm{unsub}}^{A} \\equiv V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{A}(E_\\star;\\Lambda=200.0)$: This difference highlights the strong dependence of the unsubtracted integral on the cutoff $\\Lambda$ for the non-decaying Model A.\n    $$ \\Delta_{\\mathrm{unsub}}^{A} = \\frac{1}{\\pi} \\int_{200.0}^{800.0} \\frac{W_A(E')}{E' - (-3.0)} dE' $$\n\n2.  $V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=200.0)$: The subtracted potential for Model A at $E_\\star = -3.0 \\, \\mathrm{MeV}$ with $\\Lambda = 200.0 \\, \\mathrm{MeV}$.\n    $$ V_{\\mathrm{sub}}^{A}(E_\\star; 200.0) = \\frac{-3.0 - (-8.0)}{\\pi} \\int_{0.0}^{200.0} \\frac{W_A(E')}{(E' - (-3.0))(E' - (-8.0))} dE' $$\n\n3.  $V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=400.0)$: Same as above, but with $\\Lambda = 400.0 \\, \\mathrm{MeV}$.\n\n4.  $V_{\\mathrm{sub}}^{A}(E_\\star;\\Lambda=800.0)$: Same as above, but with $\\Lambda = 800.0 \\, \\mathrm{MeV}$. Comparison of these three values will demonstrate the rapid convergence of the subtracted integral.\n\n5.  $\\Delta_{\\mathrm{unsub}}^{B} \\equiv V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=800.0) - V_{\\mathrm{unsub}}^{B}(E_\\star;\\Lambda=400.0)$: This difference shows the reduced ultraviolet sensitivity for Model B, which has a physically constrained high-energy decay.\n    $$ \\Delta_{\\mathrm{unsub}}^{B} = \\frac{1}{\\pi} \\int_{400.0}^{800.0} \\frac{W_B(E')}{E' - (-3.0)} dE' $$\n\n6.  $V_{\\mathrm{sub}}^{A}(E_F;\\Lambda=400.0)$: The subtracted potential for Model A evaluated at the subtraction energy $E_F = -8.0 \\, \\mathrm{MeV}$.\n    $$ V_{\\mathrm{sub}}^{A}(E_F; 400.0) = \\frac{-8.0 - (-8.0)}{\\pi} \\int_{0.0}^{400.0} \\frac{W_A(E')}{(E' - (-8.0))(E' - (-8.0))} dE' = 0 $$\n    This result is analytically zero due to the $(E-E_F)$ prefactor.\n\nNumerical integration will be performed using standard library functions to compute these definite integrals.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    # Define fixed parameters as per the problem statement.\n    # All energy units are in MeV.\n    E_F = -8.0\n    E_t = 0.0\n    W_0 = 25.0\n    a = 40.0\n    E_c = 200.0\n    \n    # Define the evaluation energy E_star\n    E_star = E_F + 5.0\n    \n    # Define the ultraviolet cutoffs\n    cutoffs = {'low': 200.0, 'mid': 400.0, 'high': 800.0}\n\n    # --- Models for the imaginary part W(E) ---\n    \n    def W_A(E_prime):\n        \"\"\"Model A for the imaginary part of the optical potential.\"\"\"\n        if E_prime  E_t:\n            return 0.0\n        # For E_prime = E_t\n        E_minus_Et = E_prime - E_t\n        return -W_0 * (E_minus_Et**2) / (E_minus_Et**2 + a**2)\n\n    def W_B(E_prime):\n        \"\"\"Model B for the imaginary part of the optical potential.\"\"\"\n        if E_prime  E_t:\n            return 0.0\n        # For E_prime = E_t\n        E_minus_Et = E_prime - E_t\n        damping_factor = 1.0 / (1.0 + (E_minus_Et / E_c)**2)\n        return W_A(E_prime) * damping_factor\n\n    # --- Integrand definitions for numerical integration ---\n\n    # For Task 1: Unsubtracted, Model A\n    def integrand_unsub_A(E_prime):\n        return W_A(E_prime) / (np.pi * (E_prime - E_star))\n\n    # For Task 2, 3, 4: Subtracted, Model A\n    def integrand_sub_A(E_prime):\n        return W_A(E_prime) / ((E_prime - E_star) * (E_prime - E_F))\n\n    # For Task 5: Unsubtracted, Model B\n    def integrand_unsub_B(E_prime):\n        return W_B(E_prime) / (np.pi * (E_prime - E_star))\n\n    # --- Computation of the six required quantities ---\n    results = []\n\n    # 1. Delta_unsub^A = V_unsub^A(E_star; 800) - V_unsub^A(E_star; 200)\n    # This is equivalent to integrating from 200 to 800.\n    delta_unsub_A, _ = quad(integrand_unsub_A, cutoffs['low'], cutoffs['high'])\n    results.append(delta_unsub_A)\n    \n    # 2. V_sub^A(E_star; 200)\n    integral_sub_A_200, _ = quad(integrand_sub_A, E_t, cutoffs['low'])\n    prefactor_sub = (E_star - E_F) / np.pi\n    v_sub_A_200 = prefactor_sub * integral_sub_A_200\n    results.append(v_sub_A_200)\n\n    # 3. V_sub^A(E_star; 400)\n    integral_sub_A_400, _ = quad(integrand_sub_A, E_t, cutoffs['mid'])\n    v_sub_A_400 = prefactor_sub * integral_sub_A_400\n    results.append(v_sub_A_400)\n\n    # 4. V_sub^A(E_star; 800)\n    integral_sub_A_800, _ = quad(integrand_sub_A, E_t, cutoffs['high'])\n    v_sub_A_800 = prefactor_sub * integral_sub_A_800\n    results.append(v_sub_A_800)\n\n    # 5. Delta_unsub^B = V_unsub^B(E_star; 800) - V_unsub^B(E_star; 400)\n    # This is equivalent to integrating from 400 to 800.\n    delta_unsub_B, _ = quad(integrand_unsub_B, cutoffs['mid'], cutoffs['high'])\n    results.append(delta_unsub_B)\n\n    # 6. V_sub^A(E_F; 400)\n    # This is analytically zero due to the (E - E_F) prefactor.\n    v_sub_A_EF = 0.0\n    results.append(v_sub_A_EF)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3569748"}, {"introduction": "A key feature that distinguishes microscopic optical potentials is nonlocality, which arises naturally from the Pauli exclusion principle (exchange effects). A nonlocal potential acts differently on different momentum components of the scattering wave function, leading to unique signatures in observables that a purely local potential cannot reproduce. This advanced exercise demonstrates this effect by showing how nonlocality modifies the shape of the angular distribution of the scattering cross section, using a statistical measure, $\\chi^2$, to quantify the improvement in describing the (synthetic) data [@problem_id:3569711].", "problem": "Consider elastic nucleon–nucleus scattering modeled within a microscopic optical potential framework that includes nonlocality. Work in the first Born approximation to isolate analytic structure and controlled comparisons. Assume a central, purely real, spherical “microscopic” volume term approximated by a Gaussian form factor in coordinate space. Adopt a Gaussian Perey–Buck-type nonlocal kernel that depends on the relative coordinate and the average coordinate, which is widely used as a surrogate for nonlocality arising from exchange and off-shell effects in microscopic optical models.\n\nStarting point and assumptions to be used as the fundamental base:\n- The time-independent Schrödinger equation for elastic scattering and the Lippmann–Schwinger (LS) scattering formalism.\n- The first Born approximation for the on-shell scattering amplitude from a potential operator, together with the standard plane-wave normalization used in scattering theory.\n- The definition of the center-of-mass relative momentum $k$ from the reduced mass $\\mu$ and center-of-mass energy $E_{\\mathrm{cm}}$ through $k = \\sqrt{2 \\mu E_{\\mathrm{cm}}}/(\\hbar c)$ in units of inverse femtometers.\n- The spherical Bessel function $j_0(x)$ arises in three-dimensional Fourier transforms of spherically symmetric functions.\n\nModel ingredients:\n- Use a local Gaussian profile for the average-coordinate dependence of the potential, $V(r) = -V_0 \\exp(-r^2/a^2)$ with $V_0 > 0$ and range parameter $a$ in femtometers. This stands in for a folded microscopic interaction.\n- Use a Gaussian nonlocal kernel $g(s) \\propto \\exp(-s^2/\\beta^2)$ of nonlocal range $\\beta$ in femtometers, with the full nonlocal optical potential taken as $U(\\mathbf{R},\\mathbf{s}) = V(R) g(s)$, where $\\mathbf{R} = (\\mathbf{r}+\\mathbf{r}')/2$ and $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$.\n- Define the “local equivalent” by replacing the nonlocal kernel with an energy-dependent constant factor evaluated at forward kinematics, so that the local-equivalent amplitude matches the nonlocal amplitude at $\\theta=0$, but not necessarily at finite angles.\n\nTasks:\n1. From the LS equation and first Born approximation, starting from the above model assumptions, derive the scattering amplitude for the local Gaussian potential in momentum space. Then, derive the modification introduced by the Gaussian nonlocal kernel that depends on the average coordinate, and show how the nonlocal kernel introduces an additional angular dependence in elastic kinematics through the average of incoming and outgoing momenta. Express the corresponding differential cross sections in terms of $k$, the momentum transfer magnitude $q = 2k \\sin(\\theta/2)$, and the average momentum magnitude $K = k \\cos(\\theta/2)$.\n2. Define synthetic “experimental” differential cross section values by taking the nonlocal prediction for a given parameter set as the truth and imposing a global scale mismatch. Specifically, for any fixed angle $\\theta_i$, set the experimental value $\\sigma_{\\mathrm{exp}}(\\theta_i)$ equal to $s$ times the nonlocal-model prediction $\\sigma_{\\mathrm{nonloc}}(\\theta_i)$, with $s = 1.02$, and assign a standard deviation $\\delta \\sigma(\\theta_i) = u \\, \\sigma_{\\mathrm{exp}}(\\theta_i)$ with $u = 0.05$. Angles must be interpreted in radians in all formulas, but are provided in degrees in the test suite. The reduced chi-squared for $N$ angles is\n$$\n\\chi^2_{\\nu} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{\\sigma_{\\mathrm{th}}(\\theta_i) - \\sigma_{\\mathrm{exp}}(\\theta_i)}{\\delta \\sigma(\\theta_i)} \\right)^2,\n$$\nwhich is dimensionless; report all final results as dimensionless floats (no units).\n3. Implement a program that, for each test case in the test suite below, computes the reduced chi-squared for the nonlocal model, $\\chi^2_{\\nu}(\\mathrm{nonloc})$, and for its local equivalent, $\\chi^2_{\\nu}(\\mathrm{loc\\_equiv})$, using the derived analytic results from Task $1$ and the experimental construction in Task $2$. Then report, for each test case, the difference\n$$\n\\Delta \\chi^2_{\\nu} = \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) - \\chi^2_{\\nu}(\\mathrm{nonloc}),\n$$\nrounded to three decimals. Positive $\\Delta \\chi^2_{\\nu}$ indicates that the nonlocal model provides a better fit than its local equivalent.\n\nPhysical constants and unit conventions:\n- Use $\\hbar c = 197.3269804 \\ \\mathrm{MeV \\, fm}$.\n- Use the nucleon mass $m_N = 938.92 \\ \\mathrm{MeV}/c^2$.\n- Use the reduced mass $\\mu = m_N \\, A/(A+1)$ for a projectile nucleon on a target of mass number $A$.\n- Use the center-of-mass energy $E_{\\mathrm{cm}} = E_{\\mathrm{lab}} \\, A/(A+1)$.\n- All energies must be in $\\mathrm{MeV}$, all lengths in $\\mathrm{fm}$, and all angles converted to radians for computation. The outputs are dimensionless.\n\nTest suite:\n- Use the fixed angle set (in degrees) $\\Theta = \\{0, 30, 60, 90, 120, 150\\}$.\n- Use $s = 1.02$ and $u = 0.05$ in all cases.\n- Case $1$ (happy path): $E_{\\mathrm{lab}} = 30$, $A = 40$, $V_0 = 50$, $a = 1.2$, $\\beta = 0.85$.\n- Case $2$ (boundary, local limit): $E_{\\mathrm{lab}} = 30$, $A = 40$, $V_0 = 50$, $a = 1.2$, $\\beta = 0$.\n- Case $3$ (higher momentum, stronger nonlocal effect): $E_{\\mathrm{lab}} = 65$, $A = 90$, $V_0 = 52$, $a = 1.2$, $\\beta = 0.85$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the values of $\\Delta \\chi^2_{\\nu}$ for Cases $1$–$3$ in order, as a comma-separated list enclosed in square brackets, with each value rounded to three decimals. For example, an output line for three cases must look like $[x_1,x_2,x_3]$ where each $x_i$ is a float with exactly three digits after the decimal point.", "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n- **Framework**: Time-independent Schrödinger equation, Lippmann-Schwinger formalism, first Born approximation.\n- **Scattering amplitude**: $f(\\mathbf{k}', \\mathbf{k}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\int e^{-i\\mathbf{k}' \\cdot \\mathbf{r}'} U(\\mathbf{r}, \\mathbf{r}') e^{i\\mathbf{k} \\cdot \\mathbf{r}} d^3r d^3r'$ for a general nonlocal potential $U$.\n- **Momentum definition**: $k = \\sqrt{2 \\mu E_{\\mathrm{cm}}}/(\\hbar c)$ in fm$^{-1}$.\n- **Mathematical function**: Spherical Bessel function $j_0(x)$ for 3D Fourier transforms of spherically symmetric functions.\n- **Local Potential Form**: $V(r) = -V_0 \\exp(-r^2/a^2)$ with $V_0  0$.\n- **Nonlocal Kernel Form**: $g(s) \\propto \\exp(-s^2/\\beta^2)$.\n- **Full Nonlocal Potential**: $U(\\mathbf{R},\\mathbf{s}) = V(R) g(s)$, with $\\mathbf{R} = (\\mathbf{r}+\\mathbf{r}')/2$ and $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$.\n- **Local Equivalent Definition**: The local-equivalent amplitude matches the nonlocal amplitude at $\\theta = 0$, by replacing the nonlocal kernel's effect with a constant energy-dependent factor.\n- **\"Experimental\" data**: $\\sigma_{\\mathrm{exp}}(\\theta_i) = s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)$ with scale factor $s = 1.02$.\n- **Uncertainty**: $\\delta \\sigma(\\theta_i) = u \\cdot \\sigma_{\\mathrm{exp}}(\\theta_i)$ with relative uncertainty $u = 0.05$.\n- **Reduced Chi-squared**: $\\chi^2_{\\nu} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{\\sigma_{\\mathrm{th}}(\\theta_i) - \\sigma_{\\mathrm{exp}}(\\theta_i)}{\\delta \\sigma(\\theta_i)} \\right)^2$.\n- **Target quantity**: $\\Delta \\chi^2_{\\nu} = \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) - \\chi^2_{\\nu}(\\mathrm{nonloc})$.\n- **Physical constants**: $\\hbar c = 197.3269804 \\ \\mathrm{MeV \\, fm}$, $m_N = 938.92 \\ \\mathrm{MeV}/c^2$.\n- **Kinematic relations**: $\\mu = m_N \\, A/(A+1)$, $E_{\\mathrm{cm}} = E_{\\mathrm{lab}} \\, A/(A+1)$.\n- **Angle set**: $\\Theta = \\{0, 30, 60, 90, 120, 150\\}$ degrees.\n- **Test cases**:\n    1. $E_{\\mathrm{lab}} = 30$ MeV, $A = 40$, $V_0 = 50$ MeV, $a = 1.2$ fm, $\\beta = 0.85$ fm.\n    2. $E_{\\mathrm{lab}} = 30$ MeV, $A = 40$, $V_0 = 50$ MeV, $a = 1.2$ fm, $\\beta = 0$ fm.\n    3. $E_{\\mathrm{lab}} = 65$ MeV, $A = 90$, $V_0 = 52$ MeV, $a = 1.2$ fm, $\\beta = 0.85$ fm.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a well-defined exercise in theoretical and computational nuclear physics.\n- **Scientifically Grounded**: The problem is built upon standard scattering theory (Lippmann-Schwinger equation, Born approximation) and uses a common model for nonlocal optical potentials (Perey-Buck type Gaussian nonlocality). The kinematic relations and physical constants are standard. The model is a simplification but is rooted in established physical concepts.\n- **Well-Posed**: All necessary parameters, constants, and formulas are provided. The tasks are specific and lead to a unique, computable numerical result for each test case.\n- **Objective**: The problem is stated using precise mathematical and physical terminology, free of subjective or ambiguous language.\n\nThe problem does not violate any of the invalidity criteria. It is a formalizable, self-contained, and scientifically sound problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be developed.\n\n## Solution\n\n### Task 1: Derivation of Scattering Cross Sections\n\nThe scattering amplitude $f$ in the first Born approximation for a general, potentially nonlocal potential $U(\\mathbf{r}, \\mathbf{r}')$ is given by\n$$\nf(\\mathbf{k}', \\mathbf{k}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\iint e^{-i\\mathbf{k}' \\cdot \\mathbf{r}'} U(\\mathbf{r}, \\mathbf{r}') e^{i\\mathbf{k} \\cdot \\mathbf{r}} d^3r d^3r'\n$$\nwhere $\\mathbf{k}$ and $\\mathbf{k}'$ are the initial and final wave vectors in the center-of-mass frame, $\\mu$ is the reduced mass, and $\\hbar$ is the reduced Planck constant. For elastic scattering, $|\\mathbf{k}| = |\\mathbf{k}'| = k$.\n\nThe nonlocal potential is given as $U(\\mathbf{R},\\mathbf{s}) = V(R) g(s)$, where $\\mathbf{R} = (\\mathbf{r}+\\mathbf{r}')/2$ and $\\mathbf{s} = \\mathbf{r} - \\mathbf{r}'$. We must change the integration variables from $(\\mathbf{r}, \\mathbf{r}')$ to $(\\mathbf{R}, \\mathbf{s})$. The relations are $\\mathbf{r} = \\mathbf{R} + \\mathbf{s}/2$ and $\\mathbf{r}' = \\mathbf{R} - \\mathbf{s}/2$. The Jacobian of this transformation is $1$. The phase factor in the integral becomes:\n$$\n-i\\mathbf{k}' \\cdot \\mathbf{r}' + i\\mathbf{k} \\cdot \\mathbf{r} = -i\\mathbf{k}' \\cdot (\\mathbf{R} - \\mathbf{s}/2) + i\\mathbf{k} \\cdot (\\mathbf{R} + \\mathbf{s}/2) = -i(\\mathbf{k}' - \\mathbf{k}) \\cdot \\mathbf{R} + i\\frac{\\mathbf{k}' + \\mathbf{k}}{2} \\cdot \\mathbf{s}\n$$\nDefining the momentum transfer $\\mathbf{q} = \\mathbf{k}' - \\mathbf{k}$ and the average momentum $\\mathbf{K} = (\\mathbf{k}' + \\mathbf{k})/2$, the phase is $-i\\mathbf{q} \\cdot \\mathbf{R} + i\\mathbf{K} \\cdot \\mathbf{s}$. The scattering amplitude integral separates into a product of two Fourier transforms:\n$$\nf_{\\mathrm{nonloc}}(\\mathbf{q}, \\mathbf{K}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\left[ \\int e^{-i\\mathbf{q} \\cdot \\mathbf{R}} V(R) d^3R \\right] \\left[ \\int e^{i\\mathbf{K} \\cdot \\mathbf{s}} g(s) d^3s \\right] = -\\frac{\\mu}{2\\pi\\hbar^2} \\tilde{V}(\\mathbf{q}) \\tilde{g}(-\\mathbf{K})\n$$\nThe potential forms are $V(r) = -V_0 \\exp(-r^2/a^2)$ and $g(s) \\propto \\exp(-s^2/\\beta^2)$. For the standard Perey-Buck form, the kernel $g(s)$ is normalized such that $\\int g(s) d^3s = 1$, which requires $g(s) = (\\pi \\beta^2)^{-3/2} \\exp(-s^2/\\beta^2)$.\nThe 3D Fourier transform of a Gaussian $G(\\mathbf{x}) = \\exp(-|\\mathbf{x}|^2/b^2)$ is $\\tilde{G}(\\mathbf{p}) = (\\pi b^2)^{3/2} \\exp(-p^2 b^2/4)$.\nApplying this, we get:\n$$\n\\tilde{V}(q) = -V_0 (\\pi a^2)^{3/2} \\exp(-q^2 a^2/4)\n$$\n$$\n\\tilde{g}(K) = \\int e^{-i\\mathbf{K} \\cdot \\mathbf{s}} (\\pi \\beta^2)^{-3/2} e^{-s^2/\\beta^2} d^3s = \\exp(-K^2 \\beta^2/4)\n$$\nSince $g(s)$ is an even function, $\\tilde{g}(-\\mathbf{K}) = \\tilde{g}(\\mathbf{K})$. The nonlocal scattering amplitude is:\n$$\nf_{\\mathrm{nonloc}}(\\mathbf{q}, \\mathbf{K}) = -\\frac{\\mu}{2\\pi\\hbar^2} \\left[-V_0 (\\pi a^2)^{3/2} e^{-q^2 a^2/4}\\right] \\left[e^{-K^2 \\beta^2/4}\\right]\n$$\nA purely local potential corresponds to $\\beta \\to 0$, where $g(s) \\to \\delta(\\mathbf{s})$ and $\\tilde{g}(K) \\to 1$. Thus, the amplitude for the local potential $V(r)$ is:\n$$\nf_{\\mathrm{loc}}(q) = -\\frac{\\mu}{2\\pi\\hbar^2} \\tilde{V}(q) = \\frac{\\mu V_0 (\\pi a^2)^{3/2}}{2\\pi\\hbar^2} e^{-q^2 a^2/4}\n$$\nComparing the two, we find $f_{\\mathrm{nonloc}}(q, K) = f_{\\mathrm{loc}}(q) \\exp(-K^2 \\beta^2/4)$.\n\nThe differential cross section is $\\frac{d\\sigma}{d\\Omega} = |f|^2$.\nFor the local potential: $\\sigma_{\\mathrm{loc}}(\\theta) = |f_{\\mathrm{loc}}(q(\\theta))|^2$.\nFor the nonlocal potential: $\\sigma_{\\mathrm{nonloc}}(\\theta) = |f_{\\mathrm{nonloc}}(q(\\theta), K(\\theta))|^2 = |f_{\\mathrm{loc}}(q(\\theta))|^2 |e^{-K(\\theta)^2 \\beta^2/4}|^2 = \\sigma_{\\mathrm{loc}}(\\theta) e^{-K(\\theta)^2 \\beta^2/2}$.\n\nThe magnitudes of $q$ and $K$ depend on the scattering angle $\\theta$:\n$q = |\\mathbf{k}' - \\mathbf{k}| = 2k \\sin(\\theta/2)$\n$K = |(\\mathbf{k}' + \\mathbf{k})/2| = k \\cos(\\theta/2)$\n\nThe local-equivalent model is defined by an amplitude where the nonlocal correction factor is \"frozen\" at its forward-angle value ($\\theta=0$). At $\\theta=0$, we have $q=0$ and $K=k$. The correction factor becomes $\\exp(-k^2 \\beta^2/4)$.\n$$\nf_{\\mathrm{loc\\_equiv}}(\\theta) = f_{\\mathrm{loc}}(q(\\theta)) \\cdot e^{-k^2 \\beta^2/4}\n$$\nThe corresponding cross section is:\n$$\n\\sigma_{\\mathrm{loc\\_equiv}}(\\theta) = |f_{\\mathrm{loc\\_equiv}}(\\theta)|^2 = |f_{\\mathrm{loc}}(q(\\theta))|^2 |e^{-k^2 \\beta^2/4}|^2 = \\sigma_{\\mathrm{loc}}(\\theta) e^{-k^2 \\beta^2/2}\n$$\nThis form correctly shows that the local-equivalent model has the angular dependence of a local potential but is scaled by an energy-dependent constant that accounts for the nonlocality at zero angle.\n\n### Task 2: Chi-Squared Calculation\nThe reduced chi-squared is $\\chi^2_{\\nu} = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{\\sigma_{\\mathrm{th}}(\\theta_i) - \\sigma_{\\mathrm{exp}}(\\theta_i)}{\\delta \\sigma(\\theta_i)} \\right)^2$.\nThe synthetic experimental data is defined as $\\sigma_{\\mathrm{exp}}(\\theta_i) = s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)$ and its uncertainty is $\\delta \\sigma(\\theta_i) = u \\cdot \\sigma_{\\mathrm{exp}}(\\theta_i) = u \\cdot s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)$.\n\n1.  **For the nonlocal model**, $\\sigma_{\\mathrm{th}} = \\sigma_{\\mathrm{nonloc}}$. The term inside the sum becomes:\n    $$\n    \\left( \\frac{\\sigma_{\\mathrm{nonloc}}(\\theta_i) - s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)}{u \\cdot s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)} \\right)^2 = \\left( \\frac{1 - s}{u \\cdot s} \\right)^2\n    $$\n    This expression is constant for all angles and parameters. Thus,\n    $$\n    \\chi^2_{\\nu}(\\mathrm{nonloc}) = \\left( \\frac{1 - s}{u \\cdot s} \\right)^2\n    $$\n\n2.  **For the local-equivalent model**, $\\sigma_{\\mathrm{th}} = \\sigma_{\\mathrm{loc\\_equiv}}$. The term inside the sum is:\n    $$\n    \\left( \\frac{\\sigma_{\\mathrm{loc\\_equiv}}(\\theta_i) - s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)}{u \\cdot s \\cdot \\sigma_{\\mathrm{nonloc}}(\\theta_i)} \\right)^2 = \\left( \\frac{\\sigma_{\\mathrm{loc\\_equiv}}(\\theta_i)/\\sigma_{\\mathrm{nonloc}}(\\theta_i) - s}{u \\cdot s} \\right)^2\n    $$\n    Using the derived cross sections:\n    $$\n    \\frac{\\sigma_{\\mathrm{loc\\_equiv}}(\\theta_i)}{\\sigma_{\\mathrm{nonloc}}(\\theta_i)} = \\frac{\\sigma_{\\mathrm{loc}}(\\theta_i) e^{-k^2 \\beta^2/2}}{\\sigma_{\\mathrm{loc}}(\\theta_i) e^{-K(\\theta_i)^2 \\beta^2/2}} = e^{-\\frac{\\beta^2}{2} (k^2 - K(\\theta_i)^2)}\n    $$\n    Substituting $K(\\theta_i)^2 = k^2 \\cos^2(\\theta_i/2)$:\n    $$\n    k^2 - K(\\theta_i)^2 = k^2 (1 - \\cos^2(\\theta_i/2)) = k^2 \\sin^2(\\theta_i/2)\n    $$\n    So the ratio is $e^{-\\frac{1}{2} k^2 \\beta^2 \\sin^2(\\theta_i/2)}$. Therefore,\n    $$\n    \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) = \\frac{1}{N} \\sum_{i=1}^{N} \\left( \\frac{e^{-\\frac{1}{2} k^2 \\beta^2 \\sin^2(\\theta_i/2)} - s}{u \\cdot s} \\right)^2\n    $$\n\n### Task 3: Final Computation\nThe quantity to compute is $\\Delta \\chi^2_{\\nu} = \\chi^2_{\\nu}(\\mathrm{loc\\_equiv}) - \\chi^2_{\\nu}(\\mathrm{nonloc})$.\nThe algorithm for each test case is:\n1.  Calculate the reduced mass $\\mu$ and center-of-mass energy $E_{\\mathrm{cm}}$.\n2.  Calculate the squared center-of-mass momentum $k^2 = 2 \\mu E_{\\mathrm{cm}} / (\\hbar c)^2$.\n3.  Calculate the constant value $\\chi^2_{\\nu}(\\mathrm{nonloc}) = ((1-s)/(us))^2$.\n4.  Calculate $\\chi^2_{\\nu}(\\mathrm{loc\\_equiv})$ by summing the angle-dependent terms over the provided set $\\Theta$.\n5.  Compute the difference $\\Delta \\chi^2_{\\nu}$ and round to three decimal places.\n\nThis procedure is implemented in the following Python code.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference in reduced chi-squared between a local-equivalent\n    and a nonlocal optical model for nucleon-nucleus scattering.\n    \"\"\"\n    # Physical constants and unit conventions\n    HBARC = 197.3269804  # MeV fm\n    M_N = 938.92          # MeV/c^2\n\n    # Fixed analysis parameters\n    S_SCALE = 1.02\n    U_UNCERT = 0.05\n    ANGLES_DEG = [0, 30, 60, 90, 120, 150]\n    angles_rad = np.deg2rad(ANGLES_DEG)\n    N_ANGLES = len(ANGLES_DEG)\n\n    # Test suite: (E_lab [MeV], A, V0 [MeV], a [fm], beta [fm])\n    test_cases = [\n        (30, 40, 50, 1.2, 0.85),  # Case 1: Happy path\n        (30, 40, 50, 1.2, 0.0),   # Case 2: Boundary, local limit\n        (65, 90, 52, 1.2, 0.85),  # Case 3: Higher momentum\n    ]\n\n    results = []\n    \n    # Pre-calculate the chi-squared for the nonlocal model, which is constant.\n    # The 'experimental' data is defined from this model, so the chi-squared\n    # just measures the built-in scale mismatch 's'.\n    chi2_nu_nonloc = ((1 - S_SCALE) / (U_UNCERT * S_SCALE))**2\n\n    for case in test_cases:\n        e_lab, A, _, _, beta = case\n        \n        # Check for the trivial local case (beta=0)\n        if beta == 0:\n            # If beta is zero, nonlocality vanishes. The local, nonlocal, and\n            # local-equivalent models are identical. The difference in chi_nu^2\n            # must be zero.\n            results.append(0.0)\n            continue\n            \n        # 1. Calculate kinematic quantities\n        mu = M_N * A / (A + 1)\n        e_cm = e_lab * A / (A + 1)\n        \n        # 2. Calculate squared CM momentum k^2\n        k_squared = (2 * mu * e_cm) / (HBARC**2)\n        \n        # 3. Calculate chi-squared for the local-equivalent model\n        sum_of_sq_diffs = 0.0\n        for theta in angles_rad:\n            # The ratio of the local-equivalent to the nonlocal cross section\n            arg_exp = -0.5 * k_squared * beta**2 * np.sin(theta/2)**2\n            sigma_ratio = np.exp(arg_exp)\n            \n            # The term in the chi-squared sum\n            term = ((sigma_ratio - S_SCALE) / (U_UNCERT * S_SCALE))**2\n            sum_of_sq_diffs += term\n            \n        chi2_nu_loc_equiv = sum_of_sq_diffs / N_ANGLES\n        \n        # 4. Compute the difference\n        delta_chi2_nu = chi2_nu_loc_equiv - chi2_nu_nonloc\n        \n        results.append(delta_chi2_nu)\n\n    # Format the final output as a comma-separated list of numbers\n    # rounded to three decimal places, enclosed in square brackets.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "3569711"}]}