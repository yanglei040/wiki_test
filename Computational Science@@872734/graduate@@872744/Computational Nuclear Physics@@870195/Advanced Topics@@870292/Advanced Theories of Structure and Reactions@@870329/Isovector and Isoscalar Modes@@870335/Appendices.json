{"hands_on_practices": [{"introduction": "Theoretical models like the Random Phase Approximation (RPA) often produce a complex spectrum of excited states. This exercise provides hands-on practice in a fundamental analysis technique: calculating energy-weighted moments, or sum rules, from a discrete strength distribution. By computing quantities like the centroid energy from the moments $m_k$, you will learn how to distill the collective character of nuclear excitations, such as the giant monopole resonance, from a list of individual transitions. [@problem_id:3566376]", "problem": "Consider the isoscalar monopole operator $F = \\sum_{i=1}^{A} r_i^2$ in a non-relativistic Skyrme Energy Density Functional (EDF) framework treated with the Random Phase Approximation (RPA). Within linear response theory, the excitation spectrum is characterized by discrete RPA modes with positive energies $E_n  0$ and transition strengths $B_n = \\left|\\langle n | F | 0 \\rangle \\right|^2$. The associated strength function is $S_F(E) = \\sum_{n} B_n \\, \\delta(E - E_n)$, and the energy moments (sum rules) are defined for any real $k$ by $m_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE$. The non-energy-weighted, energy-weighted, and inverse-energy-weighted sum rules correspond to $m_0$, $m_1$, and $m_{-1}$, respectively. The centroid energy is defined as $E_c = m_1/m_0$, and the constrained energy is defined as $E_{\\text{con}} = \\sqrt{m_1/m_{-1}}$.\n\nStarting from the foundational definitions of the strength function and moments above, derive the discrete expressions for $m_0$, $m_1$, and $m_{-1}$ in terms of a finite set of mode energies $E_n$ and strengths $B_n$. Then implement an algorithm that computes $m_0$, $m_1$, $m_{-1}$, the centroid energy $E_c$, and the constrained energy $E_{\\text{con}}$ for several test cases. Your algorithm must use only the discrete data $\\{(E_n, B_n)\\}$ and must not assume any closed-form expressions specific to a particular Skyrme parameterization.\n\nScientific and numerical requirements:\n- Each energy $E_n$ must be strictly positive and expressed in $\\mathrm{MeV}$.\n- Each strength $B_n$ must be non-negative and expressed in $\\mathrm{fm}^4$.\n- The sum rules have units: $m_0$ in $\\mathrm{fm}^4$, $m_1$ in $\\mathrm{MeV}\\cdot\\mathrm{fm}^4$, and $m_{-1}$ in $\\mathrm{fm}^4/\\mathrm{MeV}$.\n- The centroid $E_c$ and constrained energy $E_{\\text{con}}$ must be expressed in $\\mathrm{MeV}$.\n- All outputs must be rounded to six decimal places.\n\nTest suite:\n- Case $1$ (typical multi-peak giant monopole resonance in a heavy nucleus): $E = [10.5, 13.8, 15.6]$ $\\mathrm{MeV}$, $B = [200.0, 600.0, 250.0]$ $\\mathrm{fm}^4$.\n- Case $2$ (single sharp mode): $E = [14.0]$ $\\mathrm{MeV}$, $B = [1000.0]$ $\\mathrm{fm}^4$.\n- Case $3$ (mixture with a low-energy state): $E = [0.5, 17.0, 22.0]$ $\\mathrm{MeV}$, $B = [1.0, 800.0, 150.0]$ $\\mathrm{fm}^4$.\n- Case $4$ (small strengths to test numerical stability): $E = [12.345, 23.456, 34.567]$ $\\mathrm{MeV}$, $B = [0.001, 0.002, 0.003]$ $\\mathrm{fm}^4$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes an inner list formatted as $[m_0, m_1, m_{-1}, E_c, E_{\\text{con}}]$ in the specified units and rounded to six decimal places. For example, the overall output should look like $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],\\dots]$ with no additional text.", "solution": "The problem statement is evaluated as follows.\n\n### Step 1: Extract Givens\n- **Operator**: Isoscalar monopole operator $F = \\sum_{i=1}^{A} r_i^2$.\n- **Framework**: Non-relativistic Skyrme Energy Density Functional (EDF) with Random Phase Approximation (RPA).\n- **Excitation Spectrum**: Discrete RPA modes with energies $E_n  0$ and transition strengths $B_n = \\left|\\langle n | F | 0 \\rangle \\right|^2$.\n- **Strength Function**: $S_F(E) = \\sum_{n} B_n \\, \\delta(E - E_n)$.\n- **Energy Moments (Sum Rules)**: $m_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE$ for any real $k$.\n- **Specific Moments**: $m_0$ (non-energy-weighted), $m_1$ (energy-weighted), $m_{-1}$ (inverse-energy-weighted).\n- **Derived Quantities**: Centroid energy $E_c = m_1/m_0$, constrained energy $E_{\\text{con}} = \\sqrt{m_1/m_{-1}}$.\n- **Task**: Derive discrete expressions for $m_0$, $m_1$, $m_{-1}$ from a finite set of modes $\\{(E_n, B_n)\\}$. Implement an algorithm to compute $m_0$, $m_1$, $m_{-1}$, $E_c$, and $E_{\\text{con}}$.\n- **Numerical Requirements**:\n    - $E_n  0$ in $\\mathrm{MeV}$.\n    - $B_n \\ge 0$ in $\\mathrm{fm}^4$.\n    - Units for $m_0$: $\\mathrm{fm}^4$.\n    - Units for $m_1$: $\\mathrm{MeV}\\cdot\\mathrm{fm}^4$.\n    - Units for $m_{-1}$: $\\mathrm{fm}^4/\\mathrm{MeV}$.\n    - Units for $E_c$, $E_{\\text{con}}$: $\\mathrm{MeV}$.\n    - Output must be rounded to six decimal places.\n- **Test Suite**:\n    - Case $1$: $E = [10.5, 13.8, 15.6]$ $\\mathrm{MeV}$, $B = [200.0, 600.0, 250.0]$ $\\mathrm{fm}^4$.\n    - Case $2$: $E = [14.0]$ $\\mathrm{MeV}$, $B = [1000.0]$ $\\mathrm{fm}^4$.\n    - Case $3$: $E = [0.5, 17.0, 22.0]$ $\\mathrm{MeV}$, $B = [1.0, 800.0, 150.0]$ $\\mathrm{fm}^4$.\n    - Case $4$: $E = [12.345, 23.456, 34.567]$ $\\mathrm{MeV}$, $B = [0.001, 0.002, 0.003]$ $\\mathrm{fm}^4$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is rooted in standard nuclear structure theory. The definitions of the isoscalar monopole operator, strength function, RPA, and sum rules are all standard and correct within the context of nuclear giant resonances. The units are also correct for the quantities involved.\n2.  **Well-Posed**: The problem is clearly defined. It asks for the derivation of discrete formulas from continuous definitions and their application to specific numerical data. The input data is a finite set of discrete modes $\\{(E_n, B_n)\\}$, and the required outputs ($m_0, m_1, m_{-1}, E_c, E_{\\text{con}}$) are uniquely determined by these inputs and the provided definitions. The constraints $E_n  0$ and $B_n \\ge 0$ ensure the quantities are well-defined and physically meaningful.\n3.  **Objective**: The problem is stated in precise, formal language, devoid of any subjectivity or ambiguity.\n4.  **No Other Flaws**: The problem is formalizable, self-contained, and the test data are physically plausible. It requires applying fundamental definitions, which is a valid and non-trivial task in a computational context.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation and Algorithm Design\n\nThe starting point is the definition of the $k$-th energy moment of the strength function, $S_F(E)$:\n$$\nm_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE\n$$\nThe strength function for a discrete spectrum is given as a sum over Dirac delta functions:\n$$\nS_F(E) = \\sum_{n=1}^{N} B_n \\, \\delta(E - E_n)\n$$\nwhere $N$ is the finite number of discrete modes, $E_n$ is the energy of the $n$-th mode, and $B_n$ is its transition strength.\n\nBy substituting the expression for $S_F(E)$ into the integral for $m_k$, we get:\n$$\nm_k = \\int_0^\\infty E^k \\left( \\sum_{n=1}^{N} B_n \\, \\delta(E - E_n) \\right) dE\n$$\nSince the summation is over a finite number of modes, we can interchange the order of summation and integration:\n$$\nm_k = \\sum_{n=1}^{N} B_n \\int_0^\\infty E^k \\, \\delta(E - E_n) \\, dE\n$$\nUsing the sifting property of the Dirac delta function, which states that $\\int f(x) \\delta(x-a) dx = f(a)$, the integral evaluates to $E_n^k$. The condition $E_n  0$ ensures that the integration domain $[0, \\infty)$ includes all mode energies.\nThus, the discrete formula for the $k$-th moment is:\n$$\nm_k = \\sum_{n=1}^{N} B_n E_n^k\n$$\n\nFrom this general result, we can derive the expressions for the specific moments required:\n1.  **Non-energy-weighted sum rule ($m_0$)**: For $k=0$, we have $E_n^0 = 1$.\n    $$\n    m_0 = \\sum_{n=1}^{N} B_n E_n^0 = \\sum_{n=1}^{N} B_n\n    $$\n2.  **Energy-weighted sum rule ($m_1$)**: For $k=1$, we have $E_n^1 = E_n$.\n    $$\n    m_1 = \\sum_{n=1}^{N} B_n E_n^1 = \\sum_{n=1}^{N} B_n E_n\n    $$\n3.  **Inverse-energy-weighted sum rule ($m_{-1}$)**: For $k=-1$, we have $E_n^{-1} = 1/E_n$.\n    $$\n    m_{-1} = \\sum_{n=1}^{N} B_n E_n^{-1} = \\sum_{n=1}^{N} \\frac{B_n}{E_n}\n    $$\n    This expression is well-defined because the problem specifies that all mode energies $E_n$ are strictly positive ($E_n  0$).\n\nNext, we derive the discrete expressions for the centroid and constrained energies using their definitions.\n1.  **Centroid energy ($E_c$)**:\n    $$\n    E_c = \\frac{m_1}{m_0} = \\frac{\\sum_{n=1}^{N} B_n E_n}{\\sum_{n=1}^{N} B_n}\n    $$\n    For the given test cases, the strengths $B_n$ are non-negative and not all zero, so the denominator $m_0$ is strictly positive.\n2.  **Constrained energy ($E_{\\text{con}}$)**:\n    $$\n    E_{\\text{con}} = \\sqrt{\\frac{m_1}{m_{-1}}} = \\sqrt{\\frac{\\sum_{n=1}^{N} B_n E_n}{\\sum_{n=1}^{N} \\frac{B_n}{E_n}}}\n    $$\n    Since $B_n \\ge 0$ and $E_n  0$, both the numerator $m_1$ and the denominator $m_{-1}$ are non-negative. For any non-trivial spectrum (where at least one $B_n  0$), both will be strictly positive, ensuring the argument of the square root is well-defined and positive.\n\n### Computational Algorithm\nThe algorithm will process each test case as follows:\n1.  Input: A list of mode energies $E = [E_1, E_2, \\dots, E_N]$ and a corresponding list of transition strengths $B = [B_1, B_2, \\dots, B_N]$.\n2.  Initialize three variables to $0.0$: `sum_m0`, `sum_m1`, `sum_m_minus_1`.\n3.  Iterate from $n=1$ to $N$:\n    a. Let $E_n$ be the energy and $B_n$ be the strength of the current mode.\n    b. Update `sum_m0` by adding $B_n$.\n    c. Update `sum_m1` by adding $B_n \\times E_n$.\n    d. Update `sum_m_minus_1` by adding $B_n / E_n$.\n4.  After the loop, the variables hold the values for the moments: $m_0 = \\text{sum\\_m0}$, $m_1 = \\text{sum\\_m1}$, and $m_{-1} = \\text{sum\\_m\\_minus\\_1}$.\n5.  Calculate the centroid energy: $E_c = m_1 / m_0$.\n6.  Calculate the constrained energy: $E_{\\text{con}} = \\sqrt{m_1 / m_{-1}}$.\n7.  Collect the five results: $[m_0, m_1, m_{-1}, E_c, E_{\\text{con}}]$.\n8.  Round each of the five values to six decimal places.\n9.  Store the rounded results.\n10. Repeat for all test cases and format the final output as a list of lists.\nVectorized computation using a library like NumPy is highly efficient for this task. An array of energies $E$ and an array of strengths $B$ allow the sums to be computed via element-wise operations and a final sum reduction.\n- $m_0 = \\text{sum}(B)$\n- $m_1 = \\text{sum}(E \\times B)$\n- $m_{-1} = \\text{sum}(B / E)$\nThis approach will be implemented in the final code.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes sum rules and derived energies for nuclear excitation spectra.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (typical multi-peak giant monopole resonance)\n        {'E': [10.5, 13.8, 15.6], 'B': [200.0, 600.0, 250.0]},\n        # Case 2 (single sharp mode)\n        {'E': [14.0], 'B': [1000.0]},\n        # Case 3 (mixture with a low-energy state)\n        {'E': [0.5, 17.0, 22.0], 'B': [1.0, 800.0, 150.0]},\n        # Case 4 (small strengths)\n        {'E': [12.345, 23.456, 34.567], 'B': [0.001, 0.002, 0.003]},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Convert lists to NumPy arrays for vectorized calculations\n        E = np.array(case['E'])\n        B = np.array(case['B'])\n\n        # Calculate the moments m_0, m_1, and m_{-1}\n        # m_k = sum(B_n * E_n^k)\n        \n        # k = 0: m_0 = sum(B_n)\n        m0 = np.sum(B)\n        \n        # k = 1: m_1 = sum(B_n * E_n)\n        m1 = np.sum(B * E)\n        \n        # k = -1: m_{-1} = sum(B_n / E_n)\n        # The problem guarantees E_n  0, so no division by zero.\n        m_minus_1 = np.sum(B / E)\n        \n        # Check for m0 being zero to avoid division by zero for Ec.\n        # Although not expected from the problem's test data.\n        if m0 == 0:\n            # If total strength is zero, all strengths are zero, so m1 is also zero.\n            # Ec is indeterminate (0/0), but 0 is a reasonable assignment.\n            Ec = 0.0\n        else:\n            # Centroid energy: Ec = m_1 / m_0\n            Ec = m1 / m0\n\n        # Check for m_minus_1 being zero for Econ.\n        if m_minus_1 == 0:\n            # If m_minus_1 is 0, m1 must also be 0.\n            # Econ is indeterminate, assigned 0.\n            Econ = 0.0\n        else:\n            # Constrained energy: Econ = sqrt(m_1 / m_{-1})\n            # The argument to sqrt is non-negative as m1 and m_minus_1 are sums\n            # of products/ratios of non-negative numbers.\n            Econ = math.sqrt(m1 / m_minus_1)\n        \n        # Round all results to six decimal places\n        case_results = [\n            round(m0, 6),\n            round(m1, 6),\n            round(m_minus_1, 6),\n            round(Ec, 6),\n            round(Econ, 6)\n        ]\n        \n        results.append(case_results)\n\n    # Format the final output string as a list of lists without spaces.\n    # The default string representation of a list of lists is '[[], [], ...]',\n    # but it includes spaces. We remove them for the exact format.\n    output_str = str(results).replace(\" \", \"\")\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "3566376"}, {"introduction": "A crucial step in any large-scale nuclear structure calculation is to verify its physical integrity by identifying and removing non-physical, or 'spurious,' modes. This problem provides a practical demonstration of how a broken continuous symmetry—in this case, translational invariance—manifests as a spurious state that pollutes the isoscalar dipole response. By implementing a controlled numerical model, you will verify that as the discretization approaches the continuum limit, this spurious mode correctly decouples and its strength vanishes, a critical check for validating computational results. [@problem_id:3566318]", "problem": "Consider small-amplitude, one-dimensional, isoscalar compressional oscillations of a uniform, self-bound nuclear droplet modeled in the long-wavelength hydrodynamic limit by the linear wave equation $ \\rho \\,\\partial_t^2 u(x,t) = C \\,\\partial_x^2 u(x,t) $ on the interval $ x \\in [0,1] $, where $ \\rho $ is a constant mass density, $ C $ is a constant compressional modulus, and $ u(x,t) $ is the displacement field. Free-surface boundary conditions enforce zero stress, which in this model implies $ \\partial_x u(0,t) = \\partial_x u(1,t) = 0 $. Translational invariance guarantees a Goldstone mode $ u(x,t) = \\text{constant} $ with eigenfrequency $ \\omega = 0 $, and the isoscalar electric dipole ($ E1 $) strength should be exhausted by this spurious translational mode, leaving no strength at nonzero frequency.\n\nYou will verify the approach to exact translational invariance in a controlled discretization that includes a vanishing boundary perturbation. Discretize the interval into $ N $ uniformly spaced grid points, indexed $ i = 0,1,\\ldots,N-1 $, and approximate spatial second derivatives by a symmetric three-point stencil in the interior and a one-sided condition at the boundaries. Let the discrete stiffness matrix $ K \\in \\mathbb{R}^{N \\times N} $ represent the discrete operator acting on the displacement vector $ \\mathbf{u} \\in \\mathbb{R}^N $. Use the following construction:\n- For interior indices $ i = 1,2,\\ldots,N-2 $, set $ K_{i,i} = 2 $, $ K_{i,i-1} = -1 $, and $ K_{i,i+1} = -1 $.\n- For the left boundary, set $ K_{0,0} = 1 + \\varepsilon(N) $ and $ K_{0,1} = -1 $.\n- For the right boundary, set $ K_{N-1,N-1} = 1 + \\varepsilon(N) $ and $ K_{N-1,N-2} = -1 $.\n- All other entries are zero.\n\nThe perturbation $ \\varepsilon(N) $ is a small, $ N $-dependent boundary term modeling residual numerical violation of exact translational invariance that vanishes as the numerical precision is increased. For this problem, take $ \\varepsilon(N) = N^{-2} $. Work in dimensionless units where $ \\rho = 1 $ and $ C = 1 $, so that the discrete generalized eigenproblem reduces to the standard symmetric eigenvalue problem $ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\,\\mathbf{v}_\\nu $ with mass matrix equal to the identity. The discrete isoscalar $ E1 $ operator is represented, up to an irrelevant multiplicative constant, by the vector $ \\mathbf{f} = (1,1,\\ldots,1)^\\top \\in \\mathbb{R}^N $, which measures the center-of-mass displacement in the isoscalar channel.\n\nYour tasks are:\n1. For each specified $ N $, construct $ K(N) $ as above and solve $ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\,\\mathbf{v}_\\nu $ to obtain the eigenfrequencies $ \\omega_\\nu \\ge 0 $ and orthonormal eigenvectors $ \\mathbf{v}_\\nu $ in $ \\mathbb{R}^N $ with the standard Euclidean inner product.\n2. Identify the smallest eigenfrequency $ \\omega_0(N) = \\min_\\nu \\omega_\\nu $, which corresponds to the spurious translational mode. Report $ \\omega_0(N) $ as a float.\n3. Quantify the leakage of isoscalar $ E1 $ strength into nonzero-frequency modes. Define the total isoscalar amplitude carried by an eigenmode $ \\nu $ as $ A_\\nu = \\mathbf{v}_\\nu \\cdot \\mathbf{f} $. The total discrete isoscalar $ E1 $ strength is proportional to $ \\sum_\\nu A_\\nu^2 = \\lVert \\mathbf{f} \\rVert^2 = N $ by completeness. The leakage into nonzero modes is therefore $ S_{\\text{leak}}(N) = \\frac{1}{N} \\sum_{\\nu:\\,\\omega_\\nu  0} A_\\nu^2 = 1 - \\frac{A_0^2}{N} $, where $ A_0 $ is the amplitude on the lowest-frequency mode. Report $ S_{\\text{leak}}(N) $ as a float. Both $ \\omega_0(N) $ and $ S_{\\text{leak}}(N) $ should approach $ 0 $ as $ N $ increases if translational invariance is recovered.\n\nNumerical details:\n- Use double-precision linear algebra and orthonormalize eigenvectors by the Euclidean norm. Sorting eigenpairs by nondecreasing $ \\omega_\\nu^2 $ is required to identify $ \\omega_0(N) $.\n- To ensure a consistent comparison across $ N $, report $ \\omega_0(N) $ and $ S_{\\text{leak}}(N) $ rounded to eight decimal places.\n\nTest suite:\n- Use the following values of $ N $: $ N \\in \\{8,16,32,64,128\\} $.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of pairs, one pair per test case, with no spaces. Each pair must be of the form $ [\\omega_0(N),S_{\\text{leak}}(N)] $ with both numbers rounded to eight decimal places. The entire output must be enclosed in square brackets. For example, the intended format is $ [[a_1,b_1],[a_2,b_2],\\ldots] $ with no spaces anywhere in the line.\n\nAll quantities are dimensionless in this problem. The answer must be expressed in dimensionless units as specified, with each float rounded to eight decimal places. The final output must match the exact format described above.", "solution": "### Step 1: Extract Givens\nThe problem provides the following information:\n- **Governing Equation**: $ \\rho \\,\\partial_t^2 u(x,t) = C \\,\\partial_x^2 u(x,t) $ for $x \\in [0,1]$.\n- **Physical Constants**: Mass density $ \\rho = 1 $, compressional modulus $ C = 1 $ (dimensionless units).\n- **Boundary Conditions**: Free-surface, zero stress boundary conditions $ \\partial_x u(0,t) = \\partial_x u(1,t) = 0 $.\n- **Discretization**: The interval is discretized into $ N $ points, indexed $ i = 0,1,\\ldots,N-1 $.\n- **Stiffness Matrix $K$**: An $ N \\times N $ matrix defined by its non-zero elements:\n    - For interior indices $ i \\in \\{1,2,\\ldots,N-2\\} $: $ K_{i,i} = 2 $, $ K_{i,i-1} = -1 $, $ K_{i,i+1} = -1 $.\n    - For the left boundary ($ i=0 $): $ K_{0,0} = 1 + \\varepsilon(N) $, $ K_{0,1} = -1 $.\n    - For the right boundary ($ i=N-1 $): $ K_{N-1,N-1} = 1 + \\varepsilon(N) $, $ K_{N-1,N-2} = -1 $.\n- **Boundary Perturbation**: $ \\varepsilon(N) = N^{-2} $.\n- **Eigenproblem**: $ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\,\\mathbf{v}_\\nu $, where $ \\mathbf{v}_\\nu $ are orthonormal eigenvectors and $ \\omega_\\nu \\ge 0 $ are eigenfrequencies.\n- **Isoscalar E1 Operator**: Represented by the vector $ \\mathbf{f} = (1,1,\\ldots,1)^\\top \\in \\mathbb{R}^N $.\n- **Quantities to Calculate**:\n    1.  The smallest eigenfrequency, $ \\omega_0(N) = \\min_\\nu \\omega_\\nu $.\n    2.  The leakage of isoscalar $ E1 $ strength, $ S_{\\text{leak}}(N) = 1 - \\frac{A_0^2}{N} $, where $ A_\\nu = \\mathbf{v}_\\nu \\cdot \\mathbf{f} $ and $ A_0 $ corresponds to the mode with frequency $ \\omega_0(N) $.\n- **Numerical Details**: Use double-precision floating-point arithmetic. Eigenpairs are to be sorted by non-decreasing $ \\omega_\\nu^2 $. Results $ \\omega_0(N) $ and $ S_{\\text{leak}}(N) $ must be rounded to eight decimal places.\n- **Test Suite**: $ N \\in \\{8, 16, 32, 64, 128\\} $.\n- **Output Format**: A single-line comma-separated list of pairs of the form $ [\\omega_0(N),S_{\\text{leak}}(N)] $, enclosed in outer square brackets, with no spaces. Example: $ [[a_1,b_1],[a_2,b_2]] $.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a critical review based on the extracted givens.\n- **Scientifically Grounded**: The problem uses a simplified but standard model in physics—the linear wave equation in a hydrodynamic limit. The concepts of eigenmodes, Goldstone modes resulting from broken continuous symmetry (translational invariance), and strength functions are cornerstones of many-body physics, including nuclear physics. The discretization scheme is a standard finite-difference method. The formulation is scientifically sound.\n- **Well-Posed**: The core task is to construct a specific, explicitly defined real symmetric matrix $ K $ and compute its eigenvalues and eigenvectors. This is a well-posed problem in numerical linear algebra. The symmetry of $ K $ guarantees real eigenvalues and a complete orthonormal set of eigenvectors, ensuring a unique and stable solution exists for the numerical part.\n- **Objective**: The problem is stated in precise mathematical and algorithmic terms. All quantities ($ K, \\varepsilon(N), \\mathbf{f}, \\omega_0, S_{\\text{leak}} $) are unambiguously defined. The tasks are objective and verifiable.\n- **Completeness and Consistency**: The problem provides all necessary information to construct the matrix $ K $, define the operator $ \\mathbf{f} $, and calculate the required quantities $ \\omega_0(N) $ and $ S_{\\text{leak}}(N) $. The parameters for the test suite are explicitly listed. There are no internal contradictions.\n- **Realism**: The model is a simplification, but the numerical task of analyzing how a discrete model approximates a continuous symmetry is a common and realistic problem in computational physics.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, objective, and self-contained. No flaws were detected. Therefore, the problem is deemed **valid**. We proceed to the solution.\n\n### Principle-Based Design\nThe problem asks for a numerical analysis of a discretized one-dimensional wave equation, which models oscillations in a simplified nuclear droplet. The focus is on the properties of the lowest-frequency mode, which corresponds to the translational Goldstone mode of the continuous system.\n\nThe equation of motion for the discrete displacement vector $ \\mathbf{u}(t) \\in \\mathbb{R}^N $ is $ \\partial_t^2 \\mathbf{u}(t) = -K \\mathbf{u}(t) $, assuming unit mass matrix as specified. Seeking normal mode solutions of the form $ \\mathbf{u}(t) = \\mathbf{v} e^{-i\\omega t} $ leads to the standard symmetric eigenvalue problem $ K \\mathbf{v} = \\omega^2 \\mathbf{v} $.\n\nThe stiffness matrix $ K \\in \\mathbb{R}^{N \\times N} $ is a discrete representation of the negative second spatial derivative operator, $ -\\partial_x^2 $, with specific boundary conditions. Its construction for a given grid size $ N $ follows the provided rules. The matrix is real and symmetric, which is a crucial property. This guarantees that its eigenvalues $ \\lambda_\\nu = \\omega_\\nu^2 $ are real and non-negative (since $ K $ is positive semi-definite, and made positive definite by the $ \\varepsilon  0 $ perturbation), and that its eigenvectors $ \\mathbf{v}_\\nu $ form an orthonormal basis for $ \\mathbb{R}^N $.\n\nFor each value of $ N $ from the test suite, the algorithm is as follows:\n1.  **Construct the Matrix $ K(N) $**: An $ N \\times N $ matrix is initialized. The main diagonal is set to $ 2 $, and the first off-diagonals are set to $ -1 $, representing the standard three-point finite-difference stencil for the second derivative. The boundary elements are then adjusted according to the given rules: $ K_{0,0} $ and $ K_{N-1, N-1} $ are set to $ 1 + \\varepsilon(N) $, where $ \\varepsilon(N) = N^{-2} $.\n\n2.  **Solve the Eigenproblem**: The eigenvalue problem $ K \\mathbf{v}_\\nu = \\omega_\\nu^2 \\mathbf{v}_\\nu $ is solved numerically. A robust method for this task, such as the one implemented in `numpy.linalg.eigh`, is used. This function is ideal as it is optimized for symmetric matrices and returns the eigenvalues sorted in non-decreasing order and the corresponding orthonormal eigenvectors as columns of a matrix.\n\n3.  **Calculate $ \\omega_0(N) $**: The smallest eigenvalue returned is $ \\lambda_0 = \\omega_0^2 $. The lowest eigenfrequency is then computed as $ \\omega_0(N) = \\sqrt{\\lambda_0} $. The corresponding eigenvector, $ \\mathbf{v}_0 $, is the first column of the eigenvector matrix returned by the solver.\n\n4.  **Calculate $ S_{\\text{leak}}(N) $**: The leakage of the isoscalar $ E1 $ strength into non-spurious modes is quantified.\n    - The discrete isoscalar operator is given as $ \\mathbf{f} = (1,1,\\ldots,1)^\\top $.\n    - The amplitude of the lowest mode is calculated by projecting $ \\mathbf{f} $ onto the corresponding eigenvector: $ A_0 = \\mathbf{v}_0 \\cdot \\mathbf{f} $.\n    - The leakage is then computed using the given formula: $ S_{\\text{leak}}(N) = 1 - \\frac{A_0^2}{N} $.\n\nThe quantities $ \\omega_0(N) $ and $ S_{\\text{leak}}(N) $ measure the extent to which the translational symmetry is broken by the discretization and the explicit boundary perturbation $ \\varepsilon(N) $. In the limit of a perfect continuum or for $ \\varepsilon=0 $, one would find $ \\omega_0 = 0 $ and $ S_{\\text{leak}} = 0 $. The numerical calculation will demonstrate the convergence towards this ideal limit as $ N $ increases. The final results are formatted to eight decimal places as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical problem for a series of grid sizes N.\n    For each N, it constructs the stiffness matrix K, solves the eigenproblem,\n    and calculates the lowest eigenfrequency and the E1 strength leakage.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [8, 16, 32, 64, 128]\n\n    # List to store the results for each test case.\n    results = []\n\n    for N in test_cases:\n        # Define the boundary perturbation.\n        epsilon = float(N)**-2\n\n        # Construct the stiffness matrix K.\n        # Initialize with the standard 3-point stencil for the 2nd derivative.\n        K = (np.diag(2 * np.ones(N), 0) -\n             np.diag(np.ones(N - 1), 1) -\n             np.diag(np.ones(N - 1), -1))\n\n        # Apply the boundary conditions and the epsilon perturbation.\n        K[0, 0] = 1.0 + epsilon\n        K[N - 1, N - 1] = 1.0 + epsilon\n\n        # Solve the symmetric eigenvalue problem K*v = (w^2)*v.\n        # numpy.linalg.eigh is suitable for symmetric matrices and returns\n        # sorted eigenvalues and orthonormal eigenvectors.\n        eigenvalues_sq, eigenvectors = np.linalg.eigh(K)\n\n        # The smallest eigenvalue corresponds to omega_0^2.\n        omega_0_sq = eigenvalues_sq[0]\n        # The eigenfrequency is the square root. The eigenvalue is non-negative.\n        omega_0 = np.sqrt(omega_0_sq)\n\n        # The corresponding eigenvector v_0 is the first column.\n        v_0 = eigenvectors[:, 0]\n\n        # Define the discrete isoscalar E1 operator f.\n        f = np.ones(N)\n\n        # Calculate the amplitude A_0 on the lowest-frequency mode.\n        A_0 = np.dot(v_0, f)\n        \n        # Calculate the leakage of E1 strength into nonzero-frequency modes.\n        # The total strength is norm(f)^2 = N.\n        S_leak = 1.0 - (A_0**2) / N\n\n        # Store the calculated pair of values.\n        results.append((omega_0, S_leak))\n\n    # Format the final output string exactly as specified.\n    # Each number is rounded to eight decimal places.\n    # The output is a list of pairs, with no spaces.\n    # e.g., [[val1,val2],[val3,val4]]\n    pair_strings = [f\"[{w:.8f},{s:.8f}]\" for w, s in results]\n    final_output = f\"[{','.join(pair_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n\n```", "id": "3566318"}, {"introduction": "Isoscalar and isovector modes provide a powerful lens for dissecting the nuclear Hamiltonian and comparing the predictive power of different theoretical models. This practice problem places you in the role of a research physicist, tasking you with diagnosing a deficiency in a simplified Energy Density Functional (EDF) by comparing its predictions to a benchmark *ab initio* calculation. You will see firsthand how the isovector response acts as a sensitive probe of the underlying nuclear interaction, revealing signatures consistent with missing physics such as isovector three-body forces. [@problem_id:3566329]", "problem": "You are tasked with designing and implementing a numerical program that models electric dipole ($E1$) response in medium-mass nuclei using a simplified linear response framework, separating isovector and isoscalar modes, and comparing the resulting strengths between an ab initio Coupled Cluster (CC) calculation with Chiral Effective Field Theory (EFT) interactions and an Energy Density Functional (EDF) calculation. The goal is to identify a deficiency consistent with a missing isovector three-body contribution in the EDF by analyzing the relative integrated $E1$ strengths.\n\nBegin from the following foundational bases and definitions:\n\n- In the linear response regime for a nucleus described by a ground state $\\lvert \\Psi_0 \\rangle$ and discrete excited states $\\{ \\lvert \\Psi_k \\rangle \\}$ at excitation energies $\\{ \\omega_k \\}$, the strength function for an operator $\\hat{O}$ is\n$$\nS_{\\hat{O}}(\\omega) = \\sum_{k} \\left| \\langle \\Psi_0 \\lvert \\hat{O} \\rvert \\Psi_k \\rangle \\right|^2 \\, \\delta(\\omega - \\omega_k).\n$$\nWith Lorentzian broadening of width $\\Gamma$, the Dirac delta function is replaced by \n$$\nL(\\omega; \\omega_k, \\Gamma) = \\frac{1}{\\pi}\\frac{\\Gamma}{(\\omega-\\omega_k)^2 + \\Gamma^2},\n$$\nand the energy-integrated strength over all $\\omega$ remains\n$$\n\\int_{0}^{\\infty} S_{\\hat{O}}(\\omega)\\, d\\omega = \\sum_{k} \\left| \\langle \\Psi_0 \\lvert \\hat{O} \\rvert \\Psi_k \\rangle \\right|^2,\n$$\nindependent of $\\Gamma$.\n\n- Consider the electric dipole ($E1$) operator decomposed into isovector and isoscalar modes via proton ($p$) and neutron ($n$) contributions. Let $Z$ be the proton number, $N$ be the neutron number, and $A = Z + N$ be the mass number. For each discrete mode $k$, you are provided effective, center-of-mass-cleaned proton and neutron dipole amplitude integrals $D_{p,k}$ and $D_{n,k}$ in femtometres ($\\mathrm{fm}$). In this simplified model, the isovector $E1$ matrix element is defined as\n$$\nM_{\\mathrm{IV},k} = e_p^{\\mathrm{IV}}\\, D_{p,k} + e_n^{\\mathrm{IV}}\\, D_{n,k},\n$$\nwith effective charges\n$$\ne_p^{\\mathrm{IV}} = \\frac{N}{A}, \\quad e_n^{\\mathrm{IV}} = -\\frac{Z}{A}.\n$$\nThe isoscalar $E1$ matrix element (representing a compressional $E1$ proxy in this discrete model) is defined as\n$$\nM_{\\mathrm{IS},k} = D_{p,k} + D_{n,k}.\n$$\nThe corresponding discrete strengths are\n$$\nB_{\\mathrm{IV},k} = \\left| M_{\\mathrm{IV},k} \\right|^2, \\quad B_{\\mathrm{IS},k} = \\left| M_{\\mathrm{IS},k} \\right|^2,\n$$\nand the integrated strengths are\n$$\nS_{\\mathrm{IV}} = \\sum_{k} B_{\\mathrm{IV},k}, \\quad S_{\\mathrm{IS}} = \\sum_{k} B_{\\mathrm{IS},k}.\n$$\nAll strengths must be expressed in units of $e^2\\,\\mathrm{fm}^2$. Energies must be treated in megaelectronvolts ($\\mathrm{MeV}$). Angles do not enter this problem.\n\n- Comparison between CC and EDF predictions will be made for integrated strengths $S_{\\mathrm{IV}}$ and $S_{\\mathrm{IS}}$. To emulate an EDF missing an isovector three-body term, define its proton and neutron amplitude integrals for each mode $k$ by a mixing rule\n$$\nD^{\\mathrm{EDF}}_{p,k} = (1-f)\\,D^{\\mathrm{CC}}_{p,k} + f\\,D^{\\mathrm{CC}}_{n,k}, \\quad\nD^{\\mathrm{EDF}}_{n,k} = (1-f)\\,D^{\\mathrm{CC}}_{n,k} + f\\,D^{\\mathrm{CC}}_{p,k},\n$$\nwhere $f \\in [0, 0.5]$ is a dimensionless mixing factor quantifying isovector-quenching. This mixing reduces proton-neutron contrast and selectively suppresses isovector strength while leaving the isoscalar sum $D_{p,k}+D_{n,k}$ invariant.\n\n- Define diagnostics:\n    1. The isovector relative deviation\n    $$\n    r_{\\mathrm{IV}} = \\begin{cases}\n    \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IV}}}{S^{\\mathrm{EDF}}_{\\mathrm{IV}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}}  0,\\\\\n    0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} = 0,\n    \\end{cases}\n    $$\n    2. The isoscalar relative deviation\n    $$\n    r_{\\mathrm{IS}} = \\begin{cases}\n    \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IS}}}{S^{\\mathrm{EDF}}_{\\mathrm{IS}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}}  0,\\\\\n    0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0.\n    \\end{cases}\n    $$\n    3. A boolean indicator for a missing EDF isovector three-body term,\n    $$\n    \\text{missing\\_IV\\_3body} = \\begin{cases}\n    \\text{True},  \\text{if } r_{\\mathrm{IV}}  \\tau_{\\mathrm{IV}} \\text{ and } \\left| r_{\\mathrm{IS}} \\right| \\le \\tau_{\\mathrm{IS}},\\\\\n    \\text{False},  \\text{otherwise},\n    \\end{cases}\n    $$\n    with thresholds $\\tau_{\\mathrm{IV}} = 0.10$ and $\\tau_{\\mathrm{IS}} = 0.05$.\n\nYour program must implement the above logic for the following test suite. For each case, treat the widths as $\\Gamma = 1.0\\,\\mathrm{MeV}$ (this choice does not affect integrated strengths but provides physical realism).\n\nTest Suite (all energies in $\\mathrm{MeV}$, all $D$ values in $\\mathrm{fm}$):\n\n- Case 1 (medium-mass nucleus): $Z=28$, $N=32$, $A=60$, $f=0.15$. CC excitations and amplitudes:\n    - $\\omega = [9.0,\\, 15.5,\\, 23.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [1.6,\\, 0.8,\\, 0.5]$,\n    - $D^{\\mathrm{CC}}_{n} = [-0.4,\\, 0.6,\\, 0.2]$.\n\n- Case 2 (symmetric nucleus boundary condition): $Z=20$, $N=20$, $A=40$, $f=0.0$. CC excitations and amplitudes:\n    - $\\omega = [10.0,\\, 18.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [0.3,\\, 0.5]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.3,\\, 0.5]$.\n\n- Case 3 (heavy nucleus, stronger quenching): $Z=50$, $N=70$, $A=120$, $f=0.30$. CC excitations and amplitudes:\n    - $\\omega = [8.0,\\, 12.5,\\, 17.0,\\, 25.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [2.0,\\, 1.5,\\, 1.1,\\, 0.6]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.2,\\, 0.9,\\, 0.8,\\, 0.1]$.\n\n- Case 4 (edge case with vanishing amplitudes): $Z=14$, $N=14$, $A=28$, $f=0.0$. CC excitations and amplitudes:\n    - $\\omega = [20.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [0.0]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.0]$.\n\nTasks:\n\n1. For each case, construct the EDF amplitudes using the mixing rule above with the given $f$.\n2. Compute $S^{\\mathrm{CC}}_{\\mathrm{IV}}$, $S^{\\mathrm{EDF}}_{\\mathrm{IV}}$, $S^{\\mathrm{CC}}_{\\mathrm{IS}}$, and $S^{\\mathrm{EDF}}_{\\mathrm{IS}}$ in units of $e^2\\,\\mathrm{fm}^2$.\n3. Compute $r_{\\mathrm{IV}}$ and the boolean $\\text{missing\\_IV\\_3body}$ using the thresholds $\\tau_{\\mathrm{IV}} = 0.10$ and $\\tau_{\\mathrm{IS}} = 0.05$. When a denominator in $r_{\\mathrm{IV}}$ or $r_{\\mathrm{IS}}$ is zero, define the corresponding ratio to be $0$.\n4. Express each $r_{\\mathrm{IV}}$ as a float rounded to six decimal places. The final output must be a single line containing a comma-separated list enclosed in square brackets, consisting of alternating entries for each case: $[r_{\\mathrm{IV},1}, \\text{missing\\_IV\\_3body}_1, r_{\\mathrm{IV},2}, \\text{missing\\_IV\\_3body}_2, \\dots]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").", "solution": "The problem requires the design and implementation of a numerical program to compute and compare the electric dipole ($E1$) response of atomic nuclei, separating it into isovector and isoscalar components. The comparison is made between a benchmark ab initio Coupled Cluster (CC) calculation and a simplified Energy Density Functional (EDF) model. The objective is to identify a specific deficiency in the EDF model, posited to arise from a missing isovector three-body force contribution, by evaluating a set of diagnostic quantities.\n\nThe solution will be developed by first formalizing the calculation of all necessary quantities, then outlining the algorithmic procedure for a single test case, and finally implementing this procedure in a program that processes the entire test suite.\n\nFirst, we establish the core quantities. The nucleus is defined by its proton number $Z$, neutron number $N$, and mass number $A = Z+N$. The fundamental inputs for a given nucleus are the discrete excitation energies $\\{\\omega_k\\}$ and the corresponding center-of-mass-cleaned proton and neutron dipole amplitude integrals, $\\{D_{p,k}\\}$ and $\\{D_{n,k}\\}$. These quantities are provided from a reference CC calculation, denoted with the superscript 'CC'.\n\nThe analysis hinges on the isovector (IV) and isoscalar (IS) decompositions of the $E1$ response. For a given discrete transition $k$, the isovector matrix element is given by\n$$\nM_{\\mathrm{IV},k} = e_p^{\\mathrm{IV}}\\, D_{p,k} + e_n^{\\mathrm{IV}}\\, D_{n,k},\n$$\nwhere the isovector effective charges are $e_p^{\\mathrm{IV}} = N/A$ and $e_n^{\\mathrm{IV}} = -Z/A$. This can be rewritten more compactly as\n$$\nM_{\\mathrm{IV},k} = \\frac{N}{A} D_{p,k} - \\frac{Z}{A} D_{n,k} = \\frac{1}{A}(N D_{p,k} - Z D_{n,k}).\n$$\nThe isoscalar matrix element, which is a proxy for compressional motion, is defined as the sum of the proton and neutron amplitudes:\n$$\nM_{\\mathrm{IS},k} = D_{p,k} + D_{n,k}.\n$$\nThe integrated strengths for the isovector and isoscalar modes are the sums of the squared matrix elements over all discrete states $k$:\n$$\nS_{\\mathrm{IV}} = \\sum_{k} |M_{\\mathrm{IV},k}|^2, \\quad S_{\\mathrm{IS}} = \\sum_{k} |M_{\\mathrm{IS},k}|^2.\n$$\nThese formulas apply to both the CC reference calculation and the EDF model calculation, substituting the respective dipole amplitudes. The units of strength are $e^2\\,\\mathrm{fm}^2$. The excitation energies $\\omega_k$ and the broadening width $\\Gamma$ do not enter the calculation of integrated strengths, as stated in the problem.\n\nNext, we establish the relationship between the CC and EDF models. The EDF model's amplitudes are derived from the CC amplitudes via a mixing rule parametrized by a factor $f \\in [0, 0.5]$:\n$$\nD^{\\mathrm{EDF}}_{p,k} = (1-f)\\,D^{\\mathrm{CC}}_{p,k} + f\\,D^{\\mathrm{CC}}_{n,k},\n$$\n$$\nD^{\\mathrm{EDF}}_{n,k} = (1-f)\\,D^{\\mathrm{CC}}_{n,k} + f\\,D^{\\mathrm{CC}}_{p,k}.\n$$\nThis mixing emulates a quenching of the proton-neutron distinction. We must now determine the effect of this mixing on the isovector and isoscalar strengths.\n\nFor the isoscalar component, the EDF matrix element for mode $k$ is:\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IS},k} = D^{\\mathrm{EDF}}_{p,k} + D^{\\mathrm{EDF}}_{n,k} = \\left((1-f)D^{\\mathrm{CC}}_{p,k} + fD^{\\mathrm{CC}}_{n,k}\\right) + \\left((1-f)D^{\\mathrm{CC}}_{n,k} + fD^{\\mathrm{CC}}_{p,k}\\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IS},k} = (1-f+f)D^{\\mathrm{CC}}_{p,k} + (f+1-f)D^{\\mathrm{CC}}_{n,k} = D^{\\mathrm{CC}}_{p,k} + D^{\\mathrm{CC}}_{n,k} = M^{\\mathrm{CC}}_{\\mathrm{IS},k}.\n$$\nSince the matrix elements are identical for each mode $k$, the integrated isoscalar strength is invariant under this transformation: $S^{\\mathrm{EDF}}_{\\mathrm{IS}} = S^{\\mathrm{CC}}_{\\mathrm{IS}}$.\n\nFor the isovector component, the EDF matrix element is:\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A}(N D^{\\mathrm{EDF}}_{p,k} - Z D^{\\mathrm{EDF}}_{n,k}).\n$$\nSubstituting the mixing rule:\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( N\\left[(1-f)D^{\\mathrm{CC}}_{p,k} + fD^{\\mathrm{CC}}_{n,k}\\right] - Z\\left[(1-f)D^{\\mathrm{CC}}_{n,k} + fD^{\\mathrm{CC}}_{p,k}\\right] \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( [N(1-f) - Zf]D^{\\mathrm{CC}}_{p,k} + [Nf - Z(1-f)]D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( [N - (N+Z)f]D^{\\mathrm{CC}}_{p,k} + [-Z + (N+Z)f]D^{\\mathrm{CC}}_{n,k} \\right)\n$$\nUsing $A=N+Z$:\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( (N - Af)D^{\\mathrm{CC}}_{p,k} + (-Z + Af)D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A}(N D^{\\mathrm{CC}}_{p,k} - Z D^{\\mathrm{CC}}_{n,k}) - \\frac{Af}{A}(D^{\\mathrm{CC}}_{p,k} - D^{\\mathrm{CC}}_{n,k})\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = M^{\\mathrm{CC}}_{\\mathrm{IV},k} - f(D^{\\mathrm{CC}}_{p,k} - D^{\\mathrm{CC}}_{n,k}).\n$$\nThis simplified expression reveals that the mixing introduces a term proportional to $f$ and the difference between the proton and neutron amplitudes, which directly modifies the isovector matrix element.\n\nThe diagnostic quantities can now be computed. The isoscalar relative deviation is:\n$$\nr_{\\mathrm{IS}} = \\begin{cases} \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IS}}}{S^{\\mathrm{EDF}}_{\\mathrm{IS}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}}  0,\\\\ 0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0. \\end{cases}\n$$\nSince we proved $S^{\\mathrm{EDF}}_{\\mathrm{IS}} = S^{\\mathrm{CC}}_{\\mathrm{IS}}$, if $S^{\\mathrm{EDF}}_{\\mathrm{IS}}  0$, the ratio is $1$, making $r_{\\mathrm{IS}} = 1 - 1 = 0$. If $S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0$, $r_{\\mathrm{IS}}$ is defined as $0$. Thus, $r_{\\mathrm{IS}}$ is always $0$.\n\nThe isovector relative deviation is:\n$$\nr_{\\mathrm{IV}} = \\begin{cases} \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IV}}}{S^{\\mathrm{EDF}}_{\\mathrm{IV}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}}  0,\\\\ 0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} = 0. \\end{cases}\n$$\nThe boolean indicator for a missing isovector three-body term is:\n$$\n\\text{missing\\_IV\\_3body} = \\begin{cases} \\text{True},  \\text{if } r_{\\mathrm{IV}}  \\tau_{\\mathrm{IV}} \\text{ and } \\left| r_{\\mathrm{IS}} \\right| \\le \\tau_{\\mathrm{IS}},\\\\ \\text{False},  \\text{otherwise}, \\end{cases}\n$$\nwith given thresholds $\\tau_{\\mathrm{IV}} = 0.10$ and $\\tau_{\\mathrm{IS}} = 0.05$. Since $|r_{\\mathrm{IS}}| = 0$ and $0 \\le 0.05$, the second condition is always true. The criterion simplifies to: $\\text{missing\\_IV\\_3body} = \\text{True}$ if and only if $r_{\\mathrm{IV}}  0.10$.\n\nThe algorithmic procedure for each test case is as follows:\n1.  Receive as input $Z, N, f$ and the arrays of CC amplitudes $D^{\\mathrm{CC}}_{p}$ and $D^{\\mathrm{CC}}_{n}$.\n2.  Calculate $A = Z+N$.\n3.  Using vector operations on the arrays, compute the CC matrix elements for all modes $k$:\n    -   $M^{\\mathrm{CC}}_{\\mathrm{IV}} = (1/A) \\cdot (N \\cdot D^{\\mathrm{CC}}_{p} - Z \\cdot D^{\\mathrm{CC}}_{n})$\n4.  Compute the integrated CC isovector strength:\n    -   $S^{\\mathrm{CC}}_{\\mathrm{IV}} = \\sum |M^{\\mathrm{CC}}_{\\mathrm{IV}}|^2$\n5.  Using the simplified expression, compute the EDF matrix elements for all modes $k$:\n    -   $M^{\\mathrm{EDF}}_{\\mathrm{IV}} = M^{\\mathrm{CC}}_{\\mathrm{IV}} - f \\cdot (D^{\\mathrm{CC}}_{p} - D^{\\mathrm{CC}}_{n})$\n6.  Compute the integrated EDF isovector strength:\n    -   $S^{\\mathrm{EDF}}_{\\mathrm{IV}} = \\sum |M^{\\mathrm{EDF}}_{\\mathrm{IV}}|^2$\n7.  Calculate $r_{\\mathrm{IV}}$ according to the provided conditional definition, checking if $S^{\\mathrm{EDF}}_{\\mathrm{IV}}$ is zero.\n8.  Determine the boolean value of $\\text{missing\\_IV\\_3body}$ by comparing the computed $r_{\\mathrmiv}}$ to the threshold $\\tau_{\\mathrm{IV}}=0.10$.\n9.  Store and format the resulting $r_{\\mathrm{IV}}$ (rounded to six decimal places) and the boolean value.\n\nThis procedure will be implemented within a loop that iterates through the provided test suite. The `numpy` library is ideal for performing the required vectorized calculations efficiently and accurately.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (medium-mass nucleus)\n        {\n            \"Z\": 28, \"N\": 32, \"f\": 0.15,\n            \"D_cc_p\": np.array([1.6, 0.8, 0.5]),\n            \"D_cc_n\": np.array([-0.4, 0.6, 0.2])\n        },\n        # Case 2 (symmetric nucleus boundary condition)\n        {\n            \"Z\": 20, \"N\": 20, \"f\": 0.0,\n            \"D_cc_p\": np.array([0.3, 0.5]),\n            \"D_cc_n\": np.array([0.3, 0.5])\n        },\n        # Case 3 (heavy nucleus, stronger quenching)\n        {\n            \"Z\": 50, \"N\": 70, \"f\": 0.30,\n            \"D_cc_p\": np.array([2.0, 1.5, 1.1, 0.6]),\n            \"D_cc_n\": np.array([0.2, 0.9, 0.8, 0.1])\n        },\n        # Case 4 (edge case with vanishing amplitudes)\n        {\n            \"Z\": 14, \"N\": 14, \"f\": 0.0,\n            \"D_cc_p\": np.array([0.0]),\n            \"D_cc_n\": np.array([0.0])\n        }\n    ]\n\n    # Diagnostic thresholds\n    tau_IV = 0.10\n    tau_IS = 0.05\n\n    results = []\n    \n    for case in test_cases:\n        Z = case[\"Z\"]\n        N = case[\"N\"]\n        f = case[\"f\"]\n        D_cc_p = case[\"D_cc_p\"]\n        D_cc_n = case[\"D_cc_n\"]\n        \n        A = Z + N\n\n        # --- Coupled Cluster (CC) Calculations ---\n        \n        # Isovector matrix elements for CC\n        # M_IV,k = (N/A)*D_p,k - (Z/A)*D_n,k\n        M_cc_iv_k = (1/A) * (N * D_cc_p - Z * D_cc_n)\n        \n        # Integrated isovector strength for CC\n        # S_IV = sum(|M_IV,k|^2)\n        S_cc_iv = np.sum(np.square(np.abs(M_cc_iv_k)))\n\n        # Isoscalar matrix elements for CC\n        # M_IS,k = D_p,k + D_n,k\n        # This is not strictly needed for the simplified logic but good for completeness\n        M_cc_is_k = D_cc_p + D_cc_n\n        S_cc_is = np.sum(np.square(np.abs(M_cc_is_k)))\n\n        # --- Energy Density Functional (EDF) Calculations ---\n\n        # The mixing rule preserves the isoscalar sum, so S_edf_is = S_cc_is.\n        S_edf_is = S_cc_is\n\n        # Use the derived simplified formula for EDF isovector matrix elements:\n        # M_EDF_IV,k = M_CC_IV,k - f * (D_CC_p,k - D_CC_n,k)\n        M_edf_iv_k = M_cc_iv_k - f * (D_cc_p - D_cc_n)\n\n        # Integrated isovector strength for EDF\n        S_edf_iv = np.sum(np.square(np.abs(M_edf_iv_k)))\n        \n        # --- Diagnostic Calculations ---\n        \n        # Isovector relative deviation\n        if S_edf_iv > 0:\n            r_iv = S_cc_iv / S_edf_iv - 1\n        else:\n            r_iv = 0.0\n\n        # Isoscalar relative deviation is always 0 due to the mixing rule's nature.\n        if S_edf_is > 0:\n            r_is = S_cc_is / S_edf_is - 1\n        else:\n            r_is = 0.0 # which is always 0\n\n        # Boolean indicator for missing isovector three-body term\n        # The condition |r_is| = tau_IS is always true because r_is is 0.\n        is_missing_iv_3body = r_iv > tau_IV\n        \n        # Append results for this case\n        results.append(f\"{r_iv:.6f}\")\n        results.append(str(is_missing_iv_3body))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3566329"}]}