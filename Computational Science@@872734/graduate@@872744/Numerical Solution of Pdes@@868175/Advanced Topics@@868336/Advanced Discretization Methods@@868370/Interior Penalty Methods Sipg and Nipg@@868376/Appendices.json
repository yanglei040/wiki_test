{"hands_on_practices": [{"introduction": "The abstract formulation of Discontinuous Galerkin methods can obscure the practical details of implementation. This first practice provides a hands-on guide to translating the Symmetric Interior Penalty Galerkin (SIPG) bilinear form into its concrete matrix components. By explicitly constructing the local element and face matrices for a simple one-dimensional diffusion problem, you will build foundational intuition for how volume integrals and face-based penalty and consistency terms contribute to the final linear system [@problem_id:3410379].", "problem": "Consider the one-dimensional diffusion problem $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right)=f$ with constant diffusivity $\\kappa>0$ on the periodic domain $[0,1]$. Let the domain be partitioned into a uniform mesh of $N$ elements, each of length $h=\\frac{1}{N}$. Use a Discontinuous Galerkin (DG) discretization with piecewise linear polynomials (polynomial degree $p=1$) and the Symmetric Interior Penalty Galerkin (SIPG) method. Denote by $\\eta>0$ the nondimensional penalty parameter, and let the face-wise penalty be scaled as $\\tau=\\eta \\frac{\\kappa}{h}$.\n\nWork in the elementwise nodal basis on each element $K_e=[x_e,x_{e+1}]$, with local basis functions $\\phi_{1}(x)=1-\\frac{x-x_e}{h}$ and $\\phi_{2}(x)=\\frac{x-x_e}{h}$. Adopt the standard DG definitions for interior faces: for a face shared by a left element $K^{-}$ and a right element $K^{+}$, take outward normals $n^{-}=+1$ and $n^{+}=-1$, the jump $[w]=w^{-}n^{-}+w^{+}n^{+}=w^{-}-w^{+}$, and the average $\\{q\\}=\\frac{1}{2}(q^{-}+q^{+})$.\n\nUsing only the fundamental definition of the SIPG bilinear form,\n\n$$\na(u,v)=\\sum_{K}\\int_{K}\\kappa\\,u'(x)\\,v'(x)\\,dx-\\sum_{F}\\left(\\{\\kappa u'\\},[v]\\right)_{F}-\\sum_{F}\\left(\\{\\kappa v'\\},[u]\\right)_{F}+\\sum_{F}\\left(\\tau\\,[u],[v]\\right)_{F},\n$$\n\nderive the following:\n\n1. The explicit $2\\times 2$ local element volume stiffness matrix $A^{\\mathrm{vol}}$ for any element in the basis $\\{\\phi_{1},\\phi_{2}\\}$.\n\n2. The explicit $4\\times 4$ interior-face contribution matrix $A^{\\mathrm{face}}$ that couples the two neighboring elements across a single interior face, written in $2\\times 2$ block form\n\n$$\nA^{\\mathrm{face}}=\\begin{pmatrix}A^{LL} & A^{LR}\\\\ A^{RL} & A^{RR}\\end{pmatrix},\n$$\n\nwhere $A^{LL}$ and $A^{RR}$ are the on-element $2\\times 2$ blocks (left and right, respectively), and $A^{LR}$ and $A^{RL}$ are the $2\\times 2$ coupling blocks. Clearly identify how the penalty part enters these blocks.\n\n3. Under periodic boundary conditions, assemble the global block-circulant stiffness matrix and form its $2\\times 2$ block Fourier symbol $S(\\theta)$ associated with the discrete mode whose element-wise phase is $\\theta\\in[-\\pi,\\pi)$. Then compute the closed-form expression for the determinant $\\det S(\\theta)$ in terms of $\\kappa$, $\\eta$, $h$, and $\\theta$.\n\nProvide the final answer as the single analytic expression for $\\det S(\\theta)$. No rounding is required.", "solution": "We begin from the definition of the Symmetric Interior Penalty Galerkin (SIPG) bilinear form for the diffusion operator with constant $\\kappa$:\n\n$$\na(u,v)=\\sum_{K}\\int_{K}\\kappa\\,u'(x)\\,v'(x)\\,dx-\\sum_{F}\\left(\\{\\kappa u'\\},[v]\\right)_{F}-\\sum_{F}\\left(\\{\\kappa v'\\},[u]\\right)_{F}+\\sum_{F}\\left(\\tau\\,[u],[v]\\right)_{F},\n$$\n\nwhere for an interior face shared by left element $K^{-}$ and right element $K^{+}$, we use $n^{-}=+1$, $n^{+}=-1$, jump $[w]=w^{-}n^{-}+w^{+}n^{+}=w^{-}-w^{+}$, average $\\{q\\}=\\frac{1}{2}(q^{-}+q^{+})$, and face penalty $\\tau=\\eta \\frac{\\kappa}{h}$ with $\\eta>0$.\n\nWe take a uniform mesh with elements $K_e=[x_e,x_{e+1}]$ of length $h=\\frac{1}{N}$ and use the local linear nodal basis on each element,\n\n$$\n\\phi_{1}(x)=1-\\frac{x-x_e}{h},\\qquad \\phi_{2}(x)=\\frac{x-x_e}{h}.\n$$\n\nTheir derivatives on $K_e$ are constants:\n\n$$\n\\phi_{1}'(x)=-\\frac{1}{h},\\qquad \\phi_{2}'(x)=\\frac{1}{h}.\n$$\n\n\n1. Local element volume stiffness matrix. The element volume contribution is\n\n$$\nA^{\\mathrm{vol}}_{ij}=\\int_{K_e}\\kappa\\,\\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx=\\kappa\\left(\\frac{1}{h^2}\\right)\\int_{x_e}^{x_{e+1}}(\\pm 1)(\\pm 1)\\,dx=\\frac{\\kappa}{h}\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}_{ij}.\n$$\n\nThus,\n\n$$\nA^{\\mathrm{vol}}=\\frac{\\kappa}{h}\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}.\n$$\n\n\n2. Interior-face contribution matrix across a single face. Consider an interior face located at $x=x_i$ between a left element $K^{-}$ and a right element $K^{+}$. We construct the $4\\times 4$ face matrix in the basis $\\{\\phi_{1}^{-},\\phi_{2}^{-},\\phi_{1}^{+},\\phi_{2}^{+}\\}$, grouped into $2\\times 2$ blocks as\n\n$$\nA^{\\mathrm{face}}=\\begin{pmatrix}A^{LL} & A^{LR}\\\\ A^{RL} & A^{RR}\\end{pmatrix},\n$$\n\nwhere superscripts indicate left ($L$) or right ($R$) elements.\n\nWe require the traces at the face and the elementwise derivatives:\n\n$$\n\\phi_{1}^{-}(x_i)=0,\\quad \\phi_{2}^{-}(x_i)=1,\\quad \\phi_{1}^{+}(x_i)=1,\\quad \\phi_{2}^{+}(x_i)=0,\n$$\n\n\n$$\n(\\phi_{1}^{-})'=-\\frac{1}{h},\\quad (\\phi_{2}^{-})'=\\frac{1}{h},\\quad (\\phi_{1}^{+})'=-\\frac{1}{h},\\quad (\\phi_{2}^{+})'=\\frac{1}{h}.\n$$\n\nThe jump and average-derivative factors for each basis function are, for any test/trial function $w$ supported on only one element, its trace and derivative from the other element are zero. Hence, defining the jump vector and the average-derivative vector across the four basis functions,\n\n$$\nj=\\begin{pmatrix}[\\,\\phi_{1}^{-}\\,]\\\\ [\\,\\phi_{2}^{-}\\,]\\\\ [\\,\\phi_{1}^{+}\\,]\\\\ [\\,\\phi_{2}^{+}\\,]\\end{pmatrix} =\\begin{pmatrix}0\\\\ 1\\\\ -1\\\\ 0\\end{pmatrix},\\qquad\nm=\\begin{pmatrix}\\{\\kappa(\\phi_{1}^{-})'\\}\\\\ \\{\\kappa(\\phi_{2}^{-})'\\}\\\\ \\{\\kappa(\\phi_{1}^{+})'\\}\\\\ \\{\\kappa(\\phi_{2}^{+})'\\}\\end{pmatrix} =\\frac{\\kappa}{2h}\\begin{pmatrix}-1\\\\ 1\\\\ -1\\\\ 1\\end{pmatrix}.\n$$\n\nFor trial function $\\psi$ and test function $v$, the face bilinear form reads\n\n$$\na_{F}(\\psi,v)=-\\{\\kappa \\psi'\\}[v]-\\{\\kappa v'\\}[\\psi]+\\tau[\\psi][v].\n$$\n\nTherefore, the $4\\times 4$ face matrix can be compactly written as\n\n$$\nA^{\\mathrm{face}}=-\\,j\\,m^{\\top}-\\,m\\,j^{\\top}+\\tau\\,j\\,j^{\\top}.\n$$\n\nSetting $c=\\frac{\\kappa}{2h}$ and $\\tau=\\eta\\frac{\\kappa}{h}$, we obtain by direct multiplication the four $2\\times 2$ blocks:\n\n$$\nA^{LL}=\\begin{pmatrix}0 & c\\\\ c & -2c+\\tau\\end{pmatrix},\\quad\nA^{LR}=\\begin{pmatrix}-c & 0\\\\ 2c-\\tau & -c\\end{pmatrix},\n$$\n\n\n$$\nA^{RL}=\\begin{pmatrix}-c & 2c-\\tau\\\\ 0 & -c\\end{pmatrix},\\quad\nA^{RR}=\\begin{pmatrix}-2c+\\tau & c\\\\ c & 0\\end{pmatrix}.\n$$\n\nIn these expressions, the penalty part corresponds to the rank-one updates proportional to $\\tau\\,j\\,j^{\\top}$; explicitly, adding $\\tau$ only to the $(2,2)$ entry of $A^{LL}$, to the $(1,1)$ entry of $A^{RR}$, and subtracting $\\tau$ in the off-diagonal blocks at the $(2,1)$ entry of $A^{LR}$ and the $(1,2)$ entry of $A^{RL}$ (consistent with the outer product structure).\n\n3. Global assembly and Fourier symbol. Under periodic boundary conditions, each element contributes its volume matrix to the diagonal block, and each interior face between element $e$ (left) and $e+1$ (right) contributes $A^{LL}$ to block $(e,e)$, $A^{LR}$ to block $(e,e+1)$, $A^{RL}$ to block $(e+1,e)$, and $A^{RR}$ to block $(e+1,e+1)$. Each element has two neighboring faces (left and right), so the total diagonal block for element $e$ is\n\n$$\nK_{0}=A^{\\mathrm{vol}}+A^{LL}+A^{RR}.\n$$\n\nUsing $A^{\\mathrm{vol}}=\\frac{\\kappa}{h}\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}=2c\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}$ and the expressions for $A^{LL}$ and $A^{RR}$, we find\n\n$$\nK_{0}=2c\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}+\\begin{pmatrix}-2c+\\tau & 2c\\\\ 2c & -2c+\\tau\\end{pmatrix}=\\begin{pmatrix}\\tau & 0\\\\ 0 & \\tau\\end{pmatrix}.\n$$\n\nThe upper and lower off-diagonal blocks are, respectively,\n\n$$\nK_{+1}=A^{LR}=\\begin{pmatrix}-c & 0\\\\ 2c-\\tau & -c\\end{pmatrix},\\qquad\nK_{-1}=A^{RL}=\\begin{pmatrix}-c & 2c-\\tau\\\\ 0 & -c\\end{pmatrix}.\n$$\n\nThus, the $2\\times 2$ block Fourier symbol $S(\\theta)$ for mode with element-wise phase $\\theta$ is\n\n$$\nS(\\theta)=K_{0}+K_{+1}\\exp(i\\theta)+K_{-1}\\exp(-i\\theta)=\n\\begin{pmatrix}\n\\tau - c\\left(\\exp(i\\theta)+\\exp(-i\\theta)\\right) & (2c-\\tau)\\exp(-i\\theta)\\\\\n(2c-\\tau)\\exp(i\\theta) & \\tau - c\\left(\\exp(i\\theta)+\\exp(-i\\theta)\\right)\n\\end{pmatrix}.\n$$\n\nUsing $\\exp(i\\theta)+\\exp(-i\\theta)=2\\cos\\theta$, we rewrite\n\n$$\nS(\\theta)=\\begin{pmatrix}\n\\tau-2c\\cos\\theta & (2c-\\tau)\\exp(-i\\theta)\\\\\n(2c-\\tau)\\exp(i\\theta) & \\tau-2c\\cos\\theta\n\\end{pmatrix}.\n$$\n\nThe determinant of a $2\\times 2$ matrix with equal diagonal entries $a=\\tau-2c\\cos\\theta$ and off-diagonal entries $b=(2c-\\tau)\\exp(-i\\theta)$, $\\overline{b}=(2c-\\tau)\\exp(i\\theta)$ is\n\n$$\n\\det S(\\theta)=a^{2}-|b|^{2}=\\left(\\tau-2c\\cos\\theta\\right)^{2}-(2c-\\tau)^{2}.\n$$\n\nSubstituting $c=\\frac{\\kappa}{2h}$ and $\\tau=\\eta\\frac{\\kappa}{h}$ yields $2c=\\frac{\\kappa}{h}$ and\n\n$$\n\\det S(\\theta)=\\left(\\frac{\\kappa}{h}\\right)^{2}\\left[(\\eta-\\cos\\theta)^{2}-(1-\\eta)^{2}\\right].\n$$\n\nThis expression can be factored using the difference of squares:\n\n$$\n(\\eta-\\cos\\theta)^{2}-(1-\\eta)^{2}=\\left((\\eta-\\cos\\theta)-(1-\\eta)\\right)\\left((\\eta-\\cos\\theta)+(1-\\eta)\\right)\n=\\left(2\\eta-1-\\cos\\theta\\right)\\left(1-\\cos\\theta\\right).\n$$\n\nTherefore,\n\n$$\n\\det S(\\theta)=\\left(\\frac{\\kappa}{h}\\right)^{2}\\left(1-\\cos\\theta\\right)\\left(2\\eta-1-\\cos\\theta\\right).\n$$\n\nThis is the requested closed-form expression in terms of $\\kappa$, $\\eta$, $h$, and $\\theta$.", "answer": "$$\\boxed{\\left(\\frac{\\kappa}{h}\\right)^{2}\\left(1-\\cos\\theta\\right)\\left(2\\eta-1-\\cos\\theta\\right)}$$", "id": "3410379"}, {"introduction": "A key feature of interior penalty methods is the penalty term itself, but why is it essential? This exercise explores the concept of stability by examining a \"worst-case\" scenario of an unstable, oscillatory mode [@problem_id:3410396]. By calculating the discrete energy of this mode, you will directly see how the penalty parameter $\\sigma$ controls the energy of non-physical jumps, providing a concrete demonstration of why a sufficiently large penalty is crucial for a stable and meaningful numerical solution.", "problem": "Consider the scalar Poisson equation $-u'' = f$ posed on the one-dimensional domain $[0,1]$ with homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. Let $\\mathcal{T}_h$ be a conforming partition of $[0,1]$ into two equal subintervals (elements) with nodes at $x=0$, $x=1/2$, and $x=1$, so the element size is $h = 1/2$. Let $V_h$ be the space of piecewise constant functions on $\\mathcal{T}_h$ that are allowed to be discontinuous across the interface $x=1/2$. Consider the Symmetric Interior Penalty Galerkin (SIPG) method, where the interior penalty parameter on each face $e$ is taken as $\\sigma/h$, with $\\sigma > 0$, and the Dirichlet boundary conditions are weakly enforced via Nitsche's method. Use the standard discontinuous Galerkin definitions of jumps and averages: at the interior interface $x=1/2$, the jump is $[u] = u^{-} - u^{+}$ and the average is $\\{u'\\} = (u'^{-} + u'^{+})/2$, where the superscripts denote traces from the left and right elements, respectively; at the boundary, the trace $u$ is taken from the adjacent element and the outward normal is used.\n\nConstruct the oscillatory discrete mode $u_h \\in V_h$ that takes the values $u_h(x) = 1$ on the left element $[0,1/2)$ and $u_h(x) = -1$ on the right element $(1/2,1]$. Starting from the fundamental bilinear form of the SIPG method for the Poisson operator and the Nitsche enforcement of homogeneous Dirichlet boundary conditions, derive the interior penalty energy $a(u_h,u_h)$â€”that is, the value of the SIPG bilinear form evaluated with $u_h$ as both arguments. Your derivation must proceed from the definitions of the broken gradient, the jump and average operators, and the penalty scaling. Finally, provide the closed-form analytic expression for $a(u_h,u_h)$ as a function of $\\sigma$ for this mesh with $h = 1/2$.\n\nAnswer format requirement: Report $a(u_h,u_h)$ as a single symbolic expression depending only on $\\sigma$. No numerical rounding is required. In your construction and derivation, interpret why this oscillatory mode would be disallowed by a continuous finite element method but can have small energy under under-penalization in the interior penalty framework.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The problem statement describes a standard application of the Symmetric Interior Penalty Galerkin (SIPG) method to the one-dimensional Poisson equation. All terms, such as the bilinear form, jump and average operators, and Nitsche's method for boundary conditions, are standard in the field of numerical analysis for PDEs. The provided data for the mesh, the finite element space, and the specific function $u_h$ are complete and consistent. Therefore, the problem is deemed valid and a solution can be formulated.\n\nThe SIPG formulation for the Poisson problem $-u'' = f$ on $\\Omega = [0,1]$ with homogeneous Dirichlet boundary conditions $u=0$ on $\\partial\\Omega$ seeks a function $u_h \\in V_h$ such that $a(u_h, v_h) = L(v_h)$ for all $v_h \\in V_h$. The bilinear form $a(u,v)$ is given by:\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_h} \\int_K u' v' \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} \\left( \\{u'\\} [v] + \\{v'\\} [u] \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u] [v]|_e - \\sum_{e \\in \\mathcal{E}_h^b} \\left( u' n_K v + v' n_K u \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u v|_e\n$$\nHere, $\\mathcal{E}_h^i$ is the set of interior faces and $\\mathcal{E}_h^b$ is the set of boundary faces. For our specific problem, when $u=v$, this expression becomes:\n$$\na(u,u) = \\sum_{K \\in \\mathcal{T}_h} \\int_K (u')^2 \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} 2 \\{u'\\} [u]|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u]^2|_e - \\sum_{e \\in \\mathcal{E}_h^b} 2 u' n_K u|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u^2|_e\n$$\nThe domain $[0,1]$ is partitioned into two elements, $K_1 = [0, 1/2]$ and $K_2 = [1/2, 1]$. The element size is $h=1/2$. The interior face is $e_i = \\{1/2\\}$, and the boundary faces are $e_{b0} = \\{0\\}$ and $e_{b1} = \\{1\\}$. The outward unit normals to the domain $\\Omega$ are $n_K = -1$ at $x=0$ and $n_K = 1$ at $x=1$.\n\nThe discrete function $u_h \\in V_h$ is defined as:\n$$\nu_h(x) = \\begin{cases} 1 & \\text{for } x \\in K_1 = [0, 1/2] \\\\ -1 & \\text{for } x \\in K_2 = (1/2, 1] \\end{cases}\n$$\nSince $u_h$ is a piecewise constant function, its derivative within each element is zero: $u_h'(x) = 0$ for $x \\in (0, 1/2)$ and $x \\in (1/2, 1)$.\n\nWe now evaluate each term of $a(u_h, u_h)$:\n\n1.  **Volume Term**: This term measures the energy of the gradient within elements. As $u_h'=0$ almost everywhere, this term is zero.\n    $$\n    \\sum_{K \\in \\mathcal{T}_h} \\int_K (u_h')^2 \\, dx = \\int_{0}^{1/2} (0)^2 \\, dx + \\int_{1/2}^{1} (0)^2 \\, dx = 0\n    $$\n\n2.  **Interior Face Term**: This term is evaluated at the single interior face $e_i = \\{1/2\\}$. We first compute the necessary traces, jump, and average.\n    -   Traces from the left ($^-$) and right ($^+$):\n        $$\n        u_h^- = \\lim_{x \\to 1/2^-} u_h(x) = 1\n        $$\n        $$\n        u_h^+ = \\lim_{x \\to 1/2^+} u_h(x) = -1\n        $$\n    -   Jump of $u_h$:\n        $$\n        [u_h]|_{1/2} = u_h^- - u_h^+ = 1 - (-1) = 2\n        $$\n    -   Traces of the derivative:\n        $$\n        (u_h')^- = \\lim_{x \\to 1/2^-} u_h'(x) = 0\n        $$\n        $$\n        (u_h')^+ = \\lim_{x \\to 1/2^+} u_h'(x) = 0\n        $$\n    -   Average of the derivative:\n        $$\n        \\{u_h'\\}|_{1/2} = \\frac{(u_h')^- + (u_h')^+}{2} = \\frac{0 + 0}{2} = 0\n        $$\n    The interior face contribution consists of the consistency/symmetry term and the penalty term.\n    -   Consistency/Symmetry: $- 2 \\{u_h'\\} [u_h]|_{1/2} = -2 \\cdot (0) \\cdot (2) = 0$.\n    -   Penalty: $\\frac{\\sigma}{h} [u_h]^2|_{1/2}$. With $h=1/2$, this is $\\frac{\\sigma}{1/2} (2)^2 = 2\\sigma \\cdot 4 = 8\\sigma$.\n    The total interior face contribution is $0 + 8\\sigma = 8\\sigma$.\n\n3.  **Boundary Face Terms**: These are evaluated at $e_{b0}=0$ and $e_{b1}=1$.\n    -   **At $x=0$**: The trace is taken from within element $K_1$. The outward normal is $n_K = -1$.\n        -   Trace of $u_h$: $u_h|_0 = u_h(0^+) = 1$.\n        -   Trace of $u_h'$: $u_h'|_0 = u_h'(0^+) = 0$.\n        -   The contribution is $-2 u_h' n_K u_h|_0 + \\frac{\\sigma}{h} u_h^2|_0 = -2 \\cdot (0) \\cdot (-1) \\cdot (1) + \\frac{\\sigma}{1/2} (1)^2 = 0 + 2\\sigma = 2\\sigma$.\n    -   **At $x=1$**: The trace is taken from within element $K_2$. The outward normal is $n_K = 1$.\n        -   Trace of $u_h$: $u_h|_1 = u_h(1^-) = -1$.\n        -   Trace of $u_h'$: $u_h'|_1 = u_h'(1^-) = 0$.\n        -   The contribution is $-2 u_h' n_K u_h|_1 + \\frac{\\sigma}{h} u_h^2|_1 = -2 \\cdot (0) \\cdot (1) \\cdot (-1) + \\frac{\\sigma}{1/2} (-1)^2 = 0 + 2\\sigma = 2\\sigma$.\n    The total boundary face contribution is $2\\sigma + 2\\sigma = 4\\sigma$.\n\n4.  **Total Interior Penalty Energy**: We sum all contributions.\n    $$\n    a(u_h, u_h) = (\\text{Volume Term}) + (\\text{Interior Face Term}) + (\\text{Boundary Face Terms})\n    $$\n    $$\n    a(u_h, u_h) = 0 + 8\\sigma + 4\\sigma = 12\\sigma\n    $$\n\nThe interpretation of this result is as follows. In a standard continuous finite element method (CG-FEM), the trial and test functions must belong to the Sobolev space $H^1([0,1])$, which requires them to be continuous. The function $u_h$ has a jump discontinuity at $x=1/2$ and is therefore not in $H^1([0,1])$. It is simply not an admissible function in a CG-FEM space and is thus \"disallowed\".\n\nIn a discontinuous Galerkin (DG) framework, the function space $V_h$ allows for such discontinuities. The function $u_h$ is a valid member of the piecewise constant space. Its \"energy,\" as measured by the bilinear form $a(u_h, u_h)$, is $12\\sigma$. This energy arises entirely from the penalty terms on the interior and boundary faces, as the bulk (gradient) term is zero. The magnitude of this energy is directly proportional to the penalty parameter $\\sigma$. If $\\sigma$ is chosen to be very small (a condition known as \"under-penalization\"), this highly oscillatory mode $u_h$ will have a very small energy. A stable DG method relies on a sufficiently large $\\sigma$ to ensure that such non-physical oscillations are assigned a large energy, effectively suppressing them in the numerical solution. The existence of such a mode with energy proportional to $\\sigma$ demonstrates the crucial role of the penalty parameter in controlling the inter-element jumps and stabilizing the DG method.\n\nThe final derived expression for the interior penalty energy is $a(u_h, u_h) = 12\\sigma$.", "answer": "$$\\boxed{12\\sigma}$$", "id": "3410396"}, {"introduction": "While the Symmetric (SIPG) and Non-symmetric (NIPG) interior penalty methods appear similar, the choice of symmetry has profound theoretical consequences. This practice challenges you to investigate the NIPG method's properties by deriving its convergence rate in the $L^2$ norm [@problem_id:3410414]. Through a classic duality argument, you will uncover how the loss of adjoint consistency leads to a suboptimal convergence rate, illustrating a key trade-off in the design of DG methods.", "problem": "Consider the scalar diffusion model problem on the unit interval $\\,\\Omega=(0,1)\\,$ with homogeneous Dirichlet boundary conditions:\n$$\n- u'' = f \\quad \\text{in } \\Omega,\\qquad u=0 \\quad \\text{on } \\partial\\Omega.\n$$\nLet the exact solution be $\\,u(x)=\\sin(\\pi x)\\,$ so that $\\,f(x)=\\pi^{2}\\sin(\\pi x)\\,$. Let $\\,\\mathcal{T}_{h}\\,$ be a uniform partition of $\\,\\Omega\\,$ into $\\,N\\,$ subintervals of length $\\,h=1/N\\,$, and let $\\,V_{h}\\,$ be the space of functions that are polynomials of degree at most $\\,1\\,$ on each element (piecewise linear) and are not constrained to be continuous across element interfaces. For an interior node $\\,x_{i}\\,$, denote the traces of $\\,v\\in V_{h}\\,$ by $\\,v(x_{i}^{-})\\,$ and $\\,v(x_{i}^{+})\\,$, and define the jump and average as\n$$\n[v]_{i} := v(x_{i}^{-}) - v(x_{i}^{+}),\\qquad \\{v'\\}_{i} := \\tfrac{1}{2}\\big(v'(x_{i}^{-})+v'(x_{i}^{+})\\big).\n$$\nOn the boundary, let $\\,n(0)=-1\\,$ and $\\,n(1)=+1\\,$. Define the Non-symmetric Interior Penalty Galerkin (NIPG) bilinear form $\\,a_{h}(\\cdot,\\cdot)\\,$ and right-hand side $\\,\\ell_{h}(\\cdot)\\,$ by\n$$\na_{h}(w,v) := \\sum_{K\\in\\mathcal{T}_{h}}\\int_{K} w'v'\\,dx - \\sum_{i=1}^{N-1} \\{w'\\}_{i}\\,[v]_{i} + \\sum_{i=1}^{N-1} \\{v'\\}_{i}\\,[w]_{i} + \\frac{\\eta}{h}\\sum_{i=1}^{N-1}[w]_{i}[v]_{i}\n$$\n$$\n\\phantom{a_{h}(w,v) :=} - w'(0)\\,n(0)\\,v(0) + v'(0)\\,n(0)\\,w(0) + \\frac{\\eta}{h}\\,w(0)\\,v(0) - w'(1)\\,n(1)\\,v(1) + v'(1)\\,n(1)\\,w(1) + \\frac{\\eta}{h}\\,w(1)\\,v(1),\n$$\n$$\n\\ell_{h}(v) := \\sum_{K\\in\\mathcal{T}_{h}}\\int_{K} f\\, v\\,dx,\n$$\nwith a penalty parameter $\\,\\eta>0\\,$ chosen independent of $\\,h\\,$ and sufficiently large to guarantee coercivity in the discrete energy norm\n$$\n\\|v\\|_{1,h}^{2} := \\sum_{K\\in\\mathcal{T}_{h}} \\int_{K} |v'|^{2}\\,dx + \\frac{\\eta}{h}\\sum_{i=1}^{N-1}[v]_{i}^{2} + \\frac{\\eta}{h}\\big(v(0)^{2}+v(1)^{2}\\big).\n$$\nThe NIPG method seeks $\\,u_{h}\\in V_{h}\\,$ such that\n$$\na_{h}(u_{h},v_{h})=\\ell_{h}(v_{h})\\qquad\\text{for all } v_{h}\\in V_{h}.\n$$\nIt is known that this scheme is consistent and coercive and therefore achieves the optimal energy-norm rate with piecewise linear functions. However, the non-symmetry leads to a loss of adjoint consistency.\n\nUsing only the fundamental definitions above, elementwise integration by parts, jump/average calculus, the stability of the dual solution for the one-dimensional Dirichlet Laplacian, and standard approximation and trace inequalities, derive the largest exponent $\\,p_{L^{2}}\\,$ such that there exists a constant $\\,C>0\\,$ independent of $\\,h\\,$ with\n$$\n\\|u-u_{h}\\|_{L^{2}(\\Omega)} \\;\\le\\; C\\, h^{\\,p_{L^{2}}}\\,\\|u\\|_{H^{2}(\\Omega)}\\quad\\text{as } h\\to 0,\n$$\nfor the Nonsymmetric Interior Penalty Galerkin method defined above with piecewise linear approximation. State the value of $\\,p_{L^{2}}\\,$. The final answer must be a single number without units. No rounding is required.", "solution": "The user wants to find the convergence rate in the $L^2$-norm for the Non-symmetric Interior Penalty Galerkin (NIPG) method applied to the one-dimensional Poisson problem $-u''=f$ on $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions.\n\n### Step 1: Problem Validation\nThe problem statement provides a clear and complete definition of a scalar diffusion model problem, its exact solution, the finite element space $V_h$, the NIPG bilinear and linear forms, and the discrete norm. The task is to derive the exponent $p_{L^2}$ in the a priori error estimate $\\|u-u_h\\|_{L^2(\\Omega)} \\leq C h^{p_{L^2}} \\|u\\|_{H^2(\\Omega)}$ using specified mathematical tools. The problem correctly identifies that the non-symmetry of the NIPG form leads to a loss of adjoint consistency, which is a key feature affecting the $L^2$ convergence rate. All definitions and concepts are standard in the field of numerical analysis for PDEs. The problem is scientifically grounded, well-posed, objective, and requires a non-trivial mathematical derivation. The problem is deemed **valid**.\n\n### Step 2: Derivation of the $L^2$ Error Estimate\n\nThe derivation of the $L^2$ error estimate for a finite element method typically proceeds via a duality argument, also known as the Aubin-Nitsche trick.\n\nLet $e=u-u_h$ be the error between the exact solution $u$ and the NIPG solution $u_h$. We want to estimate $\\|e\\|_{L^2(\\Omega)}$.\nConsider the dual (or adjoint) problem: find $\\phi$ such that\n$$\n-\\phi'' = e \\quad \\text{in } \\Omega, \\qquad \\phi=0 \\quad \\text{on } \\partial\\Omega.\n$$\nSince $\\Omega=(0,1)$ is a convex domain, this problem has a unique solution $\\phi$. Standard elliptic regularity theory guarantees that $\\phi \\in H^2(\\Omega)$ and that there exists a stability constant $C_s$, independent of $e$, such that\n$$\n\\|\\phi\\|_{H^2(\\Omega)} \\le C_s \\|e\\|_{L^2(\\Omega)}.\n$$\nFurthermore, since we are in one dimension, $\\phi \\in C^1(\\bar{\\Omega})$.\n\nUsing the dual problem, we can express the squared $L^2$-norm of the error as:\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\int_{\\Omega} e \\cdot e \\, dx = \\int_{\\Omega} e (-\\phi'') \\, dx.\n$$\nBecause the discrete solution $u_h$ (and thus the error $e$) is discontinuous, we must perform integration by parts element-wise:\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\sum_{K \\in \\mathcal{T}_h} \\int_K e (-\\phi'') \\, dx = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K e' \\phi' \\, dx - [e \\phi']_{\\partial K} \\right).\n$$\nThe boundary terms $[e \\phi']_{\\partial K}$ for an element $K=(x_{k-1}, x_k)$ are $e(x_k)\\phi'(x_k) - e(x_{k-1})\\phi'(x_{k-1})$. Summing over all elements $K \\in \\mathcal{T}_h$, the interior boundary terms pair up. Using the jump notation $[v]_i = v(x_i^-) - v(x_i^+)$ and the fact that $\\phi'$ is continuous (so $\\phi'(x_i^-) = \\phi'(x_i^+) = \\phi'(x_i) =: \\{\\phi'\\}_i$), the sum of interior boundary terms is:\n$$\n\\sum_{i=1}^{N-1} (e(x_i^-)\\phi'(x_i) - e(x_i^+)\\phi'(x_i)) = \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i.\n$$\nThe terms at the domain boundary $\\partial\\Omega=\\{0,1\\}$ are $e(1)\\phi'(1) - e(0)\\phi'(0)$. We use the outward normal definition $n(0)=-1, n(1)=1$ to write this as $e(1)\\phi'(1)n(1) + e(0)\\phi'(0)n(0)$.\nTherefore,\n$$\n\\sum_{K \\in \\mathcal{T}_h} [e \\phi']_{\\partial K} = \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i + e(1)\\phi'(1)n(1)+e(0)\\phi'(0)n(0).\n$$\nSubstituting this back, we get:\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\sum_{K \\in \\mathcal{T}_h} \\int_K e' \\phi' \\, dx - \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i - \\sum_{j \\in \\{0,1\\}} e(x_j)\\phi'(x_j)n(j).\n$$\nLet's call this expression $\\mathcal{B}(e, \\phi)$.\n\nThe NIPG solution $u_h$ satisfies $a_h(u_h, v_h) = \\ell_h(v_h)$ for all $v_h \\in V_h$. The exact solution $u$ is smooth, so $[u]_i=0$ and $u=0$ on $\\partial\\Omega$. A direct calculation involving integration by parts shows that the method is consistent: $a_h(u, v_h) = \\ell_h(v_h)$ for all $v_h \\in V_h$.\nSubtracting the two equations yields the Galerkin orthogonality property for the error $e=u-u_h$:\n$$\na_h(e, v_h) = 0 \\quad \\text{for all } v_h \\in V_h.\n$$\nLet $\\phi_h \\in V_h$ be a suitable interpolant of $\\phi$. Since $\\phi_h \\in V_h$, we can use it as a test function in the Galerkin orthogonality relation, so $a_h(e, \\phi_h) = 0$.\nNow we can write:\n$$\n\\|e\\|_{L^2(\\Omega)}^2 = \\mathcal{B}(e, \\phi) - a_h(e, \\phi_h) = \\left( \\mathcal{B}(e, \\phi) - a_h(e, \\phi) \\right) + a_h(e, \\phi - \\phi_h).\n$$\nThis separates the error into two terms. The first term arises from the lack of adjoint consistency, and the second is a standard term in duality arguments.\n\n**Analysis of the second term: $a_h(e, \\phi - \\phi_h)$**\nLet $\\eta_\\phi = \\phi - \\phi_h$. By the continuity of the bilinear form $a_h(\\cdot, \\cdot)$ with respect to the discrete energy norm $\\|\\cdot\\|_{1,h}$, we have:\n$$\n|a_h(e, \\eta_\\phi)| \\le C \\|e\\|_{1,h} \\|\\eta_\\phi\\|_{1,h}.\n$$\nThe problem states that the NIPG scheme achieves the optimal energy-norm convergence rate. For piecewise linear approximations ($k=1$), this means $\\|e\\|_{1,h} \\le C h \\|u\\|_{H^2(\\Omega)}$. Standard approximation theory provides the interpolation error estimate $\\|\\eta_\\phi\\|_{1,h} \\le C h \\|\\phi\\|_{H^2(\\Omega)}$. Combining these with the regularity estimate $\\|\\phi\\|_{H^2(\\Omega)} \\le C_s \\|e\\|_{L^2(\\Omega)}$, we get:\n$$\n|a_h(e, \\eta_\\phi)| \\le C (h \\|u\\|_{H^2(\\Omega)}) (h \\|\\phi\\|_{H^2(\\Omega)}) \\le C' h^2 \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\n\n**Analysis of the first term: $\\mathcal{B}(e, \\phi) - a_h(e, \\phi)$**\nThis term represents the adjoint inconsistency. We need to evaluate $a_h(e, \\phi)$. Since $\\phi$ is a smooth function with $\\phi=0$ on $\\partial\\Omega$, we have $[\\phi]_i=0$ and $\\phi(0)=\\phi(1)=0$. The bilinear form $a_h(e, \\phi)$ simplifies:\n$$\na_h(e, \\phi) = \\sum_{K}\\int_{K} e'\\phi'\\,dx + \\sum_{i} \\{\\phi'\\}_{i}\\,[e]_{i} + \\sum_{j \\in \\{0,1\\}} \\phi'(j)\\,n(j)\\,e(j).\n$$\nThe difference term is then:\n\\begin{align*}\n\\mathcal{B}(e, \\phi) - a_h(e, \\phi) &= \\left( \\sum_K \\int_K e'\\phi' - \\sum_i [e]_i\\{\\phi'\\}_i - \\sum_j e_j\\phi'_j n_j \\right) \\\\\n& \\quad - \\left( \\sum_K \\int_K e'\\phi' + \\sum_i \\{\\phi'\\}_i[e]_i + \\sum_j \\phi'_j n_j e_j \\right) \\\\\n&= -2 \\left( \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i + \\sum_{j \\in \\{0,1\\}} e(j)\\phi'(j)n(j) \\right).\n\\end{align*}\nWe bound this term using Cauchy-Schwarz inequality. Since $e = u-u_h$ and $u$ is continuous with $u=0$ on $\\partial\\Omega$, we have $[e]_i = -[u_h]_i$ and $e(j)=-u_h(j)$.\nThe magnitude of the adjoint inconsistency term is:\n$$\n| \\mathcal{B}(e, \\phi) - a_h(e, \\phi) | \\le 2 \\left| \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i \\right| + 2 \\left| \\sum_{j \\in \\{0,1\\}} e(j)\\phi'(j)n(j) \\right|.\n$$\nFor the interior sum:\n$$\n\\left| \\sum_{i=1}^{N-1} [e]_i \\{\\phi'\\}_i \\right| \\le \\left( \\sum_{i=1}^{N-1} [e]_i^2 \\right)^{1/2} \\left( \\sum_{i=1}^{N-1} (\\{\\phi'\\}_i)^2 \\right)^{1/2}.\n$$\nFrom the definition of the discrete norm, $(\\frac{\\eta}{h} \\sum [e]_i^2)^{1/2} \\le \\|e\\|_{1,h}$. Thus, $(\\sum [e]_i^2)^{1/2} \\le \\sqrt{h/\\eta} \\|e\\|_{1,h}$. Using the energy estimate, this gives $(\\sum [e]_i^2)^{1/2} \\le C h^{3/2} \\|u\\|_{H^2(\\Omega)}$.\nFor the derivative of the dual solution, a standard trace inequality and Riemann sum argument shows $(\\sum (\\{\\phi'\\}_i)^2)^{1/2} \\le C h^{-1/2} \\|\\phi\\|_{H^2(\\Omega)}$.\nThe product is bounded as:\n$$\n\\left| \\sum [e]_i \\{\\phi'\\}_i \\right| \\le (C h^{3/2} \\|u\\|_{H^2}) (C' h^{-1/2} \\|\\phi\\|_{H^2}) \\le C'' h \\|u\\|_{H^2} \\|\\phi\\|_{H^2}.\n$$\nSimilarly, for the boundary terms, $|e(j)| \\le \\sqrt{h/\\eta}\\|e\\|_{1,h} \\le C h^{3/2}\\|u\\|_{H^2}$ and $|\\phi'(j)| \\le C\\|\\phi\\|_{H^2}$, so their contribution is of order $h^{3/2}$, which is smaller.\nUsing the regularity estimate for $\\phi$:\n$$\n|\\mathcal{B}(e, \\phi) - a_h(e, \\phi)| \\le C h \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\n\n**Final combination and result**\nCombining the bounds for the two terms:\n$$\n\\|e\\|_{L^2(\\Omega)}^2 \\le C' h^2 \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)} + C h \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\nFor sufficiently small $h$, the term with the lower power of $h$ dominates. Thus:\n$$\n\\|e\\|_{L^2(\\Omega)}^2 \\le C h \\|u\\|_{H^2(\\Omega)} \\|e\\|_{L^2(\\Omega)}.\n$$\nDividing by $\\|e\\|_{L^2(\\Omega)}$ (assuming $e \\neq 0$), we obtain the final error estimate:\n$$\n\\|e\\|_{L^2(\\Omega)} \\le C h \\|u\\|_{H^2(\\Omega)}.\n$$\nThis corresponds to an a priori error estimate of the form $\\|u-u_h\\|_{L^2(\\Omega)} \\le C h^{p_{L^2}} \\|u\\|_{H^2(\\Omega)}$ with $p_{L^2} = 1$. The loss of adjoint consistency reduces the convergence rate in the $L^2$-norm from the optimal $O(h^2)$ (achieved by symmetric methods like SIPG) to a suboptimal $O(h)$.\n\nThe largest exponent is $p_{L^2}=1$.", "answer": "$$\\boxed{1}$$", "id": "3410414"}]}