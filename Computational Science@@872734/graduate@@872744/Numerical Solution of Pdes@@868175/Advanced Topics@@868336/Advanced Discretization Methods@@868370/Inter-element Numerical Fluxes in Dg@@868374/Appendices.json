{"hands_on_practices": [{"introduction": "In the Discontinuous Galerkin (DG) method, information is communicated between adjacent elements exclusively through numerical fluxes defined at their shared interfaces. This exercise [@problem_id:3409742] provides direct practice in computing one of the most common choices, the Rusanov (or Local Lax-Friedrichs) flux, which introduces numerical dissipation based on local characteristic speeds to ensure stability. Mastering this fundamental calculation is essential for understanding how DG methods robustly handle solutions with sharp gradients or discontinuities, a hallmark of nonlinear conservation laws.", "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ on the domain $[-1,1]$ with $f(u) = u + \\frac{u^{3}}{3}$. A Discontinuous Galerkin (DG) method is applied on two elements $E_{L} = [-1,0]$ and $E_{R} = [0,1]$, using polynomial degree $2$ expansions in the Legendre basis on the reference interval $[-1,1]$. The affine mapping from each physical element to the reference coordinate $\\xi \\in [-1,1]$ sends the interface location $x=0$ to $\\xi = +1$ for $E_{L}$ and to $\\xi = -1$ for $E_{R}$. On each element, the approximate solution is represented by\n$$\nu_{L}(\\xi) = \\alpha_{0} P_{0}(\\xi) + \\alpha_{1} P_{1}(\\xi) + \\alpha_{2} P_{2}(\\xi), \\quad u_{R}(\\xi) = \\beta_{0} P_{0}(\\xi) + \\beta_{1} P_{1}(\\xi) + \\beta_{2} P_{2}(\\xi),\n$$\nwhere $P_{0}(\\xi) = 1$, $P_{1}(\\xi) = \\xi$, and $P_{2}(\\xi) = \\frac{1}{2}(3\\xi^{2} - 1)$ are the first three Legendre polynomials, and the coefficients are\n$$\n\\alpha_{0} = \\frac{1}{2}, \\quad \\alpha_{1} = -\\frac{3}{4}, \\quad \\alpha_{2} = \\frac{2}{3}, \\qquad \\beta_{0} = \\frac{2}{5}, \\quad \\beta_{1} = \\frac{7}{8}, \\quad \\beta_{2} = -\\frac{1}{3}.\n$$\nAt the interface $x=0$, let the interior traces be $u^{-} = \\lim_{x \\to 0^{-}} u(x)$ from $E_{L}$ and $u^{+} = \\lim_{x \\to 0^{+}} u(x)$ from $E_{R}$. Using a consistent monotone numerical flux derived from local linearization of the conservation law at the interface and taking the dissipation parameter to be the maximum absolute characteristic speed across the interface, $\\lambda = \\max\\{\\,|f'(u^{-})|,\\,|f'(u^{+})|\\,\\}$, compute the inter-element numerical flux at $x=0$. Express your final answer as a single reduced rational number. No rounding is required.", "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n### Step 1: Extract Givens\n-   **Conservation Law**: $u_{t} + f(u)_{x} = 0$ on the domain $[-1,1]$.\n-   **Flux Function**: $f(u) = u + \\frac{u^{3}}{3}$.\n-   **Discretization**: Two elements, $E_{L} = [-1,0]$ and $E_{R} = [0,1]$.\n-   **Approximation Space**: Polynomials of degree $2$ in the Legendre basis.\n-   **Reference Mapping**: The interface at $x=0$ maps to $\\xi = +1$ for $E_{L}$ and to $\\xi = -1$ for $E_{R}$.\n-   **Basis Functions**: $P_{0}(\\xi) = 1$, $P_{1}(\\xi) = \\xi$, $P_{2}(\\xi) = \\frac{1}{2}(3\\xi^{2} - 1)$.\n-   **Solution Representations**:\n    -   On $E_{L}$: $u_{L}(\\xi) = \\alpha_{0} P_{0}(\\xi) + \\alpha_{1} P_{1}(\\xi) + \\alpha_{2} P_{2}(\\xi)$ with coefficients $\\alpha_{0} = \\frac{1}{2}$, $\\alpha_{1} = -\\frac{3}{4}$, $\\alpha_{2} = \\frac{2}{3}$.\n    -   On $E_{R}$: $u_{R}(\\xi) = \\beta_{0} P_{0}(\\xi) + \\beta_{1} P_{1}(\\xi) + \\beta_{2} P_{2}(\\xi)$ with coefficients $\\beta_{0} = \\frac{2}{5}$, $\\beta_{1} = \\frac{7}{8}$, $\\beta_{2} = -\\frac{1}{3}$.\n-   **Interface Traces**: $u^{-} = \\lim_{x \\to 0^{-}} u(x)$ and $u^{+} = \\lim_{x \\to 0^{+}} u(x)$.\n-   **Numerical Flux**: A consistent monotone flux (Local Lax-Friedrichs type) is to be used, with the form $\\hat{f}(u^{-}, u^{+}) = \\frac{1}{2}\\left[f(u^{-}) + f(u^{+}) - \\lambda(u^{+} - u^{-})\\right]$.\n-   **Dissipation Parameter**: $\\lambda = \\max\\{\\,|f'(u^{-})|,\\,|f'(u^{+})|\\,\\}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in the numerical solution of partial differential equations using the Discontinuous Galerkin method. It provides all necessary components: the governing equation, the discretization setup, the basis functions, the coefficients defining the solution state, and a precise formula for the numerical flux to be computed. The problem is scientifically grounded, well-posed, objective, and contains no contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\nThe task is to compute the inter-element numerical flux, $\\hat{f}$, at the interface $x=0$. The specified flux is the Local Lax-Friedrichs (or Rusanov) flux, given by:\n$$\n\\hat{f}(u^{-}, u^{+}) = \\frac{1}{2} \\left[ f(u^{-}) + f(u^{+}) - \\lambda (u^{+} - u^{-}) \\right]\n$$\nwhere $\\lambda = \\max\\{|f'(u^{-})|, |f'(u^{+})|\\}$. The solution proceeds in four steps.\n\n**1. Compute the trace values $u^{-}$ and $u^{+}$.**\n\nThe left trace value, $u^{-}$, is the limit of the solution from element $E_{L}$ as $x \\to 0^{-}$. This corresponds to evaluating $u_{L}(\\xi)$ at $\\xi = +1$. The values of the Legendre polynomials at $\\xi = 1$ are:\n$P_{0}(1) = 1$\n$P_{1}(1) = 1$\n$P_{2}(1) = \\frac{1}{2}(3(1)^{2} - 1) = 1$\n\nThus, $u^{-}$ is:\n$$\nu^{-} = u_{L}(1) = \\alpha_{0}P_{0}(1) + \\alpha_{1}P_{1}(1) + \\alpha_{2}P_{2}(1) = \\alpha_{0} + \\alpha_{1} + \\alpha_{2}\n$$\nSubstituting the given coefficients:\n$$\nu^{-} = \\frac{1}{2} - \\frac{3}{4} + \\frac{2}{3} = \\frac{6}{12} - \\frac{9}{12} + \\frac{8}{12} = \\frac{5}{12}\n$$\n\nThe right trace value, $u^{+}$, is the limit from element $E_{R}$ as $x \\to 0^{+}$, corresponding to evaluating $u_{R}(\\xi)$ at $\\xi = -1$. The values of the Legendre polynomials at $\\xi = -1$ are:\n$P_{0}(-1) = 1$\n$P_{1}(-1) = -1$\n$P_{2}(-1) = \\frac{1}{2}(3(-1)^{2} - 1) = 1$\n\nThus, $u^{+}$ is:\n$$\nu^{+} = u_{R}(-1) = \\beta_{0}P_{0}(-1) + \\beta_{1}P_{1}(-1) + \\beta_{2}P_{2}(-1) = \\beta_{0} - \\beta_{1} + \\beta_{2}\n$$\nSubstituting the given coefficients:\n$$\nu^{+} = \\frac{2}{5} - \\frac{7}{8} - \\frac{1}{3} = \\frac{48}{120} - \\frac{105}{120} - \\frac{40}{120} = \\frac{48 - 105 - 40}{120} = -\\frac{97}{120}\n$$\n\n**2. Compute the characteristic speeds and the dissipation parameter $\\lambda$.**\n\nThe characteristic speed is given by the derivative of the flux function, $f'(u)$.\n$$\nf(u) = u + \\frac{u^{3}}{3} \\implies f'(u) = 1 + u^{2}\n$$\nSince $u^{2} \\ge 0$, $f'(u) = 1+u^{2}$ is always positive, so $|f'(u)| = f'(u)$. We evaluate this at $u^{-}$ and $u^{+}$:\n$$\nf'(u^{-}) = 1 + (u^{-})^{2} = 1 + \\left(\\frac{5}{12}\\right)^{2} = 1 + \\frac{25}{144} = \\frac{144+25}{144} = \\frac{169}{144}\n$$\n$$\nf'(u^{+}) = 1 + (u^{+})^{2} = 1 + \\left(-\\frac{97}{120}\\right)^{2} = 1 + \\frac{9409}{14400} = \\frac{14400+9409}{14400} = \\frac{23809}{14400}\n$$\nTo compare these values, we use a common denominator:\n$$\nf'(u^{-}) = \\frac{169 \\times 100}{144 \\times 100} = \\frac{16900}{14400}\n$$\nSince $23809 > 16900$, we have $f'(u^{+}) > f'(u^{-})$. The dissipation parameter is therefore:\n$$\n\\lambda = \\max\\{f'(u^{-}), f'(u^{+})\\} = f'(u^{+}) = \\frac{23809}{14400}\n$$\n\n**3. Compute the terms for the numerical flux.**\n\nWe need $f(u^{-})$, $f(u^{+})$, and the dissipation term $\\lambda(u^{+}-u^{-})$.\n$$\nf(u^{-}) = u^{-} + \\frac{(u^{-})^{3}}{3} = \\frac{5}{12} + \\frac{1}{3}\\left(\\frac{5}{12}\\right)^{3} = \\frac{5}{12} + \\frac{125}{3 \\cdot 1728} = \\frac{5}{12} + \\frac{125}{5184} = \\frac{5 \\cdot 432 + 125}{5184} = \\frac{2160+125}{5184} = \\frac{2285}{5184}\n$$\n$$\nf(u^{+}) = u^{+} + \\frac{(u^{+})^{3}}{3} = -\\frac{97}{120} + \\frac{1}{3}\\left(-\\frac{97}{120}\\right)^{3} = -\\frac{97}{120} - \\frac{912673}{3 \\cdot 1728000} = -\\frac{97}{120} - \\frac{912673}{5184000}\n$$\nTo combine these, we find a common denominator:\n$$\nf(u^{+}) = -\\frac{97 \\cdot 43200}{5184000} - \\frac{912673}{5184000} = \\frac{-4190400 - 912673}{5184000} = -\\frac{5103073}{5184000}\n$$\nNext, we compute the jump in $u$:\n$$\nu^{+} - u^{-} = -\\frac{97}{120} - \\frac{5}{12} = -\\frac{97}{120} - \\frac{50}{120} = -\\frac{147}{120} = -\\frac{49}{40}\n$$\nThe dissipation term is:\n$$\n\\lambda(u^{+} - u^{-}) = \\frac{23809}{14400} \\cdot \\left(-\\frac{49}{40}\\right) = -\\frac{23809 \\cdot 49}{14400 \\cdot 40} = -\\frac{1166641}{576000}\n$$\n\n**4. Assemble the numerical flux and simplify.**\n\nNow substitute these components into the flux formula:\n$$\n\\hat{f} = \\frac{1}{2} \\left[ \\frac{2285}{5184} - \\frac{5103073}{5184000} - \\left(-\\frac{1166641}{576000}\\right) \\right]\n$$\nThe common denominator for the fractions inside the bracket is $5184000$. Note that $5184000 = 5184 \\times 1000$ and $5184000 = 576000 \\times 9$.\n$$\n\\hat{f} = \\frac{1}{2} \\left[ \\frac{2285 \\cdot 1000}{5184000} - \\frac{5103073}{5184000} + \\frac{1166641 \\cdot 9}{5184000} \\right]\n$$\n$$\n\\hat{f} = \\frac{1}{2 \\cdot 5184000} \\left[ 2285000 - 5103073 + 10499769 \\right]\n$$\n$$\n\\hat{f} = \\frac{1}{10368000} \\left[ 12784769 - 5103073 \\right] = \\frac{7681696}{10368000}\n$$\nTo simplify this fraction, we can divide the numerator and denominator by common factors. Both are divisible by $32$:\n$$\n\\hat{f} = \\frac{7681696 \\div 32}{10368000 \\div 32} = \\frac{240053}{324000}\n$$\nThe prime factors of the denominator are $2$, $3$, and $5$. The numerator $240053$ is not divisible by $2$ (it's odd), not by $3$ (sum of digits is $14$), and not by $5$ (does not end in $0$ or $5$). Thus, the fraction is in its reduced form.", "answer": "$$\n\\boxed{\\frac{240053}{324000}}\n$$", "id": "3409742"}, {"introduction": "While many formulas for numerical fluxes can be devised, only those satisfying certain mathematical properties lead to a convergent numerical method. This practice [@problem_id:3409743] explores the critical property of *consistency*, which ensures that the numerical flux correctly reproduces the physical flux in regions where the solution is smooth. By constructing and analyzing a deliberately inconsistent flux, you will directly observe the unphysical behavior it produces, providing a powerful lesson on why consistency is a non-negotiable design principle.", "problem": "Consider the one-dimensional linear advection Partial Differential Equation (PDE) $u_{t} + a\\,u_{x} = 0$ on the domain $[0,1]$ with periodic boundary conditions. Discretize the domain into two uniform elements $I_{1} = [0,\\tfrac{1}{2}]$ and $I_{2} = [\\tfrac{1}{2},1]$, each of length $h = \\tfrac{1}{2}$. Use the Discontinuous Galerkin (DG) method with polynomial degree $p=0$ (piecewise constant trial and test functions).\n\nDefine the inter-element numerical flux at an interface with left trace $u^{-}$, right trace $u^{+}$, and element-outward unit normal $n$ (pointing outward from the element for which the equation is being assembled) as\n$$\n\\widehat{f}(u^{-},u^{+},n) = a\\,\\frac{u^{-} + u^{+}}{2} + \\beta\\,n,\n$$\nwhere $a$ and $\\beta$ are given constants. The physical flux for the PDE is $f(u) = a\\,u$. A numerical flux is consistent if $\\widehat{f}(u,u,n) = f(u)$ for all $u$ and all interfaces.\n\nTasks:\n1. Starting from the local conservation form of the PDE and the DG weak formulation on a single element, write the semi-discrete DG equation for the element-averaged solution when $p=0$ and the constant test function is used.\n2. Show that the above choice of $\\widehat{f}$ violates consistency with the physical flux.\n3. For a constant solution $u(x,t) \\equiv c$, evaluate the semi-discrete DG equation on each of the two elements and determine the resulting time derivative of the element-average $u_{j}(t)$ in terms of $a$, $\\beta$, and $h$.\n4. Using $a = 3$, $\\beta = 1$, $h = \\tfrac{1}{2}$, and any constant $c$, compute the numerical value of the element-average time derivative $u_{j}'(t)$ produced by this flux. Express your final numerical answer as a pure number without units. No rounding is required.", "solution": "The problem is well-posed and scientifically sound, representing a standard exercise in a numerical analysis course on the Discontinuous Galerkin (DG) method. It tests the understanding of the DG formulation, the concept of numerical flux consistency, and the consequences of violating this property.\n\n### Task 1: Semi-discrete DG Equation\n\nWe begin with the one-dimensional linear advection equation in conservation form:\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0\n$$\nwhere the physical flux is $f(u) = a\\,u$. The domain $[0,1]$ is discretized into elements $I_j$. The DG weak formulation is obtained by multiplying the PDE by a test function $v(x)$ and integrating over an element $I_j = [x_{j-1/2}, x_{j+1/2}]$:\n$$\n\\int_{I_j} \\frac{\\partial u}{\\partial t} v \\,dx + \\int_{I_j} \\frac{\\partial f(u)}{\\partial x} v \\,dx = 0\n$$\nFor a polynomial degree $p=0$, the solution $u(x,t)$ is approximated on each element $I_j$ by a piecewise constant function, $u_h(x,t) = u_j(t)$ for $x \\in I_j$. We use a constant test function $v(x)=1$ on $I_j$.\n\nThe first term in the weak form becomes:\n$$\n\\int_{I_j} \\frac{\\partial u_j(t)}{\\partial t} (1) \\,dx = \\frac{du_j}{dt} \\int_{I_j} dx = h \\frac{du_j}{dt}\n$$\nwhere $h$ is the length of the element.\n\nThe second term is integrated by parts:\n$$\n\\int_{I_j} \\frac{\\partial f(u)}{\\partial x} v \\,dx = \\left[ f(u) v \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} f(u) \\frac{\\partial v}{\\partial x} \\,dx\n$$\nSince the test function $v$ is constant ($v=1$), its derivative $\\frac{\\partial v}{\\partial x}$ is $0$, and the integral on the right-hand side vanishes. The term simplifies to the flux evaluation at the element boundaries:\n$$\n\\left[ f(u) v \\right]_{x_{j-1/2}}^{x_{j+1/2}} = f(u(x_{j+1/2},t)) - f(u(x_{j-1/2},t))\n$$\nSince the solution $u_h$ is discontinuous at element interfaces, the flux $f(u)$ is not uniquely defined. We replace it with a numerical flux, $\\widehat{f}$, which depends on the solution values from a state to the left ($u^-$) and to the right ($u^+$) of the interface, and the outward unit normal vector $n$ of the element boundary.\n\nAt the right boundary of element $I_j$, $x=x_{j+1/2}$, the outward normal is $n=+1$. The left state is $u^- = u_j(t)$ and the right state is $u^+ = u_{j+1}(t)$. The flux term here is $\\widehat{f}(u_j, u_{j+1}, +1)$.\nAt the left boundary of element $I_j$, $x=x_{j-1/2}$, the outward normal is $n=-1$. The left state is $u^- = u_{j-1}(t)$ and the right state is $u^+ = u_j(t)$. The flux term here is $\\widehat{f}(u_{j-1}, u_j, -1)$.\n\nSubstituting these into the integrated-by-parts expression, the boundary term becomes:\n$$\n\\widehat{f}(u_j, u_{j+1}, +1) - \\widehat{f}(u_{j-1}, u_j, -1)\n$$\nCombining the terms, the semi-discrete DG equation for the element-averaged solution $u_j$ is:\n$$\nh \\frac{du_j}{dt} + \\widehat{f}(u_j, u_{j+1}, +1) - \\widehat{f}(u_{j-1}, u_j, -1) = 0\n$$\n\n### Task 2: Violation of Consistency\n\nA numerical flux $\\widehat{f}(u^-, u^+, n)$ is consistent with a physical flux $f(u)$ if, for any state $u$, it satisfies $\\widehat{f}(u,u,n) = f(u)$.\nThe given physical flux is $f(u) = a\\,u$.\nThe given numerical flux is $\\widehat{f}(u^-, u^+, n) = a\\,\\frac{u^- + u^+}{2} + \\beta\\,n$.\nTo check for consistency, we set $u^- = u$ and $u^+ = u$:\n$$\n\\widehat{f}(u, u, n) = a\\,\\frac{u + u}{2} + \\beta\\,n = a\\,\\frac{2u}{2} + \\beta\\,n = a\\,u + \\beta\\,n\n$$\nFor consistency, this must equal $f(u) = a\\,u$.\n$$\na\\,u + \\beta\\,n = a\\,u\n$$\nThis equality holds if and only if $\\beta\\,n = 0$. Since the normal vector $n$ at an interface is either $+1$ or $-1$, this implies that consistency is achieved only if $\\beta=0$. As $\\beta$ is a given constant that can be non-zero (e.g., $\\beta=1$ in Task 4), the numerical flux $\\widehat{f}$ is, in general, not consistent with the physical flux $f(u)$.\n\n### Task 3: Evaluation for a Constant Solution\n\nWe consider a constant solution $u(x,t) \\equiv c$. For a $p=0$ discretization, this means the element-average solution in each of the two elements is $u_1(t) = c$ and $u_2(t) = c$. We want to find the time derivative $\\frac{du_j}{dt}$ for $j=1,2$.\n\nWe have two elements, $I_1 = [0, \\frac{1}{2}]$ and $I_2 = [\\frac{1}{2}, 1]$, with periodic boundary conditions. The neighbors are $u_0 = u_2$ and $u_3 = u_1$.\n\nFor element $I_1$ ($j=1$):\nThe semi-discrete equation is $h \\frac{du_1}{dt} + \\widehat{f}(u_1, u_2, +1) - \\widehat{f}(u_0, u_1, -1) = 0$. Using periodicity, $u_0=u_2$, this becomes:\n$$\nh \\frac{du_1}{dt} + \\widehat{f}(u_1, u_2, +1) - \\widehat{f}(u_2, u_1, -1) = 0\n$$\nSubstituting $u_1 = c$ and $u_2 = c$:\n$$\nh \\frac{du_1}{dt} + \\widehat{f}(c, c, +1) - \\widehat{f}(c, c, -1) = 0\n$$\nFrom Task 2, we know that $\\widehat{f}(u, u, n) = a\\,u + \\beta\\,n$. Thus, with $u=c$:\n$\\widehat{f}(c, c, +1) = a\\,c + \\beta(+1) = a\\,c + \\beta$.\n$\\widehat{f}(c, c, -1) = a\\,c + \\beta(-1) = a\\,c - \\beta$.\n\nSubstituting these into the equation for $u_1$:\n$$\nh \\frac{du_1}{dt} + (a\\,c + \\beta) - (a\\,c - \\beta) = 0\n$$\n$$\nh \\frac{du_1}{dt} + a\\,c + \\beta - a\\,c + \\beta = 0\n$$\n$$\nh \\frac{du_1}{dt} + 2\\beta = 0\n$$\n$$\n\\frac{du_1}{dt} = -\\frac{2\\beta}{h}\n$$\nFor element $I_2$ ($j=2$):\nThe semi-discrete equation is $h \\frac{du_2}{dt} + \\widehat{f}(u_2, u_3, +1) - \\widehat{f}(u_1, u_2, -1) = 0$. Using periodicity, $u_3=u_1$:\n$$\nh \\frac{du_2}{dt} + \\widehat{f}(u_2, u_1, +1) - \\widehat{f}(u_1, u_2, -1) = 0\n$$\nSubstituting $u_1 = c$ and $u_2 = c$:\n$$\nh \\frac{du_2}{dt} + \\widehat{f}(c, c, +1) - \\widehat{f}(c, c, -1) = 0\n$$\nThis is the same equation as for $u_1$, yielding the same result:\n$$\n\\frac{du_2}{dt} = -\\frac{2\\beta}{h}\n$$\nTherefore, for any element $j$, the time derivative of the element-average solution is $\\frac{du_j}{dt} = -\\frac{2\\beta}{h}$. A consistent scheme would produce $\\frac{du_j}{dt}=0$, preserving the constant state. The non-zero result is a direct consequence of the flux inconsistency.\n\n### Task 4: Numerical Computation\n\nWe are asked to compute the numerical value of $\\frac{du_j}{dt}$ using the given constants: $a=3$, $\\beta=1$, and $h=\\frac{1}{2}$. The value of $c$ is irrelevant, as is the value of $a$.\nUsing the formula derived in Task 3:\n$$\n\\frac{du_j}{dt} = -\\frac{2\\beta}{h}\n$$\nSubstituting the numerical values:\n$$\n\\frac{du_j}{dt} = -\\frac{2(1)}{\\frac{1}{2}} = -\\frac{2}{0.5} = -4\n$$\nThe numerical value of the element-average time derivative is $-4$.", "answer": "$$\n\\boxed{-4}\n$$", "id": "3409743"}, {"introduction": "The choice of numerical flux involves a trade-off between accuracy, dissipative properties, and computational expense. This programming exercise [@problem_id:3409747] guides you through the implementation and comparison of two important flux families: the simple and dissipative Rusanov flux versus the more accurate (but complex) Godunov flux, which is based on the exact solution of the local Riemann problem. This hands-on coding task illuminates the practical decisions involved in selecting a numerical flux for a high-order DG simulation, balancing implementation complexity against the pursuit of high-fidelity results.", "problem": "Consider the scalar conservation law in one spatial dimension written in conservation form as $u_t + \\partial_x f(u) = 0$, where $u = u(x,t)$ and $f$ is a sufficiently smooth flux function. In the Discontinuous Galerkin (DG) method, inter-element coupling appears only through numerical fluxes on faces. Let the face be parametrized by a local coordinate $\\xi \\in [-1,1]$ with unit normal pointing from the left element to the right element. The polynomial traces of the DG solution on the face are $u^-(\\xi)$ from the left and $u^+(\\xi)$ from the right. You will construct a high-order local Riemann solver that uses these polynomial reconstructions across faces, and compare it to a standard approximate solver used in DG.\n\nStarting from the exact local Riemann problem and the Rankine–Hugoniot condition for scalar conservation laws, define the Godunov numerical flux $F_G(u^-,u^+)$ at each $\\xi$ as the physically correct flux resolved by the self-similar solution of the Riemann problem with left state $u^-(\\xi)$ and right state $u^+(\\xi)$. For convex fluxes such as Burgers’ flux $f(u) = \\frac{1}{2}u^2$, the pointwise Godunov flux can be expressed in terms of rarefaction and shock regimes using the sign of characteristic speeds. For linear advection $f(u) = a u$, the pointwise Godunov flux reduces to the upwind flux determined by the sign of $a$.\n\nDefine a face-averaged high-order Riemann flux by integrating the pointwise Godunov flux against the face measure:\n$$\n\\widehat{F}_{\\mathrm{HR}} = \\frac{1}{2}\\int_{-1}^{1} F_G\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi,\n$$\nwhere the prefactor $\\frac{1}{2}$ accounts for averaging over the interval of length $2$. Approximate the integral using Gauss–Legendre quadrature of order $p=5$ on $[-1,1]$.\n\nFor comparison, define the face-averaged Local Lax–Friedrichs (Rusanov) flux by integrating the pointwise Rusanov flux\n$$\nF_{\\mathrm{LF}}(u^-,u^+) = \\frac{1}{2}\\left(f(u^-)+f(u^+)\\right) - \\frac{1}{2}\\alpha(u^-,u^+)\\left(u^+ - u^-\\right)\n$$\nwith $\\alpha(u^-,u^+) = \\max\\left(|f'(u^-)|,|f'(u^+)|\\right)$ for nonlinear fluxes, and $\\alpha = |a|$ for linear advection $f(u) = au$. The face-averaged Rusanov flux is\n$$\n\\widehat{F}_{\\mathrm{LF}} = \\frac{1}{2}\\int_{-1}^{1} F_{\\mathrm{LF}}\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi.\n$$\n\nYour program must:\n- Implement $F_G$ pointwise for Burgers’ flux $f(u)=\\frac{1}{2}u^2$ using the rarefaction and shock cases based on $u^-$ and $u^+$ (use the standard scalar Godunov flux for Burgers: rarefaction when $u^- \\le u^+$ with subcases on the sign of $u^-$ and $u^+$ relative to $0$, and shock when $u^- > u^+$ using the shock speed $s = \\frac{f(u^-) - f(u^+)}{u^- - u^+} = \\frac{u^- + u^+}{2}$ to select the upwind side).\n- Implement $F_G$ pointwise for linear advection $f(u)=au$ as the upwind flux determined by the sign of $a$.\n- Implement $F_{\\mathrm{LF}}$ pointwise for both Burgers and linear advection, using the corresponding characteristic speed $\\alpha$.\n- Approximate face averages $\\widehat{F}_{\\mathrm{HR}}$ and $\\widehat{F}_{\\mathrm{LF}}$ using Gauss–Legendre quadrature of order $p=5$.\n- For each test case, output three floats: the face-averaged high-order Godunov flux $\\widehat{F}_{\\mathrm{HR}}$, the face-averaged Rusanov flux $\\widehat{F}_{\\mathrm{LF}}$, and the absolute difference $|\\widehat{F}_{\\mathrm{HR}}-\\widehat{F}_{\\mathrm{LF}}|$.\n\nUse the following test suite of polynomial traces $u^\\pm(\\xi)$ and flux functions $f$:\n- Test A (linear advection, happy path): $f(u) = a u$ with $a = 1.7$. Left trace $u^-(\\xi) = 1 + 0.5\\,\\xi - 0.2\\,\\xi^2$. Right trace $u^+(\\xi) = 0.8 - 1.0\\,\\xi + 0.3\\,\\xi^2$. Expect $\\widehat{F}_{\\mathrm{HR}} = \\widehat{F}_{\\mathrm{LF}}$.\n- Test B (Burgers, mixed shock/rarefaction): $f(u) = \\frac{1}{2}u^2$. Left trace $u^-(\\xi) = 1 + \\xi$. Right trace $u^+(\\xi) = -0.5 + 0.5\\,\\xi$.\n- Test C (Burgers, zero jump boundary case): $f(u) = \\frac{1}{2}u^2$. Identical traces $u^-(\\xi) = u^+(\\xi) = 0.3 + 0.4\\,\\xi - 0.1\\,\\xi^2$. Expect $|\\widehat{F}_{\\mathrm{HR}}-\\widehat{F}_{\\mathrm{LF}}| = 0$.\n- Test D (Burgers, rarefaction with sign change across the fan): $f(u) = \\frac{1}{2}u^2$. Left trace $u^-(\\xi) = -0.6 + 0.4\\,\\xi$. Right trace $u^+(\\xi) = 0.2 + 0.4\\,\\xi$.\n\nThe final output format must be a single line containing a Python list with $12$ floats, ordered as $[\\widehat{F}_{\\mathrm{HR}}^{(A)},\\widehat{F}_{\\mathrm{LF}}^{(A)},|\\widehat{F}_{\\mathrm{HR}}^{(A)}-\\widehat{F}_{\\mathrm{LF}}^{(A)}|,\\widehat{F}_{\\mathrm{HR}}^{(B)},\\widehat{F}_{\\mathrm{LF}}^{(B)},|\\widehat{F}_{\\mathrm{HR}}^{(B)}-\\widehat{F}_{\\mathrm{LF}}^{(B)}|,\\widehat{F}_{\\mathrm{HR}}^{(C)},\\widehat{F}_{\\mathrm{LF}}^{(C)},|\\widehat{F}_{\\mathrm{HR}}^{(C)}-\\widehat{F}_{\\mathrm{LF}}^{(C)}|,\\widehat{F}_{\\mathrm{HR}}^{(D)},\\widehat{F}_{\\mathrm{LF}}^{(D)},|\\widehat{F}_{\\mathrm{HR}}^{(D)}-\\widehat{F}_{\\mathrm{LF}}^{(D)}|]$. No units are involved; all quantities are dimensionless real numbers.", "solution": "The problem requires the computation and comparison of two numerical fluxes, the high-order Godunov (or Riemann) flux $\\widehat{F}_{\\mathrm{HR}}$ and the Local Lax-Friedrichs (or Rusanov) flux $\\widehat{F}_{\\mathrm{LF}}$, for DG methods applied to scalar conservation laws of the form $u_t + \\partial_x f(u) = 0$. The fluxes are defined as averages over a cell face, which is parameterized by a local coordinate $\\xi \\in [-1, 1]$. The solution traces onto the face from the left and right elements are given as polynomials $u^-(\\xi)$ and $u^+(\\xi)$, respectively.\n\nThe core of the problem lies in evaluating the face-averaged integrals:\n$$\n\\widehat{F}_{\\mathrm{HR}} = \\frac{1}{2}\\int_{-1}^{1} F_G\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi\n$$\n$$\n\\widehat{F}_{\\mathrm{LF}} = \\frac{1}{2}\\int_{-1}^{1} F_{\\mathrm{LF}}\\!\\left(u^-(\\xi),u^+(\\xi)\\right)\\, d\\xi\n$$\nThese integrals are approximated using Gauss-Legendre quadrature with $p=5$ points. A general integral on the interval $[-1, 1]$ is approximated as:\n$$\n\\int_{-1}^{1} g(\\xi) \\, d\\xi \\approx \\sum_{i=1}^{p} w_i g(\\xi_i)\n$$\nwhere $\\xi_i$ are the quadrature nodes (the roots of the Legendre polynomial of degree $p$) and $w_i$ are the corresponding weights. The prefactor of $\\frac{1}{2}$ in the flux definitions accounts for averaging over the interval of length $2$. Thus, the numerical approximations are:\n$$\n\\widehat{F} \\approx \\frac{1}{2} \\sum_{i=1}^{5} w_i F(u^-(\\xi_i), u^+(\\xi_i))\n$$\nwhere $F$ is either the pointwise Godunov flux $F_G$ or the pointwise Rusanov flux $F_{\\mathrm{LF}}$.\n\nWe must first define the pointwise flux functions for the two specified conservation laws: linear advection and Burgers' equation.\n\nFor linear advection, the flux function is $f(u) = au$, where $a$ is a constant wave speed. The derivative is $f'(u) = a$.\nThe pointwise Godunov flux $F_G$ is the exact solution to the Riemann problem, which simplifies to the standard upwind flux. The direction of information propagation is determined solely by the sign of the speed $a$.\n$$\nF_G(u^-, u^+) = \\begin{cases} f(u^-) = au^- & \\text{if } a > 0 \\\\ f(u^+) = au^+ & \\text{if } a \\le 0 \\end{cases}\n$$\nThe pointwise Rusanov flux $F_{\\mathrm{LF}}$ is given by:\n$$\nF_{\\mathrm{LF}}(u^-, u^+) = \\frac{1}{2}\\left(f(u^-) + f(u^+)\\right) - \\frac{1}{2}\\alpha\\left(u^+ - u^-\\right)\n$$\nFor linear advection, the local wave speed is $\\alpha = |f'(u)| = |a|$. Substituting this into the formula:\n$$\nF_{\\mathrm{LF}}(u^-, u^+) = \\frac{1}{2}\\left(au^- + au^+\\right) - \\frac{1}{2}|a|\\left(u^+ - u^-\\right)\n$$\nIf $a>0$, then $|a|=a$, and the flux becomes $\\frac{1}{2}(au^- + au^+) - \\frac{1}{2}a(u^+ - u^-) = \\frac{1}{2}(au^- + au^+ - au^+ + au^-) = au^-$.\nIf $a \\le 0$, then $|a|=-a$, and the flux becomes $\\frac{1}{2}(au^- + au^+) - \\frac{1}{2}(-a)(u^+ - u^-) = \\frac{1}{2}(au^- + au^+ + au^+ - au^-) = au^+$.\nIn both cases, $F_{\\mathrm{LF}}(u^-, u^+) = F_G(u^-, u^+)$. Therefore, for the linear advection equation, the face-averaged Rusanov and Godunov fluxes will be identical, $\\widehat{F}_{\\mathrm{HR}} = \\widehat{F}_{\\mathrm{LF}}$, as expected in Test A.\n\nFor Burgers' equation, the flux is nonlinear and convex: $f(u) = \\frac{1}{2}u^2$. The characteristic speed is $f'(u) = u$.\nThe pointwise Godunov flux $F_G$ depends on the structure of the Riemann problem solution, which can be a shock or a rarefaction. Let $u_L=u^-$ and $u_R=u^+$.\n1. If $u_L > u_R$, the solution is a shock wave traveling at speed $s = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}u_L^2 - \\frac{1}{2}u_R^2}{u_L - u_R} = \\frac{1}{2}(u_L + u_R)$. The flux at the interface ($\\xi=0$) is determined by the upwind state.\n    - If $s > 0$, the shock moves to the right, and the state at the interface is $u_L$. The flux is $f(u_L)$.\n    - If $s \\le 0$, the shock moves to the left (or is stationary), and the state at the interface is $u_R$. The flux is $f(u_R)$.\n2. If $u_L \\le u_R$, the solution is a rarefaction fan. The state at the interface depends on whether the fan crosses the line $\\xi=0$, which corresponds to a characteristic speed of $0$.\n    - If $u_L > 0$ (which implies $u_R > 0$), all characteristics move to the right. The state at the interface is $u_L$, and the flux is $f(u_L)$.\n    - If $u_R < 0$ (which implies $u_L < 0$), all characteristics move to the left. The state at the interface is $u_R$, and the flux is $f(u_R)$.\n    - If $u_L \\le 0 \\le u_R$, the fan contains the characteristic with speed $0$. The state at the interface is the sonic state $u_{sonic}$ where $f'(u_{sonic})=0$. For Burgers' equation, $u_{sonic}=0$, so the flux is $f(0) = 0$.\n\nThe pointwise Rusanov flux $F_{\\mathrm{LF}}$ for Burgers' equation uses the local speed $\\alpha = \\max(|f'(u^-)|, |f'(u^+)|) = \\max(|u^-|, |u^+|)$. The formula is:\n$$\nF_{\\mathrm{LF}}(u^-, u^+) = \\frac{1}{2}\\left(f(u^-) + f(u^+)\\right) - \\frac{1}{2}\\max(|u^-|, |u^+|)\\left(u^+ - u^-\\right)\n$$\nwith $f(u) = \\frac{1}{2}u^2$.\n\nIn Test C, $u^-(\\xi) = u^+(\\xi)$ for all $\\xi \\in [-1, 1]$. In this case, the jump $u^+ - u^-$ is zero. The Godunov flux is simply $F_G(u, u) = f(u)$, and the Rusanov flux becomes $F_{\\mathrm{LF}}(u, u) = \\frac{1}{2}(f(u) + f(u)) - 0 = f(u)$. Thus, $\\widehat{F}_{\\mathrm{HR}}$ and $\\widehat{F}_{\\mathrm{LF}}$ are identical, and their absolute difference is $0$.\n\nThe algorithm proceeds as follows for each test case:\n1. Obtain the $p=5$ Gauss-Legendre quadrature nodes $\\xi_i$ and weights $w_i$.\n2. For each test case, define the polynomial traces $u^-(\\xi)$ and $u^+(\\xi)$ and the physical flux function $f(u)$.\n3. Initialize sums for the integrated fluxes to $0$.\n4. Iterate through each quadrature node $\\xi_i$:\n    a. Evaluate the left and right states, $u_L = u^-(\\xi_i)$ and $u_R = u^+(\\xi_i)$.\n    b. Calculate the pointwise Godunov flux $F_G(u_L, u_R)$ using the appropriate logic (linear advection or Burgers').\n    c. Calculate the pointwise Rusanov flux $F_{\\mathrm{LF}}(u_L, u_R)$ using its definition.\n    d. Accumulate the weighted fluxes: add $w_i F_G(u_L, u_R)$ and $w_i F_{\\mathrm{LF}}(u_L, u_R)$ to their respective sums.\n5. Compute the final face-averaged fluxes by multiplying the sums by $\\frac{1}{2}$.\n6. Calculate the absolute difference between the two averaged fluxes.\n7. Collect the three resulting floating-point numbers for the final output.\nThis procedure is repeated for all four test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\n# language: Python\n# version: 3.12\n# libraries:\n#     name: numpy, version: 1.23.5\n#     name: scipy, version: 1.11.4\n\ndef solve():\n    \"\"\"\n    Computes and compares face-averaged high-order Godunov and Rusanov fluxes\n    for several test cases in the Discontinuous Galerkin method.\n    \"\"\"\n\n    # --- Pointwise Flux Implementations ---\n\n    def f_burgers(u):\n        \"\"\"Physical flux for Burgers' equation.\"\"\"\n        return 0.5 * u**2\n\n    def godunov_flux_linear(u_left, u_right, a):\n        \"\"\"Pointwise Godunov (upwind) flux for linear advection f(u)=au.\"\"\"\n        if a > 0.0:\n            return a * u_left\n        else:\n            return a * u_right\n\n    def rusanov_flux_linear(u_left, u_right, a):\n        \"\"\"Pointwise Rusanov (LLF) flux for linear advection f(u)=au.\"\"\"\n        f_left = a * u_left\n        f_right = a * u_right\n        alpha = np.abs(a)\n        return 0.5 * (f_left + f_right) - 0.5 * alpha * (u_right - u_left)\n\n    def godunov_flux_burgers(u_left, u_right):\n        \"\"\"Pointwise Godunov flux for Burgers' equation f(u)=0.5*u^2.\"\"\"\n        if u_left > u_right:  # Shock\n            s = 0.5 * (u_left + u_right)\n            if s > 0.0:\n                return f_burgers(u_left)\n            else:\n                return f_burgers(u_right)\n        else:  # Rarefaction (u_left = u_right)\n            # f'(u) = u\n            if u_left >= 0.0:  # and u_right >= u_left\n                return f_burgers(u_left)\n            elif u_right = 0.0: # and u_left = u_right\n                return f_burgers(u_right)\n            else:  # u_left  0  u_right, sonic point crossed\n                return f_burgers(0.0)\n\n    def rusanov_flux_burgers(u_left, u_right):\n        \"\"\"Pointwise Rusanov (LLF) flux for Burgers' equation.\"\"\"\n        f_left = f_burgers(u_left)\n        f_right = f_burgers(u_right)\n        # alpha = max(|f'(u_left)|, |f'(u_right)|) = max(|u_left|, |u_right|)\n        alpha = np.maximum(np.abs(u_left), np.abs(u_right))\n        return 0.5 * (f_left + f_right) - 0.5 * alpha * (u_right - u_left)\n\n    # --- Test Case Definitions ---\n\n    test_cases = [\n        {\n            \"id\": \"A\",\n            \"type\": \"linear\",\n            \"params\": {\"a\": 1.7},\n            \"u_left\": lambda xi: 1.0 + 0.5 * xi - 0.2 * xi**2,\n            \"u_right\": lambda xi: 0.8 - 1.0 * xi + 0.3 * xi**2,\n        },\n        {\n            \"id\": \"B\",\n            \"type\": \"burgers\",\n            \"params\": {},\n            \"u_left\": lambda xi: 1.0 + xi,\n            \"u_right\": lambda xi: -0.5 + 0.5 * xi,\n        },\n        {\n            \"id\": \"C\",\n            \"type\": \"burgers\",\n            \"params\": {},\n            \"u_left\": lambda xi: 0.3 + 0.4 * xi - 0.1 * xi**2,\n            \"u_right\": lambda xi: 0.3 + 0.4 * xi - 0.1 * xi**2,\n        },\n        {\n            \"id\": \"D\",\n            \"type\": \"burgers\",\n            \"params\": {},\n            \"u_left\": lambda xi: -0.6 + 0.4 * xi,\n            \"u_right\": lambda xi: 0.2 + 0.4 * xi,\n        },\n    ]\n\n    # --- Numerical Integration Setup ---\n    p_order = 5\n    xi_nodes, w_weights = roots_legendre(p_order)\n\n    # --- Main Calculation Loop ---\n    \n    all_results = []\n    \n    for case in test_cases:\n        sum_hr = 0.0\n        sum_lf = 0.0\n        \n        # Select appropriate pointwise flux functions based on case type\n        if case[\"type\"] == \"linear\":\n            a = case[\"params\"][\"a\"]\n            pt_flux_hr = lambda ul, ur: godunov_flux_linear(ul, ur, a)\n            pt_flux_lf = lambda ul, ur: rusanov_flux_linear(ul, ur, a)\n        elif case[\"type\"] == \"burgers\":\n            pt_flux_hr = godunov_flux_burgers\n            pt_flux_lf = rusanov_flux_burgers\n        \n        for xi, w in zip(xi_nodes, w_weights):\n            u_l = case[\"u_left\"](xi)\n            u_r = case[\"u_right\"](xi)\n            \n            sum_hr += w * pt_flux_hr(u_l, u_r)\n            sum_lf += w * pt_flux_lf(u_l, u_r)\n            \n        # The integral is over [-1, 1], an interval of length 2.\n        # The factor 1/2 is for averaging.\n        avg_flux_hr = 0.5 * sum_hr\n        avg_flux_lf = 0.5 * sum_lf\n        \n        diff = np.abs(avg_flux_hr - avg_flux_lf)\n        \n        all_results.extend([avg_flux_hr, avg_flux_lf, diff])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.12f}' for x in all_results)}]\")\n\nsolve()\n\n```", "id": "3409747"}]}