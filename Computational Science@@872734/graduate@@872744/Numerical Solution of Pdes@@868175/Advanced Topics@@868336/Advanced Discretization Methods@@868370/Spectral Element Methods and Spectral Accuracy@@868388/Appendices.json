{"hands_on_practices": [{"introduction": "To build a spectral element method from the ground up, we must first master its fundamental components on a reference element. This exercise guides you through the process of determining the Legendre-Gauss-Lobatto (LGL) nodes and weights, which are the cornerstone of the method's high accuracy. By constructing the mass matrix using these components, you will directly observe and prove a key computational advantage of the LGL-based spectral element method: the mass matrix becomes diagonal, a property known as \"lumped mass\" [@problem_id:3446203].", "problem": "Consider the reference element $[-1,1]$ and the degree-$N$ spectral element with nodal interpolation at the Legendre–Gauss–Lobatto (LGL) nodes, where $N=4$. Let $\\{x_i\\}_{i=0}^{N}$ denote the LGL nodes and $\\{w_i\\}_{i=0}^{N}$ the associated LGL quadrature weights. Let $\\{\\ell_i(x)\\}_{i=0}^{N}$ be the nodal Lagrange basis on $[-1,1]$ satisfying $\\ell_i(x_j)=\\delta_{ij}$. The LGL quadrature defines the quadrature-based mass matrix $M \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ by\n$$\nM_{ij} \\equiv \\sum_{k=0}^{N} w_k\\, \\ell_i(x_k)\\,\\ell_j(x_k).\n$$\nTasks:\n- Using only fundamental definitions of Legendre polynomials and the LGL construction, determine the LGL nodes $\\{x_i\\}_{i=0}^{4}$ and LGL weights $\\{w_i\\}_{i=0}^{4}$ for $N=4$, and report their numerical values rounded to at least four significant figures.\n- Assemble the matrix $M$ using the above quadrature and the nodal Lagrange basis. Prove from first principles why all off-diagonal entries $M_{ij}$ with $i\\neq j$ vanish under LGL quadrature for nodal bases.\n- From your assembled $M$, compute its determinant exactly.\n\nProvide as your final answer the exact value of $\\det(M)$ as a single simplified analytic expression (no units, no decimal approximation).", "solution": "The problem requires us to determine the Legendre–Gauss–Lobatto (LGL) nodes and weights for a degree $N=4$ spectral element, analyze the structure of the quadrature-based mass matrix $M$, and compute its exact determinant. We will address each part of the problem systematically.\n\nFirst, we determine the LGL nodes and weights for $N=4$. The LGL nodes $\\{x_i\\}_{i=0}^{N}$ on the interval $[-1,1]$ are the roots of the equation $(1-x^2)P_N'(x) = 0$, where $P_N(x)$ is the Legendre polynomial of degree $N$. For $N=4$, the nodes are the roots of $(1-x^2)P_4'(x)=0$. The endpoints $x_0=-1$ and $x_4=1$ are immediately identified as nodes. The interior nodes are the roots of $P_4'(x)=0$.\n\nWe find $P_4(x)$ using the Legendre polynomial recurrence relation:\n$(n+1)P_{n+1}(x) = (2n+1)xP_n(x) - nP_{n-1}(x)$, with base cases $P_0(x)=1$ and $P_1(x)=x$.\nFor $n=1$: $2P_2(x) = 3xP_1(x) - 1P_0(x) = 3x^2 - 1 \\implies P_2(x) = \\frac{1}{2}(3x^2-1)$.\nFor $n=2$: $3P_3(x) = 5xP_2(x) - 2P_1(x) = \\frac{5}{2}x(3x^2-1) - 2x = \\frac{1}{2}(15x^3-9x) \\implies P_3(x) = \\frac{1}{2}(5x^3-3x)$.\nFor $n=3$: $4P_4(x) = 7xP_3(x) - 3P_2(x) = \\frac{7}{2}x(5x^3-3x) - \\frac{3}{2}(3x^2-1) = \\frac{1}{2}(35x^4 - 21x^2 - 9x^2 + 3) = \\frac{1}{2}(35x^4 - 30x^2 + 3)$.\nThus, $P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$.\n\nThe derivative is $P_4'(x) = \\frac{1}{8}(140x^3 - 60x) = \\frac{5}{2}(7x^3 - 3x) = \\frac{5}{2}x(7x^2 - 3)$.\nThe roots of $P_4'(x)=0$ are found by setting $x(7x^2 - 3)=0$, which yields $x=0$ and $x=\\pm\\sqrt{\\frac{3}{7}}$.\n\nThe LGL nodes for $N=4$, ordered from smallest to largest, are:\n$x_0 = -1$\n$x_1 = -\\sqrt{\\frac{3}{7}}$\n$x_2 = 0$\n$x_3 = \\sqrt{\\frac{3}{7}}$\n$x_4 = 1$\n\nNumerically, these nodes are approximately:\n$x_0 = -1.000$\n$x_1 \\approx -0.6547$\n$x_2 = 0.0000$\n$x_3 \\approx 0.6547$\n$x_4 = 1.0000$\n\nThe LGL quadrature weights $\\{w_i\\}_{i=0}^{N}$ are given by the formula $w_i = \\frac{2}{N(N+1)[P_N(x_i)]^2}$. For $N=4$, this becomes $w_i = \\frac{2}{4(5)[P_4(x_i)]^2} = \\frac{1}{10[P_4(x_i)]^2}$.\n\n- For the endpoints $x_0=-1$ and $x_4=1$, we use $P_4(-1) = (-1)^4 = 1$ and $P_4(1) = 1$.\n$w_0 = w_4 = \\frac{1}{10[P_4(1)]^2} = \\frac{1}{10(1)^2} = \\frac{1}{10}$.\n\n- For the node $x_2=0$, we evaluate $P_4(0) = \\frac{1}{8}(3) = \\frac{3}{8}$.\n$w_2 = \\frac{1}{10[P_4(0)]^2} = \\frac{1}{10(\\frac{3}{8})^2} = \\frac{1}{10 \\cdot \\frac{9}{64}} = \\frac{64}{90} = \\frac{32}{45}$.\n\n- For the interior nodes $x_1=-\\sqrt{\\frac{3}{7}}$ and $x_3=\\sqrt{\\frac{3}{7}}$, we evaluate $P_4(x)$ at $x^2 = \\frac{3}{7}$.\n$P_4(\\pm\\sqrt{\\frac{3}{7}}) = \\frac{1}{8}\\left(35\\left(\\frac{3}{7}\\right)^2 - 30\\left(\\frac{3}{7}\\right) + 3\\right) = \\frac{1}{8}\\left(35\\frac{9}{49} - \\frac{90}{7} + 3\\right) = \\frac{1}{8}\\left(\\frac{45}{7} - \\frac{90}{7} + \\frac{21}{7}\\right) = \\frac{1}{8}\\left(\\frac{-24}{7}\\right) = -\\frac{3}{7}$.\n$w_1 = w_3 = \\frac{1}{10[P_4(\\sqrt{3/7})]^2} = \\frac{1}{10(-\\frac{3}{7})^2} = \\frac{1}{10 \\cdot \\frac{9}{49}} = \\frac{49}{90}$.\n\nThe LGL weights for $N=4$ are:\n$w_0 = \\frac{1}{10}$ (approx. $0.1000$)\n$w_1 = \\frac{49}{90}$ (approx. $0.5444$)\n$w_2 = \\frac{32}{45}$ (approx. $0.7111$)\n$w_3 = \\frac{49}{90}$ (approx. $0.5444$)\n$w_4 = \\frac{1}{10}$ (approx. $0.1000$)\n\nNext, we address the structure of the mass matrix $M$. The problem defines the quadrature-based mass matrix elements as $M_{ij} = \\sum_{k=0}^{N} w_k\\, \\ell_i(x_k)\\,\\ell_j(x_k)$. The basis functions $\\{\\ell_i(x)\\}_{i=0}^{N}$ are the nodal Lagrange basis polynomials, defined by the property $\\ell_i(x_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nApplying this property to the definition of $M_{ij}$:\nThe term $\\ell_i(x_k)$ is $1$ if $k=i$ and $0$ otherwise. Thus, we can write $\\ell_i(x_k) = \\delta_{ik}$.\nSimilarly, $\\ell_j(x_k) = \\delta_{jk}$.\nSubstituting these into the sum:\n$M_{ij} = \\sum_{k=0}^{N} w_k \\delta_{ik} \\delta_{jk}$.\n\nTo prove that off-diagonal entries vanish, consider $i \\neq j$. For any term in the sum (indexed by $k$), the product $\\delta_{ik}\\delta_{jk}$ is non-zero only if both $\\delta_{ik}=1$ and $\\delta_{jk}=1$. This would require $k=i$ and $k=j$ simultaneously. Since we assumed $i \\neq j$, this is impossible. Therefore, for any $k \\in \\{0, 1, \\dots, N\\}$, the product $\\delta_{ik}\\delta_{jk}$ is always $0$ when $i \\neq j$.\nThis leads to:\n$M_{ij} = \\sum_{k=0}^{N} w_k \\cdot 0 = 0$ for $i \\neq j$.\nThis proves from first principles that all off-diagonal entries of $M$ are zero.\n\nFor the diagonal entries, consider $i = j$. The expression becomes:\n$M_{ii} = \\sum_{k=0}^{N} w_k \\delta_{ik} \\delta_{ik} = \\sum_{k=0}^{N} w_k (\\delta_{ik})^2$.\nSince $\\delta_{ik}$ is either $0$ or $1$, $(\\delta_{ik})^2 = \\delta_{ik}$.\n$M_{ii} = \\sum_{k=0}^{N} w_k \\delta_{ik}$.\nThis sum contains only one non-zero term, which occurs when $k=i$. The value of that term is $w_i \\cdot \\delta_{ii} = w_i \\cdot 1 = w_i$.\nSo, $M_{ii} = w_i$.\n\nThe matrix $M$ is a diagonal matrix whose diagonal entries are the LGL quadrature weights:\n$M = \\text{diag}(w_0, w_1, w_2, w_3, w_4)$.\n\nAssembling the matrix $M$ with the calculated weights for $N=4$:\n$$\nM = \\begin{pmatrix} \\frac{1}{10}  0  0  0  0 \\\\ 0  \\frac{49}{90}  0  0  0 \\\\ 0  0  \\frac{32}{45}  0  0 \\\\ 0  0  0  \\frac{49}{90}  0 \\\\ 0  0  0  0  \\frac{1}{10} \\end{pmatrix}\n$$\n\nFinally, we compute the determinant of $M$. The determinant of a diagonal matrix is the product of its diagonal elements.\n$\\det(M) = w_0 \\cdot w_1 \\cdot w_2 \\cdot w_3 \\cdot w_4$.\nSubstituting the exact fractional values of the weights:\n$\\det(M) = \\left(\\frac{1}{10}\\right) \\cdot \\left(\\frac{49}{90}\\right) \\cdot \\left(\\frac{32}{45}\\right) \\cdot \\left(\\frac{49}{90}\\right) \\cdot \\left(\\frac{1}{10}\\right)$.\nWe simplify this product using prime factorization.\n$10 = 2 \\cdot 5$\n$49 = 7^2$\n$90 = 9 \\cdot 10 = 3^2 \\cdot 2 \\cdot 5$\n$32 = 2^5$\n$45 = 9 \\cdot 5 = 3^2 \\cdot 5$\n\n$\\det(M) = \\frac{1}{2 \\cdot 5} \\cdot \\frac{7^2}{3^2 \\cdot 2 \\cdot 5} \\cdot \\frac{2^5}{3^2 \\cdot 5} \\cdot \\frac{7^2}{3^2 \\cdot 2 \\cdot 5} \\cdot \\frac{1}{2 \\cdot 5}$\n\nCombining the terms in the numerator and denominator:\nNumerator: $1 \\cdot 7^2 \\cdot 2^5 \\cdot 7^2 \\cdot 1 = 2^5 \\cdot 7^4$.\nDenominator: $(2\\cdot5) \\cdot (3^2\\cdot2\\cdot5) \\cdot (3^2\\cdot5) \\cdot (3^2\\cdot2\\cdot5) \\cdot (2\\cdot5) = 2^{1+1+1+1} \\cdot 3^{2+2+2} \\cdot 5^{1+1+1+1+1} = 2^4 \\cdot 3^6 \\cdot 5^5$.\n\n$\\det(M) = \\frac{2^5 \\cdot 7^4}{2^4 \\cdot 3^6 \\cdot 5^5} = \\frac{2 \\cdot 7^4}{3^6 \\cdot 5^5}$.\nThis is the exact simplified analytical expression for the determinant. Let's calculate the integer values for presentation: $7^4=2401$, $3^6=729$, $5^5=3125$.\n$\\det(M) = \\frac{2 \\cdot 2401}{729 \\cdot 3125} = \\frac{4802}{2278125}$. The form with prime powers is more fundamental.\nThe final answer is $\\frac{2 \\cdot 7^4}{3^6 \\cdot 5^5}$.", "answer": "$$\n\\boxed{\\frac{2 \\cdot 7^4}{3^6 \\cdot 5^5}}\n$$", "id": "3446203"}, {"introduction": "A powerful feature of spectral methods is the ability to represent functions and operators in different polynomial bases, most commonly the modal (using orthogonal polynomials) and nodal (using Lagrange interpolants) bases. This practice illuminates the formal equivalence between these two perspectives by transforming the stiffness operator from a modal to a nodal representation. You will verify that although the matrix entries change dramatically, the underlying operator's spectrum remains invariant, a fundamental principle ensuring that physical predictions do not depend on the choice of mathematical representation [@problem_id:3446146].", "problem": "On the one-dimensional reference element $[-1,1]$, consider the polynomial space $\\mathbb{P}_N$ of degree at most $N$ with $N=3$. Let $\\{\\phi_k\\}_{k=0}^{3}$ be the Legendre polynomial basis $\\phi_k(x)=P_k(x)$, normalized by $P_k(1)=1$. Define the stiffness bilinear form $a(u,v)=\\int_{-1}^{1} u'(x)\\,v'(x)\\,dx$ and the mass bilinear form $m(u,v)=\\int_{-1}^{1} u(x)\\,v(x)\\,dx$. \n\n1. Assemble the modal stiffness matrix $K_{\\mathrm{modal}}\\in\\mathbb{R}^{4\\times 4}$ and modal mass matrix $M_{\\mathrm{modal}}\\in\\mathbb{R}^{4\\times 4}$ using the exact integrals relative to the basis $\\{\\phi_k\\}_{k=0}^{3}$.\n\n2. Let $\\{x_i\\}_{i=0}^{3}$ be the Legendre–Gauss–Lobatto (LGL) nodes for $N=3$, and let $\\{\\ell_i\\}_{i=0}^{3}$ denote the corresponding nodal Lagrange polynomials satisfying $\\ell_i(x_j)=\\delta_{ij}$. Define the Vandermonde matrix $V\\in\\mathbb{R}^{4\\times 4}$ by $V_{ij}=\\phi_j(x_i)$, where the modal coefficients $\\mathbf{c}$ and nodal values $\\mathbf{u}$ are related by $\\mathbf{u}=V\\,\\mathbf{c}$.\n\n3. Using only the fundamental mapping of coefficients under a change of basis, transform $K_{\\mathrm{modal}}$ to the nodal LGL basis to obtain $K_{\\mathrm{nodal}}=V^{-T}K_{\\mathrm{modal}}V^{-1}$ and explicitly compute this dense $4\\times 4$ matrix. \n\n4. Consider the generalized eigenvalue problem for the continuous operator represented in each basis: find $\\lambda$ and a nonzero vector $\\mathbf{z}$ such that $K\\,\\mathbf{z}=\\lambda\\,M\\,\\mathbf{z}$. Show from first principles that the spectrum of the operator is invariant under the change of basis between modal and nodal representations (i.e., the generalized eigenvalues of $(K_{\\mathrm{modal}},M_{\\mathrm{modal}})$ and $(K_{\\mathrm{nodal}},M_{\\mathrm{nodal}})$ coincide). Then compute the three positive generalized eigenvalues explicitly for $N=3$.\n\nReport as your final answer a single exact expression equal to the sum of the three positive generalized eigenvalues. Do not round your answer.", "solution": "### Part 1: Modal Stiffness and Mass Matrices\n\nThe modal basis is given by the first four Legendre polynomials, $\\phi_k(x) = P_k(x)$:\n$$ \\phi_0(x) = 1, \\quad \\phi_1(x) = x, \\quad \\phi_2(x) = \\frac{1}{2}(3x^2 - 1), \\quad \\phi_3(x) = \\frac{1}{2}(5x^3 - 3x) $$\nThe entries of the modal mass matrix $M_{\\mathrm{modal}}$ are given by $(M_{\\mathrm{modal}})_{ij} = \\int_{-1}^{1} \\phi_j(x)\\phi_i(x) dx$. Due to the orthogonality of Legendre polynomials, $\\int_{-1}^{1} P_i(x)P_j(x) dx = \\frac{2}{2i+1}\\delta_{ij}$, this matrix is diagonal.\n$$ (M_{\\mathrm{modal}})_{ij} = \\frac{2}{2i+1}\\delta_{ij} $$\nFor $i, j \\in \\{0, 1, 2, 3\\}$, we have:\n$$ M_{\\mathrm{modal}} = \\mathrm{diag}\\left(\\frac{2}{1}, \\frac{2}{3}, \\frac{2}{5}, \\frac{2}{7}\\right) = \\begin{pmatrix} 2  0  0  0 \\\\ 0  2/3  0  0 \\\\ 0  0  2/5  0 \\\\ 0  0  0  2/7 \\end{pmatrix} $$\nThe entries of the modal stiffness matrix $K_{\\mathrm{modal}}$ are given by $(K_{\\mathrm{modal}})_{ij} = \\int_{-1}^{1} \\phi_j'(x)\\phi_i'(x) dx$. The derivatives are:\n$$ \\phi_0'(x) = 0, \\quad \\phi_1'(x) = 1, \\quad \\phi_2'(x) = 3x, \\quad \\phi_3'(x) = \\frac{1}{2}(15x^2 - 3) $$\nSince $\\phi_0'(x)=0$, the first row and column of $K_{\\mathrm{modal}}$ are zero. The other entries are calculated by direct integration:\n$K_{11} = \\int_{-1}^{1} (1)(1) dx = 2$\n$K_{12} = \\int_{-1}^{1} (1)(3x) dx = 0$\n$K_{13} = \\int_{-1}^{1} (1)\\left(\\frac{15}{2}x^2 - \\frac{3}{2}\\right) dx = \\left[\\frac{5}{2}x^3 - \\frac{3}{2}x\\right]_{-1}^1 = 2$\n$K_{22} = \\int_{-1}^{1} (3x)^2 dx = 9 \\int_{-1}^{1} x^2 dx = 9(\\frac{2}{3}) = 6$\n$K_{23} = \\int_{-1}^{1} (3x)\\left(\\frac{15}{2}x^2 - \\frac{3}{2}\\right) dx = \\frac{9}{2} \\int_{-1}^{1} (5x^3 - x) dx = 0$\n$K_{33} = \\int_{-1}^{1} \\left(\\frac{15}{2}x^2 - \\frac{3}{2}\\right)^2 dx = \\frac{9}{4} \\int_{-1}^{1} (5x^2-1)^2 dx = \\frac{9}{4} \\int_{-1}^{1} (25x^4 - 10x^2 + 1) dx = \\frac{9}{4}\\left[5x^5 - \\frac{10}{3}x^3 + x\\right]_{-1}^1 = 12$\nBy symmetry, $K_{ji}=K_{ij}$. The modal stiffness matrix is:\n$$ K_{\\mathrm{modal}} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  2  0  2 \\\\ 0  0  6  0 \\\\ 0  2  0  12 \\end{pmatrix} $$\n\n### Part 2: LGL Nodes and Vandermonde Matrix\n\nFor $N=3$, the Legendre-Gauss-Lobatto (LGL) nodes are the roots of $(1-x^2)P_3'(x)=0$. The endpoints are $x_0=-1$ and $x_3=1$. The interior nodes are the roots of $P_3'(x) = \\frac{1}{2}(15x^2 - 3) = 0$, which gives $x^2 = 1/5$, so $x=\\pm 1/\\sqrt{5}$. The LGL nodes are:\n$$ \\{x_0, x_1, x_2, x_3\\} = \\left\\{-1, -\\frac{1}{\\sqrt{5}}, \\frac{1}{\\sqrt{5}}, 1\\right\\} $$\nThe Vandermonde matrix $V$ is defined by $V_{ij} = \\phi_j(x_i)$. Evaluating the Legendre polynomials at these nodes gives:\n$$ V = \\begin{pmatrix}\n\\phi_0(x_0)  \\phi_1(x_0)  \\phi_2(x_0)  \\phi_3(x_0) \\\\\n\\phi_0(x_1)  \\phi_1(x_1)  \\phi_2(x_1)  \\phi_3(x_1) \\\\\n\\phi_0(x_2)  \\phi_1(x_2)  \\phi_2(x_2)  \\phi_3(x_2) \\\\\n\\phi_0(x_3)  \\phi_1(x_3)  \\phi_2(x_3)  \\phi_3(x_3)\n\\end{pmatrix} = \\begin{pmatrix}\n1  -1  1  -1 \\\\\n1  -1/\\sqrt{5}  -1/5  1/\\sqrt{5} \\\\\n1  1/\\sqrt{5}  -1/5  -1/\\sqrt{5} \\\\\n1  1  1  1\n\\end{pmatrix} $$\n\n### Part 3: Nodal Stiffness Matrix Transformation\n\nThe nodal stiffness matrix is given by the transformation $K_{\\mathrm{nodal}} = V^{-T}K_{\\mathrm{modal}}V^{-1}$. We must first compute $V^{-1}$. This can be done by algebraic inversion of the system $\\mathbf{u}=V\\mathbf{c}$, resulting in $\\mathbf{c}=V^{-1}\\mathbf{u}$. By exploiting the symmetries of the nodes and the parity of the basis functions, we find:\n$$ V^{-1} = \\begin{pmatrix}\n1/12  5/12  5/12  1/12 \\\\\n-1/4  -\\sqrt{5}/4  \\sqrt{5}/4  1/4 \\\\\n5/12  -5/12  -5/12  5/12 \\\\\n-1/4  \\sqrt{5}/4  -\\sqrt{5}/4  1/4\n\\end{pmatrix} $$\nNow we compute the product $A = K_{\\mathrm{modal}}V^{-1}$:\n$$ A = \\begin{pmatrix} 0  0  0  0 \\\\ 0  2  0  2 \\\\ 0  0  6  0 \\\\ 0  2  0  12 \\end{pmatrix} \\begin{pmatrix} 1/12  5/12  5/12  1/12 \\\\ -1/4  -\\sqrt{5}/4  \\sqrt{5}/4  1/4 \\\\ 5/12  -5/12  -5/12  5/12 \\\\ -1/4  \\sqrt{5}/4  -\\sqrt{5}/4  1/4 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  0 \\\\ -1  0  0  1 \\\\ 5/2  -5/2  -5/2  5/2 \\\\ -7/2  5\\sqrt{5}/2  -5\\sqrt{5}/2  7/2 \\end{pmatrix} $$\nFinally, we compute $K_{\\mathrm{nodal}} = V^{-T}A$.\n$$ K_{\\mathrm{nodal}} = \\begin{pmatrix} 1/12  -1/4  5/12  -1/4 \\\\ 5/12  -\\sqrt{5}/4  -5/12  \\sqrt{5}/4 \\\\ 5/12  \\sqrt{5}/4  -5/12  -\\sqrt{5}/4 \\\\ 1/12  1/4  5/12  1/4 \\end{pmatrix} \\begin{pmatrix} 0  0  0  0 \\\\ -1  0  0  1 \\\\ 5/2  -5/2  -5/2  5/2 \\\\ -7/2  5\\sqrt{5}/2  -5\\sqrt{5}/2  7/2 \\end{pmatrix} $$\nCarrying out this matrix multiplication yields the dense, symmetric nodal stiffness matrix:\n$$ K_{\\mathrm{nodal}} = \\frac{1}{24} \\begin{pmatrix}\n52  -25-15\\sqrt{5}  -25+15\\sqrt{5}  -2 \\\\\n-25-15\\sqrt{5}  100  -50  -25+15\\sqrt{5} \\\\\n-25+15\\sqrt{5}  -50  100  -25-15\\sqrt{5} \\\\\n-2  -25+15\\sqrt{5}  -25-15\\sqrt{5}  52\n\\end{pmatrix} $$\n\n### Part 4: Generalized Eigenvalue Problem\n\nFirst, we show that the spectrum is invariant under the change of basis. The generalized eigenvalue problem is given by $K\\mathbf{z} = \\lambda M\\mathbf{z}$.\nIn the modal basis: $K_{\\mathrm{modal}}\\mathbf{c} = \\lambda M_{\\mathrm{modal}}\\mathbf{c}$.\nIn the nodal basis: $K_{\\mathrm{nodal}}\\mathbf{u} = \\lambda' M_{\\mathrm{nodal}}\\mathbf{u}$.\nThe basis transformation rules are $\\mathbf{u} = V\\mathbf{c}$, $K_{\\mathrm{nodal}} = V^{-T}K_{\\mathrm{modal}}V^{-1}$, and $M_{\\mathrm{nodal}} = V^{-T}M_{\\mathrm{modal}}V^{-1}$.\nSubstituting these into the nodal problem:\n$$ (V^{-T}K_{\\mathrm{modal}}V^{-1})\\mathbf{u} = \\lambda' (V^{-T}M_{\\mathrm{modal}}V^{-1})\\mathbf{u} $$\nLeft-multiplying by $V^T$ (since $V$ is invertible, so is $V^T$):\n$$ (K_{\\mathrm{modal}}V^{-1})\\mathbf{u} = \\lambda' (M_{\\mathrm{modal}}V^{-1})\\mathbf{u} $$\nSubstituting $\\mathbf{c} = V^{-1}\\mathbf{u}$:\n$$ K_{\\mathrm{modal}}\\mathbf{c} = \\lambda' M_{\\mathrm{modal}}\\mathbf{c} $$\nThis is identical in form to the modal eigenproblem. Thus, if $(\\lambda', \\mathbf{u})$ is an eigenpair for the nodal system, then $(\\lambda', \\mathbf{c}=V^{-1}\\mathbf{u})$ is an eigenpair for the modal system. Since $V$ is invertible, the mapping between eigenvectors is one-to-one. Therefore, the sets of eigenvalues are identical, $\\lambda' = \\lambda$.\n\nNext, we compute the three positive eigenvalues. It is far simpler to solve the modal problem, as the matrices are sparser. We solve $K_{\\mathrm{modal}}\\mathbf{c} = \\lambda M_{\\mathrm{modal}}\\mathbf{c}$:\n$$ \\begin{pmatrix} 0  0  0  0 \\\\ 0  2  0  2 \\\\ 0  0  6  0 \\\\ 0  2  0  12 \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\lambda \\begin{pmatrix} 2  0  0  0 \\\\ 0  2/3  0  0 \\\\ 0  0  2/5  0 \\\\ 0  0  0  2/7 \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} $$\nThe first equation is $0 = \\lambda(2c_0)$, which implies $\\lambda=0$ or $c_0=0$. This gives the zero eigenvalue $\\lambda_0=0$ corresponding to the constant mode $\\phi_0$. We are interested in the positive eigenvalues, so we must have $c_0=0$. The system reduces to a $3 \\times 3$ problem for $\\{c_1, c_2, c_3\\}$:\n$$ \\begin{pmatrix} 2  0  2 \\\\ 0  6  0 \\\\ 2  0  12 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\lambda \\begin{pmatrix} 2/3  0  0 \\\\ 0  2/5  0 \\\\ 0  0  2/7 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} $$\nThe second equation decouples: $6c_2 = \\lambda(2/5)c_2$. For a non-trivial eigenvector with $c_2 \\neq 0$, this yields an eigenvalue:\n$$ \\lambda_A = 6 \\cdot \\frac{5}{2} = 15 $$\nThe remaining two eigenvalues come from the coupled system for $c_1$ and $c_3$ (assuming $c_2=0$):\n$$ \\begin{pmatrix} 2  2 \\\\ 2  12 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_3 \\end{pmatrix} = \\lambda \\begin{pmatrix} 2/3  0 \\\\ 0  2/7 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_3 \\end{pmatrix} $$\nWe solve the characteristic equation $\\det(K' - \\lambda M')=0$:\n$$ \\det \\begin{pmatrix} 2 - \\frac{2\\lambda}{3}  2 \\\\ 2  12 - \\frac{2\\lambda}{7} \\end{pmatrix} = 0 $$\n$$ \\left(2 - \\frac{2\\lambda}{3}\\right)\\left(12 - \\frac{2\\lambda}{7}\\right) - 4 = 0 $$\n$$ 4\\left(1 - \\frac{\\lambda}{3}\\right)\\left(6 - \\frac{\\lambda}{7}\\right) - 4 = 0 $$\n$$ 6 - \\frac{\\lambda}{7} - 2\\lambda + \\frac{\\lambda^2}{21} = 1 $$\nMultiplying by $21$ gives:\n$$ 126 - 3\\lambda - 42\\lambda + \\lambda^2 = 21 $$\n$$ \\lambda^2 - 45\\lambda + 105 = 0 $$\nThis quadratic equation yields two eigenvalues, $\\lambda_B$ and $\\lambda_C$. By Vieta's formulas, the sum of these roots is $\\lambda_B + \\lambda_C = 45$.\nThe three positive generalized eigenvalues are $\\lambda_A=15$, and $\\lambda_B, \\lambda_C$ which are the roots of $\\lambda^2 - 45\\lambda + 105 = 0$. The problem asks for the sum of these three positive eigenvalues.\n\nSum = $\\lambda_A + (\\lambda_B + \\lambda_C) = 15 + 45 = 60$.", "answer": "$$\\boxed{60}$$", "id": "3446146"}, {"introduction": "The application of spectral methods to nonlinear problems, which are ubiquitous in science and engineering, introduces a critical numerical artifact known as aliasing error. This error arises when the numerical quadrature rule is not exact for the high-degree polynomials generated by nonlinear terms, causing high-frequency information to be incorrectly represented as low-frequency behavior. This exercise provides a concrete look at aliasing by having you explicitly calculate the error for a cubic nonlinearity, demonstrating that this error does not vanish as the polynomial degree $N$ increases and is a structural feature of the discretization that must be understood and managed [@problem_id:3446167].", "problem": "Consider a single spectral element on the reference interval $[-1,1]$ in a spectral element method. Let the polynomial approximation be $u(x)=\\sum_{k=0}^{N} c_{k} x^{k}$ of degree $N$ with real coefficients $c_{k}$. To evaluate the nonlinear modal energy transfer, one often computes the integral $\\int_{-1}^{1} u(x)^{3}\\,dx$ using Legendre–Gauss–Lobatto (LGL) quadrature. Define the aliasing error as the difference between the LGL quadrature applied to $u(x)^{3}$ and the exact integral,\n$$E_{N}(c_{0},\\ldots,c_{N}) \\equiv \\sum_{j=0}^{N} w_{j}\\,u(x_{j})^{3} \\;-\\; \\int_{-1}^{1} u(x)^{3}\\,dx,$$\nwhere $\\{x_{j}\\}_{j=0}^{N}$ and $\\{w_{j}\\}_{j=0}^{N}$ are the LGL nodes and weights for degree-$N$ interpolation on $[-1,1]$.\n\nTask 1. Starting from the facts that (i) LGL quadrature integrates polynomials exactly up to a finite degree tied to $N$, and (ii) the polynomial $u(x)^{3}$ has degree $3N$, give a principled argument that $E_{N}(c_{0},\\ldots,c_{N})$ is of order $O(1)$ in $N$ under the assumption that the coefficients $\\{c_{k}\\}$ are independent of $N$ and bounded. Your argument should begin from these foundational facts and explain, without resorting to any shortcut formulas, why underintegration of $u(x)^{3}$ generally leads to an aliasing error that does not grow with $N$.\n\nTask 2. Compute the aliasing error $E_{3}(c_{0},c_{1},c_{2},c_{3})$ explicitly for $N=3$. For this computation, use the $N+1=4$-point LGL rule on $[-1,1]$ with nodes $x_{0}=-1$, $x_{1}=-1/\\sqrt{5}$, $x_{2}=1/\\sqrt{5}$, $x_{3}=1$ and weights $w_{0}=w_{3}=\\frac{1}{6}$, $w_{1}=w_{2}=\\frac{5}{6}$. Your final expression must be given in closed form as a function of $c_{0},c_{1},c_{2},c_{3}$ only.\n\nAnswer format: Provide a single closed-form analytic expression for $E_{3}(c_{0},c_{1},c_{2},c_{3})$. No rounding is required, and no physical units apply here.", "solution": "The problem is divided into two parts. The first part requires a principled argument regarding the order of the aliasing error. The second part requires a direct computation of this error for a specific case.\n\n**Part 1: Argument for Aliasing Error Scaling**\n\nThe aliasing error is defined as\n$$E_{N}(c_{0},\\ldots,c_{N}) \\equiv \\sum_{j=0}^{N} w_{j}\\,u(x_{j})^{3} \\;-\\; \\int_{-1}^{1} u(x)^{3}\\,dx$$\nwhere $u(x) = \\sum_{k=0}^{N} c_k x^k$ is a polynomial of degree $N$, and the quadrature is the $(N+1)$-point Legendre-Gauss-Lobatto (LGL) rule.\n\nThe principled argument proceeds as follows:\n1.  We are given that an $(N+1)$-point LGL quadrature rule exactly integrates any polynomial of degree up to $2N-1$.\n2.  The integrand in our problem is $f(x) = u(x)^3$. Since $u(x)$ is a polynomial of degree $N$, $f(x)$ is a polynomial of degree $3N$. For any $N \\ge 2$, the degree of the integrand, $3N$, is greater than the degree of exactness of the quadrature rule, $2N-1$. Therefore, the LGL quadrature of $u(x)^3$ is not exact, and the error $E_N$ is generally non-zero. This error is a direct result of aliasing, where high-frequency components of the integrand are misinterpreted as low-frequency components by the discrete set of quadrature points.\n3.  We can decompose the integrand $u(x)^3$ into a low-degree part that is integrated exactly and a high-degree part that is not. Let $u(x)^3 = P_{\\le 2N-1}(x) + R(x)$, where $P_{\\le 2N-1}(x)$ is the polynomial containing all terms of $u(x)^3$ with degree up to $2N-1$, and $R(x)$ contains all terms with degrees from $2N$ to $3N$.\n4.  By linearity of the integral and the quadrature sum, the error is:\n    $$E_N = \\left( \\sum_{j=0}^{N} w_j P_{\\le 2N-1}(x_j) + \\sum_{j=0}^{N} w_j R(x_j) \\right) - \\left( \\int_{-1}^{1} P_{\\le 2N-1}(x) dx + \\int_{-1}^{1} R(x) dx \\right)$$\n5.  Due to the exactness property of the LGL rule, the terms involving $P_{\\le 2N-1}(x)$ cancel out: $\\sum_{j=0}^{N} w_j P_{\\le 2N-1}(x_j) = \\int_{-1}^{1} P_{\\le 2N-1}(x) dx$.\n6.  The aliasing error thus simplifies to the error incurred from integrating the high-degree remainder polynomial $R(x)$:\n    $$E_N = \\sum_{j=0}^{N} w_j R(x_j) - \\int_{-1}^{1} R(x) dx$$\n7.  The problem assumes that the coefficients $\\{c_k\\}$ of $u(x)$ are bounded and independent of $N$. This implies that as $N$ increases, we are adding higher-degree terms to $u(x)$ whose coefficients do not grow. The high-degree remainder polynomial $R(x)$ is constructed from products of these coefficients. For example, the highest-degree term in $u(x)^3$ is $c_N^3 x^{3N}$, and the coefficient $c_N^3$ is bounded if $c_N$ is bounded. More generally, the coefficients of $R(x)$ are polynomials in the coefficients $\\{c_k\\}$, and under the given assumption, they remain bounded, not growing with $N$.\n8.  The aliasing error $E_N$ is the difference between the true integral of $R(x)$ and its aliased representation from the quadrature sum. The aliasing phenomenon maps high-frequency modes (like those in $R(x)$) back onto the low-frequency modes resolvable by the grid. The magnitude of this aliased contribution is determined by the magnitude of the high-frequency content itself (i.e., the coefficients of $R(x)$).\n9.  Since the coefficients of $R(x)$ are bounded (not functions of N that grow), the magnitude of $R(x)$ and its integral, as well as the magnitude of its aliased counterpart given by the quadrature sum, are also controlled. They do not contain a factor that systematically grows with $N$. Consequently, their difference, the aliasing error $E_N$, is expected to remain bounded, or be of order $O(1)$, as $N$ varies. It is a structural error inherent to the choice of quadrature rule, not an error that diminishes or explodes with refinement for a fixed class of polynomials as described.\n\n**Part 2: Explicit Computation for $N=3$**\n\nFor $N=3$, the polynomial is $u(x) = c_0 + c_1 x + c_2 x^2 + c_3 x^3$. The integrand $u(x)^3$ is a polynomial of degree $9$. The $N=3$ LGL quadrature rule, which uses $N+1=4$ points, is exact for polynomials of degree up to $2N-1 = 2(3)-1 = 5$.\n\nThe aliasing error $E_3$ is given by:\n$$E_3 = \\sum_{j=0}^{3} w_{j}\\,u(x_{j})^{3} - \\int_{-1}^{1} u(x)^{3}\\,dx$$\nAs established in Part 1, this error arises only from the terms in $u(x)^3$ with degree greater than $5$. Let $R(x)$ be the part of $u(x)^3$ with degree from $6$ to $9$.\n$$E_3 = \\left(\\sum_{j=0}^{3} w_j R(x_j)\\right) - \\left(\\int_{-1}^{1} R(x) dx\\right)$$\nWe first determine the polynomial $R(x)$ by expanding $u(x)^3 = (c_0 + c_1 x + c_2 x^2 + c_3 x^3)^3$ and collecting terms of degree $6$ and higher.\nThe coefficient of $x^k$ in the expansion of $(\\sum_{i=0}^3 c_i x^i)^3$ is $\\sum_{i+j+l=k} c_i c_j c_l$. For terms of degree $\\ge 6$:\n-   Degree $9$: $x^9$ arises from $(c_3 x^3)^3$. Coefficient is $c_3^3$.\n-   Degree $8$: $x^8$ arises from $3(c_3 x^3)^2(c_2 x^2)$. Coefficient is $3c_2 c_3^2$.\n-   Degree $7$: $x^7$ arises from $3(c_1 x)(c_3 x^3)^2$ and $3(c_2 x^2)^2(c_3 x^3)$. Coefficient is $(3c_1 c_3^2 + 3c_2^2 c_3)$.\n-   Degree $6$: $x^6$ arises from $3(c_0)(c_3 x^3)^2$, $6(c_1 x)(c_2 x^2)(c_3 x^3)$, and $(c_2 x^2)^3$. Coefficient is $(3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3)$.\n\nSo, $R(x) = (3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3)x^6 + (3c_1 c_3^2 + 3c_2^2 c_3)x^7 + (3c_2 c_3^2)x^8 + c_3^3 x^9$.\n\nLet's denote the coefficients as $R(x) = A x^6 + B x^7 + C x^8 + D x^9$. By linearity of the error functional $E_3(\\cdot)$, we have $E_3 = A \\cdot E_3(x^6) + B \\cdot E_3(x^7) + C \\cdot E_3(x^8) + D \\cdot E_3(x^9)$.\n\nThe LGL grid $\\{x_j, w_j\\}$ is symmetric. The integral of any odd function over $[-1,1]$ is zero, and the LGL quadrature of any odd function over a symmetric grid is also zero. Therefore, $E_3(x^7)=0$ and $E_3(x^9)=0$. We only need to compute the errors for $x^6$ and $x^8$.\n\nFor $x^6$:\n-   Exact integral: $\\int_{-1}^1 x^6 dx = \\frac{x^7}{7}\\Big|_{-1}^1 = \\frac{2}{7}$.\n-   Quadrature: $\\sum_{j=0}^3 w_j x_j^6 = 2w_0(1)^6 + 2w_1(1/\\sqrt{5})^6 = 2(\\frac{1}{6}) + 2(\\frac{5}{6})(\\frac{1}{125}) = \\frac{1}{3} + \\frac{5}{375} = \\frac{1}{3} + \\frac{1}{75} = \\frac{25+1}{75} = \\frac{26}{75}$.\n-   Error $E_3(x^6) = \\frac{26}{75} - \\frac{2}{7} = \\frac{182 - 150}{525} = \\frac{32}{525}$.\n\nFor $x^8$:\n-   Exact integral: $\\int_{-1}^1 x^8 dx = \\frac{x^9}{9}\\Big|_{-1}^1 = \\frac{2}{9}$.\n-   Quadrature: $\\sum_{j=0}^3 w_j x_j^8 = 2w_0(1)^8 + 2w_1(1/\\sqrt{5})^8 = \\frac{1}{3} + \\frac{5}{3}(\\frac{1}{625}) = \\frac{1}{3} + \\frac{1}{375} = \\frac{125+1}{375} = \\frac{126}{375} = \\frac{42}{125}$.\n-   Error $E_3(x^8) = \\frac{42}{125} - \\frac{2}{9} = \\frac{378 - 250}{1125} = \\frac{128}{1125}$.\n\nNow, we combine these results:\n$E_3 = A \\cdot E_3(x^6) + C \\cdot E_3(x^8) = A \\left(\\frac{32}{525}\\right) + C \\left(\\frac{128}{1125}\\right)$.\n\nSubstituting the expressions for $A$ and $C$:\n$A = 3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3$\n$C = 3c_2 c_3^2$\n\n$E_3 = (3c_0 c_3^2 + 6c_1 c_2 c_3 + c_2^3)\\left(\\frac{32}{525}\\right) + (3c_2 c_3^2)\\left(\\frac{128}{1125}\\right)$.\n\nDistributing the terms:\n$E_3 = \\frac{32 \\cdot 3}{525}c_0 c_3^2 + \\frac{32 \\cdot 6}{525}c_1 c_2 c_3 + \\frac{32}{525}c_2^3 + \\frac{128 \\cdot 3}{1125}c_2 c_3^2$.\n\nSimplifying the numerical coefficients:\n-   $\\frac{32 \\cdot 3}{525} = \\frac{32}{175}$.\n-   $\\frac{32 \\cdot 6}{525} = \\frac{192}{525} = \\frac{64}{175}$.\n-   $\\frac{128 \\cdot 3}{1125} = \\frac{128}{375}$.\n\nThe final expression for the aliasing error is:\n$$E_3(c_0, c_1, c_2, c_3) = \\frac{32}{175}c_0 c_3^2 + \\frac{64}{175}c_1 c_2 c_3 + \\frac{32}{525}c_2^3 + \\frac{128}{375}c_2 c_3^2$$", "answer": "$$\\boxed{\\frac{32}{175} c_{0} c_{3}^{2} + \\frac{64}{175} c_{1} c_{2} c_{3} + \\frac{32}{525} c_{2}^{3} + \\frac{128}{375} c_{2} c_{3}^{2}}$$", "id": "3446167"}]}