{"hands_on_practices": [{"introduction": "The power of mimetic and compatible discretizations stems from their faithful representation of the underlying structure of vector calculus. This practice delves into this foundation by constructing the discrete boundary operators, represented by incidence matrices, for a single tetrahedral cell. By verifying the fundamental topological property that the composition of successive boundary operators is zero (a discrete analogue of $\\nabla \\cdot (\\nabla \\times \\mathbf{F}) = 0$ and $\\nabla \\times (\\nabla \\phi) = \\mathbf{0}$), you will gain hands-on experience with the concept of an exact sequence, which is the algebraic guarantor for many of the desirable properties of these methods [@problem_id:3421371].", "problem": "Consider a single tetrahedral cell with vertices labeled $v_1, v_2, v_3, v_4$. Assume the cell is oriented as the positively oriented $3$-simplex $[1,2,3,4]$. Adopt the following consistent orientation conventions for the mesh entities, as required in mimetic finite difference and compatible discretizations: \n- Every oriented edge $[i,j]$ is directed from the lower index to the higher index, i.e., $i<j$. \n- Every oriented face $[i,j,k]$ is the positively oriented $2$-simplex with $i<j<k$, whose boundary satisfies the fundamental boundary identity $\\partial [i,j,k] = [j,k] - [i,k] + [i,j]$. \n- The oriented boundary of the cell satisfies the fundamental boundary identity $\\partial [1,2,3,4] = [2,3,4] - [1,3,4] + [1,2,4] - [1,2,3]$. \n\nUsing these conventions, do the following: \n- Enumerate the oriented edges in the order $[1,2],[1,3],[1,4],[2,3],[2,4],[3,4]$, and the oriented faces in the order $[1,2,3],[1,2,4],[1,3,4],[2,3,4]$. \n- Construct the edge-face incidence matrix (the boundary operator) $\\partial_2 \\in \\mathbb{R}^{6 \\times 4}$ whose entry in row corresponding to an oriented edge and column corresponding to an oriented face is $+1$ if the oriented edge appears in the oriented boundary of the face with the same orientation, $-1$ if it appears with opposite orientation, and $0$ otherwise. \n- Construct the face-cell incidence matrix (the boundary operator) $\\partial_3 \\in \\mathbb{R}^{4 \\times 1}$ whose entry is $+1$ if the oriented face appears in the oriented boundary of the cell with the same orientation, $-1$ if with opposite orientation, and $0$ otherwise. \n- Verify the fundamental topological identity of boundary operators that the composition is the zero matrix, i.e., $\\partial_2 \\,\\partial_3 = 0$. \n- Compute the ranks $\\operatorname{rank}(\\partial_2)$ and $\\operatorname{rank}(\\partial_3)$. Then, using $D_1 := \\partial_2^{\\top}$ and $D_2 := \\partial_3^{\\top}$ as the discrete coboundary operators acting on cochains (edge-based to face-based, and face-based to cell-based, respectively), use your computed ranks to demonstrate the discrete exactness at degree $2$, namely $\\operatorname{im}(D_1) = \\ker(D_2)$. \n\nFinally, compute the discrete second cohomology dimension \n$$\nb_2 \\;=\\; \\dim\\big(\\ker(D_2)\\big) \\;-\\; \\dim\\big(\\operatorname{im}(D_1)\\big)\n$$,\nand provide its value as a single number with no units.", "solution": "The problem requires the construction of discrete boundary operators for a single tetrahedron and the verification of a fundamental topological property, culminating in the calculation of the discrete second cohomology dimension, $b_2$.\n\nFirst, we establish the basis for our vector spaces of chains. The problem provides an explicit ordering for the oriented edges (1-simplices) and faces (2-simplices).\nThe basis for the space of 1-chains consists of $6$ oriented edges:\n$e_1 = [1,2]$, $e_2 = [1,3]$, $e_3 = [1,4]$, $e_4 = [2,3]$, $e_5 = [2,4]$, $e_6 = [3,4]$.\nThe basis for the space of 2-chains consists of $4$ oriented faces:\n$f_1 = [1,2,3]$, $f_2 = [1,2,4]$, $f_3 = [1,3,4]$, $f_4 = [2,3,4]$.\nThe basis for the space of 3-chains consists of $1$ oriented cell (3-simplex):\n$c_1 = [1,2,3,4]$.\n\nThe first task is to construct the edge-face incidence matrix $\\partial_2 \\in \\mathbb{R}^{6 \\times 4}$. The entry $(\\partial_2)_{ij}$ is the coefficient of the $i$-th edge in the boundary of the $j$-th face. We use the provided boundary formula $\\partial [i,j,k] = [j,k] - [i,k] + [i,j]$ for $i<j<k$ and our edge orientation convention $[i,j]$ for $i<j$.\n\nThe boundary of face $f_1 = [1,2,3]$ is $\\partial[1,2,3] = [2,3] - [1,3] + [1,2] = e_4 - e_2 + e_1$. This gives the first column of $\\partial_2$ as $[1, -1, 0, 1, 0, 0]^{\\top}$.\nThe boundary of face $f_2 = [1,2,4]$ is $\\partial[1,2,4] = [2,4] - [1,4] + [1,2] = e_5 - e_3 + e_1$. This gives the second column as $[1, 0, -1, 0, 1, 0]^{\\top}$.\nThe boundary of face $f_3 = [1,3,4]$ is $\\partial[1,3,4] = [3,4] - [1,4] + [1,3] = e_6 - e_3 + e_2$. This gives the third column as $[0, 1, -1, 0, 0, 1]^{\\top}$.\nThe boundary of face $f_4 = [2,3,4]$ is $\\partial[2,3,4] = [3,4] - [2,4] + [2,3] = e_6 - e_5 + e_4$. This gives the fourth column as $[0, 0, 0, 1, -1, 1]^{\\top}$.\n\nCombining these columns, the matrix $\\partial_2$ is:\n$$ \\partial_2 = \\begin{pmatrix} 1 & 1 & 0 & 0 \\\\ -1 & 0 & 1 & 0 \\\\ 0 & -1 & -1 & 0 \\\\ 1 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 1 & 1 \\end{pmatrix} $$\n\nNext, we construct the face-cell incidence matrix $\\partial_3 \\in \\mathbb{R}^{4 \\times 1}$. Its single column represents the boundary of the cell $c_1 = [1,2,3,4]$. Using the provided formula $\\partial [1,2,3,4] = [2,3,4] - [1,3,4] + [1,2,4] - [1,2,3]$, we have:\n$\\partial c_1 = f_4 - f_3 + f_2 - f_1$.\nThis gives the matrix $\\partial_3$:\n$$ \\partial_3 = \\begin{pmatrix} -1 \\\\ 1 \\\\ -1 \\\\ 1 \\end{pmatrix} $$\n\nNow, we verify the fundamental topological identity $\\partial_2 \\partial_3 = 0$. This property, that \"the boundary of a boundary is zero\", is central to homology and compatible discretizations.\n$$ \\partial_2 \\partial_3 = \\begin{pmatrix} 1 & 1 & 0 & 0 \\\\ -1 & 0 & 1 & 0 \\\\ 0 & -1 & -1 & 0 \\\\ 1 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\\\ -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1(-1) + 1(1) + 0(-1) + 0(1) \\\\ -1(-1) + 0(1) + 1(-1) + 0(1) \\\\ 0(-1) + (-1)(1) + (-1)(-1) + 0(1) \\\\ 1(-1) + 0(1) + 0(-1) + 1(1) \\\\ 0(-1) + 1(1) + 0(-1) + (-1)(1) \\\\ 0(-1) + 0(1) + 1(-1) + 1(1) \\end{pmatrix} = \\begin{pmatrix} -1+1 \\\\ 1-1 \\\\ -1+1 \\\\ -1+1 \\\\ 1-1 \\\\ -1+1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nThe identity is verified.\n\nNext, we compute the ranks of these matrices.\nThe matrix $\\partial_3$ is a $4 \\times 1$ non-zero vector, so its column space has dimension $1$. Thus, $\\operatorname{rank}(\\partial_3) = 1$.\nThe matrix $\\partial_2$ is a $6 \\times 4$ matrix. The relation $\\partial_2 \\partial_3 = 0$ implies a linear dependency among the columns of $\\partial_2$, specifically $-1 \\cdot (\\text{col } 1) + 1 \\cdot (\\text{col } 2) - 1 \\cdot (\\text{col } 3) + 1 \\cdot (\\text{col } 4) = 0$. This means the four columns are linearly dependent, so $\\operatorname{rank}(\\partial_2) < 4$. To check the linear independence of the first three columns, we check if $a(\\text{col } 1) + b(\\text{col } 2) + c(\\text{col } 3) = 0$ implies $a=b=c=0$. The submatrix formed by rows 4, 5, and 6 and columns 1, 2, and 3 is\n$$ \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n(after a trivial permutation of rows and columns inside this submatrix). More formally, considering the rows corresponding to edges $[2,3], [2,4], [3,4]$ gives a lower triangular system that quickly shows linear independence.\nA simpler argument is that the first three columns are linearly independent. The dimension of the column space is therefore $3$.\nSo, $\\operatorname{rank}(\\partial_2) = 3$.\n\nWe now define the discrete coboundary operators as the transposes of the boundary operators: $D_1 = \\partial_2^{\\top}$ and $D_2 = \\partial_3^{\\top}$.\n$D_1$ is a $4 \\times 6$ matrix and $D_2$ is a $1 \\times 4$ matrix. The identity $\\partial_2 \\partial_3 = 0$ implies its transpose is also zero: $(\\partial_2 \\partial_3)^{\\top} = \\partial_3^{\\top} \\partial_2^{\\top} = D_2 D_1 = 0$.\nThe condition $D_2 D_1 = 0$ means that the image of $D_1$ is a subspace of the kernel of $D_2$, i.e., $\\operatorname{im}(D_1) \\subseteq \\ker(D_2)$.\n\nTo demonstrate that $\\operatorname{im}(D_1) = \\ker(D_2)$, we can show that their dimensions are equal.\nThe dimension of the image of $D_1$ is its rank:\n$$ \\dim(\\operatorname{im}(D_1)) = \\operatorname{rank}(D_1) = \\operatorname{rank}(\\partial_2^{\\top}) = \\operatorname{rank}(\\partial_2) = 3 $$\nTo find the dimension of the kernel of $D_2$, we use the rank-nullity theorem. $D_2$ is a linear map from $\\mathbb{R}^4$ to $\\mathbb{R}^1$.\n$$ \\dim(\\text{domain of } D_2) = \\dim(\\ker(D_2)) + \\dim(\\operatorname{im}(D_2)) $$\nThe domain is the space of face cochains, which is $\\mathbb{R}^4$. The dimension of the image is the rank of $D_2$.\n$$ \\dim(\\operatorname{im}(D_2)) = \\operatorname{rank}(D_2) = \\operatorname{rank}(\\partial_3^{\\top}) = \\operatorname{rank}(\\partial_3) = 1 $$\nSubstituting these values into the rank-nullity theorem:\n$$ 4 = \\dim(\\ker(D_2)) + 1 \\implies \\dim(\\ker(D_2)) = 3 $$\nSince $\\operatorname{im}(D_1)$ is a subspace of $\\ker(D_2)$ and $\\dim(\\operatorname{im}(D_1)) = \\dim(\\ker(D_2)) = 3$, the subspaces must be equal: $\\operatorname{im}(D_1) = \\ker(D_2)$. This shows that the discrete de Rham complex is exact at degree $2$.\n\nFinally, we compute the discrete second cohomology dimension, $b_2$, which measures the failure of exactness. It is defined as the dimension of the second cohomology group $H^2 = \\ker(D_2) / \\operatorname{im}(D_1)$.\n$$ b_2 = \\dim(H^2) = \\dim\\big(\\ker(D_2)\\big) - \\dim\\big(\\operatorname{im}(D_1)\\big) $$\nUsing our calculated dimensions:\n$$ b_2 = 3 - 3 = 0 $$\nThe result $b_2 = 0$ is expected, as a single tetrahedron is a contractible space, which has trivial cohomology groups for degrees greater than $0$.", "answer": "$$\\boxed{0}$$", "id": "3421371"}, {"introduction": "A primary motivation for using compatible discretizations is their ability to preserve fundamental physical laws, such as conservation of mass or charge, at the discrete level. This exercise provides a concrete verification of this principle by applying the discrete divergence theorem on a periodic domain, which represents a system without physical boundaries. By summing the discrete divergence over all cells, you will demonstrate that the local, structure-preserving definition of the divergence operator naturally leads to perfect global conservation, a crucial feature for robust physical simulations [@problem_id:3421441].", "problem": "Consider the two-dimensional unit torus $\\mathbb{T}^{2} = [0,1)^{2}$ endowed with periodic boundary conditions and covered by a uniform Cartesian tessellation with $N_{x}, N_{y} \\in \\mathbb{N}$ cells along the $x$- and $y$-directions, respectively. Let the mesh spacings be $h_{x} = 1/N_{x}$ and $h_{y} = 1/N_{y}$, and index cells by $(i,j) \\in \\{0,\\dots,N_{x}-1\\} \\times \\{0,\\dots,N_{y}-1\\}$. For each cell $c_{i,j}$, the outward unit normals on its four faces coincide with the positive coordinate directions on the right and top faces and the negative coordinate directions on the left and bottom faces. Let vertical faces be labeled by half-integer indices $(i+\\tfrac{1}{2}, j)$ and horizontal faces by $(i, j+\\tfrac{1}{2})$, with global face-normal orientations fixed to $+\\hat{\\boldsymbol{e}}_{x}$ for vertical faces and $+\\hat{\\boldsymbol{e}}_{y}$ for horizontal faces. Angles are measured in radians.\n\nYou are given the face-integrated normal fluxes (that is, flux density integrated over the face length) as follows:\n- For each vertical face $(i+\\tfrac{1}{2}, j)$,\n$$\nU^{x}_{i+\\tfrac{1}{2}, j} \\;=\\; h_{y}\\,\\Big[\\sin\\!\\big(2\\pi (i+\\tfrac{1}{2}) h_{x}\\big) \\;+\\; \\cos\\!\\big(2\\pi j\\, h_{y}\\big)\\Big].\n$$\n- For each horizontal face $(i, j+\\tfrac{1}{2})$,\n$$\nU^{y}_{i, j+\\tfrac{1}{2}} \\;=\\; h_{x}\\,\\Big[\\cos\\!\\big(2\\pi i\\, h_{x}\\big) \\;-\\; \\sin\\!\\big(2\\pi (j+\\tfrac{1}{2}) h_{y}\\big)\\Big].\n$$\n\nDefine the compatible discrete divergence operator that maps face-normal fluxes to a cellwise scalar by the oriented flux balance divided by the cell area,\n$$\n\\big(\\mathrm{div}_{h}\\,\\boldsymbol{U}\\big)\\big|_{i,j} \\;=\\; \\frac{1}{h_{x} h_{y}}\\,\\Big(U^{x}_{i+\\tfrac{1}{2}, j} \\;-\\; U^{x}_{i-\\tfrac{1}{2}, j} \\;+\\; U^{y}_{i, j+\\tfrac{1}{2}} \\;-\\; U^{y}_{i, j-\\tfrac{1}{2}}\\Big),\n$$\nwith periodic wrap-around for all half-integer indices.\n\nTasks:\n- Starting only from the above definitions and the fundamental balance-law interpretation of divergence (net oriented outflow per control volume), derive a closed-form expression for $\\big(\\mathrm{div}_{h}\\,\\boldsymbol{U}\\big)\\big|_{i,j}$ in terms of $i$, $j$, $N_{x}$, and $N_{y}$.\n- Let $S$ denote the globally summed discrete divergence weighted by the cell areas,\n$$\nS \\;=\\; \\sum_{i=0}^{N_{x}-1}\\sum_{j=0}^{N_{y}-1} \\, h_{x} h_{y}\\,\\big(\\mathrm{div}_{h}\\,\\boldsymbol{U}\\big)\\big|_{i,j}.\n$$\nUsing the discrete Gauss theorem on a periodic tessellation (no boundary), evaluate $S$ as a single real-valued number.\n\nGive your final answer for $S$ as a single number. No rounding is required.", "solution": "The fundamental base is the divergence theorem (Gauss theorem), which states that for any sufficiently smooth vector field $\\boldsymbol{v}$ on a domain $\\Omega$ with boundary $\\partial\\Omega$, one has\n$$\n\\int_{\\Omega} \\nabla\\!\\cdot\\!\\boldsymbol{v}\\, \\mathrm{d}\\boldsymbol{x} \\;=\\; \\int_{\\partial\\Omega} \\boldsymbol{v}\\cdot \\boldsymbol{n} \\,\\mathrm{d}s.\n$$\nA compatible discretization mimics this balance law at the discrete level: the discrete divergence in a control volume equals the oriented sum of normal fluxes across its boundary divided by the control-volume measure. On a periodic domain, the global boundary integral vanishes because there is no physical boundary.\n\nStep $1$ (cellwise discrete divergence). By definition,\n$$\n\\big(\\mathrm{div}_{h}\\,\\boldsymbol{U}\\big)\\big|_{i,j}\n\\;=\\; \\frac{1}{h_{x} h_{y}}\\Big(U^{x}_{i+\\frac{1}{2}, j} - U^{x}_{i-\\frac{1}{2}, j} + U^{y}_{i, j+\\frac{1}{2}} - U^{y}_{i, j-\\frac{1}{2}}\\Big).\n$$\nInsert the given fluxes. For the vertical-face contribution,\n$$\nU^{x}_{i+\\frac{1}{2}, j} - U^{x}_{i-\\frac{1}{2}, j}\n\\;=\\; h_{y}\\Big[\\sin\\!\\big(2\\pi (i+\\tfrac{1}{2}) h_{x}\\big) - \\sin\\!\\big(2\\pi (i-\\tfrac{1}{2}) h_{x}\\big)\\Big] \\;+\\; h_{y}\\Big[\\cos\\!\\big(2\\pi j\\, h_{y}\\big) - \\cos\\!\\big(2\\pi j\\, h_{y}\\big)\\Big].\n$$\nThe cosine terms cancel identically, leaving\n$$\nU^{x}_{i+\\frac{1}{2}, j} - U^{x}_{i-\\frac{1}{2}, j}\n\\;=\\; h_{y}\\,\\Big[\\sin\\!\\big(\\alpha+\\beta\\big) - \\sin\\!\\big(\\alpha-\\beta\\big)\\Big],\n$$\nwith $\\alpha = 2\\pi i\\, h_{x}$ and $\\beta = \\pi h_{x}$. Using the trigonometric identity $\\sin(\\alpha+\\beta) - \\sin(\\alpha-\\beta) = 2\\cos(\\alpha)\\sin(\\beta)$, we obtain\n$$\nU^{x}_{i+\\frac{1}{2}, j} - U^{x}_{i-\\frac{1}{2}, j}\n\\;=\\; 2 h_{y}\\,\\cos\\!\\big(2\\pi i\\, h_{x}\\big)\\,\\sin\\!\\big(\\pi h_{x}\\big).\n$$\nSimilarly, for the horizontal-face contribution,\n$$\nU^{y}_{i, j+\\frac{1}{2}} - U^{y}_{i, j-\\frac{1}{2}}\n\\;=\\; h_{x}\\Big[\\cos\\!\\big(2\\pi i\\, h_{x}\\big) - \\cos\\!\\big(2\\pi i\\, h_{x}\\big)\\Big] \\;+\\; h_{x}\\Big[-\\sin\\!\\big(2\\pi (j+\\tfrac{1}{2}) h_{y}\\big) + \\sin\\!\\big(2\\pi (j-\\tfrac{1}{2}) h_{y}\\big)\\Big].\n$$\nThe cosine terms cancel, and the remaining pair is\n$$\nU^{y}_{i, j+\\frac{1}{2}} - U^{y}_{i, j-\\frac{1}{2}}\n\\;=\\; h_{x}\\,\\Big[-\\sin\\!\\big(\\gamma+\\delta\\big) + \\sin\\!\\big(\\gamma-\\delta\\big)\\Big],\n$$\nwith $\\gamma = 2\\pi j\\, h_{y}$ and $\\delta = \\pi h_{y}$. Using the same identity in the rearranged form $-\\sin(\\gamma+\\delta) + \\sin(\\gamma-\\delta) = -\\big(\\sin(\\gamma+\\delta) - \\sin(\\gamma-\\delta)\\big) = -2\\cos(\\gamma)\\sin(\\delta)$, we get\n$$\nU^{y}_{i, j+\\frac{1}{2}} - U^{y}_{i, j-\\frac{1}{2}}\n\\;=\\; -\\,2 h_{x}\\,\\cos\\!\\big(2\\pi j\\, h_{y}\\big)\\,\\sin\\!\\big(\\pi h_{y}\\big).\n$$\nTherefore, the closed form expression is\n$$\n\\big(\\mathrm{div}_{h}\\,\\boldsymbol{U}\\big)\\big|_{i,j}\n\\;=\\; \\frac{1}{h_{x} h_{y}}\\Big(2 h_{y}\\,\\cos\\!\\big(2\\pi i\\, h_{x}\\big)\\,\\sin\\!\\big(\\pi h_{x}\\big) \\;-\\; 2 h_{x}\\,\\cos\\!\\big(2\\pi j\\, h_{y}\\big)\\,\\sin\\!\\big(\\pi h_{y}\\big)\\Big),\n$$\nwhich simplifies to\n$$\n\\big(\\mathrm{div}_{h}\\,\\boldsymbol{U}\\big)\\big|_{i,j}\n\\;=\\; \\frac{2}{h_{x}}\\,\\cos\\!\\big(2\\pi i\\, h_{x}\\big)\\,\\sin\\!\\big(\\pi h_{x}\\big) \\;-\\; \\frac{2}{h_{y}}\\,\\cos\\!\\big(2\\pi j\\, h_{y}\\big)\\,\\sin\\!\\big(\\pi h_{y}\\big).\n$$\n\nStep $2$ (global conservation and evaluation of $S$). By definition,\n$$\nS \\;=\\; \\sum_{i=0}^{N_{x}-1}\\sum_{j=0}^{N_{y}-1} h_{x} h_{y}\\,\\big(\\mathrm{div}_{h}\\,\\boldsymbol{U}\\big)\\big|_{i,j}\n\\;=\\; \\sum_{i=0}^{N_{x}-1}\\sum_{j=0}^{N_{y}-1} \\Big(U^{x}_{i+\\frac{1}{2}, j} - U^{x}_{i-\\frac{1}{2}, j} + U^{y}_{i, j+\\frac{1}{2}} - U^{y}_{i, j-\\frac{1}{2}}\\Big).\n$$\nThe double sum splits, and each pair telescopes under periodic wrap-around. For the $x$-fluxes,\n$$\n\\sum_{i=0}^{N_{x}-1}\\sum_{j=0}^{N_{y}-1} \\Big(U^{x}_{i+\\frac{1}{2}, j} - U^{x}_{i-\\frac{1}{2}, j}\\Big)\n\\;=\\; \\sum_{j=0}^{N_{y}-1}\\Big(\\sum_{i=0}^{N_{x}-1} U^{x}_{i+\\frac{1}{2}, j} - \\sum_{i=0}^{N_{x}-1} U^{x}_{i-\\frac{1}{2}, j}\\Big).\n$$\nWith periodic indexing, the index shift $i' = i-1 \\pmod{N_{x}}$ shows that $\\sum_{i=0}^{N_{x}-1} U^{x}_{i-\\frac{1}{2}, j} = \\sum_{i'=0}^{N_{x}-1} U^{x}_{i'+\\frac{1}{2}, j}$, so the difference is $0$. The same argument applies to the $y$-fluxes:\n$$\n\\sum_{i=0}^{N_{x}-1}\\sum_{j=0}^{N_{y}-1} \\Big(U^{y}_{i, j+\\frac{1}{2}} - U^{y}_{i, j-\\frac{1}{2}}\\Big) \\;=\\; 0.\n$$\nHence,\n$$\nS \\;=\\; 0.\n$$\nThis calculation is the discrete Gauss theorem on a periodic cell complex and follows from the topological identity that each interior face is incident to exactly two cells with opposite orientation. Because the domain is periodic, there are no boundary faces, and all face contributions cancel in pairs. Therefore, the globally summed discrete divergence is exactly zero, independently of the particular flux values provided.\n\nWe conclude that the required global sum is\n$$\nS \\;=\\; 0.\n$$", "answer": "$$\\boxed{0}$$", "id": "3421441"}, {"introduction": "Moving from principles to practice, this problem demonstrates how to efficiently solve a boundary value problem using a hybridized mimetic method. You will apply the technique of static condensation, which leverages the local nature of the discretization to eliminate interior unknowns within each cell in favor of unknowns living only on the cell interfaces (Lagrange multipliers). This powerful approach reduces the size of the final linear system to be solved and is a cornerstone of modern, high-performance mimetic solvers [@problem_id:3421436].", "problem": "Consider the steady diffusion model in one spatial dimension on the interval $[0,L]$ with $L = 2$. The domain is partitioned into two adjacent cells $K_{1} = [0,1]$ and $K_{2} = [1,2]$. Let the permeability coefficients be $k_{1} = 3$ on $K_{1}$ and $k_{2} = 2$ on $K_{2}$. The governing equations are Darcyâ€™s law and mass conservation, namely $u = -k \\,\\nabla p$ and $\\nabla \\cdot u = f$, with cell sources $f_{1} = 0$ on $K_{1}$ and $f_{2} = 0$ on $K_{2}$. Impose Dirichlet boundary conditions $p(0) = 4$ and $p(2) = 2$. \n\nAdopt a lowest-order Mimetic Finite Difference (MFD) hybridization on this two-cell mesh, with hybrid face pressures as Lagrange multipliers enforcing compatibility. On each cell $K_{i}$, let the cell-centered pressure be $p_{i}$ (constant) and let the hybrid pressures on the left and right faces be $\\lambda_{i,L}$ and $\\lambda_{i,R}$, respectively. In one dimension with cell length $h_{i}$ and symmetric face-to-center distances $d_{i,L} = d_{i,R} = h_{i}/2$, the two-point transmissibility coefficients on the faces are defined by \n$$\\tau_{i,L} = \\frac{k_{i}}{d_{i,L}}, \\qquad \\tau_{i,R} = \\frac{k_{i}}{d_{i,R}}.$$\nThe outward normal fluxes from $K_{i}$ through its faces are given by the discrete constitutive relations\n$$u_{i,L} = \\tau_{i,L}\\big(p_{i} - \\lambda_{i,L}\\big), \\qquad u_{i,R} = \\tau_{i,R}\\big(p_{i} - \\lambda_{i,R}\\big),$$\nand the discrete mass balance on $K_{i}$ is\n$$u_{i,L} + u_{i,R} = f_{i}\\,h_{i}.$$\nUse hybridization and static condensation to eliminate the cell-centered pressures $p_{1}$ and $p_{2}$ and the local fluxes in favor of the single interface hybrid pressure $\\lambda_{I}$ at $x=1$, where $\\lambda_{1,R} = \\lambda_{2,L} = \\lambda_{I}$. Enforce global flux continuity at the interface by requiring $u_{1,R} + u_{2,L} = 0$. The boundary hybrid pressures are set by the Dirichlet conditions, so $\\lambda_{1,L} = 4$ at $x=0$ and $\\lambda_{2,R} = 2$ at $x=2$.\n\nDerive the scalar Schur complement equation for $\\lambda_{I}$, solve explicitly for $\\lambda_{I}$, and reconstruct the local fluxes and cell pressures. Express the interface hybrid pressure $\\lambda_{I}$ in $\\mathrm{Pa}$ as your final answer. No rounding is necessary.", "solution": "The problem is to find the hybrid interface pressure $\\lambda_{I}$ for a steady diffusion model on the domain $[0,2]$, which is partitioned into two cells, $K_1 = [0,1]$ and $K_2 = [1,2]$.\n\nThe given parameters are:\n-   Domain length, $L=2$.\n-   Cell lengths: $h_1 = 1$ for $K_1$ and $h_2 = 1$ for $K_2$.\n-   Permeability coefficients: $k_1 = 3$ on $K_1$ and $k_2 = 2$ on $K_2$.\n-   Cell source terms: $f_1 = 0$ on $K_1$ and $f_2 = 0$ on $K_2$.\n-   Dirichlet boundary conditions: $p(0) = 4$ and $p(2) = 2$.\n\nThe MFD formulation involves cell-centered pressures $p_1, p_2$ and hybrid face pressures $\\lambda_{i,L}, \\lambda_{i,R}$. The boundary conditions are imposed on the hybrid pressures at the domain boundary:\n-   At $x=0$, the left face of $K_1$: $\\lambda_{1,L} = p(0) = 4$.\n-   At $x=2$, the right face of $K_2$: $\\lambda_{2,R} = p(2) = 2$.\n\nAt the internal interface $x=1$, the hybrid pressures from both cells are equated to a single unknown Lagrange multiplier, $\\lambda_I$:\n$$ \\lambda_{1,R} = \\lambda_{2,L} = \\lambda_I $$\n\nThe first step is to calculate the transmissibility coefficients, $\\tau$. For the symmetric two-point flux approximation, the face-to-center distances are $d_{i,L} = d_{i,R} = h_i/2$.\nFor cell $K_1$:\n$h_1 = 1$, so $d_{1,L} = d_{1,R} = 1/2$. With $k_1 = 3$:\n$$ \\tau_{1,L} = \\frac{k_1}{d_{1,L}} = \\frac{3}{1/2} = 6 $$\n$$ \\tau_{1,R} = \\frac{k_1}{d_{1,R}} = \\frac{3}{1/2} = 6 $$\nFor cell $K_2$:\n$h_2 = 1$, so $d_{2,L} = d_{2,R} = 1/2$. With $k_2 = 2$:\n$$ \\tau_{2,L} = \\frac{k_2}{d_{2,L}} = \\frac{2}{1/2} = 4 $$\n$$ \\tau_{2,R} = \\frac{k_2}{d_{2,R}} = \\frac{2}{1/2} = 4 $$\n\nThe next step is to perform static condensation. We express the cell-centered pressures $p_i$ in terms of the hybrid face pressures $\\lambda_{i, \\cdot}$ by using the discrete mass balance equation on each cell:\n$$ u_{i,L} + u_{i,R} = f_i h_i $$\nSubstituting the discrete constitutive relations for the fluxes, $u_{i,L} = \\tau_{i,L}(p_i - \\lambda_{i,L})$ and $u_{i,R} = \\tau_{i,R}(p_i - \\lambda_{i,R})$, we get:\n$$ \\tau_{i,L}(p_i - \\lambda_{i,L}) + \\tau_{i,R}(p_i - \\lambda_{i,R}) = f_i h_i $$\nSolving for $p_i$:\n$$ p_i(\\tau_{i,L} + \\tau_{i,R}) = \\tau_{i,L}\\lambda_{i,L} + \\tau_{i,R}\\lambda_{i,R} + f_i h_i $$\n$$ p_i = \\frac{\\tau_{i,L}\\lambda_{i,L} + \\tau_{i,R}\\lambda_{i,R} + f_i h_i}{\\tau_{i,L} + \\tau_{i,R}} $$\n\nFor cell $K_1$: $f_1=0$, $h_1=1$, so $f_1h_1=0$.\n$$ p_1 = \\frac{\\tau_{1,L}\\lambda_{1,L} + \\tau_{1,R}\\lambda_{1,R}}{\\tau_{1,L} + \\tau_{1,R}} = \\frac{6 \\cdot 4 + 6 \\cdot \\lambda_I}{6+6} = \\frac{24 + 6\\lambda_I}{12} = 2 + \\frac{1}{2}\\lambda_I $$\nFor cell $K_2$: $f_2=0$, $h_2=1$, so $f_2h_2=0$.\n$$ p_2 = \\frac{\\tau_{2,L}\\lambda_{2,L} + \\tau_{2,R}\\lambda_{2,R}}{\\tau_{2,L} + \\tau_{2,R}} = \\frac{4 \\cdot \\lambda_I + 4 \\cdot 2}{4+4} = \\frac{4\\lambda_I + 8}{8} = \\frac{1}{2}\\lambda_I + 1 $$\n\nNow, we construct the Schur complement system for the interface unknown $\\lambda_I$. This is achieved by enforcing flux continuity at the interface $x=1$:\n$$ u_{1,R} + u_{2,L} = 0 $$\nThe outward flux from the right face of $K_1$ is $u_{1,R} = \\tau_{1,R}(p_1 - \\lambda_{1,R})$. Substituting the expression for $p_1$ and the values of $\\tau_{1,R}$ and $\\lambda_{1,R}$:\n$$ u_{1,R} = 6(p_1 - \\lambda_I) = 6\\left( \\left(2 + \\frac{1}{2}\\lambda_I\\right) - \\lambda_I \\right) = 6\\left(2 - \\frac{1}{2}\\lambda_I\\right) = 12 - 3\\lambda_I $$\nThe outward flux from the left face of $K_2$ is $u_{2,L} = \\tau_{2,L}(p_2 - \\lambda_{2,L})$. Substituting the expression for $p_2$ and the values of $\\tau_{2,L}$ and $\\lambda_{2,L}$:\n$$ u_{2,L} = 4(p_2 - \\lambda_I) = 4\\left( \\left(\\frac{1}{2}\\lambda_I + 1\\right) - \\lambda_I \\right) = 4\\left(1 - \\frac{1}{2}\\lambda_I\\right) = 4 - 2\\lambda_I $$\n\nSubstitute these flux expressions into the continuity equation:\n$$ (12 - 3\\lambda_I) + (4 - 2\\lambda_I) = 0 $$\n$$ 16 - 5\\lambda_I = 0 $$\nThis is the scalar Schur complement equation for $\\lambda_I$. Solving for $\\lambda_I$:\n$$ 5\\lambda_I = 16 $$\n$$ \\lambda_I = \\frac{16}{5} $$\n\nAs requested, we can reconstruct the local pressures and fluxes.\nThe interface hybrid pressure is $\\lambda_I = 16/5 = 3.2$.\nThe cell-centered pressures are:\n$$ p_1 = 2 + \\frac{1}{2}\\left(\\frac{16}{5}\\right) = 2 + \\frac{8}{5} = \\frac{10+8}{5} = \\frac{18}{5} = 3.6 $$\n$$ p_2 = \\frac{1}{2}\\left(\\frac{16}{5}\\right) + 1 = \\frac{8}{5} + 1 = \\frac{8+5}{5} = \\frac{13}{5} = 2.6 $$\nThe fluxes at the interface are:\n$$ u_{1,R} = 12 - 3\\left(\\frac{16}{5}\\right) = 12 - \\frac{48}{5} = \\frac{60-48}{5} = \\frac{12}{5} = 2.4 $$\n$$ u_{2,L} = 4 - 2\\left(\\frac{16}{5}\\right) = 4 - \\frac{32}{5} = \\frac{20-32}{5} = -\\frac{12}{5} = -2.4 $$\nThe continuity condition $u_{1,R} + u_{2,L} = 12/5 + (-12/5) = 0$ is satisfied.\nThe problem requests the value of the interface hybrid pressure $\\lambda_I$. The final answer is sought in Pa; since inputs are dimensionless, we provide the numerical value derived.", "answer": "$$\\boxed{\\frac{16}{5}}$$", "id": "3421436"}]}