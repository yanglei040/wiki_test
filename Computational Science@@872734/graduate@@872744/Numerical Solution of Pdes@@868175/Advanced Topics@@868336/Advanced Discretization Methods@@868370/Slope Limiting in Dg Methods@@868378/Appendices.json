{"hands_on_practices": [{"introduction": "To begin our practical exploration, we start with the foundational building block of many shock-capturing schemes: the `minmod` slope limiter. This exercise provides a concrete, hands-on calculation for a simple one-dimensional scalar problem, which is the ideal setting to understand the core mechanism of a Total Variation Diminishing (TVD) limiter. By working through this example [@problem_id:3443823], you will see precisely how the limiter uses neighboring cell averages to detect a local extremum and automatically reduces the local slope to prevent the formation of non-physical oscillations.", "problem": "Consider the one-dimensional scalar conservation law $u_{t} + f(u)_{x} = 0$ discretized on a uniform mesh of cells $\\{I_{i}\\}$ with spacing $h0$ and cell centers $x_{i}$. In a piecewise linear Discontinuous Galerkin (DG) approximation, the local polynomial representation in cell $I_{i}$ is $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$, where $\\bar{u}_{i}$ denotes the cell average and $s_{i}$ is a slope estimated from the modal coefficient. To suppress spurious oscillations while preserving a discrete maximum principle under a monotone numerical flux and a Forward Euler time update, one enforces that the reconstructed interfacial values $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ lie between neighboring cell averages, which implies that the admissible slope must be sign-consistent with the one-sided discrete gradients and must not exceed their magnitudes.\n\nStarting from the above monotonicity constraint and the requirement for Total Variation Diminishing (TVD) behavior, derive the limiting rule for the slope $s_{i}$ in terms of the one-sided differences $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ and $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$, and then apply this rule to compute the limited slope $s_{i}^{\\ell}$ in the following specific configuration:\n- Neighboring cell averages are given by $\\bar{u}_{i-1} = 1$, $\\bar{u}_{i} = 0.2$, and $\\bar{u}_{i+1} = 0.3$.\n- The local unconstrained slope estimate is $s_{i} = 0.9$.\n\nAssume $h0$ and that the limiter is constructed using the classical minmod mechanism applied to the set $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$. Provide the final value of $s_{i}^{\\ell}$ as an exact number with no rounding, and do not include any physical units.", "solution": "The problem requires the derivation of a slope limiting rule for a piecewise linear Discontinuous Galerkin (DG) method and its application to a specific case. The validation of the problem statement is the first step.\n\n**Problem Validation**\n\nStep 1: Extract Givens\n-   The one-dimensional scalar conservation law is $u_{t} + f(u)_{x} = 0$.\n-   The computational grid consists of uniform cells $\\{I_{i}\\}$ with spacing $h  0$ and centers $x_{i}$.\n-   The local DG approximation in cell $I_{i}$ is a linear polynomial $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$, where $\\bar{u}_{i}$ is the cell average and $s_{i}$ is the slope.\n-   A monotonicity constraint is imposed: the reconstructed interfacial values $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ must lie between neighboring cell averages.\n-   This constraint implies that the admissible slope must be sign-consistent with the one-sided discrete gradients, $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ and $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$, and must not exceed their magnitudes.\n-   The specific numerical values for the computation are: $\\bar{u}_{i-1} = 1$, $\\bar{u}_{i} = 0.2$, $\\bar{u}_{i+1} = 0.3$.\n-   The local unconstrained slope estimate is $s_{i} = 0.9$.\n-   The limiter to be used is the classical minmod mechanism applied to the set $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with standard slope-limiting techniques (specifically, a TVD-type limiter) for DG methods, which is a well-established area within numerical analysis for partial differential equations. The problem is well-posed, providing all necessary data and a clear objective. The terminology is precise and objective. There are no contradictions, missing data, or scientifically unsound premises. The problem is a standard exercise in the field of computational fluid dynamics and numerical methods.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A complete solution will be provided.\n\n**Derivation of the Limiting Rule**\n\nThe objective of a slope limiter in this context is to enforce a monotonicity principle, preventing the creation of new local extrema in the numerical solution, which is crucial for obtaining physically meaningful, non-oscillatory solutions to hyperbolic conservation laws. The problem statement provides the core constraints for the limited slope, which we will formalize.\n\nLet $s_i^\\ell$ denote the limited slope. The one-sided discrete gradients (or finite difference slopes) are defined as:\n-   Backward difference slope: $\\Delta_i^- = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}$\n-   Forward difference slope: $\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}$\n\nThe constraints on $s_i^\\ell$ are given as:\n1.  **Sign Consistency**: The slope $s_i^\\ell$ must have the same sign as both $\\Delta_i^-$ and $\\Delta_i^+$. This is only possible if $\\Delta_i^-$ and $\\Delta_i^+$ have the same sign. If their signs differ, which occurs at a local extremum (a peak or a trough), no non-zero slope can be sign-consistent with both. In this case, to prevent overshoot or undershoot, the reconstruction must be made constant, implying the slope must be zero. So, if $\\text{sign}(\\Delta_i^-) \\neq \\text{sign}(\\Delta_i^+)$, then $s_i^\\ell = 0$.\n2.  **Magnitude Constraint**: The magnitude of the slope must not exceed the magnitudes of the one-sided discrete gradients. This translates to $|s_i^\\ell| \\le |\\Delta_i^-|$ and $|s_i^\\ell| \\le |\\Delta_i^+|$. Combining these, we get $|s_i^\\ell| \\le \\min(|\\Delta_i^-|, |\\Delta_i^+|)$.\n\nThese conditions are precisely encapsulated by the minmod function, which is defined for a set of arguments $\\{a_1, a_2, \\dots, a_n\\}$ as:\n$$\n\\text{minmod}(a_1, a_2, \\dots, a_n) =\n\\begin{cases}\n\\min(a_1, \\dots, a_n)  \\text{if } a_j  0 \\text{ for all } j \\\\\n\\max(a_1, \\dots, a_n)  \\text{if } a_j  0 \\text{ for all } j \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nApplying this to the two discrete gradients, the maximum slope satisfying the monotonicity bounds derived from neighbors is $s'_{i} = \\text{minmod}(\\Delta_i^-, \\Delta_i^+)$.\n\nThe final step is to limit the original, unconstrained slope $s_{i}$. The principle of limiting is to modify the original slope as little as possible. The limited slope $s_i^\\ell$ must satisfy the monotonicity conditions derived above, while also not having a magnitude greater than the original slope, i.e., $|s_i^\\ell| \\le |s_i|$. This is achieved by including the original slope $s_i$ as an argument in the minmod function. The resulting limited slope is:\n$$ s_i^\\ell = \\text{minmod}(s_i, s'_{i}) = \\text{minmod}\\left(s_i, \\text{minmod}(\\Delta_i^-, \\Delta_i^+)\\right) $$\nBy the properties of the minmod function, this is equivalent to:\n$$ s_i^\\ell = \\text{minmod}(s_i, \\Delta_i^-, \\Delta_i^+) = \\text{minmod}\\left(s_i, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h}\\right) $$\nThis confirms the validity of the rule specified in the problem statement.\n\n**Application to the Specific Configuration**\n\nWe are asked to compute the limited slope $s_i^\\ell$ for the given data. The arguments for the minmod function are:\n1.  The unconstrained slope: $s_i = 0.9$.\n2.  The backward difference slope: $\\Delta_i^- = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h} = \\frac{0.2 - 1}{h} = -\\frac{0.8}{h}$.\n3.  The forward difference slope: $\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h} = \\frac{0.3 - 0.2}{h} = \\frac{0.1}{h}$.\n\nThe three arguments to the minmod function are $\\{0.9, -0.8/h, 0.1/h\\}$. We must determine their signs. Since $h0$ is given:\n-   $s_i = 0.9$ is positive.\n-   $\\Delta_i^- = -0.8/h$ is negative.\n-   $\\Delta_i^+ = 0.1/h$ is positive.\n\nThe set of arguments $\\{0.9, -0.8/h, 0.1/h\\}$ contains both positive and negative values. According to the definition of the minmod function, if the arguments do not all have the same sign, the result is zero. This situation corresponds to cell $I_i$ being a local minimum ($\\bar{u}_i$ is less than both $\\bar{u}_{i-1}$ and $\\bar{u}_{i+1}$), and the limiter correctly flattens the reconstruction to a constant value ($\\bar{u}_{i}$) to prevent the creation of a new, non-physical minimum (undershoot).\n\nTherefore, the limited slope is:\n$$ s_i^\\ell = \\text{minmod}\\left(0.9, -\\frac{0.8}{h}, \\frac{0.1}{h}\\right) = 0 $$\nThe final value is independent of the mesh spacing $h$.", "answer": "$$\\boxed{0}$$", "id": "3443823"}, {"introduction": "Real-world problems, such as those in gas dynamics, are governed by systems of conservation laws, not single scalar equations. This practice elevates the concept of slope limiting to the 1D Euler equations, forcing a confrontation with a crucial question: in which variables should we apply the limiter? You will implement and compare a naive component-wise limiting scheme with the more physically-sound characteristic-wise approach [@problem_id:3443857], discovering how aligning the limiting process with the system's wave structure is essential for robust and accurate simulations.", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$ in a Discontinuous Galerkin (DG) finite element context. You are given cell-averaged conserved states on a uniform grid in three consecutive cells $i-1$, $i$, and $i+1$:\n$$\n\\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix},\n$$\nwhere $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ collects the density $\\rho$, momentum $\\rho u$, and total energy $E$. All quantities are nondimensional.\n\nUsing a piecewise-linear reconstruction in each cell with symmetric slope limiting based on the Total Variation Diminishing (TVD) minmod function, define the undivided differences\n$$\n\\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1},\\qquad\n\\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i}.\n$$\nLet the minmod function be\n$$\n\\operatorname{mm}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),  \\text{if } ab  0,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n\nPerform the following two reconstructions for the left state at the interface $x_{i+1/2}$:\n\n1) Component-wise limiting in conserved variables: construct the limited slope\n$$\n\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix}\n\\operatorname{mm}(\\Delta^{-}\\rho_{i},\\Delta^{+}\\rho_{i})\\\\\n\\operatorname{mm}(\\Delta^{-}(\\rho u)_{i},\\Delta^{+}(\\rho u)_{i})\\\\\n\\operatorname{mm}(\\Delta^{-}E_{i},\\Delta^{+}E_{i})\n\\end{pmatrix},\n$$\nand set the reconstructed left state\n$$\n\\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\boldsymbol{S}^{\\mathrm{comp}}_{i}.\n$$\n\n2) Characteristic-wise limiting: form the Jacobian-based characteristic decomposition at cell $i$ by using the standard right-eigenvector matrix $\\boldsymbol{R}(\\boldsymbol{U}_{i})$ and its inverse $\\boldsymbol{L}(\\boldsymbol{U}_{i}) = \\boldsymbol{R}(\\boldsymbol{U}_{i})^{-1}$ for the one-dimensional Euler flux Jacobian (in conserved variables). Project the undivided differences to characteristic space\n$$\n\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{-}\\boldsymbol{U}_{i},\\qquad\n\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{+}\\boldsymbol{U}_{i},\n$$\nlimit each characteristic component with the minmod function to obtain $\\widetilde{\\boldsymbol{w}}_{i}$, map back to conserved variables via $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}(\\boldsymbol{U}_{i})\\,\\widetilde{\\boldsymbol{w}}_{i}$, and set\n$$\n\\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i}.\n$$\n\nFor each reconstructed left state, compute the thermodynamic pressure\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right).\n$$\n\nFinally, form the ratio of the two pressures\n$$\n\\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}}.\n$$\n\nAll calculations must be self-consistent with the definitions above. Express the final answer as a pure number (nondimensional), and round your answer to five significant figures.", "solution": "The user has provided a well-defined problem in the field of computational fluid dynamics, specifically concerning slope-limiting techniques for the Discontinuous Galerkin method applied to the one-dimensional Euler equations. The problem is scientifically sound, self-contained, and all required data and definitions are provided. The problem is therefore deemed **valid**.\n\nThe solution requires performing two types of reconstructions for the fluid state at a cell interface and then comparing the resulting pressures. The two methods are component-wise limiting and characteristic-wise limiting.\n\n### Given Data\n- Ratio of specific heats: $\\gamma = 1.4$\n- Cell-averaged conserved states:\n  $$ \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix} $$\n- State vector: $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$\n- Pressure calculation: $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right)$\n\n### Part 1: Component-wise Limiting\n\nFirst, we calculate the undivided differences of the conserved variables between adjacent cells.\n$$ \\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 0.9 - 1.0 \\\\ 0.18 - 0.0 \\\\ 2.018 - 2.5 \\end{pmatrix} = \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} $$\n$$ \\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.5 - 0.9 \\\\ 0.2 - 0.18 \\\\ 1.29 - 2.018 \\end{pmatrix} = \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} $$\n\nNext, we apply the `minmod` function component-wise to these differences to find the limited slope vector $\\boldsymbol{S}^{\\mathrm{comp}}_{i}$.\n$$ S^{\\mathrm{comp}}_{1} = \\operatorname{mm}(-0.1, -0.4) = \\operatorname{sign}(-0.1)\\min(|-0.1|, |-0.4|) = -0.1 $$\n$$ S^{\\mathrm{comp}}_{2} = \\operatorname{mm}(0.18, 0.02) = \\operatorname{sign}(0.18)\\min(|0.18|, |0.02|) = 0.02 $$\n$$ S^{\\mathrm{comp}}_{3} = \\operatorname{mm}(-0.482, -0.728) = \\operatorname{sign}(-0.482)\\min(|-0.482|, |-0.728|) = -0.482 $$\nSo, the limited slope is $\\boldsymbol{S}^{\\mathrm{comp}}_{i} = (-0.1, 0.02, -0.482)^{\\mathsf{T}}$.\n\nThe reconstructed left state at the interface $x_{i+1/2}$ is given by:\n$$ \\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.1 \\\\ 0.02 \\\\ -0.482 \\end{pmatrix} = \\begin{pmatrix} 0.9 - 0.05 \\\\ 0.18 + 0.01 \\\\ 2.018 - 0.241 \\end{pmatrix} = \\begin{pmatrix} 0.85 \\\\ 0.19 \\\\ 1.777 \\end{pmatrix} $$\nLet this reconstructed state be denoted $\\boldsymbol{U}^{\\mathrm{comp}} = (\\rho^{\\mathrm{comp}}, (\\rho u)^{\\mathrm{comp}}, E^{\\mathrm{comp}})^{\\mathsf{T}}$.\n\nFinally, we compute the pressure $p^{\\mathrm{comp}}$ for this state:\n$$ p^{\\mathrm{comp}} = (\\gamma - 1)\\left(E^{\\mathrm{comp}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{comp}})^{2}}{\\rho^{\\mathrm{comp}}}\\right) = (1.4 - 1)\\left(1.777 - \\frac{1}{2}\\,\\frac{(0.19)^{2}}{0.85}\\right) $$\n$$ p^{\\mathrm{comp}} = 0.4\\left(1.777 - \\frac{0.0361}{1.7}\\right) = 0.4(1.777 - 0.02123529...) = 0.4(1.7557647...) = 0.70230588... $$\n\n### Part 2: Characteristic-wise Limiting\n\nThis procedure requires projecting the differences onto the characteristic fields of the Euler equations. The matrices for this projection, $\\boldsymbol{R}$ and $\\boldsymbol{L}$, depend on the local fluid state in cell $i$.\nFirst, we compute the primitive variables for state $\\boldsymbol{U}_{i}$:\n$$ \\rho_i = 0.9 $$\n$$ u_i = \\frac{(\\rho u)_i}{\\rho_i} = \\frac{0.18}{0.9} = 0.2 $$\n$$ p_i = (\\gamma-1)\\left(E_i - \\frac{1}{2}\\rho_i u_i^2\\right) = (1.4-1)\\left(2.018 - \\frac{1}{2}(0.9)(0.2)^2\\right) = 0.4(2.018 - 0.018) = 0.4(2.0) = 0.8 $$\nThe speed of sound $c_i$ is:\n$$ c_i = \\sqrt{\\frac{\\gamma p_i}{\\rho_i}} = \\sqrt{\\frac{1.4 \\times 0.8}{0.9}} = \\sqrt{\\frac{1.12}{0.9}} = \\sqrt{\\frac{56}{45}} \\approx 1.11554676 $$\n\nThe left eigenvector matrix $\\boldsymbol{L}(\\boldsymbol{U}_{i})$ is used to project the undivided differences into characteristic space. Using a standard formulation, we get:\n$$ \\boldsymbol{L}(\\boldsymbol{U}_{i}) \\approx \\begin{pmatrix} 0.092871  -0.480424  0.160714 \\\\ 0.993683  0.064286  -0.321429 \\\\ -0.086455  0.416161  0.160714 \\end{pmatrix} $$\nWe now project the differences: $\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}\\Delta^{-}\\boldsymbol{U}_{i}$ and $\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}\\Delta^{+}\\boldsymbol{U}_{i}$.\n$$ \\boldsymbol{w}^{-}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} \\approx \\begin{pmatrix} -0.173227 \\\\ 0.067132 \\\\ 0.006091 \\end{pmatrix} $$\n$$ \\boldsymbol{w}^{+}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ -0.162197 \\\\ -0.074094 \\end{pmatrix} $$\n\nNext, apply the `minmod` function to each component of the characteristic variable vectors:\n$$ \\widetilde{w}_{1} = \\operatorname{mm}(w^{-}_{1}, w^{+}_{1}) = \\operatorname{mm}(-0.173227, -0.163755) = -0.163755 $$\n$$ \\widetilde{w}_{2} = \\operatorname{mm}(w^{-}_{2}, w^{+}_{2}) = \\operatorname{mm}(0.067132, -0.162197) = 0 $$\n$$ \\widetilde{w}_{3} = \\operatorname{mm}(w^{-}_{3}, w^{+}_{3}) = \\operatorname{mm}(0.006091, -0.074094) = 0 $$\nThe limited characteristic vector is $\\widetilde{\\boldsymbol{w}}_{i} \\approx (-0.163755, 0, 0)^{\\mathsf{T}}$. The slopes for the second and third characteristic fields are set to zero because the signs of their corresponding differences are opposite, indicating a local extremum.\n\nThis limited vector is mapped back to conserved variables using the right eigenvector matrix, $\\boldsymbol{R}(\\boldsymbol{U}_{i})$, to get the limited slope $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}\\widetilde{\\boldsymbol{w}}_{i}$. Since only the first component of $\\widetilde{\\boldsymbol{w}}_{i}$ is non-zero, we only need the first right eigenvector $\\boldsymbol{r}_1$:\n$$ \\boldsymbol{r}_1 = (1, u-c, H-uc)^{\\mathsf{T}} $$\nwhere $H = \\frac{E+p}{\\rho}$ is the specific total enthalpy.\n$$ H_i = \\frac{E_i+p_i}{\\rho_i} = \\frac{2.018+0.8}{0.9} = \\frac{2.818}{0.9} \\approx 3.131111... $$\n$$ \\boldsymbol{r}_1 \\approx (1, 0.2 - 1.115547, 3.131111 - 0.2 \\times 1.115547)^{\\mathsf{T}} \\approx (1, -0.915547, 2.908002)^{\\mathsf{T}} $$\nThe limited slope is:\n$$ \\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\widetilde{w}_{1} \\boldsymbol{r}_1 \\approx -0.163755 \\times \\begin{pmatrix} 1 \\\\ -0.915547 \\\\ 2.908002 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} $$\n\nThe reconstructed left state at the interface $x_{i+1/2}$ is:\n$$ \\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} \\approx \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} \\approx \\begin{pmatrix} 0.818123 \\\\ 0.254961 \\\\ 1.779904 \\end{pmatrix} $$\nLet this be $\\boldsymbol{U}^{\\mathrm{char}} = (\\rho^{\\mathrm{char}}, (\\rho u)^{\\mathrm{char}}, E^{\\mathrm{char}})^{\\mathsf{T}}$.\n\nThe corresponding pressure $p^{\\mathrm{char}}$ is:\n$$ p^{\\mathrm{char}} = (\\gamma - 1)\\left(E^{\\mathrm{char}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{char}})^{2}}{\\rho^{\\mathrm{char}}}\\right) \\approx 0.4\\left(1.779904 - \\frac{1}{2}\\,\\frac{(0.254961)^{2}}{0.818123}\\right) $$\n$$ p^{\\mathrm{char}} \\approx 0.4\\left(1.779904 - \\frac{0.065005}{1.636246}\\right) \\approx 0.4(1.779904 - 0.039728) \\approx 0.4(1.740176) \\approx 0.696070 $$\n\n### Final Calculation\n\nFinally, we compute the ratio $\\Pi$ of the two pressures:\n$$ \\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}} \\approx \\frac{0.696070}{0.70230588} \\approx 0.9911225... $$\n\nRounding the result to five significant figures gives $0.99112$.", "answer": "$$\n\\boxed{0.99112}\n$$", "id": "3443857"}, {"introduction": "While simple slope limiters are effective for first-order accuracy, a key advantage of the Discontinuous Galerkin method is its capacity for high-order approximations. This advanced practice explores a more sophisticated strategy, subcell limiting, designed to preserve monotonicity within a high-order DG polynomial of degree $p=2$. This detailed, multi-step exercise [@problem_id:3443832] will guide you through the process of decomposing a high-order polynomial into subcell averages, applying a limiter at the subcell level, and then reconstructing a new, limited high-order polynomial via an $L^{2}$-projection, illustrating a modern approach to balancing accuracy and stability.", "problem": "Consider a one-dimensional scalar conservation law $u_{t} + f(u)_{x} = 0$ discretized by a Discontinuous Galerkin (DG) method of polynomial degree $2$ on a uniform mesh. Focus on a single cell mapped affinely to the reference element $\\xi \\in [-1,1]$. At a given time, the local DG representation on this cell is given in the Legendre basis $\\{P_{0}(\\xi), P_{1}(\\xi), P_{2}(\\xi)\\}$ by\n$$\nu_{h}(\\xi) \\;=\\; \\bar{u} \\, P_{0}(\\xi) \\;+\\; \\alpha_{1}\\, P_{1}(\\xi) \\;+\\; \\alpha_{2}\\, P_{2}(\\xi),\n$$\nwith $P_{0}(\\xi) = 1$, $P_{1}(\\xi) = \\xi$, and $P_{2}(\\xi) = \\frac{3\\xi^{2} - 1}{2}$. Take the specific polynomial data $\\bar{u} = 0$, $\\alpha_{1} = 1$, $\\alpha_{2} = 1$, so that\n$$\nu_{h}(\\xi) \\;=\\; \\xi \\;+\\; \\frac{3\\xi^{2}-1}{2}.\n$$\nTo perform a subcell-based slope limiting procedure within this cell, proceed as follows.\n\n1. Subdivide the reference cell into four equal subcells $J_{1} = [-1,-\\frac{1}{2}]$, $J_{2} = [-\\frac{1}{2},0]$, $J_{3} = [0,\\frac{1}{2}]$, and $J_{4} = [\\frac{1}{2},1]$. For each subcell $J_{k}$, compute the subcell average\n$$\nA_{k} \\;=\\; \\frac{1}{|J_{k}|} \\int_{J_{k}} u_{h}(\\xi)\\, d\\xi, \\quad \\text{with} \\quad |J_{k}| = \\frac{1}{2}.\n$$\n\n2. Define the minmod function for any finite set $\\{a_{j}\\}$ by\n$$\n\\operatorname{minmod}(a_{1},\\dots,a_{m}) \\;=\\;\n\\begin{cases}\n\\operatorname{sign}(a_{1}) \\,\\min\\{|a_{1}|,\\dots,|a_{m}|\\},  \\text{if } \\operatorname{sign}(a_{1})=\\cdots=\\operatorname{sign}(a_{m}),\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nLet the subcell centers be $c_{1}=-\\frac{3}{4}$, $c_{2}=-\\frac{1}{4}$, $c_{3}=\\frac{1}{4}$, $c_{4}=\\frac{3}{4}$, and let the subcell width be $\\Delta=\\frac{1}{2}$. For each subcell $J_{k}$, compute the raw slope $s_{k}^{\\mathrm{raw}} = u_{h}'(c_{k})$. Then compute discrete differences using subcell averages:\n$$\nd_{k}^{-} \\;=\\; \\frac{A_{k}-A_{k-1}}{\\Delta}, \\;\\; k=2,3,4, \n\\qquad\nd_{k}^{+} \\;=\\; \\frac{A_{k+1} - A_{k}}{\\Delta}, \\;\\; k=1,2,3.\n$$\nDefine the limited slopes by\n$$\ns_{1} \\;=\\; \\operatorname{minmod}\\!\\big(s_{1}^{\\mathrm{raw}}, d_{1}^{+}\\big),\\quad\ns_{k} \\;=\\; \\operatorname{minmod}\\!\\big(s_{k}^{\\mathrm{raw}}, d_{k}^{-}, d_{k}^{+}\\big)\\; \\text{for } k=2,3,\\quad\ns_{4} \\;=\\; \\operatorname{minmod}\\!\\big(s_{4}^{\\mathrm{raw}}, d_{4}^{-}\\big).\n$$\n\n3. Construct a piecewise linear subcell surrogate $\\tilde{u}(\\xi)$ by prescribing on each $J_{k}$ the linear profile\n$$\n\\tilde{u}(\\xi)\\big|_{J_{k}} \\;=\\; A_{k} \\;+\\; s_{k}\\,(\\xi - c_{k}),\n$$\nso that the subcell average on $J_{k}$ is $A_{k}$.\n\n4. Reconstruct the limited DG polynomial $\\hat{u}(\\xi)$ of degree at most $2$ as the $L^{2}$-projection of $\\tilde{u}$ onto $\\operatorname{span}\\{P_{0},P_{1},P_{2}\\}$, that is,\n$$\n\\hat{u}(\\xi) \\;=\\; \\hat{\\alpha}_{0} P_{0}(\\xi) \\;+\\; \\hat{\\alpha}_{1} P_{1}(\\xi) \\;+\\; \\hat{\\alpha}_{2} P_{2}(\\xi),\n$$\nwith coefficients determined by\n$$\n\\hat{\\alpha}_{n} \\;=\\; \\frac{\\int_{-1}^{1} \\tilde{u}(\\xi)\\,P_{n}(\\xi)\\, d\\xi}{\\int_{-1}^{1} P_{n}(\\xi)^{2} \\, d\\xi},\n\\quad n=0,1,2,\n$$\nand the Legendre orthogonality integrals $\\int_{-1}^{1} P_{n}(\\xi)^{2}\\, d\\xi = \\frac{2}{2n+1}$.\n\nCarry out all steps symbolically and exactly. Provide the final limited DG polynomial $\\hat{u}(\\xi)$ as a single explicit polynomial in $\\xi$. Do not round; give exact rational coefficients.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. It describes a standard subcell slope-limiting procedure for a Discontinuous Galerkin (DG) method. The task is to execute this procedure for a specific polynomial. We will follow the four steps outlined in the problem statement.\n\nThe initial DG polynomial on the reference element $\\xi \\in [-1,1]$ is\n$$\nu_{h}(\\xi) = \\xi + \\frac{3\\xi^{2}-1}{2} = \\frac{3}{2}\\xi^2 + \\xi - \\frac{1}{2}.\n$$\n\n**Step 1: Compute subcell averages**\n\nWe subdivide the reference cell $[-1,1]$ into four subcells $J_{1} = [-1,-1/2]$, $J_{2} = [-1/2,0]$, $J_{3} = [0,1/2]$, and $J_{4} = [1/2,1]$, each of width $|J_{k}| = 1/2$. The subcell average is $A_k = \\frac{1}{|J_k|} \\int_{J_k} u_h(\\xi) d\\xi = 2 \\int_{J_k} u_h(\\xi) d\\xi$.\nFirst, we find the antiderivative of $u_h(\\xi)$:\n$$\nF(\\xi) = \\int \\left(\\frac{3}{2}\\xi^2 + \\xi - \\frac{1}{2}\\right) d\\xi = \\frac{1}{2}\\xi^3 + \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi.\n$$\nNow, we compute the averages:\n$$\nA_1 = 2 \\int_{-1}^{-1/2} u_h(\\xi) d\\xi = 2 [F(\\xi)]_{-1}^{-1/2} = 2(F(-1/2) - F(-1)).\n$$\n$F(-1/2) = \\frac{1}{2}(-\\frac{1}{8}) + \\frac{1}{2}(\\frac{1}{4}) - \\frac{1}{2}(-\\frac{1}{2}) = -\\frac{1}{16} + \\frac{1}{8} + \\frac{1}{4} = \\frac{-1+2+4}{16} = \\frac{5}{16}$.\n$F(-1) = \\frac{1}{2}(-1) + \\frac{1}{2}(1) - \\frac{1}{2}(-1) = -\\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = \\frac{1}{2}$.\nThus, $A_1 = 2(\\frac{5}{16} - \\frac{1}{2}) = 2(\\frac{5-8}{16}) = 2(-\\frac{3}{16}) = -\\frac{3}{8}$.\n\n$$\nA_2 = 2 \\int_{-1/2}^{0} u_h(\\xi) d\\xi = 2(F(0) - F(-1/2)) = 2(0 - \\frac{5}{16}) = -\\frac{5}{8}.\n$$\n\n$$\nA_3 = 2 \\int_{0}^{1/2} u_h(\\xi) d\\xi = 2(F(1/2) - F(0)).\n$$\n$F(1/2) = \\frac{1}{2}(\\frac{1}{8}) + \\frac{1}{2}(\\frac{1}{4}) - \\frac{1}{2}(\\frac{1}{2}) = \\frac{1}{16} + \\frac{1}{8} - \\frac{1}{4} = \\frac{1+2-4}{16} = -\\frac{1}{16}$.\nThus, $A_3 = 2(-\\frac{1}{16} - 0) = -\\frac{1}{8}$.\n\n$$\nA_4 = 2 \\int_{1/2}^{1} u_h(\\xi) d\\xi = 2(F(1) - F(1/2)).\n$$\n$F(1) = \\frac{1}{2}(1) + \\frac{1}{2}(1) - \\frac{1}{2}(1) = \\frac{1}{2}$.\nThus, $A_4 = 2(\\frac{1}{2} - (-\\frac{1}{16})) = 2(\\frac{8+1}{16}) = 2(\\frac{9}{16}) = \\frac{9}{8}$.\n\nThe subcell averages are: $A_1 = -3/8$, $A_2 = -5/8$, $A_3 = -1/8$, $A_4 = 9/8$.\n\n**Step 2: Compute limited slopes**\n\nFirst, we compute the raw slopes $s_k^{\\mathrm{raw}} = u_h'(c_k)$. The derivative is $u_h'(\\xi) = 3\\xi + 1$. The subcell centers are $c_1=-3/4$, $c_2=-1/4$, $c_3=1/4$, $c_4=3/4$.\n$s_1^{\\mathrm{raw}} = 3(-\\frac{3}{4}) + 1 = -\\frac{9}{4} + 1 = -\\frac{5}{4}$.\n$s_2^{\\mathrm{raw}} = 3(-\\frac{1}{4}) + 1 = -\\frac{3}{4} + 1 = \\frac{1}{4}$.\n$s_3^{\\mathrm{raw}} = 3(\\frac{1}{4}) + 1 = \\frac{3}{4} + 1 = \\frac{7}{4}$.\n$s_4^{\\mathrm{raw}} = 3(\\frac{3}{4}) + 1 = \\frac{9}{4} + 1 = \\frac{13}{4}$.\n\nNext, we compute the discrete differences with subcell width $\\Delta = 1/2$.\n$d_1^{+} = \\frac{A_2 - A_1}{\\Delta} = \\frac{-5/8 - (-3/8)}{1/2} = \\frac{-2/8}{1/2} = -\\frac{1}{4} \\times 2 = -\\frac{1}{2}$.\n$d_2^{-} = d_1^{+} = -1/2$.\n$d_2^{+} = \\frac{A_3 - A_2}{\\Delta} = \\frac{-1/8 - (-5/8)}{1/2} = \\frac{4/8}{1/2} = \\frac{1}{2} \\times 2 = 1$.\n$d_3^{-} = d_2^{+} = 1$.\n$d_3^{+} = \\frac{A_4 - A_3}{\\Delta} = \\frac{9/8 - (-1/8)}{1/2} = \\frac{10/8}{1/2} = \\frac{5}{4} \\times 2 = \\frac{5}{2}$.\n$d_4^{-} = d_3^{+} = 5/2$.\n\nFinally, we apply the minmod function to find the limited slopes $s_k$.\n$s_1 = \\operatorname{minmod}(s_1^{\\mathrm{raw}}, d_1^{+}) = \\operatorname{minmod}(-\\frac{5}{4}, -\\frac{1}{2})$. The signs are the same, so $s_1 = \\operatorname{sign}(-\\frac{5}{4}) \\min(|\\!-\\frac{5}{4}|, |\\!-\\frac{1}{2}|) = -\\min(\\frac{5}{4}, \\frac{1}{2}) = -\\frac{1}{2}$.\n$s_2 = \\operatorname{minmod}(s_2^{\\mathrm{raw}}, d_2^{-}, d_2^{+}) = \\operatorname{minmod}(\\frac{1}{4}, -\\frac{1}{2}, 1)$. The signs differ, so $s_2 = 0$.\n$s_3 = \\operatorname{minmod}(s_3^{\\mathrm{raw}}, d_3^{-}, d_3^{+}) = \\operatorname{minmod}(\\frac{7}{4}, 1, \\frac{5}{2})$. The signs are the same, so $s_3 = \\min(\\frac{7}{4}, 1, \\frac{5}{2}) = 1$.\n$s_4 = \\operatorname{minmod}(s_4^{\\mathrm{raw}}, d_4^{-}) = \\operatorname{minmod}(\\frac{13}{4}, \\frac{5}{2})$. The signs are the same, so $s_4 = \\min(\\frac{13}{4}, \\frac{5}{2}) = \\min(3.25, 2.5) = \\frac{5}{2}$.\nThe limited slopes are: $s_1 = -1/2$, $s_2 = 0$, $s_3 = 1$, $s_4 = 5/2$.\n\n**Step 3: Construct the piecewise linear surrogate $\\tilde{u}(\\xi)$**\n\nOn each subcell $J_k$, the surrogate is $\\tilde{u}(\\xi)|_{J_k} = A_k + s_k(\\xi - c_k)$.\n$J_1: \\tilde{u}(\\xi) = -\\frac{3}{8} + (-\\frac{1}{2})(\\xi - (-\\frac{3}{4})) = -\\frac{3}{8} - \\frac{1}{2}\\xi - \\frac{3}{8} = -\\frac{1}{2}\\xi - \\frac{3}{4}$.\n$J_2: \\tilde{u}(\\xi) = -\\frac{5}{8} + 0(\\xi - (-\\frac{1}{4})) = -\\frac{5}{8}$.\n$J_3: \\tilde{u}(\\xi) = -\\frac{1}{8} + 1(\\xi - \\frac{1}{4}) = \\xi - \\frac{1}{8} - \\frac{1}{4} = \\xi - \\frac{3}{8}$.\n$J_4: \\tilde{u}(\\xi) = \\frac{9}{8} + \\frac{5}{2}(\\xi - \\frac{3}{4}) = \\frac{9}{8} + \\frac{5}{2}\\xi - \\frac{15}{8} = \\frac{5}{2}\\xi - \\frac{3}{4}$.\n\n**Step 4: Reconstruct the limited DG polynomial $\\hat{u}(\\xi)$**\n\nWe project $\\tilde{u}(\\xi)$ onto the Legendre basis $\\{P_0, P_1, P_2\\}$. The coefficients are $\\hat{\\alpha}_n = \\frac{2n+1}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) P_n(\\xi) d\\xi$.\n\nFor $\\hat{\\alpha}_0$:\n$\\hat{\\alpha}_0 = \\frac{1}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) d\\xi$. The integral of $\\tilde{u}$ is the sum of the average values times the subcell volumes: $\\int_{-1}^1 \\tilde{u} d\\xi = \\sum_{k=1}^4 |J_k| A_k = \\frac{1}{2} \\sum A_k = \\frac{1}{2}(-\\frac{3}{8} - \\frac{5}{8} - \\frac{1}{8} + \\frac{9}{8}) = 0$. So, $\\hat{\\alpha}_0=0$.\n\nFor $\\hat{\\alpha}_1$:\n$\\hat{\\alpha}_1 = \\frac{3}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) P_1(\\xi) d\\xi = \\frac{3}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) \\xi d\\xi$.\nThe integral is $\\int_{-1}^{-1/2} (-\\frac{1}{2}\\xi^2 - \\frac{3}{4}\\xi) d\\xi + \\int_{-1/2}^{0} (-\\frac{5}{8}\\xi) d\\xi + \\int_{0}^{1/2} (\\xi^2 - \\frac{3}{8}\\xi) d\\xi + \\int_{1/2}^{1} (\\frac{5}{2}\\xi^2 - \\frac{3}{4}\\xi) d\\xi$.\nThese evaluate to $\\frac{13}{96}$, $\\frac{5}{64}$, $-\\frac{1}{192}$, and $\\frac{43}{96}$ respectively.\nSumming them: $\\frac{13}{96} + \\frac{5}{64} - \\frac{1}{192} + \\frac{43}{96} = \\frac{26+15-1+86}{192} = \\frac{126}{192} = \\frac{21}{32}$.\nSo, $\\hat{\\alpha}_1 = \\frac{3}{2} \\times \\frac{21}{32} = \\frac{63}{64}$.\n\nFor $\\hat{\\alpha}_2$:\n$\\hat{\\alpha}_2 = \\frac{5}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) P_2(\\xi) d\\xi = \\frac{5}{2} \\int_{-1}^{1} \\tilde{u}(\\xi) \\frac{3\\xi^2-1}{2} d\\xi = \\frac{5}{4} \\left( 3\\int_{-1}^{1} \\tilde{u}(\\xi)\\xi^2 d\\xi - \\int_{-1}^{1} \\tilde{u}(\\xi)d\\xi \\right)$.\nSince $\\int \\tilde{u} d\\xi=0$, we only need $\\int_{-1}^{1} \\tilde{u}(\\xi)\\xi^2 d\\xi$.\nThe integral is $\\int_{-1}^{-1/2} (-\\frac{1}{2}\\xi^3 - \\frac{3}{4}\\xi^2) d\\xi + \\int_{-1/2}^{0} (-\\frac{5}{8}\\xi^2) d\\xi + \\int_{0}^{1/2} (\\xi^3 - \\frac{3}{8}\\xi^2) d\\xi + \\int_{1/2}^{1} (\\frac{5}{2}\\xi^3 - \\frac{3}{4}\\xi^2) d\\xi$.\nThese evaluate to $-\\frac{13}{128}$, $-\\frac{5}{192}$, $0$, and $\\frac{47}{128}$ respectively.\nSumming them: $-\\frac{13}{128} - \\frac{5}{192} + 0 + \\frac{47}{128} = \\frac{34}{128} - \\frac{5}{192} = \\frac{17}{64} - \\frac{5}{192} = \\frac{51-5}{192} = \\frac{46}{192} = \\frac{23}{96}$.\nThe full integral for $\\alpha_2$ is $\\int_{-1}^1 \\tilde{u} P_2 d\\xi = \\frac{3}{2}\\left(\\frac{23}{96}\\right) - \\frac{1}{2}(0) = \\frac{23}{64}$. This is incorrect. It should be $\\int \\tilde{u} P_2 = \\int \\tilde{u} \\frac{3\\xi^2-1}{2} = \\frac{3}{2}\\int\\tilde{u}\\xi^2 - \\frac{1}{2}\\int\\tilde{u} = \\frac{3}{2}(\\frac{23}{96}) - 0 = \\frac{23}{64}$. The calculation was correct, just the explanation had a typo.\nSo, $\\hat{\\alpha}_2 = \\frac{5}{2} \\times \\frac{23}{64} = \\frac{115}{128}$.\n\nThe limited polynomial is $\\hat{u}(\\xi) = \\hat{\\alpha}_0 P_0(\\xi) + \\hat{\\alpha}_1 P_1(\\xi) + \\hat{\\alpha}_2 P_2(\\xi)$:\n$$\n\\hat{u}(\\xi) = 0 \\cdot (1) + \\frac{63}{64} \\xi + \\frac{115}{128} \\left(\\frac{3\\xi^2-1}{2}\\right)\n$$\n$$\n\\hat{u}(\\xi) = \\frac{63}{64}\\xi + \\frac{345}{256}\\xi^2 - \\frac{115}{256}\n$$\nArranging in standard polynomial form:\n$$\n\\hat{u}(\\xi) = \\frac{345}{256}\\xi^2 + \\frac{63}{64}\\xi - \\frac{115}{256}\n$$", "answer": "$$\n\\boxed{\\frac{345}{256}\\xi^2 + \\frac{63}{64}\\xi - \\frac{115}{256}}\n$$", "id": "3443832"}]}