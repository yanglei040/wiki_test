{"hands_on_practices": [{"introduction": "To truly understand how the Streamline Upwind Petrov-Galerkin (SUPG) method works, it is essential to see its effect at the algebraic level. This foundational exercise guides you through the derivation of the SUPG stiffness matrix for a simple one-dimensional problem. By deriving the three-point stencil, you will explicitly identify how the stabilization term modifies the standard Galerkin formulation, revealing its role as a form of 'artificial diffusion' that counteracts numerical oscillations [@problem_id:3448963].", "problem": "Consider the one-dimensional, steady advection-diffusion boundary value problem on the open interval $(0,L)$ with constant coefficients, given by the partial differential equation\n$$\n-\\mu\\,\\frac{d^{2}u}{dx^{2}} + a\\,\\frac{du}{dx} = f(x),\n$$\nwhere $a>0$ is the constant advection speed, $\\mu \\ge 0$ is the (possibly small) diffusion coefficient, and $f$ is a sufficiently smooth source. Discretize the domain by a uniform mesh with spacing $h>0$, and approximate $u$ by the standard conforming finite element method using continuous, piecewise-linear Lagrange basis functions (linear $P_1$ elements). Adopt the Streamline Upwind/Petrov-Galerkin (SUPG) stabilization, which replaces the standard test function $w$ by the Petrov-Galerkin test function $w + \\tau\\,a\\,\\frac{dw}{dx}$ with a constant stabilization parameter $\\tau \\ge 0$ on each element. Assume $a$, $\\mu$, and $\\tau$ are constant, and use the unintegrated-by-parts form of the weak advection term.\n\nStarting from the weak formulation and the definition of the SUPG test function, derive the element-level bilinear form and assemble the contributions to obtain the algebraic stiffness matrix row associated with an interior node $i$. Work directly on physical elements $[x_{i-1},x_i]$ and $[x_i,x_{i+1}]$ using the local nodal shape functions $N_1$ (left) and $N_2$ (right) and their derivatives. Compute all element integrals exactly for linear $P_1$ basis functions. Then assemble the contributions from the two adjacent elements to obtain the three-point stencil for the interior row $i$, i.e., the coefficients multiplying the unknowns at nodes $i-1$, $i$, and $i+1$.\n\nReport the final interior-node three-point stencil coefficients of the SUPG stiffness matrix row in terms of $a$, $\\mu$, $h$, and $\\tau$, ordered as $\\{i-1,i,i+1\\}$, as a single $1\\times 3$ row matrix. In addition, identify the modification to the convection stencil compared to the central-differencing stencil that arises from the standard Galerkin discretization. The final answer must be an analytical expression with no units.", "solution": "The user wants to derive the three-point stencil for the Streamline Upwind/Petrov-Galerkin (SUPG) method applied to a 1D advection-diffusion problem.\n\n### Step 1: Extract Givens\n-   **Governing Equation:** The one-dimensional, steady advection-diffusion equation is given by\n    $$-\\mu\\,\\frac{d^{2}u}{dx^{2}} + a\\,\\frac{du}{dx} = f(x) \\quad \\text{for } x \\in (0,L)$$\n-   **Coefficients:** $a > 0$ is the constant advection speed, and $\\mu \\ge 0$ is the constant diffusion coefficient.\n-   **Discretization:** The domain is discretized by a uniform mesh with spacing $h > 0$.\n-   **Finite Element Approximation:** Continuous, piecewise-linear Lagrange basis functions ($P_1$ elements) are used for the trial function space $V_h$.\n-   **Stabilization Method:** The Streamline Upwind/Petrov-Galerkin (SUPG) method is employed.\n-   **Test Function:** The standard Galerkin test function $w$ is replaced by the Petrov-Galerkin test function $w_{supg} = w + \\tau\\,a\\,\\frac{dw}{dx}$, where $\\tau \\ge 0$ is a constant stabilization parameter.\n-   **Weak Formulation:** The problem specifies using the unintegrated-by-parts form of the weak advection term.\n-   **Objective:**\n    1.  Derive the three-point stencil for an interior node $i$, representing the coefficients of the unknowns at nodes $i-1$, $i$, and $i+1$.\n    2.  Identify the modification to the convection stencil compared to the central-differencing stencil from the standard Galerkin method.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is a standard exercise in the numerical analysis of partial differential equations. The advection-diffusion equation, the finite element method, and SUPG stabilization are fundamental, well-established concepts in computational science and engineering.\n-   **Well-Posed:** The problem provides all necessary information to uniquely derive the algebraic stencil. The formulation is clear and leads to a single, deterministic answer.\n-   **Objective:** The problem is stated using precise mathematical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem statement is confirmed to be **valid**. It is self-contained, scientifically sound, and well-posed. The solution process may proceed.\n\n### Derivation of the SUPG Weak Formulation\n\nThe standard Galerkin weak form for the governing equation is obtained by multiplying by a test function $w \\in V_h$, integrating over the domain $\\Omega = (0,L)$, and integrating the second-order diffusion term by parts. This yields:\nFind $u_h \\in V_h$ such that for all $w_h \\in V_h$,\n$$\n\\int_0^L \\mu \\frac{du_h}{dx} \\frac{dw_h}{dx} dx + \\int_0^L a \\frac{du_h}{dx} w_h dx = \\int_0^L f w_h dx\n$$\nHere, we have used the \"unintegrated-by-parts form of the weak advection term,\" as requested.\n\nThe SUPG method adds a stabilization term to the Galerkin formulation. This term is derived by adding the integral of the element-wise residual of the strong DE, $R(u_h) = -\\mu u_h'' + a u_h' - f$, weighted by the \"perturbation\" of the test function, $\\delta_{w_h} = \\tau a w_h'$. The integral is taken over the union of element interiors.\n$$\n\\sum_{K} \\int_K R(u_h) (\\tau a w_h') dx = \\sum_{K} \\int_K (-\\mu u_h'' + a u_h' - f) (\\tau a w_h') dx\n$$\nSince $u_h$ is composed of piecewise-linear functions, its second derivative $u_h''$ is zero within each element $K$. The stabilization term simplifies to:\n$$\n\\sum_{K} \\int_K (a u_h' - f) (\\tau a w_h') dx = \\sum_{K} \\int_K \\tau a^2 u_h' w_h' dx - \\sum_{K} \\int_K \\tau a f w_h' dx\n$$\nAdding this to the Galerkin form and moving all terms involving $f$ to the right-hand side, we obtain the full SUPG weak formulation:\nFind $u_h \\in V_h$ such that for all $w_h \\in V_h$,\n$$\n\\int_0^L \\mu u_h' w_h' dx + \\int_0^L a u_h' w_h dx + \\sum_{K} \\int_K \\tau a^2 u_h' w_h' dx = \\int_0^L f w_h dx + \\sum_{K} \\int_K \\tau a f w_h' dx\n$$\nThe left-hand side defines the bilinear form $B_{SUPG}(u_h, w_h)$, from which the stiffness matrix is derived:\n$$\nB_{SUPG}(u_h, w_h) = \\int_0^L (\\mu + \\tau a^2) \\frac{du_h}{dx} \\frac{dw_h}{dx} dx + \\int_0^L a \\frac{du_h}{dx} w_h dx\n$$\nNote that the integral over $\\Omega$ can be split into a sum of integrals over the elements $K$. Since $\\tau$ and $a$ are constant, the term $\\sum_K \\int_K$ is equivalent to $\\int_0^L$.\n\n### Element-Level Calculation\n\nWe consider a generic element $K_e = [x_j, x_{j+1}]$ of uniform length $h$. The trial function $u_h$ and test function $w_h$ are represented using local linear shape functions $N_1$ and $N_2$. On a reference element $\\hat{K}=[0,1]$ with coordinate $\\xi$, the shape functions are $\\hat{N}_1(\\xi) = 1-\\xi$ and $\\hat{N}_2(\\xi) = \\xi$. The derivatives on the physical element are constant: $\\frac{dN_1}{dx} = -\\frac{1}{h}$ and $\\frac{dN_2}{dx} = \\frac{1}{h}$.\n\nThe element stiffness matrix $k^e$ has components $k^e_{mn} = B_{SUPG}(N_n, N_m)$ evaluated over the element $K_e$, where $m$ is the row index (test function) and $n$ is the column index (trial function).\n\nThe bilinear form consists of two parts: a symmetric diffusion-like part and a non-symmetric advection part.\n1.  **Diffusion and Stabilization Part:**\n    $k^e_{D,mn} = \\int_{K_e} (\\mu + \\tau a^2) \\frac{dN_n}{dx} \\frac{dN_m}{dx} dx$.\n    Since the derivatives are constant, the matrix is:\n    $$\n    k^e_D = \\frac{\\mu + \\tau a^2}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n    $$\n2.  **Advection Part:**\n    $k^e_{A,mn} = \\int_{K_e} a \\frac{dN_n}{dx} N_m dx$.\n    The components are calculated as:\n    $k^e_{A,11} = \\int_{K_e} a(-\\frac{1}{h})N_1 dx = -\\frac{a}{h}\\int_{K_e}N_1 dx = -\\frac{a}{h}(\\frac{h}{2}) = -\\frac{a}{2}$.\n    $k^e_{A,12} = \\int_{K_e} a(+\\frac{1}{h})N_1 dx = +\\frac{a}{h}\\int_{K_e}N_1 dx = +\\frac{a}{h}(\\frac{h}{2}) = +\\frac{a}{2}$.\n    $k^e_{A,21} = \\int_{K_e} a(-\\frac{1}{h})N_2 dx = -\\frac{a}{h}\\int_{K_e}N_2 dx = -\\frac{a}{h}(\\frac{h}{2}) = -\\frac{a}{2}$.\n    $k^e_{A,22} = \\int_{K_e} a(+\\frac{1}{h})N_2 dx = +\\frac{a}{h}\\int_{K_e}N_2 dx = +\\frac{a}{h}(\\frac{h}{2}) = +\\frac{a}{2}$.\n    The element advection matrix is:\n    $$\n    k^e_A = \\frac{a}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix}\n    $$\nThe total element stiffness matrix is $k^e = k^e_D + k^e_A$:\n$$\nk^e = \\begin{pmatrix} \\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2} & -\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2} \\\\ -\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2} & \\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2} \\end{pmatrix}\n$$\n\n### Assembly of the Interior Node Stencil\n\nWe assemble the coefficients for the global stiffness matrix row corresponding to an interior node $i$. This row is constructed from contributions from the two adjacent elements: $K_{left} = [x_{i-1}, x_i]$ and $K_{right} = [x_i, x_{i+1}]$. The test function is the global basis function $N_i$.\n\n-   **Coefficient for $u_{i-1}$ ($K_{i,i-1}$):** This interaction occurs over $K_{left}$. The trial function is $N_{i-1}$ (local $N_1$) and the test function is $N_i$ (local $N_2$). The contribution is $k^e_{21}$.\n    $$K_{i,i-1} = k^e_{21} = -\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}$$\n-   **Coefficient for $u_{i+1}$ ($K_{i,i+1}$):** This interaction occurs over $K_{right}$. The trial function is $N_{i+1}$ (local $N_2$) and the test function is $N_i$ (local $N_1$). The contribution is $k^e_{12}$.\n    $$K_{i,i+1} = k^e_{12} = -\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2}$$\n-   **Coefficient for $u_i$ ($K_{i,i}$):** This receives two contributions.\n    -   From $K_{left}$: Trial is $N_i$ (local $N_2$), Test is $N_i$ (local $N_2$). Contribution is $k^e_{22}$.\n    -   From $K_{right}$: Trial is $N_i$ (local $N_1$), Test is $N_i$ (local $N_1$). Contribution is $k^e_{11}$.\n    $$K_{i,i} = k^e_{22} + k^e_{11} = \\left(\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2}\\right) + \\left(\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}\\right) = \\frac{2(\\mu+\\tau a^2)}{h}$$\n\nThe three-point stencil for the interior row $i$, ordered as coefficients for $\\{u_{i-1}, u_i, u_{i+1}\\}$, is:\n$$\n\\left\\{ -\\frac{\\mu+\\tau a^2}{h} - \\frac{a}{2}, \\quad \\frac{2(\\mu+\\tau a^2)}{h}, \\quad -\\frac{\\mu+\\tau a^2}{h} + \\frac{a}{2} \\right\\}\n$$\n\n### Identification of the Stencil Modification\n\nThe problem asks to identify the modification to the central-differencing convection stencil that arises from the standard Galerkin method. As derived, the standard Galerkin method ($\\tau=0$) for the convection term $a u'$ yields the stencil $\\frac{a}{2}\\{-1, 0, 1\\}$. This corresponds to the equation terms $-\\frac{a}{2}u_{i-1} + \\frac{a}{2}u_{i+1} = a \\frac{u_{i+1}-u_{i-1}}{2}$. This form, when divided by $h$, is precisely the second-order central difference approximation for $a u'$, scaled by $h$.\n\nThe question's phrasing \"modification ... compared to the central-differencing stencil that arises from the standard Galerkin discretization\" is slightly convoluted. A more direct interpretation is to identify the term added by SUPG to the Galerkin scheme.\n-   **Galerkin Stencil ($\\tau=0$):** This combines the standard central difference stencils for diffusion and advection.\n    -   Diffusion: $\\frac{\\mu}{h}\\{-1, 2, -1\\}$ (symmetric)\n    -   Advection: $\\frac{a}{2}\\{-1, 0, 1\\}$ (anti-symmetric, central difference)\n-   **SUPG Modification ($\\tau>0$):** SUPG introduces an additional term from the bilinear form $\\int \\tau a^2 u'w' dx$. The stencil for this term is:\n    $$\n    \\frac{\\tau a^2}{h}\\{-1, 2, -1\\}\n    $$\nThis modification is a symmetric, second-order stencil identical in form to the physical diffusion stencil. It is commonly referred to as an **artificial diffusion** or **streamline diffusion** term. Its purpose is to add numerical dissipation to the scheme, which stabilizes the spurious oscillations characteristic of the central-difference (Galerkin) scheme in convection-dominated flows. By choosing an appropriate value for $\\tau$ (e.g., $\\tau = \\frac{h}{2a}$ for pure advection), this term effectively shifts the scheme from a central-difference type towards a first-order upwind type, ensuring stability.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -\\frac{\\mu}{h} - \\frac{\\tau a^2}{h} - \\frac{a}{2} & \\frac{2\\mu}{h} + \\frac{2\\tau a^2}{h} & -\\frac{\\mu}{h} - \\frac{\\tau a^2}{h} + \\frac{a}{2} \\end{pmatrix}\n}\n$$", "id": "3448963"}, {"introduction": "Moving from a theoretical formulation to a working finite element code requires careful attention to numerical integration. The SUPG method introduces a new integral term, and a key practical question is how to evaluate it accurately and efficiently. This practice problem has you analyze the mathematical structure of the SUPG stabilization term to determine the minimal polynomial degree it represents, thereby establishing the required quadrature rule for its exact integration [@problem_id:2602085].", "problem": "Consider the steady advection–diffusion–reaction model problem on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\in \\{1,2,3\\}$:\n$$\n- \\nabla \\cdot \\left( \\kappa \\nabla u \\right) + \\boldsymbol{\\beta} \\cdot \\nabla u + \\sigma u = f \\quad \\text{in } \\Omega,\n$$\nwith appropriate boundary conditions ensuring well-posedness. Assume the diffusion coefficient $\\kappa > 0$, the advection velocity $\\boldsymbol{\\beta} \\in \\mathbb{R}^{d}$, the reaction coefficient $\\sigma \\ge 0$, and the source $f$ are all constant over $\\Omega$.\n\nLet $\\mathcal{T}_{h}$ be a conforming simplicial mesh of $\\Omega$ such that the mapping to each element $K \\in \\mathcal{T}_{h}$ is affine. Let $V_{h}$ be the standard continuous piecewise linear ($\\mathbb{P}_{1}$) finite element space on $\\mathcal{T}_{h}$. Denote by $u_{h} \\in V_{h}$ the discrete trial function and by $w_{h} \\in V_{h}$ the test function. Consider the streamline upwind/Petrov–Galerkin (SUPG) stabilization term\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\tau_{K} \\left( \\boldsymbol{\\beta} \\cdot \\nabla w_{h} \\right) \\, r_{h} \\, \\mathrm{d}x,\n$$\nwhere $\\tau_{K} > 0$ is a stabilization parameter that is constant on each element $K$, and $r_{h}$ is the strong residual of the discrete solution on $K$ given by\n$$\nr_{h} := - \\nabla \\cdot \\left( \\kappa \\nabla u_{h} \\right) + \\boldsymbol{\\beta} \\cdot \\nabla u_{h} + \\sigma u_{h} - f.\n$$\n\nAssume exact numerical integration is desired for the SUPG stabilization term on each element $K$ using a single quadrature rule per element that is exact for all polynomials on $K$ up to total degree $m$. Determine the minimal polynomial exactness order $m$ such that, for arbitrary $u_{h}, w_{h} \\in V_{h}$, the SUPG stabilization integral on each $K$ is evaluated exactly. Give your answer as a single integer. No rounding is required, and no units are needed.", "solution": "The problem is to determine the minimal polynomial exactness order $m$ required for a quadrature rule to exactly evaluate the streamline upwind/Petrov–Galerkin (SUPG) stabilization term on each element $K$ of a mesh $\\mathcal{T}_h$. The problem is well-posed and contains sufficient information for a rigorous analysis.\n\nThe SUPG stabilization term is given by the sum over all elements $K \\in \\mathcal{T}_{h}$ of the integral:\n$$\n\\int_{K} \\tau_{K} \\left( \\boldsymbol{\\beta} \\cdot \\nabla w_{h} \\right) \\, r_{h} \\, \\mathrm{d}x\n$$\nTo determine the required exactness for a quadrature rule, we must first establish the polynomial degree of the integrand on an arbitrary element $K$. The integrand is the product of three terms: the stabilization parameter $\\tau_{K}$, the modified test function term $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}$, and the discrete residual $r_{h}$.\n\nLet $\\mathbb{P}_{p}(K)$ denote the space of polynomials on an element $K$ of total degree at most $p$.\n\nFirst, we analyze the term $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}$.\nThe test function $w_{h}$ belongs to the space $V_{h}$ of continuous piecewise linear functions. Therefore, on any element $K$, the restriction $w_{h}|_{K}$ is a linear polynomial, i.e., $w_{h}|_{K} \\in \\mathbb{P}_{1}(K)$.\nThe gradient of a linear polynomial is a constant vector. Thus, $\\nabla w_{h}|_{K}$ is a vector of constants, which can be viewed as polynomials of degree $0$. So, $\\nabla w_{h}|_{K} \\in [\\mathbb{P}_{0}(K)]^{d}$.\nThe advection velocity $\\boldsymbol{\\beta}$ is given as a constant vector.\nThe dot product of a constant vector $\\boldsymbol{\\beta}$ and a constant vector field $\\nabla w_{h}|_{K}$ results in a scalar constant. Therefore, the expression $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K}$ is a polynomial of degree $0$, i.e., $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K} \\in \\mathbb{P}_{0}(K)$.\n\nNext, we analyze the discrete residual $r_{h}$ on the element $K$. The residual is defined as:\n$$\nr_{h}|_{K} = - \\nabla \\cdot \\left( \\kappa \\nabla u_{h} \\right)|_{K} + \\left( \\boldsymbol{\\beta} \\cdot \\nabla u_{h} \\right)|_{K} + \\left( \\sigma u_{h} \\right)|_{K} - f\n$$\nWe examine each term in this expression:\n1.  The trial function $u_{h}$ is also from the space $V_{h}$, so $u_{h}|_{K} \\in \\mathbb{P}_{1}(K)$.\n2.  The diffusion coefficient $\\kappa$ is a constant. The gradient $\\nabla u_{h}|_{K}$ is a constant vector field (polynomials of degree $0$). The product $\\kappa \\nabla u_{h}|_{K}$ is therefore also a constant vector field. The divergence of a constant vector field is zero. Hence, $-\\nabla \\cdot ( \\kappa \\nabla u_{h} )|_{K} = 0$. The zero function is a polynomial of degree $0$ (or, more strictly, $-\\infty$, which is contained in $\\mathbb{P}_{0}(K)$).\n3.  As established previously for $w_{h}$, the term $\\boldsymbol{\\beta} \\cdot \\nabla u_{h}|_{K}$ is a constant, so it belongs to $\\mathbb{P}_{0}(K)$.\n4.  The reaction coefficient $\\sigma$ is a non-negative constant. The product of this constant with the linear polynomial $u_{h}|_{K}$ results in a polynomial of degree at most $1$. If $\\sigma > 0$ and $u_{h}$ is not constant on $K$, this term is exactly degree $1$. Thus, $\\sigma u_{h}|_{K} \\in \\mathbb{P}_{1}(K)$.\n5.  The source term $f$ is given as a constant, so $f \\in \\mathbb{P}_{0}(K)$.\n\nThe residual $r_{h}|_{K}$ is the sum of functions from $\\mathbb{P}_{0}(K)$, $\\mathbb{P}_{0}(K)$, $\\mathbb{P}_{1}(K)$, and $\\mathbb{P}_{0}(K)$. The sum of polynomials has a degree equal to the maximum of the degrees of the individual polynomials. Therefore, the residual $r_{h}|_{K}$ is a polynomial of degree at most $1$, i.e., $r_{h}|_{K} \\in \\mathbb{P}_{1}(K)$.\n\nFinally, we determine the polynomial degree of the entire integrand on element $K$:\n$$\n\\text{Integrand} = \\tau_{K} \\left( \\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K} \\right) \\, r_{h}|_{K}\n$$\nThe problem states that $\\tau_{K}$ is a constant on each element, so $\\tau_{K} \\in \\mathbb{P}_{0}(K)$. We have found that $\\boldsymbol{\\beta} \\cdot \\nabla w_{h}|_{K} \\in \\mathbb{P}_{0}(K)$ and $r_{h}|_{K} \\in \\mathbb{P}_{1}(K)$.\nThe integrand is a product of a polynomial of degree $0$, another polynomial of degree $0$, and a polynomial of degree at most $1$. The degree of the product is the sum of the degrees of the factors, which is $0 + 0 + 1 = 1$.\nThe integrand is therefore a polynomial of total degree at most $1$.\n\nA quadrature rule is said to have a polynomial exactness order of $m$ if it can integrate any polynomial of total degree up to $m$ exactly. To guarantee the exact evaluation of the SUPG stabilization term for arbitrary $u_{h}, w_{h} \\in V_{h}$, the quadrature rule must be able to integrate the integrand, a polynomial of degree $1$, exactly. This requires the exactness order $m$ to be at least $1$. The minimal integer value for $m$ is therefore $1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "2602085"}, {"introduction": "The power of SUPG lies in its application to multi-dimensional, advection-dominated flows on complex geometries, where the stabilization parameter $\\tau$ must adapt to both the flow and local mesh characteristics. This exercise generalizes the concept of stabilization from one dimension to two by introducing the vital idea of a directional element length, $h_{\\boldsymbol{t}}$. This quantity measures the element size along the streamline and is key to defining a robust and effective $\\tau$ for a triangular element [@problem_id:2602150].", "problem": "Consider the steady, dimensionless advection–diffusion–reaction boundary value problem in two spatial dimensions,\n$$-\\,\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{in a polygonal domain},$$\nwith constant coefficients. Focus on a single affine, linear triangular finite element with vertices at\n$$\\boldsymbol{x}_1=(0,0),\\quad \\boldsymbol{x}_2=(0.04,0),\\quad \\boldsymbol{x}_3=(0,0.03),$$\nand associated linear Lagrange nodal shape functions $N_i$ that satisfy the partition of unity and linear completeness. Let the advection velocity be $\\boldsymbol{\\beta}=(10,0.5)$, the diffusivity be $\\epsilon=10^{-4}$, and the reaction coefficient be $\\sigma=0$.\n\n(a) Starting only from (i) the one-dimensional identity for a linear two-node element that the sum of the absolute values of the shape function derivatives equals $2/h$ (where $h$ is the element length), and (ii) the affine mapping and directional derivative concept for a triangle, derive a formula for the directional element length $h_{\\boldsymbol{t}}$ in the streamline direction $\\boldsymbol{t}=\\boldsymbol{\\beta}/\\|\\boldsymbol{\\beta}\\|$ expressed in terms of the constant gradients $\\nabla N_i$ and $\\boldsymbol{t}$. Then evaluate $h_{\\boldsymbol{t}}$ for the given triangle and $\\boldsymbol{\\beta}$.\n\n(b) Using the one-dimensional constant-coefficient analysis that yields the optimal Streamline Upwind/Petrov–Galerkin (SUPG) stabilization parameter along the streamline direction, derive the expression of the stabilization parameter $\\tau$ in terms of $h_{\\boldsymbol{t}}$, $\\|\\boldsymbol{\\beta}\\|$, $\\epsilon$, and the element Péclet number. Then evaluate $\\tau$ for the given data.\n\nProvide your final numerical values for $h_{\\boldsymbol{t}}$ and $\\tau$. Round both to six significant figures. Express your final answer as the ordered pair $(h_{\\boldsymbol{t}},\\ \\tau)$ with no units.", "solution": "The problem statement is validated and found to be well-posed, scientifically grounded, and self-contained. It presents a standard, albeit non-trivial, exercise in the finite element analysis of advection-dominated problems. We proceed with the solution.\n\nThe problem is partitioned into two parts. We address each in sequence.\n\n(a) Derivation and evaluation of the directional element length $h_{\\boldsymbol{t}}$.\n\nFor a linear triangular element, the Lagrange nodal shape functions $N_i(\\boldsymbol{x})$ are linear functions of the spatial coordinates $\\boldsymbol{x}=(x,y)$. Consequently, their gradients, $\\nabla N_i$, are constant vectors over the element. These gradients are determined by the element geometry. Given the vertices $\\boldsymbol{x}_1=(0,0)$, $\\boldsymbol{x}_2=(0.04,0)$, and $\\boldsymbol{x}_3=(0,0.03)$, the area of the triangle is $A = \\frac{1}{2}(0.04)(0.03) = 0.0006$. The gradients are computed as:\n$$\n\\nabla N_i = \\frac{1}{2A} \\begin{pmatrix} y_j - y_k \\\\ x_k - x_j \\end{pmatrix}\n$$\nwhere $(i,j,k)$ is a cyclic permutation of $(1,2,3)$. For the given vertices:\n$$\n\\nabla N_1 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0.03 \\\\ 0 - 0.04 \\end{pmatrix} = \\begin{pmatrix} -25 \\\\ -100/3 \\end{pmatrix}\n$$\n$$\n\\nabla N_2 = \\frac{1}{0.0012} \\begin{pmatrix} 0.03 - 0 \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 25 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla N_3 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0 \\\\ 0.04 - 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 100/3 \\end{pmatrix}\n$$\nThe condition of linear completeness, $\\sum_{i=1}^3 \\nabla N_i = \\boldsymbol{0}$, is satisfied.\n\nThe problem instructs to start from the one-dimensional identity for a linear two-node element of length $h$, which is $\\sum_{i=1}^2 |N_i'| = \\frac{2}{h}$. This identity can be rearranged to define the element length as $h = 2 / (\\sum_{i=1}^2 |N_i'|)$.\n\nWe generalize this concept to multiple dimensions. The role of the derivative $N_i'$ along the single spatial coordinate is replaced by the directional derivative of $N_i$ along a specified streamline direction, given by the unit vector $\\boldsymbol{t}$. The directional derivative is $\\nabla N_i \\cdot \\boldsymbol{t}$. The sum is taken over all nodes of the element, in this case $i=1, 2, 3$. This yields the definition for the directional element length $h_{\\boldsymbol{t}}$:\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}|}\n$$\nThe streamline direction is aligned with the advection velocity $\\boldsymbol{\\beta}=(10, 0.5)$. The unit vector is $\\boldsymbol{t} = \\boldsymbol{\\beta} / \\|\\boldsymbol{\\beta}\\|$.\nFirst, we compute the dot products $\\nabla N_i \\cdot \\boldsymbol{\\beta}$:\n$$\n\\nabla N_1 \\cdot \\boldsymbol{\\beta} = (-25)(10) + (-\\frac{100}{3})(0.5) = -250 - \\frac{50}{3} = -\\frac{800}{3}\n$$\n$$\n\\nabla N_2 \\cdot \\boldsymbol{\\beta} = (25)(10) + (0)(0.5) = 250\n$$\n$$\n\\nabla N_3 \\cdot \\boldsymbol{\\beta} = (0)(10) + (\\frac{100}{3})(0.5) = \\frac{50}{3}\n$$\nThe sum of their absolute values is:\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = |-\\frac{800}{3}| + |250| + |\\frac{50}{3}| = \\frac{800}{3} + \\frac{750}{3} + \\frac{50}{3} = \\frac{1600}{3}\n$$\nThe magnitude of the advection velocity is $\\|\\boldsymbol{\\beta}\\| = \\sqrt{10^2 + 0.5^2} = \\sqrt{100.25}$.\nWe can now write the sum of the absolute values of the directional derivatives:\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}| = \\sum_{i=1}^3 \\left|\\nabla N_i \\cdot \\frac{\\boldsymbol{\\beta}}{\\|\\boldsymbol{\\beta}\\|}\\right| = \\frac{1}{\\|\\boldsymbol{\\beta}\\|} \\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = \\frac{1600/3}{\\sqrt{100.25}}\n$$\nSubstituting this into the formula for $h_{\\boldsymbol{t}}$:\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\frac{1600/3}{\\sqrt{100.25}}} = \\frac{6 \\sqrt{100.25}}{1600} = \\frac{3 \\sqrt{100.25}}{800}\n$$\nNumerically evaluating this expression, we find:\n$$\nh_{\\boldsymbol{t}} \\approx \\frac{3 \\times 10.0124922}{800} \\approx 0.03754684575\n$$\nRounding to six significant figures, $h_{\\boldsymbol{t}} = 0.0375468$.\n\n(b) Derivation and evaluation of the SUPG stabilization parameter $\\tau$.\n\nThe optimal SUPG stabilization parameter for the one-dimensional, constant-coefficient advection-diffusion equation on a linear element of length $h$ is given by:\n$$\n\\tau_{\\text{1D}} = \\frac{h}{2\\beta} \\left( \\coth(Pe_{\\text{1D}}) - \\frac{1}{Pe_{\\text{1D}}} \\right)\n$$\nwhere the one-dimensional Péclet number is $Pe_{\\text{1D}} = \\frac{\\beta h}{2\\epsilon}$.\n\nTo derive the expression for the multidimensional case, we generalize this formula by consistently replacing the one-dimensional quantities with their multidimensional counterparts. The element length $h$ is replaced by the directional element length $h_{\\boldsymbol{t}}$ along the streamline. The scalar velocity $\\beta$ is replaced by its magnitude $\\|\\boldsymbol{\\beta}\\|$. This yields the expression for the stabilization parameter $\\tau$ as:\n$$\n\\tau = \\frac{h_{\\boldsymbol{t}}}{2\\|\\boldsymbol{\\beta}\\|} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\nwhere the element Péclet number is now defined as:\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon}\n$$\nThis constitutes the required derivation. We now evaluate this for the given data. First, we compute the element Péclet number $Pe$:\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon} = \\frac{\\sqrt{100.25}}{2 \\times 10^{-4}} \\left( \\frac{3 \\sqrt{100.25}}{800} \\right) = \\frac{3 (100.25)}{1600 \\times 10^{-4}} = \\frac{300.75}{0.16} = 1879.6875\n$$\nThe value of the Péclet number is very large, signifying a strongly advection-dominated regime. For large arguments $x$, the hyperbolic cotangent function $\\coth(x)$ rapidly approaches $1$. For $Pe = 1879.6875$, the value of $\\coth(Pe)$ is computationally indistinguishable from $1$. Therefore, we can use the high-Péclet number asymptotic form.\nSubstituting the expressions for $h_{\\boldsymbol{t}}$ and $Pe$ into the formula for $\\tau$:\n$$\n\\tau = \\frac{1}{2\\|\\boldsymbol{\\beta}\\|} \\left(\\frac{3 \\|\\boldsymbol{\\beta}\\|}{800}\\right) \\left( \\coth(Pe) - \\frac{1}{Pe} \\right) = \\frac{3}{1600} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\nUsing the value of $Pe$ and the approximation $\\coth(Pe) \\approx 1$:\n$$\n\\tau \\approx \\frac{3}{1600} \\left( 1 - \\frac{1}{1879.6875} \\right)\n$$\n$$\n\\tau \\approx 0.001875 \\left( 1 - 0.0005320053... \\right) \\approx 0.001875 \\times 0.99946799... \\approx 0.00187400249\n$$\nRounding to six significant figures, $\\tau = 0.00187400$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.0375468 & 0.00187400 \\end{pmatrix}}$$", "id": "2602150"}]}