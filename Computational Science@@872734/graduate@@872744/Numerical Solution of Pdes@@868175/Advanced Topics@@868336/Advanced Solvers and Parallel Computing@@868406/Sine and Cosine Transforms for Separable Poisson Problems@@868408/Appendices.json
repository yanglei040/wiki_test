{"hands_on_practices": [{"introduction": "The remarkable efficiency of fast spectral methods stems from identifying a basis that diagonalizes the discrete differential operator. For the ubiquitous second-difference operator arising from Poisson's equation with homogeneous Dirichlet boundary conditions, this special basis is composed of discrete sine functions. This exercise guides you through the fundamental derivation of the operator's eigenvalues from first principles, revealing precisely why the Discrete Sine Transform (DST) is the key to an efficient solution. [@problem_id:3443413]", "problem": "Consider the uniform partition of the interval $[0,1]$ into $n+2$ points $x_j=jh$ with $j=0,1,\\dots,n+1$ and $h=1/(n+1)$. Impose homogeneous Dirichlet boundary conditions $u_0=0$ and $u_{n+1}=0$, and consider the discrete negative Laplacian (second-difference) operator acting on interior unknowns $\\mathbf{u}=(u_1,\\dots,u_n)^{\\top}$ by\n$$(A\\mathbf{u})_j=\\frac{-u_{j-1}+2u_j-u_{j+1}}{h^2},\\quad j=1,\\dots,n,$$\nwith the boundary values $u_0$ and $u_{n+1}$ fixed at zero. Starting from the definition of eigenvalues and eigenvectors for a linear operator, and using only foundational facts such as linearity, trigonometric identities, and the characterization of separable modes that satisfy homogeneous Dirichlet conditions, determine the closed-form expression for the eigenvalues $\\lambda_k$ of $A$ indexed by $k\\in\\{1,2,\\dots,n\\}$. Relate your reasoning to the role of the Discrete Sine Transform (DST) in diagonalizing $A$, but do not assume any pre-tabulated transform pairs.\n\nProvide your final answer as a single analytic expression for $\\lambda_k$ in terms of $h$, $n$, and $k$. No numerical approximation is required, and no units are involved.", "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Domain partition: The interval $[0, 1]$ is partitioned by $n+2$ points $x_j=jh$ for $j=0, 1, \\dots, n+1$.\n- Step size: $h=1/(n+1)$.\n- Boundary conditions: Homogeneous Dirichlet conditions $u_0=0$ and $u_{n+1}=0$.\n- Unknowns: The vector of interior values $\\mathbf{u}=(u_1, u_2, \\dots, u_n)^{\\top}$.\n- Operator: The discrete negative Laplacian (second-difference) operator $A$ is defined by its action on $\\mathbf{u}$ as\n$$(A\\mathbf{u})_j = \\frac{-u_{j-1} + 2u_j - u_{j+1}}{h^2}, \\quad \\text{for } j=1, 2, \\dots, n.$$\n- Task: Determine the closed-form expression for the eigenvalues $\\lambda_k$ of $A$ for $k \\in \\{1, 2, \\dots, n\\}$.\n- Methodological constraints: The derivation must start from the definition of eigenvalues and eigenvectors, using only foundational principles. The result should be related to the Discrete Sine Transform (DST) without assuming its properties.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a fundamental topic in numerical analysis, specifically in the finite difference method for solving partial differential equations. The discrete Laplacian is a standard, well-studied mathematical object. The problem is scientifically sound.\n- **Well-Posed**: The problem asks for the eigenvalues of a specific $n \\times n$ matrix. An $n \\times n$ matrix always has a set of $n$ eigenvalues (counting multiplicity), so a solution exists and is unique. The problem is well-posed.\n- **Objective**: The problem is stated in precise, formal mathematical language, with no subjectivity or ambiguity.\n\nThe problem statement is self-contained, consistent, and adheres to established scientific and mathematical principles. It does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe eigenvalues $\\lambda$ and corresponding eigenvectors $\\mathbf{v} \\neq \\mathbf{0}$ of a linear operator $A$ are defined by the equation $A\\mathbf{v} = \\lambda\\mathbf{v}$. For the given discrete negative Laplacian operator $A$, this equation can be written component-wise for an eigenvector $\\mathbf{v} = (v_1, v_2, \\dots, v_n)^{\\top}$ as:\n$$ (A\\mathbf{v})_j = \\frac{-v_{j-1} + 2v_j - v_{j+1}}{h^2} = \\lambda v_j, \\quad \\text{for } j=1, 2, \\dots, n. $$\nThe definition of the operator uses the boundary values $v_0$ and $v_{n+1}$, which, like the original variable $u$, must satisfy the homogeneous Dirichlet conditions $v_0 = 0$ and $v_{n+1} = 0$.\n\nThe problem prompts us to consider separable modes satisfying these boundary conditions. The continuous analogue is the Sturm-Liouville problem $-u''(x) = \\lambda u(x)$ on $[0,1]$ with $u(0)=u(1)=0$, whose eigenfunctions are of the form $\\sin(k\\pi x)$. This motivates proposing a discrete analogue for the components of the eigenvector $\\mathbf{v}$:\n$$ v_j = C \\sin(\\alpha x_j) = C \\sin(\\alpha j h) $$\nfor some constants $C$ and $\\alpha$. We can set $C=1$ since eigenvectors are defined up to a scalar multiple.\n\nWe must first ensure this form satisfies the boundary conditions:\n1.  For $j=0$: $v_0 = \\sin(\\alpha \\cdot 0 \\cdot h) = \\sin(0) = 0$. This condition is automatically satisfied.\n2.  For $j=n+1$: $v_{n+1} = \\sin(\\alpha(n+1)h) = 0$. Given $h=1/(n+1)$, this becomes $\\sin(\\alpha(n+1)\\frac{1}{n+1}) = \\sin(\\alpha) = 0$.\n\nThe condition $\\sin(\\alpha)=0$ implies that $\\alpha$ must be an integer multiple of $\\pi$. Let $\\alpha = k\\pi$ for some integer $k$. The proposed eigenvector components are therefore:\n$$ v_j^{(k)} = \\sin(k\\pi j h) $$\nWe need to find $n$ linearly independent eigenvectors. Let's examine the choice of the integer $k$:\n- If $k=0$, $v_j^{(0)} = \\sin(0) = 0$ for all $j$, which is the trivial zero vector and not an eigenvector.\n- For $k \\in \\{1, 2, \\dots, n\\}$, the vectors $\\mathbf{v}^{(k)}$ are non-trivial and are known to be linearly independent.\n- If $k=n+1$, $v_j^{(n+1)} = \\sin((n+1)\\pi j h) = \\sin(\\pi j (n+1)/(n+1)) = \\sin(j\\pi) = 0$ for all integer $j$. This again is the zero vector.\n- For other integer values of $k$, the vectors become redundant (e.g., $\\mathbf{v}^{(k)} = -\\mathbf{v}^{(-k)}$ and $\\mathbf{v}^{(k)} = (-1)^{m} \\mathbf{v}^{(k+m(n+1))}$).\n\nThus, we can generate all $n$ distinct eigenvectors by choosing $k=1, 2, \\dots, n$. Let us now substitute the $k$-th eigenvector form, $v_j = \\sin(k\\pi jh)$, into the eigenvalue equation. Let $\\lambda_k$ be the eigenvalue corresponding to the eigenvector $\\mathbf{v}^{(k)}$.\n$$ \\frac{-\\sin(k\\pi(j-1)h) + 2\\sin(k\\pi jh) - \\sin(k\\pi(j+1)h)}{h^2} = \\lambda_k \\sin(k\\pi jh) $$\nLet's focus on the numerator. Using the sum-to-product identity $\\sin(A-B) + \\sin(A+B) = 2\\sin(A)\\cos(B)$, we can simplify the term $\\sin(k\\pi(j-1)h) + \\sin(k\\pi(j+1)h)$. Let $A = k\\pi jh$ and $B = k\\pi h$.\n$$ \\sin(k\\pi jh - k\\pi h) + \\sin(k\\pi jh + k\\pi h) = 2\\sin(k\\pi jh)\\cos(k\\pi h) $$\nThe numerator of the left-hand side of the eigenvalue equation becomes:\n$$ 2\\sin(k\\pi jh) - \\big( \\sin(k\\pi(j-1)h) + \\sin(k\\pi(j+1)h) \\big) = 2\\sin(k\\pi jh) - 2\\sin(k\\pi jh)\\cos(k\\pi h) $$\n$$ = 2\\sin(k\\pi jh) \\big( 1 - \\cos(k\\pi h) \\big) $$\nSubstituting this back into the eigenvalue equation:\n$$ \\frac{2\\sin(k\\pi jh) (1 - \\cos(k\\pi h))}{h^2} = \\lambda_k \\sin(k\\pi jh) $$\nSince $\\mathbf{v}^{(k)}$ is a non-zero vector, we can find a $j$ for which $\\sin(k\\pi jh) \\neq 0$. Thus, we can divide both sides by $\\sin(k\\pi jh)$ to solve for the eigenvalue $\\lambda_k$:\n$$ \\lambda_k = \\frac{2(1 - \\cos(k\\pi h))}{h^2} $$\nTo obtain a more common form, we use the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$. With $\\theta = k\\pi h$, this gives:\n$$ \\lambda_k = \\frac{2(2\\sin^2(k\\pi h/2))}{h^2} = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi h}{2}\\right) $$\nThe problem asks for the expression in terms of $h$, $n$, and $k$. We can use the definition $h=1/(n+1)$ to write the argument of the sine function in terms of $n$.\n$$ \\lambda_k = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right) $$\nThis expression is valid for each $k = 1, 2, \\dots, n$.\n\nFinally, we relate this result to the Discrete Sine Transform (DST). The components of the $k$-th eigenvector are $v_j^{(k)} = \\sin(k \\pi j h) = \\sin\\left(\\frac{k j \\pi}{n+1}\\right)$. The matrix $S$ whose $(j,k)$-th entry is proportional to this value, i.e., $S_{jk} = \\sqrt{\\frac{2}{n+1}}\\sin\\left(\\frac{kj\\pi}{n+1}\\right)$, is the matrix of the DST (specifically, DST-I). The columns of this matrix $S$ are the orthonormalized eigenvectors of the discrete Laplacian matrix $A$. The existence of such an eigenbasis implies that the matrix $A$ is diagonalized by the DST matrix $S$. That is, $S^{-1}AS = \\Lambda$ or $S^{\\top}AS = \\Lambda$, where $\\Lambda$ is a diagonal matrix whose entries are the eigenvalues $\\lambda_k$. This is the fundamental reason why transform-based methods are exceptionally efficient for solving linear systems involving the discrete Laplacian on uniform grids. The transform decouples the system of equations into $n$ independent scalar equations in the transformed domain, which can be solved trivially.", "answer": "$$\n\\boxed{\\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right)}\n$$", "id": "3443413"}, {"introduction": "With the theoretical foundation in place, we can construct a powerful, practical tool. The principle of separability allows us to extend our one-dimensional understanding to solve two-dimensional problems with incredible efficiency, avoiding the need to construct and solve large, sparse linear systems directly. This practice problem moves from theory to code, tasking you with implementing a two-dimensional fast Poisson solver by applying one-dimensional transforms sequentially, a core technique in computational science. [@problem_id:3443478]", "problem": "Consider the separable Poisson problem on a rectangle with homogeneous Dirichlet boundary conditions: find $u(x,y)$ such that\n$$ -\\frac{\\partial^2 u}{\\partial x^2}(x,y) - \\frac{\\partial^2 u}{\\partial y^2}(x,y) = f(x,y), \\quad (x,y) \\in (0,L_x)\\times(0,L_y), $$\nwith $u(x,y)=0$ on the boundary of the rectangle. Discretize the interior of the domain using a uniform tensor-product grid with $N_x$ and $N_y$ interior points in the $x$ and $y$ directions, respectively, and grid spacings $h_x = \\frac{L_x}{N_x+1}$ and $h_y = \\frac{L_y}{N_y+1}$. Let $u_{j,i} \\approx u(x_i,y_j)$ denote the grid function at interior nodes $x_i = i h_x$ for $i=1,\\dots,N_x$ and $y_j = j h_y$ for $j=1,\\dots,N_y$. Using centered second-order finite differences, the discrete Laplacian $\\Delta_h$ acting on an interior grid function $u$ is\n$$(\\Delta_h u)_{j,i} = \\frac{u_{j,i-1} - 2 u_{j,i} + u_{j,i+1}}{h_x^2} + \\frac{u_{j-1,i} - 2 u_{j,i} + u_{j+1,i}}{h_y^2},$$\nwith the convention that values outside the interior index range are set to zero to enforce the homogeneous Dirichlet boundary conditions. The discrete problem is: find the interior grid function $u$ such that\n$$ -\\Delta_h u = f_h, $$\nwhere $f_h$ is a sampling of $f$ on the interior grid.\n\nIt is a well-tested fact that the one-dimensional discrete operator corresponding to the second derivative with homogeneous Dirichlet boundary conditions is diagonalized by the Discrete Sine Transform (DST) of type $\\mathrm{I}$, with eigenvalues\n$$\\lambda^{(x)}_k = \\frac{4}{h_x^2} \\sin^2\\!\\left(\\frac{k\\pi}{2(N_x+1)}\\right), \\quad k=1,\\dots,N_x,$$\nand similarly in the $y$-direction with\n$$\\lambda^{(y)}_\\ell = \\frac{4}{h_y^2} \\sin^2\\!\\left(\\frac{\\ell\\pi}{2(N_y+1)}\\right), \\quad \\ell=1,\\dots,N_y.$$\nBy separability, the two-dimensional operator $-\\Delta_h$ is diagonalized by applying the one-dimensional transform along rows and columns.\n\nYour task is to implement a two-dimensional solver for $-\\Delta_h u = f_h$ based on one-dimensional transforms that are applied separately along rows and columns. You must:\n- Derive, from the above definitions and facts, how to diagonalize the two-dimensional operator using the Discrete Sine Transform (DST) of type $\\mathrm{I}$ with orthonormal normalization, and hence obtain the spectral formula to compute the transformed solution coefficients.\n- Implement the two-dimensional transform application by performing one-dimensional transforms along the last axis only, then permuting axes to bring the other spatial dimension to the last position, and repeating. This is to preserve contiguous memory access (cache efficiency) for each transform call. You may use the Discrete Sine Transform (DST) and the Discrete Cosine Transform (DCT) from a standard scientific library with explicit type and normalization parameters, but you must not use any direct two-dimensional transform routine.\n- Implement a function that computes the discrete Laplacian $\\Delta_h$ on the interior with homogeneous Dirichlet boundary conditions by zero-padding the boundary as described above. Use this to generate right-hand sides $f_h$ from known (sampled) exact interior solutions $u$ so that the numerical solverâ€™s output can be compared to the exact discrete solution.\n- In addition to the Poisson solver based on sine transforms, implement analogous two-pass helpers for two-dimensional Discrete Cosine Transform (DCT) of a given type and normalization, again by transforming along the last axis with a permutation step between passes.\n\nAngles must be in radians. No physical units are present. All numerical answers must be reported as floating-point numbers or booleans, as specified below.\n\nTest Suite:\nImplement your program to evaluate the following five test cases and produce outputs as specified.\n\n$1$. Homogeneous Dirichlet, rectangular grid (happy path):\n- Parameters: $N_x=32$, $N_y=20$, $L_x=1$, $L_y=1$, exact interior solution $u(x,y) = \\sin(3\\pi x/L_x)\\sin(5\\pi y/L_y)$.\n- Construct $u_{j,i}$ by sampling $u$ at interior nodes, compute $f_h = -\\Delta_h u$, solve $-\\Delta_h \\tilde{u} = f_h$, and return the relative discrete $\\ell^2$ error\n$$ \\frac{\\| \\tilde{u} - u \\|_2}{\\|u\\|_2}, $$\nwhere the norm is the Euclidean norm over the interior grid values.\n\n$2$. Homogeneous Dirichlet, rectangular domain with unequal side lengths:\n- Parameters: $N_x=29$, $N_y=37$, $L_x=2.0$, $L_y=0.5$, exact interior solution $u(x,y) = \\sin(2\\pi x/L_x)\\sin(9\\pi y/L_y)$.\n- Return the relative discrete $\\ell^2$ error, defined as in case $1$.\n\n$3$. Homogeneous Dirichlet, edge case with $N_x=1$:\n- Parameters: $N_x=1$, $N_y=17$, $L_x=1.0$, $L_y=1.0$, exact interior solution $u(x,y) = \\sin(\\pi x/L_x)\\sin(7\\pi y/L_y)$.\n- Return the relative discrete $\\ell^2$ error, defined as in case $1$.\n\n$4$. Two-pass transform equivalence for DST:\n- Generate a fixed random array $A \\in \\mathbb{R}^{23\\times 17}$ using a fixed seed. Compute the two-dimensional DST-$\\mathrm{I}$ with orthonormal normalization in two ways:\n  (a) by applying the one-dimensional transform along the last axis, swapping axes, and transforming along the last axis again; and\n  (b) by transforming directly along axis $1$ and then along axis $0$ without swaps.\n- Return a boolean that is $true$ if the maximum absolute difference between the two results is less than or equal to $10^{-10}$, and $false$ otherwise.\n\n$5$. Two-pass transform equivalence for DCT:\n- Generate a fixed random array $B \\in \\mathbb{R}^{16\\times 10}$ using the same fixed seed as in case $4$. Compute the two-dimensional DCT-$\\mathrm{II}$ with orthonormal normalization using the same two approaches as in case $4$.\n- Return a boolean that is $true$ if the maximum absolute difference between the two results is less than or equal to $10^{-10}$, and $false$ otherwise.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ through $5$, for example, in the format\n$[r_1,r_2,r_3,b_4,b_5]$,\nwhere $r_1$, $r_2$, and $r_3$ are floating-point numbers and $b_4$, $b_5$ are booleans represented as $True$ or $False$.", "solution": "The user-provided problem has been analyzed and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. I will now proceed with a complete solution.\n\n### Derivation of the Spectral Poisson Solver\n\nThe problem is to solve the discrete Poisson equation $-\\Delta_h u = f_h$ on a rectangular grid with homogeneous Dirichlet boundary conditions. Let the grid function $u$ be represented by an $N_y \\times N_x$ matrix $U = [u_{j,i}]$, where $j \\in \\{1, \\dots, N_y\\}$ is the row index and $i \\in \\{1, \\dots, N_x\\}$ is the column index. The right-hand side $f_h$ is similarly represented by a matrix $F = [f_{j,i}]$.\n\nThe discrete Laplacian operator $\\Delta_h$ is separable, meaning it can be expressed as the sum of one-dimensional operators acting along each coordinate direction:\n$$ \\Delta_h = D_{xx} + D_{yy} $$\nwhere $(D_{xx} U)_{j,i} = \\frac{u_{j,i-1} - 2u_{j,i} + u_{j,i+1}}{h_x^2}$ acts on the rows of $U$, and $(D_{yy} U)_{j,i} = \\frac{u_{j-1,i} - 2u_{j,i} + u_{j+1,i}}{h_y^2}$ acts on the columns.\n\nLet $A_x$ be the $N_x \\times N_x$ matrix representing the one-dimensional finite difference operator for the second derivative in the $x$-direction, and $A_y$ be the corresponding $N_y \\times N_y$ matrix for the $y$-direction. These are symmetric tridiagonal matrices:\n$$ A_x = \\frac{1}{h_x^2} \\begin{pmatrix} -2  1   \\\\ 1  -2  1  \\\\  \\ddots  \\ddots  \\ddots \\\\   1  -2 \\end{pmatrix}_{N_x \\times N_x} $$\nand similarly for $A_y$. The action of $D_{xx}$ corresponds to right-multiplication by $A_x$, and the action of $D_{yy}$ corresponds to left-multiplication by $A_y$. The discrete Poisson equation in matrix form is:\n$$ -(A_y U + U A_x) = F $$\n\nThe problem states that the one-dimensional operators are diagonalized by the Discrete Sine Transform of type I (DST-I). Let $S_x$ and $S_y$ be the orthonormal DST-I transform matrices of size $N_x \\times N_x$ and $N_y \\times N_y$, respectively. Their elements are given by $(S_x)_{k,i} = \\sqrt{\\frac{2}{N_x+1}} \\sin\\left(\\frac{ki\\pi}{N_x+1}\\right)$ for $k,i=1,\\dots,N_x$, and similarly for $S_y$. These matrices are symmetric ($S_x^T = S_x$) and orthogonal ($S_x S_x = I_x$, where $I_x$ is the $N_x \\times N_x$ identity matrix).\n\nThe operators $-A_x$ and $-A_y$ are diagonalized by $S_x$ and $S_y$:\n$$ -A_x = S_x \\Lambda_x S_x \\quad \\text{and} \\quad -A_y = S_y \\Lambda_y S_y $$\nwhere $\\Lambda_x$ and $\\Lambda_y$ are diagonal matrices containing the eigenvalues provided in the problem statement:\n$$ (\\Lambda_x)_{k,k} = \\lambda_k^{(x)} = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{k\\pi}{2(N_x+1)}\\right), \\quad k=1,\\dots,N_x $$\n$$ (\\Lambda_y)_{\\ell,\\ell} = \\lambda_\\ell^{(y)} = \\frac{4}{h_y^2} \\sin^2\\left(\\frac{\\ell\\pi}{2(N_y+1)}\\right), \\quad \\ell=1,\\dots,N_y $$\n\nTo solve the matrix equation, we apply the 2D DST-I to it. Let $\\hat{U} = S_y U S_x$ be the transformed solution and $\\hat{F} = S_y F S_x$ be the transformed right-hand side. We pre-multiply the equation by $S_y$ and post-multiply by $S_x$:\n$$ S_y ((-A_y U) + (U (-A_x))) S_x = S_y F S_x $$\n$$ (S_y (-A_y)) U S_x + S_y U ((-A_x) S_x) = \\hat{F} $$\nSubstituting the diagonalizations:\n$$ (S_y (S_y \\Lambda_y S_y)) U S_x + S_y U ((S_x \\Lambda_x S_x) S_x) = \\hat{F} $$\nUsing the orthogonality property ($S_y S_y = I_y$, $S_x S_x = I_x$):\n$$ (I_y \\Lambda_y S_y) U S_x + S_y U (S_x \\Lambda_x I_x) = \\hat{F} $$\n$$ \\Lambda_y (S_y U S_x) + (S_y U S_x) \\Lambda_x = \\hat{F} $$\nThis yields the equation in the spectral domain:\n$$ \\Lambda_y \\hat{U} + \\hat{U} \\Lambda_x = \\hat{F} $$\nSince $\\Lambda_x$ and $\\Lambda_y$ are diagonal, this is an element-wise algebraic equation for the coefficients $\\hat{U}_{\\ell,k}$ of the transformed matrix $\\hat{U}$:\n$$ \\lambda_\\ell^{(y)} \\hat{U}_{\\ell,k} + \\hat{U}_{\\ell,k} \\lambda_k^{(x)} = \\hat{F}_{\\ell,k} $$\n$$ (\\lambda_\\ell^{(y)} + \\lambda_k^{(x)}) \\hat{U}_{\\ell,k} = \\hat{F}_{\\ell,k} $$\nThe solution for the transformed coefficients is thus:\n$$ \\hat{U}_{\\ell,k} = \\frac{\\hat{F}_{\\ell,k}}{\\lambda_\\ell^{(y)} + \\lambda_k^{(x)}} $$\n\n### Algorithmic Implementation\n\nThe solution process consists of the following steps:\n1.  Given the right-hand side grid function $F$, compute its 2D DST-I, $\\hat{F} = S_y F S_x$.\n2.  Construct a matrix of the eigenvalues of the 2D operator, $(\\Lambda_{2D})_{\\ell,k} = \\lambda_\\ell^{(y)} + \\lambda_k^{(x)}$.\n3.  Compute the transformed solution coefficients $\\hat{U}$ by element-wise division: $\\hat{U} = \\hat{F} ./ \\Lambda_{2D}$.\n4.  Compute the final solution $U$ by applying the inverse 2D DST-I to $\\hat{U}$, which for the orthonormal DST-I is the transform itself: $U = S_y \\hat{U} S_x$.\n\nThe 2D transforms are implemented as two passes of 1D transforms. As required, a permutation-based approach is used for cache efficiency. For an $N_y \\times N_x$ array `data`, the 2D transform is computed by:\n1.  Applying a 1D transform along the last axis (`axis=-1`).\n2.  Transposing the resulting matrix (`data.T`).\n3.  Applying the 1D transform again along the new last axis.\n4.  Transposing the result back.\n\nThis procedure will be implemented in helper functions `dst1_2d_permute` for the DST-I and `dct2_2d_permute` for the DCT-II.\n\nFor test cases $1$-$3$, the right-hand side $f_h$ is generated from a known exact solution $u$ using $f_h = -\\Delta_h u$. The discrete Laplacian $\\Delta_h$ is implemented by first padding the $N_y \\times N_x$ interior grid function $u$ with a layer of zeros to create an $(N_y+2) \\times (N_x+2)$ array, representing the homogeneous Dirichlet boundary conditions. The centered finite difference formula is then applied to this padded array to compute the Laplacian on the interior grid.\n\nFor test cases $4$ and $5$, the equivalence of the permutation-based 2D transform and a direct application of 1D transforms along `axis=1` then `axis=0` is checked to validate the implementation of the two-pass helpers.\n\nThe final numerical solution $\\tilde{u}$ is compared against the known exact discrete solution $u$ by computing the relative discrete $\\ell^2$ error: $\\frac{\\| \\tilde{u} - u \\|_2}{\\|u\\|_2}$. For the chosen exact solutions, which are eigenfunctions of the discrete operator, this error is expected to be near machine precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import fft\n\ndef discrete_laplacian(u, hx, hy):\n    \"\"\"\n    Computes the discrete Laplacian of an interior grid function u\n    with homogeneous Dirichlet boundary conditions.\n    \n    Args:\n        u (np.ndarray): A 2D numpy array of shape (Ny, Nx) representing the grid function.\n        hx (float): Grid spacing in the x-direction.\n        hy (float): Grid spacing in the y-direction.\n        \n    Returns:\n        np.ndarray: A 2D numpy array of shape (Ny, Nx) representing the discrete Laplacian of u.\n    \"\"\"\n    Ny, Nx = u.shape\n    u_padded = np.zeros((Ny + 2, Nx + 2))\n    u_padded[1:-1, 1:-1] = u\n    \n    lap_u = (u_padded[1:-1, 0:-2] - 2 * u_padded[1:-1, 1:-1] + u_padded[1:-1, 2:]) / (hx**2)\n    lap_u += (u_padded[0:-2, 1:-1] - 2 * u_padded[1:-1, 1:-1] + u_padded[2:, 1:-1]) / (hy**2)\n    \n    return lap_u\n\ndef dst1_2d_permute(data):\n    \"\"\"Computes 2D DST-I using 1D transforms on last axis with permutation.\"\"\"\n    temp = fft.dst(data, type=1, axis=-1, norm='ortho')\n    temp = fft.dst(temp.T, type=1, axis=-1, norm='ortho')\n    return temp.T\n\ndef dct2_2d_permute(data):\n    \"\"\"Computes 2D DCT-II using 1D transforms on last axis with permutation.\"\"\"\n    temp = fft.dct(data, type=2, axis=-1, norm='ortho')\n    temp = fft.dct(temp.T, type=2, axis=-1, norm='ortho')\n    return temp.T\n\ndef poisson_solve_dst(f_h, Lx, Ly):\n    \"\"\"\n    Solves the discrete Poisson equation -Delta_h u = f_h using the DST.\n    \n    Args:\n        f_h (np.ndarray): A 2D array of shape (Ny, Nx) for the right-hand side.\n        Lx (float): Length of the domain in x-direction.\n        Ly (float): Length of the domain in y-direction.\n        \n    Returns:\n        np.ndarray: The solution grid function u of shape (Ny, Nx).\n    \"\"\"\n    Ny, Nx = f_h.shape\n    hx = Lx / (Nx + 1)\n    hy = Ly / (Ny + 1)\n    \n    f_hat = dst1_2d_permute(f_h)\n    \n    k = np.arange(1, Nx + 1).reshape(1, -1)\n    l = np.arange(1, Ny + 1).reshape(-1, 1)\n\n    lambda_x = (4 / hx**2) * np.sin(k * np.pi / (2 * (Nx + 1)))**2\n    lambda_y = (4 / hy**2) * np.sin(l * np.pi / (2 * (Ny + 1)))**2\n    \n    lambda_2d = lambda_y + lambda_x\n    \n    u_hat = f_hat / lambda_2d\n    \n    u_solution = dst1_2d_permute(u_hat)\n    \n    return u_solution\n\ndef run_poisson_test(params):\n    \"\"\"Runs a single Poisson solver test case.\"\"\"\n    Nx, Ny, Lx, Ly, m, n = params\n    \n    hx = Lx / (Nx + 1)\n    hy = Ly / (Ny + 1)\n    \n    # Handle the 1D case for meshgrid\n    if Nx == 1:\n        x = np.array([hx])\n    else:\n        x = np.arange(1, Nx + 1) * hx\n    \n    if Ny == 1:\n        y = np.array([hy])\n    else:\n        y = np.arange(1, Ny + 1) * hy\n        \n    xx, yy = np.meshgrid(x, y)\n    \n    u_exact = np.sin(m * np.pi * xx / Lx) * np.sin(n * np.pi * yy / Ly)\n\n    f_h = -discrete_laplacian(u_exact, hx, hy)\n    \n    u_tilde = poisson_solve_dst(f_h, Lx, Ly)\n    \n    norm_diff = np.linalg.norm(u_tilde - u_exact)\n    norm_exact = np.linalg.norm(u_exact)\n    \n    if norm_exact == 0:\n        return 0.0 if norm_diff == 0 else np.inf\n        \n    return norm_diff / norm_exact\n\ndef test_dst_equivalence():\n    \"\"\"Tests equivalence of two methods for 2D DST-I.\"\"\"\n    np.random.seed(42)\n    A = np.random.rand(23, 17)\n    \n    res_permute = dst1_2d_permute(A)\n    \n    temp_direct = fft.dst(A, type=1, axis=1, norm='ortho')\n    res_direct = fft.dst(temp_direct, type=1, axis=0, norm='ortho')\n    \n    max_diff = np.max(np.abs(res_permute - res_direct))\n    return max_diff = 1e-10\n\ndef test_dct_equivalence():\n    \"\"\"Tests equivalence of two methods for 2D DCT-II.\"\"\"\n    np.random.seed(42)\n    B = np.random.rand(16, 10)\n    \n    res_permute = dct2_2d_permute(B)\n    \n    temp_direct = fft.dct(B, type=2, axis=1, norm='ortho')\n    res_direct = fft.dct(temp_direct, type=2, axis=0, norm='ortho')\n    \n    max_diff = np.max(np.abs(res_permute - res_direct))\n    return max_diff = 1e-10\n\ndef solve():\n    \"\"\"Main function to run all test cases and print results.\"\"\"\n    test_cases = [\n        # Poisson solver tests: (Nx, Ny, Lx, Ly, m, n)\n        (32, 20, 1.0, 1.0, 3, 5),\n        (29, 37, 2.0, 0.5, 2, 9),\n        (1, 17, 1.0, 1.0, 1, 7),\n    ]\n\n    results = []\n    \n    # Cases 1, 2, 3\n    for case_params in test_cases:\n        error = run_poisson_test(case_params)\n        results.append(error)\n        \n    # Case 4\n    results.append(test_dst_equivalence())\n    \n    # Case 5\n    results.append(test_dct_equivalence())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3443478"}, {"introduction": "A working solver is only useful if we can understand and trust its results. Quantifying the error of a numerical method is therefore a critical skill for any computational scientist. The total error in a finite difference solution arises from multiple sources, including the approximation of the continuous operator, known as dispersion error. This advanced exercise provides a deep dive into error analysis, tasking you with calculating the exact leading-order error constant for the one-dimensional problem, which provides a concrete understanding of the method's celebrated $O(h^2)$ accuracy. [@problem_id:3443469]", "problem": "Consider the one-dimensional Poisson boundary value problem on the unit interval with homogeneous Dirichlet boundary conditions: find a function $u:[0,1]\\to\\mathbb{R}$ such that\n$$\n-u''(x)=f(x),\\quad x\\in(0,1),\\qquad u(0)=u(1)=0,\n$$\nwhere $f\\in C^{\\infty}([0,1])$. Let $N\\in\\mathbb{N}$, $h=1/N$, and $x_j=jh$ for $j=0,1,\\dots,N$. Let $u^{h}\\in\\mathbb{R}^{N-1}$ denote the discrete solution obtained by the standard second-order centered finite difference discretization combined with the Discrete Sine Transform (DST): for $j=1,\\dots,N-1$,\n$$\n\\frac{-u^{h}_{j-1}+2u^{h}_{j}-u^{h}_{j+1}}{h^{2}}=f(x_j),\\qquad u^{h}_0=u^{h}_N=0.\n$$\nYou will analyze the error $e^{h}_j=u^{h}_j-u(x_j)$ from first principles by exploiting the separation of variables induced by the sine basis.\n\nTasks:\n\n$1.$ Starting from the Sturm-Liouville eigenpairs for the continuous Dirichlet Laplacian on $(0,1)$ and the eigenpairs of the tridiagonal second-difference matrix with homogeneous Dirichlet conditions, derive the continuous and discrete sine expansions of $u$ and $u^{h}$, respectively. Use only the core definitions of the Fourier sine series and eigenvalue problems to establish that, for $k=1,\\dots,N-1$, the discrete eigenvectors $v^{(k)}$ defined by $v^{(k)}_j=\\sin(k\\pi x_j)$ diagonalize the discrete operator and have eigenvalues\n$$\n\\lambda_k^{h}=\\frac{4}{h^{2}}\\sin^{2}\\!\\Big(\\frac{k\\pi h}{2}\\Big).\n$$\n\n$2.$ Using the expansions from Task $1$, produce a mode-by-mode error representation at the grid points that cleanly separates the impact of coefficient approximation and the impact of the finite-difference dispersion (i.e., eigenvalue mismatch). Assume $f\\in C^{4}([0,1])$ so that all series and exchanges of limits you use are justified, and argue from the truncation error of the centered difference that the grid error satisfies an $O(h^{2})$ estimate.\n\n$3.$ To quantify the $O(h^{2})$ discretization error constant explicitly, specialize to the single-mode right-hand side $f(x)=\\sin(\\pi x)$. Using only the definitions and identities you have established, show that the discrete vector $s$ with entries $s_j=\\sin(\\pi x_j)$ is an eigenvector of the discrete operator. Then derive the leading-order asymptotic expansion, as $h\\to 0$, of the maximum-norm grid error\n$$\n\\max_{1\\le j\\le N-1}\\big|u^{h}_j-u(x_j)\\big| = C\\,h^{2}+O(h^{4}).\n$$\nGive the exact value of the coefficient $C$ as a single real number. No rounding is required.", "solution": "This problem requires an analysis of the finite difference error for the one-dimensional Poisson equation using eigenfunction expansions. The tasks guide us from the fundamental eigenpairs of the continuous and discrete operators to a precise asymptotic expression for the error in a specific case.\n\n### Task 1: Continuous and Discrete Sine Expansions\n\nWe begin by establishing the eigen-expansions for both the continuous problem and its discrete approximation.\n\n**Continuous Problem:**\nThe continuous problem is $-u''(x)=f(x)$ on $(0,1)$ with $u(0)=u(1)=0$. This is a Sturm-Liouville problem for the operator $L = -d^2/dx^2$ with homogeneous Dirichlet boundary conditions. The associated eigenvalue problem is\n$$\n-u''(x) = \\lambda u(x), \\qquad u(0)=u(1)=0.\n$$\nThe general solution to the differential equation is $u(x) = A\\cos(\\sqrt{\\lambda}x) + B\\sin(\\sqrt{\\lambda}x)$. The boundary condition $u(0)=0$ implies $A=0$. The condition $u(1)=0$ implies $B\\sin(\\sqrt{\\lambda})=0$. For a non-trivial solution ($B \\neq 0$), we must have $\\sin(\\sqrt{\\lambda})=0$, which means $\\sqrt{\\lambda} = k\\pi$ for any integer $k \\in \\mathbb{N} = \\{1, 2, 3, \\dots\\}$.\nThe eigenvalues are therefore $\\lambda_k = (k\\pi)^2$, and the corresponding eigenfunctions are $\\phi_k(x) = \\sin(k\\pi x)$ for $k=1, 2, \\dots$.\n\nThese eigenfunctions form a complete orthogonal basis for $L^2(0,1)$. We can expand the solution $u(x)$ and the source term $f(x)$ in this basis (i.e., as a Fourier sine series):\n$$\nu(x) = \\sum_{k=1}^{\\infty} \\hat{u}_k \\sin(k\\pi x), \\qquad f(x) = \\sum_{k=1}^{\\infty} \\hat{f}_k \\sin(k\\pi x).\n$$\nSubstituting these expansions into the differential equation $-u''(x) = f(x)$:\n$$\n-\\frac{d^2}{dx^2}\\left(\\sum_{k=1}^{\\infty} \\hat{u}_k \\sin(k\\pi x)\\right) = \\sum_{k=1}^{\\infty} \\hat{f}_k \\sin(k\\pi x)\n$$\n$$\n\\sum_{k=1}^{\\infty} \\hat{u}_k (k\\pi)^2 \\sin(k\\pi x) = \\sum_{k=1}^{\\infty} \\hat{f}_k \\sin(k\\pi x).\n$$\nBy the orthogonality of the sine functions, we can equate the coefficients for each mode $k$:\n$$\n\\hat{u}_k (k\\pi)^2 = \\hat{f}_k \\implies \\hat{u}_k = \\frac{\\hat{f}_k}{(k\\pi)^2} = \\frac{\\hat{f}_k}{\\lambda_k}.\n$$\nThus, the continuous solution has the expansion $u(x)=\\sum_{k=1}^{\\infty} \\frac{\\hat{f}_k}{\\lambda_k}\\sin(k\\pi x)$.\n\n**Discrete Problem:**\nThe finite difference equations form a linear system $A_h u^h = f^h$, where $A_h$ is the $(N-1)\\times(N-1)$ matrix given by $A_h = \\frac{1}{h^2} \\text{tridiag}(-1, 2, -1)$. We are asked to show that the vectors $v^{(k)}$ with components $v^{(k)}_j = \\sin(k\\pi x_j) = \\sin(k\\pi jh)$ for $j=1, \\dots, N-1$ are the eigenvectors of $A_h$. Let's apply $A_h$ to $v^{(k)}$ for a fixed $k \\in \\{1,\\dots,N-1\\}$. The $j$-th component of the resulting vector is:\n$$\n(A_h v^{(k)})_j = \\frac{1}{h^2} \\left( -v^{(k)}_{j-1} + 2v^{(k)}_j - v^{(k)}_{j+1} \\right)\n$$\n$$\n= \\frac{1}{h^2} \\left( -\\sin(k\\pi(j-1)h) + 2\\sin(k\\pi jh) - \\sin(k\\pi(j+1)h) \\right).\n$$\nUsing the trigonometric identity $\\sin(A-B)+\\sin(A+B)=2\\sin A \\cos B$ with $A=k\\pi jh$ and $B=k\\pi h$, we get:\n$$\n\\sin(k\\pi(j-1)h) + \\sin(k\\pi(j+1)h) = 2\\sin(k\\pi jh)\\cos(k\\pi h).\n$$\nSubstituting this into the expression for $(A_h v^{(k)})_j$:\n$$\n(A_h v^{(k)})_j = \\frac{1}{h^2} \\left( 2\\sin(k\\pi jh) - 2\\sin(k\\pi jh)\\cos(k\\pi h) \\right) = \\frac{2(1-\\cos(k\\pi h))}{h^2} \\sin(k\\pi jh).\n$$\nNow, using the half-angle identity $1-\\cos\\theta=2\\sin^2(\\theta/2)$:\n$$\n(A_h v^{(k)})_j = \\frac{2(2\\sin^2(k\\pi h/2))}{h^2} \\sin(k\\pi jh) = \\left( \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi h}{2}\\right) \\right) v^{(k)}_j.\n$$\nThis confirms that $v^{(k)}$ is an eigenvector of $A_h$ with eigenvalue $\\lambda_k^h = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi h}{2}\\right)$, as required.\n\nThe eigenvectors $\\{v^{(k)}\\}_{k=1}^{N-1}$ form an orthogonal basis for $\\mathbb{R}^{N-1}$. We can expand the discrete solution $u^h$ and the discrete source term $f^h = (f(x_1), \\dots, f(x_{N-1}))^T$:\n$$\nu^h = \\sum_{k=1}^{N-1} \\hat{u}_k^h v^{(k)}, \\qquad f^h = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)}.\n$$\nHere, $\\hat{u}_k^h$ and $\\hat{f}_k^h$ are the coefficients in this basis (i.e., the Discrete Sine Transform coefficients). Substituting into the system $A_h u^h = f^h$:\n$$\nA_h \\left(\\sum_{k=1}^{N-1} \\hat{u}_k^h v^{(k)}\\right) = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)} \\implies \\sum_{k=1}^{N-1} \\hat{u}_k^h (A_h v^{(k)}) = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)}.\n$$\n$$\n\\sum_{k=1}^{N-1} \\hat{u}_k^h \\lambda_k^h v^{(k)} = \\sum_{k=1}^{N-1} \\hat{f}_k^h v^{(k)}.\n$$\nBy linear independence, $\\hat{u}_k^h \\lambda_k^h = \\hat{f}_k^h$, so $\\hat{u}_k^h = \\frac{\\hat{f}_k^h}{\\lambda_k^h}$.\nThe discrete solution is $u^h_j = \\sum_{k=1}^{N-1} \\frac{\\hat{f}_k^h}{\\lambda_k^h}\\sin(k\\pi x_j)$.\n\n### Task 2: Error Representation and Order of Accuracy\n\nThe error at grid point $x_j$ is $e_j^h = u_j^h - u(x_j)$. Neglecting aliasing and series truncation effects for a moment, the error in the $k$-th mode can be analyzed by comparing the coefficients:\n$$\n\\hat{e}_k \\approx \\hat{u}_k^h - \\hat{u}_k = \\frac{\\hat{f}_k^h}{\\lambda_k^h} - \\frac{\\hat{f}_k}{\\lambda_k} = \\frac{\\hat{f}_k^h\\lambda_k - \\hat{f}_k\\lambda_k^h}{\\lambda_k\\lambda_k^h}.\n$$\nWe can rewrite this to separate the sources of error:\n$$\n\\frac{\\hat{f}_k^h\\lambda_k - \\hat{f}_k\\lambda_k^h}{\\lambda_k\\lambda_k^h} = \\frac{(\\hat{f}_k^h-\\hat{f}_k)\\lambda_k + \\hat{f}_k\\lambda_k - \\hat{f}_k\\lambda_k^h}{\\lambda_k\\lambda_k^h} = \\frac{\\hat{f}_k^h-\\hat{f}_k}{\\lambda_k^h} + \\hat{f}_k \\frac{\\lambda_k-\\lambda_k^h}{\\lambda_k\\lambda_k^h}.\n$$\nThis representation cleanly separates the error into two components:\n$1.$ **Coefficient Approximation Error**: The term involving $\\hat{f}_k^h - \\hat{f}_k$ arises because the discrete Fourier coefficient (found via DST, a sum) is an approximation of the continuous Fourier coefficient (an integral). This is a quadrature error.\n$2.$ **Dispersion Error**: The term involving $\\lambda_k - \\lambda_k^h$ arises because the discrete eigenvalue $\\lambda_k^h$ is an approximation of the continuous eigenvalue $\\lambda_k = (k\\pi)^2$. This discrepancy is known as dispersion.\n\nTo establish the $O(h^2)$ global error estimate, it is more direct to use the truncation error. The truncation error $\\tau_j$ is the residual obtained by substituting the exact solution $u(x)$ into the discrete operator:\n$$\n\\tau_j = \\frac{-u(x_{j-1}) + 2u(x_j) - u(x_{j+1})}{h^2} - f(x_j).\n$$\nSince $-u''(x) = f(x)$, this becomes $\\tau_j = \\frac{-u(x_{j-1}) + 2u(x_j) - u(x_{j+1})}{h^2} + u''(x_j)$.\nBy Taylor's theorem, for $u \\in C^4([0,1])$, we have:\n$$\nu(x_j \\pm h) = u(x_j) \\pm h u'(x_j) + \\frac{h^2}{2}u''(x_j) \\pm \\frac{h^3}{6}u'''(x_j) + \\frac{h^4}{24}u''''(x_j) + O(h^5).\n$$\nSumming the expansions for $u(x_j+h)$ and $u(x_j-h)$:\n$$\nu(x_{j+1}) + u(x_{j-1}) = 2u(x_j) + h^2 u''(x_j) + \\frac{h^4}{12}u''''(x_j) + O(h^6).\n$$\nRearranging gives the standard centered difference formula for the second derivative:\n$$\n\\frac{u(x_{j+1}) - 2u(x_j) + u(x_{j-1})}{h^2} = u''(x_j) + \\frac{h^2}{12}u''''(x_j) + O(h^4).\n$$\nSubstituting this into the expression for $\\tau_j$:\n$$\n\\tau_j = - \\left(u''(x_j) + \\frac{h^2}{12}u''''(x_j) + O(h^4)\\right) + u''(x_j) = -\\frac{h^2}{12}u''''(x_j) + O(h^4).\n$$\nThe error vector $e^h = (e_1^h, \\dots, e_{N-1}^h)^T$ satisfies the equation $A_h e^h = -\\tau^h$, where $\\tau^h = (\\tau_1, \\dots, \\tau_{N-1})^T$. Thus, $e^h = -A_h^{-1}\\tau^h$. Taking the maximum norm:\n$$\n\\|e^h\\|_{\\infty} \\le \\|A_h^{-1}\\|_{\\infty} \\|\\tau^h\\|_{\\infty}.\n$$\nThe operator $A_h$ is the discrete Laplacian, whose inverse is bounded by $\\|A_h^{-1}\\|_{\\infty} \\le 1/8$. Since $f \\in C^4$, then $u \\in C^6$, so $u''''$ is bounded on $[0,1]$. Let $M_4 = \\max_{x\\in[0,1]} |u''''(x)|$.\n$$\n\\|\\tau^h\\|_{\\infty} = \\max_{1\\le j \\le N-1} \\left|-\\frac{h^2}{12}u''''(x_j) + O(h^4)\\right| = \\frac{h^2}{12}M_4 + O(h^4).\n$$\nTherefore, the grid error satisfies the estimate:\n$$\n\\|e^h\\|_{\\infty} = \\max_{1\\le j\\le N-1} |e^h_j| \\le \\frac{1}{8} \\left(\\frac{h^2}{12}M_4 + O(h^4)\\right) = O(h^2).\n$$\n\n### Task 3: Error Constant for a Single Mode\n\nWe specialize to the case $f(x) = \\sin(\\pi x)$, which is the first eigenfunction of the continuous operator ($k=1$).\n\nThe exact solution $u(x)$ satisfies $-u''(x) = \\sin(\\pi x)$. We see by inspection that $u(x) = C_1 \\sin(\\pi x)$ is a candidate. Substituting gives $-C_1(-\\pi^2\\sin(\\pi x)) = \\sin(\\pi x)$, so $C_1\\pi^2=1$, which means $C_1=1/\\pi^2$. The exact solution is:\n$$\nu(x) = \\frac{1}{\\pi^2}\\sin(\\pi x).\n$$\nThe values at the grid points are $u(x_j) = \\frac{1}{\\pi^2}\\sin(\\pi x_j)$.\n\nThe discrete problem is $A_h u^h = f^h$, where the right-hand side vector has components $f_j^h = f(x_j) = \\sin(\\pi x_j)$. This vector is precisely the first discrete eigenvector, $f^h = v^{(1)}$.\nThe system is $A_h u^h = v^{(1)}$. Since $v^{(1)}$ is an eigenvector of $A_h$, the solution $u^h$ must be a multiple of $v^{(1)}$. Let $u^h = c \\cdot v^{(1)}$.\nSubstituting into the equation: $A_h(c \\cdot v^{(1)}) = c(A_h v^{(1)}) = c\\lambda_1^h v^{(1)}$.\nWe require $c\\lambda_1^h v^{(1)} = v^{(1)}$, which implies $c=1/\\lambda_1^h$. The discrete solution is therefore:\n$$\nu^h_j = \\frac{1}{\\lambda_1^h}\\sin(\\pi x_j).\n$$\nThe error at each grid point is:\n$$\ne^h_j = u^h_j - u(x_j) = \\frac{1}{\\lambda_1^h}\\sin(\\pi x_j) - \\frac{1}{\\pi^2}\\sin(\\pi x_j) = \\left(\\frac{1}{\\lambda_1^h} - \\frac{1}{\\pi^2}\\right)\\sin(\\pi x_j).\n$$\nTo find the leading-order behavior of the maximum error, we must find the asymptotic expansion of the prefactor as $h \\to 0$. We have $\\lambda_1 = \\pi^2$ and $\\lambda_1^h = \\frac{4}{h^2}\\sin^2(\\frac{\\pi h}{2})$. Let us expand $\\lambda_1^h$ for small $h$.\nUsing the Taylor series $\\sin(z) = z - \\frac{z^3}{6} + \\frac{z^5}{120} - O(z^7)$:\n$$\n\\sin^2(z) = \\left(z - \\frac{z^3}{6} + O(z^5)\\right)^2 = z^2 - \\frac{z^4}{3} + O(z^6).\n$$\nWith $z=\\frac{\\pi h}{2}$, we have:\n$$\n\\lambda_1^h = \\frac{4}{h^2} \\left( \\left(\\frac{\\pi h}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\pi h}{2}\\right)^4 + O(h^6) \\right) = \\frac{4}{h^2} \\left( \\frac{\\pi^2 h^2}{4} - \\frac{\\pi^4 h^4}{48} + O(h^6) \\right) = \\pi^2 - \\frac{\\pi^4}{12}h^2 + O(h^4).\n$$\nNow we expand the prefactor $\\frac{1}{\\lambda_1^h} - \\frac{1}{\\pi^2}$:\n$$\n\\frac{1}{\\lambda_1^h} = \\frac{1}{\\pi^2 - \\frac{\\pi^4}{12}h^2 + O(h^4)} = \\frac{1}{\\pi^2}\\left(\\frac{1}{1 - \\frac{\\pi^2}{12}h^2 + O(h^4)}\\right).\n$$\nUsing the geometric series expansion $\\frac{1}{1-y} = 1+y+y^2+\\dots$:\n$$\n\\frac{1}{\\lambda_1^h} = \\frac{1}{\\pi^2}\\left(1 + \\frac{\\pi^2}{12}h^2 + O(h^4)\\right) = \\frac{1}{\\pi^2} + \\frac{1}{12}h^2 + O(h^4).\n$$\nThe prefactor is thus:\n$$\n\\frac{1}{\\lambda_1^h} - \\frac{1}{\\pi^2} = \\left(\\frac{1}{\\pi^2} + \\frac{1}{12}h^2 + O(h^4)\\right) - \\frac{1}{\\pi^2} = \\frac{1}{12}h^2 + O(h^4).\n$$\nThe maximum-norm grid error is:\n$$\n\\max_{1\\le j\\le N-1}\\big|u^{h}_j-u(x_j)\\big| = \\max_{1\\le j\\le N-1}\\left|\\left(\\frac{1}{12}h^2 + O(h^4)\\right)\\sin(\\pi x_j)\\right|.\n$$\nAs $h \\to 0$, we have $\\max_{1\\le j\\le N-1}|\\sin(\\pi x_j)| \\to \\sin(\\pi/2) = 1$. More precisely, the maximum value is $1$ if $N$ is even, and $\\cos(\\pi h/2) = 1 - O(h^2)$ if $N$ is odd. In either case:\n$$\n\\max_{1\\le j\\le N-1}\\big|e^{h}_j\\big| = \\left(\\frac{1}{12}h^2 + O(h^4)\\right)(1 - O(h^2)) = \\frac{1}{12}h^2 + O(h^4).\n$$\nComparing this with the given form $\\max_{j}|e^h_j| = C\\,h^2 + O(h^4)$, we identify the constant $C$.\nThe exact value of the coefficient is $C=\\frac{1}{12}$.", "answer": "$$\n\\boxed{\\frac{1}{12}}\n$$", "id": "3443469"}]}