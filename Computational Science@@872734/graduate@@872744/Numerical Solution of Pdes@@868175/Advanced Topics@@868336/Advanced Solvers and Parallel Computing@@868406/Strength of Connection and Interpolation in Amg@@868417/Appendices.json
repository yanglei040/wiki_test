{"hands_on_practices": [{"introduction": "The first step in many Algebraic Multigrid (AMG) algorithms is to analyze the system matrix to determine which variables are \"strongly coupled.\" This exercise provides direct practice with the classical Ruge–Stüben definition of strength, a cornerstone of early AMG methods. By working through this simple but representative example ([@problem_id:3449289]), you will gain a concrete understanding of how the strength threshold $\\theta$ partitions matrix connections, forming the basis for the subsequent coarsening process.", "problem": "Consider the matrix $A \\in \\mathbb{R}^{5 \\times 5}$ defined by $A=\\operatorname{tridiag}(-1,2,-1)$, which is a symmetric positive definite $M$-matrix arising from a standard second-order finite difference discretization of the one-dimensional Poisson operator on a uniform grid with homogeneous Dirichlet boundary conditions. Let the strength-of-connection threshold be $\\theta=0.25$. Use the classical Ruge–Stüben definition of strength of connection for $M$-matrices: for each row $i$, an off-diagonal index $j \\neq i$ is a strong neighbor of $i$ if $a_{ij}0$ and\n$$\n- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr).\n$$\nTasks:\n1. For each row $i \\in \\{1,2,3,4,5\\}$, determine the strong neighbor set $N^{s}_{i}(\\theta)$ and justify your result directly from the entries of $A$ and the above definition.\n2. Let $G$ be the undirected strength graph obtained by placing an undirected edge $\\{i,j\\}$ if and only if $i \\in N^{s}_{j}(\\theta)$ or $j \\in N^{s}_{i}(\\theta)$. Let $B$ denote the adjacency matrix of $G$. Compute the spectral radius $\\rho(B)$ and express your final answer as an exact value (no rounding).\nYour final answer must be a single real number equal to $\\rho(B)$, with no units.", "solution": "The problem asks us to perform a two-part analysis related to the concept of strength of connection in Algebraic Multigrid (AMG) methods. First, we must determine the strong neighbor sets for a given matrix. Second, we must construct a graph based on these connections and compute the spectral radius of its adjacency matrix.\n\nThe given matrix is $A \\in \\mathbb{R}^{5 \\times 5}$, specified as $A=\\operatorname{tridiag}(-1,2,-1)$. Writing this out explicitly, we have:\n$$\nA = \\begin{pmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{pmatrix}\n$$\nThe strength-of-connection threshold is given as $\\theta=0.25$.\nThe definition of a strong neighbor $j$ for a row $i$ (where $j \\neq i$) is twofold:\n1. The off-diagonal entry $a_{ij}$ must be negative, i.e., $a_{ij}  0$.\n2. The magnitude of this entry must satisfy the inequality: $- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr)$.\n\n**Part 1: Determination of Strong Neighbor Sets $N^{s}_{i}(\\theta)$**\n\nWe will analyze each row $i \\in \\{1, 2, 3, 4, 5\\}$ separately.\n\nFor row $i=1$:\nThe only negative off-diagonal entry is $a_{12}=-1$.\nWe compute the maximum magnitude of negative off-diagonal entries in this row:\n$\\max_{k \\neq 1} (-a_{1k}) = \\max(-a_{12}, -a_{13}, \\dots) = \\max(1, 0, \\dots) = 1$.\nThe threshold condition for a neighbor $j$ to be strong is $-a_{1j} \\ge \\theta \\times 1 = 0.25$.\nFor $j=2$, we have $-a_{12} = -(-1) = 1$. Since $1 \\ge 0.25$, the connection to node $2$ is strong.\nThus, the strong neighbor set for row $1$ is $N^{s}_{1}(\\theta) = \\{2\\}$.\n\nFor row $i=2$:\nThe negative off-diagonal entries are $a_{21}=-1$ and $a_{23}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 2} (-a_{2k}) = \\max(-a_{21}, -a_{23}) = \\max(1, 1) = 1$.\nThe threshold condition is $-a_{2j} \\ge 0.25 \\times 1 = 0.25$.\nFor $j=1$: $-a_{21} = 1$, which is $\\ge 0.25$.\nFor $j=3$: $-a_{23} = 1$, which is $\\ge 0.25$.\nBoth connections are strong. Thus, $N^{s}_{2}(\\theta) = \\{1, 3\\}$.\n\nFor row $i=3$:\nThe negative off-diagonal entries are $a_{32}=-1$ and $a_{34}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 3} (-a_{3k}) = \\max(-a_{32}, -a_{34}) = \\max(1, 1) = 1$.\nThe threshold condition is $-a_{3j} \\ge 0.25$.\nFor $j=2$: $-a_{32} = 1 \\ge 0.25$.\nFor $j=4$: $-a_{34} = 1 \\ge 0.25$.\nBoth connections are strong. Thus, $N^{s}_{3}(\\theta) = \\{2, 4\\}$.\n\nFor row $i=4$:\nThe negative off-diagonal entries are $a_{43}=-1$ and $a_{45}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 4} (-a_{4k}) = \\max(-a_{43}, -a_{45}) = \\max(1, 1) = 1$.\nThe threshold condition is $-a_{4j} \\ge 0.25$.\nFor $j=3$: $-a_{43} = 1 \\ge 0.25$.\nFor $j=5$: $-a_{45} = 1 \\ge 0.25$.\nBoth connections are strong. Thus, $N^{s}_{4}(\\theta) = \\{3, 5\\}$.\n\nFor row $i=5$:\nThe only negative off-diagonal entry is $a_{54}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 5} (-a_{5k}) = \\max(-a_{54}) = 1$.\nThe threshold condition is $-a_{5j} \\ge 0.25$.\nFor $j=4$: $-a_{54} = 1 \\ge 0.25$. The connection is strong.\nThus, $N^{s}_{5}(\\theta) = \\{4\\}$.\n\nIn summary, for $\\theta = 0.25$, all non-zero off-diagonal connections in matrix $A$ are classified as strong.\n\n**Part 2: Computation of the Spectral Radius $\\rho(B)$**\n\nThe undirected strength graph $G$ has an edge $\\{i,j\\}$ if and only if $i \\in N^{s}_{j}(\\theta)$ or $j \\in N^{s}_{i}(\\theta)$. Based on our findings in Part 1:\n- Edge $\\{1,2\\}$: $2 \\in N^{s}_{1}(\\theta)$ (and $1 \\in N^{s}_{2}(\\theta)$). So, an edge exists.\n- Edge $\\{2,3\\}$: $3 \\in N^{s}_{2}(\\theta)$ (and $2 \\in N^{s}_{3}(\\theta)$). So, an edge exists.\n- Edge $\\{3,4\\}$: $4 \\in N^{s}_{3}(\\theta)$ (and $3 \\in N^{s}_{4}(\\theta)$). So, an edge exists.\n- Edge $\\{4,5\\}$: $5 \\in N^{s}_{4}(\\theta)$ (and $4 \\in N^{s}_{5}(\\theta)$). So, an edge exists.\nNo other connections exist. For example, for $\\{1,3\\}$, $3 \\notin N^{s}_{1}(\\theta)$ and $1 \\notin N^{s}_{3}(\\theta)$.\nThe resulting graph $G$ is a path graph with $5$ vertices, which can be drawn as $1-2-3-4-5$.\n\nThe adjacency matrix $B$ of this graph $G$ is a $5 \\times 5$ matrix where $B_{ij} = 1$ if an edge exists between vertices $i$ and $j$, and $B_{ij} = 0$ otherwise.\n$$\nB = \\begin{pmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n0  0  0  1  0\n\\end{pmatrix}\n$$\nThis is a symmetric tridiagonal matrix. The eigenvalues $\\lambda_k$ of an $n \\times n$ adjacency matrix for a path graph $P_n$ are given by the formula $\\lambda_k = 2\\cos\\left(\\frac{k\\pi}{n+1}\\right)$ for $k=1, 2, \\dots, n$.\nFor our matrix $B$, we have $n=5$. The eigenvalues are:\n$$\n\\lambda_k = 2 \\cos\\left(\\frac{k\\pi}{5+1}\\right) = 2 \\cos\\left(\\frac{k\\pi}{6}\\right), \\quad k=1,2,3,4,5.\n$$\nLet's compute these eigenvalues:\n- For $k=1$: $\\lambda_1 = 2 \\cos\\left(\\frac{\\pi}{6}\\right) = 2 \\left(\\frac{\\sqrt{3}}{2}\\right) = \\sqrt{3}$.\n- For $k=2$: $\\lambda_2 = 2 \\cos\\left(\\frac{2\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{3}\\right) = 2 \\left(\\frac{1}{2}\\right) = 1$.\n- For $k=3$: $\\lambda_3 = 2 \\cos\\left(\\frac{3\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{2}\\right) = 2(0) = 0$.\n- For $k=4$: $\\lambda_4 = 2 \\cos\\left(\\frac{4\\pi}{6}\\right) = 2 \\cos\\left(\\frac{2\\pi}{3}\\right) = 2 \\left(-\\frac{1}{2}\\right) = -1$.\n- For $k=5$: $\\lambda_5 = 2 \\cos\\left(\\frac{5\\pi}{6}\\right) = 2 \\left(-\\frac{\\sqrt{3}}{2}\\right) = -\\sqrt{3}$.\n\nThe set of eigenvalues of $B$ is $\\{\\sqrt{3}, 1, 0, -1, -\\sqrt{3}\\}$.\nThe spectral radius $\\rho(B)$ is the maximum absolute value of the eigenvalues:\n$$\n\\rho(B) = \\max_{k} |\\lambda_k| = \\max\\left\\{|\\sqrt{3}|, |1|, |0|, |-1|, |-\\sqrt{3}|\\right\\} = \\max\\{\\sqrt{3}, 1, 0\\} = \\sqrt{3}.\n$$\nThe spectral radius of the adjacency matrix $B$ is $\\sqrt{3}$.", "answer": "$$\\boxed{\\sqrt{3}}$$", "id": "3449289"}, {"introduction": "Once strong connections are identified, the next step is to partition the grid points into coarse ($C$) and fine ($F$) sets, a process known as coarsening. This practice ([@problem_id:3449313]) demonstrates the Parallel Modified Independent Set (PMIS) algorithm, a common and effective strategy that uses the strength graph to build a coarse grid. This exercise moves from the abstract concept of strength to its practical application in the AMG setup phase, illustrating how algorithmic decisions ensure the quality of the C/F splitting.", "problem": "Consider the one-dimensional diffusion operator $-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right)$ on the unit interval with homogeneous Dirichlet boundary conditions. Discretize this operator on a uniform grid with $8$ interior nodes using second-order centered finite differences. Let the discrete operator be represented by the symmetric tridiagonal matrix $A \\in \\mathbb{R}^{8 \\times 8}$ with entries defined by $a_{i,i} = b_{i-1} + b_{i}$, $a_{i,i-1} = -b_{i-1}$, and $a_{i,i+1} = -b_{i}$ for $i = 1, \\dots, 8$, with the conventions $b_{0} = 0$ and $b_{8} = 0$. Assume that the face conductivities $\\{b_{i}\\}_{i=1}^{7}$ are given by $b_{1} = 1$, $b_{2} = 0.2$, $b_{3} = 0.8$, $b_{4} = 0.8$, $b_{5} = 0.1$, $b_{6} = 1.2$, and $b_{7} = 0.3$.\n\nIn Algebraic Multigrid (AMG), define the strength of connection as follows: for each row index $i$, the set of strong dependences is $S_{i} := \\{j \\neq i : -a_{i,j} \\ge \\theta \\max_{k \\neq i}(-a_{i,k})\\}$ with threshold $\\theta = \\frac{1}{4}$. Interpret $S_{i}$ as the set of nodes $j$ that strongly influence node $i$.\n\nPerform Parallel Modified Independent Set (PMIS) coarsening on the directed strength graph with vertex set $\\{1,2,\\dots,8\\}$ and directed edges $i \\to j$ for $j \\in S_{i}$. Use the following PMIS selection rule: assign weights $w_{1} = 0.40$, $w_{2} = 0.95$, $w_{3} = 0.60$, $w_{4} = 0.55$, $w_{5} = 0.70$, $w_{6} = 0.20$, $w_{7} = 0.85$, and $w_{8} = 0.65$, select all nodes $i$ such that $w_{i}  w_{j}$ for every $j \\in S_{i}$, add them to the coarse set $C$, and then enforce independence by removing from consideration every node $\\ell$ for which a selected node $i$ satisfies $i \\in S_{\\ell}$. Iterate this selection and removal until all nodes have been classified. The fine set is $F := \\{1,2,\\dots,8\\} \\setminus C$. If any node in $F$ has no strong coarse neighbor, i.e., if $S_{i} \\cap C = \\varnothing$ for some $i \\in F$, then promote that node to $C$ so that every fine node has at least one strong coarse neighbor.\n\nLet $R$ be the verification quantity defined by $R := \\sum_{i \\in F} \\mathbf{1}_{|S_{i} \\cap C| \\ge 1}$, where $\\mathbf{1}_{\\cdot}$ denotes the indicator function. Compute $R$ for the described matrix $A$, strength threshold $\\theta$, and PMIS weights. Provide your final answer as a single real-valued number. No rounding is required.", "solution": "To solve this problem, we follow the prescribed Algebraic Multigrid (AMG) coarsening procedure step-by-step.\n\n**1. Construct the Matrix A and Determine Strength Sets**\n\nFirst, we determine the non-zero off-diagonal entries of the matrix $A$ from the given face conductivities $b_i$. Then, for each row $i$, we find the set of strong neighbors $S_i$ using the threshold $\\theta=0.25$.\n-   **Row 1**: $a_{1,2} = -b_1 = -1$. $\\max_{k\\neq 1}(-a_{1,k})=1$. Condition: $-a_{1,j} \\ge 0.25 \\times 1$. For $j=2$, $-a_{1,2}=1 \\ge 0.25$. So, $S_1 = \\{2\\}$.\n-   **Row 2**: $a_{2,1} = -b_1 = -1$, $a_{2,3} = -b_2 = -0.2$. $\\max_{k\\neq 2}(-a_{2,k})=1$. Condition: $-a_{2,j} \\ge 0.25$. For $j=1$, $-a_{2,1}=1 \\ge 0.25$. For $j=3$, $-a_{2,3}=0.2  0.25$. So, $S_2 = \\{1\\}$.\n-   **Row 3**: $a_{3,2} = -b_2 = -0.2$, $a_{3,4} = -b_3 = -0.8$. $\\max_{k\\neq 3}(-a_{3,k})=0.8$. Condition: $-a_{3,j} \\ge 0.25 \\times 0.8 = 0.2$. Both $-a_{3,2}=0.2$ and $-a_{3,4}=0.8$ meet the condition. So, $S_3 = \\{2, 4\\}$.\n-   **Row 4**: $a_{4,3} = -b_3 = -0.8$, $a_{4,5} = -b_4 = -0.8$. $\\max_{k\\neq 4}(-a_{4,k})=0.8$. Condition: $-a_{4,j} \\ge 0.2$. Both connections are strong. So, $S_4 = \\{3, 5\\}$.\n-   **Row 5**: $a_{5,4} = -b_4 = -0.8$, $a_{5,6} = -b_5 = -0.1$. $\\max_{k\\neq 5}(-a_{5,k})=0.8$. Condition: $-a_{5,j} \\ge 0.2$. For $j=4$, $-a_{5,4}=0.8 \\ge 0.2$. For $j=6$, $-a_{5,6}=0.1  0.2$. So, $S_5 = \\{4\\}$.\n-   **Row 6**: $a_{6,5} = -b_5 = -0.1$, $a_{6,7} = -b_6 = -1.2$. $\\max_{k\\neq 6}(-a_{6,k})=1.2$. Condition: $-a_{6,j} \\ge 0.25 \\times 1.2 = 0.3$. For $j=5$, $-a_{6,5}=0.1  0.3$. For $j=7$, $-a_{6,7}=1.2 \\ge 0.3$. So, $S_6 = \\{7\\}$.\n-   **Row 7**: $a_{7,6} = -b_6 = -1.2$, $a_{7,8} = -b_7 = -0.3$. $\\max_{k\\neq 7}(-a_{7,k})=1.2$. Condition: $-a_{7,j} \\ge 0.3$. Both connections are strong. So, $S_7 = \\{6, 8\\}$.\n-   **Row 8**: $a_{8,7} = -b_7 = -0.3$. $\\max_{k\\neq 8}(-a_{8,k})=0.3$. Condition: $-a_{8,j} \\ge 0.25 \\times 0.3 = 0.075$. For $j=7$, $-a_{8,7}=0.3 \\ge 0.075$. So, $S_8 = \\{7\\}$.\n\nSummary of strength sets: $S_1=\\{2\\}, S_2=\\{1\\}, S_3=\\{2,4\\}, S_4=\\{3,5\\}, S_5=\\{4\\}, S_6=\\{7\\}, S_7=\\{6,8\\}, S_8=\\{7\\}$.\n\n**2. Perform PMIS Coarsening**\n\nWe use the given weights $w_i$ to select an initial coarse set $C$. A node $i$ is selected if its weight $w_i$ is greater than the weights of all its strong neighbors $j \\in S_i$.\nThe weights are: $w_{1} = 0.40, w_{2} = 0.95, w_{3} = 0.60, w_{4} = 0.55, w_{5} = 0.70, w_{6} = 0.20, w_{7} = 0.85, w_{8} = 0.65$.\n\n-   **Node 1 ($S_1=\\{2\\}$)**: Is $w_1 > w_2$? $0.40 > 0.95$ is false.\n-   **Node 2 ($S_2=\\{1\\}$)**: Is $w_2 > w_1$? $0.95 > 0.40$ is true. **Select node 2.**\n-   **Node 3 ($S_3=\\{2,4\\}$)**: Is $w_3 > w_2$ and $w_3 > w_4$? $0.60 > 0.95$ is false.\n-   **Node 4 ($S_4=\\{3,5\\}$)**: Is $w_4 > w_3$ and $w_4 > w_5$? $0.55 > 0.60$ is false.\n-   **Node 5 ($S_5=\\{4\\}$)**: Is $w_5 > w_4$? $0.70 > 0.55$ is true. **Select node 5.**\n-   **Node 6 ($S_6=\\{7\\}$)**: Is $w_6 > w_7$? $0.20 > 0.85$ is false.\n-   **Node 7 ($S_7=\\{6,8\\}$)**: Is $w_7 > w_6$ and $w_7 > w_8$? $0.85 > 0.20$ (true) and $0.85 > 0.65$ (true). **Select node 7.**\n-   **Node 8 ($S_8=\\{7\\}$)**: Is $w_8 > w_7$? $0.65 > 0.85$ is false.\n\nThe set of selected coarse nodes is $I = \\{2, 5, 7\\}$. We add these to the coarse set: $C = \\{2, 5, 7\\}$.\nNext, we identify the fine set $F$. A node $\\ell$ becomes a fine point if one of its strong influencers is in the selected coarse set $I$.\n-   For node 1: $S_1=\\{2\\}$ and $2 \\in I$. So, node 1 becomes a fine point.\n-   For node 3: $S_3=\\{2,4\\}$ and $2 \\in I$. So, node 3 becomes a fine point.\n-   For node 4: $S_4=\\{3,5\\}$ and $5 \\in I$. So, node 4 becomes a fine point.\n-   For node 6: $S_6=\\{7\\}$ and $7 \\in I$. So, node 6 becomes a fine point.\n-   For node 8: $S_8=\\{7\\}$ and $7 \\in I$. So, node 8 becomes a fine point.\nAll undecided nodes have been classified. The initial C/F split is:\n$C = \\{2, 5, 7\\}$\n$F = \\{1, 3, 4, 6, 8\\}$\n\n**3. Apply Promotion Rule**\n\nWe check if any fine point $i \\in F$ has no strong connection to the coarse set $C$.\n-   $i=1 \\in F$: $S_1 \\cap C = \\{2\\} \\cap \\{2,5,7\\} = \\{2\\}$. OK.\n-   $i=3 \\in F$: $S_3 \\cap C = \\{2,4\\} \\cap \\{2,5,7\\} = \\{2\\}$. OK.\n-   $i=4 \\in F$: $S_4 \\cap C = \\{3,5\\} \\cap \\{2,5,7\\} = \\{5\\}$. OK.\n-   $i=6 \\in F$: $S_6 \\cap C = \\{7\\} \\cap \\{2,5,7\\} = \\{7\\}$. OK.\n-   $i=8 \\in F$: $S_8 \\cap C = \\{7\\} \\cap \\{2,5,7\\} = \\{7\\}$. OK.\nEvery fine node has a strong coarse neighbor. No promotions are needed. The final sets are the same as the initial ones.\n\n**4. Compute the Quantity R**\n\nThe quantity to compute is $R := \\sum_{i \\in F} \\mathbf{1}_{|S_{i} \\cap C| \\ge 1}$. This counts the number of fine points that have at least one strong coarse neighbor.\nAs determined in the previous step, all 5 nodes in the final fine set $F = \\{1, 3, 4, 6, 8\\}$ satisfy this condition.\nTherefore, the value of $R$ is the number of elements in $F$.\n$R = |F| = 5$.", "answer": "$$\\boxed{5}$$", "id": "3449313"}, {"introduction": "Classical strength definitions can fail to identify important indirect couplings, but modern AMG methods use \"test vectors\" representing smooth error to define a more robust measure of strength and to construct the interpolation operator. This exercise ([@problem_id:3449351]) contrasts classical strength with an \"algebraic-distance\" measure, showing how the latter can capture long-range dependencies. This advanced practice connects the concepts of algebraic smoothness, strength of connection, and interpolation, revealing the unified philosophy behind many modern AMG variants.", "problem": "Consider the scalar diffusion model problem $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a one-dimensional domain with homogeneous Dirichlet boundary conditions, discretized by the standard second-order centered finite differences on three interior grid points. The resulting linear system is $A u = b$ with a symmetric positive definite (SPD) matrix $A \\in \\mathbb{R}^{3 \\times 3}$ of the $M$-matrix form (positive diagonal, nonpositive off-diagonals):\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\nYou will analyze strength of connection and determine an interpolation choice in the context of Algebraic Multigrid (AMG), explicitly capturing indirect coupling across a zero off-diagonal.\n\n1. Using the classical strength-of-connection definition attributed to the Ruge–Stüben method, a node $j \\neq i$ is a strong neighbor of $i$ if $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$. Compute the classical strength sets $S_{i}^{\\mathrm{RS}}$ for $i \\in \\{1,2,3\\}$ with $\\theta = 0.25$.\n\n2. Define an algebraic-distance strength of connection on the graph of $A$ using two test vectors that represent low-energy error components for diffusion:\n$$\nv^{(1)} = (1,\\,1,\\,1)^{\\top}, \\qquad v^{(2)} = (0,\\,1,\\,2)^{\\top}.\n$$\nFor each existing edge $(i,j)$ with $a_{ij} \\neq 0$, define the local misfit\n$$\nm_{ij} \\;=\\; \\left( \\sum_{t=1}^{2} \\big(v_{i}^{(t)} - v_{j}^{(t)}\\big)^{2} \\right)^{1/2}.\n$$\nFor the nonedge pair $(1,3)$ with $a_{13} = 0$, define the indirect algebraic distance $d_{13}$ as the shortest-path sum of edge misfits over the graph of $A$, i.e.,\n$$\nd_{13} \\;=\\; \\min_{\\text{paths } 1 \\to 3} \\sum_{\\text{edges }(p,q)\\text{ on path}} m_{pq}.\n$$\nUse the threshold $\\tau = 2$ and declare $(i,j)$ algebraically strong if $d_{ij} \\le \\tau$. Compute $m_{12}$, $m_{23}$, $d_{13}$, and state whether $(1,3)$ is algebraically strong under this criterion.\n\n3. Suppose the coarse set is $C = \\{1,\\,3\\}$ and the fine set is $F = \\{2\\}$. Choose interpolation for the fine node $2$ based on the algebraic-distance assessment above: use local least-squares interpolation constrained to reproduce the constant near-nullspace component. Specifically, determine weights $w_{21}$ and $w_{23}$ by minimizing\n$$\nJ(w_{21}, w_{23}) \\;=\\; \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}\n$$\nsubject to the reproduction constraint $w_{21} + w_{23} = 1$. Compute the exact value of the interpolation weight $w_{21}$ for the fine node $2$ with respect to coarse node $1$. Provide your final answer as an exact value without rounding and without units.", "solution": "This problem requires performing three related tasks from Algebraic Multigrid (AMG): calculating classical strength sets, computing an algebraic distance to determine strength, and finding an interpolation weight via constrained least-squares minimization.\n\n**Part 1: Classical Strength of Connection**\n\nWe compute the Ruge–Stüben strength sets $S_{i}^{\\mathrm{RS}}$ for the matrix $A = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}$ with threshold $\\theta = 0.25$. The rule is: $j$ is a strong neighbor of $i$ if $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$.\n\n-   **For node $i=1$**: The only non-zero off-diagonal is $a_{12}=-1$. So, $\\max_{k \\neq 1}(-a_{1k}) = 1$. The condition for neighbor $j=2$ is $-a_{12} = 1 \\ge 0.25 \\times 1$, which is true. Thus, $S_{1}^{\\mathrm{RS}} = \\{2\\}$.\n-   **For node $i=2$**: The non-zero off-diagonals are $a_{21}=-1$ and $a_{23}=-1$. So, $\\max_{k \\neq 2}(-a_{2k}) = 1$. Both neighbors $j=1$ and $j=3$ satisfy the condition $-a_{2j} = 1 \\ge 0.25 \\times 1$. Thus, $S_{2}^{\\mathrm{RS}} = \\{1, 3\\}$.\n-   **For node $i=3$**: By symmetry with node 1, the only strong neighbor is node 2. Thus, $S_{3}^{\\mathrm{RS}} = \\{2\\}$.\n\nClassical strength only identifies direct neighbors. Node 1 and Node 3 are not strongly connected.\n\n**Part 2: Algebraic-Distance Strength of Connection**\n\nWe use the test vectors $v^{(1)} = (1,1,1)^{\\top}$ and $v^{(2)} = (0,1,2)^{\\top}$ to compute misfits and distances.\n\n-   **Compute $m_{12}$**: Using the definition for the edge $(1,2)$:\n    $m_{12} = \\sqrt{(v_{1}^{(1)} - v_{2}^{(1)})^{2} + (v_{1}^{(2)} - v_{2}^{(2)})^{2}} = \\sqrt{(1-1)^{2} + (0-1)^{2}} = \\sqrt{0 + 1} = 1$.\n-   **Compute $m_{23}$**: Using the definition for the edge $(2,3)$:\n    $m_{23} = \\sqrt{(v_{2}^{(1)} - v_{3}^{(1)})^{2} + (v_{2}^{(2)} - v_{3}^{(2)})^{2}} = \\sqrt{(1-1)^{2} + (1-2)^{2}} = \\sqrt{0 + 1} = 1$.\n-   **Compute $d_{13}$**: The graph of $A$ is $1-2-3$. The only path from node 1 to node 3 is through node 2. The indirect distance is the sum of misfits along this path:\n    $d_{13} = m_{12} + m_{23} = 1 + 1 = 2$.\n-   **Strength Assessment**: A connection is strong if its distance is less than or equal to the threshold $\\tau=2$. Since $d_{13} = 2$, the condition $d_{13} \\le 2$ is met. Therefore, the pair $(1,3)$ is considered **algebraically strong**.\n\n**Part 3: Interpolation Weight Calculation**\n\nWe need to find $w_{21}$ and $w_{23}$ that minimize $J(w_{21}, w_{23})$ subject to $w_{21} + w_{23} = 1$.\nSubstitute $w_{23} = 1 - w_{21}$ into the objective function:\n$$\nJ(w_{21}) = \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} v_{1}^{(t)} - (1 - w_{21}) v_{3}^{(t)} \\right)^{2}\n$$\nRearrange the expression inside the summation:\n$$\nJ(w_{21}) = \\sum_{t=1}^{2} \\left( (v_{2}^{(t)} - v_{3}^{(t)}) - w_{21}(v_{1}^{(t)} - v_{3}^{(t)}) \\right)^{2}\n$$\nNow, evaluate the terms for each test vector:\n-   **For $t=1$ ($v^{(1)}$)**: $v_2^{(1)} - v_3^{(1)} = 1-1=0$, and $v_1^{(1)} - v_3^{(1)} = 1-1=0$. The contribution to the sum is $(0 - w_{21} \\cdot 0)^2 = 0$. This confirms the constraint correctly reproduces the constant vector.\n-   **For $t=2$ ($v^{(2)}$)**: $v_2^{(2)} - v_3^{(2)} = 1-2=-1$, and $v_1^{(2)} - v_3^{(2)} = 0-2=-2$. The contribution to the sum is $(-1 - w_{21}(-2))^2 = (-1 + 2w_{21})^2$.\n\nThe objective function simplifies to $J(w_{21}) = (-1 + 2w_{21})^2$. To minimize this non-negative quadratic function, we find the value of $w_{21}$ that makes it zero.\n$$\n-1 + 2w_{21} = 0 \\implies 2w_{21} = 1 \\implies w_{21} = \\frac{1}{2}.\n$$\nThe interpolation weight for the fine node 2 with respect to coarse node 1 is $w_{21} = 1/2$. Consequently, $w_{23}=1-w_{21}=1/2$, corresponding to standard linear interpolation.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3449351"}]}