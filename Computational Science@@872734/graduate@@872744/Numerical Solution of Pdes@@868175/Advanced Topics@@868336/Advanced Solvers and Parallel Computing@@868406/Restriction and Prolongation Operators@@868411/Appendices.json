{"hands_on_practices": [{"introduction": "A fundamental requirement for an effective prolongation operator is its ability to accurately represent smooth functions on a fine grid using only coarse-grid data. This exercise provides a foundational look at constructing the widely used bilinear interpolation operator from first principles, starting with a 1D linear interpolant and extending it to 2D via a tensor product. By calculating the exact interpolation error for a quadratic polynomial [@problem_id:3357474], you will gain direct insight into why this operator achieves second-order accuracy, a key property for the efficiency of multigrid methods.", "problem": "Consider a uniform coarse grid in one spatial dimension with node spacing $H$ and nodal abscissae $x_i = i H$, where $i \\in \\mathbb{Z}$. Let $u^H_i$ denote the coarse-grid approximation to a sufficiently smooth scalar field $u(x)$, a field variable arising in Computational Fluid Dynamics (CFD). Define a fine grid with spacing $h = H/2$ whose nodes include $x_i$, $x_i + H/2$, and $x_{i+1} = x_i + H$. \n\n(a) Using only the fundamental definition of interpolation as the unique element in a chosen polynomial space that matches the data at interpolation points, derive the one-dimensional prolongation operator that maps coarse-grid nodal values $\\{u^H_i, u^H_{i+1}\\}$ to fine-grid values at $\\{x_i, x_i + H/2, x_{i+1}\\}$ under the requirement that the interpolation be linear over each coarse cell $[x_i, x_{i+1}]$. Write the resulting pointwise mapping for these three fine-grid points in terms of $\\{u^H_i, u^H_{i+1}\\}$.\n\n(b) Consider now a uniform coarse grid in two spatial dimensions with coarse nodes at $(x,y) \\in \\{0,H\\} \\times \\{0,H\\}$ and the same scalar field $u(x,y)$. Construct the bilinear prolongation operator over the coarse cell $[0,H] \\times [0,H]$ by taking the tensor product of the one-dimensional linear interpolation derived in part (a). Evaluate the bilinear prolongation at the cell center $(H/2,H/2)$ and express it in terms of the corner values $\\{u^H(0,0), u^H(H,0), u^H(0,H), u^H(H,H)\\}$.\n\n(c) To assess order of accuracy by a polynomial exactness test, let $f(x,y) = a x^2 + b y^2 + c x y + d x + e y + g$ be a quadratic polynomial with constants $a$, $b$, $c$, $d$, $e$, and $g$. Using the bilinear prolongation from part (b), compute the interpolation error at the cell center, defined as\n$$\nE_{\\mathrm{center}} = f\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) - I\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right),\n$$\nwhere $I(x,y)$ is the bilinear interpolant built from the corner coarse-grid values $\\{f(0,0), f(H,0), f(0,H), f(H,H)\\}$. Give your final answer as a single closed-form analytic expression in terms of $a$, $b$, and $H$. Do not use big-$\\mathcal{O}$ notation, and no rounding is required.", "solution": "We begin from the fundamental definition of interpolation on a given cell: the interpolant is the unique member of a prescribed polynomial space that matches the known data at the interpolation points. In one spatial dimension, the space is the set of polynomials of degree at most $1$ on each coarse cell; in two spatial dimensions, the space is the tensor product of these one-dimensional spaces, namely the set of bilinear polynomials.\n\nPart (a). One-dimensional linear prolongation on a coarse cell $[x_i,x_{i+1}]$.\n\nOn $[x_i,x_{i+1}]$ with $x_{i+1} = x_i + H$, the one-dimensional linear interpolant is characterized by the Lagrange basis functions\n$$\nN_0(x) = \\frac{x_{i+1} - x}{H}, \\qquad N_1(x) = \\frac{x - x_i}{H},\n$$\nwhich satisfy $N_0(x_i) = 1$, $N_0(x_{i+1}) = 0$, $N_1(x_i) = 0$, and $N_1(x_{i+1}) = 1$. Given the coarse-grid nodal values $u^H_i \\approx u(x_i)$ and $u^H_{i+1} \\approx u(x_{i+1})$, the linear interpolant is\n$$\nI(x) = u^H_i \\, N_0(x) + u^H_{i+1} \\, N_1(x).\n$$\nEvaluating at the three fine-grid points in the cell:\n- At $x = x_i$,\n$$\nI(x_i) = u^H_i \\, N_0(x_i) + u^H_{i+1} \\, N_1(x_i) = u^H_i.\n$$\n- At $x = x_i + H/2$,\n$$\nN_0\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{x_{i+1} - (x_i + H/2)}{H} = \\frac{H/2}{H} = \\frac{1}{2}, \\quad\nN_1\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{(x_i + H/2) - x_i}{H} = \\frac{1}{2},\n$$\nso\n$$\nI\\!\\left(x_i + \\frac{H}{2}\\right) = \\frac{1}{2} u^H_i + \\frac{1}{2} u^H_{i+1}.\n$$\n- At $x = x_{i+1}$,\n$$\nI(x_{i+1}) = u^H_{i+1}.\n$$\nThus, the one-dimensional prolongation from the coarse nodes to the fine nodes in the cell maps\n$$\n\\bigl(u^H_i, u^H_{i+1}\\bigr) \\mapsto \\left( u^H_i,\\ \\frac{u^H_i + u^H_{i+1}}{2},\\ u^H_{i+1} \\right).\n$$\n\nPart (b). Two-dimensional bilinear prolongation as a tensor product and evaluation at the cell center.\n\nOn the coarse cell $[0,H] \\times [0,H]$, take the one-dimensional bases in $x$ and $y$:\n$$\nN_0(x) = \\frac{H - x}{H}, \\quad N_1(x) = \\frac{x}{H}, \\qquad\nM_0(y) = \\frac{H - y}{H}, \\quad M_1(y) = \\frac{y}{H}.\n$$\nThe bilinear basis on the cell corners is $\\{ \\phi_{pq}(x,y) = N_p(x) M_q(y) \\}_{p,q \\in \\{0,1\\}}$, so given corner values\n$$\nu^H_{00} = u^H(0,0), \\quad u^H_{10} = u^H(H,0), \\quad u^H_{01} = u^H(0,H), \\quad u^H_{11} = u^H(H,H),\n$$\nthe bilinear interpolant is\n$$\nI(x,y) = u^H_{00} \\, N_0(x) M_0(y) + u^H_{10} \\, N_1(x) M_0(y) + u^H_{01} \\, N_0(x) M_1(y) + u^H_{11} \\, N_1(x) M_1(y).\n$$\nAt the center $(H/2,H/2)$, one has\n$$\nN_0\\!\\left(\\frac{H}{2}\\right) = N_1\\!\\left(\\frac{H}{2}\\right) = \\frac{1}{2}, \\qquad\nM_0\\!\\left(\\frac{H}{2}\\right) = M_1\\!\\left(\\frac{H}{2}\\right) = \\frac{1}{2}.\n$$\nTherefore,\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\sum_{p=0}^{1} \\sum_{q=0}^{1} u^H_{pq} \\, \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4} \\left( u^H_{00} + u^H_{10} + u^H_{01} + u^H_{11} \\right).\n$$\n\nPart (c). Interpolation error at the center for a quadratic polynomial and order assessment.\n\nLet $f(x,y) = a x^2 + b y^2 + c x y + d x + e y + g$. Evaluate $f$ at the four corners:\n- At $(0,0)$:\n$$\nf(0,0) = g.\n$$\n- At $(H,0)$:\n$$\nf(H,0) = a H^2 + d H + g.\n$$\n- At $(0,H)$:\n$$\nf(0,H) = b H^2 + e H + g.\n$$\n- At $(H,H)$:\n$$\nf(H,H) = a H^2 + b H^2 + c H^2 + d H + e H + g = (a + b + c) H^2 + d H + e H + g.\n$$\nThus, the bilinear prolongation at the center, using part (b), is\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\frac{1}{4} \\left[ g + (a H^2 + d H + g) + (b H^2 + e H + g) + \\bigl( (a+b+c) H^2 + d H + e H + g \\bigr) \\right].\n$$\nCollect terms:\n- Constant term: $g + g + g + g = 4 g$ gives $\\frac{1}{4} \\cdot 4 g = g$.\n- Terms proportional to $H$: $d H + d H = 2 d H$ and $e H + e H = 2 e H$ give $\\frac{1}{4} (2 d H + 2 e H) = \\frac{d+e}{2} H$.\n- Terms proportional to $H^2$: $a H^2 + b H^2 + (a+b+c) H^2 = (2 a + 2 b + c) H^2$ gives $\\frac{1}{4} (2 a + 2 b + c) H^2$.\n\nTherefore,\n$$\nI\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = g + \\frac{d+e}{2} H + \\frac{2 a + 2 b + c}{4} H^2.\n$$\nCompute the exact value of $f$ at the center:\n$$\nf\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = a \\left(\\frac{H}{2}\\right)^{2} + b \\left(\\frac{H}{2}\\right)^{2} + c \\left(\\frac{H}{2}\\right)\\left(\\frac{H}{2}\\right) + d \\left(\\frac{H}{2}\\right) + e \\left(\\frac{H}{2}\\right) + g.\n$$\nSimplify:\n$$\nf\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) = \\frac{a + b + c}{4} H^2 + \\frac{d+e}{2} H + g.\n$$\nThe interpolation error at the center, defined as\n$$\nE_{\\mathrm{center}} = f\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right) - I\\!\\left(\\frac{H}{2},\\frac{H}{2}\\right),\n$$\nis then\n$$\nE_{\\mathrm{center}} = \\left( \\frac{a + b + c}{4} H^2 + \\frac{d+e}{2} H + g \\right) - \\left( g + \\frac{d+e}{2} H + \\frac{2 a + 2 b + c}{4} H^2 \\right).\n$$\nCanceling common terms $\\frac{d+e}{2} H$ and $g$, we obtain\n$$\nE_{\\mathrm{center}} = \\left( \\frac{a + b + c}{4} - \\frac{2 a + 2 b + c}{4} \\right) H^2 = - \\frac{a + b}{4} \\, H^2.\n$$\nThis exact expression shows that the bilinear prolongation reproduces the mixed term $c x y$ and all linear and constant terms exactly, and that the leading error scales like $H^2$, demonstrating second-order accuracy of the prolongation at the cell center for sufficiently smooth fields whose local quadratic model is representative of the truncation behavior.", "answer": "$$\\boxed{-\\frac{a+b}{4}\\,H^{2}}$$", "id": "3357474"}, {"introduction": "While theoretical operator stencils are often defined for an infinite grid, practical implementations must handle physical boundaries. This exercise addresses a common challenge: adapting the standard full-weighting restriction operator for use near a Dirichlet boundary [@problem_id:3440509]. You will apply the crucial principle of constant preservation—ensuring the operator correctly maps a constant field from the fine to the coarse grid—by renormalizing the stencil weights, a technique essential for robust multigrid solvers.", "problem": "Consider a two-dimensional elliptic partial differential equation (PDE) with homogeneous Dirichlet boundary conditions on a polygonal domain that is aligned with a Cartesian grid along straight boundary segments. Let the fine grid be node-centered with spacing $h$ and indices $(i,j)$ for interior nodes, and the coarse grid have spacing $H=2h$ with indices $(I,J)$ for interior coarse nodes. For interior coarse nodes far from the boundary, the classical full-weighting restriction operator maps a fine-grid nodal field $r_{i,j}$ (for example, a residual) to the coarse grid via the $3\\times 3$ stencil\n$$\n\\frac{1}{16}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix},\n$$\ncentered at the fine node $(2I,2J)$.\n\nNear a Dirichlet boundary, directly applying the above stencil at a coarse node adjacent to the boundary may require fine-grid values outside the domain (ghost points) if the standard $3\\times 3$ support overlaps the exterior. A robust modification that avoids ghost points is to set the weights corresponding to out-of-domain fine nodes to zero and renormalize the remaining in-domain weights so that the restriction preserves constants, i.e., the modified weights sum to $1$.\n\nFocus on a coarse node $(I,J)$ that is adjacent to a straight, grid-aligned Dirichlet boundary, but not at a corner, such that the entire one-column of fine nodes on the boundary-normal side of the standard $3\\times 3$ stencil lies outside the domain. Assume the missing column corresponds to the “left” column of the $3\\times 3$ stencil relative to the fine-grid center $(2I,2J)$.\n\nStarting only from the requirement that the restriction operator is a convex combination of the available fine-grid values (weights nonnegative and summing to $1$) and reduces to the interior full-weighting in the absence of boundaries, derive the renormalized full-weighting stencil at this boundary-adjacent coarse node by removing the outside-of-domain column and rescaling the remaining weights. Provide your final answer as the full $3\\times 3$ matrix of weights (ordered from bottom-left to top-right), inserting $0$ for the excluded positions, and express all entries as exact fractions.", "solution": "The problem requires the derivation of a modified full-weighting restriction operator stencil for a coarse-grid node adjacent to a straight, grid-aligned Dirichlet boundary. The modification must adhere to the principle of preserving constants, which means the stencil weights must be non-negative and sum to $1$.\n\nThe standard full-weighting restriction operator for an interior coarse node $(I,J)$ is defined by a $3 \\times 3$ stencil of weights applied to the fine-grid residual field $r$ at and around the corresponding fine-grid node $(2I, 2J)$. The unnormalized weights, which we denote as a matrix $W$, are given as:\n$$\nW =\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix}\n$$\nThe sum of these unnormalized weights is $S_{total} = 1+2+1+2+4+2+1+2+1 = 16$. The standard restriction operator $R_{int}$ is obtained by normalizing these weights, i.e., $R_{int} = \\frac{1}{S_{total}} W = \\frac{1}{16} W$.\n\nThe problem considers a scenario where the coarse node $(I,J)$ is near a boundary such that the fine-grid nodes corresponding to the \"left\" column of the stencil's support lie outside the computational domain. We assume the matrix $W$ is laid out such that its columns correspond to the x-direction on the grid, with the first column being the \"left\" column. The fine-grid nodes associated with this left column have their values unavailable due to the Dirichlet boundary condition (values are fixed at $0$ on the boundary and are not part of the residual calculation for interior nodes).\n\nThe modification procedure states that the weights corresponding to these out-of-domain fine nodes must be set to zero. The unnormalized weights in the left column of $W$ are $1$, $2$, and $1$. The sum of these removed weights is:\n$$\nS_{removed} = 1 + 2 + 1 = 4\n$$\nThe remaining unnormalized weights reside in the second and third columns of $W$. The sum of these remaining weights, $S_{rem}$, is the total sum minus the sum of the removed weights:\n$$\nS_{rem} = S_{total} - S_{removed} = 16 - 4 = 12\n$$\nThe matrix of remaining unnormalized weights, which we can call $W_{bound, unnorm}$, is:\n$$\nW_{bound, unnorm} =\n\\begin{pmatrix}\n0 & 2 & 1 \\\\\n0 & 4 & 2 \\\\\n0 & 2 & 1\n\\end{pmatrix}\n$$\nTo ensure the modified restriction operator preserves constants, the remaining weights must be renormalized to sum to $1$. This is achieved by dividing each of the remaining unnormalized weights by their sum, $S_{rem}$. The new normalization factor is $\\frac{1}{S_{rem}} = \\frac{1}{12}$.\n\nThe resulting boundary-modified restriction stencil, $R_{bound}$, is therefore:\n$$\nR_{bound} = \\frac{1}{12} W_{bound, unnorm} = \\frac{1}{12}\n\\begin{pmatrix}\n0 & 2 & 1 \\\\\n0 & 4 & 2 \\\\\n0 & 2 & 1\n\\end{pmatrix}\n$$\nMultiplying the scalar into the matrix and simplifying the fractions gives the final matrix of weights:\n$$\nR_{bound} =\n\\begin{pmatrix}\n\\frac{0}{12} & \\frac{2}{12} & \\frac{1}{12} \\\\\n\\frac{0}{12} & \\frac{4}{12} & \\frac{2}{12} \\\\\n\\frac{0}{12} & \\frac{2}{12} & \\frac{1}{12}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\frac{1}{6} & \\frac{1}{12} \\\\\n0 & \\frac{1}{3} & \\frac{1}{6} \\\\\n0 & \\frac{1}{6} & \\frac{1}{12}\n\\end{pmatrix}\n$$\nThis matrix represents the stencil for a coarse node adjacent to a straight boundary on its left side. The sum of its elements is $0 + \\frac{1}{6} + \\frac{1}{12} + 0 + \\frac{1}{3} + \\frac{1}{6} + 0 + \\frac{1}{6} + \\frac{1}{12} = \\frac{2}{12} + \\frac{1}{12} + \\frac{4}{12} + \\frac{2}{12} + \\frac{2}{12} + \\frac{1}{12} = \\frac{12}{12} = 1$, confirming that the operator preserves constants as required.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{1}{6} & \\frac{1}{12} \\\\\n0 & \\frac{1}{3} & \\frac{1}{6} \\\\\n0 & \\frac{1}{6} & \\frac{1}{12}\n\\endpmatrix}\n$$", "id": "3440509"}, {"introduction": "Having examined prolongation and restriction operators individually, we now integrate them into a complete algorithmic cycle to solve a nonlinear problem. This practice guides you through one V-cycle of the Full Approximation Scheme (FAS), the standard multigrid framework for handling nonlinearities [@problem_id:3357488]. By explicitly calculating the defect, restricting both the state and the defect, solving the coarse-grid problem, and prolongating the correction, you will see precisely how a coarse grid can efficiently compute a correction for a fine-grid nonlinear problem.", "problem": "Consider a one-dimensional, steady, nonlinear diffusion model problem representative of computational fluid dynamics: the scalar field $u(x)$ on $x \\in [0,1]$ satisfies\n$$\n- \\frac{d}{dx} \\left( \\left( 1 + u(x)^{2} \\right) \\frac{du}{dx} \\right) = 1,\n$$\nwith Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. Discretize the operator using a conservative centered finite-volume/finite-difference scheme on a uniform grid, where for grid spacing $h$ and interior node index $i$, the discrete nonlinear operator $N^{h}(u)$ is\n$$\n\\left(N^{h}(u)\\right)_{i} \\equiv - \\frac{1}{h} \\left( \\frac{1}{h} a_{i+\\frac{1}{2}} \\left( u_{i+1} - u_{i} \\right) - \\frac{1}{h} a_{i-\\frac{1}{2}} \\left( u_{i} - u_{i-1} \\right) \\right),\n$$\nwith nonlinear face diffusivities defined by\n$$\na_{i+\\frac{1}{2}} \\equiv 1 + \\left( \\frac{u_{i} + u_{i+1}}{2} \\right)^{2}.\n$$\n\nWork through one Full Approximation Scheme (FAS) V-cycle using the following setup:\n\n- Fine grid: $h = 1/4$, nodes at $x = 0, 1/4, 1/2, 3/4, 1$ with three interior unknowns $\\tilde{u}^{h} = \\left( \\tilde{u}_{1}, \\tilde{u}_{2}, \\tilde{u}_{3} \\right)^{\\top}$ corresponding to $x = 1/4, 1/2, 3/4$.\n- Coarse grid: $H = 2h = 1/2$, nodes at $x = 0, 1/2, 1$ with one interior unknown $u^{H}$ at $x = 1/2$.\n- Right-hand side on both grids is the discretization of the constant source $1$, namely $f^{h}_{i} = 1$ for $i = 1,2,3$ and $f^{H} = 1$ at the coarse interior node.\n- Initial fine-grid iterate is zero: $\\tilde{u}^{h} = (0,0,0)^{\\top}$.\n- Restriction for state (grid function) is injection $R_{u}: \\mathbb{R}^{3} \\to \\mathbb{R}$, defined by $R_{u}(\\tilde{u}^{h}) = \\tilde{u}_{2}$.\n- Restriction for residual/defect is one-dimensional full-weighting $R_{r}: \\mathbb{R}^{3} \\to \\mathbb{R}$,\n$$\nR_{r}(r^{h}) = \\frac{1}{4} r^{h}_{1} + \\frac{1}{2} r^{h}_{2} + \\frac{1}{4} r^{h}_{3}.\n$$\n- Prolongation for corrections $P: \\mathbb{R} \\to \\mathbb{R}^{3}$ is linear interpolation from the coarse interior correction $e^{H}$ to fine nodes,\n$$\nP(e^{H}) = \\left( \\frac{1}{2} e^{H}, \\; e^{H}, \\; \\frac{1}{2} e^{H} \\right)^{\\top}.\n$$\n- On the coarse grid, perform one step of Newton’s method to approximately solve the FAS coarse equation, starting from the injected coarse state. That is, with $F^{H}(u^{H}) \\equiv N^{H}(u^{H}) - f^{H}_{\\text{FAS}}$, take\n$$\nu^{H} \\leftarrow u^{H} - \\frac{F^{H}(u^{H})}{\\left( F^{H} \\right)'(u^{H})},\n$$\nstarting from $u^{H} = R_{u}(\\tilde{u}^{h})$.\n\nProceed through the FAS steps as follows:\n\n1. Compute the fine-grid defect $d^{h} \\equiv f^{h} - N^{h}(\\tilde{u}^{h})$.\n2. Restrict the state: $\\tilde{u}^{H} \\equiv R_{u}(\\tilde{u}^{h})$ and write the coarse nonlinear operator $N^{H}(u^{H})$ under the same discretization principle with spacing $H$.\n3. Form the FAS coarse right-hand side $f^{H}_{\\text{FAS}}$ using the defect and state restriction together with the coarse operator evaluated at $\\tilde{u}^{H}$.\n4. Apply one Newton step to the coarse equation to obtain $u^{H}$.\n5. Compute the coarse correction $e^{H} \\equiv u^{H} - \\tilde{u}^{H}$.\n6. Prolongate the correction $e^{h} \\equiv P(e^{H})$ and update the fine-grid iterate $u^{h,\\text{new}} \\equiv \\tilde{u}^{h} + e^{h}$.\n\nExplicitly write each application of $R_{u}$, $R_{r}$, and $P$ to the state and defect during these steps, and explain how the coarse-grid correction modifies the fine-grid iterate. Finally, report the value of the updated fine-grid iterate at the central node $x = 1/2$. Provide your final answer as a single real number. No rounding is required, and the quantity is dimensionless.", "solution": "The user wants to perform a single V-cycle of the Full Approximation Scheme (FAS) for a specific one-dimensional nonlinear diffusion problem. The process is broken down into six distinct steps as specified in the problem statement.\n\nFirst, we establish the mathematical context. The nonlinear boundary value problem is:\n$$\n- \\frac{d}{dx} \\left( \\left( 1 + u(x)^{2} \\right) \\frac{du}{dx} \\right) = 1, \\quad x \\in [0,1]\n$$\nwith boundary conditions $u(0) = 0$ and $u(1) = 0$.\n\nThe fine grid has a spacing of $h = 1/4$, resulting in three interior unknowns $\\tilde{u}_{1}, \\tilde{u}_{2}, \\tilde{u}_{3}$ at positions $x_1 = 1/4$, $x_2 = 1/2$, and $x_3 = 3/4$, respectively. The boundary nodes are $u_0 = u(0) = 0$ and $u_4 = u(1) = 0$. The initial guess for the fine-grid solution is $\\tilde{u}^{h} = (\\tilde{u}_1, \\tilde{u}_2, \\tilde{u}_3)^{\\top} = (0, 0, 0)^{\\top}$. The source term is discretized as $f^{h} = (1, 1, 1)^{\\top}$.\n\nThe coarse grid has a spacing of $H = 2h = 1/2$, with a single interior unknown $u^{H}$ at $x = 1/2$. The boundary nodes are $u^{H}_{0} = 0$ and $u^{H}_{2} = 0$.\n\nThe fine-grid discrete operator at an interior node $i$ is:\n$$\n\\left(N^{h}(u)\\right)_{i} = - \\frac{1}{h^2} \\left( a_{i+\\frac{1}{2}} (u_{i+1} - u_{i}) - a_{i-\\frac{1}{2}} (u_{i} - u_{i-1}) \\right)\n$$\nwhere $a_{i+\\frac{1}{2}} = 1 + \\left( \\frac{u_i + u_{i+1}}{2} \\right)^{2}$ and $1/h^2 = 1/(1/4)^2 = 16$.\n\nThe coarse-grid discrete operator for the single interior unknown $u^H$ is derived similarly. Let $u^H$ be the value at the center node.\n$$\nN^{H}(u^{H}) = - \\frac{1}{H^2} \\left( a_{1+\\frac{1}{2}}(u^{H}_{2} - u^{H}) - a_{1-\\frac{1}{2}}(u^{H} - u^{H}_{0}) \\right)\n$$\nWith $H=1/2$, $u^{H}_{0}=0$, $u^{H}_{2}=0$, the diffusivities become $a_{1+\\frac{1}{2}} = 1 + (\\frac{u^H+0}{2})^2$ and $a_{1-\\frac{1}{2}} = 1 + (\\frac{0+u^H}{2})^2$. Both are equal to $1 + \\frac{(u^H)^2}{4}$.\n$$\nN^{H}(u^{H}) = -4 \\left( \\left(1 + \\frac{(u^H)^2}{4}\\right)(0 - u^H) - \\left(1 + \\frac{(u^H)^2}{4}\\right)(u^H - 0) \\right) = -4 \\left( -2u^H \\left(1 + \\frac{(u^H)^2}{4}\\right) \\right) = 8u^H + 2(u^H)^3\n$$\nNow we execute the FAS V-cycle steps.\n\n**Step 1: Compute the fine-grid defect $d^{h} \\equiv f^{h} - N^{h}(\\tilde{u}^{h})$**\nThe initial iterate is $\\tilde{u}^{h} = (0,0,0)^{\\top}$. The boundary values are $\\tilde{u}_0 = 0$ and $\\tilde{u}_4 = 0$.\nThe face diffusivities are computed first:\n$$\na_{i+\\frac{1}{2}} = 1 + \\left( \\frac{\\tilde{u}_i + \\tilde{u}_{i+1}}{2} \\right)^2 = 1 + \\left( \\frac{0 + 0}{2} \\right)^2 = 1\n$$\nThis holds for all faces.\nThe discrete operator $N^{h}(\\tilde{u}^{h})$ is then evaluated for each interior node $i=1,2,3$:\n$$\n\\left(N^{h}(\\tilde{u}^{h})\\right)_{i} = -16 \\left( 1(\\tilde{u}_{i+1} - \\tilde{u}_i) - 1(\\tilde{u}_i - \\tilde{u}_{i-1}) \\right) = -16 \\left( 1(0 - 0) - 1(0 - 0) \\right) = 0\n$$\nThus, $N^{h}(\\tilde{u}^{h}) = (0,0,0)^{\\top}$.\nThe defect (or residual) is:\n$$\nd^{h} = f^{h} - N^{h}(\\tilde{u}^{h}) = (1,1,1)^{\\top} - (0,0,0)^{\\top} = (1,1,1)^{\\top}\n$$\n\n**Step 2: Restrict the state: $\\tilde{u}^{H} \\equiv R_{u}(\\tilde{u}^{h})$**\nThe state restriction operator $R_u$ is defined as injection: $R_{u}(\\tilde{u}^{h}) = \\tilde{u}_{2}$.\nApplying this to the current fine-grid iterate:\n$$\n\\tilde{u}^{H} = R_{u}\\left((0,0,0)^{\\top}\\right) = 0\n$$\n\n**Step 3: Form the FAS coarse right-hand side $f^{H}_{\\text{FAS}}$**\nThe coarse-grid equation is $N^H(u^H) = f^H_{\\text{FAS}}$, where the FAS right-hand side is defined as:\n$$\nf^{H}_{\\text{FAS}} = N^{H}(\\tilde{u}^{H}) + R_{r}(f^{h} - N^{h}(\\tilde{u}^{h})) = N^{H}(\\tilde{u}^{H}) + R_{r}(d^{h})\n$$\nWe evaluate each term on the right-hand side:\n- From Step 2, $\\tilde{u}^{H} = 0$. So, $N^{H}(\\tilde{u}^{H}) = N^{H}(0) = 8(0) + 2(0)^3 = 0$.\n- The residual restriction operator is one-dimensional full-weighting $R_{r}(r^{h}) = \\frac{1}{4} r^{h}_{1} + \\frac{1}{2} r^{h}_{2} + \\frac{1}{4} r^{h}_{3}$. From Step 1, $d^h=(1,1,1)^{\\top}$.\n$$\nR_{r}(d^{h}) = \\frac{1}{4}(1) + \\frac{1}{2}(1) + \\frac{1}{4}(1) = 1\n$$\nCombining these results gives the FAS right-hand side:\n$$\nf^{H}_{\\text{FAS}} = 0 + 1 = 1\n$$\nThe coarse-grid equation to be approximately solved is $N^{H}(u^{H}) = 1$, which is $8u^{H} + 2(u^{H})^3 = 1$.\n\n**Step 4: Apply one Newton step to the coarse equation to obtain $u^{H}$**\nWe solve $F^{H}(u^{H}) \\equiv 8u^{H} + 2(u^{H})^3 - 1 = 0$ using one step of Newton's method, starting from $u^{H}_{\\text{start}} = \\tilde{u}^H = 0$.\nThe Newton update rule is $u^{H}_{\\text{new}} = u^{H}_{\\text{old}} - \\frac{F^{H}(u^{H}_{\\text{old}})}{(F^{H})'(u^{H}_{\\text{old}})}$.\nThe derivative of $F^{H}$ is $(F^{H})'(u^{H}) = \\frac{d}{du^H}(8u^{H} + 2(u^{H})^3 - 1) = 8 + 6(u^{H})^2$.\nWe evaluate $F^H$ and its derivative at the starting point $u^{H}_{\\text{old}} = 0$:\n$$\nF^{H}(0) = 8(0) + 2(0)^3 - 1 = -1\n$$\n$$\n(F^{H})'(0) = 8 + 6(0)^2 = 8\n$$\nThe updated coarse-grid solution $u^H$ is:\n$$\nu^{H} = 0 - \\frac{-1}{8} = \\frac{1}{8}\n$$\n\n**Step 5: Compute the coarse correction $e^{H} \\equiv u^{H} - \\tilde{u}^{H}$**\nThe coarse-grid correction is the difference between the new coarse-grid solution and the restricted fine-grid solution:\n$$\ne^{H} = u^{H} - \\tilde{u}^{H} = \\frac{1}{8} - 0 = \\frac{1}{8}\n$$\n\n**Step 6: Prolongate the correction $e^{h} \\equiv P(e^{H})$ and update the fine-grid iterate**\nThe coarse correction $e^H$ is interpolated to the fine grid using the prolongation operator $P$. The application of $P$ to the coarse correction $e^H$ yields the fine-grid correction vector $e^h$:\n$$\ne^{h} = P(e^H) = P\\left(\\frac{1}{8}\\right) = \\left( \\frac{1}{2} e^{H}, \\; e^{H}, \\; \\frac{1}{2} e^{H} \\right)^{\\top} = \\left( \\frac{1}{2} \\cdot \\frac{1}{8}, \\; \\frac{1}{8}, \\; \\frac{1}{2} \\cdot \\frac{1}{8} \\right)^{\\top} = \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top}\n$$\nThe fine-grid iterate is then updated by adding this correction. This step injects the low-frequency error information, captured on the coarse grid, back into the fine-grid solution:\n$$\nu^{h,\\text{new}} = \\tilde{u}^{h} + e^{h}\n$$\n$$\nu^{h,\\text{new}} = (0, 0, 0)^{\\top} + \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top} = \\left( \\frac{1}{16}, \\frac{1}{8}, \\frac{1}{16} \\right)^{\\top}\n$$\nThe problem asks for the updated value at the central node $x = 1/2$, which corresponds to the second component of the vector $u^{h,\\text{new}}$. This value is $\\frac{1}{8}$.", "answer": "$$\n\\boxed{\\frac{1}{8}}\n$$", "id": "3357488"}]}