{"hands_on_practices": [{"introduction": "The advancing front method begins by generating mesh elements inward from the domain boundary. This first practice grounds you in the fundamental geometric operation of the algorithm: creating a new triangle from a boundary edge. You will calculate the position of an ideal new vertex based on a target mesh size and, critically, use the principle of oriented boundaries to ensure the mesh grows into the domain's interior, a core concept in computational geometry. [@problem_id:3361502]", "problem": "Consider the unit-square domain in the plane with vertices $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$ listed in counterclockwise order. An advancing front method (AFM) for mesh generation is to be initiated from the boundary to generate a triangular mesh suitable for the numerical solution of Partial Differential Equations (PDE). The prescribed uniform target mesh-size is $h=0.4$. In a uniform size field, the boundary is first discretized so that each active front edge has length less than or equal to the target size. Then, interior candidates are generated by perpendicular placement above active front edges to form approximately equilateral triangles.\n\nProceed as follows:\n- Discretize the bottom boundary edge from $(0,0)$ to $(1,0)$ into $N$ equal segments, where $N$ is the smallest positive integer for which each segment length is less than or equal to $h$.\n- Select the central segment of this discretization as the initial active front edge, and construct the first interior candidate point by placing it orthogonally to this edge at its midpoint, with the distance chosen so that the two new edges joining the candidate to the segment’s endpoints each have length exactly $h$. The orientation of the placement must be chosen to lie inside the domain.\n\nUsing only these principles, compute the Cartesian coordinates of this first interior candidate point. Justify the orientation choice from first principles of oriented boundaries and inward normals. Round your final coordinate values to four significant figures, and report them as an ordered pair $(x,y)$ without units.", "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in the field of computational geometry and numerical methods, well-posed with sufficient and consistent information to determine a unique solution, and objective in its language and formulation.\n\nThe problem asks for the Cartesian coordinates of the first interior candidate point generated by an Advancing Front Method (AFM) in a unit-square domain. The process is initiated from the bottom boundary.\n\nStep 1: Discretize the bottom boundary.\nThe bottom boundary of the unit square is the line segment from $P_1(0,0)$ to $P_2(1,0)$. The length of this segment is $L=1$. It is to be discretized into $N$ equal segments, where $N$ is the smallest positive integer such that the length of each segment, $s = L/N$, is less than or equal to the prescribed mesh-size $h=0.4$.\nWe must satisfy the inequality:\n$$s \\le h$$\n$$\\frac{1}{N} \\le 0.4$$\nSolving for $N$, we find:\n$$N \\ge \\frac{1}{0.4} = 2.5$$\nSince $N$ must be a positive integer, the smallest integer value for $N$ that satisfies this condition is $N=3$.\nThe length of each segment is $s = 1/3$. The boundary is discretized by the points $(0,0)$, $(1/3,0)$, $(2/3,0)$, and $(1,0)$. This creates three segments.\n\nStep 2: Identify the initial active front edge.\nThe problem specifies selecting the central segment of this discretization as the initial active front edge. With $N=3$ segments, the central segment is the second one. Its endpoints are $A = (1/3, 0)$ and $B = (2/3, 0)$. The length of this edge is $s = 2/3 - 1/3 = 1/3$.\n\nStep 3: Determine the placement and orientation of the candidate point.\nThe candidate point, let's call it $P_c(x_c, y_c)$, is to be constructed by placing it orthogonally to the active front edge $AB$ at its midpoint, $M$.\nThe midpoint $M$ of the segment $AB$ is:\n$$M = \\left( \\frac{x_A + x_B}{2}, \\frac{y_A + y_B}{2} \\right) = \\left( \\frac{1/3 + 2/3}{2}, \\frac{0 + 0}{2} \\right) = \\left( \\frac{1}{2}, 0 \\right)$$\nThe active front edge $AB$ lies on the x-axis. A vector tangent to this edge is $\\vec{T} = (1, 0)$. An orthogonal direction is therefore parallel to the y-axis, represented by the unit vectors $(0,1)$ or $(0,-1)$.\n\nThe orientation must be chosen so the point lies inside the domain. This is justified by considering the oriented boundary of the domain. The vertices are given in counterclockwise order: $(0,0) \\to (1,0) \\to (1,1) \\to (0,1)$. This defines a positive orientation for the boundary. For a positively oriented boundary in a 2D plane, the inward-pointing normal vector $\\vec{n}$ is obtained by rotating the tangent vector $\\vec{T}$ by an angle of $+\\pi/2$ radians (90 degrees counterclockwise).\nThe bottom edge is traversed from $(0,0)$ to $(1,0)$, so the tangent vector is in the direction of the positive x-axis, $\\vec{T}=(1,0)$. The rotation of a vector $(T_x, T_y)$ by $+\\pi/2$ is given by $(-T_y, T_x)$.\nApplying this transformation to $\\vec{T}$ gives the inward normal vector:\n$$\\vec{n} = (-0, 1) = (0,1)$$\nThis vector points in the positive y-direction, which is into the interior of the unit-square domain $[0,1] \\times [0,1]$. Thus, the candidate point $P_c$ must be placed \"above\" the midpoint $M$.\n\nStep 4: Calculate the coordinates of the candidate point.\nThe point $P_c$ is located at a a certain distance, let's call it $d$, from $M$ along the direction of $\\vec{n}$. Its coordinates will be $P_c = M + d\\vec{n} = (1/2, 0) + d(0,1) = (1/2, d)$.\nThe problem states that the two new edges, $AP_c$ and $BP_c$, must each have a length of exactly $h=0.4$. We can use the distance formula to find $d$. Let's consider the edge $AP_c$:\n$$|AP_c|^2 = (x_c - x_A)^2 + (y_c - y_A)^2 = h^2$$\n$$\\left(\\frac{1}{2} - \\frac{1}{3}\\right)^2 + (d - 0)^2 = (0.4)^2$$\nThe base of the triangle is $s = 1/3$. The distance from endpoint $A$ to the midpoint $M$ is $s/2 = 1/6$. The problem describes an isosceles triangle with endpoints $A$ and $B$ and apex $P_c$. The height of this triangle is $d$. We can form a right-angled triangle with vertices $A$, $M$, and $P_c$. The Pythagorean theorem gives:\n$$|AM|^2 + |MP_c|^2 = |AP_c|^2$$\n$$\\left(\\frac{1}{6}\\right)^2 + d^2 = (0.4)^2$$\nWe convert $0.4$ to a fraction, $0.4 = 4/10 = 2/5$.\n$$\\frac{1}{36} + d^2 = \\left(\\frac{2}{5}\\right)^2 = \\frac{4}{25}$$\nNow, we solve for $d^2$:\n$$d^2 = \\frac{4}{25} - \\frac{1}{36} = \\frac{4 \\times 36 - 1 \\times 25}{25 \\times 36} = \\frac{144 - 25}{900} = \\frac{119}{900}$$\nSince the point must be inside the domain, we take the positive root for $d$:\n$$d = \\sqrt{\\frac{119}{900}} = \\frac{\\sqrt{119}}{30}$$\nThe coordinates of the candidate point $P_c$ are $(x_c, y_c) = (1/2, d) = (1/2, \\frac{\\sqrt{119}}{30})$.\n\nStep 5: Final numerical calculation and rounding.\nThe problem requires the final coordinates to be rounded to four significant figures.\nThe x-coordinate is:\n$$x_c = \\frac{1}{2} = 0.5$$\nTo four significant figures, this is written as $0.5000$.\nThe y-coordinate is:\n$$y_c = \\frac{\\sqrt{119}}{30} \\approx \\frac{10.9087121}{30} \\approx 0.363623737$$\nRounding to four significant figures gives $0.3636$.\nThe coordinates of the first interior candidate point are $(0.5000, 0.3636)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5000 & 0.3636\n\\end{pmatrix}\n}\n$$", "id": "3361502"}, {"introduction": "As the advancing front progresses, it's essential to ensure that newly created elements do not overlap with existing ones, which would produce an invalid mesh. This exercise focuses on this critical validation step, introducing the orientation predicate from computational geometry as a robust tool for detecting segment intersections. Mastering this check is key to developing a reliable mesh generator that guarantees the integrity of the final grid. [@problem_id:3361452]", "problem": "In the Advancing Front Method (AFM) for unstructured mesh generation in the numerical solution of partial differential equations (PDEs), candidate front edges must be tested for non-intersection with existing edges to preserve mesh validity. Consider a two-dimensional advancing front step where two existing edges are present: the horizontal edge from $(0,0)$ to $(1,0)$ and the vertical edge from $(0.5,-0.5)$ to $(0.5,0.5)$. A candidate new point is proposed at $p=(0.5,0.3)$, and two new edges from $(0,0)$ to $p$ and from $(1,0)$ to $p$ are to be added.\n\nUsing only first principles from computational geometry (specifically the orientation predicate and the necessary and sufficient conditions for segment intersection), determine whether either proposed edge intersects the existing vertical edge from $(0.5,-0.5)$ to $(0.5,0.5)$. If at least one intersection occurs, provide the exact value of the $y$-coordinate of the intersection point on the vertical segment $x=0.5$. If no intersection occurs, report $0$. Express your final answer as a single real number; do not round.", "solution": "The validity of the problem statement is established. The problem is scientifically grounded in computational geometry, is well-posed, and all necessary data are provided. We proceed with a solution based on first principles.\n\nThe problem asks to determine if either of two proposed edges intersect an existing edge in a two-dimensional domain. Let the points be defined as follows: $A = (0,0)$, $B = (1,0)$, $C = (0.5, -0.5)$, $D = (0.5, 0.5)$, and the proposed new point $p = (0.5, 0.3)$.\nThe existing edges mentioned are $\\overline{AB}$ and $\\overline{CD}$. The problem specifies we must test for intersection with the vertical edge, which is the segment $\\overline{CD}$.\nThe two proposed new edges are $\\overline{Ap}$ and $\\overline{Bp}$.\n\nThe standard method for determining if two line segments, say $\\overline{P_1P_2}$ and $\\overline{P_3P_4}$, intersect is to use an orientation predicate. The orientation of an ordered triplet of points $(p_1, p_2, p_3)$ with coordinates $p_1=(x_1, y_1)$, $p_2=(x_2, y_2)$, and $p_3=(x_3, y_3)$ is given by the sign of the determinant:\n$$ \\text{orientation}(p_1, p_2, p_3) = \\det \\begin{pmatrix} x_2 - x_1 & y_2 - y_1 \\\\ x_3 - x_1 & y_3 - y_1 \\end{pmatrix} = (x_2 - x_1)(y_3 - y_1) - (x_3 - x_1)(y_2 - y_1) $$\nA positive value indicates a counter-clockwise turn (or `left turn`) at $p_2$ going from $p_1$ to $p_3$. A negative value indicates a clockwise turn (`right turn`). A value of zero indicates that the three points are collinear.\n\nTwo segments $\\overline{P_1P_2}$ and $\\overline{P_3P_4}$ intersect if and only if one of two conditions is met:\n1.  **General Case:** The endpoints of each segment lie on opposite sides of the line containing the other segment. This is true if $\\text{orientation}(P_1, P_2, P_3)$ and $\\text{orientation}(P_1, P_2, P_4)$ have different signs, AND $\\text{orientation}(P_3, P_4, P_1)$ and $\\text{orientation}(P_3, P_4, P_2)$ have different signs.\n2.  **Special Case (Collinear):** An endpoint of one segment lies on the other segment. This occurs if one of the orientation tests yields zero, and a point is shown to lie within the bounding box of a segment with which it is collinear.\n\nWe will test each proposed edge for intersection with the existing vertical edge $\\overline{CD}$.\n\n**Test 1: Intersection of proposed edge $\\overline{Ap}$ with existing edge $\\overline{CD}$**\n\nLet $P_1 = A = (0,0)$, $P_2 = p = (0.5, 0.3)$.\nLet $P_3 = C = (0.5, -0.5)$, $P_4 = D = (0.5, 0.5)$.\n\nWe check the orientation of the endpoints of $\\overline{CD}$ with respect to the line containing $\\overline{Ap}$.\n$$ \\text{orientation}(A, p, C) = (0.5 - 0)(-0.5 - 0) - (0.5 - 0)(0.3 - 0) = (0.5)(-0.5) - (0.5)(0.3) = -0.25 - 0.15 = -0.4 $$\n$$ \\text{orientation}(A, p, D) = (0.5 - 0)(0.5 - 0) - (0.5 - 0)(0.3 - 0) = (0.5)(0.5) - (0.5)(0.3) = 0.25 - 0.15 = 0.1 $$\nSince the signs are different (one is negative, one is positive), the segment $\\overline{CD}$ straddles the line containing $\\overline{Ap}$.\n\nNext, we check the orientation of the endpoints of $\\overline{Ap}$ with respect to the line containing $\\overline{CD}$.\n$$ \\text{orientation}(C, D, A) = (0.5 - 0.5)(0 - (-0.5)) - (0 - 0.5)(0.5 - (-0.5)) = (0)(0.5) - (-0.5)(1) = 0.5 $$\n$$ \\text{orientation}(C, D, p) = (0.5 - 0.5)(0.3 - (-0.5)) - (0.5 - 0.5)(0.5 - (-0.5)) = (0)(0.8) - (0)(1) = 0 $$\nThe orientation for the triplet $(C, D, p)$ is zero. This indicates a special case: the points $C$, $D$, and $p$ are collinear. Since $p$ is an endpoint of the segment $\\overline{Ap}$, we must check if $p$ lies on the segment $\\overline{CD}$.\nFor a point $p=(x_p, y_p)$ to be on the segment $\\overline{CD}$ with endpoints $C=(x_C, y_C)$ and $D=(x_D, y_D)$, its coordinates must satisfy:\n$x_p \\in [\\min(x_C, x_D), \\max(x_C, x_D)]$ and $y_p \\in [\\min(y_C, y_D), \\max(y_C, y_D)]$.\nHere, $p=(0.5, 0.3)$, $C=(0.5, -0.5)$, and $D=(0.5, 0.5)$.\nFor the $x$-coordinate: $0.5 \\in [\\min(0.5, 0.5), \\max(0.5, 0.5)]$, which is $0.5 \\in [0.5, 0.5]$. This is true.\nFor the $y$-coordinate: $0.3 \\in [\\min(-0.5, 0.5), \\max(-0.5, 0.5)]$, which is $0.3 \\in [-0.5, 0.5]$. This is also true.\nTherefore, the point $p$ lies on the segment $\\overline{CD}$.\nSince $p$ is an endpoint of $\\overline{Ap}$ and also lies on $\\overline{CD}$, the two segments intersect at point $p = (0.5, 0.3)$.\n\n**Test 2: Intersection of proposed edge $\\overline{Bp}$ with existing edge $\\overline{CD}$**\n\nLet $P_1 = B = (1,0)$, $P_2 = p = (0.5, 0.3)$.\nLet $P_3 = C = (0.5, -0.5)$, $P_4 = D = (0.5, 0.5)$.\n\nThe analysis is analogous. The point $p$ is an endpoint of the proposed segment $\\overline{Bp}$. From the previous test, we have already proven that the point $p$ lies on the existing segment $\\overline{CD}$. By definition, if two segments share a point, they intersect. The intersection point is again $p=(0.5, 0.3)$.\nTherefore, the second proposed edge $\\overline{Bp}$ also intersects the existing vertical edge $\\overline{CD}$.\n\n**Conclusion**\n\nAt least one intersection occurs; in fact, both proposed edges intersect the existing vertical edge $\\overline{CD}$. The intersection point for both is the same point $p = (0.5, 0.3)$. The problem asks for the $y$-coordinate of the intersection point.\nThe $y$-coordinate of $p$ is $0.3$.\nIf no intersection had occurred, the answer would be $0$. Since an intersection is found, the answer is the $y$-coordinate of the intersection point.\nFinal answer is $0.3$.", "answer": "$$\\boxed{0.3}$$", "id": "3361452"}, {"introduction": "Many physical problems require meshes with elements that are stretched or refined in specific directions. This practice introduces anisotropic meshing, where geometric rules are governed by a metric tensor $M$ instead of standard Euclidean geometry. You will apply the concepts of metric-based distance and $M$-orthogonality to place a new vertex, learning how the advancing front method can be generalized to produce high-quality, directionally-sensitive meshes for complex simulations. [@problem_id:3361486]", "problem": "In anisotropic advancing-front mesh generation for the numerical solution of partial differential equations (PDE), a common vertex-placement rule is to position a new vertex across an active front edge along the line that is orthogonal in the metric to the edge and passes through the edge’s midpoint, at a prescribed metric altitude. Let the Riemannian metric be constant and represented by the symmetric positive-definite tensor $M \\in \\mathbb{R}^{2 \\times 2}$. The metric-induced distance between two points $a,b \\in \\mathbb{R}^{2}$ is defined by $d_{M}(a,b) = \\sqrt{(a-b)^{\\top} M (a-b)}$, and a vector $n$ is $M$-orthogonal to a nonzero vector $t$ if $n^{\\top} M t = 0$. The metric altitude from a point $p$ to a line $\\ell$ is the minimal value of $d_{M}(p,q)$ over all $q \\in \\ell$.\n\nConsider the front edge with endpoints $p_{0} = (0,0)$ and $p_{1} = (1,0)$ in $\\mathbb{R}^{2}$, and the constant metric tensor $M = \\mathrm{diag}(4,1)$. Construct the point $p$ that lies on the $M$-orthogonal line to the edge through the Euclidean midpoint of the edge and is located “above” the edge (meaning it has positive Euclidean $y$-coordinate), such that the metric altitude from $p$ to the supporting line of the edge equals the prescribed value $h_{M} = 1$.\n\nExpress your answer as the coordinate row vector $(x \\;\\; y)$ using standard Cartesian coordinates. No rounding is required.", "solution": "We start from the core definitions of a Riemannian metric for anisotropic meshing. The metric-induced distance between two points $a,b \\in \\mathbb{R}^{2}$ is $d_{M}(a,b) = \\sqrt{(a-b)^{\\top} M (a-b)}$ for a symmetric positive-definite tensor $M$. A vector $n$ is $M$-orthogonal to a vector $t$ if $n^{\\top} M t = 0$. The metric altitude from a point $p$ to a line $\\ell$ is the minimum metric distance from $p$ to any point on $\\ell$.\n\nGiven $p_0 = (0,0)$ and $p_1 = (1,0)$, the edge is the horizontal segment on the $x$-axis from $x=0$ to $x=1$. Its supporting line is the $x$-axis $\\{(x,0): x \\in \\mathbb{R}\\}$. The Euclidean midpoint of the edge is $m = \\left(\\frac{1}{2}, 0\\right)$. The edge direction (tangent) vector is $t = p_1 - p_0 = (1,0)$.\n\nThe metric is $M = \\mathrm{diag}(4,1)$. To find the $M$-orthogonal direction to the edge, we require a vector $n = (n_x, n_y)$ such that $n^{\\top} M t = 0$. Compute\n$$\nn^{\\top} M t = \\begin{pmatrix} n_x & n_y \\end{pmatrix}\n\\begin{pmatrix} 4 & 0 \\\\ 0 & 1 \\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n= \\begin{pmatrix} n_x & n_y \\end{pmatrix}\n\\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}\n= 4 n_x.\n$$\nThus the $M$-orthogonality condition $n^{\\top} M t = 0$ yields $n_x = 0$. Therefore any $M$-orthogonal direction to the edge is of the form $n = (0, \\alpha)$ with $\\alpha \\neq 0$, which is parallel to the Euclidean $y$-axis. The $M$-orthogonal line through the midpoint $m$ is then the vertical line $x = \\frac{1}{2}$.\n\nWe now impose the metric altitude requirement. Let $p = (x,y)$ be any point. Its metric altitude to the supporting line $\\{(s,0): s \\in \\mathbb{R}\\}$ is\n$$\n\\min_{s \\in \\mathbb{R}} d_{M}\\big( (x,y), (s,0) \\big)\n= \\min_{s \\in \\mathbb{R}} \\sqrt{ \\big( (x - s, y) \\big)^{\\top} M \\big( (x - s, y) \\big) }.\n$$\nWith $M = \\mathrm{diag}(4,1)$, the squared metric distance is\n$$\n\\big( (x - s, y) \\big)^{\\top} \\begin{pmatrix} 4 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} x - s \\\\ y \\end{pmatrix}\n= 4 (x - s)^{2} + y^{2}.\n$$\nMinimizing over $s$ is a univariate quadratic minimization; the minimum occurs at $s = x$, yielding the minimal squared distance $y^{2}$. Hence the metric altitude from $(x,y)$ to the supporting line equals $|y|$:\n$$\n\\min_{s \\in \\mathbb{R}} d_{M}\\big( (x,y), (s,0) \\big) = \\sqrt{y^{2}} = |y|.\n$$\n\nWe seek the point on the $M$-orthogonal line through $m$ with altitude $h_M = 1$ and positive Euclidean $y$-coordinate (“above” the edge). Enforcing $x = \\frac{1}{2}$ and $|y| = 1$ with $y > 0$ gives $y = 1$. Therefore\n$$\np = \\left( \\frac{1}{2}, 1 \\right).\n$$\nThis construction satisfies all requirements: it lies on the $M$-orthogonal line through the midpoint and has metric altitude $1$ to the supporting line, with a positive $y$-coordinate.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & 1 \\end{pmatrix}}$$", "id": "3361486"}]}