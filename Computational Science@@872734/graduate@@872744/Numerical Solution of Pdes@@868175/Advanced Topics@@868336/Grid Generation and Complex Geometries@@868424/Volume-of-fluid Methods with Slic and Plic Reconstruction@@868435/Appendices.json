{"hands_on_practices": [{"introduction": "Mastering Volume-of-Fluid methods begins with a solid grasp of how fluid is transported between computational cells. This first exercise provides a concrete, step-by-step walkthrough of calculating advective flux using the Simple Line Interface Calculation (SLIC) method. By working through this problem, you will see how the volume fraction $\\alpha$ in an upwind cell is used to reconstruct a simple, axis-aligned interface and subsequently determine the volume of fluid that crosses a cell face over a given time step [@problem_id:3461623].", "problem": "Consider a two-dimensional incompressible advection of a binary fluid represented by a Volume of Fluid (VOF) indicator function. Let the indicator function be denoted by $H(x,y,t)$, with $H=1$ in the liquid and $H=0$ in the gas. The VOF fraction in a cell is $\\alpha=\\frac{1}{\\Delta x\\,\\Delta y}\\iint_{\\text{cell}} H(x,y,t)\\,dx\\,dy$. An $x$-direction operator-split advection step is performed with a uniform, constant velocity field $u>0$ during the time interval $[t^n,t^{n}+\\Delta t]$ such that the Courant–Friedrichs–Lewy (CFL) number $\\lambda = \\frac{u\\,\\Delta t}{\\Delta x}$ is prescribed.\n\nA $2\\times 2$ block of square Cartesian cells of size $\\Delta x=\\Delta y=1.0\\,\\text{m}$ is considered. Index the columns by $i=0$ (left) and $i=1$ (right), and the rows by $j=1$ (bottom) and $j=2$ (top). The central vertical face is the face at $x=\\Delta x$ separating the left and right columns and spanning both rows. The VOF values at time $t^n$ are:\n- $\\alpha_{0,1}=0.85$, $\\alpha_{0,2}=0.75$ in the left column,\n- $\\alpha_{1,1}=0.10$, $\\alpha_{1,2}=0.00$ in the right column.\n\nDuring the $x$-sweep, adopt the Simple Line Interface Calculation (SLIC) reconstruction: in each cell, the interface is approximated as a vertical segment, and the liquid region is a contiguous vertical slab of width $s_j=\\alpha_{0,j}\\,\\Delta x$ attached to the upwind (left) face for $u>0$, independent for each row $j$.\n\nThe CFL number is given as $\\lambda=\\frac{u\\,\\Delta t}{\\Delta x}=0.35$. Using only the stated assumptions and definitions, determine the Simple Line Interface Calculation (SLIC)-predicted total liquid volume per unit depth transported through the central vertical face over the time step $\\Delta t$ (i.e., the time-integrated flux across that face), summing the contributions of both rows. Express your final answer in square meters per unit depth and round your result to four significant figures.", "solution": "The user wants me to solve a fluid dynamics problem related to the Volume of Fluid (VOF) method.\n\nHere's my plan:\n1.  **Validate the problem statement.** I'll break down the problem into its given components and check for scientific soundness, completeness, and clarity.\n2.  **Understand the core concepts.**\n    *   **VOF Method:** A numerical technique for tracking and locating the free surface or fluid-fluid interface. It uses a scalar function, the VOF fraction $\\alpha$, which is the fraction of a computational cell filled with one of the fluids.\n    *   **Operator Splitting:** The multi-dimensional advection equation is split into a sequence of one-dimensional advection problems. Here, we are only concerned with the $x$-direction sweep.\n    *   **SLIC (Simple Line Interface Calculation):** A specific method for reconstructing the interface within a cell based on its VOF fraction $\\alpha$. The problem explicitly states how to apply SLIC: the interface is a vertical line, and the fluid forms a vertical slab attached to the upwind face.\n    *   **Flux Calculation:** The goal is to find the total volume of liquid transported across a specific face over a time step. This is the time-integrated flux.\n\n3.  **Deconstruct the problem step-by-step.**\n    *   **Problem Setup:**\n        *   2D, incompressible advection.\n        *   VOF indicator function $H$.\n        *   VOF fraction $\\alpha$ in a cell.\n        *   $x$-direction operator-split advection step.\n        *   Uniform, constant velocity $u > 0$.\n        *   Time interval $[t^n, t^n + \\Delta t]$.\n        *   CFL number: $\\lambda = u \\Delta t / \\Delta x = 0.35$.\n        *   Grid: 2x2 block of square cells.\n        *   Cell size: $\\Delta x = \\Delta y = 1.0$ m.\n        *   Cell indexing: $i$ for columns (0, 1), $j$ for rows (1, 2).\n        *   VOF values at $t^n$:\n            *   $\\alpha_{0,1} = 0.85$\n            *   $\\alpha_{0,2} = 0.75$\n            *   $\\alpha_{1,1} = 0.10$\n            *   $\\alpha_{1,2} = 0.00$\n        *   Target face: Central vertical face at $x = \\Delta x$. This is the interface between cells $(0,j)$ and $(1,j)$.\n    *   **SLIC Reconstruction:**\n        *   The problem specifies the reconstruction for the *upwind* cells, which are the cells in column $i=0$ since $u > 0$.\n        *   For each row $j$, the interface in cell $(0,j)$ is a vertical segment.\n        *   The liquid region is a contiguous vertical slab of width $s_j = \\alpha_{0,j} \\Delta x$.\n        *   This slab is attached to the upwind (left) face of the cell.\n    *   **Flux Calculation:**\n        *   The amount of fluid advected from cell $(0,j)$ into cell $(1,j)$ during the time step $\\Delta t$ is the volume of fluid in cell $(0,j)$ that crosses the face at $x = \\Delta x$.\n        *   The advection distance is $u \\Delta t$.\n        *   The CFL number $\\lambda = u \\Delta t / \\Delta x$ gives this distance as a fraction of the cell width: $u \\Delta t = \\lambda \\Delta x$.\n        *   The volume that will be advected across the face is the volume contained in a \"flux box\" of width $u \\Delta t$ and height $\\Delta y$, located at the downwind side of the upwind cell.\n        *   I need to calculate the volume of liquid within this flux box for each row $j$ and then sum them.\n\n4.  **Execute the calculations.**\n    *   **Cell geometry:**\n        *   $\\Delta x = 1.0$\n        *   $\\Delta y = 1.0$\n    *   **Advection distance:**\n        *   $\\lambda = 0.35$\n        *   Advection distance $d = u \\Delta t = \\lambda \\Delta x = 0.35 \\times 1.0 = 0.35$.\n    *   **Consider Row $j=1$:**\n        *   Upwind cell is $(0,1)$. VOF fraction is $\\alpha_{0,1} = 0.85$.\n        *   SLIC reconstruction: The liquid forms a vertical slab of width $s_1 = \\alpha_{0,1} \\Delta x = 0.85 \\times 1.0 = 0.85$.\n        *   The slab is attached to the left face of the cell, so it occupies the region $0 \\le x  0.85$ within the cell $(0,1)$ (assuming the cell spans $0 \\le x \\le \\Delta x=1$).\n        *   The \"flux box\" is the region that will cross the face at $x=\\Delta x=1$. This is the region $(\\Delta x - u \\Delta t) \\le x  \\Delta x$ within the upwind cell $(0,1)$.\n        *   The flux box is $(1.0 - 0.35) \\le x  1.0$, which is a region of width $0.35$ at the right edge of cell $(0,1)$.\n        *   The liquid slab is from $x=0$ to $x=0.85$.\n        *   The flux box is from $x=0.65$ to $x=1.0$.\n        *   The overlap between the liquid slab and the flux box is the region from $x=0.65$ to $x=0.85$.\n        *   The width of this overlap is $0.85 - 0.65 = 0.20$.\n        *   The volume of liquid fluxed from cell $(0,1)$ is this overlap width multiplied by the cell height $\\Delta y$.\n        *   Volume Flux $V_1 = (0.20) \\times \\Delta y = 0.20 \\times 1.0 = 0.20$ m$^2$.\n    *   **Consider Row $j=2$:**\n        *   Upwind cell is $(0,2)$. VOF fraction is $\\alpha_{0,2} = 0.75$.\n        *   SLIC reconstruction: The liquid forms a vertical slab of width $s_2 = \\alpha_{0,2} \\Delta x = 0.75 \\times 1.0 = 0.75$.\n        *   The slab is attached to the left face, occupying $0 \\le x  0.75$ within cell $(0,2)$.\n        *   The flux box is the same as before: the region $(\\Delta x - u \\Delta t) \\le x  \\Delta x$, which is $0.65 \\le x  1.0$.\n        *   The overlap between the liquid slab and the flux box is the region from $x=0.65$ to $x=0.75$.\n        *   The width of this overlap is $0.75 - 0.65 = 0.10$.\n        *   The volume of liquid fluxed from cell $(0,2)$ is this overlap width multiplied by the cell height $\\Delta y$.\n        *   Volume Flux $V_2 = (0.10) \\times \\Delta y = 0.10 \\times 1.0 = 0.10$ m$^2$.\n    *   **Total Flux:**\n        *   The total liquid volume transported is the sum of the fluxes from both rows.\n        *   $V_{\\text{total}} = V_1 + V_2 = 0.20 + 0.10 = 0.30$.\n        *   The question asks for the answer in square meters per unit depth and rounded to four significant figures. `0.3000`.\n\n5.  **Formalize the solution.**\nThe transported volume for row $j$ is $\\mathcal{V}_j = \\Delta x \\Delta y \\max(0, \\alpha_{0,j} - 1 + \\lambda)$.\n*   **For row $j=1$:** $\\alpha_{0,1} = 0.85$.\n    $\\mathcal{V}_1 = (1.0)(1.0) \\max(0, 0.85 - 1 + 0.35) = \\max(0, 0.20) = 0.20$ m$^2$.\n*   **For row $j=2$:** $\\alpha_{0,2} = 0.75$.\n    $\\mathcal{V}_2 = (1.0)(1.0) \\max(0, 0.75 - 1 + 0.35) = \\max(0, 0.10) = 0.10$ m$^2$.\n*   **Total transported volume:** $\\mathcal{V}_{\\text{total}} = \\mathcal{V}_1 + \\mathcal{V}_2 = 0.20 + 0.10 = 0.30$ m$^2$.\n*   **Rounding:** To four significant figures, the answer is `0.3000`.", "answer": "$$\n\\boxed{0.3000}\n$$", "id": "3461623"}, {"introduction": "While SLIC offers a straightforward approach, its accuracy is limited by restricting interfaces to be axis-aligned. The Piecewise Linear Interface Calculation (PLIC) method significantly improves accuracy by allowing the interface to be an arbitrarily oriented line. This hands-on coding practice challenges you to implement the core geometric engine of PLIC: given a volume fraction $\\alpha$ and an interface normal vector $\\mathbf{n}$, your task is to find the precise position of the line, defined by an intercept $\\alpha_p$, that correctly partitions the cell [@problem_id:3461601]. This involves combining a robust geometric clipping algorithm with a numerical root-finding method, providing deep insight into the implementation of modern VOF schemes.", "problem": "You are given a two-dimensional Volume-of-Fluid (VOF) reconstruction problem in a single unit cell. The reconstructed interface in a Piecewise Linear Interface Calculation (PLIC) is represented by a straight line with normal vector $\\mathbf{n}\\in\\mathbb{R}^2$ and intercept parameter $\\alpha_p\\in\\mathbb{R}$ through the implicit equation $\\mathbf{n}\\cdot\\mathbf{x}=\\alpha_p$. The liquid region is defined as the half-space $\\{\\mathbf{x}\\in[0,1]^2:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha_p\\}$. The liquid volume fraction $\\alpha$ in the unit cell is the area of this half-space intersected with the unit square, divided by the cell area. In a Simple Line Interface Calculation (SLIC), the reconstruction is restricted to axis-aligned cuts as a special case of the above with $\\mathbf{n}$ aligned with a coordinate axis.\n\nStarting from first principles and core definitions:\n- The VOF fraction $\\alpha$ in a unit square is the area of the region $\\{\\mathbf{x}\\in[0,1]^2:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha_p\\}$.\n- The area function $A(\\alpha_p):=\\text{area}(\\{\\mathbf{x}\\in[0,1]^2:\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha_p\\})$ is continuous and nondecreasing in $\\alpha_p$ for any fixed nonzero $\\mathbf{n}$.\n- The minimum and maximum values of the linear functional $\\mathbf{n}\\cdot\\mathbf{x}$ over the convex polygon $[0,1]^2$ occur at the corners, so the physically relevant range of $\\alpha_p$ is $[\\alpha_{p,\\min},\\alpha_{p,\\max}]$, where $\\alpha_{p,\\min}=\\min_{\\mathbf{v}\\in\\{(0,0),(1,0),(1,1),(0,1)\\}}\\mathbf{n}\\cdot\\mathbf{v}$ and $\\alpha_{p,\\max}=\\max_{\\mathbf{v}\\in\\{(0,0),(1,0),(1,1),(0,1)\\}}\\mathbf{n}\\cdot\\mathbf{v}$. These satisfy $A(\\alpha_{p,\\min})=0$ and $A(\\alpha_{p,\\max})=1$.\n- The VOF reconstruction constraint is $A(\\alpha_p)=\\alpha$.\n\nYour task is to implement a program that, for each test case, computes the corresponding intercept parameter $\\alpha_p$ such that $A(\\alpha_p)=\\alpha$. You must compute $A(\\alpha_p)$ exactly by evaluating the area of the polygon obtained from clipping the unit square with the half-space $\\mathbf{n}\\cdot\\mathbf{x}\\le \\alpha_p$; do not use any pre-tabulated formulas or shortcut expressions. You should use a robust polygon-halfspace clipping procedure and a root-finding method that exploits the monotonicity of $A(\\alpha_p)$, such as bisection, on the interval $[\\alpha_{p,\\min},\\alpha_{p,\\max}]$. For boundary cases $\\alpha=0$ or $\\alpha=1$, return $\\alpha_p=\\alpha_{p,\\min}$ and $\\alpha_p=\\alpha_{p,\\max}$, respectively, to ensure uniqueness.\n\nRequirements:\n- The input for each test consists of a normal vector $\\mathbf{n}=(n_x,n_y)$, where $n_x$ and $n_y$ are real numbers that may be positive, negative, or zero, and a target volume fraction $\\alpha\\in[0,1]$.\n- You must compute $\\alpha_p$ such that $A(\\alpha_p)=\\alpha$ as described above, and report it rounded to three significant digits.\n- Angles are not involved. There are no physical units in this problem.\n- The algorithm must work for arbitrary nonzero $\\mathbf{n}$ (not necessarily normalized).\n\nTest Suite:\nFor each of the following test cases, compute and output $\\alpha_p$ rounded to three significant digits, using standard rounding to nearest and breaking ties away from zero. The six cases are:\n1. $\\mathbf{n}=(0.6,0.8)$, $\\alpha=0.65$.\n2. $\\mathbf{n}=(1.0,0.0)$, $\\alpha=0.3$.\n3. $\\mathbf{n}=(0.0,-1.0)$, $\\alpha=0.3$.\n4. $\\mathbf{n}=(-0.6,0.8)$, $\\alpha=0.25$.\n5. $\\mathbf{n}=(-1.0,-2.0)$, $\\alpha=0.0$.\n6. $\\mathbf{n}=(0.2,-0.7)$, $\\alpha=1.0$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each number rounded to three significant digits and expressed in fixed-point notation (no exponent notation). For example, a valid output would look like \"[0.820,0.300,-0.700,-0.110,-3.00,0.200]\".", "solution": "The problem is well-defined and requires the development of a numerical procedure to solve for the intercept parameter $\\alpha_p$ of a line that partitions a unit square into two regions with a specific area ratio. This is a fundamental geometric problem in the context of Volume-of-Fluid (VOF) methods, specifically for Piecewise Linear Interface Calculation (PLIC).\n\nThe problem asks to find $\\alpha_p \\in \\mathbb{R}$ for a given normal vector $\\mathbf{n} \\in \\mathbb{R}^2$ and a volume fraction $\\alpha \\in [0,1]$ such that the area of the region $\\{\\mathbf{x} \\in [0,1]^2 : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha_p\\}$ is equal to $\\alpha$. Since the area of the unit cell $[0,1]^2$ is $1$, this area is numerically equal to the volume fraction $\\alpha$.\n\nLet us define the area function $A(\\alpha_p)$ as:\n$$A(\\alpha_p) = \\text{area}(\\{\\mathbf{x} \\in [0,1]^2 : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha_p\\})$$\nOur goal is to solve the equation $A(\\alpha_p) = \\alpha$ for $\\alpha_p$.\n\n**1. Properties of the Area Function and Bisection Method**\n\nThe function $\\mathbf{n} \\cdot \\mathbf{x}$ is a linear functional on $\\mathbb{R}^2$. The region $\\{\\mathbf{x} : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha_p\\}$ is a half-plane. As $\\alpha_p$ increases, this half-plane expands, and therefore the area of its intersection with the fixed unit square, $A(\\alpha_p)$, is a continuous and monotonically non-decreasing function of $\\alpha_p$.\n\nThe minimum and maximum values of the linear functional $\\mathbf{n} \\cdot \\mathbf{x}$ over the convex set $[0,1]^2$ occur at its vertices, which are $\\mathbf{v}_1=(0,0)$, $\\mathbf{v}_2=(1,0)$, $\\mathbf{v}_3=(1,1)$, and $\\mathbf{v}_4=(0,1)$. Let us define:\n$$\\alpha_{p,\\min} = \\min_{i \\in \\{1,2,3,4\\}} (\\mathbf{n} \\cdot \\mathbf{v}_i)$$\n$$\\alpha_{p,\\max} = \\max_{i \\in \\{1,2,3,4\\}} (\\mathbf{n} \\cdot \\mathbf{v}_i)$$\nFor any $\\alpha_p  \\alpha_{p,\\min}$, the half-plane does not intersect the unit square, so $A(\\alpha_p) = 0$. For any $\\alpha_p > \\alpha_{p,\\max}$, the half-plane completely contains the unit square, so $A(\\alpha_p) = 1$. The relevant range for $\\alpha_p$ is thus $[\\alpha_{p,\\min}, \\alpha_{p,\\max}]$.\n\nThe monotonic nature of $A(\\alpha_p)$ on $[\\alpha_{p,\\min}, \\alpha_{p,\\max}]$ makes the bisection method an ideal choice for solving $A(\\alpha_p) - \\alpha = 0$.\nThe algorithm is as follows:\n1.  Establish the search interval $[\\alpha_{p,low}, \\alpha_{p,high}] = [\\alpha_{p,\\min}, \\alpha_{p,\\max}]$.\n2.  If the target volume fraction $\\alpha$ is $0$ or $1$, the solution is $\\alpha_p = \\alpha_{p,\\min}$ or $\\alpha_p = \\alpha_{p,\\max}$ respectively, as stipulated.\n3.  For $\\alpha \\in (0,1)$, repeatedly bisect the interval:\n    a. Calculate the midpoint $\\alpha_{p,mid} = (\\alpha_{p,low} + \\alpha_{p,high})/2$.\n    b. Compute the area $A_{mid} = A(\\alpha_{p,mid})$.\n    c. If $A_{mid}  \\alpha$, the root must lie in the upper half of the interval, so we set $\\alpha_{p,low} = \\alpha_{p,mid}$.\n    d. If $A_{mid} \\ge \\alpha$, the root must lie in the lower half, so we set $\\alpha_{p,high} = \\alpha_{p,mid}$.\n4.  This process is iterated a sufficient number of times (e.g., $100$) to achieve high precision. The final estimate for $\\alpha_p$ is the midpoint of the final interval.\n\n**2. Geometric Calculation of the Area $A(\\alpha_p)$**\n\nThe core of the problem is the computation of $A(\\alpha_p)$ for a given $\\alpha_p$. This involves two computational geometry steps: clipping a polygon by a half-space and calculating the area of the resulting polygon.\n\n**2.1. Polygon Clipping**\nThe region $\\{\\mathbf{x} \\in [0,1]^2 : \\mathbf{n} \\cdot \\mathbf{x} \\le \\alpha_p\\}$ is a convex polygon. Its vertices are found by clipping the unit square against the half-space defined by the line $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha_p$. The Sutherland-Hodgman algorithm is a robust method for this task.\n\nThe algorithm processes each edge of the subject polygon (the unit square) against the clipping line. For an edge from vertex $S$ to vertex $P$:\n- If both $S$ and $P$ are inside the half-space ($\\mathbf{n}\\cdot\\mathbf{x} - \\alpha_p \\le 0$), vertex $P$ is added to the output vertex list.\n- If $S$ is inside and $P$ is outside, their intersection point with the line $\\mathbf{n}\\cdot\\mathbf{x} = \\alpha_p$ is calculated and added to the output list.\n- If both $S$ and $P$ are outside, no vertex is added.\n- If $S$ is outside and $P$ is inside, their intersection point is added, followed by vertex $P$.\n\nThe intersection point $I$ of a line segment between points $S$ and $P$ with the line $\\mathbf{n} \\cdot \\mathbf{x} = \\alpha_p$ can be found parametrically. Let the segment be $\\mathbf{x}(t) = S + t(P-S)$ for $t \\in [0,1]$. The intersection occurs at $t$ where $\\mathbf{n} \\cdot (S + t(P-S)) = \\alpha_p$, which gives:\n$$t = \\frac{\\alpha_p - \\mathbf{n} \\cdot S}{\\mathbf{n} \\cdot (P-S)}$$\nThe intersection point is $I = S + t(P-S)$. This process yields an ordered list of vertices for the clipped polygon.\n\n**2.2. Polygon Area Calculation**\nGiven the ordered vertices $(x_1, y_1), (x_2, y_2), \\dots, (x_k, y_k)$ of the resulting convex polygon, its area is computed exactly using the Shoelace (or Surveyor's) formula:\n$$ \\text{Area} = \\frac{1}{2} \\left| \\sum_{i=1}^{k} (x_i y_{i+1} - x_{i+1} y_i) \\right| $$\nwhere $(x_{k+1}, y_{k+1}) = (x_1, y_1)$.\n\n**3. Final Processing**\nThe final computed value of $\\alpha_p$ is rounded to three significant digits. The problem specifies standard rounding where ties are broken away from zero. A custom function is implemented to handle this, as standard Python `round()` may round to the nearest even number. The result is then formatted to a fixed-point notation that correctly reflects the three significant digits.", "answer": "[0.820,0.300,-0.700,-0.110,-3.00,0.200]", "id": "3461601"}, {"introduction": "After learning the mechanics of interface reconstruction, it is crucial to understand the physical consequences of the inherent numerical errors. In simulations where surface tension is dominant, even small inaccuracies in representing the interface curvature can lead to significant, unphysical fluid motions known as \"spurious currents.\" This final practice guides you through a theoretical analysis to estimate the magnitude of these spurious velocities [@problem_id:3461573]. By balancing the residual capillary forces arising from curvature error with viscous stresses, you will derive a scaling law that connects grid resolution $h$ and drop radius $R$ to the velocity of these parasitic flows, a critical consideration for validating and trusting multiphase flow simulations.", "problem": "Consider a two-dimensional incompressible quiescent liquid drop of radius $R$ immersed in an infinite bath of another immiscible liquid. The interface is tracked with a Volume of Fluid (VOF) method and reconstructed using the Piecewise Linear Interface Calculation (PLIC). Assume equal and constant dynamic viscosity $\\mu$ and density $\\rho$ in both phases, negligible inertia (steady Stokes regime), and a constant and uniform surface tension coefficient $\\sigma$. The interface curvature is computed from the reconstructed interface. For a perfectly circular interface, the exact curvature is $\\kappa_{\\mathrm{exact}}=1/R$.\n\nThe capillary force is modeled with a Continuum Surface Force (CSF) formulation, and a balanced-force discretization is used so that, when the curvature is exact, the discrete pressure gradient and discrete capillary force cancel to machine precision, yielding a static equilibrium with zero velocity. However, due to geometric reconstruction and curvature estimation, the numerically computed curvature has a deterministic truncation error. For PLIC with a height-function curvature estimator that is second-order accurate on a uniform Cartesian grid of spacing $h$, assume the curvature error magnitude satisfies\n$$\n|\\Delta \\kappa| \\equiv |\\kappa_{\\mathrm{num}}-\\kappa_{\\mathrm{exact}}| \\;=\\; C_{\\kappa}\\,\\frac{h^{2}}{R^{3}},\n$$\nwhere $C_{\\kappa}$ is an $\\mathcal{O}(1)$ dimensionless constant that may depend on interface orientation and local volume fraction distribution but not on $h$ or $R$.\n\nTasks:\n1) Using only the incompressible steady Stokes momentum balance and the capillary normal-stress jump, determine the continuous equilibrium pressure field $p(r)$ for a perfectly reconstructed circular interface (i.e., $\\Delta \\kappa=0$), expressed relative to a constant far-field pressure $p_{\\infty}$ in the outer fluid.\n\n2) Now suppose the only error source is the curvature error $\\Delta \\kappa$ specified above, and that the balanced-force discretization cancels all other discrete capillary–pressure imbalances. Model the steady spurious current generated by this residual capillary error by balancing the residual normal capillary stress with viscous stress at the drop scale. Take the characteristic hydrodynamic length to be the drop radius $R$. Derive an estimate for the magnitude of the spurious velocity $U_{s}$ in terms of $\\sigma$, $\\mu$, $R$, $h$, and $C_{\\kappa}$.\n\nProvide your final answer as a single closed-form analytic expression for $U_{s}$. Do not include units in your final boxed answer. No numerical rounding is required.", "solution": "The problem asks for two results: first, the equilibrium pressure field for an ideal static liquid drop, and second, an estimate for the magnitude of spurious currents generated by numerical errors in curvature computation.\n\nFirst, we address the equilibrium pressure field $p(r)$ for a perfectly reconstructed circular interface, where the numerical curvature error $\\Delta \\kappa$ is zero. The system is described by the incompressible steady Stokes equations. The momentum balance is:\n$$ \\nabla p = \\mu \\nabla^2 \\mathbf{u} $$\nwhere $p$ is the pressure, $\\mu$ is the dynamic viscosity, and $\\mathbf{u}$ is the velocity field. The problem states that for a perfectly reconstructed interface, the system is in a quiescent state, meaning there is static equilibrium with zero velocity. Thus, $\\mathbf{u} = \\mathbf{0}$. Substituting this into the Stokes equation yields:\n$$ \\nabla p = \\mathbf{0} $$\nThis equation implies that the pressure $p$ is spatially constant within each fluid phase. Let $p_{in}$ denote the pressure inside the drop (for radial position $r  R$) and $p_{out}$ denote the pressure in the surrounding fluid (for $r > R$).\n\nAt the interface between the two immiscible fluids ($r=R$), the pressure is discontinuous. The pressure jump is determined by the Young-Laplace equation, which relates the jump to the surface tension coefficient $\\sigma$ and the interface curvature $\\kappa$. For a two-dimensional interface, this relation is:\n$$ p_{in} - p_{out} = \\sigma \\kappa $$\nThe problem specifies that for a perfectly circular interface of radius $R$, the exact curvature is $\\kappa_{\\mathrm{exact}} = 1/R$. Therefore, the pressure jump is:\n$$ p_{in} - p_{out} = \\frac{\\sigma}{R} $$\nThe problem also states that the far-field pressure in the outer fluid is a constant, $p_{\\infty}$. Since the pressure in the outer fluid is constant everywhere, we must have $p_{out} = p_{\\infty}$. Substituting this into the pressure jump equation allows us to determine the pressure inside the drop:\n$$ p_{in} = p_{\\infty} + \\frac{\\sigma}{R} $$\nThe problem asks for the pressure field $p(r)$ relative to $p_{\\infty}$, which is $p(r) - p_{\\infty}$. We can express this field as a piecewise function of the radial coordinate $r$:\n$$\np(r) - p_{\\infty} =\n\\begin{cases}\n\\frac{\\sigma}{R}  \\text{for } r  R \\\\\n0  \\text{for } r > R\n\\end{cases}\n$$\nThis describes the ideal pressure field in the absence of numerical errors.\n\nNext, we derive an estimate for the magnitude of the spurious velocity, $U_s$, which arises from errors in the numerical curvature calculation. The problem states that the only source of imbalance is the curvature error. This error leads to a residual normal stress at the interface that drives an unphysical flow, known as a spurious current. The problem directs us to model this by balancing the residual normal capillary stress with the viscous stress at the scale of the drop.\n\nThe magnitude of the residual stress originating from the capillary term, $\\tau_{cap, err}$, is proportional to the surface tension coefficient $\\sigma$ and the magnitude of the curvature error, $|\\Delta \\kappa|$:\n$$ \\tau_{cap, err} \\sim \\sigma |\\Delta \\kappa| $$\nThe spurious flow is in the steady Stokes regime, so the driving force is balanced by viscous forces. The characteristic viscous stress, $\\tau_{visc}$, in the fluid can be estimated using dimensional analysis. It is proportional to the dynamic viscosity $\\mu$ and the spatial gradient of the velocity. Using the spurious velocity magnitude $U_s$ as the characteristic velocity and the drop radius $R$ as the characteristic length scale (as specified in the problem), the viscous stress scales as:\n$$ \\tau_{visc} \\sim \\mu \\frac{U_s}{R} $$\nIn the steady state, the spurious current is established when the driving residual capillary stress is balanced by the damping viscous stress. Therefore, we equate the magnitudes of these two stresses:\n$$ \\tau_{visc} \\approx \\tau_{cap, err} $$\n$$ \\frac{\\mu U_s}{R} \\approx \\sigma |\\Delta \\kappa| $$\nThe problem provides a specific expression for the magnitude of the curvature error for a second-order accurate PLIC method:\n$$ |\\Delta \\kappa| = C_{\\kappa} \\frac{h^2}{R^3} $$\nwhere $h$ is the grid spacing and $C_{\\kappa}$ is a dimensionless constant of order one. Substituting this expression into our stress balance equation gives:\n$$ \\frac{\\mu U_s}{R} \\approx \\sigma \\left( C_{\\kappa} \\frac{h^2}{R^3} \\right) $$\nFinally, we solve for the spurious velocity magnitude, $U_s$, by isolating it on one side of the equation:\n$$ U_s \\approx \\frac{R}{\\mu} \\sigma C_{\\kappa} \\frac{h^2}{R^3} $$\n$$ U_s \\approx \\frac{\\sigma C_{\\kappa} h^2}{\\mu R^2} $$\nThis expression provides the sought-after estimate for the magnitude of the spurious velocity in terms of the given physical and numerical parameters.", "answer": "$$\\boxed{\\frac{\\sigma C_{\\kappa} h^{2}}{\\mu R^{2}}}$$", "id": "3461573"}]}