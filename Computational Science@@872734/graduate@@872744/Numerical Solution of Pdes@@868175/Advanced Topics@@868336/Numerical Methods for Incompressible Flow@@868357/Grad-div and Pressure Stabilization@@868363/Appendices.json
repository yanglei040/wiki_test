{"hands_on_practices": [{"introduction": "Before applying stabilization techniques, it is crucial to understand precisely what problem they solve. This exercise provides a foundational, hands-on demonstration of the instability inherent in equal-order finite element discretizations of the Stokes equations [@problem_id:3401415]. By explicitly constructing a spurious 'checkerboard' pressure mode on a simple mesh, you will see firsthand how the discrete system can admit non-physical solutions, a direct consequence of violating the discrete inf-sup condition.", "problem": "Consider the steady incompressible Stokes problem on the unit square domain $\\Omega = (0,1) \\times (0,1)$ with homogeneous Dirichlet boundary conditions for the velocity: find $(\\boldsymbol{u},p)$ such that\n$$\n-\\nu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{0} \\quad \\text{in } \\Omega,\\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\\qquad \\boldsymbol{u}=\\boldsymbol{0} \\quad \\text{on } \\partial\\Omega,\n$$\nwhere $\\nu>0$ is the kinematic viscosity. The weak formulation uses the standard bilinear forms\n$$\na(\\boldsymbol{u},\\boldsymbol{v}) := \\nu \\int_{\\Omega} \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, d\\Omega,\\qquad b(\\boldsymbol{v},q) := - \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{v} \\, d\\Omega,\n$$\nfor $\\boldsymbol{v}$ in an $H^{1}$-conforming velocity test space and $q$ in an $L^{2}$-conforming pressure test space. Let $\\mathcal{T}_h$ be the uniform partition of $\\Omega$ into $2 \\times 2$ congruent axis-aligned squares. Let $V_h \\subset H^{1}_{0}(\\Omega)^{2}$ be the conforming continuous bilinear space (tensor-product of one-dimensional linear polynomials) for the velocity, and $Q_h \\subset L^{2}_{0}(\\Omega)$ be the conforming continuous bilinear space for the pressure, both defined on $\\mathcal{T}_h$ (i.e., equal-order $Q_1$–$Q_1$). Assume the pressure-velocity coupling bilinear form is assembled using a single-point (element-center) quadrature rule on each element, while the diffusion bilinear form $a(\\cdot,\\cdot)$ is assembled exactly. No grad-div stabilization and no Pressure-Stabilizing Petrov-Galerkin (PSPG) stabilization are used.\n\n1. Using only the above foundations (variational formulation, finite element definitions, and the specified quadrature), construct an explicit nontrivial discrete pressure $p_h \\in Q_h$ and a discrete velocity $\\boldsymbol{v}_h \\in V_h$ that solve the discrete homogeneous Stokes equations\n$$\na(\\boldsymbol{v}_h,\\boldsymbol{w}_h) + b(\\boldsymbol{w}_h,p_h) = 0 \\quad \\forall\\, \\boldsymbol{w}_h \\in V_h,\\qquad b(\\boldsymbol{v}_h,q_h)=0 \\quad \\forall\\, q_h \\in Q_h,\n$$\nand thereby demonstrate a violation of the discrete inf-sup condition. Your construction must be explicit on the $2 \\times 2$ uniform mesh with nodes $(i/2,j/2)$ for $i,j \\in \\{0,1,2\\}$, and should rely only on properties of $Q_1$ shape functions and the stated quadrature.\n\n2. In the absence of stabilization, define the oscillatory pressure error as the $L^{2}$-norm of the constructed $p_h$ (the exact pressure for the homogeneous problem is identically zero). Compute the exact value of\n$$\n\\|p_h\\|_{L^{2}(\\Omega)}.\n$$\n\nExpress your final answer to the second part as an exact value with no units. If you choose to scale your constructed $p_h$ by a constant amplitude, set that amplitude equal to $1$ so that the final value is uniquely determined.", "solution": "The problem asks for the construction of a spurious solution to the discrete Stokes equations on a specific finite element setup, and for the computation of the $L^2$-norm of the spurious pressure component.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Equations:** Steady incompressible Stokes equations on $\\Omega = (0,1) \\times (0,1)$.\n  $$-\\nu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{0} \\quad \\text{in } \\Omega$$\n  $$\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega$$\n- **Boundary Conditions:** Homogeneous Dirichlet for velocity, $\\boldsymbol{u}=\\boldsymbol{0}$ on $\\partial\\Omega$.\n- **Weak Formulation:**\n  - Find $(\\boldsymbol{u},p)$ such that:\n    $$a(\\boldsymbol{u},\\boldsymbol{v}) + b(\\boldsymbol{v},p) = 0 \\quad \\text{for all test functions } \\boldsymbol{v}$$\n    $$b(\\boldsymbol{u},q) = 0 \\quad \\text{for all test functions } q$$\n  - Bilinear forms:\n    $$a(\\boldsymbol{u},\\boldsymbol{v}) := \\nu \\int_{\\Omega} \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, d\\Omega$$\n    $$b(\\boldsymbol{v},q) := - \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{v} \\, d\\Omega$$\n- **Discretization:**\n  - **Mesh $\\mathcal{T}_h$:** Uniform partition of $\\Omega$ into $2 \\times 2$ congruent square elements. The nodes are at coordinates $(i/2, j/2)$ for $i,j \\in \\{0,1,2\\}$. The side length of each element is $h=1/2$.\n  - **Velocity Space $V_h$:** Continuous bilinear functions ($Q_1$) for each velocity component, satisfying the homogeneous boundary conditions. $V_h \\subset H^{1}_{0}(\\Omega)^{2}$.\n  - **Pressure Space $Q_h$:** Continuous bilinear functions ($Q_1$) with a zero-mean constraint. $Q_h \\subset L^{2}_{0}(\\Omega)$.\n- **Numerical Integration:**\n  - The diffusion form $a(\\cdot,\\cdot)$ is assembled exactly.\n  - The pressure-velocity coupling form $b(\\cdot,\\cdot)$ is approximated by a single-point quadrature rule at the center of each element. Let's denote this by $b_h(\\cdot, \\cdot)$.\n- **Stabilization:** None. Neither grad-div nor PSPG stabilization is used.\n- **Task:**\n  1. Construct a non-trivial solution $(\\boldsymbol{v}_h, p_h)$ to the discrete homogeneous system:\n     $$a(\\boldsymbol{v}_h,\\boldsymbol{w}_h) + b_h(\\boldsymbol{w}_h,p_h) = 0 \\quad \\forall\\, \\boldsymbol{w}_h \\in V_h$$\n     $$b_h(\\boldsymbol{v}_h,q_h) = 0 \\quad \\forall\\, q_h \\in Q_h$$\n  2. Compute $\\|p_h\\|_{L^2(\\Omega)}$ for the constructed pressure, with its amplitude constant set to $1$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard textbook example used to illustrate the instability of the equal-order $Q_1-Q_1$ finite element pair for the Stokes problem, particularly when under-integrated.\n- **Scientifically Grounded:** The problem is firmly located within the theory of numerical methods for partial differential equations and is a classic example of numerical instability. It is scientifically and mathematically sound.\n- **Well-Posed:** The problem statement is precise, providing all necessary definitions, spaces, and numerical procedures to construct the required solution and perform the calculation. The question itself is well-posed.\n- **Objective:** The language is formal and objective.\n\nThe problem statement is valid.\n\n### Solution\n\n**Part 1: Construction of a Spurious Solution**\n\nA non-trivial solution to the homogeneous discrete Stokes equations, particularly one with a non-zero pressure component, demonstrates a violation of the discrete inf-sup (Ladyzhenskaya-Babuška-Brezzi) condition. Such a pressure $p_h$ lies in the kernel of the discrete divergence operator's transpose. We seek a non-zero $p_h \\in Q_h$ and a $\\boldsymbol{v}_h \\in V_h$ such that the discrete system is satisfied.\n\nThe crucial element is the use of single-point quadrature for the bilinear form $b(\\boldsymbol{v},q)$. The resulting discrete form $b_h(\\boldsymbol{v},q)$ is:\n$$b_h(\\boldsymbol{v},q) = - \\sum_{K \\in \\mathcal{T}_h} |K| q(x_K) (\\nabla \\cdot \\boldsymbol{v})(x_K)$$\nwhere $K$ denotes an element, $|K|$ is its area, and $x_K$ is its center.\n\nWe propose a pressure field $p_h \\in Q_h$ known as a \"checkerboard\" mode. Let the nodes of the mesh be $(x_i, y_j) = (i/2, j/2)$ for $i,j \\in \\{0,1,2\\}$. We define $p_h$ by its nodal values $P_{i,j}$:\n$$P_{i,j} = (-1)^{i+j}$$\nThe amplitude constant is set to $1$ as per the problem. The pressure field is then $p_h(x,y) = \\sum_{i,j=0}^2 P_{i,j} \\phi_{i,j}(x,y)$, where $\\phi_{i,j}$ are the standard $Q_1$ basis functions.\n\nFor a bilinear ($Q_1$) element, the value of the function at the element's center is the average of its values at the four corner nodes. Let's verify this for each of the four elements in the $2 \\times 2$ mesh.\n- **Element $K_1 = [0, 1/2] \\times [0, 1/2]$:** Nodes at $(0,0), (1/2,0), (0,1/2), (1/2,1/2)$. Nodal indices are $(0,0), (1,0), (0,1), (1,1)$.\nThe nodal values of $p_h$ are $P_{0,0}=1, P_{1,0}=-1, P_{0,1}=-1, P_{1,1}=1$.\nThe value at the center $x_{K_1}=(1/4, 1/4)$ is $p_h(x_{K_1}) = \\frac{1}{4}(P_{0,0} + P_{1,0} + P_{0,1} + P_{1,1}) = \\frac{1}{4}(1 - 1 - 1 + 1) = 0$.\n- **Element $K_2 = [1/2, 1] \\times [0, 1/2]$:** Nodes at $(1/2,0), (1,0), (1/2,1/2), (1,1/2)$. Nodal indices $(1,0), (2,0), (1,1), (2,1)$.\nNodal values: $P_{1,0}=-1, P_{2,0}=1, P_{1,1}=1, P_{2,1}=-1$.\nValue at center $x_{K_2}=(3/4, 1/4)$: $p_h(x_{K_2}) = \\frac{1}{4}(-1 + 1 + 1 - 1) = 0$.\n- **Element $K_3 = [0, 1/2] \\times [1/2, 1]$:** Nodes at $(0,1/2), (1/2,1/2), (0,1), (1/2,1)$. Nodal indices $(0,1), (1,1), (0,2), (1,2)$.\nNodal values: $P_{0,1}=-1, P_{1,1}=1, P_{0,2}=1, P_{1,2}=-1$.\nValue at center $x_{K_3}=(1/4, 3/4)$: $p_h(x_{K_3}) = \\frac{1}{4}(-1 + 1 + 1 - 1) = 0$.\n- **Element $K_4 = [1/2, 1] \\times [1/2, 1]$:** Nodes at $(1/2,1/2), (1,1/2), (1/2,1), (1,1)$. Nodal indices $(1,1), (2,1), (1,2), (2,2)$.\nNodal values: $P_{1,1}=1, P_{2,1}=-1, P_{1,2}=-1, P_{2,2}=1$.\nValue at center $x_{K_4}=(3/4, 3/4)$: $p_h(x_{K_4}) = \\frac{1}{4}(1 - 1 - 1 + 1) = 0$.\n\nSince $p_h(x_K) = 0$ for all four elements $K$, the discrete pressure-velocity coupling term becomes:\n$$b_h(\\boldsymbol{w}_h, p_h) = - \\sum_{K \\in \\mathcal{T}_h} |K| \\underbrace{p_h(x_K)}_{0} (\\nabla \\cdot \\boldsymbol{w}_h)(x_K) = 0$$\nThis holds for any test function $\\boldsymbol{w}_h \\in V_h$.\n\nNow we must verify that this $p_h$ is a valid member of $Q_h$, i.e., $p_h \\in L^2_0(\\Omega)$ or $\\int_\\Omega p_h d\\Omega = 0$.\nThe integral of a $Q_1$ basis function $\\phi_{i,j}$ over the domain $\\Omega$ is related to its surrounding elements. Let $|K|=(1/2)^2=1/4$ be the area of one element.\n- Corner node (e.g., $(0,0)$): $\\int_\\Omega \\phi_{0,0} d\\Omega = \\frac{1}{4}|K| = \\frac{1}{16}$.\n- Edge node (e.g., $(1/2,0)$): $\\int_\\Omega \\phi_{1,0} d\\Omega = \\frac{1}{4}|K| + \\frac{1}{4}|K| = \\frac{1}{2}|K| = \\frac{1}{8}$.\n- Center node ($(1/2,1/2)$): $\\int_\\Omega \\phi_{1,1} d\\Omega = 4 \\times (\\frac{1}{4}|K|) = |K| = \\frac{1}{4}$.\nThe mean of $p_h$ is:\n$$\\int_\\Omega p_h d\\Omega = \\sum_{i,j=0}^2 P_{i,j} \\int_\\Omega \\phi_{i,j} d\\Omega$$\nThere are $4$ corner nodes (_c_), $4$ edge nodes (_e_), and $1$ center node (_m_).\n$$P_c = P_{0,0}=P_{2,0}=P_{0,2}=P_{2,2}=1$$\n$$P_e = P_{1,0}=P_{0,1}=P_{2,1}=P_{1,2}=-1$$\n$$P_m = P_{1,1}=1$$\n$$\\int_\\Omega p_h d\\Omega = 4 \\cdot P_c \\cdot \\frac{1}{16} + 4 \\cdot P_e \\cdot \\frac{1}{8} + 1 \\cdot P_m \\cdot \\frac{1}{4} = 4(1)\\frac{1}{16} + 4(-1)\\frac{1}{8} + 1(1)\\frac{1}{4} = \\frac{1}{4} - \\frac{1}{2} + \\frac{1}{4} = 0$$\nSo, $p_h \\in Q_h$.\n\nWith this $p_h$, the first discrete Stokes equation becomes:\n$$a(\\boldsymbol{v}_h, \\boldsymbol{w}_h) + b_h(\\boldsymbol{w}_h, p_h) = a(\\boldsymbol{v}_h, \\boldsymbol{w}_h) + 0 = 0 \\quad \\forall \\boldsymbol{w}_h \\in V_h$$\nWe choose $\\boldsymbol{v}_h = \\boldsymbol{0}$. Then $a(\\boldsymbol{0}, \\boldsymbol{w}_h) = 0$, satisfying the equation.\nThe second discrete Stokes equation is:\n$$b_h(\\boldsymbol{v}_h, q_h) = b_h(\\boldsymbol{0}, q_h) = 0 \\quad \\forall q_h \\in Q_h$$\nThis is also satisfied.\nThus, the pair $(\\boldsymbol{v}_h, p_h) = (\\boldsymbol{0}, \\text{checkerboard mode})$ is a non-trivial solution to the discrete homogeneous system. $p_h$ is non-zero (since its nodal values are not all zero), while $\\boldsymbol{v}_h$ is zero. This construction demonstrates the violation of the discrete inf-sup condition.\n\n**Part 2: Computation of $\\|p_h\\|_{L^2(\\Omega)}$**\n\nWe need to compute $\\|p_h\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} p_h(x,y)^2 dx dy\\right)^{1/2}$. We can compute this by summing the integrals over the four elements:\n$$\\|p_h\\|^2_{L^2(\\Omega)} = \\sum_{e=1}^4 \\int_{K_e} p_h(x,y)^2 dx dy$$\nLet's find the analytical form for $p_h$ on an element. On a reference element $[0,1]^2$ with coordinates $(\\hat{x}, \\hat{y})$, a bilinear function is given by $f(\\hat{x},\\hat{y}) = \\sum_{i,j=0}^1 f_{ij} (1-|\\hat{x}-i|)(1-|\\hat{y}-j|)$. On element $K_1=[0,1/2]\\times[0,1/2]$, the local coordinates are $\\hat{x}=2x, \\hat{y}=2y$. The nodal values are $P_{0,0}=1, P_{1,0}=-1, P_{0,1}=-1, P_{1,1}=1$.\nThe function on the reference element $[0,1]^2$ is:\n$$p_h(\\hat{x},\\hat{y}) = (1-\\hat{x})(1-\\hat{y})(1) + \\hat{x}(1-\\hat{y})(-1) + (1-\\hat{x})\\hat{y}(-1) + \\hat{x}\\hat{y}(1)$$\n$$= (1-\\hat{y})(1-\\hat{x}-\\hat{x}) + \\hat{y}(-1+\\hat{x}+\\hat{x}) = (1-\\hat{y})(1-2\\hat{x}) + \\hat{y}(2\\hat{x}-1) = (1-2\\hat{y})(1-2\\hat{x})$$\nSubstituting back $\\hat{x}=2x, \\hat{y}=2y$, we get $p_h(x,y) = (1-4x)(1-4y)$ for $(x,y) \\in K_1$.\nThe integral over $K_1$ is:\n$$\\int_{K_1} p_h^2 dx dy = \\int_0^{1/2} \\int_0^{1/2} (1-4x)^2 (1-4y)^2 dx dy$$\nThe integral is separable:\n$$\\left( \\int_0^{1/2} (1-4x)^2 dx \\right) \\left( \\int_0^{1/2} (1-4y)^2 dy \\right)$$\nLet's compute one of the integrals. Let $u = 1-4x$, so $du = -4dx$.\n$$\\int_0^{1/2} (1-4x)^2 dx = \\int_1^{-1} u^2 \\left(-\\frac{1}{4}\\right) du = \\frac{1}{4} \\int_{-1}^1 u^2 du = \\frac{1}{4} \\left[ \\frac{u^3}{3} \\right]_{-1}^1 = \\frac{1}{4} \\left( \\frac{1}{3} - \\frac{-1}{3} \\right) = \\frac{1}{4} \\cdot \\frac{2}{3} = \\frac{1}{6}$$\nThus, the integral over $K_1$ is $\\frac{1}{6} \\times \\frac{1}{6} = \\frac{1}{36}$.\n\nBy symmetry, the integral over each of the four elements is the same. For instance, on $K_4=[1/2,1]\\times[1/2,1]$, $\\hat{x}=2x-1, \\hat{y}=2y-1$. The nodal values are $(1,-1,-1,1)$, same as $K_1$. So $p_h(x,y) = (1-2\\hat{x})(1-2\\hat{y}) = (1-2(2x-1))(1-2(2y-1)) = (3-4x)(3-4y)$. The integral $\\int_{1/2}^1(3-4x)^2 dx$ also evaluates to $1/6$.\nOn $K_2$ and $K_3$, the nodal value pattern is $(-1,1,1,-1)$, which is the negative of the pattern on $K_1$. The function is $p_h(\\hat{x},\\hat{y})=(2\\hat{x}-1)(1-2\\hat{y})$. Squaring this function gives the same result upon integration.\nTherefore, the total integral is four times the integral over one element:\n$$\\|p_h\\|^2_{L^2(\\Omega)} = 4 \\times \\frac{1}{36} = \\frac{1}{9}$$\nThe $L^2$-norm is the square root of this value:\n$$\\|p_h\\|_{L^2(\\Omega)} = \\sqrt{\\frac{1}{9}} = \\frac{1}{3}$$\nThis is the exact value of the norm for the specified checkerboard pressure mode with amplitude $1$.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "3401415"}, {"introduction": "Having witnessed the instability, we now turn to one of the most effective remedies: the Pressure-Stabilizing Petrov-Galerkin (PSPG) method. The effectiveness of PSPG hinges on the careful selection of its stabilization parameter, $\\tau_{K}$, which must be strong enough to suppress spurious modes without polluting the solution. This practice guides you through a theoretical derivation of $\\tau_{K}$, revealing how it can be systematically determined by comparing its effect to that of an 'ideal' stabilization operator derived from local spectral theory [@problem_id:3401450].", "problem": "Consider the steady Stokes equations with constant kinematic viscosity $\\nu>0$ on the unit square $\\Omega=(0,1)^{2}$ with homogeneous Dirichlet velocity boundary conditions. Let $\\mathcal{T}_{h}$ be a quasi-uniform partition of $\\Omega$ into axis-aligned squares of side length $h_{K}$ (so $h_{K}=h$ for all $K\\in\\mathcal{T}_{h}$), and consider equal-order continuous bilinear finite element spaces for velocity and pressure. Denote by $a(\\boldsymbol{u},\\boldsymbol{v})=\\nu\\int_{\\Omega}\\nabla \\boldsymbol{u}:\\nabla \\boldsymbol{v}\\,d\\Omega$ and $b(\\boldsymbol{v},q)=-\\int_{\\Omega}q\\,\\nabla\\cdot \\boldsymbol{v}\\,d\\Omega$ the standard bilinear forms. A residual-based pressure-stabilizing/Petrov-Galerkin (PSPG) stabilization augments the mixed method by adding, for pressure test functions $q_{h}$, the elementwise term\n$$\ns_{h}\\big((\\boldsymbol{u}_{h},p_{h}),(0,q_{h})\\big)\\;=\\;\\sum_{K\\in\\mathcal{T}_{h}}\\tau_{K}\\,\\big(-\\nu\\Delta \\boldsymbol{u}_{h}+\\nabla p_{h}-\\boldsymbol{f},\\,\\nabla q_{h}\\big)_{K},\n$$\nwhere $(\\cdot,\\cdot)_{K}$ denotes the $L^{2}(K)$ inner product and $\\tau_{K}>0$ is a scalar parameter to be chosen elementwise. One way to motivate $\\tau_{K}$ is to compare $s_{h}$ to an “ideal” local stabilization that uses the element Green’s operator $G_{K}:L^{2}(K)^{2}\\to H_{0}^{1}(K)^{2}$ defined by $-\\Delta \\boldsymbol{w}= \\boldsymbol{\\phi}$ in $K$ with $\\boldsymbol{w}=\\boldsymbol{0}$ on $\\partial K$. In particular, for $\\boldsymbol{\\phi}=\\nabla q_{h}$ and the Dirichlet Laplacian eigenpairs $\\{-\\Delta \\varphi_{m}=\\lambda_{m}\\varphi_{m}\\}$ on $K$, the spectral representation implies the bounds\n$$\n\\frac{1}{\\lambda_{\\max}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2}\\ \\le\\ \\big(\\nabla q_{h},\\,G_{K}\\,\\nabla q_{h}\\big)_{K}\\ \\le\\ \\frac{1}{\\lambda_{1}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2},\n$$\nwith $\\lambda_{1}(K)$ the smallest eigenvalue and $\\lambda_{\\max}(K)$ the largest eigenvalue acting on the relevant finite-dimensional content of $\\nabla q_{h}$. On a square element $K$ of side $h_{K}$ with zero Dirichlet boundary conditions, the Dirichlet Laplacian eigenvalues are $\\lambda_{m,n}(K)=\\pi^{2}(m^{2}+n^{2})/h_{K}^{2}$ for integers $m,n\\ge 1$, so $\\lambda_{1}(K)=2\\pi^{2}/h_{K}^{2}$.\n\nTreating the residual-based PSPG term as the replacement of $G_{K}$ by $\\tau_{K} I$ in the quadratic form on $\\nabla q_{h}$, choose $\\tau_{K}$ so that the algebraic stabilization dominates the ideal one (thereby ensuring a mesh-independent stability lower bound for the pressure). Using only the above foundational facts and definitions, derive a closed-form expression for $\\tau_{K}$ in terms of $h_{K}$, $\\nu$, and universal constants. Provide your final $\\tau_{K}$ as a single analytic expression. No numerical rounding is required, and no units should be included in the final expression.", "solution": "The problem requires the derivation of a closed-form expression for the Pressure-Stabilizing/Petrov-Galerkin (PSPG) stabilization parameter, $\\tau_K$, for the steady Stokes equations. The derivation is to be based on a comparison with an \"ideal\" stabilization method.\n\nThe problem states that the steady Stokes equations are considered on the domain $\\Omega=(0,1)^2$ with constant kinematic viscosity $\\nu>0$. The momentum equation residual is $\\boldsymbol{R}_{\\boldsymbol{u}} = -\\nu\\Delta \\boldsymbol{u}_{h}+\\nabla p_{h}-\\boldsymbol{f}$. The PSPG stabilization term is given as:\n$$\ns_{h}\\big((\\boldsymbol{u}_{h},p_{h}),(0,q_{h})\\big)\\;=\\;\\sum_{K\\in\\mathcal{T}_{h}}\\tau_{K}\\,\\big(\\boldsymbol{R}_{\\boldsymbol{u}},\\,\\nabla q_{h}\\big)_{K}\n$$\nThis term is added to the weak form of the continuity equation. The portion of this term that acts on the pressure trial function $p_h$ and test function $q_h$ can be represented by the bilinear form $\\sum_{K \\in \\mathcal{T}_h} (\\tau_K \\nabla p_h, \\nabla q_h)_K$. The associated quadratic form on an element $K$ is $\\tau_K (\\nabla p_h, \\nabla p_h)_K = \\tau_K \\|\\nabla p_h\\|_{0,K}^2$.\n\nThe motivation for choosing $\\tau_K$ is to compare this algebraic stabilization with an \"ideal\" local stabilization. The ideal stabilization arises from the idea of inverting the differential operator within the momentum residual on each element. The relevant differential operator acting on the velocity is $-\\nu\\Delta$. Therefore, an ideal stabilization would involve the inverse operator $(-\\nu\\Delta_K)^{-1}$, where $\\Delta_K$ is the Laplacian on element $K$ with homogeneous Dirichlet boundary conditions. This inverse is the element Green's operator for the operator $-\\nu\\Delta$, which we denote as $G_{K,\\nu}$.\n\nThe problem statement defines a Green's operator $G_K$ for the canonical Laplacian, $-\\Delta$, such that $-\\Delta \\boldsymbol{w} = \\boldsymbol{\\phi}$ is solved by $\\boldsymbol{w}=G_K\\boldsymbol{\\phi}$. The relationship between $G_{K,\\nu}$ and $G_K$ is derived from their definitions:\nIf $-\\nu\\Delta \\boldsymbol{w} = \\boldsymbol{\\phi}$, then $\\boldsymbol{w} = (-\\nu\\Delta_K)^{-1}\\boldsymbol{\\phi} = \\frac{1}{\\nu}(-\\Delta_K)^{-1}\\boldsymbol{\\phi} = \\frac{1}{\\nu}G_K\\boldsymbol{\\phi}$. Thus, $G_{K,\\nu} = \\frac{1}{\\nu}G_K$. Although the problem statement makes reference to replacing $G_K$ by $\\tau_K I$, the requirement to find $\\tau_K$ as a function of $\\nu$ and the physical origin of stabilization imply that the comparison must be made with the physically correct ideal operator, $G_{K,\\nu}$.\n\nThe quadratic form associated with the ideal stabilization (acting on the pressure part of the residual) is $(\\nabla p_h, G_{K,\\nu} \\nabla p_h)_K$. Substituting the relation $G_{K,\\nu} = \\frac{1}{\\nu}G_K$, this becomes:\n$$\n(\\nabla p_h, G_{K,\\nu} \\nabla p_h)_K = \\frac{1}{\\nu}(\\nabla p_h, G_K \\nabla p_h)_K\n$$\nThe problem provides spectral bounds for the quadratic form involving $G_K$:\n$$\n\\frac{1}{\\lambda_{\\max}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2}\\ \\le\\ \\big(\\nabla q_{h},\\,G_{K}\\,\\nabla q_{h}\\big)_{K}\\ \\le\\ \\frac{1}{\\lambda_{1}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2}\n$$\nwhere $\\lambda_1(K)$ is the smallest eigenvalue of the Dirichlet Laplacian on $K$. Applying these bounds to the ideal stabilization form gives:\n$$\n\\frac{1}{\\nu\\lambda_{\\max}(K)}\\,\\|\\nabla p_{h}\\|_{0,K}^{2}\\ \\le\\ (\\nabla p_{h},\\,G_{K,\\nu}\\,\\nabla p_{h}\\big)_{K}\\ \\le\\ \\frac{1}{\\nu\\lambda_{1}(K)}\\,\\|\\nabla p_{h}\\|_{0,K}^{2}\n$$\nThe task is to choose $\\tau_K$ such that the algebraic stabilization, $\\tau_K \\|\\nabla p_h\\|_{0,K}^2$, \"dominates\" the ideal one. This is interpreted as choosing $\\tau_K$ to be on the order of the upper bound of the ideal operator's spectral radius with respect to the norm on $\\nabla p_h$. The supremum of the Rayleigh quotient for the ideal operator is bounded by $\\frac{1}{\\nu\\lambda_1(K)}$.\n$$\n\\sup_{p_h \\ne const.} \\frac{(\\nabla p_{h},\\,G_{K,\\nu}\\,\\nabla p_{h}\\big)_{K}}{\\|\\nabla p_h\\|_{0,K}^2} \\le \\frac{1}{\\nu\\lambda_1(K)}\n$$\nA standard and robust choice for the stabilization parameter is to set it equal to this upper bound, ensuring that the stabilization is sufficiently strong without being excessive.\n$$\n\\tau_K = \\frac{1}{\\nu\\lambda_{1}(K)}\n$$\nThe problem specifies that for a square element $K$ of side length $h_K$, the smallest eigenvalue of the Dirichlet Laplacian is:\n$$\n\\lambda_1(K) = \\frac{2\\pi^2}{h_K^2}\n$$\nSubstituting this into the expression for $\\tau_K$ yields the final closed-form expression:\n$$\n\\tau_K = \\frac{1}{\\nu \\left( \\frac{2\\pi^2}{h_K^2} \\right)} = \\frac{h_K^2}{2\\pi^2\\nu}\n$$\nThis expression defines the stabilization parameter $\\tau_K$ in terms of the element size $h_K$, the kinematic viscosity $\\nu$, and the universal constant $\\pi$, as required.", "answer": "$$\\boxed{\\frac{h_{K}^{2}}{2\\pi^{2}\\nu}}$$", "id": "3401450"}, {"introduction": "Beyond PSPG, grad-div stabilization is another vital technique, particularly valued for its role in improving mass conservation. Its application in high-order spectral element methods requires special attention, as the stabilization parameter $\\gamma$ must scale correctly with the polynomial degree $p$ to maintain stability and accuracy. In this advanced exercise, you will derive the optimal scaling $\\gamma(p) \\propto p^{2}$ by balancing the grad-div term against the physical viscous term, a core principle in designing robust high-order schemes [@problem_id:3401449].", "problem": "Consider the steady incompressible Stokes equations on the unit square domain $\\Omega=(0,1)^{2}$ with kinematic viscosity $\\nu>0$,\n$$\n-\\nu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{f},\\qquad \\nabla\\cdot \\boldsymbol{u}=0\\quad \\text{in }\\Omega,\n$$\nwith Dirichlet boundary conditions prescribed from a smooth manufactured solution. Let the manufactured solution be defined by a streamfunction $\\psi(x,y)=\\sin(\\pi x)\\sin(\\pi y)$, so that $\\boldsymbol{u}^{\\ast}=(\\partial_{y}\\psi,-\\partial_{x}\\psi)=(\\pi \\cos(\\pi y)\\sin(\\pi x), -\\pi \\cos(\\pi x)\\sin(\\pi y))$ and choose $p^{\\ast}(x,y)=\\sin(2\\pi x)\\sin(2\\pi y)$. The body force $\\boldsymbol{f}$ is taken as $\\boldsymbol{f}=-\\nu \\Delta \\boldsymbol{u}^{\\ast} + \\nabla p^{\\ast}$, ensuring exact satisfaction of the Stokes system.\n\nDiscretize with a conforming spectral element method (SEM) of polynomial degree $p\\ge 2$ on a quasi-uniform mesh of characteristic size $h\\ll 1$. Use equal-order velocity-pressure $C^{0}$ nodal spaces of degree $p$ and stabilize the formulation with:\n- a grad-div stabilization term of the form $\\gamma \\int_{\\Omega} (\\nabla\\cdot \\boldsymbol{u}_{h})(\\nabla\\cdot \\boldsymbol{v}_{h})\\,\\mathrm{d}x$ with parameter $\\gamma>0$,\n- a pressure-stabilizing Petrov–Galerkin (PSPG) term with parameter $\\tau_{\\mathrm{pspg}}$ to ensure stability of the equal-order pair.\n\nAssume the following standard, well-tested ingredients on affine tensor-product elements $K$ (mapped from a reference element) with shape-regular meshes:\n- inverse inequality for discrete functions $\\boldsymbol{v}_{h}$ of degree $p$,\n$$\n\\|\\nabla \\boldsymbol{v}_{h}\\|_{L^{2}(K)} \\le C_{\\mathrm{inv}} \\frac{p^{2}}{h}\\,\\|\\boldsymbol{v}_{h}\\|_{L^{2}(K)},\n$$\n- optimal local approximation by an interpolation operator $I_{h}$ of degree $p$,\n$$\n\\|\\boldsymbol{u}^{\\ast}-I_{h}\\boldsymbol{u}^{\\ast}\\|_{L^{2}(K)} \\le C_{\\mathrm{app}}\\,h^{p+1}\\,\\|\\boldsymbol{u}^{\\ast}\\|_{H^{p+1}(K)},\\qquad \\|\\nabla(\\boldsymbol{u}^{\\ast}-I_{h}\\boldsymbol{u}^{\\ast})\\|_{L^{2}(K)} \\le C_{\\mathrm{app},1}\\,h^{p}\\,\\|\\boldsymbol{u}^{\\ast}\\|_{H^{p+1}(K)}.\n$$\n\nStarting from the standard stabilized weak form for the Stokes problem with grad-div and pressure-stabilizing Petrov–Galerkin (PSPG) terms, and using only the fundamental variational structure, the above inverse and approximation inequalities, and norm equivalences on shape-regular meshes, derive a $p$-dependent scaling $\\gamma(p)$ such that the discrete velocity $\\boldsymbol{u}_{h}$ produced by the SEM satisfies an $L^{2}$ divergence error bound of the form\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}_{h}\\|_{L^{2}(\\Omega)} \\le C\\,h^{p+1}\\,\\Xi(\\boldsymbol{u}^{\\ast},p,\\nu),\n$$\nwhere $C$ is independent of $p$ and $h$, and where $\\Xi(\\cdot)$ has no algebraic growth in $p$ for the manufactured solution specified above. In particular, your task is to:\n- show that the potentially $p$-growing contribution in the divergence error bound can be neutralized if and only if $\\gamma(p)$ grows quadratically in $p$,\n- identify the leading constant $c$ in the scaling $\\gamma(p)\\sim c\\,p^{2}$ by asymptotically balancing the grad-div term against the viscous term at the element level, accounting for the $p^{2}$ growth in the inverse estimate, and\n- argue that with this choice the manufactured solution yields a leading-order divergence error $\\mathcal{O}(h^{p+1})$ independent of $p$.\n\nAssume the canonical reference-to-physical element mapping is scaled so that $C_{\\mathrm{inv}}$ and other shape constants can be absorbed into a single generic constant, and that the PSPG parameter is chosen with the standard diffusion-dominated scaling $\\tau_{\\mathrm{pspg}}\\sim \\kappa\\,h^{2}/(\\nu\\,p^{2})$ for some $p$-independent $\\kappa>0$ so that pressure-residual contributions are $\\mathcal{O}(h^{p+1})$ with $p$-independent constants.\n\nProvide your final result as a single closed-form analytic expression for $\\gamma(p)$ in terms of $\\nu$ and $p$ only. No numerical rounding is required and no physical units should be included in the final expression.", "solution": "The problem asks for the derivation of a $p$-dependent scaling for the grad-div stabilization parameter $\\gamma$ in a high-order spectral element method for the Stokes equations. The scaling should ensure that the $L^2$ norm of the divergence of the computed velocity, $\\|\\nabla\\cdot \\boldsymbol{u}_{h}\\|_{L^{2}(\\Omega)}$, converges at an optimal rate of $\\mathcal{O}(h^{p+1})$ with a pre-asymptotic constant that does not grow algebraically with the polynomial degree $p$.\n\nThe stabilized weak formulation for the Stokes problem is to find $(\\boldsymbol{u}_h, p_h) \\in \\boldsymbol{V}_h \\times Q_h$ such that for all test functions $(\\boldsymbol{v}_h, q_h) \\in \\boldsymbol{V}_h \\times Q_h$:\n$$\n\\nu \\int_\\Omega \\nabla\\boldsymbol{u}_h : \\nabla\\boldsymbol{v}_h \\,\\mathrm{d}x - \\int_\\Omega p_h (\\nabla \\cdot \\boldsymbol{v}_h) \\,\\mathrm{d}x + \\gamma \\int_\\Omega (\\nabla\\cdot\\boldsymbol{u}_{h})(\\nabla\\cdot\\boldsymbol{v}_{h})\\,\\mathrm{d}x = \\int_\\Omega \\boldsymbol{f} \\cdot \\boldsymbol{v}_h \\,\\mathrm{d}x\n$$\n$$\n\\int_\\Omega q_h (\\nabla \\cdot \\boldsymbol{u}_h)\\,\\mathrm{d}x - S_{pspg}(p_h, \\boldsymbol{u}_h; q_h) = F_{pspg}(\\boldsymbol{f}; q_h)\n$$\nwhere $\\boldsymbol{V}_h$ and $Q_h$ are the equal-order $C^0$ polynomial spaces of degree $p$, and $S_{pspg}$ and $F_{pspg}$ represent the pressure-stabilizing Petrov-Galerkin (PSPG) terms. The problem states we can assume the PSPG parameter $\\tau_{\\mathrm{pspg}}$ is chosen such that pressure-related errors are of optimal order $\\mathcal{O}(h^{p+1})$ with constants independent of $p$. Our task is to determine the scaling of $\\gamma(p)$.\n\nThe grad-div term $\\gamma \\int_\\Omega (\\nabla\\cdot \\boldsymbol{u}_{h})(\\nabla\\cdot \\boldsymbol{v}_{h})\\,\\mathrm{d}x$ is added to the momentum equation to enforce discrete mass conservation more strongly. For equal-order velocity-pressure elements, this is crucial for stability, as the discrete Ladyzhenskaya-Babuška-Brezzi (LBB) condition is not satisfied. The grad-div term acts primarily on the component of the velocity field that is not divergence-free.\n\nA key principle in designing stabilization parameters is to ensure that the stabilization term is strong enough to control instabilities but not so strong that it dominates the original physics and pollutes the solution with excessive numerical diffusion. This is achieved by \"balancing\" the stabilization term with a relevant physical term. In this case, the grad-div term should be balanced against the physical viscous term $\\nu \\int_\\Omega \\nabla\\boldsymbol{u}_h : \\nabla\\boldsymbol{v}_h \\,\\mathrm{d}x$.\n\nThe instabilities in equal-order elements are associated with specific modes of the discrete velocity space $\\boldsymbol{V}_h$. In particular, the LBB condition fails because there are not enough constraints on the pressure space $Q_h$. The problematic velocity modes are those that are curl-free, i.e., they are gradients of scalar potentials. Let $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$ be such a mode, so $\\boldsymbol{v}_h = \\nabla q_h$ for some scalar potential $q_h$, which is a polynomial of degree $p+1$ (so that its gradient is in $\\boldsymbol{V}_h$). For such functions, $\\nabla \\times \\boldsymbol{v}_h = \\nabla \\times (\\nabla q_h) = \\boldsymbol{0}$.\n\nLet's analyze the effect of the viscous and grad-div terms on these curl-free modes.\nLet $\\boldsymbol{v}_h = \\nabla q_h$.\nThe grad-div term's energy contribution on an element $K$ is:\n$$\n\\gamma \\int_K |\\nabla\\cdot\\boldsymbol{v}_h|^2 \\,\\mathrm{d}x = \\gamma \\int_K |\\nabla\\cdot(\\nabla q_h)|^2 \\,\\mathrm{d}x = \\gamma \\int_K |\\Delta q_h|^2 \\,\\mathrm{d}x = \\gamma \\|\\Delta q_h\\|_{L^2(K)}^2\n$$\nThe viscous term's energy contribution is:\n$$\n\\nu \\int_K |\\nabla\\boldsymbol{v}_h|^2 \\,\\mathrm{d}x = \\nu \\int_K |\\nabla(\\nabla q_h)|^2 \\,\\mathrm{d}x = \\nu \\int_K |D^2 q_h|^2 \\,\\mathrm{d}x = \\nu \\|D^2 q_h\\|_{L^2(K)}^2\n$$\nwhere $D^2 q_h$ is the Hessian tensor of $q_h$.\n\nFor the numerical scheme to be stable and uniformly well-behaved with respect to $p$, the stabilization term should be of the same order of magnitude as the physical term it supports, especially for the modes it is designed to control. This leads to the balancing condition:\n$$\n\\gamma \\|\\Delta q_h\\|_{L^2(K)}^2 \\sim \\nu \\|D^2 q_h\\|_{L^2(K)}^2\n$$\nThis balance should hold for the \"worst-case\" polynomials $q_h$, i.e., those that maximize the ratio of the Hessian norm to the Laplacian norm. Therefore, the parameter $\\gamma$ should be chosen as:\n$$\n\\gamma(p) \\sim \\nu \\sup_{q_h \\in \\tilde{P}_{p+1}(K)} \\frac{\\|D^2 q_h\\|_{L^2(K)}^2}{\\|\\Delta q_h\\|_{L^2(K)}^2}\n$$\nwhere $\\tilde{P}_{p+1}(K)$ is the space of scalar potentials whose gradients are in $\\boldsymbol{V}_h(K)$, excluding the kernel of the denominator (harmonic polynomials).\n\nIt is a known, though non-trivial, result from polynomial approximation theory on tensor-product domains (like the squares used in the SEM mesh) that the above ratio exhibits quadratic growth in the polynomial degree $p$. Specifically, for a polynomial $q$ of degree $p$ on a square,\n$$\n\\sup_{q \\in P_p(K)/\\ker(\\Delta)} \\frac{\\|D^2 q\\|_{L^2(K)}}{\\|\\Delta q\\|_{L^2(K)}} \\sim C p\n$$\nThe quadratic growth in $p^2$ for the ratio of the squared norms arises from specific anisotropic polynomials, for which the Laplacian is small relative to the full Hessian. For instance, polynomials with high-frequency variations in one direction and low-frequency in another. This behavior is fundamentally linked to the properties of polynomial spaces on squares and is distinct from the inverse inequality provided, although both reflect the properties of high-order polynomials.\n\nThus, to neutralize the $p$-dependent growth in stability constants, we need to set:\n$$\n\\gamma(p) \\sim c\\,\\nu\\,p^2\n$$\nThis scaling ensures that the stability of the overall scheme (LBB condition for the stabilized form) is robust with respect to the polynomial degree $p$. If $\\gamma$ were chosen smaller (e.g., constant), the scheme would lose stability as $p$ increases. If chosen larger, the grad-div term would introduce excessive artificial diffusion, dominating the physics and degrading accuracy.\n\nThe problem asks to identify the leading constant $c$. The precise value of $c$ is the limit of $\\frac{1}{p^2}\\sup \\frac{\\|D^2 q_p\\|^2}{\\|\\Delta q_p\\|^2}$ as $p\\to\\infty$. Calculating this constant requires a detailed analysis of the polynomial basis (e.g., Legendre polynomials on the reference square) and is beyond the scope of a derivation from the given inequalities alone. However, the problem requires a specific closed-form expression depending only on $\\nu$ and $p$. This strongly implies that any other constants of proportionality are to be taken as unity. Such a simplification is common in asymptotic analysis, where the leading-order behavior is of primary interest. Therefore, we identify the leading constant $c$ as $1$.\n\nWith $\\gamma(p) = \\nu p^2$, the stability constants in the error analysis for velocity and pressure become independent of $p$. The standard error estimates for the stabilized Stokes problem then yield:\n$$\n\\|\\boldsymbol{u}^{\\ast} - \\boldsymbol{u}_h\\|_{L^2(\\Omega)} \\le C_u h^{p+1} \\Xi_u(\\boldsymbol{u}^\\ast, p^\\ast, \\nu)\n$$\n$$\n\\|p^{\\ast} - p_h\\|_{L^2(\\Omega)} \\le C_p h^{p+1} \\Xi_p(\\boldsymbol{u}^\\ast, p^\\ast, \\nu)\n$$\nwhere $C_u, C_p$ are independent of $h$ and $p$, and the functions $\\Xi$ contain Sobolev norms of the exact solution, which may grow exponentially with $p$ (e.g., $\\pi^{p+1}$ for the given manufactured solution), but have no algebraic growth in $p$.\n\nThe divergence error $\\|\\nabla\\cdot\\boldsymbol{u}_h\\|_{L^2}$ can then be bounded using the continuity equation, which is augmented by the PSPG term. Given the assumption that the PSPG term is chosen optimally to deliver an $\\mathcal{O}(h^{p+1})$ bound with $p$-independent constants, and given that the velocity and pressure errors are now robustly bounded, the analysis carries through to the divergence error. The choice $\\gamma(p) = \\nu p^2$ ensures that the constants appearing in the full error analysis do not grow algebraically in $p$, achieving the desired error bound:\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}_{h}\\|_{L^{2}(\\Omega)} \\le C\\,h^{p+1}\\,\\Xi(\\boldsymbol{u}^{\\ast},p,\\nu)\n$$\nwhere $C$ is independent of $p$. The given manufactured solution, being smooth and analytic, has the required regularity, and its norms $\\|\\cdot\\|_{H^{p+1}}$ grow exponentially with $p$, which is consistent with the problem statement.\n\nTherefore, the appropriate scaling for the grad-div parameter is quadratic in $p$, with a leading constant of $1$ times the viscosity $\\nu$.", "answer": "$$\\boxed{\\gamma(p) = \\nu p^{2}}$$", "id": "3401449"}]}