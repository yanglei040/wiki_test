{"hands_on_practices": [{"introduction": "The central idea of a pressure-correction scheme is to project a non-solenoidal intermediate velocity field onto the space of divergence-free fields, thereby enforcing incompressibility. This is accomplished by solving a Poisson equation for a pressure-like quantity, which is the foundational step of the algorithm. This exercise guides you through the derivation of this crucial equation and its subsequent analytical solution on a periodic domain, reinforcing the fundamental compatibility condition required for such problems [@problem_id:3408423].", "problem": "Consider the incompressible Navier–Stokes equations advanced in time by an incremental pressure-correction scheme on the two-dimensional periodic torus $\\Omega = [0,2\\pi]^{2}$ with periodic boundary conditions in both directions. Let the predicted intermediate velocity field at time level $n+1$ be $\\boldsymbol{u}^{*}(x,y)$, and let the velocity correction be $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi$, where $\\Delta t > 0$ is the time-step and $\\phi$ is the pressure increment. The corrected velocity must satisfy the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$. \n\nStarting from the definitions above and the incompressibility constraint, derive the Poisson equation for the pressure increment $\\phi$ on $\\Omega$ and state the necessary compatibility (mean-zero) condition for solvability on a periodic domain. Then, for the manufactured intermediate velocity\n$$\n\\boldsymbol{u}^{*}(x,y) = \n\\begin{pmatrix}\na \\cos(2x)\\,\\sin(y) + b \\sin(x)\\,\\cos(3y) \\\\\nc \\sin(2x)\\,\\cos(y) + d \\cos(x)\\,\\sin(3y)\n\\end{pmatrix},\n$$\nwith real parameters $a$, $b$, $c$, $d$, compute the divergence source $s(x,y) = \\nabla \\cdot \\boldsymbol{u}^{*}(x,y)$, verify explicitly that $s$ satisfies the mean-zero compatibility condition on $\\Omega$, and solve the Poisson problem for $\\phi$ with the zero-mean gauge $\\int_{\\Omega} \\phi \\, \\mathrm{d}x \\, \\mathrm{d}y = 0$. \n\nProvide your final answer as a single explicit expression for $\\phi(x,y)$ in terms of $a$, $b$, $c$, $d$, and $\\Delta t$. No numerical evaluation is required.", "solution": "The problem statement is parsed and validated. All givens are verbatim:\nDomain: $\\Omega = [0,2\\pi]^{2}$ with periodic boundary conditions.\nVelocity correction: $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi$.\nTime-step: $\\Delta t > 0$.\nIncompressibility constraint: $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$.\nIntermediate velocity:\n$$\n\\boldsymbol{u}^{*}(x,y) = \n\\begin{pmatrix}\na \\cos(2x)\\,\\sin(y) + b \\sin(x)\\,\\cos(3y) \\\\\nc \\sin(2x)\\,\\cos(y) + d \\cos(x)\\,\\sin(3y)\n\\end{pmatrix}\n$$\nwhere $a, b, c, d$ are real parameters.\nGauge condition: $\\int_{\\Omega} \\phi \\, \\mathrm{d}x \\, \\mathrm{d}y = 0$.\n\nThe problem is scientifically grounded, well-posed, objective, and contains sufficient information. It is a standard exercise in the numerical solution of partial differential equations for fluid dynamics. Therefore, the problem is deemed valid and a solution will be provided.\n\nFirst, we derive the Poisson equation for the pressure increment $\\phi$. We start with the velocity correction formula:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi\n$$\nThe corrected velocity field $\\boldsymbol{u}^{n+1}$ must be divergence-free, satisfying the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$. Applying the divergence operator to the velocity correction equation yields:\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot (\\boldsymbol{u}^{*} - \\Delta t \\nabla \\phi)\n$$\nUsing the linearity of the divergence operator, we get:\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^{*} - \\Delta t \\nabla \\cdot (\\nabla \\phi)\n$$\nSubstituting the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$ and recognizing that the divergence of a gradient is the Laplacian operator, $\\nabla \\cdot (\\nabla \\phi) = \\nabla^2 \\phi$, we obtain:\n$$\n0 = \\nabla \\cdot \\boldsymbol{u}^{*} - \\Delta t \\nabla^2 \\phi\n$$\nRearranging this equation gives the Poisson equation for the pressure increment $\\phi$:\n$$\n\\nabla^2 \\phi = \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{*}\n$$\nFor this elliptic partial differential equation to have a solution on a periodic domain $\\Omega$, a compatibility condition must be satisfied. This condition is found by integrating the equation over the domain:\n$$\n\\int_{\\Omega} \\nabla^2 \\phi \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{*} \\, \\mathrm{d}\\Omega\n$$\nUsing the divergence theorem, the left-hand side can be converted to a boundary integral:\n$$\n\\int_{\\Omega} \\nabla \\cdot (\\nabla \\phi) \\, \\mathrm{d}\\Omega = \\int_{\\partial \\Omega} (\\nabla \\phi) \\cdot \\boldsymbol{n} \\, \\mathrm{d}S\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal vector to the boundary $\\partial \\Omega$. Due to the periodic boundary conditions on the torus $\\Omega = [0, 2\\pi]^2$, the integrals over opposite faces of the domain cancel each other out, resulting in $\\int_{\\partial \\Omega} (\\nabla \\phi) \\cdot \\boldsymbol{n} \\, \\mathrm{d}S = 0$.\nThus, the compatibility condition becomes:\n$$\n\\int_{\\Omega} \\frac{1}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^{*} \\, \\mathrm{d}\\Omega = 0\n$$\nSince $\\Delta t > 0$ is a constant, this simplifies to the mean-zero condition for the divergence of the intermediate velocity field:\n$$\n\\int_{\\Omega} \\nabla \\cdot \\boldsymbol{u}^{*} \\, \\mathrm{d}\\Omega = 0\n$$\nNext, we compute the divergence source term $s(x,y) = \\nabla \\cdot \\boldsymbol{u}^{*}(x,y)$ for the given intermediate velocity field. Let $u^*$ and $v^*$ be the components of $\\boldsymbol{u}^{*}$:\n$$\nu^{*}(x,y) = a \\cos(2x)\\sin(y) + b \\sin(x)\\cos(3y)\n$$\n$$\nv^{*}(x,y) = c \\sin(2x)\\cos(y) + d \\cos(x)\\sin(3y)\n$$\nThe divergence is $s(x,y) = \\frac{\\partial u^{*}}{\\partial x} + \\frac{\\partial v^{*}}{\\partial y}$. We compute the partial derivatives:\n$$\n\\frac{\\partial u^{*}}{\\partial x} = -2a \\sin(2x)\\sin(y) + b \\cos(x)\\cos(3y)\n$$\n$$\n\\frac{\\partial v^{*}}{\\partial y} = -c \\sin(2x)\\sin(y) + 3d \\cos(x)\\cos(3y)\n$$\nSumming these gives the source term:\n$$\ns(x,y) = -(2a+c)\\sin(2x)\\sin(y) + (b+3d)\\cos(x)\\cos(3y)\n$$\nNow, we must explicitly verify that this source term satisfies the compatibility condition on $\\Omega = [0,2\\pi]^2$:\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} s(x,y) \\, \\mathrm{d}x \\, \\mathrm{d}y = \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left[ -(2a+c)\\sin(2x)\\sin(y) + (b+3d)\\cos(x)\\cos(3y) \\right] \\, \\mathrm{d}x \\, \\mathrm{d}y\n$$\nWe can split the integral:\n$$\n= -(2a+c) \\left(\\int_{0}^{2\\pi} \\sin(2x) \\, \\mathrm{d}x \\right) \\left(\\int_{0}^{2\\pi} \\sin(y) \\, \\mathrm{d}y \\right) + (b+3d) \\left(\\int_{0}^{2\\pi} \\cos(x) \\, \\mathrm{d}x \\right) \\left(\\int_{0}^{2\\pi} \\cos(3y) \\, \\mathrm{d}y \\right)\n$$\nThe integral of $\\sin(kx)$ or $\\cos(kx)$ over a full period $[0, 2\\pi]$ is zero for any non-zero integer $k$. In our case, the integers are $k=1, 2, 3$.\n$$\n\\int_{0}^{2\\pi} \\sin(2x) \\, \\mathrm{d}x = 0, \\quad \\int_{0}^{2\\pi} \\sin(y) \\, \\mathrm{d}y = 0\n$$\n$$\n\\int_{0}^{2\\pi} \\cos(x) \\, \\mathrm{d}x = 0, \\quad \\int_{0}^{2\\pi} \\cos(3y) \\, \\mathrm{d}y = 0\n$$\nTherefore, the total integral is $0$, and the compatibility condition is satisfied.\n\nFinally, we solve the Poisson problem for $\\phi$:\n$$\n\\nabla^2 \\phi = \\frac{s(x,y)}{\\Delta t} = \\frac{1}{\\Delta t} \\left[ -(2a+c)\\sin(2x)\\sin(y) + (b+3d)\\cos(x)\\cos(3y) \\right]\n$$\nGiven the form of the source term, we seek a solution of the form:\n$$\n\\phi(x,y) = A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y)\n$$\nwhere $A$ and $B$ are constants to be determined. We compute the Laplacian of this ansatz:\n$$\n\\nabla^2 \\phi = \\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2}\n$$\n$$\n\\frac{\\partial^2}{\\partial x^2} \\left[A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y) \\right] = -4A \\sin(2x)\\sin(y) - B \\cos(x)\\cos(3y)\n$$\n$$\n\\frac{\\partial^2}{\\partial y^2} \\left[A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y) \\right] = -A \\sin(2x)\\sin(y) - 9B \\cos(x)\\cos(3y)\n$$\nSumming these gives:\n$$\n\\nabla^2 \\phi = (-4A-A)\\sin(2x)\\sin(y) + (-B-9B)\\cos(x)\\cos(3y)\n$$\n$$\n\\nabla^2 \\phi = -5A \\sin(2x)\\sin(y) - 10B \\cos(x)\\cos(3y)\n$$\nBy comparing the coefficients of this expression with the Poisson equation, we find:\n$$\n-5A = -\\frac{2a+c}{\\Delta t} \\implies A = \\frac{2a+c}{5\\Delta t}\n$$\n$$\n-10B = \\frac{b+3d}{\\Delta t} \\implies B = -\\frac{b+3d}{10\\Delta t}\n$$\nThe general solution is $\\phi(x,y) = A \\sin(2x)\\sin(y) + B \\cos(x)\\cos(3y) + C_{0}$ for some constant $C_{0}$. We use the zero-mean gauge condition $\\int_{\\Omega} \\phi \\, \\mathrm{d}x \\, \\mathrm{d}y = 0$ to determine $C_{0}$.\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left[ \\left(\\frac{2a+c}{5\\Delta t}\\right) \\sin(2x)\\sin(y) - \\left(\\frac{b+3d}{10\\Delta t}\\right) \\cos(x)\\cos(3y) + C_{0} \\right] \\, \\mathrm{d}x \\, \\mathrm{d}y = 0\n$$\nAs established previously, the integrals of the trigonometric terms over the domain are zero. This leaves:\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} C_{0} \\, \\mathrm{d}x \\, \\mathrm{d}y = C_{0} (2\\pi)^2 = 4\\pi^2 C_{0} = 0 \\implies C_{0} = 0\n$$\nThus, the unique solution for $\\phi$ is:\n$$\n\\phi(x,y) = \\frac{2a+c}{5\\Delta t} \\sin(2x)\\sin(y) - \\frac{b+3d}{10\\Delta t} \\cos(x)\\cos(3y)\n$$", "answer": "$$\n\\boxed{\\frac{2a+c}{5 \\Delta t}\\sin(2x)\\sin(y) - \\frac{b+3d}{10 \\Delta t}\\cos(x)\\cos(3y)}\n$$", "id": "3408423"}, {"introduction": "A numerically sound scheme must not only be accurate but also stable, ensuring that errors do not grow uncontrollably over time. When terms like convection are treated explicitly for computational efficiency, we introduce stability constraints that limit the maximum allowable size of the time step, $\\Delta t$. This practice delves into the von Neumann stability analysis, a powerful Fourier-based tool, to determine the precise Courant-Friedrichs-Lewy (CFL) condition for a pressure-correction scheme that uses an explicit, first-order upwind discretization for the advection term [@problem_id:3408401].", "problem": "Consider the incompressible Navier–Stokes equations for a velocity field $\\mathbf{u}(\\mathbf{x},t)$ and kinematic pressure $p(\\mathbf{x},t)$,\n$$\n\\partial_{t}\\mathbf{u} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} + \\nabla p - \\nu \\Delta \\mathbf{u} = \\mathbf{0}, \\quad \\nabla\\cdot\\mathbf{u} = 0,\n$$\nposed on a $d$-dimensional periodic box with uniform grid spacings $\\{h_{j}\\}_{j=1}^{d}$ in each Cartesian direction. Consider a pressure-correction scheme in either its incremental or rotational variant in which the diffusion and pressure-gradient terms are treated implicitly, while the convection term is treated explicitly in the tentative velocity step. Linearize the convection term around a nonzero, constant mean flow $\\mathbf{U} \\in \\mathbb{R}^{d}$ so that the perturbation velocity $\\mathbf{v}$ satisfies a linear convective operator $(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}$. Assume the following numerical ingredients:\n\n- The explicit convection update uses the forward Euler method in time.\n- The spatial discretization of $(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}$ in direction $x_{j}$ uses the first-order upwind difference consistent with the sign of $U_{j}$, applied componentwise to $\\mathbf{v}$.\n- The projection step onto the divergence-free subspace is computed exactly via a Poisson solve with periodic boundary conditions.\n\nPerform a von Neumann (Fourier) stability analysis of the linearized, explicit convection update for the solenoidal component of $\\mathbf{v}$, taking into account that the subsequent pressure projection is an $L^{2}$-orthogonal projection. Derive the condition on the time step $\\Delta t$ that ensures the magnitude of the Fourier-mode amplification factor is at most one for all wavenumbers. Express the largest admissible time step $\\Delta t_{\\max}$ as a single closed-form analytic expression in terms of $\\{U_{j}\\}_{j=1}^{d}$ and $\\{h_{j}\\}_{j=1}^{d}$. Your final answer must be a single analytical expression. Do not round. State your result explicitly for general dimension $d$.", "solution": "The user wants to perform a von Neumann stability analysis of a pressure-correction scheme for the linearized incompressible Navier-Stokes equations.\n\n### Step 1: Extract Givens\n- **Governing Equations**: Linearized incompressible Navier-Stokes equations for perturbation velocity $\\mathbf{v}$ and kinematic pressure $p'$:\n  $$ \\partial_{t}\\mathbf{v} + (\\mathbf{U}\\cdot\\nabla)\\mathbf{v} + \\nabla p' - \\nu \\Delta \\mathbf{v} = \\mathbf{0}, \\quad \\nabla\\cdot\\mathbf{v} = 0 $$\n- **Domain**: A $d$-dimensional periodic box.\n- **Discretization**: Uniform grid with spacings $\\{h_{j}\\}_{j=1}^{d}$.\n- **Numerical Scheme**: A pressure-correction scheme (incremental or rotational).\n- **Time Integration**: The explicit convection term is treated with the forward Euler method. Diffusion and pressure-gradient terms are treated implicitly.\n- **Convection Discretization**: The linearized convection term, $(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}$, is discretized using first-order upwind differencing for each component $U_{j}\\partial_{x_j}\\mathbf{v}$.\n- **Projection Step**: The projection onto the divergence-free subspace is exact and is an $L^2$-orthogonal projection.\n- **Analysis Task**: Perform a von Neumann (Fourier) stability analysis for the solenoidal component of $\\mathbf{v}$.\n- **Objective**: Derive the condition on the time step $\\Delta t$ and find the largest admissible time step $\\Delta t_{\\max}$ as a single closed-form expression in terms of $\\{U_{j}\\}_{j=1}^{d}$ and $\\{h_{j}\\}_{j=1}^{d}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in the field of numerical methods for partial differential equations, specifically computational fluid dynamics. The assumptions (linearization, specific discretization schemes, periodic boundary conditions) are standard for performing a von Neumann stability analysis. The problem is self-contained and provides all necessary information to proceed with the analysis. There are no contradictions, ambiguities, or factual unsoundness.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe pressure-correction scheme consists of two main steps. First, a tentative velocity is computed, and second, this velocity is projected onto the divergence-free space. The problem asks for the stability analysis of the \"explicit convection update\" for the solenoidal component of the velocity. The scheme can be written as:\n1.  **Tentative Velocity Step**: A temporary velocity field $\\mathbf{v}^{*}$ is computed. Since only the convection term is treated explicitly with Forward Euler, this step, isolated for stability analysis, is:\n    $$ \\mathbf{v}^* = \\mathbf{v}^n - \\Delta t [(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}^n]_{\\text{disc}} $$\n    where $[(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}^n]_{\\text{disc}}$ is the spatially discretized operator. The implicit terms are ignored for this explicit stability analysis as their inclusion (e.g., with Backward Euler) would only enhance stability.\n\n2.  **Projection Step**: The new velocity $\\mathbf{v}^{n+1}$ is obtained by projecting $\\mathbf{v}^*$ onto the space of divergence-free vector fields.\n    $$ \\mathbf{v}^{n+1} = \\mathbb{P}(\\mathbf{v}^*) $$\n    where $\\mathbb{P}$ is the $L^2$-orthogonal projection operator onto the solenoidal subspace.\n\nCombining these steps, the update rule is:\n$$ \\mathbf{v}^{n+1} = \\mathbb{P}\\left(\\mathbf{v}^n - \\Delta t [(\\mathbf{U}\\cdot\\nabla)\\mathbf{v}^n]_{\\text{disc}}\\right) $$\n\nWe perform a von Neumann stability analysis by considering a single Fourier mode for the velocity field at time step $n$:\n$$ \\mathbf{v}^n(\\mathbf{x}) = \\hat{\\mathbf{v}}^n(\\mathbf{k}) e^{i\\mathbf{k}\\cdot\\mathbf{x}} $$\nwhere $\\mathbf{k}$ is the wavevector. The problem specifies that we analyze the stability for the \"solenoidal component\", which means we assume the initial velocity mode $\\hat{\\mathbf{v}}^n(\\mathbf{k})$ is divergence-free. In Fourier space, the divergence operator $\\nabla\\cdot$ corresponds to multiplication by $i\\mathbf{k}\\cdot$. Thus, a solenoidal velocity satisfies $i\\mathbf{k}\\cdot\\hat{\\mathbf{v}}^n(\\mathbf{k})=0$.\n\nNext, we find the Fourier symbol of the discretized convection operator, $(\\mathbf{U}\\cdot\\nabla)_{\\text{disc}} = \\sum_{j=1}^d U_j (\\partial_{x_j})_{\\text{disc}}$. The operator $(\\partial_{x_j})_{\\text{disc}}$ is a first-order upwind difference. Its form depends on the sign of $U_j$:\n-   If $U_j > 0$, we use a backward difference: $(\\partial_{x_j})_{\\text{disc}}f(\\mathbf{x}) = \\frac{f(\\mathbf{x}) - f(\\mathbf{x} - h_j\\mathbf{e}_j)}{h_j}$.\n-   If $U_j < 0$, we use a forward difference: $(\\partial_{x_j})_{\\text{disc}}f(\\mathbf{x}) = \\frac{f(\\mathbf{x} + h_j\\mathbf{e}_j) - f(\\mathbf{x})}{h_j}$.\n\nLet $\\theta_j = k_j h_j$ be the phase angle in direction $j$. Applying the difference operators to the mode $e^{i\\mathbf{k}\\cdot\\mathbf{x}}$ yields their Fourier symbols:\n-   Symbol of backward difference: $\\frac{1 - e^{-i\\theta_j}}{h_j}$.\n-   Symbol of forward difference: $\\frac{e^{i\\theta_j} - 1}{h_j}$.\n\nThe Fourier symbol $\\hat{\\mathcal{L}}(\\mathbf{k})$ of the complete advection operator $[(\\mathbf{U}\\cdot\\nabla)]_{\\text{disc}}$ acting on $\\mathbf{v}$ is a scalar multiplier for each velocity component:\n$$ \\hat{\\mathcal{L}}(\\mathbf{k}) = \\sum_{j=1, U_j>0}^d U_j \\frac{1-e^{-i\\theta_j}}{h_j} + \\sum_{j=1, U_j<0}^d U_j \\frac{e^{i\\theta_j}-1}{h_j} $$\nWe can write $U_j = |U_j|\\text{sgn}(U_j)$. For $U_j>0$, the term is $\\frac{|U_j|}{h_j}(1-e^{-i\\theta_j})$. For $U_j<0$, the term is $\\frac{-|U_j|}{h_j}(e^{i\\theta_j}-1) = \\frac{|U_j|}{h_j}(1-e^{i\\theta_j})$.\nThis can be expressed compactly as $\\frac{|U_j|}{h_j}(1-e^{-i\\theta_j\\text{sgn}(U_j)})$.\nSumming over all directions $j$:\n$$ \\hat{\\mathcal{L}}(\\mathbf{k}) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1 - e^{-i\\theta_j\\text{sgn}(U_j)}) $$\nThe real and imaginary parts of $\\hat{\\mathcal{L}}(\\mathbf{k})$ are:\n$$ \\text{Re}(\\hat{\\mathcal{L}}(\\mathbf{k})) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1-\\cos(\\theta_j)) $$\n$$ \\text{Im}(\\hat{\\mathcal{L}}(\\mathbf{k})) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}\\text{sgn}(U_j)\\sin(\\theta_j) = \\sum_{j=1}^d \\frac{U_j}{h_j}\\sin(\\theta_j) $$\n\nIn Fourier space, the projection operator $\\mathbb{P}$ is represented by the matrix $\\hat{\\mathbb{P}}(\\mathbf{k}) = \\mathbf{I} - \\frac{\\mathbf{k}\\otimes\\mathbf{k}}{|\\mathbf{k}|^2}$, where $\\mathbf{I}$ is the identity matrix. The Fourier transformed update rule is:\n$$ \\hat{\\mathbf{v}}^{n+1}(\\mathbf{k}) = \\hat{\\mathbb{P}}(\\mathbf{k})\\left( \\hat{\\mathbf{v}}^n(\\mathbf{k}) - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k}) \\hat{\\mathbf{v}}^n(\\mathbf{k}) \\right) = (1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})) \\hat{\\mathbb{P}}(\\mathbf{k}) \\hat{\\mathbf{v}}^n(\\mathbf{k}) $$\nSince we are analyzing the stability of a solenoidal component, $\\hat{\\mathbf{v}}^n(\\mathbf{k})$ is in the divergence-free subspace, meaning $\\mathbf{k}\\cdot\\hat{\\mathbf{v}}^n(\\mathbf{k})=0$. By definition of the projector $\\hat{\\mathbb{P}}(\\mathbf{k})$, this implies $\\hat{\\mathbb{P}}(\\mathbf{k})\\hat{\\mathbf{v}}^n(\\mathbf{k}) = \\hat{\\mathbf{v}}^n(\\mathbf{k})$.\nThe update equation for a solenoidal mode simplifies to:\n$$ \\hat{\\mathbf{v}}^{n+1}(\\mathbf{k}) = (1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})) \\hat{\\mathbf{v}}^n(\\mathbf{k}) $$\nThe amplification factor is the scalar $G(\\mathbf{k}) = 1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$. For stability, its magnitude must be no greater than one for all possible wavevectors $\\mathbf{k}$, i.e., for all $\\theta_j \\in [-\\pi, \\pi]$:\n$$ |G(\\mathbf{k})|^2 = |1 - \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})|^2 \\le 1 $$\nLet $z = \\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$. The stability condition $|1-z| \\le 1$ requires $z$ to lie within a circle of radius $1$ centered at $(1,0)$ in the complex plane.\nLet us analyze the locus of values of $\\hat{\\mathcal{L}}(\\mathbf{k})$. Each term $\\frac{|U_j|}{h_j}(1 - e^{-i\\theta_j\\text{sgn}(U_j)})$ traces a circle in the complex plane centered at $\\frac{|U_j|}{h_j}$ with radius $\\frac{|U_j|}{h_j}$ as $\\theta_j$ varies. The complete symbol $\\hat{\\mathcal{L}}(\\mathbf{k})$ is the sum of these complex numbers.\nThe stability analysis requires us to find the most restrictive condition, which corresponds to the point in the locus of $\\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$ that is furthest from the center of the stability disk $(1,0)$. This is the point with the largest real part.\nThe real part of $\\hat{\\mathcal{L}}(\\mathbf{k})$ is $\\text{Re}(\\hat{\\mathcal{L}}(\\mathbf{k})) = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1-\\cos(\\theta_j))$. This expression is maximized when $\\cos(\\theta_j) = -1$ for all $j=1, \\dots, d$. This occurs for the high-frequency mode where $\\theta_j = \\pi$ for all $j$.\nAt this \"worst-case\" wavevector, the symbol becomes:\n$$ \\hat{\\mathcal{L}}_{\\text{worst}} = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1 - \\cos(\\pi)) + i \\sum_{j=1}^d \\frac{U_j}{h_j}\\sin(\\pi) $$\n$$ \\hat{\\mathcal{L}}_{\\text{worst}} = \\sum_{j=1}^d \\frac{|U_j|}{h_j}(1 - (-1)) + 0 = 2\\sum_{j=1}^d \\frac{|U_j|}{h_j} $$\nThis value is purely real. The stability condition for this point is:\n$$ |1 - \\Delta t \\hat{\\mathcal{L}}_{\\text{worst}}| \\le 1 $$\n$$ |1 - 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j}| \\le 1 $$\nSince $\\Delta t$, $|U_j|$, and $h_j$ are all non-negative, the term $2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j}$ is non-negative. The inequality is equivalent to:\n$$ -1 \\le 1 - 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} \\le 1 $$\nThe right side of the inequality, $1 - 2\\Delta t \\sum \\dots \\le 1$, implies $-2\\Delta t \\sum \\dots \\le 0$, which is always true.\nThe left side gives the stability constraint:\n$$ -1 \\le 1 - 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} $$\n$$ 2\\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} \\le 2 $$\n$$ \\Delta t \\sum_{j=1}^d \\frac{|U_j|}{h_j} \\le 1 $$\nThis is the stability condition, known as the Courant-Friedrichs-Lewy (CFL) condition for the multidimensional advection equation with a first-order upwind scheme. The largest admissible time step $\\Delta t_{\\max}$ is obtained when equality holds:\n$$ \\Delta t_{\\max} = \\frac{1}{\\sum_{j=1}^d \\frac{|U_j|}{h_j}} $$\nThis condition is not only necessary (as it arises from a specific mode) but also sufficient. This can be shown by noting that the locus of all possible values of $\\hat{\\mathcal{L}}(\\mathbf{k})$ is contained within a circle of radius $C = \\sum_{j=1}^d \\frac{|U_j|}{h_j}$ centered at $C$. The condition $\\Delta t C \\le 1$ ensures that the scaled locus $\\Delta t \\hat{\\mathcal{L}}(\\mathbf{k})$ is contained entirely within the stability disk $|z-1|\\le 1$.", "answer": "$$ \\boxed{\\left( \\sum_{j=1}^{d} \\frac{|U_{j}|}{h_{j}} \\right)^{-1}} $$", "id": "3408401"}, {"introduction": "Beyond consistency and stability, the quality of a numerical scheme for incompressible flow is often assessed by more subtle properties, such as pressure robustness. A non-robust scheme can generate significant velocity errors in the presence of strong pressure gradients, even when the forcing should physically only affect the pressure field. This exercise provides a concrete, hands-on investigation into how the choice of spatial discretization, modeled here by different finite element pairs, interacts with both incremental and rotational pressure-correction algorithms to either preserve or violate this crucial property [@problem_id:3408410].", "problem": "Consider the semi-discrete (in time) incompressible Stokes equations on an abstract domain with velocity unknown $u^{n+1}$ and pressure unknown $p^{n+1}$ at time step $n+1$,\n$$\n\\frac{u^{n+1}-u^n}{\\Delta t} - \\nu \\Delta u^{n+\\theta} + \\nabla p^{n+\\theta} = f, \\quad \\nabla \\cdot u^{n+1} = 0,\n$$\nwhere $0 \\le \\theta \\le 1$, $\\nu$ is kinematic viscosity, and $f$ is a body force. For a pure pressure gradient forcing $f = \\nabla \\chi$ for some scalar field $\\chi$, the exact continuous solution is pressure-robust: the velocity $u$ should be unaffected by $f$, because $\\nabla \\chi$ can be absorbed by redefining the pressure as $p' = p - \\chi$. We analyze how two pressure-correction strategies, Incremental Pressure-Correction (IPC) and Rotational Pressure-Correction (RPC), behave under this pure pressure-gradient forcing in finite-dimensional discretizations that mimic Finite Element (FE) pairs:\n- The classical Taylor–Hood $\\mathbb{P}_2$–$\\mathbb{P}_1$ pair (stable without pressure stabilization).\n- The equal-order stabilized $\\mathbb{P}_1$–$\\mathbb{P}_1$ pair (requiring pressure stabilization).\n\nWe work with an algebraic surrogate of the spatial discretization that captures the essential operators:\n- Let $M \\in \\mathbb{R}^{n \\times n}$ be the symmetric positive definite velocity mass matrix.\n- Let $B \\in \\mathbb{R}^{m \\times n}$ be the discrete divergence operator; its transpose $B^\\top$ acts as a discrete gradient from the pressure space to the velocity space.\n- Define the discrete Helmholtz operator $H = B M^{-1} B^\\top \\in \\mathbb{R}^{m \\times m}$.\n- For the stabilized equal-order case, let $S \\in \\mathbb{R}^{m \\times m}$ be a symmetric positive definite stabilization (e.g., a pressure Laplacian surrogate), with stabilization parameter $\\tau \\ge 0$.\n\nWe focus on a single time step with given previous pressure $p^n \\in \\mathbb{R}^m$ and pure pressure-gradient forcing parameterized by $q \\in \\mathbb{R}^m$, so that $f = B^\\top q$. We isolate the coupling to pressure by setting the viscous term to zero in the momentum predictor (this does not affect the pressure-robustness assessment for a pure pressure-gradient $f$).\n\nTwo pressure-correction variants are considered:\n\n1. Incremental Pressure-Correction (IPC):\n   - Predictor:\n     $$\n     u^\\ast = u^n + \\Delta t \\, M^{-1} \\left( -B^\\top p^n + B^\\top q \\right).\n     $$\n   - Pressure increment solve (using the pair-dependent operator $P$):\n     $$\n     P \\, \\delta p = H \\, (q - p^n).\n     $$\n   - Corrector:\n     $$\n     u^{n+1}_{\\mathrm{IPC}} = u^\\ast - \\Delta t \\, M^{-1} B^\\top \\delta p, \\quad p^{n+1} = p^n + \\delta p.\n     $$\n\n2. Rotational Pressure-Correction (RPC):\n   - Predictor (no old pressure in momentum):\n     $$\n     u^\\ast = u^n + \\Delta t \\, M^{-1} B^\\top q.\n     $$\n   - Pressure solve (using the pair-dependent operator $P$):\n     $$\n     P \\, p^{n+1} = H \\, q + \\tau \\, S \\, p^n.\n     $$\n   - Corrector:\n     $$\n     u^{n+1}_{\\mathrm{RPC}} = u^\\ast - \\Delta t \\, M^{-1} B^\\top p^{n+1}.\n     $$\n\nFor the Taylor–Hood $\\mathbb{P}_2$–$\\mathbb{P}_1$ pair, take $P = H$ (no stabilization). For the stabilized equal-order $\\mathbb{P}_1$–$\\mathbb{P}_1$ pair, take $P = H + \\tau S$.\n\nDefine the pressure-robustness sensitivity of a scheme to the pure pressure-gradient forcing as the ratio\n$$\n\\mathcal{S} = \\frac{\\| u^{n+1} \\|_M}{\\| u_{\\mathrm{force}} \\|_M},\n$$\nwhere $\\| v \\|_M = \\sqrt{v^\\top M v}$ is the $M$-weighted norm and\n$$\nu_{\\mathrm{force}} = \\Delta t \\, M^{-1} B^\\top q\n$$\nis the velocity scale induced solely by the forcing. A perfectly pressure-robust method produces $\\mathcal{S} = 0$ regardless of $q$.\n\nYou must implement a program that computes $\\mathcal{S}$ for both IPC and RPC for the following fixed matrices and vectors (all entries are dimensionless):\n- Velocity mass matrix\n  $$\n  M = \\mathrm{diag}(1,\\,2,\\,3,\\,4) \\in \\mathbb{R}^{4 \\times 4}.\n  $$\n- Divergence operator\n  $$\n  B = \\begin{bmatrix}\n  1 & -1 & 0 & 0 \\\\\n  0 & 0 & 1 & -1\n  \\end{bmatrix} \\in \\mathbb{R}^{2 \\times 4}.\n  $$\n- Stabilization matrix\n  $$\n  S = I_2 \\in \\mathbb{R}^{2 \\times 2}.\n  $$\n- Time step\n  $$\n  \\Delta t = 0.125.\n  $$\n- Previous pressure\n  $$\n  p^n = \\begin{bmatrix} 0.7 \\\\ -0.4 \\end{bmatrix}.\n  $$\n- Forcing parameter\n  $$\n  q = \\begin{bmatrix} 1.1 \\\\ 0.9 \\end{bmatrix}.\n  $$\n\nTest Suite:\n- Case 1 (Taylor–Hood $\\mathbb{P}_2$–$\\mathbb{P}_1$): $\\tau = 0$, so $P = H$.\n- Case 2 (Equal-order stabilized $\\mathbb{P}_1$–$\\mathbb{P}_1$): $\\tau = 0.3$, so $P = H + 0.3\\,S$.\n- Case 3 (Equal-order stabilized $\\mathbb{P}_1$–$\\mathbb{P}_1$): $\\tau = 1.0$, so $P = H + 1.0\\,S$.\n\nFor each case, compute and report two floats: $\\mathcal{S}_{\\mathrm{IPC}}$ and $\\mathcal{S}_{\\mathrm{RPC}}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets and ordered as\n$$\n[\\mathcal{S}_{\\mathrm{IPC}}^{(1)}, \\mathcal{S}_{\\mathrm{RPC}}^{(1)}, \\mathcal{S}_{\\mathrm{IPC}}^{(2)}, \\mathcal{S}_{\\mathrm{RPC}}^{(2)}, \\mathcal{S}_{\\mathrm{IPC}}^{(3)}, \\mathcal{S}_{\\mathrm{RPC}}^{(3)}],\n$$\nwhere the superscript $(k)$ denotes Case $k$ in the test suite. Each entry must be a floating-point number. No physical units apply in this problem.", "solution": "The user-provided problem has been validated and is deemed a valid, well-posed problem in the field of numerical analysis for partial differential equations. The one ambiguity, the value of the initial velocity $u^n$, is resolved by making the standard assumption that $u^n=0$ for this type of sensitivity analysis, which aims to isolate the error generated by the forcing term.\n\nThe problem requires the computation of a pressure-robustness sensitivity metric, $\\mathcal{S}$, for two pressure-correction schemes (Incremental and Rotational) applied to a model of the incompressible Stokes equations. The analysis is performed for three different scenarios corresponding to different finite element pairings, controlled by a stabilization parameter $\\tau$.\n\nThe sensitivity is defined as:\n$$\n\\mathcal{S} = \\frac{\\| u^{n+1} \\|_M}{\\| u_{\\mathrm{force}} \\|_M}\n$$\nwhere $\\| v \\|_M = \\sqrt{v^\\top M v}$ is the energy norm induced by the mass matrix $M$, and $u_{\\mathrm{force}} = \\Delta t \\, M^{-1} B^\\top q$ is a velocity scale associated with the pure pressure-gradient forcing $f = B^\\top q$.\n\nThe analysis will proceed in the following steps:\n1.  Define the constant matrices and vectors from the problem statement.\n2.  Derive the expressions for the final velocity $u^{n+1}$ for both schemes under the assumption that the velocity at the previous time step is zero, $u^n=0$. This assumption isolates the response of the schemes to the forcing term $f$ and previous pressure $p^n$.\n3.  Demonstrate the algebraic equivalence of the resulting velocities, $u^{n+1}_{\\mathrm{IPC}}$ and $u^{n+1}_{\\mathrm{RPC}}$, under this assumption.\n4.  Calculate the constant denominator $\\| u_{\\mathrm{force}} \\|_M$.\n5.  Iterate through each test case defined by the parameter $\\tau$, calculate the corresponding velocity $u^{n+1}$ and its $M$-norm, and compute the sensitivity $\\mathcal{S}$.\n\n**Step 1: Setup and Constant Matrices**\nThe provided algebraic components are:\n-   Velocity mass matrix: $M = \\mathrm{diag}(1, 2, 3, 4)$\n-   Stabilization matrix: $S = I_2 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$\n-   Divergence operator: $B = \\begin{bmatrix} 1 & -1 & 0 & 0 \\\\ 0 & 0 & 1 & -1 \\end{bmatrix}$\n-   Time step: $\\Delta t = 0.125$\n-   Previous pressure: $p^n = [0.7, -0.4]^\\top$\n-   Forcing parameter: $q = [1.1, 0.9]^\\top$\n\nFrom these, we derive the inverse mass matrix $M^{-1}$, the discrete gradient $B^\\top$, and the discrete Helmholtz operator $H$:\n$$\nM^{-1} = \\mathrm{diag}(1, 1/2, 1/3, 1/4)\n$$\n$$\nB^\\top = \\begin{bmatrix} 1 & 0 \\\\ -1 & 0 \\\\ 0 & 1 \\\\ 0 & -1 \\end{bmatrix}\n$$\n$$\nH = B M^{-1} B^\\top = \\begin{bmatrix} 1 & -1 & 0 & 0 \\\\ 0 & 0 & 1 & -1 \\end{bmatrix} \\begin{pmatrix} 1 & 0 \\\\ -1/2 & 0 \\\\ 0 & 1/3 \\\\ 0 & -1/4 \\end{pmatrix} = \\begin{bmatrix} 1.5 & 0 \\\\ 0 & 7/12 \\end{bmatrix}\n$$\n\n**Step 2: Velocity Update Expressions**\nAssuming $u^n=0$, the schemes simplify.\n\nFor Incremental Pressure-Correction (IPC):\n$$\nu^\\ast = \\Delta t \\, M^{-1} (B^\\top q - B^\\top p^n)\n$$\n$$\nP \\, \\delta p = H \\, (q - p^n) \\implies \\delta p = P^{-1} H (q - p^n)\n$$\n$$\nu^{n+1}_{\\mathrm{IPC}} = u^\\ast - \\Delta t \\, M^{-1} B^\\top \\delta p = \\Delta t \\, M^{-1} B^\\top (q - p^n) - \\Delta t \\, M^{-1} B^\\top (P^{-1} H (q - p^n))\n$$\n$$\nu^{n+1}_{\\mathrm{IPC}} = \\Delta t \\, M^{-1} B^\\top (I - P^{-1}H)(q - p^n)\n$$\n\nFor Rotational Pressure-Correction (RPC):\n$$\nu^\\ast = \\Delta t \\, M^{-1} B^\\top q\n$$\n$$\nP \\, p^{n+1} = H \\, q + \\tau \\, S \\, p^n \\implies p^{n+1} = P^{-1} (Hq + \\tau S p^n)\n$$\n$$\nu^{n+1}_{\\mathrm{RPC}} = u^\\ast - \\Delta t \\, M^{-1} B^\\top p^{n+1} = \\Delta t \\, M^{-1} B^\\top q - \\Delta t \\, M^{-1} B^\\top (P^{-1} (Hq + \\tau S p^n))\n$$\n$$\nu^{n+1}_{\\mathrm{RPC}} = \\Delta t \\, M^{-1} B^\\top (q - P^{-1}Hq - \\tau P^{-1} S p^n) = \\Delta t \\, M^{-1} B^\\top ((I - P^{-1}H)q - \\tau P^{-1} S p^n)\n$$\n\n**Step 3: Algebraic Equivalence**\nWe now show that $u^{n+1}_{\\mathrm{IPC}} = u^{n+1}_{\\mathrm{RPC}}$. This requires equating the vectors inside the parentheses of the final expressions.\nThe vector from IPC is $(I - P^{-1}H)(q - p^n) = (I - P^{-1}H)q - (I - P^{-1}H)p^n$.\nThe vector from RPC is $(I - P^{-1}H)q - \\tau P^{-1} S p^n$.\nEquating them implies we must show:\n$$\n-(I - P^{-1}H)p^n = - \\tau P^{-1} S p^n\n$$\n$$\n-p^n + P^{-1}Hp^n = - \\tau P^{-1} S p^n\n$$\nMultiplying by $P$ from the left:\n$$\n-P p^n + H p^n = - \\tau S p^n\n$$\nSubstitute $P = H + \\tau S$:\n$$\n-(H + \\tau S)p^n + H p^n = - \\tau S p^n\n$$\n$$\n-H p^n - \\tau S p^n + H p^n = - \\tau S p^n\n$$\n$$\n-\\tau S p^n = -\\tau S p^n\n$$\nThis identity holds. Therefore, for any choice of parameters, $u^{n+1}_{\\mathrm{IPC}} = u^{n+1}_{\\mathrm{RPC}}$ given the assumption $u^n=0$. This means $\\mathcal{S}_{\\mathrm{IPC}} = \\mathcal{S}_{\\mathrm{RPC}}$ in all test cases.\n\n**Step 4: Denominator Calculation**\nThe velocity scale is:\n$$\nu_{\\mathrm{force}} = \\Delta t \\, M^{-1} B^\\top q = 0.125 \\begin{pmatrix} 1 & 0 \\\\ -1/2 & 0 \\\\ 0 & 1/3 \\\\ 0 & -1/4 \\end{pmatrix} \\begin{pmatrix} 1.1 \\\\ 0.9 \\end{pmatrix} = 0.125 \\begin{pmatrix} 1.1 \\\\ -0.55 \\\\ 0.3 \\\\ -0.225 \\end{pmatrix} = \\begin{pmatrix} 0.1375 \\\\ -0.06875 \\\\ 0.0375 \\\\ -0.028125 \\end{pmatrix}\n$$\nThe squared $M$-norm is $\\|u_{\\mathrm{force}}\\|_M^2 = u_{\\mathrm{force}}^\\top M u_{\\mathrm{force}}$:\n$$\n\\|u_{\\mathrm{force}}\\|_M^2 = 1(0.1375^2) + 2(-0.06875^2) + 3(0.0375^2) + 4(-0.028125^2) = 0.0357421875\n$$\n$$\n\\|u_{\\mathrm{force}}\\|_M = \\sqrt{0.0357421875} \\approx 0.189056041\n$$\nThis is the constant denominator for all sensitivity calculations.\n\n**Step 5: Case-by-Case Computation**\nLet $u^{n+1} = u^{n+1}_{\\mathrm{IPC}} = u^{n+1}_{\\mathrm{RPC}}$. Its norm can be computed efficiently:\n$$\n\\|u^{n+1}\\|_M^2 = (\\Delta t)^2 \\left((I - P^{-1}H)(q-p^n)\\right)^\\top H \\left((I - P^{-1}H)(q-p^n)\\right)\n$$\nLet $\\phi = (I - P^{-1}H)(q-p^n)$. Then $\\|u^{n+1}\\|_M = \\Delta t \\sqrt{\\phi^\\top H \\phi}$.\n\nCase 1: $\\tau=0$ (Taylor–Hood)\n$P = H$. Thus $P^{-1}H = H^{-1}H = I$.\n$\\phi = (I-I)(q-p^n) = 0$.\n$\\|u^{n+1}\\|_M = 0$.\n$\\mathcal{S}_{\\mathrm{IPC}} = \\mathcal{S}_{\\mathrm{RPC}} = 0 / \\|u_{\\mathrm{force}}\\|_M = 0.0$.\n\nCase 2: $\\tau=0.3$ (Stabilized equal-order)\n$P = H + 0.3S = \\begin{bmatrix} 1.5 & 0 \\\\ 0 & 7/12 \\end{bmatrix} + \\begin{bmatrix} 0.3 & 0 \\\\ 0 & 0.3 \\end{bmatrix} = \\begin{bmatrix} 1.8 & 0 \\\\ 0 & 53/60 \\end{bmatrix}$.\n$I-P^{-1}H = \\begin{bmatrix} 1-1.5/1.8 & 0 \\\\ 0 & 1-(7/12)/(53/60) \\end{bmatrix} = \\begin{bmatrix} 1/6 & 0 \\\\ 0 & 18/53 \\end{bmatrix}$.\n$q-p^n = [0.4, 1.3]^\\top$.\n$\\phi = \\begin{bmatrix} 1/6 & 0 \\\\ 0 & 18/53 \\end{bmatrix} \\begin{pmatrix} 0.4 \\\\ 1.3 \\end{pmatrix} = \\begin{pmatrix} 1/15 \\\\ 23.4/53 \\end{pmatrix}$.\n$\\phi^\\top H \\phi = 1.5(1/15)^2 + (7/12)(23.4/53)^2 \\approx 0.12037768$.\n$\\|u^{n+1}\\|_M = 0.125 \\sqrt{0.12037768} \\approx 0.04336937$.\n$\\mathcal{S} = 0.04336937 / 0.189056041 \\approx 0.229390$.\n$\\mathcal{S}_{\\mathrm{IPC}} = \\mathcal{S}_{\\mathrm{RPC}} \\approx 0.229390$.\n\nCase 3: $\\tau=1.0$ (Stabilized equal-order)\n$P = H + 1.0S = \\begin{bmatrix} 1.5 & 0 \\\\ 0 & 7/12 \\end{bmatrix} + \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 2.5 & 0 \\\\ 0 & 19/12 \\end{bmatrix}$.\n$I-P^{-1}H = \\begin{bmatrix} 1-1.5/2.5 & 0 \\\\ 0 & 1-(7/12)/(19/12) \\end{bmatrix} = \\begin{bmatrix} 2/5 & 0 \\\\ 0 & 12/19 \\end{bmatrix}$.\n$\\phi = \\begin{bmatrix} 2/5 & 0 \\\\ 0 & 12/19 \\end{bmatrix} \\begin{pmatrix} 0.4 \\\\ 1.3 \\end{pmatrix} = \\begin{pmatrix} 0.16 \\\\ 15.6/19 \\end{pmatrix}$.\n$\\phi^\\top H \\phi = 1.5(0.16)^2 + (7/12)(15.6/19)^2 \\approx 0.431640228$.\n$\\|u^{n+1}\\|_M = 0.125 \\sqrt{0.431640228} \\approx 0.082124165$.\n$\\mathcal{S} = 0.082124165 / 0.189056041 \\approx 0.434399$.\n$\\mathcal{S}_{\\mathrm{IPC}} = \\mathcal{S}_{\\mathrm{RPC}} \\approx 0.434399$.\n\nThe final results are collected and formatted as specified. The non-zero sensitivity in cases $2$ and $3$ demonstrates the loss of pressure-robustness when stabilization ($\\tau > 0$) is introduced in this manner.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the pressure-robustness sensitivity for IPC and RPC schemes.\n    \"\"\"\n    \n    # Define the fixed matrices and vectors from the problem statement.\n    M = np.diag([1.0, 2.0, 3.0, 4.0])\n    B = np.array([[1.0, -1.0, 0.0, 0.0],\n                  [0.0,  0.0, 1.0, -1.0]])\n    S = np.eye(2)\n    dt = 0.125\n    p_n = np.array([0.7, -0.4])\n    q = np.array([1.1, 0.9])\n\n    # Test cases for the stabilization parameter tau\n    test_cases = [\n        0.0,  # Case 1: Taylor-Hood\n        0.3,  # Case 2: Equal-order stabilized\n        1.0,  # Case 3: Equal-order stabilized\n    ]\n\n    # Pre-compute constant matrices and vectors\n    M_inv = np.linalg.inv(M)\n    B_T = B.T\n    H = B @ M_inv @ B_T\n\n    # Compute the reference velocity scale and its M-norm (denominator of S)\n    u_force = dt * M_inv @ B_T @ q\n    norm_u_force_M = np.sqrt(u_force.T @ M @ u_force)\n\n    results = []\n    \n    # As established in the solution, u_n=0 is the standard assumption\n    # for this type of analysis to isolate the error from the forcing term.\n    # We also showed that with u_n=0, u_np1_IPC and u_np1_RPC are identical.\n    # We will compute both to numerically verify this conclusion.\n\n    for tau in test_cases:\n        # Define the pair-dependent operator P\n        P = H + tau * S\n        P_inv = np.linalg.inv(P)\n\n        # --- IPC Calculation ---\n        # u_np1_ipc = dt * M_inv @ B_T @ (I - P_inv @ H) @ (q - p_n)\n        \n        # Calculate the pressure-related vector phi_ipc\n        C = np.eye(2) - P_inv @ H\n        q_minus_pn = q - p_n\n        phi_ipc = C @ q_minus_pn\n        \n        # Calculate the final velocity u_np1\n        u_np1_ipc = dt * M_inv @ B_T @ phi_ipc\n        \n        # Calculate its M-norm\n        norm_u_np1_ipc_M = np.sqrt(u_np1_ipc.T @ M @ u_np1_ipc)\n        \n        # Calculate sensitivity S_ipc\n        # Handle division by zero for the perfectly robust case\n        S_ipc = norm_u_np1_ipc_M / norm_u_force_M if norm_u_force_M > 0 else 0.0\n        \n        # --- RPC Calculation ---\n        # u_np1_rpc = dt * M_inv @ B_T @ ((I - P_inv @ H) @ q - tau * P_inv @ S @ p_n)\n\n        # Calculate the pressure-related vector phi_rpc\n        phi_rpc = C @ q - tau * P_inv @ S @ p_n\n\n        # Calculate the final velocity u_np1\n        u_np1_rpc = dt * M_inv @ B_T @ phi_rpc\n        \n        # Calculate its M-norm\n        norm_u_np1_rpc_M = np.sqrt(u_np1_rpc.T @ M @ u_np1_rpc)\n\n        # Calculate sensitivity S_rpc\n        S_rpc = norm_u_np1_rpc_M / norm_u_force_M if norm_u_force_M > 0 else 0.0\n\n        results.extend([S_ipc, S_rpc])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3408410"}]}