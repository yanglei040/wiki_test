{"hands_on_practices": [{"introduction": "The Harten-Lax-van Leer (HLL) solver is a cornerstone of robust numerical methods for hyperbolic systems, offering a simple yet effective way to approximate the solution to a Riemann problem. This exercise provides fundamental practice in constructing the HLL numerical flux, a critical component in finite volume schemes. By manually calculating the flux from given left and right states, you will gain a concrete understanding of how the solver uses estimated wave speeds, $S_L$ and $S_R$, to create a stable and conservative interface flux [@problem_id:3364359].", "problem": "Consider the one-dimensional compressible Euler equations for a calorically perfect gas with ratio of specific heats $\\gamma$. Let the left and right states at an interface be given in primitive variables as $(\\rho_L,u_L,p_L)$ and $(\\rho_R,u_R,p_R)$, with corresponding conservative variables $\\boldsymbol{U}=(\\rho,\\rho u,E)^\\top$ and physical flux $\\boldsymbol{F}(\\boldsymbol{U})=(\\rho u,\\rho u^2+p,u(E+p))^\\top$. Assume the ideal-gas speed of sound $a=\\sqrt{\\gamma p/\\rho}$. Using Davis's wave speed estimates, define the left and right signal velocities as $S_L$ and $S_R$ obtained from the left and right states. Assemble the Harten–Lax–van Leer (HLL) numerical flux at the interface from these ingredients.\n\nWork with the specific data:\n- $\\gamma=1.4$,\n- left state $(\\rho_L,u_L,p_L)=(1.0,20.0,1.0\\times 10^{5})$,\n- right state $(\\rho_R,u_R,p_R)=(0.125,-10.0,1.0\\times 10^{4})$,\n\nwhere $\\rho$ is in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $u$ is in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, and $p$ is in $\\mathrm{Pa}$. Using Davis's estimates $S_L=\\min(u_L-a_L,u_R-a_R)$ and $S_R=\\max(u_L+a_L,u_R+a_R)$, and the Harten–Lax–van Leer (HLL) construction for the numerical flux, compute the mass-flux component (the first component) of the HLL flux at the interface.\n\nRound your final result to four significant figures and express it in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.", "solution": "The problem asks for the computation of the mass-flux component of the Harten-Lax-van Leer (HLL) numerical flux for the one-dimensional Euler equations, given specific left and right states and using Davis's wave speed estimates.\n\nThe one-dimensional Euler equations in conservative form are given by $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0$, where $\\boldsymbol{U}$ is the vector of conserved variables and $\\boldsymbol{F}(\\boldsymbol{U})$ is the physical flux vector. For this problem, they are defined as:\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix}\n$$\nwhere $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. The problem requires the calculation of the first component of the HLL numerical flux, which corresponds to the mass flux.\n\nThe HLL numerical flux, $\\boldsymbol{F}_{HLL}$, is an approximation to the solution of the Riemann problem at a cell interface. It is defined based on the left and right wave speed estimates, $S_L$ and $S_R$. The formula for the HLL flux is:\n$$\n\\boldsymbol{F}_{HLL} = \n\\begin{cases} \n\\boldsymbol{F}_L  \\text{if } S_L \\ge 0 \\\\\n\\frac{S_R \\boldsymbol{F}_L - S_L \\boldsymbol{F}_R + S_L S_R (\\boldsymbol{U}_R - \\boldsymbol{U}_L)}{S_R - S_L}  \\text{if } S_L  0  S_R \\\\\n\\boldsymbol{F}_R  \\text{if } S_R \\le 0 \n\\end{cases}\n$$\nwhere $\\boldsymbol{U}_L$ and $\\boldsymbol{F}_L$ are the conservative state and flux vectors evaluated using the left state $(\\rho_L, u_L, p_L)$, and $\\boldsymbol{U}_R$ and $\\boldsymbol{F}_R$ are evaluated using the right state $(\\rho_R, u_R, p_R)$.\n\nThe problem asks only for the mass-flux component, which is the first component of the $\\boldsymbol{F}_{HLL}$ vector. Let's denote the first component of any vector $\\boldsymbol{V}$ as $\\boldsymbol{V}_1$. Then we have:\n$\\boldsymbol{U}_1 = \\rho$\n$\\boldsymbol{F}_1 = \\rho u$\n\nFirst, we calculate the necessary quantities from the given left and right states.\nThe gas has a ratio of specific heats $\\gamma = 1.4$.\n\n**Left State (L):**\nPrimitive variables: $(\\rho_L, u_L, p_L) = (1.0, 20.0, 1.0 \\times 10^5)$.\nThe speed of sound $a_L$ is calculated as:\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(1.4)(1.0 \\times 10^5)}{1.0}} = \\sqrt{140000} \\approx 374.1657 \\, \\mathrm{m/s}\n$$\nThe first components of the state and flux vectors are:\n$$\n\\boldsymbol{U}_{L,1} = \\rho_L = 1.0 \\, \\mathrm{kg/m^3}\n$$\n$$\n\\boldsymbol{F}_{L,1} = \\rho_L u_L = (1.0)(20.0) = 20.0 \\, \\mathrm{kg/(m^2 s)}\n$$\n\n**Right State (R):**\nPrimitive variables: $(\\rho_R, u_R, p_R) = (0.125, -10.0, 1.0 \\times 10^4)$.\nThe speed of sound $a_R$ is calculated as:\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(1.4)(1.0 \\times 10^4)}{0.125}} = \\sqrt{112000} \\approx 334.6640 \\, \\mathrm{m/s}\n$$\nThe first components of the state and flux vectors are:\n$$\n\\boldsymbol{U}_{R,1} = \\rho_R = 0.125 \\, \\mathrm{kg/m^3}\n$$\n$$\n\\boldsymbol{F}_{R,1} = \\rho_R u_R = (0.125)(-10.0) = -1.25 \\, \\mathrm{kg/(m^2 s)}\n$$\n\nNext, we calculate the wave speed estimates $S_L$ and $S_R$ using the provided Davis's estimates:\n$$\nS_L = \\min(u_L - a_L, u_R - a_R)\n$$\n$$\nS_R = \\max(u_L + a_L, u_R + a_R)\n$$\nWe compute the characteristic speeds:\n$$\nu_L - a_L \\approx 20.0 - 374.1657 = -354.1657 \\, \\mathrm{m/s}\n$$\n$$\nu_R - a_R \\approx -10.0 - 334.6640 = -344.6640 \\, \\mathrm{m/s}\n$$\n$$\nu_L + a_L \\approx 20.0 + 374.1657 = 394.1657 \\, \\mathrm{m/s}\n$$\n$$\nu_R + a_R \\approx -10.0 + 334.6640 = 324.6640 \\, \\mathrm{m/s}\n$$\nNow we find the minimum and maximum speeds for $S_L$ and $S_R$:\n$$\nS_L = \\min(-354.1657, -344.6640) = -354.165738... \\, \\mathrm{m/s}\n$$\n$$\nS_R = \\max(394.1657, 324.6640) = 394.165738... \\, \\mathrm{m/s}\n$$\nWe observe that $S_L  0$ and $S_R > 0$. Therefore, we must use the central formula for the HLL flux. The first component of the HLL flux, $\\boldsymbol{F}_{HLL,1}$, is:\n$$\n\\boldsymbol{F}_{HLL,1} = \\frac{S_R \\boldsymbol{F}_{L,1} - S_L \\boldsymbol{F}_{R,1} + S_L S_R (\\boldsymbol{U}_{R,1} - \\boldsymbol{U}_{L,1})}{S_R - S_L}\n$$\nPlugging in the computed values:\n$\\boldsymbol{F}_{L,1} = 20.0$\n$\\boldsymbol{F}_{R,1} = -1.25$\n$\\boldsymbol{U}_{L,1} = 1.0$\n$\\boldsymbol{U}_{R,1} = 0.125$\n$S_L \\approx -354.1657$\n$S_R \\approx 394.1657$\n\nLet's compute the terms in the formula:\nThe denominator is:\n$$\nS_R - S_L \\approx 394.165738 - (-354.165738) = 748.331476 \\, \\mathrm{m/s}\n$$\nThe numerator consists of three terms:\nTerm 1: $S_R \\boldsymbol{F}_{L,1} \\approx (394.165738)(20.0) = 7883.31476$\nTerm 2: $-S_L \\boldsymbol{F}_{R,1} \\approx -(-354.165738)(-1.25) = -442.7071725$\nTerm 3: $S_L S_R (\\boldsymbol{U}_{R,1} - \\boldsymbol{U}_{L,1})$\nFor this particular dataset, $S_L = u_L - a_L$ and $S_R = u_L + a_L$. This simplifies the product $S_L S_R$ to $u_L^2 - a_L^2 = (20.0)^2 - (\\sqrt{140000})^2 = 400 - 140000 = -139600$.\n$$\nS_L S_R (\\boldsymbol{U}_{R,1} - \\boldsymbol{U}_{L,1}) = (-139600)(0.125 - 1.0) = (-139600)(-0.875) = 122150\n$$\nSumming the terms in the numerator:\n$$\n\\text{Numerator} \\approx 7883.31476 - 442.7071725 + 122150 = 129590.6075875\n$$\nFinally, we compute the flux:\n$$\n\\boldsymbol{F}_{HLL,1} = \\frac{129590.6075875}{748.331476} \\approx 173.17646\n$$\nThe problem asks to round the result to four significant figures.\n$$\n\\boldsymbol{F}_{HLL,1} \\approx 173.2 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\nAll input values were given in base SI units, so the resulting flux is also in SI units, which for mass flux is $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.", "answer": "$$\n\\boxed{173.2}\n$$", "id": "3364359"}, {"introduction": "While the HLL solver is robust, its two-wave model inherently smears contact discontinuities, a significant drawback for problems where such features are important. The Harten-Lax-van Leer-Contact (HLLC) solver resolves this by explicitly including the contact wave in its model. This practice problem provides a sharp, quantitative comparison between HLL and HLLC, challenging you to calculate the numerical diffusion of a contact wave in the HLL scheme [@problem_id:3364391]. Successfully completing this exercise will clarify the motivation behind HLLC and deepen your understanding of how a solver's underlying wave model impacts solution accuracy.", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$ written in conservation form,\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0,\n$$\nwhere $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\top}$ and $\\boldsymbol{F}(\\boldsymbol{U}) = (\\rho u,\\; \\rho u^{2} + p,\\; u(E + p))^{\\top}$. The equation of state is $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$.\n\nA Sod-type Riemann problem is posed at $x=0$ with left and right states\n$$\n(\\rho_{L}, u_{L}, p_{L}) = (1,\\; 0,\\; 1), \\quad (\\rho_{R}, u_{R}, p_{R}) = (0.125,\\; 0,\\; 0.1),\n$$\nin nondimensional units. A uniform finite volume discretization with cell width $\\Delta x = 1$ is used, with the discontinuity located at the interface $x_{1/2} = 0$ between two cells. An explicit Euler time update is computed using a single Riemann flux at $x_{1/2}$, and boundary-adjacent fluxes are equal to the corresponding uniform-state fluxes.\n\nDefine the Courant–Friedrichs–Lewy (CFL) number $\\mathrm{CFL} = 0.5$, and choose the time-step\n$$\n\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max(|u_{L}| + a_{L},\\, |u_{R}| + a_{R})},\n$$\nwhere the speed of sound is $a = \\sqrt{\\gamma p / \\rho}$ evaluated in each state.\n\nThe Riemann flux at $x_{1/2}$ is to be computed using:\n- The Harten–Lax–van Leer (HLL) approximate Riemann solver with two-wave speeds $S_{L}$ and $S_{R}$ estimated by Davis’ bounds $S_{L} = \\min(u_{L} - a_{L},\\, u_{R} - a_{R})$ and $S_{R} = \\max(u_{L} + a_{L},\\, u_{R} + a_{R})$.\n- The Harten–Lax–van Leer with Contact (HLLC) approximate Riemann solver with the contact wave speed $S_{*}$ obtained from consistency with the Rankine–Hugoniot conditions across $S_{L}$ and $S_{R}$:\n$$\nS_{*} = \\frac{p_{R} - p_{L} + \\rho_{L} u_{L}(S_{L} - u_{L}) - \\rho_{R} u_{R}(S_{R} - u_{R})}{\\rho_{L}(S_{L} - u_{L}) - \\rho_{R}(S_{R} - u_{R})}.\n$$\n\nFor each solver, perform the explicit flux evaluation at $x_{1/2}$ and the corresponding one-step update of the two adjacent cell averages. Define the “contact discontinuity thickness after one time step” as the spatial width of the intermediate self-similar region in the solver’s wave model that contains the contact wave at time $\\Delta t$:\n- For HLL, this is the width of the single intermediate region between $S_{L}$ and $S_{R}$, equal to $(S_{R} - S_{L})\\,\\Delta t$.\n- For HLLC, the contact is an actual discontinuity at speed $S_{*}$ and thus has zero geometrical thickness in the wave model.\n\nCompute the difference between the HLL and HLLC contact thicknesses after one time step,\n$$\n\\Theta \\equiv \\left[(S_{R} - S_{L})\\,\\Delta t\\right] - 0,\n$$\nusing the specified initial states and $\\mathrm{CFL}$ selection. Express the final result as a single nondimensional number, and round your answer to four significant figures.", "solution": "The user wants to find the difference in contact discontinuity thickness, $\\Theta$, between the Harten-Lax-van Leer (HLL) and Harten-Lax-van Leer-Contact (HLLC) approximate Riemann solvers for a specific one-dimensional Euler equations problem.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n- **Governing Equations**: 1D compressible Euler equations, $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0$.\n- **State and Flux Vectors**: $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\top}$, $\\boldsymbol{F}(\\boldsymbol{U}) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$.\n- **Equation of State**: $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$.\n- **Ratio of Specific Heats**: $\\gamma = 1.4$.\n- **Left State**: $(\\rho_{L}, u_{L}, p_{L}) = (1, 0, 1)$.\n- **Right State**: $(\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 0.1)$.\n- **Discretization**: Cell width $\\Delta x = 1$.\n- **Time Stepping**: $\\mathrm{CFL} = 0.5$, $\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max(|u_{L}| + a_{L}, |u_{R}| + a_{R})}$.\n- **Speed of Sound**: $a = \\sqrt{\\gamma p / \\rho}$.\n- **HLL Wave Speeds (Davis' estimates)**: $S_{L} = \\min(u_{L} - a_{L}, u_{R} - a_{R})$ and $S_{R} = \\max(u_{L} + a_{L}, u_{R} + a_{R})$.\n- **Target Quantity**: $\\Theta = (S_{R} - S_{L})\\Delta t$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with standard equations and numerical methods (Euler equations, HLL/HLLC solvers) in computational fluid dynamics. The specified initial conditions correspond to the well-known Sod shock tube problem, a standard benchmark. All necessary parameters and definitions ($\\gamma$, initial states, $\\Delta x$, $\\mathrm{CFL}$, formulas for $a$, $\\Delta t$, $S_L$, $S_R$, and $\\Theta$) are provided, making the problem self-contained and well-posed. The language is objective and precise. The problem is not trivial, as it requires careful application of the provided formulas, and it correctly identifies that a large part of the contextual information (e.g., the formula for $S_*$) is not needed for the final calculation. There are no contradictions or factual errors.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to compute the quantity $\\Theta$, defined as the spatial width of the HLL intermediate region after one time step, $\\Delta t$. The formula is given as $\\Theta = (S_{R} - S_{L})\\,\\Delta t$. The calculation proceeds in several steps.\n\nFirst, we calculate the speed of sound, $a$, for the left ($L$) and right ($R$) states. The formula is $a = \\sqrt{\\gamma p / \\rho}$.\nFor the left state with $(\\rho_{L}, u_{L}, p_{L}) = (1, 0, 1)$ and $\\gamma = 1.4$:\n$$\na_{L} = \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}\n$$\nFor the right state with $(\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 0.1)$:\n$$\na_{R} = \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} = \\sqrt{\\frac{1.4 \\times 0.1}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12}\n$$\nWe note that $1.4 > 1.12$, so $a_{L} > a_{R}$.\n\nNext, we calculate the time step, $\\Delta t$, using the provided Courant–Friedrichs–Lewy (CFL) condition.\n$$\n\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max(|u_{L}| + a_{L}, |u_{R}| + a_{R})}\n$$\nGiven $\\mathrm{CFL} = 0.5$, $\\Delta x = 1$, and $u_{L} = u_{R} = 0$:\n$$\n\\max(|u_{L}| + a_{L}, |u_{R}| + a_{R}) = \\max(a_{L}, a_{R}) = \\max(\\sqrt{1.4}, \\sqrt{1.12}) = \\sqrt{1.4} = a_{L}\n$$\nSubstituting these values into the formula for $\\Delta t$:\n$$\n\\Delta t = \\frac{0.5 \\times 1}{\\sqrt{1.4}} = \\frac{0.5}{\\sqrt{1.4}}\n$$\n\nNow, we compute the HLL wave speeds, $S_{L}$ and $S_{R}$, using the specified Davis' estimates.\nFor the leftmost wave speed, $S_{L}$:\n$$\nS_{L} = \\min(u_{L} - a_{L}, u_{R} - a_{R}) = \\min(0 - \\sqrt{1.4}, 0 - \\sqrt{1.12}) = \\min(-\\sqrt{1.4}, -\\sqrt{1.12})\n$$\nSince $\\sqrt{1.4} > \\sqrt{1.12}$, it follows that $-\\sqrt{1.4}  -\\sqrt{1.12}$. Therefore:\n$$\nS_{L} = -\\sqrt{1.4} = -a_{L}\n$$\nFor the rightmost wave speed, $S_{R}$:\n$$\nS_{R} = \\max(u_{L} + a_{L}, u_{R} + a_{R}) = \\max(0 + \\sqrt{1.4}, 0 + \\sqrt{1.12}) = \\max(\\sqrt{1.4}, \\sqrt{1.12})\n$$\nTherefore:\n$$\nS_{R} = \\sqrt{1.4} = a_{L}\n$$\n\nFinally, we compute $\\Theta = (S_{R} - S_{L})\\,\\Delta t$.\nSubstituting the expressions we found for $S_{R}$, $S_{L}$, and $\\Delta t$:\n$$\n\\Theta = \\left(\\sqrt{1.4} - (-\\sqrt{1.4})\\right) \\left(\\frac{0.5}{\\sqrt{1.4}}\\right) = (2\\sqrt{1.4}) \\left(\\frac{0.5}{\\sqrt{1.4}}\\right)\n$$\nThe terms involving $\\sqrt{1.4}$ cancel out, leading to a simple result:\n$$\n\\Theta = 2 \\times 0.5 = 1\n$$\nThis result can also be obtained symbolically. For the given conditions where $u_L=u_R=0$ and $a_La_R$, we have:\n$S_L = -a_L$\n$S_R = a_L$\n$\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{a_L}$\nThen, $\\Theta = (S_R - S_L)\\Delta t = (a_L - (-a_L))\\frac{\\mathrm{CFL}\\,\\Delta x}{a_L} = (2a_L)\\frac{\\mathrm{CFL}\\,\\Delta x}{a_L} = 2 \\times \\mathrm{CFL} \\times \\Delta x$.\nPlugging in the given values $\\mathrm{CFL} = 0.5$ and $\\Delta x = 1$ yields:\n$$\n\\Theta = 2 \\times 0.5 \\times 1 = 1\n$$\nThe problem requests the result rounded to four significant figures. An exact value of $1$ is written as $1.000$ to meet this requirement.", "answer": "$$\n\\boxed{1.000}\n$$", "id": "3364391"}, {"introduction": "A crucial skill in computational science is the ability to quantitatively assess the performance of different numerical algorithms. This problem moves beyond calculation to focus on methodology, asking you to design a robust metric to compare the accuracy of the Roe, HLL, and HLLC solvers in capturing a contact discontinuity [@problem_id:3364393]. By critically evaluating different testing procedures, you will learn to identify the key elements of a fair and insightful numerical experiment, from choosing an appropriate error norm to ensuring all other numerical parameters are controlled.", "problem": "Consider the one-dimensional compressible Euler equations in conservative form, $\\partial_t \\boldsymbol{U} + \\partial_x \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$, where $\\boldsymbol{U} = [\\rho, \\rho u, E]^\\top$ and $\\boldsymbol{F}(\\boldsymbol{U}) = [\\rho u, \\rho u^2 + p, u(E + p)]^\\top$, closed with the ideal-gas equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)$, with ratio of specific heats $\\gamma  1$. For the Riemann initial data (the Sod problem) with a discontinuity at $x = x_0$ and constant left and right states $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$, the exact self-similar solution consists of a left-moving wave, a contact discontinuity, and a right-moving wave. The contact discontinuity propagates at the star-region velocity $u_\\star$, and its exact position satisfies $x_c^{\\text{exact}}(t) = x_0 + u_\\star t$.\n\nYou are tasked with comparing three approximate Riemann solvers—Roe’s linearized solver (Roe), Harten–Lax–van Leer (HLL), and Harten–Lax–van Leer–Contact (HLLC)—with a metric that quantitatively isolates their performance on the contact discontinuity in the Sod problem. The comparison must be performed on the same uniform mesh with spacing $\\Delta x$, the same spatial reconstruction and time integrator, and the same Courant–Friedrichs–Lewy (CFL) number, and must produce a scalar score for each solver over a prescribed time window $[T_1, T_2]$ with $0 \\le T_1  T_2$.\n\nWhich option below correctly defines a robust metric based on an $L^1$-type error of contact position versus time and outlines a sound and reproducible computation procedure to obtain it that isolates the effect of the Riemann solver?\n\nA. Define $E_{L^1} = \\dfrac{1}{T_2 - T_1}\\int_{T_1}^{T_2} \\left| x_c^{\\text{num}}(t) - x_c^{\\text{exact}}(t) \\right| \\, dt$, with $x_c^{\\text{exact}}(t) = x_0 + u_\\star t$, where $u_\\star$ is obtained by solving the exact Riemann problem for the pressure and velocity in the star region via Rankine–Hugoniot and isentropic rarefaction relations. Compute $x_c^{\\text{num}}(t)$ from the numerical solution as follows at synchronized physical sample times $\\{t^n\\}_{n=0}^{N}$ spanning $[T_1,T_2]$: locate candidate discontinuities by the peaks of the discrete density gradient $g_i = \\left|\\rho_{i+1} - \\rho_{i-1}\\right|/(2\\Delta x)$, classify the contact as the candidate across which the jumps of pressure and velocity are minimal in magnitude, and obtain a subcell-resolved position by a quadratic fit of $g_i$ around its local maximum. Approximate the time integral by $\\dfrac{1}{T_2 - T_1}\\sum_{n=0}^{N-1} \\left| x_c^{\\text{num}}(t^n) - x_c^{\\text{exact}}(t^n) \\right| \\Delta t$, where the same set of physical times $\\{t^n\\}$ is used for all solvers, achieved by outputting at prescribed times or by temporal interpolation of $x_c^{\\text{num}}(t)$. Use identical mesh, reconstruction, time integrator, and CFL across Roe, HLL, and HLLC, and non-reflecting boundaries so that only the choice of Riemann solver varies. Optionally choose $T_1$ large enough that waves are separated to avoid early-time ambiguity.\n\nB. Define $E_{L^1} = \\dfrac{1}{T_2 - T_1}\\int_{T_1}^{T_2} \\int_{\\Omega} \\left| \\rho^{\\text{num}}(x,t) - \\rho^{\\text{exact}}(x,t) \\right| \\, dx \\, dt$, computed with solver-specific time steps and CFL numbers for Roe, HLL, and HLLC. Track the contact position as $x_c^{\\text{exact}}(t) = x_0 + \\tilde{u} t$ where $\\tilde{u}$ is the Roe-averaged characteristic speed between left and right states, and align each solver’s outputs in its own time grid without interpolation. Use the grid cell index of the maximum of the pressure as a proxy for the contact location when needed.\n\nC. Define $E_{L^1} = \\dfrac{1}{T_2 - T_1}\\int_{T_1}^{T_2} \\left| x_s^{\\text{num}}(t) - x_s^{\\text{exact}}(t) \\right| \\, dt$, where $x_s$ denotes the shock position, because the contact is too diffused in Harten–Lax–van Leer (HLL). Estimate the numerical contact position indirectly by the maximum of $\\left|\\partial_x p\\right|$, and compute $x_s^{\\text{exact}}(t)$ by assuming a constant shock speed equal to the initial right-going characteristic. Use different CFL numbers for Roe, Harten–Lax–van Leer (HLL), and Harten–Lax–van Leer–Contact (HLLC) to maximize stability and reduce truncation errors for each solver.\n\nD. Define $E_{L^1} = \\sum_{n} \\left| w(t^n) \\right|$, where $w(t)$ is the width of the numerically smeared contact measured as the second central moment of the density gradient, subtracted by an estimate of artificial viscosity. Use the Harten–Lax–van Leer–Contact (HLLC) contact speed for $x_c^{\\text{exact}}(t)$ for all solvers and identify $x_c^{\\text{num}}(t)$ by the point of maximum pressure. No synchronization of sample times is necessary because the width is independent of time alignment, and boundary reflections can be ignored if the domain is sufficiently large. The time average is unnecessary because the contact width is stationary in self-similar coordinates.\n\nSelect the single best option.", "solution": "The problem asks for a robust metric and a sound computational procedure to quantitatively compare the performance of Roe, HLL, and HLLC approximate Riemann solvers, specifically focusing on their ability to capture the contact discontinuity in the one-dimensional Sod shock tube problem. The comparison must be designed to isolate the effect of the Riemann solver.\n\nThe governing equations are the 1D compressible Euler equations:\n$$ \\partial_t \\boldsymbol{U} + \\partial_x \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0} $$\nwith the state vector $\\boldsymbol{U} = [\\rho, \\rho u, E]^\\top$ and flux vector $\\boldsymbol{F}(\\boldsymbol{U}) = [\\rho u, \\rho u^2 + p, u(E + p)]^\\top$. The system is closed by the ideal gas equation of state $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$. The initial condition is a Riemann problem with a discontinuity at $x=x_0$, separating a left state $(\\rho_L, u_L, p_L)$ and a right state $(\\rho_R, u_R, p_R)$.\n\nThe exact solution to this problem is self-similar and for the Sod problem, consists of a left-moving rarefaction wave, a contact discontinuity moving to the right, and a right-moving shock wave. The contact discontinuity is a surface across which pressure $p$ and velocity $u$ are continuous, while density $\\rho$ (and consequently temperature) are discontinuous. It travels at a constant velocity, denoted $u_\\star$. Its exact position at time $t$ is given by $x_c^{\\text{exact}}(t) = x_0 + u_\\star t$.\n\nA sound procedure for comparing the numerical solvers hinges on two principles:\n1.  **Isolation of variables:** To attribute any observed differences in performance solely to the choice of Riemann solver, all other parameters of the numerical simulation must be held constant. This includes the computational mesh ($\\Delta x$), the spatial reconstruction method (e.g., MUSCL with a specific limiter), the time integration scheme, and the Courant–Friedrichs–Lewy (CFL) number.\n2.  **Appropriate and robust metric:** The metric must directly and accurately measure the quantity of interest. The problem specifies an $L^1$-type error of the contact position over time. This requires:\n    a. A correct reference solution, $x_c^{\\text{exact}}(t)$.\n    b. A robust method to extract the numerical position of the feature, $x_c^{\\text{num}}(t)$, from the discrete solution data.\n    c. A fair way to compute the error, which typically involves comparing the numerical and exact solutions at synchronized points in time.\n\nWith these principles, let us evaluate each option.\n\n**Option A Evaluation**\n- **Metric:** The proposed metric is $E_{L^1} = \\dfrac{1}{T_2 - T_1}\\int_{T_1}^{T_2} \\left| x_c^{\\text{num}}(t) - x_c^{\\text{exact}}(t) \\right| \\, dt$. This is the time-averaged $L^1$ error of the contact position. This is precisely the type of metric requested and directly quantifies the positional accuracy of the numerically captured contact wave.\n- **Reference Solution:** It correctly states that $x_c^{\\text{exact}}(t) = x_0 + u_\\star t$, where $u_\\star$ is obtained from the exact solution of the Riemann problem. This is the correct, unbiased benchmark.\n- **Numerical Position Extraction ($x_c^{\\text{num}}(t)$):** The procedure is physically sound.\n    1.  Locate candidate discontinuities by finding peaks in the discrete density gradient, $g_i = \\left|\\rho_{i+1} - \\rho_{i-1}\\right|/(2\\Delta x)$. This is appropriate because the contact is a jump in density.\n    2.  Classify the contact by finding the candidate across which the jumps in pressure and velocity are minimal. This correctly uses the defining physical properties of a contact discontinuity to distinguish it from shocks or rarefactions.\n    3.  Obtain a subcell-resolved position via a quadratic fit. This is a standard technique to improve the accuracy of feature tracking beyond the grid resolution.\n- **Computational Procedure:**\n    - The use of a summation to approximate the time integral is standard.\n    - Crucially, it mandates using the same set of physical times $\\{t^n\\}$ for all solvers, ensuring a fair comparison. This is achieved by outputting at prescribed times or by interpolation, which correctly handles the fact that different solvers might require slightly different time steps $\\Delta t^n$ under a fixed CFL number.\n    - It explicitly requires identical mesh, reconstruction, time integrator, and CFL number, which is the cornerstone of isolating the Riemann solver's effect.\n    - The mention of non-reflecting boundaries and choosing $T_1$ to ensure wave separation are marks of a well-designed, robust numerical experiment.\n\n**Verdict for Option A:** The methodology described is comprehensive, rigorous, and physically sound. It correctly isolates the variable of interest and uses an appropriate and robust metric. **Correct**.\n\n**Option B Evaluation**\n- **Metric:** The metric is $E_{L^1} = \\dfrac{1}{T_2 - T_1}\\int_{T_1}^{T_2} \\int_{\\Omega} \\left| \\rho^{\\text{num}}(x,t) - \\rho^{\\text{exact}}(x,t) \\right| \\, dx \\, dt$. This is a global $L^1$ error of the density field. It does not isolate the performance on the contact discontinuity's position, as it aggregates errors from all waves (position, shape, amplitude) over the whole domain.\n- **Procedural Flaws:**\n    1.  It suggests using \"solver-specific time steps and CFL numbers\". Comparing solvers at different CFL numbers is an unfair test, as the CFL number directly influences stability and truncation error.\n    2.  It suggests using the Roe-averaged velocity $\\tilde{u}$ to define the \"exact\" track. While related, this is an approximation from one specific linearization and is not the true exact solution speed $u_\\star$. Using an approximation as the ground truth is poor practice.\n    3.  It proposes using \"the grid cell index of the maximum of the pressure\" as a proxy for the contact location. This is fundamentally incorrect. Pressure is continuous across a contact discontinuity; its profile is flat in the star region between the shock and rarefaction. A pressure maximum or sharp gradient indicates a shock wave, not a contact.\n    4.  It recommends against time interpolation, which prevents a direct, point-in-time comparison of the solutions.\n\n**Verdict for Option B:** This option is flawed in its choice of metric, its proposed comparison framework (varying CFL), and its physical understanding of how to locate a contact discontinuity. **Incorrect**.\n\n**Option C Evaluation**\n- **Metric:** The metric is based on the error of the shock position, $x_s$. The task, however, is to evaluate performance on the *contact discontinuity*. This option proposes to measure the wrong physical feature. The justification given—that the contact is too diffused in HLL—is an expected outcome for that particular solver, and the goal of the test should be to quantify this poor performance, not to avoid measuring it by changing the objective.\n- **Procedural Flaws:**\n    1.  It proposes to estimate the contact position by the maximum of $\\left|\\partial_x p\\right|$. As with option B, this is wrong; this quantity is large at a shock, not a contact.\n    2.  It suggests approximating the exact shock speed with the initial characteristic speed. This is an approximation; the true shock speed must be calculated from the Rankine–Hugoniot jump conditions.\n    3.  Like option B, it suggests using different CFL numbers, which makes for an invalid comparison.\n\n**Verdict for Option C:** This option fails the primary task by measuring the wrong feature and contains multiple fundamental errors regarding the physics and numerical comparison methodology. **Incorrect**.\n\n**Option D Evaluation**\n- **Metric:** The metric is based on the width, $w(t)$, of the numerical contact. This measures numerical diffusion (smearing), not positional accuracy. The problem explicitly asks for a metric based on the \"error of contact position\".\n- **Procedural Flaws:**\n    1.  It suggests using the HLLC contact speed for $x_c^{\\text{exact}}(t)$. This is circular and biased. The exact solution speed $u_\\star$ is the only valid, solver-independent reference. Using a speed from one of the methods being tested would unfairly skew the results.\n    2.  It identifies the numerical contact position $x_c^{\\text{num}}(t)$ by the \"point of maximum pressure\". This is, again, physically incorrect for a contact discontinuity.\n    3.  The claim that \"No synchronization of sample times is necessary\" is false. The numerical width of a feature is not stationary and evolves with the number of time steps taken. A fair comparison of width would also require synchronized time samples.\n\n**Verdict for Option D:** This option measures the wrong quantity (width instead of position error) and relies on flawed procedures and incorrect physical reasoning. **Incorrect**.\n\n**Conclusion**\nOption A is the only one that proposes a methodologically sound, physically correct, and robust procedure that directly addresses the problem as stated. It sets up a fair comparison by controlling variables, uses an appropriate metric for positional error, and correctly identifies the physical signatures for locating the contact discontinuity.", "answer": "$$\\boxed{A}$$", "id": "3364393"}]}