{"hands_on_practices": [{"introduction": "A core concept in designing robust numerical schemes is monotonicity, which ensures that the scheme does not introduce spurious oscillations or new extrema into the solution. This desirable property is mathematically equivalent to the scheme's update rule being a convex combination of values from the previous time step. This practice challenges you to derive, from first principles, the precise stability condition (the CFL condition) under which the classic upwind and Lax-Friedrichs schemes are monotone, thereby grounding the abstract concept in a concrete mathematical constraint. [@problem_id:3401094]", "problem": "Consider the constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$, where $a \\in \\mathbb{R} \\setminus \\{0\\}$ is constant. Two explicit conservative schemes are considered: the upwind scheme that uses the correct upwind stencil according to the sign of $a$, and the Lax–Friedrichs scheme. A linear explicit finite difference scheme is called monotone if its one-step update at each grid point can be written as a linear combination of neighboring values with nonnegative coefficients that sum to $1$, which implies the update is a convex combination and is nondecreasing in each argument. Starting from these definitions and first principles about linear explicit stencil updates and their coefficient nonnegativity, derive the precise Courant–Friedrichs–Lewy (CFL) condition under which the upwind scheme is monotone and the precise CFL condition under which the Lax–Friedrichs scheme is monotone. Then, connect these bounds to the requirement that the update is a convex combination of neighboring values. Finally, from your derivation, extract the single tightest upper bound on the time step $\\Delta t$ (as a function of $\\Delta x$ and $a$) that guarantees both schemes are monotone simultaneously. Express your final answer as a closed-form analytic expression for this maximal allowable $\\Delta t$. No rounding is required.", "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in the field of numerical analysis for partial differential equations. The definitions and schemes are standard, and all necessary information is provided.\n\nWe begin by analyzing the constant-coefficient linear advection equation $u_t + a u_x = 0$, where $a \\in \\mathbb{R} \\setminus \\{0\\}$. We discretize the domain with a uniform spatial step $\\Delta x$ and time step $\\Delta t$. Let $u_j^n$ denote the numerical approximation of the solution $u(j\\Delta x, n\\Delta t)$. The Courant number is defined as $\\nu = \\frac{a \\Delta t}{\\Delta x}$.\n\nA linear explicit finite difference scheme is defined as monotone if the update $u_j^{n+1}$ can be expressed as a linear combination of values from the previous time step, $u_k^n$, with non-negative coefficients that sum to $1$. That is, $u_j^{n+1} = \\sum_k c_k u_k^n$ where $c_k \\ge 0$ for all $k$ and $\\sum_k c_k = 1$. This is the definition of a convex combination.\n\nFirst, we analyze the upwind scheme. The scheme's formulation depends on the sign of the advection speed $a$.\n\nCase 1: $a > 0$. The characteristic direction is from left to right, so we use a backward difference for the spatial derivative, $u_x \\approx (u_j^n - u_{j-1}^n) / \\Delta x$. The forward-in-time, backward-in-space (FTBS) scheme is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nSolving for $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n) = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n$$\n$$\nu_j^{n+1} = (1 - \\nu) u_j^n + \\nu u_{j-1}^n\n$$\nThe coefficients are $c_j = 1 - \\nu$ and $c_{j-1} = \\nu$. For the scheme to be monotone, these coefficients must be non-negative. Since $a > 0$, $\\Delta t > 0$, and $\\Delta x > 0$, we have $\\nu > 0$, so the condition $\\nu \\ge 0$ is satisfied. The other condition is $1 - \\nu \\ge 0$, which implies $\\nu \\le 1$. The sum of the coefficients is $(1 - \\nu) + \\nu = 1$. Thus, for $a > 0$, the monotonicity condition is $0  \\nu \\le 1$.\n\nCase 2: $a  0$. The characteristic direction is from right to left, so we use a forward difference for the spatial derivative, $u_x \\approx (u_{j+1}^n - u_j^n) / \\Delta x$. The forward-in-time, forward-in-space (FTFS) scheme is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\nSolving for $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} (u_{j+1}^n - u_j^n) = u_j^n - \\nu (u_{j+1}^n - u_j^n)\n$$\n$$\nu_j^{n+1} = (1 + \\nu) u_j^n - \\nu u_{j+1}^n\n$$\nThe coefficients are $c_j = 1 + \\nu$ and $c_{j+1} = -\\nu$. For monotonicity, these must be non-negative. Since $a  0$, we have $\\nu  0$, so the condition $-\\nu \\ge 0$ is satisfied. The other condition is $1 + \\nu \\ge 0$, which implies $\\nu \\ge -1$. The sum of coefficients is $(1 + \\nu) + (-\\nu) = 1$. Thus, for $a  0$, the monotonicity condition is $-1 \\le \\nu  0$.\n\nCombining both cases for the upwind scheme, the condition for monotonicity is $-1 \\le \\nu \\le 1$. This can be written in terms of the absolute value of the Courant number, $|\\nu| \\le 1$, which is equivalent to the Courant–Friedrichs–Lewy (CFL) condition:\n$$\n\\frac{|a| \\Delta t}{\\Delta x} \\le 1\n$$\n\nNext, we analyze the Lax–Friedrichs scheme. This scheme uses a central difference for the spatial derivative and replaces the term $u_j^n$ in the time derivative with the average of its neighbors, $\\frac{1}{2}(u_{j-1}^n + u_{j+1}^n)$.\n$$\n\\frac{u_j^{n+1} - \\frac{1}{2}(u_{j-1}^n + u_{j+1}^n)}{\\Delta t} + a \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0\n$$\nSolving for $u_j^{n+1}$:\n$$\nu_j^{n+1} = \\frac{1}{2}(u_{j-1}^n + u_{j+1}^n) - \\frac{a \\Delta t}{2\\Delta x} (u_{j+1}^n - u_{j-1}^n)\n$$\nGrouping terms by $u_{j-1}^n$ and $u_{j+1}^n$ and substituting $\\nu = \\frac{a \\Delta t}{\\Delta x}$:\n$$\nu_j^{n+1} = \\left(\\frac{1}{2} + \\frac{\\nu}{2}\\right) u_{j-1}^n + \\left(\\frac{1}{2} - \\frac{\\nu}{2}\\right) u_{j+1}^n\n$$\nThe coefficients are $c_{j-1} = \\frac{1}{2}(1 + \\nu)$ and $c_{j+1} = \\frac{1}{2}(1 - \\nu)$. For monotonicity, these coefficients must be non-negative.\n$c_{j-1} \\ge 0 \\implies 1 + \\nu \\ge 0 \\implies \\nu \\ge -1$.\n$c_{j+1} \\ge 0 \\implies 1 - \\nu \\ge 0 \\implies \\nu \\le 1$.\nThe sum of coefficients is $\\frac{1}{2}(1 + \\nu) + \\frac{1}{2}(1 - \\nu) = \\frac{1}{2} + \\frac{\\nu}{2} + \\frac{1}{2} - \\frac{\\nu}{2} = 1$.\nThe condition for the Lax–Friedrichs scheme to be monotone is therefore $-1 \\le \\nu \\le 1$, which is equivalent to the same CFL condition as for the upwind scheme:\n$$\n\\frac{|a| \\Delta t}{\\Delta x} \\le 1\n$$\nThe connection to the convex combination property is inherent in the definition of a monotone scheme. In our derivations for both schemes, we enforced the conditions that the stencil coefficients must be non-negative and sum to $1$. These are precisely the defining properties of the coefficients in a convex combination. Thus, the derived CFL conditions are the necessary and sufficient conditions for the one-step updates of these schemes to be convex combinations of neighboring values.\n\nFinally, we must find the single tightest upper bound on the time step $\\Delta t$ that guarantees both schemes are monotone simultaneously.\nThe condition for the upwind scheme to be monotone is $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$.\nThe condition for the Lax–Friedrichs scheme to be monotone is also $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$.\nSince both schemes impose the exact same condition, the condition for them to be simultaneously monotone is this same condition. To find the maximal allowable $\\Delta t$, we solve the inequality for $\\Delta t$:\n$$\n|a| \\Delta t \\le \\Delta x\n$$\nSince $a \\in \\mathbb{R} \\setminus \\{0\\}$, $|a|$ is a positive constant, so we can divide by it without changing the inequality direction:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\nThe tightest upper bound on $\\Delta t$ is the maximum value it can take, which is the right-hand side of this inequality.\nThe maximal allowable $\\Delta t$ is $\\frac{\\Delta x}{|a|}$.", "answer": "$$\\boxed{\\frac{\\Delta x}{|a|}}$$", "id": "3401094"}, {"introduction": "Having established the conditions for monotonicity, we now investigate its profound consequences for numerical accuracy. Godunov's theorem states that this stability comes at a cost: any linear monotone scheme can be at most first-order accurate. This exercise provides a direct proof of this limitation by having you compute the local truncation error for the archetypal monotone method—the first-order Godunov (upwind) scheme. By analyzing the error at a smooth extremum, you will see precisely how the scheme's accuracy is tied to the grid spacing $\\Delta x$ and the solution's curvature. [@problem_id:3401114]", "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a>0$ on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. Let the numerical solution be advanced by a conservative, monotone Godunov scheme with forward Euler time stepping:\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{\\Delta t}{\\Delta x}\\Big(F\\big(u_{i}^{n},u_{i+1}^{n}\\big) \\;-\\; F\\big(u_{i-1}^{n},u_{i}^{n}\\big)\\Big),\n$$\nwhere $F$ is the Godunov numerical flux. For the linear flux $f(u)=a\\,u$ and $a>0$, the Godunov flux reduces to the upwind form $F(u_{L},u_{R}) = a\\,u_{L}$. Define the Courant-Friedrichs-Lewy (CFL) number $\\nu := \\dfrac{a\\,\\Delta t}{\\Delta x}$.\n\nAssume the exact solution $u(x,t)$ is three-times continuously differentiable in a neighborhood of a point $(x_{\\star},t_{\\star})$ where it has a single strict smooth maximum, i.e., $u_{x}(x_{\\star},t_{\\star})=0$ and $u_{xx}(x_{\\star},t_{\\star})0$. The local truncation error $\\tau_{i}^{n}$ of the scheme at grid point $x_{i}=x_{\\star}$ and time level $t^{n}=t_{\\star}$ is defined by inserting the exact solution into the scheme:\n$$\n\\tau_{i}^{n} \\;:=\\; \\frac{u(x_{i},t^{n+1})-u(x_{i},t^{n})}{\\Delta t} \\;+\\; \\frac{F\\big(u(x_{i},t^{n}),u(x_{i+1},t^{n})\\big)-F\\big(u(x_{i-1},t^{n}),u(x_{i},t^{n})\\big)}{\\Delta x}.\n$$\n\nStarting only from the partial differential equation $u_{t}+a\\,u_{x}=0$, the definition of the Godunov flux for $a>0$, and Taylor expansions of smooth functions, compute the leading-order term of $\\tau_{i}^{n}$ at $(x_{i},t^{n})=(x_{\\star},t_{\\star})$ and demonstrate its order with respect to $\\Delta x$ under the scaling $\\Delta t=\\nu\\,\\Delta x/a$ with fixed $0\\nu\\leq 1$. Express your final answer as a single closed-form analytic expression for the leading-order term of $\\tau_{i}^{n}$ in terms of $a$, $\\nu$, $\\Delta x$, and $u_{xx}(x_{\\star},t_{\\star})$. Do not include any big-O notation in the final answer. No rounding is required.", "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It constitutes a standard analysis of the local truncation error for a well-known numerical scheme.\n\nThe local truncation error $\\tau_{i}^{n}$ at grid point $(x_{i}, t^{n})$ is given by inserting the exact solution $u(x,t)$ into the numerical scheme:\n$$\n\\tau_{i}^{n} = \\frac{u(x_{i},t^{n+1})-u(x_{i},t^{n})}{\\Delta t} + \\frac{F\\big(u(x_{i},t^{n}),u(x_{i+1},t^{n})\\big)-F\\big(u(x_{i-1},t^{n}),u(x_{i},t^{n})\\big)}{\\Delta x}\n$$\nThe problem considers the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant $a>0$. The numerical flux is the Godunov flux, which for the linear flux function $f(u)=a\\,u$ with $a>0$ simplifies to the upwind flux $F(u_{L},u_{R}) = a\\,u_{L}$.\n\nSubstituting the specific form of the Godunov flux into the definition of the truncation error, we have:\n$$\nF\\big(u(x_{i},t^{n}),u(x_{i+1},t^{n})\\big) = a\\,u(x_{i},t^{n})\n$$\n$$\nF\\big(u(x_{i-1},t^{n}),u(x_{i},t^{n})\\big) = a\\,u(x_{i-1},t^{n})\n$$\nThus, the expression for the local truncation error becomes:\n$$\n\\tau_{i}^{n} = \\frac{u(x_{i},t^{n+1})-u(x_{i},t^{n})}{\\Delta t} + \\frac{a\\,u(x_{i},t^{n}) - a\\,u(x_{i-1},t^{n})}{\\Delta x}\n$$\nTo find the leading-order term, we perform a Taylor series expansion of each term around the point $(x_{i}, t^{n})$. We assume the solution $u(x,t)$ is sufficiently smooth ($C^3$ was specified). Let $u_t$, $u_x$, $u_{tt}$, $u_{xx}$, etc., denote the partial derivatives of $u$ evaluated at $(x_{i}, t^{n})$.\n\nThe first term is expanded in time:\n$$\nu(x_{i},t^{n+1}) = u(x_{i},t^{n}) + \\Delta t \\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O\\big((\\Delta t)^3\\big)\n$$\nTherefore, the finite difference approximation of the time derivative becomes:\n$$\n\\frac{u(x_{i},t^{n+1})-u(x_{i},t^{n})}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + O\\big((\\Delta t)^2\\big)\n$$\nThe second term involves a spatial difference. We expand $u(x_{i-1},t^{n})$ around $x_{i}$:\n$$\nu(x_{i-1},t^{n}) = u(x_{i},t^{n}) - \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + O\\big((\\Delta x)^3\\big)\n$$\nSubstituting this into the spatial part of the truncation error:\n$$\n\\frac{a\\,u(x_{i},t^{n}) - a\\,u(x_{i-1},t^{n})}{\\Delta x} = \\frac{a\\,u(x_{i},t^{n}) - a\\Big(u(x_{i},t^{n}) - \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + O\\big((\\Delta x)^3\\big)\\Big)}{\\Delta x}\n$$\n$$\n= \\frac{a\\,\\Delta x \\, u_x - a\\,\\frac{(\\Delta x)^2}{2} u_{xx} + O\\big((\\Delta x)^3\\big)}{\\Delta x} = a\\,u_x - a\\,\\frac{\\Delta x}{2} u_{xx} + O\\big((\\Delta x)^2\\big)\n$$\nCombining the expanded terms, the local truncation error is:\n$$\n\\tau_{i}^{n} = \\left(u_t + \\frac{\\Delta t}{2} u_{tt} + \\dots\\right) + \\left(a\\,u_x - a\\,\\frac{\\Delta x}{2} u_{xx} + \\dots\\right)\n$$\nRearranging the terms:\n$$\n\\tau_{i}^{n} = (u_t + a\\,u_x) + \\frac{\\Delta t}{2} u_{tt} - a\\,\\frac{\\Delta x}{2} u_{xx} + \\text{H.O.T.}\n$$\nwhere H.O.T. stands for higher-order terms. Since $u(x,t)$ is the exact solution to the partial differential equation, the term $(u_t + a\\,u_x)$ is identically zero. The expression for the truncation error simplifies to:\n$$\n\\tau_{i}^{n} = \\frac{\\Delta t}{2} u_{tt} - a\\,\\frac{\\Delta x}{2} u_{xx} + \\text{H.O.T.}\n$$\nTo proceed, we must relate the time derivative $u_{tt}$ to spatial derivatives. We differentiate the PDE $u_t = -a\\,u_x$ with respect to time:\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(-a\\,u_x) = -a\\,u_{xt}\n$$\nWe also differentiate the PDE with respect to space:\n$$\nu_{tx} = \\frac{\\partial}{\\partial x}(-a\\,u_x) = -a\\,u_{xx}\n$$\nSince the solution is assumed to be $C^3$, the mixed partial derivatives are equal, $u_{xt} = u_{tx}$. Therefore, we have:\n$$\nu_{tt} = -a\\,(-a\\,u_{xx}) = a^2 u_{xx}\n$$\nSubstituting this back into the expression for $\\tau_{i}^{n}$:\n$$\n\\tau_{i}^{n} = \\frac{\\Delta t}{2} (a^2 u_{xx}) - \\frac{a\\,\\Delta x}{2} u_{xx} + \\text{H.O.T.}\n$$\n$$\n\\tau_{i}^{n} = \\frac{a\\,u_{xx}}{2}(a\\,\\Delta t - \\Delta x) + \\text{H.O.T.}\n$$\nThe problem specifies the scaling $\\Delta t = \\nu\\,\\Delta x/a$, where $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$ is the CFL number. Substituting for $\\Delta t$:\n$$\n\\tau_{i}^{n} = \\frac{a\\,u_{xx}}{2}\\left(a\\,\\frac{\\nu\\,\\Delta x}{a} - \\Delta x\\right) + \\text{H.O.T.} = \\frac{a\\,u_{xx}}{2}(\\nu\\,\\Delta x - \\Delta x) + \\text{H.O.T.}\n$$\nFactoring out $\\Delta x$ gives the leading-order term of the truncation error:\n$$\n\\tau_{i}^{n} = \\frac{a}{2}( \\nu - 1) u_{xx} \\Delta x + \\text{H.O.T.}\n$$\nThis expression is valid at any point $(x_i, t^n)$ where $u_{xx}$ is defined. The problem asks for this leading-order term specifically at the point $(x_{i},t^{n})=(x_{\\star},t_{\\star})$, where the exact solution has a smooth maximum, implying $u_{x}(x_{\\star},t_{\\star})=0$ and $u_{xx}(x_{\\star},t_{\\star})0$. Since $u_{xx}$ is non-zero at this point, the term we have calculated is indeed the leading-order term, provided $\\nu \\neq 1$. Its magnitude is proportional to $\\Delta x$, demonstrating that the scheme is first-order accurate.\n\nThe leading-order term of the local truncation error at $(x_{\\star},t_{\\star})$ is therefore:\n$$\n\\frac{a}{2}( \\nu - 1) u_{xx}(x_{\\star},t_{\\star}) \\Delta x\n$$\nRewriting for clarity, we have the final expression.", "answer": "$$\n\\boxed{\\frac{1}{2}a(\\nu - 1) u_{xx}(x_{\\star},t_{\\star}) \\Delta x}\n$$", "id": "3401114"}, {"introduction": "Theory comes to life through computation. While linear monotone schemes are strictly first-order, modern high-resolution methods employ nonlinear limiters to enforce monotonicity-like properties (such as being Total Variation Diminishing, or TVD) only where necessary, aiming for higher-order accuracy in smooth regions. This coding exercise vividly illustrates the practical implications of Godunov's barrier theorem by comparing an unlimited second-order scheme with its TVD-limited counterpart. By measuring convergence in different norms ($L^1$ versus $L^\\infty$), you will observe how the limiter preserves global accuracy while reducing it locally at extrema—a crucial trade-off in computational fluid dynamics. [@problem_id:3401131]", "problem": "Consider the linear advection equation in one spatial dimension,\n$$\n\\partial_t u(x,t) + a \\,\\partial_x u(x,t) = 0, \\quad x \\in [0,1], \\quad t \\ge 0,\n$$\nwith periodic boundary conditions on the domain $[0,1]$ and constant advection speed $a>0$. Let the initial condition be the smooth, periodic function\n$$\nu(x,0) = u_0(x) = \\sin(2\\pi x) + \\tfrac{1}{4}\\sin(6\\pi x).\n$$\nFor integer multiples of one domain traversal time, that is for any $T$ such that $a\\,T$ is an integer, the exact solution satisfies $u(x,T)=u_0(x)$ for all $x \\in [0,1]$.\n\nYou will implement a finite volume method on a uniform mesh with $N$ cells of width $\\Delta x = 1/N$ and cell centers $x_i = (i+0.5)\\Delta x$, $i=0,\\dots,N-1$, using:\n- A Godunov upwind numerical flux at interfaces,\n- A second-order piecewise linear reconstruction within each cell,\n- Either an unlimited (central) slope or a Total Variation Diminishing (TVD) limited slope via the minmod limiter,\n- A Strong Stability Preserving (SSP) third-order Runge–Kutta time integrator (also known as Shu–Osher SSP-RK3),\n- A Courant–Friedrichs–Lewy (CFL) time step restriction with a prescribed non-dimensional number $\\nu \\in (0,1)$, using $\\Delta t = \\nu \\,\\Delta x/a$ and an integer number of steps to hit $T$ exactly.\n\nThe second-order reconstruction within cell $i$ is defined as\n$$\nu_i(x) = \\bar{u}_i + \\sigma_i \\,\\frac{x - x_i}{\\Delta x/2}, \\quad x \\in [x_{i-1/2}, x_{i+1/2}],\n$$\nwhere $\\bar{u}_i$ is the cell average (approximated by the point value at $x_i$ for this smooth test), $x_{i\\pm 1/2}$ are cell faces, and $\\sigma_i$ is the slope. At each face $x_{i+1/2}$, define the left reconstructed state as\n$$\nu_{i+1/2}^{-} = \\bar{u}_i + \\tfrac{1}{2}\\,\\sigma_i.\n$$\nFor $a>0$, the Godunov upwind flux uses this left state: \n$$\nF_{i+1/2} = a\\,u_{i+1/2}^{-}.\n$$\nThe semidiscrete finite volume update reads\n$$\n\\frac{d\\bar{u}_i}{dt} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x}.\n$$\n\nDefine two slope choices:\n- Unlimited central slope: \n$$\n\\sigma_i^{\\text{unlim}} = \\frac{1}{2}\\left( \\bar{u}_{i+1}-\\bar{u}_{i-1}\\right).\n$$\n- Limited minmod slope:\n$$\n\\sigma_i^{\\text{mm}} = \\operatorname{minmod}\\left(\\bar{u}_i - \\bar{u}_{i-1},\\; \\bar{u}_{i+1}-\\bar{u}_i\\right),\n$$\nwith the minmod function defined by\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),  ab>0,\\\\\n0,  ab\\le 0.\n\\end{cases}\n$$\nAdvance in time to $T=1$ with $a=1$ so that the exact solution returns to $u_0(x)$. For each numerical solution at $T$, compute the error $e_i = \\bar{u}_i^{\\text{num}}(T) - u_0(x_i)$ and the norms\n$$\n\\|e\\|_{L^1} = \\sum_{i=0}^{N-1} |e_i|\\,\\Delta x, \\qquad \\|e\\|_{L^\\infty} = \\max_{0\\le i \\le N-1} |e_i|.\n$$\nUse mesh refinement levels $N \\in \\{64, 128, 256, 512\\}$ and a fixed Courant number $\\nu = 0.4$. Estimate the observed order of accuracy between successive refinements by\n$$\np = \\frac{\\log\\left(\\frac{E(N)}{E(2N)}\\right)}{\\log 2},\n$$\nwhere $E(N)$ is the error norm on the grid with $N$ cells. To reduce pre-asymptotic effects, report the average of the last two refinement ratios, that is, the mean of the orders computed from $(N=128 \\to 256)$ and $(N=256 \\to 512)$.\n\nGodunov's order barrier theorem states that any linear monotone method for scalar conservation laws can be at most first-order accurate. In practical high-resolution methods, TVD slope limiters enforce monotonicity-like properties and are known to reduce accuracy to first order at smooth extrema in the $L^\\infty$ norm. In contrast, an unlimited second-order reconstruction is not TVD but achieves second-order accuracy in smooth regions.\n\nImplement the above and produce the following four observed orders as your test suite:\n1. Unlimited second-order reconstruction, $L^\\infty$ observed order.\n2. Limited (minmod) reconstruction, $L^\\infty$ observed order.\n3. Unlimited second-order reconstruction, $L^1$ observed order.\n4. Limited (minmod) reconstruction, $L^1$ observed order.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"). Each entry must be a floating-point number. No physical units are required for this problem. The angle unit is not applicable.\n\nThe test suite is the set of four cases above; each case uses the same parameters $a=1$, $T=1$, $\\nu=0.4$, and $N \\in \\{64,128,256,512\\}$, differing only in the choice of slope reconstruction (unlimited versus minmod) and the error norm ($L^\\infty$ versus $L^1$). The final output should be the list of the four observed orders in the order specified above.", "solution": "The user wants to validate a numerical scheme for the linear advection equation by implementing it and measuring its convergence rates. The problem is scientifically valid and well-posed, providing a detailed specification of the governing equation, initial and boundary conditions, and the numerical method. We will proceed with a full solution.\n\nThe problem investigates the one-dimensional linear advection equation,\n$$\n\\partial_t u(x,t) + a \\,\\partial_x u(x,t) = 0\n$$\non a periodic domain $x \\in [0,1]$ with a constant advection speed $a=1$. The initial condition is a smooth function $u(x,0) = u_0(x) = \\sin(2\\pi x) + \\frac{1}{4}\\sin(6\\pi x)$. We evolve the solution up to time $T=1$. Since $aT = 1 \\cdot 1 = 1$ is an integer, the exact solution at time $T=1$ is identical to the initial condition, $u(x,1) = u_0(x)$. This provides a convenient way to assess the numerical error.\n\nThe solution is computed using a second-order finite volume method. The key steps of the implementation are as follows:\n\n1.  **Spatial Discretization**:\n    The domain $[0,1]$ is divided into $N$ uniform cells, each of width $\\Delta x = 1/N$. The cell centers are located at $x_i = (i+0.5)\\Delta x$ for $i=0, \\dots, N-1$. The numerical solution is represented by cell averages, $\\bar{u}_i(t) \\approx \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) dx$. For this problem with a smooth initial condition, we initialize the cell averages with the point values at the cell centers: $\\bar{u}_i(0) = u_0(x_i)$.\n\n2.  **Semi-Discrete Formulation**:\n    The finite volume method leads to a system of ordinary differential equations (ODEs) for the cell averages, known as the semi-discrete form:\n    $$\n    \\frac{d\\bar{u}_i}{dt} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x}\n    $$\n    where $F_{i+1/2}$ is the numerical flux across the interface at $x_{i+1/2}$. For the linear advection equation with $a>0$, the Godunov upwind flux is determined by the state on the left side of the interface, $u_{i+1/2}^{-}$:\n    $$\n    F_{i+1/2} = a\\,u_{i+1/2}^{-}\n    $$\n    The left state $u_{i+1/2}^{-}$ is obtained from a piecewise linear reconstruction within cell $i$. The problem specifies the formula:\n    $$\n    u_{i+1/2}^{-} = \\bar{u}_i + \\tfrac{1}{2}\\,\\sigma_i\n    $$\n    where $\\sigma_i$ is a quantity representing the slope-related variation across cell $i$. The periodic boundary conditions are handled by identifying cell indices modulo $N$, e.g., $\\bar{u}_{-1} = \\bar{u}_{N-1}$ and $\\bar{u}_{N} = \\bar{u}_{0}$.\n\n3.  **Slope Calculation**:\n    Two choices for the slope term $\\sigma_i$ are implemented to compare a standard second-order scheme with a Total Variation Diminishing (TVD) scheme.\n    -   **Unlimited Central Slope**: This choice leads to a linear, non-monotone second-order scheme. The slope term is defined as:\n        $$\n        \\sigma_i^{\\text{unlim}} = \\frac{1}{2}\\left( \\bar{u}_{i+1}-\\bar{u}_{i-1}\\right)\n        $$\n    -   **Limited Minmod Slope**: This choice employs the `minmod` function to limit the slopes, ensuring the scheme is TVD. This prevents spurious oscillations near sharp gradients but can reduce the order of accuracy. The slope term is:\n        $$\n        \\sigma_i^{\\text{mm}} = \\operatorname{minmod}\\left(\\bar{u}_i - \\bar{u}_{i-1},\\; \\bar{u}_{i+1}-\\bar{u}_i\\right)\n        $$\n        The `minmod` function is defined as $\\operatorname{minmod}(a,b) = \\operatorname{sign}(a)\\,\\min(|a|,|b|)$ if $ab>0$, and $0$ otherwise.\n\n    The right-hand side of the semi-discrete system, which we can denote as $L(\\bar{\\mathbf{u}})$, is computed for all cells $i=0, \\dots, N-1$ at each time step.\n\n4.  **Time Integration**:\n    The system of ODEs is advanced in time using the third-order Strong Stability Preserving Runge-Kutta (SSP-RK3) method. Given a solution $\\bar{\\mathbf{u}}^n$ at time $t_n$, the solution at $t_{n+1} = t_n+\\Delta t$ is computed through three stages:\n    $$\n    \\begin{aligned}\n    \\bar{\\mathbf{u}}^{(1)} = \\bar{\\mathbf{u}}^n + \\Delta t L(\\bar{\\mathbf{u}}^n) \\\\\n    \\bar{\\mathbf{u}}^{(2)} = \\frac{3}{4}\\bar{\\mathbf{u}}^n + \\frac{1}{4}\\left(\\bar{\\mathbf{u}}^{(1)} + \\Delta t L(\\bar{\\mathbf{u}}^{(1)})\\right) \\\\\n    \\bar{\\mathbf{u}}^{n+1} = \\frac{1}{3}\\bar{\\mathbf{u}}^n + \\frac{2}{3}\\left(\\bar{\\mathbf{u}}^{(2)} + \\Delta t L(\\bar{\\mathbf{u}}^{(2)})\\right)\n    \\end{aligned}\n    $$\n    The time step $\\Delta t$ is chosen based on a fixed Courant number $\\nu = 0.4$, where the target time step is $\\Delta t_{\\text{target}} = \\nu \\Delta x/a$. To reach the final time $T=1$ exactly, we calculate the number of steps as $N_{\\text{steps}} = \\lceil T/\\Delta t_{\\text{target}} \\rceil$ and adjust the time step to $\\Delta t = T/N_{\\text{steps}}$.\n\n5.  **Error Analysis and Convergence Order**:\n    After evolving the solution to $T=1$, the error is computed with respect to the exact solution $u_0(x_i)$. The error vector is $e_i = \\bar{u}_i(T) - u_0(x_i)$. Two error norms are calculated:\n    $$\n    \\|e\\|_{L^1} = \\sum_{i=0}^{N-1} |e_i|\\,\\Delta x, \\qquad \\|e\\|_{L^\\infty} = \\max_{0\\le i \\le N-1} |e_i|\n    $$\n    This process is repeated for a sequence of refined meshes with $N \\in \\{64, 128, 256, 512\\}$. The observed order of accuracy $p$ is estimated between two successive grid refinements using the formula:\n    $$\n    p = \\frac{\\log\\left(E(N)/E(2N)\\right)}{\\log 2}\n    $$\n    where $E(N)$ is a given error norm for a grid with $N$ cells. The final reported order is the average of the orders computed from the $(N=128 \\to 256)$ and $(N=256 \\to 512)$ refinements. This is done for all four combinations of slope choice and error norm, as requested. The expected results are consistent with Godunov's order barrier theorem and the theory of TVD schemes: second-order accuracy for the unlimited scheme, but a reduction to first-order in the $L^\\infty$ norm for the limited scheme due to clipping at smooth extrema.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and analyzes a second-order finite volume method for the\n    linear advection equation to verify its convergence properties with\n    different slope limiters, in accordance with Godunov's theorem.\n    \"\"\"\n\n    def rhs(u_bar, dx, a, limiter_type):\n        \"\"\"\n        Computes the right-hand-side of the semi-discrete finite volume scheme.\n        d(u_bar)/dt = L(u_bar)\n        \n        Args:\n            u_bar (np.ndarray): Array of cell averages.\n            dx (float): Cell width.\n            a (float): Advection speed.\n            limiter_type (str): 'unlimited' or 'minmod'.\n            \n        Returns:\n            np.ndarray: The time derivative of cell averages.\n        \"\"\"\n        # Enforce periodic boundary conditions using np.roll\n        u_L = np.roll(u_bar, 1)  # u_{i-1}\n        u_R = np.roll(u_bar, -1) # u_{i+1}\n\n        # Calculate slopes based on the chosen limiter\n        if limiter_type == 'unlimited':\n            # Unlimited central difference slope term\n            sigma = 0.5 * (u_R - u_L)\n        elif limiter_type == 'minmod':\n            # Minmod limited slope term\n            delta_L = u_bar - u_L\n            delta_R = u_R - u_bar\n            ab = delta_L * delta_R\n            sigma = np.zeros_like(u_bar)\n            mask = ab > 0\n            sigma[mask] = np.sign(delta_L[mask]) * np.minimum(np.abs(delta_L[mask]), np.abs(delta_R[mask]))\n        else:\n            raise ValueError(f\"Unknown limiter type: {limiter_type}\")\n\n        # Reconstruct state at the left side of the interface i+1/2\n        u_minus_at_i_plus_half = u_bar + 0.5 * sigma\n        \n        # Godunov upwind flux for a > 0\n        flux_i_plus_half = a * u_minus_at_i_plus_half\n\n        # Flux at i-1/2 by rolling the F_{i+1/2} array\n        flux_i_minus_half = np.roll(flux_i_plus_half, 1)\n        \n        # Compute the semi-discrete update\n        dudt = -(flux_i_plus_half - flux_i_minus_half) / dx\n        return dudt\n\n    def run_simulation(N, limiter_type, a, T, nu):\n        \"\"\"\n        Runs a single numerical simulation for a given grid size and limiter.\n\n        Args:\n            N (int): Number of grid cells.\n            limiter_type (str): 'unlimited' or 'minmod'.\n            a (float): Advection speed.\n            T (float): Final time.\n            nu (float): Courant number.\n\n        Returns:\n            tuple (float, float): L-infinity and L-1 errors.\n        \"\"\"\n        # --- Grid and Initial Condition ---\n        dx = 1.0 / N\n        x = (np.arange(N) + 0.5) * dx\n        \n        def u0_func(x_coords):\n            return np.sin(2 * np.pi * x_coords) + 0.25 * np.sin(6 * np.pi * x_coords)\n\n        u_exact = u0_func(x)\n        u = u_exact.copy()\n\n        # --- Time Stepping ---\n        # Adjust dt to hit the final time T exactly\n        dt_target = nu * dx / a\n        num_steps = int(np.ceil(T / dt_target))\n        dt = T / num_steps\n\n        # --- SSP-RK3 Time Integration Loop ---\n        for _ in range(num_steps):\n            # Stage 1\n            u1 = u + dt * rhs(u, dx, a, limiter_type)\n            # Stage 2\n            u2 = 0.75 * u + 0.25 * (u1 + dt * rhs(u1, dx, a, limiter_type))\n            # Stage 3\n            u = (1.0 / 3.0) * u + (2.0 / 3.0) * (u2 + dt * rhs(u2, dx, a, limiter_type))\n\n        # --- Error Calculation ---\n        error_vec = u - u_exact\n        err_linf = np.max(np.abs(error_vec))\n        err_l1 = np.sum(np.abs(error_vec)) * dx\n        \n        return err_linf, err_l1\n\n    # --- Main Driver ---\n    # Parameters for the numerical experiment\n    a = 1.0\n    T = 1.0\n    nu = 0.4\n    N_list = [64, 128, 256, 512]\n    \n    # Store errors for each case\n    errors = {\n        'unlimited': {'L_inf': {}, 'L_1': {}},\n        'minmod': {'L_inf': {}, 'L_1': {}}\n    }\n    \n    # Run simulations for all specified grid sizes and limiters\n    for limiter in ['unlimited', 'minmod']:\n        for N in N_list:\n            err_linf, err_l1 = run_simulation(N, limiter, a, T, nu)\n            errors[limiter]['L_inf'][N] = err_linf\n            errors[limiter]['L_1'][N] = err_l1\n    \n    results = []\n    \n    # --- Calculate and store observed orders of accuracy ---\n    def calculate_avg_order(error_dict):\n        p_128_256 = np.log(error_dict[128] / error_dict[256]) / np.log(2)\n        p_256_512 = np.log(error_dict[256] / error_dict[512]) / np.log(2)\n        return (p_128_256 + p_256_512) / 2.0\n\n    # 1. Unlimited reconstruction, L^inf observed order\n    results.append(calculate_avg_order(errors['unlimited']['L_inf']))\n\n    # 2. Limited (minmod) reconstruction, L^inf observed order\n    results.append(calculate_avg_order(errors['minmod']['L_inf']))\n\n    # 3. Unlimited second-order reconstruction, L^1 observed order\n    results.append(calculate_avg_order(errors['unlimited']['L_1']))\n\n    # 4. Limited (minmod) reconstruction, L^1 observed order\n    results.append(calculate_avg_order(errors['minmod']['L_1']))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3401131"}]}