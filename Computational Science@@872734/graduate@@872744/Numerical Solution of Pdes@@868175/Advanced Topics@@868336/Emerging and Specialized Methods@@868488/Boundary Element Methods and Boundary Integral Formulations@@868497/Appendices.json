{"hands_on_practices": [{"introduction": "The Boundary Element Method's core principle is the transformation of a partial differential equation over a domain into an integral equation on its boundary. This practice guides you through the fundamental derivation for the exterior Laplace problem, a cornerstone of potential theory. By representing the solution as a double-layer potential and carefully analyzing its limiting behavior at the boundary, you will derive a classic Fredholm integral equation of the second kind, which is central to many BEM applications [@problem_id:3367596].", "problem": "Let $\\Omega \\subset \\mathbb{R}^{2}$ be a bounded domain with boundary $\\Gamma$ of class $C^{2}$. Let $\\boldsymbol{n}$ denote the unit normal on $\\Gamma$ pointing out of $\\Omega$ (and into the exterior $\\Omega^{\\mathrm{ext}} := \\mathbb{R}^{2} \\setminus \\overline{\\Omega}$). Consider the exterior Dirichlet problem for Laplace’s equation: find a harmonic function $u : \\Omega^{\\mathrm{ext}} \\to \\mathbb{R}$ such that $\\Delta u = 0$ in $\\Omega^{\\mathrm{ext}}$, the trace $u|_{\\Gamma} = g$ for a given continuous boundary datum $g \\in C(\\Gamma)$, and the decay condition $u(\\boldsymbol{x}) = \\mathcal{O}(|\\boldsymbol{x}|^{-1})$ as $|\\boldsymbol{x}| \\to \\infty$. Using Green’s identities and the two-dimensional fundamental solution of the Laplace operator as a basis, consider the double-layer potential ansatz for $u$ in the exterior domain with an unknown density $\\psi \\in C(\\Gamma)$,\n$$\nu(\\boldsymbol{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\, \\psi(\\boldsymbol{y}) \\, \\mathrm{d}s_{\\boldsymbol{y}}, \\quad \\boldsymbol{x} \\in \\Omega^{\\mathrm{ext}},\n$$\nwhere $G(\\boldsymbol{x},\\boldsymbol{y})$ is the two-dimensional fundamental solution of the Laplace operator. Starting from Green’s second identity and the definition of layer potentials, derive the boundary integral equation satisfied by the exterior trace of $u$ on $\\Gamma$ in terms of the boundary integral operator $K$ associated with the double-layer kernel, including the correct jump term. Assume all necessary integrals are interpreted in the Cauchy principal value sense when singularities are present, and justify the appearance and sign of the jump term by a local analysis at a boundary point consistent with the chosen outward normal orientation.\n\nFinally, for the two-dimensional case with\n$$\nG(\\boldsymbol{x},\\boldsymbol{y}) = -\\frac{1}{2\\pi} \\ln |\\boldsymbol{x}-\\boldsymbol{y}|,\n$$\ndetermine the explicit analytic expression for the kernel $k(\\boldsymbol{x},\\boldsymbol{y})$ of the boundary integral operator $K$ defined by\n$$\n(K\\psi)(\\boldsymbol{x}) := \\mathrm{p.v.} \\int_{\\Gamma} k(\\boldsymbol{x},\\boldsymbol{y}) \\, \\psi(\\boldsymbol{y}) \\, \\mathrm{d}s_{\\boldsymbol{y}}, \\quad \\boldsymbol{x} \\in \\Gamma.\n$$\nYour final answer must be a single closed-form expression for $k(\\boldsymbol{x},\\boldsymbol{y})$. Do not include any equality or inequality signs in your final boxed answer. No rounding is required.", "solution": "The problem asks for the derivation of the boundary integral equation (BIE) for the exterior Dirichlet problem for Laplace's equation using a double-layer potential ansatz, and for the explicit form of the kernel of the associated integral operator. The derivation requires a careful analysis of the behavior of the potential near the boundary.\n\nLet $\\Omega \\subset \\mathbb{R}^{2}$ be a bounded domain with a $C^{2}$ boundary $\\Gamma$. The unit normal vector $\\boldsymbol{n}$ on $\\Gamma$ points into the exterior domain $\\Omega^{\\mathrm{ext}} = \\mathbb{R}^{2} \\setminus \\overline{\\Omega}$. We seek a harmonic function $u$ in $\\Omega^{\\mathrm{ext}}$ satisfying $\\Delta u = 0$, with boundary condition $u|_{\\Gamma} = g$ and decay condition $u(\\boldsymbol{x}) = \\mathcal{O}(|\\boldsymbol{x}|^{-1})$ as $|\\boldsymbol{x}| \\to \\infty$.\n\nThe proposed ansatz for the solution is a double-layer potential with an unknown density function $\\psi \\in C(\\Gamma)$:\n$$\nu(\\boldsymbol{x}) = (W\\psi)(\\boldsymbol{x}) := \\int_{\\Gamma} \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\, \\psi(\\boldsymbol{y}) \\, \\mathrm{d}s_{\\boldsymbol{y}}, \\quad \\boldsymbol{x} \\in \\Omega^{\\mathrm{ext}}\n$$\nHere, $G(\\boldsymbol{x},\\boldsymbol{y})$ is the fundamental solution of the $2$D Laplace equation, $G(\\boldsymbol{x},\\boldsymbol{y}) = -\\frac{1}{2\\pi} \\ln |\\boldsymbol{x}-\\boldsymbol{y}|$. The kernel of the integral is $\\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} = \\nabla_{\\boldsymbol{y}} G(\\boldsymbol{x},\\boldsymbol{y}) \\cdot \\boldsymbol{n}_{\\boldsymbol{y}}$. This potential $u(\\boldsymbol{x})$ is harmonic for any $\\boldsymbol{x} \\notin \\Gamma$ and satisfies the required decay condition at infinity.\n\nTo find the integral equation for $\\psi$, we must enforce the boundary condition $u|_{\\Gamma}=g$. This requires taking the limit of $u(\\boldsymbol{x})$ as $\\boldsymbol{x}$ approaches a point $\\boldsymbol{x}_0 \\in \\Gamma$ from the exterior domain $\\Omega^{\\text{ext}}$. The double-layer potential is known to have a jump discontinuity across the boundary $\\Gamma$. We must derive this jump condition.\n\nLet $\\boldsymbol{x}_0 \\in \\Gamma$. The exterior trace of $u$ is given by the limit:\n$$\nu|_{\\Gamma}(\\boldsymbol{x}_0) = \\lim_{\\substack{\\boldsymbol{x} \\to \\boldsymbol{x}_0 \\\\ \\boldsymbol{x} \\in \\Omega^{\\mathrm{ext}}}} (W\\psi)(\\boldsymbol{x})\n$$\nThe integral in the definition of $(W\\psi)(\\boldsymbol{x})$ becomes singular as $\\boldsymbol{x} \\to \\boldsymbol{x}_0$. The limit is conventionally evaluated by considering its Cauchy principal value (p.v.) and a contribution from the singularity. The boundary integral operator $K$ is defined by this principal value integral:\n$$\n(K\\psi)(\\boldsymbol{x}_0) := \\mathrm{p.v.} \\int_{\\Gamma} \\frac{\\partial G(\\boldsymbol{x}_0,\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\, \\psi(\\boldsymbol{y}) \\, \\mathrm{d}s_{\\boldsymbol{y}}\n$$\nThe jump relations for the double-layer potential state that for a sufficiently smooth boundary $\\Gamma$ and density $\\psi$:\n$$\n\\lim_{\\substack{\\boldsymbol{x} \\to \\boldsymbol{x}_0 \\\\ \\boldsymbol{x} \\in \\Omega^{\\mathrm{ext}}}} (W\\psi)(\\boldsymbol{x}) = (K\\psi)(\\boldsymbol{x}_0) + \\frac{1}{2}\\psi(\\boldsymbol{x}_0)\n$$\n$$\n\\lim_{\\substack{\\boldsymbol{x} \\to \\boldsymbol{x}_0 \\\\ \\boldsymbol{x} \\in \\Omega}} (W\\psi)(\\boldsymbol{x}) = (K\\psi)(\\boldsymbol{x}_0) - \\frac{1}{2}\\psi(\\boldsymbol{x}_0)\n$$\nWe are asked to justify the first relation through a local analysis. Let's analyze the behavior of the integral as $\\boldsymbol{x} \\to \\boldsymbol{x}_0$ from $\\Omega^{\\text{ext}}$. We can write:\n$$\n(W\\psi)(\\boldsymbol{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} (\\psi(\\boldsymbol{y}) - \\psi(\\boldsymbol{x}_0)) \\, \\mathrm{d}s_{\\boldsymbol{y}} + \\psi(\\boldsymbol{x}_0) \\int_{\\Gamma} \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\, \\mathrm{d}s_{\\boldsymbol{y}}\n$$\nThe first integral's kernel is weakly singular, and its limit as $\\boldsymbol{x} \\to \\boldsymbol{x}_0$ gives the principal value integral with density $\\psi(\\boldsymbol{y}) - \\psi(\\boldsymbol{x}_0)$. The jump behavior is contained in the second integral. For $\\boldsymbol{x} \\in \\Omega^{\\text{ext}}$, by the divergence theorem (or Green's first identity) applied to $G(\\boldsymbol{x}, \\cdot)$ in $\\Omega$, we have $\\int_{\\Gamma} \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\, \\mathrm{d}s_{\\boldsymbol{y}} = \\int_{\\Omega} \\Delta_{\\boldsymbol{y}} G(\\boldsymbol{x},\\boldsymbol{y}) \\, \\mathrm{d}A_{\\boldsymbol{y}} = 0$, since $\\boldsymbol{x} \\notin \\Omega$. This identity holds for $\\boldsymbol{x} \\notin \\Gamma$, but the limit as $\\boldsymbol{x} \\to \\boldsymbol{x}_0$ is non-trivial.\n\nA more direct local analysis is as follows. Let $\\boldsymbol{x}_0 \\in \\Gamma$. We analyze the limit of $(W\\psi)(\\boldsymbol{x})$ for $\\boldsymbol{x} = \\boldsymbol{x}_0 + h \\boldsymbol{n}(\\boldsymbol{x}_0)$ as $h \\to 0^+$. For small $\\epsilon  0$, we split the integral over $\\Gamma$ into $\\Gamma_\\epsilon = \\Gamma \\cap B(\\boldsymbol{x}_0, \\epsilon)$ and $\\Gamma \\setminus \\Gamma_\\epsilon$. The integral over $\\Gamma \\setminus \\Gamma_\\epsilon$ converges to the principal value integral $(K\\psi)(\\boldsymbol{x}_0)$ as $\\epsilon \\to 0$ and $\\boldsymbol{x} \\to \\boldsymbol{x}_0$. The crucial part is the local contribution from $\\Gamma_\\epsilon$:\n$$ \\lim_{\\boldsymbol{x}\\to\\boldsymbol{x}_0} \\int_{\\Gamma_\\epsilon} \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\, \\psi(\\boldsymbol{y}) \\, \\mathrm{d}s_{\\boldsymbol{y}} $$\nBy continuity, $\\psi(\\boldsymbol{y}) \\approx \\psi(\\boldsymbol{x}_0)$ for $\\boldsymbol{y} \\in \\Gamma_\\epsilon$. For a $C^2$ boundary, we can approximate $\\Gamma_\\epsilon$ by a line segment (its tangent at $\\boldsymbol{x}_0$) and $\\boldsymbol{n}_{\\boldsymbol{y}}$ by $\\boldsymbol{n}(\\boldsymbol{x}_0)$. Let's set up a local coordinate system with origin at $\\boldsymbol{x}_0$, the tangent along the $y_1$-axis, and the outward normal $\\boldsymbol{n}(\\boldsymbol{x}_0)$ along the $y_2$-axis. Then $\\boldsymbol{x}_0 = \\boldsymbol{0}$, $\\boldsymbol{x} = (0,h)$ with $h0$, and a point $\\boldsymbol{y}$ on the tangent is $(y_1, 0)$. The normal is $\\boldsymbol{n}_{\\boldsymbol{y}} \\approx (0,1)$. The kernel is $\\frac{\\partial G}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} = \\nabla_{\\boldsymbol{y}} G \\cdot \\boldsymbol{n}_{\\boldsymbol{y}}$.\n$$ \\nabla_{\\boldsymbol{y}} G(\\boldsymbol{x},\\boldsymbol{y}) = -\\frac{1}{2\\pi} \\frac{\\boldsymbol{y}-\\boldsymbol{x}}{|\\boldsymbol{y}-\\boldsymbol{x}|^2} = -\\frac{1}{2\\pi} \\frac{(y_1, -h)}{y_1^2 + h^2} $$\n$$ \\frac{\\partial G}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\approx -\\frac{1}{2\\pi} \\frac{(y_1, -h) \\cdot (0,1)}{y_1^2 + h^2} = \\frac{1}{2\\pi} \\frac{h}{y_1^2 + h^2} $$\nThe local integral becomes:\n$$ \\lim_{h \\to 0^+} \\psi(\\boldsymbol{x}_0) \\int_{-\\epsilon}^{\\epsilon} \\frac{1}{2\\pi} \\frac{h}{y_1^2+h^2} \\, \\mathrm{d}y_1 $$\nLet's evaluate the integral. Using the substitution $y_1 = h \\tan\\theta$, $\\mathrm{d}y_1 = h \\sec^2\\theta \\, \\mathrm{d}\\theta$:\n$$ \\int \\frac{h}{y_1^2+h^2} \\, \\mathrm{d}y_1 = \\int \\frac{h}{h^2\\tan^2\\theta+h^2} (h \\sec^2\\theta) \\, \\mathrm{d}\\theta = \\int \\mathrm{d}\\theta = \\theta = \\arctan\\left(\\frac{y_1}{h}\\right) $$\nSo, the definite integral is:\n$$ \\frac{\\psi(\\boldsymbol{x}_0)}{2\\pi} \\left[ \\arctan\\left(\\frac{y_1}{h}\\right) \\right]_{-\\epsilon}^{\\epsilon} = \\frac{\\psi(\\boldsymbol{x}_0)}{2\\pi} \\left( \\arctan\\left(\\frac{\\epsilon}{h}\\right) - \\arctan\\left(\\frac{-\\epsilon}{h}\\right) \\right) = \\frac{\\psi(\\boldsymbol{x}_0)}{\\pi} \\arctan\\left(\\frac{\\epsilon}{h}\\right) $$\nTaking the limit as $h \\to 0^+$ (approaching from the exterior, along the normal):\n$$ \\lim_{h\\to 0^+} \\frac{\\psi(\\boldsymbol{x}_0)}{\\pi} \\arctan\\left(\\frac{\\epsilon}{h}\\right) = \\frac{\\psi(\\boldsymbol{x}_0)}{\\pi} \\cdot \\frac{\\pi}{2} = \\frac{1}{2}\\psi(\\boldsymbol{x}_0) $$\nThe positive sign is a direct consequence of the approach from $\\Omega^{\\text{ext}}$, which is the direction the normal points into. Adding this to the principal value integral gives the exterior trace.\nThus, by taking the exterior trace of the ansatz $u(\\boldsymbol{x})=(W\\psi)(\\boldsymbol{x})$ and equating it to the given boundary data $g$, we obtain the BIE:\n$$ g(\\boldsymbol{x}) = \\frac{1}{2}\\psi(\\boldsymbol{x}) + (K\\psi)(\\boldsymbol{x}) $$\nwhich can be written explicitly as:\n$$ g(\\boldsymbol{x}) = \\frac{1}{2}\\psi(\\boldsymbol{x}) + \\mathrm{p.v.} \\int_{\\Gamma} \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} \\, \\psi(\\boldsymbol{y}) \\, \\mathrm{d}s_{\\boldsymbol{y}}, \\quad \\boldsymbol{x} \\in \\Gamma $$\nThis is a Fredholm integral equation of the second kind for the unknown density $\\psi$.\n\nFinally, we determine the explicit expression for the kernel $k(\\boldsymbol{x},\\boldsymbol{y})$ of the operator $K$. By definition,\n$$ (K\\psi)(\\boldsymbol{x}) = \\mathrm{p.v.} \\int_{\\Gamma} k(\\boldsymbol{x},\\boldsymbol{y}) \\, \\psi(\\boldsymbol{y}) \\, \\mathrm{d}s_{\\boldsymbol{y}} $$\nComparing this with the integral equation, we identify the kernel as:\n$$ k(\\boldsymbol{x},\\boldsymbol{y}) = \\frac{\\partial G(\\boldsymbol{x},\\boldsymbol{y})}{\\partial \\boldsymbol{n}_{\\boldsymbol{y}}} $$\nThe derivative is with respect to the $\\boldsymbol{y}$ variable in the direction of the normal $\\boldsymbol{n}_{\\boldsymbol{y}}$ at point $\\boldsymbol{y} \\in \\Gamma$.\n$$ k(\\boldsymbol{x},\\boldsymbol{y}) = \\nabla_{\\boldsymbol{y}} G(\\boldsymbol{x},\\boldsymbol{y}) \\cdot \\boldsymbol{n}_{\\boldsymbol{y}} $$\nGiven $G(\\boldsymbol{x},\\boldsymbol{y}) = -\\frac{1}{2\\pi} \\ln |\\boldsymbol{x}-\\boldsymbol{y}|$, we first compute the gradient with respect to $\\boldsymbol{y}$:\n$$ \\nabla_{\\boldsymbol{y}} (\\ln |\\boldsymbol{x}-\\boldsymbol{y}|) = \\frac{1}{|\\boldsymbol{x}-\\boldsymbol{y}|} \\nabla_{\\boldsymbol{y}} (|\\boldsymbol{x}-\\boldsymbol{y}|) = \\frac{1}{|\\boldsymbol{x}-\\boldsymbol{y}|} \\frac{\\boldsymbol{y}-\\boldsymbol{x}}{|\\boldsymbol{x}-\\boldsymbol{y}|} = \\frac{\\boldsymbol{y}-\\boldsymbol{x}}{|\\boldsymbol{x}-\\boldsymbol{y}|^2} $$\nTherefore, the gradient of the fundamental solution is:\n$$ \\nabla_{\\boldsymbol{y}} G(\\boldsymbol{x},\\boldsymbol{y}) = -\\frac{1}{2\\pi} \\nabla_{\\boldsymbol{y}} (\\ln |\\boldsymbol{x}-\\boldsymbol{y}|) = -\\frac{1}{2\\pi} \\frac{\\boldsymbol{y}-\\boldsymbol{x}}{|\\boldsymbol{x}-\\boldsymbol{y}|^2} $$\nThe kernel is then obtained by taking the dot product with $\\boldsymbol{n}_{\\boldsymbol{y}}$:\n$$ k(\\boldsymbol{x},\\boldsymbol{y}) = \\left( -\\frac{1}{2\\pi} \\frac{\\boldsymbol{y}-\\boldsymbol{x}}{|\\boldsymbol{x}-\\boldsymbol{y}|^2} \\right) \\cdot \\boldsymbol{n}_{\\boldsymbol{y}} = \\frac{1}{2\\pi} \\frac{(\\boldsymbol{x}-\\boldsymbol{y}) \\cdot \\boldsymbol{n}_{\\boldsymbol{y}}}{|\\boldsymbol{x}-\\boldsymbol{y}|^2} $$\nThis is the explicit analytic expression for the kernel of the double-layer boundary integral operator for the Laplace equation in two dimensions.", "answer": "$$\\boxed{\\frac{1}{2\\pi} \\frac{(\\boldsymbol{x}-\\boldsymbol{y}) \\cdot \\boldsymbol{n}_{\\boldsymbol{y}}}{|\\boldsymbol{x}-\\boldsymbol{y}|^2}}$$", "id": "3367596"}, {"introduction": "Having formulated a boundary integral equation, the next step is its numerical solution, which presents a significant challenge: the kernel becomes nearly singular as the evaluation point approaches the boundary. This exercise tackles this crucial implementation detail by having you develop a robust quadrature scheme for the single-layer potential's logarithmic kernel [@problem_id:3367567]. You will implement an \"analytic subtraction\" strategy to isolate the singularity, compute its contribution exactly, and numerically demonstrate the dramatic improvement in accuracy compared to a standard quadrature method.", "problem": "Consider the two-dimensional Laplace equation and its Boundary Integral Equation (BIE) representation using the single-layer potential over a straight boundary element. The fundamental solution for the Laplace equation in two dimensions is given by $G(\\boldsymbol{x},\\boldsymbol{y}) = -\\dfrac{1}{2\\pi} \\ln \\|\\boldsymbol{x}-\\boldsymbol{y}\\|$, where $\\|\\cdot\\|$ denotes the Euclidean norm. In a Boundary Element Method (BEM) discretization, the near-singular behavior of the kernel causes large quadrature errors when the field point is close to the integration element.\n\nFocus on the model integral\n$$\nI(L,x_0,y_0) = \\int_{-L}^{L} \\varphi(s)\\, \\ln\\left(\\sqrt{(s-x_0)^2 + y_0^2}\\right)\\, \\mathrm{d}s,\n$$\nwhich corresponds to the kernel part of the single-layer potential over a straight segment parameterized by $s \\in [-L,L]$, aligned with the $x$-axis. The field point is at $(x_0,y_0)$ with $y_0  0$. Take the boundary density to be the quadratic function\n$$\n\\varphi(s) = 1 + s + \\tfrac{1}{2}\\, s^2.\n$$\n\nStarting from basic principles of boundary integral formulations for the Laplace equation and standard calculus, design and implement a near-singular quadrature strategy that reduces the error when $y_0$ is small by analytic subtraction of the logarithmic singularity. Specifically:\n- Use the closest point projection $s^\\star$ of the field point onto the element, defined by $s^\\star = \\min\\{\\max\\{x_0,-L\\},L\\}$.\n- Construct a local linear approximation of the density at $s^\\star$, given by $p(s) = \\varphi(s^\\star) + \\varphi'(s^\\star)\\,(s - s^\\star)$, where $\\varphi'(s) = \\dfrac{\\mathrm{d}\\varphi}{\\mathrm{d}s}$.\n- Split the integral into an analytically computable part and a numerically smooth remainder:\n$$\nI(L,x_0,y_0) = \\underbrace{\\int_{-L}^{L} p(s)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s}_{\\text{analytic}} \\;+\\; \\underbrace{\\int_{-L}^{L} \\big(\\varphi(s)-p(s)\\big)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s}_{\\text{smooth remainder}}.\n$$\n- Evaluate the analytic part exactly by deriving closed-form expressions for the necessary primitives using only elementary calculus.\n- Evaluate the smooth remainder with standard Gauss–Legendre quadrature.\n- For comparison, also compute the naive Gauss–Legendre quadrature of the original integrand without subtraction.\n\nTo assess accuracy, define a reference value $I_{\\text{ref}}(L,x_0,y_0)$ computed by high-accuracy adaptive integration of the original integral. For each test case, report the absolute errors\n$$\ne_{\\text{std}} = \\big|I_{\\text{GL}} - I_{\\text{ref}}\\big|, \\qquad e_{\\text{sub}} = \\big|I_{\\text{sub}} - I_{\\text{ref}}\\big|,\n$$\nwhere $I_{\\text{GL}}$ is the naive Gauss–Legendre result and $I_{\\text{sub}}$ is the analytic-subtraction result.\n\nYour program must implement the above and produce results for the following test suite of parameter values:\n- Case A (near-singular, interior projection): $L = 1$, $x_0 = 0$, $y_0 = 10^{-6}$.\n- Case B (near-singular, endpoint projection): $L = 1$, $x_0 = 1$, $y_0 = 10^{-6}$.\n- Case C (moderately near-singular, interior projection near endpoint): $L = 1$, $x_0 = 0.9$, $y_0 = 10^{-4}$.\n- Case D (well-separated field point): $L = 1$, $x_0 = 0$, $y_0 = 10^{-1}$.\n- Case E (longer panel, near-singular, interior projection): $L = 2$, $x_0 = -1.5$, $y_0 = 10^{-7}$.\n\nThere are no physical units associated with this purely mathematical problem. Angles, when appearing in analytic primitives, must be in radians.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry corresponds to a test case and must itself be a two-element list in the order $[e_{\\text{std}}, e_{\\text{sub}}]$. For example, the output format should be like\n$[[e_{\\text{std},A},e_{\\text{sub},A}],[e_{\\text{std},B},e_{\\text{sub},B}],\\dots]$.\n\nThe final program must be self-contained and require no user input. It must use a reasonable fixed Gauss–Legendre order (e.g., $N=16$) for both the naive and remainder quadratures, and a high-accuracy adaptive integration for the reference value.", "solution": "The Boundary Integral Equation for the two-dimensional Laplace equation with the single-layer potential involves the logarithmic kernel $G(\\boldsymbol{x},\\boldsymbol{y}) = -\\dfrac{1}{2\\pi} \\ln \\|\\boldsymbol{x}-\\boldsymbol{y}\\|$. When the field point $(x_0,y_0)$ approaches the boundary element, the integrand’s logarithm becomes sharply peaked, causing increased quadrature error. A principled remedy is analytic subtraction of the singular behavior while leaving a smooth remainder to be integrated numerically.\n\nWe consider the model integral\n$$\nI(L,x_0,y_0) = \\int_{-L}^{L} \\varphi(s)\\, \\ln\\left(\\sqrt{(s-x_0)^2 + y_0^2}\\right)\\, \\mathrm{d}s,\n$$\nwith the density\n$$\n\\varphi(s) = 1 + s + \\tfrac{1}{2}\\, s^2, \\quad \\varphi'(s) = 1 + s,\n$$\nover the straight segment $s \\in [-L,L]$. The near-singularity is governed by the behavior of $\\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)$ as $y_0 \\to 0$, which is integrable but numerically challenging.\n\nPrinciple-based design:\n1. Identify the closest point $s^\\star$ on the segment to the field point. Given the segment is aligned with the $x$-axis, $s^\\star = \\min\\{\\max\\{x_0,-L\\},L\\}$.\n2. Form a local linear approximation to the density at $s^\\star$:\n$$\np(s) = \\varphi(s^\\star) + \\varphi'(s^\\star)\\,(s - s^\\star).\n$$\nThis is a first-order Taylor expansion of $\\varphi(s)$ about $s^\\star$. The purpose is to capture the dominant coupling between the density and the logarithmic kernel around the peak at $s \\approx x_0$.\n3. Split the integral as\n$$\nI(L,x_0,y_0) = I_{\\text{analytic}} + I_{\\text{smooth}},\n$$\nwith\n$$\nI_{\\text{analytic}} = \\int_{-L}^{L} p(s)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s,\n\\quad\nI_{\\text{smooth}} = \\int_{-L}^{L} \\big(\\varphi(s)-p(s)\\big)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s.\n$$\nBy construction, $\\varphi(s)-p(s)$ vanishes at $s=s^\\star$, strongly attenuating the near-singular spike when $x_0$ lies in or near the element. The remainder is smooth and amenable to standard Gaussian quadrature.\n\nTo compute $I_{\\text{analytic}}$ exactly, observe that it is a linear combination of integrals of the form\n$$\n\\int_{-L}^{L} \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s\n\\quad \\text{and} \\quad\n\\int_{-L}^{L} s\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s.\n$$\nIntroduce the substitution $t = s - x_0$, so $s = t + x_0$ and the bounds map to $t \\in [a,b]$ with $a = -L - x_0$ and $b = L - x_0$.\n\nWe need closed-form antiderivatives derived from elementary calculus.\n\nFirst primitive:\nDefine\n$$\nF_0(t) = \\tfrac{1}{2}\\, t \\, \\ln(t^2 + y_0^2) \\;-\\; t \\;+\\; y_0 \\, \\arctan\\!\\left(\\frac{t}{y_0}\\right).\n$$\nThen\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} F_0(t) = \\tfrac{1}{2} \\ln(t^2 + y_0^2) = \\ln\\left(\\sqrt{t^2 + y_0^2}\\right),\n$$\nso\n$$\n\\int \\ln\\left(\\sqrt{t^2 + y_0^2}\\right)\\, \\mathrm{d}t = F_0(t) + C, \\quad\n\\int_{a}^{b} \\ln\\left(\\sqrt{t^2 + y_0^2}\\right)\\, \\mathrm{d}t = F_0(b) - F_0(a).\n$$\n\nSecond primitive:\nA compact antiderivative for $t \\ln\\left(\\sqrt{t^2+y_0^2}\\right)$ can be obtained by integration by parts and algebraic manipulation, yielding\n$$\nF_t(t) = \\tfrac{1}{4}\\, (t^2 + y_0^2)\\, \\ln(t^2 + y_0^2) \\;-\\; \\tfrac{1}{4}\\, t^2,\n$$\nwhich satisfies\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} F_t(t) = t \\ln\\left(\\sqrt{t^2 + y_0^2}\\right).\n$$\nTherefore,\n$$\n\\int t \\ln\\left(\\sqrt{t^2 + y_0^2}\\right)\\, \\mathrm{d}t = F_t(t) + C, \\quad\n\\int_{a}^{b} t \\ln\\left(\\sqrt{t^2 + y_0^2}\\right)\\, \\mathrm{d}t = F_t(b) - F_t(a).\n$$\n\nFrom these, we obtain the needed definite integrals:\n- The scalar integral:\n$$\nI_0(L,x_0,y_0) = \\int_{-L}^{L} \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s\n= \\int_{a}^{b} \\ln\\left(\\sqrt{t^2+y_0^2}\\right)\\, \\mathrm{d}t = F_0(b) - F_0(a).\n$$\n- The linear integral:\n\\begin{align*}\nI_1(L,x_0,y_0) = \\int_{-L}^{L} s\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s\n= \\int_{a}^{b} (t+x_0)\\, \\ln\\left(\\sqrt{t^2+y_0^2}\\right)\\, \\mathrm{d}t \\\\\n= \\underbrace{\\int_{a}^{b} t \\ln\\left(\\sqrt{t^2+y_0^2}\\right)\\, \\mathrm{d}t}_{F_t(b)-F_t(a)} \\;+\\; x_0\\, \\underbrace{\\int_{a}^{b} \\ln\\left(\\sqrt{t^2+y_0^2}\\right)\\, \\mathrm{d}t}_{F_0(b)-F_0(a)} \\\\\n= \\big(F_t(b) - F_t(a)\\big) + x_0\\, \\big(F_0(b) - F_0(a)\\big).\n\\end{align*}\n\nWith these, the analytic part is assembled as\n$$\nI_{\\text{analytic}} = \\varphi(s^\\star)\\, I_0(L,x_0,y_0) \\;+\\; \\varphi'(s^\\star)\\, \\int_{-L}^{L} (s - s^\\star)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s,\n$$\nand the last integral is\n$$\n\\int_{-L}^{L} (s - s^\\star)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s\n= I_1(L,x_0,y_0) \\;-\\; s^\\star\\, I_0(L,x_0,y_0).\n$$\nTherefore,\n$$\nI_{\\text{analytic}} = \\varphi(s^\\star)\\, I_0 \\;+\\; \\varphi'(s^\\star)\\, \\big( I_1 - s^\\star I_0 \\big),\n$$\nwhere $I_0$ and $I_1$ abbreviate $I_0(L,x_0,y_0)$ and $I_1(L,x_0,y_0)$ respectively.\n\nThe smooth remainder\n$$\nI_{\\text{smooth}} = \\int_{-L}^{L} \\big(\\varphi(s)-p(s)\\big)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)\\, \\mathrm{d}s\n$$\nis numerically integrated with Gauss–Legendre quadrature of fixed order $N$ on $[-L,L]$:\n$$\n\\int_{-L}^{L} f(s)\\, \\mathrm{d}s \\approx \\sum_{i=1}^{N} w_i\\, f(s_i), \\quad s_i = L \\xi_i, \\quad w_i = L \\omega_i,\n$$\nwhere $\\{\\xi_i,\\omega_i\\}_{i=1}^{N}$ are nodes and weights on $[-1,1]$ and the Jacobian $L$ maps $[-1,1]$ to $[-L,L]$.\n\nFor comparison, the naive Gauss–Legendre approximation $I_{\\text{GL}}$ is computed by applying Gauss–Legendre directly to the original integrand $\\varphi(s)\\, \\ln\\left(\\sqrt{(s-x_0)^2+y_0^2}\\right)$. The reference value $I_{\\text{ref}}$ is approximated via high-accuracy adaptive integration of the original integral using an absolute and relative tolerance sufficiently tight (e.g., $10^{-12}$), ensuring that the reference error is negligible relative to the reported errors.\n\nAlgorithmic steps per test case $(L,x_0,y_0)$:\n- Compute $s^\\star = \\min\\{\\max\\{x_0,-L\\},L\\}$.\n- Evaluate $\\varphi(s^\\star)$ and $\\varphi'(s^\\star)$.\n- Compute $I_0$ and $I_1$ using the closed-form expressions $F_0$ and $F_t$.\n- Form $I_{\\text{analytic}}$ via the linear combination in terms of $I_0$ and $I_1$.\n- Compute $I_{\\text{smooth}}$ with Gauss–Legendre of order $N$ on the remainder integrand.\n- Combine $I_{\\text{sub}} = I_{\\text{analytic}} + I_{\\text{smooth}}$.\n- Compute $I_{\\text{GL}}$ via Gauss–Legendre of order $N$ on the original integrand.\n- Compute $I_{\\text{ref}}$ via adaptive integration of the original integrand.\n- Report $e_{\\text{std}} = |I_{\\text{GL}} - I_{\\text{ref}}|$ and $e_{\\text{sub}} = |I_{\\text{sub}} - I_{\\text{ref}}|$.\n\nRationale:\n- The analytic subtraction isolates the dominant near-singular structure and computes it exactly, removing the stiff peak from the numerical quadrature and greatly reducing error when $y_0$ is small.\n- The remainder is smooth because $\\varphi(s)-p(s)$ vanishes at the closest point and varies slowly, allowing standard Gaussian quadrature to perform well.\n\nExpected outcomes:\n- For very small $y_0$, $e_{\\text{sub}}$ will be substantially smaller than $e_{\\text{std}}$.\n- For larger $y_0$, both methods should perform similarly, with $e_{\\text{sub}}$ not worse than $e_{\\text{std}}$.\n\nThe program implements these steps for the specified test cases and prints a single line containing the list of $[e_{\\text{std}}, e_{\\text{sub}}]$ pairs in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Density and its derivative\ndef phi(s):\n    # phi(s) = 1 + s + 0.5 s^2\n    return 1.0 + s + 0.5 * s**2\n\ndef dphi(s):\n    # dphi(s) = 1 + s\n    return 1.0 + s\n\n# Analytic primitives for integrals over [-L, L] with t = s - x0\ndef I0(L, x0, y):\n    # I0 = ∫_{-L}^{L} ln( sqrt( (s - x0)^2 + y^2 ) ) ds\n    a = -L - x0\n    b = L - x0\n    def F0(t):\n        # F0'(t) = 0.5 * ln(t^2 + y^2) = ln(sqrt(t^2 + y^2))\n        return 0.5 * t * np.log(t*t + y*y) - t + y * np.arctan(t / y)\n    return F0(b) - F0(a)\n\ndef I1(L, x0, y):\n    # I1 = ∫_{-L}^{L} s * ln( sqrt( (s - x0)^2 + y^2 ) ) ds\n    a = -L - x0\n    b = L - x0\n    def Ft(t):\n        # Ft'(t) = t * ln( sqrt(t^2 + y^2) )\n        # Compact antiderivative: 0.25*(t^2 + y^2)*ln(t^2 + y^2) - 0.25*t^2\n        return 0.25 * (t*t + y*y) * np.log(t*t + y*y) - 0.25 * t*t\n    def F0(t):\n        return 0.5 * t * np.log(t*t + y*y) - t + y * np.arctan(t / y)\n    It = Ft(b) - Ft(a)\n    I0_val = F0(b) - F0(a)\n    return It + x0 * I0_val\n\n# Gauss-Legendre quadrature on [-L, L]\ndef gauss_legendre_integral(L, x0, y, N, integrand):\n    # Nodes and weights on [-1,1]\n    xi, wi = np.polynomial.legendre.leggauss(N)\n    # Map to [-L, L]: s = L * xi, ds = L\n    s = L * xi\n    w = L * wi\n    vals = integrand(s, x0, y)\n    return np.dot(w, vals)\n\n# Original integrand\ndef integrand_original(s, x0, y):\n    return phi(s) * np.log(np.sqrt((s - x0)**2 + y**2))\n\n# Remainder integrand after analytic subtraction\ndef integrand_remainder(s, x0, y, L):\n    s_star = np.clip(x0, -L, L)\n    p = phi(s_star) + dphi(s_star) * (s - s_star)\n    return (phi(s) - p) * np.log(np.sqrt((s - x0)**2 + y**2))\n\n# Reference via adaptive integration\ndef reference_integral(L, x0, y):\n    f = lambda s: phi(s) * np.log(np.sqrt((s - x0)**2 + y**2))\n    # Tight tolerances for high accuracy\n    val, _ = quad(f, -L, L, epsabs=1e-12, epsrel=1e-12, limit=500)\n    return val\n\n# Analytic subtraction method\ndef analytic_subtraction_integral(L, x0, y, N):\n    s_star = np.clip(x0, -L, L)\n    alpha = phi(s_star)\n    beta = dphi(s_star)\n    I0_val = I0(L, x0, y)\n    I1_val = I1(L, x0, y)\n    analytic_part = alpha * I0_val + beta * (I1_val - s_star * I0_val)\n    # Smooth remainder by Gauss-Legendre\n    rem_integrand = lambda s, x0_, y_: integrand_remainder(s, x0_, y_, L)\n    remainder_part = gauss_legendre_integral(L, x0, y, N, rem_integrand)\n    return analytic_part + remainder_part\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (L, x0, y0)\n    test_cases = [\n        (1.0, 0.0, 1e-6),   # Case A: near-singular, interior projection\n        (1.0, 1.0, 1e-6),   # Case B: near-singular, endpoint projection\n        (1.0, 0.9, 1e-4),   # Case C: moderately near-singular, near endpoint\n        (1.0, 0.0, 1e-1),   # Case D: well-separated field point\n        (2.0, -1.5, 1e-7),  # Case E: longer panel, near-singular, interior\n    ]\n    N = 16  # Gauss-Legendre order\n\n    results = []\n    for L, x0, y0 in test_cases:\n        # Reference\n        I_ref = reference_integral(L, x0, y0)\n        # Naive Gauss-Legendre\n        I_gl = gauss_legendre_integral(L, x0, y0, N, integrand_original)\n        # Analytic subtraction\n        I_sub = analytic_subtraction_integral(L, x0, y0, N)\n        # Errors\n        e_std = abs(I_gl - I_ref)\n        e_sub = abs(I_sub - I_ref)\n        results.append([e_std, e_sub])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join('[' + ','.join(map(str, r)) + ']' for r in results)}]\")\n\nsolve()\n```", "id": "3367567"}, {"introduction": "The theoretical underpinnings of BEM guarantee its efficiency and accuracy, but only when certain conditions on the boundary's smoothness are met. This practice explores the profound connection between the abstract theory of compact operators and the practical performance of a BEM solver [@problem_id:3367622]. By numerically implementing the double-layer operator for both a smooth circle and a non-smooth cardioid with a cusp, you will observe firsthand how the loss of boundary smoothness leads to a failure of operator compactness, resulting in ill-conditioned linear systems and a breakdown in numerical stability.", "problem": "Consider the exterior Dirichlet problem for the two-dimensional Laplace equation around a bounded domain with a simple closed boundary $\\Gamma \\subset \\mathbb{R}^2$ of class $C^{2}$. The fundamental base for this problem is classical potential theory for the Laplace equation, specifically Green's representation formula and the jump relations of layer potentials. Let $u$ satisfy $\\Delta u = 0$ in the unbounded exterior, with $u = g$ prescribed on $\\Gamma$ and $u(\\mathbf{x}) \\to 0$ as $\\|\\mathbf{x}\\| \\to \\infty$. One may represent $u$ using a double-layer potential with density $\\mu$ as\n$$\nu(\\mathbf{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} \\mu(\\mathbf{y}) \\, \\mathrm{d}s(\\mathbf{y}) \\quad \\text{for } \\mathbf{x} \\text{ in the exterior},\n$$\nwhere $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\|\\mathbf{x}-\\mathbf{y}\\|$ is the two-dimensional free-space Green's function and $\\partial/\\partial n(\\mathbf{y})$ denotes the derivative with respect to the outward normal at $\\mathbf{y} \\in \\Gamma$. The integral operator defining the double-layer potential is known to have a limiting trace on the boundary given by the jump relation. From this fundamental base, formulate the second-kind boundary integral equation for the unknown density $\\mu$ on $\\Gamma$ in the form\n$$\n\\left(\\frac{1}{2}I + K\\right)\\mu = g \\quad \\text{on } \\Gamma,\n$$\nwhere $K$ is the boundary integral operator with kernel\n$$\nK(\\mathbf{x},\\mathbf{y}) = \\frac{\\partial G(\\mathbf{x},\\mathbf{y})}{\\partial n(\\mathbf{y})} = \\frac{1}{2\\pi} \\frac{(\\mathbf{x}-\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{\\|\\mathbf{x}-\\mathbf{y}\\|^2},\n$$\ninterpreted in the Cauchy principal value sense. Your tasks are:\n\n- Using only the potential theoretic base and mapping properties of weakly singular operators on smooth manifolds, justify why $K$ is a compact linear operator on appropriate Sobolev spaces over $\\Gamma$ when $\\Gamma$ is $C^{2}$, and hence why $\\frac{1}{2}I + K$ is a Fredholm operator of index $0$.\n\n- Construct a counterexample by replacing $\\Gamma$ with a cusped, non-$C^{1}$ closed curve for which the compactness of $K$ fails. Give a local argument based on the leading-order behavior of the kernel near the cusp that explains the failure of compactness at the functional-analytic level.\n\n- Quantify numerical consequences in a Boundary Element Method (BEM) discretization via a Nyström scheme. Use the following discrete setting: parameterize $\\Gamma$ by a $2\\pi$-periodic smooth map $\\mathbf{x}(t)$ with $t \\in [0,2\\pi)$, let $\\Delta t = 2\\pi/N$, sample $t_j = (j+\\tfrac{1}{2})\\Delta t$ for $j=0,\\dots,N-1$ in radians, define $\\mathbf{x}_j = \\mathbf{x}(t_j)$, $\\mathbf{t}_j = \\mathbf{x}'(t_j)$, $\\mathbf{n}_j = ((\\mathbf{t}_j)_y, -(\\mathbf{t}_j)_x)/{\\|\\mathbf{t}_j\\|}$ (clockwise rotation of the tangent to get the outward unit normal), and quadrature weights $w_j = \\|\\mathbf{t}_j\\|\\Delta t$. Approximate $K$ by the $N \\times N$ matrix $K_N$ with entries\n$$\n(K_N)_{ij} =\n\\begin{cases}\n\\frac{1}{2\\pi} \\frac{(\\mathbf{x}_i - \\mathbf{x}_j) \\cdot \\mathbf{n}_j}{\\|\\mathbf{x}_i - \\mathbf{x}_j\\|^2} \\, w_j,  i \\neq j, \\\\\n0,  i=j,\n\\end{cases}\n$$\nand $A_N = \\frac{1}{2} I + K_N$. For smooth $\\Gamma$, $A_N$ discretizes a second-kind Fredholm integral equation and should be well-conditioned as $N$ increases, while for a cusped $\\Gamma$ the discrete operator is expected to exhibit degraded conditioning and non-decaying singular values.\n\n- Implement a single self-contained program that assembles $K_N$ and $A_N$ for two parameterized boundaries:\n  - Smooth boundary: the unit circle parameterized by $\\mathbf{x}(t) = (\\cos t, \\sin t)$ for $t \\in [0,2\\pi)$.\n  - Cusped boundary: the cardioid with a cusp at $t=\\pi$, parameterized in polar form by $r(t) = 1 + \\cos t$ and $\\mathbf{x}(t) = (r(t)\\cos t, r(t)\\sin t)$ for $t \\in [0,2\\pi)$.\n  In both cases, take $t_j = (j+\\tfrac{1}{2})\\Delta t$ to avoid sampling exactly at the cusp.\n\n- For each boundary and each value of $N$ in the test suite, compute:\n  - The spectral $2$-norm condition number $\\kappa_2(A_N)$.\n  - A compactness proxy $R_{0.9}(K_N)$ defined as $R_{0.9}(K_N) = \\sigma_{\\lfloor 0.9 N \\rfloor}(K_N)/\\sigma_1(K_N)$, where $\\sigma_1 \\ge \\sigma_2 \\ge \\dots$ are the singular values of $K_N$ in nonincreasing order. For compact operators, as $N$ grows, this ratio should decrease toward $0$, whereas for non-compact cases it should not.\n\n- Test suite (all angles in radians):\n  - Smooth unit circle with $N=64$.\n  - Smooth unit circle with $N=128$.\n  - Cusped cardioid with $N=64$.\n  - Cusped cardioid with $N=128$.\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n  $[\\kappa_2(A_N) \\text{ for circle with } N=64, R_{0.9}(K_N) \\text{ for circle with } N=64, \\kappa_2(A_N) \\text{ for circle with } N=128, R_{0.9}(K_N) \\text{ for circle with } N=128, \\kappa_2(A_N) \\text{ for cardioid with } N=64, R_{0.9}(K_N) \\text{ for cardioid with } N=64, \\kappa_2(A_N) \\text{ for cardioid with } N=128, R_{0.9}(K_N) \\text{ for cardioid with } N=128]$.\n\nThe expected outputs are floats. No physical units are involved. All angles must be in radians. The implementation must be robust in the sense of avoiding evaluation exactly at the cusp by using midpoints $t_j = (j+\\tfrac{1}{2})\\Delta t$.", "solution": "The problem is well-posed and scientifically sound, grounded in the classical theory of potential and boundary integral equations for elliptic partial differential equations. All provided definitions, conditions, and tasks are consistent and mathematically rigorous. We may therefore proceed with a full solution.\n\nThe solution is presented in three parts. First, we provide a theoretical justification for the properties of the boundary integral operator on smooth domains. Second, we analyze the breakdown of these properties on a domain with a cusp. Third, we describe the numerical implementation designed to verify these theoretical predictions.\n\n### 1. Operator Properties on Smooth Domains\n\nThe problem asks to justify why the double-layer potential operator,\n$$\n(K\\mu)(\\mathbf{x}) = \\int_{\\Gamma} K(\\mathbf{x},\\mathbf{y}) \\mu(\\mathbf{y}) \\, \\mathrm{d}s(\\mathbf{y}), \\quad \\text{with kernel } K(\\mathbf{x},\\mathbf{y}) = \\frac{1}{2\\pi} \\frac{(\\mathbf{x}-\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y})}{\\|\\mathbf{x}-\\mathbf{y}\\|^2}\n$$\nis a compact operator on a suitable function space over $\\Gamma$ when $\\Gamma$ is a $C^2$ closed curve.\n\nCompactness of an integral operator is determined by the regularity of its kernel. For $\\mathbf{x} \\neq \\mathbf{y}$, the kernel $K(\\mathbf{x}, \\mathbf{y})$ is infinitely differentiable. The critical behavior occurs as $\\mathbf{y} \\to \\mathbf{x}$. Let $\\Gamma$ be parameterized by a $C^2$ function $\\mathbf{z}(t)$, where $t$ can be taken as the arc length parameter, so $\\|\\mathbf{z}'(t)\\| = 1$. Let $\\mathbf{x} = \\mathbf{z}(t_0)$ and $\\mathbf{y} = \\mathbf{z}(t)$. For $t$ near $t_0$, we use a Taylor expansion of $\\mathbf{z}(t)$ around $t_0$:\n$$\n\\mathbf{z}(t) = \\mathbf{z}(t_0) + (t-t_0)\\mathbf{z}'(t_0) + \\frac{(t-t_0)^2}{2}\\mathbf{z}''(t_0) + O((t-t_0)^3)\n$$\nThe tangent vector is $\\mathbf{T}(t_0) = \\mathbf{z}'(t_0)$ and the normal vector is $\\mathbf{N}(t_0)$. The Frenet-Serret formulas in $\\mathbb{R}^2$ give $\\mathbf{z}''(t_0) = \\kappa(t_0) \\mathbf{N}(t_0)$, where $\\kappa(t_0)$ is the curvature at $\\mathbf{z}(t_0)$. The vector from $\\mathbf{y}$ to $\\mathbf{x}$ is:\n$$\n\\mathbf{x} - \\mathbf{y} = \\mathbf{z}(t_0) - \\mathbf{z}(t) \\approx -(t-t_0)\\mathbf{T}(t_0) - \\frac{(t-t_0)^2}{2}\\kappa(t_0)\\mathbf{N}(t_0)\n$$\nThe squared norm of this vector is:\n$$\n\\|\\mathbf{x}-\\mathbf{y}\\|^2 \\approx \\|-(t-t_0)\\mathbf{T}(t_0)\\|^2 = (t-t_0)^2\\|\\mathbf{T}(t_0)\\|^2 = (t-t_0)^2\n$$\nThe normal vector $\\mathbf{n}(\\mathbf{y}) = \\mathbf{N}(t)$ can also be expanded:\n$$\n\\mathbf{n}(\\mathbf{y}) = \\mathbf{N}(t) \\approx \\mathbf{N}(t_0) + (t-t_0)\\mathbf{N}'(t_0) = \\mathbf{N}(t_0) - (t-t_0)\\kappa(t_0)\\mathbf{T}(t_0)\n$$\nThe dot product in the numerator of the kernel is:\n$$\n(\\mathbf{x}-\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y}) \\approx \\left(-(t-t_0)\\mathbf{T}(t_0) - \\frac{(t-t_0)^2}{2}\\kappa(t_0)\\mathbf{N}(t_0)\\right) \\cdot \\left(\\mathbf{N}(t_0) - (t-t_0)\\kappa(t_0)\\mathbf{T}(t_0)\\right)\n$$\nUsing the orthogonality $\\mathbf{T}(t_0) \\cdot \\mathbf{N}(t_0) = 0$ and normality $\\|\\mathbf{T}(t_0)\\|=\\|\\mathbf{N}(t_0)\\|=1$, the dot product simplifies:\n$$\n(\\mathbf{x}-\\mathbf{y}) \\cdot \\mathbf{n}(\\mathbf{y}) \\approx (-(t-t_0))(-(t-t_0)\\kappa(t_0))\\|\\mathbf{T}(t_0)\\|^2 - \\frac{(t-t_0)^2}{2}\\kappa(t_0)\\|\\mathbf{N}(t_0)\\|^2 = (t-t_0)^2\\kappa(t_0) - \\frac{(t-t_0)^2}{2}\\kappa(t_0) = \\frac{(t-t_0)^2}{2}\\kappa(t_0)\n$$\nThe kernel's behavior as $\\mathbf{y} \\to \\mathbf{x}$ (i.e., $t \\to t_0$) is thus:\n$$\nK(\\mathbf{x},\\mathbf{y}) \\to \\frac{1}{2\\pi} \\frac{\\frac{(t-t_0)^2}{2}\\kappa(t_0)}{(t-t_0)^2} = \\frac{\\kappa(t_0)}{4\\pi}\n$$\nSince the kernel has a well-defined, finite limit, the singularity is removable. For a $C^2$ boundary $\\Gamma$, the kernel $K(\\mathbf{x}, \\mathbf{y})$ is a continuous function on $\\Gamma \\times \\Gamma$. An integral operator with a continuous kernel on a compact domain (like the closed, bounded curve $\\Gamma$) is a compact operator on spaces such as $C(\\Gamma)$ or $L^2(\\Gamma)$.\n\nThe operator $\\frac{1}{2}I + K$ is of the form $\\lambda I - A$ with $\\lambda = 1/2$ and $A = -K$. Since $K$ is compact, $A$ is also compact. By the Fredholm-Riesz-Schauder theory, an operator of the form $I - (\\text{compact})$ is a Fredholm operator of index $0$. Our operator can be written as $\\frac{1}{2}(I + 2K)$, and since $2K$ is compact, $I+2K$ is Fredholm of index $0$. This property is preserved under scaling by the non-zero constant $\\frac{1}{2}$. Thus, $\\frac{1}{2}I + K$ is a Fredholm operator of index $0$.\n\n### 2. Failure of Compactness for Cusped Geometries\n\nWe now construct a counterexample using the cardioid, which is parameterized in polar coordinates by $r(t) = 1+\\cos t$ for $t \\in [0, 2\\pi)$. This curve has a cusp at the origin, corresponding to $t=\\pi$. At this point, the curve is not $C^1$, as the tangent vector $\\mathbf{x}'(t)$ vanishes.\n\nThe compactness of $K$ is a smoothing property, which relies on the \"uniform\" nature of the kernel $K(\\mathbf{x}, \\mathbf{y})$ with respect to its arguments. The regularity of the boundary $\\Gamma$ is essential for this. At a cusp, the geometry changes abruptly. Specifically, the outward unit normal vector $\\mathbf{n}(\\mathbf{y})$ is discontinuous. As a point $\\mathbf{y}$ approaches the cusp from one side of the curve (e.g., $t \\to \\pi^-$), its normal vector $\\mathbf{n}(\\mathbf{y})$ approaches a limit $\\mathbf{n}_-$. As it approaches from the other side ($t \\to \\pi^+$), the normal approaches a different limit $\\mathbf{n}_+$. For the cardioid cusp, $\\mathbf{n}_- = -\\mathbf{n}_+$.\n\nThe kernel $K(\\mathbf{x}, \\mathbf{y})$ is directly dependent on $\\mathbf{n}(\\mathbf{y})$. This discontinuity in the normal vector is inherited by the kernel. For any fixed $\\mathbf{x}$ not at the cusp, the function $\\mathbf{y} \\mapsto K(\\mathbf{x}, \\mathbf{y})$ is discontinuous at the cusp.\nA standard result in functional analysis states that for an integral operator to be compact on $C(\\Gamma)$, the family of functions $\\{K(\\cdot, \\mathbf{y}) : \\mathbf{y} \\in \\Gamma\\}$ must be equicontinuous. The discontinuity at the cusp violates this condition, preventing the operator from being compact on $C(\\Gamma)$. A similar, though more technical, argument shows the failure of compactness on $L^2(\\Gamma)$ as well. The lack of compactness means that the operator is not of the form \"identity + compact\", and the Fredholm alternative does not apply. The equation is no longer a Fredholm integral equation of the second kind.\n\n### 3. Numerical Investigation and Consequences\n\nWe use a Nyström discretization scheme to convert the integral operator $K$ into a matrix $K_N$ and the integral equation into a linear system.\n$$\n\\left(\\frac{1}{2}I + K_N\\right)\\boldsymbol{\\mu} = \\mathbf{g}\n$$\nwhere $\\boldsymbol{\\mu}$ and $\\mathbf{g}$ are vectors of function values at a set of $N$ collocation points $\\{\\mathbf{x}_j\\}_{j=0}^{N-1}$ on $\\Gamma$.\n\nTwo metrics are computed to quantify the properties of the discrete operators:\n1.  **Condition Number $\\kappa_2(A_N)$**: The spectral condition number of the system matrix $A_N = \\frac{1}{2}I + K_N$. For a well-posed second-kind Fredholm equation, the discrete system should be well-conditioned, meaning $\\kappa_2(A_N)$ remains bounded as $N \\to \\infty$. For a problem where compactness fails, we expect $\\kappa_2(A_N)$ to grow with $N$, indicating numerical instability.\n2.  **Compactness Proxy $R_{0.9}(K_N)$**: Defined as $R_{0.9}(K_N) = \\sigma_{\\lfloor 0.9 N \\rfloor}(K_N)/\\sigma_1(K_N)$, this ratio measures how quickly the singular values of $K_N$ decay. For a compact operator, a finite-rank approximation becomes arbitrarily accurate, which is reflected in the rapid decay of singular values to zero. Therefore, for the smooth circle, we expect $R_{0.9}(K_N) \\to 0$ as $N \\to \\infty$. For the non-compact operator on the cardioid, the singular values decay much more slowly, and we expect $R_{0.9}(K_N)$ to approach a non-zero constant.\n\nThe implementation will compute these quantities for the unit circle (a $C^\\infty$ boundary) and the cardioid (a non-$C^1$ boundary with a cusp) for $N=64$ and $N=128$. The results are expected to confirm the theoretical predictions: stable, low condition numbers and rapid singular value decay for the circle, versus growing condition numbers and slow singular value decay for the cardioid.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to execute the BEM analysis for the specified test cases.\n    \"\"\"\n    test_cases = [\n        ('circle', 64),\n        ('circle', 128),\n        ('cardioid', 64),\n        ('cardioid', 128),\n    ]\n\n    results = []\n    for boundary_type, N in test_cases:\n        # 1. Set up discretization\n        dt = 2.0 * np.pi / N\n        # Use midpoints to avoid evaluating at t=pi (the cusp)\n        t = (np.arange(N) + 0.5) * dt\n\n        # 2. Define geometry and its derivatives\n        if boundary_type == 'circle':\n            # Parameterization for the unit circle\n            x_coords = np.cos(t)\n            y_coords = np.sin(t)\n            # Derivatives for tangent vector computation\n            xp = -np.sin(t)\n            yp = np.cos(t)\n        elif boundary_type == 'cardioid':\n            # Parameterization for the cardioid\n            r = 1.0 + np.cos(t)\n            x_coords = r * np.cos(t)\n            y_coords = r * np.sin(t)\n            # Derivatives for tangent vector computation\n            xp = -np.sin(t) * (1.0 + 2.0 * np.cos(t))\n            yp = np.cos(t) + np.cos(2.0 * t)\n        \n        # Collocation points (N x 2 array)\n        x_j = np.vstack((x_coords, y_coords)).T\n        \n        # Tangent vectors (N x 2 array)\n        t_j = np.vstack((xp, yp)).T\n        \n        # Norms of tangent vectors (length N array)\n        norm_t_j = np.linalg.norm(t_j, axis=1)\n        \n        # Outward unit normal vectors (N x 2 array)\n        # Normal is a clockwise 90-degree rotation of the tangent\n        n_j = np.vstack((t_j[:, 1], -t_j[:, 0])).T / norm_t_j[:, np.newaxis]\n        \n        # Quadrature weights\n        w_j = norm_t_j * dt\n\n        # 3. Assemble the kernel matrix K_N\n        K_N = np.zeros((N, N))\n        for i in range(N):\n            for j in range(N):\n                if i == j:\n                    # Diagonal entries are set to zero as per the Nyström scheme definition\n                    K_N[i, j] = 0.0\n                else:\n                    diff = x_j[i, :] - x_j[j, :]\n                    norm_diff_sq = np.dot(diff, diff)\n                    dot_prod = np.dot(diff, n_j[j, :])\n                    K_N[i, j] = (1.0 / (2.0 * np.pi)) * (dot_prod / norm_diff_sq) * w_j[j]\n\n        # 4. Form the system matrix A_N\n        A_N = 0.5 * np.eye(N) + K_N\n\n        # 5. Compute metrics\n        # a) Condition number of A_N\n        cond_A_N = np.linalg.cond(A_N, 2)\n        \n        # b) Compactness proxy for K_N\n        # Compute singular values of K_N, sorted in non-increasing order\n        s = linalg.svd(K_N, compute_uv=False)\n        \n        # The problem asks for sigma_k, where k = floor(0.9*N). This implies 1-based\n        # indexing for sigma. NumPy s is 0-indexed. So s[k-1] corresponds to sigma_k.\n        k = int(np.floor(0.9 * N))\n        compactness_proxy_index = k - 1\n        \n        if len(s) > compactness_proxy_index and s[0] > 1e-15:\n            R_09_K_N = s[compactness_proxy_index] / s[0]\n        else:\n            R_09_K_N = 0.0 # Handle cases where K_N is nearly zero or rank-deficient\n\n        results.append(cond_A_N)\n        results.append(R_09_K_N)\n\n    # Convert results to string for the final output format\n    result_str = ','.join(map(str, results))\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "3367622"}]}