{"hands_on_practices": [{"introduction": "The energy method provides a powerful framework not just for analyzing stability, but for designing stable numerical schemes. This first exercise [@problem_id:3384333] demonstrates this principle for the linear advection equation, a cornerstone of hyperbolic PDEs. By using Summation-By-Parts (SBP) operators, which discretely mimic integration by parts, you will learn how to determine the penalty parameters in a Simultaneous Approximation Term (SAT) to ensure the discrete energy evolution correctly accounts for inflow and outflow at the boundaries.", "problem": "Consider the constant-coefficient linear advection partial differential equation (PDE) $u_t + a\\,u_x = 0$ posed on the spatial interval $x \\in [0,1]$ with speed $a \\in \\mathbb{R}$. The continuous energy method, obtained by multiplying the PDE by $u$ and integrating over $[0,1]$, yields the energy identity\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\int_{0}^{1} u(x,t)^2\\,\\mathrm{d}x\\right) + \\frac{a}{2}\\left(u(1,t)^2 - u(0,t)^2\\right) = 0,\n$$\nwhich makes clear that the energy flux through the boundaries is governed by the boundary values and the sign of $a$. For numerical approximation, suppose the spatial derivative is approximated by a Summation By Parts (SBP) finite-difference operator $D = H^{-1}Q$ acting on the grid function $u(t) \\in \\mathbb{R}^{N}$ at grid points $x_1=0  x_2  \\cdots  x_N=1$, where $H \\in \\mathbb{R}^{N\\times N}$ is symmetric positive definite and $Q \\in \\mathbb{R}^{N\\times N}$ satisfies the SBP property $Q + Q^{\\top} = B$, with $B = -e_1 e_1^{\\top} + e_N e_N^{\\top}$ and $e_1, e_N \\in \\mathbb{R}^{N}$ the first and last standard basis vectors. To weakly impose boundary conditions, use the Simultaneous Approximation Term (SAT) with unknown penalty coefficients $\\sigma_L, \\sigma_R \\in \\mathbb{R}$ at the left and right boundaries, respectively, leading to the semi-discrete scheme\n$$\nu_t + a\\,H^{-1}Q\\,u = H^{-1}\\,\\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + H^{-1}\\,\\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right),\n$$\nwhere $u_1(t)$ and $u_N(t)$ denote the first and last components of $u(t)$, and $g_L(t)$ and $g_R(t)$ are prescribed boundary data associated with the inflow boundary (the boundary where characteristics enter the domain) and the outflow boundary (the boundary where characteristics leave the domain), depending on the sign of $a$. Using the discrete energy $E(t) = \\frac{1}{2}u(t)^{\\top}H\\,u(t)$, determine the values of the SAT penalty coefficients $\\sigma_L$ and $\\sigma_R$ as functions of $a$ such that:\n- the discrete energy method matches the continuous energy flux at the inflow boundary in the sense that the boundary data contributes with the same sign and magnitude as in the continuous identity, and\n- the discrete energy is semibounded, that is, the discrete energy derivative is bounded above by a term depending only on the prescribed inflow data and the outflow contributes dissipatively.\n\nExpress your final answer as a closed-form analytic expression for $\\sigma_L$ and $\\sigma_R$ in terms of $a$, presented together as a single row matrix. No numerical rounding is required.", "solution": "The validity of the problem statement is hereby confirmed. The problem is a well-posed, scientifically grounded exercise in the stability analysis of numerical methods for partial differential equations, specifically the Summation-By-Parts Simultaneous-Approximation-Term (SBP-SAT) framework. All provided definitions and givens are standard, self-contained, and consistent. We may, therefore, proceed to a solution.\n\nOur objective is to determine the penalty coefficients $\\sigma_L$ and $\\sigma_R$ for the semi-discrete scheme\n$$\nu_t + a\\,H^{-1}Q\\,u = H^{-1}\\,\\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + H^{-1}\\,\\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right).\n$$\nWe will use the energy method. The discrete energy is defined as $E(t) = \\frac{1}{2}u(t)^{\\top}H\\,u(t)$. We seek its time derivative, $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$.\n\nFirst, we pre-multiply the semi-discrete equation by the matrix $H$ to obtain:\n$$\nH\\,u_t + a\\,Q\\,u = \\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + \\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right).\n$$\nNext, we take the dot product with the solution vector $u(t)$ (pre-multiply by $u^{\\top}$):\n$$\nu^{\\top}H\\,u_t + a\\,u^{\\top}Q\\,u = \\sigma_L\\,u^{\\top}e_1\\left(g_L - u_1\\right) + \\sigma_R\\,u^{\\top}e_N\\left(g_R - u_N\\right).\n$$\nWe analyze each term.\nThe first term relates to the energy derivative. Since $H$ is symmetric and constant in time, we have\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}u^{\\top}H\\,u\\right) = \\frac{1}{2}\\left(u_t^{\\top}H\\,u + u^{\\top}H\\,u_t\\right) = u^{\\top}H\\,u_t.\n$$\nThe second term involves the matrix $Q$. Using the SBP property $Q+Q^{\\top}=B$, the quadratic form $u^{\\top}Qu$ can be expressed as:\n$$\nu^{\\top}Q\\,u = \\frac{1}{2}\\left(u^{\\top}Q\\,u + u^{\\top}Q\\,u\\right) = \\frac{1}{2}\\left(u^{\\top}Q\\,u + u^{\\top}Q^{\\top}u\\right) = \\frac{1}{2}u^{\\top}(Q+Q^{\\top})u = \\frac{1}{2}u^{\\top}B\\,u.\n$$\nSubstituting $B = -e_1 e_1^{\\top} + e_N e_N^{\\top}$ and recalling that $u_1 = e_1^{\\top}u$ and $u_N = e_N^{\\top}u$, we get:\n$$\nu^{\\top}Q\\,u = \\frac{1}{2}u^{\\top}(-e_1 e_1^{\\top} + e_N e_N^{\\top})u = \\frac{1}{2}\\left(-(u^{\\top}e_1)(e_1^{\\top}u) + (u^{\\top}e_N)(e_N^{\\top}u)\\right) = \\frac{1}{2}\\left(-u_1^2 + u_N^2\\right).\n$$\nThe terms on the right-hand side are the SAT terms. Noting that $u^{\\top}e_1 = u_1$ and $u^{\\top}e_N = u_N$, the right-hand side becomes:\n$$\n\\sigma_L\\,u_1(g_L - u_1) + \\sigma_R\\,u_N(g_R - u_N) = \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2.\n$$\nCombining these results, we obtain the discrete energy evolution equation:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} + \\frac{a}{2}\\left(u_N^2 - u_1^2\\right) = \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2.\n$$\nRearranging to group terms by boundary, we have:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\left( \\frac{a}{2}u_1^2 + \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 \\right) + \\left( -\\frac{a}{2}u_N^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2 \\right).\n$$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\left(\\frac{a}{2} - \\sigma_L\\right)u_1^2 + \\sigma_L\\,g_L u_1 - \\left(\\frac{a}{2} + \\sigma_R\\right)u_N^2 + \\sigma_R\\,g_R u_N.\n$$\nThe choice of $\\sigma_L$ and $\\sigma_R$ depends on the sign of the advection speed $a$, which determines the inflow and outflow boundaries.\n\nCase 1: $a > 0$.\nThe characteristics propagate from left to right. The inflow boundary is at $x=0$ (left), and the outflow is at $x=1$ (right).\nThe physical boundary condition is prescribed at $x=0$, i.e., $u(0,t) = g_L(t)$.\nThe continuous energy identity implies an energy influx of $\\frac{a}{2}g_L^2$. To match this, we analyze the inflow terms for $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$: $(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$. For semiboundedness, we want this to be of the form $-\\text{dissipation} + \\text{influx}$. We complete the square:\n$$\n-\\frac{a}{2}(u_1 - g_L)^2 + \\frac{a}{2}g_L^2 = -\\frac{a}{2}(u_1^2 - 2g_L u_1 + g_L^2) + \\frac{a}{2}g_L^2 = -\\frac{a}{2}u_1^2 + a\\,g_L u_1.\n$$\nComparing $(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$ with $-\\frac{a}{2}u_1^2 + a\\,g_L u_1$, we equate coefficients:\n- Coefficient of $u_1^2$: $\\frac{a}{2} - \\sigma_L = -\\frac{a}{2} \\implies \\sigma_L = a$.\n- Coefficient of $g_L u_1$: $\\sigma_L = a$.\nBoth conditions are satisfied by $\\sigma_L = a$.\nAt the outflow boundary ($x=1$), no data is prescribed. The outflow must be dissipative. The outflow terms are $-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R g_R u_N$. The most straightforward way to ensure dissipativity without external data is to set the penalty term to zero, which happens for $\\sigma_R = 0$. The terms then reduce to $-\\frac{a}{2}u_N^2$, which is non-positive since $a>0$.\nThus, for $a>0$, we have $\\sigma_L = a$ and $\\sigma_R = 0$. The energy rate becomes $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{a}{2}(u_1-g_L)^2 + \\frac{a}{2}g_L^2 - \\frac{a}{2}u_N^2 \\le \\frac{a}{2}g_L^2$, which satisfies the requirements.\n\nCase 2: $a  0$.\nThe characteristics propagate from right to left. The inflow boundary is at $x=1$ (right), and the outflow is at $x=0$ (left).\nThe physical boundary condition is at $x=1$, i.e., $u(1,t) = g_R(t)$.\nThe continuous energy identity implies an energy influx of $-\\frac{a}{2}g_R^2$. We analyze the inflow terms for $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$: $-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R\\,g_R u_N$. We complete the square to match the desired form, noting that $a0$:\n$$\n\\frac{a}{2}(u_N - g_R)^2 - \\frac{a}{2}g_R^2 = \\frac{a}{2}(u_N^2 - 2g_R u_N + g_R^2) - \\frac{a}{2}g_R^2 = \\frac{a}{2}u_N^2 - a\\,g_R u_N.\n$$\nThe term $\\frac{a}{2}(u_N-g_R)^2$ is dissipative since $a0$. Comparing $-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R\\,g_R u_N$ with $\\frac{a}{2}u_N^2 - a\\,g_R u_N$:\n- Coefficient of $u_N^2$: $-(\\frac{a}{2} + \\sigma_R) = \\frac{a}{2} \\implies -\\sigma_R = a \\implies \\sigma_R = -a$.\n- Coefficient of $g_R u_N$: $\\sigma_R = -a$.\nBoth conditions are satisfied by $\\sigma_R = -a$.\nAt the outflow boundary ($x=0$), we require dissipativity. The outflow terms are $(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$. Setting $\\sigma_L=0$ removes the penalty, and the terms reduce to $\\frac{a}{2}u_1^2$, which is non-positive since $a0$.\nThus, for $a0$, we have $\\sigma_L = 0$ and $\\sigma_R = -a$. The energy rate becomes $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{a}{2}u_1^2 + \\frac{a}{2}(u_N-g_R)^2 - \\frac{a}{2}g_R^2 \\le -\\frac{a}{2}g_R^2$, satisfying the requirements.\n\nCase 3: $a = 0$.\nThe PDE is $u_t=0$. No boundary conditions are needed. The scheme should be stable with no penalty terms. Both inflow and outflow analyses suggest the corresponding coefficient is zero. For $a=0$, $\\sigma_L=a=0$ and $\\sigma_R=0$ (from $a0$ case), and $\\sigma_L=0$ and $\\sigma_R=-a=0$ (from $a0$ case). Both agree. Thus, $\\sigma_L=0, \\sigma_R=0$.\n\nWe can unify these results into a single expression for any $a \\in \\mathbb{R}$.\nFor $\\sigma_L$: we have $\\sigma_L=a$ if $a0$, and $\\sigma_L=0$ if $a \\le 0$. This can be written as $\\sigma_L = \\max(a, 0) = \\frac{a+|a|}{2}$.\nFor $\\sigma_R$: we have $\\sigma_R=0$ if $a0$, and $\\sigma_R=-a$ if $a \\le 0$. Note that if $a0$, $-a = |a|$. This can be written as $\\sigma_R = \\max(-a, 0) = \\frac{-a+|a|}{2}$.\n\nTherefore, the penalty coefficients are given by the expressions:\n$$\n\\sigma_L = \\frac{a+|a|}{2} \\quad \\text{and} \\quad \\sigma_R = \\frac{-a+|a|}{2}.\n$$\nThese are the standard upwind penalty coefficients for the SBP-SAT formulation of the linear advection equation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{a+|a|}{2}  \\frac{-a+|a|}{2}\n\\end{pmatrix}\n}\n$$", "id": "3384333"}, {"introduction": "Shifting our focus to parabolic problems, this practice [@problem_id:3384271] explores the stability of a finite difference scheme for the heat equation with Neumann (zero-flux) boundary conditions. Here, you will use the technique of ghost cells to extend the computational stencil to the boundaries. The core task is to perform a discrete energy analysis via summation by parts to determine the ghost cell parameters that guarantee the scheme is dissipative, just like its continuous counterpart.", "problem": "Consider the one-dimensional diffusion (heat) equation $u_{t} = u_{xx}$ on the spatial domain $x \\in [0,1]$ with homogeneous Neumann boundary conditions $u_{x}(0,t) = 0$ and $u_{x}(1,t) = 0$. Let the spatial interval be partitioned uniformly by $x_{i} = i h$ for $i = 0, 1, \\dots, N$, where $h = 1/N$. Define a semi-discrete finite difference scheme on the grid values $u_{i}(t)$ by\n$$\n\\frac{d}{dt} u_{i} = \\frac{u_{i-1} - 2 u_{i} + u_{i+1}}{h^{2}}, \\quad i = 1, 2, \\dots, N-1,\n$$\nand apply the same three-point stencil at the boundary nodes $i=0$ and $i=N$ by introducing ghost-cell values $u_{-1}$ and $u_{N+1}$. Assume a two-parameter affine ghost-cell closure\n$$\nu_{-1} = \\alpha\\,u_{0} + \\beta\\,u_{1}, \\qquad u_{N+1} = \\alpha\\,u_{N} + \\beta\\,u_{N-1},\n$$\nwith real weights $\\alpha, \\beta \\in \\mathbb{R}$ to be chosen.\n\nStarting from the discrete $L^{2}$ energy $\\|u\\|_{h}^{2} := h \\sum_{i=0}^{N} u_{i}^{2}$ and the fundamental fact that diffusion dissipates energy via integration by parts, derive the exact semi-discrete energy balance for this scheme. Identify the interior dissipation and the boundary energy flux in terms of $\\alpha$ and $\\beta$. Then determine the values of $\\alpha$ and $\\beta$ such that the discrete energy is non-increasing for arbitrary grid data, and the Neumann boundary condition is enforced in a natural discrete sense at the boundary nodes. Express your final answer as the ordered pair $(\\alpha,\\beta)$ using exact values. No rounding is required.", "solution": "The user wants to find the parameters $(\\alpha, \\beta)$ for a ghost-cell closure in a finite difference scheme for the 1D heat equation, such that the scheme is stable in a discrete energy norm and respects the Neumann boundary conditions.\n\nFirst, we derive the semi-discrete energy balance. The discrete $L^2$ energy is defined as $E(t) = \\|u(t)\\|_{h}^{2} = h \\sum_{i=0}^{N} u_{i}(t)^{2}$. We compute its time derivative:\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( h \\sum_{i=0}^{N} u_{i}^{2} \\right) = h \\sum_{i=0}^{N} 2 u_{i} \\frac{du_{i}}{dt} = 2h \\sum_{i=0}^{N} u_{i} \\frac{du_{i}}{dt}\n$$\nThe semi-discrete scheme is given for all nodes $i=0, 1, \\dots, N$ as:\n$$\n\\frac{du_{i}}{dt} = \\frac{u_{i-1} - 2u_{i} + u_{i+1}}{h^{2}}\n$$\nSubstituting this into the expression for $\\frac{dE}{dt}$:\n$$\n\\frac{dE}{dt} = 2h \\sum_{i=0}^{N} u_{i} \\left( \\frac{u_{i-1} - 2u_{i} + u_{i+1}}{h^{2}} \\right) = \\frac{2}{h} \\sum_{i=0}^{N} u_{i} (u_{i-1} - 2u_{i} + u_{i+1})\n$$\nTo analyze this expression, we perform a summation by parts. The term inside the sum can be written as $u_i((u_{i+1}-u_i) - (u_i-u_{i-1}))$.\n$$\n\\sum_{i=0}^{N} u_{i} (u_{i-1} - 2u_{i} + u_{i+1}) = \\sum_{i=0}^{N} u_{i} (u_{i+1}-u_i) - \\sum_{i=0}^{N} u_{i} (u_i-u_{i-1})\n$$\nLet's re-index the second sum. Let $j=i-1$, so $i=j+1$. The sum becomes $\\sum_{j=-1}^{N-1} u_{j+1} (u_{j+1}-u_j)$.\n$$\n= \\sum_{i=0}^{N} u_{i} (u_{i+1}-u_i) - \\left( u_0(u_0-u_{-1}) + \\sum_{j=0}^{N-1} u_{j+1}(u_{j+1}-u_j) \\right)\n$$\nWe split the first sum at $i=N-1$: $\\sum_{i=0}^{N-1} u_i(u_{i+1}-u_i) + u_N(u_{N+1}-u_N)$.\n$$\n= u_N(u_{N+1}-u_N) + \\sum_{i=0}^{N-1} u_i(u_{i+1}-u_i) - u_0(u_0-u_{-1}) - \\sum_{i=0}^{N-1} u_{i+1}(u_{i+1}-u_i)\n$$\nCombining the two sums gives:\n$$\n= u_N(u_{N+1}-u_N) - u_0(u_0-u_{-1}) + \\sum_{i=0}^{N-1} (u_i - u_{i+1})(u_{i+1}-u_i)\n$$\n$$\n= u_N(u_{N+1}-u_N) + u_0(u_{-1}-u_0) - \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2\n$$\nSubstituting this back into the expression for $\\frac{dE}{dt}$, we obtain the energy balance equation:\n$$\n\\frac{dE}{dt} = \\frac{2}{h} \\left( u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) \\right) - \\frac{2}{h} \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2\n$$\nThis equation mirrors the continuous case, $\\frac{d}{dt}\\int_0^1 u^2 dx = 2[uu_x]_0^1 - 2\\int_0^1 (u_x)^2 dx$. The term\n$$\nD = -\\frac{2}{h} \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2 = -2h \\sum_{i=0}^{N-1} \\left(\\frac{u_{i+1}-u_i}{h}\\right)^2\n$$\nis the **interior dissipation**. It is always non-positive. The term\n$$\nB = \\frac{2}{h} \\left( u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) \\right)\n$$\nis the **boundary energy flux**.\n\nNow, we must determine $\\alpha$ and $\\beta$. The conditions are:\n1. The discrete energy is non-increasing, $\\frac{dE}{dt} \\le 0$, for arbitrary grid data.\n2. The Neumann boundary condition is enforced in a natural discrete sense.\n\nSince the interior dissipation $D$ is already non-positive, the stability condition $\\frac{dE}{dt} \\le 0$ requires constraints on the boundary flux $B$. In the continuous case, the Neumann conditions $u_x(0,t)=u_x(1,t)=0$ make the boundary flux term $[uu_x]_0^1$ vanish. A \"natural discrete sense\" for the energy method is to enforce the same property on the discrete boundary flux, i.e., $B=0$. This is a sufficient condition for stability, as $\\frac{dE}{dt}$ would then equal the non-positive dissipation term $D$.\n\nWe set $B=0$. Before substituting the ghost-cell relations, this implies:\n$u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) = 0$ for arbitrary $u_i$.\nThis can be guaranteed by setting each part to zero:\n$u_{-1}-u_0 = 0 \\implies u_{-1}=u_0$\n$u_{N+1}-u_N = 0 \\implies u_{N+1}=u_N$\n\nNow we use the given affine ghost-cell closure to find $\\alpha$ and $\\beta$.\nAt the left boundary:\n$$\nu_{-1} = \\alpha u_0 + \\beta u_1\n$$\nFor this to equal $u_0$ for arbitrary $u_0$ and $u_1$, we must have:\n$$\nu_0 = \\alpha u_0 + \\beta u_1 \\implies (1-\\alpha)u_0 - \\beta u_1 = 0\n$$\nSince this must hold for any values of $u_0$ and $u_1$, the coefficients must be zero. This gives $1-\\alpha=0$ and $\\beta=0$, so $\\alpha=1$ and $\\beta=0$.\n\nAt the right boundary:\n$$\nu_{N+1} = \\alpha u_N + \\beta u_{N-1}\n$$\nFor this to equal $u_N$ for arbitrary $u_N$ and $u_{N-1}$:\n$$\nu_N = \\alpha u_N + \\beta u_{N-1} \\implies (1-\\alpha)u_N - \\beta u_{N-1} = 0\n$$\nThis likewise implies $1-\\alpha=0$ and $\\beta=0$.\n\nThe choice $(\\alpha, \\beta) = (1,0)$ satisfies both boundary requirements and guarantees that the boundary flux $B$ is zero, thus ensuring stability ($\\frac{dE}{dt} \\le 0$).\n\nThis choice corresponds to setting the ghost cell values as $u_{-1}=u_0$ and $u_{N+1}=u_N$. This represents a zero-order extrapolation. This method implements the discrete zero-flux condition in the form $\\frac{u_0-u_{-1}}{h}=0$ (a first-order approximation of $u_x$ at $x=-h/2$) and $\\frac{u_{N+1}-u_N}{h}=0$ (at $x=1+h/2$), which is a simple and common, thus \"natural\", approach.\n\nTherefore, the only pair $(\\alpha, \\beta)$ that satisfies both conditions is $(1,0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0\n\\end{pmatrix}\n}\n$$", "id": "3384271"}, {"introduction": "A stable spatial discretization is only half the battle; the time integration method must also be chosen carefully to ensure stability of the fully discrete scheme. This final practice [@problem_id:3384336] investigates the leapfrog method, a popular scheme for second-order wave equations. You will derive an exactly conserved discrete energy, use its properties to establish the famous Courant-Friedrichs-Lewy (CFL) stability condition, and uncover the existence of a parasitic computational mode inherent to this two-step method.", "problem": "Consider the constant-coefficient wave equation on a $d$-dimensional periodic domain discretized in space by the standard second-order centered finite difference Laplacian. Let $h$ denote the uniform grid spacing in each coordinate direction, and let $L_h$ be the discrete Laplacian acting on grid functions with the following properties: $L_h$ is symmetric with respect to the discrete $\\ell^2$ inner product and negative semidefinite under periodic boundary conditions. The semi-discrete wave equation takes the form\n$$\nu_{tt}(t) \\;=\\; c^2\\,L_h\\,u(t),\n$$\nwhere $c0$ is the wave speed and $u(t)$ is a grid function depending on time $t$.\n\nYou apply the explicit two-step centered-in-time (leapfrog) update to $u(t)$,\n$$\nu^{n+1} \\;-\\; 2\\,u^n \\;+\\; u^{n-1} \\;=\\; c^2\\,\\Delta t^2\\,L_h\\,u^n,\n$$\nwith time step $\\Delta t$ and grid functions $u^n \\approx u(n\\,\\Delta t)$.\n\nYour tasks are:\n\n1) Starting only from the symmetry and negative semidefiniteness of $L_h$ and the structure of the time-stepping recurrence, derive a discrete energy $\\mathcal{E}^{n+\\frac{1}{2}}$ that is exactly invariant in $n$ under the above update on the periodic grid. Your derivation must explicitly use the discrete $\\ell^2$ inner product and algebraic identities that telescope in $n$.\n\n2) Using the derived invariant, establish a sharp condition under which $\\mathcal{E}^{n+\\frac{1}{2}}$ is positive definite and uniformly controls the physical energy of the semi-discrete wave equation. Specialize this condition to the periodic centered-difference Laplacian in $d$ space dimensions, whose spectral radius is known to satisfy\n$$\n\\max_{\\xi}\\,\\lambda_{\\max}\\bigl(-L_h\\bigr) \\;=\\; \\frac{4d}{h^2},\n$$\nand express the resulting Courant–Friedrichs–Lewy (CFL) bound as a sharp restriction on the nondimensional number $\\sigma \\equiv \\dfrac{c\\,\\Delta t}{h}$ in terms of $d$.\n\n3) To assess the presence of parasitic modes intrinsic to leapfrog time integration, analyze the scalar linear test equation obtained by projecting the first-order Hamiltonian form of the semi-discrete wave equation onto a single Fourier–Laplacian eigenmode. Concretely, consider $y_t = i\\,\\omega\\,y$ with $\\omega \\ge 0$ and apply the leapfrog update $y^{n+1} = y^{n-1} + 2\\,\\Delta t\\,i\\,\\omega\\,y^n$. Derive the two amplification factors in closed form and identify, in the limit $\\omega\\,\\Delta t \\to 0$, which of the two is the parasitic computational mode and how it manifests in time.\n\nReport only the sharp upper bound expression for $\\sigma$ that you obtain in part 2 as your final answer. No units are required, and no rounding is needed because the answer is exact.", "solution": "The problem asks for the derivation of a conserved discrete energy for the leapfrog scheme applied to the semi-discrete wave equation, the derivation of the associated stability condition (CFL condition), and an analysis of the parasitic modes of the leapfrog scheme. The final answer is the sharp upper bound on the Courant number $\\sigma$.\n\n### Part 1: Derivation of the Conserved Discrete Energy\n\nLet the discrete $\\ell^2$ inner product of two grid functions $u$ and $v$ on the $d$-dimensional periodic grid be denoted by $\\langle u, v \\rangle$, with the associated norm $\\|u\\|^2 = \\langle u, u \\rangle$. The problem states that the discrete Laplacian $L_h$ is symmetric with respect to this inner product, i.e., $\\langle L_h u, v \\rangle = \\langle u, L_h v \\rangle$, and negative semidefinite, i.e., $\\langle L_h u, u \\rangle \\le 0$ for any grid function $u$.\n\nThe leapfrog time-stepping scheme is given by\n$$\nu^{n+1} - 2u^n + u^{n-1} = c^2 \\Delta t^2 L_h u^n.\n$$\nTo find a conserved quantity, we seek a discrete analogue of the total energy, which is a sum of kinetic and potential energy. We define a discrete energy at the half-integer time step $n+\\frac{1}{2}$ as\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} = \\frac{1}{2} \\left\\| \\frac{u^{n+1} - u^n}{\\Delta t} \\right\\|^2 - \\frac{c^2}{2} \\langle L_h u^{n+1}, u^n \\rangle.\n$$\nThe first term is a discrete kinetic energy, and the second is a discrete potential energy. We now demonstrate that this quantity is exactly conserved, i.e., $\\mathcal{E}^{n+\\frac{1}{2}} = \\mathcal{E}^{n-\\frac{1}{2}}$ for all $n \\ge 1$.\n\nLet's compute the change in energy from time step $n-\\frac{1}{2}$ to $n+\\frac{1}{2}$:\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} - \\mathcal{E}^{n-\\frac{1}{2}} = \\left( \\frac{1}{2} \\left\\| \\frac{u^{n+1} - u^n}{\\Delta t} \\right\\|^2 - \\frac{1}{2} \\left\\| \\frac{u^n - u^{n-1}}{\\Delta t} \\right\\|^2 \\right) - \\frac{c^2}{2} \\left( \\langle L_h u^{n+1}, u^n \\rangle - \\langle L_h u^n, u^{n-1} \\rangle \\right).\n$$\nWe analyze the kinetic energy term first. Using the algebraic identity $\\|A\\|^2 - \\|B\\|^2 = \\langle A-B, A+B \\rangle$, with $A = u^{n+1} - u^n$ and $B = u^n - u^{n-1}$, we get\n\\begin{align*}\n\\frac{1}{2\\Delta t^2} \\left( \\|u^{n+1} - u^n\\|^2 - \\|u^n - u^{n-1}\\|^2 \\right) = \\frac{1}{2\\Delta t^2} \\langle (u^{n+1} - u^n) - (u^n - u^{n-1}), (u^{n+1} - u^n) + (u^n - u^{n-1}) \\rangle \\\\\n= \\frac{1}{2\\Delta t^2} \\langle u^{n+1} - 2u^n + u^{n-1}, u^{n+1} - u^{n-1} \\rangle.\n\\end{align*}\nNow, we substitute the leapfrog scheme $u^{n+1} - 2u^n + u^{n-1} = c^2 \\Delta t^2 L_h u^n$ into this expression:\n$$\n\\frac{1}{2\\Delta t^2} \\langle c^2 \\Delta t^2 L_h u^n, u^{n+1} - u^{n-1} \\rangle = \\frac{c^2}{2} \\langle L_h u^n, u^{n+1} - u^{n-1} \\rangle = \\frac{c^2}{2} (\\langle L_h u^n, u^{n+1} \\rangle - \\langle L_h u^n, u^{n-1} \\rangle).\n$$\nSubstituting this back into the expression for the change in total energy gives\n\\begin{align*}\n\\mathcal{E}^{n+\\frac{1}{2}} - \\mathcal{E}^{n-\\frac{1}{2}} = \\frac{c^2}{2} (\\langle L_h u^n, u^{n+1} \\rangle - \\langle L_h u^n, u^{n-1} \\rangle) - \\frac{c^2}{2} (\\langle L_h u^{n+1}, u^n \\rangle - \\langle L_h u^n, u^{n-1} \\rangle) \\\\\n= \\frac{c^2}{2} (\\langle L_h u^n, u^{n+1} \\rangle - \\langle L_h u^{n+1}, u^n \\rangle).\n\\end{align*}\nUsing the symmetry of the operator $L_h$, we have $\\langle L_h u^n, u^{n+1} \\rangle = \\langle u^n, L_h u^{n+1} \\rangle = \\langle L_h u^{n+1}, u^n \\rangle$. Therefore, the two terms cancel:\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} - \\mathcal{E}^{n-\\frac{1}{2}} = 0.\n$$\nThis confirms that $\\mathcal{E}^{n+\\frac{1}{2}}$ is an exactly conserved quantity for the scheme.\n\n### Part 2: Stability (CFL) Condition\n\nFor the numerical scheme to be stable, the conserved energy $\\mathcal{E}^{n+\\frac{1}{2}}$ must be a positive definite (or semidefinite) quadratic form of the solution state, which ensures that the solution norm does not grow in time. The state at time $n$ can be described by the pair $(u^{n+1}, u^n)$. We need to find the condition under which $\\mathcal{E}^{n+\\frac{1}{2}} \\ge 0$ for any state.\n\nWe rewrite the potential energy term using the polarization identity $\\langle Ax, y \\rangle = \\frac{1}{4}(\\langle A(x+y), x+y \\rangle - \\langle A(x-y), x-y \\rangle)$, which holds for any symmetric operator $A$. With $A=L_h$, $x=u^{n+1}$, and $y=u^n$:\n$$\n\\langle L_h u^{n+1}, u^n \\rangle = \\frac{1}{4} \\left( \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle - \\langle L_h(u^{n+1}-u^n), u^{n+1}-u^n \\rangle \\right).\n$$\nSubstituting this into the energy expression:\n\\begin{align*}\n\\mathcal{E}^{n+\\frac{1}{2}} = \\frac{1}{2\\Delta t^2} \\|u^{n+1} - u^n\\|^2 - \\frac{c^2}{8} \\left( \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle - \\langle L_h(u^{n+1}-u^n), u^{n+1}-u^n \\rangle \\right) \\\\\n= \\left( \\frac{1}{2\\Delta t^2} \\|u^{n+1} - u^n\\|^2 + \\frac{c^2}{8} \\langle L_h(u^{n+1}-u^n), u^{n+1}-u^n \\rangle \\right) - \\frac{c^2}{8} \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle.\n\\end{align*}\nLet's group the terms. The expression can be rewritten as:\n$$\n\\mathcal{E}^{n+\\frac{1}{2}} = \\frac{1}{2} \\left\\langle \\left( \\frac{1}{\\Delta t^2}I + \\frac{c^2}{4}L_h \\right) (u^{n+1}-u^n), u^{n+1}-u^n \\right\\rangle - \\frac{c^2}{8} \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle.\n$$\nThe second term, $-\\frac{c^2}{8} \\langle L_h(u^{n+1}+u^n), u^{n+1}+u^n \\rangle$, is non-negative because $L_h$ is negative semidefinite ($\\langle L_h v, v \\rangle \\le 0$ for any $v$). For $\\mathcal{E}^{n+1/2}$ to be non-negative, the first term must also be non-negative. This requires the operator $A = \\frac{1}{\\Delta t^2}I + \\frac{c^2}{4}L_h$ to be positive semidefinite.\n\nAn operator is positive semidefinite if and only if all its eigenvalues are non-negative. Let $\\lambda_k$ be an eigenvalue of $L_h$. Since $L_h$ is negative semidefinite, $\\lambda_k \\le 0$. The corresponding eigenvalue of $A$ is $\\mu_k = \\frac{1}{\\Delta t^2} + \\frac{c^2}{4}\\lambda_k$. The condition $\\mu_k \\ge 0$ must hold for all $k$.\n$$\n\\frac{1}{\\Delta t^2} + \\frac{c^2}{4}\\lambda_k \\ge 0 \\implies 1 + \\frac{c^2 \\Delta t^2}{4}\\lambda_k \\ge 0.\n$$\nThis inequality must be satisfied for all eigenvalues $\\lambda_k$. The most restrictive case is for the most negative eigenvalue, $\\lambda_{\\min} = \\min_k \\lambda_k$. The condition becomes:\n$$\n1 + \\frac{c^2 \\Delta t^2}{4}\\lambda_{\\min} \\ge 0 \\implies 1 \\ge -\\frac{c^2 \\Delta t^2}{4}\\lambda_{\\min} \\implies \\frac{c^2 \\Delta t^2}{4} (-\\lambda_{\\min}) \\le 1.\n$$\nThe quantity $-\\lambda_{\\min}$ is the largest eigenvalue of the positive semidefinite operator $-L_h$, which is its spectral radius, $\\rho(-L_h)$. The stability condition is thus:\n$$\nc^2 \\Delta t^2 \\rho(-L_h) \\le 4.\n$$\nThe problem provides the spectral radius for the standard $d$-dimensional centered finite difference Laplacian under periodic boundary conditions: $\\rho(-L_h) = \\frac{4d}{h^2}$. Substituting this into our stability condition:\n$$\nc^2 \\Delta t^2 \\left(\\frac{4d}{h^2}\\right) \\le 4 \\implies \\frac{c^2 \\Delta t^2}{h^2} d \\le 1.\n$$\nDefining the non-dimensional Courant number $\\sigma \\equiv \\frac{c\\,\\Delta t}{h}$, the condition becomes $\\sigma^2 d \\le 1$. Since $\\sigma \\ge 0$, this yields the sharp CFL condition:\n$$\n\\sigma \\le \\frac{1}{\\sqrt{d}}.\n$$\nThe sharp upper bound for $\\sigma$ is $\\frac{1}{\\sqrt{d}}$.\n\n### Part 3: Analysis of Parasitic Modes\n\nWe analyze the leapfrog scheme applied to the test equation $y_t = i\\omega y$ for $\\omega \\ge 0$. The specified update is\n$$\ny^{n+1} = y^{n-1} + 2\\,\\Delta t\\,i\\,\\omega\\,y^n.\n$$\nThis can be rewritten as a linear homogeneous recurrence relation: $y^{n+1} - (2i\\omega\\Delta t)y^n - y^{n-1} = 0$. To find the amplification factors, we seek solutions of the form $y^n = g^n$, which leads to the characteristic equation for $g$:\n$$\ng^2 - (2i\\omega\\Delta t)g - 1 = 0.\n$$\nLet $p = \\omega\\Delta t$. The equation is $g^2 - 2ipg - 1 = 0$. Solving for $g$ using the quadratic formula:\n$$\ng = \\frac{2ip \\pm \\sqrt{(-2ip)^2 - 4(1)(-1)}}{2} = \\frac{2ip \\pm \\sqrt{-4p^2 + 4}}{2} = ip \\pm \\sqrt{1-p^2}.\n$$\nThe two amplification factors are $g_1 = ip + \\sqrt{1-p^2}$ and $g_2 = ip - \\sqrt{1-p^2}$.\n\nTo identify the physical and parasitic modes, we examine their behavior in the limit $\\omega\\Delta t \\to 0$, i.e., $p \\to 0$. We use the Taylor expansion $\\sqrt{1-p^2} \\approx 1 - \\frac{1}{2}p^2$ for small $p$.\n\nFor the first root, $g_1$:\n$$\ng_1 \\approx ip + \\left(1 - \\frac{1}{2}p^2\\right) = 1 + ip - \\frac{1}{2}p^2.\n$$\nThe exact amplification factor for the ODE $y_t=i\\omega y$ over a time step $\\Delta t$ is $\\exp(i\\omega\\Delta t) = \\exp(ip)$. Its Taylor expansion is $\\exp(ip) = 1 + ip + \\frac{(ip)^2}{2!} + \\dots = 1 + ip - \\frac{1}{2}p^2 + O(p^3)$. Since $g_1$ matches the expansion of the true amplification factor up to second order, $g_1$ is the physical mode.\n\nFor the second root, $g_2$:\n$$\ng_2 \\approx ip - \\left(1 - \\frac{1}{2}p^2\\right) = -1 + ip + \\frac{1}{2}p^2.\n$$\nIn the limit $p \\to 0$, $g_2 \\to -1$. This mode does not correspond to the solution of the original differential equation and is therefore the parasitic computational mode. Its presence means that any numerical solution will generally be a superposition of the physical mode and this parasitic mode. Since $g_2 \\approx -1$, the parasitic component of the solution behaves like $C_2 (g_2)^n \\approx C_2 (-1)^n$, where $C_2$ is a constant. This manifests in time as a high-frequency numerical oscillation that changes sign at every time step, superimposed on the physically correct solution.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{d}}}$$", "id": "3384336"}]}