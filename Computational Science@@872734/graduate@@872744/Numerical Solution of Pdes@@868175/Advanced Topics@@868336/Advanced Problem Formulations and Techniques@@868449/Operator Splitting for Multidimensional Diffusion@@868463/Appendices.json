{"hands_on_practices": [{"introduction": "A primary concern when designing any time-stepping scheme is its stability. This exercise uses von Neumann analysis to investigate a hybrid Alternating Direction Implicit (ADI) scheme, where one spatial direction is treated explicitly and the other implicitly. By deriving the amplification factor, you will discover how the stability of the entire scheme is dictated by its explicit component, revealing a crucial trade-off in numerical method design. [@problem_id:3427455]", "problem": "Consider the two-dimensional anisotropic diffusion equation on a rectangular torus (periodic in both directions),\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; \\kappa_{x}\\,\\frac{\\partial^{2} u}{\\partial x^{2}} \\;+\\; \\kappa_{y}\\,\\frac{\\partial^{2} u}{\\partial y^{2}},\n$$\nwhere $\\kappa_{x}0$ and $\\kappa_{y}0$ are constant diffusion coefficients. Let the spatial domain be discretized by a uniform grid with spacings $h_{x}$ in the $x$-direction and $h_{y}$ in the $y$-direction, and approximate the spatial second derivatives by standard second-order centered differences, so that the discrete operators $L_{x}$ and $L_{y}$ act on the grid function $\\{u_{i,j}\\}$ via\n$$\n(L_{x} u)_{i,j} \\;=\\; \\frac{u_{i+1,j} - 2 u_{i,j} + u_{i-1,j}}{h_{x}^{2}}, \n\\qquad\n(L_{y} u)_{i,j} \\;=\\; \\frac{u_{i,j+1} - 2 u_{i,j} + u_{i,j-1}}{h_{y}^{2}}.\n$$\nDefine one time step of size $\\Delta t$ by an operator splitting of Alternating Direction Implicit (ADI) type that uses explicit Euler for the $x$-diffusion fractional step and implicit Euler for the $y$-diffusion fractional step, each applied over a half-step of size $\\Delta t/2$:\n$$\n\\text{Step A (explicit in $x$):}\\quad w^{n+\\frac{1}{2}} \\;=\\; u^{n} \\;+\\; \\frac{\\Delta t}{2}\\,\\kappa_{x}\\,L_{x} u^{n},\n$$\n$$\n\\text{Step B (implicit in $y$):}\\quad \\bigl(I \\;-\\; \\frac{\\Delta t}{2}\\,\\kappa_{y}\\,L_{y}\\bigr)\\,u^{n+1} \\;=\\; w^{n+\\frac{1}{2}}.\n$$\nAssume periodic boundary conditions in both directions and use von Neumann (Fourier) analysis with plane-wave modes to assess linear stability. Determine, as a closed-form analytic expression, the largest allowable time step $\\Delta t_{\\max}$ such that the magnitude of the one-step amplification factor is at most $1$ for all Fourier modes. Your answer must be expressed symbolically in terms of $\\kappa_x$ and $h_x$ only. No numerical evaluation is required.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution without contradiction. We may proceed with the solution.\n\nThe problem requires a linear stability analysis of a given operator-splitting scheme for the two-dimensional anisotropic diffusion equation. The method of choice, as specified, is the von Neumann (or Fourier) analysis. We consider a single plane-wave mode of the numerical solution on the grid, of the form:\n$$\nu_{i,j}^{n} = g^{n} \\exp(\\mathrm{i}(k_x i h_x + k_y j h_y))\n$$\nwhere $n$ is the time level index, $(i,j)$ are the spatial grid indices, $g$ is the complex amplification factor for one time step $\\Delta t$, $\\mathrm{i} = \\sqrt{-1}$ is the imaginary unit, and $k_x$ and $k_y$ are the wavenumbers in the $x$- and $y$-directions, respectively. For convenience, we define the dimensionless phase angles $\\theta_x = k_x h_x$ and $\\theta_y = k_y h_y$. The spatial part of the mode is then $\\exp(\\mathrm{i}(i\\theta_x + j\\theta_y))$. The stability of the numerical scheme is ensured if the magnitude of the amplification factor satisfies $|g| \\leq 1$ for all possible real wavenumbers, which correspond to $\\theta_x \\in [-\\pi, \\pi]$ and $\\theta_y \\in [-\\pi, \\pi]$.\n\nFirst, we determine the effect of the discrete spatial operators $L_x$ and $L_y$ on this Fourier mode.\nFor the operator $L_x$:\n$$\n(L_x u)_{i,j} = \\frac{u_{i+1,j} - 2 u_{i,j} + u_{i-1,j}}{h_{x}^{2}}\n$$\nSubstituting $u_{i,j} = \\exp(\\mathrm{i}(i\\theta_x + j\\theta_y))$:\n$$\n(L_x u)_{i,j} = \\frac{\\exp(\\mathrm{i}((i+1)\\theta_x + j\\theta_y)) - 2\\exp(\\mathrm{i}(i\\theta_x + j\\theta_y)) + \\exp(\\mathrm{i}((i-1)\\theta_x + j\\theta_y))}{h_x^2}\n$$\n$$\n(L_x u)_{i,j} = \\frac{\\exp(\\mathrm{i}\\theta_x) - 2 + \\exp(-\\mathrm{i}\\theta_x)}{h_x^2} u_{i,j} = \\frac{2\\cos(\\theta_x) - 2}{h_x^2} u_{i,j}\n$$\nUsing the identity $1 - \\cos(\\theta_x) = 2\\sin^2(\\theta_x/2)$, we find the symbol (eigenvalue) $\\hat{L}_x$ of the operator $L_x$:\n$$\n\\hat{L}_x(\\theta_x) = -\\frac{4}{h_x^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\n$$\nBy an identical argument, the symbol of the operator $L_y$ is:\n$$\n\\hat{L}_y(\\theta_y) = -\\frac{4}{h_y^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\n$$\n\nNext, we apply these operators to the two-step time-marching scheme. Let $\\hat{u}^n$ represent the Fourier amplitude of the solution at time level $n$.\nStep A is an explicit Euler half-step for the $x$-diffusion:\n$$\nw^{n+\\frac{1}{2}} = u^{n} + \\frac{\\Delta t}{2}\\kappa_{x}L_{x} u^{n}\n$$\nIn Fourier space, this becomes:\n$$\n\\hat{w}^{n+\\frac{1}{2}} = \\left(1 + \\frac{\\Delta t}{2}\\kappa_{x}\\hat{L}_x(\\theta_x)\\right) \\hat{u}^{n}\n$$\nStep B is an implicit Euler half-step for the $y$-diffusion:\n$$\n\\left(I - \\frac{\\Delta t}{2}\\kappa_{y}L_{y}\\right)u^{n+1} = w^{n+\\frac{1}{2}}\n$$\nIn Fourier space, this is:\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\kappa_{y}\\hat{L}_y(\\theta_y)\\right)\\hat{u}^{n+1} = \\hat{w}^{n+\\frac{1}{2}}\n$$\nCombining these two steps, we eliminate $\\hat{w}^{n+\\frac{1}{2}}$ to find the relationship between $\\hat{u}^{n+1}$ and $\\hat{u}^{n}$:\n$$\n\\left(1 - \\frac{\\Delta t}{2}\\kappa_{y}\\hat{L}_y(\\theta_y)\\right)\\hat{u}^{n+1} = \\left(1 + \\frac{\\Delta t}{2}\\kappa_{x}\\hat{L}_x(\\theta_x)\\right) \\hat{u}^{n}\n$$\nThe amplification factor $g = \\hat{u}^{n+1}/\\hat{u}^{n}$ is therefore:\n$$\ng(\\theta_x, \\theta_y) = \\frac{1 + \\frac{\\Delta t}{2}\\kappa_{x}\\hat{L}_x(\\theta_x)}{1 - \\frac{\\Delta t}{2}\\kappa_{y}\\hat{L}_y(\\theta_y)}\n$$\nSubstituting the expressions for the symbols $\\hat{L}_x$ and $\\hat{L}_y$:\n$$\ng(\\theta_x, \\theta_y) = \\frac{1 - \\frac{\\Delta t}{2}\\kappa_{x}\\frac{4}{h_x^2}\\sin^2(\\frac{\\theta_x}{2})}{1 + \\frac{\\Delta t}{2}\\kappa_{y}\\frac{4}{h_y^2}\\sin^2(\\frac{\\theta_y}{2})} = \\frac{1 - \\frac{2\\Delta t \\kappa_x}{h_x^2}\\sin^2(\\frac{\\theta_x}{2})}{1 + \\frac{2\\Delta t \\kappa_y}{h_y^2}\\sin^2(\\frac{\\theta_y}{2})}\n$$\nLet us define two non-negative quantities, $A$ and $B$, for notational clarity:\n$$\nA = \\frac{2\\Delta t \\kappa_x}{h_x^2}\\sin^2\\left(\\frac{\\theta_x}{2}\\right) \\geq 0\n$$\n$$\nB = \\frac{2\\Delta t \\kappa_y}{h_y^2}\\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\geq 0\n$$\nThe amplification factor is then $g = \\frac{1 - A}{1 + B}$. The stability condition is $|g| \\leq 1$.\n$$\n\\left|\\frac{1 - A}{1 + B}\\right| \\leq 1\n$$\nSince $B \\geq 0$, the denominator $1+B$ is strictly positive. Thus we can multiply by it:\n$$\n|1 - A| \\leq 1 + B\n$$\nThis single inequality is equivalent to two separate ones:\n$1)$ $(1 - A) \\leq (1 + B) \\implies -A \\leq B \\implies A+B \\ge 0$. This condition is always satisfied, as $A \\geq 0$ and $B \\geq 0$.\n$2)$ $-(1 + B) \\leq (1 - A) \\implies -1 - B \\leq 1 - A \\implies A - B \\leq 2$.\n\nThis second inequality, $A-B \\leq 2$, is the necessary condition for stability. It must hold for all possible Fourier modes, i.e., for all $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$. Substituting back the expressions for $A$ and $B$:\n$$\n\\frac{2\\Delta t \\kappa_x}{h_x^2}\\sin^2\\left(\\frac{\\theta_x}{2}\\right) - \\frac{2\\Delta t \\kappa_y}{h_y^2}\\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\leq 2\n$$\nFactoring out $\\Delta t$:\n$$\n\\Delta t \\left( \\frac{2\\kappa_x}{h_x^2}\\sin^2\\left(\\frac{\\theta_x}{2}\\right) - \\frac{2\\kappa_y}{h_y^2}\\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right) \\leq 2\n$$\nTo find the most restrictive condition on $\\Delta t$, we must find the maximum possible value of the expression in the parenthesis over all $\\theta_x$ and $\\theta_y$. The term $\\sin^2(\\theta/2)$ ranges from $0$ to $1$. The expression is maximized when the positive term is maximized and the negative term is minimized. This occurs when:\n$$\n\\sin^2\\left(\\frac{\\theta_x}{2}\\right) = 1 \\quad (\\text{e.g., for } \\theta_x = \\pi)\n$$\n$$\n\\sin^2\\left(\\frac{\\theta_y}{2}\\right) = 0 \\quad (\\text{for } \\theta_y = 0)\n$$\nThe maximum value of the parenthetical expression is:\n$$\n\\max_{\\theta_x, \\theta_y} \\left( \\frac{2\\kappa_x}{h_x^2}\\sin^2\\left(\\frac{\\theta_x}{2}\\right) - \\frac{2\\kappa_y}{h_y^2}\\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right) = \\frac{2\\kappa_x}{h_x^2}(1) - \\frac{2\\kappa_y}{h_y^2}(0) = \\frac{2\\kappa_x}{h_x^2}\n$$\nThe stability condition thus simplifies to:\n$$\n\\Delta t \\left( \\frac{2\\kappa_x}{h_x^2} \\right) \\leq 2\n$$\nSolving for $\\Delta t$:\n$$\n\\Delta t \\leq \\frac{h_x^2}{\\kappa_x}\n$$\nThe largest allowable time step, $\\Delta t_{\\max}$, is the upper bound of this inequality. This result depends only on $\\kappa_x$ and $h_x$, as stipulated by the problem. The stability of this scheme is dictated solely by its explicit part, which is consistent with the analysis of such methods. The implicit treatment of the $y$-direction does not alleviate the stability constraint imposed by the explicit treatment of the $x$-direction.", "answer": "$$\\boxed{\\frac{h_{x}^{2}}{\\kappa_{x}}}$$", "id": "3427455"}, {"introduction": "Ensuring a numerical solver is free of bugs and performs as expected is a critical task in computational science. This practice introduces the Method of Manufactured Solutions (MMS), a powerful verification technique where a known solution is prescribed to derive a source term. You will apply this method to an anisotropic diffusion problem, providing a rigorous way to confirm your implementation's correctness and its theoretical order of accuracy. [@problem_id:3427454]", "problem": "Consider the linear anisotropic diffusion equation in two spatial dimensions on the unit square $\\Omega=(0,1)\\times(0,1)$ with homogeneous Dirichlet boundary condition and a smooth source term:\n$$\nu_{t} = a\\,u_{xx} + b\\,u_{yy} + f(x,y,t), \\quad (x,y)\\in\\Omega,\\ t0,\n$$\n$$\nu(x,y,t)=0 \\text{ for } (x,y)\\in\\partial\\Omega,\\ t\\ge 0,\n$$\nand initial condition\n$$\nu(x,y,0) = \\sin(\\pi x)\\sin(2\\pi y).\n$$\nLet the anisotropy coefficients be $a=1$ and $b=4$. You will use the method of manufactured solutions by prescribing the exact solution\n$$\nu(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y),\n$$\nand determining the forcing term $f(x,y,t)$ so that $u$ satisfies the partial differential equation and boundary and initial conditions exactly.\n\nIn addition, consider advancing the solution in time by a Strang alternating direction implicit (ADI) operator splitting that treats $a\\,u_{xx}$ and $b\\,u_{yy}$ as the split operators. Assume all spatial discretizations are of sufficiently high order so that the temporal accuracy dominates, and assume the exact solution is smooth enough to justify the formal temporal order. State the expected theoretical temporal order of accuracy $r$ for the Strang-ADI time discretization in this linear setting.\n\nReport your final answer as a two-entry row vector, whose first entry is the closed-form analytic expression for $f(x,y,t)$, and whose second entry is the integer temporal order $r$. No rounding is required and no units are involved.", "solution": "The problem consists of two parts. The first part is to determine the forcing term $f(x,y,t)$ for a given partial differential equation (PDE) and a prescribed \"manufactured\" solution $u(x,y,t)$. The second part is to state the theoretical temporal order of accuracy for the Strang alternating direction implicit (ADI) method applied to this PDE.\n\nFirst, I will validate the problem statement.\nAll givens are extracted and checked for consistency.\nThe PDE is $u_{t} = a\\,u_{xx} + b\\,u_{yy} + f(x,y,t)$, with $a=1$ and $b=4$.\nThe domain is $\\Omega=(0,1)\\times(0,1)$ with homogeneous Dirichlet boundary conditions $u(x,y,t)=0$ for $(x,y)\\in\\partial\\Omega$.\nThe initial condition is $u(x,y,0) = \\sin(\\pi x)\\sin(2\\pi y)$.\nThe prescribed solution is $u(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$.\nLet's check consistency.\nAt $t=0$, the prescribed solution is $u(x,y,0) = \\exp(-0)\\,\\sin(\\pi x)\\,\\sin(2\\pi y) = \\sin(\\pi x)\\sin(2\\pi y)$, which matches the initial condition.\nOn the boundaries of $\\Omega$:\nAt $x=0$: $u(0,y,t) = \\exp(-t)\\,\\sin(0)\\,\\sin(2\\pi y) = 0$.\nAt $x=1$: $u(1,y,t) = \\exp(-t)\\,\\sin(\\pi)\\,\\sin(2\\pi y) = 0$.\nAt $y=0$: $u(x,0,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(0) = 0$.\nAt $y=1$: $u(x,1,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi) = 0$.\nAll boundary and initial conditions are satisfied by the prescribed solution. The problem is scientifically grounded, well-posed, and contains no contradictions or ambiguities. The problem is valid.\n\nPart 1: Determination of the forcing term $f(x,y,t)$.\nThe forcing term $f(x,y,t)$ can be isolated from the PDE:\n$$\nf(x,y,t) = u_t - a\\,u_{xx} - b\\,u_{yy}\n$$\nWe need to compute the partial derivatives of the prescribed solution $u(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$.\n\nThe partial derivative with respect to time $t$ is:\n$$\nu_t = \\frac{\\partial}{\\partial t}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = -\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nThe first and second partial derivatives with respect to $x$ are:\n$$\nu_x = \\frac{\\partial}{\\partial x}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = \\pi\\exp(-t)\\,\\cos(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nu_{xx} = \\frac{\\partial}{\\partial x}\\left(\\pi\\exp(-t)\\,\\cos(\\pi x)\\,\\sin(2\\pi y)\\right) = -\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nThe first and second partial derivatives with respect to $y$ are:\n$$\nu_y = \\frac{\\partial}{\\partial y}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = 2\\pi\\exp(-t)\\,\\sin(\\pi x)\\,\\cos(2\\pi y)\n$$\n$$\nu_{yy} = \\frac{\\partial}{\\partial y}\\left(2\\pi\\exp(-t)\\,\\sin(\\pi x)\\,\\cos(2\\pi y)\\right) = -4\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nNow, substitute these derivatives along with the coefficients $a=1$ and $b=4$ into the expression for $f(x,y,t)$:\n$$\nf(x,y,t) = \\left(-\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) - (1)\\left(-\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) - (4)\\left(-4\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right)\n$$\nWe can factor out the common term $\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$:\n$$\nf(x,y,t) = \\left(-1 - (-\\pi^2) - 4(-4\\pi^2)\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nf(x,y,t) = \\left(-1 + \\pi^2 + 16\\pi^2\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nf(x,y,t) = \\left(17\\pi^2 - 1\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nThis is the closed-form analytic expression for the forcing term.\n\nPart 2: Temporal order of accuracy $r$ for Strang-ADI.\nThe given PDE is of the form $u_t = \\mathcal{L}u + f$, where the linear operator $\\mathcal{L}$ is split into two parts, $\\mathcal{L} = \\mathcal{L}_x + \\mathcal{L}_y$, with $\\mathcal{L}_x = a\\frac{\\partial^2}{\\partial x^2}$ and $\\mathcal{L}_y = b\\frac{\\partial^2}{\\partial y^2}$.\n\nOperator splitting methods approximate the solution to the full equation by solving a sequence of simpler subproblems. Strang splitting is a symmetric composition of steps, which for a time step of size $\\Delta t$ can be written as:\n$$\nu^{n+1} \\approx \\mathcal{S}_x(\\Delta t/2) \\mathcal{S}_y(\\Delta t) \\mathcal{S}_x(\\Delta t/2) u^n\n$$\nwhere $\\mathcal{S}_x(\\tau)$ and $\\mathcal{S}_y(\\tau)$ are the evolution operators for the subproblems $u_t = \\mathcal{L}_x u$ and $u_t = \\mathcal{L}_y u$ over a time interval $\\tau$.\n\nThis symmetric composition ensures that the method is second-order accurate in time, provided the individual propagators $\\mathcal{S}_x$ and $\\mathcal{S}_y$ are at least first-order accurate. In the context of ADI methods, each sub-step is typically solved using the Crank-Nicolson method, which is itself second-order accurate. The Crank-Nicolson propagator for a step of size $\\tau$ is an approximation to the exact exponential operator, with an error of order $O(\\tau^3)$.\n$$\n\\mathcal{S}_{\\text{CN}}(\\tau) = \\exp(\\tau \\mathcal{L}) + O(\\tau^3)\n$$\nThe local truncation error of the Strang splitting composition can be found by Taylor series expansion of the operator exponentials. The composition $\\exp(\\Delta t/2 A) \\exp(\\Delta t B) \\exp(\\Delta t/2 A)$ matches the expansion of $\\exp(\\Delta t(A+B))$ up to terms of order $(\\Delta t)^2$. The first error term is of order $(\\Delta t)^3$, related to the commutators of the operators $A$ and $B$. Thus, the local truncation error of the Strang splitting method is $O((\\Delta t)^3)$.\n\nFor a numerical method with a local truncation error of order $p+1$, the global error is of order $p$. Therefore, with a local truncation error of $O((\\Delta t)^3)$, the global temporal order of accuracy for the Strang splitting method is $2$.\nThis holds in general for linear problems, regardless of whether the operators $\\mathcal{L}_x$ and $\\mathcal{L}_y$ commute. In this specific problem, since the operators consist of partial derivatives with respect to different independent variables (and constant coefficients), they do commute: $\\mathcal{L}_x\\mathcal{L}_y u = \\mathcal{L}_y\\mathcal{L}_x u$ for sufficiently smooth $u$. This commutativity simplifies the analysis and confirms the second-order accuracy, but it is not a requirement for Strang splitting to be second-order.\n\nThe expected theoretical temporal order of accuracy $r$ is therefore $2$.\n\nThe final answer consists of two parts: the expression for $f(x,y,t)$ and the integer value of $r$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(17\\pi^2 - 1)\\exp(-t)\\sin(\\pi x)\\sin(2\\pi y)  2\n\\end{pmatrix}\n}\n$$", "id": "3427454"}, {"introduction": "While von Neumann stability is a necessary condition for a usable scheme, it does not guarantee the preservation of all physically relevant properties. This practice explores the more subtle Discrete Maximum Principle for the popular Peaceman-Rachford ADI scheme, which is unconditionally stable. By analyzing the amplification factor, you will determine the conditions under which this scheme can introduce non-physical oscillations, demonstrating that unconditional stability alone is not always sufficient. [@problem_id:3427476]", "problem": "Consider the two-dimensional heat equation (diffusion equation) on a periodic square domain with uniform grid spacing $h$ in both spatial directions,\n$$\nu_{t} = \\kappa \\left(u_{xx} + u_{yy}\\right),\n$$\nwhere $\\kappa  0$ is the constant diffusivity. Let the spatial discretization be the standard second-order centered finite difference Laplacian on a uniform Cartesian grid with periodic boundary conditions, and apply the Peaceman–Rachford (PR) Alternating Direction Implicit (ADI) splitting based on the Crank–Nicolson (CN) time discretization:\n$$\n\\left(I - \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I - \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n+1}\n=\n\\left(I + \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I + \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n},\n$$\nwhere $D_{x}$ and $D_{y}$ denote the discrete second-difference operators in $x$ and $y$, respectively, and $I$ denotes the identity operator. The discrete maximum principle is the property that if the grid function $u^{n}$ is elementwise nonnegative, then $u^{n+1}$ is also elementwise nonnegative.\n\nStarting from the definitions of the discrete operators and the Fourier diagonalization of convolution operators on the periodic grid, analytically derive the one-step amplification factor of the above PR–CN scheme for a discrete Fourier mode with wavenumbers $(\\theta_{x},\\theta_{y})$. Using only these fundamental facts, construct a scientifically sound scenario in which the discrete maximum principle fails for sufficiently large time step $\\Delta t$: specifically, identify a threshold time step $\\Delta t_{\\mathrm{th}}$ as a closed-form expression in terms of the grid spacing $h$ and the diffusivity $\\kappa$ such that for $\\Delta t  \\Delta t_{\\mathrm{th}}$ there exist nonnegative initial data for which the PR–CN update produces a negative value at some grid point.\n\nYour final answer must be the single analytic expression for $\\Delta t_{\\mathrm{th}}$ in terms of $h$ and $\\kappa$. No rounding is required.", "solution": "The problem requires the derivation of the threshold time step, $\\Delta t_{\\mathrm{th}}$, for which the Peaceman–Rachford (PR) Alternating Direction Implicit (ADI) scheme for the two-dimensional heat equation violates the discrete maximum principle. The analysis will proceed by first deriving the one-step amplification factor of the numerical scheme using discrete Fourier analysis and then determining the conditions under which this factor becomes negative, which is a necessary condition for the violation of the maximum principle.\n\nThe two-dimensional heat equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\nwhere $\\kappa  0$ is the diffusivity. We consider a uniform Cartesian grid with spacing $h$ in both directions. The standard second-order centered finite difference approximations for the second partial derivatives are given by the operators $D_x$ and $D_y$:\n$$\n(D_x u)_{j,k} = \\frac{u_{j+1,k} - 2u_{j,k} + u_{j-1,k}}{h^2}\n$$\n$$\n(D_y u)_{j,k} = \\frac{u_{j,k+1} - 2u_{j,k} + u_{j,k-1}}{h^2}\n$$\nThe PR–ADI-CN scheme is given as:\n$$\n\\left(I - \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I - \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n+1} = \\left(I + \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I + \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n}\n$$\n\nTo find the one-step amplification factor, we perform a von Neumann stability analysis. Due to the periodic boundary conditions, the eigenfunctions of the discrete operators $D_x$ and $D_y$ are the discrete Fourier modes. A generic Fourier mode is of the form $u^n_{j,k} = (G(\\theta_x, \\theta_y))^n \\exp(i(j\\theta_x + k\\theta_y))$, where $(\\theta_x, \\theta_y)$ are the dimensionless wavenumbers corresponding to the spatial frequencies and $G$ is the amplification factor.\n\nLet's find the eigenvalues of $D_x$ and $D_y$ corresponding to this mode. Applying $D_x$ to the spatial part $\\exp(i(j\\theta_x + k\\theta_y))$ yields:\n$$\nD_x \\exp(i(j\\theta_x + k\\theta_y)) = \\frac{\\exp(i((j+1)\\theta_x+k\\theta_y)) - 2\\exp(i(j\\theta_x+k\\theta_y)) + \\exp(i((j-1)\\theta_x+k\\theta_y))}{h^2}\n$$\n$$\n= \\frac{\\exp(i(j\\theta_x+k\\theta_y)) (\\exp(i\\theta_x) - 2 + \\exp(-i\\theta_x))}{h^2} = \\frac{2(\\cos(\\theta_x) - 1)}{h^2} \\exp(i(j\\theta_x+k\\theta_y))\n$$\nUsing the half-angle identity $1-\\cos(\\theta_x) = 2\\sin^2(\\theta_x/2)$, the eigenvalue of $D_x$, denoted $\\hat{D}_x$, is:\n$$\n\\hat{D}_x(\\theta_x) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_x}{2}\\right)\n$$\nSimilarly, the eigenvalue of $D_y$ is:\n$$\n\\hat{D}_y(\\theta_y) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_y}{2}\\right)\n$$\nThe dimensionless wavenumbers $\\theta_x$ and $\\theta_y$ range over $[-\\pi, \\pi]$. Consequently, $\\sin^2(\\theta_x/2)$ and $\\sin^2(\\theta_y/2)$ range over $[0, 1]$.\n\nSubstituting the mode $u^{n+1} = G u^n$ into the scheme and replacing the operators with their eigenvalues, we obtain an equation for the amplification factor $G$:\n$$\n\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right) G = \\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)\n$$\nSolving for $G(\\theta_x, \\theta_y)$:\n$$\nG(\\theta_x, \\theta_y) = \\frac{\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)}{\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)}\n$$\nSubstituting the expressions for the eigenvalues:\n$$\nG(\\theta_x, \\theta_y) = \\frac{\\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)}{\\left(1 + \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 + \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)}\n$$\nThe discrete maximum principle (DMP) states that if $u^n_{j,k} \\ge 0$ for all grid points $(j,k)$, then $u^{n+1}_{j,k} \\ge 0$ as well. A necessary condition for a linear, constant-coefficient scheme to satisfy the DMP is that its amplification factor must be non-negative for all wavenumbers, i.e., $G(\\theta_x, \\theta_y) \\ge 0$. If $G  0$ for some mode, one can construct a non-negative initial condition (e.g., by adding a sufficiently large constant) that evolves to have negative values, thus violating the DMP.\n\nWe analyze the sign of $G(\\theta_x, \\theta_y)$. The denominator is a product of two terms of the form $(1 + C)$ where $C = \\frac{2\\kappa \\Delta t}{h^2} \\sin^2(\\cdot)$ is always non-negative. Thus, the denominator is always positive (and greater than or equal to $1$). The sign of $G$ is determined solely by the sign of its numerator.\nLet $N(\\theta_x, \\theta_y)$ be the numerator:\n$$\nN(\\theta_x, \\theta_y) = \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)\n$$\nFor $G$ to be negative, the numerator must be negative. This occurs if one of the two factors in $N$ is positive and the other is negative.\n\nLet's define the dimensionless parameter $r = \\frac{2\\kappa \\Delta t}{h^2}$. Let $S_x = \\sin^2(\\theta_x/2)$ and $S_y = \\sin^2(\\theta_y/2)$. The factors are $(1 - rS_x)$ and $(1 - rS_y)$. The variables $S_x$ and $S_y$ can take any value in the interval $[0, 1]$ by choosing appropriate wavenumbers $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$.\n\nThe DMP will fail if we can find $(\\theta_x, \\theta_y)$ such that, for instance, $(1 - rS_x)  0$ and $(1 - rS_y)  0$.\nThe condition $1 - rS_x  0$ implies $rS_x  1$.\nThe condition $1 - rS_y  0$ implies $rS_y  1$.\n\nFor the DMP to potentially fail, there must exist a mode $\\theta_x$ such that $rS_x  1$. Since the maximum value of $S_x$ is $1$ (for $\\theta_x = \\pi$), this inequality can only be satisfied if $r  1$.\nIf $r  1$, we can choose a high-frequency mode in the $x$-direction, say $\\theta_x = \\pi$, for which $S_x = \\sin^2(\\pi/2) = 1$. For this mode, the factor is $(1 - r)  0$.\nSimultaneously, we can choose a low-frequency mode in the $y$-direction, say $\\theta_y = 0$, for which $S_y = \\sin^2(0) = 0$. For this mode, the factor is $(1 - 0) = 1  0$.\nWith this choice of wavenumbers $(\\theta_x, \\theta_y) = (\\pi, 0)$, the numerator is $N = (1-r)(1)  0$, and thus the amplification factor $G$ is negative. This demonstrates that the DMP is violated for $r1$.\n\nIf $r \\le 1$, then for any mode $\\theta_x$, we have $rS_x \\le 1 \\cdot S_x \\le 1$. Therefore, the factor $(1 - rS_x)$ is always non-negative. The same holds for the $y$-direction factor. The product of two non-negative numbers is non-negative, so $N(\\theta_x, \\theta_y) \\ge 0$ for all modes. In this case, this necessary condition for the DMP is satisfied.\n\nThe threshold for failure of the discrete maximum principle occurs precisely at the boundary of the condition $r1$. The threshold value is $r=1$.\nSubstituting back the definition of $r$:\n$$\n\\frac{2\\kappa \\Delta t}{h^2} = 1\n$$\nSolving for the threshold time step, $\\Delta t_{\\mathrm{th}}$:\n$$\n\\Delta t_{\\mathrm{th}} = \\frac{h^2}{2\\kappa}\n$$\nFor any time step $\\Delta t  \\Delta t_{\\mathrm{th}}$, there exist Fourier modes for which the amplification factor is negative, creating a scenario where a non-negative initial condition can evolve to have negative values, thereby violating the discrete maximum principle.", "answer": "$$\\boxed{\\frac{h^{2}}{2\\kappa}}$$", "id": "3427476"}]}