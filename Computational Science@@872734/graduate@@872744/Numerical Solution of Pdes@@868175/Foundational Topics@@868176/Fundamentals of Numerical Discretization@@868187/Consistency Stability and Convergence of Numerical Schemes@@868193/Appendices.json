{"hands_on_practices": [{"introduction": "A numerical scheme is an approximation of a continuous partial differential equation (PDE). To better understand a scheme's behavior, we can ask: what modified continuous equation does our discrete scheme *actually* solve? This practice introduces the powerful technique of deriving the \"modified equation,\" which uses Taylor series expansions to reveal the subtle error terms a scheme introduces, helping us classify them as either dissipative (smearing out waves) or dispersive (causing oscillations). Mastering this analysis is fundamental to understanding a scheme's accuracy and predicting its performance on real problems [@problem_id:3373281].", "problem": "Consider the constant-coefficient linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with $a \\in \\mathbb{R}$, $a \\neq 0$, posed on a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$. Let $u^{n}_{j}$ denote the numerical approximation to $u(x_{j}, t^{n})$ with $x_{j} = j \\,\\Delta x$ and $t^{n} = n\\,\\Delta t$. The two-step Taylor-based Lax–Wendroff scheme for this PDE updates $u^{n}_{j}$ by\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\nUsing only the fundamental definitions of consistency via Taylor expansion and the notion of a modified equation (an equivalent continuous PDE whose smooth solutions agree with the scheme up to a specified order), derive the modified equation satisfied by a smooth function $u(x,t)$ up to and including the lowest-order nonvanishing even- and odd-derivative correction terms beyond $u_{t}+a\\,u_{x}$. Express your result in the normalized form\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{higher-order terms},\n$$\nwhere the coefficients $\\alpha_{2}$ and $\\alpha_{3}$ depend on $a$, $\\Delta t$, and $\\Delta x$. Identify which of these terms are dissipative (even derivatives) and which are dispersive (odd derivatives), and determine $\\alpha_{2}$ and $\\alpha_{3}$ explicitly. You may introduce the Courant number $r = a\\,\\Delta t/\\Delta x$ provided your final expressions for $\\alpha_{2}$ and $\\alpha_{3}$ are quantified in terms of $a$, $\\Delta t$, and $\\Delta x$.\n\nReport, as your final answer, the row matrix containing $\\alpha_{2}$ and $\\alpha_{3}$ in that order. No numerical evaluation is required.", "solution": "The problem requires the derivation of the modified equation for the two-step Lax-Wendroff scheme applied to the linear advection equation $u_t + a u_x = 0$. The objective is to find the coefficients $\\alpha_2$ and $\\alpha_3$ in the normalized form of the modified equation:\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{higher-order terms}.\n$$\nThe derivation proceeds by performing a Taylor series expansion of each term in the numerical scheme around the point $(x_j, t_n)$, assuming that the numerical solution $u^n_j$ corresponds to a smooth function $u(x,t)$ at that point.\n\nThe given Lax-Wendroff scheme is:\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\nTo facilitate the analysis, we rearrange the scheme by dividing by $\\Delta t$:\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} \\;=\\; -\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\nWe now expand each term as a Taylor series around $(x_j, t_n)$, where $u$ and its derivatives are evaluated.\n\nThe left-hand side (LHS) is the forward difference approximation for the time derivative:\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\mathcal{O}(\\Delta t^3).\n$$\nThe right-hand side (RHS) consists of two terms involving spatial differences. The first term is the central difference approximation for $u_x$:\n$$\n-\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr) = -\\frac{a}{2\\,\\Delta x} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) - \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) \\right]\n$$\n$$\n= -\\frac{a}{2\\,\\Delta x} \\left( 2\\Delta x u_x + \\frac{\\Delta x^3}{3}u_{xxx} + \\dots \\right) = -a u_x - \\frac{a \\Delta x^2}{6}u_{xxx} + \\mathcal{O}(\\Delta x^4).\n$$\nThe second term on the RHS is the central difference approximation for $u_{xx}$:\n$$\n\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr) = \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\dots \\right) - 2u + \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\dots \\right) \\right]\n$$\n$$\n= \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left( \\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12}u_{xxxx} + \\dots \\right) = \\frac{a^2 \\Delta t}{2}u_{xx} + \\frac{a^2 \\Delta t \\Delta x^2}{24}u_{xxxx} + \\mathcal{O}(\\Delta t \\Delta x^4).\n$$\nEquating the expanded LHS and RHS gives the expression for the local truncation error:\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\dots = -a u_x + \\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{a \\Delta x^2}{6}u_{xxx} + \\dots\n$$\nRearranging to match the form of the original PDE, we get:\n$$\nu_t + a u_x = \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}u_{tt}\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}u_{ttt} + \\text{h.o.t.}\n$$\nTo obtain the modified equation, we must express all time derivatives on the RHS in terms of spatial derivatives. This is done by repeatedly differentiating the modified equation itself. To the lowest order, the modified equation is $u_t = -a u_x$. We use this to substitute for higher time derivatives.\nThe operator relationship is $\\frac{\\partial}{\\partial t} \\approx -a \\frac{\\partial}{\\partial x}$.\nApplying this to $u_{tt}$ and $u_{ttt}$:\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} u_t \\approx (-a\\frac{\\partial}{\\partial x})(-a u_x) = a^2 u_{xx}.\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t} u_{tt} \\approx (-a\\frac{\\partial}{\\partial x})(a^2 u_{xx}) = -a^3 u_{xxx}.\n$$\nSubstituting these approximations back into the equation for $u_t+au_x$:\n$$\nu_t + a u_x \\approx \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}(a^2 u_{xx})\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}(-a^3 u_{xxx}).\n$$\nWe group terms by the order of the spatial derivative:\nThe coefficient of the second derivative term, $u_{xx}$, is:\n$$\n\\frac{a^2 \\Delta t}{2} - \\frac{a^2 \\Delta t}{2} = 0.\n$$\nThe coefficient of the third derivative term, $u_{xxx}$, is:\n$$\n-\\frac{a \\Delta x^2}{6} - \\frac{\\Delta t^2(-a^3)}{6} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\nThus, the modified equation up to the third-order derivative term is:\n$$\nu_t + a u_x = \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) u_{xxx} + \\text{h.o.t.}\n$$\nThis equation reveals the nature of the leading-order error. The even-derivative term ($u_{xx}$), which corresponds to numerical dissipation, has a zero coefficient. The odd-derivative term ($u_{xxx}$), which corresponds to numerical dispersion, has a non-zero coefficient (unless the Courant number $r = a\\Delta t / \\Delta x$ has magnitude $1$). This indicates the scheme is dispersive. The lowest-order non-vanishing even-derivative term is of fourth order ($u_{xxxx}$), which ensures the scheme is dissipative for $|r|<1$.\n\nWe now match our result to the specified normalized form:\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{h.o.t.}\n$$\nBy comparing the coefficients, we find $\\alpha_2$ and $\\alpha_3$.\nFor the $u_{xx}$ term:\n$$\n\\Delta x\\,\\alpha_{2} = 0 \\quad \\implies \\quad \\alpha_{2} = 0.\n$$\nFor the $u_{xxx}$ term:\n$$\n\\Delta x^{2}\\,\\alpha_{3} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\nSolving for $\\alpha_3$:\n$$\n\\alpha_{3} = \\frac{1}{\\Delta x^2} \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) = -\\frac{a}{6} + \\frac{a^3 \\Delta t^2}{6 \\Delta x^2}.\n$$\nThe coefficients are thus determined. $\\alpha_2$ is zero, indicating an absence of second-order numerical dissipation. $\\alpha_3$ is non-zero in general, indicating the presence of third-order numerical dispersion.\n\nFinal expressions for the coefficients are:\n$\\alpha_2 = 0$.\n$\\alpha_3 = \\frac{a^3 \\Delta t^2}{6 \\Delta x^2} - \\frac{a}{6}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{a^{3} \\Delta t^{2}}{6 \\Delta x^{2}} - \\frac{a}{6}\n\\end{pmatrix}\n}\n$$", "id": "3373281"}, {"introduction": "A consistent scheme is useless if its numerical errors grow without bound, a phenomenon known as instability. This concept places crucial constraints on the time step $\\Delta t$ relative to the grid spacing $h$, famously known as the Courant-Friedrichs-Lewy (CFL) condition. This exercise provides hands-on practice in determining the stability limit for a widely used Discontinuous Galerkin scheme by analyzing the eigenvalues of its spatial operator, a technique with broad applications across numerical methods [@problem_id:3373451].", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ on a periodic domain, where $a>0$ is constant. Discretize in space using a Discontinuous Galerkin (DG) method of polynomial degree $p=0$ with an upwind numerical flux on a uniform mesh with element size $h$. This semi-discrete method is equivalent to the standard upwind finite volume scheme. Advance in time using the forward Euler method.\n\nDefinitions and facts you may assume as a starting point:\n- The Discontinuous Galerkin (DG) semi-discrete formulation with $p=0$ for this problem (with upwind flux) yields the elementwise system $\\frac{\\mathrm{d}}{\\mathrm{d}t} u_{j}(t) = -\\frac{a}{h}\\left(u_{j}(t) - u_{j-1}(t)\\right)$ for the cell averages $\\{u_{j}\\}$.\n- A von Neumann analysis for a spatially uniform, periodic discretization employs the Fourier ansatz $u_{j}(t)=\\widehat{u}(t)\\,\\exp(\\mathrm{i} j \\theta)$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional wavenumber.\n- The Courant–Friedrichs–Lewy (CFL) number is defined by $\\text{CFL} \\equiv a\\,\\Delta t / h$ for time step $\\Delta t$.\n- The forward Euler amplification factor for a mode with semi-discrete eigenvalue $\\lambda$ is $1 + \\Delta t\\,\\lambda$, and the forward Euler linear stability region is the closed disk $\\{z \\in \\mathbb{C} : |1+z|\\leq 1\\}$.\n\nTask:\n1. Using only the above fundamental definitions and facts, derive a practical CFL estimate based on a bounded spectrum inclusion for the semi-discrete operator’s eigenvalues for $p=0$. In other words, bound the semi-discrete spectrum by a simple geometric set in the complex plane and impose that its forward Euler image lies within the forward Euler stability disk, to obtain a sufficient condition on $\\text{CFL}$.\n2. Independently perform a von Neumann analysis to obtain the empirical forward Euler stability limit (the largest $\\text{CFL}$ for which all Fourier modes are stable).\n3. Compute the ratio $\\mathcal{R}$ of the spectrum-bound-based practical estimate to the von Neumann empirical limit for $p=0$.\n\nYour final answer must be the single real number $\\mathcal{R}$, written in exact form (no rounding is needed). Express $\\mathcal{R}$ without any units.", "solution": "The user wants to analyze the stability of a numerical scheme for the one-dimensional linear advection equation. The analysis is to be performed using two different methods, and the ratio of the resulting stability limits is required.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n- **Equation:** $u_{t} + a\\,u_{x} = 0$, with $a>0$ constant, on a periodic domain.\n- **Spatial Discretization:** Discontinuous Galerkin (DG) method with polynomial degree $p=0$ and an upwind numerical flux on a uniform mesh with element size $h$.\n- **Semi-discrete Formulation:** $\\frac{\\mathrm{d}}{\\mathrm{d}t} u_{j}(t) = -\\frac{a}{h}\\left(u_{j}(t) - u_{j-1}(t)\\right)$ for the cell averages $\\{u_{j}\\}$. This is the system $\\frac{\\mathrm{d}\\vec{u}}{\\mathrm{d}t} = L\\vec{u}$, where $L$ is the semi-discrete operator.\n- **Temporal Discretization:** Forward Euler method.\n- **Von Neumann Ansatz:** $u_{j}(t)=\\widehat{u}(t)\\,\\exp(\\mathrm{i} j \\theta)$, where $\\theta \\in [-\\pi,\\pi]$.\n- **CFL Definition:** $\\text{CFL} \\equiv \\nu = a\\,\\Delta t / h$ for time step $\\Delta t$.\n- **Forward Euler Stability Region:** The set $S_{FE} = \\{z \\in \\mathbb{C} : |1+z|\\leq 1\\}$, where $z = \\Delta t \\lambda$ and $\\lambda$ is an eigenvalue of the semi-discrete operator $L$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding:** The problem is firmly grounded in the standard theory of numerical analysis for partial differential equations, specifically concerning the stability of finite difference/finite volume methods.\n- **Well-Posed:** The problem is clearly stated, with all necessary definitions provided. The tasks are specific and lead to a unique numerical answer.\n- **Objective:** The problem is phrased in precise, objective mathematical language.\n- The problem is self-contained, consistent, and does not violate any scientific principles. The provided semi-discrete formulation is correct for the specified DG-P0/upwind finite volume scheme. The definitions are standard.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution will proceed.\n\n### Task 1: Spectrum-Bound-Based CFL Estimate\n\nThe goal is to find a sufficient condition on the CFL number, $\\nu$, by bounding the spectrum of the semi-discrete operator $L$ and ensuring its scaled image under the time-stepping map lies within the stability region of the forward Euler method.\n\nThe semi-discrete system for the cell averages $\\{u_j\\}_{j=1}^N$ on a periodic domain is $\\frac{\\mathrm{d}u_j}{\\mathrm{d}t} = \\frac{a}{h}(u_{j-1} - u_j)$. This can be written in matrix form $\\frac{\\mathrm{d}\\vec{u}}{\\mathrm{d}t} = L\\vec{u}$, where $L$ is a circulant matrix.\nThe eigenvalues $\\lambda$ of the operator $L$ can be found by substituting the Fourier mode $u_j(t) = \\widehat{u}(t)\\exp(\\mathrm{i} j \\theta)$ into the semi-discrete equation:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}(\\widehat{u}(t)\\exp(\\mathrm{i} j \\theta)) = -\\frac{a}{h}\\left(\\widehat{u}(t)\\exp(\\mathrm{i} j \\theta) - \\widehat{u}(t)\\exp(\\mathrm{i} (j-1) \\theta)\\right)\n$$\nDifferentiating the left side with respect to $t$ and factoring out common terms yields:\n$$\n\\exp(\\mathrm{i} j \\theta)\\frac{\\mathrm{d}\\widehat{u}}{\\mathrm{d}t} = -\\frac{a}{h}\\widehat{u}(t)\\exp(\\mathrm{i} j \\theta) (1 - \\exp(-\\mathrm{i}\\theta))\n$$\nThis gives an ordinary differential equation for the modal amplitude $\\widehat{u}(t)$, $\\frac{\\mathrm{d}\\widehat{u}}{\\mathrm{d}t} = \\lambda(\\theta)\\widehat{u}$, where the eigenvalues $\\lambda(\\theta)$ are:\n$$\n\\lambda(\\theta) = -\\frac{a}{h}(1 - \\exp(-\\mathrm{i}\\theta))\n$$\nThe set of all such eigenvalues for $\\theta \\in [-\\pi, \\pi]$ forms the spectrum of $L$, denoted $\\sigma(L)$. We can rewrite $\\lambda(\\theta)$ as:\n$$\n\\lambda(\\theta) = -\\frac{a}{h} + \\frac{a}{h}\\exp(-\\mathrm{i}\\theta)\n$$\nThis equation describes a circle in the complex plane with center $c = -a/h$ and radius $r = a/h$.\n\nA \"practical CFL estimate based on a bounded spectrum inclusion\" involves finding a simple geometric set $\\Sigma$ that contains the spectrum, $\\sigma(L) \\subseteq \\Sigma$, and then requiring that the scaled set $\\Delta t \\Sigma$ lies within the forward Euler stability region $S_{FE}$. A standard method for this is to use the Gerschgorin Circle Theorem. For the matrix $L$, each row has a diagonal entry of $-a/h$ and one off-diagonal entry of $a/h$. The Gerschgorin disks are all identical, being centered at $-a/h$ with radius $a/h$. The union of these disks, which provides a bound for the spectrum, is:\n$$\n\\Sigma = \\left\\{ z \\in \\mathbb{C} : \\left|z + \\frac{a}{h}\\right| \\le \\frac{a}{h} \\right\\}\n$$\nThis disk is also the convex hull of the spectrum. The stability condition is $\\Delta t \\Sigma \\subseteq S_{FE}$. The set $\\Delta t \\Sigma$ is:\n$$\n\\Delta t \\Sigma = \\left\\{ w \\in \\mathbb{C} : \\left|\\frac{w}{\\Delta t} + \\frac{a}{h}\\right| \\le \\frac{a}{h} \\right\\} = \\left\\{ w \\in \\mathbb{C} : \\left|w + \\frac{a\\Delta t}{h}\\right| \\le \\frac{a\\Delta t}{h} \\right\\}\n$$\nUsing the definition $\\nu = a\\Delta t/h$, the scaled bound is the disk $D_{\\nu} = \\{ w \\in \\mathbb{C} : |w + \\nu| \\le \\nu \\}$. This is a disk centered at $-\\nu$ with radius $\\nu$.\nThe forward Euler stability region is $S_{FE} = \\{ w \\in \\mathbb{C} : |1+w| \\le 1 \\}$, which is a disk centered at $-1$ with radius $1$.\nFor the disk $D_{\\nu}$ to be contained in the disk $S_{FE}$, the sum of the distance between their centers and the radius of $D_{\\nu}$ must be less than or equal to the radius of $S_{FE}$:\n$$\n|(-\\nu) - (-1)| + \\nu \\le 1\n$$\n$$\n|1-\\nu| + \\nu \\le 1\n$$\nSince $\\nu = a\\Delta t/h > 0$, we consider two cases:\n1. If $0 < \\nu \\le 1$, then $|1-\\nu| = 1-\\nu$. The condition is $(1-\\nu) + \\nu \\le 1$, which simplifies to $1 \\le 1$. This is true.\n2. If $\\nu > 1$, then $|1-\\nu| = \\nu-1$. The condition is $(\\nu-1) + \\nu \\le 1$, which simplifies to $2\\nu \\le 2$, or $\\nu \\le 1$. This contradicts the assumption $\\nu > 1$.\nThus, the condition is satisfied for all $\\nu \\in (0,1]$. The largest value is $\\nu=1$.\n$$\n\\text{CFL}_{\\text{spec}} = 1\n$$\n\n### Task 2: Von Neumann Stability Analysis\n\nThe von Neumann analysis is performed on the fully discretized scheme. Applying forward Euler in time gives:\n$$\nu_j^{n+1} = u_j^n + \\Delta t \\left( -\\frac{a}{h}(u_j^n - u_{j-1}^n) \\right)\n$$\nLet $\\nu = a\\Delta t/h$. The scheme is $u_j^{n+1} = u_j^n - \\nu(u_j^n - u_{j-1}^n)$.\nWe substitute the Fourier ansatz $u_j^n = (G(\\theta))^n \\exp(\\mathrm{i} j \\theta)$, where $G(\\theta)$ is the amplification factor.\n$$\n(G(\\theta))^{n+1} \\exp(\\mathrm{i} j \\theta) = (G(\\theta))^n \\exp(\\mathrm{i} j \\theta) - \\nu \\left( (G(\\theta))^n \\exp(\\mathrm{i} j \\theta) - (G(\\theta))^n \\exp(\\mathrm{i} (j-1)\\theta) \\right)\n$$\nDividing by $(G(\\theta))^n \\exp(\\mathrm{i} j \\theta)$:\n$$\nG(\\theta) = 1 - \\nu(1 - \\exp(-\\mathrm{i}\\theta))\n$$\nFor stability, we require $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. The expression for $G(\\theta)$ can be written as:\n$$\nG(\\theta) = (1-\\nu) + \\nu\\exp(-\\mathrm{i}\\theta)\n$$\nAs $\\theta$ varies, this expression traces a circle in the complex plane with center $c = 1-\\nu$ and radius $r = \\nu$. For this circle to be contained within the unit disk centered at the origin, we require $|c|+r \\le 1$.\n$$\n|1-\\nu| + \\nu \\le 1\n$$\nThis is the same condition as in Task 1. As shown before, for $\\nu > 0$, this inequality holds if and only if $\\nu \\le 1$.\nThe empirical stability limit is the largest such $\\nu$.\n$$\n\\text{CFL}_{\\text{vN}} = 1\n$$\n\n### Task 3: Compute the Ratio $\\mathcal{R}$\n\nThe ratio $\\mathcal{R}$ is the spectrum-bound-based practical estimate divided by the von Neumann empirical limit.\n$$\n\\mathcal{R} = \\frac{\\text{CFL}_{\\text{spec}}}{\\text{CFL}_{\\text{vN}}} = \\frac{1}{1} = 1\n$$\nFor this particular problem, the semi-discrete operator is normal, and standard analysis techniques (Gerschgorin bounds, numerical range, von Neumann analysis) all yield the same sharp stability limit. The distinction between a \"practical estimate\" and the \"empirical limit\" vanishes.", "answer": "$$\n\\boxed{1}\n$$", "id": "3373451"}, {"introduction": "For linear problems, the Lax Equivalence Theorem neatly guarantees that a consistent and stable scheme will converge to the true solution. However, nonlinear equations, such as those governing fluid shocks, introduce profound new challenges where a scheme can converge to a mathematically valid but physically impossible solution. This advanced exercise has you construct a scheme for Burgers' equation that, despite being consistent, fails to select the physically correct \"entropy solution,\" demonstrating the crucial and subtle interplay between numerical stability and physical admissibility in modern computational physics [@problem_id:3373303].", "problem": "Let $u(x,t)$ denote the solution of the scalar conservation law (Burgers' equation) $u_t + \\left(\\frac{1}{2}u^2\\right)_x = 0$ on $\\mathbb{R} \\times (0,\\infty)$, with Riemann initial data $u(x,0) = u_L$ for $x<0$ and $u(x,0)=u_R$ for $x>0$. Consider a uniform mesh with spatial step $\\Delta x>0$ and time step $\\Delta t>0$, and denote $\\lambda = \\Delta t/\\Delta x$. A finite volume method is called conservative if it updates cell averages $\\{u_j^n\\}_{j \\in \\mathbb{Z}}$ via the flux-difference form $u_j^{n+1} = u_j^n - \\lambda \\left(F_{j+1/2}^n - F_{j-1/2}^n\\right)$, where $F_{j+1/2}^n$ is a two-argument numerical flux depending only on the adjacent states. A numerical flux $F(u_L,u_R)$ is called consistent with the physical flux $f(u) = \\frac{1}{2}u^2$ if $F(u,u) = f(u)$ for all $u \\in \\mathbb{R}$. A scheme is $L^1$-stable if there exists a constant $C$ independent of $\\Delta x$, $\\Delta t$, and $n$, such that $\\sum_{j \\in \\mathbb{Z}} |u_j^n - v_j^n| \\le C \\sum_{j \\in \\mathbb{Z}} |u_j^0 - v_j^0|$ for all $n \\ge 0$ and for any two solutions generated by the scheme from initial data $\\{u_j^0\\}$ and $\\{v_j^0\\}$. A weak solution to the conservation law is entropy-admissible if it satisfies the Lax entropy condition for shocks, or equivalently, if it is the vanishing-viscosity limit of $u_t + \\left(\\frac{1}{2}u^2\\right)_x = \\epsilon u_{xx}$ as $\\epsilon \\to 0^+$.\n\nYour tasks are:\n\n1. Starting from the conservation law structure and the definition of consistency, construct an explicit conservative finite volume scheme for Burgers' equation that is consistent but whose leading modified-equation correction acts as a negative viscosity. Carefully justify that your constructed scheme is conservative and consistent, and derive its leading modified equation using Taylor expansions and difference approximations to identify the sign of the viscosity term.\n\n2. Using definitions of monotonicity and the $L^1$ stability concept, prove that your constructed scheme is not $L^1$-stable by showing that it is not monotone and that its linearized amplification factor exceeds $1$ for some Fourier mode in a neighborhood of a constant state. Connect this to the sign of the viscosity term in the modified equation.\n\n3. Consider the Riemann problem with $u_L=0$ and $u_R=1$. Explain why the entropy solution of Burgers' equation for this data is a rarefaction fan and why any shock connecting $u_L$ to $u_R$ is non-admissible. Then, analyze the weak limit selected by your scheme in the presence of negative viscosity by invoking the conservative form and the Rankine–Hugoniot relation. Determine the speed $s$ of the discontinuity that the scheme selects for this Riemann problem and provide this $s$ as your final answer. The final answer must be a single real number without units. No rounding is required; provide the exact value.", "solution": "This problem is composed of three tasks concerning a finite volume scheme for Burgers' equation. We shall address each task in sequence after constructing the required numerical scheme.\n\n### Part 1: Construction and Analysis of a Scheme with Negative Viscosity\n\nThe problem requires the construction of a conservative finite volume scheme that is consistent but exhibits negative viscosity. A finite volume scheme is given in the conservative flux-difference form:\n$$ u_j^{n+1} = u_j^n - \\lambda \\left(F_{j+1/2}^n - F_{j-1/2}^n\\right) $$\nwhere $\\lambda = \\frac{\\Delta t}{\\Delta x}$, $u_j^n$ is the cell-average of the solution in cell $j$ at time $n$, and $F_{j+1/2}^n = F(u_j^n, u_{j+1}^n)$ is the numerical flux at the interface between cells $j$ and $j+1$. The physical flux for Burgers' equation is $f(u) = \\frac{1}{2}u^2$, with characteristic speed $f'(u) = u$.\n\nA standard stable scheme, like the upwind scheme, uses information from the direction of the flow. To construct a scheme with negative viscosity, which typically leads to instability, we can design a flux that uses information from the \"downwind\" direction. This is an anti-upwind or downwind scheme.\n\nLet us define the numerical flux $F(u_L, u_R)$ based on the sign of the characteristic speed, approximated at the interface, for instance by $\\frac{u_L+u_R}{2}$:\n$$ F(u_L, u_R) = \\begin{cases} f(u_R) & \\text{if } (u_L+u_R)/2 > 0 \\\\ f(u_L) & \\text{if } (u_L+u_R)/2 < 0 \\end{cases} $$\nFor the case $(u_L+u_R)/2 = 0$, the flux can be defined as $F(u_L, u_R) = f(0) = 0$, which is consistent with both branches as $u_L \\to 0^-$ and $u_R \\to 0^+$.\n\nWe verify the properties of this scheme:\n1.  **Conservative:** The scheme is defined in the flux-difference form $u_j^{n+1} = u_j^n - \\lambda (F(u_j^n, u_{j+1}^n) - F(u_{j-1}^n, u_j^n))$. This form guarantees conservation of the integrated quantity $\\sum_j u_j^n \\Delta x$, as can be seen by summing over $j$, which results in a telescoping sum of fluxes.\n2.  **Consistent:** A flux $F(u_L, u_R)$ is consistent with $f(u)$ if $F(u, u) = f(u)$. For our defined flux, if we set $u_L = u_R = u$, then $(u_L+u_R)/2 = u$. If $u>0$, $F(u,u) = f(u)$. If $u<0$, $F(u,u) = f(u)$. If $u=0$, $F(0,0)=f(0)$. Thus, the flux is consistent.\n\nNow, we derive the leading term of the modified equation for this scheme. Let us consider a region where the solution is positive, $u > 0$. In this case, $F(u_L, u_R) = f(u_R) = \\frac{1}{2}u_R^2$. The scheme becomes:\n$$ u_j^{n+1} = u_j^n - \\lambda \\left( f(u_{j+1}^n) - f(u_j^n) \\right) $$\nWe perform a Taylor series expansion of this equation around the point $(x_j, t_n)$.\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + \\frac{f(u_{j+1}^n) - f(u_j^n)}{\\Delta x} = 0 $$\nThe first term is expanded in time:\n$$ \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + O((\\Delta t)^2) $$\nThe second term is expanded in space:\n$$ \\frac{f(u(x_j+\\Delta x, t_n)) - f(u(x_j, t_n))}{\\Delta x} = f_x + \\frac{\\Delta x}{2}f_{xx} + O((\\Delta x)^2) $$\nwhere all derivatives are evaluated at $(x_j, t_n)$. Substituting these into the scheme gives:\n$$ u_t + f_x + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta x}{2}f_{xx} + \\dots = 0 $$\nTo find the leading-order correction, we express higher-order derivatives in terms of spatial derivatives using the original PDE, $u_t + f_x = 0$, as a first approximation. From $u_t = -f_x$, we find $u_{tt} = \\partial_t(-f_x) = - (f_t)_x = -(f'(u)u_t)_x = -(f'(u)(-f_x))_x = (f'(u)f_x)_x$.\nSubstituting this into the expanded scheme:\n$$ u_t + f_x = -\\frac{\\Delta t}{2}(f'(u)f_x)_x - \\frac{\\Delta x}{2}f_{xx} + O(\\Delta t^2, \\Delta x^2) $$\nUsing $f_x = f'(u)u_x$ and $f_{xx} = (f'(u)u_x)_x$, we get:\n$$ u_t + f_x = -\\left[ \\frac{\\Delta t}{2}(f')^2 + \\frac{\\Delta x}{2}f' \\right] u_{xx} + \\dots $$\n$$ u_t + f_x = -\\frac{\\Delta x}{2} \\left[ \\lambda (f')^2 + f' \\right] u_{xx} + \\dots $$\nThe standard form of a viscous conservation law is $u_t + f_x = \\nu u_{xx}$, where $\\nu$ is the viscosity coefficient. Our modified equation reveals an effective numerical viscosity of $\\nu_{num} = -\\frac{\\Delta x}{2}(\\lambda (f')^2 + f')$.\nFor Burgers' equation, $f'(u)=u$:\n$$ \\nu_{num} = -\\frac{\\Delta x}{2}(\\lambda u^2 + u) $$\nThis is a negative viscosity when $\\lambda u^2 + u > 0$. For the assumed case $u>0$, this condition is always met since $\\lambda>0$. Thus, our scheme introduces a negative viscosity term, which acts as an anti-diffusion.\n\n### Part 2: Instability of the Constructed Scheme\n\nWe now demonstrate that the scheme is not $L^1$-stable. We do this by showing it is not monotone and by analyzing its linearized amplification factor. A scheme $u_j^{n+1} = H(u_{j-k}^n, \\dots, u_{j+k}^n)$ is monotone if $\\frac{\\partial H}{\\partial u_i^n} \\ge 0$ for all its arguments $u_i^n$.\nFor our scheme with $u>0$, $u_j^{n+1} = H(u_j^n, u_{j+1}^n) = u_j^n - \\lambda(f(u_{j+1}^n) - f(u_j^n))$.\nLet us compute the partial derivatives:\n$$ \\frac{\\partial H}{\\partial u_j^n} = 1 - \\lambda \\frac{\\partial}{\\partial u_j^n}(-f(u_j^n)) = 1 + \\lambda f'(u_j^n) = 1 + \\lambda u_j^n $$\nFor $u_j^n>0$ and $\\lambda>0$, this is positive.\n$$ \\frac{\\partial H}{\\partial u_{j+1}^n} = -\\lambda \\frac{\\partial}{\\partial u_{j+1}^n}(f(u_{j+1}^n)) = -\\lambda f'(u_{j+1}^n) = -\\lambda u_{j+1}^n $$\nFor $u_{j+1}^n>0$ and $\\lambda>0$, this derivative is strictly negative. Since one of the partial derivatives is negative, the scheme is not monotone. By the theorems of Harten, Lax, and van Leer, a non-monotone scheme cannot be total variation diminishing (TVD) in the nonlinear case. For scalar conservation laws, $L^1$-contraction is closely related to the TVD property, suggesting a lack of $L^1$-stability.\n\nTo prove instability rigorously, we perform a von Neumann stability analysis on the linearized version of the scheme. Let's linearize around a constant state $\\bar{u}>0$. The scheme for a perturbation $\\delta_j^n$ is:\n$$ \\delta_j^{n+1} = \\delta_j^n - \\lambda \\bar{u} (\\delta_{j+1}^n - \\delta_j^n) $$\nWe look for solutions of the form $\\delta_j^n = G^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $G$ is the amplification factor.\n$$ G = 1 - c\\lambda (e^{i\\theta} - 1) $$\nwhere $c=\\bar{u}>0$ and $\\theta = k\\Delta x$. The squared modulus of $G$ is:\n$$ |G|^2 = \\left| 1 - c\\lambda(\\cos\\theta - 1) - i c\\lambda\\sin\\theta \\right|^2 $$\n$$ |G|^2 = (1 - c\\lambda(\\cos\\theta - 1))^2 + (c\\lambda\\sin\\theta)^2 $$\n$$ |G|^2 = 1 - 2c\\lambda(\\cos\\theta - 1) + c^2\\lambda^2(\\cos\\theta-1)^2 + c^2\\lambda^2\\sin^2\\theta $$\n$$ |G|^2 = 1 + 2c\\lambda(1-\\cos\\theta) + c^2\\lambda^2(\\cos^2\\theta-2\\cos\\theta+1+\\sin^2\\theta) $$\n$$ |G|^2 = 1 + (2c\\lambda + 2c^2\\lambda^2)(1-\\cos\\theta) $$\nSince $c=\\bar{u}>0$, $\\lambda>0$, the term $2c\\lambda + 2c^2\\lambda^2$ is positive. Also, $1-\\cos\\theta \\ge 0$. For any mode where $\\theta \\neq 2m\\pi$ (for $m \\in \\mathbb{Z}$), we have $1-\\cos\\theta > 0$, which implies $|G|^2 > 1$.\nAn amplification factor greater than $1$ means that certain Fourier modes of the solution grow exponentially in time. This unbounded growth violates the definition of $L^1$-stability, which requires the $L^1$-norm of the difference between two solutions to be bounded by a constant times the initial difference. The exponential growth is a direct manifestation of the negative viscosity derived in Part 1, which corresponds to an ill-posed backward-in-time heat equation.\n\n### Part 3: Riemann Problem Solution Selected by the Scheme\n\nWe consider the Riemann problem for Burgers' equation with initial data $u(x,0)=u_L=0$ for $x<0$ and $u(x,0)=u_R=1$ for $x>0$.\nThe characteristic speeds are $f'(u_L)=0$ and $f'(u_R)=1$. Since $f'(u_L) < f'(u_R)$, characteristics starting from the left half-axis are slower than those from the right half-axis. The characteristics diverge from the origin, creating a fan-like region. The entropy-admissible weak solution is a continuous rarefaction wave:\n$$ u(x,t) = \\begin{cases} 0 & \\text{if } x/t < 0 \\\\ x/t & \\text{if } 0 \\le x/t \\le 1 \\\\ 1 & \\text{if } x/t > 1 \\end{cases} $$\nA discontinuous shock solution connecting $u_L=0$ to $u_R=1$ would have a speed $s$ given by the Rankine-Hugoniot condition:\n$$ s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}(1)^2 - \\frac{1}{2}(0)^2}{1 - 0} = \\frac{1}{2} $$\nFor this shock to be entropy-admissible, it must satisfy the Lax entropy condition: $f'(u_L) > s > f'(u_R)$. With $f'(u)=u$, this becomes $0 > 1/2 > 1$, which is false. Therefore, this shock is non-physical.\n\nThe constructed numerical scheme is conservative. According to the Lax-Wendroff theorem, if the numerical solutions generated by a conservative scheme converge as $\\Delta x, \\Delta t \\to 0$, the limit must be a weak solution of the PDE, meaning it satisfies the Rankine-Hugoniot condition across any discontinuities.\nOur scheme has negative numerical viscosity for $u>0$. The vanishing viscosity method for selecting the entropy solution relies on adding a term $\\epsilon u_{xx}$ with $\\epsilon > 0$ and taking the limit $\\epsilon \\to 0^+$. Our scheme's modified equation corresponds to a limit with $\\epsilon < 0$. This process selects entropy-violating solutions. Specifically, it selects shocks that satisfy the anti-Lax condition $f'(u_L) < s < f'(u_R)$. For our problem, this condition is $0 < 1/2 < 1$, which is true.\nConsequently, the constructed scheme will not converge to the rarefaction wave. Instead, it will attempt to form the non-physical discontinuous solution. The speed of this discontinuity, being determined by the conservation property of the scheme, must be the one given by the Rankine-Hugoniot condition.\nTherefore, the speed $s$ of the discontinuity selected by the scheme is:\n$$ s = \\frac{1}{2} $$", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "3373303"}]}