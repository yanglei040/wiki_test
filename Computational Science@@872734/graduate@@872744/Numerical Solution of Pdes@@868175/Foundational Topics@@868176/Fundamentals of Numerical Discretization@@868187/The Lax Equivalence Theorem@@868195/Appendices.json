{"hands_on_practices": [{"introduction": "The Lax Equivalence Theorem forms the bedrock of numerical analysis for PDEs, stating that for a consistent scheme, stability is the necessary and sufficient condition for convergence. This first practice provides a striking demonstration of this principle's power through a \"cautionary tale\"—the Forward-Time, Centered-Space (FTCS) scheme [@problem_id:3455897]. By analyzing this intuitively appealing but notoriously unstable method, you will directly calculate why its numerical solutions diverge, even though it accurately represents the underlying advection equation, highlighting that consistency alone is not enough.", "problem": "Consider the linear constant-coefficient advection Partial Differential Equation (PDE) $u_{t}+a\\,u_{x}=0$ with constant wave speed $a\\neq 0$ on a periodic spatial domain of length $L$. Let the spatial grid be $x_{j}=j\\,\\Delta x$ with $j\\in\\mathbb{Z}$ and $\\Delta x=L/M$ for some positive integer $M$, and let time levels be $t^{n}=n\\,\\Delta t$ with $\\Delta t>0$. Discretize the PDE using the Forward Time Centered Space (FTCS) scheme\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right).\n$$\nUsing von Neumann analysis based on discrete Fourier modes and the definition of stability in the sense of bounded amplification of all modes, derive the amplification factor and compute the spectral radius as a function of the Courant number $\\nu=\\dfrac{a\\,\\Delta t}{\\Delta x}$. Then, using only foundational definitions of consistency and the Lax-Richtmyer Equivalence Theorem (also known as the Lax Equivalence Theorem) for linear initial value problems, interpret why the FTCS scheme fails to converge for this PDE despite being consistent.\n\nYour final answer must be the closed-form expression for the spectral radius $\\rho(\\nu)=\\sup_{\\theta\\in[-\\pi,\\pi]}|G(\\theta)|$ in terms of $a$, $\\Delta t$, and $\\Delta x$. No numerical approximation is required.", "solution": "The problem statement is analyzed and found to be valid. It is scientifically grounded in the numerical analysis of partial differential equations, well-posed with a clear objective, and free of any contradictions or ambiguities. The problem presents a classic case study of an unstable numerical scheme and its analysis via the Lax Equivalence Theorem.\n\nWe begin by performing a von Neumann stability analysis for the Forward Time Centered Space (FTCS) scheme applied to the linear advection equation $u_{t}+a\\,u_{x}=0$. The FTCS scheme is given by:\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right)\n$$\nIn von Neumann analysis, we consider the behavior of a single Fourier mode of the numerical solution, which is written in the form $u_j^n = G^n e^{i k x_j}$, where $k$ is the wavenumber, $x_j = j\\Delta x$ is the spatial coordinate, and $G$ is the amplification factor which depends on the wavenumber $k$. Substituting this mode into the scheme gives:\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{2 \\Delta x} \\left( G^n e^{i k (j+1) \\Delta x} - G^n e^{i k (j-1) \\Delta x} \\right)\n$$\nDividing the entire equation by $G^n e^{i k j \\Delta x}$, which is non-zero, yields the amplification factor $G$:\n$$\nG = 1 - \\frac{a \\Delta t}{2 \\Delta x} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right)\n$$\nUsing Euler's identity, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, and defining the normalized wavenumber or phase angle as $\\theta = k \\Delta x$, we get:\n$$\nG(\\theta) = 1 - \\frac{a \\Delta t}{2 \\Delta x} (2i \\sin(\\theta))\n$$\nLet $\\nu = \\frac{a \\Delta t}{\\Delta x}$ be the Courant number. The amplification factor can be expressed concisely as:\n$$\nG(\\theta) = 1 - i \\nu \\sin(\\theta)\n$$\nFor a scheme to be stable in the von Neumann sense, the magnitude of the amplification factor must satisfy $|G(\\theta)| \\le 1$ for all possible phase angles $\\theta \\in [-\\pi, \\pi]$. Let us compute the magnitude of $G(\\theta)$. As a complex number, its squared magnitude is the sum of the squares of its real and imaginary parts:\n$$\n|G(\\theta)|^2 = (\\operatorname{Re}(G))^2 + (\\operatorname{Im}(G))^2 = 1^2 + (-\\nu \\sin(\\theta))^2 = 1 + \\nu^2 \\sin^2(\\theta)\n$$\nThus, the magnitude of the amplification factor is:\n$$\n|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}\n$$\nThe spectral radius, $\\rho(\\nu)$, is defined as the supremum of this magnitude over all possible modes:\n$$\n\\rho(\\nu)=\\sup_{\\theta\\in[-\\pi,\\pi]}|G(\\theta)| = \\sup_{\\theta\\in[-\\pi,\\pi]} \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}\n$$\nTo find this supremum, we must maximize the term $\\sin^2(\\theta)$ over the interval $\\theta \\in [-\\pi, \\pi]$. The maximum value of $\\sin^2(\\theta)$ is $1$, which occurs at $\\theta = \\pm \\pi/2$. Therefore, the spectral radius is:\n$$\n\\rho(\\nu) = \\sqrt{1 + \\nu^2 (1)} = \\sqrt{1 + \\nu^2}\n$$\nSubstituting the definition of the Courant number $\\nu$, we obtain the spectral radius in terms of the given parameters:\n$$\n\\rho = \\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}\n$$\nNow, we use the Lax Equivalence Theorem to explain the scheme's failure to converge. The theorem states that for a well-posed linear initial-value problem, a consistent linear finite difference scheme is convergent if and only if it is stable.\n\nFirst, we check for consistency. A scheme is consistent if its truncation error approaches zero as the grid spacings $\\Delta t$ and $\\Delta x$ approach zero. The truncation error $T_j^n$ is found by substituting the exact solution $u(x, t)$ of the PDE into the difference equation:\n$$\nT_j^n = \\frac{u(x_j, t^{n+1}) - u(x_j, t^n)}{\\Delta t} + \\frac{a}{2\\Delta x} (u(x_{j+1}, t^n) - u(x_{j-1}, t^n))\n$$\nUsing Taylor series expansions around $(x_j, t^n)$:\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) + \\Delta t \\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O((\\Delta t)^3)\n$$\n$$\nu(x_{j\\pm 1}, t^n) = u(x_j, t^n) \\pm \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4)\n$$\nSubstituting these into the expression for $T_j^n$:\n$$\nT_j^n = \\left( u_t + \\frac{\\Delta t}{2}u_{tt} + \\dots \\right) + a \\left( u_x + \\frac{(\\Delta x)^2}{6}u_{xxx} + \\dots \\right)\n$$\n$$\nT_j^n = (u_t + a u_x) + \\frac{\\Delta t}{2}u_{tt} + a\\frac{(\\Delta x)^2}{6}u_{xxx} + \\dots\n$$\nSince $u(x,t)$ is the exact solution, $u_t + a u_x = 0$. The principal part of the truncation error is $O(\\Delta t, (\\Delta x)^2)$. As $\\Delta t \\to 0$ and $\\Delta x \\to 0$, the truncation error $T_j^n \\to 0$. Thus, the FTCS scheme is consistent with the advection equation.\n\nNext, we check for stability. As derived from the von Neumann analysis, the magnitude of the amplification factor is $|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}$. The problem specifies $a \\ne 0$, $\\Delta t > 0$, and implicitly $\\Delta x > 0$. Therefore, the Courant number $\\nu = \\frac{a \\Delta t}{\\Delta x}$ is non-zero. For any mode with $\\theta \\in [-\\pi, \\pi]$ such that $\\sin(\\theta) \\ne 0$ (which is true for almost all modes), the term $\\nu^2 \\sin^2(\\theta)$ is strictly positive. This implies:\n$$\n|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)} > 1\n$$\nSince the stability condition $|G(\\theta)| \\le 1$ is violated for all $\\nu \\ne 0$ and for almost all modes, the FTCS scheme is unconditionally unstable. The spectral radius $\\rho = \\sqrt{1 + \\nu^2}$ is strictly greater than $1$ for any non-zero $\\nu$.\n\nAccording to the Lax Equivalence Theorem, convergence requires both consistency and stability. We have established that the FTCS scheme is consistent but unconditionally unstable. The failure to satisfy the stability condition means that the scheme is not convergent. The physical interpretation is that numerical errors, particularly in the high-frequency modes (where $|\\sin(\\theta)|$ is large), are amplified at every time step, leading to an exponential growth that quickly contaminates and overwhelms the true solution. This unconditional instability is the reason the FTCS scheme fails to converge for the linear advection equation.", "answer": "$$\n\\boxed{\\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}}\n$$", "id": "3455897"}, {"introduction": "While some schemes are unconditionally unstable, many useful methods are *conditionally* stable, converging only when the discretization parameters satisfy certain constraints. The leapfrog scheme for the advection equation is a canonical example that introduces the celebrated Courant-Friedrichs-Lewy (CFL) condition [@problem_id:3455887]. This exercise will guide you through the analysis of a multi-step method, revealing a stability threshold that dictates a strict relationship between the time step $\\Delta t$ and the spatial step $\\Delta x$, a foundational concept for nearly all explicit time-stepping methods.", "problem": "Consider the linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ on the one-dimensional torus with periodic boundary conditions, where $a \\in \\mathbb{R}$ is a constant advection speed. Discretize the PDE on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$ using the leapfrog scheme in time and the centered difference in space:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0,\n$$\nwhere $u_{j}^{n}$ approximates $u(x_{j},t^{n})$ and the Courant number is $\\lambda \\equiv a\\,\\Delta t/\\Delta x$. Assume periodic boundary conditions so that discrete Fourier modes are a complete basis. Using von Neumann analysis, treat each Fourier mode independently by setting $u_{j}^{n} = \\zeta^{n}\\,\\exp(i\\,j\\,\\kappa)$, where $\\kappa \\in [-\\pi,\\pi]$ is the nondimensional wavenumber.\n\nTasks:\n- Starting from the definition of the discrete Fourier mode and the given scheme, derive the quadratic equation satisfied by the amplification factor $\\zeta$ as a function of $\\kappa$ and $\\lambda$, and solve it explicitly to obtain both amplification factors as functions $G_{\\pm}(\\kappa;\\lambda)$.\n- Define the spectral radius over all Fourier modes as $\\rho(\\lambda) \\equiv \\sup_{\\kappa \\in [-\\pi,\\pi]} \\max\\{ |G_{+}(\\kappa;\\lambda)|,\\,|G_{-}(\\kappa;\\lambda)|\\}$. Compute a closed-form expression for $\\rho(\\lambda)$ in terms of $\\lambda$ only.\n- Using only the fundamental definition of local truncation error and Taylor expansions about $(x_{j},t^{n})$, show that the scheme is consistent with order at least $2$ in both $\\Delta t$ and $\\Delta x$.\n- Explain why the set $\\{ \\lambda \\in \\mathbb{R} : \\rho(\\lambda) \\le 1 \\}$ is the von Neumann stability region for this scheme on the periodic domain. Then, using the Lax equivalence theorem (LET), which states that for a well-posed linear initial-value problem a finite difference scheme is convergent if and only if it is consistent and stable, demonstrate that if the Courant–Friedrichs–Lewy (CFL) condition $|\\lambda| \\le 1$ is violated, the numerical solution diverges for some initial data despite the scheme being consistent.\n\nGive, as your final answer, the closed-form analytic expression for the function $\\rho(\\lambda)$ obtained above. No numerical rounding is required; express your answer exactly and do not include units.", "solution": "The problem as stated is a standard, well-posed problem in the field of numerical analysis for partial differential equations. It is scientifically grounded, self-contained, and objective. All provided definitions and conditions are standard and consistent. Therefore, the problem is valid, and a full solution can be derived.\n\nThe problem asks for a four-part analysis of the leapfrog scheme for the linear advection equation. We will address each part in sequence.\n\nFirst, we derive the amplification factors, $G_{\\pm}(\\kappa;\\lambda)$. The given finite difference scheme is:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0\n$$\nWe rearrange this by multiplying by $2\\,\\Delta t$ and using the definition of the Courant number, $\\lambda = a\\,\\Delta t/\\Delta x$:\n$$\nu_{j}^{n+1} - u_{j}^{n-1} + \\lambda (u_{j+1}^{n} - u_{j-1}^{n}) = 0\n$$\nFor the von Neumann stability analysis, we substitute the Fourier mode ansatz $u_{j}^{n} = \\zeta^{n}\\,\\exp(i\\,j\\,\\kappa)$ into the scheme. The term $u_{j}^{n}$ becomes $\\zeta^n \\exp(ijk)$, $u_{j}^{n+1}$ becomes $\\zeta^{n+1} \\exp(ijk)$, $u_{j+1}^{n}$ becomes $\\zeta^n \\exp(i(j+1)k)$, and so on.\n$$\n\\zeta^{n+1}\\exp(i\\,j\\,\\kappa) - \\zeta^{n-1}\\exp(i\\,j\\,\\kappa) + \\lambda \\left( \\zeta^{n}\\exp(i\\,(j+1)\\,\\kappa) - \\zeta^{n}\\exp(i\\,(j-1)\\,\\kappa) \\right) = 0\n$$\nDividing the entire equation by the common, non-zero factor $\\zeta^{n-1}\\exp(i\\,j\\,\\kappa)$ yields:\n$$\n\\zeta^{2} - 1 + \\lambda \\zeta \\left( \\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa) \\right) = 0\n$$\nUsing Euler's identity, $\\sin(\\kappa) = \\frac{\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa)}{2i}$, we can simplify the expression in the parenthesis to $2i\\sin(\\kappa)$.\n$$\n\\zeta^{2} - 1 + \\lambda \\zeta (2i\\sin(\\kappa)) = 0\n$$\nThis gives the required quadratic equation for the amplification factor $\\zeta$:\n$$\n\\zeta^2 + (2i\\lambda\\sin(\\kappa))\\zeta - 1 = 0\n$$\nWe solve this equation for $\\zeta$ using the quadratic formula, $\\zeta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, with coefficients $a=1$, $b=2i\\lambda\\sin(\\kappa)$, and $c=-1$.\n$$\n\\zeta = \\frac{-2i\\lambda\\sin(\\kappa) \\pm \\sqrt{(2i\\lambda\\sin(\\kappa))^2 - 4(1)(-1)}}{2(1)}\n$$\n$$\n\\zeta = \\frac{-2i\\lambda\\sin(\\kappa) \\pm \\sqrt{-4\\lambda^2\\sin^2(\\kappa) + 4}}{2}\n$$\n$$\n\\zeta = \\frac{-2i\\lambda\\sin(\\kappa) \\pm 2\\sqrt{1 - \\lambda^2\\sin^2(\\kappa)}}{2}\n$$\nThis yields the two amplification factors, $G_{\\pm}(\\kappa;\\lambda)$:\n$$\nG_{\\pm}(\\kappa;\\lambda) = -i\\lambda\\sin(\\kappa) \\pm \\sqrt{1 - \\lambda^2\\sin^2(\\kappa)}\n$$\n\nSecond, we compute the spectral radius $\\rho(\\lambda) = \\sup_{\\kappa \\in [-\\pi,\\pi]} \\max\\{ |G_{+}(\\kappa;\\lambda)|,\\,|G_{-}(\\kappa;\\lambda)|\\}$. We analyze the magnitude of $G_{\\pm}$ by considering two cases for the term under the square root.\n\nCase 1: $1 - \\lambda^2\\sin^2(\\kappa) \\ge 0$, which is equivalent to $|\\lambda\\sin(\\kappa)| \\le 1$.\nIn this case, the square root is real. Let $\\alpha = \\sqrt{1 - \\lambda^2\\sin^2(\\kappa)}$. The amplification factors are $G_{\\pm} = \\pm\\alpha - i\\lambda\\sin(\\kappa)$. The magnitude squared is:\n$$\n|G_{\\pm}|^2 = (\\pm\\alpha)^2 + (-\\lambda\\sin(\\kappa))^2 = \\alpha^2 + \\lambda^2\\sin^2(\\kappa) = (1 - \\lambda^2\\sin^2(\\kappa)) + \\lambda^2\\sin^2(\\kappa) = 1\n$$\nThus, $|G_{+}| = |G_{-}| = 1$ whenever $|\\lambda\\sin(\\kappa)| \\le 1$.\n\nCase 2: $1 - \\lambda^2\\sin^2(\\kappa) < 0$, which is equivalent to $|\\lambda\\sin(\\kappa)| > 1$.\nIn this case, the square root is imaginary. Let $\\beta = \\sqrt{\\lambda^2\\sin^2(\\kappa) - 1}$. The square root term becomes $\\sqrt{-(\\lambda^2\\sin^2(\\kappa) - 1)} = i\\beta$.\nThe amplification factors are $G_{\\pm} = -i\\lambda\\sin(\\kappa) \\pm i\\beta = i(-\\lambda\\sin(\\kappa) \\pm \\beta)$. These are purely imaginary numbers. Their magnitudes are:\n$$\n|G_{\\pm}| = |-\\lambda\\sin(\\kappa) \\pm \\sqrt{\\lambda^2\\sin^2(\\kappa) - 1}|\n$$\nTo find the spectral radius $\\rho(\\lambda)$, we must find the supremum of these magnitudes over all $\\kappa \\in [-\\pi,\\pi]$.\nIf $|\\lambda| \\le 1$, then for all $\\kappa$, $|\\sin(\\kappa)| \\le 1$, which implies $|\\lambda\\sin(\\kappa)| \\le |\\lambda| \\le 1$. We are always in Case 1, so $|G_{\\pm}|$ is always $1$. The supremum is $1$. So, $\\rho(\\lambda) = 1$ for $|\\lambda| \\le 1$.\nIf $|\\lambda| > 1$, there exist values of $\\kappa$ for which $|\\lambda\\sin(\\kappa)| > 1$. The magnitude $|G_{\\pm}|$ will be maximized when $|\\sin(\\kappa)|$ is maximized, i.e., $|\\sin(\\kappa)| = 1$, which occurs at $\\kappa = \\pm\\pi/2$. Let's choose $\\kappa = \\pi/2$, so $\\sin(\\kappa)=1$. Then $|\\lambda\\sin(\\kappa)| = |\\lambda| > 1$, placing us in Case 2. The magnitudes are:\n$$\n|G_{\\pm}| = |-\\lambda \\pm \\sqrt{\\lambda^2 - 1}|\n$$\nSince $|\\lambda| > 1$, we have $\\sqrt{\\lambda^2-1} < |\\lambda|$. Let's assume $\\lambda > 1$. Then $|G_{\\pm}| = |-\\lambda \\pm \\sqrt{\\lambda^2-1}| = \\lambda \\mp \\sqrt{\\lambda^2-1}$. The maximum of these two values is $\\lambda + \\sqrt{\\lambda^2-1}$. If $\\lambda < -1$, then let $\\lambda' = -\\lambda > 1$. At $\\kappa=\\pi/2$, $\\lambda\\sin\\kappa = \\lambda = -\\lambda'$. The magnitudes are $|-(-\\lambda') \\pm \\sqrt{(-\\lambda')^2-1}| = |\\lambda' \\pm \\sqrt{\\lambda'^2-1}| = \\lambda' \\pm \\sqrt{\\lambda'^2-1}$, the maximum of which is $\\lambda' + \\sqrt{\\lambda'^2-1} = |\\lambda| + \\sqrt{\\lambda^2-1}$.\nTherefore, for $|\\lambda| > 1$, the spectral radius is $\\rho(\\lambda) = \\sup_{\\kappa} |G_{\\pm}| = |\\lambda| + \\sqrt{\\lambda^2 - 1}$.\nCombining the two conditions, the closed-form expression for $\\rho(\\lambda)$ is:\n$$\n\\rho(\\lambda) =\n\\begin{cases}\n1 & \\text{if } |\\lambda| \\le 1 \\\\\n|\\lambda| + \\sqrt{\\lambda^2-1} & \\text{if } |\\lambda| > 1\n\\end{cases}\n$$\n\nThird, we show that the scheme is consistent with order at least $2$ in both $\\Delta t$ and $\\Delta x$. The local truncation error (LTE), $\\tau_{j}^{n}$, is obtained by substituting the exact solution $u(x,t)$ into the difference operator:\n$$\n\\tau_{j}^{n} = \\frac{u(x_{j}, t^{n+1}) - u(x_{j}, t^{n-1})}{2\\Delta t} + a \\frac{u(x_{j}+\\Delta x, t^{n}) - u(x_{j}-\\Delta x, t^{n})}{2\\Delta x}\n$$\nWe use Taylor series expansions about the point $(x_{j}, t^{n})$:\n$u(x_j, t^{n\\pm1}) = u \\pm \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} \\pm \\frac{(\\Delta t)^3}{6} u_{ttt} + O(\\Delta t^4)$\n$u(x_{j\\pm1}, t^n) = u \\pm \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + O(\\Delta x^4)$\nSubstituting these into the expression for $\\tau_j^n$:\nThe time-derivative term becomes:\n$$\n\\frac{1}{2\\Delta t} \\left[ (u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt}) - (u - \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} - \\frac{(\\Delta t)^3}{6} u_{ttt}) + O(\\Delta t^5) \\right] = u_t + \\frac{(\\Delta t)^2}{6} u_{ttt} + O(\\Delta t^4)\n$$\nThe space-derivative term becomes:\n$$\n\\frac{a}{2\\Delta x} \\left[ (u + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx}) - (u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx}) + O(\\Delta x^5) \\right] = a u_x + a\\frac{(\\Delta x)^2}{6} u_{xxx} + O(\\Delta x^4)\n$$\nCombining these, the LTE is:\n$$\n\\tau_{j}^{n} = (u_t + a u_x) + \\frac{(\\Delta t)^2}{6}u_{ttt} + a\\frac{(\\Delta x)^2}{6}u_{xxx} + O(\\Delta t^4) + O(\\Delta x^4)\n$$\nSince $u(x,t)$ is the exact solution to the PDE, $u_t + a u_x = 0$. The LTE is therefore:\n$$\n\\tau_{j}^{n} = \\frac{(\\Delta t)^2}{6}u_{ttt} + a\\frac{(\\Delta x)^2}{6}u_{xxx} + O(\\Delta t^4, \\Delta x^4)\n$$\nThe LTE is of order $O(\\Delta t^2, \\Delta x^2)$. Since $\\tau_{j}^{n} \\to 0$ as $\\Delta t, \\Delta x \\to 0$, the scheme is consistent. The order of consistency is $(2,2)$, which is at least $2$ in both $\\Delta t$ and $\\Delta x$.\n\nFourth, we explain the stability region and use the Lax Equivalence Theorem (LET).\nFor a multi-step scheme like leapfrog, von Neumann stability requires that the magnitudes of all amplification factors are bounded by $1$ for all wavenumbers, i.e., $|G_{\\pm}(\\kappa; \\lambda)| \\le 1$ for all $\\kappa \\in [-\\pi,\\pi]$. Furthermore, any roots with magnitude $1$ must be simple for Lax-Richtmyer stability (uniform boundedness of powers of the amplification matrix). The condition $\\sup_{\\kappa} |G_{\\pm}(\\kappa; \\lambda)| \\le 1$ is equivalent to stating that the spectral radius $\\rho(\\lambda) \\le 1$. From our analysis of $\\rho(\\lambda)$, this condition holds if and only if $|\\lambda| \\le 1$. Therefore, the von Neumann stability region for this scheme is $\\{\\lambda \\in \\mathbb{R} : |\\lambda| \\le 1\\}$, which is the Courant–Friedrichs–Lewy (CFL) condition.\n\nThe Lax Equivalence Theorem states that for a well-posed linear initial-value problem, a finite difference scheme is convergent if and only if it is consistent and stable.\nWe have shown that the leapfrog scheme is consistent (Task 3).\nNow, let's demonstrate divergence when the CFL condition $|\\lambda| \\le 1$ is violated. Assume $|\\lambda| > 1$.\nFrom Task 2, we know that in this case, the spectral radius is $\\rho(\\lambda) = |\\lambda| + \\sqrt{\\lambda^2-1} > 1$. This maximum amplification is attained for some wavenumber $\\kappa_0$, for instance $\\kappa_0 = \\pi/2$. Let's call the corresponding amplification factor with this magnitude $G_{max}$.\nBecause the linear scheme is analyzed mode by mode, we can consider initial data that consists only of this most unstable mode, e.g., $u_j^0 = \\exp(ij\\kappa_0)$. To start the two-step leapfrog scheme, we would also need $u_j^1$. If we assume the solution evolves as a pure mode, then $u_j^1 = G_{max} u_j^0$. The solution at time step $n$ for this mode is then given by $u_j^n = (G_{max})^n \\exp(ij\\kappa_0)$.\nThe magnitude of the solution at step $n$ is $|u_j^n| = |G_{max}|^n = (\\rho(\\lambda))^n$.\nSince $\\rho(\\lambda) > 1$, the amplitude of this Fourier mode grows exponentially with the number of time steps $n$: $(\\rho(\\lambda))^n \\to \\infty$ as $n \\to \\infty$. For any fixed time $t > 0$, as the grid is refined ($\\Delta t \\to 0$), the number of steps $n = t/\\Delta t$ goes to infinity, leading to an unbounded numerical solution.\nThus, the scheme is unstable for $|\\lambda|>1$. According to the Lax Equivalence Theorem, since the scheme is consistent but not stable, it cannot be convergent. This demonstrates that violating the CFL condition leads to a divergent numerical solution, despite the scheme being formally consistent with the PDE.", "answer": "$$\n\\boxed{\n\\rho(\\lambda) =\n\\begin{cases}\n1 & \\text{if } |\\lambda| \\le 1 \\\\\n|\\lambda| + \\sqrt{\\lambda^2-1} & \\text{if } |\\lambda| > 1\n\\end{cases}\n}\n$$", "id": "3455887"}, {"introduction": "A deep understanding of stability allows us not only to analyze existing schemes but also to design new ones or repair flawed ones. This final practice elevates the analysis by considering a two-parameter family of schemes that generalizes the unstable FTCS method from our first exercise [@problem_id:3455861]. By tuning a parameter that controls numerical dissipation, you will map out the entire region of stability in the parameter space, discovering for yourself the precise amount of \"artificial viscosity\" needed to guarantee convergence and thereby transforming an unstable scheme into a robust one.", "problem": "Consider the linear advection initial-value problem $u_{t} + a\\,u_{x} = 0$ on $\\mathbb{R}$ with smooth initial data, where $a \\neq 0$ is constant. On a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$, define the Courant–Friedrichs–Lewy number $\\lambda = a\\,\\Delta t/\\Delta x$. Study the two-parameter explicit, three-point family of linear schemes\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j} \\;-\\; \\frac{\\lambda}{2}\\left(u^{n}_{j+1}-u^{n}_{j-1}\\right) \\;+\\; \\frac{\\theta}{2}\\left(u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}\\right),\n$$\nwith real parameter $\\theta$. This family interpolates between Forward-Time Central-Space ($\\theta=0$), Lax–Friedrichs ($\\theta=1$), and, for $a>0$, the upwind scheme ($\\theta=\\lambda$). Using the definitions of linear consistency, stability in the $\\ell^{2}$ norm via Fourier (von Neumann) analysis, and the Lax equivalence theorem, do the following:\n\n1. Starting from the discrete update, derive the Fourier amplification factor $g(\\xi)$ for a single Fourier mode $e^{\\mathrm{i}j\\xi}$, and obtain a necessary and sufficient condition on $(\\lambda,\\theta)$ for $\\ell^{2}$-stability in terms of $|g(\\xi)| \\le 1$ for all real $\\xi$.\n2. From first principles, establish the full stability region in the $(\\lambda,\\theta)$-plane and identify its boundary curves.\n3. Explain why, in the entire stability region, the scheme is convergent to the solution of $u_{t}+a\\,u_{x}=0$ as $\\Delta t,\\Delta x \\to 0$ with fixed $\\lambda$, and why it is not convergent outside this region.\n\nYour final answer must be the single analytic expression for the smallest artificial viscosity $\\Theta(\\lambda)$ that guarantees stability when $|\\lambda|\\le 1$, defined by\n$$\n\\Theta(\\lambda) \\;=\\; \\inf\\left\\{\\theta\\in[0,1]:\\; (\\lambda,\\theta)\\ \\text{is}\\ \\ell^{2}\\text{-stable}\\right\\}.\n$$\nNo numerical evaluation is required; provide $\\Theta(\\lambda)$ in closed form as a function of $\\lambda$.", "solution": "The problem asks for an analysis of a two-parameter family of finite difference schemes for the linear advection equation. This involves deriving the stability conditions, characterizing the stability region, discussing convergence via the Lax equivalence theorem, and finally determining an expression for the minimal stabilizing artificial viscosity parameter.\n\nThe linear advection equation is given by\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nfor a function $u(x,t)$ on $\\mathbb{R} \\times [0, \\infty)$, with a constant, non-zero advection speed $a$. The numerical scheme under consideration is\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j} \\;-\\; \\frac{\\lambda}{2}\\left(u^{n}_{j+1}-u^{n}_{j-1}\\right) \\;+\\; \\frac{\\theta}{2}\\left(u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}\\right)\n$$\nwhere $\\lambda = a\\,\\Delta t/\\Delta x$ is the Courant number and $\\theta$ is a real parameter.\n\n**1. Derivation of the Amplification Factor and Stability Condition**\n\nTo perform a von Neumann stability analysis, we consider a single Fourier mode for the numerical solution at time level $n$, of the form $u^n_j = \\hat{u}^n(\\xi) e^{\\mathrm{i} j \\xi}$, where $\\xi = k_w \\Delta x$ is the dimensionless wavenumber for a wavenumber $k_w$. Due to the linearity of the scheme, the solution at the next time level can be written as $u^{n+1}_j = \\hat{u}^{n+1}(\\xi) e^{\\mathrm{i} j \\xi}$. The amplification factor, $g(\\xi)$, is defined by the relation $\\hat{u}^{n+1}(\\xi) = g(\\xi) \\hat{u}^n(\\xi)$.\n\nSubstituting the Fourier mode into the scheme, we have:\n$$\ng(\\xi) e^{\\mathrm{i} j \\xi} = e^{\\mathrm{i} j \\xi} - \\frac{\\lambda}{2}\\left(e^{\\mathrm{i} (j+1) \\xi} - e^{\\mathrm{i} (j-1) \\xi}\\right) + \\frac{\\theta}{2}\\left(e^{\\mathrm{i} (j+1) \\xi} - 2e^{\\mathrm{i} j \\xi} + e^{\\mathrm{i} (j-1) \\xi}\\right)\n$$\nDividing by the common factor $e^{\\mathrm{i} j \\xi}$ yields the expression for $g(\\xi)$:\n$$\ng(\\xi) = 1 - \\frac{\\lambda}{2}\\left(e^{\\mathrm{i} \\xi} - e^{-\\mathrm{i} \\xi}\\right) + \\frac{\\theta}{2}\\left(e^{\\mathrm{i} \\xi} - 2 + e^{-\\mathrm{i} \\xi}\\right)\n$$\nUsing Euler's identities, $e^{\\mathrm{i} \\xi} - e^{-\\mathrm{i} \\xi} = 2\\mathrm{i}\\sin(\\xi)$ and $e^{\\mathrm{i} \\xi} + e^{-\\mathrm{i} \\xi} = 2\\cos(\\xi)$, we can simplify $g(\\xi)$:\n$$\ng(\\xi) = 1 - \\frac{\\lambda}{2}(2\\mathrm{i}\\sin(\\xi)) + \\frac{\\theta}{2}(2\\cos(\\xi) - 2) = 1 - \\mathrm{i}\\lambda\\sin(\\xi) + \\theta(\\cos(\\xi)-1)\n$$\nThe real and imaginary parts of $g(\\xi)$ are:\n$$\n\\operatorname{Re}(g(\\xi)) = 1 + \\theta(\\cos(\\xi)-1) = 1 - 2\\theta\\sin^2\\left(\\frac{\\xi}{2}\\right)\n$$\n$$\n\\operatorname{Im}(g(\\xi)) = -\\lambda\\sin(\\xi)\n$$\nFor the scheme to be stable in the $\\ell^2$ norm, the von Neumann stability condition requires that the magnitude of the amplification factor be less than or equal to $1$ for all possible wavenumbers $\\xi \\in [-\\pi, \\pi]$. That is, $|g(\\xi)| \\le 1$, which is equivalent to $|g(\\xi)|^2 \\le 1$.\n$$\n|g(\\xi)|^2 = (\\operatorname{Re}(g(\\xi)))^2 + (\\operatorname{Im}(g(\\xi)))^2 = (1 + \\theta(\\cos(\\xi)-1))^2 + (-\\lambda\\sin(\\xi))^2 \\le 1\n$$\nLet's expand this expression:\n$$\n1 + 2\\theta(\\cos(\\xi)-1) + \\theta^2(\\cos(\\xi)-1)^2 + \\lambda^2\\sin^2(\\xi) \\le 1\n$$\nSubtracting $1$ from both sides and using the identity $\\sin^2(\\xi) = 1-\\cos^2(\\xi) = (1-\\cos(\\xi))(1+\\cos(\\xi))$ gives:\n$$\n2\\theta(\\cos(\\xi)-1) + \\theta^2(\\cos(\\xi)-1)^2 + \\lambda^2(1-\\cos(\\xi))(1+\\cos(\\xi)) \\le 0\n$$\nLet $C = 1-\\cos(\\xi)$. Note that for $\\xi \\in [-\\pi, \\pi]$, $C$ ranges from $0$ to $2$. The inequality becomes:\n$$\n-2\\theta C + \\theta^2 C^2 + \\lambda^2 C(2-C) \\le 0\n$$\nFor $C=0$ (i.e., $\\xi=0$), the inequality is trivially satisfied ($0 \\le 0$). For $C>0$, we can divide by $C$:\n$$\n-2\\theta + \\theta^2 C + \\lambda^2(2-C) \\le 0\n$$\nRearranging the terms as a linear function of $C$:\n$$\n(2\\lambda^2 - 2\\theta) + C(\\theta^2 - \\lambda^2) \\le 0\n$$\nThis inequality must hold for all $C \\in (0, 2]$. Let's define the function $F(C) = (2\\lambda^2 - 2\\theta) + C(\\theta^2 - \\lambda^2)$. Since $F(C)$ is linear in $C$, for it to be non-positive over the interval $(0, 2]$, it suffices to check its values at the boundaries of the interval, $C \\to 0^+$ and $C=2$.\n\nCondition 1: As $C \\to 0^+$, we must have $F(0^+) \\le 0$.\n$$\n2\\lambda^2 - 2\\theta \\le 0 \\implies \\lambda^2 \\le \\theta\n$$\nCondition 2: At $C=2$ (which corresponds to $\\xi=\\pm\\pi$), we must have $F(2) \\le 0$.\n$$\n(2\\lambda^2 - 2\\theta) + 2(\\theta^2 - \\lambda^2) \\le 0\n$$\n$$\n2\\lambda^2 - 2\\theta + 2\\theta^2 - 2\\lambda^2 \\le 0\n$$\n$$\n2\\theta^2 - 2\\theta \\le 0 \\implies 2\\theta(\\theta-1) \\le 0\n$$\nThis last inequality holds if and only if $0 \\le \\theta \\le 1$.\n\nCombining these two necessary conditions, we find that for the scheme to be stable, the parameters $(\\lambda, \\theta)$ must satisfy:\n$$\n\\lambda^2 \\le \\theta \\quad \\text{and} \\quad 0 \\le \\theta \\le 1\n$$\nThese conditions are also sufficient. If they hold, the function $F(C)$ is non-positive at both ends of the interval $[0, 2]$. Since $F(C)$ is linear, it must be non-positive for all $C \\in [0, 2]$. Thus, the condition $|g(\\xi)|^2 \\le 1$ holds for all $\\xi$. The necessary and sufficient condition for $\\ell^2$-stability is $\\lambda^2 \\le \\theta \\le 1$.\n\n**2. The Stability Region in the $(\\lambda, \\theta)$-Plane**\n\nThe stability region is the set of all points $(\\lambda, \\theta)$ in the plane that satisfy the conditions $\\lambda^2 \\le \\theta$ and $0 \\le \\theta \\le 1$.\nThe second condition, $0 \\le \\theta \\le 1$, restricts the region to a horizontal strip between the lines $\\theta=0$ and $\\theta=1$.\nThe first condition, $\\lambda^2 \\le \\theta$, means that for a given $\\lambda$, stable values of $\\theta$ must lie on or above the parabola $\\theta=\\lambda^2$.\nCombining these, the stability region is the area in the $(\\lambda, \\theta)$-plane that is on and above the parabola $\\theta = \\lambda^2$ and on and below the line $\\theta = 1$.\nThe boundaries of this region are the curves:\n- The parabola $\\theta = \\lambda^2$.\n- The horizontal line segment $\\theta = 1$ for $\\lambda \\in [-1, 1]$.\nThe points of intersection are found by setting $\\lambda^2 = 1$, which gives $\\lambda = \\pm 1$. The intersection points are $(-1, 1)$ and $(1, 1)$. The vertex of the parabola is at $(0, 0)$. The full stability region is thus described by $\\lambda^2 \\le \\theta \\le 1$, which also implies that $|\\lambda| \\le \\sqrt{\\theta} \\le \\sqrt{1} = 1$. So, stability is only possible if $|\\lambda| \\le 1$.\n\n**3. Convergence and the Lax Equivalence Theorem**\n\nThe Lax Equivalence Theorem states that for a well-posed linear initial-value problem, a consistent linear finite difference scheme is convergent if and only if it is stable.\n\nFirst, we establish consistency. The truncation error $T_j^n$ is obtained by substituting an exact solution $u(x, t)$ of the PDE into the finite difference scheme.\n$$\nT_j^n = \\frac{u_j^{n+1}-u_j^n}{\\Delta t} - \\frac{1}{\\Delta t}\\left[-\\frac{\\lambda}{2}(u_{j+1}^n-u_{j-1}^n) + \\frac{\\theta}{2}(u_{j+1}^n-2u_j^n+u_{j-1}^n) \\right]\n$$\nUsing $\\lambda = a \\Delta t/\\Delta x$, this can be written as:\n$$\nT_j^n = \\frac{u_j^{n+1}-u_j^n}{\\Delta t} + a\\frac{u_{j+1}^n-u_{j-1}^n}{2\\Delta x} - \\frac{\\theta \\Delta x^2}{2\\Delta t}\\frac{u_{j+1}^n-2u_j^n+u_{j-1}^n}{\\Delta x^2}\n$$\nTaylor expanding each term around $(x_j, t_n)$:\n- $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + O(\\Delta t^2)$\n- $\\frac{u_{j+1}^n-u_{j-1}^n}{2\\Delta x} = u_x + \\frac{\\Delta x^2}{6}u_{xxx} + O(\\Delta x^4)$\n- $\\frac{u_{j+1}^n-2u_j^n+u_{j-1}^n}{\\Delta x^2} = u_{xx} + \\frac{\\Delta x^2}{12}u_{xxxx} + O(\\Delta x^4)$\nSubstituting these into the expression for $T_j^n$:\n$$\nT_j^n = (u_t + au_x) + \\frac{\\Delta t}{2}u_{tt} + a\\frac{\\Delta x^2}{6}u_{xxx} - \\frac{\\theta \\Delta x^2}{2\\Delta t}u_{xx} + \\text{h.o.t.}\n$$\nSince $u$ is a solution to the PDE, $u_t+au_x=0$. Also, differentiating the PDE gives $u_{tt} = a^2 u_{xx}$.\n$$\nT_j^n = \\frac{\\Delta t}{2}a^2 u_{xx} - \\frac{\\theta \\Delta x^2}{2\\Delta t}u_{xx} + \\text{h.o.t.} = \\left(\\frac{a^2 \\Delta t}{2} - \\frac{\\theta \\Delta x^2}{2\\Delta t}\\right)u_{xx} + \\text{h.o.t.}\n$$\nThis can be rewritten using $\\lambda = a\\Delta t/\\Delta x$:\n$$\nT_j^n = \\frac{a^2\\Delta t}{2\\lambda^2}(\\lambda^2-\\theta)u_{xx} + \\text{h.o.t.}\n$$\nIf $\\Delta t, \\Delta x \\to 0$ while $\\lambda$ is held fixed, then $\\Delta x$ is proportional to $\\Delta t$. The leading term of the truncation error is $O(\\Delta t)$. As $\\Delta t \\to 0$, $T_j^n \\to 0$. Thus, the scheme is consistent for any choice of $\\lambda$ and $\\theta$.\n\nWith consistency established, the Lax Equivalence Theorem applies directly:\n- In the entire stability region, $\\lambda^2 \\le \\theta \\le 1$, the scheme is stable. Since it is also consistent, it is convergent. The numerical solution will approach the true solution of $u_t + a u_x = 0$ as $\\Delta t, \\Delta x \\to 0$ (with fixed $\\lambda$).\n- Outside this region, the scheme is unstable ($|g(\\xi)| > 1$ for some $\\xi$). An unstable scheme cannot be convergent. Small errors (like round-off errors) will be amplified at each time step, leading to an exponential growth that completely overwhelms the true solution. Hence, the scheme is not convergent outside the stability region.\n\n**Determination of $\\Theta(\\lambda)$**\n\nThe problem asks for the function $\\Theta(\\lambda)$, defined as the infimum of the set of stabilizing parameters $\\theta \\in [0, 1]$ for a given $\\lambda$:\n$$\n\\Theta(\\lambda) = \\inf\\left\\{\\theta\\in[0,1]:\\; (\\lambda,\\theta)\\ \\text{is}\\ \\ell^{2}\\text{-stable}\\right\\}\n$$\nThis is to be determined for $|\\lambda| \\le 1$. From our stability analysis, for a fixed value of $\\lambda$ such that $|\\lambda| \\le 1$, the set of values of $\\theta$ that render the scheme stable is given by the inequality $\\lambda^2 \\le \\theta \\le 1$. The problem further constrains $\\theta$ to the interval $[0, 1]$. The intersection of these two conditions is simply the interval $[\\lambda^2, 1]$, since for $|\\lambda| \\le 1$, we have $0 \\le \\lambda^2 \\le 1$.\n\nSo, for a fixed $\\lambda$ with $|\\lambda| \\le 1$, the set of stable $\\theta$ values in $[0,1]$ is the closed interval $[\\lambda^2, 1]$. The infimum (greatest lower bound) of this set is its minimum value, which is the left endpoint of the interval.\n$$\n\\Theta(\\lambda) = \\inf[\\lambda^2, 1] = \\lambda^2\n$$\nThis function $\\Theta(\\lambda) = \\lambda^2$ represents the smallest amount of artificial viscosity (as parameterized by $\\theta$) that must be added to the unstable Forward-Time Central-Space scheme ($\\theta=0$) to achieve stability for a given Courant number $\\lambda$. Choosing $\\theta = \\lambda^2$ yields the Lax-Wendroff scheme, which is second-order accurate.", "answer": "$$\n\\boxed{\\lambda^2}\n$$", "id": "3455861"}]}