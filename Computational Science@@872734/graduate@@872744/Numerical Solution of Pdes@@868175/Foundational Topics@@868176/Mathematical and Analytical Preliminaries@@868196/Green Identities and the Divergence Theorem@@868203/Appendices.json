{"hands_on_practices": [{"introduction": "The divergence theorem is the cornerstone of vector calculus, linking the behavior of a vector field inside a volume to its flux across the boundary. This exercise provides a direct, hands-on verification of the theorem by requiring an explicit calculation of both the volume and surface integrals in a general $n$-dimensional setting. Completing this practice [@problem_id:3402021] solidifies the core concept and illustrates the principle of local conservation, which is fundamental to the construction of finite volume methods for partial differential equations.", "problem": "Consider the unit ball $B_{1}(0) \\subset \\mathbb{R}^{n}$ with $n \\geq 2$, its boundary $\\partial B_{1}(0) = \\mathbb{S}^{n-1}$, and the vector field $\\mathbf{F} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ defined by $\\mathbf{F}(x) = x$. Let $\\mathbf{n}$ denote the outward unit normal on $\\partial B_{1}(0)$. Starting from the definition of the divergence as the trace of the Jacobian and the divergence theorem, and using only well-established formulas for the volume of $B_{1}(0)$ and the surface area of $\\mathbb{S}^{n-1}$, compute the integrals $\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx$ and $\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$, and verify their equality by explicit evaluation. In the context of the numerical solution of Partial Differential Equations (PDE), interpret this equality as a consistency check for cell-wise flux balances in finite volume discretizations. Report the common value of the two integrals as a single closed-form analytic expression in terms of $n$. No rounding is required.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded, well-posed, and objective. It presents a standard exercise in vector calculus with a clear connection to the principles of numerical methods for partial differential equations. The problem is self-contained and free of contradictions or ambiguities.\n\nWe will now proceed with the solution by computing the two integrals separately and then verifying their equality.\n\nFirst, we compute the volume integral $\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx$.\nThe vector field is given by $\\mathbf{F}(x) = x$, which in Cartesian coordinates is $\\mathbf{F}(x_1, \\dots, x_n) = (x_1, \\dots, x_n)$. The components of $\\mathbf{F}$ are $F_i(x) = x_i$ for $i=1, \\dots, n$.\n\nThe divergence of $\\mathbf{F}$ is defined as the trace of its Jacobian matrix. The Jacobian matrix $J_{\\mathbf{F}}$ has entries $(J_{\\mathbf{F}})_{ij} = \\frac{\\partial F_i}{\\partial x_j}$. In this case, $\\frac{\\partial F_i}{\\partial x_j} = \\frac{\\partial x_i}{\\partial x_j} = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. The Jacobian is thus the $n \\times n$ identity matrix, $I_n$.\nThe divergence is the trace of the Jacobian:\n$$\n\\operatorname{div} \\mathbf{F} = \\operatorname{tr}(J_{\\mathbf{F}}) = \\sum_{i=1}^{n} \\frac{\\partial F_i}{\\partial x_i} = \\sum_{i=1}^{n} \\frac{\\partial x_i}{\\partial x_i} = \\sum_{i=1}^{n} 1 = n\n$$\nSince the divergence is a constant, the volume integral is straightforward to compute:\n$$\n\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx = \\int_{B_{1}(0)} n \\, dx = n \\int_{B_{1}(0)} 1 \\, dx = n \\cdot \\operatorname{Volume}(B_{1}(0))\n$$\nThe volume of an $n$-dimensional ball of radius $R$ is given by the formula $V_n(R) = \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)} R^n$. For the unit ball $B_{1}(0)$, we have $R=1$, so its volume is:\n$$\n\\operatorname{Volume}(B_{1}(0)) = V_n(1) = \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)}\n$$\nSubstituting this into our integral expression, we get:\n$$\n\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx = n \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)}\n$$\n\nNext, we compute the surface integral $\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$.\nThe boundary of the unit ball $B_1(0)$ is the unit sphere $\\mathbb{S}^{n-1} = \\{x \\in \\mathbb{R}^n : \\|x\\| = 1\\}$. For a sphere centered at the origin, the outward unit normal vector $\\mathbf{n}$ at a point $x$ on its surface is parallel to the position vector $x$. It is given by $\\mathbf{n} = \\frac{x}{\\|x\\|}$.\nSince our surface is the unit sphere, for any $x \\in \\mathbb{S}^{n-1}$, $\\|x\\|=1$. Thus, the outward unit normal is simply $\\mathbf{n} = x$.\n\nThe integrand is the dot product $\\mathbf{F} \\cdot \\mathbf{n}$. With $\\mathbf{F}(x)=x$ and $\\mathbf{n}=x$, we have:\n$$\n\\mathbf{F}(x) \\cdot \\mathbf{n}(x) = x \\cdot x = \\|x\\|^2\n$$\nAs we are integrating over the surface of the unit sphere, $\\|x\\|=1$ for all points on the surface. Therefore, the integrand is constant and equal to $1$:\n$$\n\\mathbf{F} \\cdot \\mathbf{n} = 1^2 = 1\n$$\nThe surface integral becomes:\n$$\n\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS = \\int_{\\mathbb{S}^{n-1}} 1 \\, dS = \\operatorname{Area}(\\mathbb{S}^{n-1})\n$$\nThis is the surface area of the $(n-1)$-dimensional unit sphere. The formula for the surface area of an $(n-1)$-sphere of radius $R$ is $A_{n-1}(R) = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}R^{n-1}$. For the unit sphere, $R=1$, so its area is:\n$$\n\\operatorname{Area}(\\mathbb{S}^{n-1}) = A_{n-1}(1) = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}\n$$\nThus, the value of the surface integral is:\n$$\n\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}\n$$\n\nAs stipulated by the divergence theorem, these two integrals must be equal. We now verify this by explicit evaluation of the expressions.\nThe volume integral result is $n \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)}$.\nThe surface integral result is $\\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}$.\nWe use the fundamental recurrence relation for the Gamma function, $\\Gamma(z+1)=z\\Gamma(z)$. Let $z = \\frac{n}{2}$. Then we have:\n$$\n\\Gamma\\left(\\frac{n}{2}+1\\right) = \\frac{n}{2} \\Gamma\\left(\\frac{n}{2}\\right)\n$$\nSubstituting this into the expression for the volume integral:\n$$\nn \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)} = n \\frac{\\pi^{n/2}}{\\frac{n}{2}\\Gamma(\\frac{n}{2})} = \\frac{n \\cdot 2}{n} \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2})} = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}\n$$\nThis result is identical to the value of the surface integral. The equality is therefore verified by direct computation. The common value of the two integrals is $\\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}$.\n\nIn the context of the numerical solution of PDEs, this equality is a manifestation of a fundamental conservation law. Finite volume methods are built upon the integral form of conservation laws. For a PDE of the form $\\frac{\\partial u}{\\partial t} + \\operatorname{div}\\mathbf{J} = s$, where $\\mathbf{J}$ is a flux vector and $s$ is a source term, integrating over a control volume (a cell) $\\Omega_i$ and applying the divergence theorem yields:\n$$\n\\frac{d}{dt}\\int_{\\Omega_i} u \\, dx + \\int_{\\partial \\Omega_i} \\mathbf{J} \\cdot \\mathbf{n} \\, dS = \\int_{\\Omega_i} s \\, dx\n$$\nThis equation states that the rate of change of the total amount of $u$ in the cell is balanced by the net flux of $\\mathbf{J}$ across the cell's boundary and the total source/sink activity within the cell.\nThe problem demonstrates this for a steady-state situation (no time dependence) where the vector field is $\\mathbf{F}$, the \"source\" term is $\\operatorname{div}\\mathbf{F}$, and the cell is the unit ball $B_1(0)$. The equality $\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx = \\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$ is the analytical expression of this exact balance. A finite volume discretization approximates the volume integral (source term) using values inside the cell and the surface integral (flux term) using values on the cell faces. The fact that these two forms are analytically equivalent is a crucial consistency condition. A robust numerical scheme must respect this property, ensuring that the discrete divergence operator and the discrete flux calculation are compatible. This cell-wise balance is what makes finite volume methods locally and globally conservative, a highly desirable property in simulations of physical transport phenomena. Verifying this identity for a simple case confirms the validity of the underlying principle before implementing a more complex numerical approximation.", "answer": "$$\n\\boxed{\\frac{2\\pi^{n/2}}{\\Gamma\\left(\\frac{n}{2}\\right)}}\n$$", "id": "3402021"}, {"introduction": "Building upon the divergence theorem, Green's identities provide powerful tools for analyzing solutions to PDEs. This practice explores a profound consequence of Green's second identity when applied to harmonic functions, for which the Laplacian $\\Delta u$ is zero. By working through the derivation [@problem_id:3402022], you will uncover a fundamental relationship between the boundary values of any two harmonic functions and their normal derivatives, demonstrating how these identities can reveal deep structural properties of solutions.", "problem": "Consider the three-dimensional ball $B_{R}(0) \\subset \\mathbb{R}^{3}$ of radius $R>0$ and its boundary $\\partial B_{R}(0)$. Let $u$ and $v$ be real-valued functions that are twice continuously differentiable on $\\overline{B_{R}(0)}$ and harmonic on $B_{R}(0)$, meaning $\\Delta u=0$ and $\\Delta v=0$ on $B_{R}(0)$, where $\\Delta$ denotes the Laplace operator. In the context of numerical methods for Partial Differential Equations (PDE), boundary integral formulations frequently use the divergence theorem to construct identities that relate fluxes and traces of solutions. Starting from the divergence theorem and the definition of the Laplace operator, derive the boundary integral identity that relates $\\int_{\\partial B_{R}(0)}(u\\,\\frac{\\partial v}{\\partial n}-v\\,\\frac{\\partial u}{\\partial n})\\,\\mathrm{d}S$ to a volume integral over $B_{R}(0)$, and then evaluate the boundary integral in the special case where\n$$\nu(x)=\\sum_{l=0}^{L}\\sum_{m=-l}^{l} a_{l m}\\,|x|^{l}\\,Y_{l}^{m}\\!\\left(\\frac{x}{|x|}\\right),\\qquad\nv(x)=\\sum_{l=0}^{L}\\sum_{m=-l}^{l} b_{l m}\\,|x|^{l}\\,Y_{l}^{m}\\!\\left(\\frac{x}{|x|}\\right),\n$$\nwith fixed integer $L\\geq 1$, real coefficients $a_{l m}$ and $b_{l m}$, and $\\{Y_{l}^{m}\\}_{l\\geq 0,\\,-l\\leq m\\leq l}$ the real spherical harmonics on the unit sphere $S^{2}$, orthonormal with respect to the surface measure $\\mathrm{d}\\omega$ on $S^{2}$, so that\n$$\n\\int_{S^{2}} Y_{l}^{m}(\\omega)\\,Y_{k}^{n}(\\omega)\\,\\mathrm{d}\\omega=\\delta_{l k}\\,\\delta_{m n}.\n$$\nHere $\\delta_{l k}$ denotes the Kronecker delta, $\\frac{\\partial}{\\partial n}$ is the outward normal derivative on $\\partial B_{R}(0)$, and $\\mathrm{d}S$ is the surface measure on $\\partial B_{R}(0)$. Your final result must be an exact expression. No rounding is required. Provide the exact value of\n$$\nI(R)=\\int_{\\partial B_{R}(0)}\\left(u\\,\\frac{\\partial v}{\\partial n}-v\\,\\frac{\\partial u}{\\partial n}\\right)\\,\\mathrm{d}S.\n$$", "solution": "The analysis of the problem will proceed in two stages. First, I will derive the general integral identity relating the specified boundary integral to a volume integral using the divergence theorem. This is known as Green's second identity. Second, I will apply this identity to the specific case of the harmonic functions $u$ and $v$ to evaluate the integral $I(R)$. The result will then be explicitly verified through direct computation of the boundary integral.\n\nLet $V$ be a compact region in $\\mathbb{R}^{3}$ with a piecewise smooth boundary $\\partial V$. Let $\\mathbf{F}$ be a continuously differentiable vector field on an open set containing $V$. The divergence theorem states:\n$$\n\\int_{V} (\\nabla \\cdot \\mathbf{F}) \\, \\mathrm{d}V = \\oint_{\\partial V} (\\mathbf{F} \\cdot \\mathbf{n}) \\, \\mathrm{d}S\n$$\nwhere $\\mathbf{n}$ is the outward unit normal on $\\partial V$.\n\nTo derive Green's identities, we choose a specific form for $\\mathbf{F}$ involving two scalar functions, say $\\phi$ and $\\psi$, which are assumed to be twice continuously differentiable on $V$. Let $\\mathbf{F} = \\phi \\nabla \\psi$. The components of this vector field are $F_i = \\phi \\frac{\\partial \\psi}{\\partial x_i}$.\n\nThe divergence of $\\mathbf{F}$ is given by the product rule:\n$$\n\\nabla \\cdot \\mathbf{F} = \\nabla \\cdot (\\phi \\nabla \\psi) = (\\nabla \\phi) \\cdot (\\nabla \\psi) + \\phi (\\nabla \\cdot \\nabla \\psi) = \\nabla \\phi \\cdot \\nabla \\psi + \\phi \\Delta \\psi\n$$\nThe term on the boundary becomes:\n$$\n\\mathbf{F} \\cdot \\mathbf{n} = (\\phi \\nabla \\psi) \\cdot \\mathbf{n} = \\phi (\\nabla \\psi \\cdot \\mathbf{n}) = \\phi \\frac{\\partial \\psi}{\\partial n}\n$$\nwhere $\\frac{\\partial \\psi}{\\partial n}$ is the directional derivative of $\\psi$ in the direction of the outward normal $\\mathbf{n}$.\n\nSubstituting these expressions into the divergence theorem yields Green's first identity:\n$$\n\\int_{V} (\\nabla \\phi \\cdot \\nabla \\psi + \\phi \\Delta \\psi) \\, \\mathrm{d}V = \\oint_{\\partial V} \\phi \\frac{\\partial \\psi}{\\partial n} \\, \\mathrm{d}S\n$$\nNow, we let $\\phi=u$ and $\\psi=v$, where $u$ and $v$ are the functions given in the problem statement. The identity becomes:\n$$\n\\int_{B_{R}(0)} (\\nabla u \\cdot \\nabla v + u \\Delta v) \\, \\mathrm{d}V = \\int_{\\partial B_{R}(0)} u \\frac{\\partial v}{\\partial n} \\, \\mathrm{d}S\n$$\nSince the identity holds for any pair of sufficiently smooth functions, we can interchange the roles of $u$ and $v$:\n$$\n\\int_{B_{R}(0)} (\\nabla v \\cdot \\nabla u + v \\Delta u) \\, \\mathrm{d}V = \\int_{\\partial B_{R}(0)} v \\frac{\\partial u}{\\partial n} \\, \\mathrm{d}S\n$$\nSubtracting the second of these equations from the first, and noting that the scalar product is symmetric ($\\nabla u \\cdot \\nabla v = \\nabla v \\cdot \\nabla u$), we obtain Green's second identity:\n$$\n\\int_{B_{R}(0)} (u \\Delta v - v \\Delta u) \\, \\mathrm{d}V = \\int_{\\partial B_{R}(0)} \\left(u \\frac{\\partial v}{\\partial n} - v \\frac{\\partial u}{\\partial n}\\right) \\, \\mathrm{d}S\n$$\nThis identity provides the requested relationship between the boundary integral $I(R)$ and a volume integral over the ball $B_{R}(0)$.\n\nNow, we proceed to the evaluation of the integral $I(R)$. The problem states that the functions $u$ and $v$ are harmonic on $B_{R}(0)$. By definition, a function is harmonic if its Laplacian is zero. Thus, we have:\n$$\n\\Delta u = 0 \\quad \\text{and} \\quad \\Delta v = 0 \\quad \\text{for all } x \\in B_{R}(0)\n$$\nThe explicit forms provided for $u$ and $v$ consist of linear combinations of solid harmonics, $r^{l}Y_{l}^{m}(\\omega)$, which are known to be harmonic functions, thereby satisfying this condition.\n\nSubstituting $\\Delta u = 0$ and $\\Delta v = 0$ into Green's second identity, the volume integral becomes:\n$$\n\\int_{B_{R}(0)} (u \\cdot 0 - v \\cdot 0) \\, \\mathrm{d}V = \\int_{B_{R}(0)} 0 \\, \\mathrm{d}V = 0\n$$\nTherefore, the value of the boundary integral is:\n$$\nI(R) = \\int_{\\partial B_{R}(0)} \\left(u \\frac{\\partial v}{\\partial n} - v \\frac{\\partial u}{\\partial n}\\right) \\, \\mathrm{d}S = 0\n$$\nThis result is a fundamental property of harmonic functions.\n\nFor completeness and as a rigorous verification, we can also evaluate the boundary integral directly using the given representations of $u$ and $v$.\nThe boundary $\\partial B_{R}(0)$ is the sphere of radius $R$. In spherical coordinates, a point $x$ on the boundary can be written as $x = R\\omega$, where $\\omega$ is a point on the unit sphere $S^2$. The surface measure is $\\mathrm{d}S = R^2 \\mathrm{d}\\omega$. The outward normal derivative is the radial derivative, $\\frac{\\partial}{\\partial n} = \\frac{\\partial}{\\partial r}$.\n\nLet us evaluate the functions and their normal derivatives on the boundary $|x|=r=R$.\n$$\nu(x)\\Big|_{r=R} = \\sum_{l=0}^{L}\\sum_{m=-l}^{l} a_{l m}\\,R^{l}\\,Y_{l}^{m}(\\omega)\n$$\n$$\nv(x)\\Big|_{r=R} = \\sum_{k=0}^{L}\\sum_{n=-k}^{k} b_{k n}\\,R^{k}\\,Y_{k}^{n}(\\omega)\n$$\n(We use different indices $(k,n)$ for $v$ to avoid confusion.)\nThe normal derivative of $u$ is:\n$$\n\\frac{\\partial u}{\\partial n} = \\frac{\\partial}{\\partial r} \\left( \\sum_{l=0}^{L}\\sum_{m=-l}^{l} a_{l m}\\,r^{l}\\,Y_{l}^{m}(\\omega) \\right) = \\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{l m}\\,l r^{l-1}\\,Y_{l}^{m}(\\omega)\n$$\nNote that the $l=0$ term is a constant and its derivative with respect to $r$ is zero. At $r=R$:\n$$\n\\frac{\\partial u}{\\partial n}\\Big|_{r=R} = \\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{l m}\\,l R^{l-1}\\,Y_{l}^{m}(\\omega)\n$$\nSimilarly, for $v$:\n$$\n\\frac{\\partial v}{\\partial n}\\Big|_{r=R} = \\sum_{k=1}^{L}\\sum_{n=-k}^{k} b_{k n}\\,k R^{k-1}\\,Y_{k}^{n}(\\omega)\n$$\nThe integral $I(R)$ is composed of two terms. Let's compute the integral of the first term, $u \\frac{\\partial v}{\\partial n}$:\n$$\n\\int_{\\partial B_{R}(0)} u\\,\\frac{\\partial v}{\\partial n}\\,\\mathrm{d}S = \\int_{S^2} \\left(\\sum_{l,m} a_{lm} R^l Y_l^m(\\omega)\\right) \\left(\\sum_{k,n} b_{kn} k R^{k-1} Y_k^n(\\omega)\\right) R^2\\,\\mathrm{d}\\omega\n$$\n$$\n= \\sum_{l,m}\\sum_{k,n} a_{lm} b_{kn} k R^{l+k+1} \\int_{S^2} Y_l^m(\\omega) Y_k^n(\\omega)\\,\\mathrm{d}\\omega\n$$\nUsing the orthonormality condition $\\int_{S^2} Y_{l}^{m}(\\omega)\\,Y_{k}^{n}(\\omega)\\,\\mathrm{d}\\omega=\\delta_{l k}\\,\\delta_{m n}$:\n$$\n= \\sum_{l,m}\\sum_{k,n} a_{lm} b_{kn} k R^{l+k+1} \\delta_{lk}\\delta_{mn}\n$$\nThe Kronecker deltas collapse the sum over $k$ and $n$, setting $k=l$ and $n=m$. The summation over $k$ from $1$ implies the resulting summation over $l$ also starts at $1$.\n$$\n= \\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{lm} b_{lm} l R^{l+l+1} = \\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{lm} b_{lm} l R^{2l+1}\n$$\nNow we compute the integral of the second term, $v \\frac{\\partial u}{\\partial n}$:\n$$\n\\int_{\\partial B_{R}(0)} v\\,\\frac{\\partial u}{\\partial n}\\,\\mathrm{d}S = \\int_{S^2} \\left(\\sum_{l,m} b_{lm} R^l Y_l^m(\\omega)\\right) \\left(\\sum_{k,n} a_{kn} k R^{k-1} Y_k^n(\\omega)\\right) R^2\\,\\mathrm{d}\\omega\n$$\n$$\n= \\sum_{l,m}\\sum_{k,n} b_{lm} a_{kn} k R^{l+k+1} \\int_{S^2} Y_l^m(\\omega) Y_k^n(\\omega)\\,\\mathrm{d}\\omega\n$$\n$$\n= \\sum_{l,m}\\sum_{k,n} b_{lm} a_{kn} k R^{l+k+1} \\delta_{lk}\\delta_{mn} = \\sum_{l=1}^{L}\\sum_{m=-l}^{l} b_{lm} a_{lm} l R^{2l+1}\n$$\nSince multiplication of coefficients is commutative ($a_{lm}b_{lm} = b_{lm}a_{lm}$), this expression is identical to the first.\nSubtracting the two terms to find $I(R)$:\n$$\nI(R) = \\left(\\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{lm} b_{lm} l R^{2l+1}\\right) - \\left(\\sum_{l=1}^{L}\\sum_{m=-l}^{l} b_{lm} a_{lm} l R^{2l+1}\\right) = 0\n$$\nThe direct evaluation confirms the result obtained from applying Green's second identity. The value of the integral is zero.", "answer": "$$\n\\boxed{0}\n$$", "id": "3402022"}, {"introduction": "Moving from theory to application, this final practice demonstrates how Green's identities are used to construct powerful numerical solvers. You will use Green's third identity to derive and implement the Boundary Element Method (BEM) for the Laplace equation, exploring both single-layer and double-layer potential formulations. This advanced computational exercise [@problem_id:3402011] provides critical insight into how different but theoretically equivalent approaches can lead to vastly different numerical stability, a crucial lesson in the practical design of robust algorithms for solving PDEs.", "problem": "Consider the two-dimensional Laplace equation for a scalar field $u$ satisfying $\\Delta u = 0$ in a bounded, multiply connected domain. Let $\\Omega \\subset \\mathbb{R}^2$ be the interior of an outer circle of radius $R_0$ centered at the origin, with two circular holes removed. Each hole is a circle of radius $r$ centered at $(\\pm c, 0)$, where $c = r + g/2$ and $g &gt; 0$ is the gap between the holes. The boundary of $\\Omega$ is the disjoint union $\\Gamma = \\Gamma_0 \\cup \\Gamma_1 \\cup \\Gamma_2$, where $\\Gamma_0$ is the outer boundary and $\\Gamma_1, \\Gamma_2$ are the boundaries of the two holes. Assume $\\Gamma_0$ is oriented counterclockwise and $\\Gamma_1, \\Gamma_2$ are oriented clockwise so that the unit normal $\\mathbf{n}$ always points outward from $\\Omega$. The task is to use Green’s third identity and the divergence theorem to derive boundary integral formulations for harmonic interpolation, then build a computational scheme to solve the interior Dirichlet problem, and finally study the stability of single- versus double-layer formulations as the holes approach touching.\n\nFundamental base:\n- The Laplace equation $\\Delta u = 0$ in $\\Omega$ with Dirichlet boundary condition $u = g$ on $\\Gamma$ has a unique solution, provided $g$ is continuous. \n- The free-space Green’s function for the Laplace operator in two dimensions is $G(\\mathbf{x}, \\mathbf{y}) = -\\dfrac{1}{2\\pi} \\log \\|\\mathbf{x} - \\mathbf{y}\\|$.\n- Green’s third identity states that for $\\mathbf{x} \\in \\Omega$ and $u$ harmonic in $\\Omega$ with sufficient smoothness,\n$$\nu(\\mathbf{x}) = \\int_{\\Gamma} \\left( \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} u(\\mathbf{y}) - G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u}{\\partial n}(\\mathbf{y}) \\right) \\, ds(\\mathbf{y}).\n$$\n- The single-layer potential and double-layer potential are defined by\n$$\n(\\mathcal{S}\\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, ds(\\mathbf{y}), \\quad\n(\\mathcal{D}\\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mu(\\mathbf{y}) \\, ds(\\mathbf{y}),\n$$\nwith boundary traces (taken from the interior of $\\Omega$) given by\n$$\n\\gamma^{-} \\mathcal{S} \\sigma = S \\sigma \\quad \\text{(continuous)}, \\qquad\n\\gamma^{-} \\mathcal{D} \\mu = \\left( \\frac{1}{2} I + K \\right) \\mu,\n$$\nwhere the boundary integral operators $S$ and $K$ have kernels\n$$\nS(\\mathbf{x}, \\mathbf{y}) = G(\\mathbf{x}, \\mathbf{y}), \\qquad\nK(\\mathbf{x}, \\mathbf{y}) = \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} = \\frac{1}{2\\pi} \\frac{\\mathbf{n}(\\mathbf{y}) \\cdot (\\mathbf{x} - \\mathbf{y})}{\\|\\mathbf{x} - \\mathbf{y}\\|^2}.\n$$\n\nProblem:\n1. Using only the fundamental definitions above and the divergence theorem, derive the boundary integral equations for the interior Dirichlet problem in $\\Omega$ with prescribed boundary data $u = g$ on $\\Gamma$, using:\n   - A single-layer representation $u = \\mathcal{S}\\sigma$ leading to a first-kind boundary integral equation $S \\sigma = g$ on $\\Gamma$.\n   - A double-layer representation $u = \\mathcal{D}\\mu$ leading to a second-kind boundary integral equation $\\left(\\dfrac{1}{2} I + K\\right) \\mu = g$ on $\\Gamma$.\n   Justify why both formulations are valid and discuss the expected differences in numerical stability (conditioning) between first-kind and second-kind integral equations, especially as boundaries approach each other.\n\n2. Develop a numerical scheme based on Nyström discretization using a periodic trapezoid rule on parametric circles to solve for the unknown boundary densities $\\sigma$ and $\\mu$ respectively. Let angles be measured in radians. To make the scheme robust yet simple, apply a small local regularization to the logarithmic kernel by replacing $\\|\\mathbf{x} - \\mathbf{y}\\|$ with $\\sqrt{\\|\\mathbf{x} - \\mathbf{y}\\|^2 + \\varepsilon^2}$ in the logarithm and the inverse-square denominator, where $\\varepsilon$ is chosen as half the local arc-length spacing on each boundary component. Explicitly state all the parameterizations, unit normals, and quadrature weights you use.\n\n3. Choose the harmonic “truth” field to be the real part of $z^3$, namely\n$$\nu^{\\star}(x, y) = \\operatorname{Re}\\{(x + i y)^3\\} = x^3 - 3 x y^2,\n$$\nwhich is harmonic in all of $\\mathbb{R}^2$. Use this to set Dirichlet data $g = u^{\\star}$ on all boundary components. After solving the boundary integral equations, interpolate the harmonic solution inside $\\Omega$ by evaluating the layer potentials at specified target points, and report the relative $\\ell^2$ error compared to $u^{\\star}$ over the target set.\n\n4. Stability study: For increasing geometric difficulty as the two inner boundaries approach each other, compute the spectral condition number (ratio of largest to smallest singular value in the $\\ell^2$ norm) of the discrete system matrices for both formulations. Discuss how the conditioning changes with the gap $g$ and compare single-layer versus double-layer.\n\nImplementation details to be followed exactly:\n- Geometry: Use $R_0 = 1$ for the outer boundary. Use $r = 0.2$ for both inner boundaries. For a given gap $g$, set $c = r + g/2$ and centers $(\\pm c, 0)$. \n- Boundary discretization: Use $N_0 = 160$ quadrature nodes on $\\Gamma_0$ (outer circle), and $N_1 = N_2 = 80$ nodes on each inner circle. Use uniform angles $\\theta \\in [0, 2\\pi)$.\n- Normals: Take outward normals from $\\Omega$. For the outer boundary point at angle $\\theta$, use $\\mathbf{n}_0(\\theta) = (\\cos \\theta, \\sin \\theta)$. For an inner boundary point at angle $\\theta$ on a hole centered at $(\\pm c, 0)$, use $\\mathbf{n}_{\\text{inner}}(\\theta) = -(\\cos \\theta, \\sin \\theta)$.\n- Quadrature weights: On a circle of radius $R$, the arc-length element is $ds = R \\, d\\theta$. Use trapezoid weights $w = R \\cdot \\dfrac{2\\pi}{N}$.\n- Kernel regularization: Replace $\\|\\mathbf{x} - \\mathbf{y}\\|$ by $\\sqrt{\\|\\mathbf{x} - \\mathbf{y}\\|^2 + \\varepsilon^2}$ inside the logarithm and inverse-square denominators; let $\\varepsilon$ for a source node be one-half of its local arc-length spacing.\n- Interior targets for error estimation: Use the set of nine points\n$$\n\\{(0, y): y \\in \\{-0.75, -0.5, -0.25, 0, 0.25, 0.5, 0.75\\}\\} \\cup \\{(0.5, 0.5), (-0.5, 0.5)\\}.\n$$\nThese points must lie inside $\\Omega$ for all test cases below.\n\nTest suite:\n- Use the three gaps $g \\in \\{0.3, 0.1, 0.03\\}$.\n- For each $g$, solve and evaluate both formulations: single-layer (denoted \"single\") and double-layer (denoted \"double\").\n- For each case, compute:\n  1. The spectral condition number of the system matrix.\n  2. The relative $\\ell^2$ error of the interpolated solution versus $u^{\\star}$ at the nine target points.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the pair $[\\text{condition number}, \\text{relative error}]$ for one test case, ordered as:\n  - $(g=0.3, \\text{single})$, $(g=0.3, \\text{double})$, $(g=0.1, \\text{single})$, $(g=0.1, \\text{double})$, $(g=0.03, \\text{single})$, $(g=0.03, \\text{double})$.\n- Each pair must be a list of two floats. For example, an output of the right format is:\n  - [[cond_03_single,err_03_single],[cond_03_double,err_03_double],...,[cond_003_double,err_003_double]]\nNo physical units are involved. All angles must be in radians. The code must be a complete, runnable program that does not require user input and respects the specified execution environment. The numerical scheme must be directly implemented from the principles and definitions stated above without citing or using any pre-derived shortcut quadrature formulas beyond the trapezoid rule and the stated regularization.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the theory of partial differential equations and potential theory, well-posed, objective, and provides a complete and consistent set of definitions and parameters for a numerical experiment. We may proceed with the solution.\n\n### Part 1: Derivation of Boundary Integral Equations and Stability\n\nThe goal is to solve the Laplace equation $\\Delta u = 0$ in a domain $\\Omega \\subset \\mathbb{R}^2$ with a prescribed Dirichlet boundary condition $u = g$ on the boundary $\\Gamma = \\partial \\Omega$.\n\n**Single-Layer Formulation:**\nWe seek a solution in the form of a single-layer potential,\n$$\nu(\\mathbf{x}) = (\\mathcal{S}\\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\sigma(\\mathbf{y}) \\, ds(\\mathbf{y})\n$$\nwhere $\\sigma(\\mathbf{y})$ is an unknown density function defined on the boundary $\\Gamma$. The potential $u(\\mathbf{x})$ defined this way is harmonic in $\\Omega$ for any integrable density $\\sigma$. To satisfy the boundary condition, we must enforce $u(\\mathbf{x}) \\to g(\\mathbf{x})$ as $\\mathbf{x} \\in \\Omega$ approaches the boundary $\\Gamma$.\n\nThe single-layer potential $\\mathcal{S}\\sigma$ is known to be continuous across the boundary $\\Gamma$. Therefore, taking the limit of $u(\\mathbf{x})$ as $\\mathbf{x} \\to \\mathbf{z} \\in \\Gamma$ from the interior of $\\Omega$ yields:\n$$\n\\gamma^{-} u(\\mathbf{z}) = \\gamma^{-} (\\mathcal{S}\\sigma)(\\mathbf{z}) = (S\\sigma)(\\mathbf{z})\n$$\nwhere $S$ is the boundary integral operator with the kernel $S(\\mathbf{z}, \\mathbf{y}) = G(\\mathbf{z}, \\mathbf{y})$. Enforcing the Dirichlet condition $u=g$ on $\\Gamma$ leads to the boundary integral equation (BIE) for the unknown density $\\sigma$:\n$$\n(S\\sigma)(\\mathbf{z}) = g(\\mathbf{z}), \\quad \\mathbf{z} \\in \\Gamma.\n$$\nThis is a Fredholm integral equation of the first kind.\n\n**Double-Layer Formulation:**\nAlternatively, we seek a solution in the form of a double-layer potential,\n$$\nu(\\mathbf{x}) = (\\mathcal{D}\\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} \\mu(\\mathbf{y}) \\, ds(\\mathbf{y})\n$$\nwhere $\\mu(\\mathbf{y})$ is the unknown density function. This potential is also harmonic in $\\Omega$. Unlike the single-layer potential, the double-layer potential has a jump discontinuity across the boundary. The provided trace formula for the limit from the interior is:\n$$\n\\gamma^{-} u(\\mathbf{z}) = \\gamma^{-} (\\mathcal{D}\\mu)(\\mathbf{z}) = \\left( \\frac{1}{2} I + K \\right) \\mu (\\mathbf{z})\n$$\nwhere $I$ is the identity operator and $K$ is the boundary integral operator with kernel $K(\\mathbf{z}, \\mathbf{y}) = \\frac{\\partial G(\\mathbf{z}, \\mathbf{y})}{\\partial n(\\mathbf{y})}$. To satisfy the Dirichlet condition $u=g$, we set the interior trace equal to $g$:\n$$\n\\left( \\frac{1}{2} I + K \\right) \\mu (\\mathbf{z}) = g(\\mathbf{z}), \\quad \\mathbf{z} \\in \\Gamma.\n$$\nThis is a Fredholm integral equation of the second kind.\n\n**Discussion on Numerical Stability:**\nFredholm integral equations of the first kind, such as $S\\sigma = g$, are often ill-posed. The operator $S$, with its logarithmic kernel, is a compact operator on typical function spaces (e.g., $L^2(\\Gamma)$). For a compact operator, the singular values of its discrete representation tend to cluster at zero. This means the matrix inverse is unstable, leading to a large condition number that typically grows with the refinement of the discretization. Physically, $S$ is a smoothing operator, and recovering the possibly non-smooth density $\\sigma$ from the smooth data $g$ is an unstable process.\n\nIn contrast, Fredholm integral equations of the second kind, $(A+T)\\phi=f$ where $T$ is compact and $A$ is invertible (here $A=\\frac{1}{2}I$), are generally well-posed. The operator $(\\frac{1}{2}I + K)$ has eigenvalues that are shifted away from zero by the identity component. For the interior Dirichlet problem, it is known that $-\\frac{1}{2}$ is not in the spectrum of $K$, which guarantees that the operator is invertible and the problem is well-posed. The resulting linear systems are typically well-conditioned.\n\nWhen boundaries approach each other (as the gap $g \\to 0$), the kernels $S(\\mathbf{x}, \\mathbf{y})$ and $K(\\mathbf{x}, \\mathbf{y})$ become nearly singular for points $\\mathbf{x}$ and $\\mathbf{y}$ on opposing boundaries. This typically degrades the conditioning of the matrices for both formulations. However, the effect is expected to be far more severe for the first-kind equation, whose condition number should grow much more rapidly than that of the second-kind equation.\n\n### Part 2: Numerical Scheme - Nyström Discretization\n\nWe discretize the boundary $\\Gamma$ into a set of $N$ nodes $\\{\\mathbf{x}_j\\}_{j=1}^N$. The total boundary is $\\Gamma = \\Gamma_0 \\cup \\Gamma_1 \\cup \\Gamma_2$, discretized with $N_0$, $N_1$, and $N_2$ points, respectively, such that $N = N_0 + N_1 + N_2$.\n\n**Boundary Parametrization and Quadrature:**\n- Outer circle $\\Gamma_0$: radius $R_0 = 1$, center $(0,0)$. For $j=1, \\dots, N_0$:\n  $$ \\theta_j = \\frac{2\\pi j}{N_0}, \\quad \\mathbf{x}_j = (R_0 \\cos \\theta_j, R_0 \\sin \\theta_j), \\quad \\mathbf{n}_j = (\\cos \\theta_j, \\sin \\theta_j) $$\n  The quadrature weights are $w_j = R_0 \\frac{2\\pi}{N_0}$.\n- Inner circle $\\Gamma_1$: radius $r=0.2$, center $(c, 0)$, where $c=r+g/2$. For $j=1, \\dots, N_1$:\n  $$ \\theta_j = \\frac{2\\pi j}{N_1}, \\quad \\mathbf{x}_{N_0+j} = (c + r \\cos \\theta_j, r \\sin \\theta_j), \\quad \\mathbf{n}_{N_0+j} = -(\\cos \\theta_j, \\sin \\theta_j) $$\n  The quadrature weights are $w_{N_0+j} = r \\frac{2\\pi}{N_1}$.\n- Inner circle $\\Gamma_2$: radius $r=0.2$, center $(-c, 0)$. For $j=1, \\dots, N_2$:\n  $$ \\theta_j = \\frac{2\\pi j}{N_2}, \\quad \\mathbf{x}_{N_0+N_1+j} = (-c + r \\cos \\theta_j, r \\sin \\theta_j), \\quad \\mathbf{n}_{N_0+N_1+j} = -(\\cos \\theta_j, \\sin \\theta_j) $$\n  The quadrature weights are $w_{N_0+N_1+j} = r \\frac{2\\pi}{N_2}$.\n\nThe integral equations are approximated by linear systems using the Nyström method with a periodic trapezoid rule. An integral $\\int_\\Gamma f(\\mathbf{y}) ds(\\mathbf{y})$ is approximated by $\\sum_{j=1}^N f(\\mathbf{x}_j) w_j$.\n\n**Matrix Assembly:**\nLet $\\{\\mathbf{x}_i\\}_{i=1}^N$ be the set of all $N$ boundary nodes.\n\n- **Single-layer matrix ($S$):** The equation $S\\sigma=g$ becomes the linear system $\\mathbf{S}\\boldsymbol{\\sigma} = \\mathbf{g}$, where $\\boldsymbol{\\sigma}$ is the vector of density values $\\sigma(\\mathbf{x}_j)$ and $\\mathbf{g}$ is the vector of boundary data $g(\\mathbf{x}_i)$. The matrix entries are:\n  $$ S_{ij} = G_{\\text{reg}}(\\mathbf{x}_i, \\mathbf{x}_j) w_j $$\n  where the regularized Green's function is $G_{\\text{reg}}(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi} \\log \\sqrt{\\|\\mathbf{x}-\\mathbf{y}\\|^2 + \\varepsilon_j^2}$. The regularization parameter $\\varepsilon_j$ depends on the source point $\\mathbf{x}_j$ and is set to half the arc-length spacing: $\\varepsilon_j = w_j/2$. When $i=j$, $\\|\\mathbf{x}_i - \\mathbf{x}_j\\|=0$, and the entry is $S_{ii} = -\\frac{1}{2\\pi} \\log(\\varepsilon_i) w_i$.\n\n- **Double-layer matrix ($\\frac{1}{2}I+K$):** The equation $(\\frac{1}{2}I+K)\\mu=g$ becomes the system $\\mathbf{A}\\boldsymbol{\\mu}=\\mathbf{g}$. The matrix $\\mathbf{A}$ has entries:\n  $$ A_{ij} = \\frac{1}{2}\\delta_{ij} + K_{\\text{reg}}(\\mathbf{x}_i, \\mathbf{x}_j) w_j $$\n  where $\\delta_{ij}$ is the Kronecker delta. The regularized kernel is\n  $$ K_{\\text{reg}}(\\mathbf{x}_i, \\mathbf{x}_j) = \\frac{1}{2\\pi} \\frac{\\mathbf{n}_j \\cdot (\\mathbf{x}_i - \\mathbf{x}_j)}{\\|\\mathbf{x}_i - \\mathbf{x}_j\\|^2 + \\varepsilon_j^2} $$\n  For the diagonal entries ($i=j$), the numerator $\\mathbf{n}_j \\cdot (\\mathbf{x}_j - \\mathbf{x}_j) = 0$, so $K_{\\text{reg}}(\\mathbf{x}_j, \\mathbf{x}_j)=0$. This simplifies the diagonal matrix entries to $A_{jj} = \\frac{1}{2}$.\n\n### Part 3: Solution Evaluation and Error Analysis\n\nOnce the linear system is solved for the density vector ($\\boldsymbol{\\sigma}$ or $\\boldsymbol{\\mu}$), the solution $u$ at any interior target point $\\mathbf{z}$ can be found by evaluating the corresponding discretized potential.\n\n- **Single-layer interpolation:**\n  $$ u(\\mathbf{z}) \\approx \\sum_{j=1}^N G(\\mathbf{z}, \\mathbf{x}_j) \\sigma_j w_j $$\n- **Double-layer interpolation:**\n  $$ u(\\mathbf{z}) \\approx \\sum_{j=1}^N \\frac{\\partial G(\\mathbf{z}, \\mathbf{x}_j)}{\\partial n(\\mathbf{x}_j)} \\mu_j w_j $$\nNote that for interior targets $\\mathbf{z}$, $\\|\\mathbf{z}-\\mathbf{x}_j\\| \\neq 0$, so no regularization is needed for the kernels.\n\nThe accuracy of the numerical solution is assessed by comparing it to the known \"truth\" solution $u^{\\star}(x, y) = x^3 - 3 x y^2$ at a set of interior target points $\\{\\mathbf{z}_k\\}_{k=1}^M$. The relative $\\ell^2$ error is computed as:\n$$\n\\text{Error} = \\frac{\\sqrt{\\sum_{k=1}^M |u(\\mathbf{z}_k) - u^{\\star}(\\mathbf{z}_k)|^2}}{\\sqrt{\\sum_{k=1}^M |u^{\\star}(\\mathbf{z}_k)|^2}}\n$$\n\n### Part 4: Stability Analysis\n\nThe stability of the discrete systems is measured by the spectral condition number of the system matrices, $\\text{cond}(\\mathbf{A}) = \\|\\mathbf{A}\\|_2 \\|\\mathbf{A}^{-1}\\|_2$. This is the ratio of the largest to the smallest singular value of the matrix $\\mathbf{A}$. A large condition number indicates that the solution is highly sensitive to perturbations in the input data, signaling numerical instability. We will compute this for both the single-layer matrix $\\mathbf{S}$ and the double-layer matrix $\\mathbf{A} = \\frac{1}{2}\\mathbf{I} + \\mathbf{K}$ for different values of the gap $g$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 2D Laplace BIE problem for a multiply connected domain,\n    analyzes conditioning and error for single- and double-layer formulations.\n    \"\"\"\n    \n    # --- Problem Parameters ---\n    R0 = 1.0\n    r = 0.2\n    N0 = 160\n    N1 = 80\n    N2 = 80\n    N_total = N0 + N1 + N2\n    gaps = [0.3, 0.1, 0.03]\n    \n    target_points = np.array([\n        [0.0, -0.75], [0.0, -0.5], [0.0, -0.25], [0.0, 0.0],\n        [0.0, 0.25], [0.0, 0.5], [0.0, 0.75],\n        [0.5, 0.5], [-0.5, 0.5]\n    ])\n\n    results = []\n\n    def u_star(x, y):\n        \"\"\"Analytical solution u*(x,y) = Re(z^3).\"\"\"\n        return x**3 - 3 * x * y**2\n\n    u_star_targets = u_star(target_points[:, 0], target_points[:, 1])\n    norm_u_star = np.linalg.norm(u_star_targets)\n\n    for g in gaps:\n        c = r + g / 2.0\n        \n        # --- Generate Boundary Nodes and Quadrature ---\n        nodes = np.zeros((N_total, 2))\n        normals = np.zeros((N_total, 2))\n        weights = np.zeros(N_total)\n        \n        # Gamma_0 (outer circle)\n        theta0 = 2 * np.pi * np.arange(N0) / N0\n        nodes[:N0, 0] = R0 * np.cos(theta0)\n        nodes[:N0, 1] = R0 * np.sin(theta0)\n        normals[:N0, 0] = np.cos(theta0)\n        normals[:N0, 1] = np.sin(theta0)\n        weights[:N0] = R0 * 2 * np.pi / N0\n\n        # Gamma_1 (inner circle 1)\n        start_idx, end_idx = N0, N0 + N1\n        theta1 = 2 * np.pi * np.arange(N1) / N1\n        nodes[start_idx:end_idx, 0] = c + r * np.cos(theta1)\n        nodes[start_idx:end_idx, 1] = r * np.sin(theta1)\n        normals[start_idx:end_idx, 0] = -np.cos(theta1)\n        normals[start_idx:end_idx, 1] = -np.sin(theta1)\n        weights[start_idx:end_idx] = r * 2 * np.pi / N1\n\n        # Gamma_2 (inner circle 2)\n        start_idx, end_idx = N0 + N1, N_total\n        theta2 = 2 * np.pi * np.arange(N2) / N2\n        nodes[start_idx:end_idx, 0] = -c + r * np.cos(theta2)\n        nodes[start_idx:end_idx, 1] = r * np.sin(theta2)\n        normals[start_idx:end_idx, 0] = -np.cos(theta2)\n        normals[start_idx:end_idx, 1] = -np.sin(theta2)\n        weights[start_idx:end_idx] = r * 2 * np.pi / N2\n\n        epsilons = weights / 2.0\n        \n        # RHS vector from boundary data\n        g_vec = u_star(nodes[:, 0], nodes[:, 1])\n\n        # --- Assemble matrices ---\n        # diffs(i, j, k) = nodes(i, k) - nodes(j, k)\n        diffs = nodes[:, np.newaxis, :] - nodes[np.newaxis, :, :]\n        dist_sq = np.sum(diffs**2, axis=2)\n        \n        # Regularization term for source points j\n        reg_dist_sq = dist_sq + epsilons[np.newaxis, :]**2\n        \n        # Kernel matrices (weighted)\n        # G(xi, yj) matrix entries\n        S_kernel_vals = (-1.0 / (2.0 * np.pi)) * 0.5 * np.log(reg_dist_sq)\n        S_matrix = S_kernel_vals * weights[np.newaxis, :]\n        \n        # dG/dn(xi, yj) matrix entries\n        n_dot_diff = np.sum(diffs * normals[np.newaxis, :, :], axis=2)\n        K_kernel_vals = (1.0 / (2.0 * np.pi)) * n_dot_diff / reg_dist_sq\n        # Diagonal K_ii should be zero due to numertor n_i . (x_i-x_i) = 0\n        np.fill_diagonal(K_kernel_vals, 0)\n        K_matrix_weighted = K_kernel_vals * weights[np.newaxis, :]\n        \n        A_double_layer = 0.5 * np.identity(N_total) + K_matrix_weighted\n        A_single_layer = S_matrix\n\n        # --- Interpolation Kernels (Target points to Boundary source points) ---\n        diffs_interp = target_points[:, np.newaxis, :] - nodes[np.newaxis, :, :]\n        dist_sq_interp = np.sum(diffs_interp**2, axis=2)\n        \n        S_interp_kernel = (-1.0 / (2.0 * np.pi)) * 0.5 * np.log(dist_sq_interp)\n        \n        n_dot_diff_interp = np.sum(diffs_interp * normals[np.newaxis, :, :], axis=2)\n        K_interp_kernel = (1.0 / (2.0 * np.pi)) * n_dot_diff_interp / dist_sq_interp\n\n        # --- SINGLE-LAYER ---\n        formulation = \"single\"\n        # Solve for density\n        sigma = np.linalg.solve(A_single_layer, g_vec)\n        # Compute condition number\n        cond_single = np.linalg.cond(A_single_layer)\n        # Interpolate solution\n        u_computed_single = (S_interp_kernel * weights[np.newaxis, :]) @ sigma\n        # Compute error\n        error_single = np.linalg.norm(u_computed_single - u_star_targets) / norm_u_star\n        results.append([cond_single, error_single])\n        \n        # --- DOUBLE-LAYER ---\n        formulation = \"double\"\n        # Solve for density\n        mu = np.linalg.solve(A_double_layer, g_vec)\n        # Compute condition number\n        cond_double = np.linalg.cond(A_double_layer)\n        # Interpolate solution\n        u_computed_double = (K_interp_kernel * weights[np.newaxis, :]) @ mu\n        # Compute error\n        error_double = np.linalg.norm(u_computed_double - u_star_targets) / norm_u_star\n        results.append([cond_double, error_double])\n            \n    # Final print statement\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3402011"}]}