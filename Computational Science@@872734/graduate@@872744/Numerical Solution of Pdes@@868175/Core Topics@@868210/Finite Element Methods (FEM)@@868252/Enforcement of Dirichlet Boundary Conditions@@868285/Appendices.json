{"hands_on_practices": [{"introduction": "A primary challenge in applying the finite element method is handling non-homogeneous Dirichlet boundary conditions. One of the most elegant theoretical approaches is the method of \"lifting,\" where the solution is decomposed into a known part satisfying the boundary data and an unknown part with zero on the boundary. This exercise provides fundamental practice in this technique, requiring you to derive the modified weak form and compute the resulting changes to the system's load vector, bridging the gap between abstract theory and concrete calculation. [@problem_id:3385201]", "problem": "Consider the second-order scalar diffusion problem on the interval $\\Omega=(0,1)$ with inhomogeneous Dirichlet boundary data. The strong form is: find $u:\\Omega\\to\\mathbb{R}$ such that\n$$\n-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)=f(x)\\quad\\text{in }\\Omega,\\qquad u(0)=\\alpha,\\quad u(1)=\\beta,\n$$\nwhere $\\kappa:\\Omega\\to\\mathbb{R}$ is the spatially varying diffusivity, $f:\\Omega\\to\\mathbb{R}$ is the source, and $\\alpha,\\beta\\in\\mathbb{R}$ are prescribed boundary values. Work in the Sobolev space $H^{1}(\\Omega)$ and its subspace $H_{0}^{1}(\\Omega)$ of functions with vanishing trace at the boundary. The weak formulation is defined by the bilinear form $a(u,v)=\\int_{0}^{1}\\kappa(x)\\,u'(x)\\,v'(x)\\,dx$ and the linear form $\\ell(v)=\\int_{0}^{1}f(x)\\,v(x)\\,dx$. To enforce Dirichlet boundary conditions via lifting, let $L(g)\\in H^{1}(\\Omega)$ be any function whose trace coincides with the boundary data $g=\\{\\alpha,\\beta\\}$, and define $\\tilde{u}=u-L(g)\\in H_{0}^{1}(\\Omega)$. Starting from the strong form and the definition of weak solutions, and using only integration by parts and the fundamental properties of Sobolev spaces and traces, derive the lifted weak problem in $H_{0}^{1}(\\Omega)$, i.e., a variational problem of the form: find $\\tilde{u}\\in H_{0}^{1}(\\Omega)$ such that\n$$\na(\\tilde{u},v)=\\ell(v)-a(L(g),v)\\quad\\text{for all }v\\in H_{0}^{1}(\\Omega).\n$$\n\nThen, instantiate the data as follows: take $\\kappa(x)=1+x$, $f(x)=\\sin(\\pi x)$, $\\alpha=\\frac{1}{2}$, $\\beta=-\\frac{1}{2}$, and choose the lifting to be the affine function $L(g)(x)=\\alpha(1-x)+\\beta x$. Discretize with continuous, piecewise-linear finite elements on the uniform mesh with $N=4$ equal subintervals of $\\Omega$, i.e., with mesh size $h=\\frac{1}{4}$ and nodes $x_{j}=j h$ for $j\\in\\{0,1,2,3,4\\}$. Let $\\varphi_{2}$ be the standard hat basis function associated with the interior node at $x=\\frac{1}{2}$, i.e.,\n$$\n\\varphi_{2}(x)=\\begin{cases}\n4x-1,& x\\in\\left[\\frac{1}{4},\\frac{1}{2}\\right],\\\\\n3-4x,& x\\in\\left[\\frac{1}{2},\\frac{3}{4}\\right],\\\\\n0,& \\text{otherwise,}\n\\end{cases}\n\\quad\\text{and}\\quad\n\\varphi_{2}'(x)=\\begin{cases}\n4,& x\\in\\left(\\frac{1}{4},\\frac{1}{2}\\right),\\\\\n-4,& x\\in\\left(\\frac{1}{2},\\frac{3}{4}\\right),\\\\\n0,& \\text{otherwise.}\n\\end{cases}\n$$\n\nUsing your derived lifted weak form and the above data, compute the scalar entry of the modified right-hand side corresponding to $\\varphi_{2}$, namely\n$$\nb_{2}\\;=\\;\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx\\;-\\;\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx,\n$$\nwith all trigonometric functions evaluated in radians. Provide your final answer as a single exact closed-form expression. Do not round your result.", "solution": "We begin from the strong form $-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)=f(x)$ in $\\Omega=(0,1)$ with Dirichlet boundary conditions $u(0)=\\alpha$, $u(1)=\\beta$. Let $v\\in H_{0}^{1}(\\Omega)$ be an arbitrary test function with vanishing trace at the boundary. Multiply the strong form by $v$ and integrate over $\\Omega$:\n$$\n\\int_{0}^{1}\\left(-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)\\right)v(x)\\,dx=\\int_{0}^{1}f(x)\\,v(x)\\,dx.\n$$\nUse integration by parts in the sense of distributions. Since $v\\in H_{0}^{1}(\\Omega)$ has zero trace at $x=0$ and $x=1$, the boundary term vanishes and we obtain\n$$\n\\int_{0}^{1}\\kappa(x)\\,u'(x)\\,v'(x)\\,dx=\\int_{0}^{1}f(x)\\,v(x)\\,dx.\n$$\nDefine the bilinear form $a(u,v)=\\int_{0}^{1}\\kappa(x)\\,u'(x)\\,v'(x)\\,dx$ and the linear functional $\\ell(v)=\\int_{0}^{1}f(x)\\,v(x)\\,dx$. Then the weak formulation with inhomogeneous Dirichlet data is: find $u\\in H^{1}(\\Omega)$ with trace $u|_{\\partial\\Omega}=g$ such that\n$$\na(u,v)=\\ell(v)\\quad\\text{for all }v\\in H_{0}^{1}(\\Omega).\n$$\n\nTo enforce the Dirichlet conditions via lifting, choose a lifting $L(g)\\in H^{1}(\\Omega)$ with $L(g)|_{\\partial\\Omega}=g$, and write $u=\\tilde{u}+L(g)$ with $\\tilde{u}\\in H_{0}^{1}(\\Omega)$. Substitute into the weak form to get\n$$\na(\\tilde{u}+L(g),v)=\\ell(v)\\quad\\text{for all }v\\in H_{0}^{1}(\\Omega).\n$$\nUsing bilinearity of $a(\\cdot,\\cdot)$, this becomes\n$$\na(\\tilde{u},v)+a(L(g),v)=\\ell(v)\\quad\\text{for all }v\\in H_{0}^{1}(\\Omega),\n$$\nor equivalently,\n$$\na(\\tilde{u},v)=\\ell(v)-a(L(g),v)\\quad\\text{for all }v\\in H_{0}^{1}(\\Omega).\n$$\nThis is the lifted weak problem in $H_{0}^{1}(\\Omega)$.\n\nNext, we instantiate the data. Take $\\kappa(x)=1+x$, $f(x)=\\sin(\\pi x)$, $\\alpha=\\frac{1}{2}$, $\\beta=-\\frac{1}{2}$. Choose the affine lifting\n$$\nL(g)(x)=\\alpha(1-x)+\\beta x=\\frac{1}{2}-x,\n$$\nso that $L'(g)(x)=-1$ for all $x\\in(0,1)$.\n\nOn the uniform mesh with $N=4$ subintervals, the node locations are $x_{j}=j h$ with $h=\\frac{1}{4}$. The hat basis function $\\varphi_{2}$ associated with the interior node at $x=\\frac{1}{2}$ has support on $\\left[\\frac{1}{4},\\frac{3}{4}\\right]$ and is given by\n$$\n\\varphi_{2}(x)=\\begin{cases}\n4x-1,& x\\in\\left[\\frac{1}{4},\\frac{1}{2}\\right],\\\\\n3-4x,& x\\in\\left[\\frac{1}{2},\\frac{3}{4}\\right],\\\\\n0,& \\text{otherwise,}\n\\end{cases}\n\\quad\n\\varphi_{2}'(x)=\\begin{cases}\n4,& x\\in\\left(\\frac{1}{4},\\frac{1}{2}\\right),\\\\\n-4,& x\\in\\left(\\frac{1}{2},\\frac{3}{4}\\right),\\\\\n0,& \\text{otherwise.}\n\\end{cases}\n$$\n\nWe must compute\n$$\nb_{2}=\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx-\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx.\n$$\nWe evaluate the two integrals separately.\n\nFirst, compute the lifting contribution. Since $L'(g)(x)=-1$ and $\\kappa(x)=1+x$,\n$$\n\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx=-\\int_{0}^{1}(1+x)\\,\\varphi_{2}'(x)\\,dx\n=-\\int_{\\frac{1}{4}}^{\\frac{3}{4}}(1+x)\\,\\varphi_{2}'(x)\\,dx.\n$$\nSplit over the two elements supporting $\\varphi_{2}'$:\n$$\n\\int_{\\frac{1}{4}}^{\\frac{3}{4}}(1+x)\\,\\varphi_{2}'(x)\\,dx\n=\\int_{\\frac{1}{4}}^{\\frac{1}{2}}(1+x)\\cdot 4\\,dx+\\int_{\\frac{1}{2}}^{\\frac{3}{4}}(1+x)\\cdot(-4)\\,dx.\n$$\nCompute the antiderivative $\\int (1+x)\\,dx = x+\\frac{x^{2}}{2}$. Then\n$$\n\\int_{\\frac{1}{4}}^{\\frac{1}{2}}(1+x)\\,dx=\\left[x+\\frac{x^{2}}{2}\\right]_{\\frac{1}{4}}^{\\frac{1}{2}}=\\frac{11}{32},\\qquad\n\\int_{\\frac{1}{2}}^{\\frac{3}{4}}(1+x)\\,dx=\\left[x+\\frac{x^{2}}{2}\\right]_{\\frac{1}{2}}^{\\frac{3}{4}}=\\frac{13}{32}.\n$$\nTherefore,\n$$\n\\int_{\\frac{1}{4}}^{\\frac{3}{4}}(1+x)\\,\\varphi_{2}'(x)\\,dx=4\\cdot\\frac{11}{32}-4\\cdot\\frac{13}{32}=-\\frac{1}{4},\n$$\nand thus\n$$\n\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx=-\\left(-\\frac{1}{4}\\right)=\\frac{1}{4}.\n$$\n\nSecond, compute the source contribution\n$$\n\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx=\\int_{\\frac{1}{4}}^{\\frac{1}{2}}\\sin(\\pi x)\\,(4x-1)\\,dx+\\int_{\\frac{1}{2}}^{\\frac{3}{4}}\\sin(\\pi x)\\,(3-4x)\\,dx.\n$$\nUse the antiderivatives\n$$\n\\int \\sin(\\pi x)\\,dx=-\\frac{\\cos(\\pi x)}{\\pi},\\qquad\n\\int x\\,\\sin(\\pi x)\\,dx=-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}.\n$$\nFor the first subinterval,\n$$\n\\int_{\\frac{1}{4}}^{\\frac{1}{2}}\\sin(\\pi x)\\,(4x-1)\\,dx\n=4\\left[-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}\\right]_{\\frac{1}{4}}^{\\frac{1}{2}}\n-\\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{\\frac{1}{4}}^{\\frac{1}{2}}.\n$$\nEvaluating at $x=\\frac{1}{2}$ and $x=\\frac{1}{4}$, using $\\cos\\!\\left(\\frac{\\pi}{2}\\right)=0$, $\\sin\\!\\left(\\frac{\\pi}{2}\\right)=1$, $\\cos\\!\\left(\\frac{\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$, $\\sin\\!\\left(\\frac{\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$, yields\n$$\n\\int_{\\frac{1}{4}}^{\\frac{1}{2}}\\sin(\\pi x)\\,(4x-1)\\,dx=\\frac{4-2\\sqrt{2}}{\\pi^{2}}.\n$$\nFor the second subinterval,\n$$\n\\int_{\\frac{1}{2}}^{\\frac{3}{4}}\\sin(\\pi x)\\,(3-4x)\\,dx\n=3\\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{\\frac{1}{2}}^{\\frac{3}{4}}\n-4\\left[-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}\\right]_{\\frac{1}{2}}^{\\frac{3}{4}},\n$$\nand using $\\cos\\!\\left(\\frac{3\\pi}{4}\\right)=-\\frac{\\sqrt{2}}{2}$, $\\sin\\!\\left(\\frac{3\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$ together with the previous values, we obtain\n$$\n\\int_{\\frac{1}{2}}^{\\frac{3}{4}}\\sin(\\pi x)\\,(3-4x)\\,dx=\\frac{4-2\\sqrt{2}}{\\pi^{2}}.\n$$\nTherefore,\n$$\n\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx=\\frac{8-4\\sqrt{2}}{\\pi^{2}}=\\frac{4(2-\\sqrt{2})}{\\pi^{2}}.\n$$\n\nAssembling the modified right-hand side entry,\n$$\nb_{2}=\\int_{0}^{1}f(x)\\,\\varphi_{2}(x)\\,dx-\\int_{0}^{1}\\kappa(x)\\,L'(g)(x)\\,\\varphi_{2}'(x)\\,dx\n=\\frac{4(2-\\sqrt{2})}{\\pi^{2}}-\\frac{1}{4}.\n$$\nThis is an exact closed-form expression, as required.", "answer": "$$\\boxed{\\frac{4\\left(2-\\sqrt{2}\\right)}{\\pi^{2}}-\\frac{1}{4}}$$", "id": "3385201"}, {"introduction": "While lifting is a powerful theoretical tool, many finite element software packages implement strong Dirichlet conditions through direct algebraic manipulation of the final linear system. This practice walks you through this common procedure, known as static condensation, where known boundary values are eliminated from the system of equations. By assembling the global matrices and then partitioning them to solve for the interior unknowns, you will gain a practical understanding of how boundary conditions are enforced in computational practice. [@problem_id:3385241]", "problem": "Consider the one-dimensional Poisson partial differential equation (PDE) $-u''(x)=1$ on the interval $[0,1]$ with essential (Dirichlet) boundary conditions $u(0)=0$ and $u(1)=1$. Starting from the standard weak form, use the finite element method (FEM) with continuous, piecewise-linear basis functions on the mesh with nodes at $x_0=0$, $x_1=\\frac{1}{2}$, and $x_2=1$. Let the global basis functions be $\\phi_0$, $\\phi_1$, and $\\phi_2$ associated to nodes $x_0$, $x_1$, and $x_2$, respectively, and let the global coefficient vector of degrees of freedom (DOF) be $U=(u_0,u_1,u_2)^{\\top}$.\n\nUsing only the weak form and the canonical Galerkin procedure, assemble the global stiffness matrix $K$ with entries $K_{ij}=\\int_{0}^{1}\\phi_i'(x)\\,\\phi_j'(x)\\,\\mathrm{d}x$ and the global load vector $F$ with entries $F_i=\\int_{0}^{1}\\phi_i(x)\\,\\mathrm{d}x$. Then, define the interior index set $I=\\{1\\}$ and the boundary index set $B=\\{0,2\\}$, and describe the algebraic partitioning of the linear system into blocks corresponding to $I$ and $B$. Enforce the Dirichlet boundary values $u_0=0$ and $u_2=1$ by static condensation (elimination of boundary DOF through substitution), and derive the reduced equation governing the interior unknown $u_1$ with its modified right-hand side.\n\nFinally, compute the exact value of the interior DOF $u_1$. Express your final answer as an exact fraction.", "solution": "The problem starts with the one-dimensional Poisson equation:\n$$ -u''(x) = 1, \\quad x \\in [0, 1] $$\nwith Dirichlet boundary conditions $u(0)=0$ and $u(1)=1$.\n\nTo derive the weak form, we multiply the PDE by a test function $v(x)$ from a suitable space (here, $H_0^1(0,1)$, meaning $v(0)=v(1)=0$) and integrate over the domain:\n$$ -\\int_{0}^{1} u''(x) v(x) \\, \\mathrm{d}x = \\int_{0}^{1} 1 \\cdot v(x) \\, \\mathrm{d}x $$\nApplying integration by parts to the left-hand side term $\\int u''v = [u'v] - \\int u'v'$:\n$$ -[u'(x)v(x)]_{0}^{1} + \\int_{0}^{1} u'(x) v'(x) \\, \\mathrm{d}x = \\int_{0}^{1} v(x) \\, \\mathrm{d}x $$\nSince the test function $v(x)$ vanishes at the boundaries $x=0$ and $x=1$, the boundary term $[u'(x)v(x)]_{0}^{1}$ is zero. The weak form is: Find $u(x)$ satisfying the Dirichlet boundary conditions such that for all valid test functions $v(x)$:\n$$ \\int_{0}^{1} u'(x) v'(x) \\, \\mathrm{d}x = \\int_{0}^{1} v(x) \\, \\mathrm{d}x $$\nIn the finite element method, we seek an approximate solution $u_h(x)$ in a finite-dimensional subspace spanned by basis functions $\\phi_j(x)$. The solution is expressed as a linear combination of these basis functions:\n$$ u_h(x) = \\sum_{j=0}^{2} U_j \\phi_j(x) $$\nwhere $U_j = u_h(x_j)$ are the nodal values or degrees of freedom (DOF). The Galerkin method uses the basis functions $\\phi_i(x)$ as test functions, i.e., $v(x) = \\phi_i(x)$. Substituting these into the weak form yields a system of linear equations $KU=F$:\n$$ \\sum_{j=0}^{2} \\left( \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\, \\mathrm{d}x \\right) U_j = \\int_{0}^{1} 1 \\cdot \\phi_i(x) \\, \\mathrm{d}x, \\quad \\text{for } i=0, 1, 2 $$\nThe entries of the stiffness matrix $K$ and load vector $F$ are given by:\n$$ K_{ij} = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\, \\mathrm{d}x $$\n$$ F_i = \\int_{0}^{1} \\phi_i(x) \\, \\mathrm{d}x $$\nThe mesh nodes are $x_0=0$, $x_1=\\frac{1}{2}$, and $x_2=1$. The mesh consists of two elements of length $h=\\frac{1}{2}$. The continuous, piecewise-linear basis functions $\\phi_i(x)$ are defined such that $\\phi_i(x_j) = \\delta_{ij}$ (the Kronecker delta). Their explicit forms and derivatives are:\n\nFor $x \\in [0, \\frac{1}{2}]$:\n$\\phi_0(x) = 1-2x, \\quad \\phi_0'(x) = -2$\n$\\phi_1(x) = 2x, \\quad \\phi_1'(x) = 2$\n$\\phi_2(x) = 0, \\quad \\phi_2'(x) = 0$\n\nFor $x \\in [\\frac{1}{2}, 1]$:\n$\\phi_0(x) = 0, \\quad \\phi_0'(x) = 0$\n$\\phi_1(x) = 2-2x, \\quad \\phi_1'(x) = -2$\n$\\phi_2(x) = 2x-1, \\quad \\phi_2'(x) = 2$\n\nNow we assemble the $3 \\times 3$ global stiffness matrix $K$. Due to the compact support of the basis functions, many entries are zero.\n$K_{00} = \\int_{0}^{1/2} (-2)^2 \\, \\mathrm{d}x = 4 \\cdot \\frac{1}{2} = 2$\n$K_{11} = \\int_{0}^{1/2} (2)^2 \\, \\mathrm{d}x + \\int_{1/2}^{1} (-2)^2 \\, \\mathrm{d}x = 4 \\cdot \\frac{1}{2} + 4 \\cdot \\frac{1}{2} = 4$\n$K_{22} = \\int_{1/2}^{1} (2)^2 \\, \\mathrm{d}x = 4 \\cdot \\frac{1}{2} = 2$\n$K_{01} = K_{10} = \\int_{0}^{1/2} (-2)(2) \\, \\mathrm{d}x = -4 \\cdot \\frac{1}{2} = -2$\n$K_{12} = K_{21} = \\int_{1/2}^{1} (-2)(2) \\, \\mathrm{d}x = -4 \\cdot \\frac{1}{2} = -2$\n$K_{02} = K_{20} = \\int_{0}^{1} \\phi_0'(x)\\phi_2'(x) \\, \\mathrm{d}x = 0$ (disjoint support)\n\nSo, the global stiffness matrix is:\n$$ K = \\begin{pmatrix} 2 & -2 & 0 \\\\ -2 & 4 & -2 \\\\ 0 & -2 & 2 \\end{pmatrix} $$\nNext, we assemble the global load vector $F$:\n$F_0 = \\int_{0}^{1} \\phi_0(x) \\, \\mathrm{d}x = \\int_{0}^{1/2} (1-2x) \\, \\mathrm{d}x = \\left[x - x^2\\right]_0^{1/2} = \\frac{1}{2} - \\frac{1}{4} = \\frac{1}{4}$\n$F_1 = \\int_{0}^{1} \\phi_1(x) \\, \\mathrm{d}x = \\int_{0}^{1/2} 2x \\, \\mathrm{d}x + \\int_{1/2}^{1} (2-2x) \\, \\mathrm{d}x = \\left[x^2\\right]_0^{1/2} + \\left[2x - x^2\\right]_{1/2}^{1} = \\frac{1}{4} + \\left((2-1) - (1-\\frac{1}{4})\\right) = \\frac{1}{4} + \\left(1 - \\frac{3}{4}\\right) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$\n$F_2 = \\int_{0}^{1} \\phi_2(x) \\, \\mathrm{d}x = \\int_{1/2}^{1} (2x-1) \\, \\mathrm{d}x = \\left[x^2 - x\\right]_{1/2}^{1} = (1-1) - (\\frac{1}{4}-\\frac{1}{2}) = 0 - (-\\frac{1}{4}) = \\frac{1}{4}$\n\nThe global load vector is:\n$$ F = \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 1/4 \\end{pmatrix} $$\nThe full linear system $KU=F$ is:\n$$ \\begin{pmatrix} 2 & -2 & 0 \\\\ -2 & 4 & -2 \\\\ 0 & -2 & 2 \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ 1/2 \\\\ 1/4 \\end{pmatrix} $$\nWe now partition the system according to the interior indices $I=\\{1\\}$ and boundary indices $B=\\{0, 2\\}$. Let $U_I = u_1$ be the vector of unknown interior DOFs and $U_B = (u_0, u_2)^{\\top}$ be the vector of known boundary DOFs. The system can be written in block form:\n$$ \\begin{pmatrix} K_{II} & K_{IB} \\\\ K_{BI} & K_{BB} \\end{pmatrix} \\begin{pmatrix} U_I \\\\ U_B \\end{pmatrix} = \\begin{pmatrix} F_I \\\\ F_B \\end{pmatrix} $$\nBy rearranging the original system according to the ordering $(1, 0, 2)$, we identify the blocks:\n$U_I = (u_1)$, $U_B = \\begin{pmatrix} u_0 \\\\ u_2 \\end{pmatrix}$\n$F_I = (F_1) = (\\frac{1}{2})$, $F_B = \\begin{pmatrix} F_0 \\\\ F_2 \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ 1/4 \\end{pmatrix}$\n$K_{II} = (K_{11}) = (4)$\n$K_{IB} = (K_{10} \\ K_{12}) = (-2 \\ -2)$\n$K_{BI} = \\begin{pmatrix} K_{01} \\\\ K_{21} \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -2 \\end{pmatrix}$\n$K_{BB} = \\begin{pmatrix} K_{00} & K_{02} \\\\ K_{20} & K_{22} \\end{pmatrix} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}$\n\nThe first block row of the partitioned system gives the equation for the interior unknowns:\n$$ K_{II} U_I + K_{IB} U_B = F_I $$\nTo enforce the Dirichlet boundary conditions, we use the known values $u_0=0$ and $u_2=1$ to form vector $U_B = (0, 1)^{\\top}$. We can then solve for $U_I$:\n$$ K_{II} U_I = F_I - K_{IB} U_B $$\nThis is the static condensation procedure. The term $-K_{IB}U_B$ represents the modification to the right-hand side due to the non-homogeneous Dirichlet boundary conditions.\nSubstituting the values:\n$$ (4) (u_1) = \\left(\\frac{1}{2}\\right) - (-2 \\ -2) \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\nFirst, compute the product on the right-hand side:\n$$ (-2 \\ -2) \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = (-2)(0) + (-2)(1) = -2 $$\nNow substitute this back into the equation for $u_1$:\n$$ 4 u_1 = \\frac{1}{2} - (-2) $$\n$$ 4 u_1 = \\frac{1}{2} + 2 $$\n$$ 4 u_1 = \\frac{1}{2} + \\frac{4}{2} = \\frac{5}{2} $$\nFinally, solving for $u_1$:\n$$ u_1 = \\frac{5/2}{4} = \\frac{5}{8} $$", "answer": "$$\\boxed{\\frac{5}{8}}$$", "id": "3385241"}, {"introduction": "Beyond the strong enforcement methods, a powerful and flexible alternative is to impose boundary conditions weakly, incorporating them directly into the variational formulation. Nitsche's method is a preeminent example, using carefully chosen penalty and consistency terms to enforce the boundary constraint in an average sense. This hands-on coding exercise allows you to explore the structure of Nitsche's method and investigate a key practical issue: the sensitivity of the solution to geometric errors, such as approximating a curved boundary with a polygon. [@problem_id:3385212]", "problem": "Consider the Poisson problem with homogeneous Dirichlet boundary conditions on a planar domain $\\Omega \\subset \\mathbb{R}^2$: find $u$ such that $-\\Delta u = f$ in $\\Omega$ and $u=0$ on $\\partial \\Omega$. Let the exact solution be $u(x,y) = 1 - x^2 - y^2$, so that $f(x,y) = 4$. The continuous energy associated with this problem is the integral of the squared gradient, $\\int_{\\Omega} \\lvert \\nabla u \\rvert^2 \\, dx$, and for the unit disk $\\Omega = \\{(x,y) : x^2 + y^2 \\le 1\\}$ this energy can be evaluated analytically.\n\nWe seek to evaluate discrete energy identities emerging from the Symmetric Interior Penalty Galerkin (SIPG) method combined with Nitsche boundary enforcement for Dirichlet conditions. Symmetric Interior Penalty Galerkin (SIPG) refers to the interior penalty discontinuous Galerkin discretization with symmetric consistency terms across faces. Nitsche boundary enforcement is a method to impose Dirichlet conditions weakly using consistent symmetric terms and a penalty term.\n\nLet $\\mathcal{T}_h$ be a triangulation of $\\Omega$. Define the broken gradient $\\nabla_h$, the jump and average operators on interior faces, and for boundary faces incorporate Nitsche terms with penalty coefficient $\\gamma_e = \\alpha/h_e$, where $h_e$ is the face length and $\\alpha > 0$ is a scalar. Consider the SIPG bilinear form $a_h(\\cdot,\\cdot)$ with symmetric consistency across interior faces and symmetric Nitsche consistency on boundary faces. For a sufficiently smooth $u$, when computing $a_h(u,u)$, interior jump terms vanish due to continuity of $u$ across element boundaries, and only the volume contribution and the Nitsche boundary terms remain. Specifically, the discrete energy is the bilinear form $a_h(u,u)$ evaluated using symmetric consistency on $\\partial \\Omega$, wherein the boundary contribution has two parts: the symmetric consistency terms involving normal derivatives and the penalty term.\n\nIn this task, you must:\n- Construct a triangulation of $\\Omega$ as follows.\n  1. For the exact circular boundary case, take $\\Omega$ as the unit disk. Use the known analytical continuous energy $\\int_{\\Omega} \\lvert \\nabla u \\rvert^2 \\, dx$ for $u(x,y)=1-x^2-y^2$ on the unit disk.\n  2. For curved-boundary approximation sensitivity, approximate the disk by a regular $N$-gon inscribed in the unit circle with vertices on $\\partial \\Omega$, and triangulate by connecting the center $(0,0)$ to each consecutive pair of vertices, forming $N$ triangles. This generates a mesh $\\mathcal{T}_h$ on the polygonal domain $\\Omega_N$.\n- Implement quadrature to approximate all integrals:\n  - For volume integrals over each triangle $K \\in \\mathcal{T}_h$, apply a degree-two exact triangle quadrature rule to approximate $\\int_{K} \\lvert \\nabla u \\rvert^2 \\, dx$. The integrand $\\lvert \\nabla u \\rvert^2 = 4(x^2+y^2)$ is a quadratic polynomial.\n  - For boundary integrals along each polygon edge $e$, apply two-point Gaussâ€“Legendre quadrature on the segment to approximate the line integrals. Use the outward unit normal $\\boldsymbol{n}_e$ of the segment, consistent with convexity of the polygon and the origin being in the interior. On the boundary segment, approximate the Nitsche boundary contribution for $v=u$ as\n    $$\\int_{e} \\left( \\frac{\\gamma_e}{1} u^2 - 2 \\, \\partial_{\\boldsymbol{n}} u \\, u \\right) \\, ds,$$\n    where $\\partial_{\\boldsymbol{n}} u = \\nabla u \\cdot \\boldsymbol{n}_e$ and $\\gamma_e = \\alpha / h_e$ with $h_e$ the segment length. In the symmetric formulation, the signs of the two consistency terms are identical and contribute $-2\\int_{e}\\partial_{\\boldsymbol{n}}u \\, u \\, ds$ when $v=u$.\n- Define the discrete energy $E_{\\text{disc}} = \\sum_{K \\in \\mathcal{T}_h} \\int_{K} \\lvert \\nabla u \\rvert^2 \\, dx + \\sum_{e \\subset \\partial \\Omega_h} \\int_{e} \\left( \\frac{\\gamma_e}{1} u^2 - 2 \\, \\partial_{\\boldsymbol{n}} u \\, u \\right) \\, ds$, where $\\Omega_h$ denotes the computational domain (either the exact disk or its polygonal approximation).\n- Define the continuous energy $E_{\\text{cont}} = \\int_{\\Omega_h} \\lvert \\nabla u \\rvert^2 \\, dx$. Note that when $\\Omega_h$ is the exact unit disk and $u=0$ on $\\partial \\Omega_h$, the Nitsche boundary terms vanish and the discrete energy equals the continuous energy. When $\\Omega_h$ is a polygonal approximation, $u$ does not vanish on $\\partial \\Omega_h$; the discrete energy will deviate from the continuous energy, and the deviation depends on the penalty and the geometry.\n- Evaluate the energy mismatch $\\Delta = E_{\\text{disc}} - E_{\\text{cont}}$ for the following test suite:\n  1. Exact circular boundary case with symmetric Nitsche consistency and penalty parameter $\\alpha=10$.\n  2. Inscribed $N$-gon with $N=8$ and $\\alpha=10$.\n  3. Inscribed $N$-gon with $N=8$ and $\\alpha=100$.\n  4. Inscribed $N$-gon with $N=64$ and $\\alpha=10$.\n\nYour program must:\n- Use $u(x,y)=1-x^2-y^2$ and $\\nabla u(x,y)=(-2x,-2y)$.\n- For the exact circle case, use the analytic continuous energy value $\\int_{\\Omega} \\lvert \\nabla u \\rvert^2 \\, dx = 2\\pi$.\n- For polygonal cases, compute both $E_{\\text{cont}}$ and $E_{\\text{disc}}$ numerically via the specified quadrature and report the mismatch $\\Delta$.\n- Choose the symmetric Nitsche consistency terms and the penalty $\\gamma_e=\\alpha/h_e$ so that for the exact circular boundary the discrete energy matches the continuous energy.\n- Test sensitivity to curved boundary approximation via the mismatches for the polygonal cases and penalty scaling.\n- Produce a single line of output containing the four mismatches as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). These values must be floats. No units are involved in this problem, and angles are implicit from the geometry and need no separate specification.\n\nYour code must be self-contained, run without input, and adhere to the execution environment details specified in the final answer section. The quadrature rules must be implemented explicitly within the program.", "solution": "The problem requires the evaluation of the energy mismatch, $\\Delta$, that arises from approximating a continuous problem with a numerical scheme based on the Symmetric Interior Penalty Galerkin (SIPG) method, which incorporates Nitsche's method for weakly enforcing Dirichlet boundary conditions.\n\nThe underlying continuous problem is the Poisson equation on a planar domain $\\Omega \\subset \\mathbb{R}^2$:\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \\quad u = 0 \\quad \\text{on } \\partial\\Omega.\n$$\nThe exact solution is given as $u(x,y) = 1 - x^2 - y^2$, which implies the source term is $f(x,y) = -\\Delta(1 - x^2 - y^2) = 4$. The gradient of the solution is $\\nabla u(x,y) = (-2x, -2y)$. This solution satisfies $u=0$ on the boundary of the unit disk, $\\partial\\Omega = \\{(x,y) : x^2 + y^2 = 1\\}$.\n\nThe continuous energy of the system is defined as:\n$$\nE_{\\text{cont}} = \\int_{\\Omega_h} \\lvert \\nabla u \\rvert^2 \\, d\\boldsymbol{x}\n$$\nwhere $\\Omega_h$ is the computational domain, which is either the exact unit disk or a polygonal approximation. For the unit disk, this energy can be calculated analytically:\n$$\n\\int_{x^2+y^2 \\le 1} 4(x^2+y^2) \\, dx dy = \\int_0^{2\\pi} \\int_0^1 4r^2 \\cdot r \\, dr d\\theta = 2\\pi [r^4]_0^1 = 2\\pi.\n$$\n\nThe discrete energy, derived from the SIPG bilinear form $a_h(u,u)$ for a sufficiently smooth function $u$, is given by:\n$$\nE_{\\text{disc}} = \\sum_{K \\in \\mathcal{T}_h} \\int_{K} \\lvert \\nabla u \\rvert^2 \\, d\\boldsymbol{x} + \\sum_{e \\subset \\partial\\Omega_h} \\int_{e} \\left( \\gamma_e u^2 - 2 (\\nabla u \\cdot \\boldsymbol{n}_e) u \\right) \\, ds\n$$\nwhere $\\mathcal{T}_h$ is a triangulation of $\\Omega_h$, $\\boldsymbol{n}_e$ is the outward unit normal to a boundary edge $e$, and $\\gamma_e = \\alpha/h_e$ is the Nitsche penalty parameter, with $h_e$ being the length of the edge $e$.\n\nThe energy mismatch, $\\Delta$, is the difference between the discrete and continuous energies:\n$$\n\\Delta = E_{\\text{disc}} - E_{\\text{cont}} = \\left( \\sum_{K \\in \\mathcal{T}_h} \\int_{K} \\lvert \\nabla u \\rvert^2 \\, d\\boldsymbol{x} + \\sum_{e \\subset \\partial\\Omega_h} \\int_{e} (\\dots) \\, ds \\right) - \\int_{\\Omega_h} \\lvert \\nabla u \\rvert^2 \\, d\\boldsymbol{x}\n$$\nSince $\\int_{\\Omega_h} \\lvert \\nabla u \\rvert^2 \\, d\\boldsymbol{x} = \\sum_{K \\in \\mathcal{T}_h} \\int_{K} \\lvert \\nabla u \\rvert^2 \\, d\\boldsymbol{x}$, the mismatch simplifies to the sum of the boundary integrals:\n$$\n\\Delta = \\sum_{e \\subset \\partial\\Omega_h} \\int_{e} \\left( \\gamma_e u^2 - 2 (\\nabla u \\cdot \\boldsymbol{n}_e) u \\right) \\, ds\n$$\nWe evaluate this mismatch for the specified test cases.\n\n**Case 1: Exact Circular Boundary ($\\Omega_h$ is the unit disk), $\\alpha=10$**\nOn the boundary of the unit disk, $x^2+y^2=1$. The given solution $u(x,y)=1-x^2-y^2$ is identically zero. The integrand of the boundary term, $\\gamma_e u^2 - 2 (\\nabla u \\cdot \\boldsymbol{n}_e) u$, is thus zero at every point on the boundary. Consequently, the integral and the total mismatch are zero.\n$$\n\\Delta = 0\n$$\n\n**Cases 2, 3, 4: Inscribed $N$-gon Boundary ($\\Omega_N$)**\nFor these cases, the domain is a regular $N$-gon inscribed in the unit circle. The vertices are $V_k = (\\cos(2\\pi k/N), \\sin(2\\pi k/N))$ for $k = 0, \\dots, N-1$. The boundary $\\partial\\Omega_N$ consists of $N$ straight line segments. On these segments, $x^2+y^2 < 1$, so $u(x,y) > 0$, and the boundary integral is non-zero.\n\nBy symmetry, the contribution to $\\Delta$ from each of the $N$ boundary edges is identical. We can compute the integral over one edge, $e_0$, connecting $V_0=(1,0)$ to $V_1=(\\cos(2\\pi/N), \\sin(2\\pi/N))$, and multiply the result by $N$.\n\nFor this edge $e_0$:\n- The length is $h_e = \\|V_1 - V_0\\| = 2\\sin(\\pi/N)$.\n- The penalty parameter is $\\gamma_e = \\alpha / h_e$.\n- The outward unit normal vector $\\boldsymbol{n}_e$ is constant along the edge and given by $\\boldsymbol{n}_e = (\\cos(\\pi/N), \\sin(\\pi/N))$.\n- A crucial simplification occurs for the normal derivative term. For any point $(x,y)$ on this edge, the relation $x\\cos(\\pi/N) + y\\sin(\\pi/N) = \\cos(\\pi/N)$ holds. The term $\\nabla u \\cdot \\boldsymbol{n}_e$ becomes:\n$$\n\\nabla u \\cdot \\boldsymbol{n}_e = (-2x, -2y) \\cdot (\\cos(\\pi/N), \\sin(\\pi/N)) = -2(x\\cos(\\pi/N) + y\\sin(\\pi/N)) = -2\\cos(\\pi/N)\n$$\nThis term is constant along the edge.\n\nThe integral over edge $e_0$ is approximated using a two-point Gauss-Legendre quadrature rule. Let $\\xi \\in [-1,1]$ be the coordinate on the reference interval. The quadrature points are $\\xi_{1,2} = \\mp 1/\\sqrt{3}$ with weights $w_{1,2}=1$. A point on the edge is parameterized as $\\boldsymbol{p}(\\xi) = \\frac{V_0+V_1}{2} + \\xi \\frac{V_1-V_0}{2}$. The differential line element is $ds = \\frac{h_e}{2}d\\xi$. The integral over one edge is:\n$$\n\\int_{e_0} (\\dots) \\, ds \\approx \\frac{h_e}{2} \\sum_{i=1}^2 w_i \\left[ \\gamma_e (u(\\boldsymbol{p}(\\xi_i)))^2 - 2 u(\\boldsymbol{p}(\\xi_i)) (-2\\cos(\\pi/N)) \\right]\n$$\nThe total mismatch is $\\Delta = N \\times \\text{the value of this integral}$. This procedure is implemented for each polygonal test case ($N=8, \\alpha=10$; $N=8, \\alpha=100$; $N=64, \\alpha=10$).", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It calculates the energy mismatch for different domain approximations and parameters.\n    \"\"\"\n\n    def u_func(x, y):\n        \"\"\"The exact solution u(x,y).\"\"\"\n        return 1.0 - x**2 - y**2\n\n    def compute_mismatch(num_sides, penalty_alpha):\n        \"\"\"\n        Computes the energy mismatch Delta for a given domain and penalty parameter.\n\n        The mismatch Delta is the boundary integral contribution from the Nitsche method:\n        Delta = sum_{e in partial_Omega_h} integral_{e} (gamma_e * u^2 - 2 * u * (grad_u . n_e)) ds\n\n        Args:\n            num_sides (int or None): The number of sides of the regular polygon.\n                                     If None, it signifies the exact circular boundary.\n            penalty_alpha (float): The scalar penalty parameter alpha.\n\n        Returns:\n            float: The calculated energy mismatch Delta.\n        \"\"\"\n        # Case 1: Exact circular boundary\n        if num_sides is None:\n            # On the unit circle boundary, u(x,y) = 1 - (x^2 + y^2) = 1 - 1 = 0.\n            # The boundary integral term is therefore identically zero.\n            return 0.0\n\n        # Cases 2-4: Inscribed N-gon approximation\n        # By symmetry, we calculate the integral over one edge and multiply by num_sides.\n        # We choose the edge from V0 = (1, 0) to V1 = (cos(2*pi/N), sin(2*pi/N)).\n        \n        # --- 1. Geometric setup for a single edge ---\n        angle_per_side = 2.0 * np.pi / num_sides\n        v0 = np.array([1.0, 0.0])\n        v1 = np.array([np.cos(angle_per_side), np.sin(angle_per_side)])\n\n        edge_length = np.linalg.norm(v1 - v0)\n        \n        gamma_e = penalty_alpha / edge_length\n        \n        # The outward unit normal vector is constant along the straight edge.\n        normal_angle = np.pi / num_sides\n        \n        # The term partial_n(u) = grad_u . n_e is constant along the edge.\n        grad_u_dot_n_val = -2.0 * np.cos(normal_angle)\n\n        # --- 2. Numerical quadrature for the boundary integral on one edge ---\n        # 2-point Gauss-Legendre quadrature on the reference interval [-1, 1]\n        gauss_points = np.array([-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)])\n        gauss_weights = np.array([1.0, 1.0])\n\n        edge_midpoint = (v0 + v1) / 2.0\n        half_edge_vector = (v1 - v0) / 2.0\n        \n        # Jacobian for change of variables from ds to d(xi) is ||half_edge_vector|| = edge_length / 2.\n        jacobian = edge_length / 2.0\n\n        edge_integral = 0.0\n        for i in range(len(gauss_points)):\n            xi = gauss_points[i]\n            weight = gauss_weights[i]\n\n            # Map reference point xi to a point on the edge in R^2\n            quad_point = edge_midpoint + xi * half_edge_vector\n            x, y = quad_point[0], quad_point[1]\n            \n            # Evaluate the solution u at the quadrature point\n            u_val = u_func(x, y)\n            \n            # Evaluate the integrand: gamma_e*u^2 - 2*u*(grad_u.n_e)\n            integrand_at_point = gamma_e * u_val**2 - 2.0 * u_val * grad_u_dot_n_val\n            \n            # Accumulate weighted integral value\n            edge_integral += integrand_at_point * weight * jacobian\n            \n        # --- 3. Total mismatch ---\n        # The total mismatch is the sum over all edges.\n        total_mismatch = num_sides * edge_integral\n        \n        return total_mismatch\n\n    # Define the test cases from the problem statement.\n    # Format: (number_of_sides, alpha_parameter)\n    # number_of_sides = None represents the exact circular boundary.\n    test_cases = [\n        (None, 10.0),\n        (8, 10.0),\n        (8, 100.0),\n        (64, 10.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        num_sides, alpha = case\n        result = compute_mismatch(num_sides, alpha)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3385212"}]}