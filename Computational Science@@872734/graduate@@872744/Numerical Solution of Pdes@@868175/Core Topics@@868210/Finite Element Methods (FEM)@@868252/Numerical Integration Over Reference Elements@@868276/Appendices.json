{"hands_on_practices": [{"introduction": "Gauss-Legendre quadrature is a cornerstone of numerical integration, especially within the finite element method. To truly master this tool, it is essential to understand its construction from first principles. This practice guides you through the derivation of the nodes and weights for the three-point Gauss-Legendre rule, reinforcing the concept of its degree of precision by verifying it against an exact analytical solution. [@problem_id:3425921]", "problem": "In the finite element method (FEM) for the numerical solution of partial differential equations (PDEs), integrals over the reference interval are routinely evaluated using polynomial-based quadrature. Consider the reference interval $[-1,1]$ and the polynomial $p(x)=x^{5}-2x^{3}+x$. Using the three-point Gauss–Legendre quadrature on $[-1,1]$, proceed as follows:\n\n1. Derive the nodes and weights of the three-point rule on $[-1,1]$ by requiring exactness for all polynomials up to degree $5$ and by exploiting the symmetry of the interval and the Lebesgue measure. Your derivation must start from the definition of a quadrature rule as a weighted sum of point evaluations that matches the exact moments of the measure up to the target degree.\n\n2. With the nodes and weights you derived, compute the quadrature approximation to $\\int_{-1}^{1} p(x)\\,dx$.\n\n3. Compute the analytic value of $\\int_{-1}^{1} p(x)\\,dx$ using first principles, and compare with the quadrature result to verify exactness in this case.\n\nExpress your final answer as a single real number. No rounding is required.", "solution": "The problem requires the derivation and application of the three-point Gauss-Legendre quadrature rule on the interval $[-1, 1]$. The process involves three parts: deriving the quadrature nodes and weights, applying the rule to a specific polynomial, and calculating the exact integral analytically for verification.\n\n**Part 1: Derivation of Nodes and Weights**\nA three-point quadrature rule on the interval $[-1, 1]$ seeks to approximate an integral as a weighted sum of function evaluations at three specific points (nodes):\n$$\n\\int_{-1}^{1} f(x) \\,dx \\approx \\sum_{i=1}^{3} w_i f(x_i) = w_1 f(x_1) + w_2 f(x_2) + w_3 f(x_3)\n$$\nThe rule has six unknowns: the nodes $x_1, x_2, x_3$ and the weights $w_1, w_2, w_3$. For a Gauss-Legendre quadrature with $n=3$ points, we require the formula to be exact for all polynomials of degree up to and including $2n-1 = 2(3)-1 = 5$. This provides six conditions by enforcing exactness for the monomial basis $\\{1, x, x^2, x^3, x^4, x^5\\}$.\n\nLet $I_k = \\int_{-1}^{1} x^k \\,dx$. The values of these exact integrals are:\n- $I_0 = \\int_{-1}^{1} 1 \\,dx = [x]_{-1}^{1} = 2$\n- $I_1 = \\int_{-1}^{1} x \\,dx = [\\frac{x^2}{2}]_{-1}^{1} = 0$\n- $I_2 = \\int_{-1}^{1} x^2 \\,dx = [\\frac{x^3}{3}]_{-1}^{1} = \\frac{2}{3}$\n- $I_3 = \\int_{-1}^{1} x^3 \\,dx = [\\frac{x^4}{4}]_{-1}^{1} = 0$\n- $I_4 = \\int_{-1}^{1} x^4 \\,dx = [\\frac{x^5}{5}]_{-1}^{1} = \\frac{2}{5}$\n- $I_5 = \\int_{-1}^{1} x^5 \\,dx = [\\frac{x^6}{6}]_{-1}^{1} = 0$\n\nLet $Q(x^k) = \\sum_{i=1}^{3} w_i x_i^k$. We must satisfy $Q(x^k) = I_k$ for $k = 0, \\ldots, 5$. This yields the following system of equations:\n1.  $w_1 + w_2 + w_3 = 2$\n2.  $w_1 x_1 + w_2 x_2 + w_3 x_3 = 0$\n3.  $w_1 x_1^2 + w_2 x_2^2 + w_3 x_3^2 = \\frac{2}{3}$\n4.  $w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3 = 0$\n5.  $w_1 x_1^4 + w_2 x_2^4 + w_3 x_3^4 = \\frac{2}{5}$\n6.  $w_1 x_1^5 + w_2 x_2^5 + w_3 x_3^5 = 0$\n\nAs suggested, we exploit the symmetry of the integration interval $[-1, 1]$ and the Lebesgue measure $dx$. This implies a symmetric arrangement of nodes and weights. We assume one node is at the center, $x_2 = 0$, and the other two are symmetric, $x_1 = -x_3$. The corresponding weights must also be symmetric, $w_1 = w_3$. Let's denote $x_3 = \\xi > 0$. The unknowns reduce to $x_2=0$, $x_1=-\\xi$, $x_3=\\xi$, $w_2$, and $w_1=w_3$.\n\nSubstituting these into the system of equations:\n1.  $w_1 + w_2 + w_1 = 2 \\implies 2w_1 + w_2 = 2$\n2.  $w_1(-\\xi) + w_2(0) + w_1(\\xi) = 0$. This equation is automatically satisfied.\n3.  $w_1(-\\xi)^2 + w_2(0)^2 + w_1(\\xi)^2 = \\frac{2}{3} \\implies 2w_1 \\xi^2 = \\frac{2}{3} \\implies w_1 \\xi^2 = \\frac{1}{3}$\n4.  $w_1(-\\xi)^3 + w_2(0)^3 + w_1(\\xi)^3 = 0$. This is also automatically satisfied.\n5.  $w_1(-\\xi)^4 + w_2(0)^4 + w_1(\\xi)^4 = \\frac{2}{5} \\implies 2w_1 \\xi^4 = \\frac{2}{5} \\implies w_1 \\xi^4 = \\frac{1}{5}$\n6.  $w_1(-\\xi)^5 + w_2(0)^5 + w_1(\\xi)^5 = 0$. This is also automatically satisfied.\n\nWe are left with a system of three equations for the three unknowns $w_1, w_2, \\xi$:\n(A) $2w_1 + w_2 = 2$\n(B) $w_1 \\xi^2 = \\frac{1}{3}$\n(C) $w_1 \\xi^4 = \\frac{1}{5}$\n\nDividing equation (C) by (B) gives:\n$$\n\\frac{w_1 \\xi^4}{w_1 \\xi^2} = \\frac{1/5}{1/3} \\implies \\xi^2 = \\frac{3}{5}\n$$\nThus, the positive node is $\\xi = \\sqrt{\\frac{3}{5}}$.\nThe nodes are $x_1 = -\\sqrt{\\frac{3}{5}}$, $x_2 = 0$, $x_3 = \\sqrt{\\frac{3}{5}}$.\n\nSubstitute $\\xi^2 = \\frac{3}{5}$ back into equation (B) to find $w_1$:\n$$\nw_1 \\left(\\frac{3}{5}\\right) = \\frac{1}{3} \\implies w_1 = \\frac{5}{9}\n$$\nSince $w_1 = w_3$, we have $w_3 = \\frac{5}{9}$.\n\nFinally, use equation (A) to find $w_2$:\n$$\n2\\left(\\frac{5}{9}\\right) + w_2 = 2 \\implies \\frac{10}{9} + w_2 = \\frac{18}{9} \\implies w_2 = \\frac{8}{9}\n$$\nThe nodes and weights for the three-point Gauss-Legendre quadrature are:\n- Nodes: $x_1 = -\\sqrt{\\frac{3}{5}}, x_2 = 0, x_3 = \\sqrt{\\frac{3}{5}}$\n- Weights: $w_1 = \\frac{5}{9}, w_2 = \\frac{8}{9}, w_3 = \\frac{5}{9}$\n\n**Part 2: Quadrature Approximation**\nWe now apply this rule to compute the integral of $p(x) = x^5 - 2x^3 + x$. The quadrature approximation is $Q(p) = \\sum_{i=1}^{3} w_i p(x_i)$.\n\nFirst, evaluate $p(x)$ at the nodes:\n- For $x_2 = 0$:\n$p(0) = 0^5 - 2(0)^3 + 0 = 0$.\n- For $x_3 = \\sqrt{\\frac{3}{5}}$:\n$p\\left(\\sqrt{\\frac{3}{5}}\\right) = \\left(\\sqrt{\\frac{3}{5}}\\right)^5 - 2\\left(\\sqrt{\\frac{3}{5}}\\right)^3 + \\sqrt{\\frac{3}{5}}$\nWe can factor out $\\sqrt{\\frac{3}{5}}$:\n$p\\left(\\sqrt{\\frac{3}{5}}\\right) = \\sqrt{\\frac{3}{5}} \\left( \\left(\\frac{3}{5}\\right)^2 - 2\\left(\\frac{3}{5}\\right) + 1 \\right) = \\sqrt{\\frac{3}{5}} \\left( \\frac{9}{25} - \\frac{6}{5} + 1 \\right)$\n$p\\left(\\sqrt{\\frac{3}{5}}\\right) = \\sqrt{\\frac{3}{5}} \\left( \\frac{9 - 30 + 25}{25} \\right) = \\sqrt{\\frac{3}{5}} \\left( \\frac{4}{25} \\right) = \\frac{4}{25}\\sqrt{\\frac{3}{5}}$.\n- For $x_1 = -\\sqrt{\\frac{3}{5}}$:\nThe polynomial $p(x)$ is an odd function, since all powers of $x$ are odd. Therefore, $p(-x) = -p(x)$.\n$p\\left(-\\sqrt{\\frac{3}{5}}\\right) = -p\\left(\\sqrt{\\frac{3}{5}}\\right) = -\\frac{4}{25}\\sqrt{\\frac{3}{5}}$.\n\nNow, assemble the quadrature sum:\n$Q(p) = w_1 p(x_1) + w_2 p(x_2) + w_3 p(x_3)$\n$Q(p) = \\left(\\frac{5}{9}\\right) \\left(-\\frac{4}{25}\\sqrt{\\frac{3}{5}}\\right) + \\left(\\frac{8}{9}\\right)(0) + \\left(\\frac{5}{9}\\right) \\left(\\frac{4}{25}\\sqrt{\\frac{3}{5}}\\right)$\n$Q(p) = -\\frac{20}{225}\\sqrt{\\frac{3}{5}} + 0 + \\frac{20}{225}\\sqrt{\\frac{3}{5}} = 0$.\n\nThe value of the integral approximated by the quadrature is $0$.\n\n**Part 3: Analytic Calculation and Verification**\nWe compute the exact value of the integral by direct integration:\n$$\n\\int_{-1}^{1} p(x) \\,dx = \\int_{-1}^{1} (x^5 - 2x^3 + x) \\,dx\n$$\nWe can integrate term-by-term:\n$$\n\\left[ \\frac{x^6}{6} - 2\\frac{x^4}{4} + \\frac{x^2}{2} \\right]_{-1}^{1} = \\left[ \\frac{x^6}{6} - \\frac{x^4}{2} + \\frac{x^2}{2} \\right]_{-1}^{1}\n$$\nEvaluating at the limits:\n$$\n\\left( \\frac{1^6}{6} - \\frac{1^4}{2} + \\frac{1^2}{2} \\right) - \\left( \\frac{(-1)^6}{6} - \\frac{(-1)^4}{2} + \\frac{(-1)^2}{2} \\right) = \\left( \\frac{1}{6} - \\frac{1}{2} + \\frac{1}{2} \\right) - \\left( \\frac{1}{6} - \\frac{1}{2} + \\frac{1}{2} \\right) = \\frac{1}{6} - \\frac{1}{6} = 0\n$$\nAlternatively, the function $p(x)=x^5-2x^3+x$ is an odd function, as $p(-x) = (-x)^5 - 2(-x)^3 + (-x) = -x^5 + 2x^3 - x = -p(x)$. The integral of any odd function over a symmetric interval, such as $[-1, 1]$, is identically zero.\n\nComparing the results, the quadrature approximation $Q(p)=0$ is identical to the exact analytic value of the integral, which is also $0$. This is expected, as the degree of the polynomial $p(x)$ is $5$, and the three-point Gauss-Legendre quadrature rule is exact for all polynomials of degree up to and including $5$. The calculation provides a successful verification of this theoretical property. The final answer is the value computed, which is $0$.", "answer": "$$\\boxed{0}$$", "id": "3425921"}, {"introduction": "Moving from one-dimensional theory to two-dimensional application, we explore how quadrature rules are the computational engine for assembling finite element matrices. The element mass matrix, formed by integrating products of basis functions, is a fundamental component in transient analyses. This exercise demonstrates the elegant efficiency of numerical quadrature by showing that a rule with sufficient polynomial exactness can compute the mass matrix entries perfectly, a key insight for practical FEM implementation. [@problem_id:3425897]", "problem": "Consider the reference triangle $\\hat K = \\{(\\xi,\\eta) \\in \\mathbb{R}^2 : \\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$ with the standard linear shape functions $\\hat\\phi_1(\\xi,\\eta) = 1 - \\xi - \\eta$, $\\hat\\phi_2(\\xi,\\eta) = \\xi$, and $\\hat\\phi_3(\\xi,\\eta) = \\eta$. The element mass matrix for the linear finite element space on $\\hat K$ is defined by the entries $M_{ij} = \\int_{\\hat K} \\hat\\phi_i(\\xi,\\eta)\\,\\hat\\phi_j(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta$ for $i,j \\in \\{1,2,3\\}$.\n\n1) Using only the definition of $M_{ij}$ and basic multivariate calculus over the domain $\\hat K$, compute the exact entries of the mass matrix $M$ by analytic integration.\n\n2) Now consider the symmetric degree-$2$ quadrature rule on $\\hat K$ with nodes $(\\xi,\\eta) \\in \\{(1/6,1/6),\\ (2/3,1/6),\\ (1/6,2/3)\\}$ and equal weights $w = 1/6$. Assemble the quadrature-based matrix $M^{(2)}$ whose entries are $M^{(2)}_{ij} = \\sum_{k=1}^{3} w\\,\\hat\\phi_i(\\xi_k,\\eta_k)\\,\\hat\\phi_j(\\xi_k,\\eta_k)$.\n\n3) Compare $M$ and $M^{(2)}$ by computing the Frobenius norm $\\|M - M^{(2)}\\|_F$ and justify its value from first principles (polynomial exactness).\n\nAs your final answer, report the exact value of $\\det(M)$ as a single simplified analytic expression (no rounding).", "solution": "The solution proceeds in three main parts as requested: analytic computation of the mass matrix $M$, computation of the quadrature-based matrix $M^{(2)}$, and a comparison of the two matrices, followed by the calculation of the determinant of $M$.\n\n**1) Analytic Computation of the Mass Matrix $M$**\n\nThe entries of the element mass matrix $M$ are given by $M_{ij} = \\int_{\\hat{K}} \\hat{\\phi}_i(\\xi, \\eta) \\hat{\\phi}_j(\\xi, \\eta) \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta$. The domain of integration is the reference triangle $\\hat{K}$, which has an area of $|\\hat{K}| = \\frac{1}{2}$. The provided shape functions, $\\hat{\\phi}_1 = 1 - \\xi - \\eta$, $\\hat{\\phi}_2 = \\xi$, and $\\hat{\\phi}_3 = \\eta$, are the canonical barycentric coordinates on $\\hat{K}$.\n\nTo evaluate these integrals, we employ the standard formula for the integral of products of barycentric coordinates over a $2$-simplex (a triangle):\n$$\n\\int_{\\hat{K}} \\hat{\\phi}_1^{a} \\hat{\\phi}_2^{b} \\hat{\\phi}_3^{c} \\, \\mathrm{d}A = 2 |\\hat{K}| \\frac{a! b! c!}{(a+b+c+2)!} = \\frac{a! b! c!}{(a+b+c+2)!}\n$$\nwhere $a, b, c$ are non-negative integer exponents. The integrand for any entry $M_{ij}$ is a product of two linear basis functions, resulting in a total polynomial degree of $2$.\n\nThe matrix $M$ is symmetric ($M_{ij} = M_{ji}$), so we only need to compute the diagonal and upper-triangular entries.\n\nFor the diagonal entries, we have integrands of the form $\\hat{\\phi}_i^2$.\n$M_{11} = \\int_{\\hat{K}} \\hat{\\phi}_1^2 \\, \\mathrm{d}A = \\int_{\\hat{K}} \\hat{\\phi}_1^2 \\hat{\\phi}_2^0 \\hat{\\phi}_3^0 \\, \\mathrm{d}A$. Using the formula with $(a,b,c)=(2,0,0)$:\n$$M_{11} = \\frac{2!0!0!}{(2+0+0+2)!} = \\frac{2}{4!} = \\frac{2}{24} = \\frac{1}{12}$$\nBy symmetry of the basis functions in the formula, the other diagonal entries are identical:\n$M_{22} = \\int_{\\hat{K}} \\hat{\\phi}_2^2 \\, \\mathrm{d}A = \\frac{0!2!0!}{(0+2+0+2)!} = \\frac{1}{12}$.\n$M_{33} = \\int_{\\hat{K}} \\hat{\\phi}_3^2 \\, \\mathrm{d}A = \\frac{0!0!2!}{(0+0+2+2)!} = \\frac{1}{12}$.\n\nFor the off-diagonal entries, we have integrands of the form $\\hat{\\phi}_i \\hat{\\phi}_j$ for $i \\ne j$.\n$M_{12} = \\int_{\\hat{K}} \\hat{\\phi}_1 \\hat{\\phi}_2 \\, \\mathrm{d}A = \\int_{\\hat{K}} \\hat{\\phi}_1^1 \\hat{\\phi}_2^1 \\hat{\\phi}_3^0 \\, \\mathrm{d}A$. Using the formula with $(a,b,c)=(1,1,0)$:\n$$M_{12} = \\frac{1!1!0!}{(1+1+0+2)!} = \\frac{1}{4!} = \\frac{1}{24}$$\nAgain, by symmetry, the other off-diagonal entries are identical:\n$M_{13} = \\int_{\\hat{K}} \\hat{\\phi}_1 \\hat{\\phi}_3 \\, \\mathrm{d}A = \\frac{1!0!1!}{(1+0+1+2)!} = \\frac{1}{24}$.\n$M_{23} = \\int_{\\hat{K}} \\hat{\\phi}_2 \\hat{\\phi}_3 \\, \\mathrm{d}A = \\frac{0!1!1!}{(0+1+1+2)!} = \\frac{1}{24}$.\n\nAssembling these entries, the exact mass matrix is:\n$$\nM = \\begin{pmatrix} 1/12 & 1/24 & 1/24 \\\\ 1/24 & 1/12 & 1/24 \\\\ 1/24 & 1/24 & 1/12 \\end{pmatrix} = \\frac{1}{24} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}\n$$\n\n**2) Computation of the Quadrature-Based Matrix $M^{(2)}$**\n\nThe matrix $M^{(2)}$ is assembled using the provided symmetric degree-$2$ quadrature rule. The entries are given by $M^{(2)}_{ij} = \\sum_{k=1}^{3} w\\,\\hat{\\phi}_i(\\xi_k,\\eta_k)\\,\\hat{\\phi}_j(\\xi_k,\\eta_k)$.\nThe quadrature nodes are $P_1 = (1/6, 1/6)$, $P_2 = (2/3, 1/6)$, $P_3 = (1/6, 2/3)$, and the uniform weight is $w = 1/6$.\n\nFirst, we evaluate the shape functions at each quadrature node:\nAt $P_1=(1/6, 1/6)$: $\\hat{\\phi}_1(P_1) = 1 - 1/6 - 1/6 = 2/3$, $\\hat{\\phi}_2(P_1) = 1/6$, $\\hat{\\phi}_3(P_1) = 1/6$.\nAt $P_2=(2/3, 1/6)$: $\\hat{\\phi}_1(P_2) = 1 - 2/3 - 1/6 = 1/6$, $\\hat{\\phi}_2(P_2) = 2/3$, $\\hat{\\phi}_3(P_2) = 1/6$.\nAt $P_3=(1/6, 2/3)$: $\\hat{\\phi}_1(P_3) = 1 - 1/6 - 2/3 = 1/6$, $\\hat{\\phi}_2(P_3) = 1/6$, $\\hat{\\phi}_3(P_3) = 2/3$.\n\nNow we compute the entries of $M^{(2)}$:\n$M^{(2)}_{11} = w \\sum_{k=1}^3 (\\hat{\\phi}_1(P_k))^2 = \\frac{1}{6} \\left[ (\\frac{2}{3})^2 + (\\frac{1}{6})^2 + (\\frac{1}{6})^2 \\right] = \\frac{1}{6} \\left[ \\frac{4}{9} + \\frac{1}{36} + \\frac{1}{36} \\right] = \\frac{1}{6} \\left[ \\frac{16}{36} + \\frac{2}{36} \\right] = \\frac{1}{6} \\left( \\frac{18}{36} \\right) = \\frac{1}{12}$.\n$M^{(2)}_{22} = w \\sum_{k=1}^3 (\\hat{\\phi}_2(P_k))^2 = \\frac{1}{6} \\left[ (\\frac{1}{6})^2 + (\\frac{2}{3})^2 + (\\frac{1}{6})^2 \\right] = \\frac{1}{12}$.\n$M^{(2)}_{33} = w \\sum_{k=1}^3 (\\hat{\\phi}_3(P_k))^2 = \\frac{1}{6} \\left[ (\\frac{1}{6})^2 + (\\frac{1}{6})^2 + (\\frac{2}{3})^2 \\right] = \\frac{1}{12}$.\n\n$M^{(2)}_{12} = w \\sum_{k=1}^3 \\hat{\\phi}_1(P_k)\\hat{\\phi}_2(P_k) = \\frac{1}{6} \\left[ (\\frac{2}{3})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{2}{3}) + (\\frac{1}{6})(\\frac{1}{6}) \\right] = \\frac{1}{6} \\left[ \\frac{2}{18} + \\frac{2}{18} + \\frac{1}{36} \\right] = \\frac{1}{6} \\left[ \\frac{4}{36} + \\frac{4}{36} + \\frac{1}{36} \\right] = \\frac{1}{6} \\left( \\frac{9}{36} \\right) = \\frac{1}{24}$.\nBy symmetry of the node locations and function values, we find:\n$M^{(2)}_{13} = w \\sum_{k=1}^3 \\hat{\\phi}_1(P_k)\\hat{\\phi}_3(P_k) = \\frac{1}{6} \\left[ (\\frac{2}{3})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{2}{3}) \\right] = \\frac{1}{24}$.\n$M^{(2)}_{23} = w \\sum_{k=1}^3 \\hat{\\phi}_2(P_k)\\hat{\\phi}_3(P_k) = \\frac{1}{6} \\left[ (\\frac{1}{6})(\\frac{1}{6}) + (\\frac{2}{3})(\\frac{1}{6}) + (\\frac{1}{6})(\\frac{2}{3}) \\right] = \\frac{1}{24}$.\n\nThe resulting matrix is:\n$$\nM^{(2)} = \\begin{pmatrix} 1/12 & 1/24 & 1/24 \\\\ 1/24 & 1/12 & 1/24 \\\\ 1/24 & 1/24 & 1/12 \\end{pmatrix}\n$$\n\n**3) Comparison and Justification**\n\nFrom the calculations above, we see that $M = M^{(2)}$.\nThe matrix difference is the zero matrix: $M - M^{(2)} = \\mathbf{0}$.\nThe Frobenius norm of the difference is defined as $\\|A\\|_F = \\sqrt{\\sum_{i=1}^m \\sum_{j=1}^n |a_{ij}|^2}$. For the zero matrix, this is:\n$$\n\\|M - M^{(2)}\\|_F = \\|\\mathbf{0}\\|_F = 0\n$$\n\nThis result is expected and can be justified from first principles. The calculation of each entry $M_{ij}$ involves integrating the function $f_{ij}(\\xi, \\eta) = \\hat{\\phi}_i(\\xi, \\eta) \\hat{\\phi}_j(\\xi, \\eta)$. Since each shape function $\\hat{\\phi}_k$ is a linear polynomial (degree $1$), the product $f_{ij}$ is a polynomial of degree at most $2$.\nThe problem states that the quadrature rule used to compute $M^{(2)}$ is a \"degree-$2$\" rule. By definition, a quadrature rule of degree $p$ integrates any polynomial of degree up to $p$ exactly. Thus, for any polynomial $P(\\xi, \\eta)$ with $\\text{deg}(P) \\le 2$, we have $\\int_{\\hat{K}} P(\\xi, \\eta) \\, \\mathrm{d}A = \\sum_{k=1}^{3} w P(\\xi_k, \\eta_k)$.\nSince all integrands $f_{ij}$ are polynomials of degree $2$, the quadrature rule yields the exact value of the integral for every entry of the mass matrix.\nTherefore, $M_{ij}^{(2)} = \\sum_{k=1}^{3} w f_{ij}(\\xi_k, \\eta_k) = \\int_{\\hat{K}} f_{ij}(\\xi, \\eta) \\, \\mathrm{d}A = M_{ij}$ for all $i,j$.\nThe matrices $M$ and $M^{(2)}$ are identical, and the norm of their difference is precisely zero. This is a direct consequence of the quadrature rule's degree of precision being sufficient for the polynomial degree of the integrands.\n\n**Final Answer Calculation: $\\det(M)$**\n\nThe final task is to compute the determinant of the exact mass matrix $M$.\n$$\nM = \\frac{1}{24} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}\n$$\nUsing the property $\\det(c A) = c^n \\det(A)$ for an $n \\times n$ matrix, with $n=3$ and $c=1/24$:\n$$\n\\det(M) = \\left(\\frac{1}{24}\\right)^3 \\det \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}\n$$\nThe determinant of the inner matrix is:\n$$\n\\det \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} = 2(2 \\cdot 2 - 1 \\cdot 1) - 1(1 \\cdot 2 - 1 \\cdot 1) + 1(1 \\cdot 1 - 2 \\cdot 1)\n$$\n$$\n= 2(3) - 1(1) + 1(-1) = 6 - 1 - 1 = 4\n$$\nSubstituting this back into the expression for $\\det(M)$:\n$$\n\\det(M) = \\frac{4}{24^3} = \\frac{4}{24 \\times 24 \\times 24} = \\frac{1}{6 \\times 24 \\times 24} = \\frac{1}{6 \\times 576} = \\frac{1}{3456}\n$$\nThe exact value of the determinant is $\\frac{1}{3456}$.", "answer": "$$\\boxed{\\frac{1}{3456}}$$", "id": "3425897"}, {"introduction": "While quadrature rules are perfectly accurate for polynomials within their degree of precision, real-world problems often involve complex, non-polynomial functions. This exercise delves into the critical concept of aliasing error, which arises when a low-order rule fails to capture high-frequency content in an integrand. By analyzing the integration of a trigonometric function, you will quantify this error and gain a deeper appreciation for the care required when choosing quadrature rules for nonlinear problems. [@problem_id:3425886]", "problem": "Consider the reference quadrilateral element $\\hat Q = [-1,1] \\times [-1,1]$ used in isoparametric finite elements for the numerical solution of partial differential equations (PDEs). In nonlinear residual evaluations, one frequently integrates a nonlinear function of a discrete field $\\hat u$, which can contain high-frequency content when the mesh is coarse relative to the oscillations in the solution. Let a smooth, high-frequency field be given on $\\hat Q$ by $\\hat u_{\\omega}(x,y) = \\cos(\\omega x)\\cos(\\omega y)$ for a frequency parameter $\\omega > 0$, and consider the nonlinear residual contribution\n$$\n\\mathcal{R}(\\omega) = \\int_{\\hat Q} \\left(\\hat u_{\\omega}(x,y)\\right)^{3} \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nStarting from the fundamental definition of the Gaussian quadrature rule and its tensor-product construction on $\\hat Q$, derive the exact value of $\\mathcal{R}(\\omega)$ and its approximation $\\mathcal{Q}(\\omega)$ obtained using the tensor-product two-point Gauss–Legendre rule in each coordinate on $\\hat Q$. Then, define the aliasing (quadrature) error as\n$$\nE(\\omega) = \\mathcal{Q}(\\omega) - \\mathcal{R}(\\omega),\n$$\nand provide a closed-form analytic expression for $E(\\omega)$ as a function of $\\omega$. The final answer must be a single expression. No rounding is required.", "solution": "The derivation will proceed in three steps: first, the exact evaluation of the integral $\\mathcal{R}(\\omega)$; second, the computation of its numerical approximation $\\mathcal{Q}(\\omega)$; and third, the determination of the error $E(\\omega) = \\mathcal{Q}(\\omega) - \\mathcal{R}(\\omega)$.\n\nThe problem defines the reference quadrilateral element as $\\hat Q = [-1,1] \\times [-1,1]$ and the function $\\hat u_{\\omega}(x,y) = \\cos(\\omega x)\\cos(\\omega y)$. The integral to be evaluated is\n$$\n\\mathcal{R}(\\omega) = \\int_{\\hat Q} \\left(\\hat u_{\\omega}(x,y)\\right)^{3} \\,\\mathrm{d}x\\,\\mathrm{d}y = \\int_{-1}^{1} \\int_{-1}^{1} \\cos^3(\\omega x)\\cos^3(\\omega y) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n\nStep 1: Exact evaluation of $\\mathcal{R}(\\omega)$.\nThe integrand $\\cos^3(\\omega x)\\cos^3(\\omega y)$ is a separable function. Therefore, the double integral can be expressed as the product of two identical single-variable integrals:\n$$\n\\mathcal{R}(\\omega) = \\left( \\int_{-1}^{1} \\cos^3(\\omega x) \\,\\mathrm{d}x \\right) \\left( \\int_{-1}^{1} \\cos^3(\\omega y) \\,\\mathrm{d}y \\right) = \\left( \\int_{-1}^{1} \\cos^3(\\omega \\xi) \\,\\mathrm{d}\\xi \\right)^2.\n$$\nLet us define the one-dimensional integral as $I(\\omega) = \\int_{-1}^{1} \\cos^3(\\omega \\xi) \\,\\mathrm{d}\\xi$. To evaluate this integral, we use the trigonometric power-reduction identity $\\cos^3(\\theta) = \\frac{3\\cos(\\theta) + \\cos(3\\theta)}{4}$. Applying this identity, we have:\n$$\nI(\\omega) = \\int_{-1}^{1} \\frac{1}{4} \\left( 3\\cos(\\omega\\xi) + \\cos(3\\omega\\xi) \\right) \\,\\mathrm{d}\\xi.\n$$\nThe integration is straightforward:\n$$\nI(\\omega) = \\frac{1}{4} \\left[ \\frac{3\\sin(\\omega\\xi)}{\\omega} + \\frac{\\sin(3\\omega\\xi)}{3\\omega} \\right]_{-1}^{1}.\n$$\nEvaluating the expression at the limits $\\xi = 1$ and $\\xi = -1$:\n$$\nI(\\omega) = \\frac{1}{4\\omega} \\left[ \\left(3\\sin(\\omega) + \\frac{\\sin(3\\omega)}{3}\\right) - \\left(3\\sin(-\\omega) + \\frac{\\sin(-3\\omega)}{3}\\right) \\right].\n$$\nSince the sine function is odd, $\\sin(-z) = -\\sin(z)$. This simplifies the expression to:\n$$\nI(\\omega) = \\frac{1}{4\\omega} \\left[ 2 \\left( 3\\sin(\\omega) + \\frac{\\sin(3\\omega)}{3} \\right) \\right] = \\frac{1}{2\\omega} \\left( 3\\sin(\\omega) + \\frac{\\sin(3\\omega)}{3} \\right).\n$$\nTo simplify the expression inside the parenthesis, we can factor out $1/3$:\n$$\nI(\\omega) = \\frac{1}{6\\omega} \\left( 9\\sin(\\omega) + \\sin(3\\omega) \\right).\n$$\nThe exact integral $\\mathcal{R}(\\omega)$ is the square of $I(\\omega)$:\n$$\n\\mathcal{R}(\\omega) = (I(\\omega))^2 = \\left( \\frac{9\\sin(\\omega) + \\sin(3\\omega)}{6\\omega} \\right)^2 = \\frac{\\left(9\\sin(\\omega) + \\sin(3\\omega)\\right)^2}{36\\omega^2}.\n$$\n\nStep 2: Approximate evaluation $\\mathcal{Q}(\\omega)$.\nThe approximation is obtained using the tensor-product two-point Gauss–Legendre quadrature rule. For a one-dimensional integral over $[-1,1]$, this rule is given by:\n$$\n\\int_{-1}^{1} g(\\xi) \\,\\mathrm{d}\\xi \\approx w_1 g(\\xi_1) + w_2 g(\\xi_2),\n$$\nwhere the quadrature points are $\\xi_1 = -1/\\sqrt{3}$, $\\xi_2 = 1/\\sqrt{3}$ and the weights are $w_1 = w_2 = 1$.\n\nFor the two-dimensional integral over $\\hat Q$, the tensor-product rule is:\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} f(x,y) \\,\\mathrm{d}x\\,\\mathrm{d}y \\approx \\sum_{i=1}^{2}\\sum_{j=1}^{2} w_i w_j f(x_i, y_j).\n$$\nThe integrand is $f(x,y) = \\cos^3(\\omega x)\\cos^3(\\omega y)$. The four quadrature points are $(-1/\\sqrt{3}, -1/\\sqrt{3})$, $(-1/\\sqrt{3}, 1/\\sqrt{3})$, $(1/\\sqrt{3}, -1/\\sqrt{3})$, and $(1/\\sqrt{3}, 1/\\sqrt{3})$. Since all weights are $1$, the approximation $\\mathcal{Q}(\\omega)$ is the sum of the function values at these four points.\n\nThe integrand $f(x,y)$ is an even function with respect to both $x$ and $y$, as $\\cos(-z) = \\cos(z)$. Consequently, the function value is the same at all four quadrature points:\n$$\nf\\left(\\pm\\frac{1}{\\sqrt{3}}, \\pm\\frac{1}{\\sqrt{3}}\\right) = \\cos^3\\left(\\omega \\frac{1}{\\sqrt{3}}\\right) \\cos^3\\left(\\omega \\frac{1}{\\sqrt{3}}\\right) = \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right).\n$$\nTherefore, the quadrature approximation is:\n$$\n\\mathcal{Q}(\\omega) = 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) + 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) + 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) + 1 \\cdot 1 \\cdot \\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right)\n$$\n$$\n\\mathcal{Q}(\\omega) = 4\\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right).\n$$\n\nStep 3: Aliasing error $E(\\omega)$.\nThe aliasing error is defined as $E(\\omega) = \\mathcal{Q}(\\omega) - \\mathcal{R}(\\omega)$. Substituting the expressions derived in the previous steps:\n$$\nE(\\omega) = 4\\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) - \\frac{\\left(9\\sin(\\omega) + \\sin(3\\omega)\\right)^2}{36\\omega^2}.\n$$\nThis is the final closed-form analytic expression for the aliasing error as a function of the frequency parameter $\\omega$.", "answer": "$$\n\\boxed{4\\cos^6\\left(\\frac{\\omega}{\\sqrt{3}}\\right) - \\frac{\\left(9\\sin(\\omega) + \\sin(3\\omega)\\right)^2}{36\\omega^2}}\n$$", "id": "3425886"}]}