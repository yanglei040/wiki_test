{"hands_on_practices": [{"introduction": "The first step in gaining confidence in a numerical solver is to verify its correctness. The Method of Manufactured Solutions is a cornerstone of code verification, where we choose a smooth analytical function as the \"exact\" solution and derive the corresponding source term. This practice guides you through implementing a finite element solver for a simple one-dimensional problem and using a sequence of refined meshes to empirically measure the convergence rates, confirming that your code achieves the theoretically predicted $\\mathcal{O}(h)$ rate in the $H^1$-norm and the optimal $\\mathcal{O}(h^2)$ rate in the $L^2$-norm [@problem_id:3374906].", "problem": "Consider the scalar second-order Partial Differential Equation (PDE) $-u''(x)=f(x)$ on the interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. Let the exact solution be a manufactured function $u(x)=\\sin(k\\pi x)$ for an integer frequency parameter $k\\in\\mathbb{N}$, and define the right-hand side by $f(x)=-u''(x)=(k\\pi)^2\\sin(k\\pi x)$. The goal is to empirically confirm the algebraic convergence rates of the linear conforming Finite Element Method (FEM) in the Sobolev space $H^1(\\Omega)$-norm and the Lebesgue space $L^2(\\Omega)$-norm by performing a log–log slope analysis of the error versus the mesh size.\n\nStarting from the weak formulation in the Sobolev space $H_0^1(\\Omega)$, use a standard continuous piecewise-linear (hat-function) approximation over a sequence of uniform meshes with mesh size $h=1/N$ for $N\\in\\mathbb{N}$. For each mesh, assemble and solve the discrete linear system obtained from the Galerkin method. Compute the error in the $H^1(\\Omega)$-norm and in the $L^2(\\Omega)$-norm between the exact solution $u$ and the finite element approximation $u_h$. The $L^2(\\Omega)$-norm is defined by $\\|v\\|_{L^2(\\Omega)}=\\left(\\int_\\Omega |v(x)|^2\\,dx\\right)^{1/2}$, and the $H^1(\\Omega)$-norm is defined by $\\|v\\|_{H^1(\\Omega)}=\\left(\\|v\\|_{L^2(\\Omega)}^2+\\|v'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$. Use high-order Gaussian quadrature to evaluate the necessary integrals with sufficient accuracy.\n\nImplement a log–log slope analysis as follows. For a sequence of uniform meshes with sizes $h_j$, compute the errors $E_{H^1}(h_j)=\\|u-u_h\\|_{H^1(\\Omega)}$ and $E_{L^2}(h_j)=\\|u-u_h\\|_{L^2(\\Omega)}$ for $j=1,\\dots,m$, where $m\\in\\mathbb{N}$ is the number of refinement levels. Fit a straight line to $(\\log h_j,\\log E(h_j))$ in the least-squares sense; the slope of this line is the empirical convergence rate. Repeat for both norms.\n\nYour program must:\n- Use the manufactured solution $u(x)=\\sin(k\\pi x)$ with the corresponding source $f(x)=(k\\pi)^2\\sin(k\\pi x)$.\n- Use a uniform mesh with $N$ elements and linear basis functions to assemble the stiffness matrix and load vector from first principles.\n- Impose homogeneous Dirichlet boundary conditions strongly.\n- Compute both $\\|u-u_h\\|_{L^2(\\Omega)}$ and $\\|u-u_h\\|_{H^1(\\Omega)}$ using sufficiently accurate Gaussian quadrature over each mesh element.\n- Perform a least-squares linear regression on $(\\log h,\\log E)$ to extract the empirical slopes for both norms.\n\nTest suite:\n- Case A (happy path): frequency $k=1$, initial number of elements $N_0=8$, number of refinement levels $m=5$ (refine by halving $h$, i.e., doubling $N$, at each level).\n- Case B (coarse-to-fine coverage): frequency $k=3$, initial number of elements $N_0=4$, number of refinement levels $m=5$.\n- Case C (higher frequency content): frequency $k=5$, initial number of elements $N_0=16$, number of refinement levels $m=4$.\n\nFor each case, output a pair of real numbers $[p_{H^1},p_{L^2}]$ where $p_{H^1}$ is the empirical log–log slope for the $H^1(\\Omega)$-norm and $p_{L^2}$ is the empirical log–log slope for the $L^2(\\Omega)$-norm. All real numbers must be printed rounded to three digits after the decimal point.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, in the order A, B, C, for example, $[[p_{H^1}^{(A)},p_{L^2}^{(A)}],[p_{H^1}^{(B)},p_{L^2}^{(B)}],[p_{H^1}^{(C)},p_{L^2}^{(C)}]]$.\n- No additional text should be printed.", "solution": "The problem requires an empirical validation of the convergence rates for the linear finite element method (FEM) applied to a one-dimensional Poisson equation. The analysis will be performed by solving for a manufactured solution and then computing the slope of the error norms versus mesh size on a log-log scale.\n\nThe governing Partial Differential Equation (PDE) is:\n$$ -u''(x) = f(x) \\quad \\text{for } x \\in \\Omega=(0,1) $$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. The problem specifies a manufactured solution $u(x)=\\sin(k\\pi x)$, where $k \\in \\mathbb{N}$ is an integer frequency parameter. The right-hand side, or source term, $f(x)$ is determined by substituting the exact solution into the PDE:\n$$ f(x) = -u''(x) = - \\frac{d^2}{dx^2}(\\sin(k\\pi x)) = (k\\pi)^2 \\sin(k\\pi x) $$\n\nThe FEM solution begins with the weak formulation of the problem. We multiply the PDE by a test function $v(x)$ from the Sobolev space $H_0^1(\\Omega)$, which is the space of functions that are square-integrable, have square-integrable first derivatives, and are zero at the boundaries $x=0$ and $x=1$. Integrating over the domain $\\Omega$ yields:\n$$ -\\int_0^1 u''(x)v(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\nApplying integration by parts to the left-hand side gives:\n$$ \\left[-u'(x)v(x)\\right]_0^1 + \\int_0^1 u'(x)v'(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\nSince $v \\in H_0^1(\\Omega)$, $v(0)=v(1)=0$, and the boundary term vanishes. This leads to the weak formulation: Find $u \\in H_0^1(\\Omega)$ such that\n$$ a(u,v) = L(v) \\quad \\forall v \\in H_0^1(\\Omega) $$\nwhere the bilinear form $a(u,v)$ and the linear functional $L(v)$ are defined as:\n$$ a(u,v) = \\int_0^1 u'(x)v'(x) \\,dx $$\n$$ L(v) = \\int_0^1 f(x)v(x) \\,dx $$\n\nFor the finite element discretization, we partition the domain $\\Omega=(0,1)$ into a uniform mesh of $N$ elements, each of length $h=1/N$. The nodes are located at $x_i = ih$ for $i=0, 1, \\dots, N$. We seek an approximate solution $u_h$ in a finite-dimensional subspace $V_h \\subset H_0^1(\\Omega)$. For this problem, $V_h$ is the space of continuous piecewise-linear functions over this mesh that are zero at $x=0$ and $x=1$. A basis for $V_h$ is given by the set of \"hat\" functions $\\{\\phi_i(x)\\}_{i=1}^{N-1}$, where $\\phi_i(x)$ is the unique linear function that is $1$ at node $x_i$ and $0$ at all other nodes $x_j$.\n\nThe FEM approximation $u_h(x)$ is written as a linear combination of these basis functions:\n$$ u_h(x) = \\sum_{j=1}^{N-1} U_j \\phi_j(x) $$\nwhere $U_j$ are the unknown coefficients, representing the value of the approximate solution at the interior nodes $x_j$. The Galerkin method requires that the weak form holds for all test functions in the discrete space $V_h$, i.e., for each basis function $\\phi_i$:\n$$ a(u_h, \\phi_i) = L(\\phi_i) \\quad \\text{for } i=1, \\dots, N-1 $$\nSubstituting the expansion for $u_h$ gives a system of linear equations:\n$$ \\sum_{j=1}^{N-1} U_j a(\\phi_j, \\phi_i) = L(\\phi_i) $$\nThis can be written in matrix form as $AU=F$, where:\n- $A$ is the $(N-1) \\times (N-1)$ stiffness matrix with entries $A_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i'(x)\\phi_j'(x) \\,dx$.\n- $F$ is the $(N-1) \\times 1$ load vector with entries $F_i = L(\\phi_i) = \\int_0^1 f(x)\\phi_i(x) \\,dx$.\n- $U$ is the vector of unknown coefficients $[U_1, \\dots, U_{N-1}]^T$.\n\nFor a uniform mesh with piecewise linear basis functions, the stiffness matrix entries can be calculated analytically. The derivative $\\phi_i'(x)$ is piecewise constant: $1/h$ on $(x_{i-1}, x_i)$ and $-1/h$ on $(x_i, x_{i+1})$. This results in a symmetric, tridiagonal stiffness matrix:\n$$ A_{ij} = \\begin{cases} 2/h  \\text{if } i=j \\\\ -1/h  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases} $$\nThe load vector entries $F_i = \\int_{x_{i-1}}^{x_{i+1}} (k\\pi)^2 \\sin(k\\pi x) \\phi_i(x) \\,dx$ must be computed numerically. This is done by summing contributions from each element using Gaussian quadrature to ensure high accuracy.\n\nAfter solving the linear system $AU=F$ for the nodal values $U$, the full FEM solution $u_h(x)$ is known. The error is $e(x) = u(x) - u_h(x)$. We compute the error in two norms:\n- The $L^2$-norm: $\\|e\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u(x)-u_h(x))^2 \\,dx\\right)^{1/2}$.\n- The $H^1$-norm: $\\|e\\|_{H^1(\\Omega)} = \\left(\\|e\\|_{L^2(\\Omega)}^2 + \\|e'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$, where $\\|e'\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u'(x)-u_h'(x))^2 \\,dx\\right)^{1/2}$.\n\nThese integrals are calculated element by element using high-order Gaussian quadrature. On each element $[x_j, x_{j+1}]$, the integral of a function $g(x)$ is approximated by transforming to a reference element $[-1,1]$ and using a weighted sum of function evaluations at specific quadrature points.\n\nTo find the empirical convergence rate, we compute the errors for a sequence of progressively refined meshes. Let $h_j$ be the mesh size at refinement level $j$, and let $E(h_j)$ be the corresponding error ($E_{H^1}$ or $E_{L^2}$). If the error converges algebraically, i.e., $E(h) \\approx C h^p$ for some constant $C$ and rate $p$, then taking the logarithm yields $\\log(E) \\approx \\log(C) + p \\log(h)$. This is a linear relationship between $\\log(E)$ and $\\log(h)$, where the slope is the convergence rate $p$. We perform a least-squares linear regression on the set of points $(\\log(h_j), \\log(E(h_j)))$ to determine the slope $p$.\n\nFor linear finite elements, theoretical predictions state that the convergence rate is $p=1$ for the $H^1$-norm and $p=2$ for the $L^2$-norm, provided the solution is sufficiently smooth and the mesh is fine enough. The program implements this entire procedure to verify these rates for the given test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the FEM convergence study for the specified test cases.\n    \"\"\"\n\n    # Test cases: (k, N_initial, num_refinements)\n    test_cases = [\n        (1, 8, 5),  # Case A\n        (3, 4, 5),  # Case B\n        (5, 16, 4), # Case C\n    ]\n\n    all_results = []\n    for k, N0, m in test_cases:\n        p_h1, p_l2 = run_convergence_study(k, N0, m)\n        all_results.append([f\"{p_h1:.3f}\", f\"{p_l2:.3f}\"])\n\n    # Format the final output string as per requirements\n    list_of_strings = [f\"[{item[0]},{item[1]}]\" for item in all_results]\n    final_output = f\"[{','.join(list_of_strings)}]\"\n    print(final_output)\n\ndef run_convergence_study(k, N0, num_refinements):\n    \"\"\"\n    Performs a convergence study for a given frequency k, initial mesh size N0,\n    and a number of refinement levels.\n\n    Args:\n        k (int): Frequency parameter for the manufactured solution.\n        N0 (int): Initial number of elements.\n        num_refinements (int): Number of mesh refinement steps.\n\n    Returns:\n        tuple: A pair of floats (p_h1, p_l2) representing the convergence\n               rates for the H1 and L2 norms.\n    \"\"\"\n    hs = []\n    errors_l2 = []\n    errors_h1 = []\n\n    for i in range(num_refinements):\n        N = N0 * (2**i)\n        h = 1.0 / N\n        l2_err, h1_err = solve_fem_1d(k, N)\n\n        hs.append(h)\n        errors_l2.append(l2_err)\n        errors_h1.append(h1_err)\n\n    log_hs = np.log(hs)\n    log_errs_l2 = np.log(errors_l2)\n    log_errs_h1 = np.log(errors_h1)\n\n    # Perform least-squares fit to find the slope (convergence rate)\n    p_l2 = np.polyfit(log_hs, log_errs_l2, 1)[0]\n    p_h1 = np.polyfit(log_hs, log_errs_h1, 1)[0]\n\n    return p_h1, p_l2\n\ndef solve_fem_1d(k, N):\n    \"\"\"\n    Solves the 1D Poisson problem -u''=f on (0,1) with u(0)=u(1)=0 using linear FEM.\n\n    Args:\n        k (int): Frequency parameter of the manufactured solution.\n        N (int): Number of mesh elements.\n\n    Returns:\n        tuple: A pair of floats (l2_error, h1_error).\n    \"\"\"\n    h = 1.0 / N\n    num_unknowns = N - 1\n\n    # Define exact solution, its derivative, and the source function\n    u_exact = lambda x: np.sin(k * np.pi * x)\n    u_prime_exact = lambda x: k * np.pi * np.cos(k * np.pi * x)\n    f_source = lambda x: (k * np.pi)**2 * np.sin(k * np.pi * x)\n\n    # Assemble stiffness matrix A\n    diag = np.full(num_unknowns, 2.0 / h)\n    off_diag = np.full(num_unknowns - 1, -1.0 / h)\n    A = np.diag(diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    \n    # Gaussian quadrature setup (5 points is sufficient for high accuracy)\n    NUM_QUAD_POINTS = 5\n    xi_q, w_q = np.polynomial.legendre.leggauss(NUM_QUAD_POINTS)\n\n    # Assemble load vector F\n    F = np.zeros(num_unknowns)\n    # Local basis functions on reference element [-1, 1]\n    phi_ref = [lambda xi: (1 - xi) / 2, lambda xi: (1 + xi) / 2]\n\n    for j in range(N):  # Loop over elements\n        x_left = j * h\n        f_loc = np.zeros(2)\n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            f_val = f_source(x_q_phys)\n            for i in range(2):\n                f_loc[i] += f_val * phi_ref[i](xi_q[q_idx]) * (h / 2) * w_q[q_idx]\n\n        # Add local contributions to global vector\n        if j  0:\n            F[j - 1] += f_loc[0]\n        if j  N - 1:\n            F[j] += f_loc[1]\n\n    # Solve linear system AU = F\n    U_sol = np.linalg.solve(A, F)\n\n    # Full solution vector including boundary nodes\n    U_h = np.concatenate(([0.0], U_sol, [0.0]))\n\n    # Compute L2 and H1 error norms\n    l2_error_sq = 0.0\n    h1_seminorm_error_sq = 0.0\n\n    for j in range(N):  # Loop over elements to compute error integrals\n        x_left = j * h\n        U_j, U_jp1 = U_h[j], U_h[j + 1]\n        u_h_prime_const = (U_jp1 - U_j) / h\n        \n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            \n            # Evaluate exact solution and its derivative\n            u_ex = u_exact(x_q_phys)\n            u_prime_ex = u_prime_exact(x_q_phys)\n\n            # Evaluate FEM solution and its derivative\n            u_h_val = U_j * phi_ref[0](xi_q[q_idx]) + U_jp1 * phi_ref[1](xi_q[q_idx])\n            \n            # Accumulate squared errors\n            jacobian = h / 2\n            l2_error_sq += (u_ex - u_h_val)**2 * jacobian * w_q[q_idx]\n            h1_seminorm_error_sq += (u_prime_ex - u_h_prime_const)**2 * jacobian * w_q[q_idx]\n\n    l2_error = np.sqrt(l2_error_sq)\n    h1_error = np.sqrt(l2_error_sq + h1_seminorm_error_sq)\n\n    return l2_error, h1_error\n\nsolve()\n```", "id": "3374906"}, {"introduction": "Having confirmed the optimal rates for a smooth problem, we now turn to a more realistic scenario where the solution's regularity is compromised by the geometry of the domain. Re-entrant corners are a common source of singularities, causing the solution's derivatives to blow up and degrading the convergence of standard FEM on uniform meshes. This exercise demonstrates how theoretical insight into the singular behavior of the solution can be used to design a radially graded mesh, which concentrates elements near the singularity to restore the optimal rates of convergence [@problem_id:3374917]. This is a fundamental principle behind adaptive finite element methods.", "problem": "Consider the planar sector domain $\\Omega = \\{(r,\\theta): 0  r  R,\\; 0  \\theta  \\omega\\}$ with opening angle $\\omega \\in (\\pi,2\\pi)$, which induces a re-entrant corner at the origin. Let $u$ be the solution to the Poisson partial differential equation (PDE) $-\\Delta u = f$ in $\\Omega$ with $u=0$ on $\\partial\\Omega$, where $f \\in C^{\\infty}(\\overline{\\Omega})$ is chosen so that near $r=0$ the solution admits the decomposition $u(r,\\theta) = u_{\\mathrm{s}}(r,\\theta) + u_{\\mathrm{r}}(r,\\theta)$ with $u_{\\mathrm{s}}(r,\\theta) = r^{\\lambda}\\psi(\\theta)$, $\\lambda = \\pi/\\omega \\in (0,1)$, and $u_{\\mathrm{r}} \\in H^{2}(\\Omega)$ is sufficiently smooth. Here $H^{1}(\\Omega)$ denotes the Sobolev space of square-integrable functions with square-integrable first derivatives, and $L^{2}(\\Omega)$ denotes the space of square-integrable functions.\n\nConsider a conforming piecewise linear Finite Element Method (FEM) on a family of isotropic triangulations that are quasi-uniform in the angular direction and radially graded toward $r=0$ using the parameter $\\beta0$ via nodal radii $r_{i} = R\\left(\\frac{i}{M}\\right)^{\\beta}$ for $i=0,1,\\dots,M$, with $M$ the number of radial layers. Assume the number of angular sectors $K$ scales like $K \\simeq c\\,M$ for a fixed $c0$, so the total number of elements $N$ satisfies $N \\simeq C\\,M^{2}$ for a constant $C0$ independent of $M$. Let $h(r)$ denote the local element diameter at radius $r$ induced by this grading.\n\nStarting from standard local interpolation estimates for piecewise linear elements,\n- $|\\nabla(u - I_{h}u)| \\lesssim h(r)\\,|D^{2}u|$ for the $H^{1}(\\Omega)$ error, and\n- $|u - I_{h}u| \\lesssim h(r)^{2}\\,|D^{2}u|$ for the $L^{2}(\\Omega)$ error,\nand using the singular structure $|D^{2}u_{\\mathrm{s}}(r,\\theta)| \\simeq r^{\\lambda-2}$ near $r=0$ together with polar-coordinate integration, derive conditions on the grading parameter $\\beta$ so that the FEM recovers the near-optimal convergence rates associated with smooth solutions, namely first-order in the $H^{1}(\\Omega)$ norm and second-order in the $L^{2}(\\Omega)$ norm, as functions of the total number of elements $N$.\n\nProvide your answer as a single closed-form expression for the minimal admissible value $\\beta_{\\min}$ in terms of the singularity exponent $\\lambda$. No rounding is required. The final answer must be a single analytic expression.", "solution": "The problem requires finding the minimal grading parameter $\\beta_{\\min}$ for a radially graded mesh such that the conforming piecewise linear Finite Element Method (FEM) for a Poisson problem on a domain with a re-entrant corner achieves optimal convergence rates. The solution's regularity is reduced by the corner, with a singular part $u_{\\mathrm{s}}(r,\\theta) = r^{\\lambda}\\psi(\\theta)$ where $\\lambda = \\pi/\\omega \\in (1/2, 1)$. The error analysis must account for this singularity.\n\nThe total error of the FEM solution $u_h$ can be bounded by the interpolation error of the exact solution $u$. By Céa's lemma for the $H^1(\\Omega)$ norm and duality arguments for the $L^2(\\Omega)$ norm, the convergence rates are determined by how well the finite element space can approximate the solution $u$. The problem provides local interpolation error estimates, which we will use. Since the solution is decomposed as $u = u_{\\mathrm{s}} + u_{\\mathrm{r}}$ with $u_{\\mathrm{r}} \\in H^2(\\Omega)$, the convergence rate for the regular part $u_{\\mathrm{r}}$ will be optimal on any reasonably shaped mesh. The overall convergence rate is limited by the approximation of the singular part $u_{\\mathrm{s}}$. We therefore focus on the error for $u_{\\mathrm{s}}$.\n\nFirst, we characterize the local element diameter $h(r)$ for the given mesh. The nodal radii are $r_i = R(i/M)^{\\beta}$ for $i=0, \\dots, M$. The radial size of elements in the layer between $r_{i-1}$ and $r_i$ is $h_{r,i} = r_i - r_{i-1}$. Using a first-order approximation for $i \\gg 1$:\n$h_{r,i} = R M^{-\\beta} (i^{\\beta} - (i-1)^{\\beta}) \\approx R M^{-\\beta} (\\beta i^{\\beta-1})$.\nThe radius $r$ in this layer is approximately $r_i$, so $i \\approx M(r/R)^{1/\\beta}$. Substituting this into the expression for $h_{r,i}$ gives the radial mesh size as a function of $r$:\n$h_r(r) \\approx R \\beta M^{-\\beta} (M(r/R)^{1/\\beta})^{\\beta-1} = R \\beta M^{-1} (r/R)^{1-1/\\beta}$.\nThe number of angular sectors $K$ scales with $M$ ($K \\simeq cM$), so the tangential mesh size is $h_{\\theta}(r) \\approx r\\omega/K \\simeq (r\\omega/c) M^{-1}$.\nThe local element diameter $h(r)$ is the maximum of these sizes. Near the singularity at $r=0$, for $r \\ll R$ and $\\beta  0$, we have $r^{1-1/\\beta}  r$ since $1-1/\\beta  1$. Thus, the radial size $h_r(r)$ is typically larger than the tangential size $h_{\\theta}(r)$, so we can approximate the effective local diameter by $h(r) \\sim M^{-1}r^{1-1/\\beta}$.\n\nNext, we analyze the $H^1(\\Omega)$ error convergence. The goal is to achieve a rate of $O(N^{-1/2})$, where $N \\simeq CM^2$ is the total number of elements. This corresponds to a rate of $O(M^{-1})$. The squared $H^1(\\Omega)$-seminorm error for the singular part $u_{\\mathrm{s}}$ is estimated by integrating the local interpolation error:\n$\\|\\nabla(u_{\\mathrm{s}} - u_h)\\|_{L^2(\\Omega)}^2 \\lesssim \\|\\nabla(u_{\\mathrm{s}} - I_h u_{\\mathrm{s}})\\|_{L^2(\\Omega)}^2 \\lesssim \\int_{\\Omega} h(r)^2 |D^2 u_{\\mathrm{s}}(r,\\theta)|^2 dA$.\nUsing the given singular behavior $|D^2 u_{\\mathrm{s}}| \\sim r^{\\lambda-2}$, the derived mesh size $h(r) \\sim M^{-1}r^{1-1/\\beta}$, and the area element $dA = r dr d\\theta$, we get:\n$$ \\|\\nabla(u_{\\mathrm{s}} - u_h)\\|_{L^2(\\Omega)}^2 \\lesssim \\int_0^\\omega \\int_0^R (C_1 M^{-1} r^{1-1/\\beta})^2 (C_2 r^{\\lambda-2})^2 r \\, dr \\, d\\theta $$\n$$ \\lesssim M^{-2} \\int_0^R r^{2(1-1/\\beta)} r^{2(\\lambda-2)} r^1 \\, dr = M^{-2} \\int_0^R r^{2 - 2/\\beta + 2\\lambda - 4 + 1} \\, dr $$\n$$ = M^{-2} \\int_0^R r^{2\\lambda - 2/\\beta - 1} \\, dr $$\nFor the total error to be $O(M^{-1})$, the squared error must be $O(M^{-2})$. This requires the integral $\\int_0^R r^{2\\lambda - 2/\\beta - 1} \\, dr$ to be a bounded constant independent of $M$. For the integral to converge at $r=0$, the exponent of $r$ must be greater than $-1$:\n$2\\lambda - 2/\\beta - 1  -1 \\implies 2\\lambda  2/\\beta \\implies \\lambda  1/\\beta \\implies \\beta  1/\\lambda$.\nIf this condition holds, the integral is finite, and the $H^1$ error converges as desired.\n\nNow, we analyze the $L^2(\\Omega)$ error convergence. The goal is $O(N^{-1})$, which is $O(M^{-2})$. The squared $L^2(\\Omega)$ error is estimated using the provided local estimate:\n$\\|u_{\\mathrm{s}} - u_h\\|_{L^2(\\Omega)}^2 \\lesssim \\|u_{\\mathrm{s}} - I_h u_{\\mathrm{s}}\\|_{L^2(\\Omega)}^2 \\lesssim \\int_{\\Omega} (h(r)^2 |D^2 u_{\\mathrm{s}}(r,\\theta)|)^2 dA$.\nSubstituting the expressions for $h(r)$, $|D^2 u_s|$, and $dA$:\n$$ \\|u_{\\mathrm{s}} - u_h\\|_{L^2(\\Omega)}^2 \\lesssim \\int_0^\\omega \\int_0^R \\left( (C_1 M^{-1} r^{1-1/\\beta})^2 (C_2 r^{\\lambda-2}) \\right)^2 r \\, dr \\, d\\theta $$\n$$ \\lesssim M^{-4} \\int_0^R (r^{2(1-1/\\beta)} r^{\\lambda-2})^2 r \\, dr = M^{-4} \\int_0^R (r^{2 - 2/\\beta + \\lambda - 2})^2 r \\, dr $$\n$$ = M^{-4} \\int_0^R (r^{\\lambda - 2/\\beta})^2 r \\, dr = M^{-4} \\int_0^R r^{2\\lambda - 4/\\beta + 1} \\, dr $$\nFor the total $L^2$ error to be $O(M^{-2})$, the squared error must be $O(M^{-4})$. This requires the integral $\\int_0^R r^{2\\lambda - 4/\\beta + 1} \\, dr$ to be a bounded constant. Convergence at $r=0$ requires the exponent to be greater than $-1$:\n$2\\lambda - 4/\\beta + 1  -1 \\implies 2\\lambda + 2  4/\\beta \\implies \\lambda + 1  2/\\beta \\implies \\beta  \\frac{2}{\\lambda+1}$.\n\nTo recover both optimal convergence rates, both conditions on $\\beta$ must be satisfied:\n$1. \\quad \\beta  1/\\lambda$\n$2. \\quad \\beta  2/(\\lambda+1)$\nWe must determine which of these two conditions is stricter for the given range of $\\lambda \\in (1/2, 1)$. Let's compare the values $1/\\lambda$ and $2/(\\lambda+1)$. Consider their difference:\n$$ \\frac{1}{\\lambda} - \\frac{2}{\\lambda+1} = \\frac{(\\lambda+1) - 2\\lambda}{\\lambda(\\lambda+1)} = \\frac{1-\\lambda}{\\lambda(\\lambda+1)} $$\nSince $\\lambda \\in (1/2, 1)$, the numerator $1-\\lambda$ is positive, and the denominator $\\lambda(\\lambda+1)$ is also positive. Therefore, the difference is positive, which implies:\n$$ \\frac{1}{\\lambda}  \\frac{2}{\\lambda+1} $$\nThe condition $\\beta  1/\\lambda$ is stricter than $\\beta  2/(\\lambda+1)$. Satisfying the former automatically satisfies the latter. Thus, the condition to achieve both desired convergence rates is $\\beta  1/\\lambda$. The problem asks for the minimal admissible value $\\beta_{\\min}$, which is the infimum of the set of admissible $\\beta$ values. This corresponds to the boundary of the derived inequality.\n\nThe minimal admissible value is $\\beta_{\\min} = 1/\\lambda$. At this boundary value, a logarithmic factor may appear in the $H^1$ error estimate, i.e., $\\|\\nabla(u-u_h)\\|_{L^2} \\sim N^{-1/2}\\sqrt{\\log N}$, which is consistent with the problem's use of \"near-optimal\".", "answer": "$$\\boxed{\\frac{1}{\\lambda}}$$", "id": "3374917"}, {"introduction": "Our final practice explores a more subtle mechanism for convergence rate degradation that arises in multiphysics or composite material simulations. In these interface problems, the material properties (and thus the PDE coefficients) are discontinuous across internal boundaries. This exercise reveals a critical aspect of the Aubin-Nitsche duality argument: the $L^2$ convergence rate depends not only on the smoothness of the primary solution but also on the regularity of the solution to an associated dual problem. You will analyze how a loss of regularity in the dual solution, caused by the interface, leads to a predictable and unavoidable reduction in the $L^2$ error rate, even when the $H^1$ error converges optimally [@problem_id:3374952].", "problem": "Consider a two-dimensional transmission problem for a second-order, linear, elliptic Partial Differential Equation (PDE) on the domain $\\Omega \\subset \\mathbb{R}^{2}$ equal to the unit disk. Let $\\Gamma \\subset \\Omega$ be a smooth, closed, strictly convex interface equal to the circle of radius $r_{0} \\in (0,1)$, which partitions $\\Omega$ into two subdomains $\\Omega_{-}$ and $\\Omega_{+}$ with $\\partial \\Omega_{-} = \\Gamma$ and $\\partial \\Omega_{+} = \\Gamma \\cup \\partial \\Omega$. The coefficient $a(x)$ is piecewise constant with $a(x) = a_{-}  0$ in $\\Omega_{-}$ and $a(x) = a_{+}  0$ in $\\Omega_{+}$, and $a_{-} \\neq a_{+}$. The model problem is\n$$\n-\\nabla \\cdot \\big(a(x)\\,\\nabla u(x)\\big) = f(x) \\quad \\text{in } \\Omega, \n\\qquad u = 0 \\quad \\text{on } \\partial \\Omega,\n$$\nwith transmission conditions across $\\Gamma$ given by continuity of $u$ and continuity of the normal flux $a\\,\\partial_{n}u$.\n\nAssume $f \\in L^{2}(\\Omega)$, and that the exact solution $u$ is piecewise $H^{2}$, namely $u|_{\\Omega_{\\pm}} \\in H^{2}(\\Omega_{\\pm})$, with traces across $\\Gamma$ satisfying the transmission conditions, so that $u \\in H^{1}_{0}(\\Omega)$ globally. Consider a conforming, body-fitted Finite Element Method (FEM) with a quasi-uniform triangulation $\\mathcal{T}_{h}$ that resolves $\\Gamma$, and let $V_{h} \\subset H^{1}_{0}(\\Omega)$ be the space of continuous, piecewise affine functions over $\\mathcal{T}_{h}$. The Galerkin approximation $u_{h} \\in V_{h}$ is defined by the variational formulation with the standard bilinear form and linear functional induced by the PDE.\n\nIt is known for this class of interface problems that the $H^{1}$-error is optimal under the above assumptions on $u$, but that curved transmission conditions with $a_{-} \\neq a_{+}$ reduce the regularity of the solution to the dual problem. Specifically, for the dual problem with right-hand side equal to the $L^{2}$-error, the solution $z$ belongs globally to the fractional Sobolev space $H^{1+s}(\\Omega)$ with $s = \\frac{1}{2}$, although $z$ is piecewise $H^{2}$.\n\nDerive, from first principles of conforming Galerkin discretization and the regularity information given above, the asymptotic convergence rate in the $L^{2}(\\Omega)$-norm of the FEM error $\\|u - u_{h}\\|_{L^{2}(\\Omega)}$ as a function of the mesh size $h$. Express your final answer as a single analytic expression in $h$ only. No rounding is required, and there are no physical units.", "solution": "The derivation of the $L^{2}(\\Omega)$-norm convergence rate proceeds via the Aubin-Nitsche duality argument.\n\nLet $H^{1}_{0}(\\Omega)$ be the standard Sobolev space of functions with square-integrable first derivatives that vanish on the boundary $\\partial\\Omega$. The weak formulation of the problem is to find $u \\in H^1_0(\\Omega)$ such that:\n$$B(u, v) = L(v) \\quad \\forall v \\in H^1_0(\\Omega)$$\nwhere the bilinear form $B(\\cdot, \\cdot)$ and linear functional $L(\\cdot)$ are defined as:\n$$B(w, v) = \\int_{\\Omega} a(x) \\nabla w \\cdot \\nabla v \\,dx$$\n$$L(v) = \\int_{\\Omega} f v \\,dx$$\nThe finite element approximation $u_h \\in V_h$ is the solution to the discrete problem:\n$$B(u_h, v_h) = L(v_h) \\quad \\forall v_h \\in V_h$$\nA key property of the Galerkin method is orthogonality of the error $e = u - u_h$. Subtracting the discrete equation from the weak formulation (with $v=v_h$) yields:\n$$B(u - u_h, v_h) = 0 \\quad \\forall v_h \\in V_h$$\nThis is the Galerkin orthogonality property.\n\nTo estimate the error in the $L^2(\\Omega)$-norm, we introduce an auxiliary (dual) problem. Find $z \\in H^1_0(\\Omega)$ such that:\n$$-\\nabla \\cdot (a(x) \\nabla z) = e$$\nThe weak formulation for this dual problem is to find $z \\in H^1_0(\\Omega)$ such that:\n$$B(v, z) = (v, e)_{L^2(\\Omega)} = \\int_{\\Omega} v e \\,dx \\quad \\forall v \\in H^1_0(\\Omega)$$\nBy setting $v = e = u - u_h$ in the dual problem's weak formulation, we express the squared $L^2(\\Omega)$-norm of the error as:\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 = (e, e)_{L^2(\\Omega)} = B(e, z) = B(u - u_h, z)$$\nUsing Galerkin orthogonality, we can subtract $B(u - u_h, z_h) = 0$ for any $z_h \\in V_h$:\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 = B(u - u_h, z - z_h)$$\nThe bilinear form $B(\\cdot, \\cdot)$ is continuous on $H^1(\\Omega) \\times H^1(\\Omega)$, meaning there exists a constant $C  0$ such that $B(w, v) \\le C \\|w\\|_{H^1(\\Omega)} \\|v\\|_{H^1(\\Omega)}$. Applying this inequality gives:\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C \\|u - u_h\\|_{H^1(\\Omega)} \\|z - z_h\\|_{H^1(\\Omega)}$$\nSince this holds for any $z_h \\in V_h$, we can choose the best approximation to $z$ from $V_h$:\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C \\|u - u_h\\|_{H^1(\\Omega)} \\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)}$$\nWe now estimate the two terms on the right-hand side.\n\n1.  **Estimate of $\\|u - u_h\\|_{H^1(\\Omega)}$**: The problem states that the exact solution $u$ is piecewise $H^2$, i.e., $u|_{\\Omega_{\\pm}} \\in H^2(\\Omega_{\\pm})$, and we are using continuous piecewise affine functions ($P_1$ elements) on a quasi-uniform mesh. For such a setting, standard FEM error analysis (Céa's lemma combined with interpolation theory) guarantees an optimal convergence rate in the energy norm, which is equivalent to the $H^1$-norm. The rate is linear in the mesh size $h$:\n    $$\\|u - u_h\\|_{H^1(\\Omega)} \\le C_1 h^1 \\|u\\|_{\\text{piecewise }H^2} = \\mathcal{O}(h)$$\n\n2.  **Estimate of $\\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)}$**: This term is the best approximation error for the dual solution $z$ in the space $V_h$. The problem provides the crucial information that the global regularity of the dual solution is $z \\in H^{1+s}(\\Omega)$ with $s = \\frac{1}{2}$. Standard approximation theory for $P_1$ finite elements states that for a function in $H^{1+s}(\\Omega)$, the best approximation error in the $H^1$-norm is bounded as:\n    $$\\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)} \\le C_2 h^s \\|z\\|_{H^{1+s}(\\Omega)}$$\n    Substituting $s = \\frac{1}{2}$, we get:\n    $$\\inf_{v_h \\in V_h} \\|z - v_h\\|_{H^1(\\Omega)} \\le C_2 h^{\\frac{1}{2}} \\|z\\|_{H^{1+\\frac{1}{2}}(\\Omega)}$$\n\nCombining these two estimates, we have:\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C (C_1 h) \\left( C_2 h^{\\frac{1}{2}} \\|z\\|_{H^{1+\\frac{1}{2}}(\\Omega)} \\right)$$\nElliptic regularity for the dual problem guarantees that the solution $z$ is bounded by its source term $e = u - u_h$:\n$$\\|z\\|_{H^{1+\\frac{1}{2}}(\\Omega)} \\le C_{\\text{reg}} \\|u-u_h\\|_{L^2(\\Omega)}$$\nSubstituting this regularity estimate back into our error inequality yields:\n$$\\|u - u_h\\|_{L^2(\\Omega)}^2 \\le C_3 h^{1+\\frac{1}{2}} \\|u - u_h\\|_{L^2(\\Omega)} = C_3 h^{\\frac{3}{2}} \\|u - u_h\\|_{L^2(\\Omega)}$$\nwhere $C_3$ is a generic constant independent of $h$. Assuming the error is non-zero, we can divide both sides by $\\|u - u_h\\|_{L^2(\\Omega)}$:\n$$\\|u - u_h\\|_{L^2(\\Omega)} \\le C_3 h^{\\frac{3}{2}}$$\nThis shows that the asymptotic rate of convergence of the $L^2(\\Omega)$-norm of the error is $\\mathcal{O}(h^{\\frac{3}{2}})$. The question asks for the rate as a function of $h$.", "answer": "$$\\boxed{h^{\\frac{3}{2}}}$$", "id": "3374952"}]}