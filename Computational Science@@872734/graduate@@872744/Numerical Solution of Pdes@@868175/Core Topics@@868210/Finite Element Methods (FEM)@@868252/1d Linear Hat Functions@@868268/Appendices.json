{"hands_on_practices": [{"introduction": "The journey into the practical side of the Finite Element Method begins with assembling the system matrices. Our first exercise focuses on the **mass matrix**, whose entries are defined by the inner products of the basis functions, $M_{ij}=\\int \\varphi_{i}(x)\\,\\varphi_{j}(x)\\,\\mathrm{d}x$. This matrix is fundamental for problems involving time evolution, source terms, or eigenvalue analysis. This practice [@problem_id:3359130] provides a foundational calculation on a uniform mesh, allowing you to master the integration of the piecewise-linear hat functions themselves before moving to more complex scenarios.", "problem": "Consider the semi-discretization in space, using the Galerkin approach of the Finite Element Method (FEM), of a one-dimensional linear partial differential equation (PDE) on the interval $[0,L]$. Let the interval be partitioned into a uniform mesh with nodes $x_{i}=ih$ for $i=0,1,\\dots,N$, where $h=L/N$. On this mesh, let $\\{\\varphi_{i}\\}_{i=0}^{N}$ denote the standard one-dimensional piecewise-linear hat basis functions associated with the nodes $\\{x_{i}\\}$. The mass matrix $M$ is defined by the inner products\n$$\nM_{ij}=\\int_{0}^{L}\\varphi_{i}(x)\\,\\varphi_{j}(x)\\,\\mathrm{d}x,\n$$\nfor all indices $i,j$ corresponding to the interior degrees of freedom. Starting from the definitions of the basis functions and the uniform mesh, derive closed-form expressions in terms of $h$ for the diagonal entry $M_{ii}$ and the immediate off-diagonal entry $M_{i,i+1}$ for an interior index $i$ (that is, $1\\leq i\\leq N-1$). Express your final answer as the pair $\\left(M_{ii},M_{i,i+1}\\right)$ as a single analytic expression. No rounding is required.", "solution": "The problem requires the derivation of the diagonal and off-diagonal entries of the mass matrix for a one-dimensional finite element discretization using piecewise-linear basis functions on a uniform mesh.\n\nFirst, we must define the basis functions. The problem is set on the interval $[0,L]$, which is divided into $N$ subintervals of equal length $h=L/N$. The nodes are located at positions $x_i = ih$ for $i=0, 1, \\dots, N$. The standard piecewise-linear (or \"hat\") basis function $\\varphi_i(x)$ associated with an interior node $x_i$ (where $1 \\le i \\le N-1$) is defined by the properties:\n$1$. $\\varphi_i(x_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n$2$. $\\varphi_i(x)$ is continuous and linear on each subinterval $[x_j, x_{j+1}]$.\n\nFrom these properties, the explicit formula for $\\varphi_i(x)$ for an interior node $i$ is:\n$$\n\\varphi_i(x) =\n\\begin{cases}\n    \\frac{x - x_{i-1}}{x_i - x_{i-1}} = \\frac{x - (i-1)h}{h}  \\text{if } x \\in [x_{i-1}, x_i] \\\\\n    \\frac{x_{i+1} - x}{x_{i+1} - x_i} = \\frac{(i+1)h - x}{h}  \\text{if } x \\in [x_i, x_{i+1}] \\\\\n    0  \\text{otherwise}\n\\end{cases}\n$$\nThe support of $\\varphi_i(x)$, i.e., the region where it is non-zero, is the interval $[x_{i-1}, x_{i+1}]$.\n\nThe entries of the mass matrix $M$ are given by the formula $M_{ij} = \\int_{0}^{L} \\varphi_i(x) \\varphi_j(x) \\, dx$. We need to compute the diagonal entry $M_{ii}$ and the off-diagonal entry $M_{i,i+1}$ for an interior index $i$.\n\nTo compute the diagonal entry $M_{ii}$, we evaluate the integral:\n$$\nM_{ii} = \\int_{0}^{L} \\varphi_i(x)^2 \\, dx\n$$\nSince $\\varphi_i(x)$ is only non-zero on the interval $[x_{i-1}, x_{i+1}]$, the integral is restricted to this domain:\n$$\nM_{ii} = \\int_{x_{i-1}}^{x_{i+1}} \\varphi_i(x)^2 \\, dx\n$$\nWe can split this integral into two parts, corresponding to the two subintervals where $\\varphi_i(x)$ is defined by different linear functions:\n$$\nM_{ii} = \\int_{x_{i-1}}^{x_i} \\left(\\frac{x - x_{i-1}}{h}\\right)^2 \\, dx + \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1} - x}{h}\\right)^2 \\, dx\n$$\nFor the first integral, we perform a change of variables. Let $u = x - x_{i-1}$. Then $du = dx$. The limits of integration become $u=0$ when $x=x_{i-1}$ and $u=h$ when $x=x_i$.\n$$\n\\int_{x_{i-1}}^{x_i} \\left(\\frac{x - x_{i-1}}{h}\\right)^2 \\, dx = \\frac{1}{h^2} \\int_{0}^{h} u^2 \\, du = \\frac{1}{h^2} \\left[ \\frac{u^3}{3} \\right]_0^h = \\frac{1}{h^2} \\frac{h^3}{3} = \\frac{h}{3}\n$$\nFor the second integral, we let $v = x_{i+1} - x$. Then $dv = -dx$. The limits become $v=h$ when $x=x_i$ and $v=0$ when $x=x_{i+1}$.\n$$\n\\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1} - x}{h}\\right)^2 \\, dx = \\frac{1}{h^2} \\int_{h}^{0} v^2 \\, (-dv) = \\frac{1}{h^2} \\int_{0}^{h} v^2 \\, dv = \\frac{1}{h^2} \\left[ \\frac{v^3}{3} \\right]_0^h = \\frac{1}{h^2} \\frac{h^3}{3} = \\frac{h}{3}\n$$\nSumming these two results gives the value for the diagonal entry:\n$$\nM_{ii} = \\frac{h}{3} + \\frac{h}{3} = \\frac{2h}{3}\n$$\n\nNext, we compute the off-diagonal entry $M_{i,i+1}$. The integral is:\n$$\nM_{i,i+1} = \\int_{0}^{L} \\varphi_i(x) \\varphi_{i+1}(x) \\, dx\n$$\nThe integrand $\\varphi_i(x) \\varphi_{i+1}(x)$ is non-zero only where the supports of $\\varphi_i(x)$ and $\\varphi_{i+1}(x)$ overlap. The support of $\\varphi_i(x)$ is $[x_{i-1}, x_{i+1}]$ and the support of $\\varphi_{i+1}(x)$ is $[x_i, x_{i+2}]$. The intersection of these two supports is the interval $[x_i, x_{i+1}]$. Therefore, the integral is non-zero only over this interval.\n$$\nM_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\varphi_i(x) \\varphi_{i+1}(x) \\, dx\n$$\nOn the interval $[x_i, x_{i+1}]$, the basis functions are given by:\n- $\\varphi_i(x) = \\frac{x_{i+1} - x}{h}$ (descending part of the hat function $\\varphi_i$)\n- $\\varphi_{i+1}(x) = \\frac{x - x_{i}}{h}$ (ascending part of the hat function $\\varphi_{i+1}$)\n\nSubstituting these into the integral:\n$$\nM_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1} - x}{h}\\right) \\left(\\frac{x - x_i}{h}\\right) \\, dx = \\frac{1}{h^2} \\int_{x_i}^{x_{i+1}} (x_{i+1} - x)(x - x_i) \\, dx\n$$\nWe use the substitution $u = x - x_i$, which implies $du=dx$. The term $x_{i+1} - x$ becomes $x_{i+1} - (u+x_i) = (x_{i+1}-x_i) - u = h-u$. The limits of integration change from $x_i, x_{i+1}$ to $u=0, u=h$.\n$$\nM_{i,i+1} = \\frac{1}{h^2} \\int_{0}^{h} (h-u)u \\, du = \\frac{1}{h^2} \\int_{0}^{h} (hu - u^2) \\, du\n$$\nEvaluating the integral:\n$$\nM_{i,i+1} = \\frac{1}{h^2} \\left[ \\frac{hu^2}{2} - \\frac{u^3}{3} \\right]_0^h = \\frac{1}{h^2} \\left( \\frac{h(h^2)}{2} - \\frac{h^3}{3} \\right) = \\frac{1}{h^2} \\left( \\frac{h^3}{2} - \\frac{h^3}{3} \\right)\n$$\n$$\nM_{i,i+1} = \\frac{1}{h^2} \\left( \\frac{3h^3 - 2h^3}{6} \\right) = \\frac{1}{h^2} \\left( \\frac{h^3}{6} \\right) = \\frac{h}{6}\n$$\nThus, for an interior node $i$, the diagonal entry of the mass matrix is $M_{ii} = \\frac{2h}{3}$ and the immediate off-diagonal entry is $M_{i,i+1} = \\frac{h}{6}$. By symmetry of the integral definition, $M_{i+1,i} = M_{i,i+1} = \\frac{h}{6}$. All other entries $M_{ij}$ where $|i-j|1$ are zero because the supports of $\\varphi_i(x)$ and $\\varphi_j(x)$ are disjoint.\n\nThe problem asks for the pair $(M_{ii}, M_{i,i+1})$. The derived closed-form expressions are $M_{ii} = \\frac{2h}{3}$ and $M_{i,i+1} = \\frac{h}{6}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2h}{3}  \\frac{h}{6}\n\\end{pmatrix}\n}\n$$", "id": "3359130"}, {"introduction": "Next, we turn our attention to the **stiffness matrix**, which discretizes differential operators and is central to modeling physical phenomena like diffusion and elasticity. The off-diagonal entries, such as $K_{i,i-1}$, quantify the interaction between adjacent basis functions. This exercise [@problem_id:3359188] is crucial for understanding how the local, overlapping support of hat functions gives rise to the sparse structure of the global system matrix, a hallmark of the efficiency of FEM. By working through this calculation on a non-uniform mesh, you will see how the geometry of each element directly influences the strength of this coupling.", "problem": "Consider the canonical one-dimensional weak form for the Poisson partial differential equation (PDE) on the interval $\\Omega=(0,L)$ with homogeneous Dirichlet boundary conditions, discretized by the Finite Element Method (FEM) using continuous, piecewise-linear hat functions on a strictly increasing mesh $0=x_{0}x_{1}\\cdotsx_{N}=L$. Let the nodal basis $\\{\\varphi_{i}\\}_{i=0}^{N}$ be defined by the usual hat functions, where each $\\varphi_{i}$ is supported on $[x_{i-1},x_{i+1}]$ for interior nodes $i\\in\\{1,\\dots,N-1\\}$, is affine on each element, and satisfies $\\varphi_{i}(x_{j})=\\delta_{ij}$ for all $i,j$. For a nonuniform mesh, define the local element sizes $h_{i}=x_{i}-x_{i-1}$ for $i=1,\\dots,N$.\n\nIn the standard symmetric stiffness matrix associated with the bilinear form $a(u,v)=\\int_{0}^{L}u'(x)v'(x)\\,\\mathrm{d}x$, the off-diagonal entry coupling the interior node $i$ to its left neighbor $i-1$ is given by\n$$\nK_{i,i-1}=\\int_{x_{i-1}}^{x_{i}} \\varphi_{i}'(x)\\,\\varphi_{i-1}'(x)\\,\\mathrm{d}x.\n$$\nStarting from the defining properties of the hat functions and the fundamental calculus facts for affine functions and definite integrals, compute $K_{i,i-1}$ in closed form for an interior node $i\\in\\{2,\\dots,N-1\\}$ on a nonuniform mesh, and express your final answer as a single analytical expression in terms of $h_{i}$ only. No numerical rounding is required and no physical unit should be attached to the answer.", "solution": "The task is to compute the off-diagonal entry $K_{i,i-1}$ of the stiffness matrix for an interior node $i$. This entry is defined by the integral\n$$\nK_{i,i-1} = \\int_{x_{i-1}}^{x_{i}} \\varphi_{i}'(x)\\,\\varphi_{i-1}'(x)\\,\\mathrm{d}x\n$$\nThe functions $\\varphi_{i}(x)$ and $\\varphi_{i-1}(x)$ are the standard piecewise-linear (hat) basis functions. The integral's domain is the single element $[x_{i-1}, x_{i}]$, which has length $h_{i} = x_{i} - x_{i-1}$. On this specific interval, we must determine the analytical forms of $\\varphi_{i}(x)$ and $\\varphi_{i-1}(x)$ and their derivatives.\n\nFirst, consider the basis function $\\varphi_{i}(x)$. By definition, it is affine on the interval $[x_{i-1}, x_{i}]$ and satisfies the nodal property $\\varphi_{i}(x_{j}) = \\delta_{ij}$. This means:\n\\begin{itemize}\n    \\item $\\varphi_{i}(x_{i-1}) = 0$\n    \\item $\\varphi_{i}(x_{i}) = 1$\n\\end{itemize}\nSince $\\varphi_{i}(x)$ is linear on this interval, it can be written as a straight line passing through the points $(x_{i-1}, 0)$ and $(x_{i}, 1)$. The slope of this line is $\\frac{1-0}{x_{i}-x_{i-1}} = \\frac{1}{h_{i}}$. Using the point-slope form with the point $(x_{i-1}, 0)$, the expression for $\\varphi_{i}(x)$ on $[x_{i-1}, x_{i}]$ is:\n$$\n\\varphi_{i}(x) = \\frac{1}{h_{i}}(x - x_{i-1})\n$$\n\nNext, consider the basis function $\\varphi_{i-1}(x)$. It is also affine on the interval $[x_{i-1}, x_{i}]$ and satisfies:\n\\begin{itemize}\n    \\item $\\varphi_{i-1}(x_{i-1}) = 1$\n    \\item $\\varphi_{i-1}(x_{i}) = 0$\n\\end{itemize}\nThis function represents a straight line passing through the points $(x_{i-1}, 1)$ and $(x_{i}, 0)$. The slope is $\\frac{0-1}{x_{i}-x_{i-1}} = -\\frac{1}{h_{i}}$. Using the point-slope form with the point $(x_{i}, 0)$, the expression for $\\varphi_{i-1}(x)$ on $[x_{i-1}, x_{i}]$ is:\n$$\n\\varphi_{i-1}(x) = -\\frac{1}{h_{i}}(x - x_{i}) = \\frac{x_{i} - x}{h_{i}}\n$$\n\nWith the analytical forms established, we can find their first derivatives with respect to $x$ on the open interval $(x_{i-1}, x_{i})$.\nFor $\\varphi_{i}(x)$:\n$$\n\\varphi_{i}'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{x - x_{i-1}}{h_{i}} \\right) = \\frac{1}{h_{i}}\n$$\nFor $\\varphi_{i-1}(x)$:\n$$\n\\varphi_{i-1}'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{x_{i} - x}{h_{i}} \\right) = -\\frac{1}{h_{i}}\n$$\nBoth derivatives are constant on the interval of integration.\n\nNow, we can substitute these constant derivatives into the integral for $K_{i,i-1}$:\n$$\nK_{i,i-1} = \\int_{x_{i-1}}^{x_{i}} \\left(\\frac{1}{h_{i}}\\right) \\left(-\\frac{1}{h_{i}}\\right) \\,\\mathrm{d}x\n$$\n$$\nK_{i,i-1} = \\int_{x_{i-1}}^{x_{i}} \\left(-\\frac{1}{h_{i}^{2}}\\right) \\,\\mathrm{d}x\n$$\nSince the integrand $-\\frac{1}{h_{i}^{2}}$ is a constant, we can factor it out of the integral:\n$$\nK_{i,i-1} = -\\frac{1}{h_{i}^{2}} \\int_{x_{i-1}}^{x_{i}} 1 \\,\\mathrm{d}x\n$$\nThe remaining definite integral is simply the length of the interval of integration:\n$$\n\\int_{x_{i-1}}^{x_{i}} 1 \\,\\mathrm{d}x = x \\bigg|_{x_{i-1}}^{x_{i}} = x_{i} - x_{i-1} = h_{i}\n$$\nSubstituting this result back, we obtain the final expression for $K_{i,i-1}$:\n$$\nK_{i,i-1} = -\\frac{1}{h_{i}^{2}} \\cdot h_{i} = -\\frac{1}{h_{i}}\n$$\nThe result is expressed solely in terms of $h_{i}$, the length of the element connecting node $i-1$ and node $i$, as required by the problem statement.", "answer": "$$\n\\boxed{-\\frac{1}{h_{i}}}\n$$", "id": "3359188"}, {"introduction": "To complete our construction of the local stiffness matrix contributions, we now address the diagonal entries, $K_{ii} = \\int (\\varphi_i')^2 \\,dx$. This term represents the \"self-interaction\" of a basis function and is formed by summing contributions from the two elements that constitute its support. This practice [@problem_id:3359148] reinforces the concept of element-based assembly, where global matrix entries are built up from local calculations. Mastering this calculation solidifies your understanding of how the properties of a single node are influenced by its immediate neighbors in the discretized model.", "problem": "Consider the standard conforming piecewise-linear finite element method (FEM) for a second-order scalar elliptic model problem on a one-dimensional closed interval. Let the domain be the closed interval $\\left[a,b\\right]$ with a strictly increasing mesh of nodes $\\{x_j\\}_{j=0}^{N}$ satisfying $x_0=a$, $x_N=b$, and $x_{j-1}x_j$ for all $j\\in\\{1,\\dots,N\\}$. Define the local mesh sizes by $h_j:=x_j-x_{j-1}$ for all $j\\in\\{1,\\dots,N\\}$. For an interior node index $i\\in\\{1,\\dots,N-1\\}$, let $\\varphi_i$ denote the canonical one-dimensional linear \"hat\" basis function associated with the node $x_i$, defined by the conditions $\\varphi_i(x_i)=1$, $\\varphi_i(x_j)=0$ for $j\\neq i$, and $\\operatorname{supp}(\\varphi_i)=[x_{i-1},x_{i+1}]$, with $\\varphi_i$ linear on each subinterval $[x_{i-1},x_i]$ and $[x_i,x_{i+1}]$. The symmetric bilinear form corresponding to the diffusion operator with unit coefficient is $a(u,v):=\\int_{a}^{b} u'(x)\\,v'(x)\\,dx$, and the associated stiffness matrix entry on the diagonal for node $i$ is\n$$\nK_{ii}:=\\int_{x_{i-1}}^{x_{i+1}}\\left(\\varphi_i'(x)\\right)^{2}\\,dx.\n$$\nStarting from the definitions above and basic properties of piecewise-linear hat functions, compute $K_{ii}$ in closed form in terms of $h_i$ and $h_{i+1}$. Express your final result as a single simplified symbolic expression. No numerical approximation is required, and no units are involved.", "solution": "The objective is to compute the stiffness matrix diagonal entry $K_{ii}$ associated with an interior node $x_i$. The entry is defined by the integral:\n$$\nK_{ii} := \\int_{x_{i-1}}^{x_{i+1}}\\left(\\varphi_i'(x)\\right)^{2}\\,dx\n$$\nwhere $\\varphi_i(x)$ is the piecewise-linear hat function centered at node $x_i$.\n\nFirst, we must determine the analytical expression for the hat function $\\varphi_i(x)$ and its derivative, $\\varphi_i'(x)$. The function $\\varphi_i(x)$ is defined by the conditions $\\varphi_i(x_i)=1$, $\\varphi_i(x_j)=0$ for $j \\neq i$, and its support being the interval $[x_{i-1}, x_{i+1}]$. It is linear on the subintervals $[x_{i-1}, x_i]$ and $[x_i, x_{i+1}]$.\n\nOn the interval $[x_{i-1}, x_i]$, $\\varphi_i(x)$ is a line segment connecting the points $(x_{i-1}, 0)$ and $(x_i, 1)$. The equation of this line is given by:\n$$\n\\varphi_i(x) = \\frac{x - x_{i-1}}{x_i - x_{i-1}}\n$$\nUsing the definition of the local mesh size, $h_j = x_j - x_{j-1}$, we have $h_i = x_i - x_{i-1}$. Thus, for $x \\in [x_{i-1}, x_i]$:\n$$\n\\varphi_i(x) = \\frac{x - x_{i-1}}{h_i}\n$$\nOn the interval $[x_i, x_{i+1}]$, $\\varphi_i(x)$ is a line segment connecting the points $(x_i, 1)$ and $(x_{i+1}, 0)$. The equation of this line is:\n$$\n\\varphi_i(x) = \\frac{x_{i+1} - x}{x_{i+1} - x_i}\n$$\nUsing the local mesh size $h_{i+1} = x_{i+1} - x_i$, we have for $x \\in [x_i, x_{i+1}]$:\n$$\n\\varphi_i(x) = \\frac{x_{i+1} - x}{h_{i+1}}\n$$\nOutside the support interval $[x_{i-1}, x_{i+1}]$, $\\varphi_i(x) = 0$.\n\nNext, we compute the derivative, $\\varphi_i'(x)$. As $\\varphi_i(x)$ is piecewise linear, its derivative is piecewise constant.\nFor $x \\in (x_{i-1}, x_i)$, the derivative is:\n$$\n\\varphi_i'(x) = \\frac{d}{dx}\\left(\\frac{x - x_{i-1}}{h_i}\\right) = \\frac{1}{h_i}\n$$\nFor $x \\in (x_i, x_{i+1})$, the derivative is:\n$$\n\\varphi_i'(x) = \\frac{d}{dx}\\left(\\frac{x_{i+1} - x}{h_{i+1}}\\right) = -\\frac{1}{h_{i+1}}\n$$\nFor $x \\notin [x_{i-1}, x_{i+1}]$, $\\varphi_i'(x) = 0$. The derivative is undefined at the nodes, but this does not affect the value of the integral.\n\nNow, we can evaluate the integral for $K_{ii}$. The domain of integration $(x_{i-1}, x_{i+1})$ is the support of $\\varphi_i'(x)$. We split the integral into two parts, corresponding to the two subintervals where $\\varphi_i'(x)$ is non-zero:\n$$\nK_{ii} = \\int_{x_{i-1}}^{x_i} (\\varphi_i'(x))^2 \\,dx + \\int_{x_i}^{x_{i+1}} (\\varphi_i'(x))^2 \\,dx\n$$\nWe evaluate each integral separately. For the first integral:\n$$\n\\int_{x_{i-1}}^{x_i} (\\varphi_i'(x))^2 \\,dx = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h_i}\\right)^2 \\,dx = \\frac{1}{h_i^2} \\int_{x_{i-1}}^{x_i} 1 \\,dx\n$$\nThe value of this integral is the constant integrand multiplied by the length of the interval, which is $x_i - x_{i-1} = h_i$:\n$$\n\\frac{1}{h_i^2} \\cdot (x_i - x_{i-1}) = \\frac{1}{h_i^2} \\cdot h_i = \\frac{1}{h_i}\n$$\nFor the second integral:\n$$\n\\int_{x_i}^{x_{i+1}} (\\varphi_i'(x))^2 \\,dx = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h_{i+1}}\\right)^2 \\,dx = \\frac{1}{h_{i+1}^2} \\int_{x_i}^{x_{i+1}} 1 \\,dx\n$$\nThe value of this integral is the constant integrand multiplied by the length of the interval, which is $x_{i+1} - x_i = h_{i+1}$:\n$$\n\\frac{1}{h_{i+1}^2} \\cdot (x_{i+1} - x_i) = \\frac{1}{h_{i+1}^2} \\cdot h_{i+1} = \\frac{1}{h_{i+1}}\n$$\nFinally, we sum the results of the two integrals to obtain $K_{ii}$:\n$$\nK_{ii} = \\frac{1}{h_i} + \\frac{1}{h_{i+1}}\n$$\nThis expression represents the diagonal entry of the stiffness matrix for an interior node $i$ in terms of the adjacent local mesh sizes $h_i$ and $h_{i+1}$.", "answer": "$$\n\\boxed{\\frac{1}{h_i} + \\frac{1}{h_{i+1}}}\n$$", "id": "3359148"}]}