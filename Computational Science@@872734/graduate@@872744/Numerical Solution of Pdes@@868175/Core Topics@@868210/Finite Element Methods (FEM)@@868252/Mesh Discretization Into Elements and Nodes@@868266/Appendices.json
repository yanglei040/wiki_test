{"hands_on_practices": [{"introduction": "The power of the finite element method lies in its ability to handle complex geometries. This is achieved by mapping simple, computationally convenient \"reference\" elements to arbitrarily shaped \"physical\" elements that tile the actual problem domain. This exercise provides hands-on practice with this fundamental procedure, guiding you through the derivation of the isoparametric mapping for a quadrilateral element and the calculation of its Jacobian determinant, a key quantity for transforming integrals between the two coordinate systems.", "problem": "Consider the two-dimensional Finite Element Method (FEM) for solving partial differential equations on quadrilateral meshes. Let the reference element be the square $\\hat{Q}=[-1,1]^2$ with local coordinates $(\\xi,\\eta)$, and let the physical element $Q$ be a convex quadrilateral with vertices ordered counterclockwise and associated with the reference nodes $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$ respectively. The physical coordinates of the four corner nodes are specified as\n$$\n(x_1,y_1)=(0,0),\\quad (x_2,y_2)=(2,0),\\quad (x_3,y_3)=(3,1.5),\\quad (x_4,y_4)=(1,1.5).\n$$\nStarting from the fundamental definition of the one-dimensional linear Lagrange basis on $[-1,1]$ and its tensor-product construction on $\\hat{Q}$, derive the isoparametric bilinear mapping $(x(\\xi,\\eta),y(\\xi,\\eta))$ from $\\hat{Q}$ to $Q$ using nodal shape functions. Then compute the Jacobian determinant\n$$\nJ(\\xi,\\eta)=\\det\\left(\\begin{pmatrix}\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\[4pt] \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\\end{pmatrix}\\right)\n$$\nfor the specified corner coordinates. Express the final result as a single simplified analytic expression for $J(\\xi,\\eta)$.", "solution": "The problem is valid as it is scientifically grounded in the principles of the Finite Element Method, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. We can proceed with the derivation.\n\nThe goal is to compute the Jacobian determinant $J(\\xi, \\eta)$ of the isoparametric mapping from a reference square element $\\hat{Q}=[-1,1]^2$ to a physical quadrilateral element $Q$. The mapping is constructed using bilinear shape functions.\n\nFirst, we define the one-dimensional linear Lagrange basis functions on the interval $[-1,1]$. Let the local coordinate be $z$. The two nodes are at $z=-1$ and $z=1$. The basis function $L_1(z)$ is $1$ at $z=-1$ and $0$ at $z=1$, while $L_2(z)$ is $0$ at $z=-1$ and $1$ at $z=1$. Their expressions are:\n$$\nL_1(z) = \\frac{1}{2}(1-z) \\quad \\text{and} \\quad L_2(z) = \\frac{1}{2}(1+z)\n$$\n\nNext, we construct the two-dimensional bilinear shape functions $N_i(\\xi, \\eta)$ for the four nodes of the reference square $\\hat{Q}$ by taking tensor products of the one-dimensional basis functions. The nodes are ordered counterclockwise:\nNode $1$: $(\\xi_1, \\eta_1) = (-1,-1)$\nNode $2$: $(\\xi_2, \\eta_2) = (1,-1)$\nNode $3$: $(\\xi_3, \\eta_3) = (1,1)$\nNode $4$: $(\\xi_4, \\eta_4) = (-1,1)$\n\nThe shape functions are:\n$$\nN_1(\\xi, \\eta) = L_1(\\xi) L_1(\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)\n$$\n$$\nN_2(\\xi, \\eta) = L_2(\\xi) L_1(\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n$$\n$$\nN_3(\\xi, \\eta) = L_2(\\xi) L_2(\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\n$$\n$$\nN_4(\\xi, \\eta) = L_1(\\xi) L_2(\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n\nThe isoparametric mapping relates the physical coordinates $(x,y)$ to the reference coordinates $(\\xi,\\eta)$ using these shape functions and the physical coordinates of the element's vertices $(x_i, y_i)$. The mapping is defined as:\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i\n$$\n$$\ny(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\nThe given physical coordinates are:\n$(x_1, y_1) = (0,0)$, $(x_2, y_2) = (2,0)$, $(x_3, y_3) = (3, 1.5)$, $(x_4, y_4) = (1, 1.5)$. To maintain precision, we use $1.5 = \\frac{3}{2}$.\n\nWe substitute the coordinates and shape functions into the mapping equations. For the $x$-coordinate:\n$$\nx(\\xi, \\eta) = N_1(0) + N_2(2) + N_3(3) + N_4(1)\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(3) + \\frac{1}{4}(1-\\xi)(1+\\eta)(1)\n$$\nExpanding and collecting terms in powers of $\\xi$, $\\eta$, and $\\xi\\eta$:\n$$\n4x(\\xi, \\eta) = 2(1+\\xi-\\eta-\\xi\\eta) + 3(1+\\xi+\\eta+\\xi\\eta) + (1-\\xi+\\eta-\\xi\\eta)\n$$\n$$\n4x(\\xi, \\eta) = (2+3+1) + (2\\xi+3\\xi-\\xi) + (-2\\eta+3\\eta+\\eta) + (-2\\xi\\eta+3\\xi\\eta-\\xi\\eta)\n$$\n$$\n4x(\\xi, \\eta) = 6 + 4\\xi + 2\\eta + 0\\xi\\eta\n$$\n$$\nx(\\xi, \\eta) = \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta\n$$\nFor the $y$-coordinate:\n$$\ny(\\xi, \\eta) = N_1(0) + N_2(0) + N_3\\left(\\frac{3}{2}\\right) + N_4\\left(\\frac{3}{2}\\right)\n$$\n$$\ny(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\\left(\\frac{3}{2}\\right) + \\frac{1}{4}(1-\\xi)(1+\\eta)\\left(\\frac{3}{2}\\right)\n$$\nFactoring out common terms:\n$$\ny(\\xi, \\eta) = \\frac{3}{8}(1+\\eta) \\left[ (1+\\xi) + (1-\\xi) \\right]\n$$\n$$\ny(\\xi, \\eta) = \\frac{3}{8}(1+\\eta)(2) = \\frac{3}{4}(1+\\eta)\n$$\n$$\ny(\\xi, \\eta) = \\frac{3}{4} + \\frac{3}{4}\\eta\n$$\nThe mapping is affine, which is a special case of a bilinear map that occurs when the physical element is a parallelogram.\n\nNow, we compute the components of the Jacobian matrix $\\mathbf{J}$:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\[-8pt] \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta \\right) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta \\right) = \\frac{1}{2}\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{3}{4} + \\frac{3}{4}\\eta \\right) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{3}{4} + \\frac{3}{4}\\eta \\right) = \\frac{3}{4}\n$$\nThe Jacobian matrix is constant for this element:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 1  \\frac{1}{2} \\\\[-8pt] 0  \\frac{3}{4} \\end{pmatrix}\n$$\nFinally, the Jacobian determinant $J(\\xi, \\eta)$ is the determinant of this matrix:\n$$\nJ(\\xi, \\eta) = \\det(\\mathbf{J}) = (1)\\left(\\frac{3}{4}\\right) - \\left(\\frac{1}{2}\\right)(0) = \\frac{3}{4}\n$$\nThe Jacobian determinant is a constant value, independent of $(\\xi,\\eta)$, which confirms that the mapping is affine and the physical element is a parallelogram. The value represents the ratio of the area of the physical element to the area of the reference element, scaled by a factor related to orientation. Specifically, $\\text{Area}(Q) = \\int_{\\hat{Q}} J(\\xi, \\eta) d\\xi d\\eta = \\frac{3}{4} \\times \\text{Area}(\\hat{Q}) = \\frac{3}{4} \\times 4 = 3$.", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "3419691"}, {"introduction": "Not all elements are created equal; the shape and size of elements in a mesh can significantly impact the accuracy and stability of a numerical solution. To ensure a reliable simulation, we must quantify the quality of our mesh using geometric metrics. This practice [@problem_id:3419698] delves into this crucial step by asking you to compute several standard quality indicators—such as the condition number of the element map, aspect ratio, and minimum internal angle—for a tetrahedral element and assess it against typical quality thresholds.", "problem": "Consider a single linear tetrahedral finite element used in the numerical solution of a Partial Differential Equation (PDE). The reference tetrahedron $\\hat{K}$ has vertices $\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$, $\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$, $\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$, and $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$. The physical tetrahedron $K$ has vertices $\\boldsymbol{x}_{1}=(0,0,0)$, $\\boldsymbol{x}_{2}=(2,0,0)$, $\\boldsymbol{x}_{3}=(0,1,0)$, and $\\boldsymbol{x}_{4}=(0,0,0.5)$.\n\nThe element mapping $F_{K}:\\hat{K}\\rightarrow K$ is affine, and its deformation gradient $DF_{K}$ is constant on $K$. The operator $2$-norm (spectral norm) is to be used throughout.\n\nTasks:\n1. Derive $DF_{K}$ from first principles and compute the condition number $\\kappa(DF_{K})=\\|DF_{K}\\|\\,\\|DF_{K}^{-1}\\|$.\n2. Compute the element’s aspect ratio defined as the ratio of the longest to the shortest edge length among the six edges of $K$.\n3. Compute the minimum internal angle over all triangular faces of $K$ (angles measured in degrees), and assess whether the element satisfies both of the following prescribed quality thresholds:\n   - Minimum face angle threshold: $20^\\circ$.\n   - Condition number threshold: $4.1$.\nState clearly whether the element passes each threshold.\n\nAnswer specification:\n- The final answer must be the single numerical value of $\\kappa(DF_{K})$.\n- Round your final $\\kappa(DF_{K})$ to four significant figures.\n- The condition number is dimensionless; do not include any units in your final answer.\n- All angles must be expressed in degrees.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Element Type**: Single linear tetrahedral finite element.\n- **Reference Tetrahedron $\\hat{K}$ vertices**: $\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$, $\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$, $\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$, $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$.\n- **Physical Tetrahedron $K$ vertices**: $\\boldsymbol{x}_{1}=(0,0,0)$, $\\boldsymbol{x}_{2}=(2,0,0)$, $\\boldsymbol{x}_{3}=(0,1,0)$, $\\boldsymbol{x}_{4}=(0,0,0.5)$.\n- **Mapping**: The element mapping $F_{K}:\\hat{K}\\rightarrow K$ is affine.\n- **Deformation Gradient**: $DF_{K}$ is constant on $K$.\n- **Norm**: The operator $2$-norm (spectral norm) is to be used.\n- **Tasks**:\n  1. Derive $DF_{K}$ and compute the condition number $\\kappa(DF_{K})=\\|DF_{K}\\|\\,\\|DF_{K}^{-1}\\|$.\n  2. Compute the element’s aspect ratio (longest edge / shortest edge).\n  3. Compute the minimum internal angle over all triangular faces of $K$ (in degrees).\n  4. Assess whether the element satisfies the quality thresholds: minimum face angle $ 20^\\circ$ and condition number $ 4.1$.\n- **Answer Specification**:\n  - The final answer is the numerical value of $\\kappa(DF_{K})$.\n  - Round to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded in the theory of the Finite Element Method (FEM), specifically concerning element quality metrics for a linear tetrahedral element. All terms like \"affine mapping\", \"deformation gradient\", \"condition number\", \"aspect ratio\", and \"minimum internal angle\" are standard, well-defined concepts in numerical analysis and computational mechanics. The provided data (vertex coordinates) are complete and self-consistent. The problem is well-posed, objective, and admits a unique, verifiable solution. It does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe analysis proceeds by addressing the three specified tasks in order.\n\n**1. Deformation Gradient and Condition Number**\n\nAn affine mapping $F_{K}$ from the reference element coordinates $\\hat{\\boldsymbol{x}} \\in \\hat{K}$ to the physical element coordinates $\\boldsymbol{x} \\in K$ is of the form:\n$$ \\boldsymbol{x} = F_K(\\hat{\\boldsymbol{x}}) = \\boldsymbol{B} \\hat{\\boldsymbol{x}} + \\boldsymbol{b} $$\nwhere $\\boldsymbol{B}$ is a constant $3 \\times 3$ matrix and $\\boldsymbol{b}$ is a constant translation vector. The deformation gradient, $DF_{K}$, is the Jacobian of this mapping, which is simply the matrix $\\boldsymbol{B}$.\n$$ DF_K = \\frac{\\partial \\boldsymbol{x}}{\\partial \\hat{\\boldsymbol{x}}} = \\boldsymbol{B} $$\nTo determine $\\boldsymbol{B}$ and $\\boldsymbol{b}$, we use the mapping of the vertices. For the first vertex, $\\hat{\\boldsymbol{x}}_{1} = (0,0,0)^T$ maps to $\\boldsymbol{x}_{1} = (0,0,0)^T$.\n$$ \\boldsymbol{x}_1 = \\boldsymbol{B} \\hat{\\boldsymbol{x}}_1 + \\boldsymbol{b} \\implies (0,0,0)^T = \\boldsymbol{B} (0,0,0)^T + \\boldsymbol{b} \\implies \\boldsymbol{b} = \\boldsymbol{0} $$\nThe mapping is purely linear: $\\boldsymbol{x} = \\boldsymbol{B} \\hat{\\boldsymbol{x}}$. The edge vectors of the physical element originating from $\\boldsymbol{x}_1$ can be expressed in terms of the mapping and the edge vectors of the reference element originating from $\\hat{\\boldsymbol{x}}_1$. Let $\\boldsymbol{v}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_1$ and $\\hat{\\boldsymbol{v}}_i = \\hat{\\boldsymbol{x}}_i - \\hat{\\boldsymbol{x}}_1$ for $i \\in \\{2, 3, 4\\}$.\n$$ \\boldsymbol{v}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_1 = (\\boldsymbol{B}\\hat{\\boldsymbol{x}}_i + \\boldsymbol{b}) - (\\boldsymbol{B}\\hat{\\boldsymbol{x}}_1 + \\boldsymbol{b}) = \\boldsymbol{B}(\\hat{\\boldsymbol{x}}_i - \\hat{\\boldsymbol{x}}_1) = \\boldsymbol{B}\\hat{\\boldsymbol{v}}_i $$\nThe reference edge vectors are:\n$$ \\hat{\\boldsymbol{v}}_2 = (1,0,0)^T, \\quad \\hat{\\boldsymbol{v}}_3 = (0,1,0)^T, \\quad \\hat{\\boldsymbol{v}}_4 = (0,0,1)^T $$\nThe corresponding physical edge vectors are:\n$$ \\boldsymbol{v}_2 = (2,0,0)^T, \\quad \\boldsymbol{v}_3 = (0,1,0)^T, \\quad \\boldsymbol{v}_4 = (0,0,0.5)^T $$\nWe can write this as a matrix equation:\n$$ [\\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{v}_4] = \\boldsymbol{B} [\\hat{\\boldsymbol{v}}_2, \\hat{\\boldsymbol{v}}_3, \\hat{\\boldsymbol{v}}_4] $$\nSince $[\\hat{\\boldsymbol{v}}_2, \\hat{\\boldsymbol{v}}_3, \\hat{\\boldsymbol{v}}_4]$ is the $3 \\times 3$ identity matrix $\\boldsymbol{I}$, we find that $\\boldsymbol{B}$ is simply the matrix of physical edge vectors:\n$$ DF_K = \\boldsymbol{B} = [\\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{v}_4] = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  0.5 \\end{pmatrix} $$\nThe condition number $\\kappa(DF_{K})$ with respect to the operator $2$-norm is defined as the ratio of the largest to the smallest singular value of $DF_{K}$, $\\kappa(DF_{K}) = \\sigma_{\\max} / \\sigma_{\\min}$. Since $DF_{K}$ is a diagonal matrix, its singular values are the absolute values of its diagonal entries: $\\sigma_1=2$, $\\sigma_2=1$, and $\\sigma_3=0.5$.\nThe largest singular value is $\\sigma_{\\max} = 2$.\nThe smallest singular value is $\\sigma_{\\min} = 0.5$.\nThe condition number is:\n$$ \\kappa(DF_{K}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{2}{0.5} = 4 $$\nAlternatively, $\\kappa(DF_{K})=\\|DF_{K}\\|_2\\,\\|DF_{K}^{-1}\\|_2$. We have $\\|DF_{K}\\|_2 = \\sigma_{\\max} = 2$. The inverse is $DF_{K}^{-1} = \\text{diag}(1/2, 1, 2)$, so $\\|DF_{K}^{-1}\\|_2 = \\max(1/2, 1, 2) = 2$. Thus, $\\kappa(DF_K) = 2 \\times 2 = 4$.\n\n**2. Aspect Ratio**\n\nThe aspect ratio is the ratio of the longest edge length to the shortest edge length. We must compute the lengths of the $6$ edges of the physical tetrahedron $K$. Let $L_{ij} = \\|\\boldsymbol{x}_i - \\boldsymbol{x}_j\\|$.\n- $L_{12} = \\|(2,0,0) - (0,0,0)\\| = 2$\n- $L_{13} = \\|(0,1,0) - (0,0,0)\\| = 1$\n- $L_{14} = \\|(0,0,0.5) - (0,0,0)\\| = 0.5$\n- $L_{23} = \\|(0,1,0) - (2,0,0)\\| = \\|(-2,1,0)\\| = \\sqrt{(-2)^2+1^2+0^2} = \\sqrt{5}$\n- $L_{24} = \\|(0,0,0.5) - (2,0,0)\\| = \\|(-2,0,0.5)\\| = \\sqrt{(-2)^2+0^2+0.5^2} = \\sqrt{4+0.25} = \\sqrt{4.25} = \\frac{\\sqrt{17}}{2}$\n- $L_{34} = \\|(0,0,0.5) - (0,1,0)\\| = \\|(0,-1,0.5)\\| = \\sqrt{0^2+(-1)^2+0.5^2} = \\sqrt{1+0.25} = \\sqrt{1.25} = \\frac{\\sqrt{5}}{2}$\nThe edge lengths are approximately $\\{2, 1, 0.5, 2.236, 2.062, 1.118\\}$.\nThe longest edge is $L_{\\max} = L_{23} = \\sqrt{5}$.\nThe shortest edge is $L_{\\min} = L_{14} = 0.5$.\nThe aspect ratio is:\n$$ \\text{Aspect Ratio} = \\frac{L_{\\max}}{L_{\\min}} = \\frac{\\sqrt{5}}{0.5} = 2\\sqrt{5} \\approx 4.472 $$\n\n**3. Minimum Internal Angle and Quality Assessment**\n\nWe compute the internal angles for each of the $4$ triangular faces using the dot product formula for the angle $\\theta$ between two vectors $\\boldsymbol{u}$ and $\\boldsymbol{v}$: $\\cos\\theta = (\\boldsymbol{u} \\cdot \\boldsymbol{v}) / (\\|\\boldsymbol{u}\\| \\|\\boldsymbol{v}\\|)$.\n\n- **Face 1 ($\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3$):** Vectors from $\\boldsymbol{x}_1$ are $\\boldsymbol{v}_{12}=(2,0,0)$ and $\\boldsymbol{v}_{13}=(0,1,0)$. Since $\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{13} = 0$, the angle at $\\boldsymbol{x}_1$ is $90^\\circ$. The other angles are $\\arccos(2/\\sqrt{5}) \\approx 26.57^\\circ$ and $\\arccos(1/\\sqrt{5}) \\approx 63.43^\\circ$.\n\n- **Face 2 ($\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_4$):** Vectors from $\\boldsymbol{x}_1$ are $\\boldsymbol{v}_{12}=(2,0,0)$ and $\\boldsymbol{v}_{14}=(0,0,0.5)$. Since $\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{14} = 0$, the angle at $\\boldsymbol{x}_1$ is $90^\\circ$. The other angles are $\\arccos(4/\\sqrt{17}) \\approx 14.04^\\circ$ and $\\arccos(1/\\sqrt{17}) \\approx 75.96^\\circ$.\n\n- **Face 3 ($\\boldsymbol{x}_1, \\boldsymbol{x}_3, \\boldsymbol{x}_4$):** Vectors from $\\boldsymbol{x}_1$ are $\\boldsymbol{v}_{13}=(0,1,0)$ and $\\boldsymbol{v}_{14}=(0,0,0.5)$. Since $\\boldsymbol{v}_{13} \\cdot \\boldsymbol{v}_{14} = 0$, the angle at $\\boldsymbol{x}_1$ is $90^\\circ$. The other angles are $\\arccos(2/\\sqrt{5}) \\approx 26.57^\\circ$ and $\\arccos(1/\\sqrt{5}) \\approx 63.43^\\circ$.\n\n- **Face 4 ($\\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4$):**\n    - Angle at $\\boldsymbol{x}_2$: Vectors are $\\boldsymbol{x}_3-\\boldsymbol{x}_2=(-2,1,0)$ and $\\boldsymbol{x}_4-\\boldsymbol{x}_2=(-2,0,0.5)$. Angle is $\\arccos(8/\\sqrt{85}) \\approx 29.74^\\circ$.\n    - Angle at $\\boldsymbol{x}_3$: Vectors are $\\boldsymbol{x}_2-\\boldsymbol{x}_3=(2,-1,0)$ and $\\boldsymbol{x}_4-\\boldsymbol{x}_3=(0,-1,0.5)$. Angle is $\\arccos(1/2.5) = \\arccos(0.4) \\approx 66.42^\\circ$.\n    - Angle at $\\boldsymbol{x}_4$: Vectors are $\\boldsymbol{x}_2-\\boldsymbol{x}_4=(2,0,-0.5)$ and $\\boldsymbol{x}_3-\\boldsymbol{x}_4=(0,1,-0.5)$. Angle is $\\arccos(1/\\sqrt{85}) \\approx 83.83^\\circ$.\n\nThe minimum angle over all faces is $\\theta_{\\min} = \\arccos(4/\\sqrt{17}) \\approx 14.04^\\circ$.\n\n**Assessment of Quality Thresholds:**\n\n- **Minimum face angle threshold ($20^\\circ$):**\nThe computed minimum angle is $14.04^\\circ$. Since $14.04^\\circ  20^\\circ$, the element **FAILS** this quality threshold.\n\n- **Condition number threshold ($4.1$):**\nThe computed condition number is $\\kappa(DF_K) = 4$. Since $4  4.1$, the element **PASSES** this quality threshold.\n\nAs per the answer specification, the final answer is the value of $\\kappa(DF_{K})$ rounded to four significant figures.\n$$ \\kappa(DF_K) = 4.000 $$", "answer": "$$\\boxed{4.000}$$", "id": "3419698"}, {"introduction": "Moving from the single-element level to the global mesh, the way we number the nodes—a seemingly mundane bookkeeping task—has a dramatic impact on the computational cost of solving the resulting system of linear equations. The connectivity of the mesh dictates the sparsity pattern of the global stiffness matrix, and reordering nodes can drastically reduce the matrix bandwidth, leading to faster factorization. This exercise [@problem_id:3419715] makes this connection tangible by having you apply the Reverse Cuthill–McKee (RCM) algorithm to a small mesh and quantify its impressive effect on the cost of Cholesky factorization.", "problem": "Consider the scalar Poisson problem on a two-dimensional domain discretized by linear triangular finite elements, resulting in a symmetric positive definite (SPD) stiffness matrix whose graph has a vertex for each mesh node and an undirected edge between two vertices if and only if the corresponding nodes appear together in at least one triangle. The mesh nodes are labeled in the initial ordering by $1,2,\\dots,9$ in row-major order on a $3 \\times 3$ grid. The triangulation consists of the following $8$ triangles:\n- $(1,2,5)$, $(1,4,5)$, $(2,3,6)$, $(2,5,6)$,\n- $(4,5,8)$, $(4,7,8)$, $(5,6,9)$, $(5,8,9)$.\n\nUsing the graph induced by this triangulation:\n- Define the half-bandwidth $b$ of an ordering as $b \\equiv \\max\\{|i-j| : (i,j)\\text{ is a nonzero position of the matrix}\\}$, where $i$ and $j$ are row and column indices in the given ordering and symmetry is understood.\n- The Reverse Cuthill–McKee (RCM) algorithm proceeds as follows for this problem: perform a breadth-first search (BFS) from a specified start node, enqueuing at each step the currently unvisited neighbors of the dequeued node in ascending order of their degree (number of graph neighbors), with ties broken by ascending node index; mark nodes as visited upon enqueue. The Cuthill–McKee ordering is the sequence of first-time visits produced by this BFS; the RCM ordering is the reverse of that sequence.\n\nTasks:\n- Compute the original half-bandwidth $b_0$ under the initial ordering $(1,2,\\dots,9)$ using the graph implied by the above triangulation.\n- Execute the above RCM procedure starting from node $3$ and using the stated tie-breaking rule to obtain a specific RCM ordering. Compute the half-bandwidth $b_1$ in this RCM ordering.\n- Using first principles about how band structure governs the dominant cost of Cholesky factorization for SPD banded matrices, derive a leading-order expression for the ratio $r$ of the Cholesky floating-point operation count after RCM to that before RCM, expressed in terms of $b_0$ and $b_1$, and then evaluate $r$ numerically for your computed $b_0$ and $b_1$.\n\nReport as your final answer only the numerical value of $r$, rounded to four significant figures. The answer is dimensionless.", "solution": "The problem requires the analysis of a sparse matrix reordering algorithm, specifically Reverse Cuthill–McKee (RCM), and its effect on the computational cost of Cholesky factorization. The analysis is performed on a graph derived from a finite element mesh.\n\nFirst, we must construct the graph representing the connectivity of the mesh nodes. The vertices of the graph are the nodes, labeled $1, 2, \\dots, 9$. An edge exists between two vertices if the corresponding nodes are part of the same triangular element. The given triangles are $(1,2,5)$, $(1,4,5)$, $(2,3,6)$, $(2,5,6)$, $(4,5,8)$, $(4,7,8)$, $(5,6,9)$, and $(5,8,9)$. From these, we can determine the set of all edges, which correspond to the non-zero off-diagonal entries of the symmetric stiffness matrix. The adjacency list for the graph is as follows:\n- Node $1$: neighbors are $\\{2, 4, 5\\}$\n- Node $2$: neighbors are $\\{1, 3, 5, 6\\}$\n- Node $3$: neighbors are $\\{2, 6\\}$\n- Node $4$: neighbors are $\\{1, 5, 7, 8\\}$\n- Node $5$: neighbors are $\\{1, 2, 4, 6, 8, 9\\}$\n- Node $6$: neighbors are $\\{2, 3, 5, 9\\}$\n- Node $7$: neighbors are $\\{4, 8\\}$\n- Node $8$: neighbors are $\\{4, 5, 7, 9\\}$\n- Node $9$: neighbors are $\\{5, 6, 8\\}$\n\nThe degree of each vertex (number of neighbors) is:\n- $\\text{deg}(1) = 3$\n- $\\text{deg}(2) = 4$\n- $\\text{deg}(3) = 2$\n- $\\text{deg}(4) = 4$\n- $\\text{deg}(5) = 6$\n- $\\text{deg}(6) = 4$\n- $\\text{deg}(7) = 2$\n- $\\text{deg}(8) = 4$\n- $\\text{deg}(9) = 3$\n\nThe first task is to compute the half-bandwidth $b_0$ for the initial ordering $(1, 2, \\dots, 9)$. The half-bandwidth $b$ is defined as $b \\equiv \\max\\{|i-j| : (i,j) \\text{ is an edge}\\}$. We compute $|i-j|$ for all edges in the graph:\n- Edges from node $1$: $|1-2|=1, |1-4|=3, |1-5|=4$\n- Edges from node $2$: $|2-3|=1, |2-5|=3, |2-6|=4$\n- Edges from node $3$: $|3-6|=3$\n- Edges from node $4$: $|4-5|=1, |4-7|=3, |4-8|=4$\n- Edges from node $5$: $|5-6|=1, |5-8|=3, |5-9|=4$\n- Edges from node $6$: $|6-9|=3$\n- Edges from node $7$: $|7-8|=1$\n- Edges from node $8$: $|8-9|=1$\nThe maximum of these values is $4$. Thus, the original half-bandwidth is $b_0 = 4$.\n\nThe second task is to find the RCM ordering starting from node $3$ and compute the new half-bandwidth $b_1$. The RCM algorithm first generates a Cuthill–McKee (CM) ordering via a specific Breadth-First Search (BFS).\nThe BFS proceeds as follows:\n1.  Start with a queue containing only the start node, $3$. The set of visited nodes is $\\{3\\}$. The CM ordering begins with $(3)$.\n2.  Dequeue $3$. Its neighbors are $\\{2, 6\\}$. Both are unvisited. We sort them by degree: $\\text{deg}(2)=4, \\text{deg}(6)=4$. The degrees are tied, so we break the tie using the node indices: $2  6$. We enqueue $2$ then $6$. The CM ordering is now $(3, 2, 6)$.\n3.  Dequeue $2$. Its unvisited neighbors are $\\{1, 5\\}$. We sort them by degree: $\\text{deg}(1)=3, \\text{deg}(5)=6$. We enqueue $1$ then $5$. The CM ordering is now $(3, 2, 6, 1, 5)$.\n4.  Dequeue $6$. Its only unvisited neighbor is $\\{9\\}$. We enqueue $9$. The CM ordering is now $(3, 2, 6, 1, 5, 9)$.\n5.  Dequeue $1$. Its only unvisited neighbor is $\\{4\\}$. We enqueue $4$. The CM ordering is now $(3, 2, 6, 1, 5, 9, 4)$.\n6.  Dequeue $5$. Its only unvisited neighbor is $\\{8\\}$. We enqueue $8$. The CM ordering is now $(3, 2, 6, 1, 5, 9, 4, 8)$.\n7.  Dequeue $9$. It has no unvisited neighbors.\n8.  Dequeue $4$. Its only unvisited neighbor is $\\{7\\}$. We enqueue $7$. The CM ordering is now $(3, 2, 6, 1, 5, 9, 4, 8, 7)$.\n9.  The remaining nodes in the queue ($8$ and $7$) have no unvisited neighbors. The BFS is complete.\n\nThe CM ordering is $(3, 2, 6, 1, 5, 9, 4, 8, 7)$.\nThe RCM ordering is the reverse of the CM ordering: $p_{RCM} = (7, 8, 4, 9, 5, 1, 6, 2, 3)$.\nThis gives a mapping from the new indices $i' \\in \\{1, \\dots, 9\\}$ to the original indices $j \\in \\{1, \\dots, 9\\}$. Let's denote this mapping by $j(i')$.\n$j(1)=7, j(2)=8, j(3)=4, j(4)=9, j(5)=5, j(6)=1, j(7)=6, j(8)=2, j(9)=3$.\nThe inverse mapping, from original index $j$ to new index $i'$, is:\n$i'(1)=6, i'(2)=8, i'(3)=9, i'(4)=3, i'(5)=5, i'(6)=7, i'(7)=1, i'(8)=2, i'(9)=4$.\n\nWe now compute the half-bandwidth $b_1$ in this new ordering. We check the difference $|i'(j_1) - i'(j_2)|$ for every original edge $(j_1, j_2)$:\n- $(1,2) \\to |i'(1)-i'(2)| = |6-8|=2$\n- $(1,4) \\to |i'(1)-i'(4)| = |6-3|=3$\n- $(1,5) \\to |i'(1)-i'(5)| = |6-5|=1$\n- $(2,3) \\to |i'(2)-i'(3)| = |8-9|=1$\n- $(2,5) \\to |i'(2)-i'(5)| = |8-5|=3$\n- $(2,6) \\to |i'(2)-i'(6)| = |8-7|=1$\n- $(3,6) \\to |i'(3)-i'(6)| = |9-7|=2$\n- $(4,5) \\to |i'(4)-i'(5)| = |3-5|=2$\n- $(4,7) \\to |i'(4)-i'(7)| = |3-1|=2$\n- $(4,8) \\to |i'(4)-i'(8)| = |3-2|=1$\n- $(5,6) \\to |i'(5)-i'(6)| = |5-7|=2$\n- $(5,8) \\to |i'(5)-i'(8)| = |5-2|=3$\n- $(5,9) \\to |i'(5)-i'(9)| = |5-4|=1$\n- $(6,9) \\to |i'(6)-i'(9)| = |7-4|=3$\n- $(7,8) \\to |i'(7)-i'(8)| = |1-2|=1$\n- $(8,9) \\to |i'(8)-i'(9)| = |2-4|=2$\nThe maximum of these values is $3$. Thus, the new half-bandwidth is $b_1 = 3$.\n\nThe third task is to derive an expression for the ratio of factorization costs. For a large $N \\times N$ SPD matrix with half-bandwidth $b \\ll N$, the number of floating-point operations (flops) required for a Cholesky factorization ($A=LL^T$) is dominated by operations within the band. At each of the $N$ stages of the factorization (for each column), the work involves manipulating vectors of length approximately $b$. The cost per stage is proportional to $b^2$. Summing over all $N$ stages, the total leading-order cost $C$ is given by:\n$$C \\approx k N b^2$$\nwhere $k$ is a constant of proportionality.\n\nThe ratio $r$ of the Cholesky factorization cost after reordering ($C_1$) to the cost before reordering ($C_0$) can be expressed using this leading-order model. The matrix size $N=9$ is the same for both cases.\n$$r = \\frac{C_1}{C_0} \\approx \\frac{k N b_1^2}{k N b_0^2} = \\left(\\frac{b_1}{b_0}\\right)^2$$\n\nFinally, we evaluate this ratio using our computed bandwidths $b_0=4$ and $b_1=3$:\n$$r = \\left(\\frac{3}{4}\\right)^2 = \\frac{9}{16} = 0.5625$$\nThe problem asks for this value rounded to four significant figures. The value $0.5625$ already has four significant figures.", "answer": "$$\\boxed{0.5625}$$", "id": "3419715"}]}