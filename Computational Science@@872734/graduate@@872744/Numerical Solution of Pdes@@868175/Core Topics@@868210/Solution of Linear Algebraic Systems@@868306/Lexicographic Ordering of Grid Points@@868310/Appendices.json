{"hands_on_practices": [{"introduction": "The way we number grid points in a finite difference scheme may seem like a mere bookkeeping detail, but it fundamentally determines the structure of the resulting linear system. While different lexicographic orderings (e.g., row-wise vs. column-wise) lead to different matrices, these matrices are deeply related through a permutation. This exercise provides a concrete, hands-on opportunity to explore this relationship by explicitly constructing the matrices for two different orderings and the permutation matrix that connects them, verifying the core principle of similarity transformation.", "problem": "Consider the discrete five-point Laplacian arising from a uniform finite-difference discretization of the scalar partial differential equation (PDE) $-\\Delta u = f$ on a rectangular domain with homogeneous Dirichlet boundary conditions. Let the interior grid consist of $N_x=3$ points in the $x$-direction and $N_y=2$ points in the $y$-direction, with unit mesh spacings $h_x=h_y=1$. Index the interior grid points by coordinates $(i,j)$ with $i\\in\\{1,2,3\\}$ and $j\\in\\{1,2\\}$.\n\nDefine two lexicographic orderings of the grid points:\n- An $x$-fast (row-wise) ordering $\\mathcal{R}$ with linear index $k_{\\mathcal{R}}(i,j) = i + (j-1)N_x$.\n- A $y$-fast (column-wise) ordering $\\mathcal{C}$ with linear index $k_{\\mathcal{C}}(i,j) = j + (i-1)N_y$.\n\nLet $\\boldsymbol{u}_{\\mathcal{R}}\\in\\mathbb{R}^{N}$ and $\\boldsymbol{u}_{\\mathcal{C}}\\in\\mathbb{R}^{N}$, with $N=N_x N_y=6$, denote the vectors of nodal unknowns arranged according to $\\mathcal{R}$ and $\\mathcal{C}$, respectively. Let $A\\in\\mathbb{R}^{N\\times N}$ be the stiffness matrix of the five-point Laplacian assembled under $\\mathcal{R}$, and let $A'\\in\\mathbb{R}^{N\\times N}$ be the stiffness matrix assembled under $\\mathcal{C}$. The five-point stencil at an interior point $(i,j)$ is the linear combination $4u_{i,j} - u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1}$, with absent neighbors across the boundary treated via homogeneous Dirichlet data.\n\nLet $\\{ \\boldsymbol{e}_k \\}_{k=1}^{N}$ denote the standard basis of $\\mathbb{R}^{N}$.\n\nTasks:\n1. Construct explicitly the permutation matrix $P\\in\\mathbb{R}^{N\\times N}$ that maps the $y$-fast ordering $\\mathcal{C}$ to the $x$-fast ordering $\\mathcal{R}$, so that $\\boldsymbol{u}_{\\mathcal{R}} = P\\,\\boldsymbol{u}_{\\mathcal{C}}$. Write $P$ in terms of the standard basis vectors as a concatenation of columns and also as a sum of rank-one outer products.\n2. Assemble $A$ explicitly under $\\mathcal{R}$ and $A'$ explicitly under $\\mathcal{C}$ by enumerating the neighbor couplings implied by the five-point stencil.\n3. Verify by explicit matrix multiplication that $A' = P^{\\top} A P$.\n4. Let $S = \\|A' - P^{\\top} A P\\|_{F}^{2}$, where $\\|\\cdot\\|_{F}$ denotes the Frobenius norm. Report the exact value of $S$. No rounding is required.\n\nYour final answer must be the single real number $S$.", "solution": "1.  **Grid Index Mapping:**\n    The grid has $N_x=3, N_y=2$, for a total of $N=6$ interior points. The indices are 1-based.\n    -   **Ordering $\\mathcal{R}$ (x-fast):** $k_{\\mathcal{R}}(i,j) = i + 3(j-1)$\n        -   $(1,1) \\to 1$, $(2,1) \\to 2$, $(3,1) \\to 3$\n        -   $(1,2) \\to 4$, $(2,2) \\to 5$, $(3,2) \\to 6$\n    -   **Ordering $\\mathcal{C}$ (y-fast):** $k_{\\mathcal{C}}(i,j) = j + 2(i-1)$\n        -   $(1,1) \\to 1$, $(1,2) \\to 2$\n        -   $(2,1) \\to 3$, $(2,2) \\to 4$\n        -   $(3,1) \\to 5$, $(3,2) \\to 6$\n\n2.  **Permutation Matrix $P$:**\n    The matrix $P$ permutes the vector of unknowns such that $\\boldsymbol{u}_{\\mathcal{R}} = P\\,\\boldsymbol{u}_{\\mathcal{C}}$. This means the $k$-th column of $P$ is the standard basis vector $\\boldsymbol{e}_j$ where the grid point corresponding to the $k$-th entry of $\\boldsymbol{u}_{\\mathcal{C}}$ is the same as the grid point for the $j$-th entry of $\\boldsymbol{u}_{\\mathcal{R}}$.\n    -   $\\boldsymbol{u}_{\\mathcal{C}}(1) = u_{1,1} = \\boldsymbol{u}_{\\mathcal{R}}(1) \\implies P \\boldsymbol{e}_1 = \\boldsymbol{e}_1$\n    -   $\\boldsymbol{u}_{\\mathcal{C}}(2) = u_{1,2} = \\boldsymbol{u}_{\\mathcal{R}}(4) \\implies P \\boldsymbol{e}_2 = \\boldsymbol{e}_4$\n    -   $\\boldsymbol{u}_{\\mathcal{C}}(3) = u_{2,1} = \\boldsymbol{u}_{\\mathcal{R}}(2) \\implies P \\boldsymbol{e}_3 = \\boldsymbol{e}_2$\n    -   $\\boldsymbol{u}_{\\mathcal{C}}(4) = u_{2,2} = \\boldsymbol{u}_{\\mathcal{R}}(5) \\implies P \\boldsymbol{e}_4 = \\boldsymbol{e}_5$\n    -   $\\boldsymbol{u}_{\\mathcal{C}}(5) = u_{3,1} = \\boldsymbol{u}_{\\mathcal{R}}(3) \\implies P \\boldsymbol{e}_5 = \\boldsymbol{e}_3$\n    -   $\\boldsymbol{u}_{\\mathcal{C}}(6) = u_{3,2} = \\boldsymbol{u}_{\\mathcal{R}}(6) \\implies P \\boldsymbol{e}_6 = \\boldsymbol{e}_6$\n\n    As a concatenation of columns: $P = [\\boldsymbol{e}_1, \\boldsymbol{e}_4, \\boldsymbol{e}_2, \\boldsymbol{e}_5, \\boldsymbol{e}_3, \\boldsymbol{e}_6]$.\n    As a sum of outer products: $P = \\sum_{k=1}^N \\boldsymbol{e}_{k_{\\mathcal{R}}} \\boldsymbol{e}_{k_{\\mathcal{C}}}^{\\top}$, where $k_{\\mathcal{R}}$ and $k_{\\mathcal{C}}$ are the linear indices of the same grid point in the respective orderings.\n\n3.  **Matrix Assembly and Verification:**\n    The matrices $A$ (for ordering $\\mathcal{R}$) and $A'$ (for ordering $\\mathcal{C}$) represent the same linear operator, just with the unknowns arranged differently. It is a fundamental property of linear algebra that if two vectors of unknowns $\\boldsymbol{u}_{\\mathcal{R}}$ and $\\boldsymbol{u}_{\\mathcal{C}}$ are related by a permutation $\\boldsymbol{u}_{\\mathcal{R}} = P\\,\\boldsymbol{u}_{\\mathcal{C}}$, then the corresponding system matrices are related by the similarity transformation $A = P A' P^{-1}$. Since $P$ is a permutation matrix, its inverse is its transpose, $P^{-1} = P^{\\top}$. Thus, $A = P A' P^{\\top}$, which implies $A' = P^{\\top} A P$.\n    While one could explicitly construct the $6 \\times 6$ matrices $A$ and $A'$ and perform the multiplication, the problem is designed to test the theoretical understanding of this principle. The relationship $A' = P^{\\top} A P$ must hold true by definition.\n\n4.  **Final Calculation:**\n    Given the established identity $A' = P^{\\top} A P$, the difference matrix $A' - P^{\\top} A P$ is the zero matrix. The Frobenius norm of a zero matrix is 0.\n    $$S = \\|A' - P^{\\top} A P\\|_{F}^{2} = \\| \\boldsymbol{0} \\|_{F}^{2} = 0$$", "answer": "$$ \\boxed{0} $$", "id": "3415894"}, {"introduction": "Beyond the algebraic structure of the matrix, the choice of lexicographic ordering has profound and direct consequences for computational performance on modern computer architectures. The principle of locality—keeping memory accesses close to each other—is crucial for leveraging CPU caches effectively. This practice delves into this concept by analyzing the memory access strides and cache line reuse for a standard five-point stencil, illustrating why an ordering that aligns with contiguous memory storage is critical for efficiency.", "problem": "Consider a two-dimensional uniform grid for a scalar field $u(i,j)$ with $n_x$ points along the $x$-direction and $n_y$ points along the $y$-direction. The grid is stored in a single contiguous one-dimensional array using $i$-major lexicographic ordering (that is, $i$ varies fastest), so that the linearized memory index is given by\n$$\np(i,j) = i + n_x\\,j \\quad \\text{for} \\quad 0 \\leq i \\leq n_x - 1, \\; 0 \\leq j \\leq n_y - 1.\n$$\nAssume periodic boundary conditions in both directions. Consider the five-point stencil for a standard second-order finite difference approximation to the Laplacian used in the numerical solution of partial differential equations (PDEs), evaluated at an interior point $(i,j)$:\n$$\n\\{(i,j)\\ \\text{(center)},\\ (i+1,j)\\ \\text{(east)},\\ (i-1,j)\\ \\text{(west)},\\ (i,j+1)\\ \\text{(north)},\\ (i,j-1)\\ \\text{(south)}\\}.\n$$\nSuppose the data type is of size $s$ bytes and the central processing unit (CPU) cache line size is $L$ bytes. Define the cache line capacity $c$ (in elements) by $c = L/s$, and assume the following alignment and capacity idealizations:\n- The base address of the array is aligned to a cache line boundary.\n- $n_x$ is a multiple of $c$, so that each row starts at a cache line boundary and no cache line straddles two rows.\n- The cache is fully associative with infinite capacity, and it fetches whole cache lines on demand.\n\nA row-wise sweep (inner loop in $i$, outer loop in $j$) evaluates the stencil across a fixed row $j$ for all $i = 0,1,\\dots,n_x - 1$. For this sweep, answer the following:\n\n(a) Using the linearization map $p(i,j)$, compute the element-wise memory access strides (differences in the flattened index) from the center to each of its four neighbors: east, west, north, and south. That is, compute\n$$\n\\Delta p_{\\mathrm{E}} = p(i+1,j) - p(i,j),\\quad\n\\Delta p_{\\mathrm{W}} = p(i-1,j) - p(i,j),\\quad\n\\Delta p_{\\mathrm{N}} = p(i,j+1) - p(i,j),\\quad\n\\Delta p_{\\mathrm{S}} = p(i,j-1) - p(i,j).\n$$\n\n(b) Over the entire sweep of a fixed row $j$ across all $i$, each stencil evaluation performs $5$ element reads. Under the ideal cache model above, determine the cache line reuse factor $R(c)$, defined as the average number of element reads served per distinct cache line fetched during the sweep. Express $R(c)$ as a closed-form analytic expression in terms of $c$ and $n_x$.\n\nReport your final answer as a single row matrix in the order\n$$\n\\bigl[\\Delta p_{\\mathrm{E}},\\ \\Delta p_{\\mathrm{W}},\\ \\Delta p_{\\mathrm{N}},\\ \\Delta p_{\\mathrm{S}},\\ R(c)\\bigr].\n$$\nNo numerical rounding is required, and you should leave the result as an exact symbolic expression.", "solution": "The solution is derived in two parts, corresponding to the tasks in the problem statement.\n\n**(a) Memory Access Strides**\n\nThe memory access strides are the differences in the linearized index $p$ between a central grid point $(i,j)$ and its neighbors. The linearization map for the $i$-major (row-major) ordering is given as $p(i,j) = i + n_x j$.\n\nThe strides are calculated by finding the linearized indices of the neighbors and subtracting the index of the central point:\n-   **East Stride ($\\Delta p_{\\mathrm{E}}$):** For neighbor $(i+1,j)$, the index is $p(i+1,j) = (i+1) + n_x j$.\n    $$ \\Delta p_{\\mathrm{E}} = p(i+1,j) - p(i,j) = ((i+1) + n_x j) - (i + n_x j) = 1 $$\n-   **West Stride ($\\Delta p_{\\mathrm{W}}$):** For neighbor $(i-1,j)$, the index is $p(i-1,j) = (i-1) + n_x j$.\n    $$ \\Delta p_{\\mathrm{W}} = p(i-1,j) - p(i,j) = ((i-1) + n_x j) - (i + n_x j) = -1 $$\n-   **North Stride ($\\Delta p_{\\mathrm{N}}$):** For neighbor $(i,j+1)$, the index is $p(i,j+1) = i + n_x (j+1)$.\n    $$ \\Delta p_{\\mathrm{N}} = p(i,j+1) - p(i,j) = (i + n_x j + n_x) - (i + n_x j) = n_x $$\n-   **South Stride ($\\Delta p_{\\mathrm{S}}$):** For neighbor $(i,j-1)$, the index is $p(i,j-1) = i + n_x (j-1)$.\n    $$ \\Delta p_{\\mathrm{S}} = p(i,j-1) - p(i,j) = (i + n_x j - n_x) - (i + n_x j) = -n_x $$\n\n**(b) Cache Line Reuse Factor**\n\nThe reuse factor $R(c)$ is the ratio of total element reads to total distinct cache lines fetched during a sweep over a single row.\n\n1.  **Total Element Reads:** The sweep evaluates the five-point stencil for each of the $n_x$ points in a row. Each evaluation performs 5 reads.\n    $$ \\text{Total reads} = 5 \\times n_x $$\n2.  **Total Distinct Cache Lines Fetched:** During the sweep across row $j$, the five-point stencil accesses elements from three full rows: the central row ($j$), the south row ($(j-1)\\pmod{n_y}$), and the north row ($(j+1)\\pmod{n_y}$).\n    -   Each row contains $n_x$ elements.\n    -   The problem states that a cache line holds $c$ elements and that $n_x$ is a multiple of $c$.\n    -   Therefore, each row occupies exactly $\\frac{n_x}{c}$ cache lines.\n    -   Since all elements of three rows are accessed, the total number of distinct cache lines fetched is:\n        $$ \\text{Total lines fetched} = 3 \\times \\frac{n_x}{c} $$\n3.  **Reuse Factor Calculation:**\n    $$ R(c) = \\frac{\\text{Total reads}}{\\text{Total lines fetched}} = \\frac{5 n_x}{3 \\frac{n_x}{c}} = \\frac{5c}{3} $$", "answer": "$$ \\boxed{ \\begin{pmatrix} 1  -1  n_x  -n_x  \\frac{5c}{3} \\end{pmatrix} } $$", "id": "3415881"}, {"introduction": "The impact of lexicographic ordering extends even further, influencing the convergence rate and even the viability of advanced iterative solvers like multigrid methods. A standard point-wise Gauss-Seidel smoother, applied in lexicographic order, can perform very poorly on problems with strong anisotropy, as certain error frequencies are not effectively damped. This advanced problem uses Local Fourier Analysis to diagnose this failure and demonstrates how adapting the smoother to a block-line approach, which still sweeps lexicographically, can restore rapid convergence, highlighting the deep interplay between ordering and algorithm design.", "problem": "Consider the two-dimensional anisotropic diffusion partial differential equation (PDE) with periodic boundary conditions,\n$$\n-\\left( \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}} \\right) = f,\n$$\nposed on a uniform infinite lattice approximation of the unit torus with grid spacing $h0$, where $\\alpha \\gg 1$ represents strong grid-aligned anisotropy in the $x$-direction. Discretize the PDE using the standard five-point second-order accurate finite difference scheme, producing a linear system $A u = f$ with stencil coefficients\n$$\nA_{i,j} = \\frac{2(\\alpha+1)}{h^{2}}, \\quad A_{i\\pm 1,j} = -\\frac{\\alpha}{h^{2}}, \\quad A_{i,j\\pm 1} = -\\frac{1}{h^{2}}.\n$$\nAdopt row-wise lexicographic ordering in the $i$-index (inner loop) within the $j$-index (outer loop), and consider forward Gauss–Seidel relaxation as a smoother in a geometric multigrid setting with standard coarsening by a factor of $2$ in each spatial direction. Perform Local Fourier Analysis (LFA) on the infinite grid, modeling the error as a superposition of Fourier modes\n$$\n\\varphi_{\\boldsymbol{\\theta}}(i,j) = \\exp\\!\\left(i (i \\theta_{x} + j \\theta_{y})\\right), \\quad \\boldsymbol{\\theta} = (\\theta_{x},\\theta_{y}) \\in [-\\pi,\\pi]^{2}.\n$$\nDefine the high-frequency set associated with $2\\times$ coarsening as\n$$\n\\Theta_{\\mathrm{HF}} = \\left\\{ (\\theta_{x},\\theta_{y}) \\in [-\\pi,\\pi]^{2} : \\text{at least one of } |\\theta_{x}| \\ge \\frac{\\pi}{2} \\text{ or } |\\theta_{y}| \\ge \\frac{\\pi}{2} \\right\\}.\n$$\nTasks:\n1. Construct and justify the above PDE as a counterexample where standard pointwise forward Gauss–Seidel under the specified lexicographic ordering is a poor smoother for large $\\alpha$, by deriving its LFA error-propagation symbol and explaining why the smoothing factor over $\\Theta_{\\mathrm{HF}}$ approaches unity as $\\alpha \\to \\infty$.\n2. Propose a lexicographic block-line Gauss–Seidel smoother that exactly inverts the strong couplings along $x$-lines (fixed $j$), ordered forward in the $j$-index, and derive its LFA error-propagation symbol.\n3. Using LFA, compute the smoothing factor of this block-line smoother, namely the supremum of the magnitude of the error-propagation symbol over $\\Theta_{\\mathrm{HF}}$, as a single closed-form analytic expression. Your final answer must be a single exact analytic expression. No rounding is required.", "solution": "This problem is solved by applying Local Fourier Analysis (LFA) to two different Gauss-Seidel smoothers for the given anisotropic diffusion equation.\n\n**1. Analysis of Pointwise Gauss-Seidel**\n\nFor the row-wise lexicographic ordering, the forward Gauss-Seidel update for the error $e$ at point $(i,j)$ is:\n$$ \\frac{2(\\alpha+1)}{h^2} e^{k+1}_{i,j} - \\frac{\\alpha}{h^2} e^{k+1}_{i-1,j} - \\frac{1}{h^2} e^{k+1}_{i,j-1} = \\frac{\\alpha}{h^2} e^{k}_{i+1,j} + \\frac{1}{h^2} e^{k}_{i,j+1} $$\nApplying LFA by substituting the error mode $e(i,j) = \\varphi_{\\boldsymbol{\\theta}}(i,j)$ and seeking the amplification factor $S_{\\text{pt}}(\\boldsymbol{\\theta})$ where $e^{k+1} = S_{\\text{pt}}(\\boldsymbol{\\theta}) e^k$, we get:\n$$ S_{\\text{pt}}(\\boldsymbol{\\theta}) \\left( \\frac{2(\\alpha+1)}{h^2} - \\frac{\\alpha}{h^2} e^{-i\\theta_x} - \\frac{1}{h^2} e^{-i\\theta_y} \\right) = \\frac{\\alpha}{h^2} e^{i\\theta_x} + \\frac{1}{h^2} e^{i\\theta_y} $$\nSolving for the symbol gives:\n$$ S_{\\text{pt}}(\\boldsymbol{\\theta}) = \\frac{\\alpha e^{i\\theta_x} + e^{i\\theta_y}}{2(\\alpha+1) - \\alpha e^{-i\\theta_x} - e^{-i\\theta_y}} $$\nThis smoother is ineffective for large $\\alpha$ because it fails to damp high-frequency modes that are smooth in the direction of strong coupling. Consider the high-frequency mode $\\boldsymbol{\\theta}=(0, \\pi) \\in \\Theta_{\\mathrm{HF}}$. For this mode, the symbol becomes:\n$$ |S_{\\text{pt}}(0, \\pi)| = \\left| \\frac{\\alpha - 1}{2(\\alpha+1) - \\alpha - (-1)} \\right| = \\frac{\\alpha-1}{\\alpha+3} $$\nAs $\\alpha \\to \\infty$, $|S_{\\text{pt}}(0, \\pi)| \\to 1$. Since the smoothing factor $\\mu_{\\text{pt}} = \\sup_{\\boldsymbol{\\theta} \\in \\Theta_{\\mathrm{HF}}} |S_{\\text{pt}}(\\boldsymbol{\\theta})|$ is at least this large, $\\mu_{\\text{pt}} \\to 1$, indicating a failure to smooth.\n\n**2. Analysis of Block-Line Gauss-Seidel**\n\nIn this scheme, all unknowns on a line of constant $j$ are solved for simultaneously. The blocks (lines) are processed lexicographically in $j$. The error update for line $j$ is:\n$$ -\\frac{\\alpha}{h^2}e^{k+1}_{i-1,j} + \\frac{2(\\alpha+1)}{h^2}e^{k+1}_{i,j} - \\frac{\\alpha}{h^2}e^{k+1}_{i+1,j} - \\frac{1}{h^2}e^{k+1}_{i,j-1} = \\frac{1}{h^2}e^{k}_{i,j+1} $$\nApplying LFA yields the symbol $S_{\\text{blk}}(\\boldsymbol{\\theta})$:\n$$ S_{\\text{blk}}(\\boldsymbol{\\theta}) \\left( \\frac{2(\\alpha+1) - 2\\alpha\\cos(\\theta_x)}{h^2} - \\frac{e^{-i\\theta_y}}{h^2} \\right) = \\frac{e^{i\\theta_y}}{h^2} $$\nSolving for the symbol gives:\n$$ S_{\\text{blk}}(\\boldsymbol{\\theta}) = \\frac{e^{i\\theta_y}}{2(\\alpha+1) - 2\\alpha\\cos(\\theta_x) - e^{-i\\theta_y}} = \\frac{e^{i\\theta_y}}{2 + 4\\alpha\\sin^2(\\theta_x/2) - e^{-i\\theta_y}} $$\n\n**3. Smoothing Factor of Block-Line Smoother**\n\nThe smoothing factor is $\\mu_{\\text{blk}} = \\sup_{\\boldsymbol{\\theta} \\in \\Theta_{\\mathrm{HF}}} |S_{\\text{blk}}(\\boldsymbol{\\theta})|$. The squared magnitude of the symbol is:\n$$ |S_{\\text{blk}}(\\boldsymbol{\\theta})|^2 = \\frac{1}{(2 + 4\\alpha\\sin^2(\\frac{\\theta_x}{2}) - \\cos(\\theta_y))^2 + \\sin^2(\\theta_y)} $$\nTo find the supremum of this value, we must find the infimum of the denominator over $\\boldsymbol{\\theta} \\in \\Theta_{\\mathrm{HF}}$.\nThe \"worst-case\" modes for this smoother are those that are smooth in the $x$-direction (where the block solve is strong) and rough in the $y$-direction (where the coupling is explicit). We therefore analyze the behavior near $\\theta_x=0$.\nThe high-frequency set $\\Theta_{\\mathrm{HF}}$ contains modes where either $|\\theta_x| \\ge \\pi/2$ or $|\\theta_y| \\ge \\pi/2$.\n- If $|\\theta_x| \\ge \\pi/2$, then $\\sin^2(\\theta_x/2) \\ge 1/2$. The denominator becomes large, especially for large $\\alpha$, so the amplification is small. The maximum value in this region is found to be $1/(1+2\\alpha)$, which tends to 0 as $\\alpha \\to \\infty$.\n- If $|\\theta_y| \\ge \\pi/2$, we find the supremum by minimizing the denominator. This occurs when $\\theta_x$ is small and $\\cos(\\theta_y)$ is maximized within its allowed range. The worst case is at $\\theta_x=0$ and $|\\theta_y|=\\pi/2$.\nAt $\\boldsymbol{\\theta}=(0, \\pi/2)$:\n$$ |S_{\\text{blk}}(0, \\pi/2)|^2 = \\frac{1}{(2 - \\cos(\\pi/2))^2 + \\sin^2(\\pi/2)} = \\frac{1}{2^2 + 1^2} = \\frac{1}{5} $$\nThus, $|S_{\\text{blk}}(0, \\pi/2)| = 1/\\sqrt{5}$.\nComparing the two cases, for large $\\alpha$, the overall supremum over $\\Theta_{\\mathrm{HF}}$ is dominated by the second case.\n$$ \\mu_{\\text{blk}} = \\max\\left(\\frac{1}{1+2\\alpha}, \\frac{1}{\\sqrt{5}}\\right) = \\frac{1}{\\sqrt{5}} \\quad (\\text{for } \\alpha > (\\sqrt{5}-1)/2) $$\nThis smoothing factor is independent of $\\alpha$ and is small enough for effective multigrid performance.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}}}$$", "id": "3415932"}]}