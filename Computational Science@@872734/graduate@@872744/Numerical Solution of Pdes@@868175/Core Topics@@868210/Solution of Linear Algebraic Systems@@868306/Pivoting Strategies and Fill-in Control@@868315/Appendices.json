{"hands_on_practices": [{"introduction": "Understanding the interplay between a partial differential equation's physical properties and the numerical behavior of its discretized form is a cornerstone of computational science. This exercise demonstrates how a dominant convection term in a PDE can yield a linear system that lacks diagonal dominance, a key property for the stability of Gaussian elimination. By manually executing the initial steps of factorization, you will diagnose the potential for numerical instability and see firsthand how partial pivoting mitigates this risk while introducing \"fill-in,\" the creation of nonzeros that complicates sparse factorizations. [@problem_id:3432280]", "problem": "Consider the steady one-dimensional convection-diffusion partial differential equation on the interval $\\left(0,1\\right)$ with homogeneous Dirichlet boundary conditions,\n$$ -\\kappa \\, u''(x) + b \\, u'(x) = f(x), \\quad u(0)=0,\\; u(1)=0, $$\ndiscretized by second-order central finite differences on a uniform grid with spacing $h=\\frac{1}{5}$. Take the diffusion coefficient $\\kappa=10^{-3}$ and the convection speed $b=1$. Using the standard three-point stencil for $u''(x)$ and $u'(x)$ at the four interior nodes, the resulting linear system has the tridiagonal coefficient matrix $A \\in \\mathbb{R}^{4 \\times 4}$ with constant subdiagonal, diagonal, and superdiagonal entries\n$$ a \\equiv -\\frac{\\kappa}{h^{2}} - \\frac{b}{2h}, \\quad d \\equiv \\frac{2\\kappa}{h^{2}}, \\quad c \\equiv -\\frac{\\kappa}{h^{2}} + \\frac{b}{2h}. $$\nAnswer the following, starting only from the definitions of the finite-difference approximations for $u''(x)$ and $u'(x)$, the definition of weak diagonal dominance, the definition of Gaussian elimination, and the definition of partial pivoting.\n\n1. Derive the explicit numerical values of $a$, $d$, and $c$ and write $A$ explicitly.\n2. Verify that $A$ fails to satisfy weak diagonal dominance in the interior rows.\n3. Perform the first step of Gaussian elimination without pivoting on $A$. Compute the multiplier $m_{21} \\equiv a/d$ and the updated second-row diagonal entry after eliminating the $(2,1)$ entry. Explain why this indicates potential instability when using finite precision arithmetic.\n4. Now perform Gaussian elimination with partial pivoting (Gaussian elimination with partial pivoting selects, at each step $k$, the row $\\ell \\ge k$ with maximal $|a_{\\ell k}|$ and swaps rows $k$ and $\\ell$ before eliminating). Track the row interchanges and the subsequent eliminations through all steps. Define fill-in as any entry that is zero in the initially permuted matrix at a given step and becomes nonzero due to the elimination update at that step. Determine the total number of fill-in entries created over the entire factorization with partial pivoting.\n\nYour final answer must be the total number of fill-in entries created by partial pivoting, expressed as an integer with no units and no additional text. No rounding is required.", "solution": "The analysis of the problem will proceed in four parts as requested, starting from the specified fundamental definitions.\n\nFirst, we derive the expressions for the matrix entries $a$, $d$, and $c$. The provided partial differential equation is\n$$ -\\kappa \\, u''(x) + b \\, u'(x) = f(x). $$\nWe discretize this equation on a uniform grid $x_i = i h$ for $i=0, 1, \\dots, N+1$, where the grid spacing is $h = \\frac{1}{N+1}$. In this problem, $h=\\frac{1}{5}$, so $N+1=5$ and there are $N=4$ interior nodes. Let $u_i \\approx u(x_i)$. The second-order central finite difference approximations for the derivatives at an interior node $x_i$ are:\n$$ u'(x_i) \\approx \\frac{u_{i+1} - u_{i-1}}{2h} $$\n$$ u''(x_i) \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} $$\nSubstituting these approximations into the PDE gives the difference equation for each interior node $i=1, 2, 3, 4$:\n$$ -\\kappa \\left( \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} \\right) + b \\left( \\frac{u_{i+1} - u_{i-1}}{2h} \\right) = f_i $$\nWe rearrange the terms to group coefficients of $u_{i-1}$, $u_i$, and $u_{i+1}$:\n$$ \\left( -\\frac{\\kappa}{h^2} - \\frac{b}{2h} \\right) u_{i-1} + \\left( \\frac{2\\kappa}{h^2} \\right) u_i + \\left( -\\frac{\\kappa}{h^2} + \\frac{b}{2h} \\right) u_{i+1} = f_i $$\nFrom this, we identify the coefficients for the subdiagonal, diagonal, and superdiagonal entries of the matrix $A$:\n$$ a = -\\frac{\\kappa}{h^2} - \\frac{b}{2h} $$\n$$ d = \\frac{2\\kappa}{h^2} $$\n$$ c = -\\frac{\\kappa}{h^2} + \\frac{b}{2h} $$\nWith the given values $\\kappa=10^{-3}$, $b=1$, and $h=\\frac{1}{5}=0.2$, we compute the numerical values:\n$$ h^2 = (0.2)^2 = 0.04 $$\n$$ \\frac{\\kappa}{h^2} = \\frac{10^{-3}}{0.04} = \\frac{0.001}{0.04} = 0.025 $$\n$$ \\frac{b}{2h} = \\frac{1}{2(0.2)} = \\frac{1}{0.4} = 2.5 $$\nTherefore, the matrix entries are:\n$$ a = -0.025 - 2.5 = -2.525 $$\n$$ d = 2 \\times 0.025 = 0.05 $$\n$$ c = -0.025 + 2.5 = 2.475 $$\nThe resulting $4 \\times 4$ tridiagonal matrix $A$ is:\n$$ A = \\begin{pmatrix} d & c & 0 & 0 \\\\ a & d & c & 0 \\\\ 0 & a & d & c \\\\ 0 & 0 & a & d \\end{pmatrix} = \\begin{pmatrix} 0.05 & 2.475 & 0 & 0 \\\\ -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\n\nSecond, we verify that $A$ fails to satisfy weak diagonal dominance. A matrix is weakly diagonally dominant if for every row $i$, the absolute value of the diagonal element is greater than or equal to the sum of the absolute values of the off-diagonal elements in that row, i.e., $|A_{ii}| \\ge \\sum_{j \\neq i} |A_{ij}|$. We check this condition for an interior row, for instance, row $2$:\nThe diagonal element is $A_{22} = d = 0.05$. The off-diagonal elements are $A_{21} = a = -2.525$ and $A_{23} = c = 2.475$.\nThe condition for row $2$ is:\n$$ |A_{22}| \\ge |A_{21}| + |A_{23}| $$\nSubstituting the values:\n$$ |0.05| \\ge |-2.525| + |2.475| $$\n$$ 0.05 \\ge 2.525 + 2.475 $$\n$$ 0.05 \\ge 5.0 $$\nThis inequality is false, so the matrix $A$ is not weakly diagonally dominant. The physical reason for this is that the problem is convection-dominated, as indicated by a large grid Péclet number $P_e = \\frac{bh}{2\\kappa} = \\frac{1 \\cdot 0.2}{2 \\cdot 10^{-3}} = 100 \\gg 1$.\n\nThird, we perform the first step of Gaussian elimination without pivoting. The goal is to eliminate the entry $A_{21}$. The pivot element is $A_{11} = d = 0.05$. The multiplier is defined as $m_{21} = \\frac{A_{21}}{A_{11}}$.\n$$ m_{21} = \\frac{a}{d} = \\frac{-2.525}{0.05} = -50.5 $$\nThe update for the second row is $R_2 \\leftarrow R_2 - m_{21} R_1$. The updated diagonal entry $A'_{22}$ is calculated as:\n$$ A'_{22} = A_{22} - m_{21}A_{12} = d - m_{21}c = 0.05 - (-50.5)(2.475) $$\n$$ A'_{22} = 0.05 + 124.9875 = 125.0375 $$\nThe instability of this procedure in a finite precision environment is indicated by the large magnitude of the multiplier, $|m_{21}| = 50.5 \\gg 1$. This occurs because the pivot element $A_{11}=0.05$ is small relative to the element $A_{21}=-2.525$ that it is used to eliminate. When calculating the updated entry $A'_{22}$, a small number ($d=0.05$) is added to a very large number ($|m_{21} c|=124.9875$). In floating-point arithmetic with limited precision, this can lead to a loss of the information contained in the smaller number (swamping), propagating and amplifying round-off errors throughout the computation, potentially rending the final solution meaningless.\n\nFourth, we perform Gaussian elimination with partial pivoting and count the total number of fill-in entries. A fill-in is an entry that is zero in the permuted matrix at the beginning of a step but becomes nonzero after the elimination update in that step.\n\nStep $k=1$:\nThe initial matrix is $A^{(0)} = A$.\n$$ A^{(0)} = \\begin{pmatrix} 0.05 & 2.475 & 0 & 0 \\\\ -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\nFor pivoting, we examine column $1$. We find the element with the largest absolute value: $\\max(|0.05|, |-2.525|, |0|, |0|) = 2.525$, which is in row $2$. We swap row $1$ and row $2$. The permuted matrix is:\n$$ A'^{(0)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0.05 & 2.475 & 0 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\nWe now perform elimination. Only the entry $A'_{21} = 0.05$ needs to be eliminated. The multiplier is $m_{21} = \\frac{0.05}{-2.525}$. The update is $R_2 \\leftarrow R_2 - m_{21}R_1$. The original row $R_2$ is $(0.05, 2.475, 0, 0)$. The pivot row $R_1$ is $(-2.525, 0.05, 2.475, 0)$.\nThe new $(2,3)$ entry is $A'_{23} - m_{21}A'_{13} = 0 - m_{21}(2.475)$. Since $m_{21} \\neq 0$ and $A'_{13} \\neq 0$, this entry becomes non-zero. The original $(2,3)$ entry in $A'^{(0)}$ was $0$. This constitutes a fill-in.\nThe new $(2,4)$ entry is $A'_{24} - m_{21}A'_{14} = 0 - m_{21}(0) = 0$. No fill-in here.\nThus, there is $1$ fill-in in step $1$ at position $(2,3)$.\n\nStep $k=2$:\nThe matrix after step $1$, $A^{(1)}$, has the structure:\n$$ A^{(1)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & A^{(1)}_{22} & A^{(1)}_{23} & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\nFor pivoting, we examine column $2$ from row $2$ downwards. The pivot candidates are $A^{(1)}_{22} = 2.475 - m_{21}(0.05) \\approx 2.476$ and $A^{(1)}_{32} = -2.525$. Since $|-2.525| > |2.476|$, we swap row $2$ and row $3$. The permuted matrix for this step is:\n$$ A'^{(1)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & A^{(1)}_{22} & A^{(1)}_{23} & 0 \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\nWe eliminate the entry $A'_{32} = A^{(1)}_{22}$. The multiplier is $m_{32} = \\frac{A^{(1)}_{22}}{-2.525}$. The update is $R_3 \\leftarrow R_3 - m_{32}R_2$. The original row $R_3$ in $A'^{(1)}$ is $(0, A^{(1)}_{22}, A^{(1)}_{23}, 0)$. The pivot row $R_2$ is $(0, -2.525, 0.05, 2.475)$.\nThe new $(3,4)$ entry is $A'_{34} - m_{32}A'_{24} = 0 - m_{32}(2.475)$. Since $m_{32} \\neq 0$ and $A'_{24} \\neq 0$, this entry becomes non-zero. The original $(3,4)$ entry in $A'^{(1)}$ was $0$. This constitutes a second fill-in.\nThus, there is $1$ fill-in in step $2$ at position $(3,4)$.\n\nStep $k=3$:\nThe matrix after step 2, $A^{(2)}$, has the structure:\n$$ A^{(2)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & A^{(2)}_{33} & A^{(2)}_{34} \\\\ 0 & 0 & -2.525 & 0.05 \\end{pmatrix} $$\nFor pivoting, we examine column $3$ from row $3$ downwards. The pivot candidates are $A^{(2)}_{33}$ and $A^{(2)}_{43} = -2.525$. The value of $A^{(2)}_{33}$ is a result of the previous update and is small compared to $-2.525$. Specifically, $A^{(2)}_{33} \\approx 0.098$.\nSince $|-2.525| > |A^{(2)}_{33}|$, we swap row $3$ and row $4$. The permuted matrix is:\n$$ A'^{(2)} = \\begin{pmatrix} -2.525 & 0.05 & 2.475 & 0 \\\\ 0 & -2.525 & 0.05 & 2.475 \\\\ 0 & 0 & -2.525 & 0.05 \\\\ 0 & 0 & A^{(2)}_{33} & A^{(2)}_{34} \\end{pmatrix} $$\nWe eliminate the entry $A'_{43} = A^{(2)}_{33}$. The update is $R_4 \\leftarrow R_4 - m_{43}R_3$. The original row $R_4$ in $A'^{(2)}$ is $(0, 0, A^{(2)}_{33}, A^{(2)}_{34})$. The pivot row $R_3$ is $(0, 0, -2.525, 0.05)$.\nThe only entries in row $4$ that can be modified are in column $3$ and $4$. Both $A'_{43}$ and $A'_{44}$ were already non-zero. The elimination process makes $A'_{43}$ zero and updates $A'_{44}$. No entry that was zero becomes non-zero.\nThus, there are $0$ fill-ins in step $3$.\n\nThe total number of fill-in entries created during the entire factorization process is the sum of the fill-ins from each step: $1 + 1 + 0 = 2$.", "answer": "$$ \\boxed{2} $$", "id": "3432280"}, {"introduction": "In the world of sparse matrix factorization, there is a fundamental tension between maintaining numerical stability and preserving sparsity. The Markowitz heuristic provides a powerful greedy algorithm for selecting pivots to minimize fill-in, but this choice may conflict with the need for a numerically significant pivot. This practice problem places you at the center of this trade-off, where you will first identify the ideal pivots from a sparsity perspective and then see how a numerical threshold forces a compromise, quantifying the cost in predicted fill-in. [@problem_id:3432289]", "problem": "Consider the sparse matrix $A \\in \\mathbb{R}^{6 \\times 6}$ arising from a finite-volume discretization of a one-dimensional convection–diffusion partial differential equation (PDE) on a nonuniform mesh with upwind bias. The resulting unsymmetric near-banded matrix is\n$$\nA=\\begin{pmatrix}\n3 & 1.5 & 0 & 0 & 0 & 0 \\\\\n10 & 9 & 0.5 & 0 & 0 & 0 \\\\\n0 & 2 & 8 & 1 & 0 & 0 \\\\\n0 & 0 & 1.2 & 7 & 0.8 & 0 \\\\\n0 & 0 & 0 & 1.1 & 7 & 8 \\\\\n0 & 0 & 0 & 0 & 3 & 2\n\\end{pmatrix}.\n$$\nAt the first elimination step of sparse Gaussian elimination, you will construct the Markowitz set of candidate pivots and predict the fill-in generated by a pivot using the standard Markowitz heuristic. Then, you will impose a numerical pivot threshold to restrict candidates and assess how this alters the predicted fill-in.\n\nTasks:\n- Using the standard Markowitz pivot selection heuristic, construct the Markowitz set for $A$ at the initial elimination step (no prior eliminations). For each nonzero candidate pivot $a_{ij}$, let $r_i$ be the number of structurally nonzero entries in row $i$ of $A$, and let $c_j$ be the number of structurally nonzero entries in column $j$ of $A$. The Markowitz count for $a_{ij}$ is the product of $(r_i-1)$ and $(c_j-1)$. Identify the set of positions in $A$ that minimize this count.\n- Impose a numerical pivot threshold: restrict candidate pivots $a_{ij}$ to those satisfying the column-based condition $|a_{ij}| \\ge \\alpha \\cdot \\max_{p} |a_{pj}|$, with $\\alpha=0.4$ and the maximum taken over all structurally nonzero entries in column $j$. Among the restricted candidates, determine the minimal Markowitz count attainable at the initial elimination step.\n- Let $\\rho$ be the ratio of the minimal restricted Markowitz count to the minimal unrestricted Markowitz count. Compute $\\rho$.\n\nExpress your final answer as the single number $\\rho$. No rounding is required. No units are required.", "solution": "The problem requires an analysis of pivot selection for a sparse matrix $A$ using the Markowitz heuristic, both with and without a numerical stability threshold. The matrix is given as:\n$$\nA=\\begin{pmatrix}\n3 & 1.5 & 0 & 0 & 0 & 0 \\\\\n10 & 9 & 0.5 & 0 & 0 & 0 \\\\\n0 & 2 & 8 & 1 & 0 & 0 \\\\\n0 & 0 & 1.2 & 7 & 0.8 & 0 \\\\\n0 & 0 & 0 & 1.1 & 7 & 8 \\\\\n0 & 0 & 0 & 0 & 3 & 2\n\\end{pmatrix}\n$$\n\nThe Markowitz count for a potential pivot element $a_{ij}$ is defined as $M_{ij} = (r_i - 1)(c_j - 1)$, where $r_i$ is the number of structurally nonzero entries in row $i$ and $c_j$ is the number of structurally nonzero entries in column $j$. This count predicts the number of \"fill-in\" entries that would be created in the Schur complement if $a_{ij}$ is chosen as the pivot.\n\nFirst, we determine the number of nonzero entries for each row ($r_i$) and each column ($c_j$) of matrix $A$ at the initial step.\nThe counts for the rows are:\n$r_1 = 2$\n$r_2 = 3$\n$r_3 = 3$\n$r_4 = 3$\n$r_5 = 3$\n$r_6 = 2$\n\nThe counts for the columns are:\n$c_1 = 2$\n$c_2 = 3$\n$c_3 = 3$\n$c_4 = 3$\n$c_5 = 3$\n$c_6 = 2$\n\nPart 1: Unrestricted Markowitz Pivot Selection\nWe calculate the Markowitz count $M_{ij}$ for every nonzero entry $a_{ij}$ in the matrix $A$.\nFor $a_{11}$: $M_{11} = (r_1-1)(c_1-1) = (2-1)(2-1) = 1$.\nFor $a_{12}$: $M_{12} = (r_1-1)(c_2-1) = (2-1)(3-1) = 2$.\nFor $a_{21}$: $M_{21} = (r_2-1)(c_1-1) = (3-1)(2-1) = 2$.\nFor $a_{22}$: $M_{22} = (r_2-1)(c_2-1) = (3-1)(3-1) = 4$.\nFor $a_{23}$: $M_{23} = (r_2-1)(c_3-1) = (3-1)(3-1) = 4$.\nFor $a_{32}$: $M_{32} = (r_3-1)(c_2-1) = (3-1)(3-1) = 4$.\nFor $a_{33}$: $M_{33} = (r_3-1)(c_3-1) = (3-1)(3-1) = 4$.\nFor $a_{34}$: $M_{34} = (r_3-1)(c_4-1) = (3-1)(3-1) = 4$.\nFor $a_{43}$: $M_{43} = (r_4-1)(c_3-1) = (3-1)(3-1) = 4$.\nFor $a_{44}$: $M_{44} = (r_4-1)(c_4-1) = (3-1)(3-1) = 4$.\nFor $a_{45}$: $M_{45} = (r_4-1)(c_5-1) = (3-1)(3-1) = 4$.\nFor $a_{54}$: $M_{54} = (r_5-1)(c_4-1) = (3-1)(3-1) = 4$.\nFor $a_{55}$: $M_{55} = (r_5-1)(c_5-1) = (3-1)(3-1) = 4$.\nFor $a_{56}$: $M_{56} = (r_5-1)(c_6-1) = (3-1)(2-1) = 2$.\nFor $a_{65}$: $M_{65} = (r_6-1)(c_5-1) = (2-1)(3-1) = 2$.\nFor $a_{66}$: $M_{66} = (r_6-1)(c_6-1) = (2-1)(2-1) = 1$.\n\nThe set of candidate positions that minimize the Markowitz count are $(1,1)$ and $(6,6)$. The minimal unrestricted Markowitz count is $1$.\n\nPart 2: Restricted Markowitz Pivot Selection\nWe impose a numerical pivot threshold using the column-based condition $|a_{ij}| \\ge \\alpha \\cdot \\max_{p} |a_{pj}|$, with $\\alpha=0.4$. We test each nonzero entry to determine if it is a valid candidate.\n\nFor column $j=1$: Nonzero entries are $a_{11}=3$ and $a_{21}=10$. $\\max_p|a_{p1}| = |10| = 10$. The threshold is $0.4 \\times 10 = 4$.\n$|a_{11}| = 3 < 4$, so $a_{11}$ is not a candidate.\n$|a_{21}| = 10 \\ge 4$, so $a_{21}$ is a candidate.\n\nFor column $j=2$: Nonzero entries are $a_{12}=1.5$, $a_{22}=9$, $a_{32}=2$. $\\max_p|a_{p2}| = |9| = 9$. The threshold is $0.4 \\times 9 = 3.6$.\n$|a_{12}|=1.5<3.6, |a_{32}|=2<3.6$. Neither are candidates.\n$|a_{22}|=9 \\ge 3.6$, so $a_{22}$ is a candidate.\n\nFor column $j=3$: Nonzero entries are $a_{23}=0.5$, $a_{33}=8$, $a_{43}=1.2$. $\\max_p|a_{p3}| = |8| = 8$. The threshold is $0.4 \\times 8 = 3.2$.\n$|a_{23}|=0.5<3.2, |a_{43}|=1.2<3.2$. Neither are candidates.\n$|a_{33}|=8 \\ge 3.2$, so $a_{33}$ is a candidate.\n\nFor column $j=4$: Nonzero entries are $a_{34}=1$, $a_{44}=7$, $a_{54}=1.1$. $\\max_p|a_{p4}| = |7| = 7$. The threshold is $0.4 \\times 7 = 2.8$.\n$|a_{34}|=1<2.8, |a_{54}|=1.1<2.8$. Neither are candidates.\n$|a_{44}|=7 \\ge 2.8$, so $a_{44}$ is a candidate.\n\nFor column $j=5$: Nonzero entries are $a_{45}=0.8$, $a_{55}=7$, $a_{65}=3$. $\\max_p|a_{p5}| = |7| = 7$. The threshold is $0.4 \\times 7 = 2.8$.\n$|a_{45}|=0.8<2.8$, not a candidate.\n$|a_{55}|=7 \\ge 2.8$, so $a_{55}$ is a candidate.\n$|a_{65}|=3 \\ge 2.8$, so $a_{65}$ is a candidate.\n\nFor column $j=6$: Nonzero entries are $a_{56}=8$, $a_{66}=2$. $\\max_p|a_{p6}| = |8| = 8$. The threshold is $0.4 \\times 8 = 3.2$.\n$|a_{66}|=2<3.2$, not a candidate.\n$|a_{56}|=8 \\ge 3.2$, so $a_{56}$ is a candidate.\n\nThe set of restricted candidate pivots is $\\{ a_{21}, a_{22}, a_{33}, a_{44}, a_{55}, a_{65}, a_{56} \\}$. We now find the Markowitz count for each of these candidates:\n$M_{21} = (r_2-1)(c_1-1) = (3-1)(2-1) = 2$.\n$M_{22} = (r_2-1)(c_2-1) = (3-1)(3-1) = 4$.\n$M_{33} = (r_3-1)(c_3-1) = (3-1)(3-1) = 4$.\n$M_{44} = (r_4-1)(c_4-1) = (3-1)(3-1) = 4$.\n$M_{55} = (r_5-1)(c_5-1) = (3-1)(3-1) = 4$.\n$M_{65} = (r_6-1)(c_5-1) = (2-1)(3-1) = 2$.\n$M_{56} = (r_5-1)(c_6-1) = (3-1)(2-1) = 2$.\n\nThe minimum Markowitz count among the restricted candidates is $2$.\n\nPart 3: Compute the Ratio $\\rho$\nThe ratio $\\rho$ is the minimal restricted Markowitz count divided by the minimal unrestricted Markowitz count.\nMinimal unrestricted count = $1$.\nMinimal restricted count = $2$.\nTherefore, the ratio is:\n$$\n\\rho = \\frac{2}{1} = 2\n$$\nThe numerical threshold, designed to ensure stability, eliminates the pivots that would have produced the least fill-in, forcing the selection of pivots with a higher Markowitz count. This illustrates the trade-off between maintaining sparsity (low fill-in) and ensuring numerical stability.", "answer": "$$\\boxed{2}$$", "id": "3432289"}, {"introduction": "Theoretical understanding of the stability-sparsity trade-off must ultimately translate into practical algorithms. This exercise simulates the decision-making process inside a modern sparse direct solver by having you apply a combined pivoting strategy. You will use a numerical threshold to establish a set of stable pivot candidates and then employ the Markowitz heuristic to select the best one for minimizing fill-in, carrying the factorization forward and observing the cumulative effect of these balanced choices. [@problem_id:3432313]", "problem": "Consider the sparse linear system arising from a finite-difference discretization of a convection–diffusion partial differential equation (PDE) on a small $2\\times 2$ interior grid after applying Dirichlet boundary conditions and a stabilization that induces mild nonsymmetry. The resulting coefficient matrix is\n$$\nA \\;=\\;\n\\begin{pmatrix}\n10 & 2 & 0 & 0 & 3 \\\\\n9 & \\tfrac{1}{2} & 0 & 0 & 0 \\\\\n0 & 1 & 8 & -2 & 0 \\\\\n0 & 0 & -3 & 7 & 1 \\\\\n2 & 0 & 0 & 5 & 6\n\\end{pmatrix}.\n$$\nPerform Gaussian elimination to compute a Lower–Upper (LU) factorization using the following combined pivoting strategy at each step $k$:\n\n1. Use threshold partial pivoting in column $k$ with threshold $\\tau = \\tfrac{4}{5}$. That is, among rows $i \\ge k$, restrict to candidates satisfying $|a_{ik}| \\ge \\tau \\max_{j \\ge k} |a_{jk}|$ in column $k$.\n2. Among those candidates, apply the Markowitz heuristic: choose the pivot row that minimizes the predicted fill-in count measured by the Markowitz product $(r_i - 1)(c_k - 1)$, where $r_i$ is the number of structurally nonzero entries in row $i$ of the current active submatrix and $c_k$ is the number of structurally nonzero entries in column $k$ of the current active submatrix. In this column-wise setting, $c_k$ is fixed, so this reduces to choosing the candidate with minimal $r_i$. If there is a tie, prefer the candidate with the larger $|a_{ik}|$ for numerical stability.\n\nAssume only row permutations (no column permutations). Define a fill-in to be any matrix entry that is zero in the original $A$ but becomes structurally nonzero at any point in the LU factorization, whether in the strictly lower-triangular factor $L$ (through created subdiagonal entries that become multipliers) or in the upper-triangular factor $U$ (through Schur complement updates).\n\nCompute the total number of fill-in nonzeros introduced over the entire factorization when applying the above strategy to $A$. Express your answer as an integer with no units.", "solution": "The solution involves performing Gaussian elimination step-by-step, applying the specified pivoting strategy at each step, and tracking the creation of nonzero elements in positions that were originally zero in matrix $A$. Let $A^{(k)}$ be the matrix at the beginning of step $k$, with $A^{(1)} = A$. A fill-in occurs at an original matrix position $(i, j)$ if $A_{ij}=0$ but the corresponding entry becomes nonzero during the factorization. The initial sparsity pattern of $A$ shows zeros at positions like $(1,3), (1,4), (2,3), (2,4), (2,5), (3,1), (3,5), (4,1), (4,2), (5,2), (5,3)$.\n\n**Step $k=1$:**\nThe matrix is $A^{(1)} = A$. We consider column $1$.\n1.  **Threshold Pivoting**:\n    -   The elements in column $1$ are $a_{11}=10$, $a_{21}=9$, $a_{31}=0$, $a_{41}=0$, $a_{51}=2$.\n    -   The maximum magnitude is $\\max_{j \\ge 1} |a_{j1}| = |10| = 10$.\n    -   The threshold value is $\\tau \\times 10 = \\frac{4}{5} \\times 10 = 8$.\n    -   We seek rows $i \\ge 1$ where $|a_{i1}| \\ge 8$. Candidates are row $1$ ($|10| \\ge 8$) and row $2$ ($|9| \\ge 8$).\n2.  **Markowitz Heuristic**:\n    -   For candidate row $1$, the number of nonzeros is $r_1=3$ (entries $10, 2, 3$).\n    -   For candidate row $2$, the number of nonzeros is $r_2=2$ (entries $9, \\frac{1}{2}$).\n    -   We choose the row with the minimum $r_i$, which is row $2$ ($r_2=2 < r_1=3$).\n3.  **Action**:\n    -   The pivot is $a_{21}=9$. We swap row $1$ and row $2$.\n    -   The matrix after permutation is:\n        $$\n        A^{(1.5)} = \\begin{pmatrix}\n        9 & \\tfrac{1}{2} & 0 & 0 & 0 \\\\\n        10 & 2 & 0 & 0 & 3 \\\\\n        0 & 1 & 8 & -2 & 0 \\\\\n        0 & 0 & -3 & 7 & 1 \\\\\n        2 & 0 & 0 & 5 & 6\n        \\end{pmatrix}\n        $$\n4.  **Elimination**:\n    -   Multipliers for column $1$: $l_{21} = \\frac{10}{9}$, $l_{31}=0$, $l_{41}=0$, $l_{51} = \\frac{2}{9}$.\n    -   Update row $2$: $R_2 \\leftarrow R_2 - \\frac{10}{9}R_1 = (10, 2, 0, 0, 3) - \\frac{10}{9}(9, \\frac{1}{2}, 0, 0, 0) = (0, \\frac{13}{9}, 0, 0, 3)$. No fill-in created in this row.\n    -   Update row $5$: $R_5 \\leftarrow R_5 - \\frac{2}{9}R_1 = (2, 0, 0, 5, 6) - \\frac{2}{9}(9, \\frac{1}{2}, 0, 0, 0) = (0, -\\frac{1}{9}, 0, 5, 6)$.\n    -   The update creates a nonzero entry at position $(5,2)$. The original matrix entry was $A_{52}=0$. This is a **fill-in**.\n    -   **Fill-in count = 1**. The filled position is $(5,2)$.\nThe matrix state for the next step, $A^{(2)}$, combines the upper triangular part and the updated rows:\n$$\nA^{(2)} \\text{ (structure)} \\rightarrow \\begin{pmatrix}\n9 & \\tfrac{1}{2} & 0 & 0 & 0 \\\\\n\\cdot & \\tfrac{13}{9} & 0 & 0 & 3 \\\\\n\\cdot & 1 & 8 & -2 & 0 \\\\\n\\cdot & 0 & -3 & 7 & 1 \\\\\n\\cdot & -\\tfrac{1}{9} & 0 & 5 & 6\n\\end{pmatrix}\n$$\n\n**Step $k=2$:**\nWe consider the active submatrix $A^{(2)}(2:5, 2:5)$ and its column $1$ (which is column $2$ of $A^{(2)}$).\n1.  **Threshold Pivoting**:\n    -   The elements are $a_{22}=\\frac{13}{9}$, $a_{32}=1$, $a_{42}=0$, $a_{52}=-\\frac{1}{9}$.\n    -   The maximum magnitude is $\\max_{j \\ge 2} |a_{j2}| = |\\frac{13}{9}| \\approx 1.44$.\n    -   The threshold value is $\\tau \\times \\frac{13}{9} = \\frac{4}{5} \\times \\frac{13}{9} = \\frac{52}{45} \\approx 1.15$.\n    -   We seek rows $i \\ge 2$ where $|a_{i2}| \\ge \\frac{52}{45}$. The only candidate is row $2$ ($|\\frac{13}{9}| = \\frac{65}{45} \\ge \\frac{52}{45}$).\n2.  **Action**:\n    -   The pivot is $a_{22}=\\frac{13}{9}$. No row swap is needed.\n3.  **Elimination**:\n    -   Multipliers for column $2$: $l_{32} = \\frac{1}{13/9} = \\frac{9}{13}$, $l_{42}=0$, $l_{52} = \\frac{-1/9}{13/9} = -\\frac{1}{13}$.\n    -   Update row $3$: $R_3 \\leftarrow R_3 - \\frac{9}{13}R_2 = (0, 1, 8, -2, 0) - \\frac{9}{13}(0, \\frac{13}{9}, 0, 0, 3) = (0, 0, 8, -2, -\\frac{27}{13})$.\n    -   The update creates a nonzero entry at position $(3,5)$. The original matrix entry was $A_{35}=0$. This is a **fill-in**.\n    -   Update row $5$: $R_5 \\leftarrow R_5 - (-\\frac{1}{13})R_2 = (0, -\\frac{1}{9}, 0, 5, 6) + \\frac{1}{13}(0, \\frac{13}{9}, 0, 0, 3) = (0, 0, 0, 5, 6+\\frac{3}{13}) = (0, 0, 0, 5, \\frac{81}{13})$. No new fill-in created in this row.\n    -   **Fill-in count = 2**. The filled positions are $(5,2)$ and $(3,5)$.\nThe matrix state for the next step, $A^{(3)}$:\n$$\nA^{(3)} \\text{ (structure)} \\rightarrow \\begin{pmatrix}\n9 & \\tfrac{1}{2} & 0 & 0 & 0 \\\\\n\\cdot & \\tfrac{13}{9} & 0 & 0 & 3 \\\\\n\\cdot & \\cdot & 8 & -2 & -\\tfrac{27}{13} \\\\\n\\cdot & \\cdot & -3 & 7 & 1 \\\\\n\\cdot & \\cdot & 0 & 5 & \\tfrac{81}{13}\n\\end{pmatrix}\n$$\n\n**Step $k=3$:**\nWe consider the active submatrix $A^{(3)}(3:5, 3:5)$.\n1.  **Threshold Pivoting**:\n    -   The elements in column $3$ are $a_{33}=8$, $a_{43}=-3$, $a_{53}=0$.\n    -   The maximum magnitude is $|8|=8$.\n    -   The threshold value is $\\tau \\times 8 = \\frac{4}{5} \\times 8 = 6.4$.\n    -   The only candidate is row $3$ ($|8| \\ge 6.4$).\n2.  **Action**:\n    -   The pivot is $a_{33}=8$. No row swap is needed.\n3.  **Elimination**:\n    -   Multiplier for column $3$: $l_{43} = \\frac{-3}{8}$, $l_{53}=0$.\n    -   Update row $4$: $R_4 \\leftarrow R_4 - (-\\frac{3}{8})R_3 = (0,0,-3,7,1) + \\frac{3}{8}(0,0,8,-2,-\\frac{27}{13}) = (0,0,0, 7-\\frac{6}{8}, 1-\\frac{81}{104}) = (0,0,0, \\frac{25}{4}, \\frac{23}{104})$. No new fill-in.\n    -   **Fill-in count = 2**.\n\n**Step $k=4$:**\nWe consider the active submatrix $A^{(4)}(4:5, 4:5)$.\n$$\nA^{(4)}(4:5, 4:5) = \\begin{pmatrix}\n\\tfrac{25}{4} & \\tfrac{23}{104} \\\\\n5 & \\tfrac{81}{13}\n\\end{pmatrix}\n$$\n1.  **Threshold Pivoting**:\n    -   The elements in column $4$ are $a_{44}=\\frac{25}{4}=6.25$, $a_{54}=5$.\n    -   The maximum magnitude is $|\\frac{25}{4}| = 6.25$.\n    -   The threshold value is $\\tau \\times 6.25 = \\frac{4}{5} \\times \\frac{25}{4} = 5$.\n    -   Both rows are candidates: row $4$ ($|\\frac{25}{4}| \\ge 5$) and row $5$ ($|5| \\ge 5$).\n2.  **Markowitz Heuristic**:\n    -   The active submatrix is $2 \\times 2$.\n    -   For candidate row $4$, the number of nonzeros is $r_4=2$.\n    -   For candidate row $5$, the number of nonzeros is $r_5=2$.\n    -   There is a tie ($r_4=r_5=2$).\n3.  **Tie-Breaking**:\n    -   We compare the magnitudes of the pivot candidates: $|a_{44}| = 6.25$ and $|a_{54}| = 5$.\n    -   Since $6.25 > 5$, we choose row $4$.\n4.  **Action**:\n    -   The pivot is $a_{44}=\\frac{25}{4}$. No row swap is needed.\n5.  **Elimination**:\n    -   Multiplier for column $4$: $l_{54} = \\frac{5}{25/4} = \\frac{4}{5}$.\n    -   Update row $5$: $R_5 \\leftarrow R_5 - \\frac{4}{5}R_4$. This step updates the entry $a_{55}$ but does not create any new nonzeros, as the sparsity patterns of the rows involved do not lead to fill-in.\n    -   **Fill-in count = 2**.\n\nThe factorization is complete. Over the entire process, fill-ins were created at two positions: $(5,2)$ and $(3,5)$. The total number of fill-ins is $2$.", "answer": "$$\\boxed{2}$$", "id": "3432313"}]}