{"hands_on_practices": [{"introduction": "We begin by mastering the fundamental craft of constructing our own numerical tools. While standard finite difference formulas are widely documented, the ability to derive them from first principles is essential for tackling non-standard problems, such as those at domain boundaries. This practice will guide you through the method of undetermined coefficients to build a second-order accurate, one-sided formula, a crucial component for maintaining high accuracy across the entire computational domain [@problem_id:3395616].", "problem": "In the finite difference discretization of a scalar Partial Differential Equation (PDE) on a uniform grid with spacing $h>0$, boundary closures often require one-sided approximations to spatial derivatives. Let $u:\\mathbb{R}\\to\\mathbb{R}$ be sufficiently smooth, with nodes $x_i$, $x_{i+1}=x_i+h$, and $x_{i+2}=x_i+2h$. Construct a one-sided forward finite difference formula that approximates the first derivative $u'(x_i)$ using only the function values $u(x_i)$, $u(x_{i+1})$, and $u(x_{i+2})$, such that the approximation is second-order accurate in $h$.\n\nProceed as follows, starting from Taylor’s theorem about expansion of smooth functions about a point: assume the approximation has the form\n$$\nu'(x_i)\\approx \\frac{a_0\\,u(x_i)+a_1\\,u(x_{i+1})+a_2\\,u(x_{i+2})}{h},\n$$\nfor some coefficients $a_0,a_1,a_2\\in\\mathbb{R}$ to be determined. Determine $a_0$, $a_1$, and $a_2$ by enforcing exactness of this formula on polynomials up to degree $2$. Then verify the resulting order of accuracy by an explicit Taylor expansion about $x_i$, and identify the leading nonzero term in the truncation error, including its sign and dependence on $u^{(3)}(x_i)$.\n\nFinally, report the resulting forward-difference approximation as a single closed-form expression in terms of $u(x_i)$, $u(x_{i+1})$, $u(x_{i+2})$, and $h$. Do not include the truncation error or any big-$\\mathcal{O}$ notation in your final reported expression. No rounding is required.", "solution": "The problem statement will first be validated for correctness, completeness, and scientific grounding.\n\n### Step 1: Extract Givens\n- **Task**: Construct a one-sided forward finite difference formula for the first derivative $u'(x_i)$.\n- **Function**: $u:\\mathbb{R}\\to\\mathbb{R}$ is sufficiently smooth.\n- **Grid**: Uniform grid with spacing $h > 0$.\n- **Nodes**: $x_i$, $x_{i+1} = x_i + h$, $x_{i+2} = x_i + 2h$.\n- **Stencil**: The formula must use only the function values $u(x_i)$, $u(x_{i+1})$, and $u(x_{i+2})$.\n- **Assumed Form**: The approximation is of the form $u'(x_i) \\approx \\frac{a_0 u(x_i) + a_1 u(x_{i+1}) + a_2 u(x_{i+2})}{h}$.\n- **Constraint**: The coefficients $a_0, a_1, a_2$ are to be determined by enforcing exactness for polynomials up to degree $2$.\n- **Verification**: The resulting formula's order of accuracy must be verified using Taylor expansion, and the leading truncation error term must be identified.\n- **Required Output**: A single closed-form expression for the approximation in terms of $u(x_i)$, $u(x_{i+1})$, $u(x_{i+2})$, and $h$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a standard exercise in numerical analysis, specifically in the derivation of finite difference schemes. It relies on Taylor's theorem and the method of undetermined coefficients, which are fundamental mathematical principles. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-posed. It provides a clear objective and a complete set of constraints (the stencil, the form of the approximation, and the method for finding coefficients) that lead to a unique solution for the coefficients $a_0, a_1, a_2$.\n- **Objective**: The problem is stated in precise, objective mathematical language, free of ambiguity or subjective claims.\n- **Completeness and Consistency**: The problem is self-contained and consistent. All necessary information to derive the formula is provided.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process may proceed.\n\nThe task is to find a set of coefficients $a_0, a_1, a_2$ such that the formula\n$$\nD_h[u](x_i) = \\frac{a_0 u(x_i) + a_1 u(x_{i+1}) + a_2 u(x_{i+2})}{h}\n$$\napproximates $u'(x_i)$ and is exact for polynomials of degree $0$, $1$, and $2$. This means that for any polynomial $p(x)$ with $\\deg(p) \\le 2$, we must have $D_h[p](x_i) = p'(x_i)$. It is sufficient to enforce this for a basis of the space of polynomials of degree up to $2$, such as $\\{1, x-x_i, (x-x_i)^2\\}$.\n\nLet's test the formula for each basis polynomial:\n\n1.  For $u(x) = 1$ (degree $0$):\n    $u'(x_i) = 0$. The function values are $u(x_i)=1$, $u(x_{i+1})=1$, and $u(x_{i+2})=1$.\n    For the formula to be exact, we must have:\n    $$\n    \\frac{a_0(1) + a_1(1) + a_2(1)}{h} = 0\n    $$\n    Since $h \\neq 0$, this implies our first condition:\n    $$\n    a_0 + a_1 + a_2 = 0\n    $$\n\n2.  For $u(x) = x - x_i$ (degree $1$):\n    $u'(x) = 1$, so $u'(x_i) = 1$. The function values are $u(x_i)=0$, $u(x_{i+1})=x_{i+1}-x_i=h$, and $u(x_{i+2})=x_{i+2}-x_i=2h$.\n    For the formula to be exact, we must have:\n    $$\n    \\frac{a_0(0) + a_1(h) + a_2(2h)}{h} = 1\n    $$\n    This simplifies to our second condition:\n    $$\n    a_1 + 2a_2 = 1\n    $$\n\n3.  For $u(x) = (x - x_i)^2$ (degree $2$):\n    $u'(x) = 2(x - x_i)$, so $u'(x_i) = 0$. The function values are $u(x_i)=0$, $u(x_{i+1})=(x_{i+1}-x_i)^2=h^2$, and $u(x_{i+2})=(x_{i+2}-x_i)^2=(2h)^2=4h^2$.\n    For the formula to be exact, we must have:\n    $$\n    \\frac{a_0(0) + a_1(h^2) + a_2(4h^2)}{h} = 0\n    $$\n    This simplifies to $a_1 h + 4a_2 h = 0$. Since $h \\neq 0$, we have our third condition:\n    $$\n    a_1 + 4a_2 = 0\n    $$\n\nWe now have a system of three linear equations for $a_0, a_1, a_2$:\n\\begin{align*}\n    a_0 + a_1 + a_2 &= 0 \\quad &(1) \\\\\n    a_1 + 2a_2 &= 1 \\quad &(2) \\\\\n    a_1 + 4a_2 &= 0 \\quad &(3)\n\\end{align*}\nFrom equation (3), we find $a_1 = -4a_2$. Substituting this into equation (2):\n$$\n(-4a_2) + 2a_2 = 1 \\implies -2a_2 = 1 \\implies a_2 = -\\frac{1}{2}\n$$\nNow, we find $a_1$:\n$$\na_1 = -4a_2 = -4\\left(-\\frac{1}{2}\\right) = 2\n$$\nFinally, using equation (1) to find $a_0$:\n$$\na_0 + (2) + \\left(-\\frac{1}{2}\\right) = 0 \\implies a_0 + \\frac{3}{2} = 0 \\implies a_0 = -\\frac{3}{2}\n$$\nThe coefficients are $a_0 = -3/2$, $a_1 = 2$, and $a_2 = -1/2$.\n\nThe resulting finite difference formula is:\n$$\nD_h[u](x_i) = \\frac{-\\frac{3}{2} u(x_i) + 2 u(x_{i+1}) - \\frac{1}{2} u(x_{i+2})}{h} = \\frac{-3 u(x_i) + 4 u(x_{i+1}) - u(x_{i+2})}{2h}\n$$\n\nNext, we verify the order of accuracy using Taylor series expansions for $u(x_{i+1})$ and $u(x_{i+2})$ around the point $x_i$:\n$$\nu(x_{i+1}) = u(x_i+h) = u(x_i) + h u'(x_i) + \\frac{h^2}{2!} u''(x_i) + \\frac{h^3}{3!} u^{(3)}(x_i) + \\mathcal{O}(h^4)\n$$\n$$\nu(x_{i+2}) = u(x_i+2h) = u(x_i) + (2h) u'(x_i) + \\frac{(2h)^2}{2!} u''(x_i) + \\frac{(2h)^3}{3!} u^{(3)}(x_i) + \\mathcal{O}(h^4)\n$$\nSubstituting these expansions into the numerator of the formula, $-3 u(x_i) + 4 u(x_{i+1}) - u(x_{i+2})$:\n$$\n-3 u(x_i) + 4\\left(u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u^{(3)}(x_i) + \\dots\\right) - \\left(u(x_i) + 2h u'(x_i) + \\frac{4h^2}{2} u''(x_i) + \\frac{8h^3}{6} u^{(3)}(x_i) + \\dots\\right)\n$$\nGroup terms by the derivatives of $u$ at $x_i$:\n- Coeff. of $u(x_i)$: $-3 + 4 - 1 = 0$\n- Coeff. of $u'(x_i)$: $4h - 2h = 2h$\n- Coeff. of $u''(x_i)$: $4\\frac{h^2}{2} - \\frac{4h^2}{2} = 2h^2 - 2h^2 = 0$\n- Coeff. of $u^{(3)}(x_i)$: $4\\frac{h^3}{6} - \\frac{8h^3}{6} = \\frac{4h^3 - 8h^3}{6} = -\\frac{4h^3}{6} = -\\frac{2h^3}{3}$\nSo, the numerator expands to:\n$$\n2h u'(x_i) - \\frac{2h^3}{3} u^{(3)}(x_i) + \\mathcal{O}(h^4)\n$$\nNow, we divide by $2h$ to get the full expression for the approximation:\n$$\n\\frac{-3 u(x_i) + 4 u(x_{i+1}) - u(x_{i+2})}{2h} = \\frac{2h u'(x_i) - \\frac{2h^3}{3} u^{(3)}(x_i) + \\mathcal{O}(h^4)}{2h} = u'(x_i) - \\frac{h^2}{3} u^{(3)}(x_i) + \\mathcal{O}(h^3)\n$$\nThe truncation error, defined as $T.E. = (\\text{approximation}) - (\\text{true value})$, is:\n$$\nT.E. = \\left(u'(x_i) - \\frac{h^2}{3} u^{(3)}(x_i) + \\mathcal{O}(h^3)\\right) - u'(x_i) = -\\frac{h^2}{3} u^{(3)}(x_i) + \\mathcal{O}(h^3)\n$$\nThe leading nonzero term in the truncation error is $-\\frac{1}{3}h^2u^{(3)}(x_i)$. The order of the error is $\\mathcal{O}(h^2)$, which means the finite difference approximation is second-order accurate, as required.\n\nThe final forward-difference approximation formula is:\n$$\nu'(x_i) \\approx \\frac{-3u(x_i) + 4u(x_{i+1}) - u(x_{i+2})}{2h}\n$$", "answer": "$$\n\\boxed{\\frac{-3u(x_i) + 4u(x_{i+1}) - u(x_{i+2})}{2h}}\n$$", "id": "3395616"}, {"introduction": "Formal accuracy is not the only measure of a good numerical scheme; it must also faithfully represent the underlying physics. This exercise serves as a critical cautionary tale, demonstrating what happens when a second-order central difference scheme is applied to a convection-dominated flow problem. By analyzing the results, you will observe the emergence of unphysical oscillations and understand the pivotal role of the mesh Péclet number in ensuring a stable, monotonic solution [@problem_id:3395550].", "problem": "Consider the steady one-dimensional linear convection-diffusion boundary value problem\n$$\n- \\varepsilon\\, u_{xx} + \\beta\\, u_{x} = 0 \\quad \\text{on } (0,1),\n$$\nwith Dirichlet boundary conditions $u(0)=0$ and $u(1)=1$, where $\\varepsilon&gt;0$ is the diffusion coefficient and $\\beta&gt;0$ is the constant convection speed. Let the interval $[0,1]$ be partitioned uniformly with mesh size $h=\\frac{1}{3}$ and nodes $x_i = i h$ for $i=0,1,2,3$. At the interior nodes $i=1,2$, approximate $u_{xx}$ by the standard second-order central difference and approximate $u_x$ by the standard second-order central difference. This yields a linear system for the interior values $u_1 \\approx u(x_1)$ and $u_2 \\approx u(x_2)$.\n\nWith the specific parameters $\\varepsilon=1$ and $\\beta=12$, construct and solve the resulting two-by-two linear system to obtain the central-difference approximation at the second interior node $u_2$. Your construction should make clear why this choice corresponds to a large mesh Péclet number regime and thereby serves as a counterexample to monotonicity when replacing a backward (upwind) difference for $u_x$ by a central difference. Provide the numerical value of $u_2$ as your final answer. No rounding is required.", "solution": "The problem is to solve a one-dimensional steady linear convection-diffusion equation using a finite difference method and specific parameter values.\n\n**Step 1: Problem Formulation and Discretization**\n\nThe governing partial differential equation is given by:\n$$\n- \\varepsilon\\, u_{xx} + \\beta\\, u_{x} = 0 \\quad \\text{for } x \\in (0,1)\n$$\nwith Dirichlet boundary conditions:\n$$\nu(0) = 0 \\quad \\text{and} \\quad u(1) = 1\n$$\nThe domain $[0,1]$ is discretized with a uniform mesh of size $h=\\frac{1}{3}$. This creates the nodes $x_0=0$, $x_1=\\frac{1}{3}$, $x_2=\\frac{2}{3}$, and $x_3=1$. Let $u_i$ be the numerical approximation of the solution $u(x_i)$ at these nodes. The boundary conditions give us known values at the endpoints:\n$$\nu_0 = u(x_0) = u(0) = 0\n$$\n$$\nu_3 = u(x_3) = u(1) = 1\n$$\nThe unknown values are at the interior nodes, $u_1$ and $u_2$.\n\n**Step 2: Finite Difference Approximation**\n\nWe are instructed to use standard second-order central difference approximations for both the first and second derivatives at the interior nodes $x_i$ for $i=1,2$.\nThe second derivative $u_{xx}$ is approximated as:\n$$\nu_{xx}(x_i) \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2}\n$$\nThe first derivative $u_x$ is approximated as:\n$$\nu_x(x_i) \\approx \\frac{u_{i+1} - u_{i-1}}{2h}\n$$\nSubstituting these approximations into the governing equation yields the difference equation at each interior node $x_i$:\n$$\n- \\varepsilon \\left( \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} \\right) + \\beta \\left( \\frac{u_{i+1} - u_{i-1}}{2h} \\right) = 0\n$$\nTo simplify, we can clear the denominators by multiplying the entire equation by $h^2$:\n$$\n- \\varepsilon (u_{i-1} - 2u_i + u_{i+1}) + \\frac{\\beta h}{2} (u_{i+1} - u_{i-1}) = 0\n$$\nRearranging the terms to group coefficients for $u_{i-1}$, $u_i$, and $u_{i+1}$:\n$$\n\\left(-\\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\\right) u_{i-1} + \\left(\\frac{2\\varepsilon}{h^2}\\right) u_i + \\left(-\\frac{\\varepsilon}{h^2} + \\frac{\\beta}{2h}\\right) u_{i+1} = 0\n$$\n\n**Step 3: Constructing the Linear System**\n\nWe apply this difference equation at the two interior nodes, $x_1$ (where $i=1$) and $x_2$ (where $i=2$).\n\nFor node $i=1$:\nThe equation involves $u_0$, $u_1$, and $u_2$. We substitute the known boundary value $u_0=0$:\n$$\n\\left(\\frac{2\\varepsilon}{h^2}\\right) u_1 + \\left(-\\frac{\\varepsilon}{h^2} + \\frac{\\beta}{2h}\\right) u_2 = 0\n$$\n\nFor node $i=2$:\nThe equation involves $u_1$, $u_2$, and $u_3$. We substitute the known boundary value $u_3=1$:\n$$\n\\left(-\\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\\right) u_1 + \\left(\\frac{2\\varepsilon}{h^2}\\right) u_2 + \\left(-\\frac{\\varepsilon}{h^2} + \\frac{\\beta}{2h}\\right) (1) = 0\n$$\nMoving the constant term to the right-hand side gives:\n$$\n\\left(-\\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\\right) u_1 + \\left(\\frac{2\\varepsilon}{h^2}\\right) u_2 = \\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\n$$\n\n**Step 4: Substituting Parameters and Solving the System**\n\nWe are given the parameters $\\varepsilon=1$, $\\beta=12$, and $h=\\frac{1}{3}$. We first calculate the values of the coefficients:\n$$\n\\frac{2\\varepsilon}{h^2} = \\frac{2(1)}{(\\frac{1}{3})^2} = \\frac{2}{\\frac{1}{9}} = 18\n$$\n$$\n-\\frac{\\varepsilon}{h^2} = -\\frac{1}{(\\frac{1}{3})^2} = -9\n$$\n$$\n\\frac{\\beta}{2h} = \\frac{12}{2(\\frac{1}{3})} = \\frac{12}{\\frac{2}{3}} = 18\n$$\nNow, substitute these values into the two equations for the linear system.\n\nEquation for $i=1$:\n$$\n(18) u_1 + (-9 + 18) u_2 = 0 \\implies 18 u_1 + 9 u_2 = 0\n$$\nDividing by $9$, we get:\n$$\n2 u_1 + u_2 = 0\n$$\n\nEquation for $i=2$:\n$$\n(-9 - 18) u_1 + (18) u_2 = 9 - 18\n$$\n$$\n-27 u_1 + 18 u_2 = -9\n$$\nDividing by $9$, we get:\n$$\n-3 u_1 + 2 u_2 = -1\n$$\nThe two-by-two linear system is:\n$$\n\\begin{cases}\n2 u_1 + u_2 = 0 \\\\\n-3 u_1 + 2 u_2 = -1\n\\end{cases}\n$$\nFrom the first equation, we can express $u_2$ in terms of $u_1$:\n$$\nu_2 = -2 u_1\n$$\nSubstitute this expression into the second equation:\n$$\n-3 u_1 + 2 (-2 u_1) = -1\n$$\n$$\n-3 u_1 - 4 u_1 = -1\n$$\n$$\n-7 u_1 = -1 \\implies u_1 = \\frac{1}{7}\n$$\nNow we can find the value of $u_2$:\n$$\nu_2 = -2 u_1 = -2 \\left(\\frac{1}{7}\\right) = -\\frac{2}{7}\n$$\nThe solution to the linear system is $u_1 = \\frac{1}{7}$ and $u_2 = -\\frac{2}{7}$.\n\n**Step 5: Interpretation in the Context of the Mesh Péclet Number**\n\nThe mesh Péclet number is defined as $Pe_h = \\frac{\\beta h}{2\\varepsilon}$. For the given parameters:\n$$\nPe_h = \\frac{(12) (\\frac{1}{3})}{2(1)} = \\frac{4}{2} = 2\n$$\nWhen using central differences for the convection term, it is known that for the solution to be qualitatively correct (i.e., monotonic, without spurious oscillations), the mesh Péclet number must satisfy the condition $Pe_h \\le 1$. In our case, $Pe_h=2 > 1$, which places us in the large mesh Péclet number regime, where central differencing is unstable and prone to producing unphysical oscillations.\n\nThe analytical solution to this boundary value problem is $u(x) = \\frac{\\exp(\\frac{\\beta}{\\varepsilon}x) - 1}{\\exp(\\frac{\\beta}{\\varepsilon}) - 1}$, which is strictly monotonic and bounded between $0$ and $1$. Our numerical solution at the nodes is $u_0=0$, $u_1=\\frac{1}{7}$, $u_2=-\\frac{2}{7}$, and $u_3=1$. The negative value $u_2 = -\\frac{2}{7}$ is a clear violation of the physical bounds and demonstrates the non-monotonic, oscillatory behavior predicted for central difference schemes when the convection term dominates and the mesh is too coarse. This serves as the counterexample to monotonicity mentioned in the problem statement. The use of a backward (upwind) difference for the convection term would have produced a monotonic solution.\n\nThe problem specifically asks for the numerical value of $u_2$.\n$$\nu_2 = -\\frac{2}{7}\n$$", "answer": "$$\n\\boxed{-\\frac{2}{7}}\n$$", "id": "3395550"}, {"introduction": "Achieving higher orders of accuracy does not always require deriving entirely new, wider-stencil formulas. This practice introduces Richardson Extrapolation, a powerful and general technique for enhancing precision by systematically eliminating error terms. You will learn to combine two second-order approximations, computed on different grid resolutions, to construct a fourth-order accurate scheme, showcasing an elegant method for boosting the performance of numerical simulations [@problem_id:3395551].", "problem": "Consider a smooth function $u(x)$ arising as the spatial solution field in a partial differential equation (PDE) discretization. Let $x$ be a fixed location where $u$ is at least $C^{6}$-smooth in a neighborhood, and suppose a uniform mesh of spacing $h>0$ is available together with a refined mesh of spacing $h/2$. The standard second-order central difference approximation to $u'(x)$ with step $h$ uses the symmetric stencil at $x\\pm h$, and the analogous approximation with step $h/2$ uses the symmetric stencil at $x\\pm h/2$.\n\nStarting from Taylor’s theorem about $x$ and the definition of the central difference quotient, derive the leading-order truncation error expansions for the two central difference approximations at steps $h$ and $h/2$. Then, use Richardson extrapolation (RE) to construct a linear combination of these two approximations which cancels the $\\mathcal{O}(h^{2})$ error term and is therefore fourth-order accurate in $h$. Determine the extrapolation coefficients and write the resulting fourth-order approximation explicitly in terms of $u(x+h)$, $u(x-h)$, $u(x+h/2)$, and $u(x-h/2)$.\n\nProvide your final answer as a single closed-form analytic expression for the extrapolated approximation to $u'(x)$. No rounding is required.", "solution": "The problem statement is a well-posed, theoretically sound exercise in numerical analysis. It is based on established mathematical principles (Taylor's theorem, Richardson extrapolation) and provides all necessary conditions (e.g., $C^{6}$-smoothness) to derive a unique, meaningful solution. The problem is therefore deemed valid.\n\nLet $u(x)$ be a function that is at least $6$ times continuously differentiable ($C^{6}$) in a neighborhood of a point $x$. The standard second-order central difference approximation to the first derivative $u'(x)$ using a step size $h>0$ is given by the formula:\n$$\nD_h[u](x) = \\frac{u(x+h) - u(x-h)}{2h}\n$$\nThe analogous approximation using a refined step size of $h/2$ is:\n$$\nD_{h/2}[u](x) = \\frac{u(x+h/2) - u(x-h/2)}{2(h/2)} = \\frac{u(x+h/2) - u(x-h/2)}{h}\n$$\nTo analyze the truncation error of these approximations, we employ Taylor's theorem. Given that $u$ is $C^{6}$-smooth, we can expand $u(x+z)$ around $z=0$ up to the fifth-order term, with a remainder term of order $\\mathcal{O}(z^6)$:\n$$\nu(x+z) = u(x) + u'(x)z + \\frac{u''(x)}{2!}z^2 + \\frac{u'''(x)}{3!}z^3 + \\frac{u^{(4)}(x)}{4!}z^4 + \\frac{u^{(5)}(x)}{5!}z^5 + \\mathcal{O}(z^6)\n$$\nSubstituting $z=h$ and $z=-h$ respectively, we obtain:\n$$\nu(x+h) = u(x) + u'(x)h + \\frac{u''(x)}{2}h^2 + \\frac{u'''(x)}{6}h^3 + \\frac{u^{(4)}(x)}{24}h^4 + \\frac{u^{(5)}(x)}{120}h^5 + \\mathcal{O}(h^6)\n$$\n$$\nu(x-h) = u(x) - u'(x)h + \\frac{u''(x)}{2}h^2 - \\frac{u'''(x)}{6}h^3 + \\frac{u^{(4)}(x)}{24}h^4 - \\frac{u^{(5)}(x)}{120}h^5 + \\mathcal{O}(h^6)\n$$\nSubtracting the second expansion from the first cancels the terms with even powers of $h$ (i.e., $u(x)$, $u''(x)$, $u^{(4)}(x)$):\n$$\nu(x+h) - u(x-h) = 2u'(x)h + 2\\frac{u'''(x)}{6}h^3 + 2\\frac{u^{(5)}(x)}{120}h^5 + \\mathcal{O}(h^7)\n$$\nNote that the remainder term becomes $\\mathcal{O}(h^7)$ because the $h^6$ terms in the original expansions have opposite signs and also cancel. Dividing by $2h$ yields the error expansion for $D_h[u](x)$:\n$$\nD_h[u](x) = u'(x) + \\frac{u'''(x)}{6}h^2 + \\frac{u^{(5)}(x)}{120}h^4 + \\mathcal{O}(h^6)\n$$\nThe leading-order truncation error is $\\frac{u'''(x)}{6}h^2$. This confirms the approximation is second-order accurate.\n\nTo find the error expansion for $D_{h/2}[u](x)$, we substitute $h$ with $h/2$ in the expression above:\n$$\nD_{h/2}[u](x) = u'(x) + \\frac{u'''(x)}{6}\\left(\\frac{h}{2}\\right)^2 + \\frac{u^{(5)}(x)}{120}\\left(\\frac{h}{2}\\right)^4 + \\mathcal{O}\\left(h^6\\right)\n$$\n$$\nD_{h/2}[u](x) = u'(x) + \\frac{u'''(x)}{24}h^2 + \\frac{u^{(5)}(x)}{1920}h^4 + \\mathcal{O}(h^6)\n$$\nThe leading-order truncation error for this finer approximation is $\\frac{u'''(x)}{24}h^2$.\n\nWe now use Richardson extrapolation to find a linear combination of $D_h[u](x)$ and $D_{h/2}[u](x)$ that eliminates the $\\mathcal{O}(h^2)$ error term. Let $L=u'(x)$ be the exact value. We have two approximations:\n$$\nA_h = D_h[u](x) = L + K_2 h^2 + K_4 h^4 + \\mathcal{O}(h^6)\n$$\n$$\nA_{h/2} = D_{h/2}[u](x) = L + K_2 \\frac{h^2}{4} + K_4 \\frac{h^4}{16} + \\mathcal{O}(h^6)\n$$\nwhere $K_2 = \\frac{u'''(x)}{6}$ and $K_4 = \\frac{u^{(5)}(x)}{120}$. We seek an extrapolated approximation $A_{RE} = c_1 A_{h/2} + c_2 A_h$. For $A_{RE}$ to be a consistent approximation of $L$, we require $c_1 + c_2 = 1$. To cancel the $\\mathcal{O}(h^2)$ term, we require:\n$$\nc_1 \\left(K_2 \\frac{h^2}{4}\\right) + c_2 (K_2 h^2) = 0 \\implies \\frac{c_1}{4} + c_2 = 0\n$$\nThis gives a system of two linear equations for the coefficients $c_1$ and $c_2$:\n\\begin{cases} c_1 + c_2 = 1 \\\\ \\frac{c_1}{4} + c_2 = 0 \\end{cases}\nFrom the second equation, $c_2 = -c_1/4$. Substituting into the first equation gives:\n$$\nc_1 - \\frac{c_1}{4} = 1 \\implies \\frac{3c_1}{4} = 1 \\implies c_1 = \\frac{4}{3}\n$$\nThe second coefficient is $c_2 = 1 - c_1 = 1 - \\frac{4}{3} = -\\frac{1}{3}$.\nThe extrapolation coefficients are $c_1 = 4/3$ and $c_2 = -1/3$.\n\nThe fourth-order accurate approximation is therefore:\n$$\nA_{RE} = \\frac{4}{3}A_{h/2} - \\frac{1}{3}A_h = \\frac{4}{3}D_{h/2}[u](x) - \\frac{1}{3}D_h[u](x)\n$$\nThe error of this new approximation is $\\mathcal{O}(h^4)$:\n$$\nA_{RE} = L + \\left(\\frac{4}{3}\\frac{K_4}{16} - \\frac{1}{3}K_4\\right)h^4 + \\mathcal{O}(h^6) = L + \\left(\\frac{K_4}{12} - \\frac{K_4}{3}\\right)h^4 + \\mathcal{O}(h^6) = L - \\frac{K_4}{4}h^4 + \\mathcal{O}(h^6)\n$$\nThe leading error term is $-\\frac{h^4}{4}K_4 = -\\frac{h^4}{4}\\frac{u^{(5)}(x)}{120} = -\\frac{u^{(5)}(x)}{480}h^4$.\n\nFinally, we write the approximation explicitly in terms of the function values:\n$$\nA_{RE} = \\frac{4}{3} \\left( \\frac{u(x+h/2) - u(x-h/2)}{h} \\right) - \\frac{1}{3} \\left( \\frac{u(x+h) - u(x-h)}{2h} \\right)\n$$\nCombining the terms over a common denominator of $6h$:\n$$\nA_{RE} = \\frac{1}{6h} \\left[ 8 \\left(u\\left(x+\\frac{h}{2}\\right) - u\\left(x-\\frac{h}{2}\\right)\\right) - \\left(u(x+h) - u(x-h)\\right) \\right]\n$$\nRearranging the terms gives the final expression for the fourth-order approximation to $u'(x)$:\n$$\nA_{RE} = \\frac{-u(x+h) + 8u(x+h/2) - 8u(x-h/2) + u(x-h)}{6h}\n$$", "answer": "$$\n\\boxed{\\frac{-u(x+h) + 8u\\left(x+\\frac{h}{2}\\right) - 8u\\left(x-\\frac{h}{2}\\right) + u(x-h)}{6h}}\n$$", "id": "3395551"}]}