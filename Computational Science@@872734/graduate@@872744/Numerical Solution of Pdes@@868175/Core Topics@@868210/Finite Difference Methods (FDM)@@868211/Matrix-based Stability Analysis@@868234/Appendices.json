{"hands_on_practices": [{"introduction": "We begin with a foundational exercise in matrix-based stability analysis. By deriving the exact eigenvalues of the discrete Laplacian for the 1D heat equation, we can directly link the operator's spectrum to the stability limits of an explicit time-stepping scheme. This practice [@problem_id:3419083] builds a concrete understanding of how the spectral radius condition, $\\rho(G) \\le 1$, translates into a practical constraint on the time step for a parabolic problem.", "problem": "Consider the heat equation, a canonical linear Partial Differential Equation (PDE),\n$$\nu_{t}(x,t) = \\kappa\\,u_{xx}(x,t), \\quad x \\in (0,\\,1), \\quad t  0,\n$$\nwith homogeneous Dirichlet boundary conditions\n$$\nu(0,t) = 0, \\quad u(1,t) = 0,\n$$\nand a given strictly positive thermal diffusivity parameter $\\kappa  0$. Discretize the spatial interval $(0,\\,1)$ into $M$ equal subintervals of length $h = \\frac{1}{M}$, so the interior grid points are $x_{i} = i h$ for $i = 1,\\,2,\\,\\dots,\\,M-1$. Using the standard second-order central difference approximation for the second derivative, the semi-discrete system has the form of an Ordinary Differential Equation (ODE),\n$$\n\\frac{d\\boldsymbol{u}(t)}{dt} = \\kappa\\,L_{h}\\,\\boldsymbol{u}(t),\n$$\nwhere $\\boldsymbol{u}(t) \\in \\mathbb{R}^{M-1}$ collects the values at interior grid points and $L_{h} \\in \\mathbb{R}^{(M-1)\\times(M-1)}$ is the discrete Laplacian matrix with homogeneous Dirichlet boundary conditions,\n$$\nL_{h} = \\frac{1}{h^{2}}\n\\begin{bmatrix}\n-2  1  0  \\cdots  0 \\\\\n1  -2  1  \\ddots  \\vdots \\\\\n0  1  -2  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  1 \\\\\n0  \\cdots  0  1  -2\n\\end{bmatrix}.\n$$\nYou will analyze stability of the explicit Forward Euler (FE) time discretization, defined by\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\kappa\\,L_{h}\\,\\boldsymbol{u}^{n},\n$$\nwhere $\\Delta t  0$ is the time step. Using matrix-based stability analysis, proceed from first principles:\n\n- Determine the full set of eigenpairs of the symmetric tridiagonal Toeplitz matrix inside $L_{h}$ that correspond to homogeneous Dirichlet boundary conditions on $(0,\\,1)$.\n- Identify the algebraically largest eigenvalue of $L_{h}$ (that is, the eigenvalue with the greatest real value).\n- Using the scalar test ODE $y'(t) = \\lambda\\,y(t)$ as a foundational stability model and the FE stability region on the negative real axis, deduce the exact explicit time-step restriction $\\Delta t_{\\max}$ required to ensure the spectral radius of the FE amplification matrix $I + \\Delta t\\,\\kappa\\,L_{h}$ does not exceed $1$.\n\nExpress your final answers in closed form as functions of $M$, $h$, and $\\kappa$. No numerical evaluation is required, and no rounding is permitted. Provide the final answers as the algebraically largest eigenvalue of $L_{h}$ and the corresponding maximum stable time step $\\Delta t_{\\max}$.", "solution": "The problem statement is found to be valid as it represents a standard, well-posed problem in the field of numerical analysis for partial differential equations. It is scientifically grounded, objective, and self-contained.\n\nThe problem asks for a matrix-based stability analysis of the Forward Euler (FE) method applied to the semi-discretized heat equation. We will proceed by first determining the eigenpairs of the discrete Laplacian matrix, then identifying the relevant eigenvalue for stability, and finally deriving the maximum stable time step.\n\nLet the matrix $A \\in \\mathbb{R}^{(M-1)\\times(M-1)}$ be the tridiagonal matrix component of $L_h$, such that $L_h = \\frac{1}{h^2}A$.\n$$\nA =\n\\begin{bmatrix}\n-2  1  0  \\cdots  0 \\\\\n1  -2  1  \\ddots  \\vdots \\\\\n0  1  -2  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  1 \\\\\n0  \\cdots  0  1  -2\n\\end{bmatrix}\n$$\nThe eigenvalues $\\lambda$ and eigenvectors $\\boldsymbol{v}$ of $A$ are found by solving the eigenvalue problem $A\\boldsymbol{v} = \\lambda\\boldsymbol{v}$. Let $\\boldsymbol{v} = (v_1, v_2, \\dots, v_{M-1})^T$. The $i$-th row of the system of equations is:\n$$\nv_{i-1} - 2v_i + v_{i+1} = \\lambda v_i, \\quad \\text{for } i = 1, 2, \\dots, M-1.\n$$\nThe homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(1,t)=0$ imply that for the eigenvectors, we must have $v_0 = 0$ and $v_M = 0$. We can rewrite the equation as a second-order linear homogeneous difference equation:\n$$\nv_{i+1} - (2+\\lambda)v_i + v_{i-1} = 0.\n$$\nA standard ansatz for the solution is $v_i = C\\sin(i\\theta)$ for some angle $\\theta$. Substituting this into the difference equation:\n$$\n\\sin((i+1)\\theta) - (2+\\lambda)\\sin(i\\theta) + \\sin((i-1)\\theta) = 0.\n$$\nUsing the trigonometric identity $\\sin(\\alpha+\\beta) + \\sin(\\alpha-\\beta) = 2\\sin(\\alpha)\\cos(\\beta)$, we get:\n$$\n2\\sin(i\\theta)\\cos(\\theta) - (2+\\lambda)\\sin(i\\theta) = 0.\n$$\nFor a non-trivial eigenvector, $\\sin(i\\theta)$ cannot be zero for all $i$, so we can divide by it:\n$$\n2\\cos(\\theta) - (2+\\lambda) = 0 \\implies \\lambda = 2\\cos(\\theta) - 2.\n$$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, this becomes:\n$$\n\\lambda = -2(1-\\cos(\\theta)) = -4\\sin^2\\left(\\frac{\\theta}{2}\\right).\n$$\nNow we apply the boundary conditions. The condition $v_0 = \\sin(0\\cdot\\theta)=0$ is automatically satisfied. The condition $v_M=0$ requires:\n$$\n\\sin(M\\theta) = 0.\n$$\nThis implies $M\\theta = p\\pi$ for some integer $p$. Thus, $\\theta_p = \\frac{p\\pi}{M}$.\nThe index $p$ must run from $p=1, 2, \\dots, M-1$ to generate $M-1$ linearly independent eigenvectors. If $p=0$ or $p=M$, a trivial zero vector is produced.\n\nSo, the $M-1$ eigenpairs $(\\lambda_p, \\boldsymbol{v}_p)$ of the matrix $A$ are:\n- Eigenvalues: $\\lambda_p = -4\\sin^2\\left(\\frac{p\\pi}{2M}\\right)$ for $p=1, 2, \\dots, M-1$.\n- Eigenvectors: The $i$-th component of the $p$-th eigenvector $\\boldsymbol{v}_p$ is $(\\boldsymbol{v}_p)_i = \\sin\\left(\\frac{ip\\pi}{M}\\right)$ for $i=1, 2, \\dots, M-1$.\n\nThe eigenvalues of the discrete Laplacian matrix $L_h = \\frac{1}{h^2}A$ are therefore:\n$$\n\\mu_p = \\frac{1}{h^2}\\lambda_p = -\\frac{4}{h^2}\\sin^2\\left(\\frac{p\\pi}{2M}\\right), \\quad \\text{for } p=1, 2, \\dots, M-1.\n$$\nAll these eigenvalues are real and negative. The \"algebraically largest\" eigenvalue is the one with the smallest magnitude (i.e., closest to zero). The function $\\sin^2(x)$ is increasing for $x \\in [0, \\pi/2]$. The argument $\\frac{p\\pi}{2M}$ is in the range $(0, \\pi/2)$ for $p=1, \\dots, M-1$. Therefore, the smallest magnitude occurs for the smallest value of $p$, which is $p=1$.\n\nThe algebraically largest eigenvalue of $L_h$ is:\n$$\n\\mu_{\\text{largest}} = \\mu_1 = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2M}\\right).\n$$\nNext, we analyze the stability of the Forward Euler scheme:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{n} + \\Delta t\\,\\kappa\\,L_{h}\\,\\boldsymbol{u}^{n} = (I + \\Delta t\\,\\kappa\\,L_{h})\\boldsymbol{u}^{n}.\n$$\nThe matrix $G = I + \\Delta t\\,\\kappa\\,L_{h}$ is the amplification matrix. For the method to be stable, the spectral radius of $G$ must not exceed $1$, i.e., $\\rho(G) \\le 1$.\nThe eigenvalues of $G$, denoted by $g_p$, are related to the eigenvalues $\\mu_p$ of $L_h$ by:\n$$\ng_p = 1 + \\Delta t\\,\\kappa\\,\\mu_p.\n$$\nThe stability condition is $|g_p| \\le 1$ for all $p=1, \\dots, M-1$.\n$$\n|1 + \\Delta t\\,\\kappa\\,\\mu_p| \\le 1.\n$$\nSince $\\Delta t  0$, $\\kappa  0$, and $\\mu_p  0$, the term $\\Delta t\\,\\kappa\\,\\mu_p$ is a negative real number. The stability condition simplifies to:\n$$\n-1 \\le 1 + \\Delta t\\,\\kappa\\,\\mu_p \\le 1.\n$$\nThe right-hand inequality, $1 + \\Delta t\\,\\kappa\\,\\mu_p \\le 1$, implies $\\Delta t\\,\\kappa\\,\\mu_p \\le 0$, which is always satisfied.\nThe left-hand inequality, $-1 \\le 1 + \\Delta t\\,\\kappa\\,\\mu_p$, is the one that imposes a restriction on $\\Delta t$:\n$$\n-2 \\le \\Delta t\\,\\kappa\\,\\mu_p \\implies \\Delta t \\le \\frac{-2}{\\kappa \\mu_p}.\n$$\nSubstituting the expression for $\\mu_p$:\n$$\n\\Delta t \\le \\frac{-2}{\\kappa \\left(-\\frac{4}{h^2}\\sin^2\\left(\\frac{p\\pi}{2M}\\right)\\right)} = \\frac{2h^2}{4\\kappa\\sin^2\\left(\\frac{p\\pi}{2M}\\right)} = \\frac{h^2}{2\\kappa\\sin^2\\left(\\frac{p\\pi}{2M}\\right)}.\n$$\nThis inequality must hold for all $p=1, 2, \\dots, M-1$. The most restrictive condition (the smallest upper bound on $\\Delta t$) comes from the eigenvalue that maximizes the term $\\sin^2\\left(\\frac{p\\pi}{2M}\\right)$ in the denominator. This occurs for the largest value of $p$, which is $p=M-1$.\nThe stability is thus governed by the eigenvalue $\\mu_{M-1}$:\n$$\n\\Delta t \\le \\frac{h^2}{2\\kappa\\sin^2\\left(\\frac{(M-1)\\pi}{2M}\\right)}.\n$$\nWe can simplify the sine term using $\\sin\\left(\\frac{(M-1)\\pi}{2M}\\right) = \\sin\\left(\\frac{M\\pi - \\pi}{2M}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2M}\\right) = \\cos\\left(\\frac{\\pi}{2M}\\right)$.\nSo, the maximum stable time step, $\\Delta t_{\\max}$, is:\n$$\n\\Delta t_{\\max} = \\frac{h^2}{2\\kappa\\cos^2\\left(\\frac{\\pi}{2M}\\right)}.\n$$\nThe two requested quantities are the algebraically largest eigenvalue of $L_h$ and the maximum stable time step $\\Delta t_{\\max}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{\\pi}{2M}\\right)  \\frac{h^{2}}{2\\kappa\\cos^{2}\\left(\\frac{\\pi}{2M}\\right)} \\end{pmatrix}}\n$$", "id": "3419083"}, {"introduction": "While exact eigenvalue analysis is powerful, it is often infeasible for complex, high-dimensional, or irregularly structured matrices. This exercise introduces a more general and highly practical tool: the Gershgorin Circle Theorem. By using this theorem to find a guaranteed enclosure for the spectrum of a $d$-dimensional discrete Laplacian, you will learn to derive a conservative but reliable stability condition without needing to solve the full eigenvalue problem [@problem_id:3419070].", "problem": "Consider the $d$-dimensional heat partial differential equation (PDE) $u_{t} = \\nu \\Delta u$ on the unit hypercube $(0,1)^{d}$ with homogeneous Dirichlet boundary conditions and kinematic viscosity $\\nu  0$. Discretize space on a uniform Cartesian grid with mesh size $h$, and eliminate boundary values to form the standard second-order central-difference semi-discrete system $u^{\\prime}(t) = A u(t)$, where $A \\in \\mathbb{R}^{N \\times N}$ is the discrete Laplacian with homogeneous Dirichlet boundary conditions scaled by $\\nu$. For each interior grid point, the diagonal entry of $A$ equals $-2d\\,\\nu/h^{2}$, each of its nearest-neighbor interior couplings equals $\\nu/h^{2}$, there are at most $2d$ such couplings, and all other entries are zero.\n\nState the Gershgorin Circle Theorem, and then, using only this theorem together with the structural properties of $A$ just described, derive a real interval guaranteed to contain the entire spectrum of $A$. Next, consider the Forward Euler (FE) time discretization applied to the semi-discrete system,\n$$\nu^{n+1} = \\bigl(I + \\Delta t\\, A\\bigr)\\,u^{n}.\n$$\nImpose absolute stability in the sense that the spectral radius of the amplification matrix is at most $1$ using only the spectral enclosure you derived. From this requirement, determine a conservative closed-form expression for the largest admissible time step $\\Delta t_{\\max}$ in terms of $d$, $\\nu$, and $h$ such that the FE method is guaranteed to be absolutely stable for all choices of $A$ consistent with the description above. Provide your final answer as a single analytic expression. Do not include units in your final answer.", "solution": "The problem asks for a derivation of the maximum stable time step for the Forward Euler method applied to the semi-discretized $d$-dimensional heat equation, based on a spectral enclosure provided by the Gershgorin Circle Theorem.\n\nFirst, we state the Gershgorin Circle Theorem. For any complex square matrix $M \\in \\mathbb{C}^{N \\times N}$, all of its eigenvalues lie within the union of the Gershgorin discs in the complex plane. The $i$-th disc, $D_i$, is defined by\n$$\nD_i = \\left\\{ z \\in \\mathbb{C} : |z - M_{ii}| \\leq R_i \\right\\}, \\quad \\text{where the radius is} \\quad R_i = \\sum_{j \\neq i} |M_{ij}|.\n$$\n\nNext, we apply this theorem to the given matrix $A \\in \\mathbb{R}^{N \\times N}$. The problem specifies the structure of $A$:\n1.  The diagonal entries are constant for all interior points: $A_{ii} = -\\frac{2d\\nu}{h^2}$.\n2.  The off-diagonal entries for nearest-neighbor couplings are $A_{ij} = \\frac{\\nu}{h^2}$. For all other non-diagonal connections, $A_{ij}=0$.\n3.  Each interior grid point $i$ has $k_i$ interior nearest neighbors, where $k_i \\le 2d$.\n\nWe can now determine the properties of the Gershgorin discs for matrix $A$. For any row $i$, the center of the disc $D_i$ is the diagonal entry:\n$$\nc_i = A_{ii} = -\\frac{2d\\nu}{h^2}.\n$$\nAll discs share the same center, which we denote by $c = -\\frac{2d\\nu}{h^2}$. The radius of the $i$-th disc, $R_i$, is the sum of the absolute values of the off-diagonal entries in the $i$-th row. Since $\\nu  0$ and $h  0$, the off-diagonal entries are non-negative.\n$$\nR_i = \\sum_{j \\neq i} |A_{ij}| = k_i \\cdot \\frac{\\nu}{h^2}.\n$$\nThe problem states that any interior point is coupled to at most $2d$ other interior points. Thus, $k_i \\le 2d$. The radius $R_i$ is therefore bounded by:\n$$\nR_i \\le 2d \\frac{\\nu}{h^2}.\n$$\nLet $R_{\\max} = 2d \\frac{\\nu}{h^2}$. The spectrum of $A$, denoted $\\sigma(A)$, is contained in the union of all discs $\\bigcup_{i=1}^{N} D_i$. Since all discs are centered at the same point $c$, their union is simply the largest disc, which is the one with the maximum possible radius, $R_{\\max}$. Thus, all eigenvalues $\\lambda$ of $A$ must lie within the disc $D_{\\max}$:\n$$\nD_{\\max} = \\left\\{ z \\in \\mathbb{C} : \\left|z - \\left(-\\frac{2d\\nu}{h^2}\\right)\\right| \\leq \\frac{2d\\nu}{h^2} \\right\\}.\n$$\nThe matrix $A$ is the discrete analogue of the operator $\\nu\\Delta$. The standard second-order central-difference discretization results in a symmetric matrix, as the coupling from grid point $i$ to $j$ is identical to the coupling from $j$ to $i$. This is consistent with the problem description. A real symmetric matrix has only real eigenvalues. Therefore, all eigenvalues $\\lambda$ of $A$ must be real numbers.\n\nThe real interval guaranteed to contain the spectrum of $A$ is the intersection of the disc $D_{\\max}$ with the real axis. This interval is $[c - R_{\\max}, c + R_{\\max}]$.\n$$\n\\lambda \\in \\left[ -\\frac{2d\\nu}{h^2} - \\frac{2d\\nu}{h^2}, -\\frac{2d\\nu}{h^2} + \\frac{2d\\nu}{h^2} \\right] = \\left[ -\\frac{4d\\nu}{h^2}, 0 \\right].\n$$\nNow, we analyze the stability of the Forward Euler (FE) method, $u^{n+1} = (I + \\Delta t\\, A)u^{n}$. The amplification matrix is $G = I + \\Delta t\\, A$. The method is absolutely stable if the spectral radius of $G$ is at most $1$, i.e., $\\rho(G) \\leq 1$.\nThe eigenvalues $\\mu_j$ of $G$ are related to the eigenvalues $\\lambda_j$ of $A$ by $\\mu_j = 1 + \\Delta t\\, \\lambda_j$. The stability condition is therefore $|\\mu_j| \\leq 1$ for all eigenvalues $j$, which translates to:\n$$\n|1 + \\Delta t\\, \\lambda_j| \\leq 1, \\quad \\forall \\lambda_j \\in \\sigma(A).\n$$\nTo guarantee stability for any matrix $A$ consistent with the problem description, we must enforce this condition for all values of $\\lambda$ in the enclosure we derived: $\\lambda \\in [-\\frac{4d\\nu}{h^2}, 0]$.\nSince $\\Delta t  0$ and $\\lambda_j \\leq 0$, the quantity $1 + \\Delta t\\, \\lambda_j$ is always less than or equal to $1$. The stability condition simplifies to:\n$$\n1 + \\Delta t\\, \\lambda_j \\geq -1.\n$$\nThis inequality must hold for all $\\lambda_j$ in the spectrum. The condition is most restrictive for the most negative eigenvalue. To ensure it holds for all possible eigenvalues based on our enclosure, we must satisfy it for the lower bound of the interval, $\\lambda = -\\frac{4d\\nu}{h^2}$.\n$$\n1 + \\Delta t \\left(-\\frac{4d\\nu}{h^2}\\right) \\geq -1.\n$$\nSolving for the time step $\\Delta t$:\n$$\n1 - \\frac{4d\\nu\\Delta t}{h^2} \\geq -1\n$$\n$$\n2 \\geq \\frac{4d\\nu\\Delta t}{h^2}\n$$\n$$\n\\Delta t \\leq \\frac{2h^2}{4d\\nu} = \\frac{h^2}{2d\\nu}.\n$$\nThis inequality gives the condition for absolute stability. The problem asks for the largest admissible time step, $\\Delta t_{\\max}$, which is the upper bound of this range.\n$$\n\\Delta t_{\\max} = \\frac{h^2}{2d\\nu}.\n$$\nThis expression is conservative because it is derived from the Gershgorin circle enclosure, which provides an upper bound on the magnitude of the eigenvalues.", "answer": "$$\\boxed{\\frac{h^2}{2d\\nu}}$$", "id": "3419070"}, {"introduction": "The stability of numerical methods for non-normal systems cannot be fully understood by spectral radius alone. This advanced, computational practice demonstrates the crucial distinction between eigenvalue analysis (von Neumann analysis) and a more robust pseudospectral analysis. By constructing a counterexample where the eigenvalues predict stability but the pseudospectrum reveals the potential for large transient growth, you will gain hands-on experience with the phenomena that motivate modern stability theory [@problem_id:3419087].", "problem": "Consider the linear advection Partial Differential Equation (PDE) $u_t + a u_x = 0$ on the interval $x \\in (0,1)$ with inflow boundary condition $u(0,t) = 0$ and uniform grid spacing $h = 1/(N+1)$. A first-order backward-difference semi-discretization of the spatial derivative produces a lower bidiagonal matrix for the derivative $u_x$, and thus a semi-discrete Ordinary Differential Equation (ODE) system of the form $u'(t) = A u(t)$. For the inflow boundary case, this yields a matrix $A$ that is non-normal and, in the pure-advection case, is similar to a single Jordan block. In contrast, for the periodic boundary case, the spatial discretization matrix is circulant and normal.\n\nWe consider the explicit classical fourth-order Runge–Kutta (RK) method with stability function $R(z) = 1 + z + z^2/2 + z^3/6 + z^4/24$. Let the Courant–Friedrichs–Lewy-like non-dimensional parameter be $c = a \\Delta t / h$, where $\\Delta t$ is the time step. Define the time-step matrix $G = R(\\Delta t A)$. Scalar Fourier (von Neumann) analysis with periodic boundary conditions diagonalizes the discretization by Fourier modes with symbol $z(\\theta) = -c (1 - e^{-i\\theta})$, where $\\theta \\in [0,2\\pi)$, so that the Fourier stability condition demands $\\max_{\\theta} |R(z(\\theta))| \\le 1$. However, matrix-based stability analysis must consider non-normality and pseudospectra. The $\\varepsilon$-pseudospectrum of a matrix $G$, denoted $\\Lambda_{\\varepsilon}(G)$, is the set of $z \\in \\mathbb{C}$ such that $\\sigma_{\\min}(z I - G) \\le \\varepsilon$, where $\\sigma_{\\min}$ denotes the smallest singular value and $I$ is the identity matrix. If $\\Lambda_{\\varepsilon}(G)$ protrudes outside the unit disk for small $\\varepsilon$, then small perturbations (e.g., due to rounding errors or modeling uncertainty) can lead to eigenvalues outside the unit disk and, via the Kreiss matrix theorem, large transient amplification of the iterates $G^n$, even when all eigenvalues of $G$ lie inside the unit disk.\n\nYour task is to construct a concrete counterexample in code that demonstrates the following phenomenon: the Fourier eigenvalues lie inside the RK stability region (i.e., $\\max_{\\theta} |R(z(\\theta))| \\le 1$), but the pseudospectrum of the actual time-step matrix with inflow (Dirichlet) boundary conditions indicates potential transient growth that jeopardizes stability. You must:\n\n- Use the non-dimensional parameter $c = a \\Delta t / h$ as the only free scaling between time and space.\n- For the inflow (Dirichlet) case, use the semi-discrete operator with matrix form $\\Delta t A = -c (I - J)$, where $I \\in \\mathbb{C}^{N \\times N}$ is the identity and $J \\in \\mathbb{C}^{N \\times N}$ is the strictly lower shift with ones on the first subdiagonal and zeros elsewhere. This operator corresponds to backward differencing with an inflow boundary and is highly non-normal; for the pure advection case it consists of a single Jordan block shifted by $-c$.\n- For the periodic case, use $\\Delta t A = -c (I - J_{\\mathrm{per}})$, where $J_{\\mathrm{per}}$ is the cyclic lower shift with ones on the first subdiagonal and an additional one in the top-right corner. This operator is circulant and normal.\n\nFor a given $c$ and $N$, you must compute:\n\n1. Fourier (von Neumann) stability check: sample $\\theta_j = 2\\pi j/M$, for $j = 0,\\dots,M-1$, with $M$ specified, compute $z(\\theta_j) = -c (1 - e^{-i\\theta_j})$, and verify $\\max_j |R(z(\\theta_j))| \\le 1$.\n\n2. Time-step matrix construction: form $G = R(\\Delta t A)$ using the RK stability polynomial applied to the chosen matrix $\\Delta t A$.\n\n3. Pseudospectrum crossing test: for a specified $\\varepsilon  0$, a radius scan $r \\in [1, r_{\\max}]$, and an angle grid $\\phi_k = 2\\pi k/K$, for $k = 0,\\dots,K-1$, compute for each radius $r$ the minimum over $\\phi$ of the smallest singular value $\\sigma_{\\min}(r e^{i\\phi} I - G)$. Declare that the $\\varepsilon$-pseudospectrum crosses outside the unit circle if there exists some $r  1$ with $\\min_{\\phi} \\sigma_{\\min}(r e^{i\\phi} I - G) \\le \\varepsilon$. Report the largest scanned radius $r_{\\star}$ where this inequality holds; if no crossing is detected, report $r_{\\star} = 1$.\n\nAll computations are purely mathematical; no physical units are required.\n\nTest suite. Your program must run the following three test cases:\n\n- Test case $1$ (counterexample, non-normal inflow): $N = 40$, $c = 1.3$, boundary type inflow (Dirichlet), $\\varepsilon = 10^{-8}$, pseudospectrum radius range $[1, 1.2]$ sampled with $n_r = 21$ equally spaced radii, and $K = 32$ angles; use $M = 1024$ Fourier samples for the Fourier stability check. This case should satisfy the Fourier stability check and exhibit an $\\varepsilon$-pseudospectrum protrusion outside the unit disk.\n\n- Test case $2$ (baseline, normal periodic): $N = 40$, $c = 1.3$, boundary type periodic, $\\varepsilon = 10^{-8}$, pseudospectrum radius range $[1, 1.2]$ sampled with $n_r = 21$, and $K = 32$ angles; use $M = 1024$ Fourier samples. This case should satisfy the Fourier stability check and not exhibit an $\\varepsilon$-pseudospectrum protrusion.\n\n- Test case $3$ (smaller system, reduced non-normality): $N = 10$, $c = 0.4$, boundary type inflow (Dirichlet), $\\varepsilon = 10^{-8}$, pseudospectrum radius range $[1, 1.2]$ with $n_r = 21$, and $K = 32$ angles; use $M = 1024$ Fourier samples. This case should satisfy the Fourier stability check and not exhibit an $\\varepsilon$-pseudospectrum protrusion.\n\nFinal output format. Your program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a three-entry list of the form $[\\text{fourier\\_stable}, \\text{ps\\_crosses}, r_{\\star}]$, where $\\text{fourier\\_stable}$ and $\\text{ps\\_crosses}$ are booleans, and $r_{\\star}$ is the largest scanned radius in $[1, r_{\\max}]$ where the crossing condition holds, rounded to three decimals, or $1.000$ if no crossing occurs. For example, an output line may look like $[[\\text{True},\\text{True},1.075],[\\text{True},\\text{False},1.000],[\\text{True},\\text{False},1.000]]$.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard, non-trivial problem in the numerical analysis of partial differential equations, specifically focusing on the stability of time-integration schemes for non-normal systems. All definitions, parameters, and computational tasks are clearly specified, forming a complete basis for a unique and meaningful solution. The problem correctly identifies the key concepts of Fourier (von Neumann) stability analysis versus pseudospectral analysis and sets up a computational experiment to demonstrate the crucial difference between them, which is a cornerstone of modern numerical stability theory.\n\nThe problem investigates the stability of the classical fourth-order Runge-Kutta (RK$4$) method for the semi-discretized linear advection equation, $u_t + a u_x = 0$. A semi-discretization in space converts the partial differential equation (PDE) into a system of ordinary differential equations (ODEs) of the form $\\frac{d\\vec{u}}{dt} = A\\vec{u}$, where $\\vec{u}(t)$ is the vector of nodal values of the solution at time $t$, and $A$ is the spatial discretization matrix.\n\nApplying an explicit time-stepping method, such as RK$4$, to this ODE system results in an iterative map $\\vec{u}^{n+1} = G \\vec{u}^n$, where $G = R(\\Delta t A)$ is the time-step or amplification matrix. The function $R(z)$ is the stability function of the time-stepping method, which for RK$4$ is the fourth-degree Taylor polynomial of the exponential function, $R(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}$. The numerical scheme is stable if the powers of the amplification matrix, $G^n$, remain bounded for all $n$. A sufficient condition for this is that the spectral radius of $G$, $\\rho(G) = \\max_j |\\lambda_j(G)|$, is less than or equal to $1$.\n\nThe structure of the matrix $A$, and consequently $G$, is determined by the spatial discretization and the boundary conditions.\n$1$. For periodic boundary conditions, the first-order backward-difference scheme on a uniform grid results in a circulant matrix, $\\Delta t A = -c(I - J_{\\mathrm{per}})$, where $c = a \\Delta t / h$ is the Courant number, $I$ is the identity matrix, and $J_{\\mathrm{per}}$ is a cyclic permutation matrix. Circulant matrices are normal, meaning they commute with their conjugate transpose ($A A^* = A^* A$). For normal matrices, the behavior of powers $G^n$ is completely determined by the eigenvalues of $G$. The eigenvalues of $\\Delta t A$ are the values of the Fourier symbol $z(\\theta) = -c(1 - e^{-i\\theta})$ for discrete frequencies $\\theta$. The eigenvalues of $G$ are $\\lambda_k = R(z(\\theta_k))$. Stability is thus governed by the condition $\\max_k |R(z(\\theta_k))| \\le 1$. This is the basis of classical von Neumann (or Fourier) stability analysis.\n\n$2$. For inflow (Dirichlet) boundary conditions, such as $u(0,t)=0$, the matrix for the same backward-difference scheme is $\\Delta t A = -c(I - J)$, where $J$ is a strictly lower-triangular shift matrix (a nilpotent Jordan block). This matrix is highly non-normal. While the eigenvalues of $G$ are all identical, $\\lambda = R(-c)$, the matrix norms $\\|G^n\\|$ can experience large transient growth before eventually decaying (if $\\rho(G)  1$). This growth is not captured by spectral analysis alone.\n\nThe concept of pseudospectra provides a more robust tool for analyzing the stability of non-normal matrices. The $\\varepsilon$-pseudospectrum of $G$, denoted $\\Lambda_{\\varepsilon}(G)$, is the set of complex numbers $z$ that are \"almost\" eigenvalues. Formally, $\\Lambda_{\\varepsilon}(G) = \\{z \\in \\mathbb{C} \\mid \\sigma_{\\min}(zI - G) \\le \\varepsilon\\}$, where $\\sigma_{\\min}$ is the smallest singular value. The Kreiss Matrix Theorem relates transient growth to the pseudospectra: the norm $\\|G^n\\|$ will be large if the pseudospectrum of $G$ extends significantly outside the unit disk in the complex plane.\n\nThis problem requires the implementation of a numerical experiment to demonstrate this distinction.\nFor a set of parameters $(N, c)$, we perform the following steps:\nFirst, a Fourier stability check is conducted. We sample the Fourier symbol $z(\\theta) = -c(1-e^{-i\\theta})$ for many values of $\\theta \\in [0, 2\\pi)$ and verify that the stability function evaluated at these points satisfies $|R(z(\\theta))| \\le 1$. This check, being independent of boundary conditions, is the same for all test cases with the same $c$.\n\nSecond, we construct the specific time-step matrix $G = R(\\Delta t A)$ based on the specified boundary conditions ('inflow' or 'periodic'). The matrix polynomial $R(\\cdot)$ is evaluated using the constructed matrix $\\Delta t A$. For the 'inflow' case, $\\Delta t A = -c(I-J)$, and for the 'periodic' case, $\\Delta t A = -c(I-J_{\\mathrm{per}})$.\n\nThird, a pseudospectrum crossing test is performed on the resulting matrix $G$. We search for the boundary of the $\\varepsilon$-pseudospectrum by finding, for a given radius $r \\ge 1$, the minimum value of $\\sigma_{\\min}(zI - G)$ for $z$ on the circle $|z|=r$. If this minimum value is less than or equal to a small tolerance $\\varepsilon$, it implies that the $\\varepsilon$-pseudospectrum, $\\Lambda_{\\varepsilon}(G)$, extends out to at least radius $r$. We report the largest such radius $r_{\\star}$ found within the scan range. If $r_{\\star}  1$, it indicates potential for transient growth, jeopardizing numerical stability despite the eigenvalues of $G$ possibly all being inside the unit disk.\n\nThe chosen test cases are designed to highlight the core phenomenon:\n- Case $1$ (inflow, $c=1.3$): A non-normal case expected to pass the Fourier check but fail the pseudospectral test, revealing a protrusion of $\\Lambda_{\\varepsilon}(G)$ outside the unit disk. This is the central counterexample.\n- Case $2$ (periodic, $c=1.3$): A normal matrix case with the same Fourier stability properties as Case $1$. It is expected to pass both tests, showing that for normal matrices, Fourier analysis is sufficient.\n- Case $3$ (inflow, $N=10, c=0.4$): A non-normal case with a smaller matrix size and a smaller Courant number. The effects of non-normality are less pronounced, and it is expected to pass both tests, showing that non-normality does not always lead to instability.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by running three test cases to compare Fourier stability\n    with pseudospectral stability for a numerical scheme for the advection equation.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, c, boundary_type, epsilon, r_max, n_r, K, M)\n        (40, 1.3, 'inflow', 1e-8, 1.2, 21, 32, 1024),\n        (40, 1.3, 'periodic', 1e-8, 1.2, 21, 32, 1024),\n        (10, 0.4, 'inflow', 1e-8, 1.2, 21, 32, 1024),\n    ]\n\n    final_results = []\n    \n    # RK4 stability polynomial\n    def rk4_poly(z):\n        return 1 + z + (z**2)/2 + (z**3)/6 + (z**4)/24\n\n    for case in test_cases:\n        N, c, boundary_type, epsilon, r_max, n_r, K, M = case\n\n        # 1. Fourier (von Neumann) stability check\n        thetas = 2 * np.pi * np.arange(M) / M\n        z_fourier = -c * (1 - np.exp(-1j * thetas))\n        max_abs_R = np.max(np.abs(rk4_poly(z_fourier)))\n        # Use a small tolerance for floating point comparison\n        fourier_stable = max_abs_R = 1.0 + 1e-9\n\n        # 2. Time-step matrix construction\n        I = np.eye(N)\n        if boundary_type == 'inflow':\n            # Strictly lower shift matrix J\n            J = np.eye(N, k=-1)\n            dt_A = -c * (I - J)\n        elif boundary_type == 'periodic':\n            # Cyclic lower shift matrix J_per\n            J_per = np.eye(N, k=-1)\n            J_per[0, N - 1] = 1\n            dt_A = -c * (I - J_per)\n        \n        # Compute G = R(dt*A)\n        dt_A_p2 = np.linalg.matrix_power(dt_A, 2)\n        dt_A_p3 = np.linalg.matrix_power(dt_A, 3)\n        dt_A_p4 = np.linalg.matrix_power(dt_A, 4)\n        G = I + dt_A + 0.5 * dt_A_p2 + (1/6) * dt_A_p3 + (1/24) * dt_A_p4\n\n        # 3. Pseudospectrum crossing test\n        radii = np.linspace(1.0, r_max, n_r)\n        angles = 2 * np.pi * np.arange(K) / K\n        \n        ps_crosses = False\n        r_star = 1.0\n\n        for r in radii:\n            if r = 1.0 + 1e-12:  # Avoid re-testing radius 1\n                continue\n            \n            min_sv_for_r = np.inf\n            # Test points on the circle |z| = r\n            z_points = r * np.exp(1j * angles)\n            \n            for z in z_points:\n                mat = z * I - G\n                # compute_uv=False is more efficient as we only need singular values\n                singular_values = np.linalg.svd(mat, compute_uv=False)\n                min_sv = singular_values[-1] # Smallest singular value\n                if min_sv  min_sv_for_r:\n                    min_sv_for_r = min_sv\n            \n            if min_sv_for_r = epsilon:\n                ps_crosses = True\n                # Radii are scanned in increasing order, so this will be the largest\n                # radius that satisfies the condition at the end of the loop.\n                r_star = r\n        \n        # Format the result for this test case\n        case_result = f\"[{'True' if fourier_stable else 'False'},{'True' if ps_crosses else 'False'},{r_star:.3f}]\"\n        final_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "3419087"}]}