{"hands_on_practices": [{"introduction": "This first practice is a comprehensive exercise that takes you from the fundamental principles of conservation laws to a fully functional numerical solver. By deriving the first-order upwind scheme from its integral form and implementing it in code, you will gain a concrete understanding of how theoretical concepts translate into practical simulations [@problem_id:3394603]. The exercise tests your implementation against various initial conditions, highlighting the scheme's characteristic behavior with both smooth and discontinuous solutions.", "problem": "Consider the linear constant-coefficient advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ on a one-dimensional periodic domain of length $L$. Starting only from the integral conservation form over a moving control volume and the requirement that the discrete flux must respect upwind information propagation, derive a first-order accurate in space and time, monotone, conservative discretization based on piecewise constant cell averages on a uniform grid with spacing $\\Delta x$ and a forward Euler time discretization with time step $\\Delta t$. Your derivation must justify the choice of the numerical flux at cell interfaces in terms of the local one-dimensional Riemann problem and must produce an explicit update that depends on the sign of the constant advection speed $a$. State a stability condition in terms of the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$ and explain how it is obtained from the forward Euler discretization and the monotonicity of the spatial operator.\n\nThen, implement a program that:\n- Constructs a uniform grid of $N$ points on $[0,L)$ representing cell centers, with periodic boundary conditions.\n- Initializes $u(x,0)$ from one of several prescribed profiles $u_{0}(x)$.\n- Advances the numerical solution using your first-order upwind scheme until a specified final time $t_{f}$, using a time step $\\Delta t$ determined by a prescribed CFL number and the grid spacing, with the last step reduced so that the total time equals exactly $t_{f}$.\n- Computes the exact solution at time $t_{f}$ as $u(x,t_{f}) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t_{f},\\,L\\right)\\right)$, where $\\operatorname{mod}(\\cdot,L)$ returns a value in $[0,L)$, and evaluates it at grid points.\n- Returns the discrete $L^{2}$-error defined by $\\left(\\Delta x \\sum_{i=0}^{N-1} \\left(u^{\\text{num}}_{i}(t_{f}) - u^{\\text{exact}}(x_{i},t_{f})\\right)^{2}\\right)^{1/2}$ as a floating-point number.\n\nYour program must run a fixed test suite of four cases, each specified by $(N, a, L, \\text{CFL}, t_{f}, u_{0})$, and output all four resulting $L^{2}$-errors on a single line as a comma-separated list enclosed in square brackets, with each value rounded to exactly eight digits after the decimal point, for example, $[0.01230000,0.00000000,1.23456789,0.00010000]$.\n\nUse radians for trigonometric functions. There are no physical units in this task.\n\nTest Suite:\n- Case $1$ (smooth wave, positive advection, moderate CFL): $N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x) = \\sin(2\\pi x)$.\n- Case $2$ (discontinuous wave, negative advection, near-CFL limit): $N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x) = \\begin{cases}1,  x \\in [0.25,0.75) \\\\ 0,  \\text{otherwise}\\end{cases}$ with periodic extension.\n- Case $3$ (Gaussian pulse, exact-shift edge case): $N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x) = \\exp\\!\\left(-100\\,(x - 0.3)^{2}\\right)$.\n- Case $4$ (multimode smooth wave, close to CFL limit): $N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x) = \\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$.\n\nImplementation requirements:\n- Use periodic boundary conditions for all cases.\n- The numerical update must use the correct upwind direction determined by the sign of $a$.\n- The exact solution evaluation must use the modulo operation to wrap into $[0,L)$.\n- The final print must be a single line containing the four $L^{2}$-errors as described, with no additional output.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[e_{1},e_{2},e_{3},e_{4}]$), where each $e_{k}$ is a floating-point number rounded to eight decimals as specified above.", "solution": "We begin from the integral conservation statement for the linear advection equation $u_{t} + a\\,u_{x} = 0$, which can be written as $u_{t} + (f(u))_{x} = 0$ with $f(u) = a\\,u$ and constant $a \\in \\mathbb{R}$. Consider a uniform partition of the domain $[0,L)$ into $N$ cells $I_{i} = [x_{i-1/2}, x_{i+1/2})$ of equal length $\\Delta x = L/N$, with cell centers $x_{i} = (i + 1/2)\\Delta x$ for $i \\in \\{0,\\dots,N-1\\}$. Define the cell average $u_{i}(t) = \\frac{1}{\\Delta x}\\int_{I_{i}} u(x,t)\\,dx$. Integrating $u_{t} + (f(u))_{x} = 0$ over $I_{i}$ and applying the divergence theorem yields\n$$\n\\frac{d}{dt} u_{i}(t) + \\frac{1}{\\Delta x}\\left( f\\!\\left(u(x_{i+1/2}^{-},t)\\right) - f\\!\\left(u(x_{i-1/2}^{+},t)\\right)\\right) = 0,\n$$\nwhere $u(x_{i+1/2}^{-},t)$ and $u(x_{i-1/2}^{+},t)$ denote the traces at the interfaces. In a finite volume method with piecewise constant reconstruction, the interface states are obtained by solving a local Riemann problem at each interface. For linear advection $u_{t} + a\\,u_{x} = 0$, characteristics move with speed $a$. The physically admissible solution at $x_{i+1/2}$ uses upstream information: if $a > 0$, the left state $u_{i}$ convects into $I_{i+1}$, while if $a  0$, the right state $u_{i+1}$ convects into $I_{i}$. Therefore, a consistent and monotone numerical flux $F_{i+1/2}$ at the interface is obtained by the upwind (Godunov) flux:\n$$\nF_{i+1/2} =\n\\begin{cases}\na\\,u_{i},  a \\ge 0, \\\\\na\\,u_{i+1},  a  0.\n\\end{cases}\n$$\nThe semi-discrete conservative scheme is then\n$$\n\\frac{d}{dt} u_{i}(t) = -\\frac{1}{\\Delta x}\\left(F_{i+1/2}(t) - F_{i-1/2}(t)\\right).\n$$\nDiscretizing in time with forward Euler over a time step $\\Delta t$ gives\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right).\n$$\nUsing the upwind flux for constant $a$, this reduces to explicit updates. For $a > 0$,\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i}^{n} - u_{i-1}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x},\n$$\nand for $a  0$,\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\nu\\,(u_{i+1}^{n} - u_{i}^{n}), \\quad \\nu = \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\nThese formulas are conservative and monotone under an appropriate stability condition. Because forward Euler applied to a spatially monotone flux-difference operator must preserve convex combinations, stability and monotonicity require that the update coefficients be nonnegative and sum to one. For $a > 0$, the update $u_{i}^{n+1} = (1-\\nu)\\,u_{i}^{n} + \\nu\\,u_{i-1}^{n}$ is a convex combination if and only if $0 \\le \\nu \\le 1$. For $a  0$, writing $u_{i}^{n+1} = (1+ \\nu)\\,u_{i}^{n} - \\nu\\,u_{i+1}^{n} = (1-|\\nu|)\\,u_{i}^{n} + |\\nu|\\,u_{i+1}^{n}$ shows convexity if and only if $0 \\le |\\nu| \\le 1$. Thus, the Courant–Friedrichs–Lewy (CFL) condition for stability and monotonicity is\n$$\n|\\nu| = \\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 1.\n$$\nThis bound is tight for linear advection with the upwind flux and forward Euler. Under this condition, the method is total variation diminishing (TVD) and $L^{1}$-stable.\n\nThe exact solution of the initial value problem on the periodic interval $[0,L)$ with period $L$ is given by translation along characteristics:\n$$\nu(x,t) = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x - a\\,t,\\,L\\right)\\right),\n$$\nwhere $\\operatorname{mod}(y,L)$ maps $y$ to its representative in $[0,L)$. On a uniform grid, the exact solution at grid points $x_{i}$ can be obtained by evaluating $u_{0}$ at the shifted positions with periodic wrap-around.\n\nAlgorithmic design for implementation:\n- Choose $N$ and define $\\Delta x = L/N$ and $x_{i} = (i+1/2)\\Delta x$ for $i \\in \\{0,\\dots,N-1\\}$.\n- Initialize $u^{0}_{i} = u_{0}(x_{i})$.\n- Set a nominal time step $\\Delta t_{\\text{nom}} = \\text{CFL}\\,\\Delta x/|a|$ if $a \\ne 0$. Determine the number of full steps $n_{\\text{full}} = \\left\\lfloor t_{f}/\\Delta t_{\\text{nom}}\\right\\rfloor$. March for $n_{\\text{full}}$ steps with $\\Delta t = \\Delta t_{\\text{nom}}$, and, if $t_{f}$ is not an integer multiple of $\\Delta t_{\\text{nom}}$, take one last step with $\\Delta t_{\\text{last}} = t_{f} - n_{\\text{full}}\\Delta t_{\\text{nom}}$. For each step, compute $\\nu = a\\,\\Delta t/\\Delta x$ and apply the upwind update with periodic indices ($u_{-1} \\equiv u_{N-1}$ and $u_{N} \\equiv u_{0}$).\n- Compute the exact solution array $u^{\\text{exact}}_{i} = u_{0}\\!\\left(\\operatorname{mod}\\!\\left(x_{i} - a\\,t_{f},\\,L\\right)\\right)$.\n- Compute the discrete $L^{2}$-error $E = \\left(\\Delta x \\sum_{i=0}^{N-1} (u^{n_{\\text{final}}}_{i} - u^{\\text{exact}}_{i})^{2}\\right)^{1/2}$.\n- Repeat for each test case.\n\nDiscussion of truncation error and numerical diffusion: A modified equation analysis shows that the first-order upwind method for linear advection approximates\n$$\nu_{t} + a\\,u_{x} = \\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)\\,u_{xx} + \\mathcal{O}(\\Delta x^{2}, \\Delta t^{2}),\n$$\nrevealing a leading-order artificial diffusion term of magnitude $\\frac{1}{2}|a|\\,\\Delta x\\,(1 - |\\nu|)$, which vanishes at the edge case $|\\nu|=1$. This is consistent with the special case where, for $a0$ and $\\nu=1$, the scheme reduces to a pure shift $u_{i}^{n+1} = u_{i-1}^{n}$, yielding an exact discrete translation on the grid and exact periodicity after a full domain traversal when $t_{f} = L/a$.\n\nThe implementation uses the periodic boundary condition by indexing with modulo $N$ or by vectorized circular shifts. The exact solution and all initial conditions are evaluated using radians for trigonometric functions. The program constructs and runs the specified four cases:\n- Case $1$: $N=400$, $a=1.0$, $L=1.0$, $\\text{CFL}=0.5$, $t_{f}=0.3$, $u_{0}(x)=\\sin(2\\pi x)$.\n- Case $2$: $N=600$, $a=-0.8$, $L=1.0$, $\\text{CFL}=0.9$, $t_{f}=0.25$, $u_{0}(x)=1$ on $[0.25,0.75)$ and $0$ otherwise (periodic).\n- Case $3$: $N=500$, $a=1.0$, $L=1.0$, $\\text{CFL}=1.0$, $t_{f}=1.0$, $u_{0}(x)=\\exp(-100\\,(x-0.3)^{2})$.\n- Case $4$: $N=512$, $a=0.5$, $L=1.0$, $\\text{CFL}=0.99$, $t_{f}=0.2$, $u_{0}(x)=\\cos(4\\pi x) + 0.5\\,\\sin(2\\pi x)$.\n\nFinally, the program prints a single line $[e_{1},e_{2},e_{3},e_{4}]$ with each $e_{k}$ rounded to eight decimals, as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef initial_condition(x, kind):\n    # x in [0, L)\n    if kind == \"sine\":\n        return np.sin(2.0 * np.pi * x)\n    elif kind == \"square\":\n        # 1 on [0.25,0.75), 0 otherwise, periodic\n        return np.where((x >= 0.25)  (x  0.75), 1.0, 0.0)\n    elif kind == \"gaussian\":\n        return np.exp(-100.0 * (x - 0.3) ** 2)\n    elif kind == \"mix\":\n        return np.cos(4.0 * np.pi * x) + 0.5 * np.sin(2.0 * np.pi * x)\n    else:\n        raise ValueError(\"Unknown initial condition kind\")\n\ndef exact_solution(x, a, L, t, kind):\n    # periodic wrap of x - a t into [0, L)\n    y = (x - a * t) % L\n    return initial_condition(y, kind)\n\ndef upwind_step(u, a, dt, dx):\n    # Periodic first-order upwind update for constant a\n    nu = a * dt / dx\n    if a > 0:\n        # u_i^{n+1} = u_i^n - nu (u_i^n - u_{i-1}^n)\n        u_im1 = np.roll(u, 1)\n        return u - nu * (u - u_im1)\n    elif a  0:\n        # u_i^{n+1} = u_i^n - nu (u_{i+1}^n - u_i^n); note nu0\n        u_ip1 = np.roll(u, -1)\n        return u - nu * (u_ip1 - u)\n    else:\n        # a == 0, no evolution\n        return u.copy()\n\ndef run_case(N, a, L, CFL, tf, kind):\n    # Build grid\n    dx = L / N\n    # cell centers in [0, L)\n    x = (np.arange(N) + 0.5) * dx\n    # initial condition\n    u = initial_condition(x % L, kind)\n    # if a==0, solution is constant in time\n    if a == 0.0:\n        u_num = u.copy()\n        u_ex = exact_solution(x, a, L, tf, kind)\n        err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n        return err\n    # nominal dt from CFL\n    dt_nom = CFL * dx / abs(a)\n    if dt_nom = 0:\n        raise ValueError(\"Non-positive time step\")\n    n_full = int(np.floor(tf / dt_nom + 1e-15))\n    t = 0.0\n    # march full steps\n    for _ in range(n_full):\n        u = upwind_step(u, a, dt_nom, dx)\n        t += dt_nom\n    # last partial step if needed\n    rem = tf - t\n    if rem > 1e-15:\n        # ensure stability: |a|*rem/dx = CFL (should be = CFL by construction)\n        u = upwind_step(u, a, rem, dx)\n        t += rem\n    # numerical solution at tf\n    u_num = u\n    # exact solution\n    u_ex = exact_solution(x, a, L, tf, kind)\n    # L2 error\n    err = np.sqrt(dx * np.sum((u_num - u_ex) ** 2))\n    return err\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N, a, L, CFL, tf, kind)\n    test_cases = [\n        (400, 1.0, 1.0, 0.5, 0.3, \"sine\"),\n        (600, -0.8, 1.0, 0.9, 0.25, \"square\"),\n        (500, 1.0, 1.0, 1.0, 1.0, \"gaussian\"),\n        (512, 0.5, 1.0, 0.99, 0.2, \"mix\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, L, CFL, tf, kind = case\n        err = run_case(N, a, L, CFL, tf, kind)\n        # Round to exactly 8 decimals\n        results.append(f\"{err:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3394603"}, {"introduction": "Having implemented a solver, it is crucial to understand its limitations, particularly its inherent numerical errors. This practice guides you through the derivation of the modified equation, a powerful analytical tool that reveals the artificial diffusion and dispersion introduced by the discretization [@problem_id:3394635]. By comparing the first-order upwind scheme to the classic Lax-Friedrichs scheme, you will develop a deeper appreciation for why different numerical methods exhibit varying levels of accuracy and dissipative behavior.", "problem": "Consider the linear advection partial differential equation (PDE) $u_t + a\\,u_x = 0$ with constant advection speed $a \\in \\mathbb{R}$ on a uniform spatial grid of spacing $\\Delta x  0$ and explicit time stepping with time step $\\Delta t  0$. Let $r := a\\,\\Delta t/\\Delta x$ denote the Courant–Friedrichs–Lewy (CFL) number. Define the first-order upwind scheme by the flux-splitting form\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; r^+\\,(u_j^n - u_{j-1}^n) \\;-\\; r^-\\,(u_{j+1}^n - u_j^n),\n$$\nwhere $r^+ := \\max(r,0)$ and $r^- := \\min(r,0)$, and define the Lax–Friedrichs (LF) scheme by\n$$\nu_j^{n+1} \\;=\\; \\tfrac{1}{2}\\Big(u_{j+1}^n + u_{j-1}^n\\Big) \\;-\\; \\tfrac{r}{2}\\Big(u_{j+1}^n - u_{j-1}^n\\Big).\n$$\nUsing Taylor expansions in space and time consistent with the governing PDE, derive the leading-order modified equation for each scheme, retaining the lowest-order dissipative and dispersive terms that arise from truncation. Based on your derivations, identify the regimes of the CFL number $r$ in which the two schemes have equivalent leading-order modified equations and the regimes in which their leading dissipation differs, together with the relative strength. Select the single correct statement from the following options.\n\nA. For any $|r|\\le 1$, both modified equations share a leading third-derivative dispersive term proportional to $u_{xxx}$ whose coefficient depends on $r$ and vanishes at $|r|=1$; for $0|r|1$, Lax–Friedrichs has strictly stronger leading diffusion than upwind.\n\nB. For all $|r|\\le 1$, upwind has strictly stronger leading diffusion than Lax–Friedrichs; they are equivalent only at $|r|=0$.\n\nC. At $|r|=1$, the modified equation of Lax–Friedrichs retains a nonzero diffusion term while upwind’s diffusion vanishes; therefore they cannot be equivalent at $|r|=1$.\n\nD. For $|r|1$, both schemes remain stable and Lax–Friedrichs becomes less diffusive than upwind.\n\nE. The leading artificial viscosity coefficients satisfy $\\nu_{\\mathrm{UW}} = \\tfrac{|a|\\Delta x}{2}\\,(1 - |r|)$ and $\\nu_{\\mathrm{LF}} = \\tfrac{\\Delta x^2}{2\\Delta t}\\,(1 - r^2)$, implying equality only at $|r|=1$ and strict inequality $\\nu_{\\mathrm{LF}}\\nu_{\\mathrm{UW}}$ for $0|r|1$.", "solution": "The goal is to derive the modified equations for the first-order upwind (UW) and Lax-Friedrichs (LF) schemes and compare their leading-order error terms. We use Taylor series expansions of the schemes around a point $(x_j, t_n)$.\n\n**1. First-Order Upwind (UW) Scheme**\nThe scheme's update equation, $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = -\\frac{a^+}{\\Delta x}(u_j^n - u_{j-1}^n) - \\frac{a^-}{\\Delta x}(u_{j+1}^n - u_j^n)$, is expanded using Taylor series for $u_j^{n+1}$, $u_{j-1}^n$, and $u_{j+1}^n$. This yields the following modified partial differential equation that the scheme actually solves:\n$$\nu_t + a u_x = D u_{xx} + \\dots\n$$\nThe leading-order term on the right-hand side is the artificial diffusion (or viscosity) term. A case-by-case analysis for $a>0$ and $a0$ shows that the artificial viscosity coefficient $\\nu_{\\mathrm{UW}}$ can be written in a general form using the absolute value of the CFL number $r$:\n$$\n\\nu_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2}(1-|r|)\n$$\nThis shows the scheme is first-order accurate, and the diffusion is non-negative (dissipative) under the stability condition $|r| \\le 1$.\n\n**2. Lax-Friedrichs (LF) Scheme**\nWe perform a similar Taylor series expansion for the Lax-Friedrichs scheme:\n$$\nu_j^{n+1} \\;=\\; \\tfrac{1}{2}\\Big(u_{j+1}^n + u_{j-1}^n\\Big) \\;-\\; \\tfrac{r}{2}\\Big(u_{j+1}^n - u_{j-1}^n\\Big)\n$$\nDividing by $\\Delta t$ and expanding all terms around $(x_j, t_n)$ leads to the modified equation. The resulting artificial viscosity coefficient is found to be:\n$$\n\\nu_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t} - \\frac{a^2\\Delta t}{2} = \\frac{\\Delta x^2}{2\\Delta t}\\left(1 - \\frac{a^2\\Delta t^2}{\\Delta x^2}\\right) = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)\n$$\n\n**3. Comparison and Evaluation of Options**\nWe have the two artificial viscosity coefficients:\n$$\n\\nu_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2}(1-|r|)\n$$\n$$\n\\nu_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)\n$$\nThese formulas perfectly match those given in option E. Now we check the two claims in option E.\n\n- **Equality Condition**: We check when $\\nu_{\\mathrm{UW}} = \\nu_{\\mathrm{LF}}$ for $|r| \\le 1$.\nAt $|r|=1$, both coefficients are zero: $\\nu_{\\mathrm{UW}} = \\frac{|a|\\Delta x}{2}(1-1) = 0$ and $\\nu_{\\mathrm{LF}} = \\frac{\\Delta x^2}{2\\Delta t}(1-1^2) = 0$. So they are equal.\nFor $0 \\le |r|  1$, we set them equal:\n$$\n\\frac{|a|\\Delta x}{2}(1-|r|) = \\frac{\\Delta x^2}{2\\Delta t}(1-r^2)\n$$\nUsing the relation $|r| = |a|\\Delta t/\\Delta x \\implies |a| = |r|\\Delta x/\\Delta t$, we can rewrite the equation and simplify. Since $1-|r| \\neq 0$ for this range, we can divide by it:\n$$\n\\frac{|a|\\Delta x}{2} = \\frac{\\Delta x^2}{2\\Delta t}(1+|r|) \\implies |a|\\Delta t = \\Delta x(1+|r|) \\implies |r|\\Delta x = \\Delta x(1+|r|)\n$$\nThis gives $|r| = 1+|r|$, which implies $1=0$, a contradiction. Thus, equality holds only at $|r|=1$.\n\n- **Inequality Condition**: For $0  |r|  1$, we compare the two coefficients. It is convenient to look at their ratio:\n$$\n\\frac{\\nu_{\\mathrm{LF}}}{\\nu_{\\mathrm{UW}}} = \\frac{\\frac{\\Delta x^2}{2\\Delta t}(1-r^2)}{\\frac{|a|\\Delta x}{2}(1-|r|)} = \\frac{\\frac{|a|\\Delta x}{2|r|}(1-|r|)(1+|r|)}{\\frac{|a|\\Delta x}{2}(1-|r|)} = \\frac{1+|r|}{|r|} = 1+\\frac{1}{|r|}\n$$\nSince $0|r|1$, we have $1/|r| > 1$, which implies the ratio is strictly greater than 2. Thus, $\\nu_{\\mathrm{LF}} > \\nu_{\\mathrm{UW}}$ for $0|r|1$. The Lax-Friedrichs scheme is strictly more diffusive than the upwind scheme in this range.\n\nAll parts of statement E are correct. The other options are incorrect:\nA: The dispersive terms are not equivalent, and LF is more, not less, diffusive.\nB: The inequality is reversed.\nC: The LF diffusion also vanishes at $|r|=1$.\nD: Both schemes are unstable for $|r|>1$.", "answer": "$$\\boxed{E}$$", "id": "3394635"}, {"introduction": "Beyond basic implementation and error analysis lies the art of scheme optimization. This advanced exercise challenges you to improve the accuracy of the upwind method by coupling it with a higher-order time integrator and then fine-tuning the Courant number [@problem_id:3394621]. By minimizing the leading-order phase error under a strict monotonicity constraint, you will engage in the kind of trade-off analysis that is central to the design of high-performance numerical methods.", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a0$, posed on a uniform grid $x_{j} = j\\,\\Delta x$ with time step $\\Delta t$ and Courant number $\\lambda = a\\,\\Delta t/\\Delta x$. Use the first-order upwind spatial discretization for $a0$, which in semi-discrete form reads $u_{j}'(t) = -\\frac{a}{\\Delta x}\\left(u_{j}(t) - u_{j-1}(t)\\right)$, and couple it in time with the two-stage explicit trapezoidal method (Heun’s method): $u^{(1)} = u^{n} + \\Delta t\\,L\\,u^{n}$, $u^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\left(L\\,u^{n} + L\\,u^{(1)}\\right)$, where $L$ denotes the semi-discrete spatial operator. Assume a smooth initial wave $u(x,0) = \\sin(\\kappa x)$ and analyze the one-step behavior of a single discrete Fourier mode with wavenumber $\\theta = \\kappa\\,\\Delta x$. Starting from the definitions of the spatial symbol and the Runge–Kutta stability function, derive the one-step amplification factor $G(\\theta,\\lambda)$, define the numerical phase $\\varphi_{\\mathrm{num}}(\\theta,\\lambda) = \\arg\\left(G(\\theta,\\lambda)\\right)$, and compare it to the exact continuous phase shift per time step $\\varphi_{\\mathrm{exact}}(\\theta,\\lambda) = -\\lambda\\,\\theta$. Under the assumption of a smooth wave so that $\\theta$ is small, systematically expand $\\varphi_{\\mathrm{num}}(\\theta,\\lambda)$ to leading nonzero order in $\\theta$ and obtain the leading-order phase error as an explicit function of $\\lambda$. Impose discrete monotonicity of the fully discrete scheme by requiring that the update weights on $u_{j}^{n}$, $u_{j-1}^{n}$, $u_{j-2}^{n}$ are nonnegative and sum to one, and deduce the admissible interval for $\\lambda$. Within this admissible interval and excluding the trivial choice $\\lambda=0$, determine the value of $\\lambda$ that minimizes the magnitude of the leading-order phase error, and report that single optimal $\\lambda$ as your final answer. No rounding is required for the final answer, which is dimensionless.", "solution": "The goal is to find the Courant number $\\lambda \\in (0,1]$ that minimizes the leading-order phase error for the first-order upwind spatial discretization combined with Heun's method for time integration, under a monotonicity constraint.\n\n**1. Amplification Factor**\nThe semi-discrete upwind operator $L u_j = -\\frac{a}{\\Delta x}(u_j - u_{j-1})$ has the Fourier symbol $\\hat{L}(\\theta) = -\\frac{a}{\\Delta x}(1 - e^{-i\\theta})$. Let $z = \\Delta t \\hat{L}(\\theta) = -\\lambda(1 - e^{-i\\theta})$.\nHeun's method is a second-order Runge-Kutta method with stability function $R(z) = 1 + z + \\frac{1}{2}z^2$.\nThe amplification factor of the fully discrete scheme is $G(\\theta, \\lambda) = R(z) = 1 - \\lambda(1 - e^{-i\\theta}) + \\frac{1}{2}\\lambda^2(1 - e^{-i\\theta})^2$.\n\n**2. Leading-Order Phase Error**\nWe expand $G(\\theta, \\lambda)$ for small wavenumber $\\theta = \\kappa \\Delta x$.\n$1 - e^{-i\\theta} = i\\theta + \\frac{1}{2}\\theta^2 - \\frac{i}{6}\\theta^3 + O(\\theta^4)$.\n$z = -\\lambda(i\\theta + \\frac{1}{2}\\theta^2 - \\frac{i}{6}\\theta^3 + O(\\theta^4))$.\n$z^2 = \\lambda^2(i\\theta + \\frac{1}{2}\\theta^2 + \\dots)^2 = \\lambda^2(-\\theta^2 + i\\theta^3 + O(\\theta^4))$.\nSubstituting these into $G = 1 + z + \\frac{1}{2}z^2$:\n$$G = 1 - \\lambda\\left(i\\theta + \\frac{1}{2}\\theta^2 - \\frac{i}{6}\\theta^3\\right) + \\frac{1}{2}\\lambda^2(-\\theta^2 + i\\theta^3) + O(\\theta^4)$$\n$$G = \\left(1 - \\frac{\\lambda(1+\\lambda)}{2}\\theta^2\\right) + i\\left(-\\lambda\\theta + \\frac{\\lambda(1+3\\lambda)}{6}\\theta^3\\right) + O(\\theta^4)$$\nThe numerical phase is $\\varphi_{\\mathrm{num}} = \\arg(G)$. For small $\\theta$, $\\varphi_{\\mathrm{num}} \\approx \\arctan(\\frac{\\text{Im}(G)}{\\text{Re}(G)})$. Expanding the arctangent, we find the phase error relative to the exact phase $\\varphi_{\\mathrm{exact}} = -ak\\Delta t = -\\lambda\\theta$:\n$$\\varphi_{\\mathrm{num}} - \\varphi_{\\mathrm{exact}} = \\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 + O(\\theta^5)$$\nThe leading-order phase error is thus proportional to $\\lambda(1-\\lambda^2)$.\n\n**3. Monotonicity Constraint**\nWe write the explicit update stencil. The scheme is $u_j^{n+1} = u_j^n + \\frac{\\Delta t}{2}(Lu_j^n + L u_j^{(1)})$, where $u^{(1)} = u^n + \\Delta t L u^n$.\nSubstituting the operators yields the stencil:\n$$u_j^{n+1} = \\left(1-\\lambda+\\frac{\\lambda^2}{2}\\right)u_j^n + \\left(\\lambda-\\lambda^2\\right)u_{j-1}^n + \\frac{\\lambda^2}{2}u_{j-2}^n$$\nFor the scheme to be monotone, all coefficients must be non-negative.\n1.  $\\frac{\\lambda^2}{2} \\ge 0$: True for all real $\\lambda$.\n2.  $\\lambda-\\lambda^2 = \\lambda(1-\\lambda) \\ge 0$: Since $a, \\Delta t, \\Delta x > 0$, we have $\\lambda>0$. This implies $1-\\lambda \\ge 0$, so $0  \\lambda \\le 1$.\n3.  $1-\\lambda+\\frac{\\lambda^2}{2} \\ge 0$: The quadratic has discriminant $\\Delta = (-1)^2 - 4(\\frac{1}{2})(1) = -1  0$, so it is always positive.\nThe sum of the coefficients is 1. The monotonicity constraint requires $\\lambda \\in [0,1]$.\n\n**4. Optimization**\nWe must minimize the magnitude of the leading-order phase error coefficient, $E(\\lambda) = |\\frac{\\lambda(1-\\lambda^2)}{6}|$, for $\\lambda \\in (0, 1]$.\nOn this interval, $\\lambda > 0$ and $1-\\lambda^2 \\ge 0$, so we can drop the absolute value and minimize $f(\\lambda) = \\lambda(1-\\lambda^2) = \\lambda-\\lambda^3$.\nThe derivative is $f'(\\lambda) = 1-3\\lambda^2$. Setting to zero gives the critical point $\\lambda = 1/\\sqrt{3}$, which is a local maximum in the interval.\nThe minimum of the function on the closed interval $[0,1]$ must occur at the boundaries.\n$f(0) = 0$.\n$f(1) = 1-1^3 = 0$.\nThe minimum value of the phase error magnitude on $(0, 1]$ is 0, which is achieved at the endpoint $\\lambda=1$.\nThus, the optimal Courant number is 1.", "answer": "$$\\boxed{1}$$", "id": "3394621"}]}