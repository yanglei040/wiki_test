{"hands_on_practices": [{"introduction": "The first step to understanding numerical error is to quantify how a finite difference scheme approximates the derivative of a single plane wave. This exercise introduces the concept of the effective wavenumber, $k^{\\ast}(k)$, which represents the wavenumber as 'seen' by the discrete grid. Deriving the expression for $k^{\\ast}(k)$ allows you to decompose numerical errors into their fundamental dispersive (phase) and dissipative (amplitude) components directly from the operator's definition [@problem_id:3425558].", "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant velocity $a0$. Let a uniform grid be defined by $x_{j} = j \\Delta x$ with grid spacing $\\Delta x0$ and grid index $j \\in \\mathbb{Z}$. Define two spatial discretizations for the first derivative $u_{x}$:\n- A second-order central-difference stencil $D_{\\mathrm{c}} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$.\n- A first-order upwind stencil (appropriate for $a0$) $D_{\\mathrm{u}} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$.\n\nFor a discrete plane wave $u_{j} = \\hat{u}\\,\\exp(i k x_{j})$ with physical wavenumber $k \\in \\mathbb{R}$ and constant amplitude $\\hat{u} \\in \\mathbb{C}$, define the effective wavenumber mapping $k^{\\ast}(k)$ through the discrete Fourier symbol relation $D u_{j} = i\\,k^{\\ast}(k)\\,u_{j}$, where $D$ denotes either $D_{\\mathrm{c}}$ or $D_{\\mathrm{u}}$. Using the Discrete Fourier Transform (DFT) viewpoint and the above definition of $k^{\\ast}(k)$, do the following:\n1. Derive the exact analytic expression for $k^{\\ast}(k)$ for $D_{\\mathrm{c}}$ and for $D_{\\mathrm{u}}$.\n2. Derive the deviation function $\\Delta(k) = \\frac{k^{\\ast}(k)}{k} - 1$ for $D_{\\mathrm{c}}$ and for $D_{\\mathrm{u}}$.\n3. Based on your expressions, briefly explain how features such as plateaus (regions where $\\frac{d k^{\\ast}}{d k} \\approx 0$ over an interval of $k$) and inflection points in $k^{\\ast}(k)$ are associated with numerical anisotropy when these one-dimensional stencils are applied dimension-by-dimension on a two-dimensional tensor-product grid to approximate directional derivatives.\n\nExpress your final answer symbolically in terms of $k$ and $\\Delta x$, and present it as a single row matrix with the four entries $k^{\\ast}_{\\mathrm{c}}(k)$, $k^{\\ast}_{\\mathrm{u}}(k)$, $\\Delta_{\\mathrm{c}}(k)$, and $\\Delta_{\\mathrm{u}}(k)$, in that order. No rounding is required; give exact closed-form expressions.", "solution": "The solution proceeds in three parts as requested by the problem statement. We analyze the discrete Fourier symbols of the given difference operators to determine the effective wavenumber $k^{\\ast}(k)$ and the deviation function $\\Delta(k)$.\n\n**1. Derivation of Effective Wavenumbers $k^{\\ast}_{\\mathrm{c}}(k)$ and $k^{\\ast}_{\\mathrm{u}}(k)$**\n\nThe effective wavenumber $k^{\\ast}(k)$ is defined by the relation $D u_{j} = i\\,k^{\\ast}(k)\\,u_{j}$ for a discrete plane wave $u_{j} = \\hat{u}\\,\\exp(i k x_{j})$. Substituting $x_j = j\\Delta x$, we have $u_j = \\hat{u}\\,\\exp(i k j \\Delta x)$. We apply each difference operator $D$ to this plane wave and solve for $k^{\\ast}(k)$.\n\n**Central-Difference Scheme ($D_{\\mathrm{c}}$):**\nThe second-order central-difference operator is $D_{\\mathrm{c}} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$. Applying this to the plane wave yields:\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{\\hat{u}\\,\\exp(i k (j+1) \\Delta x) - \\hat{u}\\,\\exp(i k (j-1) \\Delta x)}{2 \\Delta x}\n$$\nWe factor out the term $\\hat{u}\\,\\exp(i k j \\Delta x)$, which is equal to $u_j$:\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{u_j}{2\\Delta x} \\left( \\exp(i k \\Delta x) - \\exp(-i k \\Delta x) \\right)\n$$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, we can rewrite the expression in the parenthesis as $2i\\sin(k\\Delta x)$:\n$$\nD_{\\mathrm{c}} u_{j} = \\frac{u_j}{2\\Delta x} \\left( 2i\\sin(k\\Delta x) \\right) = i \\frac{\\sin(k\\Delta x)}{\\Delta x} u_j\n$$\nComparing this result with the definition $D_{\\mathrm{c}} u_{j} = i k^{\\ast}_{\\mathrm{c}}(k) u_{j}$, we can directly identify the expression for the effective wavenumber for the central scheme:\n$$\nk^{\\ast}_{\\mathrm{c}}(k) = \\frac{\\sin(k\\Delta x)}{\\Delta x}\n$$\nThis effective wavenumber is purely real, which indicates that the second-order central difference scheme is non-dissipative; it only introduces phase (dispersion) errors.\n\n**Upwind Scheme ($D_{\\mathrm{u}}$):**\nThe first-order upwind operator (for $a0$) is $D_{\\mathrm{u}} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$. Applying this to the plane wave:\n$$\nD_{\\mathrm{u}} u_{j} = \\frac{\\hat{u}\\,\\exp(i k j \\Delta x) - \\hat{u}\\,\\exp(i k (j-1) \\Delta x)}{\\Delta x}\n$$\nAgain, we factor out $u_j = \\hat{u}\\,\\exp(i k j \\Delta x)$:\n$$\nD_{\\mathrm{u}} u_{j} = \\frac{u_j}{\\Delta x} \\left( 1 - \\exp(-i k \\Delta x) \\right)\n$$\nFrom the definition $D_{\\mathrm{u}} u_{j} = i k^{\\ast}_{\\mathrm{u}}(k) u_{j}$, we find that $i k^{\\ast}_{\\mathrm{u}}(k)$ is the Fourier symbol of the operator:\n$$\ni k^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - \\exp(-i k \\Delta x)}{\\Delta x}\n$$\nSolving for $k^{\\ast}_{\\mathrm{u}}(k)$:\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - \\exp(-i k \\Delta x)}{i\\Delta x}\n$$\nTo express this in terms of real and imaginary parts, we use Euler's identity $\\exp(-ik\\Delta x) = \\cos(k\\Delta x) - i\\sin(k\\Delta x)$:\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{1 - (\\cos(k\\Delta x) - i\\sin(k\\Delta x))}{i\\Delta x} = \\frac{1 - \\cos(k\\Delta x) + i\\sin(k\\Delta x)}{i\\Delta x}\n$$\nMultiplying the numerator and denominator by $-i$ (since $1/i = -i$) gives:\n$$\nk^{\\ast}_{\\mathrm{u}}(k) = \\frac{-i(1-\\cos(k\\Delta x)) -i^2\\sin(k\\Delta x)}{-i^2\\Delta x} = \\frac{\\sin(k\\Delta x) - i(1-\\cos(k\\Delta x))}{\\Delta x}\n$$\nThis effective wavenumber is complex. Its real part, $\\mathrm{Re}[k^{\\ast}_{\\mathrm{u}}(k)] = \\frac{\\sin(k\\Delta x)}{\\Delta x}$, governs the numerical dispersion (phase error). Its imaginary part, $\\mathrm{Im}[k^{\\ast}_{\\mathrm{u}}(k)] = -\\frac{1-\\cos(k\\Delta x)}{\\Delta x}$, governs the numerical dissipation (amplitude error).\n\n**2. Derivation of the Deviation Functions $\\Delta_{\\mathrm{c}}(k)$ and $\\Delta_{\\mathrm{u}}(k)$**\n\nThe deviation function is defined as $\\Delta(k) = \\frac{k^{\\ast}(k)}{k} - 1$. It quantifies the relative error of the effective wavenumber compared to the exact wavenumber.\n\n**Central-Difference Scheme ($\\Delta_{\\mathrm{c}}$):**\n$$\n\\Delta_{\\mathrm{c}}(k) = \\frac{k^{\\ast}_{\\mathrm{c}}(k)}{k} - 1 = \\frac{\\sin(k\\Delta x)/\\Delta x}{k} - 1 = \\frac{\\sin(k\\Delta x)}{k\\Delta x} - 1\n$$\n\n**Upwind Scheme ($\\Delta_{\\mathrm{u}}$):**\n$$\n\\Delta_{\\mathrm{u}}(k) = \\frac{k^{\\ast}_{\\mathrm{u}}(k)}{k} - 1 = \\frac{(\\sin(k\\Delta x) - i(1 - \\cos(k\\Delta x)))/\\Delta x}{k} - 1 = \\frac{\\sin(k\\Delta x) - i(1 - \\cos(k\\Delta x))}{k\\Delta x} - 1\n$$\n\n**3. Connection between $k^{\\ast}(k)$ Features and 2D Numerical Anisotropy**\n\nNumerical anisotropy arises when the error of a numerical scheme depends on the direction of wave propagation relative to the computational grid. When 1D stencils are applied dimension-by-dimension on a 2D tensor-product grid, the effective wavenumber becomes a vector $\\mathbf{k}^{\\ast} = (k^{\\ast}(k_x), k^{\\ast}(k_y))$, where $k_x$ and $k_y$ are the components of the physical wavenumber vector $\\mathbf{k}$.\n\nThe exact dispersion relation for the advection equation is linear, e.g., $\\omega = \\mathbf{a} \\cdot \\mathbf{k}$. The numerical dispersion relation, $\\omega_{\\mathrm{num}} = \\mathbf{a} \\cdot \\mathbf{k}^{\\ast} = a_x k^{\\ast}(k_x) + a_y k^{\\ast}(k_y)$, is non-linear because $k^{\\ast}(k)$ is a non-linear function of its argument. This non-linearity is the fundamental source of numerical anisotropy, as the error characteristics are not rotationally invariant; they depend on the alignment of $\\mathbf{k}$ with the grid axes.\n\nSpecific features of the 1D $k^{\\ast}(k)$ vs. $k$ curve correspond to severe anisotropic effects:\n\n- **Plateaus:** A plateau in the plot of $\\mathrm{Re}[k^{\\ast}(k)]$ implies that the derivative $\\frac{d}{dk}\\mathrm{Re}[k^{\\ast}(k)]$ is approximately zero. This derivative is proportional to the numerical group velocity. For both the central and upwind schemes, $\\mathrm{Re}[k^{\\ast}(k)] = \\frac{\\sin(k\\Delta x)}{\\Delta x}$, which has a plateau (zero derivative) at $k\\Delta x = \\frac{\\pi}{2}$. For a 2D wave propagating such that one of its wavenumber components (e.g., $k_x$) satisfies $k_x \\Delta x \\approx \\frac{\\pi}{2}$, the corresponding component of the group velocity will vanish. This causes the wave packet to propagate in an incorrect, grid-aligned direction, a classic manifestation of severe numerical anisotropy.\n\n- **Inflection Points and Extrema:** An inflection point in the $k^{\\ast}(k)$ curve corresponds to an extremum in the group velocity. The most pathological point for the dispersive part of both schemes is at the Nyquist wavenumber, $k\\Delta x=\\pi$. At this point, $\\mathrm{Re}[k^{\\ast}(\\pi/\\Delta x)]=0$ and the group velocity is negative, $v_g \\propto \\cos(\\pi)=-1$. This means high-wavenumber components can travel in the wrong direction. In a 2D simulation, if a wave propagates obliquely to the grid, its components $k_x \\Delta x$ and $k_y \\Delta x$ might fall into different regions of the dispersion curve. For instance, one component might be in a region of positive group velocity while another is in a region of negative group velocity, leading to a complete disintegration of the wave structure in a highly direction-dependent manner.\n\nIn summary, the non-linear relationship between $k^{\\ast}$ and $k$ is the cause of anisotropy. Plateaus and inflection points are landmarks on the dispersion curve that signal regions of pathological wave propagation behavior (e.g., zero or negative group velocity), which manifest as extreme directional bias in multiple dimensions.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sin(k\\Delta x)}{\\Delta x}  \\frac{\\sin(k\\Delta x) - i(1 - \\cos(k\\Delta x))}{\\Delta x}  \\frac{\\sin(k\\Delta x)}{k\\Delta x} - 1  \\frac{\\sin(k\\Delta x) - i(1 - \\cos(k\\Delta x))}{k\\Delta x} - 1\n\\end{pmatrix}\n}\n$$", "id": "3425558"}, {"introduction": "We've seen that high-wavenumber components are represented with the largest error. This practice explores what happens in a simulation with sharp features, which are rich in high-wavenumber components, by connecting leading phase errors (where the phase speed ratio $\\rho(\\kappa) \\gt 1$) to the Gibbs-like oscillations that pollute numerical solutions near discontinuities. By comparing a dispersive scheme like Lax-Wendroff with a dissipative one like first-order upwind, you will make the abstract concept of numerical dispersion tangible and visually clear [@problem_id:3425583].", "problem": "Consider the one-dimensional constant-coefficient linear advection equation on a periodic domain,\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\\quad x\\in[0,1),\\ t\\ge 0,\n$$\nwith advection speed $a0$ and periodic boundary conditions. The initial condition is a zero-mean sawtooth wave given by\n$$\nu(x,0) = s(x) := x - \\lfloor x \\rfloor - \\tfrac{1}{2},\n$$\nwhich has a jump of magnitude $1$ at each integer point. You will numerically evolve this initial condition using two fully discrete finite-difference schemes on a uniform grid with $N_x$ points and periodic boundary conditions:\n\n- A second-order central scheme in the form of the classical Lax–Wendroff update,\n$$\nu_j^{n+1} = u_j^n - \\frac{\\nu}{2}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{\\nu^2}{2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right),\n$$\n- A first-order upwind scheme,\n$$\nu_j^{n+1} = u_j^n - \\nu\\left(u_j^n - u_{j-1}^n\\right),\n$$\nwhere $u_j^n$ approximates $u(x_j, t^n)$ at $x_j = j\\,\\Delta x$, $t^n = n\\,\\Delta t$, the Courant–Friedrichs–Lewy (CFL) number is $\\nu = a\\,\\Delta t/\\Delta x$, and indices are taken modulo $N_x$ to enforce periodicity.\n\nYour tasks are as follows.\n\n1. Starting from the Fourier-mode ansatz $u_j^n = \\hat{u}\\,\\exp\\!\\left(i(j\\,\\kappa - n\\,\\omega\\,\\Delta t)\\right)$ with discrete wavenumber $\\kappa \\in [0,\\pi]$, define for each scheme the fully discrete dispersion relation in terms of the amplification factor $G(\\kappa)$ satisfying\n$$\ne^{-i\\,\\omega(\\kappa)\\,\\Delta t} = G(\\kappa).\n$$\nFrom this, define the numerical phase $\\theta(\\kappa)$ as the unwrapped argument $\\theta(\\kappa) = -\\mathrm{Arg}\\,G(\\kappa)$ made continuous in $\\kappa$, and the numerical phase speed ratio\n$$\n\\rho(\\kappa) = \\frac{\\omega(\\kappa)}{a\\,k} = \\frac{\\theta(\\kappa)}{\\nu\\,\\kappa},\n$$\nwhere $k = \\kappa/\\Delta x$ is the physical wavenumber. Explain why $\\rho(\\kappa)1$ for some high $\\kappa$ indicates dispersive overshoot relative to the true phase speed.\n\n2. Evolve the sawtooth initial condition to time $T$ using each scheme with a uniform time step $\\Delta t = \\nu\\,\\Delta x/a$, taking $N_t = \\lfloor T/\\Delta t \\rfloor$ steps. Denote the numerical solution at $t^{N_t}$ by $u_j^{N_t}$. Let the advected discontinuity location be $x_\\star = (a\\,N_t\\,\\Delta t)\\ \\mathrm{mod}\\ 1$. Define a small window of $2m+1$ grid points centered at the index $j_\\star = \\mathrm{round}(x_\\star/\\Delta x)$ with $m=6$. Quantify the Gibbs-like overshoot amplitude by\n$$\n\\mathcal{O} = \\max\\big\\{0,\\, \\max_{|j-j_\\star|\\le m} u_j^{N_t} - \\tfrac{1}{2}\\big\\},\n$$\nthat is, the positive excess above the upper plateau level $\\tfrac{1}{2}$ within the window, clipped at zero if no overshoot occurs. Use no physical units; all quantities are nondimensional.\n\n3. Using the discrete dispersion relation of the Lax–Wendroff scheme, define the near-Nyquist dispersive overshoot predictor as\n$$\n\\Pi = \\max_{\\kappa\\in[\\alpha\\pi,\\pi]} \\max\\{0,\\, \\rho(\\kappa) - 1\\},\n$$\nwith $\\alpha = 0.8$. This isolates the high-wavenumber regime where spurious dispersion is most pronounced.\n\nImplement a program that:\n- Constructs the periodic grid, initializes $u(x,0)=s(x)$, advances each scheme to time $T$, computes the overshoot amplitude $\\mathcal{O}$ for each scheme, and computes the predictor $\\Pi$ for Lax–Wendroff using the unwrapped numerical phase $\\theta(\\kappa)$.\n- Uses the following test suite of parameter triples $(N_x,\\nu,T)$ with $a=1$:\n    - Case A: $(N_x,\\nu,T) = (256,\\,0.2,\\,0.2)$,\n    - Case B: $(N_x,\\nu,T) = (256,\\,0.9,\\,0.2)$,\n    - Case C: $(N_x,\\nu,T) = (64,\\,0.5,\\,0.2)$.\n- For each case, returns the triple of floats\n$$\n\\Big[\\ \\mathcal{O}_{\\mathrm{LW}},\\ \\mathcal{O}_{\\mathrm{UP}},\\ \\Pi_{\\mathrm{LW}}\\ \\Big],\n$$\nwhere $\\mathcal{O}_{\\mathrm{LW}}$ is the measured overshoot for Lax–Wendroff, $\\mathcal{O}_{\\mathrm{UP}}$ is the measured overshoot for upwind, and $\\Pi_{\\mathrm{LW}}$ is the predictor computed from the Lax–Wendroff dispersion relation. Round each reported float to $6$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for Cases A, B, and C concatenated in order as a comma-separated list enclosed in square brackets, that is,\n$$\n[\\mathcal{O}_{\\mathrm{LW}}^{(A)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(A)},\\ \\Pi_{\\mathrm{LW}}^{(A)},\\ \\mathcal{O}_{\\mathrm{LW}}^{(B)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(B)},\\ \\Pi_{\\mathrm{LW}}^{(B)},\\ \\mathcal{O}_{\\mathrm{LW}}^{(C)},\\ \\mathcal{O}_{\\mathrm{UP}}^{(C)},\\ \\Pi_{\\mathrm{LW}}^{(C)}],\n$$\nwith no additional text. Each number must be rounded to $6$ decimal places as specified. This design tests a typical case, a near-stability high-Courant case, and a coarser-grid case to probe the dependence of Gibbs-like oscillations on dispersive overshoot near the Nyquist wavenumber.", "solution": "### Part 1: Dispersion Relation and Phase Speed\n\nWe start by deriving the amplification factor $G(\\kappa)$ for each scheme. We substitute the Fourier mode ansatz $u_j^n = G^n(\\kappa) e^{ij\\kappa}$ into the finite difference schemes.\n\n**Lax-Wendroff Scheme**\nSubstituting the ansatz into the LW scheme gives:\n$$\nG(\\kappa)e^{ij\\kappa} = e^{ij\\kappa} - \\frac{\\nu}{2}\\left(e^{i(j+1)\\kappa} - e^{i(j-1)\\kappa}\\right) + \\frac{\\nu^2}{2}\\left(e^{i(j+1)\\kappa} - 2e^{ij\\kappa} + e^{i(j-1)\\kappa}\\right)\n$$\nDividing by $e^{ij\\kappa}$ and using Euler's identities $e^{i\\kappa}-e^{-i\\kappa} = 2i\\sin\\kappa$ and $e^{i\\kappa}+e^{-i\\kappa} = 2\\cos\\kappa$:\n$$\n\\begin{align*}\nG_{\\mathrm{LW}}(\\kappa) = 1 - \\frac{\\nu}{2}(e^{i\\kappa} - e^{-i\\kappa}) + \\frac{\\nu^2}{2}(e^{i\\kappa} - 2 + e^{-i\\kappa}) \\\\\n= 1 - i\\nu\\sin\\kappa + \\frac{\\nu^2}{2}(2\\cos\\kappa - 2) \\\\\n= 1 - \\nu^2(1 - \\cos\\kappa) - i\\nu\\sin\\kappa\n\\end{align*}\n$$\n\n**Upwind Scheme**\nSimilarly, for the first-order upwind scheme (for $a0$):\n$$\nG(\\kappa)e^{ij\\kappa} = e^{ij\\kappa} - \\nu\\left(e^{ij\\kappa} - e^{i(j-1)\\kappa}\\right)\n$$\nDividing by $e^{ij\\kappa}$:\n$$\n\\begin{align*}\nG_{\\mathrm{UP}}(\\kappa) = 1 - \\nu(1 - e^{-i\\kappa}) \\\\\n= 1 - \\nu + \\nu e^{-i\\kappa} \\\\\n= (1 - \\nu + \\nu\\cos\\kappa) - i\\nu\\sin\\kappa\n\\end{align*}\n$$\n\n**Numerical Phase Speed and Dispersive Overshoot**\nThe numerical dispersion relation is given by $\\omega(\\kappa)$, where $e^{-i\\omega(\\kappa)\\Delta t} = G(\\kappa)$. This implies $\\omega(\\kappa) = i\\ln(G(\\kappa))/\\Delta t$. The numerical phase speed is $v_p(\\kappa) = \\omega(\\kappa)/k$, where $k = \\kappa/\\Delta x$ is the physical wavenumber. The exact dispersion relation for the PDE is $\\omega_{\\mathrm{exact}}(k) = ak$, yielding a constant phase speed of $a$.\n\nThe numerical phase speed ratio $\\rho(\\kappa)$ is the ratio of the numerical phase speed to the exact phase speed:\n$$\n\\rho(\\kappa) = \\frac{v_p(\\kappa)}{a} = \\frac{\\omega(\\kappa)}{ak}\n$$\nFrom the definition $e^{-i\\omega\\Delta t} = G(\\kappa)$ and $\\theta(\\kappa) = -\\mathrm{Arg}(G(\\kappa))$, we have $-i\\omega\\Delta t = \\ln|G(\\kappa)| + i\\mathrm{Arg}(G(\\kappa)) = \\ln|G(\\kappa)| - i\\theta(\\kappa)$. Equating imaginary parts, we get $\\omega\\Delta t = \\theta(\\kappa)$. Substituting this into the expression for $\\rho(\\kappa)$:\n$$\n\\rho(\\kappa) = \\frac{\\theta(\\kappa)/\\Delta t}{a(\\kappa/\\Delta x)} = \\frac{\\theta(\\kappa)}{\\kappa(a\\Delta t/\\Delta x)} = \\frac{\\theta(\\kappa)}{\\nu\\kappa}\n$$\nThis matches the definition given in the problem.\n\nA value of $\\rho(\\kappa)  1$ indicates that the numerical solution component with wavenumber $k$ propagates faster than the true wave speed $a$. This is known as a leading phase error. A discontinuity, such as the jump in the sawtooth initial condition, is composed of a wide spectrum of Fourier modes. If high-wavenumber components (large $k$, corresponding to $\\kappa$ near the Nyquist frequency $\\pi$) travel faster than the lower-wavenumber components that constitute the bulk of the wave, they \"run ahead\" of the main profile. The superposition of these fast-moving, high-frequency modes creates spurious oscillations just ahead of the advected discontinuity. This effect is a form of the Gibbs phenomenon, termed dispersive overshoot. The metric $\\mathcal{O}$ is designed to quantify the amplitude of these leading oscillations.\n\n### Part 2  3: Numerical Implementation\nThe solution requires implementing the time evolution for both schemes and then computing the specified metrics.\n\n1.  **Initialization**: For each test case $(N_x, \\nu, T)$ with $a=1$, we define the grid spacing $\\Delta x = 1/N_x$ and time step $\\Delta t = \\nu \\Delta x/a$. The total number of steps is $N_t = \\lfloor T/\\Delta t \\rfloor$. The initial condition $u(x,0) = x - 1/2$ for $x \\in [0,1)$ is discretized on the grid $x_j=j\\Delta x$ as $u_j^0 = j\\Delta x - 1/2$.\n\n2.  **Time Evolution**: We iterate $N_t$ times. In each step, we update the numerical solutions $u_j$ for both schemes using their respective formulas. Periodicity is handled by taking indices modulo $N_x$, which is efficiently implemented using `numpy.roll`.\n\n3.  **Overshoot Calculation ($\\mathcal{O}$)**: After the final time step $t^{N_t}$, we calculate the exact position of the advected discontinuity, $x_\\star = (a N_t \\Delta t) \\pmod 1$. The nearest grid index is $j_\\star = \\mathrm{round}(x_\\star/\\Delta x)$. We find the maximum value of the numerical solution within the window of $2m+1$ points centered at $j_\\star$. The overshoot is the amount by which this maximum exceeds the upper plateau value of $1/2$, clipped at zero.\n    - The first-order upwind scheme is monotone for $\\nu \\in [0,1]$, meaning it does not create new extrema. Since the initial condition is bounded by $[-0.5, 0.5]$, the numerical solution will also remain in this range. Therefore, we expect $\\mathcal{O}_{\\mathrm{UP}} = 0$ for all test cases.\n\n4.  **Predictor Calculation ($\\Pi_{\\mathrm{LW}}$)**: For the Lax-Wendroff scheme, we compute the phase speed ratio $\\rho(\\kappa)$ over a fine discretization of $\\kappa \\in [0, \\pi]$. It is crucial to use `np.unwrap` on the phase $\\theta(\\kappa) = -\\mathrm{Arg}(G(\\kappa))$ to handle the phase jumps that occur when $G(\\kappa)$ crosses the negative real axis in the complex plane (which happens for $\\nu^2  1/2$). We then find the maximum of $\\rho(\\kappa)-1$ over the high-wavenumber range $[\\alpha\\pi, \\pi]$ and clip at zero.\n\nThe following Python code implements this procedure for the specified test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical advection problem for three test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (256, 0.2, 0.2),  # Case A\n        (256, 0.9, 0.2),  # Case B\n        (64, 0.5, 0.2),   # Case C\n    ]\n\n    # Global parameters\n    a = 1.0  # Advection speed\n    m = 6    # Window half-width for overshoot measurement\n    alpha = 0.8 # Lower bound for predictor wavenumber range\n\n    results = []\n    \n    for Nx, nu, T in test_cases:\n        # 1. Setup Grid, Time Step, and Initial Condition\n        dx = 1.0 / Nx\n        dt = nu * dx / a\n        Nt = int(np.floor(T / dt))\n\n        x = np.arange(Nx) * dx\n        u0 = x - np.floor(x) - 0.5\n\n        u_lw = u0.copy()\n        u_up = u0.copy()\n\n        # 2. Time Evolution Loop\n        for _ in range(Nt):\n            # Lax-Wendroff update\n            u_lw_jp1 = np.roll(u_lw, -1)\n            u_lw_jm1 = np.roll(u_lw, 1)\n            u_lw = u_lw - 0.5 * nu * (u_lw_jp1 - u_lw_jm1) + \\\n                   0.5 * nu**2 * (u_lw_jp1 - 2 * u_lw + u_lw_jm1)\n\n            # First-Order Upwind update\n            u_up_jm1 = np.roll(u_up, 1)\n            # The scheme is u_j^{n+1} = u_j^n - nu*(u_j^n - u_{j-1}^n)\n            u_up = (1 - nu) * u_up + nu * u_up_jm1\n\n        # 3. Compute Overshoot Amplitude (O)\n        t_final = Nt * dt\n        x_star = (a * t_final) % 1.0\n        j_star = int(np.round(x_star / dx))\n\n        # Create window of indices around j_star with periodic wrapping\n        window_indices = (j_star - m + np.arange(2 * m + 1)) % Nx\n\n        # Lax-Wendroff overshoot\n        max_val_lw = np.max(u_lw[window_indices])\n        O_lw = max(0.0, max_val_lw - 0.5)\n\n        # Upwind overshoot\n        max_val_up = np.max(u_up[window_indices])\n        O_up = max(0.0, max_val_up - 0.5)\n\n        # 4. Compute Dispersive Overshoot Predictor (Pi) for Lax-Wendroff\n        kappa_pts = 4096\n        kappa = np.linspace(0, np.pi, kappa_pts, endpoint=True)\n\n        # Complex amplification factor for Lax-Wendroff\n        G_lw = 1.0 + nu**2 * (np.cos(kappa) - 1.0) - 1j * nu * np.sin(kappa)\n\n        # Numerical phase (unwrapped)\n        theta_wrapped = -np.angle(G_lw)\n        theta_unwrapped = np.unwrap(theta_wrapped)\n\n        # Numerical phase speed ratio rho(kappa) = theta / (nu * kappa)\n        # Avoid division by zero at kappa=0. Analytically, rho(0)=1.\n        rho = np.ones_like(kappa)\n        non_zero_kappa_mask = kappa > 1e-9\n        kappa_nz = kappa[non_zero_kappa_mask]\n        theta_nz = theta_unwrapped[non_zero_kappa_mask]\n        rho[non_zero_kappa_mask] = theta_nz / (nu * kappa_nz)\n        \n        # Calculate predictor Pi from rho in the high-wavenumber regime\n        predictor_mask = kappa >= alpha * np.pi\n        rho_in_range = rho[predictor_mask]\n        \n        Pi_lw = np.max(np.maximum(0, rho_in_range - 1.0))\n\n        # 5. Store results for the current case, rounded to 6 decimal places\n        results.extend([\n            round(O_lw, 6),\n            round(O_up, 6),\n            round(Pi_lw, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3425583"}, {"introduction": "Beyond sharp discontinuities, how do these errors accumulate and affect the evolution of smooth, physically realistic solutions like wave packets? This advanced practice investigates the integrated effect of numerical errors on the bulk properties of a wave packet, using concepts like group velocity and group velocity dispersion derived from the numerical dispersion relation. This exercise bridges the gap between local Fourier analysis and global solution behavior, allowing you to quantify how a packet's shape and position are distorted over time by distinct dispersive and dissipative error mechanisms [@problem_id:3425532].", "problem": "Consider the linear advection partial differential equation (PDE) $u_t + a\\,u_x = 0$ with constant advection speed $a0$ on the real line. The initial condition is a modulated Gaussian wave packet $u(x,0) = \\exp\\!\\left(-\\left(\\frac{x}{\\sigma}\\right)^2\\right)\\cos(k_0 x)$, where $\\sigma0$ is the envelope width parameter and $k_00$ is the carrier wavenumber. All angles and wavenumbers must be treated in radians. Define the energy-density centroid and spread (variance) at time $t$ by\n$$\nx_c(t) = \\frac{\\int_{\\mathbb{R}} x\\,|u(x,t)|^2\\,dx}{\\int_{\\mathbb{R}} |u(x,t)|^2\\,dx},\\qquad\n\\mathrm{Var}_x(t) = \\frac{\\int_{\\mathbb{R}} (x - x_c(t))^2\\,|u(x,t)|^2\\,dx}{\\int_{\\mathbb{R}} |u(x,t)|^2\\,dx}.\n$$\nFor the continuous PDE, $x_c(t)=a\\,t$ and $\\mathrm{Var}_x(t)$ is constant in time.\n\nWe study numerical dispersion and dissipation introduced by two semi-discrete method-of-lines spatial discretizations on a uniform grid with spacing $\\Delta x$: \n- the centered difference $D^0 u_j = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$, and \n- the one-sided upwind difference (for $a0$) $D^- u_j = \\frac{u_{j} - u_{j-1}}{\\Delta x}$.\n\nTime advancement is assumed exact for the semi-discrete linear ordinary differential equation, so that numerical phase and amplitude evolution are entirely determined by the spatial discrete Fourier symbols.\n\nTasks:\n1. Starting from the definitions above and discrete Fourier mode analysis for $u_j(t) \\propto e^{i(j\\kappa - \\omega t)}$, derive, for each spatial discretization, the numerical dispersion relation $\\omega_{\\mathrm{num}}(k)$ and dissipation rate $\\gamma(k)$ as functions of the continuous wavenumber $k$ and grid spacing $\\Delta x$, where $\\kappa = k\\,\\Delta x$. Define the numerical group velocity $v_g(k) = \\frac{d\\omega_{\\mathrm{num}}}{dk}$ and curvature $\\beta_2(k) = \\frac{d^2\\omega_{\\mathrm{num}}}{dk^2}$.\n2. Under the narrowband Gaussian approximation in spectral space around $k_0$, model the spectral intensity (squared amplitude) at time $t$ for the upwind scheme by multiplying the initial Gaussian spectral intensity by the factor $\\exp\\!\\left(-2\\,\\gamma(k)\\,t\\right)$ and expanding $\\gamma(k)$ to second order about $k_0$. Use this to show that the effective spectral-intensity variance at time $t$ becomes \n$$\ns_k^2(t) = \\left(\\frac{1}{s_k^2(0)} + 2\\,\\gamma''(k_0)\\,t\\right)^{-1},\n$$\nand the spectral-intensity mean shifts by \n$$\n\\delta k(t) = -2\\,\\gamma'(k_0)\\,t\\,s_k^2(t),\n$$\nwhere $s_k^2(0)$ is the initial spectral-intensity variance around $k_0$, and primes denote derivatives with respect to $k$.\n3. Using stationary phase for narrowband packets, argue that the centroid drifts approximately as \n$$\nx_c(t) \\approx v_g(k_0)\\,t + \\beta_2(k_0)\\,\\delta k(t)\\,t,\n$$\nso that the centroid drift error relative to the exact advection, $\\Delta x_c(t) = x_c(t) - a\\,t$, decomposes into a dispersive contribution $\\left(v_g(k_0) - a\\right)t$ and an additional dissipative contribution $\\beta_2(k_0)\\,\\delta k(t)\\,t$ for the upwind scheme. For the centered scheme, $\\delta k(t)=0$.\n4. Show that, for a Gaussian spectral-intensity distribution with variance $s_k^2(t)$, the spatial-intensity variance at time $t$ satisfies the approximation\n$$\n\\mathrm{Var}_x(t) \\approx \\frac{1}{4\\,s_k^2(t)} + \\beta_2(k_0)^2\\,t^2\\,s_k^2(t).\n$$\nHence, the increase in spread relative to $t=0$ decomposes into a dispersive part $\\beta_2(k_0)^2\\,t^2\\,s_k^2(t)$ and a dissipative part $\\frac{1}{4\\,s_k^2(t)} - \\frac{1}{4\\,s_k^2(0)}$ for the upwind scheme. For the centered scheme, $s_k^2(t)=s_k^2(0)$ and the dissipative part vanishes.\n5. Use the initial condition $u(x,0) = \\exp\\!\\left(-\\left(\\frac{x}{\\sigma}\\right)^2\\right)\\cos(k_0 x)$ to determine the initial spectral-intensity variance $s_k^2(0)$ in terms of $\\sigma$. All wavenumbers and angles are in radians. \n\nImplement a program that, for each test case below, computes:\n- the centroid drift error for the centered scheme $\\Delta x_c^{\\mathrm{cen}}(T)$,\n- the total centroid drift error for the upwind scheme $\\Delta x_c^{\\mathrm{up}}(T)$,\n- the dispersive and dissipative components of the upwind centroid drift error,\n- the spread increase for the centered scheme $\\Delta\\mathrm{Var}_x^{\\mathrm{cen}}(T)$,\n- the total spread increase for the upwind scheme $\\Delta\\mathrm{Var}_x^{\\mathrm{up}}(T)$,\n- the dispersive and dissipative components of the upwind spread increase.\n\nAll quantities must be computed in dimensionless units, and angles must be treated in radians. Use the semi-discrete, exact-in-time framework as described.\n\nTest suite (each tuple is $(a,\\ \\sigma,\\ k_0,\\ \\Delta x,\\ T)$):\n- Case A (happy path): $(1.0,\\ 4.0,\\ 0.5,\\ 0.2,\\ 1.5)$,\n- Case B (boundary near Nyquist): $(1.0,\\ 3.0,\\ \\pi,\\ 0.5,\\ 1.0)$,\n- Case C (broader spectrum and moderate grid): $(2.0,\\ 1.5,\\ 1.2,\\ 0.3,\\ 0.8)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the following order per case:\n$[\\Delta x_c^{\\mathrm{cen}},\\ \\Delta x_c^{\\mathrm{up}},\\ (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{disp}},\\ (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{diss}},\\ \\Delta\\mathrm{Var}_x^{\\mathrm{cen}},\\ \\Delta\\mathrm{Var}_x^{\\mathrm{up}},\\ (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{disp}},\\ (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{diss}}]$. Concatenate the results for all cases in the order A, B, C into one flat list. The final printout must be exactly one line with this single list.", "solution": "The analysis is based on the semi-discrete method of lines for the linear advection equation $u_t + a u_x = 0$, which yields an ordinary differential equation (ODE) in time for the spatial grid points, $\\frac{d u_j}{dt} = -a D u_j$. We are told to assume exact time integration, meaning all errors arise from the spatial operator $D$. The behavior of a numerical scheme is characterized by its effect on a single Fourier mode, $u_j(t) \\propto e^{i(k x_j - \\omega t)}$, where $x_j=j\\Delta x$. Substituting this ansatz into the semi-discrete equation allows us to find the complex numerical frequency $\\omega(k)$. We write $\\omega(k) = \\omega_{\\mathrm{num}}(k) - i\\gamma(k)$, where $\\omega_{\\mathrm{num}}(k)$ is the numerical dispersion relation and $\\gamma(k)$ is the numerical dissipation rate. A non-zero $\\gamma(k)$ leads to amplitude decay like $e^{-\\gamma(k)t}$.\n\n**1. Numerical Dispersion and Dissipation (Task 1)**\n\nWe find $\\omega(k)$ by analyzing the eigenvalue of the discrete operator $-aD$ for the eigenfunction $e^{ikx_j}$. Let $\\kappa = k \\Delta x$.\nThe semi-discrete equation is $\\frac{d u_j}{dt} = -a D u_j$. Substituting the ansatz $u_j(t) = \\hat{u}_k e^{i(k j \\Delta x - \\omega t)}$ gives $-i\\omega = \\lambda(k)$, where $\\lambda(k)$ is the Fourier symbol of the operator $-aD$, such that $-a D e^{ikj\\Delta x} = \\lambda(k) e^{ikj\\Delta x}$. Thus, $\\omega(k) = i \\lambda(k)$.\n\n**Centered Difference Scheme ($D^0$)**:\nThe operator is $D^0 u_j = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}$. Its action on $e^{ikj\\Delta x}$ is:\n$$D^0 e^{ikj\\Delta x} = \\frac{e^{ik(j+1)\\Delta x} - e^{ik(j-1)\\Delta x}}{2\\Delta x} = \\frac{e^{i\\kappa} - e^{-i\\kappa}}{2\\Delta x} e^{ikj\\Delta x} = \\frac{2i\\sin(\\kappa)}{2\\Delta x} e^{ikj\\Delta x} = i\\frac{\\sin(k\\Delta x)}{\\Delta x} e^{ikj\\Delta x}$$\nThe eigenvalue of $-aD^0$ is $\\lambda(k) = -a \\left(i\\frac{\\sin(k\\Delta x)}{\\Delta x}\\right)$.\nThe complex frequency is $\\omega(k) = i\\lambda(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x}$.\nThis is purely real, so for the centered scheme:\n- Numerical dispersion relation: $\\omega_{\\mathrm{num}}(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x}$\n- Dissipation rate: $\\gamma(k) = 0$\nThe group velocity is $v_g(k) = \\frac{d\\omega_{\\mathrm{num}}}{dk} = a \\cos(k\\Delta x)$.\nThe group velocity dispersion (curvature) is $\\beta_2(k) = \\frac{d^2\\omega_{\\mathrm{num}}}{dk^2} = -a \\Delta x \\sin(k\\Delta x)$.\n\n**Upwind Difference Scheme ($D^-$)**:\nFor $a0$, the operator is $D^- u_j = \\frac{u_j - u_{j-1}}{\\Delta x}$. Its action is:\n$$D^- e^{ikj\\Delta x} = \\frac{e^{ikj\\Delta x} - e^{ik(j-1)\\Delta x}}{\\Delta x} = \\frac{1 - e^{-i\\kappa}}{\\Delta x} e^{ikj\\Delta x} = \\frac{1 - \\cos(\\kappa) + i\\sin(\\kappa)}{\\Delta x} e^{ikj\\Delta x}$$\nThe eigenvalue of $-aD^-$ is $\\lambda(k) = -a \\frac{1 - \\cos(k\\Delta x) + i\\sin(k\\Delta x)}{\\Delta x}$.\nThe complex frequency is $\\omega(k) = i\\lambda(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x} - i \\, a \\frac{1-\\cos(k\\Delta x)}{\\Delta x}$.\nIdentifying real and imaginary parts according to $\\omega = \\omega_{\\mathrm{num}} - i\\gamma$:\n- Numerical dispersion relation: $\\omega_{\\mathrm{num}}(k) = a \\frac{\\sin(k\\Delta x)}{\\Delta x}$\n- Dissipation rate: $\\gamma(k) = a \\frac{1-\\cos(k\\Delta x)}{\\Delta x}$\nThe dispersive properties are identical to the centered scheme:\n- Group velocity: $v_g(k) = \\frac{d\\omega_{\\mathrm{num}}}{dk} = a \\cos(k\\Delta x)$\n- Curvature: $\\beta_2(k) = \\frac{d^2\\omega_{\\mathrm{num}}}{dk^2} = -a \\Delta x \\sin(k\\Delta x)$\n\nTo analyze the effect of dissipation, we need derivatives of $\\gamma(k)$ for the upwind scheme:\n- $\\gamma'(k) = \\frac{d\\gamma}{dk} = a \\sin(k\\Delta x)$\n- $\\gamma''(k) = \\frac{d^2\\gamma}{dk^2} = a \\Delta x \\cos(k\\Delta x)$\n\n**2. Initial Spectral Properties (Task 5)**\n\nThe initial condition is $u(x,0) = e^{-(x/\\sigma)^2} \\cos(k_0 x)$. The Fourier transform is $\\hat{u}(k,0) = \\mathcal{F}\\{u(x,0)\\}$.\nUsing $\\cos(k_0 x) = \\frac{1}{2}(e^{ik_0 x} + e^{-ik_0 x})$ and the Fourier transform property $\\mathcal{F}\\{f(x)e^{ik_0 x}\\} = \\hat{f}(k-k_0)$, we find $\\hat{u}(k,0)$ is a sum of two Gaussians centered at $\\pm k_0$.\nThe spectral intensity is $|\\hat{u}(k,0)|^2$. For a narrowband packet (large $\\sigma k_0$), the cross-terms are negligible. The intensity around $k_0$ is proportional to the square of a single Gaussian term.\nThe transform of $e^{-x^2/\\sigma^2}$ is $\\sigma\\sqrt{\\pi} e^{-(k\\sigma)^2/4}$. Thus, the spectral amplitude profile around $k_0$ is $\\propto e^{-(k-k_0)^2\\sigma^2/4}$.\nThe spectral intensity is then $I(k,0) \\propto (e^{-(k-k_0)^2\\sigma^2/4})^2 = e^{-(k-k_0)^2\\sigma^2/2}$.\nWe model this as a Gaussian distribution with variance $s_k^2$, i.e., $I(k,0) \\propto e^{-\\frac{(k-k_0)^2}{2s_k^2(0)}}$.\nComparing exponents, $\\frac{(k-k_0)^2}{2s_k^2(0)} = \\frac{(k-k_0)^2\\sigma^2}{2}$, which gives the initial spectral-intensity variance:\n$$s_k^2(0) = \\frac{1}{\\sigma^2}$$\n\n**3. Wave Packet Dynamics and Error Analysis (Tasks 2, 3, 4)**\n\nThe problem provides approximations for the evolution of a narrowband wave packet. We will use these with our derived quantities.\nFor the upwind scheme, the spectral intensity evolves as $|\\hat{u}(k,t)|^2 = |\\hat{u}(k,0)|^2 e^{-2\\gamma(k)t}$. Expanding $\\gamma(k)$ to second order around $k_0$ and completing the square for the Gaussian exponent confirms the given formulas for the time-evolved spectral variance $s_k^2(t)$ and the shift in the mean wavenumber $\\delta k(t)$:\n- $s_k^2(t) = \\left(\\frac{1}{s_k^2(0)} + 2t\\gamma''(k_0)\\right)^{-1} = \\left(\\sigma^2 + 2ta\\Delta x \\cos(k_0\\Delta x)\\right)^{-1}$\n- $\\delta k(t) = -2\\gamma'(k_0)t s_k^2(t) = -2 (a \\sin(k_0\\Delta x)) t s_k^2(t)$\nFor the centered scheme, $\\gamma(k)=0$, so $s_k^2(t) = s_k^2(0)$ and $\\delta k(t) = 0$.\n\n**Centroid Drift Error, $\\Delta x_c(T) = x_c(T) - aT$**:\nUsing the stationary phase approximation $x_c(t) \\approx v_g(k_0)t + \\beta_2(k_0)\\delta k(t)t$:\n$\\Delta x_c(t) \\approx (v_g(k_0) - a)t + \\beta_2(k_0)\\delta k(t)t$. The first term is the dispersive error, present in both schemes. The second is the dissipative error, present only for the upwind scheme.\n- Centered scheme: $\\Delta x_c^{\\mathrm{cen}}(T) = (v_g(k_0) - a)T = a(\\cos(k_0\\Delta x)-1)T$.\n- Upwind scheme:\n    - Dispersive component: $(\\Delta x_c^{\\mathrm{up}})_{\\mathrm{disp}} = a(\\cos(k_0\\Delta x)-1)T$.\n    - Dissipative component: $(\\Delta x_c^{\\mathrm{up}})_{\\mathrm{diss}} = \\beta_2(k_0)\\delta k(T)T = (-a\\Delta x \\sin(k_0\\Delta x)) \\delta k(T) T$.\n    - Total: $\\Delta x_c^{\\mathrm{up}}(T) = (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{disp}} + (\\Delta x_c^{\\mathrm{up}})_{\\mathrm{diss}}$.\n\n**Spatial Spread Increase, $\\Delta\\mathrm{Var}_x(T) = \\mathrm{Var}_x(T) - \\mathrm{Var}_x(0)$**:\nUsing the approximation $\\mathrm{Var}_x(t) \\approx \\frac{1}{4s_k^2(t)} + \\beta_2(k_0)^2 t^2 s_k^2(t)$ and that $\\mathrm{Var}_x(0) \\approx \\frac{1}{4s_k^2(0)}$:\n$\\Delta\\mathrm{Var}_x(t) \\approx \\left(\\frac{1}{4s_k^2(t)} - \\frac{1}{4s_k^2(0)}\\right) + \\beta_2(k_0)^2 t^2 s_k^2(t)$. The first term is the dissipative part, the second is the dispersive part.\n- Centered scheme: $s_k^2(T) = s_k^2(0)$. Dissipative part is zero.\n    - $\\Delta\\mathrm{Var}_x^{\\mathrm{cen}}(T) = \\beta_2(k_0)^2 T^2 s_k^2(0) = (-a\\Delta x \\sin(k_0\\Delta x))^2 T^2 \\frac{1}{\\sigma^2}$.\n- Upwind scheme:\n    - Dispersive component: $(\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{disp}} = \\beta_2(k_0)^2 T^2 s_k^2(T)$.\n    - Dissipative component: $(\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{diss}} = \\frac{1}{4s_k^2(T)} - \\frac{1}{4s_k^2(0)} = \\frac{T}{2}\\gamma''(k_0) = \\frac{T}{2} a\\Delta x\\cos(k_0\\Delta x)$.\n    - Total: $\\Delta\\mathrm{Var}_x^{\\mathrm{up}}(T) = (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{disp}} + (\\Delta\\mathrm{Var}_x^{\\mathrm{up}})_{\\mathrm{diss}}$.\n\nThese formulas are sufficient to implement the required calculations for the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for numerical errors in centered and upwind schemes for the\n    linear advection equation based on semi-discrete Fourier analysis.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, sigma, k0, dx, T)\n        (1.0, 4.0, 0.5, 0.2, 1.5),         # Case A\n        (1.0, 3.0, np.pi, 0.5, 1.0),       # Case B\n        (2.0, 1.5, 1.2, 0.3, 0.8),         # Case C\n    ]\n\n    results = []\n    for a, sigma, k0, dx, T in test_cases:\n        # Step 1: Calculate initial and common parameters\n        s_k2_0 = 1.0 / (sigma**2)\n        kappa0 = k0 * dx\n        cos_kappa0 = np.cos(kappa0)\n        sin_kappa0 = np.sin(kappa0)\n\n        # Step 2: Properties common to both schemes (dispersive)\n        # v_g(k0) - a\n        vg_minus_a = a * (cos_kappa0 - 1.0)\n        # beta_2(k0)\n        beta2_k0 = -a * dx * sin_kappa0\n\n        # Step 3: Centered Scheme calculations\n        # Centroid drift error\n        delta_xc_cen = vg_minus_a * T\n        \n        # Spread increase\n        delta_varx_cen = (beta2_k0**2) * (T**2) * s_k2_0\n\n        # Step 4: Upwind Scheme calculations\n        \n        # Dissipative properties\n        # gamma'(k0)\n        gamma_prime_k0 = a * sin_kappa0\n        # gamma''(k0)\n        gamma_double_prime_k0 = a * dx * cos_kappa0\n\n        # Time-evolved spectral variance for upwind\n        # Denominator of s_k^2(T)\n        s_k2_T_inv = (1.0 / s_k2_0) + 2.0 * T * gamma_double_prime_k0\n        \n        # Check for unphysical results which can happen if the 2nd order\n        # approximation breaks down.\n        if s_k2_T_inv = 0:\n            # The model is not valid in this regime. However, given the problem\n            # context, this branch is not expected to be taken for the test cases.\n            # Assign NaN as a failure indicator.\n            s_k2_T = np.nan\n        else:\n            s_k2_T = 1.0 / s_k2_T_inv\n\n        # Centroid drift error components\n        delta_xc_up_disp = vg_minus_a * T\n        \n        # Spectral mean shift delta_k(T)\n        delta_k_T = -2.0 * gamma_prime_k0 * T * s_k2_T\n        \n        delta_xc_up_diss = beta2_k0 * delta_k_T * T\n        \n        delta_xc_up_total = delta_xc_up_disp + delta_xc_up_diss\n        \n        # Spread increase components\n        delta_varx_up_disp = (beta2_k0**2) * (T**2) * s_k2_T\n        \n        # Simplified formula: (1/4)*(1/s_k^2(T) - 1/s_k^2(0)) = T/2 * gamma''(k0)\n        delta_varx_up_diss = (T / 2.0) * gamma_double_prime_k0\n        \n        delta_varx_up_total = delta_varx_up_disp + delta_varx_up_diss\n        \n        # Step 5: Append results for the current case in the specified order\n        case_results = [\n            delta_xc_cen,\n            delta_xc_up_total,\n            delta_xc_up_disp,\n            delta_xc_up_diss,\n            delta_varx_cen,\n            delta_varx_up_total,\n            delta_varx_up_disp,\n            delta_varx_up_diss\n        ]\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3425532"}]}