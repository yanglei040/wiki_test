{"hands_on_practices": [{"introduction": "Combining high-order spatial and temporal discretization is essential for accurately simulating wave propagation. However, ensuring the stability of such a pairing is non-trivial and requires a careful analysis of how the two components interact. This exercise [@problem_id:3446684] provides a comprehensive workout in applying von Neumann stability analysis to a modern numerical method, combining a high-order compact finite difference scheme with the classical fourth-order Runge-Kutta integrator. By deriving the scheme's amplification factor and mapping the spatial operator's spectrum, you will determine the precise Courant–Friedrichs–Lewy (CFL) stability limit, gaining fundamental skills in analyzing the interplay between dispersion, dissipation, and numerical stability.", "problem": "Consider the linear advection equation $u_t + u_x = 0$ on a periodic domain, discretized on a uniform grid $x_j = j h$ with grid spacing $h > 0$. The spatial derivative $u_x$ at the grid points is approximated by the following upwind-biased compact finite difference relation:\n$$\n\\frac{1}{2} \\, (\\partial_x u)_{j-1} + (\\partial_x u)_j \\;=\\; \\frac{1}{h} \\left( \\frac{1}{4} u_{j+1} + 1 \\cdot u_j - \\frac{5}{4} u_{j-1} \\right),\n$$\nwhich defines $(\\partial_x u)_j$ implicitly in terms of neighboring values. This provides a semi-discrete scheme $u_t = - D_h u$ where $D_h$ is the discrete derivative operator defined by the compact relation. Time integration is performed by the classical four-stage explicit Runge–Kutta method (RK(4)).\n\nUsing normal mode analysis with the Fourier ansatz $u_j(t) = \\hat{u}(t) \\exp(i \\theta j)$ for $\\theta \\in [-\\pi,\\pi]$, perform all of the following tasks from first principles:\n\n- Derive the semi-discrete symbol $s(\\theta)$ defined by $\\frac{d}{dt}\\hat{u}(t) = s(\\theta)\\,\\hat{u}(t)$, and from it obtain the discrete dispersion relation $\\omega(\\theta)$ and discrete damping rate $\\sigma(\\theta)$, where $\\omega(\\theta) = -\\operatorname{Im}(s(\\theta))$ and $\\sigma(\\theta) = \\operatorname{Re}(s(\\theta))$. Express $\\omega(\\theta)$ explicitly in terms of $\\theta$ and $h$ for the given compact scheme.\n\n- For the time discretization by classical RK(4), define the fully discrete one-step amplification factor $G(\\theta; C)$ in terms of the Courant number $C = \\Delta t / h$, and relate its phase $\\arg(G(\\theta; C))$ to the semi-discrete frequency $\\omega(\\theta)$ to quantify the phase error for small $C$. State the order of the phase error in $C$ and $\\theta$.\n\n- Determine the sharp Courant–Friedrichs–Lewy (CFL) limit $C_{\\max}$ such that the RK(4)-advanced solution is linearly stable for all $\\theta \\in [-\\pi,\\pi]$, that is, $\\sup_{\\theta} |G(\\theta; C_{\\max})| = 1$ and $|G(\\theta; C)| \\le 1$ for all $C \\in [0, C_{\\max}]$. Provide the numerical value of $C_{\\max}$, rounded to four significant figures.\n\nYour final answer must be the value of $C_{\\max}$ only (no units), rounded to four significant figures, as specified above.", "solution": "The user wants to analyze a numerical method for the linear advection equation. The method combines a compact finite difference scheme for the spatial derivative and a classical four-stage Runge-Kutta (RK4) method for time integration. The analysis will be performed using the Fourier or normal mode method.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **PDE:** $u_t + u_x = 0$\n-   **Domain:** Periodic, with uniform grid $x_j = j h$, $h > 0$.\n-   **Spatial Discretization (Compact Scheme):**\n    $$ \\frac{1}{2} \\, (\\partial_x u)_{j-1} + (\\partial_x u)_j \\;=\\; \\frac{1}{h} \\left( \\frac{1}{4} u_{j+1} + 1 \\cdot u_j - \\frac{5}{4} u_{j-1} \\right) $$\n-   **Semi-discretization:** $u_t = - D_h u$, where $D_h$ is the discrete operator defined by the compact scheme.\n-   **Time Discretization:** Classical four-stage explicit Runge-Kutta method (RK4).\n-   **Analysis Tool:** Normal mode analysis with the Fourier ansatz $u_j(t) = \\hat{u}(t) \\exp(i \\theta j)$ for $\\theta \\in [-\\pi,\\pi]$.\n-   **Tasks:**\n    1.  Derive the semi-discrete symbol $s(\\theta)$, the discrete dispersion relation $\\omega(\\theta) = -\\operatorname{Im}(s(\\theta))$, and the discrete damping rate $\\sigma(\\theta) = \\operatorname{Re}(s(\\theta))$. Provide the explicit expression for $\\omega(\\theta)$.\n    2.  Define the fully discrete amplification factor $G(\\theta; C)$ for Courant number $C = \\Delta t / h$, and state the order of the phase error for small $C$ and $\\theta$.\n    3.  Determine the sharp CFL limit $C_{\\max}$ for linear stability, defined by $\\sup_{\\theta} |G(\\theta; C_{\\max})| = 1$ and $|G(\\theta; C)| \\le 1$ for all $C \\in [0, C_{\\max}]$. Provide its numerical value rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded:** The problem is a standard exercise in the field of numerical analysis for partial differential equations. The advection equation, compact finite differences, RK4 methods, and von Neumann (Fourier) stability analysis are all well-established and fundamental concepts. The problem is firmly grounded in mathematical and computational science.\n-   **Well-Posed:** All necessary information is provided. The tasks are specific and lead to a unique, meaningful solution.\n-   **Objective:** The problem is stated in precise, formal, and unbiased mathematical language.\n\nThe problem is free of any scientific, logical, or structural flaws. It is a valid problem.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. I will proceed with the detailed solution.\n\n### Solution Derivation\n\n**Part 1: Semi-discrete Symbol and Dispersion Relation**\n\nThe semi-discrete system is obtained by replacing the spatial derivative $u_x$ in the PDE $u_t = -u_x$ with the discrete operator $D_h u$, which we denote by $(\\partial_x u)_j$. The compact scheme gives a relation for this operator:\n$$ \\frac{1}{2} \\, (u_t)_{j-1} + (u_t)_j \\;=\\; -\\frac{1}{h} \\left( \\frac{1}{4} u_{j+1} + u_j - \\frac{5}{4} u_{j-1} \\right) $$\nWe substitute the Fourier ansatz $u_j(t) = \\hat{u}(t) \\exp(i \\theta j)$ into this equation. The time derivative is $(u_t)_j = \\frac{d\\hat{u}}{dt} \\exp(i \\theta j)$. The terms become:\n- $(u_t)_{j-1} = \\frac{d\\hat{u}}{dt} \\exp(i \\theta (j-1)) = \\frac{d\\hat{u}}{dt} \\exp(i \\theta j) \\exp(-i \\theta)$\n- $(u_t)_j = \\frac{d\\hat{u}}{dt} \\exp(i \\theta j)$\n- $u_{j+1} = \\hat{u}(t) \\exp(i \\theta (j+1)) = \\hat{u}(t) \\exp(i \\theta j) \\exp(i \\theta)$\n- $u_{j-1} = \\hat{u}(t) \\exp(i \\theta (j-1)) = \\hat{u}(t) \\exp(i \\theta j) \\exp(-i \\theta)$\n\nSubstituting these into the semi-discrete equation yields:\n$$ \\frac{1}{2} \\frac{d\\hat{u}}{dt} \\exp(i \\theta j) \\exp(-i \\theta) + \\frac{d\\hat{u}}{dt} \\exp(i \\theta j) = -\\frac{1}{h} \\left( \\frac{1}{4} \\hat{u} \\exp(i \\theta j) \\exp(i \\theta) + \\hat{u} \\exp(i \\theta j) - \\frac{5}{4} \\hat{u} \\exp(i \\theta j) \\exp(-i \\theta) \\right) $$\nWe divide by the common factor $\\exp(i \\theta j)$:\n$$ \\frac{d\\hat{u}}{dt} \\left( \\frac{1}{2} \\exp(-i \\theta) + 1 \\right) = -\\frac{\\hat{u}}{h} \\left( \\frac{1}{4} \\exp(i \\theta) + 1 - \\frac{5}{4} \\exp(-i \\theta) \\right) $$\nThe semi-discrete symbol $s(\\theta)$ is defined by $\\frac{d\\hat{u}}{dt} = s(\\theta) \\hat{u}$. Solving for $s(\\theta) = \\frac{1}{\\hat{u}}\\frac{d\\hat{u}}{dt}$:\n$$ s(\\theta) = -\\frac{1}{h} \\frac{1 + \\frac{1}{4} \\exp(i \\theta) - \\frac{5}{4} \\exp(-i \\theta)}{1 + \\frac{1}{2} \\exp(-i \\theta)} $$\nTo find the real and imaginary parts, we use Euler's formula, $\\exp(i\\theta) = \\cos(\\theta) + i\\sin(\\theta)$.\nThe numerator is $N(\\theta) = 1 + \\frac{1}{4}(\\cos\\theta + i\\sin\\theta) - \\frac{5}{4}(\\cos\\theta - i\\sin\\theta) = 1 - \\cos\\theta + i\\frac{6}{4}\\sin\\theta = 1 - \\cos\\theta + i\\frac{3}{2}\\sin\\theta$.\nThe denominator is $D(\\theta) = 1 + \\frac{1}{2}(\\cos\\theta - i\\sin\\theta) = (1 + \\frac{1}{2}\\cos\\theta) - i\\frac{1}{2}\\sin\\theta$.\nWe multiply the numerator and denominator by the conjugate of the denominator, $D^*(\\theta) = (1 + \\frac{1}{2}\\cos\\theta) + i\\frac{1}{2}\\sin\\theta$:\n$$ s(\\theta) = -\\frac{1}{h} \\frac{N(\\theta)D^*(\\theta)}{|D(\\theta)|^2} $$\nThe squared magnitude of the denominator is $|D(\\theta)|^2 = (1 + \\frac{1}{2}\\cos\\theta)^2 + (-\\frac{1}{2}\\sin\\theta)^2 = 1 + \\cos\\theta + \\frac{1}{4}\\cos^2\\theta + \\frac{1}{4}\\sin^2\\theta = 1 + \\cos\\theta + \\frac{1}{4} = \\frac{5}{4} + \\cos\\theta$.\nThe product in the numerator is $N(\\theta)D^*(\\theta) = (1 - \\cos\\theta + i\\frac{3}{2}\\sin\\theta)((1 + \\frac{1}{2}\\cos\\theta) + i\\frac{1}{2}\\sin\\theta)$.\nThe real part is $\\operatorname{Re}(N D^*) = (1 - \\cos\\theta)(1 + \\frac{1}{2}\\cos\\theta) - (\\frac{3}{2}\\sin\\theta)(\\frac{1}{2}\\sin\\theta) = 1 - \\frac{1}{2}\\cos\\theta - \\frac{1}{2}\\cos^2\\theta - \\frac{3}{4}\\sin^2\\theta = 1 - \\frac{1}{2}\\cos\\theta - \\frac{1}{2}\\cos^2\\theta - \\frac{3}{4}(1-\\cos^2\\theta) = \\frac{1}{4} - \\frac{1}{2}\\cos\\theta + \\frac{1}{4}\\cos^2\\theta = \\frac{1}{4}(1-\\cos\\theta)^2$.\nThe imaginary part is $\\operatorname{Im}(N D^*) = (1 - \\cos\\theta)(\\frac{1}{2}\\sin\\theta) + (\\frac{3}{2}\\sin\\theta)(1 + \\frac{1}{2}\\cos\\theta) = \\sin\\theta(\\frac{1}{2} - \\frac{1}{2}\\cos\\theta + \\frac{3}{2} + \\frac{3}{4}\\cos\\theta) = \\sin\\theta(2 + \\frac{1}{4}\\cos\\theta)$.\nSo, the semi-discrete symbol is:\n$$ s(\\theta) = -\\frac{1}{h} \\frac{\\frac{1}{4}(1-\\cos\\theta)^2 + i\\sin\\theta(2 + \\frac{1}{4}\\cos\\theta)}{\\frac{5}{4} + \\cos\\theta} = -\\frac{1}{h} \\frac{(1-\\cos\\theta)^2 + i\\sin\\theta(8 + \\cos\\theta)}{5 + 4\\cos\\theta} $$\nThe damping rate is $\\sigma(\\theta) = \\operatorname{Re}(s(\\theta))$ and the dispersion relation is $\\omega(\\theta) = -\\operatorname{Im}(s(\\theta))$.\n$$ \\sigma(\\theta) = -\\frac{1}{h} \\frac{(1-\\cos\\theta)^2}{5 + 4\\cos\\theta} $$\n$$ \\omega(\\theta) = - \\left(-\\frac{1}{h} \\frac{\\sin\\theta(8 + \\cos\\theta)}{5 + 4\\cos\\theta}\\right) = \\frac{1}{h} \\frac{\\sin\\theta(8 + \\cos\\theta)}{5 + 4\\cos\\theta} $$\n\n**Part 2: Fully Discrete Amplification Factor and Phase Error**\n\nFor a semi-discretization $\\frac{d\\hat{u}}{dt} = s(\\theta)\\hat{u}$, the application of the classical RK4 method results in the fully discrete amplification factor $G(\\theta; C) = g(z)$, where $z = \\Delta t s(\\theta)$ and $g(z)$ is the stability polynomial of RK4:\n$$ g(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} $$\nThe Courant number is $C = \\Delta t / h$, so $\\Delta t = C h$. Thus, $z = C h s(\\theta)$. The amplification factor is:\n$$ G(\\theta; C) = 1 + C h s(\\theta) + \\frac{(C h s(\\theta))^2}{2} + \\frac{(C h s(\\theta))^3}{6} + \\frac{(C h s(\\theta))^4}{24} $$\nThe exact solution to the semi-discrete ODE over one time step $\\Delta t$ is $\\exp(s(\\theta)\\Delta t)$. The phase of this exact integrator is $\\arg(\\exp(s(\\theta)\\Delta t)) = \\operatorname{Im}(s(\\theta)\\Delta t) = -\\omega(\\theta)\\Delta t$.\nThe numerical phase is $\\arg(G(\\theta; C))$. The phase error is the difference $\\Phi_{err} = \\arg(G(\\theta; C)) - (-\\omega(\\theta)\\Delta t) = \\arg(G) + \\omega(\\theta)\\Delta t$.\nFor a small argument $z$, the RK4 polynomial is a Taylor approximation of the exponential function: $g(z) = \\exp(z) - \\frac{z^5}{120} + O(z^6)$.\nThe phase error arises from this truncation.\n$\\ln(G) = \\ln(g(z)) \\approx \\ln(\\exp(z) - \\frac{z^5}{120}) = z + \\ln(1 - \\frac{z^5}{120}\\exp(-z)) \\approx z - \\frac{z^5}{120}\\exp(-z)$.\n$\\arg(G) = \\operatorname{Im}(\\ln(G)) \\approx \\operatorname{Im}(z) - \\operatorname{Im}(\\frac{z^5}{120}\\exp(-z))$.\n$\\operatorname{Im}(z) = \\operatorname{Im}(\\Delta t s(\\theta)) = \\Delta t \\operatorname{Im}(s(\\theta)) = -\\Delta t \\omega(\\theta)$.\nSo, $\\Phi_{err} = (-\\Delta t \\omega(\\theta) - \\operatorname{Im}(\\frac{z^5}{120}\\exp(-z))) + \\Delta t \\omega(\\theta) = - \\operatorname{Im}(\\frac{z^5}{120}\\exp(-z))$.\nFor small $C$ and $\\theta$, the scheme is nearly non-dissipative and non-dispersive. Specifically, $\\omega(\\theta) \\approx \\theta/h$ and $\\sigma(\\theta) = O(\\theta^4)$.\nThen $s(\\theta) \\approx -i\\omega(\\theta) \\approx -i\\theta/h$, and $z = \\Delta t s(\\theta) \\approx -i C \\theta$.\nLet $\\phi = C\\theta$. Then $z \\approx -i\\phi$. The error term becomes:\n$\\Phi_{err} \\approx -\\operatorname{Im}\\left(\\frac{(-i\\phi)^5}{120}\\exp(i\\phi)\\right) = -\\operatorname{Im}\\left(\\frac{-i\\phi^5}{120}(\\cos\\phi+i\\sin\\phi)\\right) = -\\operatorname{Im}\\left(\\frac{-\\phi^5\\sin\\phi-i\\phi^5\\cos\\phi}{120}\\right) = \\frac{\\phi^5\\cos\\phi}{120}$.\nFor small $\\phi$, $\\cos\\phi \\approx 1$, so $\\Phi_{err} \\approx \\frac{\\phi^5}{120} = \\frac{(C\\theta)^5}{120}$.\nThe order of the phase error is $O(C^5 \\theta^5)$, i.e., fifth order in both $C$ and $\\theta$.\n\n**Part 3: CFL Limit $C_{\\max}$**\n\nLinear stability requires that the amplification factor satisfies $|G(\\theta; C)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. This means that for a given $C$, the locus of points $z(\\theta) = C h s(\\theta)$ for $\\theta \\in [-\\pi, \\pi]$ must lie entirely inside the stability region of the RK4 method, $\\mathcal{S}_{\\text{RK4}} = \\{z \\in \\mathbb{C} : |g(z)| \\le 1\\}$.\nThe CFL limit $C_{\\max}$ is the largest $C$ for which this condition holds. This typically occurs when the locus $C_{\\max} h s(\\theta)$ touches the boundary of $\\mathcal{S}_{\\text{RK4}}$.\nLet's analyze the locus of $H(\\theta) = h s(\\theta)$. We found\n$H(\\theta) = -\\frac{(1-\\cos\\theta)^2}{5 + 4\\cos\\theta} - i\\frac{\\sin\\theta(8 + \\cos\\theta)}{5 + 4\\cos\\theta}$.\nAt $\\theta=0$, $H(0)=0$.\nAt $\\theta=\\pi$, $\\cos\\pi=-1, \\sin\\pi=0$.\n$H(\\pi) = -\\frac{(1-(-1))^2}{5 + 4(-1)} - i \\cdot 0 = -\\frac{2^2}{1} = -4$.\nThe locus of $H(\\theta)$ extends along the negative real axis to the point $-4$. The stability of the scheme is therefore constrained by the extent of the RK4 stability region along the negative real axis.\nFor a real argument $z=x<0$, the stability condition is $|g(x)| \\le 1$, where $g(x) = 1+x+\\frac{x^2}{2}+\\frac{x^3}{6}+\\frac{x^4}{24}$.\nSince $g'(x) = 1+x+x^2/2+x^3/6$ has its only real root at $x \\approx -1.295$ and $g(-1.295) > 0$, the function $g(x)$ is always positive for real $x$. Thus the condition simplifies to $g(x) \\le 1$.\n$$ 1+x+\\frac{x^2}{2}+\\frac{x^3}{6}+\\frac{x^4}{24} \\le 1 \\implies x+\\frac{x^2}{2}+\\frac{x^3}{6}+\\frac{x^4}{24} \\le 0 $$\n$$ x\\left(1+\\frac{x}{2}+\\frac{x^2}{6}+\\frac{x^3}{24}\\right) \\le 0 $$\nFor $x<0$, this requires the polynomial in the parenthesis to be non-negative:\n$$ P(x) = 1+\\frac{x}{2}+\\frac{x^2}{6}+\\frac{x^3}{24} \\ge 0 $$\nThe left boundary of the stability interval on the real axis is the root $x^*$ of $P(x)=0$. Multiplying by $24$ gives the equation $x^3+4x^2+12x+24=0$.\nThis equation must be solved numerically. Using a numerical solver (e.g., Newton's method), we find the real root to be $x^* \\approx -2.78528179...$.\nThe stability condition is that the point $z(\\pi) = C \\cdot H(\\pi) = -4C$ must be within the stability interval $[x^*, 0]$.\n$$-4C \\ge x^* \\implies C \\le \\frac{x^*}{-4}$$\nThe limiting value $C_{\\max}$ is obtained when equality holds:\n$$ C_{\\max} = \\frac{-2.78528179...}{-4} = 0.69632044... $$\nA check of the full locus of $h s(\\theta)$ confirms that this point at $\\theta=\\pi$ is indeed the most restrictive one, as the curve $H(\\theta)$ is \"longest\" in the direction of the shortest axis of the RK4 stability region.\nRounding the result to four significant figures gives:\n$$ C_{\\max} \\approx 0.6963 $$", "answer": "$$\\boxed{0.6963}$$", "id": "3446684"}, {"introduction": "While non-dissipative centered difference schemes offer high accuracy for resolving waves, they often lack a mechanism to damp unphysical, high-frequency oscillations that can contaminate a simulation and lead to instability. A common and practical solution is to apply a numerical filter designed to selectively remove this noise without compromising the accuracy of the resolved wave components. This practice [@problem_id:3446714] challenges you to design a symmetric Padé filter by deriving its transfer function in Fourier space and imposing constraints that guarantee stability and accuracy. This problem moves beyond simply analyzing a given scheme and into the realm of numerical engineering, where you will tailor a component of the algorithm to achieve specific, desirable properties.", "problem": "Consider the linear advection Partial Differential Equation (PDE) $u_{t} + u_{x} = 0$ on a one-dimensional periodic domain with uniform grid spacing $\\Delta x$. Assume the spatial derivative is approximated by any centered compact Finite Difference (FD) operator whose semi-discrete spatial operator is skew-symmetric, so that its discrete Fourier symbol is purely imaginary for all discrete wavenumbers $\\theta \\in [0,\\pi]$ (in radians). Suppose time advancement is such that, in the absence of filtering, all Fourier modes neither grow nor decay in amplitude over one step. A three-point symmetric Padé filter is applied after each time step, defined implicitly by\n$$\n\\alpha\\,\\hat{u}_{j-1} + \\hat{u}_{j} + \\alpha\\,\\hat{u}_{j+1} \\;=\\; a\\,u_{j-1} + b\\,u_{j} + a\\,u_{j+1},\n$$\nwhere $\\hat{u}_{j}$ is the filtered solution, $u_{j}$ is the pre-filter solution, and $\\alpha$, $a$, $b$ are real constants independent of $j$. For a single Fourier mode $u_{j} = \\exp(i j \\theta)$, denote the filter transfer function by $G(\\theta)$ such that $\\hat{u}_{j} = G(\\theta)\\,u_{j}$.\n\nStarting from the definitions above and first principles of Fourier (Discrete Fourier Transform (DFT)) mode analysis and energy stability, determine the choice of filter parameters that guarantees all of the following simultaneously:\n1) exact preservation of the mean, i.e., $G(0) = 1$,\n2) monotone decay of modal amplitudes with increasing wavenumber, i.e., $G(\\theta)$ is a non-increasing function of $\\theta$ on $[0,\\pi]$,\n3) non-amplification of any Fourier mode, i.e., $0 \\le G(\\theta) \\le 1$ for all $\\theta \\in [0,\\pi]$,\n4) maximal suppression of the Nyquist mode subject to items 1)–3), i.e., $G(\\pi)$ is as small as possible while still meeting items 1)–3).\n\nYou may take $\\alpha$ to be a free positive parameter such that the implicit filter remains well-defined for all $\\theta \\in [0,\\pi]$. Express your final answer as the ordered pair $(a,b)$ in closed form as a function of $\\alpha$. No numerical evaluation or rounding is required, and angles are in radians. The resolved-band stability of the overall advection–filter scheme must be justified by the conditions you impose on $G(\\theta)$.", "solution": "The problem is to determine the filter parameters $a$ and $b$ for a three-point symmetric Padé filter, subject to a set of four conditions related to stability and accuracy for a numerical scheme.\n\nFirst, we determine the transfer function $G(\\theta)$ of the filter. The filter is defined by the implicit relation:\n$$\n\\alpha\\,\\hat{u}_{j-1} + \\hat{u}_{j} + \\alpha\\,\\hat{u}_{j+1} \\;=\\; a\\,u_{j-1} + b\\,u_{j} + a\\,u_{j+1}\n$$\nWe analyze a single Fourier mode, $u_{j} = \\exp(i j \\theta)$, where $j$ is the grid index, $i = \\sqrt{-1}$, and $\\theta = k \\Delta x$ is the discrete wavenumber, with $k$ being the continuous wavenumber and $\\Delta x$ the grid spacing. The filtered solution is given by $\\hat{u}_{j} = G(\\theta) u_{j} = G(\\theta) \\exp(i j \\theta)$.\nSubstituting these forms into the filter equation:\n$$\n\\alpha G(\\theta)\\exp(i(j-1)\\theta) + G(\\theta)\\exp(ij\\theta) + \\alpha G(\\theta)\\exp(i(j+1)\\theta) = a\\exp(i(j-1)\\theta) + b\\exp(ij\\theta) + a\\exp(i(j+1)\\theta)\n$$\nWe can factor out the common term $\\exp(ij\\theta)$ from both sides:\n$$\nG(\\theta) \\left( \\alpha\\exp(-i\\theta) + 1 + \\alpha\\exp(i\\theta) \\right) = a\\exp(-i\\theta) + b + a\\exp(i\\theta)\n$$\nUsing Euler's identity, $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$, the equation becomes:\n$$\nG(\\theta) \\left( 1 + 2\\alpha\\cos(\\theta) \\right) = b + 2a\\cos(\\theta)\n$$\nSolving for the transfer function $G(\\theta)$:\n$$\nG(\\theta) = \\frac{b + 2a\\cos(\\theta)}{1 + 2\\alpha\\cos(\\theta)}\n$$\nThe problem states that the filter must be well-defined for all $\\theta \\in [0, \\pi]$. This means the denominator cannot be zero. Since $\\alpha > 0$ and $\\cos(\\theta)$ ranges from $-1$ to $1$, the denominator $1 + 2\\alpha\\cos(\\theta)$ can become zero if $1 + 2\\alpha\\cos(\\theta) = 0$, which implies $\\cos(\\theta) = -1/(2\\alpha)$. A real solution for $\\theta$ exists if $|-1/(2\\alpha)| \\le 1$, which simplifies to $2\\alpha \\ge 1$ or $\\alpha \\ge 1/2$. To ensure the denominator is never zero for any $\\theta \\in [0, \\pi]$, we must have $\\alpha < 1/2$. Given $\\alpha > 0$, the constraint on the free parameter is $0 < \\alpha < 1/2$. Under this condition, the denominator $1 + 2\\alpha\\cos(\\theta)$ is always positive.\n\nNow, we apply the four given conditions.\n\n1.  **Exact preservation of the mean, $G(0) = 1$**:\n    For the mean component, the wavenumber is $\\theta=0$, so $\\cos(0)=1$.\n    $$\n    G(0) = \\frac{b + 2a\\cos(0)}{1 + 2\\alpha\\cos(0)} = \\frac{b + 2a}{1 + 2\\alpha}\n    $$\n    Setting $G(0)=1$ yields the linear relationship:\n    $$\n    b + 2a = 1 + 2\\alpha \\quad \\implies \\quad b = 1 + 2\\alpha - 2a\n    $$\n\n2.  **Monotone decay of modal amplitudes, $G'(\\theta) \\le 0$ for $\\theta \\in [0, \\pi]$**:\n    We compute the derivative of $G(\\theta)$ with respect to $\\theta$ using the quotient rule:\n    $$\n    G'(\\theta) = \\frac{(-2a\\sin(\\theta))(1 + 2\\alpha\\cos(\\theta)) - (b + 2a\\cos(\\theta))(-2\\alpha\\sin(\\theta))}{(1 + 2\\alpha\\cos(\\theta))^2}\n    $$\n    $$\n    G'(\\theta) = \\frac{-2a\\sin(\\theta) - 4a\\alpha\\sin(\\theta)\\cos(\\theta) + 2\\alpha b\\sin(\\theta) + 4a\\alpha\\sin(\\theta)\\cos(\\theta)}{(1 + 2\\alpha\\cos(\\theta))^2}\n    $$\n    $$\n    G'(\\theta) = \\frac{2\\sin(\\theta)(\\alpha b - a)}{(1 + 2\\alpha\\cos(\\theta))^2}\n    $$\n    For $\\theta \\in (0, \\pi)$, $\\sin(\\theta) > 0$. The denominator is a squared term and is positive (since $0 < \\alpha < 1/2$). Thus, the sign of $G'(\\theta)$ is determined by the sign of $(\\alpha b - a)$. The condition $G'(\\theta) \\le 0$ requires:\n    $$\n    \\alpha b - a \\le 0\n    $$\n    Substituting $b = 1 + 2\\alpha - 2a$ from Condition 1:\n    $$\n    \\alpha(1 + 2\\alpha - 2a) - a \\le 0 \\quad \\implies \\quad \\alpha + 2\\alpha^2 - 2a\\alpha - a \\le 0\n    $$\n    $$\n    \\alpha(1+2\\alpha) \\le a(1+2\\alpha)\n    $$\n    Since $\\alpha > 0$, the term $(1+2\\alpha)$ is positive, so we can divide by it without changing the inequality:\n    $$\n    a \\ge \\alpha\n    $$\n\n3.  **Non-amplification of any Fourier mode, $0 \\le G(\\theta) \\le 1$ for all $\\theta \\in [0, \\pi]$**:\n    The combined advection-filter scheme's stability requires that the total amplification factor has a magnitude less than or equal to $1$. The problem states the time-stepping scheme alone has a unitary amplification factor. Thus, the stability of the full scheme depends on the filter's transfer function, requiring $|G(\\theta)| \\le 1$. The problem strengthens this to $0 \\le G(\\theta) \\le 1$.\n    From Condition 1, $G(0)=1$. From Condition 2, $G(\\theta)$ is non-increasing on $[0,\\pi]$. This automatically satisfies $G(\\theta) \\le G(0) = 1$.\n    We only need to enforce the lower bound, $G(\\theta) \\ge 0$. Since $G(\\theta)$ is non-increasing, its minimum value on $[0, \\pi]$ occurs at $\\theta = \\pi$. Therefore, we require $G(\\pi) \\ge 0$.\n    At $\\theta = \\pi$, $\\cos(\\pi) = -1$.\n    $$\n    G(\\pi) = \\frac{b + 2a\\cos(\\pi)}{1 + 2\\alpha\\cos(\\pi)} = \\frac{b - 2a}{1 - 2\\alpha}\n    $$\n    Since we established $0 < \\alpha < 1/2$, the denominator $1-2\\alpha$ is positive. The condition $G(\\pi) \\ge 0$ thus requires the numerator to be non-negative:\n    $$\n    b - 2a \\ge 0\n    $$\n    Again, substituting $b = 1 + 2\\alpha - 2a$:\n    $$\n    (1 + 2\\alpha - 2a) - 2a \\ge 0 \\quad \\implies \\quad 1 + 2\\alpha \\ge 4a\n    $$\n    $$\n    a \\le \\frac{1+2\\alpha}{4}\n    $$\n\n4.  **Maximal suppression of the Nyquist mode ($G(\\pi)$ is minimized)**:\n    We must find the parameters that minimize $G(\\pi)$ subject to the constraints derived from Conditions 1-3. The constraints on $a$ are:\n    $$\n    \\alpha \\le a \\le \\frac{1+2\\alpha}{4}\n    $$\n    We want to minimize $G(\\pi)$, which is given by:\n    $$\n    G(\\pi) = \\frac{b - 2a}{1 - 2\\alpha} = \\frac{(1+2\\alpha - 2a) - 2a}{1 - 2\\alpha} = \\frac{1 + 2\\alpha - 4a}{1 - 2\\alpha}\n    $$\n    Since the denominator $1 - 2\\alpha$ is a positive constant with respect to $a$, minimizing $G(\\pi)$ is equivalent to minimizing the numerator $1 + 2\\alpha - 4a$. This expression is a decreasing function of $a$. To minimize it, we must choose the largest possible value for $a$ from its allowed range. The maximum value for $a$ is:\n    $$\n    a = \\frac{1+2\\alpha}{4}\n    $$\n    With this choice of $a$, the value of $G(\\pi)$ becomes:\n    $$\n    G(\\pi) = \\frac{1 + 2\\alpha - 4\\left(\\frac{1+2\\alpha}{4}\\right)}{1 - 2\\alpha} = \\frac{1 + 2\\alpha - (1+2\\alpha)}{1 - 2\\alpha} = 0\n    $$\n    This is the smallest possible value for $G(\\pi)$ under the condition $G(\\pi) \\ge 0$.\n\nFinally, we determine the corresponding value of $b$ using the relationship from Condition 1:\n$$\nb = 1 + 2\\alpha - 2a = 1 + 2\\alpha - 2\\left(\\frac{1+2\\alpha}{4}\\right) = 1 + 2\\alpha - \\frac{1+2\\alpha}{2}\n$$\n$$\nb = \\frac{2(1+2\\alpha) - (1+2\\alpha)}{2} = \\frac{1+2\\alpha}{2}\n$$\nThe parameters that satisfy all specified conditions are $a = \\frac{1+2\\alpha}{4}$ and $b = \\frac{1+2\\alpha}{2}$.\nThese choices guarantee that the filter preserves the mean, has a monotonically non-increasing transfer function, does not amplify any modes (ensuring stability), and maximally damps the highest wavenumber (Nyquist) mode by setting its amplitude to zero.", "answer": "$$\n\\boxed{\\left( \\frac{1+2\\alpha}{4}, \\frac{1+2\\alpha}{2} \\right)}\n$$", "id": "3446714"}, {"introduction": "Many complex physical phenomena involve multiple processes acting on different time scales, such as the interplay between wave advection and a stiff relaxation process. Operator splitting methods, like the Lie-Trotter and Strang compositions, are powerful tools for solving such systems by breaking them into simpler parts. This practice [@problem_id:3446676] delves into a subtle but critical source of instability: the error introduced by the splitting itself due to the non-commutativity of the physical operators. Using the Baker-Campbell-Hausdorff expansion as a tool, you will analyze how a first-order splitting can create a spurious growth channel and demonstrate why a symmetric second-order splitting can eliminate this leading-order instability, providing a deeper understanding of the design principles for robust time-stepping schemes in multi-physics applications.", "problem": "Consider the one-dimensional linearized acoustic system with linear relaxation acting on the particle velocity,\n$$\n\\partial_{t} \\begin{pmatrix} u \\\\ p \\end{pmatrix} + A \\,\\partial_{x} \\begin{pmatrix} u \\\\ p \\end{pmatrix} \\;=\\; S \\begin{pmatrix} u \\\\ p \\end{pmatrix},\n$$\nwhere $u(x,t)$ is the velocity fluctuation, $p(x,t)$ is the pressure fluctuation, the advection matrix is\n$$\nA \\;=\\; \\begin{pmatrix} 0 & 1 \\\\ c^{2} & 0 \\end{pmatrix},\n$$\nwith sound speed $c>0$, and the relaxation matrix is\n$$\nS \\;=\\; \\begin{pmatrix} -\\tau^{-1} & 0 \\\\ 0 & 0 \\end{pmatrix},\n$$\nwith relaxation time $\\tau>0$. Assume periodic boundary conditions and analyze a single Fourier mode of wavenumber $k \\in \\mathbb{R}$, so that the semi-discrete temporal evolution of the mode amplitude $\\hat{q}(t) = \\begin{pmatrix} \\hat{u}(t) \\\\ \\hat{p}(t) \\end{pmatrix}$ satisfies\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\,\\hat{q}(t) \\;=\\; L \\,\\hat{q}(t), \n\\qquad L \\;=\\; H + S, \n\\qquad H \\;=\\; -\\,\\mathrm{i}\\,k\\,A.\n$$\nYou will study stability of two time-splitting compositions over one time step $\\Delta t>0$ that split advection and relaxation: the first-order Lie–Trotter composition (advection then relaxation),\n$$\nG_{\\mathrm{LT}}(\\Delta t) \\;=\\; \\exp\\!\\big(\\Delta t\\,S\\big)\\,\\exp\\!\\big(\\Delta t\\,H\\big),\n$$\nand the symmetric second-order Strang composition,\n$$\nG_{\\mathrm{Strang}}(\\Delta t) \\;=\\; \\exp\\!\\big(\\tfrac{\\Delta t}{2}\\,S\\big)\\,\\exp\\!\\big(\\Delta t\\,H\\big)\\,\\exp\\!\\big(\\tfrac{\\Delta t}{2}\\,S\\big).\n$$\nStarting from the Fourier-mode reduction above and using only foundational linear-operator tools, carry out a Baker–Campbell–Hausdorff-type expansion to the first nontrivial order beyond consistency to obtain an effective generator $L_{\\mathrm{eff}}$ such that $\\exp\\!\\big(\\Delta t\\,L_{\\mathrm{eff}}\\big)$ agrees with the one-step map up to the indicated order, for both $G_{\\mathrm{LT}}$ and $G_{\\mathrm{Strang}}$. From this effective generator, derive the leading-order characteristic polynomial for its eigenvalues and determine a neutral-stability threshold in the sense that the real part of at least one eigenvalue transitions from nonpositive to positive at the first nonvanishing order in $\\Delta t$. Specifically:\n\n- For the Lie–Trotter composition $G_{\\mathrm{LT}}$, derive to the lowest order at which splitting error affects the spectral abscissa the analytic condition on $\\Delta t$ and $\\tau$ under which a spurious growth channel appears due solely to the noncommutativity between $H$ and $S$.\n\n- For the Strang composition $G_{\\mathrm{Strang}}$, show that the corresponding leading-order spurious growth mechanism is eliminated by symmetry, restoring boundedness at this order across a broad range of relaxation times.\n\nProvide your final result as the closed-form analytic expression for the critical time step $\\Delta t_{\\mathrm{crit}}(\\tau)$ at which the Lie–Trotter composition first becomes neutrally stable in the above leading-order sense. Express the critical time step in seconds. Do not introduce any additional approximations beyond the specified order of expansion, and do not use any shortcut formulas not derivable from the definitions of the matrices $H$ and $S$, the commutator $[X,Y] = XY - YX$, and standard properties of the matrix exponential. Your final answer must be a single analytic expression.", "solution": "The problem requires a stability analysis of two time-splitting schemes, Lie-Trotter and Strang, for a linearized acoustic system with relaxation. The analysis is to be performed by deriving an effective generator, $L_{\\mathrm{eff}}$, for each scheme using a Baker-Campbell-Hausdorff (BCH) expansion and then examining the eigenvalues of this generator.\n\nThe governing semi-discrete equation for a single Fourier mode $\\hat{q}(t)$ is given by\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\,\\hat{q}(t) \\;=\\; L \\,\\hat{q}(t), \\qquad \\text{where} \\quad L \\;=\\; H + S.\n$$\nThe operators $H$ and $S$ are $2 \\times 2$ matrices defined as:\n$$\nS \\;=\\; \\begin{pmatrix} -\\tau^{-1} & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\nH \\;=\\; -\\mathrm{i}\\,k\\,A \\;=\\; -\\mathrm{i}\\,k\\,\\begin{pmatrix} 0 & 1 \\\\ c^{2} & 0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 & -\\mathrm{i}\\,k \\\\ -\\mathrm{i}\\,k\\,c^{2} & 0 \\end{pmatrix}\n$$\nwhere $k \\in \\mathbb{R}$ is the wavenumber, $c>0$ is the sound speed, and $\\tau>0$ is the relaxation time. The exact evolution is stable, as the eigenvalues of $L=H+S$ can be shown to have non-positive real parts. The splitting schemes can introduce spurious instabilities.\n\nThe analysis relies on the Baker-Campbell-Hausdorff (or Zassenhaus) formula, which for two non-commuting operators $X$ and $Y$ states:\n$$\n\\exp(X)\\exp(Y) = \\exp\\left(X+Y + \\frac{1}{2}[X,Y] + \\frac{1}{12}\\left([X,[X,Y]] - [Y,[X,Y]]\\right) + \\dots\\right)\n$$\nwhere $[X,Y] = XY-YX$ is the commutator.\n\n### Lie–Trotter Composition Analysis\n\nThe first-order Lie–Trotter composition is given by $G_{\\mathrm{LT}}(\\Delta t) = \\exp(\\Delta t\\,S)\\,\\exp(\\Delta t\\,H)$.\nWe can identify an effective generator $L_{\\mathrm{eff}}$ such that $G_{\\mathrm{LT}}(\\Delta t) = \\exp(\\Delta t\\,L_{\\mathrm{eff}})$. Using the BCH formula with $X = \\Delta t\\,S$ and $Y = \\Delta t\\,H$, we have:\n$$\n\\Delta t\\,L_{\\mathrm{eff,LT}} = \\Delta t\\,S + \\Delta t\\,H + \\frac{1}{2}[\\Delta t\\,S, \\Delta t\\,H] + O(\\Delta t^3)\n$$\nDividing by $\\Delta t$ yields the effective generator up to the first order of the splitting error:\n$$\nL_{\\mathrm{eff,LT}} = S + H + \\frac{\\Delta t}{2}[S,H] + O(\\Delta t^2) = L + \\frac{\\Delta t}{2}[S,H] + O(\\Delta t^2)\n$$\nThis is the effective generator to the first nontrivial order beyond consistency (the $O(1)$ term $L$ represents consistency). To analyze stability, we must compute the commutator $[S,H]$:\n$$\nSH = \\begin{pmatrix} -\\tau^{-1} & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & -\\mathrm{i}\\,k \\\\ -\\mathrm{i}\\,k\\,c^{2} & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\mathrm{i}\\,k\\,\\tau^{-1} \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\nHS = \\begin{pmatrix} 0 & -\\mathrm{i}\\,k \\\\ -\\mathrm{i}\\,k\\,c^{2} & 0 \\end{pmatrix} \\begin{pmatrix} -\\tau^{-1} & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ \\mathrm{i}\\,k\\,c^{2}\\,\\tau^{-1} & 0 \\end{pmatrix}\n$$\n$$\n[S,H] = SH - HS = \\begin{pmatrix} 0 & \\mathrm{i}\\,k\\,\\tau^{-1} \\\\ -\\mathrm{i}\\,k\\,c^{2}\\,\\tau^{-1} & 0 \\end{pmatrix}\n$$\nNow we construct the matrix for the effective generator, which we will call $M_{\\mathrm{LT}}$ by truncating the series:\n$$\nM_{\\mathrm{LT}} = L + \\frac{\\Delta t}{2}[S,H] = \\begin{pmatrix} -\\tau^{-1} & -\\mathrm{i}\\,k \\\\ -\\mathrm{i}\\,k\\,c^{2} & 0 \\end{pmatrix} + \\frac{\\Delta t}{2} \\begin{pmatrix} 0 & \\mathrm{i}\\,k\\,\\tau^{-1} \\\\ -\\mathrm{i}\\,k\\,c^2\\,\\Delta t}{2\\tau} & 0 \\end{pmatrix}\n$$\n$$\nM_{\\mathrm{LT}} = \\begin{pmatrix} -\\tau^{-1} & -\\mathrm{i}\\,k + \\frac{\\mathrm{i}\\,k\\,\\Delta t}{2\\tau} \\\\ -\\mathrm{i}\\,k\\,c^{2} - \\frac{\\mathrm{i}\\,k\\,c^2\\,\\Delta t}{2\\tau} & 0 \\end{pmatrix} = \\begin{pmatrix} -\\tau^{-1} & -\\mathrm{i}\\,k\\left(1 - \\frac{\\Delta t}{2\\tau}\\right) \\\\ -\\mathrm{i}\\,k\\,c^{2}\\left(1 + \\frac{\\Delta t}{2\\tau}\\right) & 0 \\end{pmatrix}\n$$\nWe find the eigenvalues $\\lambda$ of $M_{\\mathrm{LT}}$ by solving the characteristic equation $\\det(M_{\\mathrm{LT}} - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -\\tau^{-1} - \\lambda & -\\mathrm{i}\\,k\\left(1 - \\frac{\\Delta t}{2\\tau}\\right) \\\\ -\\mathrm{i}\\,k\\,c^{2}\\left(1 + \\frac{\\Delta t}{2\\tau}\\right) & -\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\tau^{-1} - \\lambda)(-\\lambda) - \\left(-\\mathrm{i}\\,k\\left(1 - \\frac{\\Delta t}{2\\tau}\\right)\\right)\\left(-\\mathrm{i}\\,k\\,c^{2}\\left(1 + \\frac{\\Delta t}{2\\tau}\\right)\\right) = 0\n$$\n$$\n\\lambda(\\lambda + \\tau^{-1}) - (\\mathrm{i}^2 k^2 c^2) \\left(1 - \\left(\\frac{\\Delta t}{2\\tau}\\right)^2\\right) = 0\n$$\n$$\n\\lambda^2 + \\frac{1}{\\tau}\\lambda + k^2 c^2 \\left(1 - \\frac{\\Delta t^2}{4\\tau^2}\\right) = 0\n$$\nThis is the leading-order characteristic polynomial for the eigenvalues of the effective generator. We solve this quadratic equation for $\\lambda$:\n$$\n\\lambda = \\frac{-\\frac{1}{\\tau} \\pm \\sqrt{\\frac{1}{\\tau^2} - 4 k^2 c^2 \\left(1 - \\frac{\\Delta t^2}{4\\tau^2}\\right)}}{2} = -\\frac{1}{2\\tau} \\pm \\frac{1}{2}\\sqrt{\\frac{1}{\\tau^2} - 4k^2c^2 + \\frac{k^2c^2\\Delta t^2}{\\tau^2}}\n$$\nA spurious instability, or growth channel, appears when the real part of at least one eigenvalue becomes positive, i.e., $\\mathrm{Re}(\\lambda)>0$. For this to happen, the term under the square root (the discriminant) must be positive, and the positive root must overcome the negative damping term $-\\frac{1}{2\\tau}$.\nLet the discriminant be $\\mathcal{D} = \\frac{1}{\\tau^2} - 4k^2c^2 + \\frac{k^2c^2\\Delta t^2}{\\tau^2}$. If $\\mathcal{D} < 0$, the roots are complex conjugates with $\\mathrm{Re}(\\lambda) = -\\frac{1}{2\\tau} < 0$, which is stable. If $\\mathcal{D} \\ge 0$, the roots are real, and the largest one is:\n$$\n\\lambda_{+} = -\\frac{1}{2\\tau} + \\frac{1}{2}\\sqrt{\\mathcal{D}}\n$$\nInstability requires $\\lambda_{+} > 0$, which means:\n$$\n\\frac{1}{2}\\sqrt{\\mathcal{D}} > \\frac{1}{2\\tau} \\implies \\mathcal{D} > \\frac{1}{\\tau^2}\n$$\nSubstituting the expression for $\\mathcal{D}$:\n$$\n\\frac{1}{\\tau^2} - 4k^2c^2 + \\frac{k^2c^2\\Delta t^2}{\\tau^2} > \\frac{1}{\\tau^2}\n$$\n$$\n-4k^2c^2 + \\frac{k^2c^2\\Delta t^2}{\\tau^2} > 0\n$$\nAssuming $k\\neq 0$ and $c\\neq 0$, we can divide by $k^2c^2$:\n$$\n-4 + \\frac{\\Delta t^2}{\\tau^2} > 0 \\implies \\frac{\\Delta t^2}{\\tau^2} > 4 \\implies \\Delta t > 2\\tau\n$$\nThe neutral-stability threshold is where the real part of the eigenvalue is exactly zero, which occurs at the boundary of this condition.\n$$\n\\Delta t_{\\mathrm{crit}} = 2\\tau\n$$\n\n### Strang Composition Analysis\n\nThe second-order Strang composition is symmetric: $G_{\\mathrm{Strang}}(\\Delta t) = \\exp(\\frac{\\Delta t}{2} S) \\exp(\\Delta t H) \\exp(\\frac{\\Delta t}{2} S)$.\nThe BCH expansion for a symmetric composition `exp(X/2)exp(Y)exp(X/2)` is known to have improved order of accuracy. The general formula is:\n$$\n\\exp(\\frac{X}{2})\\exp(Y)\\exp(\\frac{X}{2}) = \\exp\\left(X+Y + \\frac{1}{24}[Y,[X,Y]] - \\frac{1}{12}[X,[X,Y]] + \\dots\\right)\n$$\nSetting $X = \\Delta t\\,S$ and $Y = \\Delta t\\,H$, the effective generator $L_{\\mathrm{eff,Strang}}$ is:\n$$\nL_{\\mathrm{eff,Strang}} = S + H + \\frac{\\Delta t^2}{24}\\left([H,[S,H]] - 2[S,[S,H]]\\right) + O(\\Delta t^4)\n$$\nCrucially, the $O(\\Delta t)$ term, which is proportional to $[S,H]$, vanishes.\n$$\nL_{\\mathrm{eff,Strang}} = L + O(\\Delta t^2)\n$$\nThe leading-order error in the generator is of order $\\Delta t^2$, not $\\Delta t$. The spurious growth mechanism found for the Lie-Trotter scheme arose from the $O(\\Delta t)$ term in its effective generator. As this term is absent for the Strang composition due to its symmetry, this specific leading-order instability is eliminated. Any potential instability for the Strang scheme would only appear from higher-order terms in $\\Delta t$, ensuring stability for a much broader range of parameters at this level of analysis.\n\nThe problem asks for the critical time step for the Lie-Trotter composition. Based on the analysis above, this is the value of $\\Delta t$ at which the real part of an eigenvalue of the effective generator becomes zero. This threshold is $\\Delta t = 2\\tau$.", "answer": "$$\\boxed{2\\tau}$$", "id": "3446676"}]}