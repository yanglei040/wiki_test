{"hands_on_practices": [{"introduction": "We begin by exploring the most crucial component that defines the class AM: Arthur's access to randomness. This exercise invites you to consider a hypothetical scenario where the verifier, Arthur, is stripped of his probabilistic power. By analyzing this 'deterministic' version of the protocol, you will see precisely how AM relates to the familiar complexity class NP and gain a deeper appreciation for the role of the random challenge. [@problem_id:1450703]", "problem": "In computational complexity theory, the class AM, which stands for Arthur-Merlin, characterizes languages for which membership can be verified through a two-round interactive protocol. For an input string $x$ of length $n$, the protocol proceeds as follows:\n1.  The verifier, Arthur, who is a probabilistic polynomial-time Turing machine, generates a random string $r$ of length polynomial in $n$ and sends it to the prover, Merlin.\n2.  The prover, Merlin, who has unbounded computational power, receives $r$ and sends back a response string $y$ (the \"proof\") of length polynomial in $n$.\n3.  Arthur then deterministically computes a result based on the input $x$, his random string $r$, and Merlin's response $y$.\n\nA language $L$ is in AM if there exists such a protocol satisfying:\n-   **Completeness:** If $x \\in L$, there is a strategy for Merlin to choose $y$ such that Arthur accepts with probability at least $2/3$ (over the choices of $r$).\n-   **Soundness:** If $x \\notin L$, for any strategy Merlin uses to choose $y$, Arthur accepts with probability at most $1/3$ (over the choices of $r$).\n\nNow, consider a modified version of this class, which we will call DAM (Deterministic-Arthur-Merlin). In the DAM protocol, Arthur is a deterministic polynomial-time Turing machine, meaning he has no access to random bits. Consequently, in the first step, Arthur sends a predefined, empty, or constant string to Merlin, as he cannot generate a random challenge. Merlin then sends his proof $y$, and Arthur makes a final, deterministic decision based on $x$ and $y$.\n\nWhich of the following complexity classes is equivalent to DAM?\n\nA. P (Polynomial time)\n\nB. NP (Nondeterministic Polynomial time)\n\nC. co-NP\n\nD. BPP (Bounded-error Probabilistic Polynomial time)\n\nE. PSPACE (Polynomial Space)", "solution": "Let's analyze the definition of the modified complexity class, DAM (Deterministic-Arthur-Merlin).\n\nThe protocol for a language $L$ in DAM is as follows:\n1.  For a given input string $x$, Arthur, a deterministic polynomial-time machine, prepares a message to send to Merlin. Since Arthur is deterministic and has no access to randomness, his message cannot depend on a random string. He can only compute a message based on $x$. However, the standard AM protocol has Arthur's first message as the *only* source of randomness. In a deterministic variant, this message is fixed (e.g., an empty string) and contains no information that Merlin doesn't already have. Therefore, the first round is trivial, and we can model the protocol as Merlin simply sending a proof string $y$ to Arthur.\n2.  Merlin, with his unbounded computational power, sends a proof string $y$ to Arthur. The length of $y$ must be polynomial in the length of $x$.\n3.  Arthur, a deterministic polynomial-time verifier, receives $y$ and decides whether to accept or reject based on the input $x$ and the proof $y$. Let's denote Arthur's verification procedure by a polynomial-time algorithm $V(x, y)$, which outputs 1 for \"accept\" and 0 for \"reject\".\n\nNow let's translate the completeness and soundness conditions from AM into the context of DAM. Since there is no randomness, the probabilities of acceptance are either 0 or 1.\n\n-   **Completeness:** If $x \\in L$, there must exist a strategy for Merlin such that Arthur accepts. Since Arthur's final decision is deterministic, this means there must exist a proof string $y$ (of polynomial length) such that $V(x, y) = 1$. The \"probability\" is 1, which satisfies the condition of being $\\geq 2/3$.\n\n-   **Soundness:** If $x \\notin L$, for any strategy Merlin uses, Arthur must reject. This means for any proof string $y$ that Merlin could possibly send, Arthur's verification must fail. That is, for all strings $y$ (of polynomial length), $V(x, y) = 0$. The \"probability\" of acceptance is 0, which satisfies the condition of being $\\leq 1/3$.\n\nSo, a language $L$ is in DAM if and only if there exists a deterministic polynomial-time algorithm $V$ and a polynomial function $p$ such that for any input string $x$:\n$x \\in L \\iff \\exists y$ with $|y| \\leq p(|x|)$ such that $V(x, y) = 1$.\n\nThis is precisely the verifier-based definition of the complexity class NP (Nondeterministic Polynomial time). In the context of NP, the string $y$ is called a \"certificate\" or a \"witness\". The definition of NP states that a language $L$ is in NP if there exists a polynomial-time verifier $V$ such that for every $x$, $x \\in L$ if and only if there exists a certificate $y$ of polynomial length in $|x|$ that $V$ accepts.\n\nOur derived definition for DAM is identical to the definition of NP.\n\nLet's consider the other options:\n-   **A. P:** This would be the case if Arthur could decide the language on his own in polynomial time, without needing a proof from Merlin. Our definition allows for problems where finding the proof $y$ might be hard, but verifying it is easy, which is the essence of NP problems that are not known to be in P (like SAT).\n-   **C. co-NP:** A language is in co-NP if its complement is in NP. This means for \"no\" instances ($x \\notin L$), there exists a short proof of non-membership. Our DAM definition requires proofs for \"yes\" instances ($x \\in L$).\n-   **D. BPP:** This class is defined by probabilistic algorithms. We explicitly removed randomness from Arthur, so the resulting class is not probabilistic.\n-   **E. PSPACE:** While NP is contained in PSPACE, there is no reason to believe they are equal. The DAM protocol only grants Arthur polynomial time, not polynomial space, so there is no reason for it to be as powerful as PSPACE.\n\nTherefore, the modified class DAM is equivalent to NP.", "answer": "$$\\boxed{B}$$", "id": "1450703"}, {"introduction": "Moving from foundational definitions to practical design, this next exercise challenges you to construct an efficient interactive protocol for a common problem in linear algebra: determining the rank of a matrix. The goal is to leverage Merlin's power and Arthur's randomness to create a verification process that is much faster than performing the full computation directly. This practice exemplifies how AM protocols can offer elegant and efficient solutions to concrete computational tasks. [@problem_id:1450673]", "problem": "In the field of computational complexity theory, an Arthur-Merlin (AM) protocol is an interactive proof system where a computationally bounded, probabilistic verifier (Arthur) interacts with an all-powerful, but potentially untrustworthy, prover (Merlin). For the purposes of this problem, consider a single-round protocol where Merlin sends a single proof string to Arthur. Arthur then performs a randomized computation, which must be completed in time polynomial in the input size, to decide whether to accept or reject Merlin's claim.\n\nConsider the following decision problem: given an $n \\times n$ matrix $M$ with entries from a large finite field $\\mathbb{F}_q$ and an integer $k$ (where $1 \\leq k \\leq n$), decide if the rank of $M$ is at least $k$. Merlin's goal is to construct a proof to convince Arthur that $\\text{rank}(M) \\geq k$. Arthur's verification algorithm should be highly efficient, ideally avoiding computationally expensive primitives like a full determinant calculation.\n\nWhich of the following describes a correct and efficient protocol for this task, satisfying the conditions of completeness (Arthur accepts a true claim with probability 1) and soundness (Arthur accepts a false claim with a probability of at most 1/2)?\n\nA. Merlin identifies a $k \\times k$ submatrix $A$ of $M$. Arthur chooses two random vectors $u, v \\in \\mathbb{F}_q^k$ and sends them to Merlin. Merlin returns a scalar $\\alpha$ which he claims equals $u^T A v$. Arthur then computes $u^T A v$ himself and accepts if his result matches $\\alpha$.\n\nB. Merlin identifies a $k \\times k$ submatrix $A$ of $M$, which he claims is non-singular, and sends its row and column indices to Arthur. Arthur then chooses $k$ vectors $v_1, \\dots, v_k \\in \\mathbb{F}_q^k$ at random, computes the image vectors $u_i = A v_i$ for $i=1, \\dots, k$, and accepts if the set of vectors $\\{u_1, \\dots, u_k\\}$ is linearly independent.\n\nC. Merlin identifies $k$ columns of $M$ which he claims are linearly independent, forming an $n \\times k$ submatrix $M_C$. He sends the indices of these columns to Arthur. Arthur constructs a random $k \\times n$ matrix $R$ and computes the $k \\times k$ product matrix $P = R M_C$. Arthur accepts if the determinant of $P$ is non-zero.\n\nD. Merlin identifies a $k \\times k$ submatrix $A$ of $M$ that he claims is non-singular. He computes a matrix $B$ that he claims is the inverse of $A$. He sends the indices for $A$ and the matrix $B$ to Arthur. Arthur picks a random vector $v \\in \\mathbb{F}_q^k$, computes $w = Bv$ and then $w' = Aw$. Arthur accepts if $w'$ is equal to the original vector $v$.\n\nE. Merlin identifies a $k \\times k$ submatrix $A$ of $M$ that he claims is non-singular and sends its indices to Arthur. Arthur chooses a random vector $r \\in \\mathbb{F}_q^k$ and sends it to Merlin as a challenge. Merlin then finds and returns a vector $x$ that he claims is the solution to the system $Ax = r$. Arthur accepts if $Ax$ indeed equals $r$.", "solution": "We need a single-round protocol: Merlin sends one proof string; Arthur then performs a randomized polynomial-time verification, with completeness equal to 1 and soundness at most $\\frac{1}{2}$. The decision problem is to verify whether $\\operatorname{rank}(M) \\geq k$. This is equivalent to the existence of a $k \\times k$ nonsingular submatrix $A$ of $M$, since $\\operatorname{rank}(M) \\geq k$ if and only if $M$ has $k$ linearly independent columns (or rows), which is equivalent to having a $k \\times k$ submatrix with nonzero determinant.\n\nConsider option D. Merlin identifies a $k \\times k$ submatrix $A$ and provides a matrix $B$ claimed to be $A^{-1}$. Arthur picks a random $v \\in \\mathbb{F}_{q}^{k}$, computes $w = B v$, then computes $w' = A w = A(Bv)$, and accepts if $w' = v$. The verification predicate is that $A B v = v$. Let $I_{k}$ denote the $k \\times k$ identity matrix.\n\nCompleteness: If $\\operatorname{rank}(M) \\geq k$, there exists a $k \\times k$ nonsingular submatrix $A$. If Merlin sends the correct $B = A^{-1}$, then $A B = I_{k}$. Hence for every $v \\in \\mathbb{F}_{q}^{k}$,\n$$\nA(B v) = (A B) v = I_{k} v = v,\n$$\nso Arthur accepts with probability $1$ over his randomness. Thus completeness is $1$.\n\nSoundness: If $\\operatorname{rank}(M) < k$, then every $k \\times k$ submatrix $A$ is singular, so there does not exist any $B$ such that $A B = I_{k}$. For any $B$ Merlin sends, define the error matrix\n$$\nE \\triangleq A B - I_{k}.\n$$\nSince $A$ is singular, $E \\neq 0$. Arthur accepts if and only if $E v = 0$. For a uniformly random $v \\in \\mathbb{F}_{q}^{k}$, the acceptance probability equals\n$$\n\\Pr_{v \\leftarrow \\mathbb{F}_{q}^{k}}[E v = 0] = \\frac{|\\ker(E)|}{q^{k}} = \\frac{q^{\\dim \\ker(E)}}{q^{k}}.\n$$\nBecause $E \\neq 0$, we have $\\operatorname{rank}(E) \\geq 1$, so by the rank-nullity theorem,\n$$\n\\dim \\ker(E) = k - \\operatorname{rank}(E) \\leq k - 1,\n$$\nwhich implies\n$$\n\\Pr[\\text{accept}] \\leq \\frac{q^{k-1}}{q^{k}} = \\frac{1}{q} \\leq \\frac{1}{2}.\n$$\nThus soundness is at most $\\frac{1}{2}$. Arthur’s computation uses only matrix-vector multiplications over $\\mathbb{F}_{q}$ in $O(k^{2})$ field operations and extraction of $A$’s entries from $M$, avoiding full determinant computation.\n\nNow consider the other options:\n\nA. This is multi-round (Arthur sends $u, v$ to Merlin) and does not test nonsingularity: equality of $u^{T} A v$ can hold regardless of whether $A$ is singular. It fails both the single-round constraint and soundness.\n\nB. Merlin sends indices of a $k \\times k$ submatrix $A$. Arthur picks random $v_{1},\\dots,v_{k} \\in \\mathbb{F}_{q}^{k}$ and accepts if $\\{A v_{i}\\}$ are linearly independent. Even if $A$ is nonsingular, the randomly chosen $\\{v_{i}\\}$ can be linearly dependent with positive probability, causing rejection on a true claim. Therefore completeness is less than $1$, violating the requirement.\n\nC. Merlin sends indices of $k$ independent columns, forming $M_{C}$. Arthur picks random $R \\in \\mathbb{F}_{q}^{k \\times n}$ and accepts if $\\det(R M_{C}) \\neq 0$. When $M_{C}$ has full column rank, $R M_{C}$ is distributed uniformly over $\\mathbb{F}_{q}^{k \\times k}$ as $R$ varies uniformly, so\n$$\n\\Pr[\\det(R M_{C}) \\neq 0] = \\prod_{i=0}^{k-1} \\left(1 - q^{i-k}\\right) < 1,\n$$\nhence completeness is less than $1$, violating the requirement.\n\nE. This is a standard interactive proof: Arthur sends a random $r \\in \\mathbb{F}_{q}^{k}$, Merlin returns $x$ with $A x = r$. It has completeness $1$ and soundness at most $\\frac{1}{q}$, but it is not single-round, since Arthur sends a challenge to Merlin. Therefore it violates the single-round constraint.\n\nOnly D satisfies single-round, completeness $1$, soundness at most $\\frac{1}{2}$, and efficiency.", "answer": "$$\\boxed{D}$$", "id": "1450673"}, {"introduction": "Our final practice delves into arithmetization, a powerful technique that allows us to translate logical formulas into algebraic expressions, forming the basis for some of the most advanced interactive proofs. You will analyze a key step in the famous sum-check protocol, which is used to count satisfying assignments for a SAT formula. This exercise provides a hands-on calculation of the protocol's soundness, illustrating how the properties of polynomials over finite fields guarantee the verifier's confidence. [@problem_id:1450706]", "problem": "An Arthur-Merlin (AM) protocol is a type of interactive proof system where a probabilistic polynomial-time verifier (Arthur) interacts with an all-powerful but untrustworthy prover (Merlin). Consider a protocol designed to verify claims about the number of satisfying assignments for a 3-Satisfiability (3-SAT) formula. The 3-SAT problem asks if a given Boolean formula, in conjunctive normal form where each clause has exactly three literals, can be satisfied.\n\nThe protocol uses the technique of arithmetization over a finite field $\\mathbb{F}_p$, where $p$ is a large prime number. A given 3-SAT formula $\\phi$ with $n$ variables ($x_1, \\dots, x_n$) and $m$ clauses is converted into a multivariate polynomial $P(z_1, \\dots, z_n)$. The conversion rules are as follows:\n1.  A literal $x_i$ is mapped to the integer variable $z_i$.\n2.  A negated literal $\\neg x_i$ is mapped to the expression $(1-z_i)$.\n3.  A clause, which is a disjunction of three literals (e.g., $L_a \\lor L_b \\lor L_c$), is converted to a polynomial that evaluates to 1 if the clause is true (for inputs in $\\{0,1\\}$) and 0 if it is false. This is achieved by taking $1$ minus the product of the expressions for the negations of the literals. For example, the clause $(x_a \\lor \\neg x_b \\lor x_c)$ becomes the polynomial $1 - (1-z_a)z_b(1-z_c)$.\n4.  The entire formula $\\phi$, being a conjunction of $m$ clauses, is converted to the polynomial $P(z_1, \\dots, z_n)$ by taking the product of the polynomials corresponding to its $m$ individual clauses.\n\nThe total number of satisfying assignments for $\\phi$ is thus given by the sum $K = \\sum_{z_1 \\in \\{0,1\\}} \\dots \\sum_{z_n \\in \\{0,1\\}} P(z_1, \\dots, z_n)$.\n\nSuppose Merlin claims the value of this sum is $K_M$. The protocol proceeds in rounds. In the first round, to check the claim, Arthur asks Merlin to provide the univariate polynomial $S_1(z_1) = \\sum_{z_2 \\in \\{0,1\\}} \\dots \\sum_{z_n \\in \\{0,1\\}} P(z_1, z_2, \\dots, z_n)$. Let's say Merlin responds with a polynomial $M_1(z_1)$.\n\nArthur performs two checks:\na) He verifies if $M_1(0) + M_1(1) = K_M$. If this check fails, he rejects immediately.\nb) If the check passes, he chooses a value $r_1$ uniformly at random from the field $\\mathbb{F}_p$ and proceeds to the next round, where he will try to verify that the value $M_1(r_1)$ is correct.\n\nNow, assume the original formula $\\phi$ is actually unsatisfiable, so the true sum is $K=0$. However, a cheating Merlin claims $K_M \\neq 0$ and provides a fraudulent polynomial $M_1(z_1)$ that is not the true polynomial $S_1(z_1)$ but is constructed to pass check (a), i.e., $M_1(0) + M_1(1) = K_M$. Arthur is fooled in this round if he picks a random $r_1$ where the fraudulent polynomial coincidentally agrees with the correct one, i.e., $M_1(r_1) = S_1(r_1)$.\n\nFor a 3-SAT formula with $m$ clauses and a field of size $p$, what is the maximum possible probability that Arthur is fooled in this first round? Express your answer as a closed-form analytic expression in terms of $m$ and $p$.", "solution": "By the arithmetization given, each clause is mapped to a polynomial of total degree at most 3, and in any individual variable $z_{i}$, each clause contributes degree at most $1$ (because in the product forming a clause polynomial, at most one factor depends on any fixed $z_{i}$, and that dependence is linear). For a fixed variable $z_{1}$, the degree of the full formula polynomial $P$ in $z_{1}$ equals the number of clauses in which $x_{1}$ appears (positively or negated), hence\n$$\n\\deg_{z_{1}} P \\leq m.\n$$\nDefine\n$$\nS_{1}(z_{1})=\\sum_{z_{2}\\in\\{0,1\\}}\\cdots\\sum_{z_{n}\\in\\{0,1\\}} P(z_{1},z_{2},\\dots,z_{n}).\n$$\nSummation over $(z_{2},\\dots,z_{n})\\in\\{0,1\\}^{n-1}$ does not increase the degree in $z_{1}$, so\n$$\n\\deg S_{1} \\leq \\deg_{z_{1}} P \\leq m.\n$$\n\nLet the cheating prover send $M_{1}(z_{1})\\neq S_{1}(z_{1})$ but satisfying $M_{1}(0)+M_{1}(1)=K_{M}$. Consider the difference polynomial\n$$\nD(z_{1}) := M_{1}(z_{1}) - S_{1}(z_{1}).\n$$\nSince $M_{1}\\neq S_{1}$ as polynomials, $D$ is a nonzero univariate polynomial over $\\mathbb{F}_{p}$. In the standard sum-check protocol, Arthur enforces that $M_{1}$ have degree at most the known bound $\\deg S_{1}\\leq m$, hence\n$$\n\\deg D \\leq \\max\\{\\deg M_{1},\\deg S_{1}\\} \\leq m.\n$$\nArthur is fooled in this round precisely when $M_{1}(r_{1})=S_{1}(r_{1})$, i.e., when $D(r_{1})=0$, for a uniformly random $r_{1}\\in\\mathbb{F}_{p}$. By the Schwartz–Zippel lemma, a nonzero univariate polynomial of degree at most $m$ over $\\mathbb{F}_{p}$ has at most $m$ roots in $\\mathbb{F}_{p}$. Therefore,\n$$\n\\Pr_{r_{1}\\leftarrow \\mathbb{F}_{p}}\\big[M_{1}(r_{1})=S_{1}(r_{1})\\big]\n=\\Pr_{r_{1}\\leftarrow \\mathbb{F}_{p}}\\big[D(r_{1})=0\\big]\n\\leq \\frac{\\deg D}{p} \\leq \\frac{m}{p}.\n$$\nThis bound is tight in the sense that a nonzero polynomial of degree $m$ can have $m$ distinct roots, yielding success probability $m/p$.\n\nThus, the maximum possible probability that Arthur is fooled in the first round is $\\frac{m}{p}$ (and never exceeds $1$).", "answer": "$$\\boxed{\\frac{m}{p}}$$", "id": "1450706"}]}