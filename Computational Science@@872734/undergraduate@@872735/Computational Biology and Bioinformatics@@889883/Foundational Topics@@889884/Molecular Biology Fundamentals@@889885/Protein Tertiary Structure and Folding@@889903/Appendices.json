{"hands_on_practices": [{"introduction": "A primary driving force for protein folding is the hydrophobic effect, which sequesters nonpolar side chains into the protein's core, away from the aqueous solvent. The efficiency of this packing is a critical determinant of a protein's overall stability. This exercise [@problem_id:2422553] provides a quantitative approach to understanding this principle by having you calculate the packing density for a hypothetical protein core and compare it to the theoretical maximum, offering tangible insight into the solid-like nature of a protein's interior.", "problem": "A globular protein’s hydrophobic core is approximated as a sphere of radius $12~\\text{\\AA}$. The core contains the following buried side chains, whose van der Waals volumes (assumed additive for this model) are given in cubic ångströms ($\\text{\\AA}^3$):\n\n- Phenylalanine (Phe): $3$ residues, each with volume $189$\n- Leucine (Leu): $6$ residues, each with volume $166$\n- Isoleucine (Ile): $3$ residues, each with volume $166$\n- Valine (Val): $5$ residues, each with volume $140$\n- Methionine (Met): $2$ residues, each with volume $166$\n- Tyrosine (Tyr): $1$ residue, volume $193$\n- Tryptophan (Trp): $1$ residue, volume $227$\n- Alanine (Ala): $4$ residues, each with volume $88$\n- Threonine (Thr): $2$ residues, each with volume $116$\n- Cysteine (Cys): $2$ residues, each with volume $108$\n- Proline (Pro): $2$ residues, each with volume $112$\n\nUnder this simplified model, the side-chain packing density of the core is defined as the fraction of the core’s volume occupied by the buried side chains. The theoretical maximum packing density for uniform spheres (Kepler close packing) is $0.74048$.\n\nCompute the ratio of the core’s side-chain packing density to $0.74048$. Express your final answer as a dimensionless decimal number rounded to four significant figures. Do not include units in your final answer.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It is based on a standard, albeit simplified, model used in structural bioinformatics for analyzing protein packing. All necessary data are provided, and the definitions are unambiguous. The problem is valid and a solution will be provided.\n\nThe primary task is to compute the ratio of the calculated side-chain packing density, $\\rho_{\\text{packing}}$, to the theoretical maximum packing density for uniform spheres, $\\rho_{\\text{max}}$. The packing density is defined as the fraction of the core's volume occupied by the constituent side chains.\n\nFirst, we must calculate the total van der Waals volume of all the buried side chains, denoted as $V_{\\text{sc}}$. This is the sum of the volumes of each individual side chain. The problem provides the counts and volumes for each residue type.\n\nThe sum is calculated as follows:\n$V_{\\text{sc}} = (3 \\times 189) + (6 \\times 166) + (3 \\times 166) + (5 \\times 140) + (2 \\times 166) + (1 \\times 193) + (1 \\times 227) + (4 \\times 88) + (2 \\times 116) + (2 \\times 108) + (2 \\times 112)~\\text{\\AA}^3$.\n\nPerforming the multiplication for each term:\n$V_{\\text{Phe}} = 3 \\times 189 = 567~\\text{\\AA}^3$\n$V_{\\text{Leu}} = 6 \\times 166 = 996~\\text{\\AA}^3$\n$V_{\\text{Ile}} = 3 \\times 166 = 498~\\text{\\AA}^3$\n$V_{\\text{Val}} = 5 \\times 140 = 700~\\text{\\AA}^3$\n$V_{\\text{Met}} = 2 \\times 166 = 332~\\text{\\AA}^3$\n$V_{\\text{Tyr}} = 1 \\times 193 = 193~\\text{\\AA}^3$\n$V_{\\text{Trp}} = 1 \\times 227 = 227~\\text{\\AA}^3$\n$V_{\\text{Ala}} = 4 \\times 88 = 352~\\text{\\AA}^3$\n$V_{\\text{Thr}} = 2 \\times 116 = 232~\\text{\\AA}^3$\n$V_{\\text{Cys}} = 2 \\times 108 = 216~\\text{\\AA}^3$\n$V_{\\text{Pro}} = 2 \\times 112 = 224~\\text{\\AA}^3$\n\nSumming these values gives the total side-chain volume:\n$$V_{\\text{sc}} = 567 + 996 + 498 + 700 + 332 + 193 + 227 + 352 + 232 + 216 + 224 = 4537~\\text{\\AA}^3$$\n\nNext, we calculate the volume of the hydrophobic core, $V_{\\text{core}}$, which is approximated as a sphere with radius $R = 12~\\text{\\AA}$. The volume of a sphere is given by the formula:\n$$V_{\\text{core}} = \\frac{4}{3}\\pi R^3$$\nSubstituting the given radius:\n$$V_{\\text{core}} = \\frac{4}{3}\\pi (12~\\text{\\AA})^3 = \\frac{4}{3}\\pi (1728)~\\text{\\AA}^3 = 2304\\pi~\\text{\\AA}^3$$\n\nThe side-chain packing density, $\\rho_{\\text{packing}}$, is the ratio of the total side-chain volume to the core volume:\n$$\\rho_{\\text{packing}} = \\frac{V_{\\text{sc}}}{V_{\\text{core}}} = \\frac{4537}{2304\\pi}$$\n\nThe problem requires computing the ratio of this packing density to the theoretical maximum packing density, $\\rho_{\\text{max}} = 0.74048$. Let this required ratio be $\\mathcal{R}$.\n$$\\mathcal{R} = \\frac{\\rho_{\\text{packing}}}{\\rho_{\\text{max}}} = \\frac{\\frac{4537}{2304\\pi}}{0.74048} = \\frac{4537}{2304 \\times 0.74048 \\times \\pi}$$\n\nNow, we perform the numerical evaluation:\n$$V_{\\text{core}} = 2304\\pi \\approx 2304 \\times 3.14159265 \\approx 7238.229~\\text{\\AA}^3$$\n$$\\rho_{\\text{packing}} = \\frac{4537}{7238.229} \\approx 0.626815$$\n$$\\mathcal{R} = \\frac{0.626815}{0.74048} \\approx 0.846490$$\n\nThe problem requires the answer to be rounded to four significant figures. The fifth significant figure is $9$, which is greater than or equal to $5$, so we round up the fourth digit.\n$$\\mathcal{R} \\approx 0.8465$$\nThis dimensionless value represents the packing efficiency of the protein core relative to the ideal close-packing of uniform spheres.", "answer": "$$\\boxed{0.8465}$$", "id": "2422553"}, {"introduction": "While global principles like the hydrophobic effect provide the overall driving force for folding, the specific three-dimensional structure is exquisitely encoded in the amino acid sequence. Certain residues possess unique conformational properties that are instrumental in forming essential structural motifs like turns and loops. This practice [@problem_id:2422509] challenges you to reason about the profound structural consequences of a single point mutation, replacing a conformationally rigid proline with a highly flexible glycine within a $\\beta$-turn, thereby deepening your understanding of how local sequence dictates local structure and stability.", "problem": "A $\\beta$-turn is a local motif of $4$ consecutive residues in which the carbonyl oxygen of residue $i$ forms a backbone hydrogen bond to the amide hydrogen of residue $i+3$, reversing the chain direction. Consider a small $\\beta$-hairpin whose turn is a Type I $\\beta$-turn with Proline at position $i+1$. The peptide bond preceding the Proline is in the trans configuration, and the canonical $i \\rightarrow i+3$ backbone hydrogen bond is observed between residues $i$ and $i+3$. A point mutation replaces this Proline at $i+1$ with Glycine, with no other sequence changes and no change in solvent conditions.\n\nWhich of the following is the most plausible structural consequence of this Proline $\\to$ Glycine mutation within the folded ensemble?\n\nA. The local turn is thermodynamically destabilized due to increased backbone conformational entropy at position $i+1$, decreasing the population of the native Type I geometry, while the canonical $i \\rightarrow i+3$ hydrogen bond remains possible because residue $i+3$ is unchanged.\n\nB. The local turn is thermodynamically stabilized because Glycine favors the positive $\\phi$ backbone dihedral required at position $i+1$ in a Type I $\\beta$-turn, reducing strain relative to Proline.\n\nC. The mutation introduces a new backbone hydrogen bond donor at position $i+1$, strengthening the canonical $i \\rightarrow i+3$ hydrogen bond and thereby stabilizing the turn.\n\nD. The stability and geometry of the turn are unaffected because $\\beta$-turn type and stability depend solely on the identity of residue $i+2$, not residue $i+1$.\n\nE. The turn converts to a Type II $\\beta$-turn because Glycine is most compatible with the required backbone dihedrals at position $i+1$, making the Type II geometry more favorable than Type I.", "solution": "The structural role of Proline and Glycine in turns can be reasoned from first principles of backbone conformational preferences and hydrogen bonding geometry.\n\nDefinitions and baseline:\n- A $\\beta$-turn involves $4$ residues ($i$ to $i+3$) and is characterized by a backbone hydrogen bond from the carbonyl of residue $i$ to the amide of residue $i+3$.\n- Type I $\\beta$-turns have characteristic backbone dihedral angles $(\\phi, \\psi)$ at positions $i+1$ and $i+2$ that place the chain into a tight reversal, typically with $\\phi$ at $i+1$ near approximately $-60^\\circ$ and a negative $\\psi$. The exact values are not needed; what matters is that they are in regions commonly accessible to most residues with restricted $\\phi,\\psi$.\n- Proline has a cyclic side chain that restricts the backbone $\\phi$ angle near about $-60^\\circ$, reducing conformational entropy and preorganizing the local backbone toward turn-compatible conformations. Proline also lacks a backbone amide hydrogen when it occupies a position, so it cannot donate a backbone hydrogen bond at its own position.\n- Glycine, lacking a side chain beyond hydrogen, has the broadest allowed region on the Ramachandran map and thus the highest backbone conformational entropy in the unfolded state. Constraining Glycine into a specific set of $(\\phi,\\psi)$ incurs a larger entropic penalty than for most residues, which thermodynamically disfavors tight, well-defined local structure unless compensated by strong interactions. Glycine is frequently found at positions requiring disallowed backbone regions for other residues, such as positive $\\phi$ in Type II turns at $i+2$.\n\nNow consider the mutation Proline $\\to$ Glycine at position $i+1$ in a Type I $\\beta$-turn with a trans peptide bond preceding it and a canonical $i \\rightarrow i+3$ hydrogen bond present:\n\n- Thermodynamics: Replacing Proline with Glycine removes the conformational restriction that preorganizes the turn. The unfolded-state conformational entropy at $i+1$ increases (more states available), which increases the entropic cost of fixing the backbone into the Type I turn geometry upon folding. Unless compensated by stronger enthalpic interactions, this shift reduces the population of the precise Type I geometry in the folded ensemble. Thus the local turn is likely thermodynamically destabilized.\n- Hydrogen bonding: The canonical $i \\rightarrow i+3$ hydrogen bond involves the donor at residue $i+3$ and acceptor at residue $i$. Changing residue $i+1$ does not remove the donor at $i+3$; therefore, in principle, this hydrogen bond can still form if the turn geometry is attained.\n- Turn type specificity: Type II $\\beta$-turns often require Glycine at position $i+2$ due to a required positive $\\phi$ angle at $i+2$ that is disallowed for most residues. Glycine at $i+1$ does not specifically enable the Type II geometry. Therefore, a Proline $\\to$ Glycine mutation at $i+1$ does not intrinsically favor conversion to a Type II turn.\n- Position dependence: The identity of residue $i+1$ is important in turn formation, not solely the identity at $i+2$; Proline at $i+1$ is a known promoter of Type I/II turns due to its restricted $\\phi$.\n\nOption-by-option analysis:\n\nA. This option states that the turn is destabilized due to increased conformational entropy at $i+1$ after replacing Proline with Glycine, reducing the population of the native Type I turn, but that the canonical $i \\rightarrow i+3$ hydrogen bond remains possible because residue $i+3$ is unchanged. This follows directly from the entropic considerations of Glycine versus Proline and the fact that the hydrogen bond donor resides at $i+3$. Verdict: Correct.\n\nB. This option claims stabilization because Glycine favors positive $\\phi$ at $i+1$ in a Type I turn. Type I turns do not require a positive $\\phi$ at $i+1$; they typically have a negative $\\phi$ near $-60^\\circ$, which Proline naturally adopts. Glycine does not intrinsically stabilize this; its greater flexibility increases the entropic cost of ordering. Verdict: Incorrect.\n\nC. This option suggests that adding an amide hydrogen at $i+1$ creates or strengthens the canonical $i \\rightarrow i+3$ hydrogen bond. The canonical hydrogen bond donor is the amide at residue $i+3$, not at $i+1$. While Glycine at $i+1$ does possess a backbone NH (unlike Proline), that NH is not the donor in the defining turn hydrogen bond. Therefore, this reasoning is incorrect for the canonical stabilizing interaction. Verdict: Incorrect.\n\nD. This option asserts that turn stability and geometry depend solely on residue $i+2$. Both $i+1$ and $i+2$ strongly influence turn type and stability; Proline at $i+1$ is a well-known turn promoter. Thus, ignoring the role of $i+1$ is erroneous. Verdict: Incorrect.\n\nE. This option predicts conversion to a Type II turn because Glycine is now at $i+1$. Glycine’s special role in Type II turns is at position $i+2$ (to accommodate a positive $\\phi$ angle), not $i+1$. A Glycine at $i+1$ does not specifically drive a Type II geometry. Verdict: Incorrect.\n\nTherefore, the most plausible structural consequence is given in option A.", "answer": "$$\\boxed{A}$$", "id": "2422509"}, {"introduction": "To unravel the complexities of protein folding, scientists often use simplified computational models that capture the most essential physics. The Hydrophobic-Polar (HP) lattice model is a cornerstone of this approach, reducing the folding problem to its energetic essence: minimizing the exposure of hydrophobic residues. This hands-on coding exercise [@problem_id:2422555] guides you in building a folding simulation from the ground up, where you will implement both the energy function and a Monte Carlo algorithm to search for the lowest-energy conformation, providing a practical understanding of how computational methods are used to explore protein energy landscapes.", "problem": "You are to implement a complete, runnable program that models protein folding on a two-dimensional square lattice under the Hydrophobic–Polar (HP) model and evaluates two folding strategies on the same initial conformation of a given amino acid sequence: a deterministic manual sequence of pivot moves and a stochastic dynamics defined as a discrete-time Markov chain. All computations must be grounded in first principles of the HP-lattice model, and all mathematical symbols, variables, operators, and numbers must be written using LaTeX.\n\nA protein of length $N$ with residues indexed $0,1,\\dots,N-1$ is represented by a sequence $S$ over the alphabet $\\{\\mathrm{H},\\mathrm{P}\\}$, where $\\mathrm{H}$ denotes hydrophobic and $\\mathrm{P}$ denotes polar. A conformation of $S$ is a mapping of indices to coordinates $\\mathbf{r}_i \\in \\mathbb{Z}^2$ such that for all $i \\in \\{0,\\dots,N-2\\}$, the Manhattan distance between consecutive residues is unity, that is $\\|\\mathbf{r}_{i+1}-\\mathbf{r}_i\\|_1=1$, and $\\mathbf{r}_i \\neq \\mathbf{r}_j$ for all $i \\neq j$ (self-avoiding walk). For all test cases, the initial conformation is the straight line along the $x$-axis:\n$$\n\\mathbf{r}_i^{(0)} = (i,0) \\quad \\text{for } i \\in \\{0,1,\\dots,N-1\\}.\n$$\n\nThe HP energy $E$ of a conformation $\\{\\mathbf{r}_i\\}_{i=0}^{N-1}$ for sequence $S$ is defined as\n$$\nE = -\\sum_{\\substack{0 \\le i < j \\le N-1 \\\\ |i-j| > 1}} \\left[ S_i=\\mathrm{H} \\wedge S_j=\\mathrm{H} \\wedge \\|\\mathbf{r}_i - \\mathbf{r}_j\\|_1 = 1 \\right],\n$$\nwhere $[\\cdot]$ denotes the indicator that evaluates to $1$ if the condition is true and $0$ otherwise. Each non-consecutive hydrophobic–hydrophobic contact contributes $-1$ to $E$. The energy is dimensionless.\n\nAn elementary pivot move is parameterized by an index $k \\in \\{1,2,\\dots,N-2\\}$ and a rotation angle $a \\in \\{+90,-90,180\\}$ (angles in degrees). The move acts by rotating, about the fixed pivot position $\\mathbf{r}_k$, the suffix coordinates $\\{\\mathbf{r}_{k+1},\\dots,\\mathbf{r}_{N-1}\\}$ by the specified angle in the plane. If the resulting configuration violates self-avoidance, the move is invalid and has no effect (the conformation remains unchanged). Otherwise, the move is valid and updates the conformation. All rotations must be exact lattice rotations:\n- For $a=+90$, apply the counterclockwise rotation matrix $\\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}$.\n- For $a=-90$, apply the clockwise rotation matrix $\\begin{pmatrix}0 & 1 \\\\ -1 & 0\\end{pmatrix}$.\n- For $a=180$, apply the rotation matrix $\\begin{pmatrix}-1 & 0 \\\\ 0 & -1\\end{pmatrix}$.\n\nTwo folding strategies must be evaluated for each test case:\n\n1. Manual guidance: Given an ordered list of pivot moves $\\{(k_m,a_m)\\}_{m=1}^M$ with each $k_m \\in \\{1,\\dots,N-2\\}$ and $a_m \\in \\{+90,-90,180\\}$ (angles in degrees), apply them sequentially to the initial conformation. Any invalid move leaves the conformation unchanged for that step. After all moves have been attempted, compute the energy $E_{\\mathrm{manual}}$ of the resulting conformation.\n\n2. Automated stochastic dynamics: Starting from the initial conformation, consider a discrete-time Markov chain with the following transition at each step $t=1,2,\\dots,T_{\\max}$:\n   - Draw $k$ uniformly from $\\{1,2,\\dots,N-2\\}$ and $a$ uniformly from $\\{+90,-90,180\\}$ (angles in degrees). Propose the corresponding pivot move.\n   - If the proposed move is invalid, the conformation remains unchanged at step $t$.\n   - If the move is valid, compute $\\Delta E = E_{\\text{proposed}} - E_{\\text{current}}$ and accept the move with probability $p_{\\text{acc}} = \\min\\{1, \\exp(-\\Delta E / T)\\}$, where $T$ is the temperature and the Boltzmann constant is set to unity so that $T$ is dimensionless. If accepted, update the conformation to the proposed one; otherwise, retain the current conformation.\n   - Let $E_{\\mathrm{best}}$ denote the lowest energy observed up to and including step $t$ (including the initial conformation at step $0$).\nThe stochastic process must be initialized with a specified integer pseudorandom seed for reproducibility. The output of this strategy is $E_{\\mathrm{auto}} = E_{\\mathrm{best}}$ after $T_{\\max}$ steps.\n\nYour program must implement the above definitions exactly and produce results for the following test suite. In all cases, angles are in degrees, energies are dimensionless integers, and indices are zero-based with pivot indices constrained to $k \\in \\{1,2,\\dots,N-2\\}$.\n\nTest suite:\n- Case A:\n  - Sequence $S = \\text{\"HHHH\"}$ with length $N=4$.\n  - Manual moves: $\\big[(1,+90),(2,+90)\\big]$.\n  - Temperature $T = 1$.\n  - Stochastic steps $T_{\\max} = 0$.\n  - Seed $= 1$.\n- Case B:\n  - Sequence $S = \\text{\"HPHPHPHP\"}$ with length $N=8$.\n  - Manual moves: empty list $\\big[\\ \\big]$.\n  - Temperature $T = 1$.\n  - Stochastic steps $T_{\\max} = 0$.\n  - Seed $= 2$.\n- Case C:\n  - Sequence $S = \\text{\"HHHHHH\"}$ with length $N=6$.\n  - Manual moves: $\\big[(1,+90),(2,+90),(4,-90)\\big]$.\n  - Temperature $T = 1$.\n  - Stochastic steps $T_{\\max} = 0$.\n  - Seed $= 3$.\n\nRequired final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a two-element list $[E_{\\mathrm{manual}}, E_{\\mathrm{auto}}]$. For example, an output with three test cases should look like\n$$\n\\big[ [e_1^{\\mathrm{man}}, e_1^{\\mathrm{auto}}], [e_2^{\\mathrm{man}}, e_2^{\\mathrm{auto}}], [e_3^{\\mathrm{man}}, e_3^{\\mathrm{auto}}] \\big].\n$$", "solution": "The problem statement is valid. It is scientifically grounded in the well-established Hydrophobic-Polar (HP) lattice model, a cornerstone of simplified protein folding studies. The problem is well-posed, providing all necessary definitions, initial conditions, and parameters to derive a unique solution. The language is objective and mathematically precise. I will now proceed with a complete solution.\n\nThe solution requires the implementation of a simulation of protein folding on a two-dimensional square lattice, governed by the HP model. A protein is abstracted as a sequence $S$ of length $N$ over the alphabet $\\{\\mathrm{H}, \\mathrm{P}\\}$, representing hydrophobic and polar residues, respectively. The conformation of this chain is a self-avoiding walk on the integer grid $\\mathbb{Z}^2$, represented by a series of coordinates $\\{\\mathbf{r}_i\\}_{i=0}^{N-1}$ where $\\mathbf{r}_i = (x_i, y_i)$. For all test cases, the chain starts in a fully extended linear conformation along the x-axis, i.e., $\\mathbf{r}_i^{(0)} = (i,0)$.\n\nThe core of the HP model is its energy function, which posits that the hydrophobic effect is the dominant force in protein folding. The energy $E$ of a given conformation is calculated by counting the number of topological contacts between non-adjacent hydrophobic residues. A contact is formed if two such residues occupy adjacent lattice sites. The energy is given by:\n$$\nE = -\\sum_{\\substack{0 \\le i < j \\le N-1 \\\\ |i-j| > 1}} \\left[ S_i=\\mathrm{H} \\wedge S_j=\\mathrm{H} \\wedge \\|\\mathbf{r}_i - \\mathbf{r}_j\\|_1 = 1 \\right]\n$$\nwhere $[\\cdot]$ is the Iverson bracket. Each such H-H contact contributes $-1$ to the total energy, so conformations with lower (more negative) energy are more stable. To implement this, we identify all indices corresponding to $\\mathrm{H}$ residues. We then iterate through all pairs of these indices $(i, j)$ such that $j > i+1$ and compute the Manhattan distance $\\|\\mathbf{r}_i - \\mathbf{r}_j\\|_1 = |x_i - x_j| + |y_i - y_j|$. If the distance is $1$, we decrement the energy counter. The initial linear conformation has an energy of $E=0$ as no non-adjacent residues are in contact.\n\nConformational changes are modeled by pivot moves. A pivot move is defined by an index $k \\in \\{1, 2, \\dots, N-2\\}$ and a rotation angle $a \\in \\{+90, -90, 180\\}$ degrees. The residue at $\\mathbf{r}_k$ acts as a pivot, and the subchain from residue $k+1$ to $N-1$ is rotated rigidly around it. The coordinates of the prefix, $\\{\\mathbf{r}_0, \\dots, \\mathbf{r}_k\\}$, remain fixed. For each point $\\mathbf{r}_i$ in the suffix ($i > k$), its new position $\\mathbf{r}'_i$ is found by rotating the vector $\\mathbf{v}_i = \\mathbf{r}_i - \\mathbf{r}_k$ about the origin and adding it back to the pivot coordinate: $\\mathbf{r}'_i = \\mathbf{r}_k + R_a \\mathbf{v}_i$. The rotation matrices $R_a$ for the plane are:\n$$\nR_{+90} = \\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}, \\quad R_{-90} = \\begin{pmatrix}0 & 1 \\\\ -1 & 0\\end{pmatrix}, \\quad R_{180} = \\begin{pmatrix}-1 & 0 \\\\ 0 & -1\\end{pmatrix}\n$$\nA move is valid only if the resulting conformation is self-avoiding, meaning all coordinates $\\mathbf{r}'_i$ are unique. This is verified by checking if the set of coordinate tuples has size $N$. If a move is invalid, the conformation does not change.\n\nTwo strategies for folding are evaluated:\n\n1.  **Manual Guidance:** A predetermined sequence of pivot moves is applied serially. Starting from the initial linear conformation, each move $(k_m, a_m)$ is attempted. If valid, the conformation is updated. If invalid, it is discarded, and the next move is attempted on the unchanged conformation. After all moves are processed, the final energy $E_{\\mathrm{manual}}$ is computed.\n\n2.  **Automated Stochastic Dynamics:** This strategy employs a Metropolis-Hastings Monte Carlo simulation, a discrete-time Markov chain process, to explore the conformational space. Starting from the initial conformation, the simulation proceeds for $T_{\\max}$ steps. At each step $t$:\n    - A random pivot move is proposed by selecting $k$ uniformly from $\\{1, \\dots, N-2\\}$ and $a$ uniformly from $\\{+90, -90, 180\\}$.\n    - The validity of the move is checked. If invalid, the conformation remains unchanged for this step.\n    - If the move is valid, a new conformation is proposed. The change in energy, $\\Delta E = E_{\\text{proposed}} - E_{\\text{current}}$, is calculated.\n    - The proposed move is accepted with probability $p_{\\text{acc}} = \\min\\{1, \\exp(-\\Delta E / T)\\}$, where $T$ is a dimensionless temperature parameter. Moves that lower the energy ($\\Delta E < 0$) are always accepted. Moves that increase the energy are accepted with a probability that decreases exponentially with the energy increase, allowing the system to escape local minima. If a move is rejected, the conformation remains unchanged.\n    - Throughout the simulation, the lowest energy encountered, $E_{\\mathrm{best}}$, is tracked. The process is initialized with the energy of the starting conformation. The final output for this strategy is $E_{\\mathrm{auto}} = E_{\\mathrm{best}}$ after $T_{\\max}$ steps. For the given test cases, $T_{\\max}=0$, meaning no stochastic steps are performed. Therefore, $E_{\\mathrm{auto}}$ will simply be the energy of the initial linear conformation.\n\nThe implementation will utilize `numpy` arrays for efficient handling of coordinate vectors and matrix operations. The overall logic is encapsulated in a main function that processes each test case, calls the appropriate functions for manual and automated strategies, and formats the output as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_energy(coords, sequence):\n    \"\"\"\n    Calculates the HP energy of a given conformation.\n    Energy E = -1 for each non-adjacent H-H contact.\n    \"\"\"\n    n = len(sequence)\n    energy = 0\n    h_indices = [i for i, res in enumerate(sequence) if res == 'H']\n\n    if len(h_indices) < 2:\n        return 0\n\n    for i_idx in range(len(h_indices)):\n        for j_idx in range(i_idx + 1, len(h_indices)):\n            i = h_indices[i_idx]\n            j = h_indices[j_idx]\n\n            # Condition for non-adjacent residues\n            if abs(i - j) > 1:\n                # Manhattan distance\n                dist = np.sum(np.abs(coords[i] - coords[j]))\n                if dist == 1:\n                    energy -= 1\n    return energy\n\n\ndef get_proposed_coords(coords, n, k, angle):\n    \"\"\"\n    Generates a new conformation by applying a pivot move.\n    Returns the new coordinate array if the move is valid (self-avoiding),\n    otherwise returns None.\n    \"\"\"\n    # Pivot index k must be in {1, ..., N-2}\n    if not (1 <= k < n - 1):\n        return None\n\n    if angle == 90:\n        rot_matrix = np.array([[0, -1], [1, 0]], dtype=int)\n    elif angle == -90:\n        rot_matrix = np.array([[0, 1], [-1, 0]], dtype=int)\n    elif angle == 180:\n        rot_matrix = np.array([[-1, 0], [0, -1]], dtype=int)\n    else:\n        # Invalid angle\n        return None\n\n    new_coords = coords.copy()\n    pivot_coord = coords[k]\n    \n    # Suffix coordinates relative to the pivot\n    suffix_relative = coords[k+1:] - pivot_coord\n    \n    # Rotate the suffix vectors\n    rotated_suffix_relative = (rot_matrix @ suffix_relative.T).T\n    \n    # New absolute coordinates for the suffix\n    new_suffix_absolute = rotated_suffix_relative + pivot_coord\n    \n    new_coords[k+1:] = new_suffix_absolute\n    \n    # Check for self-avoidance. Using a set is efficient.\n    # The number of unique coordinates must be equal to the chain length.\n    if len(set(map(tuple, new_coords))) == n:\n        return new_coords\n    else:\n        return None\n\n\ndef solve():\n    \"\"\"\n    Main function to run the folding simulations for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"S\": \"HHHH\",\n            \"manual_moves\": [(1, 90), (2, 90)],\n            \"T\": 1.0, \"T_max\": 0, \"seed\": 1\n        },\n        {\n            \"S\": \"HPHPHPHP\",\n            \"manual_moves\": [],\n            \"T\": 1.0, \"T_max\": 0, \"seed\": 2\n        },\n        {\n            \"S\": \"HHHHHH\",\n            \"manual_moves\": [(1, 90), (2, 90), (4, -90)],\n            \"T\": 1.0, \"T_max\": 0, \"seed\": 3\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        sequence = case[\"S\"]\n        manual_moves = case[\"manual_moves\"]\n        T = case[\"T\"]\n        T_max = case[\"T_max\"]\n        seed = case[\"seed\"]\n\n        n = len(sequence)\n        \n        # --- Strategy 1: Manual Guidance ---\n        manual_coords = np.array([[i, 0] for i in range(n)], dtype=int)\n        \n        for k, angle in manual_moves:\n            proposed = get_proposed_coords(manual_coords, n, k, angle)\n            if proposed is not None:\n                manual_coords = proposed\n        \n        e_manual = calculate_energy(manual_coords, sequence)\n\n        # --- Strategy 2: Automated Stochastic Dynamics ---\n        rng = np.random.default_rng(seed)\n        \n        # Start with the initial linear conformation\n        current_coords = np.array([[i, 0] for i in range(n)], dtype=int)\n        current_energy = calculate_energy(current_coords, sequence)\n        best_energy = current_energy\n\n        # Perform T_max steps of Monte Carlo simulation\n        if T_max > 0 and n >= 3:\n            possible_k = list(range(1, n - 1))\n            possible_angles = [90, -90, 180]\n\n            for _ in range(T_max):\n                k_rand = rng.choice(possible_k)\n                angle_rand = rng.choice(possible_angles)\n                \n                proposed = get_proposed_coords(current_coords, n, k_rand, angle_rand)\n                \n                if proposed is not None:\n                    # Move is valid, evaluate for acceptance\n                    proposed_energy = calculate_energy(proposed, sequence)\n                    delta_E = proposed_energy - current_energy\n                    \n                    if delta_E < 0 or rng.random() < np.exp(-delta_E / T):\n                        # Accept the move\n                        current_coords = proposed\n                        current_energy = proposed_energy\n                \n                # If move is invalid, conformation and energy remain unchanged.\n                best_energy = min(best_energy, current_energy)\n\n        e_auto = best_energy\n        \n        results.append([e_manual, e_auto])\n\n    # Final print statement in the exact required format\n    output_str = \",\".join([f\"[{r[0]},{r[1]}]\" for r in results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "2422555"}]}