{"hands_on_practices": [{"introduction": "The stability of the DNA double helix is fundamental to its biological role, and this stability can be quantified by its melting temperature ($T_m$). This first practice provides a hands-on introduction to the thermodynamics of DNA folding using a simplified two-state model. By implementing a simulation to calculate the $T_m$ of a DNA hairpin, you will directly explore how stability arises from the sum of its parts and how a single structural defect, like a G-T wobble pair, can significantly alter the physical properties of the molecule [@problem_id:2386777].", "problem": "You are tasked with building a self-contained simulation of the thermal denaturation (melting) of a Deoxyribonucleic acid (DNA) hairpin using a two-state thermodynamic model and quantifying the effect of a single guanine–thymine (G–T) wobble pair in the stem on the melting temperature. In this model, a hairpin with a stem of length $n$ base pairs and a loop of length $L$ toggles between a fully folded state and a fully unfolded state. The folded state is stabilized by base pairing and stacking within the stem and destabilized by loop closure entropy. The unfolded state is taken as the reference with zero enthalpy and entropy.\n\nAssume the total Gibbs free energy of folding at absolute temperature $T$ is given by $\\Delta G(T) = \\Delta H_{\\mathrm{tot}} - T \\Delta S_{\\mathrm{tot}}$, where $\\Delta H_{\\mathrm{tot}}$ and $\\Delta S_{\\mathrm{tot}}$ are temperature-independent sums of contributions from base pairs, base-pair stacking, and loop entropy. The fraction folded at temperature $T$ is defined by the two-state Boltzmann equilibrium as $f_{\\mathrm{fold}}(T) = \\dfrac{1}{1+\\exp\\left(\\dfrac{\\Delta G(T)}{R T}\\right)}$, where $R$ is the Universal gas constant. The melting temperature $T_m$ is defined as the unique temperature (in Kelvin) at which $f_{\\mathrm{fold}}(T_m)=\\dfrac{1}{2}$.\n\nUse the following coarse-grained, physically grounded parameterization for the stem and loop in the folded state, with all enthalpies in $\\mathrm{cal\\cdot mol^{-1}}$ and entropies in $\\mathrm{cal\\cdot mol^{-1}\\cdot K^{-1}}$:\n- Universal gas constant: $R = 1.987\\ \\mathrm{cal\\cdot mol^{-1}\\cdot K^{-1}}$.\n- Per base-pair contributions in the stem:\n  - Watson–Crick guanine–cytosine pair: $\\Delta h_{\\mathrm{GC}} = -9800$, $\\Delta s_{\\mathrm{GC}} = -24.4$.\n  - Watson–Crick adenine–thymine pair: $\\Delta h_{\\mathrm{AT}} = -7200$, $\\Delta s_{\\mathrm{AT}} = -20.4$.\n  - G–T wobble pair: $\\Delta h_{\\mathrm{GT}} = -4000$, $\\Delta s_{\\mathrm{GT}} = -12.0$.\n- Per adjacent stacked pair within the stem (cooperativity), applied to each of the $n-1$ adjacencies in a stem of $n$ base pairs:\n  - $\\Delta h_{\\mathrm{stack}} = -800$, $\\Delta s_{\\mathrm{stack}} = -2.0$.\n- Loop entropy penalty for loop length $L$ (in nucleotides), modeled using a polymer loop-closure form with zero enthalpy and an entropy contribution $\\Delta s_{\\mathrm{loop}}(L) = R \\ln\\!\\big(A L^{-c}\\big)$, with $A = 1.0$ and $c = 1.8$. Thus, the total loop contribution is $\\Delta h_{\\mathrm{loop}}(L) = 0$ and $\\Delta s_{\\mathrm{loop}}(L) = - c R \\ln L$.\n\nGiven a hairpin with counts $n_{\\mathrm{GC}}$, $n_{\\mathrm{AT}}$, and $n_{\\mathrm{GT}}$ for the three base-pair types in the stem (so that $n = n_{\\mathrm{GC}} + n_{\\mathrm{AT}} + n_{\\mathrm{GT}}$), its total enthalpy and entropy in the folded state are:\n$$\n\\Delta H_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta h_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta h_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta h_{\\mathrm{GT}} + (n-1)\\,\\Delta h_{\\mathrm{stack}},\n$$\n$$\n\\Delta S_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta s_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta s_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta s_{\\mathrm{GT}} + (n-1)\\,\\Delta s_{\\mathrm{stack}} + \\Delta s_{\\mathrm{loop}}(L).\n$$\nWith the two-state model, $T_m$ satisfies $\\Delta G(T_m)=0$.\n\nTest suite and required outputs:\nFor each of the following three cases, consider two variants: a native variant with no G–T wobble ($n_{\\mathrm{GT}}=0$) and a wobble variant in which exactly one Watson–Crick pair of the specified type is replaced by a single G–T wobble pair (decrement that Watson–Crick count by $1$ and set $n_{\\mathrm{GT}}=1$). For each case, compute the change in melting temperature $\\Delta T_m = T_m^{\\mathrm{wobble}} - T_m^{\\mathrm{native}}$ in Kelvin.\n\n- Case $1$ (happy path): $n_{\\mathrm{GC}}=6$, $n_{\\mathrm{AT}}=0$, $L=4$, wobble replaces one $\\mathrm{GC}$.\n- Case $2$ (mixed content): $n_{\\mathrm{GC}}=3$, $n_{\\mathrm{AT}}=3$, $L=8$, wobble replaces one $\\mathrm{AT}$.\n- Case $3$ (boundary, minimal stem): $n_{\\mathrm{GC}}=1$, $n_{\\mathrm{AT}}=0$, $L=3$, wobble replaces one $\\mathrm{GC}$.\n\nAngle units are not applicable. All temperatures must be expressed in Kelvin, and each final numeric result must be a floating-point number.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the three cases, with each $\\Delta T_m$ rounded to three decimal places in Kelvin. For example, an output line has the form $[\\Delta T_{m,1},\\Delta T_{m,2},\\Delta T_{m,3}]$.", "solution": "The problem statement has been subjected to rigorous validation and is deemed to be valid. It is scientifically grounded in the principles of biophysical chemistry, specifically the two-state nearest-neighbor model for nucleic acid thermodynamics. The problem is well-posed, providing all necessary parameters, constants, and equations to determine a unique solution for the melting temperature, $T_m$. The provided parameters are physically reasonable for a coarse-grained model. The formulas for total enthalpy and entropy are self-consistent. The clarification regarding the loop entropy formula, $\\Delta s_{\\mathrm{loop}}(L) = - c R \\ln L$, derived from $\\Delta s_{\\mathrm{loop}}(L) = R \\ln(A L^{-c})$ with $A = 1.0$, is correct. The extraneous statement \"Angle units are not applicable\" is noted but does not affect the problem's integrity or solvability. As the problem is valid, a complete, reasoned solution is now presented.\n\nThe objective is to compute the change in melting temperature, $\\Delta T_m = T_m^{\\mathrm{wobble}} - T_m^{\\mathrm{native}}$, for a DNA hairpin when a Watson-Crick base pair is replaced by a G-T wobble pair. The solution is founded upon the provided two-state thermodynamic model.\n\nThe melting temperature, $T_m$, is defined as the temperature at which the hairpin is half-folded, i.e., $f_{\\mathrm{fold}}(T_m) = 1/2$. According to the given model for the fraction folded,\n$$f_{\\mathrm{fold}}(T) = \\dfrac{1}{1+\\exp\\left(\\dfrac{\\Delta G(T)}{R T}\\right)}$$\nthe condition $f_{\\mathrm{fold}}(T_m) = 1/2$ implies that the exponential term must be equal to $1$. This is only possible if the exponent is zero, which leads to the fundamental condition for the melting temperature:\n$$\\Delta G(T_m) = 0$$\nThe Gibbs free energy of folding is given as $\\Delta G(T) = \\Delta H_{\\mathrm{tot}} - T \\Delta S_{\\mathrm{tot}}$. Substituting this into the condition for $T_m$ yields:\n$$\\Delta H_{\\mathrm{tot}} - T_m \\Delta S_{\\mathrm{tot}} = 0$$\nSolving for $T_m$, we obtain the central equation for our calculation, which expresses the melting temperature in Kelvin as the ratio of the total enthalpy change to the total entropy change of folding:\n$$T_m = \\frac{\\Delta H_{\\mathrm{tot}}}{\\Delta S_{\\mathrm{tot}}}$$\nThis equation is valid as long as $\\Delta S_{\\mathrm{tot}} \\neq 0$, a condition which holds for any physical hairpin structure as all provided entropy contributions are non-zero and negative, ensuring a non-zero sum.\n\nTo calculate $T_m$ for any given hairpin, we must first compute its total folding enthalpy, $\\Delta H_{\\mathrm{tot}}$, and total folding entropy, $\\Delta S_{\\mathrm{tot}}$. These quantities are determined by summing the contributions from all constituent base pairs in the stem, the stacking interactions between them, and the entropic cost of loop closure. The provided formulas are:\n$$\n\\Delta H_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta h_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta h_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta h_{\\mathrm{GT}} + (n-1)\\,\\Delta h_{\\mathrm{stack}}\n$$\n$$\n\\Delta S_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta s_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta s_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta s_{\\mathrm{GT}} + (n-1)\\,\\Delta s_{\\mathrm{stack}} + \\Delta s_{\\mathrm{loop}}(L)\n$$\nwhere $n = n_{\\mathrm{GC}} + n_{\\mathrm{AT}} + n_{\\mathrm{GT}}$ is the total number of base pairs in the stem. The term $(n-1)$ correctly accounts for the $n-1$ adjacent stacking interactions in a stem of length $n$. For a stem with only one base pair ($n=1$), this term naturally becomes zero, which is physically correct as there are no stacking interactions.\n\nThe loop-closure entropy, $\\Delta s_{\\mathrm{loop}}(L)$, is given by the formula:\n$$\n\\Delta s_{\\mathrm{loop}}(L) = -c R \\ln L\n$$\nwith model parameters $c = 1.8$, universal gas constant $R = 1.987\\ \\mathrm{cal\\cdot mol^{-1}\\cdot K^{-1}}$, and $L$ being the loop length in nucleotides.\n\nThe algorithmic approach is as follows:\n$1$. A computational function is implemented to calculate $T_m$ based on the derived formula $T_m = \\Delta H_{\\mathrm{tot}} / \\Delta S_{\\mathrm{tot}}$. This function takes as input the number of GC, AT, and GT pairs ($n_{\\mathrm{GC}}$, $n_{\\mathrm{AT}}$, $n_{\\mathrm{GT}}$) and the loop length ($L$).\n$2$. Inside this function, $\\Delta H_{\\mathrm{tot}}$ and $\\Delta S_{\\mathrm{tot}}$ are computed by summing the specified thermodynamic contributions using the given parameters: $\\Delta h_{\\mathrm{GC}} = -9800$, $\\Delta s_{\\mathrm{GC}} = -24.4$, $\\Delta h_{\\mathrm{AT}} = -7200$, $\\Delta s_{\\mathrm{AT}} = -20.4$, $\\Delta h_{\\mathrm{GT}} = -4000$, $\\Delta s_{\\mathrm{GT}} = -12.0$, $\\Delta h_{\\mathrm{stack}} = -800$, and $\\Delta s_{\\mathrm{stack}} = -2.0$.\n$3$. The program then iterates through the three test cases specified. For each case, it defines the parameters for the 'native' hairpin and its 'wobble' counterpart.\n$4$. For each case, the $T_m$ calculation function is called twice: once for the native variant ($T_m^{\\mathrm{native}}$) and once for the wobble variant ($T_m^{\\mathrm{wobble}}$).\n$5$. The change in melting temperature, $\\Delta T_m = T_m^{\\mathrm{wobble}} - T_m^{\\mathrm{native}}$, is computed.\n$6$. The results for the three cases are collected, rounded to three decimal places as required, and formatted into a single output string.\n\nThe introduction of a G-T wobble pair, which is thermodynamically less stable than either a G-C or A-T Watson-Crick pair (i.e., its $\\Delta h$ and $\\Delta s$ values are less negative), is expected to destabilize the hairpin stem. This destabilization will lower the melting temperature, so we anticipate $\\Delta T_m$ to be negative in all cases. The magnitude of this effect will depend on the stability of the original pair being replaced and the overall stability of the hairpin.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DNA hairpin melting problem by calculating the change in melting\n    temperature upon introduction of a G-T wobble pair for three test cases.\n    \"\"\"\n\n    # --- Thermodynamic Parameters ---\n    # Universal gas constant (cal/mol/K)\n    R = 1.987\n    \n    # Per base-pair contributions (enthalpy in cal/mol, entropy in cal/mol/K)\n    # Guanine-Cytosine pair\n    DH_GC = -9800.0\n    DS_GC = -24.4\n    # Adenine-Thymine pair\n    DH_AT = -7200.0\n    DS_AT = -20.4\n    # Guanine-Thymine wobble pair\n    DH_GT = -4000.0\n    DS_GT = -12.0\n    \n    # Per adjacent stacked-pair contribution\n    DH_STACK = -800.0\n    DS_STACK = -2.0\n    \n    # Loop entropy model parameter\n    C_LOOP = 1.8\n\n    def calculate_tm(n_gc, n_at, n_gt, loop_len):\n        \"\"\"\n        Calculates the melting temperature (Tm) for a DNA hairpin.\n\n        Args:\n            n_gc (int): Number of GC pairs.\n            n_at (int): Number of AT pairs.\n            n_gt (int): Number of GT pairs.\n            loop_len (int): Length of the loop in nucleotides.\n\n        Returns:\n            float: The melting temperature in Kelvin.\n        \"\"\"\n        # Total number of base pairs in the stem\n        n = n_gc + n_at + n_gt\n\n        if n == 0:\n            # A stem of zero length has no defined melting transition\n            return np.nan\n\n        # Calculate total enthalpy of folding\n        delta_h_tot = (n_gc * DH_GC + n_at * DH_AT + n_gt * DH_GT)\n        # Stacking contribution exists only for stems with 2 or more pairs\n        if n > 1:\n            delta_h_tot += (n - 1) * DH_STACK\n\n        # Calculate total entropy of folding\n        # Loop entropy penalty (destabilizing)\n        delta_s_loop = -C_LOOP * R * np.log(loop_len)\n        \n        delta_s_tot = (n_gc * DS_GC + n_at * DS_AT + n_gt * DS_GT + delta_s_loop)\n        # Stacking contribution\n        if n > 1:\n            delta_s_tot += (n - 1) * DS_STACK\n            \n        # If entropy change is zero, Tm is not well-defined in this model\n        if delta_s_tot == 0:\n            return np.nan\n\n        # Melting temperature is the ratio of enthalpy to entropy\n        tm = delta_h_tot / delta_s_tot\n        return tm\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: nGC=6, nAT=0, L=4. A GC pair is replaced by a GT wobble.\n        {\n            \"native\": {\"n_gc\": 6, \"n_at\": 0, \"n_gt\": 0, \"loop_len\": 4},\n            \"wobble\": {\"n_gc\": 5, \"n_at\": 0, \"n_gt\": 1, \"loop_len\": 4}\n        },\n        # Case 2: nGC=3, nAT=3, L=8. An AT pair is replaced by a GT wobble.\n        {\n            \"native\": {\"n_gc\": 3, \"n_at\": 3, \"n_gt\": 0, \"loop_len\": 8},\n            \"wobble\": {\"n_gc\": 3, \"n_at\": 2, \"n_gt\": 1, \"loop_len\": 8}\n        },\n        # Case 3: nGC=1, nAT=0, L=3. A GC pair is replaced by a GT wobble.\n        {\n            \"native\": {\"n_gc\": 1, \"n_at\": 0, \"n_gt\": 0, \"loop_len\": 3},\n            \"wobble\": {\"n_gc\": 0, \"n_at\": 0, \"n_gt\": 1, \"loop_len\": 3}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate Tm for both the native and wobble-containing variants\n        tm_native = calculate_tm(**case[\"native\"])\n        tm_wobble = calculate_tm(**case[\"wobble\"])\n\n        # Calculate the change in melting temperature\n        delta_tm = tm_wobble - tm_native\n        \n        # Format the result to three decimal places\n        results.append(f\"{delta_tm:.3f}\")\n\n    # Print the final output in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2386777"}, {"introduction": "Real DNA is a dynamic structure constantly subjected to damage. This exercise elevates our model to explore the biophysical consequences of a common lesion, the abasic site, within a DNA duplex. You will implement a more refined nearest-neighbor model for stability and, crucially, connect it to a mechanical model of DNA flexibility [@problem_id:2386781]. This practice illuminates how a single molecular flaw can simultaneously destabilize the helix and create a flexible hinge, a concept with deep implications for DNA repair and protein recognition.", "problem": "Write a complete, runnable program that models the effect of a single abasic site on both local flexibility and melting temperature of a Deoxyribonucleic Acid (DNA) double helix under a physically grounded, simplified framework. The program must compute, for each test case, two quantities: the melting temperature in degrees Celsius of the intact duplex and of the duplex with one abasic site, and the local angular variance in radians squared of bend fluctuations at the abasic site, for both intact and abasic conditions, at a specified reference temperature. All numerical inputs and outputs must be handled in the specified units. Your program must produce a single-line output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case contributes a list in the order described below.\n\nMathematical and physical setup:\n- Model the duplex thermodynamics using the two-state approximation. Let the standard Gibbs free energy change be written as $\\Delta G(T) = \\Delta H - T \\,\\Delta S$, where $\\Delta H$ is the standard enthalpy change and $\\Delta S$ is the standard entropy change for duplex formation. For a non-self-complementary duplex at total strand concentration $C_t$ (in $\\mathrm{M}$), chemical equilibrium implies $K(T) = \\dfrac{1}{C_t/4}$ at the melting temperature $T_m$, with equilibrium constant $K(T) = \\exp\\!\\left(-\\dfrac{\\Delta G(T)}{R T}\\right)$, where $R$ is the universal gas constant.\n- Use the nearest-neighbor (NN) additivity hypothesis: for a duplex of length $N$ base pairs, write $\\Delta H = \\sum_{i=1}^{N-1} \\Delta H_i$ and $\\Delta S = \\sum_{i=1}^{N-1} \\Delta S_i + \\Delta S_{\\text{salt}}$, where each base-pair step $i$ contributes $(\\Delta H_i,\\Delta S_i)$ according to the $5^\\prime\\!\\to\\!3^\\prime$ dinucleotide on one strand, and the monovalent salt correction is $\\Delta S_{\\text{salt}} = 0.368\\,(N-1)\\,\\ln([\\mathrm{Na}^+])$ with $[\\mathrm{Na}^+]$ in $\\mathrm{M}$ and natural logarithm. Ignore any initiation or terminal corrections. Assume all test sequences are non-self-complementary.\n- The NN parameters $(\\Delta H_i,\\Delta S_i)$ must be obtained from the following canonical set (units: $\\Delta H$ in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$, $\\Delta S$ in $\\mathrm{cal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$), keyed by the $5^\\prime\\!\\to\\!3^\\prime$ dinucleotide on the strand considered. Use reverse-complement equivalence to map any dinucleotide not explicitly listed to the corresponding canonical entry:\n  - $AA: (\\,-7.9,\\,-22.2\\,)$, $AT: (\\,-7.2,\\,-20.4\\,)$, $TA: (\\,-7.2,\\,-21.3\\,)$, $CA: (\\,-8.5,\\,-22.7\\,)$, $GT: (\\,-8.4,\\,-22.4\\,)$, $CT: (\\,-7.8,\\,-21.0\\,)$, $GA: (\\,-8.2,\\,-22.2\\,)$, $CG: (\\,-10.6,\\,-27.2\\,)$, $GC: (\\,-9.8,\\,-24.4\\,)$, $GG: (\\,-8.0,\\,-19.9\\,)$.\n  - For any dinucleotide $XY$ not in the list, use the entry of its reverse complement $\\mathrm{rc}(XY)$, where the complement is defined by $A\\leftrightarrow T$, $C\\leftrightarrow G$, and $\\mathrm{rc}(XY)$ is the complement of the reversed string.\n- Abasic-site thermodynamics: Let there be a single abasic site at base-pair index $j$ (one-based indexing along the duplex). Model its effect by modifying only the two nearest-neighbor steps adjacent to $j$, namely steps $j-1$ and $j$ (if they exist within $1,\\dots,N-1$). For each affected step, scale the enthalpy contribution by a factor $\\beta$ and shift the entropy contribution by an offset $\\delta$, with\n  - $\\beta = 0.5$ (dimensionless) and $\\delta = +5.0\\,\\mathrm{cal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n  Steps not adjacent to the abasic site are unmodified.\n- Melting temperature calculation: Use $R = 1.98720425864083\\,\\mathrm{cal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. Express the final melting temperature $T_m$ in degrees Celsius. Clearly specify the angle unit used for any angular quantities.\n- Local flexibility model: Represent bendability near a base-pair step by a harmonic angular stiffness $k$ (spring constant) with units $\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$. Assign $k_0 = 150.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$ to a normal step and $k_{\\text{ab}} = 30.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$ to a step adjacent to the abasic site. Define the effective local stiffness at the abasic position as springs in series over the one or two adjacent steps:\n  $$\\frac{1}{k_{\\mathrm{eff}}} = \\sum_{\\ell} \\frac{1}{k_{\\ell}},$$\n  where the sum runs over step $j-1$ and step $j$ if both exist; if the abasic site is at a terminus (so only one adjacent step exists), then $k_{\\mathrm{eff}}$ equals that single-step stiffness. Using the equipartition theorem for a single quadratic angular degree of freedom, the angular variance is\n  $$\\sigma^2 = \\frac{k_{\\mathrm{B}}\\,T_{\\mathrm{ref}}}{k_{\\mathrm{eff}}},$$\n  with Boltzmann constant $k_{\\mathrm{B}} = 0.01380649\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{K}^{-1}$ and reference temperature $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$. Report $\\sigma^2$ in $\\mathrm{rad}^2$.\n- Units and numerical requirements:\n  - Report $T_m$ in degrees Celsius and $\\sigma^2$ in $\\mathrm{rad}^2$.\n  - Use natural logarithms for all $\\ln(\\cdot)$.\n  - All input concentrations $C_t$ and $[\\mathrm{Na}^+]$ are in $\\mathrm{M}$.\n\nTest suite to implement and evaluate:\n- Case $1$: sequence $S = \\mathrm{ATGCGTAC}$, length $N=8$, abasic index $j=4$, total strand concentration $C_t = 2\\times 10^{-6}\\,\\mathrm{M}$, monovalent salt $[\\mathrm{Na}^+] = 0.05\\,\\mathrm{M}$.\n- Case $2$: sequence $S = \\mathrm{ATATATAT}$, $N=8$, $j=4$, $C_t = 1\\times 10^{-6}\\,\\mathrm{M}$, $[\\mathrm{Na}^+] = 0.01\\,\\mathrm{M}$.\n- Case $3$: sequence $S = \\mathrm{GCGCGCGC}$, $N=8$, $j=1$, $C_t = 5\\times 10^{-6}\\,\\mathrm{M}$, $[\\mathrm{Na}^+] = 1.0\\,\\mathrm{M}$.\n- Case $4$: sequence $S = \\mathrm{ATGC}$, $N=4$, $j=2$, $C_t = 1\\times 10^{-7}\\,\\mathrm{M}$, $[\\mathrm{Na}^+] = 0.05\\,\\mathrm{M}$.\n\nFor each case, the program must produce a list of four real numbers in the following order:\n- $T_m$ of the intact duplex (degrees Celsius),\n- $T_m$ of the duplex with the abasic-site modifications described above (degrees Celsius),\n- $\\sigma^2$ for the intact duplex at the specified abasic-site index (in $\\mathrm{rad}^2$),\n- $\\sigma^2$ for the abasic-modified duplex at the specified abasic-site index (in $\\mathrm{rad}^2$).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list of four numbers for a test case, in the same order as the test suite cases. For example: $[ [x_1,x_2,x_3,x_4], [y_1,y_2,y_3,y_4], \\dots ]$.", "solution": "The problem presented requires the calculation of thermodynamic and mechanical properties of a DNA duplex, both in its intact form and with a single abasic site defect. The framework provided is a simplified, but physically grounded, model common in biophysical chemistry. Before proceeding, it is my duty to validate the problem statement for scientific soundness and logical consistency.\n\nThe problem specifies a set of nearest-neighbor parameters for DNA stability, a standard salt correction, and a two-state model for melting. The equation for the melting temperature $T_m$ is derived from the condition $K(T_m)=4/C_t$, which is correct for non-self-complementary duplexes. The problem then instructs to \"Assume all test sequences are non-self-complementary.\" However, an inspection of the provided test cases reveals that Case 2 ($S = \\mathrm{ATATATAT}$) and Case 3 ($S = \\mathrm{GCGCGCGC}$) consist of self-complementary sequences. For such sequences, the melting equilibrium is different, leading to a condition of $K(T_m)=1/C_t$.\n\nThis presents a contradiction between an explicit assumption and the provided data. In a rigorous scientific context, one would use the correct formula for each sequence type. However, within the confines of an academic problem, an explicit instruction to \"Assume\" must be interpreted as a directive to apply a specified model, even if it represents a simplification or is applied outside its typical domain. It sets the computational rules for this exercise. Therefore, I will proceed by strictly adhering to the stated assumption, applying the non-self-complementary formula to all cases as instructed. The problem is thus deemed valid, albeit imperfectly formulated. All scientific principles and constants are otherwise standard and correctly stated.\n\nThe solution will be structured as follows:\nFirst, a thermodynamic calculation will be performed to find the total enthalpy change $\\Delta H$ and entropy change $\\Delta S$ for duplex formation. This uses the nearest-neighbor model, where parameters for each dinucleotide step are summed. A full table for all $16$ dinucleotides is constructed from the $10$ provided pairs and the reverse-complement symmetry rule. For the abasic case, the enthalpy and entropy contributions of the two steps adjacent to the abasic site are modified according to the given parameters $\\beta$ and $\\delta$.\n\nThe melting temperature $T_m$ is derived from the relation for chemical equilibrium at the melting point. Given the concentration-dependent equilibrium constant $K(T) = \\exp(-\\Delta G(T) / (RT))$, and the condition for non-self-complementary strands at $T_m$ where the fraction of duplex is $1/2$, we have $K(T_m)=4/C_t$. The Gibbs free energy is $\\Delta G(T) = \\Delta H - T\\Delta S$.\nFrom this, we derive the expression for $T_m$ in Kelvin:\n$$ \\ln(K(T_m)) = \\ln\\left(\\frac{4}{C_t}\\right) = -\\frac{\\Delta H - T_m \\Delta S}{R T_m} = -\\frac{\\Delta H}{R T_m} + \\frac{\\Delta S}{R} $$\nSolving for $T_m$:\n$$ T_m = \\frac{\\Delta H}{\\Delta S - R \\ln(4/C_t)} $$\nHere, $\\Delta H$ and $\\Delta S$ are the total enthalpy and entropy changes for the duplex formation, including salt effects. Note that units must be consistent. The given $\\Delta H_i$ are in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$ and must be converted to $\\mathrm{cal}\\,\\mathrm{mol}^{-1}$ by multiplying by $1000$. The resulting $T_m$ in Kelvin is converted to degrees Celsius by subtracting $273.15$. This procedure is applied for both the intact and abasic-modified duplexes.\n\nSecond, the local flexibility is modeled by calculating the angular variance $\\sigma^2$ at the location of the defect. The duplex is treated as a chain of segments with harmonic bending stiffness. The effective stiffness $k_{\\mathrm{eff}}$ at a position $j$ is calculated by considering the adjacent base-pair steps ($j-1$ and $j$) as springs in series.\n$$ \\frac{1}{k_{\\mathrm{eff}}} = \\sum_{\\ell \\in \\{j-1, j\\} \\cap \\{1, \\dots, N-1\\}} \\frac{1}{k_{\\ell}} $$\nFor an intact duplex, all steps have stiffness $k_0 = 150.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$. For an internal site ($1 < j < N$), this gives $1/k_{\\mathrm{eff}} = 1/k_0 + 1/k_0 = 2/k_0$, so $k_{\\mathrm{eff}} = k_0/2$. For a terminal site ($j=1$ or $j=N$), $k_{\\mathrm{eff}} = k_0$.\nFor a duplex with an abasic site at position $j$, the adjacent steps have reduced stiffness $k_{\\text{ab}} = 30.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$. The same series combination rule applies, leading to $k_{\\mathrm{eff}} = k_{\\text{ab}}/2$ for an internal site and $k_{\\mathrm{eff}} = k_{\\text{ab}}$ for a terminal site.\n\nThe angular variance $\\sigma^2$ is then found using the equipartition theorem for a single quadratic angular degree of freedom:\n$$ \\sigma^2 = \\frac{k_{\\mathrm{B}}\\,T_{\\mathrm{ref}}}{k_{\\mathrm{eff}}} $$\nwhere $k_{\\mathrm{B}} = 0.01380649\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{K}^{-1}$ is the Boltzmann constant and $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$ is the reference temperature. The variance is calculated for both the intact and abasic cases using their respective $k_{\\mathrm{eff}}$ values.\n\nThe implementation will process each test case by applying these two calculation steps, yielding the four required quantities: $T_{m,\\text{intact}}$, $T_{m,\\text{abasic}}$, $\\sigma^2_{\\text{intact}}$, and $\\sigma^2_{\\text{abasic}}$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DNA thermodynamics and mechanics problem as specified.\n    \"\"\"\n    # Global constants\n    R_GAS = 1.98720425864083  # cal mol^-1 K^-1\n    KB = 0.01380649          # pN nm K^-1\n    T_REF = 298.15            # K\n    K_0 = 150.0               # pN nm rad^-2\n    K_AB = 30.0               # pN nm rad^-2\n    K_TO_C = -273.15          # Kelvin to Celsius conversion\n\n    # Nearest-neighbor parameters (dH in kcal/mol, dS in cal/mol/K)\n    nn_params_raw = {\n        'AA': (-7.9, -22.2), 'AT': (-7.2, -20.4), 'TA': (-7.2, -21.3),\n        'CA': (-8.5, -22.7), 'GT': (-8.4, -22.4), 'CT': (-7.8, -21.0),\n        'GA': (-8.2, -22.2), 'CG': (-10.6, -27.2), 'GC': (-9.8, -24.4),\n        'GG': (-8.0, -19.9)\n    }\n\n    # Build full 16-dinucleotide parameter set using reverse complement symmetry\n    complements = {'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C'}\n    \n    def reverse_complement(seq):\n        return \"\".join(complements[base] for base in reversed(seq))\n\n    nn_params = {}\n    all_bases = ['A', 'C', 'G', 'T']\n    for b1 in all_bases:\n        for b2 in all_bases:\n            dinucl = b1 + b2\n            if dinucl in nn_params_raw:\n                nn_params[dinucl] = nn_params_raw[dinucl]\n            else:\n                rc_dinucl = reverse_complement(dinucl)\n                nn_params[dinucl] = nn_params_raw[rc_dinucl]\n\n    # Abasic site modification parameters\n    BETA = 0.5   # Enthalpy scaling factor\n    DELTA = 5.0  # Entropy offset in cal/mol/K\n\n    test_cases = [\n        # S, N, j, Ct, Na_conc\n        (\"ATGCGTAC\", 8, 4, 2e-6, 0.05),\n        (\"ATATATAT\", 8, 4, 1e-6, 0.01),\n        (\"GCGCGCGC\", 8, 1, 5e-6, 1.0),\n        (\"ATGC\", 4, 2, 1e-7, 0.05),\n    ]\n\n    results = []\n\n    def calculate_tm(sequence, na_conc, ct, abasic_j=None):\n        \"\"\"Calculates melting temperature.\"\"\"\n        n = len(sequence)\n        \n        dH_total_kcal = 0.0\n        dS_nn_total = 0.0\n        \n        # Sum over nearest-neighbor steps\n        for i in range(n - 1):\n            step_idx = i + 1\n            dinucl = sequence[i:i+2]\n            dH_i_kcal, dS_i = nn_params[dinucl]\n            \n            # Apply abasic modification if applicable\n            if abasic_j is not None:\n                # Abasic site at base 'j' affects steps 'j-1' and 'j'\n                if step_idx == abasic_j - 1 or step_idx == abasic_j:\n                    dH_i_kcal *= BETA\n                    dS_i += DELTA\n            \n            dH_total_kcal += dH_i_kcal\n            dS_nn_total += dS_i\n        \n        # Convert dH to cal/mol\n        dH_total_cal = dH_total_kcal * 1000.0\n        \n        # Salt correction for entropy\n        dS_salt = 0.368 * (n - 1) * np.log(na_conc)\n        dS_total = dS_nn_total + dS_salt\n        \n        # Calculate Tm in Kelvin\n        # Formula: Tm = dH / (dS - R * ln(4/Ct)) for non-self-complementary\n        denominator = dS_total - R_GAS * np.log(4.0 / ct)\n        \n        # Avoid division by zero, though unlikely with physical params\n        if abs(denominator) < 1e-9:\n            return float('nan')\n        \n        tm_k = dH_total_cal / denominator\n        \n        # Convert to Celsius\n        tm_c = tm_k + K_TO_C\n        return tm_c\n\n    def calculate_variance(n, j):\n        \"\"\"Calculates local angular variance.\"\"\"\n        k_b_t_ref = KB * T_REF\n\n        # Intact duplex\n        if j == 1 or j == n: # Terminal position\n            k_eff_intact = K_0\n        else: # Internal position\n            k_eff_intact = K_0 / 2.0\n        \n        sigma2_intact = k_b_t_ref / k_eff_intact\n\n        # Abasic duplex\n        if j == 1 or j == n: # Terminal position\n            k_eff_abasic = K_AB\n        else: # Internal position\n            k_eff_abasic = K_AB / 2.0\n        \n        sigma2_abasic = k_b_t_ref / k_eff_abasic\n\n        return sigma2_intact, sigma2_abasic\n\n    for case in test_cases:\n        s, n, j, ct, na_conc = case\n        \n        # Calculate Tm for intact and abasic duplexes\n        tm_intact = calculate_tm(s, na_conc, ct)\n        tm_abasic = calculate_tm(s, na_conc, ct, abasic_j=j)\n        \n        # Calculate variances for intact and abasic duplexes\n        sigma2_intact, sigma2_abasic = calculate_variance(n, j)\n        \n        results.append([tm_intact, tm_abasic, sigma2_intact, sigma2_abasic])\n\n    # Format the final output string as specified\n    output_str = \"[\" + \",\".join([str(res) for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2386781"}, {"introduction": "How does a molecule that is locally quite rigid fold into the compact structures found within a cell? This question leads us to model DNA as a semi-flexible polymer, described by the worm-like chain model and quantified by its persistence length, $L_p$. In this capstone exercise, you will derive and implement a method to calculate $L_p$ from the sequence-dependent local bending properties of the helix [@problem_id:2386739]. This practice provides a powerful insight into how global polymer behavior emerges from the sum of local mechanical characteristics, a key principle in understanding DNA packaging and looping.", "problem": "You are asked to connect a sequence-dependent mechanical model of deoxyribonucleic acid (DNA) to a physically measurable emergent parameter: the persistence length. Model DNA as a slender, inextensible elastic rod whose centerline geometry is described by a continuous arc-length coordinate $s$ with curvature $\\kappa(s)$. Assume that bending about principal axes is isotropic, and that local bending rigidity (also called bending modulus) $A(s)$ can vary with $s$ due to sequence heterogeneity. The elastic energy of the rod under small deflections follows the standard elastic rod functional\n$$\nE[\\kappa] \\;=\\; \\tfrac{1}{2} \\int_{0}^{L} A(s)\\,\\kappa(s)^2\\,ds,\n$$\nand the statistical mechanics of conformations follows the Boltzmann distribution at absolute temperature $T$ with Boltzmann constant $k_{\\mathrm{B}}$. The worm-like chain (WLC) is the canonical continuum limit of such an elastic model.\n\nTasks:\n1) Starting from the energy functional above and the principle that the equilibrium curvature field $\\kappa(s)$ under a prescribed net bend angle is obtained by minimizing $E[\\kappa]$ subject to the geometric constraint on total bend, derive an expression for an equivalent homogeneous bending modulus $A_{\\mathrm{eff}}$ for a heterogeneous rod of total contour length $L$. Then, for a discretized rod composed of $N$ base-pair steps, each of arc length $b_i$ and local bending modulus $A_i$, translate your continuous expression into a discrete formula in terms of $\\{A_i\\}_{i=1}^{N}$ and $\\{b_i\\}_{i=1}^{N}$.\n\n2) Using fundamental results from equilibrium statistical mechanics for thermalized elastic rods and the worm-like chain model, express the persistence length $L_p$ in terms of $A_{\\mathrm{eff}}$, $k_{\\mathrm{B}}$, and $T$. You must clearly state the minimal physical assumptions that justify this relationship.\n\n3) Implement a program that, given temperature $T$ in kelvin and a list of per-step bending moduli $\\{A_i\\}$ in $\\mathrm{pN}\\cdot\\mathrm{nm}^2$ for a DNA fragment with uniform base-pair rise $b$ in nanometers, computes the persistence length $L_p$ in nanometers using your derived discrete $A_{\\mathrm{eff}}$ and your expression for $L_p$. Use the value $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$ and convert it to $\\mathrm{pN}\\cdot\\mathrm{nm/K}$ via $1\\ \\mathrm{J} = 10^{21}\\ \\mathrm{pN}\\cdot\\mathrm{nm}$.\n\n4) Physical and numerical units: input bending moduli $A_i$ are in $\\mathrm{pN}\\cdot\\mathrm{nm}^2$, base-pair rise $b$ is in $\\mathrm{nm}$, temperature $T$ is in $\\mathrm{K}$, and you must output $L_p$ in $\\mathrm{nm}$. Report each numerical result rounded to $6$ decimal places.\n\n5) Test suite: your program must compute $L_p$ for the following parameter sets. In all cases, take a uniform per-step rise $b = 0.34\\ \\mathrm{nm}$.\n- Case 1 (homogeneous, canonical DNA-like rigidity at room temperature): $T = 298.15$, $A = [\\,205.7,\\,205.7,\\,205.7,\\,205.7,\\,205.7\\,]$.\n- Case 2 (alternating soft–stiff steps): $T = 298.15$, $A = [\\,100,\\,300,\\,100,\\,300,\\,100,\\,300\\,]$.\n- Case 3 (very stiff): $T = 298.15$, $A = [\\,1000,\\,1000,\\,1000\\,]$.\n- Case 4 (one very soft step among many stiff steps): $T = 298.15$, $A = [\\,300,\\,300,\\,300,\\,10,\\,300,\\,300,\\,300,\\,300,\\,300,\\,300\\,]$.\n- Case 5 (temperature dependence at physiological temperature): $T = 310.0$, $A = [\\,205.7,\\,205.7,\\,205.7,\\,205.7\\,]$.\n- Case 6 (single-step edge case): $T = 298.15$, $A = [\\,150\\,]$.\n\n6) Final output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"). Each entry must be a floating-point number equal to $L_p$ in $\\mathrm{nm}$ rounded to $6$ decimal places, in the order of the cases listed above.\n\nImportant constraints:\n- Your derivation must begin from the energy functional and general statistical mechanics principles, not from a shortcut formula. You must justify any continuum-to-discrete translation.\n- Angles, if introduced during derivation, are to be treated as small and in radians. No angles appear in the final numeric input or output.\n- The only physical constants you may use are $k_{\\mathrm{B}}$ and the unit conversion between $\\mathrm{J}$ and $\\mathrm{pN}\\cdot\\mathrm{nm}$ as specified.", "solution": "We begin with the slender elastic rod model for deoxyribonucleic acid (DNA), adopting the small-deflection regime and isotropic bending. The elastic energy for a space curve with curvature field $\\kappa(s)$ and position-dependent bending modulus $A(s)$ is\n$$\nE[\\kappa] \\;=\\; \\frac{1}{2}\\int_{0}^{L} A(s)\\,\\kappa(s)^2\\,ds,\n$$\nwhere $s$ is the arc length and $L$ is the contour length. Consider imposing a small overall bend with net angle $\\Theta$ between the end tangents. The geometric constraint is\n$$\n\\int_{0}^{L} \\kappa(s)\\,ds \\;=\\; \\Theta,\n$$\nwith $\\Theta$ in radians. Among all admissible $\\kappa(s)$ that satisfy this constraint, the physical bending response minimizes $E[\\kappa]$. Introduce a Lagrange multiplier $\\lambda$ for the constraint and minimize\n$$\n\\mathcal{F}[\\kappa] \\;=\\; \\frac{1}{2}\\int_{0}^{L} A(s)\\,\\kappa(s)^2\\,ds \\;-\\; \\lambda\\left(\\int_{0}^{L}\\kappa(s)\\,ds - \\Theta\\right).\n$$\nStationarity with respect to variations $\\delta \\kappa(s)$ yields\n$$\n\\frac{\\delta \\mathcal{F}}{\\delta \\kappa(s)} \\;=\\; A(s)\\,\\kappa(s) \\;-\\; \\lambda \\;=\\; 0 \\quad\\Rightarrow\\quad \\kappa(s) \\;=\\; \\frac{\\lambda}{A(s)}.\n$$\nEnforcing the constraint gives\n$$\n\\Theta \\;=\\; \\int_{0}^{L}\\kappa(s)\\,ds \\;=\\; \\int_{0}^{L}\\frac{\\lambda}{A(s)}\\,ds \\;=\\; \\lambda \\int_{0}^{L}\\frac{ds}{A(s)} \\;\\Rightarrow\\; \\lambda \\;=\\; \\frac{\\Theta}{\\int_{0}^{L}\\frac{ds}{A(s)}}.\n$$\nSubstituting the minimizing curvature back into the energy yields\n$$\nE_{\\min} \\;=\\; \\frac{1}{2}\\int_{0}^{L}A(s)\\left(\\frac{\\lambda}{A(s)}\\right)^2 ds \n\\;=\\; \\frac{1}{2}\\lambda^2 \\int_{0}^{L}\\frac{ds}{A(s)}\n\\;=\\; \\frac{1}{2}\\frac{\\Theta^2}{\\int_{0}^{L}\\frac{ds}{A(s)}}.\n$$\nFor an equivalent homogeneous rod of modulus $A_{\\mathrm{eff}}$, the same imposed bend $\\Theta$ would cost\n$$\nE_{\\mathrm{hom}} \\;=\\; \\frac{1}{2}\\frac{A_{\\mathrm{eff}}}{L}\\,\\Theta^2,\n$$\nbecause the curvature is uniform, $\\kappa = \\Theta/L$, leading to $E = \\frac{1}{2}\\int_{0}^{L} A_{\\mathrm{eff}}(\\Theta/L)^2 ds = \\frac{1}{2}\\frac{A_{\\mathrm{eff}}}{L}\\Theta^2$. Equating $E_{\\min}$ and $E_{\\mathrm{hom}}$ gives\n$$\n\\frac{1}{2}\\frac{A_{\\mathrm{eff}}}{L}\\,\\Theta^2 \\;=\\; \\frac{1}{2}\\frac{\\Theta^2}{\\int_{0}^{L}\\frac{ds}{A(s)}} \\quad\\Rightarrow\\quad \\frac{1}{A_{\\mathrm{eff}}} \\;=\\; \\frac{1}{L}\\int_{0}^{L}\\frac{ds}{A(s)}.\n$$\nThus, the effective bending modulus is the harmonic mean of the local moduli weighted by arc length:\n$$\nA_{\\mathrm{eff}} \\;=\\; \\frac{L}{\\displaystyle \\int_{0}^{L}\\frac{ds}{A(s)}}.\n$$\n\nDiscrete formulation for base-pair steps. Let the rod be discretized into $N$ steps indexed by $i=1,\\dots,N$ with lengths $b_i$ (in nanometers) and moduli $A_i$ (in $\\mathrm{pN}\\cdot\\mathrm{nm}^2$). Approximating the integral by a Riemann sum yields\n$$\nL \\;=\\; \\sum_{i=1}^{N} b_i,\\qquad \\int_{0}^{L}\\frac{ds}{A(s)} \\;\\approx\\; \\sum_{i=1}^{N}\\frac{b_i}{A_i},\n$$\nso that\n$$\nA_{\\mathrm{eff}} \\;=\\; \\frac{\\displaystyle \\sum_{i=1}^{N} b_i}{\\displaystyle \\sum_{i=1}^{N}\\frac{b_i}{A_i}}.\n$$\nFor uniform step length $b_i=b$ this simplifies to the (unweighted) harmonic mean:\n$$\nA_{\\mathrm{eff}} \\;=\\; \\frac{N}{\\displaystyle \\sum_{i=1}^{N}\\frac{1}{A_i}}.\n$$\n\nPersistence length from statistical mechanics. In the worm-like chain (WLC) model, which is the thermally fluctuating counterpart of the elastic rod, the tangent–tangent correlation function decays exponentially with arc length as $\\langle \\mathbf{t}(s)\\cdot\\mathbf{t}(0)\\rangle = e^{-s/L_p}$, defining the persistence length $L_p$. A standard and well-tested relation connects the bending modulus to the persistence length via thermal energy:\n$$\nL_p \\;=\\; \\frac{A}{k_{\\mathrm{B}} T}.\n$$\nThis follows from equipartition and the quadratic bending energy density: for small thermal fluctuations each quadratic mode contributes $\\tfrac{1}{2}k_{\\mathrm{B}}T$ on average, which leads to an average curvature variance per unit length set by $k_{\\mathrm{B}}T/A$ and a correlation length $L_p$ inversely proportional to that variance in the WLC continuum limit. For a heterogeneous filament coarse-grained to an equivalent homogeneous rod, we replace $A$ by $A_{\\mathrm{eff}}$:\n$$\nL_p \\;=\\; \\frac{A_{\\mathrm{eff}}}{k_{\\mathrm{B}} T}.\n$$\n\nUnits and conversion. We are given $A_i$ in $\\mathrm{pN}\\cdot\\mathrm{nm}^2$, $b_i$ in $\\mathrm{nm}$, and $T$ in $\\mathrm{K}$. The Boltzmann constant is $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$. Using $1\\ \\mathrm{J} = 10^{21}\\ \\mathrm{pN}\\cdot\\mathrm{nm}$, we have\n$$\nk_{\\mathrm{B}} \\;=\\; 1.380649\\times 10^{-23}\\ \\mathrm{J/K} \\;=\\; 1.380649\\times 10^{-23}\\times 10^{21}\\ \\mathrm{pN}\\cdot\\mathrm{nm/K} \\;=\\; 0.01380649\\ \\mathrm{pN}\\cdot\\mathrm{nm/K}.\n$$\nThus $k_{\\mathrm{B}}T$ is in $\\mathrm{pN}\\cdot\\mathrm{nm}$ and $A_{\\mathrm{eff}}/(k_{\\mathrm{B}}T)$ yields $L_p$ in $\\mathrm{nm}$.\n\nAlgorithm:\n- For each case, build $b_i$ and $A_i$, compute $L=\\sum_i b_i$ and $S=\\sum_i b_i/A_i$.\n- Compute $A_{\\mathrm{eff}} = L/S$.\n- Compute $k_{\\mathrm{B}}T = 0.01380649 \\times T$ in $\\mathrm{pN}\\cdot\\mathrm{nm}$.\n- Compute $L_p = A_{\\mathrm{eff}}/(k_{\\mathrm{B}}T)$ in $\\mathrm{nm}$.\n- Round to $6$ decimals.\n\nNow evaluate the test suite numerically with uniform $b_i=b=0.34\\ \\mathrm{nm}$.\n\nCase $1$: $T=298.15$, $A=[205.7,205.7,205.7,205.7,205.7]$.\n- $A_{\\mathrm{eff}} = 205.7$.\n- $k_{\\mathrm{B}}T = 0.01380649\\times 298.15 = 4.1164049935$.\n- $L_p = 205.7/4.1164049935 \\approx 49.970788\\ \\mathrm{nm}$.\n\nCase $2$: $T=298.15$, $A=[100,300,100,300,100,300]$.\n- $A_{\\mathrm{eff}} = \\left(6 / (3/100+3/300)\\right) = 150$.\n- $k_{\\mathrm{B}}T = 4.1164049935$.\n- $L_p = 150/4.1164049935 \\approx 36.439563\\ \\mathrm{nm}$.\n\nCase $3$: $T=298.15$, $A=[1000,1000,1000]$.\n- $A_{\\mathrm{eff}} = 1000$.\n- $k_{\\mathrm{B}}T = 4.1164049935$.\n- $L_p = 1000/4.1164049935 \\approx 242.930420\\ \\mathrm{nm}$.\n\nCase $4$: $T=298.15$, $A=[300,300,300,10,300,300,300,300,300,300]$.\n- $A_{\\mathrm{eff}} = 10/\\left(9/300 + 1/10\\right) = 76.9230769231$.\n- $k_{\\mathrm{B}}T = 4.1164049935$.\n- $L_p \\approx 76.9230769231/4.1164049935 \\approx 18.686956\\ \\mathrm{nm}$.\n\nCase $5$: $T=310.0$, $A=[205.7,205.7,205.7,205.7]$.\n- $A_{\\mathrm{eff}} = 205.7$.\n- $k_{\\mathrm{B}}T = 0.01380649\\times 310.0 = 4.2800119$.\n- $L_p = 205.7/4.2800119 \\approx 48.052203\\ \\mathrm{nm}$.\n\nCase $6$: $T=298.15$, $A=[150]$.\n- $A_{\\mathrm{eff}} = 150$.\n- $k_{\\mathrm{B}}T = 4.1164049935$.\n- $L_p = 150/4.1164049935 \\approx 36.439563\\ \\mathrm{nm}$.\n\nFinal required output (rounded to $6$ decimals and ordered as specified) is a single line containing a list of floats:\n$[49.970788,36.439563,242.930420,18.686956,48.052203,36.439563]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef effective_bending_modulus(A_list, b_list):\n    \"\"\"\n    Compute A_eff for a heterogeneous elastic rod discretized into steps.\n    A_list: list or array of per-step bending moduli (pN*nm^2)\n    b_list: list or array of per-step lengths (nm)\n    Returns A_eff in pN*nm^2.\n    \"\"\"\n    A = np.asarray(A_list, dtype=float)\n    b = np.asarray(b_list, dtype=float)\n    L = b.sum()  # total contour length (nm)\n    compliance_sum = np.sum(b / A)  # sum of ds/A(s)\n    return L / compliance_sum\n\ndef persistence_length_nm(A_eff, T_kelvin):\n    \"\"\"\n    Compute L_p in nm given A_eff (pN*nm^2) and temperature T (K).\n    Uses k_B = 0.01380649 pN*nm/K (from 1.380649e-23 J/K with 1 J = 1e21 pN*nm).\n    \"\"\"\n    kB_pNnm_perK = 0.01380649\n    kBT = kB_pNnm_perK * T_kelvin  # pN*nm\n    return A_eff / kBT  # nm\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, b in nm, list of A_i in pN*nm^2)\n    test_cases = [\n        (298.15, 0.34, [205.7, 205.7, 205.7, 205.7, 205.7]),\n        (298.15, 0.34, [100.0, 300.0, 100.0, 300.0, 100.0, 300.0]),\n        (298.15, 0.34, [1000.0, 1000.0, 1000.0]),\n        (298.15, 0.34, [300.0, 300.0, 300.0, 10.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0]),\n        (310.0,  0.34, [205.7, 205.7, 205.7, 205.7]),\n        (298.15, 0.34, [150.0]),\n    ]\n\n    results = []\n    for T, b, A_list in test_cases:\n        b_list = [b] * len(A_list)\n        A_eff = effective_bending_modulus(A_list, b_list)\n        Lp = persistence_length_nm(A_eff, T)\n        results.append(f\"{Lp:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2386739"}]}