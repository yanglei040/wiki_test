{"hands_on_practices": [{"introduction": "To build intuition for the greedy paradigm, we first explore one of its most common failure modes through a biological analogy. This exercise models axon guidance, where a growing neuron's tip follows the strongest attractive chemical signal in its immediate vicinity—a classic greedy strategy. By simulating this process on a grid with a defined chemical landscape, you will discover how a series of locally optimal moves can lead the axon to a suboptimal destination, trapping it in a 'local optimum' and preventing it from reaching the true, 'global' target. This practice [@problem_id:2396175] is fundamental to understanding why greedy algorithms must be applied with caution.", "problem": "In axon guidance during neural development, growth cones respond to extracellular chemical cues, tending to move up net chemoattractive gradients. Consider a simplified discrete model in which an axon growth cone is modeled as a greedy walk on a graph. Let the environment be a grid graph $G=(V,E)$ with $V=\\{p_{x,y}: x,y\\in\\{0,1,2\\}\\}$, where $p_{x,y}$ denotes the lattice site at integer coordinates $x$ and $y$. There is an undirected edge $\\{p_{x,y},p_{x',y'}\\}\\in E$ if and only if $|x-x'|+|y-y'|=1$ (four-neighbor connectivity). A scalar field $U:V\\to\\mathbb{R}$ encodes the net guidance potential (higher $U$ is more attractive), which can be interpreted as the combined effect of multiple attractants and repellents after receptor weighting at the growth cone.\n\nThe greedy walk rule is: starting at $S=p_{0,1}$, at each step at node $x\\in V$, among the neighbors $N(x)=\\{v\\in V\\mid \\{x,v\\}\\in E\\}$, choose a node $v^\\star\\in N(x)$ that maximizes the increase $\\Delta U=U(v)-U(x)$ subject to $U(v)U(x)$; move to $v^\\star$. If no neighbor has $U(v)U(x)$, stop (the growth cone halts at a local maximum of $U$).\n\nThere are two special nodes: the correct target $C=p_{2,2}$ and a wrong target $W=p_{2,0}$. Your task is to analyze four candidate gradient maps (assignments of $U$ values) and determine which one will cause the greedy axon starting at $S$ to terminate at the wrong target $W$ rather than at the correct target $C$, even though $C$ is the unique global maximizer of $U$ over $V$.\n\nChoose exactly one option.\n\nA. Map $\\mathcal{M}_A$:\n- $U(p_{0,1})=0$ (start $S$), $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$.\n- $U(p_{1,0})=5$, $U(p_{2,0})=8$ (wrong target $W$), $U(p_{2,1})=7$.\n- $U(p_{1,2})=6$, $U(p_{2,2})=10$ (correct target $C$).\n\nB. Map $\\mathcal{M}_B$:\n- $U(p_{0,1})=0$ (start $S$), $U(p_{1,1})=3$, $U(p_{0,0})=1$, $U(p_{0,2})=4$.\n- $U(p_{1,0})=2$, $U(p_{2,0})=6$ (wrong target $W$), $U(p_{2,1})=8$.\n- $U(p_{1,2})=7$, $U(p_{2,2})=10$ (correct target $C$).\n\nC. Map $\\mathcal{M}_C$:\n- $U(p_{0,1})=0$ (start $S$), $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$.\n- $U(p_{1,0})=5$, $U(p_{2,0})=12$ (wrong target $W$), $U(p_{2,1})=7$.\n- $U(p_{1,2})=6$, $U(p_{2,2})=10$ (correct target $C$).\n\nD. Map $\\mathcal{M}_D$:\n- $U(p_{0,1})=0$ (start $S$), $U(p_{1,1})=4$, $U(p_{0,0})=2$, $U(p_{0,2})=3$.\n- $U(p_{1,0})=1$, $U(p_{2,0})=8$ (wrong target $W$), $U(p_{2,1})=5$.\n- $U(p_{1,2})=2$, $U(p_{2,2})=10$ (correct target $C$).\n\nWhich map satisfies the stated condition?", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, we extract the given information verbatim:\n- The graph is a grid graph $G=(V,E)$ with vertices $V=\\{p_{x,y}\\mid x,y\\in\\{0,1,2\\}\\}$.\n- An edge $\\{p_{x,y},p_{x',y'}\\}\\in E$ exists if and only if $|x-x'|+|y-y'|=1$.\n- A scalar potential field $U:V\\to\\mathbb{R}$ is defined on the vertices.\n- The starting node is $S=p_{0,1}$.\n- The greedy walk rule: from a node $x$, move to a neighbor $v^\\star$ that maximizes the increase $\\Delta U=U(v)-U(x)$ subject to the constraint $U(v)U(x)$. The walk halts if no such neighbor exists.\n- The correct target is $C=p_{2,2}$.\n- The wrong target is $W=p_{2,0}$.\n- The task is to find which of four specified potential maps causes the greedy walk to terminate at $W$, under the condition that $C$ is the unique global maximizer of $U$.\n\nNext, we validate the problem statement against established criteria.\n- **Scientific Grounding**: The problem presents a highly simplified but conceptually sound model of axon guidance. Using a discrete graph, a potential field, and a greedy algorithm to model chemotaxis is a standard approach in computational biology and an acceptable abstraction. It is not based on pseudoscience.\n- **Well-Posedness**: The graph structure, starting point, and greedy walk rule are defined unambiguously. The rule is deterministic, guaranteeing a unique path and termination point for any given potential map. The question is precise and allows for a single verifiable answer.\n- **Objectivity**: The problem is stated in formal mathematical language, free of subjective or ambiguous terms.\n- **Completeness**: All necessary data (the potential values for each map) are provided to perform the analysis. The problem is self-contained.\n\nThe problem statement is found to be valid. It is a well-posed problem in graph theory and algorithms, relevant to computational biology. We may proceed with the solution.\n\nThe problem requires us to identify which potential map $\\mathcal{M}$ satisfies two conditions simultaneously:\n1. The greedy walk starting at $S=p_{0,1}$ terminates at the wrong target $W=p_{2,0}$.\n2. The correct target $C=p_{2,2}$ is the unique global maximizer of the potential $U$ on the vertex set $V$.\n\nWe will analyze each of the four candidate maps. The set of vertices is $V = \\{p_{0,0}, p_{0,1}, p_{0,2}, p_{1,0}, p_{1,1}, p_{1,2}, p_{2,0}, p_{2,1}, p_{2,2}\\}$.\n\n**Analysis of Map $\\mathcal{M}_A$**\nThe potential values are:\n$U(p_{0,1})=0$, $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$.\n$U(p_{1,0})=5$, $U(p_{2,0})=8$, $U(p_{2,1})=7$.\n$U(p_{1,2})=6$, $U(p_{2,2})=10$.\n\nFirst, we check the global maximum condition. The maximum potential value is $U(p_{2,2})=10$. This value is unique across all vertices. Thus, $C=p_{2,2}$ is the unique global maximizer. The condition is satisfied.\n\nNext, we trace the greedy walk:\n- **Step 1:** Start at $S=p_{0,1}$, where $U(p_{0,1})=0$. The neighbors are $p_{0,0}$, $p_{1,1}$, and $p_{0,2}$.\n  - $U(p_{0,0})=3$, so $\\Delta U = 3-0=3$.\n  - $U(p_{1,1})=1$, so $\\Delta U = 1-0=1$.\n  - $U(p_{0,2})=2$, so $\\Delta U = 2-0=2$.\n  The maximum increase is $\\Delta U = 3$, corresponding to the move to $p_{0,0}$. The path begins: $p_{0,1} \\to p_{0,0}$.\n\n- **Step 2:** The current node is $p_{0,0}$, with $U(p_{0,0})=3$. The neighbors are $p_{0,1}$ and $p_{1,0}$.\n  - $U(p_{0,1})=0$, which is less than $U(p_{0,0})=3$. This move is disallowed.\n  - $U(p_{1,0})=5$, so $\\Delta U = 5-3=2$.\n  The only valid move is to $p_{1,0}$. The path is now: $p_{0,1} \\to p_{0,0} \\to p_{1,0}$.\n\n- **Step 3:** The current node is $p_{1,0}$, with $U(p_{1,0})=5$. The neighbors are $p_{0,0}$, $p_{1,1}$, and $p_{2,0}$.\n  - $U(p_{0,0})=3  5$.\n  - $U(p_{1,1})=1  5$.\n  - $U(p_{2,0})=8$, so $\\Delta U = 8-5=3$.\n  The only valid move is to $p_{2,0}$. The path is: $p_{0,1} \\to p_{0,0} \\to p_{1,0} \\to p_{2,0}$.\n\n- **Step 4:** The current node is $p_{2,0}=W$, with $U(p_{2,0})=8$. The neighbors are $p_{1,0}$ and $p_{2,1}$.\n  - $U(p_{1,0})=5  8$.\n  - $U(p_{2,1})=7  8$.\n  There are no neighbors $v$ such that $U(v)U(p_{2,0})$. The walk halts at $p_{2,0}$.\n\nThe walk terminates at $W=p_{2,0}$. Both conditions are met for map $\\mathcal{M}_A$.\nVerdict for Option A: **Correct**.\n\n**Analysis of Map $\\mathcal{M}_B$**\nThe potential values are:\n$U(p_{0,1})=0$, $U(p_{1,1})=3$, $U(p_{0,0})=1$, $U(p_{0,2})=4$.\n$U(p_{1,0})=2$, $U(p_{2,0})=6$, $U(p_{2,1})=8$.\n$U(p_{1,2})=7$, $U(p_{2,2})=10$.\n\nThe maximum potential is $U(p_{2,2})=10$, which is unique. The global maximum condition is satisfied.\n\nWe trace the greedy walk:\n- **Step 1:** Start at $S=p_{0,1}$, where $U(p_{0,1})=0$. Neighbors are $p_{0,0}$, $p_{1,1}$, $p_{0,2}$.\n  - $U(p_{0,0})=1$, $\\Delta U=1$.\n  - $U(p_{1,1})=3$, $\\Delta U=3$.\n  - $U(p_{0,2})=4$, $\\Delta U=4$.\n  The maximum increase is $\\Delta U = 4$, moving to $p_{0,2}$. Path: $p_{0,1} \\to p_{0,2}$.\n\n- **Step 2:** Current node is $p_{0,2}$, $U(p_{0,2})=4$. Neighbors are $p_{0,1}$ and $p_{1,2}$.\n  - $U(p_{0,1})=0  4$.\n  - $U(p_{1,2})=7$, so $\\Delta U = 7-4=3$.\n  Move to $p_{1,2}$. Path: $p_{0,1} \\to p_{0,2} \\to p_{1,2}$.\n\n- **Step 3:** Current node is $p_{1,2}$, $U(p_{1,2})=7$. Neighbors are $p_{0,2}$, $p_{1,1}$, $p_{2,2}$.\n  - $U(p_{0,2})=4  7$.\n  - $U(p_{1,1})=3  7$.\n  - $U(p_{2,2})=10$, so $\\Delta U = 10-7=3$.\n  Move to $p_{2,2}$. Path: $p_{0,1} \\to p_{0,2} \\to p_{1,2} \\to p_{2,2}$.\n\n- **Step 4:** Current node is $p_{2,2}=C$, $U(p_{2,2})=10$. This is the global maximum, so no neighbor has a higher potential. The walk halts.\n\nThe walk terminates at $C=p_{2,2}$, not $W$.\nVerdict for Option B: **Incorrect**.\n\n**Analysis of Map $\\mathcal{M}_C$**\nThe potential values are:\n$U(p_{0,1})=0$, $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$.\n$U(p_{1,0})=5$, $U(p_{2,0})=12$, $U(p_{2,1})=7$.\n$U(p_{1,2})=6$, $U(p_{2,2})=10$.\n\nWe check the global maximum condition. The potential values are $\\{0, 1, 2, 3, 5, 6, 7, 10, 12\\}$. The maximum value is $U(p_{2,0})=12$. The problem requires that $C=p_{2,2}$ be the unique global maximizer, but here $U(p_{2,2})=10$ is not the maximum. The global maximizer is in fact $W=p_{2,0}$. This map violates a fundamental premise of the question. Therefore, this option cannot be the correct answer.\nVerdict for Option C: **Incorrect**.\n\n**Analysis of Map $\\mathcal{M}_D$**\nThe potential values are:\n$U(p_{0,1})=0$, $U(p_{1,1})=4$, $U(p_{0,0})=2$, $U(p_{0,2})=3$.\n$U(p_{1,0})=1$, $U(p_{2,0})=8$, $U(p_{2,1})=5$.\n$U(p_{1,2})=2$, $U(p_{2,2})=10$.\n\nThe maximum potential is $U(p_{2,2})=10$, which is unique. The global maximum condition is satisfied.\n\nWe trace the greedy walk:\n- **Step 1:** Start at $S=p_{0,1}$, where $U(p_{0,1})=0$. Neighbors are $p_{0,0}$, $p_{1,1}$, $p_{0,2}$.\n  - $U(p_{0,0})=2$, $\\Delta U=2$.\n  - $U(p_{1,1})=4$, $\\Delta U=4$.\n  - $U(p_{0,2})=3$, $\\Delta U=3$.\n  The maximum increase is $\\Delta U = 4$, moving to $p_{1,1}$. Path: $p_{0,1} \\to p_{1,1}$.\n\n- **Step 2:** Current node is $p_{1,1}$, $U(p_{1,1})=4$. Neighbors are $p_{0,1}, p_{1,0}, p_{2,1}, p_{1,2}$.\n  - $U(p_{0,1})=0  4$.\n  - $U(p_{1,0})=1  4$.\n  - $U(p_{2,1})=5$, so $\\Delta U = 5-4=1$.\n  - $U(p_{1,2})=2  4$.\n  The only valid move is to $p_{2,1}$. Path: $p_{0,1} \\to p_{1,1} \\to p_{2,1}$.\n\n- **Step 3:** Current node is $p_{2,1}$, $U(p_{2,1})=5$. Neighbors are $p_{1,1}, p_{2,0}, p_{2,2}$.\n  - $U(p_{1,1})=4  5$.\n  - $U(p_{2,0})=8$, so $\\Delta U = 8-5=3$.\n  - $U(p_{2,2})=10$, so $\\Delta U = 10-5=5$.\n  The maximum increase is $\\Delta U = 5$, moving to $p_{2,2}$. Path: $p_{0,1} \\to p_{1,1} \\to p_{2,1} \\to p_{2,2}$.\n\n- **Step 4:** Current node is $p_{2,2}=C$, $U(p_{2,2})=10$. This is the global maximum, so the walk halts.\n\nThe walk terminates at $C=p_{2,2}$, not $W$.\nVerdict for Option D: **Incorrect**.\n\nConclusion: Only Map $\\mathcal{M}_A$ leads the greedy walk to the wrong target $W$ while satisfying the condition that the correct target $C$ is the unique global maximum. The existence of a local maximum at $W$ traps the greedy algorithm.", "answer": "$$\\boxed{A}$$", "id": "2396175"}, {"introduction": "Greedy algorithms can fail even when they don't get trapped in a local optimum. This exercise explores a different pitfall using the classic 'change-making problem,' a cornerstone of algorithm theory, presented here in the context of designing a DNA restriction digest. You are tasked with achieving a target molecular length by selecting from a set of available fragments, where the greedy choice is to always pick the largest possible fragment. By comparing the result of this strategy to the true optimal solution, this practice [@problem_id:2396137] demonstrates that a series of individually best choices does not necessarily combine to form a globally best solution.", "problem": "In an in silico planning exercise for restriction digest design in deoxyribonucleic acid (DNA) workflows, consider the following abstracted change-making model. You have a synthetic backbone containing standardized, tandemly repeated size modules. Each module corresponds to a fragment that can be excised by a specific restriction enzyme. An application of any enzyme excises exactly one module of a fixed size and incurs a monetary cost of $1$ unit. Enzymes can be applied any number of times, and modules may be excised in any order. The goal is to excise modules whose total length equals a target length $L$, leaving behind the desired remaining construct. The available module sizes (in kilobase pairs (kbp)) are:\n- $1$ kbp,\n- $3$ kbp,\n- $4$ kbp.\n\nLet the target length be $L = 6$ kbp. A commonly used greedy policy in this setting chooses, at each step, the largest available module size that does not exceed the remaining length to be excised.\n\nWorking from the definitions above, determine the total cost incurred by this greedy policy and the minimal possible total cost over all valid excision sequences for this instance. Report, as a single number, the difference (greedy total cost) $-$ (optimal minimal total cost). Express the final answer as an integer without units.", "solution": "The problem statement is first validated for scientific and logical soundness.\n\n**1. Extraction of Givens:**\n- Problem Type: An abstracted change-making model derived from a bioinformatics context (restriction digest).\n- Available Module Sizes (denominations): $\\{1, 3, 4\\}$ kilobase pairs (kbp).\n- Cost: Each excision (module selection) costs $1$ unit.\n- Target Length ($L$): $L = 6$ kbp.\n- Greedy Policy Definition: At each step, select the largest available module size that does not exceed the remaining length to be excised.\n- Objective: Calculate the difference between the total cost incurred by the greedy policy and the minimal possible total cost (optimal solution).\n\n**2. Validation:**\n- Scientific Grounding: The problem is a computational abstraction of restriction mapping, a valid concept in molecular biology. It is mathematically equivalent to the classic change-making problem, which is a fundamental topic in computer science and algorithms. The problem is scientifically and mathematically sound.\n- Well-Posedness and Objectivity: The problem is well-posed, with all necessary parameters ($L$, module sizes, cost function, and greedy algorithm definition) explicitly stated. The terminology is precise and objective. A unique greedy solution and at least one optimal solution exist.\n- Verdict: The problem is valid. It is a standard exercise in algorithm analysis.\n\n**Solution Derivation:**\nThe problem requires the calculation of two quantities: the cost of a specific greedy algorithm and the cost of an optimal solution for making change for a target value $L$ using a given set of denominations. The cost is defined as the number of items (modules) used.\n\nLet the set of available module sizes be $S = \\{1, 3, 4\\}$. The target length is $L = 6$.\n\n**Part 1: Calculation of the Greedy Policy Cost**\nThe greedy policy dictates that at each step, we must choose the largest module size from $S$ that is less than or equal to the remaining length.\n\nLet $L_{rem}$ be the remaining length to be excised. Initially, $L_{rem} = 6$.\n\n- **Step 1:** The current remaining length is $L_{rem} = 6$. The available module sizes are $\\{1, 3, 4\\}$. The largest module size less than or equal to $6$ is $4$.\n  - We excise a module of size $4$ kbp.\n  - The new remaining length is $L_{rem} = 6 - 4 = 2$.\n  - The cost incurred so far is $1$.\n\n- **Step 2:** The current remaining length is $L_{rem} = 2$. The available module sizes are $\\{1, 3, 4\\}$. The largest module size less than or equal to $2$ is $1$.\n  - We excise a module of size $1$ kbp.\n  - The new remaining length is $L_{rem} = 2 - 1 = 1$.\n  - The total cost is now $1 + 1 = 2$.\n\n- **Step 3:** The current remaining length is $L_{rem} = 1$. The available module sizes are $\\{1, 3, 4\\}$. The largest module size less than or equal to $1$ is $1$.\n  - We excise a module of size $1$ kbp.\n  - The new remaining length is $L_{rem} = 1 - 1 = 0$.\n  - The total cost is now $2 + 1 = 3$.\n\nThe process terminates as the remaining length is $0$. The sequence of excised modules according to the greedy policy is $(4, 1, 1)$. The total cost, which is the number of modules excised, is $3$. Let this be $C_{greedy}$.\n$$C_{greedy} = 3$$\n\n**Part 2: Calculation of the Optimal (Minimal) Cost**\nThe optimal solution corresponds to finding a linear combination of the module sizes that sums to $L$ while minimizing the number of terms. We are looking for non-negative integers $n_1, n_3, n_4$ such that:\n$$1 \\cdot n_1 + 3 \\cdot n_3 + 4 \\cdot n_4 = 6$$\nand the total cost, $C = n_1 + n_3 + n_4$, is minimized.\n\nWe can find the optimal solution by systematically examining combinations of the available module sizes that sum to $6$.\n- **Combination 1:** Use two modules of size $3$ kbp.\n  - Total length: $3 + 3 = 6$.\n  - Total cost (number of modules): $2$. This is a valid solution.\n- **Combination 2:** Use one module of size $4$ kbp.\n  - Remaining length to be covered: $6 - 4 = 2$.\n  - The only way to form a length of $2$ is by using two modules of size $1$ kbp.\n  - The full combination is $(4, 1, 1)$.\n  - Total length: $4 + 1 + 1 = 6$.\n  - Total cost: $3$. This is the greedy solution found previously.\n- **Combination 3:** Use only modules of size $1$ kbp.\n  - The combination is $(1, 1, 1, 1, 1, 1)$.\n  - Total cost: $6$.\n- **Combination 4:** Use one module of size $3$ kbp.\n  - Remaining length: $6 - 3 = 3$.\n  - This can be filled with one more module of size $3$ kbp (which is Combination 1) or three modules of size $1$ kbp.\n  - The latter combination is $(3, 1, 1, 1)$.\n  - Total cost: $4$.\n\nBy comparing the costs of all valid combinations, we have:\n- Cost of $(3, 3)$ is $2$.\n- Cost of $(4, 1, 1)$ is $3$.\n- Cost of $(1, 1, 1, 1, 1, 1)$ is $6$.\n- Cost of $(3, 1, 1, 1)$ is $4$.\n\nThe minimum cost is $2$. Let this be $C_{optimal}$.\n$$C_{optimal} = 2$$\nThis demonstrates the well-known property that a greedy algorithm is not always optimal for the general change-making problem.\n\n**Part 3: Final Calculation**\nThe problem asks for the difference between the greedy cost and the optimal cost.\n$$\\text{Difference} = C_{greedy} - C_{optimal} = 3 - 2 = 1$$\nThe difference is $1$.", "answer": "$$\\boxed{1}$$", "id": "2396137"}, {"introduction": "Moving from conceptual illustrations to a more complex simulation, this problem places you in the role of a computational biologist advising on pest management. Your task is to implement a model where the pesticide for each season is chosen based on a greedy criterion: maximizing the immediate kill count in the current pest population. This hands-on coding exercise [@problem_id:2396125] will not only give you practice in implementing a greedy strategy within a dynamic system but will also reveal the long-term consequences of such shortsighted decision-making, namely the evolution of pesticide resistance.", "problem": "You are given a discrete-time model of a heterogeneous pest population exposed to a sequence of pesticide applications over a fixed number of seasons. The population consists of genotypes indexed by $g \\in \\{0,1,\\dots,G-1\\}$ and pesticides indexed by $p \\in \\{0,1,\\dots,P-1\\}$. Seasons are indexed by $t \\in \\{1,2,\\dots,T\\}$. At the start of season $t$, the abundance of genotype $g$ is $N_g^{(t)} \\ge 0$, the potency (maximum fractional kill on fully susceptible pests) of pesticide $p$ is $b_p \\in [0,1]$, and the resistance level of genotype $g$ to pesticide $p$ is $R_{g,p}^{(t)} \\in [0,1]$. Each genotype $g$ has a season-to-season multiplicative growth factor $r_g  0$, applied after the pesticide effect within a season. Each pesticide $p$ has an adaptation rate $a_p \\ge 0$ governing how quickly resistance to that pesticide increases following its use.\n\nDecision rule within a season: For each pesticide $p$, define the immediate expected kill at season $t$ as\n$$\nK_p^{(t)} \\;=\\; \\sum_{g=0}^{G-1} N_g^{(t)} \\, b_p \\, \\bigl(1 - R_{g,p}^{(t)}\\bigr).\n$$\nWithin season $t$, the applied pesticide $\\hat p^{(t)}$ is selected to maximize $K_p^{(t)}$. If multiple pesticides achieve the same maximal value, the one with the smallest index is selected.\n\nWithin-season dynamics: Given the chosen pesticide $\\hat p^{(t)}$, the number of survivors of genotype $g$ after treatment is\n$$\nS_g^{(t)} \\;=\\; N_g^{(t)} \\,\\Bigl(1 - b_{\\hat p^{(t)}} \\bigl(1 - R_{g,\\hat p^{(t)}}^{(t)}\\bigr)\\Bigr),\n$$\nand the total survivors are $S^{(t)} = \\sum_{g=0}^{G-1} S_g^{(t)}$. Resistance to the applied pesticide is updated using the survivors’ composition:\n$$\nR_{g,\\hat p^{(t)}}^{(t+1)} \\;=\\;\n\\begin{cases}\n\\min\\!\\Bigl\\{1,\\; R_{g,\\hat p^{(t)}}^{(t)} + a_{\\hat p^{(t)}} \\,\\dfrac{S_g^{(t)}}{S^{(t)}} \\Bigr\\},  \\text{if } S^{(t)}  0, \\\\\nR_{g,\\hat p^{(t)}}^{(t)},  \\text{if } S^{(t)} = 0,\n\\end{cases}\n$$\nwhile resistances to all non-applied pesticides remain unchanged within the season, that is $R_{g,p}^{(t+1)} = R_{g,p}^{(t)}$ for all $p \\ne \\hat p^{(t)}$. Populations then reproduce:\n$$\nN_g^{(t+1)} \\;=\\; S_g^{(t)} \\, r_g.\n$$\nInitial conditions $N_g^{(1)}$ and $R_{g,p}^{(1)}$ are given. After $T$ seasons, report the final total abundance\n$$\nN_{\\text{total}}^{(T+1)} \\;=\\; \\sum_{g=0}^{G-1} N_g^{(T+1)}.\n$$\n\nIndexing: Pesticide indices and genotype indices are zero-based, that is the smallest index is $0$.\n\nTask: Implement a program that carries out the above dynamics exactly and returns the final total abundance $N_{\\text{total}}^{(T+1)}$ for each of the independent test cases below. Round each reported value to $6$ decimal places. No physical units are involved.\n\nTest suite (each test case explicitly lists $G$, $P$, $T$, the initial abundance vector $N^{(1)}$, the growth factors $r$, the potency vector $b$, the initial resistance matrix $R^{(1)}$ with shape $G \\times P$, and adaptation rates $a$):\n\n- Test case $1$ (general case):\n  - $G = 3$, $P = 2$, $T = 8$.\n  - $N^{(1)} = [\\,500.0,\\;300.0,\\;200.0\\,]$.\n  - $r = [\\,1.2,\\;1.1,\\;1.05\\,]$.\n  - $b = [\\,0.6,\\;0.4\\,]$.\n  - $R^{(1)} = \\begin{bmatrix} 0.1  0.2 \\\\ 0.0  0.5 \\\\ 0.3  0.1 \\end{bmatrix}$.\n  - $a = [\\,0.2,\\;0.15\\,]$.\n\n- Test case $2$ (tie-breaking and no adaptation):\n  - $G = 2$, $P = 2$, $T = 3$.\n  - $N^{(1)} = [\\,100.0,\\;100.0\\,]$.\n  - $r = [\\,1.0,\\;1.0\\,]$.\n  - $b = [\\,0.5,\\;0.5\\,]$.\n  - $R^{(1)} = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$.\n  - $a = [\\,0.0,\\;0.0\\,]$.\n\n- Test case $3$ (initial high resistance to the stronger pesticide):\n  - $G = 2$, $P = 2$, $T = 5$.\n  - $N^{(1)} = [\\,1000.0,\\;10.0\\,]$.\n  - $r = [\\,1.05,\\;0.9\\,]$.\n  - $b = [\\,0.7,\\;0.3\\,]$.\n  - $R^{(1)} = \\begin{bmatrix} 0.9  0.0 \\\\ 0.9  0.0 \\end{bmatrix}$.\n  - $a = [\\,0.1,\\;0.05\\,]$.\n\n- Test case $4$ (declining growth and a nearly useless pesticide):\n  - $G = 1$, $P = 3$, $T = 4$.\n  - $N^{(1)} = [\\,50.0\\,]$.\n  - $r = [\\,0.8\\,]$.\n  - $b = [\\,0.9,\\;0.2,\\;0.0\\,]$.\n  - $R^{(1)} = \\begin{bmatrix} 0.0  0.5  0.0 \\end{bmatrix}$.\n  - $a = [\\,0.3,\\;0.0,\\;0.0\\,]$.\n\nFinal output format: Your program should produce a single line of output containing the four results in order, rounded to $6$ decimal places, as a comma-separated list enclosed in square brackets; for example, an output of the form $[x_1,x_2,x_3,x_4]$, where each $x_i$ is a real number rounded to $6$ decimal places.", "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\nThe problem describes a discrete-time model for a pest population under pesticide pressure.\n- State variables at the start of season $t$:\n  - $N_g^{(t)}$: Abundance of genotype $g$.\n  - $R_{g,p}^{(t)}$: Resistance level of genotype $g$ to pesticide $p$.\n- Indices:\n  - Genotypes: $g \\in \\{0, 1, \\dots, G-1\\}$.\n  - Pesticides: $p \\in \\{0, 1, \\dots, P-1\\}$.\n  - Seasons: $t \\in \\{1, 2, \\dots, T\\}$.\n- Parameters:\n  - $r_g$: Multiplicative growth factor for genotype $g$.\n  - $b_p$: Potency of pesticide $p$.\n  - $a_p$: Adaptation rate for pesticide $p$.\n- Initial conditions: $N_g^{(1)}$ and $R_{g,p}^{(1)}$ are given.\n- Decision rule for pesticide selection in season $t$:\n  - The chosen pesticide $\\hat p^{(t)}$ is the one that maximizes the immediate expected kill, $K_p^{(t)}$.\n  - $K_p^{(t)} = \\sum_{g=0}^{G-1} N_g^{(t)} \\, b_p \\, (1 - R_{g,p}^{(t)})$.\n  - Tie-breaking: If multiple pesticides yield the maximum $K_p^{(t)}$, the one with the smallest index $p$ is chosen.\n- Dynamics within season $t$:\n  - Survivors of genotype $g$: $S_g^{(t)} = N_g^{(t)} \\,(1 - b_{\\hat p^{(t)}} (1 - R_{g,\\hat p^{(t)}}^{(t)}))$.\n  - Total survivors: $S^{(t)} = \\sum_{g=0}^{G-1} S_g^{(t)}$.\n- Update rules for season $t+1$:\n  - Resistance update for applied pesticide $\\hat p^{(t)}$:\n    $$\n    R_{g,\\hat p^{(t)}}^{(t+1)} =\n    \\begin{cases}\n    \\min\\left\\{1, R_{g,\\hat p^{(t)}}^{(t)} + a_{\\hat p^{(t)}} \\frac{S_g^{(t)}}{S^{(t)}}\\right\\},  \\text{if } S^{(t)}  0 \\\\\n    R_{g,\\hat p^{(t)}}^{(t)},  \\text{if } S^{(t)} = 0\n    \\end{cases}\n    $$\n  - Resistance to non-applied pesticides $p \\ne \\hat p^{(t)}$ is unchanged: $R_{g,p}^{(t+1)} = R_{g,p}^{(t)}$.\n  - Population update: $N_g^{(t+1)} = S_g^{(t)} \\cdot r_g$.\n- Final output:\n  - Calculate the total abundance after $T$ seasons: $N_{\\text{total}}^{(T+1)} = \\sum_{g=0}^{G-1} N_g^{(T+1)}$.\n  - Report this value rounded to $6$ decimal places.\n- Test Cases: Four specific sets of parameters ($G, P, T, N^{(1)}, r, b, R^{(1)}, a$) are provided.\n\nStep 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria:\n- **Scientifically Grounded**: The model is a standard, albeit simplified, discrete-time population dynamics model. The concepts of exponential growth, dose-response (via potency $b_p$ and resistance $R_{g,p}^{(t)}$), and selection-driven resistance evolution are fundamental principles in population genetics and ecology. The model is scientifically sound.\n- **Well-Posed**: The problem provides a complete set of initial conditions and deterministic rules for the system's evolution. The pesticide selection rule is also deterministic, including a clear tie-breaking condition. This ensures that for a given set of inputs, a unique solution exists. The special case of zero total survivors ($S^{(t)} = 0$), which would lead to division by zero, is explicitly and correctly handled. The problem is well-posed.\n- **Objective**: The problem is stated in precise mathematical language, free from ambiguity, subjectivity, or opinion-based claims. All terms are clearly defined.\n- **Flaw Analysis**:\n  1. No scientific or factual unsoundness is present.\n  2. The problem is formalizable. The pesticide selection rule, which maximizes immediate kill, is a direct application of a greedy algorithm. The problem is therefore directly relevant to the *greedy algorithms paradigm* in the context of *computational biology*.\n  3. The setup is complete and internally consistent. All necessary data are provided for each test case.\n  4. The model parameters are within physically plausible ranges (e.g., $b_p, R_{g,p} \\in [0,1]$). There are no unrealistic or infeasible requirements.\n  5. The problem is not ill-posed or poorly structured.\n  6. The results are computationally verifiable.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided by implementing a simulation of the described dynamics.\n\nThe solution involves simulating the population and resistance dynamics over $T$ discrete time steps (seasons). The state of the system at the beginning of any season $t$ is defined by the vector of genotype abundances, $N^{(t)}$, and the matrix of genotype-pesticide resistances, $R^{(t)}$. The simulation proceeds as follows for each season $t$ from $1$ to $T$:\n\n1.  **Greedy Pesticide Selection**: For each available pesticide $p \\in \\{0, \\dots, P-1\\}$, the total immediate kill $K_p^{(t)}$ is computed. This quantity represents the expected number of individuals that would be eliminated if pesticide $p$ were applied in season $t$.\n    $$K_p^{(t)} = \\sum_{g=0}^{G-1} N_g^{(t)} \\, b_p \\, (1 - R_{g,p}^{(t)})$$\n    The pesticide $\\hat p^{(t)}$ that maximizes this value is selected. This is a \"greedy\" choice, as it optimizes the immediate outcome without regard for future consequences, such as the evolution of resistance. In case of a tie, the pesticide with the smallest index is selected.\n\n2.  **Population Dynamics**: The selected pesticide $\\hat p^{(t)}$ is applied. The number of survivors for each genotype $g$, denoted $S_g^{(t)}$, is calculated based on the pesticide's potency $b_{\\hat p^{(t)}}$ and the genotype's specific resistance $R_{g,\\hat p^{(t)}}^{(t)}$.\n    $$S_g^{(t)} = N_g^{(t)} \\, \\left(1 - b_{\\hat p^{(t)}} \\left(1 - R_{g,\\hat p^{(t)}}^{(t)}\\right)\\right)$$\n\n3.  **State Update**: The state variables are updated to reflect the conditions for the start of the next season, $t+1$.\n    - The populations of survivors reproduce. The new abundance for each genotype is found by multiplying the number of survivors by the genotype-specific growth factor $r_g$.\n      $$N_g^{(t+1)} = S_g^{(t)} \\cdot r_g$$\n    - Resistance to the applied pesticide $\\hat p^{(t)}$ evolves. The change in resistance is proportional to the adaptation rate $a_{\\hat p^{(t)}}$ and the relative frequency of the genotype among the survivors, $S_g^{(t)}/S^{(t)}$, where $S^{(t)} = \\sum S_g^{(t)}$. The new resistance is capped at a maximum value of $1$. Resistances to all other pesticides remain unchanged.\n      $$R_{g,\\hat p^{(t)}}^{(t+1)} = \\min\\left\\{1, R_{g,\\hat p^{(t)}}^{(t)} + a_{\\hat p^{(t)}} \\frac{S_g^{(t)}}{S^{(t)}}\\right\\} \\quad (\\text{for } S^{(t)}  0)$$\n      $$R_{g,p}^{(t+1)} = R_{g,p}^{(t)} \\quad (\\text{for } p \\ne \\hat p^{(t)})$$\n\nThis iterative process is repeated for $T$ seasons. After the dynamics of season $T$ are completed, the final state of the population, $N^{(T+1)}$, is obtained. The required output is the total final abundance, $\\sum_{g=0}^{G-1} N_g^{(T+1)}$. The implementation will utilize numerical libraries to perform these vector and matrix operations efficiently.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Executes the pest population dynamics simulation for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"G\": 3, \"P\": 2, \"T\": 8,\n            \"N1\": np.array([500.0, 300.0, 200.0]),\n            \"r\": np.array([1.2, 1.1, 1.05]),\n            \"b\": np.array([0.6, 0.4]),\n            \"R1\": np.array([[0.1, 0.2], [0.0, 0.5], [0.3, 0.1]]),\n            \"a\": np.array([0.2, 0.15])\n        },\n        # Test case 2 (tie-breaking and no adaptation)\n        {\n            \"G\": 2, \"P\": 2, \"T\": 3,\n            \"N1\": np.array([100.0, 100.0]),\n            \"r\": np.array([1.0, 1.0]),\n            \"b\": np.array([0.5, 0.5]),\n            \"R1\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n            \"a\": np.array([0.0, 0.0])\n        },\n        # Test case 3 (initial high resistance to the stronger pesticide)\n        {\n            \"G\": 2, \"P\": 2, \"T\": 5,\n            \"N1\": np.array([1000.0, 10.0]),\n            \"r\": np.array([1.05, 0.9]),\n            \"b\": np.array([0.7, 0.3]),\n            \"R1\": np.array([[0.9, 0.0], [0.9, 0.0]]),\n            \"a\": np.array([0.1, 0.05])\n        },\n        # Test case 4 (declining growth and a nearly useless pesticide)\n        {\n            \"G\": 1, \"P\": 3, \"T\": 4,\n            \"N1\": np.array([50.0]),\n            \"r\": np.array([0.8]),\n            \"b\": np.array([0.9, 0.2, 0.0]),\n            \"R1\": np.array([[0.0, 0.5, 0.0]]),\n            \"a\": np.array([0.3, 0.0, 0.0])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        G, P, T = case[\"G\"], case[\"P\"], case[\"T\"]\n        N = case[\"N1\"].copy()\n        r = case[\"r\"]\n        b = case[\"b\"]\n        R = case[\"R1\"].copy()\n        a = case[\"a\"]\n\n        for t in range(T):\n            # Step 1: Greedy Pesticide Selection\n            kill_k = np.zeros(P)\n            for p in range(P):\n                # K_p = sum(N_g * b_p * (1 - R_{g,p}))\n                kill_k[p] = np.sum(N * b[p] * (1 - R[:, p]))\n            \n            p_hat = np.argmax(kill_k)\n\n            # Step 2: Population Dynamics (Calculate Survivors)\n            # S_g = N_g * (1 - b_{p_hat} * (1 - R_{g, p_hat}))\n            survivor_proportions = 1.0 - b[p_hat] * (1.0 - R[:, p_hat])\n            S = N * survivor_proportions\n            S_total = np.sum(S)\n\n            # Step 3: State Update for Next Season\n            # Update population\n            N_next = S * r\n            \n            # Update resistance\n            R_next = R.copy()\n            if S_total  0:\n                resistance_increase = a[p_hat] * S / S_total\n                R_next[:, p_hat] = np.minimum(1.0, R[:, p_hat] + resistance_increase)\n\n            # Assign new state for the next iteration\n            N = N_next\n            R = R_next\n            \n        final_total_abundance = np.sum(N)\n        results.append(final_total_abundance)\n\n    # Format output as a list of strings rounded to 6 decimal places\n    formatted_results = [f'{res:.6f}' for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2396125"}]}