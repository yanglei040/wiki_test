{"hands_on_practices": [{"introduction": "When modeling processes within living cells, a crucial factor often overlooked is that cells grow and divide. This practice focuses on a foundational concept in cellular systems biology: accounting for the dilution of intracellular molecules as cell volume increases. By starting from the first principle of mass conservation, you will derive and solve a system of ODEs that explicitly includes a dilution term, providing a more realistic model of concentration dynamics in an exponentially growing cell [@problem_id:2411220]. Mastering this is essential for accurately modeling metabolism, gene expression, and signaling in any proliferating cell population.", "problem": "You are tasked with constructing and simulating a mechanistic Ordinary Differential Equation (ODE) model in the context of systems biology for an exponentially growing cell whose volume is itself a dynamic variable. The model must be derived from first principles of conservation of molecules and dilution due to volume growth, and then evaluated for a specified test suite.\n\nConsider a single well-mixed cell with volume $V(t)$ that grows exponentially according to the differential equation\n$$\n\\frac{dV}{dt} = g \\, V,\n$$\nwhere $g$ is the specific growth rate. Let $A(t)$ and $B(t)$ denote the intracellular concentrations (in micromolar, $\\mu \\mathrm{M}$) of two species $A$ and $B$. Assume the following biochemical processes per unit volume:\n- Species $A$ is produced at a constant rate $q_A$ (in $\\mu \\mathrm{M} \\cdot \\mathrm{h}^{-1}$).\n- Species $A$ is converted to $B$ with first-order kinetics at rate constant $k_1$ (in $\\mathrm{h}^{-1}$).\n- Species $B$ is degraded with first-order kinetics at rate constant $k_2$ (in $\\mathrm{h}^{-1}$).\n\nAssume that intracellular concentrations are diluted by volume growth. Starting from the definition $C_i(t) = N_i(t)/V(t)$, where $N_i(t)$ is the molecule amount of species $i$, and applying the quotient rule to $\\frac{d}{dt}(N_i/V)$, derive the ODEs for $A(t)$ and $B(t)$ under the above reaction scheme, incorporating dilution by growth. Use the initial conditions $A(0) = A_0$, $B(0) = B_0$, and $V(0) = V_0$. Time $t$ is measured in hours, volume $V$ is measured in femtoliters (fL), and concentrations $A$ and $B$ are measured in micromolar ($\\mu \\mathrm{M}$).\n\nYour program must compute, for each test case, the triplet $[A(T), B(T), V(T)]$ at a specified final time $T$ (in hours), given parameters $g$, $q_A$, $k_1$, $k_2$, and initial conditions $A_0$, $B_0$, $V_0$. All reported concentrations must be in $\\mu \\mathrm{M}$ and cell volume in $\\mathrm{fL}$. The results for each test case must be rounded to $4$ decimal places.\n\nTest Suite (each tuple is $(g, q_A, k_1, k_2, T, A_0, B_0, V_0)$ with units $(\\mathrm{h}^{-1}, \\mu\\mathrm{M}\\cdot\\mathrm{h}^{-1}, \\mathrm{h}^{-1}, \\mathrm{h}^{-1}, \\mathrm{h}, \\mu\\mathrm{M}, \\mu\\mathrm{M}, \\mathrm{fL})$):\n- Case $1$ (general case): $(0.2, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0)$.\n- Case $2$ (no growth, boundary): $(0.0, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0)$.\n- Case $3$ (no production, edge with preloaded pools): $(0.3, 0.0, 0.7, 0.4, 4.0, 5.0, 2.0, 1.5)$.\n- Case $4$ (fast growth, strong dilution): $(1.0, 10.0, 1.0, 0.5, 3.0, 0.0, 0.0, 2.0)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of three floats $[A(T),B(T),V(T)]$ in the specified units, each value rounded to $4$ decimal places. For example, a valid output with two cases would look like $[[a_1,b_1,v_1],[a_2,b_2,v_2]]$ with no spaces.", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of chemical kinetics and systems biology, is well-posed as a solvable initial value problem, and is free of ambiguity or contradiction.\n\nThe core of this problem is to derive and solve a system of ordinary differential equations (ODEs) that describe the concentrations of two molecular species, $A$ and $B$, within a single cell whose volume, $V(t)$, is increasing exponentially.\n\n**1. Derivation of the Governing Equations**\n\nThe fundamental principle governing the concentration $C_i$ of a species $i$ in a changing volume $V$ is derived from the conservation of mass. The concentration is defined as the total amount of molecules $N_i$ divided by the volume $V$, i.e., $C_i(t) = N_i(t) / V(t)$. Applying the quotient rule for differentiation with respect to time $t$ gives:\n$$\n\\frac{dC_i}{dt} = \\frac{d}{dt}\\left(\\frac{N_i}{V}\\right) = \\frac{1}{V}\\frac{dN_i}{dt} - \\frac{N_i}{V^2}\\frac{dV}{dt}\n$$\nThe problem states that the volume grows exponentially, $\\frac{dV}{dt} = gV$, where $g$ is the specific growth rate. Substituting this and $C_i = N_i/V$ into the equation yields:\n$$\n\\frac{dC_i}{dt} = \\frac{1}{V}\\frac{dN_i}{dt} - \\frac{C_i V}{V^2}(gV) = \\frac{1}{V}\\frac{dN_i}{dt} - gC_i\n$$\nThis equation is a cornerstone of modeling in growing systems. The term $\\frac{1}{V}\\frac{dN_i}{dt}$ represents the rate of change of concentration due to biochemical reactions, while the term $-gC_i$ represents the dilution of the species due to the expansion of the volume.\n\nThe problem specifies the reaction kinetics in terms of concentration rates (per unit volume):\n- For species $A$: Production at a constant rate $q_A$ and first-order conversion to $B$ at a rate $-k_1 A$.\n- For species $B$: Production from $A$ at a rate $k_1 A$ and first-order degradation at a rate $-k_2 B$.\n\nThese correspond to the reaction term $\\frac{1}{V}\\frac{dN_i}{dt}$. We can now formulate the complete system of ODEs.\n\nFor volume $V(t)$:\n$$\n\\frac{dV}{dt} = gV, \\quad V(0) = V_0\n$$\nFor concentration $A(t)$:\n$$\n\\frac{dA}{dt} = \\underbrace{(q_A - k_1 A)}_{\\text{Reactions}} - \\underbrace{gA}_{\\text{Dilution}} = q_A - (k_1 + g)A, \\quad A(0) = A_0\n$$\nFor concentration $B(t)$:\n$$\n\\frac{dB}{dt} = \\underbrace{(k_1 A - k_2 B)}_{\\text{Reactions}} - \\underbrace{gB}_{\\text{Dilution}} = k_1 A - (k_2 + g)B, \\quad B(0) = B_0\n$$\nThis is a system of three linear, first-order ordinary differential equations with constant coefficients. This system is amenable to an exact analytical solution, which is superior to numerical integration as it is free from approximation errors.\n\n**2. Analytical Solution of the ODE System**\n\nThe equations are decoupled or can be solved sequentially.\n\n**Volume $V(t)$:**\nThe equation $\\frac{dV}{dt} = gV$ is solved by separation of variables, yielding the standard exponential growth formula:\n$$\nV(t) = V_0 e^{gt}\n$$\n\n**Concentration $A(t)$:**\nLet $K_A = k_1 + g$. The ODE is $\\frac{dA}{dt} + K_A A = q_A$. This is a linear first-order ODE. Assuming $K_A \\neq 0$ (which is true for all test cases as $k_1 > 0$ or $g > 0$), the solution is:\n$$\nA(t) = \\frac{q_A}{K_A} + \\left(A_0 - \\frac{q_A}{K_A}\\right)e^{-K_A t}\n$$\nThe term $\\frac{q_A}{K_A}$ represents the steady-state concentration $A_{ss}$ that would be reached if time went to infinity.\n\n**Concentration $B(t)$:**\nLet $K_B = k_2 + g$. The ODE is $\\frac{dB}{dt} + K_B B = k_1 A(t)$. This is another linear first-order ODE, but it is non-homogeneous with a time-varying forcing term $k_1A(t)$. We substitute the solution for $A(t)$ and solve.\n\nThe solution methodology depends on whether $K_A = K_B$ (i.e., $k_1 = k_2$). For all test cases provided, $k_1 \\neq k_2$, so $K_A \\neq K_B$. The general solution for this case is derived using an integrating factor or an equivalent method like \"variation of parameters\" or \"undetermined coefficients\". The solution is of the form $B(t) = B_p(t) + B_h(t)$, where $B_h(t)$ is the homogeneous solution and $B_p(t)$ is a particular solution.\n\nThe resulting analytical solution for $B(t)$ is:\n$$\nB(t) = C_1 + C_2 e^{-K_A t} + C_3 e^{-K_B t}\n$$\nwhere the coefficients $C_1$, $C_2$, and $C_3$ are constants determined by the parameters and initial conditions:\n$$\nC_1 = \\frac{k_1 q_A}{K_A K_B} = \\frac{k_1 q_A}{(k_1+g)(k_2+g)}\n$$\n$$\nC_2 = \\frac{k_1(A_0 - q_A/K_A)}{K_B - K_A} = \\frac{k_1(A_0(k_1+g) - q_A)}{(k_1+g)(k_2-k_1)}\n$$\n$$\nC_3 = B_0 - C_1 - C_2\n$$\n\n**3. Algorithmic Implementation**\n\nThe program will implement these exact analytical solutions. For each test case, the following steps are performed:\n1.  Extract the parameters $g, q_A, k_1, k_2, T$ and initial conditions $A_0, B_0, V_0$.\n2.  Calculate $V(T)$ using its analytical formula.\n3.  Define the constants $K_A = k_1 + g$ and $K_B = k_2 + g$.\n4.  Calculate $A(T)$ using its analytical formula. A check for $K_A=0$ is included for robustness, though not required by the test suite.\n5.  Calculate the coefficients $C_1$, $C_2$, and $C_3$ for the solution of $B(t)$.\n6.  Calculate $B(T)$ using its analytical formula. All test cases satisfy $k_1 \\neq k_2$, so the specific formula for $k_1 = k_2$ is not strictly needed but is good practice to consider.\n7.  The computed values for $A(T)$, $B(T)$, and $V(T)$ are rounded to $4$ decimal places.\n8.  The results for all test cases are collected and formatted into a single string as specified by the problem.\n\nThis approach ensures maximum precision and computational efficiency.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and simulates a mechanistic ODE model for an exponentially growing cell.\n    The solution is derived analytically and implemented to compute the state of the system\n    [A(T), B(T), V(T)] at a final time T for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (g, q_A, k_1, k_2, T, A_0, B_0, V_0)\n        (0.2, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0),\n        (0.0, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0),\n        (0.3, 0.0, 0.7, 0.4, 4.0, 5.0, 2.0, 1.5),\n        (1.0, 10.0, 1.0, 0.5, 3.0, 0.0, 0.0, 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        g, q_A, k_1, k_2, T, A_0, B_0, V_0 = case\n\n        # 1. Solve for V(T)\n        V_T = V_0 * np.exp(g * T)\n\n        # 2. Solve for A(T)\n        K_A = k_1 + g\n        if K_A == 0:\n            # Handles the case g=0 and k1=0. A(t) grows linearly.\n            A_T = A_0 + q_A * T\n        else:\n            A_ss = q_A / K_A\n            A_T = A_ss + (A_0 - A_ss) * np.exp(-K_A * T)\n\n        # 3. Solve for B(T)\n        K_B = k_2 + g\n        \n        # Check for the special case k1 = k2, which implies K_A = K_B\n        if abs(k_1 - k_2) < 1e-9: # Use a tolerance for float comparison\n            if K_A == 0: # This implies k1=k2=g=0\n                # A(t) = A_0 + q_A*t\n                # dB/dt = 0, because k1=0\n                B_T = B_0\n            else:\n                A_ss = q_A / K_A\n                term1 = B_0 * np.exp(-K_A * T)\n                term2 = (k_1 * A_ss / K_A) * (1 - np.exp(-K_A * T))\n                term3 = k_1 * (A_0 - A_ss) * T * np.exp(-K_A * T)\n                B_T = term1 + term2 + term3\n        else:\n            # General case k1 != k2\n            if K_A == 0 or K_B == 0:\n                # This logic is more complex and not required by test cases.\n                # A full implementation would handle these edge cases.\n                # For this problem, we rely on test cases not hitting this.\n                # For instance, if K_A=0, A(t) is linear, integral for B is different.\n                # If K_B=0, integrating factor metod for B changes.\n                pass\n            \n            C1 = (k_1 * q_A) / (K_A * K_B)\n            # Denominator is K_B - K_A = (k2+g) - (k1+g) = k2 - k1\n            C2 = (k_1 * (A_0 - q_A / K_A)) / (k_2 - k_1)\n            C3 = B_0 - C1 - C2\n            \n            B_T = C1 + C2 * np.exp(-K_A * T) + C3 * np.exp(-K_B * T)\n            \n        # Round results to 4 decimal places\n        A_T_rounded = round(A_T, 4)\n        B_T_rounded = round(B_T, 4)\n        V_T_rounded = round(V_T, 4)\n\n        results.append([A_T_rounded, B_T_rounded, V_T_rounded])\n\n    # Format the final output string to exactly match the requirement,\n    # which is a list of lists with no spaces.\n    # str(results) produces \"'[[...], [...]]'\", replace(\" \", \"\") removes spaces.\n    final_output_string = str(results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```", "id": "2411220"}, {"introduction": "One of the great triumphs of systems and synthetic biology is the ability to design gene circuits that perform predictable computational functions. This exercise challenges you to analyze a synthetic circuit designed to act as a band-pass filter, where a reporter gene is expressed only at intermediate levels of an input signal. You will explore how a specific network motif, the incoherent feed-forward loop, achieves this non-monotonic response by analyzing the system's algebraic steady-state equations rather than simulating its full dynamics over time [@problem_id:2411191]. This approach highlights the powerful connection between a network's structure and its ultimate function.", "problem": "A synthetic gene circuit is designed to implement a band-pass filter: the reporter species responds strongly only to intermediate levels of an exogenous input $I$, and weakly to very low or very high $I$. Consider the following ordinary differential equation (ODE) model with three state variables: $A(t)$ (activator), $R(t)$ (repressor), and $Y(t)$ (reporter). The input $I$ is a constant exogenous signal. All concentrations are in nanomolar (nM), and time is in minutes (min). Parameters have the following units: production rates in nM/min, degradation rates in $1/\\text{min}$, Hill constants in nM, and Hill coefficients dimensionless.\n\nThe model is\n$$\n\\frac{dA}{dt} \\;=\\; k_a \\,\\frac{I^{n}}{K_a^{n} + I^{n}} \\;-\\; d_a\\,A,\n$$\n$$\n\\frac{dR}{dt} \\;=\\; k_r \\,\\frac{I^{m}}{K_r^{m} + I^{m}} \\;-\\; d_r\\,R,\n$$\n$$\n\\frac{dY}{dt} \\;=\\; k_y \\,\\frac{A^{p}}{K_y^{p} + A^{p}} \\;\\cdot\\; \\frac{K_i^{q}}{K_i^{q} + R^{q}} \\;-\\; d_y\\,Y.\n$$\n\nHere $I$ activates both $A$ and $R$ via sigmoidal Hill functions with exponents $n$ and $m$, $A$ activates $Y$ with Hill exponent $p$, and $R$ represses $Y$ with Hill exponent $q$ through a decreasing Hill factor. Assume initial conditions $A(0)=0\\,\\text{nM}$, $R(0)=0\\,\\text{nM}$, and $Y(0)=0\\,\\text{nM}$. For any fixed constant $I$, define the steady-state reporter concentration $Y^\\ast(I)$ as the limit of $Y(t)$ as $t \\to \\infty$.\n\nYour task is to determine, for each parameter set listed below, the steady-state reporter response $Y^\\ast(I)$ on a specified grid of input values and to extract summary statistics that characterize band-pass behavior. You must use the input grid\n$$\nI \\in \\{\\,0,10,20,\\dots,500\\,\\}\\ \\text{nM},\n$$\nwhich is $51$ evenly spaced points from $0$ to $500$ nM inclusive.\n\nFor each parameter set, compute:\n- the steady-state value $Y^\\ast(I)$ for every $I$ on the grid,\n- the input value $I_{\\text{peak}}$ (in nM) within the grid that maximizes $Y^\\ast(I)$ (if multiple values attain the same maximum within numerical precision, choose the smallest $I$ on the grid),\n- the corresponding maximum $Y_{\\text{peak}} = \\max_I Y^\\ast(I)$ (in nM),\n- the values $Y^\\ast(0)$ and $Y^\\ast(500)$ (in nM).\n\nUse the following test suite of parameter sets (units as specified above):\n\n- Test Case $1$:\n  - $k_a = 50$, $d_a = 1$, $K_a = 50$, $n = 2$;\n  - $k_r = 40$, $d_r = 1$, $K_r = 80$, $m = 2$;\n  - $k_y = 120$, $d_y = 1$, $K_y = 30$, $p = 2$;\n  - $K_i = 60$, $q = 2$.\n\n- Test Case $2$:\n  - $k_a = 50$, $d_a = 1$, $K_a = 40$, $n = 2$;\n  - $k_r = 120$, $d_r = 1.5$, $K_r = 50$, $m = 3$;\n  - $k_y = 120$, $d_y = 1$, $K_y = 25$, $p = 2$;\n  - $K_i = 30$, $q = 2$.\n\n- Test Case $3$:\n  - $k_a = 60$, $d_a = 1$, $K_a = 40$, $n = 2$;\n  - $k_r = 10$, $d_r = 1$, $K_r = 100$, $m = 2$;\n  - $k_y = 120$, $d_y = 1$, $K_y = 30$, $p = 2$;\n  - $K_i = 10000$, $q = 1$.\n\nAll reported values must be expressed in nanomolar (nM) for concentrations and in nanomolar (nM) for the input $I$. Round every number in the final output to $3$ decimal places.\n\nFinal output format: Your program should produce a single line containing a comma-separated flat list enclosed in square brackets. The list must contain, in order, for Test Case $1$, then Test Case $2$, then Test Case $3$, the quadruples\n$$\n\\big[\\,I_{\\text{peak}},\\ Y_{\\text{peak}},\\ Y^\\ast(0),\\ Y^\\ast(500)\\,\\big]\n$$\nfor each test in sequence, concatenated into one flat list. For example, the output must look like\n$$\n[\\ I_{\\text{peak},1},\\ Y_{\\text{peak},1},\\ Y^\\ast_1(0),\\ Y^\\ast_1(500),\\ I_{\\text{peak},2},\\ \\dots,\\ I_{\\text{peak},3},\\ \\dots\\ ],\n$$\nwith every number rounded to $3$ decimal places and no additional text.", "solution": "The problem is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Model Equations:**\n$$\n\\frac{dA}{dt} \\;=\\; k_a \\,\\frac{I^{n}}{K_a^{n} + I^{n}} \\;-\\; d_a\\,A\n$$\n$$\n\\frac{dR}{dt} \\;=\\; k_r \\,\\frac{I^{m}}{K_r^{m} + I^{m}} \\;-\\; d_r\\,R\n$$\n$$\n\\frac{dY}{dt} \\;=\\; k_y \\,\\frac{A^{p}}{K_y^{p} + A^{p}} \\;\\cdot\\; \\frac{K_i^{q}}{K_i^{q} + R^{q}} \\;-\\; d_y\\,Y\n$$\n- **State Variables and Input:** $A(t)$, $R(t)$, $Y(t)$, and a constant input $I$.\n- **Initial Conditions:** $A(0)=0$, $R(0)=0$, $Y(0)=0$.\n- **Objective:** For a fixed $I$, find the steady-state concentration $Y^\\ast(I) = \\lim_{t \\to \\infty} Y(t)$.\n- **Input Grid:** $I \\in \\{0, 10, 20, \\dots, 500\\}$.\n- **Tasks:** For each parameter set, compute $I_{\\text{peak}}$, $Y_{\\text{peak}}$, $Y^\\ast(0)$, and $Y^\\ast(500)$.\n- **Parameter Sets:** Three distinct test cases are provided with all necessary parameter values ($k_a, d_a, K_a, n, k_r, d_r, K_r, m, k_y, d_y, K_y, p, K_i, q$).\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing a standard ordinary differential equation (ODE) model based on Hill kinetics, a cornerstone of systems biology for describing gene regulation. This model represents a Type-1 Incoherent Feed-Forward Loop, a well-studied network motif. The problem is well-posed: the task is to compute the system's steady state, which is uniquely determined by a set of algebraic equations derived from the ODEs, and then to perform a simple analysis on these steady-state values over a discrete input grid. The problem is objective, self-contained, and internally consistent, providing all necessary parameters and specifications. The parameters are within physically plausible ranges for synthetic biology. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be provided.\n\nThe core of the problem is to determine the steady-state concentrations of the species $A$, $R$, and $Y$ as a function of the input signal $I$. The steady state is defined by the condition that all time derivatives are zero.\nSetting $\\frac{dA}{dt} = 0$, $\\frac{dR}{dt} = 0$, and $\\frac{dY}{dt} = 0$, we obtain a system of algebraic equations for the steady-state concentrations, denoted $A^\\ast$, $R^\\ast$, and $Y^\\ast$.\n\nFrom the equation for $A$, we have:\n$$\nk_a \\,\\frac{I^{n}}{K_a^{n} + I^{n}} \\;-\\; d_a\\,A^\\ast = 0 \\quad \\implies \\quad A^\\ast(I) = \\frac{k_a}{d_a} \\frac{I^{n}}{K_a^{n} + I^{n}}\n$$\nSimilarly, from the equation for $R$:\n$$\nk_r \\,\\frac{I^{m}}{K_r^{m} + I^{m}} \\;-\\; d_r\\,R^\\ast = 0 \\quad \\implies \\quad R^\\ast(I) = \\frac{k_r}{d_r} \\frac{I^{m}}{K_r^{m} + I^{m}}\n$$\nThe steady-state expressions for $A^\\ast$ and $R^\\ast$ depend only on the input $I$ and their respective parameters. These can be substituted into the steady-state equation for $Y$:\n$$\nk_y \\,\\frac{(A^\\ast)^{p}}{K_y^{p} + (A^\\ast)^{p}} \\;\\cdot\\; \\frac{K_i^{q}}{K_i^{q} + (R^\\ast)^{q}} \\;-\\; d_y\\,Y^\\ast = 0\n$$\nSolving for $Y^\\ast$ gives its dependence on $A^\\ast$ and $R^\\ast$, and thus implicitly on $I$:\n$$\nY^\\ast(I) = \\frac{k_y}{d_y} \\left( \\frac{(A^\\ast(I))^{p}}{K_y^{p} + (A^\\ast(I))^{p}} \\right) \\left( \\frac{K_i^{q}}{K_i^{q} + (R^\\ast(I))^{q}} \\right)\n$$\nThese algebraic equations provide a direct and computationally efficient method to calculate the steady-state response $Y^\\ast$ for any given input $I$, bypassing the need for numerical integration of the ODEs.\n\nThe computational strategy is as follows:\n1. For each of the three test cases, the given parameter set is used.\n2. An input grid for $I$ is generated as specified: $I = \\{0, 10, 20, \\dots, 500\\}$.\n3. For each value of $I$ in the grid, the steady-state concentrations $A^\\ast(I)$, $R^\\ast(I)$, and $Y^\\ast(I)$ are calculated using the derived algebraic formulae. This is implemented using vectorized operations for efficiency.\n4. The resulting array of $Y^\\ast$ values is analyzed to find the required statistics:\n   - $Y_{\\text{peak}}$ is the maximum value in the $Y^\\ast$ array.\n   - $I_{\\text{peak}}$ is the value of $I$ from the grid corresponding to the first occurrence of $Y_{\\text{peak}}$.\n   - $Y^\\ast(0)$ is the first element of the $Y^\\ast$ array, corresponding to $I=0$.\n   - $Y^\\ast(500)$ is the last element of the $Y^\\ast$ array, corresponding to $I=500$.\n5. The resulting four values for each test case—$I_{\\text{peak}}$, $Y_{\\text{peak}}$, $Y^\\ast(0)$, $Y^\\ast(500)$—are collected and formatted as a single flat list, with numerical values rounded to three decimal places.\n\nThis procedure is deterministic and directly addresses all requirements of the problem statement. The structure of the model (an incoherent feed-forward loop) is expected to produce band-pass behavior for parameter sets where the repressor arm is sufficiently strong and activated at higher input levels than the activator arm (Test Cases $1$ and $2$). For Test Case $3$, the repression is designed to be negligible ($K_i$ is very large), which should result in a simple low-pass (saturating) response where the peak output occurs at the maximum input level. This provides a logical check on the implementation. At $I=0$, $A^\\ast(0)=0$ and $R^\\ast(0)=0$, which leads to $Y^\\ast(0) = 0$ for all cases, as the activation term for $Y$ becomes zero. This serves as another elementary check.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the synthetic gene circuit problem by calculating steady-state responses\n    for three different parameter sets and extracting summary statistics.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            # k_a, d_a, K_a, n\n            'activator': (50.0, 1.0, 50.0, 2.0),\n            # k_r, d_r, K_r, m\n            'repressor': (40.0, 1.0, 80.0, 2.0),\n            # k_y, d_y, K_y, p\n            'reporter':  (120.0, 1.0, 30.0, 2.0),\n            # K_i, q\n            'inhibition': (60.0, 2.0)\n        },\n        # Test Case 2\n        {\n            'activator': (50.0, 1.0, 40.0, 2.0),\n            'repressor': (120.0, 1.5, 50.0, 3.0),\n            'reporter':  (120.0, 1.0, 25.0, 2.0),\n            'inhibition': (30.0, 2.0)\n        },\n        # Test Case 3\n        {\n            'activator': (60.0, 1.0, 40.0, 2.0),\n            'repressor': (10.0, 1.0, 100.0, 2.0),\n            'reporter':  (120.0, 1.0, 30.0, 2.0),\n            'inhibition': (10000.0, 1.0)\n        }\n    ]\n\n    # Define the input grid for I.\n    I_grid = np.arange(0, 501, 10, dtype=float)\n    \n    # Store all results in a flat list.\n    all_results = []\n\n    for params in test_cases:\n        # Unpack parameters for clarity.\n        k_a, d_a, K_a, n = params['activator']\n        k_r, d_r, K_r, m = params['repressor']\n        k_y, d_y, K_y, p = params['reporter']\n        K_i, q = params['inhibition']\n\n        # --- Calculate steady-state concentrations using vectorized numpy operations ---\n        \n        # Calculate A*(I)\n        I_n = np.power(I_grid, n)\n        Ka_n = K_a**n\n        # Add a small epsilon to the denominator to prevent division by zero at I=0 if K_a=0\n        A_ss = (k_a / d_a) * (I_n / (Ka_n + I_n + 1e-12))\n        \n        # Calculate R*(I)\n        I_m = np.power(I_grid, m)\n        Kr_m = K_r**m\n        R_ss = (k_r / d_r) * (I_m / (Kr_m + I_m + 1e-12))\n        \n        # Calculate Y*(I)\n        A_ss_p = np.power(A_ss, p)\n        Ky_p = K_y**p\n        activation_term = A_ss_p / (Ky_p + A_ss_p + 1e-12)\n\n        R_ss_q = np.power(R_ss, q)\n        Ki_q = K_i**q\n        repression_term = Ki_q / (Ki_q + R_ss_q + 1e-12)\n        \n        Y_ss_values = (k_y / d_y) * activation_term * repression_term\n\n        # --- Extract summary statistics ---\n        \n        # Find Y_peak and I_peak. np.argmax returns the index of the first maximum.\n        Y_peak = np.max(Y_ss_values)\n        peak_index = np.argmax(Y_ss_values)\n        I_peak = I_grid[peak_index]\n\n        # Get Y*(0) and Y*(500) from the computed array.\n        Y_ss_0 = Y_ss_values[0]\n        Y_ss_500 = Y_ss_values[-1]\n\n        # Append the quadruple to the list of all results.\n        all_results.extend([I_peak, Y_peak, Y_ss_0, Y_ss_500])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{x:.3f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2411191"}, {"introduction": "The predictive power of ODE models extends beyond the cellular scale to entire ecosystems. This practice delves into the classic Rosenzweig-MacArthur predator-prey model to explore how interactions between populations can lead to complex dynamics. You will determine the stability of the ecosystem's coexistence equilibrium and uncover the famous \"paradox of enrichment,\" where increasing the prey's resources can paradoxically lead to oscillations and instability [@problem_id:2411240]. This exercise introduces the essential technique of local stability analysis using the Jacobian matrix, a cornerstone for understanding bifurcations and emergent behaviors in any nonlinear dynamical system.", "problem": "Consider the Rosenzweig–MacArthur predator–prey model with a Holling type II functional response, which is a standard ordinary differential equation (ODE) model used in systems biology to study trophic interactions and the paradox of enrichment. The model is given by\n$$\n\\frac{dR}{dt} = r\\,R\\left(1 - \\frac{R}{K}\\right) - \\frac{a\\,R}{1 + a h R}\\,P,\\qquad\n\\frac{dP}{dt} = e\\,\\frac{a\\,R}{1 + a h R}\\,P - m\\,P,\n$$\nwhere $R$ denotes the prey (resource) density, $P$ denotes the predator density, $r$ is the intrinsic prey growth rate, $K$ is the prey carrying capacity, $a$ is the predator attack rate, $h$ is the predator handling time, $e$ is the conversion efficiency, and $m$ is the predator mortality rate. All parameters are positive and dimensionless.\n\nFor fixed parameters\n$$\nr = 1.0,\\quad a = 1.0,\\quad h = 0.5,\\quad e = 0.5,\\quad m = 0.2,\n$$\nand for each specified value of $K$, determine whether the unique positive coexistence equilibrium (if it exists) is locally asymptotically stable in the dynamical systems sense. If a positive coexistence equilibrium does not exist for a given $K$, treat the answer for that case as not locally asymptotically stable.\n\nTest suite:\n- Use the following four values of $K$ in this exact order:\n$K \\in \\{1.0, 3.0, 5.0, 0.5\\}$.\n\nYour program must compute, for each $K$ in the test suite, a boolean indicating whether the positive coexistence equilibrium (if it exists) is locally asymptotically stable (output $True$) or not (output $False$). If the positive coexistence equilibrium does not exist, output $False$ for that case.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), in the same order as the $K$ values are given above. No spaces should appear in the output line.\n- No physical units are required because all parameters are dimensionless. Angles are not involved. Do not use percentages anywhere; all numerical outputs are booleans as specified.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Model:** The Rosenzweig–MacArthur predator–prey model is given by the system of ordinary differential equations:\n$$\n\\frac{dR}{dt} = r\\,R\\left(1 - \\frac{R}{K}\\right) - \\frac{a\\,R}{1 + a h R}\\,P\n$$\n$$\n\\frac{dP}{dt} = e\\,\\frac{a\\,R}{1 + a h R}\\,P - m\\,P\n$$\n- **Variables:** $R$ is prey density, $P$ is predator density.\n- **Parameters:** $r$ (prey growth rate), $K$ (prey carrying capacity), $a$ (predator attack rate), $h$ (predator handling time), $e$ (conversion efficiency), $m$ (predator mortality rate). All parameters are positive and dimensionless.\n- **Fixed Parameter Values:** $r = 1.0$, $a = 1.0$, $h = 0.5$, $e = 0.5$, $m = 0.2$.\n- **Test Suite:** The carrying capacity $K$ takes values from the set $\\{1.0, 3.0, 5.0, 0.5\\}$.\n- **Task:** For each value of $K$, determine if the unique positive coexistence equilibrium is locally asymptotically stable. If such an equilibrium does not exist, the answer is `False`.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The Rosenzweig–MacArthur model is a canonical, well-established model in theoretical ecology and systems biology. It is scientifically sound.\n- **Well-Posed:** The problem is a standard stability analysis of a dynamical system. It is clearly defined, with all necessary parameters and conditions provided to find a unique answer for each case.\n- **Objective:** The problem is stated using precise mathematical language and quantitative data. It is free from subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-defined, scientifically grounded exercise in the stability analysis of a dynamical system relevant to computational biology. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe primary task is to determine the local asymptotic stability of the positive coexistence equilibrium $(R^*, P^*)$ of the given system, where $R^*>0$ and $P^*>0$.\n\nFirst, we find the equilibrium by setting the time derivatives to zero:\n$$\nR\\left(r\\left(1 - \\frac{R}{K}\\right) - \\frac{a\\,P}{1 + a h R}\\right) = 0\n$$\n$$\nP\\left(e\\,\\frac{a\\,R}{1 + a h R} - m\\right) = 0\n$$\nThe second equation yields either $P=0$ or $e\\,\\frac{a\\,R}{1 + a h R} - m = 0$. For a coexistence equilibrium, we require $P^* > 0$. Thus, the non-trivial condition must hold for the prey density $R^*$:\n$$\ne\\,\\frac{a\\,R^*}{1 + a h R^*} = m\n$$\nSolving for $R^*$:\n$$\ne a R^* = m (1 + a h R^*) \\implies R^*(ea - mah) = m \\implies R^* = \\frac{m}{a(e - mh)}\n$$\nFor $R^*$ to be positive, given that $a, m, h$ are positive, the denominator must be positive: $e - mh > 0$. Using the provided parameters: $e=0.5$, $m=0.2$, $h=0.5$, we check this condition: $0.5 - (0.2)(0.5) = 0.5 - 0.1 = 0.4 > 0$. The condition is satisfied.\nWe calculate the numerical value of $R^*$:\n$$\nR^* = \\frac{0.2}{1.0 \\times (0.5 - 0.2 \\times 0.5)} = \\frac{0.2}{0.4} = 0.5\n$$\nNow, we use the first equilibrium equation to find $P^*$. With $R^* > 0$, we can divide by $R$:\n$$\nr\\left(1 - \\frac{R^*}{K}\\right) - \\frac{a\\,P^*}{1 + a h R^*} = 0\n$$\nSolving for $P^*$:\n$$\nP^* = \\frac{r(1 + a h R^*)}{a} \\left(1 - \\frac{R^*}{K}\\right)\n$$\nFor $P^*$ to be positive, since all parameters and $R^*$ are positive, we must have $1 - \\frac{R^*}{K} > 0$, which implies $K > R^*$.\nTherefore, a unique positive coexistence equilibrium exists if and only if $K > R^*$. If $K \\le R^*$, no such equilibrium exists, and by the problem definition, the case is considered not stable.\n\nNext, we analyze the local stability of this equilibrium using the Jacobian matrix of the system, evaluated at $(R^*, P^*)$. Let the system be $\\frac{dR}{dt}=f(R,P)$ and $\\frac{dP}{dt}=g(R,P)$. The Jacobian matrix is:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial R} & \\frac{\\partial f}{\\partial P} \\\\ \\frac{\\partial g}{\\partial R} & \\frac{\\partial g}{\\partial P} \\end{pmatrix}_{(R^*, P^*)}\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial f}{\\partial R} = r - \\frac{2rR}{K} - \\frac{aP}{(1+ahR)^2}\n$$\n$$\n\\frac{\\partial f}{\\partial P} = -\\frac{aR}{1+ahR}\n$$\n$$\n\\frac{\\partial g}{\\partial R} = \\frac{eaP}{(1+ahR)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial P} = \\frac{eaR}{1+ahR} - m\n$$\nAt the equilibrium $(R^*, P^*)$, the term $\\frac{\\partial g}{\\partial P}$ simplifies to zero from the condition used to find $R^*$.\nThe other terms evaluated at the equilibrium are:\n$J_{11} = \\frac{\\partial f}{\\partial R}\\Big|_{(R^*, P^*)} = r - \\frac{2rR^*}{K} - \\frac{aP^*}{(1+ahR^*)^2}$\n$J_{12} = \\frac{\\partial f}{\\partial P}\\Big|_{(R^*, P^*)} = -\\frac{aR^*}{1+ahR^*}$\n$J_{21} = \\frac{\\partial g}{\\partial R}\\Big|_{(R^*, P^*)} = \\frac{eaP^*}{(1+ahR^*)^2}$\n$J_{22} = \\frac{\\partial g}{\\partial P}\\Big|_{(R^*, P^*)} = 0$\n\nThe stability is determined by the eigenvalues of $J$, which are the roots of the characteristic equation $\\lambda^2 - \\mathrm{Tr}(J)\\lambda + \\mathrm{Det}(J) = 0$. For local asymptotic stability, the Routh-Hurwitz criteria require that both eigenvalues have negative real parts, which for a $2 \\times 2$ system is equivalent to $\\mathrm{Tr}(J) < 0$ and $\\mathrm{Det}(J) > 0$.\n\nLet us compute the determinant:\n$$\n\\mathrm{Det}(J) = J_{11}J_{22} - J_{12}J_{21} = 0 - \\left(-\\frac{aR^*}{1+ahR^*}\\right)\\left(\\frac{eaP^*}{(1+ahR^*)^2}\\right) = \\frac{ea^2R^*P^*}{(1+ahR^*)^3}\n$$\nSince all parameters are positive and we assume a coexistence equilibrium ($R^*>0, P^*>0$), we have $\\mathrm{Det}(J) > 0$. Thus, the stability condition reduces to $\\mathrm{Tr}(J) < 0$.\n\nThe trace is $\\mathrm{Tr}(J) = J_{11} + J_{22} = J_{11}$. We simplify $J_{11}$:\n$$\nJ_{11} = r - \\frac{2rR^*}{K} - \\frac{aP^*}{(1+ahR^*)^2}\n$$\nFrom the equilibrium condition for $P^*$, we have $\\frac{aP^*}{1+ahR^*} = r(1-\\frac{R^*}{K})$. Substitute this:\n$$\nJ_{11} = r - \\frac{2rR^*}{K} - \\frac{1}{1+ahR^*} \\frac{aP^*}{1+ahR^*} = r - \\frac{2rR^*}{K} - \\frac{r}{1+ahR^*}\\left(1-\\frac{R^*}{K}\\right)\n$$\n$$\nJ_{11} = \\left(r - \\frac{rR^*}{K}\\right) - \\frac{rR^*}{K} - \\frac{r}{1+ahR^*} + \\frac{rR^*}{K(1+ahR^*)}\n$$\n$$\nJ_{11} = \\frac{ahR^*r}{1+ahR^*} - \\frac{rR^*}{K}\\left(\\frac{1+2ahR^*}{1+ahR^*}\\right) = \\frac{rR^*}{1+ahR^*}\\left(ah - \\frac{1+2ahR^*}{K}\\right)\n$$\nSince $\\frac{rR^*}{1+ahR^*} > 0$, the condition $\\mathrm{Tr}(J) < 0$ becomes:\n$$\nah - \\frac{1+2ahR^*}{K} < 0 \\implies ahK < 1+2ahR^* \\implies K(ah) - 1 < 2ahR^*\n$$\nThis inequality gives the condition for local asymptotic stability. A Hopf bifurcation occurs when the trace is zero, where the system loses stability and a limit cycle emerges. This bifurcation is characteristic of the \"paradox of enrichment\".\n\nIn summary, for a given $K$, the positive coexistence equilibrium is locally asymptotically stable if and only if both of these conditions are met:\n1.  Existence: $K > R^*$\n2.  Stability: $ahK < 1+2ahR^*$\n\nWe apply these conditions to the test suite using the calculated value $R^* = 0.5$ and other parameters: $a=1.0, h=0.5 \\implies ah=0.5$.\n\nThe stability condition becomes: $0.5 K < 1 + 2(0.5)(0.5) \\implies 0.5 K < 1.5 \\implies K < 3$.\nThe existence condition is $K > 0.5$.\nCombining them, the equilibrium exists and is stable if $0.5 < K < 3$.\n\nWe now evaluate each case:\n- For $K = 1.0$: We check if $0.5 < 1.0 < 3$. This is true. The equilibrium exists and is stable. The result is `True`.\n- For $K = 3.0$: We check if $0.5 < 3.0 < 3$. This is false because $3.0$ is not strictly less than $3$. At this value, $Tr(J) = 0$, the system is at the threshold of stability (Hopf bifurcation) but not asymptotically stable. The result is `False`.\n- For $K = 5.0$: We check if $0.5 < 5.0 < 3$. This is false. The equilibrium exists but is unstable. The result is `False`.\n- For $K = 0.5$: We check if $0.5 < 0.5 < 3$. This is false because $0.5$ is not strictly greater than $0.5$. At this value, $P^*=0$, so a positive coexistence equilibrium does not exist. The result is `False`.\n\nThe sequence of results is `True`, `False`, `False`, `False`.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Rosenzweig-MacArthur stability problem for a given set of parameters\n    and a test suite of K values.\n    \"\"\"\n    \n    # Define fixed parameters as specified in the problem statement.\n    # All parameters are dimensionless.\n    r = 1.0  # intrinsic prey growth rate\n    a = 1.0  # predator attack rate\n    h = 0.5  # predator handling time\n    e = 0.5  # conversion efficiency\n    m = 0.2  # predator mortality rate\n    \n    # Define the test suite for the carrying capacity K.\n    test_cases_K = [1.0, 3.0, 5.0, 0.5]\n    \n    results = []\n\n    # Check the condition for a physically meaningful prey equilibrium density R*.\n    # R* must be positive, which requires e - m*h > 0.\n    if e - m * h <= 0:\n        # If this condition is not met, R* would be non-positive or undefined.\n        # This would mean no positive coexistence equilibrium can exist for any K.\n        # For the given parameters, e - m*h = 0.5 - 0.2*0.5 = 0.4 > 0, so this path is not taken.\n        results = [False] * len(test_cases_K)\n    else:\n        # Calculate the positive equilibrium density of the prey, R*.\n        R_star = m / (a * (e - m * h))\n        \n        # Loop through each provided value of K to determine stability.\n        for K in test_cases_K:\n            # Condition 1: Existence of a positive coexistence equilibrium.\n            # This requires the predator equilibrium density P* to be positive.\n            # P* > 0 requires K > R*.\n            exists = K > R_star\n            \n            if not exists:\n                # If a positive coexistence equilibrium does not exist, the answer is False\n                # as per the problem specification.\n                results.append(False)\n                continue\n                \n            # Condition 2: Local asymptotic stability of the equilibrium.\n            # This is determined by the trace of the Jacobian matrix: Tr(J) < 0.\n            # The condition Tr(J) < 0 simplifies to ahK < 1 + 2ahR*.\n            is_stable = (a * h * K) < (1 + 2 * a * h * R_star)\n            \n            results.append(is_stable)\n\n    # Format the final output as a comma-separated list of booleans\n    # enclosed in square brackets, with no spaces.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2411240"}]}