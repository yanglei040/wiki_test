{"hands_on_practices": [{"introduction": "A primary output of a maximum likelihood phylogenetic analysis is a phylogram, where branch lengths are proportional to the estimated amount of evolutionary change. Correctly interpreting these lengths is the first step toward understanding the evolutionary story told by the tree. This practice problem [@problem_id:1946202] challenges you to deduce the most direct meaning of an unusually long branch, a common feature in phylogenetic trees, and to differentiate this from incorrect but plausible-sounding interpretations.", "problem": "A team of evolutionary biologists is investigating the relationships among four species of deep-sea corals (Species A, B, C, and D) using DNA sequence data from a mitochondrial gene. They align the sequences and employ a Maximum Likelihood (ML) phylogenetic analysis, which is a statistical method for inferring evolutionary trees. The ML algorithm calculates the likelihood of the observed sequence data for a given tree topology and a model of nucleotide substitution, and its output includes a phylogram where branch lengths are proportional to the estimated amount of evolutionary change.\n\nThe resulting phylogram shows a tree topology of ((A,B),C),D). The branches leading to Species A, Species B, and the internal branch uniting them are all relatively short. The branch leading to Species C is of moderate length. However, the terminal branch leading to Species D is exceptionally long, indicating a high value for the branch length parameter estimated by the ML model for that lineage.\n\nBased on the principles of Maximum Likelihood phylogenetics, which of the following statements provides the most direct and certain interpretation of the long branch leading to Species D?\n\nA. Species D is a \"living fossil,\" representing the ancestral state of the entire group.\n\nB. The mitochondrial gene in the lineage leading to Species D has accumulated a significantly larger number of estimated nucleotide substitutions per site compared to the other lineages.\n\nC. The sequence data for Species D likely contains numerous sequencing errors, which the model has mistaken for genuine mutations.\n\nD. Species D must be the outgroup to the clade containing Species A, B, and C.\n\nE. The rate of speciation was much slower in the lineage leading to Species D.", "solution": "In a maximum likelihood phylogenetic analysis under a specified nucleotide substitution model, the likelihood is $\\mathcal{L}(\\text{data} \\mid \\text{topology}, \\{\\ell_{i}\\}, \\theta)$, where the $\\ell_{i}$ are branch lengths and $\\theta$ are model parameters. The ML estimates of branch lengths maximize this likelihood and are interpreted as the expected number of substitutions per site along each branch, typically denoted in units of substitutions per site. Formally, for a lineage with instantaneous substitution rate $r(t)$ over time, the branch length is $\\ell=\\int r(t)\\,dt$, and thus a larger $\\ell$ reflects a larger cumulative expected number of substitutions per site along that lineage.\n\nIn the reported phylogram, the terminal branch leading to Species D is exceptionally long relative to others. The most direct and certain interpretation, by definition of branch length in an ML phylogram, is that the ML model has estimated a substantially larger number of nucleotide substitutions per site along the lineage to D than along the other lineages.\n\nEvaluating the options:\n- A is incorrect: a long branch does not indicate an ancestral state; it indicates greater inferred change, not stasis or primitiveness.\n- B is correct: a longer branch length directly means more estimated substitutions per site on that lineage under the ML model.\n- C is not a direct or certain interpretation: while sequencing error can, in principle, inflate apparent changes, this is a speculative data-quality hypothesis and not implied by the ML output alone.\n- D is incorrect: a long branch does not imply outgroup status; rooting requires external information, and long-branch attraction is a known artifact but not a certainty nor a definition of outgroup.\n- E is incorrect: branch lengths reflect molecular change (substitutions per site), not speciation rates.\n\nTherefore, the most direct and certain interpretation is that the lineage to Species D has accumulated more estimated substitutions per site.", "answer": "$$\\boxed{B}$$", "id": "1946202"}, {"introduction": "Phylogenetic datasets are rarely complete, and missing data is a common challenge that must be handled correctly. A key strength of the maximum likelihood framework is its statistically rigorous approach to such ambiguity. This exercise [@problem_id:2402743] explores the consequences of having a large proportion of missing data for a single taxon, revealing how ML methods can still provide consistent estimates while properly reflecting the increased uncertainty.", "problem": "In a phylogenetic analysis under Maximum Likelihood (ML), consider a fixed, correctly specified unrooted tree on four taxa, with a known topology and unknown branch lengths. Assume a time-homogeneous, time-reversible, stationary nucleotide substitution model with equal base frequencies and equal substitution rates (the Jukes–Cantor model), and an alignment of length $N$ independent sites evolving identically and independently on this tree. One taxon, call it taxon $D$, has $90\\%$ of its sites coded as missing data (denoted by the symbol “$?$”), with the missingness for taxon $D$ occurring independently across sites and independently of the true nucleotide states (i.e., missing completely at random). Under standard ML handling of missing data, a “$?$” at a leaf is treated as an unknown/ambiguous state, and the per-site likelihood is marginalized over all possible true nucleotides at that leaf.\n\nLet $b_{D}$ denote the pendant branch length leading to taxon $D$. Which statement best describes the impact of the $90\\%$ missing data at taxon $D$ on the ML estimation of $b_{D}$?\n\nA. Only the approximately $0.1N$ sites where taxon $D$ is observed directly inform $b_{D}$; the remaining approximately $0.9N$ sites contribute no information about $b_{D}$ under the model, so the ML estimate of $b_{D}$ remains consistent as $N \\to \\infty$ but has increased variance relative to the complete-data case.\n\nB. Because “$?$” is treated as matching every nucleotide, the per-site likelihood at missing positions penalizes longer branches most strongly, so the ML estimate of $b_{D}$ is driven toward $0$ as $N$ increases.\n\nC. The $90\\%$ missing data at taxon $D$ causes all branch lengths in the tree, including internal branches unrelated to $D$, to be underestimated by roughly $90\\%$.\n\nD. The missing positions induce the algorithm to impute random nucleotides for taxon $D$, which systematically inflates the ML estimate of $b_{D}$ above its true value.\n\nE. Regardless of the data on the other taxa, the internal branch adjacent to $D$ becomes unidentifiable in the presence of $90\\%$ missing data at $D$, so the ML estimation problem lacks a well-defined maximum for that branch.", "solution": "The total likelihood of the alignment $S$ given the tree topology and branch lengths $\\mathbf{b}$ is the product of the likelihoods for each site, due to the assumption of independence:\n$$L(\\mathbf{b} | S) = \\prod_{i=1}^{N} L_i(\\mathbf{b} | S_i)$$\nwhere $S_i$ is the character data at site $i$. The log-likelihood is $\\ell(\\mathbf{b}) = \\sum_{i=1}^{N} \\log L_i(\\mathbf{b} | S_i)$.\n\nThe likelihood for a single site is calculated using Felsenstein's pruning algorithm. This algorithm computes the probability of the observed states at the leaves of the tree by recursively calculating \"partial likelihoods\" at each internal node, summing over all possible states at each node.\n\nLet us analyze the calculation for two types of sites from the alignment:\n1.  **Sites where taxon $D$ is observed**: This corresponds to approximately $0.1N$ sites. At such a site, the state of taxon $D$ is a specific nucleotide (e.g., $A$, $C$, $G$, or $T$). The pruning algorithm starts at this leaf with a partial likelihood vector that is $1$ for the observed state and $0$ for others (e.g., $(1, 0, 0, 0)^T$ for state $A$). This vector is propagated up the tree along the branch of length $b_D$. The likelihood contribution of this site will explicitly depend on the transition probabilities over the branch length $b_D$. Thus, these sites contain information about $b_D$.\n\n2.  **Sites where taxon $D$ is missing**: This corresponds to approximately $0.9N$ sites. The state for taxon $D$ is \"?\". Standard ML practice treats this as ambiguity, meaning the true state could be any of the possible nucleotides. The likelihood is calculated by marginalizing over these possibilities. In the pruning algorithm, this is accomplished by setting the initial partial likelihood vector for taxon $D$ to $(1, 1, 1, 1)^T$.\n\nLet $P(b_D)$ be the transition probability matrix for the branch leading to taxon $D$. The elements of this matrix, $[P(b_D)]_{xy}$, give the probability of observing state $y$ at the leaf given state $x$ at the ancestral node. When this vector is propagated from the leaf $D$ to its parent node $u$, the resulting partial likelihood vector is given by $P(b_D)^T (1, 1, 1, 1)^T$.\n\nFor any time-reversible substitution model, including the Jukes-Cantor model, the transition matrix $P(t)$ is such that its columns sum to $1$. This is because the uniform distribution of bases is stationary. Therefore, each row of the transposed matrix $P(t)^T$ sums to $1$. The product $P(b_D)^T (1, 1, 1, 1)^T$ results in a vector whose elements are the sums of the rows of $P(b_D)^T$, which is simply $(1, 1, 1, 1)^T$.\n\nThis means that the partial likelihood contribution from the subtree containing taxon $D$ to the rest of the tree is a vector of ones, which is independent of the branch length $b_D$. Consequently, the total likelihood for any site where taxon $D$ has a \"?\" is not a function of $b_D$.\n\nThe total log-likelihood can be partitioned:\n$$\\ell(\\mathbf{b}) = \\sum_{i \\in \\text{sites with observed } D} \\log L_i(\\mathbf{b}) + \\sum_{j \\in \\text{sites with missing } D} \\log L_j(\\mathbf{b})$$\nTo find the ML estimate of $b_D$, we solve $\\frac{\\partial \\ell(\\mathbf{b})}{\\partial b_D} = 0$.\nThe derivative is:\n$$\\frac{\\partial \\ell(\\mathbf{b})}{\\partial b_D} = \\sum_{i \\in \\text{sites with observed } D} \\frac{\\partial \\log L_i(\\mathbf{b})}{\\partial b_D} + \\sum_{j \\in \\text{sites with missing } D} \\frac{\\partial \\log L_j(\\mathbf{b})}{\\partial b_D}$$\nSince $L_j(\\mathbf{b})$ is independent of $b_D$ for sites with missing data at $D$, the second term is zero.\n$$\\frac{\\partial \\ell(\\mathbf{b})}{\\partial b_D} = \\sum_{i \\in \\text{sites with observed } D} \\frac{\\partial \\log L_i(\\mathbf{b})}{\\partial b_D}$$\nThis demonstrates that only the sites where data for taxon $D$ are observed contribute to the estimation of its pendant branch length, $b_D$.\n\nThe statistical consequences are as follows:\n- **Consistency**: The ML estimator for $b_D$ is based on an effective sample size of approximately $0.1N$. Since this sample size still approaches infinity as $N \\to \\infty$, the ML estimator for $b_D$ remains consistent (i.e., it converges in probability to the true value of $b_D$). There is no systematic bias.\n- **Variance**: The amount of information about a parameter is related to the sample size. The Fisher Information for $b_D$ is now derived from only about $10\\%$ of the sites. As the asymptotic variance of an ML estimator is the inverse of the Fisher Information, the variance of the estimate of $b_D$ will be approximately $10$ times larger than in the complete-data case.\n\nNow, we evaluate each option:\n\n**A. Only the approximately $0.1N$ sites where taxon $D$ is observed directly inform $b_{D}$; the remaining approximately $0.9N$ sites contribute no information about $b_{D}$ under the model, so the ML estimate of $b_{D}$ remains consistent as $N \\to \\infty$ but has increased variance relative to the complete-data case.**\nThis statement is fully consistent with our derivation. The sites with missing data for taxon $D$ contribute zero to the gradient of the log-likelihood with respect to $b_D$, meaning they provide no information for its estimation. The estimator remains consistent because the number of informative sites still grows to infinity with $N$. The variance increases because the effective sample size is drastically reduced. **Correct.**\n\n**B. Because “$?$” is treated as matching every nucleotide, the per-site likelihood at missing positions penalizes longer branches most strongly, so the ML estimate of $b_{D}$ is driven toward $0$ as $N$ increases.**\nThis is incorrect. As shown, the per-site likelihood at missing positions is independent of $b_D$. It neither penalizes nor rewards any particular value of $b_D$. The ML estimate of $b_D$ is consistent, not biased toward $0$. **Incorrect.**\n\n**C. The $90\\%$ missing data at taxon $D$ causes all branch lengths in the tree, including internal branches unrelated to $D$, to be underestimated by roughly $90\\%$.**\nThis is incorrect. The estimation of other branch lengths (e.g., those within the subtree of taxa $A$, $B$, and $C$) utilizes information from all $N$ sites. For the $90\\%$ of sites where $D$ is missing, the data behave like a 3-taxon alignment, which is still informative for the relationships among $A$, $B$, and $C$. There is no reason to expect a systematic underestimation, let alone one of $90\\%$. The estimators for all branch lengths should be consistent. **Incorrect.**\n\n**D. The missing positions induce the algorithm to impute random nucleotides for taxon $D$, which systematically inflates the ML estimate of $b_{D}$ above its true value.**\nThis is a mischaracterization of the ML method. ML does not impute (i.e., \"fill in\") missing data with random values. It correctly integrates (marginalizes) over the uncertainty. This procedure does not introduce systematic bias; the estimator for $b_D$ is consistent. Imputing random data would likely lead to bias (overestimation of $b_D$, as random data would appear more diverged than the true data), but this is not what the specified algorithm does. **Incorrect.**\n\n**E. Regardless of the data on the other taxa, the internal branch adjacent to $D$ becomes unidentifiable in the presence of $90\\%$ missing data at $D$, so the ML estimation problem lacks a well-defined maximum for that branch.**\nThis is incorrect. An unrooted 4-taxon tree has one internal branch. While this branch is indeed unidentifiable from the $90\\%$ of sites where taxon $D$ is missing (as the data collapses to a 3-taxon star tree), it remains identifiable from the $10\\%$ of sites where all four taxa are observed. As long as there is some non-zero fraction of sites with complete data, all parameters of the 4-taxon tree are theoretically identifiable. The estimation problem has a well-defined maximum, though the precision of the estimate for the internal branch will be poor. **Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2402743"}, {"introduction": "While long branches indicate significant evolutionary change, a branch length estimate of zero also carries a profound meaning about evolutionary relationships. This situation often arises when there is insufficient data to resolve the branching order of several lineages. This problem [@problem_id:2402770] delves into the theoretical implications of a zero-length internal branch, revealing its direct connection to an unresolved polytomy and the continuity of the likelihood function across different tree topologies.", "problem": "Consider an unrooted, fully bifurcating phylogenetic tree $T$ with $n \\ge 4$ taxa. The sequence evolution along each branch is modeled by a homogeneous, time-reversible Continuous-Time Markov Chain (CTMC) with rate matrix $Q$, so that the transition probability matrix along a branch of length $t$ is $P(t)=\\exp(Qt)$. Let $L(T,\\mathbf{t}\\,|\\,\\mathcal{D})$ denote the Maximum Likelihood (ML) phylogenetic likelihood for a fixed alignment $\\mathcal{D}$, computed under the standard independent-sites assumption, where $\\mathbf{t}$ denotes the vector of nonnegative branch lengths. Now select a single internal edge $e^{\\ast}$ of $T$ and set its length to exactly $t_{e^{\\ast}}=0$, thereby collapsing that edge and creating a single node of degree $4$ (a quartet polytomy) in place of the two internal nodes joined by $e^{\\ast}$. Consider the three binary resolutions of this polytomy obtained by reinstating an internal branch of positive length that splits the four incident subtrees in one of the three possible ways.\n\nWhich statement(s) about the likelihood are true?\n\nA. The function $t \\mapsto L(T,\\mathbf{t}\\,|\\,\\mathcal{D})$ is continuous at $t_{e^{\\ast}}=0$, so setting $t_{e^{\\ast}}=0$ yields the same value as $\\lim_{t \\to 0^{+}} L$ from any of the three binary resolutions, and these three limits coincide at $t=0$.\n\nB. The likelihood becomes undefined at $t_{e^{\\ast}}=0$ because the transition probabilities on that edge cannot be computed, so standard pruning recursions fail.\n\nC. For any dataset $\\mathcal{D}$, forcing $t_{e^{\\ast}}=0$ strictly increases the likelihood, because eliminating a parameter prevents overfitting in ML estimation without penalties.\n\nD. The likelihood at $t_{e^{\\ast}}=0$ equals the arithmetic mean of the maximized likelihoods of the $3$ fully resolved trees obtained by the three binary resolutions of the polytomy.\n\nE. For any fixed binary resolution adjacent to the polytomy, viewing $L$ as a function of the internal length $t:=t_{e^{\\ast}}$, one has $L(t=0) \\le \\sup_{t0} L(t)$, with equality if and only if the ML estimate of that internal length is $t^{\\star}=0$.", "solution": "We analyze the effect of setting a single internal branch length to exactly zero under a Continuous-Time Markov Chain (CTMC) model with rate matrix $Q$.\n\nFirst-principles setup. Under a CTMC, the transition probability matrix along a branch of length $t$ is $P(t)=\\exp(Qt)$. The matrix exponential satisfies $P(0)=\\exp(Q \\cdot 0)=I$, where $I$ is the identity matrix. For a given unrooted tree $T$ with branch lengths $\\mathbf{t}$ and alignment $\\mathcal{D}$, the site likelihood is computed by summing over all internal node states the product, over edges, of the appropriate transition probabilities given the states at the edge’s endpoints, multiplied by the equilibrium distribution at an arbitrary root (Felsenstein’s pruning algorithm). The full likelihood $L(T,\\mathbf{t}\\,|\\,\\mathcal{D})$ is the product over sites of these site likelihoods (or the sum of log-likelihoods).\n\nEffect of $t_{e^{\\ast}}=0$. If we set the length on an edge $e^{\\ast}$ to $t_{e^{\\ast}}=0$, then $P(t_{e^{\\ast}})=P(0)=I$, which means the states at the two nodes incident to $e^{\\ast}$ must be identical with probability $1$ along that edge. In the pruning recursions, this has the effect of merging the two nodes into a single node, so the evaluation on the collapsed tree is well-defined. Because $t \\mapsto \\exp(Qt)$ is continuous (indeed, analytic), the likelihood as a function of $t_{e^{\\ast}}$ is continuous at $t=0$, and the value at $t=0$ equals the limit as $t \\to 0^{+}$.\n\nEquivalence of limits across binary resolutions. In an unrooted bifurcating tree, collapsing a single internal edge $e^{\\ast}$ yields a node of degree $4$ incident to four subtrees. The three binary resolutions correspond to the three possible ways to reconnect these subtrees with a positive-length internal edge. For each of these binary resolutions, letting the newly introduced internal length $t \\to 0^{+}$ forces $P(t) \\to I$ on that edge, so the likelihood converges to that of the same collapsed, unresolved quartet. Therefore, the limits from all three resolutions coincide and equal the likelihood at the polytomy ($t=0$).\n\nOptimization implications. For any fixed binary resolution, consider the likelihood $L(t)$ as a function of the internal length $t:=t_{e^{\\ast}} \\ge 0$, with all other branch lengths and model parameters optimized (or held fixed) as appropriate. Because $t=0$ is a particular value in the allowable domain $t \\ge 0$, one has $L(0) \\le \\sup_{t \\ge 0} L(t)$. If one restricts attention to $t0$, continuity implies $\\sup_{t0} L(t) \\ge L(0)$, with equality if and only if the maximum occurs at the boundary $t^{\\star}=0$ (i.e., the ML estimate for that internal branch is zero). Absent any penalization, simply fixing a parameter to a specific value cannot, in general, strictly increase the maximum likelihood unless the unconstrained optimum already lies at that value.\n\nOption-by-option analysis:\n\nA. This statement is correct. Since $P(t)=\\exp(Qt)$ is continuous with $P(0)=I$, the likelihood is continuous in $t_{e^{\\ast}}$ at $t=0$. Collapsing the edge yields the same value as taking $t \\to 0^{+}$. Moreover, each of the three possible binary resolutions of the quartet, as $t \\to 0^{+}$, converges to the same collapsed tree, so their limits coincide.\n\nB. This statement is incorrect. At $t=0$, $P(0)=I$ is well-defined, and the pruning algorithm still applies. There is no singularity; rather, the edge enforces identical states across its endpoints.\n\nC. This statement is incorrect. In unpenalized Maximum Likelihood (ML), reducing the number of free parameters does not, by itself, guarantee an increased likelihood. For a single internal length $t$, $L(0)$ cannot exceed the supremum of $L(t)$ over $t \\ge 0$; it only matches it if the ML estimate is $t^{\\star}=0$.\n\nD. This statement is incorrect. There is no justification for an arithmetic mean relationship. The value at $t=0$ equals the common limit of the three likelihood functions as $t \\to 0^{+}$, not the average of their (generally distinct) maximized values at their respective ML branch lengths.\n\nE. This statement is correct. For any fixed resolution, $L(0) \\le \\sup_{t0} L(t)$ holds by definition of the supremum and continuity at $0$, with equality if and only if the ML estimate lies at the boundary $t^{\\star}=0$.\n\nTherefore, the correct options are A and E.", "answer": "$$\\boxed{AE}$$", "id": "2402770"}]}