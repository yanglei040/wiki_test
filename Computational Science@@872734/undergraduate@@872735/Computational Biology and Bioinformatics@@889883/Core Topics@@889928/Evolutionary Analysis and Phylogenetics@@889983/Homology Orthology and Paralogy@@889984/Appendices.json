{"hands_on_practices": [{"introduction": "The cornerstone of distinguishing orthologs from paralogs lies in interpreting evolutionary history, which is most directly visualized using a phylogenetic tree. This first exercise provides foundational practice in reading such a tree. By examining the branching patterns, you can infer whether the divergence between two genes was caused by a speciation event (orthology) or a gene duplication event (paralogy), a fundamental skill in molecular evolution [@problem_id:2136511].", "problem": "A molecular biologist is investigating the evolutionary history of a protein family called the \"Cyclophilins,\" which are involved in protein folding. The biologist identifies two distinct Cyclophilin proteins in the human genome, which are named Human Cyclophilin-Delta (H-CycD) and Human Cyclophilin-Epsilon (H-CycE). A related protein is also found in the genome of the fruit fly, *Drosophila melanogaster*, and is named Fly Cyclophilin-Delta (F-CycD).\n\nTo understand their relationships, the biologist performs a phylogenetic analysis based on the amino acid sequences of these three proteins. The analysis reveals that Human Cyclophilin-Delta (H-CycD) groups more closely with Fly Cyclophilin-Delta (F-CycD) than it does with its fellow human protein, Human Cyclophilin-Epsilon (H-CycE).\n\nBased on this phylogenetic data, which of the following statements most accurately describes the evolutionary relationship between Human Cyclophilin-Delta (H-CycD) and Fly Cyclophilin-Delta (F-CycD)?\n\nA. They are paralogs.\n\nB. They are orthologs.\n\nC. They are analogs.\n\nD. They are functional isozymes with no direct evolutionary relationship.\n\nE. They are homologs, but a more specific classification is not possible from the data.", "solution": "We begin by recalling standard evolutionary definitions:\n- Homologs are genes related by common ancestry; this includes both orthologs and paralogs.\n- Orthologs are homologous genes in different species that diverged following a speciation event.\n- Paralogs are homologous genes that arose by gene duplication within a lineage; they often occur within the same genome or correspond across species if the duplication predates speciation.\n- Analogs are genes or proteins with similar function that do not share common ancestry (convergent evolution).\n- Isozymes are distinct enzymes within the same organism that catalyze the same reaction, typically arising from gene duplication, and the term does not specify cross-species evolutionary relationships.\n\nThe phylogenetic analysis shows that Human Cyclophilin-Delta (H-CycD) groups more closely with Fly Cyclophilin-Delta (F-CycD) than with Human Cyclophilin-Epsilon (H-CycE). A closer grouping across species (human H-CycD with fly F-CycD) than within the same species (H-CycD with H-CycE) indicates that the divergence between H-CycD and F-CycD corresponds to a speciation event rather than a duplication event. This is the diagnostic pattern for orthology: the D lineage split into human and fly copies at speciation, while H-CycE represents a distinct paralogous lineage produced by an earlier duplication (before the human–fly split) or a separate duplication unique to a lineage; in either case, H-CycD and H-CycE are paralogs, whereas H-CycD and F-CycD are orthologs.\n\nTherefore:\n- Not paralogs (A): H-CycD is not more closely related to H-CycE than to F-CycD; the tree indicates speciation separates H-CycD and F-CycD.\n- Not analogs (C): The phylogeny indicates shared ancestry, not mere functional convergence.\n- Not isozymes with no direct evolutionary relationship (D): The tree establishes homology and cross-species relationship; isozymes are within-species duplicates.\n- More specific than generic homologs (E): The data are sufficient to identify orthology.\n\nThus, the most accurate description is that H-CycD and F-CycD are orthologs.", "answer": "$$\\boxed{B}$$", "id": "2136511"}, {"introduction": "While simple trees are illustrative, real-world data often reveals conflicts between a gene's evolutionary tree and the known tree of the species it comes from. This advanced exercise introduces the core bioinformatics task of gene tree-species tree reconciliation. You will apply the principle of parsimony to deduce the hidden history of gene duplications and losses required to explain the observed gene tree, a crucial step in building accurate maps of gene families [@problem_id:2398669].", "problem": "You are given a rooted gene tree with topology $\\left(\\left(\\mathrm{SpeciesA\\_gene1},\\,\\mathrm{SpeciesB\\_gene1}\\right),\\,\\mathrm{SpeciesA\\_gene2}\\right)$. Independent evidence indicates that $\\mathrm{Species\\ A}$ and $\\mathrm{Species\\ B}$ are sister taxa. Assume that the gene tree is correctly inferred and rooted, that the gene is nuclear (so no Horizontal Gene Transfer (HGT) is allowed), and that sampling is complete (no missing homologous copies in either species). Under the standard model where gene evolution proceeds by speciation, gene duplication, and gene loss, which of the following evolutionary histories is the most parsimonious and consistent with the observed gene tree and species relationship?\n\nA. A single gene duplication occurred in the common ancestor of $\\mathrm{Species\\ A}$ and $\\mathrm{Species\\ B}$ before their divergence, producing two paralogous copies; subsequently, the lineage leading to $\\mathrm{Species\\ B}$ lost the copy corresponding to $\\mathrm{SpeciesA\\_gene2}$, leaving $\\mathrm{SpeciesB\\_gene1}$ as the ortholog of $\\mathrm{SpeciesA\\_gene1}$.\n\nB. A single gene duplication occurred only in the lineage leading to $\\mathrm{Species\\ A}$ after its divergence from $\\mathrm{Species\\ B}$, and no gene loss occurred.\n\nC. Incomplete Lineage Sorting (ILS) without any gene duplication or loss can generate the observed topology by deep coalescence alone.\n\nD. Horizontal Gene Transfer (HGT) from $\\mathrm{Species\\ A}$ to $\\mathrm{Species\\ B}$ of the copy corresponding to $\\mathrm{SpeciesA\\_gene1}$, following a duplication in $\\mathrm{Species\\ A}$ after speciation, with replacement of the native copy in $\\mathrm{Species\\ B}$.\n\nE. Convergent evolution caused $\\mathrm{SpeciesA\\_gene1}$ and $\\mathrm{SpeciesB\\_gene1}$ to appear closely related in the inferred tree without any duplication or loss.", "solution": "The problem requires reconciling the given gene tree, $G = \\left(\\left(\\mathrm{A_1},\\,\\mathrm{B_1}\\right),\\,\\mathrm{A_2}\\right)$, with the species tree, $S = \\left(\\mathrm{A},\\,\\mathrm{B}\\right)$, using the principle of parsimony (minimizing duplications and losses).\n\nWe can determine the sequence of events by applying the Lowest Common Ancestor (LCA) mapping algorithm.\n\n1.  **Analyze the node joining $\\mathrm{A_1}$ and $\\mathrm{B_1}$**:\n    The genes come from Species A and Species B, respectively. Since the species sets for these two subtrees are disjoint ({A} and {B}), the event at this node is a **speciation event**. This corresponds to the divergence of Species A and B. Thus, $\\mathrm{A_1}$ and $\\mathrm{B_1}$ are orthologs.\n\n2.  **Analyze the root node of the gene tree**:\n    This node joins the $(\\mathrm{A_1}, \\mathrm{B_1})$ clade with the $\\mathrm{A_2}$ gene. The species represented in the left child subtree are {A, B}, and the species in the right child is {A}. Because the intersection of these species sets is not empty ({A}), the event at this node must be a **gene duplication event**. This duplication occurred in the common ancestor of Species A and B.\n\n3.  **Reconstruct the history**:\n    *   A gene duplication occurred in the common ancestor of Species A and B, creating two paralogous gene lineages (let's call them lineage $\\alpha$, ancestor of $\\mathrm{A_2}$, and lineage $\\beta$, ancestor of the $(\\mathrm{A_1}, \\mathrm{B_1})$ clade).\n    *   Next, the speciation event separating Species A and B occurred. Both species inherited both paralogous lineages.\n    *   In the lineage leading to Species A, lineage $\\alpha$ evolved into $\\mathrm{A_2}$ and lineage $\\beta$ evolved into $\\mathrm{A_1}$. Both copies were retained.\n    *   In the lineage leading to Species B, lineage $\\beta$ evolved into $\\mathrm{B_1}$. However, since there is no descendant of lineage $\\alpha$ in Species B (and we assume complete sampling), the gene from lineage $\\alpha$ must have been **lost** in the lineage leading to Species B.\n\nThis history requires one duplication and one loss event, making it the most parsimonious explanation.\n\nNow, let's evaluate the options:\n\n*   **A**: This option describes exactly the history derived above: a duplication in the common ancestor of A and B, followed by a loss of one of the paralogs in the B lineage. This is the correct, most parsimonious explanation.\n*   **B**: A duplication only in lineage A *after* speciation would result in a gene tree of $\\left(\\left(\\mathrm{A_1}, \\mathrm{A_2}\\right), \\mathrm{B_1}\\right)$, which contradicts the given tree.\n*   **C**: Incomplete Lineage Sorting (ILS) cannot explain the existence of two distinct gene copies ($\\mathrm{A_1}$ and $\\mathrm{A_2}$) within the same genome. Their existence necessitates a duplication event.\n*   **D**: This option involves Horizontal Gene Transfer (HGT), which is explicitly disallowed by the problem statement.\n*   **E**: Invoking convergent evolution contradicts the premise that the gene tree is correctly inferred to reflect evolutionary history. It also fails to explain the presence of two gene copies in Species A.\n\nTherefore, option A is the only one that provides a parsimonious and consistent explanation.", "answer": "$$\\boxed{A}$$", "id": "2398669"}, {"introduction": "In practice, full phylogenetic reconstruction for every gene across entire genomes is computationally expensive, leading bioinformaticians to rely on fast heuristics like the Reciprocal Best Hit (RBH) method. This final practice problem delves into a realistic scenario where this widely-used heuristic can fail, specifically when confronted with ancient duplications and differing rates of evolution. Understanding this failure mode is essential for critically evaluating the results of automated orthology prediction pipelines and appreciating the robustness of true phylogenetic methods [@problem_id:2834914].", "problem": "A heuristic frequently used to infer orthology across species pairs is the Reciprocal Best Hit (RBH), which declares two genes as putative orthologs if each is the other’s highest-scoring hit in cross-species sequence similarity searches (e.g., Basic Local Alignment Search Tool (BLAST) bit-scores). Starting from the core definitions that orthologs are genes related by speciation and paralogs are genes related by duplication, and the well-tested observation that sequence similarity typically decays with evolutionary distance under standard substitution models, consider the following explicit scenario.\n\nAn ancestral gene *G* duplicated at time $t_d$ shortly before a speciation event at time $t_s$, with $t_d < t_s$ and $t_s - t_d$ small. The duplication produced two copies, $G_\\alpha$ and $G_\\beta$. After speciation, lineage $S_X$ experienced asymmetric loss, retaining only $G_\\alpha$ (now $x_1$), whereas lineage $S_Y$ retained both copies, $G_\\alpha$ (now $y_1$) and $G_\\beta$ (now $y_2$). Due to subfunctionalization or neofunctionalization, the rate on the $S_Y$ branch for $y_1$ accelerated, with $r_{y_1} \\approx 2r$, while $y_2$ remained more conserved with $r_{y_2} \\approx r$. Under a standard reversible nucleotide or amino acid substitution model, greater evolutionary distance is expected to yield lower sequence similarity and thus lower BLAST bit-scores.\n\nYou run BLASTP for all-versus-all comparisons between the $S_X$ proteome and the $S_Y$ proteome and obtain the following top scores for the genes in question (bit-scores are higher for more similar sequences):\n- $B(x_1,y_1) = 160$\n- $B(x_1,y_2) = 210$\n- $B(y_1,x_1) = 160$\n- $B(y_2,x_1) = 210$\n\nAssume there are no other competing hits of comparable score in either proteome for these genes, and that all sequences are of comparable length so that score differences primarily reflect divergence.\n\nWhich option most accurately describes what the RBH procedure will conclude on this dataset, why that conclusion does or does not reflect true orthology given the evolutionary scenario, and a robust methodological remedy that would avoid the error?\n\nA. RBH will call $x_1 \\leftrightarrow y_2$ as orthologs because they are reciprocal best hits ($210$ both ways). This is a failure: the duplication predates speciation ($t_d < t_s$), so $x_1$ and $y_2$ are out-paralogs, while $x_1$ is co-orthologous to both $y_1$ and $y_2$. A robust fix is to infer a gene tree and reconcile it with the species tree to date the duplication relative to $t_s$, optionally integrating conserved synteny, and then assign many-to-many orthology (co-orthologs) rather than relying on RBH.\n\nB. RBH will correctly call $x_1 \\leftrightarrow y_1$ as orthologs because true orthologs necessarily have the highest BLAST bit-scores; duplication and rate variation cannot overturn this ordering.\n\nC. RBH will fail here, but the failure can be eliminated by imposing a stringent percent identity cutoff (e.g., $> 90\\%$) on top of RBH, which guarantees that the highest-scoring pair represents true orthologs.\n\nD. RBH will fail here, but switching to Reciprocal Smallest Distance (RSD), defined as picking the pair with the smallest model-corrected evolutionary distance in both directions, guarantees recovery of $x_1 \\leftrightarrow y_1$ without needing phylogenetic analysis, because distance correction automatically accounts for pre- versus post-speciation duplications.\n\nChoose the single best option.", "solution": "This problem requires three steps: (1) apply the RBH heuristic to the given data; (2) determine the true evolutionary relationships and evaluate if the RBH result is correct; (3) assess the proposed remedies.\n\n**1. Apply the RBH Heuristic**\nThe Reciprocal Best Hit rule checks for mutual best hits based on similarity scores.\n- The best hit for gene $x_1$ in species $S_Y$ is $y_2$, because $B(x_1, y_2) = 210$ is greater than $B(x_1, y_1) = 160$.\n- The best hit for gene $y_2$ in species $S_X$ is $x_1$ (it is the only gene, and its score is 210).\n- Since $x_1$ is the best hit for $y_2$ and $y_2$ is the best hit for $x_1$, the pair ($x_1, y_2$) are reciprocal best hits.\nThe RBH procedure will conclude that $x_1$ and $y_2$ are orthologs.\n\n**2. Determine True Evolutionary Relationships**\nThe problem describes the evolutionary history:\n- A duplication event ($t_d$) created two gene lineages, $G_\\alpha$ and $G_\\beta$, before the speciation event ($t_s$).\n- Gene $x_1$ descends from $G_\\alpha$. Gene $y_1$ also descends from $G_\\alpha$. Their last common ancestor existed at the speciation event. Therefore, **$x_1$ and $y_1$ are orthologs**.\n- Gene $y_2$ descends from $G_\\beta$. The last common ancestor of $x_1$ and $y_2$ existed at the duplication event. Therefore, **$x_1$ and $y_2$ are paralogs** (specifically, out-paralogs, as the duplication preceded the speciation).\n\nThe RBH procedure incorrectly identifies the out-paralog pair ($x_1, y_2$) as orthologs. The failure occurs because the true ortholog ($y_1$) has evolved at an accelerated rate, making it less similar to $x_1$ than the more slowly evolving paralog ($y_2$).\n\n**3. Evaluate the Options**\n\n*   **A**: This option correctly states that RBH will call $x_1 \\leftrightarrow y_2$ as orthologs. It correctly identifies this as a failure and accurately explains why: $x_1$ and $y_2$ are out-paralogs due to a pre-speciation duplication. The proposed fix—using gene tree-species tree reconciliation to correctly date the duplication event relative to speciation—is the gold-standard and most robust method to resolve this exact problem. This option is entirely correct.\n\n*   **B**: This is incorrect. RBH calls $x_1 \\leftrightarrow y_2$, not $x_1 \\leftrightarrow y_1$. The premise that true orthologs always have the highest similarity score is demonstrably false in this scenario.\n\n*   **C**: This is incorrect. A simple similarity cutoff cannot resolve the issue. If the cutoff is high enough to exclude the incorrect pair ($x_1, y_2$), it will also exclude the correct but less similar pair ($x_1, y_1$). A cutoff does not fix the problem of the wrong pair having the higher rank.\n\n*   **D**: This is incorrect. Switching to evolutionary distance does not fix the problem. Since the true ortholog $y_1$ evolved faster, it has accumulated more changes, and its corrected evolutionary distance to $x_1$ will be *greater* than the distance between $x_1$ and the slower-evolving paralog $y_2$. Reciprocal Smallest Distance (RSD) would thus make the same error as RBH. Distance correction models account for multiple substitutions, not for the relative timing of duplication and speciation events.\n\nTherefore, option A provides the most accurate and complete analysis of the situation.", "answer": "$$\\boxed{A}$$", "id": "2834914"}]}