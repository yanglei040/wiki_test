{"hands_on_practices": [{"introduction": "Understanding sequence alignment begins with mastering the scoring system. This first practice introduces the most fundamental approach to penalizing gaps: the linear gap penalty, where every gap character incurs a fixed cost. Completing this exercise [@problem_id:2136014] will build your foundation for calculating alignment scores by quantifying the trade-off between introducing gaps and accepting mismatches.", "problem": "In the field of bioinformatics, sequence alignment is a fundamental method for comparing protein or nucleotide sequences to identify regions of similarity that may be a consequence of functional, structural, or evolutionary relationships. The quality of an alignment is quantified by a score, calculated using a substitution matrix and gap penalties.\n\nConsider the following gapped alignment of two short peptide sequences, Seq1 and Seq2:\n\nSeq1: `F E S A G K D E`\nSeq2: `F R S - G K T E`\n\nCalculate the total alignment score using the BLOcks SUbstitution Matrix 62 (BLOSUM62) and a linear gap penalty. A linear gap penalty means that each gap character, represented by a hyphen (`-`), incurs a fixed negative score, regardless of its length or position. For this problem, the linear gap penalty is $-8$.\n\nThe relevant substitution scores from the BLOSUM62 matrix are provided below:\n- Score(F, F) = 6\n- Score(E, R) = 0\n- Score(S, S) = 4\n- Score(G, G) = 6\n- Score(K, K) = 5\n- Score(D, T) = -1\n- Score(E, E) = 5\n\nProvide the total score as an integer.", "solution": "An alignment score with a substitution matrix and a linear gap penalty is computed by summing the substitution score for each aligned residue pair and adding the gap penalty for each gap character. Let $s(x,y)$ denote the BLOSUM62 substitution score and let the linear gap penalty be $g=-8$ per gap character.\n\nFor the given alignment across 8 columns, the contributions are:\n$$\ns(F,F)=6,\\quad s(E,R)=0,\\quad s(S,S)=4,\\quad \\text{gap}=g=-8,\\quad s(G,G)=6,\\quad s(K,K)=5,\\quad s(D,T)=-1,\\quad s(E,E)=5.\n$$\n\nTherefore, the total alignment score $S$ is\n$$\nS=6+0+4+(-8)+6+5+(-1)+5=17.\n$$", "answer": "$$\\boxed{17}$$", "id": "2136014"}, {"introduction": "While simple, the linear model doesn't fully capture biological reality, where a single, long insertion or deletion event is often considered more probable than multiple, separate events. The affine gap penalty model provides a more nuanced solution by assigning a high cost to *opening* a gap and a smaller, separate cost to *extending* it. This practice [@problem_id:2136038] walks you through a direct calculation using an affine penalty, demonstrating how it differentially penalizes gaps of varying lengths.", "problem": "In bioinformatics, sequence alignment is a fundamental method for comparing protein or nucleotide sequences to identify regions of similarity. The quality of a given alignment is quantified by a numerical score, calculated based on the matches, mismatches, and gaps between the sequences. A particularly common model for penalizing gaps is the affine gap penalty model, which distinguishes between the cost of opening a gap and the cost of extending it.\n\nConsider the following specific alignment of two short peptide sequences, `PEPTIDE X` and `PEPTIDE Y`:\n\n`PEPTIDE X: VDLMSETKRG`\n`PEPTIDE Y: VDL-----RG`\n\nThe total alignment score is determined by summing the substitution scores for each vertically aligned pair of amino acids and adding the penalties for any gaps present. The scoring system for this task is defined as follows:\n\n1.  **Substitution Scores**: The score for aligning an amino acid from `PEPTIDE X` with an identical one from `PEPTIDE Y` is given in the table below.\n    *   S(V,V) = 4\n    *   S(D,D) = 6\n    *   S(L,L) = 4\n    *   S(R,R) = 5\n    *   S(G,G) = 6\n\n2.  **Affine Gap Penalty**: The introduction of a gap is penalized using an affine model with the following parameters:\n    *   Gap Opening Penalty: -11\n    *   Gap Extension Penalty: -1\n\nCalculate the total alignment score for the specific alignment shown above. The final answer should be a single integer.", "solution": "We parse the given alignment:\nPEPTIDE X: V D L M S E T K R G\nPEPTIDE Y: V D L - - - - - R G\n\nThe vertically aligned pairs are:\n- Matches: $(V,V)$, $(D,D)$, $(L,L)$, $(R,R)$, $(G,G)$.\n- One contiguous gap in PEPTIDE Y of length $k=5$ aligned against $M,S,E,T,K$ from PEPTIDE X.\n\nSubstitution score contribution is the sum of the given identical-pair scores:\n$$\nS_{\\text{sub}} = S(V,V) + S(D,D) + S(L,L) + S(R,R) + S(G,G)\n= 4 + 6 + 4 + 5 + 6 = 25.\n$$\n\nUsing the affine gap penalty model, the penalty for a single contiguous gap of length $k$ is\n$$\nG_{\\text{gap}} = \\text{gap\\_open} + (k-1)\\,\\text{gap\\_extend}.\n$$\nWith $\\text{gap\\_open} = -11$, $\\text{gap\\_extend} = -1$, and $k=5$, we obtain\n$$\nG_{\\text{gap}} = -11 + (5-1)(-1) = -11 - 4 = -15.\n$$\n\nTherefore, the total alignment score is\n$$\nS_{\\text{total}} = S_{\\text{sub}} + G_{\\text{gap}} = 25 + (-15) = 10.\n$$", "answer": "$$\\boxed{10}$$", "id": "2136038"}, {"introduction": "The choice of gap penalty values is crucial as it directly influences the final alignment. This advanced exercise moves beyond simple score calculation to explore the decision-making process inherent in alignment algorithms. By solving for a \"break-even\" point [@problem_id:2392977], you will determine the precise gap opening penalty $g_{open}$ that makes introducing a gap more favorable than accepting a series of mismatches, providing deep insight into the critical balance between substitution scores and gap costs.", "problem": "Consider global alignment of two specific, equal-length nucleotide sequences under an affine gap penalty model. The alignment score is defined as the sum over all aligned columns of a substitution score for letter–letter pairs plus a gap cost for any contiguous gap block. The substitution scores are: a match contributes $+2$ and a mismatch contributes $-1$. For any gap block of length $\\ell$, the affine gap cost is $g_{open} + g_{ext} \\times (\\ell - 1)$, where $g_{open} \\ge 0$ is the gap opening penalty and $g_{ext} = 1$ is the gap extension penalty per additional gap character beyond the first.\n\nYou are given that, for these two sequences of length $n = 12$, the best possible global alignment that forbids gaps (i.e., a position-wise, gapless alignment) achieves exactly $m_{0} = 6$ matches and $n - m_{0} = 6$ mismatches. If alignments are instead allowed to contain at most one contiguous gap block of length $\\ell = 1$ in either sequence, then there exists a placement of this single-gap alignment that yields exactly $m_{1} = 10$ matches and $(n - 1) - m_{1} = 1$ mismatch (noting that one alignment column is a letter–gap pair).\n\nDetermine the largest value of the gap opening penalty $g_{open}$ (in the same scoring units as the substitution scores) for which there exists an optimal global alignment that contains at least one gap; equivalently, determine the threshold value $g_{open}^{*}$ such that a single-gap alignment attains a score greater than or equal to the best gapless score if and only if $g_{open} \\le g_{open}^{*}$. Give your answer as a single number. No rounding is required.", "solution": "The objective is to find the threshold value $g^{*}_{open}$ for the gap opening penalty such that for any $g_{open} \\le g^{*}_{open}$, the optimal alignment score is achieved by an alignment containing at least one gap. This implies we must find the condition under which the score of the gapped alignment, $S_{gap}$, is greater than or equal to the score of the gapless alignment, $S_{nogap}$.\n\nFirst, we calculate the score of the best possible gapless alignment, $S_{nogap}$. According to the problem statement, this alignment has $m_{0} = 6$ matches and $n - m_{0} = 12 - 6 = 6$ mismatches. The score is calculated as:\n$$S_{nogap} = (\\text{number of matches} \\times \\text{match score}) + (\\text{number of mismatches} \\times \\text{mismatch score})$$\n$$S_{nogap} = m_{0} \\times (+2) + (n - m_{0}) \\times (-1)$$\nSubstituting the given values:\n$$S_{nogap} = 6 \\times 2 + 6 \\times (-1) = 12 - 6 = 6$$\n\nNext, we calculate the score of the specified alignment containing one gap, $S_{gap}$. This alignment has one contiguous gap block of length $\\ell = 1$. It results in $m_{1} = 10$ matches and $(n - 1) - m_{1} = (12 - 1) - 10 = 1$ mismatch. The alignment thus consists of $10$ match columns, $1$ mismatch column, and $1$ column containing a gap.\n\nThe score $S_{gap}$ is the sum of the scores from matches and mismatches, minus the cost of the gap.\nThe contribution from matches and mismatches is:\n$$S_{substitutions} = m_{1} \\times (+2) + ((n - 1) - m_{1}) \\times (-1)$$\n$$S_{substitutions} = 10 \\times 2 + 1 \\times (-1) = 20 - 1 = 19$$\n\nThe cost of the gap block, $C(\\ell)$, is determined by the affine gap penalty model:\n$$C(\\ell) = g_{open} + g_{ext} \\times (\\ell - 1)$$\nFor this alignment, the gap has length $\\ell = 1$ and the extension penalty is $g_{ext} = 1$.\n$$C(1) = g_{open} + 1 \\times (1 - 1) = g_{open} + 0 = g_{open}$$\nThis cost is subtracted from the score. Therefore, the total score for the gapped alignment is:\n$$S_{gap} = S_{substitutions} - C(1) = 19 - g_{open}$$\n\nThe gapped alignment is preferred or equally optimal if its score is greater than or equal to the score of the gapless alignment:\n$$S_{gap} \\ge S_{nogap}$$\nSubstituting the expressions for the scores:\n$$19 - g_{open} \\ge 6$$\n\nWe now solve this inequality for $g_{open}$:\n$$19 - 6 \\ge g_{open}$$\n$$13 \\ge g_{open}$$\nThis indicates that the single-gap alignment will have a score greater than or equal to the gapless alignment if and only if $g_{open} \\le 13$. The problem asks for the largest value of $g_{open}$ for which this condition holds. This threshold value is $g_{open}^{*}$.\n\nThus, the largest value is $g_{open}^{*} = 13$. For any $g_{open} > 13$, the penalty for introducing a gap is too high, and the gapless alignment would be strictly optimal. For $g_{open} \\le 13$, an alignment with at least one gap is among the optimal solutions.", "answer": "$$\\boxed{13}$$", "id": "2392977"}]}