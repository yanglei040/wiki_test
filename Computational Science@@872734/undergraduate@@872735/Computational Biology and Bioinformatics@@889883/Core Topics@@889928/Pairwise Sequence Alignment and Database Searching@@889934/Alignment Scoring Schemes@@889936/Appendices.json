{"hands_on_practices": [{"introduction": "The first step in understanding sequence alignment is to learn how to quantify the quality of a given alignment. This exercise provides a foundational practice in calculating an alignment score using a simple, fixed scoring scheme. By manually scoring an alignment column by column, you will gain a tangible feel for how match, mismatch, and gap penalties combine to produce a single value that represents the alignment's overall similarity. [@problem_id:2136319]", "problem": "In bioinformatics, sequence alignment is a fundamental method for comparing two or more biological sequences. The quality of an alignment is often quantified by a scoring system. Consider the following gapped alignment of two short peptide sequences, represented using standard one-letter amino acid codes. A hyphen (`-`) is used to represent a gap.\n\nSequence 1: `M A V L I S Q R T V K`\nSequence 2: `M G V L - S R Q T - K`\n\nA simple scoring scheme is employed to evaluate this alignment. The rules are as follows:\n- A match, where the amino acids in a column are identical, receives a score of `+5`.\n- A mismatch, where the amino acids in a column are different, receives a score of `-3`.\n- A gap, where an amino acid is aligned with a gap character (`-`), incurs a penalty of `-8`.\n\nBased on this scoring scheme, calculate the total alignment score for the given pairwise alignment.", "solution": "To calculate the total alignment score, we need to analyze the alignment column by column and sum the scores for each position according to the provided scoring scheme.\n\nThe given alignment is:\nSequence 1: `M A V L I S Q R T V K`\nSequence 2: `M G V L - S R Q T - K`\n\nThe scoring rules are:\n- Match score = `+5`\n- Mismatch score = `-3`\n- Gap penalty = `-8`\n\nLet's iterate through the 11 columns of the alignment and determine the type of alignment at each position (match, mismatch, or gap).\n\n1.  Position 1: `M` vs `M`. This is a **match**.\n2.  Position 2: `A` vs `G`. This is a **mismatch**.\n3.  Position 3: `V` vs `V`. This is a **match**.\n4.  Position 4: `L` vs `L`. This is a **match**.\n5.  Position 5: `I` vs `-`. This is a **gap**.\n6.  Position 6: `S` vs `S`. This is a **match**.\n7.  Position 7: `Q` vs `R`. This is a **mismatch**.\n8.  Position 8: `R` vs `Q`. This is a **mismatch**.\n9.  Position 9: `T` vs `T`. This is a **match**.\n10. Position 10: `V` vs `-`. This is a **gap**.\n11. Position 11: `K` vs `K`. This is a **match**.\n\nNext, we count the total number of matches, mismatches, and gaps.\n-   Number of matches = 6 (at positions 1, 3, 4, 6, 9, 11)\n-   Number of mismatches = 3 (at positions 2, 7, 8)\n-   Number of gaps = 2 (at positions 5, 10)\n\nNow, we calculate the total score by multiplying the counts by their respective scores and summing the results.\n\nTotal Score = (Number of matches * Match score) + (Number of mismatches * Mismatch score) + (Number of gaps * Gap penalty)\n\nSubstituting the values:\nTotal Score = $(6 \\times 5) + (3 \\times (-3)) + (2 \\times (-8))$\nTotal Score = $30 - 9 - 16$\nTotal Score = $21 - 16$\nTotal Score = $5$\n\nThus, the total alignment score for the given alignment is 5.", "answer": "$$\\boxed{5}$$", "id": "2136319"}, {"introduction": "While the first exercise used arbitrary scores, real-world substitution matrices are built on a firm statistical foundation. This practice delves into the theory behind matrices like BLOSUM by having you construct a log-odds scoring system from scratch. You will calculate the scores that reflect the likelihood of one residue substituting for another in an evolutionarily related context compared to random chance, providing insight into why some substitutions are favored while others are penalized. [@problem_id:2371031]", "problem": "You are given a simplified residue alphabet with two physicochemical categories: hydrophobic ($\\mathrm{H}$) and polar ($\\mathrm{P}$). From a curated set of homologous protein sequence alignments, the following ordered aligned-pair counts were observed across $N$ aligned positions: $\\mathrm{H}$–$\\mathrm{H}$ pairs: $2800$, $\\mathrm{H}$–$\\mathrm{P}$ pairs: $1200$, $\\mathrm{P}$–$\\mathrm{H}$ pairs: $1200$, and $\\mathrm{P}$–$\\mathrm{P}$ pairs: $4800$, where $N = 2800 + 1200 + 1200 + 4800$. Separately, background composition estimated from a large nonredundant protein database gives $\\Pr(\\mathrm{H}) = 0.40$ and $\\Pr(\\mathrm{P}) = 0.60$.\n\nBy definition, the log-odds substitution score for an aligned pair $(a,b)$ is $s(a,b) = \\ln\\!\\big(q_{ab} / (p_{a} p_{b})\\big)$, where $q_{ab}$ is the joint probability of observing the ordered aligned pair $(a,b)$ in homologous alignments and $p_{a}$ is the background probability of residue class $a$. Use the natural logarithm for $\\ln(\\cdot)$ in your computations.\n\nCompute the log-odds scores $s(\\mathrm{H},\\mathrm{H})$, $s(\\mathrm{H},\\mathrm{P})$, $s(\\mathrm{P},\\mathrm{H})$, and $s(\\mathrm{P},\\mathrm{P})$. Report your final numeric scores in the order $s(\\mathrm{H},\\mathrm{H})$, $s(\\mathrm{H},\\mathrm{P})$, $s(\\mathrm{P},\\mathrm{H})$, $s(\\mathrm{P},\\mathrm{P})$ as a single row matrix, rounding each entry to four significant figures.", "solution": "The log-odds score, $s(a,b)$, for an aligned pair of residues $(a,b)$ is defined as:\n$$s(a,b) = \\ln\\left( \\frac{q_{ab}}{p_{a} p_{b}} \\right)$$\nwhere $q_{ab}$ is the target frequency of observing the ordered pair $(a,b)$ in alignments of homologous sequences, and $p_a$ and $p_b$ are the background frequencies of residues $a$ and $b$.\n\nThe given data are:\n- Observed counts for aligned pairs:\n  - $C(\\mathrm{H},\\mathrm{H}) = 2800$\n  - $C(\\mathrm{H},\\mathrm{P}) = 1200$\n  - $C(\\mathrm{P},\\mathrm{H}) = 1200$\n  - $C(\\mathrm{P},\\mathrm{P}) = 4800$\n- Background probabilities:\n  - $p_{\\mathrm{H}} = 0.40$\n  - $p_{\\mathrm{P}} = 0.60$\n\nFirst, calculate the total number of aligned positions, $N$.\n$$N = 2800 + 1200 + 1200 + 4800 = 10000$$\n\nNext, compute the target frequencies, $q_{ab}$, by dividing the observed count for each pair by $N$.\n$$q_{\\mathrm{HH}} = \\frac{2800}{10000} = 0.28$$\n$$q_{\\mathrm{HP}} = \\frac{1200}{10000} = 0.12$$\n$$q_{\\mathrm{PH}} = \\frac{1200}{10000} = 0.12$$\n$$q_{\\mathrm{PP}} = \\frac{4800}{10000} = 0.48$$\n\nNow, compute the expected frequencies, $p_a p_b$, for each pair based on the background probabilities.\n$$p_{\\mathrm{H}} p_{\\mathrm{H}} = (0.40)(0.40) = 0.16$$\n$$p_{\\mathrm{H}} p_{\\mathrm{P}} = (0.40)(0.60) = 0.24$$\n$$p_{\\mathrm{P}} p_{\\mathrm{H}} = (0.60)(0.40) = 0.24$$\n$$p_{\\mathrm{P}} p_{\\mathrm{P}} = (0.60)(0.60) = 0.36$$\n\nWith all components calculated, we can determine the log-odds score for each pair using the natural logarithm, $\\ln(\\cdot)$.\n\nFor the H–H pair:\n$$s(\\mathrm{H},\\mathrm{H}) = \\ln\\left( \\frac{q_{\\mathrm{HH}}}{p_{\\mathrm{H}} p_{\\mathrm{H}}} \\right) = \\ln\\left( \\frac{0.28}{0.16} \\right) = \\ln(1.75) \\approx 0.5596$$\n\nFor the H–P pair:\n$$s(\\mathrm{H},\\mathrm{P}) = \\ln\\left( \\frac{q_{\\mathrm{HP}}}{p_{\\mathrm{H}} p_{\\mathrm{P}}} \\right) = \\ln\\left( \\frac{0.12}{0.24} \\right) = \\ln(0.5) \\approx -0.6931$$\n\nFor the P–H pair:\n$$s(\\mathrm{P},\\mathrm{H}) = \\ln\\left( \\frac{q_{\\mathrm{PH}}}{p_{\\mathrm{P}} p_{\\mathrm{H}}} \\right) = \\ln\\left( \\frac{0.12}{0.24} \\right) = \\ln(0.5) \\approx -0.6931$$\n\nFor the P–P pair:\n$$s(\\mathrm{P},\\mathrm{P}) = \\ln\\left( \\frac{q_{\\mathrm{PP}}}{p_{\\mathrm{P}} p_{\\mathrm{P}}} \\right) = \\ln\\left( \\frac{0.48}{0.36} \\right) = \\ln\\left( \\frac{4}{3} \\right) \\approx 0.2877$$\n\nThe computed scores, rounded to four significant figures, are $s(\\mathrm{H},\\mathrm{H}) = 0.5596$, $s(\\mathrm{H},\\mathrm{P}) = -0.6931$, $s(\\mathrm{P},\\mathrm{H}) = -0.6931$, and $s(\\mathrm{P},\\mathrm{P}) = 0.2877$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5596  -0.6931  -0.6931  0.2877\n\\end{pmatrix}\n}\n$$", "id": "2371031"}, {"introduction": "Scoring schemes can be tailored to investigate specific biological questions. This advanced problem takes you from the amino acid level down to the DNA codon level, a perspective crucial for studies in molecular evolution. You will design and apply a scoring system that distinguishes between synonymous substitutions (which do not change the amino acid) and non-synonymous ones, and further differentiates between transitions and transversions, revealing a deeper layer of evolutionary information embedded in the sequences. [@problem_id:2370992]", "problem": "Two protein-coding deoxyribonucleic acid (DNA) sequences are aligned in-frame, codon-by-codon, with no insertions or deletions. Consider the following two sequences (written as contiguous codons, left to right):\n\n- Sequence A: GCT GCT GGT TCT GAA ATG TGT GTT\n- Sequence B: GCT GCC GGA AGC GAC ATA TAT GAT\n\nFor the codons that appear in these sequences, use the following mapping from codon to amino acid (standard genetic code, restricted to the codons present here):\n- GCT, GCC: Alanine\n- GGT, GGA: Glycine\n- TCT, AGC: Serine\n- GAA: Glutamate\n- GAC, GAT: Aspartate\n- ATG: Methionine\n- ATA: Isoleucine\n- TGT: Cysteine\n- TAT: Tyrosine\n- GTT: Valine\n\nDefine the substitution score for each aligned codon pair as follows:\n- If the codons are identical, add $+6$.\n- If the codons are different but encode the same amino acid (synonymous change), then for each nucleotide difference between the two codons: add $-1$ for a transition and $-2$ for a transversion.\n- If the codons encode different amino acids (non-synonymous change), then for each nucleotide difference between the two codons: add $-3$ for a transition and $-4$ for a transversion.\n\nA transition is a change between purines (A $\\leftrightarrow$ G) or between pyrimidines (C $\\leftrightarrow$ T). A transversion is any change between a purine and a pyrimidine (A $\\leftrightarrow$ C, A $\\leftrightarrow$ T, G $\\leftrightarrow$ C, G $\\leftrightarrow$ T).\n\nCompute the total alignment score by summing the substitution scores over all aligned codon pairs. Report the total as a single integer (no rounding needed).", "solution": "The total alignment score, $S_{total}$, is the sum of the scores for each of the $8$ aligned codon pairs. We will analyze each pair systematically.\n\nThe two sequences are:\n- Sequence A: $S_A = (\\text{GCT, GCT, GGT, TCT, GAA, ATG, TGT, GTT})$\n- Sequence B: $S_B = (\\text{GCT, GCC, GGA, AGC, GAC, ATA, TAT, GAT})$\n\nLet us denote the score for the $i$-th codon pair as $s_i$.\n\n1.  Pair 1: $\\text{GCT}$ vs $\\text{GCT}$\n    - The codons are identical.\n    - Amino acids: Alanine vs Alanine.\n    - According to the rule, the score is $s_1 = +6$.\n\n2.  Pair 2: $\\text{GCT}$ vs $\\text{GCC}$\n    - The codons are different.\n    - Amino acids: GCT $\\rightarrow$ Alanine, GCC $\\rightarrow$ Alanine. This is a synonymous change.\n    - The third position differs: T $\\rightarrow$ C. This is a transition.\n    - The score for one synonymous transition is $-1$.\n    - $s_2 = -1$.\n\n3.  Pair 3: $\\text{GGT}$ vs $\\text{GGA}$\n    - The codons are different.\n    - Amino acids: GGT $\\rightarrow$ Glycine, GGA $\\rightarrow$ Glycine. This is a synonymous change.\n    - The third position differs: T $\\rightarrow$ A. This is a transversion.\n    - The score for one synonymous transversion is $-2$.\n    - $s_3 = -2$.\n\n4.  Pair 4: $\\text{TCT}$ vs $\\text{AGC}$\n    - The codons are different.\n    - Amino acids: TCT $\\rightarrow$ Serine, AGC $\\rightarrow$ Serine. This is a synonymous change.\n    - We examine the differences at each position:\n        - Position 1: T $\\rightarrow$ A. This is a transversion. Score contribution: $-2$.\n        - Position 2: C $\\rightarrow$ G. This is a transversion. Score contribution: $-2$.\n        - Position 3: T $\\rightarrow$ C. This is a transition. Score contribution: $-1$.\n    - The total score for this pair is the sum of the penalties: $s_4 = (-2) + (-2) + (-1) = -5$.\n\n5.  Pair 5: $\\text{GAA}$ vs $\\text{GAC}$\n    - The codons are different.\n    - Amino acids: GAA $\\rightarrow$ Glutamate, GAC $\\rightarrow$ Aspartate. This is a non-synonymous change.\n    - The third position differs: A $\\rightarrow$ C. This is a transversion.\n    - The score for one non-synonymous transversion is $-4$.\n    - $s_5 = -4$.\n\n6.  Pair 6: $\\text{ATG}$ vs $\\text{ATA}$\n    - The codons are different.\n    - Amino acids: ATG $\\rightarrow$ Methionine, ATA $\\rightarrow$ Isoleucine. This is a non-synonymous change.\n    - The third position differs: G $\\rightarrow$ A. This is a transition.\n    - The score for one non-synonymous transition is $-3$.\n    - $s_6 = -3$.\n\n7.  Pair 7: $\\text{TGT}$ vs $\\text{TAT}$\n    - The codons are different.\n    - Amino acids: TGT $\\rightarrow$ Cysteine, TAT $\\rightarrow$ Tyrosine. This is a non-synonymous change.\n    - The second position differs: G $\\rightarrow$ A. This is a transition.\n    - The score for one non-synonymous transition is $-3$.\n    - $s_7 = -3$.\n\n8.  Pair 8: $\\text{GTT}$ vs $\\text{GAT}$\n    - The codons are different.\n    - Amino acids: GTT $\\rightarrow$ Valine, GAT $\\rightarrow$ Aspartate. This is a non-synonymous change.\n    - The second position differs: T $\\rightarrow$ A. This is a transversion.\n    - The score for one non-synonymous transversion is $-4$.\n    - $s_8 = -4$.\n\nFinally, the total alignment score $S_{total}$ is the sum of the individual scores:\n$$S_{total} = \\sum_{i=1}^{8} s_i = s_1 + s_2 + s_3 + s_4 + s_5 + s_6 + s_7 + s_8$$\n$$S_{total} = 6 + (-1) + (-2) + (-5) + (-4) + (-3) + (-3) + (-4)$$\n$$S_{total} = 6 - (1 + 2 + 5 + 4 + 3 + 3 + 4) = 6 - 22$$\n$$S_{total} = -16$$\nThe total alignment score is $-16$.", "answer": "$$\\boxed{-16}$$", "id": "2370992"}]}