{"hands_on_practices": [{"introduction": "To begin our practice, we will analyze a recurrence that arises naturally in the study of randomized algorithms. This exercise [@problem_id:3277485] provides a direct application of the substitution method to solve $T(n) = T(n-1) + 1/n$, demonstrating how unrolling the recurrence reveals a connection to the well-known Harmonic series. Mastering this foundational example is the first step toward tackling more complex recurrence relations.", "problem": "Consider an algorithm that processes a stream of $n$ distinct elements arriving one by one and maintains a running minimum. Each time the current element is strictly smaller than all previously seen elements, the algorithm performs an additional constant-time update. Let $T(n)$ denote the expected number of these additional updates after observing $n$ elements, and suppose the following recurrence holds for all integers $n \\geq 2$:\n$$\nT(n) = T(n-1) + \\frac{1}{n},\n$$\nwith base condition $T(1) = 0$. Using the substitution method (also known as the method of unrolling), derive a closed-form expression for $T(n)$ in terms of the $n$th harmonic number $H_n$, where $H_n$ is defined by\n$$\nH_n = \\sum_{k=1}^{n} \\frac{1}{k}.\n$$\nYour final answer must be a single analytic expression written in terms of $n$ and $H_n$.", "solution": "The problem statement is first validated according to the required procedure.\n\n### Step 1: Extract Givens\n- The stream has $n$ distinct elements.\n- The recurrence relation for the expected number of updates $T(n)$ is $T(n) = T(n-1) + \\frac{1}{n}$ for all integers $n \\geq 2$.\n- The base condition is $T(1) = 0$.\n- The method to be used is the substitution method (unrolling).\n- The $n$th harmonic number is defined as $H_n = \\sum_{k=1}^{n} \\frac{1}{k}$.\n- The objective is to find a closed-form expression for $T(n)$ in terms of $n$ and $H_n$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is standard in the analysis of algorithms. If the $n$ elements arrive in a random permutation, the probability that the $n$-th element is the minimum of all elements seen so far is exactly $\\frac{1}{n}$. By linearity of expectation, the expected number of updates at step $n$ is $\\frac{1}{n}$, leading to the given recurrence. The problem is mathematically sound.\n2.  **Well-Posed**: The problem provides a first-order linear recurrence relation with a specified base case. This structure guarantees a unique solution.\n3.  **Objective**: The problem is stated using precise mathematical language with no ambiguity.\n4.  **Completeness**: All necessary information (recurrence, base case, definition of $H_n$) is provided.\n5.  **Relevance**: The problem is a direct application of the substitution method for solving recurrences, a core topic in data structures and algorithms.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically grounded, well-posed, objective, and complete. A solution will be derived.\n\nThe problem requires solving the recurrence relation\n$$\nT(n) = T(n-1) + \\frac{1}{n}\n$$\nfor $n \\geq 2$, with the base case $T(1) = 0$. The method to be used is the substitution method, also known as unrolling or iteration.\n\nWe begin with the given recurrence relation:\n$$\nT(n) = T(n-1) + \\frac{1}{n}\n$$\nWe unroll the recurrence by repeatedly substituting the expression for the term with a smaller index.\nFor the $T(n-1)$ term, the recurrence relation implies $T(n-1) = T(n-2) + \\frac{1}{n-1}$. Substituting this into the equation for $T(n)$:\n$$\nT(n) = \\left( T(n-2) + \\frac{1}{n-1} \\right) + \\frac{1}{n} = T(n-2) + \\frac{1}{n-1} + \\frac{1}{n}\n$$\nNext, we substitute for $T(n-2)$, which is $T(n-3) + \\frac{1}{n-2}$:\n$$\nT(n) = \\left( T(n-3) + \\frac{1}{n-2} \\right) + \\frac{1}{n-1} + \\frac{1}{n} = T(n-3) + \\frac{1}{n-2} + \\frac{1}{n-1} + \\frac{1}{n}\n$$\nA pattern is emerging. After $i$ steps of unrolling, the expression becomes:\n$$\nT(n) = T(n-i) + \\sum_{k=0}^{i-1} \\frac{1}{n-k}\n$$\nTo reach the base case $T(1)$, we must unroll until the argument of $T$ becomes $1$. We set $n-i = 1$, which gives $i = n-1$.\nSubstituting $i = n-1$ into the general pattern:\n$$\nT(n) = T(n-(n-1)) + \\sum_{k=0}^{(n-1)-1} \\frac{1}{n-k} = T(1) + \\sum_{k=0}^{n-2} \\frac{1}{n-k}\n$$\nLet's expand the summation to see the terms explicitly:\n$$\n\\sum_{k=0}^{n-2} \\frac{1}{n-k} = \\frac{1}{n-0} + \\frac{1}{n-1} + \\dots + \\frac{1}{n-(n-2)} = \\frac{1}{n} + \\frac{1}{n-1} + \\dots + \\frac{1}{2}\n$$\nThis is the sum of reciprocals from $2$ to $n$. We can write this using summation notation with an index running upwards:\n$$\n\\sum_{j=2}^{n} \\frac{1}{j}\n$$\nSo, the expression for $T(n)$ becomes:\n$$\nT(n) = T(1) + \\sum_{j=2}^{n} \\frac{1}{j}\n$$\nWe are given the base condition $T(1) = 0$. Substituting this value:\n$$\nT(n) = 0 + \\sum_{j=2}^{n} \\frac{1}{j} = \\sum_{j=2}^{n} \\frac{1}{j}\n$$\nThe problem asks for the solution in terms of the $n$th harmonic number, $H_n$, which is defined as:\n$$\nH_n = \\sum_{k=1}^{n} \\frac{1}{k}\n$$\nWe can split the sum for $H_n$ at $k=1$:\n$$\nH_n = \\frac{1}{1} + \\sum_{k=2}^{n} \\frac{1}{k} = 1 + \\sum_{k=2}^{n} \\frac{1}{k}\n$$\nComparing this with our expression for $T(n)$, we see that $T(n) = \\sum_{j=2}^{n} \\frac{1}{j}$.\nTherefore, we can write:\n$$\nH_n = 1 + T(n)\n$$\nSolving for $T(n)$, we obtain the final closed-form expression:\n$$\nT(n) = H_n - 1\n$$\nThis is the expected number of times the running minimum is updated when processing a random permutation of $n$ distinct elements.", "answer": "$$\\boxed{H_n - 1}$$", "id": "3277485"}, {"introduction": "This next practice problem [@problem_id:3277477] introduces two new challenges: a recurrence with a step size greater than one and an additive polynomial term. By solving $T(n) = T(n-3) + n^2 + n$, you will learn how to adapt the unrolling technique for larger steps and practice using standard formulas for sums of powers. This exercise is crucial for developing the algebraic facility required for analyzing a wider class of algorithms.", "problem": "Let $T(n)$ be a function defined on the set of nonnegative integers $n$ that are divisible by $3$. The function satisfies the recurrence\n$$T(0)=0 \\quad \\text{and} \\quad T(n)=T(n-3)+n^{2}+n \\quad \\text{for all } n \\geq 3 \\text{ with } 3 \\mid n.$$\nStarting from core definitions of a recurrence and the principle of mathematical induction, and using well-tested summation facts about arithmetic series and squares of integers, derive a tight bound for $T(n)$ by first unrolling the recurrence and then verifying your bound with the substitution method (induction). As a final step, express $T(n)$ in closed form as a function of $n$ for the specified domain $3 \\mid n$. Provide your final answer as a single closed-form expression for $T(n)$.", "solution": "The problem statement is assessed to be valid. It is a well-posed, self-contained, and scientifically grounded problem in discrete mathematics, specifically the analysis of recurrence relations. All necessary components—the domain, base case, and recursive step—are provided without contradiction or ambiguity. We may proceed with the solution.\n\nThe task is to find a closed-form expression for the function $T(n)$ defined for non-negative integers $n$ divisible by $3$, which satisfies the recurrence relation:\n$$T(0) = 0$$\n$$T(n) = T(n-3) + n^2 + n \\quad \\text{for } n \\ge 3 \\text{ and } 3 \\mid n$$\n\nWe will first derive a candidate closed-form solution by unrolling the recurrence and then verify this candidate solution using the substitution method, which is a form of mathematical induction.\n\n**Step 1: Deriving a Closed-Form Expression by Unrolling**\n\nSince $n$ must be a non-negative integer divisible by $3$, we can express $n$ as $n = 3k$ for some non-negative integer $k$. The recurrence can be unrolled as follows:\n$$T(n) = T(n-3) + n^2 + n$$\n$$T(n) = \\left( T(n-6) + (n-3)^2 + (n-3) \\right) + n^2 + n$$\n$$T(n) = \\left( T(n-9) + (n-6)^2 + (n-6) \\right) + (n-3)^2 + (n-3) + n^2 + n$$\nContinuing this process until we reach the base case $T(0)$, we can see a pattern emerging. The term $T(n)$ is the sum of terms of the form $(j)^2+j$ for each multiple of $3$ from $n$ down to $3$, plus the base case $T(0)$.\nLet $n=3k$. The sequence of values for the argument of $T$ is $n, n-3, n-6, \\dots, 3, 0$, which corresponds to $3k, 3(k-1), 3(k-2), \\dots, 3(1), 3(0)$.\nThis can be expressed as a summation:\n$$T(n) = T(0) + \\sum_{i=1}^{k} \\left( (3i)^2 + 3i \\right)$$\nGiven that $T(0)=0$:\n$$T(n) = \\sum_{i=1}^{k} (9i^2 + 3i)$$\nWe can split the summation into two parts:\n$$T(n) = 9 \\sum_{i=1}^{k} i^2 + 3 \\sum_{i=1}^{k} i$$\nWe use the well-known summation formulas for the sum of the first $k$ integers and the sum of the first $k$ squares:\n$$\\sum_{i=1}^{k} i = \\frac{k(k+1)}{2}$$\n$$\\sum_{i=1}^{k} i^2 = \\frac{k(k+1)(2k+1)}{6}$$\nSubstituting these formulas into our expression for $T(n)$:\n$$T(n) = 9 \\left( \\frac{k(k+1)(2k+1)}{6} \\right) + 3 \\left( \\frac{k(k+1)}{2} \\right)$$\n$$T(n) = \\frac{3}{2} k(k+1)(2k+1) + \\frac{3}{2} k(k+1)$$\nWe can factor out the common term $\\frac{3}{2}k(k+1)$:\n$$T(n) = \\frac{3}{2} k(k+1) \\left( (2k+1) + 1 \\right)$$\n$$T(n) = \\frac{3}{2} k(k+1) (2k+2)$$\n$$T(n) = \\frac{3}{2} k(k+1) \\cdot 2(k+1)$$\n$$T(n) = 3k(k+1)^2$$\nThis is the closed-form expression for $T(n)$ in terms of $k$. To get the expression in terms of $n$, we substitute $k = \\frac{n}{3}$:\n$$T(n) = 3\\left(\\frac{n}{3}\\right)\\left(\\frac{n}{3} + 1\\right)^2$$\n$$T(n) = n\\left(\\frac{n+3}{3}\\right)^2$$\n$$T(n) = n \\frac{(n+3)^2}{9}$$\n$$T(n) = \\frac{n(n^2+6n+9)}{9} = \\frac{n^3+6n^2+9n}{9} = \\frac{1}{9}n^3 + \\frac{2}{3}n^2 + n$$\nOur candidate solution is $T(n) = \\frac{n(n+3)^2}{9}$.\n\n**Step 2: Verification by Substitution Method (Mathematical Induction)**\n\nWe will prove by induction that our proposed closed-form solution $T(n) = \\frac{1}{9}n^3 + \\frac{2}{3}n^2 + n$ is correct for all non-negative integers $n$ divisible by $3$.\n\n**Inductive Hypothesis:** Let $P(n)$ be the proposition that $T(n) = \\frac{1}{9}n^3 + \\frac{2}{3}n^2 + n$. The induction will proceed on $n$ in steps of $3$.\n\n**Base Case:** We must verify $P(0)$.\nThe problem defines $T(0) = 0$.\nOur formula gives $T(0) = \\frac{1}{9}(0)^3 + \\frac{2}{3}(0)^2 + 0 = 0$.\nThe base case holds.\n\n**Inductive Step:** Assume that $P(n)$ is true for some arbitrary non-negative integer $n$ that is divisible by $3$. That is, we assume:\n$$T(n) = \\frac{1}{9}n^3 + \\frac{2}{3}n^2 + n$$\nWe must show that $P(n+3)$ is true. That is, we must show that $T(n+3) = \\frac{1}{9}(n+3)^3 + \\frac{2}{3}(n+3)^2 + (n+3)$.\n\nWe start with the recursive definition of $T(n+3)$:\n$$T(n+3) = T(n) + (n+3)^2 + (n+3)$$\nNow, we substitute the inductive hypothesis for $T(n)$:\n$$T(n+3) = \\left( \\frac{1}{9}n^3 + \\frac{2}{3}n^2 + n \\right) + (n^2 + 6n + 9) + (n+3)$$\nCombine like terms:\n$$T(n+3) = \\frac{1}{9}n^3 + \\left(\\frac{2}{3} + 1\\right)n^2 + (1 + 6 + 1)n + (9 + 3)$$\n$$T(n+3) = \\frac{1}{9}n^3 + \\left(\\frac{2}{3} + \\frac{3}{3}\\right)n^2 + 8n + 12$$\n$$T(n+3) = \\frac{1}{9}n^3 + \\frac{5}{3}n^2 + 8n + 12$$\nThis is the result derived from the recurrence. Now, we expand the target formula for $T(n+3)$ to verify if it matches:\n$$T(n+3) = \\frac{1}{9}(n+3)^3 + \\frac{2}{3}(n+3)^2 + (n+3)$$\nExpand the terms:\n$$(n+3)^3 = n^3 + 3(n^2)(3) + 3(n)(3^2) + 3^3 = n^3 + 9n^2 + 27n + 27$$\n$$(n+3)^2 = n^2 + 6n + 9$$\nSubstitute the expansions back into the expression for $T(n+3)$:\n$$T(n+3) = \\frac{1}{9}(n^3 + 9n^2 + 27n + 27) + \\frac{2}{3}(n^2 + 6n + 9) + (n+3)$$\n$$T(n+3) = \\left(\\frac{1}{9}n^3 + n^2 + 3n + 3\\right) + \\left(\\frac{2}{3}n^2 + 4n + 6\\right) + (n+3)$$\nAgain, combine like terms:\n$$T(n+3) = \\frac{1}{9}n^3 + \\left(1 + \\frac{2}{3}\\right)n^2 + (3 + 4 + 1)n + (3 + 6 + 3)$$\n$$T(n+3) = \\frac{1}{9}n^3 + \\frac{5}{3}n^2 + 8n + 12$$\nThe expression derived from the recurrence and the inductive hypothesis matches the expanded target formula. Thus, the inductive step is proven.\n\nBy the principle of mathematical induction, the formula $T(n) = \\frac{1}{9}n^3 + \\frac{2}{3}n^2 + n$ is correct for all non-negative integers $n$ divisible by $3$. The more compact factored form is $T(n) = \\frac{n(n+3)^2}{9}$.\n\n**Final Answer**\n\nThe closed-form expression for $T(n)$ on its specified domain is $\\frac{n(n+3)^2}{9}$.", "answer": "$$\\boxed{\\frac{n(n+3)^{2}}{9}}$$", "id": "3277477"}, {"introduction": "Our final exercise [@problem_id:3277510] explores a critical nuance in solving recurrences: dependency on the input's properties. By analyzing $T(n) = T(n-2) + n^2$, you will discover how the parity of $n$ determines which base case is reached, leading to two distinct closed-form solutions for even and odd inputs. This practice will sharpen your attention to detail and demonstrate the importance of considering all possible execution paths of a recurrence.", "problem": "Consider the recurrence relation on the nonnegative integers defined by $T(n) = T(n-2) + n^{2}$ for all integers $n \\geq 2$, with base values $T(0) = \\alpha$ and $T(1) = \\beta$, where $\\alpha$ and $\\beta$ are fixed real constants. Using the substitution (iterative expansion) method, start from the recurrence definition and unroll it until a base case is reached. Carefully account for how parity affects the unrolling path, and reduce the resulting expressions to closed forms using well-tested summation facts. Your task is to derive exact closed-form analytic expressions for $T(n)$ in terms of $n$, $\\alpha$, and $\\beta$, distinguishing the cases where $n$ is even and where $n$ is odd. Express your final answer as a row matrix where the first entry corresponds to the closed form for even $n$ and the second entry corresponds to the closed form for odd $n$. No rounding is required.", "solution": "The problem is valid as it is a well-posed mathematical problem in the analysis of algorithms, with a complete and consistent setup. We will proceed to solve it using the substitution method as requested.\n\nThe recurrence relation is given by $T(n) = T(n-2) + n^{2}$ for integers $n \\geq 2$, with initial conditions $T(0) = \\alpha$ and $T(1) = \\beta$. The step size of $2$ in the recurrence argument, $n-2$, indicates that the parity of the input is preserved. This means that values of $T(n)$ for even $n$ depend only on the base case $T(0)$, and values for odd $n$ depend only on $T(1)$. We must therefore analyze the two cases separately.\n\n**Case 1: $n$ is even**\nLet $n$ be an even non-negative integer. We can write $n = 2k$ for some integer $k \\geq 0$. We will use the substitution method (iterative expansion) to unroll the recurrence until we reach the base case $T(0)$.\n$T(n) = T(n-2) + n^2$\n$T(n) = \\left( T(n-4) + (n-2)^2 \\right) + n^2 = T(n-4) + (n-2)^2 + n^2$\n$T(n) = \\left( T(n-6) + (n-4)^2 \\right) + (n-2)^2 + n^2 = T(n-6) + (n-4)^2 + (n-2)^2 + n^2$\n\nAfter $i$ steps of unrolling, the recurrence becomes:\n$T(n) = T(n-2i) + \\sum_{j=0}^{i-1} (n-2j)^2$\n\nSince $n = 2k$, we want to find the number of steps $i$ required to reach the base case $T(0)$. This occurs when $n-2i = 0$, which implies $2k - 2i = 0$, so $i=k$.\nSubstituting $i=k$ and $n=2k$ into the expanded form:\n$T(2k) = T(2k - 2k) + \\sum_{j=0}^{k-1} (2k - 2j)^2$\n$T(2k) = T(0) + \\sum_{j=0}^{k-1} (2(k-j))^2$\n$T(2k) = \\alpha + 4 \\sum_{j=0}^{k-1} (k-j)^2$\n\nLet the index of summation be $m = k-j$. When $j=0$, $m=k$. When $j=k-1$, $m=1$. The sum becomes:\n$T(2k) = \\alpha + 4 \\sum_{m=1}^{k} m^2$\n\nWe use the standard formula for the sum of the first $k$ squares: $\\sum_{m=1}^{k} m^2 = \\frac{k(k+1)(2k+1)}{6}$.\n$T(2k) = \\alpha + 4 \\left( \\frac{k(k+1)(2k+1)}{6} \\right) = \\alpha + \\frac{2}{3} k(k+1)(2k+1)$\n\nTo obtain the closed form in terms of $n$, we substitute $k = n/2$:\n$T(n) = \\alpha + \\frac{2}{3} \\left(\\frac{n}{2}\\right) \\left(\\frac{n}{2}+1\\right) \\left(2 \\cdot \\frac{n}{2}+1\\right)$\n$T(n) = \\alpha + \\frac{n}{3} \\left(\\frac{n+2}{2}\\right) (n+1)$\n$T(n) = \\alpha + \\frac{n(n+1)(n+2)}{6}$\n\n**Case 2: $n$ is odd**\nLet $n$ be an odd non-negative integer. We can write $n = 2k+1$ for some integer $k \\geq 0$. We unroll the recurrence until we reach the base case $T(1)$.\nAfter $i$ steps, we have:\n$T(n) = T(n-2i) + \\sum_{j=0}^{i-1} (n-2j)^2$\n\nSince $n = 2k+1$, we want to find the number of steps $i$ required to reach $T(1)$. This occurs when $n-2i = 1$, which implies $2k+1 - 2i = 1$, so $2k = 2i$, and $i=k$.\nSubstituting $i=k$ and $n=2k+1$:\n$T(2k+1) = T(2k+1 - 2k) + \\sum_{j=0}^{k-1} (2k+1 - 2j)^2$\n$T(2k+1) = T(1) + \\sum_{j=0}^{k-1} (2(k-j)+1)^2$\nThe terms in the sum are $(2k+1)^2, (2k-1)^2, \\dots, 3^2$. Let the index of summation be $m=j+1$. The sum is $\\sum_{m=1}^k (2(k-m+1)+1)^2$. This is getting complicated. Let's list the terms again.\n$j=0 \\implies (2k+1)^2$. $j=1 \\implies (2k-1)^2$. ... $j=k-1 \\implies (2k+1-2(k-1))^2 = 3^2$. The sum is $\\sum_{i=1}^k (2i+1)^2$. Let's check the derivation in the original text. It has $\\sum_{m=1}^{k} (2m+1)^2$. This is correct.\n\nWe evaluate the sum $\\sum_{m=1}^{k} (2m+1)^2$:\n$\\sum_{m=1}^{k} (2m+1)^2 = \\sum_{m=1}^{k} (4m^2 + 4m + 1) = 4\\sum_{m=1}^{k} m^2 + 4\\sum_{m=1}^{k} m + \\sum_{m=1}^{k} 1$\nUsing the formulas $\\sum m^2 = \\frac{k(k+1)(2k+1)}{6}$, $\\sum m = \\frac{k(k+1)}{2}$, and $\\sum 1 = k$:\n$S_k = 4\\left(\\frac{k(k+1)(2k+1)}{6}\\right) + 4\\left(\\frac{k(k+1)}{2}\\right) + k$\n$S_k = \\frac{2k(k+1)(2k+1)}{3} + 2k(k+1) + k$\n$S_k = \\frac{k}{3} [2(k+1)(2k+1) + 6(k+1) + 3]$\n$S_k = \\frac{k}{3} [2(2k^2+3k+1) + 6k+6 + 3]$\n$S_k = \\frac{k}{3} [4k^2+6k+2 + 6k+9] = \\frac{k(4k^2+12k+11)}{3}$\nSo, $T(2k+1) = \\beta + S_k = \\beta + \\frac{k(4k^2+12k+11)}{3}$.\n\nTo obtain the closed form in terms of $n$, we substitute $k = (n-1)/2$:\n$T(n) = \\beta + \\frac{(n-1)/2}{3} \\left[ 4\\left(\\frac{n-1}{2}\\right)^2 + 12\\left(\\frac{n-1}{2}\\right) + 11 \\right]$\n$T(n) = \\beta + \\frac{n-1}{6} \\left[ 4\\frac{(n-1)^2}{4} + 6(n-1) + 11 \\right]$\n$T(n) = \\beta + \\frac{n-1}{6} [ (n^2-2n+1) + 6n-6+11 ]$\n$T(n) = \\beta + \\frac{n-1}{6} (n^2+4n+6)$\nExpanding the polynomial product:\n$(n-1)(n^2+4n+6) = n(n^2+4n+6) - (n^2+4n+6) = n^3+4n^2+6n - n^2-4n-6 = n^3+3n^2+2n-6$\nThe term $n^3+3n^2+2n$ can be factored as $n(n^2+3n+2) = n(n+1)(n+2)$.\nSo, the expression becomes:\n$T(n) = \\beta + \\frac{n(n+1)(n+2) - 6}{6}$\n$T(n) = \\beta + \\frac{n(n+1)(n+2)}{6} - 1$\n\nIn summary, the closed-form solutions are:\nFor even $n$: $T(n) = \\alpha + \\frac{n(n+1)(n+2)}{6}$\nFor odd $n$: $T(n) = \\beta - 1 + \\frac{n(n+1)(n+2)}{6}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha + \\frac{n(n+1)(n+2)}{6}  \\beta - 1 + \\frac{n(n+1)(n+2)}{6}\n\\end{pmatrix}\n}\n$$", "id": "3277510"}]}