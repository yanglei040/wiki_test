{"hands_on_practices": [{"introduction": "Understanding the impact of different distortion measures is a foundational skill. This first exercise [@problem_id:1618900] provides a concrete comparison between two of the most widely used metrics: squared-error and absolute-error distortion. By calculating the average distortion for a simple quantization system, you will develop an intuition for how each measure uniquely penalizes errors, with the squared-error metric placing a much greater weight on larger deviations.", "problem": "A digital thermometer is designed to measure environmental temperature. The true temperature, denoted by the continuous random variable $X$, is accurately modeled by a uniform distribution over the range $[-5.5, 5.5]$ degrees Celsius. The thermometer's internal analog-to-digital converter processes the true temperature $X$ and outputs a quantized value $\\hat{X}$, which is the integer closest to $X$.\n\nThe performance of this quantization process can be evaluated using different distortion measures. We consider two common ones:\n1.  The squared-error distortion, defined for a true value $x$ and its quantized version $\\hat{x}$ as $d_2(x, \\hat{x}) = (x - \\hat{x})^2$.\n2.  The absolute-error distortion, defined as $d_1(x, \\hat{x}) = |x - \\hat{x}|$.\n\nThe average distortion is the expected value of the distortion measure over the distribution of the true temperature $X$. Let $D_2$ be the average squared-error distortion and $D_1$ be the average absolute-error distortion.\n\nCalculate the ratio $\\frac{D_2}{D_1}$. Express your answer as an exact fraction.", "solution": "The quantizer maps each $x \\in [k - \\frac{1}{2}, k + \\frac{1}{2}]$ to the integer $k$, for $k \\in \\{-5,-4,\\ldots,5\\}$. Ties at half-integers are a measure-zero set and do not affect expectations. The true temperature $X$ is uniform on $[-5.5, 5.5]$, so its density is $f_{X}(x) = \\frac{1}{11}$ on this interval.\n\nDefine the quantization error $U = X - \\hat{X}$. On each cell $[k - \\frac{1}{2}, k + \\frac{1}{2}]$, write $x = k + u$ with $u \\in \\left[-\\frac{1}{2}, \\frac{1}{2}\\right]$, and then $\\hat{X} = k$, so $U = u$. By uniformity and translation invariance, the contribution from each cell is identical, and there are $11$ cells. Therefore,\n$$\nD_{2} = \\mathbb{E}\\!\\left[(X - \\hat{X})^{2}\\right] = \\sum_{k=-5}^{5} \\int_{k - \\frac{1}{2}}^{k + \\frac{1}{2}} (x - k)^{2} \\cdot \\frac{1}{11} \\, dx = \\int_{-\\frac{1}{2}}^{\\frac{1}{2}} u^{2} \\, du,\n$$\nwhere the factor $11$ from the sum cancels the $\\frac{1}{11}$ density after the change of variables $u = x - k$. Evaluate\n$$\n\\int_{-\\frac{1}{2}}^{\\frac{1}{2}} u^{2} \\, du = \\left[ \\frac{u^{3}}{3} \\right]_{-\\frac{1}{2}}^{\\frac{1}{2}} = \\frac{2}{3} \\left(\\frac{1}{2}\\right)^{3} = \\frac{1}{12}.\n$$\nSimilarly,\n$$\nD_{1} = \\mathbb{E}\\!\\left[|X - \\hat{X}|\\right] = \\sum_{k=-5}^{5} \\int_{k - \\frac{1}{2}}^{k + \\frac{1}{2}} |x - k| \\cdot \\frac{1}{11} \\, dx = \\int_{-\\frac{1}{2}}^{\\frac{1}{2}} |u| \\, du.\n$$\nBy symmetry,\n$$\n\\int_{-\\frac{1}{2}}^{\\frac{1}{2}} |u| \\, du = 2 \\int_{0}^{\\frac{1}{2}} u \\, du = 2 \\cdot \\frac{1}{2} \\left(\\frac{1}{2}\\right)^{2} = \\frac{1}{4}.\n$$\nHence the ratio is\n$$\n\\frac{D_{2}}{D_{1}} = \\frac{\\frac{1}{12}}{\\frac{1}{4}} = \\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1618900"}, {"introduction": "In many real-world applications, not all errors are created equal. This practice [@problem_id:1618945] moves beyond standard symmetric measures to explore a custom, asymmetric distortion function tailored to a specific contextâ€”financial modeling. Your task is not merely to calculate distortion, but to use it as a criterion for optimization, finding the best possible prediction to minimize a specific, business-defined cost.", "problem": "An automated financial modeling system is designed to predict the next day's closing price of a particular commodity. The actual closing price, denoted by the random variable $X$, is modeled as being uniformly distributed over a known interval $[A, B]$, where $A$ and $B$ are positive constants with $A < B$.\n\nThe system employs a simple prediction strategy: it always predicts a constant value $\\hat{x} = c$. The performance of the prediction is evaluated using a custom distortion function, $d(x, \\hat{x})$, designed by the firm. This function asymmetrically penalizes prediction errors. Specifically, it penalizes over-predictions (when the predicted price is higher than the actual price) more severely than under-predictions. The distortion is defined as:\n$$d(x, \\hat{x}) = \\begin{cases} (x - \\hat{x})^2 & \\text{if } x > \\hat{x} \\quad \\text{(under-prediction)} \\\\ 2(x - \\hat{x})^2 & \\text{if } x \\le \\hat{x} \\quad \\text{(over-prediction)} \\end{cases}$$\n\nYour task is to determine the optimal prediction value $c$ that minimizes the average (expected) distortion, $D(c) = E[d(X, c)]$. Express your final answer as a single closed-form analytic expression in terms of $A$ and $B$.", "solution": "Let $X \\sim \\text{Unif}[A,B]$ with density $f_{X}(x) = \\frac{1}{B-A}$ for $x \\in [A,B]$. For a constant predictor $\\hat{x}=c$, the expected distortion is\n$$\nD(c) = \\mathbb{E}[d(X,c)] = \\frac{1}{B-A} \\left( \\int_{A}^{\\min\\{c,B\\}} 2(x-c)^{2} \\, dx + \\int_{\\max\\{c,A\\}}^{B} (x-c)^{2} \\, dx \\right).\n$$\nWe evaluate $D(c)$ piecewise according to the position of $c$ relative to $A$ and $B$.\n\n1) If $c \\leq A$, then $x>c$ for all $x \\in [A,B]$, so\n$$\nD(c) = \\frac{1}{B-A} \\int_{A}^{B} (x-c)^{2} \\, dx = \\frac{1}{3(B-A)} \\left[ (B-c)^{3} - (A-c)^{3} \\right].\n$$\nDifferentiating,\n$$\nD'(c) = \\frac{1}{B-A} \\left[ (A-c)^{2} - (B-c)^{2} \\right] = 2c - (A+B).\n$$\nFor $c \\leq A < \\frac{A+B}{2}$, we have $D'(c) < 0$, so $D(c)$ decreases on $(-\\infty,A]$ and attains its minimum in this region at $c=A$.\n\n2) If $A \\leq c \\leq B$, then\n$$\nD(c) = \\frac{1}{B-A} \\left( \\int_{A}^{c} 2(x-c)^{2} \\, dx + \\int_{c}^{B} (x-c)^{2} \\, dx \\right)\n= \\frac{1}{3(B-A)} \\left[ (B-c)^{3} - 2(A-c)^{3} \\right].\n$$\nDifferentiating,\n$$\nD'(c) = \\frac{1}{B-A} \\left[ - (B-c)^{2} + 2(A-c)^{2} \\right].\n$$\nThe critical point in $[A,B]$ satisfies\n$$\n2(A-c)^{2} = (B-c)^{2} \\quad \\Longrightarrow \\quad \\sqrt{2}(c-A) = B-c \\quad \\Longrightarrow \\quad c^{*} = \\frac{B + \\sqrt{2}\\, A}{1 + \\sqrt{2}}.\n$$\nThe second derivative is\n$$\nD''(c) = \\frac{1}{B-A} \\left[ 2(B-c) - 4(A-c) \\right] = \\frac{2}{B-A} \\left( B - 2A + c \\right),\n$$\nwhich is positive for all $c \\in [A,B]$ because $B - 2A + c \\geq B - A > 0$. Hence $c^{*}$ is the unique minimizer in $[A,B]$.\n\n3) If $c \\geq B$, then $x \\leq c$ for all $x \\in [A,B]$, so\n$$\nD(c) = \\frac{2}{B-A} \\int_{A}^{B} (x-c)^{2} \\, dx = \\frac{2}{3(B-A)} \\left[ (B-c)^{3} - (A-c)^{3} \\right],\n$$\nand\n$$\nD'(c) = 4c - 2(A+B) > 0 \\quad \\text{for } c \\geq B,\n$$\nso $D(c)$ increases on $[B,\\infty)$ and attains its minimum in this region at $c=B$.\n\nCombining the regions, $D(c)$ decreases up to $c=A$, is strictly convex on $[A,B]$ with its unique minimum at $c^{*} = \\frac{B + \\sqrt{2}\\, A}{1 + \\sqrt{2}}$, and increases for $c \\geq B$. Therefore, the global minimizer is\n$$\nc^{*} = \\frac{B + \\sqrt{2}\\, A}{1 + \\sqrt{2}}.\n$$", "answer": "$$\\boxed{\\frac{B+\\sqrt{2}\\,A}{1+\\sqrt{2}}}$$", "id": "1618945"}, {"introduction": "Distortion measures are critical for assessing performance in systems where certain errors have severe consequences. This final exercise [@problem_id:1618910] models a safety-critical communication system involving traffic light states, where distortion is defined by a cost matrix. It powerfully illustrates how to quantify the risk associated with different types of transmission errors, particularly when one specific mistake is far more dangerous than all others.", "problem": "A remote monitoring system for an autonomous vehicle network transmits the state of a traffic light. The set of possible states (the source alphabet) is $\\mathcal{X} = \\{x_1, x_2, x_3\\}$, corresponding to {Red, Yellow, Green}. The long-term statistical observation of the traffic light indicates the following probabilities for each state: $P(x_1=\\text{Red}) = 0.45$, $P(x_2=\\text{Yellow}) = 0.10$, and $P(x_3=\\text{Green}) = 0.45$.\n\nThe state is transmitted over a noisy communication channel. The channel is symmetric, with a probability of correct transmission for any symbol being $1-p$, where $p=0.02$. If an error occurs (with probability $p$), the transmitted symbol is equally likely to be received as either of the other two symbols. The set of received symbols (the reconstruction alphabet) is $\\mathcal{Y} = \\{y_1, y_2, y_3\\}$, also corresponding to {Red, Yellow, Green}.\n\nTo quantify the impact of transmission errors, a distortion measure $d(x, y)$ is defined. The measure is based on dimensionless \"cost units\".\n- If a symbol is transmitted and received correctly (i.e., $x=y$), the distortion is 0.\n- Most incorrect transmissions (i.e., $x \\neq y$) are considered an inconvenience and are assigned a distortion of 1 cost unit.\n- However, the specific error where the state is 'Red' ($x_1$) but is received as 'Green' ($y_3$) is considered highly dangerous. This specific error is assigned a distortion of 10 cost units. All other types of errors, including 'Green' being received as 'Red', have a distortion of 1 cost unit.\n\nCalculate the average distortion for this communication system. Express your answer as a single real number, rounded to three significant figures.", "solution": "Let $X \\in \\mathcal{X}$ denote the transmitted symbol and $Y \\in \\mathcal{Y}$ the received symbol. The channel is symmetric with\n$$\nP(Y=y \\mid X=x)=\\begin{cases}\n1-p, & y=x,\\\\\n\\frac{p}{2}, & y \\neq x,\n\\end{cases}\n$$\nwhere $p=0.02$. The distortion measure satisfies $d(x,y)=0$ if $x=y$, $d(x_{1},y_{3})=10$, and for all other $x \\neq y$, $d(x,y)=1$.\n\nThe average distortion is\n$$\n\\mathbb{E}[d(X,Y)] = \\sum_{x \\in \\mathcal{X}} P_{X}(x) \\sum_{y \\in \\mathcal{Y}} P_{Y|X}(y \\mid x)\\, d(x,y).\n$$\n\nCompute the conditional expectations:\n- For $X=x_{1}$ (Red):\n$$\n\\mathbb{E}[d \\mid X=x_{1}] = \\frac{p}{2}\\cdot 1 + \\frac{p}{2}\\cdot 10 = \\frac{11}{2}p.\n$$\n- For $X=x_{2}$ (Yellow):\n$$\n\\mathbb{E}[d \\mid X=x_{2}] = \\frac{p}{2}\\cdot 1 + \\frac{p}{2}\\cdot 1 = p.\n$$\n- For $X=x_{3}$ (Green):\n$$\n\\mathbb{E}[d \\mid X=x_{3}] = \\frac{p}{2}\\cdot 1 + \\frac{p}{2}\\cdot 1 = p.\n$$\n\nWeighting by the source probabilities $P(x_{1})=0.45$, $P(x_{2})=0.10$, $P(x_{3})=0.45$,\n$$\n\\mathbb{E}[d(X,Y)] = 0.45 \\cdot \\frac{11}{2}p + 0.10 \\cdot p + 0.45 \\cdot p\n= p\\left( \\frac{11}{2} \\cdot 0.45 + 0.55 \\right).\n$$\nExpressing $0.45=\\frac{9}{20}$ and $0.55=\\frac{11}{20}$,\n$$\n\\mathbb{E}[d(X,Y)] = p \\left( \\frac{11}{2} \\cdot \\frac{9}{20} + \\frac{11}{20} \\right)\n= p \\left( \\frac{99}{40} + \\frac{22}{40} \\right)\n= p \\cdot \\frac{121}{40}.\n$$\n\nSubstituting $p=0.02=\\frac{1}{50}$ gives\n$$\n\\mathbb{E}[d(X,Y)] = \\frac{121}{40} \\cdot \\frac{1}{50} = \\frac{121}{2000} = 0.0605.\n$$\nRounded to three significant figures, this is $0.0605$.", "answer": "$$\\boxed{0.0605}$$", "id": "1618910"}]}