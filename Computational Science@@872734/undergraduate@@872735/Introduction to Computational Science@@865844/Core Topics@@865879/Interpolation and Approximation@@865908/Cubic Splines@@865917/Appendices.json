{"hands_on_practices": [{"introduction": "To appreciate the power of cubic splines, it's helpful to compare them with a simpler method. This first exercise challenges you to interpolate the same set of points using two different models: a basic piecewise linear function and a smooth natural cubic spline[@problem_id:2164998]. By calculating the interpolated value from both models, you will gain a direct, quantitative understanding of how a spline's guaranteed smoothness produces a different and often more physically plausible curve.", "problem": "An engineer is modeling the shape of a thin, flexible rod that is constrained to pass through three points in a 2D Cartesian plane: $P_0=(-1, 1)$, $P_1=(0, 0)$, and $P_2=(1, 1)$. Two simple models are proposed to estimate the rod's vertical position, $y$, at other horizontal locations, $x$.\n\nModel A is a piecewise linear interpolant, which connects the specified points with straight line segments.\nModel B is a natural cubic spline, which ensures the curve is smooth by matching first and second derivatives at the interior points, and has zero second derivatives at the endpoints.\n\nCalculate the vertical position of the rod at $x=0.5$ as predicted by both Model A and Model B. Let these values be $y_A$ and $y_B$, respectively. Present your answer as a pair of exact fractions $(y_A, y_B)$.", "solution": "We label the nodes as $x_{0}=-1$, $x_{1}=0$, $x_{2}=1$ with corresponding values $y_{0}=1$, $y_{1}=0$, $y_{2}=1$.\n\nModel A (piecewise linear interpolant): For $x \\in [x_{1},x_{2}]$, the line through $(0,0)$ and $(1,1)$ has slope\n$$\nm=\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}=\\frac{1-0}{1-0}=1,\n$$\nso the interpolant is\n$$\ny(x)=y_{1}+m(x-x_{1})=0+1\\cdot(x-0)=x.\n$$\nEvaluating at $x=\\frac{1}{2}$ gives\n$$\ny_{A}=y\\!\\left(\\frac{1}{2}\\right)=\\frac{1}{2}.\n$$\n\nModel B (natural cubic spline): Let $M_{i}=S''(x_{i})$. Natural end conditions give $M_{0}=0$ and $M_{2}=0$. With $h_{0}=x_{1}-x_{0}=1$ and $h_{1}=x_{2}-x_{1}=1$, the cubic spline system at the interior node $i=1$ is\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right).\n$$\nSubstituting the values,\n$$\n1\\cdot 0+2(1+1)M_{1}+1\\cdot 0=6\\left(\\frac{1-0}{1}-\\frac{0-1}{1}\\right)=6(1-(-1))=12,\n$$\nso\n$$\n4M_{1}=12 \\quad \\Rightarrow \\quad M_{1}=3.\n$$\nOn the interval $[x_{1},x_{2}]=[0,1]$, the spline is\n$$\nS(x)=\\frac{M_{1}}{6h_{1}}(x_{2}-x)^{3}+\\frac{M_{2}}{6h_{1}}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\nWith $h_{1}=1$, $M_{1}=3$, $M_{2}=0$, $y_{1}=0$, and $y_{2}=1$, this simplifies to\n$$\nS(x)=\\frac{3}{6}(1-x)^{3}+0+\\left(0-\\frac{3}{6}\\right)(1-x)+\\left(1-0\\right)x\n=\\frac{1}{2}(1-x)^{3}-\\frac{1}{2}(1-x)+x.\n$$\nExpanding and combining like terms,\n$$\nS(x)=\\frac{1}{2}-\\frac{3}{2}x+\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}-\\frac{1}{2}+\\frac{1}{2}x+x\n=\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}.\n$$\nEvaluating at $x=\\frac{1}{2}$ gives\n$$\ny_{B}=S\\!\\left(\\frac{1}{2}\\right)=\\frac{3}{2}\\left(\\frac{1}{2}\\right)^{2}-\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{3}\n=\\frac{3}{2}\\cdot\\frac{1}{4}-\\frac{1}{2}\\cdot\\frac{1}{8}\n=\\frac{3}{8}-\\frac{1}{16}\n=\\frac{5}{16}.\n$$\n\nThus, the required pair is $\\left(\\frac{1}{2},\\frac{5}{16}\\right)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{5}{16}\\end{pmatrix}}$$", "id": "2164998"}, {"introduction": "The construction of a cubic spline hinges on solving for its second derivatives at each data point, which represent the curve's curvature. This practice problem deepens your understanding of this crucial relationship by turning the standard calculation on its head[@problem_id:2164965]. Instead of using data points to find the curvature, you will use a known curvature value to solve for an unknown data point, reinforcing the connection between the geometry of the curve and the underlying algebraic equations.", "problem": "A natural cubic spline, denoted by $S(x)$, is used to interpolate a set of three data points: $(x_0, y_0) = (0, 0)$, $(x_1, y_1) = (1, y_1)$, and $(x_2, y_2) = (2, 0)$. The value of the ordinate $y_1$ is unknown. A cubic spline is a function that is piecewise-cubic and twice continuously differentiable. For a natural cubic spline, the second derivative at the endpoints is zero.\n\nIt is independently determined that the second derivative of this spline at the interior point $x_1=1$ is exactly $S''(1) = 6$. Using this information, determine the value of $y_1$.", "solution": "Let $x_{0}=0$, $x_{1}=1$, $x_{2}=2$ with $y_{0}=0$, $y_{1}$ unknown, and $y_{2}=0$. Denote $M_{i}=S''(x_{i})$. For a natural cubic spline, $M_{0}=0$ and $M_{2}=0$, and it is given that $M_{1}=6$.\n\nFor a cubic spline, the second derivatives at the knots satisfy the standard tridiagonal relation (obtained by enforcing $S'(x)$ continuity at interior knots):\n$$\nh_{0} M_{0} + 2\\left(h_{0}+h_{1}\\right) M_{1} + h_{1} M_{2}\n= 6\\left(\\frac{y_{2}-y_{1}}{h_{1}} - \\frac{y_{1}-y_{0}}{h_{0}}\\right),\n$$\nwhere $h_{i}=x_{i+1}-x_{i}$. Here $h_{0}=x_{1}-x_{0}=1$ and $h_{1}=x_{2}-x_{1}=1$, so the equation becomes\n$$\nM_{0} + 4 M_{1} + M_{2} = 6\\left((y_{2}-y_{1}) - (y_{1}-y_{0})\\right) = 6(y_{2} - 2 y_{1} + y_{0}).\n$$\nSubstituting $M_{0}=0$, $M_{1}=6$, $M_{2}=0$, $y_{0}=0$, and $y_{2}=0$, we obtain\n$$\n0 + 4\\cdot 6 + 0 = 6(0 - 2 y_{1} + 0),\n$$\nhence\n$$\n24 = -12 y_{1} \\quad \\Longrightarrow \\quad y_{1} = -2.\n$$", "answer": "$$\\boxed{-2}$$", "id": "2164965"}, {"introduction": "Moving from theory to application is a cornerstone of computational science, and this exercise guides you through building your own spline interpolation tool from the ground up. You will implement the complete algorithm for a natural cubic spline, from setting up the defining tridiagonal system of equations to solving it and evaluating the resulting polynomial[@problem_id:2384309]. This foundational practice will not only solidify your theoretical knowledge but also equip you with a practical, working code for interpolating real-world data.", "problem": "You are given one-dimensional data sampled at strictly increasing nodes. For a set of nodes $x_0 < x_1 < \\dots < x_n$ with corresponding values $y_0, y_1, \\dots, y_n$, consider the unique natural cubic spline $S(x)$ defined by the following properties: on each interval $[x_i, x_{i+1}]$ the function $S(x)$ is a cubic polynomial; the function $S(x)$ satisfies the interpolation conditions $S(x_i) = y_i$ for all $i$ with $0 \\le i \\le n$; the first derivative $S'(x)$ is continuous on $[x_0, x_n]$; the second derivative $S''(x)$ is continuous on $[x_0, x_n]$; and the natural boundary conditions $S''(x_0) = 0$ and $S''(x_n) = 0$ hold. Your task is to write a complete program that, for each test case below, constructs the unique natural cubic spline $S(x)$ for the provided data set and evaluates $S(x)$ at a specified query point $x_q$.\n\nAll inputs in the test suite are explicitly given below. Each test case is independent. In each case, use the provided arrays $x$ and $y$ as the exact data to construct $S(x)$, and then compute the scalar value $S(x_q)$. No external data sources are permitted or needed. All computations are purely numerical and dimensionless; no physical units apply.\n\nTest Suite (each item is a triple $(x, y, x_q)$ to be processed independently, in the given order):\n- Test case $1$: $x = [\\,0,\\,0.5,\\,1.7,\\,2.2,\\,3.0\\,]$, $y = [\\,0.0,\\,0.5,\\,1.8,\\,2.1,\\,1.2\\,]$, $x_q = 1.3$.\n- Test case $2$: $x = [\\,0,\\,0.5,\\,1.7,\\,2.2,\\,3.0\\,]$, $y = [\\,0.0,\\,0.5,\\,1.8,\\,2.1,\\,1.2\\,]$, $x_q = 0.0$.\n- Test case $3$: $x = [\\,0,\\,0.5,\\,1.7,\\,2.2,\\,3.0\\,]$, $y = [\\,0.0,\\,0.5,\\,1.8,\\,2.1,\\,1.2\\,]$, $x_q = 3.0$.\n- Test case $4$: $x = [\\,0,\\,0.5,\\,1.7,\\,2.2,\\,3.0\\,]$, $y = [\\,0.0,\\,0.5,\\,1.8,\\,2.1,\\,1.2\\,]$, $x_q = 2.2$.\n- Test case $5$: $x = [\\,-1.0,\\,2.0\\,]$, $y = [\\,-1.0,\\,4.0\\,]$, $x_q = 0.5$.\n\nYour program must compute $S(x_q)$ for each of the above $5$ cases, in order, and produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each number in the output list must be a floating-point value rounded to exactly $8$ decimal places. For example, the required output format is $[r_1,r_2,r_3,r_4,r_5]$ where each $r_i$ is $S(x_q)$ rounded to $8$ decimal places for test case $i$.", "solution": "The goal is to construct the unique natural cubic spline $S(x)$ from the given data $(x_i, y_i)$ with $0 \\le i \\le n$, where $x_0 < x_1 < \\dots < x_n$. By definition, $S(x)$ is piecewise cubic on each interval $[x_i, x_{i+1}]$, interpolates the data $S(x_i) = y_i$, and has continuous first and second derivatives on $[x_0, x_n]$, with the natural boundary conditions $S''(x_0) = 0$ and $S''(x_n) = 0$.\n\nA standard construction proceeds by introducing the unknown vector of second derivatives at the knots, denoted by $M_i = S''(x_i)$ for $0 \\le i \\le n$. The step sizes are $h_i = x_{i+1} - x_i$ for $0 \\le i \\le n-1$. For interior indices $i$ with $1 \\le i \\le n-1$, continuity of $S'(x)$ and $S''(x)$ across the knots leads to a linear system for the interior second derivatives $M_1, M_2, \\dots, M_{n-1}$:\n$$\nh_{i-1} M_{i-1} + 2(h_{i-1} + h_{i}) M_i + h_i M_{i+1} = 6\\left( \\frac{y_{i+1} - y_i}{h_i} - \\frac{y_i - y_{i-1}}{h_{i-1}} \\right),\n$$\nwith the natural boundary conditions $M_0 = 0$ and $M_n = 0$. For $n = 1$ (i.e., two nodes), there are no interior unknowns and the natural cubic spline reduces exactly to linear interpolation between the two points, which is consistent with $M_0 = 0$ and $M_1 = 0$.\n\nThe coefficient matrix of the system for $(M_1, \\dots, M_{n-1})$ is tridiagonal, with the following entries for $1 \\le i \\le n-1$:\n- Main diagonal: $b_i = 2(h_{i-1} + h_i)$.\n- Subdiagonal: $a_i = h_{i-1}$ for $i \\ge 2$.\n- Superdiagonal: $c_i = h_i$ for $i \\le n-2$.\nThe right-hand side is $d_i = 6\\left( \\frac{y_{i+1} - y_i}{h_i} - \\frac{y_i - y_{i-1}}{h_{i-1}} \\right)$.\n\nThis linear system is strictly diagonally dominant for strictly increasing $x_i$ with $h_i > 0$, ensuring a unique solution. An efficient and exact method to solve a tridiagonal linear system in $\\mathcal{O}(n)$ time consists of a forward elimination phase that eliminates subdiagonal entries followed by a backward substitution phase to recover the unknowns. Specifically, let the system be expressed in compact notation as\n$$\na_i M_{i-1} + b_i M_i + c_i M_{i+1} = d_i, \\quad \\text{for } i = 1, 2, \\dots, n-1,\n$$\nwith the conventions that $a_1 = 0$ and $c_{n-1} = 0$. The forward elimination step constructs modified diagonals and right-hand side:\nfor $i = 2, 3, \\dots, n-1$,\n$$\nw = \\frac{a_i}{b_{i-1}}, \\quad\nb_i \\leftarrow b_i - w c_{i-1}, \\quad\nd_i \\leftarrow d_i - w d_{i-1}.\n$$\nThe backward substitution then computes\n$$\nM_{n-1} = \\frac{d_{n-1}}{b_{n-1}}, \\quad\nM_i = \\frac{d_i - c_i M_{i+1}}{b_i} \\quad \\text{for } i = n-2, n-3, \\dots, 1.\n$$\nFinally, set $M_0 = 0$ and $M_n = 0$ to obtain the full vector $(M_0, M_1, \\dots, M_n)$.\n\nWith the second derivatives known, the spline on interval $[x_i, x_{i+1}]$ can be evaluated for any $x \\in [x_i, x_{i+1}]$ using the Hermite-like representation\n$$\nS(x) = A y_i + B y_{i+1} + \\frac{h_i^2}{6} \\left[ (A^3 - A) M_i + (B^3 - B) M_{i+1} \\right],\n$$\nwhere $h_i = x_{i+1} - x_i$, $A = \\frac{x_{i+1} - x}{h_i}$, and $B = \\frac{x - x_i}{h_i}$. This representation satisfies $S(x_i) = y_i$, $S(x_{i+1}) = y_{i+1}$, and the continuity conditions by construction. If $n = 1$, then $M_i = 0$ for all indices and the formula reduces to the linear interpolation $S(x) = A y_0 + B y_1$.\n\nTo evaluate $S(x_q)$, determine the interval $[x_i, x_{i+1}]$ such that $x_q \\in [x_i, x_{i+1}]$. If $x_q = x_n$, select the final interval $[x_{n-1}, x_n]$. Compute $A$, $B$, and then $S(x_q)$ via the above formula. Repeating this for each test case produces the required scalar outputs. Each result is finally rounded to exactly $8$ decimal places and emitted in a single bracketed, comma-separated list in the specified order.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef natural_cubic_spline_second_derivatives(x, y):\n    \"\"\"\n    Compute second derivatives M at knots for the natural cubic spline.\n    x: list or array of strictly increasing floats\n    y: list or array of floats of same length as x\n    Returns: list of M values (second derivatives) at each knot.\n    \"\"\"\n    n = len(x) - 1  # number of intervals\n    if n < 1:\n        raise ValueError(\"At least two data points are required.\")\n    if n == 1:\n        # Two nodes: linear interpolation, M = 0 at both ends.\n        return [0.0, 0.0]\n\n    h = [x[i+1] - x[i] for i in range(n)]\n    # Build tridiagonal system for M[1..n-1]\n    m = n - 1  # number of interior unknowns\n    a = [0.0] * m  # sub-diagonal (a[0] unused or zero)\n    b = [0.0] * m  # main diagonal\n    c = [0.0] * m  # super-diagonal (c[m-1] unused or zero)\n    d = [0.0] * m  # right-hand side\n\n    for i in range(m):\n        hi_prev = h[i] if i >= 0 else None\n        hi = h[i+1] if (i + 1) < n else None\n        # Using indices: interior i corresponds to global index i+1\n        if i == 0:\n            a[i] = 0.0\n        else:\n            a[i] = h[i]\n        if i == m - 1:\n            c[i] = 0.0\n        else:\n            c[i] = h[i+1]\n        b[i] = 2.0 * (h[i] + h[i+1])\n\n        # Right-hand side\n        yi_minus = y[i]\n        yi = y[i+1]\n        yi_plus = y[i+2]\n        d[i] = 6.0 * ((yi_plus - yi) / h[i+1] - (yi - yi_minus) / h[i])\n\n    # Thomas algorithm: forward elimination\n    for i in range(1, m):\n        if b[i-1] == 0.0:\n            raise ZeroDivisionError(\"Singular tridiagonal system encountered.\")\n        w = a[i] / b[i-1]\n        b[i] -= w * c[i-1]\n        d[i] -= w * d[i-1]\n\n    # Back substitution\n    M_interior = [0.0] * m\n    M_interior[-1] = d[-1] / b[-1]\n    for i in range(m - 2, -1, -1):\n        M_interior[i] = (d[i] - c[i] * M_interior[i + 1]) / b[i]\n\n    # Assemble full M with natural boundary conditions\n    M = [0.0] + M_interior + [0.0]\n    return M\n\ndef evaluate_natural_cubic_spline(x, y, M, xq):\n    \"\"\"\n    Evaluate the natural cubic spline defined by (x, y, M) at xq.\n    x: list of knots (strictly increasing)\n    y: list of values\n    M: list of second derivatives at knots\n    xq: query point within [x[0], x[-1]]\n    \"\"\"\n    n = len(x) - 1\n    if xq <= x[0]:\n        i = 0\n    elif xq >= x[-1]:\n        i = n - 1\n    else:\n        # Find right interval i such that x[i] <= xq <= x[i+1]\n        # Using binary search\n        left, right = 0, n\n        while left <= right:\n            mid = (left + right) // 2\n            if x[mid] <= xq:\n                left = mid + 1\n            else:\n                right = mid - 1\n        i = max(0, min(right, n - 1))\n\n    h = x[i+1] - x[i]\n    if h == 0.0:\n        raise ZeroDivisionError(\"Zero interval width encountered.\")\n    A = (x[i+1] - xq) / h\n    B = (xq - x[i]) / h\n    # S(x) formula using second derivatives M\n    term = ((A**3 - A) * M[i] + (B**3 - B) * M[i+1]) * (h**2) / 6.0\n    Sx = A * y[i] + B * y[i+1] + term\n    return Sx\n\ndef solve():\n    # Define the test cases from the problem statement.\n    xA = [0.0, 0.5, 1.7, 2.2, 3.0]\n    yA = [0.0, 0.5, 1.8, 2.1, 1.2]\n    test_cases = [\n        (xA, yA, 1.3),\n        (xA, yA, 0.0),\n        (xA, yA, 3.0),\n        (xA, yA, 2.2),\n        ([-1.0, 2.0], [-1.0, 4.0], 0.5),\n    ]\n\n    results = []\n    for x, y, xq in test_cases:\n        # Compute second derivatives for the dataset\n        M = natural_cubic_spline_second_derivatives(x, y)\n        # Evaluate spline at query point\n        val = evaluate_natural_cubic_spline(x, y, M, xq)\n        results.append(val)\n\n    # Final print statement in the exact required format: 8 decimal places, no spaces\n    formatted = \"[\" + \",\".join(f\"{r:.8f}\" for r in results) + \"]\"\n    print(formatted)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2384309"}]}