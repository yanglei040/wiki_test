{"hands_on_practices": [{"introduction": "The term 'implicit' can be intimidating, as it suggests we cannot directly solve for the next state, $y_{n+1}$. This first exercise demystifies the process by applying the implicit midpoint rule to a simple linear ordinary differential equation (ODE). Your goal is to see how, for this class of problems, the implicit formulation can be algebraically rearranged into an explicit formula for the next time step, providing a foundational understanding of how implicit solvers work under the hood [@problem_id:2178584].", "problem": "In computational physics, many problems require the numerical solution of Ordinary Differential Equations (ODEs). Consider a simplified model for the temperature, $y(t)$, of an electronic component over time. The rate of change of its temperature is described by the linear first-order ODE:\n$$ \\frac{dy}{dt} = ay + b $$\nwhere $y_n$ represents the known temperature at time $t_n$, and $a$ and $b$ are real constants determined by the component's physical properties and its environment.\n\nTo approximate the solution numerically, we can use an implicit method. One such method is the implicit midpoint rule, which calculates the state at the next time step, $y_{n+1} = y(t_n + h)$, using the formula:\n$$ y_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) $$\nHere, $h$ is the constant time step size, and $f(t,y)$ is the function defining the ODE, i.e., $f(t,y) = \\frac{dy}{dt}$.\n\nBy applying a single step of the implicit midpoint rule to the given ODE, derive an explicit analytical expression for $y_{n+1}$ in terms of $y_n$, $h$, $a$, and $b$.", "solution": "We start with the ODE $ \\frac{dy}{dt} = a y + b $ and apply the implicit midpoint rule\n$$\ny_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right).\n$$\nHere $f(t,y) = a y + b$ is autonomous (independent of $t$), so\n$$\nf\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) = a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b.\n$$\nSubstituting into the update formula gives\n$$\ny_{n+1} = y_n + h \\left[ a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b \\right].\n$$\nExpanding and collecting terms in $y_{n+1}$,\n$$\ny_{n+1} = y_n + \\frac{a h}{2} y_n + \\frac{a h}{2} y_{n+1} + h b,\n$$\nwhich implies\n$$\n\\left(1 - \\frac{a h}{2}\\right) y_{n+1} = \\left(1 + \\frac{a h}{2}\\right) y_n + h b.\n$$\nSolving for $y_{n+1}$ yields the explicit analytical expression\n$$\ny_{n+1} = \\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}}$$", "id": "2178584"}, {"introduction": "While linear ODEs allow for a direct algebraic solution as seen previously, most real-world systems, like population dynamics, are nonlinear. This practice explores what happens when we apply an implicit method—in this case, the Backward Euler method—to the nonlinear logistic growth equation. You will discover that this leads to a nonlinear algebraic equation that must be solved at each time step, illustrating the core computational cost and complexity inherent in using implicit schemes for more complex problems [@problem_id:2178610].", "problem": "In computational science, the logistic growth model is a common example for studying population dynamics. The model is described by the first-order Ordinary Differential Equation (ODE), $P'(t) = r P(t) \\left(1 - \\frac{P(t)}{K}\\right)$, where $P(t)$ is the population at time $t$, $r > 0$ is the intrinsic growth rate, and $K > 0$ is the environmental carrying capacity.\n\nTo numerically approximate the solution, we can use an implicit method like the Backward Euler method. We discretize time with a constant step size $h > 0$, letting $t_n = n h$. The numerical approximation of the population at time $t_n$ is denoted by $P_n$. The Backward Euler method for a general ODE of the form $y' = f(t, y)$ is given by the formula $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$.\n\nWhen this method is applied to the logistic equation, it results in a nonlinear algebraic equation for $P_{n+1}$ at each time step. Your task is to solve this equation to find an explicit formula for $P_{n+1}$ in terms of the known previous state $P_n$ and the parameters $h, r, K$. For a physically meaningful population model, we require that the population $P_{n+1}$ remains non-negative and that in the limit of a very small time step ($h \\rightarrow 0$), the next state should converge to the current state ($P_{n+1} \\rightarrow P_n$). Use this physical consideration to select the correct solution if more than one mathematical solution exists.", "solution": "We start from the logistic differential equation $P'(t) = r P(t)\\left(1 - \\frac{P(t)}{K}\\right)$ and apply the Backward Euler method, which for a general ODE $y' = f(t,y)$ is given by $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$. For the logistic equation, $f(t,y) = r y \\left(1 - \\frac{y}{K}\\right)$, so the Backward Euler update for $P_{n+1}$ is\n$$\nP_{n+1} = P_n + h r P_{n+1} \\left(1 - \\frac{P_{n+1}}{K}\\right).\n$$\nLet $X := P_{n+1}$. Rearranging gives\n$$\nX = P_n + h r X - \\frac{h r}{K} X^{2}.\n$$\nBring all terms to one side to obtain a quadratic equation in $X$:\n$$\n\\frac{h r}{K} X^{2} + (1 - h r) X - P_n = 0.\n$$\nMultiplying through by $K$ to simplify coefficients yields\n$$\nh r X^{2} + K (1 - h r) X - K P_n = 0.\n$$\nThis is a quadratic equation $a X^{2} + b X + c = 0$ with $a = h r$, $b = K (1 - h r)$, and $c = - K P_n$. By the quadratic formula,\n$$\nX = \\frac{ - b \\pm \\sqrt{ b^{2} - 4 a c } }{ 2 a } = \\frac{ - K (1 - h r) \\pm \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\nTo select the physically meaningful root, we impose the conditions that $P_{n+1} \\geq 0$ and that as $h \\to 0$, we have $P_{n+1} \\to P_n$. Consider the two branches:\n\n1) With the plus sign:\n$$\nX_{+} = \\frac{ - K (1 - h r) + \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\nFor small $h$, expand the square root using $\\sqrt{A^{2} + \\epsilon} \\approx A + \\frac{\\epsilon}{2 A}$ with $A = K (1 - h r)$ and $\\epsilon = 4 h r K P_n$. The numerator becomes approximately $-A + (A + \\epsilon/(2A)) = \\epsilon/(2A)$. Thus, the whole expression is approximately $\\frac{\\epsilon/(2A)}{2hr} = \\frac{\\epsilon}{4Ahr} = \\frac{4 h r K P_n}{4 K (1 - h r) h r} = \\frac{P_n}{1 - h r}$, which correctly approaches $P_n$ as $h \\to 0$. This satisfies the required limit. Moreover, for $P_n \\geq 0$, the radicand is at least $K^{2} (1 - h r)^{2}$, so the numerator is nonnegative and thus $X_{+} \\geq 0$.\n\n2) With the minus sign:\n$$\nX_{-} = \\frac{ - K (1 - h r) - \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\nAs $h \\to 0$, $X_{-} \\sim - \\frac{ K }{ h r } \\to - \\infty$, which violates both the nonnegativity and the continuity requirement $P_{n+1} \\to P_n$.\n\nTherefore, the correct physically meaningful solution is the plus branch. Writing it in a slightly factored form gives\n$$\nP_{n+1} = \\frac{K}{2 h r} \\left( - (1 - h r) + \\sqrt{ (1 - h r)^{2} + \\frac{ 4 h r }{ K } P_n } \\right).\n$$\nThis expression yields $P_{n+1} \\geq 0$ for $P_n \\geq 0$ and satisfies $P_{n+1} \\to P_n$ as $h \\to 0$, as required.", "answer": "$$\\boxed{\\frac{K}{2 h r}\\left(-\\left(1-h r\\right)+\\sqrt{\\left(1-h r\\right)^{2}+\\frac{4 h r}{K}P_{n}}\\right)}$$", "id": "2178610"}, {"introduction": "Having seen the algebraic complexity of implicit methods, it is natural to ask: why use them? This final practice provides a dramatic, quantitative answer by analyzing a classic stiff problem. By comparing the performance of a powerful explicit method (RK4) against a simple implicit one (Implicit Euler), you will see how stability requirements dictate usable time steps, and how this translates into a profound advantage in computational efficiency for implicit methods when solving stiff equations [@problem_id:3142647].", "problem": "Consider the scalar ordinary differential equation (ODE) $y'(t)=\\lambda\\,y(t)$ with constant $\\lambda=-10^{6}$, modeling a strongly damped linear dynamics. In numerical analysis of initial value problems, absolute stability is assessed using the linear test equation $y'=\\lambda y$ and the corresponding one-step amplification factor $R(z)$, where $z=\\lambda\\,\\Delta t$ and $\\Delta t>0$ is the time step. When $|R(z)|\\leq 1$ for a given $z$, the method is absolutely stable for that step size.\n\nYour tasks:\n- Using only the definition of the classical four-stage Runge–Kutta method (RK4), apply it to the test equation $y'=\\lambda y$ to obtain its amplification factor $R_{\\mathrm{RK4}}(z)$ as a polynomial in $z$. Then, restrict to real negative $z$ and determine the largest stable time step $\\Delta t_{\\max}$ for $\\lambda=-10^{6}$ by finding the intersection of the absolute stability boundary with the negative real axis. You may solve the resulting real polynomial equation numerically. Round $\\Delta t_{\\max}$ to three significant figures and express it in seconds.\n- Apply the implicit Euler method to $y'=\\lambda y$ and derive its amplification factor $R_{\\mathrm{IE}}(z)$. Use it to justify why choosing $\\Delta t=10^{-2}$ seconds is absolutely stable for $\\lambda<0$.\n- Suppose a computational science code has a measured per-step wall-clock cost of $c_{\\mathrm{RK4}}=2.0\\times 10^{-6}$ seconds for explicit RK4 and $c_{\\mathrm{IE}}=5.0\\times 10^{-5}$ seconds for implicit Euler (due to nonlinear solve overhead on this scalar problem). To integrate from $t=0$ to $t=1$ second using the respective stable step sizes (RK4 uses $\\Delta t_{\\max}$; implicit Euler uses $\\Delta t=10^{-2}$), compute the ratio of total wall-clock times $T_{\\mathrm{RK4}}/T_{\\mathrm{IE}}$. Round your final ratio to three significant figures. Express the speedup factor as a dimensionless number.\n\nProvide only the final ratio as your answer.", "solution": "The problem is well-posed and scientifically grounded in the numerical analysis of stiff ordinary differential equations. All necessary information is provided.\n\nThe analysis proceeds in three parts as requested.\n\nPart 1: Analysis of the classical four-stage Runge-Kutta (RK4) method.\nThe RK4 method for an initial value problem $y'(t) = f(t, y(t))$ is given by:\n$$ y_{n+1} = y_n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4) $$\nwhere the stages $k_i$ are defined as:\n$$ k_1 = f(t_n, y_n), \\quad k_2 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_1), \\quad k_3 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_2), \\quad k_4 = f(t_n + \\Delta t, y_n + \\Delta t k_3) $$\nTo find the amplification factor, we apply this method to the linear test equation $f(t,y) = \\lambda y$. Let $z = \\lambda \\Delta t$. The stages become:\n$$ k_1 = \\lambda y_n $$\n$$ k_2 = \\lambda(y_n + \\frac{\\Delta t}{2} k_1) = \\lambda y_n (1 + \\frac{z}{2}) $$\n$$ k_3 = \\lambda(y_n + \\frac{\\Delta t}{2} k_2) = \\lambda y_n (1 + \\frac{z}{2} + \\frac{z^2}{4}) $$\n$$ k_4 = \\lambda(y_n + \\Delta t k_3) = \\lambda y_n (1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}) $$\nSubstituting these into the update formula and factoring out $y_n$ gives $y_{n+1} = R_{\\mathrm{RK4}}(z) y_n$, where:\n$$ R_{\\mathrm{RK4}}(z) = 1 + \\frac{z}{6} \\left[ 1 + 2\\left(1 + \\frac{z}{2}\\right) + 2\\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) + \\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right) \\right] $$\nSimplifying the term in the square brackets gives $6 + 3z + z^2 + z^3/4$. Substituting this back yields the amplification factor:\n$$ R_{\\mathrm{RK4}}(z) = 1 + \\frac{z}{6}\\left(6 + 3z + z^2 + \\frac{z^3}{4}\\right) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} $$\nThis polynomial is the truncation of the Taylor series for $\\exp(z)$ after the $z^4$ term.\n\nAbsolute stability requires $|R(z)| \\le 1$. For this problem, $\\lambda = -10^6 < 0$, so $z = \\lambda \\Delta t$ is real and negative. Let $z = -x$ for some $x > 0$. The condition is $|R_{\\mathrm{RK4}}(-x)| \\le 1$. A plot of $R_{\\mathrm{RK4}}(-x)$ for $x > 0$ shows that it starts at 1, decreases to a minimum, and then increases, crossing $y=1$ before it reaches $y=-1$. Thus, the stability limit is determined by the first non-zero root of $R_{\\mathrm{RK4}}(-x) = 1$.\n$$ 1 - x + \\frac{x^2}{2} - \\frac{x^3}{6} + \\frac{x^4}{24} = 1 \\implies -x\\left(1 - \\frac{x}{2} + \\frac{x^2}{6} - \\frac{x^3}{24}\\right) = 0 $$\nThe non-zero root satisfies $x^3 - 4x^2 + 12x - 24 = 0$. Solving this polynomial numerically gives $x_0 \\approx 2.78528$.\nThe stability interval on the negative real axis is approximately $[-2.785, 0]$. The maximum stable step size $\\Delta t_{\\max}$ is given by $|\\lambda \\Delta t_{\\max}| = x_0$.\n$$ |(-10^6) \\Delta t_{\\max}| \\approx 2.78528 \\implies \\Delta t_{\\max} \\approx \\frac{2.78528}{10^6} \\text{ s} \\approx 2.78528 \\times 10^{-6} \\text{ s} $$\nRounding to three significant figures, $\\Delta t_{\\max} \\approx 2.79 \\times 10^{-6}$ seconds.\n\nPart 2: Analysis of the Implicit Euler method.\nThe implicit Euler method for $y' = \\lambda y$ is:\n$$ y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1}) $$\nSolving for $y_{n+1}$:\n$$ y_{n+1}(1 - \\lambda \\Delta t) = y_n \\implies \\frac{y_{n+1}}{y_n} = \\frac{1}{1 - \\lambda \\Delta t} $$\nThe amplification factor is $R_{\\mathrm{IE}}(z) = \\frac{1}{1-z}$. For absolute stability, we require $|R_{\\mathrm{IE}}(z)| \\le 1$. For $\\lambda < 0$, $z = \\lambda \\Delta t$ is real and negative.\n$$ \\left|\\frac{1}{1-z}\\right| \\le 1 $$\nSince $z < 0$, $1-z > 1$. The expression $\\frac{1}{1-z}$ is positive and less than $1$. Thus, the inequality is always satisfied for any $z < 0$.\nThis means the implicit Euler method is absolutely stable for any negative real $\\lambda$ and any step size $\\Delta t > 0$. This property is known as A-stability. Therefore, choosing a step size of $\\Delta t = 10^{-2}$ seconds is absolutely stable for $\\lambda = -10^6$.\n\nPart 3: Comparison of wall-clock times.\nThe total time to integrate from $t=0$ to $t=1$ second is given by the number of steps multiplied by the cost per step, $T = N \\times c = (\\frac{T_{\\text{end}} - T_{\\text{start}}}{\\Delta t}) \\times c$.\n\nFor RK4:\nThe method is conditionally stable, requiring $\\Delta t_{\\mathrm{RK4}} = \\Delta t_{\\max} \\approx 2.78528 \\times 10^{-6}$ s.\nThe cost per step is $c_{\\mathrm{RK4}} = 2.0 \\times 10^{-6}$ s.\nThe total wall-clock time is:\n$$ T_{\\mathrm{RK4}} = \\frac{1 \\text{ s}}{\\Delta t_{\\mathrm{RK4}}} \\times c_{\\mathrm{RK4}} = \\frac{1}{2.78528 \\times 10^{-6}} \\times (2.0 \\times 10^{-6}) \\text{ s} = \\frac{2.0}{2.78528} \\text{ s} $$\n\nFor Implicit Euler:\nThe method is unconditionally stable, so the larger step size $\\Delta t_{\\mathrm{IE}} = 10^{-2}$ s is permissible.\nThe cost per step is $c_{\\mathrm{IE}} = 5.0 \\times 10^{-5}$ s.\nThe total wall-clock time is:\n$$ T_{\\mathrm{IE}} = \\frac{1 \\text{ s}}{\\Delta t_{\\mathrm{IE}}} \\times c_{\\mathrm{IE}} = \\frac{1}{10^{-2}} \\times (5.0 \\times 10^{-5}) \\text{ s} = 100 \\times 5.0 \\times 10^{-5} \\text{ s} = 5.0 \\times 10^{-3} \\text{ s} $$\n\nThe ratio of total wall-clock times is:\n$$ \\frac{T_{\\mathrm{RK4}}}{T_{\\mathrm{IE}}} = \\frac{2.0 / 2.78528}{5.0 \\times 10^{-3}} = \\frac{0.718085}{0.005} \\approx 143.617 $$\nRounding the final ratio to three significant figures, we get $144$. This indicates that for this stiff problem, the implicit method is approximately $144$ times faster than the explicit method, despite being much more expensive per step, due to the vastly larger stable step size it allows.", "answer": "$$\\boxed{144}$$", "id": "3142647"}]}