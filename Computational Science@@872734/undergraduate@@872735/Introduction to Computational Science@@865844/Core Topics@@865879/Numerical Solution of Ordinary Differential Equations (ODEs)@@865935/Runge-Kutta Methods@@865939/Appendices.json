{"hands_on_practices": [{"introduction": "This first practice is designed to build your fundamental skills with the classical fourth-order Runge-Kutta (RK4) method. By working through a single step for a simple differential equation, you will master the core computational mechanics of evaluating the intermediate slopes ($k_1, k_2, k_3, k_4$) and combining them to achieve a highly accurate approximation. This hands-on calculation is the essential first step toward applying RK4 to more complex scientific problems [@problem_id:2197363].", "problem": "Consider the initial value problem defined by the differential equation $y' = \\frac{x}{y}$ with the initial condition $y(1) = 2$.\n\nYour task is to approximate the value of $y(1.1)$ by applying a single step of the fourth-order Runge-Kutta (RK4) method. For a differential equation $y' = f(x, y)$ and a step size $h$, the RK4 method computes the next value $y_{n+1}$ from the current value $y_n$ using the following formulas:\n\n$$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$\n\nwhere\n\n$$k_1 = f(x_n, y_n)$$\n$$k_2 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1)$$\n$$k_3 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2)$$\n$$k_4 = f(x_n + h, y_n + h k_3)$$\n\nCalculate the numerical approximation for $y(1.1)$ and round your final answer to five significant figures.", "solution": "The problem asks for a single-step approximation of $y(1.1)$ for the ordinary differential equation $y' = \\frac{x}{y}$ with the initial condition $y(1) = 2$, using the fourth-order Runge-Kutta (RK4) method.\n\nFirst, we identify the components needed for the RK4 formula.\nThe function is $f(x, y) = \\frac{x}{y}$.\nThe initial point is $(x_0, y_0) = (1, 2)$.\nWe want to find the value of $y$ at $x_1 = 1.1$. This means we are taking a single step of size $h = x_1 - x_0 = 1.1 - 1.0 = 0.1$.\n\nNow, we compute the four intermediate slopes, $k_1, k_2, k_3, k_4$.\n\nStep 1: Calculate $k_1$.\n$k_1 = f(x_0, y_0) = f(1, 2) = \\frac{1}{2} = 0.5$.\n\nStep 2: Calculate $k_2$.\nThe evaluation point for $k_2$ is $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_1)$.\n$x_0 + \\frac{h}{2} = 1 + \\frac{0.1}{2} = 1.05$.\n$y_0 + \\frac{h}{2}k_1 = 2 + \\frac{0.1}{2}(0.5) = 2 + 0.05(0.5) = 2 + 0.025 = 2.025$.\nSo, $k_2 = f(1.05, 2.025) = \\frac{1.05}{2.025}$.\nThis fraction is $\\frac{1050}{2025} = \\frac{42 \\times 25}{81 \\times 25} = \\frac{42}{81} = \\frac{14}{27}$.\nAs a decimal, $k_2 \\approx 0.5185185185...$.\n\nStep 3: Calculate $k_3$.\nThe evaluation point for $k_3$ is $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_2)$.\nThe x-coordinate is the same as for $k_2$: $1.05$.\n$y_0 + \\frac{h}{2}k_2 = 2 + \\frac{0.1}{2} \\left(\\frac{14}{27}\\right) = 2 + 0.05 \\left(\\frac{14}{27}\\right) = 2 + \\frac{1}{20}\\frac{14}{27} = 2 + \\frac{7}{270} = \\frac{540+7}{270} = \\frac{547}{270}$.\nSo, $k_3 = f\\left(1.05, \\frac{547}{270}\\right) = \\frac{1.05}{547/270} = \\frac{21/20}{547/270} = \\frac{21}{20} \\cdot \\frac{270}{547} = \\frac{21 \\cdot 27}{2 \\cdot 547} = \\frac{567}{1094}$.\nAs a decimal, $k_3 \\approx 0.5182815356...$.\n\nStep 4: Calculate $k_4$.\nThe evaluation point for $k_4$ is $(x_0 + h, y_0 + h k_3)$.\n$x_0 + h = 1 + 0.1 = 1.1$.\n$y_0 + h k_3 = 2 + 0.1 \\left(\\frac{567}{1094}\\right) = 2 + \\frac{567}{10940} = \\frac{21880+567}{10940} = \\frac{22447}{10940}$.\nSo, $k_4 = f\\left(1.1, \\frac{22447}{10940}\\right) = \\frac{1.1}{22447/10940} = \\frac{11/10}{22447/10940} = \\frac{11}{10} \\cdot \\frac{10940}{22447} = \\frac{11 \\cdot 1094}{22447} = \\frac{12034}{22447}$.\nAs a decimal, $k_4 \\approx 0.536107275...$.\n\nStep 5: Calculate the final approximation $y_1$.\n$y_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$.\nUsing the decimal approximations for clarity (while retaining high precision in calculation):\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 2(0.5185185185) + 2(0.5182815356) + 0.536107275)$.\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 1.037037037 + 1.0365630712 + 0.536107275)$.\n$y_1 \\approx 2 + \\frac{0.1}{6}(3.1097073832)$.\n$y_1 \\approx 2 + 0.05182845638...$.\n$y_1 \\approx 2.05182845638...$.\n\nFinally, we round the result to five significant figures. The first five significant figures are 2, 0, 5, 1, 8. The next digit is 2, which is less than 5, so we round down (i.e., we don't change the last digit).\n$y(1.1) \\approx 2.0518$.", "answer": "$$\\boxed{2.0518}$$", "id": "2197363"}, {"introduction": "Real-world systems are rarely described by a single equation; more often, we encounter interconnected systems of differential equations. This exercise extends the Runge-Kutta concept to vector form, a technique essential for modeling everything from predator-prey dynamics to the motion of celestial bodies. By applying the Midpoint method (a second-order RK method) to an idealized oscillator, you will see how to simultaneously advance multiple variables in time [@problem_id:2197355].", "problem": "Consider a system of first-order ordinary differential equations used to model an idealized, undamped oscillator:\n$$\n\\frac{dx}{dt} = -y\n$$\n$$\n\\frac{dy}{dt} = x\n$$\nThe state of the system at time $t=0$ is given by the initial conditions $x(0) = 2$ and $y(0) = 0$.\n\nWe wish to find an approximate solution for the state of the system at a later time using a numerical method. Specifically, we will use the second-order Runge-Kutta method known as the Midpoint method. For a general vector ordinary differential equation $\\frac{d\\vec{u}}{dt} = \\vec{f}(t, \\vec{u})$, the formula for one step of the Midpoint method from time $t_n$ to $t_{n+1} = t_n + h$ is given by:\n$$\n\\vec{k}_1 = \\vec{f}(t_n, \\vec{u}_n)\n$$\n$$\n\\vec{k}_2 = \\vec{f}\\left(t_n + \\frac{h}{2}, \\vec{u}_n + \\frac{h}{2}\\vec{k}_1\\right)\n$$\n$$\n\\vec{u}_{n+1} = \\vec{u}_n + h \\vec{k}_2\n$$\n\nUsing a single step of this Midpoint method with a step size of $h=0.1$, calculate the approximate values for $x(0.1)$ and $y(0.1)$. Your answer should be the pair of numerical values for the approximation of $x(0.1)$ and $y(0.1)$, in that order.", "solution": "We rewrite the system in vector form by defining $\\vec{u}(t)=\\begin{pmatrix}x(t) \\\\ y(t)\\end{pmatrix}$ and $\\vec{f}(t,\\vec{u})=\\begin{pmatrix}-y \\\\ x\\end{pmatrix}$. The Midpoint method with step size $h$ computes\n$$\n\\vec{k}_{1}=\\vec{f}(t_{0},\\vec{u}_{0}), \\quad\n\\vec{k}_{2}=\\vec{f}\\!\\left(t_{0}+\\frac{h}{2},\\ \\vec{u}_{0}+\\frac{h}{2}\\vec{k}_{1}\\right), \\quad\n\\vec{u}_{1}=\\vec{u}_{0}+h\\,\\vec{k}_{2}.\n$$\nGiven $t_{0}=0$, $\\vec{u}_{0}=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}$, and $h=0.1$, we compute\n$$\n\\vec{k}_{1}=\\vec{f}(0,\\vec{u}_{0})=\\begin{pmatrix}-y(0) \\\\ x(0)\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 2\\end{pmatrix}.\n$$\nThe midpoint state is\n$$\n\\vec{u}_{0}+\\frac{h}{2}\\vec{k}_{1}\n=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}\n+0.05\\begin{pmatrix}0 \\\\ 2\\end{pmatrix}\n=\\begin{pmatrix}2 \\\\ 0.1\\end{pmatrix}.\n$$\nThen\n$$\n\\vec{k}_{2}=\\vec{f}\\!\\left(0.05,\\begin{pmatrix}2 \\\\ 0.1\\end{pmatrix}\\right)\n=\\begin{pmatrix}-0.1 \\\\ 2\\end{pmatrix}.\n$$\nFinally,\n$$\n\\vec{u}_{1}=\\vec{u}_{0}+h\\,\\vec{k}_{2}\n=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}\n+0.1\\begin{pmatrix}-0.1 \\\\ 2\\end{pmatrix}\n=\\begin{pmatrix}2-0.01 \\\\ 0.2\\end{pmatrix}\n=\\begin{pmatrix}1.99 \\\\ 0.2\\end{pmatrix}.\n$$\nTherefore, the Midpoint method approximation after one step with $h=0.1$ gives $x(0.1)\\approx 1.99$ and $y(0.1)\\approx 0.2$.", "answer": "$$\\boxed{\\begin{pmatrix}1.99 & 0.2\\end{pmatrix}}$$", "id": "2197355"}, {"introduction": "A powerful numerical method can produce dramatically wrong results if not used carefully. This final practice explores the crucial concept of numerical stability, a cornerstone of computational science. By analyzing a model for Newton's law of cooling, you will determine the maximum allowable time step to prevent the numerical solution from becoming unstable and diverging from the true physical behavior, a vital skill for any computational practitioner [@problem_id:2197380].", "problem": "A small metallic sphere is initially at a temperature of $T_0$. It is plunged into a large coolant bath held at a constant temperature $T_{env}$. The temperature difference, $\\Delta T(t) = T(t) - T_{env}$, is governed by Newton's law of cooling, which for this system is described by the ordinary differential equation (ODE):\n$$ \\frac{d(\\Delta T)}{dt} = -k \\Delta T $$\nwhere the cooling constant is $k = 50.0 \\text{ s}^{-1}$. You are tasked with numerically simulating the cooling process using the classical fourth-order Runge-Kutta (RK4) method. To ensure the numerical solution does not exhibit spurious, growing oscillations (i.e., to ensure absolute stability), the time step $h$ must be chosen carefully. Determine the largest possible time step $h_{max}$ that can be used while maintaining absolute stability for this simulation. Express your answer for $h_{max}$ in units of seconds, rounded to three significant figures.", "solution": "We rewrite the ODE for the temperature difference as a linear test equation. Let $y(t) = \\Delta T(t)$. Then the ODE becomes the standard test equation:\n$$\n\\frac{dy}{dt} = \\lambda y,\n$$\nwhere for this problem we have $\\lambda = -k = -50.0$.\n\nFor a Runge-Kutta method applied to this test equation with a step size $h$, the numerical update is given by $y_{n+1} = R(z) y_{n}$, where $z = h\\lambda$ and $R(z)$ is the method's stability function. For the classical fourth-order Runge-Kutta method, the stability function is the degree-4 Taylor polynomial of the exponential function:\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}.\n$$\nAbsolute stability requires that the amplification factor $R(z)$ does not grow in magnitude, i.e., $|R(z)| \\leq 1$. Since our $\\lambda$ is real and negative, $z = -kh$ is also real and negative. The condition thus becomes $-1 \\leq R(z) \\leq 1$. The stability interval on the negative real axis is of the form $[z_*, 0]$, where $z_*$ is the first negative value for which $|R(z_*)| > 1$. This occurs when $R(z_*)$ crosses below $-1$. Therefore, the boundary of the stability region is found by solving the equation:\n$$ R(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24} = -1 $$\nThis equation does not have a simple analytical solution and must be solved numerically. The relevant root is a well-known value for the RK4 method:\n$$ z_{\\ast} \\approx -2.785 $$\nThe stability condition is $z \\ge z_*$, which translates to $h\\lambda \\ge z_*$. Since $\\lambda$ is negative, this inequality becomes:\n$$ h \\le \\frac{z_*}{\\lambda} = \\frac{|z_*|}{|\\lambda|} = \\frac{|z_*|}{k} $$\nTherefore, the largest time step that maintains absolute stability is:\n$$\nh_{\\max} = \\frac{|z_{\\ast}|}{k}.\n$$\nWith $k = 50.0\\,\\text{s}^{-1}$, this gives:\n$$\nh_{\\max} \\approx \\frac{2.785}{50.0} = 0.0557\\ \\text{s}.\n$$\nRounding to three significant figures as required, the maximum stable step size is $0.0557$ seconds.", "answer": "$$\\boxed{0.0557}$$", "id": "2197380"}]}