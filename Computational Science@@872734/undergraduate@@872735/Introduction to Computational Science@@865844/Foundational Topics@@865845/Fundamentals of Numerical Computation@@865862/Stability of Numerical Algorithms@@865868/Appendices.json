{"hands_on_practices": [{"introduction": "One of the most common pitfalls in numerical computing is the direct translation of a mathematical formula into code without considering the effects of finite-precision arithmetic. This practice explores a classic example of \"catastrophic cancellation,\" where subtracting two very large, nearly equal numbers can erase most of your significant digits, leading to a result dominated by error. By working through this problem [@problem_id:2205457], you will learn a fundamental technique: reformulating an expression algebraically to avoid this precision-destroying subtraction, a crucial skill for writing robust scientific code.", "problem": "Consider the function $f(x) = \\sqrt{x+1} - \\sqrt{x}$. For very large, positive values of $x$, computing $f(x)$ directly using standard floating-point arithmetic can lead to a significant loss of precision due to the subtraction of two nearly equal numbers. Your task is to first find an algebraically equivalent expression for $f(x)$ that is more numerically stable for large $x$ because it avoids this subtraction. Then, use this improved expression to calculate the value of $f(x)$ for $x = 4 \\times 10^{16}$.\n\nExpress your answer as a real number in scientific notation of the form $a \\times 10^b$, rounded to three significant figures.", "solution": "We want to avoid catastrophic cancellation in $f(x) = \\sqrt{x+1} - \\sqrt{x}$ for large positive $x$. Multiply numerator and denominator by the conjugate to get an algebraically equivalent form:\n$$\nf(x) = \\left(\\sqrt{x+1} - \\sqrt{x}\\right)\\frac{\\sqrt{x+1} + \\sqrt{x}}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{(x+1) - x}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}}.\n$$\nThis expression avoids subtracting two nearly equal large numbers and is therefore more numerically stable.\n\nFor $x = 4 \\times 10^{16}$, compute using the stable form:\n$$\nf(4 \\times 10^{16}) = \\frac{1}{\\sqrt{4 \\times 10^{16} + 1} + \\sqrt{4 \\times 10^{16}}}.\n$$\nNote that $\\sqrt{4 \\times 10^{16}} = 2 \\times 10^{8}$. Also,\n$$\n\\sqrt{4 \\times 10^{16} + 1} = 2 \\times 10^{8}\\sqrt{1 + \\frac{1}{4 \\times 10^{16}}}.\n$$\nLet $\\epsilon = \\frac{1}{4 \\times 10^{16}}$. Using the binomial expansion $\\sqrt{1+\\epsilon} = 1 + \\frac{\\epsilon}{2} - \\frac{\\epsilon^{2}}{8} + \\cdots$, we have\n$$\n\\sqrt{4 \\times 10^{16} + 1} = 2 \\times 10^{8}\\left(1 + \\frac{\\epsilon}{2} - \\frac{\\epsilon^{2}}{8} + \\cdots \\right) = 2 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2}).\n$$\nThus the denominator is\n$$\n\\sqrt{4 \\times 10^{16} + 1} + \\sqrt{4 \\times 10^{16}} = 4 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2}).\n$$\nTherefore,\n$$\nf(4 \\times 10^{16}) = \\frac{1}{4 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2})} = \\frac{1}{4 \\times 10^{8}}\\left(1 - \\frac{10^{8}\\epsilon}{4 \\times 10^{8}} + O(\\epsilon^{2})\\right).\n$$\nSince $\\epsilon = 2.5 \\times 10^{-17}$, the leading term is\n$$\n\\frac{1}{4 \\times 10^{8}} = 2.5 \\times 10^{-9},\n$$\nand the correction is of order $10^{-26}$, which does not affect rounding to three significant figures. Hence, to three significant figures,\n$$\nf(4 \\times 10^{16}) \\approx 2.50 \\times 10^{-9}.\n$$", "answer": "$$\\boxed{2.50 \\times 10^{-9}}$$", "id": "2205457"}, {"introduction": "Often in programming, we face a choice between several algorithms that are mathematically equivalent. However, this equivalence can be deceptive, as they may behave very differently on a computer. This exercise [@problem_id:2205412] provides a stark illustration of this principle by comparing two ways to calculate $\\sin^2(x)$. By simulating the computation on a machine with limited precision, you will see firsthand how an unstable algorithm, which involves the subtraction of two numbers close to one, can lead to a significant loss of accuracy, while a direct computation remains robust.", "problem": "In scientific computing, the same mathematical expression can often be computed in multiple ways, with some algorithms being more numerically stable than others. Consider the calculation of the function $f(x) = \\sin^2(x)$ for small values of $x$.\n\nA programmer is tasked with implementing this function and considers two approaches:\n- **Method A**: Directly compute $(\\sin(x))^2$.\n- **Method B**: Use the trigonometric identity $\\sin^2(x) + \\cos^2(x) = 1$ to compute $1 - (\\cos(x))^2$.\n\nThe computation is performed on a hypothetical decimal machine where floating-point numbers are stored with 7 significant digits of precision. Any result of an operation or a function call is rounded to 7 significant digits before being used in a subsequent calculation. Let's denote this rounding operation as $\\text{fl}(z)$, which rounds the real number $z$ to 7 significant decimal digits (e.g., $\\text{fl}(12.3456789) = 12.34568$ and $\\text{fl}(0.00987654321) = 0.009876543$).\n\nYour task is to analyze the numerical error of Method B for the input value $x = 1.5 \\times 10^{-3}$ radians. Calculate the relative error of the computed value from Method B, which is defined as $\\left| \\frac{\\text{Computed Value} - \\text{True Value}}{\\text{True Value}} \\right|$.\n\nFor the \"True Value\", you should use a high-precision calculation of $\\sin^2(1.5 \\times 10^{-3})$. Round your final answer for the relative error to three significant figures.", "solution": "We analyze Method B, which computes $1-\\cos^{2}(x)$, with the model that after every function call or arithmetic operation the result is rounded to $7$ significant decimal digits by $\\mathrm{fl}(\\cdot)$.\n\nGiven $x=1.5\\times 10^{-3}$, first compute a high-precision reference for the true value:\nUsing $\\sin^{2}(x)=\\frac{1-\\cos(2x)}{2}$ and the Taylor series for $\\cos(2x)$, or equivalently the known expansion\n$$\n\\sin^{2}(x)=x^{2}-\\frac{x^{4}}{3}+\\frac{2x^{6}}{45}-\\frac{x^{8}}{315}+\\cdots,\n$$\nwith $x=1.5\\times 10^{-3}$, we have\n$$\nx^{2}=2.25\\times 10^{-6},\\quad x^{4}=5.0625\\times 10^{-12},\\quad x^{6}=1.1390625\\times 10^{-17},\\quad x^{8}=2.562890625\\times 10^{-23}.\n$$\nThus\n$$\n\\sin^{2}(x)=2.25\\times 10^{-6}-\\frac{5.0625\\times 10^{-12}}{3}+\\frac{2\\cdot 1.1390625\\times 10^{-17}}{45}-\\frac{2.562890625\\times 10^{-23}}{315}+\\cdots.\n$$\nCompute the leading terms:\n$$\n\\frac{5.0625\\times 10^{-12}}{3}=1.6875\\times 10^{-12},\\quad \\frac{2\\cdot 1.1390625\\times 10^{-17}}{45}=5.0625\\times 10^{-19},\\quad \\frac{2.562890625\\times 10^{-23}}{315}\\approx 8.14\\times 10^{-26}.\n$$\nTherefore, to very high precision, the true value is\n$$\nT=\\sin^{2}(1.5\\times 10^{-3})\\approx 2.2499983125\\times 10^{-6}+5.0625\\times 10^{-19}-8.14\\times 10^{-26}\\approx 2.2499983125\\times 10^{-6}.\n$$\n\nNow simulate Method B with rounding after each step:\n1) Compute $\\cos(x)$ in high precision using $\\cos(x)=1-\\frac{x^{2}}{2}+\\frac{x^{4}}{24}-\\frac{x^{6}}{720}+\\cdots$:\n$$\n\\cos(x)=1-1.125\\times 10^{-6}+2.109375\\times 10^{-13}-1.58203125\\times 10^{-20}+\\cdots,\n$$\nso\n$$\n\\cos(x)\\approx 0.999998875000210937\\ldots\n$$\nRound to $7$ significant digits:\n$$\n\\mathrm{fl}(\\cos(x))=0.9999989.\n$$\n\n2) Square and round:\n$$\n(\\mathrm{fl}(\\cos(x)))^{2}=(0.9999989)^{2}=(1-1.1\\times 10^{-6})^{2}=1-2.2\\times 10^{-6}+1.21\\times 10^{-12}=0.99999780000121.\n$$\nRound to $7$ significant digits:\n$$\n\\mathrm{fl}\\big((\\mathrm{fl}(\\cos(x)))^{2}\\big)=0.9999978.\n$$\n\n3) Subtract from $1$ and round:\n$$\n\\mathrm{fl}\\big(1-\\mathrm{fl}((\\mathrm{fl}(\\cos(x)))^{2})\\big)=\\mathrm{fl}(1-0.9999978)=\\mathrm{fl}(2.2\\times 10^{-6})=2.2\\times 10^{-6}.\n$$\nThus the Method B computed value is\n$$\nC=2.2\\times 10^{-6}.\n$$\n\nCompute the relative error:\n$$\n\\text{RelErr}=\\left|\\frac{C-T}{T}\\right|=\\frac{|2.2\\times 10^{-6}-2.2499983125\\times 10^{-6}|}{2.2499983125\\times 10^{-6}}\n=\\frac{4.99983125\\times 10^{-8}}{2.2499983125\\times 10^{-6}}.\n$$\nDivide numerator and denominator by $10^{-6}$:\n$$\n\\text{RelErr}=\\frac{0.0499983125}{2.2499983125}\\approx 0.0222214889.\n$$\nRounded to three significant figures, the relative error is $2.22\\times 10^{-2}$.", "answer": "$$\\boxed{2.22 \\times 10^{-2}}$$", "id": "2205412"}, {"introduction": "We now move from single calculations to the stability of methods that evolve a system over time, which is at the heart of scientific simulation. This problem [@problem_id:2205446] examines the explicit Euler method, a simple and intuitive way to solve ordinary differential equations. You will discover that the stability of this method is not guaranteed; it depends critically on the size of the time step, $h$. By using a step size that is just slightly too large, you will witness how the numerical solution can diverge from physical reality, producing explosive, oscillating results that are the hallmark of numerical instability.", "problem": "A scientist is modeling the concentration of a chemical reactant, $C(t)$, in a simple first-order reaction. The rate of change of the reactant's concentration is directly proportional to the concentration itself, following the differential equation:\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\nThe rate constant is given as $k = 50.0 \\text{ s}^{-1}$, and the initial concentration at time $t=0$ is $C(0) = 100.0 \\text{ mol/L}$.\n\nTo predict the concentration at future times, the scientist employs a numerical scheme using a fixed time step, $h$. This method approximates the concentration at time $t_{n+1} = (n+1)h$ using the value at the previous time step, $t_n = nh$, according to the explicit Euler update rule:\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)_{t=t_n}\n$$\nThe scientist decides to use a time step of $h = 0.0410 \\text{ s}$. Calculate the numerical value of the concentration, $C_3$, predicted by this method after three time steps. Express your answer in mol/L, rounded to three significant figures.", "solution": "We are given the first-order linear ODE $\\frac{dC}{dt}=-kC(t)$ and the explicit Euler update\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)_{t=t_{n}}=C_{n}+h(-kC_{n})=(1-kh)C_{n}.\n$$\nBy recursion, this yields\n$$\nC_{n}=C_{0}(1-kh)^{n}.\n$$\nWith $C_{0}=100.0$, $k=50.0\\,\\text{s}^{-1}$, and $h=0.0410\\,\\text{s}$, the dimensionless product is\n$$\nkh=(50.0)(0.0410)=2.05,\\quad 1-kh=1-2.05=-1.05.\n$$\nThus after three steps,\n$$\nC_{3}=100.0\\,(-1.05)^{3}.\n$$\nCompute the power:\n$$\n(-1.05)^{2}=1.1025,\\quad (-1.05)^{3}=1.1025\\times(-1.05)=-1.157625,\n$$\nso\n$$\nC_{3}=100.0\\times(-1.157625)=-115.7625.\n$$\nRounding to three significant figures gives $-1.16\\times 10^{2}$, i.e., $-116$. Note that the explicit Euler factor satisfies $|1-kh|=1.051$, indicating instability for this step size, which explains the unphysical sign change.", "answer": "$$\\boxed{-116}$$", "id": "2205446"}]}