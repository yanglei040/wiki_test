{"hands_on_practices": [{"introduction": "The power of multigrid methods comes from a \"divide and conquer\" strategy for tackling different components of the error. The first step in this process is smoothing. Simple iterative solvers, like the Jacobi or Gauss-Seidel methods, are surprisingly effective at damping high-frequency, or oscillatory, components of the error. This practice [@problem_id:2188704] provides a direct look at this \"smoothing property\" by applying a basic relaxation scheme to a highly oscillatory error vector and observing the result.", "problem": "In the analysis of iterative methods for solving discretized partial differential equations, understanding the behavior of the error is crucial. Consider a one-dimensional problem discretized on a grid. Let the interior grid points be indexed from $i=1$ to $i=7$. At a particular stage of an iterative process, the error vector corresponding to these interior points is given by $e^{(0)} = [e_1^{(0)}, e_2^{(0)}, \\dots, e_7^{(0)}] = [1, -1, 1, -1, 1, -1, 1]$.\n\nThe physical problem is subject to boundary conditions that fix the values at the edges, ensuring the error at the boundary points is always zero. For our grid, this means $e_0 = 0$ and $e_8 = 0$.\n\nA single step of a simple relaxation scheme is applied to update the error vector. The update rule for the error at each interior grid point $i$ is defined by averaging the error values of its immediate neighbors from the previous step. The formula for the new error vector $e^{(1)}$ is:\n$$e_i^{(1)} = \\frac{1}{2} \\left( e_{i-1}^{(0)} + e_{i+1}^{(0)} \\right)$$\nwhere $i$ ranges from 1 to 7.\n\nCalculate the new error vector $e^{(1)}$ after one application of this relaxation scheme. Present your final answer as a row vector of 7 elements, using fractional or integer values.", "solution": "We are given interior indices $i=1,\\dots,7$, boundary errors $e_{0}^{(0)}=0$ and $e_{8}^{(0)}=0$, and the Jacobi-type relaxation update\n$$\ne_{i}^{(1)}=\\frac{1}{2}\\left(e_{i-1}^{(0)}+e_{i+1}^{(0)}\\right), \\quad i=1,\\dots,7.\n$$\nUsing the initial error vector $e^{(0)}=[1,-1,1,-1,1,-1,1]$ and the boundary values, we compute each component:\n$$\ne_{1}^{(1)}=\\frac{1}{2}\\left(e_{0}^{(0)}+e_{2}^{(0)}\\right)=\\frac{1}{2}\\left(0+(-1)\\right)=-\\frac{1}{2},\n$$\n$$\ne_{2}^{(1)}=\\frac{1}{2}\\left(e_{1}^{(0)}+e_{3}^{(0)}\\right)=\\frac{1}{2}\\left(1+1\\right)=1,\n$$\n$$\ne_{3}^{(1)}=\\frac{1}{2}\\left(e_{2}^{(0)}+e_{4}^{(0)}\\right)=\\frac{1}{2}\\left(-1+(-1)\\right)=-1,\n$$\n$$\ne_{4}^{(1)}=\\frac{1}{2}\\left(e_{3}^{(0)}+e_{5}^{(0)}\\right)=\\frac{1}{2}\\left(1+1\\right)=1,\n$$\n$$\ne_{5}^{(1)}=\\frac{1}{2}\\left(e_{4}^{(0)}+e_{6}^{(0)}\\right)=\\frac{1}{2}\\left(-1+(-1)\\right)=-1,\n$$\n$$\ne_{6}^{(1)}=\\frac{1}{2}\\left(e_{5}^{(0)}+e_{7}^{(0)}\\right)=\\frac{1}{2}\\left(1+1\\right)=1,\n$$\n$$\ne_{7}^{(1)}=\\frac{1}{2}\\left(e_{6}^{(0)}+e_{8}^{(0)}\\right)=\\frac{1}{2}\\left(-1+0\\right)=-\\frac{1}{2}.\n$$\nTherefore, the updated error vector is\n$$\ne^{(1)}=\\begin{pmatrix}-\\frac{1}{2}  1  -1  1  -1  1  -\\frac{1}{2}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2}  1  -1  1  -1  1  -\\frac{1}{2}\\end{pmatrix}}$$", "id": "2188704"}, {"introduction": "After the smoother has damped the high-frequency errors, the remaining error is \"smooth,\" meaning it varies slowly across the grid. Such a smooth function can be accurately represented on a coarser grid, which is computationally cheaper to work with. The process of transferring information, like the residual error, from a fine grid to a coarse grid is called restriction. This exercise [@problem_id:2188681] asks you to determine the weights for a standard \"full-weighting\" restriction operator, giving you insight into how information is aggregated in a principled way.", "problem": "In the implementation of a multigrid solver for a two-dimensional physical problem, a value defined on a \"fine\" grid must be transferred to a \"coarse\" grid. Let the value at a node $(i,j)$ on the fine grid be denoted by $u_{i,j}^h$. The coarse grid is formed by selecting every second node from the fine grid, such that a coarse grid node $(I,J)$ spatially coincides with the fine grid node $(2I, 2J)$.\n\nA common method for computing the value $u_{I,J}^{2h}$ at a coarse grid node is to use a weighted average of the values at the nine fine-grid nodes centered at $(2I, 2J)$. This process, known as full-weighting restriction, is described by the formula:\n\n$$u_{I,J}^{2h} = \\sum_{k=-1}^{1} \\sum_{l=-1}^{1} w_{k,l} \\, u_{2I+k, 2J+l}^h$$\n\nThe weights $w_{k,l}$ are constant coefficients derived from the principle of transferring area-weighted averages, and they are normalized such that their sum over all nine points is unity.\n\nYour task is to determine the nine numerical values for the weights $w_{k,l}$. Present your answer as a single row matrix containing the nine weights in the following specific order:\n$w_{-1,-1}, w_{-1,0}, w_{-1,1}, w_{0,-1}, w_{0,0}, w_{0,1}, w_{1,-1}, w_{1,0}, w_{1,1}$.", "solution": "We consider a uniform fine grid with spacing $h$ and a coarse grid with spacing $2h$. The coarse node $(I,J)$ coincides with the fine node $(2I,2J)$, and full-weighting restriction computes $u_{I,J}^{2h}$ as a weighted sum over the $3 \\times 3$ fine-grid stencil centered at $(2I,2J)$:\n$$\nu_{I,J}^{2h}=\\sum_{k=-1}^{1}\\sum_{l=-1}^{1} w_{k,l}\\,u_{2I+k,\\,2J+l}^{h}.\n$$\nBy the area-weighted averaging principle applied to node-centered data, we determine the weights by averaging the fine-grid piecewise bilinear interpolant over the $2h \\times 2h$ square centered at $(2I,2J)$. Because bilinear shape functions are tensor products of 1D hat functions, the 2D weights factor as a tensor product of 1D weights. Therefore, it suffices to determine the 1D full-weighting coefficients $a_{-1},a_{0},a_{1}$ and then set\n$$\nw_{k,l}=a_{k}\\,a_{l}, \\quad k,l\\in\\{-1,0,1\\}.\n$$\n\nIn 1D, let the coarse value at index $I$ be the average of the fine-grid piecewise linear interpolant over the interval of length $2h$ centered at the coarse node $x_{2I}$. Denote the 1D weights by $a_{-1},a_{0},a_{1}$ so that\n$$\nu_{I}^{2h}=a_{-1}u^{h}_{2I-1}+a_{0}u^{h}_{2I}+a_{1}u^{h}_{2I+1}.\n$$\nWe impose the following conditions:\n\n1) Exactness for constants (conservation of averages): $a_{-1}+a_{0}+a_{1}=1$.\n\n2) Symmetry about the center (and exactness for linear functions on a symmetric interval): $a_{-1}=a_{1}$.\n\n3) Agreement with the interval average of the piecewise linear interpolant for a quadratic prototype $u(x)=x^{2}$: The fine-grid nodal values at $x=-h,0,h$ are $u^{h}_{2I-1}=h^{2}$, $u^{h}_{2I}=0$, $u^{h}_{2I+1}=h^{2}$. The piecewise linear interpolant on $[-h,0]$ and $[0,h]$ has average over $[-h,h]$ equal to $h^{2}/2$. Hence the weighted sum must satisfy\n$$\na_{-1}h^{2}+a_{0}\\cdot 0+a_{1}h^{2}=\\frac{h^{2}}{2}.\n$$\nUsing $a_{-1}=a_{1}$, this gives $2a_{-1}h^{2}=\\frac{h^{2}}{2}$, so $a_{-1}=a_{1}=\\frac{1}{4}$ and then $a_{0}=1-2\\cdot\\frac{1}{4}=\\frac{1}{2}$.\n\nTherefore, the 1D full-weighting coefficients are $a_{-1}=\\frac{1}{4}$, $a_{0}=\\frac{1}{2}$, $a_{1}=\\frac{1}{4}$.\n\nBy the tensor-product structure, the 2D weights are\n$$\nw_{k,l}=a_{k}a_{l}, \\quad k,l\\in\\{-1,0,1\\}.\n$$\nThis yields:\n- Corner weights: $w_{\\pm 1,\\pm 1}=\\frac{1}{4}\\cdot\\frac{1}{4}=\\frac{1}{16}$.\n- Edge weights: $w_{\\pm 1,0}=w_{0,\\pm 1}=\\frac{1}{4}\\cdot\\frac{1}{2}=\\frac{1}{8}$.\n- Center weight: $w_{0,0}=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4}$.\n\nThese satisfy the normalization $\\sum_{k=-1}^{1}\\sum_{l=-1}^{1}w_{k,l}=4\\cdot\\frac{1}{16}+4\\cdot\\frac{1}{8}+1\\cdot\\frac{1}{4}=1$ and preserve constants and linear functions.\n\nArranged in the prescribed order\n$w_{-1,-1}, w_{-1,0}, w_{-1,1}, w_{0,-1}, w_{0,0}, w_{0,1}, w_{1,-1}, w_{1,0}, w_{1,1}$,\nthe weights are\n$$\n\\begin{pmatrix}\\frac{1}{16}  \\frac{1}{8}  \\frac{1}{16}  \\frac{1}{8}  \\frac{1}{4}  \\frac{1}{8}  \\frac{1}{16}  \\frac{1}{8}  \\frac{1}{16}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{16}  \\frac{1}{8}  \\frac{1}{16}  \\frac{1}{8}  \\frac{1}{4}  \\frac{1}{8}  \\frac{1}{16}  \\frac{1}{8}  \\frac{1}{16}\\end{pmatrix}}$$", "id": "2188681"}, {"introduction": "Once the error equation is solved on the coarse grid, the resulting correction must be transferred back to the fine grid to update our solution. This step is called prolongation or interpolation. The coarse-grid correction, being defined only on a sparse set of points, must be used to estimate a correction at all the fine-grid points. In this practice [@problem_id:2188706], you will perform this step using linear interpolation, the most common prolongation method, to see how a coarse-level solution is extended to a finer resolution.", "problem": "In the context of a multigrid method for solving a one-dimensional boundary value problem on the domain $[0, 1]$, a fine grid $\\Omega_h$ and a coarse grid $\\Omega_{2h}$ are used. The fine grid $\\Omega_h$ is defined by nodes $x_i = i \\cdot h$ for $i = 0, 1, \\dots, 8$, with a grid spacing of $h = 1/8$. The coarse grid $\\Omega_{2h}$ is a subset of the fine grid, containing only the nodes $x_j = j \\cdot (2h)$ for $j = 0, 1, \\dots, 4$. Consequently, the interior points of the fine grid are $\\{x_1, x_2, x_3, x_4, x_5, x_6, x_7\\}$, and the interior points of the coarse grid correspond to $\\{x_2, x_4, x_6\\}$ on the fine grid's indexing.\n\nIn one step of the algorithm, an error correction equation is solved on the coarse grid, yielding a correction vector $e_{2h}$. This vector is defined at the interior nodes of $\\Omega_{2h}$ with the values $e_{2h}(x_2) = c_1$, $e_{2h}(x_4) = c_2$, and $e_{2h}(x_6) = c_3$, where $c_1, c_2, c_3$ are symbolic constants. The correction is known to be zero at the boundaries of the domain, so $e_{2h}(x_0) = 0$ and $e_{2h}(x_8) = 0$.\n\nThis coarse-grid correction must be transferred back to the fine grid using a prolongation (interpolation) operator, denoted $I_{2h}^h$, to produce a fine-grid correction vector $e_h = I_{2h}^h e_{2h}$. The interpolation is linear and defined as follows:\n1. For any fine-grid node $x_i$ that is also a coarse-grid node (i.e., $i$ is an even number), the value is directly injected: $e_h(x_i) = e_{2h}(x_i)$.\n2. For any fine-grid node $x_i$ that is not a coarse-grid node (i.e., $i$ is an odd number), the value is the arithmetic mean of the values at its two nearest neighboring coarse-grid nodes.\n\nDetermine the complete correction vector $e_h$ at all seven interior points of the fine grid, $\\{x_1, x_2, \\dots, x_7\\}$. Express your answer as a single row vector with 7 components, ordered from $x_1$ to $x_7$, in terms of the constants $c_1$, $c_2$, and $c_3$.", "solution": "We are given two nested uniform grids on $[0,1]$: the fine grid $\\Omega_{h}$ with nodes $x_{i}=i h$ for $i=0,\\dots,8$ and $h=1/8$, and the coarse grid $\\Omega_{2h}$ consisting of the subset of even-indexed fine nodes $x_{j}=j(2h)$ for $j=0,\\dots,4$, i.e., indices $i=0,2,4,6,8$. The interior fine nodes are $x_{1},\\dots,x_{7}$, and the interior coarse nodes correspond to $x_{2},x_{4},x_{6}$. The coarse-grid correction $e_{2h}$ is specified by\n$$\ne_{2h}(x_{2})=c_{1},\\quad e_{2h}(x_{4})=c_{2},\\quad e_{2h}(x_{6})=c_{3},\\quad e_{2h}(x_{0})=0,\\quad e_{2h}(x_{8})=0.\n$$\nWe construct the fine-grid correction $e_{h}=I_{2h}^{h} e_{2h}$ using linear prolongation. The interpolation rule is:\n- For even $i$ (fine node coincides with coarse node): injection,\n$$\ne_{h}(x_{i})=e_{2h}(x_{i}).\n$$\n- For odd $i$ (fine node midway between two neighboring coarse nodes): arithmetic mean,\n$$\ne_{h}(x_{i})=\\frac{e_{2h}(x_{i-1})+e_{2h}(x_{i+1})}{2}.\n$$\n\nWe now evaluate $e_{h}$ at the seven interior fine nodes:\n\n1) $i=1$ (odd), neighbors $x_{0}$ and $x_{2}$:\n$$\ne_{h}(x_{1})=\\frac{e_{2h}(x_{0})+e_{2h}(x_{2})}{2}=\\frac{0+c_{1}}{2}=\\frac{c_{1}}{2}.\n$$\n\n2) $i=2$ (even), injection:\n$$\ne_{h}(x_{2})=e_{2h}(x_{2})=c_{1}.\n$$\n\n3) $i=3$ (odd), neighbors $x_{2}$ and $x_{4}$:\n$$\ne_{h}(x_{3})=\\frac{e_{2h}(x_{2})+e_{2h}(x_{4})}{2}=\\frac{c_{1}+c_{2}}{2}.\n$$\n\n4) $i=4$ (even), injection:\n$$\ne_{h}(x_{4})=e_{2h}(x_{4})=c_{2}.\n$$\n\n5) $i=5$ (odd), neighbors $x_{4}$ and $x_{6}$:\n$$\ne_{h}(x_{5})=\\frac{e_{2h}(x_{4})+e_{2h}(x_{6})}{2}=\\frac{c_{2}+c_{3}}{2}.\n$$\n\n6) $i=6$ (even), injection:\n$$\ne_{h}(x_{6})=e_{2h}(x_{6})=c_{3}.\n$$\n\n7) $i=7$ (odd), neighbors $x_{6}$ and $x_{8}$:\n$$\ne_{h}(x_{7})=\\frac{e_{2h}(x_{6})+e_{2h}(x_{8})}{2}=\\frac{c_{3}+0}{2}=\\frac{c_{3}}{2}.\n$$\n\nCollecting the components in order from $x_{1}$ to $x_{7}$ yields the row vector\n$$\n\\begin{pmatrix}\n\\frac{c_{1}}{2}  c_{1}  \\frac{c_{1}+c_{2}}{2}  c_{2}  \\frac{c_{2}+c_{3}}{2}  c_{3}  \\frac{c_{3}}{2}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{c_{1}}{2}  c_{1}  \\frac{c_{1}+c_{2}}{2}  c_{2}  \\frac{c_{2}+c_{3}}{2}  c_{3}  \\frac{c_{3}}{2}\\end{pmatrix}}$$", "id": "2188706"}]}