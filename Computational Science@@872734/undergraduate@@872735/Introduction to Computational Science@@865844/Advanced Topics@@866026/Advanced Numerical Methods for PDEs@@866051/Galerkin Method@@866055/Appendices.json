{"hands_on_practices": [{"introduction": "The essence of the Galerkin method is to find the best possible approximation to a solution within a predefined space of functions. This first exercise [@problem_id:2150034] puts this principle into practice in a clear, straightforward scenario. By using a single, well-chosen trigonometric basis function, we will approximate the solution to a one-dimensional boundary value problem, demonstrating how the method minimizes the error by making the residual orthogonal to our chosen function space.", "problem": "Consider a one-dimensional rod of length $\\pi$ with its ends at $x=0$ and $x=\\pi$ maintained at a constant temperature of zero. The rod is subjected to an internal heat source that varies linearly along its length, described by a source density function $f(x) = x$. The steady-state temperature distribution $u(x)$ in the rod is governed by the boundary value problem:\n$$ -u''(x) = x, \\quad \\text{for } x \\in (0, \\pi) $$\nwith boundary conditions:\n$$ u(0) = 0, \\quad u(\\pi) = 0 $$\nUsing the Galerkin method, find an approximate solution $\\tilde{u}(x)$ to this problem. For the approximation, use a single basis function that is the simplest non-trivial trigonometric function satisfying the given boundary conditions. Provide the expression for the approximate solution $\\tilde{u}(x)$.", "solution": "We seek a Galerkin approximation for the boundary value problem\n$$\n-u''(x)=x \\quad \\text{on } (0,\\pi), \\quad u(0)=0,\\; u(\\pi)=0.\n$$\nFor homogeneous Dirichlet boundary conditions, the weak form is: find $u \\in H_{0}^{1}(0,\\pi)$ such that for all $v \\in H_{0}^{1}(0,\\pi)$,\n$$\n\\int_{0}^{\\pi} u'(x)\\,v'(x)\\,dx=\\int_{0}^{\\pi} x\\,v(x)\\,dx.\n$$\nWe choose a one-dimensional trial and test space spanned by the simplest non-trivial trigonometric function satisfying the boundary conditions, namely $\\sin(x)$. Thus let\n$$\n\\tilde{u}(x)=a\\,\\sin(x),\n$$\nand take $v(x)=\\sin(x)$ as the test function. Then $\\tilde{u}'(x)=a\\cos(x)$ and $v'(x)=\\cos(x)$, so the Galerkin equation becomes\n$$\n\\int_{0}^{\\pi} \\tilde{u}'(x)\\,v'(x)\\,dx=\\int_{0}^{\\pi} x\\,v(x)\\,dx\n\\quad\\Longrightarrow\\quad\na\\int_{0}^{\\pi}\\cos^{2}(x)\\,dx=\\int_{0}^{\\pi} x\\,\\sin(x)\\,dx.\n$$\nEvaluate the integrals explicitly. Using $\\cos^{2}(x)=\\frac{1}{2}\\left(1+\\cos(2x)\\right)$,\n$$\n\\int_{0}^{\\pi}\\cos^{2}(x)\\,dx=\\left[\\frac{x}{2}+\\frac{\\sin(2x)}{4}\\right]_{0}^{\\pi}=\\frac{\\pi}{2}.\n$$\nFor the right-hand side, integrate by parts with $u=x$, $dv=\\sin(x)\\,dx$, so $du=dx$, $v=-\\cos(x)$:\n$$\n\\int_{0}^{\\pi} x\\,\\sin(x)\\,dx=\\left[-x\\cos(x)\\right]_{0}^{\\pi}+\\int_{0}^{\\pi}\\cos(x)\\,dx=\\pi+0=\\pi.\n$$\nThus\n$$\na\\cdot\\frac{\\pi}{2}=\\pi \\quad\\Longrightarrow\\quad a=2.\n$$\nTherefore, the one-term Galerkin approximation is\n$$\n\\tilde{u}(x)=2\\sin(x).\n$$", "answer": "$$\\boxed{2\\sin(x)}$$", "id": "2150034"}, {"introduction": "Real-world problems often come with non-zero, or inhomogeneous, boundary conditions. This practice [@problem_id:2150022] introduces a powerful and standard technique for handling such cases. We will see how to decompose the trial solution into a function that satisfies the boundary conditions and another that vanishes on the boundary, allowing us to apply the Galerkin method to the part of the problem where it is most naturally suited.", "problem": "Consider the two-point boundary value problem defined by the differential equation $-u''(x) = 1$ on the interval $x \\in (0, 1)$, subject to the inhomogeneous boundary conditions $u(0) = 1$ and $u(1) = 2$.\n\nWe seek an approximate solution to this problem using the Galerkin method. A trial solution is proposed in the form $u_h(x) = (x+1) + c_1 x(1-x)$, where $c_1$ is an unknown constant coefficient that needs to be determined. The term $x(1-x)$ serves as the single basis function for the homogeneous part of the solution.\n\nUsing the Galerkin method, determine the value of the coefficient $c_1$. Express your answer as a fraction.", "solution": "We approximate the solution $u$ by $u_{h}(x)=(x+1)+c_{1}\\,x(1-x)$, which satisfies the essential boundary conditions for all $c_{1}$. In the Galerkin method for $-u''=1$ with homogeneous test space, the weak form is\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx=\\int_{0}^{1} v(x)\\,dx\n$$\nfor all test functions $v$ vanishing at the endpoints. With a single basis function $v(x)=x(1-x)$, we compute\n$$\nu_{h}'(x)=1+c_{1}(1-2x), \\quad v'(x)=1-2x.\n$$\nThe Galerkin equation becomes\n$$\n\\int_{0}^{1}\\left[1+c_{1}(1-2x)\\right](1-2x)\\,dx=\\int_{0}^{1}x(1-x)\\,dx.\n$$\nEvaluate the left-hand side by splitting terms:\n$$\n\\int_{0}^{1}(1-2x)\\,dx + c_{1}\\int_{0}^{1}(1-2x)^{2}\\,dx.\n$$\nWe have\n$$\n\\int_{0}^{1}(1-2x)\\,dx=\\left[x-x^{2}\\right]_{0}^{1}=1-1=0,\n$$\nand\n$$\n\\int_{0}^{1}(1-2x)^{2}\\,dx=\\int_{0}^{1}\\left(1-4x+4x^{2}\\right)\\,dx=1-2+\\frac{4}{3}=\\frac{1}{3}.\n$$\nThe right-hand side is\n$$\n\\int_{0}^{1}x(1-x)\\,dx=\\int_{0}^{1}(x-x^{2})\\,dx=\\left[\\frac{x^{2}}{2}-\\frac{x^{3}}{3}\\right]_{0}^{1}=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6}.\n$$\nThus,\n$$\nc_{1}\\cdot\\frac{1}{3}=\\frac{1}{6}\\quad\\Rightarrow\\quad c_{1}=\\frac{1}{2}.\n$$\nFor completeness, the residual form gives the same result: $u_{h}''(x)=-2c_{1}$, so $-u_{h}''-1=2c_{1}-1$, and the Galerkin condition $\\int_{0}^{1}(2c_{1}-1)\\,x(1-x)\\,dx=0$ yields $(2c_{1}-1)\\cdot\\frac{1}{6}=0$, hence $c_{1}=\\frac{1}{2}$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2150022"}, {"introduction": "Our final practice bridges the gap between a simple approximation and a systematic, powerful computational technique. By using a set of simple, locally-supported basis functions—piecewise linear splines or 'hat functions'—we can build a highly accurate approximate solution across a domain. This exercise [@problem_id:3155303] guides you through the process of deriving and implementing the one-dimensional Finite Element Method (FEM), revealing it as a direct and scalable application of the Galerkin principle.", "problem": "Consider the boundary value problem defined by the ordinary differential equation $-u''(x)=f(x)$ on the interval $[0,1]$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. Starting from the fundamental procedure of multiplying by an admissible test function $v$ that vanishes on the boundary and integrating by parts, derive the weak (variational) form appropriate for functions in the Sobolev space $H^1_0([0,1])$. Using this weak form, implement a Galerkin method where the trial and test spaces are taken to be the same subspace spanned by linear spline (piecewise linear) basis functions on a uniform mesh. The mesh partitions $[0,1]$ into $N$ equal subintervals, with nodes $x_i=i/N$ for $i=0,1,\\ldots,N$. The linear spline basis should consist of the standard hat functions associated with the interior nodes $x_i$ for $i=1,\\ldots,N-1$, so that each basis function is supported on two neighboring subintervals and is linear on each subinterval.\n\nYour task is to:\n- Derive the expressions required to assemble the linear system corresponding to the Galerkin method using linear splines, starting explicitly from the weak form and the definition of the basis functions. Express the bilinear form associated with the left-hand side and the linear functional associated with the right-hand side as elementwise integrals.\n- Implement the assembly of the global stiffness matrix and load vector by evaluating the required one-dimensional integrals on each element. You must perform these integrals to full machine-precision accuracy for smooth $f$ by either exact evaluation or sufficiently accurate numerical quadrature. A reliable approach is to use Gauss–Legendre quadrature with $q=5$ points per element.\n- Solve the resulting linear system for the coefficients of the linear spline approximation and construct the nodal values of the approximate solution on the mesh including the boundary nodes, enforcing the homogeneous Dirichlet boundary conditions.\n- Compute, for each test case, the maximum nodal error defined as $\\max_{0\\leq i\\leq N}\\left|u_h(x_i)-u_{\\mathrm{exact}}(x_i)\\right|$, where $u_h$ is the Galerkin solution and $u_{\\mathrm{exact}}$ is the known exact solution for the chosen $f$.\n\nExplain, in your solution narrative, how and why this Galerkin construction with linear splines is precisely the finite element method with piecewise linear elements in one spatial dimension. Explicitly connect the weak form, the choice of basis, and the elementwise assembly to the standard finite element interpretation.\n\nUse the following test suite, which specifies values of $N$, the forcing function $f(x)$, and the corresponding exact solution $u_{\\mathrm{exact}}(x)$:\n- Test 1: $N=2$, $f(x)=1$, $u_{\\mathrm{exact}}(x)=\\dfrac{x(1-x)}{2}$.\n- Test 2: $N=4$, $f(x)=\\sin(\\pi x)$, $u_{\\mathrm{exact}}(x)=\\dfrac{\\sin(\\pi x)}{\\pi^2}$.\n- Test 3: $N=10$, $f(x)=2$, $u_{\\mathrm{exact}}(x)=x(1-x)$.\n- Test 4: $N=3$, $f(x)=0$, $u_{\\mathrm{exact}}(x)=0$.\n- Test 5: $N=8$, $f(x)=\\begin{cases}1,&0\\le x<\\tfrac{1}{2},\\\\0,&\\tfrac{1}{2}\\le x\\le 1,\\end{cases}$, $u_{\\mathrm{exact}}(x)=\\begin{cases}-\\dfrac{x^2}{2}+\\dfrac{3}{8}x,&0\\le x<\\tfrac{1}{2},\\\\ -\\dfrac{x}{8}+\\dfrac{1}{8},&\\tfrac{1}{2}\\le x\\le 1.\\end{cases}$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the maximum nodal error for one test case rounded to eight decimal places (for example, $[0.00000000,0.12345678,0.00000001,0.00000000,0.01234567]$). No physical units are involved in this problem, and angles are not used. The final output must aggregate the results of all provided test cases into the specified single-line format.", "solution": "This process involves deriving the weak form, discretizing it using a Galerkin approach, assembling the resulting linear system, solving it, and calculating the error against a known exact solution.\n\n### Step 1: Derivation of the Weak (Variational) Form\n\nThe problem is defined by the strong form of the differential equation:\n$$ -u''(x) = f(x) \\quad \\text{for } x \\in (0, 1) $$\nwith homogeneous Dirichlet boundary conditions:\n$$ u(0) = 0, \\quad u(1) = 0 $$\n\nTo derive the weak form, we multiply the equation by an admissible test function $v(x)$ and integrate over the domain $[0,1]$. The test functions must belong to a space that respects the boundary conditions. The appropriate space is the Sobolev space $H^1_0([0,1])$, which consists of functions in $H^1([0,1])$ that vanish at the boundaries $x=0$ and $x=1$.\n\nMultiplying by $v \\in H^1_0([0,1])$ and integrating gives:\n$$ -\\int_0^1 u''(x) v(x) \\,dx = \\int_0^1 f(x) v(x) \\,dx $$\n\nWe apply integration by parts to the left-hand side term $\\int_0^1 u''(x) v(x) \\,dx$:\n$$ \\int_0^1 u''(x) v(x) \\,dx = \\Big[ u'(x) v(x) \\Big]_0^1 - \\int_0^1 u'(x) v'(x) \\,dx $$\n\nThe boundary term $\\Big[ u'(x) v(x) \\Big]_0^1 = u'(1)v(1) - u'(0)v(0)$ is zero because the test function $v(x)$ vanishes at the boundaries, i.e., $v(0) = v(1) = 0$. Substituting this back, we get:\n$$ - \\left( 0 - \\int_0^1 u'(x) v'(x) \\,dx \\right) = \\int_0^1 f(x) v(x) \\,dx $$\n$$ \\int_0^1 u'(x) v'(x) \\,dx = \\int_0^1 f(x) v(x) \\,dx $$\n\nThe weak form of the problem is to find a solution $u \\in H^1_0([0,1])$ such that the above equation holds for all test functions $v \\in H^1_0([0,1])$. This can be stated abstractly as finding $u \\in H^1_0([0,1])$ such that $a(u,v) = L(v)$ for all $v \\in H^1_0([0,1])$, where:\n-   The bilinear form is $a(u,v) = \\int_0^1 u'(x)v'(x) \\,dx$.\n-   The linear functional is $L(v) = \\int_0^1 f(x)v(x) \\,dx$.\n\n### Step 2: Galerkin Discretization with Linear Splines\n\nThe Galerkin method seeks an approximate solution $u_h(x)$ from a finite-dimensional subspace $V_h \\subset H^1_0([0,1])$. The problem specifies that $V_h$ is the space of linear splines (continuous piecewise linear functions) on a uniform mesh.\n\nThe mesh consists of $N+1$ nodes $x_i = i/N = ih$ for $i=0, 1, \\dots, N$, where $h = 1/N$ is the size of each of the $N$ subintervals (elements).\n\nTo ensure that any function in $V_h$ satisfies the homogeneous boundary conditions, we construct $V_h$ from a basis of \"hat\" functions $\\phi_i(x)$ centered at the interior nodes $x_i$ for $i=1, \\dots, N-1$. Each basis function $\\phi_i(x)$ is defined as:\n$$\n\\phi_i(x) =\n\\begin{cases}\n    \\frac{x - x_{i-1}}{h}, & x \\in [x_{i-1}, x_i] \\\\\n    \\frac{x_{i+1} - x}{h}, & x \\in [x_i, x_{i+1}] \\\\\n    0, & \\text{otherwise}\n\\end{cases}\n$$\nThe approximate solution $u_h(x)$ is a linear combination of these basis functions:\n$$ u_h(x) = \\sum_{j=1}^{N-1} c_j \\phi_j(x) $$\nThe coefficients $c_j$ represent the unknown values of the solution at the interior nodes, i.e., $c_j = u_h(x_j)$.\n\nThe Galerkin problem is to find $u_h \\in V_h$ such that $a(u_h, v_h) = L(v_h)$ for all $v_h \\in V_h$. Since the set $\\{\\phi_i\\}_{i=1}^{N-1}$ forms a basis for $V_h$, it is sufficient to test against each basis function $\\phi_i$:\n$$ a\\left(\\sum_{j=1}^{N-1} c_j \\phi_j, \\phi_i\\right) = L(\\phi_i) \\quad \\text{for } i=1, \\dots, N-1 $$\nBy linearity of the bilinear form $a(\\cdot, \\cdot)$, this becomes a system of linear equations:\n$$ \\sum_{j=1}^{N-1} c_j \\, a(\\phi_j, \\phi_i) = L(\\phi_i) $$\nThis is a matrix system $K\\mathbf{c} = \\mathbf{F}$, where $\\mathbf{c} = [c_1, \\dots, c_{N-1}]^T$ is the vector of unknown coefficients, and the entries of the stiffness matrix $K$ and load vector $\\mathbf{F}$ are:\n$$ K_{ij} = a(\\phi_i, \\phi_j) = \\int_0^1 \\phi_i'(x) \\phi_j'(x) \\,dx \\quad (\\text{Note: } a(\\phi_j, \\phi_i) \\text{ in sum leads to } K_{ij}=a(\\phi_i,\\phi_j) \\text{ due to symmetry}) $$\n$$ F_i = L(\\phi_i) = \\int_0^1 f(x) \\phi_i(x) \\,dx $$\nHere, the indices of the matrix and vector run from $1$ to $N-1$.\n\n### Step 3: Assembly of the Stiffness Matrix and Load Vector\n\n**Stiffness Matrix $K$:**\nThe derivative of the hat function $\\phi_i(x)$ is a piecewise constant function:\n$$\n\\phi_i'(x) =\n\\begin{cases}\n    1/h, & x \\in (x_{i-1}, x_i) \\\\\n    -1/h, & x \\in (x_i, x_{i+1}) \\\\\n    0, & \\text{otherwise}\n\\end{cases}\n$$\n-   **Diagonal entries ($i=j$):** The supports of $\\phi_i'$ and $\\phi_i'$ overlap on $[x_{i-1}, x_{i+1}]$.\n    $$ K_{ii} = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2 dx + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{1}{h^2}(h) + \\frac{1}{h^2}(h) = \\frac{2}{h} $$\n-   **Off-diagonal entries ($j=i\\pm1$):** The supports of $\\phi_i'$ and $\\phi_{i+1}'$ overlap only on $[x_i, x_{i+1}]$.\n    $$ K_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h^2}(h) = -\\frac{1}{h} $$\n    By symmetry, $K_{i,i-1} = -1/h$.\n-   **Other entries ($|i-j|>1$):** The supports do not overlap, so the integrand is zero. $K_{ij}=0$.\n\nThe resulting $(N-1) \\times (N-1)$ stiffness matrix is symmetric and tridiagonal:\n$$ K = \\frac{1}{h} \\begin{pmatrix} 2 & -1 & 0 & \\cdots & 0 \\\\ -1 & 2 & -1 & \\cdots & 0 \\\\ 0 & \\ddots & \\ddots & \\ddots & 0 \\\\ \\vdots & & -1 & 2 & -1 \\\\ 0 & \\cdots & 0 & -1 & 2 \\end{pmatrix} $$\n\n**Load Vector $\\mathbf{F}$:**\nThe entries $F_i$ are given by integrals which depend on the forcing function $f(x)$:\n$$ F_i = \\int_0^1 f(x) \\phi_i(x) \\,dx = \\int_{x_{i-1}}^{x_i} f(x) \\frac{x-x_{i-1}}{h} \\,dx + \\int_{x_i}^{x_{i+1}} f(x) \\frac{x_{i+1}-x}{h} \\,dx $$\nFor a general $f(x)$, these integrals are computed numerically. The problem suggests a $q=5$-point Gauss-Legendre quadrature rule on each subinterval $[x_{i-1}, x_i]$ and $[x_i, x_{i+1}]$ to ensure high accuracy. For an integral $\\int_a^b g(t)dt$, the quadrature rule is:\n$$ \\int_a^b g(t)dt \\approx \\frac{b-a}{2} \\sum_{k=1}^q w_k \\, g\\left( \\frac{b-a}{2}\\xi_k + \\frac{a+b}{2} \\right) $$\nwhere $(\\xi_k, w_k)$ are the standard Gauss-Legendre points and weights on $[-1, 1]$.\n\n### Step 4: Connection to the Finite Element Method (FEM)\n\nThis entire process is precisely the Finite Element Method with piecewise linear (P1) elements in one dimension.\n1.  **Domain Discretization**: The interval $[0,1]$ is partitioned into $N$ subintervals $[x_i, x_{i+1}]$. These are the \"finite elements\".\n2.  **Choice of Basis**: The approximation space $V_h$ is built from functions that are simple (linear) on each element. The linear splines, or \"hat functions\" $\\phi_i$, are the standard basis functions for P1 elements. Their crucial property is being \"locally supported\" ($\\phi_i$ is non-zero only over two adjacent elements), which leads to a sparse stiffness matrix, a defining feature and key advantage of FEM.\n3.  **Element-wise Assembly**: The global stiffness matrix $K$ and load vector $\\mathbf{F}$ are constructed by summing contributions from each element. For example, the integral for $a(u,v)$ is a sum of integrals over each element: $a(u,v)=\\sum_e \\int_e u'v' dx$. The computation of $K_{ij}$ and $F_i$ by integrating over the small patches where basis functions are non-zero is the standard \"assembly\" procedure in FEM. This breaks a large, global problem into smaller, manageable calculations on each element.\n\nIn summary, the Galerkin method provides the theoretical framework (projecting the infinite-dimensional problem onto a finite-dimensional space), while the \"finite element\" part refers to the specific practical implementation based on partitioning the domain and using locally-supported piecewise polynomial basis functions.\n\n### Step 5: Solution and Error Calculation\n\nAfter assembling $K$ and $\\mathbf{F}$, the linear system $K\\mathbf{c} = \\mathbf{F}$ is solved for the coefficient vector $\\mathbf{c}$. This gives the values of the approximate solution $u_h$ at the interior nodes $\\{x_i\\}_{i=1}^{N-1}$. The full nodal solution vector $u_h(x_i)$ is constructed by including the boundary conditions:\n$$ u_h(x_0)=0, \\quad u_h(x_i)=c_i \\text{ for } i=1,\\dots,N-1, \\quad u_h(x_N)=0 $$\nFinally, the maximum nodal error is computed by comparing the approximate solution to the exact solution at all nodes:\n$$ \\text{Error} = \\max_{0 \\le i \\le N} |u_h(x_i) - u_{\\text{exact}}(x_i)| $$\n\nFor certain simple cases, such as when $f(x)$ is constant, the nodal values $u_h(x_i)$ are known to be exact, yielding a nodal error of zero. This is a consequence of the specific properties of the 1D Poisson equation and the chosen discretization. For more complex $f(x)$, a non-zero error is expected.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D Poisson equation -u''(x) = f(x) on [0,1] with u(0)=u(1)=0\n    using the Finite Element Method with linear splines.\n    \"\"\"\n\n    # Define test cases: N, f(x), u_exact(x)\n    test_cases = [\n        (2,\n         lambda x: 1.0,\n         lambda x: x * (1 - x) / 2.0\n        ),\n        (4,\n         lambda x: np.sin(np.pi * x),\n         lambda x: np.sin(np.pi * x) / (np.pi**2)\n        ),\n        (10,\n         lambda x: 2.0,\n         lambda x: x * (1 - x)\n        ),\n        (3,\n         lambda x: 0.0,\n         lambda x: 0.0\n        ),\n        (8,\n         lambda x: np.piecewise(x, [x < 0.5], [1.0, 0.0]),\n         lambda x: np.piecewise(x, [x < 0.5, x >= 0.5],\n                                [lambda y: -y**2 / 2.0 + 3.0 / 8.0 * y,\n                                 lambda y: -y / 8.0 + 1.0 / 8.0])\n        )\n    ]\n\n    results = []\n\n    # Get Gauss-Legendre quadrature points and weights\n    q = 5\n    xi_k, w_k = np.polynomial.legendre.leggauss(q)\n\n    for case_num, (N, f, u_exact) in enumerate(test_cases):\n        h = 1.0 / N\n        nodes = np.linspace(0, 1, N + 1)\n        dim = N - 1  # Dimension of the linear system for interior nodes\n\n        if dim == 0:\n            u_h_nodes = np.zeros(N + 1)\n            u_exact_nodes = u_exact(nodes)\n            error = np.max(np.abs(u_h_nodes - u_exact_nodes))\n            results.append(error)\n            continue\n\n        # Assemble stiffness matrix K\n        K = np.zeros((dim, dim))\n        main_diag = 2.0 / h\n        off_diag = -1.0 / h\n        \n        np.fill_diagonal(K, main_diag)\n        np.fill_diagonal(K[1:], off_diag)\n        np.fill_diagonal(K[:, 1:], off_diag)\n\n        # Assemble load vector F\n        F = np.zeros(dim)\n        for i in range(1, N): # Iterate over interior nodes\n            # Contribution from element [x_{i-1}, x_i]\n            # On this element, phi_i(x) = (x - x_{i-1})/h\n            a, b = nodes[i-1], nodes[i]\n            x_q = 0.5 * (b - a) * xi_k + 0.5 * (a + b)\n            phi_vals = (x_q - a) / h\n            f_vals = f(x_q)\n            integral1 = 0.5 * (b - a) * np.sum(w_k * f_vals * phi_vals)\n\n            # Contribution from element [x_i, x_{i+1}]\n            # On this element, phi_i(x) = (x_{i+1} - x)/h\n            a, b = nodes[i], nodes[i+1]\n            x_q = 0.5 * (b - a) * xi_k + 0.5 * (a + b)\n            phi_vals = (b - x_q) / h\n            f_vals = f(x_q)\n            integral2 = 0.5 * (b - a) * np.sum(w_k * f_vals * phi_vals)\n            \n            F[i-1] = integral1 + integral2\n\n        # Solve the linear system Kc = F\n        coeffs = np.linalg.solve(K, F)\n\n        # Construct the full solution at all nodes\n        u_h_nodes = np.zeros(N + 1)\n        u_h_nodes[1:N] = coeffs\n        \n        # Calculate exact solution at nodes\n        u_exact_nodes = u_exact(nodes)\n\n        # Compute the maximum nodal error\n        error = np.max(np.abs(u_h_nodes - u_exact_nodes))\n        results.append(error)\n\n    # Format output\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3155303"}]}