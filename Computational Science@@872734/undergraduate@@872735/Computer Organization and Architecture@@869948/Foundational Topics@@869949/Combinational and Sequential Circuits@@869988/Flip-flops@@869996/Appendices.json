{"hands_on_practices": [{"introduction": "Understanding the fundamental behavior of different flip-flop types is the first step toward mastering sequential logic. This exercise demonstrates that the various types, such as D-type and T-type, are not fundamentally different but are inter-convertible. By designing the correct combinational logic for the input of a D flip-flop, you can make it behave exactly like a T flip-flop, reinforcing your understanding of their characteristic equations [@problem_id:1931871].", "problem": "An edge-triggered T flip-flop is a fundamental sequential logic component. It has a single data input, T (for \"Toggle\"), and an output, Q. Its behavior is defined as follows: on the active clock edge, if T=0, the output Q holds its current state; if T=1, the output Q toggles to its complement.\n\nYou are tasked with constructing a positive edge-triggered T flip-flop. However, you only have access to a single positive edge-triggered D flip-flop and a selection of standard two-input logic gates. A D flip-flop (for \"Data\" or \"Delay\") has a single data input, D, and an output, Q. On the active clock edge, its output Q simply takes on the value of its input D.\n\nLet Q represent the current state of the flip-flop's output. Which of the following logic expressions for the D input correctly converts the D flip-flop into a T flip-flop with toggle input T?\n\nA. $D = T \\cdot Q$ (T AND Q)\n\nB. $D = T + \\overline{Q}$ (T OR NOT Q)\n\nC. $D = \\overline{T \\oplus Q}$ (T XNOR Q)\n\nD. $D = T \\oplus Q$ (T XOR Q)\n\nE. $D = \\overline{T} + Q$ (NOT T OR Q)", "solution": "A T flip-flop has the next-state behavior: on a positive clock edge, if $T=0$ then the output holds ($Q^{+}=Q$), and if $T=1$ then the output toggles ($Q^{+}=\\overline{Q}$). This can be written as a Boolean equation by selecting between $Q$ and $\\overline{Q}$ using $T$ as the selector:\n$$\nQ^{+}=\\overline{T}Q+T\\overline{Q}\n$$\nA D flip-flop outputs $Q^{+}=D$ on the positive clock edge. Therefore, to make a D flip-flop behave as a T flip-flop, we must set\n$$\nD=Q^{+}=\\overline{T}Q+T\\overline{Q}\n$$\nBy the definition of the exclusive-OR,\n$$\nT\\oplus Q=\\overline{T}Q+T\\overline{Q}\n$$\nso the required input is\n$$\nD=T\\oplus Q\n$$\nChecking against the options, this corresponds to option D. For completeness, note that other options fail the required behavior when $T=0$ or $T=1$ (for example, $D=T\\cdot Q$ gives $D=0$ when $T=0$, not $Q$; $D=\\overline{T\\oplus Q}$ gives $D=\\overline{Q}$ when $T=0$, not $Q$).", "answer": "$$\\boxed{D}$$", "id": "1931871"}, {"introduction": "With a solid grasp of individual flip-flops, the next step is to combine them into functional circuits. This practice challenges you to design a synchronous counter, a cornerstone of digital systems, using T flip-flops. You will derive the logic that controls when each flip-flop should toggle to produce a specific 2-bit Gray code sequence, both forwards and backwards, which is a common task in designing state machines for control units or sequencers [@problem_id:3641646].", "problem": "Consider a synchronous $2$-bit Gray up/down counter implemented using ideal toggle ($T$) flip-flops. The counter has two state bits $Q_1$ and $Q_0$, an edge-triggered clock, and a direction control input $U$, where $U=1$ selects the Gray up sequence and $U=0$ selects the Gray down sequence. The Gray code must satisfy the adjacency property that successive states differ in exactly one bit regardless of the direction. Use the canonical $2$-bit Gray cycle $00 \\rightarrow 01 \\rightarrow 11 \\rightarrow 10 \\rightarrow 00$ for the up direction and its reverse for the down direction. Each $T$ flip-flop toggles its corresponding state bit when its input is $1$ and holds when its input is $0$.\n\nStarting strictly from these definitions, derive closed-form algebraic expressions for the toggle inputs $T_0$ and $T_1$ as functions of $U$, $Q_1$, and $Q_0$ that guarantee Gray adjacency in both the up and down directions. Express your final $T_0$ and $T_1$ using only the exclusive OR (XOR) operation $\\oplus$ and, if needed, the constants $0$ and $1$. Do not introduce any other logical operators in your final expressions. Your final answer must be a single analytical expression; if multiple expressions are required, present them as a single row vector.", "solution": "The design process begins by constructing a state transition and excitation table. This table lists every combination of the current state ($Q_1, Q_0$) and the control input ($U$), the corresponding next state ($Q_1^+, Q_0^+$), and the required toggle flip-flop inputs ($T_1, T_0$).\n\nThe state sequences are:\n-   **Up Sequence ($U=1$)**: $00 \\rightarrow 01 \\rightarrow 11 \\rightarrow 10 \\rightarrow 00$\n-   **Down Sequence ($U=0$)**: $00 \\rightarrow 10 \\rightarrow 11 \\rightarrow 01 \\rightarrow 00$\n\nThe excitation equation for a T flip-flop is $T = Q \\oplus Q^+$, where $Q$ is the current state and $Q^+$ is the next state. Using this, we determine the required toggle inputs for each transition.\n\nThe complete state transition and excitation table is as follows:\n\n| Control Input ($U$) | Current State ($Q_1 Q_0$) | Next State ($Q_1^+ Q_0^+$) | Toggle Input ($T_1$) | Toggle Input ($T_0$) |\n|:--------------------:|:-------------------------:|:--------------------------:|:--------------------:|:--------------------:|\n| 0 | $0\\;0$ | $1\\;0$ | 1 | 0 |\n| 0 | $0\\;1$ | $0\\;0$ | 0 | 1 |\n| 0 | $1\\;0$ | $1\\;1$ | 0 | 1 |\n| 0 | $1\\;1$ | $0\\;1$ | 1 | 0 |\n| 1 | $0\\;0$ | $0\\;1$ | 0 | 1 |\n| 1 | $0\\;1$ | $1\\;1$ | 1 | 0 |\n| 1 | $1\\;0$ | $0\\;0$ | 1 | 0 |\n| 1 | $1\\;1$ | $1\\;0$ | 0 | 1 |\n\nFrom the table, we derive the Boolean expressions for $T_1$ and $T_0$ as functions of $U$, $Q_1$, and $Q_0$.\n\n**Derivation for $T_0$:**\n$T_0$ is 1 for the input combinations ($U, Q_1, Q_0$): $(0,0,1)$, $(0,1,0)$, $(1,0,0)$, and $(1,1,1)$. This corresponds to the cases where an odd number of the inputs ($U, Q_1, Q_0$) are 1, which is the definition of the 3-input XOR function:\n$$T_0 = U \\oplus Q_1 \\oplus Q_0$$\n\n**Derivation for $T_1$:**\n$T_1$ is 1 for the input combinations ($U, Q_1, Q_0$): $(0,0,0)$, $(0,1,1)$, $(1,0,1)$, and $(1,1,0)$. This corresponds to the cases where an even number of the inputs are 1, which is the definition of the 3-input XNOR function:\n$$T_1 = \\overline{U \\oplus Q_1 \\oplus Q_0}$$\nTo express this using only the XOR operator and constants, we use the identity $\\bar{A} = A \\oplus 1$:\n$$T_1 = (U \\oplus Q_1 \\oplus Q_0) \\oplus 1$$\n\nThe final expressions for the toggle inputs are therefore:\n$$T_0 = U \\oplus Q_1 \\oplus Q_0$$\n$$T_1 = (U \\oplus Q_1 \\oplus Q_0) \\oplus 1$$", "answer": "$$ \\boxed{ \\begin{pmatrix} U \\oplus Q_1 \\oplus Q_0 & (U \\oplus Q_1 \\oplus Q_0) \\oplus 1 \\end{pmatrix} } $$", "id": "3641646"}, {"introduction": "Moving from ideal logic to real-world implementation introduces critical physical constraints. This problem addresses a common and crucial issue in high-speed digital design: timing violations. You will analyze a hold-time violation in a synchronous pipeline and evaluate two practical solutions—buffer insertion and retiming—quantifying their impact on both timing slack and power consumption. This exercise provides a window into the essential trade-offs that hardware designers and computer architects face when optimizing for performance and efficiency [@problem_id:3641571].", "problem": "A synchronous pipeline in a single clock domain uses two edge-triggered D flip-flops (DFFs), denoted as a launch DFF and a capture DFF. The combinational logic between them is implemented with standard-cell gates. The launch DFF and capture DFF experience a nonzero clock skew. A hold-time violation has been detected on the path from the launch DFF to the capture DFF, and two alternative mitigation strategies are considered: inserting delay buffers on the data path or moving the flip-flop boundary (retiming a gate cluster from the next pipeline stage into the current stage). You must compute the resulting hold slack under each strategy and the corresponding change in dynamic power relative to the original, pre-fix design.\n\nAssume the following device and path characteristics:\n- Launch DFF clock-to-output minimum delay is $t_{\\mathrm{cq,min}} = 30\\,\\mathrm{ps}$ and maximum delay is $t_{\\mathrm{cq,max}} = 80\\,\\mathrm{ps}$.\n- Capture DFF hold time requirement is $t_{\\mathrm{hold}} = 60\\,\\mathrm{ps}$ and setup time requirement is $t_{\\mathrm{setup}} = 100\\,\\mathrm{ps}$.\n- The combinational logic between the two DFFs has minimum delay $t_{\\mathrm{pd,min}} = 15\\,\\mathrm{ps}$ and maximum delay $t_{\\mathrm{pd,max}} = 220\\,\\mathrm{ps}$.\n- The clock arrives at the capture DFF later than at the launch DFF with a skew of $t_{\\mathrm{skew}} = +20\\,\\mathrm{ps}$.\n- The clock period is $T = 1\\,\\mathrm{ns}$.\n\nTwo mitigation strategies are evaluated:\n1) Insert $n$ identical delay buffers into the data path. Each buffer contributes a minimum delay of $12\\,\\mathrm{ps}$ and a maximum delay of $12\\,\\mathrm{ps}$. Each buffer exhibits an effective switching capacitance of $C_{b} = 100\\,\\mathrm{fF}$ under a data-path activity factor of $\\alpha_{b} = 0.25$. The supply voltage is $V = 0.8\\,\\mathrm{V}$ and the clock frequency is $f = 1\\,\\mathrm{GHz}$. Choose the smallest integer $n$ that yields a strictly positive hold slack with a margin of at least $10\\,\\mathrm{ps}$.\n2) Move a gate cluster across the capture DFF boundary (retiming) so that the cluster is now included in the data path between the launch and capture DFFs. The moved cluster adds $46\\,\\mathrm{ps}$ to the data-path minimum delay and $50\\,\\mathrm{ps}$ to the data-path maximum delay. The retiming increases the effective wire capacitance driven by the launch-stage logic by $\\Delta C_{\\mathrm{wire}} = 60\\,\\mathrm{fF}$. This wire previously toggled in the next stage with activity factor $\\alpha_{\\mathrm{after}} = 0.15$, but after retiming it toggles in the current stage with activity factor $\\alpha_{\\mathrm{before}} = 0.25$. The supply voltage and frequency are the same as above. Ignore any other power changes in the moved gates themselves.\n\nUse the fundamental definitions of hold and setup constraints and the well-tested dynamic power relation based on activity factor, capacitance, supply voltage, and frequency. Compute:\n- The new hold slack after buffer insertion.\n- The new hold slack after retiming.\n- The total incremental dynamic power due to buffer insertion, relative to the original design.\n- The total incremental dynamic power due to retiming, relative to the original design.\n\nExpress both slacks in $\\mathrm{s}$ and both powers in $\\mathrm{W}$. Round all four quantities to four significant figures. Provide your final answer as a single row matrix in the order: $[$hold slack after buffers, hold slack after retiming, incremental power with buffers, incremental power with retiming$]$.", "solution": "The hold time constraint ensures that a data signal remains stable for a minimum duration, $t_{\\mathrm{hold}}$, after the capturing clock edge. This prevents the data from the current cycle from arriving too quickly and corrupting data from the previous cycle. The hold constraint is a check on the shortest possible path delay. The hold slack, $t_{\\mathrm{slack,hold}}$, is the margin by which this constraint is met:\n$$t_{\\mathrm{slack,hold}} = (t_{\\mathrm{cq,min}} + t_{\\mathrm{pd,min}}) - (t_{\\mathrm{skew}} + t_{\\mathrm{hold}})$$\nThe dynamic power consumption, $P_{\\mathrm{dyn}}$, of a charging/discharging capacitance $C$ is given by the formula:\n$$P_{\\mathrm{dyn}} = \\alpha C V^2 f$$\nwhere $\\alpha$ is the activity factor, $V$ is the supply voltage, and $f$ is the clock frequency.\n\nFirst, we calculate the hold slack of the original design to confirm the violation. Using the provided values:\n$t_{\\mathrm{cq,min}} = 30\\,\\mathrm{ps}$, $t_{\\mathrm{pd,min}} = 15\\,\\mathrm{ps}$, $t_{\\mathrm{skew}} = 20\\,\\mathrm{ps}$, and $t_{\\mathrm{hold}} = 60\\,\\mathrm{ps}$.\n$$t_{\\mathrm{slack,hold,orig}} = (30\\,\\mathrm{ps} + 15\\,\\mathrm{ps}) - (20\\,\\mathrm{ps} + 60\\,\\mathrm{ps}) = 45\\,\\mathrm{ps} - 80\\,\\mathrm{ps} = -35\\,\\mathrm{ps}$$\nA negative slack of $-35\\,\\mathrm{ps}$ confirms the hold-time violation.\n\nNow, we evaluate the two mitigation strategies.\n\n**Strategy 1: Buffer Insertion**\n\n1.  Calculate the new hold slack.\n    This strategy involves inserting $n$ delay buffers, each adding a minimum delay of $t_{\\mathrm{buf,min}} = 12\\,\\mathrm{ps}$ to the data path. The new hold slack, $t'_{\\mathrm{slack,hold}}$, is:\n    $$t'_{\\mathrm{slack,hold}} = (t_{\\mathrm{cq,min}} + t_{\\mathrm{pd,min}} + n \\cdot t_{\\mathrm{buf,min}}) - (t_{\\mathrm{skew}} + t_{\\mathrm{hold}}) = t_{\\mathrm{slack,hold,orig}} + n \\cdot t_{\\mathrm{buf,min}}$$\n    The requirement is for a strictly positive hold slack with a margin of at least $10\\,\\mathrm{ps}$, so $t'_{\\mathrm{slack,hold}} \\ge 10\\,\\mathrm{ps}$.\n    $$-35\\,\\mathrm{ps} + n \\cdot 12\\,\\mathrm{ps} \\ge 10\\,\\mathrm{ps}$$\n    $$n \\cdot 12\\,\\mathrm{ps} \\ge 45\\,\\mathrm{ps}$$\n    $$n \\ge \\frac{45}{12} = 3.75$$\n    Since $n$ must be an integer, the smallest value is $n=4$. With $n=4$ buffers, the resulting hold slack is:\n    $$t'_{\\mathrm{slack,hold}} = -35\\,\\mathrm{ps} + 4 \\cdot 12\\,\\mathrm{ps} = -35\\,\\mathrm{ps} + 48\\,\\mathrm{ps} = 13\\,\\mathrm{ps} = 1.3 \\times 10^{-11}\\,\\mathrm{s}$$\n    Rounding to four significant figures gives $1.300 \\times 10^{-11}\\,\\mathrm{s}$.\n\n2.  Calculate the incremental dynamic power.\n    The incremental power is the sum of the dynamic power consumed by the $n=4$ added buffers.\n    $$\\Delta P_{\\mathrm{buf}} = n \\cdot (\\alpha_b C_b V^2 f)$$\n    Using the given values: $n=4$, $\\alpha_b = 0.25$, $C_b = 100\\,\\mathrm{fF} = 100 \\times 10^{-15}\\,\\mathrm{F}$, $V = 0.8\\,\\mathrm{V}$, and $f = 1\\,\\mathrm{GHz} = 1 \\times 10^9\\,\\mathrm{Hz}$.\n    $$\\Delta P_{\\mathrm{buf}} = 4 \\cdot (0.25) \\cdot (100 \\times 10^{-15}\\,\\mathrm{F}) \\cdot (0.8\\,\\mathrm{V})^2 \\cdot (1 \\times 10^9\\,\\mathrm{Hz})$$\n    $$\\Delta P_{\\mathrm{buf}} = 1 \\cdot (100 \\times 10^{-15}) \\cdot (0.64) \\cdot (10^9)\\,\\mathrm{W} = 64 \\times 10^{-6}\\,\\mathrm{W} = 6.4 \\times 10^{-5}\\,\\mathrm{W}$$\n    Rounding to four significant figures gives $6.400 \\times 10^{-5}\\,\\mathrm{W}$.\n\n**Strategy 2: Retiming**\n\n1.  Calculate the new hold slack.\n    Retiming adds a minimum delay of $\\Delta t_{\\mathrm{pd,min}} = 46\\,\\mathrm{ps}$ to the data path. The new minimum path delay becomes $t''_{\\mathrm{pd,min}} = t_{\\mathrm{pd,min}} + \\Delta t_{\\mathrm{pd,min}} = 15\\,\\mathrm{ps} + 46\\,\\mathrm{ps} = 61\\,\\mathrm{ps}$. The new hold slack is:\n    $$t''_{\\mathrm{slack,hold}} = (t_{\\mathrm{cq,min}} + t''_{\\mathrm{pd,min}}) - (t_{\\mathrm{skew}} + t_{\\mathrm{hold}})$$\n    $$t''_{\\mathrm{slack,hold}} = (30\\,\\mathrm{ps} + 61\\,\\mathrm{ps}) - (20\\,\\mathrm{ps} + 60\\,\\mathrm{ps}) = 91\\,\\mathrm{ps} - 80\\,\\mathrm{ps} = 11\\,\\mathrm{ps} = 1.1 \\times 10^{-11}\\,\\mathrm{s}$$\n    Rounding to four significant figures gives $1.100 \\times 10^{-11}\\,\\mathrm{s}$.\n\n2.  Calculate the incremental dynamic power.\n    The power increase comes from a wire segment of capacitance $\\Delta C_{\\mathrm{wire}} = 60\\,\\mathrm{fF}$ moving from a pipeline stage where its activity factor was $\\alpha_{\\mathrm{after}} = 0.15$ to the current stage where its activity factor is $\\alpha_{\\mathrm{before}} = 0.25$.\n    The incremental power is the difference between the new and old power consumption of this wire.\n    $$\\Delta P_{\\mathrm{ret}} = P_{\\mathrm{new}} - P_{\\mathrm{old}} = (\\alpha_{\\mathrm{before}} \\Delta C_{\\mathrm{wire}} V^2 f) - (\\alpha_{\\mathrm{after}} \\Delta C_{\\mathrm{wire}} V^2 f)$$\n    $$\\Delta P_{\\mathrm{ret}} = (\\alpha_{\\mathrm{before}} - \\alpha_{\\mathrm{after}}) \\Delta C_{\\mathrm{wire}} V^2 f$$\n    Using the given values: $\\alpha_{\\mathrm{before}}=0.25$, $\\alpha_{\\mathrm{after}}=0.15$, $\\Delta C_{\\mathrm{wire}} = 60 \\times 10^{-15}\\,\\mathrm{F}$, $V=0.8\\,\\mathrm{V}$, $f=1 \\times 10^9\\,\\mathrm{Hz}$.\n    $$\\Delta P_{\\mathrm{ret}} = (0.25 - 0.15) \\cdot (60 \\times 10^{-15}\\,\\mathrm{F}) \\cdot (0.8\\,\\mathrm{V})^2 \\cdot (1 \\times 10^9\\,\\mathrm{Hz})$$\n    $$\\Delta P_{\\mathrm{ret}} = (0.10) \\cdot (60 \\times 10^{-15}) \\cdot (0.64) \\cdot (10^9)\\,\\mathrm{W} = 3.84 \\times 10^{-6}\\,\\mathrm{W}$$\n    Rounding to four significant figures gives $3.840 \\times 10^{-6}\\,\\mathrm{W}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.300 \\times 10^{-11} & 1.100 \\times 10^{-11} & 6.400 \\times 10^{-5} & 3.840 \\times 10^{-6}\n\\end{pmatrix}\n}\n$$", "id": "3641571"}]}