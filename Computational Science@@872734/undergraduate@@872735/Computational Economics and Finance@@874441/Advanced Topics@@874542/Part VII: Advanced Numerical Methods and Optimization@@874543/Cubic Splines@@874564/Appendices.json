{"hands_on_practices": [{"introduction": "To truly understand cubic splines, it's best to start by building one from the ground up. This exercise walks you through the fundamental mechanics of constructing a natural cubic spline for a simple set of data points. By comparing the result with a basic piecewise linear interpolation, you will gain a hands-on appreciation for how the spline's mathematical properties create a smoother, more 'natural' curve, laying the groundwork for its use in more complex modeling scenarios. [@problem_id:2164998]", "problem": "An engineer is modeling the shape of a thin, flexible rod that is constrained to pass through three points in a 2D Cartesian plane: $P_0=(-1, 1)$, $P_1=(0, 0)$, and $P_2=(1, 1)$. Two simple models are proposed to estimate the rod's vertical position, $y$, at other horizontal locations, $x$.\n\nModel A is a piecewise linear interpolant, which connects the specified points with straight line segments.\nModel B is a natural cubic spline, which ensures the curve is smooth by matching first and second derivatives at the interior points, and has zero second derivatives at the endpoints.\n\nCalculate the vertical position of the rod at $x=0.5$ as predicted by both Model A and Model B. Let these values be $y_A$ and $y_B$, respectively. Present your answer as a pair of exact fractions $(y_A, y_B)$.", "solution": "We label the nodes as $x_{0}=-1$, $x_{1}=0$, $x_{2}=1$ with corresponding values $y_{0}=1$, $y_{1}=0$, $y_{2}=1$.\n\nModel A (piecewise linear interpolant): For $x \\in [x_{1},x_{2}]$, the line through $(0,0)$ and $(1,1)$ has slope\n$$\nm=\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}=\\frac{1-0}{1-0}=1,\n$$\nso the interpolant is\n$$\ny(x)=y_{1}+m(x-x_{1})=0+1\\cdot(x-0)=x.\n$$\nEvaluating at $x=\\frac{1}{2}$ gives\n$$\ny_{A}=y\\!\\left(\\frac{1}{2}\\right)=\\frac{1}{2}.\n$$\n\nModel B (natural cubic spline): Let $M_{i}=S''(x_{i})$. Natural end conditions give $M_{0}=0$ and $M_{2}=0$. With $h_{0}=x_{1}-x_{0}=1$ and $h_{1}=x_{2}-x_{1}=1$, the cubic spline system at the interior node $i=1$ is\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right).\n$$\nSubstituting the values,\n$$\n1\\cdot 0+2(1+1)M_{1}+1\\cdot 0=6\\left(\\frac{1-0}{1}-\\frac{0-1}{1}\\right)=6(1-(-1))=12,\n$$\nso\n$$\n4M_{1}=12 \\quad \\Rightarrow \\quad M_{1}=3.\n$$\nOn the interval $[x_{1},x_{2}]=[0,1]$, the spline is\n$$\nS(x)=\\frac{M_{1}}{6h_{1}}(x_{2}-x)^{3}+\\frac{M_{2}}{6h_{1}}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\nWith $h_{1}=1$, $M_{1}=3$, $M_{2}=0$, $y_{1}=0$, and $y_{2}=1$, this simplifies to\n$$\nS(x)=\\frac{3}{6}(1-x)^{3}+0+\\left(0-\\frac{3}{6}\\right)(1-x)+\\left(1-0\\right)x\n=\\frac{1}{2}(1-x)^{3}-\\frac{1}{2}(1-x)+x.\n$$\nExpanding and combining like terms,\n$$\nS(x)=\\frac{1}{2}-\\frac{3}{2}x+\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}-\\frac{1}{2}+\\frac{1}{2}x+x\n=\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}.\n$$\nEvaluating at $x=\\frac{1}{2}$ gives\n$$\ny_{B}=S\\!\\left(\\frac{1}{2}\\right)=\\frac{3}{2}\\left(\\frac{1}{2}\\right)^{2}-\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{3}\n=\\frac{3}{2}\\cdot\\frac{1}{4}-\\frac{1}{2}\\cdot\\frac{1}{8}\n=\\frac{3}{8}-\\frac{1}{16}\n=\\frac{5}{16}.\n$$\n\nThus, the required pair is $\\left(\\frac{1}{2},\\frac{5}{16}\\right)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{5}{16}\\end{pmatrix}}$$", "id": "2164998"}, {"introduction": "The mathematical requirements for a cubic spline—particularly its continuity properties—are not just abstract rules; they have profound economic implications. This next practice explores what happens when these rules are broken, specifically focusing on the continuity of the first derivative ($C^1$). By analyzing a piecewise function that fails this condition, you will discover the direct link between a non-smooth yield curve and an economically implausible, discontinuous instantaneous forward rate curve, highlighting why smoothness is a critical feature for financial models. [@problem_id:2386597]", "problem": "You are fitting a term structure of continuously compounded zero-coupon yields using a piecewise cubic function intended as a cubic spline on the maturity domain $[0,2]$ (in years), with a single knot at $t=1$. Consider the following candidate function $S:[0,2]\\to \\mathbb{R}$ defined by\n$$\nS(t)=\n\\begin{cases}\nt^3, & t\\in[0,1],\\\\\nt^3 + (t-1), & t\\in(1,2].\n\\end{cases}\n$$\nInterpret $y(t)\\equiv S(t)$ as the continuously compounded zero rate (per year) for maturity $t>0$. The discount function $D(t)$ associated with $y(t)$ is defined by\n$$\nD(t) \\equiv \\exp\\!\\Big(-\\int_0^t f(u)\\,du\\Big),\n$$\nwhere $f(t)$ is the instantaneous forward rate, and the continuously compounded zero rate is defined by\n$$\ny(t) \\equiv -\\frac{1}{t}\\ln D(t), \\quad t>0.\n$$\nWhich option correctly characterizes both the smoothness of $S(t)$ at the knot and the economic implication for the implied instantaneous forward rate curve $f(t)$ constructed from $y(t)$ via the above definitions?\n\nA. $S(t)$ is $C^0$ but not $C^1$ at $t=1$. The implied $f(t)$ has a jump discontinuity at $t=1$ of magnitude equal to the one-sided derivative jump of $y(t)$ at $t=1$, here an upward jump of size $1$, implying an abrupt, economically implausible spike in the marginal discount rate at $t=1$ in the absence of a known discrete event.\n\nB. $S(t)$ is $C^1$ but not $C^2$ at $t=1$. The implied $f(t)$ is continuous at $t=1$ but exhibits a kink, so there is no abrupt change in the marginal discount rate.\n\nC. $S(t)$ fails $C^0$ continuity at $t=1$, so $D(t)$ is discontinuous at $t=1$, violating the absence-of-arbitrage condition, and $f(t)$ is not well-defined at $t=1$.\n\nD. $S(t)$ is $C^0$ but not $C^1$ at $t=1$. However, because $y(t)$ maps to $D(t)$ through an integral, the implied $f(t)$ remains continuous at $t=1$; any kink in $y(t)$ is smoothed out and has no implication for discontinuities in $f(t)$.\n\nE. $S(t)$ is $C^0$ but not $C^1$ at $t=1$. The implied $f(t)$ contains a Dirac delta $\\delta$ contribution at $t=1$ but has no jump; the integral relation pushes the non-smoothness into an impulse rather than a step in $f(t)$.", "solution": "The problem statement must first be validated for scientific and logical consistency before any attempt at a solution is made.\n\nThe problem provides the following definitions and functions:\nA candidate function for the term structure of zero-coupon yields, $S(t)$, is defined on the domain $t \\in [0,2]$ with a knot at $t=1$:\n$$\nS(t)=\n\\begin{cases}\nS_1(t) = t^3, & t\\in[0,1],\\\\\nS_2(t) = t^3 + (t-1), & t\\in(1,2].\n\\end{cases}\n$$\nThe continuously compounded zero rate is identified with this function: $y(t) \\equiv S(t)$.\nThe discount function $D(t)$ is defined in terms of the instantaneous forward rate $f(t)$:\n$$\nD(t) \\equiv \\exp\\!\\Big(-\\int_0^t f(u)\\,du\\Big)\n$$\nThe zero rate $y(t)$ is related to the discount function $D(t)$ by:\n$$\ny(t) \\equiv -\\frac{1}{t}\\ln D(t), \\quad t>0.\n$$\nThe problem asks to characterize the smoothness of $S(t)$ at the knot $t=1$ and the economic implications for the implied instantaneous forward rate curve $f(t)$.\n\nThe provided definitions are standard in the theory of interest rates. From the definition of $y(t)$, we can write $\\ln D(t) = -t \\cdot y(t)$. Substituting this into the definition of $D(t)$ and taking logarithms gives $-t \\cdot y(t) = -\\int_0^t f(u) du$, or $t \\cdot y(t) = \\int_0^t f(u) du$.\nTo find the instantaneous forward rate $f(t)$ from the zero rate $y(t)$, we differentiate this relation with respect to $t$ using the Fundamental Theorem of Calculus:\n$$\n\\frac{d}{dt} [t \\cdot y(t)] = f(t)\n$$\nThe problem is well-defined, objectively stated, and scientifically grounded in standard financial mathematics. The function $S(t)$ is a simple piecewise polynomial, suitable for a formal analysis. The magnitudes of the yields produced by $S(t)$ (e.g., $S(1) = 1$ or $100\\%$) are not typical for a real-world economy, but this does not invalidate the mathematical structure of the problem, which is a formal exercise in analyzing function properties. The problem is valid.\n\nWe proceed to the solution.\n\nFirst, we analyze the smoothness of $S(t)$ at the knot $t=1$.\nThe function is defined as $S(t) = y(t)$.\nFor $t \\in [0,1]$, $S_1(t) = t^3$.\nFor $t \\in (1,2]$, $S_2(t) = t^3 + t - 1$.\n\nWe assess continuity of the function, or $C^0$ continuity. We evaluate the left-hand and right-hand limits at $t=1$:\n$$\n\\lim_{t \\to 1^-} S(t) = \\lim_{t \\to 1^-} t^3 = 1^3 = 1\n$$\n$$\n\\lim_{t \\to 1^+} S(t) = \\lim_{t \\to 1^+} (t^3 + t - 1) = 1^3 + 1 - 1 = 1\n$$\nThe value at the knot is $S(1) = 1^3 = 1$. Since the left-hand limit, right-hand limit, and the function value are all equal to $1$, the function $S(t)$ is continuous at $t=1$. It is $C^0$.\n\nNext, we assess continuity of the first derivative, or $C^1$ continuity. We first find the derivatives of the pieces of $S(t)$:\nFor $t \\in [0,1)$, $S'(t) = S_1'(t) = \\frac{d}{dt}(t^3) = 3t^2$.\nFor $t \\in (1,2]$, $S'(t) = S_2'(t) = \\frac{d}{dt}(t^3 + t - 1) = 3t^2 + 1$.\n\nNow, we evaluate the left-hand and right-hand limits of the derivative at $t=1$:\n$$\nS'(1^-) = \\lim_{t \\to 1^-} S'(t) = \\lim_{t \\to 1^-} 3t^2 = 3(1)^2 = 3\n$$\n$$\nS'(1^+) = \\lim_{t \\to 1^+} S'(t) = \\lim_{t \\to 1^+} (3t^2 + 1) = 3(1)^2 + 1 = 4\n$$\nSince $S'(1^-) \\neq S'(1^+)$, the first derivative $S'(t)$ is discontinuous at $t=1$. Therefore, the function $S(t)$ is not $C^1$ at $t=1$.\nIn summary, $S(t)$ is $C^0$ but not $C^1$ at $t=1$.\n\nSecond, we analyze the implied instantaneous forward rate curve $f(t)$.\nFrom the relation $f(t) = \\frac{d}{dt}[t \\cdot y(t)]$, we compute $f(t)$ for each piece.\nFor $t \\in [0,1)$: $y(t) = t^3$. The product is $t \\cdot y(t) = t \\cdot t^3 = t^4$.\nThen $f(t) = \\frac{d}{dt}(t^4) = 4t^3$.\n\nFor $t \\in (1,2]$: $y(t) = t^3 + t - 1$. The product is $t \\cdot y(t) = t(t^3 + t - 1) = t^4 + t^2 - t$.\nThen $f(t) = \\frac{d}{dt}(t^4 + t^2 - t) = 4t^3 + 2t - 1$.\n\nSo the instantaneous forward rate is given by the piecewise function:\n$$\nf(t)=\n\\begin{cases}\n4t^3, & t\\in[0,1),\\\\\n4t^3 + 2t - 1, & t\\in(1,2].\n\\end{cases}\n$$\nWe check for continuity of $f(t)$ at $t=1$:\n$$\n\\lim_{t \\to 1^-} f(t) = \\lim_{t \\to 1^-} 4t^3 = 4(1)^3 = 4\n$$\n$$\n\\lim_{t \\to 1^+} f(t) = \\lim_{t \\to 1^+} (4t^3 + 2t - 1) = 4(1)^3 + 2(1) - 1 = 4 + 2 - 1 = 5\n$$\nSince the limits are not equal, $f(t)$ has a jump discontinuity at $t=1$. The magnitude of the jump is $\\Delta f |_1 = \\lim_{t \\to 1^+} f(t) - \\lim_{t \\to 1^-} f(t) = 5 - 4 = 1$. This is an upward jump.\n\nLet us relate this jump to the properties of $y(t)$.\nThe jump in $f(t)$ at a knot $t_k$ is given by $f(t_k^+) - f(t_k^-)$.\nUsing $f(t) = y(t) + t y'(t)$:\n$\\lim_{t \\to t_k^+} f(t) = \\lim_{t \\to t_k^+} (y(t) + t y'(t)) = y(t_k) + t_k y'(t_k^+)$ because $y(t)$ is continuous.\n$\\lim_{t \\to t_k^-} f(t) = \\lim_{t \\to t_k^-} (y(t) + t y'(t)) = y(t_k) + t_k y'(t_k^-)$.\nThe jump is $ (y(t_k) + t_k y'(t_k^+)) - (y(t_k) + t_k y'(t_k^-)) = t_k (y'(t_k^+) - y'(t_k^-))$.\nThe term $y'(t_k^+) - y'(t_k^-)$ is the jump in the derivative of the yield curve $y(t)$ at the knot.\nIn our problem, $t_k=1$. The jump in $y'(t)$ is $y'(1^+) - y'(1^-) = 4-3=1$.\nThe jump in $f(t)$ is therefore $1 \\cdot (4-3) = 1$. This matches our direct calculation.\n\nThe economic implication is that the instantaneous forward rate, which represents the marginal rate for borrowing or lending at a future time $t$, experiences an abrupt, discrete jump. In a functioning market without a scheduled major economic event or announcement at that specific maturity, such a feature is considered highly artificial and economically implausible. This indicates a flaw in the choice of the yield curve model.\n\nNow we evaluate each option.\n\nA. $S(t)$ is $C^0$ but not $C^1$ at $t=1$. The implied $f(t)$ has a jump discontinuity at $t=1$ of magnitude equal to the one-sided derivative jump of $y(t)$ at $t=1$, here an upward jump of size $1$, implying an abrupt, economically implausible spike in the marginal discount rate at $t=1$ in the absence of a known discrete event.\n- \"$S(t)$ is $C^0$ but not $C^1$ at $t=1$.\" Correct, as derived.\n- \"The implied $f(t)$ has a jump discontinuity at $t=1$.\" Correct.\n- \"of magnitude equal to the one-sided derivative jump of $y(t)$ at $t=1$.\" Correct. The jump in $f(t)$ is $1$. The jump in $y'(t)$ is $y'(1^+) - y'(1^-) = 4-3=1$. The magnitudes are equal because the knot is at $t=1$.\n- \"here an upward jump of size $1$.\" Correct, we calculated the jump as $5-4=1$.\n- \"implying an abrupt, economically implausible spike...\". Correct, this is the standard economic interpretation.\nThis statement is entirely correct.\n\nB. $S(t)$ is $C^1$ but not $C^2$ at $t=1$. The implied $f(t)$ is continuous at $t=1$ but exhibits a kink, so there is no abrupt change in the marginal discount rate.\n- \"$S(t)$ is $C^1$ but not $C^2$ at $t=1$.\" Incorrect. We proved $S(t)$ is not $C^1$.\n\nC. $S(t)$ fails $C^0$ continuity at $t=1$, so $D(t)$ is discontinuous at $t=1$, violating the absence-of-arbitrage condition, and $f(t)$ is not well-defined at $t=1$.\n- \"$S(t)$ fails $C^0$ continuity at $t=1$.\" Incorrect. We proved $S(t)$ is $C^0$.\n\nD. $S(t)$ is $C^0$ but not $C^1$ at $t=1$. However, because $y(t)$ maps to $D(t)$ through an integral, the implied $f(t)$ remains continuous at $t=1$; any kink in $y(t)$ is smoothed out and has no implication for discontinuities in $f(t)$.\n- \"$S(t)$ is $C^0$ but not $C^1$ at $t=1$.\" Correct.\n- \"because $y(t)$ maps to $D(t)$ through an integral, the implied $f(t)$ remains continuous\". The premise is confused and the conclusion is false. The mapping from $y(t)$ to $f(t)$ is via differentiation, $f(t) = \\frac{d}{dt}[t \\cdot y(t)]$, not integration. Differentiation does not smooth functions; it typically makes them less smooth. We explicitly showed $f(t)$ is discontinuous. Incorrect.\n\nE. $S(t)$ is $C^0$ but not $C^1$ at $t=1$. The implied $f(t)$ contains a Dirac delta $\\delta$ contribution at $t=1$ but has no jump; the integral relation pushes the non-smoothness into an impulse rather than a step in $f(t)$.\n- \"$S(t)$ is $C^0$ but not $C^1$ at $t=1$.\" Correct.\n- \"The implied $f(t)$ contains a Dirac delta $\\delta$ contribution at $t=1$.\" Incorrect. A Dirac delta contribution in $f(t)$ would arise if the function being differentiated, $t \\cdot y(t)$, had a jump discontinuity. Here, $t \\cdot y(t)$ is continuous, but has a kink (non-differentiable point). Its derivative has a jump discontinuity, not a Dirac delta.\n- \"but has no jump\". Incorrect. We proved it has a jump.\n\nBased on this rigorous analysis, only option A is correct.", "answer": "$$\\boxed{A}$$", "id": "2386597"}, {"introduction": "Having established the mechanics and importance of spline properties, we now turn to a practical comparison that demonstrates their power. This computational exercise pits cubic splines against high-degree polynomial interpolation, a common alternative, in a scenario designed to reveal its weaknesses. You will observe the infamous Runge's phenomenon, where polynomials develop wild oscillations, and see how cubic splines provide a far more stable and reliable fit, cementing their status as a robust tool for data interpolation in computational finance. [@problem_id:2386520]", "problem": "Consider the function $v(k)$ mapping standardized log-moneyness $k$ to an implied volatility level, defined by\n$$\nv(k) \\equiv \\alpha + \\frac{\\beta}{1 + \\gamma k^2},\n$$\nwith parameters $\\alpha = 0.2$, $\\beta = 0.1$, and $\\gamma = 25$. For a given integer $n \\ge 2$, define a data set of $n$ equally spaced nodes on the closed interval $[-1,1]$ as $k_i = -1 + \\frac{2(i-1)}{n-1}$ for $i \\in \\{1,2,\\dots,n\\}$, and observed values $y_i = v(k_i)$.\n\nFor each specified $n$, consider two interpolants constructed from the same $\\{(k_i,y_i)\\}_{i=1}^n$:\n1. $p_n(k)$ is the unique polynomial interpolant of degree at most $n-1$ satisfying $p_n(k_i) = y_i$ for all $i \\in \\{1,2,\\dots,n\\}$.\n2. $s_n(k)$ is the natural cubic spline interpolant with knots at the nodes $\\{k_i\\}_{i=1}^n$, satisfying $s_n(k_i) = y_i$ for all $i \\in \\{1,2,\\dots,n\\}$, being twice continuously differentiable on $[-1,1]$, piecewise cubic between consecutive knots, and obeying the natural boundary conditions $s_n''(-1) = 0$ and $s_n''(1) = 0$.\n\nFor an evaluation grid $\\{x_j\\}_{j=1}^m$ contained in $[-1,1]$, define the root mean squared error (RMSE) of an approximant $a(k)$ to $v(k)$ as\n$$\n\\mathrm{RMSE}(a) \\equiv \\left( \\frac{1}{m} \\sum_{j=1}^m \\left[a(x_j) - v(x_j)\\right]^2 \\right)^{1/2},\n$$\nand the maximum absolute error as\n$$\n\\mathrm{MAX}(a) \\equiv \\max_{1 \\le j \\le m} \\left|a(x_j) - v(x_j)\\right|.\n$$\n\nUsing the definition above, evaluate the following four test cases:\n\n- Case A (general case): $n = 9$, evaluation grid size $m = 1001$ with equidistant points on $[-1,1]$.\n- Case B (general case): $n = 17$, evaluation grid size $m = 1001$ with equidistant points on $[-1,1]$.\n- Case C (boundary stressing high degree): $n = 25$, evaluation grid size $m = 1001$ with equidistant points on $[-1,1]$.\n- Case D (interpolation identity check): $n = 17$, evaluation grid consisting exactly of the $n$ nodes, i.e., $m = n$ and $\\{x_j\\}_{j=1}^m = \\{k_i\\}_{i=1}^n$.\n\nFor each case, compute four quantities in the following order:\n1. $\\mathrm{RMSE}(p_n)$,\n2. $\\mathrm{RMSE}(s_n)$,\n3. $\\mathrm{MAX}(p_n)$,\n4. $\\mathrm{MAX}(s_n)$.\n\nFinal output format requirement: Your program should produce a single line of output containing a comma-separated list of four-element lists, one per test case, enclosed in square brackets. Specifically, the output must be\n$$\n\\left[\\left[r_1,r_2,r_3,r_4\\right],\\left[r_1',r_2',r_3',r_4'\\right],\\left[r_1'',r_2'',r_3'',r_4''\\right],\\left[r_1''',r_2''',r_3''',r_4'''\\right]\\right],\n$$\nwhere each $r_\\cdot$ is a real number, and the four inner lists correspond respectively to Cases A, B, C, and D in the order stated above. All numerical results must be expressed as real numbers without units. The output must appear exactly on a single line as specified, for example as $[ [\\cdots], [\\cdots], [\\cdots], [\\cdots] ]$ but without any additional explanatory text, and without any percentage signs or angle units.", "solution": "The problem statement has been rigorously validated and is determined to be sound. It is scientifically grounded in the field of numerical analysis, well-posed, objective, and contains all necessary information for a unique solution. No inconsistencies, contradictions, or ambiguities are present. We may therefore proceed with the solution.\n\nThe problem requires a comparative analysis of two interpolation schemes—global polynomial interpolation and piecewise cubic spline interpolation—for approximating a given function. The function to be approximated models an implied volatility curve and is defined as:\n$$\nv(k) \\equiv \\alpha + \\frac{\\beta}{1 + \\gamma k^2}\n$$\nwith given parameters $\\alpha = 0.2$, $\\beta = 0.1$, and $\\gamma = 25$. This is a rational function, which is infinitely differentiable ($C^\\infty$) on the entire real line. However, its analytic continuation into the complex plane has poles at $k = \\pm i/\\sqrt{\\gamma} = \\pm i/5 = \\pm 0.2i$. The proximity of these poles to the interpolation interval $[-1, 1]$ is a critical factor influencing the convergence characteristics of polynomial interpolants.\n\nFor a given number of nodes $n$, we are provided with a data set $\\{(k_i, y_i)\\}_{i=1}^n$, where the nodes $k_i = -1 + \\frac{2(i-1)}{n-1}$ are uniformly spaced on $[-1, 1]$, and the values are $y_i = v(k_i)$.\n\nThe first approximant, $p_n(k)$, is the unique interpolating polynomial of degree at most $n-1$. For such a polynomial to exist and be unique, the $k_i$ must be distinct, which is guaranteed by their definition. While a unique solution exists, it is a well-established result in approximation theory that for functions like $v(k)$ with singularities close to the real interval, high-degree polynomial interpolation on equidistant nodes leads to large oscillations, especially near the endpoints. This behavior is known as Runge's phenomenon. To compute this polynomial, we shall employ a numerically stable method, the Barycentric interpolation formula, which is preferable to constructing and solving the ill-conditioned Vandermonde system for the monomial coefficients.\n\nThe second approximant, $s_n(k)$, is the natural cubic spline. This method constructs a piecewise cubic polynomial on each subinterval $[k_i, k_{i+1}]$. To ensure smoothness, the spline is required to be twice continuously differentiable ($C^2$) over the entire interval $[-1, 1]$. This is achieved by enforcing that the function values, first derivatives, and second derivatives of adjacent cubic pieces match at the interior knots. The system is closed by the \"natural\" boundary conditions, $s_n''(-1) = 0$ and $s_n''(1) = 0$. This setup leads to a well-conditioned, tridiagonal system of linear equations for the second derivatives at the knots, which can be solved efficiently and stably. Cubic splines are generally superior for data fitting and interpolation as they avoid the oscillatory behavior of high-degree polynomials.\n\nThe performance of each interpolant, $a(k) \\in \\{p_n(k), s_n(k)\\}$, is quantified using two error metrics evaluated on a discrete grid $\\{x_j\\}_{j=1}^m$:\n1.  Root Mean Squared Error: $\\mathrm{RMSE}(a) = \\left( \\frac{1}{m} \\sum_{j=1}^m [a(x_j) - v(x_j)]^2 \\right)^{1/2}$\n2.  Maximum Absolute Error: $\\mathrm{MAX}(a) = \\max_{1 \\le j \\le m} |a(x_j) - v(x_j)|$\n\nThe computational procedure for each test case is as follows:\n1.  For a given $n$, establish the set of $n$ interpolation nodes $\\{k_i\\}$ and compute the corresponding values $\\{y_i = v(k_i)\\}$.\n2.  Construct the polynomial interpolant $p_n(k)$ using the Barycentric form from the set $\\{(k_i, y_i)\\}$.\n3.  Construct the natural cubic spline $s_n(k)$ from the same data set, imposing $s_n''(-1) = s_n''(1) = 0$.\n4.  Define the evaluation grid $\\{x_j\\}_{j=1}^m$ as specified for the test case.\n5.  Evaluate $v(x_j)$, $p_n(x_j)$, and $s_n(x_j)$ on the evaluation grid.\n6.  Compute the error vectors for both the polynomial and the spline.\n7.  Calculate the four required metrics: $\\mathrm{RMSE}(p_n)$, $\\mathrm{RMSE}(s_n)$, $\\mathrm{MAX}(p_n)$, and $\\mathrm{MAX}(s_n)$.\n\nFor Case C, with a high node count of $n=25$, we expect a significant manifestation of Runge's phenomenon, leading to large errors for $p_{25}(k)$. Conversely, the spline's error should decrease as $n$ increases. Case D serves as a fundamental check of correctness: since the evaluation grid coincides with the interpolation nodes, the error for both interpolants must be zero (or within machine epsilon), as $a(k_i) = y_i = v(k_i)$ by definition of interpolation. The following program implements this procedure.", "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import BarycentricInterpolator, CubicSpline\n\ndef solve():\n    \"\"\"\n    Computes and compares errors for polynomial and cubic spline interpolants.\n    \"\"\"\n    # Define parameters for the function v(k)\n    alpha = 0.2\n    beta = 0.1\n    gamma = 25.0\n\n    def v(k: np.ndarray) -> np.ndarray:\n        \"\"\"\n        The target function to be interpolated.\n        v(k) = alpha + beta / (1 + gamma * k^2)\n        \"\"\"\n        return alpha + beta / (1.0 + gamma * np.power(k, 2))\n\n    # Define the four test cases from the problem statement\n    # Each tuple is (n, m, grid_type)\n    # grid_type 'equidistant': m points on [-1, 1]\n    # grid_type 'nodes': m=n points, evaluation grid is the interpolation nodes\n    test_cases = [\n        (9, 1001, 'equidistant'),    # Case A\n        (17, 1001, 'equidistant'),   # Case B\n        (25, 1001, 'equidistant'),   # Case C\n        (17, 17, 'nodes'),           # Case D\n    ]\n\n    all_results = []\n    \n    for n, m, grid_type in test_cases:\n        # Step 1: Generate interpolation data\n        # n equally spaced nodes on the closed interval [-1, 1]\n        k_nodes = np.linspace(-1.0, 1.0, n)\n        # Observed values y_i = v(k_i)\n        y_nodes = v(k_nodes)\n\n        # Step 2: Construct the interpolants\n        # p_n(k): unique polynomial interpolant of degree at most n-1\n        # Using Barycentric form for numerical stability\n        p_n = BarycentricInterpolator(k_nodes, y_nodes)\n\n        # s_n(k): natural cubic spline interpolant\n        # bc_type='natural' sets the second derivatives at endpoints to zero\n        s_n = CubicSpline(k_nodes, y_nodes, bc_type='natural')\n\n        # Step 3: Define the evaluation grid\n        if grid_type == 'equidistant':\n            x_grid = np.linspace(-1.0, 1.0, m)\n        elif grid_type == 'nodes':\n            x_grid = k_nodes\n        else:\n            raise ValueError(\"Invalid grid_type specified.\")\n\n        # Step 4: Evaluate the true function and interpolants on the grid\n        v_true = v(x_grid)\n        p_n_vals = p_n(x_grid)\n        s_n_vals = s_n(x_grid)\n        \n        # Step 5: Compute errors\n        errors_p = p_n_vals - v_true\n        errors_s = s_n_vals - v_true\n\n        # Step 6: Calculate the required error metrics\n        # RMSE\n        rmse_p = np.sqrt(np.mean(np.square(errors_p)))\n        rmse_s = np.sqrt(np.mean(np.square(errors_s)))\n        \n        # MAX\n        max_p = np.max(np.abs(errors_p))\n        max_s = np.max(np.abs(errors_s))\n\n        # Store the four computed quantities for the current case\n        case_results = [rmse_p, rmse_s, max_p, max_s]\n        all_results.append(case_results)\n\n    # Final Output Formatting:\n    # Build a list of strings, where each string represents an inner list, e.g., \"[r1,r2,r3,r4]\"\n    results_as_strings = [\n        f\"[{','.join(map(str, res))}]\" for res in all_results\n    ]\n    \n    # Join the list of strings with commas and enclose in the outermost brackets\n    final_output = f\"[{','.join(results_as_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2386520"}]}