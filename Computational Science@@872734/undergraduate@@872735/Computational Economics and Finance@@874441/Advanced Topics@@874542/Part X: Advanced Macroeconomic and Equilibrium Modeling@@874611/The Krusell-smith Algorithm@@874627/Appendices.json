{"hands_on_practices": [{"introduction": "The Krusell-Smith algorithm finds an equilibrium where agents' forecasts about the aggregate economy are, on average, correct. A crucial diagnostic in this process is analyzing the forecast error—the gap between the predicted aggregate capital and what actually materializes from agents' collective choices. This exercise provides a practical method for dissecting this aggregate error, attributing it to the saving behaviors of different wealth quintiles, which is a vital skill for understanding the heterogeneous drivers of aggregate dynamics. [@problem_id:2441773]", "problem": "Consider a heterogeneous-agent setting with a finite partition of the wealth distribution into five disjoint groups indexed by quintiles. Let the aggregate capital at date $t$ be $K_t > 0$. Each quintile $i \\in \\{1,2,3,4,5\\}$ holds a time-$t$ capital share $s_{i,t}$ satisfying $s_{i,t} \\ge 0$ and $\\sum_{i=1}^{5} s_{i,t} = 1$, and accumulates its capital to date $t+1$ by a realized gross accumulation factor $r_{i,t} > 0$. Therefore the aggregate actual next-period capital is\n$$\nK_{t+1}^{actual} \\equiv \\sum_{i=1}^{5} K_{i,t+1} = \\sum_{i=1}^{5} s_{i,t}\\, r_{i,t}\\, K_t = K_t \\sum_{i=1}^{5} s_{i,t}\\, r_{i,t}.\n$$\nSuppose a log-linear forecast law of motion for aggregate capital of the form\n$$\n\\log K_{t+1}^{forecast} = a_0 + a_1 \\log K_t + a_2 z_t,\n$$\nwhere $a_0, a_1, a_2 \\in \\mathbb{R}$ are given constants and $z_t \\in \\mathbb{R}$ is a given scalar aggregate shock at date $t$. Define the implied forecast gross factor\n$$\nG_t^{forecast} \\equiv \\frac{K_{t+1}^{forecast}}{K_t} = \\exp\\!\\big(a_0 + (a_1 - 1)\\log K_t + a_2 z_t\\big).\n$$\nThe forecast error for the law of motion is\n$$\n\\varepsilon_t \\equiv K_{t+1}^{actual} - K_{t+1}^{forecast}.\n$$\nDefine the contribution of quintile $i$ to the forecast error as\n$$\nc_{i,t} \\equiv K_{i,t+1} - s_{i,t}\\, K_t\\, G_t^{forecast} = K_t\\, s_{i,t}\\, \\big(r_{i,t} - G_t^{forecast}\\big),\n$$\nso that $\\sum_{i=1}^{5} c_{i,t} = \\varepsilon_t$ holds by construction.\n\nGiven the above definitions, write a program that, for each parameter set in the test suite below, computes the list of quintile contributions $\\big[c_{1,t}, c_{2,t}, c_{3,t}, c_{4,t}, c_{5,t}\\big]$.\n\nAll quantities are pure numbers without physical units.\n\nTest suite (each line specifies $\\big(K_t, a_0, a_1, a_2, z_t, \\{s_{i,t}\\}_{i=1}^{5}, \\{r_{i,t}\\}_{i=1}^{5}\\big)$):\n\n- Case A (general case):\n  - $K_t = 100.0$, $a_0 = 0.0$, $a_1 = 1.0$, $a_2 = 0.01$, $z_t = 1.0$,\n  - $\\{s_{i,t}\\} = [0.10,\\, 0.15,\\, 0.20,\\, 0.25,\\, 0.30]$,\n  - $\\{r_{i,t}\\} = [1.05,\\, 1.03,\\, 1.02,\\, 1.01,\\, 1.00]$.\n\n- Case B (zero forecast error by construction):\n  - $K_t = 250.0$, $a_0 = 0.0$, $a_1 = 1.0$, $a_2 = 0.0$, $z_t = 0.0$,\n  - $\\{s_{i,t}\\} = [0.05,\\, 0.10,\\, 0.15,\\, 0.30,\\, 0.40]$,\n  - $\\{r_{i,t}\\} = [1.0,\\, 1.0,\\, 1.0,\\, 1.0,\\, 1.0]$.\n\n- Case C (boundary with a zero share and negative shock):\n  - $K_t = 80.0$, $a_0 = 0.02$, $a_1 = 0.98$, $a_2 = -0.005$, $z_t = -1.0$,\n  - $\\{s_{i,t}\\} = [0.0,\\, 0.20,\\, 0.30,\\, 0.25,\\, 0.25]$,\n  - $\\{r_{i,t}\\} = [1.04,\\, 0.99,\\, 1.01,\\, 1.00,\\, 1.02]$.\n\nOutput specification:\n- For each case, output the list $\\big[c_{1,t}, c_{2,t}, c_{3,t}, c_{4,t}, c_{5,t}\\big]$ rounded to six decimal places.\n- Aggregate the three case results into a single list in the order A, B, C.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces, where each element is itself a bracketed list of five numbers rounded to six decimal places (for example, \"[[x11,x12,x13,x14,x15],[x21,x22,x23,x24,x25],[x31,x32,x33,x34,x35]]\").", "solution": "The problem as stated is subjected to rigorous validation before any attempt at a solution is made.\n\n**Step 1: Extract Givens**\n\nThe problem furnishes the following definitions, variables, and relationships:\n- Aggregate capital at time $t$: $K_t > 0$.\n- Number of quintiles: $5$.\n- Capital share of quintile $i$ at time $t$: $s_{i,t}$, with $s_{i,t} \\ge 0$ and $\\sum_{i=1}^{5} s_{i,t} = 1$.\n- Realized gross accumulation factor for quintile $i$ at time $t$: $r_{i,t} > 0$.\n- Aggregate actual next-period capital: $K_{t+1}^{\\text{actual}} = K_t \\sum_{i=1}^{5} s_{i,t}\\, r_{i,t}$.\n- Log-linear forecast law of motion for aggregate capital: $\\log K_{t+1}^{\\text{forecast}} = a_0 + a_1 \\log K_t + a_2 z_t$.\n- Coefficients of the law of motion: $a_0, a_1, a_2 \\in \\mathbb{R}$.\n- Aggregate shock at time $t$: $z_t \\in \\mathbb{R}$.\n- Implied forecast gross factor: $G_t^{\\text{forecast}} = \\frac{K_{t+1}^{\\text{forecast}}}{K_t} = \\exp\\!\\big(a_0 + (a_1 - 1)\\log K_t + a_2 z_t\\big)$.\n- Forecast error: $\\varepsilon_t = K_{t+1}^{\\text{actual}} - K_{t+1}^{\\text{forecast}}$.\n- Contribution of quintile $i$ to the forecast error: $c_{i,t} = K_t\\, s_{i,t}\\, \\big(r_{i,t} - G_t^{\\text{forecast}}\\big)$.\n\nThree test cases are provided with specific values for the set of parameters $\\big(K_t, a_0, a_1, a_2, z_t, \\{s_{i,t}\\}_{i=1}^{5}, \\{r_{i,t}\\}_{i=1}^{5}\\big)$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the required criteria:\n- **Scientifically Grounded**: The problem is set within the context of heterogeneous-agent macroeconomic models, specifically related to the Krusell-Smith algorithm, which is a standard tool in computational economics. The mathematical formalization is based on established economic modeling principles. It does not violate any scientific or mathematical laws.\n- **Well-Posed**: The problem is a direct computational task. For each test case, all necessary parameters are provided, and the formulas for the target quantities, $c_{i,t}$, are explicitly given. The calculation leads to a unique, stable, and meaningful numerical result for each quintile.\n- **Objective**: The problem is stated in precise, unambiguous mathematical language. There are no subjective, opinion-based, or non-formalizable components. The terms used are standard in the field.\n- **Complete and Consistent**: The setup is self-contained. The definitions are consistent with each other, for instance, it is correctly noted that $\\sum_{i=1}^{5} c_{i,t} = \\varepsilon_t$. The data provided for each test case is sufficient to perform the required computations. The condition $\\sum s_{i,t}=1$ is met for all cases.\n\n**Step 3: Verdict and Action**\n\nThe problem is well-defined, scientifically grounded, and computationally tractable. It is deemed **valid**. A solution will be provided.\n\nThe objective is to compute the list of quintile contributions to the forecast error, $\\big[c_{1,t}, c_{2,t}, c_{3,t}, c_{4,t}, c_{5,t}\\big]$, for each of the three supplied parameter sets. The procedure is a direct application of the definitions provided.\n\nFor each parameter set, the calculation proceeds in two stages:\n1.  Compute the implied forecast gross factor, $G_t^{\\text{forecast}}$, using the formula:\n    $$\n    G_t^{\\text{forecast}} = \\exp\\!\\big(a_0 + (a_1 - 1)\\log K_t + a_2 z_t\\big)\n    $$\n2.  For each quintile $i \\in \\{1,2,3,4,5\\}$, compute its contribution to the forecast error, $c_{i,t}$, using the formula:\n    $$\n    c_{i,t} = K_t\\, s_{i,t}\\, \\big(r_{i,t} - G_t^{\\text{forecast}}\\big)\n    $$\n\nThis procedure is now applied to each test case.\n\n**Case A:**\nGiven parameters: $K_t = 100.0$, $a_0 = 0.0$, $a_1 = 1.0$, $a_2 = 0.01$, $z_t = 1.0$, $\\{s_{i,t}\\} = [0.10, 0.15, 0.20, 0.25, 0.30]$, and $\\{r_{i,t}\\} = [1.05, 1.03, 1.02, 1.01, 1.00]$.\nFirst, compute $G_t^{\\text{forecast}}$:\n$$\nG_t^{\\text{forecast}} = \\exp\\big(0.0 + (1.0 - 1.0)\\log(100.0) + 0.01 \\cdot 1.0\\big) = \\exp(0.01) \\approx 1.01005017\n$$\nNext, compute $c_{i,t}$ for each quintile:\n- $c_{1,t} = 100.0 \\cdot 0.10 \\cdot (1.05 - 1.01005017) \\approx 0.399498$\n- $c_{2,t} = 100.0 \\cdot 0.15 \\cdot (1.03 - 1.01005017) \\approx 0.299248$\n- $c_{3,t} = 100.0 \\cdot 0.20 \\cdot (1.02 - 1.01005017) \\approx 0.198997$\n- $c_{4,t} = 100.0 \\cdot 0.25 \\cdot (1.01 - 1.01005017) \\approx -0.001254$\n- $c_{5,t} = 100.0 \\cdot 0.30 \\cdot (1.00 - 1.01005017) \\approx -0.301505$\nThe resulting list, rounded to six decimal places, is $[0.399498, 0.299248, 0.198997, -0.001254, -0.301505]$.\n\n**Case B:**\nGiven parameters: $K_t = 250.0$, $a_0 = 0.0$, $a_1 = 1.0$, $a_2 = 0.0$, $z_t = 0.0$, $\\{s_{i,t}\\} = [0.05, 0.10, 0.15, 0.30, 0.40]$, and $\\{r_{i,t}\\} = [1.0, 1.0, 1.0, 1.0, 1.0]$.\nFirst, compute $G_t^{\\text{forecast}}$:\n$$\nG_t^{\\text{forecast}} = \\exp\\big(0.0 + (1.0 - 1.0)\\log(250.0) + 0.0 \\cdot 0.0\\big) = \\exp(0.0) = 1.0\n$$\nSince $r_{i,t} = 1.0$ for all $i$ and $G_t^{\\text{forecast}} = 1.0$, the term $(r_{i,t} - G_t^{\\text{forecast}})$ is identically zero for all quintiles.\nTherefore, $c_{i,t} = 0.0$ for all $i \\in \\{1,2,3,4,5\\}$.\nThe resulting list is $[0.000000, 0.000000, 0.000000, 0.000000, 0.000000]$.\n\n**Case C:**\nGiven parameters: $K_t = 80.0$, $a_0 = 0.02$, $a_1 = 0.98$, $a_2 = -0.005$, $z_t = -1.0$, $\\{s_{i,t}\\} = [0.0, 0.20, 0.30, 0.25, 0.25]$, and $\\{r_{i,t}\\} = [1.04, 0.99, 1.01, 1.00, 1.02]$.\nFirst, compute $G_t^{\\text{forecast}}$:\n$$\nG_t^{\\text{forecast}} = \\exp\\big(0.02 + (0.98 - 1.0)\\log(80.0) + (-0.005) \\cdot (-1.0)\\big) = \\exp\\big(0.025 - 0.02\\log(80.0)\\big) \\approx 0.939281\n$$\nNext, compute $c_{i,t}$ for each quintile:\n- $c_{1,t} = 80.0 \\cdot 0.0 \\cdot (1.04 - 0.939281) = 0.000000$\n- $c_{2,t} = 80.0 \\cdot 0.20 \\cdot (0.99 - 0.939281) \\approx 0.811498$\n- $c_{3,t} = 80.0 \\cdot 0.30 \\cdot (1.01 - 0.939281) \\approx 1.697247$\n- $c_{4,t} = 80.0 \\cdot 0.25 \\cdot (1.00 - 0.939281) \\approx 1.214373$\n- $c_{5,t} = 80.0 \\cdot 0.25 \\cdot (1.02 - 0.939281) \\approx 1.614373$\nThe resulting list, rounded to six decimal places, is $[0.000000, 0.811498, 1.697247, 1.214373, 1.614373]$.\n\nThe final program will consolidate these results into the specified output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quintile contributions to the forecast error for a heterogeneous-agent model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (K_t, a_0, a_1, a_2, z_t, {s_i,t}, {r_i,t})\n        (100.0, 0.0, 1.0, 0.01, 1.0,\n         np.array([0.10, 0.15, 0.20, 0.25, 0.30]),\n         np.array([1.05, 1.03, 1.02, 1.01, 1.00])),\n\n        # Case B: (K_t, a_0, a_1, a_2, z_t, {s_i,t}, {r_i,t})\n        (250.0, 0.0, 1.0, 0.0, 0.0,\n         np.array([0.05, 0.10, 0.15, 0.30, 0.40]),\n         np.array([1.0, 1.0, 1.0, 1.0, 1.0])),\n\n        # Case C: (K_t, a_0, a_1, a_2, z_t, {s_i,t}, {r_i,t})\n        (80.0, 0.02, 0.98, -0.005, -1.0,\n         np.array([0.0, 0.20, 0.30, 0.25, 0.25]),\n         np.array([1.04, 0.99, 1.01, 1.00, 1.02])),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        K_t, a0, a1, a2, z_t, s_it, r_it = case\n\n        # Step 1: Compute the implied forecast gross factor, G_t^forecast.\n        # G_t^forecast = exp(a0 + (a1 - 1)*log(K_t) + a2*z_t)\n        log_K_t = np.log(K_t)\n        G_t_forecast = np.exp(a0 + (a1 - 1) * log_K_t + a2 * z_t)\n\n        # Step 2: Compute the contribution of each quintile to the forecast error.\n        # c_i,t = K_t * s_i,t * (r_i,t - G_t^forecast)\n        c_it = K_t * s_it * (r_it - G_t_forecast)\n        \n        all_results.append(c_it)\n\n    # Format the output as specified: a list of lists, with numbers rounded\n    # to six decimal places, no spaces.\n    case_results_str = []\n    for result_list in all_results:\n        # Format each number to '.6f' and join into a string \"[n1,n2,...]\"\n        formatted_numbers = [f\"{x:.6f}\" for x in result_list]\n        case_str = f\"[{','.join(formatted_numbers)}]\"\n        case_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    # Example: [[x1,x2],[y1,y2]]\n    final_output_str = f\"[{','.join(case_results_str)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2441773"}, {"introduction": "A fundamental design choice in implementing the Krusell-Smith algorithm is selecting the aggregate state variable that agents will forecast. Typically, this is the aggregate capital stock, $K_t$. This thought experiment challenges that convention by asking you to consider forecasting the price of capital, $q_t$, instead. By analyzing the consequences of this choice, you will uncover the deep connection between a model's economic assumptions—such as the presence or absence of investment adjustment costs—and the viability of a given state variable for forecasting. [@problem_id:2441720]", "problem": "Consider a heterogeneous-agent, incomplete-markets economy used to implement the Krusell–Smith algorithm. Time is discrete. Aggregate output is produced by a representative firm with technology $Y_t = Z_t K_t^{\\alpha} L_t^{1-\\alpha}$, where $Z_t$ is an aggregate productivity shock following a finite-state Markov chain, $K_t$ is the aggregate installed capital stock at the beginning of period $t$, $L_t$ is aggregate labor supplied inelastically, and $\\alpha \\in (0,1)$. Capital accumulates according to $K_{t+1} = (1-\\delta) K_t + I_t$, with depreciation rate $\\delta \\in (0,1)$. A competitive capital-goods sector transforms consumption $I_t$ into installed capital $I_t$ one-for-one within the period. There are no investment adjustment costs. Let $q_t$ denote the period-$t$ price, in units of the consumption good, of one unit of installed capital delivered within period $t$. Households can buy and sell installed capital at price $q_t$ and rent it to firms; factor markets are competitive.\n\nIn a standard implementation of the Krusell–Smith algorithm, agents approximate expectations needed for optimal saving by maintaining and updating a perceived law of motion for an aggregate variable such as $\\log K_{t+1}$ as a function of current aggregates. Suppose instead that agents maintain and update a perceived law of motion for $\\log q_{t+1}$ (again as a function of current aggregates) and use this to form the expectations in their intertemporal optimality conditions.\n\nIn this benchmark environment, which statement is correct about replacing a perceived law of motion for $\\log K_{t+1}$ with one for $\\log q_{t+1}$?\n\nA. Because the capital good is produced one-for-one from consumption with no adjustment costs under perfect competition, $q_t$ equals $1$ in equilibrium at all dates. A forecast of $\\log q_{t+1}$ is therefore a constant and does not summarize the aggregate state needed to predict future factor prices; replacing the $\\log K_{t+1}$ forecast with $\\log q_{t+1}$ generally fails unless additional aggregates (for example, $K_t$ or factor prices) are also forecast.\n\nB. There is a one-to-one mapping between $q_t$ and $K_t$ in this environment, so forecasting $\\log q_{t+1}$ is equivalent to forecasting $\\log K_{t+1}$ and yields the same equilibrium.\n\nC. Including the aggregate productivity state $Z_t$ as an argument in the $\\log q_{t+1}$ forecasting rule suffices to recover all information needed for pricing, so the algorithm converges exactly as in the benchmark that forecasts $\\log K_{t+1}$.\n\nD. The relationship $q_{t+1} = \\alpha Z_{t+1} K_{t+1}^{\\alpha-1}$ pins down $K_{t+1}$ from $q_{t+1}$, so forecasting $\\log q_{t+1}$ is sufficient for implementing the algorithm.", "solution": "The problem statement describes a standard incomplete-markets model with aggregate risk, the type for which the Krusell-Smith algorithm is designed. The validity of the proposed alternative forecasting procedure hinges on the economic relationship between the price of capital, $q_t$, and the aggregate state of the economy.\n\nFirst, we must establish the equilibrium price of installed capital, $q_t$. The problem states that:\n1.  A competitive capital-goods sector exists.\n2.  This sector transforms consumption goods, $I_t$, into installed capital, $I_t$, on a one-for-one basis.\n3.  There are no investment adjustment costs.\n\nThese three conditions are decisive. In a competitive market, firms enter until profits are driven to zero. The cost to a capital-goods producer of creating one unit of new capital is, by the one-for-one transformation, one unit of the consumption good. The price of the consumption good is the numeraire, so its price is $1$. Therefore, the price at which new capital goods are sold must be $1$.\n\nNow, consider the market for installed capital. Households can acquire capital in two ways: buy a newly produced unit of capital for a price of $1$, or buy a unit of existing, installed capital from another household at price $q_t$. For the market to be in equilibrium, there can be no arbitrage opportunities.\n- If $q_t > 1$, an agent could buy a newly produced unit of capital for a price of $1$ and immediately sell it as installed capital for a price of $q_t$, realizing an instantaneous, risk-free profit of $q_t - 1 > 0$. This would lead to infinite demand for new capital and infinite supply of installed capital, which cannot be an equilibrium.\n- If $q_t < 1$, no agent would purchase newly produced capital at a price of $1$ when they could buy existing installed capital for a lower price, $q_t$. This would imply that investment $I_t$ must be zero. However, for a growing economy or even one in a steady state with positive depreciation $\\delta > 0$, positive investment is required to replace depreciated capital ($I_t = \\delta K_t$ in steady state). As long as investment $I_t > 0$, the price of installed capital cannot be sustained below the cost of producing new capital.\n\nTherefore, in any equilibrium with $I_t > 0$, it must be that $q_t = 1$. This holds for all time periods $t$. The price of installed capital is constant and equal to its replacement cost of $1$.\n\nThe household's problem requires forming expectations about future income to make an optimal consumption-savings decision. Individual income depends on the rental rate of capital, $r_{t+1}$, and the wage rate, $w_{t+1}$. In competitive factor markets, these are given by the marginal products of the factors:\n$$r_{t+1} = \\alpha Z_{t+1} K_{t+1}^{\\alpha-1} L^{1-\\alpha}$$\n$$w_{t+1} = (1-\\alpha) Z_{t+1} K_{t+1}^{\\alpha} L^{-\\alpha}$$\n(Assuming $L_t = L$ is constant).\nTo forecast these prices, the household must forecast the future aggregate state, which consists of the aggregate capital stock $K_{t+1}$ and the aggregate productivity shock $Z_{t+1}$. The standard Krusell-Smith algorithm posits a perceived law of motion for the aggregate capital stock, e.g., $\\log K_{t+1} = \\beta_0 + \\beta_1 \\log K_t + \\beta_2 Z_t$. This allows agents to form the necessary expectations.\n\nThe proposed alternative is to forecast $\\log q_{t+1}$. Since we have established that $q_{t+1} = 1$ in equilibrium, this means forecasting $\\log q_{t+1} = \\log(1) = 0$. A forecast of a constant ($0$) provides no information about the evolution of $K_t$ or $Z_t$. An agent who knows that $\\log q_{t+1}$ will be $0$ gains no knowledge about what $K_{t+1}$ will be, and thus cannot form expectations about $r_{t+1}$ and $w_{t+1}$. This makes it impossible to solve the household's optimization problem. The forecasting mechanism fails entirely.\n\nNow, we evaluate each option based on this derivation.\n\n**A. Because the capital good is produced one-for-one from consumption with no adjustment costs under perfect competition, $q_t$ equals $1$ in equilibrium at all dates. A forecast of $\\log q_{t+1}$ is therefore a constant and does not summarize the aggregate state needed to predict future factor prices; replacing the $\\log K_{t+1}$ forecast with $\\log q_{t+1}$ generally fails unless additional aggregates (for example, $K_t$ or factor prices) are also forecast.**\n\nThis statement is entirely consistent with our analysis. It correctly identifies that $q_t = 1$ due to the lack of adjustment costs. It correctly concludes that forecasting $\\log q_{t+1}$ is forecasting a constant, which is uninformative about the aggregate state ($K_{t+1}, Z_{t+1}$) needed to predict future factor prices. Consequently, the algorithm based on this forecast would fail. The final clause, that it fails unless other variables are also forecast, is also correct; forecasting a constant is useless by itself. Therefore, this statement is **Correct**.\n\n**B. There is a one-to-one mapping between $q_t$ and $K_t$ in this environment, so forecasting $\\log q_{t+1}$ is equivalent to forecasting $\\log K_{t+1}$ and yields the same equilibrium.**\n\nThis is incorrect. As established, $q_t$ is a constant, $q_t = 1$. The aggregate capital stock, $K_t$, is a time-varying state variable. There is no one-to-one mapping between a constant and a variable. This statement might be true in a model with investment adjustment costs, where a higher $K_t$ could imply a different level of investment and thus a different $q_t$, but the problem explicitly rules out such costs. Therefore, this statement is **Incorrect**.\n\n**C. Including the aggregate productivity state $Z_t$ as an argument in the $\\log q_{t+1}$ forecasting rule suffices to recover all information needed for pricing, so the algorithm converges exactly as in the benchmark that forecasts $\\log K_{t+1}$.**\n\nThis is incorrect. The rational expectations equilibrium requires that the perceived law of motion be consistent with the actual law of motion. The actual law of motion for $q_{t+1}$ is $q_{t+1} = 1$, which implies $\\log q_{t+1} = 0$. So, any perceived law of motion $\\log q_{t+1} = f(K_t, Z_t)$ must collapse to the constant function $f(K_t, Z_t) = 0$. Learning that the forecast is always $0$, regardless of the current state $(K_t, Z_t)$, provides no information to the agent about the future state $K_{t+1}$. The fundamental problem is that the forecasted variable, $q_{t+1}$, is not informative, not that the forecasting rule is missing an argument. Therefore, this statement is **Incorrect**.\n\n**D. The relationship $q_{t+1} = \\alpha Z_{t+1} K_{t+1}^{\\alpha-1}$ pins down $K_{t+1}$ from $q_{t+1}$, so forecasting $\\log q_{t+1}$ is sufficient for implementing the algorithm.**\n\nThis is incorrect. The expression on the right-hand side, $\\alpha Z_{t+1} K_{t+1}^{\\alpha-1}$ (assuming $L_t=1$), is the marginal product of capital, which equals the rental rate $r_{t+1}$ in equilibrium. The statement posits that the price of the capital asset, $q_{t+1}$, is equal to its rental rate, $r_{t+1}$. This confuses a stock price with a flow return. The asset's price, $q_{t+1}$, is the present value of all its future returns, not just the next period's return. In this model, $q_{t+1}=1$, while $r_{t+1}$ is a variable that depends on $K_{t+1}$ and $Z_{t+1}$. The posited relationship is fundamentally false. Therefore, this statement is **Incorrect**.\n\nIn summary, the absence of investment adjustment costs is the critical feature of the environment, which implies $q_t=1$ for all $t$. This renders $q_t$ an uninformative state variable for forecasting purposes.", "answer": "$$\\boxed{A}$$", "id": "2441720"}, {"introduction": "Standard implementations of the Krusell-Smith algorithm operate in Markovian environments, where the future depends only on the present state. However, many interesting economic phenomena, like scarring from recessions, may exhibit path-dependence or 'hysteresis'. This exercise guides you through modifying the standard algorithm to incorporate such memory, where the economy's evolution depends on the historical maximum of the capital stock, $M_t$. Successfully adapting the forecasting rule and state evolution is a key step toward modeling more realistic and complex economic dynamics. [@problem_id:2441759]", "problem": "Consider a heterogeneous-agent Krusell–Smith economy in which a unit mass of infinitely lived households saves a one-period risk-free asset that aggregates into the aggregate capital stock $K_t$. Aggregate productivity is $Z_t$, and let $z_t \\equiv \\log Z_t$. In the standard Krusell–Smith algorithm, agents form expectations about next period’s aggregate capital $K_{t+1}$ using a perceived forecasting rule that conditions on aggregate state variables, typically including current aggregate capital $K_t$ and the aggregate productivity state $z_t$, and coefficients are updated by simulated ordinary least squares (OLS) regressions until convergence.\n\nSuppose the true law of motion exhibits hysteresis in the sense that it depends on the historical maximum of aggregate capital, $M_t \\equiv \\max_{s \\le t} K_s$, in addition to $(K_t, z_t)$. Agents must therefore augment their perceived law of motion so that their expectations are consistent with this dependence, and the simulated state must evolve in a way that respects the definition of $M_t$ as a running maximum.\n\nWhich of the following specifications is an appropriate modification of the Krusell–Smith perceived forecasting rule and state evolution to incorporate hysteresis through $M_t$?\n\nA. Use the augmented state $(K_t, z_t, M_t)$ and specify\n$\\log K_{t+1} = a_0 + a_1 \\log K_t + a_2 z_t + a_3 \\log M_t$, with $M_{t+1} = \\max\\{M_t, K_{t+1}\\}$ in simulation and coefficient updating by OLS each iteration.\n\nB. Replace $K_t$ by $M_t$ in the state, specifying $\\log K_{t+1} = a_0 + a_1 \\log M_t + a_2 z_t$, and hold $M_{t+1} = M_t$ fixed during simulation because $M_t$ is predetermined.\n\nC. Keep the original rule $\\log K_{t+1} = a_0 + a_1 \\log K_t + a_2 z_t$ and introduce hysteresis only by allowing $M_t$ to shift prices in equilibrium, without entering the perceived law of motion for $K_{t+1}$.\n\nD. Augment the rule with an indicator for new maxima, $\\log K_{t+1} = a_0 + a_1 \\log K_t + a_2 z_t + a_3 \\mathbf{1}\\{K_t = M_t\\}$, and set $M_{t+1} = M_t$ since the event $\\{K_t = M_t\\}$ already captures hysteresis.", "solution": "The problem statement will first be subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n\nThe following information is provided in the problem statement:\n- **Model Type:** A heterogeneous-agent Krusell–Smith economy.\n- **Agents:** A unit mass of infinitely lived households.\n- **Asset:** A one-period risk-free asset that aggregates to the aggregate capital stock, $K_t$.\n- **Aggregate Productivity:** $Z_t$, with its logarithm denoted as $z_t \\equiv \\log Z_t$.\n- **Standard Krusell–Smith Algorithm:** Agents form expectations for the next period's aggregate capital, $K_{t+1}$, using a perceived forecasting rule. This rule conditions on the aggregate state variables, typically $(K_t, z_t)$. The coefficients of this rule are updated via ordinary least squares (OLS) on simulated data until convergence.\n- **Hysteresis Postulate:** The true law of motion for aggregate capital depends not only on $(K_t, z_t)$ but also on the historical maximum of aggregate capital, defined as $M_t \\equiv \\max_{s \\le t} K_s$.\n- **Required Modification:** The agents' perceived law of motion must be augmented to be consistent with this hysteretic dependence. The simulation of the state must respect the definition of $M_t$.\n- **Objective:** Identify the appropriate modification of the perceived forecasting rule and state evolution to incorporate hysteresis via $M_t$.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the criteria for validity.\n\n- **Scientifically Grounded:** The problem is set within the well-established framework of computational macroeconomics, specifically using the Krusell-Smith algorithm. The concept of introducing hysteresis through a dependence on a historical running maximum is a valid and formalizable economic idea. It does not violate any scientific or mathematical principles.\n- **Well-Posed:** The problem provides a clear objective: to correctly specify the state space, the perceived law of motion (PLM), and the state transition function for a model with a specific feature (hysteresis). The structure allows for a single, logically derivable correct answer based on the principles of rational expectations and numerical simulation.\n- **Objective:** The language is formal and precise. Terms such as \"Krusell–Smith economy,\" \"perceived forecasting rule,\" and \"hysteresis\" are standard in the field and are not ambiguous. The definition of $M_t$ is explicit.\n\nThe problem statement exhibits none of the disqualifying flaws. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, or ill-posed. It is a standard exercise in modifying a known computational algorithm.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be derived.\n\n### Solution Derivation\n\nThe Krusell-Smith algorithm is a method for computing an approximate rational expectations equilibrium in a heterogeneous-agent model. The core principle is that the \"perceived law of motion\" (PLM) used by agents to form expectations must coincide with the \"actual law of motion\" (ALM) that results from the aggregation of their individual decisions. This self-consistency is achieved through an iterative procedure.\n\n1.  **Identify the State Space:** The problem posits that the true dynamics of the economy depend on the current capital stock $K_t$, the productivity shock $z_t$, and the historical maximum of capital $M_t$. Therefore, the complete aggregate state of the system is the triplet $(K_t, z_t, M_t)$. For agents to form rational expectations, their information set must include all variables that systematically influence the future evolution of prices and, consequently, aggregate quantities. Thus, the PLM must condition on the full state vector $(K_t, z_t, M_t)$.\n\n2.  **Specify the Perceived Law of Motion (PLM):** Given the state space $(K_t, z_t, M_t)$, the PLM for $K_{t+1}$ must be a function of these three variables. A standard approach in the Krusell-Smith literature is to use a log-linear approximation for the forecasting rule. This leads to a PLM of the form:\n    $$ \\log K_{t+1} = f(\\log K_t, z_t, \\log M_t) $$\n    The linear specification proposed is:\n    $$ \\log K_{t+1} = a_0 + a_1 \\log K_t + a_2 z_t + a_3 \\log M_t $$\n    This is a general and appropriate functional form for the PLM, as it allows the data generated by the simulation to determine the relative importance of each state variable through the estimated coefficients $(a_0, a_1, a_2, a_3)$.\n\n3.  **Specify the State Evolution in Simulation:** The algorithm proceeds by simulating a long time series of the economy. At each time step $t$, we must be able to compute the state at time $t+1$.\n    - The next period's capital, $K_{t+1}$, is determined by aggregating the optimal savings decisions of all households. These households use the PLM to forecast the return on capital.\n    - The productivity shock $z_{t+1}$ evolves according to its own exogenous stochastic process (e.g., an AR(1) process).\n    - The historical maximum $M_{t+1}$ must be updated according to its definition. Since $M_t = \\max_{s \\le t} K_s$, it follows that $M_{t+1} = \\max\\{K_0, K_1, \\dots, K_t, K_{t+1}\\}$. This can be computed recursively as:\n      $$ M_{t+1} = \\max\\{M_t, K_{t+1}\\} $$\n    This update rule is not a matter of choice; it is a direct consequence of the definition of $M_t$. Any valid algorithm must implement this evolution for the state variable $M_t$.\n\nThe iterative procedure involves:\n1.  Guessing initial coefficients $(a_0, a_1, a_2, a_3)$.\n2.  Simulating the economy for many periods: households solve their problem using the PLM, their choices are aggregated to find the ALM for capital $\\{K_t\\}^{\\text{sim}}$, and the state variables $(K_t, z_t, M_t)$ are updated at each step, with $M_{t+1} = \\max\\{M_t, K_{t+1}\\}$.\n3.  Running an OLS regression of $\\log K_{t+1}^{\\text{sim}}$ on a constant, $\\log K_t^{\\text{sim}}$, $z_t^{\\text{sim}}$, and $\\log M_t^{\\text{sim}}$ to obtain new coefficients.\n4.  Repeating from step 2 until the coefficients converge.\n\n### Option-by-Option Analysis\n\n**A. Use the augmented state $(K_t, z_t, M_t)$ and specify $\\log K_{t+1} = a_0 + a_1 \\log K_t + a_2 z_t + a_3 \\log M_t$, with $M_{t+1} = \\max\\{M_t, K_{t+1}\\}$ in simulation and coefficient updating by OLS each iteration.**\nThis option correctly implements all necessary modifications.\n- It augments the state space to $(K_t, z_t, M_t)$.\n- It specifies a general log-linear PLM that conditions on all three state variables.\n- It correctly specifies the law of motion for the new state variable $M_t$ as $M_{t+1} = \\max\\{M_t, K_{t+1}\\}$.\n- It maintains the standard OLS updating procedure.\nThis procedure is internally consistent and correctly adapts the Krusell-Smith algorithm to the specified problem.\n**Verdict: Correct**\n\n**B. Replace $K_t$ by $M_t$ in the state, specifying $\\log K_{t+1} = a_0 + a_1 \\log M_t + a_2 z_t$, and hold $M_{t+1} = M_t$ fixed during simulation because $M_t$ is predetermined.**\nThis option contains multiple severe errors.\n- First, replacing $K_t$ with $M_t$ implies that the current level of capital is irrelevant for forecasting its future value, given the historical maximum. This is an unsubstantiated and restrictive assumption. In general, $K_t \\neq M_t$, and the gap between them can be a key state variable. The state $(M_t, z_t)$ is incomplete.\n- Second, the statement that $M_t$ is \"predetermined\" is used to justify holding it fixed (i.e., $M_{t+1} = M_t$). While $M_t$ is known at time $t$, the variable $M$ must evolve over time. If a new maximum for capital is reached ($K_{t+1} > M_t$), the historical maximum must be updated. Fixing $M_t$ violates its definition.\n**Verdict: Incorrect**\n\n**C. Keep the original rule $\\log K_{t+1} = a_0 + a_1 \\log K_t + a_2 z_t$ and introduce hysteresis only by allowing $M_t$ to shift prices in equilibrium, without entering the perceived law of motion for $K_{t+1}$.**\nThis option describes a situation that violates the principle of rational expectations. If $M_t$ affects equilibrium prices and thus the true law of motion for $K_{t+1}$, then a forecasting rule that omits $M_t$ will be systematically biased. Agents using such a rule are not rational in the sense required for the model. The PLM must include all variables that are part of the ALM. Therefore, this setup is fundamentally inconsistent and will not lead to a rational expectations equilibrium.\n**Verdict: Incorrect**\n\n**D. Augment the rule with an indicator for new maxima, $\\log K_{t+1} = a_0 + a_1 \\log K_t + a_2 z_t + a_3 \\mathbf{1}\\{K_t = M_t\\}$, and set $M_{t+1} = M_t$ since the event $\\{K_t = M_t\\}$ already captures hysteresis.**\nThis option has two flaws.\n- The first is the specification of the PLM. While using an indicator function $\\mathbf{1}\\{K_t = M_t\\}$ is a way to model state-dependence, it is highly restrictive. It implies that hysteresis only has an effect when the current capital stock is exactly at its historical peak. A more general specification, such as in option A, would allow for effects even when $K_t < M_t$.\n- The second, and more critical, flaw is the evolution of $M_t$. As in option B, setting $M_{t+1} = M_t$ is incorrect. It negates the very definition of $M_t$ as a *running* maximum. If $K_{t+1}$ were to exceed $M_t$, $M_{t+1}$ *must* be updated to $K_{t+1}$. The assertion that the indicator function \"captures hysteresis\" does not justify violating the definition of a state variable.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "2441759"}]}