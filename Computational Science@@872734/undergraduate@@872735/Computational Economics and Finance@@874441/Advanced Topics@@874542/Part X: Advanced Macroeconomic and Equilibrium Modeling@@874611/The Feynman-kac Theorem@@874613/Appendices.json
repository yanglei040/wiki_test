{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we tackle a fundamental problem in finance: calculating the expected value of a future stream of cash flows. This exercise models a stock that pays continuous dividends, where the dividend rate depends on both the stock's price and time. While the Feynman-Kac theorem formally links this expectation to a partial differential equation, this practice guides you through a more direct path of solving it by leveraging the linearity of expectations and the known properties of Geometric Brownian Motion, providing a robust foundation for more complex problems. [@problem_id:2440775]", "problem": "Consider a stock price process modeled as a one-dimensional Itô diffusion under the real-world probability measure. The process follows the stochastic differential equation $\\mathrm{d}X_t = \\mu X_t \\, \\mathrm{d}t + \\sigma X_t \\, \\mathrm{d}W_t$, where $X_t$ is the stock price at time $t$, $\\mu$ and $\\sigma$ are constants, and $W_t$ is a standard Brownian motion. The stock pays a continuous dividend stream at an instantaneous rate $f(X_t,t)$ given by $f(X_t,t) = a \\, e^{-\\kappa t} + q \\, X_t \\, e^{-\\lambda t}$, where $a$, $\\kappa$, $q$, and $\\lambda$ are nonnegative constants. Define the expected total dividends paid from the present time $t=0$ until a fixed time horizon $T$ as the functional\n$$\nu(x_0,0) = \\mathbb{E}\\left[\\int_{0}^{T} f(X_t,t) \\, \\mathrm{d}t \\,\\bigg|\\, X_0 = x_0\\right].\n$$\nUse the Feynman–Kac theorem to formulate the corresponding backward Partial Differential Equation (PDE) problem that $u(x,t)$ must satisfy, including the terminal condition at $t=T$. Starting only from the definitions of an Itô diffusion, the linearity of expectation, and the Feynman–Kac theorem (do not assume any final formula for $u$), determine a closed-form expression for $u(x_0,0)$ in terms of $x_0$, $\\mu$, $\\sigma$, $T$, $a$, $\\kappa$, $q$, and $\\lambda$. Your expression must be valid in all cases, including the boundary cases $\\kappa = 0$ and $\\mu = \\lambda$, and should be obtained as the appropriate continuous limits when denominators vanish.\n\nYou must then implement a program that, for a set of given parameter tuples, computes $u(x_0,0)$ numerically using your derived closed-form expression. The program must handle the limiting cases $\\kappa \\to 0$ and $\\mu \\to \\lambda$ robustly by using a numerically stable tolerance when testing for equality. All rates are to be interpreted as decimals (for example, a five percent rate is $0.05$).\n\nYour program must evaluate the following test suite of parameter sets, each specified as $(x_0,\\mu,\\sigma,T,a,\\kappa,q,\\lambda)$:\n\n- Test $1$: $(100,\\, 0.03,\\, 0.20,\\, 2.0,\\, 1.5,\\, 0.5,\\, 0.02,\\, 0.1)$, a general case with distinct exponents.\n- Test $2$: $(80,\\, 0.04,\\, 0.25,\\, 1.5,\\, 2.0,\\, 0.0,\\, 0.03,\\, 0.2)$, the boundary case $\\kappa = 0$.\n- Test $3$: $(120,\\, 0.05,\\, 0.15,\\, 3.0,\\, 0.5,\\, 0.3,\\, 0.01,\\, 0.05)$, the boundary case $\\mu = \\lambda$.\n- Test $4$: $(50,\\, 0.07,\\, 0.30,\\, 0.0,\\, 1.0,\\, 0.4,\\, 0.02,\\, 0.6)$, the boundary case $T = 0$.\n- Test $5$: $(90,\\, -0.02,\\, 0.18,\\, 2.5,\\, 1.2,\\, 0.25,\\, 0.05,\\, 0.01)$, a case with negative drift.\n\nYour program must produce the numerical values of $u(x_0,0)$ for each test case as real numbers rounded to six decimal places. The final output format must be a single line containing a comma-separated list of the five results enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is a floating-point number with exactly six digits after the decimal point.", "solution": "The problem statement will first be subjected to a rigorous validation procedure before any attempt at a solution.\n\n### Step 1: Extract Givens\n\nThe following information is provided in the problem statement:\n\n-   **Stock Price Process**: A one-dimensional Itô diffusion governed by the stochastic differential equation (SDE) $\\mathrm{d}X_t = \\mu X_t \\, \\mathrm{d}t + \\sigma X_t \\, \\mathrm{d}W_t$.\n    -   $X_t$: Stock price at time $t$.\n    -   $\\mu, \\sigma$: Constant drift and volatility.\n    -   $W_t$: Standard Brownian motion.\n-   **Continuous Dividend Stream**: The instantaneous dividend rate is given by $f(X_t,t) = a \\, e^{-\\kappa t} + q \\, X_t \\, e^{-\\lambda t}$.\n    -   $a, \\kappa, q, \\lambda$: Nonnegative constants.\n-   **Functional to be Calculated**: The expected total dividends from time $t=0$ to $T$ is defined as:\n    $$ u(x_0,0) = \\mathbb{E}\\left[\\int_{0}^{T} f(X_t,t) \\, \\mathrm{d}t \\,\\bigg|\\, X_0 = x_0\\right] $$\n-   **Task Requirements**:\n    1.  Formulate the backward Partial Differential Equation (PDE) for $u(x,t)$ using the Feynman–Kac theorem, including the terminal condition.\n    2.  Derive a closed-form expression for $u(x_0,0)$.\n    3.  The derivation must start from first principles (Itô diffusion, linearity of expectation, Feynman-Kac theorem).\n    4.  The expression must be valid for all cases, including $\\kappa = 0$ and $\\mu = \\lambda$.\n    5.  Implement a program to compute $u(x_0,0)$ for a given set of test cases.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria.\n\n-   **Scientifically Grounded**: The problem is set within the standard framework of modern quantitative finance. The stock price process is the geometric Brownian motion model, which is the cornerstone of the Black-Scholes-Merton theory. The dividend structure is a well-defined function of time and stock price. The functional to be computed, an expected value of a path-dependent quantity, is a common object of study. The Feynman-Kac theorem is the correct and standard mathematical tool for linking such expectations to PDEs. The problem is free of any pseudoscience or factual inaccuracies.\n-   **Well-Posed**: The problem is well-posed. The SDE is linear with well-behaved coefficients, guaranteeing a unique strong solution for $X_t$. The functional $u(x_0,0)$ is a well-defined expectation, and its existence is assured given the properties of the process and the dividend function. The parameters are clearly defined, and sufficient information is provided to derive a unique solution.\n-   **Objective**: The language is precise, mathematical, and free of any subjective or ambiguous terminology.\n-   **No other flaws**: The problem is self-contained, its setup is consistent, and the conditions are feasible within the mathematical model. It is not metaphorical, trivial, or outside the scope of scientific verification.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A solution will be developed.\n\n### Derivation of the Closed-Form Solution\n\nThe task is to find a closed-form expression for the functional:\n$$ u(x_0, 0) = \\mathbb{E}\\left[\\int_{0}^{T} f(X_s,s) \\, \\mathrm{d}s \\,\\bigg|\\, X_0 = x_0\\right] $$\nwhere $\\mathrm{d}X_t = \\mu X_t \\, \\mathrm{d}t + \\sigma X_t \\, \\mathrm{d}W_t$ and $f(X_t,t) = a \\, e^{-\\kappa t} + q \\, X_t \\, e^{-\\lambda t}$.\n\nFirst, we generalize the functional for an arbitrary starting time $t \\in [0, T]$ and state $X_t = x$:\n$$ u(x,t) = \\mathbb{E}\\left[\\int_{t}^{T} f(X_s,s) \\, \\mathrm{d}s \\,\\bigg|\\, X_t = x\\right] $$\n\nAs required, we formulate the PDE problem using the Feynman–Kac theorem. The general theorem relates a PDE of the form $\\frac{\\partial u}{\\partial t} + \\mathcal{A}u - r u + g = 0$ with terminal condition $u(x,T) = \\psi(x)$ to the expectation $u(x,t) = \\mathbb{E}\\left[\\int_t^T e^{-\\int_t^s r(X_v) \\mathrm{d}v} g(X_s,s) \\mathrm{d}s + e^{-\\int_t^T r(X_v) \\mathrm{d}v} \\psi(X_T) | X_t=x\\right]$, where $\\mathcal{A}$ is the infinitesimal generator of the diffusion process.\n\nFor the given process $\\mathrm{d}X_s = \\mu X_s \\, \\mathrm{d}s + \\sigma X_s \\, \\mathrm{d}W_s$, the drift coefficient is $b(x,s) = \\mu x$ and the diffusion coefficient is $\\eta(x,s) = \\sigma x$. The infinitesimal generator $\\mathcal{A}$ is therefore:\n$$ \\mathcal{A}u = b(x,s) \\frac{\\partial u}{\\partial x} + \\frac{1}{2} \\eta(x,s)^2 \\frac{\\partial^2 u}{\\partial x^2} = \\mu x \\frac{\\partial u}{\\partial x} + \\frac{1}{2}\\sigma^2 x^2 \\frac{\\partial^2 u}{\\partial x^2} $$\n\nBy comparing our target functional with the general Feynman-Kac formula, we identify the following components:\n-   The discount rate function is $r(x,s) = 0$.\n-   The running cost (or dividend) function is $g(x,s) = f(x,s) = a e^{-\\kappa s} + q x e^{-\\lambda s}$.\n-   The terminal value function is $\\psi(x) = 0$.\n\nSubstituting these into the general PDE form yields the backward PDE which $u(x,t)$ must satisfy for $t \\in [0,T)$:\n$$ \\frac{\\partial u}{\\partial t} + \\mu x \\frac{\\partial u}{\\partial x} + \\frac{1}{2}\\sigma^2 x^2 \\frac{\\partial^2 u}{\\partial x^2} + a e^{-\\kappa t} + q x e^{-\\lambda t} = 0 $$\nThe corresponding terminal condition at $t=T$ is derived from the definition of $u(x,T)$:\n$$ u(x,T) = \\mathbb{E}\\left[\\int_{T}^{T} f(X_s,s) \\, \\mathrm{d}s \\,\\bigg|\\, X_T = x\\right] = \\mathbb{E}[0] = 0 $$\n\nWhile this PDE can be solved, a more direct approach is to evaluate the expectation directly, a method which is fully compliant with the problem's constraints. We begin with the definition of $u(x_0,0)$ and apply the linearity of expectation and Fubini's theorem (justified since the integrand is nonnegative):\n$$ u(x_0, 0) = \\mathbb{E}\\left[\\int_{0}^{T} (a e^{-\\kappa t} + q X_t e^{-\\lambda t}) \\, \\mathrm{d}t \\,\\bigg|\\, X_0 = x_0\\right] = \\int_{0}^{T} \\mathbb{E}[a e^{-\\kappa t} + q X_t e^{-\\lambda t} | X_0=x_0 ] \\, \\mathrm{d}t $$\n$$ u(x_0, 0) = \\int_{0}^{T} \\left( a e^{-\\kappa t} + q e^{-\\lambda t} \\mathbb{E}[X_t | X_0=x_0] \\right) \\, \\mathrm{d}t $$\n\nThe next step is to compute the conditional expectation $\\mathbb{E}[X_t | X_0=x_0]$. The SDE $\\mathrm{d}X_t = \\mu X_t \\, \\mathrm{d}t + \\sigma X_t \\, \\mathrm{d}W_t$ describes a Geometric Brownian Motion. Its solution is known to be $X_t = X_0 \\exp\\left((\\mu - \\frac{1}{2}\\sigma^2)t + \\sigma W_t\\right)$. Taking the expectation:\n$$ \\mathbb{E}[X_t | X_0=x_0] = \\mathbb{E}\\left[x_0 \\exp\\left((\\mu - \\frac{1}{2}\\sigma^2)t + \\sigma W_t\\right)\\right] = x_0 \\exp\\left((\\mu - \\frac{1}{2}\\sigma^2)t\\right) \\mathbb{E}[\\exp(\\sigma W_t)] $$\nSince $W_t \\sim \\mathcal{N}(0, t)$, the random variable $\\sigma W_t$ is normally distributed with mean $0$ and variance $\\sigma^2 t$. The moment-generating function for a normal random variable $Z \\sim \\mathcal{N}(\\nu, \\tau^2)$ is $\\mathbb{E}[e^{sZ}] = e^{s\\nu + \\frac{1}{2}s^2\\tau^2}$. For $\\sigma W_t$ with $s=1$, we have:\n$$ \\mathbb{E}[\\exp(\\sigma W_t)] = \\exp\\left(1 \\cdot 0 + \\frac{1}{2} \\cdot 1^2 \\cdot \\sigma^2 t\\right) = \\exp\\left(\\frac{1}{2}\\sigma^2 t\\right) $$\nSubstituting this back, we find a fundamental result:\n$$ \\mathbb{E}[X_t | X_0=x_0] = x_0 \\exp\\left((\\mu - \\frac{1}{2}\\sigma^2)t\\right) \\exp\\left(\\frac{1}{2}\\sigma^2 t\\right) = x_0 e^{\\mu t} $$\n\nNow, we substitute this expected value into the integral for $u(x_0,0)$:\n$$ u(x_0, 0) = \\int_{0}^{T} \\left( a e^{-\\kappa t} + q e^{-\\lambda t} (x_0 e^{\\mu t}) \\right) \\, \\mathrm{d}t = \\int_{0}^{T} a e^{-\\kappa t} \\, \\mathrm{d}t + \\int_{0}^{T} q x_0 e^{(\\mu-\\lambda) t} \\, \\mathrm{d}t $$\n\nWe evaluate each integral separately.\n\nFor the first integral, $I_1 = \\int_{0}^{T} a e^{-\\kappa t} \\, \\mathrm{d}t$:\n-   If $\\kappa \\neq 0$:\n    $$ I_1 = a \\left[ \\frac{e^{-\\kappa t}}{-\\kappa} \\right]_0^T = a \\left( \\frac{e^{-\\kappa T}}{-\\kappa} - \\frac{e^0}{-\\kappa} \\right) = a \\frac{1 - e^{-\\kappa T}}{\\kappa} $$\n-   If $\\kappa = 0$:\n    $$ I_1 = \\int_{0}^{T} a \\, \\mathrm{d}t = aT $$\n    The limit of the first case as $\\kappa \\to 0$ using L'Hôpital's rule is $\\lim_{\\kappa \\to 0} a \\frac{1 - e^{-\\kappa T}}{\\kappa} = \\lim_{\\kappa \\to 0} a \\frac{T e^{-\\kappa T}}{1} = aT$, which confirms consistency.\n\nFor the second integral, $I_2 = \\int_{0}^{T} q x_0 e^{(\\mu-\\lambda) t} \\, \\mathrm{d}t$:\n-   If $\\mu - \\lambda \\neq 0$:\n    $$ I_2 = q x_0 \\left[ \\frac{e^{(\\mu-\\lambda) t}}{\\mu-\\lambda} \\right]_0^T = q x_0 \\left( \\frac{e^{(\\mu-\\lambda) T}}{\\mu-\\lambda} - \\frac{e^0}{\\mu-\\lambda} \\right) = q x_0 \\frac{e^{(\\mu-\\lambda) T} - 1}{\\mu-\\lambda} $$\n-   If $\\mu - \\lambda = 0$ (i.e., $\\mu = \\lambda$):\n    $$ I_2 = \\int_{0}^{T} q x_0 \\, \\mathrm{d}t = q x_0 T $$\n    Again, the limit of the first case as $\\mu-\\lambda \\to 0$ gives $\\lim_{\\mu-\\lambda \\to 0} q x_0 \\frac{e^{(\\mu-\\lambda) T} - 1}{\\mu-\\lambda} = \\lim_{\\mu-\\lambda \\to 0} q x_0 \\frac{T e^{(\\mu-\\lambda) T}}{1} = q x_0 T$, which confirms consistency.\n\nCombining the results, the final closed-form expression for $u(x_0,0)$ is:\n$$ u(x_0, 0) = I_1 + I_2 $$\nThe expression must be implemented using conditional logic to handle the cases where denominators would be zero.\n$$ u(x_0, 0) = \\begin{cases} aT  \\text{if } \\kappa = 0 \\\\ a \\frac{1 - e^{-\\kappa T}}{\\kappa}  \\text{if } \\kappa \\neq 0 \\end{cases} + \\begin{cases} q x_0 T  \\text{if } \\mu=\\lambda \\\\ q x_0 \\frac{e^{(\\mu-\\lambda) T} - 1}{\\mu-\\lambda}  \\text{if } \\mu \\neq \\lambda \\end{cases} $$\nThis expression is valid and robust for all non-negative parameters as specified. It is important to note that the volatility $\\sigma$ does not appear in the final expression. This is because the expectation of the GBM process $X_t$ depends only on the drift $\\mu$, not its variance.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expected total dividends for a set of test cases\n    based on a derived closed-form solution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (x0, mu, sigma, T, a, kappa, q, lambda)\n    test_cases = [\n        (100.0, 0.03, 0.20, 2.0, 1.5, 0.5, 0.02, 0.1),    # Test 1: General case\n        (80.0, 0.04, 0.25, 1.5, 2.0, 0.0, 0.03, 0.2),      # Test 2: kappa = 0\n        (120.0, 0.05, 0.15, 3.0, 0.5, 0.3, 0.01, 0.05),   # Test 3: mu = lambda\n        (50.0, 0.07, 0.30, 0.0, 1.0, 0.4, 0.02, 0.6),      # Test 4: T = 0\n        (90.0, -0.02, 0.18, 2.5, 1.2, 0.25, 0.05, 0.01),  # Test 5: Negative drift\n    ]\n\n    results = []\n    # Tolerance for checking if a value is close to zero, to handle special cases robustly.\n    tol = 1e-12\n\n    for case in test_cases:\n        x0, mu, sigma, T, a, kappa, q, lam = case\n\n        # Handle the edge case where T = 0. The integral from 0 to 0 is 0.\n        if T == 0.0:\n            results.append(0.0)\n            continue\n\n        # Calculate the first term of the solution, related to the dividend component 'a'.\n        # This corresponds to the integral of a * exp(-kappa*t).\n        if abs(kappa)  tol:\n            # If kappa is zero, the integral is a*T.\n            term1 = a * T\n        else:\n            # The general case for kappa != 0.\n            term1 = a * (1.0 - np.exp(-kappa * T)) / kappa\n\n        # Calculate the second term of the solution, related to the dividend component 'q*X_t'.\n        # This corresponds to the integral of q * x0 * exp((mu-lambda)*t).\n        mu_minus_lambda = mu - lam\n        if abs(mu_minus_lambda)  tol:\n            # If mu equals lambda, the exponent is zero, and the integral is q*x0*T.\n            term2 = q * x0 * T\n        else:\n            # The general case for mu != lambda.\n            term2 = q * x0 * (np.exp(mu_minus_lambda * T) - 1.0) / mu_minus_lambda\n\n        # The total expected dividend is the sum of the two terms.\n        total_dividend = term1 + term2\n        results.append(total_dividend)\n\n    # Final print statement in the exact required format.\n    # Results are formatted to six decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```", "id": "2440775"}, {"introduction": "Having established a baseline, we now explore the interpretive power of the Feynman-Kac theorem by comparing two distinct financial models. This exercise [@problem_id:2440799] presents a rate $q(t)$ and asks you to value an option where this rate is treated first as a 'killing rate' (modifying the discount factor) and second as a 'dividend yield' (modifying the asset's drift). By computing the option price in both scenarios, you will gain a deeper, practical understanding of how different components of the Feynman-Kac PDE correspond to specific financial mechanisms and valuation outcomes.", "problem": "Consider a financial market under the Risk-Neutral Measure (RNM) where an underlying asset price process $\\{S_t\\}_{t \\in [0,T]}$ follows a Geometric Brownian Motion driven by a Wiener process (Brownian Motion) $\\{W_t\\}_{t \\in [0,T]}$. Let $S_0 \\in \\mathbb{R}_{+}$ be the initial price, $r \\in \\mathbb{R}$ be the constant risk-free rate, and $\\sigma \\in \\mathbb{R}_{+}$ be the constant volatility. Fix a maturity $T \\in \\mathbb{R}_{+}$ and a strike $K \\in \\mathbb{R}_{+}$. Consider a European call option with payoff $\\varphi(S_T) = \\max(S_T - K, 0)$.\n\nTwo modeling conventions for a nonnegative, deterministic, time-dependent rate $q(t)$ are to be compared:\n\n- Model A (killing-rate model): the price function $u_A(s,t)$ solves a Partial Differential Equation (PDE) with a potential term (killing rate) $V(x,t) = q(t)$, and by the Feynman–Kac theorem,\n$$\nu_A(S_0,0) \\;=\\; \\mathbb{E}\\left[\\exp\\!\\left(-\\int_{0}^{T} \\big(r + q(t)\\big)\\,\\mathrm{d}t\\right)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right],\n$$\nwith the underlying following\n$$\n\\mathrm{d}S_t \\;=\\; r\\,S_t\\,\\mathrm{d}t \\;+\\; \\sigma\\,S_t\\,\\mathrm{d}W_t,\\quad S_0 \\;\\; 0.\n$$\n\n- Model B (dividend-yield model): the same quantity $q(t)$ is interpreted as a continuous dividend yield entering the drift of the underlying,\n$$\n\\mathrm{d}S_t \\;=\\; \\big(r - q(t)\\big)\\,S_t\\,\\mathrm{d}t \\;+\\; \\sigma\\,S_t\\,\\mathrm{d}W_t,\\quad S_0 \\;\\; 0,\n$$\nand the option price is given by\n$$\nu_B(S_0,0) \\;=\\; \\mathbb{E}\\left[\\exp\\!\\left(-\\int_{0}^{T} r\\,\\mathrm{d}t\\right)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right].\n$$\n\nYour task is to compute, for each specified $q(t)$ below, both $u_A(S_0,0)$ and $u_B(S_0,0)$, using only the definitions above and fundamental properties of the Geometric Brownian Motion and the Feynman–Kac theorem. Answers must be expressed in the same currency units as $S_0$ and $K$, rounded to six decimal places.\n\nUse the common parameter set\n$$\nS_0 \\;=\\; 100,\\quad K \\;=\\; 100,\\quad r \\;=\\; 0.03,\\quad \\sigma \\;=\\; 0.2,\\quad T \\;=\\; 1.\n$$\n\nTest suite (five cases for $q(t)$):\n- Case $\\#1$: $q(t) \\;=\\; 0$ for all $t \\in [0,T]$.\n- Case $\\#2$: $q(t) \\;=\\; 0.02$ for all $t \\in [0,T]$.\n- Case $\\#3$: $q(t) \\;=\\; 0.05$ for all $t \\in [0,T]$.\n- Case $\\#4$: $q(t) \\;=\\; 0.10$ for all $t \\in [0,T]$.\n- Case $\\#5$: $q(t)$ is piecewise-constant, with $q(t) \\;=\\; 0.10$ for $t \\in [0, 0.25]$ and $q(t) \\;=\\; 0$ for $t \\in (0.25, 1]$.\n\nYour program must output the results in the following order for the five cases: for each case, first output $u_A(S_0,0)$, then $u_B(S_0,0)$. The final output must be a single line containing a comma-separated list enclosed in square brackets, with ten floating-point numbers rounded to six decimals, in the order\n$$\n\\big[u_A^{(1)},\\,u_B^{(1)},\\,u_A^{(2)},\\,u_B^{(2)},\\,u_A^{(3)},\\,u_B^{(3)},\\,u_A^{(4)},\\,u_B^{(4)},\\,u_A^{(5)},\\,u_B^{(5)}\\big].\n$$", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, all givens are extracted verbatim.\n- Underlying asset price process: $\\{S_t\\}_{t \\in [0,T]}$ follows a Geometric Brownian Motion driven by a Wiener process $\\{W_t\\}_{t \\in [0,T]}$.\n- Initial price: $S_0 \\in \\mathbb{R}_{+}$.\n- Risk-free rate: $r \\in \\mathbb{R}$, constant.\n- Volatility: $\\sigma \\in \\mathbb{R}_{+}$, constant.\n- Maturity: $T \\in \\mathbb{R}_{+}$.\n- Strike: $K \\in \\mathbb{R}_{+}$.\n- Payoff function (European call): $\\varphi(S_T) = \\max(S_T - K, 0)$.\n- A nonnegative, deterministic, time-dependent rate $q(t)$.\n- Model A (killing-rate model): $u_A(S_0,0) = \\mathbb{E}\\left[\\exp\\left(-\\int_{0}^{T} (r + q(t))\\,\\mathrm{d}t\\right)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right]$, with underlying $\\mathrm{d}S_t = r\\,S_t\\,\\mathrm{d}t + \\sigma\\,S_t\\,\\mathrm{d}W_t$.\n- Model B (dividend-yield model): $u_B(S_0,0) = \\mathbb{E}\\left[\\exp\\left(-\\int_{0}^{T} r\\,\\mathrm{d}t\\right)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right]$, with underlying $\\mathrm{d}S_t = (r - q(t))\\,S_t\\,\\mathrm{d}t + \\sigma\\,S_t\\,\\mathrm{d}W_t$.\n- Common parameters: $S_0 = 100$, $K = 100$, $r = 0.03$, $\\sigma = 0.2$, $T = 1$.\n- Test cases for $q(t)$:\n    1. $q(t) = 0$ for all $t \\in [0,T]$.\n    2. $q(t) = 0.02$ for all $t \\in [0,T]$.\n    3. $q(t) = 0.05$ for all $t \\in [0,T]$.\n    4. $q(t) = 0.10$ for all $t \\in [0,T]$.\n    5. $q(t)$ is piecewise-constant, with $q(t) = 0.10$ for $t \\in [0, 0.25]$ and $q(t) = 0$ for $t \\in (0.25, 1]$.\n\nSecond, the problem is validated against the required criteria.\n- **Scientifically Grounded**: The problem is formulated within the standard Black-Scholes-Merton framework of mathematical finance. Both models presented are valid interpretations of incorporating a yield or killing rate, and their representation via the Feynman-Kac theorem is standard theory. The problem is scientifically sound.\n- **Well-Posed**: The problem is fully specified. All necessary parameters ($S_0, K, r, \\sigma, T$) and functional forms for $q(t)$ are provided. The expectations are well-defined for a Geometric Brownian Motion, ensuring a unique and stable solution exists for each case.\n- **Objective**: The problem is stated using precise mathematical and financial terminology, free of ambiguity or subjective claims.\n\nThe verdict is that the problem is **valid**. It is self-contained, scientifically grounded, and well-posed. We proceed with the solution.\n\nThe task is to compute the values of $u_A(S_0,0)$ and $u_B(S_0,0)$ for five different specifications of the rate function $q(t)$. Both models lead to expressions that can be evaluated using the Black-Scholes-Merton (BSM) formula for a European call option. The BSM price for an option with initial stock price $S_0$, strike price $K$, maturity $T$, constant risk-free rate $r$, constant continuous dividend yield $q$, and constant volatility $\\sigma$ is given by:\n$$\nC(S_0, K, T, r, q, \\sigma) = S_0 e^{-qT} N(d_1) - K e^{-rT} N(d_2)\n$$\nwhere $N(\\cdot)$ is the cumulative distribution function (CDF) of the standard normal distribution, and\n$$\nd_1 = \\frac{\\ln(S_0/K) + (r - q + \\sigma^2/2)T}{\\sigma\\sqrt{T}}\n$$\n$$\nd_2 = d_1 - \\sigma\\sqrt{T}\n$$\n\nWe now analyze each model in the context of this formula.\n\n**Model A: Killing-Rate Model**\nThe price is given by the expectation:\n$$\nu_A(S_0,0) = \\mathbb{E}\\left[\\exp\\left(-\\int_{0}^{T} (r + q(t))\\,\\mathrm{d}t\\right)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right]\n$$\nThe underlying process is $\\mathrm{d}S_t = r S_t \\, \\mathrm{d}t + \\sigma S_t \\, \\mathrm{d}W_t$. Since $r$ is constant and $q(t)$ is a deterministic function of time, the discount factor can be separated from the expectation:\n$$\nu_A(S_0,0) = \\exp\\left(-\\int_{0}^{T} q(t)\\,\\mathrm{d}t\\right) \\mathbb{E}\\left[\\exp(-rT)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right]\n$$\nThe remaining expectation term, $\\mathbb{E}\\left[\\exp(-rT)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right]$, is precisely the BSM price of a European call option for an underlying with drift $r$, which corresponds to the BSM formula with a dividend yield of $q=0$. Let this be $C_0 = C(S_0, K, T, r, 0, \\sigma)$. Thus, the formula for Model A is:\n$$\nu_A(S_0,0) = \\exp\\left(-\\int_{0}^{T} q(t)\\,\\mathrm{d}t\\right) \\times C_0\n$$\n\n**Model B: Dividend-Yield Model**\nThe price is given by:\n$$\nu_B(S_0,0) = \\mathbb{E}\\left[\\exp(-rT)\\,\\varphi(S_T)\\,\\Big|\\,S_0\\right]\n$$\nThe underlying process is $\\mathrm{d}S_t = (r - q(t))S_t \\, \\mathrm{d}t + \\sigma S_t \\, \\mathrm{d}W_t$. The solution to this SDE at time $T$ is:\n$$\nS_T = S_0 \\exp\\left(\\int_0^T (r - q(t) - \\sigma^2/2)\\,\\mathrm{d}t + \\sigma W_T\\right)\n$$\nSince $q(t)$ is deterministic, the integral is also deterministic. Let us define the time-averaged dividend yield $\\bar{q}$ as:\n$$\n\\bar{q} = \\frac{1}{T}\\int_{0}^{T} q(t)\\,\\mathrm{d}t\n$$\nThen, $\\int_0^T (r-q(t))\\,\\mathrm{d}t = (r-\\bar{q})T$. The distribution of $S_T$ is lognormal and is identical to the distribution of an asset following a GBM with a constant drift rate of $r-\\bar{q}$. The pricing formula is therefore the standard BSM formula with the constant dividend yield $q$ replaced by the average yield $\\bar{q}$:\n$$\nu_B(S_0,0) = C(S_0, K, T, r, \\bar{q}, \\sigma)\n$$\n\nWe now apply these formulas to the given test cases using the common parameters: $S_0 = 100$, $K = 100$, $r = 0.03$, $\\sigma = 0.2$, and $T = 1$. Since $S_0 = K$, the term $\\ln(S_0/K) = 0$.\n\nFirst, we calculate the baseline price $C_0 = C(100, 100, 1, 0.03, 0, 0.2)$:\n$d_1 = \\frac{(0.03 - 0 + 0.2^2/2) \\times 1}{0.2\\sqrt{1}} = \\frac{0.05}{0.2} = 0.25$.\n$d_2 = 0.25 - 0.2\\sqrt{1} = 0.05$.\n$C_0 = 100 \\times e^0 \\times N(0.25) - 100 \\times e^{-0.03 \\times 1} \\times N(0.05)$.\nUsing $N(0.25) \\approx 0.598706$ and $N(0.05) \\approx 0.519939$, we find $C_0 \\approx 9.412819$.\n\n**Case #1: $q(t) = 0$**\n- $\\int_0^T q(t)\\,\\mathrm{d}t = 0$.\n- $\\bar{q} = 0$.\n- $u_A^{(1)} = e^{-0} \\times C_0 = C_0 \\approx 9.412819$.\n- $u_B^{(1)} = C(100, 100, 1, 0.03, 0, 0.2) = C_0 \\approx 9.412819$.\n\n**Case #2: $q(t) = 0.02$**\n- $\\int_0^T q(t)\\,\\mathrm{d}t = 0.02 \\times 1 = 0.02$.\n- $\\bar{q} = 0.02$.\n- $u_A^{(2)} = e^{-0.02} \\times C_0 \\approx 0.980199 \\times 9.412819 \\approx 9.226391$.\n- $u_B^{(2)} = C(100, 100, 1, 0.03, 0.02, 0.2)$.\n  $d_1 = \\frac{(0.03 - 0.02 + 0.02)}{0.2} = 0.15$.\n  $d_2 = 0.15 - 0.2 = -0.05$.\n  $u_B^{(2)} = 100 e^{-0.02} N(0.15) - 100 e^{-0.03} N(-0.05) \\approx 8.267096$.\n\n**Case #3: $q(t) = 0.05$**\n- $\\int_0^T q(t)\\,\\mathrm{d}t = 0.05 \\times 1 = 0.05$.\n- $\\bar{q} = 0.05$.\n- $u_A^{(3)} = e^{-0.05} \\times C_0 \\approx 0.951229 \\times 9.412819 \\approx 8.953530$.\n- $u_B^{(3)} = C(100, 100, 1, 0.03, 0.05, 0.2)$.\n  $d_1 = \\frac{(0.03 - 0.05 + 0.02)}{0.2} = 0$.\n  $d_2 = 0 - 0.2 = -0.2$.\n  $u_B^{(3)} = 100 e^{-0.05} N(0) - 100 e^{-0.03} N(-0.2) \\approx 6.730836$.\n\n**Case #4: $q(t) = 0.10$**\n- $\\int_0^T q(t)\\,\\mathrm{d}t = 0.10 \\times 1 = 0.10$.\n- $\\bar{q} = 0.10$.\n- $u_A^{(4)} = e^{-0.10} \\times C_0 \\approx 0.904837 \\times 9.412819 \\approx 8.517192$.\n- $u_B^{(4)} = C(100, 100, 1, 0.03, 0.10, 0.2)$.\n  $d_1 = \\frac{(0.03 - 0.10 + 0.02)}{0.2} = -0.25$.\n  $d_2 = -0.25 - 0.2 = -0.45$.\n  $u_B^{(4)} = 100 e^{-0.10} N(-0.25) - 100 e^{-0.03} N(-0.45) \\approx 4.648986$.\n\n**Case #5: Piecewise-constant $q(t)$**\n- $q(t) = 0.10$ for $t \\in [0, 0.25]$ and $q(t) = 0$ for $t \\in (0.25, 1]$.\n- $\\int_0^T q(t)\\,\\mathrm{d}t = \\int_0^{0.25} 0.10 \\, \\mathrm{d}t + \\int_{0.25}^1 0 \\, \\mathrm{d}t = 0.10 \\times 0.25 = 0.025$.\n- $\\bar{q} = \\frac{0.025}{1} = 0.025$.\n- $u_A^{(5)} = e^{-0.025} \\times C_0 \\approx 0.975310 \\times 9.412819 \\approx 9.180479$.\n- $u_B^{(5)} = C(100, 100, 1, 0.03, 0.025, 0.2)$.\n  $d_1 = \\frac{(0.03 - 0.025 + 0.02)}{0.2} = 0.125$.\n  $d_2 = 0.125 - 0.2 = -0.075$.\n  $u_B^{(5)} = 100 e^{-0.025} N(0.125) - 100 e^{-0.03} N(-0.075) \\approx 7.990990$.\n\nThese values, rounded to six decimal places, will be presented in the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes European call option prices for two different models\n    (killing-rate and dividend-yield) based on the Feynman-Kac theorem.\n    \"\"\"\n\n    def black_scholes_call(S0, K, T, r, q, sigma):\n        \"\"\"\n        Calculates the price of a European call option using the Black-Scholes-Merton formula.\n        \"\"\"\n        if sigma = 0 or T = 0:\n            return max(0, S0 - K) if T == 0 else max(0, S0 * np.exp(-q * T) - K * np.exp(-r * T))\n\n        d1 = (np.log(S0 / K) + (r - q + 0.5 * sigma**2) * T) / (sigma * np.sqrt(T))\n        d2 = d1 - sigma * np.sqrt(T)\n        \n        price = S0 * np.exp(-q * T) * norm.cdf(d1) - K * np.exp(-r * T) * norm.cdf(d2)\n        return price\n\n    # Common parameters\n    S0 = 100.0\n    K = 100.0\n    r = 0.03\n    sigma = 0.2\n    T = 1.0\n\n    # Test cases for the rate function q(t)\n    test_cases = [\n        {'type': 'constant', 'q_val': 0.0},\n        {'type': 'constant', 'q_val': 0.02},\n        {'type': 'constant', 'q_val': 0.05},\n        {'type': 'constant', 'q_val': 0.10},\n        {'type': 'piecewise', 'pieces': [(0.10, 0.0, 0.25), (0.0, 0.25, 1.0)]}\n    ]\n\n    results = []\n\n    # Calculate the baseline price for q=0, which is used in Model A\n    price_q0 = black_scholes_call(S0, K, T, r, 0.0, sigma)\n\n    for case in test_cases:\n        if case['type'] == 'constant':\n            integral_q_dt = case['q_val'] * T\n        elif case['type'] == 'piecewise':\n            integral_q_dt = sum(q_val * (end_t - start_t) for q_val, start_t, end_t in case['pieces'])\n        \n        q_bar = integral_q_dt / T\n\n        # Model A: u_A = exp(-integral(q(t) dt)) * C(q=0)\n        u_A = np.exp(-integral_q_dt) * price_q0\n\n        # Model B: u_B = C(q=q_bar)\n        u_B = black_scholes_call(S0, K, T, r, q_bar, sigma)\n\n        results.append(round(u_A, 6))\n        results.append(round(u_B, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "2440799"}]}