{"hands_on_practices": [{"introduction": "The most effective way to understand Gaussian elimination is to apply it manually. This first exercise guides you through solving a standard $3 \\times 3$ system of linear equations, allowing you to focus on the core mechanics of using row operations to create an upper-triangular matrix and solve for the variables.", "problem": "Consider the following system of linear equations in three variables $x, y,$ and $z$:\n$$\n\\begin{cases}\nx + y + z = 4 \\\\\n2x - y + z = 8 \\\\\nx - 2y - z = 1\n\\end{cases}\n$$\nUsing the method of Gaussian elimination, transform the system into row echelon form and determine the value of the variable $z$.", "solution": "We write the augmented matrix for the system:\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & 1 & 4 \\\\\n2 & -1 & 1 & 8 \\\\\n1 & -2 & -1 & 1\n\\end{array}\n\\right].\n$$\nStep 1: Eliminate $x$ from the second row via $R_2\\leftarrow R_2-2R_1$ and from the third row via $R_3\\leftarrow R_3-R_1$:\n$$\nR_2: (2-2\\cdot1,\\;-1-2\\cdot1,\\;1-2\\cdot1\\;|\\;8-2\\cdot4)\n=(0,\\,-3,\\,-1\\;|\\;0),\n$$\n$$\nR_3: (1-1,\\;-2-1,\\;-1-1\\;|\\;1-4)\n=(0,\\,-3,\\,-2\\;|\\;-3).\n$$\nThe matrix becomes\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & 1 & 4 \\\\\n0 & -3 & -1 & 0 \\\\\n0 & -3 & -2 & -3\n\\end{array}\n\\right].\n$$\nStep 2: Eliminate $y$ from the third row via $R_3\\leftarrow R_3-R_2$:\n$$\nR_3: (0-0,\\;-3-(-3),\\;-2-(-1)\\;|\\;-3-0)\n=(0,\\;0,\\;-1\\;|\\;-3).\n$$\nNow the matrix is in row echelon form:\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & 1 & 4 \\\\\n0 & -3 & -1 & 0 \\\\\n0 & 0 & -1 & -3\n\\end{array}\n\\right].\n$$\nFrom the third row we have\n$$\n-1\\cdot z=-3,\n$$\nhence\n$$\nz=3.\n$$", "answer": "$$\\boxed{3}$$", "id": "23125"}, {"introduction": "Beyond finding unique solutions, Gaussian elimination is a powerful diagnostic tool for understanding the nature of a linear system. This practice presents a system that has no solution, demonstrating how the elimination process naturally reveals this inconsistency by leading to a logical contradiction. Mastering this helps in identifying ill-posed economic or financial models.", "problem": "Analyze the following system of linear equations and determine the nature of its solution set for the variables $x$, $y$, and $z$.\n\n$$\n\\begin{cases}\n\\phantom{1}x + \\phantom{1}y + z = 3 \\\\\n2x - \\phantom{1}y + 3z = 4 \\\\\n3x \\phantom{{}+0y} + 4z = 8\n\\end{cases}\n$$\n\nSelect the correct statement from the options below.\n\nA. The system has a unique solution.\n\nB. The system has infinitely many solutions with one free parameter.\n\nC. The system has infinitely many solutions with two free parameters.\n\nD. The system is inconsistent (has no solution).", "solution": "Let the system be\n$$\n\\begin{cases}\nx + y + z = 3, \\\\\n2x - y + 3z = 4, \\\\\n3x + 4z = 8.\n\\end{cases}\n$$\nFirst, check whether a unique solution is possible by computing the determinant of the coefficient matrix\n$$\nA=\\begin{pmatrix}\n1 & 1 & 1 \\\\\n2 & -1 & 3 \\\\\n3 & 0 & 4\n\\end{pmatrix}.\n$$\nCompute\n$$\n\\det(A)=1\\cdot\\det\\begin{pmatrix}-1 & 3 \\\\ 0 & 4\\end{pmatrix}\n-1\\cdot\\det\\begin{pmatrix}2 & 3 \\\\ 3 & 4\\end{pmatrix}\n+1\\cdot\\det\\begin{pmatrix}2 & -1 \\\\ 3 & 0\\end{pmatrix}.\n$$\nEvaluate each minor:\n$$\n\\det\\begin{pmatrix}-1 & 3 \\\\ 0 & 4\\end{pmatrix}=-4,\\quad\n\\det\\begin{pmatrix}2 & 3 \\\\ 3 & 4\\end{pmatrix}=8-9=-1,\\quad\n\\det\\begin{pmatrix}2 & -1 \\\\ 3 & 0\\end{pmatrix}=0-(-3)=3.\n$$\nThus\n$$\n\\det(A)=-4-(-1)+3=0.\n$$\nSince $\\det(A)=0$, the system does not have a unique solution; it either has infinitely many solutions or is inconsistent. To decide, test consistency by elimination.\n\nFrom the first equation, use elimination with the second and third:\n- Compute $(2)-(2)\\times(1)$:\n$$\n(2x - y + 3z) - 2(x + y + z) = 4 - 6 \\;\\Rightarrow\\; -3y + z = -2.\n$$\n- Compute $(3)-(3)\\times(1)$:\n$$\n(3x + 4z) - 3(x + y + z) = 8 - 9 \\;\\Rightarrow\\; -3y + z = -1.\n$$\nThese two derived equations,\n$$\n-3y + z = -2 \\quad \\text{and} \\quad -3y + z = -1,\n$$\nhave identical left-hand sides but different right-hand sides, which is impossible to satisfy simultaneously. Therefore, the system is inconsistent and has no solution.\n\nHence, the correct choice is D.", "answer": "$$\\boxed{D}$$", "id": "2175259"}, {"introduction": "In computational economics and finance, theoretical algorithms meet the practical limitations of computer arithmetic. This advanced exercise uses a realistic asset pricing scenario to illustrate the critical issue of numerical instability and how a naive application of Gaussian elimination can yield incorrect results. It highlights why techniques like partial pivoting are essential for obtaining reliable and meaningful financial data.", "problem": "Consider a two-state, one-period economy with complete markets. Let $q_1$ and $q_2$ denote the Arrow–Debreu state prices (prices today of one unit of consumption delivered in state $1$ or state $2$, respectively). Under the no-arbitrage principle, the price $p_j$ of any traded asset $j$ with payoffs $x_{1j}$ and $x_{2j}$ across the two states satisfies the system\n$$\np_j \\;=\\; q_1 x_{1j} \\;+\\; q_2 x_{2j}, \\quad j \\in \\{1,2\\}.\n$$\nYou observe two traded assets with the following payoffs and prices (all monetary amounts are in dollars):\n- Asset $1$: payoff vector $(x_{11}, x_{21}) = (0.001234,\\, 1.000000)$ with price $p_1 = 1.001234$.\n- Asset $2$: payoff vector $(x_{12}, x_{22}) = (1.000000,\\, 1.000000)$ with price $p_2 = 2.000000$.\n\nAssume the market is arbitrage-free and complete. An analyst attempts to recover $(q_1, q_2)$ by solving the $2\\times 2$ linear system for $(q_1, q_2)$ using Gaussian elimination. However, the analyst uses arithmetic rounded to three significant figures at every intermediate step of the algorithm.\n\nTasks:\n1) Set up the linear system in the form $A \\boldsymbol{q} = \\boldsymbol{p}$ with\n$$\nA \\;=\\; \\begin{pmatrix}\n0.001234 & 1.000000 \\\\\n1.000000 & 1.000000\n\\end{pmatrix}, \n\\quad \n\\boldsymbol{q} \\;=\\; \\begin{pmatrix} q_1 \\\\ q_2 \\end{pmatrix}, \n\\quad \n\\boldsymbol{p} \\;=\\; \\begin{pmatrix} 1.001234 \\\\ 2.000000 \\end{pmatrix}.\n$$\n2) Perform Gaussian elimination without pivoting on the augmented matrix, carrying out all arithmetic (including each intermediate result) to three significant figures by rounding. Denote the resulting estimate by $(\\tilde{q}_1, \\tilde{q}_2)$.\n3) Using $(\\tilde{q}_1, \\tilde{q}_2)$, compute the model-implied no-arbitrage value $\\tilde{v}$ of an Arrow–Debreu security paying $(1, 0)$ across the two states.\n4) In the same arbitrage-free market, the observed market value $v$ of this Arrow–Debreu security is consistent with the true state prices that exactly solve the system above (so $v = q_1$). Using the data given, this observed $v$ equals $1.000000$. The analyst who used Gaussian elimination without pivoting would therefore claim a spurious arbitrage exists by shorting the observed security and buying its replicating portfolio at their model-implied value, with per-unit profit $\\pi = v - \\tilde{v}$.\n5) Now repeat the elimination with partial pivoting (always swapping to place the largest-magnitude available pivot on the diagonal before eliminating), again with three significant figures arithmetic at every step, to obtain $(\\hat{q}_1, \\hat{q}_2)$ and the corresponding $\\hat{v}$. Explain why this eliminates the spurious arbitrage.\n\nReport, as your final answer, the spurious arbitrage profit per unit $\\pi$ computed in step $4$, rounded to three significant figures. Express the final profit in dollars.", "solution": "First, we note that the exact solution to the system is $q_1 = 1$ and $q_2 = 1$. This can be seen by subtracting the first equation ($0.001234 q_1 + q_2 = 1.001234$) from the second ($q_1 + q_2 = 2$), which yields $(1 - 0.001234) q_1 = 2 - 1.001234$, or $0.998766 q_1 = 0.998766$, so $q_1 = 1$. Substituting this back gives $q_2 = 1$.\n\nWe now analyze the solution using finite-precision arithmetic, rounding every intermediate calculation to 3 significant figures.\n\n**Part 1: Gaussian Elimination without Pivoting**\n\nWe set up the augmented matrix $[A|\\boldsymbol{p}]$ and round its entries to 3 significant figures:\n$$\n[A|\\boldsymbol{p}] = \\left[ \\begin{array}{cc|c}\n0.001234 & 1.000000 & 1.001234 \\\\\n1.000000 & 1.000000 & 2.000000\n\\end{array} \\right] \\quad \\rightarrow \\quad \\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n1.00 & 1.00 & 2.00\n\\end{array} \\right]\n$$\nThe pivot is $a_{11} = 0.00123$. The multiplier is $m = \\frac{1.00}{0.00123} \\approx 813.008 \\to 813$.\nWe perform the row operation $R_2 \\leftarrow R_2 - m R_1$:\n- New element in row 2, col 2: $1.00 - (813 \\times 1.00) = -812$.\n- New element in row 2, RHS: $2.00 - (813 \\times 1.00) = -811$.\nThe system becomes:\n$$\n\\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n0 & -812 & -811\n\\end{array} \\right]\n$$\nBack substitution:\nFrom the second row, $-812 \\tilde{q}_2 = -811 \\implies \\tilde{q}_2 = \\frac{811}{812} \\approx 0.99876 \\to 0.999$.\nFrom the first row, $0.00123 \\tilde{q}_1 + (1.00 \\times 0.999) = 1.00 \\implies 0.00123 \\tilde{q}_1 + 0.999 = 1.00$.\nThis gives $0.00123 \\tilde{q}_1 = 1.00 - 0.999 = 0.001$. Note the loss of significant figures here.\nFinally, $\\tilde{q}_1 = \\frac{0.001}{0.00123} \\approx 0.81300 \\to 0.813$.\nThe computed solution is $(\\tilde{q}_1, \\tilde{q}_2) = (0.813, 0.999)$. The model-implied value of the Arrow-Debreu security is $\\tilde{v} = \\tilde{q}_1 = 0.813$.\n\nThe spurious arbitrage profit is $\\pi = v - \\tilde{v} = 1.000 - 0.813 = 0.187$.\n\n**Part 2: Gaussian Elimination with Partial Pivoting**\n\nWe start with the rounded augmented matrix. Since $|a_{21}| = 1.00 > |a_{11}| = 0.00123$, we swap the rows:\n$$\n\\left[ \\begin{array}{cc|c}\n1.00 & 1.00 & 2.00 \\\\\n0.00123 & 1.00 & 1.00\n\\end{array} \\right]\n$$\nThe pivot is $a_{11} = 1.00$. The multiplier is $m = \\frac{0.00123}{1.00} = 0.00123$.\nWe perform the row operation $R_2 \\leftarrow R_2 - m R_1$:\n- New element in row 2, col 2: $1.00 - (0.00123 \\times 1.00) = 0.99877 \\to 0.999$.\n- New element in row 2, RHS: $1.00 - (0.00123 \\times 2.00) = 1.00 - 0.00246 = 0.99754 \\to 0.998$.\nThe system becomes:\n$$\n\\left[ \\begin{array}{cc|c}\n1.00 & 1.00 & 2.00 \\\\\n0 & 0.999 & 0.998\n\\end{array} \\right]\n$$\nBack substitution:\nFrom the second row, $0.999 \\hat{q}_2 = 0.998 \\implies \\hat{q}_2 = \\frac{0.998}{0.999} \\approx 0.99899 \\to 0.999$.\nFrom the first row, $1.00 \\hat{q}_1 + (1.00 \\times 0.999) = 2.00 \\implies 1.00 \\hat{q}_1 + 0.999 = 2.00$.\nThis gives $1.00 \\hat{q}_1 = 2.00 - 0.999 = 1.001 \\to 1.00$.\nSo $\\hat{q}_1 = 1.00$.\nThe computed solution is $(\\hat{q}_1, \\hat{q}_2) = (1.00, 0.999)$. The model-implied value is $\\hat{v} = \\hat{q}_1 = 1.00$, which eliminates the spurious arbitrage.\n\n**Explanation**\nThe spurious arbitrage is a direct consequence of numerical instability in the Gaussian elimination algorithm without pivoting. The matrix $A$ has elements of vastly different magnitudes. When no pivoting is used, the small element $a_{11} = 0.00123$ is chosen as the pivot. This results in a very large multiplier, $m = 813$. During the elimination step $R_2 \\leftarrow R_2 - m R_1$, the original information in row $2$ is effectively destroyed by subtraction of a large number. This leads to catastrophic cancellation in the subsequent back-substitution step ($1.00 - 0.999 = 0.001$), where two nearly equal numbers are subtracted, resulting in a loss of significant figures and a grossly inaccurate result for $\\tilde{q}_1 = 0.813$. Partial pivoting corrects this instability by swapping rows to ensure that the pivot element is the largest-magnitude element available in the column. This guarantees that the multiplier is small ($|m| \\le 1$), which preserves the significant digits of the original matrix entries. The resulting calculation is numerically stable, yielding $\\hat{q}_1 = 1.00$, an accurate result that correctly indicates the absence of arbitrage.", "answer": "$$\n\\boxed{0.187}\n$$", "id": "2396422"}]}