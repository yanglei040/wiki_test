{"hands_on_practices": [{"introduction": "Mastering splines involves not just knowing the formulas, but understanding how the data's geometry shapes the final curve. This first exercise explores a fundamental connection between the placement of data points and a key feature of the spline: an inflection point. By deriving the condition that forces the second derivative to be zero at a knot, i.e., $s''(x_1)=0$, you'll gain a deeper intuition for how splines achieve their characteristic smoothness.", "problem": "Let $x_0x_1x_2$ be strictly increasing real numbers with $h_0:=x_1-x_00$ and $h_1:=x_2-x_10$. Consider the unique natural cubic spline $s(x)$ that interpolates the data $\\{(x_j,y_j)\\}_{j=0}^2$, meaning $s(x_j)=y_j$ for $j=0,1,2$, $s(x)$ is twice continuously differentiable on $[x_0,x_2]$, piecewise cubic on $[x_0,x_1]$ and $[x_1,x_2]$, and satisfies the natural boundary conditions $s''(x_0)=0$ and $s''(x_2)=0$.\n\nDetermine the coefficient $\\alpha=\\alpha(h_0,h_1)$ such that the spline $s(x)$ has an inflection point at the interior knot $x_1$ if and only if\n$$\ny_1=\\alpha\\,y_0+\\bigl(1-\\alpha\\bigr)\\,y_2.\n$$\nProvide $\\alpha$ as a closed-form analytic expression in terms of $h_0$ and $h_1$ only. No numerical rounding is required.", "solution": "Let $s(x)$ be the natural cubic spline interpolating the data points $\\{(x_j, y_j)\\}_{j=0}^2$, where $x_0  x_1  x_2$. The intervals are defined as $h_0 = x_1 - x_0  0$ and $h_1 = x_2 - x_1  0$. By definition, a cubic spline is a piecewise cubic polynomial that is twice continuously differentiable. Let $M_j = s''(x_j)$ for $j=0,1,2$ be the second derivatives of the spline at the knots, which are also called moments.\n\nFor a general cubic spline, the continuity of the first derivative, $s'(x_1^-) = s'(x_1^+)$, at the interior knot $x_1$ imposes a linear relationship between the moments. This standard result is given by the following equation:\n$$\n\\frac{h_0}{6} M_0 + \\frac{h_0+h_1}{3} M_1 + \\frac{h_1}{6} M_2 = \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\n$$\nThe problem specifies that $s(x)$ is a *natural* cubic spline. This imposes the boundary conditions $s''(x_0)=0$ and $s''(x_2)=0$. In terms of moments, these conditions are $M_0=0$ and $M_2=0$.\n\nSubstituting these natural boundary conditions into the general moment equation gives:\n$$\n\\frac{h_0}{6} (0) + \\frac{h_0+h_1}{3} M_1 + \\frac{h_1}{6} (0) = \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\n$$\nThis simplifies to:\n$$\n\\left(\\frac{h_0+h_1}{3}\\right) M_1 = \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\n$$\nThe problem requires that the spline has an inflection point at the interior knot $x_1$. A point of inflection on a twice-differentiable function occurs where the second derivative is zero. Therefore, this condition is equivalent to $s''(x_1) = 0$, which means $M_1=0$.\n\nThe problem states that this inflection point exists \"if and only if\" a certain relationship between the $y_j$ values holds. Since $h_00$ and $h_10$, the coefficient $\\frac{h_0+h_1}{3}$ is strictly positive and non-zero. Consequently, the condition $M_1=0$ is equivalent to the right-hand side of the equation being zero:\n$$\nM_1 = 0 \\iff \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0} = 0\n$$\nThis establishes the \"if and only if\" logic. We now solve this equation for $y_1$ to find the required relationship.\n$$\n\\frac{y_2-y_1}{h_1} = \\frac{y_1-y_0}{h_0}\n$$\nThis condition has a clear geometric interpretation: the slope of the line segment connecting $(x_0, y_0)$ and $(x_1, y_1)$ must be equal to the slope of the line segment connecting $(x_1, y_1)$ and $(x_2, y_2)$. This means the three data points must be collinear.\n\nTo find the coefficient $\\alpha$, we perform algebraic manipulation:\n$$\nh_0(y_2-y_1) = h_1(y_1-y_0)\n$$\n$$\nh_0 y_2 - h_0 y_1 = h_1 y_1 - h_1 y_0\n$$\n$$\nh_1 y_0 + h_0 y_2 = (h_0 + h_1) y_1\n$$\nSolving for $y_1$, we obtain:\n$$\ny_1 = \\left(\\frac{h_1}{h_0+h_1}\\right) y_0 + \\left(\\frac{h_0}{h_0+h_1}\\right) y_2\n$$\nThe problem states that this relationship must be in the form $y_1 = \\alpha y_0 + (1-\\alpha) y_2$. By comparing the coefficients of $y_0$ in both expressions, we identify $\\alpha$:\n$$\n\\alpha = \\frac{h_1}{h_0+h_1}\n$$\nTo verify, we check if the coefficient of $y_2$ is equal to $1-\\alpha$:\n$$\n1-\\alpha = 1 - \\frac{h_1}{h_0+h_1} = \\frac{h_0+h_1-h_1}{h_0+h_1} = \\frac{h_0}{h_0+h_1}\n$$\nThis matches the coefficient of $y_2$ in our derived expression. Thus, the identification is correct. The coefficient $\\alpha$ is a function of $h_0$ and $h_1$ only, as required.", "answer": "$$\n\\boxed{\\frac{h_1}{h_0+h_1}}\n$$", "id": "2429320"}, {"introduction": "From properties, we move to construction. This practice challenges you to build a unique cubic spline from first principles, but with a twist on the typical boundary conditions used in textbooks. Instead of assuming zero velocity or acceleration, you'll enforce a specific, non-zero initial acceleration to model a hypothetical launch scenario. This exercise will solidify your ability to translate physical or design constraints into the mathematical system that defines a spline.", "problem": "A vertical launch is sampled at three times $t_0$, $t_1$, and $t_2$ with $t_0=0\\,\\text{s}$, $t_1=1\\,\\text{s}$, and $t_2=2\\,\\text{s}$. The measured heights are $y_0=0\\,\\text{m}$, $y_1=1\\,\\text{m}$, and $y_2=0\\,\\text{m}$. Let $S(t)$ be the unique cubic spline that is piecewise cubic on $[t_0,t_1]$ and $[t_1,t_2]$, globally twice continuously differentiable, and interpolates the data $S(t_i)=y_i$ for $i\\in\\{0,1,2\\}$. To model a launch with a specified initial acceleration, replace the usual clamped left-endpoint velocity condition with the nonzero acceleration condition $S''(t_0)=2\\,\\text{m}/\\text{s}^2$, and at the right endpoint impose a clamped velocity $S'(t_2)=0\\,\\text{m}/\\text{s}$.\n\nUsing this spline $S(t)$, determine the interpolated height at $t=0.5\\,\\text{s}$. Express your final answer in meters.", "solution": "Let the cubic spline $S(t)$ be defined piecewise as:\n$$\nS(t) =\n\\begin{cases}\nS_0(t)  \\text{for } t \\in [0, 1] \\\\\nS_1(t)  \\text{for } t \\in [1, 2]\n\\end{cases}\n$$\nWe define the two cubic polynomials. For computational convenience, the second polynomial is defined relative to the knot $t_1=1$.\n$S_0(t) = a_0 + b_0 t + c_0 t^2 + d_0 t^3$\n$S_1(t) = a_1 + b_1 (t-1) + c_1 (t-1)^2 + d_1 (t-1)^3$\n\nThe first and second derivatives are:\n$S_0'(t) = b_0 + 2c_0 t + 3d_0 t^2$\n$S_0''(t) = 2c_0 + 6d_0 t$\n$S_1'(t) = b_1 + 2c_1 (t-1) + 3d_1 (t-1)^2$\n$S_1''(t) = 2c_1 + 6d_1 (t-1)$\n\nWe apply the given conditions to determine the $8$ coefficients: $a_0, b_0, c_0, d_0, a_1, b_1, c_1, d_1$. The problem data provides 8 constraints: 3 interpolation points, 2 continuity conditions at the interior knot, and 2 boundary conditions, ensuring a unique solution.\n\n1.  **Interpolation Conditions:**\n    - $S(0) = y_0 \\implies S_0(0) = 0 \\implies a_0 = 0$.\n    - $S(1) = y_1 \\implies S_0(1) = 1 \\implies a_0 + b_0 + c_0 + d_0 = 1$. With $a_0=0$, this gives $b_0 + c_0 + d_0 = 1$.\n    - $S(1) = y_1 \\implies S_1(1) = 1 \\implies a_1 = 1$.\n    - $S(2) = y_2 \\implies S_1(2) = 0 \\implies a_1 + b_1(2-1) + c_1(2-1)^2 + d_1(2-1)^3 = 0$. With $a_1=1$, this gives $1 + b_1 + c_1 + d_1 = 0$.\n\n2.  **Continuity Conditions at $t=1$:**\n    - $S_0'(1) = S_1'(1) \\implies b_0 + 2c_0 + 3d_0 = b_1$.\n    - $S_0''(1) = S_1''(1) \\implies 2c_0 + 6d_0 = 2c_1 \\implies c_0 + 3d_0 = c_1$.\n\n3.  **Boundary Conditions:**\n    - $S''(0) = 2 \\implies S_0''(0) = 2c_0 = 2 \\implies c_0 = 1$.\n    - $S'(2) = 0 \\implies S_1'(2) = 0 \\implies b_1 + 2c_1(2-1) + 3d_1(2-1)^2 = 0 \\implies b_1 + 2c_1 + 3d_1 = 0$.\n\nWe have now determined three coefficients: $a_0=0$, $a_1=1$, and $c_0=1$. We substitute $c_0=1$ into the system of equations for the remaining five coefficients ($b_0, d_0, b_1, c_1, d_1$):\n(A) $b_0 + 1 + d_0 = 1 \\implies b_0 + d_0 = 0$.\n(B) $1 + b_1 + c_1 + d_1 = 0$.\n(C) $b_0 + 2(1) + 3d_0 = b_1 \\implies b_0 + 2 + 3d_0 = b_1$.\n(D) $1 + 3d_0 = c_1$.\n(E) $b_1 + 2c_1 + 3d_1 = 0$.\n\nFrom equation (A), we find $b_0 = -d_0$.\nSubstitute this into (C): $-d_0 + 2 + 3d_0 = b_1 \\implies b_1 = 2 + 2d_0$.\nNow we have expressions for $b_1$ and $c_1$ in terms of $d_0$. We substitute these into equations (B) and (E) to create a system for $d_0$ and $d_1$.\n\nSubstitute $b_1$ and $c_1$ into (B):\n$1 + (2 + 2d_0) + (1 + 3d_0) + d_1 = 0$\n$4 + 5d_0 + d_1 = 0 \\implies d_1 = -4 - 5d_0$.\n\nSubstitute $b_1$ and $c_1$ into (E):\n$(2 + 2d_0) + 2(1 + 3d_0) + 3d_1 = 0$\n$2 + 2d_0 + 2 + 6d_0 + 3d_1 = 0$\n$4 + 8d_0 + 3d_1 = 0$.\n\nNow, substitute the expression for $d_1$ into this last equation:\n$4 + 8d_0 + 3(-4 - 5d_0) = 0$\n$4 + 8d_0 - 12 - 15d_0 = 0$\n$-8 - 7d_0 = 0$\n$7d_0 = -8 \\implies d_0 = -\\frac{8}{7}$.\n\nTo find the value of $S(0.5)$, we only need the coefficients of the polynomial $S_0(t)$. We have:\n- $a_0 = 0$\n- $c_0 = 1$\n- $d_0 = -\\frac{8}{7}$\n- $b_0 = -d_0 = -(-\\frac{8}{7}) = \\frac{8}{7}$.\n\nThe polynomial for the interval $t \\in [0, 1]$ is:\n$S_0(t) = a_0 + b_0 t + c_0 t^2 + d_0 t^3 = 0 + \\frac{8}{7}t + 1 \\cdot t^2 - \\frac{8}{7}t^3$.\n$S_0(t) = \\frac{8}{7}t + t^2 - \\frac{8}{7}t^3$.\n\nFinally, we evaluate $S(0.5) = S_0(0.5)$. Let $t = 0.5 = \\frac{1}{2}$.\n$S(0.5) = \\frac{8}{7}\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^2 - \\frac{8}{7}\\left(\\frac{1}{2}\\right)^3$\n$S(0.5) = \\frac{4}{7} + \\frac{1}{4} - \\frac{8}{7}\\left(\\frac{1}{8}\\right)$\n$S(0.5) = \\frac{4}{7} + \\frac{1}{4} - \\frac{1}{7}$\n$S(0.5) = \\left(\\frac{4}{7} - \\frac{1}{7}\\right) + \\frac{1}{4}$\n$S(0.5) = \\frac{3}{7} + \\frac{1}{4}$\nTo sum these fractions, we find a common denominator, which is $28$.\n$S(0.5) = \\frac{3 \\cdot 4}{7 \\cdot 4} + \\frac{1 \\cdot 7}{4 \\cdot 7} = \\frac{12}{28} + \\frac{7}{28} = \\frac{19}{28}$.\n\nThe interpolated height at $t=0.5\\,\\text{s}$ is $\\frac{19}{28}\\,\\text{m}$.", "answer": "$$\\boxed{\\frac{19}{28}}$$", "id": "2429242"}, {"introduction": "Once a spline model is constructed, the next step is often to analyze its behavior, such as finding where peaks and valleys occur. This final practice combines construction with analysis, asking you to find all local extrema of an interpolating spline. You will need to first determine the spline's parameters and then solve for the roots of its piecewise quadratic derivative, a crucial skill for optimization and shape analysis tasks.", "problem": "Consider the natural cubic spline $S(x)$ that interpolates the data $\\{(x_i,y_i)\\}_{i=0}^{3}$ with knots $x_0=0$, $x_1=1$, $x_2=2$, $x_3=3$ and values $y_0=0$, $y_1=2$, $y_2=1$, $y_3=2$. By definition, a natural cubic spline is a twice continuously differentiable, piecewise-cubic function that interpolates the data and satisfies $S''(x_0)=0$ and $S''(x_3)=0$. Using only these defining properties and the requirement that $S'(x)$ is piecewise quadratic, analytically determine all interior local extrema of $S(x)$, that is, all $x^{\\star}\\in(x_0,x_3)$ such that $S'(x^{\\star})=0$.\n\nProvide the $x$-coordinates of all interior local extrema in exact form (no rounding), listed in increasing order, as a single row matrix. Do not classify the extrema and do not report endpoint behavior.", "solution": "A cubic spline $S(x)$ is defined piecewise on each subinterval $[x_i, x_{i+1}]$. Let $M_i = S''(x_i)$ be the second derivative of the spline at knot $x_i$. For a natural cubic spline, the boundary conditions are $M_0 = S''(x_0)=0$ and $M_n=S''(x_n)=0$. In this problem, $n=3$, so $M_0=0$ and $M_3=0$.\n\nThe knots are equally spaced with a step size of $h = x_{i+1} - x_i = 1$. The continuity of the first derivative $S'(x)$ at the interior knots $x_1$ and $x_2$ imposes constraints on the values of $M_i$. For equally spaced knots, this relationship is given by the following system of linear equations:\n$$M_{i-1} + 4M_i + M_{i+1} = \\frac{6}{h^2}(y_{i+1} - 2y_i + y_{i-1})$$\nWith $h=1$, this simplifies to:\n$$M_{i-1} + 4M_i + M_{i+1} = 6(y_{i+1} - 2y_i + y_{i-1})$$\nWe apply this formula for the interior knots, $i=1$ and $i=2$.\n\nFor $i=1$:\n$M_0 + 4M_1 + M_2 = 6(y_2 - 2y_1 + y_0)$\nSubstituting the given values $M_0=0$, $y_0=0$, $y_1=2$, $y_2=1$:\n$0 + 4M_1 + M_2 = 6(1 - 2(2) + 0) = 6(-3) = -18$\n$$4M_1 + M_2 = -18 \\quad (1)$$\n\nFor $i=2$:\n$M_1 + 4M_2 + M_3 = 6(y_3 - 2y_2 + y_1)$\nSubstituting the given values $M_3=0$, $y_1=2$, $y_2=1$, $y_3=2$:\n$M_1 + 4M_2 + 0 = 6(2 - 2(1) + 2) = 6(2) = 12$\n$$M_1 + 4M_2 = 12 \\quad (2)$$\n\nWe solve the system of linear equations for $M_1$ and $M_2$:\nFrom equation (2), $M_1 = 12 - 4M_2$. Substituting into equation (1):\n$4(12 - 4M_2) + M_2 = -18$\n$48 - 16M_2 + M_2 = -18$\n$-15M_2 = -66 \\implies M_2 = \\frac{66}{15} = \\frac{22}{5}$.\nNow, we find $M_1$:\n$M_1 = 12 - 4\\left(\\frac{22}{5}\\right) = \\frac{60 - 88}{5} = -\\frac{28}{5}$.\nSo, the second derivatives at the knots are: $M_0=0$, $M_1 = -\\frac{28}{5}$, $M_2 = \\frac{22}{5}$, $M_3=0$.\n\nThe first derivative of the spline segment $S_i(x)$ on an interval $[x_i, x_{i+1}]$ can be expressed as a quadratic function of $u = x-x_i$. With $h=1$, the derivative is $S'_i(x) = \\frac{M_{i+1}-M_i}{2}u^2 + M_i u + \\left( (y_{i+1}-y_i) - \\frac{M_{i+1}+2M_i}{6} \\right)$. We seek roots of $S'_i(x)=0$ within each open interval $(x_i, x_{i+1})$.\n\n**Interval 1: $[0, 1]$ ($i=0$)**\nHere, $u=x$. The derivative equation $S'_0(x)=0$ is:\n$\\frac{-28/5 - 0}{2}x^2 + 0 \\cdot x + \\left( (2-0) - \\frac{-28/5+2(0)}{6} \\right) = 0$\n$-\\frac{14}{5}x^2 + \\left( 2 + \\frac{28}{30} \\right) = 0$\n$-\\frac{14}{5}x^2 + \\left( 2 + \\frac{14}{15} \\right) = 0$\n$-\\frac{14}{5}x^2 + \\frac{44}{15} = 0 \\implies x^2 = \\frac{44}{15} \\cdot \\frac{5}{14} = \\frac{22}{21}$.\nThe solutions are $x = \\pm\\sqrt{\\frac{22}{21}}$. As $\\sqrt{\\frac{22}{21}} > 1$, neither solution lies in the interval $(0,1)$. There are no extrema in this interval.\n\n**Interval 2: $[1, 2]$ ($i=1$)**\nHere, $u=x-1$. The equation $S'_1(x)=0$ becomes:\n$\\frac{M_2-M_1}{2}u^2 + M_1 u + \\left( (y_2-y_1) - \\frac{M_2+2M_1}{6} \\right) = 0$\n$\\frac{22/5 - (-28/5)}{2}u^2 - \\frac{28}{5}u + \\left( (1-2) - \\frac{22/5 + 2(-28/5)}{6} \\right) = 0$\n$\\frac{50/5}{2}u^2 - \\frac{28}{5}u + \\left( -1 - \\frac{-34/5}{6} \\right) = 0$\n$5u^2 - \\frac{28}{5}u + \\left(-1 + \\frac{17}{15}\\right) = 0$\n$5u^2 - \\frac{28}{5}u + \\frac{2}{15} = 0$.\nMultiplying by $15$ yields $75u^2 - 84u + 2 = 0$.\nUsing the quadratic formula for $u$:\n$u = \\frac{-(-84) \\pm \\sqrt{(-84)^2 - 4(75)(2)}}{2(75)} = \\frac{84 \\pm \\sqrt{7056 - 600}}{150} = \\frac{84 \\pm \\sqrt{6456}}{150}$.\nTo simplify the radical, $\\sqrt{6456} = \\sqrt{4 \\cdot 1614} = 2\\sqrt{1614}$.\n$u = \\frac{84 \\pm 2\\sqrt{1614}}{150} = \\frac{42 \\pm \\sqrt{1614}}{75}$.\nWe need $u \\in (0,1)$. We know $40^2=1600$, so $\\sqrt{1614} \\approx 40.17$.\nFor $u_1 = \\frac{42 + \\sqrt{1614}}{75}$, the numerator is approximately $82.17$, so $u_1 > 1$. This solution is outside the interval.\nFor $u_2 = \\frac{42 - \\sqrt{1614}}{75}$, the numerator is approximately $1.83$, so $0  u_2  1$. This solution is valid.\nThe corresponding $x$-coordinate is $x^{\\star}_1 = 1 + u_2 = 1 + \\frac{42 - \\sqrt{1614}}{75} = \\frac{75 + 42 - \\sqrt{1614}}{75} = \\frac{117 - \\sqrt{1614}}{75}$.\n\n**Interval 3: $[2, 3]$ ($i=2$)**\nHere, $u=x-2$. The equation $S'_2(x)=0$ becomes:\n$\\frac{M_3-M_2}{2}u^2 + M_2 u + \\left( (y_3-y_2) - \\frac{M_3+2M_2}{6} \\right) = 0$\n$\\frac{0 - 22/5}{2}u^2 + \\frac{22}{5}u + \\left( (2-1) - \\frac{0 + 2(22/5)}{6} \\right) = 0$\n$-\\frac{11}{5}u^2 + \\frac{22}{5}u + \\left( 1 - \\frac{44/5}{6} \\right) = 0$\n$-\\frac{11}{5}u^2 + \\frac{22}{5}u + \\left(1 - \\frac{22}{15}\\right) = 0$\n$-\\frac{11}{5}u^2 + \\frac{22}{5}u - \\frac{7}{15} = 0$.\nMultiplying by $-15$ yields $33u^2 - 66u + 7 = 0$.\nUsing the quadratic formula for $u$:\n$u = \\frac{-(-66) \\pm \\sqrt{(-66)^2 - 4(33)(7)}}{2(33)} = \\frac{66 \\pm \\sqrt{4356 - 924}}{66} = \\frac{66 \\pm \\sqrt{3432}}{66}$.\nWe simplify the radical: $\\sqrt{3432} = \\sqrt{4 \\cdot 858} = 2\\sqrt{858}$.\n$u = \\frac{66 \\pm 2\\sqrt{858}}{66} = 1 \\pm \\frac{\\sqrt{858}}{33}$.\nWe need $u \\in (0,1)$. We know $29^2=841$ and $30^2=900$.\nFor $u_1 = 1 + \\frac{\\sqrt{858}}{33}$, clearly $u_1  1$, so this solution is invalid.\nFor $u_2 = 1 - \\frac{\\sqrt{858}}{33}$, since $29  \\sqrt{858}  33$, we have $0  u_2  1$. This solution is valid.\nThe corresponding $x$-coordinate is $x^{\\star}_2 = 2 + u_2 = 2 + 1 - \\frac{\\sqrt{858}}{33} = 3 - \\frac{\\sqrt{858}}{33}$.\n\nThe two interior local extrema are located at $x^{\\star}_1 = \\frac{117 - \\sqrt{1614}}{75}$ and $x^{\\star}_2 = 3 - \\frac{\\sqrt{858}}{33}$.\nNumerically, $x^{\\star}_1 \\approx 1.024$ and $x^{\\star}_2 \\approx 2.112$. The extrema are listed in increasing order.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{117 - \\sqrt{1614}}{75}  3 - \\frac{\\sqrt{858}}{33} \\end{pmatrix}}$$", "id": "2429285"}]}