{"hands_on_practices": [{"introduction": "Taylor polynomials are a cornerstone of approximation theory, allowing us to represent complex functions like $\\sin(x)$ with simpler polynomials. While these approximations are highly accurate near their center of expansion, their numerical reliability can degrade significantly when evaluated far away. This first practice invites you to analyze the conditioning of a Taylor polynomial for the sine function, exploring how its sensitivity to input perturbations grows for large values of $x$ [@problem_id:2378689]. You will discover a direct relationship between the polynomial's degree and its asymptotic condition number.", "problem": "Consider the odd-degree truncated Taylor polynomial approximation of the sine function,\n$$\np_{n}(x) \\;=\\; \\sum_{k=0}^{n} (-1)^{k}\\,\\frac{x^{2k+1}}{(2k+1)!},\n$$\nwhere $n \\in \\mathbb{N}$ and $x \\in \\mathbb{R}$. Let the relative condition number for function evaluation with respect to perturbations in the input be defined by\n$$\n\\kappa_{g}(x) \\;=\\; \\lim_{\\delta \\to 0}\\,\\sup_{\\Delta x \\neq 0,\\,|\\Delta x| \\le \\delta |x|}\\, \\left| \\frac{g(x+\\Delta x) - g(x)}{g(x)} \\,\\bigg/\\, \\frac{\\Delta x}{x} \\right|,\n$$\nwhenever $g(x) \\neq 0$. For differentiable $g$, this reduces to\n$$\n\\kappa_{g}(x) \\;=\\; \\left| \\frac{x\\,g'(x)}{g(x)} \\right|.\n$$\nAnalyze the conditioning of evaluating $p_{n}(x)$ for large $|x|$ by determining the following limit:\n$$\nL(n) \\;=\\; \\lim_{|x| \\to \\infty} \\kappa_{p_{n}}(x).\n$$\nProvide your final answer as a single closed-form expression in terms of $n$. No numerical approximation or rounding is required.", "solution": "We are given the truncated Taylor polynomial\n$$\np_{n}(x) \\;=\\; \\sum_{k=0}^{n} (-1)^{k}\\,\\frac{x^{2k+1}}{(2k+1)!},\n$$\nwhich is a polynomial of degree $2n+1$. The relative condition number for evaluation of a differentiable function $g$ at $x$ with respect to perturbations in the input is\n$$\n\\kappa_{g}(x) \\;=\\; \\left| \\frac{x\\,g'(x)}{g(x)} \\right|,\n$$\nprovided $g(x) \\neq 0$. We apply this to $g = p_{n}$.\n\nFirst, we compute the derivative of $p_{n}(x)$. Differentiating term by term yields\n$$\np_{n}'(x) \\;=\\; \\sum_{k=0}^{n} (-1)^{k}\\,\\frac{(2k+1)x^{2k}}{(2k+1)!}\n\\;=\\; \\sum_{k=0}^{n} (-1)^{k}\\,\\frac{x^{2k}}{(2k)!}.\n$$\nThe relative condition number is therefore\n$$\n\\kappa_{p_{n}}(x) \\;=\\; \\left| \\frac{x\\,p_{n}'(x)}{p_{n}(x)} \\right|\n\\;=\\; \\left| \\frac{x \\displaystyle \\sum_{k=0}^{n} (-1)^{k}\\,\\dfrac{x^{2k}}{(2k)!}}{\\displaystyle \\sum_{k=0}^{n} (-1)^{k}\\,\\dfrac{x^{2k+1}}{(2k+1)!}} \\right|\n\\;=\\; \\left| \\frac{\\displaystyle \\sum_{k=0}^{n} (-1)^{k}\\,\\dfrac{x^{2k}}{(2k)!}}{\\displaystyle \\sum_{k=0}^{n} (-1)^{k}\\,\\dfrac{x^{2k}}{(2k+1)!}} \\right|.\n$$\nWe now analyze the asymptotic behavior as $|x| \\to \\infty$. Both the numerator and the denominator are polynomials in $x^2$. For large $|x|$, each polynomial is dominated by its highest-degree term.\nFor the numerator, the highest-power term is $(-1)^{n}\\frac{x^{2n}}{(2n)!}$.\nFor the denominator, the highest-power term is $(-1)^{n}\\frac{x^{2n}}{(2n+1)!}$.\n\nTo find the limit, we can divide both numerator and denominator by the highest power of $x$ common to both, which is $x^{2n}$.\n$$\n\\lim_{|x| \\to \\infty} \\kappa_{p_{n}}(x)\n\\;=\\; \\lim_{|x| \\to \\infty} \\left| \\frac{(-1)^{n}\\dfrac{x^{2n}}{(2n)!} + \\dots}{(-1)^{n}\\dfrac{x^{2n}}{(2n+1)!} + \\dots} \\right|\n\\;=\\; \\left| \\frac{\\dfrac{(-1)^{n}}{(2n)!}}{\\dfrac{(-1)^{n}}{(2n+1)!}} \\right|\n\\;=\\; \\frac{(2n+1)!}{(2n)!}\n\\;=\\; 2n+1.\n$$\nTherefore,\n$$\nL(n) \\;=\\; 2n+1.\n$$\nThis shows that the evaluation of the truncated Taylor polynomial $p_{n}(x)$ is increasingly ill-conditioned for large $|x|$, with an asymptotic relative condition number that grows linearly with the polynomial degree.", "answer": "$$\\boxed{2n+1}$$", "id": "2378689"}, {"introduction": "Beyond sensitivity to the input variable, the evaluation of a polynomial can be highly sensitive to small perturbations in its coefficients, a common scenario when coefficients are derived from experimental data. This exercise shifts our focus to this type of conditioning and presents a design challenge: create a polynomial that is perfectly well-behaved at one point but catastrophically ill-conditioned at another [@problem_id:2378702]. By tackling this, you will gain first-hand experience with subtractive cancellation, a primary culprit behind numerical instability.", "problem": "You are asked to analyze the conditioning of polynomial evaluation with respect to perturbations in the polynomialâ€™s coefficients, a situation frequently arising in computational engineering when coefficients come from measurement or modeling uncertainties. Let the data be the coefficients of a polynomial $p(x) = \\sum_{k=0}^{n} a_{k} x^{k}$, and let the evaluation point $x$ be exact. Consider small, componentwise relative perturbations to the coefficients of the form $\\tilde{a}_{k} = a_{k} (1 + \\delta_{k})$ with $|\\delta_{k}| \\ll 1$, and let $\\tilde{p}(x) = \\sum_{k=0}^{n} \\tilde{a}_{k} x^{k}$ denote the perturbed value at the same $x$.\n\nStarting from the fundamental definitions of forward error and condition number, and using first-order (linearized) perturbation analysis, derive an expression for the coefficientwise relative condition number of the evaluation map $a \\mapsto p(x)$ at a fixed $x$. Use this expression to design a concrete polynomial $p(x)$ such that evaluation is well-conditioned at $x = 0$ but catastrophically ill-conditioned at $x = 1$ under these coefficientwise relative perturbations. Your design must be justified from first principles and should use the smallest possible degree that satisfies the stated properties. Provide your final polynomial in expanded standard form with simplified coefficients. The final answer must be a single analytic expression for $p(x)$.", "solution": "First, we derive the expression for the coefficientwise relative condition number. Let the polynomial be $p(x) = \\sum_{k=0}^{n} a_{k} x^{k}$. The evaluation at a fixed point $x$ is a function of the coefficient vector $a$. When the coefficients are perturbed by componentwise relative errors $\\delta_k$, such that $\\tilde{a}_{k} = a_{k}(1 + \\delta_{k})$, the absolute error in the polynomial's value is:\n$$ \\Delta p(x) = \\tilde{p}(x) - p(x) = \\sum_{k=0}^{n} (\\tilde{a}_{k} - a_{k}) x^{k} = \\sum_{k=0}^{n} a_{k} \\delta_{k} x^{k} $$\nThe relative condition number $\\kappa(x)$ is the maximum ratio of the relative forward error, $|\\Delta p(x)|/|p(x)|$, to the magnitude of the relative backward error, $\\epsilon = \\max_k |\\delta_k|$, in the limit as $\\epsilon \\to 0$. We can bound the absolute error using the triangle inequality:\n$$ |\\Delta p(x)| = \\left| \\sum_{k=0}^{n} a_{k} \\delta_{k} x^{k} \\right| \\le \\sum_{k=0}^{n} |a_{k}| |\\delta_{k}| |x|^{k} \\le \\epsilon \\sum_{k=0}^{n} |a_{k}| |x|^{k} $$\nThis bound is attainable by choosing the signs of $\\delta_k$ appropriately. Therefore, the condition number is the ratio of this worst-case error amplification to the polynomial's value:\n$$ \\kappa(x) = \\frac{\\sum_{k=0}^{n} |a_{k}| |x|^{k}}{\\left| \\sum_{k=0}^{n} a_{k} x^{k} \\right|} $$\nNext, we design a polynomial of minimal degree that is well-conditioned at $x=0$ and ill-conditioned at $x=1$.\n\n**At $x=0$:** The condition number simplifies to $\\kappa(0) = \\frac{|a_0|}{|a_0|} = 1$, provided the constant term $a_0$ is non-zero. This represents perfect conditioning.\n\n**At $x=1$:** The condition number becomes $\\kappa(1) = \\frac{\\sum_{k=0}^{n} |a_{k}|}{|\\sum_{k=0}^{n} a_{k}|}$. For catastrophic ill-conditioning, we require this value to be very large or infinite. This occurs when the denominator, the magnitude of the sum of coefficients, is zero or near-zero, while the numerator, the sum of the magnitudes of the coefficients, is large. This is a classic case of subtractive cancellation.\n\nTo find the minimal degree:\n- A degree-0 polynomial, $p(x) = a_0$, has $\\kappa(1) = 1$, which is not ill-conditioned.\n- A degree-1 polynomial, $p(x) = a_1 x + a_0$, requires $a_0 \\neq 0$ for good conditioning at $x=0$. To achieve ill-conditioning at $x=1$, we set the denominator of $\\kappa(1)$ to zero: $|a_1 + a_0| = 0$, which implies $a_1 = -a_0$. The numerator is $|a_1| + |a_0| = 2|a_0|$, which is non-zero. This makes $\\kappa(1)$ infinite.\n\nChoosing the simplest non-zero value, $a_0=1$, gives $a_1=-1$. The resulting polynomial is $p(x) = 1-x$. This satisfies all conditions with the minimal possible degree.", "answer": "$$\n\\boxed{1-x}\n$$", "id": "2378702"}, {"introduction": "We have seen that both the evaluation point and the polynomial's structure can lead to ill-conditioning. A powerful strategy to combat this is to change the polynomial's representation, or basis. This final practice demonstrates this principle by asking you to compare the conditioning of the *same* polynomial represented in two different bases: the standard monomial basis and a Newton basis centered near the point of interest [@problem_id:2378682]. By quantifying the staggering difference in their condition numbers, you will appreciate why choosing an appropriate basis is a critical skill in computational engineering.", "problem": "In computational engineering, the sensitivity of evaluating a polynomial at a point depends on how the polynomial is represented. Consider the monomial basis $\\{1, x, x^{2}, x^{3}\\}$ and the Newton basis associated with the nodes $t_{0}=10$, $t_{1}=11$, $t_{2}=12$, namely $\\{1,\\,(x-t_{0}),\\,(x-t_{0})(x-t_{1}),\\,(x-t_{0})(x-t_{1})(x-t_{2})\\}$. Define the polynomial\n$$\np(x) \\;=\\; 1 \\;+\\; (x-10) \\;+\\; (x-10)(x-11) \\;+\\; (x-10)(x-11)(x-12),\n$$\nand the evaluation point $x^{\\ast} = 11.5$.\n\nFor a fixed representation basis $\\{\\phi_{k}(x)\\}_{k=0}^{3}$ and its coefficient vector $a = (a_{0},a_{1},a_{2},a_{3})^{\\top}$ such that $p(x) = \\sum_{k=0}^{3} a_{k}\\,\\phi_{k}(x)$, the evaluation at $x^{\\ast}$ is the linear functional $y = \\sum_{k=0}^{3} a_{k}\\,\\phi_{k}(x^{\\ast})$. Using the Euclidean norm (two-norm), the absolute condition number of this functional is $\\|\\phi(x^{\\ast})\\|_{2}$, where $\\phi(x^{\\ast})=(\\phi_{0}(x^{\\ast}),\\ldots,\\phi_{3}(x^{\\ast}))^{\\top}$, and the relative condition number is\n$$\n\\kappa \\;=\\; \\frac{\\|a\\|_{2}\\,\\|\\phi(x^{\\ast})\\|_{2}}{|y|}.\n$$\n\nTreat the monomial representation and the Newton representation (with the nodes $10,11,12$) as two distinct bases for the same polynomial $p(x)$. Compute the ratio\n$$\nR \\;=\\; \\frac{\\kappa_{\\text{monomial}}}{\\kappa_{\\text{Newton}}},\n$$\nand round your final answer to four significant figures. No units are required.", "solution": "The objective is to compute the ratio $R = \\frac{\\kappa_{\\text{monomial}}}{\\kappa_{\\text{Newton}}}$, where $\\kappa$ is the relative condition number for polynomial evaluation. The polynomial is given by\n$$p(x) = 1 + (x-10) + (x-10)(x-11) + (x-10)(x-11)(x-12).$$\nThe evaluation point is $x^{\\ast} = 11.5$. The value of the polynomial at this point is\n$$p(11.5) = 1 + (11.5-10) + (11.5-10)(11.5-11) + (11.5-10)(11.5-11)(11.5-12)$$\n$$y = p(11.5) = 1 + (1.5) + (1.5)(0.5) + (1.5)(0.5)(-0.5) = 1 + 1.5 + 0.75 - 0.375 = 2.875.$$\n\nThe relative condition number for evaluating $p(x) = \\sum_{k=0}^{3} a_{k}\\phi_{k}(x)$ at $x^{\\ast}$ is given by\n$$\\kappa = \\frac{\\|a\\|_{2}\\|\\phi(x^{\\ast})\\|_{2}}{|y|},$$\nwhere $a = (a_{0}, a_{1}, a_{2}, a_{3})^{\\top}$ is the vector of coefficients and $\\phi(x^{\\ast}) = (\\phi_{0}(x^{\\ast}), \\phi_{1}(x^{\\ast}), \\phi_{2}(x^{\\ast}), \\phi_{3}(x^{\\ast}))^{\\top}$ is the vector of basis functions evaluated at $x^{\\ast}$.\n\nThe ratio $R$ is therefore\n$$R = \\frac{\\kappa_{\\text{monomial}}}{\\kappa_{\\text{Newton}}} = \\frac{\\frac{\\|a_{\\text{monomial}}\\|_{2}\\|\\phi_{\\text{monomial}}(x^{\\ast})\\|_{2}}{|y|}}{\\frac{\\|a_{\\text{Newton}}\\|_{2}\\|\\phi_{\\text{Newton}}(x^{\\ast})\\|_{2}}{|y|}} = \\frac{\\|a_{\\text{monomial}}\\|_{2}\\|\\phi_{\\text{monomial}}(x^{\\ast})\\|_{2}}{\\|a_{\\text{Newton}}\\|_{2}\\|\\phi_{\\text{Newton}}(x^{\\ast})\\|_{2}}.$$\nWe must now compute the four norms in this expression.\n\nFirst, we analyze the representation in the Newton basis. The basis functions are $\\phi_{0,N}(x) = 1$, $\\phi_{1,N}(x) = (x-10)$, $\\phi_{2,N}(x) = (x-10)(x-11)$, and $\\phi_{3,N}(x) = (x-10)(x-11)(x-12)$.\nFrom the definition of $p(x)$, the coefficient vector in this basis is directly given as\n$$a_{\\text{Newton}} = (1, 1, 1, 1)^{\\top}.$$\nThe Euclidean norm of this vector is\n$$\\|a_{\\text{Newton}}\\|_{2} = \\sqrt{1^{2} + 1^{2} + 1^{2} + 1^{2}} = \\sqrt{4} = 2.$$\nThe basis functions evaluated at $x^{\\ast} = 11.5$ are:\n$$\\phi_{0,N}(11.5) = 1$$\n$$\\phi_{1,N}(11.5) = 11.5 - 10 = 1.5$$\n$$\\phi_{2,N}(11.5) = (11.5 - 10)(11.5 - 11) = (1.5)(0.5) = 0.75$$\n$$\\phi_{3,N}(11.5) = (11.5 - 10)(11.5 - 11)(11.5 - 12) = (1.5)(0.5)(-0.5) = -0.375$$\nThe vector of evaluated basis functions is $\\phi_{\\text{Newton}}(x^{\\ast}) = (1, 1.5, 0.75, -0.375)^{\\top}$. Its norm is\n$$\\|\\phi_{\\text{Newton}}(x^{\\ast})\\|_{2} = \\sqrt{1^{2} + (1.5)^{2} + (0.75)^{2} + (-0.375)^{2}} = \\sqrt{1 + 2.25 + 0.5625 + 0.140625} = \\sqrt{3.953125}.$$\n\nSecond, we analyze the representation in the monomial basis, $\\{1, x, x^{2}, x^{3}\\}$. To find the coefficient vector $a_{\\text{monomial}}$, we must expand $p(x)$ into its standard polynomial form.\n$$p(x) = 1 + (x-10) + (x^{2} - 21x + 110) + (x^{2} - 21x + 110)(x-12)$$\n$$p(x) = 1 + (x-10) + (x^{2} - 21x + 110) + (x^{3} - 12x^2 - 21x^2 + 252x + 110x - 1320)$$\n$$p(x) = 1 + (x-10) + (x^{2} - 21x + 110) + (x^{3} - 33x^{2} + 362x - 1320)$$\nCollecting terms by powers of $x$:\n$$p(x) = x^{3} + (1 - 33)x^{2} + (1 - 21 + 362)x + (1 - 10 + 110 - 1320)$$\n$$p(x) = x^{3} - 32x^{2} + 342x - 1219.$$\nThe coefficient vector is $a_{\\text{monomial}} = (-1219, 342, -32, 1)^{\\top}$. Its norm is\n$$\\|a_{\\text{monomial}}\\|_{2} = \\sqrt{(-1219)^{2} + (342)^{2} + (-32)^{2} + 1^{2}} = \\sqrt{1485961 + 116964 + 1024 + 1} = \\sqrt{1603950}.$$\nThe monomial basis functions evaluated at $x^{\\ast} = 11.5$ are:\n$$\\phi_{0,M}(11.5) = (11.5)^{0} = 1$$\n$$\\phi_{1,M}(11.5) = (11.5)^{1} = 11.5$$\n$$\\phi_{2,M}(11.5) = (11.5)^{2} = 132.25$$\n$$\\phi_{3,M}(11.5) = (11.5)^{3} = 1520.875$$\nThe vector is $\\phi_{\\text{monomial}}(x^{\\ast}) = (1, 11.5, 132.25, 1520.875)^{\\top}$. Its norm is\n$$\\|\\phi_{\\text{monomial}}(x^{\\ast})\\|_{2} = \\sqrt{1^{2} + (11.5)^{2} + (132.25)^{2} + (1520.875)^{2}}$$\n$$\\|\\phi_{\\text{monomial}}(x^{\\ast})\\|_{2} = \\sqrt{1 + 132.25 + 17490.0625 + 2313063.4765625} = \\sqrt{2330686.7890625}.$$\n\nFinally, we compute the ratio $R$:\n$$R = \\frac{\\sqrt{1603950} \\cdot \\sqrt{2330686.7890625}}{2 \\cdot \\sqrt{3.953125}}$$\n$$R \\approx \\frac{1266.4715 \\cdot 1526.6554}{2 \\cdot 1.988247} \\approx \\frac{1933500.2}{3.976494} \\approx 486230.745.$$\nRounding to four significant figures gives $4.862 \\times 10^{5}$.", "answer": "$$\\boxed{4.862 \\times 10^{5}}$$", "id": "2378682"}]}