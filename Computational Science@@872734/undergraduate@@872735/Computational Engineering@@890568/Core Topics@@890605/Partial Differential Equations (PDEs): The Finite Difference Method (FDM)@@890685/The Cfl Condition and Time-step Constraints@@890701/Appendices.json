{"hands_on_practices": [{"introduction": "While the CFL condition is often framed as a limit on the time step size, some numerical methods are inherently flawed regardless of the step chosen. This exercise explores a classic example, the Forward-Time, Central-Space (FTCS) scheme, using Fourier analysis to reveal why it is unconditionally unstable for the advection equation. Understanding this fundamental failure is a crucial first step in appreciating the careful design required for stable numerical methods [@problem_id:2442990].", "problem": "A one-dimensional linear advection equation with constant wave speed $a$ is posed on a periodic domain $x \\in [0,L]$:\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\nwith a uniform grid $x_{j} = j\\,\\Delta x$ for integer $j$ and time levels $t^{n} = n\\,\\Delta t$ for integer $n$. Consider the explicit forward-time, central-space scheme\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\nLet the Courant number be $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$ and consider a discrete Fourier mode with dimensionless wavenumber $\\theta \\in [0,\\pi]$. Define the one-step amplification factor $G(C,\\theta)$ for this scheme by $u_{j}^{n+1} = G(C,\\theta)\\,u_{j}^{n}$ on that mode, and let\n$$\nS(C) = \\max_{\\theta \\in [0,\\pi]} \\left|G(C,\\theta)\\right|.\n$$\nDetermine $S(C)$ in closed form. Provide your final answer as a single analytic expression in terms of $C$. No rounding is required, and the answer is dimensionless.", "solution": "The problem requires the determination of the maximum one-step amplification factor, $S(C)$, for the explicit forward-time, central-space (FTCS) numerical scheme applied to the one-dimensional linear advection equation. The process begins with von Neumann stability analysis.\n\nThe given numerical scheme is:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nThe Courant number is defined as $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$. Substituting this into the scheme yields:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nFor the von Neumann analysis, we consider a single Fourier mode of the solution. Let the numerical solution at grid point $j$ and time level $n$ be represented by:\n$$\nu_{j}^{n} = \\hat{u}^{n}(k) e^{i k x_{j}}\n$$\nwhere $k$ is the wavenumber, $x_{j} = j\\,\\Delta x$ is the spatial coordinate, and $i = \\sqrt{-1}$. The amplification factor, which we will denote as $G$ for simplicity, relates the amplitude of the mode at successive time steps:\n$$\n\\hat{u}^{n+1}(k) = G \\, \\hat{u}^{n}(k)\n$$\nThis implies that $u_{j}^{n+1} = G \\, u_{j}^{n}$. We can also write the neighboring terms as:\n$$\nu_{j+1}^{n} = \\hat{u}^{n}(k) e^{i k (j+1)\\Delta x} = \\hat{u}^{n}(k) e^{i k j\\Delta x} e^{i k \\Delta x} = u_{j}^{n} e^{i k \\Delta x}\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n}(k) e^{i k (j-1)\\Delta x} = \\hat{u}^{n}(k) e^{i k j\\Delta x} e^{-i k \\Delta x} = u_{j}^{n} e^{-i k \\Delta x}\n$$\nSubstituting these expressions into the numerical scheme gives:\n$$\nG \\, u_{j}^{n} = u_{j}^{n} - \\frac{C}{2}\\left(u_{j}^{n} e^{i k \\Delta x} - u_{j}^{n} e^{-i k \\Delta x}\\right)\n$$\nFor a non-trivial solution ($u_{j}^{n} \\neq 0$), we can divide the entire equation by $u_{j}^{n}$ to solve for the amplification factor $G$:\n$$\nG = 1 - \\frac{C}{2}\\left(e^{i k \\Delta x} - e^{-i k \\Delta x}\\right)\n$$\nUsing Euler's identity, $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$, we can simplify the expression in parentheses:\n$$\ne^{i k \\Delta x} - e^{-i k \\Delta x} = 2i\\sin(k \\Delta x)\n$$\nThis leads to the following expression for the amplification factor:\n$$\nG = 1 - \\frac{C}{2} \\left(2i\\sin(k \\Delta x)\\right) = 1 - iC\\sin(k \\Delta x)\n$$\nThe problem specifies the use of a dimensionless wavenumber $\\theta = k \\Delta x$, where $\\theta \\in [0, \\pi]$. The amplification factor as a function of $C$ and $\\theta$ is:\n$$\nG(C, \\theta) = 1 - iC\\sin(\\theta)\n$$\nThis is a complex number with a real part of $1$ and an imaginary part of $-C\\sin(\\theta)$. The magnitude of the amplification factor, $|G(C, \\theta)|$, is calculated as:\n$$\n|G(C, \\theta)| = \\sqrt{(\\text{Re}(G))^2 + (\\text{Im}(G))^2} = \\sqrt{(1)^2 + (-C\\sin(\\theta))^2} = \\sqrt{1 + C^2\\sin^2(\\theta)}\n$$\nThe problem asks for $S(C) = \\max_{\\theta \\in [0,\\pi]} |G(C,\\theta)|$. To find this maximum, we need to maximize the expression $\\sqrt{1 + C^2\\sin^2(\\theta)}$ with respect to $\\theta$ on the interval $[0, \\pi]$. Since the square root function is monotonically increasing for non-negative arguments, maximizing $|G(C,\\theta)|$ is equivalent to maximizing its square, $|G(C,\\theta)|^2 = 1 + C^2\\sin^2(\\theta)$.\n\nThe expression $1 + C^2\\sin^2(\\theta)$ depends on $\\theta$ only through the term $\\sin^2(\\theta)$. We need to find the maximum value of $\\sin^2(\\theta)$ for $\\theta \\in [0, \\pi]$. The function $\\sin(\\theta)$ achieves its maximum value of $1$ at $\\theta = \\frac{\\pi}{2}$ within this interval. Consequently, the maximum value of $\\sin^2(\\theta)$ is also $1$, occurring at the same point $\\theta = \\frac{\\pi}{2}$.\n\nTherefore, the maximum value of $|G(C,\\theta)|^2$ is:\n$$\n\\max_{\\theta \\in [0,\\pi]} \\left(1 + C^2\\sin^2(\\theta)\\right) = 1 + C^2 (\\max_{\\theta \\in [0,\\pi]} \\sin^2(\\theta)) = 1 + C^2(1) = 1 + C^2\n$$\nThe quantity $S(C)$ is the square root of this maximum value:\n$$\nS(C) = \\sqrt{1 + C^2}\n$$\nThis result demonstrates that for any non-zero Courant number $C$, the magnitude of the amplification factor is greater than $1$ for some wavenumbers (specifically, for any $\\theta$ such that $\\sin(\\theta) \\neq 0$), indicating that the FTCS scheme is unconditionally unstable for the linear advection equation. The problem, however, only asks for the closed-form expression for $S(C)$.", "answer": "$$\\boxed{\\sqrt{1+C^2}}$$", "id": "2442990"}, {"introduction": "After examining an unstable scheme, we now turn to a conditionally stable method: the first-order upwind scheme. Mere stability, however, is not the only metric of a good scheme; accuracy is equally important. This practice guides you through a detailed analysis of how the Courant number $\\sigma$, within its stable range of $0 \\lt \\sigma \\le 1$, influences the solution quality by introducing the critical concepts of numerical dissipation and dispersion [@problem_id:2443031].", "problem": "Consider the linear advection equation $\\partial u/\\partial t + c\\,\\partial u/\\partial x = 0$ with constant wave speed $c>0$ on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. The first-order upwind explicit scheme for $c>0$ is\n$$\nu^{n+1}_j \\;=\\; u^n_j \\;-\\; \\sigma\\left(u^n_j - u^n_{j-1}\\right), \\quad \\text{where} \\quad \\sigma \\equiv \\dfrac{c\\,\\Delta t}{\\Delta x}.\n$$\nIn this context, “numerical dissipation” refers to attenuation of Fourier mode amplitudes (amplification factor magnitude less than $1$), and “numerical dispersion” refers to phase errors (numerical phase differing from the exact phase $-\\sigma \\,\\xi$ for nondimensional wavenumber $\\xi \\equiv k\\,\\Delta x$). Assume periodic boundary conditions so that Fourier analysis applies.\n\nWhich of the following statements correctly relate the choice of Courant number $\\sigma$ to numerical dissipation, numerical dispersion, and stability for this scheme?\n\nA. For any $0<\\sigma<1$, every nonzero Fourier mode experiences per-step amplitude attenuation (strictly less than $1$ in magnitude), with the per-step attenuation maximized at $\\sigma=1/2$. At $\\sigma=1$, the update is an exact shift by one grid cell per time step, so all Fourier modes are nondissipative and nondispersive.\n\nB. For any $0<\\sigma<1$, the scheme is non-dissipative but dispersive; moreover, increasing $\\sigma$ always increases the phase error for all wavenumbers.\n\nC. Over a fixed physical time interval $T$ with $c$ and $\\Delta x$ held fixed, choosing $\\sigma$ closer to $1$ reduces the cumulative dissipation compared to choosing very small $\\sigma$.\n\nD. The scheme is stable for any $\\sigma>0$ because upwinding eliminates dispersion.\n\nE. In the long-wave limit $|\\xi|\\ll 1$, the leading-order phase error per unit time (the coefficient of $k^3$ in the phase error expansion) vanishes at $\\sigma=1/2$ and at $\\sigma=1$.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Linear advection equation, $\\partial u/\\partial t + c\\,\\partial u/\\partial x = 0$, with constant wave speed $c > 0$.\n- **Discretization**: Uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$.\n- **Numerical Scheme**: First-order upwind explicit scheme for $c>0$:\n$$u^{n+1}_j \\;=\\; u^n_j \\;-\\; \\sigma\\left(u^n_j - u^n_{j-1}\\right)$$\n- **Definitions**:\n    - Courant number: $\\sigma \\equiv \\dfrac{c\\,\\Delta t}{\\Delta x}$.\n    - Numerical dissipation: Amplification factor magnitude less than $1$.\n    - Numerical dispersion: Numerical phase differs from the exact phase.\n    - Nondimensional wavenumber: $\\xi \\equiv k\\,\\Delta x$.\n- **Exact Phase**: The exact phase shift per time step for a Fourier mode is given as $-\\sigma \\,\\xi$.\n- **Boundary Conditions**: Periodic, to allow for Fourier analysis.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem concerns the analysis of the first-order upwind scheme for the linear advection equation, a cornerstone topic in numerical analysis for partial differential equations. All definitions and concepts are standard. The problem is scientifically sound.\n- **Well-Posed**: The question asks to identify correct statements about the properties of a well-defined numerical scheme. The properties can be unambiguously determined through von Neumann stability analysis.\n- **Objective**: The problem is stated using precise mathematical and technical language, free of subjectivity or ambiguity.\n- **Self-Contained and Consistent**: All necessary information (the equation, the numerical scheme, and relevant definitions) is provided. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. A solution will be derived by analyzing the properties of the numerical scheme.\n\n### Derivation\nTo analyze the scheme's properties, we perform a von Neumann stability analysis. We consider a single Fourier mode as a solution component:\n$$u^n_j = \\hat{u}^n(k) e^{i k j \\Delta x} = \\hat{u}^n e^{i j \\xi}$$\nwhere $\\hat{u}^n$ is the amplitude of the mode with wavenumber $k$ at time step $n$, and $\\xi = k \\Delta x$ is the dimensionless wavenumber. The evolution of the amplitude is given by the amplification factor $G$, such that $\\hat{u}^{n+1} = G \\hat{u}^n$.\n\nSubstituting the Fourier mode into the numerical scheme:\n$$\\hat{u}^{n+1} e^{i j \\xi} = \\hat{u}^n e^{i j \\xi} - \\sigma \\left( \\hat{u}^n e^{i j \\xi} - \\hat{u}^n e^{i (j-1) \\xi} \\right)$$\nDividing by $\\hat{u}^n e^{i j \\xi}$:\n$$G = 1 - \\sigma \\left( 1 - e^{-i \\xi} \\right)$$\nUsing Euler's formula $e^{-i\\xi} = \\cos(\\xi) - i\\sin(\\xi)$, we can write $G$ in Cartesian form:\n$$G = 1 - \\sigma(1 - \\cos(\\xi) + i\\sin(\\xi)) = (1 - \\sigma(1-\\cos(\\xi))) - i\\sigma\\sin(\\xi)$$\n\n**Analysis of Stability and Dissipation (Magnitude of G)**\nThe magnitude squared of the amplification factor is:\n$$|G|^2 = (1 - \\sigma(1-\\cos(\\xi)))^2 + (-\\sigma\\sin(\\xi))^2$$\n$$|G|^2 = 1 - 2\\sigma(1-\\cos\\xi) + \\sigma^2(1-\\cos\\xi)^2 + \\sigma^2\\sin^2\\xi$$\nUsing the identities $1-\\cos\\xi = 2\\sin^2(\\xi/2)$ and $\\sin\\xi = 2\\sin(\\xi/2)\\cos(\\xi/2)$:\n$$|G|^2 = 1 - 4\\sigma\\sin^2(\\xi/2) + \\sigma^2(2\\sin^2(\\xi/2))^2 + \\sigma^2(2\\sin(\\xi/2)\\cos(\\xi/2))^2$$\n$$|G|^2 = 1 - 4\\sigma\\sin^2(\\xi/2) + 4\\sigma^2\\sin^4(\\xi/2) + 4\\sigma^2\\sin^2(\\xi/2)\\cos^2(\\xi/2)$$\n$$|G|^2 = 1 - 4\\sigma\\sin^2(\\xi/2) + 4\\sigma^2\\sin^2(\\xi/2) (\\sin^2(\\xi/2) + \\cos^2(\\xi/2))$$\n$$|G|^2 = 1 - 4\\sigma(1-\\sigma)\\sin^2(\\xi/2)$$\nFor stability, we require $|G| \\le 1$, which means $|G|^2 \\le 1$. This implies $4\\sigma(1-\\sigma)\\sin^2(\\xi/2) \\ge 0$. Since $\\sin^2(\\xi/2) \\ge 0$, the stability condition is $\\sigma(1-\\sigma) \\ge 0$, which holds for $0 \\le \\sigma \\le 1$.\nNumerical dissipation occurs when $|G| < 1$. For $0 < \\sigma < 1$ and any nonzero mode ($\\xi \\neq 0$), we have $\\sigma(1-\\sigma) > 0$ and $\\sin^2(\\xi/2) > 0$, so $|G|^2 < 1$. Thus, the scheme is dissipative.\n\n**Analysis of Dispersion (Phase of G)**\nThe exact solution to the advection equation for a mode $e^{ikx}$ is $e^{ik(x-ct)}$. After one time step $\\Delta t$, the exact amplification factor is $G_{exact} = e^{-ikc\\Delta t} = e^{-i(k\\Delta x)(c\\Delta t/\\Delta x)} = e^{-i\\xi\\sigma}$. The exact phase shift per step is $\\phi_{exact} = -\\sigma\\xi$.\nThe numerical phase shift per step is $\\phi_{num} = \\arg(G)$. Any difference $\\phi_{num} - \\phi_{exact} \\neq 0$ constitutes numerical dispersion.\n\n### Option-by-Option Analysis\n\n**A. For any $0<\\sigma<1$, every nonzero Fourier mode experiences per-step amplitude attenuation (strictly less than $1$ in magnitude), with the per-step attenuation maximized at $\\sigma=1/2$. At $\\sigma=1$, the update is an exact shift by one grid cell per time step, so all Fourier modes are nondissipative and nondispersive.**\n- From our analysis, for $0 < \\sigma < 1$ and $\\xi \\ne 0$, $|G|^2 = 1 - 4\\sigma(1-\\sigma)\\sin^2(\\xi/2) < 1$. This means $|G| < 1$, which corresponds to amplitude attenuation.\n- The per-step attenuation is maximized when $|G|$ is minimized. This occurs when the subtractive term $4\\sigma(1-\\sigma)\\sin^2(\\xi/2)$ is maximized. For a given mode $\\xi$, this requires maximizing the quadratic function $\\sigma(1-\\sigma)$, which occurs at $\\sigma=1/2$.\n- At $\\sigma=1$, the scheme becomes $u^{n+1}_j = u^n_j - 1(u^n_j - u^n_{j-1}) = u^n_{j-1}$. This is an exact shift of the solution by one grid cell to the right per time step. For $\\sigma=1$, $c\\Delta t/\\Delta x = 1 \\implies c\\Delta t=\\Delta x$. The exact solution $u(x, t+\\Delta t) = f(x-c\\Delta t) = f(x-\\Delta x)$ is exactly recovered by the scheme.\n- At $\\sigma=1$, the amplification factor is $G=1-1(1-e^{-i\\xi})=e^{-i\\xi}$. Its magnitude is $|G|=1$ (nondissipative), and its phase is $\\phi_{num}=-\\xi$. The exact phase is $\\phi_{exact}=-\\sigma\\xi = -1\\cdot\\xi = -\\xi$. Since $\\phi_{num}=\\phi_{exact}$, the scheme is also nondispersive.\nThis statement is entirely correct.\n\n**B. For any $0<\\sigma<1$, the scheme is non-dissipative but dispersive; moreover, increasing $\\sigma$ always increases the phase error for all wavenumbers.**\n- The first part, \"the scheme is non-dissipative\", is false, as shown above. The scheme is dissipative for $0 < \\sigma < 1$.\n- The second part, \"increasing $\\sigma$ always increases the phase error\", is also false. The phase error is zero at $\\sigma=1$. Thus, as $\\sigma$ is increased towards $1$ (e.g., from $0.9$ to $0.95$), the phase error must decrease.\nThis statement is incorrect.\n\n**C. Over a fixed physical time interval $T$ with $c$ and $\\Delta x$ held fixed, choosing $\\sigma$ closer to $1$ reduces the cumulative dissipation compared to choosing very small $\\sigma$.**\n- The total number of time steps is $N = T/\\Delta t$. Since $\\Delta t = \\sigma\\Delta x/c$, we have $N = Tc/(\\sigma\\Delta x)$.\n- The cumulative amplitude of a mode is $|G|^N$. We compare its value for $\\sigma \\to 1^-$ and $\\sigma \\to 0^+$.\n- As $\\sigma \\to 1^-$, let $\\sigma=1-\\epsilon$ with $\\epsilon \\to 0^+$. $|G|^2 = 1-4(1-\\epsilon)\\epsilon\\sin^2(\\xi/2) \\approx 1-4\\epsilon\\sin^2(\\xi/2)$. The number of steps is $N \\approx Tc/\\Delta x$. The final amplitude is $|G|^N \\approx (1-2\\epsilon\\sin^2(\\xi/2))^N \\approx \\exp(-N \\cdot 2\\epsilon\\sin^2(\\xi/2))$. Substituting $N$, this is $\\exp(-\\frac{2Tc}{\\Delta x}\\sin^2(\\xi/2) \\cdot \\epsilon)$, which approaches $e^0=1$ as $\\epsilon \\to 0$.\n- As $\\sigma \\to 0^+$, the number of steps $N \\to \\infty$. The limit of $|G( \\sigma )|^N$ can be evaluated as $\\lim_{\\sigma\\to 0} (1-4\\sigma(1-\\sigma)\\sin^2(\\xi/2))^{Tc/(2\\sigma\\Delta x)}$. This limit evaluates to $\\exp(-\\frac{2Tc}{\\Delta x}\\sin^2(\\xi/2))$, which is a value strictly less than $1$ for any non-zero mode.\n- Since the final amplitude is closer to $1$ for $\\sigma \\to 1$ than for $\\sigma \\to 0$, the cumulative dissipation is reduced.\nThis statement is correct.\n\n**D. The scheme is stable for any $\\sigma>0$ because upwinding eliminates dispersion.**\n- The stability analysis showed the scheme is stable only for $0 \\le \\sigma \\le 1$. For $\\sigma > 1$, $|G| > 1$, and the scheme is unconditionally unstable. The first part of the statement is false.\n- The reason given, \"because upwinding eliminates dispersion\", is also false. The scheme is dispersive for $0 < \\sigma < 1$. Stability is related to dissipation, not dispersion.\nThis statement is incorrect.\n\n**E. In the long-wave limit $|\\xi|\\ll 1$, the leading-order phase error per unit time (the coefficient of $k^3$ in the phase error expansion) vanishes at $\\sigma=1/2$ and at $\\sigma=1$.**\n- The phase error per unit time is related to the difference between the exact and numerical dispersion relations, $\\omega_{exact}=ck$ and $\\omega_{num}(k)$. Specifically, it corresponds to the odd-powered terms in the expansion of $\\text{Re}(\\omega_{num}) - \\omega_{exact}$.\n- A detailed expansion of $\\omega_{num} = (i/\\Delta t) \\ln(G)$ shows that\n$$\\omega_{num}(k) = ck - i\\frac{c\\Delta x(1-\\sigma)}{2}k^2 - \\frac{c(\\Delta x)^2(1-\\sigma)(1-2\\sigma)}{6}k^3 + O(k^4)$$\nThe real part is $\\text{Re}(\\omega_{num}) = ck - \\frac{c(\\Delta x)^2(1-\\sigma)(1-2\\sigma)}{6}k^3 + \\dots$.\nThe phase error per unit time is $\\omega_{exact} - \\text{Re}(\\omega_{num}) = \\frac{c(\\Delta x)^2(1-\\sigma)(1-2\\sigma)}{6}k^3 + \\dots$.\n- The leading-order term is proportional to $k^3$. Its coefficient, $\\frac{c(\\Delta x)^2(1-\\sigma)(1-2\\sigma)}{6}$, vanishes if $(1-\\sigma)(1-2\\sigma)=0$. This occurs at $\\sigma=1$ and $\\sigma=1/2$.\nThis statement is correct.\n\nSince options A, C, and E are all demonstrably correct, and the format instructions allow for multiple correct answers, all three will be selected.\n\n**Verdict**\n- Option A: **Correct**.\n- Option B: **Incorrect**.\n- Option C: **Correct**.\n- Option D: **Incorrect**.\n- Option E: **Correct**.", "answer": "$$\\boxed{ACE}$$", "id": "2443031"}, {"introduction": "Theoretical analysis suggests that for the upwind scheme, choosing an excessively small Courant number $C$ can degrade accuracy due to accumulated numerical diffusion, even though the scheme remains stable. This hands-on coding exercise provides a practical demonstration of this counterintuitive result. By implementing the scheme and comparing the numerical solution against the exact solution for various values of $C$, you will gain a tangible understanding of the trade-offs involved in selecting a time step [@problem_id:2443006].", "problem": "Consider the one-dimensional linear advection equation on a periodic domain,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\nwith constant advection speed $a > 0$ and spatial period $L$. Let the spatial grid be uniform with $N$ points, grid spacing $\\Delta x = L/N$, and grid points $x_i = i\\,\\Delta x$ for $i \\in \\{0,1,\\dots,N-1\\}$. Define the Courant number as $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$, where $\\Delta t$ is the time step. Consider the explicit first-order upwind update for $a>0$,\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; C\\left(u_i^n - u_{i-1}^n\\right),\n$$\nwith periodic indexing so that $u_{-1}^n = u_{N-1}^n$. Let the exact solution at time $t$ be $u(x,t) = u_0\\!\\left((x - a t) \\bmod L\\right)$, where $u_0(x)$ is the initial condition.\n\nYou must write a complete, runnable program that, for a fixed nondimensional configuration,\n- $L = 1$,\n- $a = 1$,\n- $N = 128$,\n- final target time $T = 0.02$,\ndoes the following for each test case listed below:\n1. Set $\\Delta x = L/N$ and $\\Delta t = C\\,\\Delta x / a$ using the test case value of $C$.\n2. Let $n_{\\text{steps}} = \\text{round}\\!\\left(T/\\Delta t\\right)$ be the integer number of time steps. Advance the given scheme exactly $n_{\\text{steps}}$ steps starting from the specified initial condition $u_0(x)$ to obtain a numerical solution at time $t' = n_{\\text{steps}} \\Delta t$.\n3. Compute the exact solution at time $t'$ as $u_{\\text{exact}}(x_i,t') = u_0\\!\\left((x_i - a t') \\bmod L\\right)$.\n4. Compute the discrete, normalized $\\ell^2$ error\n$$\nE = \\frac{\\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_i^{n_{\\text{steps}}} - u_{\\text{exact}}(x_i,t')\\right)^2\\right)^{1/2}}{\\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_{\\text{exact}}(x_i,t')\\right)^2\\right)^{1/2}}.\n$$\nAll variables are nondimensional; no physical units are required.\n\nTest suite (each item is a separate test case defined by an initial condition and a Courant number):\n- Smooth initial condition $u_0(x) = \\sin\\!\\left(2\\pi x\\right)$ with $C = 0.9$.\n- Smooth initial condition $u_0(x) = \\sin\\!\\left(2\\pi x\\right)$ with $C = 0.5$.\n- Smooth initial condition $u_0(x) = \\sin\\!\\left(2\\pi x\\right)$ with $C = 0.1$.\n- Smooth initial condition $u_0(x) = \\sin\\!\\left(2\\pi x\\right)$ with $C = 10^{-4}$.\n- Discontinuous initial condition\n$$\nu_0(x) =\n\\begin{cases}\n1, & 0.25 \\le x < 0.75,\\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwith $C = 0.9$.\n- Discontinuous initial condition as above with $C = 0.5$.\n- Discontinuous initial condition as above with $C = 0.1$.\n- Discontinuous initial condition as above with $C = 10^{-4}$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$$\n\\big[ E_{\\text{smooth},\\,0.9},\\; E_{\\text{smooth},\\,0.5},\\; E_{\\text{smooth},\\,0.1},\\; E_{\\text{smooth},\\,10^{-4}},\\; E_{\\text{box},\\,0.9},\\; E_{\\text{box},\\,0.5},\\; E_{\\text{box},\\,0.1},\\; E_{\\text{box},\\,10^{-4}} \\big].\n$$\nEach entry must be a floating-point number. The test suite is designed to expose that, despite stability for all $C \\in (0,1]$, excessively small $C$ such as $C = 10^{-4}$ can degrade accuracy because the accumulated scheme-induced diffusion is large over the integration time even on a fixed grid.", "solution": "We analyze the first-order upwind method for the one-dimensional linear advection equation. The advection equation is\n$$\nu_t + a u_x = 0,\n$$\nwith $a > 0$. On a uniform grid $x_i = i\\,\\Delta x$, the explicit upwind update is\n$$\nu_i^{n+1} = u_i^n - C\\left(u_i^n - u_{i-1}^n\\right),\n$$\nwhere the Courant number is $C = \\dfrac{a\\,\\Delta t}{\\Delta x}$ and periodic indexing is used so that $u_{-1}^n = u_{N-1}^n$. This scheme is monotone and stable for all $C \\in (0,1]$ under the Courant-Friedrichs-Lewy (CFL) condition.\n\nA fundamental way to understand the accuracy implications is via the modified equation. Perform Taylor expansion in time and space and match terms. The leading-order modified equation for the upwind method is\n$$\nu_t + a u_x = \\nu_{\\text{num}}\\,u_{xx} + \\mathcal{O}(\\Delta x^2, \\Delta t^2),\n$$\nwhere the scheme-induced numerical diffusion coefficient is\n$$\n\\nu_{\\text{num}} = \\frac{a\\,\\Delta x}{2}\\,(1 - C).\n$$\nThis shows that the discretization behaves like advection with an added diffusion term: the smaller $C$ is (with fixed $\\Delta x$ and $a$), the larger $\\nu_{\\text{num}}$ becomes, reaching $\\nu_{\\text{num}} \\approx \\frac{a\\,\\Delta x}{2}$ as $C \\to 0$. Conversely, as $C \\to 1$, $\\nu_{\\text{num}} \\to 0$, explaining the well-known fact that first-order upwind is least diffusive near $C=1$. Over a fixed physical duration, accumulated diffusion grows with $\\nu_{\\text{num}}$ and therefore increases as $C$ decreases on a fixed grid, leading to poor accuracy despite stability.\n\nWe can also analyze the scheme in the Fourier domain. For a discrete Fourier mode $e^{\\mathrm{i}\\theta i}$ with $\\theta \\in [-\\pi,\\pi]$, the upwind scheme has amplification factor\n$$\nG(\\theta) = (1 - C) + C\\,e^{-\\mathrm{i}\\theta}.\n$$\nIts magnitude is\n$$\n|G(\\theta)| = \\sqrt{(1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2} \\le 1,\n$$\nwith equality only when $\\theta = 0$ or $C = 1$. For $C \\in (0,1)$ and $\\theta \\ne 0$, we have $|G(\\theta)| < 1$, which damps modes and mimics diffusion. Over $n$ time steps, the mode is multiplied by $G(\\theta)^n$, corresponding in the continuum to an effective diffusive decay approximately like $\\exp\\left(-\\nu_{\\text{num}} k^2 t\\right)$ with $k = \\theta/\\Delta x$ and $t = n\\Delta t$.\n\nFor computational efficiency and exactness with respect to the discrete scheme on a periodic grid, we avoid iterating $n$ steps explicitly. Instead, we compute the discrete Fourier transform (via the Discrete Fourier Transform) of the initial data, multiply each Fourier coefficient by $G(\\theta)^n$, and then apply the inverse transform to obtain the numerical solution after $n$ steps:\n$$\n\\widehat{u}^{\\,n}_m = \\left(G(\\theta_m)\\right)^n \\widehat{u}^{\\,0}_m, \\quad \\theta_m = \\frac{2\\pi m}{N},\n$$\nwhere $m$ indexes the discrete Fourier modes in the standard ordering of the Fast Fourier Transform. This procedure provides the exact result of the linear scheme after $n$ steps on the periodic grid, without roundoff accumulation from many time loop iterations.\n\nFor each test case, we proceed as follows:\n1. Set $L = 1$, $a = 1$, $N = 128$, $\\Delta x = L/N$, and the target Courant number $C$.\n2. Set $\\Delta t = C\\,\\Delta x / a$. Compute $n_{\\text{steps}} = \\operatorname{round}(T/\\Delta t)$ and $t' = n_{\\text{steps}}\\Delta t$.\n3. Define the initial condition $u_0(x)$ as specified. For the smooth case, $u_0(x) = \\sin(2\\pi x)$. For the discontinuous (box) case,\n$$\nu_0(x) = \\begin{cases}\n1, & 0.25 \\le x < 0.75,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n4. Compute the exact solution at $t'$: $u_{\\text{exact}}(x_i, t') = u_0\\!\\left((x_i - a t') \\bmod L\\right)$.\n5. Compute the numerical solution after $n_{\\text{steps}}$ by applying the spectral form of the scheme with amplification factor $G(\\theta_m)$ as above.\n6. Compute the normalized discrete $\\ell^2$ error\n$$\nE = \\frac{\\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_i^{n_{\\text{steps}}} - u_{\\text{exact}}(x_i,t')\\right)^2\\right)^{1/2}}{\\left(\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_{\\text{exact}}(x_i,t')\\right)^2\\right)^{1/2}}.\n$$\n\nBecause $\\nu_{\\text{num}}$ grows as $C$ decreases with fixed $\\Delta x$, we expect the errors to be smallest for $C$ close to $1$ and to increase as $C$ is reduced to $0.5$, then to $0.1$, and especially to $10^{-4}$. This holds for both smooth and discontinuous initial data, with the discontinuous case exhibiting stronger visible smearing due to the higher content of high-frequency modes, which are damped more severely by $|G(\\theta)|^n$ when $C$ is very small. The program implements this logic and reports the errors for the eight specified test cases in the requested single-line list format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef initial_condition(x, kind):\n    if kind == \"smooth\":\n        return np.sin(2.0 * np.pi * x)\n    elif kind == \"box\":\n        # Indicator: 1 on [0.25, 0.75), 0 elsewhere\n        return ((x >= 0.25) & (x < 0.75)).astype(float)\n    else:\n        raise ValueError(\"Unknown initial condition kind.\")\n\ndef exact_solution(x, t, a, L, kind):\n    # Periodic shift by a*t\n    x_shift = (x - a * t) % L\n    return initial_condition(x_shift, kind)\n\ndef upwind_after_n_steps_fft(u0, C, nsteps):\n    \"\"\"\n    Compute the result of nsteps of explicit upwind for a>0 on a periodic grid\n    by applying the scheme's amplification factor in Fourier space.\n    \"\"\"\n    N = u0.size\n    # Discrete Fourier mode angles theta_m = 2*pi*m/N in FFT ordering.\n    m = np.fft.fftfreq(N, d=1.0 / N)  # integer mode indices in FFT order\n    theta = 2.0 * np.pi * m / N\n    G = (1.0 - C) + C * np.exp(-1j * theta)\n    # Raise symbol to power nsteps; this is exact for the linear scheme.\n    G_n = G ** int(nsteps)\n    U0 = np.fft.fft(u0)\n    Un = np.fft.ifft(G_n * U0).real\n    return Un\n\ndef normalized_l2_error(u_num, u_ex):\n    diff = u_num - u_ex\n    num = np.sqrt(np.mean(diff * diff))\n    den = np.sqrt(np.mean(u_ex * u_ex))\n    # To avoid division by zero in degenerate cases\n    if den == 0.0:\n        return float(num)\n    return float(num / den)\n\ndef solve():\n    # Fixed configuration (nondimensional)\n    L = 1.0\n    a = 1.0\n    N = 128\n    T = 0.02\n    dx = L / N\n    x = np.linspace(0.0, L, N, endpoint=False)\n\n    # Test suite: list of (initial_condition_kind, Courant number)\n    test_cases = [\n        (\"smooth\", 0.9),\n        (\"smooth\", 0.5),\n        (\"smooth\", 0.1),\n        (\"smooth\", 1e-4),\n        (\"box\", 0.9),\n        (\"box\", 0.5),\n        (\"box\", 0.1),\n        (\"box\", 1e-4),\n    ]\n\n    results = []\n    for kind, C in test_cases:\n        dt = C * dx / a\n        # Integer number of steps; use round to get the nearest integer\n        nsteps = int(np.round(T / dt)) if dt > 0 else 0\n        # Actual time reached\n        t_prime = nsteps * dt\n\n        # Initial condition and exact solution at t_prime\n        u0 = initial_condition(x, kind)\n        u_exact = exact_solution(x, t_prime, a, L, kind)\n\n        # Numerical solution after nsteps using FFT representation\n        u_num = upwind_after_n_steps_fft(u0, C, nsteps)\n\n        # Normalized L2 error\n        E = normalized_l2_error(u_num, u_exact)\n        results.append(E)\n\n    # Final print statement in the exact required format.\n    print(\"[\" + \",\".join(f\"{val:.12g}\" for val in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2443006"}]}