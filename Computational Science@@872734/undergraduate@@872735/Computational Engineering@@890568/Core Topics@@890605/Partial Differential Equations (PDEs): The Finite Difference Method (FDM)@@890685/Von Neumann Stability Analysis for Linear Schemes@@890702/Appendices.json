{"hands_on_practices": [{"introduction": "This first practice problem explores the versatile $\\theta$-scheme for the heat equation. By adjusting a single parameter, $\\theta$, we can move seamlessly between explicit and implicit formulations, such as the Forward Euler and Crank-Nicolson methods. This exercise [@problem_id:2450103] provides a foundational understanding of how numerical stability is directly controlled by the scheme's design, introducing the critical concept of unconditional stability.", "problem": "Consider the heat equation $u_{t}=\\kappa u_{xx}$ on a periodic domain with spatial grid spacing $\\Delta x$ and time step $\\Delta t$, where $\\kappa0$ is the thermal diffusivity. Define the central second-difference operator $\\delta_{xx}u_{j}^{n}=\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right)/\\Delta x^{2}$, and consider the $\\theta$-scheme (a weighted average of Forward Euler and Backward Euler) given by\n$$(u_{j}^{n+1}-u_{j}^{n})/\\Delta t=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right],$$\nwith weight parameter $\\theta\\in\\mathbb{R}$. Using von Neumann stability analysis (Fourier mode analysis) with modes $u_{j}^{n}=\\hat{u}\\,G^{n}\\exp(i j \\xi)$, where $\\xi\\in[-\\pi,\\pi]$ is the nondimensional wave number measured in radians and $i^{2}=-1$, derive the amplification factor $G(\\xi,\\theta,\\kappa,\\Delta t,\\Delta x)$ and determine for which values of $\\theta$ the scheme is unconditionally stable, meaning $|G|\\leq 1$ for all $\\xi\\in[-\\pi,\\pi]$ and for all ratios $r=\\kappa\\,\\Delta t/\\Delta x^{2}\\ge 0$.\n\nReport your final answer as the minimal value of $\\theta$ that guarantees unconditional stability. Express your answer as a single simplified rational number. No rounding is required and no units are needed in the final answer.", "solution": "The problem statement is coherent, scientifically grounded, and well-posed. We proceed with the derivation.\n\nThe given $\\theta$-scheme for the heat equation is:\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right] $$\nwhere $\\delta_{xx}$ is the central second-difference operator. Substituting the definition of $\\delta_{xx}$ yields:\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta \\left( u_{j+1}^{n+1} - 2u_{j}^{n+1} + u_{j-1}^{n+1} \\right) + (1-\\theta) \\left( u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n} \\right) \\right] $$\nTo perform the von Neumann stability analysis, we introduce the Fourier mode ansatz $u_{j}^{n} = G^{n} \\exp(i j \\xi)$, where $G$ is the amplification factor, $n$ is the time index, $j$ is the spatial index, $\\xi$ is the dimensionless wave number, and $i^{2}=-1$. We have dropped the constant amplitude $\\hat{u}$ as it cancels out.\n\nSubstituting this ansatz into the scheme involves the following relations:\n$u_{j}^{n+1} = G u_{j}^{n}$\n$u_{j\\pm 1}^{n} = \\exp(\\pm i \\xi) u_{j}^{n}$\n$u_{j\\pm 1}^{n+1} = G \\exp(\\pm i \\xi) u_{j}^{n}$\n\nSubstituting these into the discretized equation:\n$$ \\frac{G u_{j}^{n} - u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} + (1-\\theta) \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} \\right] $$\nAssuming a non-trivial solution, we can divide by $u_{j}^{n}$:\n$$ \\frac{G - 1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G ( e^{i\\xi} + e^{-i\\xi} - 2 ) + (1-\\theta) ( e^{i\\xi} + e^{-i\\xi} - 2 ) \\right] $$\nUsing the identity $e^{i\\xi} + e^{-i\\xi} = 2\\cos(\\xi)$, the term in parentheses becomes $2\\cos(\\xi) - 2 = -2(1-\\cos(\\xi))$. Using the half-angle identity $1-\\cos(\\xi) = 2\\sin^{2}(\\xi/2)$, this term is equal to $-4\\sin^{2}(\\xi/2)$.\nThe equation for $G$ becomes:\n$$ \\frac{G-1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left( -4\\sin^{2}(\\xi/2) \\right) \\left[ \\theta G + (1-\\theta) \\right] $$\nLet $r = \\kappa \\Delta t / \\Delta x^{2}$ be the Courant-Friedrichs-Lewy (CFL) number, or more specifically, the diffusion number.\n$$ G - 1 = -4r \\sin^{2}(\\xi/2) \\left[ \\theta G + 1 - \\theta \\right] $$\nWe must now solve for the amplification factor $G$:\n$$ G - 1 = -4r\\theta G \\sin^{2}(\\xi/2) - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G \\left( 1 + 4r\\theta \\sin^{2}(\\xi/2) \\right) = 1 - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G = \\frac{1 - 4r(1-\\theta)\\sin^{2}(\\xi/2)}{1 + 4r\\theta\\sin^{2}(\\xi/2)} $$\nFor unconditional stability, the magnitude of the amplification factor must satisfy $|G| \\le 1$ for all values of $r \\ge 0$ and for all wave numbers $\\xi \\in [-\\pi, \\pi]$. Let $S = 4r\\sin^{2}(\\xi/2)$. Since $r \\ge 0$ and $\\sin^{2}(\\xi/2) \\ge 0$, the domain for $S$ is $[0, \\infty)$. The expression for $G$ becomes:\n$$ G = \\frac{1 - (1-\\theta)S}{1 + \\theta S} $$\nThe stability condition is $|G| \\leq 1$, which is equivalent to:\n$$ |1 - (1-\\theta)S| \\leq |1 + \\theta S| $$\nWe must analyze this inequality for all $S \\ge 0$. Note that if the denominator $1 + \\theta S$ becomes zero for some $S  0$, the scheme is ill-defined and unstable. This occurs if $\\theta  0$. If $\\theta  0$, let $\\theta = -\\beta$ where $\\beta  0$. The denominator is $1 - \\beta S$. For $S = 1/\\beta$, the denominator is zero. Thus, for unconditional stability, we must have $\\theta \\ge 0$.\n\nAssuming $\\theta \\ge 0$, the denominator $1 + \\theta S$ is always positive (it is $1$ for $S=0$ and greater than $1$ for $S0$). Thus we can multiply by it:\n$$ - (1 + \\theta S) \\leq 1 - (1-\\theta)S \\leq 1 + \\theta S $$\nThis compound inequality consists of two parts.\n\nFirst, the right-hand side inequality:\n$$ 1 - (1-\\theta)S \\leq 1 + \\theta S $$\n$$ -(1-\\theta)S \\leq \\theta S $$\n$$ -S + \\theta S \\leq \\theta S $$\n$$ -S \\leq 0 $$\nSince we defined $S = 4r\\sin^{2}(\\xi/2) \\ge 0$, this inequality is always satisfied for any $\\theta$.\n\nSecond, the left-hand side inequality:\n$$ -(1 + \\theta S) \\leq 1 - (1-\\theta)S $$\n$$ -1 - \\theta S \\leq 1 - S + \\theta S $$\n$$ 0 \\leq 2 - S + 2\\theta S $$\n$$ 0 \\leq 2 + (2\\theta - 1)S $$\nThis inequality must hold for all $S \\in [0, \\infty)$.\nIf the coefficient of $S$ is non-negative, i.e., $2\\theta - 1 \\ge 0$, then the term $(2\\theta - 1)S$ is non-negative for all $S \\ge 0$. The inequality $2 + (\\text{non-negative quantity}) \\ge 0$ is always true. Therefore, the scheme is unconditionally stable if $2\\theta - 1 \\ge 0$, which implies $\\theta \\ge 1/2$.\n\nIf the coefficient of $S$ is negative, i.e., $2\\theta - 1  0$ (or $\\theta  1/2$), the inequality becomes $ (1-2\\theta)S \\le 2 $, or $S \\le \\frac{2}{1-2\\theta}$. This imposes a condition on $S = 4r\\sin^{2}(\\xi/2)$, meaning the stability is conditional on $r$. This violates the requirement of unconditional stability.\n\nThus, the condition for unconditional stability is $\\theta \\ge 1/2$. The problem asks for the minimal value of $\\theta$ that guarantees this. This minimal value is precisely when the coefficient of $S$ becomes non-negative.\n\nThe minimal value of $\\theta$ is $1/2$.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2450103"}, {"introduction": "Next, we turn our attention to hyperbolic problems by analyzing the MacCormack scheme for the linear advection equation. This popular method uses a predictor-corrector sequence to achieve second-order accuracy. This practice [@problem_id:2450092] extends your skills to multi-step methods, demonstrating how to derive a single amplification factor from a sequence of operations and reinforcing the importance of the Courant-Friedrichs-Lewy (CFL) condition.", "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a  0$ on a periodic, uniform, $1$-dimensional spatial grid $x_{j} = j\\,\\Delta x$ and time levels $t^{n} = n\\,\\Delta t$. Let $u_{j}^{n}$ denote the numerical approximation to $u(x_{j}, t^{n})$. The MacCormack predictor–corrector scheme advances $u_{j}^{n}$ to $u_{j}^{n+1}$ via\n$$\n\\text{Predictor:}\\quad u_{j}^{\\ast} = u_{j}^{n} - a\\,\\frac{\\Delta t}{\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right),\n$$\n$$\n\\text{Corrector:}\\quad u_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - a\\,\\frac{\\Delta t}{\\Delta x}\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right].\n$$\nDefine the Courant–Friedrichs–Lewy (CFL) number $C = a\\,\\Delta t/\\Delta x$. Assume periodic boundary conditions so that discrete Fourier modes are admissible.\n\nDetermine the largest value of $C$ such that, for every discrete wavenumber $\\theta \\in [-\\pi,\\pi]$, the magnitude of the single-step amplification factor does not exceed $1$. Provide your answer as a single real number. No rounding is required.", "solution": "The problem requires the determination of the stability limit for the MacCormack scheme applied to the linear advection equation, $u_{t} + a\\,u_{x} = 0$, where $a  0$ is a constant wave speed. The stability will be assessed using the von Neumann stability analysis method.\n\nThe MacCormack scheme is given by a two-step predictor-corrector process. First, the predictor step is:\n$$\nu_{j}^{\\ast} = u_{j}^{n} - C\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\n$$\nwhere $C = a\\,\\frac{\\Delta t}{\\Delta x}$ is the Courant–Friedrichs–Lewy (CFL) number. The corrector step is:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - C\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right]\n$$\nTo perform the von Neumann analysis, we consider the behavior of a single Fourier mode of the numerical solution. We posit a solution of the form $u_{j}^{n} = \\hat{u}^{n} \\exp(i k x_{j})$, where $k$ is the wavenumber. On a discrete grid, this becomes $u_{j}^{n} = \\hat{u}^{n} \\exp(i \\theta j)$, where $\\theta = k \\Delta x$ is the dimensionless wavenumber or phase angle, which varies in the range $[-\\pi, \\pi]$. The amplification factor, $G(\\theta)$, is defined by the relation $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^{n}$.\n\nWe first substitute the Fourier mode into the predictor step. The terms $u_{j+1}^{n}$ and $u_{j-1}^{n}$ are expressed as:\n$$\nu_{j+1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j+1)) = u_{j}^{n} \\exp(i \\theta)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n} \\exp(i \\theta (j-1)) = u_{j}^{n} \\exp(-i \\theta)\n$$\nThe intermediate solution $u_{j}^{\\ast}$ will also have a Fourier representation, $u_{j}^{\\ast} = \\hat{u}^{\\ast} \\exp(i \\theta j)$. Substituting these forms into the predictor equation yields:\n$$\n\\hat{u}^{\\ast} \\exp(i \\theta j) = \\hat{u}^{n} \\exp(i \\theta j) - C \\left(\\hat{u}^{n} \\exp(i \\theta (j+1)) - \\hat{u}^{n} \\exp(i \\theta j)\\right)\n$$\nDividing by $\\exp(i \\theta j)$ gives the amplitude of the predicted solution:\n$$\n\\hat{u}^{\\ast} = \\hat{u}^{n} - C \\left(\\hat{u}^{n} \\exp(i \\theta) - \\hat{u}^{n}\\right) = \\hat{u}^{n} \\left(1 - C(\\exp(i \\theta) - 1)\\right)\n$$\nNext, we substitute the Fourier modes into the corrector step:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left[u_{j}^{n} + u_{j}^{\\ast} - C\\left(u_{j}^{\\ast} - u_{j-1}^{\\ast}\\right)\\right]\n$$\nThis translates to the amplitudes as:\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{\\ast} - C\\left(\\hat{u}^{\\ast} - \\hat{u}^{\\ast} \\exp(-i \\theta))\\right)\\right]\n$$\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{\\ast}\\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\nNow, we substitute the expression for $\\hat{u}^{\\ast}$ in terms of $\\hat{u}^{n}$:\n$$\n\\hat{u}^{n+1} = \\frac{1}{2}\\left[\\hat{u}^{n} + \\hat{u}^{n}\\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\nThe amplification factor $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^{n}$ is therefore:\n$$\nG(\\theta) = \\frac{1}{2}\\left[1 + \\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right)\\right]\n$$\nLet us expand the product term inside the bracket:\n$$\n\\left(1 - C(\\exp(i \\theta) - 1)\\right) \\left(1 - C(1 - \\exp(-i \\theta))\\right) = 1 - C(1 - \\exp(-i \\theta)) - C(\\exp(i \\theta) - 1) + C^{2}(\\exp(i \\theta) - 1)(1 - \\exp(-i \\theta))\n$$\n$$\n= 1 - C + C\\exp(-i \\theta) - C\\exp(i \\theta) + C + C^{2}(\\exp(i \\theta) - 1-1 + \\exp(-i\\theta))\n$$\n$$\n= 1 - C(\\exp(i \\theta) - \\exp(-i \\theta)) + C^{2}(\\exp(i \\theta) + \\exp(-i \\theta) - 2)\n$$\nUsing Euler's identities, $\\exp(i \\theta) - \\exp(-i \\theta) = 2i\\sin(\\theta)$ and $\\exp(i \\theta) + \\exp(-i \\theta) = 2\\cos(\\theta)$, the expression becomes:\n$$\n1 - C(2i\\sin(\\theta)) + C^{2}(2\\cos(\\theta) - 2) = 1 - 2iC\\sin(\\theta) + 2C^{2}(\\cos(\\theta) - 1)\n$$\nSubstituting this back into the expression for $G(\\theta)$:\n$$\nG(\\theta) = \\frac{1}{2}\\left[1 + 1 - 2iC\\sin(\\theta) + 2C^{2}(\\cos(\\theta) - 1)\\right] = 1 - iC\\sin(\\theta) + C^{2}(\\cos(\\theta) - 1)\n$$\nThe amplification factor is a complex number, $G(\\theta) = \\left(1 + C^{2}(\\cos(\\theta) - 1)\\right) - i\\left(C\\sin(\\theta)\\right)$. For the scheme to be stable, the magnitude of the amplification factor must not exceed $1$ for any wavenumber $\\theta$, i.e., $|G(\\theta)| \\le 1$. This is equivalent to $|G(\\theta)|^{2} \\le 1$.\n$$\n|G(\\theta)|^{2} = \\left(1 + C^{2}(\\cos(\\theta) - 1)\\right)^{2} + \\left(-C\\sin(\\theta)\\right)^{2} \\le 1\n$$\n$$\n1 + 2C^{2}(\\cos(\\theta) - 1) + C^{4}(\\cos(\\theta) - 1)^{2} + C^{2}\\sin^{2}(\\theta) \\le 1\n$$\nSubtracting $1$ from both sides and dividing by $C^{2}$ (since $C0$):\n$$\n2(\\cos(\\theta) - 1) + C^{2}(\\cos(\\theta) - 1)^{2} + \\sin^{2}(\\theta) \\le 0\n$$\nUsing the identity $\\sin^{2}(\\theta) = 1 - \\cos^{2}(\\theta) = (1 - \\cos(\\theta))(1 + \\cos(\\theta))$, we can rewrite the inequality:\n$$\n-2(1 - \\cos(\\theta)) + C^{2}(1 - \\cos(\\theta))^{2} + (1 - \\cos(\\theta))(1 + \\cos(\\theta)) \\le 0\n$$\nFactor out the term $(1 - \\cos(\\theta))$, which is non-negative:\n$$\n(1 - \\cos(\\theta)) \\left[-2 + C^{2}(1 - \\cos(\\theta)) + (1 + \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta)) \\left[-1 + \\cos(\\theta) + C^{2}(1 - \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta)) \\left[-(1 - \\cos(\\theta)) + C^{2}(1 - \\cos(\\theta))\\right] \\le 0\n$$\n$$\n(1 - \\cos(\\theta))^{2} (C^{2} - 1) \\le 0\n$$\nThe term $(1 - \\cos(\\theta))^{2}$ is always non-negative for any real $\\theta$. For the product to be less than or equal to zero for all $\\theta \\in [-\\pi, \\pi]$, the other factor, $(C^{2} - 1)$, must be non-positive.\n$$\nC^{2} - 1 \\le 0 \\implies C^{2} \\le 1\n$$\nGiven that $C = a \\frac{\\Delta t}{\\Delta x}$ where $a, \\Delta t, \\Delta x$ are all positive quantities, $C$ must be positive. Therefore, the stability condition is $0  C \\le 1$.\nThe problem asks for the largest value of $C$ for which the stability condition holds. This value is $1$.", "answer": "$$\\boxed{1}$$", "id": "2450092"}, {"introduction": "Our final exercise advances to the Method of Lines, a powerful technique that decouples the discretization of space and time. We will analyze a system where a central difference scheme is used for the spatial derivative of the advection equation, and a fourth-order Runge-Kutta method integrates in time. This capstone problem [@problem_id:2450031] challenges you to combine the analysis of a spatial operator's eigenvalues with the stability region of a time-stepping scheme, a crucial skill for tackling complex, multi-physics simulations.", "problem": "Consider the one-dimensional linear advection equation $u_{t} + c\\,u_{x} = 0$ posed on a periodic domain of length $L$, discretized on a uniform grid $x_{j} = j\\,\\Delta x$ with $j \\in \\{0,1,\\dots,N-1\\}$ and $\\Delta x = L/N$. The spatial derivative $u_{x}$ is approximated by the second-order centered finite difference $(u_{j+1} - u_{j-1})/(2\\,\\Delta x)$, leading to the semi-discrete system\n$$\n\\frac{d u_{j}}{d t} = -c\\,\\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.\n$$\nThe time integration of the resulting semi-discrete system $\\frac{d\\mathbf{u}}{dt} = \\mathbf{A}\\,\\mathbf{u}$ is performed with the classical fourth-order Runge–Kutta method using a constant time step $\\Delta t$. Let the Courant number be defined as $\\sigma = |c|\\,\\Delta t / \\Delta x$.\n\nAssuming periodic boundary conditions and linearity so that a von Neumann analysis applies, determine the largest value of the Courant number $\\sigma$ for which the fully discrete method is linearly stable for all spatial Fourier modes. Express your final answer as an exact analytic expression. No rounding is required and no units are to be reported.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in the field of numerical analysis for partial differential equations. The task is to determine the stability limit of a fully discrete scheme by combining the von Neumann analysis of the spatial discretization with the stability region of the time integration method.\n\nThe procedure involves three main steps. First, we analyze the spatial discretization to find the spectrum of the operator. Second, we determine the stability region of the fourth-order Runge-Kutta method on the imaginary axis. Finally, we combine these results to find the maximum allowable Courant number.\n\nStep $1$: Analysis of the semi-discrete system.\nThe semi-discrete system is given by\n$$\n\\frac{d u_{j}}{d t} = -c\\,\\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.\n$$\nWe apply the von Neumann ansatz by considering a single Fourier mode solution of the form $u_j(t) = \\hat{u}_k(t) \\exp(i k x_j)$, where $k$ is the wavenumber and $x_j = j \\Delta x$. Substituting this into the equation, we get:\n$$\n\\frac{d \\hat{u}_k}{d t} \\exp(i k j \\Delta x) = -c\\,\\frac{\\hat{u}_k \\exp(i k (j+1) \\Delta x) - \\hat{u}_k \\exp(i k (j-1) \\Delta x)}{2\\,\\Delta x}.\n$$\nDividing by the common factor $\\hat{u}_k \\exp(i k j \\Delta x)$ yields an ordinary differential equation for the amplitude $\\hat{u}_k(t)$:\n$$\n\\frac{d \\hat{u}_k}{d t} = - \\frac{c}{2\\,\\Delta x} (\\exp(i k \\Delta x) - \\exp(-i k \\Delta x)) \\hat{u}_k.\n$$\nUsing the identity $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, we simplify the expression:\n$$\n\\frac{d \\hat{u}_k}{d t} = - \\frac{c}{2\\,\\Delta x} (2i \\sin(k \\Delta x)) \\hat{u}_k = \\left( -i \\frac{c}{\\Delta x} \\sin(k \\Delta x) \\right) \\hat{u}_k.\n$$\nThis is an ODE of the form $\\frac{d\\hat{u}_k}{dt} = \\lambda_k \\hat{u}_k$, where $\\lambda_k$ are the eigenvalues of the spatial discretization operator. Thus,\n$$\n\\lambda_k = -i \\frac{c}{\\Delta x} \\sin(k \\Delta x).\n$$\nFor time integration, the relevant quantity is $z_k = \\lambda_k \\Delta t$:\n$$\nz_k = \\lambda_k \\Delta t = -i \\frac{c \\Delta t}{\\Delta x} \\sin(k \\Delta x).\n$$\nUsing the definition of the Courant number, $\\sigma = |c|\\,\\Delta t / \\Delta x$, and noting that the sign of $c$ can be absorbed into the sign of $\\sin(k \\Delta x)$ over its full range (since $\\sin(\\theta)=-\\sin(-\\theta)$), we can write the set of all possible $z_k$ as being determined by the maximum magnitude. The term $k\\Delta x$ is the dimensionless wavenumber, which effectively covers the interval $[-\\pi, \\pi]$. Therefore, $\\sin(k\\Delta x)$ ranges from $-1$ to $1$. The set of all possible values for $z_k$ is the segment of the imaginary axis from $-i\\sigma$ to $i\\sigma$.\n\nStep $2$: Stability of the fourth-order Runge-Kutta Method.\nThe classical fourth-order Runge-Kutta (RK$4$) method, when applied to the test equation $y' = \\lambda y$, yields the recurrence relation $y^{n+1} = g(\\lambda \\Delta t) y^n$, where $g(z)$ is the stability function (or amplification factor). For RK$4$, this function is given by the first five terms of the Taylor series of $\\exp(z)$:\n$$\ng(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}.\n$$\nThe scheme is stable if the modulus of the amplification factor is less than or equal to one, i.e., $|g(z)| \\le 1$. From Step $1$, we know that $z$ is purely imaginary for our problem, so we set $z = iy$ where $y$ is a real number. We need to find the range of $y$ for which $|g(iy)| \\le 1$.\nSubstituting $z=iy$ into $g(z)$:\n$$\ng(iy) = 1 + iy + \\frac{(iy)^2}{2} + \\frac{(iy)^3}{6} + \\frac{(iy)^4}{24} = 1 + iy - \\frac{y^2}{2} - i\\frac{y^3}{6} + \\frac{y^4}{24}.\n$$\nSeparating the real and imaginary parts:\n$$\ng(iy) = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right) + i \\left(y - \\frac{y^3}{6}\\right).\n$$\nThe stability condition is $|g(iy)|^2 \\le 1^2 = 1$:\n$$\n\\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right)^2 + \\left(y - \\frac{y^3}{6}\\right)^2 \\le 1.\n$$\nExpanding the terms:\n$$\n\\left(1 - y^2 + \\frac{y^4}{3} - \\frac{y^6}{24} + \\frac{y^8}{576}\\right) + \\left(y^2 - \\frac{y^4}{3} + \\frac{y^6}{36}\\right) \\le 1.\n$$\nSimplifying the expression by cancelling terms:\n$$\n1 + \\left(\\frac{1}{36} - \\frac{1}{24}\\right)y^6 + \\frac{y^8}{576} \\le 1.\n$$\n$$\n1 - \\frac{y^6}{72} + \\frac{y^8}{576} \\le 1.\n$$\nThis simplifies to:\n$$\n\\frac{y^8}{576} - \\frac{y^6}{72} \\le 0.\n$$\nFor $y \\ne 0$, we can divide by $y^6$ (which is positive):\n$$\n\\frac{y^2}{576} - \\frac{1}{72} \\le 0 \\implies \\frac{y^2}{576} \\le \\frac{1}{72}.\n$$\nSolving for $y^2$:\n$$\ny^2 \\le \\frac{576}{72} = 8.\n$$\nThis implies that $|y| \\le \\sqrt{8} = 2\\sqrt{2}$. The stability interval for the RK$4$ method along the imaginary axis is therefore $[-i 2\\sqrt{2}, i 2\\sqrt{2}]$.\n\nStep $3$: Determine the stability limit for the Courant number.\nFor the fully discrete scheme to be stable for all Fourier modes, the set of values $\\{z_k = \\lambda_k \\Delta t\\}$ must lie entirely within the stability region of the RK$4$ method. As established in Step $1$, this set is the imaginary axis segment $[-i\\sigma, i\\sigma]$.\nThe stability condition is thus:\n$$\n[-i\\sigma, i\\sigma] \\subseteq [-i 2\\sqrt{2}, i 2\\sqrt{2}].\n$$\nThis requires that $\\sigma \\le 2\\sqrt{2}$. The largest value of the Courant number $\\sigma$ for which the method is stable is the upper bound of this inequality.", "answer": "$$\n\\boxed{2\\sqrt{2}}\n$$", "id": "2450031"}]}