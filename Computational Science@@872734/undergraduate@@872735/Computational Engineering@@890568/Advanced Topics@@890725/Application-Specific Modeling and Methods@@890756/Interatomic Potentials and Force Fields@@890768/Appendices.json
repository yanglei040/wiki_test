{"hands_on_practices": [{"introduction": "The foundation of any molecular simulation lies in the connection between a system's potential energy and the forces acting on its constituent particles. This exercise reinforces this fundamental principle by asking you to derive the force vector and the scalar pair virial directly from a given potential energy function. Mastering this relationship is the first step toward understanding how functional forms of potentials dictate the dynamics of a simulated system [@problem_id:2404403].", "problem": "Consider a monatomic system with pairwise, central interactions described by the Lennard-Jones-like potential\n$$\nU(r) = 4\\,\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right],\n$$\nwhere $r = |\\mathbf{r}_{ij}|$ is the scalar separation between two particles, $\\mathbf{r}_{ij}$ is the interparticle separation vector, $\\sigma$ is a characteristic length scale, and $\\varepsilon$ is an energy scale. Assume the interaction is spherically symmetric and pairwise additive. Using only the fundamental definitions that (i) the force is the negative gradient of the potential, and (ii) the scalar pair virial contribution is defined as $w(r) = \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij}(r)$, derive analytic expressions for the force vector $\\mathbf{F}_{ij}(r)$ and the scalar pair virial $w(r)$ as functions of $r$, $\\sigma$, and $\\varepsilon$. Express the force along the radial unit vector $\\hat{\\mathbf{r}}_{ij} = \\mathbf{r}_{ij}/r$.\n\nProvide your final result as closed-form expressions in terms of $r$, $\\sigma$, and $\\varepsilon$ only. Express the force as a vector and the virial as a scalar. Do not substitute numerical values. Do not include units in the final boxed answer. Report both results together as a single row matrix $\\begin{pmatrix}\\mathbf{F}_{ij}(r) & w(r)\\end{pmatrix}$.", "solution": "The problem requires the derivation of the interparticle force vector $\\mathbf{F}_{ij}(r)$ and the scalar pair virial $w(r)$ from a given pairwise central potential $U(r)$. The problem is well-posed and scientifically sound, representing a standard exercise in classical mechanics and statistical physics. We shall proceed with the derivation based on the fundamental definitions provided.\n\nThe interatomic potential is given as:\n$$\nU(r) = 4\\,\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\n$$\nwhere $r = |\\mathbf{r}_{ij}|$ is the scalar distance between particles $i$ and $j$.\n\nFirst, we derive the force vector $\\mathbf{F}_{ij}$. The force is defined as the negative gradient of the potential energy with respect to the interparticle separation vector $\\mathbf{r}_{ij}$:\n$$\n\\mathbf{F}_{ij} = -\\nabla_{\\mathbf{r}_{ij}} U(r)\n$$\nSince the potential $U$ is a function of the scalar distance $r$ only, we can apply the chain rule for the gradient:\n$$\n\\nabla_{\\mathbf{r}_{ij}} U(r) = \\frac{dU}{dr} \\nabla_{\\mathbf{r}_{ij}} r\n$$\nThe gradient of the scalar distance $r = |\\mathbf{r}_{ij}| = \\sqrt{x_{ij}^2 + y_{ij}^2 + z_{ij}^2}$ is the radial unit vector $\\hat{\\mathbf{r}}_{ij}$:\n$$\n\\nabla_{\\mathbf{r}_{ij}} r = \\frac{\\mathbf{r}_{ij}}{r} = \\hat{\\mathbf{r}}_{ij}\n$$\nTherefore, the force vector can be expressed as:\n$$\n\\mathbf{F}_{ij}(r) = -\\frac{dU}{dr} \\hat{\\mathbf{r}}_{ij}\n$$\nWe now compute the derivative of the potential $U(r)$ with respect to $r$. For clarity, let us rewrite $U(r)$ as:\n$$\nU(r) = 4\\,\\varepsilon\\left(\\sigma^{10}r^{-10} - \\sigma^{5}r^{-5}\\right)\n$$\nThe derivative is:\n$$\n\\frac{dU}{dr} = 4\\,\\varepsilon \\frac{d}{dr}\\left(\\sigma^{10}r^{-10} - \\sigma^{5}r^{-5}\\right) = 4\\,\\varepsilon\\left(\\sigma^{10}(-10)r^{-11} - \\sigma^{5}(-5)r^{-6}\\right)\n$$\n$$\n\\frac{dU}{dr} = 4\\,\\varepsilon\\left(-10 \\frac{\\sigma^{10}}{r^{11}} + 5 \\frac{\\sigma^{5}}{r^{6}}\\right)\n$$\nFactoring out common terms, we can write:\n$$\n\\frac{dU}{dr} = \\frac{20\\,\\varepsilon}{r} \\left(-2 \\frac{\\sigma^{10}}{r^{10}} + \\frac{\\sigma^{5}}{r^{5}}\\right) = -\\frac{20\\,\\varepsilon}{r} \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\n$$\nSubstituting this derivative back into the expression for the force, we obtain:\n$$\n\\mathbf{F}_{ij}(r) = - \\left(-\\frac{20\\,\\varepsilon}{r} \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\\right) \\hat{\\mathbf{r}}_{ij}\n$$\n$$\n\\mathbf{F}_{ij}(r) = \\frac{20\\,\\varepsilon}{r} \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right] \\hat{\\mathbf{r}}_{ij}\n$$\nThis is the analytical expression for the force vector.\n\nNext, we derive the scalar pair virial, $w(r)$. The definition is provided as:\n$$\nw(r) = \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij}(r)\n$$\nWe substitute the derived expression for $\\mathbf{F}_{ij}(r)$:\n$$\nw(r) = \\mathbf{r}_{ij} \\cdot \\left(\\frac{20\\,\\varepsilon}{r} \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right] \\hat{\\mathbf{r}}_{ij}\\right)\n$$\nUsing the relation $\\mathbf{r}_{ij} = r \\hat{\\mathbf{r}}_{ij}$ and noting that the dot product of a unit vector with itself is unity, $\\hat{\\mathbf{r}}_{ij} \\cdot \\hat{\\mathbf{r}}_{ij} = 1$, we find:\n$$\nw(r) = (r \\hat{\\mathbf{r}}_{ij}) \\cdot \\left(\\frac{20\\,\\varepsilon}{r} \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right] \\hat{\\mathbf{r}}_{ij}\\right)\n$$\n$$\nw(r) = r \\left(\\frac{20\\,\\varepsilon}{r} \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\\right) (\\hat{\\mathbf{r}}_{ij} \\cdot \\hat{\\mathbf{r}}_{ij})\n$$\nThe factors of $r$ cancel, leaving:\n$$\nw(r) = 20\\,\\varepsilon \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\n$$\nThis is the analytical expression for the scalar pair virial. An alternative and equivalent path to the virial is to use the expression $w(r) = -r \\frac{dU}{dr}$, which yields the same result:\n$$\nw(r) = -r \\left(-\\frac{20\\,\\varepsilon}{r} \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\\right) = 20\\,\\varepsilon \\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\n$$\nThe derivation is complete. We have obtained closed-form expressions for both the force vector and the scalar pair virial.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{20\\,\\varepsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right]\\hat{\\mathbf{r}}_{ij} & 20\\,\\varepsilon\\left[2\\left(\\frac{\\sigma}{r}\\right)^{10} - \\left(\\frac{\\sigma}{r}\\right)^{5}\\right] \\end{pmatrix}}\n$$", "id": "2404403"}, {"introduction": "While the mathematical link between potential and force is universal, the choice of the potential function itself is crucial for physical realism. A simple harmonic potential, like a perfect spring, fails to capture a key chemical phenomenon: bond dissociation. This practice explores the limitations of the harmonic model and introduces the more sophisticated Morse potential, highlighting how it provides a more accurate description of covalent bonds, especially under energetic conditions that could lead to bond breaking [@problem_id:2407785].", "problem": "In a molecular mechanics force field used in computational biology and bioinformatics, a covalent bond is sometimes modeled with a harmonic potential $U_h(r) = \\tfrac{1}{2} k (r - r_0)^2$, where $k$ is the bond force constant and $r_0$ is the equilibrium bond length. An alternative is the Morse potential $U_M(r) = D_e \\left(1 - e^{-a (r - r_0)}\\right)^2$, where $D_e$ is the dissociation energy and $a$ controls the potential’s range. Consider an isolated diatomic fragment representing a single covalent bond. At time $t = 0$, the interatomic distance is $r = r_0$ and an impulse imparts relative kinetic energy $E_0$ along the bond stretching direction. Ignore all other degrees of freedom, environmental coupling, and nonbonded interactions. In a typical explicit molecular dynamics (MD) integrator with time step $\\Delta t$, very large instantaneous forces can cause numerical instability.\n\nWhich of the following statements correctly describe the physical and numerical consequences for this setup, and justify replacing the harmonic bond with the Morse potential in a molecular mechanics force field?\n\nA. Under $U_h(r)$, the atoms remain bound for any finite $E_0$. The outer turning point satisfies $U_h(r_{\\max}) = E_0$, giving $r_{\\max} = r_0 + \\sqrt{2 E_0 / k}$ and a maximum restoring force magnitude at the turning point of $\\sqrt{2 k E_0}$, which can become arbitrarily large as $E_0$ increases, risking catastrophic integrator failure for fixed $\\Delta t$. Under $U_M(r)$, if $E_0 > D_e$, the bond dissociates and the force magnitude decays to $0$ as $r \\to \\infty$, so energies and forces remain bounded by physically meaningful values, avoiding runaway forces.\n\nB. Under $U_h(r)$, the potential energy is bounded above by $D_e$ as $r \\to \\infty$, so there is no risk of unbounded forces or numerical instability; therefore, replacing $U_h(r)$ with $U_M(r)$ is unnecessary.\n\nC. For small displacements $|r - r_0| \\ll a^{-1}$, $U_M(r)$ is approximately harmonic with curvature $k_{\\mathrm{eff}} = 2 D_e a^2$, so one can match $k_{\\mathrm{eff}}$ to a chosen $k$ and reproduce near-equilibrium vibrations while adding realistic bond dissociation at large $r$.\n\nD. Replacing $U_h(r)$ with $U_M(r)$ necessarily increases the highest vibrational frequency near $r_0$, which forces a smaller stable time step $\\Delta t$ in explicit MD, making the Morse potential numerically worse near equilibrium.\n\nE. The catastrophic failure arises under $U_h(r)$ because its restoring force decays to $0$ as $r$ increases, allowing runaway separation; $U_M(r)$ fixes this by providing a linearly increasing force at large $r$.", "solution": "The problem requires a critical comparison of two potential energy functions used to model a covalent bond in molecular mechanics: the harmonic potential, $U_h(r)$, and the Morse potential, $U_M(r)$. We must analyze their physical realism and their implications for the numerical stability of molecular dynamics (MD) simulations.\n\nThe harmonic potential is given by:\n$$ U_h(r) = \\frac{1}{2} k (r - r_0)^2 $$\nwhere $k$ is the force constant and $r_0$ is the equilibrium bond length. The force associated with this potential is derived from its negative gradient:\n$$ F_h(r) = -\\frac{dU_h(r)}{dr} = -k (r - r_0) $$\nThis is a simple Hooke's Law restoring force. A key feature of the harmonic potential is that $U_h(r) \\to \\infty$ as the interatomic distance $r$ deviates from $r_0$. Consequently, the magnitude of the restoring force, $|F_h(r)| = k|r-r_0|$, increases linearly without bound. This is physically unrealistic, as a true covalent bond will break (dissociate) if stretched sufficiently, at which point the potential energy should approach a constant value (the dissociation energy) and the force between the atoms should approach zero.\n\nIn the scenario described, the system starts at $r=r_0$ with kinetic energy $E_0$. By conservation of energy, the total energy is $E_{total} = E_0$. The atoms will oscillate. The outer turning point, $r_{max}$, is reached when all kinetic energy is converted to potential energy, i.e., $U_h(r_{max}) = E_0$.\n$$ \\frac{1}{2} k (r_{max} - r_0)^2 = E_0 \\implies r_{max} = r_0 + \\sqrt{\\frac{2 E_0}{k}} $$\nFor any finite positive energy $E_0$, there is a finite turning point, meaning the bond never breaks. The maximum force magnitude is experienced at this turning point:\n$$ |F_{h, max}| = |F_h(r_{max})| = k(r_{max} - r_0) = k \\sqrt{\\frac{2 E_0}{k}} = \\sqrt{2 k E_0} $$\nThis maximum force grows with $\\sqrt{E_0}$ and can become arbitrarily large if $E_0$ is large. In an explicit MD integrator with a fixed time step $\\Delta t$, very large forces can cause particles to be displaced by unphysically large distances in a single step, leading to numerical instability and catastrophic failure of the simulation.\n\nThe Morse potential is a more realistic alternative:\n$$ U_M(r) = D_e \\left(1 - e^{-a (r - r_0)}\\right)^2 $$\nHere, $D_e$ is the bond dissociation energy and $a$ is a parameter controlling the \"width\" of the potential well.\nKey properties of the Morse potential are:\n1.  As $r \\to \\infty$, $e^{-a(r-r_0)} \\to 0$, so $U_M(r) \\to D_e$. This correctly models bond dissociation.\n2.  The potential has a minimum of $0$ at $r = r_0$.\n\nThe force derived from the Morse potential is:\n$$ F_M(r) = -\\frac{dU_M(r)}{dr} = -2 a D_e \\left(1 - e^{-a (r - r_0)}\\right) e^{-a (r - r_0)} = -2 a D_e \\left(e^{-a(r-r_0)} - e^{-2a(r-r_0)}\\right) $$\nAs $r \\to \\infty$, both exponential terms approach $0$, so the force $F_M(r) \\to 0$. This is physically correct; separated atoms should not exert a force on each other. The force from a Morse potential is bounded. Its maximum value occurs at $r = r_0 + \\frac{\\ln(2)}{a}$ and is equal to $\\frac{a D_e}{2}$. This finite upper limit on the force, regardless of the system's energy, prevents the runaway force problem seen with the harmonic potential. If the initial kinetic energy $E_0$ exceeds the dissociation energy $D_e$, the bond will simply break, and the atoms will separate with the force between them decaying to zero, which is a physically and numerically stable outcome.\n\nNow, we evaluate each option.\n\nA. Under $U_h(r)$, the atoms remain bound for any finite $E_0$. The outer turning point satisfies $U_h(r_{\\max}) = E_0$, giving $r_{\\max} = r_0 + \\sqrt{2 E_0 / k}$ and a maximum restoring force magnitude at the turning point of $\\sqrt{2 k E_0}$, which can become arbitrarily large as $E_0$ increases, risking catastrophic integrator failure for fixed $\\Delta t$. Under $U_M(r)$, if $E_0 > D_e$, the bond dissociates and the force magnitude decays to $0$ as $r \\to \\infty$, so energies and forces remain bounded by physically meaningful values, avoiding runaway forces.\n**Verdict: Correct.** This statement accurately summarizes the analysis above. It correctly identifies the unbounded nature of the harmonic force and its numerical consequences, and contrasts this with the physically realistic dissociation and a numerically benign bounded force provided by the Morse potential.\n\nB. Under $U_h(r)$, the potential energy is bounded above by $D_e$ as $r \\to \\infty$, so there is no risk of unbounded forces or numerical instability; therefore, replacing $U_h(r)$ with $U_M(r)$ is unnecessary.\n**Verdict: Incorrect.** The premise is false. The harmonic potential $U_h(r) = \\frac{1}{2} k (r - r_0)^2$ is unbounded; it grows quadratically as $r$ moves away from $r_0$. Therefore, the forces are also unbounded, presenting a significant risk of numerical instability.\n\nC. For small displacements $|r - r_0| \\ll a^{-1}$, $U_M(r)$ is approximately harmonic with curvature $k_{\\mathrm{eff}} = 2 D_e a^2$, so one can match $k_{\\mathrm{eff}}$ to a chosen $k$ and reproduce near-equilibrium vibrations while adding realistic bond dissociation at large $r$.\n**Verdict: Correct.** To verify this, we perform a Taylor expansion of $U_M(r)$ around $r=r_0$. Let $x = r - r_0$. For small $x$, we have $e^{-ax} \\approx 1 - ax + \\frac{1}{2}(-ax)^2 = 1-ax+\\frac{a^2x^2}{2}$.\nSubstituting this into the Morse potential expression:\n$$ U_M(x) = D_e \\left(1 - \\left(1 - ax + \\frac{a^2x^2}{2} + \\dots \\right)\\right)^2 = D_e \\left(ax - \\frac{a^2x^2}{2} + \\dots \\right)^2 $$\nExpanding and keeping the lowest order term in $x$:\n$$ U_M(x) \\approx D_e(ax)^2 = D_e a^2 x^2 = D_e a^2 (r - r_0)^2 $$\nComparing this to the harmonic form $U_h(r) = \\frac{1}{2} k (r - r_0)^2$, we can define an effective force constant $k_{eff}$ such that $\\frac{1}{2} k_{eff} (r - r_0)^2 = D_e a^2 (r-r_0)^2$. This yields $k_{eff} = 2 D_e a^2$. Thus, the Morse potential can be parameterized to match the harmonic potential's behavior for small oscillations, ensuring it accurately models near-equilibrium vibrations, while also providing the correct dissociation behavior. This is a primary justification for its use.\n\nD. Replacing $U_h(r)$ with $U_M(r)$ necessarily increases the highest vibrational frequency near $r_0$, which forces a smaller stable time step $\\Delta t$ in explicit MD, making the Morse potential numerically worse near equilibrium.\n**Verdict: Incorrect.** As shown in the analysis for option C, one can choose the parameters of the Morse potential ($a$ and $D_e$) to match any desired effective force constant $k_{eff}$ near equilibrium, including setting $k_{eff} = k$ of a given harmonic potential. The vibrational frequency, $\\omega = \\sqrt{k_{eff}/\\mu}$ (where $\\mu$ is the reduced mass), is therefore not necessarily increased. The statement is false.\n\nE. The catastrophic failure arises under $U_h(r)$ because its restoring force decays to $0$ as $r$ increases, allowing runaway separation; $U_M(r)$ fixes this by providing a linearly increasing force at large $r$.\n**Verdict: Incorrect.** This statement has the physics reversed. The failure under $U_h(r)$ is due to its linearly *increasing* force, which becomes unbounded. It is the Morse potential, $U_M(r)$, whose force decays to $0$ at large $r$.\n\nBased on the analysis, statements A and C are correct descriptions of the physical and numerical properties that justify using the Morse potential over the harmonic potential in molecular mechanics simulations.", "answer": "$$\\boxed{AC}$$", "id": "2407785"}, {"introduction": "Implementing realistic potentials brings practical challenges, especially for long-range interactions like the Coulomb force. Since calculating interactions between all pairs of particles is computationally expensive, a common strategy is to ignore interactions beyond a certain cutoff distance. This practice demonstrates the unphysical consequences of a crude, sharp cutoff—such as instantaneous jumps in energy and force—and shows how a smooth switching function provides a more elegant and physically sound solution that is essential for stable and energy-conserving simulations [@problem_id:2404374].", "problem": "You are to analyze artifacts introduced in pairwise electrostatic interactions when a Coulomb potential is abruptly truncated at a cutoff distance versus when it is smoothly switched to zero by a switching function. Work in reduced units where the Coulomb constant $k_\\mathrm{e}$ equals $1$ and the absolute product of the two charges satisfies $\\lvert q_i q_j \\rvert = 1$. Under these reduced units, the unswitched pair potential is $U(r) = 1/r$ and the corresponding force magnitude is $F(r) = 1/r^2$, where $r$ is the scalar separation between two point charges.\n\nDefine the following two models for the pair interaction:\n\n- Sharp truncation at cutoff $r_\\mathrm{c}$:\n  - Potential:\n    $$\n    U_\\mathrm{T}(r; r_\\mathrm{c}) =\n    \\begin{cases}\n    \\dfrac{1}{r}, & r < r_\\mathrm{c},\\\\\n    0, & r \\ge r_\\mathrm{c}.\n    \\end{cases}\n    $$\n  - Force magnitude:\n    $$\n    F_\\mathrm{T}(r; r_\\mathrm{c}) =\n    \\begin{cases}\n    \\dfrac{1}{r^2}, & r < r_\\mathrm{c},\\\\\n    0, & r \\ge r_\\mathrm{c}.\n    \\end{cases}\n    $$\n\n- Switching with a cubic switching function $S(r; r_\\mathrm{on}, r_\\mathrm{c})$ that is equal to $1$ for $r \\le r_\\mathrm{on}$, equal to $0$ for $r \\ge r_\\mathrm{c}$, and varies smoothly for $r \\in (r_\\mathrm{on}, r_\\mathrm{c})$:\n  - Define $x(r) = \\dfrac{r - r_\\mathrm{on}}{r_\\mathrm{c} - r_\\mathrm{on}}$.\n  - Switching function:\n    $$\n    S(r; r_\\mathrm{on}, r_\\mathrm{c}) =\n    \\begin{cases}\n    1, & r \\le r_\\mathrm{on},\\\\\n    1 - 3x(r)^2 + 2x(r)^3, & r_\\mathrm{on} < r < r_\\mathrm{c},\\\\\n    0, & r \\ge r_\\mathrm{c}.\n    \\end{cases}\n    $$\n  - Switched potential:\n    $$\n    U_\\mathrm{S}(r; r_\\mathrm{on}, r_\\mathrm{c}) = S(r; r_\\mathrm{on}, r_\\mathrm{c}) \\cdot \\dfrac{1}{r}.\n    $$\n  - Switched force magnitude, obtained from $F(r) = -\\dfrac{\\mathrm{d}U(r)}{\\mathrm{d}r}$ applied to $U_\\mathrm{S}$:\n    $$\n    F_\\mathrm{S}(r; r_\\mathrm{on}, r_\\mathrm{c}) = S(r; r_\\mathrm{on}, r_\\mathrm{c}) \\cdot \\dfrac{1}{r^2} - \\dfrac{\\mathrm{d}S(r; r_\\mathrm{on}, r_\\mathrm{c})}{\\mathrm{d}r} \\cdot \\dfrac{1}{r}.\n    $$\n\nFor any chosen parameters $(r_\\mathrm{on}, r_\\mathrm{c})$ with $0 \\le r_\\mathrm{on} < r_\\mathrm{c}$, define an infinitesimal separation $\\epsilon > 0$ and quantify the apparent jump at the cutoff for each model by the absolute difference across $r_\\mathrm{c}$:\n- Potential jump magnitudes:\n  $$\n  \\Delta U_\\mathrm{T} = \\left| U_\\mathrm{T}(r_\\mathrm{c} - \\epsilon; r_\\mathrm{c}) - U_\\mathrm{T}(r_\\mathrm{c} + \\epsilon; r_\\mathrm{c}) \\right|,\n  \\quad\n  \\Delta U_\\mathrm{S} = \\left| U_\\mathrm{S}(r_\\mathrm{c} - \\epsilon; r_\\mathrm{on}, r_\\mathrm{c}) - U_\\mathrm{S}(r_\\mathrm{c} + \\epsilon; r_\\mathrm{on}, r_\\mathrm{c}) \\right|.\n  $$\n- Force jump magnitudes:\n  $$\n  \\Delta F_\\mathrm{T} = \\left| F_\\mathrm{T}(r_\\mathrm{c} - \\epsilon; r_\\mathrm{c}) - F_\\mathrm{T}(r_\\mathrm{c} + \\epsilon; r_\\mathrm{c}) \\right|,\n  \\quad\n  \\Delta F_\\mathrm{S} = \\left| F_\\mathrm{S}(r_\\mathrm{c} - \\epsilon; r_\\mathrm{on}, r_\\mathrm{c}) - F_\\mathrm{S}(r_\\mathrm{c} + \\epsilon; r_\\mathrm{on}, r_\\mathrm{c}) \\right|.\n  $$\n\nUse the fixed infinitesimal $\\epsilon = 10^{-6}$ (dimensionless). All quantities are dimensionless in the reduced units defined above. For each test case below, compute the list $[\\Delta U_\\mathrm{T}, \\Delta U_\\mathrm{S}, \\Delta F_\\mathrm{T}, \\Delta F_\\mathrm{S}]$.\n\nTest suite (each item is $(r_\\mathrm{on}, r_\\mathrm{c})$):\n- Case A: $(0.8, 1.0)$.\n- Case B: $(0.99, 1.0)$.\n- Case C: $(0.5, 2.0)$.\n\nFinal output requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes its own list in the same order as above. For example, the output must look like $[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]$ with no spaces.\n- Round every floating-point value to exactly $10$ decimal places before formatting the output.", "solution": "The user has presented a problem from computational engineering concerning the treatment of long-range electrostatic interactions in molecular simulations. The task is to quantify the discontinuity, or \"jump,\" in potential energy and force at a cutoff distance $r_\\mathrm{c}$ for two different schemes: a sharp truncation and a smooth switching function. All calculations are performed in a system of reduced units where $k_\\mathrm{e} = 1$ and $|q_i q_j| = 1$.\n\nFirst, let us analyze the problem statement. The problem provides complete and consistent definitions for two potential models, $U_\\mathrm{T}(r)$ for sharp truncation and $U_\\mathrm{S}(r)$ for a smooth switch. The corresponding force magnitudes, $F_\\mathrm{T}(r)$ and $F_\\mathrm{S}(r)$, are correctly derived from the fundamental relation $F(r) = -\\frac{\\mathrm{d}U(r)}{\\mathrm{d}r}$. The mathematical forms of the potentials and the switching function are standard in the field. The objectives are stated with clarity and all required parameters, including the test cases $(r_\\mathrm{on}, r_\\mathrm{c})$ and the infinitesimal evaluation distance $\\epsilon = 10^{-6}$, are provided. The problem is scientifically sound, well-posed, and objective. It is therefore deemed valid.\n\nWe proceed to the solution. The objective is to calculate the jump magnitudes for potential and force for both models at the cutoff $r_\\mathrm{c}$. The jump is defined as the absolute difference of the function's value at $r_\\mathrm{c} - \\epsilon$ and $r_\\mathrm{c} + \\epsilon$.\n\n1.  **Analysis of the Sharp Truncation Model ($U_\\mathrm{T}, F_\\mathrm{T}$)**\n\n    The potential $U_\\mathrm{T}(r; r_\\mathrm{c})$ is defined as $\\frac{1}{r}$ for $r < r_\\mathrm{c}$ and $0$ for $r \\ge r_\\mathrm{c}$.\n    The force $F_\\mathrm{T}(r; r_\\mathrm{c})$ is $\\frac{1}{r^2}$ for $r < r_\\mathrm{c}$ and $0$ for $r \\ge r_\\mathrm{c}$.\n\n    The values immediately on either side of the cutoff are:\n    -   $U_\\mathrm{T}(r_\\mathrm{c} - \\epsilon) = \\frac{1}{r_\\mathrm{c} - \\epsilon}$\n    -   $U_\\mathrm{T}(r_\\mathrm{c} + \\epsilon) = 0$\n    -   $F_\\mathrm{T}(r_\\mathrm{c} - \\epsilon) = \\frac{1}{(r_\\mathrm{c} - \\epsilon)^2}$\n    -   $F_\\mathrm{T}(r_\\mathrm{c} + \\epsilon) = 0$\n\n    Therefore, the jump magnitudes are:\n    $$\n    \\Delta U_\\mathrm{T} = \\left| \\frac{1}{r_\\mathrm{c} - \\epsilon} - 0 \\right| = \\frac{1}{r_\\mathrm{c} - \\epsilon}\n    $$\n    $$\n    \\Delta F_\\mathrm{T} = \\left| \\frac{1}{(r_\\mathrm{c} - \\epsilon)^2} - 0 \\right| = \\frac{1}{(r_\\mathrm{c} - \\epsilon)^2}\n    $$\n    These functions have inherent discontinuities at $r = r_\\mathrm{c}$. The jump in potential leads to a non-physical infinite force (a Dirac delta function) at $r_\\mathrm{c}$, which is a primary reason such truncation is often avoided in high-fidelity simulations.\n\n2.  **Analysis of the Switched Model ($U_\\mathrm{S}, F_\\mathrm{S}$)**\n\n    The switched potential is $U_\\mathrm{S}(r) = S(r) \\cdot \\frac{1}{r}$, where $S(r)$ is the switching function. By definition, for $r \\ge r_\\mathrm{c}$, $S(r) = 0$, which implies $U_\\mathrm{S}(r \\ge r_\\mathrm{c}) = 0$ and $F_\\mathrm{S}(r \\ge r_\\mathrm{c}) = 0$.\n    Thus, $U_\\mathrm{S}(r_\\mathrm{c} + \\epsilon) = 0$ and $F_\\mathrm{S}(r_\\mathrm{c} + \\epsilon) = 0$.\n\n    For the values at $r_\\mathrm{c} - \\epsilon$, we analyze the properties of the switching function $S(r)$. It is constructed using a cubic polynomial in the variable $x(r) = \\frac{r - r_\\mathrm{on}}{r_\\mathrm{c} - r_\\mathrm{on}}$. The form $S(x) = 1 - 3x^2 + 2x^3$ ensures that at the boundaries of the switching interval:\n    -   At $r = r_\\mathrm{on}$: $x = 0$, $S(0) = 1$, and $\\frac{\\mathrm{d}S}{\\mathrm{d}r} \\propto \\frac{\\mathrm{d}S}{\\mathrm{d}x} = 6x(x-1) = 0$.\n    -   At $r = r_\\mathrm{c}$: $x = 1$, $S(1) = 1 - 3 + 2 = 0$, and $\\frac{\\mathrm{d}S}{\\mathrm{d}r} \\propto \\frac{\\mathrm{d}S}{\\mathrm{d}x} = 6x(x-1) = 0$.\n\n    Both the function $S(r)$ and its first derivative $\\frac{\\mathrm{d}S}{\\mathrm{d}r}$ are continuous and equal to zero for $r \\ge r_\\mathrm{c}$. This construction guarantees that the potential $U_\\mathrm{S}(r)$ and the force $F_\\mathrm{S}(r) = S(r)\\frac{1}{r^2} - \\frac{\\mathrm{d}S}{\\mathrm{d}r}\\frac{1}{r}$ are continuous functions that smoothly approach zero at $r = r_\\mathrm{c}$. Consequently, in the strict mathematical limit $\\epsilon \\to 0$, both $\\Delta U_\\mathrm{S}$ and $\\Delta F_\\mathrm{S}$ are exactly zero.\n\n    However, the problem requires calculation for a finite $\\epsilon = 10^{-6}$. In this case, at $r_1 = r_\\mathrm{c} - \\epsilon$, the values of $S(r_1)$ and $\\frac{\\mathrm{d}S}{\\mathrm{d}r}|_{r_1}$ will be small but non-zero. The jumps are then computed as:\n    $$\n    \\Delta U_\\mathrm{S} = \\left| U_\\mathrm{S}(r_\\mathrm{c} - \\epsilon) - 0 \\right| = \\left| S(r_\\mathrm{c} - \\epsilon) \\cdot \\frac{1}{r_\\mathrm{c} - \\epsilon} \\right|\n    $$\n    $$\n    \\Delta F_\\mathrm{S} = \\left| F_\\mathrm{S}(r_\\mathrm{c} - \\epsilon) - 0 \\right| = \\left| S(r_\\mathrm{c} - \\epsilon) \\frac{1}{(r_\\mathrm{c} - \\epsilon)^2} - \\frac{\\mathrm{d}S}{\\mathrm{d}r}\\bigg|_{r=r_\\mathrm{c}-\\epsilon} \\frac{1}{r_\\mathrm{c} - \\epsilon} \\right|\n    $$\n    The derivative of the switching function is $\\frac{\\mathrm{d}S}{\\mathrm{d}r} = \\frac{\\mathrm{d}S}{\\mathrm{d}x}\\frac{\\mathrm{d}x}{\\mathrm{d}r} = (6x^2 - 6x) \\frac{1}{r_\\mathrm{c} - r_\\mathrm{on}}$. These non-zero values represent the \"residual\" jump due to evaluating at a finite distance from the true cutoff, not an intrinsic discontinuity.\n\n3.  **Computational Algorithm**\n\n    For each test case $(r_\\mathrm{on}, r_\\mathrm{c})$:\n    1.  Set the constants: $\\epsilon = 10^{-6}$.\n    2.  Define the evaluation point below the cutoff: $r_1 = r_\\mathrm{c} - \\epsilon$.\n    3.  Calculate jumps for the truncated model:\n        -   $\\Delta U_\\mathrm{T} = 1 / r_1$.\n        -   $\\Delta F_\\mathrm{T} = 1 / r_1^2$.\n    4.  Calculate jumps for the switched model:\n        -   Compute the scaled coordinate: $x_1 = (r_1 - r_\\mathrm{on}) / (r_\\mathrm{c} - r_\\mathrm{on})$.\n        -   Compute the switching function value: $S_1 = 1 - 3x_1^2 + 2x_1^3$.\n        -   Compute the potential jump: $\\Delta U_\\mathrm{S} = S_1 / r_1$.\n        -   Compute the switching function derivative: $\\frac{\\mathrm{d}S}{\\mathrm{d}r}|_{r_1} = (6x_1^2 - 6x_1) / (r_\\mathrm{c} - r_\\mathrm{on})$.\n        -   Compute the force value: $F_{\\mathrm{S},1} = S_1/r_1^2 - (\\frac{\\mathrm{d}S}{\\mathrm{d}r}|_{r_1}) / r_1$.\n        -   Compute the force jump: $\\Delta F_\\mathrm{S} = |F_{\\mathrm{S},1}|$.\n    5.  Collect the four values $[\\Delta U_\\mathrm{T}, \\Delta U_\\mathrm{S}, \\Delta F_\\mathrm{T}, \\Delta F_\\mathrm{S}]$.\n\nThis procedure is implemented for all test cases provided. The results demonstrate that while $\\Delta U_\\mathrm{T}$ and $\\Delta F_\\mathrm{T}$ are of order unity, $\\Delta U_\\mathrm{S}$ and $\\Delta F_\\mathrm{S}$ are many orders of magnitude smaller, reflecting the continuity of the switched potential and force.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes discontinuities in truncated and switched Coulomb potentials.\n    \"\"\"\n    test_cases = [\n        (0.8, 1.0),  # Case A\n        (0.99, 1.0), # Case B\n        (0.5, 2.0)   # Case C\n    ]\n    epsilon = 1e-6\n    all_results = []\n\n    for ron, rc in test_cases:\n        # Define the evaluation point just below the cutoff\n        r1 = rc - epsilon\n\n        # --- Analysis for Sharp Truncation Model ---\n        # The jump is the value just below the cutoff, as the value above is zero.\n        delta_U_T = 1.0 / r1\n        delta_F_T = 1.0 / r1**2\n\n        # --- Analysis for Switched Model ---\n        # The value above the cutoff is zero by construction. The jump is the value at r1.\n        \n        # Calculate the scaled coordinate in the switching region\n        delta_r_switch = rc - ron\n        x1 = (r1 - ron) / delta_r_switch\n\n        # Calculate the switching function S(r) at r1\n        # S(x) = 1 - 3x^2 + 2x^3\n        S1 = 1.0 - 3.0 * x1**2 + 2.0 * x1**3\n        \n        # Calculate potential jump for switched model\n        delta_U_S = S1 / r1\n\n        # Calculate the derivative of the switching function dS/dr at r1\n        # dS/dr = (dS/dx) * (dx/dr)\n        # dS/dx = -6x + 6x^2\n        # dx/dr = 1 / (rc - ron)\n        dSdx1 = -6.0 * x1 + 6.0 * x1**2\n        dSdr1 = dSdx1 / delta_r_switch\n\n        # Calculate force F_S(r) = S(r)/r^2 - (dS/dr)/r at r1\n        F_S_1 = S1 / r1**2 - dSdr1 / r1\n        \n        # The force jump is the absolute value of the force at r1\n        delta_F_S = abs(F_S_1)\n\n        case_result = [delta_U_T, delta_U_S, delta_F_T, delta_F_S]\n        all_results.append(case_result)\n\n    # Format the final output string as specified\n    def format_case(case_res):\n        formatted_nums = [f\"{x:.10f}\" for x in case_res]\n        return f\"[{','.join(formatted_nums)}]\"\n\n    output_str = f\"[{','.join([format_case(res) for res in all_results])}]\"\n    print(output_str)\n\n\nsolve()\n```", "id": "2404374"}]}