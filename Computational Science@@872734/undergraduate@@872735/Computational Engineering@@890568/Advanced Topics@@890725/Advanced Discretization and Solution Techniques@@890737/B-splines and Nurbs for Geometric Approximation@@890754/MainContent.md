## Introduction
In the world of computational engineering and computer-aided design (CAD), B-splines and their generalization, Non-Uniform Rational B-splines (NURBS), form the backbone of modern geometric modeling. Their ability to represent both simple analytical shapes and complex free-form surfaces with mathematical precision and flexibility is unparalleled. However, mastering these tools requires a deep understanding that goes beyond simple application, bridging the gap between the abstract mathematics of their construction and their powerful role in physical simulation and analysis. This article addresses this need by providing a structured journey into the world of B-splines and NURBS, demonstrating how they serve as a unifying language for design and engineering.

Across the following chapters, you will build a robust understanding of this essential technology. The journey begins with "**Principles and Mechanisms**," where we will dissect the mathematical machinery of B-[splines](@entry_id:143749) and NURBS, exploring how control points, knot vectors, and weights govern their shape and continuity. Next, in "**Applications and Interdisciplinary Connections**," we will see these principles in action, examining how NURBS are used to solve complex problems in fields from robotics and [biomechanics](@entry_id:153973) to advanced [shape optimization](@entry_id:170695). Finally, you will have the opportunity to solidify your knowledge through "**Hands-On Practices**," applying the theory to solve practical problems in geometric interpolation and analysis.

## Principles and Mechanisms

This chapter delves into the fundamental principles and operational mechanisms of B-[splines](@entry_id:143749) and their rational counterparts, NURBS. Building upon the introductory concepts, we will now systematically dissect the mathematical machinery that grants these tools their power and versatility in geometric modeling and computational engineering. We will explore how their constituent components—control points, knot vectors, degrees, and weights—are manipulated to achieve precise control over shape and continuity.

### The Foundations of B-Spline Curves

At its core, a **B-spline (Basis [spline](@entry_id:636691)) curve** is a [piecewise polynomial](@entry_id:144637) curve defined by a set of control points, a polynomial degree, and a [knot vector](@entry_id:176218). A degree-$p$ B-spline curve $\mathbf{C}(u)$ is expressed as a [linear combination](@entry_id:155091) of $n+1$ control points $\mathbf{P}_i \in \mathbb{R}^d$:

$$
\mathbf{C}(u) = \sum_{i=0}^{n} N_{i,p}(u) \mathbf{P}_i
$$

Here, the functions $N_{i,p}(u)$ are the **B-[spline](@entry_id:636691) basis functions** of degree $p$, which are themselves [piecewise polynomials](@entry_id:634113) defined recursively over a [sequence of real numbers](@entry_id:141090) $U = \{u_0, u_1, \dots, u_m\}$ known as the **[knot vector](@entry_id:176218)**.

A crucial prerequisite for constructing a meaningful B-[spline](@entry_id:636691) curve is the relationship between the number of control points ($n+1$) and the degree $p$. The number of [knots](@entry_id:637393) is linked to these by the fundamental relation $m = n + p + 1$. The effective parametric domain of the curve, over which the basis functions form a [partition of unity](@entry_id:141893), is the interval $[u_p, u_{n+1}]$. For this interval to be non-degenerate (i.e., to have a non-zero length), we must have $u_p  u_{n+1}$. However, since a [knot vector](@entry_id:176218) is a nondecreasing sequence, the condition $p  n$ implies $p \ge n+1$, which in turn means $u_p \ge u_{n+1}$. This leads to a contradiction unless the parametric domain collapses to a single point or becomes empty. Therefore, to define a nontrivial B-[spline](@entry_id:636691) curve over a parameter interval of non-zero length, the degree $p$ cannot exceed the number of control point polygon segments, $n$. That is, the condition $p \le n$ must be satisfied [@problem_id:2372175].

A defining characteristic of B-[spline](@entry_id:636691) basis functions is their property of **local support**. The [basis function](@entry_id:170178) $N_{i,p}(u)$ is non-zero only for $u \in [u_i, u_{i+p+1})$. Consequently, for any given parameter value $u$, only a small subset of basis functions (at most $p+1$) are non-zero. This means that the position of a point $\mathbf{C}(u)$ on the curve depends only on a local neighborhood of $p+1$ control points. This local control is a significant advantage over representations like single-segment Bézier curves, where every control point influences every point on the curve.

This locality has profound computational implications. While a degree-$p$ Bézier curve is evaluated in $\mathcal{O}(p^2)$ operations using the de Casteljau algorithm, a B-spline curve can be evaluated with the same asymptotic cost using the **de Boor algorithm**. The de Boor algorithm is a generalization of the de Casteljau algorithm that operates only on the $p+1$ locally active control points. Therefore, the cost of evaluating a point on a B-spline is independent of the total number of control points, $n$. Before the arithmetic can be performed, one must first identify the knot interval (or "span") $[u_k, u_{k+1})$ that contains the parameter $u$. For a general, non-uniform [knot vector](@entry_id:176218), this search requires $\mathcal{O}(\log n)$ time using [binary search](@entry_id:266342). In many practical applications, such as rendering a curve by evaluating points sequentially, the knot span can be found in $\mathcal{O}(1)$ time, making the overall evaluation highly efficient [@problem_id:2372138].

### Mechanisms of Shape Control in B-Splines

The shape of a B-[spline](@entry_id:636691) curve or surface is controlled by its defining parameters. While moving control points is the most intuitive method, the [knot vector](@entry_id:176218) offers a more powerful and nuanced mechanism for shape manipulation, primarily by controlling continuity.

The continuity of a B-spline curve of degree $p$ at a knot $u_j$ is determined by the knot's **[multiplicity](@entry_id:136466)**, which is the number of times its value appears consecutively in the [knot vector](@entry_id:176218). If an internal knot has a multiplicity of $k$, the curve is generically $C^{p-k}$ continuous at that location. This means the curve has continuous derivatives up to order $p-k$.

This principle allows for precise local control over the smoothness of a curve. For a smooth degree-$p$ curve (e.g., $C^{p-1}$), all internal [knots](@entry_id:637393) must have a multiplicity of 1. To introduce a "corner" or "crease"—a point of positional continuity ($C^0$) but [tangential discontinuity](@entry_id:203201)—one can increase the [multiplicity](@entry_id:136466) of a knot. For a degree-$p$ curve, inserting a knot $u^*$ until its [multiplicity](@entry_id:136466) becomes $p$ reduces the continuity at that point to $C^{p-p} = C^0$. A fascinating consequence of this operation is that the curve is forced to interpolate a control point of the refined control net at the location $u^*$. This operation effectively creates a sharp corner by [decoupling](@entry_id:160890) the control points on either side, allowing the [tangent vectors](@entry_id:265494) to be defined independently [@problem_id:2372215].

This concept extends directly to tensor-product B-spline surfaces, where creases can be formed along parametric lines. To create a sharp crease along a line $u=u_c$ on a degree-$(p, q)$ surface, one inserts the knot $u_c$ into the $u$-direction [knot vector](@entry_id:176218) until its multiplicity reaches $p$. This reduces the continuity across the line to $C^0$ and allows the two rows of control points adjacent to the crease to be manipulated independently to control the tangent plane on either side, thus forming a sharp edge while maintaining a single connected surface patch [@problem_id:2372148].

When joining two distinct B-[spline](@entry_id:636691) patches, the continuity across their common boundary depends on both the control point configurations and the knot vectors. This gives rise to the important distinction between **parametric continuity ($C^k$)** and **geometric continuity ($G^k$)**.
-   **$C^k$ continuity** requires that the [partial derivatives](@entry_id:146280) of the two surfaces, up to order $k$, match exactly at the boundary. This is a very strong condition.
-   **$G^k$ continuity** is a weaker, more geometric condition. For $k=1$, $G^1$ continuity requires the patches to share a [common tangent plane](@entry_id:175976) along the boundary, but the magnitudes and parametric directions of the [tangent vectors](@entry_id:265494) need not match. The tangent vectors must be collinear.

Consider two cubic ($p=3$) B-spline surfaces, $S^{(1)}$ and $S^{(2)}$, joined at a boundary. If the control points are arranged to ensure positional continuity and the first-difference vectors of the control points are aligned and equal ($\mathbf{P}^{(1)}_{n,j} - \mathbf{P}^{(1)}_{n-1,j} = \mathbf{P}^{(2)}_{1,j} - \mathbf{P}^{(2)}_{0,j}$), one might expect $C^1$ continuity. However, the derivative of a B-[spline](@entry_id:636691) curve at its end depends on the spacing of the first internal knot. If the knot vectors $U^{(1)}$ and $U^{(2)}$ have different internal knot spacing near the boundary, the scalar pre-factors in the derivative formulas will differ. This can lead to a situation where the cross-boundary [tangent vectors](@entry_id:265494) are collinear but have different magnitudes (e.g., $\frac{\partial S^{(1)}}{\partial u} = \alpha \frac{\partial S^{(2)}}{\partial u}$ with $\alpha \neq 1$). In this scenario, the surface is only $G^1$ continuous, not $C^1$, because the tangent planes match but the parametric derivatives do not [@problem_id:2372178].

### From B-Splines to NURBS: The Projective View

Non-Uniform Rational B-Splines, or **NURBS**, are a generalization of B-splines that can precisely represent a wider class of shapes, including [conic sections](@entry_id:175122) like circles and ellipses. The fundamental difference is the introduction of a weight $w_i$ for each control point $\mathbf{P}_i$. The formula for a NURBS curve is a rational function:

$$
\mathbf{C}(u) = \frac{\sum_{i=0}^{n} N_{i,p}(u) w_i \mathbf{P}_i}{\sum_{i=0}^{n} N_{i,p}(u) w_i}
$$

While this formula appears as a mere [algebraic extension](@entry_id:155470), its true geometric meaning is revealed through the lens of [projective geometry](@entry_id:156239). A NURBS curve in $d$-dimensional space ($\mathbb{R}^d$) can be understood as the perspective projection of a polynomial B-[spline](@entry_id:636691) curve living in a $(d+1)$-dimensional [projective space](@entry_id:149949).

The construction is as follows [@problem_id:2372204]:
1.  Each control point $\mathbf{P}_i \in \mathbb{R}^d$ is "lifted" into a **homogeneous control point** $\tilde{\mathbf{P}}_i \in \mathbb{R}^{d+1}$ by multiplying its coordinates by the weight $w_i$ and appending the weight as a new, $(d+1)$-th coordinate: $\tilde{\mathbf{P}}_i = (w_i \mathbf{P}_i, w_i)$.
2.  A standard polynomial B-spline curve, $\tilde{\mathbf{C}}(u)$, is constructed in $\mathbb{R}^{d+1}$ using these homogeneous control points and the original basis functions $N_{i,p}(u)$:
    $$
    \tilde{\mathbf{C}}(u) = \sum_{i=0}^{n} N_{i,p}(u) \tilde{\mathbf{P}}_i = \left( \sum_{i=0}^{n} N_{i,p}(u) w_i \mathbf{P}_i, \sum_{i=0}^{n} N_{i,p}(u) w_i \right)
    $$
3.  This higher-dimensional curve is then projected back into $\mathbb{R}^d$ by dividing the first $d$ coordinates by the $(d+1)$-th, or homogeneous, coordinate.

This process of **dehomogenization** reveals that the denominator in the NURBS formula, $W(u) = \sum_{i=0}^{n} N_{i,p}(u) w_i$, is precisely the homogeneous coordinate of the associated projective B-[spline](@entry_id:636691) curve. The division is the geometric projection that maps the polynomial curve in [projective space](@entry_id:149949) to the rational curve in Euclidean space.

### The Role of Weights in NURBS Shape Control

The introduction of weights provides a powerful new shape control handle, governed by the principles of [projective geometry](@entry_id:156239).

A direct consequence of the projective formulation is **[projective invariance](@entry_id:163470)**. If all weights $\{w_i\}$ are multiplied by a common positive constant $\alpha$, the resulting NURBS curve is identical to the original, in both shape and [parametrization](@entry_id:272587). This is because the factor $\alpha$ appears in both the numerator and the denominator of the [homogeneous coordinates](@entry_id:154569) and cancels out perfectly during the dehomogenization step [@problem_id:2372193]. This shows that it is the *ratios* of the weights that determine the shape, not their absolute values.

While uniform scaling has no effect, changing the relative values of weights provides potent local shape control. Increasing the weight $w_k$ of a single control point $\mathbf{P}_k$ pulls the curve closer to that control point. In the limit, as a single weight $w_k \to \infty$ while all other weights are held constant, the curve is pulled directly onto the control point $\mathbf{P}_k$ for all parameter values $u$ where the corresponding basis function $N_{k,p}(u)$ is non-zero. For parameter values outside the support of $N_{k,p}(u)$, the curve remains unaffected and behaves like a B-[spline](@entry_id:636691) with the remaining unit-weight control points [@problem_id:2372168].

The standard convention is to use positive weights, which guarantees that the denominator $W(u)$ is always positive and that the curve lies within the convex hull of its active control points. However, allowing **negative weights** unlocks the ability to model a wider variety of shapes, at the cost of some desirable properties [@problem_id:2372139]:
-   **Partition of Unity**: The rational basis functions $R_i(u) = \frac{N_{i,p}(u) w_i}{W(u)}$ still sum to one, $\sum_i R_i(u) = 1$. This means the curve is an **[affine combination](@entry_id:276726)** of its control points.
-   **Loss of Convex Hull Property**: If weights can be negative, the rational basis functions $R_i(u)$ can take on negative values. This means the curve is no longer a **convex combination**, and it is not guaranteed to lie within the convex hull of its control points.
-   **Poles and Asymptotes**: With weights of mixed signs, the denominator $W(u)$ can pass through zero at some parameter value $u^*$. If the numerator is non-zero at this point, the curve has a pole, and its magnitude diverges as $u \to u^*$. This creates an asymptote and allows NURBS to represent unbounded curves like hyperbolas.
-   **Preservation of Local Support**: The local support property is inherited from the B-spline basis functions. The rational [basis function](@entry_id:170178) $R_i(u)$ is zero wherever $N_{i,p}(u)$ is zero, so the local control of the curve is maintained.

### Implications for Isogeometric Analysis

The [expressive power](@entry_id:149863) and smoothness of NURBS make them an ideal foundation for **Isogeometric Analysis (IGA)**, a computational method that uses the same basis functions to represent both the geometry of a domain and the physical fields (e.g., displacement, temperature) defined on it. This unifies design and analysis. However, a fundamental property of the NURBS basis has a critical implication for how simulations are performed.

In classical Finite Element Analysis (FEA), Lagrange basis functions possess the **Kronecker delta property** at the element nodes: a [basis function](@entry_id:170178) associated with a node is equal to 1 at that node and 0 at all other nodes. This makes the imposition of essential (Dirichlet) boundary conditions trivial—one simply sets the value of the degree of freedom corresponding to the boundary node.

In contrast, B-spline and NURBS basis functions are generally **non-interpolatory**. That is, a [basis function](@entry_id:170178) $R_I$ is not equal to 1 at its associated control point location and 0 at others. Control points are coefficients in a [basis expansion](@entry_id:746689), not points that the surface necessarily passes through. Consequently, setting a single control variable (degree of freedom) to a prescribed value does not enforce the boundary condition at any specific point on the geometry.

The correct "strong" enforcement of a Dirichlet condition along a boundary curve requires constraining all control variables that influence that boundary, typically by solving a small linear system to match the solution's trace to a representation of the boundary data in the boundary basis. An important exception occurs at the corners and ends of domains defined with **open knot vectors**. At these specific parametric locations, the basis *is* interpolatory, allowing for direct, nodal-like imposition of boundary conditions. For all other boundary regions, the non-interpolatory nature of the basis necessitates either this more complex strong enforcement or the use of weak enforcement techniques like [penalty methods](@entry_id:636090) or Lagrange multipliers [@problem_id:2651363]. This distinction is a cornerstone of understanding and correctly implementing IGA.