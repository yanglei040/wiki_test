{"hands_on_practices": [{"introduction": "Before assembling a global solution, domain decomposition methods require us to first define the problem on each individual subdomain. This foundational exercise guides you through the process of deriving the local stiffness matrices for a simple one-dimensional problem, a core skill in finite element analysis. By working through this calculation [@problem_id:2552503], you will gain a concrete understanding of how a global problem is deconstructed into the fundamental building blocks used in methods like FETI and BDDC.", "problem": "Consider the scalar diffusion model problem on the open interval $\\Omega=(0,1)$, with homogeneous Dirichlet boundary conditions at $x=0$ and $x=1$, and bilinear form $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,dx$. Split $\\Omega$ into two non-overlapping subdomains $\\Omega_1=(0,\\tfrac{1}{2})$ and $\\Omega_2=(\\tfrac{1}{2},1)$, as in Finite Element Tearing and Interconnecting (FETI) and Balancing Domain Decomposition by Constraints (BDDC) methods. On each subdomain, use a single $P_1$ (continuous, piecewise-linear) finite element defined on the subdomain’s two-node mesh, with the standard nodal basis functions associated with the subdomain endpoints. Number local nodes on $\\Omega_1$ in increasing $x$-order as $1 \\mapsto x=0$, $2 \\mapsto x=\\tfrac{1}{2}$, and on $\\Omega_2$ as $1 \\mapsto x=\\tfrac{1}{2}$, $2 \\mapsto x=1$.\n\nStarting from the weak form definition of the finite element stiffness contributions and the affine mapping from a reference element to a physical element, derive the $2\\times 2$ local stiffness matrix on a generic one-dimensional $P_1$ element of length $h$ by integrating products of basis function derivatives. Specialize your result to each subdomain to obtain the explicit local stiffness matrices $K^{(1)}$ on $\\Omega_1$ and $K^{(2)}$ on $\\Omega_2$. Identify, in the local numbering of each subdomain, which local degree of freedom lies on the interface at $x=\\tfrac{1}{2}$.\n\nExpress your final answer as a single row matrix that lists, in order: the four entries of $K^{(1)}$ in row-major order, then the four entries of $K^{(2)}$ in row-major order, followed by the local interface degree-of-freedom indices on $\\Omega_1$ and $\\Omega_2$. Do not round; use exact values. No units are required.", "solution": "The problem statement is analyzed and found to be valid. It is a standard, well-posed problem in the finite element method and serves as a foundational step for domain decomposition techniques such as FETI and BDDC. We shall proceed with the derivation.\n\nThe local stiffness matrix $K^{(e)}$ for a finite element $e$ is defined by its entries $K_{ij}^{(e)} = a(\\phi_j, \\phi_i)$, where the bilinear form $a(\\cdot, \\cdot)$ is restricted to the element domain $\\Omega_e$, and $\\phi_i, \\phi_j$ are the local basis functions. For the given problem, $a(u,v) = \\int_{\\Omega} u'(x)v'(x)dx$, so the entries of the local stiffness matrix for an element of length $h$ spanning the interval $[x_1, x_2]$ are given by:\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx $$\nWe will derive this matrix for a generic one-dimensional $P_1$ element and then specialize the result for subdomains $\\Omega_1$ and $\\Omega_2$.\n\nFirst, consider the standard reference element, an interval $\\hat{\\Omega} = [0, 1]$ with local coordinate $\\xi$. The $P_1$ basis functions (hat functions) on this reference element are linear polynomials defined by their nodal values:\n$$ \\hat{\\phi}_1(\\xi) = 1 - \\xi $$\n$$ \\hat{\\phi}_2(\\xi) = \\xi $$\nTheir derivatives with respect to the reference coordinate $\\xi$ are constant:\n$$ \\frac{d\\hat{\\phi}_1}{d\\xi} = -1 $$\n$$ \\frac{d\\hat{\\phi}_2}{d\\xi} = 1 $$\n\nNext, we establish the affine mapping from the reference coordinate $\\xi \\in [0, 1]$ to the physical coordinate $x$ in a generic element $[x_1, x_2]$ of length $h = x_2 - x_1$:\n$$ x(\\xi) = x_1 + (x_2 - x_1)\\xi = x_1 + h\\xi $$\nThe Jacobian of this transformation is $J = \\frac{dx}{d\\xi} = h$. Its inverse is $\\frac{d\\xi}{dx} = \\frac{1}{h}$.\n\nThe physical basis functions $\\phi_i(x)$ are related to the reference basis functions $\\hat{\\phi}_i(\\xi)$ by composition with the inverse mapping: $\\phi_i(x) = \\hat{\\phi}_i(\\xi(x))$. We use the chain rule to find their derivatives with respect to the physical coordinate $x$:\n$$ \\frac{d\\phi_i}{dx} = \\frac{d\\hat{\\phi}_i}{d\\xi} \\frac{d\\xi}{dx} = \\frac{1}{h} \\frac{d\\hat{\\phi}_i}{d\\xi} $$\nSpecifically:\n$$ \\phi_1'(x) = \\frac{1}{h}(-1) = -\\frac{1}{h} $$\n$$ \\phi_2'(x) = \\frac{1}{h}(1) = \\frac{1}{h} $$\nThese derivatives are constant over the element.\n\nNow we can compute the entries of the generic $2 \\times 2$ local stiffness matrix $K^{(e)}$. The integral in the physical domain is transformed to an integral over the reference domain $[0, 1]$ using $dx = J d\\xi = h d\\xi$:\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx = \\int_{0}^{1} \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_i}{d\\xi}\\right) \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_j}{d\\xi}\\right) (h d\\xi) = \\frac{1}{h} \\int_{0}^{1} \\frac{d\\hat{\\phi}_i}{d\\xi}\\frac{d\\hat{\\phi}_j}{d\\xi}d\\xi $$\nWe compute each of the four entries:\n$$ K_{11}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\n$$ K_{12}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{21}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{22}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\nThus, the generic local stiffness matrix for a 1D $P_1$ element of length $h$ is:\n$$ K^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\nNow, we specialize this result to the two subdomains $\\Omega_1$ and $\\Omega_2$.\n\nFor subdomain $\\Omega_1 = (0, \\frac{1}{2})$, we have a single element with nodes at $x=0$ and $x=\\frac{1}{2}$. The length of this element is $h_1 = \\frac{1}{2} - 0 = \\frac{1}{2}$. The local stiffness matrix $K^{(1)}$ is:\n$$ K^{(1)} = \\frac{1}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 2 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & -2 \\\\ -2 & 2 \\end{pmatrix} $$\nThe entries in row-major order are $2, -2, -2, 2$.\n\nFor subdomain $\\Omega_2 = (\\frac{1}{2}, 1)$, we have a single element with nodes at $x=\\frac{1}{2}$ and $x=1$. The length of this element is $h_2 = 1 - \\frac{1}{2} = \\frac{1}{2}$. The local stiffness matrix $K^{(2)}$ is:\n$$ K^{(2)} = \\frac{1}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 2 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & -2 \\\\ -2 & 2 \\end{pmatrix} $$\nThe entries in row-major order are $2, -2, -2, 2$.\n\nFinally, we must identify the local degree of freedom (DoF) on the interface at $x=\\frac{1}{2}$ for each subdomain. A DoF's index corresponds to its local node number.\nOn subdomain $\\Omega_1$, the local nodes are numbered as $1 \\mapsto x=0$ and $2 \\mapsto x=\\frac{1}{2}$. The interface is at $x=\\frac{1}{2}$, which corresponds to local node index $2$.\nOn subdomain $\\Omega_2$, the local nodes are numbered as $1 \\mapsto x=\\frac{1}{2}$ and $2 \\mapsto x=1$. The interface is at $x=\\frac{1}{2}$, which corresponds to local node index $1$.\n\nWe assemble these results into a single row matrix as requested. The components are:\n1.  Entries of $K^{(1)}$ (row-major): $2, -2, -2, 2$.\n2.  Entries of $K^{(2)}$ (row-major): $2, -2, -2, 2$.\n3.  Interface DoF index on $\\Omega_1$: $2$.\n4.  Interface DoF index on $\\Omega_2$: $1$.\nThe combined list of values is $(2, -2, -2, 2, 2, -2, -2, 2, 2, 1)$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 2 & -2 & -2 & 2 & 2 & -2 & -2 & 2 & 2 & 1 \\end{pmatrix} } $$", "id": "2552503"}, {"introduction": "Once a problem is divided into subdomains, Schwarz methods iteratively combine local solutions to converge on the global one. This practice exercise [@problem_id:2552509] demystifies the process by having you perform a single iteration of the classic additive Schwarz method by hand. Comparing the result to one step of the well-known Jacobi iteration on the same problem will highlight the distinct mechanism and potential power of domain decomposition as an iterative solver.", "problem": "Consider the scalar diffusion problem $-u''=f$ on the interval $[0,6]$ with homogeneous Dirichlet boundary conditions $u(0)=u(6)=0$. Discretize by continuous piecewise-linear finite elements on a uniform mesh with spacing $h=1$, so that the assembled symmetric positive definite (SPD) stiffness matrix $A\\in\\mathbb{R}^{5\\times 5}$ on the $5$ interior nodes $\\{1,2,3,4,5\\}$ is the standard tridiagonal matrix with $2$ on the diagonal and $-1$ on the first sub- and super-diagonals. Let the right-hand side be the vector $b=e_{3}\\in\\mathbb{R}^{5}$, where $e_{3}$ is the unit vector with a $1$ at node $3$ and zeros elsewhere, and start from the initial guess $u^{0}=0$.\n\nDefine an overlapping three-subdomain decomposition with subdomain index sets\n- $\\Omega_{1}=\\{1,2,3\\}$,\n- $\\Omega_{2}=\\{3,4,5\\}$,\n- $\\Omega_{3}=\\{2,3,4\\}$.\n\nFor each subdomain $\\Omega_{i}$, let $R_{i}\\in\\mathbb{R}^{3\\times 5}$ be the Boolean restriction operator that extracts the components on $\\Omega_{i}$ in the natural order, and let the local operator be $A_{i}=R_{i}AR_{i}^{\\top}\\in\\mathbb{R}^{3\\times 3}$. Consider the classical one-level additive Schwarz stationary iteration (with simple injection, no partition-of-unity weighting),\n$$\nu^{k+1}=u^{k}+\\sum_{i=1}^{3}R_{i}^{\\top}A_{i}^{-1}R_{i}\\,\\bigl(b-Au^{k}\\bigr),\n$$\nand the Jacobi iteration on the global system,\n$$\nu^{k+1}=u^{k}+D^{-1}\\bigl(b-Au^{k}\\bigr),\n$$\nwhere $D=\\operatorname{diag}(A)$ is the diagonal of $A$. Using $u^{0}=0$, perform one iteration of each method to obtain $u_{\\mathrm{AS}}^{1}$ and $u_{\\mathrm{J}}^{1}$, and compute the ratio of Euclidean norms of the corresponding residuals,\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}}.\n$$\n\nProvide your answer as a single exact expression (no rounding, no decimals).", "solution": "The problem statement is a well-posed exercise in numerical linear algebra, specifically concerning iterative methods for linear systems arising from the finite element discretization of a differential equation. It is scientifically grounded, formally defined, and contains all necessary information to proceed with a solution. No inconsistencies or invalid premises are present. We shall proceed with the calculation.\n\nThe global stiffness matrix $A \\in \\mathbb{R}^{5\\times 5}$ and the right-hand side vector $b \\in \\mathbb{R}^{5}$ are given as:\n$$\nA = \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ -1 & 2 & -1 & 0 & 0 \\\\ 0 & -1 & 2 & -1 & 0 \\\\ 0 & 0 & -1 & 2 & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix}, \\quad b = e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe initial guess is $u^{0} = 0 \\in \\mathbb{R}^{5}$.\n\nFirst, we compute one iteration of the Jacobi method. The Jacobi iteration is defined as $u^{k+1} = u^{k} + D^{-1}(b - Au^{k})$, where $D = \\operatorname{diag}(A)$.\nFor the first iteration, with $k=0$ and $u^{0} = 0$, we have:\n$$\nu_{\\mathrm{J}}^{1} = u^{0} + D^{-1}(b - Au^{0}) = D^{-1}b\n$$\nThe diagonal of $A$ is $D = \\operatorname{diag}(2, 2, 2, 2, 2) = 2I$, where $I$ is the $5 \\times 5$ identity matrix. Thus, its inverse is $D^{-1} = \\frac{1}{2}I$.\nThe first Jacobi iterate is:\n$$\nu_{\\mathrm{J}}^{1} = \\frac{1}{2}I b = \\frac{1}{2}b = \\frac{1}{2}e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe corresponding residual is $r_{\\mathrm{J}}^{1} = b - Au_{\\mathrm{J}}^{1}$. We first compute $Au_{\\mathrm{J}}^{1}$:\n$$\nA u_{\\mathrm{J}}^{1} = A \\left(\\frac{1}{2}e_{3}\\right) = \\frac{1}{2} (A e_{3}) = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\nThe residual is then:\n$$\nr_{\\mathrm{J}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\nThe Euclidean norm of the Jacobi residual is:\n$$\n\\|r_{\\mathrm{J}}^{1}\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2}} = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{1}{2}}\n$$\n\nNext, we compute one iteration of the one-level additive Schwarz method. The iteration is $u^{k+1} = u^{k} + \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}\\,(b - Au^{k})$.\nFor the first iteration, with $k=0$ and $u^{0}=0$, we have:\n$$\nu_{\\mathrm{AS}}^{1} = \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}b\n$$\nWe analyze each subdomain contribution. The local matrices are $A_{i} = R_{i}AR_{i}^{\\top}$. For the subdomains $\\Omega_{1} = \\{1,2,3\\}$, $\\Omega_{2} = \\{3,4,5\\}$, and $\\Omega_{3} = \\{2,3,4\\}$, the corresponding local stiffness matrices are the principal submatrices of $A$:\n$$\nA_{1} = A_{2} = A_{3} = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}\n$$\nThe inverse of this matrix is required. The determinant is $\\det(A_{1}) = 2(2 \\cdot 2 - (-1)(-1)) - (-1)(-1 \\cdot 2 - 0) = 2(3) - 2 = 4$. The inverse is:\n$$\nA_{1}^{-1} = A_{2}^{-1} = A_{3}^{-1} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix}\n$$\nNow we compute the local solves. The right-hand side $b=e_{3}$ is restricted to each subdomain, yielding local vectors $b_{i} = R_{i}b$:\n$$\nb_{1} = R_{1}b = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad b_{2} = R_{2}b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad b_{3} = R_{3}b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nThe local solutions are $w_{i} = A_{i}^{-1}b_{i}$:\n$$\nw_{1} = A_{1}^{-1}b_{1} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n$$\nw_{2} = A_{2}^{-1}b_{2} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n$$\nw_{3} = A_{3}^{-1}b_{3} = \\frac{1}{4} \\begin{pmatrix} 3 & 2 & 1 \\\\ 2 & 4 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\nThese local solutions are extended back to the global vector space using $R_{i}^{\\top}$ and summed to obtain the first additive Schwarz iterate:\n$$\nu_{\\mathrm{AS}}^{1} = R_{1}^{\\top}w_{1} + R_{2}^{\\top}w_{2} + R_{3}^{\\top}w_{3} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 0 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 2 \\\\ 4 \\\\ 2 \\\\ 0 \\end{pmatrix} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix}\n$$\nThe corresponding residual is $r_{\\mathrm{AS}}^{1} = b - Au_{\\mathrm{AS}}^{1}$. We first compute $Au_{\\mathrm{AS}}^{1}$:\n$$\nAu_{\\mathrm{AS}}^{1} = \\frac{1}{4} \\begin{pmatrix} 2 & -1 & 0 & 0 & 0 \\\\ -1 & 2 & -1 & 0 & 0 \\\\ 0 & -1 & 2 & -1 & 0 \\\\ 0 & 0 & -1 & 2 & -1 \\\\ 0 & 0 & 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2-4 \\\\ -1+8-10 \\\\ -4+20-4 \\\\ -10+8-1 \\\\ -4+2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} -2 \\\\ -3 \\\\ 12 \\\\ -3 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix}\n$$\nThe residual is then:\n$$\nr_{\\mathrm{AS}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/4 \\\\ -2 \\\\ 3/4 \\\\ 1/2 \\end{pmatrix}\n$$\nThe Euclidean norm of the additive Schwarz residual is:\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{\\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{3}{4}\\right)^{2} + (-2)^{2} + \\left(\\frac{3}{4}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\frac{1}{4} + \\frac{9}{16} + 4 + \\frac{9}{16} + \\frac{1}{4}}\n$$\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{2\\left(\\frac{1}{4}\\right) + 2\\left(\\frac{9}{16}\\right) + 4} = \\sqrt{\\frac{1}{2} + \\frac{9}{8} + 4} = \\sqrt{\\frac{4}{8} + \\frac{9}{8} + \\frac{32}{8}} = \\sqrt{\\frac{45}{8}} = \\frac{3\\sqrt{5}}{2\\sqrt{2}} = \\frac{3\\sqrt{10}}{4}\n$$\nFinally, we compute the required ratio of the norms of the residuals:\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\|r_{\\mathrm{AS}}^{1}\\|_{2}}{\\|r_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\frac{3\\sqrt{10}}{4}}{\\sqrt{\\frac{1}{2}}} = \\frac{3\\sqrt{10}}{4} \\cdot \\sqrt{2} = \\frac{3\\sqrt{20}}{4} = \\frac{3 \\cdot 2\\sqrt{5}}{4} = \\frac{6\\sqrt{5}}{4} = \\frac{3\\sqrt{5}}{2}\n$$", "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{2}}\n$$", "id": "2552509"}, {"introduction": "The true power of computational methods is unlocked when we move from manual calculations to programming, allowing us to explore complex scenarios. This hands-on coding challenge [@problem_id:2387021] involves implementing a multiplicative Schwarz solver for a two-dimensional Poisson problem. You will then use your implementation to conduct a numerical experiment, investigating how the shape of the interface between subdomains—from a straight line to a sine wave—affects the convergence speed of the method, a key consideration in practical applications.", "problem": "Consider the classical overlapping Schwarz method applied to the scalar Poisson equation on the unit square. Let the domain be $\\Omega = [0,1]\\times[0,1]$, and consider the boundary value problem\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega,\\qquad u = 0 \\quad \\text{on } \\partial\\Omega,\n$$\nwith a smooth right-hand side $f$. In a domain decomposition, the computational domain is partitioned into two overlapping subdomains separated by an artificial interface. In the classical setup this interface is a straight line; here, the artificial interface is allowed to be a smooth curve defined by a sine wave. The multiplicative Schwarz iteration solves the subproblems sequentially and uses Dirichlet transmission conditions taken from the most recent iterate on the artificial interface. You are to investigate numerically how the curvature of the artificial interface influences the convergence.\n\nImplement the following specification.\n\n- Discretization. Use a uniform Cartesian grid of $N\\times N$ interior points covering $\\Omega$ with mesh size $h = \\frac{1}{N+1}$ in both directions and the standard $5$-point finite difference stencil for the Laplacian. Use homogeneous Dirichlet boundary conditions on $\\partial\\Omega$. Let the right-hand side be $f(x,y) = 1$ at all interior grid points.\n\n- Artificial interface and subdomains. For a given amplitude $A \\ge 0$ and an integer frequency $m \\ge 0$, define the artificial interface as the graph\n$$\nx_\\Gamma(y) = \\tfrac{1}{2} + A \\sin\\!\\big(2\\pi m\\, y\\big), \\quad y\\in[0,1].\n$$\nLet the overlap width be $\\delta = p\\,h$ where $p$ is a nonnegative integer. Define the overlapping subdomains on the grid as:\n    - Left subdomain: grid points with coordinates $(x_i,y_j)$ satisfying $x_i \\le x_\\Gamma(y_j) + \\delta$,\n    - Right subdomain: grid points with coordinates $(x_i,y_j)$ satisfying $x_i \\ge x_\\Gamma(y_j) - \\delta$.\nThe two subdomains overlap on the set of grid points where both inequalities hold.\n\n- Multiplicative Schwarz iteration. Initialize the global interior grid function $u^{(0)}$ to zero. For iteration $k = 0,1,2,\\dots$:\n    $1.$ Solve the discrete Poisson problem on the left subdomain using Dirichlet data taken from the current global iterate $u^{(k)}$ on all neighbors that lie outside the left subdomain (and zero on the physical boundary). Overwrite the global iterate on all left subdomain points with this left-subdomain solution.\n    $2.$ Solve the discrete Poisson problem on the right subdomain using Dirichlet data taken from the current global iterate (which includes the just-updated left-subdomain values) on all neighbors that lie outside the right subdomain (and zero on the physical boundary). Overwrite the global iterate on all right subdomain points with this right-subdomain solution.\nEach subdomain solve is exact with respect to the discrete operator (that is, it is solved to machine precision by a direct linear solver).\n\n- Convergence metric. After each full Schwarz iteration (that is, after both subdomain solves), compute the global discrete residual $r^{(k)} = f - L_h u^{(k)}$ at all interior points, where $L_h$ is the $5$-point discrete Laplacian with homogeneous Dirichlet boundary values. Let $\\|r^{(k)}\\|_2$ denote its Euclidean norm. Define the observed asymptotic contraction factor $q$ as the geometric mean of the ratios $\\|r^{(k+1)}\\|_2 / \\|r^{(k)}\\|_2$ over the last available $K$ iterations before termination, where $K = \\min(5, \\text{number of completed iterations})$. Terminate the iteration when the relative residual $\\|r^{(k)}\\|_2 / \\|f\\|_2$ falls below $10^{-8}$ or when $50$ iterations have been completed, whichever happens first.\n\n- Grid resolution. Use $N = 40$ interior points in each spatial direction.\n\nYour task is to write a complete program that implements the above and reports how curvature affects convergence by varying the amplitude $A$ and the frequency $m$ in the interface definition, while keeping the overlap width $\\delta$ fixed in grid units.\n\nTest suite. Run the program on the following parameter sets $(A,m,p)$:\n    - Case $1$: $(0.0, 0, 3)$, straight interface at $x=\\tfrac{1}{2}$ with overlap of $3$ grid cells,\n    - Case $2$: $(0.1, 1, 3)$, sine-wave interface of amplitude $0.1$ and frequency $1$ with overlap of $3$ grid cells,\n    - Case $3$: $(0.15, 2, 3)$, sine-wave interface of amplitude $0.15$ and frequency $2$ with overlap of $3$ grid cells,\n    - Case $4$: $(0.1, 4, 3)$, sine-wave interface of amplitude $0.1$ and frequency $4$ with overlap of $3$ grid cells.\n\nRequired final output format. Your program should produce a single line of output containing the observed asymptotic contraction factors $q$ for the four cases, in order from Case $1$ to Case $4$, rounded to $4$ decimals, as a comma-separated list enclosed in square brackets, for example, $[q_1,q_2,q_3,q_4]$. No other text should be printed. No physical units are involved in this problem, and no angles are reported; all trigonometric function arguments are understood to be dimensionless.", "solution": "The problem posed is a valid and well-defined numerical experiment in computational engineering. It is scientifically grounded in the theory of partial differential equations and numerical methods, specifically domain decomposition techniques. All parameters, conditions, and objectives are clearly specified, allowing for a unique and verifiable solution. I will proceed with a full solution.\n\nThe problem requires a numerical investigation into the convergence behavior of the multiplicative Schwarz method for a two-dimensional Poisson problem on the unit square $\\Omega = [0,1]\\times[0,1]$. The convergence is to be studied as a function of the geometry of the artificial interface separating the two subdomains.\n\nThe governing partial differential equation is:\n$$-\\Delta u = f \\quad \\text{in } \\Omega$$\nwith homogeneous Dirichlet boundary conditions $u=0$ on $\\partial\\Omega$ and a constant right-hand side $f(x,y)=1$.\n\nFirst, we discretize the domain and the operator. The domain $\\Omega$ is discretized using a uniform Cartesian grid with $N=40$ interior points in each direction. The mesh size is $h = \\frac{1}{N+1}$. The grid points are $(x_i, y_j) = (ih, jh)$ for $i,j = 1, \\dots, N$. The unknown values $u(x_i, y_j)$ are denoted by $u_{i,j}$. Using a standard five-point finite difference stencil for the negative Laplacian operator, $-\\Delta_h$, we obtain the discrete equation at each interior grid point $(i,j)$:\n$$ \\frac{1}{h^2} (4u_{i,j} - u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1}) = f_{i,j} $$\nwhere $f_{i,j}=1$ for all interior points. The $N^2$ unknowns are ordered into a single vector $U \\in \\mathbb{R}^{N^2}$ using row-major ordering, where the global index $k$ for the point $(i,j)$ (with $i,j$ starting from $0$ in implementation) is $k = j \\cdot N + i$. This leads to a large, sparse, symmetric positive-definite linear system of the form $L U = F$, where $L \\in \\mathbb{R}^{N^2 \\times N^2}$ is the matrix representation of $-\\Delta_h$, and $F \\in \\mathbb{R}^{N^2}$ is the vector of ones representing the discretized right-hand side.\n\nThe domain is decomposed into two overlapping subdomains, $\\Omega_1$ (left) and $\\Omega_2$ (right), defined by a curved interface. The interface is given by the curve $x_\\Gamma(y) = \\frac{1}{2} + A \\sin(2\\pi m y)$. The overlap has a width of $\\delta = p h$. The discrete subdomains are defined by the sets of grid point indices:\n$$ \\mathcal{I}_1 = \\{ k=j \\cdot N + i \\mid x_i \\le x_\\Gamma(y_j) + \\delta \\} $$\n$$ \\mathcal{I}_2 = \\{ k=j \\cdot N + i \\mid x_i \\ge x_\\Gamma(y_j) - \\delta \\} $$\nwhere $(x_i, y_j)$ are the coordinates of the grid point corresponding to the global index $k$.\n\nThe multiplicative Schwarz iteration proceeds as follows, starting with an initial guess $U^{(0)} = 0 \\in \\mathbb{R}^{N^2}$. For each iteration $k=0, 1, 2, \\dots$:\n\n1.  **Left Subdomain Update:** We solve the problem on $\\Omega_1$ using Dirichlet data from the current global iterate $U^{(k)}$. This is implemented by computing a correction $E_1$ that is non-zero only on $\\Omega_1$. The correction is obtained by solving the system $L_1 E_1 = R_1^{(k)}$, where $L_1$ is the principal submatrix of $L$ corresponding to indices $\\mathcal{I}_1$, and $R_1^{(k)}$ is the restriction of the global residual $R^{(k)} = F - L U^{(k)}$ to the indices in $\\mathcal{I}_1$. The solution is then updated to form an intermediate iterate $U^{(k+1/2)}$:\n    $$ U_j^{(k+1/2)} = \\begin{cases} U_j^{(k)} + (E_1)_j & \\text{for } j \\in \\mathcal{I}_1 \\\\ U_j^{(k)} & \\text{for } j \\notin \\mathcal{I}_1 \\end{cases} $$\n\n2.  **Right Subdomain Update:** Similarly, we solve on $\\Omega_2$ using Dirichlet data from the most recent iterate $U^{(k+1/2)}$. A correction $E_2$ (non-zero only on $\\Omega_2$) is found by solving $L_2 E_2 = R_2^{(k+1/2)}$, where $L_2$ is the submatrix of $L$ for indices $\\mathcal{I}_2$, and $R_2^{(k+1/2)}$ is the restriction of the intermediate residual $R^{(k+1/2)} = F - L U^{(k+1/2)}$ to indices in $\\mathcal{I}_2$. The final iterate for this step is:\n    $$ U_j^{(k+1)} = \\begin{cases} U_j^{(k+1/2)} + (E_2)_j & \\text{for } j \\in \\mathcal{I}_2 \\\\ U_j^{(k+1/2)} & \\text{for } j \\notin \\mathcal{I}_2 \\end{cases} $$\n\nThe subdomain linear systems are solved exactly using a direct sparse LU factorization, as specified.\n\nThe iteration continues until the relative residual norm $\\|R^{(k+1)}\\|_2 / \\|F\\|_2$ is less than $10^{-8}$ or a maximum of $50$ iterations is reached. The asymptotic contraction factor $q$ is estimated by the geometric mean of the residual reduction factors $\\|R^{(j+1)}\\|_2 / \\|R^{(j)}\\|_2$ over the last $K$ iterations, where $K = \\min(5, \\text{number of completed iterations})$.\n\nThe implementation will consist of a main function that iterates through the specified test cases $(A,m,p)$. For each case, it will:\na. Construct the global system matrix $L$ and right-hand side vector $F$.\nb. Determine the index sets $\\mathcal{I}_1$ and $\\mathcal{I}_2$ based on the interface parameters.\nc. Extract and pre-factorize the subdomain matrices $L_1$ and $L_2$.\nd. Execute the multiplicative Schwarz iteration, recording all residual norms.\ne. Compute the contraction factor $q$ upon termination.\n\nThe final output is a list of these computed contraction factors. This numerical experiment will reveal the dependency of the Schwarz method's convergence rate on the amplitude and frequency of the interface curve. It is expected that higher curvature and longer interface length, which are consequences of larger $A$ and $m$, will degrade the convergence rate, leading to a larger contraction factor $q$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import splu\nimport math\n\ndef solve_case(params):\n    \"\"\"\n    Implements the multiplicative Schwarz method for a single parameter set.\n    \"\"\"\n    A, m, p = params\n    N = 40\n    MAX_ITER = 50\n    TOL = 1e-8\n\n    # 1. Discretization and System Setup\n    h = 1.0 / (N + 1)\n    \n    # Create global Laplacian matrix L for the operator -Delta_h\n    L = lil_matrix((N * N, N * N))\n    h2 = h * h\n    for j in range(N):\n        for i in range(N):\n            k = j * N + i\n            L[k, k] = 4.0 / h2\n            if i > 0:\n                L[k, k - 1] = -1.0 / h2\n            if i  N - 1:\n                L[k, k + 1] = -1.0 / h2\n            if j > 0:\n                L[k, k - N] = -1.0 / h2\n            if j  N - 1:\n                L[k, k + N] = -1.0 / h2\n    L = L.tocsc()\n\n    # Right-hand side vector F\n    F = np.ones(N * N)\n    f_norm = np.linalg.norm(F)\n\n    # 2. Artificial Interface and Subdomains\n    x_coords = np.linspace(h, 1.0 - h, N)\n    y_coords = np.linspace(h, 1.0 - h, N)\n    xg, yg = np.meshgrid(x_coords, y_coords)\n    \n    delta = p * h\n    x_gamma = 0.5 + A * np.sin(2 * math.pi * m * yg)\n    \n    mask1 = xg = x_gamma + delta\n    mask2 = xg >= x_gamma - delta\n    \n    idx1 = np.where(mask1.flatten())[0]\n    idx2 = np.where(mask2.flatten())[0]\n\n    # 3. Subproblem Setup\n    L1 = L[idx1, :][:, idx1].tocsc()\n    L2 = L[idx2, :][:, idx2].tocsc()\n    \n    # Pre-factorize for repeated solves\n    lu_solver1 = splu(L1)\n    lu_solver2 = splu(L2)\n\n    # 4. Multiplicative Schwarz Iteration\n    u = np.zeros(N * N)\n    residual_ratios = []\n    \n    # Initial residual\n    r_old = F - L @ u\n    r_norm_old = np.linalg.norm(r_old)\n\n    for k in range(MAX_ITER):\n        # Step 1: Solve for left subdomain\n        r1 = r_old[idx1]\n        e1 = lu_solver1.solve(r1)\n        u[idx1] += e1\n        \n        # Intermediate residual for multiplicative update\n        r_intermediate = F - L @ u\n        \n        # Step 2: Solve for right subdomain\n        r2 = r_intermediate[idx2]\n        e2 = lu_solver2.solve(r2)\n        u[idx2] += e2\n        \n        # Compute new residual and norm\n        r_new = F - L @ u\n        r_norm_new = np.linalg.norm(r_new)\n        \n        if r_norm_old > 1e-15: # Avoid division by zero\n            residual_ratios.append(r_norm_new / r_norm_old)\n        \n        # Update for next iteration\n        r_old = r_new\n        r_norm_old = r_norm_new\n        \n        # Convergence check\n        if r_norm_new / f_norm  TOL:\n            break\n    \n    # 5. Convergence Metric Calculation\n    num_ratios = len(residual_ratios)\n    if num_ratios == 0:\n        return 0.0\n\n    K = min(5, num_ratios)\n    last_K_ratios = residual_ratios[-K:]\n    \n    # Geometric mean\n    q = np.prod(last_K_ratios)**(1.0 / K)\n    \n    return q\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    # Test cases: (A, m, p)\n    # A: amplitude, m: frequency, p: overlap in grid cells\n    test_cases = [\n        (0.0, 0, 3),   # Case 1\n        (0.1, 1, 3),   # Case 2\n        (0.15, 2, 3),  # Case 3\n        (0.1, 4, 3)    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        q = solve_case(case)\n        results.append(np.round(q, 4))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2387021"}]}