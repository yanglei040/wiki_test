{"hands_on_practices": [{"introduction": "The best way to understand the Boundary Element Method (BEM) is to apply it from first principles. This first practice problem challenges you to do just that by calculating the capacitance between two parallel conducting strips, a fundamental problem in electrostatics [@problem_id:2374801]. By modeling each strip as a single element with a constant charge density, you will manually construct and solve the small $2 \\times 2$ BEM system, gaining direct insight into how boundary integral equations are discretized and solved.", "problem": "Consider two identical, perfectly conducting, straight strips in two-dimensional electrostatics, embedded in a homogeneous medium of permittivity $\\varepsilon$. The strips are parallel to the $x$-axis, centered at $y=+h$ (upper strip) and $y=-h$ (lower strip), and each extends from $x=-a$ to $x=+a$. Assume invariance in the out-of-plane direction (per-unit-depth formulation).\n\nThe upper strip is held at potential $+V_{0}/2$ and the lower strip at potential $-V_{0}/2$, with $V_{0} > 0$. Model each strip as a single constant source element carrying an unknown uniform line charge density $\\lambda_{1}$ (upper) and $\\lambda_{2}$ (lower), and collocate the boundary condition at the center of each strip (at $x=0$ on each strip).\n\nUse the direct boundary element method with the free-space two-dimensional fundamental solution of the Laplace equation,\n$$\nG(\\mathbf{r}) \\;=\\; -\\frac{1}{2\\pi}\\,\\ln\\!\\left(\\frac{|\\mathbf{r}|}{L_{0}}\\right),\n$$\nwhere $L_{0} > 0$ is an arbitrary reference length introduced to render the logarithm’s argument dimensionless. Write the two-by-two linear system for the nodal potentials at the collocation points in terms of the unknown line charge densities, evaluate the matrix entries analytically, solve for $\\lambda_{1}$ and $\\lambda_{2}$, and then compute the capacitance per unit out-of-plane depth,\n$$\nC' \\;=\\; \\frac{Q'}{V_{0}}, \\quad \\text{with} \\quad Q' \\;=\\; \\int_{-a}^{a} \\lambda_{1}\\,\\mathrm{d}x \\;=\\; 2a\\,\\lambda_{1}.\n$$\nProvide your final answer as a single closed-form analytic expression for $C'$ in terms of $\\varepsilon$, $a$, and $h$. Do not perform any numerical approximation or rounding. Express the capacitance per unit out-of-plane depth in farads per meter.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\nStep 1: Extract Givens.\n- System: Two identical, perfectly conducting, straight strips in two-dimensional electrostatics.\n- Medium: Homogeneous with permittivity $\\varepsilon$.\n- Geometry: Strips are parallel to the $x$-axis. Upper strip centered at $y=+h$, lower strip at $y=-h$. Each extends from $x=-a$ to $x=+a$. System is invariant in the out-of-plane direction.\n- Boundary Conditions: Upper strip potential is $\\phi_1 = +V_{0}/2$. Lower strip potential is $\\phi_2 = -V_{0}/2$, with $V_{0} > 0$.\n- Model: Each strip is a single constant source element. Upper strip carries uniform line charge density $\\lambda_{1}$. Lower strip carries uniform line charge density $\\lambda_{2}$.\n- Method: Direct boundary element method (BEM) with collocation at the center of each strip. The center of the upper strip is $\\mathbf{r}_1 = (0, +h)$. The center of the lower strip is $\\mathbf{r}_2 = (0,-h)$.\n- Fundamental Solution: The 2D free-space Green's function for the Laplace equation is given as $G(\\mathbf{r}) = -\\frac{1}{2\\pi}\\,\\ln\\left(\\frac{|\\mathbf{r}|}{L_{0}}\\right)$, where $L_{0} > 0$ is a reference length.\n- Objective:\n  1. Formulate the $2 \\times 2$ linear system for nodal potentials.\n  2. Evaluate matrix entries analytically.\n  3. Solve for $\\lambda_{1}$ and $\\lambda_{2}$.\n  4. Compute capacitance per unit out-of-plane depth, $C' = Q'/V_{0}$, where the total charge per unit depth on the upper strip is $Q' = \\int_{-a}^{a} \\lambda_{1}\\,\\mathrm{d}x = 2a\\,\\lambda_{1}$.\n  5. The final answer for $C'$ must be a closed-form expression in terms of $\\varepsilon$, $a$, and $h$.\n\nStep 2: Validate Using Extracted Givens.\n- Scientific Grounding: The problem is formulated within the established framework of two-dimensional electrostatics and the Boundary Element Method. The provided fundamental solution is correct for the 2D Laplace equation, and its use for calculating potential from a source distribution is standard.\n- Well-Posedness: The problem is well-posed. It provides all necessary information (geometry, boundary conditions, physical properties, and a simplified model) to determine a unique value for the capacitance within the constraints of the specified model.\n- Objectivity: The problem is stated using precise, objective, and standard scientific terminology.\n- Flaw Checklist: The problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, feasible, well-structured, and verifiable. The employed model (single constant element per strip) is a standard coarse-grid approximation in BEM.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid. A rigorous solution will now be developed.\n\nThe potential $\\phi(\\mathbf{r})$ at a field point $\\mathbf{r}=(x,y)$ generated by a line charge distribution $\\lambda(\\mathbf{r}')$ along a contour $\\Gamma$ in a medium of permittivity $\\varepsilon$ is given by the single-layer potential integral:\n$$ \\phi(\\mathbf{r}) \\;=\\; \\int_{\\Gamma} \\frac{\\lambda(\\mathbf{r}')}{\\varepsilon} G(\\mathbf{r} - \\mathbf{r}') \\,\\mathrm{d}\\Gamma' $$\nIn this problem, the contour $\\Gamma$ is composed of two disjoint strips, $\\Gamma_1$ (upper) and $\\Gamma_2$ (lower). The charge densities are constant on each strip: $\\lambda(\\mathbf{r}')=\\lambda_1$ for $\\mathbf{r}' \\in \\Gamma_1$ and $\\lambda(\\mathbf{r}')=\\lambda_2$ for $\\mathbf{r}' \\in \\Gamma_2$.\nThe potential at any point $\\mathbf{r}$ is the superposition of the potentials from both strips:\n$$ \\phi(\\mathbf{r}) \\;=\\; \\frac{\\lambda_1}{\\varepsilon} \\int_{\\Gamma_1} G(\\mathbf{r} - \\mathbf{r}') \\,\\mathrm{d}x' + \\frac{\\lambda_2}{\\varepsilon} \\int_{\\Gamma_2} G(\\mathbf{r} - \\mathbf{r}') \\,\\mathrm{d}x' $$\nwhere $\\Gamma_1$ is the segment from $(-a, h)$ to $(a, h)$ and $\\Gamma_2$ is the segment from $(-a, -h)$ to $(a, -h)$.\n\nWe apply the given boundary conditions at the collocation points, which are the centers of the strips: $\\mathbf{r}_1=(0, h)$ for the upper strip and $\\mathbf{r}_2=(0, -h)$ for the lower strip.\n$$ \\phi(\\mathbf{r}_1) = +\\frac{V_0}{2} \\quad \\text{and} \\quad \\phi(\\mathbf{r}_2) = -\\frac{V_0}{2} $$\nThis leads to a $2 \\times 2$ system of linear equations for the unknown charge densities $\\lambda_1$ and $\\lambda_2$:\n$$ \\begin{pmatrix} M_{11} & M_{12} \\\\ M_{21} & M_{22} \\end{pmatrix} \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\end{pmatrix} = \\begin{pmatrix} +V_0/2 \\\\ -V_0/2 \\end{pmatrix} $$\nThe matrix entries $M_{ij}$ represent the potential at collocation point $\\mathbf{r}_i$ due to a unit charge density on strip $j$, multiplied by $1/\\varepsilon$.\n$$ M_{ij} = \\frac{1}{\\varepsilon} \\int_{\\Gamma_j} G(\\mathbf{r}_i - \\mathbf{r}') \\,\\mathrm{d}x' $$\n\nWe now evaluate the matrix entries analytically.\nFor $M_{11}$, the potential at $\\mathbf{r}_1=(0,h)$ from a unit charge on $\\Gamma_1$:\n$$ M_{11} = \\frac{1}{\\varepsilon} \\int_{-a}^{a} G((0,h) - (x',h)) \\,\\mathrm{d}x' = \\frac{1}{\\varepsilon} \\int_{-a}^{a} -\\frac{1}{2\\pi} \\ln\\left(\\frac{|-x'|}{L_0}\\right) \\,\\mathrm{d}x' $$\n$$ M_{11} = -\\frac{1}{2\\pi\\varepsilon} \\cdot 2 \\int_{0}^{a} \\ln\\left(\\frac{x'}{L_0}\\right) \\,\\mathrm{d}x' = -\\frac{1}{\\pi\\varepsilon} \\left[ x'\\ln\\left(\\frac{x'}{L_0}\\right) - x' \\right]_0^a $$\nUsing the fact that $\\lim_{x' \\to 0^+} x'\\ln(x') = 0$, we get:\n$$ M_{11} = -\\frac{1}{\\pi\\varepsilon} \\left( a\\ln\\left(\\frac{a}{L_0}\\right) - a \\right) = -\\frac{a}{\\pi\\varepsilon} \\left(\\ln\\left(\\frac{a}{L_0}\\right) - 1\\right) $$\nBy symmetry of the geometry, $M_{22} = M_{11}$.\n\nFor $M_{12}$, the potential at $\\mathbf{r}_1=(0,h)$ from a unit charge on $\\Gamma_2$:\n$$ M_{12} = \\frac{1}{\\varepsilon} \\int_{-a}^{a} G((0,h) - (x',-h)) \\,\\mathrm{d}x' = \\frac{1}{\\varepsilon} \\int_{-a}^{a} -\\frac{1}{2\\pi} \\ln\\left(\\frac{\\sqrt{x'^2 + (2h)^2}}{L_0}\\right) \\,\\mathrm{d}x' $$\n$$ M_{12} = -\\frac{1}{2\\pi\\varepsilon} \\int_{-a}^{a} \\left(\\frac{1}{2}\\ln(x'^2 + 4h^2) - \\ln(L_0)\\right) \\,\\mathrm{d}x' $$\nThe integral of $\\ln(x^2+c^2)$ is $x\\ln(x^2+c^2) - 2x + 2c\\arctan(x/c)$.\n$$ \\int_{-a}^{a} \\ln(x'^2+4h^2) \\,\\mathrm{d}x' = \\left[ x'\\ln(x'^2+4h^2) - 2x' + 4h\\arctan\\left(\\frac{x'}{2h}\\right) \\right]_{-a}^{a} $$\n$$ = 2a\\ln(a^2+4h^2) - 4a + 8h\\arctan\\left(\\frac{a}{2h}\\right) $$\nSubstituting this back into the expression for $M_{12}$:\n$$ M_{12} = -\\frac{1}{2\\pi\\varepsilon} \\left[ \\frac{1}{2}\\left(2a\\ln(a^2+4h^2) - 4a + 8h\\arctan\\left(\\frac{a}{2h}\\right)\\right) - 2a\\ln(L_0) \\right] $$\n$$ M_{12} = -\\frac{a}{\\pi\\varepsilon} \\left[ \\frac{1}{2}\\ln(a^2+4h^2) - 1 + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) - \\ln(L_0) \\right] $$\n$$ M_{12} = -\\frac{a}{\\pi\\varepsilon} \\left[ \\ln\\left(\\frac{\\sqrt{a^2+4h^2}}{L_0}\\right) - 1 + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) \\right] $$\nBy symmetry, $M_{21} = M_{12}$.\n\nThe system of equations is:\n$$ M_{11} \\lambda_1 + M_{12} \\lambda_2 = +\\frac{V_0}{2} $$\n$$ M_{12} \\lambda_1 + M_{11} \\lambda_2 = -\\frac{V_0}{2} $$\nAdding these two equations gives $(M_{11}+M_{12})(\\lambda_1+\\lambda_2)=0$. Since $M_{11}+M_{12} \\neq 0$ for any physical geometry, we must have $\\lambda_2 = -\\lambda_1$.\nSubstituting this into the first equation:\n$$ (M_{11} - M_{12})\\lambda_1 = \\frac{V_0}{2} \\implies \\lambda_1 = \\frac{V_0}{2(M_{11} - M_{12})} $$\nWe compute the difference $M_{11}-M_{12}$:\n$$ M_{11} - M_{12} = -\\frac{a}{\\pi\\varepsilon} \\left[ \\left(\\ln\\left(\\frac{a}{L_0}\\right) - 1\\right) - \\left(\\ln\\left(\\frac{\\sqrt{a^2+4h^2}}{L_0}\\right) - 1 + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right)\\right) \\right] $$\n$$ = -\\frac{a}{\\pi\\varepsilon} \\left[ \\ln(a) - \\ln(L_0) - \\ln(\\sqrt{a^2+4h^2}) + \\ln(L_0) - \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) \\right] $$\nThe arbitrary length $L_0$ cancels out, as it must for a physical quantity.\n$$ M_{11} - M_{12} = -\\frac{a}{\\pi\\varepsilon} \\left[ \\ln\\left(\\frac{a}{\\sqrt{a^2+4h^2}}\\right) - \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) \\right] $$\n$$ = \\frac{a}{\\pi\\varepsilon} \\left[ \\ln\\left(\\frac{\\sqrt{a^2+4h^2}}{a}\\right) + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) \\right] $$\n$$ = \\frac{a}{\\pi\\varepsilon} \\left[ \\frac{1}{2}\\ln\\left(1+\\frac{4h^2}{a^2}\\right) + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) \\right] $$\nNow we find $\\lambda_1$:\n$$ \\lambda_1 = \\frac{V_0}{2} \\left( \\frac{\\pi\\varepsilon}{a \\left[ \\frac{1}{2}\\ln\\left(1+\\frac{4h^2}{a^2}\\right) + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) \\right]} \\right) $$\nThe capacitance per unit depth is $C' = Q'/V_0 = 2a\\lambda_1/V_0$.\n$$ C' = \\frac{2a}{V_0} \\lambda_1 = \\frac{a}{V_0} \\frac{V_0 \\pi\\varepsilon}{a \\left[ \\frac{1}{2}\\ln\\left(1+\\frac{4h^2}{a^2}\\right) + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right) \\right]} $$\n$$ C' = \\frac{\\pi\\varepsilon}{\\frac{1}{2}\\ln\\left(1+\\frac{4h^2}{a^2}\\right) + \\frac{2h}{a}\\arctan\\left(\\frac{a}{2h}\\right)} $$\nMultiplying numerator and denominator by $2$ to simplify the expression yields the final result.\n$$ C' = \\frac{2\\pi\\varepsilon}{\\ln\\left(1+\\frac{4h^2}{a^2}\\right) + \\frac{4h}{a}\\arctan\\left(\\frac{a}{2h}\\right)} $$\nThis expression gives the capacitance per unit depth in Farads per meter, depending only on $\\varepsilon$, $a$, and $h$, as required.\nThe result can be verified in the limit of an ideal parallel-plate capacitor where $a \\gg h$. Let $z=2h/a \\ll 1$. The denominator becomes $\\ln(1+z^2) + 2z \\arctan(1/z) \\approx z^2 + 2z(\\pi/2 - z) = \\pi z - z^2 \\approx \\pi z = 2\\pi h/a$.\nThus, $C' \\approx \\frac{2\\pi\\varepsilon}{2\\pi h/a} = \\varepsilon\\frac{a}{h}$, which is the correct formula for capacitance per unit depth of two parallel plates of width $2a$ and separation $2h$, neglecting fringing fields. The obtained formula correctly includes the fringing effects within the approximations of the model.", "answer": "$$\n\\boxed{\\frac{2\\pi\\varepsilon}{\\ln\\left(1+\\frac{4h^2}{a^2}\\right) + \\frac{4h}{a}\\arctan\\left(\\frac{a}{2h}\\right)}}\n$$", "id": "2374801"}, {"introduction": "Having seen BEM in a simple open-domain context, we now tackle a classic interior problem: solving for the potential inside a square with given boundary conditions [@problem_id:2374819]. This exercise requires you to assemble the full BEM system, constructing both the influence matrix $G$ and the geometry-dependent matrix $H$ by analytically integrating the Green's function and its normal derivative. Solving this $4 \\times 4$ system provides essential practice in setting up and solving the matrix equations that form the core of any BEM code.", "problem": "Consider the interior boundary value problem for Laplace’s equation in two dimensions ($2$D) on the unit square domain $\\Omega = (0,1)\\times(0,1)$ with boundary $\\Gamma = \\partial\\Omega$. Let $u$ denote the potential, and let $q = \\partial u/\\partial n$ denote the outward normal flux. Use the direct boundary integral equation for the Laplace operator with the two-dimensional free-space Green’s function\n$$\nG(\\mathbf{x},\\mathbf{y}) \\;=\\; -\\frac{1}{2\\pi}\\,\\ln|\\mathbf{x}-\\mathbf{y}|\\;,\n$$\nand adopt the standard interior convention $c(\\mathbf{x}) = \\tfrac{1}{2}$ at smooth boundary points $\\mathbf{x}\\in\\Gamma$. Discretize the boundary with one straight constant-strength element per side (four elements total), with collocation at each element’s midpoint. Index the elements as follows:\n- $\\Gamma_{1}:\\ \\{(s,0)\\,|\\,0\\le s\\le 1\\}$ with outward normal $\\mathbf{n}_{1}=(0,-1)$,\n- $\\Gamma_{2}:\\ \\{(1,s)\\,|\\,0\\le s\\le 1\\}$ with outward normal $\\mathbf{n}_{2}=(1,0)$,\n- $\\Gamma_{3}:\\ \\{(s,1)\\,|\\,0\\le s\\le 1\\}$ with outward normal $\\mathbf{n}_{3}=(0,1)$,\n- $\\Gamma_{4}:\\ \\{(0,s)\\,|\\,0\\le s\\le 1\\}$ with outward normal $\\mathbf{n}_{4}=(-1,0)$,\nand collocation points\n$$\n\\mathbf{x}_{1}=(\\tfrac{1}{2},0),\\quad \\mathbf{x}_{2}=(1,\\tfrac{1}{2}),\\quad \\mathbf{x}_{3}=(\\tfrac{1}{2},1),\\quad \\mathbf{x}_{4}=(0,\\tfrac{1}{2}).\n$$\nImpose Dirichlet data\n$$\nu=0\\ \\text{on}\\ \\Gamma_{1}\\cup\\Gamma_{4},\\qquad u=1\\ \\text{on}\\ \\Gamma_{2}\\cup\\Gamma_{3}.\n$$\nWith piecewise-constant $u$ and $q$ per element and collocation at the midpoints, assemble the resulting $4\\times 4$ linear system from first principles by evaluating the required boundary integrals exactly. Then solve the system for the four unknown element-constant outward fluxes $\\{q_{j}\\}_{j=1}^{4}$. Use principal values of inverse trigonometric functions in radians, and express your final result exactly (no numerical rounding) as a row matrix $(q_{1}\\ q_{2}\\ q_{3}\\ q_{4})$.", "solution": "The problem posed is a well-defined boundary value problem for the two-dimensional Laplace equation, to be solved using a direct boundary element method. All required data, including the geometry, boundary conditions, and discretization scheme, are provided. The problem is scientifically grounded, self-contained, and objective. It is therefore deemed valid and a solution will be provided.\n\nThe direct boundary integral equation (BIE) for an interior potential problem governed by Laplace's equation is given by\n$$c(\\mathbf{x}) u(\\mathbf{x}) + \\int_{\\Gamma} u(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n_y} \\, d\\Gamma_y = \\int_{\\Gamma} q(\\mathbf{y}) G(\\mathbf{x}, \\mathbf{y}) \\, d\\Gamma_y$$\nwhere $\\mathbf{x}$ is a point on the boundary $\\Gamma$, $c(\\mathbf{x})$ is the solid angle coefficient, $u$ is the potential, $q = \\partial u/\\partial n$ is the normal flux, and $G(\\mathbf{x},\\mathbf{y})$ is the free-space Green's function. For this problem, $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$. The normal derivative of the Green's function is $\\frac{\\partial G}{\\partial n_y} = \\nabla_y G \\cdot \\mathbf{n}_y = -\\frac{1}{2\\pi} \\frac{(\\mathbf{y}-\\mathbf{x})\\cdot\\mathbf{n}_y}{|\\mathbf{y}-\\mathbf{x}|^2}$.\n\nThe boundary $\\Gamma$ is discretized into four constant-strength elements $\\Gamma_j$, with $j=1,2,3,4$. The potential $u$ and flux $q$ are assumed to be piecewise constant, $u_j$ and $q_j$, on each element $\\Gamma_j$. Applying the BIE at the mid-point $\\mathbf{x}_i$ of each element $\\Gamma_i$ yields a system of linear algebraic equations. Since the collocation points are at the midpoints of straight line segments, they are smooth points on the boundary, so $c(\\mathbf{x}_i) = 1/2$ for all $i$. The discretized BIE is:\n$$\\frac{1}{2} u_i + \\sum_{j=1}^{4} u_j \\left( \\int_{\\Gamma_j} \\frac{\\partial G(\\mathbf{x}_i, \\mathbf{y})}{\\partial n_y} \\, d\\Gamma_y \\right) = \\sum_{j=1}^{4} q_j \\left( \\int_{\\Gamma_j} G(\\mathbf{x}_i, \\mathbf{y}) \\, d\\Gamma_y \\right)$$\nThis can be written in matrix form as $(\\mathbf{H} + \\frac{1}{2}\\mathbf{I})\\mathbf{u} = \\mathbf{G}\\mathbf{q}$, where the matrix entries are given by:\n$$H_{ij} = \\int_{\\Gamma_j} \\frac{\\partial G(\\mathbf{x}_i, \\mathbf{y})}{\\partial n_y} \\, d\\Gamma_y \\quad \\text{and} \\quad G_{ij} = \\int_{\\Gamma_j} G(\\mathbf{x}_i, \\mathbf{y}) \\, d\\Gamma_y$$\nThe knowns are the potentials on each element, given by the Dirichlet boundary conditions: $u_1 = 0$, $u_2 = 1$, $u_3 = 1$, $u_4 = 0$. The vector of potentials is $\\mathbf{u} = (0, 1, 1, 0)^T$. The unknowns are the fluxes $\\mathbf{q} = (q_1, q_2, q_3, q_4)^T$.\n\nWe must now evaluate the matrix coefficients $H_{ij}$ and $G_{ij}$.\nDue to the square geometry and the choice of collocation points, the matrices $\\mathbf{H}$ and $\\mathbf{G}$ will exhibit a symmetric structure. We will have diagonal elements ($i=j$), adjacent elements (e.g., $i=1, j=2$), and opposite elements ($i=1, j=3$).\n\nCalculation of $H_{ij}$:\nFor a straight element, the vector $\\mathbf{y}-\\mathbf{x}_i$ is tangential to the element $\\Gamma_i$ when $i=j$. The normal vector $\\mathbf{n}_i$ is orthogonal to the element. Thus, $(\\mathbf{y}-\\mathbf{x}_i) \\cdot \\mathbf{n}_i = 0$, which implies $H_{ii} = 0$ for all $i=1,2,3,4$.\nFor off-diagonal elements, we compute the integrals. Let's compute the first row ($i=1$, with $\\mathbf{x}_1 = (1/2, 0)$).\n$H_{12}$: Integration over $\\Gamma_2$, where $\\mathbf{y}=(1,s)$ for $s\\in[0,1]$ and $\\mathbf{n}_2=(1,0)$.\n$H_{12} = -\\frac{1}{2\\pi} \\int_0^1 \\frac{((1,s)-(1/2,0))\\cdot(1,0)}{|(1,s)-(1/2,0)|^2} ds = -\\frac{1}{2\\pi} \\int_0^1 \\frac{1/2}{(1/2)^2+s^2} ds = -\\frac{1}{4\\pi} \\left[2\\arctan(2s)\\right]_0^1 = -\\frac{\\arctan(2)}{2\\pi}$.\n$H_{14}$: Integration over $\\Gamma_4$, where $\\mathbf{y}=(0,s)$ for $s\\in[0,1]$ and $\\mathbf{n}_4=(-1,0)$.\n$H_{14} = -\\frac{1}{2\\pi} \\int_0^1 \\frac{((0,s)-(1/2,0))\\cdot(-1,0)}{|(0,s)-(1/2,0)|^2} ds = -\\frac{1}{2\\pi} \\int_0^1 \\frac{1/2}{(-1/2)^2+s^2} ds = H_{12} = -\\frac{\\arctan(2)}{2\\pi}$.\n$H_{13}$: Integration over $\\Gamma_3$, where $\\mathbf{y}=(s,1)$ for $s\\in[0,1]$ and $\\mathbf{n}_3=(0,1)$.\n$H_{13} = -\\frac{1}{2\\pi} \\int_0^1 \\frac{((s,1)-(1/2,0))\\cdot(0,1)}{|(s,1)-(1/2,0)|^2} ds = -\\frac{1}{2\\pi} \\int_0^1 \\frac{1}{(s-1/2)^2+1^2} ds = -\\frac{1}{2\\pi} \\left[\\arctan(s-1/2)\\right]_0^1 = -\\frac{1}{2\\pi}(\\arctan(1/2)-\\arctan(-1/2)) = -\\frac{\\arctan(1/2)}{\\pi}$.\nBy symmetry, let $h_a = H_{12} = H_{14} = H_{21} = \\dots = -\\frac{\\arctan(2)}{2\\pi}$ and $h_o = H_{13} = H_{31} = \\dots = -\\frac{\\arctan(1/2)}{\\pi}$.\nThe matrix $\\mathbf{H}$ is:\n$\\mathbf{H} = \\begin{pmatrix} 0 & h_a & h_o & h_a \\\\ h_a & 0 & h_a & h_o \\\\ h_o & h_a & 0 & h_a \\\\ h_a & h_o & h_a & 0 \\end{pmatrix}$.\nNote that the sum of each row is $2h_a+h_o = -\\frac{\\arctan(2)}{\\pi} - \\frac{\\arctan(1/2)}{\\pi} = -\\frac{1}{\\pi}(\\arctan(2)+\\arctan(1/2)) = -\\frac{1}{\\pi}(\\frac{\\pi}{2}) = -1/2$, which satisfies the sum rule $\\sum_j H_{ij} = -c(\\mathbf{x}_i)$.\n\nCalculation of $G_{ij}$:\nWe use the general integral formula: $\\int \\ln(t^2+c^2)dt = t\\ln(t^2+c^2) - 2t + 2c\\arctan(t/c)$.\n$G_{11}$: Integration over $\\Gamma_1$, where $\\mathbf{y}=(s,0)$ for $s\\in[0,1]$.\n$G_{11} = -\\frac{1}{2\\pi}\\int_0^1 \\ln|s-1/2| ds = -\\frac{1}{2\\pi} (2 \\int_0^{1/2} \\ln(t) dt) = -\\frac{1}{\\pi}[t\\ln t - t]_0^{1/2} = -\\frac{1}{\\pi}(\\frac{1}{2}\\ln(1/2)-\\frac{1}{2}) = \\frac{1+\\ln 2}{2\\pi}$.\n$G_{12}$: Integration over $\\Gamma_2$, $\\mathbf{y}=(1,s)$, $s\\in[0,1]$.\n$G_{12} = -\\frac{1}{2\\pi} \\int_0^1 \\ln\\sqrt{(1/2)^2+s^2} ds = -\\frac{1}{4\\pi}\\int_0^1 \\ln(s^2+(1/2)^2) ds = -\\frac{1}{4\\pi}[s\\ln(s^2+1/4)-2s+\\arctan(2s)]_0^1 = -\\frac{1}{4\\pi}(\\ln(5/4)-2+\\arctan(2)) = \\frac{2-\\ln(5/4)-\\arctan(2)}{4\\pi}$.\n$G_{13}$: Integration over $\\Gamma_3$, $\\mathbf{y}=(s,1)$, $s\\in[0,1]$.\n$G_{13} = -\\frac{1}{2\\pi} \\int_0^1 \\ln\\sqrt{(s-1/2)^2+1^2} ds = -\\frac{1}{4\\pi}\\int_{-1/2}^{1/2} \\ln(t^2+1) dt = -\\frac{2}{4\\pi}\\int_0^{1/2} \\ln(t^2+1) dt = -\\frac{1}{2\\pi}[t\\ln(t^2+1)-2t+2\\arctan(t)]_0^{1/2} = -\\frac{1}{2\\pi}(\\frac{1}{2}\\ln(5/4)-1+2\\arctan(1/2)) = \\frac{1-\\frac{1}{2}\\ln(5/4)-2\\arctan(1/2)}{2\\pi}$.\nBy symmetry, let $g_d = G_{11} = G_{22} = \\dots = \\frac{1+\\ln 2}{2\\pi}$, $g_a = G_{12} = G_{14} = \\dots = \\frac{2-\\ln(5/4)-\\arctan(2)}{4\\pi}$, and $g_o = G_{13} = G_{31} = \\dots = \\frac{2-\\ln(5/4)-4\\arctan(1/2)}{4\\pi}$.\nThe matrix $\\mathbf{G}$ is:\n$\\mathbf{G} = \\begin{pmatrix} g_d & g_a & g_o & g_a \\\\ g_a & g_d & g_a & g_o \\\\ g_o & g_a & g_d & g_a \\\\ g_a & g_o & g_a & g_d \\end{pmatrix}$.\n\nNow we assemble and solve the system $\\mathbf{G}\\mathbf{q}=\\mathbf{v}$, where $\\mathbf{v} = (\\mathbf{H} + \\frac{1}{2}\\mathbf{I})\\mathbf{u}$.\nWith $\\mathbf{u}=(0,1,1,0)^T$:\n$v_1 = \\frac{1}{2}u_1 + H_{12}u_2 + H_{13}u_3 + H_{14}u_4 = h_a(1) + h_o(1) = h_a+h_o$.\n$v_2 = H_{21}u_1 + \\frac{1}{2}u_2 + H_{23}u_3 + H_{24}u_4 = \\frac{1}{2}(1) + h_a(1) = 1/2+h_a$.\n$v_3 = H_{31}u_1 + H_{32}u_2 + \\frac{1}{2}u_3 + H_{34}u_4 = h_a(1) + \\frac{1}{2}(1) = 1/2+h_a$.\n$v_4 = H_{41}u_1 + H_{42}u_2 + H_{43}u_3 + \\frac{1}{2}u_4 = h_o(1) + h_a(1) = h_a+h_o$.\nSo, $\\mathbf{v} = (h_a+h_o, 1/2+h_a, 1/2+h_a, h_a+h_o)^T$.\n\nThe problem has reflectional symmetry about the line $y=x$. The boundary conditions respect this symmetry. Therefore, the solution for the fluxes must also be symmetric: $q_1=q_4$ and $q_2=q_3$. Let $q_1=q_4=A$ and $q_2=q_3=B$. The $4 \\times 4$ system reduces to a $2 \\times 2$ system:\n\\begin{align*} (g_d+g_a)A + (g_a+g_o)B &= h_a+h_o \\\\ (g_a+g_o)A + (g_d+g_a)B &= 1/2+h_a \\end{align*}\nSubtracting the two equations gives:\n$((g_d+g_a)-(g_a+g_o))A + ((g_a+g_o)-(g_d+g_a))B = (h_a+h_o)-(1/2+h_a)$\n$(g_d-g_o)A - (g_d-g_o)B = h_o-1/2$\n$(g_d-g_o)(A-B) = h_o-1/2$.\nAdding the two equations gives:\n$((g_d+g_a)+(g_a+g_o))(A+B) = (h_a+h_o) + (1/2+h_a)$\n$(g_d+2g_a+g_o)(A+B) = 1/2+2h_a+h_o$.\nSince $2h_a+h_o = -1/2$, the right side is $0$. The sum $g_d+2g_a+g_o$ is non-zero, hence we must have $A+B=0$, so $B=-A$. This is consistent with the physical requirement that the total flux out of the source-free domain is zero: $\\sum q_j L_j = q_1(1)+q_2(1)+q_3(1)+q_4(1) = A+B+B+A = 2(A+B)=0$.\nSubstituting $B=-A$ into the first equation of the $2 \\times 2$ system:\n$(g_d+g_a)A - (g_a+g_o)A = h_a+h_o$\n$(g_d-g_o)A = h_a+h_o \\implies A = \\frac{h_a+h_o}{g_d-g_o}$.\nWe compute the numerator and denominator.\n$h_a+h_o = -\\frac{\\arctan(2)}{2\\pi} - \\frac{\\arctan(1/2)}{\\pi} = -\\frac{1}{2\\pi}(\\arctan(2)+2\\arctan(1/2))$. Using the identity $\\arctan(2)+\\arctan(1/2)=\\pi/2$, so $\\arctan(2)=\\pi/2-\\arctan(1/2)$, we get:\n$h_a+h_o = -\\frac{1}{2\\pi}(\\pi/2 - \\arctan(1/2) + 2\\arctan(1/2)) = -\\frac{1}{2\\pi}(\\frac{\\pi}{2}+\\arctan(1/2))$.\nFor the denominator:\n$g_d=\\frac{1+\\ln 2}{2\\pi}$ and $g_o=\\frac{2-\\ln(5/4)-4\\arctan(1/2)}{4\\pi}=\\frac{1-\\frac{1}{2}(\\ln 5 - 2\\ln 2)-2\\arctan(1/2)}{2\\pi}$.\n$g_d-g_o = \\frac{1}{2\\pi}[(1+\\ln 2) - (1-\\frac{1}{2}\\ln 5 + \\ln 2-2\\arctan(1/2))] = \\frac{1}{2\\pi}(\\frac{1}{2}\\ln 5 + 2\\arctan(1/2))$.\nThus,\n$A = \\frac{-\\frac{1}{2\\pi}(\\frac{\\pi}{2}+\\arctan(1/2))}{\\frac{1}{2\\pi}(\\frac{1}{2}\\ln 5+2\\arctan(1/2))} = -\\frac{\\frac{\\pi}{2}+\\arctan(1/2)}{\\frac{1}{2}\\ln 5+2\\arctan(1/2)}$.\nThe fluxes are then:\n$q_1=q_4=A = -\\frac{\\pi/2+\\arctan(1/2)}{1/2\\ln 5+2\\arctan(1/2)}$\n$q_2=q_3=B=-A = \\frac{\\pi/2+\\arctan(1/2)}{1/2\\ln 5+2\\arctan(1/2)}$.\n\nThe final result is the row matrix $(q_1 \\ q_2 \\ q_3 \\ q_4)$.\nLet the constant $C = \\frac{\\frac{\\pi}{2}+\\arctan(\\frac{1}{2})}{\\frac{1}{2}\\ln 5+2\\arctan(\\frac{1}{2})} = \\frac{\\pi+2\\arctan(\\frac{1}{2})}{\\ln 5+4\\arctan(\\frac{1}{2})}$.\nThen $q_1 = -C$, $q_2 = C$, $q_3 = C$, $q_4 = -C$.\nThe final answer is presented below.", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{\\pi+2\\arctan(\\frac{1}{2})}{\\ln 5+4\\arctan(\\frac{1}{2})} & \\frac{\\pi+2\\arctan(\\frac{1}{2})}{\\ln 5+4\\arctan(\\frac{1}{2})} & \\frac{\\pi+2\\arctan(\\frac{1}{2})}{\\ln 5+4\\arctan(\\frac{1}{2})} & -\\frac{\\pi+2\\arctan(\\frac{1}{2})}{\\ln 5+4\\arctan(\\frac{1}{2})} \\end{pmatrix} } $$", "id": "2374819"}, {"introduction": "While BEM is elegant, direct application leads to dense matrices and a computational cost that scales as $\\mathcal{O}(N^2)$, making large problems intractable. The Fast Multipole Method (FMM) revolutionizes BEM by reducing this complexity to nearly linear time. This theoretical practice guides you through an analysis of FMM's computational cost, helping you understand how its hierarchical structure and series expansions lead to this remarkable efficiency [@problem_id:2374839]. By breaking the algorithm into its key stages, you will derive the $\\mathcal{O}(N)$ scaling that makes FMM-accelerated BEM a powerhouse for large-scale simulations.", "problem": "Consider the evaluation of a single-layer potential arising in a Boundary Element Method (BEM) for the Laplace equation in two spatial dimensions. All source points lie on the line segment $\\{(x,0): 0 \\le x \\le 1\\}$, and all target points lie on the parallel line segment $\\{(x,d): 0 \\le x \\le 1\\}$, where $d>0$ is fixed. There are $N$ sources and $N$ targets, both uniformly distributed along their respective segments. The kernel is the free-space Green’s function for the Laplace equation in two spatial dimensions, $G(\\mathbf{r}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{r}|$.\n\nSuppose the evaluation of the potential at the $N$ targets is accelerated by a Fast Multipole Method (FMM). The FMM uses a dyadic hierarchical partition (branching factor $2$) of each segment into boxes down to leaves that contain at most $n_{0}$ points, where $n_{0}$ is fixed and independent of $N$. The multipole and local expansions are truncated at order $p$, chosen to meet a prescribed accuracy $\\varepsilon$, with $p$ independent of $N$ because $d$ is fixed. Assume the separation $d$ is strictly larger than the maximum leaf-box width so that no direct particle-to-particle near-field evaluations are performed between sources and targets; all interactions are mediated by expansions. For the cost model, assume:\n- A source-to-multipole (S2M) operation for one source in a leaf box costs $c_{\\mathrm{S2M}}\\,p$.\n- A multipole-to-multipole (M2M) translation for one box costs $c_{\\mathrm{M2M}}\\,p^{2}$.\n- A multipole-to-local (M2L) translation for one well-separated source–target box pair costs $c_{\\mathrm{M2L}}\\,p^{2}$.\n- A local-to-local (L2L) translation for one box costs $c_{\\mathrm{L2L}}\\,p^{2}$.\n- A local-to-target (L2T) evaluation for one target costs $c_{\\mathrm{L2T}}\\,p$.\n\nAssume there exists a level-independent constant $q$ such that, at any level of the hierarchy, the well-separated interaction list of any target box contains at most $q$ source boxes. All constants $c_{\\mathrm{S2M}}$, $c_{\\mathrm{M2M}}$, $c_{\\mathrm{M2L}}$, $c_{\\mathrm{L2L}}$, $c_{\\mathrm{L2T}}$, $n_{0}$, $p$, $q$, and $d$ are positive and independent of $N$.\n\nAs $N \\to \\infty$, let $T(N)$ denote the total arithmetic work of the FMM under this model. Determine the exponent $\\alpha$ such that $T(N) = \\Theta(N^{\\alpha})$. Provide the value of $\\alpha$ as a real number. No rounding is required.", "solution": "The user has provided a problem concerning the computational complexity of the Fast Multipole Method (FMM) applied to a specific one-dimensional particle distribution embedded in a two-dimensional space. I must first validate the problem statement and then, if it is valid, provide a rigorous derivation of the solution.\n\n### Step 1: Extract Givens\n- **System**: $N$ source points and $N$ target points.\n- **Source Domain**: Line segment $\\{(x,0): 0 \\le x \\le 1\\}$, uniformly distributed.\n- **Target Domain**: Line segment $\\{(x,d): 0 \\le x \\le 1\\}$, uniformly distributed, with $d>0$.\n- **Interaction Kernel**: $G(\\mathbf{r}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{r}|$, the 2D Laplacian Green's function.\n- **FMM Hierarchy**: Dyadic partitioning (branching factor $2$) of the 1D segments.\n- **Leaf Box Criterion**: Maximum of $n_{0}$ points per leaf box, where $n_{0}$ is a constant.\n- **Expansion Order**: Constant integer $p$, independent of $N$.\n- **Interaction Condition**: No direct near-field interactions; all interactions are handled by expansions.\n- **Interaction List**: Any target box at any level interacts with at most $q$ source boxes, where $q$ is a constant.\n- **Cost Model**:\n    - S2M (per source): $c_{\\mathrm{S2M}}\\,p$\n    - M2M (per box): $c_{\\mathrm{M2M}}\\,p^{2}$\n    - M2L (per well-separated pair): $c_{\\mathrm{M2L}}\\,p^{2}$\n    - L2L (per box): $c_{\\mathrm{L2L}}\\,p^{2}$\n    - L2T (per target): $c_{\\mathrm{L2T}}\\,p$\n- **Constants**: $c_{\\mathrm{S2M}}$, $c_{\\mathrm{M2M}}$, $c_{\\mathrm{M2L}}$, $c_{\\mathrm{L2L}}$, $c_{\\mathrm{L2T}}$, $n_{0}$, $p$, $q$, $d$ are all positive constants independent of $N$.\n- **Objective**: Determine the exponent $\\alpha$ in the total computational cost scaling law $T(N) = \\Theta(N^{\\alpha})$ as $N \\to \\infty$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the validation criteria.\n1.  **Scientifically Grounded**: The problem is a standard theoretical analysis of the FMM, a cornerstone algorithm in computational engineering and physics. The cost model is consistent with established literature on the 2D FMM. The problem is sound.\n2.  **Well-Posed**: The problem is clearly defined. It provides a complete cost model and asks for a specific, calculable quantity (the scaling exponent $\\alpha$). A unique solution is expected.\n3.  **Objective**: The problem is stated using precise, formal language common to the field of scientific computing. There is no subjectivity.\n\nThe problem does not exhibit any of the defined flaws. It is not scientifically unsound, non-formalizable, incomplete, contradictory, unrealistic, or ill-posed. It is a valid, well-structured problem in computational complexity theory.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Derivation of the Solution\nThe total computational work, $T(N)$, is the sum of the costs of the five stages of the FMM algorithm. We will analyze the cost of each stage as a function of $N$.\n\nFirst, we must characterize the hierarchical tree structure. The source and target points are distributed on line segments of length $1$. The point density is $\\rho = N/1 = N$. The domain is partitioned dyadically, meaning each box is split into $2$ child boxes. The number of boxes at level $l$ of the tree is $2^l$. The tree recursion stops at the leaf level, $L$, when the number of points in a box is approximately $n_{0}$. A box at level $l$ has length $2^{-l}$. The number of points in a box at level $L$ is $\\rho \\cdot 2^{-L} = N \\cdot 2^{-L}$. The leaf condition is $N \\cdot 2^{-L} \\lesssim n_{0}$, which implies $2^L \\gtrsim N/n_{0}$. The depth of the tree is therefore $L = \\Theta(\\log N)$.\n\nThe total number of boxes in the tree is the sum of boxes over all levels from $l=0$ to $l=L$:\n$$\n\\text{Total boxes} = \\sum_{l=0}^{L} 2^l = 2^{L+1} - 1 = \\Theta(2^L)\n$$\nSince $2^L = \\Theta(N)$, the total number of boxes in the tree is $\\Theta(N)$.\n\nNow, we analyze the cost of each FMM stage:\n\n1.  **S2M (Source-to-Multipole) Cost**: This operation is performed for each of the $N$ source points to form the multipole expansions in the leaf boxes.\n    - Cost per source is $c_{\\mathrm{S2M}}\\,p$.\n    - Total S2M cost: $T_{\\mathrm{S2M}} = N \\cdot (c_{\\mathrm{S2M}}\\,p)$.\n    - Since $c_{\\mathrm{S2M}}$ and $p$ are constants, $T_{\\mathrm{S2M}} = \\Theta(N)$.\n\n2.  **M2M (Multipole-to-Multipole) Cost**: This constitutes the upward pass of the FMM. At each level $l$ from $L-1$ down to $0$, the multipole expansion of each parent box is computed from the expansions of its children. This operation is performed once for every non-leaf box.\n    - Number of non-leaf boxes is $\\sum_{l=0}^{L-1} 2^l = 2^L-1 = \\Theta(N)$.\n    - Cost per M2M translation is $c_{\\mathrm{M2M}}\\,p^2$.\n    - Total M2M cost: $T_{\\mathrm{M2M}} = \\Theta(N) \\cdot (c_{\\mathrm{M2M}}\\,p^2) = \\Theta(N)$.\n\n3.  **M2L (Multipole-to-Local) Cost**: This is the translation of multipole expansions from well-separated source boxes to local expansions for target boxes. This occurs at every level of the tree.\n    - At any level $l$, there are $2^l$ target boxes.\n    - The problem states that the interaction list for any target box contains at most $q$ source boxes, where $q$ is a constant.\n    - The number of M2L translations at level $l$ is therefore at most $q \\cdot 2^l$.\n    - The cost per M2L translation is $c_{\\mathrm{M2L}}\\,p^2$.\n    - Total M2L cost is the sum over all levels $l=0, \\dots, L$:\n      $$\n      T_{\\mathrm{M2L}} = \\sum_{l=0}^{L} (\\text{Num. target boxes at level }l) \\cdot (\\text{Avg. interaction list size}) \\cdot (\\text{Cost per translation})\n      $$\n      $$\n      T_{\\mathrm{M2L}} \\leq \\sum_{l=0}^{L} (2^l \\cdot q \\cdot c_{\\mathrm{M2L}}\\,p^2) = (q \\cdot c_{\\mathrm{M2L}}\\,p^2) \\sum_{l=0}^{L} 2^l = (q \\cdot c_{\\mathrm{M2L}}\\,p^2) (2^{L+1}-1)\n      $$\n    - Since $p$, $q$, and $c_{\\mathrm{M2L}}$ are constants and $2^L = \\Theta(N)$, the total M2L cost is $T_{\\mathrm{M2L}} = \\Theta(N)$.\n\n4.  **L2L (Local-to-Local) Cost**: This constitutes the downward pass. At each level $l$ from $1$ to $L$, the local expansion for each box is computed from its parent's local expansion. This is performed for every non-root box.\n    - Number of non-root boxes is $\\sum_{l=1}^{L} 2^l = 2^{L+1}-2 = \\Theta(N)$.\n    - Cost per L2L translation is $c_{\\mathrm{L2L}}\\,p^2$.\n    - Total L2L cost: $T_{\\mathrm{L2L}} = \\Theta(N) \\cdot (c_{\\mathrm{L2L}}\\,p^2) = \\Theta(N)$.\n\n5.  **L2T (Local-to-Target) Cost**: This final operation evaluates the local expansion at each of the $N$ target point locations. This happens in the leaf boxes.\n    - Cost per target is $c_{\\mathrm{L2T}}\\,p$.\n    - Total L2T cost: $T_{\\mathrm{L2T}} = N \\cdot (c_{\\mathrm{L2T}}\\,p)$.\n    - As $c_{\\mathrm{L2T}}$ and $p$ are constants, $T_{\\mathrm{L2T}} = \\Theta(N)$.\n\nThe total computational work $T(N)$ is the sum of the costs of these five stages:\n$$\nT(N) = T_{\\mathrm{S2M}} + T_{\\mathrm{M2M}} + T_{\\mathrm{M2L}} + T_{\\mathrm{L2L}} + T_{\\mathrm{L2T}}\n$$\n$$\nT(N) = \\Theta(N) + \\Theta(N) + \\Theta(N) + \\Theta(N) + \\Theta(N) = \\Theta(N)\n$$\nThe problem specifies that the total work scales as $T(N) = \\Theta(N^{\\alpha})$. By comparing this with our derived result, we have:\n$$\n\\Theta(N^{\\alpha}) = \\Theta(N^1)\n$$\nThis implies that the exponent $\\alpha$ must be $1$.", "answer": "$$\\boxed{1}$$", "id": "2374839"}]}