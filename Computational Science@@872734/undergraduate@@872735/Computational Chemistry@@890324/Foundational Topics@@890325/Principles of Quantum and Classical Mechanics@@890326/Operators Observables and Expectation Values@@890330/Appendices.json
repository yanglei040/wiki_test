{"hands_on_practices": [{"introduction": "This first exercise provides direct practice with the fundamental definition of an expectation value. We will explore electron spin, a purely quantum mechanical property, and calculate the average value of its z-component for an electron in a superposition of spin-up and spin-down states. This problem reinforces the use of Dirac notation and illustrates how the expectation value represents a weighted average of the possible measurement outcomes [@problem_id:2459734].", "problem": "In computational chemistry, spin expectation values of electrons are required to evaluate spin populations and magnetic properties. Consider a single electron, modeled as a spin-$\\frac{1}{2}$ particle, with spin states in the standard $z$-quantization basis $\\{|\\uparrow\\rangle,|\\downarrow\\rangle\\}$. The spin operator $\\hat{S}_{z}$ acts on this basis according to the fundamental quantum mechanical relations $\\hat{S}_{z}|\\uparrow\\rangle=\\frac{\\hbar}{2}|\\uparrow\\rangle$ and $\\hat{S}_{z}|\\downarrow\\rangle=-\\frac{\\hbar}{2}|\\downarrow\\rangle$, and the basis is orthonormal with $\\langle\\uparrow|\\uparrow\\rangle=\\langle\\downarrow|\\downarrow\\rangle=1$ and $\\langle\\uparrow|\\downarrow\\rangle=\\langle\\downarrow|\\uparrow\\rangle=0$. Suppose the electron is prepared in the normalized spin state\n$$|\\alpha\\rangle=\\frac{1}{\\sqrt{3}}|\\uparrow\\rangle+\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle.$$\nCompute the expectation value $\\langle\\hat{S}_{z}\\rangle=\\langle\\alpha|\\hat{S}_{z}|\\alpha\\rangle$. Express your final answer as the dimensionless coefficient $c$ defined by $\\langle\\hat{S}_{z}\\rangle=c\\,\\hbar$. Give an exact value (no rounding).", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **System**: A single electron, treated as a spin-$\\frac{1}{2}$ particle.\n- **Basis**: Standard $z$-quantization basis $\\{|\\uparrow\\rangle,|\\downarrow\\rangle\\}$.\n- **Operator Definition**: The spin operator $\\hat{S}_{z}$ acts on the basis as follows:\n  - $\\hat{S}_{z}|\\uparrow\\rangle=\\frac{\\hbar}{2}|\\uparrow\\rangle$\n  - $\\hat{S}_{z}|\\downarrow\\rangle=-\\frac{\\hbar}{2}|\\downarrow\\rangle$\n- **Orthonormality Conditions**:\n  - $\\langle\\uparrow|\\uparrow\\rangle=1$\n  - $\\langle\\downarrow|\\downarrow\\rangle=1$\n  - $\\langle\\uparrow|\\downarrow\\rangle=0$\n  - $\\langle\\downarrow|\\uparrow\\rangle=0$\n- **State Vector**: The electron is in the normalized spin state $|\\alpha\\rangle=\\frac{1}{\\sqrt{3}}|\\uparrow\\rangle+\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle$.\n- **Objective**: Compute the expectation value $\\langle\\hat{S}_{z}\\rangle=\\langle\\alpha|\\hat{S}_{z}|\\alpha\\rangle$.\n- **Output Format**: Express the result as the dimensionless coefficient $c$ from the relation $\\langle\\hat{S}_{z}\\rangle=c\\,\\hbar$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a fundamental exercise in quantum mechanics. It is well-posed, as all necessary information for the calculation is provided. The state vector's normalization is confirmed: the sum of the squared moduli of the coefficients is $(\\frac{1}{\\sqrt{3}})^{2} + (\\sqrt{\\frac{2}{3}})^{2} = \\frac{1}{3} + \\frac{2}{3} = 1$. The problem is objective and contains no contradictions or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\nThe objective is to compute the expectation value $\\langle\\hat{S}_{z}\\rangle$ for a particle in the state $|\\alpha\\rangle$. The definition of the expectation value of an operator $\\hat{A}$ for a system in a normalized state $|\\psi\\rangle$ is $\\langle\\hat{A}\\rangle = \\langle\\psi|\\hat{A}|\\psi\\rangle$.\n\nFor this problem, the operator is $\\hat{S}_{z}$ and the state is $|\\alpha\\rangle = \\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle$.\nThe corresponding bra vector is $\\langle\\alpha| = \\left(\\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle\\right)^{\\dagger} = \\frac{1}{\\sqrt{3}}\\langle\\uparrow| + \\sqrt{\\frac{2}{3}}\\langle\\downarrow|$, since the coefficients are real.\n\nThe expectation value is thus given by the expression:\n$$ \\langle\\hat{S}_{z}\\rangle = \\langle\\alpha|\\hat{S}_{z}|\\alpha\\rangle = \\left( \\frac{1}{\\sqrt{3}}\\langle\\uparrow| + \\sqrt{\\frac{2}{3}}\\langle\\downarrow| \\right) \\hat{S}_{z} \\left( \\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle \\right) $$\nFirst, we apply the operator $\\hat{S}_{z}$ to the ket $|\\alpha\\rangle$. By the linearity of quantum mechanical operators:\n$$ \\hat{S}_{z}|\\alpha\\rangle = \\hat{S}_{z} \\left( \\frac{1}{\\sqrt{3}}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}|\\downarrow\\rangle \\right) = \\frac{1}{\\sqrt{3}}\\hat{S}_{z}|\\uparrow\\rangle + \\sqrt{\\frac{2}{3}}\\hat{S}_{z}|\\downarrow\\rangle $$\nUsing the given action of $\\hat{S}_{z}$ on the basis kets:\n$$ \\hat{S}_{z}|\\uparrow\\rangle = \\frac{\\hbar}{2}|\\uparrow\\rangle $$\n$$ \\hat{S}_{z}|\\downarrow\\rangle = -\\frac{\\hbar}{2}|\\downarrow\\rangle $$\nSubstituting these into the expression for $\\hat{S}_{z}|\\alpha\\rangle$:\n$$ \\hat{S}_{z}|\\alpha\\rangle = \\frac{1}{\\sqrt{3}}\\left(\\frac{\\hbar}{2}|\\uparrow\\rangle\\right) + \\sqrt{\\frac{2}{3}}\\left(-\\frac{\\hbar}{2}|\\downarrow\\rangle\\right) = \\frac{\\hbar}{2\\sqrt{3}}|\\uparrow\\rangle - \\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle $$\nNow, we compute the inner product of $\\langle\\alpha|$ with the resulting ket $\\hat{S}_{z}|\\alpha\\rangle$:\n$$ \\langle\\hat{S}_{z}\\rangle = \\left( \\frac{1}{\\sqrt{3}}\\langle\\uparrow| + \\sqrt{\\frac{2}{3}}\\langle\\downarrow| \\right) \\left( \\frac{\\hbar}{2\\sqrt{3}}|\\uparrow\\rangle - \\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}|\\downarrow\\rangle \\right) $$\nExpanding this expression yields four terms:\n$$ \\langle\\hat{S}_{z}\\rangle = \\left(\\frac{1}{\\sqrt{3}}\\right)\\left(\\frac{\\hbar}{2\\sqrt{3}}\\right)\\langle\\uparrow|\\uparrow\\rangle - \\left(\\frac{1}{\\sqrt{3}}\\right)\\left(\\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}\\right)\\langle\\uparrow|\\downarrow\\rangle + \\left(\\sqrt{\\frac{2}{3}}\\right)\\left(\\frac{\\hbar}{2\\sqrt{3}}\\right)\\langle\\downarrow|\\uparrow\\rangle - \\left(\\sqrt{\\frac{2}{3}}\\right)\\left(\\frac{\\hbar}{2}\\sqrt{\\frac{2}{3}}\\right)\\langle\\downarrow|\\downarrow\\rangle $$\nWe apply the orthonormality conditions $\\langle\\uparrow|\\uparrow\\rangle=1$, $\\langle\\downarrow|\\downarrow\\rangle=1$, and $\\langle\\uparrow|\\downarrow\\rangle=\\langle\\downarrow|\\uparrow\\rangle=0$:\n$$ \\langle\\hat{S}_{z}\\rangle = \\left(\\frac{1}{3}\\right)\\left(\\frac{\\hbar}{2}\\right)(1) - 0 + 0 - \\left(\\frac{2}{3}\\right)\\left(\\frac{\\hbar}{2}\\right)(1) $$\nSimplifying the expression:\n$$ \\langle\\hat{S}_{z}\\rangle = \\frac{\\hbar}{6} - \\frac{2\\hbar}{6} = -\\frac{\\hbar}{6} $$\nThe problem requires the answer in the form $\\langle\\hat{S}_{z}\\rangle = c\\,\\hbar$. By comparing our result with this form, we identify the dimensionless coefficient $c$:\n$$ c\\,\\hbar = -\\frac{1}{6}\\hbar \\implies c = -\\frac{1}{6} $$\nThis is the exact value for the coefficient.", "answer": "$$\\boxed{-\\frac{1}{6}}$$", "id": "2459734"}, {"introduction": "Building upon the basic definition, this practice explores the expectation value of energy for a particle-in-a-box, a foundational model in quantum chemistry. When a quantum state is a superposition of energy eigenstates, the calculation simplifies significantly, revealing a deeper principle about quantum measurements. This exercise [@problem_id:2459745] demonstrates this powerful technique and solidifies the concept of the expectation value as the average of allowed energies, weighted by their probabilities.", "problem": "In computational chemistry, the particle-in-a-box model is a standard approximation for the motion of an electron constrained along a conjugated segment. Consider a spinless particle of mass $m$ confined to a one-dimensional (1D) infinite potential well of width $L$, with potential $V(x)=0$ for $0  x  L$ and $V(x)=\\infty$ otherwise. Let $\\{\\psi_{n}(x)\\}$ denote the normalized stationary energy eigenfunctions of the Hamiltonian $\\hat{H}$ for this well, with corresponding energy eigenvalues $\\{E_{n}\\}$.\n\nAt time $t=0$, the particle is prepared in the normalized state\n$$\n\\Psi(x,0) \\;=\\; \\frac{1}{\\sqrt{5}}\\big(\\psi_{1}(x) + 2\\,\\psi_{2}(x)\\big).\n$$\nUsing the operator formalism for observables and the definition of expectation values, determine the exact expectation value of the energy at $t=0$. Provide your final answer as a closed-form analytic expression in terms of $m$, $L$, and the reduced Planck constant $\\hbar$. Express the final energy in Joules. Do not substitute numerical values.", "solution": "The problem will first be subjected to rigorous validation before any attempt at a solution is made.\n\n### Step 1: Extract Givens\nThe following information is provided in the problem statement:\n- **System**: A spinless particle of mass $m$.\n- **Confinement**: A one-dimensional (1D) infinite potential well of width $L$.\n- **Potential**: $V(x)=0$ for $0  x  L$ and $V(x)=\\infty$ otherwise.\n- **Eigenfunctions**: $\\{\\psi_{n}(x)\\}$ are the normalized stationary energy eigenfunctions of the Hamiltonian $\\hat{H}$.\n- **Eigenvalues**: $\\{E_{n}\\}$ are the corresponding energy eigenvalues.\n- **State at $t=0$**: The particle is in the normalized state $\\Psi(x,0) = \\frac{1}{\\sqrt{5}}\\big(\\psi_{1}(x) + 2\\,\\psi_{2}(x)\\big)$.\n- **Objective**: Determine the exact expectation value of the energy at $t=0$ as a closed-form analytic expression in terms of $m$, $L$, and $\\hbar$.\n- **Constraint**: Express the final energy in Joules. Do not substitute numerical values.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the required criteria.\n\n1.  **Scientifically Grounded**: The problem is based on the particle-in-a-box model, a cornerstone of introductory quantum mechanics. All concepts—Hamiltonian operator, eigenfunctions, eigenvalues, superposition principle, and expectation values—are fundamental to quantum theory. The problem is scientifically sound.\n2.  **Well-Posed and Objective**: The problem specifies a well-defined physical system and initial state and asks for a uniquely determinable quantity, the expectation value of energy. The language is precise and objective.\n3.  **Incomplete or Contradictory Setup**: The problem provides all necessary information. It states that the initial state $\\Psi(x,0)$ is normalized. This can be verified. The state is a superposition $\\Psi(x,0) = c_{1}\\psi_{1}(x) + c_{2}\\psi_{2}(x)$ with coefficients $c_{1} = \\frac{1}{\\sqrt{5}}$ and $c_{2} = \\frac{2}{\\sqrt{5}}$. For normalization, the sum of the squared magnitudes of the coefficients must be unity, as the basis functions $\\{\\psi_{n}(x)\\}$ are orthonormal. We check: $|c_{1}|^2 + |c_{2}|^2 = \\left(\\frac{1}{\\sqrt{5}}\\right)^2 + \\left(\\frac{2}{\\sqrt{5}}\\right)^2 = \\frac{1}{5} + \\frac{4}{5} = 1$. The state is indeed normalized. The problem is self-consistent and not contradictory.\n4.  **Unrealistic or Infeasible**: The particle-in-a-box is an idealized model, but it is a standard and physically meaningful approximation. The data are symbolic. The request to express the energy in Joules is consistent with the fact that the resulting analytical expression for energy has units of Joules in the SI system. It does not demand a numerical value, thus avoiding any contradiction with the \"do not substitute\" rule.\n5.  **Ill-Posed or Poorly Structured**: The problem is clearly structured and uses standard, unambiguous terminology from quantum mechanics. A unique, meaningful solution exists.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard, well-posed problem in quantum mechanics. I will proceed with the solution.\n\nThe expectation value of an observable, represented by the operator $\\hat{A}$, for a system in a state $\\Psi$ is given by the general formula $\\langle A \\rangle = \\int \\Psi^* \\hat{A} \\Psi \\, d\\tau$. For the energy observable, the operator is the Hamiltonian, $\\hat{H}$. At time $t=0$, the expectation value of the energy, $\\langle E \\rangle$, is:\n$$\n\\langle E \\rangle = \\langle \\hat{H} \\rangle_{t=0} = \\int_{0}^{L} \\Psi^*(x,0) \\hat{H} \\Psi(x,0) \\, dx\n$$\nThe state $\\Psi(x,0)$ is given as a superposition of the energy eigenfunctions $\\psi_{1}(x)$ and $\\psi_{2}(x)$:\n$$\n\\Psi(x,0) = \\frac{1}{\\sqrt{5}}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}\\psi_{2}(x)\n$$\nThe functions $\\psi_{n}(x)$ are, by definition, eigenfunctions of the Hamiltonian operator $\\hat{H}$ with corresponding energy eigenvalues $E_{n}$. This relationship is expressed as $\\hat{H}\\psi_{n}(x) = E_{n}\\psi_{n}(x)$.\n\nWe can apply the Hamiltonian to the state $\\Psi(x,0)$:\n$$\n\\hat{H}\\Psi(x,0) = \\hat{H}\\left(\\frac{1}{\\sqrt{5}}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}\\psi_{2}(x)\\right) = \\frac{1}{\\sqrt{5}}\\hat{H}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}\\hat{H}\\psi_{2}(x) = \\frac{1}{\\sqrt{5}}E_{1}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}E_{2}\\psi_{2}(x)\n$$\nSubstituting this result into the integral for the expectation value gives:\n$$\n\\langle E \\rangle = \\int_{0}^{L} \\left(\\frac{1}{\\sqrt{5}}\\psi_{1}^*(x) + \\frac{2}{\\sqrt{5}}\\psi_{2}^*(x)\\right) \\left(\\frac{1}{\\sqrt{5}}E_{1}\\psi_{1}(x) + \\frac{2}{\\sqrt{5}}E_{2}\\psi_{2}(x)\\right) \\, dx\n$$\nExpanding the product inside the integral yields four terms. We can use the fact that the energy eigenfunctions $\\{\\psi_{n}(x)\\}$ for a Hermitian operator form an orthonormal set, which means $\\int_{0}^{L} \\psi_{m}^*(x) \\psi_{n}(x) \\, dx = \\delta_{mn}$, where $\\delta_{mn}$ is the Kronecker delta.\n$$\n\\langle E \\rangle = \\frac{1}{5}E_{1}\\int_{0}^{L}\\psi_{1}^*(x)\\psi_{1}(x)dx + \\frac{2}{5}E_{2}\\int_{0}^{L}\\psi_{1}^*(x)\\psi_{2}(x)dx + \\frac{2}{5}E_{1}\\int_{0}^{L}\\psi_{2}^*(x)\\psi_{1}(x)dx + \\frac{4}{5}E_{2}\\int_{0}^{L}\\psi_{2}^*(x)\\psi_{2}(x)dx\n$$\nApplying the orthonormality conditions $\\int\\psi_{1}^*\\psi_{1}dx=1$, $\\int\\psi_{2}^*\\psi_{2}dx=1$, and $\\int\\psi_{1}^*\\psi_{2}dx = \\int\\psi_{2}^*\\psi_{1}dx=0$:\n$$\n\\langle E \\rangle = \\frac{1}{5}E_{1}(1) + \\frac{2}{5}E_{2}(0) + \\frac{2}{5}E_{1}(0) + \\frac{4}{5}E_{2}(1)\n$$\n$$\n\\langle E \\rangle = \\frac{1}{5}E_{1} + \\frac{4}{5}E_{2}\n$$\nThis result demonstrates a general principle: for a state expressed as a normalized superposition $|\\Psi\\rangle = \\sum_{n} c_{n} |\\psi_{n}\\rangle$, the expectation value of energy is $\\langle E \\rangle = \\sum_{n} |c_{n}|^{2} E_{n}$.\n\nThe next step is to find the expressions for the energy eigenvalues $E_{n}$ for the 1D infinite potential well. These are a standard result from solving the time-independent Schrödinger equation for this system, which yields:\n$$\nE_{n} = \\frac{n^2 \\pi^2 \\hbar^2}{2mL^2}\n$$\nwhere $n=1, 2, 3, \\dots$.\n\nWe need the specific eigenvalues for $n=1$ and $n=2$:\n$$\nE_{1} = \\frac{1^2 \\pi^2 \\hbar^2}{2mL^2} = \\frac{\\pi^2 \\hbar^2}{2mL^2}\n$$\n$$\nE_{2} = \\frac{2^2 \\pi^2 \\hbar^2}{2mL^2} = \\frac{4\\pi^2 \\hbar^2}{2mL^2}\n$$\nFinally, we substitute these eigenvalue expressions into our formula for the expectation value $\\langle E \\rangle$:\n$$\n\\langle E \\rangle = \\frac{1}{5}\\left(\\frac{\\pi^2 \\hbar^2}{2mL^2}\\right) + \\frac{4}{5}\\left(\\frac{4\\pi^2 \\hbar^2}{2mL^2}\\right)\n$$\n$$\n\\langle E \\rangle = \\frac{\\pi^2 \\hbar^2}{10mL^2} + \\frac{16\\pi^2 \\hbar^2}{10mL^2}\n$$\nCombining the terms gives the final result:\n$$\n\\langle E \\rangle = \\frac{17\\pi^2 \\hbar^2}{10mL^2}\n$$\nThis is the closed-form analytic expression for the expectation value of the energy. Its units are Joules in the SI system, fulfilling all requirements of the problem.", "answer": "$$\n\\boxed{\\frac{17\\pi^2\\hbar^2}{10mL^2}}\n$$", "id": "2459745"}, {"introduction": "This final practice bridges the gap between abstract theory and the practical world of computational chemistry. Real-world quantum calculations are performed numerically, where wavefunctions become vectors and operators become matrices. This exercise guides you in translating the formal definition of an expectation value into a computational algorithm, demonstrating how properties are calculated in the software you will use as a computational chemist [@problem_id:2459733].", "problem": "Consider a one-dimensional discretized quantum state represented on a finite grid. Let the complex-valued wavefunction be a column vector $\\boldsymbol{\\psi} \\in \\mathbb{C}^{N}$ defined on $N$ grid points with positive quadrature weights $\\mathbf{w} = (w_1,\\dots,w_N)$ that approximate integration on the grid via a diagonal weight matrix $\\mathbf{W} = \\mathrm{diag}(w_1,\\dots,w_N)$. Let the observable be represented by an $N \\times N$ matrix $\\hat{\\mathbf{O}}$. The expectation value of the observable in the state is defined by\n$$\n\\langle \\hat{O} \\rangle \\;=\\; \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\hat{\\mathbf{O}} \\, \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\boldsymbol{\\psi}},\n$$\nwhere $(\\cdot)^\\dagger$ denotes the conjugate transpose. Assume all quantities are dimensionless.\n\nWrite a program that, for each specified test case below, computes the expectation value $\\langle \\hat{O} \\rangle$ using the definition above. The wavefunction may not be normalized; the definition must be used exactly as stated. Assume $\\hat{\\mathbf{O}}$ is Hermitian with respect to the weighted inner product induced by $\\mathbf{W}$, so $\\langle \\hat{O} \\rangle$ is real.\n\nTest Suite (each case specifies ($\\boldsymbol{\\psi}, \\hat{\\mathbf{O}}, \\mathbf{w}$)):\n\n1. Case A (diagonal position-like operator, uniform weights, normalized state):\n   - $N = 4$,\n   - grid values $\\mathbf{x} = (-1, 0, 1, 2)$,\n   - $\\hat{\\mathbf{O}} = \\mathrm{diag}(-1, 0, 1, 2)$,\n   - $\\mathbf{w} = (1, 1, 1, 1)$,\n   - $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\, (1, 1, 0, 0)^{\\mathsf{T}}$.\n\n2. Case B (identity operator, non-uniform weights, unnormalized complex state):\n   - $N = 3$,\n   - $\\hat{\\mathbf{O}} = \\mathbf{I}_3$,\n   - $\\mathbf{w} = (0.3, 0.5, 0.2)$,\n   - $\\boldsymbol{\\psi} = (1 + i, \\, 2 - i, \\, -\\tfrac{1}{2} i)^{\\mathsf{T}}$.\n\n3. Case C (diagonal position-like operator with trapezoidal weights, constant state):\n   - $N = 3$,\n   - grid values $\\mathbf{x} = (0, 0.5, 1.0)$,\n   - $\\hat{\\mathbf{O}} = \\mathrm{diag}(0, 0.5, 1.0)$,\n   - trapezoidal weights $\\mathbf{w} = (0.25, 0.5, 0.25)$,\n   - $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$.\n\n4. Case D (off-diagonal Hermitian operator, complex normalized state):\n   - $N = 2$,\n   - $\\hat{\\mathbf{O}} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$,\n   - $\\mathbf{w} = (1, 1)$,\n   - $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\, (1, i)^{\\mathsf{T}}$.\n\n5. Case E (discrete momentum-like operator with periodic central difference, uniform weights, constant state):\n   - $N = 3$,\n   - grid spacing $\\Delta x = 1$,\n   - define the discrete momentum operator\n     $$\n     \\hat{\\mathbf{P}} \\;=\\; -\\frac{i}{2 \\Delta x}\n     \\begin{pmatrix}\n     0  1  -1 \\\\\n     -1  0  1 \\\\\n     1  -1  0\n     \\end{pmatrix},\n     $$\n     which corresponds to the periodic central-difference representation of $-\\mathrm{i}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}$,\n   - $\\hat{\\mathbf{O}} = \\hat{\\mathbf{P}}$,\n   - $\\mathbf{w} = (1, 1, 1)$,\n   - $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$.\n\nYour program must compute the expectation value for each case and produce a single line of output containing the five results as a comma-separated list enclosed in square brackets, with each value rounded to $10$ decimal places (for example, $[a,b,c,d,e]$ where $a$ through $e$ are floats formatted to $10$ decimal places). Treat all quantities as dimensionless. No user input is required; the program must embed the test suite internally.", "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and objective. It presents a clear computational task based on fundamental principles of numerical quantum mechanics. The objective is to compute the expectation value of an observable $\\hat{\\mathbf{O}}$ for a given quantum state $\\boldsymbol{\\psi}$ on a discretized one-dimensional grid with quadrature weights $\\mathbf{w}$.\n\nThe expectation value $\\langle \\hat{O} \\rangle$ is defined by the generalized Rayleigh quotient:\n$$\n\\langle \\hat{O} \\rangle \\;=\\; \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\hat{\\mathbf{O}} \\, \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\, \\boldsymbol{\\psi}}\n$$\nHere, $\\boldsymbol{\\psi}$ is the complex-valued state vector of size $N$, $\\hat{\\mathbf{O}}$ is the $N \\times N$ matrix representing the observable, $\\mathbf{W} = \\mathrm{diag}(w_1, \\dots, w_N)$ is the diagonal matrix of positive quadrature weights, and $(\\cdot)^\\dagger$ denotes the conjugate transpose. The denominator provides the correct normalization for the state with respect to the weighted inner product defined by $\\mathbf{W}$. The problem asserts that $\\hat{\\mathbf{O}}$ is Hermitian with respect to this weighted inner product, which guarantees that the expectation value $\\langle \\hat{O} \\rangle$ is a real number.\n\nThe computational procedure involves direct application of this formula for each of the five provided test cases. For each case, we construct the vectors $\\boldsymbol{\\psi}$ and $\\mathbf{w}$, and the matrix $\\hat{\\mathbf{O}}$. Then, we compute the numerator and denominator using matrix-vector and vector-dot products and find their ratio.\n\nThe calculation for each case is as follows:\n\n**Case A:**\n- $N = 4$\n- $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} (1, 1, 0, 0)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1, 1, 1)$, so $\\mathbf{W} = \\mathbf{I}_4$ (the $4 \\times 4$ identity matrix).\n- $\\hat{\\mathbf{O}} = \\mathrm{diag}(-1, 0, 1, 2)$\n\nThe denominator is the squared norm: $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 (1^* \\cdot 1 + 1^* \\cdot 1 + 0^* \\cdot 0 + 0^* \\cdot 0) = \\frac{1}{2}(2) = 1$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\hat{\\mathbf{O}} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{O}} \\boldsymbol{\\psi}$. Since both $\\mathbf{W}$ and $\\hat{\\mathbf{O}}$ are diagonal, this is $\\sum_{k=1}^4 w_k O_{kk} |\\psi_k|^2$.\n$N = 1 \\cdot (-1) \\cdot \\left|\\frac{1}{\\sqrt{2}}\\right|^2 + 1 \\cdot 0 \\cdot \\left|\\frac{1}{\\sqrt{2}}\\right|^2 + 1 \\cdot 1 \\cdot |0|^2 + 1 \\cdot 2 \\cdot |0|^2 = -1 \\cdot \\frac{1}{2} + 0 = -0.5$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = -0.5/1 = -0.5$.\n\n**Case B:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1 + i, 2 - i, -0.5i)^{\\mathsf{T}}$\n- $\\mathbf{w} = (0.3, 0.5, 0.2)$\n- $\\hat{\\mathbf{O}} = \\mathbf{I}_3$ (the $3 \\times 3$ identity matrix)\n\nFor any non-zero state $\\boldsymbol{\\psi}$, the expectation value of the identity operator is always $1$. The formula confirms this:\n$\\langle \\hat{O} \\rangle = \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\mathbf{I}_3 \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}} = \\frac{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}}{\\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi}} = 1$.\nThe result is $\\langle \\hat{O} \\rangle = 1.0$.\n\n**Case C:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$\n- $\\mathbf{w} = (0.25, 0.5, 0.25)$\n- $\\hat{\\mathbf{O}} = \\mathrm{diag}(0, 0.5, 1.0)$\n\nThe denominator is $D = \\sum_{k=1}^3 w_k |\\psi_k|^2 = 0.25 \\cdot |1|^2 + 0.5 \\cdot |1|^2 + 0.25 \\cdot |1|^2 = 0.25 + 0.5 + 0.25 = 1$.\nThe numerator is $N = \\sum_{k=1}^3 w_k O_{kk} |\\psi_k|^2 = 0.25 \\cdot 0 \\cdot |1|^2 + 0.5 \\cdot 0.5 \\cdot |1|^2 + 0.25 \\cdot 1.0 \\cdot |1|^2 = 0 + 0.25 + 0.25 = 0.5$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = 0.5/1 = 0.5$. This corresponds to the exact expectation value of position for a constant wavefunction on the interval $[0, 1]$ when using the trapezoidal rule for integration.\n\n**Case D:**\n- $N = 2$\n- $\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} (1, i)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1)$, so $\\mathbf{W} = \\mathbf{I}_2$.\n- $\\hat{\\mathbf{O}} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$\n\nThe denominator is $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 (1^* \\cdot 1 + i^* \\cdot i) = \\frac{1}{2}(1 + (-i)i) = \\frac{1}{2}(1+1) = 1$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{O}} \\boldsymbol{\\psi}$.\nFirst, calculate $\\hat{\\mathbf{O}}\\boldsymbol{\\psi} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ i \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} i \\\\ 1 \\end{pmatrix}$.\nThen, $N = \\boldsymbol{\\psi}^\\dagger (\\hat{\\mathbf{O}}\\boldsymbol{\\psi}) = \\frac{1}{\\sqrt{2}}(1, -i) \\cdot \\frac{1}{\\sqrt{2}} \\begin{pmatrix} i \\\\ 1 \\end{pmatrix} = \\frac{1}{2}(1 \\cdot i + (-i) \\cdot 1) = \\frac{1}{2}(i - i) = 0$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = 0/1 = 0$.\n\n**Case E:**\n- $N = 3$\n- $\\boldsymbol{\\psi} = (1, 1, 1)^{\\mathsf{T}}$\n- $\\mathbf{w} = (1, 1, 1)$, so $\\mathbf{W} = \\mathbf{I}_3$.\n- $\\Delta x = 1$\n- $\\hat{\\mathbf{O}} = \\hat{\\mathbf{P}} = -\\frac{i}{2\\Delta x} \\begin{pmatrix} 0  1  -1 \\\\ -1  0  1 \\\\ 1  -1  0 \\end{pmatrix} = -0.5i \\begin{pmatrix} 0  1  -1 \\\\ -1  0  1 \\\\ 1  -1  0 \\end{pmatrix}$\n\nThe denominator is $D = \\boldsymbol{\\psi}^\\dagger \\mathbf{W} \\boldsymbol{\\psi} = \\boldsymbol{\\psi}^\\dagger \\boldsymbol{\\psi} = 1^* \\cdot 1 + 1^* \\cdot 1 + 1^* \\cdot 1 = 3$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\hat{\\mathbf{P}} \\boldsymbol{\\psi}$.\nFirst, calculate $\\hat{\\mathbf{P}}\\boldsymbol{\\psi}$. The matrix part applied to $\\boldsymbol{\\psi}$ gives:\n$\\begin{pmatrix} 0  1  -1 \\\\ -1  0  1 \\\\ 1  -1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\cdot 1 + 1 \\cdot 1 - 1 \\cdot 1 \\\\ -1 \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 1 \\\\ 1 \\cdot 1 - 1 \\cdot 1 + 0 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\nThus, $\\hat{\\mathbf{P}}\\boldsymbol{\\psi} = \\mathbf{0}$.\nThe numerator is $N = \\boldsymbol{\\psi}^\\dagger \\mathbf{0} = 0$.\nThe expectation value is $\\langle \\hat{O} \\rangle = N/D = 0/3 = 0$. This is expected, as a constant wavefunction represents a state of zero momentum ($k=0$), and the expectation value of the momentum operator for such a state is zero.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the expectation value of an observable for several test cases\n    in a discretized quantum mechanics framework.\n    \"\"\"\n\n    def compute_expectation_value(psi, O, w):\n        \"\"\"\n        Calculates the expectation value O = (psi^dag W O psi) / (psi^dag W psi).\n\n        Args:\n            psi (np.ndarray): The complex-valued wavefunction vector.\n            O (np.ndarray): The complex-valued observable matrix.\n            w (np.ndarray): The real-valued quadrature weights vector.\n\n        Returns:\n            float: The real-valued expectation value.\n        \"\"\"\n        # Ensure inputs are NumPy arrays with appropriate types for calculation.\n        psi = np.asarray(psi, dtype=np.complex128)\n        O = np.asarray(O, dtype=np.complex128)\n        w = np.asarray(w, dtype=np.float64)\n\n        # Numerator: psi^dagger @ W @ O @ psi\n        # The operation W @ vector is efficiently implemented as element-wise multiplication.\n        O_psi = O @ psi\n        W_O_psi = w * O_psi\n        numerator = np.dot(psi.conj(), W_O_psi)\n\n        # Denominator: psi^dagger @ W @ psi\n        W_psi = w * psi\n        denominator = np.dot(psi.conj(), W_psi)\n        \n        # Avoid division by zero, although not expected for valid states.\n        if np.isclose(denominator, 0.0):\n            raise ValueError(\"Denominator is zero, the state norm is zero.\")\n\n        # The problem guarantees a real result. Take the real part to discard\n        # any potential imaginary noise from floating-point arithmetic.\n        expectation_value = (numerator / denominator).real\n        return expectation_value\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {   # Case A\n            \"psi\": (1 / np.sqrt(2)) * np.array([1, 1, 0, 0]),\n            \"O\": np.diag([-1, 0, 1, 2]),\n            \"w\": np.array([1, 1, 1, 1])\n        },\n        {   # Case B\n            \"psi\": np.array([1 + 1j, 2 - 1j, -0.5j]),\n            \"O\": np.identity(3),\n            \"w\": np.array([0.3, 0.5, 0.2])\n        },\n        {   # Case C\n            \"psi\": np.array([1, 1, 1]),\n            \"O\": np.diag([0, 0.5, 1.0]),\n            \"w\": np.array([0.25, 0.5, 0.25])\n        },\n        {   # Case D\n            \"psi\": (1 / np.sqrt(2)) * np.array([1, 1j]),\n            \"O\": np.array([[0, 1], [1, 0]]),\n            \"w\": np.array([1, 1])\n        },\n        {   # Case E\n            \"psi\": np.array([1, 1, 1]),\n            \"O\": (-1j / (2.0 * 1.0)) * np.array([[0, 1, -1], [-1, 0, 1], [1, -1, 0]]),\n            \"w\": np.array([1, 1, 1])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = compute_expectation_value(case[\"psi\"], case[\"O\"], case[\"w\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2459733"}]}