{"hands_on_practices": [{"introduction": "The first step in analyzing molecular vibrations is to determine the total number of vibrational modes a molecule possesses. This fundamental calculation depends critically on the molecule's geometry. This practice [@problem_id:2458109] provides a straightforward application of the rules for counting degrees of freedom, reinforcing the key distinction between linear and non-linear molecules.", "problem": "Consider the triatomic ion $\\mathrm{H_3}^+$ in its stable form, which is an equilateral triangle lying in a plane, free in three-dimensional space. For a molecule composed of $N$ point nuclei in three-dimensional space, the configuration can be specified by $3N$ independent Cartesian coordinates. Vibrational degrees of freedom are defined as the number of independent internal coordinates that change the shape of the molecule, excluding changes corresponding to overall translation and overall rotation of the entire molecule as a rigid body. Determine the number of vibrational degrees of freedom of $\\mathrm{H_3}^+$ in its stable equilateral triangular form. Provide your final answer as an integer.", "solution": "The problem statement has been subjected to rigorous validation and is deemed to be scientifically grounded, well-posed, and objective. It is based on established principles of molecular physics and chemistry, contains all necessary information, and is free of contradictions or ambiguities. Therefore, I will proceed with its solution.\n\nThe problem asks for the number of vibrational degrees of freedom for the triatomic ion $\\mathrm{H_3}^+$. The total number of degrees of freedom for a molecule composed of $N$ atoms, treated as point masses, in three-dimensional space is $3N$. This is because each atom's position can be described by three independent Cartesian coordinates ($x$, $y$, $z$).\n\nFor the $\\mathrm{H_3}^+$ ion, the number of atoms is $N=3$. Thus, the total number of degrees of freedom is:\n$$N_{\\text{total}} = 3N = 3 \\times 3 = 9$$\n\nThese total degrees of freedom can be partitioned into three types of motion for the molecule as a whole: translational, rotational, and vibrational.\n$$N_{\\text{total}} = N_{\\text{trans}} + N_{\\text{rot}} + N_{\\text{vib}}$$\n\nThe number of translational degrees of freedom, $N_{\\text{trans}}$, corresponds to the motion of the molecule's center of mass. In three-dimensional space, there are always $3$ independent directions of translation (e.g., along the $x$, $y$, and $z$ axes). Therefore:\n$$N_{\\text{trans}} = 3$$\n\nThe number of rotational degrees of freedom, $N_{\\text{rot}}$, depends on the geometry of the molecule.\n- For a **linear** molecule, all atoms lie on a single axis. Rotation about this axis does not change the positions of the nuclei and corresponds to a moment of inertia that is effectively zero. Thus, there are only $2$ rotational degrees of freedom, corresponding to rotation about two axes perpendicular to the internuclear axis.\n- For a **non-linear** molecule, the atoms do not all lie on a single line. The molecule has non-zero moments of inertia about three mutually perpendicular principal axes. Therefore, there are $3$ rotational degrees of freedom.\n\nThe problem states that the stable form of $\\mathrm{H_3}^+$ is an equilateral triangle. An equilateral triangle is a planar but non-linear arrangement of three atoms. Consequently, the $\\mathrm{H_3}^+$ ion is a non-linear molecule. The number of rotational degrees of freedom is:\n$$N_{\\text{rot}} = 3$$\n\nThe number of vibrational degrees of freedom, $N_{\\text{vib}}$, represents the internal motions of the atoms relative to each other that change the molecule's shape (bond lengths and angles). This number is what remains after accounting for the rigid-body motions of translation and rotation. We can calculate it by rearranging the partition equation:\n$$N_{\\text{vib}} = N_{\\text{total}} - N_{\\text{trans}} - N_{\\text{rot}}$$\n\nSubstituting the values for a non-linear molecule:\n$$N_{\\text{vib}} = 3N - 3 - 3 = 3N - 6$$\n\nNow, we apply this formula to the $\\mathrm{H_3}^+$ ion, for which $N=3$:\n$$N_{\\text{vib}} = 3(3) - 6 = 9 - 6 = 3$$\n\nTherefore, the $\\mathrm{H_3}^+$ ion possesses $3$ vibrational degrees of freedom. These correspond to the symmetric stretch (a breathing mode) and a pair of degenerate asymmetric stretch and bending modes.", "answer": "$$\\boxed{3}$$", "id": "2458109"}, {"introduction": "While the formulas $3N-6$ and $3N-5$ give the total number of vibrational modes, they don't always align with a simple count of bond lengths and angles. This exercise [@problem_id:2458083] explores the important concept of degeneracy, a consequence of molecular symmetry. You will investigate why a linear molecule like $\\mathrm{CO_2}$ has more vibrational modes than intuitive internal coordinates, revealing the physical nature of these motions.", "problem": "A linear triatomic molecule, carbon dioxide $\\mathrm{CO_2}$, has $N=3$ atoms arranged colinearly at its equilibrium geometry with bond angle $\\theta_{\\mathrm{OCO}}=180^\\circ$. For a linear molecule with $N$ atoms, the number of vibrational normal modes is $3N-5$, so $\\mathrm{CO_2}$ possesses $4$ vibrational modes. In a standard valence internal coordinate description one can define $3$ internal coordinates: the two bond lengths $r_{\\mathrm{CO}}$ (one for each $\\mathrm{C=O}$ bond) and the bond angle $\\theta_{\\mathrm{OCO}}$. What physical motion corresponds to the fourth vibrational mode beyond these $3$ internal coordinates?\n\nA. A second, independent bending motion in a plane orthogonal to the plane used to define $\\theta_{\\mathrm{OCO}}$; the other component of the doubly degenerate bend.\n\nB. A torsional vibration corresponding to twisting about the molecular axis.\n\nC. A rigid translation of the entire molecule along its molecular axis.\n\nD. A rigid rotation of the entire molecule about its molecular axis.\n\nE. A second symmetric stretch in which both $\\mathrm{C=O}$ bonds change length in phase, independent of the first symmetric stretch.", "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n- The molecule is carbon dioxide, $\\mathrm{CO_2}$.\n- It is a linear triatomic molecule with $N=3$ atoms.\n- The equilibrium bond angle is $\\theta_{\\mathrm{OCO}}=180^\\circ$.\n- The number of vibrational normal modes for a linear molecule is stated as $3N-5$.\n- For $\\mathrm{CO_2}$, this results in $3(3)-5 = 4$ vibrational modes.\n- A set of $3$ internal coordinates is defined: two bond lengths $r_{\\mathrm{CO}}$ (one for each $\\mathrm{C=O}$ bond) and the bond angle $\\theta_{\\mathrm{OCO}}$.\n- The question asks for the physical motion corresponding to the fourth vibrational mode, which is not accounted for by this set of $3$ internal coordinates.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is assessed against the criteria of scientific soundness, well-posedness, and objectivity.\n\n- **Scientifically Grounded**: The statements are factually correct. $\\mathrm{CO_2}$ is a linear triatomic molecule. The formula for the number of vibrational modes of a linear molecule, $3N-5$, is a fundamental result from the theory of molecular vibrations. The calculation yielding $4$ modes for $\\mathrm{CO_2}$ is correct. The identification of bond lengths and a bond angle as standard internal coordinates is also correct.\n- **Well-Posed**: The problem is well-posed. It identifies a discrepancy between the number of simple internal coordinates ($3$) and the total number of vibrational modes ($4$) and asks for a physical explanation. This is a standard and non-trivial question in molecular spectroscopy.\n- **Objective**: The language is precise and free of subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically sound, well-posed, and objective. It is therefore permissible to proceed with a full derivation and analysis.\n\n### Solution Derivation\n\nA molecule composed of $N$ atoms possesses a total of $3N$ degrees of freedom, corresponding to the $3$ Cartesian coordinates required to specify the position of each atom in space. For $\\mathrm{CO_2}$, with $N=3$, there are $3 \\times 3 = 9$ total degrees of freedom.\n\nThese degrees of freedom are partitioned into translational, rotational, and vibrational motions of the molecule as a whole.\n1.  **Translational Motion**: The motion of the molecule's center of mass. This accounts for $3$ degrees of freedom, corresponding to translation along three mutually orthogonal axes (e.g., $x, y, z$).\n2.  **Rotational Motion**: The rotation of the molecule about its center of mass. For a non-linear molecule, there are $3$ rotational degrees of freedom. However, for a linear molecule like $\\mathrm{CO_2}$, the atoms lie on a single axis. Rotation about this axis does not change the position of any nucleus and therefore has a moment of inertia of zero (in the idealized case). Consequently, this motion is not considered a molecular rotation. A linear molecule has only $2$ rotational degrees of freedom, corresponding to end-over-end rotation about two axes perpendicular to the molecular axis.\n3.  **Vibrational Motion**: The remaining degrees of freedom must correspond to internal vibrations, where the atoms move relative to each other while the center of mass remains fixed and the molecule does not rotate. The number of vibrational degrees of freedom (or normal modes) is therefore:\n    $$ N_{\\text{vib}} = 3N - (\\text{translational}) - (\\text{rotational}) $$\n    For a linear molecule, this is:\n    $$ N_{\\text{vib}} = 3N - 3 - 2 = 3N-5 $$\n    As correctly stated in the problem, for $\\mathrm{CO_2}$ ($N=3$), this gives $N_{\\text{vib}} = 3(3) - 5 = 4$ vibrational modes.\n\nNow, one must analyze the relationship between these modes and the internal coordinates. The problem provides a set of $3$ simple valence internal coordinates: two bond lengths ($r_1$ and $r_2$) and one bond angle ($\\theta_{\\mathrm{OCO}}$).\n\n- **Stretching Modes**: The two bond length coordinates, $r_1$ and $r_2$, can be combined to form two independent normal modes of vibration:\n    - The symmetric stretch ($\\nu_1$), where both bonds lengthen and shorten in phase.\n    - The asymmetric stretch ($\\nu_3$), where one bond lengthens as the other shortens.\n    Thus, the two stretching coordinates account for two of the four vibrational modes.\n\n- **Bending Modes**: The bond angle coordinate, $\\theta_{\\mathrm{OCO}}$, describes the bending of the molecule away from its linear geometry. A change in this angle from $180^\\circ$ represents a bending vibration. However, this bending motion can occur in any plane containing the molecular axis. Let us define the molecular axis as the $z$-axis. The molecule can bend in the $xz$-plane. This motion can be described by one coordinate and constitutes one vibrational mode. Crucially, the molecule can also bend in the $yz$-plane, which is orthogonal to the $xz$-plane. This second bending motion is independent of the first. Due to the axial symmetry of the linear molecule, these two bending motions are energetically equivalent. They have the same vibrational frequency and are said to be **doubly degenerate**.\n\nThe set of $3$ simple internal coordinates ($r_1, r_2, \\theta_{\\mathrm{OCO}}$) is insufficient to describe the full $4$-dimensional space of vibrational motion. The angle $\\theta_{\\mathrm{OCO}}$ describes the magnitude of the bend, but it does not distinguish between a bend in the $xz$-plane and a bend in the $yz$-plane. To fully specify the bending, two coordinates are required, corresponding to the two orthogonal components of the atomic displacements perpendicular to the molecular axis. These two coordinates give rise to the two degenerate bending modes.\n\nTherefore, the four vibrational modes of $\\mathrm{CO_2}$ are the symmetric stretch, the asymmetric stretch, and a pair of degenerate bending modes. The \"fourth\" mode, which is missing from a simple count of the three specified valence coordinates, is the second, orthogonal component of the degenerate bending vibration.\n\n### Option-by-Option Analysis\n\n**A. A second, independent bending motion in a plane orthogonal to the plane used to define $\\theta_{\\mathrm{OCO}}$; the other component of the doubly degenerate bend.**\nThis statement is precisely correct. The bending vibration in a linear molecule is doubly degenerate, corresponding to two orthogonal motions of identical energy. The standard definition of a single bond angle $\\theta_{\\mathrm{OCO}}$ captures only one of these, or more accurately, their combined amplitude. The second independent mode is the other orthogonal component of the bend. This accounts for the fourth vibrational mode.\n**Verdict: Correct.**\n\n**B. A torsional vibration corresponding to twisting about the molecular axis.**\nTorsion involves the relative rotation of groups of atoms about a chemical bond. In a linear molecule like $\\mathrm{CO_2}$, all atoms lie on the internuclear axis. There are no off-axis atoms to twist relative to one another. \"Twisting\" the molecule about its axis does not change the relative positions of the nuclei and is therefore not a vibration. This is fundamentally incorrect.\n**Verdict: Incorrect.**\n\n**C. A rigid translation of the entire molecule along its molecular axis.**\nThis describes a translational degree of freedom, not a vibrational one. Vibrations are *internal* motions, whereas translation moves the entire molecule's center of mass. This has already been accounted for separately from the $3N-5$ vibrational modes.\n**Verdict: Incorrect.**\n\n**D. A rigid rotation of the entire molecule about its molecular axis.**\nThis describes a rotational degree of freedom. As explained previously, for a linear molecule, rotation about the internuclear axis is not a valid molecular rotation because it does not displace the nuclei. This degree of freedom does not exist in the standard model of molecular motion.\n**Verdict: Incorrect.**\n\n**E. A second symmetric stretch in which both C=O bonds change length in phase, independent of the first symmetric stretch.**\nThe symmetric stretch is a single, non-degenerate normal mode. By definition, a normal mode is an independent, synchronous motion of the atoms. There cannot be two independent symmetric stretch modes. The two bond-stretching coordinates give rise to one symmetric and one asymmetric stretch, and that is all. This statement is a contradiction in terms.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2458083"}, {"introduction": "Computational chemistry relies on representing molecules with Cartesian coordinates, yet chemists often think in terms of internal coordinates like bond lengths and angles. This hands-on programming exercise [@problem_id:2458138] bridges that gap by guiding you through the process of converting a molecule's internal coordinate description (a Z-matrix) into a full set of Cartesian coordinates. This task is a fundamental building block for nearly all molecular modeling software.", "problem": "Write a complete program that converts a simple internal coordinate specification (a Z-matrix) for a water molecule into Cartesian coordinates under a fixed reference-frame convention. The molecule consists of three atoms: one oxygen and two hydrogens. The program must implement the following precise mathematical specification and produce numerical coordinates for a test suite of cases.\n\nReference-frame conventions to remove global rotational and translational freedom: place atom $1$ at the origin $(0,0,0)$ in Cartesian space, place atom $2$ on the positive $x$-axis at a distance equal to its bond length from atom $1$, and place atom $3$ in the $xy$-plane with nonnegative $y$ so that the specified internal bond angle is satisfied. Angles are to be interpreted in degrees. Distances must be interpreted in Ångström units, and the final coordinates must be expressed in Ångström units.\n\nZ-matrix format for water under the canonical triatomic form to be used here:\n- Line $1$: the label of atom $1$ (no references).\n- Line $2$: the label of atom $2$, followed by an integer index of the reference atom (must be $1$), followed by a real bond length $r_{12}$ in Ångström units.\n- Line $3$: the label of atom $3$, followed by an integer index of the bond reference atom (must be $1$), followed by a real bond length $r_{13}$ in Ångström units, followed by an integer index of the angle-defining atom (must be $2$), followed by a real bond angle $\\theta$ in degrees. The vertex of the angle is at atom $1$, that is, $\\theta$ is the angle between vectors $\\overrightarrow{1\\to 2}$ and $\\overrightarrow{1\\to 3}$.\n\nUnder these conventions, let the Cartesian coordinates be $\\mathbf{R}_1=(0,0,0)$, $\\mathbf{R}_2=(r_{12},0,0)$, and $\\mathbf{R}_3=(x_3,y_3,0)$ with\n$$\nx_3 = r_{13}\\cos\\left(\\theta\\frac{\\pi}{180}\\right),\\quad\ny_3 = r_{13}\\sin\\left(\\theta\\frac{\\pi}{180}\\right),\\quad\nz_3 = 0.\n$$\nAll angles must be interpreted in degrees and converted to radians using the factor $\\pi/180$.\n\nYour program must hard-code the following four Z-matrix cases (each consisting of three lines) as its test suite. For each case, compute the Cartesian coordinates for all three atoms using the specification above. Distances are in Ångström units and angles in degrees:\n\n- Case A (typical water geometry): $r_{12}=0.9572$, $r_{13}=0.9572$, $\\theta=104.5$.\n- Case B (asymmetric bonds, wider angle): $r_{12}=1.0$, $r_{13}=0.9$, $\\theta=120.0$.\n- Case C (linear arrangement boundary): $r_{12}=1.0$, $r_{13}=1.5$, $\\theta=180.0$.\n- Case D (nearly collapsed angle boundary): $r_{12}=0.5$, $r_{13}=0.5$, $\\theta=0.0$.\n\nInput format for each Z-matrix in this problem is fixed by the canonical triatomic template and must correspond to:\n- Line $1$: O\n- Line $2$: H $1$ $r_{12}$\n- Line $3$: H $1$ $r_{13}$ $2$ $\\theta$\n\nYour program must:\n- Use the above conventions to determine the unique Cartesian coordinates for each case.\n- Express all coordinates in Ångström units.\n- Round each Cartesian component to $6$ decimal places.\n- For each case, return a list of $9$ real numbers in the order $[x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3]$.\n\nFinal output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list of $9$ rounded Cartesian components for a case, in the order Case A, Case B, Case C, Case D. For example, the printed line should have the form\n$[[x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3],[\\dots],[\\dots],[\\dots]]$\nwith all numeric entries shown as decimal literals.\n\nThere is no user input. The program must contain and use only the four Z-matrices given above as its test suite and produce the single required output line upon execution.", "solution": "The problem has been validated and is deemed a valid, well-posed scientific task. It requests the implementation of a standard coordinate transformation algorithm from internal Z-matrix coordinates to Cartesian coordinates for a triatomic molecule, using a precisely defined reference frame. The provided mathematical formulas and test cases are consistent and scientifically sound.\n\nThe core principle is the conversion of a molecule's geometry, specified by internal coordinates (bond lengths and angles), into a set of Cartesian coordinates $(x, y, z)$ for each atom. This is a fundamental operation in computational chemistry and molecular modeling. Because a non-linear molecule with $N$ atoms has $3N-6$ internal degrees of freedom, a full description in a $3N$-dimensional Cartesian space requires the removal of $6$ degrees of freedom corresponding to global translation and rotation. The problem provides a specific convention for this purpose.\n\nLet the atoms be indexed as $1$ (Oxygen), $2$ (Hydrogen), and $3$ (Hydrogen). Their Cartesian coordinate vectors are $\\mathbf{R}_1$, $\\mathbf{R}_2$, and $\\mathbf{R}_3$. The internal coordinates are the bond lengths $r_{12}$ (distance between atoms $1$ and $2$) and $r_{13}$ (distance between atoms $1$ and $3$), and the bond angle $\\theta = \\angle(2-1-3)$.\n\nThe conversion algorithm proceeds by placing atoms sequentially according to the specified reference-frame conventions:\n\n$1$. Atom $1$ is placed at the origin of the Cartesian system. This fixes its three translational degrees of freedom.\n$$\n\\mathbf{R}_1 = (x_1, y_1, z_1) = (0, 0, 0)\n$$\n\n$2$. Atom $2$ is placed on the positive $x$-axis. This fixes two rotational degrees of freedom. Its distance from atom $1$ is the bond length $r_{12}$.\n$$\n\\mathbf{R}_2 = (x_2, y_2, z_2) = (r_{12}, 0, 0)\n$$\n\n$3$. Atom $3$ is placed in the $xy$-plane with a non-negative $y$-component. This fixes the final rotational degree of freedom. Its position is determined by its distance from atom $1$, $r_{13}$, and the angle $\\theta$ it makes with the vector $\\overrightarrow{1\\to 2}$. In this coordinate system, the vector $\\overrightarrow{1\\to 2}$ is aligned with the $x$-axis. Using polar coordinates in the $xy$-plane, the coordinates of atom $3$ are derived. The angle $\\theta$ must be converted from degrees to radians for use in trigonometric functions, using the conversion factor $\\frac{\\pi}{180}$.\nThe coordinate components of $\\mathbf{R}_3$ are:\n$$\nx_3 = r_{13} \\cos\\left(\\theta \\frac{\\pi}{180}\\right)\n$$\n$$\ny_3 = r_{13} \\sin\\left(\\theta \\frac{\\pi}{180}\\right)\n$$\n$$\nz_3 = 0\n$$\nThe condition for a non-negative $y$-component, $y_3 \\ge 0$, is satisfied because the bond angles $\\theta$ for physical molecules are in the range $[0, 180]$ degrees, where the sine function is non-negative.\n\nThe computational procedure is to apply these formulas for each of the four test cases provided. For each case, the set of parameters $\\{r_{12}, r_{13}, \\theta\\}$ is used to compute the nine Cartesian components $(x_1, y_1, z_1, x_2, y_2, z_2, x_3, y_3, z_3)$. Each component must be rounded to $6$ decimal places. The resulting lists of nine coordinates are then collected into a final list for output. The program in the final answer implements this specification directly.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Cartesian coordinates for four water molecule Z-matrix cases.\n    \"\"\"\n    # The problem defines four test cases with internal coordinates.\n    # Each case is a tuple: (r_12, r_13, theta_degrees)\n    # Distances are in Ångström, angles are in degrees.\n    test_cases = [\n        # Case A: typical water geometry\n        (0.9572, 0.9572, 104.5),\n        # Case B: asymmetric bonds, wider angle\n        (1.0, 0.9, 120.0),\n        # Case C: linear arrangement boundary\n        (1.0, 1.5, 180.0),\n        # Case D: nearly collapsed angle boundary\n        (0.5, 0.5, 0.0),\n    ]\n\n    results = []\n    for r12, r13, theta_deg in test_cases:\n        # Atom 1 (O) is at the origin (0, 0, 0).\n        r1_coords = [0.0, 0.0, 0.0]\n\n        # Atom 2 (H) is on the positive x-axis at a distance r12.\n        r2_coords = [r12, 0.0, 0.0]\n\n        # Atom 3 (H) is in the xy-plane.\n        # Convert angle from degrees to radians for trigonometric functions.\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # Calculate coordinates for Atom 3 using polar-to-Cartesian conversion.\n        x3 = r13 * np.cos(theta_rad)\n        y3 = r13 * np.sin(theta_rad)\n        z3 = 0.0\n        r3_coords = [x3, y3, z3]\n\n        # Combine coordinates into a single list of 9 elements.\n        all_coords = r1_coords + r2_coords + r3_coords\n\n        # Round each component to 6 decimal places as required.\n        rounded_coords = [round(c, 6) for c in all_coords]\n        \n        results.append(rounded_coords)\n\n    # The final output must be a single-line string representing a list of lists.\n    # The template 'f\"[{','.join(map(str, results))}]\"' correctly formats this.\n    # For example, if results is [[1.0, 2.0], [3.0, 4.0]],\n    # map(str, results) yields '[1.0, 2.0]' and '[3.0, 4.0]'.\n    # ','.join(...) yields '[1.0, 2.0],[3.0, 4.0]'.\n    # The f-string adds the outer brackets, giving '[[1.0, 2.0],[3.0, 4.0]]'.\n    # This precisely matches the required output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2458138"}]}