{"hands_on_practices": [{"introduction": "A molecule's total motion in space is described by $3N$ Cartesian coordinates, accounting for every atom's position. However, chemists are often most interested in the molecule's shape—its bond lengths and angles—which can be described by a smaller, more intuitive set of internal coordinates. This exercise challenges you to think critically about this distinction by asking what specific information about a molecule's trajectory is irrecoverably lost when you only keep track of its internal geometry. [@problem_id:2452012]", "problem": "You run a Molecular Dynamics (MD) simulation of an isolated, non-linear molecule consisting of $N$ atoms in vacuum. Instead of saving the full Cartesian coordinates $\\{\\mathbf{r}_i(t_k)\\}_{i=1}^N$ at each saved time $t_k$, you record only a complete set of internal (Z-matrix) coordinates at each $t_k$: all bond lengths $r$, bond angles $\\theta$, and dihedral angles $\\phi$ sufficient to define the molecular shape. You do not store any global reference such as an origin, a laboratory-frame basis, or the position of any reference atom. You also have exact knowledge of the atomic masses $\\{m_i\\}_{i=1}^N$. Based solely on this internal-coordinate trajectory, which of the following pieces of information about the system’s trajectory are fundamentally unrecoverable (i.e., not uniquely reconstructible), even with arbitrary post-processing?\n\nA. The time series of the internal geometrical parameters $r(t)$, $\\theta(t)$, and $\\phi(t)$.\n\nB. The time dependence of the center-of-mass position $\\mathbf{R}_{\\mathrm{COM}}(t)$ in the laboratory frame.\n\nC. The time dependence of the molecule’s overall rotational orientation in the laboratory frame (for example, the directions of its principal inertial axes $\\{\\hat{\\mathbf{e}}_i(t)\\}$).\n\nD. The set of all pairwise interatomic distances $d_{ij}(t)$ at each saved time $t$.\n\nE. The potential energy $U(t)$ as a function of time for the isolated molecule when the force field depends only on interatomic distances and internal geometry (for example, bonded terms plus non-bonded terms that are functions of $d_{ij}$), and there are no external fields.\n\nSelect all that apply.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- **System**: An isolated, non-linear molecule of $N$ atoms in vacuum.\n- **Simulation**: Molecular Dynamics (MD).\n- **Recorded Data**: At each time step $t_k$, a complete set of internal (Z-matrix) coordinates is recorded: all bond lengths $r$, bond angles $\\theta$, and dihedral angles $\\phi$ that define the molecular shape.\n- **Excluded Data**: Full Cartesian coordinates $\\{\\mathbf{r}_i(t_k)\\}_{i=1}^N$ and any global reference frame information (origin, basis, reference atom position).\n- **Known Data**: Atomic masses $\\{m_i\\}_{i=1}^N$.\n- **Question**: Identify which pieces of information are fundamentally unrecoverable from the given trajectory data.\n- **Condition on Potential Energy**: The potential energy $U(t)$ depends only on interatomic distances and internal geometry, and no external fields are present.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is correctly framed within the principles of classical mechanics and computational chemistry, dealing with standard coordinate systems (Cartesian, internal) and their properties. The concepts are sound.\n- **Well-Posedness**: The problem is well-posed. It clearly defines the available information (a complete set of internal coordinates and masses) and asks what information cannot be uniquely reconstructed. A definite solution exists based on the mathematical properties of coordinate transformations.\n- **Objectivity**: The language is precise and technical, free of subjectivity.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, self-contained, and unambiguous. A solution will be derived.\n\n**Derivation**\n\nAn $N$-atom molecule has $3N$ Cartesian degrees of freedom, which can be represented by the set of atomic position vectors $\\{\\mathbf{r}_i \\in \\mathbb{R}^3\\}_{i=1}^N$ in a laboratory frame. For a non-linear molecule, these $3N$ degrees of freedom can be decomposed into:\n1.  $3$ translational degrees of freedom, describing the motion of the center of mass.\n2.  $3$ rotational degrees of freedom, describing the overall orientation of the molecule in space.\n3.  $3N-6$ internal (or vibrational) degrees of freedom, describing the molecular shape (relative positions of atoms).\n\nInternal coordinates, such as a Z-matrix composed of bond lengths ($r$), bond angles ($\\theta$), and dihedral angles ($\\phi$), are a set of $3N-6$ parameters designed to describe precisely the internal degrees of freedom. By their mathematical construction, they are invariant to rigid translations and rotations of the entire molecule.\n\nThe problem states that we are given a complete set of these $3N-6$ internal coordinates at each time step $t_k$. We are also given the atomic masses $\\{m_i\\}_{i=1}^N$. We are explicitly told that no information regarding the laboratory frame is stored. This means the information corresponding to the $3$ translational and $3$ rotational degrees of freedom has been discarded. We must determine which of the listed properties depend on this discarded information.\n\n**Option-by-Option Analysis**\n\n**A. The time series of the internal geometrical parameters $r(t)$, $\\theta(t)$, and $\\phi(t)$.**\nThe problem statement explicitly says, \"you record only a complete set of internal (Z-matrix) coordinates at each $t_k$: all bond lengths $r$, bond angles $\\theta$, and dihedral angles $\\phi$\". This means the time series of these parameters is precisely the data that is given. Therefore, this information is not only recoverable, it is the primary data.\nVerdict: **Incorrect**.\n\n**B. The time dependence of the center-of-mass position $\\mathbf{R}_{\\mathrm{COM}}(t)$ in the laboratory frame.**\nThe center-of-mass position is defined by the absolute Cartesian coordinates in the laboratory frame:\n$$ \\mathbf{R}_{\\mathrm{COM}}(t) = \\frac{\\sum_{i=1}^N m_i \\mathbf{r}_i(t)}{\\sum_{i=1}^N m_i} $$\nThis quantity describes the overall translation of the molecule. The internal coordinates are, by definition, invariant under any translation $\\mathbf{r}_i(t) \\to \\mathbf{r}_i(t) + \\mathbf{T}(t)$. Since the provided data contains no information to fix the molecule's position in space, it is fundamentally impossible to determine $\\mathbf{R}_{\\mathrm{COM}}(t)$. Any trajectory of the center of mass is consistent with the given internal coordinate data. Thus, this information is unrecoverable.\nVerdict: **Correct**.\n\n**C. The time dependence of the molecule’s overall rotational orientation in the laboratory frame (for example, the directions of its principal inertial axes $\\{\\hat{\\mathbf{e}}_i(t)\\}$).**\nThe overall rotational orientation describes how the molecule is oriented in the laboratory frame. Similar to translation, internal coordinates are invariant under rigid rotations. From the internal coordinates, one can construct the molecule's shape and compute properties relative to the molecule's body-fixed frame (such as the moment of inertia tensor in that frame), but one cannot determine the orientation of this body-fixed frame with respect to the external laboratory frame. This information corresponds to the $3$ rotational degrees of freedom that have been discarded. Therefore, the overall rotational orientation is unrecoverable.\nVerdict: **Correct**.\n\n**D. The set of all pairwise interatomic distances $d_{ij}(t)$ at each saved time $t$.**\nA complete set of $3N-6$ internal coordinates uniquely defines the geometry (shape) of the molecule. From these internal coordinates, it is possible to algorithmically construct a set of relative Cartesian coordinates for all atoms, for instance, by placing the first atom at the origin, the second on an axis, and the third on a plane. Once these relative atomic positions $\\{\\mathbf{r}_i^{\\text{rel}}\\}$ are known for a given time $t$, any pairwise interatomic distance can be calculated as $d_{ij}(t) = |\\mathbf{r}_i^{\\text{rel}}(t) - \\mathbf{r}_j^{\\text{rel}}(t)|$. Since distances are scalar quantities, they are invariant to the choice of the relative coordinate system's origin and orientation. Thus, all interatomic distances are uniquely reconstructible from the internal coordinates.\nVerdict: **Incorrect**.\n\n**E. The potential energy $U(t)$ as a function of time for the isolated molecule when the force field depends only on interatomic distances and internal geometry (for example, bonded terms plus non-bonded terms that are functions of $d_{ij}$), and there are no external fields.**\nThe problem states that the potential energy $U(t)$ is a function of the internal geometry (bond lengths, angles, dihedrals) and interatomic distances $d_{ij}$. As established in the analyses for options A and D:\n- The internal coordinates ($r, \\theta, \\phi$) are given directly.\n- The interatomic distances ($d_{ij}$) are uniquely reconstructible from the internal coordinates.\nSince the potential energy depends only on quantities that are either given or can be uniquely calculated from the given data, the potential energy $U(t)$ itself can be uniquely calculated at each time step $t_k$. This information is therefore recoverable.\nVerdict: **Incorrect**.\n\nIn summary, the information that is fundamentally unrecoverable is that which pertains to the overall translational and rotational motion of the molecule in the laboratory frame. These are precisely the quantities described in options B and C.", "answer": "$$\\boxed{BC}$$", "id": "2452012"}, {"introduction": "Understanding the separation of motion conceptually is one thing; proving it mathematically reveals the power of coordinate transformations. This fundamental practice guides you through the derivation for transforming a simple diatomic system from cumbersome Cartesian coordinates to a physically intuitive set of center-of-mass and relative coordinates. By rewriting the kinetic energy, you will see how this change of basis elegantly decouples external motion from internal motion and gives rise to the crucial concept of reduced mass, $\\mu$. [@problem_id:2452024]", "problem": "Consider a diatomic molecule composed of two atoms with masses $m_1$ and $m_2$ at Cartesian positions $\\mathbf{r}_1, \\mathbf{r}_2 \\in \\mathbb{R}^3$. Let the total mass be $M = m_1 + m_2$. Define the center-of-mass (COM) position vector $\\mathbf{R}_{\\mathrm{cm}}$ and the relative position vector $\\mathbf{r}$ by the fundamental relations $\\mathbf{R}_{\\mathrm{cm}} = (m_1 \\mathbf{r}_1 + m_2 \\mathbf{r}_2)/M$ and $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$. The classical kinetic energy in Cartesian coordinates is $T = \\tfrac{1}{2} m_1 |\\dot{\\mathbf{r}}_1|^2 + \\tfrac{1}{2} m_2 |\\dot{\\mathbf{r}}_2|^2$. \n\nUsing only these definitions and the expression for $T$, do the following in three dimensions:\n1. Derive the linear transformation from the Cartesian coordinates $(\\mathbf{r}_1, \\mathbf{r}_2)$ to the coordinates $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ and its inverse.\n2. Compute the absolute value of the Jacobian determinant $J$ for the transformation from $(\\mathbf{r}_1, \\mathbf{r}_2)$ to $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$.\n3. Rewrite $T$ in terms of $\\dot{\\mathbf{R}}_{\\mathrm{cm}}$ and $\\dot{\\mathbf{r}}$, and from this identify the effective mass associated with the internuclear separation $R = |\\mathbf{r}|$. Explain how this connects to the two-atom internal coordinate representation (Z-matrix), in which the only internal coordinate is the bond length $R$, and state the corresponding mass-weighted internal coordinate for bond stretching.\n\nYour final reported quantity must be the Jacobian determinant $J$. State $J$ as a dimensionless number. No rounding is required, and no units are to be included in the final answer.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\nStep 1: Extract Givens\n- Two atoms with masses $m_1$ and $m_2$.\n- Cartesian position vectors $\\mathbf{r}_1, \\mathbf{r}_2 \\in \\mathbb{R}^3$.\n- Total mass: $M = m_1 + m_2$.\n- Center-of-mass position vector: $\\mathbf{R}_{\\mathrm{cm}} = (m_1 \\mathbf{r}_1 + m_2 \\mathbf{r}_2)/M$.\n- Relative position vector: $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$.\n- Classical kinetic energy in Cartesian coordinates: $T = \\tfrac{1}{2} m_1 |\\dot{\\mathbf{r}}_1|^2 + \\tfrac{1}{2} m_2 |\\dot{\\mathbf{r}}_2|^2$.\n- Tasks:\n  1. Derive the linear transformation from $(\\mathbf{r}_1, \\mathbf{r}_2)$ to $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ and its inverse.\n  2. Compute the absolute value of the Jacobian determinant $J$ for the transformation from $(\\mathbf{r}_1, \\mathbf{r}_2)$ to $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$.\n  3. Rewrite $T$ in terms of $\\dot{\\mathbf{R}}_{\\mathrm{cm}}$ and $\\dot{\\mathbf{r}}$, identify the effective mass for the internuclear separation $R = |\\mathbf{r}|$, connect to the Z-matrix, and state the mass-weighted internal coordinate for bond stretching.\n- Final reported quantity: The Jacobian determinant $J$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in classical mechanics and computational chemistry, based on fundamental principles of coordinate transformations and the two-body problem. All definitions are standard and precise. The problem is self-contained and free of contradictions, ambiguities, or factual inaccuracies. It is directly relevant to the specified topic. All criteria for a valid problem are met.\n\nStep 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\nThe problem requires a systematic derivation of several quantities based on the provided definitions. We will address each part in sequence.\n\nPart 1: The Transformation and its Inverse\nThe transformation from the Cartesian coordinates $(\\mathbf{r}_1, \\mathbf{r}_2)$ to the center-of-mass and relative coordinates $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ is given by the system of linear vector equations:\n$$ \\mathbf{R}_{\\mathrm{cm}} = \\frac{m_1}{M} \\mathbf{r}_1 + \\frac{m_2}{M} \\mathbf{r}_2 $$\n$$ \\mathbf{r} = -\\mathbf{r}_1 + \\mathbf{r}_2 $$\nTo find the inverse transformation, we must solve this system for $\\mathbf{r}_1$ and $\\mathbf{r}_2$. From the second equation, we express $\\mathbf{r}_2$ in terms of $\\mathbf{r}_1$ and $\\mathbf{r}$:\n$$ \\mathbf{r}_2 = \\mathbf{r}_1 + \\mathbf{r} $$\nSubstitute this into the first equation for $\\mathbf{R}_{\\mathrm{cm}}$:\n$$ \\mathbf{R}_{\\mathrm{cm}} = \\frac{m_1 \\mathbf{r}_1 + m_2 (\\mathbf{r}_1 + \\mathbf{r})}{M} = \\frac{(m_1 + m_2) \\mathbf{r}_1 + m_2 \\mathbf{r}}{M} = \\frac{M \\mathbf{r}_1 + m_2 \\mathbf{r}}{M} = \\mathbf{r}_1 + \\frac{m_2}{M} \\mathbf{r} $$\nSolving for $\\mathbf{r}_1$ yields:\n$$ \\mathbf{r}_1 = \\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{M} \\mathbf{r} $$\nNow, substitute this expression for $\\mathbf{r}_1$ back into the equation for $\\mathbf{r}_2$:\n$$ \\mathbf{r}_2 = \\left(\\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{M} \\mathbf{r}\\right) + \\mathbf{r} = \\mathbf{R}_{\\mathrm{cm}} + \\left(1 - \\frac{m_2}{M}\\right) \\mathbf{r} = \\mathbf{R}_{\\mathrm{cm}} + \\left(\\frac{M - m_2}{M}\\right) \\mathbf{r} $$\nSince $M = m_1 + m_2$, it follows that $M - m_2 = m_1$. Thus,\n$$ \\mathbf{r}_2 = \\mathbf{R}_{\\mathrm{cm}} + \\frac{m_1}{M} \\mathbf{r} $$\nThe inverse transformation is therefore:\n$$ \\mathbf{r}_1 = \\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{m_1+m_2} \\mathbf{r} $$\n$$ \\mathbf{r}_2 = \\mathbf{R}_{\\mathrm{cm}} + \\frac{m_1}{m_1+m_2} \\mathbf{r} $$\n\nPart 2: The Jacobian Determinant\nThe transformation is between the set of $6$ scalar coordinates $(x_1, y_1, z_1, x_2, y_2, z_2)$ that constitute $(\\mathbf{r}_1, \\mathbf{r}_2)$ and the set $(X_{\\mathrm{cm}}, Y_{\\mathrm{cm}}, Z_{\\mathrm{cm}}, x, y, z)$ that constitute $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$. The Jacobian matrix $\\mathbf{J}$ is given by the matrix of partial derivatives $\\frac{\\partial(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})}{\\partial(\\mathbf{r}_1, \\mathbf{r}_2)}$. Due to the component-wise nature of the linear transformation, we can analyze it in terms of $3 \\times 3$ blocks. The Jacobian matrix is:\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_1} & \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_2} \\\\ \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_1} & \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_2} \\end{pmatrix} $$\nFrom the defining equations of the forward transformation:\n$$ \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_1} = \\frac{m_1}{M} \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_2} = \\frac{m_2}{M} \\mathbf{I}_3 $$\n$$ \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_1} = -\\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_2} = \\mathbf{I}_3 $$\nwhere $\\mathbf{I}_3$ is the $3 \\times 3$ identity matrix. The $6 \\times 6$ Jacobian matrix is:\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{m_1}{M} \\mathbf{I}_3 & \\frac{m_2}{M} \\mathbf{I}_3 \\\\ -\\mathbf{I}_3 & \\mathbf{I}_3 \\end{pmatrix} $$\nIt is simpler to compute the determinant of the Jacobian of the inverse transformation, $\\mathbf{J}^{-1} = \\frac{\\partial(\\mathbf{r}_1, \\mathbf{r}_2)}{\\partial(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})}$, and then use the identity $\\det(\\mathbf{J}) = (\\det(\\mathbf{J}^{-1}))^{-1}$. From the inverse transformation equations:\n$$ \\frac{\\partial \\mathbf{r}_1}{\\partial \\mathbf{R}_{\\mathrm{cm}}} = \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}_1}{\\partial \\mathbf{r}} = -\\frac{m_2}{M} \\mathbf{I}_3 $$\n$$ \\frac{\\partial \\mathbf{r}_2}{\\partial \\mathbf{R}_{\\mathrm{cm}}} = \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}_2}{\\partial \\mathbf{r}} = \\frac{m_1}{M} \\mathbf{I}_3 $$\nSo the Jacobian of the inverse transformation is:\n$$ \\mathbf{J}^{-1} = \\begin{pmatrix} \\mathbf{I}_3 & -\\frac{m_2}{M} \\mathbf{I}_3 \\\\ \\mathbf{I}_3 & \\frac{m_1}{M} \\mathbf{I}_3 \\end{pmatrix} $$\nUsing the formula for the determinant of a block matrix, $\\det \\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix} = \\det(A) \\det(D - CA^{-1}B)$, with $A = \\mathbf{I}_3, B = -\\frac{m_2}{M} \\mathbf{I}_3, C = \\mathbf{I}_3, D = \\frac{m_1}{M} \\mathbf{I}_3$:\n$$ \\det(\\mathbf{J}^{-1}) = \\det(\\mathbf{I}_3) \\det\\left(\\frac{m_1}{M} \\mathbf{I}_3 - (\\mathbf{I}_3)(\\mathbf{I}_3)^{-1}(-\\frac{m_2}{M}\\mathbf{I}_3)\\right) $$\n$$ \\det(\\mathbf{J}^{-1}) = 1 \\cdot \\det\\left(\\frac{m_1}{M} \\mathbf{I}_3 + \\frac{m_2}{M}\\mathbf{I}_3\\right) = \\det\\left(\\frac{m_1+m_2}{M}\\mathbf{I}_3\\right) = \\det\\left(\\frac{M}{M}\\mathbf{I}_3\\right) = \\det(\\mathbf{I}_3) = 1 $$\nThe Jacobian determinant of the inverse transformation is $1$. Therefore, the Jacobian determinant of the forward transformation is $J = \\det(\\mathbf{J}) = (\\det(\\mathbf{J}^{-1}))^{-1} = 1^{-1} = 1$. The absolute value is $|J|=1$.\n\nPart 3: Kinetic Energy, Reduced Mass, and Mass-Weighted Coordinates\nTo express the kinetic energy $T$ in the new coordinates, we differentiate the inverse transformation relations with respect to time:\n$$ \\dot{\\mathbf{r}}_1 = \\dot{\\mathbf{R}}_{\\mathrm{cm}} - \\frac{m_2}{M} \\dot{\\mathbf{r}} $$\n$$ \\dot{\\mathbf{r}}_2 = \\dot{\\mathbf{R}}_{\\mathrm{cm}} + \\frac{m_1}{M} \\dot{\\mathbf{r}} $$\nSubstitute these into the expression for $T$:\n$$ T = \\frac{1}{2} m_1 \\left| \\dot{\\mathbf{R}}_{\\mathrm{cm}} - \\frac{m_2}{M} \\dot{\\mathbf{r}} \\right|^2 + \\frac{1}{2} m_2 \\left| \\dot{\\mathbf{R}}_{\\mathrm{cm}} + \\frac{m_1}{M} \\dot{\\mathbf{r}} \\right|^2 $$\nExpanding the squared norms (dot products):\n$$ T = \\frac{1}{2} m_1 \\left( |\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 - 2\\frac{m_2}{M}(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) + \\frac{m_2^2}{M^2}|\\dot{\\mathbf{r}}|^2 \\right) + \\frac{1}{2} m_2 \\left( |\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 + 2\\frac{m_1}{M}(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) + \\frac{m_1^2}{M^2}|\\dot{\\mathbf{r}}|^2 \\right) $$\nGroup terms by the types of velocities:\nThe term for $|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2$ is $\\frac{1}{2}(m_1+m_2)|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 = \\frac{1}{2}M|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2$.\nThe cross-term for $(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}})$ is $\\frac{1}{2}\\left(-2\\frac{m_1m_2}{M} + 2\\frac{m_2m_1}{M}\\right)(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) = 0$.\nThe term for $|\\dot{\\mathbf{r}}|^2$ is $\\frac{1}{2} \\left( m_1 \\frac{m_2^2}{M^2} + m_2 \\frac{m_1^2}{M^2} \\right) |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2(m_2+m_1)}{M^2} |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2 M}{M^2} |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2}{M} |\\dot{\\mathbf{r}}|^2$.\nWe define the reduced mass $\\mu$ as $\\mu = \\frac{m_1m_2}{m_1+m_2} = \\frac{m_1m_2}{M}$.\nThe kinetic energy separates into two independent terms:\n$$ T = \\frac{1}{2}M|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 + \\frac{1}{2}\\mu|\\dot{\\mathbf{r}}|^2 $$\nThe first term is the translational kinetic energy of the entire molecule treated as a point mass $M$ at the center of mass. The second term is the kinetic energy of the internal motion, described by the relative vector $\\mathbf{r}$. The mass associated with this internal motion is the reduced mass, $\\mu$. Thus, $\\mu$ is the effective mass for motion associated with the internuclear separation $R=|\\mathbf{r}|$.\n\nFor a diatomic molecule, a Z-matrix describes the internal geometry with a single coordinate, the bond length $R_{12}$. This is precisely the magnitude $R=|\\mathbf{r}|$ of our relative vector. The kinetic energy expression shows that the internal motion, with effective mass $\\mu$, is dynamically decoupled from the overall translation.\n\nMass-weighted coordinates are constructed to simplify the kinetic energy expression for vibrations. For a general set of internal coordinates $S_k$, the vibrational kinetic energy is $2T_{vib} = \\dot{\\mathbf{S}}^T \\mathbf{G}^{-1} \\dot{\\mathbf{S}}$. For the single stretching coordinate $S_1 = R$, the corresponding Wilson G-matrix element is $G_{11} = \\frac{1}{m_1} + \\frac{1}{m_2} = \\frac{m_1+m_2}{m_1m_2} = \\frac{1}{\\mu}$. The kinetic energy for vibration is $T_{vib} = \\frac{1}{2} G_{11}^{-1} (\\dot{S}_1)^2 = \\frac{1}{2}\\mu \\dot{R}^2$. A mass-weighted internal coordinate, $\\mathcal{S}_{stretch}$, is defined such that the kinetic energy has the form $T_{vib} = \\frac{1}{2}\\dot{\\mathcal{S}}_{stretch}^2$. Comparing the two forms, we see that $\\dot{\\mathcal{S}}_{stretch}^2 = \\mu \\dot{R}^2$, which implies $\\mathcal{S}_{stretch} = \\sqrt{\\mu}R$.\nThe corresponding mass-weighted internal coordinate for bond stretching is $\\sqrt{\\mu}R$.\n\nThe problem requires reporting the Jacobian determinant $J$.\n$$ J=1 $$", "answer": "$$\n\\boxed{1}\n$$", "id": "2452024"}, {"introduction": "In computational chemistry, a theoretically correct coordinate system can still be practically unusable if it is numerically unstable. This exercise moves from pure theory to the realities of geometry optimization, presenting a case where a seemingly valid Z-matrix definition involving nearly collinear atoms can cripple an algorithm. You will explore how poor anchor choices lead to ill-conditioned transformations and severe convergence problems, providing a crucial lesson in designing robust computational models. [@problem_id:2452028]", "problem": "A geometry optimization in computational chemistry often uses internal coordinates defined via a Z-matrix. In a Z-matrix, each atom beyond the first few is positioned by specifying a bond length to a first anchor atom, a bond angle to a second anchor atom, and a dihedral angle to a third anchor atom. Consider a simple chain of atoms $A$–$B$–$C$–$D$, where in the initial structure the angle $\\angle ABC$ is $179.5^\\circ$ and the atoms $A$, $B$, and $C$ are nearly collinear. Two Z-matrix definitions are considered for placing $D$:\n- Z-definition $\\mathcal{Z}_1$: atom $D$ is defined by its bond to $C$, its bond angle at $B$ (i.e., $\\angle DCB$), and its dihedral formed by the planes $(A,B,C)$ and $(B,C,D)$.\n- Z-definition $\\mathcal{Z}_2$: atom $D$ is defined by its bond to $C$, its bond angle at $C$ (i.e., $\\angle DCB$), and its dihedral formed by the planes $(X,C,B)$ and $(C,B,D)$, where $X$ is a noncollinear atom not on the $A$–$B$–$C$ line (e.g., a substituent off $B$ that ensures no near-linearity).\n\nAssume a standard quasi-Newton geometry optimization that uses internal-coordinate gradients and Hessians obtained by transforming Cartesian quantities through the coordinate transformation, and optionally uses mass-weighted Cartesian coordinates, $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$, where $M$ is the diagonal mass matrix. The fundamental base assumptions are:\n- Internal coordinates are functions of Cartesian coordinates, $q_i = q_i(\\mathbf{x})$, and geometry updates can be made in internal space; transformations between spaces depend on derivatives $\\partial q_i/\\partial x_{a\\alpha}$ that collect into a transformation matrix.\n- The derivatives of torsional angles involve normalized plane normals; when two defining atoms become nearly collinear, the cross products that define these normals become very small in magnitude.\n\nWhich of the following statements correctly describe how a poor choice of anchor atoms in a Z-matrix can lead to numerical instabilities and slow convergence in a geometry optimization?\n\nA. If a dihedral is defined using an internal angle that is nearly linear (e.g., $\\angle ABC \\approx 180^\\circ$), the normalization of plane normals introduces factors proportional to $1/\\sin\\theta$ in the internal-to-Cartesian derivatives, making the transformation ill-conditioned; this can make small internal steps correspond to disproportionately large Cartesian displacements (or vice versa), destabilizing line search or trust-region steps and slowing convergence.\n\nB. Choosing anchors to minimize the total number of internal coordinates always improves numerical stability, even if this forces the use of nearly collinear triplets to define angles and dihedrals.\n\nC. Using mass-weighted Cartesian coordinates, $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$, eliminates instabilities from poor anchor choice because it regularizes the coordinate transformation and removes geometric singularities.\n\nD. Selecting anchors that are nearly collinear or coplanar can reduce the rank or effective rank of the internal-coordinate transformation, degrading the condition number of the internal-coordinate Hessian and gradient transforms, which slows convergence of quasi-Newton methods.\n\nE. Poor anchor choices can couple nominally local internal coordinates over long ranges (e.g., along a nearly collinear path), so that changing one dihedral drags many atoms; trust-region or line-search safeguards then enforce very small steps to prevent geometry “blow-ups,” causing slow convergence even when Cartesian gradients are moderate.\n\nSelect all that apply.", "solution": "The problem statement must first be validated for scientific soundness, clarity, and completeness.\n\n**Step 1: Extract Givens**\n- **System**: A chain of atoms $A$–$B$–$C$–$D$.\n- **Initial Geometry**: The angle $\\angle ABC$ is $179.5^\\circ$, indicating near-collinearity of atoms $A$, $B$, and $C$.\n- **Z-matrix Definitions for Atom $D$**:\n    - $\\mathcal{Z}_1$: Bond to $C$, angle $\\angle DCB$, dihedral based on planes $(A,B,C)$ and $(B,C,D)$.\n    - $\\mathcal{Z}_2$: Bond to $C$, angle $\\angle DCB$, dihedral based on planes $(X,C,B)$ and $(C,B,D)$, where $X$ is a suitable external atom.\n- **Methodology**: Quasi-Newton geometry optimization in internal coordinates. Gradients and Hessians are transformed from Cartesian space.\n- **Coordinate Systems**: Cartesian ($\\mathbf{x}$), internal ($q_i$), and mass-weighted Cartesian ($\\mathbf{x}_m = M^{1/2}\\mathbf{x}$).\n- **Key Principles**:\n    1. Internal coordinates are functions of Cartesian coordinates: $q_i = q_i(\\mathbf{x})$.\n    2. The transformation between coordinate systems depends on the matrix of derivatives $\\partial q_i/\\partial x_{a\\alpha}$ (the Wilson B-matrix).\n    3. Derivatives of dihedral angles involve normalized plane normals.\n    4. Near-collinearity of atoms used to define a plane results in cross products with small magnitudes for the plane normal.\n- **Question**: Identify the correct statements describing how a poor choice of anchor atoms (as in $\\mathcal{Z}_1$) leads to numerical instability and slow convergence.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is based on fundamental and well-established principles of computational chemistry, specifically the theory of molecular geometry optimization and coordinate transformations. The issue of numerical instability arising from ill-defined internal coordinates (e.g., dihedrals involving nearly linear atoms) is a classic and critical topic in the field. The provided information is factually correct and scientifically sound.\n- **Well-Posedness**: The problem provides a clear scenario and asks for an evaluation of several statements based on this scenario. The scenario is specific and designed to probe a known computational issue. A unique set of correct and incorrect statements can be determined from established theory.\n- **Objectivity**: The problem is phrased in precise, technical language, free from subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, and objective. It is a valid problem. I will proceed with a detailed solution.\n\n---\n\nThe core issue lies in the definition of a dihedral angle and the calculation of its derivatives with respect to Cartesian coordinates. A dihedral angle, $\\tau$, for a sequence of atoms $1-2-3-4$ is the angle between the plane containing atoms $(1,2,3)$ and the plane containing atoms $(2,3,4)$. Let the position vectors of the atoms be $\\mathbf{r}_1, \\mathbf{r}_2, \\mathbf{r}_3, \\mathbf{r}_4$.\n\nThe normal vector to the first plane is $\\mathbf{n}_{123} = (\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_3 - \\mathbf{r}_2)$. Its magnitude is $|\\mathbf{n}_{123}| = |\\mathbf{r}_2 - \\mathbf{r}_1||\\mathbf{r}_3 - \\mathbf{r}_2|\\sin(\\theta_{123})$, where $\\theta_{123}$ is the angle $\\angle 123$.\n\nIn the problem, the Z-definition $\\mathcal{Z}_1$ defines the dihedral for atom $D$ using the atoms $A, B, C$. The relevant angle is $\\theta_{ABC} = \\angle ABC \\approx 180^\\circ$. Consequently, $\\sin(\\theta_{ABC}) \\approx 0$, which means that the normal vector to the plane $(A,B,C)$ is nearly a null vector. Geometrically, a plane defined by three nearly collinear points is ill-defined. Any infinitesimal change in atomic positions can cause its orientation to fluctuate wildly.\n\nThe transformation from Cartesian coordinates $\\mathbf{x}$ to internal coordinates $\\mathbf{q}$ is governed by the Wilson B-matrix, whose elements are $B_{ik} = \\partial q_i / \\partial x_k$. The derivatives of a dihedral angle with respect to Cartesian coordinates contain terms inversely proportional to the magnitude of the defining plane normals. For the dihedral in $\\mathcal{Z}_1$, this means its derivatives will contain terms proportional to $1/|\\mathbf{n}_{ABC}| \\propto 1/\\sin(\\theta_{ABC})$. As $\\theta_{ABC} \\to 180^\\circ$, these derivative terms diverge.\n\nThis leads to an ill-conditioned B-matrix. During optimization, a step is typically calculated in internal coordinates, $\\Delta\\mathbf{q}$, and then transformed to a step in Cartesian coordinates, $\\Delta\\mathbf{x}$. This back-transformation involves a generalized inverse of the B-matrix. An ill-conditioned B-matrix makes this transformation numerically unstable, leading to the problems described in the options.\n\n**Option-by-Option Analysis**\n\n**A. If a dihedral is defined using an internal angle that is nearly linear (e.g., $\\angle ABC \\approx 180^\\circ$), the normalization of plane normals introduces factors proportional to $1/\\sin\\theta$ in the internal-to-Cartesian derivatives, making the transformation ill-conditioned; this can make small internal steps correspond to disproportionately large Cartesian displacements (or vice versa), destabilizing line search or trust-region steps and slowing convergence.**\nThis statement gives a precise and accurate description of the underlying mathematical problem. The factor of $1/|\\mathbf{n}_{ABC}|$ in the derivatives of the dihedral with respect to Cartesian coordinates is indeed proportional to $1/\\sin(\\angle ABC)$. As $\\angle ABC \\to 180^\\circ$, this factor diverges, causing some elements of the B-matrix to become extremely large. This makes the transformation matrix ill-conditioned, meaning its inversion (or pseudo-inversion) is numerically unstable. An ill-conditioned mapping can cause a small, well-behaved optimization step proposed in the internal coordinate space to become an enormous, unphysical step in Cartesian space. Optimization algorithms that use line searches or trust regions will detect the massive energy increase caused by such a step and will be forced to take extremely small steps, leading to very slow convergence. The statement is correct.\n**Verdict for A: Correct.**\n\n**B. Choosing anchors to minimize the total number of internal coordinates always improves numerical stability, even if this forces the use of nearly collinear triplets to define angles and dihedrals.**\nThis statement is fundamentally flawed. For a non-linear molecule of $N$ atoms, the number of internal coordinates is fixed at $3N-6$. For a linear molecule, it is $3N-5$. The choice of anchors in a Z-matrix does not alter this number; it only defines what these coordinates represent (which bonds, angles, and dihedrals). The primary goal when choosing anchors is to ensure the numerical stability of the coordinate system. Forcing the use of nearly collinear triplets is the canonical example of a *poor* choice that *introduces* numerical instability. Good practice dictates that one should go to great lengths to *avoid* such definitions, for example by using dummy atoms or judiciously chosen non-local anchors, as hinted at by the definition $\\mathcal{Z}_2$. The statement claims the opposite of what is true.\n**Verdict for B: Incorrect.**\n\n**C. Using mass-weighted Cartesian coordinates, $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$, eliminates instabilities from poor anchor choice because it regularizes the coordinate transformation and removes geometric singularities.**\nMass-weighted coordinates transform the Cartesian coordinates by scaling each component by the square root of the corresponding atomic mass. The internal coordinates $q_i$ are functions of the geometry, i.e., of the Cartesian coordinates $\\mathbf{x}$, not the masses. The singularity in question is purely geometric: the definition of a plane by three collinear points fails regardless of what masses are attached to those points. Mathematically, the derivatives $\\partial q_i / \\partial x_k$ diverge because of geometry. The derivatives in mass-weighted coordinates are related by the chain rule: $\\partial q_i / \\partial x_{m,k} = (\\partial q_i / \\partial x_k) \\cdot m_k^{-1/2}$. This scaling by a constant factor $m_k^{-1/2}$ does nothing to remove the divergence of $\\partial q_i / \\partial x_k$. The instability persists. Mass-weighting is useful for dynamics and vibrational analysis, but it does not fix singularities in the definition of internal coordinates.\n**Verdict for C: Incorrect.**\n\n**D. Selecting anchors that are nearly collinear or coplanar can reduce the rank or effective rank of the internal-coordinate transformation, degrading the condition number of the internal-coordinate Hessian and gradient transforms, which slows convergence of quasi-Newton methods.**\nThis statement provides a correct analysis from a linear algebra perspective. The B-matrix maps changes in Cartesian coordinates to changes in internal coordinates. When a dihedral is ill-defined due to near-collinearity, the corresponding row in the B-matrix becomes numerically problematic (elements are very large). This means the internal coordinate is not well independent of others, or its definition is unstable. This leads to the matrix product $\\mathbf{G} = \\mathbf{B}\\mathbf{B}^T$, which is central to transformations, becoming nearly singular. A nearly singular matrix has one or more very small eigenvalues, which means it has a very high condition number (ratio of largest to smallest eigenvalue) and its effective rank is reduced. The transformations of the gradient and Hessian required for quasi-Newton methods depend on the inverse of $\\mathbf{G}$. A high condition number for $\\mathbf{G}$ makes its inverse numerically unstable, which corrupts the calculated optimization step $\\Delta\\mathbf{q}$ and slows convergence. This statement is a correct and sophisticated description of the problem.\n**Verdict for D: Correct.**\n\n**E. Poor anchor choices can couple nominally local internal coordinates over long ranges (e.g., along a nearly collinear path), so that changing one dihedral drags many atoms; trust-region or line-search safeguards then enforce very small steps to prevent geometry “blow-ups,” causing slow convergence even when Cartesian gradients are moderate.**\nThis statement accurately describes the physical manifestation of the numerical instability. In a well-behaved Z-matrix, changing a single internal coordinate (like a bond length or an angle) results in a localized change in the molecule's geometry. However, with a poor anchor choice like in $\\mathcal{Z}_1$, a small change in the ill-defined dihedral $\\tau_{ABCD}$ can lead to a very large rotation of atom $D$ around the $B-C$ axis. If other atoms are defined relative to $D$ (e.g., in a chain $A-B-C-D-E-\\dots$), this large motion of $D$ will drag all subsequent atoms with it. This creates a strong, artificial coupling between a supposedly local internal coordinate and the positions of many, potentially distant, atoms. An optimization algorithm attempting a small step in this internal coordinate will produce a massive, high-energy distortion of the Cartesian geometry. The algorithm's safeguards (trust radius or line search) will correctly identify this step as disastrous and reduce the step size to a minuscule value. This results in painstakingly slow progress towards the minimum, even if the forces on the atoms are not particularly large.\n**Verdict for E: Correct.**", "answer": "$$\\boxed{ADE}$$", "id": "2452028"}]}