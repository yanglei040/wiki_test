{"hands_on_practices": [{"introduction": "To truly understand the Unrestricted Hartree-Fock (UHF) method, it is best to start with the simplest possible open-shell system: a single hydrogen atom. This exercise walks you through the application of the fundamental UHF equations to derive the orbital energies and spin properties from first principles. By working through this foundational case [@problem_id:2466566], you will gain a concrete understanding of how the alpha and beta Fock operators differ and see how the expectation value of the spin-squared operator, $\\langle \\hat{S}^2 \\rangle$, behaves for a pure, uncontaminated spin state.", "problem": "In unrestricted Hartree-Fock (UHF) theory for open-shell systems, the spin-resolved Fock operators depend on the spin densities and contain Coulomb and exchange terms. Consider a hydrogen atom described in atomic units by a minimal basis consisting of a single normalized Slater-type orbital $|\\phi\\rangle$ corresponding to the hydrogenic $1s$ function with exponent $\\zeta = 1$. Assume there is a single electron with $\\alpha$ spin, so that the occupation numbers are $n_{\\alpha} = 1$ and $n_{\\beta} = 0$. You are given the following integrals for this basis:\n- The one-electron (core Hamiltonian) expectation value $h \\equiv \\langle \\phi | \\hat{h} | \\phi \\rangle = -\\frac{1}{2}$, where $\\hat{h}$ is the one-electron Hamiltonian.\n- The two-electron Coulomb self-integral $J \\equiv (\\phi\\phi|\\phi\\phi) = \\frac{5}{8}$.\n- For identical orbitals, the exchange integral equals the Coulomb self-integral, so $K = J$.\n\nStarting from the definitions of the unrestricted Hartree-Fock Fock operators, and using only the data above and fundamental properties of Coulomb and exchange operators, derive the scalar Fock matrix elements for the $\\alpha$ and $\\beta$ spins in this one-function basis, determine the corresponding orbital energies $\\varepsilon_{\\alpha}$ and $\\varepsilon_{\\beta}$, and compute the expectation value of the total spin-squared operator $\\langle S^2 \\rangle$ for the UHF determinant of this one-electron system.\n\nProvide exact values for $\\varepsilon_{\\alpha}$ and $\\varepsilon_{\\beta}$ in Hartree and for $\\langle S^2 \\rangle$ as a pure number. Your final answer must be a single row containing $\\varepsilon_{\\alpha}$, $\\varepsilon_{\\beta}$, and $\\langle S^2 \\rangle$, in that order, using exact fractions (no rounding).", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard application of unrestricted Hartree-Fock (UHF) theory to a minimal system, the hydrogen atom, for which an exact solution within the model can be derived. All necessary data are provided, and there are no internal contradictions. We may proceed with the solution.\n\nThe UHF Fock operators for spin $\\alpha$ and $\\beta$ electrons are given by:\n$$ \\hat{F}^{\\alpha} = \\hat{h} + \\hat{J}^{\\alpha} + \\hat{J}^{\\beta} - \\hat{K}^{\\alpha} $$\n$$ \\hat{F}^{\\beta} = \\hat{h} + \\hat{J}^{\\alpha} + \\hat{J}^{\\beta} - \\hat{K}^{\\beta} $$\nwhere $\\hat{h}$ is the one-electron (core) Hamiltonian, and $\\hat{J}^{\\sigma}$ and $\\hat{K}^{\\sigma}$ are the total Coulomb and exchange operators for spin $\\sigma$, respectively. These operators are constructed from the spin-orbitals occupied by electrons.\n\nIn a basis of atomic orbitals $\\{|\\phi_{\\mu}\\rangle\\}$, the matrix elements of the Fock operator are:\n$$ F_{\\mu\\nu}^{\\sigma} = h_{\\mu\\nu} + \\sum_{\\lambda\\rho} (P_{\\lambda\\rho}^{\\alpha} + P_{\\lambda\\rho}^{\\beta}) (\\mu\\nu|\\lambda\\rho) - \\sum_{\\lambda\\rho} P_{\\lambda\\rho}^{\\sigma} (\\mu\\lambda|\\nu\\rho) $$\nHere, $h_{\\mu\\nu} = \\langle \\phi_{\\mu} | \\hat{h} | \\phi_{\\nu} \\rangle$ are the one-electron integrals, $(\\mu\\nu|\\lambda\\rho)$ are the two-electron repulsion integrals, and $P^{\\sigma}$ is the spin-density matrix for spin $\\sigma$.\n\nIn the given problem, the basis consists of a single normalized atomic orbital $|\\phi\\rangle$. Consequently, all matrix indices $(\\mu, \\nu, \\lambda, \\rho)$ are equal to $1$, and the matrices become scalars. Let us denote the single basis function as $|\\phi_1\\rangle \\equiv |\\phi\\rangle$. The MO coefficients are trivial; the single $\\alpha$ molecular orbital is $|\\psi^{\\alpha}\\rangle=|\\phi\\rangle$ and the virtual $\\beta$ molecular orbital is $|\\psi^{\\beta}\\rangle=|\\phi\\rangle$. The occupation numbers are given as $n_{\\alpha} = 1$ and $n_{\\beta} = 0$.\n\nThe spin-density matrices are $1 \\times 1$ matrices (scalars) given by $P^{\\sigma} = C^{\\sigma} n^{\\sigma} (C^{\\sigma})^\\dagger$. Since the molecular orbitals are just the basis functions, the coefficient matrices are $C^{\\alpha} = C^{\\beta} = [1]$.\nThe $\\alpha$-spin density matrix element is $P_{11}^{\\alpha} = (1)(1)(1)^* = 1$.\nThe $\\beta$-spin density matrix element is $P_{11}^{\\beta} = (1)(0)(1)^* = 0$.\nThe total density matrix element is $P_{11} = P_{11}^{\\alpha} + P_{11}^{\\beta} = 1 + 0 = 1$.\n\nThe scalar Fock matrix elements, $F^{\\alpha}$ and $F^{\\beta}$, are therefore:\n$$ F^{\\alpha} = F_{11}^{\\alpha} = h_{11} + P_{11} (11|11) - P_{11}^{\\alpha} (11|11) $$\n$$ F^{\\beta} = F_{11}^{\\beta} = h_{11} + P_{11} (11|11) - P_{11}^{\\beta} (11|11) $$\nNote that for a single orbital, the exchange integral $(\\phi_1\\phi_1|\\phi_1\\phi_1)$ is identical to the Coulomb integral, so $K_{11} = J_{11} = (11|11)$, as stated in the problem. The given data are:\n$h \\equiv h_{11} = -\\frac{1}{2}$\n$J \\equiv (11|11) = \\frac{5}{8}$\n\nNow, we substitute the density matrix elements and integral values.\nFor the $\\alpha$-spin Fock matrix element:\n$$ F^{\\alpha} = h + (P_{11}^{\\alpha} + P_{11}^{\\beta})J - P_{11}^{\\alpha}J = h + P_{11}^{\\beta}J $$\n$$ F^{\\alpha} = -\\frac{1}{2} + (0) \\left(\\frac{5}{8}\\right) = -\\frac{1}{2} $$\nThis result is physically correct. The single $\\alpha$ electron does not interact with other electrons, so its energy is determined solely by the core Hamiltonian.\n\nFor the $\\beta$-spin Fock matrix element:\n$$ F^{\\beta} = h + (P_{11}^{\\alpha} + P_{11}^{\\beta})J - P_{11}^{\\beta}J = h + P_{11}^{\\alpha}J $$\n$$ F^{\\beta} = -\\frac{1}{2} + (1) \\left(\\frac{5}{8}\\right) = -\\frac{4}{8} + \\frac{5}{8} = \\frac{1}{8} $$\nThis represents the energy of a virtual $\\beta$ electron, which experiences attraction to the nucleus (term $h$) and repulsion from the existing $\\alpha$ electron (term $J$).\n\nThe orbital energies, $\\varepsilon_{\\alpha}$ and $\\varepsilon_{\\beta}$, are the eigenvalues of the corresponding Fock matrices. Since the matrices are scalars, the orbital energies are the matrix elements themselves.\n$$ \\varepsilon_{\\alpha} = F^{\\alpha} = -\\frac{1}{2} $$\n$$ \\varepsilon_{\\beta} = F^{\\beta} = \\frac{1}{8} $$\n\nFinally, we compute the expectation value of the total spin-squared operator, $\\langle \\hat{S}^2 \\rangle$. For a single-determinant UHF wavefunction, the general formula is:\n$$ \\langle \\hat{S}^2 \\rangle = \\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}\\right)\\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}+1\\right) + N_{\\beta} - \\sum_{i}^{N_{\\alpha}} \\sum_{j}^{N_{\\beta}} |\\langle \\psi_i^{\\alpha} | \\psi_j^{\\beta} \\rangle|^2 $$\nwhere $N_{\\alpha}$ and $N_{\\beta}$ are the numbers of $\\alpha$ and $\\beta$ electrons, and the summation is over the occupied molecular orbitals.\n\nIn this system, we have $N_{\\alpha} = 1$ and $N_{\\beta} = 0$. The first term is the spin-squared value for the state of maximum spin projection, $S(S+1)$ where $S = \\langle S_z \\rangle = \\frac{1}{2}(N_{\\alpha}-N_{\\beta})$.\n$$ \\langle S_z \\rangle = \\frac{1}{2}(1-0) = \\frac{1}{2} $$\nThe summation term represents the spin contamination. Since $N_{\\beta}=0$, the sum over $j$ is empty, and its value is zero.\n$$ \\sum_{i}^{1} \\sum_{j}^{0} |\\langle \\psi_i^{\\alpha} | \\psi_j^{\\beta} \\rangle|^2 = 0 $$\nTherefore, the expression for $\\langle S^2 \\rangle$ simplifies considerably:\n$$ \\langle \\hat{S}^2 \\rangle = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}+1\\right) + 0 - 0 $$\n$$ \\langle \\hat{S}^2 \\rangle = \\left(\\frac{1}{2}\\right)\\left(\\frac{3}{2}\\right) = \\frac{3}{4} $$\nThis result, $\\frac{3}{4}$, is equivalent to $s(s+1)$ for $s=\\frac{1}{2}$, which is the exact value for a pure doublet state. For a one-electron system, the UHF wavefunction is necessarily an eigenfunction of $\\hat{S}^2$, and there is no spin contamination.\n\nThe required values are $\\varepsilon_{\\alpha} = -\\frac{1}{2}$, $\\varepsilon_{\\beta} = \\frac{1}{8}$, and $\\langle S^2 \\rangle = \\frac{3}{4}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{2} & \\frac{1}{8} & \\frac{3}{4}\n\\end{pmatrix}\n}\n$$", "id": "2466566"}, {"introduction": "A key challenge in using UHF is interpreting the output, especially the $\\langle \\hat{S}^2 \\rangle$ value, which often deviates from the ideal $S(S+1)$. This practice provides a clear, quantitative model for understanding what \"spin contamination\" means by treating a UHF wavefunction as a hypothetical mixture of pure spin states. This thought experiment [@problem_id:2466590] demystifies why $\\langle \\hat{S}^2 \\rangle$ can be a non-integer value and is essential for developing the skill to diagnose the quality of your UHF calculations.", "problem": "An Unrestricted Hartree-Fock (UHF) calculation on an open-shell system yields a normalized wavefunction that is not an eigenfunction of the total spin-squared operator $\\hat{S}^{2}$ due to spin contamination. Suppose the UHF wavefunction can be written as a normalized superposition of two orthonormal pure spin eigenstates,\n$$|\\Psi\\rangle = c_{D}\\,|S=\\tfrac{1}{2}\\rangle + c_{Q}\\,|S=\\tfrac{3}{2}\\rangle,$$\nwhere $|S=\\tfrac{1}{2}\\rangle$ (doublet) and $|S=\\tfrac{3}{2}\\rangle$ (quartet) are exact eigenstates of $\\hat{S}^{2}$, and the superposition is an equal mixture in the sense that $|c_{D}|^{2} = |c_{Q}|^{2} = \\tfrac{1}{2}$. Compute the exact expectation value $\\langle \\hat{S}^{2} \\rangle$ for $|\\Psi\\rangle$ in units of $\\hbar^{2}$, and report your answer as a single exact number without units. Do not round your answer.", "solution": "The problem presents a valid and well-posed question in the domain of quantum chemistry, specifically concerning the concept of spin contamination in the Unrestricted Hartree-Fock (UHF) method. It is scientifically grounded and contains all necessary information for a rigorous solution. We shall proceed with the derivation.\n\nThe state of the system is given as a normalized linear combination of two orthonormal pure spin eigenstates, a doublet $|S=\\frac{1}{2}\\rangle$ and a quartet $|S=\\frac{3}{2}\\rangle$:\n$$|\\Psi\\rangle = c_{D}\\,|S=\\tfrac{1}{2}\\rangle + c_{Q}\\,|S=\\tfrac{3}{2}\\rangle$$\nThe problem states that this superposition is an equal mixture, meaning the probabilities of finding the system in the doublet state and the quartet state are equal:\n$$|c_{D}|^{2} = |c_{Q}|^{2} = \\frac{1}{2}$$\nThe normalization condition is satisfied, as $|c_{D}|^{2} + |c_{Q}|^{2} = \\frac{1}{2} + \\frac{1}{2} = 1$. The states $|S=\\frac{1}{2}\\rangle$ and $|S=\\frac{3}{2}\\rangle$ are orthonormal, which implies $\\langle S=s | S=s' \\rangle = \\delta_{ss'}$.\n\nWe are tasked with computing the expectation value of the total spin-squared operator, $\\langle \\hat{S}^{2} \\rangle$. By definition, this is given by the expression:\n$$\\langle \\hat{S}^{2} \\rangle = \\langle \\Psi | \\hat{S}^{2} | \\Psi \\rangle$$\nSubstituting the expression for the bra $\\langle \\Psi | = c_{D}^{*}\\,\\langle S=\\tfrac{1}{2}| + c_{Q}^{*}\\,\\langle S=\\tfrac{3}{2}|$ and the ket $|\\Psi\\rangle$, we have:\n$$\\langle \\hat{S}^{2} \\rangle = \\left( c_{D}^{*}\\,\\langle S=\\tfrac{1}{2}| + c_{Q}^{*}\\,\\langle S=\\tfrac{3}{2}| \\right) \\hat{S}^{2} \\left( c_{D}\\,|S=\\tfrac{1}{2}\\rangle + c_{Q}\\,|S=\\tfrac{3}{2}\\rangle \\right)$$\nThe operator $\\hat{S}^{2}$ is linear. We can apply it to the ket vector first:\n$$\\hat{S}^{2} | \\Psi \\rangle = c_{D}\\,(\\hat{S}^{2}|S=\\tfrac{1}{2}\\rangle) + c_{Q}\\,(\\hat{S}^{2}|S=\\tfrac{3}{2}\\rangle)$$\nThe states $|S=s\\rangle$ are, by definition, eigenstates of the operator $\\hat{S}^{2}$ with eigenvalues $s(s+1)\\hbar^{2}$.\nFor the doublet state, $s=\\frac{1}{2}$, so the eigenvalue is:\n$$s(s+1)\\hbar^{2} = \\frac{1}{2}\\left(\\frac{1}{2}+1\\right)\\hbar^{2} = \\frac{1}{2}\\left(\\frac{3}{2}\\right)\\hbar^{2} = \\frac{3}{4}\\hbar^{2}$$\nThus, $\\hat{S}^{2}|S=\\frac{1}{2}\\rangle = \\frac{3}{4}\\hbar^{2}|S=\\frac{1}{2}\\rangle$.\n\nFor the quartet state, $s=\\frac{3}{2}$, so the eigenvalue is:\n$$s(s+1)\\hbar^{2} = \\frac{3}{2}\\left(\\frac{3}{2}+1\\right)\\hbar^{2} = \\frac{3}{2}\\left(\\frac{5}{2}\\right)\\hbar^{2} = \\frac{15}{4}\\hbar^{2}$$\nThus, $\\hat{S}^{2}|S=\\frac{3}{2}\\rangle = \\frac{15}{4}\\hbar^{2}|S=\\frac{3}{2}\\rangle$.\n\nSubstituting these results back into the expression for $\\hat{S}^{2} | \\Psi \\rangle$:\n$$\\hat{S}^{2} | \\Psi \\rangle = c_{D}\\left(\\frac{3}{4}\\hbar^{2}\\right)|S=\\tfrac{1}{2}\\rangle + c_{Q}\\left(\\frac{15}{4}\\hbar^{2}\\right)|S=\\tfrac{3}{2}\\rangle$$\nNow, we compute the full bracket $\\langle \\Psi | (\\hat{S}^{2} | \\Psi \\rangle)$:\n$$\\langle \\hat{S}^{2} \\rangle = \\left( c_{D}^{*}\\,\\langle S=\\tfrac{1}{2}| + c_{Q}^{*}\\,\\langle S=\\tfrac{3}{2}| \\right) \\left( c_{D}\\frac{3}{4}\\hbar^{2}|S=\\tfrac{1}{2}\\rangle + c_{Q}\\frac{15}{4}\\hbar^{2}|S=\\tfrac{3}{2}\\rangle \\right)$$\nExpanding this expression yields four terms:\n$$\\langle \\hat{S}^{2} \\rangle = c_{D}^{*}c_{D}\\frac{3}{4}\\hbar^{2}\\langle S=\\tfrac{1}{2}|S=\\tfrac{1}{2}\\rangle + c_{D}^{*}c_{Q}\\frac{15}{4}\\hbar^{2}\\langle S=\\tfrac{1}{2}|S=\\tfrac{3}{2}\\rangle + c_{Q}^{*}c_{D}\\frac{3}{4}\\hbar^{2}\\langle S=\\tfrac{3}{2}|S=\\tfrac{1}{2}\\rangle + c_{Q}^{*}c_{Q}\\frac{15}{4}\\hbar^{2}\\langle S=\\tfrac{3}{2}|S=\\tfrac{3}{2}\\rangle$$\nDue to the orthonormality of the spin eigenstates, $\\langle S=\\frac{1}{2}|S=\\frac{3}{2}\\rangle = 0$ and $\\langle S=\\frac{3}{2}|S=\\frac{1}{2}\\rangle = 0$, causing the cross-terms to vanish. The normalization of each state gives $\\langle S=\\frac{1}{2}|S=\\frac{1}{2}\\rangle = 1$ and $\\langle S=\\frac{3}{2}|S=\\frac{3}{2}\\rangle = 1$. The expression simplifies to:\n$$\\langle \\hat{S}^{2} \\rangle = |c_{D}|^{2}\\frac{3}{4}\\hbar^{2} + |c_{Q}|^{2}\\frac{15}{4}\\hbar^{2}$$\nThis is the general result for the expectation value of an operator in a superposition of its eigenstates. The expectation value is the weighted average of the eigenvalues, where the weights are the probabilities of measuring each eigenvalue.\n\nWe are given $|c_{D}|^{2} = \\frac{1}{2}$ and $|c_{Q}|^{2} = \\frac{1}{2}$. Substituting these values:\n$$\\langle \\hat{S}^{2} \\rangle = \\left(\\frac{1}{2}\\right)\\frac{3}{4}\\hbar^{2} + \\left(\\frac{1}{2}\\right)\\frac{15}{4}\\hbar^{2}$$\nFactoring out common terms:\n$$\\langle \\hat{S}^{2} \\rangle = \\frac{1}{2}\\hbar^{2}\\left(\\frac{3}{4} + \\frac{15}{4}\\right) = \\frac{1}{2}\\hbar^{2}\\left(\\frac{18}{4}\\right) = \\frac{1}{2}\\hbar^{2}\\left(\\frac{9}{2}\\right) = \\frac{9}{4}\\hbar^{2}$$\nThe problem asks for the value in units of $\\hbar^{2}$. Therefore, the numerical answer is:\n$$\\frac{\\langle \\hat{S}^{2} \\rangle}{\\hbar^{2}} = \\frac{9}{4}$$\nThis result is an exact number as required.", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "2466590"}, {"introduction": "This final practice moves from pen-and-paper exercises to a practical computational simulation, challenging you to implement a UHF model for the allyl radical. This capstone problem [@problem_id:2466609] synthesizes the core concepts of the UHF self-consistent field (SCF) procedure and the analysis of spin contamination. By exploring how spin contamination changes with molecular geometry, you will see how this theoretical artifact is dynamically linked to chemical structure, providing a deeper insight into the behavior and limitations of the UHF method in real chemical systems.", "problem": "You will implement a minimal Unrestricted Hartree-Fock (UHF) model for the allyl radical to study how the spin contamination depends on the central carbon-carbon-carbon angle deformation. The allyl radical is modeled as a three-site trigonal carbon chain carrying a single unpaired electron in its delocalized $\\pi$ system, with a fixed carbon-carbon bond length and a variable central bond angle. The objective is to compute the spin contamination, defined as the excess of the expectation value of the total spin-squared operator over the exact spin value, as the angle is changed.\n\nStart from the following physically justified base and definitions.\n\n1. Use a three-site single-band Hubbard Hamiltonian for the $\\pi$-system,\n$$\n\\hat{H} = \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\sum_{i,j=1}^{3} t_{ij} \\hat{c}^{\\dagger}_{i\\sigma} \\hat{c}_{j\\sigma} + U \\sum_{i=1}^{3} \\hat{n}_{i\\alpha} \\hat{n}_{i\\beta},\n$$\nwhere $t_{ij}$ are one-electron hopping integrals between sites $i$ and $j$, $U$ is the on-site repulsion, $\\hat{c}^{\\dagger}_{i\\sigma}$ and $\\hat{c}_{i\\sigma}$ are creation and annihilation operators for a spin-$\\sigma$ electron on site $i$, and $\\hat{n}_{i\\sigma} = \\hat{c}^{\\dagger}_{i\\sigma} \\hat{c}_{i\\sigma}$. Assume a minimal orthonormal basis of $p_z$-like orbitals on each carbon.\n\n2. Model the one-electron hopping matrix $T = [t_{ij}]$ as follows. Let the nearest-neighbor hoppings be constant and equal to $t_{12} = t_{21} = t_{23} = t_{32} = t_0$, and let the through-space next-nearest-neighbor coupling between terminal carbons be $t_{13} = t_{31} = t_{13}(\\theta)$ that depends on the central angle $\\theta$. With fixed bond length $a$, the terminal distance is\n$$\nR_{13}(\\theta) = 2 a \\sin\\!\\left(\\frac{\\theta}{2}\\right).\n$$\nAssume a distance-decaying coupling of the form\n$$\nt_{13}(\\theta) = \\operatorname{sgn}(t_0) \\, c \\, |t_0| \\exp\\!\\left[ -\\beta \\left( R_{13}(\\theta) - R_{\\mathrm{ref}} \\right) \\right],\n$$\nwhere $R_{\\mathrm{ref}} = 2 a \\sin\\!\\left( \\frac{\\pi}{3} \\right)$ is the terminal separation at $\\theta = 120^\\circ$, $c$ is a dimensionless prefactor, and $\\beta$ is an inverse decay length.\n\n3. Perform a self-consistent mean-field decoupling for the Hubbard interaction to obtain spin-dependent Fock matrices for Unrestricted Hartree-Fock (UHF):\n$$\nF^{\\alpha} = T + U \\, \\mathrm{diag}\\!\\left(n^{\\beta}_1 - \\frac{1}{2}, \\, n^{\\beta}_2 - \\frac{1}{2}, \\, n^{\\beta}_3 - \\frac{1}{2} \\right),\n$$\n$$\nF^{\\beta} = T + U \\, \\mathrm{diag}\\!\\left(n^{\\alpha}_1 - \\frac{1}{2}, \\, n^{\\alpha}_2 - \\frac{1}{2}, \\, n^{\\alpha}_3 - \\frac{1}{2} \\right),\n$$\nwhere $n^{\\sigma}_i$ are the site populations for spin $\\sigma$. Use $N_{\\alpha} = 2$ and $N_{\\beta} = 1$, corresponding to $3$ $\\pi$ electrons in the allyl radical. Occupy the $N_{\\sigma}$ lowest-energy eigenstates of $F^{\\sigma}$ with unit occupancy. Iterate until self-consistency.\n\n4. Derive, from the second-quantized definition of the total spin operator and the structure of UHF wave functions in an orthonormal basis, an expression for the expectation value $ \\langle \\hat{S}^2 \\rangle $ that can be computed from the occupied $\\alpha$ and $\\beta$ molecular orbitals. Then define the spin contamination as\n$$\n\\Delta = \\langle \\hat{S}^2 \\rangle - S(S+1),\n$$\nwith $S = \\frac{1}{2}$ for a doublet. Your program must compute $\\Delta$ using only quantities available from the UHF solution.\n\nUse the following parameter values and numerical settings:\n- Carbon-carbon bond length $a = 1.40 \\, \\text{Å}$.\n- Nearest-neighbor hopping $t_0 = -2.50 \\, \\text{eV}$.\n- On-site repulsion $U = 6.00 \\, \\text{eV}$.\n- Through-space coupling prefactor $c = 0.10$ (dimensionless).\n- Decay constant $\\beta = 1.50 \\, \\text{Å}^{-1}$.\n- Reference distance $R_{\\mathrm{ref}} = 2 a \\sin\\!\\left( 60^\\circ \\right)$.\n- Damping (linear mixing) factor $m = 0.50$ for the site populations.\n- Convergence tolerance $\\varepsilon = 10^{-10}$ on the maximum absolute change of site populations.\n- Maximum number of self-consistent iterations $N_{\\mathrm{it,max}} = 10{,}000$.\n\nAngle unit and test suite:\n- Use angles $\\theta$ in degrees.\n- Evaluate the central angle test suite $\\Theta = [180, 150, 120, 100, 90]$ degrees in this exact order.\n\nOutput specification:\n- For each $\\theta \\in \\Theta$, compute the converged spin contamination $\\Delta$ as a floating-point number.\n- The final program output must be a single line containing a comma-separated list of the five $\\Delta$ values in the order of $\\Theta$, enclosed in square brackets, for example $[\\Delta_{180},\\Delta_{150},\\Delta_{120},\\Delta_{100},\\Delta_{90}]$.\n- Report the values as plain floats. No units are required, since $\\Delta$ is dimensionless.\n\nAll mathematics in your derivation and reasoning must be based on the definitions and facts above and general properties of the Hartree-Fock method. No additional empirical formulas beyond those specified here are allowed. Ensure the numerical model is self-consistent and uses the definitions provided. Your program must be fully deterministic, self-contained, use no external input, and must implement the self-consistency and spin expectation calculation explicitly.", "solution": "The problem statement is subjected to rigorous validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Model:** Three-site single-band Hubbard Hamiltonian for a $\\pi$-system on three carbon atoms.\n- **Hamiltonian:** $\\hat{H} = \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\sum_{i,j=1}^{3} t_{ij} \\hat{c}^{\\dagger}_{i\\sigma} \\hat{c}_{j\\sigma} + U \\sum_{i=1}^{3} \\hat{n}_{i\\alpha} \\hat{n}_{i\\beta}$.\n- **Basis:** Orthonormal basis of $p_z$-like atomic orbitals.\n- **Hopping Integrals:** $t_{12} = t_{21} = t_{23} = t_{32} = t_0$. $t_{13} = t_{31}$ is dependent on the central angle $\\theta$. All other $t_{ij}=0$ for $i \\ne j$. On-site energies $t_{ii}=0$.\n- **Terminal Distance:** $R_{13}(\\theta) = 2 a \\sin(\\frac{\\theta}{2})$.\n- **Terminal Hopping:** $t_{13}(\\theta) = \\operatorname{sgn}(t_0) \\, c \\, |t_0| \\exp[-\\beta ( R_{13}(\\theta) - R_{\\mathrm{ref}} )]$.\n- **UHF Fock Matrices:**\n  - $F^{\\alpha} = T + U \\, \\mathrm{diag}(n^{\\beta}_1 - 1/2, \\, n^{\\beta}_2 - 1/2, \\, n^{\\beta}_3 - 1/2 )$\n  - $F^{\\beta} = T + U \\, \\mathrm{diag}(n^{\\alpha}_1 - 1/2, \\, n^{\\alpha}_2 - 1/2, \\, n^{\\alpha}_3 - 1/2 )$\n- **Electron Configuration:** $N_{\\alpha} = 2$ electrons with spin $\\alpha$, $N_{\\beta} = 1$ electron with spin $\\beta$.\n- **Spin Contamination:** $\\Delta = \\langle \\hat{S}^2 \\rangle - S(S+1)$, with $S=1/2$.\n- **Parameters:**\n  - Bond length $a = 1.40 \\, \\text{Å}$.\n  - Nearest-neighbor hopping $t_0 = -2.50 \\, \\text{eV}$.\n  - On-site repulsion $U = 6.00 \\, \\text{eV}$.\n  - Coupling prefactor $c = 0.10$.\n  - Decay constant $\\beta = 1.50 \\, \\text{Å}^{-1}$.\n  - Reference distance $R_{\\mathrm{ref}} = 2 a \\sin(60^\\circ)$.\n- **Numerical Settings:**\n  - Damping factor $m = 0.50$.\n  - Convergence tolerance $\\varepsilon = 10^{-10}$.\n  - Maximum iterations $N_{\\mathrm{it,max}} = 10{,}000$.\n- **Test Suite:** Central angles $\\Theta = [180, 150, 120, 100, 90]$ degrees.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded:** The problem uses the Hubbard model and the Unrestricted Hartree-Fock (UHF) method, which are standard and well-established theoretical frameworks in computational chemistry and condensed matter physics for studying electron correlation and open-shell systems. The parameterization of hopping integrals and the concept of spin contamination are physically sound.\n- **Well-Posed:** The problem provides a clear objective, a complete set of equations, all necessary numerical parameters, and a defined computational procedure (Self-Consistent Field, SCF). The existence of a solution is guaranteed by the structure of the SCF algorithm, which is known to converge for such systems, especially with damping.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased scientific language. All quantities are defined, and no subjective elements are present.\n\nThe problem does not exhibit any of the invalidity flaws. It is scientifically sound, formalizable, complete, and well-structured.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution\n\nThe objective is to compute the spin contamination in a three-site model of the allyl radical as a function of its central angle $\\theta$, using the Unrestricted Hartree-Fock (UHF) method. The solution requires two main components: the derivation of the spin contamination formula within the UHF framework and the implementation of the UHF self-consistent field (SCF) algorithm.\n\nFirst, we derive the expression for the expectation value of the total spin-squared operator, $\\langle \\hat{S}^2 \\rangle$. The UHF wavefunction, $|\\Psi_{UHF}\\rangle$, is a single Slater determinant constructed from distinct spatial orbitals for $\\alpha$ and $\\beta$ spins. While $|\\Psi_{UHF}\\rangle$ is an eigenfunction of the total spin projection operator $\\hat{S}_z$ with a well-defined eigenvalue $M_S = \\frac{1}{2}(N_{\\alpha} - N_{\\beta})$, it is not, in general, an eigenfunction of $\\hat{S}^2$. This deviation from a pure spin state is termed spin contamination.\n\nA widely used expression for $\\langle \\hat{S}^2 \\rangle$ for a single-determinant UHF wavefunction is:\n$$\n\\langle \\hat{S}^2 \\rangle = \\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}\\right)\\left(\\frac{N_{\\alpha}-N_{\\beta}}{2} + 1\\right) + N_{\\beta} - \\sum_{p=1}^{N_{\\alpha}} \\sum_{q=1}^{N_{\\beta}} |\\langle \\psi_p^{\\alpha} | \\psi_q^{\\beta} \\rangle|^2\n$$\nwhere $|\\psi_p^{\\alpha}\\rangle$ and $|\\psi_q^{\\beta}\\rangle$ are the occupied molecular orbitals (MOs) for spin $\\alpha$ and spin $\\beta$, respectively. For a pure doublet state, the exact value of the spin quantum number is $S=1/2$, and the exact expectation value of $\\hat{S}^2$ is $S(S+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$.\n\nFor the allyl radical, we have $N_{\\alpha}=2$ and $N_{\\beta}=1$. The first term in the $\\langle \\hat{S}^2 \\rangle$ expression becomes:\n$$\n\\left(\\frac{2-1}{2}\\right)\\left(\\frac{2-1}{2} + 1\\right) = \\frac{1}{2}\\left(\\frac{3}{2}\\right) = \\frac{3}{4} = S(S+1).\n$$\nThe spin contamination, $\\Delta$, is defined as the difference between the computed expectation value and the exact value:\n$$\n\\Delta = \\langle \\hat{S}^2 \\rangle - S(S+1) = N_{\\beta} - \\sum_{p=1}^{N_{\\alpha}} \\sum_{q=1}^{N_{\\beta}} |\\langle \\psi_p^{\\alpha} | \\psi_q^{\\beta} \\rangle|^2.\n$$\nWith $N_{\\alpha}=2$ and $N_{\\beta}=1$, this simplifies to:\n$$\n\\Delta = 1 - \\sum_{p=1}^{2} |\\langle \\psi_p^{\\alpha} | \\psi_1^{\\beta} \\rangle|^2 = 1 - \\left( |\\langle \\psi_1^{\\alpha} | \\psi_1^{\\beta} \\rangle|^2 + |\\langle \\psi_2^{\\alpha} | \\psi_1^{\\beta} \\rangle|^2 \\right).\n$$\nThe MOs are expressed as linear combinations of the orthonormal atomic orbitals (AOs) $|\\phi_i\\rangle$: $|\\psi_p^{\\sigma}\\rangle = \\sum_i C_{ip}^{\\sigma} |\\phi_i\\rangle$. The overlap integrals are then computed from the MO coefficient vectors: $\\langle \\psi_p^{\\alpha} | \\psi_q^{\\beta} \\rangle = \\sum_i C_{ip}^{\\alpha} C_{iq}^{\\beta}$. In matrix notation, if $C_{occ}^{\\sigma}$ is the matrix of occupied MO coefficients (as columns), the matrix of overlaps is $S^{\\alpha\\beta} = (C_{occ}^{\\alpha})^T C_{occ}^{\\beta}$. The sum of squares is the squared Frobenius norm of this overlap matrix.\n\nThe core of the calculation is the SCF procedure to find the converged MO coefficients. For each angle $\\theta$ in the test suite, the following iterative algorithm is executed:\n1.  **System Setup:** The angle $\\theta$ is converted to radians. The terminal distance $R_{13}(\\theta)$ and the corresponding hopping integral $t_{13}(\\theta)$ are calculated using the given formulas. The one-electron hopping matrix $T$ of size $3 \\times 3$ is constructed:\n    $$\n    T = \\begin{pmatrix} 0 & t_0 & t_{13}(\\theta) \\\\ t_0 & 0 & t_0 \\\\ t_{13}(\\theta) & t_0 & 0 \\end{pmatrix}\n    $$\n2.  **Initialization:** An initial guess for the site populations $n_i^{\\alpha}$ and $n_i^{\\beta}$ is made. A physically reasonable initial guess is based on the Hückel theory for the allyl radical, which places the unpaired spin density on the terminal carbon atoms. This corresponds to initial populations $n^{\\alpha} = [0.75, 0.5, 0.75]$ and $n^{\\beta} = [0.25, 0.5, 0.25]$.\n\n3.  **SCF Iterations:** The process iterates until the change in site populations between successive iterations is less than the tolerance $\\varepsilon = 10^{-10}$.\n    a. **Build Fock Matrices:** The spin-dependent Fock matrices, $F^{\\alpha}$ and $F^{\\beta}$, are constructed using the current site populations:\n       $$\n       F^{\\alpha} = T + U \\, \\mathrm{diag}(n_1^{\\beta} - 0.5, n_2^{\\beta} - 0.5, n_3^{\\beta} - 0.5)\n       $$\n       $$\n       F^{\\beta} = T + U \\, \\mathrm{diag}(n_1^{\\alpha} - 0.5, n_2^{\\alpha} - 0.5, n_3^{\\alpha} - 0.5)\n       $$\n    b. **Diagonalization:** The eigenvalue problem is solved for each Fock matrix: $F^{\\sigma} C^{\\sigma} = C^{\\sigma} E^{\\sigma}$. This yields MO energies (eigenvalues) and coefficients (eigenvectors).\n    c. **Update Densities:** The MOs are occupied according to the Aufbau principle. The $N_{\\alpha}=2$ lowest-energy $\\alpha$ orbitals and the $N_{\\beta}=1$ lowest-energy $\\beta$ orbital are used to construct the new density matrices $P^{\\sigma} = C_{occ}^{\\sigma} (C_{occ}^{\\sigma})^T$. The new site populations are the diagonal elements of these matrices: $n_i^{\\sigma (\\text{new})} = P_{ii}^{\\sigma}$.\n    d. **Damping:** To ensure smooth convergence, the new populations are mixed with the old ones using a linear mixing scheme with factor $m=0.5$:\n       $$\n       n_i^{\\sigma} = (1-m)n_i^{\\sigma (\\text{old})} + m \\, n_i^{\\sigma (\\text{new})}\n       $$\n    e. **Convergence Check:** The maximum absolute difference between the new and old population vectors is compared with the tolerance $\\varepsilon$. If the change is smaller than $\\varepsilon$, the SCF cycle is considered converged.\n\n4.  **Post-SCF Calculation:** Upon convergence, the final MO coefficient matrices $C_{occ}^{\\alpha}$ and $C_{occ}^{\\beta}$ are used to calculate the overlap matrix $(C_{occ}^{\\alpha})^T C_{occ}^{\\beta}$. The spin contamination $\\Delta$ is then computed using the derived formula.\n\nThis procedure is repeated for each specified angle $\\theta$, and the resulting values of $\\Delta$ are collected.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the UHF spin contamination for a 3-site Hubbard model of the allyl radical\n    as a function of the central C-C-C angle.\n    \"\"\"\n    \n    # --- Parameters ---\n    a = 1.40  # Carbon-carbon bond length (Å)\n    t0 = -2.50  # Nearest-neighbor hopping (eV)\n    U = 6.00  # On-site repulsion (eV)\n    c = 0.10  # Through-space coupling prefactor (dimensionless)\n    beta = 1.50  # Decay constant (Å⁻¹)\n    \n    # --- Numerical Settings ---\n    m = 0.50  # Damping factor for SCF mixing\n    eps = 1e-10  # Convergence tolerance for site populations\n    N_it_max = 10000  # Maximum number of SCF iterations\n    \n    # --- System Configuration ---\n    N_alpha = 2  # Number of alpha electrons\n    N_beta = 1   # Number of beta electrons\n    N_sites = 3  # Number of sites in the model\n    \n    # --- Test Suite ---\n    theta_degrees = [180.0, 150.0, 120.0, 100.0, 90.0]\n    \n    # --- Reference distance for t13 calculation ---\n    R_ref = 2.0 * a * np.sin(np.deg2rad(60.0))\n\n    results = []\n\n    for theta_deg in theta_degrees:\n        # --- 1. Set up the one-electron Hamiltonian for the current angle ---\n        theta_rad = np.deg2rad(theta_deg)\n        R13 = 2.0 * a * np.sin(theta_rad / 2.0)\n        t13 = np.sign(t0) * c * np.abs(t0) * np.exp(-beta * (R13 - R_ref))\n        \n        T = np.zeros((N_sites, N_sites))\n        T[0, 1] = T[1, 0] = t0\n        T[1, 2] = T[2, 1] = t0\n        T[0, 2] = T[2, 0] = t13\n\n        # --- 2. UHF-SCF Calculation ---\n        # Initial guess for site populations (based on Huckel non-bonding MO)\n        n_alpha = np.array([0.75, 0.5, 0.75])\n        n_beta = np.array([0.25, 0.5, 0.25])\n        \n        for i in range(N_it_max):\n            n_alpha_old = n_alpha.copy()\n            n_beta_old = n_beta.copy()\n            \n            # Construct Fock matrices\n            F_alpha = T + np.diag(U * (n_beta - 0.5))\n            F_beta = T + np.diag(U * (n_alpha - 0.5))\n            \n            # Diagonalize Fock matrices\n            eigvals_a, C_a = np.linalg.eigh(F_alpha)\n            eigvals_b, C_b = np.linalg.eigh(F_beta)\n            \n            # Form density matrices from occupied orbitals\n            C_occ_a = C_a[:, :N_alpha]\n            C_occ_b = C_b[:, :N_beta]\n            \n            P_alpha = C_occ_a @ C_occ_a.T\n            P_beta = C_occ_b @ C_occ_b.T\n            \n            # Calculate new site populations\n            n_alpha_new = np.diag(P_alpha)\n            n_beta_new = np.diag(P_beta)\n            \n            # Apply damping\n            n_alpha = (1 - m) * n_alpha_old + m * n_alpha_new\n            n_beta = (1 - m) * n_beta_old + m * n_beta_new\n            \n            # Check for convergence\n            error = max(np.max(np.abs(n_alpha - n_alpha_old)), \n                        np.max(np.abs(n_beta - n_beta_old)))\n            \n            if error < eps:\n                break\n        \n        # --- 3. Post-SCF: Calculate Spin Contamination ---\n        # After convergence, re-diagonalize one last time with final densities to get final MOs\n        F_alpha = T + np.diag(U * (n_beta - 0.5))\n        F_beta = T + np.diag(U * (n_alpha - 0.5))\n        eigvals_a, C_a = np.linalg.eigh(F_alpha)\n        eigvals_b, C_b = np.linalg.eigh(F_beta)\n        \n        C_occ_a = C_a[:, :N_alpha]\n        C_occ_b = C_b[:, :N_beta]\n\n        # Calculate overlap matrix between occupied alpha and beta orbitals\n        S_ab_occ = C_occ_a.T @ C_occ_b\n        \n        # Calculate sum of squared overlaps\n        sum_S_sq = np.sum(S_ab_occ**2)\n        \n        # Spin contamination Delta = <S^2> - S(S+1)\n        # For UHF, Delta = N_beta - sum_{p,q} |<psi_p^a | psi_q^b>|^2\n        delta = float(N_beta - sum_S_sq)\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2466609"}]}