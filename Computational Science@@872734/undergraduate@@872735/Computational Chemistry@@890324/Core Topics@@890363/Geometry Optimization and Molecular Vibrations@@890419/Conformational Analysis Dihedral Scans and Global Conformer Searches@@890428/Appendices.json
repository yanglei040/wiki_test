{"hands_on_practices": [{"introduction": "The fundamental unit of conformational analysis is the rotation around a single bond. This motion is not entirely free; it follows a periodic potential energy profile that can be elegantly described by a mathematical tool called a Fourier series. This exercise [@problem_id:2453297] allows you to work directly with this model, calculating rotational barriers from the series coefficients and building a concrete understanding of how these terms dictate the shape of the potential energy surface.", "problem": "You are asked to compare the rotational barriers about the central bonds in two small molecules within a unified and purely mathematical torsional model. For each molecule, the torsional potential energy about the specified dihedral angle $\\phi$ (in degrees) is represented by the truncated Fourier series\n$$\nE(\\phi) \\;=\\; \\sum_{k=1}^{K} V_{n_k} \\,\\bigl(1 - \\cos(n_k \\,\\phi)\\bigr),\n$$\nwhere $n_k$ are positive integers and $V_{n_k}$ are nonnegative real coefficients in $\\mathrm{kJ\\,mol^{-1}}$. The rotational barrier $\\Delta E$ for a given molecule is defined as\n$$\n\\Delta E \\;=\\; \\max_{\\phi \\in [0^\\circ,\\,360^\\circ)} E(\\phi) \\;-\\; \\min_{\\phi \\in [0^\\circ,\\,360^\\circ)} E(\\phi),\n$$\nand must be expressed in $\\mathrm{kJ\\,mol^{-1}}$.\n\nYou will compute, for each test case, the difference\n$$\n\\Delta \\;=\\; \\Delta E_{\\mathrm{DMDS}} \\;-\\; \\Delta E_{\\mathrm{H_2O_2}},\n$$\nwhere $\\Delta E_{\\mathrm{DMDS}}$ is the rotational barrier for the $\\,\\mathrm{C\\!-\\!S\\!-\\!S\\!-\\!C}\\,$ torsion in dimethyl disulfide and $\\Delta E_{\\mathrm{H_2O_2}}$ is the rotational barrier for the $\\,\\mathrm{C\\!-\\!O\\!-\\!O\\!-\\!C}\\,$ torsion in hydrogen peroxide, both modeled by the same functional form $E(\\phi)$ above with the molecule-specific parameter sets.\n\nAngle input must be in degrees, $\\phi \\in [0^\\circ,\\,360^\\circ)$, and energies must be in $\\mathrm{kJ\\,mol^{-1}}$. Report each $\\Delta$ rounded to $3$ decimal places.\n\nTest Suite:\nFor each test case, two parameter sets are provided: one for dimethyl disulfide (DMDS) and one for hydrogen peroxide ($\\mathrm{H_2O_2}$). Each set is a finite list of pairs $(n, V)$ meaning the term $V\\,(1-\\cos(n\\,\\phi))$ contributes to $E(\\phi)$.\n\n- Test Case $1$ (general comparison):\n  - DMDS terms: $\\bigl[(1, 10.0)\\bigr]$.\n  - $\\mathrm{H_2O_2}$ terms: $\\bigl[(1, 8.0)\\bigr]$.\n\n- Test Case $2$ (equality case):\n  - DMDS terms: $\\bigl[(1, 5.0)\\bigr]$.\n  - $\\mathrm{H_2O_2}$ terms: $\\bigl[(1, 5.0)\\bigr]$.\n\n- Test Case $3$ (edge case with zero barrier versus nonzero):\n  - DMDS terms: $\\bigl[\\,\\bigr]$ (no terms, meaning $E(\\phi) = 0$ for all $\\phi$).\n  - $\\mathrm{H_2O_2}$ terms: $\\bigl[(2, 3.0)\\bigr]$.\n\n- Test Case $4$ (odd-harmonic multi-term comparison):\n  - DMDS terms: $\\bigl[(1, 6.0), (3, 2.0)\\bigr]$.\n  - $\\mathrm{H_2O_2}$ terms: $\\bigl[(1, 4.0), (3, 1.0)\\bigr]$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the scalar $\\Delta$ for the corresponding test case rounded to $3$ decimal places, for example\n$$\n[\\Delta_1,\\Delta_2,\\Delta_3,\\Delta_4].\n$$", "solution": "We model torsional rotation about a single bond by a truncated Fourier series\n$$\nE(\\phi)\\;=\\;\\sum_{k=1}^{K} V_{n_k}\\,\\bigl(1-\\cos(n_k\\,\\phi)\\bigr),\n$$\nwith $\\phi$ in degrees and $V_{n_k}$ in $\\mathrm{kJ\\,mol^{-1}}$. This functional form arises from symmetry and periodicity of dihedral rotations, where integer harmonics $n_k$ encode the periodicity of steric and electronic interactions. The rotational barrier $\\Delta E$ is, by definition,\n$$\n\\Delta E \\;=\\; \\max_{\\phi\\in[0^\\circ,360^\\circ)} E(\\phi) \\;-\\; \\min_{\\phi\\in[0^\\circ,360^\\circ)}E(\\phi),\n$$\nwhich captures the height of the highest transition state along a full $360^\\circ$ rotation relative to the global minimum.\n\nKey properties of the chosen form:\n- For any integer $n$, $\\cos(n\\,\\phi)$ attains $+1$ at $\\phi = 0^\\circ$; thus $E(0^\\circ)=\\sum_k V_{n_k}(1-1)=0$. Hence $\\min_{\\phi}E(\\phi)\\le 0$. Because each term $V_{n}(1-\\cos(n\\phi))\\ge 0$, we also have $E(\\phi)\\ge 0$ for all $\\phi$, so the global minimum is exactly $E_{\\min}=0$ at $\\phi=0^\\circ$ (and at any $\\phi$ where all $n_k\\phi$ are integer multiples of $360^\\circ$).\n- For odd harmonics $n$ and $\\phi=180^\\circ$, we have $\\cos(n\\,180^\\circ)=\\cos(180^\\circ)= -1$ when $n$ is odd, giving $1-\\cos(n\\,\\phi)=2$ for each odd term at $\\phi=180^\\circ$. Thus with only odd harmonics present, the global maximum occurs at $\\phi=180^\\circ$ with $E_{\\max}=2\\sum_{\\text{odd }n}V_n$ and the barrier $\\Delta E=2\\sum_{\\text{odd }n}V_n$ since $E_{\\min}=0$.\n- For even harmonics $n$ and $\\phi=90^\\circ$, we have $\\cos(n\\,90^\\circ)=\\cos(180^\\circ)= -1$ when $n$ is even, hence $1-\\cos(n\\,\\phi)=2$ for each even term at $\\phi=90^\\circ$. Thus with only even harmonics present, $E_{\\max}=2\\sum_{\\text{even }n}V_n$ and $\\Delta E=2\\sum_{\\text{even }n}V_n$.\n- With a mixture of odd and even harmonics, the angle that maximizes $E(\\phi)$ need not make all $\\cos(n\\phi)$ equal to $-1$ simultaneously; in that general case a numerical maximization over $\\phi\\in[0^\\circ,360^\\circ)$ is warranted. In the present test suite, each case is constructed so that a closed-form reasoning is possible.\n\nWe now evaluate each test case.\n\n- Test Case $1$:\n  - DMDS: terms $\\bigl[(1, 10.0)\\bigr]$. Only the $n=1$ odd harmonic contributes, so\n    $$\n    \\Delta E_{\\mathrm{DMDS}} \\;=\\; 2\\,V_1 \\;=\\; 2\\times 10.0 \\;=\\; 20.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n  - $\\mathrm{H_2O_2}$: terms $\\bigl[(1, 8.0)\\bigr]$, only $n=1$ odd harmonic, hence\n    $$\n    \\Delta E_{\\mathrm{H_2O_2}} \\;=\\; 2\\,V_1 \\;=\\; 2\\times 8.0 \\;=\\; 16.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n  - Difference:\n    $$\n    \\Delta \\;=\\; 20.0 - 16.0 \\;=\\; 4.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n\n- Test Case $2$:\n  - DMDS: terms $\\bigl[(1, 5.0)\\bigr]$, odd-only, so $\\Delta E_{\\mathrm{DMDS}} = 2\\times 5.0 = 10.0\\;\\mathrm{kJ\\,mol^{-1}}$.\n  - $\\mathrm{H_2O_2}$: terms $\\bigl[(1, 5.0)\\bigr]$, odd-only, so $\\Delta E_{\\mathrm{H_2O_2}} = 2\\times 5.0 = 10.0\\;\\mathrm{kJ\\,mol^{-1}}$.\n  - Difference:\n    $$\n    \\Delta \\;=\\; 10.0 - 10.0 \\;=\\; 0.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n\n- Test Case $3$:\n  - DMDS: no terms, $E(\\phi)=0$ for all $\\phi$, so $\\Delta E_{\\mathrm{DMDS}}=0.0\\;\\mathrm{kJ\\,mol^{-1}}$.\n  - $\\mathrm{H_2O_2}$: terms $\\bigl[(2, 3.0)\\bigr]$, even-only, so $\\Delta E_{\\mathrm{H_2O_2}} = 2\\times 3.0 = 6.0\\;\\mathrm{kJ\\,mol^{-1}}$.\n  - Difference:\n    $$\n    \\Delta \\;=\\; 0.0 - 6.0 \\;=\\; -6.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n\n- Test Case $4$:\n  - DMDS: terms $\\bigl[(1, 6.0), (3, 2.0)\\bigr]$, both odd, so\n    $$\n    \\Delta E_{\\mathrm{DMDS}} \\;=\\; 2\\,(6.0 + 2.0) \\;=\\; 16.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n  - $\\mathrm{H_2O_2}$: terms $\\bigl[(1, 4.0), (3, 1.0)\\bigr]$, both odd, so\n    $$\n    \\Delta E_{\\mathrm{H_2O_2}} \\;=\\; 2\\,(4.0 + 1.0) \\;=\\; 10.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n  - Difference:\n    $$\n    \\Delta \\;=\\; 16.0 - 10.0 \\;=\\; 6.0\\;\\mathrm{kJ\\,mol^{-1}}.\n    $$\n\nCollecting the rounded differences to $3$ decimal places in the required format yields\n$$\n[4.000,0.000,-6.000,6.000].\n$$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef torsion_energy(phi_deg: np.ndarray, terms):\n    \"\"\"\n    Compute E(phi) = sum V_n * (1 - cos(n * phi))\n    phi_deg: numpy array of angles in degrees\n    terms: list of (n, V) pairs, with n integer, V in kJ/mol\n    Returns: numpy array E(phi) in kJ/mol\n    \"\"\"\n    if not terms:\n        return np.zeros_like(phi_deg, dtype=float)\n    phi_rad = np.deg2rad(phi_deg)\n    E = np.zeros_like(phi_rad, dtype=float)\n    for n, V in terms:\n        E += V * (1.0 - np.cos(n * phi_rad))\n    return E\n\ndef rotational_barrier(terms):\n    \"\"\"\n    Rotational barrier Delta E = max_phi E(phi) - min_phi E(phi)\n    with phi in [0, 360) degrees.\n    \"\"\"\n    # Dense grid to capture maxima/minima reliably\n    phi_grid = np.linspace(0.0, 360.0, 36001, endpoint=False)  # 0.01-degree resolution\n    E = torsion_energy(phi_grid, terms)\n    return float(E.max() - E.min())\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple: (terms_DMDS, terms_H2O2)\n    # terms is a list of (n, V_kJmol) pairs.\n    test_cases = [\n        ([(1, 10.0)], [(1, 8.0)]),                  # Test 1\n        ([(1, 5.0)], [(1, 5.0)]),                   # Test 2\n        ([], [(2, 3.0)]),                           # Test 3\n        ([(1, 6.0), (3, 2.0)], [(1, 4.0), (3, 1.0)])# Test 4\n    ]\n\n    results = []\n    for terms_dmds, terms_h2o2 in test_cases:\n        barrier_dmds = rotational_barrier(terms_dmds)\n        barrier_h2o2 = rotational_barrier(terms_h2o2)\n        delta = barrier_dmds - barrier_h2o2\n        results.append(f\"{delta:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2453297"}, {"introduction": "A molecule's final shape is often a compromise between competing forces. In this practice [@problem_id:2453243], we explore this principle by modeling the twist in biphenyl-like molecules, where electronic effects favor a flat structure but steric hindrance between atoms forces it to rotate. By combining a torsional energy term with a repulsive potential, you will see firsthand how changing molecular geometry alters the balance of forces and, consequently, the molecule's most stable conformation.", "problem": "You are asked to model how replacing the central carbon–carbon bond in biphenyl with a silicon–silicon bond affects the torsional potential and the preferred twist angle between the two rings. Consider a coarse-grained intramolecular energy model that resolves the dihedral angle $\\phi$ about the central bond and two opposing ortho–ortho steric sites (one on each ring) that move on coaxial circles centered on the bond axis. The total potential energy as a function of the dihedral angle $\\phi$ (in radians) is defined as\n$$\nV_{\\text{tot}}(\\phi) \\;=\\; V_{\\text{tors}}(\\phi) \\;+\\; N \\, V_{\\text{rep}}(d(\\phi)) \\, ,\n$$\nwhere $N$ is the number of identical steric interacting pairs, $V_{\\text{tors}}(\\phi)$ is a torsional term capturing conjugative preferences, $V_{\\text{rep}}(d)$ is a purely repulsive nonbonded term as a function of the inter-site distance $d$, and $d(\\phi)$ is the geometric distance between the two steric sites as the rings rotate.\n\nUse the following forms and definitions.\n\n1) Torsional term:\n$$\nV_{\\text{tors}}(\\phi) \\;=\\; k_2 \\,\\bigl(1 - \\cos(2\\phi)\\bigr) \\, ,\n$$\nwith $k_2$ in kilojoules per mole (kJ/mol).\n\n2) Geometry of the steric sites: Let each steric site lie on a circle of radius $a$ (in ångström, Å) about the bond axis, with the two rings separated by an axial distance $h$ (in Å). The inter-site distance as a function of $\\phi$ is\n$$\nd(\\phi) \\;=\\; \\sqrt{\\, h^2 + 2 a^2 \\bigl(1 - \\cos \\phi \\bigr) \\,} \\, .\n$$\n\n3) Repulsive nonbonded interaction: Use the Weeks–Chandler–Andersen (WCA) repulsive form derived from the Lennard–Jones $12$–$6$ potential with parameters $\\varepsilon$ (in kJ/mol) and $\\sigma$ (in Å):\n$$\nV_{\\text{WCA}}(d) \\;=\\; \n\\begin{cases}\n4\\varepsilon \\left[ \\left(\\dfrac{\\sigma}{d}\\right)^{12} - \\left(\\dfrac{\\sigma}{d}\\right)^{6} \\right] + \\varepsilon \\,, & d \\le d_c \\\\\n0 \\,, & d > d_c\n\\end{cases}\n\\quad \\text{with} \\quad d_c \\;=\\; 2^{1/6} \\sigma \\, .\n$$\nSet $V_{\\text{rep}}(d) = V_{\\text{WCA}}(d)$.\n\nFor each specified parameter set below, determine the preferred twist angle $\\phi^\\star$ that minimizes $V_{\\text{tot}}(\\phi)$ over $\\phi \\in [0,\\pi]$ and the torsional barrier height $\\Delta V$ defined as\n$$\n\\Delta V \\;=\\; \\max_{\\phi \\in [0,\\pi]} V_{\\text{tot}}(\\phi) \\;-\\; \\min_{\\phi \\in [0,\\pi]} V_{\\text{tot}}(\\phi) \\, .\n$$\n\nAngle unit requirement: report $\\phi^\\star$ in degrees. Energy unit requirement: report $\\Delta V$ in kilojoules per mole.\n\nRounding requirement: report $\\phi^\\star$ rounded to one decimal place and $\\Delta V$ rounded to three decimal places.\n\nTest suite (each case is $(k_2,\\varepsilon,\\sigma,a,h,N)$ with lengths in Å and energies in kJ/mol):\n- Case A (biphenyl-like, central C–C): $(2.5,\\, 0.15,\\, 2.4,\\, 2.1,\\, 1.47,\\, 2)$.\n- Case B (diphenyl-disilane-like, central Si–Si): $(0.5,\\, 0.15,\\, 2.4,\\, 2.3,\\, 2.34,\\, 2)$.\n- Case C (no steric repulsion): $(1.2,\\, 0.0,\\, 2.4,\\, 2.0,\\, 1.47,\\, 2)$.\n- Case D (strong steric crowding): $(0.5,\\, 0.3,\\, 2.4,\\, 2.5,\\, 1.2,\\, 2)$.\n\nYour program must compute, for each case, the pair $(\\phi^\\star,\\Delta V)$ according to the definitions above and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, aggregating all cases in order as $[\\phi^\\star_{\\text{A}},\\Delta V_{\\text{A}},\\phi^\\star_{\\text{B}},\\Delta V_{\\text{B}},\\phi^\\star_{\\text{C}},\\Delta V_{\\text{C}},\\phi^\\star_{\\text{D}},\\Delta V_{\\text{D}}]$. The angles must be in degrees (rounded to one decimal place) and the energies must be in kilojoules per mole (rounded to three decimal places). No other text should be printed.", "solution": "The problem requires the determination of the preferred twist angle $\\phi^\\star$ and the torsional barrier height $\\Delta V$ for a given intramolecular potential energy function $V_{\\text{tot}}(\\phi)$. The analysis must be conducted for four distinct parameter sets.\n\nThe total potential energy is given by the sum of a torsional term and a steric repulsion term:\n$$\nV_{\\text{tot}}(\\phi) = V_{\\text{tors}}(\\phi) + N V_{\\text{rep}}(d(\\phi))\n$$\nThe analysis will be performed over the specified domain for the dihedral angle, $\\phi \\in [0, \\pi]$ radians.\n\nThe component functions are defined as follows:\n1.  **Torsional Potential:** $V_{\\text{tors}}(\\phi) = k_2 (1 - \\cos(2\\phi))$. This term models the electronic preference for planarity. For $k_2 > 0$, it has minima at $\\phi=0$ and $\\phi=\\pi$, corresponding to coplanar conformations, and a maximum at $\\phi=\\pi/2$, the perpendicular conformation.\n\n2.  **Inter-site Distance:** $d(\\phi) = \\sqrt{h^2 + 2a^2(1 - \\cos\\phi)}$. This function gives the distance between two opposing steric sites. The distance is minimal at $\\phi=0$ ($d(0)=h$) and maximal at $\\phi=\\pi$ ($d(\\pi)=\\sqrt{h^2+4a^2}$).\n\n3.  **Repulsive Potential:** The Weeks–Chandler–Andersen (WCA) potential, $V_{\\text{rep}}(d) = V_{\\text{WCA}}(d)$, is defined as:\n    $$\n    V_{\\text{WCA}}(d) = \n    \\begin{cases}\n    4\\varepsilon \\left[ \\left(\\dfrac{\\sigma}{d}\\right)^{12} - \\left(\\dfrac{\\sigma}{d}\\right)^{6} \\right] + \\varepsilon \\,, & d \\le d_c \\\\\n    0 \\,, & d > d_c\n    \\end{cases}\n    $$\n    where $d_c = 2^{1/6}\\sigma$. The WCA potential is the repulsive part of the Lennard-Jones potential, shifted so that $V_{\\text{WCA}}(d) \\ge 0$ for all $d$. Consequently, the total potential $V_{\\text{tot}}(\\phi)$ is also non-negative, as $V_{\\text{tors}}(\\phi) \\ge 0$.\n\nThe quantities to be determined are:\n-   The preferred twist angle $\\phi^\\star$, which is the value of $\\phi \\in [0, \\pi]$ that minimizes $V_{\\text{tot}}(\\phi)$.\n-   The torsional barrier height $\\Delta V = \\max_{\\phi \\in [0,\\pi]} V_{\\text{tot}}(\\phi) - \\min_{\\phi \\in [0,\\pi]} V_{\\text{tot}}(\\phi)$.\n\nThe solution strategy is to perform a numerical search for the minimum and maximum of $V_{\\text{tot}}(\\phi)$ on the compact interval $[0, \\pi]$. This will be accomplished by discretizing the interval into a fine grid of points and evaluating the function at each point. This direct search method is robust for a one-dimensional problem.\n\nAn important analytical observation can be made for cases where steric repulsion is present ($\\varepsilon > 0$). At $\\phi=\\pi$:\n-   $V_{\\text{tors}}(\\pi) = k_2(1 - \\cos(2\\pi)) = 0$.\n-   The inter-site distance is $d(\\pi) = \\sqrt{h^2 + 4a^2}$. For all provided parameter sets (A, B, D), a direct calculation shows that $d(\\pi) > d_c = 2^{1/6}\\sigma$.\n-   Since $d(\\pi) > d_c$, the repulsive potential $V_{\\text{rep}}(d(\\pi))$ is zero.\n-   Therefore, $V_{\\text{tot}}(\\pi) = 0$.\n\nAs established that $V_{\\text{tot}}(\\phi) \\ge 0$ for all $\\phi$, the value $V_{\\text{tot}}(\\pi) = 0$ represents a global minimum. Thus, for Cases A, B, and D, the preferred angle is unambiguously $\\phi^\\star = \\pi$ radians, or $180.0^\\circ$.\n\nFor Case C, $\\varepsilon=0$, so $V_{\\text{rep}}(d) = 0$ for all $d$. The potential is purely torsional: $V_{\\text{tot}}(\\phi) = k_2 (1 - \\cos(2\\phi))$. This function has minima at $\\phi=0$ and $\\phi=\\pi$, where $V_{\\text{tot}}=0$. By convention, we select the smallest non-negative angle, so $\\phi^\\star=0.0^\\circ$.\n\nThe calculation proceeds as follows:\n\n**Case A: Biphenyl-like (C–C)**\nParameters: $(k_2, \\varepsilon, \\sigma, a, h, N) = (2.5, 0.15, 2.4, 2.1, 1.47, 2)$.\n-   $\\phi^\\star = 180.0^\\circ$.\n-   $V_{\\text{min}} = V_{\\text{tot}}(\\pi) = 0$ kJ/mol.\n-   The maximum of the potential occurs at $\\phi=0$ due to severe steric clash ($h=1.47\\,\\text{Å} < d_c \\approx 2.694\\,\\text{Å}$).\n    $V_{\\text{max}} = V_{\\text{tot}}(0) = 2 \\times V_{\\text{WCA}}(1.47)$.\n    $V_{\\text{WCA}}(1.47) = 4(0.15)\\left[ \\left(\\frac{2.4}{1.47}\\right)^{12} - \\left(\\frac{2.4}{1.47}\\right)^{6} \\right] + 0.15 \\approx 204.884$ kJ/mol.\n    $V_{\\text{max}} \\approx 2 \\times 204.884 = 409.769$ kJ/mol.\n-   $\\Delta V = V_{\\text{max}} - V_{\\text{min}} = 409.769$ kJ/mol.\n\n**Case B: Diphenyl-disilane-like (Si–Si)**\nParameters: $(k_2, \\varepsilon, \\sigma, a, h, N) = (0.5, 0.15, 2.4, 2.3, 2.34, 2)$.\n-   $\\phi^\\star = 180.0^\\circ$.\n-   $V_{\\text{min}} = V_{\\text{tot}}(\\pi) = 0$ kJ/mol.\n-   The potential at $\\phi=0$ is $V_{\\text{tot}}(0) \\approx 0.524$ kJ/mol. The torsional potential maximum is at $\\phi=\\pi/2$, with value $V_{\\text{tors}}(\\pi/2) = 2k_2 = 1.0$ kJ/mol. At this angle, $d(\\pi/2) \\approx 4.007\\,\\text{Å} > d_c$, so $V_{\\text{rep}}=0$. The global maximum is thus $V_{\\text{max}} = V_{\\text{tot}}(\\pi/2) = 1.0$ kJ/mol.\n-   $\\Delta V = V_{\\text{max}} - V_{\\text{min}} = 1.000$ kJ/mol.\n\n**Case C: No steric repulsion**\nParameters: $(k_2, \\varepsilon, \\sigma, a, h, N) = (1.2, 0.0, 2.4, 2.0, 1.47, 2)$.\n-   $V_{\\text{tot}}(\\phi) = 1.2(1 - \\cos(2\\phi))$.\n-   The minima are at $\\phi=0$ and $\\phi=\\pi$. We choose $\\phi^\\star = 0.0^\\circ$.\n-   $V_{\\text{min}} = 0$ kJ/mol.\n-   The maximum is at $\\phi=\\pi/2$, where $V_{\\text{max}} = 1.2(1 - (-1)) = 2.4$ kJ/mol.\n-   $\\Delta V = V_{\\text{max}} - V_{\\text{min}} = 2.400$ kJ/mol.\n\n**Case D: Strong steric crowding**\nParameters: $(k_2, \\varepsilon, \\sigma, a, h, N) = (0.5, 0.3, 2.4, 2.5, 1.2, 2)$.\n-   $\\phi^\\star = 180.0^\\circ$.\n-   $V_{\\text{min}} = V_{\\text{tot}}(\\pi) = 0$ kJ/mol.\n-   The maximum occurs at $\\phi=0$ due to extreme steric repulsion ($h=1.2\\,\\text{Å} \\ll d_c$).\n    $V_{\\text{max}} = V_{\\text{tot}}(0) = 2 \\times V_{\\text{WCA}}(1.2)$.\n    $V_{\\text{WCA}}(1.2) = 4(0.3)\\left[ \\left(\\frac{2.4}{1.2}\\right)^{12} - \\left(\\frac{2.4}{1.2}\\right)^{6} \\right] + 0.3 = 1.2(2^{12} - 2^6)+0.3 = 4838.7$ kJ/mol.\n    $V_{\\text{max}} = 2 \\times 4838.7 = 9677.4$ kJ/mol.\n-   $\\Delta V = V_{\\text{max}} - V_{\\text{min}} = 9677.400$ kJ/mol.\n\nThese results are computed numerically to ensure precision according to the problem specification.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Solves the conformational analysis problem for four test cases.\n    \"\"\"\n    \n    # Test cases are given as tuples of (k2, epsilon, sigma, a, h, N)\n    # Units are kJ/mol for energies and Angstroms for lengths.\n    test_cases = [\n        # Case A (biphenyl-like, C-C)\n        (2.5, 0.15, 2.4, 2.1, 1.47, 2),\n        # Case B (diphenyl-disilane-like, Si-Si)\n        (0.5, 0.15, 2.4, 2.3, 2.34, 2),\n        # Case C (no steric repulsion)\n        (1.2, 0.0, 2.4, 2.0, 1.47, 2),\n        # Case D (strong steric crowding)\n        (0.5, 0.3, 2.4, 2.5, 1.2, 2)\n    ]\n\n    results = []\n    for params in test_cases:\n        phi_star_deg, delta_v = calculate_potential_properties(params)\n        results.extend([phi_star_deg, delta_v])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_potential_properties(params):\n    \"\"\"\n    Calculates the preferred twist angle (phi_star) and torsional barrier (delta_v)\n    for a given set of potential parameters.\n\n    Args:\n        params (tuple): A tuple containing (k2, eps, sigma, a, h, N).\n\n    Returns:\n        tuple: A tuple containing (phi_star_deg, delta_v) rounded as required.\n    \"\"\"\n    k2, eps, sigma, a, h, N = params\n    \n    # The cutoff distance for the WCA potential\n    d_c = 2**(1/6) * sigma\n\n    # Create a fine grid for the dihedral angle phi from 0 to pi.\n    # A high number of points ensures accuracy for finding optima.\n    phi_rad = np.linspace(0, np.pi, 20001)\n\n    # Calculate the torsional potential term V_tors(phi)\n    v_tors = k2 * (1 - np.cos(2 * phi_rad))\n\n    # Calculate the inter-site distance d(phi)\n    d = np.sqrt(h**2 + 2 * a**2 * (1 - np.cos(phi_rad)))\n\n    # Calculate the WCA repulsive potential V_rep(d)\n    # Initialize v_rep array with zeros.\n    v_rep = np.zeros_like(d)\n    \n    # Create a boolean mask for distances within the WCA cutoff\n    mask = d <= d_c\n    \n    # Only calculate potential for distances where it's non-zero\n    # to avoid unnecessary computation and potential warnings.\n    d_sub = d[mask]\n    if d_sub.size > 0:\n        # Ratio sigma/d for the relevant points\n        ratio = sigma / d_sub\n        v_rep[mask] = 4 * eps * (ratio**12 - ratio**6) + eps\n\n    # Calculate the total potential energy V_tot(phi)\n    v_total = v_tors + N * v_rep\n\n    # Find the minimum and maximum of the total potential energy\n    v_min = np.min(v_total)\n    v_max = np.max(v_total)\n\n    # Find the index of the minimum to get the corresponding angle phi_star\n    min_idx = np.argmin(v_total)\n    phi_star_rad = phi_rad[min_idx]\n    \n    # Convert phi_star to degrees\n    phi_star_deg = np.rad2deg(phi_star_rad)\n\n    # Calculate the torsional barrier height\n    delta_v = v_max - v_min\n\n    # Round the results to the specified number of decimal places\n    phi_star_deg_rounded = round(phi_star_deg, 1)\n    delta_v_rounded = round(delta_v, 3)\n\n    return phi_star_deg_rounded, delta_v_rounded\n\n# Run the solver\nsolve()\n```", "id": "2453243"}, {"introduction": "When a molecule has multiple rotatable bonds, finding its most stable three-dimensional shape requires a \"global conformer search\" across a high-dimensional energy landscape. The accuracy of this search depends critically on the underlying energy model. This practice [@problem_id:2453240] simulates a full conformer search for a flexible alkane chain, where you will build the 3D structure from its internal coordinates and discover how a subtle change in the energy model—designed to mimic a known theoretical artifact—can dramatically alter the predicted lowest-energy structure.", "problem": "You are given a simplified, first-principles-inspired internal-coordinate model of an $n$-alkane carbon backbone with fixed carbon–carbon bond length $b$ and fixed carbon–carbon–carbon valence angle $\\theta$. A conformer is specified by its sequence of backbone dihedral angles $\\{\\phi_i\\}$, where the index $i$ runs over the $N-3$ rotatable dihedrals of an $N$-carbon linear chain. In this model, the total potential energy of a conformer is defined as the sum of a torsional term and a nonbonded term. Two energy models are to be compared: a reference model and an artifact-prone model that simulates a known density functional theory (DFT) artifact by over-stabilizing consecutive same-sense gauche rotations.\n\nGeometry and units:\n- The number of carbon atoms is $N$ (an integer with $N \\ge 4$).\n- The bond length is $b = 1.54\\,\\mathrm{\\AA}$.\n- The valence angle is $\\theta = 112^\\circ$.\n- The dihedrals are restricted to the discrete set $\\{-60^\\circ, 60^\\circ, 180^\\circ\\}$ and must be reported in degrees.\n- All energies must be expressed in $\\mathrm{kcal/mol}$.\n- All angles must be interpreted and reported in degrees.\n\nCoordinate construction from internal coordinates:\n- Place the first three carbon atoms at positions $\\mathbf{r}_0 = (0,0,0)$, $\\mathbf{r}_1 = (b,0,0)$, and $\\mathbf{r}_2 = \\left(b + b\\cos(\\pi-\\theta),\\; b\\sin(\\pi-\\theta),\\; 0\\right)$.\n- For each subsequent atom index $k$ with $k \\in \\{3,\\dots,N-1\\}$, given the previous three positions $\\mathbf{r}_{k-3}, \\mathbf{r}_{k-2}, \\mathbf{r}_{k-1}$ and the dihedral $\\phi_{k-3}$ (in radians), construct $\\mathbf{r}_k$ using\n$$\n\\mathbf{e}_1 = \\frac{\\mathbf{r}_{k-2} - \\mathbf{r}_{k-3}}{\\lVert \\mathbf{r}_{k-2} - \\mathbf{r}_{k-3}\\rVert},\\quad\n\\mathbf{e}_2 = \\frac{\\mathbf{r}_{k-1} - \\mathbf{r}_{k-2}}{\\lVert \\mathbf{r}_{k-1} - \\mathbf{r}_{k-2}\\rVert},\\quad\n\\mathbf{n}_1 = \\frac{\\mathbf{e}_1 \\times \\mathbf{e}_2}{\\lVert \\mathbf{e}_1 \\times \\mathbf{e}_2\\rVert},\\quad\n\\mathbf{n}_2 = \\mathbf{e}_2 \\times \\mathbf{n}_1,\n$$\nand\n$$\n\\mathbf{r}_k = \\mathbf{r}_{k-1} + b\\left[-\\cos\\theta\\;\\mathbf{e}_2 + \\sin\\theta\\left(\\cos\\phi_{k-3}\\;\\mathbf{n}_2 + \\sin\\phi_{k-3}\\;\\mathbf{n}_1\\right)\\right].\n$$\n\nReference energy model:\n- Torsional term:\n$$\nE_{\\mathrm{tors}}(\\{\\phi_i\\}) = \\sum_{i=0}^{N-4} \\frac{V_3}{2}\\left(1 + \\cos(3\\phi_i)\\right),\n$$\nwith $V_3 = 3.0\\,\\mathrm{kcal/mol}$ and $\\phi_i$ in radians inside the cosine.\n- Nonbonded term (Lennard–Jones $12$–$6$ between nonbonded carbon pairs only):\n$$\nE_{\\mathrm{nb}}(\\{\\mathbf{r}_j\\}) = \\sum_{0 \\le i < j \\le N-1 \\atop |i-j| > 2} 4\\epsilon\\left[\\left(\\frac{\\sigma}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma}{r_{ij}}\\right)^6\\right],\n$$\nwith $\\epsilon = 0.093\\,\\mathrm{kcal/mol}$, $\\sigma = 3.75\\,\\mathrm{\\AA}$, and $r_{ij} = \\lVert \\mathbf{r}_j - \\mathbf{r}_i\\rVert$ in $\\mathrm{\\AA}$.\n\nArtifact-prone energy model:\n- Uses the same $E_{\\mathrm{tors}}$ and $E_{\\mathrm{nb}}$ as above.\n- Adds an artifact stabilization term that models over-stabilization of consecutive same-sense gauche rotations:\n$$\nE_{\\mathrm{art}}(\\{\\phi_i\\}) = E_{\\mathrm{tors}} + E_{\\mathrm{nb}} - \\delta\\; S(\\{\\phi_i\\}),\n$$\nwhere $\\delta = 1.2\\,\\mathrm{kcal/mol}$ and $S(\\{\\phi_i\\})$ counts the number of adjacent dihedral pairs $(\\phi_i,\\phi_{i+1})$ such that both are $+60^\\circ$ or both are $-60^\\circ$.\n\nDefinitions and tasks:\n- By definition, the \"hockey stick\" pattern is present in a conformer if there exists at least one index $i$ such that $\\phi_i = \\phi_{i+1} = 60^\\circ$ or $\\phi_i = \\phi_{i+1} = -60^\\circ$.\n- For a given $N$, a global conformer search is the task of finding the dihedral sequence $\\{\\phi_i\\}$ within the discrete set $\\{-60^\\circ, 60^\\circ, 180^\\circ\\}$ that minimizes the total energy under a specified model.\n- For each specified $N$, determine:\n  - The global minimum dihedral sequence and minimum energy for the reference model.\n  - The global minimum dihedral sequence and minimum energy for the artifact-prone model.\n  - Whether the artifact-prone model predicts a hockey stick pattern while the reference model does not (a boolean).\n\nAngle unit specification:\n- You must interpret and report all dihedral angles in degrees. Internally, any trigonometric operations must use radians, but reported angles must remain in degrees.\n\nEnergy unit specification:\n- Report energies in $\\mathrm{kcal/mol}$, rounded to three decimal places.\n\nTest suite:\n- Use the following values of $N$:\n  - $N = 4$ (boundary case with a single dihedral),\n  - $N = 6$,\n  - $N = 7$,\n  - $N = 8$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list of per-case results, enclosed in square brackets.\n- For each test case, output a list with the following elements in order:\n  - A boolean indicating whether the artifact-prone model predicts a hockey stick global minimum while the reference model does not.\n  - The reference-model minimum energy (a float) rounded to three decimals.\n  - The artifact-prone-model minimum energy (a float) rounded to three decimals.\n  - The reference-model minimum-energy dihedral sequence as a list of integers (in degrees).\n  - The artifact-prone-model minimum-energy dihedral sequence as a list of integers (in degrees).\n- Thus, the overall output is a list of four such lists, one for each $N \\in \\{4,6,7,8\\}$, for example:\n$[\\,[\\text{bool}, E_{\\mathrm{ref}}, E_{\\mathrm{art}}, [\\phi^{\\mathrm{ref}}_0,\\dots],[\\phi^{\\mathrm{art}}_0,\\dots]],\\dots\\,]$.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of molecular mechanics, providing a well-defined, self-contained, and objective computational chemistry task. The model, though simplified, is based on standard energy functions (torsional, Lennard-Jones) and coordinate generation methods used in conformational analysis. The described \"artifact\" realistically mimics a known issue in certain quantum chemistry methods. The problem is well-posed, as the search for a global minimum is over a finite, discrete set of conformers, guaranteeing a solution can be found via exhaustive enumeration.\n\nThe solution requires finding the minimum-energy conformer for an $N$-atom linear alkane chain under two different energy models. A conformer is defined by a sequence of $N-3$ dihedral angles $\\{\\phi_i\\}$, where each $\\phi_i$ is restricted to the set $\\{-60^\\circ, 60^\\circ, 180^\\circ\\}$. The total number of possible conformers for a given $N$ is $3^{N-3}$. For the specified values of $N \\in \\{4, 6, 7, 8\\}$, the search spaces are of size $3^1=3$, $3^3=27$, $3^4=81$, and $3^5=243$, respectively. These are small enough to permit a brute-force search over all possibilities to find the true global minimum.\n\nThe core of the procedure is to calculate the energy for each possible conformer. This involves several steps for a given dihedral sequence $\\{\\phi_i\\}_{i=0}^{N-4}$:\n\n1.  **Cartesian Coordinate Generation**: The three-dimensional structure corresponding to the dihedral sequence must be constructed. Following the problem, the first three atoms are placed in the $xy$-plane: $\\mathbf{r}_0 = (0,0,0)$, $\\mathbf{r}_1 = (b,0,0)$, and $\\mathbf{r}_2 = \\left(b - b\\cos\\theta,\\; b\\sin\\theta,\\; 0\\right)$, where $b=1.54\\,\\mathrm{\\AA}$ is the bond length and $\\theta=112^\\circ$ is the valence angle. Subsequent atomic positions $\\mathbf{r}_k$ for $k \\in \\{3, \\dots, N-1\\}$ are generated iteratively using the provided formula derived from the Z-matrix or Natural Extension of Reference Frame (NERF) method. This requires calculating a local coordinate system based on the three preceding atoms $(\\mathbf{r}_{k-3}, \\mathbf{r}_{k-2}, \\mathbf{r}_{k-1})$ to place $\\mathbf{r}_k$ correctly according to the bond length $b$, valence angle $\\theta$, and the relevant dihedral angle $\\phi_{k-3}$. All angle parameters must be converted to radians for use in trigonometric functions.\n\n2.  **Reference Energy Calculation ($E_{\\mathrm{ref}}$)**: The total energy for the reference model is the sum of a torsional term and a nonbonded term, $E_{\\mathrm{ref}} = E_{\\mathrm{tors}} + E_{\\mathrm{nb}}$.\n    -   The torsional energy, $E_{\\mathrm{tors}}$, is summed over all $N-3$ dihedrals:\n        $$\n        E_{\\mathrm{tors}}(\\{\\phi_i\\}) = \\sum_{i=0}^{N-4} \\frac{V_3}{2}\\left(1 + \\cos(3\\phi_i)\\right)\n        $$\n        where $V_3 = 3.0\\,\\mathrm{kcal/mol}$. This potential form makes the *gauche* ($\\pm 60^\\circ$) and *anti* ($180^\\circ$) rotamers isoenergetic from a torsional perspective; their relative energies are determined by nonbonded interactions.\n    -   The nonbonded energy, $E_{\\mathrm{nb}}$, is calculated using a Lennard-Jones potential, summed over all pairs of atoms $(i, j)$ that are separated by more than two bonds (i.e., $|i-j| > 2$):\n        $$\n        E_{\\mathrm{nb}}(\\{\\mathbf{r}_k\\}) = \\sum_{0 \\le i < j \\le N-1, |i-j| > 2} 4\\epsilon\\left[\\left(\\frac{\\sigma}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma}{r_{ij}}\\right)^6\\right]\n        $$\n        with parameters $\\epsilon = 0.093\\,\\mathrm{kcal/mol}$ and $\\sigma = 3.75\\,\\mathrm{\\AA}$. The distance $r_{ij}$ is the Euclidean distance between atoms $\\mathbf{r}_i$ and $\\mathbf{r}_j$. This term accounts for steric repulsion and van der Waals attraction.\n\n3.  **Artifact-Prone Energy Calculation ($E_{\\mathrm{art}}$)**: This model adds a corrective term to the reference energy to simulate a known DFT artifact:\n    $$\n    E_{\\mathrm{art}}(\\{\\phi_i\\}) = E_{\\mathrm{ref}} - \\delta\\; S(\\{\\phi_i\\})\n    $$\n    The term $S(\\{\\phi_i\\})$ counts the number of occurrences of adjacent, same-sense *gauche* dihedrals, i.e., pairs $(\\phi_i, \\phi_{i+1})$ that are either $(60^\\circ, 60^\\circ)$ or $(-60^\\circ, -60^\\circ)$. A stabilization energy of $\\delta = 1.2\\,\\mathrm{kcal/mol}$ is applied for each such occurrence. These conformers exhibit a \"hockey stick\" or helical turn pattern.\n\nFor each $N$ in the test suite, an exhaustive search is performed. All $3^{N-3}$ conformers are generated. For each conformer, the energies $E_{\\mathrm{ref}}$ and $E_{\\mathrm{art}}$ are computed. The conformer and energy corresponding to the minimum for each model are stored. If multiple conformers are degenerate in energy, the first one encountered in the systematic enumeration is chosen.\n\nFinally, the results are compiled. For each $N$, we determine if the global minimum of the artifact-prone model exhibits the \"hockey stick\" pattern (i.e., $S > 0$) while the reference model's minimum does not. This boolean, along with the minimum energies and corresponding dihedral sequences for both models, forms the final output for that case, formatted as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Solves the conformational analysis problem for specified N-alkane chains.\n    \"\"\"\n    \n    # Define constants and parameters from the problem statement.\n    b = 1.54  # bond length in Angstrom\n    theta_deg = 112.0  # valence angle in degrees\n    theta_rad = np.deg2rad(theta_deg)\n    V3 = 3.0  # kcal/mol\n    epsilon = 0.093  # kcal/mol\n    sigma = 3.75  # Angstrom\n    delta = 1.2  # kcal/mol\n    \n    # Test cases for N\n    test_cases = [4, 6, 7, 8]\n    \n    # All possible dihedral angles in degrees\n    possible_phis = [-60, 60, 180]\n\n    def build_coords(dihedrals_rad, N):\n        \"\"\"Constructs Cartesian coordinates from internal coordinates.\"\"\"\n        coords = np.zeros((N, 3))\n        if N < 1:\n            return coords\n        coords[0] = np.array([0.0, 0.0, 0.0])\n        if N < 2:\n            return coords\n        coords[1] = np.array([b, 0.0, 0.0])\n        if N < 3:\n            return coords\n        coords[2] = np.array([b + b * np.cos(np.pi - theta_rad), b * np.sin(np.pi - theta_rad), 0.0])\n        \n        for k in range(3, N):\n            r_km3, r_km2, r_km1 = coords[k-3], coords[k-2], coords[k-1]\n            \n            e1 = (r_km2 - r_km3) / np.linalg.norm(r_km2 - r_km3)\n            e2 = (r_km1 - r_km2) / np.linalg.norm(r_km1 - r_km2)\n            \n            n1_unnormalized = np.cross(e1, e2)\n            # handle cases where e1 and e2 are collinear\n            norm_n1 = np.linalg.norm(n1_unnormalized)\n            if norm_n1 < 1e-9:\n                # If e1 and e2 are parallel, the local frame is ill-defined.\n                # A perpendicular can be constructed from e2 and an arbitrary vector.\n                arbitrary_vec = np.array([0.0, 0.0, 1.0])\n                if np.abs(np.dot(e2, arbitrary_vec)) > 0.999: # if e2 is along z-axis\n                    arbitrary_vec = np.array([0.0, 1.0, 0.0])\n                n1_unnormalized = np.cross(e2, arbitrary_vec)\n                norm_n1 = np.linalg.norm(n1_unnormalized)\n\n            n1 = n1_unnormalized / norm_n1\n            n2 = np.cross(e2, n1)\n            \n            phi = dihedrals_rad[k-3]\n            \n            displacement = b * (\n                -np.cos(theta_rad) * e2 +\n                np.sin(theta_rad) * (np.cos(phi) * n2 + np.sin(phi) * n1)\n            )\n            coords[k] = r_km1 + displacement\n            \n        return coords\n\n    def calc_E_tors(dihedrals_rad):\n        \"\"\"Calculates the torsional energy.\"\"\"\n        if len(dihedrals_rad) == 0:\n            return 0.0\n        return 0.5 * V3 * np.sum(1 + np.cos(3 * dihedrals_rad))\n\n    def calc_E_nb(coords, N):\n        \"\"\"Calculates the nonbonded Lennard-Jones energy.\"\"\"\n        energy = 0.0\n        for i in range(N):\n            for j in range(i + 1, N):\n                if j - i > 2:\n                    dist = np.linalg.norm(coords[j] - coords[i])\n                    if dist < 1e-6:\n                        return float('inf')\n                    sr6 = (sigma / dist)**6\n                    energy += 4 * epsilon * (sr6**2 - sr6)\n        return energy\n\n    def count_S(dihedrals_deg):\n        \"\"\"Counts the number of consecutive same-sense gauche rotations.\"\"\"\n        count = 0\n        num_dihedrals = len(dihedrals_deg)\n        if num_dihedrals < 2:\n            return 0\n        for i in range(num_dihedrals - 1):\n            if (dihedrals_deg[i] == 60 and dihedrals_deg[i+1] == 60) or \\\n               (dihedrals_deg[i] == -60 and dihedrals_deg[i+1] == -60):\n                count += 1\n        return count\n\n    def has_hockey_stick(dihedrals_deg):\n        \"\"\"Checks for the presence of a hockey stick pattern.\"\"\"\n        if not dihedrals_deg or len(dihedrals_deg) < 2:\n            return False\n        return count_S(dihedrals_deg) > 0\n\n    all_results = []\n    for N in test_cases:\n        num_dihedrals = N - 3\n        \n        min_ref_energy = float('inf')\n        min_ref_phis = None\n        min_art_energy = float('inf')\n        min_art_phis = None\n        \n        # Generate all conformers\n        conformers = itertools.product(possible_phis, repeat=num_dihedrals) if num_dihedrals > 0 else [()]\n\n        for phis_deg in conformers:\n            phis_rad = np.deg2rad(list(phis_deg))\n            \n            coords = build_coords(phis_rad, N)\n            \n            E_tors = calc_E_tors(phis_rad)\n            E_nb = calc_E_nb(coords, N)\n            \n            E_ref = E_tors + E_nb\n            \n            s_count = count_S(phis_deg)\n            E_art = E_ref - delta * s_count\n            \n            if E_ref < min_ref_energy:\n                min_ref_energy = E_ref\n                min_ref_phis = list(phis_deg)\n            \n            if E_art < min_art_energy:\n                min_art_energy = E_art\n                min_art_phis = list(phis_deg)\n\n        ref_has_hs = has_hockey_stick(min_ref_phis)\n        art_has_hs = has_hockey_stick(min_art_phis)\n        \n        is_artifact_driven = art_has_hs and not ref_has_hs\n        \n        case_result = [\n            is_artifact_driven,\n            round(min_ref_energy, 3),\n            round(min_art_energy, 3),\n            min_ref_phis if min_ref_phis is not None else [],\n            min_art_phis if min_art_phis is not None else []\n        ]\n        all_results.append(case_result)\n        \n    # Final print statement in the exact required format.\n    # Convert the list of lists to string representation.\n    # Based on the template, f-string with join is required.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2453240"}]}