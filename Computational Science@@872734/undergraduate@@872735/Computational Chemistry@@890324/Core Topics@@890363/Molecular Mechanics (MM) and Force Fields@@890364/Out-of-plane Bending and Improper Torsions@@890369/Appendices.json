{"hands_on_practices": [{"introduction": "To effectively use molecular mechanics models, it's crucial to understand that their parameters are not arbitrary numbers but reflections of underlying quantum mechanical principles. This exercise challenges you to connect the electronic structure of a molecule to the parameters that govern its geometry. By comparing aromatic benzene with a hypothetical non-aromatic analogue, you will develop a deeper intuition for why maintaining planarity is so energetically important in delocalized $\\pi$-systems and how this is captured by the out-of-plane force constant $k$ ([@problem_id:2459803]).", "problem": "A Molecular Mechanics (MM) force field models the resistance of a trigonal planar carbon center to pyramidalization using an improper torsion (out-of-plane) term. For a given central atom, the out-of-plane angle is denoted by $\\chi$, with a harmonic potential $V(\\chi)=\\tfrac{1}{2}k(\\chi-\\chi_{0})^{2}$ near the equilibrium value $\\chi_{0}=0$ for a planar $sp^{2}$ center. The force constant $k$ is, by definition, the second derivative of the potential energy with respect to $\\chi$ at $\\chi=0$, that is, $k=\\left.\\dfrac{\\mathrm{d}^{2}V}{\\mathrm{d}\\chi^{2}}\\right|_{\\chi=0}$. Consider two models for a six-membered hydrocarbon ring: aromatic benzene and a hypothetical non-aromatic $1,3,5$-cyclohexatriene in which the $\\pi$ bonds are fully localized and there is no cyclic delocalization. Suppose $k$ is to be fitted at a ring carbon in each molecule to reproduce the small-amplitude out-of-plane vibrational behavior predicted by quantum mechanics (QM). Which option best justifies the expected relative magnitude of $k$ in benzene versus $1,3,5$-cyclohexatriene?\n\nA. $k$ should be larger in benzene because cyclic $\\pi$ delocalization couples adjacent $p$ orbitals around the ring; an out-of-plane displacement at one carbon disrupts aromatic conjugation with both neighbors, increasing the curvature of $V(\\chi)$ relative to a localized triene.\n\nB. $k$ should be larger in $1,3,5$-cyclohexatriene because the absence of resonance makes individual double bonds intrinsically stiffer, so pyramidalization is more strongly resisted than in benzene.\n\nC. $k$ should be approximately equal in both molecules because the local hybridization is $sp^{2}$ in each case and the local geometry around each carbon is similar.\n\nD. $k$ should be smaller in benzene because delocalization allows charge to redistribute upon out-of-plane bending, softening the out-of-plane mode relative to a localized triene.\n\nE. $k$ should be identical because both molecules have six-membered rings, and ring size dominates the out-of-plane stiffness irrespective of electronic structure.", "solution": "The problem statement must first be validated for scientific soundness and consistency.\n\n**Step 1: Extract Givens**\n- The system is a trigonal planar carbon center in a six-membered hydrocarbon ring.\n- The out-of-plane bending is modeled by an improper torsion with angle $\\chi$.\n- The potential energy function for this motion is harmonic near equilibrium: $V(\\chi)=\\tfrac{1}{2}k(\\chi-\\chi_{0})^{2}$.\n- The equilibrium angle for a planar $sp^{2}$ center is $\\chi_{0}=0$.\n- The force constant $k$ is the second derivative of the potential energy evaluated at the equilibrium point: $k=\\left.\\dfrac{\\mathrm{d}^{2}V}{\\mathrm{d}\\chi^{2}}\\right|_{\\chi=0}$.\n- Two molecular models are to be compared:\n    1. Aromatic benzene.\n    2. A hypothetical non-aromatic $1,3,5$-cyclohexatriene with fully localized $\\pi$ bonds and no cyclic delocalization.\n- The question asks for the justification of the expected relative magnitude of the force constant $k$ for a ring carbon in benzene versus $1,3,5$-cyclohexatriene.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the principles of computational chemistry (molecular mechanics force fields), physical organic chemistry (aromaticity, electronic structure), and physics (harmonic oscillator model). The concepts of improper torsions, out-of-plane bending, force constants, benzene, and the hypothetical localized $1,3,5$-cyclohexatriene as a reference state are standard in the field.\n- **Well-Posedness**: The problem is well-posed. It asks for a qualitative comparison of a well-defined physical parameter ($k$) between two clearly defined chemical systems. A unique and meaningful answer can be derived from fundamental chemical principles.\n- **Objectivity**: The problem is stated in objective, scientific language, free of ambiguity or subjective claims.\n- **Completeness and Consistency**: The problem provides all necessary information. The definition of the potential $V(\\chi)$ and the force constant $k$ are explicit. The properties of the two molecules (aromatic vs. localized non-aromatic) are clearly stated. There are no contradictions. The use of a hypothetical molecule as a reference is a standard and valid technique in theoretical chemistry.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, well-posed, and internally consistent. We may proceed to the solution.\n\n**Derivation of the Solution**\nThe force constant $k$ is defined as $k=\\left.\\dfrac{\\mathrm{d}^{2}V}{\\mathrm{d}\\chi^{2}}\\right|_{\\chi=0}$. This quantity measures the curvature of the potential energy well at the equilibrium planar geometry ($\\chi=0$). A larger value of $k$ signifies a \"stiffer\" potential, meaning that a larger amount of energy is required to displace the atom from the plane by a given small angle $\\chi$. In other words, a larger $k$ corresponds to a stronger restoring force that maintains planarity.\n\nThe out-of-plane motion of a carbon atom in the ring involves the pyramidalization of that atom. This geometric distortion causes the $p_{z}$ orbital on that carbon, which is responsible for $\\pi$-bonding, to tilt away from the parallel alignment with the $p_{z}$ orbitals on the adjacent carbon atoms. This mis-alignment reduces the orbital overlap, which in turn weakens the $\\pi$-bonding. The energy cost of this distortion, $V(\\chi)$, is therefore directly related to the stability of the $\\pi$ electron system.\n\n1.  **Benzene**: Benzene is an aromatic molecule. The six $\\pi$ electrons are delocalized over the entire six-membered ring, forming a continuous cycle of conjugation. This cyclic delocalization results in a significant aromatic stabilization energy, which makes the planar structure of benzene exceptionally stable. When a single carbon atom is moved out of the plane (a non-zero $\\chi$), its $p_{z}$ orbital's overlap with the $p_{z}$ orbitals of *both* of its neighbors is diminished. This single local perturbation disrupts the entire cycle of conjugation, leading to a substantial loss of the aromatic stabilization energy. Because the aromatic system is so stable, resisting this disruption requires a large amount of energy. Thus, the potential energy $V(\\chi)$ for benzene rises very steeply as $\\chi$ deviates from $0$. This corresponds to a large curvature at the minimum, and therefore a large force constant $k$.\n\n2.  **Hypothetical $1,3,5$-Cyclohexatriene**: This molecule is defined as having three isolated carbon-carbon double bonds and three carbon-carbon single bonds, with no cyclic delocalization (no resonance). At any given carbon atom, it is part of one double bond and one single bond. When this carbon atom is displaced out of the plane, it primarily disrupts the $\\pi$ overlap within the single double bond it belongs to. The effect on the adjacent single bond is negligible in this localized model. While destabilizing a localized $\\pi$ bond certainly has an energy cost, this cost is not amplified by the loss of a collective, ring-wide stabilization effect like aromaticity. The stabilization of a single, isolated $\\pi$ bond is significantly less than the total stabilization of the delocalized aromatic system in benzene. Consequently, the energy penalty for the same out-of-plane displacement $\\chi$ is smaller for $1,3,5$-cyclohexatriene than for benzene. The potential well $V(\\chi)$ is shallower, its curvature is smaller, and thus the force constant $k$ is smaller.\n\nIn conclusion, $k_{\\text{benzene}} > k_{1,3,5-\\text{cyclohexatriene}}$ because disrupting the highly stable aromatic system in benzene is energetically more costly than disrupting a localized $\\pi$ bond in the non-aromatic analogue.\n\n**Evaluation of Options**\n\n**A. $k$ should be larger in benzene because cyclic $\\pi$ delocalization couples adjacent $p$ orbitals around the ring; an out-of-plane displacement at one carbon disrupts aromatic conjugation with both neighbors, increasing the curvature of $V(\\chi)$ relative to a localized triene.**\nThis option correctly states that $k$ is larger in benzene. The justification provided is entirely correct. Out-of-plane displacement disrupts the cyclic aromatic conjugation, which is a highly stabilizing feature. The energy cost to break this stabilization is high, leading to a large potential energy curvature ($k$).\n**Verdict: Correct.**\n\n**B. $k$ should be larger in $1,3,5$-cyclohexatriene because the absence of resonance makes individual double bonds intrinsically stiffer, so pyramidalization is more strongly resisted than in benzene.**\nThis option incorrectly claims $k$ is larger in cyclohexatriene. The reasoning inappropriately conflates the stiffness of bond *stretching* with the stiffness of out-of-plane *bending*. A localized C=C double bond is indeed stiffer with respect to stretching than the bonds in benzene. However, the resistance to out-of-plane bending is governed by the stability of the planar $\\pi$ system, which is far greater in aromatic benzene.\n**Verdict: Incorrect.**\n\n**C. $k$ should be approximately equal in both molecules because the local hybridization is $sp^{2}$ in each case and the local geometry around each carbon is similar.**\nThis option incorrectly claims the force constants are approximately equal. It relies on a superficial analysis of local geometry and hybridization. It entirely misses the dominant energetic difference between the two systems: the presence versus absence of aromatic stabilization energy, a global electronic effect that dictates the resistance to non-planar distortions.\n**Verdict: Incorrect.**\n\n**D. $k$ should be smaller in benzene because delocalization allows charge to redistribute upon out-of-plane bending, softening the out-of-plane mode relative to a localized triene.**\nThis option incorrectly claims $k$ is smaller in benzene. The reasoning is flawed and presents the opposite of the correct physical picture. Delocalization creates an exceptionally stable planar system. This stability does not \"soften\" the molecule to out-of-plane distortions; it makes the molecule \"stiffer\" with respect to such distortions because they are energetically very unfavorable.\n**Verdict: Incorrect.**\n\n**E. $k$ should be identical because both molecules have six-membered rings, and ring size dominates the out-of-plane stiffness irrespective of electronic structure.**\nThis option incorrectly claims the force constants are identical. The reasoning that ring size is the dominant factor and that electronic structure is irrelevant is fundamentally wrong. The out-of-plane potential is almost entirely a consequence of the electronic structure of the $\\pi$ system, which is the primary point of difference between the two molecules.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2459803"}, {"introduction": "With an understanding of the physical origins of out-of-plane stiffness, we can now explore how the potential energy model is applied in practice. This problem will guide you through the process of calculating the restoring force that arises from a small displacement from planarity. By implementing the relationship between the harmonic potential $V(\\chi) = \\frac{1}{2}k\\chi^{2}$ and the resulting force, you will gain hands-on experience in translating a potential energy function into the forces that drive molecular motion in a simulation ([@problem_id:2459853]).", "problem": "You will write a complete program that computes the restoring force along the plane normal on a central atom undergoing an out-of-plane bending displacement modeled as an improper torsion. Consider a trigonal planar molecular center (for example, the boron atom in borane), where the out-of-plane coordinate is represented by an improper angle. The out-of-plane bending potential is modeled harmonically as\n$$\nV(\\chi) = \\tfrac{1}{2}\\,k\\,(\\chi - \\chi_0)^2,\n$$\nwith equilibrium out-of-plane angle $\\chi_0 = 0$, force constant $k$ in $\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$, and $\\chi$ in radians. Assume a symmetric geometry with three identical bonds, and approximate the effective lever arm by the average bond length $r_{\\mathrm{avg}}$. Using the harmonic model, the restoring force on the central atom along the unit normal to the substituent plane is defined as the linear response implied by the potential above and the lever-arm approximation. All angles provided in the test suite are in degrees and must be converted to radians before use. The final answers must be expressed as forces per molecule in Newtons, using scientific notation with exactly six significant figures.\n\nAdopt the following physical constants and unit conversions in your program:\n- Avogadro constant $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$.\n- Joule conversion $1\\,\\mathrm{kJ} = 10^{3}\\,\\mathrm{J}$.\n- Angstrom-to-meter conversion $1\\,\\text{\\AA} = 10^{-10}\\,\\mathrm{m}$.\n\nTest suite. For each case, compute the signed restoring force along the plane normal on the central atom (positive for a positive out-of-plane angle, negative for a restoring response opposing the displacement), and report the value in $\\mathrm{N}$ per molecule. Use the parameters $(k,\\chi_\\text{deg}, r_{\\mathrm{avg}})$ with $k$ in $\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$, out-of-plane angle $\\chi_\\text{deg}$ in degrees, and $r_{\\mathrm{avg}}$ in \\AA:\n1. Borane baseline small displacement: $(40.0,\\; 1.0,\\; 1.19)$.\n2. Zero displacement boundary: $(40.0,\\; 0.0,\\; 1.19)$.\n3. Larger small-angle displacement, same borane geometry: $(40.0,\\; 10.0,\\; 1.19)$.\n4. Different stiffness and lever arm: $(60.0,\\; 5.0,\\; 1.00)$.\n5. Negative displacement sign check: $(40.0,\\; -1.0,\\; 1.19)$.\n\nFinal output format. Your program should produce a single line of output containing the results for cases $1$ through $5$ in order, as a comma-separated list enclosed in square brackets, for example\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5],\n$$\nwhere each $\\text{result}_i$ is a float in scientific notation with exactly six significant figures, in $\\mathrm{N}$ per molecule.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in the principles of molecular mechanics, well-posed, and presented with objective, quantitative data. It describes a standard method for modeling out-of-plane bending vibrations using a harmonic potential, which is a common approximation in computational chemistry for small atomic displacements. All necessary parameters and physical constants are provided, and there are no internal contradictions. We may proceed with the solution.\n\nThe problem requires the calculation of the force on a central atom due to an out-of-plane displacement, which is modeled by a harmonic potential based on an improper torsion angle, $\\chi$. The potential energy $V$ is given by:\n$$\nV(\\chi) = \\frac{1}{2}k(\\chi - \\chi_0)^2\n$$\nThe equilibrium angle is specified as $\\chi_0 = 0$, simplifying the potential to:\n$$\nV(\\chi) = \\frac{1}{2}k\\chi^2\n$$\nHere, $k$ is the force constant and $\\chi$ is the out-of-plane angle in radians.\n\nThe force $F_z$ along the axis normal to the plane of the substituents (let us call this the $z$-axis) is the negative gradient of the potential with respect to the displacement $z$ along that axis:\n$$\nF_z = -\\frac{dV}{dz}\n$$\nThe potential is provided as a function of the angle $\\chi$, not the Cartesian displacement $z$. We must establish a relationship between these two coordinates. For a small displacement $z$ of the central atom from the plane of the three substituents, the out-of-plane angle $\\chi$ can be related to $z$ and the average bond length $r_{\\mathrm{avg}}$, which acts as the lever arm. Geometrically, for small angles, we have the approximation $\\sin(\\chi) \\approx \\chi$. The displacement $z$ is given by $z = r_{\\mathrm{avg}} \\sin(\\chi)$, which simplifies to:\n$$\nz \\approx r_{\\mathrm{avg}} \\chi \\quad \\implies \\quad \\chi \\approx \\frac{z}{r_{\\mathrm{avg}}}\n$$\nWe can now express the potential energy as a function of the Cartesian displacement $z$:\n$$\nV(z) = \\frac{1}{2}k\\left(\\frac{z}{r_{\\mathrm{avg}}}\\right)^2 = \\frac{k}{2r_{\\mathrm{avg}}^2}z^2\n$$\nThis is a standard one-dimensional harmonic oscillator potential, $V(z) = \\frac{1}{2}k_{\\text{eff}}z^2$, with an effective force constant $k_{\\text{eff}} = \\frac{k}{r_{\\mathrm{avg}}^2}$.\n\nThe restoring force is found by differentiating $V(z)$ with respect to $z$:\n$$\nF_z = -\\frac{dV}{dz} = -\\frac{d}{dz}\\left(\\frac{k}{2r_{\\mathrm{avg}}^2}z^2\\right) = -\\frac{k}{r_{\\mathrm{avg}}^2}z\n$$\nTo express the force in terms of the angle $\\chi$, we substitute $z = r_{\\mathrm{avg}}\\chi$:\n$$\nF_z = -\\frac{k}{r_{\\mathrm{avg}}^2}(r_{\\mathrm{avg}}\\chi) = -\\frac{k\\chi}{r_{\\mathrm{avg}}}\n$$\nThe negative sign indicates that the force is a restoring force, acting in the direction opposite to the displacement. However, the problem specifies a non-standard sign convention: \"compute the signed restoring force ... (positive for a positive out-of-plane angle, negative for a restoring response opposing the displacement)\". This is contradictory phrasing. A restoring response *by definition* opposes the displacement. We will adhere to the first part of the instruction, which is an explicit directive: the sign of the force should match the sign of the angle $\\chi$. Therefore, the formula we must implement is:\n$$\nF_z = \\frac{k\\chi}{r_{\\mathrm{avg}}}\n$$\nTo obtain the force in Newtons ($N$), all input parameters must be converted to base SI units. The unit of force, the Newton, is equivalent to Joules per meter ($N = J \\cdot m^{-1}$).\n\nThe conversion process is as follows:\n1.  The force constant $k$ is given in $\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$. It must be converted to $\\mathrm{J\\,molecule^{-1}}$. The unit $\\mathrm{rad}^{-2}$ is a convention indicating the potential is quadratic in an angle measured in radians; for dimensional analysis, the radian is treated as a dimensionless unit.\n    $$\n    k'\\,[\\mathrm{J/molecule}] = k\\,\\left[\\frac{\\mathrm{kJ}}{\\mathrm{mol}}\\right] \\times \\frac{1000\\,\\mathrm{J}}{1\\,\\mathrm{kJ}} \\times \\frac{1\\,\\mathrm{mol}}{N_A\\,\\mathrm{molecules}}\n    $$\n    where $N_A = 6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}$.\n2.  The out-of-plane angle $\\chi_{\\text{deg}}$ is given in degrees and must be converted to radians.\n    $$\n    \\chi_{\\text{rad}} = \\chi_{\\text{deg}} \\times \\frac{\\pi}{180}\n    $$\n3.  The average bond length $r_{\\mathrm{avg}}$ is given in Ångströms ($\\text{\\AA}$) and must be converted to meters ($m$).\n    $$\n    r'_{\\mathrm{avg}}\\,[\\mathrm{m}] = r_{\\mathrm{avg}}\\,[\\text{\\AA}] \\times 10^{-10} \\frac{\\mathrm{m}}{\\text{\\AA}}\n    $$\nThe final computation for the force in Newtons is:\n$$\nF_z\\,[\\mathrm{N}] = \\frac{k'\\,[\\mathrm{J/molecule}] \\times \\chi_{\\text{rad}}}{r'_{\\mathrm{avg}}\\,[\\mathrm{m}]}\n$$\nThe program will iterate through the provided test suite, applying this formula to each set of parameters. The final results are to be formatted in scientific notation with exactly six significant figures. This corresponds to the Python format specifier `\"{:.5e}\"`, which provides one digit before the decimal point and five after.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the restoring force on a central atom for out-of-plane bending.\n    \"\"\"\n\n    # Physical constants and conversion factors\n    N_A = 6.02214076e23  # Avogadro constant (mol^-1)\n    KJ_TO_J = 1000.0       # Conversion from kJ to J\n    ANGSTROM_TO_METER = 1e-10 # Conversion from Angstrom to meters\n\n    # Test suite: (k [kJ mol^-1 rad^-2], chi [degrees], r_avg [Angstrom])\n    test_cases = [\n        (40.0, 1.0, 1.19),   # 1. Borane baseline small displacement\n        (40.0, 0.0, 1.19),   # 2. Zero displacement boundary\n        (40.0, 10.0, 1.19),  # 3. Larger small-angle displacement\n        (60.0, 5.0, 1.00),   # 4. Different stiffness and lever arm\n        (40.0, -1.0, 1.19),  # 5. Negative displacement sign check\n    ]\n\n    results = []\n    for k_in, chi_deg, r_avg_in in test_cases:\n\n        # Step 1: Convert units to SI\n        # Convert force constant k from kJ mol^-1 rad^-2 to J molecule^-1\n        # The 'rad' unit is dimensionless for dimensional analysis.\n        k_si = (k_in * KJ_TO_J) / N_A  # J / molecule\n\n        # Convert angle chi from degrees to radians\n        chi_rad = np.deg2rad(chi_deg)\n\n        # Convert average bond length r_avg from Angstroms to meters\n        r_avg_si = r_avg_in * ANGSTROM_TO_METER  # meters\n\n        # Step 2: Calculate the force\n        # The formula derived is F_z = (k * chi) / r_avg.\n        # The sign is positive for positive chi as per problem instruction.\n        # A division by zero check is necessary for r_avg_si, though not an\n        # issue with the given test cases.\n        if r_avg_si == 0:\n            if k_si * chi_rad == 0:\n                # 0/0 is indeterminate, but in this physical context means no force\n                force_n = 0.0\n            else:\n                # Non-zero torque with zero lever arm implies infinite force,\n                # which is unphysical.\n                force_n = np.inf\n        else:\n            force_n = (k_si * chi_rad) / r_avg_si  # Newtons (J/m)\n\n        # Step 3: Format and store the result\n        # The format must be scientific notation with exactly six significant figures.\n        # The format specifier {:.5e} provides 1 digit before the decimal and 5 after.\n        results.append(f\"{force_n:.5e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2459853"}, {"introduction": "We have seen why out-of-plane potentials are important and how to use them, but how are their parameters determined? This final practice completes the picture by simulating a key task in force field development: parameterization. You will fit the parameters of a harmonic improper torsion potential, $k$ and $\\chi_0$, to reference energy data obtained from quantum mechanics, contrasting a planar aromatic system with a pyramidal saturated one. This exercise provides direct experience with the data-driven process that bridges the accuracy of quantum mechanics with the efficiency of molecular mechanics ([@problem_id:2459809]).", "problem": "You are asked to construct a program that parametrizes the harmonic improper torsion potential for the out-of-plane bending at a nitrogen center for two chemically distinct cases: a planar, aromatic nitrogen in pyrrole and a pyramidal, saturated nitrogen in pyrrolidine. The improper torsion potential is modeled as a one-dimensional harmonic function of the signed improper dihedral angle, defined for a central atom and three substituents. The model is\n$$\nE(\\chi) = \\tfrac{1}{2} k \\left(\\chi - \\chi_0\\right)^2,\n$$\nwhere $E(\\chi)$ is the energy in kilojoules per mole, $\\chi$ is the improper dihedral angle in radians, $k$ is the force constant in kilojoules per mole per square radian, and $\\chi_0$ is the equilibrium improper angle in radians. Given a set of sampled angles $\\{\\chi_i\\}$ and corresponding energies $\\{E_i\\}$ for each case, determine the parameters $k$ and $\\chi_0$ that minimize the sum of squared residuals $$\\sum_i \\left[E_i - \\tfrac{1}{2} k(\\chi_i - \\chi_0)^2\\right]^2$$. Then, for each fitted model, evaluate the barrier at the planar geometry as $E(0) = \\tfrac{1}{2}k\\chi_0^2$ in kilojoules per mole.\n\nAll angles must be treated in radians and all energies must be treated in kilojoules per mole. The final numerical answers must be returned as floating-point numbers.\n\nUse the following test suite of cases, each consisting of a list of angles $\\{\\chi_i\\}$ in radians and the corresponding energies $\\{E_i\\}$ in kilojoules per mole:\n\n- Case 1 (planar pyrrole-like, symmetric about $0$): angles $\\{-0.35,-0.20,0.00,0.20,0.35\\}$ and energies $\\{18.375,6.000,0.000,6.000,18.375\\}$.\n- Case 2 (pyramidal pyrrolidine-like, minimum near $0.60$): angles $\\{0.00,0.20,0.60,1.00,1.20\\}$ and energies $\\{18.000,8.000,0.000,8.000,18.000\\}$.\n- Case 3 (minimal three-point set, weakly pyramidal): angles $\\{-0.10,0.20,0.50\\}$ and energies $\\{1.000,0.250,4.000\\}$.\n\nYour program must compute, for each case, the tuple $\\left[k,\\chi_0,E(0)\\right]$ with $k$ in kilojoules per mole per square radian, $\\chi_0$ in radians, and $E(0)$ in kilojoules per mole. The program must produce a single line of output containing the results as a comma-separated list of lists, with each inner list ordered as $\\left[k,\\chi_0,E(0)\\right]$, and with all numbers rounded to six decimal places, for example:\n[[k1,chi01,E0_1],[k2,chi02,E0_2],[k3,chi03,E0_3]].", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **Model for potential energy:** $E(\\chi) = \\tfrac{1}{2} k \\left(\\chi - \\chi_0\\right)^2$, where $E$ is energy in kJ/mol and $\\chi$ is the improper dihedral angle in radians.\n- **Parameters to determine:** Force constant $k$ (in kJ/mol/rad$^2$) and equilibrium angle $\\chi_0$ (in radians).\n- **Objective function:** Minimize the sum of squared residuals, $SSR = \\sum_i \\left[E_i - \\tfrac{1}{2} k(\\chi_i - \\chi_0)^2\\right]^2$, given discrete data points $(\\chi_i, E_i)$.\n- **Derived quantity:** Calculate the energy barrier at the planar geometry, $E(0) = \\tfrac{1}{2}k\\chi_0^2$.\n- **Data Sets:**\n    - **Case 1:** angles $\\{-0.35, -0.20, 0.00, 0.20, 0.35\\}$ radians; energies $\\{18.375, 6.000, 0.000, 6.000, 18.375\\}$ kJ/mol.\n    - **Case 2:** angles $\\{0.00, 0.20, 0.60, 1.00, 1.20\\}$ radians; energies $\\{18.000, 8.000, 0.000, 8.000, 18.000\\}$ kJ/mol.\n    - **Case 3:** angles $\\{-0.10, 0.20, 0.50\\}$ radians; energies $\\{1.000, 0.250, 4.000\\}$ kJ/mol.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the required criteria.\n- **Scientifically Grounded:** The problem is valid. The harmonic potential is a fundamental model in physics and chemistry used to describe oscillations around an equilibrium, such as out-of-plane bending vibrations. The concept of improper torsions to describe planarity at an atomic center is a standard technique in molecular mechanics.\n- **Well-Posed:** The problem is valid. It is a well-defined parameter estimation problem (non-linear regression). For each case, the number of data points ($5$, $5$, and $3$) is greater than or equal to the number of parameters to fit ($2$), so the system is not underdetermined.\n- **Objective:** The problem is valid. It is formulated with precise mathematical definitions and objective numerical data, free of any subjective or ambiguous language.\n\nAll other validation checks are passed. The problem is free of scientific flaws, contradictions, or unstated assumptions.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be constructed.\n\n**Principle-Based Design of the Solution**\nThe task is to determine the parameters $k$ and $\\chi_0$ of the harmonic potential energy model $E(\\chi) = \\tfrac{1}{2} k \\left(\\chi - \\chi_0\\right)^2$ by fitting it to provided energy-versus-angle data. This is a classic non-linear least-squares problem. The goal is to find the parameter values that minimize the sum of squared residuals ($SSR$) between the model's predictions and the given energy values:\n$$\n\\min_{k, \\chi_0} SSR(k, \\chi_0) = \\sum_i \\left( E_i - \\frac{1}{2} k (\\chi_i - \\chi_0)^2 \\right)^2\n$$\nA robust method for solving such problems is the Levenberg-Marquardt algorithm, which is available in the `scipy.optimize.least_squares` library function. This function iteratively finds the minimum of a sum of squares of non-linear functions. It requires as input a function that returns a vector of the residuals, $r_i$, for a given set of parameters. The residual for the $i$-th data point is:\n$$\nr_i(k, \\chi_0) = E_i - \\frac{1}{2} k (\\chi_i - \\chi_0)^2\n$$\nThe success of non-linear optimization is often sensitive to the initial guess for the parameters. A physically motivated initial guess improves the likelihood of finding the global minimum. We can devise a strategy for this:\n$1$. The equilibrium angle $\\chi_0$ corresponds to the minimum of the potential energy curve. A reasonable initial guess for $\\chi_0$ is the angle value in the dataset that corresponds to the lowest energy, $\\chi_{\\text{guess},0} = \\chi_j$ where $E_j = \\min(\\{E_i\\})$.\n$2$. With an estimate for $\\chi_0$, the force constant $k$ can be estimated from the model equation using another data point. To ensure a stable estimate, it is best to use a point far from the minimum. We select the data point $(\\chi_f, E_f)$ where $\\chi_f$ is the angle furthest from $\\chi_{\\text{guess},0}$. The initial guess for $k$ is then calculated as:\n$$k_{\\text{guess}} = \\frac{2 E_f}{(\\chi_f - \\chi_{\\text{guess},0})^2}$$\nA constraint must be imposed on the force constant $k$, as it must be positive ($k > 0$) for the potential to describe a stable minimum.\n\nThe algorithm is as follows for each test case:\n$1$. Prepare the angle and energy data as numerical arrays.\n$2$. Generate an intelligent initial guess for $(k, \\chi_0)$ using the strategy outlined above.\n$3$. Invoke `scipy.optimize.least_squares`, providing the residual function, the initial guess, the data, and bounds to enforce $k \\ge 0$.\n$4$. Extract the optimized parameters $k$ and $\\chi_0$ from the solver's result.\n$5$. Calculate the final required quantity, the planar barrier height $E(0) = \\frac{1}{2}k\\chi_0^2$.\n\nIt is noteworthy that the provided data for all three cases are \"ideal\" in that they perfectly fit the harmonic model for a specific set of parameters, leading to a minimum $SSR$ of $0$. While a numerical solver is a general approach, for these specific cases, an analytical solution also exists. Our robust numerical strategy will correctly identify these exact solutions.\n\nThe final program will systematically apply this procedure to each test case, collect the results $\\left[k, \\chi_0, E(0)\\right]$, and format them into the specified output string. All numbers will be rounded to six decimal places as required.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\nimport sys\n\n# Set a higher recursion limit for optimization algorithms if needed, though not expected for this problem.\nsys.setrecursionlimit(2000)\n\ndef solve():\n    \"\"\"\n    Solves for the parameters of a harmonic improper torsion potential for three test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Case 1 (planar pyrrole-like)\",\n            \"angles\": np.array([-0.35, -0.20, 0.00, 0.20, 0.35]),\n            \"energies\": np.array([18.375, 6.000, 0.000, 6.000, 18.375]),\n        },\n        {\n            \"name\": \"Case 2 (pyramidal pyrrolidine-like)\",\n            \"angles\": np.array([0.00, 0.20, 0.60, 1.00, 1.20]),\n            \"energies\": np.array([18.000, 8.000, 0.000, 8.000, 18.000]),\n        },\n        {\n            \"name\": \"Case 3 (minimal three-point set, weakly pyramidal)\",\n            \"angles\": np.array([-0.10, 0.20, 0.50]),\n            \"energies\": np.array([1.000, 0.250, 4.000]),\n        },\n    ]\n\n    def residuals_function(params, angles, energies):\n        \"\"\"\n        Calculates the residuals for the harmonic potential model.\n        params: A list or tuple [k, chi0].\n        angles: Numpy array of angles (chi).\n        energies: Numpy array of corresponding energies (E).\n        Returns a numpy array of residuals (E_data - E_model).\n        \"\"\"\n        k, chi0 = params\n        model_energies = 0.5 * k * (angles - chi0)**2\n        return energies - model_energies\n\n    results = []\n    for case in test_cases:\n        angles = case[\"angles\"]\n        energies = case[\"energies\"]\n\n        # 1. Generate an intelligent initial guess.\n        # Guess chi0 is the angle corresponding to the minimum energy.\n        min_energy_idx = np.argmin(energies)\n        chi0_guess = angles[min_energy_idx]\n\n        # Guess k using the point furthest from chi0_guess for stability.\n        furthest_point_idx = np.argmax(np.abs(angles - chi0_guess))\n        chi_furthest = angles[furthest_point_idx]\n        energy_furthest = energies[furthest_point_idx]\n        \n        # Avoid division by zero if the furthest point happens to be the minimum.\n        # This is unlikely with typical potential scan data.\n        denominator = (chi_furthest - chi0_guess)**2\n        if np.isclose(denominator, 0):\n            # Fallback k_guess if denominator is zero\n            k_guess = 1.0 \n        else:\n            k_guess = 2 * energy_furthest / denominator\n\n        initial_guess = [k_guess, chi0_guess]\n\n        # 2. Perform the non-linear least squares optimization.\n        # Bounds: k must be non-negative. chi0 is unconstrained.\n        bounds = ([0, -np.inf], [np.inf, np.inf])\n        \n        # Levenberg-Marquardt is the default method and is suitable here.\n        opt_result = least_squares(\n            residuals_function,\n            initial_guess,\n            args=(angles, energies),\n            bounds=bounds\n        )\n\n        # 3. Extract results and calculate E(0).\n        k_fit, chi0_fit = opt_result.x\n        e0_fit = 0.5 * k_fit * chi0_fit**2\n\n        results.append([k_fit, chi0_fit, e0_fit])\n\n    # 4. Format the output as specified.\n    formatted_results = []\n    for res in results:\n        # Format each number to six decimal places.\n        formatted_res_str = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        formatted_results.append(formatted_res_str)\n\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "2459809"}]}