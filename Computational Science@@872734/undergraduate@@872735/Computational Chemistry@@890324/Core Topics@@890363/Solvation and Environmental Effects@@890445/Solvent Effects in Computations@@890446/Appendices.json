{"hands_on_practices": [{"introduction": "The Born model is the simplest representation of ion solvation, treating an ion as a charged sphere in a continuous dielectric medium. While a significant simplification, it provides the conceptual foundation for more advanced continuum solvation methods. This first practice [@problem_id:2462575] is not just about applying a formula; it's about exploring a critical and practical aspect of all such models: their sensitivity to user-defined parameters, specifically the cavity radius. By quantifying how the calculated solvation energy changes with small variations in the ion's radius, you will gain a crucial appreciation for the uncertainty inherent in continuum modeling and the importance of parameter choice.", "problem": "You are to write a complete, runnable program that computes the sensitivity of the solvation free energy of the chloride ion $\\mathrm{Cl^-}$ in liquid water to the choice of the cavity radius used in the Polarizable Continuum Model (PCM). Use the Born model expression for the solvation free energy, which approximates the work of charging a spherical ion of radius $r$ embedded in a dielectric continuum:\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon_r) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon_r}-1\\Big),\n$$\nwhere $N_{\\mathrm{A}}$ is Avogadro’s number, $z$ is the ion charge number, $e$ is the elementary charge, $\\varepsilon_0$ is the vacuum permittivity, and $\\varepsilon_r$ is the static relative permittivity (dielectric constant) of the solvent. Take the solvent as liquid water at room temperature with dielectric constant $\\varepsilon_r = 78.37$. Use $z=-1$ for $\\mathrm{Cl^-}$, $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$, $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$, and $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$. Treat the cavity radius $r$ as a parameter in metres. The Born model formula above yields $\\Delta G_{\\text{solv}}$ in joules per mole; convert your results to kilojoules per mole. All calculations must be expressed in kilojoules per mole.\n\nFor each test case, define a nominal PCM cavity radius $r_0$ (in ångströms), and consider two perturbed radii given by a relative change of $\\pm 10\\%$:\n- The decreased radius is $0.9\\,r_0$.\n- The increased radius is $1.1\\,r_0$.\n\nFor each test case, compute the following three quantities, all in kilojoules per mole:\n- The nominal solvation free energy $\\Delta G_{\\text{solv}}(r_0,\\varepsilon_r)$.\n- The absolute error for the $-10\\%$ change, defined as $\\big|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon_r) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon_r)\\big|$.\n- The absolute error for the $+10\\%$ change, defined as $\\big|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon_r) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon_r)\\big|$.\n\nUse the following test suite of nominal cavity radii $r_0$ for $\\mathrm{Cl^-}$ (in ångströms): $[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$. Convert ångströms to metres using $1$ Å $= 1.0\\times 10^{-10}$ m.\n\nYour program must produce a single line of output containing a list of $4$ sublists, one per test case, where each sublist contains the three floating-point numbers described above, in this exact order and in kilojoules per mole, each rounded to $2$ decimal places. For example, the required format is\n$[\\,[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],[x_{31},x_{32},x_{33}],[x_{41},x_{42},x_{43}]\\,]$,\nwith no additional text.", "solution": "The problem statement has been subjected to rigorous validation against the required criteria.\n\n**Step 1: Extract Givens**\n- **Model Equation**: Born model for solvation free energy, $\\Delta G_{\\text{solv}}(r,\\varepsilon_r) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon_r}-1\\Big)$.\n- **Ion**: Chloride ion ($\\mathrm{Cl^-}$), for which the charge number is $z=-1$.\n- **Solvent**: Liquid water, with static relative permittivity $\\varepsilon_r = 78.37$.\n- **Physical Constants**:\n  - Avogadro's number: $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n  - Elementary charge: $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n  - Vacuum permittivity: $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$.\n- **Unit Conversions**:\n  - Input radius $r_0$ is in ångströms (Å), where $1\\ \\text{Å} = 1.0\\times 10^{-10}\\ \\mathrm{m}$.\n  - Output energy is in kilojoules per mole ($\\mathrm{kJ \\cdot mol^{-1}}$), where $1\\ \\mathrm{kJ} = 1000\\ \\mathrm{J}$.\n- **Test Suite**: A set of nominal cavity radii $r_0$ for $\\mathrm{Cl^-}$: $[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$ in ångströms.\n- **Task**: For each $r_0$, compute three values:\n  1. The nominal solvation free energy $\\Delta G_{\\text{solv}}(r_0,\\varepsilon_r)$.\n  2. The absolute error for a $-10\\%$ radius change: $|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon_r) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon_r)|$.\n  3. The absolute error for a $+10\\%$ radius change: $|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon_r) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon_r)|$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated as scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: It is based on the Born model, a cornerstone of continuum solvation theory in physical chemistry. All physical constants are provided with their standard, accepted values. The investigation of sensitivity to a model parameter (cavity radius) is a standard and meaningful task in computational chemistry.\n- **Well-Posedness**: The problem provides a precise mathematical formula, all necessary numerical inputs, and a clear, unambiguous specification of the required outputs. It admits a unique, stable, and directly computable solution.\n- **Objectivity**: The language is quantitative and precise, free from any subjective or speculative content.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be developed.\n\nThe solution proceeds from the Born model equation for the solvation free energy $\\Delta G_{\\text{solv}}$ of a spherical ion in a dielectric continuum:\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon_r) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon_r}-1\\Big)\n$$\nHere, $r$ is the cavity radius and $\\varepsilon_r$ is the static relative permittivity of the solvent. All other symbols represent fundamental physical constants.\n\nFor computational efficiency, it is advantageous to group all terms that are independent of the radius $r$ into a single constant factor, which we shall denote $C_{\\text{Born}}$.\n$$\nC_{\\text{Born}} = N_{\\mathrm{A}} \\frac{(z e)^2}{8\\pi \\varepsilon_0} \\left( \\frac{1}{\\varepsilon_r} - 1 \\right)\n$$\nThe units of this constant are energy multiplied by length per mole, which in the SI system are $\\mathrm{J \\cdot m \\cdot mol^{-1}}$. The solvation free energy can then be expressed in a simplified form:\n$$\n\\Delta G_{\\text{solv}}(r) = \\frac{C_{\\text{Born}}}{r}\n$$\nThis reveals that the solvation free energy, within the Born model, is inversely proportional to the cavity radius $r$. This relationship is central to the sensitivity analysis.\n\nThe computational procedure for each test case with a nominal radius $r_0$ (given in ångströms) is as follows:\n1.  **Define Constants**: All physical constants ($N_{\\mathrm{A}}$, $e$, $\\varepsilon_0$) and model parameters ($z$, $\\varepsilon_r$) are defined in SI units.\n2.  **Pre-compute the Born Constant**: Calculate the value of $C_{\\text{Born}}$ using the values provided. This constant will be used for all subsequent calculations.\n3.  **Process Test Cases**: For each nominal radius $r_0$ from the test suite:\n    a. Convert $r_0$ from ångströms to meters using the conversion factor $1\\ \\text{Å} = 10^{-10}\\ \\mathrm{m}$.\n    b. Define the perturbed radii: $r_{(-)} = 0.9 \\cdot r_0$ and $r_{(+)} = 1.1 \\cdot r_0$.\n    c. Calculate the nominal solvation free energy $\\Delta G_0$ using the formula $\\Delta G_{\\text{solv}}(r_0) = C_{\\text{Born}} / r_0$. The result, in $\\mathrm{J \\cdot mol^{-1}}$, is converted to $\\mathrm{kJ \\cdot mol^{-1}}$ by dividing by $1000$.\n    d. Calculate the perturbed free energies, $\\Delta G_{(-)} = C_{\\text{Born}} / r_{(-)}$ and $\\Delta G_{(+)} = C_{\\text{Born}} / r_{(+)}$, and convert them to $\\mathrm{kJ \\cdot mol^{-1}}$.\n    e. Compute the required absolute errors: $\\text{Err}_{(-)} = |\\Delta G_{(-)} - \\Delta G_0|$ and $\\text{Err}_{(+)} = |\\Delta G_{(+)} - \\Delta G_0|$.\n4.  **Format Output**: The three resulting floating-point numbers ($\\Delta G_0$, $\\text{Err}_{(-)}$, $\\text{Err}_{(+)}$) are collected for each test case. These lists of results are then formatted into a final string as specified by the problem statement.\n\nThis step-by-step procedure provides a direct and rigorous path to the solution. The negative sign of $\\Delta G_{\\text{solv}}$ indicates that the solvation process for an ion in a polar solvent is spontaneous. The sensitivity analysis will demonstrate that the calculated energy is highly dependent on the choice of the cavity radius, a known limitation and critical parameter of continuum models. A smaller radius leads to a more negative (more favorable) solvation energy, and the magnitude of change is non-linear, as seen in the errors. The error for a $-10\\%$ change in radius is larger than the error for a $+10\\%$ change, as expected from the $1/r$ dependence.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of the solvation free energy of Cl-\n    to the cavity radius in the Born model.\n    \"\"\"\n    # Define physical constants and parameters in SI units.\n    NA = 6.02214076e23  # Avogadro's number (mol^-1)\n    e = 1.602176634e-19  # Elementary charge (C)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F m^-1 or C^2 J^-1 m^-1)\n    z = -1.0             # Charge number for Cl-\n    eps_r = 78.37        # Relative permittivity of water\n    \n    # Define the list of nominal cavity radii in ångströms.\n    test_cases_r0_angstrom = [1.60, 1.81, 2.00, 2.20]\n\n    # Pre-calculate the constant part of the Born equation.\n    # The result has units of J * m / mol.\n    born_constant = (NA * (z * e)**2 / (8 * np.pi * eps0)) * (1.0 / eps_r - 1.0)\n\n    def calculate_g_solv_kj_mol(r_angstrom):\n        \"\"\"\n        Calculates the solvation free energy in kJ/mol for a given radius in ångströms.\n        \"\"\"\n        if r_angstrom <= 0:\n            raise ValueError(\"Radius must be positive.\")\n        \n        # Convert radius from ångströms to meters.\n        r_meter = r_angstrom * 1.0e-10\n        \n        # Calculate solvation free energy in J/mol.\n        g_solv_j_mol = born_constant / r_meter\n        \n        # Convert to kJ/mol.\n        return g_solv_j_mol / 1000.0\n\n    # Store the results for all test cases.\n    all_results = []\n    \n    for r0_a in test_cases_r0_angstrom:\n        # Define the perturbed radii.\n        r_minus_a = 0.9 * r0_a\n        r_plus_a = 1.1 * r0_a\n\n        # Calculate the solvation free energies in kJ/mol.\n        g0 = calculate_g_solv_kj_mol(r0_a)\n        g_minus = calculate_g_solv_kj_mol(r_minus_a)\n        g_plus = calculate_g_solv_kj_mol(r_plus_a)\n\n        # Calculate the absolute errors.\n        err_minus = abs(g_minus - g0)\n        err_plus = abs(g_plus - g0)\n        \n        # Append the list of three required values.\n        all_results.append([g0, err_minus, err_plus])\n\n    # Format the final output string according to the specification.\n    # Each number is rounded to 2 decimal places.\n    formatted_sublists = []\n    for result_set in all_results:\n        g, err_m, err_p = result_set\n        formatted_sublists.append(f\"[{g:.2f},{err_m:.2f},{err_p:.2f}]\")\n\n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2462575"}, {"introduction": "Moving beyond simple ions, we often need to model neutral but polar molecules whose charge distributions are better described by a dipole moment. This exercise [@problem_id:2462555] introduces the Onsager reaction field model, a classic approach for calculating the solvation energy of a dipolar molecule. You will apply this model to a chemically relevant problem: determining how a solvent alters the rotational barrier of a molecule. This practice will solidify your understanding of differential solvation, the principle that a solvent's effect on a process depends on how it stabilizes the initial and final (or transition) states differently.", "problem": "A substituted biphenyl derivative exhibits a gas-phase rotational barrier between a planar minimum and an approximately orthogonal saddle point. In a solvent, the barrier changes because the two structures have different electric dipole moments and are differentially stabilized by the solvent. Using a continuum picture of solvation appropriate for an advanced model such as the Polarizable Continuum Model (PCM), approximate the solvation of each structure by placing a point dipole of magnitude $\\,\\mu\\,$ at the center of a spherical cavity of radius $\\,a\\,$ embedded in a linear, isotropic dielectric medium with relative permittivity $\\,\\varepsilon_r\\,$. Starting only from the following fundamental bases and well-tested facts, derive the expressions you need and implement them to predict solvent effects on the barrier:\n- The electrostatic energy of a dipole $\\,\\boldsymbol{\\mu}\\,$ in an electric field $\\,\\mathbf{E}\\,$ is $\\,U = -\\boldsymbol{\\mu}\\cdot \\mathbf{E}\\,$.\n- For a self-consistent polarization problem, the stabilization by the reaction field $\\,\\mathbf{R}\\,$ generated by the polarized dielectric is given by $\\,U_{\\text{solv}} = -\\tfrac{1}{2}\\,\\boldsymbol{\\mu}\\cdot \\mathbf{R}\\,$.\n- The boundary-value solution for a point dipole at the center of a spherical cavity in a uniform dielectric produces a reaction field that is proportional to $\\,\\boldsymbol{\\mu}\\,$, depends on $\\,\\varepsilon_r\\,$, and decays as $\\,a^{-3}\\,$.\n- The relative permittivity $\\,\\varepsilon_r\\,$ scales the vacuum permittivity $\\,\\varepsilon_0\\,$ through $\\,\\varepsilon = \\varepsilon_r \\varepsilon_0\\,$, and Coulomb interactions carry the factor $\\,1/(4\\pi \\varepsilon_0)\\,$.\n\nFrom this base, derive an explicit expression for the solvation free energy $\\,\\Delta G_{\\text{solv}}(\\mu,a,\\varepsilon_r)\\,$ of each state (planar minimum and orthogonal saddle) in terms of $\\,\\mu\\,$, $\\,a\\,$, $\\,\\varepsilon_r\\,$, and physical constants, and then compute the solvent-corrected barrier\n$$\n\\Delta G^{\\ddagger}_{\\text{solv}} \\;=\\; \\Delta G^{\\ddagger}_{\\text{gas}} \\;+\\; \\big(\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}}\\big),\n$$\nwhere $\\,\\Delta G^{\\ddagger}_{\\text{gas}}\\,$ is the gas-phase barrier, $\\,\\Delta G_{\\text{solv}}^{\\text{TS}}\\,$ is the solvation free energy of the transition state (orthogonal conformer), and $\\,\\Delta G_{\\text{solv}}^{\\text{min}}\\,$ is that of the minimum (planar conformer).\n\nUse the following physical constants in the International System of Units: vacuum permittivity $\\,\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}\\,$, Coulomb constant $\\,k_e = 1/(4\\pi\\varepsilon_0)\\,$, Avogadro’s number $\\,N_A = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}\\,$, Debye-to-SI conversion $\\,1\\,\\mathrm{D} = 3.33564\\times 10^{-30}\\,\\mathrm{C\\,m}\\,$, and Angstrom-to-meter conversion $\\,1\\,\\text{\\AA} = 1.0\\times 10^{-10}\\,\\mathrm{m}\\,$.\n\nYour program must compute solvent-corrected barriers for the following test suite. Each test case is a tuple $(\\Delta G^{\\ddagger}_{\\text{gas}}, \\mu_{\\text{min}}, \\mu_{\\text{TS}}, a, \\varepsilon_r)$ with $\\,\\Delta G^{\\ddagger}_{\\text{gas}}\\,$ in $\\mathrm{kJ\\,mol^{-1}}$, $\\,\\mu_{\\text{min}}\\,$ and $\\,\\mu_{\\text{TS}}\\,$ in $\\mathrm{D}$, $\\,a\\,$ in $\\text{\\AA}$, and $\\,\\varepsilon_r\\,$ dimensionless:\n- Test $\\,1\\,$ (vacuum baseline): $(\\,8.000,\\, 2.000,\\, 2.000,\\, 4.500,\\, 1.000\\,)$.\n- Test $\\,2\\,$ (nonpolar solvent, larger transition-state dipole): $(\\,9.000,\\, 1.500,\\, 3.000,\\, 4.500,\\, 2.380\\,)$.\n- Test $\\,3\\,$ (polar solvent, same geometry as Test $\\,2\\,$): $(\\,9.000,\\, 1.500,\\, 3.000,\\, 4.500,\\, 35.700\\,)$.\n- Test $\\,4\\,$ (water, larger minimum dipole): $(\\,12.000,\\, 5.000,\\, 2.500,\\, 5.000,\\, 78.400\\,)$.\n- Test $\\,5\\,$ (larger cavity, equal dipoles): $(\\,7.500,\\, 4.000,\\, 4.000,\\, 6.000,\\, 35.700\\,)$.\n\nImplementation requirements:\n- For each test case, compute $\\,\\Delta G_{\\text{solv}}^{\\text{min}}\\,$ and $\\,\\Delta G_{\\text{solv}}^{\\text{TS}}\\,$ from your derived expression, then report $\\,\\Delta G^{\\ddagger}_{\\text{solv}}\\,$ in $\\mathrm{kJ\\,mol^{-1}}$.\n- Express the final numerical answers in $\\mathrm{kJ\\,mol^{-1}}$, rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$), in the same order as the test cases.", "solution": "The problem statement is critically evaluated and found to be valid. It is scientifically grounded, well-posed, and self-contained. The problem describes the Onsager reaction field model, a standard approximation in computational chemistry for estimating the effect of a dielectric continuum solvent on a solute's properties. The provided physical principles, constants, and data are consistent and physically realistic, allowing for a rigorous and unambiguous solution.\n\nThe objective is to derive an expression for the electrostatic component of the free energy of solvation, $\\Delta G_{\\text{solv}}$, within the Onsager model and use it to calculate the solvent-corrected rotational barrier, $\\Delta G^{\\ddagger}_{\\text{solv}}$, for several test cases. The total barrier is given by:\n$$\n\\Delta G^{\\ddagger}_{\\text{solv}} = \\Delta G^{\\ddagger}_{\\text{gas}} + (\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}})\n$$\nwhere $\\Delta G^{\\ddagger}_{\\text{gas}}$ is the gas-phase barrier, and $\\Delta G_{\\text{solv}}^{\\text{TS}}$ and $\\Delta G_{\\text{solv}}^{\\text{min}}$ are the solvation free energies of the transition state and minimum energy conformer, respectively.\n\nWe begin the derivation from the provided principles. In this continuum model, the electrostatic contribution to the solvation free energy is approximated by the work done to polarize the dielectric, which is given as $U_{\\text{solv}} = -\\tfrac{1}{2}\\,\\boldsymbol{\\mu}\\cdot \\mathbf{R}$. We assume $\\Delta G_{\\text{solv}} \\approx U_{\\text{solv}}$. Here, $\\boldsymbol{\\mu}$ is the solute's permanent dipole moment and $\\mathbf{R}$ is the reaction field it induces in the surrounding dielectric medium.\n\nThe problem specifies a point dipole $\\boldsymbol{\\mu}$ at the center of a spherical cavity of radius $a$, embedded in a medium of relative permittivity $\\varepsilon_r$. For this configuration, the solution to the electrostatic boundary-value problem yields a uniform reaction field $\\mathbf{R}$ inside the cavity that is parallel to $\\boldsymbol{\\mu}$. This field is given by the well-known Onsager reaction field formula:\n$$\n\\mathbf{R} = \\frac{1}{4\\pi\\varepsilon_0} \\frac{2(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\boldsymbol{\\mu}}{a^3}\n$$\nThis expression is consistent with the problem's hint that $\\mathbf{R}$ is proportional to $\\boldsymbol{\\mu}$, depends on $\\varepsilon_r$, and includes factors of $1/(4\\pi\\varepsilon_0)$ and $a^{-3}$.\n\nSubstituting this expression for $\\mathbf{R}$ into the energy formula, we obtain the solvation free energy for a single molecule. Since $\\mathbf{R}$ and $\\boldsymbol{\\mu}$ are parallel, their dot product becomes the product of their magnitudes, $\\mu^2$:\n$$\n\\Delta G_{\\text{solv}} = -\\frac{1}{2} \\boldsymbol{\\mu} \\cdot \\left( \\frac{1}{4\\pi\\varepsilon_0} \\frac{2(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\boldsymbol{\\mu}}{a^3} \\right) = - \\frac{1}{4\\pi\\varepsilon_0} \\frac{(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\mu^2}{a^3}\n$$\nThe problem requires a result in molar energy units (e.g., $\\mathrm{kJ\\,mol^{-1}}$). Therefore, we multiply by Avogadro's number, $N_A$, to obtain the molar solvation free energy:\n$$\n\\Delta G_{\\text{solv, molar}}(\\mu, a, \\varepsilon_r) = - N_A \\frac{1}{4\\pi\\varepsilon_0} \\frac{(\\varepsilon_r - 1)}{2\\varepsilon_r + 1} \\frac{\\mu^2}{a^3}\n$$\nThe term $\\frac{1}{4\\pi\\varepsilon_0}$ is the Coulomb constant, $k_e$. The expression for the change in the barrier, $\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}}$, can now be written explicitly. As the cavity radius $a$ and the solvent $\\varepsilon_r$ are assumed to be the same for both the minimum and transition state, we have:\n$$\n\\Delta G_{\\text{solv}}^{\\text{TS}} - \\Delta G_{\\text{solv}}^{\\text{min}} = - N_A k_e \\left( \\frac{\\varepsilon_r - 1}{2\\varepsilon_r + 1} \\right) \\frac{1}{a^3} \\left( \\mu_{\\text{TS}}^2 - \\mu_{\\text{min}}^2 \\right)\n$$\nThis expression gives the correction to the rotational barrier due to differential solvation of the two conformers. The sign of the correction depends on whether the minimum or the transition state has a larger dipole moment. If $\\mu_{\\text{TS}} > \\mu_{\\text{min}}$, the transition state is stabilized more by the solvent, and the barrier is lowered. Conversely, if $\\mu_{\\text{min}} > \\mu_{\\text{TS}}$, the minimum is stabilized more, and the barrier is raised. If $\\mu_{\\text{min}} = \\mu_{\\text{TS}}$ or if $\\varepsilon_r = 1$ (vacuum), the solvation correction to the barrier is zero.\n\nFor computation, all input parameters must be converted to base SI units: dipole moments $(\\mu)$ from Debye $(\\mathrm{D})$ to Coulomb-meters $(\\mathrm{C\\,m})$, and the cavity radius $(a)$ from Angstroms $(\\text{\\AA})$ to meters $(\\mathrm{m})$. The calculated energy difference will be in $\\mathrm{J\\,mol^{-1}}$ and must be converted to $\\mathrm{kJ\\,mol^{-1}}$ before being added to the gas-phase barrier $\\Delta G^{\\ddagger}_{\\text{gas}}$, which is provided in $\\mathrm{kJ\\,mol^{-1}}$. The final result, $\\Delta G^{\\ddagger}_{\\text{solv}}$, will then be in the required units of $\\mathrm{kJ\\,mol^{-1}}$. The implementation will systematically apply this derived formula to each test case using the provided physical constants.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the solvent-corrected rotational barrier for a biphenyl derivative\n    using the Onsager reaction field model.\n    \"\"\"\n\n    # --- Physical Constants (SI units) ---\n    # Vacuum permittivity in F/m\n    EPSILON_0 = 8.8541878128e-12\n    # Avogadro's number in mol^-1\n    N_A = 6.02214076e23\n    # Coulomb constant k_e = 1 / (4*pi*eps0) in N m^2 C^-2\n    K_E = 1 / (4 * np.pi * EPSILON_0)\n\n    # --- Unit Conversion Factors ---\n    # 1 Debye to C*m\n    D_TO_SI = 3.33564e-30\n    # 1 Angstrom to m\n    A_TO_M = 1.0e-10\n\n    # --- Test Cases ---\n    # Each case: (dG_gas [kJ/mol], mu_min [D], mu_ts [D], a [Å], eps_r)\n    test_cases = [\n        (8.000, 2.000, 2.000, 4.500, 1.000),    # Test 1\n        (9.000, 1.500, 3.000, 4.500, 2.380),    # Test 2\n        (9.000, 1.500, 3.000, 4.500, 35.700),   # Test 3\n        (12.000, 5.000, 2.500, 5.000, 78.400),  # Test 4\n        (7.500, 4.000, 4.000, 6.000, 35.700),   # Test 5\n    ]\n\n    results = []\n    for case in test_cases:\n        dG_gas, mu_min_D, mu_ts_D, a_A, eps_r = case\n\n        # The change in solvation energy is zero if eps_r is 1 (vacuum)\n        # or if the dipole moments of the two states are identical.\n        if eps_r == 1.0 or mu_min_D == mu_ts_D:\n            dG_solv_barrier = dG_gas\n            results.append(f\"{dG_solv_barrier:.3f}\")\n            continue\n\n        # Convert inputs to SI units\n        mu_min_SI = mu_min_D * D_TO_SI\n        mu_ts_SI = mu_ts_D * D_TO_SI\n        a_SI = a_A * A_TO_M\n\n        # Calculate the dielectric factor from the Onsager model\n        dielectric_factor = (eps_r - 1) / (2 * eps_r + 1)\n\n        # Calculate the molar solvation energies for min and TS in J/mol\n        # Formula: dG_solv = -N_A * k_e * dielectric_factor * mu^2 / a^3\n        \n        # Calculate the difference in solvation energy between TS and min\n        # dG(solv, TS) - dG(solv, min)\n        # = -N_A*k_e*f_eps/a^3 * (mu_ts^2 - mu_min^2)\n        \n        # Group constants to avoid re-calculation\n        # The equation for the change in the barrier due to solvation is:\n        # delta_delta_G = - (N_A * K_E * dielectric_factor / a_SI**3) * (mu_ts_SI**2 - mu_min_SI**2)\n\n        mu_min_sq_SI = mu_min_SI**2\n        mu_ts_sq_SI = mu_ts_SI**2\n\n        prefactor = -N_A * K_E * dielectric_factor / (a_SI**3)\n        delta_delta_G_J_per_mol = prefactor * (mu_ts_sq_SI - mu_min_sq_SI)\n\n        # Convert the energy difference from J/mol to kJ/mol\n        delta_delta_G_kJ_per_mol = delta_delta_G_J_per_mol / 1000.0\n\n        # Calculate the final solvent-corrected barrier\n        dG_solv_barrier = dG_gas + delta_delta_G_kJ_per_mol\n\n        # Append the formatted result\n        results.append(f\"{dG_solv_barrier:.3f}\")\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2462555"}, {"introduction": "Having seen how differential solvation can alter kinetic barriers, we now apply the same principles to understand its effect on thermodynamic equilibria. This practice [@problem_id:2462628] uses the Onsager model to investigate the well-known keto-enol tautomerism, where the balance between two forms of a molecule is highly dependent on the solvent environment. By calculating the shift in equilibrium as a function of solvent polarity, you will directly connect the microscopic concept of solvation free energy to a macroscopic, measurable outcome—the equilibrium mole fraction of the tautomers. This exercise demonstrates the predictive power of continuum models in rationalizing solvent-dependent chemical phenomena.", "problem": "A dipolar-solvation model is used to analyze solvent polarity effects on the keto–enol tautomeric equilibrium of acetylacetone. The keto and enol tautomers are modeled as point dipoles located at the centers of spherical cavities embedded in a homogeneous, isotropic, linear dielectric continuum. The electrostatic solvation free energy of a dipole with magnitude $\\,\\mu\\,$ (in Coulomb meter) at the center of a spherical cavity of radius $\\,a\\,$ (in meter) in a medium of relative permittivity $\\,\\varepsilon_r\\,$ is given by\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon_r-1}{2\\varepsilon_r+1},\n$$\nwhere $\\,\\varepsilon_0\\,$ is the vacuum permittivity and $\\,N_{\\mathrm{A}}\\,$ is the Avogadro constant. The gas-phase standard free energy difference between tautomers is defined as $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$ at temperature $\\,T\\,$. In a solvent of permittivity $\\,\\varepsilon_r\\,$, the standard free energy difference becomes\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon_r) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\nwith $\\,\\mu_{\\mathrm{k}}\\,$ and $\\,a_{\\mathrm{k}}\\,$ the dipole moment and cavity radius of the keto tautomer, and $\\,\\mu_{\\mathrm{e}}\\,$ and $\\,a_{\\mathrm{e}}\\,$ those of the enol tautomer. The equilibrium constant for keto relative to enol is\n$$\nK(\\varepsilon_r) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon_r)}{R\\,T}\\right),\n$$\nwhere $\\,R\\,$ is the ideal gas constant. The mole fraction of the enol tautomer at equilibrium is then\n$$\nx_{\\mathrm{enol}}(\\varepsilon_r) = \\frac{1}{1 + K(\\varepsilon_r)}.\n$$\n\nUse the following physically grounded parameters for acetylacetone at temperature $\\,T = 298.15\\,$ K:\n- Gas-phase free energy difference: $\\,\\Delta G_{\\mathrm{gas}} = 12000\\,$ J/mol.\n- Keto tautomer dipole moment: $\\,\\mu_{\\mathrm{k}} = 4.0\\,$ Debye.\n- Enol tautomer dipole moment: $\\,\\mu_{\\mathrm{e}} = 1.7\\,$ Debye.\n- Keto tautomer cavity radius: $\\,a_{\\mathrm{k}} = 3.0\\,$ Ångström.\n- Enol tautomer cavity radius: $\\,a_{\\mathrm{e}} = 3.3\\,$ Ångström.\n\nUse the following constants:\n- Vacuum permittivity: $\\,\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,$ F/m.\n- Avogadro constant: $\\,N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,$ mol$^{-1}$.\n- Ideal gas constant: $\\,R = 8.31446261815324\\,$ J/(mol·K).\n\nRequired unit conversions:\n- $\\,1\\,$ Debye $= 3.33564\\times 10^{-30}\\,$ C·m.\n- $\\,1\\,$ Ångström $= 1.0\\times 10^{-10}\\,$ m.\n\nTask: For each value of relative permittivity $\\,\\varepsilon_r\\,$ in the test suite\n$$\n[\\;1.0,\\;2.0,\\;10.0,\\;78.4,\\;200.0\\;],\n$$\ncompute the enol mole fraction $\\,x_{\\mathrm{enol}}(\\varepsilon_r)\\,$ as a dimensionless decimal. Express each result rounded to exactly six decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\mathrm{r}_1,\\mathrm{r}_2,\\dots]$). The output must be a list of five floats corresponding, in order, to the test permittivities given above.", "solution": "We aim to determine how solvent polarity, quantified by the relative permittivity $\\,\\varepsilon_r\\,$, affects the keto–enol equilibrium of acetylacetone using a continuum electrostatics model. The framework is the Onsager reaction field model, which provides the electrostatic solvation free energy $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu,a)\\,$ for a dipole $\\,\\mu\\,$ at the center of a spherical cavity of radius $\\,a\\,$ embedded in a dielectric medium of permittivity $\\,\\varepsilon_r\\,$:\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon_r-1}{2\\varepsilon_r+1}.\n$$\nThis expression follows from classical electrostatics by computing the work of polarizing the medium and converting single-molecule energy to molar units via the Avogadro constant $\\,N_{\\mathrm{A}}\\,$. The solvation favors larger dipole moments and smaller cavity radii, with the stabilization increasing monotonically with $\\,\\varepsilon_r\\,$ through the factor $\\,(\\varepsilon_r-1)/(2\\varepsilon_r+1)\\,$, which is zero at $\\,\\varepsilon_r=1\\,$ and approaches $\\,1/2\\,$ as $\\,\\varepsilon_r\\to\\infty$.\n\nThe total standard free energy difference between keto and enol in the solvent is\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon_r) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\nwhere $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$ is given at $\\,T=298.15\\,$ K. A positive $\\,\\Delta G_{\\mathrm{tot}}\\,$ means the keto tautomer is less stable than the enol tautomer in the specified solvent. The equilibrium constant for keto relative to enol is the standard thermodynamic relation\n$$\nK(\\varepsilon_r) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon_r)}{R\\,T}\\right),\n$$\nand the enol mole fraction is\n$$\nx_{\\mathrm{enol}}(\\varepsilon_r) = \\frac{1}{1+K(\\varepsilon_r)}.\n$$\n\nAll quantities must be used in consistent International System of Units (SI). Therefore, convert the given dipole moments and radii as\n$$\n\\mu_{\\mathrm{k}} = 4.0 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\\quad\n\\mu_{\\mathrm{e}} = 1.7 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\n$$\n$$\na_{\\mathrm{k}} = 3.0 \\times 10^{-10}\\;\\mathrm{m},\\quad\na_{\\mathrm{e}} = 3.3 \\times 10^{-10}\\;\\mathrm{m}.\n$$\nUse the constants\n$$\n\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\;\\mathrm{F/m},\\quad\nN_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\;\\mathrm{mol^{-1}},\\quad\nR = 8.31446261815324\\;\\mathrm{J/(mol\\cdot K)},\\quad\nT = 298.15\\;\\mathrm{K}.\n$$\n\nFor each $\\,\\varepsilon_r\\,$ in the test suite $[\\,1.0,\\,2.0,\\,10.0,\\,78.4,\\,200.0\\,]$, carry out the following computations in SI units:\n1. Compute $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu_{\\mathrm{k}},a_{\\mathrm{k}})\\,$ and $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon_r;\\mu_{\\mathrm{e}},a_{\\mathrm{e}})\\,$ using the expression above.\n2. Form $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon_r)\\,$ via the difference of keto and enol solvation free energies added to $\\,\\Delta G_{\\mathrm{gas}}=12000\\,$ J/mol.\n3. Compute $\\,K(\\varepsilon_r) = \\exp\\!\\left(-\\Delta G_{\\mathrm{tot}}(\\varepsilon_r)/(R T)\\right)\\,$.\n4. Compute $\\,x_{\\mathrm{enol}}(\\varepsilon_r) = 1/(1+K(\\varepsilon_r))\\,$, a dimensionless decimal.\n\nQualitative expectations consistent with the model:\n- At $\\,\\varepsilon_r=1\\,$ (no solvent polarization), $\\,\\Delta G_{\\mathrm{solv}}=0\\,$ for both tautomers, hence $\\,\\Delta G_{\\mathrm{tot}}=\\Delta G_{\\mathrm{gas}}\\,,$ so $\\,x_{\\mathrm{enol}}\\,$ is close to $\\,1\\,$ because $\\,\\Delta G_{\\mathrm{gas}} > 0\\,$ favors the enol tautomer.\n- As $\\,\\varepsilon_r\\,$ increases, the solvation stabilization is larger for the keto tautomer due to its larger dipole moment and slightly smaller cavity radius, so $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon_r)\\,$ decreases, and $\\,x_{\\mathrm{enol}}(\\varepsilon_r)\\,$ decreases monotonically.\n- The factor $\\,(\\varepsilon_r-1)/(2\\varepsilon_r+1)\\,$ saturates to $\\,1/2\\,$ for large $\\,\\varepsilon_r\\,$, so there is a finite limit to the solvent-induced shift in this model.\n\nThe program implements these principles, performs unit-consistent calculations, evaluates $\\,x_{\\mathrm{enol}}(\\varepsilon_r)\\,$ for the specified $\\,\\varepsilon_r\\,$ values, rounds each to exactly six decimal places, and outputs a single list line in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef onsager_solvation_energy(mu_debye, a_angstrom, eps_r):\n    \"\"\"\n    Compute electrostatic solvation free energy (J/mol) via the Onsager reaction field model:\n    ΔG_solv(ε; μ, a) = - N_A * μ^2 / (8π ε0 a^3) * ( (ε - 1) / (2 ε + 1) )\n    Inputs:\n        mu_debye: dipole moment in Debye\n        a_angstrom: cavity radius in Ångström\n        eps_r: relative permittivity (dimensionless)\n    Returns:\n        ΔG_solv in J/mol (float)\n    \"\"\"\n    # Constants (SI)\n    eps0 = 8.8541878128e-12  # F/m\n    NA = 6.02214076e23       # 1/mol\n    # Unit conversions\n    mu = mu_debye * 3.33564e-30     # C·m\n    a = a_angstrom * 1.0e-10        # m\n    # Onsager factor\n    reaction_factor = (eps_r - 1.0) / (2.0 * eps_r + 1.0)\n    # Energy\n    dG = - NA * (mu**2) / (8.0 * np.pi * eps0 * (a**3)) * reaction_factor\n    return dG\n\ndef enol_fraction(eps_r, params):\n    \"\"\"\n    Compute enol mole fraction for a given relative permittivity.\n    params: dict with keys ΔG_gas (J/mol), mu_k (D), a_k (Å), mu_e (D), a_e (Å), T (K), R (J/mol/K)\n    \"\"\"\n    dG_gas = params[\"dG_gas\"]\n    mu_k = params[\"mu_k\"]\n    a_k = params[\"a_k\"]\n    mu_e = params[\"mu_e\"]\n    a_e = params[\"a_e\"]\n    T = params[\"T\"]\n    R = params[\"R\"]\n\n    dG_solv_k = onsager_solvation_energy(mu_k, a_k, eps_r)\n    dG_solv_e = onsager_solvation_energy(mu_e, a_e, eps_r)\n    dG_tot = dG_gas + dG_solv_k - dG_solv_e\n    K = np.exp(-dG_tot / (R * T))\n    x_enol = 1.0 / (1.0 + K)\n    return x_enol\n\ndef solve():\n    # Define the test cases from the problem statement (relative permittivities).\n    test_eps = [1.0, 2.0, 10.0, 78.4, 200.0]\n\n    # Physical parameters\n    params = {\n        \"dG_gas\": 12000.0,              # J/mol (G_keto - G_enol)\n        \"mu_k\": 4.0,                    # Debye\n        \"a_k\": 3.0,                     # Å\n        \"mu_e\": 1.7,                    # Debye\n        \"a_e\": 3.3,                     # Å\n        \"T\": 298.15,                    # K\n        \"R\": 8.31446261815324           # J/(mol·K)\n    }\n\n    results = []\n    for eps_r in test_eps:\n        x = enol_fraction(eps_r, params)\n        # Round to exactly six decimal places\n        x_str = f\"{x:.6f}\"\n        results.append(x_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2462628"}]}