{"hands_on_practices": [{"introduction": "This first practice provides a foundational look at the Potential of Mean Force (PMF) using a classic chemical example: the torsional isomerization of butane. By working with a simplified one-dimensional model, you will directly calculate how the PMF profile changes between the gas phase and a solvent environment. This exercise highlights the crucial insight that for a 1D system, the PMF difference simplifies to the potential energy difference, a concept that will be tested across different temperatures.", "problem": "You are given a one-dimensional torsional model for the central carbon–carbon dihedral of butane. The collective variable is the dihedral angle $\\phi \\in [-\\pi,\\pi]$ in radians. The potential of mean force (PMF) $W(\\phi)$ along $\\phi$ in the canonical ensemble at absolute temperature $T$ is defined, up to an additive constant, by the Boltzmann probability density $P(\\phi)$ via the relationship\n$$\nW(\\phi) = -k_{\\mathrm{B}} T \\ln P(\\phi) + C,\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $C$ is an arbitrary constant. For this one-dimensional model, the effective potential energy for the gas phase is prescribed as\n$$\nU_{\\mathrm{gas}}(\\phi) = \\frac{A}{2}\\left(1+\\cos(3\\phi)\\right) + \\frac{B}{2}\\left(1-\\cos\\phi\\right),\n$$\nand for explicit water it is given by\n$$\nU_{\\mathrm{water}}(\\phi) = U_{\\mathrm{gas}}(\\phi) + \\frac{S}{2}\\left(1-\\cos\\phi\\right).\n$$\nAll energy parameters $A$, $B$, and $S$ are in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and angles are in radians. Use the parameter values $A = 12.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $B = -2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and $S = 1.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. Use the ideal gas constant $R = 0.008314462618\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ for $k_{\\mathrm{B}}$ on a per-mole basis. The PMF $W(\\phi)$ is only defined up to an additive constant, so only differences in $W(\\phi)$ are physically meaningful.\n\nDefine the following dihedral configurations:\n- Trans: $\\phi_{\\mathrm{t}} = \\pi$,\n- Gauche: $\\phi_{\\mathrm{g}} = \\pi/3$,\n- Eclipsed (barrier reference): $\\phi_{\\mathrm{e}} = 0$.\n\nFor each specified temperature $T$, and for each environment $\\mathrm{env} \\in \\{\\mathrm{gas}, \\mathrm{water}\\}$, compute the following quantities in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$:\n1. The PMF difference between gauche and trans, $\\Delta W_{\\mathrm{g-t}}^{\\mathrm{env}} = W^{\\mathrm{env}}(\\phi_{\\mathrm{g}}) - W^{\\mathrm{env}}(\\phi_{\\mathrm{t}})$.\n2. The barrier height relative to trans, $\\Delta W_{\\mathrm{e-t}}^{\\mathrm{env}} = W^{\\mathrm{env}}(\\phi_{\\mathrm{e}}) - W^{\\mathrm{env}}(\\phi_{\\mathrm{t}})$.\n\nAlso compute, for each temperature $T$, the environment-induced changes:\n- $\\Delta\\Delta W_{\\mathrm{g-t}} = \\Delta W_{\\mathrm{g-t}}^{\\mathrm{water}} - \\Delta W_{\\mathrm{g-t}}^{\\mathrm{gas}}$ in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n- $\\Delta\\Delta W_{\\mathrm{e-t}} = \\Delta W_{\\mathrm{e-t}}^{\\mathrm{water}} - \\Delta W_{\\mathrm{e-t}}^{\\mathrm{gas}}$ in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\nAnswer in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, rounded to three decimal places. The angle unit is radians.\n\nTest Suite (temperatures):\n- Case $1$: $T = 298.15\\,\\mathrm{K}$,\n- Case $2$: $T = 150.0\\,\\mathrm{K}$,\n- Case $3$: $T = 1000.0\\,\\mathrm{K}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing a list of results, one per temperature case, where each case is represented by a list of six floating-point numbers in the following order:\n$[\\Delta W_{\\mathrm{g-t}}^{\\mathrm{gas}}, \\Delta W_{\\mathrm{g-t}}^{\\mathrm{water}}, \\Delta\\Delta W_{\\mathrm{g-t}}, \\Delta W_{\\mathrm{e-t}}^{\\mathrm{gas}}, \\Delta W_{\\mathrm{e-t}}^{\\mathrm{water}}, \\Delta\\Delta W_{\\mathrm{e-t}}]$.\nAggregate the three cases into a single list of lists and print them as a single line, with all numbers rounded to three decimal places, for example:\n$$\n[[x_{11},x_{12},x_{13},x_{14},x_{15},x_{16}],[x_{21},x_{22},x_{23},x_{24},x_{25},x_{26}],[x_{31},x_{32},x_{33},x_{34},x_{35},x_{36}]].\n$$", "solution": "The problem statement has been analyzed and is determined to be valid. It is a well-posed problem in computational chemistry, based on established principles of statistical mechanics. All necessary parameters and definitions are provided, and there are no internal contradictions or scientific inaccuracies. The problem tests the fundamental understanding of the relationship between potential energy and the Potential of Mean Force (PMF) in a simple one-dimensional system.\n\nThe core of the problem lies in the definition of the PMF, $W(\\phi)$, in the canonical ensemble:\n$$W(\\phi) = -k_{\\mathrm{B}} T \\ln P(\\phi) + C$$\nwhere $P(\\phi)$ is the Boltzmann probability density, $k_{\\mathrm{B}}$ is the Boltzmann constant (given as the gas constant $R$ on a molar basis), $T$ is the absolute temperature, and $C$ is an arbitrary constant.\n\nThe probability density $P(\\phi)$ for a one-dimensional system with potential energy $U(\\phi)$ is given by:\n$$P(\\phi) = \\frac{e^{-U(\\phi) / (RT)}}{Z}$$\nwhere the partition function $Z$ is the integral over all possible states:\n$$Z = \\int_{-\\pi}^{\\pi} e^{-U(\\phi') / (RT)} d\\phi'$$\nSubstituting the expression for $P(\\phi)$ into the definition of $W(\\phi)$ yields:\n$$W(\\phi) = -RT \\ln \\left( \\frac{e^{-U(\\phi) / (RT)}}{Z} \\right) + C$$\nUsing the properties of logarithms, this expands to:\n$$W(\\phi) = -RT \\left( -\\frac{U(\\phi)}{RT} - \\ln Z \\right) + C$$\n$$W(\\phi) = U(\\phi) + RT \\ln Z + C$$\nThe term $RT \\ln Z + C$ is a constant with respect to the coordinate $\\phi$. Let us define this as a new constant, $C'$. Thus, we find the critical relationship for this system:\n$$W(\\phi) = U(\\phi) + C'$$\nThis demonstrates that for a one-dimensional system where the potential depends only on a single coordinate, the Potential of Mean Force is equivalent to the potential energy profile, up to an additive constant. Consequently, any PMF difference, $\\Delta W$, is identical to the potential energy difference, $\\Delta U$:\n$$\\Delta W = W(\\phi_2) - W(\\phi_1) = (U(\\phi_2) + C') - (U(\\phi_1) + C') = U(\\phi_2) - U(\\phi_1) = \\Delta U$$\nThis result is independent of the temperature $T$. The explicit inclusion of $T$ in the problem statement serves to test this fundamental understanding; the final numerical results will be identical for all specified temperatures.\n\nThe potential energy functions are given for gas and water environments:\n$$U_{\\mathrm{gas}}(\\phi) = \\frac{A}{2}\\left(1+\\cos(3\\phi)\\right) + \\frac{B}{2}\\left(1-\\cos\\phi\\right)$$\n$$U_{\\mathrm{water}}(\\phi) = U_{\\mathrm{gas}}(\\phi) + \\frac{S}{2}\\left(1-\\cos\\phi\\right) = \\frac{A}{2}\\left(1+\\cos(3\\phi)\\right) + \\frac{B+S}{2}\\left(1-\\cos\\phi\\right)$$\nThe specified angles are trans ($\\phi_{\\mathrm{t}} = \\pi$), gauche ($\\phi_{\\mathrm{g}} = \\pi/3$), and eclipsed ($\\phi_{\\mathrm{e}} = 0$). We evaluate the potentials at these points.\n\nFirst, we evaluate the trigonometric components:\n- For $\\phi_{\\mathrm{t}} = \\pi$: $\\cos(\\phi_{\\mathrm{t}}) = -1$, $\\cos(3\\phi_{\\mathrm{t}}) = -1$.\n- For $\\phi_{\\mathrm{g}} = \\pi/3$: $\\cos(\\phi_{\\mathrm{g}}) = 1/2$, $\\cos(3\\phi_{\\mathrm{g}}) = -1$.\n- For $\\phi_{\\mathrm{e}} = 0$: $\\cos(\\phi_{\\mathrm{e}}) = 1$, $\\cos(3\\phi_{\\mathrm{e}}) = 1$.\n\nNow, we compute the potential energies:\n\n**Gas Phase:**\n- $U_{\\mathrm{gas}}(\\phi_{\\mathrm{t}}) = \\frac{A}{2}(1 + (-1)) + \\frac{B}{2}(1 - (-1)) = 0 + \\frac{B}{2}(2) = B$\n- $U_{\\mathrm{gas}}(\\phi_{\\mathrm{g}}) = \\frac{A}{2}(1 + (-1)) + \\frac{B}{2}(1 - 1/2) = 0 + \\frac{B}{2}(1/2) = \\frac{B}{4}$\n- $U_{\\mathrm{gas}}(\\phi_{\\mathrm{e}}) = \\frac{A}{2}(1 + 1) + \\frac{B}{2}(1 - 1) = \\frac{A}{2}(2) + 0 = A$\n\n**Water Phase:** The calculations are identical, replacing $B$ with $(B+S)$.\n- $U_{\\mathrm{water}}(\\phi_{\\mathrm{t}}) = B+S$\n- $U_{\\mathrm{water}}(\\phi_{\\mathrm{g}}) = (B+S)/4$\n- $U_{\\mathrm{water}}(\\phi_{\\mathrm{e}}) = A$\n\nWith these energies, we compute the required differences.\n\n1.  **$\\Delta W_{\\mathrm{g-t}}^{\\mathrm{gas}}$ (Gauche vs. Trans in Gas):**\n    $$\\Delta W_{\\mathrm{g-t}}^{\\mathrm{gas}} = U_{\\mathrm{gas}}(\\phi_{\\mathrm{g}}) - U_{\\mathrm{gas}}(\\phi_{\\mathrm{t}}) = \\frac{B}{4} - B = -\\frac{3B}{4}$$\n2.  **$\\Delta W_{\\mathrm{g-t}}^{\\mathrm{water}}$ (Gauche vs. Trans in Water):**\n    $$\\Delta W_{\\mathrm{g-t}}^{\\mathrm{water}} = U_{\\mathrm{water}}(\\phi_{\\mathrm{g}}) - U_{\\mathrm{water}}(\\phi_{\\mathrm{t}}) = \\frac{B+S}{4} - (B+S) = -\\frac{3(B+S)}{4}$$\n3.  **$\\Delta\\Delta W_{\\mathrm{g-t}}$ (Environmental Change for Gauche-Trans):**\n    $$\\Delta\\Delta W_{\\mathrm{g-t}} = \\Delta W_{\\mathrm{g-t}}^{\\mathrm{water}} - \\Delta W_{\\mathrm{g-t}}^{\\mathrm{gas}} = -\\frac{3(B+S)}{4} - \\left(-\\frac{3B}{4}\\right) = -\\frac{3S}{4}$$\n4.  **$\\Delta W_{\\mathrm{e-t}}^{\\mathrm{gas}}$ (Eclipsed vs. Trans in Gas):**\n    $$\\Delta W_{\\mathrm{e-t}}^{\\mathrm{gas}} = U_{\\mathrm{gas}}(\\phi_{\\mathrm{e}}) - U_{\\mathrm{gas}}(\\phi_{\\mathrm{t}}) = A - B$$\n5.  **$\\Delta W_{\\mathrm{e-t}}^{\\mathrm{water}}$ (Eclipsed vs. Trans in Water):**\n    $$\\Delta W_{\\mathrm{e-t}}^{\\mathrm{water}} = U_{\\mathrm{water}}(\\phi_{\\mathrm{e}}) - U_{\\mathrm{water}}(\\phi_{\\mathrm{t}}) = A - (B+S) = A - B - S$$\n6.  **$\\Delta\\Delta W_{\\mathrm{e-t}}$ (Environmental Change for Eclipsed-Trans):**\n    $$\\Delta\\Delta W_{\\mathrm{e-t}} = \\Delta W_{\\mathrm{e-t}}^{\\mathrm{water}} - \\Delta W_{\\mathrm{e-t}}^{\\mathrm{gas}} = (A - B - S) - (A - B) = -S$$\n\nFinally, we substitute the given parameter values: $A = 12.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $B = -2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and $S = 1.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\n- $\\Delta W_{\\mathrm{g-t}}^{\\mathrm{gas}} = -\\frac{3(-2.0)}{4} = \\frac{6.0}{4} = 1.5\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n- $\\Delta W_{\\mathrm{g-t}}^{\\mathrm{water}} = -\\frac{3(-2.0+1.0)}{4} = -\\frac{3(-1.0)}{4} = \\frac{3.0}{4} = 0.75\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n- $\\Delta\\Delta W_{\\mathrm{g-t}} = -\\frac{3(1.0)}{4} = -0.75\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n- $\\Delta W_{\\mathrm{e-t}}^{\\mathrm{gas}} = 12.0 - (-2.0) = 14.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n- $\\Delta W_{\\mathrm{e-t}}^{\\mathrm{water}} = 12.0 - (-2.0+1.0) = 12.0 - (-1.0) = 13.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n- $\\Delta\\Delta W_{\\mathrm{e-t}} = -1.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n\nThese results are constant for all test cases, as they are independent of temperature $T$. Each temperature case will produce the following list of results, rounded to three decimal places: $[1.500, 0.750, -0.750, 14.000, 13.000, -1.000]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the butane dihedral PMF problem.\n    For a 1D system, the PMF difference is equal to the potential energy difference,\n    making the result independent of temperature.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        298.15,  # Case 1: T in K\n        150.0,   # Case 2: T in K\n        1000.0,  # Case 3: T in K\n    ]\n\n    # Parameters in kJ/mol\n    A = 12.0\n    B = -2.0\n    S = 1.0\n\n    all_results = []\n\n    # The calculations are independent of temperature T, so the result for each case is identical.\n    # The loop is maintained to produce the required output structure for three cases.\n    for _ in test_cases:\n        # We proceed using the analytical formulas derived from the potential energy functions.\n        # This is more robust and computationally efficient than re-evaluating trigonometric functions.\n        # W(phi) = U(phi) + C', so Delta_W = Delta_U.\n\n        # Delta W (gauche-trans) in gas\n        dw_gt_gas = -3.0 * B / 4.0\n\n        # Delta W (gauche-trans) in water\n        dw_gt_water = -3.0 * (B + S) / 4.0\n\n        # Delta Delta W (gauche-trans)\n        ddw_gt = -3.0 * S / 4.0\n\n        # Delta W (eclipsed-trans) in gas\n        dw_et_gas = A - B\n\n        # Delta W (eclipsed-trans) in water\n        dw_et_water = A - (B + S)\n\n        # Delta Delta W (eclipsed-trans)\n        ddw_et = -S\n\n        # Assemble the results for one case\n        case_results = [\n            dw_gt_gas,\n            dw_gt_water,\n            ddw_gt,\n            dw_et_gas,\n            dw_et_water,\n            ddw_et,\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string precisely as required.\n    # It must be a string representation of a list of lists of floats,\n    # with each float formatted to 3 decimal places and no spaces.\n    outer_list_str = []\n    for case in all_results:\n        inner_list_str = f\"[{','.join([f'{val:.3f}' for val in case])}]\"\n        outer_list_str.append(inner_list_str)\n\n    final_output_str = f\"[{','.join(outer_list_str)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "2460692"}, {"introduction": "Building upon the concept of a PMF profile, this exercise delves into the practicalities of computing it using umbrella sampling. You will quantitatively investigate how a key simulation parameter, the harmonic spring constant $k$, influences the statistical overlap between adjacent sampling windows and the overall computational efficiency. This practice will give you an analytical understanding of the trade-offs involved in setting up robust and efficient PMF calculations.", "problem": "You are to write a complete program that quantitatively examines how varying the harmonic spring constant $k$ in umbrella sampling affects (i) the statistical overlap between adjacent windows and (ii) a simple proxy for computational efficiency defined as the minimum number of evenly spaced windows required to ensure a specified target overlap. The system is a one-dimensional reaction coordinate $x$ with a known underlying Potential of Mean Force (PMF), sampled with harmonic umbrella potentials at absolute temperature $T$.\n\nSystem definition:\n- Underlying PMF: $U_{0}(x) = \\tfrac{1}{2}\\,k_{0}\\,(x - x_{c})^{2}$ in kJ/mol, with $k_{0} = 25$ kJ/(mol·nm$^{2}$) and $x_{c} = 0.5$ nm.\n- Umbrella potential in window $i$: $U_{b}^{(i)}(x) = \\tfrac{1}{2}\\,k\\,(x - x_{0}^{(i)})^{2}$ in kJ/mol, where $k$ is the spring constant (to be varied) in kJ/(mol·nm$^{2}$).\n- Canonical ensemble at temperature $T = 300$ K with Boltzmann constant $k_{\\mathrm{B}} = 0.008314462618$ kJ/(mol·K), so $\\beta = 1/(k_{\\mathrm{B}} T)$ in (mol/kJ).\n- Reaction coordinate domain for window placement: the interval $[0, L]$ with $L = 1.0$ nm.\n\nStatistical overlap metric:\n- For each umbrella window $i$, define the normalized canonical distribution at temperature $T$ for the biased potential $U_{0}(x) + U_{b}^{(i)}(x)$:\n$$\np_{i}(x) = \\frac{\\exp\\!\\left(-\\beta\\,[U_{0}(x) + U_{b}^{(i)}(x)]\\right)}{\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\beta\\,[U_{0}(x) + U_{b}^{(i)}(x)]\\right)\\,dx}.\n$$\n- The statistical overlap between adjacent windows $i$ and $i+1$ is defined via the Bhattacharyya coefficient\n$$\nB_{i,i+1} = \\int_{-\\infty}^{\\infty} \\sqrt{\\,p_{i}(x)\\,p_{i+1}(x)\\,}\\;dx,\n$$\nwhich is a dimensionless quantity in $[0,1]$. Higher values indicate greater overlap.\n\nEfficiency proxy:\n- For a given target minimum overlap $B_{\\min}$ (dimensionless), define $N_{\\mathrm{req}}(k)$ as the smallest integer number of evenly spaced windows on $[0, L]$ whose adjacent-window overlaps are all at least $B_{\\min}$.\n\nProgram tasks and required outputs:\n1) Fix $N_{\\mathrm{fix}} = 5$ evenly spaced umbrella window centers $x_{0}^{(i)}$ over $[0,L]$ and, for each given $k$, compute the average adjacent-window overlap\n$$\n\\overline{B}(k) = \\frac{1}{N_{\\mathrm{fix}}-1}\\sum_{i=1}^{N_{\\mathrm{fix}}-1} B_{i,i+1}.\n$$\nReport $\\overline{B}(k)$ rounded to six decimal places (dimensionless).\n2) For each given $k$, with the same system parameters, compute the minimum required number of windows $N_{\\mathrm{req}}(k)$ so that every adjacent pair on $[0,L]$ achieves at least the target overlap $B_{\\min} = 0.3$ (dimensionless). Report $N_{\\mathrm{req}}(k)$ as an integer.\n\nTest suite:\n- Use the following three spring constants $k$ (in kJ/(mol·nm$^{2}$)): $k \\in \\{1.0, 10.0, 200.0\\}$.\n- Use $k_{0} = 25.0$ kJ/(mol·nm$^{2}$), $x_{c} = 0.5$ nm, $L = 1.0$ nm, $T = 300.0$ K, $k_{\\mathrm{B}} = 0.008314462618$ kJ/(mol·K), $N_{\\mathrm{fix}} = 5$, and $B_{\\min} = 0.3$ as specified above.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each $k$ in the order given above, output a two-element list $[\\overline{B}(k), N_{\\mathrm{req}}(k)]$, where $\\overline{B}(k)$ is rounded to six decimal places and $N_{\\mathrm{req}}(k)$ is an integer. For example, an output with three cases must look like\n$[[\\overline{B}(k_{1}),N_{\\mathrm{req}}(k_{1})],[\\overline{B}(k_{2}),N_{\\mathrm{req}}(k_{2})],[\\overline{B}(k_{3}),N_{\\mathrm{req}}(k_{3})]]$\non a single line.", "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique and meaningful solution. The analysis proceeds as follows.\n\nThe core of the problem is to compute the statistical overlap between probability distributions arising from adjacent umbrella sampling windows. The total potential energy in window $i$, centered at $x_{0}^{(i)}$, is the sum of the underlying Potential of Mean Force (PMF) $U_{0}(x)$ and the harmonic biasing potential $U_{b}^{(i)}(x)$:\n$$\nU_{i}(x) = U_{0}(x) + U_{b}^{(i)}(x) = \\frac{1}{2} k_{0} (x - x_{c})^{2} + \\frac{1}{2} k (x - x_{0}^{(i)})^{2}\n$$\nThis is a quadratic function of the reaction coordinate $x$. In the canonical ensemble, the probability distribution of $x$ is given by $p_{i}(x) \\propto \\exp(-\\beta U_{i}(x))$, where $\\beta = 1/(k_{\\mathrm{B}} T)$. Since $U_{i}(x)$ is quadratic in $x$, the resulting distribution $p_{i}(x)$ is a Gaussian (normal) distribution.\n\nTo determine the parameters of this Gaussian distribution, we complete the square for $U_{i}(x)$:\n$$\n\\begin{aligned}\nU_{i}(x) &= \\frac{1}{2} [k_{0}(x^2 - 2xx_{c} + x_{c}^2) + k(x^2 - 2xx_{0}^{(i)} + (x_{0}^{(i)})^2)] \\\\\n&= \\frac{1}{2} [(k_{0}+k)x^2 - 2(k_{0}x_{c} + kx_{0}^{(i)})x + (k_{0}x_{c}^2 + k(x_{0}^{(i)})^2)]\n\\end{aligned}\n$$\nThis can be written in the standard form $\\frac{1}{2}K(x-\\mu)^2 + C$. By comparing coefficients, we identify the effective spring constant $K = k_{0} + k$ and the mean of the distribution $\\mu_{i}$:\n$$\n\\mu_{i} = \\frac{k_{0}x_{c} + kx_{0}^{(i)}}{k_{0} + k}\n$$\nThe probability distribution for window $i$ is $p_{i}(x) \\propto \\exp(-\\beta \\frac{1}{2}(k_{0}+k)(x-\\mu_{i})^2)$. Comparing the exponent to the standard form of a Gaussian, $-\\frac{(x-\\mu)^2}{2\\sigma^2}$, we find the variance $\\sigma_{i}^2$:\n$$\n\\frac{1}{2\\sigma_{i}^2} = \\frac{\\beta(k_{0}+k)}{2} \\implies \\sigma_{i}^2 = \\frac{1}{\\beta(k_{0}+k)}\n$$\nNote that the variance, let us call it $\\sigma^2$, is independent of the window index $i$; it is the same for all windows given a fixed spring constant $k$. So, $p_{i}(x)$ is a normal distribution $\\mathcal{N}(x; \\mu_{i}, \\sigma^2)$.\n\nThe statistical overlap between adjacent windows $i$ and $i+1$ is given by the Bhattacharyya coefficient, $B_{i,i+1} = \\int_{-\\infty}^{\\infty} \\sqrt{p_{i}(x)p_{i+1}(x)} dx$. For two Gaussian distributions with means $\\mu_{i}$, $\\mu_{i+1}$ and a common variance $\\sigma^2$, this integral has a known analytical solution:\n$$\nB_{i,i+1} = \\exp\\left(-\\frac{(\\mu_{i} - \\mu_{i+1})^2}{8\\sigma^2}\\right)\n$$\nWe need to evaluate the difference in the means for adjacent windows. Let $\\Delta x_{0} = x_{0}^{(i+1)} - x_{0}^{(i)}$ be the spacing between adjacent window centers.\n$$\n\\mu_{i} - \\mu_{i+1} = \\frac{k_{0}x_{c} + kx_{0}^{(i)}}{k_{0} + k} - \\frac{k_{0}x_{c} + kx_{0}^{(i+1)}}{k_{0} + k} = \\frac{k(x_{0}^{(i)} - x_{0}^{(i+1)})}{k_{0} + k} = -\\frac{k\\,\\Delta x_{0}}{k_{0} + k}\n$$\nSubstituting this and the expression for $\\sigma^2$ into the formula for $B_{i,i+1}$:\n$$\nB_{i,i+1} = \\exp\\left(-\\frac{\\left(-\\frac{k\\,\\Delta x_{0}}{k_{0} + k}\\right)^2}{8 \\left(\\frac{1}{\\beta(k_{0}+k)}\\right)}\\right) = \\exp\\left(-\\frac{k^2 (\\Delta x_{0})^2}{(k_{0} + k)^2} \\frac{\\beta(k_{0}+k)}{8}\\right)\n$$\nThis simplifies to the final expression for the overlap, which depends on $k$ and $\\Delta x_{0}$:\n$$\nB_{i,i+1} = \\exp\\left(- \\frac{\\beta k^2 (\\Delta x_{0})^2}{8(k_{0} + k)}\\right)\n$$\nSince window centers are evenly spaced, $\\Delta x_{0}$ is constant for all adjacent pairs $i, i+1$, and thus $B_{i,i+1}$ is also constant for a given $k$ and number of windows.\n\n**Task 1: Compute the average overlap $\\overline{B}(k)$**\nFor a fixed number of windows $N_{\\mathrm{fix}}=5$ on the interval $[0, L]$, the centers are $x_0^{(i)} = \\frac{i-1}{N_{\\mathrm{fix}}-1}L$ for $i=1, \\dots, 5$. The spacing is constant: $\\Delta x_{0} = L/(N_{\\mathrm{fix}}-1)$. Since all adjacent-pair overlaps $B_{i,i+1}$ are equal, the average overlap $\\overline{B}(k)$ is simply equal to this common value.\n$$\n\\overline{B}(k) = B_{i,i+1} = \\exp\\left(- \\frac{\\beta k^2 (L/(N_{\\mathrm{fix}}-1))^2}{8(k_{0} + k)}\\right)\n$$\n\n**Task 2: Compute the required number of windows $N_{\\mathrm{req}}(k)$**\nWe need to find the minimum integer $N \\geq 2$ such that the overlap for adjacent windows is at least $B_{\\min}=0.3$. For $N$ evenly spaced windows, the spacing is $\\Delta x_{0} = L/(N-1)$. The condition is:\n$$\n\\exp\\left(- \\frac{\\beta k^2 (L/(N-1))^2}{8(k_{0} + k)}\\right) \\geq B_{\\min}\n$$\nSolving for $N$:\n$$\n- \\frac{\\beta k^2 L^2}{8(k_{0} + k)(N-1)^2} \\geq \\ln(B_{\\min})\n$$\nSince $B_{\\min} < 1$, $\\ln(B_{\\min})$ is negative. Multiplying by $-1$ reverses the inequality:\n$$\n\\frac{\\beta k^2 L^2}{8(k_{0} + k)(N-1)^2} \\leq -\\ln(B_{\\min})\n$$\nIsolating $(N-1)^2$:\n$$\n(N-1)^2 \\geq \\frac{\\beta k^2 L^2}{8(k_{0} + k) [-\\ln(B_{\\min})]}\n$$\nSince $N \\geq 2$, $N-1$ is positive, so we can take the square root:\n$$\nN-1 \\geq \\sqrt{\\frac{\\beta k^2 L^2}{8(k_{0} + k) [-\\ln(B_{\\min})]}} = \\frac{kL\\sqrt{\\beta}}{\\sqrt{8(k_{0} + k) [-\\ln(B_{\\min})]}}\n$$\n$$\nN \\geq 1 + \\frac{kL\\sqrt{\\beta}}{\\sqrt{8(k_{0} + k) [-\\ln(B_{\\min})]}}\n$$\nSince $N$ must be an integer, $N_{\\mathrm{req}}(k)$ is the ceiling of the right-hand side.\n$$\nN_{\\mathrm{req}}(k) = \\left\\lceil 1 + \\frac{kL\\sqrt{\\beta}}{\\sqrt{8(k_{0} + k) [-\\ln(B_{\\min})]}} \\right\\rceil\n$$\nThese derived analytical expressions are implemented in the provided program to compute the required values for the given test suite of spring constants $k \\in \\{1.0, 10.0, 200.0\\}$ kJ/(mol·nm$^2$), using $k_0 = 25.0$ kJ/(mol·nm$^2$), $L=1.0$ nm, $T=300.0$ K, $k_{\\mathrm{B}} = 0.008314462618$ kJ/(mol·K), $N_{\\mathrm{fix}}=5$, and $B_{\\min} = 0.3$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes overlap metrics for umbrella sampling based on an analytical model.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    k0 = 25.0  # kJ/(mol·nm^2)\n    L = 1.0  # nm\n    T = 300.0  # K\n    kB = 0.008314462618  # kJ/(mol·K)\n    beta = 1.0 / (kB * T)  # mol/kJ\n    N_fix = 5  # Fixed number of windows for task 1\n    B_min = 0.3  # Target minimum overlap for task 2\n\n    # Test cases for the harmonic spring constant k in kJ/(mol·nm^2)\n    test_cases_k = [1.0, 10.0, 200.0]\n\n    def calculate_average_overlap(k):\n        \"\"\"\n        Task 1: Computes the average adjacent-window overlap for N_fix=5 windows.\n        \n        Args:\n            k (float): The umbrella spring constant in kJ/(mol·nm^2).\n        \n        Returns:\n            float: The average Bhattacharyya coefficient.\n        \"\"\"\n        if N_fix < 2:\n            # Overlap is not defined for less than 2 windows.\n            return 0.0\n            \n        delta_x0 = L / (N_fix - 1)\n        \n        # Argument of the exponential function for the Bhattacharyya coefficient\n        exponent_arg = -(beta * k**2 * delta_x0**2) / (8 * (k0 + k))\n        \n        # For evenly spaced windows, the average overlap is equal to any single\n        # adjacent-pair overlap.\n        b_avg = np.exp(exponent_arg)\n        \n        return b_avg\n\n    def calculate_required_windows(k):\n        \"\"\"\n        Task 2: Computes the minimum number of windows to ensure overlap >= B_min.\n\n        Args:\n            k (float): The umbrella spring constant in kJ/(mol·nm^2).\n\n        Returns:\n            int: The minimum required number of windows.\n        \"\"\"\n        if B_min <= 0 or B_min > 1:\n            raise ValueError(\"B_min must be in (0, 1].\")\n        \n        # If the overlap condition is trivially met (B_min=1), it would require\n        # infinite windows unless k=0, which is not a tested case. Return based on formula.\n        # But here B_min=0.3 so -log(B_min) is well-defined and positive.\n\n        # Term under the square root in the derived formula for N\n        radicand = (beta * k**2 * L**2) / (8 * (k0 + k) * (-np.log(B_min)))\n        \n        # The minimum (non-integer) number of windows required\n        n_float = 1.0 + np.sqrt(radicand)\n        \n        # The number of windows must be an integer, so we take the ceiling.\n        # The formula inherently ensures N>=2 since k>0 and sqrt term is positive.\n        n_req = int(np.ceil(n_float))\n        \n        return n_req\n\n    results = []\n    for k in test_cases_k:\n        b_bar = calculate_average_overlap(k)\n        n_req = calculate_required_windows(k)\n        results.append((b_bar, n_req))\n\n    # Format the output as specified: [[B(k1),N_req(k1)],[B(k2),N_req(k2)],...]\n    # Using f-string formatting to control decimal places and structure.\n    output_parts = [f\"[{res[0]:.6f},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(output_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2460733"}, {"introduction": "Our final practice is a critical thinking exercise that addresses the interpretation of simulation results. Sometimes, a PMF calculation can yield a surprising outcome, such as a negative activation barrier, which seemingly violates chemical intuition. This problem challenges you to diagnose several distinct physical and methodological reasons that could lead to such a result, reinforcing a deeper understanding of projection effects, sampling artifacts, and the very definition of the PMF.", "problem": "A potential of mean force (PMF) calculation is performed for a conformational transition using umbrella sampling and the Weighted Histogram Analysis Method (WHAM). The PMF is reported as a function of a scalar reaction coordinate $\\xi$, and the apparent barrier height is defined as $\\Delta W^{\\ddagger} \\equiv W(\\xi^{\\ddagger}) - W(\\xi_{\\mathrm{A}})$, where $\\xi_{\\mathrm{A}}$ is the location of the reactant basin minimum and $\\xi^{\\ddagger}$ is the location of the highest-probability dividing surface identified along $\\xi$. Surprisingly, the analysis yields $\\Delta W^{\\ddagger} < 0$ and this feature appears robust across repeated runs.\n\nWhich three of the following are physically or methodologically plausible explanations for the observation $\\Delta W^{\\ddagger} < 0$? Select exactly three options.\n\nA. The reaction coordinate $\\xi$ is non-Cartesian (e.g., a distance or angle), and the analysis omitted the appropriate geometric (Jacobian/Fixman) correction when converting a constrained free energy or mean force to the PMF, introducing an extra entropic term that can lower $W(\\xi)$ at larger $|\\xi|$ and yield an apparently negative barrier.\n\nB. The umbrella sampling windows have poor overlap and insufficient sampling near $\\xi_{\\mathrm{A}}$, leading to an underestimated marginal probability at $\\xi_{\\mathrm{A}}$ and thus an artificially small or negative $\\Delta W^{\\ddagger}$ after WHAM reweighting.\n\nC. The chosen reaction coordinate $\\xi$ does not resolve the true bottleneck; many microstates project to $\\xi \\approx \\xi^{\\ddagger}$ while fewer project to $\\xi \\approx \\xi_{\\mathrm{A}}$, so the marginalization onto $\\xi$ yields $W(\\xi^{\\ddagger}) < W(\\xi_{\\mathrm{A}})$ even though the true transition in the full space is activated.\n\nD. Changing the arbitrary additive constant used to set the zero of $W(\\xi)$ can by itself change the sign of $\\Delta W^{\\ddagger}$, making a positive barrier appear negative.\n\nE. Quantum tunneling at the simulation temperature reduces the equilibrium PMF barrier below zero, so a negative $\\Delta W^{\\ddagger}$ is expected even with a correct classical PMF analysis.\n\nF. By definition, PMF barriers cannot be negative; therefore a negative $\\Delta W^{\\ddagger}$ necessarily implies a fundamental inconsistency and cannot arise from projection, entropy, or analysis choices.", "solution": "Begin from the definition of the potential of mean force (PMF) along a coordinate $\\xi$ at temperature $T$,\n$$\nW(\\xi) \\equiv -k_{\\mathrm{B}} T \\ln P(\\xi) + C,\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant, $P(\\xi)$ is the equilibrium marginal probability density of observing the system at coordinate $\\xi$, and $C$ is an arbitrary additive constant. The barrier height defined in the problem is\n$$\n\\Delta W^{\\ddagger} \\equiv W(\\xi^{\\ddagger}) - W(\\xi_{\\mathrm{A}}).\n$$\nBecause $C$ cancels in differences, $\\Delta W^{\\ddagger}$ is determined by the ratio of probabilities,\n$$\n\\Delta W^{\\ddagger} = -k_{\\mathrm{B}}T \\ln \\frac{P(\\xi^{\\ddagger})}{P(\\xi_{\\mathrm{A}})}.\n$$\nThus, $\\Delta W^{\\ddagger} < 0$ means $P(\\xi^{\\ddagger}) > P(\\xi_{\\mathrm{A}})$. This can occur for several physical or methodological reasons tied to how $P(\\xi)$ is constructed, how $\\xi$ is defined, and how reweighting is performed.\n\nAnalyze each option:\n\nA. The reaction coordinate $\\xi$ is non-Cartesian and the analysis omitted the appropriate geometric (Jacobian/Fixman) correction. Along curvilinear coordinates, the metric determinant (Jacobian) $J(\\xi)$ contributes an entropic term to the PMF. For example, for a radial distance coordinate $r$, the number of microstates grows as $4\\pi r^{2}$, and one finds $W(r) = -k_{\\mathrm{B}}T \\ln P(r) = -k_{\\mathrm{B}}T \\ln \\left[\\tilde{P}(r)\\, J(r)\\right] + C$, where $\\tilde{P}(r)$ is a probability defined per unit coordinate without the geometric factor and $J(r) \\propto r^{2}$. If the conversion from mean force or constrained free energy to $W(\\xi)$ omits the geometric (Fixman) term, the apparent $W(\\xi)$ can be spuriously lowered in regions of large $J(\\xi)$, potentially making $W(\\xi^{\\ddagger}) < W(\\xi_{\\mathrm{A}})$ and yielding $\\Delta W^{\\ddagger} < 0$. This is a well-known methodological pitfall and is therefore plausible. Verdict: Correct.\n\nB. Poor overlap and insufficient sampling near $\\xi_{\\mathrm{A}}$ can bias $P(\\xi_{\\mathrm{A}})$ downward. In umbrella sampling, the Weighted Histogram Analysis Method (WHAM) relies on sufficient overlap between biased windows and adequate sampling to reconstruct unbiased $P(\\xi)$. If windows around $\\xi_{\\mathrm{A}}$ are undersampled or underrepresented, WHAM may underestimate $P(\\xi_{\\mathrm{A}})$ relative to $P(\\xi^{\\ddagger})$, making $-k_{\\mathrm{B}}T \\ln\\big(P(\\xi^{\\ddagger})/P(\\xi_{\\mathrm{A}})\\big)$ more negative and producing $\\Delta W^{\\ddagger} < 0$. This is a credible methodological explanation. Verdict: Correct.\n\nC. An inadequate reaction coordinate can remove the barrier upon projection. The PMF along $\\xi$ is a many-to-one projection of the full free energy landscape. If the true bottleneck resides in orthogonal degrees of freedom not encoded by $\\xi$, the marginal $P(\\xi)$ can be larger near $\\xi^{\\ddagger}$ simply because a large number of microstates project to that value of $\\xi$ (high degeneracy), while fewer project to $\\xi_{\\mathrm{A}}$. Then $W(\\xi)$ can be downhill along $\\xi$ and even yield $W(\\xi^{\\ddagger}) < W(\\xi_{\\mathrm{A}})$. This is a physical explanation rooted in entropy and projection: the barrier can disappear or invert when viewed in an inadequate coordinate. Verdict: Correct.\n\nD. Changing the additive constant in $W(\\xi)$ cannot change $\\Delta W^{\\ddagger}$. From the expression $\\Delta W^{\\ddagger} = W(\\xi^{\\ddagger}) - W(\\xi_{\\mathrm{A}})$, any constant shift $C$ cancels. Therefore, choosing a different zero of free energy cannot change the sign of the barrier. Verdict: Incorrect.\n\nE. Quantum tunneling affects kinetics rather than the equilibrium PMF obtained from classical sampling and reweighting. In standard classical PMF calculations, nuclear quantum effects are not included, so tunneling cannot explain a negative $\\Delta W^{\\ddagger}$. Even when nuclear quantum effects are included via, for example, path-integral methods, the PMF remains an equilibrium free energy profile determined by partition functions; tunneling does not generically drive the activation free energy below zero. The statement that tunneling “reduces the equilibrium PMF barrier below zero” is not a general or appropriate explanation here. Verdict: Incorrect.\n\nF. There is no fundamental prohibition against a negative $\\Delta W^{\\ddagger}$ as defined; the PMF is defined up to an additive constant, and its shape along a chosen $\\xi$ can, in principle, place $W(\\xi^{\\ddagger})$ below $W(\\xi_{\\mathrm{A}})$ if the projection and entropic factors favor $\\xi^{\\ddagger}$, or if analysis errors distort $P(\\xi)$. Therefore, asserting impossibility “by definition” is false. Verdict: Incorrect.\n\nTherefore, the three plausible explanations are options A, B, and C.", "answer": "$$\\boxed{ABC}$$", "id": "2460690"}]}