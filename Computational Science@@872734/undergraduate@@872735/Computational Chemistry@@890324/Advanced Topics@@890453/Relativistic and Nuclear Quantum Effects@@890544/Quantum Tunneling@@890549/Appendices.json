{"hands_on_practices": [{"introduction": "A cornerstone of quantum tunneling is that particles do not abruptly stop at a potential barrier they lack the energy to overcome. Instead, their wavefunction penetrates into this 'classically forbidden' region, decaying exponentially. This first exercise [@problem_id:2113730] provides a concrete, quantitative feel for this behavior by having you calculate the characteristic penetration depth, $\\delta$, for a proton in a nuclear physics scenario. Understanding this fundamental length scale is the first step toward grasping the nature of tunneling.", "problem": "In a simplified one-dimensional model of a nuclear interaction, a proton is directed towards a heavy, stationary atomic nucleus. The electrostatic repulsion between the proton and the nucleus can be modeled as a rectangular potential barrier of constant height $V_0$. The proton has a total energy $E$ which is less than the barrier height $V_0$.\n\nAccording to quantum mechanics, the proton's wavefunction does not become zero at the edge of this classically forbidden region. Instead, it penetrates the barrier and its amplitude decays exponentially with distance.\n\nGiven the following parameters:\n- The proton's total energy is $E = 5.0 \\text{ MeV}$.\n- The height of the potential barrier is $V_0 = 10.0 \\text{ MeV}$ (Mega-electron Volts).\n- The rest mass energy of the proton is $m_p c^2 = 938.3 \\text{ MeV}$.\n- The value of the physical constant $\\hbar c$ is $197.3 \\text{ MeV-fm}$, where fm denotes femtometers ($10^{-15} \\text{ m}$).\n\nCalculate the characteristic distance into the barrier over which the magnitude of the proton's wavefunction is attenuated by a factor of $1/e$. Express your final answer in femtometers (fm). Round your final answer to three significant figures.", "solution": "For a one-dimensional rectangular barrier with height $V_{0}$ and a particle of mass $m$ and energy $E  V_{0}$, the time-independent Schrödinger equation in the barrier region is\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi}{dx^{2}}+V_{0}\\psi=E\\psi.\n$$\nRearranging gives\n$$\n\\frac{d^{2}\\psi}{dx^{2}}=\\frac{2m\\left(V_{0}-E\\right)}{\\hbar^{2}}\\psi.\n$$\nDefining\n$$\n\\kappa=\\sqrt{\\frac{2m\\left(V_{0}-E\\right)}{\\hbar^{2}}},\n$$\nthe physically acceptable solution inside the barrier decays as\n$$\n\\psi(x)\\propto \\exp\\left(-\\kappa x\\right).\n$$\nThe characteristic distance $L$ over which the magnitude is attenuated by a factor of $1/e$ satisfies $\\exp(-\\kappa L)=\\exp(-1)$, hence\n$$\nL=\\frac{1}{\\kappa}.\n$$\nExpressing $\\kappa$ in terms of the given relativistic energy-unit constants,\n$$\n\\kappa=\\frac{1}{\\hbar c}\\sqrt{2\\left(m c^{2}\\right)\\left(V_{0}-E\\right)}.\n$$\nUsing $m c^{2}=m_{p} c^{2}=938.3 \\text{ MeV}$, $V_{0}-E=10.0 \\text{ MeV}-5.0 \\text{ MeV}=5.0 \\text{ MeV}$, and $\\hbar c=197.3 \\text{ MeV-fm}$,\n$$\n\\kappa=\\frac{\\sqrt{2\\cdot 938.3\\cdot 5.0}}{197.3}\\ \\text{fm}^{-1}=\\frac{\\sqrt{9383.0}}{197.3}\\ \\text{fm}^{-1}\\approx \\frac{96.866}{197.3}\\ \\text{fm}^{-1}\\approx 0.49096\\ \\text{fm}^{-1}.\n$$\nTherefore,\n$$\nL=\\frac{1}{\\kappa}\\approx \\frac{1}{0.49096}\\ \\text{fm}\\approx 2.0368\\ \\text{fm}.\n$$\nRounded to three significant figures, the characteristic distance is $2.04$ fm.", "answer": "$$\\boxed{2.04}$$", "id": "2113730"}, {"introduction": "The probability of tunneling is exquisitely sensitive to the properties of both the barrier and the particle. This practice [@problem_id:2113724] isolates one of the most important factors: the particle's mass. By directly comparing the tunneling probabilities of a lightweight electron and a much heavier muon, you will discover the dramatic role mass plays, yielding a result that powerfully explains why tunneling is a dominant effect for electrons in chemistry but is negligible for larger particles.", "problem": "In the design of next-generation computing hardware, understanding quantum tunneling through insulating barriers is crucial. Consider a simplified model where an electron and a muon are independently fired with the same incident kinetic energy, $E$, toward a rectangular potential barrier of height $V_0$ and width $L$. The kinetic energy of the particles is less than the barrier height. Due to their wave-like nature, both particles have a non-zero probability of tunneling through this classically forbidden region.\n\nYour task is to compare their tunneling probabilities. Assume that the tunneling probability is dominated by the exponential decay of the wavefunction inside the barrier, meaning any pre-exponential factors can be neglected or are identical for both particles.\n\nCalculate the numerical value of the ratio of the muon's tunneling probability to the electron's tunneling probability, $R = T_{\\mu} / T_{e}$.\n\nUse the following parameters for your calculation:\n- Barrier width: $L = 0.80 \\text{ nm}$\n- Barrier height: $V_0 = 10.0 \\text{ eV}$\n- Incident kinetic energy: $E = 6.0 \\text{ eV}$\n- Electron mass: $m_e = 9.11 \\times 10^{-31} \\text{ kg}$\n- The mass of a muon, $m_{\\mu}$, is 207 times the mass of an electron.\n- Reduced Planck constant: $\\hbar = 1.05 \\times 10^{-34} \\text{ J} \\cdot \\text{s}$\n- Elementary charge: $e = 1.60 \\times 10^{-19} \\text{ C}$\n\nRound your final answer to three significant figures.", "solution": "For a rectangular barrier with $E  V_{0}$, the evanescent wavenumber inside the barrier is $\\kappa = \\sqrt{2 m (V_{0} - E)}/\\hbar$, and the transmission probability is dominated by the exponential factor $T \\propto \\exp(-2 \\kappa L)$. Neglecting identical prefactors, the ratio of tunneling probabilities is\n$$\nR \\equiv \\frac{T_{\\mu}}{T_{e}} = \\exp\\!\\big[-2L(\\kappa_{\\mu} - \\kappa_{e})\\big].\n$$\nWith the same barrier parameters for both particles, $\\kappa$ depends on mass as $\\kappa \\propto \\sqrt{m}$. Using $m_{\\mu} = 207 m_{e}$, we have\n$$\n\\kappa_{\\mu} = \\sqrt{207}\\,\\kappa_{e},\n$$\nso\n$$\nR = \\exp\\!\\left[-2L\\,\\kappa_{e}\\left(\\sqrt{207}-1\\right)\\right].\n$$\nCompute $\\kappa_{e}$ from\n$$\n\\kappa_{e} = \\frac{\\sqrt{2 m_{e} \\Delta E}}{\\hbar}, \\quad \\Delta E = (V_{0} - E)e.\n$$\nNumerically, using the given values:\n$$\n\\Delta E = 4.0 \\times (1.60 \\times 10^{-19}) = 6.40 \\times 10^{-19} \\text{ J},\n$$\n$$\n\\frac{2 m_{e} \\Delta E}{\\hbar^{2}} = \\frac{2 \\times (9.11 \\times 10^{-31}) \\times (6.40 \\times 10^{-19})}{(1.05 \\times 10^{-34})^{2}} \\approx 1.05767 \\times 10^{20} \\text{ m}^{-2},\n$$\n$$\n\\kappa_{e} = \\sqrt{1.05767 \\times 10^{20}} \\approx 1.02842 \\times 10^{10} \\text{ m}^{-1}.\n$$\nThen\n$$\n2 L \\kappa_{e} \\approx 2 \\times (0.80 \\times 10^{-9}) \\times (1.02842 \\times 10^{10}) \\approx 16.4547,\n$$\nand with $\\sqrt{207} \\approx 14.3875$,\n$$\n2 L \\kappa_{e} \\left(\\sqrt{207} - 1\\right) \\approx 16.4547 \\times 13.3875 \\approx 220.287.\n$$\nTherefore,\n$$\nR = \\exp(-220.287) \\approx 2.14 \\times 10^{-96}.\n$$\nRounded to three significant figures, the ratio is $2.14 \\times 10^{-96}$.", "answer": "$$\\boxed{2.14 \\times 10^{-96}}$$", "id": "2113724"}, {"introduction": "Having explored the key principles of tunneling with idealized formulas, this capstone practice [@problem_id:2461151] challenges you to build a numerical solver from first principles. By implementing the transfer matrix method, you will create a powerful computational tool to calculate the transmission coefficient for any arbitrary potential barrier. This exercise bridges the gap between textbook theory and practical computational chemistry, allowing you to model complex phenomena like resonant tunneling that are critical in molecular electronics and enzyme catalysis.", "problem": "You are asked to implement a complete, runnable program that computes one-dimensional quantum tunneling transmission coefficients for stationary scattering states by numerically solving the time-independent Schrödinger equation using a stepwise-constant approximation to an arbitrary potential barrier. The scientific foundation must begin from first principles. Use the Time-Independent Schrödinger Equation (TISE) in one dimension,\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + \\frac{2 m}{\\hbar^2} \\left(E - V(x)\\right)\\psi(x) = 0,\n$$\ntogether with the continuity of the wavefunction and its first derivative at material interfaces, and the probability current definition for stationary states to define the transmission coefficient as a ratio of fluxes. Do not use any pre-stated formulas for transmission; instead, derive what you implement from these foundations in your own algorithmic steps.\n\nYou must work in Atomic Units (a.u.), where $m = 1$ for the electron mass and $\\hbar = 1$, so that the energy unit is the Hartree and the length unit is the Bohr. The transmission coefficient is dimensionless.\n\nYour implementation requirements are:\n- Discretize a finite domain $[x_L,x_R]$ into $N$ uniform slices of width $\\Delta x = (x_R - x_L)/N$.\n- Approximate $V(x)$ by a piecewise-constant function taking the value $V_j$ on slice $j$ at the slice midpoint.\n- Within each slice, solve the local form of the TISE and relate the wave amplitudes across each slice and each interface using continuity conditions.\n- Use these relations to propagate from the left lead to the right lead and compute the transmission coefficient $T$ as the ratio of transmitted to incident probability current, expressed as a real number in $[0,1]$.\n\nTest suite:\nImplement four test cases that exercise different physical regimes. In all cases, use $x_L = -10$ (in Bohr), $x_R = 10$ (in Bohr), and $N = 4000$.\n\n- Case A (single finite rectangular barrier, sub-barrier energy):\n  - Potential: $V(x) = V_0$ for $|x| \\le a/2$ and $V(x) = 0$ otherwise.\n  - Parameters: $V_0 = 0.5$ (Hartree), $a = 2.0$ (Bohr), $E = 0.2$ (Hartree).\n  - Expected qualitative behavior: $T$ is small but nonzero due to tunneling.\n\n- Case B (single finite rectangular barrier, high energy):\n  - Same potential and geometry as Case A.\n  - Parameters: $V_0 = 0.5$ (Hartree), $a = 2.0$ (Bohr), $E = 2.0$ (Hartree).\n  - Expected qualitative behavior: $T$ is close to $1$.\n\n- Case C (no barrier, free propagation):\n  - Potential: $V(x) = 0$ for all $x$.\n  - Parameters: $E = 0.3$ (Hartree).\n  - Expected qualitative behavior: $T = 1$.\n\n- Case D (double barrier with a resonant well):\n  - Potential: two identical rectangular barriers of height $V_0$ and width $b$, separated by a well of width $L_w$. Explicitly, $V(x) = V_0$ on $[-L_w/2 - b, -L_w/2] \\cup [L_w/2, L_w/2 + b]$ and $V(x) = 0$ elsewhere.\n  - Parameters: $V_0 = 0.6$ (Hartree), $b = 0.5$ (Bohr), $L_w = 4.0$ (Bohr), $E = 0.31$ (Hartree).\n  - Expected qualitative behavior: $T$ exhibits resonant enhancement and can approach $1$ near resonance.\n\nAngle units are not applicable. The transmission coefficients are dimensionless. Your program must produce a single line containing a Python-style list of the four numerical transmission values corresponding to the four cases, in the order A, B, C, D, each rounded to $6$ decimal places. The exact required output format is:\n\"[t_A,t_B,t_C,t_D]\"\nwith no spaces.\n\nYour program must not read any input. It must compute the four values and print the single required line. The final answers must be floats. The derivation and algorithm must be grounded only in the TISE, the continuity conditions at interfaces, and the probability current definition. Ensure numerical stability and scientific plausibility in your choices and computations.", "solution": "The problem is valid. It is scientifically grounded in the principles of quantum mechanics, is well-posed, objective, and contains all necessary information for a unique solution. We shall proceed with a full derivation and implementation.\n\nThe foundation of this problem is the one-dimensional time-independent Schrödinger equation (TISE). In atomic units, where the electron mass $m=1$ and the reduced Planck constant $\\hbar=1$, the TISE for a particle of energy $E$ in a potential $V(x)$ is:\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + 2 \\left(E - V(x)\\right)\\psi(x) = 0\n$$\nWe are tasked with solving this equation for a scattering state, where a particle is incident on a potential barrier from the left. The potential $V(x)$ is approximated as a piecewise-constant function. The domain of interest, $[x_L, x_R]$, is discretized into $N$ uniform slices, each of width $\\Delta x = (x_R - x_L)/N$. Within each slice $j$, spanning the interval $[x_{j-1}, x_j]$ where $x_j = x_L + j\\Delta x$, the potential is held constant at $V_j = V(x_{j-1} + \\Delta x/2)$.\n\nIn slice $j$, the TISE takes the form of a simple harmonic oscillator equation:\n$$\n\\frac{d^2 \\psi_j(x)}{dx^2} + k_j^2 \\psi_j(x) = 0\n$$\nwhere $k_j^2 = 2(E - V_j)$ is the square of the local wave number. The nature of the solution depends on the sign of $k_j^2$:\n1.  If $E > V_j$, $k_j = \\sqrt{2(E - V_j)}$ is real. The solution is oscillatory, representing propagating waves: $\\psi_j(x) = A_j e^{i k_j x} + B_j e^{-i k_j x}$.\n2.  If $E  V_j$, $k_j = i\\sqrt{2(V_j - E)} \\equiv i\\kappa_j$ is purely imaginary, with $\\kappa_j$ real. The solution is exponential, representing evanescent (non-propagating) waves: $\\psi_j(x) = A_j e^{-\\kappa_j x} + B_j e^{\\kappa_j x}$.\n\nTo solve the system across the entire domain, we employ the transfer matrix method. Instead of tracking the coefficients $(A_j, B_j)$, which can be numerically unstable, we propagate the state vector $\\mathbf{S}(x) = \\begin{pmatrix} \\psi(x) \\\\ \\psi'(x) \\end{pmatrix}$, where $\\psi'(x) = d\\psi/dx$. The continuity of $\\psi(x)$ and $\\psi'(x)$ at the interfaces between slices is naturally preserved by this method.\n\nWithin slice $j$, we need a matrix $\\mathbf{P}_j$ that relates the state at the end of the slice, $\\mathbf{S}(x_j)$, to the state at the beginning, $\\mathbf{S}(x_{j-1})$: $\\mathbf{S}(x_j) = \\mathbf{P}_j \\mathbf{S}(x_{j-1})$.\nThe general solution in slice $j$ can be written as $\\psi(x) = C \\cos(k_j(x-x_{j-1})) + D \\sin(k_j(x-x_{j-1}))$. At $x=x_{j-1}$, we have $\\psi(x_{j-1}) = C$ and $\\psi'(x_{j-1}) = D k_j$, which allows us to express $C$ and $D$ in terms of the initial state vector. Evaluating $\\psi(x)$ and $\\psi'(x)$ at $x=x_j=x_{j-1}+\\Delta x$ yields the propagation matrix $\\mathbf{P}_j$.\n\nCase 1: $E > V_j$ ($k_j$ real and non-zero)\nThe solution is oscillatory. The propagation matrix is:\n$$\n\\mathbf{P}_j = \\begin{pmatrix} \\cos(k_j \\Delta x)  \\frac{1}{k_j}\\sin(k_j \\Delta x) \\\\ -k_j \\sin(k_j \\Delta x)  \\cos(k_j \\Delta x) \\end{pmatrix}\n$$\nCase 2: $E  V_j$ ($\\kappa_j$ real and non-zero)\nThe solution is exponential. Using $\\cos(iy) = \\cosh(y)$ and $\\sin(iy) = i\\sinh(y)$, the propagation matrix becomes:\n$$\n\\mathbf{P}_j = \\begin{pmatrix} \\cosh(\\kappa_j \\Delta x)  \\frac{1}{\\kappa_j}\\sinh(\\kappa_j \\Delta x) \\\\ \\kappa_j \\sinh(\\kappa_j \\Delta x)  \\cosh(\\kappa_j \\Delta x) \\end{pmatrix}\n$$\nCase 3: $E = V_j$ ($k_j=0$)\nThe TISE simplifies to $\\psi''(x)=0$, with solution $\\psi(x) = Ax+B$. The propagation matrix is the limit of Case 1 as $k_j \\to 0$:\n$$\n\\mathbf{P}_j = \\begin{pmatrix} 1  \\Delta x \\\\ 0  1 \\end{pmatrix}\n$$\nThe state at the right boundary $x_R=x_N$ is related to the state at the left boundary $x_L=x_0$ by the product of all slice propagation matrices:\n$$\n\\mathbf{S}(x_R) = (\\mathbf{P}_N \\mathbf{P}_{N-1} \\cdots \\mathbf{P}_1) \\mathbf{S}(x_L) \\equiv \\mathbf{P}_{total} \\mathbf{S}(x_L)\n$$\nThe problem specifies scattering boundary conditions. We assume the potential is zero outside the domain $[x_L, x_R]$.\n-   In the left lead ($x \\leq x_L$), the wavefunction is a superposition of an incident wave with unit amplitude and a reflected wave: $\\psi_L(x) = e^{ik_0 x} + r e^{-ik_0 x}$, where $k_0 = \\sqrt{2E}$.\n-   In the right lead ($x \\geq x_R$), there is only a transmitted wave: $\\psi_R(x) = t e^{ik_0 x}$.\n\nFrom these forms, we determine the state vectors at the boundaries:\n$$\n\\mathbf{S}(x_L) = \\begin{pmatrix} e^{ik_0 x_L} + r e^{-ik_0 x_L} \\\\ ik_0(e^{ik_0 x_L} - r e^{-ik_0 x_L}) \\end{pmatrix} \\quad , \\quad \\mathbf{S}(x_R) = t \\begin{pmatrix} e^{ik_0 x_R} \\\\ ik_0 e^{ik_0 x_R} \\end{pmatrix}\n$$\nSubstituting these into the relation $\\mathbf{S}(x_R) = \\mathbf{P}_{total} \\mathbf{S}(x_L)$ gives a system of two linear equations for the unknown complex amplitudes $r$ and $t$. Let $\\mathbf{P}_{total} = \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{21}  P_{22} \\end{pmatrix}$. Solving this system for the transmission amplitude $t$ yields:\n$$\nt = \\frac{-2ik_0 e^{-ik_0(x_R-x_L)}}{ (P_{21} - k_0^2 P_{12}) - i k_0 (P_{11} + P_{22}) }\n$$\nThe transmission coefficient $T$ is defined as the ratio of the transmitted probability current to the incident probability current. The probability current for a stationary state is $j(x) = \\frac{1}{2i}(\\psi^* \\psi' - \\psi \\psi'^*)$.\n-   Incident current: $j_{inc} = k_0$ (for incident wave $e^{ik_0 x}$).\n-   Transmitted current: $j_{trans} = |t|^2 k_0$ (for transmitted wave $t e^{ik_0 x}$).\nThe transmission coefficient is therefore $T = j_{trans}/j_{inc} = |t|^2$.\nUsing the expression for $t$, and noting that the propagation matrices $\\mathbf{P}_j$ are real, we find:\n$$\nT = |t|^2 = \\frac{4k_0^2}{|(P_{21} - k_0^2 P_{12}) - i k_0 (P_{11} + P_{22})|^2} = \\frac{4k_0^2}{(P_{21} - k_0^2 P_{12})^2 + k_0^2(P_{11} + P_{22})^2}\n$$\nThis formula allows for a direct computation of the transmission coefficient.\n\nThe algorithm is as follows:\n1.  For each test case, define the energy $E$ and the potential function $V(x)$.\n2.  Set up the spatial grid and calculate the constant potential $V_j$ for each of the $N$ slices.\n3.  Calculate the free-space wave number $k_0 = \\sqrt{2E}$.\n4.  Initialize the total propagation matrix $\\mathbf{P}_{total}$ to the $2 \\times 2$ identity matrix.\n5.  Iterate through each slice $j=1, \\ldots, N$. In each iteration, compute the slice matrix $\\mathbf{P}_j$ based on the sign of $2(E-V_j)$ and update the total matrix by left-multiplication: $\\mathbf{P}_{total} \\leftarrow \\mathbf{P}_j \\, \\mathbf{P}_{total}$.\n6.  After iterating through all slices, extract the four elements of the final $\\mathbf{P}_{total}$.\n7.  Use the derived formula for $T$ to calculate the transmission coefficient.\nThis procedure will be implemented for all four test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the four test cases for quantum tunneling.\n    \"\"\"\n\n    def calculate_transmission(params):\n        \"\"\"\n        Calculates the transmission coefficient for a single set of parameters.\n        The method uses the transfer matrix approach for the state vector (psi, psi').\n        \"\"\"\n        x_L, x_R, N, E, V_func = params\n        dx = (x_R - x_L) / N\n\n        if E = 0:\n            return 0.0\n        \n        k0 = np.sqrt(2 * E)\n\n        # Initialize the total propagation matrix\n        P_total = np.identity(2, dtype=np.float64)\n\n        # Define grid midpoints for potential evaluation\n        x_mids = x_L + dx / 2.0 + np.arange(N) * dx\n        \n        # Create an array of potential values for each slice\n        V_slices = V_func(x_mids)\n\n        # The total propagation matrix is P_N * P_{N-1} * ... * P_1\n        # Loop computes P_1, then P_2*P_1, then P_3*P_2*P_1, etc.\n        for i in range(N):\n            V = V_slices[i]\n            k_squared = 2 * (E - V)\n            \n            # This is the matrix for the i-th slice (P_{i+1} in formula)\n            P_slice = np.empty((2, 2), dtype=np.float64)\n\n            # E > V: Propagating region\n            if k_squared > 0:\n                k = np.sqrt(k_squared)\n                # Handle k -> 0 case for numerical stability\n                if np.abs(k * dx)  1e-9:\n                    P_slice[0, 0] = 1.0\n                    P_slice[0, 1] = dx\n                    P_slice[1, 0] = 0.0\n                    P_slice[1, 1] = 1.0\n                else:\n                    c = np.cos(k * dx)\n                    s = np.sin(k * dx)\n                    P_slice[0, 0] = c\n                    P_slice[0, 1] = s / k\n                    P_slice[1, 0] = -k * s\n                    P_slice[1, 1] = c\n            # E  V: Evanescent region\n            else:\n                kappa = np.sqrt(-k_squared)\n                # Handle kappa -> 0 case (same as k -> 0)\n                if np.abs(kappa * dx)  1e-9:\n                    P_slice[0, 0] = 1.0\n                    P_slice[0, 1] = dx\n                    P_slice[1, 0] = 0.0\n                    P_slice[1, 1] = 1.0\n                else:\n                    ch = np.cosh(kappa * dx)\n                    sh = np.sinh(kappa * dx)\n                    P_slice[0, 0] = ch\n                    P_slice[0, 1] = sh / kappa\n                    P_slice[1, 0] = kappa * sh\n                    P_slice[1, 1] = ch\n            \n            # Left-multiply to build P_i * P_{i-1} * ...\n            P_total = P_slice @ P_total\n\n        # Extract elements of the total propagation matrix\n        P11, P12, P21, P22 = P_total.flatten()\n        \n        # Calculate transmission coefficient T using the derived formula\n        denominator = (P21 - k0**2 * P12)**2 + (k0 * (P11 + P22))**2\n        \n        if denominator == 0:\n            # Should not happen for k0 > 0, but as a safeguard\n            return 1.0  # Physical limit for resonance\n\n        T = 4 * k0**2 / denominator\n        return T\n\n    # Common parameters for all test cases\n    x_L = -10.0\n    x_R = 10.0\n    N = 4000\n\n    # Test Case A: Single rectangular barrier, sub-barrier energy\n    V0_A = 0.5\n    a_A = 2.0\n    E_A = 0.2\n    V_func_A = lambda x: np.where(np.abs(x) = a_A / 2.0, V0_A, 0.0)\n    case_A = (x_L, x_R, N, E_A, V_func_A)\n\n    # Test Case B: Single rectangular barrier, high energy\n    V0_B = 0.5\n    a_B = 2.0\n    E_B = 2.0\n    V_func_B = lambda x: np.where(np.abs(x) = a_B / 2.0, V0_B, 0.0)\n    case_B = (x_L, x_R, N, E_B, V_func_B)\n\n    # Test Case C: No barrier, free propagation\n    E_C = 0.3\n    V_func_C = lambda x: np.zeros_like(x)\n    case_C = (x_L, x_R, N, E_C, V_func_C)\n\n    # Test Case D: Double barrier with a resonant well\n    V0_D = 0.6\n    b_D = 0.5\n    Lw_D = 4.0\n    E_D = 0.31\n    def V_func_D(x):\n        abs_x = np.abs(x)\n        return np.where((abs_x >= Lw_D / 2.0)  (abs_x = Lw_D / 2.0 + b_D), V0_D, 0.0)\n    case_D = (x_L, x_R, N, E_D, V_func_D)\n\n    test_cases = [case_A, case_B, case_C, case_D]\n\n    results = []\n    for case in test_cases:\n        result = calculate_transmission(case)\n        results.append(result)\n\n    # Format the final output string as required\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2461151"}]}