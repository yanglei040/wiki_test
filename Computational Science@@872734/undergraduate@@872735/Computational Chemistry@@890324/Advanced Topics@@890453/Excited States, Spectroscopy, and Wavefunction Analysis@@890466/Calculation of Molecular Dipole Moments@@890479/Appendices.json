{"hands_on_practices": [{"introduction": "We begin with the most intuitive model for charge distribution: the point-charge approximation. This exercise demonstrates the fundamental relationship between molecular geometry and the dipole moment, showing how even small changes in structure can alter this key electronic property. By implementing this model for the ammonia molecule, you will gain hands-on experience in translating molecular coordinates and charges into a quantitative prediction of the dipole moment ([@problem_id:2451471]).", "problem": "You will implement a program that computes the molecular dipole moment magnitude of ammonia using a point-charge model, once for an experimental geometry and once for a theoretical geometry, and then evaluates boundary and scaling behavior. Work from the first-principles definition of the dipole moment as a charge-weighted position vector sum. Use a neutral, atom-centered point-charge model with nitrogen assigned charge $q_{\\mathrm{N}} = -0.84\\,e$ and each hydrogen assigned charge $q_{\\mathrm{H}} = +0.28\\,e$, where $e$ is the elementary charge. Place the nitrogen atom at the origin. For a trigonal pyramidal $NH_3$ molecule with three equivalent $N$–$H$ bonds of length $r$ separated by a hydrogen–nitrogen–hydrogen angle $\\psi$, the three hydrogen atoms are arranged symmetrically around the principal symmetry axis. Let $\\theta$ denote the angle each $N$–$H$ bond makes with the symmetry axis through nitrogen; $\\psi$ and $\\theta$ are related by the exact identity\n$$\n\\cos \\psi \\;=\\; \\frac{3\\cos^2 \\theta - 1}{2}.\n$$\nUse this relation to compute $\\theta$ for each case. Then construct the hydrogen coordinates at fixed $r$ by placing them at polar angle $\\theta' = \\pi - \\arccos(\\cos\\theta)$ relative to the positive symmetry axis and at azimuthal angles $0^\\circ$, $120^\\circ$, and $240^\\circ$ so that the three hydrogens lie on the same cone around the symmetry axis. The total dipole moment vector is\n$$\n\\boldsymbol{\\mu} \\;=\\; \\sum_i q_i \\,\\mathbf{r}_i,\n$$\nand its magnitude should be reported in Debye. Express the final answers in Debye and round each to six decimal places. Use the following physical constants explicitly: elementary charge $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, $1\\,\\text{\\AA} = 1.0\\times 10^{-10}\\,\\mathrm{m}$, and $1\\,\\text{Debye} = 3.33564\\times 10^{-30}\\,\\mathrm{C\\,m}$. Angles are provided in degrees.\n\nTest suite (all cases use the same charges given above):\n- Case A (experimental geometry): $r = 1.012\\,\\text{\\AA}$, $\\psi = 106.7^\\circ$.\n- Case B (theory-optimized geometry): $r = 1.020\\,\\text{\\AA}$, $\\psi = 107.5^\\circ$.\n- Case C (planar boundary geometry): $r = 1.012\\,\\text{\\AA}$, $\\psi = 120.0^\\circ$.\n- Case D (compressed bonds): $r = 0.500\\,\\text{\\AA}$, $\\psi = 106.7^\\circ$.\n- Case E (derived metric): the absolute difference in dipole magnitude (in Debye) between Case B and Case A.\n\nYour program must produce a single line of output containing the five results as a comma-separated list enclosed in square brackets in the order $[\\text{Case A}, \\text{Case B}, \\text{Case C}, \\text{Case D}, \\text{Case E}]$, for example, \"[1.234567,1.234567,0.000000,0.123456,0.001111]\". All five values must be floats in Debye rounded to six decimal places. Do not print any additional text.", "solution": "The problem requires the calculation of the molecular dipole moment magnitude for ammonia ($NH_3$) under various geometric configurations using a point-charge model. We must first validate the problem statement and then develop a solution from first principles.\n\nThe problem is scientifically grounded, well-posed, and objective. It is based on the fundamental definition of the electric dipole moment and utilizes a standard, albeit simplified, point-charge model. All necessary parameters, including charges, geometric arrangements, and physical constants, are provided, and there are no internal contradictions. The relationship provided between the $H-N-H$ angle $\\psi$ and the angle $\\theta$ of the $N-H$ bond with the symmetry axis is a correct geometric identity for a trigonal pyramidal structure. The instructions for coordinate construction contain a potentially ambiguous step involving an angle $\\theta'$, but as will be shown, this ambiguity does not affect the calculation of the dipole moment magnitude, which is the required output. Therefore, the problem is deemed valid.\n\nThe electric dipole moment vector $\\boldsymbol{\\mu}$ for a collection of point charges $q_i$ at positions $\\mathbf{r}_i$ is defined as:\n$$\n\\boldsymbol{\\mu} = \\sum_i q_i \\mathbf{r}_i\n$$\nThe problem specifies a neutral point-charge model for $NH_3$ with the nitrogen atom ($N$) at the origin, $\\mathbf{r}_N = \\mathbf{0}$. The charge on the nitrogen atom is $q_N = -0.84\\,e$, and the charge on each of the three hydrogen atoms ($H$) is $q_H = +0.28\\,e$, where $e$ is the elementary charge. The total charge is $q_{total} = q_N + 3 q_H = -0.84\\,e + 3(0.28\\,e) = 0$, confirming the system is neutral. For a neutral system, the calculated dipole moment is independent of the choice of origin. Placing the nitrogen atom at the origin is a convenient choice that simplifies the calculation.\n\nWith $\\mathbf{r}_N = \\mathbf{0}$, the contribution of the nitrogen charge to the sum is zero, so the expression for the dipole moment becomes:\n$$\n\\boldsymbol{\\mu} = q_H (\\mathbf{r}_{H1} + \\mathbf{r}_{H2} + \\mathbf{r}_{H3})\n$$\nwhere $\\mathbf{r}_{Hi}$ are the position vectors of the three hydrogen atoms.\n\nWe establish a coordinate system where the principal symmetry axis of the molecule aligns with the $z$-axis. The three hydrogen atoms are arranged symmetrically around this axis. We can describe their positions using spherical coordinates $(r, \\theta_p, \\phi)$, where $r$ is the $N-H$ bond length, $\\theta_p$ is the polar angle with respect to the positive $z$-axis, and $\\phi$ is the azimuthal angle. The three hydrogen atoms are placed at azimuthal angles $\\phi_1 = 0$, $\\phi_2 = 2\\pi/3$ radians ($120^\\circ$), and $\\phi_3 = 4\\pi/3$ radians ($240^\\circ$). The Cartesian coordinates of the hydrogen atoms are:\n$$\n\\mathbf{r}_{Hi} = (r \\sin\\theta_p \\cos\\phi_i, r \\sin\\theta_p \\sin\\phi_i, r \\cos\\theta_p)\n$$\nThe sum of the position vectors $\\sum_{i=1}^3 \\mathbf{r}_{Hi}$ is required. Let's evaluate the sum component-wise:\nThe $x$-component sum is proportional to $\\sum \\cos\\phi_i = \\cos(0) + \\cos(2\\pi/3) + \\cos(4\\pi/3) = 1 - 1/2 - 1/2 = 0$.\nThe $y$-component sum is proportional to $\\sum \\sin\\phi_i = \\sin(0) + \\sin(2\\pi/3) + \\sin(4\\pi/3) = 0 + \\sqrt{3}/2 - \\sqrt{3}/2 = 0$.\nThe $z$-component sum is $\\sum z_i = r\\cos\\theta_p + r\\cos\\theta_p + r\\cos\\theta_p = 3r\\cos\\theta_p$.\n\nDue to symmetry, the $x$ and $y$ components of the total dipole moment are zero. The resulting dipole moment vector is aligned with the $z$-axis:\n$$\n\\boldsymbol{\\mu} = (0, 0, 3 q_H r \\cos\\theta_p)\n$$\nThe magnitude of the dipole moment, $\\mu$, is the absolute value of the non-zero component:\n$$\n\\mu = |\\boldsymbol{\\mu}| = |3 q_H r \\cos\\theta_p|\n$$\nSince $q_H = +0.28\\,e$ is positive and $r$ is a length, we have $\\mu = 3 q_H r |\\cos\\theta_p|$.\n\nNext, we must relate $|\\cos\\theta_p|$ to the given $H-N-H$ angle $\\psi$. We use the dot product between the position vectors of two hydrogen atoms, for instance $\\mathbf{r}_{H1}$ and $\\mathbf{r}_{H2}$:\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = |\\mathbf{r}_{H1}| |\\mathbf{r}_{H2}| \\cos\\psi = r^2 \\cos\\psi\n$$\nCalculating the dot product explicitly from the Cartesian coordinates:\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = (r\\sin\\theta_p \\cos\\phi_1)(r\\sin\\theta_p \\cos\\phi_2) + (r\\sin\\theta_p \\sin\\phi_1)(r\\sin\\theta_p \\sin\\phi_2) + (r\\cos\\theta_p)(r\\cos\\theta_p)\n$$\n$$\n= r^2\\sin^2\\theta_p(\\cos\\phi_1\\cos\\phi_2 + \\sin\\phi_1\\sin\\phi_2) + r^2\\cos^2\\theta_p = r^2\\sin^2\\theta_p\\cos(\\phi_1 - \\phi_2) + r^2\\cos^2\\theta_p\n$$\nSubstituting $\\phi_1=0$ and $\\phi_2=2\\pi/3$, we get $\\cos(\\phi_1-\\phi_2) = \\cos(-2\\pi/3) = -1/2$.\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = r^2\\sin^2\\theta_p(-1/2) + r^2\\cos^2\\theta_p = r^2\\left(-\\frac{1}{2}(1-\\cos^2\\theta_p) + \\cos^2\\theta_p\\right) = r^2\\left(\\frac{3}{2}\\cos^2\\theta_p - \\frac{1}{2}\\right)\n$$\nEquating the two expressions for the dot product gives the identity provided in the problem statement, where $\\theta$ corresponds to our $\\theta_p$:\n$$\nr^2 \\cos\\psi = r^2\\frac{3\\cos^2\\theta_p - 1}{2} \\implies \\cos\\psi = \\frac{3\\cos^2\\theta_p - 1}{2}\n$$\nSolving for $|\\cos\\theta_p|$:\n$$\n\\cos^2\\theta_p = \\frac{2\\cos\\psi + 1}{3} \\implies |\\cos\\theta_p| = \\sqrt{\\frac{2\\cos\\psi + 1}{3}}\n$$\nThis expression uniquely determines the magnitude $|\\cos\\theta_p|$ from the angle $\\psi$. Substituting this back into the formula for the dipole moment magnitude:\n$$\n\\mu = 3 q_H r \\sqrt{\\frac{2\\cos\\psi + 1}{3}}\n$$\nThis is the final formula for the calculation. The computational steps are:\n$1$. Convert the input bond length $r$ from Ångströms to meters ($1\\,\\text{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$).\n$2$. Convert the input angle $\\psi$ from degrees to radians for use in the cosine function.\n$3$. Calculate the charge $q_H$ in Coulombs: $q_H = 0.28 \\times e$, using $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$.\n$4$. Substitute these values into the derived formula to obtain $\\mu$ in SI units ($C \\cdot m$).\n$5$. Convert the result from $C \\cdot m$ to Debye ($D$) using the conversion factor $1\\,D = 3.33564 \\times 10^{-30}\\,C \\cdot m$.\n$6$. For each test case, apply the formula. For Case C, where $\\psi=120^\\circ$, $\\cos\\psi = -0.5$, the term under the square root becomes zero, correctly yielding $\\mu = 0$ for a planar geometry. Case E is the absolute difference between the magnitudes from Case B and Case A.\n$7$. Round all final values to six decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the molecular dipole moment of ammonia for several geometries\n    based on a point-charge model.\n    \"\"\"\n\n    # --- Givens and Constants ---\n    \n    # Physical constants\n    e_charge = 1.602176634e-19  # Elementary charge in Coulombs (C)\n    A_to_m = 1.0e-10             # Angstrom to meter conversion factor\n    D_to_Cm = 3.33564e-30        # Debye to Coulomb-meter conversion factor\n\n    # Model parameters\n    q_H_e = 0.28  # Charge on Hydrogen in units of elementary charge e\n\n    # Charge on Hydrogen in Coulombs\n    q_H_C = q_H_e * e_charge\n\n    # Test suite from the problem statement\n    # Each case is a tuple: (bond_length_in_A, hnh_angle_in_deg)\n    test_cases_params = [\n        (1.012, 106.7),  # Case A: experimental geometry\n        (1.020, 107.5),  # Case B: theory-optimized geometry\n        (1.012, 120.0),  # Case C: planar boundary geometry\n        (0.500, 106.7),  # Case D: compressed bonds\n    ]\n    \n    def calculate_dipole_magnitude(r_A, psi_deg):\n        \"\"\"\n        Calculates the dipole moment magnitude in Debye.\n\n        Args:\n            r_A (float): N-H bond length in Angstroms.\n            psi_deg (float): H-N-H bond angle in degrees.\n\n        Returns:\n            float: The magnitude of the molecular dipole moment in Debye.\n        \"\"\"\n        # 1. Convert inputs to SI units\n        r_m = r_A * A_to_m\n        psi_rad = np.deg2rad(psi_deg)\n\n        # 2. Calculate the geometric factor |cos(theta)|\n        cos_psi = np.cos(psi_rad)\n        \n        # Handle potential floating point inaccuracies for the planar case\n        # where the argument to sqrt should be exactly zero.\n        cos2_theta_arg = (2 * cos_psi + 1) / 3\n        if cos2_theta_arg < 0:\n             # This can happen if psi > 120 due to float precision.\n             # Physically, the angle cannot exceed 120 for this geometry.\n             # For psi=120, this term is 0.\n            abs_cos_theta = 0.0\n        else:\n            abs_cos_theta = np.sqrt(cos2_theta_arg)\n\n        # 3. Calculate dipole moment magnitude in SI units (C*m)\n        # Formula: mu = 3 * q_H * r * |cos(theta)|\n        mu_si = 3 * q_H_C * r_m * abs_cos_theta\n        \n        # 4. Convert to Debye\n        mu_D = mu_si / D_to_Cm\n        \n        return mu_D\n\n    # --- Calculation for all cases ---\n    \n    # Calculate results for cases A, B, C, D\n    results_abcd = []\n    for r_A, psi_deg in test_cases_params:\n        result = calculate_dipole_magnitude(r_A, psi_deg)\n        results_abcd.append(result)\n        \n    mu_A = results_abcd[0]\n    mu_B = results_abcd[1]\n    \n    # Calculate Case E: absolute difference between B and A\n    mu_E = abs(mu_B - mu_A)\n\n    # Combine all results\n    final_results = results_abcd + [mu_E]\n    \n    # Round all results to six decimal places\n    rounded_results = [round(res, 6) for res in final_results]\n    \n    # Format for printing\n    output_str = f\"[{','.join(f'{res:.6f}' for res in rounded_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2451471"}, {"introduction": "Moving beyond fixed charges, we now explore how quantum mechanics provides a more fundamental way to determine molecular charge distribution. In this advanced exercise, you will implement a simplified Linear Combination of Atomic Orbitals (LCAO) calculation from scratch to compute the dipole moment of water. This practice will demystify the \"black box\" of quantum chemistry software and illustrate the crucial concept of basis set convergence, a cornerstone of reliable computational chemistry ([@problem_id:2451307]).", "problem": "You are to write a complete, runnable program that computes the permanent dipole moment magnitude of a water molecule for five different Gaussian width parameter sets that emulate increasing basis-set flexibility, using a linear combination of atomic orbitals (LCAO) tight-binding model and numerical integration. The goal is to study the numerical convergence trend toward a known gas-phase experimental dipole moment, without calling any external quantum chemistry software. The program must output a single line containing two lists: the first list with the computed dipole magnitudes for each parameter set and the second list with the absolute errors relative to the experimental value, all in Debye, rounded to three decimals.\n\nUse the following scientifically standard definitions and modeling assumptions as the foundational base:\n\n- Under the Born–Oppenheimer (BO) approximation, the electronic dipole moment of a neutral molecule is defined by\n$$\n\\boldsymbol{\\mu} = \\sum_{A} Z_{A} \\mathbf{R}_{A} - \\int \\rho_{e}(\\mathbf{r})\\,\\mathbf{r}\\,d^3\\mathbf{r},\n$$\nwhere $Z_{A}$ and $\\mathbf{R}_{A}$ are the charge and position of nucleus $A$, and $\\rho_{e}(\\mathbf{r})$ is the electronic density. For a closed-shell system,\n$$\n\\rho_{e}(\\mathbf{r}) = 2 \\sum_{a \\in \\text{occ}} \\left| \\psi_{a}(\\mathbf{r}) \\right|^{2}.\n$$\n- Within the Linear Combination of Atomic Orbitals (LCAO) approximation, each molecular orbital is expanded as\n$$\n\\psi_{a}(\\mathbf{r}) = \\sum_{i=1}^{N} C_{ia}\\,\\phi_{i}(\\mathbf{r}),\n$$\nwhere $\\phi_{i}(\\mathbf{r})$ are atom-centered normalized Cartesian Gaussian primitives. Use one $2s$ and three $2p$ ($p_x,p_y,p_z$) functions on oxygen and one $1s$ function on each hydrogen, for a total of $N=6$ basis functions. Each primitive on center $\\mathbf{R}_{A}$ has the form\n- $s$-type: $\\phi_{s}(\\mathbf{r}) = N_{s}\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$,\n- $p_x$-type: $\\phi_{p_x}(\\mathbf{r}) = N_{p}\\,(x-X_{A})\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$,\nwith analogous definitions for $p_y$ and $p_z$. The normalization constants are\n$$\nN_{s} = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}, \\quad\nN_{p} = \\left(\\frac{128\\,\\alpha^{5}}{\\pi^{3}}\\right)^{1/4}.\n$$\n- Determine the occupied molecular orbitals by solving the generalized eigenvalue problem\n$$\n\\mathbf{H}\\,\\mathbf{C} = \\mathbf{S}\\,\\mathbf{C}\\,\\boldsymbol{\\varepsilon},\n$$\nwhere $\\mathbf{S}_{ij}=\\int \\phi_{i}(\\mathbf{r})\\phi_{j}(\\mathbf{r})\\,d^{3}\\mathbf{r}$ is the overlap matrix and $\\mathbf{H}$ is the one-electron Hamiltonian approximated by the Wolfsberg–Helmholtz (WH) prescription:\n$$\nH_{ii} = \\varepsilon_{i}, \\quad\nH_{ij} = K\\,S_{ij}\\,\\frac{\\varepsilon_{i}+\\varepsilon_{j}}{2} \\quad (i\\neq j),\n$$\nwith $K$ a dimensionless constant. Use $K=1.75$ and diagonal orbital energies $\\varepsilon_{\\text{O}\\,2s}=-32.3\\,\\text{eV}$, $\\varepsilon_{\\text{O}\\,2p}=-14.8\\,\\text{eV}$, and $\\varepsilon_{\\text{H}\\,1s}=-13.6\\,\\text{eV}$. Fill the lowest-energy molecular orbitals with $8$ electrons (four doubly occupied orbitals), corresponding to an oxygen valence of $6$ and two hydrogens of $1$ each. Use an effective core charge on oxygen of $Z_{\\text{O,eff}}=6$ (oxygen nuclear charge $8$ minus an implicit $1s$ core of $2$ electrons), and $Z_{\\text{H}}=1$ for each hydrogen, so that total nuclear effective charge equals total electron count, ensuring overall neutrality within the valence model.\n- Compute all required integrals by numerical quadrature on a regular three-dimensional grid that encloses the molecule. For any grid point $\\mathbf{r}_{g}$ with volume element $\\Delta V$, approximate\n$$\nS_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V,\n\\quad\nD^{(k)}_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,r^{(k)}_{g}\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V,\n$$\nwhere $k\\in\\{x,y,z\\}$ and $D^{(k)}$ are the dipole integrals of the position operator. The electronic dipole component is\n$$\n\\mu^{(k)}_{\\text{el}} = - \\sum_{i,j} P_{ij}\\,D^{(k)}_{ij},\n$$\nwith density matrix $\\mathbf{P} = 2\\,\\mathbf{C}_{\\text{occ}}\\mathbf{C}_{\\text{occ}}^{\\top}$. The nuclear dipole is $\\boldsymbol{\\mu}_{\\text{nuc}} = \\sum_{A} Z_{A}\\,\\mathbf{R}_{A}$. The total dipole is $\\boldsymbol{\\mu}=\\boldsymbol{\\mu}_{\\text{nuc}}+\\boldsymbol{\\mu}_{\\text{el}}$. Compute the magnitude $\\|\\boldsymbol{\\mu}\\|$ and express it in Debye using $1\\,e\\cdot\\text{\\AA} = 4.803204712\\,\\text{Debye}$.\n\nGeometry and units:\n- Use a water geometry with O at the origin and the molecule in the $x$-$z$ plane. The O–H bond length is $r_{\\text{OH}}=0.9572\\,\\text{\\AA}$, and the H–O–H angle is $\\theta=104.52$ degrees. Place the hydrogens at\n$$\n\\mathbf{R}_{\\text{H1}} = (r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2)), \\quad\n\\mathbf{R}_{\\text{H2}} = (-r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2)).\n$$\n- All spatial coordinates for integration must be in $\\text{\\AA}$, and the final dipole magnitude must be reported in Debye, rounded to three decimals. Angles are in degrees.\n\nNumerical grid:\n- Use a uniform cubic grid spanning from $-4.0\\,\\text{\\AA}$ to $+4.0\\,\\text{\\AA}$ in each Cartesian direction with spacing chosen to evenly divide this interval into a reasonably fine grid sufficient for numerical stability and positivity of the overlap matrix. The program should use the same grid for all calculations.\n\nTest suite (five parameter sets):\n- For each of the five cases below, set the Gaussian exponents (in $\\text{\\AA}^{-2}$) as\n1. Set A (tight, minimal-like): $\\alpha_{\\text{O},2s}=2.00$, $\\alpha_{\\text{O},2p}=1.60$, $\\alpha_{\\text{H},1s}=1.30$.\n2. Set B: $\\alpha_{\\text{O},2s}=1.60$, $\\alpha_{\\text{O},2p}=1.20$, $\\alpha_{\\text{H},1s}=1.00$.\n3. Set C: $\\alpha_{\\text{O},2s}=1.20$, $\\alpha_{\\text{O},2p}=0.90$, $\\alpha_{\\text{H},1s}=0.80$.\n4. Set D: $\\alpha_{\\text{O},2s}=0.90$, $\\alpha_{\\text{O},2p}=0.70$, $\\alpha_{\\text{H},1s}=0.60$.\n5. Set E (diffuse, augmented-like): $\\alpha_{\\text{O},2s}=0.70$, $\\alpha_{\\text{O},2p}=0.55$, $\\alpha_{\\text{H},1s}=0.45$.\n\nReference value:\n- Use the experimental gas-phase dipole magnitude $\\mu_{\\text{exp}}=1.855$ Debye.\n\nYour program must:\n- Implement the above LCAO tight-binding model and numerical integration to compute $\\|\\boldsymbol{\\mu}\\|$ in Debye for each of the five parameter sets.\n- For each case, compute the absolute error $|\\|\\boldsymbol{\\mu}\\| - \\mu_{\\text{exp}}|$ in Debye.\n- Produce a single line of output containing the two lists: the first list is the five dipole magnitudes in Debye, the second list is the five absolute errors in Debye. Both lists must be enclosed within a single outer list and appear as\n$$\n[\\,[\\mu_{A},\\mu_{B},\\mu_{C},\\mu_{D},\\mu_{E}],\\,[e_{A},e_{B},e_{C},e_{D},e_{E}]\\,],\n$$\nwhere each number is rounded to three decimals.\n\nConstraints:\n- The code must be fully self-contained, require no user input, and must adhere to the specified execution environment.\n- The computation must be performed as described; hard-coding target dipole results or using black-box quantum chemistry packages is not allowed.", "solution": "The problem as stated is subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n\n*   **Dipole Moment Definition (Born-Oppenheimer):** $\\boldsymbol{\\mu} = \\sum_{A} Z_{A} \\mathbf{R}_{A} - \\int \\rho_{e}(\\mathbf{r})\\,\\mathbf{r}\\,d^3\\mathbf{r}$\n*   **Electron Density:** $\\rho_{e}(\\mathbf{r}) = 2 \\sum_{a \\in \\text{occ}} \\left| \\psi_{a}(\\mathbf{r}) \\right|^{2}$\n*   **LCAO Expansion:** $\\psi_{a}(\\mathbf{r}) = \\sum_{i=1}^{N} C_{ia}\\,\\phi_{i}(\\mathbf{r})$\n*   **Basis Set ($N=6$):** O: one $2s$, three $2p$ ($p_x, p_y, p_z$); each H: one $1s$.\n*   **Gaussian Primitive Forms:** $\\phi_{s}(\\mathbf{r}) = N_{s}\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$, $\\phi_{p_x}(\\mathbf{r}) = N_{p}\\,(x-X_{A})\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$.\n*   **Normalization Constants:** $N_{s} = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}$, $N_{p} = \\left(\\frac{128\\,\\alpha^{5}}{\\pi^{3}}\\right)^{1/4}$.\n*   **Secular Equation:** $\\mathbf{H}\\,\\mathbf{C} = \\mathbf{S}\\,\\mathbf{C}\\,\\boldsymbol{\\varepsilon}$, where $\\mathbf{S}_{ij}=\\int \\phi_{i}(\\mathbf{r})\\phi_{j}(\\mathbf{r})\\,d^{3}\\mathbf{r}$.\n*   **Wolfsberg-Helmholtz Hamiltonian:** $H_{ii} = \\varepsilon_{i}$, $H_{ij} = K\\,S_{ij}\\,\\frac{\\varepsilon_{i}+\\varepsilon_{j}}{2}$ for $i\\neq j$.\n*   **Parameters:** $K=1.75$, $\\varepsilon_{\\text{O}\\,2s}=-32.3\\,\\text{eV}$, $\\varepsilon_{\\text{O}\\,2p}=-14.8\\,\\text{eV}$, $\\varepsilon_{\\text{H}\\,1s}=-13.6\\,\\text{eV}$.\n*   **Electron Configuration:** $8$ valence electrons, filling the $4$ lowest-energy MOs.\n*   **Effective Nuclear Charges:** $Z_{\\text{O,eff}}=6$, $Z_{\\text{H}}=1$.\n*   **Numerical Integrals:** $S_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V$, $D^{(k)}_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,r^{(k)}_{g}\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V$.\n*   **Electronic Dipole:** $\\mu^{(k)}_{\\text{el}} = - \\sum_{i,j} P_{ij}\\,D^{(k)}_{ij}$ with $\\mathbf{P} = 2\\,\\mathbf{C}_{\\text{occ}}\\mathbf{C}_{\\text{occ}}^{\\top}$.\n*   **Nuclear Dipole:** $\\boldsymbol{\\mu}_{\\text{nuc}} = \\sum_{A} Z_{A}\\,\\mathbf{R}_{A}$.\n*   **Conversion Factor:** $1\\,e\\cdot\\text{\\AA} = 4.803204712\\,\\text{Debye}$.\n*   **Geometry:** O at $(0,0,0)$; $r_{\\text{OH}}=0.9572\\,\\text{\\AA}$; H-O-H angle $\\theta=104.52^\\circ$. Molecule in $xz$-plane. Positions $\\mathbf{R}_{\\text{H1}} = (r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2))$, $\\mathbf{R}_{\\text{H2}} = (-r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2))$.\n*   **Numerical Grid:** Uniform cube, $[-4.0, +4.0]\\,\\text{\\AA}$ in each dimension.\n*   **Test Sets ($\\alpha$ in $\\text{\\AA}^{-2}$):**\n    1.  A: $\\alpha_{\\text{O},2s}=2.00$, $\\alpha_{\\text{O},2p}=1.60$, $\\alpha_{\\text{H},1s}=1.30$.\n    2.  B: $\\alpha_{\\text{O},2s}=1.60$, $\\alpha_{\\text{O},2p}=1.20$, $\\alpha_{\\text{H},1s}=1.00$.\n    3.  C: $\\alpha_{\\text{O},2s}=1.20$, $\\alpha_{\\text{O},2p}=0.90$, $\\alpha_{\\text{H},1s}=0.80$.\n    4.  D: $\\alpha_{\\text{O},2s}=0.90$, $\\alpha_{\\text{O},2p}=0.70$, $\\alpha_{\\text{H},1s}=0.60$.\n    5.  E: $\\alpha_{\\text{O},2s}=0.70$, $\\alpha_{\\text{O},2p}=0.55$, $\\alpha_{\\text{H},1s}=0.45$.\n*   **Reference Value:** $\\mu_{\\text{exp}}=1.855$ Debye.\n*   **Output Format:** `[[mu_A,...,mu_E],[e_A,...,e_E]]` rounded to three decimals.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is scientifically grounded, employing a standard if simplified LCAO model from computational chemistry. It is well-posed, providing all necessary physical parameters, mathematical formulae, and geometrical data to arrive at a definite numerical result for each specified test case. The requirement for a \"reasonably fine grid\" is a standard directive in numerical analysis, not a flaw, and simply delegates the choice of a sufficient grid resolution to the implementer. The problem is objective and free of contradictions. The number of valence electrons ($8$) correctly matches the sum of effective nuclear charges ($6+1+1=8$), ensuring the model system is neutral.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be constructed.\n\n**Solution Procedure**\n\nThe calculation of the molecular dipole moment proceeds from first principles, adapted to the specified approximations. The foundation is the Born-Oppenheimer approximation, which separates nuclear and electronic motion. The total dipole moment $\\boldsymbol{\\mu}$ is the sum of a nuclear contribution $\\boldsymbol{\\mu}_{\\text{nuc}}$ and an electronic contribution $\\boldsymbol{\\mu}_{\\text{el}}$.\n\n**1. Molecular Geometry and Basis Set**\nThe water molecule is placed in the Cartesian coordinate system as specified. The oxygen atom is at the origin $\\mathbf{R}_{\\text{O}} = (0,0,0)\\,\\text{\\AA}$. With $r_{\\text{OH}}=0.9572\\,\\text{\\AA}$ and $\\theta=104.52^\\circ$, the hydrogen coordinates are calculated as:\n$\\theta/2 = 52.26^\\circ$.\n$$ \\mathbf{R}_{\\text{H1}} = (0.9572 \\sin(52.26^\\circ), 0, 0.9572 \\cos(52.26^\\circ)) \\approx (0.7569, 0, 0.5859)\\,\\text{\\AA} $$\n$$ \\mathbf{R}_{\\text{H2}} = (-0.9572 \\sin(52.26^\\circ), 0, 0.9572 \\cos(52.26^\\circ)) \\approx (-0.7569, 0, 0.5859)\\,\\text{\\AA} $$\nThe minimal valence basis set consists of $N=6$ atomic orbitals (AOs):\n\\begin{itemize}\n    \\item $\\phi_0$: O $2s$, centered at $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_1$: O $2p_x$, centered at $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_2$: O $2p_y$, centered at $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_3$: O $2p_z$, centered at $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_4$: H1 $1s$, centered at $\\mathbf{R}_{\\text{H1}}$\n    \\item $\\phi_5$: H2 $1s$, centered at $\\mathbf{R}_{\\text{H2}}$\n\\end{itemize}\nEach atomic orbital is a normalized Cartesian Gaussian function, whose specific exponent $\\alpha$ is given by the parameter sets A through E.\n\n**2. Numerical Integration Grid**\nAll integrals are computed numerically. A uniform cubic grid is constructed over the domain $[-4.0, +4.0]\\,\\text{\\AA}$ in each dimension. A resolution of $101$ points per axis is chosen to ensure numerical stability and reasonable accuracy. This yields a grid spacing of $\\Delta x = 8.0 / (101-1) = 0.08\\,\\text{\\AA}$ and a volume element $\\Delta V = (\\Delta x)^3 = 0.000512\\,\\text{\\AA}^3$.\n\n**3. Matrix Construction**\nThe molecular orbitals $\\psi_a$ are determined by solving the generalized eigenvalue problem $\\mathbf{H}\\,\\mathbf{C} = \\mathbf{S}\\,\\mathbf{C}\\,\\boldsymbol{\\varepsilon}$. The matrices $\\mathbf{S}$ and $\\mathbf{H}$ must first be constructed.\n\nThe overlap matrix elements $S_{ij}$ are computed by summing over all grid points $\\mathbf{r}_g$:\n$$ S_{ij} = \\int \\phi_i^*(\\mathbf{r}) \\phi_j(\\mathbf{r})\\,d^3\\mathbf{r} \\approx \\sum_{g} \\phi_i(\\mathbf{r}_g) \\phi_j(\\mathbf{r}_g) \\Delta V $$\n\nThe Hamiltonian matrix $\\mathbf{H}$ is constructed using the Wolfsberg-Helmholtz approximation. The diagonal elements are the atomic orbital ionization potentials:\n$$ H_{ii} = \\varepsilon_{i} $$\nwhere $\\varepsilon_i \\in \\{\\varepsilon_{\\text{O}\\,2s}, \\varepsilon_{\\text{O}\\,2p}, \\varepsilon_{\\text{H}\\,1s}\\}$ corresponding to the AO $\\phi_i$. The off-diagonal elements are proportional to the overlap:\n$$ H_{ij} = K\\,S_{ij}\\,\\frac{\\varepsilon_{i}+\\varepsilon_{j}}{2} \\quad (i\\neq j) $$\nwith $K=1.75$.\n\n**4. Solving the Secular Equations and Constructing the Density Matrix**\nThe generalized eigenvalue problem is solved using standard numerical linear algebra routines, yielding the MO energies $\\varepsilon_a$ and the MO coefficient matrix $\\mathbf{C}$ (where columns are eigenvectors). The water molecule has $6$ (from O) + $1$ (from H1) + $1$ (from H2) = $8$ valence electrons. These electrons doubly occupy the $4$ molecular orbitals with the lowest energies. The matrix $\\mathbf{C}_{\\text{occ}}$ is formed by taking the first $4$ columns of $\\mathbf{C}$. The one-electron density matrix $\\mathbf{P}$ is then computed as:\n$$ \\mathbf{P} = 2\\,\\mathbf{C}_{\\text{occ}}\\mathbf{C}_{\\text{occ}}^{\\top} $$\n\n**5. Dipole Moment Calculation**\nThe total dipole moment $\\boldsymbol{\\mu}$ is the sum of nuclear and electronic parts.\n\nThe nuclear contribution $\\boldsymbol{\\mu}_{\\text{nuc}}$ is a sum over the effective nuclear charges $Z_A$ at positions $\\mathbf{R}_A$:\n$$ \\boldsymbol{\\mu}_{\\text{nuc}} = \\sum_{A} Z_A \\mathbf{R}_A = Z_{\\text{O,eff}}\\mathbf{R}_{\\text{O}} + Z_{\\text{H}}\\mathbf{R}_{\\text{H1}} + Z_{\\text{H}}\\mathbf{R}_{\\text{H2}} $$\nGiven $Z_{\\text{O,eff}}=6$, $Z_{\\text{H}}=1$, and $\\mathbf{R}_{\\text{O}}=(0,0,0)$, and using the symmetry of the hydrogen positions, the only non-zero component is:\n$$ \\mu_{\\text{nuc},z} = 1 \\cdot (r_{\\text{OH}}\\cos(\\theta/2)) + 1 \\cdot (r_{\\text{OH}}\\cos(\\theta/2)) = 2 r_{\\text{OH}}\\cos(\\theta/2) $$\nThe units are elementary charge ($e$) times Ångström ($\\text{\\AA}$).\n\nThe electronic contribution $\\boldsymbol{\\mu}_{\\text{el}}$ is calculated from the density matrix $\\mathbf{P}$ and the dipole integral matrices $\\mathbf{D}^{(k)}$ for each Cartesian component $k \\in \\{x, y, z\\}$. The dipole integral matrices are computed on the grid:\n$$ D^{(k)}_{ij} = \\int \\phi_i(\\mathbf{r}) r^{(k)} \\phi_j(\\mathbf{r})\\,d^3\\mathbf{r} \\approx \\sum_{g} \\phi_i(\\mathbf{r}_g) r^{(k)}_g \\phi_j(\\mathbf{r}_g) \\Delta V $$\nThe electronic dipole components are then:\n$$ \\mu^{(k)}_{\\text{el}} = - \\sum_{i,j} P_{ij} D^{(k)}_{ij} = -\\text{Tr}(\\mathbf{P} \\mathbf{D}^{(k)}) $$\nDue to molecular symmetry ($C_{2v}$), the total dipole moment vector $\\boldsymbol{\\mu} = \\boldsymbol{\\mu}_{\\text{nuc}} + \\boldsymbol{\\mu}_{\\text{el}}$ is expected to lie along the $z$-axis, so $\\mu_x$ and $\\mu_y$ should be zero.\n\nFinally, the magnitude of the total dipole moment is calculated and converted to Debye:\n$$ \\|\\boldsymbol{\\mu}\\| = \\sqrt{\\mu_x^2 + \\mu_y^2 + \\mu_z^2} $$\n$$ \\|\\boldsymbol{\\mu}\\|_{\\text{Debye}} = \\|\\boldsymbol{\\mu}\\|_{e\\cdot\\text{\\AA}} \\times 4.803204712 $$\nThe absolute error relative to the experimental value $\\mu_{\\text{exp}}=1.855$ Debye is then computed for each parameter set. This entire procedure is repeated for each of the five sets of Gaussian exponents. Decreasing the exponents (from A to E) makes the basis functions more diffuse, typically improving the description of the charge distribution and properties like the dipole moment. Therefore, a trend of decreasing error is anticipated.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the dipole moment of a water molecule using a semi-empirical\n    LCAO model for five different basis set parameter sets.\n    \"\"\"\n\n    # --- 1. Constants and Parameters ---\n    K_WH = 1.75  # Wolfsberg-Helmholtz constant\n    E_O_2S = -32.3  # eV\n    E_O_2P = -14.8  # eV\n    E_H_1S = -13.6  # eV\n    Z_O_eff = 6.0  # Effective nuclear charge for Oxygen\n    Z_H = 1.0     # Nuclear charge for Hydrogen\n    N_ELECTRONS = 8\n    MU_EXP_DEBYE = 1.855  # Experimental dipole moment in Debye\n    E_A_TO_DEBYE = 4.803204712\n\n    # --- 2. Geometry Setup ---\n    r_OH = 0.9572  # Angstrom\n    theta_HOH_deg = 104.52\n    theta_rad = np.deg2rad(theta_HOH_deg)\n\n    R_O = np.array([0.0, 0.0, 0.0])\n    R_H1 = np.array([r_OH * np.sin(theta_rad / 2.0), 0.0, r_OH * np.cos(theta_rad / 2.0)])\n    R_H2 = np.array([-r_OH * np.sin(theta_rad / 2.0), 0.0, r_OH * np.cos(theta_rad / 2.0)])\n    \n    atom_coords = [R_O, R_H1, R_H2]\n    atom_charges = [Z_O_eff, Z_H, Z_H]\n\n    # --- 3. Basis Set Definition ---\n    # Order: 0:O(2s), 1:O(2px), 2:O(2py), 3:O(2pz), 4:H1(1s), 5:H2(1s)\n    basis_info = [\n        {'type': 's',  'atom_idx': 0, 'energy': E_O_2S},\n        {'type': 'px', 'atom_idx': 0, 'energy': E_O_2P},\n        {'type': 'py', 'atom_idx': 0, 'energy': E_O_2P},\n        {'type': 'pz', 'atom_idx': 0, 'energy': E_O_2P},\n        {'type': 's',  'atom_idx': 1, 'energy': E_H_1S},\n        {'type': 's',  'atom_idx': 2, 'energy': E_H_1S},\n    ]\n    N_BASIS = len(basis_info)\n    H_diag = np.array([b['energy'] for b in basis_info])\n\n    # --- 4. Test Cases ---\n    test_cases = [\n        {'name': 'A', 'alpha_O_2s': 2.00, 'alpha_O_2p': 1.60, 'alpha_H_1s': 1.30},\n        {'name': 'B', 'alpha_O_2s': 1.60, 'alpha_O_2p': 1.20, 'alpha_H_1s': 1.00},\n        {'name': 'C', 'alpha_O_2s': 1.20, 'alpha_O_2p': 0.90, 'alpha_H_1s': 0.80},\n        {'name': 'D', 'alpha_O_2s': 0.90, 'alpha_O_2p': 0.70, 'alpha_H_1s': 0.60},\n        {'name': 'E', 'alpha_O_2s': 0.70, 'alpha_O_2p': 0.55, 'alpha_H_1s': 0.45},\n    ]\n\n    # --- 5. Numerical Grid Setup ---\n    N_GRID_PTS = 101\n    GRID_MIN, GRID_MAX = -4.0, 4.0\n    grid_coords_1d = np.linspace(GRID_MIN, GRID_MAX, N_GRID_PTS)\n    dx = grid_coords_1d[1] - grid_coords_1d[0]\n    dV = dx**3\n\n    x, y, z = np.meshgrid(grid_coords_1d, grid_coords_1d, grid_coords_1d, indexing='ij')\n    grid = np.vstack([x.ravel(), y.ravel(), z.ravel()]).T\n\n    # --- 6. Main Calculation Loop ---\n    dipole_magnitudes = []\n    absolute_errors = []\n\n    for case in test_cases:\n        # Assign alpha values for the current case\n        alphas = [\n            case['alpha_O_2s'],\n            case['alpha_O_2p'], case['alpha_O_2p'], case['alpha_O_2p'],\n            case['alpha_H_1s'],\n            case['alpha_H_1s'],\n        ]\n\n        # Evaluate all basis functions on the grid\n        phi_grid = np.zeros((grid.shape[0], N_BASIS))\n        for i in range(N_BASIS):\n            info = basis_info[i]\n            alpha = alphas[i]\n            center = atom_coords[info['atom_idx']]\n            \n            r_minus_RA = grid - center\n            r_sq = np.sum(r_minus_RA**2, axis=1)\n            gauss_part = np.exp(-alpha * r_sq)\n\n            if info['type'] == 's':\n                norm = (2 * alpha / np.pi)**0.75\n                phi_grid[:, i] = norm * gauss_part\n            else: # p-type\n                norm = (128 * alpha**5 / np.pi**3)**0.25\n                if info['type'] == 'px':\n                    phi_grid[:, i] = norm * r_minus_RA[:, 0] * gauss_part\n                elif info['type'] == 'py':\n                    phi_grid[:, i] = norm * r_minus_RA[:, 1] * gauss_part\n                elif info['type'] == 'pz':\n                    phi_grid[:, i] = norm * r_minus_RA[:, 2] * gauss_part\n\n        # Compute Overlap (S) and Dipole (D) matrices\n        S = phi_grid.T @ phi_grid * dV\n        Dx = phi_grid.T @ (grid[:, 0, np.newaxis] * phi_grid) * dV\n        Dy = phi_grid.T @ (grid[:, 1, np.newaxis] * phi_grid) * dV\n        Dz = phi_grid.T @ (grid[:, 2, np.newaxis] * phi_grid) * dV\n\n        # Compute Hamiltonian matrix (H)\n        H = np.diag(H_diag)\n        H_off_diag = 0.5 * K_WH * S * (H_diag[:, np.newaxis] + H_diag)\n        H = H + (H_off_diag - np.diag(np.diag(H_off_diag)))\n\n        # Solve generalized eigenvalue problem: HC = SCe\n        energies, C = linalg.eigh(H, S)\n        \n        # Form density matrix from occupied orbitals\n        C_occ = C[:, :N_ELECTRONS // 2]\n        P = 2.0 * (C_occ @ C_occ.T)\n\n        # Compute electronic dipole moment\n        mu_el_x = -np.trace(P @ Dx)\n        mu_el_y = -np.trace(P @ Dy)\n        mu_el_z = -np.trace(P @ Dz)\n        mu_el = np.array([mu_el_x, mu_el_y, mu_el_z])\n\n        # Compute nuclear dipole moment\n        mu_nuc = np.zeros(3)\n        for i in range(len(atom_coords)):\n            mu_nuc += atom_charges[i] * atom_coords[i]\n\n        # Total dipole moment\n        mu_total = mu_nuc + mu_el  # in e*A\n        mu_mag_eA = np.linalg.norm(mu_total)\n        mu_mag_debye = mu_mag_eA * E_A_TO_DEBYE\n\n        # Store results\n        dipole_magnitudes.append(mu_mag_debye)\n        absolute_errors.append(abs(mu_mag_debye - MU_EXP_DEBYE))\n\n    # --- 7. Final Output ---\n    formatted_dms = [f\"{dm:.3f}\" for dm in dipole_magnitudes]\n    formatted_errs = [f\"{err:.3f}\" for err in absolute_errors]\n    \n    print(f\"[[{','.join(formatted_dms)}],[{','.join(formatted_errs)}]]\")\n\nsolve()\n\n```", "id": "2451307"}, {"introduction": "Individual molecules rarely exist in isolation; they are part of a larger ensemble, often with multiple accessible conformations. This final practice bridges the gap between the properties of a single molecule and the behavior of a bulk sample. By modeling the *anti* and *gauche* conformers of n-butane, you will use Boltzmann statistics to calculate a temperature-dependent, root-mean-square dipole moment, demonstrating how microscopic energies and structures govern macroscopic, observable properties ([@problem_id:2451507]).", "problem": "A neutral molecule consisting of four carbon sites is used to approximate conformational properties of $n$-butane. Two conformers are considered: the anti conformer with dihedral angle $\\phi_{\\text{anti}} = 180^{\\circ}$ about the central $\\mathrm{C}-\\mathrm{C}$ bond, and the gauche conformer with $\\phi_{\\text{gauche}} = 60^{\\circ}$. For both conformers, the positions of the four carbon nuclei are constructed from internal coordinates as follows.\n\nLet the carbon–carbon bond length be $r_{\\mathrm{CC}}$ (in $\\mathrm{\\AA}$) and the carbon–carbon–carbon bond angle be $\\theta$ (in degrees). Define the first three carbon positions in Cartesian space by\n- $\\mathbf{r}_1 = (0,0,0)$,\n- $\\mathbf{r}_2 = (r_{\\mathrm{CC}},0,0)$,\n- $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$ with $\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\; r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\; 0\\right)$,\n\nwhere $\\theta_{\\mathrm{rad}}$ is $\\theta$ converted to radians. The fourth carbon position $\\mathbf{r}_4$ is built from the internal coordinates $(r_{\\mathrm{CC}}, \\theta, \\phi)$ relative to $(\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3)$ by\n$$\n\\begin{aligned}\n\\mathbf{e}_1 &= \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1, \\\\\n\\theta_{\\mathrm{rad}} &= \\theta \\times \\frac{\\pi}{180},\\quad \\phi_{\\mathrm{rad}} = \\phi \\times \\frac{\\pi}{180}, \\\\\n\\mathbf{r}_4 &= \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n\\end{aligned}\n$$\n\nApproximate the permanent electric dipole moment $\\boldsymbol{\\mu}$ of each conformer using four point charges located on the carbon sites. The partial charges (in units of the elementary charge $e$) are $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$, so that the net charge is zero. The dipole vector is\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i,\n$$\nexpressed in $e\\cdot\\mathrm{\\AA}$. Its magnitude in Debye is given by\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times \\left(4.803204712\\,\\frac{\\mathrm{D}}{e\\cdot\\mathrm{\\AA}}\\right).\n$$\n\nThe conformational energy as a function of the dihedral angle $\\phi$ (in radians) is modeled by the truncated Fourier torsional potential\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\nwith $V_1$, $V_2$, and $V_3$ in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$. Convert energies to $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ using $1\\,\\mathrm{kcal}\\,\\mathrm{mol}^{-1} = 4.184\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\nLet $E_{\\text{anti}} = E(\\phi_{\\text{anti}})$ and $E_{\\text{gauche}} = E(\\phi_{\\text{gauche}})$. The energy difference to report is\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\nin $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$.\n\nAssume a thermal ensemble at absolute temperature $T$ in Kelvin with only the anti conformer and two degenerate gauche conformers ($\\phi = +60^{\\circ}$ and $\\phi = -60^{\\circ}$). The degeneracies are $g_{\\text{anti}} = 1$ and $g_{\\text{gauche}} = 2$. Using the ideal-gas constant $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ and energies in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$, define the Boltzmann probabilities\n$$\np_{\\text{anti}}(T) = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}},\\quad\np_{\\text{gauche}}(T) = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}.\n$$\n\nThe apparent dipole magnitude of the sample is defined here as the root-mean-square dipole,\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2},\n$$\nexpressed in Debye. Angles must be in degrees where stated; convert to radians where needed. Energies must be reported in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, dipole magnitudes in Debye (D), and temperatures in Kelvin.\n\nTest Suite. For each parameter set below, compute:\n- the energy difference $\\Delta E$ in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n- the dipole magnitudes $\\mu_{\\text{anti}}$ and $\\mu_{\\text{gauche}}$ in Debye,\n- the apparent dipole magnitudes $\\mu_{\\mathrm{rms}}(200\\,\\mathrm{K})$ and $\\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})$ in Debye.\n\nParameter sets:\n1) $\\delta = 0.10$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ (all $V_i$ in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$).\n2) $\\delta = 0.00$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ (all $V_i$ in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$).\n3) $\\delta = 0.20$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 110.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.2$, $V_3 = 0.4$ (all $V_i$ in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$).\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list of three five-element lists, one per parameter set, in this exact order of elements per set:\n$$\n[[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})]].\n$$\nFor the whole test suite, print a single line:\n$$\n[ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot] ].\n$$\nAll floats must be expressed in the units specified above.", "solution": "The task requires building conformer geometries from internal coordinates, computing conformer dipole moments from point charges, evaluating conformer energies from a torsional potential, and then predicting the temperature-dependent apparent dipole magnitude from Boltzmann statistics.\n\nGeometry construction. Place $\\mathbf{r}_1 = (0,0,0)$ and $\\mathbf{r}_2 = (r_{\\mathrm{CC}},0,0)$. The third carbon $\\mathbf{r}_3$ lies in the $xy$-plane defined by the first two atoms at a bond angle $\\theta$ relative to the $\\mathrm{C}_1-\\mathrm{C}_2-\\mathrm{C}_3$ angle. Using $\\theta_{\\mathrm{rad}} = \\theta \\pi/180$, \n$$\n\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\ r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\ 0\\right) = \\left(-r_{\\mathrm{CC}}\\cos\\theta_{\\mathrm{rad}},\\ r_{\\mathrm{CC}}\\sin\\theta_{\\mathrm{rad}},\\ 0\\right).\n$$\nThen $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$. The fourth carbon position $\\mathbf{r}_4$ is built by the standard internal-to-Cartesian mapping. Define unit vectors along the bond directions and the plane normal:\n$$\n\\mathbf{e}_1 = \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1.\n$$\nFor given bond length $r_{\\mathrm{CC}}$, bond angle $\\theta$, and dihedral angle $\\phi$, where both angles are converted to radians, the position is\n$$\n\\mathbf{r}_4 = \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n$$\nChoosing $\\phi_{\\text{anti}} = \\pi$ and $\\phi_{\\text{gauche}} = \\pi/3$ yields planar anti and skew gauche geometries, respectively.\n\nDipole moment. With partial charges $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$ (in units of the elementary charge), the molecular dipole vector in $e\\cdot\\mathrm{\\AA}$ is\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i.\n$$\nBecause the total charge is zero, $\\boldsymbol{\\mu}$ is independent of the choice of origin. The magnitude in Debye is\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times 4.803204712.\n$$\nFor the anti conformer with an inversion center at the midpoint of the inner bond when the geometry is constructed with equal bond lengths and angles, the charge distribution is invariant under inversion, leading to $\\boldsymbol{\\mu} \\approx \\mathbf{0}$. The gauche conformer lacks inversion symmetry, producing a nonzero $\\mu$ whose magnitude increases with $\\delta$ and depends on geometry.\n\nConformer energies and difference. The torsional potential is defined as\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\nwith $V_i$ in $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$. The energies at $\\phi_{\\text{anti}}$ and $\\phi_{\\text{gauche}}$ are computed, converted to $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ by multiplying by $4.184$, and the difference\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\nis reported in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. The chosen parameters produce $E_{\\text{anti}} < E_{\\text{gauche}}$ with a typical alkane-like stabilization of the anti conformer.\n\nThermal populations and apparent dipole. At temperature $T$, using degeneracies $g_{\\text{anti}}=1$ and $g_{\\text{gauche}}=2$ to represent the two equivalent gauche states, the partition function over these states is\n$$\nZ = g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)},\n$$\nand the probabilities are\n$$\np_{\\text{anti}} = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{Z},\\quad\np_{\\text{gauche}} = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{Z}.\n$$\nBecause the ensemble is isotropic, the vector-average dipole vanishes, and the apparent magnitude relevant for orientationally averaged observables is the root-mean-square dipole\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2}.\n$$\n\nAlgorithmic realization. For each test case: construct $\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3$ and then $\\mathbf{r}_4$ for $\\phi_{\\text{anti}}$ and $\\phi_{\\text{gauche}}$; compute $\\mu_{\\text{anti}}$ and $\\mu_{\\text{gauche}}$ from the charges and positions; evaluate $E_{\\text{anti}}$ and $E_{\\text{gauche}}$, convert to $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, and compute $\\Delta E$; compute $p_{\\text{anti}}(T)$ and $p_{\\text{gauche}}(T)$ at $T=200\\,\\mathrm{K}$ and $T=500\\,\\mathrm{K}$ using $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ with energies converted to $\\mathrm{J}\\,\\mathrm{mol}^{-1}$; finally compute $\\mu_{\\mathrm{rms}}(T)$ at both temperatures. Report for each test case the five-tuple $[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})]$ in the specified units and aggregate them into a single-line list.", "answer": "```python\nimport numpy as np\n\n# Constants\nDEBYE_PER_E_ANG = 4.803204712  # 1 e*Angstrom = 4.803204712 Debye\nKCAL_TO_KJ = 4.184            # 1 kcal/mol = 4.184 kJ/mol\nR_J_PER_MOLK = 8.314462618    # Gas constant in J/(mol*K)\n\ndef deg2rad(deg: float) -> float:\n    return deg * np.pi / 180.0\n\ndef unit(v: np.ndarray) -> np.ndarray:\n    n = np.linalg.norm(v)\n    if n == 0.0:\n        return v\n    return v / n\n\ndef build_initial_three(r_cc: float, theta_deg: float):\n    # r1 at origin, r2 on x-axis, r3 in xy-plane\n    r1 = np.array([0.0, 0.0, 0.0])\n    r2 = np.array([r_cc, 0.0, 0.0])\n    theta = deg2rad(theta_deg)\n    d23 = np.array([r_cc * np.cos(np.pi - theta), r_cc * np.sin(np.pi - theta), 0.0])\n    r3 = r2 + d23\n    return r1, r2, r3\n\ndef place_fourth(r1: np.ndarray, r2: np.ndarray, r3: np.ndarray,\n                 r_cc: float, theta_deg: float, dihedral_deg: float) -> np.ndarray:\n    theta = deg2rad(theta_deg)\n    phi = deg2rad(dihedral_deg)\n    e1 = unit(r2 - r3)\n    e2p = unit(r1 - r2)\n    n = unit(np.cross(e2p, e1))\n    # Handle potential collinearity by adjusting n if needed\n    if np.linalg.norm(n) == 0.0:\n        # In rare degenerate cases, pick an arbitrary perpendicular\n        # Choose a vector not parallel to e1\n        tmp = np.array([1.0, 0.0, 0.0])\n        if abs(np.dot(e1, tmp)) > 0.99:\n            tmp = np.array([0.0, 1.0, 0.0])\n        n = unit(np.cross(tmp, e1))\n    e2 = np.cross(n, e1)\n    r4 = r3 + r_cc * (-np.cos(theta) * e1 + np.sin(theta) * (np.cos(phi) * e2 + np.sin(phi) * n))\n    return r4\n\ndef dipole_magnitude_debye(positions: np.ndarray, charges_e: np.ndarray) -> float:\n    # positions: (N,3), charges: (N,)\n    mu_vec_eA = (charges_e[:, None] * positions).sum(axis=0)\n    mu_mag_debye = np.linalg.norm(mu_vec_eA) * DEBYE_PER_E_ANG\n    return mu_mag_debye\n\ndef torsion_energy_kj_per_mol(phi_deg: float, V1_kcal: float, V2_kcal: float, V3_kcal: float) -> float:\n    phi = deg2rad(phi_deg)\n    E_kcal = V1_kcal * np.cos(phi) + V2_kcal * np.cos(2.0 * phi) + V3_kcal * np.cos(3.0 * phi)\n    return E_kcal * KCAL_TO_KJ\n\ndef boltzmann_populations(E_anti_kJ: float, E_gauche_kJ: float, T: float):\n    # Include degeneracy: g_anti=1, g_gauche=2\n    g_anti = 1.0\n    g_gauche = 2.0\n    # Convert energies to J/mol\n    Ea = E_anti_kJ * 1000.0\n    Eg = E_gauche_kJ * 1000.0\n    beta = 1.0 / (R_J_PER_MOLK * T)\n    wa = g_anti * np.exp(-beta * Ea)\n    wg = g_gauche * np.exp(-beta * Eg)\n    Z = wa + wg\n    pa = wa / Z\n    pg = wg / Z\n    return pa, pg\n\ndef compute_case(delta_e: float, r_cc: float, theta_deg: float, V1: float, V2: float, V3: float):\n    # Build coordinates for anti and gauche\n    r1, r2, r3 = build_initial_three(r_cc, theta_deg)\n    r4_anti = place_fourth(r1, r2, r3, r_cc, theta_deg, 180.0)\n    r4_gauche = place_fourth(r1, r2, r3, r_cc, theta_deg, 60.0)\n    # Charges on carbons\n    charges = np.array([+delta_e, -delta_e, -delta_e, +delta_e])\n    # Positions arrays\n    pos_anti = np.vstack([r1, r2, r3, r4_anti])\n    pos_gauche = np.vstack([r1, r2, r3, r4_gauche])\n    # Dipoles\n    mu_anti = dipole_magnitude_debye(pos_anti, charges)\n    mu_gauche = dipole_magnitude_debye(pos_gauche, charges)\n    # Energies\n    E_anti_kJ = torsion_energy_kj_per_mol(180.0, V1, V2, V3)\n    E_gauche_kJ = torsion_energy_kj_per_mol(60.0, V1, V2, V3)\n    deltaE_kJ = E_gauche_kJ - E_anti_kJ\n    # Apparent dipoles at 200 K and 500 K\n    results = []\n    for T in (200.0, 500.0):\n        p_anti, p_gauche = boltzmann_populations(E_anti_kJ, E_gauche_kJ, T)\n        mu_rms = np.sqrt(p_anti * (mu_anti ** 2) + p_gauche * (mu_gauche ** 2))\n        results.append(mu_rms)\n    mu_rms_200, mu_rms_500 = results\n    return [deltaE_kJ, mu_anti, mu_gauche, mu_rms_200, mu_rms_500]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (delta, r_cc, theta_deg, V1, V2, V3)\n    test_cases = [\n        (0.10, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.00, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.20, 1.540, 110.0, 0.0, -0.2, 0.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, r_cc, theta_deg, V1, V2, V3 = case\n        res = compute_case(delta, r_cc, theta_deg, V1, V2, V3)\n        # Format to a reasonable number of decimals for readability\n        res_fmt = [float(f\"{x:.6f}\") for x in res]\n        results.append(res_fmt)\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2451507"}]}