{"hands_on_practices": [{"introduction": "This first exercise establishes the fundamental link between a molecule's potential energy curve and its vibrational spectrum. Using the diatomic molecule iodine ($\\text{I}_2$) and the well-known Morse potential, you will calculate the harmonic vibrational frequency from first principles and explore how it is influenced by relativistic effects. This practice provides a solid foundation by connecting the abstract concept of a potential surface to a measurable spectroscopic quantity. [@problem_id:2462305]", "problem": "You will write a complete program that models the influence of scalar relativistic effects on the vibrational wavenumber and Raman activity of the heavy homonuclear diatomic molecule iodine, denoted as $\\text{I}_2$. The program must derive the vibrational wavenumber in the harmonic limit from a Morse potential representation of the Born–Oppenheimer potential energy curve and estimate the change induced by scalar relativistic scaling of the Morse parameters. It must also estimate the relative change in the isotropic Raman activity using a linear polarizability model.\n\nStart from the following fundamental definitions and well-tested facts:\n- In the harmonic approximation, the angular frequency $ \\omega $ of a normal mode is given by $ \\omega = \\sqrt{k / \\mu} $, where $ k = \\left. \\frac{d^2 V}{dr^2} \\right|_{r_e} $ is the curvature of the potential energy $ V(r) $ at the equilibrium bond distance $ r_e $, and $ \\mu $ is the reduced mass of the diatomic molecule.\n- The Morse potential is $ V(r) = D_e \\left( 1 - e^{-a(r - r_e)} \\right)^2 $, with well depth $ D_e $ and range parameter $ a $.\n- The spectroscopic wavenumber $ \\tilde{\\nu} $ in inverse centimeters is related to the angular frequency by $ \\tilde{\\nu} = \\omega / (2 \\pi c) $, where $ c $ is the speed of light. If $ c $ is used in centimeters per second, then $ \\tilde{\\nu} $ is in $\\mathrm{cm}^{-1}$.\n- The isotropic Raman activity for a fundamental vibrational transition scales with the square of the derivative of the isotropic polarizability $ \\bar{\\alpha} $ with respect to the normal coordinate $ Q $, that is, $ S \\propto \\left( \\frac{d \\bar{\\alpha}}{d Q} \\right)^2 $. For a diatomic molecule with a single stretching coordinate, a linear polarizability model is $ \\bar{\\alpha}(r) = \\alpha_0 + \\alpha_1 (r - r_e) $, and the mass-weighted normal coordinate is $ Q = \\sqrt{\\mu} (r - r_e) $.\n\nYour program must implement the following steps for each test case:\n1. Use the given nonrelativistic Morse parameters $ D_e $ (in electronvolts) and $ a $ (in inverse angstroms) to compute the harmonic wavenumber $ \\tilde{\\nu}_{\\mathrm{NR}} $ in $\\mathrm{cm}^{-1}$. You must convert all quantities to International System of Units (SI) where needed and then return the wavenumber in $\\mathrm{cm}^{-1}$. Use $ m_{\\mathrm{I}} = 126.90447 $ unified atomic mass units for iodine, and the reduced mass $ \\mu = m_{\\mathrm{I}} / 2 $. Use $ 1 $ unified atomic mass unit $ = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg} $, $ 1 $ electronvolt $ = 1.602176634 \\times 10^{-19} \\ \\mathrm{J} $, $ 1 \\ \\text{\\AA}^{-1} = 10^{10} \\ \\mathrm{m}^{-1} $, and $ c = 2.99792458 \\times 10^{10} \\ \\mathrm{cm} \\ \\mathrm{s}^{-1} $.\n2. Model scalar relativistic effects as multiplicative fractional changes to the Morse parameters: $ D_e \\mapsto D_e (1 + f_D) $ and $ a \\mapsto a (1 + f_a) $, where $ f_D $ and $ f_a $ are provided dimensionless fractional changes (such as $ 0.03 $ for a $ 3 $ percent increase). Compute the corresponding relativistically corrected wavenumber $ \\tilde{\\nu}_{\\mathrm{SR}} $ in $\\mathrm{cm}^{-1}$.\n3. Compute the wavenumber shift $ \\Delta \\tilde{\\nu} = \\tilde{\\nu}_{\\mathrm{SR}} - \\tilde{\\nu}_{\\mathrm{NR}} $ in $\\mathrm{cm}^{-1}$.\n4. For Raman activity, assume the isotropic polarizability model $ \\bar{\\alpha}(r) = \\alpha_0 + \\alpha_1 (r - r_e) $, with the provided $ \\alpha_1 $ in units of cubic angstrom per angstrom. Let the relativistic change be $ \\alpha_1 \\mapsto \\alpha_1 (1 + f_\\alpha) $. Using the definition of the normal coordinate, derive $ \\frac{d \\bar{\\alpha}}{d Q} = \\alpha_1 / \\sqrt{\\mu} $ up to a common unit conversion factor. Report the ratio of scalar relativistic to nonrelativistic isotropic Raman activity, $ R_S = \\frac{S_{\\mathrm{SR}}}{S_{\\mathrm{NR}}} $, as a dimensionless decimal. Express $ R_S $ numerically in decimal form rather than as a percentage.\n\nTest suite and required inputs for each case:\n- Case A (general): $ D_e = 1.54 $ electronvolts, $ a = 1.50 $ inverse angstroms, $ f_D = 0.02 $, $ f_a = 0.03 $, $ \\alpha_1 = 1.00 $ cubic angstrom per angstrom, $ f_\\alpha = 0.05 $.\n- Case B (boundary: no relativistic change): $ D_e = 1.54 $ electronvolts, $ a = 1.50 $ inverse angstroms, $ f_D = 0.00 $, $ f_a = 0.00 $, $ \\alpha_1 = 1.00 $ cubic angstrom per angstrom, $ f_\\alpha = 0.00 $.\n- Case C (stronger relativistic response and different baseline): $ D_e = 1.80 $ electronvolts, $ a = 1.30 $ inverse angstroms, $ f_D = 0.05 $, $ f_a = 0.08 $, $ \\alpha_1 = 0.80 $ cubic angstrom per angstrom, $ f_\\alpha = 0.10 $.\n\nYour program must:\n- Compute $ \\Delta \\tilde{\\nu} $ in $ \\mathrm{cm}^{-1} $ for each case and round it to six decimal places.\n- Compute the Raman activity ratio $ R_S $ as a dimensionless decimal for each case and round it to six decimal places.\n- Produce a single line of output containing the results as a comma-separated list of sublists, each sublist containing $ [\\Delta \\tilde{\\nu}, R_S] $ for a test case, all enclosed in square brackets. For example: $ [[x_1,y_1],[x_2,y_2],[x_3,y_3]] $, where $ x_i $ and $ y_i $ are decimal numbers with six digits after the decimal point.\n\nScientific realism requirements:\n- Treat $\\text{I}_2$ as a rigid diatomic described by a Morse potential near the minimum.\n- Assume scalar relativistic effects act as small multiplicative changes to $ D_e $ and $ a $ as specified.\n- All constants and unit conversions must be applied consistently.\n\nAngle units are not used. All physical quantities that require units must be expressed as specified above. The final outputs are floats in the units or dimensionless form explicitly requested.", "solution": "The problem as stated is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It presents a standard, albeit simplified, computational exercise in theoretical spectroscopy based on established physical models and principles. All necessary parameters and constants are provided, and the required calculations are logically sound and lead to a unique, verifiable solution. Therefore, we proceed with the derivation and computational implementation.\n\nThe objective is to compute the influence of scalar relativistic effects on the harmonic vibrational wavenumber and isotropic Raman activity of the $\\text{I}_2$ molecule. This will be accomplished by applying scaling factors to the parameters of a Morse potential and a linear polarizability model.\n\nFirst, we derive the expression for the harmonic vibrational wavenumber from the Morse potential, given as:\n$$ V(r) = D_e \\left( 1 - e^{-a(r - r_e)} \\right)^2 $$\nwhere $D_e$ is the potential well depth, $a$ is the range parameter, and $r_e$ is the equilibrium bond distance.\n\nThe harmonic approximation requires the force constant $k$, which is the second derivative of the potential energy with respect to the internuclear distance $r$, evaluated at the equilibrium position $r_e$.\nThe first derivative is:\n$$ \\frac{dV}{dr} = D_e \\cdot 2 \\left( 1 - e^{-a(r - r_e)} \\right) \\cdot \\left( -e^{-a(r - r_e)} \\right) \\cdot (-a) = 2aD_e \\left( e^{-a(r - r_e)} - e^{-2a(r - r_e)} \\right) $$\nThe second derivative is:\n$$ \\frac{d^2V}{dr^2} = 2aD_e \\left( -a e^{-a(r - r_e)} + 2a e^{-2a(r - r_e)} \\right) $$\nEvaluating at $r = r_e$:\n$$ k = \\left. \\frac{d^2V}{dr^2} \\right|_{r=r_e} = 2aD_e (-a e^0 + 2a e^0) = 2a^2 D_e $$\nThe angular frequency $\\omega$ of the vibration is given by $\\omega = \\sqrt{k / \\mu}$, where $\\mu$ is the reduced mass of the molecule. Substituting the expression for $k$:\n$$ \\omega = \\sqrt{\\frac{2a^2 D_e}{\\mu}} = a \\sqrt{\\frac{2D_e}{\\mu}} $$\nThe vibrational wavenumber $\\tilde{\\nu}$ (in $\\mathrm{cm}^{-1}$) is related to $\\omega$ by $\\tilde{\\nu} = \\omega / (2 \\pi c)$, where $c$ is the speed of light in $\\mathrm{cm}\\cdot\\mathrm{s}^{-1}$. The resulting expression for the wavenumber is:\n$$ \\tilde{\\nu} = \\frac{a}{2 \\pi c} \\sqrt{\\frac{2D_e}{\\mu}} $$\nFor this calculation, all quantities must be in a consistent unit system. We will convert the given parameters to SI units for intermediate steps:\n- $D_e$ from electronvolts ($eV$) to Joules ($J$).\n- $a$ from inverse angstroms ($\\text{\\AA}^{-1}$) to inverse meters ($\\mathrm{m}^{-1}$).\n- The mass of iodine $m_{\\mathrm{I}}$ from unified atomic mass units ($u$) to kilograms ($kg$), from which the reduced mass $\\mu = m_{\\mathrm{I}}/2$ is found.\nThe speed of light $c$ is given in $\\mathrm{cm}\\cdot\\mathrm{s}^{-1}$, which is appropriate for obtaining the final wavenumber directly in $\\mathrm{cm}^{-1}$.\n\nThe non-relativistic wavenumber, $\\tilde{\\nu}_{\\mathrm{NR}}$, is computed using the base parameters $D_e$ and $a$. Scalar relativistic effects are modeled by scaling these parameters:\n$$ D_e' = D_e (1 + f_D) $$\n$$ a' = a (1 + f_a) $$\nThe scalar relativistic wavenumber, $\\tilde{\\nu}_{\\mathrm{SR}}$, is then computed using $D_e'$ and $a'$. From the structure of the wavenumber formula, we can write:\n$$ \\tilde{\\nu}_{\\mathrm{SR}} = \\frac{a(1+f_a)}{2 \\pi c} \\sqrt{\\frac{2D_e(1+f_D)}{\\mu}} = \\left( \\frac{a}{2 \\pi c} \\sqrt{\\frac{2D_e}{\\mu}} \\right) (1+f_a)\\sqrt{1+f_D} = \\tilde{\\nu}_{\\mathrm{NR}} (1+f_a)\\sqrt{1+f_D} $$\nThe required wavenumber shift is $\\Delta \\tilde{\\nu} = \\tilde{\\nu}_{\\mathrm{SR}} - \\tilde{\\nu}_{\\mathrm{NR}}$.\n\nNext, we address the isotropic Raman activity, $S$. It is given to be proportional to the square of the derivative of the isotropic polarizability $\\bar{\\alpha}$ with respect to the normal coordinate $Q$:\n$$ S \\propto \\left( \\frac{d \\bar{\\alpha}}{d Q} \\right)^2 $$\nThe polarizability is modeled linearly as $\\bar{\\alpha}(r) = \\alpha_0 + \\alpha_1 (r - r_e)$, and the normal coordinate is $Q = \\sqrt{\\mu} (r - r_e)$. We can express $\\bar{\\alpha}$ as a function of $Q$ by noting that $(r - r_e) = Q / \\sqrt{\\mu}$. Substituting this gives:\n$$ \\bar{\\alpha}(Q) = \\alpha_0 + \\alpha_1 \\left( \\frac{Q}{\\sqrt{\\mu}} \\right) $$\nThe derivative with respect to $Q$ is straightforward:\n$$ \\frac{d \\bar{\\alpha}}{d Q} = \\frac{\\alpha_1}{\\sqrt{\\mu}} $$\nTherefore, the Raman activity is proportional to:\n$$ S \\propto \\left(\\frac{\\alpha_1}{\\sqrt{\\mu}}\\right)^2 = \\frac{\\alpha_1^2}{\\mu} $$\nThe ratio of the scalar relativistic activity $S_{\\mathrm{SR}}$ to the non-relativistic activity $S_{\\mathrm{NR}}$ is required. Relativistic effects are modeled by scaling $\\alpha_1$ to $\\alpha_1' = \\alpha_1(1 + f_\\alpha)$. The reduced mass $\\mu$, a nuclear property, is unaffected by electronic relativistic corrections. Thus, we have:\n$$ S_{\\mathrm{NR}} \\propto \\frac{\\alpha_1^2}{\\mu} \\quad \\text{and} \\quad S_{\\mathrm{SR}} \\propto \\frac{(\\alpha_1')^2}{\\mu} = \\frac{(\\alpha_1(1+f_\\alpha))^2}{\\mu} $$\nThe ratio $R_S$ is:\n$$ R_S = \\frac{S_{\\mathrm{SR}}}{S_{\\mathrm{NR}}} = \\frac{\\alpha_1^2 (1+f_\\alpha)^2 / \\mu}{\\alpha_1^2 / \\mu} = (1+f_\\alpha)^2 $$\nThis provides a direct formula for the change in Raman activity.\n\nThe computational procedure will involve implementing these derived formulas for each test case, performing unit conversions correctly, and formatting the output as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes scalar relativistic effects on the vibrational wavenumber and Raman\n    activity of I2 based on a Morse potential and linear polarizability model.\n    \"\"\"\n\n    # --- Constants ---\n    # Mass of Iodine in unified atomic mass units (u)\n    M_I_U = 126.90447\n    # Conversion from u to kg\n    U_TO_KG = 1.66053906660e-27\n    # Conversion from electronvolt (eV) to Joules (J)\n    EV_TO_J = 1.602176634e-19\n    # Conversion from inverse Angstrom (A^-1) to inverse meter (m^-1)\n    INV_A_TO_INV_M = 1e10\n    # Speed of light in cm/s\n    C_CMS = 2.99792458e10\n\n    # Reduced mass of I2 molecule in kg\n    reduced_mass = (M_I_U / 2.0) * U_TO_KG\n\n    def calculate_wavenumber(De_eV, a_inv_A):\n        \"\"\"\n        Calculates the harmonic vibrational wavenumber from Morse parameters.\n\n        Args:\n            De_eV (float): Morse potential well depth in eV.\n            a_inv_A (float): Morse potential range parameter in A^-1.\n\n        Returns:\n            float: Vibrational wavenumber in cm^-1.\n        \"\"\"\n        # Convert parameters to SI units for angular frequency calculation\n        De_J = De_eV * EV_TO_J\n        a_inv_m = a_inv_A * INV_A_TO_INV_M\n        \n        # Angular frequency in rad/s: omega = a * sqrt(2*De / mu)\n        omega = a_inv_m * np.sqrt(2 * De_J / reduced_mass)\n        \n        # Wavenumber in cm^-1: nu_tilde = omega / (2 * pi * c)\n        wavenumber = omega / (2 * np.pi * C_CMS)\n        \n        return wavenumber\n\n    # Test cases: (De, a, fD, fa, alpha1, f_alpha)\n    test_cases = [\n        # Case A: General case\n        (1.54, 1.50, 0.02, 0.03, 1.00, 0.05),\n        # Case B: Boundary case (no relativistic effects)\n        (1.54, 1.50, 0.00, 0.00, 1.00, 0.00),\n        # Case C: Stronger relativistic response\n        (1.80, 1.30, 0.05, 0.08, 0.80, 0.10)\n    ]\n\n    results = []\n    for case in test_cases:\n        De, a, fD, fa, alpha1, f_alpha = case\n\n        # --- Wavenumber Calculation ---\n        # 1. Non-relativistic wavenumber\n        nu_NR = calculate_wavenumber(De, a)\n        \n        # 2. Relativistically corrected parameters\n        De_SR = De * (1 + fD)\n        a_SR = a * (1 + fa)\n        \n        # 3. Scalar relativistic wavenumber\n        nu_SR = calculate_wavenumber(De_SR, a_SR)\n        \n        # 4. Wavenumber shift\n        delta_nu = nu_SR - nu_NR\n        \n        # --- Raman Activity Ratio Calculation ---\n        # The ratio Rs simplifies to (1 + f_alpha)^2\n        Rs = (1 + f_alpha)**2\n        \n        # Store results rounded to six decimal places\n        results.append([round(delta_nu, 6), round(Rs, 6)])\n\n    # Format the final output string as [[x1,y1],[x2,y2],[x3,y3]]\n    output_str = \"[\" + \",\".join([f\"[{x:.6f},{y:.6f}]\" for x, y in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2462305"}, {"introduction": "Building on the basics, this practice introduces the core computational method for polyatomic molecules: normal mode analysis. Using a simplified model of benzene ($\\text{C}_6\\text{H}_6$), you will construct and solve the vibrational problem to understand how individual atomic motions couple into collective vibrations. By comparing the results with its deuterated isotopologue ($\\text{C}_6\\text{D}_6$), you will directly observe the isotopic effect, a key principle used to assign spectral peaks and understand the nature of vibrational modes. [@problem_id:2462254]", "problem": "Consider a simplified, first-principles harmonic model for the in-plane vibrational Raman response of benzene, focusing on how isotopic substitution modifies vibrational frequencies and mode character. The molecule is represented as a ring of $6$ identical carbon sites, each bonded to one hydrogen-like isotope. Each site contributes one one-dimensional radial coordinate for the carbon, $x_i$, and one one-dimensional radial coordinate for the attached hydrogen-like atom, $y_i$, with $i \\in \\{0,1,2,3,4,5\\}$ and periodic boundary condition $x_{i+6} \\equiv x_i$. Collect these $12$ coordinates into a column vector $q = (x_0,\\dots,x_5,y_0,\\dots,y_5)^{\\mathsf{T}}$.\n\nThe potential energy in the harmonic approximation (in the International System of Units) is\n$$\nU(q) \\;=\\; \\frac{1}{2}\\sum_{i=0}^{5}\\Big[ k_{\\mathrm{CR}}\\,x_i^2 \\;+\\; k_{\\mathrm{CH}}\\,(x_i - y_i)^2 \\;+\\; k_{\\mathrm{CC}}\\,(x_i - x_{i+1})^2 \\Big],\n$$\nwhere $k_{\\mathrm{CH}}$ is the carbon–hydrogen bond spring constant, $k_{\\mathrm{CR}}$ is a carbon radial anchoring spring constant representing the restoring effect of the carbon framework, and $k_{\\mathrm{CC}}$ is a nearest-neighbor carbon–carbon coupling spring constant. The mass matrix is diagonal with $m_{\\mathrm{C}}$ assigned to each $x_i$ and an isotope-dependent $m_{\\mathrm{H}}$ assigned to each $y_i$. Let $M$ denote this diagonal mass matrix and $K$ the Hessian of $U(q)$.\n\nUnder the harmonic approximation, the vibrational normal mode angular frequencies are given by the positive square roots of the eigenvalues $\\lambda_j$ of the mass-weighted Hessian $M^{-1/2} K M^{-1/2}$, that is, $\\omega_j = \\sqrt{\\lambda_j}$. The corresponding spectroscopic wavenumbers in inverse centimeters are obtained by\n$$\n\\tilde{\\nu}_j \\;=\\; \\frac{\\omega_j}{2\\pi c},\n$$\nwith the speed of light $c$ to be used in $\\mathrm{cm/s}$.\n\nTo model Raman scattering within this simplified framework, define the derivative of the isotropic molecular polarizability with respect to the Cartesian coordinates $q$ as a constant vector $p_u \\in \\mathbb{R}^{12}$ such that, for each site $i$, the carbon component is $-\\beta$ and the hydrogen-like component is $+\\beta$, that is,\n$$\n\\left(\\frac{\\partial \\alpha}{\\partial x_i}\\right) = -\\beta,\\qquad \\left(\\frac{\\partial \\alpha}{\\partial y_i}\\right) = +\\beta,\\qquad \\text{for all } i \\in \\{0,\\dots,5\\}.\n$$\nThis choice models a response dominated by bond-stretching ($(y_i - x_i)$) along each carbon–hydrogen axis, which is known to contribute strongly to totally symmetric Raman activity.\n\nFor a normalized mass-weighted eigenvector $e_j$ (eigenvector of $M^{-1/2} K M^{-1/2}$) corresponding to mode $j$, the Raman activity proxy $S_j$ is defined as\n$$\nS_j \\;\\propto\\; \\Big( p_u^{\\mathsf{T}}\\,M^{-1/2} e_j \\Big)^2,\n$$\nwhere $M^{-1/2}$ is the diagonal matrix with entries $1/\\sqrt{m_i}$. This expression corresponds to the square of the derivative of the isotropic polarizability with respect to the mass-weighted normal coordinate $Q_j$ and is sufficient for ranking relative activities in this model. Only relative values of $S_j$ are used to select the most Raman-active mode.\n\nTo quantify how isotopic substitution affects mode character, define for any mode $j$ the hydrogen-participation ratio\n$$\nP_{H,j} \\;=\\; \\frac{\\sum_{i=0}^{5} u_{y_i,j}^2}{\\sum_{i=0}^{5} u_{x_i,j}^2 + \\sum_{i=0}^{5} u_{y_i,j}^2},\n$$\nwhere $u_{x_i,j}$ and $u_{y_i,j}$ are the physical displacement components (in meters) of mode $j$ for carbon and hydrogen-like coordinates, respectively, obtained from the mass-weighted eigenvector via $u_j = M^{-1/2} e_j$.\n\nConstants and units to use:\n- Unified atomic mass unit (u): $1\\,\\mathrm{u} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n- Carbon mass: $m_{\\mathrm{C}} = 12.011\\,\\mathrm{u}$.\n- Hydrogen-isotope masses for the test suite:\n  - Case $1$ ($\\text{C}_6\\text{H}_6$): $m_{\\mathrm{H}} = 1.00784\\,\\mathrm{u}$.\n  - Case $2$ ($\\text{C}_6\\text{D}_6$): $m_{\\mathrm{H}} = 2.01410\\,\\mathrm{u}$.\n  - Case $3$ ($\\text{C}_6\\text{T}_6$): $m_{\\mathrm{H}} = 3.01605\\,\\mathrm{u}$.\n- Spring constants: $k_{\\mathrm{CH}} = 500\\,\\mathrm{N/m}$, $k_{\\mathrm{CR}} = 100\\,\\mathrm{N/m}$, $k_{\\mathrm{CC}} = 50\\,\\mathrm{N/m}$.\n- Polarizability derivative magnitude: $\\beta = 1.0$ in arbitrary but consistent units per meter.\n- Speed of light: $c = 2.99792458\\times 10^{10}\\,\\mathrm{cm/s}$.\n\nTask:\nFor each of the three mass cases above, determine:\n- The wavenumber $\\tilde{\\nu}_{\\star}$ (in $\\mathrm{cm^{-1}}$) of the single most Raman-active normal mode, defined as the mode with the largest $S_j$.\n- The hydrogen-participation ratio $P_{H,\\star}$ of that most Raman-active mode.\n\nReport $\\tilde{\\nu}_{\\star}$ in $\\mathrm{cm^{-1}}$, rounded to one decimal place, and $P_{H,\\star}$ as a decimal rounded to $6$ decimal places.\n\nTest suite to implement:\n- Case $1$: $(m_{\\mathrm{H}} = 1.00784\\,\\mathrm{u})$.\n- Case $2$: $(m_{\\mathrm{H}} = 2.01410\\,\\mathrm{u})$.\n- Case $3$: $(m_{\\mathrm{H}} = 3.01605\\,\\mathrm{u})$.\n\nFinal output format:\nYour program should produce a single line of output containing the six results aggregated in order of the cases above as a comma-separated list enclosed in square brackets:\n$[\\tilde{\\nu}_{\\star}^{(1)},P_{H,\\star}^{(1)},\\tilde{\\nu}_{\\star}^{(2)},P_{H,\\star}^{(2)},\\tilde{\\nu}_{\\star}^{(3)},P_{H,\\star}^{(3)}]$.", "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded, well-posed, and objective, with all necessary data and definitions provided for a unique solution. The model, though a simplification of a real benzene molecule, is a standard and well-defined problem in theoretical vibrational spectroscopy.\n\nThe task is to determine the wavenumber $\\tilde{\\nu}_{\\star}$ and hydrogen-participation ratio $P_{H,\\star}$ for the most Raman-active vibrational normal mode in a simplified model of benzene and its isotopologues $\\text{C}_6\\text{H}_6$, $\\text{C}_6\\text{D}_6$, and $\\text{C}_6\\text{T}_6$.\n\nThe system has $N=12$ degrees of freedom, described by the coordinate vector $q = (x_0, \\dots, x_5, y_0, \\dots, y_5)^{\\mathsf{T}}$. The potential energy is given by\n$$ U(q) = \\frac{1}{2}\\sum_{i=0}^{5}\\Big[ k_{\\mathrm{CR}}\\,x_i^2 + k_{\\mathrm{CH}}\\,(x_i - y_i)^2 + k_{\\mathrm{CC}}\\,(x_i - x_{i+1})^2 \\Big] $$\nThe analysis proceeds by solving the generalized eigenvalue problem $K u = \\lambda M u$, where $K$ is the Hessian matrix of the potential energy, $M$ is the diagonal mass matrix, and $u$ are the displacement eigenvectors. This is equivalent to solving the standard eigenvalue problem $H' e_j = \\lambda_j e_j$, where $H' = M^{-1/2} K M^{-1/2}$ is the mass-weighted Hessian, and $e_j = M^{1/2} u_j$ are the mass-weighted eigenvectors.\n\nThe Hessian matrix $K_{kl} = \\frac{\\partial^2 U}{\\partial q_k \\partial q_l}$ is a $12 \\times 12$ matrix. It can be partitioned into $6 \\times 6$ blocks corresponding to carbon ($x$) and hydrogen ($y$) coordinates:\n$$ K = \\begin{pmatrix} K_{xx}  K_{xy} \\\\ K_{yx}  K_{yy} \\end{pmatrix} $$\nThe elements are derived from the potential energy function:\n- $K_{x_i, x_j} = \\frac{\\partial^2 U}{\\partial x_i \\partial x_j}$: $(K_{xx})_{ii} = k_{\\mathrm{CR}} + k_{\\mathrm{CH}} + 2k_{\\mathrm{CC}}$, $(K_{xx})_{i,i\\pm 1} = -k_{\\mathrm{CC}}$ (with periodic boundaries), and $0$ otherwise. This submatrix, let's call it $A$, is circulant.\n- $K_{y_i, y_j} = \\frac{\\partial^2 U}{\\partial y_i \\partial y_j}$: $(K_{yy})_{ij} = k_{\\mathrm{CH}} \\delta_{ij}$. So $K_{yy} = k_{\\mathrm{CH}} I_6$.\n- $K_{x_i, y_j} = \\frac{\\partial^2 U}{\\partial x_i \\partial y_j}$: $(K_{xy})_{ij} = -k_{\\mathrm{CH}} \\delta_{ij}$. So $K_{xy} = -k_{\\mathrm{CH}} I_6$.\n- $K_{yx} = K_{xy}^{\\mathsf{T}} = K_{xy}$.\n\nThe mass matrix $M$ is diagonal, with the first $6$ entries equal to $m_{\\mathrm{C}}$ and the last $6$ equal to $m_{\\mathrm{H}}$. The mass-weighted Hessian $H' = M^{-1/2} K M^{-1/2}$ is then\n$$ H' = \\begin{pmatrix} m_{\\mathrm{C}}^{-1} A  -k_{\\mathrm{CH}} (m_{\\mathrm{C}}m_{\\mathrm{H}})^{-1/2} I_6 \\\\ -k_{\\mathrm{CH}} (m_{\\mathrm{C}}m_{\\mathrm{H}})^{-1/2} I_6  k_{\\mathrm{CH}} m_{\\mathrm{H}}^{-1} I_6 \\end{pmatrix} $$\n\nDue to the $C_6$ cyclic symmetry of the molecule, the problem can be greatly simplified. The Raman activity proxy $S_j$ is given by $S_j \\propto ( p_u^{\\mathsf{T}}\\,u_j )^2$, where $u_j = M^{-1/2} e_j$ is the physical displacement vector and $p_u$ is the polarizability derivative vector. The vector $p_u$ is defined such that its components are $-\\beta$ for all carbon coordinates and $+\\beta$ for all hydrogen-like coordinates. This vector belongs to the totally symmetric irreducible representation (A-type) of the $C_6$ point group. By selection rules, the inner product $p_u^{\\mathsf{T}}\\,u_j$ is non-zero only if the mode displacement vector $u_j$ also belongs to the totally symmetric representation.\n\nA totally symmetric mode must have identical displacements for all equivalent atoms. Thus, for such a mode, $x_0 = x_1 = \\dots = x_5$ and $y_0 = y_1 = \\dots = y_5$. The corresponding mass-weighted eigenvector $e_j$ will have the form $(e_{C,j}, \\dots, e_{C,j}, e_{H,j}, \\dots, e_{H,j})^{\\mathsf{T}}$.\nThe action of $H'$ on such a vector simplifies significantly. An eigenvector of a circulant matrix corresponding to the totally symmetric mode is $(1, 1, 1, 1, 1, 1)^{\\mathsf{T}}$, and the eigenvalue is the sum of the elements in any row of the matrix. For submatrix $A$, this sum is $(k_{\\mathrm{CR}} + k_{\\mathrm{CH}} + 2k_{\\mathrm{CC}}) + (-k_{\\mathrm{CC}}) + (-k_{\\mathrm{CC}}) = k_{\\mathrm{CR}} + k_{\\mathrm{CH}}$. The $k_{\\mathrm{CC}}$ term vanishes because, in a totally symmetric vibration, all C-C distances remain unchanged.\n\nThis reduces the $12 \\times 12$ eigenvalue problem to a $2 \\times 2$ problem for the amplitudes $(e_C, e_H)^{\\mathsf{T}}$ of the totally symmetric modes:\n$$ H'_{\\mathrm{sym}} \\begin{pmatrix} e_C \\\\ e_H \\end{pmatrix} = \\lambda \\begin{pmatrix} e_C \\\\ e_H \\end{pmatrix}, \\quad \\text{where} \\quad H'_{\\mathrm{sym}} = \\begin{pmatrix} (k_{\\mathrm{CR}}+k_{\\mathrm{CH}})/m_{\\mathrm{C}}  -k_{\\mathrm{CH}}/\\sqrt{m_{\\mathrm{C}}m_{\\mathrm{H}}} \\\\ -k_{\\mathrm{CH}}/\\sqrt{m_{\\mathrm{C}}m_{\\mathrm{H}}}  k_{\\mathrm{CH}}/m_{\\mathrm{H}} \\end{pmatrix} $$\nSolving this $2 \\times 2$ system yields two eigenvalues, $\\lambda_1, \\lambda_2$, and two corresponding normalized eigenvectors $(e_{C,1}, e_{H,1})^{\\mathsf{T}}$ and $(e_{C,2}, e_{H,2})^{\\mathsf{T}}$. These are the only two modes with potentially non-zero Raman activity.\n\nFor each of these two modes ($j=1,2$):\nThe angular frequency is $\\omega_j = \\sqrt{\\lambda_j}$ and the wavenumber is $\\tilde{\\nu}_j = \\frac{\\omega_j}{2\\pi c}$.\nThe physical displacement amplitudes are $u_{C,j} = e_{C,j}/\\sqrt{m_{\\mathrm{C}}}$ and $u_{H,j} = e_{H,j}/\\sqrt{m_{\\mathrm{H}}}$.\nThe Raman activity proxy, accounting for all $6$ sites, is $S_j = ( \\sum_{i=0}^5 [-\\beta u_{C,j} + \\beta u_{H,j}] )^2 = (6\\beta(u_{H,j}-u_{C,j}))^2$.\nThe hydrogen-participation ratio is $P_{H,j} = \\frac{6 u_{H,j}^2}{6 u_{C,j}^2 + 6 u_{H,j}^2} = \\frac{u_{H,j}^2}{u_{C,j}^2 + u_{H,j}^2}$.\n\nThe algorithm for each isotopic case is as follows:\n1. Define constants and convert masses from atomic mass units ($u$) to kilograms ($\\mathrm{kg}$).\n2. Construct the $2 \\times 2$ matrix $H'_{\\mathrm{sym}}$.\n3. Solve for its two eigenvalues and eigenvectors.\n4. For each of the two resulting modes, calculate $\\tilde{\\nu}_j$, $S_j$, and $P_{H,j}$.\n5. Identify the mode with the maximum $S_j$ value as the most Raman-active mode, denoted by the subscript $\\star$.\n6. Report $\\tilde{\\nu}_{\\star}$ and $P_{H,\\star}$, rounded as specified.\n\nThis procedure is repeated for the three given hydrogen-isotope masses. The final results are aggregated into a single list.\nAll constants must be in SI units for the calculation of frequencies, with $c$ in $\\mathrm{cm/s}$ for the final conversion to wavenumbers.\n- $k_{\\mathrm{CR}} = 100\\,\\mathrm{N/m}$, $k_{\\mathrm{CH}} = 500\\,\\mathrm{N/m}$.\n- $m_{\\mathrm{C}} = 12.011 \\times 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$.\n- $m_{\\mathrm{H}}$ is case-dependent from the test suite.\n- $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}$.\n- $\\beta = 1.0$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the most Raman-active mode's wavenumber and hydrogen-participation\n    ratio for three benzene isotopologues based on a simplified harmonic model.\n    \"\"\"\n    \n    # Define physical constants\n    U_TO_KG = 1.66053906660e-27  # Unified atomic mass unit to kg\n    C_CMS = 2.99792458e10         # Speed of light in cm/s\n\n    # Define model parameters\n    K_CH = 500.0   # N/m\n    K_CR = 100.0   # N/m\n    BETA = 1.0     # Arbitrary units/m\n    N_SITES = 6    # Number of C-H sites\n\n    # Mass of Carbon\n    mC_u = 12.011\n    mC_kg = mC_u * U_TO_KG\n\n    # Test cases for hydrogen isotope masses\n    test_cases = [\n        1.00784,  # Case 1: Hydrogen (H)\n        2.01410,  # Case 2: Deuterium (D)\n        3.01605,  # Case 3: Tritium (T)\n    ]\n\n    results = []\n\n    for mH_u in test_cases:\n        mH_kg = mH_u * U_TO_KG\n\n        # Due to C6 symmetry, the Raman-active modes must be totally symmetric.\n        # This reduces the 12x12 eigenvalue problem to a 2x2 problem for the\n        # totally symmetric modes.\n\n        # Construct the 2x2 symmetric mass-weighted Hessian for the A-type modes.\n        # H_sym_prime = [[(k_CR+k_CH)/m_C, -k_CH/sqrt(m_C*m_H)],\n        #                [-k_CH/sqrt(m_C*m_H), k_CH/m_H]]\n        \n        H_sym_prime = np.zeros((2, 2))\n        H_sym_prime[0, 0] = (K_CR + K_CH) / mC_kg\n        H_sym_prime[1, 1] = K_CH / mH_kg\n        H_sym_prime[0, 1] = -K_CH / np.sqrt(mC_kg * mH_kg)\n        H_sym_prime[1, 0] = H_sym_prime[0, 1]\n\n        # Solve the 2x2 eigenvalue problem\n        # lambdas are eigenvalues (omega^2), e_vecs are normalized eigenvectors\n        lambdas, e_vecs = np.linalg.eigh(H_sym_prime)\n\n        mode_data = []\n        for j in range(2):\n            lambda_j = lambdas[j]\n            # Eigenvalues of a positive-semidefinite matrix should be non-negative\n            if lambda_j  0: lambda_j = 0\n            \n            omega_j = np.sqrt(lambda_j)\n            nu_tilde_j = omega_j / (2 * np.pi * C_CMS)\n            \n            e_vec = e_vecs[:, j]\n            e_C, e_H = e_vec[0], e_vec[1]\n            \n            # Calculate physical displacement amplitudes\n            u_C = e_C / np.sqrt(mC_kg)\n            u_H = e_H / np.sqrt(mH_kg)\n\n            # Calculate Raman activity proxy\n            # S_j is proportional to (d(alpha)/dQ_j)^2\n            # For a totally symmetric mode, this simplifies.\n            # Factor of N_SITES^2 comes from summing over all sites.\n            S_j = (N_SITES * BETA * (u_H - u_C))**2\n            \n            # Calculate Hydrogen-participation ratio\n            # Denominator is sum of squares of all displacement components.\n            # Simplified for totally symmetric mode.\n            den_P_H = u_C**2 + u_H**2\n            if den_P_H > 0:\n                P_H_j = (u_H**2) / den_P_H\n            else:\n                P_H_j = 0.0\n\n            mode_data.append({'nu_tilde': nu_tilde_j, 'S': S_j, 'P_H': P_H_j})\n\n        # Find the most Raman-active mode (largest S_j)\n        most_active_mode = max(mode_data, key=lambda x: x['S'])\n        \n        nu_star = most_active_mode['nu_tilde']\n        P_H_star = most_active_mode['P_H']\n\n        # Append results with specified rounding\n        results.append(round(nu_star, 1))\n        results.append(round(P_H_star, 6))\n\n    # Format the final output string\n    formatted_results = [f\"{val:.1f}\" if i % 2 == 0 else f\"{val:.6f}\" for i, val in enumerate(results)]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462254"}, {"introduction": "Real-world samples often contain a mixture of different molecular shapes (conformers), especially for flexible molecules. This exercise explores this complexity by modeling the Raman spectrum of 1,2-dichloroethane, which exists in thermal equilibrium between its *anti* and *gauche* forms. You will apply Boltzmann statistics to determine the temperature-dependent population of each conformer and combine their individual spectra to simulate the experimentally observable result, demonstrating a powerful technique for analyzing flexible systems. [@problem_id:2462310]", "problem": "You will implement a first-principles simulation that computes and compares the relative Raman spectral intensity of the two conformers of 1,2-dichloroethane (anti and gauche) and predicts their relative populations at specified temperatures. Your program must be a complete, runnable program that derives the Raman activity from the polarizability derivative tensor, uses a physically motivated spectral lineshape, and applies Boltzmann statistics for populations.\n\nStart from these fundamental bases and well-tested facts:\n- The classical description of Raman scattering models the induced dipole moment as $\\boldsymbol{\\mu}_{\\mathrm{ind}} = \\boldsymbol{\\alpha} \\, \\mathbf{E}$, where $\\boldsymbol{\\alpha}$ is the molecular polarizability tensor and $\\mathbf{E}$ is the incident electric field.\n- For a small-amplitude normal mode $Q_k$ of angular frequency $\\omega_k$, the vibrational motion modulates the polarizability as $\\boldsymbol{\\alpha}(t) \\approx \\boldsymbol{\\alpha}_0 + \\left(\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial Q_k}\\right)_0 Q_k \\cos(\\omega_k t)$.\n- The time-dependent polarizability induces scattering at the Stokes-shifted frequency, with an intensity that depends on the derivatives of the polarizability tensor with respect to the normal coordinate after rotational averaging over all molecular orientations.\n- The equilibrium population of conformer $i$ at absolute temperature $T$ and energy $E_i$ with degeneracy $g_i$ obeys the Boltzmann distribution $p_i \\propto g_i \\exp\\!\\left(-\\frac{E_i}{R T}\\right)$, where $R$ is the universal gas constant.\n- A standard model for a spectral line is a Gaussian centered at the mode wavenumber $\\tilde{\\nu}_k$ with Full-Width at Half-Maximum (FWHM) $\\Gamma$, expressed in wavenumbers.\n\nFrom these bases, derive:\n1) An orientation-averaged expression for the Raman activity of a vibrational mode in terms of invariants of the polarizability-derivative tensor $\\left(\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial Q_k}\\right)$, using the isotropic part and the anisotropic part of the tensor. Express your final activity for each mode $k$ as a function of the tensor elements $\\alpha'_{xx}, \\alpha'_{yy}, \\alpha'_{zz}, \\alpha'_{xy}, \\alpha'_{xz}, \\alpha'_{yz}$, where $\\alpha'_{ij} \\equiv \\left(\\frac{\\partial \\alpha_{ij}}{\\partial Q_k}\\right)$.\n2) A Gaussian lineshape $L(\\tilde{\\nu}; \\tilde{\\nu}_k, \\Gamma)$ whose peak is $1$ at $\\tilde{\\nu}=\\tilde{\\nu}_k$ and whose FWHM is $\\Gamma$, suitable for summing “sticks” into a continuous spectrum.\n3) The normalized Boltzmann populations $p_i(T) = \\dfrac{g_i \\exp\\!\\left(-\\dfrac{E_i}{R T}\\right)}{\\sum_j g_j \\exp\\!\\left(-\\dfrac{E_j}{R T}\\right)}$ using energies in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, temperature in $\\mathrm{K}$, and $R$ in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nYou will then implement the following specific simulation and comparisons.\n\nData for conformers:\n- Energies (relative electronic energies at the same level of theory):\n  - anti: $E_{\\mathrm{anti}} = 0.00\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, degeneracy $g_{\\mathrm{anti}} = 1$.\n  - gauche: $E_{\\mathrm{gauche}} = 1.50\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, degeneracy $g_{\\mathrm{gauche}} = 2$.\n- Universal gas constant: $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nVibrational modes for each conformer (wavenumber in $\\mathrm{cm}^{-1}$, and symmetric polarizability-derivative tensor elements $\\alpha'_{ij}$ in arbitrary consistent units):\n\nanti conformer:\n- Mode A1: $\\tilde{\\nu} = 210$; matrix\n  $\\begin{bmatrix}\n  0.30  0.02  -0.01\\\\\n  0.02  0.20  0.00\\\\\n  -0.01  0.00  0.25\n  \\end{bmatrix}$\n- Mode A2: $\\tilde{\\nu} = 615$; matrix\n  $\\begin{bmatrix}\n  0.60  0.04  0.02\\\\\n  0.04  0.15  -0.01\\\\\n  0.02  -0.01  0.20\n  \\end{bmatrix}$\n- Mode A3: $\\tilde{\\nu} = 860$; matrix\n  $\\begin{bmatrix}\n  0.40  0.02  0.01\\\\\n  0.02  0.40  -0.01\\\\\n  0.01  -0.01  0.50\n  \\end{bmatrix}$\n\ngauche conformer:\n- Mode G1: $\\tilde{\\nu} = 180$; matrix\n  $\\begin{bmatrix}\n  0.25  -0.01  0.03\\\\\n  -0.01  0.28  0.02\\\\\n  0.03  0.02  0.20\n  \\end{bmatrix}$\n- Mode G2: $\\tilde{\\nu} = 595$; matrix\n  $\\begin{bmatrix}\n  0.30  0.12  0.06\\\\\n  0.12  0.35  -0.08\\\\\n  0.06  -0.08  0.29\n  \\end{bmatrix}$\n- Mode G3: $\\tilde{\\nu} = 845$; matrix\n  $\\begin{bmatrix}\n  0.45  0.05  0.01\\\\\n  0.05  0.33  -0.02\\\\\n  0.01  -0.02  0.40\n  \\end{bmatrix}$\n\nSimulation task:\n- For each conformer, compute the Raman activity for each mode from the tensor invariants you have derived.\n- Construct a simulated Raman spectrum as the sum over modes of population-weighted activities multiplied by the Gaussian lineshape centered at each mode wavenumber: for conformer $i$, $I_i(\\tilde{\\nu}) = p_i(T) \\sum_k S_{i,k} \\, L(\\tilde{\\nu}; \\tilde{\\nu}_{i,k}, \\Gamma)$, where $S_{i,k}$ is the Raman activity of mode $k$ of conformer $i$.\n- Compare the two spectra at a single probe wavenumber $\\tilde{\\nu}_{\\mathrm{probe}} = 600\\ \\mathrm{cm}^{-1}$ by reporting the ratio $I_{\\mathrm{anti}}(600) / I_{\\mathrm{gauche}}(600)$.\n- Predict the relative populations by reporting $p_{\\mathrm{anti}}(T)$.\n\nPhysical and numerical units:\n- Energies must be treated in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, temperatures in $\\mathrm{K}$, wavenumbers in $\\mathrm{cm}^{-1}$, and FWHM in $\\mathrm{cm}^{-1}$.\n- The reported population is a dimensionless fraction (express it as a decimal), and the intensity ratio is also dimensionless.\n\nTest suite:\nUse the following three test cases, each defined by a temperature $T$ and a Gaussian FWHM $\\Gamma$ (both in the units specified above):\n- Case 1: $T = 298.15$, $\\Gamma = 12$.\n- Case 2: $T = 150.00$, $\\Gamma = 12$.\n- Case 3: $T = 500.00$, $\\Gamma = 25$.\n\nRequired final output format:\n- Your program must produce a single line of output containing the results aggregated for all test cases as a flat comma-separated list enclosed in square brackets, in the order:\n  $[p_{\\mathrm{anti}}(T_1),\\, I_{\\mathrm{anti}}(600)/I_{\\mathrm{gauche}}(600)\\ \\text{at}\\ T_1,\\, p_{\\mathrm{anti}}(T_2),\\, I_{\\mathrm{anti}}(600)/I_{\\mathrm{gauche}}(600)\\ \\text{at}\\ T_2,\\, p_{\\mathrm{anti}}(T_3),\\, I_{\\mathrm{anti}}(600)/I_{\\mathrm{gauche}}(600)\\ \\text{at}\\ T_3]$.\n- Each number in the list must be formatted as a decimal rounded to six digits after the decimal point.\n- No additional text or lines should be printed.\n\nAngle units do not apply in this problem. Percentages must not be used; report fractions as decimals.", "solution": "The problem statement is scrutinized and found to be valid. It presents a well-posed, scientifically grounded problem in computational spectroscopy that is free from contradiction, ambiguity, or factual error. It provides all necessary physical constants, molecular data, and simulation parameters to compute a unique, verifiable result. We may therefore proceed with the derivation and solution.\n\nThe task is to simulate the Raman spectrum of the *anti* and *gauche* conformers of $1,2$-dichloroethane and to compare their relative contributions at different temperatures. This requires three distinct theoretical components: an expression for the Raman activity of a vibrational mode, a function to model the spectral lineshape, and a statistical mechanical model for the conformer populations.\n\nFirst, we derive the expression for the Raman activity, $S_k$, of a vibrational mode $k$. Raman scattering arises from the modulation of the molecular polarizability tensor, $\\boldsymbol{\\alpha}$, by the nuclear motion of a normal mode, $Q_k$. The intensity of the scattered light is dependent on the polarizability derivative tensor, $\\boldsymbol{\\alpha}'_k = \\left(\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial Q_k}\\right)_0$. For a molecule in a fluid phase, we must average over all possible orientations with respect to the incident electric field. This orientational averaging leads to an expression for the activity in terms of rotational invariants of the tensor $\\boldsymbol{\\alpha}'_k$.\n\nThe tensor $\\boldsymbol{\\alpha}'_k$ can be decomposed into an isotropic part and an anisotropic part. The two fundamental invariants are the mean polarizability derivative, $\\bar{\\alpha}'_k$, and the anisotropy of the polarizability derivative, $\\gamma_k'^2$.\n\nThe mean polarizability derivative, $\\bar{\\alpha}_k'$, is one-third of the trace of the tensor:\n$$\n\\bar{\\alpha}_k' = \\frac{1}{3} \\mathrm{Tr}(\\boldsymbol{\\alpha}'_k) = \\frac{1}{3} (\\alpha'_{xx} + \\alpha'_{yy} + \\alpha'_{zz})\n$$\nwhere $\\alpha'_{ii}$ are the diagonal elements of the tensor. This invariant governs the intensity of polarized Raman scattering.\n\nThe anisotropy invariant, $\\gamma_k'^2$, quantifies the deviation from spherical symmetry and is given by:\n$$\n\\gamma_k'^2 = \\frac{1}{2} \\left[ (\\alpha'_{xx} - \\alpha'_{yy})^2 + (\\alpha'_{yy} - \\alpha'_{zz})^2 + (\\alpha'_{zz} - \\alpha'_{xx})^2 + 6(\\alpha_{xy}'^2 + \\alpha_{xz}'^2 + \\alpha_{yz}'^2) \\right]\n$$\nwhere we have used the symmetric property of the tensor, $\\alpha'_{ij} = \\alpha'_{ji}$. This invariant is related to depolarized scattering.\n\nFor unpolarized incident light, the total Raman activity, $S_k$, is a weighted sum of the squares of these two invariants. The standard expression used in computational chemistry, which we adopt here, is:\n$$\nS_k = 45 (\\bar{\\alpha}_k')^2 + 7 \\gamma_k'^2\n$$\nThis formula provides a single scalar value representing the intrinsic Raman intensity of mode $k$, independent of molecular orientation. Any overall proportionality constants are omitted as they cancel when computing intensity ratios.\n\nSecond, we formulate the lineshape function. Each vibrational transition, represented as a \"stick\" at wavenumber $\\tilde{\\nu}_k$, is broadened into a continuous band. A Gaussian function is specified for this purpose. We require a function $L(\\tilde{\\nu}; \\tilde{\\nu}_k, \\Gamma)$ with its peak normalized to $1$ at $\\tilde{\\nu} = \\tilde{\\nu}_k$ and having a Full-Width at Half-Maximum (FWHM) of $\\Gamma$. The relationship between the FWHM $\\Gamma$ and the standard deviation $\\sigma$ of a Gaussian is $\\Gamma = 2\\sqrt{2\\ln(2)} \\sigma$. Rearranging gives $2\\sigma^2 = \\frac{\\Gamma^2}{4\\ln(2)}$. The lineshape function is thus:\n$$\nL(\\tilde{\\nu}; \\tilde{\\nu}_k, \\Gamma) = \\exp\\left(-\\frac{(\\tilde{\\nu} - \\tilde{\\nu}_k)^2}{2\\sigma^2}\\right) = \\exp\\left(-4 \\ln(2) \\frac{(\\tilde{\\nu} - \\tilde{\\nu}_k)^2}{\\Gamma^2}\\right)\n$$\n\nThird, we determine the relative populations of the two conformers using Boltzmann statistics. At thermal equilibrium at temperature $T$, the probability $p_i$ of finding a molecule in a state $i$ with energy $E_i$ and degeneracy $g_i$ is proportional to $g_i \\exp(-E_i / RT)$, where $R$ is the universal gas constant. For our two-conformer system (*anti* and *gauche*), the normalized population of the *anti* conformer is:\n$$\np_{\\mathrm{anti}}(T) = \\frac{g_{\\mathrm{anti}} \\exp\\left(-\\frac{E_{\\mathrm{anti}}}{RT}\\right)}{g_{\\mathrm{anti}} \\exp\\left(-\\frac{E_{\\mathrm{anti}}}{RT}\\right) + g_{\\mathrm{gauche}} \\exp\\left(-\\frac{E_{\\mathrm{gauche}}}{RT}\\right)}\n$$\nUsing the provided data, $E_{\\mathrm{anti}} = 0.00\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ and $g_{\\mathrm{anti}} = 1$, the expression simplifies to:\n$$\np_{\\mathrm{anti}}(T) = \\frac{1}{1 + g_{\\mathrm{gauche}} \\exp\\left(-\\frac{E_{\\mathrm{gauche}} - E_{\\mathrm{anti}}}{RT}\\right)} = \\frac{1}{1 + 2 \\exp\\left(-\\frac{1.50}{RT}\\right)}\n$$\nand the population of the *gauche* conformer is $p_{\\mathrm{gauche}}(T) = 1 - p_{\\mathrm{anti}}(T)$.\n\nFinally, we construct the total simulated Raman spectrum. The spectrum is the sum of contributions from both conformers, weighted by their respective populations. For a given conformer $i$, its contribution to the total intensity at wavenumber $\\tilde{\\nu}$ is the sum over all its vibrational modes $k$:\n$$\nI_i(\\tilde{\\nu}) = p_i(T) \\sum_k S_{i,k} L(\\tilde{\\nu}; \\tilde{\\nu}_{i,k}, \\Gamma)\n$$\nwhere $S_{i,k}$ is the Raman activity of mode $k$ of conformer $i$. The problem asks for the ratio of intensities from each conformer at a specific probe wavenumber, $\\tilde{\\nu}_{\\mathrm{probe}} = 600\\ \\mathrm{cm}^{-1}$. This ratio is:\n$$\n\\frac{I_{\\mathrm{anti}}(\\tilde{\\nu}_{\\mathrm{probe}})}{I_{\\mathrm{gauche}}(\\tilde{\\nu}_{\\mathrm{probe}})} = \\frac{p_{\\mathrm{anti}}(T) \\sum_k S_{\\mathrm{anti},k} L(\\tilde{\\nu}_{\\mathrm{probe}}; \\tilde{\\nu}_{\\mathrm{anti},k}, \\Gamma)}{p_{\\mathrm{gauche}}(T) \\sum_k S_{\\mathrm{gauche},k} L(\\tilde{\\nu}_{\\mathrm{probe}}; \\tilde{\\nu}_{\\mathrm{gauche},k}, \\Gamma)}\n$$\nThe implementation will follow these derived formulae to process the given data and test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares the relative Raman spectral intensity of the two\n    conformers of 1,2-dichloroethane (anti and gauche) and predicts their\n    relative populations at specified temperatures.\n    \"\"\"\n\n    # --- Givens and Constants ---\n    # Universal gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    # Conformer energy and degeneracy data\n    # Anti conformer\n    E_anti = 0.00  # kJ/mol\n    g_anti = 1.0\n    # Gauche conformer\n    E_gauche = 1.50  # kJ/mol\n    g_gauche = 2.0\n\n    # Probe wavenumber for intensity comparison\n    nu_probe = 600.0  # cm^-1\n\n    # Vibrational modes data for each conformer\n    # Format: (wavenumber [cm^-1], polarizability derivative tensor)\n    anti_modes = [\n        (210.0, np.array([[0.30, 0.02, -0.01], [0.02, 0.20, 0.00], [-0.01, 0.00, 0.25]])),\n        (615.0, np.array([[0.60, 0.04, 0.02], [0.04, 0.15, -0.01], [0.02, -0.01, 0.20]])),\n        (860.0, np.array([[0.40, 0.02, 0.01], [0.02, 0.40, -0.01], [0.01, -0.01, 0.50]]))\n    ]\n\n    gauche_modes = [\n        (180.0, np.array([[0.25, -0.01, 0.03], [-0.01, 0.28, 0.02], [0.03, 0.02, 0.20]])),\n        (595.0, np.array([[0.30, 0.12, 0.06], [0.12, 0.35, -0.08], [0.06, -0.08, 0.29]])),\n        (845.0, np.array([[0.45, 0.05, 0.01], [0.05, 0.33, -0.02], [0.01, -0.02, 0.40]]))\n    ]\n\n    # Test cases: (Temperature [K], FWHM [cm^-1])\n    test_cases = [\n        (298.15, 12.0),\n        (150.00, 12.0),\n        (500.00, 25.0),\n    ]\n\n    # --- Helper Functions based on Derived Formulae ---\n\n    def calculate_raman_activity(a_prime: np.ndarray) -> float:\n        \"\"\"\n        Calculates Raman activity from the polarizability derivative tensor.\n        S_k = 45 * (alpha_bar')^2 + 7 * (gamma')^2\n        \"\"\"\n        # Mean polarizability derivative (isotropic invariant)\n        alpha_bar_prime = (1.0 / 3.0) * np.trace(a_prime)\n\n        # Anisotropy invariant squared\n        # The tensor is symmetric, so a_prime[i, j] == a_prime[j, i]\n        ap_xx, ap_yy, ap_zz = a_prime[0, 0], a_prime[1, 1], a_prime[2, 2]\n        ap_xy, ap_xz, ap_yz = a_prime[0, 1], a_prime[0, 2], a_prime[1, 2]\n        \n        gamma_prime_sq = 0.5 * (\n            (ap_xx - ap_yy)**2 +\n            (ap_yy - ap_zz)**2 +\n            (ap_zz - ap_xx)**2 +\n            6 * (ap_xy**2 + ap_xz**2 + ap_yz**2)\n        )\n\n        return 45.0 * alpha_bar_prime**2 + 7.0 * gamma_prime_sq\n\n    def gaussian_lineshape(nu: float, nu_k: float, gamma: float) -> float:\n        \"\"\"\n        Calculates the value of a Gaussian lineshape function.\n        Peak is 1, FWHM is gamma.\n        \"\"\"\n        # Pre-compute constant factor to avoid recalculation\n        c = 4.0 * np.log(2.0)\n        return np.exp(-c * ((nu - nu_k) / gamma)**2)\n\n    def calculate_populations(T: float) -> tuple[float, float]:\n        \"\"\"\n        Calculates the Boltzmann populations for the anti and gauche conformers.\n        \"\"\"\n        # The energy of the anti conformer is the zero reference (E_anti = 0)\n        boltzmann_factor = np.exp(-(E_gauche - E_anti) / (R * T))\n        denominator = g_anti + g_gauche * boltzmann_factor\n        \n        p_anti = g_anti / denominator\n        p_gauche = (g_gauche * boltzmann_factor) / denominator\n        \n        return p_anti, p_gauche\n\n    # --- Main Simulation Loop ---\n    \n    results = []\n    for T, gamma in test_cases:\n        # 1. Calculate conformer populations at temperature T\n        p_anti, p_gauche = calculate_populations(T)\n\n        # 2. Calculate total intensity for the anti conformer\n        intensity_anti = 0.0\n        for nu_k, a_prime in anti_modes:\n            S_k = calculate_raman_activity(a_prime)\n            L_k = gaussian_lineshape(nu_probe, nu_k, gamma)\n            intensity_anti += S_k * L_k\n        \n        # 3. Calculate total intensity for the gauche conformer\n        intensity_gauche = 0.0\n        for nu_k, a_prime in gauche_modes:\n            S_k = calculate_raman_activity(a_prime)\n            L_k = gaussian_lineshape(nu_probe, nu_k, gamma)\n            intensity_gauche += S_k * L_k\n        \n        # 4. Calculate the final population-weighted intensity ratio\n        # I_total = p_anti * I_anti_sum + p_gauche * I_gauche_sum.\n        # Here we compare the two terms at nu_probe.\n        I_anti_at_probe = p_anti * intensity_anti\n        I_gauche_at_probe = p_gauche * intensity_gauche\n        \n        ratio = I_anti_at_probe / I_gauche_at_probe if I_gauche_at_probe != 0 else np.inf\n\n        # 5. Store results for this test case\n        results.append(p_anti)\n        results.append(ratio)\n\n    # --- Final Output ---\n    # Format the results to six decimal places and print in the required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "2462310"}]}