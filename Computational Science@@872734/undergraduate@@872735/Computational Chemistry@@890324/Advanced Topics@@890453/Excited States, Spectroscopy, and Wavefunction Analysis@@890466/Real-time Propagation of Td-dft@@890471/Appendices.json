{"hands_on_practices": [{"introduction": "Before diving into complex numerical propagations, it is essential to grasp the underlying physics of time evolution. This first practice focuses on the quantum mechanical principle of coherence, where a system exists in a superposition of multiple energy eigenstates. By analytically solving for the time-dependent expectation value of the dipole moment, you will see firsthand how this superposition leads to an observable oscillation at a frequency directly related to the energy difference between the states, a fundamental concept that underpins all forms of spectroscopy.", "problem": "You are given a minimal two-level representation of field-free real-time dynamics as encountered in Time-Dependent Density Functional Theory (TD-DFT). Consider a closed system restricted to the two Kohn-Sham (KS) eigenstates, the ground state $\\lvert 0 \\rangle$ with energy $E_0$ and the first excited state $\\lvert 1 \\rangle$ with energy $E_1$. The system is initialized at time $t=0$ in a normalized superposition\n$$\\lvert \\psi(0) \\rangle = c_0 \\lvert 0 \\rangle + c_1 e^{i \\phi} \\lvert 1 \\rangle,$$\nwith $c_0 \\ge 0$, $c_1 \\ge 0$, $c_0^2 + c_1^2 = 1$, and relative phase $\\phi$. There is no external field at any time. Assume the electric dipole operator along the $x$-axis, $\\hat{\\mu}_x$, has real matrix elements in this basis: $\\mu_{00} = \\langle 0 \\lvert \\hat{\\mu}_x \\rvert 0 \\rangle$, $\\mu_{11} = \\langle 1 \\lvert \\hat{\\mu}_x \\rvert 1 \\rangle$, and $\\mu_{01} = \\mu_{10} = \\langle 0 \\lvert \\hat{\\mu}_x \\rvert 1 \\rangle \\in \\mathbb{R}$. Units: use atomic units throughout, with energies in Hartree ($E_h$), time in atomic units of time ($\\hbar / E_h$), and dipole moments in $e a_0$. Angles are to be expressed in radians.\n\nTask: From first principles, determine the evolution of the state $\\lvert \\psi(t) \\rangle$ in the absence of an external field, and compute the time-dependent expectation value of the $x$-component of the dipole moment,\n$$\\mu_x(t) = \\langle \\psi(t) \\lvert \\hat{\\mu}_x \\rvert \\psi(t) \\rangle,$$\nat the specified sampling times for each parameter set in the following test suite. Report numerical values of $\\mu_x(t)$ in $e a_0$, rounded to six decimal places.\n\nTest suite (all quantities are given in atomic units):\n- Case A (general superposition with nonzero transition dipole): $E_0 = -0.5$, $E_1 = -0.125$, $c_0 = \\sqrt{0.8}$, $c_1 = \\sqrt{0.2}$, $\\phi = 0.3$, $\\mu_{00} = 0.0$, $\\mu_{11} = 1.0$, $\\mu_{01} = 0.5$, sampling times $[0.0,\\,5.0,\\,10.0,\\,15.0]$.\n- Case B (boundary: pure ground state, no coherence): $E_0 = -0.5$, $E_1 = -0.125$, $c_0 = 1.0$, $c_1 = 0.0$, $\\phi = 0.0$, $\\mu_{00} = 0.2$, $\\mu_{11} = 0.8$, $\\mu_{01} = 1.0$, sampling times $[0.0,\\,1.0,\\,2.0]$.\n- Case C (boundary: zero transition dipole, no oscillation): $E_0 = -1.0$, $E_1 = -0.9$, $c_0 = 1/\\sqrt{2}$, $c_1 = 1/\\sqrt{2}$, $\\phi = 0.7$, $\\mu_{00} = -0.3$, $\\mu_{11} = 0.4$, $\\mu_{01} = 0.0$, sampling times $[0.0,\\,20.0]$.\n- Case D (edge: degenerate levels, stationary phase difference): $E_0 = -0.2$, $E_1 = -0.2$, $c_0 = \\sqrt{0.3}$, $c_1 = \\sqrt{0.7}$, $\\phi = 1.0$, $\\mu_{00} = 0.0$, $\\mu_{11} = 0.0$, $\\mu_{01} = 1.2$, sampling times $[0.0,\\,3.0]$.\n\nRequired final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each case must contribute a list of the sampled $\\mu_x(t)$ values in order, so the overall output is a list of $4$ lists in the order A, B, C, D. For example, the printed line must look like\n$[ [a_1, a_2, \\dots], [b_1, b_2, \\dots], [c_1, c_2, \\dots], [d_1, d_2, \\dots] ]$\nbut with no spaces anywhere in the line. Each numeric entry must be rounded to six decimal places as specified.", "solution": "The problem statement submitted for analysis is scientifically grounded, well-posed, and objective. It provides a complete set of parameters and conditions necessary for a unique solution based on the fundamental principles of quantum mechanics. It is a standard exercise in the time evolution of a two-level quantum system. Therefore, we proceed with the solution.\n\nThe core of the problem is to determine the time evolution of a quantum state and then compute the expectation value of an observable. The system is unperturbed by any external field, so its dynamics are governed by the time-independent Schrödinger equation (in atomic units, where $\\hbar=1$).\n\nFirst, we define the state of the system. The basis is composed of two Kohn-Sham eigenstates, the ground state $\\lvert 0 \\rangle$ and the first excited state $\\lvert 1 \\rangle$. These are, by definition, eigenstates of the field-free Hamiltonian $\\hat{H}$:\n$$\n\\hat{H} \\lvert 0 \\rangle = E_0 \\lvert 0 \\rangle\n$$\n$$\n\\hat{H} \\lvert 1 \\rangle = E_1 \\lvert 1 \\rangle\n$$\nwhere $E_0$ and $E_1$ are the corresponding eigenenergies. In this basis, the Hamiltonian operator is represented by a diagonal matrix:\n$$\n\\mathbf{H} = \\begin{pmatrix} E_0 & 0 \\\\ 0 & E_1 \\end{pmatrix}\n$$\nThe system is initialized at time $t=0$ in a superposition state:\n$$\n\\lvert \\psi(0) \\rangle = c_0 \\lvert 0 \\rangle + c_1 e^{i \\phi} \\lvert 1 \\rangle\n$$\nThe time evolution of this state is found by applying the time evolution operator, $U(t) = e^{-i\\hat{H}t}$. Since $\\lvert 0 \\rangle$ and $\\lvert 1 \\rangle$ are eigenstates of $\\hat{H}$, the action of $U(t)$ is straightforward:\n$$\n\\lvert \\psi(t) \\rangle = e^{-i\\hat{H}t} \\lvert \\psi(0) \\rangle = e^{-i\\hat{H}t} (c_0 \\lvert 0 \\rangle + c_1 e^{i \\phi} \\lvert 1 \\rangle)\n$$\n$$\n\\lvert \\psi(t) \\rangle = c_0 (e^{-i\\hat{H}t} \\lvert 0 \\rangle) + c_1 e^{i \\phi} (e^{-i\\hat{H}t} \\lvert 1 \\rangle)\n$$\n$$\n\\lvert \\psi(t) \\rangle = c_0 e^{-iE_0t} \\lvert 0 \\rangle + c_1 e^{i \\phi} e^{-iE_1t} \\lvert 1 \\rangle\n$$\nThis gives the state vector at any time $t>0$:\n$$\n\\lvert \\psi(t) \\rangle = c_0 e^{-iE_0t} \\lvert 0 \\rangle + c_1 e^{-i(E_1t - \\phi)} \\lvert 1 \\rangle\n$$\nNext, we must compute the time-dependent expectation value of the dipole operator, $\\mu_x(t) = \\langle \\psi(t) \\lvert \\hat{\\mu}_x \\rvert \\psi(t) \\rangle$. The corresponding bra vector is:\n$$\n\\langle \\psi(t) \\rvert = c_0 e^{iE_0t} \\langle 0 \\rvert + c_1 e^{i(E_1t - \\phi)} \\langle 1 \\rvert\n$$\nWe substitute $\\lvert \\psi(t) \\rangle$ and $\\langle \\psi(t) \\rvert$ into the expectation value expression:\n$$\n\\mu_x(t) = \\left( c_0 e^{iE_0t} \\langle 0 \\rvert + c_1 e^{i(E_1t - \\phi)} \\langle 1 \\rvert \\right) \\hat{\\mu}_x \\left( c_0 e^{-iE_0t} \\lvert 0 \\rangle + c_1 e^{-i(E_1t - \\phi)} \\lvert 1 \\rangle \\right)\n$$\nExpanding this expression yields four terms. We use the notation $\\mu_{ij} = \\langle i \\lvert \\hat{\\mu}_x \\rvert j \\rangle$ for the matrix elements of the dipole operator.\n$$\n\\mu_x(t) = c_0^2 e^{iE_0t} e^{-iE_0t} \\langle 0 \\lvert \\hat{\\mu}_x \\rvert 0 \\rangle + c_0 c_1 e^{iE_0t} e^{-i(E_1t - \\phi)} \\langle 0 \\lvert \\hat{\\mu}_x \\rvert 1 \\rangle + c_1 c_0 e^{i(E_1t - \\phi)} e^{-iE_0t} \\langle 1 \\lvert \\hat{\\mu}_x \\rvert 0 \\rangle + c_1^2 e^{i(E_1t - \\phi)} e^{-i(E_1t - \\phi)} \\langle 1 \\lvert \\hat{\\mu}_x \\rvert 1 \\rangle\n$$\nSimplifying the exponential terms and using the dipole matrix element notation:\n$$\n\\mu_x(t) = c_0^2 \\mu_{00} + c_1^2 \\mu_{11} + c_0 c_1 e^{i(E_0 - E_1)t + i\\phi} \\mu_{01} + c_1 c_0 e^{i(E_1 - E_0)t - i\\phi} \\mu_{10}\n$$\nThe dipole operator $\\hat{\\mu}_x$ is an observable and therefore Hermitian, so $\\mu_{10} = \\mu_{01}^*$. The problem states that $\\mu_{01}$ is real, thus $\\mu_{10} = \\mu_{01}$. Let us define the transition frequency $\\omega_{10} = E_1 - E_0$. The expression becomes:\n$$\n\\mu_x(t) = c_0^2 \\mu_{00} + c_1^2 \\mu_{11} + c_0 c_1 \\mu_{01} \\left( e^{-i( \\omega_{10} t - \\phi )} + e^{i( \\omega_{10} t - \\phi )} \\right)\n$$\nUsing Euler's identity, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we arrive at the final analytical expression for the time-dependent dipole moment:\n$$\n\\mu_x(t) = c_0^2 \\mu_{00} + c_1^2 \\mu_{11} + 2 c_0 c_1 \\mu_{01} \\cos(\\omega_{10} t - \\phi)\n$$\nThis equation reveals that the dipole moment consists of a static component, which is the weighted average of the permanent dipole moments of the basis states, and a dynamic component that oscillates at the frequency corresponding to the energy difference between the two states. The amplitude of this oscillation is proportional to the product of the coefficients $c_0, c_1$ and the transition dipole moment $\\mu_{01}$. If any of these three quantities ($c_0, c_1, \\mu_{01}$) are zero, or if the states are degenerate ($\\omega_{10}=0$), the oscillation vanishes or becomes a static offset.\n\nThis derived formula will be applied to each test case to compute the required numerical values.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the time-dependent expectation value of the dipole moment\n    for a two-level quantum system based on a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: general superposition with nonzero transition dipole\n        {\n            \"E0\": -0.5, \"E1\": -0.125, \"c0\": np.sqrt(0.8), \"c1\": np.sqrt(0.2), \"phi\": 0.3,\n            \"mu00\": 0.0, \"mu11\": 1.0, \"mu01\": 0.5, \"times\": [0.0, 5.0, 10.0, 15.0]\n        },\n        # Case B: boundary: pure ground state, no coherence\n        {\n            \"E0\": -0.5, \"E1\": -0.125, \"c0\": 1.0, \"c1\": 0.0, \"phi\": 0.0,\n            \"mu00\": 0.2, \"mu11\": 0.8, \"mu01\": 1.0, \"times\": [0.0, 1.0, 2.0]\n        },\n        # Case C: boundary: zero transition dipole, no oscillation\n        {\n            \"E0\": -1.0, \"E1\": -0.9, \"c0\": 1/np.sqrt(2), \"c1\": 1/np.sqrt(2), \"phi\": 0.7,\n            \"mu00\": -0.3, \"mu11\": 0.4, \"mu01\": 0.0, \"times\": [0.0, 20.0]\n        },\n        # Case D: edge: degenerate levels, stationary phase difference\n        {\n            \"E0\": -0.2, \"E1\": -0.2, \"c0\": np.sqrt(0.3), \"c1\": np.sqrt(0.7), \"phi\": 1.0,\n            \"mu00\": 0.0, \"mu11\": 0.0, \"mu01\": 1.2, \"times\": [0.0, 3.0]\n        }\n    ]\n\n    all_results = []\n    \n    # The analytical formula for the time-dependent dipole moment is:\n    # mu_x(t) = c0^2*mu00 + c1^2*mu11 + 2*c0*c1*mu01*cos(omega10*t - phi)\n    # where omega10 = E1 - E0.\n\n    for case in test_cases:\n        E0 = case[\"E0\"]\n        E1 = case[\"E1\"]\n        c0 = case[\"c0\"]\n        c1 = case[\"c1\"]\n        phi = case[\"phi\"]\n        mu00 = case[\"mu00\"]\n        mu11 = case[\"mu11\"]\n        mu01 = case[\"mu01\"]\n        times = case[\"times\"]\n\n        omega10 = E1 - E0\n        \n        # Static part of the dipole moment\n        static_part = c0**2 * mu00 + c1**2 * mu11\n        \n        # Amplitude of the oscillating part\n        osc_amplitude = 2 * c0 * c1 * mu01\n        \n        case_results = []\n        for t in times:\n            # Dynamic part calculation\n            dynamic_part = osc_amplitude * np.cos(omega10 * t - phi)\n            \n            # Total dipole moment at time t\n            mu_t = static_part + dynamic_part\n            \n            # Append rounded result\n            case_results.append(mu_t)\n\n        all_results.append(case_results)\n\n    # Format the final output string as per the requirements:\n    # A list of lists, with no spaces, and numbers rounded to six decimal places.\n    case_strings = []\n    for case_result in all_results:\n        # Format each number to 6 decimal places and join with commas\n        num_strings = [f\"{val:.6f}\" for val in case_result]\n        case_strings.append(f\"[{','.join(num_strings)}]\")\n    \n    # Join the case strings into the final output format\n    final_output_str = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2461440"}, {"introduction": "While analytical solutions provide deep insight, simulating complex, realistic molecules requires numerical integration of the time-dependent Kohn-Sham equations. This exercise serves as a crucial, hands-on introduction to the challenges of numerical propagation. You will implement the simple forward Euler method and discover its inherent flaw: its failure to conserve energy, which is a manifestation of its non-unitary nature. This practice concretely demonstrates why the choice of a stable and accurate numerical integrator is paramount for reliable real-time simulations.", "problem": "You are to model the real-time propagation of a single occupied Kohn–Sham orbital in a two-level basis using the time-dependent Kohn–Sham equation in atomic units, which reduces to the time-dependent Schrödinger equation $i \\, \\partial_t \\vert \\psi(t) \\rangle = \\hat{H} \\vert \\psi(t) \\rangle$ with a time-independent $2 \\times 2$ Hermitian Hamiltonian. Consider the Hamiltonian (in Hartree) given by\n$$\n\\hat{H} \\equiv H =\n\\begin{pmatrix}\n\\varepsilon_1 & V \\\\\nV & \\varepsilon_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0.0 & 0.1 \\\\\n0.1 & 0.5\n\\end{pmatrix},\n$$\nwith $\\hbar = 1$ (atomic units). The initial state at $t = 0$ is the normalized vector\n$$\n\\vert \\psi(0) \\rangle = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1 \\\\\n1\n\\end{pmatrix}.\n$$\nLet the total propagation time be $T = 20.0$ (in atomic units of time). Use the explicit forward Euler update to approximate the evolution,\n$$\n\\vert \\psi_{n+1} \\rangle = \\vert \\psi_n \\rangle - i \\, \\Delta t \\, H \\, \\vert \\psi_n \\rangle,\n$$\nfor $n = 0,1,\\dots,N-1$ with $N = T / \\Delta t$, and do not renormalize during propagation. Define the instantaneous energy expectation at discrete time $t_n = n \\, \\Delta t$ by the Rayleigh quotient\n$$\nE_n = \\frac{\\langle \\psi_n \\vert H \\vert \\psi_n \\rangle}{\\langle \\psi_n \\vert \\psi_n \\rangle}.\n$$\nFor each specified time step $\\Delta t$, compute the energy drift $\\Delta E = E_N - E_0$.\n\nYour program must implement the above model exactly as stated and produce the energy drift for each of the following test cases (these constitute the required test suite), using the same Hamiltonian, initial state, and total time $T$ given above:\n- $\\Delta t = 0.01$,\n- $\\Delta t = 0.05$,\n- $\\Delta t = 0.20$,\n- $\\Delta t = 0.50$.\n\nAll time quantities are in atomic units, and energies must be expressed in Hartree. Report each energy drift $\\Delta E$ in Hartree as a float rounded to six decimal places.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases (e.g., $[x_1,x_2,x_3,x_4]$), where each $x_k$ is the rounded energy drift for the corresponding $\\Delta t$ specified above.", "solution": "The problem requires the simulation of the quantum dynamics of a single occupied orbital in a two-level system. This is governed by the time-dependent Schrödinger equation (TDSE), which is the specified form of the time-dependent Kohn-Sham equation for this model system. The governing equation in atomic units ($\\hbar=1$) is:\n$$\ni \\frac{\\partial}{\\partial t} \\vert \\psi(t) \\rangle = \\hat{H} \\vert \\psi(t) \\rangle\n$$\nThe system is defined by a time-independent $2 \\times 2$ Hermitian Hamiltonian, given in units of Hartree as:\n$$\nH =\n\\begin{pmatrix}\n0.0 & 0.1 \\\\\n0.1 & 0.5\n\\end{pmatrix}\n$$\nThe initial state of the system at time $t=0$ is a normalized superposition of the two basis states:\n$$\n\\vert \\psi(0) \\rangle = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1 \\\\\n1\n\\end{pmatrix}\n$$\nThe propagation is to be carried out for a total time of $T = 20.0$ atomic units.\n\nThe numerical integration of the TDSE is prescribed to use the explicit forward Euler method. Discretizing time into steps of size $\\Delta t$, with $t_n = n \\Delta t$, the state vector at step $n+1$ is approximated from the state at step $n$ by:\n$$\n\\vert \\psi_{n+1} \\rangle = \\vert \\psi_n \\rangle - i \\Delta t H \\vert \\psi_n \\rangle = (I - i \\Delta t H) \\vert \\psi_n \\rangle\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix. This defines the propagation algorithm.\n\nA critical property of the exact evolution operator, $U(t, t_0) = e^{-iH(t-t_0)}$, is that it is unitary, which guarantees the conservation of the norm of the state vector, i.e., $\\langle \\psi(t) \\vert \\psi(t) \\rangle = \\text{constant}$. The forward Euler propagation operator, $\\hat{P}_{\\text{Euler}} = (I - i \\Delta t H)$, is not unitary. Its adjoint is $\\hat{P}_{\\text{Euler}}^\\dagger = (I + i \\Delta t H^\\dagger)$. Since $H$ is Hermitian ($H=H^\\dagger$), we have:\n$$\n\\hat{P}_{\\text{Euler}}^\\dagger \\hat{P}_{\\text{Euler}} = (I + i \\Delta t H)(I - i \\Delta t H) = I - i \\Delta t H + i \\Delta t H + (\\Delta t)^2 H^2 = I + (\\Delta t)^2 H^2\n$$\nThe norm at step $n+1$ is thus related to the norm at step $n$ by:\n$$\n\\langle \\psi_{n+1} \\vert \\psi_{n+1} \\rangle = \\langle \\psi_n \\vert \\hat{P}_{\\text{Euler}}^\\dagger \\hat{P}_{\\text{Euler}} \\vert \\psi_n \\rangle = \\langle \\psi_n \\vert (I + (\\Delta t)^2 H^2) \\vert \\psi_n \\rangle = \\langle \\psi_n \\vert \\psi_n \\rangle + (\\Delta t)^2 \\langle \\psi_n \\vert H^2 \\vert \\psi_n \\rangle\n$$\nSince $\\langle \\psi_n \\vert H^2 \\vert \\psi_n \\rangle \\ge 0$, the norm of the state vector will monotonically increase at every step, a hallmark of the unconditional instability of the forward Euler method for the TDSE. The problem correctly instructs not to renormalize the state vector during propagation.\n\nFor a time-independent Hamiltonian, the exact energy of the system is a conserved quantity. The numerical energy at step $n$, however, will deviate due to the approximations in the integrator. As the state vector is not normalized, the energy expectation value must be calculated using the Rayleigh quotient:\n$$\nE_n = \\frac{\\langle \\psi_n \\vert H \\vert \\psi_n \\rangle}{\\langle \\psi_n \\vert \\psi_n \\rangle}\n$$\nThe objective is to compute the total energy drift, $\\Delta E = E_N - E_0$, where $N = T/\\Delta t$ is the total number of steps. This quantity serves as a measure of the numerical error in energy conservation for the specified integrator and time step $\\Delta t$.\n\nFirst, we calculate the initial energy $E_0$ at $t_0=0$. Given that $\\vert \\psi_0 \\rangle = \\vert \\psi(0) \\rangle$ is normalized, $\\langle \\psi_0 \\vert \\psi_0 \\rangle = 1$. The calculation is:\n$$\nH \\vert \\psi_0 \\rangle = \\begin{pmatrix} 0.0 & 0.1 \\\\ 0.1 & 0.5 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0.1 \\\\ 0.6 \\end{pmatrix}\n$$\n$$\nE_0 = \\frac{\\langle \\psi_0 \\vert H \\vert \\psi_0 \\rangle}{\\langle \\psi_0 \\vert \\psi_0 \\rangle} = \\langle \\psi_0 \\vert H \\vert \\psi_0 \\rangle = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0.1 \\\\ 0.6 \\end{pmatrix} \\right) = \\frac{1}{2}(0.1 + 0.6) = 0.35 \\text{ Hartree}\n$$\nThe value of $E_0$ is constant for all test cases.\n\nThe algorithm proceeds as follows for each given time step $\\Delta t$:\n1.  Initialize the state vector $\\vert \\psi \\rangle \\leftarrow \\vert \\psi_0 \\rangle$.\n2.  Calculate the number of propagation steps $N = \\text{int}(T / \\Delta t)$.\n3.  Loop $N$ times, from $n=0$ to $N-1$:\n    a. Update the state vector: $\\vert \\psi \\rangle \\leftarrow (I - i \\Delta t H) \\vert \\psi \\rangle$.\n4.  After the loop, the final state is $\\vert \\psi_N \\rangle$. Calculate the final energy $E_N$ using the Rayleigh quotient:\n    $$\n    E_N = \\frac{\\langle \\psi_N \\vert H \\vert \\psi_N \\rangle}{\\langle \\psi_N \\vert \\psi_N \\rangle}\n    $$\n5.  Compute the energy drift $\\Delta E = E_N - E_0$.\n6.  Round the result to six decimal places as required.\n\nThis procedure will be implemented for each specified value of $\\Delta t \\in \\{0.01, 0.05, 0.20, 0.50\\}$, and the resulting energy drifts will be reported.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the energy drift in a real-time propagation of a two-level\n    quantum system using the forward Euler method.\n    \"\"\"\n    # Define the Hamiltonian matrix (in Hartree)\n    H = np.array([\n        [0.0, 0.1],\n        [0.1, 0.5]\n    ], dtype=np.float64)\n\n    # Define the initial state vector at t=0 (normalized)\n    psi0 = np.array([1.0, 1.0], dtype=np.complex128) / np.sqrt(2)\n\n    # Define the total propagation time T (in atomic units)\n    T = 20.0\n\n    # Define the test cases for the time step dt\n    test_cases_dt = [0.01, 0.05, 0.20, 0.50]\n\n    # Calculate the initial energy E_0\n    # Since psi0 is normalized, the denominator <psi0|psi0> is 1.\n    # np.vdot(a, b) computes a.conj().T @ b which is <a|b>.\n    E0 = np.vdot(psi0, H @ psi0).real\n\n    results = []\n    \n    # Iterate through each test case\n    for dt in test_cases_dt:\n        # Determine the number of steps\n        # Given T/dt are all integers for the test cases\n        N = int(T / dt)\n\n        # Initialize the state vector for the current propagation\n        psi = np.copy(psi0)\n\n        # Pre-compute the forward Euler update operator for efficiency\n        I = np.identity(2, dtype=np.complex128)\n        update_operator = I - 1j * dt * H\n\n        # Propagate the state vector for N steps\n        for _ in range(N):\n            psi = update_operator @ psi\n        \n        # After propagation, psi is the final state psi_N.\n        # Calculate the final energy E_N using the Rayleigh quotient.\n        # The state is not normalized, so the full quotient is required.\n        numerator_EN = np.vdot(psi, H @ psi).real\n        denominator_EN = np.vdot(psi, psi).real\n        EN = numerator_EN / denominator_EN\n\n        # Calculate the energy drift\n        delta_E = EN - E0\n\n        # Round the result to six decimal places and store it\n        results.append(round(delta_E, 6))\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2461384"}, {"introduction": "This final practice integrates the physical principles and numerical considerations into a complete workflow that mirrors how response spectra are calculated in research. You will simulate a pump-probe experiment by applying an instantaneous \"quadrupole kick\" to excite a system, then track its evolution in time. By applying a Fourier transform to the resulting time-domain signal, you will generate a frequency-domain spectrum, effectively translating the system's time evolution into its characteristic resonant frequencies and revealing the power of rt-TD-DFT for computational spectroscopy.", "problem": "A single-electron, one-dimensional model for Time-Dependent Density Functional Theory (TD-DFT) real-time propagation is considered in atomic units. The Kohn–Sham Hamiltonian is taken to be the one-dimensional harmonic oscillator with an optional quartic anharmonicity, given by\n$$\n\\hat{H} = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2 + \\alpha \\hat{x}^4,\n$$\nwhere $\\omega \\gt 0$ is the oscillator frequency and $\\alpha \\ge 0$ controls the anharmonicity. At time $t=0$, the system is prepared in the ground state of the harmonic part (i.e., the exact ground state of $\\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2$), and an instantaneous quadrupole kick is applied via the unitary operator\n$$\n\\hat{U}_{\\mathrm{kick}} = \\exp\\!\\left(-i\\,\\kappa\\,\\hat{Q}\\right), \\quad \\hat{Q} \\equiv \\hat{x}^2,\n$$\nwith a small real kick strength $\\kappa$. After the kick, the state evolves under $\\hat{H}$ for times $t \\in [0,T]$. Let $\\langle \\hat{Q} \\rangle(t)$ denote the time-dependent expectation value of $\\hat{Q}$ during the field-free evolution. Define the windowed quadrupole response signal\n$$\ns(t) = \\left(\\langle \\hat{Q} \\rangle(t) - \\langle \\hat{Q} \\rangle(0)\\right)\\,e^{-\\gamma t},\n$$\nwhere $\\gamma \\gt 0$ is a small damping constant. The quadrupole response spectrum is the magnitude of the Fourier transform\n$$\nS(\\Omega) = \\left|\\int_0^T s(t)\\,e^{i \\Omega t}\\,dt\\right|,\n$$\nas a function of angular frequency $\\Omega$ (in atomic units). For each specified parameter set below, determine the dominant peak position\n$$\n\\Omega_{\\mathrm{peak}} = \\underset{\\Omega \\gt 0}{\\arg\\max}\\, S(\\Omega),\n$$\nexpressed in atomic units and rounded to three decimals.\n\nTime-Dependent Density Functional Theory (TD-DFT) is here modeled by a single Kohn–Sham orbital in an external potential; no exchange–correlation field is included. The quadrupole operator is taken as the one-dimensional component $\\hat{Q} = \\hat{x}^2$, corresponding to the $xx$-component of the quadrupole tensor in a one-dimensional reduction.\n\nYour task is to write a complete, runnable program that computes $\\Omega_{\\mathrm{peak}}$ for each of the following test cases. The program must implement first-principles real-time propagation consistent with the definitions above and produce the required spectral analysis. All physical quantities, including $\\omega$, $\\alpha$, $\\kappa$, $T$, $dt$, and $\\gamma$, are given in atomic units. Angles and frequencies must be treated in radians per unit time (atomic units). The final outputs must be in atomic units.\n\nTest Suite (each case specifies $(\\omega,\\alpha,\\kappa,N,T,dt,\\gamma)$, where $N$ is a truncation parameter for any chosen finite basis representation):\n- Case 1 (happy path): $(\\omega,\\alpha,\\kappa,N,T,dt,\\gamma) = (0.70,\\,0.00,\\,1.0\\times 10^{-3},\\,24,\\,800.0,\\,0.02,\\,0.002)$.\n- Case 2 (contrast frequency): $(\\omega,\\alpha,\\kappa,N,T,dt,\\gamma) = (1.10,\\,0.00,\\,1.0\\times 10^{-3},\\,24,\\,800.0,\\,0.02,\\,0.002)$.\n- Case 3 (anharmonic shift): $(\\omega,\\alpha,\\kappa,N,T,dt,\\gamma) = (0.70,\\,0.02,\\,1.0\\times 10^{-3},\\,36,\\,800.0,\\,0.02,\\,0.002)$.\n- Case 4 (weak-kick boundary): $(\\omega,\\alpha,\\kappa,N,T,dt,\\gamma) = (0.20,\\,0.00,\\,1.0\\times 10^{-6},\\,24,\\,800.0,\\,0.02,\\,0.002)$.\n\nRequirements:\n- Implement the field-free evolution after the kick exactly as defined. The initial state is the ground state of the harmonic part at frequency $\\omega$.\n- Compute the time series $\\langle \\hat{Q} \\rangle(t)$ on the uniform time grid $t = 0, dt, 2\\,dt, \\dots, T-dt$.\n- Use the definition of $S(\\Omega)$ above with the exponential window $e^{-\\gamma t}$.\n- Determine $\\Omega_{\\mathrm{peak}}$ as the maximizer of $S(\\Omega)$ over positive $\\Omega$ on the discrete frequency grid consistent with the chosen time discretization.\n- Express $\\Omega_{\\mathrm{peak}}$ for each case in atomic units, rounded to three decimals.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test cases, for example, $[x_1,x_2,x_3,x_4]$, where each $x_j$ is $\\Omega_{\\mathrm{peak}}$ rounded to three decimals (in atomic units).", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard problem in computational quantum dynamics, modeling the optical response of a single-electron system. All parameters and conditions are clearly defined, permitting a unique numerical solution. I will therefore proceed with a detailed solution based on first principles.\n\nThe task is to determine the dominant peak frequency, $\\Omega_{\\mathrm{peak}}$, in the quadrupole response spectrum of a one-dimensional quantum system. The solution requires simulating the system's time evolution according to the Schrödinger equation. A robust and accurate methodology involves representing the quantum state and operators within a suitable finite basis.\n\n**1. Basis Set Representation**\n\nThe full Hamiltonian is $\\hat{H} = \\hat{H}_0 + \\alpha \\hat{x}^4$, where $\\hat{H}_0 = \\frac{\\hat{p}^2}{2} + \\frac{1}{2}\\,\\omega^2 \\hat{x}^2$ is the harmonic oscillator Hamiltonian. The eigenstates of $\\hat{H}_0$, denoted as $|n\\rangle$ for $n=0, 1, 2, \\dots$, form a convenient and complete basis for this problem. They are the eigenfunctions of the quantum harmonic oscillator. We will work within a truncated basis of size $N$, $\\{|n\\rangle\\}_{n=0}^{N-1}$. Any state vector $|\\psi\\rangle$ is then represented by a column vector of coefficients $C$, where $C_n = \\langle n | \\psi \\rangle$.\n\n**2. Operator Matrices**\n\nTo perform calculations, we must construct the matrix representations of the relevant operators in this basis. The key operator is the position operator $\\hat{x}$. In atomic units ($m=1, \\hbar=1$), its matrix elements are given by:\n$$\n\\langle m | \\hat{x} | n \\rangle = \\sqrt{\\frac{1}{2\\omega}} \\left( \\sqrt{n+1} \\delta_{m, n+1} + \\sqrt{n} \\delta_{m, n-1} \\right)\n$$\nFrom this, we construct the matrix for the quadrupole operator $\\hat{Q} = \\hat{x}^2$. Its elements are:\n$$\nQ_{mn} = \\langle m | \\hat{x}^2 | n \\rangle = \\frac{1}{2\\omega} \\left[ \\sqrt{(n+1)(n+2)}\\delta_{m,n+2} + (2n+1)\\delta_{m,n} + \\sqrt{n(n-1)}\\delta_{m,n-2} \\right]\n$$\nThis results in a real, symmetric matrix, which we denote as $Q$. The matrix for the anharmonic potential term, $\\hat{x}^4$, is found by matrix multiplication: $X_4 = Q^2$.\n\nThe Hamiltonian matrix, $H$, is the sum of the harmonic part and the anharmonic part:\n$$\nH_{mn} = \\langle m | \\hat{H} | n \\rangle = \\langle m | \\hat{H}_0 | n \\rangle + \\alpha \\langle m | \\hat{x}^4 | n \\rangle\n$$\nThe harmonic part is diagonal in this basis, with elements $\\langle n | \\hat{H}_0 | n \\rangle = E_n = \\omega(n + 1/2)$. Thus, the full Hamiltonian matrix is:\n$$\nH = D_0 + \\alpha Q^2\n$$\nwhere $D_0$ is a diagonal matrix with entries $(D_0)_{nn} = \\omega(n + 1/2)$.\n\n**3. Initial State and Time Evolution**\n\nThe system starts in the ground state of the harmonic part, $|\\psi_{\\text{GS}}\\rangle = |0\\rangle$. In our truncated basis, this state is represented by the vector $C_{\\text{GS}} = [1, 0, \\dots, 0]^T$.\n\nAn instantaneous kick is applied, transforming the state to $|\\psi(0)\\rangle = \\hat{U}_{\\text{kick}} |\\psi_{\\text{GS}}\\rangle$. The initial state vector for the subsequent evolution is:\n$$\nC(0) = \\exp(-i\\kappa Q) C_{\\text{GS}}\n$$\nwhere $\\exp(\\cdot)$ denotes the matrix exponential.\n\nFor a time-independent Hamiltonian $\\hat{H}$, the state at time $t$ is $|\\psi(t)\\rangle = \\exp(-i\\hat{H}t)|\\psi(0)\\rangle$. The most accurate way to compute this evolution is by diagonalizing the Hamiltonian matrix $H$. Since $H$ is real and symmetric (Hermitian), it can be diagonalized by a unitary matrix $U$:\n$$\nH = UDU^\\dagger\n$$\nwhere $D$ is a diagonal matrix of eigenvalues $E'_k$ (the eigenenergies of $\\hat{H}$), and $U$ is the matrix whose columns are the corresponding eigenvectors $|k'\\rangle$. The time evolution operator is then $\\exp(-iHt) = U\\exp(-iDt)U^\\dagger$. The state vector at time $t$ is:\n$$\nC(t) = U e^{-iDt} U^\\dagger C(0)\n$$\n\n**4. Signal Calculation**\n\nThe time-dependent expectation value of the quadrupole operator is $\\langle \\hat{Q} \\rangle(t) = \\langle \\psi(t) | \\hat{Q} | \\psi(t) \\rangle = C(t)^\\dagger Q C(t)$. This calculation can be efficiently vectorized for all time steps $t_m = m \\cdot dt$. First, we transform the initial state into the eigenbasis of $H$: $\\tilde{C}(0) = U^\\dagger C(0)$. The coefficients at time $t$ in this basis are $\\tilde{C}_k(t) = e^{-iE'_k t} \\tilde{C}_k(0)$. Transforming back to the original basis gives the state vector $C(t)$ at each time step, from which the time series $\\langle \\hat{Q} \\rangle(t)$ is computed.\n\nThe response signal is then constructed as:\n$$\ns(t) = \\left(\\langle \\hat{Q} \\rangle(t) - \\langle \\hat{Q} \\rangle(0)\\right)\\,e^{-\\gamma t}\n$$\nThe subtraction of $\\langle \\hat{Q} \\rangle(0)$ removes the static component, and the exponential windowing function $e^{-\\gamma t}$ serves to apodize the signal, which is necessary for a finite-time simulation to avoid spectral artifacts.\n\n**5. Spectral Analysis**\n\nThe final step is to compute the quadrupole response spectrum $S(\\Omega)$ via the Fourier transform of the signal $s(t)$:\n$$\nS(\\Omega) = \\left|\\int_0^T s(t)\\,e^{i \\Omega t}\\,dt\\right|\n$$\nNumerically, this integral is approximated by a sum, which can be computed rapidly using the Fast Fourier Transform (FFT) algorithm on the discretized signal $s(t_m)$. The problem definition requires a Fourier transform with a positive sign in the exponent, which corresponds to the convention of an inverse FFT. However, since only the magnitude $|S(\\Omega)|$ is required, a standard forward FFT suffices, as its magnitude is identical to that of the inverse FFT.\n\nThe output of the FFT gives the spectrum at a discrete set of angular frequencies $\\Omega_k$. We are interested in the physically meaningful positive frequencies, $\\Omega_k > 0$. The dominant peak position, $\\Omega_{\\mathrm{peak}}$, is found by identifying the frequency that maximizes $|S(\\Omega_k)|$ in this positive range.\n$$\n\\Omega_{\\mathrm{peak}} = \\underset{\\Omega_k > 0}{\\arg\\max}\\, |S(\\Omega_k)|\n$$\nThis procedure is applied to each parameter set provided in the test suite.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef compute_peak_frequency(omega, alpha, kappa, N, T, dt, gamma):\n    \"\"\"\n    Computes the dominant peak frequency in the quadrupole response spectrum for a 1D\n    quantum oscillator with an optional anharmonic term.\n\n    The method involves:\n    1. Setting up the problem in the harmonic oscillator eigenbasis.\n    2. Constructing matrix representations of operators (x^2, H).\n    3. Preparing the initial state by applying a quadrupole kick.\n    4. Evolving the state in time by diagonalizing the Hamiltonian.\n    5. Calculating the time-dependent expectation value of x^2.\n    6. Performing a Fourier transform on the windowed signal to get the spectrum.\n    7. Finding the frequency of the spectrum's maximum peak.\n    \"\"\"\n    # 1. Grid and Basis Setup\n    num_steps = int(T / dt)\n    times = np.arange(num_steps) * dt\n\n    # 2. Operator Matrices in the Harmonic Oscillator Basis\n    # Matrix for the quadrupole operator Q = x^2\n    X2_mat = np.zeros((N, N), dtype=float)\n    diag_indices = np.arange(N)\n    # Diagonal elements <n|x^2|n>\n    X2_mat[diag_indices, diag_indices] = (2 * diag_indices + 1) / (2 * omega)\n    # Off-diagonal elements <n|x^2|n+2> and <n+2|x^2|n>\n    if N > 2:\n        off_diag_indices = np.arange(N - 2)\n        vals = np.sqrt((off_diag_indices + 1) * (off_diag_indices + 2)) / (2 * omega)\n        X2_mat[off_diag_indices, off_diag_indices + 2] = vals\n        X2_mat[off_diag_indices + 2, off_diag_indices] = vals\n\n    # Matrix for the x^4 term via matrix multiplication\n    X4_mat = X2_mat @ X2_mat\n\n    # Full Hamiltonian Matrix H = H_harmonic + alpha * x^4\n    H_mat = np.diag(omega * (np.arange(N) + 0.5)) + alpha * X4_mat\n\n    # 3. Initial State Preparation\n    # The system starts in the ground state of the harmonic part, |0>\n    C_gs = np.zeros(N, dtype=complex)\n    C_gs[0] = 1.0\n    \n    # Apply the kick operator U_kick = exp(-i*kappa*x^2) to the ground state\n    U_kick_mat = expm(-1j * kappa * X2_mat)\n    C0 = U_kick_mat @ C_gs\n\n    # 4. Diagonalize the Hamiltonian for Time Evolution\n    eigvals, eigvecs = np.linalg.eigh(H_mat)\n    U = eigvecs\n\n    # 5. Time Evolution and Signal Calculation (Vectorized)\n    # Transform initial state to the eigenbasis of H\n    C0_tilde = U.T.conj() @ C0\n    \n    # Evolve the state coefficients in the H eigenbasis over all time steps\n    # C_t_tilde will have shape (N, num_steps)\n    C_t_tilde = C0_tilde[:, np.newaxis] * np.exp(-1j * eigvals[:, np.newaxis] * times[np.newaxis, :])\n    \n    # Transform the state vectors back to the original harmonic oscillator basis\n    # C_t will have shape (N, num_steps)\n    C_t = U @ C_t_tilde\n    \n    # Calculate the expectation value <Q>(t) = <psi(t)|x^2|psi(t)> for all t.\n    # We use np.einsum for an efficient, vectorized computation.\n    q_exp_t = np.einsum('it,ij,jt->t', C_t.conj(), X2_mat, C_t).real\n\n    # 6. Spectral Analysis\n    # Get the initial expectation value and form the signal s(t)\n    q0 = q_exp_t[0]\n    s_t = (q_exp_t - q0) * np.exp(-gamma * times)\n    \n    # Compute the Fourier transform to get the spectrum S(Omega)\n    S_omega = np.fft.fft(s_t)\n    \n    # Get the corresponding angular frequencies\n    freqs = np.fft.fftfreq(num_steps, d=dt)\n    omega_freqs = 2 * np.pi * freqs\n\n    # 7. Peak Identification\n    # Find the peak in the positive frequency domain (Omega > 0)\n    positive_freq_mask = freqs > 0\n    \n    # Isolate frequencies and spectrum absolute values for Omega > 0\n    positive_omegas = omega_freqs[positive_freq_mask]\n    positive_spectrum_abs = np.abs(S_omega[positive_freq_mask])\n    \n    # Find the index corresponding to the maximum value of the spectrum\n    peak_idx = np.argmax(positive_spectrum_abs)\n    \n    # Identify the dominant peak frequency\n    omega_peak = positive_omegas[peak_idx]\n    \n    return omega_peak\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (omega, alpha, kappa, N, T, dt, gamma)\n    test_cases = [\n        (0.70, 0.00, 1.0e-3, 24, 800.0, 0.02, 0.002),\n        (1.10, 0.00, 1.0e-3, 24, 800.0, 0.02, 0.002),\n        (0.70, 0.02, 1.0e-3, 36, 800.0, 0.02, 0.002),\n        (0.20, 0.00, 1.0e-6, 24, 800.0, 0.02, 0.002),\n    ]\n\n    results = []\n    for params in test_cases:\n        peak_freq = compute_peak_frequency(*params)\n        results.append(peak_freq)\n\n    # Final print statement in the exact required format \"[x1,x2,x3,x4]\"\n    # with each result rounded to three decimal places.\n    formatted_results = [f\"{r:.3f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2461370"}]}