{"hands_on_practices": [{"introduction": "To truly understand the Fragment Molecular Orbital (FMO) method, it is essential to work through its core energy expression. This first practice provides a hands-on opportunity to compute the FMO energy at the two-body level (FMO2) using a simplified yet powerful model system: the $\\pi$ electrons of benzene. By comparing two different ways of fragmenting the molecule, you will directly investigate how the choice of fragmentation boundaries affects the accuracy of the FMO approximation [@problem_id:2464440].", "problem": "You are given a benzene ring modeled as a cyclic graph of six carbon atoms labeled $1,2,3,4,5,6$, where each atom contributes one $\\pi$ electron. Consider the Fragment Molecular Orbital (FMO) method at the two-body expansion level (FMO2) applied to this system under a simplified Hückel Molecular Orbital (HMO) model with zero overlap. The Hückel Hamiltonian for any set of atoms $S$ is defined as a real symmetric matrix $H(S)$ with elements\n$$\nH_{ij}(S) =\n\\begin{cases}\n\\alpha, & \\text{if } i=j \\in S, \\\\\n\\beta, & \\text{if } i\\neq j,\\ i\\in S,\\ j\\in S,\\ \\text{and } i \\text{ and } j \\text{ are bonded in benzene}, \\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwhere $\\alpha$ is the Coulomb parameter (on-site energy) and $\\beta$ is the resonance integral (nearest-neighbor interaction). The benzene bonding pattern is that of a $6$-cycle: atom $i$ is bonded to atoms $i-1$ and $i+1$ modulo $6$. Assume zero orbital overlap and no nuclear repulsion contribution. For any subsystem $S$, the total electronic energy $E(S)$ is defined by solving the eigenvalue problem $H(S)\\mathbf{c}_k=\\varepsilon_k\\mathbf{c}_k$, sorting the eigenvalues $\\varepsilon_k$ in ascending order, and then filling electrons according to the aufbau principle: each molecular orbital can accommodate at most $2$ electrons of opposite spin. If the electron count $N(S)$ is odd, the highest occupied molecular orbital has single occupancy. Since there is one $\\pi$ electron per carbon atom, use $N(S)=|S|$.\n\nDefine the FMO2 total energy for a fragmentation $\\mathcal{F}=\\{F_1,\\dots,F_M\\}$ as\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}) \\;=\\; \\sum_{I=1}^{M} E(F_I) \\;+\\; \\sum_{1\\le I < J \\le M} \\left[ E(F_I \\cup F_J) - E(F_I) - E(F_J) \\right].\n$$\nThe exact total energy $E_{\\mathrm{exact}}$ is $E(\\{1,2,3,4,5,6\\})$.\n\nConsider two fragmentations of benzene:\n- Fragmentation $\\mathcal{F}_{2+2+2}$ into three ethyne-like units (each with two adjacent carbons): $F_1=\\{1,2\\}$, $F_2=\\{3,4\\}$, $F_3=\\{5,6\\}$.\n- Fragmentation $\\mathcal{F}_{3+3}$ into two allyl-like units (each with three adjacent carbons): $G_1=\\{1,2,3\\}$, $G_2=\\{4,5,6\\}$.\n\nFor each set of parameters $(\\alpha,\\beta)$ in the test suite below, compute the FMO2 total energy error for both fragmentations, defined as\n$$\n\\Delta E_{\\mathcal{F}} \\;=\\; E_{\\mathrm{FMO2}}(\\mathcal{F}) - E_{\\mathrm{exact}}.\n$$\nReport energies in electronvolts (eV), rounded to six decimal places.\n\nTest suite (each pair $(\\alpha,\\beta)$ is in eV):\n- Case A (general): $(\\alpha,\\beta) = (\\,0.0,\\,-2.5\\,)$.\n- Case B (boundary, no coupling): $(\\alpha,\\beta) = (\\,1.0,\\,0.0\\,)$.\n- Case C (sign-inverted coupling): $(\\alpha,\\beta) = (\\,0.5,\\,2.0\\,)$.\n\nYour program must output a single line containing a list of results, one per test case, where each result is the list $[\\Delta E_{\\mathcal{F}_{2+2+2}},\\, \\Delta E_{\\mathcal{F}_{3+3}}]$ for that case, in the same order as the test suite. The final output must be a single line in the exact format of a comma-separated list enclosed in square brackets, for example $[[x_1,y_1],[x_2,y_2],[x_3,y_3]]$, where each $x_i$ and $y_i$ is a float rounded to six decimal places in eV.", "solution": "The problem is well-posed and scientifically sound, based on established principles of computational chemistry, specifically the Hückel Molecular Orbital (HMO) model and the Fragment Molecular Orbital (FMO) method. All required definitions, parameters, and constraints are provided. I will proceed with a solution.\n\nThe core of the problem is to compute the error of the two-body FMO approximation (FMO2) for two different fragmentations of a benzene ring. The error, $\\Delta E_{\\mathcal{F}}$, is defined as the difference between the FMO2 energy and the exact energy of the full system:\n$$\n\\Delta E_{\\mathcal{F}} = E_{\\mathrm{FMO2}}(\\mathcal{F}) - E_{\\mathrm{exact}}\n$$\nThe system is a benzene ring with six carbon atoms, each contributing one $\\pi$ electron. The total number of electrons in any subsystem $S$ is equal to its number of atoms, $|S|$.\n\nFirst, a general procedure for calculating the total electronic energy $E(S)$ for a subsystem $S$ under the HMO model must be established.\n1.  **Construct the Hückel Hamiltonian Matrix $H(S)$**: For a subsystem consisting of a set of atoms $S$, the Hamiltonian $H(S)$ is an $|S| \\times |S|$ matrix. Its elements are defined as $H_{ii}(S) = \\alpha$ for an atom $i \\in S$, and $H_{ij}(S) = \\beta$ if atoms $i, j \\in S$ are bonded in the original benzene molecule. All other elements are $0$. The bonding in benzene is cyclic: atom $i \\in \\{1, \\dots, 6\\}$ is bonded to $i-1$ and $i+1$ (with indices taken modulo $6$, mapping $0$ to $6$).\n2.  **Solve the Eigenvalue Problem**: The molecular orbital energies, $\\varepsilon_k$, are the eigenvalues of $H(S)$. We find these by solving the secular equation $H(S)\\mathbf{c}_k = \\varepsilon_k \\mathbf{c}_k$. The eigenvalues must be sorted in ascending order.\n3.  **Calculate Total Energy**: The total electronic energy $E(S)$ is obtained by filling the molecular orbitals with the available electrons, $N(S) = |S|$, according to the aufbau principle. With $N_{\\text{pairs}} = \\lfloor N(S)/2 \\rfloor$ doubly-occupied orbitals and $N_{\\text{unpaired}} = N(S) \\pmod 2$ singly-occupied orbitals, the energy is:\n    $$\n    E(S) = \\sum_{k=1}^{N_{\\text{pairs}}} 2\\varepsilon_k + \\sum_{k=N_{\\text{pairs}}+1}^{N_{\\text{pairs}}+N_{\\text{unpaired}}} \\varepsilon_k\n    $$\n\nThe exact energy, $E_{\\mathrm{exact}}$, is the energy of the entire benzene molecule, $E(\\{1,2,3,4,5,6\\})$.\n\nNext, we evaluate the FMO2 energy for each fragmentation. The general FMO2 formula is:\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}) = \\sum_{I=1}^{M} E(F_I) + \\sum_{1\\le I < J \\le M} \\left[ E(F_I \\cup F_J) - E(F_I) - E(F_J) \\right]\n$$\n\n**Fragmentation $\\mathcal{F}_{3+3}$:**\nThis fragmentation consists of two fragments, $G_1=\\{1,2,3\\}$ and $G_2=\\{4,5,6\\}$. In this case, $M=2$. The FMO2 formula simplifies significantly:\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{3+3}) = E(G_1) + E(G_2) + \\left[ E(G_1 \\cup G_2) - E(G_1) - E(G_2) \\right] = E(G_1 \\cup G_2)\n$$\nSince $G_1 \\cup G_2 = \\{1,2,3,4,5,6\\}$ is the entire benzene molecule, the FMO2 energy is exactly the energy of the full system:\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{3+3}) = E(\\{1,2,3,4,5,6\\}) = E_{\\mathrm{exact}}\n$$\nTherefore, the error for this fragmentation is always zero, regardless of the parameters $\\alpha$ and $\\beta$:\n$$\n\\Delta E_{\\mathcal{F}_{3+3}} = E_{\\mathrm{FMO2}}(\\mathcal{F}_{3+3}) - E_{\\mathrm{exact}} = 0\n$$\n\n**Fragmentation $\\mathcal{F}_{2+2+2}$:**\nThis fragmentation consists of three fragments: $F_1=\\{1,2\\}$, $F_2=\\{3,4\\}$, and $F_3=\\{5,6\\}$. Here $M=3$. The FMO2 energy is:\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = \\sum_{I=1}^{3} E(F_I) + \\sum_{1\\le I < J \\le 3} \\left[ E(F_I \\cup F_J) - E(F_I) - E(F_J) \\right]\n$$\nThis expression can be rearranged to:\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = E(F_1 \\cup F_2) + E(F_1 \\cup F_3) + E(F_2 \\cup F_3) - E(F_1) - E(F_2) - E(F_3)\n$$\nBy symmetry of the benzene ring and the fragmentation pattern:\n- The fragments $F_1, F_2, F_3$ are equivalent (two adjacent atoms), so $E(F_1) = E(F_2) = E(F_3)$.\n- The fragment pairs $F_1 \\cup F_2 = \\{1,2,3,4\\}$ and $F_2 \\cup F_3 = \\{3,4,5,6\\}$ are equivalent (linear chain of four atoms), so $E(F_1 \\cup F_2) = E(F_2 \\cup F_3)$.\n- The fragment pair $F_1 \\cup F_3 = \\{1,2,5,6\\}$ is different, as atoms $1$ and $6$ are bonded, forming a non-linear structure.\n\nThe simplified formula for the FMO2 energy is:\n$$\nE_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = 2E(F_1 \\cup F_2) + E(F_1 \\cup F_3) - 3E(F_1)\n$$\nTo find the error $\\Delta E_{\\mathcal{F}_{2+2+2}}$, we must compute the energies for four subsystems:\n1.  $S_1 = \\{1,2,3,4,5,6\\}$ to get $E_{\\mathrm{exact}}$.\n2.  $S_2 = F_1 = \\{1,2\\}$ to get $E(F_1)$.\n3.  $S_3 = F_1 \\cup F_2 = \\{1,2,3,4\\}$ to get $E(F_1 \\cup F_2)$.\n4.  $S_4 = F_1 \\cup F_3 = \\{1,2,5,6\\}$ to get $E(F_1 \\cup F_3)$.\n\nFor each test case $(\\alpha, \\beta)$, we will numerically construct the Hamiltonian matrix for each of these subsystems, compute their eigenvalues, determine the total electronic energy by filling orbitals, and finally calculate the error $\\Delta E_{\\mathcal{F}_{2+2+2}}$.\n\nThe algorithm is as follows:\n1.  For each pair $(\\alpha, \\beta)$ from the test suite:\n2.  Define the set of bonds in benzene: $\\{(1,2), (2,3), (3,4), (4,5), (5,6), (6,1)\\}$.\n3.  Calculate $E_{\\mathrm{exact}} = E(\\{1,2,3,4,5,6\\})$.\n4.  Calculate $E(F_1) = E(\\{1,2\\})$.\n5.  Calculate $E(F_1 \\cup F_2) = E(\\{1,2,3,4\\})$.\n6.  Calculate $E(F_1 \\cup F_3) = E(\\{1,2,5,6\\})$.\n7.  Compute $E_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) = 2E(F_1 \\cup F_2) + E(F_1 \\cup F_3) - 3E(F_1)$.\n8.  Compute the error $\\Delta E_{\\mathcal{F}_{2+2+2}} = E_{\\mathrm{FMO2}}(\\mathcal{F}_{2+2+2}) - E_{\\mathrm{exact}}$.\n9.  The error $\\Delta E_{\\mathcal{F}_{3+3}}$ is $0.0$.\n10. Store the pair of errors, rounded to six decimal places.\n11. After processing all test cases, format the collected results into the specified output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_huckel_energy(atoms, alpha, beta):\n    \"\"\"\n    Calculates the Hückel molecular orbital energy for a given subsystem of benzene.\n\n    Args:\n        atoms (tuple): A tuple of 1-based atom indices in the subsystem.\n        alpha (float): The Coulomb parameter (on-site energy).\n        beta (float): The resonance integral (hopping parameter).\n\n    Returns:\n        float: The total electronic energy of the subsystem.\n    \"\"\"\n    n = len(atoms)\n    if n == 0:\n        return 0.0\n\n    # Define benzene bonds (1-based indexing)\n    bonds = {frozenset({1, 2}), frozenset({2, 3}), frozenset({3, 4}), \n             frozenset({4, 5}), frozenset({5, 6}), frozenset({6, 1})}\n\n    # Map 1-based atom indices to 0-based matrix indices\n    atom_map = {atom_idx: i for i, atom_idx in enumerate(atoms)}\n\n    # Build the Hückel Hamiltonian matrix\n    H = np.zeros((n, n))\n    for i in range(n):\n        for j in range(i, n):\n            atom1 = atoms[i]\n            atom2 = atoms[j]\n            if i == j:\n                H[i, j] = alpha\n            elif frozenset({atom1, atom2}) in bonds:\n                H[i, j] = H[j, i] = beta\n\n    # Calculate eigenvalues (molecular orbital energies)\n    # np.linalg.eigh returns sorted eigenvalues for Hermitian matrices\n    eigenvalues = np.linalg.eigh(H)[0]\n\n    # Fill orbitals with electrons (N_electrons = N_atoms)\n    num_electrons = n\n    num_pairs = num_electrons // 2\n    num_unpaired = num_electrons % 2\n    \n    total_energy = 0.0\n    # Add energy from doubly-occupied orbitals\n    total_energy += 2.0 * np.sum(eigenvalues[:num_pairs])\n    # Add energy from singly-occupied orbitals (if any)\n    if num_unpaired > 0:\n        total_energy += eigenvalues[num_pairs]\n\n    return total_energy\n\ndef solve():\n    \"\"\"\n    Solves the FMO problem for the given test cases.\n    \"\"\"\n    # Test suite: (alpha, beta) pairs in eV\n    test_cases = [\n        (0.0, -2.5),  # Case A\n        (1.0, 0.0),   # Case B\n        (0.5, 2.0),   # Case C\n    ]\n\n    all_results = []\n\n    # Define atom sets for required subsystems\n    all_atoms = tuple(range(1, 7))\n    F1_atoms = (1, 2)\n    F1F2_atoms = (1, 2, 3, 4)\n    F1F3_atoms = (1, 2, 5, 6)\n    \n    for alpha, beta in test_cases:\n        # 1. Calculate the exact energy of the full system\n        e_exact = calculate_huckel_energy(all_atoms, alpha, beta)\n\n        # 2. Calculate error for fragmentation F_2+2+2\n        # F_2+2+2 = {F1, F2, F3} where F1={1,2}, F2={3,4}, F3={5,6}\n        # E_fmo2 = E(F1 U F2) + E(F1 U F3) + E(F2 U F3) - E(F1) - E(F2) - E(F3)\n        # By symmetry: E(F1)=E(F2)=E(F3), E(F1 U F2) = E(F2 U F3)\n        # E_fmo2 = 2*E(F1 U F2) + E(F1 U F3) - 3*E(F1)\n        \n        e_f1 = calculate_huckel_energy(F1_atoms, alpha, beta)\n        e_f1f2 = calculate_huckel_energy(F1F2_atoms, alpha, beta)\n        e_f1f3 = calculate_huckel_energy(F1F3_atoms, alpha, beta)\n        \n        e_fmo2_222 = 2 * e_f1f2 + e_f1f3 - 3 * e_f1\n        delta_e_222 = e_fmo2_222 - e_exact\n\n        # 3. Calculate error for fragmentation F_3+3\n        # F_3+3 = {G1, G2} where G1={1,2,3}, G2={4,5,6}\n        # For M=2 fragments, E_fmo2 = E(G1 U G2) = E_exact.\n        # Thus, the error is always zero.\n        delta_e_333 = 0.0\n\n        all_results.append([delta_e_222, delta_e_333])\n\n    # Format the final output string exactly as specified.\n    inner_parts = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2464440"}, {"introduction": "While the two-body FMO expansion reduces computational complexity, calculating all fragment pair interactions can still be a bottleneck for massive systems. The FMO method gains further efficiency by approximating the influence of distant fragments using an electrostatic potential. This practice delves into the physics of this crucial approximation by asking you to implement and assess the accuracy of the multipole expansion, from a simple point-charge model to a more detailed quadrupole representation, for describing a fragment's electrostatic field [@problem_id:2464495].", "problem": "You are implementing a quantitative analysis relevant to the Fragment Molecular Orbital (FMO) method in computational chemistry. The task is to assess the error introduced when modeling the electrostatic potential of a distant fragment using either a point-charge (monopole) approximation or higher-order multipole expansions. Begin from the fundamental Coulomb potential of discrete charges and formal definitions of multipole moments. Work entirely in atomic units, where the Coulomb constant equals $1$, electric charge is measured in units of the elementary charge, length in bohr, and electrostatic potential in Hartree per elementary charge. All reported potentials and errors must be in Hartree per elementary charge.\n\nYour program must:\n\n- Use the electrostatic potential due to a set of discrete point charges defined by positions and charges. The exact potential at a field point $\\mathbf{r}$ is given by the sum over all charges via Coulomb’s law. All calculations must be performed using a multipole expansion about a well-defined origin chosen as the geometric centroid (arithmetic mean of the fragment’s site positions). Define the multipole moments (monopole, dipole, and quadrupole) of the fragment about this centroid.\n\n- Define the multipole approximation at order $L \\in \\{0,1,2\\}$ as follows: order $L=0$ uses the monopole term only (point-charge model), order $L=1$ uses monopole and dipole terms, and order $L=2$ uses monopole, dipole, and quadrupole terms. The multipole expansion must be derived from the Taylor expansion of the Green’s function $\\lvert\\mathbf{r}-\\mathbf{R}\\rvert^{-1}$ about the origin and expressed in terms of the fragment’s multipole moments about the geometric centroid. The quadrupole tensor must use the standard traceless definition based on the second moments of the charge distribution.\n\n- For each test case, evaluate the exact electrostatic potential and its multipole approximations on the surface of a sphere of radius $R$ centered at the geometric centroid of the fragment. Use $N$ uniformly distributed directions on the sphere generated by the Fibonacci spherical grid defined by the golden angle $\\alpha = \\pi \\left(3 - \\sqrt{5}\\right)$. For $k \\in \\{0,1,\\dots,N-1\\}$, define\n  - $z_k = 1 - \\dfrac{2(k+0.5)}{N}$,\n  - $\\rho_k = \\sqrt{1 - z_k^2}$,\n  - $\\phi_k = k \\, \\alpha$,\n  - $\\hat{\\mathbf{u}}_k = \\left(\\rho_k \\cos \\phi_k,\\ \\rho_k \\sin \\phi_k,\\ z_k\\right)$,\n  - $\\mathbf{r}_k = R \\, \\hat{\\mathbf{u}}_k$.\n  Use these $\\mathbf{r}_k$ as the $N$ field points.\n\n- Compute, for each order $L \\in \\{0,1,2\\}$, the root-mean-square (RMS) absolute error between the exact potential $V_{\\text{exact}}(\\mathbf{r}_k)$ and the order-$L$ multipole approximation $V_L(\\mathbf{r}_k)$ over the $N$ directions:\n  $$\\mathrm{RMS}_L = \\sqrt{\\dfrac{1}{N} \\sum_{k=0}^{N-1} \\left( V_{\\text{exact}}(\\mathbf{r}_k) - V_L(\\mathbf{r}_k) \\right)^2 }.$$\n  Report $\\mathrm{RMS}_L$ in Hartree per elementary charge.\n\nFundamental base you may use:\n- Coulomb’s law for point charges and linear superposition.\n- Taylor expansion of $\\lvert\\mathbf{r}-\\mathbf{R}\\rvert^{-1}$ about the origin for $|\\mathbf{r}| \\gg |\\mathbf{R}|$.\n- Definitions of multipole moments (monopole, dipole vector, and traceless quadrupole tensor) about a specified origin.\n\nImplement the following test suite. Each test case specifies a fragment as a list of tuples $(q_i, x_i, y_i, z_i)$, the observation radius $R$, and the number of directions $N$:\n\n- Test case A (charged, well-separated):\n  - Fragment: $\\left[(+1.0, 0.0, 0.0, 0.0),\\ (+0.5, 1.0, 0.0, 0.0)\\right]$.\n  - Radius: $R = 25.0$.\n  - Directions: $N = 64$.\n\n- Test case B (neutral dipole, well-separated):\n  - Fragment: $\\left[(+1.0, 0.0, 0.0, -1.0),\\ (-1.0, 0.0, 0.0, +1.0)\\right]$.\n  - Radius: $R = 30.0$.\n  - Directions: $N = 64$.\n\n- Test case C (neutral, dipole-free, quadrupole-dominated, well-separated):\n  - Fragment: $\\left[(+1.0, +1.0, 0.0, 0.0),\\ (+1.0, -1.0, 0.0, 0.0),\\ (-1.0, 0.0, +1.0, 0.0),\\ (-1.0, 0.0, -1.0, 0.0)\\right]$.\n  - Radius: $R = 40.0$.\n  - Directions: $N = 64$.\n\n- Test case D (neutral dipole, borderline separation):\n  - Fragment: $\\left[(+1.0, 0.0, 0.0, -5.0),\\ (-1.0, 0.0, 0.0, +5.0)\\right]$.\n  - Radius: $R = 10.0$.\n  - Directions: $N = 64$.\n\nAll coordinates $(x_i, y_i, z_i)$ and the radius $R$ are in bohr. All charges $q_i$ are in units of the elementary charge. The geometric centroid (arithmetic mean of the site positions) must be used as the expansion origin and as the center of the observation sphere.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- Each test case result must be a list of three floating-point numbers $[\\mathrm{RMS}_0, \\mathrm{RMS}_1, \\mathrm{RMS}_2]$, corresponding to the RMS absolute errors for orders $L=0,1,2$, respectively.\n- The overall output must therefore be a list of four lists, in the order of the test cases A, B, C, D.\n- Each floating-point number must be rounded to exactly $8$ decimal places.\n- For example, a syntactically correct output with placeholder values would look like: $[[0.12345678,0.01234567,0.00123456],[\\dots],[\\dots],[\\dots]]$.\n\nYour program must implement all steps and print only the required single-line output in the exact format described.", "solution": "The problem requires a quantitative analysis of the error introduced by multipole approximations to the electrostatic potential of a discrete charge distribution, which is a foundational concept in methods such as the Fragment Molecular Orbital (FMO) method. The analysis must be performed in atomic units.\n\nThe first step is to establish the rigorous mathematical framework. For a collection of $n$ point charges $\\{q_i\\}$ located at positions $\\{\\mathbf{R}_i\\}$, the exact electrostatic potential at a field point $\\mathbf{r}$ is given by the principle of linear superposition and Coulomb's law:\n$$\nV_{\\text{exact}}(\\mathbf{r}) = \\sum_{i=1}^{n} \\frac{q_i}{|\\mathbf{r} - \\mathbf{R}_i|}\n$$\nThis exact potential serves as the reference against which all approximations are measured.\n\nThe multipole expansion provides an approximation for this potential at points $\\mathbf{r}$ that are distant from the charge distribution. The expansion is formulated as a Taylor series of the Green's function, $1/|\\mathbf{r}-\\mathbf{R}|$, around a chosen origin. As specified, the origin for the expansion, $\\mathbf{R}_{\\text{orig}}$, is the geometric centroid of the charge sites:\n$$\n\\mathbf{R}_{\\text{orig}} = \\frac{1}{n} \\sum_{i=1}^{n} \\mathbf{R}_i\n$$\nThis choice of origin is standard in many FMO implementations. We define coordinates relative to this centroid: the positions of the charges are $\\mathbf{R'}_i = \\mathbf{R}_i - \\mathbf{R}_{\\text{orig}}$, and the field point is $\\mathbf{r'} = \\mathbf{r} - \\mathbf{R}_{\\text{orig}}$. The expansion is valid when $|\\mathbf{r'}| \\gg |\\mathbf{R'}_i|$ for all $i$.\n\nThe electrostatic potential can then be expressed as a series in terms of the multipole moments of the charge distribution. The moments are defined with respect to the centroid.\nThe monopole moment is the total charge of the fragment:\n$$\nq = \\sum_{i=1}^{n} q_i\n$$\nThe dipole moment is a vector quantity:\n$$\n\\mathbf{p} = \\sum_{i=1}^{n} q_i \\mathbf{R'}_i\n$$\nThe traceless quadrupole moment is a second-rank tensor with components $Q_{\\alpha\\beta}$ (where $\\alpha, \\beta \\in \\{x, y, z\\}$):\n$$\nQ_{\\alpha\\beta} = \\sum_{i=1}^{n} q_i (3 R'_{i\\alpha} R'_{i\\beta} - |\\mathbf{R'}_i|^2 \\delta_{\\alpha\\beta})\n$$\nwhere $\\delta_{\\alpha\\beta}$ is the Kronecker delta.\n\nUsing these moments, the potential at a field point $\\mathbf{r'}$ can be approximated to different orders, $L$.\nThe order $L=0$ approximation includes only the monopole term:\n$$\nV_{0}(\\mathbf{r'}) = \\frac{q}{|\\mathbf{r'}|}\n$$\nThis is the point-charge approximation.\nThe order $L=1$ approximation includes monopole and dipole terms:\n$$\nV_{1}(\\mathbf{r'}) = \\frac{q}{|\\mathbf{r'}|} + \\frac{\\mathbf{p} \\cdot \\mathbf{r'}}{|\\mathbf{r'}|^{3}}\n$$\nThe order $L=2$ approximation adds the quadrupole term:\n$$\nV_{2}(\\mathbf{r'}) = \\frac{q}{|\\mathbf{r'}|} + \\frac{\\mathbf{p} \\cdot \\mathbf{r'}}{|\\mathbf{r'}|^{3}} + \\frac{1}{2} \\sum_{\\alpha, \\beta} Q_{\\alpha\\beta} \\frac{r'_{\\alpha} r'_{\\beta}}{|\\mathbf{r'}|^{5}}\n$$\n\nTo assess the accuracy of these approximations, we evaluate the potentials at a set of $N$ field points distributed uniformly on the surface of a sphere of radius $R$, centered at the fragment's geometric centroid. The positions of these field points are generated using the Fibonacci spherical grid algorithm. For $k \\in \\{0, 1, ..., N-1\\}$, the position vector of the $k$-th field point, relative to the centroid, is $\\mathbf{r'}_k = R \\hat{\\mathbf{u}}_k$, where $\\hat{\\mathbf{u}}_k$ is a unit vector. The absolute position is $\\mathbf{r}_k = \\mathbf{R}_{\\text{orig}} + \\mathbf{r'}_k$.\n\nThe error of each approximation is quantified by the root-mean-square (RMS) absolute error over the $N$ field points:\n$$\n\\mathrm{RMS}_L = \\sqrt{\\frac{1}{N} \\sum_{k=0}^{N-1} \\left( V_{\\text{exact}}(\\mathbf{r}_k) - V_L(\\mathbf{r'}_k) \\right)^2 }\n$$\nfor $L \\in \\{0, 1, 2\\}$.\n\nThe algorithm for each test case is as follows:\n1.  Given the fragment's charges $\\{q_i\\}$ and positions $\\{\\mathbf{R}_i\\}$, compute the geometric centroid $\\mathbf{R}_{\\text{orig}}$.\n2.  Calculate the relative positions $\\mathbf{R'}_i = \\mathbf{R}_i - \\mathbf{R}_{\\text{orig}}$.\n3.  Compute the monopole moment $q$, dipole moment vector $\\mathbf{p}$, and traceless quadrupole tensor $\\mathbf{Q}$.\n4.  Generate $N$ field points $\\{\\mathbf{r}_k\\}$ on the sphere of radius $R$ centered at $\\mathbf{R}_{\\text{orig}}$. The relative positions are $\\{\\mathbf{r'}_k\\}$.\n5.  For each point $k$, calculate the exact potential $V_{\\text{exact}}(\\mathbf{r}_k)$ using the original charge positions.\n6.  For each point $k$, calculate the approximate potentials $V_0(\\mathbf{r'}_k)$, $V_1(\\mathbf{r'}_k)$, and $V_2(\\mathbf{r'}_k)$ using the multipole moments.\n7.  Compute the RMS errors $\\mathrm{RMS}_0$, $\\mathrm{RMS}_1$, and $\\mathrm{RMS}_2$ according to the formula above.\nThis procedure is systematically applied to all provided test cases to yield the required numerical results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import linalg # Not required for this implementation\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It calculates the RMS errors for multipole expansions of the electrostatic potential.\n    \"\"\"\n\n    def compute_errors_for_case(fragment_data, R, N):\n        \"\"\"\n        Computes the RMS errors [RMS_0, RMS_1, RMS_2] for a single test case.\n\n        Args:\n            fragment_data (np.ndarray): Array of shape (num_atoms, 4) with [q, x, y, z].\n            R (float): Radius of the observation sphere in bohr.\n            N (int): Number of field points on the sphere.\n\n        Returns:\n            list: A list of three floats [rms0, rms1, rms2].\n        \"\"\"\n        # 1. Parse Input Data from fragment\n        charges = fragment_data[:, 0]\n        positions = fragment_data[:, 1:]\n\n        # 2. Calculate Geometric Centroid\n        centroid = np.mean(positions, axis=0)\n\n        # 3. Shift Coordinates to be relative to the centroid\n        rel_positions = positions - centroid\n\n        # 4. Calculate Multipole Moments\n        # Monopole (L=0)\n        monopole_q = np.sum(charges)\n\n        # Dipole (L=1)\n        dipole_p = np.sum(charges[:, np.newaxis] * rel_positions, axis=0)\n\n        # Traceless Quadrupole Tensor (L=2)\n        # Q_{\\alpha\\beta} = \\sum_i q_i (3 R'_{i\\alpha} R'_{i\\beta} - |\\mathbf{R'}_i|^2 \\delta_{\\alpha\\beta})\n        term1_matrix = 3 * np.einsum('i,ia,ib->ab', charges, rel_positions, rel_positions)\n        rel_pos_sq_mag = np.sum(rel_positions**2, axis=1)\n        trace_I = np.sum(charges * rel_pos_sq_mag)\n        term2_matrix = -trace_I * np.identity(3)\n        quadrupole_Q = term1_matrix + term2_matrix\n\n        # 5. Generate Field Points using Fibonacci spherical grid\n        k = np.arange(N)\n        golden_angle = np.pi * (3 - np.sqrt(5))\n        \n        z_k = 1 - (2 * (k + 0.5)) / N\n        rho_k = np.sqrt(1 - z_k**2)\n        phi_k = k * golden_angle\n        \n        x_k = rho_k * np.cos(phi_k)\n        y_k = rho_k * np.sin(phi_k)\n        \n        unit_vectors = np.stack([x_k, y_k, z_k], axis=1)  # Shape (N, 3)\n        \n        # Relative and absolute positions of field points\n        field_points_rel = R * unit_vectors\n        field_points_abs = field_points_rel + centroid\n\n        # 6. Calculate Potentials\n        # Exact Potential V_exact(r_k)\n        # Broadcasting is used for an efficient calculation over all field points.\n        # dist_matrix[k, i] = |r_k - R_i|\n        dist_matrix = np.linalg.norm(field_points_abs[:, np.newaxis, :] - positions[np.newaxis, :, :], axis=2)\n        # V_exact[k] = sum_i q_i / |r_k - R_i|\n        V_exact = np.sum(charges / dist_matrix, axis=1)  # Shape (N,)\n        \n        # Multipole Potentials V_L(r'_k)\n        # Order L=0 (Monopole)\n        V0 = np.full(N, monopole_q / R if R != 0 else np.inf)\n        \n        # Order L=1 (Monopole + Dipole)\n        # V_dipole_term = (p . r') / |r'|^3\n        V_dipole_term = np.dot(field_points_rel, dipole_p) / (R**3)\n        V1 = V0 + V_dipole_term\n        \n        # Order L=2 (Monopole + Dipole + Quadrupole)\n        # V_quad_term = 1/2 \\sum Q_ab r'_a r'_b / |r'|^5\n        quad_form = np.einsum('ki,ij,kj->k', field_points_rel, quadrupole_Q, field_points_rel)\n        V_quad_term = 0.5 * quad_form / (R**5)\n        V2 = V1 + V_quad_term\n        \n        # 7. Calculate RMS Errors\n        rms0 = np.sqrt(np.mean((V_exact - V0)**2))\n        rms1 = np.sqrt(np.mean((V_exact - V1)**2))\n        rms2 = np.sqrt(np.mean((V_exact - V2)**2))\n        \n        return [rms0, rms1, rms2]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A\n        {'fragment': np.array([[+1.0, 0.0, 0.0, 0.0], [+0.5, 1.0, 0.0, 0.0]]),\n         'R': 25.0, 'N': 64},\n        # Test case B\n        {'fragment': np.array([[+1.0, 0.0, 0.0, -1.0], [-1.0, 0.0, 0.0, +1.0]]),\n         'R': 30.0, 'N': 64},\n        # Test case C\n        {'fragment': np.array([[+1.0, +1.0, 0.0, 0.0], [+1.0, -1.0, 0.0, 0.0],\n                               [-1.0, 0.0, +1.0, 0.0], [-1.0, 0.0, -1.0, 0.0]]),\n         'R': 40.0, 'N': 64},\n        # Test case D\n        {'fragment': np.array([[+1.0, 0.0, 0.0, -5.0], [-1.0, 0.0, 0.0, +5.0]]),\n         'R': 10.0, 'N': 64},\n    ]\n\n    results = []\n    for case in test_cases:\n        rms_errors = compute_errors_for_case(case['fragment'], case['R'], case['N'])\n        results.append(rms_errors)\n\n    # Format final output string as per requirements\n    result_strings = []\n    for res in results:\n        # Each floating-point number must be rounded to exactly 8 decimal places.\n        formatted_res = [f\"{x:.8f}\" for x in res]\n        result_strings.append(f\"[{','.join(formatted_res)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "2464495"}, {"introduction": "The accuracy of any FMO calculation is fundamentally limited by the truncation of the many-body expansion. The widely used FMO2 method, for example, neglects all three-body and higher-order interactions. This final exercise uses a simplified analytical model to explore a scenario where this truncation can lead to significant errors: the modeling of a chemical reaction's transition state. By calculating the error in the reaction barrier, you will gain critical insight into the inherent limitations of the FMO2 approximation and the importance of many-body effects [@problem_id:2464438].", "problem": "You are given a simplified, self-consistent model to quantify the energy error introduced by the Fragment Molecular Orbital (FMO) method when a reaction coordinate spans two fragments. Consider a one-dimensional, dimensionless reaction progress variable $s$ that simultaneously perturbs two fragments, labeled $A$ and $B$, along a reaction path passing through a transition state. The exact Born–Oppenheimer electronic energy along this path is defined as\n$$\nE_{\\text{exact}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s) \\;+\\; E_{\\text{3body}}(s),\n$$\nwith components\n$$\nE_A(s) \\;=\\; a_A s^2 \\;+\\; c_A s^4,\\quad\nE_B(s) \\;=\\; a_B s^2 \\;+\\; c_B s^4,\\quad\nE_{\\text{pair}}(s) \\;=\\; J s^2,\\quad\nE_{\\text{3body}}(s) \\;=\\; C_3 s^4.\n$$\nHere $a_A$, $a_B$, $c_A$, $c_B$, $J$, and $C_3$ are real constants in hartree units that parameterize fragment stiffnesses, pair coupling, and a cooperative three-body stabilization or destabilization term, respectively. The Fragment Molecular Orbital (FMO) energy at the pairwise (two-body) truncation level is modeled as\n$$\nE_{\\text{FMO2}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s),\n$$\nwhich intentionally omits the three-body term $E_{\\text{3body}}(s)$ to isolate the impact of neglected many-body effects in a minimal setting.\n\nDefine the barrier height of an energy function $E(s)$ over the closed interval $s \\in [-S,S]$ with $S = 2$ as the difference between the value at a local maximum $s^\\ddagger \\in [-S,S]$ that corresponds to the transition state region and the value at the adjacent lower-energy local minimum $s_{\\min} \\in [-S,S]$ on either side of $s^\\ddagger$. All energies must be reported in hartree. Angles do not appear in this problem.\n\nFor each parameter set in the test suite below, compute the signed error in the barrier height,\n$$\n\\Delta \\;=\\; \\Delta E_{\\text{FMO2}} \\;-\\; \\Delta E_{\\text{exact}},\n$$\nexpressed in hartree. Report each $\\Delta$ as a decimal number rounded to ten decimal places.\n\nTest suite (each tuple is $(a_A, a_B, c_A, c_B, J, C_3)$, all in hartree):\n- Case $1$: $(-0.10,\\,-0.05,\\,0.30,\\,0.25,\\,0.02,\\,0.10)$\n- Case $2$: $(-0.10,\\,-0.05,\\,0.30,\\,0.25,\\,0.02,\\,0.00)$\n- Case $3$: $(-0.005,\\,-0.005,\\,0.10,\\,0.10,\\,0.0,\\,0.05)$\n- Case $4$: $(-0.20,\\,-0.15,\\,0.40,\\,0.40,\\,0.05,\\,0.50)$\n- Case $5$: $(-0.12,\\,-0.08,\\,0.22,\\,0.28,\\,0.04,\\,-0.06)$\n\nYour program should produce a single line of output containing the results for Cases $1$ through $5$, in order, formatted as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is the rounded value of $\\Delta$ in hartree as specified above. No other output should be produced.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, all givens are extracted verbatim.\nThe exact electronic energy is given by:\n$$\nE_{\\text{exact}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s) \\;+\\; E_{\\text{3body}}(s)\n$$\nwith components:\n$$\nE_A(s) \\;=\\; a_A s^2 \\;+\\; c_A s^4\n$$\n$$\nE_B(s) \\;=\\; a_B s^2 \\;+\\; c_B s^4\n$$\n$$\nE_{\\text{pair}}(s) \\;=\\; J s^2\n$$\n$$\nE_{\\text{3body}}(s) \\;=\\; C_3 s^4\n$$\nThe Fragment Molecular Orbital (FMO) energy at the two-body level is:\n$$\nE_{\\text{FMO2}}(s) \\;=\\; E_A(s) \\;+\\; E_B(s) \\;+\\; E_{\\text{pair}}(s)\n$$\nParameters $a_A, a_B, c_A, c_B, J, C_3$ are real constants. The reaction progress variable $s$ is defined on the interval $s \\in [-S,S]$ with $S=2$.\nThe barrier height $\\Delta E$ is defined as the energy difference between a local maximum $s^\\ddagger$ (transition state) and an adjacent local minimum $s_{\\min}$.\nThe quantity to be computed is the signed error in the barrier height:\n$$\n\\Delta \\;=\\; \\Delta E_{\\text{FMO2}} \\;-\\; \\Delta E_{\\text{exact}}\n$$\nTest cases are provided for the sextuplet $(a_A, a_B, c_A, c_B, J, C_3)$.\n\nThe problem is evaluated for validity. It is scientifically grounded, employing a simplified polynomial potential energy surface, which is a standard pedagogical tool in theoretical chemistry. The model correctly represents the FMO method's truncation of many-body effects. It is well-posed, providing all necessary mathematical definitions and parameters. The language is objective and unambiguous. The problem is self-contained, consistent, and formalizable. No flaws are identified. The verdict is that the problem is **valid**. We proceed to the solution.\n\nThe analysis begins by formulating the explicit energy functions. By substituting the component definitions, we obtain:\n$$\nE_{\\text{exact}}(s) = (a_A + a_B + J)s^2 + (c_A + c_B + C_3)s^4\n$$\n$$\nE_{\\text{FMO2}}(s) = (a_A + a_B + J)s^2 + (c_A + c_B)s^4\n$$\nBoth functions are of the general form $E(s) = as^2 + cs^4$.\nLet us define the coefficients for each model:\nFor the exact model: $a_{\\text{exact}} = a_A + a_B + J$ and $c_{\\text{exact}} = c_A + c_B + C_3$.\nFor the FMO2 model: $a_{\\text{FMO2}} = a_A + a_B + J$ and $c_{\\text{FMO2}} = c_A + c_B$.\nIt is evident that $a_{\\text{exact}} = a_{\\text{FMO2}}$. Let us denote this common coefficient by $a$. The quartic coefficients are distinct: $c_{\\text{exact}} = c_{\\text{FMO2}} + C_3$.\n\nTo find the barrier height, we must identify the positions of the transition state ($s^\\ddagger$) and the minima ($s_{\\min}$). These are the critical points of the function $E(s)$, found by solving $\\frac{dE}{ds}=0$.\n$$\n\\frac{dE}{ds} = \\frac{d}{ds}(as^2 + cs^4) = 2as + 4cs^3 = 2s(a + 2cs^2)\n$$\nSetting the derivative to zero gives the critical points $s^*$:\n$s^* = 0$\n$a + 2c(s^*)^2 = 0 \\implies s^* = \\pm\\sqrt{-\\frac{a}{2c}}$\n\nThe nature of these points is determined by the second derivative, $\\frac{d^2E}{ds^2}$:\n$$\n\\frac{d^2E}{ds^2} = 2a + 12cs^2\n$$\nA reaction path with a transition state implies a double-well potential, which arises when $a < 0$ and $c > 0$.\nAt $s^*=0$, $\\frac{d^2E}{ds^2}\\Big|_{s=0} = 2a$. For $a < 0$, this is negative, indicating a local maximum. Thus, the transition state is at $s^\\ddagger = 0$.\nAt $s^*=\\pm\\sqrt{-a/(2c)}$, $\\frac{d^2E}{ds^2}\\Big|_{s=\\pm\\sqrt{-a/(2c)}} = 2a + 12c\\left(-\\frac{a}{2c}\\right) = 2a - 6a = -4a$. For $a < 0$, this is positive, indicating local minima. Thus, $s_{\\min} = \\pm\\sqrt{-a/(2c)}$.\n\nAn examination of all provided test cases confirms that they are constructed such that $a = a_A+a_B+J < 0$, and both $c_{\\text{FMO2}} = c_A+c_B > 0$ and $c_{\\text{exact}} = c_A+c_B+C_3 > 0$. This guarantees the existence of a double-well potential with the transition state at $s=0$ for both the exact and FMO2 models. Furthermore, for all cases, the calculated minima $|s_{\\min}|$ are found to be less than $S=2$, so the extrema lie within the specified interval $[-2, 2]$.\n\nThe barrier height, $\\Delta E$, is calculated as $\\Delta E = E(s^\\ddagger) - E(s_{\\min})$.\nThe energy at the transition state is $E(s^\\ddagger) = E(0) = a(0)^2 + c(0)^4 = 0$.\nThe energy at the minimum is:\n$$\nE(s_{\\min}) = a\\left(-\\frac{a}{2c}\\right) + c\\left(-\\frac{a}{2c}\\right)^2 = -\\frac{a^2}{2c} + \\frac{a^2}{4c} = -\\frac{a^2}{4c}\n$$\nTherefore, the barrier height for any potential of the form $E(s) = as^2 + cs^4$ (with $a<0, c>0$) is:\n$$\n\\Delta E = E(0) - E(s_{\\min}) = 0 - \\left(-\\frac{a^2}{4c}\\right) = \\frac{a^2}{4c}\n$$\nNow we apply this general result to our specific models.\nThe exact barrier height is:\n$$\n\\Delta E_{\\text{exact}} = \\frac{a^2}{4c_{\\text{exact}}} = \\frac{(a_A+a_B+J)^2}{4(c_A+c_B+C_3)}\n$$\nThe FMO2 barrier height is:\n$$\n\\Delta E_{\\text{FMO2}} = \\frac{a^2}{4c_{\\text{FMO2}}} = \\frac{(a_A+a_B+J)^2}{4(c_A+c_B)}\n$$\nThe signed error $\\Delta$ is the difference between these two quantities:\n$$\n\\Delta = \\Delta E_{\\text{FMO2}} - \\Delta E_{\\text{exact}} = \\frac{a^2}{4c_{\\text{FMO2}}} - \\frac{a^2}{4c_{\\text{exact}}}\n$$\n$$\n\\Delta = \\frac{a^2}{4} \\left( \\frac{1}{c_{\\text{FMO2}}} - \\frac{1}{c_{\\text{exact}}} \\right) = \\frac{a^2}{4} \\left( \\frac{c_{\\text{exact}} - c_{\\text{FMO2}}}{c_{\\text{FMO2}} \\cdot c_{\\text{exact}}} \\right)\n$$\nSince $c_{\\text{exact}} - c_{\\text{FMO2}} = (c_A+c_B+C_3) - (c_A+c_B) = C_3$, we arrive at the final analytical expression for the error:\n$$\n\\Delta = \\frac{a^2 C_3}{4 \\cdot c_{\\text{FMO2}} \\cdot c_{\\text{exact}}} = \\frac{(a_A+a_B+J)^2 C_3}{4(c_A+c_B)(c_A+c_B+C_3)}\n$$\nThis compact formula directly computes the error in the barrier height from the input parameters. If $C_3=0$, the error $\\Delta$ is correctly predicted to be $0$. The computational task is to evaluate this expression for each test case and report the result rounded to ten decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the signed error in the reaction barrier height between a simplified\n    FMO2 model and an exact model for a set of given parameters.\n    \"\"\"\n    \n    # Test suite: each tuple is (a_A, a_B, c_A, c_B, J, C_3) in hartree.\n    test_cases = [\n        (-0.10, -0.05, 0.30, 0.25, 0.02, 0.10),  # Case 1\n        (-0.10, -0.05, 0.30, 0.25, 0.02, 0.00),  # Case 2\n        (-0.005, -0.005, 0.10, 0.10, 0.0, 0.05),  # Case 3\n        (-0.20, -0.15, 0.40, 0.40, 0.05, 0.50),  # Case 4\n        (-0.12, -0.08, 0.22, 0.28, 0.04, -0.06), # Case 5\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a_A, a_B, c_A, c_B, J, C_3 = case\n\n        # The energy functions are of the form E(s) = a*s^2 + c*s^4.\n        # The common quadratic coefficient is a = a_A + a_B + J.\n        a = a_A + a_B + J\n\n        # The quartic coefficient for the FMO2 model.\n        c_fmo2 = c_A + c_B\n        \n        # The quartic coefficient for the exact model.\n        c_exact = c_A + c_B + C_3\n\n        # The barrier height for a potential E(s) = a*s^2 + c*s^4 (with a<0, c>0)\n        # is given by Delta_E = a^2 / (4*c).\n        # The error in barrier height is Delta = Delta_E_FMO2 - Delta_E_exact.\n        # Delta = a^2/(4*c_fmo2) - a^2/(4*c_exact)\n        # A simplified analytical formula for the error is:\n        # Delta = (a^2 * C_3) / (4 * c_fmo2 * c_exact)\n\n        # A direct check for C_3 = 0 makes the logic explicit.\n        if C_3 == 0.0:\n            delta_error = 0.0\n        else:\n            # Check for physically meaningful potentials (required for the\n            # derived barrier height formula to be valid).\n            # All test cases satisfy a < 0, c_fmo2 > 0, and c_exact > 0.\n            # No division by zero is possible with the given test cases.\n            delta_error = (a**2 * C_3) / (4 * c_fmo2 * c_exact)\n\n        # Format the result as a string rounded to ten decimal places.\n        # The format specifier \"{:.10f}\" handles rounding correctly.\n        results.append(f\"{delta_error:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2464438"}]}