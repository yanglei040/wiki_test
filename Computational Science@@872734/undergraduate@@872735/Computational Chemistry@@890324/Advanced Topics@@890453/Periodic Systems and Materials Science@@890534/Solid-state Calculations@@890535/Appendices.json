{"hands_on_practices": [{"introduction": "A cornerstone of computational materials science is the ability to predict macroscopic mechanical properties from first-principles electronic structure calculations. The total energy as a function of crystal volume contains a wealth of information about a material's stability and response to pressure. This practice demonstrates how to determine a material's bulk modulus, a measure of its resistance to compression, by fitting calculated energy-volume data to the Birch–Murnaghan equation of state [@problem_id:2462510]. This exercise is fundamental for validating computational methods and screening materials for high-hardness applications.", "problem": "A crystalline solid’s resistance to uniform compression is quantified by the isothermal bulk modulus, denoted $B_0$. For a cubic solid such as titanium nitride (TiN), the bulk modulus at zero pressure and 0 K can be obtained by fitting an Equation of State (EOS) to a set of total energies $E$ as a function of volume $V$. In this problem, use the third-order Birch–Murnaghan EOS defined for energy as a function of volume:\n$$\nE(V) \\;=\\; E_0 \\;+\\; \\frac{9 V_0 B_0}{16} \\left\\{ \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^3 B_0' \\;+\\; \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^2 \\left(6 \\;-\\; 4 \\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}}\\right) \\right\\}.\n$$\nHere, $E_0$ is the equilibrium energy, $V_0$ is the equilibrium volume, $B_0$ is the bulk modulus, and $B_0'$ is the first pressure derivative of the bulk modulus. For unit consistency, use energies in electronvolts and volumes in cubic ångström, and convert bulk modulus between $\\mathrm{eV}/\\mathrm{\\AA}^3$ and $\\mathrm{GPa}$ with the exact factor $1~\\mathrm{eV}/\\mathrm{\\AA}^3 = 160.21766208~\\mathrm{GPa}$. When inserting $B_0$ (in $\\mathrm{GPa}$) into the formula above, first convert it to $\\mathrm{eV}/\\mathrm{\\AA}^3$ using $B_0^{(\\mathrm{eV}/\\mathrm{\\AA}^3)} = B_0^{(\\mathrm{GPa})}/160.21766208$.\n\nYour task is to determine $B_0$ for several synthetic TiN test cases by fitting the energy–volume data generated exactly by the equation above using the provided parameter sets. For each test case, you are given a tuple $(E_0, V_0, B_0, B_0')$ and a set of volumes. Generate the energies $E(V)$ using the given parameters and volumes. In Test Case $3$ only, after generating $E(V)$, add a constant offset of $+5.000\\,\\mathrm{eV}$ to every energy value to emulate an arbitrary reference energy shift. Then, fit the same third-order Birch–Murnaghan energy function to the resulting $(V, E)$ data to estimate $(E_0, V_0, B_0, B_0')$ and report $B_0$.\n\nUnits and reporting requirements:\n- Energies must be in eV and volumes in $\\mathrm{\\AA^3}$. Report the final bulk modulus values in $\\mathrm{GPa}$ rounded to exactly two decimal places.\n- Angles do not appear in this problem.\n- No percentages appear in this problem.\n\nTest suite:\n- Test Case $1$ (TiN-like, balanced sampling):\n  - Parameters: $E_0 = -18.000\\,\\mathrm{eV}$, $V_0 = 19.200\\,\\mathrm{\\AA^3}$, $B_0 = 280.000\\,\\mathrm{GPa}$, $B_0' = 4.000$.\n  - Volumes (in $\\mathrm{\\AA^3}$): $\\{17.664,\\;18.432,\\;18.816,\\;19.200,\\;19.584,\\;19.968,\\;20.736\\}$.\n- Test Case $2$ (TiN-like, slightly stiffer and asymmetric sampling window):\n  - Parameters: $E_0 = -18.500\\,\\mathrm{eV}$, $V_0 = 19.000\\,\\mathrm{\\AA^3}$, $B_0 = 300.000\\,\\mathrm{GPa}$, $B_0' = 4.200$.\n  - Volumes (in $\\mathrm{\\AA^3}$): $\\{17.860,\\;18.240,\\;18.620,\\;19.000,\\;19.380,\\;19.760,\\;20.140\\}$.\n- Test Case $3$ (TiN-like, narrow sampling around equilibrium with constant energy offset):\n  - Parameters: $E_0 = -19.200\\,\\mathrm{eV}$, $V_0 = 19.100\\,\\mathrm{\\AA^3}$, $B_0 = 250.000\\,\\mathrm{GPa}$, $B_0' = 3.800$.\n  - Volumes (in $\\mathrm{\\AA^3}$): $\\{18.8135,\\;19.0045,\\;19.1000,\\;19.1955,\\;19.3865\\}$.\n  - After computing $E(V)$ from the EOS, add $+5.000\\,\\mathrm{eV}$ to each energy.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Test Case $1$, Test Case $2$, and Test Case $3$. Each entry is the fitted bulk modulus $B_0$ in $\\mathrm{GPa}$, rounded to exactly two decimal places. For example: $[280.00,300.00,250.00]$.", "solution": "The problem presented is a valid and well-posed exercise in computational materials science, specifically in the analysis of equation of state (EOS) data. It requires the determination of the isothermal bulk modulus, $B_0$, for a cubic solid by fitting synthetic energy-volume data to the third-order Birch–Murnaghan EOS. The problem is scientifically grounded, logically consistent, and all necessary data and constraints are provided.\n\nThe core of the problem lies in applying non-linear least squares fitting to a known physical model. The governing equation is the third-order Birch–Murnaghan EOS, which describes the total energy $E$ of a solid as a function of its volume $V$:\n$$\nE(V) \\;=\\; E_0 \\;+\\; \\frac{9 V_0 B_0}{16} \\left\\{ \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^3 B_0' \\;+\\; \\left[\\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}} - 1\\right]^2 \\left(6 \\;-\\; 4 \\left(\\frac{V_0}{V}\\right)^{\\tfrac{2}{3}}\\right) \\right\\}\n$$\nThe parameters to be determined by the fit are the equilibrium energy $E_0$, the equilibrium volume $V_0$, the bulk modulus $B_0$, and its first pressure derivative $B_0'$.\n\nThe specified procedure involves two main steps for each test case:\n$1$. **Data Generation**: A set of energy-volume pairs $(V, E)$ is first synthesized using the provided \"true\" parameters ($E_0, V_0, B_0, B_0'$) and a list of volumes. For Test Case $3$, a constant energy offset of $+5.000\\,\\mathrm{eV}$ is added to all calculated energies. This simulates a change in the reference energy, which should only affect the fitted value of $E_0$ and leave other parameters, such as $B_0$, unchanged, as they depend on the shape of the $E(V)$ curve, not its absolute vertical position.\n\n$2$. **Parameter Fitting**: The synthesized $(V, E)$ data is then used as input for a non-linear least squares fitting procedure. The objective is to find the set of parameters $(E_0, V_0, B_0, B_0')$ that best reproduces the data when plugged into the Birch–Murnaghan EOS model. The primary value of interest is the fitted bulk modulus, $B_0$.\n\nThis task will be accomplished using the `curve_fit` function from the `scipy.optimize` library, which implements the Levenberg-Marquardt algorithm for non-linear optimization. The function requires a model function to fit, the independent data ($V$), the dependent data ($E$), and a set of initial guesses for the parameters.\n\nThe model function will be a direct implementation of the Birch–Murnaghan EOS. A critical detail is the handling of units. The equation requires the bulk modulus $B_0$ to be in units of energy per volume, specifically $\\mathrm{eV/\\AA^3}$. The input and output values for $B_0$ are specified in Gigapascals ($\\mathrm{GPa}$). Therefore, the conversion factor $1\\,\\mathrm{eV/\\AA^3} = 160.21766208\\,\\mathrm{GPa}$ must be applied correctly within the model function. The fitting function will be defined to accept $B_0$ in $\\mathrm{GPa}$ and perform the conversion internally.\n\nTo ensure the stability and success of the fitting algorithm, reasonable initial guesses for the parameters are necessary. These can be estimated directly from the input $(V, E)$ data:\n- The initial guess for the equilibrium volume, $V_0^{\\text{guess}}$, is the volume corresponding to the minimum energy in the dataset.\n- The initial guess for the equilibrium energy, $E_0^{\\text{guess}}$, is this minimum energy value.\n- For the bulk modulus, $B_0^{\\text{guess}}$, a physically plausible value such as $200\\,\\mathrm{GPa}$ can be used as a starting point.\n- For its pressure derivative, $B_0'^{\\text{guess}}$, a typical value is $4.0$.\n\nSince the data for fitting is generated from the exact model function without any noise, the non-linear least squares fit is expected to converge to the original \"true\" parameters with very high numerical precision. The final step is to report the fitted $B_0$ for each test case, in $\\mathrm{GPa}$ and rounded to two decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting the Birch-Murnaghan EOS to synthetic data\n    to determine the bulk modulus B0 for three test cases.\n    \"\"\"\n\n    # Conversion factor from GPa to eV/Å^3\n    GPA_TO_EV_PER_A3 = 1.0 / 160.21766208\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"params\": (-18.000, 19.200, 280.000, 4.000), # (E0, V0, B0_gpa, B0_prime)\n            \"volumes\": np.array([17.664, 18.432, 18.816, 19.200, 19.584, 19.968, 20.736]),\n            \"energy_offset\": 0.0\n        },\n        {\n            \"params\": (-18.500, 19.000, 300.000, 4.200),\n            \"volumes\": np.array([17.860, 18.240, 18.620, 19.000, 19.380, 19.760, 20.140]),\n            \"energy_offset\": 0.0\n        },\n        {\n            \"params\": (-19.200, 19.100, 250.000, 3.800),\n            \"volumes\": np.array([18.8135, 19.0045, 19.1000, 19.1955, 19.3865]),\n            \"energy_offset\": 5.000\n        }\n    ]\n\n    def birch_murnaghan_eos(V, E0, V0, B0_gpa, B0_prime):\n        \"\"\"\n        Third-order Birch-Murnaghan Equation of State.\n        \n        Args:\n            V (np.ndarray): Volume(s) in Å^3.\n            E0 (float): Equilibrium energy in eV.\n            V0 (float): Equilibrium volume in Å^3.\n            B0_gpa (float): Bulk modulus in GPa.\n            B0_prime (float): Pressure derivative of the bulk modulus.\n        \n        Returns:\n            np.ndarray: Energy(s) in eV.\n        \"\"\"\n        B0_ev_a3 = B0_gpa * GPA_TO_EV_PER_A3\n        \n        x = (V0 / V)**(2.0/3.0)\n        \n        term1 = ((x - 1)**3) * B0_prime\n        term2 = ((x - 1)**2) * (6 - 4*x)\n        \n        E = E0 + (9 * V0 * B0_ev_a3 / 16) * (term1 + term2)\n        \n        return E\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack the test case data\n        true_params = case[\"params\"]\n        volumes = case[\"volumes\"]\n        energy_offset = case[\"energy_offset\"]\n        \n        # 1. Generate synthetic energy-volume data\n        energies = birch_murnaghan_eos(volumes, *true_params)\n        \n        # Apply energy offset for Test Case 3\n        if energy_offset != 0.0:\n            energies += energy_offset\n            \n        # 2. Set up initial guesses for the fitting procedure\n        min_energy_index = np.argmin(energies)\n        E0_guess = energies[min_energy_index]\n        V0_guess = volumes[min_energy_index]\n        B0_guess = 200.0  # A typical physical value\n        B0_prime_guess = 4.0 # A typical physical value\n        initial_guesses = [E0_guess, V0_guess, B0_guess, B0_prime_guess]\n        \n        # 3. Perform the non-linear least squares fit\n        popt, _ = curve_fit(\n            f=birch_murnaghan_eos,\n            xdata=volumes,\n            ydata=energies,\n            p0=initial_guesses\n        )\n        \n        # 4. Extract the fitted bulk modulus\n        B0_fit_gpa = popt[2]\n        \n        results.append(B0_fit_gpa)\n\n    # Format the results as required\n    formatted_results = [f\"{res:.2f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462510"}, {"introduction": "Beyond static properties, understanding how electrons move through a crystal is key to predicting its electronic behavior. The concept of effective mass simplifies the complex interactions between an electron and the periodic potential of the lattice, allowing us to treat the electron as a quasi-particle with a mass $m^*$ that differs from its free-space value. In this exercise, you will calculate the effective mass of electrons and holes by analyzing the curvature of a material's electronic band structure, a critical skill for modeling semiconductors and designing electronic devices [@problem_id:2462494].", "problem": "A single, fully reproducible task is to determine the scalar effective mass of charge carriers in Germanium from one-dimensional band curvatures at the Conduction Band Minimum (CBM) and the Valence Band Maximum (VBM). The effective mass is defined at a band extremum by the curvature of the energy dispersion with respect to the crystal wave vector. Specifically, for a one-dimensional dispersion along a fixed direction, with energy as a function of wave-vector offset $k$ from the extremum point, the electron effective mass $m_e^\\ast$ and the hole effective mass $m_h^\\ast$ are defined by the curvature relation at the extremum:\n- For electrons (at a minimum), $m_e^\\ast$ is positive and satisfies $m_e^\\ast = \\hbar^2 / E''(k)$.\n- For holes (at a maximum), $m_h^\\ast$ is defined to be positive and satisfies $m_h^\\ast = -\\hbar^2 / E''(k)$.\nHere $E''(k)$ denotes the second derivative of the band energy with respect to $k$, evaluated at the extremum, and $\\hbar$ is the reduced Planck constant.\n\nUse the following physical constants (use exactly these values in your calculations):\n- Reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$.\n- Elementary charge $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n- Free electron mass $m_e = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$.\n\nAll energies $E$ below are given in electronvolts (eV), and all wave-vector offsets $k$ are given in inverse meters ($\\mathrm{m}^{-1}$). When converting curvatures from eV to J, use the factor $1~\\mathrm{eV} = e~\\mathrm{J}$. Compute and report the dimensionless mass ratio $m^\\ast/m_e$ for each case. Express your final answers as decimal numbers rounded to six decimal places. Angles are not involved in this problem.\n\nInput data are provided as discrete samples of the dispersion $E(k)$ near the extremum along a single direction. For each test case, you are given a list of wave-vector offsets $k$ (relative to the extremum point along the chosen direction) and the corresponding energies $E(k)$. Each test case also specifies whether it corresponds to electrons (CBM) or holes (VBM). Your program must infer the curvature $E''(k)$ at the extremum from these samples, apply the definition above, and return $m^\\ast/m_e$.\n\nTest suite (each case is independent):\n- Case $1$ (electron at the CBM near the $L$ valley, longitudinal direction):\n  - $k = \\left[ -2.0\\times 10^{9},\\ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9},\\ 2.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ 0.755892,\\ 0.683973,\\ 0.660000,\\ 0.683973,\\ 0.755892 \\right]\\ \\mathrm{eV}$\n  - Carrier type: electron.\n- Case $2$ (electron at the CBM near the $L$ valley, transverse direction):\n  - $k = \\left[ -2.0\\times 10^{9},\\ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9},\\ 2.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ 2.519760,\\ 1.124940,\\ 0.660000,\\ 1.124940,\\ 2.519760 \\right]\\ \\mathrm{eV}$\n  - Carrier type: electron.\n- Case $3$ (heavy hole at the VBM near $\\Gamma$):\n  - $k = \\left[ -2.0\\times 10^{9},\\ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9},\\ 2.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ -0.544528,\\ -0.136132,\\ 0.0,\\ -0.136132,\\ -0.544528 \\right]\\ \\mathrm{eV}$\n  - Carrier type: hole.\n- Case $4$ (light hole at the VBM near $\\Gamma$, boundary-sized sampling):\n  - $k = \\left[ -1.0\\times 10^{9},\\ 0.0,\\ 1.0\\times 10^{9} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ -0.866295,\\ 0.0,\\ -0.866295 \\right]\\ \\mathrm{eV}$\n  - Carrier type: hole.\n- Case $5$ (heavy hole at the VBM near $\\Gamma$, very small $k$ sampling for numerical sensitivity):\n  - $k = \\left[ -1.0\\times 10^{8},\\ -5.0\\times 10^{7},\\ 0.0,\\ 5.0\\times 10^{7},\\ 1.0\\times 10^{8} \\right]\\ \\mathrm{m}^{-1}$\n  - $E(k) = \\left[ -0.00136132,\\ -0.00034033,\\ 0.0,\\ -0.00034033,\\ -0.00136132 \\right]\\ \\mathrm{eV}$\n  - Carrier type: hole.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases $1$ through $5$, where each entry is the rounded value of $m^\\ast/m_e$ to six decimal places, for example: $\\left[ 1.234567,0.123456,0.654321,0.111111,0.222222 \\right]$.", "solution": "The problem is valid. It presents a standard task in solid-state physics: the determination of carrier effective mass from a given energy dispersion relation $E(k)$. The data, constants, and definitions are scientifically sound, consistent, and sufficient for a unique solution.\n\nThe fundamental principle underlying this problem is the effective mass approximation. Near a band extremum, such as a Conduction Band Minimum (CBM) or a Valence Band Maximum (VBM), the energy dispersion $E(k)$ can be approximated by a parabolic function of the wave vector $k$. For a one-dimensional dispersion along a specific direction, with the extremum located at $k=0$, this approximation is given by:\n$$\nE(k) \\approx E(0) + \\frac{1}{2} E''(0) k^2\n$$\nwhere $E(0)$ is the energy at the extremum and $E''(0)$ is the second derivative of the energy with respect to the wave vector, evaluated at $k=0$. This second derivative, or curvature, determines the effective mass $m^\\ast$ of the charge carrier.\n\nThe problem provides the definitions for electron and hole effective masses:\n- For an electron at a CBM (a minimum, so $E''(0)  0$): $m_e^\\ast = \\frac{\\hbar^2}{E''(0)}$. The positive curvature results in a positive effective mass.\n- For a hole at a VBM (a maximum, so $E''(0)  0$): $m_h^\\ast = -\\frac{\\hbar^2}{E''(0)}$. The negative curvature, combined with the negative sign in the definition, results in a positive effective mass for the hole, as is conventional.\n\nThe primary task is to determine the value of the curvature, $E''(0)$, from the discrete data points $(k_i, E_i)$ provided for each case. The parabolic nature of the approximation suggests that fitting the data to a quadratic polynomial is the correct and most direct approach. We fit the function $E(k) = ak^2 + bk + c$ to the data. From this functional form, the second derivative is a constant:\n$$\nE'(k) = 2ak + b\n$$\n$$\nE''(k) = 2a\n$$\nTherefore, $E''(0) = 2a$. The coefficient $a$ of the quadratic term directly gives us the required curvature. The `numpy.polyfit` function is employed to perform a least-squares polynomial fit of degree $2$, which robustly determines the coefficient $a$.\n\nA critical aspect of the calculation is the consistent use of units. The input data provides energy $E$ in electronvolts ($\\mathrm{eV}$) and wave vector $k$ in inverse meters ($\\mathrm{m}^{-1}$). The polynomial fit will therefore yield the coefficient $a$ in units of $\\mathrm{eV}\\cdot\\mathrm{m}^2$. The formula for effective mass requires all quantities to be in SI units. The reduced Planck constant, $\\hbar$, is given in $\\mathrm{J}\\cdot\\mathrm{s}$. Thus, the curvature $E''(0) = 2a$ must be converted from units of $\\mathrm{eV}\\cdot\\mathrm{m}^2$ to $\\mathrm{J}\\cdot\\mathrm{m}^2$. This conversion is achieved by multiplying by the elementary charge $e$, using the relation $1\\ \\mathrm{eV} = e\\ \\mathrm{J}$, where $e$ is in Coulombs ($C$).\nThe curvature in SI units is therefore:\n$$\nE''_{\\mathrm{SI}}(0) = 2a \\times e\n$$\n\nThe calculation procedure for each test case is as follows:\n1.  Use `numpy.polyfit` with the given arrays of $k$ and $E(k)$ data and a degree of $2$ to find the coefficients of the best-fit quadratic polynomial, $E(k) = ak^2 + bk + c$. The first returned coefficient is $a$.\n2.  Calculate the second derivative in SI units: $E''_{\\mathrm{SI}}(0) = 2 \\cdot a \\cdot e$. The value of $a$ is in $\\mathrm{eV}\\cdot\\mathrm{m}^2$ and $e$ is in $\\mathrm{C}$.\n3.  Calculate the effective mass $m^\\ast$ in kilograms ($\\mathrm{kg}$) using the appropriate formula based on the carrier type:\n    - If 'electron', $m^\\ast = \\frac{\\hbar^2}{E''_{\\mathrm{SI}}(0)}$.\n    - If 'hole', $m^\\ast = -\\frac{\\hbar^2}{E''_{\\mathrm{SI}}(0)}$.\n4.  Compute the final dimensionless ratio $m^\\ast / m_e$, where $m_e$ is the free electron mass.\n5.  Round the resulting ratio to six decimal places as required.\n\nThis procedure is applied to all five test cases using the specified physical constants:\n- $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$\n- $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$\n- $m_e = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$\nThe data provided in each case is perfectly quadratic, so the polynomial fit will be exact. Cases $3$ and $5$ describe the same band but with different sampling ranges for $k$, and will correctly yield the same effective mass, demonstrating the robustness of the parabolic approximation in this region.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the dimensionless effective mass ratio m*/m_e for charge carriers\n    in Germanium from band curvature data.\n    \"\"\"\n    # Physical constants as defined in the problem statement\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J.s\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_E = 9.1093837015e-31  # Free electron mass in kg\n\n    # Test suite from the problem statement\n    test_cases = [\n        {\n            \"k\": np.array([-2.0e9, -1.0e9, 0.0, 1.0e9, 2.0e9]),\n            \"E\": np.array([0.755892, 0.683973, 0.660000, 0.683973, 0.755892]),\n            \"type\": \"electron\"\n        },\n        {\n            \"k\": np.array([-2.0e9, -1.0e9, 0.0, 1.0e9, 2.0e9]),\n            \"E\": np.array([2.519760, 1.124940, 0.660000, 1.124940, 2.519760]),\n            \"type\": \"electron\"\n        },\n        {\n            \"k\": np.array([-2.0e9, -1.0e9, 0.0, 1.0e9, 2.0e9]),\n            \"E\": np.array([-0.544528, -0.136132, 0.0, -0.136132, -0.544528]),\n            \"type\": \"hole\"\n        },\n        {\n            \"k\": np.array([-1.0e9, 0.0, 1.0e9]),\n            \"E\": np.array([-0.866295, 0.0, -0.866295]),\n            \"type\": \"hole\"\n        },\n        {\n            \"k\": np.array([-1.0e8, -5.0e7, 0.0, 5.0e7, 1.0e8]),\n            \"E\": np.array([-0.00136132, -0.00034033, 0.0, -0.00034033, -0.00136132]),\n            \"type\": \"hole\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        k_data = case[\"k\"]\n        E_data = case[\"E\"]\n        carrier_type = case[\"type\"]\n\n        # Fit a quadratic polynomial E(k) = a*k^2 + b*k + c to the data.\n        # np.polyfit returns coefficients [a, b, c] for the polynomial.\n        coeffs = np.polyfit(k_data, E_data, 2)\n        a_coeff = coeffs[0]  # Coefficient 'a' is in units of eV*m^2\n\n        # The second derivative E''(0) is 2*a.\n        # Convert it to SI units (J*m^2) by multiplying with elementary charge.\n        E_double_prime_si = 2 * a_coeff * E_CHARGE\n        \n        # Calculate the effective mass m_star (in kg).\n        # The formulas are m_e* = hbar^2 / E'' and m_h* = -hbar^2 / E''.\n        hbar_squared = HBAR**2\n        \n        if carrier_type == \"electron\":\n            m_star = hbar_squared / E_double_prime_si\n        elif carrier_type == \"hole\":\n            m_star = -hbar_squared / E_double_prime_si\n        else:\n            # This case should not be reached with the given problem data.\n            raise ValueError(\"Invalid carrier type specified.\")\n\n        # Calculate the dimensionless effective mass ratio m*/m_e\n        mass_ratio = m_star / M_E\n        \n        # Format the result to six decimal places and add to the list.\n        results.append(f\"{mass_ratio:.6f}\")\n\n    # Print the final output in the required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2462494"}, {"introduction": "The atoms in a crystal are not static but are in constant motion, vibrating about their equilibrium positions in collective modes called phonons. These lattice vibrations determine a material's thermal properties, influence electron transport, and give rise to characteristic spectroscopic signatures. This practice explores the fundamental relationship between phonon frequency and atomic mass by modeling the effect of isotopic substitution in diamond [@problem_id:2462547]. By applying the harmonic and virtual crystal approximations, you will see how changing the mass of the atoms predictably shifts the vibrational frequency, a phenomenon readily observed in Raman spectroscopy.", "problem": "You are asked to construct a physically grounded computational model for the Raman-active zone-center optical phonon in diamond under isotopic substitution of carbon from carbon-$12$ to carbon-$13$. Work within the Born–Oppenheimer approximation and the harmonic approximation. Use the fact that, in a crystal, phonon frequencies at a given wave vector are obtained from the eigenvalues of the mass-weighted force-constant matrix (the dynamical matrix), where the force-constant matrix depends on the electronic ground state while the mass weighting depends on the nuclear masses. In an isotopically substituted crystal, assume the chemical bonding and force constants remain unchanged by the substitution, and that isotopic disorder can be approximated by the Virtual Crystal Approximation (VCA), in which the mass on each crystallographic site is replaced by an average mass.\n\nStarting from these principles, derive how a change in isotopic composition modifies the Raman-active zone-center optical phonon frequency in diamond. Model diamond as a two-atom basis with identical atomic species so that the relevant mass dependence emerges solely from the mass weighting in the dynamical matrix. Use the following constants and conventions:\n- Baseline Raman frequency for pure carbon-$12$ diamond: $\\nu_{12} = 1332.0$ in $\\mathrm{cm}^{-1}$.\n- Isotopic masses: $M_{12} = 12.000\\,\\mathrm{u}$, $M_{13} = 13.003355\\,\\mathrm{u}$.\n- In the Virtual Crystal Approximation, for a fraction $x$ of carbon-$13$ and $(1-x)$ of carbon-$12$, the site mass is $M_{\\mathrm{avg}} = (1-x) M_{12} + x M_{13}$.\n- Angles are not involved. All required outputs must be phonon frequencies expressed in $\\mathrm{cm}^{-1}$.\n- The final numerical results must be rounded to $6$ decimal places.\n\nYour program must compute the Raman-active zone-center optical phonon frequency for the following test suite of carbon-$13$ fractions $x$:\n- $x = 0$,\n- $x = 0.0107$,\n- $x = 0.5$,\n- $x = 1.0$,\n- $x = 1\\times 10^{-6}$.\n\nYour program should produce a single line of output containing a comma-separated list of the five resulting frequencies in $\\mathrm{cm}^{-1}$, enclosed in square brackets, for example, $[\\dots]$. Ensure each value is rounded to exactly $6$ decimal places and appears in that fixed-point format.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of solid-state physics, specifically lattice dynamics. It is well-posed, providing all necessary physical constants and a clear computational objective. The assumptions—the Born-Oppenheimer approximation, the harmonic approximation, the invariance of force constants under isotopic substitution, and the Virtual Crystal Approximation (VCA) for disorder—are standard and appropriate for constructing a tractable model. We shall now proceed with the derivation and solution.\n\nThe fundamental description of lattice vibrations in a crystal, within the harmonic approximation, is given by the classical equation of motion for the atomic displacements. For an atom $k$ in the unit cell $l$ with mass $M_k$ and displacement vector $\\mathbf{u}(lk)$, the equation is:\n$$\nM_k \\ddot{u}_{\\alpha}(lk) = - \\sum_{l'k'\\beta} \\Phi_{\\alpha\\beta}(lk; l'k') u_{\\beta}(l'k')\n$$\nwhere $\\Phi_{\\alpha\\beta}(lk; l'k')$ is the force-constant matrix, representing the second derivative of the crystal potential energy with respect to atomic displacements. The indices $\\alpha, \\beta$ denote Cartesian components.\n\nAssuming a plane-wave solution of the form $\\mathbf{u}(lk) = \\frac{1}{\\sqrt{M_k}} \\mathbf{e}_k(\\mathbf{q}) e^{i(\\mathbf{q} \\cdot \\mathbf{R}_l - \\omega t)}$, where $\\mathbf{q}$ is the wave vector, $\\omega$ is the angular frequency, and $\\mathbf{e}_k(\\mathbf{q})$ is the polarization vector for atom $k$, we arrive at the secular equation:\n$$\n\\sum_{k'\\beta} D_{\\alpha\\beta}(k,k';\\mathbf{q}) e_{\\beta}(k';\\mathbf{q}) = \\omega^2(\\mathbf{q}) e_{\\alpha}(k;\\mathbf{q})\n$$\nHere, $D_{\\alpha\\beta}(k,k';\\mathbf{q})$ are the elements of the dynamical matrix, which is the mass-weighted Fourier transform of the force-constant matrix:\n$$\nD_{\\alpha\\beta}(k,k';\\mathbf{q}) = \\frac{1}{\\sqrt{M_k M_{k'}}} \\sum_{l'} \\Phi_{\\alpha\\beta}(0k; l'k') e^{i\\mathbf{q} \\cdot \\mathbf{R}_{l'}}\n$$\nThe eigenvalues of the dynamical matrix for a given wave vector $\\mathbf{q}$ are the squared phonon frequencies, $\\omega^2(\\mathbf{q})$.\n\nThe problem specifies the zone-center Raman-active optical phonon. The zone center corresponds to $\\mathbf{q}=\\mathbf{0}$. Diamond has a face-centered cubic lattice with a two-atom basis. For simplicity, let the two atoms in the basis be labeled $k=1$ and $k=2$. The problem states we can model them as identical species, so their masses are equal, $M_1=M_2=M$.\n\nAt the zone center ($\\mathbf{q}=\\mathbf{0}$), for the optical modes, the two sublattices vibrate against each other. The motion can be equivalently described by the vibration of a single particle with the reduced mass $\\mu$ of the two-atom system, subject to an effective force constant $k_{eff}$. The reduced mass is given by:\n$$\n\\mu = \\frac{M_1 M_2}{M_1 + M_2}\n$$\nSince $M_1 = M_2 = M$, the reduced mass is $\\mu = \\frac{M^2}{2M} = \\frac{M}{2}$. The angular frequency of the zone-center optical phonon is thus related to the atomic mass $M$ by:\n$$\n\\omega_{opt}^2 = \\frac{k_{eff}}{\\mu} = \\frac{k_{eff}}{M/2} \\implies \\omega_{opt}^2 \\propto \\frac{1}{M}\n$$\nThis implies that the angular frequency itself scales as $\\omega_{opt} \\propto \\frac{1}{\\sqrt{M}}$.\n\nThe problem is concerned with isotopic substitution. Central to this problem is the fact that isotopic substitution changes the nuclear mass $M$ but does not alter the electronic structure. Within the Born-Oppenheimer approximation, the interatomic forces and thus the force-constant matrix $\\Phi$ (and by extension the effective force constant $k_{eff}$) are determined solely by the ground-state electron distribution. Therefore, $k_{eff}$ is invariant under isotopic substitution.\n\nThis invariance allows us to establish a direct scaling relationship. Let $\\nu_{12}$ be the phonon frequency (in wavenumbers, $\\mathrm{cm}^{-1}$) for pure C-$12$ diamond, where the atomic mass is $M_{12}$. Let $\\nu_x$ be the frequency for a diamond crystal with a fraction $x$ of C-$13$ isotopes. The frequency in wavenumbers, $\\nu$, is directly proportional to the angular frequency $\\omega$ ($\\omega = 2\\pi c \\nu$, where $c$ is the speed of light). Therefore, the scaling relation also applies to $\\nu$:\n$$\n\\nu \\propto \\omega \\propto \\frac{1}{\\sqrt{M}}\n$$\nWe can write a ratio for the frequencies:\n$$\n\\frac{\\nu_x}{\\nu_{12}} = \\frac{1/\\sqrt{M_{eff}}}{1/\\sqrt{M_{12}}} = \\sqrt{\\frac{M_{12}}{M_{eff}}}\n$$\nwhere $M_{eff}$ is the effective atomic mass for the isotopically mixed crystal.\n\nTo model the mixed crystal, we employ the Virtual Crystal Approximation (VCA), as specified. In the VCA, the properties of a disordered alloy are approximated by those of a virtual periodic crystal where each atomic site is occupied by a virtual atom whose properties are the compositional average of the constituent atoms. In this case, the mass on each site is replaced by the average isotopic mass, $M_{\\mathrm{avg}}(x)$:\n$$\nM_{eff} = M_{\\mathrm{avg}}(x) = (1-x) M_{12} + x M_{13}\n$$\nwhere $x$ is the fraction of C-$13$ atoms.\n\nSubstituting this expression for the effective mass into our scaling relation gives the final computational formula:\n$$\n\\nu_x = \\nu_{12} \\sqrt{\\frac{M_{12}}{(1-x) M_{12} + x M_{13}}}\n$$\nWe are given the constants:\n- Baseline frequency for pure C-$12$: $\\nu_{12} = 1332.0 \\, \\mathrm{cm}^{-1}$\n- Mass of C-$12$: $M_{12} = 12.000 \\, \\mathrm{u}$\n- Mass of C-$13$: $M_{13} = 13.003355 \\, \\mathrm{u}$\n\nThis formula will be implemented to compute the phonon frequencies for the specified set of C-$13$ fractions $x$. For the case $x=0$, the formula correctly recovers $\\nu_0 = \\nu_{12} \\sqrt{M_{12}/M_{12}} = \\nu_{12}$. For $x0$, the average mass increases, and consequently, the frequency $\\nu_x$ will decrease.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Raman-active zone-center optical phonon frequency in diamond\n    under isotopic substitution using the Virtual Crystal Approximation.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    # Baseline Raman frequency for pure carbon-12 diamond in cm^-1.\n    nu_12 = 1332.0\n    # Isotopic mass of carbon-12 in atomic mass units (u).\n    M_12 = 12.000\n    # Isotopic mass of carbon-13 in atomic mass units (u).\n    M_13 = 13.003355\n\n    # Define the test cases for the fraction x of carbon-13.\n    test_cases = [\n        0.0,\n        0.0107,\n        0.5,\n        1.0,\n        1e-6\n    ]\n\n    results = []\n    # Iterate through each test case for the fraction x.\n    for x in test_cases:\n        # Calculate the average mass using the Virtual Crystal Approximation.\n        # M_avg = (1-x) * M_12 + x * M_13\n        m_avg = (1.0 - x) * M_12 + x * M_13\n        \n        # Calculate the frequency scaling factor from the mass ratio.\n        # The squared frequency is inversely proportional to the effective mass.\n        # nu_x / nu_12 = sqrt(M_12 / M_avg)\n        if m_avg  0:\n            scaling_factor = np.sqrt(M_12 / m_avg)\n            # Calculate the new phonon frequency.\n            nu_x = nu_12 * scaling_factor\n        else:\n            # Handle the unlikely case of zero or negative average mass.\n            nu_x = 0.0\n\n        results.append(nu_x)\n\n    # Format the results as strings rounded to 6 decimal places in fixed-point format.\n    # Example: 1332.0 becomes \"1332.000000\".\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format: [res1,res2,...]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462547"}]}