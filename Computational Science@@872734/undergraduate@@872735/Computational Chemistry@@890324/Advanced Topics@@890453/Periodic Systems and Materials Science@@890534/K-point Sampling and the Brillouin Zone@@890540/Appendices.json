{"hands_on_practices": [{"introduction": "To navigate the landscape of electronic bands, we plot them along specific high-symmetry paths within the Brillouin zone. While these points (like $\\Gamma$, $X$, and $L$) are naturally defined in terms of the reciprocal lattice vectors, plotting and visualization require their Cartesian coordinates. This fundamental exercise ([@problem_id:2456762]) walks you through this essential transformation, building a concrete connection between the abstract reciprocal space and the familiar Cartesian system.", "problem": "A face-centered cubic crystal has a conventional cubic lattice parameter $a$ with Cartesian axes aligned to the cube edges. The primitive real-space lattice vectors are\n- $\\mathbf{a}_{1} = \\left(0, \\frac{a}{2}, \\frac{a}{2}\\right)$,\n- $\\mathbf{a}_{2} = \\left(\\frac{a}{2}, 0, \\frac{a}{2}\\right)$,\n- $\\mathbf{a}_{3} = \\left(\\frac{a}{2}, \\frac{a}{2}, 0\\right)$.\n\nUsing the fundamental definition of reciprocal lattice vectors $\\mathbf{b}_{i}$ specified by $\\mathbf{b}_{i} \\cdot \\mathbf{a}_{j} = 2\\pi \\delta_{ij}$, determine the Cartesian coordinates (expressed in units of $2\\pi/a$) of the high-symmetry points along the standard path $\\Gamma - X - W - L$ in the first Brillouin zone, where the points are defined by their fractional coordinates in the primitive reciprocal basis $\\{\\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3}\\}$ as:\n- $\\Gamma = (0, 0, 0)$,\n- $X = \\left(0, \\frac{1}{2}, \\frac{1}{2}\\right)$,\n- $W = \\left(\\frac{1}{2}, \\frac{1}{4}, \\frac{3}{4}\\right)$,\n- $L = \\left(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}\\right)$.\n\nReport your final answer as a single row matrix containing the components $(k_{x}, k_{y}, k_{z})$ in this order for the points $\\Gamma, X, W, L$ concatenated, with no units. No numerical rounding is required.", "solution": "The problem statement has been validated and is deemed valid. It is a standard problem in solid-state physics that is scientifically grounded, well-posed, and objective. All necessary data and definitions are provided for a unique solution.\n\nThe task is to determine the Cartesian coordinates of several high-symmetry points in the first Brillouin zone of a face-centered cubic (FCC) lattice. The points are given by their fractional coordinates $(c_1, c_2, c_3)$ in the basis of the primitive reciprocal lattice vectors $\\{\\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3}\\}$. A general wavevector $\\mathbf{k}$ is expressed in this basis as:\n$$\n\\mathbf{k} = c_{1}\\mathbf{b}_{1} + c_{2}\\mathbf{b}_{2} + c_{3}\\mathbf{b}_{3}\n$$\nTo find the Cartesian representation of $\\mathbf{k}$, we must first determine the Cartesian components of the primitive reciprocal lattice vectors $\\mathbf{b}_{i}$. These are defined by the relation $\\mathbf{b}_{i} \\cdot \\mathbf{a}_{j} = 2\\pi \\delta_{ij}$, where $\\mathbf{a}_{j}$ are the primitive real-space lattice vectors and $\\delta_{ij}$ is the Kronecker delta.\n\nThe primitive real-space lattice vectors are given as:\n$$\n\\mathbf{a}_{1} = \\frac{a}{2}(0, 1, 1), \\quad \\mathbf{a}_{2} = \\frac{a}{2}(1, 0, 1), \\quad \\mathbf{a}_{3} = \\frac{a}{2}(1, 1, 0)\n$$\nThe reciprocal lattice vectors can be calculated using the formula:\n$$\n\\mathbf{b}_{1} = 2\\pi \\frac{\\mathbf{a}_{2} \\times \\mathbf{a}_{3}}{V}, \\quad \\mathbf{b}_{2} = 2\\pi \\frac{\\mathbf{a}_{3} \\times \\mathbf{a}_{1}}{V}, \\quad \\mathbf{b}_{3} = 2\\pi \\frac{\\mathbf{a}_{1} \\times \\mathbf{a}_{2}}{V}\n$$\nwhere $V = \\mathbf{a}_{1} \\cdot (\\mathbf{a}_{2} \\times \\mathbf{a}_{3})$ is the volume of the primitive unit cell.\n\nFirst, we compute the volume $V$. We start with the cross product $\\mathbf{a}_{2} \\times \\mathbf{a}_{3}$:\n$$\n\\mathbf{a}_{2} \\times \\mathbf{a}_{3} = \\left(\\frac{a}{2}\\right)^{2} \\begin{vmatrix} \\mathbf{\\hat{x}}  \\mathbf{\\hat{y}}  \\mathbf{\\hat{z}} \\\\ 1  0  1 \\\\ 1  1  0 \\end{vmatrix} = \\frac{a^{2}}{4} \\left( (0 \\cdot 0 - 1 \\cdot 1)\\mathbf{\\hat{x}} - (1 \\cdot 0 - 1 \\cdot 1)\\mathbf{\\hat{y}} + (1 \\cdot 1 - 0 \\cdot 1)\\mathbf{\\hat{z}} \\right) = \\frac{a^{2}}{4}(-1, 1, 1)\n$$\nNow, we compute the scalar triple product to find the volume $V$:\n$$\nV = \\mathbf{a}_{1} \\cdot (\\mathbf{a}_{2} \\times \\mathbf{a}_{3}) = \\frac{a}{2}(0, 1, 1) \\cdot \\frac{a^{2}}{4}(-1, 1, 1) = \\frac{a^{3}}{8} (0 \\cdot (-1) + 1 \\cdot 1 + 1 \\cdot 1) = \\frac{a^{3}}{8}(2) = \\frac{a^{3}}{4}\n$$\nWith the volume, we can now find the reciprocal lattice vectors. For $\\mathbf{b}_{1}$:\n$$\n\\mathbf{b}_{1} = 2\\pi \\frac{\\frac{a^{2}}{4}(-1, 1, 1)}{\\frac{a^{3}}{4}} = \\frac{2\\pi}{a}(-1, 1, 1)\n$$\nBy cyclic permutation of indices ($1 \\to 2$, $2 \\to 3$, $3 \\to 1$), we find $\\mathbf{b}_{2}$ and $\\mathbf{b}_{3}$:\n$$\n\\mathbf{a}_{3} \\times \\mathbf{a}_{1} = \\frac{a^{2}}{4}(1, -1, 1) \\implies \\mathbf{b}_{2} = 2\\pi \\frac{\\frac{a^{2}}{4}(1, -1, 1)}{\\frac{a^{3}}{4}} = \\frac{2\\pi}{a}(1, -1, 1)\n$$\n$$\n\\mathbf{a}_{1} \\times \\mathbf{a}_{2} = \\frac{a^{2}}{4}(1, 1, -1) \\implies \\mathbf{b}_{3} = 2\\pi \\frac{\\frac{a^{2}}{4}(1, 1, -1)}{\\frac{a^{3}}{4}} = \\frac{2\\pi}{a}(1, 1, -1)\n$$\nSo, the primitive reciprocal lattice vectors in Cartesian coordinates are:\n$$\n\\mathbf{b}_{1} = \\frac{2\\pi}{a}(-1, 1, 1), \\quad \\mathbf{b}_{2} = \\frac{2\\pi}{a}(1, -1, 1), \\quad \\mathbf{b}_{3} = \\frac{2\\pi}{a}(1, 1, -1)\n$$\nWe are asked to express the coordinates of the high-symmetry points in units of $2\\pi/a$. Let $\\mathbf{k} = (k_x, k_y, k_z)$. The required output is the vector $(k_x, k_y, k_z) / (2\\pi/a)$. This is equivalent to calculating $\\mathbf{k}' = \\mathbf{k} \\frac{a}{2\\pi}$.\n$$\n\\mathbf{k}' = c_{1} \\left(\\frac{a}{2\\pi}\\mathbf{b}_{1}\\right) + c_{2} \\left(\\frac{a}{2\\pi}\\mathbf{b}_{2}\\right) + c_{3} \\left(\\frac{a}{2\\pi}\\mathbf{b}_{3}\\right)\n$$\nLet us define the scaled basis vectors $\\mathbf{b}'_{i} = \\frac{a}{2\\pi}\\mathbf{b}_{i}$:\n$$\n\\mathbf{b}'_{1} = (-1, 1, 1), \\quad \\mathbf{b}'_{2} = (1, -1, 1), \\quad \\mathbf{b}'_{3} = (1, 1, -1)\n$$\nNow we compute the coordinates for each high-symmetry point.\n\n$\\Gamma$-point: $(c_1, c_2, c_3) = (0, 0, 0)$\n$$\n\\mathbf{k}'_{\\Gamma} = 0 \\cdot \\mathbf{b}'_{1} + 0 \\cdot \\mathbf{b}'_{2} + 0 \\cdot \\mathbf{b}'_{3} = (0, 0, 0)\n$$\n\n$X$-point: $(c_1, c_2, c_3) = (0, \\frac{1}{2}, \\frac{1}{2})$\n$$\n\\mathbf{k}'_{X} = 0 \\cdot \\mathbf{b}'_{1} + \\frac{1}{2} \\cdot \\mathbf{b}'_{2} + \\frac{1}{2} \\cdot \\mathbf{b}'_{3} = \\frac{1}{2}(1, -1, 1) + \\frac{1}{2}(1, 1, -1) = \\left(\\frac{1}{2}+\\frac{1}{2}, -\\frac{1}{2}+\\frac{1}{2}, \\frac{1}{2}-\\frac{1}{2}\\right) = (1, 0, 0)\n$$\n\n$W$-point: $(c_1, c_2, c_3) = (\\frac{1}{2}, \\frac{1}{4}, \\frac{3}{4})$\n$$\n\\mathbf{k}'_{W} = \\frac{1}{2}\\mathbf{b}'_{1} + \\frac{1}{4}\\mathbf{b}'_{2} + \\frac{3}{4}\\mathbf{b}'_{3} = \\frac{1}{2}(-1, 1, 1) + \\frac{1}{4}(1, -1, 1) + \\frac{3}{4}(1, 1, -1)\n$$\nThe components are:\n$k'_{W,x} = -\\frac{1}{2} + \\frac{1}{4} + \\frac{3}{4} = \\frac{-2+1+3}{4} = \\frac{2}{4} = \\frac{1}{2}$\n$k'_{W,y} = \\frac{1}{2} - \\frac{1}{4} + \\frac{3}{4} = \\frac{2-1+3}{4} = \\frac{4}{4} = 1$\n$k'_{W,z} = \\frac{1}{2} + \\frac{1}{4} - \\frac{3}{4} = \\frac{2+1-3}{4} = 0$\nSo, $\\mathbf{k}'_{W} = (\\frac{1}{2}, 1, 0)$.\n\n$L$-point: $(c_1, c_2, c_3) = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$\n$$\n\\mathbf{k}'_{L} = \\frac{1}{2}\\mathbf{b}'_{1} + \\frac{1}{2}\\mathbf{b}'_{2} + \\frac{1}{2}\\mathbf{b}'_{3} = \\frac{1}{2} \\left( (-1, 1, 1) + (1, -1, 1) + (1, 1, -1) \\right)\n$$\nSumming the components inside the parenthesis:\n$x: -1+1+1 = 1$\n$y: 1-1+1 = 1$\n$z: 1+1-1 = 1$\nSo, $\\mathbf{k}'_{L} = \\frac{1}{2}(1, 1, 1) = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$.\n\nThe Cartesian coordinates in units of $2\\pi/a$ are:\n$\\Gamma: (0, 0, 0)$\n$X: (1, 0, 0)$\n$W: (\\frac{1}{2}, 1, 0)$\n$L: (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$\n\nThe final answer requires these components concatenated into a single row matrix.", "answer": "$$\\boxed{\\begin{pmatrix} 0  0  0  1  0  0  \\frac{1}{2}  1  0  \\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}$$", "id": "2456762"}, {"introduction": "Computational studies often employ supercells—multiples of the primitive unit cell—to model defects, surfaces, or complex structures. This choice of a larger real-space cell shrinks the Brillouin zone, causing the electronic bands to 'fold' in on themselves, which can lead to seemingly paradoxical results. This critical thinking exercise ([@problem_id:2456708]) explores this 'band folding' phenomenon, a vital concept for correctly interpreting the output of modern electronic structure calculations.", "problem": "A periodic Density Functional Theory (DFT) calculation on crystalline silicon uses a $2 \\times 2 \\times 1$ real-space supercell and a $\\Gamma$-only sampling of the supercell Brillouin zone. The resulting band structure appears to show a direct band gap at $\\Gamma$, despite the well-established indirect band gap of silicon, whose conduction-band minima reside at the $\\Delta$ valleys along $\\langle 100 \\rangle$ at crystal momenta near $0.85$ of the $\\Gamma$–$X$ distance in the primitive cell.\n\nStarting from Bloch’s theorem (that crystal eigenstates are labeled by crystal momentum $\\mathbf{k}$ modulo reciprocal lattice vectors) and the definition of the reciprocal lattice (with primitive direct lattice vectors $\\{\\mathbf{a}_i\\}$ and reciprocal vectors $\\{\\mathbf{b}_i\\}$ satisfying $\\mathbf{b}_i \\cdot \\mathbf{a}_j = 2\\pi \\delta_{ij}$), reason how changing to a $2 \\times 2 \\times 1$ supercell alters the Brillouin zone and the labeling of states by $\\mathbf{k}$. Then use this to explain why a direct gap may appear at the supercell $\\Gamma$ point even though silicon is an indirect-gap semiconductor in its primitive description.\n\nWhich option best resolves this apparent contradiction?\n\nA. In a $2 \\times 2 \\times 1$ supercell, the reciprocal lattice vectors along the doubled directions are halved in magnitude, so primitive-cell states at different $\\mathbf{k}$ that differ by supercell reciprocal vectors become labeled by the same supercell wavevector. The $\\Delta$-valley states of silicon at finite $\\mathbf{k}$ fold into the smaller supercell Brillouin zone and can appear at or very near $\\Gamma$; a $\\Gamma$-only supercell calculation is equivalent to a $2 \\times 2 \\times 1$ uniform grid in the primitive cell, so the lowest folded conduction state shows up at supercell $\\Gamma$. The fundamental gap remains indirect when referred to the primitive Brillouin zone.\n\nB. The larger supercell enforces $\\mathbf{k} = \\mathbf{0}$ selection rules for electronic transitions, eliminating the need for phonons and converting the indirect gap of silicon into a truly direct gap at $\\Gamma$.\n\nC. Increasing the real-space cell size increases the size of the Brillouin zone, so the true conduction minimum is brought to $\\Gamma$ with improved reciprocal-space resolution, revealing the direct gap.\n\nD. Band folding cannot move states toward $\\Gamma$ unless all three lattice vectors are doubled; therefore a $2 \\times 2 \\times 1$ supercell cannot fold indirect valleys to $\\Gamma$, so the observed direct gap must be genuine.", "solution": "The problem statement is scientifically sound and well-posed. It describes a common phenomenon in computational solid-state physics known as band folding, which arises when using a supercell representation. We shall analyze the problem from first principles.\n\nLet the primitive direct lattice vectors of the crystal be $\\{\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3\\}$. The corresponding primitive reciprocal lattice vectors $\\{\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3\\}$ are defined by the relation $\\mathbf{b}_i \\cdot \\mathbf{a}_j = 2\\pi \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. According to Bloch's theorem, the electronic eigenstates $\\psi_{\\mathbf{k},n}$ of the primitive crystal are labeled by a crystal momentum vector $\\mathbf{k}$ within the first Brillouin zone of the primitive lattice (PBZ), and a band index $n$. The energy eigenvalues are periodic in the reciprocal lattice, $E_n(\\mathbf{k}) = E_n(\\mathbf{k} + \\mathbf{G}_p)$, where $\\mathbf{G}_p$ is any vector of the primitive reciprocal lattice.\n\nA $2 \\times 2 \\times 1$ supercell is constructed with new, larger direct lattice vectors $\\{\\mathbf{A}_1, \\mathbf{A}_2, \\mathbf{A}_3\\}$:\n$$ \\mathbf{A}_1 = 2 \\mathbf{a}_1 $$\n$$ \\mathbf{A}_2 = 2 \\mathbf{a}_2 $$\n$$ \\mathbf{A}_3 = 1 \\mathbf{a}_3 = \\mathbf{a}_3 $$\nThe volume of this supercell is $V_S = |\\mathbf{A}_1 \\cdot (\\mathbf{A}_2 \\times \\mathbf{A}_3)| = |(2\\mathbf{a}_1) \\cdot (2\\mathbf{a}_2 \\times \\mathbf{a}_3)| = 4 |\\mathbf{a}_1 \\cdot (\\mathbf{a}_2 \\times \\mathbf{a}_3)| = 4V_p$, where $V_p$ is the volume of the primitive cell.\n\nThe reciprocal lattice of the supercell is defined by vectors $\\{\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3\\}$ satisfying $\\mathbf{B}_i \\cdot \\mathbf{A}_j = 2\\pi \\delta_{ij}$. Using the supercell direct lattice definitions, we can derive the supercell reciprocal vectors in terms of the primitive ones:\nFor $\\mathbf{B}_1$:\n$\\mathbf{B}_1 \\cdot \\mathbf{A}_1 = \\mathbf{B}_1 \\cdot (2\\mathbf{a}_1) = 2\\pi$\n$\\mathbf{B}_1 \\cdot \\mathbf{A}_2 = \\mathbf{B}_1 \\cdot (2\\mathbf{a}_2) = 0$\n$\\mathbf{B}_1 \\cdot \\mathbf{A}_3 = \\mathbf{B}_1 \\cdot (\\mathbf{a}_3) = 0$\nThese conditions imply that $\\mathbf{B}_1$ is parallel to $\\mathbf{b}_1$. Let $\\mathbf{B}_1 = c \\mathbf{b}_1$. Substituting into the first equation: $c\\mathbf{b}_1 \\cdot (2\\mathbf{a}_1) = 2c(\\mathbf{b}_1 \\cdot \\mathbf{a}_1) = 2c(2\\pi) = 2\\pi$, which gives $c = 1/2$. Thus, $\\mathbf{B}_1 = \\frac{1}{2}\\mathbf{b}_1$.\nSimilarly, we find:\n$$ \\mathbf{B}_1 = \\frac{1}{2}\\mathbf{b}_1 $$\n$$ \\mathbf{B}_2 = \\frac{1}{2}\\mathbf{b}_2 $$\n$$ \\mathbf{B}_3 = \\mathbf{b}_3 $$\nThe supercell reciprocal lattice vectors along the expanded real-space directions are halved in magnitude. This means the supercell Brillouin zone (SBZ) is smaller, specifically having $1/4$ the volume of the PBZ.\n\nDue to the smaller SBZ, the band structure of the primitive cell is \"folded\" into it. A state with crystal momentum $\\mathbf{k}$ in the PBZ is relabeled in the supercell scheme by a vector $\\mathbf{k}_S$ in the SBZ, according to the relation:\n$$ \\mathbf{k} = \\mathbf{k}_S + \\mathbf{G}_S $$\nwhere $\\mathbf{G}_S = M_1 \\mathbf{B}_1 + M_2 \\mathbf{B}_2 + M_3 \\mathbf{B}_3$ is a reciprocal lattice vector of the supercell for integers $M_1, M_2, M_3$. This means that multiple, distinct $\\mathbf{k}$-points from the PBZ are mapped (folded) to the same $\\mathbf{k}_S$ point in the SBZ.\n\nThe problem states that a $\\Gamma$-only sampling of the supercell Brillouin zone is used. This means the calculation is performed only at $\\mathbf{k}_S = \\mathbf{0}$ (the $\\Gamma$ point of the SBZ). From the folding relation, this calculation effectively samples all states from the primitive cell whose crystal momentum $\\mathbf{k}$ is equal to a supercell reciprocal lattice vector:\n$$ \\mathbf{k} = \\mathbf{G}_S $$\nThis is equivalent to performing a primitive cell calculation on a $2 \\times 2 \\times 1$ uniform grid of $\\mathbf{k}$-points in the PBZ.\n\nFor silicon, the valence band maximum (VBM) is at the $\\Gamma$ point of the PBZ, i.e., at $\\mathbf{k} = \\mathbf{0}$. Since $\\mathbf{k}=\\mathbf{0}$ corresponds to $\\mathbf{G}_S = \\mathbf{0}$ (with $M_1=M_2=M_3=0$), the VBM state is always included in a $\\Gamma$-only supercell calculation.\nThe conduction band minimum (CBM) of silicon, however, is located at a finite crystal momentum $\\mathbf{k}_{\\text{CBM}} \\neq \\mathbf{0}$, along the $\\Gamma-X$ directions, making the fundamental band gap indirect. Specifically, $\\mathbf{k}_{\\text{CBM}} \\approx 0.85 \\mathbf{k}_X$, where $\\mathbf{k}_X$ is the vector to the $X$ point.\n\nIn the supercell calculation at $\\mathbf{k}_S = \\mathbf{0}$, the energies of all states at primitive-cell k-points $\\mathbf{k} = \\mathbf{G}_S$ are computed. The lowest energy among the resulting conduction band states will be taken as the supercell's CBM. One of the supercell reciprocal lattice vectors is, for example, $\\mathbf{G}_S = 1 \\cdot \\mathbf{B}_1 + 0 \\cdot \\mathbf{B}_2 + 0 \\cdot \\mathbf{B}_3 = \\frac{1}{2}\\mathbf{b}_1$. This k-point corresponds to the $X$ point of the PBZ (assuming an orthorhombic setup for simplicity). Although the true CBM at $\\approx 0.85 \\mathbf{k}_X$ is not perfectly sampled, the nearby $X$ point is. The energy at the $X$ point, $E_c(\\mathbf{k}_X)$, is typically much lower than the energy at the $\\Gamma$ point, $E_c(\\mathbf{k}_\\Gamma)$.\nTherefore, the supercell calculation finds a VBM corresponding to the PBZ $\\Gamma$ point and a CBM corresponding to a state whose PBZ wavevector is a non-zero $\\mathbf{k} = \\mathbf{G}_S$ (e.g., near an $X$ point). Since both the VBM state (from $\\mathbf{k}=\\mathbf{0}$) and this CBM state (from $\\mathbf{k}=\\mathbf{G}_S$) are folded to the same point $\\mathbf{k}_S = \\mathbf{0}$ in the SBZ, the transition between them has $\\Delta \\mathbf{k}_S = 0$. This makes the band gap appear direct in the supercell band structure. The underlying physical band structure of the primitive cell is unchanged, and the fundamental gap of silicon remains indirect.\n\nNow we evaluate the given options:\n\n**A.** This option correctly states that the reciprocal lattice vectors are halved in the doubled directions, causing states at different primitive-cell $\\mathbf{k}$-points to be mapped to the same supercell wavevector (band folding). It correctly identifies that the $\\Delta$-valley (CBM) states fold into the smaller SBZ and can appear at or near the supercell $\\Gamma$ point. It correctly equates a $\\Gamma$-only supercell calculation with a $2 \\times 2 \\times 1$ grid in the primitive cell, which leads to the lowest folded conduction state appearing at the supercell $\\Gamma$. Finally, it correctly asserts that the fundamental gap remains indirect when referenced to the primitive cell. This explanation is entirely consistent with our derivation. **Correct**.\n\n**B.** This option incorrectly claims that the supercell \"converts\" the indirect gap into a \"truly direct gap.\" The use of a supercell is a mathematical device for computation; it does not alter the intrinsic physical properties of the material. The gap of silicon is physically indirect, and optical transitions across the fundamental gap still require phonon assistance. This statement is scientifically unsound. **Incorrect**.\n\n**C.** This option makes the factually incorrect statement that increasing the real-space cell size *increases* the size of the Brillouin zone. The relationship is inverse: a larger real-space cell corresponds to a smaller Brillouin zone. The reasoning that follows from this false premise is therefore invalid. **Incorrect**.\n\n**D.** This option falsely claims that band folding requires all three lattice vectors to be increased. Folding occurs along any direction in which the real-space lattice vector is scaled up. A $2 \\times 2 \\times 1$ supercell certainly causes folding. The conclusion that the observed direct gap must be \"genuine\" is based on this false premise and is wrong; the gap appears direct due to the calculational artifact of folding. **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "2456708"}, {"introduction": "The core practical challenge in any periodic calculation is determining an adequate k-point sampling density. How many k-points are enough? This computational exercise ([@problem_id:2462531]) provides a direct and quantitative answer by comparing the convergence of total energy for a model metal and a model insulator. By implementing this test, you will develop a robust intuition for why metallic systems, with their sharp Fermi surfaces, demand significantly more computational effort than gapped systems.", "problem": "You will compare the convergence of $k$-point sampling density for the total energy per unit cell in a one-dimensional tight-binding model that mimics a metal (aluminum-like) and an insulator (silicon-like). The comparison must be based strictly on Brillouin Zone (BZ) integration at zero temperature using uniform $k$-point sampling. All angles are in radians, and all energies must be expressed in electronvolts per unit cell ($e\\mathrm{V}$/cell).\n\nDefine the one-dimensional BZ as the interval $[-\\pi,\\pi)$. For a given positive integer $N_k$, define a uniform midpoint grid with points\n$$\nk_i \\;=\\; -\\pi \\;+\\; \\left(i + \\tfrac{1}{2}\\right)\\Delta k,\\quad \\Delta k \\;=\\; \\frac{2\\pi}{N_k},\\quad i \\in \\{0,1,\\ldots,N_k-1\\}.\n$$\nAt zero temperature, the total energy per unit cell is defined by the BZ integral\n$$\nE_{\\text{tot}} \\;=\\; \\frac{2}{2\\pi} \\int_{-\\pi}^{\\pi} \\sum_{n} E_n(k)\\, \\Theta\\!\\bigl(E_F - E_n(k)\\bigr)\\, \\mathrm{d}k,\n$$\nwhere the factor $2$ accounts for spin degeneracy, $E_n(k)$ are the band energies, $\\Theta(x)$ is the Heaviside step function, and $E_F$ is the Fermi energy. The discrete $k$-point approximation on the uniform grid is the Riemann sum\n$$\nE_{\\text{tot}}(N_k) \\;=\\; \\frac{2}{N_k} \\sum_{i=0}^{N_k-1} \\sum_{n} E_n(k_i)\\, \\Theta\\!\\bigl(E_F - E_n(k_i)\\bigr).\n$$\n\nConsider the following two systems with lattice constant set to $a = 1$:\n\n1. Metallic chain (Al-like, single-band): A single nearest-neighbor tight-binding band\n$$\nE_{\\mathrm{m}}(k) \\;=\\; -2t\\cos(k),\n$$\nwith hopping parameter $t = 1.0\\ e\\mathrm{V}$ and Fermi energy $E_F = 0.0\\ e\\mathrm{V}$ (half filling).\n\n2. Dimerized insulating chain (Si-like, two-band): A two-atom basis with onsite potential offset $\\Delta$ and nearest-neighbor hopping $t$, described by the two-band dispersion\n$$\nE_{\\pm}(k) \\;=\\; \\pm \\sqrt{\\Delta^2 + 4t^2\\cos^2(k)},\n$$\nwith $t = 1.0\\ e\\mathrm{V}$ and $\\Delta = 1.0\\ e\\mathrm{V}$. The lower band $E_{-}(k)$ is completely filled, and the upper band $E_{+}(k)$ is empty at zero temperature.\n\nFor each system, define the highly converged reference energy $E_{\\text{ref}}$ as the discrete $k$-point approximation $E_{\\text{tot}}(N_{\\text{ref}})$ with\n$$\nN_{\\text{ref}} \\;=\\; 65536.\n$$\n\nTask:\n- For each $N_k$ in the test suite below, compute the absolute error in $e\\mathrm{V}$/cell between $E_{\\text{tot}}(N_k)$ and $E_{\\text{ref}}$ for the metallic chain and for the insulating chain, respectively.\n- Use the following test suite of $k$-point counts:\n$$\n\\bigl[N_k\\bigr] \\;=\\; \\bigl[5,\\,10,\\,20,\\,40,\\,80,\\,160\\bigr].\n$$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The list must contain the errors in the following order: for each $N_k$ in the given order, first the metallic-chain error, then the insulating-chain error, before moving to the next $N_k$. For example, the output must be of the form\n$$\n\\bigl[\\; \\lvert E_{\\text{tot}}^{\\mathrm{m}}(5) - E_{\\text{ref}}^{\\mathrm{m}} \\rvert,\\; \\lvert E_{\\text{tot}}^{\\mathrm{i}}(5) - E_{\\text{ref}}^{\\mathrm{i}} \\rvert,\\; \\lvert E_{\\text{tot}}^{\\mathrm{m}}(10) - E_{\\text{ref}}^{\\mathrm{m}} \\rvert,\\; \\ldots,\\; \\lvert E_{\\text{tot}}^{\\mathrm{i}}(160) - E_{\\text{ref}}^{\\mathrm{i}} \\rvert \\;\\bigr],\n$$\nwhere superscripts $\\mathrm{m}$ and $\\mathrm{i}$ denote metallic and insulating systems, respectively. All values must be floats in $e\\mathrm{V}$/cell.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of solid-state physics, specifically the tight-binding model and Brillouin Zone integration. It is well-posed, with all necessary parameters and equations provided, leading to a unique, computable solution. All terms are defined unambiguously, and there are no contradictions or factual errors.\n\nThe task is to compare the convergence of the total energy calculation with respect to the density of $k$-point sampling for a one-dimensional metallic and an insulating system. The total energy per unit cell at zero temperature, $T=0$, is given by the integral of occupied band energies over the first Brillouin Zone (BZ), defined here as the interval $[-\\pi, \\pi)$. Including spin degeneracy, this is:\n$$\nE_{\\text{tot}} \\;=\\; \\frac{2}{2\\pi} \\int_{-\\pi}^{\\pi} \\sum_{n} E_n(k)\\, \\Theta\\!\\bigl(E_F - E_n(k)\\bigr)\\, \\mathrm{d}k\n$$\nwhere $E_n(k)$ are the energy bands, $E_F$ is the Fermi energy, and $\\Theta(x)$ is the Heaviside step function which is $1$ for $x  0$ and $0$ for $x \\le 0$. The lattice constant is set to $a=1$.\n\nWe approximate this integral using a Riemann sum over a uniform midpoint grid of $N_k$ points. The $k$-points are given by:\n$$\nk_i \\;=\\; -\\pi \\;+\\; \\left(i + \\tfrac{1}{2}\\right)\\Delta k, \\quad \\text{where} \\quad \\Delta k \\;=\\; \\frac{2\\pi}{N_k} \\quad \\text{for} \\quad i \\in \\{0, 1, \\ldots, N_k-1\\}\n$$\nThe discrete approximation for the total energy is then:\n$$\nE_{\\text{tot}}(N_k) \\;=\\; \\frac{2}{N_k} \\sum_{i=0}^{N_k-1} \\sum_{n} E_n(k_i)\\, \\Theta\\!\\bigl(E_F - E_n(k_i)\\bigr)\n$$\nThe factor $2/N_k$ arises from the spin degeneracy factor of $2$ and the integral approximation $\\int \\mathrm{d}k \\approx \\sum_i \\Delta k = \\sum_i \\frac{2\\pi}{N_k}$, with the $2\\pi$ factor cancelling that in the continuous expression's prefactor.\n\nWe analyze two systems:\n\n1.  **Metallic Chain**: This system is described by a single band with dispersion $E_{\\mathrm{m}}(k) = -2t\\cos(k)$, where the hopping parameter is $t = 1.0\\ e\\mathrm{V}$. The Fermi energy is $E_F = 0.0\\ e\\mathrm{V}$. For the energy sum, we only include states where $E_{\\mathrm{m}}(k_i)  E_F$. This condition is $-2t\\cos(k_i)  0$, which simplifies to $\\cos(k_i)  0$. The integrand, $E_{\\mathrm{m}}(k)\\Theta(-E_{\\mathrm{m}}(k))$, has discontinuities at the Fermi surface, where $k = \\pm\\pi/2$. The convergence of the Riemann sum for a discontinuous function is known to be slow. The error typically scales as $O(1/N_k)$. The total energy for a given $N_k$ is:\n    $$\n    E_{\\text{tot}}^{\\mathrm{m}}(N_k) \\;=\\; \\frac{2}{N_k} \\sum_{i=0}^{N_k-1} E_{\\mathrm{m}}(k_i)\\, \\Theta\\bigl(- E_{\\mathrm{m}}(k_i)\\bigr)\n    $$\n\n2.  **Insulating Chain**: This system is described by a two-band model with energies $E_{\\pm}(k) = \\pm\\sqrt{\\Delta^2 + 4t^2\\cos^2(k)}$, with parameters $t = 1.0\\ e\\mathrm{V}$ and $\\Delta = 1.0\\ e\\mathrm{V}$. The problem states that the lower band, $E_{-}(k)$, is completely filled, and the upper band, $E_{+}(k)$, is completely empty. This defines an insulator. This physical situation corresponds to the Fermi energy $E_F$ lying within the band gap. The band gap exists for all $k$ between $\\max(E_-(k)) = -\\Delta = -1.0\\ e\\mathrm{V}$ and $\\min(E_+(k)) = \\Delta = 1.0\\ e\\mathrm{V}$. Therefore, we can set $E_F=0.0\\ e\\mathrm{V}$, for which $\\Theta(E_F - E_{+}(k_i)) = 0$ and $\\Theta(E_F - E_{-}(k_i)) = 1$ for all $k_i$. The sum over bands simplifies to a sum over only the lower band, $E_{-}(k)$. The total energy is:\n    $$\n    E_{\\text{tot}}^{\\mathrm{i}}(N_k) \\;=\\; \\frac{2}{N_k} \\sum_{i=0}^{N_k-1} E_{-}(k_i)\n    $$\n    In this case, the integrand, $E_{-}(k)$, is a smooth, analytic, and periodic function over the entire Brillouin Zone. The numerical integration of such a function using the midpoint rule (or trapezoidal rule, which is equivalent for periodic functions) converges exponentially fast.\n\nThe core of the problem is to numerically demonstrate this difference in convergence behavior. We compute a highly accurate reference energy, $E_{\\text{ref}}$, for each system using a dense grid with $N_{\\text{ref}} = 65536$. Then, for a set of smaller $N_k$ values, we calculate the absolute error $|E_{\\text{tot}}(N_k) - E_{\\text{ref}}|$. As predicted, the error for the insulating system will decrease much more rapidly with increasing $N_k$ than for the metallic system. This principle is fundamental to computational materials science, dictating that metallic systems require significantly denser $k$-point meshes for accurate property calculations than insulating or semiconducting systems.\n\nThe following algorithm will be implemented:\n1.  Define a function to compute $E_{\\text{tot}}(N_k)$ for each system type.\n2.  Calculate $E_{\\text{ref}}^{\\mathrm{m}}$ and $E_{\\text{ref}}^{\\mathrm{i}}$ using $N_k = 65536$.\n3.  Iterate through the specified list of $N_k$ values: $[5, 10, 20, 40, 80, 160]$.\n4.  In each iteration, compute $E_{\\text{tot}}^{\\mathrm{m}}(N_k)$ and $E_{\\text{tot}}^{\\mathrm{i}}(N_k)$.\n5.  Calculate the absolute errors $|E_{\\text{tot}}^{\\mathrm{m}}(N_k) - E_{\\text{ref}}^{\\mathrm{m}}|$ and $|E_{\\text{tot}}^{\\mathrm{i}}(N_k) - E_{\\text{ref}}^{\\mathrm{i}}|$.\n6.  Collect and format the results as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_total_energy(Nk, system_type, t, delta, ef):\n    \"\"\"\n    Calculates the total energy per unit cell for a 1D tight-binding model.\n\n    Args:\n        Nk (int): The number of k-points in the uniform grid.\n        system_type (str): 'metal' or 'insulator'.\n        t (float): Hopping parameter in eV.\n        delta (float): Onsite potential offset for the insulator in eV.\n        ef (float): Fermi energy in eV.\n\n    Returns:\n        float: The calculated total energy per unit cell in eV.\n    \"\"\"\n    # Define the uniform midpoint k-point grid in the BZ [-pi, pi)\n    # k_i = -pi + (i + 0.5) * (2*pi/Nk)\n    k_points = -np.pi + (np.arange(Nk) + 0.5) * (2.0 * np.pi / Nk)\n\n    if system_type == 'metal':\n        # Single-band model: E_m(k) = -2*t*cos(k)\n        band_energies = -2.0 * t * np.cos(k_points)\n        \n        # Apply Heaviside step function: sum energies of occupied states (E  E_F)\n        # In the sum, E_n(k) * Theta(E_F - E_n(k)), terms with E_n(k) = E_F are zero.\n        occupied_energies = np.where(band_energies  ef, band_energies, 0.0)\n        \n        # Total energy is the normalized sum of occupied energies\n        total_energy = (2.0 / Nk) * np.sum(occupied_energies)\n\n    elif system_type == 'insulator':\n        # Two-band model: E_pm(k) = +/- sqrt(delta^2 + 4t^2*cos^2(k))\n        # The lower band E_-(k) is fully occupied, the upper band E_+(k) is empty.\n        # We only need to sum over the lower band.\n        cos_k_sq = np.cos(k_points)**2\n        lower_band_energies = -np.sqrt(delta**2 + 4.0 * t**2 * cos_k_sq)\n        \n        # Total energy is the normalized sum over the entire lower band\n        total_energy = (2.0 / Nk) * np.sum(lower_band_energies)\n        \n    else:\n        raise ValueError(\"Invalid system_type specified. Must be 'metal' or 'insulator'.\")\n\n    return total_energy\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem as stated.\n    \"\"\"\n    # Define model parameters from the problem statement\n    t_param = 1.0  # Hopping parameter in eV\n    delta_param = 1.0  # Onsite potential offset in eV\n    ef_param = 0.0  # Fermi energy in eV\n\n    # Define k-point grid parameters\n    Nk_ref = 65536\n    test_suite_nk = [5, 10, 20, 40, 80, 160]\n\n    # Calculate the highly converged reference energies\n    E_ref_m = calculate_total_energy(Nk_ref, 'metal', t=t_param, delta=delta_param, ef=ef_param)\n    E_ref_i = calculate_total_energy(Nk_ref, 'insulator', t=t_param, delta=delta_param, ef=ef_param)\n\n    results = []\n    # Loop over the test suite of Nk values\n    for Nk in test_suite_nk:\n        # --- Metallic Chain ---\n        # Calculate total energy for the current Nk\n        E_tot_m_Nk = calculate_total_energy(Nk, 'metal', t=t_param, delta=delta_param, ef=ef_param)\n        # Compute the absolute error\n        error_m = np.abs(E_tot_m_Nk - E_ref_m)\n        results.append(error_m)\n\n        # --- Insulating Chain ---\n        # Calculate total energy for the current Nk\n        E_tot_i_Nk = calculate_total_energy(Nk, 'insulator', t=t_param, delta=delta_param, ef=ef_param)\n        # Compute the absolute error\n        error_i = np.abs(E_tot_i_Nk - E_ref_i)\n        results.append(error_i)\n\n    # Print the final result in the specified format\n    # Example format: [err_m(5), err_i(5), err_m(10), err_i(10), ...]\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n\n```", "id": "2462531"}]}