{"hands_on_practices": [{"introduction": "To begin, let's ground our understanding of error in a tangible, physical context. This problem [@problem_id:2152061] models the work done by an expanding gas, a common scenario in thermodynamics. You will calculate the exact work using calculus and compare it to an estimate derived from a simple linear approximation, thereby computing the absolute error to quantify the inaccuracy of the shortcut.", "problem": "An engineer is analyzing the isothermal expansion of a gas in a piston-cylinder assembly. The work, $W$, performed by the gas as it expands from an initial volume $V_1$ to a final volume $V_2$ is given by the integral $W = \\int_{V_1}^{V_2} P(V) dV$, where $P(V)$ is the pressure of the gas as a function of its volume $V$.\n\nThe gas is modeled as an ideal gas, so its pressure follows the relation $P(V) = \\frac{nRT}{V}$, where $n$ is the number of moles of the gas, $R$ is the ideal gas constant, and $T$ is the absolute temperature. The expansion occurs under the following conditions:\n- Moles of gas, $n = 1.00$ mol\n- Ideal gas constant, $R = 8.314 \\, \\text{J/(mol}\\cdot\\text{K)}$\n- Constant temperature, $T = 300$ K\n- Initial volume, $V_1 = 0.0250 \\, \\text{m}^3$\n- Final volume, $V_2 = 0.0500 \\, \\text{m}^3$\n\nTo quickly estimate the work done, the engineer uses a linear approximation for the pressure. This approximation assumes the work can be estimated using the formula $W_{approx} = \\frac{1}{2}(P_1 + P_2)(V_2 - V_1)$, where $P_1$ and $P_2$ are the pressures at the initial volume $V_1$ and final volume $V_2$, respectively.\n\nCalculate the absolute error of this approximation, which is defined as the absolute difference between the exact work done and the approximated work. Express your answer in joules, rounded to three significant figures.", "solution": "The problem asks for the absolute error between the exact work done by an isothermally expanding ideal gas and an approximation of that work. The absolute error, $E_a$, is given by $E_a = |W_{exact} - W_{approx}|$.\n\nFirst, we calculate the exact work done, $W_{exact}$. The formula for work is $W = \\int_{V_1}^{V_2} P(V) dV$. For an ideal gas, $P(V) = \\frac{nRT}{V}$. Substituting this into the integral gives:\n$$W_{exact} = \\int_{V_1}^{V_2} \\frac{nRT}{V} dV$$\nSince $n$, $R$, and $T$ are constants, we can take them out of the integral:\n$$W_{exact} = nRT \\int_{V_1}^{V_2} \\frac{1}{V} dV$$\nEvaluating the integral of $\\frac{1}{V}$ gives the natural logarithm, $\\ln(V)$:\n$$W_{exact} = nRT \\left[ \\ln|V| \\right]_{V_1}^{V_2} = nRT (\\ln(V_2) - \\ln(V_1))$$\nUsing the properties of logarithms, this can be simplified to:\n$$W_{exact} = nRT \\ln\\left(\\frac{V_2}{V_1}\\right)$$\n\nNext, we calculate the approximated work, $W_{approx}$, using the provided formula:\n$$W_{approx} = \\frac{1}{2}(P_1 + P_2)(V_2 - V_1)$$\nHere, $P_1$ and $P_2$ are the pressures at volumes $V_1$ and $V_2$, respectively. Using the ideal gas law:\n$$P_1 = P(V_1) = \\frac{nRT}{V_1}$$\n$$P_2 = P(V_2) = \\frac{nRT}{V_2}$$\nSubstituting these expressions for pressure into the approximation formula:\n$$W_{approx} = \\frac{1}{2}\\left(\\frac{nRT}{V_1} + \\frac{nRT}{V_2}\\right)(V_2 - V_1)$$\nWe can factor out the constant term $nRT$:\n$$W_{approx} = \\frac{nRT}{2}\\left(\\frac{1}{V_1} + \\frac{1}{V_2}\\right)(V_2 - V_1)$$\nTo simplify the expression in the parentheses, we find a common denominator:\n$$W_{approx} = \\frac{nRT}{2}\\left(\\frac{V_2 + V_1}{V_1 V_2}\\right)(V_2 - V_1)$$\nRecognizing that $(V_2 + V_1)(V_2 - V_1) = V_2^2 - V_1^2$, we get:\n$$W_{approx} = \\frac{nRT}{2} \\frac{V_2^2 - V_1^2}{V_1 V_2}$$\n\nNow we can write the expression for the absolute error, $E_a$:\n$$E_a = |W_{exact} - W_{approx}| = \\left| nRT \\ln\\left(\\frac{V_2}{V_1}\\right) - \\frac{nRT}{2} \\frac{V_2^2 - V_1^2}{V_1 V_2} \\right|$$\nFactoring out $nRT$:\n$$E_a = nRT \\left| \\ln\\left(\\frac{V_2}{V_1}\\right) - \\frac{V_2^2 - V_1^2}{2V_1 V_2} \\right|$$\n\nNow, we substitute the given numerical values:\n$n = 1.00$ mol\n$R = 8.314 \\, \\text{J/(mol}\\cdot\\text{K)}$\n$T = 300$ K\n$V_1 = 0.0250 \\, \\text{m}^3$\n$V_2 = 0.0500 \\, \\text{m}^3$\n\nFirst, let's calculate the pre-factor $nRT$:\n$$nRT = (1.00 \\, \\text{mol}) \\times (8.314 \\, \\frac{\\text{J}}{\\text{mol}\\cdot\\text{K}}) \\times (300 \\, \\text{K}) = 2494.2 \\, \\text{J}$$\nNext, let's evaluate the terms inside the absolute value. The ratio of volumes is:\n$$\\frac{V_2}{V_1} = \\frac{0.0500 \\, \\text{m}^3}{0.0250 \\, \\text{m}^3} = 2$$\nSo the logarithmic term is $\\ln(2)$.\n\nFor the second term, we can substitute the volumes:\n$$\\frac{V_2^2 - V_1^2}{2V_1 V_2} = \\frac{(0.0500)^2 - (0.0250)^2}{2(0.0250)(0.0500)} = \\frac{0.0025 - 0.000625}{0.0025} = \\frac{0.001875}{0.0025} = 0.75$$\nAlternatively, using the symbolic ratio $V_2 = 2V_1$:\n$$\\frac{(2V_1)^2 - V_1^2}{2V_1 (2V_1)} = \\frac{4V_1^2 - V_1^2}{4V_1^2} = \\frac{3V_1^2}{4V_1^2} = \\frac{3}{4} = 0.75$$\n\nNow, substitute these values back into the expression for $E_a$:\n$$E_a = 2494.2 \\, \\text{J} \\times \\left| \\ln(2) - 0.75 \\right|$$\nUsing a calculator for $\\ln(2)$:\n$$\\ln(2) \\approx 0.693147$$\nSo the term in the absolute value is:\n$$|0.693147 - 0.75| = |-0.056853| = 0.056853$$\nFinally, calculate the absolute error:\n$$E_a = 2494.2 \\times 0.056853 \\approx 141.8105 \\, \\text{J}$$\n\nThe problem requires the answer to be rounded to three significant figures.\n$$E_a \\approx 142 \\, \\text{J}$$", "answer": "$$\\boxed{142}$$", "id": "2152061"}, {"introduction": "While absolute error provides a straightforward measure of discrepancy, it can sometimes be misleading. This exercise [@problem_id:2152049] explores a classic pitfall in numerical computation known as \"catastrophic cancellation,\" which occurs when subtracting two nearly identical numbers. By comparing two algebraically equivalent formulas in a simulated finite-precision environment, you will discover how a tiny absolute error can mask a disastrously large relative error, rendering a calculation useless.", "problem": "In a numerical simulation, a quantity of interest is calculated using the function $f(x) = \\sqrt{x+1} - \\sqrt{x}$ for large values of $x$. Due to potential numerical instability, an algebraically equivalent form $g(x) = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}}$ is also considered.\n\nSuppose the calculations are performed on a processor that uses six-digit rounding arithmetic. This means that after every arithmetic operation (addition, subtraction, multiplication, division, and square root), the result is rounded to six significant figures before the next operation is performed.\n\nLet $\\tilde{y}_f$ be the value computed for $f(x)$ and $\\tilde{y}_g$ be the value computed for $g(x)$ at $x = 1.2 \\times 10^5$. For the purpose of this analysis, treat the value $\\tilde{y}_g$ obtained from the more stable form as the correct reference value.\n\nCalculate the relative error of $\\tilde{y}_f$ with respect to $\\tilde{y}_g$. Express your final answer as a decimal rounded to four significant figures.", "solution": "We simulate six-digit rounding arithmetic after every operation. Let $x = 1.2 \\times 10^{5}$.\n\nCompute for $f(x) = \\sqrt{x+1} - \\sqrt{x}$:\n- Addition: $x+1 = 120000 + 1 = 120001$, which is already six significant figures.\n- Square roots (rounded to six significant figures each):\n  - $\\sqrt{120000} = 346.4101615\\ldots \\to 346.410$.\n  - $\\sqrt{120001} \\approx 346.411604886\\ldots \\to 346.412$.\n- Subtraction and rounding: $\\tilde{y}_{f} = 346.412 - 346.410 = 0.002$. Rounded to six significant figures, this is $0.00200000$, numerically $0.002$.\n\nCompute for $g(x) = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}}$:\n- Reuse the rounded square roots: $346.412$ and $346.410$.\n- Addition and rounding: $346.412 + 346.410 = 692.822$, which has six significant figures.\n- Division and rounding: $\\tilde{y}_{g} = \\frac{1}{692.822} \\approx 0.001443372\\ldots \\to 0.00144337$ (six significant figures).\n\nTreat $\\tilde{y}_{g}$ as the correct reference. The relative error of $\\tilde{y}_{f}$ with respect to $\\tilde{y}_{g}$ is\n$$\n\\text{RelErr} = \\frac{|\\tilde{y}_{f} - \\tilde{y}_{g}|}{|\\tilde{y}_{g}|}\n= \\frac{|0.002 - 0.00144337|}{0.00144337}\n= \\frac{0.00055663}{0.00144337} \\approx 0.385646\\ldots\n$$\nRounded to four significant figures, the relative error is $0.3856$.", "answer": "$$\\boxed{0.3856}$$", "id": "2152049"}, {"introduction": "Finally, let's explore a more advanced and counter-intuitive scenario that highlights the distinct behaviors of absolute and relative error. In this problem [@problem_id:3202469], you will design and analyze an iterative root-finding scheme. The challenge is to construct a sequence of approximations that demonstrably converges to the true root in terms of absolute error, yet simultaneously diverges when measured by relative error, forcing a deeper consideration of what constitutes \"good\" convergence.", "problem": "In numerical root-finding, let $x^{\\ast}$ denote the exact root of an equation $f(x)=0$. The absolute error at iteration $n$ is defined by $e_{n}^{\\mathrm{abs}}=|x_{n}-x^{\\ast}|$. A common computable surrogate for relative error, used when $x^{\\ast}$ is not known, is the relative change normalized by the current iterate, $e_{n}^{\\mathrm{rel}}=\\frac{|x_{n+1}-x_{n}|}{|x_{n+1}|}$. Starting from these core definitions, construct a scientifically consistent iterative scheme for a root-finding problem in which the sequence $\\{e_{n}^{\\mathrm{abs}}\\}$ converges while the sequence $\\{e_{n}^{\\mathrm{rel}}\\}$ diverges. Use the functional iteration generated from a well-tested formula $x_{n+1}=x_{n}-\\lambda f(x_{n})$ with a constant step parameter $\\lambda$ chosen to ensure consistency with the fixed point $x^{\\ast}$ and global scientific realism. Specifically, consider the nonlinear equation $f(x)=x-x^{2}$, which has roots at $x=0$ and $x=1$. Choose $\\lambda$ and an initial condition $x_{0}$ so that the iteration converges to the root $x^{\\ast}=0$ and exhibits the required error behavior. Prove, from first principles and the stated definitions, that the absolute error sequence converges while the computable relative error sequence diverges. Finally, determine the exact, closed-form expression for $x_{n}$ as a function of $n$ for the specific initial condition $x_{0}=\\frac{1}{2}$. Your final answer must be a single closed-form analytic expression.", "solution": "The problem requires the construction of a specific iterative scheme and the analysis of its error properties, followed by the derivation of a closed-form solution for the sequence of iterates.\n\nThe iterative scheme is given by the formula $x_{n+1} = x_{n} - \\lambda f(x_{n})$, which represents a form of functional iteration, $x_{n+1} = g(x_{n})$. The specified nonlinear function is $f(x) = x - x^{2}$, and the target root for convergence is $x^{\\ast} = 0$.\n\nFirst, we establish the explicit form of the iteration function, $g(x)$, by substituting $f(x)$ into the scheme:\n$$x_{n+1} = x_{n} - \\lambda(x_{n} - x_{n}^{2})$$\n$$x_{n+1} = x_{n} - \\lambda x_{n} + \\lambda x_{n}^{2}$$\n$$x_{n+1} = (1 - \\lambda)x_{n} + \\lambda x_{n}^{2}$$\nThis gives the iteration function as $g(x) = (1 - \\lambda)x + \\lambda x^{2}$.\n\nFor an iterative method of the form $x_{n+1} = g(x_{n})$ to converge to a fixed point $x^{\\ast}$, a sufficient condition is that the magnitude of the derivative of $g(x)$ evaluated at $x^{\\ast}$ is strictly less than one, i.e., $|g'(x^{\\ast})| < 1$. We calculate the derivative of $g(x)$:\n$$g'(x) = \\frac{d}{dx} \\left( (1 - \\lambda)x + \\lambda x^{2} \\right) = 1 - \\lambda + 2\\lambda x$$\nEvaluating this derivative at the target root $x^{\\ast} = 0$:\n$$g'(0) = 1 - \\lambda + 2\\lambda(0) = 1 - \\lambda$$\nThe condition for local convergence to $x^{\\ast}=0$ is $|1 - \\lambda| < 1$. This inequality can be written as $-1 < 1 - \\lambda < 1$, which solves to $0 < \\lambda < 2$.\n\nTo satisfy the problem's constraints, we must select a value of $\\lambda$ from this interval. A canonical choice that simplifies the analysis is $\\lambda = 1$. For this value, the convergence criterion is met, since $|g'(0)| = |1 - 1| = 0 < 1$. The iteration thus becomes:\n$$x_{n+1} = (1 - 1)x_{n} + (1)x_{n}^{2} = x_{n}^{2}$$\nThe problem specifies the initial condition $x_{0} = \\frac{1}{2}$. We proceed to find the closed-form expression for $x_{n}$ generated by this recurrence.\nFor $n=0$, $x_{0} = \\frac{1}{2}$.\nFor $n=1$, $x_{1} = x_{0}^{2} = \\left(\\frac{1}{2}\\right)^{2}$.\nFor $n=2$, $x_{2} = x_{1}^{2} = \\left(\\left(\\frac{1}{2}\\right)^{2}\\right)^{2} = \\left(\\frac{1}{2}\\right)^{4}$.\nBy induction, we can see the pattern is $x_{n} = x_{0}^{2^{n}}$. With $x_{0} = \\frac{1}{2}$, the closed-form expression is:\n$$x_{n} = \\left(\\frac{1}{2}\\right)^{2^{n}}$$\nNow, we must prove that this scheme exhibits the required error behavior.\n\nFirst, we analyze the absolute error sequence, $\\{e_{n}^{\\mathrm{abs}}\\}$, defined as $e_{n}^{\\mathrm{abs}} = |x_{n} - x^{\\ast}|$.\nWith $x^{\\ast}=0$ and $x_{n} = (\\frac{1}{2})^{2^{n}}$, the absolute error is:\n$$e_{n}^{\\mathrm{abs}} = \\left| \\left(\\frac{1}{2}\\right)^{2^{n}} - 0 \\right| = \\left(\\frac{1}{2}\\right)^{2^{n}}$$\nTo check for convergence, we evaluate the limit as $n \\to \\infty$:\n$$\\lim_{n \\to \\infty} e_{n}^{\\mathrm{abs}} = \\lim_{n \\to \\infty} \\left(\\frac{1}{2}\\right)^{2^{n}}$$\nAs $n \\to \\infty$, the exponent $2^{n} \\to \\infty$. Since the base of the power, $\\frac{1}{2}$, is in the interval $(0, 1)$, the limit of the expression is $0$.\n$$\\lim_{n \\to \\infty} e_{n}^{\\mathrm{abs}} = 0$$\nTherefore, the sequence of absolute errors $\\{e_{n}^{\\mathrm{abs}}\\}$ converges, satisfying the first condition.\n\nNext, we analyze the computable relative error sequence, $\\{e_{n}^{\\mathrm{rel}}\\}$, defined as $e_{n}^{\\mathrm{rel}} = \\frac{|x_{n+1} - x_{n}|}{|x_{n+1}|}$.\nUsing the recurrence relation $x_{n+1} = x_{n}^{2}$, we substitute it into the definition:\n$$e_{n}^{\\mathrm{rel}} = \\frac{|x_{n}^{2} - x_{n}|}{|x_{n}^{2}|}$$\nSince the initial condition is $x_{0}=\\frac{1}{2}$, all subsequent terms $x_{n}$ are positive and satisfy $0 < x_{n} \\le \\frac{1}{2}$. For any such $x_{n}$, we have $x_{n}^{2} < x_{n}$, which means $x_{n}^{2} - x_{n}$ is negative. Thus, $|x_{n}^{2} - x_{n}| = -(x_{n}^{2} - x_{n}) = x_{n} - x_{n}^{2}$.\n$$e_{n}^{\\mathrm{rel}} = \\frac{x_{n} - x_{n}^{2}}{x_{n}^{2}} = \\frac{x_{n}(1-x_{n})}{x_{n}^{2}} = \\frac{1-x_{n}}{x_{n}}$$\nTo determine the behavior of this sequence, we again take the limit as $n \\to \\infty$:\n$$\\lim_{n \\to \\infty} e_{n}^{\\mathrm{rel}} = \\lim_{n \\to \\infty} \\frac{1-x_{n}}{x_{n}}$$\nWe have already shown that $\\lim_{n \\to \\infty} x_{n} = 0$. As the iterates $x_{n}$ are always positive, the limit is approached from the positive side, i.e., $x_{n} \\to 0^{+}$.\n$$\\lim_{n \\to \\infty} e_{n}^{\\mathrm{rel}} = \\lim_{x_{n} \\to 0^{+}} \\frac{1-x_{n}}{x_{n}} = \\frac{1-0}{0^{+}} = +\\infty$$\nHence, the sequence of computable relative errors $\\{e_{n}^{\\mathrm{rel}}\\}$ diverges to infinity, satisfying the second condition.\n\nAll requirements of the problem are satisfied with the parameter choice $\\lambda=1$. The final task is to provide the derived closed-form expression for $x_{n}$. As established previously, this expression is $x_{n} = \\left(\\frac{1}{2}\\right)^{2^{n}}$.", "answer": "$$\\boxed{\\left(\\frac{1}{2}\\right)^{2^{n}}}$$", "id": "3202469"}]}