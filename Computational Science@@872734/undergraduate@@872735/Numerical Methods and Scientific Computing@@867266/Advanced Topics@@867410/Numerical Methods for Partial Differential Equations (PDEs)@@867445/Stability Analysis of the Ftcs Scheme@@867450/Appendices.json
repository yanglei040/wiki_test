{"hands_on_practices": [{"introduction": "Understanding why a numerical scheme might fail is the first step toward using it effectively. This exercise takes you through the foundational von Neumann stability analysis, a powerful tool for inspecting how a scheme treats different frequency components of a solution. By deriving the one-step growth factor for the FTCS scheme, you will pinpoint exactly which modes become unstable when the stability condition is violated, providing a theoretical basis for the numerical behavior you will observe in later practices. [@problem_id:3278053]", "problem": "Consider the one-dimensional heat equation $u_{t}=\\kappa\\,u_{xx}$ on a periodic domain of length $L$, discretized on a uniform grid with $N=8$ points and spacing $\\Delta x=L/N$. The Forward-Time Central-Space (FTCS) scheme advances the solution by\n$$\nu_{i}^{n+1}=u_{i}^{n}+r\\left(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}\\right),\n$$\nwhere $r=\\kappa\\,\\Delta t/\\Delta x^{2}$. The one-step growth factor for a given discrete Fourier mode is defined as the ratio of the mode’s amplitude after one time step to its amplitude before the step.\n\nSet $r=0.51$ and consider discrete Fourier modes indexed by $m=0,1,2,3,4$ with phase $\\theta_{m}=2\\pi m/N$. Starting from the governing equation and the FTCS update, derive the one-step growth factor for a general discrete Fourier mode and compute the growth factors for $m=0,1,2,3,4$. Identify the first mode to diverge, understood as the mode among these whose one-step growth factor has magnitude greater than $1$ and is largest in magnitude. Report your final answer as the modal index $m$. No rounding is required.", "solution": "The problem is first validated to ensure it is well-posed, scientifically grounded, and contains all necessary information for a unique solution.\n\n**Problem Validation**\n\n*   **Givens Extracted:**\n    *   Governing equation: $u_{t}=\\kappa\\,u_{xx}$\n    *   Domain: $1D$ periodic of length $L$\n    *   Discretization: Uniform grid, $N=8$ points, spacing $\\Delta x=L/N$\n    *   Numerical scheme: FTCS, $u_{i}^{n+1}=u_{i}^{n}+r\\left(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}\\right)$\n    *   Courant-Friedrichs-Lewy (CFL) number definition: $r=\\kappa\\,\\Delta t/\\Delta x^{2}$\n    *   Specific CFL number: $r=0.51$\n    *   Modes for analysis: Discrete Fourier modes indexed by $m=0,1,2,3,4$\n    *   Mode phase definition: $\\theta_{m}=2\\pi m/N$\n    *   Objective: Derive the one-step growth factor, compute it for the specified modes, and identify the first mode to diverge (defined as the mode with the largest growth factor magnitude greater than $1$).\n\n*   **Validation Verdict:**\n    The problem is **valid**. It is a standard exercise in the von Neumann stability analysis of a finite difference scheme, a core topic in numerical analysis. All parameters and definitions are clear, consistent, and sufficient to derive a unique answer. The value $r=0.51$ is chosen to be slightly above the theoretical stability threshold of $r=0.5$ for the FTCS scheme, which is a legitimate and common scenario for studying numerical instability.\n\n**Solution Derivation**\n\nTo determine the one-step growth factor, we perform a von Neumann stability analysis. We consider a single discrete Fourier mode as a solution to the finite difference equation. A generic mode corresponding to index $m$ can be written as:\n$$\nu_i^n = A_m^n \\exp(I i \\theta_m)\n$$\nwhere $A_m^n$ is the amplitude of mode $m$ at time step $n$, $i$ is the spatial grid index, $I$ is the imaginary unit ($I^2 = -1$), and $\\theta_m$ is the phase for mode $m$. The one-step growth factor, which we denote as $G_m$, is the ratio of amplitudes in successive time steps, $G_m = A_m^{n+1} / A_m^n$. Thus, we can write $u_i^{n+1}$ as:\n$$\nu_i^{n+1} = A_m^{n+1} \\exp(I i \\theta_m) = G_m A_m^n \\exp(I i \\theta_m)\n$$\nWe substitute these forms for $u_i^n$ and $u_i^{n+1}$ into the FTCS scheme:\n$$\nu_{i}^{n+1}=u_{i}^{n}+r\\left(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}\\right)\n$$\n$$\nG_m A_m^n \\exp(I i \\theta_m) = A_m^n \\exp(I i \\theta_m) + r \\left[ A_m^n \\exp(I (i+1) \\theta_m) - 2 A_m^n \\exp(I i \\theta_m) + A_m^n \\exp(I (i-1) \\theta_m) \\right]\n$$\nDividing the entire equation by the common non-zero factor $A_m^n \\exp(I i \\theta_m)$ yields the expression for the growth factor $G_m$:\n$$\nG_m = 1 + r \\left[ \\exp(I \\theta_m) - 2 + \\exp(-I \\theta_m) \\right]\n$$\nUsing Euler's formula, $\\exp(I\\theta) + \\exp(-I\\theta) = 2\\cos(\\theta)$, we simplify the expression in the brackets:\n$$\nG_m = 1 + r \\left[ 2\\cos(\\theta_m) - 2 \\right] = 1 - 2r \\left[ 1 - \\cos(\\theta_m) \\right]\n$$\nWe apply the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nG_m = 1 - 4r \\sin^2\\left(\\frac{\\theta_m}{2}\\right)\n$$\nThis is the general expression for the one-step growth factor for a discrete Fourier mode with phase $\\theta_m$.\n\nThe problem provides the specific parameters $r=0.51$, $N=8$, and asks to analyze modes $m \\in \\{0,1,2,3,4\\}$. The phase angle is $\\theta_m = 2\\pi m/N = 2\\pi m/8 = \\pi m/4$.\nSubstituting these values into the expression for $G_m$:\n$$\nG_m = 1 - 4(0.51) \\sin^2\\left(\\frac{\\pi m/4}{2}\\right) = 1 - 2.04 \\sin^2\\left(\\frac{\\pi m}{8}\\right)\n$$\nA mode is stable if and only if its growth factor has a magnitude less than or equal to one, i.e., $|G_m| \\le 1$. We now compute $G_m$ and its magnitude for each specified mode.\n\n*   **Mode $m=0$:**\n    $\\theta_0 = 0$.\n    $G_0 = 1 - 2.04 \\sin^2(0) = 1 - 0 = 1$.\n    $|G_0| = 1$. This mode is neutrally stable.\n\n*   **Mode $m=1$:**\n    $\\theta_1 = \\pi/4$.\n    $G_1 = 1 - 2.04 \\sin^2(\\pi/8)$. Using $\\sin^2(x) = (1-\\cos(2x))/2$, we have $\\sin^2(\\pi/8) = (1-\\cos(\\pi/4))/2 = (1-\\sqrt{2}/2)/2 = (2-\\sqrt{2})/4$.\n    $G_1 = 1 - 2.04 \\left(\\frac{2-\\sqrt{2}}{4}\\right) = 1 - 0.51(2 - \\sqrt{2}) = 1 - 1.02 + 0.51\\sqrt{2} = -0.02 + 0.51\\sqrt{2}$.\n    Since $\\sqrt{2} \\approx 1.414$, $G_1 \\approx -0.02 + 0.51(1.414) \\approx 0.701$. Clearly, $|G_1|  1$. This mode is stable.\n\n*   **Mode $m=2$:**\n    $\\theta_2 = 2\\pi/4 = \\pi/2$.\n    $G_2 = 1 - 2.04 \\sin^2(\\pi/4) = 1 - 2.04 (\\frac{\\sqrt{2}}{2})^2 = 1 - 2.04(\\frac{1}{2}) = 1 - 1.02 = -0.02$.\n    $|G_2| = 0.02  1$. This mode is stable.\n\n*   **Mode $m=3$:**\n    $\\theta_3 = 3\\pi/4$.\n    $G_3 = 1 - 2.04 \\sin^2(3\\pi/8)$. Using $\\sin^2(x) = (1-\\cos(2x))/2$, we have $\\sin^2(3\\pi/8) = (1-\\cos(3\\pi/4))/2 = (1-(-\\sqrt{2}/2))/2 = (2+\\sqrt{2})/4$.\n    $G_3 = 1 - 2.04 \\left(\\frac{2+\\sqrt{2}}{4}\\right) = 1 - 0.51(2 + \\sqrt{2}) = 1 - 1.02 - 0.51\\sqrt{2} = -0.02 - 0.51\\sqrt{2}$.\n    $|G_3| = |-0.02 - 0.51\\sqrt{2}| = 0.02 + 0.51\\sqrt{2}$. Since $0.51\\sqrt{2} \\approx 0.72$, $|G_3| \\approx 0.74  1$. This mode is stable.\n\n*   **Mode $m=4$:**\n    $\\theta_4 = 4\\pi/4 = \\pi$.\n    $G_4 = 1 - 2.04 \\sin^2(\\pi/2) = 1 - 2.04 (1)^2 = 1 - 2.04 = -1.04$.\n    $|G_4| = |-1.04| = 1.04  1$. This mode is unstable.\n\nThe problem asks to identify the mode among $m=0,1,2,3,4$ that diverges, which is defined as the mode with $|G_m| > 1$ and the largest such magnitude. Reviewing our calculations:\n*   $|G_0| = 1$\n*   $|G_1|  1$\n*   $|G_2|  1$\n*   $|G_3|  1$\n*   $|G_4| = 1.04$\n\nAmong the modes considered, $m=4$ is the only one for which the magnitude of the growth factor is greater than $1$. Therefore, it is the first mode to diverge according to the problem's definition. This result is consistent with the general stability analysis of the FTCS scheme, which shows instability occurs first at the highest frequency (or shortest wavelength) mode, which for a grid with $N$ points is the Nyquist mode, $m=N/2$. Here, $N=8$, so the most unstable mode is $m=4$.", "answer": "$$\\boxed{4}$$", "id": "3278053"}, {"introduction": "Theory provides the rules, but simulation shows the consequences. In this practice, you will write a program to observe the evolution of a sharp disturbance—a discrete delta function—under the FTCS scheme. By testing stable, critically stable, and unstable regimes, you will gain an intuitive, visual understanding of how numerical instability manifests over time as catastrophic error growth, contrasting it with the desired smoothing behavior of a stable diffusion solver. [@problem_id:3278097]", "problem": "Consider the one-dimensional heat equation with constant diffusivity on a uniform, periodic grid. Let $u(x,t)$ satisfy $u_t=\\alpha u_{xx}$ on a periodic domain, and let the spatial grid be $x_i=i\\Delta x$ for integers $i$ modulo $N$, where $\\Delta x0$ and $N\\in\\mathbb{N}$. The Forward-Time Centered-Space (FTCS) discretization updates the grid function values $u_i^n\\approx u(x_i,t_n)$ from time level $t_n$ to $t_{n+1}=t_n+\\Delta t$ according to the three-point stencil with periodic wrap-around indices. Define the nondimensional parameter $r=\\alpha\\,\\Delta t/\\Delta x^2$. A single-point perturbation (a discrete delta) is given by the initial condition $u_i^0=1$ if $i=0$ and $u_i^0=0$ otherwise.\n\nYour task is to write a complete program that:\n- Evolves the FTCS scheme forward in time for a given number of time steps using periodic boundary conditions.\n- Quantifies the growth or decay of the zero-mean component of the solution. Specifically, define the mean of the initial condition as $\\bar{u}^0=\\frac{1}{N}\\sum_{i=0}^{N-1}u_i^0$, and define the zero-mean part as $v_i^n=u_i^n-\\bar{u}^0$. Let $\\|\\cdot\\|_2$ denote the discrete $\\ell^2$ norm over the grid. For a given number of steps $T\\in\\mathbb{N}$, compute\n$$\nG_{\\max}=\\max_{1\\le n\\le T}\\frac{\\|v^n\\|_2}{\\|v^0\\|_2}.\n$$\n- Reports $G_{\\max}$ for each parameter set in the test suite below.\n\nFundamental base you may assume:\n- The heat equation $u_t=\\alpha u_{xx}$ on a periodic domain conserves average value in time.\n- The FTCS update uses the three-point discrete Laplacian with periodic wrap-around indices.\n- The discrete $\\ell^2$ norm is $\\|w\\|_2=\\left(\\sum_{i=0}^{N-1} w_i^2\\right)^{1/2}$.\n\nDo not use any results from stability analyses that directly provide ready-to-use amplification factors; instead, base your implementation and reasoning on these core definitions.\n\nImplement the FTCS update as follows for all grid indices $i$ modulo $N$:\n- Let $u_i^{n+1}=u_i^n + r\\left(u_{i-1}^n - 2u_i^n + u_{i+1}^n\\right)$, with periodic wrap-around indexing so that $u_{-1}^n=u_{N-1}^n$ and $u_{N}^n=u_{0}^n$.\n\nTest Suite:\n- Case 1 (stable): $N=128$, $r=0.25$, $T=200$.\n- Case 2 (critically stable): $N=128$, $r=0.5$, $T=200$.\n- Case 3 (unstable): $N=128$, $r=0.6$, $T=50$.\n- Case 4 (critical, odd grid): $N=129$, $r=0.5$, $T=200$.\n\nRequirements for numerical details:\n- Use double-precision floating-point arithmetic.\n- Angles, if any arise internally, are not required; no angle units are needed.\n- No physical units are required; treat all quantities as nondimensional.\n\nProgram input and output:\n- Your program must be fully self-contained and take no external input.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The $k$-th entry must be the value of $G_{\\max}$ for Case $k$, rounded to exactly $6$ decimal places. For example, a valid output format is $[x_1,x_2,x_3,x_4]$ where each $x_k$ is a decimal with $6$ digits after the decimal point.\n\nDesign for coverage:\n- Case 1 tests a stable regime with $r\\tfrac{1}{2}$.\n- Case 2 tests the critical regime with $r=\\tfrac{1}{2}$ and an even number of grid points.\n- Case 3 tests an unstable regime with $r\\tfrac{1}{2}$.\n- Case 4 tests the critical regime with $r=\\tfrac{1}{2}$ and an odd number of grid points, probing the representation of the highest wavenumber.\n\nYour final program should compute and output $[G_{\\max}^{(1)},G_{\\max}^{(2)},G_{\\max}^{(3)},G_{\\max}^{(4)}]$ in that exact format.", "solution": "The problem has been validated and is deemed valid. It is a well-posed, scientifically grounded problem in the field of numerical analysis, with all necessary information provided and no internal contradictions.\n\nThe task is to simulate the one-dimensional heat equation, $u_t = \\alpha u_{xx}$, on a periodic domain using the Forward-Time Centered-Space (FTCS) numerical scheme. We are asked to compute a specific metric, $G_{\\max}$, which quantifies the maximum transient growth of the solution's zero-mean component over a given number of time steps, $T$.\n\nThe solution is found by following a direct simulation procedure for each specified test case.\n\n**1. Initialization of the State**\n\nThe simulation is performed on a discrete spatial grid with $N$ points, indexed $i = 0, 1, \\dots, N-1$. The state of the system at time step $n$ is represented by a vector $u^n$ of length $N$.\n\nThe initial condition at time $t_0$ (i.e., $n=0$) is a discrete delta function:\n$$ u_i^0 = \\begin{cases} 1  \\text{if } i=0 \\\\ 0  \\text{if } i \\neq 0 \\end{cases} $$\nThe problem requires analyzing the zero-mean part of the solution. The mean of the initial condition is:\n$$ \\bar{u}^0 = \\frac{1}{N} \\sum_{i=0}^{N-1} u_i^0 = \\frac{1}{N} $$\nThe FTCS scheme for the heat equation on a periodic domain conserves the total sum $\\sum_i u_i^n$, and therefore conserves the mean value over time. Thus, $\\bar{u}^n = \\bar{u}^0$ for all $n \\ge 0$.\n\nThe initial zero-mean component is $v^0$, with elements $v_i^0 = u_i^0 - \\bar{u}^0$. We must compute its discrete $\\ell^2$ norm, $\\|v^0\\|_2$, which serves as the reference for measuring growth.\n$$ \\|v^0\\|_2^2 = \\sum_{i=0}^{N-1} (v_i^0)^2 = (u_0^0 - \\bar{u}^0)^2 + \\sum_{i=1}^{N-1} (u_i^0 - \\bar{u}^0)^2 $$\n$$ \\|v^0\\|_2^2 = \\left(1 - \\frac{1}{N}\\right)^2 + (N-1)\\left(0 - \\frac{1}{N}\\right)^2 = \\left(1 - \\frac{2}{N} + \\frac{1}{N^2}\\right) + \\frac{N-1}{N^2} = 1 - \\frac{2}{N} + \\frac{1 + N - 1}{N^2} = 1 - \\frac{2}{N} + \\frac{1}{N} = 1 - \\frac{1}{N} $$\nTherefore, the initial norm is $\\|v^0\\|_2 = \\sqrt{1 - \\frac{1}{N}}$.\n\n**2. Time Evolution**\n\nThe solution vector $u^n$ is evolved forward in time using the FTCS update rule for $n=0, 1, \\dots, T-1$:\n$$ u_i^{n+1} = u_i^n + r \\left( u_{i-1}^n - 2u_i^n + u_{i+1}^n \\right) $$\nHere, $r = \\alpha \\Delta t / \\Delta x^2$ is the given nondimensional parameter. The indices are handled with periodic wrap-around, meaning $u_{-1}^n = u_{N-1}^n$ and $u_N^n = u_0^n$. This update is applied to all grid points $i=0, \\dots, N-1$ simultaneously to obtain the solution at the next time level, $u^{n+1}$.\n\n**3. Computation of the Growth Metric $G_{\\max}$**\n\nThe core task is to compute $G_{\\max} = \\max_{1 \\le n \\le T} \\frac{\\|v^n\\|_2}{\\|v^0\\|_2}$. This is achieved through the following steps within the time-evolution loop:\n- For each time step $n$ from $1$ to $T$:\n    - The new state $u^n$ is computed from $u^{n-1}$.\n    - The zero-mean component $v^n$ is calculated: $v_i^n = u_i^n - \\bar{u}^0$.\n    - The $\\ell^2$ norm, $\\|v^n\\|_2 = \\left(\\sum_{i=0}^{N-1} (v_i^n)^2\\right)^{1/2}$, is computed.\n    - The growth factor for this step, $G_n = \\|v^n\\|_2 / \\|v^0\\|_2$, is found.\n- The value of $G_{\\max}$ is maintained as the running maximum of all computed $G_n$ values.\n\n**4. Implementation Strategy**\n\nA program is designed to carry out this simulation for each test case provided.\n- The state vector $u$ is represented as a one-dimensional array of double-precision floating-point numbers.\n- The FTCS update with periodic boundaries is efficiently implemented using vectorized operations. The term $(u_{i-1}^n - 2u_i^n + u_{i+1}^n)$ can be computed for the entire grid at once using array-rolling or shifting operations.\n- A main loop iterates $T$ times. In each iteration, the state vector $u$ is updated, and the norm of the zero-mean component is calculated to update $G_{\\max}$.\n- The procedure is repeated for each parameter set $(N, r, T)$ from the test suite. The final computed $G_{\\max}$ for each case is stored.\n\nThe test cases are designed to probe the well-known stability limit of the FTCS scheme, which is $r \\le 0.5$.\n- Case 1 ($r=0.25$): Stable. All non-constant modes decay.\n- Case 2 ($r=0.5$, $N=128$ even): Marginally stable. The highest frequency mode, which is representable on an even grid, has an amplification factor of $-1$ and thus persists without decay, causing oscillations.\n- Case 3 ($r=0.6$): Unstable. The highest frequency mode grows exponentially.\n- Case 4 ($r=0.5$, $N=129$ odd): Marginally stable, but on an odd grid. The highest frequency mode $u_j \\propto (-1)^j$ is not periodic and thus not an eigenmode of the discrete operator. All representable modes have amplification factors with magnitude strictly less than $1$ (for non-constant modes), leading to decay.\n\nThe final output will be a list of the computed $G_{\\max}$ values, one for each case, formatted as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite.\n    This function simulates the FTCS scheme for the 1D heat equation and\n    calculates the maximum growth of the zero-mean component of the solution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (stable)\n        {'N': 128, 'r': 0.25, 'T': 200},\n        # Case 2 (critically stable, even grid)\n        {'N': 128, 'r': 0.5, 'T': 200},\n        # Case 3 (unstable)\n        {'N': 128, 'r': 0.6, 'T': 50},\n        # Case 4 (critically stable, odd grid)\n        {'N': 129, 'r': 0.5, 'T': 200},\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case['N']\n        r = case['r']\n        T = case['T']\n\n        # 1. Set up the initial condition u^0 (discrete delta function).\n        # Use np.float64 for double-precision arithmetic.\n        u = np.zeros(N, dtype=np.float64)\n        u[0] = 1.0\n\n        # 2. Calculate the mean of the initial condition (conserved in time).\n        u_mean_0 = np.mean(u)\n\n        # 3. Calculate the zero-mean part of the initial condition, v^0,\n        #    and its L2 norm.\n        v_0 = u - u_mean_0\n        norm_v0 = np.linalg.norm(v_0)\n\n        # The norm of v^0 can't be zero for N  1, but this is good practice.\n        if norm_v0  1e-15:\n            results.append(0.0)\n            continue\n            \n        g_max = 0.0\n\n        # 4. Evolve the solution for T time steps.\n        for n in range(T):\n            # Apply the FTCS update rule with periodic boundary conditions.\n            # np.roll(u, 1) gets u_{i-1} and np.roll(u, -1) gets u_{i+1}.\n            u_laplacian = np.roll(u, 1) - 2 * u + np.roll(u, -1)\n            u = u + r * u_laplacian\n\n            # 5. Calculate the growth factor at the current step n+1.\n            # The loop runs for n=0,...,T-1, so u is now u^{n+1}.\n            v_n = u - u_mean_0\n            norm_vn = np.linalg.norm(v_n)\n            g_n = norm_vn / norm_v0\n            \n            # Update the maximum growth factor found so far.\n            if g_n  g_max:\n                g_max = g_n\n        \n        results.append(g_max)\n\n    # Final print statement in the exact required format.\n    # The result for each case is rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3278097"}, {"introduction": "A stable scheme is not always an accurate one. This final practice moves beyond the simple binary of stability versus instability to explore the more subtle issue of numerical accuracy. By comparing solutions computed with different stable parameters, you will quantify the concept of \"numerical diffusion\"—an error where the scheme artificially diffuses the solution more than the physical process dictates. This exercise is crucial for developing the practical judgment needed to select numerical parameters that balance computational efficiency and solution fidelity. [@problem_id:3278125]", "problem": "Consider the one-dimensional heat diffusion equation $u_t = \\nu u_{xx}$ on a periodic spatial domain of length $L$, where $u(x,t)$ is the temperature field, $t$ is time in seconds, $x$ is position in meters, and $\\nu$ is the thermal diffusivity in $\\mathrm{m^2/s}$. Use the Forward-Time Central-Space (FTCS) scheme to approximate the solution on a uniform grid with $N_x$ points, spacing $\\Delta x = L/N_x$, and time step $\\Delta t$. Define the nondimensional parameter $r = \\nu \\Delta t / \\Delta x^2$. The FTCS update is applied with periodic boundary conditions and fixed $r$ values specified below. The initial condition is a single Fourier mode $u(x,0) = \\sin(k x)$ with wavenumber $k = 2\\pi m / L$ for a given integer mode index $m$. The exact analytical solution of the heat equation for this initial condition is $u_{\\mathrm{exact}}(x,t) = \\sin(k x)\\,\\exp(-\\nu k^2 t)$.\n\nYour task is to set up a parametric study of error versus stability by comparing FTCS numerical solutions at $r=0.49$ and $r=0.1$ after a fixed physical time $T$, and quantify the excess numerical diffusion. For each case in the test suite below, implement the FTCS scheme until the physical time $T$ is reached exactly. Use periodic boundary conditions. For each case, compute two quantities:\n\n1. The $L^2$ error at time $T$ with respect to the analytical solution, defined as $E = \\left(\\int_0^L (u_{\\mathrm{num}}(x,T) - u_{\\mathrm{exact}}(x,T))^2\\,dx\\right)^{1/2}$, expressed as a floating-point number without units (dimensionless, since $u$ is dimensionless).\n\n2. The excess numerical diffusion $\\Delta \\nu_{\\mathrm{num}}$ in $\\mathrm{m^2/s}$, defined by estimating an effective diffusivity $\\nu_{\\mathrm{eff}}$ from the numerically computed amplitude decay of the fundamental mode, and then reporting $\\Delta \\nu_{\\mathrm{num}} = \\nu_{\\mathrm{eff}} - \\nu$. Estimate the amplitude $A(t)$ by projecting $u(x,t)$ onto $\\sin(kx)$ using a discrete approximation of the inner product over the grid. Use $A(0)$ and $A(T)$ to compute $\\nu_{\\mathrm{eff}}$ via $\\nu_{\\mathrm{eff}} = -\\frac{1}{k^2 T}\\ln\\left(\\left|\\frac{A(T)}{A(0)}\\right|\\right)$. Report $\\Delta \\nu_{\\mathrm{num}}$ in $\\mathrm{m^2/s}$ as a floating-point number. Note that the absolute value inside the logarithm ensures a physically meaningful decay rate in cases where discrete amplification yields sign changes while remaining stable.\n\nScientific and numerical parameters to use are $L = 1.0$ meters, $\\nu = 0.01$ $\\mathrm{m^2/s}$, $T = 0.49$ seconds. Angles (e.g., in trigonometric functions) must be treated in radians.\n\nImplement the FTCS scheme update in time for each case and compute the requested quantities. The FTCS update must use the nondimensional parameter $r$ specified per case, periodic boundary conditions, and a uniform grid. Choose the time step $\\Delta t$ from the definition of $r = \\nu \\Delta t / \\Delta x^2$ for each case, and ensure the number of time steps is such that the total simulated time equals exactly $T$ seconds.\n\nTest suite:\n- Case 1 (happy path): $N_x = 100$, $m = 1$, $r = 0.1$.\n- Case 2 (near stability boundary): $N_x = 100$, $m = 1$, $r = 0.49$.\n- Case 3 (high wavenumber near the discrete stability edge): $N_x = 100$, $m = 45$, $r = 0.49$.\n\nFor each case, compute the pair $\\left[E, \\Delta \\nu_{\\mathrm{num}}\\right]$ as specified. Your program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, where each element is itself a two-element list. For example, the output format should be like \"[[E1,DN1],[E2,DN2],[E3,DN3]]\" where $E1$ is the $L^2$ error for Case 1, $DN1$ is the excess numerical diffusion for Case 1 in $\\mathrm{m^2/s}$, and so on. All numbers must be printed as standard Python floats. No units should be printed in the output line.", "solution": "The problem has been validated and is determined to be a well-posed and scientifically sound exercise in numerical analysis.\n\nThe problem requires the numerical solution of the one-dimensional heat diffusion equation,\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\non a periodic spatial domain $x \\in [0, L]$. Here, $u(x,t)$ represents the temperature, $\\nu$ is the thermal diffusivity, $x$ is the spatial coordinate, and $t$ is time. The initial condition is a single Fourier mode, $u(x,0) = \\sin(k x)$, with wavenumber $k = 2\\pi m / L$ for a given integer mode index $m$.\n\nThe numerical method to be used is the Forward-Time Central-Space (FTCS) scheme. We discretize the domain with $N_x$ grid points, such that the grid spacing is $\\Delta x = L/N_x$ and the spatial coordinates are $x_j = j \\Delta x$ for $j = 0, 1, \\dots, N_x-1$. Time is discretized in steps of $\\Delta t$, so $t_n = n \\Delta t$. The numerical solution at grid point $j$ and time step $n$ is denoted by $u_j^n \\approx u(x_j, t_n)$.\n\nThe FTCS scheme discretizes the time derivative with a forward difference and the spatial derivative with a central difference:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\nu \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\nRearranging this equation yields the explicit update rule for the numerical solution at the next time step, $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n + r (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nwhere $r = \\frac{\\nu \\Delta t}{\\Delta x^2}$ is the nondimensional stability parameter. The stability of the FTCS scheme is governed by the von Neumann stability condition, which dictates that for a stable solution, the parameter $r$ must satisfy $r \\le 1/2$. The cases under consideration with $r=0.1$ and $r=0.49$ both satisfy this condition.\n\nThe procedure for each test case is as follows:\n\n1.  **Set up Simulation Parameters**: Based on the provided case data ($N_x, m, r$) and global constants ($L=1.0$, $\\nu=0.01$, $T=0.49$), we calculate the necessary parameters:\n    *   Spatial grid spacing: $\\Delta x = L / N_x$.\n    *   Wavenumber: $k = 2\\pi m / L$.\n    *   Time step: $\\Delta t = r \\Delta x^2 / \\nu$.\n    *   Total number of time steps: $N_t = T / \\Delta t$. The problem parameters are chosen such that $N_t$ is an integer, ensuring the simulation ends precisely at time $T$.\n\n2.  **Initialize Solution**: A one-dimensional array representing the solution $u$ is initialized according to the initial condition $u(x,0) = \\sin(kx)$. The spatial grid is defined as $x_j = j \\Delta x$ for $j \\in \\{0, \\dots, N_x-1\\}$. The initial numerical solution is thus $u_j^0 = \\sin(k x_j)$.\n\n3.  **Perform Time Integration**: A loop iterates from $n=0$ to $N_t-1$. In each iteration, the FTCS update rule is applied to all grid points $j$ to compute $u^{n+1}$ from $u^n$. Periodic boundary conditions are enforced, meaning that for the calculation at $j=0$, the \"left\" neighbor $u_{-1}^n$ is taken as $u_{N_x-1}^n$, and for the calculation at $j=N_x-1$, the \"right\" neighbor $u_{N_x}^n$ is taken as $u_0^n$.\n\n4.  **Compute Final Quantities**: After $N_t$ time steps, the final numerical solution $u_{\\mathrm{num}}(x,T)$ is obtained. We then compute the two required metrics:\n\n    a. **$L^2$ Error ($E$)**: The exact analytical solution for the given initial condition is $u_{\\mathrm{exact}}(x,t) = \\sin(k x) e^{-\\nu k^2 t}$. We evaluate this at $t=T$ on the numerical grid. The $L^2$ error is defined as $E = \\left(\\int_0^L (u_{\\mathrm{num}}(x,T) - u_{\\mathrm{exact}}(x,T))^2\\,dx\\right)^{1/2}$. This integral is approximated numerically using a Riemann sum over the grid:\n    $$\n    E \\approx \\left( \\sum_{j=0}^{N_x-1} (u_j^{N_t} - u_{\\mathrm{exact}}(x_j,T))^2 \\Delta x \\right)^{1/2}\n    $$\n\n    b. **Excess Numerical Diffusion ($\\Delta \\nu_{\\mathrm{num}}$)**: The FTCS scheme introduces numerical error that often manifests as additional diffusion. To quantify this, we calculate an effective diffusivity $\\nu_{\\mathrm{eff}}$ based on the decay of the solution's amplitude. The amplitude $A(t)$ of the mode $\\sin(kx)$ in the numerical solution $u(x,t)$ is found by projection:\n    $$\n    A(t) = \\frac{\\langle u(x,t), \\sin(kx) \\rangle}{\\langle \\sin(kx), \\sin(kx) \\rangle} = \\frac{\\int_0^L u(x,t) \\sin(kx) dx}{\\int_0^L \\sin^2(kx) dx} = \\frac{2}{L} \\int_0^L u(x,t) \\sin(kx) dx\n    $$\n    We compute the initial amplitude $A(0)$ and the final amplitude $A(T)$ by numerically approximating this integral. Due to the properties of the discrete Fourier basis on the chosen grid, $A(0)$ will be exactly $1$. The final amplitude is given by:\n    $$\n    A(T) \\approx \\frac{2}{L} \\sum_{j=0}^{N_x-1} u_j^{N_t} \\sin(k x_j) \\Delta x = \\frac{2}{N_x} \\sum_{j=0}^{N_x-1} u_j^{N_t} \\sin(k x_j)\n    $$\n    The effective diffusivity $\\nu_{\\mathrm{eff}}$ is then calculated from the amplitude decay, assuming an exponential law:\n    $$\n    \\nu_{\\mathrm{eff}} = -\\frac{1}{k^2 T}\\ln\\left(\\left|\\frac{A(T)}{A(0)}\\right|\\right)\n    $$\n    The use of the absolute value makes the calculation robust against sign-flipping oscillations that can occur in the numerical scheme. The excess numerical diffusion is the difference between the effective and the true diffusivity:\n    $$\n    \\Delta \\nu_{\\mathrm{num}} = \\nu_{\\mathrm{eff}} - \\nu\n    $$\n\nThis procedure is executed for each of the three test cases, and the resulting pairs $[E, \\Delta \\nu_{\\mathrm{num}}]$ are collected and formatted for the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_case(Nx, m, r):\n    \"\"\"\n    Solves the 1D heat equation with FTCS for a given parameter set.\n\n    Args:\n        Nx (int): Number of spatial grid points.\n        m (int): Wavenumber index for the initial condition.\n        r (float): Nondimensional stability parameter.\n\n    Returns:\n        list: A list containing the L2 error [E] and the excess numerical \n              diffusion [delta_nu_num].\n    \"\"\"\n    # Scientific and numerical parameters\n    L = 1.0  # meters\n    nu = 0.01  # m^2/s\n    T = 0.49  # seconds\n\n    # 1. Grid and Parameters Setup\n    dx = L / Nx\n    k = 2 * np.pi * m / L\n    \n    # Calculate time step and number of steps to reach T exactly\n    dt = r * dx**2 / nu\n    # Use np.round to handle potential floating point inaccuracies ensuring an integer\n    Nt = int(np.round(T / dt)) \n    \n    # Check if simulation time is exactly T\n    if not np.isclose(Nt * dt, T):\n        raise ValueError(\"Simulation time T is not an integer multiple of dt.\")\n\n    # Spatial grid\n    x = np.linspace(0, L, Nx, endpoint=False)\n\n    # 2. Initial Condition\n    u = np.sin(k * x)\n    u_initial = u.copy()\n\n    # 3. Time Evolution (FTCS)\n    for _ in range(Nt):\n        # Use np.roll for efficient periodic boundary conditions\n        u_jp1 = np.roll(u, -1)\n        u_jm1 = np.roll(u, 1)\n        u = u + r * (u_jp1 - 2 * u + u_jm1)\n    \n    u_final = u\n\n    # 4. Post-processing\n    # Analytical solution at time T\n    u_exact_T = np.sin(k * x) * np.exp(-nu * k**2 * T)\n\n    # 5. Compute L2 Error (E)\n    # The integral is approximated by a sum over the discrete grid points.\n    error_integrand = (u_final - u_exact_T)**2\n    L2_error = np.sqrt(np.sum(error_integrand) * dx)\n\n    # 6. Compute Excess Numerical Diffusion (delta_nu_num)\n    # The amplitude is computed by projecting the solution onto sin(kx).\n    # The discrete projection integral: (2/L) * sum(f(x)*sin(kx)*dx)\n    # A_0 = (2/L) * np.sum(u_initial * np.sin(k*x)) * dx which simplifies to\n    # A_0 = (2/Nx) * np.sum(u_initial * np.sin(k*x))\n    # For a perfect sine wave on the grid, this sum is exactly Nx/2, so A_0 is 1.0.\n    # We compute it numerically for robustness.\n    \n    # Inner product helper function\n    def inner_product(f, g, dx_val):\n        return np.sum(f * g) * dx_val\n\n    # Basis function for projection\n    sin_kx = np.sin(k*x)\n\n    # Normalization factor is integral of sin^2(kx) over [0,L], approximately L/2\n    norm_factor = inner_product(sin_kx, sin_kx, dx)\n\n    # Initial amplitude\n    A0 = inner_product(u_initial, sin_kx, dx) / norm_factor\n\n    # Final amplitude\n    AT = inner_product(u_final, sin_kx, dx) / norm_factor\n    \n    # Handle the case k=0 (m=0), where k^2 T is zero.\n    if k == 0:\n        nu_eff = 0.0 # No diffusion for a constant initial condition\n    else:\n        # The formula given in the problem\n        nu_eff = (-1 / (k**2 * T)) * np.log(np.abs(AT / A0))\n\n    delta_nu_num = nu_eff - nu\n    \n    return [L2_error, delta_nu_num]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (100, 1, 0.1),   # Case 1: happy path\n        (100, 1, 0.49),  # Case 2: near stability boundary\n        (100, 45, 0.49), # Case 3: high wavenumber near stability edge\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, m, r = case\n        result = run_case(Nx, m, r)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() function on a list correctly formats it as '[item1, item2]'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3278125"}]}