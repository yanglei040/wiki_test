{"hands_on_practices": [{"introduction": "At the core of every barrier method lies the concept of the \"central path,\" a curve that smoothly navigates the interior of the feasible region toward the optimal solution. This first exercise demystifies this concept by asking you to derive an explicit formula for the central path in a simple, one-dimensional setting [@problem_id:2155925]. By solving this problem, you will gain a concrete understanding of how the barrier parameter $t$ controls the location of the path's points.", "problem": "Consider a simple one-dimensional linear programming problem defined as:\nminimize $f(x) = c x$\nsubject to $x \\ge 0$\nwhere $x$ is a scalar variable and $c$ is a given positive constant, $c > 0$.\n\nTo solve this using an interior-point method, we can employ the logarithmic barrier function. The original constrained problem is transformed into a sequence of unconstrained optimization problems by augmenting the objective function with a barrier term. The modified objective function for this problem is given by:\n$$P(x; t) = t(cx) - \\ln(x)$$\nwhere $t > 0$ is a scalar barrier parameter. The minimizer of $P(x; t)$ for a given value of $t$ is a point on the so-called \"central path\", and we denote this point as $x^*(t)$.\n\nDetermine the explicit formula for the central path point $x^*(t)$ in terms of the constants $c$ and $t$.", "solution": "We consider the barrier-augmented objective for $x>0$:\n$$\nP(x;t) = t c x - \\ln(x),\n$$\nwith $t>0$ and $c>0$. To find the central path point $x^{*}(t)$, we set the first derivative to zero:\n$$\n\\frac{dP}{dx} = t c - \\frac{1}{x} = 0.\n$$\nSolving for $x$ gives\n$$\n\\frac{1}{x} = t c \\quad \\Rightarrow \\quad x^{*}(t) = \\frac{1}{c t}.\n$$\nTo verify this is a minimizer, we check the second derivative:\n$$\n\\frac{d^{2}P}{dx^{2}} = \\frac{1}{x^{2}} > 0 \\quad \\text{for } x>0,\n$$\nso $P(\\cdot;t)$ is strictly convex on its domain and the critical point is the unique minimizer. Therefore, the central path is\n$$\nx^{*}(t) = \\frac{1}{c t}.\n$$", "answer": "$$\\boxed{\\frac{1}{c t}}$$", "id": "2155925"}, {"introduction": "Now that you understand how to find the central path, we explore *why* it is so important in optimization. This practice reveals the fundamental connection between the central path and the duality gap—the difference between the primal and dual objective values [@problem_id:2155911]. By calculating this gap as a function of the barrier parameter $t$, you will see precisely how traversing the path guarantees convergence to an optimal solution where the gap vanishes.", "problem": "Consider the following one-dimensional convex optimization problem:\n$$\n\\text{minimize } x \\quad \\text{subject to } x \\ge 1\n$$\nThis problem can be approximated using the logarithmic barrier method. For a standard problem of the form $\\min f_0(x)$ subject to constraints $f_i(x) \\le 0$ for $i=1, \\dots, m$, the barrier method involves solving the unconstrained problem:\n$$\n\\text{minimize } t f_0(x) - \\sum_{i=1}^{m} \\ln(-f_i(x))\n$$\nfor a given barrier parameter $t > 0$. Let $x^*(t)$ be the solution to this unconstrained problem.\n\nThe duality gap for a given $t$ is defined as the difference between the primal objective value at the barrier solution, $p^*(t) = f_0(x^*(t))$, and the value of the dual objective at the corresponding dual feasible point, $d^*(t) = g(\\lambda^*(t))$.\n\nYour task is to calculate the duality gap for the given optimization problem as a function of the parameter $t$. Express your answer as a closed-form analytic expression in terms of $t$.", "solution": "We first rewrite the constraint $x \\ge 1$ in the standard form $f_{1}(x) \\le 0$ by defining $f_{1}(x) = 1 - x$. The objective is $f_{0}(x) = x$. The logarithmic barrier problem for a parameter $t > 0$ is\n$$\n\\min_{x>1} \\; F_{t}(x) = t f_{0}(x) - \\ln\\big(-f_{1}(x)\\big) = t x - \\ln(x - 1).\n$$\nTo find the minimizer $x^{*}(t)$, differentiate and set the derivative to zero:\n$$\n\\frac{d}{dx}F_{t}(x) = t - \\frac{1}{x - 1} = 0 \\quad \\Longrightarrow \\quad x^{*}(t) = 1 + \\frac{1}{t}.\n$$\nThe second derivative is $F_{t}''(x) = \\frac{1}{(x - 1)^{2}} > 0$ for $x > 1$, so this is indeed the unique minimizer. The corresponding primal objective value is\n$$\np^{*}(t) = f_{0}\\big(x^{*}(t)\\big) = 1 + \\frac{1}{t}.\n$$\nThe dual problem is formed from the Lagrangian $L(x,\\lambda) = f_{0}(x) + \\lambda f_{1}(x) = x + \\lambda(1 - x)$ with $\\lambda \\ge 0$. The dual function is\n$$\ng(\\lambda) = \\inf_{x} \\big\\{x + \\lambda(1 - x)\\big\\} = \n\\begin{cases}\n\\lambda,  \\text{if } 1 - \\lambda = 0,\\\\\n-\\infty,  \\text{otherwise},\n\\end{cases}\n$$\nso the only dual feasible point yielding a finite value is $\\lambda = 1$, with $g(1) = 1$.\n\nThe dual variable associated with the barrier solution satisfies the perturbed KKT (central path) relations. Using $f_{1}(x) = 1 - x$, the central-path multiplier is\n$$\n\\lambda^{*}(t) = -\\frac{1}{t f_{1}\\big(x^{*}(t)\\big)}.\n$$\nSince $f_{1}\\big(x^{*}(t)\\big) = 1 - \\left(1 + \\frac{1}{t}\\right) = -\\frac{1}{t}$, we get $\\lambda^{*}(t) = 1$, which agrees with the stationarity condition $\\nabla f_{0}(x) + \\lambda \\nabla f_{1}(x) = 0$.\n\nTherefore, the dual objective at the corresponding dual feasible point is\n$$\nd^{*}(t) = g\\big(\\lambda^{*}(t)\\big) = g(1) = 1.\n$$\nThe duality gap is\n$$\np^{*}(t) - d^{*}(t) = \\left(1 + \\frac{1}{t}\\right) - 1 = \\frac{1}{t}.\n$$\nEquivalently, along the central path the complementary slackness product satisfies $-\\lambda^{*}(t) f_{1}\\big(x^{*}(t)\\big) = \\frac{1}{t}$, and since there is a single constraint, the gap equals $\\frac{1}{t}$.", "answer": "$$\\boxed{\\frac{1}{t}}$$", "id": "2155911"}, {"introduction": "Having explored the theoretical underpinnings of the central path, this final practice takes you into the computational engine of a modern interior-point method. You will apply Newton's method to the perturbed Karush-Kuhn-Tucker (KKT) conditions to compute a single search direction—a step toward a target point on the central path [@problem_id:3208894]. This exercise provides hands-on experience with the linear algebra system that is solved at each iteration of a primal-dual algorithm.", "problem": "Consider the linear program in standard form: minimize $c^{\\mathsf{T}} x$ subject to $A x = b$ and $x \\ge 0$, where $A \\in \\mathbb{R}^{m \\times n}$ has full row rank, $b \\in \\mathbb{R}^{m}$, $c \\in \\mathbb{R}^{n}$, and $x \\in \\mathbb{R}^{n}$. The Karush-Kuhn-Tucker (KKT) conditions (first-order optimality conditions) for this problem introduce Lagrange multipliers $y \\in \\mathbb{R}^{m}$ for the equality constraints and slack variables $s \\in \\mathbb{R}^{n}$ for the nonnegativity constraints, yielding primal feasibility $A x = b$, dual feasibility $A^{\\mathsf{T}} y + s = c$, and complementarity $x_i s_i = 0$ for each index $i$. In a primal-dual interior-point method with a logarithmic barrier, the complementarity is perturbed to the central path condition $x_i s_i = \\mu$ with barrier parameter $\\mu  0$, and a Newton step is taken on the perturbed KKT system at a strictly positive iterate $x  0$, $s  0$.\n\nWork with the specific instance having $m = 1$ and $n = 2$:\n- $A = \\begin{bmatrix} 1  2 \\end{bmatrix}$,\n- $b = 4$,\n- $c = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$.\n\nAt the current iterate, take $x = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$, $y = 0$, $s = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$, and barrier parameter $\\mu = \\tfrac{1}{2}$.\n\nStarting from the definitions of primal feasibility, dual feasibility, and perturbed complementarity given above, and using first-order Taylor linearization (Newton’s method) around the current iterate:\n1) Derive the explicit linear KKT system for the Newton search directions $(\\Delta x, \\Delta y, \\Delta s)$ at the given iterate, writing all coefficient matrices and right-hand sides in terms of $A$, $x$, $y$, $s$, $c$, $b$, and $\\mu$ for this instance.\n2) Eliminate variables to obtain the reduced symmetric positive definite normal equation in $\\Delta y$ alone, and write it explicitly for this instance.\n3) Solve the resulting system to obtain $(\\Delta y, \\Delta s, \\Delta x)$, and then compute the first component of the primal Newton step, $\\Delta x_1$.\n\nProvide the final value of $\\Delta x_1$ as an exact number. No rounding is required.", "solution": "The problem describes a linear program (LP) in standard form:\n$$ \\text{minimize} \\quad c^{\\mathsf{T}} x $$\n$$ \\text{subject to} \\quad Ax = b, \\quad x \\ge 0 $$\nThe primal-dual interior-point method aims to solve the Karush-Kuhn-Tucker (KKT) conditions, where the complementarity condition $x_i s_i = 0$ is perturbed. The resulting system of nonlinear equations for the variables $(x, y, s)$ is:\n1.  Primal feasibility: $Ax = b$\n2.  Dual feasibility: $A^{\\mathsf{T}} y + s = c$\n3.  Perturbed complementarity: $XSe = \\mu e$, where $X = \\text{diag}(x)$, $S = \\text{diag}(s)$, $e$ is the vector of all ones, and $\\mu  0$ is the barrier parameter.\n\nA Newton step $(\\Delta x, \\Delta y, \\Delta s)$ is computed for this system at the current iterate $(x, y, s)$. This involves solving the linearized system:\n$$ J \\begin{pmatrix} \\Delta x \\\\ \\Delta y \\\\ \\Delta s \\end{pmatrix} = -F(x,y,s) $$\nwhere $F(x,y,s) = \\begin{pmatrix} A^{\\mathsf{T}} y + s - c \\\\ Ax - b \\\\ XSe - \\mu e \\end{pmatrix}$ is the function representing the KKT system, and $J$ is its Jacobian. The Jacobian is given by:\n$$ J = \\begin{pmatrix} \\frac{\\partial(A^{\\mathsf{T}}y+s-c)}{\\partial x}  \\frac{\\partial(A^{\\mathsf{T}}y+s-c)}{\\partial y}  \\frac{\\partial(A^{\\mathsf{T}}y+s-c)}{\\partial s} \\\\ \\frac{\\partial(Ax-b)}{\\partial x}  \\frac{\\partial(Ax-b)}{\\partial y}  \\frac{\\partial(Ax-b)}{\\partial s} \\\\ \\frac{\\partial(XSe-\\mu e)}{\\partial x}  \\frac{\\partial(XSe-\\mu e)}{\\partial y}  \\frac{\\partial(XSe-\\mu e)}{\\partial s} \\end{pmatrix} = \\begin{pmatrix} 0  A^{\\mathsf{T}}  I \\\\ A  0  0 \\\\ S  0  X \\end{pmatrix} $$\nThe right-hand side is the negative of the residual vector at the current iterate:\n$$ -F = \\begin{pmatrix} c - (A^{\\mathsf{T}} y + s) \\\\ b - Ax \\\\ \\mu e - XSe \\end{pmatrix} = \\begin{pmatrix} r_d \\\\ r_p \\\\ r_c \\end{pmatrix} $$\nThus, the Newton system is:\n$$ \\begin{pmatrix} 0  A^{\\mathsf{T}}  I \\\\ A  0  0 \\\\ S  0  X \\end{pmatrix} \\begin{pmatrix} \\Delta x \\\\ \\Delta y \\\\ \\Delta s \\end{pmatrix} = \\begin{pmatrix} r_d \\\\ r_p \\\\ r_c \\end{pmatrix} $$\nThis is equivalent to the system of three linear equations:\n1.  $A^{\\mathsf{T}} \\Delta y + \\Delta s = r_d$ (dual step equation)\n2.  $A \\Delta x = r_p$ (primal step equation)\n3.  $S \\Delta x + X \\Delta s = r_c$ (centrality step equation)\n\nWe are given the specific instance:\n-   $A = \\begin{bmatrix} 1  2 \\end{bmatrix}$, $b = 4$, $c = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$\n-   Current iterate: $x = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$, $y = 0$, $s = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n-   Barrier parameter: $\\mu = \\frac{1}{2}$\n\nFirst, we compute the residuals $r_p$, $r_d$, and $r_c$:\n$$ r_p = b - Ax = 4 - \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = 4 - (1+2) = 1 $$\n$$ r_d = c - A^{\\mathsf{T}} y - s = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}(0) - \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 - 1 \\\\ 0 - 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1 \\end{bmatrix} $$\nFor $r_c$, we need the diagonal matrices $X$ and $S$:\n$$ X = \\text{diag}(x) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad S = \\text{diag}(s) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\n$$ r_c = \\mu e - XSe = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ -1/2 \\end{pmatrix} $$\n\n**1) The explicit linear KKT system for $(\\Delta x, \\Delta y, \\Delta s)$**\n\nThe search directions are $\\Delta x = \\begin{pmatrix} \\Delta x_1 \\\\ \\Delta x_2 \\end{pmatrix}$, $\\Delta y \\in \\mathbb{R}^1$, and $\\Delta s = \\begin{pmatrix} \\Delta s_1 \\\\ \\Delta s_2 \\end{pmatrix}$. The Newton system is:\n$$ \\begin{pmatrix} 0_{2 \\times 2}  A^{\\mathsf{T}}  I_2 \\\\ A  0  0_{1 \\times 2} \\\\ S  0_{2 \\times 1}  X \\end{pmatrix} \\begin{pmatrix} \\Delta x \\\\ \\Delta y \\\\ \\Delta s \\end{pmatrix} = \\begin{pmatrix} r_d \\\\ r_p \\\\ r_c \\end{pmatrix} $$\nSubstituting the specific matrices and vectors for this instance:\n- Coefficient matrix:\n$$ \\begin{pmatrix}\n0  0  1  1  0 \\\\\n0  0  2  0  1 \\\\\n1  2  0  0  0 \\\\\n1  0  0  1  0 \\\\\n0  1  0  0  1\n\\end{pmatrix} $$\n_Note: We write the variables in the order $(\\Delta x_1, \\Delta x_2, \\Delta y, \\Delta s_1, \\Delta s_2)$ for this matrix representation._\n\n- Right-hand side vector:\n$$ \\begin{pmatrix} r_{d1} \\\\ r_{d2} \\\\ r_p \\\\ r_{c1} \\\\ r_{c2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\\\ -1/2 \\\\ -1/2 \\end{pmatrix} $$\nSo the explicit system is:\n$$ \\begin{pmatrix} 0  0  1  1  0 \\\\ 0  0  2  0  1 \\\\ 1  2  0  0  0 \\\\ 1  0  0  1  0 \\\\ 0  1  0  0  1 \\end{pmatrix}\n\\begin{pmatrix} \\Delta x_1 \\\\ \\Delta x_2 \\\\ \\Delta y \\\\ \\Delta s_1 \\\\ \\Delta s_2 \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\\\ -1/2 \\\\ -1/2 \\end{pmatrix} $$\n\n**2) Reduced normal equation in $\\Delta y$**\n\nTo obtain the equation for $\\Delta y$ alone, we eliminate $\\Delta s$ and $\\Delta x$.\nFrom the first block equation, $A^{\\mathsf{T}} \\Delta y + \\Delta s = r_d$, we solve for $\\Delta s$:\n$$ \\Delta s = r_d - A^{\\mathsf{T}} \\Delta y $$\nFrom the third block equation, $S \\Delta x + X \\Delta s = r_c$, we solve for $\\Delta x$:\n$$ \\Delta x = S^{-1}(r_c - X \\Delta s) $$\nSubstitute the expression for $\\Delta s$ into the equation for $\\Delta x$:\n$$ \\Delta x = S^{-1}(r_c - X(r_d - A^{\\mathsf{T}} \\Delta y)) = S^{-1}r_c - S^{-1}X r_d + S^{-1}X A^{\\mathsf{T}} \\Delta y $$\nFinally, substitute this expression for $\\Delta x$ into the second block equation, $A \\Delta x = r_p$:\n$$ A(S^{-1}r_c - S^{-1}X r_d + S^{-1}X A^{\\mathsf{T}} \\Delta y) = r_p $$\nRearranging gives the normal equations for $\\Delta y$:\n$$ (A S^{-1} X A^{\\mathsf{T}}) \\Delta y = r_p - A S^{-1} r_c + A S^{-1} X r_d $$\nFor our specific instance, $X = I_2$ and $S = I_2$, so $S^{-1} = I_2$. The equation simplifies to:\n$$ (A A^{\\mathsf{T}}) \\Delta y = r_p - A r_c + A r_d $$\nWe compute the coefficient matrix and the right-hand side term by term:\n- Coefficient matrix:\n$$ A A^{\\mathsf{T}} = \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} = (1)(1) + (2)(2) = 5 $$\n- Right-hand side:\n$$ r_p - A r_c + A r_d = 1 - \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{pmatrix} -1/2 \\\\ -1/2 \\end{pmatrix} + \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} $$\n$$ = 1 - (1(-\\tfrac{1}{2}) + 2(-\\tfrac{1}{2})) + (1(0) + 2(-1)) = 1 - (-\\tfrac{1}{2} - 1) + (-2) = 1 - (-\\tfrac{3}{2}) - 2 = 1 + \\tfrac{3}{2} - 2 = \\tfrac{1}{2} $$\nThe explicit reduced normal equation is:\n$$ 5 \\Delta y = \\frac{1}{2} $$\n\n**3) Solve for $(\\Delta y, \\Delta s, \\Delta x)$ and find $\\Delta x_1$**\n\nFirst, solve the normal equation for $\\Delta y$:\n$$ \\Delta y = \\frac{1}{5} \\left(\\frac{1}{2}\\right) = \\frac{1}{10} $$\nNext, find $\\Delta s$ using the expression from step 2:\n$$ \\Delta s = r_d - A^{\\mathsf{T}} \\Delta y = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} - \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} \\left(\\frac{1}{10}\\right) = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 1/10 \\\\ 2/10 \\end{pmatrix} = \\begin{pmatrix} -1/10 \\\\ -1 - 1/5 \\end{pmatrix} = \\begin{pmatrix} -1/10 \\\\ -6/5 \\end{pmatrix} $$\nFinally, find $\\Delta x$. We can use the equation $\\Delta x = S^{-1}(r_c - X \\Delta s)$. Since $S=I$ and $X=I$:\n$$ \\Delta x = r_c - \\Delta s = \\begin{pmatrix} -1/2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} -1/10 \\\\ -6/5 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} + \\frac{1}{10} \\\\ -\\frac{1}{2} + \\frac{6}{5} \\end{pmatrix} $$\n$$ \\Delta x = \\begin{pmatrix} -\\frac{5}{10} + \\frac{1}{10} \\\\ -\\frac{5}{10} + \\frac{12}{10} \\end{pmatrix} = \\begin{pmatrix} -\\frac{4}{10} \\\\ \\frac{7}{10} \\end{pmatrix} = \\begin{pmatrix} -\\frac{2}{5} \\\\ \\frac{7}{10} \\end{pmatrix} $$\nAs a check, we can verify if $A \\Delta x = r_p$:\n$$ A \\Delta x = \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{pmatrix} -2/5 \\\\ 7/10 \\end{pmatrix} = -\\frac{2}{5} + 2\\left(\\frac{7}{10}\\right) = -\\frac{2}{5} + \\frac{7}{5} = \\frac{5}{5} = 1 $$\nThis matches $r_p = 1$, so the calculation is consistent.\n\nThe problem asks for the first component of the primal Newton step, $\\Delta x_1$.\n$$ \\Delta x_1 = -\\frac{2}{5} $$", "answer": "$$\\boxed{-\\frac{2}{5}}$$", "id": "3208894"}]}