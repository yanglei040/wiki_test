{"hands_on_practices": [{"introduction": "To build a solid understanding of cubic splines, it is often best to start with the simplest possible case. This practice explores what happens when we apply the formal definitions of natural and clamped splines to a dataset with only two points. By working through this foundational scenario [@problem_id:3220918], you will see how these spline types relate to more familiar concepts and clarify the essential role of boundary conditions in defining the interpolant.", "problem": "Consider a data set with exactly $2$ distinct nodes $\\{(x_0,y_0),(x_1,y_1)\\}$ where $x_0 < x_1$. A cubic spline on an interval is defined as a function that is a polynomial of degree at most $3$ on each subinterval, interpolates the given data, and is twice continuously differentiable. When there is only one subinterval $[x_0,x_1]$, there are no interior knots, so all continuity conditions at interior knots are vacuous. Boundary conditions distinguish common spline variants: a natural spline imposes $s''(x_0)=0$ and $s''(x_1)=0$, while a clamped spline imposes $s'(x_0)=m_0$ and $s'(x_1)=m_1$ for given endpoint slopes $m_0$ and $m_1$. Using only these foundational definitions, reason carefully about existence, uniqueness, and the resulting form of the spline when there are only $2$ data points.\n\nWhich statement is correct?\n\n- A. With $2$ data points, a natural cubic spline is undefined because there are no interior knots and the usual tridiagonal system cannot be formed; similarly, a clamped spline is undefined unless more points are added.\n\n- B. With $2$ data points, the natural cubic spline exists and reduces to the unique straight line through $(x_0,y_0)$ and $(x_1,y_1)$; the clamped cubic spline exists and reduces to the unique cubic Hermite interpolant on $[x_0,x_1]$ matching $s(x_i)=y_i$ and $s'(x_i)=m_i$ for $i\\in\\{0,1\\}$.\n\n- C. With $2$ data points, both natural and clamped splines exist and are always identical cubic polynomials on $[x_0,x_1]$, independent of the prescribed endpoint slopes.\n\n- D. With $2$ data points, a clamped cubic spline exists only if the prescribed slopes $m_0$ and $m_1$ both equal the secant slope $(y_1-y_0)/(x_1-x_0)$; otherwise, no solution exists.\n\n- E. With $2$ data points, a natural cubic spline is any cubic interpolant of the two points, because the second-derivative continuity conditions are vacuous when there are no interior knots.", "solution": "The problem statement poses a question about the existence, uniqueness, and form of natural and clamped cubic splines for the minimal case of $2$ distinct data points. We must validate the problem statement before proceeding.\n\n### Step 1: Extract Givens\n- Data set: Exactly $2$ distinct nodes $\\{(x_0,y_0),(x_1,y_1)\\}$ where $x_0 < x_1$.\n- Spline definition: A function $s(x)$ that is a polynomial of degree at most $3$ on the interval $[x_0,x_1]$.\n- Interpolation conditions: $s(x_0) = y_0$ and $s(x_1) = y_1$.\n- Continuity conditions: Since there is only one interval, $[x_0,x_1]$, and no interior knots, the conditions of continuity for $s(x)$, $s'(x)$, and $s''(x)$ at interior knots are vacuously satisfied.\n- Natural spline boundary conditions: $s''(x_0) = 0$ and $s''(x_1) = 0$.\n- Clamped spline boundary conditions: $s'(x_0) = m_0$ and $s'(x_1) = m_1$ for given slopes $m_0$ and $m_1$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically and mathematically sound. It is well-posed, objective, and self-contained. The definitions provided for cubic splines, natural splines, and clamped splines are standard in the field of numerical analysis. The scenario of $2$ points is a perfectly valid, albeit simple, case to which these definitions can be applied. The problem does not violate any fundamental principles, is not ambiguous, and requires a rigorous application of the definitions to determine the properties of the resulting functions. It is a valid exercise in understanding the foundational definitions of splines beyond the common application to larger data sets.\n\n### Step 3: Verdict and Action\nThe problem is valid. We will now proceed with a formal derivation of the solution.\n\n### Derivation\n\nA cubic spline on a single interval $[x_0,x_1]$ is a polynomial $s(x)$ of degree at most $3$. We can express this polynomial as:\n$$s(x) = a_3 x^3 + a_2 x^2 + a_1 x + a_0$$\nThis polynomial has $4$ coefficients ($a_3, a_2, a_1, a_0$) that must be determined. The interpolation conditions, $s(x_0) = y_0$ and $s(x_1) = y_1$, provide $2$ linear equations. To uniquely determine the polynomial, $2$ additional conditions are required. These are provided by the boundary conditions.\n\n**Case 1: The Natural Cubic Spline**\n\nA natural spline imposes the following boundary conditions:\n1. $s''(x_0) = 0$\n2. $s''(x_1) = 0$\n\nLet's compute the second derivative of $s(x)$:\n$$s'(x) = 3a_3 x^2 + 2a_2 x + a_1$$\n$$s''(x) = 6a_3 x + 2a_2$$\nThe second derivative, $s''(x)$, is a linear function of $x$. The boundary conditions state that this linear function is zero at two distinct points, $x_0$ and $x_1$. A non-zero linear function can have at most one root. Therefore, for $s''(x)$ to be zero at two distinct points, it must be the zero polynomial.\n$$s''(x) = 0 \\quad \\forall x \\in [x_0, x_1]$$\nThis implies that $6a_3 = 0$ and $2a_2 = 0$, which means $a_3 = 0$ and $a_2 = 0$.\n\nWith $a_3=0$ and $a_2=0$, the spline function $s(x)$ simplifies to a linear polynomial:\n$$s(x) = a_1 x + a_0$$\nThe remaining coefficients, $a_1$ and $a_0$, are determined by the $2$ interpolation conditions:\n1. $s(x_0) = a_1 x_0 + a_0 = y_0$\n2. $s(x_1) = a_1 x_1 + a_0 = y_1$\nThis is a system of $2$ linear equations in $2$ unknowns ($a_1, a_0$). Since $x_0 \\neq x_1$, this system has a unique solution. This solution defines the unique straight line passing through the points $(x_0, y_0)$ and $(x_1, y_1)$.\nThus, for $2$ data points, the natural cubic spline exists, is unique, and is the straight line connecting them.\n\n**Case 2: The Clamped Cubic Spline**\n\nA clamped spline imposes boundary conditions on the first derivative:\n1. $s'(x_0) = m_0$\n2. $s'(x_1) = m_1$\n\nWe have a total of $4$ conditions to determine the $4$ coefficients of the cubic polynomial $s(x)$:\n1. $s(x_0) = y_0$\n2. $s(x_1) = y_1$\n3. $s'(x_0) = m_0$\n4. $s'(x_1) = m_1$\n\nThese are precisely the conditions that define the unique cubic Hermite interpolating polynomial on the interval $[x_0, x_1]$. For any given set of values $\\{y_0, y_1, m_0, m_1\\}$, and for distinct points $x_0$ and $x_1$, it is a standard result in numerical analysis that there exists a unique polynomial of degree at most $3$ satisfying these $4$ conditions. The existence and uniqueness are guaranteed because the associated $4 \\times 4$ linear system for the coefficients $(a_3, a_2, a_1, a_0)$ is non-singular.\n\nTherefore, for $2$ data points, the clamped cubic spline exists and is identical to the unique cubic Hermite interpolant defined by the function values and specified derivative values at the endpoints. Unless the slopes $m_0$ and $m_1$ happen to be equal to the secant slope $(y_1-y_0)/(x_1-x_0)$, this polynomial will be of degree higher than $1$.\n\n### Option-by-Option Analysis\n\n- **A. With $2$ data points, a natural cubic spline is undefined because there are no interior knots and the usual tridiagonal system cannot be formed; similarly, a clamped spline is undefined unless more points are added.**\nThis statement is incorrect. The tridiagonal system is a computational method for solving the multi-knot case, not a part of the fundamental definition. The absence of this specific computational structure does not imply the mathematical object is undefined. As derived above, applying the fundamental definitions to the $2$-point case yields unique, well-defined functions for both the natural and clamped splines.\n**Verdict: Incorrect.**\n\n- **B. With $2$ data points, the natural cubic spline exists and reduces to the unique straight line through $(x_0,y_0)$ and $(x_1,y_1)$; the clamped cubic spline exists and reduces to the unique cubic Hermite interpolant on $[x_0,x_1]$ matching $s(x_i)=y_i$ and $s'(x_i)=m_i$ for $i\\in\\{0,1\\}$.**\nThis statement is fully consistent with our derivation.\nThe natural spline conditions $s''(x_0)=0$ and $s''(x_1)=0$ force the cubic polynomial to be linear. The interpolation conditions then select the unique line through the two points.\nThe clamped spline conditions $s(x_0)=y_0, s(x_1)=y_1, s'(x_0)=m_0, s'(x_1)=m_1$ are the explicit definition of cubic Hermite interpolation on the interval $[x_0,x_1]$, which is known to have a unique solution.\n**Verdict: Correct.**\n\n- **C. With $2$ data points, both natural and clamped splines exist and are always identical cubic polynomials on $[x_0,x_1]$, independent of the prescribed endpoint slopes.**\nThis statement is incorrect. The natural spline is a linear polynomial (degree $1$). The clamped spline is generally a cubic polynomial (degree up to $3$) whose coefficients depend directly on the prescribed slopes $m_0$ and $m_1$. They are not \"always identical\" and the clamped spline is not \"independent of the prescribed endpoint slopes.\" They are only identical in the specific case where the prescribed slopes $m_0$ and $m_1$ both equal the slope of the line connecting the points, $(y_1-y_0)/(x_1-x_0)$.\n**Verdict: Incorrect.**\n\n- **D. With $2$ data points, a clamped cubic spline exists only if the prescribed slopes $m_0$ and $m_1$ both equal the secant slope $(y_1-y_0)/(x_1-x_0)$; otherwise, no solution exists.**\nThis statement is incorrect. As established in the derivation for the clamped spline, a unique solution (the cubic Hermite interpolant) exists for *any* given values of $m_0$ and $m_1$. The condition mentioned is not a condition for existence; it is the specific condition under which the (cubic) clamped spline reduces to the (linear) natural spline.\n**Verdict: Incorrect.**\n\n- **E. With $2$ data points, a natural cubic spline is any cubic interpolant of the two points, because the second-derivative continuity conditions are vacuous when there are no interior knots.**\nThis statement is incorrect. It confuses the vacuous continuity conditions at interior knots with the non-vacuous boundary conditions. The natural spline definition explicitly imposes $s''(x_0)=0$ and $s''(x_1)=0$. These are $2$ powerful constraints that, together with the $2$ interpolation constraints, uniquely determine the polynomial. This leads to a single, unique solution (the line), not a family of \"any cubic interpolant.\" An infinite number of cubic polynomials can interpolate two points, but only one of them is the natural spline.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "3220918"}, {"introduction": "Building on the simplest case, this exercise introduces the first interior knot by considering a three-point system. This hands-on derivation demystifies the spline construction process by requiring a step-by-step application of the $C^2$ continuity rules from first principles. It provides a concrete analytical look at how endpoint conditions—whether natural or clamped—propagate through the system and affect the entire curve [@problem_id:3220853].", "problem": "Let $x_0=0$, $x_1=1$, and $x_2=2$ be three distinct nodes with associated data values $y_0$, $y_1$, and $y_2$. Consider a twice continuously differentiable piecewise-cubic interpolant $S(x)$ with two cubic pieces $S_0(x)$ on $[x_0,x_1]$ and $S_1(x)$ on $[x_1,x_2]$, satisfying the standard cubic spline interpolation conditions at the nodes and the continuity of first and second derivatives at the interior knot $x_1$. Starting only from the defining properties of a cubic spline (piecewise cubic on each interval, $C^2$ continuity on the closed domain $[x_0,x_2]$, interpolation at the nodes, and boundary conditions), perform the following.\n\n1. Derive the closed-form expression for the natural cubic spline on $[0,2]$, that is, the unique $S(x)$ with $S''(x_0)=0$ and $S''(x_2)=0$, by explicitly solving for the coefficients of the two cubic polynomials $S_0(x)$ and $S_1(x)$ from the interpolation and smoothness conditions.\n2. Derive the closed-form expression for the clamped cubic spline on $[0,2]$, that is, the unique $S(x)$ with $S'(x_0)=m_0$ and $S'(x_2)=m_2$, where $m_0$ and $m_2$ are given endpoint slopes, again by explicitly solving for the coefficients of $S_0(x)$ and $S_1(x)$ from the interpolation and smoothness conditions.\n3. Using your explicit formulas, analyze how the endpoint constraints propagate to the interior cubic $S_0(x)$ on $[0,1]$ by expressing its coefficients in terms of $y_0$, $y_1$, $y_2$, and, in the clamped case, $m_0$ and $m_2$. In particular, discuss which endpoint quantities influence the cubic coefficient of $S_0(x)$.\n\nYour final reported answer must be a single analytical expression: the coefficient of $x^3$ in $S_0(x)$ for the natural spline minus the coefficient of $x^3$ in $S_0(x)$ for the clamped spline, expressed in terms of $y_0$, $y_1$, $y_2$, $m_0$, and $m_2$. No numerical evaluation is required, and no rounding is needed. Do not include units.", "solution": "The problem is to derive and compare the natural and clamped cubic splines for a given set of three nodes. The derivation will proceed from the fundamental properties of a cubic spline.\n\nA cubic spline $S(x)$ interpolating data $(x_i, y_i)$ for $i=0, 1, \\dots, n$ is a piecewise cubic function. On each subinterval $[x_i, x_{i+1}]$, $S(x)$ is a cubic polynomial, denoted $S_i(x)$. The spline and its first and second derivatives are continuous, i.e., $S(x) \\in C^2[x_0, x_n]$.\n\nIn this problem, we have nodes $x_0=0$, $x_1=1$, and $x_2=2$, with data values $y_0, y_1, y_2$. The step sizes are uniform: $h_0 = x_1 - x_0 = 1$ and $h_1 = x_2 - x_1 = 1$. Let $h=1$. The spline consists of two cubic pieces: $S_0(x)$ on $[0,1]$ and $S_1(x)$ on $[1,2]$.\n\nSince $S_i(x)$ is a cubic polynomial, its second derivative $S_i''(x)$ is a linear function. Due to the $C^2$ continuity of $S(x)$, the second derivatives at the nodes, $M_i = S''(x_i)$, are well-defined. The linearity of $S_i''(x)$ allows us to express it as:\n$$S_i''(x) = M_i \\frac{x_{i+1} - x}{h_i} + M_{i+1} \\frac{x - x_i}{h_i}$$\nIntegrating this expression twice with respect to $x$ and imposing the interpolation conditions $S_i(x_i) = y_i$ and $S_i(x_{i+1}) = y_{i+1}$ yields the expression for $S_i(x)$:\n$$S_i(x) = \\frac{M_i}{6h_i}(x_{i+1}-x)^3 + \\frac{M_{i+1}}{6h_i}(x-x_i)^3 + \\left(\\frac{y_i}{h_i} - \\frac{M_i h_i}{6}\\right)(x_{i+1}-x) + \\left(\\frac{y_{i+1}}{h_i} - \\frac{M_{i+1}h_i}{6}\\right)(x-x_i)$$\nThe continuity of the first derivative, $S'_{i-1}(x_i) = S'_i(x_i)$, provides a system of linear equations for the unknown moments $M_i$. For an interior node $x_i$, this condition leads to the general equation:\n$$h_{i-1}M_{i-1} + 2(h_{i-1}+h_i)M_i + h_iM_{i+1} = 6\\left(\\frac{y_{i+1}-y_i}{h_i} - \\frac{y_i-y_{i-1}}{h_{i-1}}\\right)$$\nIn our specific case, there is one interior node, $x_1=1$. With $h_0=h_1=1$, the equation for $i=1$ becomes:\n$$1 \\cdot M_0 + 2(1+1)M_1 + 1 \\cdot M_2 = 6\\left(\\frac{y_2-y_1}{1} - \\frac{y_1-y_0}{1}\\right)$$\n$$M_0 + 4M_1 + M_2 = 6(y_0 - 2y_1 + y_2)$$\nThis single equation has three unknowns, $M_0, M_1, M_2$. Two additional equations are provided by the boundary conditions.\n\nWe can express the polynomial pieces $S_0(x)$ and $S_1(x)$ in the form $S_i(x) = a_i + b_i(x-x_i) + c_i(x-x_i)^2 + d_i(x-x_i)^3$. The coefficients are given by derivatives at $x_i$:\n$a_i = S(x_i) = y_i$\n$b_i = S'(x_i)$\n$c_i = S''(x_i)/2 = M_i/2$\n$d_i = S'''(x_i)/6 = \\frac{M_{i+1}-M_i}{6h_i}$\nThe first derivative $S'(x_i)$ can also be expressed in terms of moments: $S'_i(x_i) = \\frac{y_{i+1}-y_i}{h_i} - \\frac{h_i}{6}(2M_i+M_{i+1})$.\n\n### 1. Natural Cubic Spline\nThe natural boundary conditions are $S''(x_0)=0$ and $S''(x_2)=0$, which implies $M_0=0$ and $M_2=0$.\nSubstituting these into the continuity equation:\n$$0 + 4M_1 + 0 = 6(y_0 - 2y_1 + y_2)$$\n$$M_1 = \\frac{3}{2}(y_0 - 2y_1 + y_2)$$\nNow we find the coefficients for $S_{0,nat}(x)$ on $[0,1]$:\n$a_0 = y_0$\n$c_0 = M_0/2 = 0$\n$d_0 = \\frac{M_1 - M_0}{6h_0} = \\frac{M_1 - 0}{6(1)} = \\frac{1}{6} \\left(\\frac{3}{2}(y_0 - 2y_1 + y_2)\\right) = \\frac{1}{4}(y_0 - 2y_1 + y_2)$\n$b_0 = S'_0(x_0) = \\frac{y_1-y_0}{h_0} - \\frac{h_0}{6}(2M_0+M_1) = (y_1-y_0) - \\frac{1}{6}(0+M_1) = y_1 - y_0 - \\frac{1}{6}\\left(\\frac{3}{2}(y_0 - 2y_1 + y_2)\\right)$\n$b_0 = y_1 - y_0 - \\frac{1}{4}y_0 + \\frac{1}{2}y_1 - \\frac{1}{4}y_2 = -\\frac{5}{4}y_0 + \\frac{3}{2}y_1 - \\frac{1}{4}y_2$\nSo, the first polynomial piece of the natural spline is:\n$$S_{0,nat}(x) = y_0 + \\left(-\\frac{5}{4}y_0 + \\frac{3}{2}y_1 - \\frac{1}{4}y_2\\right) x + \\frac{1}{4}(y_0 - 2y_1 + y_2) x^3$$\nFor completeness, for $S_{1,nat}(x)$ on $[1,2]$:\n$a_1 = y_1$, $c_1 = M_1/2 = \\frac{3}{4}(y_0 - 2y_1 + y_2)$, $d_1 = \\frac{M_2-M_1}{6h_1} = -\\frac{M_1}{6} = -\\frac{1}{4}(y_0 - 2y_1 + y_2)$, and $b_1 = S'_1(x_1) = S'_0(x_1) = b_0 + 2c_0 + 3d_0 = b_0+3d_0 = (-\\frac{5}{4}y_0 + \\frac{3}{2}y_1 - \\frac{1}{4}y_2) + 3(\\frac{1}{4}(y_0 - 2y_1 + y_2)) = -\\frac{1}{2}y_0 + \\frac{1}{2}y_2$.\n\n### 2. Clamped Cubic Spline\nThe clamped boundary conditions are $S'(x_0)=m_0$ and $S'(x_2)=m_2$.\nThe condition $S'_0(x_0)=m_0$ gives:\n$m_0 = \\frac{y_1-y_0}{h_0} - \\frac{h_0}{6}(2M_0+M_1) \\implies m_0 = y_1 - y_0 - \\frac{1}{6}(2M_0+M_1)$, which leads to:\n$2M_0 + M_1 = 6(y_1 - y_0 - m_0)$\nThe condition $S'_1(x_2)=m_2$ gives:\n$m_2 = S'_1(x_1+h_1) = \\frac{y_2-y_1}{h_1} + \\frac{h_1}{6}(M_1+2M_2) \\implies m_2 = y_2 - y_1 + \\frac{1}{6}(M_1+2M_2)$, which leads to:\n$M_1 + 2M_2 = 6(m_2 - y_2 + y_1)$\nWe have a system of three linear equations for $M_0, M_1, M_2$:\n(1) $M_0 + 4M_1 + M_2 = 6(y_0 - 2y_1 + y_2)$\n(2) $2M_0 + M_1 = 6(y_1 - y_0 - m_0)$\n(3) $M_1 + 2M_2 = 6(m_2 - y_2 + y_1)$\nFrom (2) and (3), we express $M_0$ and $M_2$ in terms of $M_1$:\n$M_0 = 3(y_1-y_0-m_0) - \\frac{1}{2}M_1$\n$M_2 = 3(m_2-y_2+y_1) - \\frac{1}{2}M_1$\nSubstituting these into (1):\n$[3(y_1-y_0-m_0) - \\frac{1}{2}M_1] + 4M_1 + [3(m_2-y_2+y_1) - \\frac{1}{2}M_1] = 6(y_0 - 2y_1 + y_2)$\n$3M_1 - 3y_0 + 6y_1 - 3y_2 - 3m_0 + 3m_2 = 6y_0 - 12y_1 + 6y_2$\n$3M_1 = 9y_0 - 18y_1 + 9y_2 + 3m_0 - 3m_2$\n$M_1 = 3(y_0 - 2y_1 + y_2) + m_0 - m_2$\nNow we find $M_0$:\n$M_0 = 3(y_1-y_0-m_0) - \\frac{1}{2}(3(y_0 - 2y_1 + y_2) + m_0 - m_2) = -\\frac{9}{2}y_0 + 6y_1 - \\frac{3}{2}y_2 - \\frac{7}{2}m_0 + \\frac{1}{2}m_2$.\nNow we find the coefficients for $S_{0,clamped}(x)$ on $[0,1]$:\n$a_0 = y_0$\n$b_0 = S'_0(x_0) = m_0$\n$c_0 = M_0/2 = -\\frac{9}{4}y_0 + 3y_1 - \\frac{3}{4}y_2 - \\frac{7}{4}m_0 + \\frac{1}{4}m_2$\n$d_0 = \\frac{M_1 - M_0}{6h_0} = \\frac{1}{6}(M_1 - M_0)$\n$M_1-M_0 = (3y_0-6y_1+3y_2+m_0-m_2) - (-\\frac{9}{2}y_0+6y_1-\\frac{3}{2}y_2-\\frac{7}{2}m_0+\\frac{1}{2}m_2) = \\frac{15}{2}y_0 - 12y_1 + \\frac{9}{2}y_2 + \\frac{9}{2}m_0 - \\frac{3}{2}m_2$\n$d_0 = \\frac{1}{6}\\left(\\frac{15}{2}y_0 - 12y_1 + \\frac{9}{2}y_2 + \\frac{9}{2}m_0 - \\frac{3}{2}m_2\\right) = \\frac{5}{4}y_0 - 2y_1 + \\frac{3}{4}y_2 + \\frac{3}{4}m_0 - \\frac{1}{4}m_2$\nThe first polynomial piece of the clamped spline is:\n$$S_{0,clamped}(x) = y_0 + m_0 x + \\left(-\\frac{9}{4}y_0 + 3y_1 - \\frac{3}{4}y_2 - \\frac{7}{4}m_0 + \\frac{1}{4}m_2\\right) x^2 + \\left(\\frac{5}{4}y_0 - 2y_1 + \\frac{3}{4}y_2 + \\frac{3}{4}m_0 - \\frac{1}{4}m_2\\right) x^3$$\n\n### 3. Analysis and Comparison\nThe final part of the problem is to analyze the cubic coefficient of $S_0(x)$ in both cases and compute their difference.\n\nThe cubic coefficient of $S_{0,nat}(x)$ is $d_{0,nat} = \\frac{1}{4}(y_0 - 2y_1 + y_2)$. This coefficient depends on all three data values $y_0, y_1, y_2$. The information from the endpoint at $x_2=2$, namely $y_2$, propagates to the coefficients of the polynomial on the first interval $[0,1]$. This illustrates the global nature of spline interpolation; a change in any data point affects the entire curve.\n\nThe cubic coefficient of $S_{0,clamped}(x)$ is $d_{0,clamped} = \\frac{5}{4}y_0 - 2y_1 + \\frac{3}{4}y_2 + \\frac{3}{4}m_0 - \\frac{1}{4}m_2$. This coefficient depends on all data values $y_0, y_1, y_2$, and also on both endpoint slope constraints $m_0$ and $m_2$. The influence is again global: the prescribed slope $m_2$ at the far endpoint $x_2=2$ affects the cubic term of the spline on the initial interval $[0,1]$.\n\nThe difference between the two cubic coefficients is:\n$$d_{0,nat} - d_{0,clamped} = \\left(\\frac{1}{4}y_0 - \\frac{1}{2}y_1 + \\frac{1}{4}y_2\\right) - \\left(\\frac{5}{4}y_0 - 2y_1 + \\frac{3}{4}y_2 + \\frac{3}{4}m_0 - \\frac{1}{4}m_2\\right)$$\n$$d_{0,nat} - d_{0,clamped} = \\left(\\frac{1}{4} - \\frac{5}{4}\\right)y_0 + \\left(-\\frac{1}{2} + 2\\right)y_1 + \\left(\\frac{1}{4} - \\frac{3}{4}\\right)y_2 - \\frac{3}{4}m_0 + \\frac{1}{4}m_2$$\n$$d_{0,nat} - d_{0,clamped} = -y_0 + \\frac{3}{2}y_1 - \\frac{1}{2}y_2 - \\frac{3}{4}m_0 + \\frac{1}{4}m_2$$", "answer": "$$\\boxed{-y_0 + \\frac{3}{2}y_1 - \\frac{1}{2}y_2 - \\frac{3}{4}m_0 + \\frac{1}{4}m_2}$$", "id": "3220853"}, {"introduction": "This coding exercise moves from abstract formulas to tangible results, demonstrating a critical practical trade-off between natural and clamped splines. By implementing and testing splines on a dataset designed to induce oscillations, you will gain a powerful visual and numerical intuition for why the \"natural\" boundary condition is not always the best choice. This practice highlights how appropriately chosen clamped conditions can prevent the counter-intuitive overshooting that natural splines sometimes exhibit [@problem_id:3220873].", "problem": "You are asked to implement from first principles the construction and evaluation of cubic spline interpolants with two distinct endpoint boundary conditions: the natural boundary condition and the clamped boundary condition. A cubic spline is defined as a function composed of piecewise cubic polynomials on consecutive subintervals that interpolate given data points and is twice continuously differentiable across the entire domain. The natural boundary condition sets the second derivative at the endpoints to zero, while the clamped boundary condition specifies the first derivative at the endpoints. Your task is to:\n- Derive an algorithmic formulation to compute a unique cubic spline interpolant for strictly increasing abscissae $\\{x_i\\}_{i=0}^{n-1}$ and corresponding ordinates $\\{y_i\\}_{i=0}^{n-1}$, under either the natural or the clamped boundary condition. The derivation must begin from the defining properties: cubic-by-interval, interpolation constraints, and continuity up to the second derivative at the internal knots.\n- Implement both boundary condition choices. For the clamped boundary condition, use endpoint derivatives given by the one-sided secant slopes,\n$$\ns_0 \\equiv \\frac{y_1 - y_0}{x_1 - x_0}, \\quad s_{n-1} \\equiv \\frac{y_{n-1} - y_{n-2}}{x_{n-1} - x_{n-2}}.\n$$\n\nTo quantify counter-intuitive oscillation, define the overshoot magnitude on one subinterval $[x_i,x_{i+1}]$ as follows. Let $m_i = \\min\\{y_i,y_{i+1}\\}$ and $M_i = \\max\\{y_i,y_{i+1}\\}$. Let $S(x)$ denote the spline value. The overshoot magnitude on $[x_i,x_{i+1}]$ is\n$$\n\\Delta_i \\equiv \\max\\Big\\{ \\max_{x \\in [x_i,x_{i+1}]} \\big(S(x) - M_i\\big), \\ \\max_{x \\in [x_i,x_{i+1}]}\\big(m_i - S(x)\\big), \\ 0 \\Big\\}.\n$$\nThe global overshoot is $\\Delta \\equiv \\max_i \\Delta_i$. Numerically approximate the subinterval maxima by evaluating $S(x)$ on a uniform grid of $1001$ points on each $[x_i,x_{i+1}]$.\n\nImplement a single program that:\n- Constructs both the natural spline and the clamped spline (with the above $s_0$ and $s_{n-1}$) for each dataset in the test suite.\n- Evaluates and reports the global overshoot $\\Delta$ for each spline.\n\nYour implementation must be fully self-contained and must not call external libraries beyond the specified ones. All computations are in pure mathematics (no physical units).\n\nTest suite. Use the following datasets, each given as lists $x$ and $y$ of equal length with strictly increasing $x$:\n\n- Case A (left-end steepening that induces a large natural-spline oscillation near the left endpoint):\n  - $x = [\\,0.0,\\,0.5,\\,0.6,\\,2.0\\,]$\n  - $y = [\\,0.0,\\,1.0,\\,10.0,\\,12.0\\,]$\n\n- Case B (near-linear, happy-path):\n  - $x = [\\,0.0,\\,1.0,\\,2.0,\\,3.0\\,]$\n  - $y = [\\,0.0,\\,1.0,\\,2.0,\\,3.0\\,]$\n\n- Case C (right-end steepening that induces a natural-spline oscillation near the right endpoint):\n  - $x = [\\,0.0,\\,1.4,\\,1.5,\\,2.0\\,]$\n  - $y = [\\,0.0,\\,2.0,\\,3.0,\\,3.2\\,]$\n\nFor each case, compute and return the pair of overshoot magnitudes $\\Delta_{\\text{natural}}$ and $\\Delta_{\\text{clamped}}$ as floating-point numbers. Your program should produce a single line of output containing all results concatenated in order as a comma-separated list enclosed in square brackets, in the order\n$$\n[\\,\\Delta_{\\text{natural}}^{(A)},\\,\\Delta_{\\text{clamped}}^{(A)},\\,\\Delta_{\\text{natural}}^{(B)},\\,\\Delta_{\\text{clamped}}^{(B)},\\,\\Delta_{\\text{natural}}^{(C)},\\,\\Delta_{\\text{clamped}}^{(C)}\\,].\n$$", "solution": "The user requires a derivation and implementation of cubic spline interpolation for both natural and clamped boundary conditions. The derivation must proceed from first principles, and the implementation must compute the global overshoot for several test cases.\n\n### Derivation of the Cubic Spline Interpolant\n\nA cubic spline $S(x)$ interpolating a set of $n$ data points $(x_i, y_i)$ for $i=0, 1, \\ldots, n-1$ with strictly increasing abscissae $x_0 < x_1 < \\ldots < x_{n-1}$ is a piecewise function defined on $[x_0, x_{n-1}]$. For each subinterval $[x_i, x_{i+1}]$, the spline segment $S_i(x)$ is a cubic polynomial. The entire spline $S(x)$ must satisfy the following properties:\n1.  **Interpolation**: $S(x_i) = y_i$ for all $i=0, \\ldots, n-1$.\n2.  **Continuity**: $S(x)$ is twice continuously differentiable on $[x_0, x_{n-1}]$, i.e., $S \\in C^2[x_0, x_{n-1}]$. This implies that at each interior knot $x_i$ ($i=1, \\ldots, n-2$), $S_{i-1}(x_i) = S_i(x_i)$, $S'_{i-1}(x_i) = S'_i(x_i)$, and $S''_{i-1}(x_i) = S''_i(x_i)$.\n\nLet us define the second derivatives of the spline at the knots as $M_i = S''(x_i)$ for $i=0, \\ldots, n-1$. Since each segment $S_i(x)$ is a cubic polynomial, its second derivative $S_i''(x)$ is a linear function. On the interval $[x_i, x_{i+1}]$, $S_i''(x)$ passes through the points $(x_i, M_i)$ and $(x_{i+1}, M_{i+1})$. Let $h_i = x_{i+1} - x_i$. The linear function $S_i''(x)$ can be written using Lagrange's linear interpolation formula:\n$$\nS_i''(x) = M_i \\frac{x_{i+1} - x}{h_i} + M_{i+1} \\frac{x - x_i}{h_i}\n$$\nIntegrating $S_i''(x)$ twice with respect to $x$ gives the general form of the cubic polynomial $S_i(x)$:\n$$\nS_i(x) = M_i \\frac{(x_{i+1} - x)^3}{6h_i} + M_{i+1} \\frac{(x - x_i)^3}{6h_i} + C(x-x_i) + D(x_{i+1}-x)\n$$\nwhere $C$ and $D$ are constants of integration, expressed in a form convenient for applying the interpolation conditions.\nWe enforce the interpolation conditions $S_i(x_i) = y_i$ and $S_i(x_{i+1}) = y_{i+1}$:\nAt $x=x_i$: $y_i = M_i \\frac{h_i^3}{6h_i} + D h_i \\implies D = \\frac{y_i}{h_i} - \\frac{M_i h_i}{6}$.\nAt $x=x_{i+1}$: $y_{i+1} = M_{i+1} \\frac{h_i^3}{6h_i} + C h_i \\implies C = \\frac{y_{i+1}}{h_i} - \\frac{M_{i+1} h_i}{6}$.\n\nSubstituting these constants back, we obtain the expression for the spline segment $S_i(x)$ in terms of the known data points and the unknown second derivatives $M_i$:\n$$\nS_i(x) = \\frac{M_i}{6h_i}(x_{i+1}-x)^3 + \\frac{M_{i+1}}{6h_i}(x-x_i)^3 + \\left(\\frac{y_{i+1}}{h_i} - \\frac{M_{i+1}h_i}{6}\\right)(x-x_i) + \\left(\\frac{y_i}{h_i} - \\frac{M_i h_i}{6}\\right)(x_{i+1}-x)\n$$\nThis equation defines the spline on each subinterval $[x_i, x_{i+1}]$ for $i=0, \\ldots, n-2$. To find the unknown values $M_i$, we use the continuity condition for the first derivative, $S'_{i-1}(x_i) = S'_i(x_i)$, at the interior knots $x_i$ for $i=1, \\ldots, n-2$.\n\nFirst, we find the derivative $S'_i(x)$:\n$$\nS'_i(x) = -\\frac{M_i}{2h_i}(x_{i+1}-x)^2 + \\frac{M_{i+1}}{2h_i}(x-x_i)^2 + \\left(\\frac{y_{i+1}}{h_i} - \\frac{M_{i+1}h_i}{6}\\right) - \\left(\\frac{y_i}{h_i} - \\frac{M_i h_i}{6}\\right)\n$$\nEvaluating the derivatives at the knots:\n$S'_i(x_i) = -\\frac{M_i h_i}{2} + \\frac{y_{i+1}-y_i}{h_i} - \\frac{M_{i+1}h_i}{6} + \\frac{M_i h_i}{6} = \\frac{y_{i+1}-y_i}{h_i} - \\frac{h_i}{3}M_i - \\frac{h_i}{6}M_{i+1}$.\n$S'_{i-1}(x_i) = \\frac{M_{i-1}h_{i-1}}{6} + \\frac{M_i h_{i-1}}{3} + \\frac{y_i-y_{i-1}}{h_{i-1}}$.\n\nEquating $S'_{i-1}(x_i) = S'_i(x_i)$ for $i=1, \\ldots, n-2$:\n$$\n\\frac{y_i-y_{i-1}}{h_{i-1}} + \\frac{h_{i-1}}{6}M_{i-1} + \\frac{h_{i-1}}{3}M_i = \\frac{y_{i+1}-y_i}{h_i} - \\frac{h_i}{3}M_i - \\frac{h_i}{6}M_{i+1}\n$$\nRearranging the terms to group the unknowns $M_{i-1}$, $M_i$, and $M_{i+1}$:\n$$\nh_{i-1}M_{i-1} + (2h_{i-1} + 2h_i)M_i + h_iM_{i+1} = 6\\left(\\frac{y_{i+1}-y_i}{h_i} - \\frac{y_i-y_{i-1}}{h_{i-1}}\\right)\n$$\nThis fundamental relation provides a system of $n-2$ linear equations for the $n$ unknowns $M_0, \\ldots, M_{n-1}$. To obtain a unique solution, we need two additional equations, which are provided by the boundary conditions.\n\n### Boundary Conditions\n\n**1. Natural Spline:**\nThe natural boundary condition specifies zero curvature at the endpoints: $S''(x_0)=0$ and $S''(x_{n-1})=0$. This directly translates to:\n$$\nM_0 = 0, \\quad M_{n-1} = 0\n$$\nSubstituting these into the general system leaves $n-2$ equations for the $n-2$ unknowns $M_1, \\ldots, M_{n-2}$. The system forms a strictly diagonally dominant tridiagonal matrix, guaranteeing a unique solution.\n\n**2. Clamped Spline:**\nThe clamped boundary condition specifies the first derivatives at the endpoints: $S'(x_0)=s_0$ and $S'(x_{n-1})=s_{n-1}$.\nUsing our expression for $S'_i(x_i)$, we set $i=0$:\n$S'(x_0) = S'_0(x_0) = \\frac{y_1-y_0}{h_0} - \\frac{h_0}{3}M_0 - \\frac{h_0}{6}M_1 = s_0$.\nRearranging gives the first boundary equation:\n$$\n2h_0M_0 + h_0M_1 = 6\\left(\\frac{y_1-y_0}{h_0} - s_0\\right)\n$$\nFor the condition at $x_{n-1}$, we evaluate $S'_{n-2}(x_{n-1})=s_{n-1}$:\n$S'_{n-2}(x_{n-1}) = \\frac{y_{n-1}-y_{n-2}}{h_{n-2}} + \\frac{h_{n-2}}{6}M_{n-2} + \\frac{h_{n-2}}{3}M_{n-1} = s_{n-1}$.\nRearranging gives the second boundary equation:\n$$\nh_{n-2}M_{n-2} + 2h_{n-2}M_{n-1} = 6\\left(s_{n-1} - \\frac{y_{n-1}-y_{n-2}}{h_{n-2}}\\right)\n$$\nThe problem specifies particular values for $s_0$ and $s_{n-1}$:\n$s_0 = \\frac{y_1 - y_0}{x_1 - x_0} = \\frac{y_1 - y_0}{h_0}$\n$s_{n-1} = \\frac{y_{n-1} - y_{n-2}}{x_{n-1} - x_{n-2}} = \\frac{y_{n-1} - y_{n-2}}{h_{n-2}}$\nWith these choices, the right-hand sides of both boundary equations become zero:\n$2h_0M_0 + h_0M_1 = 0 \\implies 2M_0 + M_1 = 0$.\n$h_{n-2}M_{n-2} + 2h_{n-2}M_{n-1} = 0 \\implies M_{n-2} + 2M_{n-1} = 0$.\nThese two equations, combined with the $n-2$ interior equations, form a full $n \\times n$ tridiagonal system for the unknowns $M_0, \\ldots, M_{n-1}$. This system is also strictly diagonally dominant and has a unique solution.\n\n### Overshoot Calculation\n\nThe overshoot magnitude on a subinterval $[x_i, x_{i+1}]$ is defined as:\n$$\n\\Delta_i = \\max\\left\\{ \\max_{x \\in [x_i,x_{i+1}]} \\left(S(x) - \\max\\{y_i,y_{i+1}\\}\\right), \\ \\max_{x \\in [x_i,x_{i+1}]}\\left(\\min\\{y_i,y_{i+1}\\} - S(x)\\right), \\ 0 \\right\\}\n$$\nThe global overshoot is the maximum over all subintervals, $\\Delta = \\max_i \\Delta_i$. Computationally, the maxima on each subinterval are approximated by evaluating the spline $S(x)$ on a fine uniform grid of $1001$ points spanning $[x_i, x_{i+1}]$. This procedure quantifies the extent to which the spline oscillates beyond the range of the data points it interpolates.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_tdma(lower, main, upper, d):\n    \"\"\"\n    Solves a tridiagonal system of equations Ax=d using the Thomas algorithm.\n\n    Args:\n        lower (np.ndarray): The lower diagonal of A (length n-1).\n        main (np.ndarray): The main diagonal of A (length n).\n        upper (np.ndarray): The upper diagonal of A (length n-1).\n        d (np.ndarray): The right-hand side vector (length n).\n\n    Returns:\n        np.ndarray: The solution vector x.\n    \"\"\"\n    n = len(main)\n    c_p = np.zeros(n)\n    d_p = np.zeros(n)\n\n    # Forward elimination\n    c_p[0] = upper[0] / main[0]\n    d_p[0] = d[0] / main[0]\n    for i in range(1, n):\n        denom = main[i] - lower[i-1] * c_p[i-1]\n        if i < n - 1:\n            c_p[i] = upper[i] / denom\n        d_p[i] = (d[i] - lower[i-1] * d_p[i-1]) / denom\n\n    # Backward substitution\n    x = np.zeros(n)\n    x[n-1] = d_p[n-1]\n    for i in range(n-2, -1, -1):\n        x[i] = d_p[i] - c_p[i] * x[i+1]\n    return x\n\nclass CubicSpline:\n    \"\"\"\n    A class for computing and evaluating cubic spline interpolants.\n    \"\"\"\n    def __init__(self, x, y, bc_type='natural'):\n        self.x = np.asarray(x, dtype=float)\n        self.y = np.asarray(y, dtype=float)\n        self.n = len(x)\n        \n        if self.n < 2:\n            raise ValueError(\"Need at least 2 points for interpolation.\")\n        \n        self.h = self.x[1:] - self.x[:-1]\n        \n        if np.any(self.h <= 0):\n            raise ValueError(\"x coordinates must be strictly increasing.\")\n\n        if bc_type == 'natural':\n            self._compute_natural_spline()\n        elif bc_type == 'clamped':\n            self._compute_clamped_spline()\n        else:\n            raise ValueError(f\"Unsupported boundary condition type: {bc_type}\")\n\n    def _compute_natural_spline(self):\n        \"\"\"Computes the second derivatives M for a natural spline.\"\"\"\n        if self.n <= 2:\n            self.M = np.zeros(self.n)\n            return\n\n        N = self.n - 2  # Size of the internal system\n        \n        A_lower = self.h[1:-1]\n        A_main = 2 * (self.h[:-1] + self.h[1:])\n        A_upper = self.h[1:-1]\n\n        delta = (self.y[1:] - self.y[:-1]) / self.h\n        b_rhs = 6 * (delta[1:] - delta[:-1])\n\n        M_internal = solve_tdma(A_lower, A_main, A_upper, b_rhs)\n        \n        self.M = np.zeros(self.n)\n        self.M[1:-1] = M_internal\n\n    def _compute_clamped_spline(self):\n        \"\"\"Computes the second derivatives M for a clamped spline with specified derivatives.\"\"\"\n        if self.n <= 2:\n            # Linear interpolation for 2 points, second derivatives are zero\n            self.M = np.zeros(self.n)\n            return\n\n        N = self.n\n        A_lower = np.zeros(N - 1)\n        A_main = np.zeros(N)\n        A_upper = np.zeros(N - 1)\n        b_rhs = np.zeros(N)\n\n        # First row from boundary condition: 2*M_0 + M_1 = 0\n        A_main[0] = 2.0\n        A_upper[0] = 1.0\n        b_rhs[0] = 0.0\n\n        # Internal rows\n        delta = (self.y[1:] - self.y[:-1]) / self.h\n        internal_rhs = 6 * (delta[1:] - delta[:-1])\n        b_rhs[1:-1] = internal_rhs\n\n        A_main[1:-1] = 2 * (self.h[:-1] + self.h[1:])\n        A_lower[:-1] = self.h[:-1]\n        A_upper[1:] = self.h[1:]\n\n        # Last row from boundary condition: M_{n-2} + 2*M_{n-1} = 0\n        A_lower[-1] = 1.0\n        A_main[-1] = 2.0\n        b_rhs[-1] = 0.0\n        \n        self.M = solve_tdma(A_lower, A_main, A_upper, b_rhs)\n\n    def evaluate(self, x_eval):\n        \"\"\"Evaluates the spline at given points.\"\"\"\n        x_eval = np.asarray(x_eval)\n        indices = np.searchsorted(self.x, x_eval, side='right') - 1\n        indices = np.clip(indices, 0, self.n - 2)\n\n        xi = self.x[indices]\n        xi1 = self.x[indices + 1]\n        yi = self.y[indices]\n        yi1 = self.y[indices + 1]\n        hi = self.h[indices]\n        Mi = self.M[indices]\n        Mi1 = self.M[indices + 1]\n\n        t = x_eval - xi\n        t_comp = xi1 - x_eval\n        \n        term1 = (Mi / (6 * hi)) * (t_comp**3)\n        term2 = (Mi1 / (6 * hi)) * (t**3)\n        term3 = (yi1 / hi - Mi1 * hi / 6) * t\n        term4 = (yi / hi - Mi * hi / 6) * t_comp\n        \n        return term1 + term2 + term3 + term4\n\ndef calculate_overshoot(spline, n_grid=1001):\n    \"\"\"Calculates the global overshoot magnitude for a given spline.\"\"\"\n    max_overshoot = 0.0\n    for i in range(spline.n - 1):\n        xi, xi1 = spline.x[i], spline.x[i+1]\n        yi, yi1 = spline.y[i], spline.y[i+1]\n        \n        m_i = min(yi, yi1)\n        M_i = max(yi, yi1)\n        \n        x_grid = np.linspace(xi, xi1, n_grid)\n        y_grid = spline.evaluate(x_grid)\n        \n        overshoot = np.max(y_grid) - M_i\n        undershoot = m_i - np.min(y_grid)\n        \n        interval_max_deviation = max(overshoot, undershoot, 0.0)\n        \n        if interval_max_deviation > max_overshoot:\n            max_overshoot = interval_max_deviation\n            \n    return max_overshoot\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case A (left-end steepening)\n        {'x': [0.0, 0.5, 0.6, 2.0], 'y': [0.0, 1.0, 10.0, 12.0]},\n        # Case B (near-linear)\n        {'x': [0.0, 1.0, 2.0, 3.0], 'y': [0.0, 1.0, 2.0, 3.0]},\n        # Case C (right-end steepening)\n        {'x': [0.0, 1.4, 1.5, 2.0], 'y': [0.0, 2.0, 3.0, 3.2]}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        x = case['x']\n        y = case['y']\n        \n        # Natural Spline\n        natural_spline = CubicSpline(x, y, bc_type='natural')\n        delta_natural = calculate_overshoot(natural_spline)\n        results.append(delta_natural)\n        \n        # Clamped Spline\n        clamped_spline = CubicSpline(x, y, bc_type='clamped')\n        delta_clamped = calculate_overshoot(clamped_spline)\n        results.append(delta_clamped)\n\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3220873"}]}