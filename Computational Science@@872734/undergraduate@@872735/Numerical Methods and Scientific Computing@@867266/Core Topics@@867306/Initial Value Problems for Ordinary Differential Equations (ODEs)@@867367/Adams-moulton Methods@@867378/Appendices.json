{"hands_on_practices": [{"introduction": "The best way to understand a numerical method is to perform a calculation by hand. This first practice guides you through a single step of a popular predictor-corrector scheme, which pairs an explicit predictor with an implicit Adams-Moulton corrector. This exercise will help you master the fundamental mechanics of these powerful and widely used two-stage methods.", "problem": "Consider the initial value problem defined by the ordinary differential equation $y'(t) = y(t) - t^2 + 1$. Suppose we are using a numerical method with a fixed step size $h = 0.2$ to approximate the solution. We are given the first two points on the approximate solution curve: at $t_0 = 0.0$, the value is $y_0 = 0.5$, and at $t_1 = 0.2$, the value is $y_1 = 0.82930$.\n\nYour task is to compute the next value, $y_2$, at time $t_2 = 0.4$, by applying a single step of the following predictor-corrector scheme.\n\nFirst, compute a predicted value $y_{i+1}^*$ using the formula:\n$$y_{i+1}^* = y_i + \\frac{h}{2}\\left(3f(t_i, y_i) - f(t_{i-1}, y_{i-1})\\right)$$\nwhere $f(t,y) = y'(t)$.\n\nSecond, use this predicted value to compute the corrected value $y_{i+1}$ using the formula:\n$$y_{i+1} = y_i + \\frac{h}{2}\\left(f(t_{i+1}, y_{i+1}^*) + f(t_i, y_i)\\right)$$\n\nReport the final corrected value $y_2$. Round your final answer to five significant figures.", "solution": "We are given the ODE $y'(t)=f(t,y)=y-t^2+1$ and step size $h=0.2$, with known values $(t_0, y_0)=(0.0, 0.5)$ and $(t_1, y_1)=(0.2, 0.82930)$. We aim to compute $y_2$ at $t_2=0.4$ using the specified predictor-corrector scheme.\n\nFirst, compute the needed function values at the known points:\n$$f(t_0, y_0) = y_0 - t_0^2 + 1 = 0.5 - 0 + 1 = 1.5$$\n$$f(t_1, y_1) = y_1 - t_1^2 + 1 = 0.82930 - 0.04 + 1 = 1.78930$$\n\nPredictor (Adams-Bashforth two-step):\n$$y_2^*=y_1+\\frac{h}{2}\\left(3f(t_1,y_1)-f(t_0,y_0)\\right) = 0.82930+0.1\\left(3\\cdot 1.78930-1.5\\right)=0.82930+0.1\\cdot 3.86790=1.216090$$\n\nEvaluate $f$ at the predicted point $(t_2, y_2^*) = (0.4, 1.216090)$:\n$$f(t_2, y_2^*) = y_2^* - t_2^2 + 1 = 1.216090 - 0.16 + 1 = 2.056090$$\n\nCorrector (trapezoidal step using the predicted endpoint value):\n$$y_2=y_1+\\frac{h}{2}\\left(f(t_2, y_2^*) + f(t_1,y_1)\\right) = 0.82930+0.1\\left(2.056090+1.78930\\right) = 0.82930+0.3845390=1.2138390$$\n\nRounding to five significant figures yields $1.2138$.", "answer": "$$\\boxed{1.2138}$$", "id": "2152822"}, {"introduction": "Having seen the predictor-corrector workflow, we now focus on the core characteristic of Adams-Moulton methods: their implicit nature. This practice asks you to set up the equation for the next time step, $y_{i+1}$, for a nonlinear Ordinary Differential Equation (ODE). You will see how the unknown value $y_{i+1}$ appears on both sides of the equation, creating an algebraic problem that must be solved to advance the solution.", "problem": "Consider the numerical solution of a first-order Ordinary Differential Equation (ODE) of the form $y'(t) = f(t, y(t))$ with a constant step size $h$. The two-step Adams-Moulton method is an implicit multistep method given by the formula:\n$$y_{i+1} = y_i + \\frac{h}{12}(5 f_{i+1} + 8 f_i - f_{i-1})$$\nwhere $y_k$ is the numerical approximation of $y(t_k)$, $t_k = t_0 + kh$, and $f_k = f(t_k, y_k)$.\n\nApply this method to the specific nonlinear ODE:\n$$y'(t) = \\cos(y(t)) + t$$\n\nWhich of the following represents the correct implicit algebraic equation that must be solved for $y_{i+1}$ at each step?\n\nA. $y_{i+1} = y_i + \\frac{h}{12}(5(\\cos(y_{i+1}) + t_{i+1}) + 8(\\cos(y_i) + t_i) - (\\cos(y_{i-1}) + t_{i-1}))$\n\nB. $y_{i+1} = y_i + \\frac{h}{12}(5(\\cos(y_{i+1}) + t_{i+1}) - 8(\\cos(y_i) + t_i) + (\\cos(y_{i-1}) + t_{i-1}))$\n\nC. $y_{i+1} = y_i + \\frac{h}{2}(3(\\cos(y_i) + t_i) - (\\cos(y_{i-1}) + t_{i-1}))$\n\nD. $y_{i+1} = y_i + \\frac{h}{12}(8(\\cos(y_{i+1}) + t_{i+1}) + 5(\\cos(y_i) + t_i) - (\\cos(y_{i-1}) + t_{i-1}))$", "solution": "The goal is to find the specific form of the two-step Adams-Moulton method for the given Ordinary Differential Equation (ODE).\n\nFirst, let's identify the function $f(t, y)$ from the given ODE. The ODE is $y'(t) = \\cos(y(t)) + t$. By comparing this to the general form $y'(t) = f(t, y(t))$, we can identify the function as:\n$$f(t, y) = \\cos(y) + t$$\n\nThe general formula for the two-step Adams-Moulton method is provided in the problem statement:\n$$y_{i+1} = y_i + \\frac{h}{12}(5 f_{i+1} + 8 f_i - f_{i-1})$$\nHere, $y_k$ is the approximation of the solution at time $t_k$, and $f_k$ is the evaluation of the function $f$ at the point $(t_k, y_k)$. That is, $f_k = f(t_k, y_k)$.\n\nTo apply the formula to our specific ODE, we need to evaluate the function $f(t, y)$ at the three required points: $(t_{i+1}, y_{i+1})$, $(t_i, y_i)$, and $(t_{i-1}, y_{i-1})$.\n\n1. For the point $(t_{i+1}, y_{i+1})$:\n   $$f_{i+1} = f(t_{i+1}, y_{i+1}) = \\cos(y_{i+1}) + t_{i+1}$$\n\n2. For the point $(t_i, y_i)$:\n   $$f_i = f(t_i, y_i) = \\cos(y_i) + t_i$$\n\n3. For the point $(t_{i-1}, y_{i-1})$:\n   $$f_{i-1} = f(t_{i-1}, y_{i-1}) = \\cos(y_{i-1}) + t_{i-1}$$\n\nNow, we substitute these three expressions for $f_{i+1}$, $f_i$, and $f_{i-1}$ back into the general Adams-Moulton formula:\n$$y_{i+1} = y_i + \\frac{h}{12}\\left[ 5(\\cos(y_{i+1}) + t_{i+1}) + 8(\\cos(y_i) + t_i) - (\\cos(y_{i-1}) + t_{i-1}) \\right]$$\n\nThis is the resulting implicit algebraic equation for $y_{i+1}$. The term \"implicit\" signifies that $y_{i+1}$ appears on both sides of the equation, and specifically, it is inside the nonlinear cosine function on the right-hand side, meaning it cannot be isolated through simple algebraic manipulation.\n\nFinally, we compare this derived equation with the given multiple-choice options:\n- Option A: $y_{i+1} = y_i + \\frac{h}{12}(5(\\cos(y_{i+1}) + t_{i+1}) + 8(\\cos(y_i) + t_i) - (\\cos(y_{i-1}) + t_{i-1}))$. This exactly matches our derived equation.\n- Option B: This option has incorrect signs for the $f_i$ and $f_{i-1}$ terms. The coefficients for the two-step Adams-Moulton are $(5, 8, -1)$. This option uses $(5, -8, 1)$.\n- Option C: This is the formula for the two-step Adams-Bashforth method, which is an explicit method. It does not use the $f_{i+1}$ term and has different coefficients.\n- Option D: This option swaps the coefficients for the $f_{i+1}$ and $f_i$ terms. The correct coefficients are 5 for $f_{i+1}$ and 8 for $f_i$.\n\nTherefore, the correct choice is A.", "answer": "$$\\boxed{A}$$", "id": "2152845"}, {"introduction": "The implicit nature of Adams-Moulton methods begs the question: how do we solve the resulting algebraic equation for $y_{n+1}$, and is our solution method reliable? This advanced practice explores using a fixed-point iteration to solve the corrector equation and introduces a crucial real-world complication. By analyzing the convergence conditions, you will discover why this simple iterative approach can fail, particularly for stiff differential equations, and learn to diagnose such issues using the Lipschitz constant.", "problem": "Consider the initial value problem for the scalar ordinary differential equation $y^{\\prime}(t)=f(t,y(t))$ with $f(t,y)=10\\,y+\\sin(t)$. Let $t_{n}$ and $t_{n+1}=t_{n}+h$ be two consecutive time levels with step size $h=0.3$. A predictor-corrector scheme is to be used, where the corrector is the second-order Adamsâ€“Moulton method (also known as the implicit trapezoidal rule), and the corrector equation is to be solved by fixed-point iteration of the form $y_{n+1}^{(k+1)}=g\\!\\left(y_{n+1}^{(k)}\\right)$. \n\nStarting from the fundamental identity $y(t_{n+1})=y(t_{n})+\\int_{t_{n}}^{t_{n+1}} f\\!\\left(t,y(t)\\right)\\,dt$ and approximating the integral using the trapezoidal rule applied to $f$, derive the implicit corrector equation and thereby the fixed-point map $g$ as a function of $y_{n+1}$. Using the definition of a Lipschitz constant with respect to $y_{n+1}$ for the map $g$, determine the Lipschitz constant $L$ of $g$ at this step. Conclude whether the simple fixed-point iteration is guaranteed to converge or may fail. \n\nReport only the numerical value of $L$, rounded to four significant figures.", "solution": "The problem requires the derivation of a fixed-point iteration scheme for the second-order Adams-Moulton method and the analysis of its convergence for a specific ordinary differential equation (ODE). The starting point is the fundamental integral identity for the solution $y(t)$ of the ODE $y'(t) = f(t, y(t))$:\n$$y(t_{n+1}) = y(t_{n}) + \\int_{t_{n}}^{t_{n+1}} f(t, y(t)) \\, dt$$\nHere, $t_n$ and $t_{n+1} = t_n + h$ are two consecutive time points, with step size $h$.\n\nThe corrector method is the second-order Adams-Moulton method, which is obtained by approximating the integral using the trapezoidal rule. The trapezoidal rule for the integral of a function $\\phi(t)$ over $[t_n, t_{n+1}]$ is given by $\\int_{t_n}^{t_{n+1}} \\phi(t) \\, dt \\approx \\frac{h}{2}[\\phi(t_n) + \\phi(t_{n+1})]$. Applying this rule to the function $f(t, y(t))$ yields:\n$$\\int_{t_{n}}^{t_{n+1}} f(t, y(t)) \\, dt \\approx \\frac{h}{2} [f(t_n, y(t_n)) + f(t_{n+1}, y(t_{n+1}))]$$\nSubstituting this approximation into the integral identity and replacing the exact solutions $y(t_n)$ with their numerical approximations $y_n$, we obtain the implicit formula for $y_{n+1}$:\n$$y_{n+1} = y_n + \\frac{h}{2} [f(t_n, y_n) + f(t_{n+1}, y_{n+1})]$$\nThis is the second-order Adams-Moulton method, also known as the implicit trapezoidal rule. The equation is implicit because the unknown quantity $y_{n+1}$ appears on both sides.\n\nTo solve this implicit equation for $y_{n+1}$, a fixed-point iteration is used, as stated in the problem. The iteration is of the form $y_{n+1}^{(k+1)} = g(y_{n+1}^{(k)})$, where $k$ is the iteration index. By inspection of the implicit equation, the fixed-point map $g$ is defined by the right-hand side. Let us use a generic variable $z$ to represent the argument of $g$ to avoid confusion. The map $g$ is:\n$$g(z) = y_n + \\frac{h}{2} [f(t_n, y_n) + f(t_{n+1}, z)]$$\nThe fixed-point iteration is then $y_{n+1}^{(k+1)} = g(y_{n+1}^{(k)})$.\n\nFor the fixed-point iteration to be guaranteed to converge to a unique solution, the map $g$ must be a contraction mapping on the domain of interest. According to the Contraction Mapping Theorem (or Banach Fixed-Point Theorem), this is true if the Lipschitz constant $L$ of $g$ is strictly less than $1$. For a continuously differentiable map $g$, the Lipschitz constant $L$ with respect to its variable $z$ can be taken as the supremum of the absolute value of its derivative:\n$$L = \\sup_{z} \\left| \\frac{\\partial g}{\\partial z} \\right|$$\nWe compute the derivative of $g(z)$ with respect to $z$. The terms $y_n$ and $f(t_n, y_n)$ are constants with respect to $z$.\n$$\\frac{\\partial g}{\\partial z} = \\frac{\\partial}{\\partial z} \\left( y_n + \\frac{h}{2} f(t_n, y_n) + \\frac{h}{2} f(t_{n+1}, z) \\right) = \\frac{h}{2} \\frac{\\partial f}{\\partial y}(t_{n+1}, z)$$\nNote that $\\frac{\\partial f}{\\partial z}$ is shorthand for the partial derivative of $f(t, y)$ with respect to its second argument $y$, evaluated at $(t_{n+1}, z)$.\n\nThe problem specifies the function $f(t, y) = 10y + \\sin(t)$. Its partial derivative with respect to $y$ is:\n$$\\frac{\\partial f}{\\partial y}(t, y) = \\frac{\\partial}{\\partial y} (10y + \\sin(t)) = 10$$\nThis partial derivative is a constant, independent of both $t$ and $y$. Therefore, its value at $(t_{n+1}, z)$ is also $10$.\n\nSubstituting this result back into the expression for the derivative of $g$:\n$$\\frac{\\partial g}{\\partial z} = \\frac{h}{2} \\times 10 = 5h$$\nThe Lipschitz constant $L$ is the supremum of the absolute value of this derivative. Since $5h$ is a constant, we have:\n$$L = |5h|$$\nThe problem provides the step size $h = 0.3$. We can now calculate the numerical value of $L$:\n$$L = |5 \\times 0.3| = |1.5| = 1.5$$\nThe condition for guaranteed convergence of the fixed-point iteration is $L  1$. In this case, $L = 1.5$, which is greater than $1$. Therefore, the map $g$ is not a contraction, and the simple fixed-point iteration is not guaranteed to converge. It is expected to diverge unless the initial guess $y_{n+1}^{(0)}$ happens to be the exact solution.\n\nThe problem asks for the numerical value of the Lipschitz constant $L$, rounded to four significant figures.\n$L = 1.5$. To express this with four significant figures, we write $1.500$.", "answer": "$$\\boxed{1.500}$$", "id": "3203180"}]}