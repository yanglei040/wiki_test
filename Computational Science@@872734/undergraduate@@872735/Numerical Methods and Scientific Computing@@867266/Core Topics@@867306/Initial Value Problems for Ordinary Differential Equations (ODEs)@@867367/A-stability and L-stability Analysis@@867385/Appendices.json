{"hands_on_practices": [{"introduction": "Understanding A-stability and L-stability begins with applying their mathematical definitions. This first exercise provides a direct opportunity to practice the fundamental analysis required to classify a numerical method based on its stability function, $R(z)$. By working through this problem, you will translate the abstract conditions—that $|R(z)| \\le 1$ in the left-half plane and that $R(z)$ vanishes at infinity—into concrete algebraic manipulations, building a solid foundation for the more complex scenarios that follow. [@problem_id:2151768]", "problem": "When analyzing numerical methods for solving Ordinary Differential Equations (ODEs), the stability of the method is a crucial property. This is often studied by applying the method to the Dahlquist test equation, $y' = \\lambda y$, where $\\lambda$ is a complex number with $\\text{Re}(\\lambda) \\leq 0$. This analysis leads to a stability function, $R(z)$, where $z = h\\lambda$ and $h$ is the step size. The behavior of $R(z)$ determines the stability properties of the method.\n\nTwo important stability properties are A-stability and L-stability:\n1.  A method is **A-stable** if its region of absolute stability contains the entire left-half of the complex plane. For a method with a rational stability function $R(z)$, this is equivalent to the condition $|R(z)| \\leq 1$ for all complex numbers $z$ with $\\text{Re}(z) \\leq 0$.\n2.  A method is **L-stable** if it is A-stable and its stability function also satisfies the condition $\\lim_{z \\to \\infty} R(z) = 0$.\n\nConsider a hypothetical single-step numerical method whose stability function is given by the rational function:\n$$\nR(z) = \\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}\n$$\n\nBased on the definitions provided, determine the stability properties of this method.\n\nA. The method is A-stable, but not L-stable.\n\nB. The method is L-stable.\n\nC. The method is not A-stable.\n\nD. The method is neither A-stable nor L-stable.", "solution": "We are given the stability function\n$$\nR(z) = \\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}.\n$$\nA-stability requires that the region of absolute stability\n$$\nS=\\{z\\in\\mathbb{C}:\\,|R(z)|\\leq 1\\}\n$$\ncontain the entire left-half plane $\\{z:\\,\\text{Re}(z)\\leq 0\\}$. We analyze $S$ by solving the inequality\n$$\n\\left|\\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}\\right|\\leq 1\n\\quad\\Longleftrightarrow\\quad\n\\left|1+\\frac{1}{3}z\\right|\\leq\\left|1-\\frac{2}{3}z\\right|.\n$$\nLet $z=x+iy$ with $x,y\\in\\mathbb{R}$. Using $|1+\\alpha z|^{2}=(1+\\alpha x)^{2}+(\\alpha y)^{2}$ for real $\\alpha$, we compute\n$$\n\\left|1+\\frac{1}{3}z\\right|^{2}=1+\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}),\\qquad\n\\left|1-\\frac{2}{3}z\\right|^{2}=1-\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}).\n$$\nThus\n$$\n1+\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}) \\leq 1-\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}).\n$$\nCanceling $1$ and collecting terms gives\n$$\n\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}) \\leq -\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}),\n$$\n$$\n\\frac{2}{3}x+\\frac{4}{3}x \\leq \\frac{4}{9}(x^{2}+y^{2})-\\frac{1}{9}(x^{2}+y^{2}),\n$$\n$$\n2x \\leq \\frac{1}{3}(x^{2}+y^{2}).\n$$\nMultiplying by $3$ and rearranging yields\n$$\n6x \\leq x^{2}+y^{2}\\quad\\Longleftrightarrow\\quad x^{2}+y^{2}-6x \\geq 0.\n$$\nCompleting the square,\n$$\n(x-3)^{2}+y^{2} \\geq 9.\n$$\nTherefore the absolute stability region $S$ is the exterior (including the boundary) of the circle centered at $(3,0)$ with radius $3$. For any $z$ with $\\text{Re}(z)=x\\leq 0$, we have $(x-3)^{2}\\geq 9$, hence $(x-3)^{2}+y^{2}\\geq 9$, so every such $z$ lies in $S$. Thus the entire left-half plane is included, and the method is A-stable.\n\nTo check L-stability, compute the limit of $R(z)$ as $z\\to\\infty$. Since the degrees of numerator and denominator are equal, the limit is the ratio of leading coefficients:\n$$\n\\lim_{z\\to\\infty}R(z)=\\lim_{z\\to\\infty}\\frac{\\frac{1}{3}z}{-\\frac{2}{3}z}=-\\frac{1}{2}\\neq 0.\n$$\nTherefore the method is not L-stable.\n\nCombining these results, the method is A-stable but not L-stable, which corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "2151768"}, {"introduction": "Theoretical properties like L-stability are only meaningful if they predict a method's real-world performance. This hands-on exercise demonstrates the practical consequences of a method being A-stable but not L-stable, using the well-known trapezoidal rule as a case study. Through a combination of theoretical analysis and a short programming task, you will see exactly how the behavior of the stability function at infinity leads to spurious, non-physical oscillations when solving stiff equations, making the case for why L-stability is so crucial. [@problem_id:3202108]", "problem": "You are asked to construct and analyze a specific linear multistep method for ordinary differential equations from first principles, then to implement a program that verifies its properties numerically and demonstrates a qualitative failure for a stiff problem. Use only the following foundational definitions and facts as your base: a linear multistep method is any method of the form $\\sum_{j=0}^{s} \\alpha_j y_{n+j} = h \\sum_{j=0}^{s} \\beta_j f_{n+j}$ with constant coefficients; a method is consistent if and only if $\\sum_{j=0}^{s} \\alpha_j = 0$ and $\\sum_{j=0}^{s} j \\alpha_j = \\sum_{j=0}^{s} \\beta_j$; absolute stability (A-stability) is defined by the requirement that when applied to the linear test equation $y' = \\lambda y$ the method’s amplification factor $R(z)$, where $z = h \\lambda$, satisfies $\\lvert R(z) \\rvert \\le 1$ for all $z$ with $\\operatorname{Re}(z) \\le 0$; L-stability requires, in addition, that $\\lim_{\\operatorname{Re}(z)\\to -\\infty} R(z) = 0$. Do not assume any other formulas not derivable from these facts.\n\nTask A. Construct a consistent linear multistep method that is absolutely stable (A-stable) but not L-stable. Express it in the form $\\sum_{j=0}^{s} \\alpha_j y_{n+j} = h \\sum_{j=0}^{s} \\beta_j f_{n+j}$ with specific coefficients, and derive, by applying it to the linear test equation $y'=\\lambda y$, the closed-form amplification factor $R(z)$ in terms of $z = h \\lambda$. Justify both consistency and the claims about A-stability and failure of L-stability using only the base definitions above.\n\nTask B. Identify a stiff problem and a time step $h$ for which the method from Task A produces undesirable oscillations even though the method is A-stable, and explain the mechanism that causes those oscillations.\n\nProgramming task. Implement your construction and analysis in a single program that does the following.\n\n1) Fix the method from Task A by specifying numerical values for its coefficients $\\alpha_j$ and $\\beta_j$ (as constants in your code). Implement a function that, given complex $z$, computes the method’s amplification factor $R(z)$ by substituting the method into the test equation $y'=\\lambda y$ and solving for $y_{n+1}/y_n$.\n\n2) Consistency test. Using the consistency conditions $\\sum_{j=0}^{s} \\alpha_j = 0$ and $\\sum_{j=0}^{s} j \\alpha_j = \\sum_{j=0}^{s} \\beta_j$, return a boolean indicating whether both equalities hold to within an absolute tolerance of $10^{-12}$.\n\n3) A-stability spot checks. For the following test suite of values of $z$ with $\\operatorname{Re}(z) \\le 0$, compute booleans indicating whether $\\lvert R(z) \\rvert \\le 1$ holds within a tolerance of $10^{-12$}:\n- $z_1 = -1$\n- $z_2 = -100$\n- $z_3 = -1 + 10 i$\n- $z_4 = -50 + 200 i$\n\n4) Numerical L-stability check. Compute $\\lvert R(z) \\rvert$ at $z_\\star = -10^6$ and return a boolean that is true if and only if $\\lvert R(z_\\star)\\rvert  10^{-3}$. This provides a quantitative proxy for $\\lim_{\\operatorname{Re}(z)\\to -\\infty} R(z) = 0$. For an L-stable method this proxy would evaluate to true at such a large negative $z_\\star$; for a method that is not L-stable it should evaluate to false.\n\n5) Stiff-oscillation demonstration. Consider the stiff scalar problem $y' = \\lambda y$ with $\\lambda = -10000$, initial condition $y(0) = 1$, final time $T = 1$, and the fixed step size $h = 0.1$. Using the method from Task A:\n- Compute the $N = T/h = 10$ steps and count the number of sign changes in the sequence $(y_0,y_1,\\dots,y_N)$, where a sign change occurs at step $n$ if $y_n y_{n+1}  0$.\n- Report the final numerical magnitude $\\lvert y_N \\rvert$.\n- Compute the exact final magnitude $\\lvert y(T) \\rvert = \\lvert y(0) \\exp(\\lambda T) \\rvert$.\n- Report the absolute error $\\lvert y_N - y(T) \\rvert$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order: \n- the consistency boolean from step $2$,\n- the list of four booleans from step $3$ in the order $[z_1,z_2,z_3,z_4]$,\n- the L-stability proxy boolean from step $4$,\n- and the list $[\\text{sign\\_changes}, \\lvert y_N\\rvert, \\lvert y(T)\\rvert, \\lvert y_N - y(T)\\rvert]$ from step $5$.\nFor example, your output must look like \n$[\\text{True},[b_1,b_2,b_3,b_4],\\text{False},[k,a,e,\\varepsilon]]$ \nwith the booleans, integer, and floating-point numbers replacing $b_j$, $k$, $a$, $e$, and $\\varepsilon$ respectively. No additional text or lines should be printed. All angles, if any were to appear, must be in radians, but none are needed here. All quantities in this problem are dimensionless, so no physical unit conversion is required.", "solution": "### Task A: Method Construction and Analysis\n\nWe seek a consistent linear multistep method (LMM) of the form $\\sum_{j=0}^{s} \\alpha_j y_{n+j} = h \\sum_{j=0}^{s} \\beta_j f_{n+j}$ which is A-stable but not L-stable. A canonical example of such a method is the trapezoidal rule, which is a one-step method ($s=1$).\n\nThe trapezoidal rule is derived by integrating the ordinary differential equation $y' = f(t,y)$ from $t_n$ to $t_{n+1}$ and approximating the integral of $f$ using the trapezoidal quadrature rule:\n$$ y(t_{n+1}) - y(t_n) = \\int_{t_n}^{t_{n+1}} f(t, y(t)) dt \\approx \\frac{h}{2} [f(t_n, y(t_n)) + f(t_{n+1}, y(t_{n+1}))] $$\nThis gives the numerical method:\n$$ y_{n+1} - y_n = \\frac{h}{2} (f_n + f_{n+1}) $$\nwhere $f_k = f(t_k, y_k)$ and $h = t_{n+1}-t_n$.\n\nTo express this in the standard LMM form, we rewrite it as:\n$$ (1)y_{n+1} + (-1)y_n = h \\left( \\frac{1}{2} f_{n+1} + \\frac{1}{2} f_n \\right) $$\nComparing this to $\\sum_{j=0}^{1} \\alpha_j y_{n+j} = h \\sum_{j=0}^{1} \\beta_j f_{n+j}$, we identify the coefficients:\n- $s = 1$\n- $\\alpha_0 = -1$, $\\alpha_1 = 1$\n- $\\beta_0 = \\frac{1}{2}$, $\\beta_1 = \\frac{1}{2}$\n\n**Consistency Justification:**\nA method is consistent if $\\sum_{j=0}^{s} \\alpha_j = 0$ and $\\sum_{j=0}^{s} j \\alpha_j = \\sum_{j=0}^{s} \\beta_j$.\n1.  First condition: $\\sum_{j=0}^{1} \\alpha_j = \\alpha_0 + \\alpha_1 = -1 + 1 = 0$. The condition is satisfied.\n2.  Second condition:\n    - Left-hand side: $\\sum_{j=0}^{1} j \\alpha_j = (0 \\cdot \\alpha_0) + (1 \\cdot \\alpha_1) = 0 \\cdot (-1) + 1 \\cdot 1 = 1$.\n    - Right-hand side: $\\sum_{j=0}^{1} \\beta_j = \\beta_0 + \\beta_1 = \\frac{1}{2} + \\frac{1}{2} = 1$.\n    - Since $1=1$, the second condition is also satisfied.\nThus, the trapezoidal rule is a consistent method.\n\n**Derivation of the Amplification Factor $R(z)$:**\nWe apply the method to the linear test equation $y' = \\lambda y$, where $\\lambda \\in \\mathbb{C}$. For this equation, $f_{n} = \\lambda y_{n}$ and $f_{n+1} = \\lambda y_{n+1}$. Substituting into the method's formula:\n$$ y_{n+1} - y_n = \\frac{h}{2} (\\lambda y_n + \\lambda y_{n+1}) $$\nLet $z = h \\lambda$. The equation becomes:\n$$ y_{n+1} - y_n = \\frac{z}{2} (y_n + y_{n+1}) $$\nWe solve for the amplification factor $R(z) = y_{n+1} / y_n$:\n$$ y_{n+1} - \\frac{z}{2} y_{n+1} = y_n + \\frac{z}{2} y_n $$\n$$ y_{n+1} \\left(1 - \\frac{z}{2}\\right) = y_n \\left(1 + \\frac{z}{2}\\right) $$\n$$ R(z) = \\frac{y_{n+1}}{y_n} = \\frac{1 + z/2}{1 - z/2} $$\n\n**Stability Justification:**\n-   **A-stability:** A-stability requires $|R(z)| \\le 1$ for all $z$ with $\\operatorname{Re}(z) \\le 0$. Let $z = x + iy$, where $x = \\operatorname{Re}(z) \\le 0$.\n    $$ |R(z)|^2 = \\left| \\frac{1 + (x+iy)/2}{1 - (x+iy)/2} \\right|^2 = \\frac{|(1 + x/2) + i(y/2)|^2}{|(1 - x/2) - i(y/2)|^2} = \\frac{(1+x/2)^2 + (y/2)^2}{(1-x/2)^2 + (y/2)^2} $$\n    The condition $|R(z)|^2 \\le 1$ is equivalent to:\n    $$ (1+x/2)^2 + (y/2)^2 \\le (1-x/2)^2 + (y/2)^2 $$\n    $$ 1 + x + \\frac{x^2}{4} \\le 1 - x + \\frac{x^2}{4} $$\n    $$ 2x \\le 0 \\implies x \\le 0 $$\n    This is precisely the condition $\\operatorname{Re}(z) \\le 0$. Therefore, the trapezoidal rule is A-stable.\n\n-   **Failure of L-stability:** L-stability requires that the method is A-stable and, in addition, $\\lim_{\\operatorname{Re}(z)\\to -\\infty} R(z) = 0$. We evaluate the limit of our derived $R(z)$:\n    $$ \\lim_{\\operatorname{Re}(z)\\to -\\infty} R(z) = \\lim_{z \\to \\infty, \\operatorname{Re}(z) \\le 0} \\frac{1 + z/2}{1 - z/2} $$\n    Dividing the numerator and denominator by $z$:\n    $$ \\lim_{z \\to \\infty, \\operatorname{Re}(z) \\le 0} \\frac{1/z + 1/2}{1/z - 1/2} = \\frac{0 + 1/2}{0 - 1/2} = -1 $$\n    Since the limit is $-1$ and not $0$, the method is not L-stable.\n\n### Task B: Stiff Oscillation Mechanism\n\nThe lack of L-stability is responsible for undesirable behavior when solving stiff problems. A stiff ODE has components in its solution that decay at vastly different rates. The highly stable components correspond to eigenvalues $\\lambda$ with large negative real parts.\n\nFor the trapezoidal rule, when $\\operatorname{Re}(\\lambda)$ is large and negative, the value of $z = h\\lambda$ is also large and negative for a moderate step size $h$. As we have just shown, for such $z$, the amplification factor $R(z) \\to -1$. This means the numerical solution follows the recurrence $y_{n+1} \\approx -y_n$.\n\nThis leads to a persistent, non-decaying oscillation in the numerical solution (e.g., $y_0, -y_0, y_0, -y_0, \\dots$). However, the true solution component, $e^{\\lambda t}$, should decay to zero extremely rapidly and without oscillation. This failure of the numerical method to damp the stiff components is the hallmark of a method that is A-stable but not L-stable.\n\nFor the specific problem $y' = \\lambda y$ with $\\lambda = -10000$ and step size $h=0.1$, we have $z = h\\lambda = 0.1 \\times (-10000) = -1000$. The amplification factor is\n$$ R(-1000) = \\frac{1 - 1000/2}{1 + 1000/2} = \\frac{-499}{501} \\approx -0.996 $$\nThis value is very close to $-1$, so we expect $y_{n+1} \\approx -y_n$, resulting in oscillations that decay very slowly, with a magnitude $|y_n| = |R|^n |y_0|$ that remains close to $|y_0|$. In contrast, the true solution $y(t) = y_0 e^{-10000t}$ becomes negligible almost instantly. For example, at the end of the first step, $y(0.1) = y_0 e^{-1000} \\approx y_0 \\times 10^{-435}$. The numerical solution completely fails to capture this rapid decay.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs, analyzes, and demonstrates the properties of the trapezoidal rule,\n    a linear multistep method that is A-stable but not L-stable.\n    \"\"\"\n    \n    # Task A: Define the method.\n    # The method is the trapezoidal rule: y_{n+1} - y_n = h/2 * (f_n + f_{n+1})\n    # This is a one-step method (s=1).\n    # alpha_0*y_n + alpha_1*y_{n+1} = h * (beta_0*f_n + beta_1*f_{n+1})\n    alpha = np.array([-1.0, 1.0])\n    beta = np.array([0.5, 0.5])\n    \n    # 1) Amplification factor R(z) for the trapezoidal rule\n    # R(z) = (1 + z/2) / (1 - z/2)\n    def get_R(z: complex) -> complex:\n        return (1.0 + 0.5 * z) / (1.0 - 0.5 * z)\n\n    # 2) Consistency test\n    # Condition 1: sum(alpha_j) = 0\n    # Condition 2: sum(j * alpha_j) = sum(beta_j)\n    consistency_c1 = np.isclose(np.sum(alpha), 0.0, atol=1e-12)\n    rho_prime_at_1 = np.sum(np.arange(len(alpha)) * alpha)\n    sigma_at_1 = np.sum(beta)\n    consistency_c2 = np.isclose(rho_prime_at_1, sigma_at_1, atol=1e-12)\n    consistency_ok = bool(consistency_c1 and consistency_c2)\n\n    # 3) A-stability spot checks\n    # Check if |R(z)| = 1 for Re(z) = 0.\n    # We add a tolerance to the right side to account for floating point error\n    # where |R(z)| should be exactly 1 but might be 1 + epsilon.\n    z_tests = [-1.0, -100.0, -1.0 + 10.0j, -50.0 + 200.0j]\n    astability_checks = []\n    for z in z_tests:\n        # For A-stability, |R(z)| must be = 1.\n        # Adding a small tolerance to the check.\n        is_stable = abs(get_R(z)) = 1.0 + 1e-12\n        astability_checks.append(is_stable)\n\n    # 4) Numerical L-stability check\n    # Check if lim_{Re(z) -> -inf} R(z) = 0.\n    # We use a large negative z as a proxy.\n    z_star = -1.0e6\n    R_mag_at_large_neg_z = abs(get_R(z_star))\n    # For L-stability, this magnitude should be close to 0. We test if it's  10^-3.\n    # For the trapezoidal rule, |R(z)| -> 1, so this check should fail.\n    lstability_check = bool(R_mag_at_large_neg_z  1e-3)\n    \n    # 5) Stiff-oscillation demonstration\n    lam = -10000.0\n    y0 = 1.0\n    T = 1.0\n    h = 0.1\n    N = int(T / h)\n    \n    # The numerical solution is y_n = R(h*lambda)^n * y_0\n    z = h * lam\n    amp_factor = get_R(z)\n    \n    y = np.array([y0 * (amp_factor**n) for n in range(N + 1)])\n    \n    # Count sign changes\n    sign_changes = 0\n    for i in range(N):\n        if y[i] * y[i+1]  0:\n            sign_changes += 1\n            \n    # Final numerical magnitude\n    yN_mag = abs(y[N])\n    \n    # Exact final magnitude\n    # y(T) = y(0) * exp(lambda * T)\n    # np.exp(-10000) underflows to 0.0 in standard double precision\n    yT_exact = y0 * np.exp(lam * T)\n    yT_exact_mag = abs(yT_exact)\n    \n    # Absolute error\n    abs_error = abs(y[N] - yT_exact)\n    \n    stiff_results = [sign_changes, yN_mag, yT_exact_mag, abs_error]\n\n    # Final output formatting\n    # Must match: [True,[b_1,b_2,b_3,b_4],False,[k,a,e,\\varepsilon]]\n    astab_str = ','.join(map(str, astability_checks))\n    stiff_str = ','.join(map(str, stiff_results))\n    \n    # Python's str() for booleans is \"True\" or \"False\", which is what's needed.\n    # f-string interpolation automatically calls str()\n    print(f\"[{consistency_ok},[{astab_str}],{lstability_check},[{stiff_str}]]\")\n\nsolve()\n```", "id": "3202108"}, {"introduction": "Having seen the importance of L-stability, the next step is to learn how to design methods that possess this desirable property. This problem challenges you to move from analyzing existing methods to constructing a new one—a two-stage Singly Diagonally Implicit Runge-Kutta (SDIRK) method. By deriving its stability function and enforcing conditions for both second-order accuracy and A-stability, you will determine the specific parameter choices that also grant the method L-stability, illustrating the process of engineering a numerical solver for the robust integration of stiff systems. [@problem_id:3202113]", "problem": "Consider the scalar linear test problem $y'(t)=\\lambda\\,y(t)$ with $\\operatorname{Re}(\\lambda)\\le 0$. A two-stage singly diagonally implicit Runge–Kutta (SDIRK) method with a constant diagonal parameter $\\gamma$ is defined by the Butcher tableau\n$$\n\\begin{array}{c|cc}\n\\gamma  \\gamma  0 \\\\\n1  1-\\gamma  \\gamma \\\\\n\\hline\n b_1  b_2\n\\end{array}\n$$\nand is assumed to be stiffly accurate, meaning $b_1=1-\\gamma$ and $b_2=\\gamma$. Let $A$ denote the stage matrix and $b$ the weight vector. The stability function $R(z)$ of a Runge–Kutta method is defined for $z=\\lambda h$ by the standard relation $R(z)=1+z\\,b^{\\top}\\,(I-zA)^{-1}\\,{\\bf e}$, where ${\\bf e}$ is the vector of ones, $I$ is the identity matrix, and $h0$ is the stepsize. A method is A-stable if $|R(z)|\\le 1$ for all $z$ with $\\operatorname{Re}(z)\\le 0$, and L-stable if it is A-stable and additionally satisfies $\\lim_{|z|\\to\\infty}R(z)=0$. Impose the classical order conditions up to order $2$, namely $b^{\\top}{\\bf e}=1$ and $b^{\\top}c=\\tfrac{1}{2}$, where $c=A{\\bf e}$.\n\n1) Derive the stability function $R(z)$ in closed form as a rational function of $z$ and $\\gamma$.\n\n2) Using only the definitions provided above and reasoning from first principles, determine all real $\\gamma0$ for which the method is A-stable.\n\n3) Among $\\gamma\\in(0,1]$, enforce the second-order condition $b^{\\top}c=\\tfrac{1}{2}$ and determine the unique $\\gamma$ that yields both second-order accuracy and A-stability. Conclude whether this choice is L-stable.\n\nProvide as your final answer the exact value of this unique $\\gamma$ (no units). No numerical rounding is required; give the exact expression.", "solution": "The problem asks for a three-part analysis of a given two-stage SDIRK method. We will address each part systematically.\n\nFrom the Butcher tableau and the stiffly accurate condition, we have the matrix $A$ and the vector $b$:\n$$ A = \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix} $$\nThe vector of ones is ${\\bf e} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\n**1) Derivation of the stability function $R(z)$**\n\nThe stability function is given by $R(z) = 1 + z\\,b^{\\top}\\,(I-zA)^{-1}\\,{\\bf e}$. First, we compute the inverse of $(I-zA)$.\n$$ I-zA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - z\\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix} = \\begin{pmatrix} 1-z\\gamma  0 \\\\ -z(1-\\gamma)  1-z\\gamma \\end{pmatrix} $$\nThis is a lower triangular matrix. Its determinant is $\\det(I-zA) = (1-z\\gamma)^2$. The inverse is:\n$$ (I-zA)^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1-z\\gamma  0 \\\\ z(1-\\gamma)  1-z\\gamma \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1-z\\gamma}  0 \\\\ \\frac{z(1-\\gamma)}{(1-z\\gamma)^2}  \\frac{1}{1-z\\gamma} \\end{pmatrix} $$\nNext, we compute the product $(I-zA)^{-1}{\\bf e}$:\n$$ (I-zA)^{-1}{\\bf e} = \\begin{pmatrix} \\frac{1}{1-z\\gamma} \\\\ \\frac{z(1-\\gamma)}{(1-z\\gamma)^2} + \\frac{1}{1-z\\gamma} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1-z\\gamma} \\\\ \\frac{z(1-\\gamma) + (1-z\\gamma)}{(1-z\\gamma)^2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1-z\\gamma} \\\\ \\frac{1+z-2z\\gamma}{(1-z\\gamma)^2} \\end{pmatrix} $$\nNow, we compute the product $b^{\\top}(I-zA)^{-1}{\\bf e}$:\n$$ b^{\\top}(I-zA)^{-1}{\\bf e} = (1-\\gamma)\\left(\\frac{1}{1-z\\gamma}\\right) + \\gamma\\left(\\frac{1+z(1-2\\gamma)}{(1-z\\gamma)^2}\\right) $$\nTo combine these terms, we use the common denominator $(1-z\\gamma)^2$:\n$$ b^{\\top}(I-zA)^{-1}{\\bf e} = \\frac{(1-\\gamma)(1-z\\gamma) + \\gamma(1+z(1-2\\gamma))}{(1-z\\gamma)^2} $$\nExpanding the numerator:\n$$ (1-\\gamma)(1-z\\gamma) + \\gamma(1+z(1-2\\gamma)) = (1-z\\gamma-\\gamma+z\\gamma^2) + (\\gamma+z\\gamma-2z\\gamma^2) = 1-z\\gamma^2 $$\nSo, we have:\n$$ b^{\\top}(I-zA)^{-1}{\\bf e} = \\frac{1-z\\gamma^2}{(1-z\\gamma)^2} $$\nFinally, we substitute this back into the expression for $R(z)$:\n$$ R(z) = 1 + z \\left( \\frac{1-z\\gamma^2}{(1-z\\gamma)^2} \\right) = 1 + \\frac{z-z^2\\gamma^2}{(1-z\\gamma)^2} $$\n$$ R(z) = \\frac{(1-z\\gamma)^2 + z-z^2\\gamma^2}{(1-z\\gamma)^2} = \\frac{(1-2z\\gamma+z^2\\gamma^2) + z-z^2\\gamma^2}{(1-z\\gamma)^2} = \\frac{1+z(1-2\\gamma)}{(1-z\\gamma)^2} $$\nThis is the closed-form expression for the stability function.\n\n**2) A-stability analysis**\n\nA method is A-stable if $|R(z)| \\le 1$ for all complex numbers $z$ with $\\operatorname{Re}(z) \\le 0$. For a rational stability function that is analytic in the closed left half-plane, it is sufficient to check the condition on the boundary, i.e., the imaginary axis $z=i\\omega$ for $\\omega \\in \\mathbb{R}$. The pole of $R(z)$ is at $z=1/\\gamma$. Since we are given $\\gamma  0$, the pole is on the positive real axis, so $R(z)$ is analytic for $\\operatorname{Re}(z) \\le 0$. Thus, we need to check if $|R(i\\omega)| \\le 1$ for all $\\omega \\in \\mathbb{R}$.\n\n$$ R(i\\omega) = \\frac{1 + i\\omega(1-2\\gamma)}{(1-i\\omega\\gamma)^2} $$\nWe evaluate the squared modulus:\n$$ |R(i\\omega)|^2 = \\frac{|1 + i\\omega(1-2\\gamma)|^2}{|(1-i\\omega\\gamma)^2|^2} = \\frac{|1 + i\\omega(1-2\\gamma)|^2}{|1-i\\omega\\gamma|^4} $$\nThe squared modulus of the numerator is $1^2 + (\\omega(1-2\\gamma))^2 = 1+\\omega^2(1-2\\gamma)^2$.\nThe fourth power of the modulus of the denominator term is $(|1-i\\omega\\gamma|^2)^2 = (1^2 + (-\\omega\\gamma)^2)^2 = (1+\\omega^2\\gamma^2)^2$.\nThe A-stability condition becomes:\n$$ \\frac{1+\\omega^2(1-2\\gamma)^2}{(1+\\omega^2\\gamma^2)^2} \\le 1 \\quad \\forall \\omega \\in \\mathbb{R} $$\n$$ 1+\\omega^2(1-2\\gamma)^2 \\le (1+\\omega^2\\gamma^2)^2 = 1 + 2\\omega^2\\gamma^2 + \\omega^4\\gamma^4 $$\n$$ \\omega^2(1-4\\gamma+4\\gamma^2) \\le 2\\omega^2\\gamma^2 + \\omega^4\\gamma^4 $$\nThis inequality must hold for all $\\omega \\in \\mathbb{R}$. For $\\omega=0$, it is $0 \\le 0$, which is true. For $\\omega \\ne 0$, we can divide by $\\omega^2$:\n$$ 1-4\\gamma+4\\gamma^2 \\le 2\\gamma^2 + \\omega^2\\gamma^4 $$\nRearranging the terms, we get:\n$$ 2\\gamma^2 - 4\\gamma + 1 \\le \\omega^2\\gamma^4 $$\nSince the right-hand side is non-negative (as $\\gamma0$) and can be arbitrarily close to $0$ (by choosing $\\omega$ close to $0$), the left-hand side must be less than or equal to $0$.\n$$ 2\\gamma^2 - 4\\gamma + 1 \\le 0 $$\nTo find the values of $\\gamma$ that satisfy this quadratic inequality, we find the roots of $2\\gamma^2 - 4\\gamma + 1 = 0$ using the quadratic formula:\n$$ \\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16-8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4} = 1 \\pm \\frac{\\sqrt{2}}{2} $$\nThe parabola $p(\\gamma)=2\\gamma^2 - 4\\gamma + 1$ opens upwards, so it is non-positive between its roots. The condition for A-stability for $\\gamma0$ is:\n$$ \\gamma \\in \\left[1 - \\frac{\\sqrt{2}}{2}, 1 + \\frac{\\sqrt{2}}{2}\\right] $$\nSince $1-\\frac{\\sqrt{2}}{2} \\approx 1-0.707 = 0.293  0$, this interval is entirely within the domain $\\gamma0$.\n\n**3) Unique $\\gamma$ for second-order accuracy and L-stability**\n\nWe are asked to consider $\\gamma \\in (0,1]$ and enforce the second-order condition $b^{\\top}c = \\frac{1}{2}$. First, we check the first-order condition $b^{\\top}{\\bf e}=1$:\n$$ b^{\\top}{\\bf e} = \\begin{pmatrix} 1-\\gamma  \\gamma \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = (1-\\gamma) + \\gamma = 1 $$\nThis is always satisfied. Next, we compute $c=A{\\bf e}$:\n$$ c = \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\gamma \\\\ 1-\\gamma+\\gamma \\end{pmatrix} = \\begin{pmatrix} \\gamma \\\\ 1 \\end{pmatrix} $$\nNow we use the second-order condition $b^{\\top}c=\\frac{1}{2}$:\n$$ b^{\\top}c = \\begin{pmatrix} 1-\\gamma  \\gamma \\end{pmatrix} \\begin{pmatrix} \\gamma \\\\ 1 \\end{pmatrix} = (1-\\gamma)\\gamma + \\gamma(1) = \\gamma - \\gamma^2 + \\gamma = 2\\gamma - \\gamma^2 $$\nSetting this equal to $\\frac{1}{2}$:\n$$ 2\\gamma - \\gamma^2 = \\frac{1}{2} \\implies 4\\gamma - 2\\gamma^2 = 1 \\implies 2\\gamma^2 - 4\\gamma + 1 = 0 $$\nThis is the same quadratic equation as the boundary of the A-stability region. Its solutions are $\\gamma = 1 \\pm \\frac{\\sqrt{2}}{2}$.\nWe must find the unique solution in the interval $\\gamma \\in (0,1]$.\n-   The root $\\gamma_1 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1.707$ is not in $(0,1]$.\n-   The root $\\gamma_2 = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.293$ is in $(0,1]$.\nThus, the unique value of $\\gamma$ satisfying the conditions is $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$.\n\nThis value of $\\gamma$ lies on the boundary of the A-stability interval we derived: $\\left[1 - \\frac{\\sqrt{2}}{2}, 1 + \\frac{\\sqrt{2}}{2}\\right]$. Therefore, the method with this $\\gamma$ is A-stable.\n\nFinally, we check for L-stability. A method is L-stable if it is A-stable and $\\lim_{|z|\\to\\infty}R(z)=0$. Our stability function is:\n$$ R(z) = \\frac{1+z(1-2\\gamma)}{(1-z\\gamma)^2} = \\frac{z(1-2\\gamma)+1}{z^2\\gamma^2 - 2z\\gamma + 1} $$\nThis is a rational function in $z$. Since $\\gamma = 1 - \\frac{\\sqrt{2}}{2} \\neq 0$, the degree of the denominator is $2$. The degree of the numerator is $1$ (since $1-2\\gamma = 1-2(1-\\frac{\\sqrt{2}}{2}) = \\sqrt{2}-1 \\neq 0$). As the degree of the denominator is greater than the degree of the numerator, the limit as $|z|\\to\\infty$ is $0$.\n$$ \\lim_{|z|\\to\\infty} R(z) = 0 $$\nSince the method is A-stable for this choice of $\\gamma$ and the limit condition is satisfied, the method is L-stable.\n\nThe unique value of $\\gamma$ is $1 - \\frac{\\sqrt{2}}{2}$.", "answer": "$$\\boxed{1-\\frac{\\sqrt{2}}{2}}$$", "id": "3202113"}]}