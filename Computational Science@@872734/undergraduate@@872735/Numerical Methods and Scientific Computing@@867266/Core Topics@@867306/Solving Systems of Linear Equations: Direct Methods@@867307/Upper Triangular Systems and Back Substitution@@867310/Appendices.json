{"hands_on_practices": [{"introduction": "True understanding of an algorithm begins with mastering its fundamental mechanics. This first exercise provides a direct, hands-on application of back substitution to a standard upper triangular system [@problem_id:1029943]. By performing the calculations using exact fractional arithmetic, you will develop a precise, step-by-step grasp of the process, building a solid foundation free from the complexities of floating-point errors.", "problem": "Solve the system of linear equations $ A \\mathbf{x} = \\mathbf{b} $ using back substitution, where $ A $ is a 4×4 upper triangular matrix and $ \\mathbf{b} $ is a vector. The matrix and vector are given as:\n\n\n$$\nA = \\begin{pmatrix}\n2.5  1.25  -0.6  1.8 \\\\\n0  0.4  2.1  -1.2 \\\\\n0  0  3.3  0.9 \\\\\n0  0  0  1.5\n\\end{pmatrix}, \\quad \n\\mathbf{b} = \\begin{pmatrix}\n1.1 \\\\\n-0.5 \\\\\n2.4 \\\\\n0.6\n\\end{pmatrix}.\n$$\n\n\nPerform all computations exactly using fractional arithmetic. Express the solution vector $ \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} $ in simplified fractional form.", "solution": "We rewrite the system by expressing decimals as fractions:\n$$\\begin{cases}\n\\frac52x_1+\\frac54x_2-\\frac35x_3+\\frac95x_4=\\frac{11}{10},\\\\\n\\frac25x_2+\\frac{21}{10}x_3-\\frac65x_4=-\\frac12,\\\\\n\\frac{33}{10}x_3+\\frac{9}{10}x_4=\\frac{12}{5},\\\\\n\\frac32x_4=\\frac35.\n\\end{cases}$$\n\n1. From the fourth equation:\n$$\\frac32x_4=\\frac35\\;\\Longrightarrow\\;\nx_4=\\frac{\\frac35}{\\frac32}=\\frac35\\cdot\\frac23=\\frac25.$$\n\n2. Third equation:\n$$\\frac{33}{10}x_3+\\frac{9}{10}\\cdot\\frac25=\\frac{12}{5}\n\\;\\Longrightarrow\\;\\frac{33}{10}x_3=\\frac{12}{5}-\\frac{18}{50}\n=\\frac{120-18}{50}=\\frac{102}{50}=\\frac{51}{25},$$\n$$x_3=\\frac{\\tfrac{51}{25}}{\\tfrac{33}{10}}\n=\\frac{51}{25}\\cdot\\frac{10}{33}=\\frac{510}{825}=\\frac{34}{55}.$$\n\n3. Second equation:\n$$\\frac25x_2+\\frac{21}{10}\\cdot\\frac{34}{55}-\\frac{6}{5}\\cdot\\frac25=-\\frac12\n\\;\\Longrightarrow\\;\\frac25x_2=-\\frac12-\\frac{357}{275}+\\frac{12}{25}\n=-\\frac{725}{550}=-\\frac{29}{22},$$\n$$x_2=-\\frac{29}{22}\\cdot\\frac52=-\\frac{145}{44}.$$\n\n4. First equation:\n$$\\frac52x_1+\\frac54\\Bigl(-\\frac{145}{44}\\Bigr)-\\frac35\\cdot\\frac{34}{55}\n+\\frac95\\cdot\\frac25=\\frac{11}{10},$$\n$$\\frac52x_1=\\frac{11}{10}+\\frac{725}{176}+\\frac{102}{275}-\\frac{18}{25}\n=\\frac{21429}{4400},$$\n$$x_1=\\frac{21429}{4400}\\cdot\\frac25=\\frac{21429}{11000}.$$\n\nHence\n$$\\mathbf{x}=\\begin{pmatrix}\\frac{21429}{11000}\\\\-\\frac{145}{44}\\\\\\frac{34}{55}\\\\\\frac25\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{21429}{11000}\\\\-\\frac{145}{44}\\\\\\frac{34}{55}\\\\\\frac25\\end{pmatrix}}$$", "id": "1029943"}, {"introduction": "While exact arithmetic provides clarity, real-world scientific computing relies on finite-precision floating-point numbers, which can introduce surprising and dramatic errors. This problem presents a carefully designed scenario where the standard back substitution algorithm, when executed in single-precision arithmetic, produces a result that is wildly incorrect [@problem_id:3285335]. By comparing the exact solution to the computed one, you will gain a crucial, tangible understanding of catastrophic cancellation and the critical importance of numerical stability.", "problem": "Consider solving an upper triangular linear system by the standard back substitution algorithm, starting at the last equation and proceeding upward. Let\n$$\nU = \\begin{pmatrix}\n10^{-8}  10^{8}  10^{8}  10^{8} \\\\\n0  1  10^{8}  10^{8} \\\\\n0  0  1  10^{8} \\\\\n0  0  0  1\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n3\\times 10^{8} + 10^{-8} \\\\\n2\\times 10^{8} + 1 \\\\\n10^{8} + 1 \\\\\n1\n\\end{pmatrix}.\n$$\nThe back substitution algorithm uses only additions, subtractions, and multiplications/divisions on these entries.\n\nYou will execute back substitution in two models of arithmetic:\n1. Exact real arithmetic for conceptual ground truth.\n2. Floating-point arithmetic as specified by the Institute of Electrical and Electronics Engineers (IEEE) 754 standard single precision (binary32), with rounding to nearest, ties to even, and the usual normalized finite format. Assume each literal decimal constant provided for the entries of $U$ and $b$ is stored as the nearest binary32 representable value before any arithmetic, and that every subsequent arithmetic operation is performed in binary32 with rounding to nearest.\n\nTasks:\n- Using exact real arithmetic, determine the exact solution and explain which structural features of $U$ and $b$ make the computation of $x_1$ sensitive to cancellation.\n- Then, perform the back substitution in IEEE 754 single precision (binary32) as described, and determine the value returned for $x_1$, explicitly invoking the scale of the spacing between adjacent floating-point numbers (unit in the last place) near the magnitudes encountered to justify each rounding event that causes cancellation or loss of significance.\n\nAnswer specification:\n- Report the computed IEEE 754 single precision value of $x_1$ as a single real number in scientific notation.\n- Round your final reported number to four significant figures.", "solution": "The user wants me to solve an upper triangular linear system $Ux = b$ using two different arithmetic models:\n1. Exact real arithmetic.\n2. IEEE 754 single precision floating-point arithmetic.\n\nThe system is defined by the matrix $U$ and the vector $b$:\n$$\nU = \\begin{pmatrix}\n10^{-8}  10^{8}  10^{8}  10^{8} \\\\\n0  1  10^{8}  10^{8} \\\\\n0  0  1  10^{8} \\\\\n0  0  0  1\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n3\\times 10^{8} + 10^{-8} \\\\\n2\\times 10^{8} + 1 \\\\\n10^{8} + 1 \\\\\n1\n\\end{pmatrix}.\n$$\n\nThe system of equations is:\n$$\nu_{11}x_1 + u_{12}x_2 + u_{13}x_3 + u_{14}x_4 = b_1 \\\\\nu_{22}x_2 + u_{23}x_3 + u_{24}x_4 = b_2 \\\\\nu_{33}x_3 + u_{34}x_4 = b_3 \\\\\nu_{44}x_4 = b_4\n$$\n\nThe back substitution algorithm computes the solution vector $x$ as:\n$$\nx_i = \\frac{1}{u_{ii}} \\left( b_i - \\sum_{j=i+1}^{n} u_{ij} x_j \\right) \\quad \\text{for } i = n, n-1, \\dots, 1.\n$$\n\n### Step 1: Extract Givens\n- Upper triangular matrix $U$:\n$$\nU = \\begin{pmatrix}\n10^{-8}  10^{8}  10^{8}  10^{8} \\\\\n0  1  10^{8}  10^{8} \\\\\n0  0  1  10^{8} \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n- Right-hand side vector $b$:\n$$\nb = \\begin{pmatrix}\n3\\times 10^{8} + 10^{-8} \\\\\n2\\times 10^{8} + 1 \\\\\n10^{8} + 1 \\\\\n1\n\\end{pmatrix}\n$$\n- Arithmetic models: (1) Exact real arithmetic, (2) IEEE 754 single precision (binary32) with round-to-nearest, ties-to-even.\n- Floating-point procedure: Each constant is first stored as the nearest binary32 value, then all subsequent operations are performed in binary32.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in numerical linear algebra, designed to illustrate the effects of finite-precision arithmetic on the solution of a linear system.\n- **Scientifically Grounded:** The problem uses established mathematical concepts (linear systems, back substitution) and a standard computational model (IEEE 754). It is scientifically sound.\n- **Well-Posed:** The matrix $U$ has a non-zero determinant ($\\det(U) = u_{11}u_{22}u_{33}u_{44} = 10^{-8} \\neq 0$), so the system $Ux=b$ has a unique solution.\n- **Objective:** The problem is stated using precise, unambiguous mathematical terms.\n\nThe problem is valid as it does not violate any of the specified criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\n### Part 1: Exact Real Arithmetic Solution and Sensitivity Analysis\n\nUsing back substitution with exact arithmetic:\n\n1.  From the fourth equation, $u_{44}x_4 = b_4$:\n    $$1 \\cdot x_4 = 1 \\implies x_4 = 1$$\n\n2.  From the third equation, $u_{33}x_3 + u_{34}x_4 = b_3$:\n    $$1 \\cdot x_3 + 10^8 \\cdot x_4 = 10^8 + 1$$\n    Substituting $x_4=1$:\n    $$x_3 + 10^8 = 10^8 + 1 \\implies x_3 = 1$$\n\n3.  From the second equation, $u_{22}x_2 + u_{23}x_3 + u_{24}x_4 = b_2$:\n    $$1 \\cdot x_2 + 10^8 \\cdot x_3 + 10^8 \\cdot x_4 = 2 \\times 10^8 + 1$$\n    Substituting $x_3=1$ and $x_4=1$:\n    $$x_2 + 10^8(1) + 10^8(1) = 2 \\times 10^8 + 1$$\n    $$x_2 + 2 \\times 10^8 = 2 \\times 10^8 + 1 \\implies x_2 = 1$$\n\n4.  From the first equation, $u_{11}x_1 + u_{12}x_2 + u_{13}x_3 + u_{14}x_4 = b_1$:\n    $$10^{-8} \\cdot x_1 + 10^8 \\cdot x_2 + 10^8 \\cdot x_3 + 10^8 \\cdot x_4 = 3 \\times 10^8 + 10^{-8}$$\n    Substituting $x_2=1, x_3=1, x_4=1$:\n    $$10^{-8} x_1 + 10^8(1) + 10^8(1) + 10^8(1) = 3 \\times 10^8 + 10^{-8}$$\n    $$10^{-8} x_1 + 3 \\times 10^8 = 3 \\times 10^8 + 10^{-8}$$\n    $$10^{-8} x_1 = 10^{-8} \\implies x_1 = 1$$\n\nThe exact solution is $x = (1, 1, 1, 1)^T$.\n\n**Sensitivity analysis for $x_1$**:\nThe computation of $x_1$ is given by:\n$$x_1 = \\frac{1}{u_{11}} \\left( b_1 - \\sum_{j=2}^{4} u_{1j} x_j \\right)$$\nSubstituting the exact values:\n$$x_1 = \\frac{1}{10^{-8}} \\left( (3 \\times 10^8 + 10^{-8}) - (10^8 \\cdot 1 + 10^8 \\cdot 1 + 10^8 \\cdot 1) \\right)$$\n$$x_1 = 10^8 \\left( (3 \\times 10^8 + 10^{-8}) - (3 \\times 10^8) \\right)$$\nThe term in the parentheses involves the subtraction of two very large, nearly equal numbers. This phenomenon is known as **catastrophic cancellation**. If the term $b_1$ and the sum $\\sum u_{1j}x_j$ were computed with any loss of precision, the small, significant part of their difference ($10^{-8}$) could be lost. The structural features of $U$ and $b$ that lead to this are:\n1. The diagonal element $u_{11} = 10^{-8}$ is very small, so its reciprocal $1/u_{11} = 10^8$ is very large. This amplifies any error in the term computed in the parenthesis.\n2. The off-diagonal elements in the first row ($u_{12}$, $u_{13}$, $u_{14}$) are very large ($10^8$).\n3. The right-hand side element $b_1 = 3 \\times 10^8 + 10^{-8}$ is constructed to be very close to the sum $\\sum_{j=2}^{4} u_{1j} x_j = 3 \\times 10^8$.\nThese conditions make the system ill-conditioned and the computation of $x_1$ highly sensitive to rounding errors.\n\n### Part 2: IEEE 754 Single Precision (binary32) Solution\n\nLet $\\text{fl}(z)$ denote the nearest single-precision floating-point representation of a real number $z$. We will perform the back substitution using binary32 arithmetic.\n\n**Step A: Initial Data Representation**\nWe must first find the floating-point representation of the given constants.\nIn IEEE 754 single precision, the unit in the last place (ulp) for a number $y$ is $\\text{ulp}(y) = 2^{\\lfloor \\log_2|y| \\rfloor} \\cdot 2^{-23}$. A number $z$ is rounded to the nearest representable value. If $z$ falls halfway between two representable numbers, it is rounded to the one with an even (zero) last bit in its significand.\n\n- For $u_{ij}$ and $b_i$:\n  - $1$, $10^8$, $2\\times 10^8$, $3 \\times 10^8$ are all exactly representable in single precision. For example, $10^8 = 100000000 = 12500000 \\times 2^3 = (101111101011110000100000)_2 \\times 2^3$. The significand $12500000$ requires $24$ bits, which fits perfectly into the $1$ implicit and $23$ explicit bits of the single-precision format.\n  - $\\text{fl}(10^{-8})$ is a value very close to $10^{-8}$, let's call it $\\tilde{u}_{11}$.\n  - $\\text{fl}(b_4) = \\text{fl}(1) = 1$.\n  - For $b_3 = 10^8 + 1$: We must compute $\\text{fl}(10^8+1)$. The magnitude of $10^8$ gives $\\lfloor \\log_2(10^8) \\rfloor = 26$. So, $\\text{ulp}(10^8) = 2^{26} \\times 2^{-23} = 2^3 = 8$. The representable numbers around $10^8$ are ..., $10^8-8$, $10^8$, $10^8+8$, ... The value $10^8+1$ is closer to $10^8$ than to $10^8+8$ (distance $1$ vs $7$). Thus, $\\text{fl}(10^8+1) = 10^8$.\n  - For $b_2 = 2\\times 10^8 + 1$: $\\lfloor \\log_2(2\\times 10^8) \\rfloor = 27$. So, $\\text{ulp}(2\\times 10^8) = 2^{27} \\times 2^{-23} = 2^4 = 16$. The value $2\\times 10^8+1$ is closer to $2\\times 10^8$. Thus, $\\text{fl}(2\\times 10^8+1) = 2\\times 10^8$.\n  - For $b_1 = 3\\times 10^8 + 10^{-8}$: $\\lfloor \\log_2(3\\times 10^8) \\rfloor = 28$. So, $\\text{ulp}(3\\times 10^8) = 2^{28} \\times 2^{-23} = 2^5 = 32$. The added term $10^{-8}$ is negligible compared to the ulp. Thus, $\\text{fl}(3\\times 10^8+10^{-8}) = 3\\times 10^8$.\n\nThe system being solved in floating-point arithmetic is $U_{f}x_f=b_f$ where\n$$\nU_f = \\begin{pmatrix}\n\\tilde{u}_{11}  10^{8}  10^{8}  10^{8} \\\\\n0  1  10^{8}  10^{8} \\\\\n0  0  1  10^{8} \\\\\n0  0  0  1\n\\end{pmatrix}, \n\\quad\nb_f = \\begin{pmatrix}\n3\\times 10^{8} \\\\\n2\\times 10^{8} \\\\\n10^{8} \\\\\n1\n\\end{pmatrix}.\n$$\n\n**Step B: Floating-Point Back Substitution**\nLet $\\oplus, \\ominus, \\otimes, \\oslash$ denote the corresponding IEEE 754 operations.\n\n1.  Compute $x_{f,4}$:\n    $$x_{f,4} = b_{f,4} \\oslash u_{f,44} = 1 \\oslash 1 = 1$$\n\n2.  Compute $x_{f,3}$:\n    $$x_{f,3} = (b_{f,3} \\ominus u_{f,34} \\otimes x_{f,4}) \\oslash u_{f,33} = (10^8 \\ominus 10^8 \\otimes 1) \\oslash 1 = (10^8 \\ominus 10^8) \\oslash 1 = 0 \\oslash 1 = 0$$\n    The rounding error in storing $b_3$ caused the exact value $x_3=1$ to become $x_{f,3}=0$.\n\n3.  Compute $x_{f,2}$:\n    $$x_{f,2} = (b_{f,2} \\ominus (u_{f,23} \\otimes x_{f,3} \\oplus u_{f,24} \\otimes x_{f,4})) \\oslash u_{f,22}$$\n    The sum is $10^8 \\otimes 0 \\oplus 10^8 \\otimes 1 = 0 \\oplus 10^8 = 10^8$.\n    $$x_{f,2} = (2\\times 10^8 \\ominus 10^8) \\oslash 1 = 10^8 \\oslash 1 = 10^8$$\n    The error from $x_{f,3}$ propagates, causing the exact value $x_2=1$ to become $x_{f,2}=10^8$.\n\n4.  Compute $x_{f,1}$:\n    $$x_{f,1} = (b_{f,1} \\ominus (u_{f,12} \\otimes x_{f,2} \\oplus u_{f,13} \\otimes x_{f,3} \\oplus u_{f,14} \\otimes x_{f,4})) \\oslash \\tilde{u}_{11}$$\n    Let's compute the sum $S_f = u_{f,12} \\otimes x_{f,2} \\oplus u_{f,13} \\otimes x_{f,3} \\oplus u_{f,14} \\otimes x_{f,4}$.\n    $$S_f = 10^8 \\otimes 10^8 \\oplus 10^8 \\otimes 0 \\oplus 10^8 \\otimes 1$$\n    $$S_f = \\text{fl}(10^{16}) \\oplus 0 \\oplus 10^8 = \\text{fl}(10^{16}) \\oplus 10^8$$\n    Now we must analyze the operation $\\text{fl}(10^{16}) \\oplus 10^8$. This is an instance of **swamping**. $\\lfloor \\log_2(10^{16}) \\rfloor = 53$. The ulp of numbers with magnitude $10^{16}$ is $\\text{ulp}(\\text{fl}(10^{16})) = 2^{53} \\times 2^{-23} = 2^{30} \\approx 1.07 \\times 10^9$. The number being added, $10^8$, is smaller than half of the ulp ($2^{29}$). Therefore, the addition has no effect on the value in single precision.\n    $$S_f = \\text{fl}(10^{16})$$\n    The numerator is $N_f = b_{f,1} \\ominus S_f = 3\\times 10^8 \\ominus \\text{fl}(10^{16})$. This is another swamping event. The subtrahend $\\text{fl}(10^{16})$ is much larger than $3\\times 10^8$, and $3\\times 10^8$ is smaller than $\\text{ulp}(\\text{fl}(10^{16}))/2$.\n    $$N_f = \\text{fl}(3\\times 10^8 - \\text{fl}(10^{16})) = -\\text{fl}(10^{16})$$\n    Finally, we compute $x_{f,1}$:\n    $$x_{f,1} = N_f \\oslash \\tilde{u}_{11} = (-\\text{fl}(10^{16})) \\oslash \\text{fl}(10^{-8})$$\n    Using a high precision calculator for the values represented by the binary32 format:\n    $\\text{fl}(10^{16}) \\approx 1.00000001335 \\times 10^{16}$\n    $\\text{fl}(10^{-8}) \\approx 9.99999996004 \\times 10^{-9}$\n    The quotient is approximately:\n    $$x_{f,1} \\approx -\\frac{1.00000001335 \\times 10^{16}}{9.99999996004 \\times 10^{-9}} \\approx -1.00000001735 \\times 10^{24}$$\n    The nearest single-precision floating-point number to this value is found by rounding.\n    $\\text{fl}(-1.00000001735\\times 10^{24}) \\approx -1.0000000 \\times 10^{24}$.\n    To four significant figures, the result is $-1.000 \\times 10^{24}$.\n\nThe catastrophic cancellation expected from the exact arithmetic analysis did not occur. Instead, initial rounding errors on $b_3$ propagated and amplified, leading to swamping in the final calculation for $x_1$, producing a result that is orders of magnitude different from the true solution.", "answer": "$$\n\\boxed{-1.000 \\times 10^{24}}\n$$", "id": "3285335"}, {"introduction": "The power of a numerical method often lies in its adaptability. This final practice challenges you to extend the core idea of back substitution to a system that deviates slightly from the standard upper triangular form [@problem_id:3285181]. By developing a strategy for this \"nearly\" upper triangular matrix, you will learn to exploit matrix structure to create efficient, specialized solvers—a vital skill that moves beyond rote application to true algorithmic problem-solving.", "problem": "Consider the linear system $A \\mathbf{x} = \\mathbf{b}$, where $A \\in \\mathbb{R}^{n \\times n}$ is upper triangular except for a single non-zero entry in the bottom-left corner, so that $A_{ij} = 0$ for all $i  j$ except for $A_{n1} \\neq 0$. In the context of numerical methods and scientific computing, explain from first principles how to exploit this structure to solve the system efficiently using back substitution ideas rather than a full general-purpose algorithm such as Gaussian elimination. Your explanation must begin from the definition of an upper triangular system and the standard back substitution procedure, and then logically account for the effect of the lone subdiagonal perturbation.\n\nThen, apply your method to the specific $5 \\times 5$ system with\n$$\nA =\n\\begin{pmatrix}\n3  -1  2  0  1 \\\\\n0  2  1  -1  3 \\\\\n0  0  4  -2  1 \\\\\n0  0  0  5  2 \\\\\n-3  0  0  0  6\n\\end{pmatrix},\n\\qquad\n\\mathbf{b} =\n\\begin{pmatrix}\n7 \\\\ 4 \\\\ 5 \\\\ 1 \\\\ 2\n\\end{pmatrix}.\n$$\nCompute the value of $x_{1}$ for the unique solution $\\mathbf{x}$ of $A \\mathbf{x} = \\mathbf{b}$. Provide your answer as an exact value; no rounding is required. The final answer must be a single number (a real value).", "solution": "The problem asks for an efficient method to solve a linear system $A \\mathbf{x} = \\mathbf{b}$ where the matrix $A$ is upper triangular except for a single non-zero entry $A_{n1}$ in the bottom-left corner. After explaining the method from first principles, we must apply it to find the component $x_1$ of the solution for a specific $5 \\times 5$ system.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- The linear system is $A \\mathbf{x} = \\mathbf{b}$, with $A \\in \\mathbb{R}^{n \\times n}$.\n- The matrix $A$ has the structure $A_{ij} = 0$ for all $i  j$, except for $A_{n1} \\neq 0$.\n- The task requires an efficient solution method based on back substitution, followed by an application to a specific case.\n- The specific matrix is $A = \\begin{pmatrix} 3  -1  2  0  1 \\\\ 0  2  1  -1  3 \\\\ 0  0  4  -2  1 \\\\ 0  0  0  5  2 \\\\ -3  0  0  0  6 \\end{pmatrix}$.\n- The specific vector is $\\mathbf{b} = \\begin{pmatrix} 7 \\\\ 4 \\\\ 5 \\\\ 1 \\\\ 2 \\end{pmatrix}$.\n- The final output required is the value of $x_{1}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard topic in numerical linear algebra, dealing with the solution of structured linear systems. It is free of any scientific or factual unsoundness.\n- **Well-Posed:** For a unique solution to exist, the matrix $A$ must be non-singular, i.e., $\\det(A) \\neq 0$. A calculation of the determinant, for instance via cofactor expansion along the first column, yields $\\det(A) = 909$, which is non-zero. Thus, a unique solution $\\mathbf{x}$ exists. The problem is well-posed.\n- **Objective:** The problem is stated using precise mathematical language and is free of ambiguity or subjective claims.\n- The problem is self-contained, consistent, and provides all necessary information to derive the method and compute the required value.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to the solution.\n\n### General Solution Method\n\nA standard linear system $U\\mathbf{x} = \\mathbf{c}$, where $U$ is an upper triangular matrix with non-zero diagonal entries, is solved efficiently using back substitution. The algorithm proceeds as follows:\n$$x_n = \\frac{c_n}{U_{nn}}$$\n$$x_i = \\frac{1}{U_{ii}} \\left( c_i - \\sum_{j=i+1}^n U_{ij}x_j \\right) \\quad \\text{for } i = n-1, n-2, \\dots, 1$$\nThe cost of this procedure is $O(n^2)$ floating-point operations.\n\nNow, consider the given system $A\\mathbf{x} = \\mathbf{b}$. The matrix $A$ is not upper triangular due to the entry $A_{n1}$. This single entry couples the first variable $x_1$ with the last equation, disrupting the sequential nature of back substitution. To solve this efficiently, we can exploit the structure of $A$ by writing it as the sum of an upper triangular matrix $U$ and a simple rank-1 matrix $S$.\n\nLet $U$ be the matrix $A$ with its $(n,1)$ entry zeroed out. All other entries of $U$ are the same as in $A$. Let $S$ be a matrix that is zero everywhere except for the entry $S_{n1} = A_{n1}$. Using standard basis vectors $\\mathbf{e}_i$ (where $\\mathbf{e}_i$ is a column vector with a $1$ in the $i$-th position and $0$s elsewhere), we can write $S = A_{n1} \\mathbf{e}_n \\mathbf{e}_1^T$.\n\nThe system $A\\mathbf{x} = \\mathbf{b}$ can now be rewritten as:\n$$(U + A_{n1} \\mathbf{e}_n \\mathbf{e}_1^T) \\mathbf{x} = \\mathbf{b}$$\n$$U \\mathbf{x} + A_{n1} \\mathbf{e}_n (\\mathbf{e}_1^T \\mathbf{x}) = \\mathbf{b}$$\nSince $\\mathbf{e}_1^T \\mathbf{x} = x_1$, the equation becomes:\n$$U \\mathbf{x} + (A_{n1}x_1) \\mathbf{e}_n = \\mathbf{b}$$\nRearranging the terms, we get:\n$$U \\mathbf{x} = \\mathbf{b} - (A_{n1}x_1) \\mathbf{e}_n$$\nThis system has the upper triangular matrix $U$ on the left-hand side. The right-hand side vector depends on the unknown scalar $x_1$. Assuming $U$ is invertible (i.e., its diagonal entries are non-zero), we can formally write the solution as:\n$$\\mathbf{x} = U^{-1} (\\mathbf{b} - A_{n1}x_1 \\mathbf{e}_n)$$\nBy the linearity of matrix-vector multiplication, this is:\n$$\\mathbf{x} = U^{-1}\\mathbf{b} - A_{n1}x_1 (U^{-1}\\mathbf{e}_n)$$\nThis equation expresses the solution vector $\\mathbf{x}$ in terms of two vectors that can be computed using back substitution, and the yet unknown scalar $x_1$. Let's define:\n1.  $\\mathbf{y} = U^{-1}\\mathbf{b}$, which is the solution to the upper triangular system $U\\mathbf{y} = \\mathbf{b}$.\n2.  $\\mathbf{z} = U^{-1}\\mathbf{e}_n$, which is the solution to the upper triangular system $U\\mathbf{z} = \\mathbf{e}_n$.\n\nWe can find both $\\mathbf{y}$ and $\\mathbf{z}$ by applying the back substitution algorithm. With these vectors, the solution $\\mathbf{x}$ is given by:\n$$\\mathbf{x} = \\mathbf{y} - A_{n1}x_1 \\mathbf{z}$$\nThis is a vector equation. To find the unknown $x_1$, we can examine the first component of this equation:\n$$x_1 = y_1 - A_{n1}x_1 z_1$$\nThis is a linear equation in the single variable $x_1$. We solve for it:\n$$x_1(1 + A_{n1}z_1) = y_1$$\n$$x_1 = \\frac{y_1}{1 + A_{n1}z_1}$$\nThis formula allows us to compute $x_1$ directly. The overall algorithm is:\n1.  Form the upper triangular matrix $U$ from $A$ by setting $A_{n1}$ to $0$.\n2.  Solve the upper triangular system $U\\mathbf{y} = \\mathbf{b}$ for $\\mathbf{y}$ using back substitution.\n3.  Solve the upper triangular system $U\\mathbf{z} = \\mathbf{e}_n$ for $\\mathbf{z}$ using back substitution.\n4.  Compute $x_1$ using the formula $x_1 = \\frac{y_1}{1 + A_{n1}z_1}$.\n\nThis method requires two runs of back substitution ($O(n^2)$ each) and a few scalar operations, resulting in an efficient $O(n^2)$ algorithm that leverages the nearly upper triangular structure.\n\n### Application to the Specific System\n\nWe are given the $5 \\times 5$ system with $n=5$, $A_{51} = -3$, and\n$$\nA =\n\\begin{pmatrix}\n3  -1  2  0  1 \\\\\n0  2  1  -1  3 \\\\\n0  0  4  -2  1 \\\\\n0  0  0  5  2 \\\\\n-3  0  0  0  6\n\\end{pmatrix},\n\\qquad\n\\mathbf{b} =\n\\begin{pmatrix}\n7 \\\\ 4 \\\\ 5 \\\\ 1 \\\\ 2\n\\end{pmatrix}.\n$$\nThe corresponding upper triangular matrix $U$ is:\n$$\nU =\n\\begin{pmatrix}\n3  -1  2  0  1 \\\\\n0  2  1  -1  3 \\\\\n0  0  4  -2  1 \\\\\n0  0  0  5  2 \\\\\n0  0  0  0  6\n\\end{pmatrix}\n$$\n**1. Solve for $\\mathbf{y}$ in $U\\mathbf{y} = \\mathbf{b}$:**\n$6y_5 = 2 \\implies y_5 = \\frac{2}{6} = \\frac{1}{3}$.\n$5y_4 + 2y_5 = 1 \\implies 5y_4 = 1 - 2(\\frac{1}{3}) = \\frac{1}{3} \\implies y_4 = \\frac{1}{15}$.\n$4y_3 - 2y_4 + y_5 = 5 \\implies 4y_3 = 5 + 2(\\frac{1}{15}) - \\frac{1}{3} = 5 + \\frac{2-5}{15} = 5 - \\frac{3}{15} = 5 - \\frac{1}{5} = \\frac{24}{5} \\implies y_3 = \\frac{6}{5}$.\n$2y_2 + y_3 - y_4 + 3y_5 = 4 \\implies 2y_2 = 4 - \\frac{6}{5} + \\frac{1}{15} - 3(\\frac{1}{3}) = 3 - \\frac{18-1}{15} = 3 - \\frac{17}{15} = \\frac{45-17}{15} = \\frac{28}{15} \\implies y_2 = \\frac{14}{15}$.\n$3y_1 - y_2 + 2y_3 + y_5 = 7 \\implies 3y_1 = 7 + \\frac{14}{15} - 2(\\frac{6}{5}) - \\frac{1}{3} = 7 + \\frac{14 - 36 - 5}{15} = 7 - \\frac{27}{15} = 7 - \\frac{9}{5} = \\frac{26}{5} \\implies y_1 = \\frac{26}{15}$.\nSo, $y_1 = \\frac{26}{15}$.\n\n**2. Solve for $\\mathbf{z}$ in $U\\mathbf{z} = \\mathbf{e}_5$:**\nThe right-hand side is $\\mathbf{e}_5 = (0, 0, 0, 0, 1)^T$.\n$6z_5 = 1 \\implies z_5 = \\frac{1}{6}$.\n$5z_4 + 2z_5 = 0 \\implies 5z_4 = -2(\\frac{1}{6}) = -\\frac{1}{3} \\implies z_4 = -\\frac{1}{15}$.\n$4z_3 - 2z_4 + z_5 = 0 \\implies 4z_3 = 2(-\\frac{1}{15}) - \\frac{1}{6} = -\\frac{2}{15} - \\frac{1}{6} = \\frac{-4-5}{30} = -\\frac{9}{30} = -\\frac{3}{10} \\implies z_3 = -\\frac{3}{40}$.\n$2z_2 + z_3 - z_4 + 3z_5 = 0 \\implies 2z_2 = -(-\\frac{3}{40}) + (-\\frac{1}{15}) - 3(\\frac{1}{6}) = \\frac{3}{40} - \\frac{1}{15} - \\frac{1}{2} = \\frac{9-8-60}{120} = -\\frac{59}{120} \\implies z_2 = -\\frac{59}{240}$.\n$3z_1 - z_2 + 2z_3 + z_5 = 0 \\implies 3z_1 = z_2 - 2z_3 - z_5$.\n$3z_1 = (-\\frac{59}{240}) - 2(-\\frac{3}{40}) - \\frac{1}{6} = -\\frac{59}{240} + \\frac{6}{40} - \\frac{1}{6} = -\\frac{59}{240} + \\frac{36}{240} - \\frac{40}{240} = \\frac{-59+36-40}{240} = \\frac{-63}{240} = -\\frac{21}{80}$.\nSo, $z_1 = -\\frac{7}{80}$.\n\n**3. Compute $x_1$:**\nWe have $A_{51} = -3$, $y_1 = \\frac{26}{15}$, and $z_1 = -\\frac{7}{80}$.\nSubstituting these values into the derived formula:\n$$x_1 = \\frac{y_1}{1 + A_{51}z_1} = \\frac{\\frac{26}{15}}{1 + (-3)(-\\frac{7}{80})} = \\frac{\\frac{26}{15}}{1 + \\frac{21}{80}}$$\n$$x_1 = \\frac{\\frac{26}{15}}{\\frac{80+21}{80}} = \\frac{\\frac{26}{15}}{\\frac{101}{80}} = \\frac{26}{15} \\times \\frac{80}{101}$$\n$$x_1 = \\frac{26}{3 \\times 5} \\times \\frac{16 \\times 5}{101} = \\frac{26 \\times 16}{3 \\times 101} = \\frac{416}{303}$$\nThe value of $x_1$ for the unique solution is $\\frac{416}{303}$.", "answer": "$$\\boxed{\\frac{416}{303}}$$", "id": "3285181"}]}