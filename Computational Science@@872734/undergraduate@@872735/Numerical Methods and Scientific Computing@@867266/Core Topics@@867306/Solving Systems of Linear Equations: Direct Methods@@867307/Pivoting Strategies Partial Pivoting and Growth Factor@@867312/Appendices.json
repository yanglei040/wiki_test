{"hands_on_practices": [{"introduction": "This exercise provides a foundational workout in the mechanics of Gaussian Elimination with Partial Pivoting (GEPP). By applying the algorithm to a highly structured matrix, you will practice identifying pivots, performing row swaps, and calculating multipliers from first principles [@problem_id:3262489]. Computing the growth factor for this case reinforces its definition and demonstrates how this metric tracks element size throughout the elimination process.", "problem": "Consider the square matrix $\\mathbf{A} \\in \\mathbb{R}^{5 \\times 5}$ with entries defined by $a_{ij} = \\max(i,j)$ for $1 \\leq i,j \\leq 5$. Starting from the core definition of Gaussian Elimination with Partial Pivoting (GEPP), which at each step selects as pivot the entry with largest absolute value in the current column among rows not yet eliminated, compute the permutation matrix $\\mathbf{P}$, the unit lower-triangular matrix $\\mathbf{L}$, and the upper-triangular matrix $\\mathbf{U}$ such that $\\mathbf{P}\\mathbf{A} = \\mathbf{L}\\mathbf{U}$. Then, from the formal definition of growth factor in GEPP as the ratio\n$$\\rho \\;=\\; \\frac{\\max_{i,j,k}\\left|a_{ij}^{(k)}\\right|}{\\max_{i,j}\\left|a_{ij}\\right|},$$\nwhere $a_{ij}^{(k)}$ denotes the $(i,j)$-entry after the $k$-th elimination step, determine the exact value of the growth factor for this factorization.\n\nProvide your final answer as the single exact value of the growth factor $\\rho$. Do not include units. Report only the value of $\\rho$ as your final answer.", "solution": "The problem requires the computation of the $\\mathbf{P}\\mathbf{A} = \\mathbf{L}\\mathbf{U}$ factorization for a specific $5 \\times 5$ matrix $\\mathbf{A}$ using Gaussian Elimination with Partial Pivoting (GEPP), and then determining the growth factor $\\rho$.\n\nFirst, we construct the matrix $\\mathbf{A}$ with entries $a_{ij} = \\max(i, j)$.\n$$\n\\mathbf{A} = \\begin{pmatrix}\n1 & 2 & 3 & 4 & 5 \\\\\n2 & 2 & 3 & 4 & 5 \\\\\n3 & 3 & 3 & 4 & 5 \\\\\n4 & 4 & 4 & 4 & 5 \\\\\n5 & 5 & 5 & 5 & 5\n\\end{pmatrix}\n$$\nThis matrix, $\\mathbf{A}$, can be denoted as $\\mathbf{A}^{(0)}$. The denominator of the growth factor is the maximum absolute value of the entries in $\\mathbf{A}$:\n$$\n\\max_{i,j} |a_{ij}| = \\max_{i,j} |a_{ij}^{(0)}| = 5\n$$\n\nWe now perform GEPP step by step, tracking the intermediate matrices $\\mathbf{A}^{(k)}$ and the permutation matrix $\\mathbf{P}$. The matrix $\\mathbf{L}$ will store the multipliers. Let $\\mathbf{P}$ start as the identity matrix $\\mathbf{I}$.\n\n**Step 1: $k=1$ (Elimination of column 1)**\nThe first column of $\\mathbf{A}^{(0)}$ is $\\begin{pmatrix} 1 & 2 & 3 & 4 & 5 \\end{pmatrix}^T$. The element with the largest absolute value is $a_{51}^{(0)} = 5$. Therefore, we must swap row $1$ and row $5$.\nThe permutation matrix for this step is $\\mathbf{P}_1$. The total permutation matrix is updated: $\\mathbf{P} \\leftarrow \\mathbf{P}_1 \\mathbf{P}$.\nThe state of the matrix after the swap is $\\mathbf{P}_1 \\mathbf{A}^{(0)}$:\n$$\n\\mathbf{P}_1 \\mathbf{A}^{(0)} = \\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n2 & 2 & 3 & 4 & 5 \\\\\n3 & 3 & 3 & 4 & 5 \\\\\n4 & 4 & 4 & 4 & 5 \\\\\n1 & 2 & 3 & 4 & 5\n\\end{pmatrix}\n$$\nThe pivot is $5$. The multipliers $l_{i1}$ for $i > 1$ are:\n$l_{21} = 2/5$, $l_{31} = 3/5$, $l_{41} = 4/5$, $l_{51} = 1/5$.\nWe perform the row operations $R_i \\leftarrow R_i - l_{i1} R_1$ for $i=2,3,4,5$:\n$R_2 \\leftarrow R_2 - \\frac{2}{5}R_1 = \\begin{pmatrix} 2&2&3&4&5 \\end{pmatrix} - \\begin{pmatrix} 2&2&2&2&2 \\end{pmatrix} = \\begin{pmatrix} 0&0&1&2&3 \\end{pmatrix}$\n$R_3 \\leftarrow R_3 - \\frac{3}{5}R_1 = \\begin{pmatrix} 3&3&3&4&5 \\end{pmatrix} - \\begin{pmatrix} 3&3&3&3&3 \\end{pmatrix} = \\begin{pmatrix} 0&0&0&1&2 \\end{pmatrix}$\n$R_4 \\leftarrow R_4 - \\frac{4}{5}R_1 = \\begin{pmatrix} 4&4&4&4&5 \\end{pmatrix} - \\begin{pmatrix} 4&4&4&4&4 \\end{pmatrix} = \\begin{pmatrix} 0&0&0&0&1 \\end{pmatrix}$\n$R_5 \\leftarrow R_5 - \\frac{1}{5}R_1 = \\begin{pmatrix} 1&2&3&4&5 \\end{pmatrix} - \\begin{pmatrix} 1&1&1&1&1 \\end{pmatrix} = \\begin{pmatrix} 0&1&2&3&4 \\end{pmatrix}$\n\nThe matrix after the first elimination step is $\\mathbf{A}^{(1)}$:\n$$\n\\mathbf{A}^{(1)} = \\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n0 & 0 & 1 & 2 & 3 \\\\\n0 & 0 & 0 & 1 & 2 \\\\\n0 & 0 & 0 & 0 & 1 \\\\\n0 & 1 & 2 & 3 & 4\n\\end{pmatrix}\n$$\nThe maximum absolute value in $\\mathbf{A}^{(1)}$ is $\\max_{i,j} |a_{ij}^{(1)}| = 5$.\n\n**Step 2: $k=2$ (Elimination of column 2)**\nWe examine column $2$ from row $2$ downwards in $\\mathbf{A}^{(1)}$: $\\begin{pmatrix} 0 & 0 & 0 & 1 \\end{pmatrix}^T$. The largest absolute value is $a_{52}^{(1)} = 1$. We swap row $2$ and row $5$.\nThe matrix state after the swap is:\n$$\n\\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n0 & 1 & 2 & 3 & 4 \\\\\n0 & 0 & 0 & 1 & 2 \\\\\n0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & 2 & 3\n\\end{pmatrix}\n$$\nThe pivot is $a_{22} = 1$. The multipliers $l_{i2}$ for $i > 2$ are:\n$l_{32} = a_{32}/a_{22} = 0/1 = 0$\n$l_{42} = a_{42}/a_{22} = 0/1 = 0$\n$l_{52} = a_{52}/a_{22} = 0/1 = 0$\nSince all multipliers are $0$, no row operations are performed. The matrix after the second step, $\\mathbf{A}^{(2)}$, is the same as the matrix after the swap.\n$$\n\\mathbf{A}^{(2)} = \\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n0 & 1 & 2 & 3 & 4 \\\\\n0 & 0 & 0 & 1 & 2 \\\\\n0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 1 & 2 & 3\n\\end{pmatrix}\n$$\nThe maximum absolute value in $\\mathbf{A}^{(2)}$ is $\\max_{i,j} |a_{ij}^{(2)}| = 5$.\n\n**Step 3: $k=3$ (Elimination of column 3)**\nWe examine column $3$ from row $3$ downwards in $\\mathbf{A}^{(2)}$: $\\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix}^T$. The largest absolute value is $a_{53}^{(2)} = 1$. We swap row $3$ and row $5$.\nThe matrix state after the swap is:\n$$\n\\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n0 & 1 & 2 & 3 & 4 \\\\\n0 & 0 & 1 & 2 & 3 \\\\\n0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 1 & 2\n\\end{pmatrix}\n$$\nThe pivot is $a_{33}=1$. The multipliers $l_{i3}$ for $i > 3$ are $l_{43} = 0/1=0$ and $l_{53} = 0/1=0$. No row operations are performed.\n$$\n\\mathbf{A}^{(3)} = \\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n0 & 1 & 2 & 3 & 4 \\\\\n0 & 0 & 1 & 2 & 3 \\\\\n0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 1 & 2\n\\end{pmatrix}\n$$\nThe maximum absolute value in $\\mathbf{A}^{(3)}$ is $\\max_{i,j} |a_{ij}^{(3)}| = 5$.\n\n**Step 4: $k=4$ (Elimination of column 4)**\nWe examine column $4$ from row $4$ downwards in $\\mathbf{A}^{(3)}$: $\\begin{pmatrix} 0 & 1 \\end{pmatrix}^T$. The largest absolute value is $a_{54}^{(3)}=1$. We swap row $4$ and row $5$.\nThe matrix state after the swap is:\n$$\n\\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n0 & 1 & 2 & 3 & 4 \\\\\n0 & 0 & 1 & 2 & 3 \\\\\n0 & 0 & 0 & 1 & 2 \\\\\n0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nThe pivot is $a_{44}=1$. The multiplier $l_{54}=0/1=0$. No row operation is performed. The final upper-triangular matrix $\\mathbf{U}$ is this matrix.\n$$\n\\mathbf{U} = \\mathbf{A}^{(4)} = \\begin{pmatrix}\n5 & 5 & 5 & 5 & 5 \\\\\n0 & 1 & 2 & 3 & 4 \\\\\n0 & 0 & 1 & 2 & 3 \\\\\n0 & 0 & 0 & 1 & 2 \\\\\n0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nThe maximum absolute value in $\\mathbf{A}^{(4)}$ is $\\max_{i,j} |a_{ij}^{(4)}| = 5$.\n\nThe overall permutation $\\mathbf{P}$ is the product of the individual permutations: $\\mathbf{P} = \\mathbf{P}_4 \\mathbf{P}_3 \\mathbf{P}_2 \\mathbf{P}_1$. This corresponds to mapping the original rows $(1,2,3,4,5)$ to the final row order $(5,1,2,3,4)$.\n$$\n\\mathbf{P} = \\begin{pmatrix}\n0 & 0 & 0 & 0 & 1 \\\\\n1 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0\n\\end{pmatrix}\n$$\nThe matrix $\\mathbf{L}$ contains the multipliers $l_{ij}$ arranged according to the final permutation.\n$$\n\\mathbf{L} = \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 \\\\\n1/5 & 1 & 0 & 0 & 0 \\\\\n2/5 & 0 & 1 & 0 & 0 \\\\\n3/5 & 0 & 0 & 1 & 0 \\\\\n4/5 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\nNow we compute the growth factor $\\rho$. The definition is:\n$$\n\\rho = \\frac{\\max_{i,j,k}\\left|a_{ij}^{(k)}\\right|}{\\max_{i,j}\\left|a_{ij}\\right|}\n$$\nThe numerator is the maximum absolute value found across all entries of all intermediate matrices $\\mathbf{A}^{(k)}$ (for $k=0,1,2,3,4$).\n$\\max |a_{ij}^{(0)}| = 5$\n$\\max |a_{ij}^{(1)}| = 5$\n$\\max |a_{ij}^{(2)}| = 5$\n$\\max |a_{ij}^{(3)}| = 5$\n$\\max |a_{ij}^{(4)}| = 5$\nThus, the overall maximum is $\\max_{i,j,k} |a_{ij}^{(k)}| = 5$.\n\nThe denominator is $\\max_{i,j} |a_{ij}| = 5$.\nTherefore, the growth factor is:\n$$\n\\rho = \\frac{5}{5} = 1\n$$", "answer": "$$\n\\boxed{1}\n$$", "id": "3262489"}, {"introduction": "Does a matrix with ones on the diagonal and small off-diagonal entries guarantee that no pivoting is needed? This problem is a thought-provoking exercise designed to address this common misconception [@problem_id:3262474]. By analyzing a carefully constructed $3 \\times 3$ matrix, you will discover that the need for pivoting is dynamic, depending on the state of the matrix as elimination proceeds, not just on its initial form. This practice sharpens your intuition about the conditions that demand pivoting to maintain numerical stability.", "problem": "Consider the matrix $A \\in \\mathbb{R}^{3 \\times 3}$ given by\n$$\nA \\;=\\; \\begin{pmatrix}\n1 & \\frac{9}{10} & 0 \\\\\n\\frac{9}{10} & 1 & 0 \\\\\n\\frac{1}{5} & \\frac{4}{5} & 1\n\\end{pmatrix}.\n$$\nAll diagonal entries are $1$ and all off-diagonal entries have magnitude strictly less than $1$. Apply Gaussian Elimination with Partial Pivoting (GEPP). Starting from the fundamental definition of partial pivoting (at each step, among the active rows, select as pivot the entry of largest magnitude in the current column and swap the current row with that pivot row if necessary), reason from first principles to:\n- Determine whether GEPP performs a row swap at the second elimination step, and justify why.\n- Complete the elimination to obtain the upper-triangular factor $U$.\n- Using the core definition of element growth factor for GEPP as the ratio of the largest-magnitude entry produced in the upper-triangular factor $U$ to the largest-magnitude entry of the original matrix $A$, compute this growth factor as an exact value.\n\nProvide your final answer as a single real number. No rounding is required.", "solution": "We apply Gaussian Elimination with Partial Pivoting (GEPP) from first principles.\n\nThe initial matrix is given by:\n$$ A = A^{(0)} = \\begin{pmatrix} 1 & \\frac{9}{10} & 0 \\\\ \\frac{9}{10} & 1 & 0 \\\\ \\frac{1}{5} & \\frac{4}{5} & 1 \\end{pmatrix} $$\n\n**Step 1: Elimination for column $k=1$**\n\nAccording to the GEPP algorithm, we first identify the pivot element in the first column. We examine the entries on or below the diagonal in this column: $a_{11}^{(0)}$, $a_{21}^{(0)}$, and $a_{31}^{(0)}$.\nThe values are $1$, $\\frac{9}{10}$, and $\\frac{1}{5}$. We compare their absolute values:\n$$ |a_{11}^{(0)}| = 1 $$\n$$ |a_{21}^{(0)}| = \\frac{9}{10} = 0.9 $$\n$$ |a_{31}^{(0)}| = \\frac{1}{5} = 0.2 $$\nThe entry with the largest magnitude is $a_{11}^{(0)} = 1$, which is already in the pivot position (row $1$, column $1$). Therefore, no row swap is necessary at this step.\n\nWe proceed with elimination. The multipliers are calculated as:\n$$ m_{21} = \\frac{a_{21}^{(0)}}{a_{11}^{(0)}} = \\frac{9/10}{1} = \\frac{9}{10} $$\n$$ m_{31} = \\frac{a_{31}^{(0)}}{a_{11}^{(0)}} = \\frac{1/5}{1} = \\frac{1}{5} $$\n\nWe update the matrix by performing the row operations $R_2 \\leftarrow R_2 - m_{21} R_1$ and $R_3 \\leftarrow R_3 - m_{31} R_1$.\nThe new entries of the matrix, denoted as $A^{(1)}$, are:\nFor row $2$:\n$a_{22}^{(1)} = a_{22}^{(0)} - m_{21} a_{12}^{(0)} = 1 - \\left(\\frac{9}{10}\\right)\\left(\\frac{9}{10}\\right) = 1 - \\frac{81}{100} = \\frac{19}{100}$\n$a_{23}^{(1)} = a_{23}^{(0)} - m_{21} a_{13}^{(0)} = 0 - \\left(\\frac{9}{10}\\right)(0) = 0$\nFor row $3$:\n$a_{32}^{(1)} = a_{32}^{(0)} - m_{31} a_{12}^{(0)} = \\frac{4}{5} - \\left(\\frac{1}{5}\\right)\\left(\\frac{9}{10}\\right) = \\frac{4}{5} - \\frac{9}{50} = \\frac{40}{50} - \\frac{9}{50} = \\frac{31}{50}$\n$a_{33}^{(1)} = a_{33}^{(0)} - m_{31} a_{13}^{(0)} = 1 - \\left(\\frac{1}{5}\\right)(0) = 1$\n\nAfter the first step of elimination, the matrix is:\n$$ A^{(1)} = \\begin{pmatrix} 1 & \\frac{9}{10} & 0 \\\\ 0 & \\frac{19}{100} & 0 \\\\ 0 & \\frac{31}{50} & 1 \\end{pmatrix} $$\n\n**Step 2: Elimination for column $k=2$ and determination of row swap**\n\nNow we consider the second column. The pivot selection is performed on the sub-column consisting of entries on or below the diagonal, which are $a_{22}^{(1)}$ and $a_{32}^{(1)}$. We compare their absolute values:\n$$ |a_{22}^{(1)}| = \\left|\\frac{19}{100}\\right| = \\frac{19}{100} = 0.19 $$\n$$ |a_{32}^{(1)}| = \\left|\\frac{31}{50}\\right| = \\frac{31}{50} = \\frac{62}{100} = 0.62 $$\nSince $|a_{32}^{(1)}| > |a_{22}^{(1)}|$, GEPP requires a row swap. The pivot must be the entry with the largest magnitude, which is $a_{32}^{(1)}$.\n\n**Justification for the second-step row swap:**\nYes, a row swap is performed at the second elimination step. This is because the partial pivoting strategy mandates selecting the element of largest magnitude in the current column (from the diagonal downwards) as the pivot. At step $k=2$, the candidates for the pivot in column $2$ were $a_{22}^{(1)} = \\frac{19}{100}$ and $a_{32}^{(1)} = \\frac{31}{50}$. As $|\\frac{31}{50}| > |\\frac{19}{100}|$, the element in row $3$ must be brought into the pivot position (row $2$, column $2$) by swapping row $2$ and row $3$.\n\nWe perform the swap $R_2 \\leftrightarrow R_3$. The matrix becomes:\n$$ A'^{(1)} = \\begin{pmatrix} 1 & \\frac{9}{10} & 0 \\\\ 0 & \\frac{31}{50} & 1 \\\\ 0 & \\frac{19}{100} & 0 \\end{pmatrix} $$\nThe new pivot is $a_{22}'^{(1)} = \\frac{31}{50}$. The multiplier to eliminate the element below the pivot is:\n$$ m_{32} = \\frac{a_{32}'^{(1)}}{a_{22}'^{(1)}} = \\frac{19/100}{31/50} = \\frac{19}{100} \\cdot \\frac{50}{31} = \\frac{19}{2 \\cdot 31} = \\frac{19}{62} $$\nWe perform the row operation $R_3 \\leftarrow R_3 - m_{32} R_2$:\n$a_{33}^{(2)} = a_{33}'^{(1)} - m_{32} a_{23}'^{(1)} = 0 - \\left(\\frac{19}{62}\\right)(1) = -\\frac{19}{62}$\n\nThe elimination process is now complete. The resulting upper-triangular matrix, $U$, is:\n$$ U = A^{(2)} = \\begin{pmatrix} 1 & \\frac{9}{10} & 0 \\\\ 0 & \\frac{31}{50} & 1 \\\\ 0 & 0 & -\\frac{19}{62} \\end{pmatrix} $$\n\n**Step 3: Computation of the growth factor**\n\nThe problem defines the growth factor, $\\rho$, as the ratio of the largest-magnitude entry in $U$ to the largest-magnitude entry in the original matrix $A$.\n$$ \\rho = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|} $$\n\nFirst, we find the largest-magnitude entry in $A$:\n$$ \\max_{i,j} |a_{ij}| = \\max\\left\\{|1|, \\left|\\frac{9}{10}\\right|, |0|, \\left|\\frac{9}{10}\\right|, |1|, |0|, \\left|\\frac{1}{5}\\right|, \\left|\\frac{4}{5}\\right|, |1|\\right\\} = \\max\\left\\{1, \\frac{9}{10}, 0, \\frac{1}{5}, \\frac{4}{5}\\right\\} = 1 $$\n\nNext, we find the largest-magnitude entry in $U$:\n$$ \\max_{i,j} |u_{ij}| = \\max\\left\\{|1|, \\left|\\frac{9}{10}\\right|, |0|, \\left|\\frac{31}{50}\\right|, |1|, \\left|-\\frac{19}{62}\\right|\\right\\} = \\max\\left\\{1, 0.9, 0, 0.62, 1, \\frac{19}{62}\\right\\} $$\nSince $\\frac{19}{62} \\approx 0.306$, the maximum value in this set is $1$.\n$$ \\max_{i,j} |u_{ij}| = 1 $$\n\nFinally, we compute the growth factor:\n$$ \\rho = \\frac{1}{1} = 1 $$\n\nThe growth factor is exactly $1$.", "answer": "$$\\boxed{1}$$", "id": "3262474"}, {"introduction": "Partial pivoting is a powerful strategy, but it is not a silver bullet that guarantees stability in all cases. This computational experiment has you explore a classic matrix family for which the growth factor can become large even when partial pivoting is used [@problem_id:3262624]. By implementing the elimination algorithm and observing the element growth firsthand, you will bridge the gap between theory and practice and appreciate why the growth factor is a crucial concept for understanding the limitations of this fundamental algorithm.", "problem": "You are to design and implement a computational experiment that demonstrates, from first principles of Gaussian elimination, that the growth factor can be large even when pivot magnitudes are not small. Your program must construct a specific family of matrices and compute the growth factor under two pivoting strategies.\n\nDefinitions and foundational base:\n- Let $A \\in \\mathbb{R}^{n \\times n}$ be the input matrix.\n- Gaussian elimination proceeds by column, at step $k \\in \\{1, \\dots, n-1\\}$, using multipliers $m_{ik} = a_{ik}^{(k-1)} / a_{kk}^{(k-1)}$ to zero out entries below the pivot $a_{kk}^{(k-1)}$, producing a sequence of matrices $A^{(0)}, A^{(1)}, \\dots, A^{(n-1)}$, where $A^{(0)} = A$ and $A^{(n-1)}$ is upper triangular.\n- The growth factor $\\gamma$ for Gaussian elimination (with a specified pivoting strategy) is defined as\n$$\n\\gamma = \\frac{\\max_{i,j,k} \\left| a_{ij}^{(k)} \\right|}{\\max_{i,j} \\left| a_{ij}^{(0)} \\right|}.\n$$\n- Partial pivoting chooses at each step $k$ the pivot $a_{p k}^{(k-1)}$ with largest absolute value among rows $p \\in \\{k, k+1, \\dots, n\\}$ and swaps row $p$ with row $k$ before elimination. No pivoting uses $a_{kk}^{(k-1)}$ as is without any row swaps.\n\nMatrix family to construct:\n- For each size $n \\ge 2$, define $A_n \\in \\mathbb{R}^{n \\times n}$ by\n  - $a_{ii} = 1$ for all $i \\in \\{1, \\dots, n\\}$,\n  - $a_{i+1,i} = -1$ for all $i \\in \\{1, \\dots, n-1\\}$,\n  - $a_{i,n} = 1$ for all $i \\in \\{1, \\dots, n\\}$,\n  - all other entries are $0$.\n- This $A_n$ is strictly lower-bidiagonal plus a constant last column. Note that the initial maximum absolute entry is $1$, and the pivot $a_{kk}^{(k-1)}$ equals $1$ throughout the elimination (so the pivot magnitudes are not small). Yet elimination fill-in can produce large intermediate entries in the last column.\n\nRequired computations:\n- Implement Gaussian elimination while tracking $\\max_{i,j,k} \\left| a_{ij}^{(k)} \\right|$ for two pivoting strategies:\n  1. No pivoting.\n  2. Partial pivoting.\n- For each strategy, compute the growth factor $\\gamma$ as defined above.\n\nTest suite:\n- Use sizes $n = 2$, $n = 6$, and $n = 25$.\n- These cover a boundary case ($n = 2$), a general case ($n = 6$), and a larger case ($n = 25$).\n- For each $n$, compute and return a pair containing the growth factors for no pivoting and partial pivoting in this order.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list $[\\gamma_{\\text{none}}, \\gamma_{\\text{partial}}]$.\n- For example, the output should look like $[[\\gamma_{2,\\text{none}},\\gamma_{2,\\text{partial}}],[\\gamma_{6,\\text{none}},\\gamma_{6,\\text{partial}}],[\\gamma_{25,\\text{none}},\\gamma_{25,\\text{partial}}]]$.\n- The values $\\gamma$ must be reported as integers (exact, no rounding instruction is needed because the construction yields integer growth factors for these cases).", "solution": "This solution derives the growth factor $\\gamma$ for the specified matrix family $A_n$ under two pivoting strategies.\n\n### Analysis of the Matrix and Growth Factor\nFor any $n \\ge 2$, the matrix $A_n$ has entries with a maximum absolute value of 1.\n$$\n\\max_{i,j} |a_{ij}^{(0)}| = 1\n$$\nThe growth factor definition $\\gamma = \\frac{\\max_{i,j,k} |a_{ij}^{(k)}|}{\\max_{i,j} |a_{ij}^{(0)}|}$ simplifies to finding the largest absolute value of any element that appears at any stage of the elimination:\n$$\n\\gamma = \\max_{i,j,k} |a_{ij}^{(k)}|\n$$\n\n### Strategy 1: No Pivoting\nWe perform Gaussian elimination without row swaps. Let us trace the effect on the last column, which is where element growth occurs.\n- **Step $k=1$**: The pivot is $a_{11}^{(0)}=1$. The only entry to eliminate is $a_{21}^{(0)}=-1$, so the multiplier is $m_{21}=-1$. We update row 2: $R_2 \\leftarrow R_2 - (-1)R_1 = R_2 + R_1$. The element in the last column of row 2 becomes $a_{2n}^{(1)} = a_{2n}^{(0)} + a_{1n}^{(0)} = 1 + 1 = 2$.\n- **Step $k=2$**: The pivot is $a_{22}^{(1)}=1$. The entry to eliminate is $a_{32}^{(1)}=-1$, so $m_{32}=-1$. We update row 3: $R_3 \\leftarrow R_3 + R_2$. The element in the last column of row 3 becomes $a_{3n}^{(2)} = a_{3n}^{(1)} + a_{2n}^{(1)} = 1 + 2 = 3$. (Note that $a_{3n}^{(1)}=a_{3n}^{(0)}=1$ as it was not affected by step 1).\n- **General Step $k$ (for $k < n-1$)**: By induction, at the start of step $k$, the element $a_{k,n}^{(k-1)}$ has grown to the value $k$. The pivot is $a_{kk}^{(k-1)}=1$, the multiplier for row $k+1$ is $m_{k+1,k}=-1$, and the update is $R_{k+1} \\leftarrow R_{k+1} + R_k$. The element in the last column of row $k+1$ becomes $a_{k+1,n}^{(k)} = a_{k+1,n}^{(k-1)} + a_{k,n}^{(k-1)} = 1 + k$.\n- **Final Step $k=n-1$**: The element $a_{n-1,n}^{(n-2)}$ has value $n-1$. The pivot is $a_{n-1,n-1}^{(n-2)}=1$, and we eliminate $a_{n,n-1}^{(n-2)}=-1$ with multiplier $m_{n,n-1}=-1$. The final element in the matrix, $a_{nn}^{(n-1)}$, becomes $a_{nn}^{(n-1)} = a_{nn}^{(n-2)} + a_{n-1,n}^{(n-2)} = 1 + (n-1) = n$.\n\nThe maximum element value encountered during the entire process is $n$. Thus, for the no-pivoting strategy, the growth factor is $\\gamma_{\\text{none}} = n$.\n\n### Strategy 2: Partial Pivoting\nWe now consider using partial pivoting.\n- **Step $k=1$**: We search column 1 (from row 1 down) for the largest absolute value. The candidates are $a_{11}^{(0)}=1$ and $a_{21}^{(0)}=-1$. The maximum absolute value is 1. Standard tie-breaking rules select the first-encountered maximum, which is $a_{11}^{(0)}$ in row 1. Thus, no row swap is performed. The elimination proceeds identically to the no-pivoting case.\n- **Step $k$**: At any step $k$, the matrix $A^{(k-1)}$ has a subdiagonal entry $a_{k+1,k}^{(k-1)}=-1$ and a diagonal entry $a_{kk}^{(k-1)}=1$. All other entries in column $k$ at or below the diagonal are zero. The pivot search again finds a maximum absolute value of 1, and the element $a_{kk}^{(k-1)}$ is chosen as the pivot. No row swaps are performed.\n\nSince partial pivoting does not perform any row swaps for this matrix family, the elimination process is identical to the no-pivoting strategy.\n\nConsequently, the growth factor for partial pivoting is the same: $\\gamma_{\\text{partial}} = n$.\n\n### Test Suite Results\nBased on the analysis, for any given $n$, both strategies yield a growth factor of $n$.\n- For $n=2$: $[\\gamma_{\\text{none}}, \\gamma_{\\text{partial}}] = [2, 2]$\n- For $n=6$: $[\\gamma_{\\text{none}}, \\gamma_{\\text{partial}}] = [6, 6]$\n- For $n=25$: $[\\gamma_{\\text{none}}, \\gamma_{\\text{partial}}] = [25, 25]$\n\nThe final result is the aggregation of these pairs.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a computational experiment to demonstrate that the\n    growth factor in Gaussian elimination can be large even when pivot\n    magnitudes are not small.\n    \"\"\"\n\n    def build_matrix(n: int) -> np.ndarray:\n        \"\"\"\n        Constructs the specific matrix A_n of size n x n.\n\n        Args:\n            n: The dimension of the square matrix.\n\n        Returns:\n            The n x n matrix A_n.\n        \"\"\"\n        A = np.zeros((n, n), dtype=float)\n        # Set diagonal entries to 1\n        np.fill_diagonal(A, 1)\n        # Set subdiagonal entries to -1\n        if n > 1:\n            np.fill_diagonal(A[1:], -1)\n        # Set the last column to 1\n        A[:, n - 1] = 1\n        return A\n\n    def compute_growth_factor(A: np.ndarray, use_partial_pivoting: bool) -> int:\n        \"\"\"\n        Performs Gaussian elimination on a matrix and computes the growth factor.\n\n        Args:\n            A: The input matrix.\n            use_partial_pivoting: A boolean to select the pivoting strategy.\n\n        Returns:\n            The computed growth factor as an integer.\n        \"\"\"\n        n = A.shape[0]\n        A_work = A.copy()\n\n        # The denominator of the growth factor is the max abs value of the initial matrix.\n        max_initial = np.max(np.abs(A_work))\n        if max_initial == 0:\n            return 1  # Growth factor is 1 for a zero matrix.\n\n        # The numerator of the growth factor is the max abs value across all intermediate matrices.\n        max_overall = max_initial\n\n        for k in range(n - 1):\n            if use_partial_pivoting:\n                # Find the row index of the element with the largest absolute value in the current column,\n                # starting from the current row k.\n                pivot_row_index = k + np.argmax(np.abs(A_work[k:, k]))\n                \n                # Swap the current row with the pivot row if they are different.\n                if pivot_row_index != k:\n                    A_work[[k, pivot_row_index]] = A_work[[pivot_row_index, k]]\n                \n                # A row swap does not create new values, so no update to max_overall is needed here.\n                # It will be captured after the elimination step.\n\n            # Pivot element is at A_work[k, k].\n            pivot_val = A_work[k, k]\n            if pivot_val == 0:\n                # Encountered a zero pivot. This case will not happen with the problem's matrices\n                # and partial pivoting on a non-singular matrix.\n                # For a general-purpose solver, this would require special handling.\n                # We can assume it does not happen here.\n                continue\n\n            # Elimination step: update rows below the pivot.\n            for i in range(k + 1, n):\n                multiplier = A_work[i, k] / pivot_val\n                # Apply the row operation.\n                A_work[i, k:] -= multiplier * A_work[k, k:]\n            \n            # After step k, the matrix is A^(k). Update the max overall element value.\n            max_overall = max(max_overall, np.max(np.abs(A_work)))\n\n        growth_factor = max_overall / max_initial\n        # The problem guarantees integer results.\n        return int(round(growth_factor))\n\n    # The test suite consists of matrices of sizes n = 2, 6, 25.\n    test_cases = [2, 6, 25]\n    \n    results = []\n    for n in test_cases:\n        A = build_matrix(n)\n        \n        # Compute growth factor for no pivoting\n        gamma_none = compute_growth_factor(A, use_partial_pivoting=False)\n        \n        # Compute growth factor for partial pivoting\n        gamma_partial = compute_growth_factor(A, use_partial_pivoting=True)\n        \n        results.append([gamma_none, gamma_partial])\n\n    # Final print statement in the exact required format.\n    # e.g., [[2, 2], [6, 6], [25, 25]]\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "3262624"}]}