{"hands_on_practices": [{"introduction": "To assess and compare the quality of different numerical integration methods, we need a formal way to measure their accuracy. The concept of \"degree of precision\" provides just that, defining the highest degree of a polynomial that a given rule can integrate exactly. This first exercise [@problem_id:2175007] serves as a fundamental introduction, guiding you through the process of calculating the degree of precision for the one-point Gauss-Legendre rule (more commonly known as the Midpoint Rule). Mastering this simple case will build a solid foundation for understanding more advanced quadrature methods.", "problem": "The degree of precision of a numerical quadrature rule is the largest integer $d$ such that the rule exactly computes the integral for all polynomials of degree up to and including $d$.\n\nConsider the one-point Gauss-Legendre quadrature rule, which approximates the definite integral of a function $f(x)$ over the interval $[-1, 1]$ using the formula:\n$$ \\int_{-1}^{1} f(x) \\,dx \\approx 2 f(0) $$\n\nTo determine the degree of precision for this rule, you must test its accuracy on monomials of the form $f(x) = x^k$ for non-negative integers $k = 0, 1, 2, \\ldots$. By identifying the highest value of $k$ for which the rule gives the exact result, you can determine the degree of precision.\n\nWhat is the degree of precision of the one-point Gauss-Legendre quadrature rule described above?\n\nA. 0\n\nB. 1\n\nC. 2\n\nD. 3", "solution": "We test the rule $Q(f)=2 f(0)$ on monomials $f(x)=x^{k}$ and compare with the exact integral over $[-1,1]$ to determine the largest integer $d$ such that the rule is exact for all polynomials of degree at most $d$.\n\nFor $k=0$ (constants): \n$$\\int_{-1}^{1} x^{0} \\, dx=\\int_{-1}^{1} 1 \\, dx=2,$$\nwhile the quadrature gives\n$$Q(x^{0})=2 \\cdot 1=2.$$\nThus it is exact for $k=0$.\n\nFor $k=1$ (linear):\n$$\\int_{-1}^{1} x \\, dx=0,$$\nand\n$$Q(x)=2 \\cdot 0=0.$$\nThus it is exact for $k=1$.\n\nFor $k=2$ (quadratic):\n$$\\int_{-1}^{1} x^{2} \\, dx=\\left.\\frac{x^{3}}{3}\\right|_{-1}^{1}=\\frac{2}{3},$$\nbut\n$$Q(x^{2})=2 \\cdot 0^{2}=0.$$\nThus it is not exact for $k=2$.\n\nTherefore, the rule is exact for all polynomials of degree at most $1$ and fails for degree $2$. Hence, the degree of precision is $1$, which corresponds to option B. (Note: although the rule is also exact for all odd monomials due to symmetry and $f(0)=0$, the degree of precision requires exactness for all polynomials up to a given degree, and failure at $k=2$ limits the degree to $1$.)", "answer": "$$\\boxed{B}$$", "id": "2175007"}, {"introduction": "While simple rules like the Midpoint Rule are easy to understand, more sophisticated methods like Gaussian quadrature can achieve remarkable accuracy with very few function evaluations. This efficiency is directly reflected in their high degree of precision, a result of optimally choosing the integration points (nodes) and their corresponding weights. This practice [@problem_id:2419560] challenges you to determine the precision of a given 3-point rule, revealing a surprisingly high value and demonstrating the practical power of advanced numerical integration techniques.", "problem": "An unknown $3$-point quadrature rule $Q[f]$ is specified for the integral $\\int_{-1}^{1} f(x)\\,dx$ by its nodes and weights:\n- Nodes: $x_{1}=-\\sqrt{\\dfrac{3}{5}}$, $x_{2}=0$, $x_{3}=+\\sqrt{\\dfrac{3}{5}}$.\n- Weights: $w_{1}=\\dfrac{5}{9}$, $w_{2}=\\dfrac{8}{9}$, $w_{3}=\\dfrac{5}{9}$.\n\nUsing only these nodes and weights, determine the polynomial degree of precision of this rule, i.e., the largest integer $m$ such that $Q[p]=\\int_{-1}^{1} p(x)\\,dx$ for every polynomial $p$ of degree at most $m$.\n\nChoose one:\n\nA. $3$\n\nB. $4$\n\nC. $5$\n\nD. $6$", "solution": "The degree of precision, $m$, of a quadrature rule is the maximum integer such that the rule exactly integrates all polynomials of degree up to $m$. To find $m$, we test the rule on the basis of monomials $p_k(x) = x^k$ for $k = 0, 1, 2, \\dots$. The rule has a degree of precision $m$ if it is exact for all $k \\leq m$ and not exact for $k = m+1$.\n\nThe exact integral of the monomial $x^k$ over the interval $[-1, 1]$ is:\n$$I[x^k] = \\int_{-1}^{1} x^k \\,dx = \\left[ \\frac{x^{k+1}}{k+1} \\right]_{-1}^{1} = \\frac{1 - (-1)^{k+1}}{k+1}$$\nThis evaluates to:\n- $I[x^k] = \\frac{2}{k+1}$ if $k$ is even.\n- $I[x^k] = 0$ if $k$ is odd.\n\nThe quadrature approximation is given by:\n$$Q[x^k] = w_1 x_1^k + w_2 x_2^k + w_3 x_3^k = \\frac{5}{9}\\left(-\\sqrt{\\frac{3}{5}}\\right)^k + \\frac{8}{9}(0)^k + \\frac{5}{9}\\left(+\\sqrt{\\frac{3}{5}}\\right)^k$$\n\nWe now test for increasing values of $k$.\n\nFor $k=0$: The polynomial is $p_0(x) = 1$.\n$I[1] = \\int_{-1}^{1} 1 \\,dx = 2$.\n$Q[1] = \\frac{5}{9}(1) + \\frac{8}{9}(1) + \\frac{5}{9}(1) = \\frac{5+8+5}{9} = \\frac{18}{9} = 2$.\n$I[1] = Q[1]$. The rule is exact for degree $0$.\n\nFor odd $k \\ge 1$: The nodes and weights are symmetric about $x=0$. That is, $x_1 = -x_3$ and $w_1 = w_3$. For any odd function $f(x)$, $Q[f] = w_1 f(x_1) + w_2 f(0) + w_3 f(x_3) = w_1 f(-x_3) + w_2 f(0) + w_1 f(x_3) = -w_1 f(x_3) + w_2 f(0) + w_1 f(x_3) = w_2 f(0)$.\nFor $p_k(x) = x^k$ with odd $k \\ge 1$, $p_k(0)=0$. Thus, $Q[x^k] = 0$.\nThe exact integral $I[x^k]=0$ for odd $k$.\nTherefore, $I[x^k] = Q[x^k]$ for all odd $k \\ge 1$. We have explicitly verified this for $k=1, 3, 5$:\n- For $k=1$: $I[x]=0$, $Q[x]=0$.\n- For $k=3$: $I[x^3]=0$, $Q[x^3]=0$.\n- For $k=5$: $I[x^5]=0$, $Q[x^5]=0$.\nThe rule is exact for polynomials of degree $1$, $3$, and $5$.\n\nWe need only check the even degrees.\nFor even $k$:\n$Q[x^k] = \\frac{5}{9}\\left(-\\sqrt{\\frac{3}{5}}\\right)^k + \\frac{8}{9}(0)^k + \\frac{5}{9}\\left(+\\sqrt{\\frac{3}{5}}\\right)^k = \\frac{5}{9}\\left(\\frac{3}{5}\\right)^{k/2} + 0 + \\frac{5}{9}\\left(\\frac{3}{5}\\right)^{k/2} = 2 \\cdot \\frac{5}{9}\\left(\\frac{3}{5}\\right)^{k/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{k/2}$.\n\nFor $k=2$:\n$I[x^2] = \\frac{2}{2+1} = \\frac{2}{3}$.\n$Q[x^2] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{2/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right) = \\frac{30}{45} = \\frac{2}{3}$.\n$I[x^2] = Q[x^2]$. The rule is exact for degree $2$.\n\nFor $k=4$:\n$I[x^4] = \\frac{2}{4+1} = \\frac{2}{5}$.\n$Q[x^4] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{4/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^2 = \\frac{10}{9}\\left(\\frac{9}{25}\\right) = \\frac{10}{25} = \\frac{2}{5}$.\n$I[x^4] = Q[x^4]$. The rule is exact for degree $4$.\n\nSince the rule is exact for monomials of degree $0, 1, 2, 3, 4, 5$, it is exact for any linear combination of these monomials, which is any polynomial of degree up to $5$. The degree of precision is at least $5$.\n\nNow we must test $k=6$:\n$I[x^6] = \\frac{2}{6+1} = \\frac{2}{7}$.\n$Q[x^6] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{6/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^3 = \\frac{10}{9}\\left(\\frac{27}{125}\\right) = \\frac{10 \\cdot 27}{9 \\cdot 125} = \\frac{10 \\cdot 3}{125} = \\frac{30}{125} = \\frac{6}{25}$.\nWe compare $I[x^6]$ and $Q[x^6]$:\n$I[x^6] = \\frac{2}{7} \\approx 0.2857$.\n$Q[x^6] = \\frac{6}{25} = 0.24$.\nClearly, $I[x^6] \\neq Q[x^6]$. The rule is not exact for polynomials of degree $6$.\n\nThe largest integer $m$ for which the rule is exact for all polynomials of degree at most $m$ is $5$.\n\n**Evaluation of Options**\n\nA. $3$: This is **Incorrect**. The rule is shown to be exact for polynomials of degree $4$ and $5$.\n\nB. $4$: This is **Incorrect**. The rule is shown to be exact for polynomials of degree $5$.\n\nC. $5$: This is **Correct**. The rule is exact for all polynomials of degree up to and including $5$, but fails for a polynomial of degree $6$.\n\nD. $6$: This is **Incorrect**. The rule is not exact for the polynomial $p(x)=x^6$.", "answer": "$$\\boxed{C}$$", "id": "2419560"}, {"introduction": "A high degree of precision ensures a formula is theoretically exact for a certain class of functions, but its performance on a real computer with finite-precision arithmetic is a different matter. This final practice [@problem_id:3222056] shifts our focus from the theoretical exactness of integration to the practical limits of precision in numerical computation, using numerical differentiation as an example. You will explore the critical trade-off between truncation error, which is inherent to the mathematical approximation, and round-off error, which arises from floating-point computation, by finding an optimal step size $h$. This exercise addresses a fundamental challenge at the heart of all scientific computing.", "problem": "You are approximating the derivative of a smooth function $f$ at a point $x$ using the forward-difference formula $D(h) = \\frac{f(x+h) - f(x)}{h}$ computed in standard floating-point arithmetic with unit roundoff $u \\in (0,1)$. Assume that $f$ is at least twice continuously differentiable in a neighborhood of $x$, that $f''(x) \\neq 0$, and that $|f(x)| > 0$. Adopt the conventional floating-point model that each returned function value satisfies $\\widehat{f}(y) = f(y)(1+\\delta)$ with $|\\delta| \\leq u$, independently for each evaluation.\n\nUsing Taylorâ€™s theorem for truncation error and the floating-point model above for round-off error, derive an explicit upper bound, as a function of the step size $h>0$, on the absolute error of $D(h)$ as an approximation to $f'(x)$. Then, by minimizing that bound with respect to $h$, determine the step size $h$ that balances truncation and round-off errors. Provide your final answer as a single closed-form expression in terms of $u$, $|f(x)|$, and $|f''(x)|$. Do not introduce any numerical values for these quantities, and do not assume any cancellations beyond what is justified by the assumptions stated. Your final answer must be a single analytic expression.", "solution": "The total error in the computed approximation $\\widehat{D}(h)$ of the derivative $f'(x)$ is given by $E_{total}(h) = |\\widehat{D}(h) - f'(x)|$. We can use the triangle inequality to decompose this error into two components: the truncation error and the round-off error.\n$$E_{total}(h) = |(\\widehat{D}(h) - D(h)) + (D(h) - f'(x))| \\le |\\widehat{D}(h) - D(h)| + |D(h) - f'(x)|$$\nThe term $|D(h) - f'(x)|$ is the truncation error, $E_{trunc}(h)$, which arises because we are using a finite difference formula to approximate a limit. The term $|\\widehat{D}(h) - D(h)|$ is the round-off error, $E_{round}(h)$, which arises from the finite precision of floating-point arithmetic.\n\nFirst, let's analyze the truncation error, $E_{trunc}(h)$. Since the function $f$ is assumed to be at least twice continuously differentiable, we can use Taylor's theorem to expand $f(x+h)$ around $x$:\n$$f(x+h) = f(x) + hf'(x) + \\frac{h^2}{2} f''(\\xi)$$\nwhere $\\xi$ is some point between $x$ and $x+h$.\nSubstituting this expansion into the formula for $D(h)$:\n$$D(h) = \\frac{\\left(f(x) + hf'(x) + \\frac{h^2}{2} f''(\\xi)\\right) - f(x)}{h} = f'(x) + \\frac{h}{2} f''(\\xi)$$\nThe truncation error is therefore:\n$$D(h) - f'(x) = \\frac{h}{2} f''(\\xi)$$\nThe magnitude of the truncation error is bounded by:\n$$E_{trunc}(h) = |D(h) - f'(x)| = \\left|\\frac{h}{2} f''(\\xi)\\right| = \\frac{h}{2} |f''(\\xi)|$$\nSince $f''$ is continuous, for small $h$, the value of $f''(\\xi)$ approaches $f''(x)$. Thus, a standard leading-order upper bound for the truncation error is:\n$$E_{trunc}(h) \\le \\frac{h}{2} |f''(x)|$$\n\nNext, we analyze the round-off error, $E_{round}(h)$. The computed value of the derivative, $\\widehat{D}(h)$, is based on the computed values of the function, $\\widehat{f}(x)$ and $\\widehat{f}(x+h)$. According to the problem's model:\n$$\\widehat{f}(x) = f(x)(1+\\delta_1) \\quad \\text{with } |\\delta_1| \\le u$$\n$$\\widehat{f}(x+h) = f(x+h)(1+\\delta_2) \\quad \\text{with } |\\delta_2| \\le u$$\nThe computed difference quotient is $\\widehat{D}(h) = \\frac{\\widehat{f}(x+h) - \\widehat{f}(x)}{h}$. For this analysis, we neglect the additional round-off errors introduced by the subtraction and division, as the error from the function evaluations is typically dominant.\nThe round-off error is:\n$$E_{round}(h) = |\\widehat{D}(h) - D(h)| = \\left|\\frac{f(x+h)(1+\\delta_2) - f(x)(1+\\delta_1)}{h} - \\frac{f(x+h) - f(x)}{h}\\right|$$\n$$E_{round}(h) = \\left|\\frac{f(x+h)\\delta_2 - f(x)\\delta_1}{h}\\right|$$\nUsing the triangle inequality for the numerator:\n$$E_{round}(h) \\le \\frac{|f(x+h)\\delta_2| + |f(x)\\delta_1|}{h} \\le \\frac{|f(x+h)||\\delta_2| + |f(x)||\\delta_1|}{h}$$\nUsing the bound $|\\delta_i| \\le u$:\n$$E_{round}(h) \\le \\frac{u (|f(x+h)| + |f(x)|)}{h}$$\nSince $f$ is continuous, for small $h$, $f(x+h) \\approx f(x)$. Therefore, we can approximate the bound by replacing $|f(x+h)|$ with $|f(x)|$:\n$$E_{round}(h) \\le \\frac{2u|f(x)|}{h}$$\nThis approximation is justified as it captures the catastrophic cancellation effect when subtracting two nearly equal numbers, $f(x+h)$ and $f(x)$, which amplifies the initial round-off errors by a factor proportional to $\\frac{1}{h}$.\n\nWe now have an upper bound for the total error, which we denote as $E(h)$:\n$$E(h) = E_{trunc}(h) + E_{round}(h) \\approx \\frac{h}{2}|f''(x)| + \\frac{2u|f(x)|}{h}$$\nTo find the step size $h$ that minimizes this error bound, we differentiate $E(h)$ with respect to $h$ and set the result to zero.\n$$\\frac{dE}{dh} = \\frac{d}{dh}\\left(\\frac{h}{2}|f''(x)| + \\frac{2u|f(x)|}{h}\\right) = \\frac{1}{2}|f''(x)| - \\frac{2u|f(x)|}{h^2}$$\nSetting $\\frac{dE}{dh} = 0$:\n$$\\frac{1}{2}|f''(x)| = \\frac{2u|f(x)|}{h^2}$$\nSolving for $h^2$:\n$$h^2 = \\frac{4u|f(x)|}{|f''(x)|}$$\nSince $h>0$, we take the positive square root:\n$$h = \\sqrt{\\frac{4u|f(x)|}{|f''(x)|}} = 2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}}$$\nTo confirm this is a minimum, we check the second derivative:\n$$\\frac{d^2E}{dh^2} = \\frac{d}{dh}\\left(\\frac{1}{2}|f''(x)| - 2u|f(x)|h^{-2}\\right) = -2u|f(x)|(-2h^{-3}) = \\frac{4u|f(x)|}{h^3}$$\nGiven that $u>0$, $|f(x)|>0$, and $h>0$, the second derivative $\\frac{d^2E}{dh^2}$ is always positive. This confirms that the value of $h$ found corresponds to a minimum of the error bound function $E(h)$. This optimal step size represents the point where the decreasing truncation error and the increasing round-off error are balanced.", "answer": "$$ \\boxed{2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}}} $$", "id": "3222056"}]}