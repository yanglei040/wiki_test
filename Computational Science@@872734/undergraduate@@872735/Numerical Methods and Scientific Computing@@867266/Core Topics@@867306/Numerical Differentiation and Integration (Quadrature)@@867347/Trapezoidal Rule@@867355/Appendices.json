{"hands_on_practices": [{"introduction": "Many fundamental concepts in science and engineering, such as work, total charge, or accumulated change, are defined by definite integrals. This first exercise provides a direct application of the trapezoidal rule to a classic physics problem: calculating the work done to compress a gas. By approximating the area under a force-displacement curve, you will practice the core mechanics of the trapezoidal rule and see how it translates a physical principle into a concrete numerical value [@problem_id:2222091].", "problem": "In a materials science experiment, a piston is used to compress a gas in a cylinder. The process is carried out slowly, so it can be considered quasi-static and isothermal. The force $F$ required to hold the piston at a position $x$ (measured from the closed end of the cylinder) is found to vary according to the law $F(x) = \\frac{k}{x}$, where $k$ is a constant related to the temperature and the amount of gas.\n\nTo move the piston and compress the gas, work must be done. The exact work $W$ done by an external agent to move the piston from an initial position $x_i$ to a final position $x_f$ is given by the integral $W = \\int_{x_i}^{x_f} F(x) dx$.\n\nSuppose the piston is moved from $x_i = 1$ m to $x_f = 3$ m, and the constant $k$ is equal to 1 N路m. You are tasked with finding an approximate value for the work done. The approximation method consists of the following steps:\n1. Divide the total displacement interval $[x_i, x_f]$ into two subintervals of equal length.\n2. For each subinterval, approximate the area under the force-displacement curve by the area of a trapezoid formed by the x-axis, the vertical lines at the subinterval's endpoints, and the straight line segment connecting the force values at these endpoints.\n3. Sum the areas of these two trapezoids to get the total approximate work.\n\nUsing this method, calculate the approximate work done to move the piston. Express your answer in Joules as a simplified fraction.", "solution": "The problem asks for an approximation of the work done, $W$, by moving a piston against a force $F(x) = \\frac{k}{x}$ from $x_i = 1$ m to $x_f = 3$ m. We are given $k = 1$ N路m. The work is given by the integral:\n$$W = \\int_{1}^{3} \\frac{1}{x} dx$$\n\nThe problem describes a numerical approximation method which is equivalent to the composite trapezoidal rule with two segments. Let the interval be $[a, b] = [1, 3]$ and the number of segments be $n=2$. The function to integrate is $f(x) = \\frac{1}{x}$.\n\nFirst, we calculate the width, $h$, of each subinterval:\n$$h = \\frac{b - a}{n} = \\frac{3 - 1}{2} = 1$$\n\nThe two subintervals are $[1, 2]$ and $[2, 3]$. The evaluation points (the endpoints of the subintervals) are $x_0 = 1$, $x_1 = 2$, and $x_2 = 3$.\n\nThe approximation method described is to sum the areas of two trapezoids.\nThe area of the first trapezoid, over the interval $[x_0, x_1]$, is:\n$$A_1 = \\frac{h}{2} (f(x_0) + f(x_1))$$\nThe area of the second trapezoid, over the interval $[x_1, x_2]$, is:\n$$A_2 = \\frac{h}{2} (f(x_1) + f(x_2))$$\n\nThe total approximate work $W_{approx}$ is the sum of these two areas:\n$$W_{approx} = A_1 + A_2 = \\frac{h}{2}(f(x_0) + f(x_1)) + \\frac{h}{2}(f(x_1) + f(x_2))$$\nThis can be simplified to the standard composite trapezoidal rule formula:\n$$W_{approx} = \\frac{h}{2} (f(x_0) + 2f(x_1) + f(x_2))$$\n\nNow we evaluate the function $f(x) = \\frac{1}{x}$ at the points $x_0, x_1, x_2$:\n$$f(x_0) = f(1) = \\frac{1}{1} = 1$$\n$$f(x_1) = f(2) = \\frac{1}{2}$$\n$$f(x_2) = f(3) = \\frac{1}{3}$$\n\nNow, we substitute these values into the formula for $W_{approx}$. We also substitute $h=1$.\n$$W_{approx} = \\frac{1}{2} \\left( 1 + 2\\left(\\frac{1}{2}\\right) + \\frac{1}{3} \\right)$$\n\nWe simplify the expression inside the parentheses:\n$$W_{approx} = \\frac{1}{2} \\left( 1 + 1 + \\frac{1}{3} \\right)$$\n$$W_{approx} = \\frac{1}{2} \\left( 2 + \\frac{1}{3} \\right)$$\n\nTo add the terms inside the parentheses, we find a common denominator:\n$$W_{approx} = \\frac{1}{2} \\left( \\frac{6}{3} + \\frac{1}{3} \\right)$$\n$$W_{approx} = \\frac{1}{2} \\left( \\frac{7}{3} \\right)$$\n\nFinally, we perform the multiplication:\n$$W_{approx} = \\frac{7}{6}$$\n\nThe problem states that $k$ is in N路m and $x$ is in m, so the work $W$ is in Joules. The problem asks for the answer in Joules, expressed as a simplified fraction. Our result is $7/6$.", "answer": "$$\\boxed{\\frac{7}{6}}$$", "id": "2222091"}, {"introduction": "An approximation is only as good as our knowledge of its accuracy. In practical applications, from designing safe drug dosages to engineering stable structures, we must be able to guarantee that our numerical results are within an acceptable error tolerance. This problem [@problem_id:2210520] moves beyond simple calculation and into the critical domain of error analysis, challenging you to use the trapezoidal rule's error bound to determine how many steps are required to achieve a desired level of precision.", "problem": "In a pharmacokinetic study, the concentration of a new drug in a patient's bloodstream is modeled as a function of time, $t$, by the equation $C(t) = C_0 \\exp(-kt^2)$. Here, $t$ is the time in hours after injection, $C_0 = 50$ mg/L is the initial concentration, and $k = 0.5 \\text{ hr}^{-2}$ is a constant related to the drug's elimination rate.\n\nTo assess the total drug exposure over the first two hours, a biomedical engineer needs to calculate the Area Under the Curve (AUC), which is given by the definite integral $A = \\int_{0}^{T} C(t) dt$ with $T=2$ hours.\n\nThe engineer uses a numerical approximation method. The time interval $[0, T]$ is divided into $n$ equal subintervals, and the value of the integral is approximated by summing the areas of the trapezoids formed by connecting the points $(t_i, C(t_i))$ and $(t_{i+1}, C(t_{i+1}))$ for each subinterval.\n\nFor this specific numerical method, the absolute error, $|E_n|$, is known to be bounded by the inequality:\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\nwhere $M$ is the maximum absolute value of the second derivative of the concentration function, $M = \\max_{t \\in [0, T]} |C''(t)|$.\n\nDetermine the minimum integer number of subintervals, $n$, that the engineer must use to guarantee that the absolute error in the calculated AUC is less than $10^{-3}$ mg路hr/L.", "solution": "We are given $C(t) = C_{0}\\exp(-k t^{2})$ with $C_{0} = 50$ and $k = 0.5$, and the trapezoidal rule error bound\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\nFirst compute $C''(t)$. Differentiating,\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\nThus\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left| -1 + 2k t^{2} \\right|.$$\n\nLet $t_{0} = \\frac{1}{\\sqrt{2k}}$. For $t \\in [0,t_{0}]$, we have $-1 + 2k t^{2} \\le 0$, so\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(1 - 2k t^{2}\\right).$$\nDefine $h_{1}(t) = 2k C_{0}\\exp(-k t^{2})(1 - 2k t^{2})$. Its derivative is\n$$h_{1}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(-3 + 2k t^{2}\\right).$$\nOn $(0,t_{0}]$, since $t_{0}^{2} = \\frac{1}{2k}$, we have $-3 + 2k t^{2} \\le -3 + 1 = -2 < 0$, hence $h_{1}'(t) < 0$. Therefore $h_{1}$ is decreasing on $[0,t_{0}]$ and attains its maximum at $t=0$:\n$$h_{1}(0) = 2k C_{0}.$$\n\nFor $t \\in [t_{0},T]$, we have $-1 + 2k t^{2} \\ge 0$, so\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\nDefine $h_{2}(t) = 2k C_{0}\\exp(-k t^{2})(-1 + 2k t^{2})$. Its derivative is\n$$h_{2}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(3 - 2k t^{2}\\right).$$\nCritical points in $[t_{0},T]$ occur at $t = \\sqrt{\\frac{3}{2k}}$ if this lies in the interval. With $k = 0.5$, we have $t_{0} = 1$, $T=2$, and $\\sqrt{\\frac{3}{2k}} = \\sqrt{3} \\in [1,2]$. Evaluate $h_{2}$ at candidates:\n- At $t = t_{0}$, $h_{2}(t_{0}) = 0$.\n- At $t = \\sqrt{\\frac{3}{2k}}$, since $2k t^{2} = 3$,\n$$h_{2}\\!\\left(\\sqrt{\\frac{3}{2k}}\\right) = 2k C_{0} \\cdot 2 \\cdot \\exp\\!\\left(-\\frac{3}{2}\\right) = 4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right).$$\n- At $t = T=2$,\n$$h_{2}(2) = 2k C_{0}\\left(-1 + 8k\\right)\\exp(-4k).$$\n\nCompare these to $2k C_{0}$. Note that\n$$4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right) = 2k C_{0}\\cdot 2\\exp\\!\\left(-\\frac{3}{2}\\right) < 2k C_{0}$$\nbecause $\\exp\\!\\left(\\frac{3}{2}\\right) > 2$, hence $2\\exp(-\\frac{3}{2}) < 1$. Also $h_{2}(2)$ is smaller than $2k C_{0}$ for $k=0.5$. Therefore the maximum over $[0,2]$ is attained at $t=0$:\n$$M = \\max_{t \\in [0,2]} |C''(t)| = 2k C_{0} = 2 \\cdot 0.5 \\cdot 50 = 50.$$\n\nApply the error bound with $T=2$:\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{100}{3 n^{2}}.$$\nRequire $|E_{n}| < 10^{-3}$:\n$$\\frac{100}{3 n^{2}} < 10^{-3} \\quad \\Longleftrightarrow \\quad n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3}.$$\nThus $n > \\sqrt{\\frac{100000}{3}}$. Since $182^{2} = 33124 < \\frac{100000}{3} < 33489 = 183^{2}$, the minimal integer $n$ satisfying the inequality is\n$$n = 183.$$", "answer": "$$\\boxed{183}$$", "id": "2210520"}, {"introduction": "It is a common misconception that higher-order numerical methods are universally superior to lower-order ones. This advanced problem challenges that intuition, asking you to design a specific function where the simple trapezoidal rule is actually more accurate than the seemingly more powerful Simpson's rule. Successfully solving this puzzle [@problem_id:3284359] requires a deeper understanding of how quadrature rules are built from polynomial interpolation and how they interact with the specific characteristics of the function being integrated.", "problem": "Consider numerical integration of a smooth function over the interval $[0,1]$ using a fixed budget of $9$ function evaluations at uniformly spaced nodes $x_j = j/8$ for $j = 0,1,\\dots,8$. For this node set, one may construct composite quadrature rules by interpolating $f(x)$ locally with polynomials and integrating those interpolants to approximate the definite integral $\\int_{0}^{1} f(x)\\,dx$. Two widely used such rules are based on linear interpolation (composite trapezoidal rule) and quadratic interpolation (composite Simpson's rule), both on a uniform grid. \n\nStarting strictly from these core definitions of numerical quadrature (interpolatory formulas constructed on uniform nodes) and without invoking any pre-stated error constants or closed-form error formulas, design a specific, continuously differentiable function $f(x)$ on $[0,1]$ such that, when both rules use the same $9$ function evaluations at the nodes $\\{x_j\\}_{j=0}^{8}$, the composite trapezoidal rule yields an approximation to $\\int_{0}^{1} f(x)\\,dx$ that is more accurate than the composite Simpson's rule. \n\nYour answer must be an explicit analytic expression for $f(x)$, and you must demonstrate in your reasoning why, for this $f(x)$ and the specified nodes, the composite trapezoidal rule is strictly closer to the true integral than the composite Simpson's rule. No rounding is required, and no units are involved; provide exact values in your reasoning.", "solution": "The objective is to find a continuously differentiable function $f(x)$ on $[0,1]$ such that the composite trapezoidal rule yields a more accurate approximation of $I = \\int_0^1 f(x) dx$ than the composite Simpson's rule, given a uniform grid of $9$ points. The grid spacing is $h = (1-0)/8 = 1/8$, with nodes $x_j = j/8$ for $j \\in \\{0, 1, \\dots, 8\\}$.\n\nWe must show that $|I - T| < |I - S|$. The path to a solution without using pre-stated error formulas is to propose a suitable candidate function and then explicitly compute the true integral $I$ and the two approximations $T$ and $S$ to verify the inequality.\n\nA key insight is that the accuracy of these rules is tied to how well their underlying polynomial interpolants capture the behavior of the function. Simpson's rule uses piecewise quadratic interpolants over panels of width $2h$, while the trapezoidal rule uses piecewise linear interpolants over panels of width $h$. A function whose behavior is poorly captured by quadratic interpolation at the given node spacing, but well-approximated by linear interpolation, is a promising candidate. Highly oscillatory functions can exhibit such properties.\n\nLet us propose the function $f(x) = \\cos(8\\pi x)$. This function is continuously differentiable (in fact, $C^\\infty$) on $[0,1]$.\n\nFirst, we evaluate the function at the specified nodes $x_j = j/8$:\n$$f(x_j) = f\\left(\\frac{j}{8}\\right) = \\cos\\left(8\\pi \\frac{j}{8}\\right) = \\cos(j\\pi) = (-1)^j$$\nThe sequence of function values $\\{f_j\\}_{j=0}^8$ is:\n$$f_0=1, f_1=-1, f_2=1, f_3=-1, f_4=1, f_5=-1, f_6=1, f_7=-1, f_8=1$$\n\nNext, we calculate the exact value of the integral, $I$:\n$$I = \\int_{0}^{1} \\cos(8\\pi x) \\,dx = \\left[ \\frac{\\sin(8\\pi x)}{8\\pi} \\right]_{0}^{1} = \\frac{\\sin(8\\pi) - \\sin(0)}{8\\pi} = \\frac{0-0}{8\\pi} = 0$$\n\nNow, we compute the approximation using the composite trapezoidal rule. The rule is defined as:\n$$T = h \\left( \\frac{1}{2}f_0 + \\sum_{j=1}^{N-1} f_j + \\frac{1}{2}f_N \\right)$$\nWith $N=8$, $h=1/8$, and our nodal values:\n$$T = \\frac{1}{8} \\left( \\frac{1}{2}f_0 + f_1 + f_2 + f_3 + f_4 + f_5 + f_6 + f_7 + \\frac{1}{2}f_8 \\right)$$\n$$T = \\frac{1}{8} \\left( \\frac{1}{2}(1) + (-1) + 1 + (-1) + 1 + (-1) + 1 + (-1) + \\frac{1}{2}(1) \\right)$$\nThe sum of the interior terms is $\\sum_{j=1}^{7} f_j = -1+1-1+1-1+1-1 = -1$.\nSubstituting this into the formula for $T$:\n$$T = \\frac{1}{8} \\left( \\frac{1}{2} + (-1) + \\frac{1}{2} \\right) = \\frac{1}{8}(0) = 0$$\n\nNext, we compute the approximation using the composite Simpson's rule. For $N=8$ subintervals (an even number), the rule is:\n$$S = \\frac{h}{3} \\left( f_0 + 4f_1 + 2f_2 + 4f_3 + 2f_4 + 4f_5 + 2f_6 + 4f_7 + f_8 \\right)$$\nUsing our nodal values:\n$$S = \\frac{1/8}{3} \\left( 1 + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( 1 - 4 + 2 - 4 + 2 - 4 + 2 - 4 + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( (1+2+2+2+1) + (4 \\times (-4)) \\right) = \\frac{1}{24} (8 - 16) = \\frac{-8}{24} = -\\frac{1}{3}$$\n\nFinally, we compare the absolute errors.\nThe absolute error for the trapezoidal rule is:\n$$|E_T| = |I - T| = |0 - 0| = 0$$\nThe absolute error for Simpson's rule is:\n$$|E_S| = |I - S| = \\left|0 - \\left(-\\frac{1}{3}\\right)\\right| = \\frac{1}{3}$$\nComparing the two absolute errors, we find:\n$$0 < \\frac{1}{3}$$\nThus, $|E_T| < |E_S|$.\n\nThe function $f(x)=\\cos(8\\pi x)$ is continuously differentiable and, for the given nodes, the composite trapezoidal rule is perfectly accurate while the composite Simpson's rule yields a substantial error. This demonstrates that the trapezoidal rule is more accurate than Simpson's rule in this specific case, satisfying all conditions of the problem. This occurs because the frequency of the function is precisely the Nyquist frequency of the grid, $1/(2h)$. The trapezoidal rule is exact because the error term on each subinterval, $\\int_{x_j}^{x_{j+1}} (f(x) - L_j(x))dx$, happens to be zero due to the symmetry of the cosine function within each subinterval. Simpson's rule, however, is designed for polynomials and is severely misled by the oscillatory nature of the function relative to its three-point sampling panels, leading to a large error.", "answer": "$$\\boxed{\\cos(8\\pi x)}$$", "id": "3284359"}]}