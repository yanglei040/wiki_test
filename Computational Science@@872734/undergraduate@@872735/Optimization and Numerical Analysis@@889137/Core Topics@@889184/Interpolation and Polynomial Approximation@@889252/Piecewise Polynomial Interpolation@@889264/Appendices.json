{"hands_on_practices": [{"introduction": "The defining characteristic of a spline is not just that it's made of polynomial pieces, but that these pieces connect smoothly at the 'knots' where they meet. This smoothness is mathematically defined by continuity conditions on the function and its derivatives. This first practice problem provides a direct application of this principle, asking you to enforce the necessary conditions to form a continuous and smooth quadratic spline [@problem_id:2193847].", "problem": "A composite function $S(x)$ is defined on the interval $[0, 2]$ by joining two polynomial pieces. The first piece is given by the function $p_1(x) = x^2$ for $x$ in the interval $[0, 1]$. The second piece is given by the function $p_2(x) = -x^2 + 4x + c$ for $x$ in the interval $[1, 2]$, where $c$ is a real constant. Determine the specific value of $c$ that makes the composite function $S(x)$ a quadratic spline over its domain $[0, 2]$.", "solution": "A quadratic spline on an interval with a single interior knot must satisfy two conditions: on each subinterval it is a polynomial of degree at most two, and at the knot it has continuity of the function value and of the first derivative (i.e., it is in $C^{1}$).\n\nThe given pieces are $p_{1}(x) = x^{2}$ on $[0,1]$ and $p_{2}(x) = -x^{2} + 4x + c$ on $[1,2]$, which are already quadratics. To ensure $C^{1}$ at the knot $x=1$, we impose:\n1) Function continuity: $p_{1}(1) = p_{2}(1)$.\n2) First-derivative continuity: $p_{1}'(1) = p_{2}'(1)$.\n\nCompute the derivatives:\n$$\np_{1}'(x) = 2x, \\qquad p_{2}'(x) = -2x + 4.\n$$\nEvaluate at $x=1$:\n$$\np_{1}'(1) = 2, \\qquad p_{2}'(1) = -2 \\cdot 1 + 4 = 2,\n$$\nso the first-derivative continuity holds automatically for any $c$.\n\nEnforce function continuity at $x=1$:\n$$\np_{1}(1) = 1^{2} = 1, \\qquad p_{2}(1) = -1^{2} + 4 \\cdot 1 + c = -1 + 4 + c = 3 + c.\n$$\nSet these equal:\n$$\n1 = 3 + c \\;\\;\\Longrightarrow\\;\\; c = -2.\n$$\nThus, $c = -2$ makes $S(x)$ a quadratic spline on $[0,2]$.", "answer": "$$\\boxed{-2}$$", "id": "2193847"}, {"introduction": "Constructing a cubic spline involves solving for a set of unknown parameters that guarantee its defining properties across all data points. For the widely used natural cubic spline, this process elegantly boils down to solving a system of linear equations for the second derivatives at each knot. This exercise guides you through the crucial first step of this procedure: setting up the specific matrix equation for a given set of data [@problem_id:2193878].", "problem": "In computational modeling, a cubic spline is a powerful tool for interpolating a set of data points with a smooth curve. A function $s(x)$ is a cubic spline that interpolates the $n+1$ data points $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$ if it is a piecewise cubic polynomial that passes through all the points and has continuous first and second derivatives at the interior points $x_1, \\dots, x_{n-1}$.\n\nLet $M_i = s''(x_i)$ be the second derivative of the spline at the point $x_i$, and let $h_i = x_{i+1} - x_i$ be the spacing between consecutive points. The values of $M_i$ for the interior points ($i=1, \\dots, n-1$) are related by the following system of linear equations:\n$$ \\frac{h_{i-1}}{6} M_{i-1} + \\frac{h_{i-1} + h_i}{3} M_i + \\frac{h_i}{6} M_{i+1} = \\frac{y_{i+1} - y_i}{h_i} - \\frac{y_i - y_{i-1}}{h_{i-1}} $$\nA \"natural\" cubic spline is defined by the additional boundary conditions $M_0 = 0$ and $M_n = 0$. These conditions physically correspond to the ends of a flexible beam being free from bending moments.\n\nConsider the task of finding a natural cubic spline that interpolates the following four data points: $(0, 1)$, $(1, 3)$, $(3, 2)$, and $(4, 4)$. The conditions give rise to a system of linear equations for the unknown internal second derivatives, $M_1$ and $M_2$. This system can be written in matrix form as $A \\mathbf{M} = \\mathbf{b}$, where $\\mathbf{M} = \\begin{pmatrix} M_1 \\\\ M_2 \\end{pmatrix}$, $A$ is a $2 \\times 2$ coefficient matrix, and $\\mathbf{b}$ is a $2 \\times 1$ constant vector.\n\nDetermine the numerical values for the entries of the matrix $A = \\begin{pmatrix} a_{11} & a_{12} \\\\ a_{21} & a_{22} \\end{pmatrix}$ and the vector $\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$. Present your final answer as a single row matrix containing the six values in the order $(a_{11}, a_{12}, a_{21}, a_{22}, b_1, b_2)$. Express all values as exact fractions or integers.", "solution": "We are given the cubic spline tridiagonal relation for interior points:\n$$\\frac{h_{i-1}}{6}M_{i-1}+\\frac{h_{i-1}+h_{i}}{3}M_{i}+\\frac{h_{i}}{6}M_{i+1}=\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}},$$\nwith natural boundary conditions $M_{0}=0$ and $M_{3}=0$ for the points $(x_{0},y_{0})=(0,1)$, $(x_{1},y_{1})=(1,3)$, $(x_{2},y_{2})=(3,2)$, $(x_{3},y_{3})=(4,4)$.\n\nFirst compute the spacings:\n$$h_{0}=x_{1}-x_{0}=1,\\quad h_{1}=x_{2}-x_{1}=2,\\quad h_{2}=x_{3}-x_{2}=1.$$\n\nFor $i=1$:\n$$\\frac{h_{0}}{6}M_{0}+\\frac{h_{0}+h_{1}}{3}M_{1}+\\frac{h_{1}}{6}M_{2}=\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}.$$\nSubstitute values:\n$$\\frac{1}{6}M_{0}+\\frac{1+2}{3}M_{1}+\\frac{2}{6}M_{2}=\\frac{2-3}{2}-\\frac{3-1}{1},$$\n$$0+1\\cdot M_{1}+\\frac{1}{3}M_{2}=-\\frac{1}{2}-2=-\\frac{5}{2}.$$\nThus the first row is $a_{11}=1$, $a_{12}=\\frac{1}{3}$ and $b_{1}=-\\frac{5}{2}$.\n\nFor $i=2$:\n$$\\frac{h_{1}}{6}M_{1}+\\frac{h_{1}+h_{2}}{3}M_{2}+\\frac{h_{2}}{6}M_{3}=\\frac{y_{3}-y_{2}}{h_{2}}-\\frac{y_{2}-y_{1}}{h_{1}}.$$\nSubstitute values:\n$$\\frac{2}{6}M_{1}+\\frac{2+1}{3}M_{2}+\\frac{1}{6}M_{3}=\\frac{4-2}{1}-\\frac{2-3}{2},$$\n$$\\frac{1}{3}M_{1}+1\\cdot M_{2}+0=2-(-\\frac{1}{2})=\\frac{5}{2}.$$\nThus the second row is $a_{21}=\\frac{1}{3}$, $a_{22}=1$ and $b_{2}=\\frac{5}{2}$.\n\nTherefore,\n$$A=\\begin{pmatrix}1 & \\frac{1}{3} \\\\[4pt] \\frac{1}{3} & 1\\end{pmatrix},\\quad \\mathbf{b}=\\begin{pmatrix}-\\frac{5}{2} \\\\[4pt] \\frac{5}{2}\\end{pmatrix},$$\nso the requested single row matrix is $\\begin{pmatrix}1 & \\frac{1}{3} & \\frac{1}{3} & 1 & -\\frac{5}{2} & \\frac{5}{2}\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix}1 & \\frac{1}{3} & \\frac{1}{3} & 1 & -\\frac{5}{2} & \\frac{5}{2}\\end{pmatrix}}$$", "id": "2193878"}, {"introduction": "While the smoothness of cubic splines is often desirable, it can sometimes lead to unphysical results, especially when modeling data with sharp changes or shocks. The requirement for a continuous second derivative can force the interpolant to 'overshoot' or 'undershoot' the data, creating oscillations that are not present in the underlying phenomenon. This final practice challenges you to quantify such an artifact in a realistic engineering scenario, underscoring the importance of critically evaluating whether an interpolation method is appropriate for the problem at hand [@problem_id:2193885].", "problem": "An engineer is modeling the temperature of a critical component in a new device. The temperature is measured over a short period. At time $t=2.0$ seconds, a powerful cooling system is activated, causing a rapid drop in temperature. The recorded data points $(t_i, T_i)$ are given as follows, where $t$ is time in seconds and $T$ is temperature in degrees Celsius:\n$(t_0, T_0) = (0.0, 100.0)$\n$(t_1, T_1) = (1.0, 101.0)$\n$(t_2, T_2) = (2.0, 102.0)$\n$(t_3, T_3) = (3.0, 50.0)$\n$(t_4, T_4) = (4.0, 48.0)$\n\nTwo models are proposed to interpolate these data points: a piecewise linear interpolant, $L(t)$, and a natural cubic spline, $S(t)$. A natural cubic spline is one for which the second derivative is zero at the endpoints of the entire interpolation interval.\n\nWhile the piecewise linear model shows the temperature monotonically decreasing in the interval $[3.0, 4.0]$ s, the natural cubic spline's enforcement of smoothness ($C^2$ continuity) across the sharp temperature drop can introduce unphysical artifacts. One such artifact is a non-monotonic behavior, sometimes called \"overshoot\" or \"undershoot.\"\n\nYour task is to quantify this effect. Determine the minimum temperature predicted by the natural cubic spline, $S(t)$, within the time interval $[3.0, 4.0]$ s. Express your answer for the minimum temperature in degrees Celsius, rounded to four significant figures.", "solution": "We are given data points $(t_{i},T_{i})$ at $t_{0}=0$, $t_{1}=1$, $t_{2}=2$, $t_{3}=3$, $t_{4}=4$ with $T_{0}=100$, $T_{1}=101$, $T_{2}=102$, $T_{3}=50$, $T_{4}=48$. For a natural cubic spline $S(t)$ with uniform spacing $h_{i}=t_{i+1}-t_{i}=1$, the second derivatives $M_{i}=S''(t_{i})$ satisfy the tridiagonal system for $i=1,2,3$:\n$$\nM_{i-1}+4M_{i}+M_{i+1}=6\\left(T_{i+1}-2T_{i}+T_{i-1}\\right),\n$$\nwith $M_{0}=0$ and $M_{4}=0$. Computing the right-hand sides:\n- For $i=1$: $T_{2}-2T_{1}+T_{0}=102-202+100=0$, so $M_{0}+4M_{1}+M_{2}=0$ gives $4M_{1}+M_{2}=0$.\n- For $i=2$: $T_{3}-2T_{2}+T_{1}=50-204+101=-53$, so $M_{1}+4M_{2}+M_{3}=-318$.\n- For $i=3$: $T_{4}-2T_{3}+T_{2}=48-100+102=50$, so $M_{2}+4M_{3}+M_{4}=300$ gives $M_{2}+4M_{3}=300$.\n\nSolving these with $M_{0}=0$, $M_{4}=0$:\nFrom $4M_{1}+M_{2}=0$ we have $M_{2}=-4M_{1}$. Substitute into $M_{1}+4M_{2}+M_{3}=-318$ to get $-15M_{1}+M_{3}=-318$. From $M_{2}+4M_{3}=300$ with $M_{2}=-4M_{1}$ we get $-4M_{1}+4M_{3}=300$, so $M_{3}=75+M_{1}$. Substituting into $-15M_{1}+M_{3}=-318$ gives $-14M_{1}+75=-318$, hence $M_{1}=393/14$, and then $M_{2}=-786/7$, $M_{3}=1443/14$.\n\nOn the interval $[t_{3},t_{4}]=[3,4]$, define $x=t-3\\in[0,1]$. The cubic spline piece is\n$$\nS(t)=\\frac{M_{3}(1-x)^{3}}{6}+\\frac{M_{4}x^{3}}{6}+\\left(T_{3}-\\frac{M_{3}}{6}\\right)(1-x)+\\left(T_{4}-\\frac{M_{4}}{6}\\right)x.\n$$\nWith $M_{4}=0$, $T_{3}=50$, $T_{4}=48$, and $A=M_{3}/6=481/28$, this becomes\n$$\nS(x)=A(1-3x+3x^{2}-x^{3})+(50-A)(1-x)+48x.\n$$\nExpanding and collecting terms yields\n$$\nS(x)=50+\\left(-\\frac{509}{14}\\right)x+\\left(\\frac{1443}{28}\\right)x^{2}-\\left(\\frac{481}{28}\\right)x^{3}.\n$$\nDifferentiate to find critical points:\n$$\nS'(x)=-\\frac{509}{14}+\\frac{1443}{14}x-\\frac{1443}{28}x^{2}=\\frac{-1018+2886x-1443x^{2}}{28}.\n$$\nSetting $S'(x)=0$ gives\n$$\n1443x^{2}-2886x+1018=0.\n$$\nThe roots are\n$$\nx=1\\pm\\frac{5\\sqrt{24531}}{1443},\n$$\nand the one in $(0,1)$ is\n$$\nx_{c}=1-\\frac{5\\sqrt{24531}}{1443}.\n$$\nSince $S''(x)=\\frac{1443}{14}(1-x)>0$ on $(0,1)$, $x_{c}$ gives a local minimum on $[3,4]$. To evaluate $S$ at $x_{c}$ efficiently, use the relation $S'(x_{c})=0$ to eliminate $x^{3}$:\n$$\nS(x)=50+\\frac{2}{3}\\left(-\\frac{509}{14}\\right)x+\\frac{1}{3}\\left(\\frac{1443}{28}\\right)x^{2}=50-\\frac{509}{21}x+\\frac{481}{28}x^{2}.\n$$\nFrom the quadratic condition, $1443x^{2}=2886x-1018$, so\n$$\n\\frac{481}{28}x^{2}=\\frac{2886x-1018}{84}.\n$$\nTherefore,\n$$\nS_{\\min}=50-\\frac{509}{21}x+\\frac{2886x-1018}{84}=50-\\frac{509}{42}+\\frac{425}{42}x.\n$$\nWith $x=x_{c}=1-\\frac{5\\sqrt{24531}}{1443}$ this becomes\n$$\nS_{\\min}=50-\\frac{509}{42}+\\frac{425}{42}\\left(1-\\frac{5\\sqrt{24531}}{1443}\\right)=\\frac{2016}{42}-\\frac{2125}{42\\cdot 1443}\\sqrt{24531}.\n$$\nSince $2016/42=48$ and $42\\cdot 1443=60606$, we obtain the exact expression\n$$\nS_{\\min}=48-\\frac{2125}{60606}\\sqrt{24531}.\n$$\nFor a numerical value, compute $\\sqrt{24531}\\approx 156.623753$, giving\n$$\nS_{\\min}\\approx 48-\\left(\\frac{2125}{60606}\\right)\\times 156.623753\\approx 48-5.491625831\\approx 42.50837417.\n$$\nRounded to four significant figures, the minimum temperature predicted by the natural cubic spline on $[3.0,4.0]$ s is $42.51$.", "answer": "$$\\boxed{42.51}$$", "id": "2193885"}]}