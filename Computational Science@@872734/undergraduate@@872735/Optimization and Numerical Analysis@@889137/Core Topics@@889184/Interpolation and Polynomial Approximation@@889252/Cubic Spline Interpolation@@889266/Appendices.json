{"hands_on_practices": [{"introduction": "The fundamental step in constructing a cubic spline is determining the unknown second derivatives at each data point, or \"knot.\" These values are found by solving a system of linear equations that enforce smoothness across the segments. This first exercise provides a simple three-point scenario, which reduces the system to a single equation and allows you to focus on the core principle of a natural cubic spline without extensive algebraic complexity. [@problem_id:2164958]", "problem": "A function $S(x)$ is a natural cubic spline that interpolates a set of data points. By definition, a cubic spline is a piecewise function composed of cubic polynomials, and it is continuous along with its first and second derivatives. A \"natural\" cubic spline has the additional property that its second derivative is zero at the two endpoints of the interval of interpolation.\n\nConsider a natural cubic spline $S(x)$ that passes through the following three data points: $(x_0, y_0) = (0, 0)$, $(x_1, y_1) = (1, 1)$, and $(x_2, y_2) = (2, 0)$.\n\nCalculate the value of the second derivative of the spline at $x=1$, which is denoted by $S''(1)$.", "solution": "Let $x_{0}=0$, $x_{1}=1$, $x_{2}=2$ with $y_{0}=0$, $y_{1}=1$, $y_{2}=0$. For a natural cubic spline, the second derivatives at the knots $M_{i}=S''(x_{i})$ satisfy $M_{0}=0$ and $M_{2}=0$, and the interior equations are\n$$\nh_{i-1}M_{i-1}+2(h_{i-1}+h_{i})M_{i}+h_{i}M_{i+1}\n=6\\left(\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}}\\right),\n$$\nfor $i=1,\\ldots,n-1$, where $h_{i}=x_{i+1}-x_{i}$. Here $h_{0}=x_{1}-x_{0}=1$ and $h_{1}=x_{2}-x_{1}=1$, and there is a single interior equation at $i=1$:\n$$\n1\\cdot M_{0}+2(1+1)M_{1}+1\\cdot M_{2}\n=6\\left(\\frac{y_{2}-y_{1}}{1}-\\frac{y_{1}-y_{0}}{1}\\right).\n$$\nSubstituting $M_{0}=0$, $M_{2}=0$, $y_{2}-y_{1}=0-1=-1$, and $y_{1}-y_{0}=1-0=1$ gives\n$$\n4M_{1}=6(-1-1)=6(-2)=-12,\n$$\nhence\n$$\nM_{1}=-3.\n$$\nTherefore $S''(1)=M_{1}=-3$.", "answer": "$$\\boxed{-3}$$", "id": "2164958"}, {"introduction": "After calculating the second derivatives, the next step is to construct the full polynomial segments and use them for interpolation. This practice guides you through that process for a simple, symmetric set of points, and you will use the derived spline to estimate the function's value between knots. By comparing the result from the smooth natural cubic spline with that of a simpler piecewise linear model, you can gain an intuitive feel for how and why splines provide a more refined approximation of a curve. [@problem_id:2164998]", "problem": "An engineer is modeling the shape of a thin, flexible rod that is constrained to pass through three points in a 2D Cartesian plane: $P_0=(-1, 1)$, $P_1=(0, 0)$, and $P_2=(1, 1)$. Two simple models are proposed to estimate the rod's vertical position, $y$, at other horizontal locations, $x$.\n\nModel A is a piecewise linear interpolant, which connects the specified points with straight line segments.\nModel B is a natural cubic spline, which ensures the curve is smooth by matching first and second derivatives at the interior points, and has zero second derivatives at the endpoints.\n\nCalculate the vertical position of the rod at $x=0.5$ as predicted by both Model A and Model B. Let these values be $y_A$ and $y_B$, respectively. Present your answer as a pair of exact fractions $(y_A, y_B)$.", "solution": "We label the nodes as $x_{0}=-1$, $x_{1}=0$, $x_{2}=1$ with corresponding values $y_{0}=1$, $y_{1}=0$, $y_{2}=1$.\n\nModel A (piecewise linear interpolant): For $x \\in [x_{1},x_{2}]$, the line through $(0,0)$ and $(1,1)$ has slope\n$$\nm=\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}=\\frac{1-0}{1-0}=1,\n$$\nso the interpolant is\n$$\ny(x)=y_{1}+m(x-x_{1})=0+1\\cdot(x-0)=x.\n$$\nEvaluating at $x=\\frac{1}{2}$ gives\n$$\ny_{A}=y\\!\\left(\\frac{1}{2}\\right)=\\frac{1}{2}.\n$$\n\nModel B (natural cubic spline): Let $M_{i}=S''(x_{i})$. Natural end conditions give $M_{0}=0$ and $M_{2}=0$. With $h_{0}=x_{1}-x_{0}=1$ and $h_{1}=x_{2}-x_{1}=1$, the cubic spline system at the interior node $i=1$ is\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right).\n$$\nSubstituting the values,\n$$\n1\\cdot 0+2(1+1)M_{1}+1\\cdot 0=6\\left(\\frac{1-0}{1}-\\frac{0-1}{1}\\right)=6(1-(-1))=12,\n$$\nso\n$$\n4M_{1}=12 \\quad \\Rightarrow \\quad M_{1}=3.\n$$\nOn the interval $[x_{1},x_{2}]=[0,1]$, the spline is\n$$\nS(x)=\\frac{M_{1}}{6h_{1}}(x_{2}-x)^{3}+\\frac{M_{2}}{6h_{1}}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\nWith $h_{1}=1$, $M_{1}=3$, $M_{2}=0$, $y_{1}=0$, and $y_{2}=1$, this simplifies to\n$$\nS(x)=\\frac{3}{6}(1-x)^{3}+0+\\left(0-\\frac{3}{6}\\right)(1-x)+\\left(1-0\\right)x\n=\\frac{1}{2}(1-x)^{3}-\\frac{1}{2}(1-x)+x.\n$$\nExpanding and combining like terms,\n$$\nS(x)=\\frac{1}{2}-\\frac{3}{2}x+\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}-\\frac{1}{2}+\\frac{1}{2}x+x\n=\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}.\n$$\nEvaluating at $x=\\frac{1}{2}$ gives\n$$\ny_{B}=S\\!\\left(\\frac{1}{2}\\right)=\\frac{3}{2}\\left(\\frac{1}{2}\\right)^{2}-\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{3}\n=\\frac{3}{2}\\cdot\\frac{1}{4}-\\frac{1}{2}\\cdot\\frac{1}{8}\n=\\frac{3}{8}-\\frac{1}{16}\n=\\frac{5}{16}.\n$$\n\nThus, the required pair is $\\left(\\frac{1}{2},\\frac{5}{16}\\right)$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2}  \\frac{5}{16}\\end{pmatrix}}$$", "id": "2164998"}, {"introduction": "The precise definition of a cubic spline, particularly its continuity requirements up to the second derivative ($C^2$ continuity), is what guarantees its characteristic smoothness. To solidify this concept, this problem challenges you to build a piecewise function that meets all conditions *except* for $C^2$ continuity. By analyzing this \"non-spline,\" you can better appreciate why each part of the definition is essential for creating a truly smooth interpolant. [@problem_id:2165003]", "problem": "A piecewise function $S(x)$ is defined over the interval $[-1, 1]$ by two cubic polynomials, with a knot at $x=0$:\n$$\nS(x) = \\begin{cases}\nP_1(x) = a_1 x^3 + b_1 x^2 + c_1 x + d_1  \\text{if } -1 \\le x \\le 0 \\\\\nP_2(x) = x^2  \\text{if } 0  x \\le 1\n\\end{cases}\n$$\nThe function $S(x)$ is constructed to satisfy the following set of conditions:\n1.  The function interpolates the point $(-1, 1)$.\n2.  The function and its first derivative are continuous across the entire interval $[-1, 1]$. This implies that $S(x)$ and $S'(x)$ must be continuous at the knot $x=0$.\n3.  The derivative of the function at the left endpoint is zero, i.e., $S'(-1)=0$.\n\nThese conditions uniquely determine the coefficients of the polynomial $P_1(x)$. Find the value of the coefficient $a_1$.", "solution": "We have $S(x)=P_{1}(x)$ on $[-1,0]$ and $S(x)=P_{2}(x)=x^{2}$ on $(0,1]$, with $P_{1}(x)=a_{1}x^{3}+b_{1}x^{2}+c_{1}x+d_{1}$. The conditions are:\n- Interpolation at $(-1,1)$: $P_{1}(-1)=1$.\n- Continuity at $x=0$: $P_{1}(0)=P_{2}(0)$.\n- First-derivative continuity at $x=0$: $P_{1}'(0)=P_{2}'(0)$.\n- Endpoint derivative: $S'(-1)=0$, so $P_{1}'(-1)=0$.\n\nCompute derivatives: $P_{1}'(x)=3a_{1}x^{2}+2b_{1}x+c_{1}$ and $P_{2}'(x)=2x$.\n\nContinuity at $x=0$ gives $P_{1}(0)=d_{1}=P_{2}(0)=0$, hence $d_{1}=0$.\nFirst-derivative continuity at $x=0$ gives $P_{1}'(0)=c_{1}=P_{2}'(0)=0$, hence $c_{1}=0$.\nThe endpoint derivative condition $P_{1}'(-1)=0$ yields\n$$\n3a_{1}(-1)^{2}+2b_{1}(-1)+c_{1}=0 \\;\\;\\Longrightarrow\\;\\; 3a_{1}-2b_{1}+0=0 \\;\\;\\Longrightarrow\\;\\; b_{1}=\\frac{3}{2}a_{1}.\n$$\nThe interpolation condition $P_{1}(-1)=1$ gives\n$$\na_{1}(-1)^{3}+b_{1}(-1)^{2}+c_{1}(-1)+d_{1}=1 \\;\\;\\Longrightarrow\\;\\; -a_{1}+b_{1}-0+0=1.\n$$\nSubstituting $b_{1}=\\frac{3}{2}a_{1}$,\n$$\n-a_{1}+\\frac{3}{2}a_{1}=1 \\;\\;\\Longrightarrow\\;\\; \\frac{1}{2}a_{1}=1 \\;\\;\\Longrightarrow\\;\\; a_{1}=2.\n$$\nThus the uniquely determined coefficient is $a_{1}=2$.", "answer": "$$\\boxed{2}$$", "id": "2165003"}]}