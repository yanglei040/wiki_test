{"hands_on_practices": [{"introduction": "The first step toward understanding ill-conditioned systems is learning how to quantify the problem. The condition number, $\\kappa(A)$, serves as this crucial diagnostic tool. This exercise provides fundamental practice in calculating the condition number for a simple but illustrative ill-conditioned matrix using three different standard norms, highlighting how this value captures the matrix's sensitivity regardless of the specific norm used [@problem_id:2203804].", "problem": "In numerical linear algebra, the condition number of a matrix measures how sensitive the solution of a linear system is to small changes in the input data. A system with a high condition number is called ill-conditioned. Consider the $2 \\times 2$ matrix $A$ given by:\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix}\n$$\nThe condition number, $\\kappa(A)$, depends on the choice of matrix norm. For a non-singular matrix $A$, the condition number with respect to a norm $\\| \\cdot \\|$ is defined as $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$.\n\nYou are to calculate the condition number of matrix $A$ using three different standard matrix norms, defined as follows for an $m \\times n$ matrix $A = (a_{ij})$:\n1.  The $1$-norm (or maximum absolute column sum norm): $\\|A\\|_1 = \\max_{1 \\le j \\le n} \\sum_{i=1}^{m} |a_{ij}|$.\n2.  The $\\infty$-norm (or maximum absolute row sum norm): $\\|A\\|_\\infty = \\max_{1 \\le i \\le m} \\sum_{j=1}^{n} |a_{ij}|$.\n3.  The $2$-norm (or spectral norm): $\\|A\\|_2 = \\sqrt{\\lambda_{\\max}(A^T A)}$, where $A^T$ is the transpose of $A$, and $\\lambda_{\\max}(A^T A)$ is the largest eigenvalue of the matrix $A^T A$.\n\nCalculate the condition numbers $\\kappa_1(A)$, $\\kappa_\\infty(A)$, and $\\kappa_2(A)$. Present your three results for $\\kappa_1(A)$, $\\kappa_\\infty(A)$, and $\\kappa_2(A)$, in that order, as a row of numbers. All numerical values must be rounded to five significant figures.", "solution": "The problem asks for the calculation of the condition numbers $\\kappa_1(A)$, $\\kappa_\\infty(A)$, and $\\kappa_2(A)$ for the given matrix $A$. The definition of the condition number is $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$.\n\nFirst, we need to find the inverse of the matrix $A$.\nThe given matrix is $A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix}$.\nThe determinant of $A$ is $\\det(A) = (1)(1.001) - (1)(1) = 1.001 - 1 = 0.001$.\nThe inverse of a general $2 \\times 2$ matrix $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ is $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$.\nSo, the inverse of $A$ is:\n$$\nA^{-1} = \\frac{1}{0.001} \\begin{pmatrix} 1.001 & -1 \\\\ -1 & 1 \\end{pmatrix} = 1000 \\begin{pmatrix} 1.001 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1001 & -1000 \\\\ -1000 & 1000 \\end{pmatrix}\n$$\n\nNow we calculate the required norms for both $A$ and $A^{-1}$.\n\n**Step 1: Calculation of $\\kappa_1(A)$**\nThe $1$-norm is the maximum absolute column sum.\nFor matrix $A$:\nThe sum of absolute values of the first column is $|1| + |1| = 2$.\nThe sum of absolute values of the second column is $|1| + |1.001| = 2.001$.\nSo, $\\|A\\|_1 = \\max(2, 2.001) = 2.001$.\nFor matrix $A^{-1}$:\nThe sum of absolute values of the first column is $|1001| + |-1000| = 1001 + 1000 = 2001$.\nThe sum of absolute values of the second column is $|-1000| + |1000| = 1000 + 1000 = 2000$.\nSo, $\\|A^{-1}\\|_1 = \\max(2001, 2000) = 2001$.\nThe condition number in the $1$-norm is:\n$$\n\\kappa_1(A) = \\|A\\|_1 \\|A^{-1}\\|_1 = 2.001 \\times 2001 = 4004.001\n$$\n\n**Step 2: Calculation of $\\kappa_\\infty(A)$**\nThe $\\infty$-norm is the maximum absolute row sum.\nFor matrix $A$:\nThe sum of absolute values of the first row is $|1| + |1| = 2$.\nThe sum of absolute values of the second row is $|1| + |1.001| = 2.001$.\nSo, $\\|A\\|_\\infty = \\max(2, 2.001) = 2.001$.\nFor matrix $A^{-1}$:\nThe sum of absolute values of the first row is $|1001| + |-1000| = 1001 + 1000 = 2001$.\nThe sum of absolute values of the second row is $|-1000| + |1000| = 1000 + 1000 = 2000$.\nSo, $\\|A^{-1}\\|_\\infty = \\max(2001, 2000) = 2001$.\nThe condition number in the $\\infty$-norm is:\n$$\n\\kappa_\\infty(A) = \\|A\\|_\\infty \\|A^{-1}\\|_\\infty = 2.001 \\times 2001 = 4004.001\n$$\n\n**Step 3: Calculation of $\\kappa_2(A)$**\nThe $2$-norm condition number is defined as $\\kappa_2(A) = \\sqrt{\\frac{\\lambda_{\\max}(A^T A)}{\\lambda_{\\min}(A^T A)}}$, where $\\lambda_{\\max}$ and $\\lambda_{\\min}$ are the largest and smallest eigenvalues of $A^T A$.\nFirst, we compute the matrix $A^T A$:\n$$\nA^T A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.001 \\end{pmatrix} = \\begin{pmatrix} 2 & 2.001 \\\\ 2.001 & 2.002001 \\end{pmatrix}\n$$\nNext, we find the eigenvalues of $A^T A$ by solving the characteristic equation $\\det(A^T A - \\lambda I) = 0$:\n$$\n(2-\\lambda)(2.002001-\\lambda) - (2.001)^2 = 0\n$$\n$$\n\\lambda^2 - 4.002001\\lambda + 4.004002 - 4.004001 = 0\n$$\n$$\n\\lambda^2 - 4.002001\\lambda + 0.000001 = 0\n$$\nTo find the ratio $\\lambda_{\\max}/\\lambda_{\\min}$ in a numerically stable way, we can use the coefficients of this quadratic equation. For a quadratic $\\lambda^2 - T\\lambda + D = 0$, where $T$ is the trace and $D$ is the determinant of the matrix, the condition number squared is given by $\\kappa_2(A)^2 = \\lambda_{\\max}/\\lambda_{\\min}$. A stable formula for the condition number, derived from the quadratic roots, is:\n$$\n\\kappa_2(A) = \\frac{T + \\sqrt{T^2-4D}}{2\\sqrt{D}}\n$$\nHere, $T = 4.002001$ and $D = 0.000001$.\n$$\n\\kappa_2(A) = \\frac{4.002001 + \\sqrt{(4.002001)^2 - 4(0.000001)}}{2\\sqrt{0.000001}} = \\frac{4.002001 + \\sqrt{16.016008004001}}{0.002}\n$$\n$$\n\\kappa_2(A) = \\frac{4.002001 + 4.00200050025}{0.002} = \\frac{8.00400150025}{0.002} = 4002.000750125\n$$\n\n**Step 4: Final Results and Rounding**\nThe calculated values are:\n$\\kappa_1(A) = 4004.001$\n$\\kappa_\\infty(A) = 4004.001$\n$\\kappa_2(A) = 4002.000750125$\n\nRounding to five significant figures:\n$\\kappa_1(A) \\approx 4004.0$\n$\\kappa_\\infty(A) \\approx 4004.0$\n$\\kappa_2(A) \\approx 4002.0$\n\nThe final answer should be presented as a row of these three numbers.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4004.0 & 4004.0 & 4002.0\n\\end{pmatrix}\n}\n$$", "id": "2203804"}, {"introduction": "Knowing that a matrix has a high condition number is one thing; seeing the practical consequences is another. This exercise provides a stark and concrete demonstration of error amplification, the hallmark of ill-conditioned systems. By solving a system and then re-solving it with a minuscule perturbation to the input vector, you will witness firsthand how a seemingly insignificant error can lead to a dramatically different and incorrect solution [@problem_id:2203824].", "problem": "Consider the linear system of equations $Ax = b$, where the matrix $A$ and the vector $b$ are given by:\n$$\nA = \\begin{pmatrix} 1000 & 999 \\\\ 999 & 998 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nThis system has an exact solution with integer components, which we will denote as $x_{exact}$.\n\nNow, suppose that due to a small measurement or data entry error, the right-hand side vector is slightly perturbed to a new vector $b_{pert}$:\n$$\nb_{pert} = \\begin{pmatrix} 1.001 \\\\ 1 \\end{pmatrix}\n$$\nThis gives rise to a new linear system $A x_{pert} = b_{pert}$, with a new solution $x_{pert}$.\n\nThe purpose of this problem is to investigate the effect of this small perturbation on the solution. Using the infinity norm, defined for a vector $v = (v_1, v_2, \\dots, v_n)^T$ as $\\|v\\|_{\\infty} = \\max_i |v_i|$, calculate the relative error in the solution. The relative error is defined as the ratio $\\frac{\\|x_{pert} - x_{exact}\\|_{\\infty}}{\\|x_{exact}\\|_{\\infty}}$.\n\nCalculate the value of this relative error. Round your final answer to three significant figures.", "solution": "We solve both linear systems exactly using the inverse of the matrix. For a general $2 \\times 2$ matrix $A = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$, the determinant is $\\det(A) = ad - bc$, and the inverse is $A^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$, provided $\\det(A) \\neq 0$.\n\nHere,\n$$\nA = \\begin{pmatrix} 1000 & 999 \\\\ 999 & 998 \\end{pmatrix}, \\quad \\det(A) = 1000 \\cdot 998 - 999 \\cdot 999 = 998000 - 998001 = -1,\n$$\nso\n$$\nA^{-1} = \\frac{1}{-1} \\begin{pmatrix} 998 & -999 \\\\ -999 & 1000 \\end{pmatrix} = \\begin{pmatrix} -998 & 999 \\\\ 999 & -1000 \\end{pmatrix}.\n$$\n\nThe exact solution is\n$$\nx_{exact} = A^{-1} b = \\begin{pmatrix} -998 & 999 \\\\ 999 & -1000 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -998 + 999 \\\\ 999 - 1000 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\nThus,\n$$\n\\|x_{exact}\\|_{\\infty} = \\max\\{ |1|, |-1| \\} = 1.\n$$\n\nFor the perturbed right-hand side $b_{pert} = \\begin{pmatrix} 1.001 \\\\ 1 \\end{pmatrix}$, write $1.001 = \\frac{1001}{1000}$. Then\n$$\nx_{pert} = A^{-1} b_{pert} = \\begin{pmatrix} -998 & 999 \\\\ 999 & -1000 \\end{pmatrix} \\begin{pmatrix} \\frac{1001}{1000} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -998 \\cdot \\frac{1001}{1000} + 999 \\\\ 999 \\cdot \\frac{1001}{1000} - 1000 \\end{pmatrix}.\n$$\nCompute each component exactly:\n$$\nx_{pert,1} = -\\frac{998 \\cdot 1001}{1000} + 999 = -\\frac{998998}{1000} + \\frac{999000}{1000} = \\frac{2}{1000} = \\frac{1}{500},\n$$\n$$\nx_{pert,2} = \\frac{999 \\cdot 1001}{1000} - 1000 = \\frac{999999}{1000} - \\frac{1000000}{1000} = -\\frac{1}{1000}.\n$$\nThus,\n$$\nx_{pert} = \\begin{pmatrix} \\frac{1}{500} \\\\ -\\frac{1}{1000} \\end{pmatrix}.\n$$\n\nThe difference is\n$$\nx_{pert} - x_{exact} = \\begin{pmatrix} \\frac{1}{500} - 1 \\\\ -\\frac{1}{1000} - (-1) \\end{pmatrix} = \\begin{pmatrix} -\\frac{499}{500} \\\\ \\frac{999}{1000} \\end{pmatrix}.\n$$\nHence the infinity norm of the difference is\n$$\n\\|x_{pert} - x_{exact}\\|_{\\infty} = \\max\\left\\{ \\left|\\!-\\frac{499}{500}\\right|, \\left|\\frac{999}{1000}\\right| \\right\\} = \\frac{999}{1000} = 0.999.\n$$\n\nThe relative error is therefore\n$$\n\\frac{\\|x_{pert} - x_{exact}\\|_{\\infty}}{\\|x_{exact}\\|_{\\infty}} = \\frac{0.999}{1} = 0.999,\n$$\nwhich to three significant figures is $0.999$.", "answer": "$$\\boxed{0.999}$$", "id": "2203824"}, {"introduction": "Once an ill-conditioned system is identified, we are not helpless. Instead of seeking an exact but unstable solution, we can use regularization techniques to find a stable and meaningful approximation. This practice introduces one of the most powerful methods for this purpose: truncated Singular Value Decomposition (SVD). You will follow a step-by-step procedure to filter out the components associated with vanishingly small singular values, which are the source of instability, to compute a robust regularized solution [@problem_id:2203817].", "problem": "In the field of data analysis, solving the linear system of equations $Ax=b$ can be problematic if the matrix $A$ is ill-conditioned. This means that small errors in the measurement vector $b$ can lead to large, physically meaningless errors in the solution vector $x$. To overcome this, a regularization procedure is often employed to find a stable approximate solution.\n\nConsider such a system where the Singular Value Decomposition (SVD) of the matrix $A$ is given by $A = U \\Sigma V^T$. The components of the decomposition and the measurement vector $b$ are provided as follows:\n$$ U = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 & -2 \\\\ 2 & 1 \\end{pmatrix}, \\quad \\Sigma = \\begin{pmatrix} \\sqrt{50} & 0 \\\\ 0 & 10^{-5} \\end{pmatrix}, \\quad V = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1 & -3 \\\\ 3 & 1 \\end{pmatrix} $$\n$$ b = \\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix} $$\nA regularized solution, denoted $x_{\\text{reg}}$, is computed using the following three-step procedure:\n1.  First, transform the measurement vector $b$ into a new basis defined by $U$ by computing $b' = U^T b$. Let the components of $b'$ be $b'_1$ and $b'_2$.\n2.  Next, construct a filtered vector $w = \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix}$. The components of $w$ are determined by the rule: $w_i = \\frac{b'_i}{\\sigma_i}$ if the corresponding singular value $\\sigma_i$ is greater than a threshold $\\tau = 10^{-3}$. If $\\sigma_i$ is not greater than $\\tau$, then $w_i = 0$. The singular values $\\sigma_i$ are the diagonal entries of the matrix $\\Sigma$.\n3.  Finally, transform the filtered vector $w$ back to the original basis to find the regularized solution using the relation $x_{\\text{reg}} = Vw$.\n\nCalculate the regularized solution vector $x_{\\text{reg}}$. Express your final answer as a 2x1 column vector, with its numerical entries rounded to three significant figures.", "solution": "We are given the SVD components $U$, $\\Sigma$, $V$ and the vector $b$, and we follow the prescribed three-step regularization procedure.\n\nStep 1: Compute $b' = U^{T} b$. With\n$$\nU^{T} = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 & 2 \\\\ -2 & 1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix},\n$$\nwe obtain\n$$\nb' = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 & 2 \\\\ -2 & 1 \\end{pmatrix}\\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 5\\sqrt{5} \\\\ -10\\sqrt{5} \\end{pmatrix}\n= \\begin{pmatrix} 5 \\\\ -10 \\end{pmatrix}.\n$$\nThus $b'_{1} = 5$ and $b'_{2} = -10$.\n\nStep 2: Construct $w$ with the thresholding rule using singular values $\\sigma_{1} = \\sqrt{50} = 5\\sqrt{2}$ and $\\sigma_{2} = 10^{-5}$, and threshold $\\tau = 10^{-3}$. Since $\\sigma_{1} > \\tau$, we set\n$$\nw_{1} = \\frac{b'_{1}}{\\sigma_{1}} = \\frac{5}{\\sqrt{50}} = \\frac{5}{5\\sqrt{2}} = \\frac{1}{\\sqrt{2}}.\n$$\nSince $\\sigma_{2} \\leq \\tau$, we set $w_{2} = 0$. Therefore\n$$\nw = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n\nStep 3: Compute $x_{\\text{reg}} = V w$. With\n$$\nV = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1 & -3 \\\\ 3 & 1 \\end{pmatrix},\n$$\nwe obtain\n$$\nx_{\\text{reg}} = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1 & -3 \\\\ 3 & 1 \\end{pmatrix}\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{10}}\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{3}{\\sqrt{2}} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1}{\\sqrt{20}} \\\\ \\frac{3}{\\sqrt{20}} \\end{pmatrix}.\n$$\nNumerically, using $\\sqrt{20} = 2\\sqrt{5}$, this yields\n$$\nx_{\\text{reg}} \\approx \\begin{pmatrix} 0.2236067978 \\\\ 0.6708203933 \\end{pmatrix}.\n$$\nRounding each entry to three significant figures gives\n$$\nx_{\\text{reg}} \\approx \\begin{pmatrix} 0.224 \\\\ 0.671 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.224 \\\\ 0.671\\end{pmatrix}}$$", "id": "2203817"}]}