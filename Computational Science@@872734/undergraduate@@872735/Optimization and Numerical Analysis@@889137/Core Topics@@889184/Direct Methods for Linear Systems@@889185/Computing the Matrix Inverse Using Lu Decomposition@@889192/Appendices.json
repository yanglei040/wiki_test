{"hands_on_practices": [{"introduction": "To begin, we will tackle the core process of matrix inversion using LU decomposition from start to finish. This practice [@problem_id:2161050] reinforces the fundamental principle that if a matrix $A$ can be factored into $A=LU$, its inverse can be found by computing $A^{-1} = U^{-1}L^{-1}$. By working through this small-scale example, you will gain hands-on experience with the complete mechanical workflow, from factorization to the final matrix multiplication.", "problem": "In many numerical applications, such as solving systems of linear equations or in optimization algorithms, computing the inverse of a matrix is a fundamental operation. One robust method for this task is to first decompose the matrix into a product of a lower triangular matrix and an upper triangular matrix.\n\nConsider the matrix $A$ given by:\n$$\nA = \\begin{pmatrix} 4 & 3 \\\\ 6 & 2 \\end{pmatrix}\n$$\nYour task is to compute the inverse of this matrix, $A^{-1}$, by first finding the Lower-Upper (LU) decomposition of $A$. Present your final answer as a 2x2 matrix with its elements expressed as exact fractions.", "solution": "We first verify that $A$ is invertible by computing its determinant. Using $\\det\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix} = ad - bc$, we have\n$$\n\\det(A) = 4\\cdot 2 - 3\\cdot 6 = 8 - 18 = -10 \\neq 0,\n$$\nso $A$ is invertible.\n\nTo compute $A^{-1}$ via LU decomposition, we write $A = LU$ with $L$ lower triangular with unit diagonal and $U$ upper triangular. For\n$$\nA = \\begin{pmatrix} 4 & 3 \\\\ 6 & 2 \\end{pmatrix},\\quad L = \\begin{pmatrix} 1 & 0 \\\\ \\ell_{21} & 1 \\end{pmatrix},\\quad U = \\begin{pmatrix} u_{11} & u_{12} \\\\ 0 & u_{22} \\end{pmatrix},\n$$\nthe Doolittle relations give:\n- $u_{11} = a_{11} = 4$,\n- $u_{12} = a_{12} = 3$,\n- $\\ell_{21} = \\dfrac{a_{21}}{u_{11}} = \\dfrac{6}{4} = \\dfrac{3}{2}$,\n- $u_{22} = a_{22} - \\ell_{21}u_{12} = 2 - \\dfrac{3}{2}\\cdot 3 = 2 - \\dfrac{9}{2} = -\\dfrac{5}{2}$.\n\nThus,\n$$\nL = \\begin{pmatrix} 1 & 0 \\\\ \\frac{3}{2} & 1 \\end{pmatrix},\\quad U = \\begin{pmatrix} 4 & 3 \\\\ 0 & -\\frac{5}{2} \\end{pmatrix}.\n$$\n\nSince $A = LU$, we have $A^{-1} = U^{-1}L^{-1}$. We compute $L^{-1}$ and $U^{-1}$ by solving triangular systems.\n\nFor $L^{-1}$, solve $LZ = I$ with $L$ unit lower triangular. By direct calculation,\n$$\nL^{-1} = \\begin{pmatrix} 1 & 0 \\\\ -\\frac{3}{2} & 1 \\end{pmatrix}.\n$$\n\nFor $U^{-1}$, solve $UY = I$ with $U$ upper triangular. Let $Y = \\begin{pmatrix} y_{11} & y_{12} \\\\ y_{21} & y_{22} \\end{pmatrix}$. From\n$$\n\\begin{pmatrix} 4 & 3 \\\\ 0 & -\\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} y_{11} & y_{12} \\\\ y_{21} & y_{22} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix},\n$$\nthe lower row gives $-\\dfrac{5}{2}y_{21} = 0$ and $-\\dfrac{5}{2}y_{22} = 1$, hence $y_{21} = 0$ and $y_{22} = -\\dfrac{2}{5}$. The upper row gives $4y_{11} + 3y_{21} = 1$ and $4y_{12} + 3y_{22} = 0$, hence $y_{11} = \\dfrac{1}{4}$ and $y_{12} = \\dfrac{3}{10}$. Therefore,\n$$\nU^{-1} = \\begin{pmatrix} \\frac{1}{4} & \\frac{3}{10} \\\\ 0 & -\\frac{2}{5} \\end{pmatrix}.\n$$\n\nFinally, multiply to obtain $A^{-1} = U^{-1}L^{-1}$:\n$$\nA^{-1} = \\begin{pmatrix} \\frac{1}{4} & \\frac{3}{10} \\\\ 0 & -\\frac{2}{5} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ -\\frac{3}{2} & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} - \\frac{9}{20} & \\frac{3}{10} \\\\ \\frac{3}{5} & -\\frac{2}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{5} & \\frac{3}{10} \\\\ \\frac{3}{5} & -\\frac{2}{5} \\end{pmatrix}.\n$$\n\nThis matches the result obtained by the adjugate formula, confirming correctness.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{5} & \\frac{3}{10} \\\\ \\frac{3}{5} & -\\frac{2}{5}\\end{pmatrix}}$$", "id": "2161050"}, {"introduction": "In practice, computing the full inverse of a large matrix is often inefficient and unnecessary. This exercise [@problem_id:2160990] demonstrates a far more common application: finding a single column of the inverse by solving a system of linear equations. You will see how a pre-computed LU factorization transforms the problem $Ax = e_j$ into two simple triangular systems, highlighting the computational advantage of this method.", "problem": "An invertible $3 \\times 3$ matrix $A$ has a known Lower-Upper (LU) decomposition, $A = LU$, where the matrices $L$ (unit lower triangular) and $U$ (upper triangular) are given by:\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & 1 & 3 \\\\ 0 & -1 & 1 \\\\ 0 & 0 & 4 \\end{pmatrix}\n$$\nDetermine the third column of the inverse matrix $A^{-1}$. Your answer should be presented as a column vector.", "solution": "To find the third column of $A^{-1}$, solve $A x = e_{3}$, where $e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$. Using the LU factorization $A = L U$, we solve in two stages: first $L z = e_{3}$ (forward substitution), then $U x = z$ (back substitution).\n\nLet $z = \\begin{pmatrix} z_{1} \\\\ z_{2} \\\\ z_{3} \\end{pmatrix}$. From\n$$\nL z = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix} \\begin{pmatrix} z_{1} \\\\ z_{2} \\\\ z_{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\n$$\nthe equations are\n$$\nz_{1} = 0,\\quad 2 z_{1} + z_{2} = 0 \\implies z_{2} = 0,\\quad -z_{1} + 3 z_{2} + z_{3} = 1 \\implies z_{3} = 1.\n$$\nThus $z = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$.\n\nNow solve $U x = z$ with $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}$:\n$$\nU x = \\begin{pmatrix} 2 & 1 & 3 \\\\ 0 & -1 & 1 \\\\ 0 & 0 & 4 \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nBack substitution gives\n$$\n4 x_{3} = 1 \\implies x_{3} = \\frac{1}{4},\\quad -x_{2} + x_{3} = 0 \\implies x_{2} = \\frac{1}{4},\\quad 2 x_{1} + x_{2} + 3 x_{3} = 0 \\implies 2 x_{1} + 1 = 0 \\implies x_{1} = -\\frac{1}{2}.\n$$\nTherefore, the third column of $A^{-1}$ is\n$$\n\\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\\\ \\frac{1}{4} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2}\\\\\\frac{1}{4}\\\\\\frac{1}{4}\\end{pmatrix}}$$", "id": "2160990"}, {"introduction": "Our previous methods work well for well-behaved matrices, but real-world problems demand numerical stability, which is often achieved through pivoting. This final practice [@problem_id:2161048] introduces the permutation matrix $P$ into the factorization, giving $PA=LU$. You will learn how to adapt the two-stage solving process to correctly handle this permutation, mastering the robust technique used in high-performance numerical libraries.", "problem": "In many large-scale scientific computing applications, calculating the full inverse of a matrix $A$ is computationally expensive and unnecessary. Often, only specific columns of the inverse $A^{-1}$ are required. The LU decomposition with partial pivoting provides an efficient method to find these columns by solving systems of linear equations.\n\nConsider a non-singular 3x3 matrix $A$, which has been factorized into the form $PA = LU$, where $P$ is a permutation matrix, $L$ is a unit lower triangular matrix, and $U$ is an upper triangular matrix. The specific matrices for this factorization are given as:\n\n$$\nP = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix}, \\quad\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad\nU = \\begin{pmatrix} 2 & -1 & 4 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\n\nYour task is to determine the third column vector of the inverse matrix, $A^{-1}$. Present your answer as a 3x1 column vector.", "solution": "We seek the third column of $A^{-1}$, which is the unique solution $x$ of $A x = e_{3}$, where $e_{3} = (0,0,1)^{T}$.\n\nGiven the LU factorization with partial pivoting $PA = LU$, to solve $A x = b$ we use $PA x = P b$, hence $LU x = P b$. We then solve successively:\n1) $L y = P b$ by forward substitution,\n2) $U x = y$ by back substitution.\n\nHere, $b = e_{3}$, so first compute $P e_{3}$. Since the third column of\n$$\nP = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix}\n$$\nis $\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$, we have\n$$\nP e_{3} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n\nSolve $L y = P e_{3}$ with\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad y = \\begin{pmatrix} y_{1} \\\\ y_{2} \\\\ y_{3} \\end{pmatrix}.\n$$\nThe system is\n$$\n\\begin{cases}\ny_{1} = 0, \\\\\n2 y_{1} + y_{2} = 1, \\\\\n- y_{1} + 3 y_{2} + y_{3} = 0.\n\\end{cases}\n$$\nFrom the first equation $y_{1} = 0$, then $y_{2} = 1$, and finally $y_{3} = -3$. Thus\n$$\ny = \\begin{pmatrix} 0 \\\\ 1 \\\\ -3 \\end{pmatrix}.\n$$\n\nNext solve $U x = y$ with\n$$\nU = \\begin{pmatrix} 2 & -1 & 4 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}.\n$$\nBack substitution gives\n$$\n-2 x_{3} = -3 \\;\\Rightarrow\\; x_{3} = \\frac{3}{2},\n$$\n$$\n3 x_{2} + x_{3} = 1 \\;\\Rightarrow\\; 3 x_{2} + \\frac{3}{2} = 1 \\;\\Rightarrow\\; x_{2} = -\\frac{1}{6},\n$$\n$$\n2 x_{1} - x_{2} + 4 x_{3} = 0 \\;\\Rightarrow\\; 2 x_{1} + \\frac{1}{6} + 6 = 0 \\;\\Rightarrow\\; 2 x_{1} + \\frac{37}{6} = 0 \\;\\Rightarrow\\; x_{1} = -\\frac{37}{12}.\n$$\n\nTherefore, the third column of $A^{-1}$ is\n$$\n\\begin{pmatrix} -\\frac{37}{12} \\\\ -\\frac{1}{6} \\\\ \\frac{3}{2} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{37}{12}\\\\-\\frac{1}{6}\\\\\\frac{3}{2}\\end{pmatrix}}$$", "id": "2161048"}]}