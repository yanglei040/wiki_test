{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we'll start with the fundamental action of partial pivoting. The strategy's core principle is to select the best possible pivot element at each stage of Gaussian elimination. This first practice focuses on correctly identifying and executing the very first row swap required, which is the cornerstone of maintaining numerical stability throughout the process. [@problem_id:2193012]", "problem": "In numerical linear algebra, strategies are employed to improve the stability of algorithms like Gaussian elimination. Consider the system of linear equations represented by the matrix equation $A\\mathbf{x} = \\mathbf{b}$, where the coefficient matrix $A$ is given by:\n\n$$\nA = \\begin{pmatrix}\n3.1 & -1.5 & 4.2 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n-7.8 & 3.4 & 1.1\n\\end{pmatrix}\n$$\n\nTo start solving this system using Gaussian elimination with a partial pivoting strategy, a specific row interchange must be performed first to ensure the pivot element has the largest possible magnitude. Which of the following describes the first operation required by this strategy?\n\nA. Interchange Row 1 and Row 2.\n\nB. Interchange Row 1 and Row 3.\n\nC. Interchange Row 2 and Row 3.\n\nD. No row interchange is required in the first step.\n\nE. The strategy cannot be applied as the matrix is singular.", "solution": "The problem asks for the first step of Gaussian elimination with a partial pivoting strategy for the given $3 \\times 3$ matrix $A$.\n\nThe matrix is:\n$$\nA = \\begin{pmatrix}\n3.1 & -1.5 & 4.2 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n-7.8 & 3.4 & 1.1\n\\end{pmatrix}\n$$\n\nThe partial pivoting strategy for the first column (step $k=1$) involves identifying the row that contains the element with the largest absolute value in the first column. This element will be the pivot for the first stage of elimination.\n\nLet's denote the elements of the matrix as $a_{ij}$, where $i$ is the row index and $j$ is the column index. We need to examine the elements in the first column: $a_{11}$, $a_{21}$, and $a_{31}$.\n\nThe elements are:\n$a_{11} = 3.1$\n$a_{21} = -2.5$\n$a_{31} = -7.8$\n\nNext, we calculate the absolute value of each of these elements:\n$|a_{11}| = |3.1| = 3.1$\n$|a_{21}| = |-2.5| = 2.5$\n$|a_{31}| = |-7.8| = 7.8$\n\nWe now find the maximum of these absolute values:\n$\\max(|a_{11}|, |a_{21}|, |a_{31}|) = \\max(3.1, 2.5, 7.8) = 7.8$.\n\nThis maximum absolute value corresponds to the element $a_{31}$, which is in the third row.\n\nAccording to the partial pivoting procedure, the row containing the pivot element (the element with the largest absolute value in the current column) must be swapped with the current pivot row. For the first step, the current pivot row is Row 1. Since the largest magnitude element is in Row 3, we must interchange Row 1 and Row 3.\n\nAfter the interchange, the matrix will look like this:\n$$\nA' = \\begin{pmatrix}\n-7.8 & 3.4 & 1.1 \\\\\n-2.5 & 8.9 & -0.7 \\\\\n3.1 & -1.5 & 4.2\n\\end{pmatrix}\n$$\nThe new pivot element is $a'_{11} = -7.8$, which has a larger magnitude than the other original elements in the first column.\n\nTherefore, the first operation required is to interchange Row 1 and Row 3. This corresponds to option B. Option E is incorrect as the pivoting strategy can be applied regardless of singularity (though a singular matrix will lead to a zero pivot at some stage), and the operation is well-defined.", "answer": "$$\\boxed{B}$$", "id": "2193012"}, {"introduction": "Now that we've seen *how* to pivot, let's explore *why* it's so critical. This problem presents a hypothetical scenario involving limited-precision arithmetic to vividly illustrate the dangers of a small pivot. By comparing the solution obtained with partial pivoting to the one you would get without it, you'll see firsthand how this technique mitigates the amplification of round-off errors and rescues the accuracy of the final result. [@problem_id:2193047]", "problem": "Consider the following system of linear equations:\n$$\n\\begin{align*}\n(2.00 \\times 10^{-4}) x_1 + 2.00 x_2 &= 4.00 \\\\\n1.00 x_1 + 3.00 x_2 &= 5.00\n\\end{align*}\n$$\nYou are to solve this system using Gaussian elimination, but all calculations must be performed using a simplified floating-point representation known as **three-digit chopping arithmetic**. In this arithmetic system, numbers are first written in normalized decimal form, $\\pm 0.d_1d_2d_3d_4... \\times 10^n$, where $d_1 \\in \\{1, 2, \\dots, 9\\}$. The number is then stored by \"chopping off\" all digits after the third, resulting in the form $\\pm 0.d_1d_2d_3 \\times 10^n$. This chopping occurs after every individual arithmetic operation (addition, subtraction, multiplication, division).\n\nCalculate the solution vector $\\mathbf{x} = [x_1, x_2]^T$ using Gaussian elimination **with partial pivoting**. Express your final answer as the two components of the solution vector.", "solution": "We apply Gaussian elimination with partial pivoting under three-digit chopping arithmetic (store numbers in normalized form with three significant digits after each operation).\n\nStart with the augmented matrix\n$$\n\\left[\\begin{array}{cc|c}\n2.00\\times 10^{-4} & 2.00 & 4.00\\\\\n1.00 & 3.00 & 5.00\n\\end{array}\\right].\n$$\nPartial pivoting on column 1 compares $|2.00\\times 10^{-4}|$ and $|1.00|$, so we swap the two rows:\n$$\n\\left[\\begin{array}{cc|c}\n1.00 & 3.00 & 5.00\\\\\n2.00\\times 10^{-4} & 2.00 & 4.00\n\\end{array}\\right].\n$$\nElimination multiplier\n$$\n\\ell_{21}=\\text{chop}_{3}\\left(\\frac{2.00\\times 10^{-4}}{1.00}\\right)=2.00\\times 10^{-4}.\n$$\nUpdate row 2 entries with chopping after each operation:\n- New $a_{21}$:\n$$\n\\text{chop}_{3}\\left(2.00\\times 10^{-4}-\\ell_{21}\\cdot 1.00\\right)=\\text{chop}_{3}\\left(2.00\\times 10^{-4}-2.00\\times 10^{-4}\\right)=0.\n$$\n- New $a_{22}$:\n$$\n\\ell_{21}\\cdot a_{12}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 3.00\\right)=6.00\\times 10^{-4},\n$$\n$$\na_{22}^{(new)}=\\text{chop}_{3}\\left(2.00-6.00\\times 10^{-4}\\right)=\\text{chop}_{3}(1.9994)=1.99.\n$$\n- New $b_{2}$:\n$$\n\\ell_{21}\\cdot b_{1}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 5.00\\right)=1.00\\times 10^{-3},\n$$\n$$\nb_{2}^{(new)}=\\text{chop}_{3}\\left(4.00-1.00\\times 10^{-3}\\right)=\\text{chop}_{3}(3.999)=3.99.\n$$\nThe upper triangular system is thus\n$$\n\\begin{cases}\n1.00\\,x_{1}+3.00\\,x_{2}=5.00,\\\\\n1.99\\,x_{2}=3.99.\n\\end{cases}\n$$\nBack substitution with chopping after each operation:\n$$\nx_{2}=\\text{chop}_{3}\\left(\\frac{3.99}{1.99}\\right)=\\text{chop}_{3}(2.005025\\ldots)=2.00.\n$$\nThen\n$$\na_{12}\\,x_{2}=\\text{chop}_{3}(3.00\\cdot 2.00)=6.00,\\quad\nb_{1}-a_{12}x_{2}=\\text{chop}_{3}(5.00-6.00)=-1.00,\n$$\n$$\nx_{1}=\\text{chop}_{3}\\left(\\frac{-1.00}{1.00}\\right)=-1.00.\n$$\nTherefore, under three-digit chopping arithmetic with partial pivoting, the solution vector is $x_{1}=-1.00$ and $x_{2}=2.00$.", "answer": "$$\\boxed{\\begin{pmatrix}-1.00 & 2.00\\end{pmatrix}}$$", "id": "2193047"}, {"introduction": "This final exercise synthesizes our understanding by applying the partial pivoting strategy iteratively to a complete system. You will perform the full Gaussian elimination process on a $4 \\times 4$ matrix, selecting the appropriate pivot at each step. By tracking the original row indices of your chosen pivots, you'll not only solve the system but also gain insight into how the permutation matrix in an $PA=LU$ factorization is implicitly formed. [@problem_id:2192993]", "problem": "Consider the process of solving a system of linear equations $Ax=b$ using Gaussian elimination with a partial pivoting strategy. In this method, before performing the elimination for a given column $k$, the algorithm identifies the row $i \\geq k$ that has the element with the largest absolute value in column $k$. This row $i$ is then swapped with the current row $k$. The element now at position $(k,k)$ becomes the pivot for that step.\n\nYou are given the following $4 \\times 4$ matrix $A$:\n$$\nA = \\begin{pmatrix}\n1 & -2 & 3 & 4 \\\\\n3 & 1 & -5 & 2 \\\\\n-4 & 5 & 1 & -1 \\\\\n2 & -3 & 4 & 1\n\\end{pmatrix}\n$$\n\nLet the original rows of the matrix be indexed from 1 to 4. As you perform Gaussian elimination with partial pivoting on matrix $A$, you will select a pivot element for each of the four steps (i.e., for columns $k=1, 2, 3, 4$). Determine the sequence of the *original* row indices of the pivot elements selected at each step.\n\nFor example, if the pivot for the first step (k=1) comes from the third row of the original matrix, the first number in your sequence is 3. If the pivot for the second step (k=2) comes from the first row of the original matrix, the sequence would begin `[3, 1, ...]`.\n\nWhich of the following represents the correct sequence of original row indices of the pivot elements?\n\nA. `[1, 2, 3, 4]`\n\nB. `[3, 2, 1, 4]`\n\nC. `[3, 2, 4, 1]`\n\nD. `[3, 1, 2, 4]`", "solution": "We apply Gaussian elimination with partial pivoting. At each step $k$, we choose as pivot the entry in column $k$ with largest absolute value among rows $i \\geq k$, swap that row with row $k$, and then eliminate entries below the pivot. We track the original row indices.\n\nInitially,\n$$\nA=\\begin{pmatrix}\n1 & -2 & 3 & 4 \\\\\n3 & 1 & -5 & 2 \\\\\n-4 & 5 & 1 & -1 \\\\\n2 & -3 & 4 & 1\n\\end{pmatrix}.\n$$\n\nStep $k=1$: In column $1$, the absolute values are $|1|,|3|,|{-4}|,|2|$, with maximum $4$ at original row $3$. Swap row $1$ with row $3$ (pivot original index $3$):\n$$\n\\begin{pmatrix}\n-4 & 5 & 1 & -1 \\\\\n3 & 1 & -5 & 2 \\\\\n1 & -2 & 3 & 4 \\\\\n2 & -3 & 4 & 1\n\\end{pmatrix}.\n$$\nEliminate below using $m_{21}=\\frac{3}{-4}=-\\frac{3}{4}$, $m_{31}=\\frac{1}{-4}=-\\frac{1}{4}$, $m_{41}=\\frac{2}{-4}=-\\frac{1}{2}$, i.e., $\\text{row}_{i}\\leftarrow \\text{row}_{i}-m_{i1}\\text{row}_{1}$:\n$$\n\\text{row}_{2}=\\begin{pmatrix}3 & 1 & -5 & 2\\end{pmatrix}+\\frac{3}{4}\\begin{pmatrix}-4 & 5 & 1 & -1\\end{pmatrix}=\\begin{pmatrix}0 & \\frac{19}{4} & -\\frac{17}{4} & \\frac{5}{4}\\end{pmatrix},\n$$\n$$\n\\text{row}_{3}=\\begin{pmatrix}1 & -2 & 3 & 4\\end{pmatrix}+\\frac{1}{4}\\begin{pmatrix}-4 & 5 & 1 & -1\\end{pmatrix}=\\begin{pmatrix}0 & -\\frac{3}{4} & \\frac{13}{4} & \\frac{15}{4}\\end{pmatrix},\n$$\n$$\n\\text{row}_{4}=\\begin{pmatrix}2 & -3 & 4 & 1\\end{pmatrix}+\\frac{1}{2}\\begin{pmatrix}-4 & 5 & 1 & -1\\end{pmatrix}=\\begin{pmatrix}0 & -\\frac{1}{2} & \\frac{9}{2} & \\frac{1}{2}\\end{pmatrix}.\n$$\n\nStep $k=2$: In column $2$ (rows $2$ to $4$), the absolute values are $\\left|\\frac{19}{4}\\right|,\\left|-\\frac{3}{4}\\right|,\\left|-\\frac{1}{2}\\right|$, with maximum $\\frac{19}{4}$ at current row $2$ (original row $2$). No swap (pivot original index $2$). Eliminate below using\n$$\nm_{32}=\\frac{-\\frac{3}{4}}{\\frac{19}{4}}=-\\frac{3}{19},\\quad m_{42}=\\frac{-\\frac{1}{2}}{\\frac{19}{4}}=-\\frac{2}{19}.\n$$\nThus,\n$$\n\\text{row}_{3}=\\begin{pmatrix}0 & -\\frac{3}{4} & \\frac{13}{4} & \\frac{15}{4}\\end{pmatrix}+\\frac{3}{19}\\begin{pmatrix}0 & \\frac{19}{4} & -\\frac{17}{4} & \\frac{5}{4}\\end{pmatrix}=\\begin{pmatrix}0 & 0 & \\frac{49}{19} & \\frac{75}{19}\\end{pmatrix},\n$$\n$$\n\\text{row}_{4}=\\begin{pmatrix}0 & -\\frac{1}{2} & \\frac{9}{2} & \\frac{1}{2}\\end{pmatrix}+\\frac{2}{19}\\begin{pmatrix}0 & \\frac{19}{4} & -\\frac{17}{4} & \\frac{5}{4}\\end{pmatrix}=\\begin{pmatrix}0 & 0 & \\frac{77}{19} & \\frac{12}{19}\\end{pmatrix}.\n$$\n\nStep $k=3$: In column $3$ (rows $3$ and $4$), the absolute values are $\\left|\\frac{49}{19}\\right|$ and $\\left|\\frac{77}{19}\\right|$, with maximum $\\frac{77}{19}$ at current row $4$ (original row $4$). Swap rows $3$ and $4$ (pivot original index $4$), then eliminate below:\n$$\n\\text{row}_{4}\\leftarrow \\text{row}_{4}-\\frac{\\frac{49}{19}}{\\frac{77}{19}}\\text{row}_{3}=\\begin{pmatrix}0 & 0 & \\frac{49}{19} & \\frac{75}{19}\\end{pmatrix}-\\frac{49}{77}\\begin{pmatrix}0 & 0 & \\frac{77}{19} & \\frac{12}{19}\\end{pmatrix}=\\begin{pmatrix}0 & 0 & 0 & \\frac{39}{11}\\end{pmatrix}.\n$$\n\nStep $k=4$: Only row $4$ remains; its original index is $1$ (pivot original index $1$).\n\nTherefore, the sequence of original row indices of the pivots is $[3,2,4,1]$, which corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "2192993"}]}