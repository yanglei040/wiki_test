{"hands_on_practices": [{"introduction": "The primary motivation for LU decomposition is to simplify the process of solving linear systems. This practice focuses on the core application: once a matrix $A$ is factored into $A=LU$, the system $A\\mathbf{x}=\\mathbf{b}$ can be efficiently solved by tackling two simpler triangular systems. This exercise will help you master the fundamental two-step method of forward and backward substitution, which is the cornerstone of solving systems with a pre-computed LU factorization.", "problem": "A system of linear equations is given by the matrix equation $Ax=b$. The matrix $A$ has been factored into a product of a lower triangular matrix $L$ and an upper triangular matrix $U$, such that $A=LU$. This specific type of Lower-Upper (LU) factorization is one where the upper triangular matrix $U$ has ones on its main diagonal.\n\nGiven the matrices $L$, $U$, and the vector $b$ as follows:\n$$\nL = \\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 4 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\text{and} \\quad b = \\begin{pmatrix} -4 \\\\ 5 \\\\ -9 \\end{pmatrix}\n$$\nDetermine the solution vector $x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$.", "solution": "We are given $A=LU$ with $L$ lower triangular and $U$ upper triangular having ones on its main diagonal, and we must solve $Ax=b$. Define $y=Ux$. Then $Ly=b$ can be solved by forward substitution, followed by solving $Ux=y$ by back substitution.\n\nFirst solve $Ly=b$ with\n$$\nL=\\begin{pmatrix}2&0&0\\\\-1&3&0\\\\4&-2&1\\end{pmatrix},\\quad\ny=\\begin{pmatrix}y_{1}\\\\y_{2}\\\\y_{3}\\end{pmatrix},\\quad\nb=\\begin{pmatrix}-4\\\\5\\\\-9\\end{pmatrix}.\n$$\nWriting out the system:\n$$\n2y_{1}=-4,\\quad -y_{1}+3y_{2}=5,\\quad 4y_{1}-2y_{2}+y_{3}=-9.\n$$\nFrom the first equation,\n$$\ny_{1}=\\frac{-4}{2}=-2.\n$$\nSubstitute into the second equation:\n$$\n-(-2)+3y_{2}=5\\;\\Rightarrow\\;2+3y_{2}=5\\;\\Rightarrow\\;3y_{2}=3\\;\\Rightarrow\\;y_{2}=1.\n$$\nSubstitute $y_{1}$ and $y_{2}$ into the third equation:\n$$\n4(-2)-2(1)+y_{3}=-9\\;\\Rightarrow\\;-8-2+y_{3}=-9\\;\\Rightarrow\\;-10+y_{3}=-9\\;\\Rightarrow\\;y_{3}=1.\n$$\nHence,\n$$\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n\nNext solve $Ux=y$ with\n$$\nU=\\begin{pmatrix}1&2&-1\\\\0&1&3\\\\0&0&1\\end{pmatrix},\\quad\nx=\\begin{pmatrix}x_{1}\\\\x_{2}\\\\x_{3}\\end{pmatrix},\\quad\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\nWriting out the system:\n$$\nx_{3}=1,\\quad x_{2}+3x_{3}=1,\\quad x_{1}+2x_{2}-x_{3}=-2.\n$$\nFrom the third row,\n$$\nx_{3}=1.\n$$\nFrom the second row,\n$$\nx_{2}+3(1)=1\\;\\Rightarrow\\;x_{2}=-2.\n$$\nFrom the first row,\n$$\nx_{1}+2(-2)-1=-2\\;\\Rightarrow\\;x_{1}-4-1=-2\\;\\Rightarrow\\;x_{1}-5=-2\\;\\Rightarrow\\;x_{1}=3.\n$$\nTherefore, the solution vector is $x=\\begin{pmatrix}3\\\\-2\\\\1\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 3 \\\\ -2 \\\\ 1 \\end{pmatrix}}$$", "id": "2204086"}, {"introduction": "Having learned how to use an existing LU factorization to solve a system [@problem_id:2204086], the next logical step is to learn how to generate the factorization yourself. This problem guides you through the process of deriving the $L$ and $U$ matrices from first principles. By working with a matrix containing a symbolic parameter, you will develop a robust understanding of the decomposition algorithm itself, moving beyond rote calculation to true conceptual comprehension.", "problem": "In the analysis of a certain two-variable linear dynamical system, its steady-state behavior is described by the matrix equation $A\\mathbf{x} = \\mathbf{b}$. The system matrix $A$ and the input vector $\\mathbf{b}$ are dependent on a real parameter $\\gamma$, which represents a coupling strength. They are given by:\n$$A = \\begin{pmatrix} \\gamma & \\gamma \\\\ 1 & 2\\gamma \\end{pmatrix} \\quad \\text{and} \\quad \\mathbf{b} = \\begin{pmatrix} 2\\gamma \\\\ 3 \\end{pmatrix}$$\nYou are given that the parameter $\\gamma$ is positive ($\\gamma > 0$) and is not equal to $1/2$.\n\nYour task is to find the steady-state solution vector $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$. To do this, you must first find the Lower-Upper (LU) decomposition of the matrix $A$, in the form $A = LU$, where $L$ is a lower triangular matrix with ones on its main diagonal, and $U$ is an upper triangular matrix. Then, use this decomposition to solve for $\\mathbf{x}$. Express your final answer for $\\mathbf{x}$ in terms of $\\gamma$.", "solution": "We seek an LU decomposition of $A$ with $L$ unit lower triangular and $U$ upper triangular, and then solve $A\\mathbf{x}=\\mathbf{b}$ via forward and backward substitution. Since $\\gamma>0$, we have $\\gamma\\neq 0$, and the given $\\gamma\\neq \\frac{1}{2}$ ensures $\\det(A)=\\gamma(2\\gamma-1)\\neq 0$.\n\nAssume\n$$\nL=\\begin{pmatrix}1&0\\\\ \\ell&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}\\\\ 0&u_{22}\\end{pmatrix},\n$$\nso that $A=LU$ implies\n$$\n\\begin{pmatrix}\\gamma&\\gamma\\\\ 1&2\\gamma\\end{pmatrix}\n=\n\\begin{pmatrix}1&0\\\\ \\ell&1\\end{pmatrix}\n\\begin{pmatrix}u_{11}&u_{12}\\\\ 0&u_{22}\\end{pmatrix}\n=\n\\begin{pmatrix}u_{11}&u_{12}\\\\ \\ell u_{11}&\\ell u_{12}+u_{22}\\end{pmatrix}.\n$$\nEquating entries gives\n$$\nu_{11}=\\gamma,\\quad u_{12}=\\gamma,\\quad \\ell u_{11}=1,\\quad \\ell u_{12}+u_{22}=2\\gamma.\n$$\nFrom $\\ell u_{11}=1$ we get $\\ell=\\frac{1}{\\gamma}$. Then\n$$\nu_{22}=2\\gamma-\\ell u_{12}=2\\gamma-\\frac{1}{\\gamma}\\,\\gamma=2\\gamma-1.\n$$\nThus\n$$\nL=\\begin{pmatrix}1&0\\\\ \\frac{1}{\\gamma}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}\\gamma&\\gamma\\\\ 0&2\\gamma-1\\end{pmatrix}.\n$$\n\nTo solve $A\\mathbf{x}=\\mathbf{b}$, write $LU\\mathbf{x}=\\mathbf{b}$ and first solve $L\\mathbf{y}=\\mathbf{b}$ for $\\mathbf{y}$, then $U\\mathbf{x}=\\mathbf{y}$. With $\\mathbf{b}=\\begin{pmatrix}2\\gamma\\\\ 3\\end{pmatrix}$, the system $L\\mathbf{y}=\\mathbf{b}$ is\n$$\n\\begin{pmatrix}1&0\\\\ \\frac{1}{\\gamma}&1\\end{pmatrix}\n\\begin{pmatrix}y_{1}\\\\ y_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}2\\gamma\\\\ 3\\end{pmatrix}.\n$$\nFrom the first row, $y_{1}=2\\gamma$. From the second row, $\\frac{1}{\\gamma}y_{1}+y_{2}=3$, hence\n$$\ny_{2}=3-\\frac{1}{\\gamma}(2\\gamma)=3-2=1,\n$$\nso $\\mathbf{y}=\\begin{pmatrix}2\\gamma\\\\ 1\\end{pmatrix}$.\n\nNow solve $U\\mathbf{x}=\\mathbf{y}$:\n$$\n\\begin{pmatrix}\\gamma&\\gamma\\\\ 0&2\\gamma-1\\end{pmatrix}\n\\begin{pmatrix}x_{1}\\\\ x_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}2\\gamma\\\\ 1\\end{pmatrix}.\n$$\nFrom the second row, $(2\\gamma-1)x_{2}=1$, so\n$$\nx_{2}=\\frac{1}{2\\gamma-1}.\n$$\nFrom the first row, $\\gamma(x_{1}+x_{2})=2\\gamma$, hence $x_{1}+x_{2}=2$, so\n$$\nx_{1}=2-\\frac{1}{2\\gamma-1}=\\frac{4\\gamma-3}{2\\gamma-1}.\n$$\n\nTherefore, the steady-state solution vector is\n$$\n\\mathbf{x}=\\begin{pmatrix}\\frac{4\\gamma-3}{2\\gamma-1}\\\\ \\frac{1}{2\\gamma-1}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4\\gamma-3}{2\\gamma-1}\\\\ \\frac{1}{2\\gamma-1}\\end{pmatrix}}$$", "id": "2204091"}, {"introduction": "In practical applications, the standard LU decomposition algorithm can encounter issues, such as division by zero, if a pivot element is zero. This practice introduces the essential technique of partial pivoting, which overcomes this limitation by reordering the matrix rows to ensure a stable and successful factorization. Mastering this concept [@problem_id:2204103] is crucial for understanding how modern numerical software reliably solves large-scale linear systems.", "problem": "In numerical linear algebra, solving systems of equations $Ax=b$ is often accomplished by first factoring the matrix $A$. However, for some matrices, a direct LU factorization is not possible due to zero pivots appearing during Gaussian elimination. This issue is resolved by permuting the rows of the matrix, which is equivalent to left-multiplying by a permutation matrix $P$. One can then perform an LU decomposition on the permuted matrix, $PA=LU$. This is known as LU factorization with partial pivoting.\n\nConsider the matrix $A$ and the permutation matrix $P$ given below:\n$$A = \\begin{pmatrix} 2 & 1 & 5 \\\\ 4 & 2 & -1 \\\\ -6 & 1 & 0 \\end{pmatrix}, \\quad P = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}$$\n\nPerform a Doolittle LU decomposition on the matrix product $PA$, such that $PA = LU$. In a Doolittle decomposition, the matrix $L$ is a lower triangular matrix with ones on its main diagonal, and $U$ is an upper triangular matrix.\n\nYour task is to find the matrix sum $L+U$.", "solution": "First compute the permuted matrix $PA$ by left-multiplying $A$ by $P$, which swaps the second and third rows of $A$:\n$$\nPA=\\begin{pmatrix} 2 & 1 & 5 \\\\ -6 & 1 & 0 \\\\ 4 & 2 & -1 \\end{pmatrix}.\n$$\nPerform a Doolittle LU decomposition $PA=LU$ with $L$ unit lower triangular and $U$ upper triangular.\n\nUse Gaussian elimination on $PA$ to determine the multipliers and the entries of $U$:\n- Pivot at $(1,1)$: $u_{11}=2$, and set\n$$\n\\ell_{21}=\\frac{-6}{2}=-3,\\quad \\ell_{31}=\\frac{4}{2}=2.\n$$\nEliminate below the first pivot:\n$$\n\\text{Row }2 \\leftarrow \\text{Row }2 - \\ell_{21}\\,\\text{Row }1 = \\begin{pmatrix} 0 & 4 & 15 \\end{pmatrix},\\quad\n\\text{Row }3 \\leftarrow \\text{Row }3 - \\ell_{31}\\,\\text{Row }1 = \\begin{pmatrix} 0 & 0 & -11 \\end{pmatrix}.\n$$\nThus the first row of $U$ is $[2,1,5]$, and after the first elimination step, the submatrix is\n$$\n\\begin{pmatrix} 0 & 4 & 15 \\\\ 0 & 0 & -11 \\end{pmatrix}.\n$$\n- Pivot at $(2,2)$: $u_{22}=4$, and set\n$$\n\\ell_{32}=\\frac{0}{4}=0.\n$$\nEliminate below the second pivot:\n$$\n\\text{Row }3 \\leftarrow \\text{Row }3 - \\ell_{32}\\,\\text{Row }2 = \\begin{pmatrix} 0 & 0 & -11 \\end{pmatrix},\n$$\nso $u_{23}=15$ and $u_{33}=-11$.\n\nTherefore,\n$$\nL=\\begin{pmatrix} 1 & 0 & 0 \\\\ -3 & 1 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix},\\quad\nU=\\begin{pmatrix} 2 & 1 & 5 \\\\ 0 & 4 & 15 \\\\ 0 & 0 & -11 \\end{pmatrix}.\n$$\nCompute the matrix sum $L+U$:\n$$\nL+U=\\begin{pmatrix} 1+2 & 0+1 & 0+5 \\\\ -3+0 & 1+4 & 0+15 \\\\ 2+0 & 0+0 & 1+(-11) \\end{pmatrix}\n=\\begin{pmatrix} 3 & 1 & 5 \\\\ -3 & 5 & 15 \\\\ 2 & 0 & -10 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 1 & 5 \\\\ -3 & 5 & 15 \\\\ 2 & 0 & -10 \\end{pmatrix}}$$", "id": "2204103"}]}