{"hands_on_practices": [{"introduction": "The best way to understand a new numerical technique is to apply it. This first exercise walks you through a single, complete step of a predictor-corrector method using the most straightforward combination: the forward Euler method as the predictor and the trapezoidal rule as the corrector. By working through this fundamental example, you will gain hands-on experience with the core Predict-Evaluate-Correct sequence that defines these powerful methods. [@problem_id:2194236]", "problem": "Consider the initial value problem defined by the ordinary differential equation:\n$$ y' = x^2 - y^2 $$\nwith the initial condition $y(0) = 1$.\n\nYour task is to approximate the value of $y(0.1)$ by performing a single step of the Euler predictor-trapezoidal corrector method. Use a step size of $h=0.1$.\n\nRound your final answer to four significant figures.", "solution": "We define the differential equation as $y' = f(x,y)$ with $f(x,y) = x^{2} - y^{2}$ and initial condition $y(0) = 1$. Let $h = 0.1$, $x_{0} = 0$, and $x_{1} = x_{0} + h = 0.1$.\n\nThe Euler predictor is given by\n$$\ny_{1}^{(p)} = y_{0} + h\\,f(x_{0},y_{0}).\n$$\nCompute\n$$\nf(x_{0},y_{0}) = f(0,1) = 0^{2} - 1^{2} = -1,\n$$\nso\n$$\ny_{1}^{(p)} = 1 + 0.1(-1) = 0.9.\n$$\n\nThe trapezoidal corrector (one correction using the predictor) is\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left[f(x_{0},y_{0}) + f(x_{1},y_{1}^{(p)})\\right].\n$$\nEvaluate\n$$\nf(x_{1},y_{1}^{(p)}) = f(0.1,0.9) = (0.1)^{2} - (0.9)^{2} = 0.01 - 0.81 = -0.8.\n$$\nThus\n$$\ny_{1} = 1 + \\frac{0.1}{2}\\left[(-1) + (-0.8)\\right] = 1 + 0.05(-1.8) = 1 - 0.09 = 0.91.\n$$\n\nRounding to four significant figures gives $0.9100$.", "answer": "$$\\boxed{0.9100}$$", "id": "2194236"}, {"introduction": "Having mastered the basic procedure, we now advance to a more sophisticated and widely used class of predictor-corrector schemes. This problem utilizes the second-order Adams-Bashforth method to predict the next value and the second-order Adams-Moulton method to correct it, a pairing known for its excellent balance of accuracy and efficiency. This practice demonstrates how multistep formulas, which leverage the history of the solution, are implemented in a practical setting. [@problem_id:2194669]", "problem": "Consider the initial value problem defined by the ordinary differential equation (ODE):\n$$y'(t) = t + \\cos(y(t))$$\nwith known values at two points: $y(0) = 0$ and $y(0.1) = 0.0525$. All trigonometric functions in the ODE are evaluated in radians.\n\nUsing a step size of $h=0.1$, apply one iteration of a predictor-corrector method to find an approximate value for $y(0.2)$. The method consists of a second-order Adams-Bashforth method as the predictor and a second-order Adams-Moulton method as the corrector.\n\nReport the final corrected value for $y(0.2)$. Round your final answer to four significant figures.", "solution": "The goal is to find an approximation for $y(0.2)$ using one step of a predictor-corrector method. We are given the ODE $y'(t) = f(t, y) = t + \\cos(y)$, a step size $h=0.1$, and two initial points.\n\nLet's denote $t_n = n h$ and $y_n \\approx y(t_n)$.\nWe are given:\n- $t_0 = 0$, $y_0 = y(0) = 0$\n- $t_1 = 0.1$, $y_1 = y(0.1) = 0.0525$\n- Step size $h = 0.1$\n\nWe want to find $y_2 \\approx y(0.2)$. The process involves a predictor step and a corrector step.\n\nThe predictor is the second-order Adams-Bashforth (AB2) method:\n$$y_{i+1}^{(p)} = y_i + \\frac{h}{2} \\left[ 3 f(t_i, y_i) - f(t_{i-1}, y_{i-1}) \\right]$$\nThe corrector is the second-order Adams-Moulton (AM1, or Trapezoidal) method:\n$$y_{i+1} = y_i + \\frac{h}{2} \\left[ f(t_{i+1}, y_{i+1}^{(p)}) + f(t_i, y_i) \\right]$$\n\nWe need to compute $y_2$, so we set $i=1$ in these formulas.\n\n**Step 1: Evaluate the function $f(t,y)$ at the known points.**\nWe need $f_0 = f(t_0, y_0)$ and $f_1 = f(t_1, y_1)$.\n$$f_0 = f(0, 0) = 0 + \\cos(0) = 1$$\n$$f_1 = f(0.1, 0.0525) = 0.1 + \\cos(0.0525)$$\nUsing a calculator (in radian mode), we find:\n$$\\cos(0.0525) \\approx 0.99862215$$\n$$f_1 \\approx 0.1 + 0.99862215 = 1.09862215$$\n\n**Step 2: Apply the predictor (AB2) to find $y_2^{(p)}$.**\nWe use the AB2 formula with $i=1$:\n$$y_2^{(p)} = y_1 + \\frac{h}{2} (3f_1 - f_0)$$\nSubstituting the known values:\n$$y_2^{(p)} = 0.0525 + \\frac{0.1}{2} (3 \\times 1.09862215 - 1)$$\n$$y_2^{(p)} = 0.0525 + 0.05 (3.29586645 - 1)$$\n$$y_2^{(p)} = 0.0525 + 0.05 (2.29586645)$$\n$$y_2^{(p)} = 0.0525 + 0.11479332$$\n$$y_2^{(p)} \\approx 0.16729332$$\n\n**Step 3: Apply the corrector (AM1) to find $y_2$.**\nFirst, we must evaluate $f$ at the new point $(t_2, y_2^{(p)})$, where $t_2 = t_1 + h = 0.1 + 0.1 = 0.2$.\n$$f(t_2, y_2^{(p)}) = f(0.2, 0.16729332)$$\n$$f(t_2, y_2^{(p)}) = 0.2 + \\cos(0.16729332)$$\nUsing a calculator (in radian mode):\n$$\\cos(0.16729332) \\approx 0.98595001$$\n$$f(t_2, y_2^{(p)}) \\approx 0.2 + 0.98595001 = 1.18595001$$\n\nNow, we use the AM1 formula with $i=1$:\n$$y_2 = y_1 + \\frac{h}{2} (f(t_2, y_2^{(p)}) + f_1)$$\nSubstituting the values:\n$$y_2 = 0.0525 + \\frac{0.1}{2} (1.18595001 + 1.09862215)$$\n$$y_2 = 0.0525 + 0.05 (2.28457216)$$\n$$y_2 = 0.0525 + 0.11422861$$\n$$y_2 \\approx 0.16672861$$\n\n**Step 4: Round the final answer.**\nThe problem asks to round the final answer to four significant figures.\nThe calculated value for $y_2$ is approximately $0.16672861$.\nRounding to four significant figures gives $0.1667$.", "answer": "$$\\boxed{0.1667}$$", "id": "2194669"}, {"introduction": "A crucial aspect of numerical modeling, especially in physics and engineering, is understanding how well an algorithm respects the fundamental laws of the system, such as the conservation of energy. This final practice moves beyond simple calculation to a deeper analysis of a method's long-term behavior. You will investigate how the energy of a simple harmonic oscillator changes after one step of the Euler-Trapezoid method, revealing important insights into the numerical stability and conservation properties of the algorithm. [@problem_id:2194239]", "problem": "In computational physics, a critical test for any numerical integration algorithm is its ability to respect the conservation laws of the continuous physical system it aims to model. Consider the simple harmonic oscillator, a fundamental model in physics, described by the second-order differential equation $\\frac{d^2x}{dt^2} = -x$. This can be expressed as a system of two first-order ordinary differential equations:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\nwhere $x$ is the position and $v$ is the velocity. For this continuous system, the total energy, defined as $E = \\frac{1}{2}(v^2 + x^2)$, is a conserved quantity.\n\nWe wish to investigate the energy conservation properties of a specific numerical method, the Euler-Trapezoid predictor-corrector method. To advance the solution from a time $t_n$ to $t_{n+1} = t_n + h$, where $h$ is the step size, the method proceeds in two stages:\n\n1.  **Predictor Stage**: First, an intermediate, predicted state $(\\tilde{x}_{n+1}, \\tilde{v}_{n+1})$ is calculated using a single forward Euler step from the state $(x_n, v_n)$:\n    $$\n    \\tilde{x}_{n+1} = x_n + h \\cdot v_n\n    $$\n    $$\n    \\tilde{v}_{n+1} = v_n + h \\cdot (-x_n)\n    $$\n2.  **Corrector Stage**: The final state $(x_{n+1}, v_{n+1})$ is then computed by applying the trapezoidal rule, which averages the derivative at the beginning of the step, $(v_n, -x_n)$, and the derivative at the predicted end of the step, $(\\tilde{v}_{n+1}, -\\tilde{x}_{n+1})$:\n    $$\n    x_{n+1} = x_n + \\frac{h}{2}(v_n + \\tilde{v}_{n+1})\n    $$\n    $$\n    v_{n+1} = v_n + \\frac{h}{2}(-x_n - \\tilde{x}_{n+1})\n    $$\n\nLet $E_n = \\frac{1}{2}(v_n^2 + x_n^2)$ be the numerical energy of the system at step $n$. After a single step of this predictor-corrector method with step size $h$, the energy will change to $E_{n+1} = \\frac{1}{2}(v_{n+1}^2 + x_{n+1}^2)$.\n\nAssuming the initial state $(x_n, v_n)$ is not the origin, determine the ratio of the energy after one step to the initial energy, $E_{n+1}/E_n$, as a function of the step size $h$.", "solution": "We start from the given predictor-corrector scheme for the system $x' = v$, $v' = -x$.\n\nPredictor stage:\n$$\n\\tilde{x}_{n+1} = x_{n} + h v_{n}, \\qquad \\tilde{v}_{n+1} = v_{n} - h x_{n}.\n$$\n\nCorrector stage:\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + \\tilde{v}_{n+1}\\right), \\qquad v_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - \\tilde{x}_{n+1}\\right).\n$$\nSubstituting the predictor values into the corrector gives\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + v_{n} - h x_{n}\\right) = \\left(1 - \\frac{h^{2}}{2}\\right)x_{n} + h v_{n},\n$$\n$$\nv_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - (x_{n} + h v_{n})\\right) = -h x_{n} + \\left(1 - \\frac{h^{2}}{2}\\right)v_{n}.\n$$\n\nThus the one-step update can be written in matrix form as\n$$\n\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix} 1 - \\frac{h^{2}}{2} & h \\\\ -h & 1 - \\frac{h^{2}}{2} \\end{pmatrix}}_{M}\n\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.\n$$\nLet $a = 1 - \\frac{h^{2}}{2}$ and $b = h$. Then $M = a I + b J$ with\n$$\nI = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\qquad J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}.\n$$\nNote the properties $J^{T} = -J$ and $J^{2} = -I$. Compute\n$$\nM^{T}M = (a I - b J)(a I + b J) = a^{2} I - b^{2} J^{2} = (a^{2} + b^{2}) I.\n$$\nFor any state vector $w_{n} = \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$, this implies\n$$\nx_{n+1}^{2} + v_{n+1}^{2} = \\|w_{n+1}\\|^{2} = w_{n}^{T} M^{T} M w_{n} = (a^{2} + b^{2}) \\|w_{n}\\|^{2} = (a^{2} + b^{2})(x_{n}^{2} + v_{n}^{2}).\n$$\nWith $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$, we get\n$$\n\\frac{E_{n+1}}{E_{n}} = \\frac{\\frac{1}{2}(x_{n+1}^{2} + v_{n+1}^{2})}{\\frac{1}{2}(x_{n}^{2} + v_{n}^{2})} = a^{2} + b^{2}.\n$$\nSubstituting $a = 1 - \\frac{h^{2}}{2}$ and $b = h$,\n$$\na^{2} + b^{2} = \\left(1 - \\frac{h^{2}}{2}\\right)^{2} + h^{2} = 1 - h^{2} + \\frac{h^{4}}{4} + h^{2} = 1 + \\frac{h^{4}}{4}.\n$$\nSince $(x_{n}, v_{n}) \\neq (0,0)$ by assumption, the ratio is well-defined and independent of the particular initial state.\n\nTherefore,\n$$\n\\frac{E_{n+1}}{E_{n}} = 1 + \\frac{h^{4}}{4}.\n$$", "answer": "$$\\boxed{1+\\frac{h^{4}}{4}}$$", "id": "2194239"}]}