{"hands_on_practices": [{"introduction": "To begin our hands-on exploration of second-order Runge-Kutta methods, we will start with a straightforward application of Heun's method. This exercise models a simple physical system where the velocity of a probe is a function of time, allowing us to focus on the core predictor-corrector mechanism without the added complexity of a state-dependent function. By successfully completing this single-step calculation [@problem_id:2200949], you will build a solid foundation for tackling more intricate problems.", "problem": "A remote-controlled probe's velocity on a straight track is observed to be inversely proportional to the time elapsed since its activation. The relationship is specifically given by $v(t) = k/t$, where $v$ is the velocity in meters per second (m/s) and $t$ is the time in seconds. For this particular probe, the constant $k$ is determined to be exactly $k=1 \\text{ m}$. The probe starts its motion at time $t=1 \\text{ s}$ from the origin of the coordinate system, meaning its initial position is $x(1) = 0 \\text{ m}$. An engineer wants to estimate the position of the probe at time $t=1.2 \\text{ s}$. Using Heun's method with a single time step, calculate the approximate position of the probe. Express your answer for the position in meters (m), rounded to three significant figures.", "solution": "We model the probe’s position by the first-order ODE obtained from the physical relation that velocity is the time derivative of position: \n$$\n\\frac{dx}{dt}=v(t).\n$$\nGiven $v(t)=\\frac{k}{t}$ with $k=1$, we have\n$$\n\\frac{dx}{dt}=\\frac{1}{t}, \\quad x(1)=0.\n$$\nWe apply Heun’s method (improved Euler) over a single step from $t_{0}=1$ to $t_{1}=1.2$ with step size $h=t_{1}-t_{0}=0.2$. Heun’s update for $x$ is\n$$\nx_{1}=x_{0}+\\frac{h}{2}\\left[f(t_{0},x_{0})+f\\bigl(t_{1},x_{0}+h f(t_{0},x_{0})\\bigr)\\right],\n$$\nwhere $f(t,x)=\\frac{1}{t}$. Since $f$ is independent of $x$, this simplifies to\n$$\nx_{1}=x_{0}+\\frac{h}{2}\\left[f(t_{0})+f(t_{1})\\right].\n$$\nCompute the slopes:\n$$\nf(t_{0})=\\frac{1}{1}=1, \\quad f(t_{1})=\\frac{1}{1.2}=\\frac{5}{6}.\n$$\nThus,\n$$\nx(1.2)=x_{1}=0+\\frac{0.2}{2}\\left(1+\\frac{5}{6}\\right)=0.1\\cdot\\frac{11}{6}=\\frac{11}{60}\\approx 0.183333\\ldots\n$$\nRounded to three significant figures, the approximate position is $0.183$.", "answer": "$$\\boxed{0.183}$$", "id": "2200949"}, {"introduction": "Having mastered a single step, we now move to a more realistic scenario that requires iterating the numerical process. This problem involves an ordinary differential equation where the derivative depends on both time $t$ and the solution $y$ itself, a common feature in many scientific models. By performing two successive steps of Heun's method [@problem_id:2200989], you will practice the iterative nature of numerical solvers and see how the solution is built up step-by-step.", "problem": "In many scientific and engineering models, we encounter first-order ordinary differential equations (ODEs) that are difficult or impossible to solve analytically. Consider one such initial value problem defined by:\n$$ \\frac{dy}{dt} = t - 2y, \\quad y(0) = 3 $$\nYour task is to approximate the value of the solution $y(t)$ at the point $t = 0.2$. To achieve this, you will use Heun's method. Perform two successive steps with a step size of $h=0.1$.\n\nFor an ODE of the form $\\frac{dy}{dt} = f(t,y)$, a single step of Heun's method from $(t_i, y_i)$ to $(t_{i+1}, y_{i+1})$ is calculated using a predictor-corrector approach:\n1.  Predictor slope: $k_1 = f(t_i, y_i)$\n2.  Corrector slope: $k_2 = f(t_i + h, y_i + h k_1)$\n3.  Combination: $y_{i+1} = y_i + \\frac{h}{2}(k_1 + k_2)$\n\nUsing this scheme, find the value of $y(0.2)$. Round your final answer to four significant figures.", "solution": "We are given the initial value problem $y^{\\prime}=f(t,y)=t-2y$ with $y(0)=3$ and asked to approximate $y(0.2)$ using Heun's method with step size $h=0.1$ for two steps.\n\nHeun's method from $(t_{i},y_{i})$ to $(t_{i+1},y_{i+1})$ uses:\n$$\nk_{1}=f(t_{i},y_{i}), \\quad\nk_{2}=f(t_{i}+h,\\,y_{i}+h k_{1}), \\quad\ny_{i+1}=y_{i}+\\frac{h}{2}\\left(k_{1}+k_{2}\\right).\n$$\n\nStep 1: from $t_{0}=0$ to $t_{1}=0.1$ with $y_{0}=3$.\nCompute\n$$\nk_{1}=f(0,3)=0-2\\cdot 3=-6,\n$$\n$$\nk_{2}=f\\!\\left(0.1,\\,3+0.1(-6)\\right)=f(0.1,\\,2.4)=0.1-2\\cdot 2.4=-4.7,\n$$\n$$\ny_{1}=3+\\frac{0.1}{2}\\left(-6+(-4.7)\\right)=3+0.05(-10.7)=3-0.535=2.465.\n$$\n\nStep 2: from $t_{1}=0.1$ to $t_{2}=0.2$ with $y_{1}=2.465$.\nCompute\n$$\nk_{1}=f(0.1,2.465)=0.1-2\\cdot 2.465=-4.83,\n$$\n$$\nk_{2}=f\\!\\left(0.2,\\,2.465+0.1(-4.83)\\right)=f(0.2,\\,1.982)=0.2-2\\cdot 1.982=-3.764,\n$$\n$$\ny_{2}=2.465+\\frac{0.1}{2}\\left(-4.83+(-3.764)\\right)=2.465+0.05(-8.594)=2.465-0.4297=2.0353.\n$$\n\nTherefore, the Heun-method approximation at $t=0.2$ is $y(0.2)\\approx 2.0353$, which to four significant figures is $2.035$.", "answer": "$$\\boxed{2.035}$$", "id": "2200989"}, {"introduction": "Our final practice shifts from numerical computation to conceptual analysis, exploring the accuracy and limitations of Heun's method. While numerical methods are approximations, they can be exact for certain classes of functions. This exercise [@problem_id:2200981] challenges you to determine when Heun's method yields the precise analytical solution, providing deep insight into its connection with the trapezoidal rule and the source of its second-order accuracy.", "problem": "Heun's method, also known as the improved Euler method, is a second-order Runge-Kutta method for numerically solving a first-order ordinary differential equation of the form $y'(t) = f(t, y)$ with a given initial condition $y(t_0) = y_0$. The iterative formula to advance the solution from time $t_i$ to $t_{i+1} = t_i + h$, where $h$ is the step size, is given by the following two-step process:\n\n1.  **Predictor step:** Calculate a preliminary estimate of the next value, $y_{i+1}^*$.\n    $$y_{i+1}^* = y_i + h f(t_i, y_i)$$\n2.  **Corrector step:** Use the average of the slopes at the beginning and end of the interval to compute the final value, $y_{i+1}$.\n    $$y_{i+1} = y_i + \\frac{h}{2} \\left[ f(t_i, y_i) + f(t_{i+1}, y_{i+1}^*) \\right]$$\n\nWhile numerical methods typically introduce some error at each step, for certain forms of the function $f(t,y)$, Heun's method can yield the exact solution.\n\nFor which one of the following forms of the function $f(t,y)$ is Heun's method guaranteed to produce the exact analytical solution for any arbitrary initial condition $y(t_0) = y_0$ and any non-zero step size $h$? (Assume $a$ and $b$ are non-zero real constants).\n\nA. $f(t, y) = at + b$\n\nB. $f(t, y) = ay$\n\nC. $f(t, y) = at^2$\n\nD. $f(t, y) = \\sin(t)$\n\nE. $f(t, y) = e^y$", "solution": "We compare the Heun update with the exact one-step solution for each proposed form of $f(t,y)$.\n\nThe exact one-step solution from $t_{i}$ to $t_{i+1}=t_{i}+h$ is\n$$\ny(t_{i+1})=y(t_{i})+\\int_{t_{i}}^{t_{i+1}} f\\big(t,y(t)\\big)\\,dt.\n$$\nHeun’s method computes\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\left[f(t_{i},y_{i})+f\\!\\left(t_{i+1},y_{i+1}^{*}\\right)\\right],\n$$\nwith predictor\n$$\ny_{i+1}^{*}=y_{i}+h f(t_{i},y_{i}).\n$$\n\nCase A: $f(t,y)=at+b$ (independent of $y$, linear in $t$).\nThen $f(t_{i},y_{i})=a t_{i}+b$ and $f(t_{i+1},y_{i+1}^{*})=a t_{i+1}+b$ (no dependence on $y$). Heun reduces to the trapezoidal rule:\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\big[(a t_{i}+b)+(a t_{i+1}+b)\\big].\n$$\nThe exact integral of $at+b$ over $[t_{i},t_{i+1}]$ is\n$$\n\\int_{t_{i}}^{t_{i}+h} (a t+b)\\,dt=\\frac{a}{2}\\big((t_{i}+h)^{2}-t_{i}^{2}\\big)+b h\n=\\frac{h}{2}\\big(a(t_{i}+t_{i+1})+2b\\big),\n$$\nwhich is exactly the same expression. Therefore, for any $h\\neq 0$ and any initial condition, Heun’s method reproduces the exact analytical solution when $f(t,y)=at+b$.\n\nCase B: $f(t,y)=a y$.\nPredictor: $y_{i+1}^{*}=y_{i}+h a y_{i}=(1+a h)y_{i}$.\nCorrector:\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\left[a y_{i}+a y_{i+1}^{*}\\right]\n=y_{i}+\\frac{h}{2}a\\left[y_{i}+(1+a h)y_{i}\\right]\n=\\left(1+a h+\\frac{(a h)^{2}}{2}\\right)y_{i}.\n$$\nThe exact one-step solution is $y(t_{i+1})=\\exp(a h)y_{i}$, which is not equal to $1+a h+(a h)^{2}/2$ for general $h$. Hence not exact in general.\n\nCase C: $f(t,y)=a t^{2}$ (independent of $y$, quadratic in $t$).\nHeun gives\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\left[a t_{i}^{2}+a(t_{i}+h)^{2}\\right]\n=y_{i}+a h t_{i}^{2}+a h^{2} t_{i}+\\frac{a h^{3}}{2}.\n$$\nThe exact integral is\n$$\n\\int_{t_{i}}^{t_{i}+h} a t^{2}\\,dt=a\\left[\\frac{(t_{i}+h)^{3}-t_{i}^{3}}{3}\\right]\n=a\\left(t_{i}^{2}h+t_{i}h^{2}+\\frac{h^{3}}{3}\\right).\n$$\nThe difference is $a h^{3}\\left(\\frac{1}{2}-\\frac{1}{3}\\right)=\\frac{a h^{3}}{6}\\neq 0$ for $h\\neq 0$, so not exact.\n\nCase D: $f(t,y)=\\sin(t)$ (independent of $y$, but not linear in $t$).\nHeun yields\n$$\ny_{i+1}-y_{i}=\\frac{h}{2}\\big[\\sin(t_{i})+\\sin(t_{i}+h)\\big]\n=h\\,\\sin\\!\\left(t_{i}+\\frac{h}{2}\\right)\\cos\\!\\left(\\frac{h}{2}\\right).\n$$\nThe exact integral is\n$$\n\\int_{t_{i}}^{t_{i}+h}\\sin t\\,dt=\\cos(t_{i})-\\cos(t_{i}+h)\n=2\\sin\\!\\left(\\frac{h}{2}\\right)\\sin\\!\\left(t_{i}+\\frac{h}{2}\\right).\n$$\nTheir difference is\n$$\n\\sin\\!\\left(t_{i}+\\frac{h}{2}\\right)\\left[h\\cos\\!\\left(\\frac{h}{2}\\right)-2\\sin\\!\\left(\\frac{h}{2}\\right)\\right],\n$$\nwhich is not identically zero for arbitrary $h$, so not exact.\n\nCase E: $f(t,y)=\\exp(y)$ (nonlinear in $y$).\nHeun is a second-order method with local truncation error of order $h^{3}$ for general nonlinear $f$. It is not exact for generic $h$ when $f$ depends nonlinearly on $y$. A simple contrast: for $f(t,y)=a y$ (a simpler linear-in-$y$ case), Heun already fails to be exact as shown in Case B; thus it cannot be exact for the more nonlinear $f(t,y)=\\exp(y)$.\n\nTherefore, only when $f$ is independent of $y$ and linear in $t$, i.e., $f(t,y)=at+b$, does Heun’s method produce the exact analytical solution for any initial condition and any non-zero step size.", "answer": "$$\\boxed{A}$$", "id": "2200981"}]}