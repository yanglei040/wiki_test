{"hands_on_practices": [{"introduction": "To begin, let's dissect the core mechanism of an implicit method. Unlike explicit methods that calculate the future state directly from the current one, implicit methods define the future state through an equation that includes the future state itself. This first exercise applies the implicit midpoint rule to a simple linear ODE, allowing you to derive an explicit formula for the next step, $y_{n+1}$, by solving a straightforward algebraic equation. This practice is fundamental to understanding how an implicit update is constructed and solved. [@problem_id:2178584]", "problem": "In computational physics, many problems require the numerical solution of Ordinary Differential Equations (ODEs). Consider a simplified model for the temperature, $y(t)$, of an electronic component over time. The rate of change of its temperature is described by the linear first-order ODE:\n$$ \\frac{dy}{dt} = ay + b $$\nwhere $y_n$ represents the known temperature at time $t_n$, and $a$ and $b$ are real constants determined by the component's physical properties and its environment.\n\nTo approximate the solution numerically, we can use an implicit method. One such method is the implicit midpoint rule, which calculates the state at the next time step, $y_{n+1} = y(t_n + h)$, using the formula:\n$$ y_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) $$\nHere, $h$ is the constant time step size, and $f(t,y)$ is the function defining the ODE, i.e., $f(t,y) = \\frac{dy}{dt}$.\n\nBy applying a single step of the implicit midpoint rule to the given ODE, derive an explicit analytical expression for $y_{n+1}$ in terms of $y_n$, $h$, $a$, and $b$.", "solution": "We start with the ODE $ \\frac{dy}{dt} = a y + b $ and apply the implicit midpoint rule\n$$\ny_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right).\n$$\nHere $f(t,y) = a y + b$ is autonomous (independent of $t$), so\n$$\nf\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) = a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b.\n$$\nSubstituting into the update formula gives\n$$\ny_{n+1} = y_n + h \\left[ a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b \\right].\n$$\nExpanding and collecting terms in $y_{n+1}$,\n$$\ny_{n+1} = y_n + \\frac{a h}{2} y_n + \\frac{a h}{2} y_{n+1} + h b,\n$$\nwhich implies\n$$\n\\left(1 - \\frac{a h}{2}\\right) y_{n+1} = \\left(1 + \\frac{a h}{2}\\right) y_n + h b.\n$$\nSolving for $y_{n+1}$ yields the explicit analytical expression\n$$\ny_{n+1} = \\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}}$$", "id": "2178584"}, {"introduction": "Real-world systems are rarely linear. This next practice demonstrates how implicit methods are applied to nonlinear dynamics, using the classic logistic equation for population growth as a model. Applying the Backward Euler method here leads to a nonlinear algebraic equation—in this case, a quadratic—for the next population state, $P_{n+1}$. This exercise not only builds on the previous one but also introduces the important consideration of selecting the physically meaningful solution from multiple mathematical possibilities. [@problem_id:2178610]", "problem": "In computational science, the logistic growth model is a common example for studying population dynamics. The model is described by the first-order Ordinary Differential Equation (ODE), $P'(t) = r P(t) \\left(1 - \\frac{P(t)}{K}\\right)$, where $P(t)$ is the population at time $t$, $r  0$ is the intrinsic growth rate, and $K  0$ is the environmental carrying capacity.\n\nTo numerically approximate the solution, we can use an implicit method like the Backward Euler method. We discretize time with a constant step size $h  0$, letting $t_n = n h$. The numerical approximation of the population at time $t_n$ is denoted by $P_n$. The Backward Euler method for a general ODE of the form $y' = f(t, y)$ is given by the formula $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$.\n\nWhen this method is applied to the logistic equation, it results in a nonlinear algebraic equation for $P_{n+1}$ at each time step. Your task is to solve this equation to find an explicit formula for $P_{n+1}$ in terms of the known previous state $P_n$ and the parameters $h, r, K$. For a physically meaningful population model, we require that the population $P_{n+1}$ remains non-negative and that in the limit of a very small time step ($h \\rightarrow 0$), the next state should converge to the current state ($P_{n+1} \\rightarrow P_n$). Use this physical consideration to select the correct solution if more than one mathematical solution exists.", "solution": "We start from the logistic differential equation $P'(t) = r P(t)\\left(1 - \\frac{P(t)}{K}\\right)$ and apply the Backward Euler method, which for a general ODE $y' = f(t,y)$ is given by $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$. For the logistic equation, $f(t,y) = r y \\left(1 - \\frac{y}{K}\\right)$, so the Backward Euler update for $P_{n+1}$ is\n$$\nP_{n+1} = P_n + h r P_{n+1} \\left(1 - \\frac{P_{n+1}}{K}\\right).\n$$\nLet $X := P_{n+1}$. Rearranging gives\n$$\nX = P_n + h r X - \\frac{h r}{K} X^{2}.\n$$\nBring all terms to one side to obtain a quadratic equation in $X$:\n$$\n- \\frac{h r}{K} X^{2} + (h r - 1) X + P_n = 0.\n$$\nMultiplying through by $-K$ to simplify coefficients yields\n$$\nh r X^{2} + K (1 - h r) X - K P_n = 0.\n$$\nThis is a quadratic equation $a X^{2} + b X + c = 0$ with $a = h r$, $b = K (1 - h r)$, and $c = - K P_n$. By the quadratic formula,\n$$\nX = \\frac{ - b \\pm \\sqrt{ b^{2} - 4 a c } }{ 2 a } = \\frac{ - K (1 - h r) \\pm \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\nTo select the physically meaningful root, we impose the conditions that $P_{n+1} \\geq 0$ and that as $h \\to 0$, we have $P_{n+1} \\to P_n$. Consider the two branches:\n\n1) With the plus sign:\n$$\nX_{+} = \\frac{ - K (1 - h r) + \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\nFor small $h$, expand the square root using $\\sqrt{A^{2} + \\epsilon} \\approx A + \\frac{\\epsilon}{2 A}$ with $A = K (1 - h r)$ and $\\epsilon = 4 h r K P_n$, giving\n$$\nX_{+} \\approx \\frac{ - A + \\left( A + \\frac{ \\epsilon }{ 2 A } \\right) }{ 2 h r } = \\frac{ \\epsilon }{ 4 A h r } = \\frac{ 4 h r K P_n }{ 4 K (1 - h r) h r } = \\frac{ P_n }{ 1 - h r } \\to P_n \\quad \\text{as } h \\to 0,\n$$\nwhich satisfies the required limit. Moreover, for $P_n \\geq 0$, the radicand is at least $K^{2} (1 - h r)^{2}$, so the numerator is nonnegative and thus $X_{+} \\geq 0$.\n\n2) With the minus sign:\n$$\nX_{-} = \\frac{ - K (1 - h r) - \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\nAs $h \\to 0$, $X_{-} \\sim - \\frac{ K }{ h r } \\to - \\infty$, which violates both the nonnegativity and the continuity requirement $P_{n+1} \\to P_n$.\n\nTherefore, the correct physically meaningful solution is the plus branch. Writing it in a slightly factored form gives\n$$\nP_{n+1} = \\frac{K}{2 h r} \\left( - (1 - h r) + \\sqrt{ (1 - h r)^{2} + \\frac{ 4 h r }{ K } P_n } \\right).\n$$\nThis expression yields $P_{n+1} \\geq 0$ for $P_n \\geq 0$ and satisfies $P_{n+1} \\to P_n$ as $h \\to 0$, as required.", "answer": "$$\\boxed{\\frac{K}{2 h r}\\left(-\\left(1-h r\\right)+\\sqrt{\\left(1-h r\\right)^{2}+\\frac{4 h r}{K}P_{n}}\\right)}$$", "id": "2178610"}, {"introduction": "Here we confront the central trade-off when using implicit methods for stiff ODEs. While implicit schemes offer excellent stability, allowing for large time steps, the algebraic equation at each step must still be solved efficiently. This crucial exercise investigates the conditions under which a simple fixed-point iteration—a common technique for solving such equations—will converge. By analyzing a model stiff problem, you will discover why this simple approach fails for large step sizes, revealing the hidden computational challenge that motivates the use of more advanced solvers like Newton's method. [@problem_id:2178627]", "problem": "Consider the numerical solution of a first-order Ordinary Differential Equation (ODE) that models a system's state, $y(t)$, which rapidly adjusts to a time-varying external signal, $g(t)$. The dynamics are described by the equation:\n$$ y'(t) = \\alpha (g(t) - y(t)) $$\nHere, $\\alpha$ is a large, positive constant, which makes the equation \"stiff\".\n\nTo solve this ODE numerically, we apply the Backward Euler method, which is an implicit scheme defined by:\n$$ y_{n+1} = y_n + h f(t_{n+1}, y_{n+1}) $$\nwhere $y_n \\approx y(t_n)$, $h$ is the time step, and $f(t,y) = \\alpha (g(t) - y)$.\n\nTo solve the implicit equation for $y_{n+1}$ at each time step, a simple fixed-point iteration is used. Starting from an initial guess $y_{n+1}^{(0)}$, the iteration proceeds as:\n$$ y_{n+1}^{(k+1)} = y_n + h \\alpha (g(t_{n+1}) - y_{n+1}^{(k)}) $$\nwhere $k=0, 1, 2, \\dots$ is the iteration index.\n\nFor this fixed-point iteration to be guaranteed to converge to the correct value of $y_{n+1}$ regardless of the initial guess, the step size $h$ must be strictly less than a certain critical value, which we will call $h_{crit}$. This critical value depends on the system's parameters.\n\nDetermine the expression for this critical step size $h_{crit}$ in terms of the parameter $\\alpha$.", "solution": "We begin from the Backward Euler step for the ODE $y'(t)=\\alpha\\left(g(t)-y(t)\\right)$:\n$$\ny_{n+1}=y_{n}+h\\,\\alpha\\left(g(t_{n+1})-y_{n+1}\\right).\n$$\nDefine the fixed-point mapping used in the iteration as\n$$\nF(y):=y_{n}+h\\,\\alpha\\left(g(t_{n+1})-y\\right)=y_{n}+h\\,\\alpha\\,g(t_{n+1})-h\\,\\alpha\\,y.\n$$\nThe fixed-point iteration is $y_{n+1}^{(k+1)}=F\\!\\left(y_{n+1}^{(k)}\\right)$, and the fixed point $y_{n+1}^{\\ast}$ satisfies\n$$\ny_{n+1}^{\\ast}=F\\!\\left(y_{n+1}^{\\ast}\\right).\n$$\nTo ensure convergence for any initial guess, $F$ must be a contraction on $\\mathbb{R}$. By the Banach fixed-point theorem, a sufficient (and in this linear case, necessary) condition is that the Lipschitz constant $L$ of $F$ satisfies $L1$. Since $F$ is differentiable and linear in $y$, we compute\n$$\nF'(y)=-h\\,\\alpha,\n$$\nso the Lipschitz constant is\n$$\nL=\\sup_{y\\in\\mathbb{R}}|F'(y)|=|{-h\\,\\alpha}|=h\\,\\alpha.\n$$\nTherefore, the iteration converges for any initial guess if and only if\n$$\nh\\,\\alpha1.\n$$\nEquivalently, the critical step size is\n$$\nh_{\\text{crit}}=\\frac{1}{\\alpha},\n$$\nand the requirement is $hh_{\\text{crit}}$.\n\nAn equivalent error analysis yields the same condition: letting $e^{(k)}=y_{n+1}^{(k)}-y_{n+1}^{\\ast}$, one has\n$$\ne^{(k+1)}=F\\!\\left(y_{n+1}^{(k)}\\right)-F\\!\\left(y_{n+1}^{\\ast}\\right)=-h\\,\\alpha\\,e^{(k)},\n$$\nso $|e^{(k+1)}|=h\\,\\alpha\\,|e^{(k)}|$ tends to zero if and only if $h\\,\\alpha1$, giving the same $h_{\\text{crit}}=\\frac{1}{\\alpha}$.", "answer": "$$\\boxed{\\frac{1}{\\alpha}}$$", "id": "2178627"}]}