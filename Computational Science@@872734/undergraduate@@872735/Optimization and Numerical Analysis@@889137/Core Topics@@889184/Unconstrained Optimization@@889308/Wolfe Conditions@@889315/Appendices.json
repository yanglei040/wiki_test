{"hands_on_practices": [{"introduction": "Before delving into the subtleties of line search algorithms, it's essential to master the fundamental mechanics of the Wolfe conditions. This first practice provides a direct application of the conditions in a multidimensional setting. By working through the calculations for a given point, search direction, and step length, you will solidify your understanding of how to verify both the sufficient decrease (Armijo) and curvature conditions using vector calculus [@problem_id:2226157].", "problem": "In numerical optimization, line search algorithms iteratively find a minimum of a function $f: \\mathbb{R}^n \\to \\mathbb{R}$ by choosing a search direction $p_k$ from a point $x_k$ and then finding a suitable step length $\\alpha  0$ that minimizes $f(x_k + \\alpha p_k)$. The Wolfe conditions are a pair of inequalities that define what constitutes a \"suitable\" step length.\n\nConsider the objective function $f(x_1, x_2) = 2x_1^2 + 3x_2^2$. We are at the point $x_k = (3, -2)^T$ and choose the steepest descent direction for our search direction $p_k$. We want to test a potential step length of $\\alpha = 0.1$.\n\nThe Wolfe conditions for a given step length $\\alpha$ are:\n1.  **Armijo (Sufficient Decrease) Condition**: $f(x_k + \\alpha p_k) \\le f(x_k) + c_1 \\alpha \\nabla f(x_k)^T p_k$\n2.  **Curvature Condition**: $\\nabla f(x_k + \\alpha p_k)^T p_k \\ge c_2 \\nabla f(x_k)^T p_k$\n\nUsing the standard constants $c_1 = 10^{-4}$ and $c_2 = 0.9$, determine which of these conditions are satisfied for the step length $\\alpha = 0.1$.\n\nA. Only the Armijo condition is satisfied.\nB. Only the Curvature condition is satisfied.\nC. Both the Armijo and Curvature conditions are satisfied.\nD. Neither the Armijo nor the Curvature condition is satisfied.", "solution": "We use steepest descent, so the search direction is the negative gradient. The objective is $f(x_{1},x_{2})=2x_{1}^{2}+3x_{2}^{2}$, hence\n$$\n\\nabla f(x)=\\begin{pmatrix}\\frac{\\partial f}{\\partial x_{1}}\\\\[4pt]\\frac{\\partial f}{\\partial x_{2}}\\end{pmatrix}\n=\\begin{pmatrix}4x_{1}\\\\[2pt]6x_{2}\\end{pmatrix}.\n$$\nAt $x_{k}=\\begin{pmatrix}3\\\\ -2\\end{pmatrix}$ we have\n$$\n\\nabla f(x_{k})=\\begin{pmatrix}12\\\\ -12\\end{pmatrix},\\quad p_{k}=-\\nabla f(x_{k})=\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}.\n$$\nCompute the baseline function value and directional derivative:\n$$\nf(x_{k})=2\\cdot 3^{2}+3\\cdot(-2)^{2}=18+12=30,\\quad \\nabla f(x_{k})^{T}p_{k}=\\begin{pmatrix}12  -12\\end{pmatrix}\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}=-288.\n$$\nFor $\\alpha=0.1$, the trial point is\n$$\nx_{k}+\\alpha p_{k}=\\begin{pmatrix}3\\\\ -2\\end{pmatrix}+0.1\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}=\\begin{pmatrix}1.8\\\\ -0.8\\end{pmatrix}.\n$$\nEvaluate $f$ at the trial point:\n$$\nf(x_{k}+\\alpha p_{k})=2\\cdot (1.8)^{2}+3\\cdot (-0.8)^{2}=2\\cdot 3.24+3\\cdot 0.64=6.48+1.92=8.4.\n$$\nArmijo condition with $c_{1}=10^{-4}$ requires\n$$\nf(x_{k}+\\alpha p_{k})\\le f(x_{k})+c_{1}\\alpha\\,\\nabla f(x_{k})^{T}p_{k}.\n$$\nThe right-hand side equals\n$$\n30+(10^{-4})(0.1)(-288)=30-2.88\\times 10^{-3}=29.99712,\n$$\nand since $8.4\\le 29.99712$, the Armijo condition is satisfied.\n\nFor the curvature condition with $c_{2}=0.9$, compute the new gradient and its directional derivative:\n$$\n\\nabla f(x_{k}+\\alpha p_{k})=\\begin{pmatrix}4\\cdot 1.8\\\\ 6\\cdot (-0.8)\\end{pmatrix}=\\begin{pmatrix}7.2\\\\ -4.8\\end{pmatrix},\n$$\n$$\n\\nabla f(x_{k}+\\alpha p_{k})^{T}p_{k}=\\begin{pmatrix}7.2  -4.8\\end{pmatrix}\\begin{pmatrix}-12\\\\ 12\\end{pmatrix}=-86.4-57.6=-144.\n$$\nThe curvature condition requires\n$$\n\\nabla f(x_{k}+\\alpha p_{k})^{T}p_{k}\\ge c_{2}\\,\\nabla f(x_{k})^{T}p_{k}=0.9\\cdot(-288)=-259.2.\n$$\nSince $-144\\ge -259.2$, the curvature condition is also satisfied.\n\nTherefore, both Wolfe conditions are satisfied for $\\alpha=0.1$.", "answer": "$$\\boxed{C}$$", "id": "2226157"}, {"introduction": "The two Wolfe conditions are designed to work in harmony, preventing steps that are either too long or too short. This exercise demonstrates why both are necessary by exploring a scenario where one condition holds but the other fails [@problem_id:2226203]. By analyzing a step that provides sufficient decrease but fails the curvature test, you will gain insight into how the curvature condition is crucial for avoiding inefficiently small steps that make negligible progress.", "problem": "In numerical optimization, line search algorithms iteratively find a minimum of an objective function $f(\\mathbf{x})$ by choosing a descent direction $\\mathbf{p}_k$ from the current point $\\mathbf{x}_k$ and then finding a suitable step length $\\alpha_k  0$ to define the next point $\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\alpha_k \\mathbf{p}_k$.\n\nThe Wolfe conditions are a pair of inequalities used to determine if a step length $\\alpha$ is acceptable. For a one-dimensional function $f(x)$ with derivative $f'(x)$, a step length $\\alpha  0$ taken from a point $x_k$ along a descent direction $p_k$ (where $f'(x_k) p_k  0$) is considered acceptable if it satisfies both:\n\n1.  **Sufficient Decrease (Armijo) Condition:**\n    $f(x_k + \\alpha p_k) \\le f(x_k) + c_1 \\alpha f'(x_k) p_k$\n\n2.  **Curvature Condition:**\n    $f'(x_k + \\alpha p_k) p_k \\ge c_2 f'(x_k) p_k$\n\nThese conditions ensure that the step length leads to a sufficient decrease in the function value while also preventing steps that are excessively short.\n\nConsider the one-dimensional objective function $f(x) = \\frac{1}{4}x^4 - \\frac{3}{2}x^2$. For the constants $c_1=0.1$ and $c_2=0.5$, which of the following tuples $(x_k, p_k, \\alpha)$ represents a trial step that satisfies the Armijo condition but *fails* the curvature condition?\n\nA. $(x_k, p_k, \\alpha) = (2, -1, 0.1)$\nB. $(x_k, p_k, \\alpha) = (2, -1, 0.5)$\nC. $(x_k, p_k, \\alpha) = (2, -1, 1.0)$\nD. $(x_k, p_k, \\alpha) = (1, 1, 1.0)$", "solution": "The objective is $f(x) = \\frac{1}{4}x^{4} - \\frac{3}{2}x^{2}$, so its derivative is $f'(x) = x^{3} - 3x$. The Wolfe conditions for a trial $(x_{k},p_{k},\\alpha)$ with $f'(x_{k})p_{k}  0$ are:\n- Armijo: $f(x_{k}+\\alpha p_{k}) \\le f(x_{k}) + c_{1}\\alpha f'(x_{k})p_{k}$,\n- Curvature: $f'(x_{k}+\\alpha p_{k})p_{k} \\ge c_{2} f'(x_{k})p_{k}$,\nwith $c_{1} = 0.1$ and $c_{2} = 0.5$.\n\nConsider options with $x_{k} = 2$, $p_{k} = -1$. We have $f(2) = \\frac{1}{4}\\cdot 16 - \\frac{3}{2}\\cdot 4 = 4 - 6 = -2$ and $f'(2) = 8 - 6 = 2$, so $f'(2)p_{k} = 2\\cdot(-1) = -2  0$, confirming descent.\n\nFor a general $\\alpha  0$ with $t = 2 - \\alpha$,\n$$\nt^{2} = (2 - \\alpha)^{2} = 4 - 4\\alpha + \\alpha^{2},\\quad\nt^{4} = (4 - 4\\alpha + \\alpha^{2})^{2} = 16 - 32\\alpha + 24\\alpha^{2} - 8\\alpha^{3} + \\alpha^{4},\n$$\n$$\nf(2-\\alpha) = \\frac{1}{4}t^{4} - \\frac{3}{2}t^{2} = -2 - 2\\alpha + \\frac{9}{2}\\alpha^{2} - 2\\alpha^{3} + \\frac{1}{4}\\alpha^{4},\n$$\n$$\nf'(2-\\alpha) = (2 - \\alpha)^{3} - 3(2 - \\alpha) = 2 - 9\\alpha + 6\\alpha^{2} - \\alpha^{3}.\n$$\nThe Armijo right-hand side is $f(2) + c_{1}\\alpha f'(2)p_{k} = -2 + 0.1\\alpha\\cdot 2\\cdot(-1) = -2 - \\frac{1}{5}\\alpha$. The curvature condition becomes $-f'(2-\\alpha) \\ge -1$, equivalently $f'(2-\\alpha) \\le 1$.\n\nEvaluate each option:\n\nA. $(x_{k},p_{k},\\alpha) = (2,-1,0.1)$.\n- Armijo: \n$$\nf(2-0.1) = -2 - \\frac{1}{5} + \\frac{9}{200} - \\frac{1}{500} + \\frac{1}{40000} = -\\frac{86279}{40000} \\le -2 - \\frac{1}{5}\\cdot 0.1 = -2 - \\frac{1}{50} = -\\frac{101}{50},\n$$\nso Armijo holds.\n- Curvature:\n$$\nf'(2-0.1) = 2 - \\frac{9}{10} + \\frac{6}{100} - \\frac{1}{1000} = 1.159  1,\n$$\nhence $f'(2-0.1)p_{k} = -1.159 \\not\\ge -1$, so curvature fails.\n\nB. $(2,-1,0.5)$.\n- Armijo:\n$$\nf(1.5) = -\\frac{135}{64} \\le -2 - \\frac{1}{10} = -\\frac{21}{10},\n$$\nso Armijo holds.\n- Curvature:\n$$\nf'(1.5) = -1.125,\\quad f'(1.5)p_{k} = 1.125 \\ge -1,\n$$\nso curvature holds. Not acceptable.\n\nC. $(2,-1,1.0)$.\n- Armijo:\n$$\nf(1) = -\\frac{5}{4} \\le -2 - \\frac{1}{5} \\quad \\text{is false},\n$$\nso Armijo fails. Not acceptable.\n\nD. $(1,1,1.0)$.\nHere $f'(1) = -2$, so $f'(1)p_{k} = -2  0$ is descent.\n- Armijo:\n$$\nf(2) = -2 \\le f(1) + 0.1\\cdot 1 \\cdot (-2) = -\\frac{5}{4} - \\frac{1}{5} = -\\frac{29}{20},\n$$\nso Armijo holds.\n- Curvature:\n$$\nf'(2)p_{k} = 2 \\ge 0.5\\cdot (-2)\\cdot 1 = -1,\n$$\nso curvature holds. Not acceptable.\n\nOnly option A satisfies Armijo but fails the curvature condition.", "answer": "$$\\boxed{A}$$", "id": "2226203"}, {"introduction": "The ultimate purpose of the Wolfe conditions is to guide an algorithm in *finding* an acceptable step length, not just verifying a pre-selected one. This final practice simulates a core part of a realistic line search algorithmâ€”the 'zoom' phase [@problem_id:2226137]. By iteratively applying the conditions to narrow down an interval, you will see how these theoretical rules translate into a powerful, practical procedure for ensuring efficient and reliable convergence in optimization.", "problem": "In numerical optimization, a line search algorithm seeks to find a suitable step length $\\alpha  0$ along a given search direction. The strong Wolfe conditions are a popular set of criteria for terminating the line search. They ensure both sufficient decrease in the objective function and a sufficient decrease in the magnitude of the projected gradient.\n\nConsider a a one-dimensional search function $\\phi(\\alpha)$ which represents the value of an objective function along a search direction, starting from a point where $\\phi(0) = 5$ and the directional derivative is $\\phi'(0) = -12$. The function is given by the cubic polynomial:\n$$\n\\phi(\\alpha) = 2\\alpha^3 - 3\\alpha^2 - 12\\alpha + 5\n$$\nThe strong Wolfe conditions are defined as:\n1.  **Sufficient Decrease Condition**: $\\phi(\\alpha) \\le \\phi(0) + c_1 \\alpha \\phi'(0)$\n2.  **Strong Curvature Condition**: $|\\phi'(\\alpha)| \\le c_2 |\\phi'(0)|$\n\nFor this problem, use the constants $c_1 = \\frac{1}{10}$ and $c_2 = \\frac{1}{2}$.\n\nA line search algorithm has first performed a bracketing phase and found an initial interval $[\\alpha_{lo}, \\alpha_{hi}] = [1, 4]$. This interval is known to satisfy the standard entry requirements for the 'zoom' phase of the algorithm: the sufficient decrease condition holds for $\\alpha_{lo}$, while it is violated for $\\alpha_{hi}$.\n\nYou are to trace the 'zoom' phase to find an acceptable step length. In each iteration, a trial step length $\\alpha_j$ is selected by taking the midpoint (bisection) of the current interval $[\\alpha_{lo}, \\alpha_{hi}]$. The interval is then updated according to the following rules:\n\n*   **Rule A**: If the sufficient decrease condition is violated at the trial point $\\alpha_j$, the new interval becomes $[\\alpha_{lo}, \\alpha_j]$.\n*   **Rule B**: If the sufficient decrease condition is satisfied at $\\alpha_j$:\n    1.  Check if the strong curvature condition is also satisfied. If it is, the search terminates and $\\alpha_j$ is the solution.\n    2.  If the curvature condition is violated, check the sign of the derivative $\\phi'(\\alpha_j)$.\n        *   If $\\phi'(\\alpha_j) \\ge 0$, the new interval becomes $[\\alpha_{lo}, \\alpha_j]$.\n        *   If $\\phi'(\\alpha_j)  0$, the new interval becomes $[\\alpha_j, \\alpha_{hi}]$.\n\nDetermine the first value of $\\alpha$ found by this procedure that satisfies both strong Wolfe conditions. Express your final answer as an exact fraction.", "solution": "We are given $\\phi(\\alpha)=2\\alpha^{3}-3\\alpha^{2}-12\\alpha+5$ with $\\phi(0)=5$ and $\\phi'(0)=-12$. Its derivative is\n$$\n\\phi'(\\alpha)=6\\alpha^{2}-6\\alpha-12=6(\\alpha-2)(\\alpha+1).\n$$\nThe strong Wolfe constants are $c_{1}=\\frac{1}{10}$ and $c_{2}=\\frac{1}{2}$. Thus the sufficient decrease condition is\n$$\n\\phi(\\alpha)\\leq \\phi(0)+c_{1}\\alpha\\phi'(0)=5-\\frac{6}{5}\\alpha,\n$$\nand the strong curvature condition is\n$$\n|\\phi'(\\alpha)|\\leq c_{2}|\\phi'(0)|=6.\n$$\n\nFirst, verify the bracketing interval $[\\alpha_{lo},\\alpha_{hi}]=[1,4]$:\n- At $\\alpha=1$, compute $\\phi(1)=2-3-12+5=-8$ and the right-hand side $5-\\frac{6}{5}\\cdot 1=\\frac{19}{5}$. Since $-8\\leq \\frac{19}{5}$, the sufficient decrease condition holds at $\\alpha_{lo}=1$.\n- At $\\alpha=4$, compute $\\phi(4)=128-48-48+5=37$ and the right-hand side $5-\\frac{6}{5}\\cdot 4=\\frac{1}{5}$. Since $37\\leq \\frac{1}{5}$ is false, the sufficient decrease condition is violated at $\\alpha_{hi}=4$.\nThus the entry conditions for zoom are satisfied.\n\nZoom iteration 1 (bisection):\n- Trial $\\alpha_{1}=\\frac{1+4}{2}=\\frac{5}{2}$. Evaluate $\\phi\\!\\left(\\frac{5}{2}\\right)$:\n$$\n\\phi\\!\\left(\\frac{5}{2}\\right)=2\\left(\\frac{125}{8}\\right)-3\\left(\\frac{25}{4}\\right)-12\\left(\\frac{5}{2}\\right)+5=\\frac{125}{4}-\\frac{75}{4}-30+5=-\\frac{25}{2}.\n$$\nThe sufficient decrease right-hand side is $5-\\frac{6}{5}\\cdot \\frac{5}{2}=2$. Since $-\\frac{25}{2}\\leq 2$, the sufficient decrease condition holds.\n- Check curvature at $\\alpha_{1}$:\n$$\n\\phi'\\!\\left(\\frac{5}{2}\\right)=6\\left(\\frac{5}{2}-2\\right)\\left(\\frac{5}{2}+1\\right)=6\\left(\\frac{1}{2}\\right)\\left(\\frac{7}{2}\\right)=\\frac{21}{2},\n$$\nso $|\\phi'\\!\\left(\\frac{5}{2}\\right)|=\\frac{21}{2}6$, and the strong curvature condition is violated. Since $\\phi'\\!\\left(\\frac{5}{2}\\right)\\geq 0$, apply Rule B with nonnegative derivative, setting the new interval to $[\\alpha_{lo},\\alpha_{1}]=\\left[1,\\frac{5}{2}\\right]$.\n\nZoom iteration 2 (bisection):\n- Trial $\\alpha_{2}=\\frac{1+\\frac{5}{2}}{2}=\\frac{7}{4}$. Evaluate $\\phi\\!\\left(\\frac{7}{4}\\right)$:\n$$\n\\phi\\!\\left(\\frac{7}{4}\\right)=2\\left(\\frac{343}{64}\\right)-3\\left(\\frac{49}{16}\\right)-12\\left(\\frac{7}{4}\\right)+5=\\frac{343}{32}-\\frac{147}{16}-21+5=-\\frac{463}{32}.\n$$\nThe sufficient decrease right-hand side is $5-\\frac{6}{5}\\cdot \\frac{7}{4}=\\frac{29}{10}$. Since $-\\frac{463}{32}\\leq \\frac{29}{10}$, the sufficient decrease condition holds.\n- Check curvature at $\\alpha_{2}$:\n$$\n\\phi'\\!\\left(\\frac{7}{4}\\right)=6\\left(\\frac{7}{4}-2\\right)\\left(\\frac{7}{4}+1\\right)=6\\left(-\\frac{1}{4}\\right)\\left(\\frac{11}{4}\\right)=-\\frac{33}{8},\n$$\nso $|\\phi'\\!\\left(\\frac{7}{4}\\right)|=\\frac{33}{8}\\leq 6$ because $\\frac{33}{8}\\leq \\frac{48}{8}$. Therefore, the strong curvature condition holds.\n\nSince both strong Wolfe conditions are satisfied at $\\alpha=\\frac{7}{4}$, the zoom phase terminates with this step length as the first acceptable value found by the procedure.", "answer": "$$\\boxed{\\frac{7}{4}}$$", "id": "2226137"}]}