{"hands_on_practices": [{"introduction": "Let's begin with a foundational problem in data fitting: finding the best polynomial to describe a set of observations. This exercise will guide you through setting up and solving a least-squares problem, a cornerstone of numerical analysis, but with a practical twist—enforcing a physical constraint that the model must pass through the origin [@problem_id:2212195]. This practice builds your core skills in formulating and solving the normal equations that arise from such optimization tasks.", "problem": "An engineer is modeling the vertical displacement, $y$, of a particle as a function of time, $t$. The particle starts from rest at the origin, so it is known that the displacement is zero at time zero. A simplified theoretical model for the displacement is given by a quadratic function of time that passes through the origin: $p(t) = a_1 t + a_2 t^2$. The time $t$ is measured in seconds (s) and the displacement $y$ in meters (m).\n\nTo determine the unknown coefficients $a_1$ and $a_2$, an experiment is conducted, yielding the following four data points $(t_i, y_i)$:\n(1.0, 2.3), (2.0, 8.8), (3.0, 19.1), (4.0, 34.2)\n\nDetermine the values of the coefficients $a_1$ and $a_2$ that provide the best fit to this data in the least-squares sense. The \"best fit\" is defined as the set of coefficients that minimizes the sum of squared residuals, $S = \\sum_{i=1}^{4} [y_i - p(t_i)]^2$.\n\nReport the numerical values of $a_1$ (in m/s) and $a_2$ (in m/s$^2$) in this specified order. Round your final answers to three significant figures.", "solution": "We model the displacement as $p(t)=a_{1}t+a_{2}t^{2}$ and determine $a_{1},a_{2}$ by minimizing the sum of squared residuals\n$$\nS(a_{1},a_{2})=\\sum_{i=1}^{4}\\left[y_{i}-\\left(a_{1}t_{i}+a_{2}t_{i}^{2}\\right)\\right]^{2}.\n$$\nSetting the partial derivatives to zero gives the normal equations\n$$\n\\frac{\\partial S}{\\partial a_{1}}=-2\\sum_{i=1}^{4}t_{i}\\left[y_{i}-a_{1}t_{i}-a_{2}t_{i}^{2}\\right]=0,\\quad\n\\frac{\\partial S}{\\partial a_{2}}=-2\\sum_{i=1}^{4}t_{i}^{2}\\left[y_{i}-a_{1}t_{i}-a_{2}t_{i}^{2}\\right]=0.\n$$\nRearranging yields\n$$\na_{1}\\sum_{i=1}^{4}t_{i}^{2}+a_{2}\\sum_{i=1}^{4}t_{i}^{3}=\\sum_{i=1}^{4}t_{i}y_{i},\\qquad\na_{1}\\sum_{i=1}^{4}t_{i}^{3}+a_{2}\\sum_{i=1}^{4}t_{i}^{4}=\\sum_{i=1}^{4}t_{i}^{2}y_{i}.\n$$\nWith data $(t_{i},y_{i})=(1,2.3),(2,8.8),(3,19.1),(4,34.2)$, compute the sums\n$$\n\\sum t_{i}^{2}=1+4+9+16=30,\\quad \\sum t_{i}^{3}=1+8+27+64=100,\\quad \\sum t_{i}^{4}=1+16+81+256=354,\n$$\n$$\n\\sum t_{i}y_{i}=1\\cdot 2.3+2\\cdot 8.8+3\\cdot 19.1+4\\cdot 34.2=214,\n$$\n$$\n\\sum t_{i}^{2}y_{i}=1^{2}\\cdot 2.3+2^{2}\\cdot 8.8+3^{2}\\cdot 19.1+4^{2}\\cdot 34.2=756.6.\n$$\nThus the normal equations become\n$$\n30a_{1}+100a_{2}=214,\\qquad 100a_{1}+354a_{2}=756.6.\n$$\nSolve this $2\\times 2$ system. The determinant is\n$$\nD=30\\cdot 354-100\\cdot 100=10620-10000=620.\n$$\nBy Cramer’s rule,\n$$\na_{1}=\\frac{\\begin{vmatrix}214 & 100\\\\ 756.6 & 354\\end{vmatrix}}{D}=\\frac{214\\cdot 354-100\\cdot 756.6}{620}=\\frac{75756-75660}{620}=\\frac{96}{620}=\\frac{24}{155},\n$$\n$$\na_{2}=\\frac{\\begin{vmatrix}30 & 214\\\\ 100 & 756.6\\end{vmatrix}}{D}=\\frac{30\\cdot 756.6-100\\cdot 214}{620}=\\frac{22698-21400}{620}=\\frac{1298}{620}=\\frac{649}{310}.\n$$\nConvert to decimals and round to three significant figures as required:\n$$\na_{1}\\approx 0.155,\\qquad a_{2}\\approx 2.09.\n$$\nThese have units of meters per second and meters per second squared, respectively, as consistent with the model $p(t)=a_{1}t+a_{2}t^{2}$.", "answer": "$$\\boxed{\\begin{pmatrix}0.155 & 2.09\\end{pmatrix}}$$", "id": "2212195"}, {"introduction": "Standard least-squares fitting assumes that errors only exist in the dependent variable (the '$y$-axis'). This practice introduces a more realistic and robust scenario where both variables are subject to measurement error [@problem_id:2212231]. You will explore the concept of Total Least Squares, where the goal is to minimize the perpendicular distance from data points to the fitted line, providing a more geometrically intuitive and often more accurate model.", "problem": "A physics undergraduate is studying the motion of a small bead on a nearly frictionless, straight wire. A theoretical model predicts a linear relationship between the bead's position, $p$, and an experimental control parameter, time $t$, given by the equation $p = mt + c$. To test this theory and determine the constants $m$ and $c$, the student collects a series of data points. However, due to inherent limitations in the measurement apparatus, both the position readings and the time measurements are subject to random experimental errors.\n\nThe student decides to find the \"best-fit\" line by employing a method that accounts for errors in both variables. This method defines the best-fit line as the one that minimizes the sum of the squared *perpendicular* distances from each data point to the line.\n\nThe collected experimental data, consisting of four $(t, p)$ pairs, is as follows:\n(2 s, 3 m), (4 s, 8 m), (7 s, 10 m), (9 s, 15 m).\n\nUsing this data, calculate the slope $m$ and the intercept $c$ of the best-fit line defined by minimizing the sum of squared perpendicular distances. Report your answer for the slope in units of m/s and for the intercept in units of m. Round your final answers to four significant figures.", "solution": "We model the data by the line $p = m t + c$ and define the sum of squared perpendicular distances to be minimized as\n$$\nF(m,c) = \\sum_{i=1}^{n} \\frac{(m t_{i} - p_{i} + c)^{2}}{m^{2} + 1}.\n$$\nSetting $\\partial F/\\partial c=0$ gives\n$$\n\\frac{2}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i} - p_{i} + c\\right)=0 \\quad\\Longrightarrow\\quad c=\\bar{p}-m\\bar{t},\n$$\nwhere $\\bar{t}$ and $\\bar{p}$ are the sample means. Define centered variables $t_{i}'=t_{i}-\\bar{t}$ and $p_{i}'=p_{i}-\\bar{p}$. Substituting $c=\\bar{p}-m\\bar{t}$ yields\n$$\nF(m)=\\frac{1}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i}' - p_{i}'\\right)^{2}\n=\\frac{m^{2} S_{tt} - 2 m S_{tp} + S_{pp}}{m^{2}+1},\n$$\nwhere $S_{tt}=\\sum (t_{i}')^{2}$, $S_{pp}=\\sum (p_{i}')^{2}$, and $S_{tp}=\\sum t_{i}'p_{i}'$. Differentiating with respect to $m$ and setting to zero gives the total least squares condition\n$$\nS_{tp} m^{2} + (S_{tt} - S_{pp}) m - S_{tp} = 0,\n$$\nequivalently\n$$\nS_{tp}(m^{2}-1) + (S_{tt}-S_{pp}) m = 0.\n$$\nSolving this quadratic,\n$$\nm=\\frac{S_{pp}-S_{tt} \\pm \\sqrt{(S_{pp}-S_{tt})^{2}+4 S_{tp}^{2}}}{2 S_{tp}}.\n$$\nWe compute the sample means and sums for the data $(t,p)\\in\\{(2,3),(4,8),(7,10),(9,15)\\}$. With $n=4$,\n$$\n\\bar{t}=\\frac{2+4+7+9}{4}=\\frac{22}{4}=5.5,\\qquad \\bar{p}=\\frac{3+8+10+15}{4}=\\frac{36}{4}=9.\n$$\nThe centered values are $(t',p')\\in\\{(-3.5,-6),(-1.5,-1),(1.5,1),(3.5,6)\\}$, giving\n$$\nS_{tt}=(-3.5)^{2}+(-1.5)^{2}+(1.5)^{2}+(3.5)^{2}=29,\n$$\n$$\nS_{pp}=(-6)^{2}+(-1)^{2}+(1)^{2}+(6)^{2}=74,\n$$\n$$\nS_{tp}=(-3.5)(-6)+(-1.5)(-1)+(1.5)(1)+(3.5)(6)=45.\n$$\nThus\n$$\nm=\\frac{74-29 \\pm \\sqrt{(74-29)^{2}+4\\cdot 45^{2}}}{2\\cdot 45}\n=\\frac{45 \\pm 45\\sqrt{5}}{90}=\\frac{1\\pm \\sqrt{5}}{2}.\n$$\nThe data exhibit positive correlation, so we take the positive root,\n$$\nm=\\frac{1+\\sqrt{5}}{2}.\n$$\nThe intercept follows from $c=\\bar{p}-m\\bar{t}$:\n$$\nc=9-\\left(\\frac{1+\\sqrt{5}}{2}\\right)\\cdot 5.5\n=9-\\frac{11(1+\\sqrt{5})}{4}\n=\\frac{25-11\\sqrt{5}}{4}.\n$$\nNumerically, to four significant figures,\n$$\nm\\approx 1.618,\\qquad c\\approx 0.1008.\n$$\nThese correspond to units m/s for $m$ and m for $c$, as required.", "answer": "$$\\boxed{\\begin{pmatrix}1.618 & 0.1008\\end{pmatrix}}$$", "id": "2212231"}, {"introduction": "Data does not always follow a single, simple trend; sometimes, the underlying process changes abruptly. This problem challenges you to move beyond fitting a single model and instead perform model selection to identify a 'changepoint' [@problem_id:2212179]. By fitting separate lines to different segments of the data and comparing their overall error, you will learn a powerful technique for modeling systems with structural breaks or different regimes of behavior.", "problem": "An engineer is calibrating a novel pressure sensor. The sensor's output voltage is expected to vary linearly with the applied pressure. During a test, the pressure is increased in discrete steps, and the sensor's voltage output is recorded. The ordered data pairs $(x_i, y_i)$, where $x_i$ is the applied pressure in kilopascals (kPa) and $y_i$ is the output voltage in millivolts (mV), are as follows:\n\n(1, 2.1), (2, 2.9), (3, 3.8), (4, 2.1), (5, -0.1), (6, -1.8)\n\nThe engineer suspects that the sensor's response characteristic changed abruptly at some point during the test. To model this, they propose a changepoint model. The data is to be split into two contiguous segments at an integer index $k$. The first segment consists of data points $1$ through $k$, and the second segment consists of points $k+1$ through $6$. Each segment is then fitted with its own independent straight line, $y=mx+c$.\n\nThe \"best\" fit for each segment is defined as the line that minimizes the sum of squared vertical errors for the points within that segment. The overall quality of the changepoint model for a given $k$ is measured by the total Sum of Squared Errors (SSE), which is the sum of the SSEs from the two separate linear fits.\n\nTo ensure that each linear fit is well-defined, each segment must contain at least two data points. Therefore, the possible values for the changepoint index $k$ are $2, 3, \\text{and } 4$.\n\nDetermine the optimal integer value of the changepoint index $k$ that minimizes the total SSE.", "solution": "The sum of squared errors for an ordinary least squares fit of a straight line $y=mx+c$ to a segment with points $(x_{i},y_{i})$ for $i=1,\\dots,n$ can be expressed using\n$$\nS_{x}=\\sum x_{i},\\quad S_{y}=\\sum y_{i},\\quad \\sum x_{i}^{2},\\quad \\sum y_{i}^{2},\\quad \\sum x_{i}y_{i},\n$$\nand the centered sums\n$$\nS_{xx}=\\sum x_{i}^{2}-\\frac{S_{x}^{2}}{n},\\quad S_{yy}=\\sum y_{i}^{2}-\\frac{S_{y}^{2}}{n},\\quad S_{xy}=\\sum x_{i}y_{i}-\\frac{S_{x}S_{y}}{n}.\n$$\nThe slope is $m=\\frac{S_{xy}}{S_{xx}}$ and the segment SSE is\n$$\n\\mathrm{SSE}=S_{yy}-\\frac{S_{xy}^{2}}{S_{xx}}.\n$$\nFor two-point segments, the fitted line passes through both points, so the SSE equals $0$.\n\nCase $k=2$: Segment $1$ uses $(1,2.1),(2,2.9)$, so $\\mathrm{SSE}_{1}=0$. Segment $2$ uses $(3,3.8),(4,2.1),(5,-0.1),(6,-1.8)$ with $n=4$, $S_{x}=18$, $S_{y}=4.0$, $\\sum x_{i}^{2}=86$, $\\sum y_{i}^{2}=22.10$, $\\sum x_{i}y_{i}=8.5$. Hence\n$$\nS_{xx}=86-\\frac{18^{2}}{4}=5,\\quad S_{yy}=22.10-\\frac{4.0^{2}}{4}=18.10,\\quad S_{xy}=8.5-\\frac{18\\cdot 4.0}{4}=-9.5,\n$$\nso\n$$\n\\mathrm{SSE}_{2}=18.10-\\frac{(-9.5)^{2}}{5}=18.10-18.05=0.05.\n$$\nThus $\\mathrm{SSE}_{\\text{total}}(k=2)=0+0.05=0.05$.\n\nCase $k=3$: Segment $1$ uses $(1,2.1),(2,2.9),(3,3.8)$ with $n=3$, $S_{x}=6$, $S_{y}=8.8$, $\\sum x_{i}^{2}=14$, $\\sum y_{i}^{2}=27.26$, $\\sum x_{i}y_{i}=19.3$. Then\n$$\nS_{xx}=14-\\frac{6^{2}}{3}=2,\\quad S_{yy}=27.26-\\frac{8.8^{2}}{3}=\\frac{217}{150},\\quad S_{xy}=19.3-\\frac{6\\cdot 8.8}{3}=1.7,\n$$\nso\n$$\n\\mathrm{SSE}_{1}=\\frac{217}{150}-\\frac{(1.7)^{2}}{2}=\\frac{217}{150}-\\frac{289}{200}=\\frac{1}{600}.\n$$\nSegment $2$ uses $(4,2.1),(5,-0.1),(6,-1.8)$ with $n=3$, $S_{x}=15$, $S_{y}=0.2$, $\\sum x_{i}^{2}=77$, $\\sum y_{i}^{2}=7.66$, $\\sum x_{i}y_{i}=-2.9$. Then\n$$\nS_{xx}=77-\\frac{15^{2}}{3}=2,\\quad S_{yy}=7.66-\\frac{0.2^{2}}{3}=\\frac{1147}{150},\\quad S_{xy}=-2.9-\\frac{15\\cdot 0.2}{3}=-3.9,\n$$\nso\n$$\n\\mathrm{SSE}_{2}=\\frac{1147}{150}-\\frac{(-3.9)^{2}}{2}=\\frac{1147}{150}-\\frac{1521}{200}=\\frac{1}{24}.\n$$\nThus\n$$\n\\mathrm{SSE}_{\\text{total}}(k=3)=\\frac{1}{600}+\\frac{1}{24}=\\frac{26}{600}=\\frac{13}{300}\\approx 0.043333\\ldots.\n$$\n\nCase $k=4$: Segment $1$ uses $(1,2.1),(2,2.9),(3,3.8),(4,2.1)$ with $n=4$, $S_{x}=10$, $S_{y}=10.9$, $\\sum x_{i}^{2}=30$, $\\sum y_{i}^{2}=31.67$, $\\sum x_{i}y_{i}=27.7$. Then\n$$\nS_{xx}=30-\\frac{10^{2}}{4}=5,\\quad S_{yy}=31.67-\\frac{10.9^{2}}{4}=1.9675,\\quad S_{xy}=27.7-\\frac{10\\cdot 10.9}{4}=0.45,\n$$\nso\n$$\n\\mathrm{SSE}_{1}=1.9675-\\frac{(0.45)^{2}}{5}=1.9675-0.0405=1.927.\n$$\nSegment $2$ uses $(5,-0.1),(6,-1.8)$, so $\\mathrm{SSE}_{2}=0$. Thus $\\mathrm{SSE}_{\\text{total}}(k=4)=1.927$.\n\nComparing the totals, $\\mathrm{SSE}_{\\text{total}}(k=2)=0.05$, $\\mathrm{SSE}_{\\text{total}}(k=3)=\\frac{13}{300}\\approx 0.04333$, and $\\mathrm{SSE}_{\\text{total}}(k=4)=1.927$. The minimum is attained at $k=3$.", "answer": "$$\\boxed{3}$$", "id": "2212179"}]}