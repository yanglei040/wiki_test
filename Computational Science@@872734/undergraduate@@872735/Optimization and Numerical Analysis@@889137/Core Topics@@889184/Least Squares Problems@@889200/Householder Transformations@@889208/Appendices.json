{"hands_on_practices": [{"introduction": "Understanding a new mathematical tool begins with learning its fundamental mechanics. This first practice focuses on the direct application of a Householder transformation, defined by the matrix $H = I - 2 \\frac{v v^T}{v^T v}$. By working through a concrete calculation [@problem_id:2178061], you will build familiarity with the core formula and develop an intuition for how this transformation reflects a vector across a given hyperplane.", "problem": "In numerical linear algebra, a Householder transformation is a linear transformation that describes a reflection about a hyperplane containing the origin. For a given non-zero vector $v \\in \\mathbb{R}^n$, the corresponding Householder matrix is given by the formula:\n$$H = I - 2 \\frac{v v^T}{v^T v}$$\nwhere $I$ is the $n \\times n$ identity matrix.\n\nConsider the vectors $v = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$ and $u = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$ in $\\mathbb{R}^3$.\n\nCalculate the vector that results from applying the Householder transformation generated by the vector $v$ to the vector $u$. Express your answer as a column vector.", "solution": "We use the Householder transformation $H = I - 2 \\dfrac{v v^{T}}{v^{T} v}$ and apply it to $u$:\n$$Hu = \\left(I - 2 \\frac{v v^{T}}{v^{T} v}\\right) u.$$\nCompute the denominator:\n$$v^{T} v = 1^{2} + 0^{2} + 1^{2} = 2,$$\nso\n$$Hu = \\left(I - \\frac{2}{2} v v^{T}\\right) u = (I - v v^{T}) u.$$\nUsing the property $(v v^{T}) u = v (v^{T} u)$, we get\n$$Hu = u - v (v^{T} u).$$\nCompute the scalar\n$$v^{T} u = 1 \\cdot 1 + 0 \\cdot 2 + 1 \\cdot 3 = 4,$$\nhence\n$$Hu = u - 4 v = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} - 4 \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 - 4 \\\\ 2 - 0 \\\\ 3 - 4 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 2 \\\\ -1 \\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}-3 \\\\ 2 \\\\ -1\\end{pmatrix}}$$", "id": "2178061"}, {"introduction": "Beyond simply applying a known transformation, the real power of Householder reflectors lies in our ability to construct them for specific purposes. This exercise [@problem_id:2178069] challenges you to build a Householder matrix that maps a vector $x$ to another vector $y$ of the same length. Mastering this construction is a crucial step toward understanding how these reflections are used to systematically introduce zeros into matrices, a cornerstone of powerful algorithms like QR factorization.", "problem": "In numerical linear algebra, a Householder transformation is a linear transformation that performs a reflection about a hyperplane containing the origin. Such transformations are fundamental in algorithms like QR factorization. Given two vectors $x$ and $y$ in $\\mathbb{R}^n$ with the same Euclidean norm ($\\|x\\|_2 = \\|y\\|_2$), a Householder matrix $H$ can be constructed such that $Hx = y$.\n\nConsider the vectors $x = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}$ and $y = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix}$.\nDetermine the Householder matrix $H$ that maps the vector $x$ to the vector $y$. Express your answer as a $3 \\times 3$ matrix with rational number entries.", "solution": "We are asked to find a Householder matrix $H$ such that $Hx=y$ for $x=\\begin{pmatrix}1 \\\\ 2 \\\\ 2\\end{pmatrix}$ and $y=\\begin{pmatrix}0 \\\\ 3 \\\\ 0\\end{pmatrix}$. A Householder reflector that maps $x$ to $y$ when $\\|x\\|_{2}=\\|y\\|_{2}$ is given by\n$$\nH=I-\\frac{2}{u^{T}u}\\,uu^{T},\n$$\nwhere $u=x-y$ and $I$ is the identity matrix. This choice corresponds to reflecting across the hyperplane orthogonal to $u$.\n\nFirst compute $u$:\n$$\nu=x-y=\\begin{pmatrix}1 \\\\ 2 \\\\ 2\\end{pmatrix}-\\begin{pmatrix}0 \\\\ 3 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}1 \\\\ -1 \\\\ 2\\end{pmatrix}.\n$$\nThen compute the scalar $u^{T}u$ and the matrix $uu^{T}$:\n$$\nu^{T}u=1^{2}+(-1)^{2}+2^{2}=6,\n$$\n$$\nuu^{T}=\\begin{pmatrix}1 \\\\ -1 \\\\ 2\\end{pmatrix}\\begin{pmatrix}1 & -1 & 2\\end{pmatrix}=\\begin{pmatrix}\n1 & -1 & 2 \\\\\n-1 & 1 & -2 \\\\\n2 & -2 & 4\n\\end{pmatrix}.\n$$\nTherefore,\n$$\nH=I-\\frac{2}{6}uu^{T}=I-\\frac{1}{3}\\begin{pmatrix}\n1 & -1 & 2 \\\\\n-1 & 1 & -2 \\\\\n2 & -2 & 4\n\\end{pmatrix}.\n$$\nCarrying out the subtraction from the identity matrix,\n$$\nH=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}-\\begin{pmatrix}\n\\frac{1}{3} & -\\frac{1}{3} & \\frac{2}{3} \\\\\n-\\frac{1}{3} & \\frac{1}{3} & -\\frac{2}{3} \\\\\n\\frac{2}{3} & -\\frac{2}{3} & \\frac{4}{3}\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{2}{3} & \\frac{1}{3} & -\\frac{2}{3} \\\\\n\\frac{1}{3} & \\frac{2}{3} & \\frac{2}{3} \\\\\n-\\frac{2}{3} & \\frac{2}{3} & -\\frac{1}{3}\n\\end{pmatrix}.\n$$\nA direct check confirms $Hx=y$:\n$$\n\\begin{pmatrix}\n\\frac{2}{3} & \\frac{1}{3} & -\\frac{2}{3} \\\\\n\\frac{1}{3} & \\frac{2}{3} & \\frac{2}{3} \\\\\n-\\frac{2}{3} & \\frac{2}{3} & -\\frac{1}{3}\n\\end{pmatrix}\n\\begin{pmatrix}1 \\\\ 2 \\\\ 2\\end{pmatrix}\n=\n\\begin{pmatrix}0 \\\\ 3 \\\\ 0\\end{pmatrix}=y.\n$$\nThus the required Householder matrix with rational entries is as above.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{3} & \\frac{1}{3} & -\\frac{2}{3} \\\\ \\frac{1}{3} & \\frac{2}{3} & \\frac{2}{3} \\\\ -\\frac{2}{3} & \\frac{2}{3} & -\\frac{1}{3}\\end{pmatrix}}$$", "id": "2178069"}, {"introduction": "In numerical analysis, theoretical correctness is not sufficient; algorithms must also be robust against the limitations of finite-precision arithmetic. This final practice [@problem_id:2402000] explores a critical implementation detail of Householder transformations by examining a hypothetical scenario. You will analyze why the choice of sign in constructing the reflection vector is vital for avoiding catastrophic cancellation errors, a crucial lesson for writing reliable and accurate scientific software.", "problem": "Consider the real symmetric matrix\n$$\nA(\\delta)=\n\\begin{pmatrix}\n2 & 1 & \\delta & 0\\\\\n1 & 3 & 0 & 0\\\\\n\\delta & 0 & 4 & 0\\\\\n0 & 0 & 0 & 5\n\\end{pmatrix},\n$$\nwhere $\\delta>0$ is a real parameter with $\\delta \\ll 1$. In the first step of Householder tridiagonalization, one constructs a Householder reflector $H=I-2uu^{\\mathsf{T}}$ to act on the trailing $(n-1)$-dimensional subspace so that the first column below the diagonal is annihilated. Let $x\\in\\mathbb{R}^{3}$ denote the subvector formed from the entries of the first column of $A(\\delta)$ below the $(1,1)$ position, namely $x=A(\\delta)_{2:4,1}$. A standard construction of the Householder vector uses $v=x\\pm \\alpha e_1$ with $\\alpha=\\|x\\|_2$ and $e_1=(1,0,0)^{\\mathsf{T}}$, followed by normalization $u=v/\\|v\\|_2$. Here, the two choices of sign correspond to two algebraically equivalent but numerically distinct reflectors.\n\nDefine $v_{\\text{right}}=x+\\alpha e_1$ and $v_{\\text{wrong}}=x-\\alpha e_1$. Compute the exact, closed-form analytic expression for\n$$\n\\kappa(\\delta)=\\frac{\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right|}{\\left| \\left(v_{\\text{right}}\\right)_1 \\right|},\n$$\nwhere $\\left(v\\right)_1$ denotes the first component of the vector $v$. Your final answer must be a single simplified analytic expression in terms of $\\delta$ only, with no numerical approximation.", "solution": "The given matrix is\n$$\nA(\\delta)=\n\\begin{pmatrix}\n2 & 1 & \\delta & 0\\\\\n1 & 3 & 0 & 0\\\\\n\\delta & 0 & 4 & 0\\\\\n0 & 0 & 0 & 5\n\\end{pmatrix}\n$$\nwhere $\\delta > 0$ is a real parameter.\n\nThe first step of Householder tridiagonalization targets the first column of the matrix. The vector $x$ required for constructing the reflector is the subvector of the first column of $A(\\delta)$ that lies below the main diagonal element $A(\\delta)_{1,1}$. The first column of $A(\\delta)$ is $(2, 1, \\delta, 0)^{\\mathsf{T}}$. Therefore, the subvector $x \\in \\mathbb{R}^3$ is given by\n$$\nx = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix}.\n$$\nThe construction of the Householder vector $v$ is based on $v = x \\pm \\alpha e_1$, where $\\alpha = \\|x\\|_2$ and $e_1$ is the first standard basis vector in $\\mathbb{R}^3$, $e_1 = (1, 0, 0)^{\\mathsf{T}}$. First, we compute the Euclidean norm $\\alpha$ of the vector $x$:\n$$\n\\alpha = \\|x\\|_2 = \\sqrt{1^2 + \\delta^2 + 0^2} = \\sqrt{1 + \\delta^2}.\n$$\nThe problem defines two possible choices for the unnormalized Householder vector:\n$$\nv_{\\text{right}} = x + \\alpha e_1\n$$\n$$\nv_{\\text{wrong}} = x - \\alpha e_1\n$$\nThe standard \"correct\" choice in numerical algorithms is to select the sign in $x \\pm \\alpha e_1$ to match the sign of the first component of $x$, in order to avoid subtractive cancellation. Since $(x)_1 = 1 > 0$, the numerically stable choice is $v_{\\text{right}}$.\n\nLet us explicitly construct these vectors:\n$$\nv_{\\text{right}} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix} + \\sqrt{1 + \\delta^2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 + \\sqrt{1 + \\delta^2} \\\\ \\delta \\\\ 0 \\end{pmatrix}\n$$\n$$\nv_{\\text{wrong}} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix} - \\sqrt{1 + \\delta^2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - \\sqrt{1 + \\delta^2} \\\\ \\delta \\\\ 0 \\end{pmatrix}\n$$\nWe need to compute the ratio $\\kappa(\\delta)$, defined as\n$$\n\\kappa(\\delta)=\\frac{\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right|}{\\left| \\left(v_{\\text{right}}\\right)_1 \\right|}.\n$$\nThe first components are $(v_{\\text{right}})_1 = 1 + \\sqrt{1 + \\delta^2}$ and $(v_{\\text{wrong}})_1 = 1 - \\sqrt{1 + \\delta^2}$.\n\nWe evaluate the absolute values of these components. Since $\\delta > 0$, we have $\\delta^2 > 0$, which implies $1 + \\delta^2 > 1$ and therefore $\\sqrt{1 + \\delta^2} > 1$.\nThe term $(v_{\\text{right}})_1 = 1 + \\sqrt{1 + \\delta^2}$ is strictly positive, so its absolute value is itself:\n$$\n\\left| \\left(v_{\\text{right}}\\right)_1 \\right| = 1 + \\sqrt{1 + \\delta^2}.\n$$\nThe term $(v_{\\text{wrong}})_1 = 1 - \\sqrt{1 + \\delta^2}$ is strictly negative. Its absolute value is the negation of the term:\n$$\n\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right| = - (1 - \\sqrt{1 + \\delta^2}) = \\sqrt{1 + \\delta^2} - 1.\n$$\nNow, we can write the expression for $\\kappa(\\delta)$:\n$$\n\\kappa(\\delta) = \\frac{\\sqrt{1 + \\delta^2} - 1}{\\sqrt{1 + \\delta^2} + 1}.\n$$\nThis expression can be simplified by rationalizing the numerator. We multiply the numerator and the denominator by the conjugate of the numerator, which is $(\\sqrt{1 + \\delta^2} + 1)$:\n$$\n\\kappa(\\delta) = \\left( \\frac{\\sqrt{1 + \\delta^2} - 1}{\\sqrt{1 + \\delta^2} + 1} \\right) \\times \\left( \\frac{\\sqrt{1 + \\delta^2} + 1}{\\sqrt{1 + \\delta^2} + 1} \\right).\n$$\nThe numerator simplifies to a difference of squares:\n$$\n(\\sqrt{1 + \\delta^2} - 1)(\\sqrt{1 + \\delta^2} + 1) = (\\sqrt{1 + \\delta^2})^2 - 1^2 = (1 + \\delta^2) - 1 = \\delta^2.\n$$\nThe denominator becomes a square:\n$$\n(\\sqrt{1 + \\delta^2} + 1)(\\sqrt{1 + \\delta^2} + 1) = (\\sqrt{1 + \\delta^2} + 1)^2.\n$$\nCombining these results gives the final, simplified, closed-form expression for $\\kappa(\\delta)$:\n$$\n\\kappa(\\delta) = \\frac{\\delta^2}{(\\sqrt{1 + \\delta^2} + 1)^2}.\n$$", "answer": "$$\\boxed{\\frac{\\delta^2}{\\left(\\sqrt{1 + \\delta^2} + 1\\right)^2}}$$", "id": "2402000"}]}