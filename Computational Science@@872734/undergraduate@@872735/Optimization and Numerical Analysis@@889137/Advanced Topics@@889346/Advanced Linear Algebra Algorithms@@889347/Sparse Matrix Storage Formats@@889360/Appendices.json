{"hands_on_practices": [{"introduction": "Before we can perform complex operations, we must be fluent in reading the language of sparse matrices. This first exercise provides practice in translating a matrix from the memory-efficient Compressed Sparse Row (CSR) format back into its familiar dense, two-dimensional form. Mastering this translation is the foundational step to understanding how algorithms interact with sparse data structures [@problem_id:2204554].", "problem": "In many scientific and engineering applications, matrices are often \"sparse,\" meaning most of their elements are zero. Storing all these zeros is inefficient. The Compressed Sparse Row (CSR) format is a common method for storing sparse matrices by using three one-dimensional arrays.\n\nConsider a sparse matrix $A$ of size $4 \\times 4$. In the CSR format (using 0-based indexing), this matrix is represented by the following three arrays:\n1.  An array `V` containing the non-zero elements of $A$, read row by row, from left to right.\n2.  An array `C` containing the column index for each corresponding element in `V`.\n3.  An array `R` (the row pointer) of size $m+1$ (where $m$ is the number of rows), where the $i$-th element indicates the index in `V` and `C` where the data for the $i$-th row begins. The last element of `R` is the total number of non-zero elements.\n\nThe three arrays for our $4 \\times 4$ matrix $A$ are given as follows:\n- `V = [5.1, -1.2, 2.0, -3.5, 4.0, 9.8]`\n- `C = [1, 3, 0, 2, 3, 0]`\n- `R = [0, 2, 3, 5, 6]`\n\nReconstruct the original dense $4 \\times 4$ matrix $A$. Present your answer as a $4 \\times 4$ matrix.", "solution": "We use the CSR definition with 0-based indexing. For each row index $i \\in \\{0,1,2,3\\}$, the nonzero entries of row $i$ are stored in the segments of `V` and `C` with indices $j$ from $R[i]$ to $R[i+1]-1$, where the column index is $C[j]$ and the value is $V[j]$. The last element $R[4]=6$ equals the total number of nonzeros, which matches $\\lvert V \\rvert=6$.\n\nRow $0$: indices $j=R[0]\\ldots R[1]-1=0\\ldots 1$.\n- $j=0$: $C[0]=1$, $V[0]=5.1$ gives $A_{0,1}=5.1$.\n- $j=1$: $C[1]=3$, $V[1]=-1.2$ gives $A_{0,3}=-1.2$.\nThus row $0$ is $[0,\\,5.1,\\,0,\\,-1.2]$.\n\nRow $1$: indices $j=R[1]\\ldots R[2]-1=2\\ldots 2$.\n- $j=2$: $C[2]=0$, $V[2]=2.0$ gives $A_{1,0}=2.0$.\nThus row $1$ is $[2.0,\\,0,\\,0,\\,0]$.\n\nRow $2$: indices $j=R[2]\\ldots R[3]-1=3\\ldots 4$.\n- $j=3$: $C[3]=2$, $V[3]=-3.5$ gives $A_{2,2}=-3.5$.\n- $j=4$: $C[4]=3$, $V[4]=4.0$ gives $A_{2,3}=4.0$.\nThus row $2$ is $[0,\\,0,\\,-3.5,\\,4.0]$.\n\nRow $3$: indices $j=R[3]\\ldots R[4]-1=5\\ldots 5$.\n- $j=5$: $C[5]=0$, $V[5]=9.8$ gives $A_{3,0}=9.8$.\nThus row $3$ is $[9.8,\\,0,\\,0,\\,0]$.\n\nTherefore, the reconstructed dense matrix $A$ is\n$$\n\\begin{pmatrix}\n0  5.1  0  -1.2 \\\\\n2.0  0  0  0 \\\\\n0  0  -3.5  4.0 \\\\\n9.8  0  0  0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0  5.1  0  -1.2 \\\\ 2.0  0  0  0 \\\\ 0  0  -3.5  4.0 \\\\ 9.8  0  0  0\\end{pmatrix}}$$", "id": "2204554"}, {"introduction": "In practice, sparse matrix data is often generated in an unstructured Coordinate (COO) list format, which is simple but inefficient for row-wise operations. This exercise walks you through the essential task of converting from the COO format to the more structured and computationally efficient CSR format. This process of sorting and re-indexing is a fundamental building block in many scientific computing workflows [@problem_id:2204580].", "problem": "In scientific computing, sparse matrices, which are matrices populated primarily with zeros, are often stored in specialized formats to save memory and computational time. One such format is the Coordinate (COO) format, which represents a matrix using three arrays: `values` (containing the non-zero elements), `row_indices` (the row index of each non-zero element), and `col_indices` (the column index of each non-zero element).\n\nAnother common and more efficient format for matrix operations is the Compressed Sparse Row (CSR) format. It also uses three arrays:\n1.  `values`: An array of the non-zero values, ordered by row and then by column within each row.\n2.  `col_indices`: An array of the column indices corresponding to the elements in the `values` array.\n3.  `row_ptr`: An array of size `(number of rows + 1)`. The value `row_ptr[i]` indicates the index in the `values` array where the elements for row `i` begin. The last element of `row_ptr` is the total number of non-zero elements.\n\nConsider a 5x5 sparse matrix representing a small network, initially given in COO format. The non-zero elements are provided in an arbitrary order:\n\n`values = [3, 8, 1, 5, 9, 2, 7]`\n`row_indices = [1, 0, 4, 0, 2, 2, 4]`\n`col_indices = [2, 1, 3, 4, 3, 0, 1]`\n\nConvert this matrix representation from COO format to CSR format. Which of the following options correctly represents the resulting `values`, `col_indices`, and `row_ptr` arrays?\n\nA.\n`values = [8, 5, 3, 2, 9, 7, 1]`\n`col_indices = [1, 4, 2, 0, 3, 1, 3]`\n`row_ptr = [0, 2, 1, 2, 0, 2]`\n\nB.\n`values = [3, 8, 1, 5, 9, 2, 7]`\n`col_indices = [2, 1, 3, 4, 3, 0, 1]`\n`row_ptr = [0, 2, 3, 5, 5, 7]`\n\nC.\n`values = [8, 5, 3, 2, 9, 7, 1]`\n`col_indices = [1, 4, 2, 0, 3, 1, 3]`\n`row_ptr = [1, 3, 4, 6, 6, 8]`\n\nD.\n`values = [8, 5, 3, 2, 9, 7, 1]`\n`col_indices = [1, 4, 2, 0, 3, 1, 3]`\n`row_ptr = [0, 2, 3, 5, 5, 7]`", "solution": "We are given a sparse matrix in COO format via three arrays. Define the COO triplets as $(r_{k}, c_{k}, v_{k})$ for each nonzero entry. From the data:\n$$\n\\begin{aligned}\nv = [3,8,1,5,9,2,7],\\\\\nr = [1,0,4,0,2,2,4],\\\\\nc = [2,1,3,4,3,0,1].\n\\end{aligned}\n$$\nThis yields the unordered list of triplets:\n$$\n(1,2;3),\\ (0,1;8),\\ (4,3;1),\\ (0,4;5),\\ (2,3;9),\\ (2,0;2),\\ (4,1;7).\n$$\n\nTo convert to CSR, we sort the entries by row index ascending, and within each row by column index ascending. Grouping by row and sorting within each row:\n- Row $0$: entries $(0,1;8)$ and $(0,4;5)$, already ordered by column $14$.\n- Row $1$: entry $(1,2;3)$.\n- Row $2$: entries $(2,0;2)$ and $(2,3;9)$, ordered by column $03$.\n- Row $3$: no entries.\n- Row $4$: entries $(4,1;7)$ and $(4,3;1)$, ordered by column $13$.\n\nConcatenating by row gives the CSR-ordered arrays:\n$$\n\\text{values} = [8,\\,5,\\,3,\\,2,\\,9,\\,7,\\,1],\n$$\n$$\n\\text{col\\_indices} = [1,\\,4,\\,2,\\,0,\\,3,\\,1,\\,3].\n$$\n\nNext, compute the row pointer array $\\text{row\\_ptr}$ of length $5+1=6$. Count nonzeros per row:\n- Row $0$: $2$,\n- Row $1$: $1$,\n- Row $2$: $2$,\n- Row $3$: $0$,\n- Row $4$: $2$.\n\nTake cumulative sums starting at $0$:\n$$\n\\text{row\\_ptr} = [0,\\ 0+2,\\ 2+1,\\ 3+2,\\ 5+0,\\ 5+2] = [0,\\,2,\\,3,\\,5,\\,5,\\,7].\n$$\n\nComparing with the options, this matches option D exactly.", "answer": "$$\\boxed{D}$$", "id": "2204580"}, {"introduction": "The real advantage of sparse formats is the ability to perform complex manipulations without ever creating the full, dense matrix. This practice challenges you to implement a common and practical algorithm: extracting a specific submatrix from a larger system stored in CSR format. Successfully solving this requires navigating the CSR structure to identify and re-index the relevant non-zero elements, demonstrating a key skill in large-scale data analysis [@problem_id:2204591].", "problem": "In computational science, many problems involving large-scale simulations, such as analyzing network graphs or solving discretized partial differential equations, result in large, sparse matrices. To conserve memory, these matrices are stored in specialized formats.\n\nConsider a large $8 \\times 8$ sparse matrix $A$ representing a system, stored in the Compressed Sparse Row (CSR) format. The CSR format uses three arrays to represent the matrix:\n- `values`: A list of the non-zero values of the matrix, read row by row.\n- `col_indices`: A list of the column indices corresponding to each element in the `values` array.\n- `row_ptr`: A list of pointers indicating the start of each row's data within the `values` and `col_indices` arrays. The length of this array is one greater than the number of rows, and its last element is the total number of non-zero elements (NNZ). For a row `i`, its non-zero elements are found in `values` from index `row_ptr[i]` up to (but not including) `row_ptr[i+1]`.\n\nThe specific matrix $A$ is given by the following 0-indexed CSR arrays:\n- `values` = `[10, 15, 20, 22, 30, 35, 40, 48, 51, 50, 57, 62, 60, 75, 70, 81, 80]`\n- `col_indices` = `[0, 4, 1, 3, 2, 5, 3, 7, 0, 4, 6, 2, 5, 4, 6, 1, 7]`\n- `row_ptr` = `[0, 2, 4, 6, 8, 11, 13, 15, 17]`\n\nWe wish to analyze a specific sub-system. This corresponds to extracting a submatrix $B$ from $A$. The submatrix is defined by a curated list of row and column indices from the original matrix. The rows and columns for the submatrix are given by the following 0-indexed lists:\n- `sub_rows` = `[1, 4, 5, 7]`\n- `sub_cols` = `[0, 1, 4, 5]`\n\nThe extracted submatrix $B$ is constructed such that $B_{ij} = A_{sub\\_rows[i], sub\\_cols[j]}$. Your task is to generate this submatrix $B$ and represent it in the Coordinate list (COO) format. The COO format uses three arrays of equal length:\n- `data`: A list of the non-zero values.\n- `row`: A list of the row indices for each non-zero value.\n- `col`: A list of the column indices for each non-zero value.\n\nThe indices in the `row` and `col` arrays for the COO representation of $B$ must be relative to the new submatrix's dimensions (i.e., from 0 to 3 for both rows and columns).\n\nAfter determining the COO representation for the submatrix $B$, calculate the sum of all numerical values in its `data` array.", "solution": "We interpret the CSR arrays using the rule that the non-zero entries of row $i$ are at indices $k$ with $k \\in \\{ \\text{row\\_ptr}[i], \\ldots, \\text{row\\_ptr}[i+1]-1 \\}$, with corresponding columns $\\text{col\\_indices}[k]$ and values $\\text{values}[k]$.\n\nGiven $\\text{row\\_ptr} = [0,2,4,6,8,11,13,15,17]$, the rows of $A$ are:\n- Row $0$: indices $k=0,1$, so $(c,v)=(0,10),(4,15)$, hence $A_{0,0}=10$, $A_{0,4}=15$.\n- Row $1$: indices $k=2,3$, so $(c,v)=(1,20),(3,22)$, hence $A_{1,1}=20$, $A_{1,3}=22$.\n- Row $2$: indices $k=4,5$, so $(c,v)=(2,30),(5,35)$, hence $A_{2,2}=30$, $A_{2,5}=35$.\n- Row $3$: indices $k=6,7$, so $(c,v)=(3,40),(7,48)$, hence $A_{3,3}=40$, $A_{3,7}=48$.\n- Row $4$: indices $k=8,9,10$, so $(c,v)=(0,51),(4,50),(6,57)$, hence $A_{4,0}=51$, $A_{4,4}=50$, $A_{4,6}=57$.\n- Row $5$: indices $k=11,12$, so $(c,v)=(2,62),(5,60)$, hence $A_{5,2}=62$, $A_{5,5}=60$.\n- Row $6$: indices $k=13,14$, so $(c,v)=(4,75),(6,70)$, hence $A_{6,4}=75$, $A_{6,6}=70$.\n- Row $7$: indices $k=15,16$, so $(c,v)=(1,81),(7,80)$, hence $A_{7,1}=81$, $A_{7,7}=80$.\n\nWe extract the submatrix $B$ with $\\text{sub\\_rows}=[1,4,5,7]$ and $\\text{sub\\_cols}=[0,1,4,5]$, where $B_{ij}=A_{\\text{sub\\_rows}[i],\\,\\text{sub\\_cols}[j]}$, and reindex rows and columns to $0,1,2,3$.\n\nFor $i=0$ (original row $1$), among columns $\\{0,1,4,5\\}$ only column $1$ is non-zero with value $20$, so $B_{0,1}=20$.\nFor $i=1$ (original row $4$), among columns $\\{0,1,4,5\\}$ columns $0$ and $4$ are non-zero with values $51$ and $50$, mapping to $j=0$ and $j=2$, so $B_{1,0}=51$, $B_{1,2}=50$.\nFor $i=2$ (original row $5$), among columns $\\{0,1,4,5\\}$ only column $5$ is non-zero with value $60$, mapping to $j=3$, so $B_{2,3}=60$.\nFor $i=3$ (original row $7$), among columns $\\{0,1,4,5\\}$ only column $1$ is non-zero with value $81$, mapping to $j=1$, so $B_{3,1}=81$.\n\nThus a valid COO representation (ordered by ascending row and then column) is:\n$\\text{data}=[20,51,50,60,81]$, $\\text{row}=[0,1,1,2,3]$, $\\text{col}=[1,0,2,3,1]$.\n\nThe sum of the entries in the data array is\n$$20+51+50+60+81=262.$$", "answer": "$$\\boxed{262}$$", "id": "2204591"}]}