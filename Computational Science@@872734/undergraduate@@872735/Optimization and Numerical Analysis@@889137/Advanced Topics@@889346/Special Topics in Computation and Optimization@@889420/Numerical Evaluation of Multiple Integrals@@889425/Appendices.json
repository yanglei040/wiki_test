{"hands_on_practices": [{"introduction": "A natural starting point for evaluating multiple integrals numerically is to extend the familiar rules from one-dimensional calculus, such as the Midpoint rule. This involves partitioning the integration domain into a grid of small sub-regions and approximating the integral as a weighted sum of function values. This first practice [@problem_id:2191981] solidifies this core concept by applying the composite Midpoint rule to estimate a triple integral over a simple cubic volume, providing a foundational skill for more complex problems.", "problem": "A scalar field is defined in a three-dimensional region by the function $f(x,y,z) = x^2 y \\exp(z)$. We are interested in the value of the triple integral of this function over the cubic region $R$ defined by the inequalities $0 \\le x \\le 1$, $0 \\le y \\le 1$, and $0 \\le z \\le 1$.\n\nUse the composite Midpoint rule to estimate the value of the integral $I = \\iiint_R f(x,y,z) \\,dV$. The estimation should be based on a partition of the region $R$ into smaller identical cubes, using 2 divisions along the x-axis, 2 divisions along the y-axis, and 2 divisions along the z-axis.\n\nProvide the estimated value of the integral as a single closed-form analytic expression.", "solution": "We apply the composite Midpoint rule in three dimensions. Partition the unit cube $R=[0,1]^{3}$ into $2 \\times 2 \\times 2$ identical subcubes. The step sizes are $h_{x}=\\frac{1}{2}$, $h_{y}=\\frac{1}{2}$, and $h_{z}=\\frac{1}{2}$, so each subcube has volume $\\Delta V=h_{x}h_{y}h_{z}=\\frac{1}{8}$. The midpoints along each axis are $x^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$, $y^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$, and $z^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$.\n\nThe composite Midpoint rule gives\n$$\nI \\approx \\sum_{i=1}^{2}\\sum_{j=1}^{2}\\sum_{k=1}^{2} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\\,\\Delta V.\n$$\nSince $f(x,y,z)=x^{2}y\\exp(z)$ is separable, the sum factorizes:\n$$\n\\sum_{i,j,k} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\n=\\left(\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\\right)\\left(\\sum_{j=1}^{2} y_{j}^{*}\\right)\\left(\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\\right).\n$$\nCompute each factor:\n$$\n\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\n=\\left(\\frac{1}{4}\\right)^{2}+\\left(\\frac{3}{4}\\right)^{2}\n=\\frac{1}{16}+\\frac{9}{16}\n=\\frac{10}{16}\n=\\frac{5}{8},\n$$\n$$\n\\sum_{j=1}^{2} y_{j}^{*}\n=\\frac{1}{4}+\\frac{3}{4}\n=1,\n$$\n$$\n\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\n=\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right).\n$$\nTherefore,\n$$\nI \\approx \\Delta V \\cdot \\frac{5}{8} \\cdot 1 \\cdot \\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{1}{8}\\cdot \\frac{5}{8}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{5}{64}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right).\n$$", "answer": "$$\\boxed{\\frac{5}{64}\\left(\\exp\\left(\\frac{1}{4}\\right)+\\exp\\left(\\frac{3}{4}\\right)\\right)}$$", "id": "2191981"}, {"introduction": "While grid-based methods are intuitive, they can become inefficient in higher dimensions, a phenomenon known as the \"curse of dimensionality\". An entirely different and powerful approach is Monte Carlo integration, which leverages probability and random sampling to approximate integrals. In this exercise [@problem_id:2191964], you will see how an integral can be estimated by determining the proportion of random points that satisfy a certain condition, a technique especially useful for complex or high-dimensional domains.", "problem": "A computational model generates points $(x,y)$ by selecting coordinates $x$ and $y$ independently from a uniform random distribution over the interval $[0,1]$. This process effectively samples points from the unit square. A point is considered a \"hit\" if its coordinates satisfy the inequality $y > \\sin(\\pi x)$.\n\nA simulation is executed with a total of $N = 1000$ randomly generated points. In this simulation, a total of 358 points are recorded as hits.\n\nBased on the results of this simulation, what is the estimated probability that a randomly chosen point in the unit square is a hit? Express your answer as a decimal rounded to three significant figures.", "solution": "The simulation samples independent pairs $(X,Y)$ with $X \\sim \\text{Uniform}(0,1)$ and $Y \\sim \\text{Uniform}(0,1)$. Define the hit event $H=\\{Y>\\sin(\\pi X)\\}$. In a Monte Carlo simulation with $N$ independent trials, the standard unbiased estimator for the hit probability $p=\\mathbb{P}(H)$ is the sample proportion of hits:\n$$\n\\hat{p}=\\frac{k}{N},\n$$\nwhere $k$ is the observed number of hits.\n\nGiven $N=1000$ and $k=358$, we compute\n$$\n\\hat{p}=\\frac{358}{1000}=0.358.\n$$\nRounding to three significant figures leaves $0.358$ unchanged.", "answer": "$$\\boxed{0.358}$$", "id": "2191964"}, {"introduction": "Many problems in science and engineering require integration over domains that are not simple rectangles, such as parallelograms or triangles. A key strategy for handling such cases is the change of variables technique, which transforms the complex domain into a simple one, like a unit square, where grid-based methods can be easily applied. This practice [@problem_id:2191987] guides you through this essential process, from finding the correct coordinate transformation and its Jacobian determinant to applying a numerical rule on the transformed integral.", "problem": "Consider the integral of the function $f(x,y) = (x-y)^2$ over a parallelogram-shaped region $R$ in the $xy$-plane. The vertices of the parallelogram $R$ are given by the points $V_1 = (1, 2)$, $V_2 = (4, 3)$, $V_3 = (2, 6)$, and $V_4 = (5, 7)$.\n\nYour task is to approximate the double integral $I = \\iint_R f(x,y) \\,dA$.\n\nTo do this, first determine the affine transformation $T(u,v) = (x(u,v), y(u,v))$ that maps the vertices of the unit square $S = [0,1] \\times [0,1]$ in the $uv$-plane, specifically $(0,0), (1,0), (0,1), (1,1)$, to the vertices of the parallelogram $R$, specifically $V_1, V_2, V_3, V_4$, respectively. Then, use this transformation to change the variables of integration from $(x,y)$ to $(u,v)$.\n\nFinally, approximate the resulting integral over the unit square $S$ using a composite midpoint rule based on a $2 \\times 2$ grid of uniform sub-squares.\n\nCalculate the numerical value of this approximation. Round your final answer to four significant figures.", "solution": "The problem asks for a numerical approximation of the integral $I = \\iint_R (x-y)^2 \\,dA$, where $R$ is a parallelogram with vertices $V_1=(1,2)$, $V_2=(4,3)$, $V_3=(2,6)$, and $V_4=(5,7)$. The approximation is to be done by transforming the integral to the unit square $S = [0,1] \\times [0,1]$ and then applying a composite midpoint rule on a $2 \\times 2$ grid.\n\nFirst, we find the affine transformation $T(u,v) = (x(u,v), y(u,v))$ that maps the unit square $S$ in the $uv$-plane to the parallelogram $R$ in the $xy$-plane. An affine transformation has the general form:\n$x(u,v) = x_0 + au + cv$\n$y(u,v) = y_0 + bu + dv$\n\nWe use the given mapping of the vertices:\n1.  $T(0,0) = (1,2)$:\n    $x(0,0) = x_0 = 1$\n    $y(0,0) = y_0 = 2$\n2.  $T(1,0) = (4,3)$:\n    $x(1,0) = x_0 + a(1) + c(0) = 1 + a = 4 \\implies a = 3$\n    $y(1,0) = y_0 + b(1) + d(0) = 2 + b = 3 \\implies b = 1$\n3.  $T(0,1) = (2,6)$:\n    $x(0,1) = x_0 + a(0) + c(1) = 1 + c = 2 \\implies c = 1$\n    $y(0,1) = y_0 + b(0) + d(1) = 2 + d = 6 \\implies d = 4$\n\nThus, the affine transformation is:\n$x(u,v) = 1 + 3u + v$\n$y(u,v) = 2 + u + 4v$\n\nWe can verify this with the fourth vertex: $T(1,1) = (1+3+1, 2+1+4) = (5,7)$, which is correct.\n\nNext, we apply the change of variables formula for double integrals:\n$I = \\iint_R f(x,y) \\,dx\\,dy = \\iint_S f(x(u,v), y(u,v)) \\left| \\det(J) \\right| \\,du\\,dv$\nwhere $J$ is the Jacobian matrix of the transformation $T$.\n$$J = \\begin{pmatrix} \\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\ \\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 4 \\end{pmatrix}$$\nThe determinant of the Jacobian is $\\det(J) = (3)(4) - (1)(1) = 12 - 1 = 11$.\nThe absolute value is $|\\det(J)| = 11$. Since this is a constant, the area of the parallelogram is $11$ times the area of the unit square.\n\nNow, we transform the integrand $f(x,y) = (x-y)^2$:\n$x - y = (1 + 3u + v) - (2 + u + 4v) = -1 + 2u - 3v$\nSo, $f(x(u,v), y(u,v)) = (-1 + 2u - 3v)^2$.\n\nThe integral becomes:\n$I = \\int_0^1 \\int_0^1 (-1 + 2u - 3v)^2 \\cdot 11 \\,du\\,dv$\nLet the new integrand be $g(u,v) = 11(-1 + 2u - 3v)^2$.\n\nWe are to approximate this integral using a composite midpoint rule on a $2 \\times 2$ grid. The unit square $S$ is divided into four sub-squares, each of area $\\Delta A = 0.5 \\times 0.5 = 0.25$. The midpoints of these sub-squares are:\n$(u_1, v_1) = (0.25, 0.25)$\n$(u_2, v_2) = (0.75, 0.25)$\n$(u_3, v_3) = (0.25, 0.75)$\n$(u_4, v_4) = (0.75, 0.75)$\n\nThe approximation of the integral is given by:\n$I \\approx \\sum_{i=1}^{4} g(u_i,v_i) \\Delta A = 0.25 \\left[ g(0.25, 0.25) + g(0.75, 0.25) + g(0.25, 0.75) + g(0.75, 0.75) \\right]$\n\nWe evaluate $g(u,v)$ at each midpoint:\n1.  $g(0.25, 0.25) = 11(-1 + 2(0.25) - 3(0.25))^2 = 11(-1 + 0.5 - 0.75)^2 = 11(-1.25)^2 = 11(1.5625) = 17.1875$\n2.  $g(0.75, 0.25) = 11(-1 + 2(0.75) - 3(0.25))^2 = 11(-1 + 1.5 - 0.75)^2 = 11(-0.25)^2 = 11(0.0625) = 0.6875$\n3.  $g(0.25, 0.75) = 11(-1 + 2(0.25) - 3(0.75))^2 = 11(-1 + 0.5 - 2.25)^2 = 11(-2.75)^2 = 11(7.5625) = 83.1875$\n4.  $g(0.75, 0.75) = 11(-1 + 2(0.75) - 3(0.75))^2 = 11(-1 + 1.5 - 2.25)^2 = 11(-1.75)^2 = 11(3.0625) = 33.6875$\n\nNow, we sum these values and multiply by $\\Delta A$:\n$I \\approx 0.25 (17.1875 + 0.6875 + 83.1875 + 33.6875) = 0.25 (134.75) = 33.6875$\n\nFinally, we round the result to four significant figures.\n$I \\approx 33.69$.", "answer": "$$\\boxed{33.69}$$", "id": "2191987"}]}