{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will execute a single, fundamental iteration of Broyden's method. This exercise [@problem_id:2158069] demonstrates the core procedure of using an initial guess and an approximate Jacobian to calculate the next, hopefully better, approximation of the root. Mastering this step is crucial for understanding the overall flow of the algorithm before we delve into how the Jacobian itself is updated.", "problem": "Consider the system of nonlinear equations given by $F(x) = 0$, where $x = (x_1, x_2)^T$ and the function $F: \\mathbb{R}^2 \\to \\mathbb{R}^2$ is defined as:\n$$\nF(x) = \\begin{pmatrix} x_1^2 - x_2 + 1 \\\\ x_1 + x_2^2 - 3 \\end{pmatrix}\n$$\nYou are to perform a single step of the secant-updating quasi-Newton method known as Broyden's method to find an improved approximation of the root. Starting with the initial guess $x_0 = (1, 1)^T$ and using the initial approximation of the Jacobian matrix\n$$\nB_0 = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix},\n$$\ncalculate the next iterate, $x_1$. Express your answer as a vector of two components.", "solution": "We are given the system $F(x) = 0$ with $F: \\mathbb{R}^{2} \\to \\mathbb{R}^{2}$ defined by\n$$\nF(x) = \\begin{pmatrix} x_{1}^{2} - x_{2} + 1 \\\\ x_{1} + x_{2}^{2} - 3 \\end{pmatrix},\n$$\nan initial guess $x_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, and an initial Jacobian approximation\n$$\nB_{0} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}.\n$$\nIn Broydenâ€™s method, the next iterate $x_{1}$ is computed by first solving the linear system\n$$\nB_{0} s_{0} = -F(x_{0}),\n$$\nand then updating\n$$\nx_{1} = x_{0} + s_{0}.\n$$\n\nFirst evaluate $F(x_{0})$:\n$$\nF(x_{0}) = \\begin{pmatrix} 1^{2} - 1 + 1 \\\\ 1 + 1^{2} - 3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\nSolve for $s_{0}$ using $B_{0} s_{0} = -F(x_{0})$. Since $B_{0} = 2 I$, we have\n$$\ns_{0} = B_{0}^{-1}\\big(-F(x_{0})\\big) = \\frac{1}{2} I \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix}.\n$$\nThen,\n$$\nx_{1} = x_{0} + s_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{3}{2} \\end{pmatrix}.\n$$\nThus the next iterate is the vector with components $\\frac{1}{2}$ and $\\frac{3}{2}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{3}{2} \\end{pmatrix}}$$", "id": "2158069"}, {"introduction": "Having seen how to perform an iteration, we now focus on the \"quasi-Newton\" aspect of Broyden's method: updating the Jacobian approximation. Instead of recalculating the costly true Jacobian at each step, the method uses information from the most recent iteration to refine its approximation. This practice [@problem_id:2158053] walks you through the application of the Broyden update formula, which is the key to the method's computational efficiency.", "problem": "In the process of numerically solving a system of nonlinear equations $F(x) = 0$, where $F: \\mathbb{R}^2 \\to \\mathbb{R}^2$, a quasi-Newton method is employed. The initial guess for the root is the vector $x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. At this point, the function evaluates to $F(x_0) = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$.\n\nThe initial approximation for the Jacobian matrix is chosen to be the 2x2 identity matrix, $B_0 = I$. After the first step of the iterative method, the new point is found to be $x_1 = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$, with the corresponding function value $F(x_1) = \\begin{pmatrix} 0.5 \\\\ 0.5 \\end{pmatrix}$.\n\nUsing the provided information, calculate the updated Jacobian approximation, $B_1$, by applying a single step of Broyden's \"good\" method. Express your answer as a 2x2 matrix.", "solution": "We apply Broyden's \"good\" update, which enforces the secant equation $B_{1}s_{0}=y_{0}$ and minimizes the change in $B$ in the Frobenius norm. The update formula is\n$$\nB_{1}=B_{0}+\\frac{\\left(y_{0}-B_{0}s_{0}\\right)s_{0}^{T}}{s_{0}^{T}s_{0}}.\n$$\nFrom the data, compute the step and function difference:\n$$\ns_{0}=x_{1}-x_{0}=\\begin{pmatrix}2 \\\\ -1\\end{pmatrix}-\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=\\begin{pmatrix}1 \\\\ -2\\end{pmatrix},\\quad\ny_{0}=F(x_{1})-F(x_{0})=\\begin{pmatrix}\\tfrac{1}{2} \\\\ \\tfrac{1}{2}\\end{pmatrix}-\\begin{pmatrix}-1 \\\\ 2\\end{pmatrix}=\\begin{pmatrix}\\tfrac{3}{2} \\\\ -\\tfrac{3}{2}\\end{pmatrix}.\n$$\nWith $B_{0}=I$, we have\n$$\nB_{0}s_{0}=s_{0}=\\begin{pmatrix}1 \\\\ -2\\end{pmatrix},\\quad y_{0}-B_{0}s_{0}=\\begin{pmatrix}\\tfrac{3}{2} \\\\ -\\tfrac{3}{2}\\end{pmatrix}-\\begin{pmatrix}1 \\\\ -2\\end{pmatrix}=\\begin{pmatrix}\\tfrac{1}{2} \\\\ \\tfrac{1}{2}\\end{pmatrix},\n$$\nand\n$$\ns_{0}^{T}s_{0}=1^{2}+(-2)^{2}=5.\n$$\nForm the rank-one correction:\n$$\n\\frac{\\left(y_{0}-B_{0}s_{0}\\right)s_{0}^{T}}{s_{0}^{T}s_{0}}=\\frac{1}{5}\\begin{pmatrix}\\tfrac{1}{2} \\\\ \\tfrac{1}{2}\\end{pmatrix}\\begin{pmatrix}1 & -2\\end{pmatrix}\n=\\frac{1}{5}\\begin{pmatrix}\\tfrac{1}{2} & -1 \\\\ \\tfrac{1}{2} & -1\\end{pmatrix}\n=\\begin{pmatrix}\\tfrac{1}{10} & -\\tfrac{1}{5} \\\\ \\tfrac{1}{10} & -\\tfrac{1}{5}\\end{pmatrix}.\n$$\nTherefore,\n$$\nB_{1}=I+\\begin{pmatrix}\\tfrac{1}{10} & -\\tfrac{1}{5} \\\\ \\tfrac{1}{10} & -\\tfrac{1}{5}\\end{pmatrix}\n=\\begin{pmatrix}1+\\tfrac{1}{10} & -\\tfrac{1}{5} \\\\ \\tfrac{1}{10} & 1-\\tfrac{1}{5}\\end{pmatrix}\n=\\begin{pmatrix}\\tfrac{11}{10} & -\\tfrac{1}{5} \\\\ \\tfrac{1}{10} & \\tfrac{4}{5}\\end{pmatrix}.\n$$\nA quick check shows $B_{1}s_{0}=\\begin{pmatrix}\\tfrac{3}{2} \\\\ -\\tfrac{3}{2}\\end{pmatrix}=y_{0}$, confirming the secant condition.", "answer": "$$\\boxed{\\begin{pmatrix}\\tfrac{11}{10} & -\\tfrac{1}{5} \\\\ \\tfrac{1}{10} & \\tfrac{4}{5}\\end{pmatrix}}$$", "id": "2158053"}, {"introduction": "To solidify your conceptual understanding, this final practice connects the multi-dimensional Broyden's method to its simpler, one-dimensional counterpart. You will demonstrate algebraically [@problem_id:2158084] that Broyden's update formula reduces to the familiar finite difference approximation for the derivative used in the secant method. This reveals the elegant intuition behind the algorithm and clarifies why it's considered a generalization of the secant method to higher dimensions.", "problem": "Broyden's method is a quasi-Newton method for finding roots of a system of nonlinear equations $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$, where $\\mathbf{F}: \\mathbb{R}^n \\to \\mathbb{R}^n$. The method iteratively refines an approximation to the Jacobian matrix, denoted by $B_k$ at step $k$. A common update rule for the Jacobian approximation, known as Broyden's \"good\" method, is given by:\n\n$$ B_{k+1} = B_k + \\frac{(\\mathbf{y}_k - B_k \\mathbf{s}_k)\\mathbf{s}_k^T}{\\mathbf{s}_k^T \\mathbf{s}_k} $$\n\nHere, $\\mathbf{x}_k$ is the vector of variables at iteration $k$, and the update vectors are defined as $\\mathbf{s}_k = \\mathbf{x}_{k+1} - \\mathbf{x}_k$ and $\\mathbf{y}_k = \\mathbf{F}(\\mathbf{x}_{k+1}) - \\mathbf{F}(\\mathbf{x}_k)$.\n\nThis powerful multi-dimensional formula has a direct connection to a simpler, well-known one-dimensional root-finding algorithm. Consider the special case where $n=1$. In this scenario, the vector-valued function $\\mathbf{F}$ becomes a scalar function $f(x)$, the vectors $\\mathbf{x}_k, \\mathbf{s}_k, \\mathbf{y}_k$ become scalars $x_k, s_k, y_k$, and the Jacobian matrix $B_k$ becomes a scalar $b_k$, which represents an approximation to the derivative $f'(x_k)$.\n\nYour task is to algebraically reduce the general Broyden's update formula to its one-dimensional equivalent. Derive the resulting expression for the updated derivative approximation, $b_{k+1}$, in terms of the function $f$ and the iterates $x_k$ and $x_{k+1}$.", "solution": "We begin from the general Broyden \"good\" update\n$$\nB_{k+1} = B_k + \\frac{(\\mathbf{y}_k - B_k \\mathbf{s}_k)\\mathbf{s}_k^{T}}{\\mathbf{s}_k^{T} \\mathbf{s}_k}.\n$$\nIn one dimension, all quantities are scalars: set $b_k \\equiv B_k$, $s_k \\equiv \\mathbf{s}_k$, $y_k \\equiv \\mathbf{y}_k$. For scalars, the transpose operation is trivial, so $\\mathbf{s}_k^{T} = s_k$, and the denominator becomes $\\mathbf{s}_k^{T}\\mathbf{s}_k = s_k^{2}$. Therefore the update reduces to\n$$\nb_{k+1} = b_k + \\frac{(y_k - b_k s_k)s_k}{s_k^{2}}.\n$$\nExpanding and simplifying,\n$$\nb_{k+1} = b_k + \\frac{y_k s_k - b_k s_k^{2}}{s_k^{2}} = b_k + \\frac{y_k}{s_k} - b_k = \\frac{y_k}{s_k}.\n$$\nUsing the one-dimensional definitions $s_k = x_{k+1} - x_k$ and $y_k = f(x_{k+1}) - f(x_k)$, we obtain\n$$\nb_{k+1} = \\frac{f(x_{k+1}) - f(x_k)}{x_{k+1} - x_k},\n$$\nwhich is the secant slope approximation to the derivative.", "answer": "$$\\boxed{\\frac{f(x_{k+1})-f(x_k)}{x_{k+1}-x_k}}$$", "id": "2158084"}]}