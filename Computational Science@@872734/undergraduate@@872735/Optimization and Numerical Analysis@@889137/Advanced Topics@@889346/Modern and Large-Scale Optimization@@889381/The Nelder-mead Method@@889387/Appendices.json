{"hands_on_practices": [{"introduction": "Every iteration of the Nelder-Mead algorithm begins with a crucial sorting step to understand the current state of the simplex. This exercise focuses on this foundational task: identifying the best and worst vertices based on their function values and calculating the centroid of the remaining points. Mastering this step is essential, as the centroid acts as the pivot point for all subsequent geometric transformations like reflection and expansion. [@problem_id:2217758]", "problem": "In an effort to optimize a manufacturing process, an engineer is using the Nelder-Mead algorithm to find a set of two parameters, $x$ and $y$, that minimizes a cost function, $f(x,y)$. At the beginning of an iteration, the algorithm's simplex in the 2-dimensional parameter space consists of three vertices: $P_1$, $P_2$, and $P_3$. The coordinates of these vertices and their corresponding cost function values are given as follows:\n\n- Vertex $P_1$: coordinates $(\\frac{3}{2}, 2)$, with function value $f(P_1) = \\frac{25}{2}$.\n- Vertex $P_2$: coordinates $(3, \\frac{9}{2})$, with function value $f(P_2) = 25$.\n- Vertex $P_3$: coordinates $(\\frac{5}{2}, 1)$, with function value $f(P_3) = \\frac{17}{2}$.\n\nAs a preliminary step for determining the next test point, you need to identify the worst vertex (the one with the highest function value) and calculate the centroid of the remaining vertices.\n\nDetermine the coordinates $(x_w, y_w)$ of the worst vertex and the coordinates $(x_c, y_c)$ of the centroid of the other vertices. Your final answer should be a row matrix containing these four values in the order $(x_w, y_w, x_c, y_c)$. Provide the coordinates as exact fractions or integers.", "solution": "In the Nelder-Mead algorithm, the worst vertex is the one with the highest function value. Given the function values\n$$f(P_{1})=\\frac{25}{2}, \\quad f(P_{2})=25, \\quad f(P_{3})=\\frac{17}{2},$$\nwe note that\n$$25  \\frac{25}{2}, \\quad 25  \\frac{17}{2},$$\nso the worst vertex is $P_{2}$ with coordinates $(3, \\frac{9}{2})$. Thus $(x_{w}, y_{w})=(3, \\frac{9}{2})$.\n\nThe centroid of the remaining two vertices $P_{1}=(\\frac{3}{2},2)$ and $P_{3}=(\\frac{5}{2},1)$ is the average of their coordinates. Therefore,\n$$x_{c}=\\frac{\\frac{3}{2}+\\frac{5}{2}}{2}=\\frac{\\frac{8}{2}}{2}=\\frac{4}{2}=2,$$\n$$y_{c}=\\frac{2+1}{2}=\\frac{3}{2}.$$\nHence $(x_{c}, y_{c})=(2, \\frac{3}{2})$.\n\nThe requested row matrix in the order $(x_{w}, y_{w}, x_{c}, y_{c})$ is $\\begin{pmatrix}3  \\frac{9}{2}  2  \\frac{3}{2}\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 3  \\frac{9}{2}  2  \\frac{3}{2} \\end{pmatrix}}$$", "id": "2217758"}, {"introduction": "While the Nelder-Mead algorithm is robust, its success depends on a proper initial setup. This practice explores a critical prerequisite: the initial simplex must be non-degenerate, meaning its vertices cannot lie on the same line or plane in higher dimensions. Understanding this concept is vital to avoid scenarios where the algorithm is trapped and unable to explore the full dimensionality of the problem space. [@problem_id:2217780]", "problem": "An engineering student is tasked with finding the minimum of a cost function $C(x, y)$ which depends on two design parameters, $x$ and $y$. They decide to use the Nelder-Mead algorithm, a popular numerical optimization method that does not require derivatives. For this two-dimensional problem, the algorithm works by iteratively updating a simplex, which is a triangle in the $xy$-plane.\n\nThe student initializes the algorithm with the following three vertices for the initial simplex:\n$v_1 = (3.0, 1.0)$\n$v_2 = (3.0, 4.0)$\n$v_3 = (3.0, 8.0)$\n\nWithout any knowledge of the cost function $C(x, y)$ or its values at these vertices, which of the following statements best describes a fundamental limitation the algorithm will face from the very beginning, preventing it from effectively exploring the two-dimensional search space to find the minimum?\n\nA. The starting simplex is too small, which will cause the algorithm to converge prematurely to a point that is not a local minimum.\n\nB. All vertices have the same x-coordinate, forming a degenerate simplex which is confined to a one-dimensional line and cannot explore variations in the x-direction.\n\nC. The centroid of the initial simplex will be identical to one of the vertices, causing the algorithm to enter an infinite loop.\n\nD. The algorithm requires at least one vertex to be at the origin $(0,0)$ to guarantee convergence.\n\nE. The reflection step of the algorithm will always generate a point outside the feasible design space, causing an immediate failure.", "solution": "A simplex in two dimensions must be a nondegenerate triangle, i.e., its three vertices must be noncollinear. A standard way to verify nondegeneracy is to compute the signed area using\n$$\nA=\\frac{1}{2}\\left|\\det\\begin{pmatrix}x_{2}-x_{1}  y_{2}-y_{1} \\\\ x_{3}-x_{1}  y_{3}-y_{1}\\end{pmatrix}\\right|.\n$$\nWith $v_{1}=(3,1)$, $v_{2}=(3,4)$, $v_{3}=(3,8)$, we have $x_{2}-x_{1}=0$ and $x_{3}-x_{1}=0$, hence\n$$\nA=\\frac{1}{2}\\left|\\det\\begin{pmatrix}0  3 \\\\ 0  7\\end{pmatrix}\\right|=\\frac{1}{2}\\left|0\\cdot 7-0\\cdot 3\\right|=0,\n$$\nso the three points are collinear and the initial simplex is degenerate, lying on the line $x=3$.\n\nNelder-Mead updates points using affine operations based on the centroid of the best $n$ vertices in $n$ dimensions. In two dimensions, with reflection coefficient $\\alpha$, expansion coefficient $\\gamma$, contraction coefficient $\\rho$, and shrink coefficient $\\sigma$, the operations generate new points of the forms\n$$\nx_{r}=x_{c}+\\alpha(x_{c}-x_{h}),\\quad x_{e}=x_{c}+\\gamma(x_{r}-x_{c}),\\quad x_{co}=x_{c}+\\rho(x_{h}-x_{c}),\n$$\nand shrink updates are affine combinations of existing vertices. If all vertices initially lie on the affine line $L=\\{(3,y): y\\in\\mathbb{R}\\}$, then the centroid $x_{c}$ also lies on $L$, and every affine combination of points on $L$ remains on $L$. Therefore, every reflected, expanded, contracted, or shrunk point remains on $L$. The algorithm is thus confined to a one-dimensional subspace and cannot explore variations in the $x$-direction, failing to explore the two-dimensional search space.\n\nChecking the alternatives:\n- A is not a fundamental limitation; size alone does not prevent two-dimensional exploration, whereas degeneracy does.\n- B correctly identifies the degeneracy: all $x$-coordinates are equal, confining the search to a line.\n- C is false here since the centroid is $x_{c}=(3,\\frac{1+4+8}{3})=(3,\\frac{13}{3})$, which is not any of the vertices, and, in general, Nelder-Mead does not require the centroid to differ from all vertices to proceed unless points coincide.\n- D is false; Nelder-Mead has no requirement that a vertex be at the origin.\n- E is unsupported; no feasible region is specified, and, geometrically, the reflections remain on the same line, not outside any defined domain.\n\nTherefore, the correct statement is B.", "answer": "$$\\boxed{B}$$", "id": "2217780"}, {"introduction": "Now, let's put all the pieces together and walk through a complete iteration of the Nelder-Mead algorithm in a two-dimensional space. This problem demonstrates the decision-making logic that makes the algorithm so effective, showing how it chooses between reflection, expansion, and contraction based on whether a new point yields a better result. This practice will solidify your understanding of the algorithm's adaptive strategy for navigating the search space toward a minimum. [@problem_id:2217774]", "problem": "The Nelder-Mead method is a numerical optimization algorithm used to find the minimum of a function in a multi-dimensional space. It operates on a simplex, which is a geometric figure in $n$ dimensions consisting of $n+1$ vertices. For a function in $\\mathbb{R}^2$, the simplex is a triangle. The algorithm iteratively modifies the simplex to move it towards a minimum.\n\nThis problem concerns one iteration of the Nelder-Mead algorithm for minimizing the function $f(x, y) = 10x^2 + y^2$. The initial simplex has vertices $v_1 = (0.1, 0.1)$, $v_2 = (-0.1, 0.2)$, and $v_3 = (2.0, 0.3)$.\n\nThe algorithm uses the standard parameters: reflection factor $\\alpha=1$, expansion factor $\\gamma=2$, contraction factor $\\rho=0.5$, and shrink factor $\\sigma=0.5$.\n\nOne iteration of the algorithm proceeds as follows:\n1.  **Order**: Order the $n+1=3$ vertices $x_1, x_2, x_3$ such that their function values are sorted: $f(x_1) \\le f(x_2) \\le f(x_3)$. Here, $x_1$ is the best vertex and $x_3$ is the worst.\n2.  **Centroid**: Calculate the centroid $x_o$ of all vertices except the worst one, $x_o = \\frac{1}{n}\\sum_{i=1}^{n} x_i = \\frac{1}{2}(x_1 + x_2)$.\n3.  **Reflection**: Compute the reflected point $x_r = x_o + \\alpha(x_o - x_3)$. Evaluate $f(x_r)$.\n4.  **Decision Logic**:\n    a. If $f(x_1) \\le f(x_r)  f(x_2)$, the simplex is modified by replacing the worst point $x_3$ with $x_r$. This is a **Reflection** step. The iteration terminates.\n    b. If $f(x_r)  f(x_1)$, the algorithm has found a promising direction. It attempts an **Expansion**:\n        i.  Compute the expansion point $x_e = x_o + \\gamma(x_r - x_o)$.\n        ii. If $f(x_e)  f(x_r)$, replace $x_3$ with $x_e$. The iteration terminates.\n        iii. Otherwise, the expansion failed; replace $x_3$ with $x_r$. The iteration terminates.\n    c. If $f(x_r) \\ge f(x_2)$, the reflected point is poor. The algorithm performs a **Contraction**:\n        i.  If $f(x_r)  f(x_3)$, perform an **Outside Contraction**: Compute $x_c = x_o + \\rho(x_r - x_o)$. If $f(x_c) \\le f(x_r)$, replace $x_3$ with $x_c$. Otherwise, perform a **Shrink**.\n        ii. If $f(x_r) \\ge f(x_3)$, perform an **Inside Contraction**: Compute $x_{cc} = x_o - \\rho(x_o - x_3)$. If $f(x_{cc})  f(x_3)$, replace $x_3$ with $x_{cc}$. Otherwise, perform a **Shrink**.\n        iii.If a contraction step is successful, the iteration terminates.\n    d. If all else fails, a **Shrink** is performed: all points except the best one are moved towards the best point. For $i=2, 3$, replace $x_i$ with $x_1 + \\sigma(x_i - x_1)$. The iteration terminates.\n\nBased on the initial simplex and the function provided, determine which of the following procedures successfully concludes the first iteration of the algorithm.\n\nA. Reflection\n\nB. Expansion\n\nC. Outside Contraction\n\nD. Inside Contraction\n\nE. Shrink", "solution": "We minimize $f(x,y)=10x^{2}+y^{2}$ over the simplex with vertices $v_{1}=(0.1,0.1)$, $v_{2}=(-0.1,0.2)$, $v_{3}=(2.0,0.3)$. First, evaluate the function at each vertex:\n$$\nf(v_{1})=10(0.1)^{2}+(0.1)^{2}=10(0.01)+0.01=0.11,\n$$\n$$\nf(v_{2})=10(-0.1)^{2}+(0.2)^{2}=10(0.01)+0.04=0.14,\n$$\n$$\nf(v_{3})=10(2.0)^{2}+(0.3)^{2}=10(4)+0.09=40.09.\n$$\nHence the ordering is $x_{1}=v_{1}$ (best), $x_{2}=v_{2}$, $x_{3}=v_{3}$ (worst), since $0.11 \\le 0.14 \\le 40.09$. The centroid of the best two is\n$$\nx_{o}=\\frac{1}{2}(x_{1}+x_{2})=\\frac{1}{2}\\big((0.1,0.1)+(-0.1,0.2)\\big)=(0,0.15).\n$$\nWith reflection factor $\\alpha=1$, the reflected point is\n$$\nx_{r}=x_{o}+\\alpha(x_{o}-x_{3})=2x_{o}-x_{3}=(0,0.3)-(2.0,0.3)=(-2.0,0.0),\n$$\nand its function value is\n$$\nf(x_{r})=10(-2.0)^{2}+(0.0)^{2}=10\\cdot 4+0=40.\n$$\nWe compare: $f(x_{r})=40 \\ge f(x_{2})=0.14$, so we enter the contraction branch. Since $f(x_{r})f(x_{3})$ holds ($4040.09$), we attempt an outside contraction with $\\rho=0.5$:\n$$\nx_{c}=x_{o}+\\rho(x_{r}-x_{o})=(0,0.15)+0.5\\big((-2,0)-(0,0.15)\\big)=(0,0.15)+0.5(-2,-0.15)=(-1,0.075).\n$$\nEvaluate its function value:\n$$\nf(x_{c})=10(-1)^{2}+(0.075)^{2}=10+0.005625=10.005625.\n$$\nThe outside contraction is successful if $f(x_{c}) \\le f(x_{r})$, which is satisfied since $10.005625 \\le 40$. Therefore, the iteration terminates with a successful Outside Contraction, replacing $x_{3}$ by $x_{c}$.", "answer": "$$\\boxed{C}$$", "id": "2217774"}]}