{"hands_on_practices": [{"introduction": "The first step in numerically solving a partial differential equation like the Laplace equation is discretization. This process transforms the continuous problem of calculus into a discrete problem of algebra. In this exercise [@problem_id:2101988], you will apply the five-point finite difference stencil to a simple grid, translating the PDE into a system of linear equations in the form $A\\mathbf{v} = \\mathbf{b}$. Constructing and analyzing the coefficient matrix $A$, which represents the discrete Laplacian operator, is a foundational skill for understanding how these numerical methods work.", "problem": "Consider a long, hollow conducting pipe with a square cross-section in the $xy$-plane, defined by the region $0 \\le x \\le L$ and $0 \\le y \\le L$. The walls of the pipe are maintained at a constant electrostatic potential $V_0$. Far from the ends of the pipe, the electrostatic potential $V(x,y)$ inside the pipe is governed by the two-dimensional Laplace equation:\n$$\n\\frac{\\partial^2 V}{\\partial x^2} + \\frac{\\partial^2 V}{\\partial y^2} = 0\n$$\nTo find an approximate solution for the potential, we can use the finite difference method. We discretize the domain with a uniform grid spacing of $h = L/3$ in both directions. This creates a set of four interior grid points at locations $(ih, jh)$ for $i,j \\in \\{1, 2\\}$. Let $V_{ij}$ denote the potential $V(ih, jh)$ at these interior points.\n\nThe value of the potential at each interior grid point is approximated as the average of the potentials at its four nearest neighbors (the five-point stencil method), which can be algebraically rearranged from the discrete form of Laplace's equation:\n$$\n4V_{ij} - V_{i+1,j} - V_{i-1,j} - V_{i,j+1} - V_{i,j-1} = 0\n$$\nApplying this relation at each of the four interior points, and using the known boundary potentials, yields a system of four linear equations for the four unknown potentials. This system can be written in matrix form as $A\\mathbf{v} = \\mathbf{b}$.\n\nLet the vector of unknown potentials be ordered column-by-column as $\\mathbf{v} = [V_{11}, V_{12}, V_{21}, V_{22}]^T$. Determine the numerical value of the determinant of the coefficient matrix $A$.", "solution": "The five-point stencil for the discrete Laplace equation at each interior node gives, for $(i,j)\\in\\{(1,1),(1,2),(2,1),(2,2)\\}$,\n$$\n4V_{ij} - V_{i+1,j} - V_{i-1,j} - V_{i,j+1} - V_{i,j-1} = 0.\n$$\nMoving known boundary values to the right-hand side leaves the coefficients of the unknowns unchanged. Writing the equations explicitly and ordering the unknowns as $\\mathbf{v}=[V_{11},V_{12},V_{21},V_{22}]^{T}$ yields\n- At $(1,1)$: $4V_{11} - V_{12} - V_{21} = V_{01}+V_{10}$.\n- At $(1,2)$: $-V_{11} + 4V_{12} - V_{22} = V_{02}+V_{13}$.\n- At $(2,1)$: $-V_{11} + 4V_{21} - V_{22} = V_{31}+V_{20}$.\n- At $(2,2)$: $-V_{12} - V_{21} + 4V_{22} = V_{32}+V_{23}$.\n\nThus the coefficient matrix $A$ (independent of boundary values) is\n$$\nA=\\begin{pmatrix}\n4 & -1 & -1 & 0\\\\\n-1 & 4 & 0 & -1\\\\\n-1 & 0 & 4 & -1\\\\\n0 & -1 & -1 & 4\n\\end{pmatrix}.\n$$\nPartitioning $A$ into $2\\times 2$ blocks as\n$$\nA=\\begin{pmatrix}B & C\\\\ C & B\\end{pmatrix},\\quad\nB=\\begin{pmatrix}4 & -1\\\\ -1 & 4\\end{pmatrix},\\quad\nC=\\begin{pmatrix}-1 & 0\\\\ 0 & -1\\end{pmatrix},\n$$\nwe use the standard block-diagonalization via the orthogonal matrix that maps symmetric and antisymmetric combinations, which yields\n$$\n\\det(A)=\\det(B+C)\\,\\det(B-C).\n$$\nCompute\n$$\nB+C=\\begin{pmatrix}3 & -1\\\\ -1 & 3\\end{pmatrix},\\quad \\det(B+C)=3\\cdot 3-(-1)(-1)=8,\n$$\n$$\nB-C=\\begin{pmatrix}5 & -1\\\\ -1 & 5\\end{pmatrix},\\quad \\det(B-C)=5\\cdot 5-(-1)(-1)=24.\n$$\nTherefore,\n$$\n\\det(A)=8\\times 24=192.\n$$", "answer": "$$\\boxed{192}$$", "id": "2101988"}, {"introduction": "Once the Laplace equation is discretized into a large system of linear equations, we need an efficient way to solve it. While direct methods exist, iterative methods are often preferred for their simplicity and scalability, especially for the large, sparse matrices that arise in practice. This practice [@problem_id:2172039] introduces the Jacobi method, a classic iterative technique where you will update the potential at each grid point based on the values of its neighbors from the previous step, providing crucial intuition for how the solution gradually converges from an initial guess.", "problem": "Consider the problem of determining the electrostatic potential $u(x,y)$ inside a square, charge-free region. The potential satisfies the two-dimensional Laplace equation:\n$$\n\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0\n$$\nThe domain is discretized into a uniform grid of points $(x_i, y_j)$, where $x_i = i \\cdot h$ and $y_j = j \\cdot h$ for $i,j \\in \\{0, 1, 2, 3\\}$. The grid spacing $h$ is constant. This grid results in four interior points: $(x_1, y_1)$, $(x_1, y_2)$, $(x_2, y_1)$, and $(x_2, y_2)$. Let the potential at these grid points be denoted by $u_{ij} = u(x_i, y_j)$.\n\nThe potential on the boundary is fixed. The values at the boundary points adjacent to the interior grid points are given as follows:\n- On the left boundary: $u_{0,1} = 21.0$ V and $u_{0,2} = 21.0$ V.\n- On the right boundary: $u_{3,1} = 41.0$ V and $u_{3,2} = 41.0$ V.\n- On the bottom boundary: $u_{1,0} = 9.0$ V and $u_{2,0} = 9.0$ V.\n- On the top boundary: $u_{1,3} = 81.0$ V and $u_{2,3} = 81.0$ V.\n\nThe Laplace equation is approximated using the standard five-point stencil finite difference formula, which relates the potential at an interior point to its four nearest neighbors. The Jacobi method is used to solve the resulting system of linear equations.\n\nStarting with an initial guess of $u_{ij}^{(0)} = 0$ V for all four interior points (where $i,j \\in \\{1,2\\}$), calculate the numerical values of the potential at these points after one complete iteration of the Jacobi method.\n\nProvide the updated potential values for $u_{11}, u_{12}, u_{21}, u_{22}$ in this specific order. The final answer should be a set of four numbers. Do not include units in your final answer.", "solution": "The two-dimensional Laplace equation discretized with the standard five-point stencil on a uniform grid gives, for an interior node $(i,j)$,\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^{2}}+\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^{2}}=0,\n$$\nwhich simplifies to the averaging relation\n$$\nu_{i,j}=\\frac{1}{4}\\left(u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}\\right).\n$$\nThe Jacobi iteration updates each interior point using neighbors from the previous iterate:\n$$\nu_{i,j}^{(k+1)}=\\frac{1}{4}\\left(u_{i+1,j}^{(k)}+u_{i-1,j}^{(k)}+u_{i,j+1}^{(k)}+u_{i,j-1}^{(k)}\\right),\n$$\nwith boundary values held fixed. With the initial guess $u_{ij}^{(0)}=0$ for $i,j\\in\\{1,2\\}$ and the given boundary data, the first-iteration updates are:\n\nFor $u_{11}$:\n$$\nu_{11}^{(1)}=\\frac{1}{4}\\left(u_{21}^{(0)}+u_{01}+u_{12}^{(0)}+u_{10}\\right)=\\frac{1}{4}\\left(0+21+0+9\\right)=7.5.\n$$\n\nFor $u_{12}$:\n$$\nu_{12}^{(1)}=\\frac{1}{4}\\left(u_{22}^{(0)}+u_{02}+u_{13}+u_{11}^{(0)}\\right)=\\frac{1}{4}\\left(0+21+81+0\\right)=25.5.\n$$\n\nFor $u_{21}$:\n$$\nu_{21}^{(1)}=\\frac{1}{4}\\left(u_{31}+u_{11}^{(0)}+u_{22}^{(0)}+u_{20}\\right)=\\frac{1}{4}\\left(41+0+0+9\\right)=12.5.\n$$\n\nFor $u_{22}$:\n$$\nu_{22}^{(1)}=\\frac{1}{4}\\left(u_{32}+u_{12}^{(0)}+u_{23}+u_{21}^{(0)}\\right)=\\frac{1}{4}\\left(41+0+81+0\\right)=30.5.\n$$\n\nThus, after one Jacobi iteration starting from zero, the updated potentials in the order $(u_{11},u_{12},u_{21},u_{22})$ are $(7.5,25.5,12.5,30.5)$.", "answer": "$$\\boxed{\\begin{pmatrix} 7.5 & 25.5 & 12.5 & 30.5 \\end{pmatrix}}$$", "id": "2172039"}, {"introduction": "A numerical solution is always an approximation, so it is crucial to ask: how accurate is our result? This practice [@problem_id:2102014] guides you through a fundamental numerical analysis technique known as a convergence study. By calculating the error of the finite difference method on different grid resolutions and comparing them, you can empirically verify the method's theoretical order of accuracy. This process is essential for validating a numerical model and understanding how the error behaves as we refine our simulation.", "problem": "Consider the steady-state temperature distribution $u(x, y)$ on a thin, square metallic plate. The temperature is governed by Laplace's equation, $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$, on the unit square domain defined by $0 \\le x \\le 1$ and $0 \\le y \\le 1$.\n\nFor a specific set of heat sources applied at the boundaries, the exact analytical solution for the temperature is known to be $u_{exact}(x, y) = \\sin(\\pi x) \\sinh(\\pi y)$. The boundary conditions for the problem are therefore determined by this function evaluated along the edges of the square.\n\nYou are tasked with numerically investigating the convergence of the standard finite difference method for this problem. The domain is discretized into a grid of points $(x_i, y_j)$, where $x_i = i h$ and $y_j = j h$, with $h$ being the uniform grid spacing. The Laplace equation is approximated at each interior grid point using the standard second-order central difference approximation, which relates the value at a point to its four nearest neighbors.\n\nYour analysis will involve two different grid spacings:\n\n1.  First, consider a coarse grid with spacing $h_1 = 1/2$. This grid has only one interior point. Calculate the numerical approximation, which we will call $u_{num,1}$, for the temperature at this interior point. Then, determine the corresponding absolute error $E_1 = |u_{exact} - u_{num,1}|$ at this same point. Note that for a grid with a single interior point, this point error is also the maximum error on the grid.\n\n2.  Next, for a finer grid with a spacing of $h_2 = 1/4$, the numerical solution has been pre-computed. The maximum absolute error over all interior points of this finer grid, defined as $E_2 = \\max |u_{exact}(x_i, y_j) - u_{num,2}(x_i, y_j)|$, has been found to be approximately $E_2 \\approx 0.1878$.\n\nThe theoretical order of accuracy for this numerical method is 2, which suggests that the maximum error $E$ should scale with the grid spacing $h$ according to the relationship $E \\approx K h^2$ for some constant $K$, particularly as $h$ becomes very small.\n\nCalculate the numerical value of the ratio of the maximum errors, $R = E_1 / E_2$, using your calculated value for $E_1$ and the provided value for $E_2$. Round your final answer to three significant figures.", "solution": "We solve Laplaceâ€™s equation on the unit square with Dirichlet boundary data taken from the exact solution $u_{exact}(x,y)=\\sin(\\pi x)\\sinh(\\pi y)$. The standard second-order 5-point finite difference stencil at an interior grid point $(i,j)$ with grid spacing $h$ is\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^{2}}+\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^{2}}=0,\n$$\nwhich is equivalent to\n$$\n4u_{i,j}=u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}.\n$$\n\nFor $h_{1}=1/2$, the grid points are $x_{i}=ih_{1}$, $y_{j}=jh_{1}$ for $i,j\\in\\{0,1,2\\}$. There is a single interior point at $(i,j)=(1,1)$, i.e., $(x,y)=(1/2,1/2)$. Its four neighbors are boundary points at $(0,1/2)$, $(1,1/2)$, $(1/2,0)$, and $(1/2,1)$, whose Dirichlet values are given by $u_{exact}$:\n$$\nu(0,1/2)=\\sin(0)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=0,\\quad u(1,1/2)=\\sin(\\pi)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=0,\n$$\n$$\nu(1/2,0)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh(0)=0,\\quad u(1/2,1)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh(\\pi)=\\sinh(\\pi).\n$$\nThus the finite difference equation gives the numerical solution at the interior point as the average of these neighbors:\n$$\nu_{num,1}(1/2,1/2)=\\frac{1}{4}\\left[0+0+0+\\sinh(\\pi)\\right]=\\frac{1}{4}\\sinh(\\pi).\n$$\nThe exact value at this point is\n$$\nu_{exact}(1/2,1/2)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=\\sinh\\!\\left(\\frac{\\pi}{2}\\right).\n$$\nTherefore, the absolute error at the single interior point (and hence the maximum error on this coarse grid) is\n$$\nE_{1}=\\left|\\sinh\\!\\left(\\frac{\\pi}{2}\\right)-\\frac{1}{4}\\sinh(\\pi)\\right|.\n$$\nNumerically,\n$$\n\\sinh(\\pi)\\approx 11.548739357257748,\\qquad \\sinh\\!\\left(\\frac{\\pi}{2}\\right)\\approx 2.301298902307295,\n$$\nso\n$$\nE_{1}\\approx \\left|2.301298902307295-\\frac{1}{4}\\cdot 11.548739357257748\\right|\\approx \\left|2.301298902307295-2.887184839314437\\right|\\approx 0.585885937007142.\n$$\n\nFor the finer grid with $h_{2}=1/4$, we are given $E_{2}\\approx 0.1878$. Hence the ratio of maximum errors is\n$$\nR=\\frac{E_{1}}{E_{2}}\\approx \\frac{0.585885937007142}{0.1878}\\approx 3.1197334238\\ldots\n$$\nRounding to three significant figures gives\n$$\nR\\approx 3.12.\n$$", "answer": "$$\\boxed{3.12}$$", "id": "2102014"}]}