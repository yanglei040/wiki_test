{"hands_on_practices": [{"introduction": "The heart of the Finite Element Method lies in the element stiffness matrix, which relates nodal forces to nodal displacements for a single element. This practice moves beyond the simplest case of a uniform bar to a bar with a linearly varying cross-section. By working through this derivation, you will see how the integral-based weak form of FEM elegantly handles continuously varying material or geometric properties, a key advantage over other numerical methods. [@problem_id:2393897]", "problem": "Consider a straight, axially loaded, one-dimensional (1D) bar element occupying the interval $x \\in [0,L]$ along its local coordinate, with constant Youngâ€™s modulus $E$ and a cross-sectional area that varies linearly as a function of position, $A(x)$. The bar is modeled using a two-node linear interpolation (standard two-node linear element in the Finite Element Method (FEM)). Let the nodal axial displacements be $u_{1}$ at $x=0$ and $u_{2}$ at $x=L$. The cross-sectional area at the element ends is $A_{1} = A(0)$ and $A_{2} = A(L)$, respectively, and $A(x)$ varies linearly between these values.\n\nStarting from the principle of virtual work for an elastic bar in small strain, small displacement, one-dimensional axial deformation, and using the standard linear shape functions, derive the closed-form expression for the consistent element stiffness matrix in terms of $E$, $L$, $A_{1}$, and $A_{2}$. Assume no body forces and no distributed tractions on the element interior. Express the final answer as a single analytical $2 \\times 2$ matrix expression. No numerical evaluation is required, and no rounding is needed. Do not include units in your final boxed answer.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of solid mechanics and the finite element method, is well-posed with sufficient information for a unique solution, and is expressed in objective, precise language. All conditions for a valid problem are met. We may proceed with the derivation.\n\nThe derivation of the element stiffness matrix for an elastic body begins with the principle of virtual work. For a one-dimensional bar with no body forces or distributed tractions, the principle states that the internal virtual work, $\\delta W_{\\text{int}}$, is equal to the virtual work done by nodal forces. The stiffness matrix $\\mathbf{K}$ relates the nodal displacement vector $\\mathbf{d}$ to the nodal force vector $\\mathbf{f}$ via $\\mathbf{f} = \\mathbf{K} \\mathbf{d}$. The internal virtual work can be expressed as:\n$$ \\delta W_{\\text{int}} = \\int_{V} \\delta\\boldsymbol{\\epsilon}^T \\boldsymbol{\\sigma} \\, dV $$\nFor a one-dimensional bar, the stress $\\sigma$ and strain $\\epsilon$ are scalars, and the volume integral simplifies to an integral over the length $x \\in [0, L]$:\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} \\delta\\epsilon(x) \\sigma(x) A(x) \\, dx $$\nwhere $A(x)$ is the cross-sectional area, $\\sigma(x)$ is the axial stress, and $\\epsilon(x)$ is the axial strain.\n\nThe finite element formulation introduces approximations for the displacement field. For a two-node linear element, the axial displacement $u(x)$ is interpolated from the nodal displacements $u_1$ and $u_2$ using linear shape functions $N_1(x)$ and $N_2(x)$:\n$$ u(x) = N_1(x) u_1 + N_2(x) u_2 $$\nThe standard linear shape functions for an element defined on the domain $x \\in [0, L]$ are:\n$$ N_1(x) = 1 - \\frac{x}{L} \\quad \\text{and} \\quad N_2(x) = \\frac{x}{L} $$\nIn matrix form, representing the displacement vector as $\\mathbf{d} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ and the shape function matrix as $\\mathbf{N}(x) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix}$:\n$$ u(x) = \\mathbf{N}(x) \\mathbf{d} $$\nThe axial strain $\\epsilon(x)$ is the spatial derivative of the displacement:\n$$ \\epsilon(x) = \\frac{du}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{d} $$\nWe define the strain-displacement matrix $\\mathbf{B}(x)$ as the derivative of the shape function matrix:\n$$ \\mathbf{B}(x) = \\frac{d\\mathbf{N}}{dx} = \\begin{pmatrix} \\frac{dN_1}{dx} & \\frac{dN_2}{dx} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix} $$\nNotice that for a linear element, the $\\mathbf{B}$ matrix is constant with respect to $x$. The strain is thus expressed as $\\epsilon(x) = \\mathbf{B} \\mathbf{d}$. The virtual strain is $\\delta\\epsilon(x) = \\mathbf{B} \\delta\\mathbf{d}$.\n\nThe constitutive relation for a linear elastic material (Hooke's Law) is $\\sigma(x) = E \\epsilon(x)$, where $E$ is the constant Young's modulus. Substituting the strain expression:\n$$ \\sigma(x) = E \\mathbf{B} \\mathbf{d} $$\nNow, we substitute the expressions for stress and virtual strain back into the internal virtual work integral:\n$$ \\delta W_{\\text{int}} = \\int_{0}^{L} (\\mathbf{B} \\delta\\mathbf{d})^T (E \\mathbf{B} \\mathbf{d}) A(x) \\, dx $$\nSince the nodal displacements and their variations are not functions of $x$, we can rearrange the expression:\n$$ \\delta W_{\\text{int}} = (\\delta\\mathbf{d})^T \\left( \\int_{0}^{L} \\mathbf{B}^T E A(x) \\mathbf{B} \\, dx \\right) \\mathbf{d} $$\nBy definition, the internal virtual work is also given by $\\delta W_{\\text{int}} = (\\delta\\mathbf{d})^T \\mathbf{f} = (\\delta\\mathbf{d})^T \\mathbf{K} \\mathbf{d}$. Comparing these forms gives the formula for the element stiffness matrix $\\mathbf{K}$:\n$$ \\mathbf{K} = \\int_{0}^{L} \\mathbf{B}^T E A(x) \\mathbf{B} \\, dx $$\nThe problem states that the cross-sectional area $A(x)$ varies linearly from $A_1$ at $x=0$ to $A_2$ at $x=L$. We can express this linear variation using the same shape functions:\n$$ A(x) = N_1(x) A_1 + N_2(x) A_2 = \\left(1 - \\frac{x}{L}\\right) A_1 + \\left(\\frac{x}{L}\\right) A_2 $$\nNow we substitute the constant matrix $\\mathbf{B}$ and the function $A(x)$ into the integral for $\\mathbf{K}$:\n$$ \\mathbf{K} = \\int_{0}^{L} \\begin{pmatrix} -\\frac{1}{L} \\\\ \\frac{1}{L} \\end{pmatrix} E \\left[ \\left(1 - \\frac{x}{L}\\right) A_1 + \\frac{x}{L} A_2 \\right] \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix} \\, dx $$\nThe matrix multiplication results in:\n$$ \\mathbf{B}^T \\mathbf{B} = \\begin{pmatrix} -\\frac{1}{L} \\\\ \\frac{1}{L} \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{pmatrix} = \\frac{1}{L^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nWe can factor the constant terms $E$ and the matrix $\\mathbf{B}^T \\mathbf{B}$ out of the integral:\n$$ \\mathbf{K} = \\frac{E}{L^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\int_{0}^{L} \\left[ \\left(1 - \\frac{x}{L}\\right) A_1 + \\frac{x}{L} A_2 \\right] \\, dx $$\nNow we evaluate the integral:\n$$ \\int_{0}^{L} \\left[ A_1 + \\frac{x}{L}(A_2 - A_1) \\right] \\, dx = \\left[ A_1 x + \\frac{(A_2 - A_1)}{L} \\frac{x^2}{2} \\right]_{0}^{L} $$\n$$ = \\left( A_1 L + \\frac{(A_2 - A_1)}{L} \\frac{L^2}{2} \\right) - (0) = A_1 L + \\frac{(A_2 - A_1)L}{2} $$\n$$ = L \\left( A_1 + \\frac{A_2}{2} - \\frac{A_1}{2} \\right) = L \\left( \\frac{A_1 + A_2}{2} \\right) $$\nThis integral is simply the product of the bar's length $L$ and its average cross-sectional area $\\frac{A_1 + A_2}{2}$.\nFinally, we substitute this result back into the expression for $\\mathbf{K}$:\n$$ \\mathbf{K} = \\frac{E}{L^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\left( L \\frac{A_1 + A_2}{2} \\right) $$\nSimplifying the expression yields the final form of the consistent stiffness matrix for the tapered bar element:\n$$ \\mathbf{K} = \\frac{E(A_1 + A_2)}{2L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThis result correctly reduces to the stiffness matrix of a uniform bar, $\\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$, when $A_1 = A_2 = A$. The matrix is symmetric and singular, as required for a single element stiffness matrix, reflecting its inability to resist rigid body motion.", "answer": "$$\\boxed{\\frac{E(A_1 + A_2)}{2L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}}$$", "id": "2393897"}, {"introduction": "After formulating individual element matrices, the next crucial step is to \"assemble\" them into a single global system representing the entire structure, based on a mapping between local element nodes and unique global node identifiers. This exercise tests your understanding of this core assembly logic by using a deliberately scrambled mesh. You are challenged to apply the mapping principle carefully rather than relying on simple sequential numbering, a skill essential for real-world FEM software development. [@problem_id:2393853]", "problem": "A steady one-dimensional heat conduction problem is considered on a straight, prismatic bar with constant thermal conductivity $k$ and constant cross-sectional area $A$. There is no internal heat generation. The bar is discretized using the standard Galerkin finite element method with linear Lagrange shape functions into $4$ elements over $5$ global nodes. The global node identifiers and their positions along the bar are:\n- Node $42$: $x=0.00 \\ \\mathrm{m}$\n- Node $7$: $x=0.35 \\ \\mathrm{m}$\n- Node $13$: $x=0.50 \\ \\mathrm{m}$\n- Node $5$: $x=0.90 \\ \\mathrm{m}$\n- Node $21$: $x=1.20 \\ \\mathrm{m}$\n\nThe element connectivity is intentionally scrambled and given by the following list of two-node elements $(\\text{first node}, \\text{second node})$:\n- Element $17$: $(42,7)$\n- Element $100$: $(13,7)$\n- Element $9$: $(13,5)$\n- Element $23$: $(21,5)$\n\nAssemble the global stiffness matrix for the unconstrained system (that is, before applying any boundary conditions). The rows and columns of the global stiffness matrix are to be ordered according to the node-identifier sequence $(5, \\ 42, \\ 13, \\ 21, \\ 7)$.\n\nMaterial and geometric properties are:\n- Thermal conductivity $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$\n- Cross-sectional area $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$\n\nWhat is the value of the diagonal entry of the assembled global stiffness matrix associated with global node identifier $13$? Express your answer in $\\mathrm{W \\, K^{-1}}$ and round your answer to $4$ significant figures.", "solution": "The governing differential equation for steady one-dimensional heat conduction in a prismatic bar with constant thermal conductivity $k$ and cross-sectional area $A$ without internal heat generation is\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k A \\, \\frac{\\mathrm{d}T}{\\mathrm{d}x}\\right) \\,=\\, 0.\n$$\nThe standard Galerkin finite element method with linear Lagrange shape functions over a two-node element of length $L_{e}$ produces the element stiffness matrix\n$$\n\\mathbf{K}^{(e)} \\,=\\, \\int_{0}^{L_{e}} k A \\, \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right)^{\\!\\top} \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right) \\, \\mathrm{d}x,\n$$\nwhere $\\mathbf{N} = \\begin{bmatrix} N_{1} & N_{2} \\end{bmatrix}$ are the linear shape functions. For a linear two-node element, the derivatives are constant on the element, $\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}x} = -\\frac{1}{L_{e}}$ and $\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}x} = \\frac{1}{L_{e}}$, so\n$$\n\\mathbf{K}^{(e)} \\,=\\, k A \\int_{0}^{L_{e}} \n\\begin{bmatrix}\n\\frac{1}{L_{e}^{2}} & -\\frac{1}{L_{e}^{2}} \\\\\n-\\frac{1}{L_{e}^{2}} & \\frac{1}{L_{e}^{2}}\n\\end{bmatrix}\n\\mathrm{d}x\n\\,=\\, \\frac{k A}{L_{e}} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}.\n$$\n\nThus, each element contributes $\\frac{k A}{L_{e}}$ to the diagonal entries associated with its two nodes and $-\\frac{k A}{L_{e}}$ to the corresponding off-diagonal couplings. The diagonal entry of the global stiffness matrix associated with a particular global node is the sum of the diagonal contributions from the elements incident on that node.\n\nWe first compute the element lengths from the given node coordinates:\n- Element $17$ connects nodes $(42, 7)$ at $x=0.00 \\ \\mathrm{m}$ and $x=0.35 \\ \\mathrm{m}$, so $L_{17} = |0.35 - 0.00| = 0.35 \\ \\mathrm{m}$.\n- Element $100$ connects nodes $(13, 7)$ at $x=0.50 \\ \\mathrm{m}$ and $x=0.35 \\ \\mathrm{m}$, so $L_{100} = |0.50 - 0.35| = 0.15 \\ \\mathrm{m}$.\n- Element $9$ connects nodes $(13, 5)$ at $x=0.50 \\ \\mathrm{m}$ and $x=0.90 \\ \\mathrm{m}$, so $L_{9} = |0.90 - 0.50| = 0.40 \\ \\mathrm{m}$.\n- Element $23$ connects nodes $(21, 5)$ at $x=1.20 \\ \\mathrm{m}$ and $x=0.90 \\ \\mathrm{m}$, so $L_{23} = |1.20 - 0.90| = 0.30 \\ \\mathrm{m}$.\n\nGlobal node $13$ is incident on elements $100$ and $9$. Therefore, the diagonal entry of the global stiffness matrix associated with node $13$ is\n$$\nK_{(13,13)} \\,=\\, \\frac{k A}{L_{100}} \\,+\\, \\frac{k A}{L_{9}}.\n$$\n\nInsert the given material and geometric properties $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$ and $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$:\nThe product $kA$ is $180 \\times \\left(2.0 \\times 10^{-3}\\right) \\,=\\, 0.36 \\ \\mathrm{W \\, K^{-1}}$.\nThus,\n$$\nK_{(13,13)} \\,=\\, 0.36 \\left(\\frac{1}{0.15} + \\frac{1}{0.40}\\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\nCompute the reciprocal lengths:\n$$\n\\frac{1}{0.15} \\,=\\, \\frac{100}{15} \\,=\\, \\frac{20}{3} \\,=\\, 6.\\overline{6}, \n\\qquad\n\\frac{1}{0.40} \\,=\\, \\frac{10}{4} \\,=\\, \\frac{5}{2} \\,=\\, 2.5.\n$$\nTherefore,\n$$\nK_{(13,13)} \\,=\\, 0.36 \\left( \\frac{20}{3} + \\frac{5}{2} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36 \\left( \\frac{40}{6} + \\frac{15}{6} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36 \\left( \\frac{55}{6} \\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\nMultiply:\n$$\n0.36 \\left( \\frac{55}{6} \\right)\n\\,=\\, \\frac{0.36 \\times 55}{6}\n\\,=\\, 0.06 \\times 55\n\\,=\\, 3.3.\n$$\n\nHence, the diagonal entry associated with global node $13$ is $3.3 \\ \\mathrm{W \\, K^{-1}}$.\nRounding to $4$ significant figures yields $3.300 \\ \\mathrm{W \\, K^{-1}}$ as required.", "answer": "$$\\boxed{3.300}$$", "id": "2393853"}, {"introduction": "While FEM is an approximate method, it can sometimes yield surprisingly accurate results, a phenomenon known as \"superconvergence.\" This exercise explores the relationship between the finite element approximation and the true analytical solution for a specific but important case. You will discover a fundamental property of the Galerkin method with linear elements: it provides exact nodal values when the true solution is quadratic, offering a deep insight into the method's accuracy. [@problem_id:2172619]", "problem": "Consider the one-dimensional boundary value problem given by the differential equation\n$$-\\frac{d^2u}{dx^2} = f(x)$$\non the domain $x \\in [0, L]$. We are given that the exact analytical solution to this problem is a quadratic polynomial of the form $u(x) = A x^2 + Bx + C$, where $A, B, C$ are non-zero real constants.\n\nTo find an approximate solution, we employ the Finite Element Method (FEM). The domain $[0, L]$ is discretized into a uniform mesh of $N$ elements, resulting in nodes at positions $x_i = i h$ for $i=0, 1, \\dots, N$, where $h = L/N$ is the element size. We use standard P1 elements, which means the basis functions (also known as hat functions) are continuous and piecewise linear.\n\nThe weak form of the problem, evaluated for an interior test function $\\phi_i(x)$ (where $1 \\le i \\le N-1$), yields a discrete equation for the unknown nodal values $U_j \\approx u(x_j)$. This equation can be written as:\n$$ \\sum_{j=0}^{N} K_{ij} U_j = F_i $$\nwhere $K_{ij} = \\int_0^L \\frac{d\\phi_j}{dx} \\frac{d\\phi_i}{dx} dx$ are the entries of the global stiffness matrix and $F_i = \\int_0^L f(x) \\phi_i(x) dx$ are the components of the global load vector. For an interior node $i$, this equation only involves the nodal values $U_{i-1}, U_i$, and $U_{i+1}$.\n\nThe purpose of this problem is to investigate how well the exact solution satisfies this discrete system. To do this, substitute the exact nodal values of the true solution, i.e., set $U_j = u(x_j) = A x_j^2 + Bx_j + C$, into the left-hand side of the discrete equation for an interior node $i$. This gives a specific value, which we can denote as $LHS_{exact} = K_{i, i-1}u(x_{i-1}) + K_{i,i}u(x_i) + K_{i, i+1}u(x_{i+1})$. Also, calculate the corresponding right-hand side term, $RHS = F_i$.\n\nYour task is to compute the ratio $\\mathcal{R} = \\frac{LHS_{exact}}{RHS}$. Your final answer should be a single real number, which will be independent of the choice of node $x_i$, the mesh size $h$, and the specific polynomial coefficients $A, B, C$.", "solution": "We start from the strong form $-u''=f$ and the given exact solution $u(x)=A x^{2}+B x+C$, which implies $u''(x)=2A$ and hence $f(x)=-2A$, a constant.\n\nFor a uniform mesh with P1 hat functions, the stiffness entries for an interior node $i$ are obtained from\n$$\nK_{ij}=\\int_{0}^{L}\\phi_{j}'(x)\\,\\phi_{i}'(x)\\,dx.\n$$\nUsing $\\phi_{i}'=1/h$ on $[x_{i-1},x_{i}]$, $\\phi_{i}'=-1/h$ on $[x_{i},x_{i+1}]$, and zero elsewhere, we get\n$$\nK_{i,i}=\\int_{x_{i-1}}^{x_{i}}\\frac{1}{h^{2}}\\,dx+\\int_{x_{i}}^{x_{i+1}}\\frac{1}{h^{2}}\\,dx=\\frac{2}{h},\n$$\n$$\nK_{i,i-1}=\\int_{x_{i-1}}^{x_{i}}\\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)dx=-\\frac{1}{h},\\qquad\nK_{i,i+1}=\\int_{x_{i}}^{x_{i+1}}\\left(\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right)dx=-\\frac{1}{h}.\n$$\nThus, for an interior node $i$,\n$$\nLHS_{exact}=K_{i,i-1}u(x_{i-1})+K_{i,i}u(x_{i})+K_{i,i+1}u(x_{i+1})=\\frac{1}{h}\\big(2u_{i}-u_{i-1}-u_{i+1}\\big),\n$$\nwhere $u_{j}=u(x_{j})$.\n\nNow use $x_{i\\pm1}=x_{i}\\pm h$ and expand $u_{i\\pm1}$:\n$$\nu_{i\\pm1}=A(x_{i}\\pm h)^{2}+B(x_{i}\\pm h)+C=A x_{i}^{2}\\pm2A x_{i}h+A h^{2}+B x_{i}\\pm B h+C.\n$$\nThen\n$$\n2u_{i}-u_{i-1}-u_{i+1}\n=2(A x_{i}^{2}+B x_{i}+C)-\\big[A(x_{i}^{2}-2x_{i}h+h^{2})+B(x_{i}-h)+C\\big]\n-\\big[A(x_{i}^{2}+2x_{i}h+h^{2})+B(x_{i}+h)+C\\big]\n=-2A h^{2}.\n$$\nTherefore,\n$$\nLHS_{exact}=\\frac{1}{h}\\big(-2A h^{2}\\big)=-2A h.\n$$\n\nFor the load, with $f(x)=-2A$ and support of $\\phi_{i}$ on $[x_{i-1},x_{i+1}]$,\n$$\nRHS=F_{i}=\\int_{x_{i-1}}^{x_{i+1}}f(x)\\phi_{i}(x)\\,dx=-2A\\int_{x_{i-1}}^{x_{i+1}}\\phi_{i}(x)\\,dx.\n$$\nCompute the integral of the hat function piecewise:\n$$\n\\int_{x_{i-1}}^{x_{i}}\\frac{x-x_{i-1}}{h}\\,dx=\\frac{1}{h}\\cdot\\frac{h^{2}}{2}=\\frac{h}{2},\\qquad\n\\int_{x_{i}}^{x_{i+1}}\\frac{x_{i+1}-x}{h}\\,dx=\\frac{1}{h}\\cdot\\frac{h^{2}}{2}=\\frac{h}{2}.\n$$\nHence,\n$$\n\\int_{x_{i-1}}^{x_{i+1}}\\phi_{i}(x)\\,dx=h, \\quad \\text{which implies} \\quad RHS=-2A\\,h.\n$$\n\nTherefore, the ratio\n$$\n\\mathcal{R}=\\frac{LHS_{exact}}{RHS}=\\frac{-2A h}{-2A h}=1,\n$$\nwhich is independent of $i$, $h$, and $A,B,C$.", "answer": "$$\\boxed{1}$$", "id": "2172619"}]}