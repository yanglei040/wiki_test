{"hands_on_practices": [{"introduction": "Directly implementing a mathematical formula on a computer can sometimes lead to surprisingly inaccurate results, especially in finite-precision arithmetic. This first exercise explores a classic pitfall known as \"catastrophic cancellation,\" which occurs when subtracting two nearly identical floating-point numbers. By working through this problem [@problem_id:2205457], you will practice a fundamental technique—algebraic reformulation—to transform a numerically unstable expression into a stable one.", "problem": "Consider the function $f(x) = \\sqrt{x+1} - \\sqrt{x}$. For very large, positive values of $x$, computing $f(x)$ directly using standard floating-point arithmetic can lead to a significant loss of precision due to the subtraction of two nearly equal numbers. Your task is to first find an algebraically equivalent expression for $f(x)$ that is more numerically stable for large $x$ because it avoids this subtraction. Then, use this improved expression to calculate the value of $f(x)$ for $x = 4 \\times 10^{16}$.\n\nExpress your answer as a real number in scientific notation of the form $a \\times 10^b$, rounded to three significant figures.", "solution": "We want to avoid catastrophic cancellation in $f(x) = \\sqrt{x+1} - \\sqrt{x}$ for large positive $x$. Multiply numerator and denominator by the conjugate to get an algebraically equivalent form:\n$$\nf(x) = \\left(\\sqrt{x+1} - \\sqrt{x}\\right)\\frac{\\sqrt{x+1} + \\sqrt{x}}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{(x+1) - x}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}}.\n$$\nThis expression avoids subtracting two nearly equal large numbers and is therefore more numerically stable.\n\nFor $x = 4 \\times 10^{16}$, compute using the stable form:\n$$\nf(4 \\times 10^{16}) = \\frac{1}{\\sqrt{4 \\times 10^{16} + 1} + \\sqrt{4 \\times 10^{16}}}.\n$$\nNote that $\\sqrt{4 \\times 10^{16}} = 2 \\times 10^{8}$. Also,\n$$\n\\sqrt{4 \\times 10^{16} + 1} = 2 \\times 10^{8}\\sqrt{1 + \\frac{1}{4 \\times 10^{16}}}.\n$$\nLet $\\epsilon = \\frac{1}{4 \\times 10^{16}}$. Using the binomial expansion $\\sqrt{1+\\epsilon} = 1 + \\frac{\\epsilon}{2} - \\frac{\\epsilon^{2}}{8} + \\cdots$, we have\n$$\n\\sqrt{4 \\times 10^{16} + 1} = 2 \\times 10^{8}\\left(1 + \\frac{\\epsilon}{2} - \\frac{\\epsilon^{2}}{8} + \\cdots \\right) = 2 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2}).\n$$\nThus the denominator is\n$$\n\\sqrt{4 \\times 10^{16} + 1} + \\sqrt{4 \\times 10^{16}} = 4 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2}).\n$$\nTherefore,\n$$\nf(4 \\times 10^{16}) = \\frac{1}{4 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2})} = \\frac{1}{4 \\times 10^{8}}\\left(1 - \\frac{10^{8}\\epsilon}{4 \\times 10^{8}} + O(\\epsilon^{2})\\right).\n$$\nSince $\\epsilon = 2.5 \\times 10^{-17}$, the leading term is\n$$\n\\frac{1}{4 \\times 10^{8}} = 2.5 \\times 10^{-9},\n$$\nand the correction is of order $10^{-26}$, which does not affect rounding to three significant figures. Hence, to three significant figures,\n$$\nf(4 \\times 10^{16}) \\approx 2.50 \\times 10^{-9}.\n$$", "answer": "$$\\boxed{2.50 \\times 10^{-9}}$$", "id": "2205457"}, {"introduction": "Even well-known formulas can hide numerical traps. The quadratic formula is a staple of algebra, yet it can produce highly inaccurate results when one root is much smaller in magnitude than the other. This practice [@problem_id:2205401] challenges you to diagnose this instability, which again stems from catastrophic cancellation, and apply a more robust method using Vieta's formulas to compute the small root with precision.", "problem": "The time evolution of a certain quantity in a damped system is found by solving for the roots of the quadratic equation $at^2 + bt + c = 0$. For a particular experimental setup characterized by very strong damping, the coefficients are determined to be $a = 1.00$, $b = 1.00 \\times 10^7$, and $c = 1.00$. The system's long-term behavior is governed by the root with the smaller absolute value.\n\nDetermine the value of the root of the equation $t^2 + (1.00 \\times 10^7) t + 1.00 = 0$ that has the smaller magnitude.\n\nProvide your answer as a real number, rounded to three significant figures.", "solution": "The problem asks for the root with the smaller magnitude of the quadratic equation $at^2 + bt + c = 0$, where $a=1.00$, $b=1.00 \\times 10^7$, and $c=1.00$.\n\nThe standard quadratic formula for the roots of this equation is:\n$$t = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n\nSubstituting the given values, we get:\n$$t = \\frac{-1.00 \\times 10^7 \\pm \\sqrt{(1.00 \\times 10^7)^2 - 4(1.00)(1.00)}}{2(1.00)}$$\n$$t = \\frac{-10^7 \\pm \\sqrt{10^{14} - 4}}{2}$$\n\nThis gives two roots:\n$$t_1 = \\frac{-10^7 + \\sqrt{10^{14} - 4}}{2}$$\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\n\nWe need to identify the root with the smaller magnitude.\nFor $t_2$, the numerator is the sum of two large negative numbers. So, $|t_2| \\approx \\frac{10^7 + 10^7}{2} = 10^7$.\nFor $t_1$, the term $\\sqrt{10^{14} - 4}$ is extremely close to $\\sqrt{10^{14}} = 10^7$. The numerator, therefore, involves the subtraction of two nearly equal numbers: $-10^7$ and a number slightly less than $10^7$. This means that $t_1$ will have a very small magnitude. Thus, $t_1$ is the root we are looking for.\n\nHowever, calculating $t_1$ directly using this formula is problematic in finite-precision arithmetic. The subtraction of two nearly equal numbers leads to a loss of significant figures, an effect known as catastrophic cancellation. For example, if a calculator holds 8 significant figures, $\\sqrt{10^{14}-4}$ would be evaluated as $10^7$, and the numerator would become $-10^7 + 10^7 = 0$, leading to an incorrect root of $0$.\n\nTo find an accurate value for $t_1$, we must use a numerically stable method. We can leverage Vieta's formulas, which relate the coefficients of a polynomial to its roots. For a quadratic equation, the product of the roots is given by $t_1 t_2 = \\frac{c}{a}$.\n\nWe can first calculate $t_2$, as its formula involves the addition of two large numbers of the same sign, which is numerically stable.\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\nSince $10^{14} \\gg 4$, $\\sqrt{10^{14}-4}$ is very close to $10^7$. So, $t_2 \\approx \\frac{-10^7 - 10^7}{2} = -10^7$.\n\nNow, we can find $t_1$ using the relation $t_1 = \\frac{c/a}{t_2}$:\n$$t_1 = \\frac{1.00/1.00}{t_2} = \\frac{1}{t_2} = \\frac{1}{\\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}} = \\frac{2}{-10^7 - \\sqrt{10^{14} - 4}}$$\nThis expression for $t_1$ is numerically stable because the denominator involves the addition of two large negative numbers.\n\nTo evaluate this, we can again note that the denominator is approximately $-10^7 - 10^7 = -2 \\times 10^7$.\n$$t_1 \\approx \\frac{2}{-2 \\times 10^7} = -1 \\times 10^{-7}$$\n\nTo confirm this and obtain the required precision, we can use the binomial approximation. Let $\\delta = \\frac{4ac}{b^2} = \\frac{4}{10^{14}} = 4 \\times 10^{-14}$.\nThe term $\\sqrt{b^2 - 4ac}$ can be written as $|b|\\sqrt{1 - \\frac{4ac}{b^2}} = b\\sqrt{1-\\delta}$ (since $b0$).\nUsing the Taylor expansion $(1-x)^{1/2} \\approx 1 - \\frac{1}{2}x$ for small $x$:\n$$ \\sqrt{b^2 - 4ac} \\approx b \\left(1 - \\frac{1}{2}\\frac{4ac}{b^2}\\right) = b - \\frac{2ac}{b} $$\nSubstituting this into the unstable formula for $t_1$:\n$$ t_1 = \\frac{-b + \\sqrt{b^2-4ac}}{2a} \\approx \\frac{-b + (b - \\frac{2ac}{b})}{2a} = \\frac{-2ac/b}{2a} = -\\frac{c}{b} $$\nThis gives a very accurate approximation for the small root:\n$$ t_1 \\approx -\\frac{c}{b} = -\\frac{1.00}{1.00 \\times 10^7} = -1.00 \\times 10^{-7} $$\nThis result is consistent with the calculation from the stable formula.\n\nRounding the result to three significant figures, we get $-1.00 \\times 10^{-7}$.", "answer": "$$\\boxed{-1.00 \\times 10^{-7}}$$", "id": "2205401"}, {"introduction": "Numerical stability extends beyond single calculations to iterative algorithms that model how systems evolve over time. In this problem [@problem_id:2205446], you will investigate the explicit Euler method, a basic technique for solving differential equations. You will discover how a seemingly reasonable choice for the time step can cause the numerical solution to diverge explosively, demonstrating the critical concept of algorithmic stability and its practical implications.", "problem": "A scientist is modeling the concentration of a chemical reactant, $C(t)$, in a simple first-order reaction. The rate of change of the reactant's concentration is directly proportional to the concentration itself, following the differential equation:\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\nThe rate constant is given as $k = 50.0 \\text{ s}^{-1}$, and the initial concentration at time $t=0$ is $C(0) = 100.0 \\text{ mol/L}$.\n\nTo predict the concentration at future times, the scientist employs a numerical scheme using a fixed time step, $h$. This method approximates the concentration at time $t_{n+1} = (n+1)h$ using the value at the previous time step, $t_n = nh$, according to the explicit Euler update rule:\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)_{t=t_n}\n$$\nThe scientist decides to use a time step of $h = 0.0410 \\text{ s}$. Calculate the numerical value of the concentration, $C_3$, predicted by this method after three time steps. Express your answer in mol/L, rounded to three significant figures.", "solution": "We are given the first-order linear ODE $\\frac{dC}{dt}=-kC(t)$ and the explicit Euler update\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)_{t=t_{n}}=C_{n}+h(-kC_{n})=(1-kh)C_{n}.\n$$\nBy recursion, this yields\n$$\nC_{n}=C_{0}(1-kh)^{n}.\n$$\nWith $C_{0}=100.0$, $k=50.0\\,\\text{s}^{-1}$, and $h=0.0410\\,\\text{s}$, the dimensionless product is\n$$\nkh=(50.0)(0.0410)=2.05,\\quad 1-kh=1-2.05=-1.05.\n$$\nThus after three steps,\n$$\nC_{3}=100.0\\,(-1.05)^{3}.\n$$\nCompute the power:\n$$\n(-1.05)^{2}=1.1025,\\quad (-1.05)^{3}=1.1025\\times(-1.05)=-1.157625,\n$$\nso\n$$\nC_{3}=100.0\\times(-1.157625)=-115.7625.\n$$\nRounding to three significant figures gives $-1.16\\times 10^{2}$, i.e., $-116$. Note that the explicit Euler factor satisfies $|1-kh|=1.051$, indicating instability for this step size, which explains the unphysical sign change.", "answer": "$$\\boxed{-116}$$", "id": "2205446"}]}