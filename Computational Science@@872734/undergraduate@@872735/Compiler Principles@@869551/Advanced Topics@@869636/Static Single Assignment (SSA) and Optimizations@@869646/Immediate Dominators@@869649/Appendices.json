{"hands_on_practices": [{"introduction": "To build a solid intuition for dominators, we must start with the fundamental definition. This first exercise challenges you to compute an immediate dominator by manually tracing all paths through a simple Control Flow Graph. By working directly from first principles, you'll gain a concrete understanding of why a dominator must be present on *every* path to a given node [@problem_id:3645211].", "problem": "You are given a directed Control Flow Graph (CFG) with entry node $s$ and nodes $a$, $b$, $c$, and $j$. The CFG has edges $s \\to a$, $s \\to b$, $s \\to c$, and $a \\to j$, $b \\to j$, $c \\to j$. All nodes are reachable from $s$. Using only the fundamental definitions of dominance and immediate dominance, determine $\\mathrm{idom}(j)$ for this CFG. Then, consider a modified CFG obtained by additionally adding the edge $b \\to a$; determine the new $\\mathrm{idom}(j)$ for the modified CFG.\n\nDefinitions to use:\n- A node $x$ dominates a node $y$ if every directed path from the entry node $s$ to $y$ contains $x$.\n- A node $x$ strictly dominates a node $y$ if $x$ dominates $y$ and $x \\neq y$.\n- The immediate dominator $\\mathrm{idom}(y)$ of $y$ is the unique strict dominator of $y$ that does not strictly dominate any other strict dominator of $y$.\n\nReport your final answer as a two-entry row vector $\\left(x, y\\right)$, where $x$ is $\\mathrm{idom}(j)$ in the original CFG and $y$ is $\\mathrm{idom}(j)$ in the modified CFG, written using the LaTeX $\\mathrm{pmatrix}$ environment as $\\begin{pmatrix} x & y \\end{pmatrix}$. No rounding is needed, and no physical units are involved. Express node names as mathematical symbols (e.g., $s$, $a$).", "solution": "This problem requires the determination of the immediate dominator of a node in a Control Flow Graph (CFG) and a modified version of it, based on first principles.\n\n### Problem Analysis\n\n**Step 1: Understand the Givens**\n- **Original CFG ($G_1$):**\n  - Nodes: $\\{s, a, b, c, j\\}$\n  - Entry node: $s$\n  - Edges: $\\{(s, a), (s, b), (s, c), (a, j), (b, j), (c, j)\\}$\n- **Modified CFG ($G_2$):**\n  - Original CFG with an additional edge: $(b, a)$\n- **Definitions:**\n  - **Dominance:** A node $x$ dominates a node $y$ if every path from the entry node $s$ to $y$ contains $x$.\n  - **Strict Dominance:** A node $x$ strictly dominates $y$ if $x$ dominates $y$ and $x \\neq y$.\n  - **Immediate Dominator ($\\mathrm{idom}(y)$):** The unique strict dominator of $y$ that does not strictly dominate any other strict dominator of $y$.\n\n### Part 1: Analysis of the Original CFG ($G_1$)\n\nTo find $\\mathrm{idom}(j)$, we first identify all paths from the entry node $s$ to the target node $j$.\nThe simple paths in $G_1$ are:\n1. $P_1: s \\to a \\to j$\n2. $P_2: s \\to b \\to j$\n3. $P_3: s \\to c \\to j$\n\nAccording to the definition, the set of dominators of $j$, denoted $\\mathrm{dom}(j)$, is the intersection of the sets of nodes for each path.\n- Nodes in $P_1$: $\\{s, a, j\\}$\n- Nodes in $P_2$: $\\{s, b, j\\}$\n- Nodes in $P_3$: $\\{s, c, j\\}$\n\n$$ \\mathrm{dom}(j) = \\{s, a, j\\} \\cap \\{s, b, j\\} \\cap \\{s, c, j\\} = \\{s, j\\} $$\nThe nodes that dominate $j$ are $s$ and $j$ itself.\n\nNext, we find the set of strict dominators of $j$, which are dominators other than $j$.\n$$ \\mathrm{sdom}(j) = \\mathrm{dom}(j) \\setminus \\{j\\} = \\{s\\} $$\n\nThe set of strict dominators has only one element, $s$. By definition, this single element must be the immediate dominator, as there are no other strict dominators for it to dominate or be dominated by.\nTherefore, for the original CFG, $\\mathrm{idom}(j) = s$.\n\n### Part 2: Analysis of the Modified CFG ($G_2$)\n\nThe modified CFG, $G_2$, is formed by adding the edge $(b, a)$ to $G_1$. We re-evaluate the paths from $s$ to $j$.\nThe addition of the edge $(b, a)$ introduces a new path. The simple paths are:\n1. $P_1: s \\to a \\to j$\n2. $P_2: s \\to b \\to j$\n3. $P_3: s \\to c \\to j$\n4. $P_4: s \\to b \\to a \\to j$\n\nNow we find the set of dominators of $j$ by intersecting the node sets of all four paths.\n- Nodes in $P_1$: $\\{s, a, j\\}$\n- Nodes in $P_2$: $\\{s, b, j\\}$\n- Nodes in $P_3$: $\\{s, c, j\\}$\n- Nodes in $P_4$: $\\{s, b, a, j\\}$\n\n$$ \\mathrm{dom}(j) = \\{s, a, j\\} \\cap \\{s, b, j\\} \\cap \\{s, c, j\\} \\cap \\{s, b, a, j\\} $$\nThe intersection of $\\{s, b, j\\}$ and $\\{s, c, j\\}$ is $\\{s, j\\}$. Including the other sets does not add any other common nodes.\n$$ \\mathrm{dom}(j) = \\{s, j\\} $$\n\nThe set of strict dominators of $j$ is again:\n$$ \\mathrm{sdom}(j) = \\mathrm{dom}(j) \\setminus \\{j\\} = \\{s\\} $$\n\nAs before, the set of strict dominators contains only the single node $s$. Thus, $s$ is the immediate dominator.\nTherefore, for the modified CFG, $\\mathrm{idom}(j) = s$.\n\n### Conclusion\n\nFor the original CFG, the immediate dominator of $j$ is $s$.\nFor the modified CFG, the immediate dominator of $j$ is also $s$.\nThe final answer is the row vector $(s, s)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} s & s \\end{pmatrix}}\n$$", "id": "3645211"}, {"introduction": "Immediate dominators are not merely a theoretical curiosity; they are instrumental in enabling practical compiler optimizations. This practice moves from static calculation to dynamic reasoning, asking you to analyze the effect of \"critical edge splitting\"â€”a common transformation used to create safe insertion points for new code. By thinking through how this structural change alters the set of paths, you will develop a deeper insight into how dominance relationships behave within an evolving graph [@problem_id:3645173].", "problem": "Let a Control Flow Graph (CFG) be a directed graph with a distinguished entry node, where program execution follows paths along edges. A node $d$ is said to dominate a node $n$ if every path from the entry to $n$ contains $d$. A strict dominator of $n$ is a dominator $d$ with $d \\neq n$. The immediate dominator of $n$, denoted $\\mathrm{idom}(n)$, is the unique strict dominator of $n$ that does not strictly dominate any other strict dominator of $n$. An edge $p \\to q$ is called critical if $outdeg(p) > 1$ and $indeg(q) > 1$. Consider splitting a critical edge $p \\to q$ by inserting a fresh node $m$ such that the original edge $p \\to q$ is replaced by two edges $p \\to m$ and $m \\to q$, and no other edges are added to or removed from the graph. The resulting node $m$ has exactly one predecessor $p$ and exactly one successor $q$. Assume the entry, reachability, and the set of paths among the original nodes remain otherwise unchanged by the insertion of $m$.\n\nFrom the fundamental definitions above, reason about the effect of this edge split on immediate dominators. In particular, determine the correct relationship among $\\mathrm{idom}(m)$ and $\\mathrm{idom}(q)$ in the modified graph relative to the original graph.\n\nWhich option is correct?\n\nA. $\\mathrm{idom}(m) = p$ and $\\mathrm{idom}(q)$ is unchanged relative to its value before the split.\n\nB. $\\mathrm{idom}(m) = p$ and $\\mathrm{idom}(q) = m$.\n\nC. $\\mathrm{idom}(m) = \\mathrm{idom}(p)$ and $\\mathrm{idom}(q)$ is unchanged relative to its value before the split.\n\nD. $\\mathrm{idom}(m) = p$ and $\\mathrm{idom}(q) = p$ even if $\\mathrm{idom}(q)$ was different before the split.\n\nE. $\\mathrm{idom}(m) = \\mathrm{idom}(q)$ and $\\mathrm{idom}(q)$ is unchanged relative to its value before the split.", "solution": "This problem requires an analysis of the effect of splitting a critical edge in a Control Flow Graph (CFG) on the immediate dominators of the involved nodes.\n\n### Problem Analysis\nLet the original CFG be $G = (V, E)$ and the modified CFG be $G' = (V \\cup \\{m\\}, E')$, where $E' = (E \\setminus \\{p \\to q\\}) \\cup \\{p \\to m, m \\to q\\}$. Let $entry$ be the entry node of the CFG.\n\n#### Analysis of $\\mathrm{idom}(m)$\n1.  By construction, the new node $m$ has exactly one predecessor, the node $p$. The only incoming edge to $m$ is $p \\to m$.\n2.  Therefore, any path from the $entry$ node to $m$ must have the form $entry \\to \\dots \\to p \\to m$.\n3.  This means that the node $p$ is present on every path from $entry$ to $m$. By definition, $p$ dominates $m$.\n4.  Since $p \\neq m$, $p$ is a strict dominator of $m$.\n5.  Now consider any other strict dominator of $m$, say $d$. Since $d$ must be on every path from $entry$ to $m$, it must lie on the subpath from $entry$ to $p$. This implies that any other strict dominator of $m$ must also dominate $p$.\n6.  The set of strict dominators of $m$ is $\\{p\\} \\cup \\{\\text{strict dominators of } p\\}$. The strict dominator that is closest to $m$ is $p$. According to the definition, $p$ is the strict dominator of $m$ that does not strictly dominate any other strict dominator of $m$ (because all other strict dominators of $m$ also strictly dominate $p$).\n7.  Therefore, we conclude that $\\mathrm{idom}(m) = p$.\n\n#### Analysis of $\\mathrm{idom}(q)$\nLet's compare the set of dominators of $q$ in the original graph $G$ (denoted $Dom_G(q)$) with the set of dominators of $q$ in the modified graph $G'$ (denoted $Dom_{G'}(q)$).\n\n1.  A path from $entry$ to $q$ in $G'$ can be of two types:\n    a) A path that does not use the new node $m$. This path must have existed in $G$ and reaches $q$ via a predecessor other than $p$.\n    b) A path that uses the new node $m$. This path must have the form $entry \\to \\dots \\to p \\to m \\to q$. This corresponds to a path $\\pi = entry \\to \\dots \\to p \\to q$ in the original graph $G$.\n2.  Consider any dominator $d \\in Dom_G(q)$. This means $d$ is on every path to $q$ in $G$. Does $d$ lie on every path to $q$ in $G'$?\n    - For a path of type (a), since it also exists in $G$, $d$ must be on it.\n    - For a path of type (b), it corresponds to a path in $G$ that contains $d$. Since the transformation only replaces $p \\to q$ with $p \\to m \\to q$, $d$ must be on the $entry \\to \\dots \\to p$ segment, and thus is also on the new path.\n    So, any dominator of $q$ in $G$ is also a dominator of $q$ in $G'$. Thus, $Dom_G(q) \\subseteq Dom_{G'}(q)$.\n3.  Now consider any dominator $d' \\in Dom_{G'}(q)$. Could $d'$ be a node that was not in $Dom_G(q)$?\n    - The only new node is $m$. Can $m$ be a dominator of $q$? No. Since the edge $p \\to q$ was critical, $indeg(q) > 1$. This means there is at least one other predecessor of $q$, say $u \\neq p$, in the original graph. The path $entry \\to \\dots \\to u \\to q$ still exists in $G'$ and does not contain $m$. Therefore, $m$ does not dominate $q$.\n    - So, $d'$ must be an original node from $V$. Consider any path to $q$ in $G$. If it did not use $p \\to q$, it also exists in $G'$, so $d'$ must be on it. If it did use $p \\to q$, it corresponds to the path through $m$ in $G'$, so $d'$ must be on that path too.\n    So, any dominator of $q$ in $G'$ is also a dominator of $q$ in $G$. Thus, $Dom_{G'}(q) \\subseteq Dom_G(q)$.\n4.  From these points, we conclude that $Dom_G(q) = Dom_{G'}(q)$. The set of dominators of $q$ is unchanged.\n5.  Since the set of strict dominators is unchanged, and the domination relationships among these dominators are also unchanged (the transformation does not add paths between original nodes), the immediate dominator of $q$ must also be unchanged.\n\n**Conclusion**: After splitting the critical edge $p \\to q$, we have $\\mathrm{idom}(m) = p$ and $\\mathrm{idom}(q)$ is unchanged. This matches option A.\n\n### Option-by-Option Analysis\n\n-   **A. $\\mathrm{idom}(m) = p$ and $\\mathrm{idom}(q)$ is unchanged relative to its value before the split.** This matches our derived result. **Correct.**\n-   **B. $\\mathrm{idom}(m) = p$ and $\\mathrm{idom}(q) = m$.** This is incorrect. As shown above, $m$ does not dominate $q$ because other paths to $q$ exist that bypass $m$.\n-   **C. $\\mathrm{idom}(m) = \\mathrm{idom}(p)$ and $\\mathrm{idom}(q)$ is unchanged relative to its value before the split.** This is incorrect. We proved $\\mathrm{idom}(m) = p$, not $\\mathrm{idom}(p)$.\n-   **D. $\\mathrm{idom}(m) = p$ and $\\mathrm{idom}(q) = p$ even if $\\mathrm{idom}(q)$ was different before the split.** This is incorrect. As with option B, $p$ does not necessarily dominate $q$ (other paths to $q$ may not pass through $p$), so it cannot be $\\mathrm{idom}(q)$ in the general case.\n-   **E. $\\mathrm{idom}(m) = \\mathrm{idom}(q)$ and $\\mathrm{idom}(q)$ is unchanged relative to its value before the split.** This is incorrect. It implies $\\mathrm{idom}(m) = p$ is equal to the original $\\mathrm{idom}(q)$, which is not generally true.", "answer": "$$\\boxed{A}$$", "id": "3645173"}, {"introduction": "Loops are central to program behavior and a primary target for optimization, with their structure fundamentally defined by dominators and backedges. This final exercise explores what happens when we split a backedge, the very component that closes a loop. You will investigate how this transformation impacts the immediate dominators within the loop and discover how these changes relate to preserving crucial graph properties like reducibility [@problem_id:3645221].", "problem": "Consider the Control Flow Graph (CFG) $G = (V, E)$ with unique entry node $s$ and unique exit node $e$. The node set is $$V = \\{s, h, x_1, x_2, y, b, e\\}$$ and the edge set is $$E = \\{(s,h), (h,x_1), (h,x_2), (x_1,b), (x_2,y), (y,b), (b,h), (h,e)\\}.$$ Assume there are no edges other than those listed. The edge $(b,h)$ is a backedge and the loop header is $h$, so the loop formed by $(b,h)$ is a natural loop and $G$ is reducible.\n\nNow, split the backedge $(b,h)$ by introducing a new node $t$ and replacing $(b,h)$ with $(b,t)$ and $(t,h)$, where $t$ has no predecessors other than $b$ and no successors other than $h$. Let the modified graph be $G' = (V \\cup \\{t\\}, E' = (E \\setminus \\{(b,h)\\}) \\cup \\{(b,t), (t,h)\\})$.\n\nUsing only the core definitions of dominance and immediate dominance in a Control Flow Graph, determine which of the following statements are true.\n\nA. In $G$, the immediate dominator of $b$ is $h$, i.e., $\\mathrm{idom}(b) = h$.\n\nB. In $G'$, the immediate dominator of $b$ changes to $t$, i.e., $\\mathrm{idom}(b) = t$.\n\nC. In $G'$, the immediate dominator of $t$ is $b$, i.e., $\\mathrm{idom}(t) = b$.\n\nD. In $G'$, the immediate dominator of $h$ becomes $t$, i.e., $\\mathrm{idom}(h) = t$.\n\nE. Splitting the backedge as specified preserves reducibility of the Control Flow Graph.", "solution": "This problem requires an analysis of a Control Flow Graph (CFG), focusing on how immediate dominators and graph reducibility are affected by splitting a backedge.\n\n### Core Definitions\n-   **Dominance:** A node $d$ dominates a node $n$ if every path from the entry node to $n$ contains $d$.\n-   **Immediate Dominance ($\\mathrm{idom}(n)$):** The unique strict dominator of $n$ that is \"closest\" to $n$.\n-   **Backedge:** An edge $(u, v)$ where the head $v$ dominates the tail $u$.\n-   **Reducible Graph:** A CFG where all loops have single entry points. Equivalently, its edges can be partitioned into forward edges (which form a DAG) and backedges (where the head dominates the tail).\n\n### Analysis of the Original Graph $G$\n\nThe graph $G$ has entry node $s$. The paths from $s$ to node $b$ are:\n-   $P_1: s \\to h \\to x_1 \\to b$\n-   $P_2: s \\to h \\to x_2 \\to y \\to b$\n\n**Statement A: In $G$, the immediate dominator of $b$ is $h$, i.e., $\\mathrm{idom}(b) = h$.**\nThe set of nodes common to all paths from $s$ to $b$ is $\\{s, h, b\\}$. These are the dominators of $b$. The strict dominators are $\\{s, h\\}$. To find the immediate dominator, we check the relationship between $s$ and $h$. The only path from $s$ to $h$ is $s \\to h$ (ignoring loops), so $s$ dominates $h$. This means $h$ is \"closer\" to $b$ in the dominator tree than $s$ is. Therefore, $h$ is the immediate dominator of $b$.\n**Verdict: A is True.**\n\n### Analysis of the Modified Graph $G'$\n\nThe graph $G'$ is formed by replacing the edge $(b,h)$ with the path $b \\to t \\to h$.\n\n**Statement B: In $G'$, the immediate dominator of $b$ changes to $t$, i.e., $\\mathrm{idom}(b) = t$.**\nThe transformation affects the successors of $b$, not its predecessors. The paths from $s$ to $b$ in $G'$ are identical to those in $G$. Therefore, the dominators of $b$ are unchanged, and $\\mathrm{idom}(b)$ remains $h$. Furthermore, $t$ is a successor of $b$, so it cannot be on any path *to* $b$; thus it cannot dominate $b$.\n**Verdict: B is False.**\n\n**Statement C: In $G'$, the immediate dominator of $t$ is $b$, i.e., $\\mathrm{idom}(t) = b$.**\nBy construction, the new node $t$ has only one predecessor, $b$. Any path from $s$ to $t$ must first reach $b$ and then traverse the edge $(b,t)$. Thus, every path to $t$ contains $b$. This makes $b$ a strict dominator of $t$. Since $b$ is the immediate predecessor, it must be the closest dominator.\n**Verdict: C is True.**\n\n**Statement D: In $G'$, the immediate dominator of $h$ becomes $t$, i.e., $\\mathrm{idom}(h) = t$.**\nIn both $G$ and $G'$, there is a direct edge $s \\to h$. Any path from the entry node $s$ to $h$ must start with $s$. Since the path $s \\to h$ exists, the only nodes that could possibly dominate $h$ are $s$ and $h$ itself. Node $t$ is not on this path, so it cannot dominate $h$. The immediate dominator of $h$ is and remains $s$.\n**Verdict: D is False.**\n\n**Statement E: Splitting the backedge as specified preserves reducibility of the Control Flow Graph.**\nA graph is reducible if all its backedges have heads that dominate their tails.\n- In the original graph $G$, the only backedge was $(b,h)$. We confirmed $h$ dominates $b$, so $G$ is reducible as stated.\n- In the modified graph $G'$, the original backedge is gone. We must check the new edges.\n  - The edge $(b,t)$ is not a backedge, as $t$ does not dominate $b$. It's a forward edge.\n  - The edge $(t,h)$ closes the loop. Is it a backedge? Yes, if its head ($h$) dominates its tail ($t$).\n- Let's check if $h$ dominates $t$. The paths to $t$ are $s \\to h \\to x_1 \\to b \\to t$ and $s \\to h \\to x_2 \\to y \\to b \\to t$. Both paths contain $h$. Therefore, $h$ dominates $t$.\n- Since the only backedge in $G'$, which is $(t,h)$, has a head ($h$) that dominates its tail ($t$), the graph $G'$ is reducible. The transformation preserved reducibility.\n**Verdict: E is True.**\n\n### Final Conclusion\nThe true statements are A, C, and E.", "answer": "$$\\boxed{ACE}$$", "id": "3645221"}]}