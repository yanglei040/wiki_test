{"hands_on_practices": [{"introduction": "The name \"shock-capturing\" can be misleading, suggesting these numerical methods are only useful when discontinuities are present. However, a key feature of modern schemes is their \"high-resolution\" nature, designed to minimize numerical errors in all parts of the flow. This first exercise challenges that misconception by asking you to compare scheme performance in a perfectly smooth flow, demonstrating the critical role of higher-order accuracy in reducing numerical diffusion even when no shocks exist. [@problem_id:1761774]", "problem": "A computational fluid dynamics researcher is simulating a one-dimensional, subsonic, inviscid flow governed by the Euler equations. The initial condition for the flow consists of a smooth, slowly-varying sinusoidal wave in velocity and pressure propagating through a uniform medium. There are no shocks, contact discontinuities, or any other sharp gradients present in the initial state, and none are expected to form during the simulation time.\n\nThe researcher must select a numerical scheme for spatial discretization and is considering two common options:\n1.  A standard first-order upwind scheme.\n2.  A high-resolution Total Variation Diminishing (TVD) scheme, such as a MUSCL scheme that utilizes a flux limiter to achieve second-order accuracy in smooth regions.\n\nWhile the first-order scheme is computationally cheaper, accuracy is the primary concern. Which of the following statements most accurately describes the expected difference in simulation accuracy between these two schemes for this specific smooth-flow problem?\n\nA. There will be no significant difference in accuracy because the primary advantage of a TVD scheme is its ability to handle shocks, and since there are no shocks, both schemes will perform similarly.\n\nB. The first-order upwind scheme will be significantly more accurate because its inherent numerical diffusion is beneficial for smooth flows, helping to damp out any non-physical oscillations and maintain a stable solution profile.\n\nC. The high-resolution TVD scheme will be significantly more accurate because it is designed to operate as a second-order accurate scheme in smooth regions of the flow, resulting in substantially lower numerical error than the purely first-order scheme.\n\nD. There will be no significant difference in accuracy because the \"high-resolution\" and TVD properties are only activated in the presence of steep gradients. In a smooth flow, a TVD scheme effectively defaults to a first-order scheme, making its performance equivalent to the upwind scheme.\n\nE. Both schemes will produce highly inaccurate results, as both first-order upwind and TVD schemes are specifically designed for capturing shocks in compressible flows and are fundamentally unsuitable for simulating smooth, subsonic wave propagation.", "solution": "We analyze the expected accuracy of the two schemes for a one-dimensional, smooth, subsonic, inviscid Euler flow featuring only slowly varying sinusoidal perturbations. The governing equations are hyperbolic conservation laws, and we focus on spatial discretization accuracy in smooth regions.\n\nFirst, recall the concept of local truncation error and formal order of accuracy. A standard first-order upwind discretization of a linear hyperbolic equation such as $\\partial_{t} u + a \\partial_{x} u = 0$ has a local truncation error of order $O(\\Delta x)$ in space. A modified equation analysis shows that the first-order upwind scheme behaves like the original advection equation with an added artificial diffusion term of the form $\\nu_{\\text{num}} \\partial_{xx} u$, where the numerical viscosity coefficient scales as $\\nu_{\\text{num}} = O(\\Delta x)$. For smooth waves (e.g., a sinusoid), this causes amplitude damping and phase errors that decay only linearly with grid refinement.\n\nIn contrast, a MUSCL-type TVD scheme with an appropriate flux limiter is designed to be second-order accurate in smooth regions. In smooth flows, the ratio of consecutive gradients $r$ in the limiter function satisfies $r \\approx 1$, so standard limiters (e.g., van Leer, MC, van Albada) return slopes that are essentially unlimited, thereby recovering a linear reconstruction and yielding second-order spatial accuracy. Consequently, the local truncation error is $O(\\Delta x^2)$, and both dissipative and dispersive errors are substantially smaller than those of the first-order scheme at the same resolution.\n\nBecause the initial condition and the evolving solution remain smooth, the TVD limiter does not need to activate strongly to suppress oscillations (there are no discontinuities), so the scheme operates in its high-resolution, second-order regime almost everywhere and almost all the time. Therefore, relative to first-order upwind, the TVD scheme will exhibit significantly reduced numerical diffusion and better phase accuracy for the sinusoidal wave, leading to substantially lower numerical error.\n\nWe now address the options:\n- Option A is incorrect: although TVD methods are designed to be non-oscillatory near discontinuities, their principal advantage is that they retain second-order accuracy in smooth regions; here, the flow is smooth, so the TVD scheme is more accurate.\n- Option B is incorrect: while numerical diffusion can suppress spurious oscillations near discontinuities, in a smooth sinusoidal wave it primarily damps the physical wave amplitude and induces phase error. This reduces accuracy rather than improving it.\n- Option C is correct: in smooth regions, the MUSCL-TVD scheme is second-order accurate with error $O(\\Delta x^2)$, whereas the first-order upwind scheme has error $O(\\Delta x)$. This yields a significant accuracy advantage for the TVD scheme in the stated problem.\n- Option D is incorrect: TVD schemes do not default to first order in smooth regions; rather, the limiter recovers second-order behavior when the solution is smooth.\n- Option E is incorrect: both schemes are commonly used for smooth subsonic wave propagation; the issue is not suitability but order of accuracy and numerical dissipation.\n\nTherefore, the high-resolution TVD scheme will be significantly more accurate for this smooth-flow problem due to its second-order accuracy in smooth regions, producing substantially lower numerical error than the first-order upwind method.", "answer": "$$\\boxed{C}$$", "id": "1761774"}, {"introduction": "After understanding scheme behavior in smooth regions, we turn to their primary task of representing shocks. Visually, it is easy to see that some schemes produce sharper shocks than others, but rigorous engineering and science require quantitative metrics. This practice moves beyond qualitative assessment by asking you to calculate a \"gradient-weighted spread,\" a metric that quantifies the amount of numerical smearing, or diffusion, introduced by a scheme at a shock front. [@problem_id:1761739]", "problem": "A Computational Fluid Dynamics (CFD) engineer is analyzing the performance of two different numerical schemes for capturing shock waves. The test case involves the one-dimensional inviscid Burgers' equation, $\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\frac{1}{2}u^2\\right) = 0$, on the spatial domain $x \\in [0, 2]$. The initial condition at time $t=0$ is a step discontinuity described by $u(x,0) = 2$ for $x  0.5$ and $u(x,0) = 1$ for $x \\ge 0.5$.\n\nThe simulation is run until a final time $t_f$ at which the exact solution is a single shock wave located at $x_s = 1.1$. The numerical solutions obtained from Scheme A and Scheme B, while capturing the shock, exhibit different amounts of numerical diffusion, which smears the discontinuity. The engineer finds that the resulting numerical profiles can be accurately modeled by the following analytical functions:\n\n- Scheme A Profile: $u_A(x) = 1.5 - 0.5 \\tanh\\left(\\frac{x - 1.1}{W_A}\\right)$, with width parameter $W_A = 0.0125$.\n- Scheme B Profile: $u_B(x) = 1.5 - 0.5 \\tanh\\left(\\frac{x - 1.1}{W_B}\\right)$, with width parameter $W_B = 0.0075$.\n\nTo quantitatively compare the smearing effect, which is a manifestation of numerical diffusion, the engineer defines a \"gradient-weighted spread\" metric, $M$, given by:\n$$M = \\int_{0}^{2} (x - x_s)^2 \\left| \\frac{du}{dx} \\right| dx$$\nGiven that the shock profiles are highly localized around $x_s = 1.1$, the error introduced by extending the integration limits from $[0, 2]$ to $(-\\infty, \\infty)$ is negligible. To aid in your calculation, you may use the following standard definite integral identity:\n$$\\int_{-\\infty}^{\\infty} y^2 \\text{sech}^2(y) dy = \\frac{\\pi^2}{6}$$\n\nCalculate the ratio of the gradient-weighted spreads for the two schemes, $M_A / M_B$. Round your final answer to three significant figures.", "solution": "We treat both schemes with the common profile $u(x)=1.5-0.5\\,\\tanh\\!\\left(\\frac{x-x_{s}}{W}\\right)$, where $W=W_{A}$ or $W_{B}$ and $x_{s}=1.1$. The gradient-weighted spread is\n$$\nM=\\int_{0}^{2}(x-x_{s})^{2}\\left|\\frac{du}{dx}\\right|dx.\n$$\nSince the profile is localized around $x_{s}$, we extend the limits to $(-\\infty,\\infty)$ without significant error:\n$$\nM=\\int_{-\\infty}^{\\infty}(x-x_{s})^{2}\\left|\\frac{du}{dx}\\right|dx.\n$$\nDifferentiate $u(x)$ using $\\frac{d}{dx}\\tanh(z)=\\operatorname{sech}^{2}(z)\\,\\frac{dz}{dx}$:\n$$\n\\frac{du}{dx}=-0.5\\,\\operatorname{sech}^{2}\\!\\left(\\frac{x-x_{s}}{W}\\right)\\cdot\\frac{1}{W}.\n$$\nThus\n$$\n\\left|\\frac{du}{dx}\\right|=\\frac{0.5}{W}\\,\\operatorname{sech}^{2}\\!\\left(\\frac{x-x_{s}}{W}\\right).\n$$\nSubstitute $y=\\frac{x-x_{s}}{W}$ so that $x-x_{s}=Wy$ and $dx=W\\,dy$. Then\n$$\nM=\\int_{-\\infty}^{\\infty}(Wy)^{2}\\left(\\frac{0.5}{W}\\operatorname{sech}^{2}(y)\\right)W\\,dy\n=\\frac{1}{2}W^{2}\\int_{-\\infty}^{\\infty}y^{2}\\operatorname{sech}^{2}(y)\\,dy.\n$$\nUsing the given identity $\\int_{-\\infty}^{\\infty}y^{2}\\operatorname{sech}^{2}(y)\\,dy=\\frac{\\pi^{2}}{6}$, we obtain\n$$\nM=\\frac{\\pi^{2}}{12}W^{2}.\n$$\nTherefore, for the two schemes,\n$$\n\\frac{M_{A}}{M_{B}}=\\left(\\frac{W_{A}}{W_{B}}\\right)^{2}\n=\\left(\\frac{0.0125}{0.0075}\\right)^{2}\n=\\left(\\frac{5}{3}\\right)^{2}\n=\\frac{25}{9}\\approx 2.78,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{2.78}$$", "id": "1761739"}, {"introduction": "The ultimate test of a shock-capturing scheme is not just whether it produces a stable solution, but whether that solution is physically correct. For hyperbolic conservation laws, this is governed by the entropy condition, which ensures that only physically admissible shocks are formed. This advanced practice challenges you to implement and compare two different finite-volume schemes, using numerical entropy production as a diagnostic to determine which one generates a physically meaningful result. [@problem_id:2448972]", "problem": "Consider the one-dimensional scalar conservation law on the periodic domain $[0,1]$,\n$$\n\\partial_t u(x,t) + \\partial_x f\\big(u(x,t)\\big) = 0,\n$$\nwith flux $f(u) = \\tfrac{1}{2}u^2$ (the inviscid Burgers equation). Let the initial condition be $u(x,0) = \\sin(2\\pi x)$ for all $x \\in [0,1]$. The domain is discretized using a uniform partition into $N_x$ cells of width $\\Delta x = 1/N_x$. Denote by $u_i^n$ the cell-average approximation of $u$ at cell index $i \\in \\{0,1,\\dots,N_x-1\\}$ and time level $t^n$, with periodic boundary conditions. The evolution is computed using a conservative finite-volume update\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\right),\n$$\nwhere $F_{i+\\tfrac{1}{2}}^n$ is a consistent numerical flux evaluated at the interface between cells $i$ and $i+1$ using the left and right interface states $u_L = u_i^n$ and $u_R = u_{i+1}^n$ (with periodic indexing). Two distinct choices for the numerical flux are to be used:\n\n- Choice A (exact Riemann-solver flux for the inviscid Burgers equation): For $u_L \\le u_R$ (rarefaction case),\n$$\nF_{i+\\tfrac{1}{2}}^n =\n\\begin{cases}\n\\tfrac{1}{2}u_L^2,  \\text{if } u_L \\ge 0,\\\\\n\\tfrac{1}{2}u_R^2,  \\text{if } u_R \\le 0,\\\\\n0,  \\text{if } u_L  0  u_R,\n\\end{cases}\n$$\nand for $u_L  u_R$ (shock case) with shock speed $s = \\dfrac{f(u_R) - f(u_L)}{u_R - u_L} = \\dfrac{u_L + u_R}{2}$,\n$$\nF_{i+\\tfrac{1}{2}}^n =\n\\begin{cases}\n\\tfrac{1}{2}u_L^2,  \\text{if } s \\ge 0,\\\\\n\\tfrac{1}{2}u_R^2,  \\text{if } s  0.\n\\end{cases}\n$$\n\n- Choice B (two-step predictor-corrector central scheme): Define interface predictor states\n$$\nu_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} = \\tfrac{1}{2}\\left(u_i^n + u_{i+1}^n\\right) - \\tfrac{\\Delta t}{2\\Delta x}\\left(f(u_{i+1}^n) - f(u_i^n)\\right),\n$$\nthen update\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(f\\Big(u_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}}\\Big) - f\\Big(u_{i-\\tfrac{1}{2}}^{n+\\tfrac{1}{2}}\\Big)\\right).\n$$\n\nFor time stepping, use an explicit time step $\\Delta t$ that satisfies the Courant–Friedrichs–Lewy (CFL) condition with a given number $\\lambda \\in (0,1)$,\n$$\n\\Delta t = \\lambda \\frac{\\Delta x}{\\max_i |u_i^n|},\n$$\nwith the convention that if $\\max_i |u_i^n| = 0$ then $\\Delta t = \\lambda \\Delta x$.\n\nDefine the convex entropy and corresponding entropy flux by\n$$\n\\eta(u) = \\tfrac{1}{2}u^2, \\qquad q(u) = \\tfrac{1}{3}u^3.\n$$\nFor the periodic domain, define the discrete total entropy at time level $n$ by\n$$\nE^n = \\sum_{i=0}^{N_x-1}\\eta(u_i^n)\\,\\Delta x.\n$$\nFor a final time $T > 0$, define the mean numerical entropy production rate over $[0,T]$ as\n$$\n\\Pi = \\frac{E^0 - E^N}{T},\n$$\nwhere $t^N \\approx T$ is the final numerical time and $E^N$ is the final discrete entropy. Also define an entropy increase counter\n$$\nC = \\#\\left\\{n \\in \\{0,1,\\dots,N-1\\} \\,\\middle|\\, E^{n+1} - E^n  \\tau \\right\\},\n$$\nwith tolerance $\\tau = 10^{-12}$.\n\nImplement a program that, for each specified parameter set in the test suite below, computes the pair $[\\Pi, C]$ using the finite-volume method with the indicated flux choice, starting from $u(x,0) = \\sin(2\\pi x)$ on $[0,1]$ with periodic boundary conditions, advancing in time with the adaptive $\\Delta t$ defined above until reaching time $T$ (clip the last step so that the final time equals $T$ exactly). The output must be aggregated as specified below.\n\nTest suite (each entry is a tuple $(\\text{flux\\_choice}, N_x, \\lambda, T)$):\n- Test $1$: $(\\text{\"A\"}, 400, 0.9, 0.30)$.\n- Test $2$: $(\\text{\"B\"}, 400, 0.9, 0.30)$.\n- Test $3$: $(\\text{\"A\"}, 400, 0.9, 0.05)$.\n- Test $4$: $(\\text{\"B\"}, 100, 0.9, 0.30)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result is itself a two-element list $[\\Pi, C]$ in the same order as the test suite, for example:\n$[[\\Pi_1,C_1],[\\Pi_2,C_2],[\\Pi_3,C_3],[\\Pi_4,C_4]]$.", "solution": "The goal is to probe the physical correctness of numerical shock capturing in the inviscid Burgers equation by measuring numerical entropy production. We start from first principles: conservation and entropy inequalities for weak solutions, then build conservative finite-volume discretizations, and finally define a measurable diagnostic for entropy behavior.\n\n- Conservation law and flux. The model is\n$$\n\\partial_t u + \\partial_x f(u) = 0, \\quad f(u) = \\tfrac{1}{2}u^2.\n$$\nFor sufficiently smooth $u$, the conservation law implies that the integral of any convex entropy $\\eta(u)$ over the periodic domain evolves by\n$$\n\\partial_t \\eta(u) + \\partial_x q(u) = 0, \\quad q'(u) = \\eta'(u) f'(u),\n$$\nand for $\\eta(u) = \\tfrac{1}{2}u^2$ we have $q(u) = \\tfrac{1}{3}u^3$. For $u$ with discontinuities (shocks), the physically admissible weak solution satisfies the entropy inequality\n$$\n\\partial_t \\eta(u) + \\partial_x q(u) \\le 0,\n$$\nso that, with periodic boundary conditions, the total entropy $\\int_0^1 \\eta(u)\\,dx$ must be nonincreasing in time.\n\n- Finite-volume discretization. We discretize the domain into $N_x$ uniform cells with width $\\Delta x = 1/N_x$. Let $u_i^n$ denote the cell average at cell $i$ and time level $n$. The conservative update is\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\right),\n$$\nwhere $F_{i+\\tfrac{1}{2}}^n$ is a consistent numerical flux function of the adjacent states $u_L = u_i^n$ and $u_R = u_{i+1}^n$. Periodic boundary conditions are enforced by indexing modulo $N_x$.\n\nTwo flux constructions are considered:\n\n1. Exact Riemann-solver flux for the inviscid Burgers equation (Choice A). The Riemann problem with initial left and right states $(u_L,u_R)$ has either a rarefaction ($u_L \\le u_R$) or a shock ($u_L  u_R$). For Burgers, the Godunov flux can be written explicitly. In the rarefaction case,\n$$\nF(u_L,u_R) =\n\\begin{cases}\n\\tfrac{1}{2}u_L^2,  \\text{if } u_L \\ge 0,\\\\\n\\tfrac{1}{2}u_R^2,  \\text{if } u_R \\le 0,\\\\\n0,  \\text{if } u_L  0  u_R,\n\\end{cases}\n$$\nand in the shock case, the shock speed is $s = \\dfrac{u_L + u_R}{2}$, leading to\n$$\nF(u_L,u_R) =\n\\begin{cases}\n\\tfrac{1}{2}u_L^2,  \\text{if } s \\ge 0,\\\\\n\\tfrac{1}{2}u_R^2,  \\text{if } s  0.\n\\end{cases}\n$$\nThis flux is monotone and entropy-satisfying for convex $f$.\n\n2. Two-step predictor-corrector central scheme (Choice B). The Richtmyer two-step Lax–Wendroff method forms interface predictor states by a midpoint reconstruction and flux difference,\n$$\nu_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} = \\tfrac{1}{2}\\left(u_i^n + u_{i+1}^n\\right) - \\tfrac{\\Delta t}{2\\Delta x}\\left(f(u_{i+1}^n) - f(u_i^n)\\right),\n$$\nand then updates conservatively with the physical flux $f$ evaluated at these predictor states,\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(f\\Big(u_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}}\\Big) - f\\Big(u_{i-\\tfrac{1}{2}}^{n+\\tfrac{1}{2}}\\Big)\\right).\n$$\nThis method is second-order accurate for smooth solutions but is not monotone and can generate dispersive oscillations near shocks, potentially violating the entropy inequality locally in time.\n\n- Time stepping and stability. For explicit schemes, the Courant–Friedrichs–Lewy (CFL) condition bounds the time step. For Burgers with wavespeed $a(u)=f'(u)=u$, a safe adaptive time step is\n$$\n\\Delta t = \\lambda \\frac{\\Delta x}{\\max_i |u_i^n|},\n$$\nwith a prescribed $\\lambda \\in (0,1)$. If $\\max_i |u_i^n|=0$, we use $\\Delta t = \\lambda \\Delta x$. To match a prescribed final time $T$, the last time step is clipped so that $t^{n+1} = T$ exactly.\n\n- Discrete entropy diagnostic. Define the discrete total entropy\n$$\nE^n = \\sum_{i=0}^{N_x-1} \\eta(u_i^n)\\,\\Delta x, \\quad \\eta(u) = \\tfrac{1}{2}u^2.\n$$\nFor smooth exact solutions on a periodic domain, $E(t)$ is constant; when shocks form, $E(t)$ is nonincreasing. A discrete scheme that is physically correct as a shock-capturing method should not increase $E^n$ except possibly within numerical tolerance. We measure:\n1. The mean numerical entropy production rate over $[0,T]$,\n$$\n\\Pi = \\frac{E^0 - E^N}{T},\n$$\nwhich should be close to $0$ before shock formation and positive after shocks develop.\n2. An entropy increase counter\n$$\nC = \\#\\big\\{ n \\,\\big|\\, E^{n+1} - E^n  \\tau \\big\\},\n$$\nwith a small threshold $\\tau = 10^{-12}$, which counts time steps that increase the total entropy beyond numerical roundoff. For an entropy-satisfying method, $C$ should be $0$ or very small; for non-monotone methods near shocks, $C$ can be positive.\n\n- Initial condition and shock time. With $u(x,0) = \\sin(2\\pi x)$, the solution remains smooth until the first shock time\n$$\nt_s = \\frac{1}{\\max_x \\big(-\\partial_x u(x,0)\\big)} = \\frac{1}{2\\pi}.\n$$\nThus $T = 0.05$ is before shock formation, whereas $T = 0.30$ is after shocks develop.\n\n- Algorithmic steps to compute $[\\Pi, C]$ for a given test case $(\\text{flux\\_choice}, N_x, \\lambda, T)$:\n1. Initialize a uniform grid with $N_x$ cells, periodic indexing, and set $u_i^0 = \\sin\\big(2\\pi x_i\\big)$ where $x_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$.\n2. Set $t^0 = 0$, compute $E^0 = \\sum_i \\tfrac{1}{2}(u_i^0)^2 \\Delta x$, and set $C=0$.\n3. While $t^n  T$, compute $\\Delta t = \\lambda \\Delta x/\\max_i |u_i^n|$ (or $\\lambda \\Delta x$ if the maximum is zero) and clip so that $t^{n+1} = \\min\\{t^n + \\Delta t, T\\}$ with the used $\\Delta t = t^{n+1} - t^n$.\n4. Compute $u^{n+1}$ using Choice A or Choice B for the numerical flux/interface update.\n5. Compute $E^{n+1} = \\sum_i \\tfrac{1}{2}(u_i^{n+1})^2 \\Delta x$ and if $E^{n+1} - E^n  \\tau$ with $\\tau = 10^{-12}$, increment $C$.\n6. Set $n \\leftarrow n+1$ and repeat.\n7. At the end, report $\\Pi = (E^0 - E^N)/T$ and $C$.\n\n- Test suite coverage. The four parameter sets probe:\n  - A post-shock regime with a monotone, entropy-satisfying flux (Choice A, $N_x=400$, $\\lambda=0.9$, $T=0.30$), expected to yield positive $\\Pi$ and $C$ near $0$.\n  - A post-shock regime with a non-monotone central method (Choice B, $N_x=400$, $\\lambda=0.9$, $T=0.30$), which can exhibit oscillations and positive $C$.\n  - A pre-shock regime (Choice A, $N_x=400$, $\\lambda=0.9$, $T=0.05$), expected to yield $\\Pi$ close to $0$ and small $C$.\n  - A coarser grid with the central method post-shock (Choice B, $N_x=100$, $\\lambda=0.9$, $T=0.30$), enhancing dispersive effects and potentially increasing $C$.\n\nThe program must output a single line containing the list of results in the format\n$$\n\\big[ [\\Pi_1, C_1], [\\Pi_2, C_2], [\\Pi_3, C_3], [\\Pi_4, C_4] \\big].\n$$", "answer": "```python\nimport numpy as np\n\ndef flux_burgers(u):\n    return 0.5 * u * u\n\ndef godunov_flux_array(u):\n    \"\"\"\n    Compute Godunov fluxes F_{i+1/2} for Burgers' equation on a periodic grid.\n    u: array of cell averages u_i\n    returns array F of size N with F[i] = flux at interface between i and i+1\n    \"\"\"\n    ul = u\n    ur = np.roll(u, -1)\n    f_ul = 0.5 * ul * ul\n    f_ur = 0.5 * ur * ur\n    F = np.empty_like(u)\n\n    # Rarefaction case: ul = ur\n    rare = ul = ur\n    # Subcases for rarefaction\n    cond1 = rare  (ul = 0)\n    cond2 = rare  (ur = 0)\n    cond3 = rare  (ul  0)  (ur  0)\n\n    F[cond1] = f_ul[cond1]\n    F[cond2] = f_ur[cond2]\n    F[cond3] = 0.0\n\n    # Shock case: ul  ur\n    shock = ~rare\n    s = 0.5 * (ul + ur)  # shock speed\n    cond4 = shock  (s = 0)\n    cond5 = shock  (s  0)\n    F[cond4] = f_ul[cond4]\n    F[cond5] = f_ur[cond5]\n\n    return F\n\ndef step_choice_A(u, dt, dx):\n    \"\"\"One FV step with Godunov flux (Choice A).\"\"\"\n    F = godunov_flux_array(u)\n    return u - (dt / dx) * (F - np.roll(F, 1))\n\ndef step_choice_B(u, dt, dx):\n    \"\"\"One FV step with Richtmyer two-step Lax-Wendroff (Choice B).\"\"\"\n    f_u = flux_burgers(u)\n    u_iphalf = 0.5 * (u + np.roll(u, -1)) - 0.5 * (dt / dx) * (np.roll(f_u, -1) - f_u)\n    f_half = flux_burgers(u_iphalf)\n    return u - (dt / dx) * (f_half - np.roll(f_half, 1))\n\ndef run_case(choice, Nx, CFL, T, tau=1e-12):\n    # Grid and initial condition u(x,0) = sin(2*pi*x) sampled at cell centers\n    x = (np.arange(Nx) + 0.5) / Nx\n    u = np.sin(2.0 * np.pi * x).astype(float)\n    dx = 1.0 / Nx\n    t = 0.0\n\n    # Initial entropy\n    E0 = 0.5 * np.sum(u * u) * dx\n    E_prev = E0\n    C_increase = 0\n\n    # Time stepping loop\n    while t  T - 1e-15:\n        max_speed = np.max(np.abs(u))\n        if max_speed  1e-14:\n            dt = CFL * dx\n        else:\n            dt = CFL * dx / max_speed\n        if t + dt  T:\n            dt = T - t\n\n        if choice == \"A\":\n            u_new = step_choice_A(u, dt, dx)\n        elif choice == \"B\":\n            u_new = step_choice_B(u, dt, dx)\n        else:\n            raise ValueError(\"Unknown flux choice\")\n\n        # Entropy and counter\n        E_new = 0.5 * np.sum(u_new * u_new) * dx\n        if (E_new - E_prev)  tau:\n            C_increase += 1\n\n        u = u_new\n        E_prev = E_new\n        t += dt\n\n    E_final = E_prev\n    Pi = (E0 - E_final) / T\n    return [Pi, C_increase]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (flux_choice, Nx, CFL, T)\n    test_cases = [\n        (\"A\", 400, 0.9, 0.30),\n        (\"B\", 400, 0.9, 0.30),\n        (\"A\", 400, 0.9, 0.05),\n        (\"B\", 100, 0.9, 0.30),\n    ]\n\n    results = []\n    for case in test_cases:\n        choice, Nx, CFL, T = case\n        res = run_case(choice, Nx, CFL, T, tau=1e-12)\n        # Convert to [float,int] with reasonable float formatting by default\n        results.append([res[0], res[1]])\n\n    # Final print statement in the exact required format.\n    # Ensure only the list is printed.\n    # Convert inner lists to string with default float formatting\n    def entry_to_str(entry):\n        return f\"[{entry[0]},{entry[1]}]\"\n    print(f\"[{','.join(entry_to_str(e) for e in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2448972"}]}