{"hands_on_practices": [{"introduction": "Periodic boundary conditions impose a powerful constraint on the types of solutions that can exist within a system. This first exercise explores this fundamental principle using the intuitive example of a wave on a circular ring. By determining which wave functions are physically permissible on a domain of a fixed length $L$, you will derive the essential mathematical condition that connects the system size to the allowed wavelengths, a concept that is foundational to fields ranging from solid-state physics to signal processing. [@problem_id:2124832]", "problem": "Consider a one-dimensional wave propagating on a thin, flexible ring of circumference $L = 3\\pi$. The displacement of the ring from its equilibrium position at a point $x$ along its circumference and at time $t$ is given by a function $u(x, t)$. Due to the circular nature of the domain, any valid wave function must satisfy periodic boundary conditions. The waves are superpositions of basic harmonic components traveling in the same direction, which have the general form $A \\cos(k(x-vt)) + B \\sin(k(x-vt))$, where $k$ is the wave number and $v$ is the wave speed.\n\nWhich of the following functions could represent a valid wave on this ring? Select all valid options.\n\nA. $u(x,t) = \\cos\\left(\\frac{2}{3}(x - vt)\\right)$\n\nB. $u(x,t) = \\sin\\left(\\frac{3}{2}(x - vt)\\right) + \\cos\\left(2(x-vt)\\right)$\n\nC. $u(x,t) = 5\\sin\\left(\\frac{4}{3}(x-vt)\\right)$\n\nD. $u(x,t) = \\cos\\left(\\frac{1}{3}(x-vt)\\right)$\n\nE. $u(x,t) = 2\\cos\\left(\\frac{2\\pi}{3}(x-vt)\\right)$", "solution": "For a wave on a ring of circumference $L$, the periodic boundary condition is $u(x+L,t)=u(x,t)$ for all $x$ and $t$. For a basic traveling harmonic component of the form $A\\cos(k(x-vt)) + B\\sin(k(x-vt))$, shifting $x \\to x+L$ gives\n$$A\\cos(k(x-vt)+kL)+B\\sin(k(x-vt)+kL).$$\nFor this to equal $A\\cos(k(x-vt)) + B\\sin(k(x-vt))$ for all phases, we require\n$$kL=2\\pi n,\\quad n\\in\\mathbb{Z}.$$\nThus the admissible wave numbers are\n$$k=\\frac{2\\pi n}{L}.$$\nWith $L=3\\pi$, this becomes\n$$k=\\frac{2\\pi n}{3\\pi}=\\frac{2}{3}n,\\quad n\\in\\mathbb{Z}.$$\nTherefore, any valid component must have $k$ an integer multiple of $\\frac{2}{3}$. Superpositions are valid only if each constituent component has an admissible $k$.\n\nCheck each option:\n- A: $k=\\frac{2}{3}=\\frac{2}{3}\\cdot 1$ is admissible. Valid.\n- B: First term has $k=\\frac{3}{2}$, which is not an integer multiple of $\\frac{2}{3}$ (since $\\frac{3}{2}\\big/ \\frac{2}{3}=\\frac{9}{4}$ is not an integer). Second term has $k=2=\\frac{2}{3}\\cdot 3$, which is admissible. However, the sum includes a non-admissible component, so it is not periodic. Invalid.\n- C: $k=\\frac{4}{3}=\\frac{2}{3}\\cdot 2$ is admissible. Valid.\n- D: $k=\\frac{1}{3}=\\frac{2}{3}\\cdot \\frac{1}{2}$ is not an integer multiple of $\\frac{2}{3}$. Invalid.\n- E: $k=\\frac{2\\pi}{3}$ gives $kL=\\frac{2\\pi}{3}\\cdot 3\\pi=2\\pi^{2}$, which cannot equal $2\\pi n$ with $n\\in\\mathbb{Z}$. Not admissible. Invalid.\n\nHence the valid options are A and C.", "answer": "$$\\boxed{AC}$$", "id": "2124832"}, {"introduction": "Moving from theory to practice, implementing periodic boundary conditions correctly is paramount for accurate simulations. The minimum image convention (MIC) is the standard algorithm for calculating distances and interactions in a periodic system, but it harbors subtle implementation pitfalls. This exercise challenges you to diagnose a common but incorrect approach to the MIC, helping you master the logic required to correctly 'wrap' displacement vectors into the central simulation cell. [@problem_id:2460063]", "problem": "In atomistic simulations under periodic boundary conditions, pair interactions are computed using the minimum image convention: for each Cartesian component, one chooses the displacement that minimizes the absolute separation among all periodic images of the simulation cell. Consider a cubic cell of side length $L$, and let $dx = x_j - x_i$ be the raw difference of particle coordinates along one axis. A student implements the componentwise wrapping as $dx_{\\mathrm{mic}} = \\mathrm{fmod}(dx, L)$ in an attempt to enforce the minimum image convention.\n\nWhich of the following statements correctly explain why this implementation is incorrect and how to fix it? Select all that apply.\n\nA. The function $\\mathrm{fmod}$ removes integer multiples of $L$ by truncation toward zero, which yields $dx_{\\mathrm{mic}} \\in (-L, L)$ rather than the symmetric interval required by the minimum image convention, $(-L/2, L/2]$. Consequently, whenever $\\lvert dx \\rvert > L/2$, the result is not the shortest displacement.\n\nB. One can correct the output of $\\mathrm{fmod}$ by subtracting $L/2$ (i.e., using $dx_{\\mathrm{mic}} = \\mathrm{fmod}(dx, L) - L/2$), which centers the interval and therefore enforces the minimum image convention.\n\nC. A correct one-dimensional implementation of the minimum image convention for a cubic box is $dx_{\\mathrm{mic}} = dx - L\\,\\mathrm{round}(dx/L)$, with any consistent tie-breaking policy at $\\lvert dx \\rvert = L/2$.\n\nD. The only problem with using $\\mathrm{fmod}$ is floating-point roundoff near the boundary at $\\lvert dx \\rvert = L/2$; aside from that boundary, $\\mathrm{fmod}$ yields the minimum image displacement exactly.\n\nE. Using $\\mathrm{fmod}$ would be correct for orthorhombic (including cubic) boxes; it only fails for triclinic cells because the box vectors are not mutually orthogonal.", "solution": "The minimum image convention (MIC) requires finding the shortest displacement vector between two particles in a periodic system. For a one-dimensional displacement $dx$ in a box of length $L$, the correct minimum image displacement, $dx_{\\mathrm{mic}}$, must lie in the interval $(-L/2, L/2]$.\n\nThe student's implementation uses $dx_{\\mathrm{mic}} = \\mathrm{fmod}(dx, L)$. The `fmod` function calculates the remainder by truncating the quotient $dx/L$ toward zero. This produces a result in the interval $(-L, L)$, which is not the correct symmetric interval.\n\nLet's evaluate each option based on this understanding:\n- **A:** This statement correctly identifies the flaw. The `fmod` function returns a value in $(-L, L)$. If $|dx| > L/2$ (but less than $L$), `fmod(dx, L)` simply returns $dx$, which is not the shortest displacement. For example, if $L=10$ and $dx=7$, the shortest displacement is $dx - L = -3$, but `fmod(7, 10)` returns $7$. Thus, statement A is correct.\n\n- **B:** This suggests a \"fix\" by using $\\mathrm{fmod}(dx, L) - L/2$. This simply shifts the output interval from $(-L, L)$ to $(-3L/2, L/2)$, which is still incorrect. It is not centered at zero and does not produce the MIC displacement. Thus, statement B is incorrect.\n\n- **C:** This provides the standard correct implementation: $dx_{\\mathrm{mic}} = dx - L \\cdot \\mathrm{round}(dx/L)$. The `round(dx/L)` term finds the nearest integer multiple of $L$ to subtract from $dx$, which by definition guarantees that the result $dx_{\\mathrm{mic}}$ will lie in the interval $[-L/2, L/2]$ (with the exact boundaries depending on the rounding tie-breaking rule). This is the correct logic for the MIC. Thus, statement C is correct.\n\n- **D:** This statement is incorrect. The error with `fmod` is not a minor floating-point issue at the boundaries; it is a fundamental algorithmic mistake that fails for any displacement $dx$ where $|dx| > L/2$.\n\n- **E:** This statement is incorrect. The failure of the `fmod` implementation is intrinsic to its mathematical definition and occurs even in the simplest one-dimensional or cubic case. It has nothing to do with the complexity of triclinic cells.", "answer": "$$\\boxed{AC}$$", "id": "2460063"}, {"introduction": "With a correct minimum image convention in hand, we can tackle more complex analysis tasks, such as characterizing macromolecules that are larger than the simulation box itself. A naive calculation of a polymer's end-to-end distance might give a nonsensical result if the chain happens to be wrapped across a periodic boundary. This practice demonstrates the proper 'unwrapping' procedure, which involves summing the sequence of local bond vectors to reconstruct the true global conformation of the molecule, a vital technique in polymer physics and biomolecular simulation. [@problem_id:2460073]", "problem": "In a molecular dynamics simulation, a polymer with $N$ monomers is in a cubic simulation box of side length $L$ with Periodic Boundary Conditions (PBC). The stored Cartesian positions of monomers, $\\mathbf{r}_0,\\mathbf{r}_1,\\dots,\\mathbf{r}_{N-1}$, are wrapped so that each Cartesian component lies in the interval $[0,L)$. The polymer may be longer than $L$ and may cross the box boundaries multiple times. The Minimum Image Convention (MIC) is defined as follows: for any displacement $\\Delta \\mathbf{r}$ between two positions, $\\mathrm{MIC}(\\Delta \\mathbf{r})$ is the unique displacement vector that is equivalent under PBC and has the smallest Euclidean norm (equivalently, each Cartesian component is taken in $(-L/2,L/2]$).\n\nThe end-to-end distance is defined as the Euclidean norm of the unwrapped end-to-end vector from monomer $0$ to monomer $N-1$, i.e., the norm of the vector one would obtain if the polymer were made continuous across boundaries by adding or subtracting appropriate integer multiples of $L$ to the stored coordinates.\n\nWhich of the following expressions, computed directly from the wrapped coordinates $\\{\\mathbf{r}_i\\}$ and $L$, yields the correct end-to-end distance under PBC for a chain that may be longer than $L$?\n\nA. $d \\;=\\; \\left\\|\\, \\mathrm{MIC}\\!\\left(\\mathbf{r}_{N-1}-\\mathbf{r}_0\\right) \\right\\|$\n\nB. $d \\;=\\; \\left\\|\\, \\displaystyle\\sum_{i=0}^{N-2} \\mathrm{MIC}\\!\\left(\\mathbf{r}_{i+1}-\\mathbf{r}_i\\right) \\right\\|$\n\nC. $d \\;=\\; \\left\\|\\, \\mathbf{r}_{N-1}-\\mathbf{r}_0 \\right\\|$\n\nD. $d \\;=\\; \\left\\|\\, \\displaystyle\\sum_{i=0}^{N-2} \\left(\\mathbf{r}_{i+1}-\\mathbf{r}_i\\right) \\right\\|$", "solution": "The goal is to calculate the true end-to-end distance of a polymer chain whose stored coordinates, $\\{\\mathbf{r}_i\\}$, have been wrapped into the periodic box. A naive calculation using only the start and end points, $\\mathbf{r}_0$ and $\\mathbf{r}_{N-1}$, will be incorrect if the chain wraps across a boundary.\n\nThe correct approach is to reconstruct the true, *unwrapped* end-to-end vector by summing the sequence of individual physical bond vectors. Let the unwrapped end-to-end vector be $\\mathbf{V}_{\\text{e2e}}$. It can be expressed as a sum of bond vectors:\n$$\n\\mathbf{V}_{\\text{e2e}} = \\sum_{i=0}^{N-2} (\\mathbf{R}_{i+1} - \\mathbf{R}_i)\n$$\nwhere $\\mathbf{R}_i$ is the unwrapped position of monomer $i$.\n\nEach physical bond vector, $\\mathbf{R}_{i+1} - \\mathbf{R}_i$, can be recovered from the wrapped coordinates by applying the Minimum Image Convention (MIC) to the displacement between adjacent monomers. This is because the MIC finds the shortest vector connecting two points, and for a physical bond, this is the correct bond vector.\n$$\n\\mathbf{R}_{i+1} - \\mathbf{R}_i = \\mathrm{MIC}(\\mathbf{r}_{i+1} - \\mathbf{r}_i)\n$$\nBy substituting this into the sum, we get the expression for the unwrapped end-to-end vector:\n$$\n\\mathbf{V}_{\\text{e2e}} = \\sum_{i=0}^{N-2} \\mathrm{MIC}(\\mathbf{r}_{i+1} - \\mathbf{r}_i)\n$$\nThe end-to-end distance is the Euclidean norm of this vector.\n\nLet's evaluate the options:\n- **A. $\\left\\|\\, \\mathrm{MIC}\\!\\left(\\mathbf{r}_{N-1}-\\mathbf{r}_0\\right) \\right\\|$**: This calculates the shortest distance between the endpoints, ignoring the chain's connectivity. It's incorrect if the chain wraps around the box.\n- **B. $\\left\\|\\, \\displaystyle\\sum_{i=0}^{N-2} \\mathrm{MIC}\\!\\left(\\mathbf{r}_{i+1}-\\mathbf{r}_i\\right) \\right\\|$**: This correctly sums the MIC-corrected bond vectors to reconstruct the full end-to-end vector before taking the norm. This is the correct method.\n- **C. $\\left\\|\\, \\mathbf{r}_{N-1}-\\mathbf{r}_0 \\right\\|$**: This calculates the distance between the raw wrapped coordinates of the endpoints, which is incorrect as it neither accounts for the chain's path nor the periodic boundaries.\n- **D. $\\left\\|\\, \\displaystyle\\sum_{i=0}^{N-2} \\left(\\mathbf{r}_{i+1}-\\mathbf{r}_i\\right) \\right\\|$**: The sum telescopes to $\\mathbf{r}_{N-1}-\\mathbf{r}_0$, making this expression identical to option C and therefore incorrect.", "answer": "$$\\boxed{B}$$", "id": "2460073"}]}