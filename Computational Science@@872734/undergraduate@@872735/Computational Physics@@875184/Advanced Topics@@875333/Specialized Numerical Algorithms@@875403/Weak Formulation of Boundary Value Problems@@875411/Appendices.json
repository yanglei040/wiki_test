{"hands_on_practices": [{"introduction": "Our first exercise is a quintessential one-dimensional boundary value problem. The goal here is to master the fundamental mechanics of deriving a weak form: multiplying by a test function, integrating by parts to shift a derivative, and using the boundary conditions to simplify the expression. This procedure forms the bedrock of all subsequent applications and is the first step in developing computational solvers.", "problem": "Consider the one-dimensional boundary value problem (BVP) defined by the differential equation:\n$$\n-(e^x u'(x))' = \\sin(x)\n$$\non the open interval $x \\in (a, b)$, subject to homogeneous Dirichlet boundary conditions $u(a) = 0$ and $u(b) = 0$.\n\nThe weak (or variational) formulation of this BVP requires finding a solution function $u$ from a suitable function space $V$ such that a certain integral equation is satisfied for all \"test functions\" $v$ from the same space $V$. For this problem, the space $V$ is defined as the set of functions that are continuous, have square-integrable first derivatives over the interval $(a, b)$, and satisfy the boundary conditions $f(a) = 0$ and $f(b) = 0$.\n\nWhich of the following integral equations correctly represents the weak formulation of the given BVP? The task is to find $u \\in V$ such that the chosen equation holds for all $v \\in V$.\n\nA. $\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nB. $\\int_{a}^{b} u'(x) v'(x) \\,dx = \\int_{a}^{b} e^{-x}\\sin(x) v(x) \\,dx$\n\nC. $-\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nD. $\\int_{a}^{b} e^x u(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nE. $\\int_{a}^{b} e^x u'(x) v(x) \\,dx = -\\int_{a}^{b} \\cos(x) v'(x) \\,dx$\n\nF. $-\\int_{a}^{b} e^x u'(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$", "solution": "We start from the strong form of the boundary value problem:\n$$\n-(\\exp(x)\\,u'(x))'=\\sin(x)\\quad\\text{for }x\\in(a,b),\\qquad u(a)=0,\\;u(b)=0.\n$$\nLet $V=\\{v\\in H^{1}(a,b):v(a)=v(b)=0\\}$. To derive the weak form, multiply the differential equation by an arbitrary test function $v\\in V$ and integrate over $(a,b)$:\n$$\n\\int_{a}^{b}-(\\exp(x)\\,u'(x))'\\,v(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\nApply integration by parts to the left-hand side using the identity\n$$\n\\int_{a}^{b}-\\left(p(x)w'(x)\\right)'\\,v(x)\\,dx=\\int_{a}^{b}p(x)\\,w'(x)\\,v'(x)\\,dx-\\left[p(x)\\,w'(x)\\,v(x)\\right]_{x=a}^{x=b},\n$$\nwith $p(x)=\\exp(x)$ and $w(x)=u(x)$. This yields\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx-\\left[\\exp(x)\\,u'(x)\\,v(x)\\right]_{x=a}^{x=b}=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\nSince $v(a)=v(b)=0$ for all $v\\in V$, the boundary term vanishes, giving the weak (variational) formulation:\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx\\quad\\text{for all }v\\in V.\n$$\nComparing with the options, this corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "2156992"}, {"introduction": "Having established the basic technique, we now generalize our approach to problems in higher dimensions, which are common in physics and engineering. This practice focuses on the Helmholtz equation and introduces the abstract language of bilinear forms ($a(u,v)$) and linear functionals ($L(v)$), a cornerstone of the modern theory of partial differential equations and the finite element method [@problem_id:2156988]. Understanding this abstract structure is key to applying the method to a vast range of problems.", "problem": "The study of steady-state wave phenomena, such as acoustic waves in a concert hall or electromagnetic waves in a resonant cavity, often leads to the Helmholtz equation. Consider a bounded domain $\\Omega$ in $\\mathbb{R}^d$ with a smooth boundary $\\partial\\Omega$. The amplitude $u(\\mathbf{x})$ of a wave forced by a source term $f(\\mathbf{x})$ is described by the following boundary value problem:\n$$-\\Delta u - k^2 u = f \\quad \\text{in } \\Omega$$\n$$u = 0 \\quad \\text{on } \\partial\\Omega$$\nHere, $\\Delta$ is the Laplacian operator, and $k$ is a positive real constant known as the wavenumber.\n\nTo find an approximate solution using methods like the Finite Element Method (FEM), one first derives the weak (or variational) formulation of the problem. This involves finding a function $u$ from an appropriate solution space such that for all suitable test functions $v$, the equation $a(u,v) = L(v)$ holds.\n\nIdentify the correct bilinear form $a(u,v)$ and linear functional $L(v)$ for the weak formulation of this Helmholtz problem. The test functions $v$ are chosen from a space where they satisfy the same homogeneous boundary condition, i.e., $v=0$ on $\\partial\\Omega$.\n\nA. $a(u,v) = \\int_{\\Omega} (\\nabla u \\cdot \\nabla v - k^2 u v) \\, d\\mathbf{x}$,  $L(v) = \\int_{\\Omega} f v \\, d\\mathbf{x}$\n\nB. $a(u,v) = \\int_{\\Omega} (\\nabla u \\cdot \\nabla v + k^2 u v) \\, d\\mathbf{x}$,  $L(v) = \\int_{\\Omega} f v \\, d\\mathbf{x}$\n\nC. $a(u,v) = \\int_{\\Omega} (-\\nabla u \\cdot \\nabla v - k^2 u v) \\, d\\mathbf{x}$, $L(v) = \\int_{\\Omega} f v \\, d\\mathbf{x}$\n\nD. $a(u,v) = \\int_{\\Omega} (-\\Delta u \\cdot v - k^2 u v) \\, d\\mathbf{x}$, $L(v) = \\int_{\\Omega} f v \\, d\\mathbf{x}$\n\nE. $a(u,v) = \\int_{\\Omega} (\\nabla u \\cdot \\nabla v - k^2 u v) \\, d\\mathbf{x}$,  $L(v) = -\\int_{\\Omega} f v \\, d\\mathbf{x}$", "solution": "We seek the weak formulation on the Sobolev space $H_{0}^{1}(\\Omega)$, where both the trial function $u$ and test function $v$ satisfy the homogeneous Dirichlet boundary condition on $\\partial\\Omega$. Starting from the strong form,\n$$\n-\\Delta u - k^{2} u = f \\quad \\text{in } \\Omega, \\qquad u=0 \\quad \\text{on } \\partial\\Omega,\n$$\nmultiply by an arbitrary $v \\in H_{0}^{1}(\\Omega)$ and integrate over $\\Omega$:\n$$\n\\int_{\\Omega} \\left(-\\Delta u - k^{2} u\\right) v \\, d\\mathbf{x} = \\int_{\\Omega} f v \\, d\\mathbf{x}.\n$$\nApply Greenâ€™s first identity (integration by parts) for sufficiently regular $u$ and $v$:\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\mathbf{x} = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\mathbf{x} - \\int_{\\partial\\Omega} v \\, \\partial_{n} u \\, ds.\n$$\nBecause $v=0$ on $\\partial\\Omega$, the boundary term vanishes, giving\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\mathbf{x} = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\mathbf{x}.\n$$\nSubstituting into the weak equation yields\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\mathbf{x} - k^{2} \\int_{\\Omega} u v \\, d\\mathbf{x} = \\int_{\\Omega} f v \\, d\\mathbf{x}.\n$$\nHence the bilinear form and linear functional are\n$$\na(u,v) = \\int_{\\Omega} \\left(\\nabla u \\cdot \\nabla v - k^{2} u v\\right) \\, d\\mathbf{x}, \n\\qquad\nL(v) = \\int_{\\Omega} f v \\, d\\mathbf{x},\n$$\nwhich corresponds to option A. The other options are incorrect for the following reasons: B corresponds to the equation $-\\Delta u + k^{2} u = f$; C has an incorrect sign in the gradient term; D is not a proper weak form because it retains second derivatives of $u$ against $v$; E has the wrong sign on $L(v)$.", "answer": "$$\\boxed{A}$$", "id": "2156988"}, {"introduction": "We conclude with a problem that demonstrates one of the most powerful features of the weak formulation: its ability to naturally handle problems with discontinuous coefficients. This scenario, modeling heat flow through a composite material, is difficult to treat classically but becomes straightforward in the weak setting [@problem_id:2146778]. The exercise reveals how the weak formulation implicitly enforces the correct physical \"transmission conditions\" at material interfaces, a task that would require explicit, and often cumbersome, treatment in the strong form.", "problem": "Consider a steady-state heat conduction problem in a one-dimensional composite rod of length $L=2$, occupying the interval $x \\in [-1, 1]$. The temperature distribution $u(x)$ in the rod is governed by the differential equation:\n$$-\\frac{d}{dx}\\left(k(x) \\frac{du}{dx}\\right) = f(x) \\quad \\text{for } x \\in (-1, 1)$$\nwhere $f(x)$ is a continuous heat source term. The ends of the rod are held at a fixed temperature of zero, so $u(-1) = 0$ and $u(1) = 0$.\n\nThe rod is made of two different materials joined at $x=0$. The thermal conductivity $k(x)$ is therefore a discontinuous step function defined as:\n$$ k(x) = \\begin{cases} k_1 & \\text{if } -1 < x < 0 \\\\ k_2 & \\text{if } 0 < x < 1 \\end{cases} $$\nwhere $k_1$ and $k_2$ are distinct positive constants.\n\nThe classical formulation of this problem requires specifying \"transmission conditions\" at the interface $x=0$ to ensure a physically meaningful solution. When this problem is reformulated in its weak (or variational) form, these conditions are implicitly enforced by the formulation itself.\n\nThe task is to determine this set of implicitly enforced transmission conditions at the interface $x=0$. In the options below, $u(0^-)$ and $u'(0^-)$ denote the limit of the function and its derivative as $x$ approaches $0$ from the left, while $u(0^+)$ and $u'(0^+)$ denote the limits from the right.\n\nWhich of the following pairs of conditions are implicitly enforced by the weak formulation of this boundary value problem?\n\nA. $u(0^-) = u(0^+)$ and $k_1 u'(0^-) = k_2 u'(0^+)$\n\nB. $u'(0^-) = u'(0^+)$ and $k_1 u(0^-) = k_2 u(0^+)$\n\nC. $u(0^-) = u(0^+)$ and $u'(0^-) = u'(0^+)$\n\nD. The weak formulation does not impose any conditions at $x=0$ as the derivative of $k(x)$ is not defined there.\n\nE. $k_1 u(0^-) = k_2 u(0^+)$ and $k_1 u'(0^-) = k_2 u'(0^+)$", "solution": "We start from the weak (variational) formulation: find $u \\in H_{0}^{1}(-1,1)$ such that for every $v \\in H_{0}^{1}(-1,1)$,\n$$\n\\int_{-1}^{1} k(x)\\, u'(x)\\, v'(x)\\, dx \\;=\\; \\int_{-1}^{1} f(x)\\, v(x)\\, dx,\n$$\nwhere $k(x)=k_{1}$ on $(-1,0)$ and $k(x)=k_{2}$ on $(0,1)$, with $k_{1},k_{2}>0$, and $u(-1)=u(1)=0$ enforced as traces through $H_{0}^{1}(-1,1)$.\n\nFirst, the continuity of $u$ at $x=0$ follows from the function space. In one dimension, every $u \\in H^{1}(-1,1)$ has an absolutely continuous representative on $[-1,1]$, hence is continuous on $[-1,1]$. Therefore the left and right limits at $0$ coincide:\n$$\nu(0^{-}) \\;=\\; u(0^{+}).\n$$\n\nSecond, we derive the flux continuity condition. Since $C_{c}^{\\infty}(-1,1)$ is dense in $H_{0}^{1}(-1,1)$, the weak formulation holds for all $v \\in C_{c}^{\\infty}(-1,1)$. Split the integral across the interface and integrate by parts on each subinterval:\n$$\n\\int_{-1}^{0} k_{1}\\, u' v' \\, dx \\;+\\; \\int_{0}^{1} k_{2}\\, u' v' \\, dx\n\\;=\\; \\int_{-1}^{1} f\\, v \\, dx.\n$$\nOn $(-1,0)$,\n$$\n\\int_{-1}^{0} k_{1}\\, u' v' \\, dx\n= \\big[ k_{1}\\, u' v \\big]_{x=-1}^{x=0^{-}} \\;-\\; \\int_{-1}^{0} (k_{1}\\, u')' v \\, dx,\n$$\nand on $(0,1)$,\n$$\n\\int_{0}^{1} k_{2}\\, u' v' \\, dx\n= \\big[ k_{2}\\, u' v \\big]_{x=0^{+}}^{x=1} \\;-\\; \\int_{0}^{1} (k_{2}\\, u')' v \\, dx.\n$$\nSumming these and using $v(-1)=v(1)=0$ (since $v \\in C_{c}^{\\infty}(-1,1)$) gives\n$$\n\\big(k_{1}\\, u'(0^{-}) - k_{2}\\, u'(0^{+})\\big)\\, v(0)\n\\;-\\; \\int_{-1}^{0} (k_{1}\\, u')' v \\, dx \\;-\\; \\int_{0}^{1} (k_{2}\\, u')' v \\, dx\n\\;=\\; \\int_{-1}^{1} f\\, v \\, dx.\n$$\nWithin each subinterval, the strong form holds in the distributional sense:\n$$\n-(k_{1}\\, u')' = f \\quad \\text{on } (-1,0), \\qquad -(k_{2}\\, u')' = f \\quad \\text{on } (0,1).\n$$\nSubstituting these into the previous identity cancels the integrals against $\\int f v\\, dx$, leaving\n$$\n\\big(k_{1}\\, u'(0^{-}) - k_{2}\\, u'(0^{+})\\big)\\, v(0) \\;=\\; 0 \\quad \\text{for all } v \\in C_{c}^{\\infty}(-1,1).\n$$\nBecause one can choose $v$ with arbitrary value at $x=0$, it follows that\n$$\nk_{1}\\, u'(0^{-}) \\;=\\; k_{2}\\, u'(0^{+}).\n$$\n\nCombining both conclusions, the weak formulation enforces the continuity of temperature and the continuity of heat flux across the interface:\n$$\nu(0^{-}) = u(0^{+}), \\qquad k_{1}\\, u'(0^{-}) = k_{2}\\, u'(0^{+}).\n$$\nThese are exactly the conditions in option A.", "answer": "$$\\boxed{A}$$", "id": "2146778"}]}