{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will start with the fundamental definition of the Lyapunov exponent. This exercise uses the famous logistic map, a simple iterative equation that can produce profoundly complex and chaotic behavior. By tracking how two initially very close trajectories diverge over a small number of steps, you will perform a direct calculation that reveals the essence of \"sensitivity to initial conditions\" and yields a concrete estimate for the Lyapunov exponent, $\\lambda$, connecting the abstract formula $|\\delta_n| \\approx |\\delta_0| \\exp(n\\lambda)$ to a tangible result [@problem_id:1940452].", "problem": "The logistic map, given by the iterative equation $x_{n+1} = r x_n (1 - x_n)$, is a simple mathematical model that can exhibit chaotic behavior. It is often used to model population dynamics where $x_n$ represents a normalized population size at generation $n$, and $r$ is a parameter related to the growth rate.\n\nA key characteristic of a chaotic system is its extreme sensitivity to initial conditions. This sensitivity is quantified by the Lyapunov exponent, $\\lambda$. For two trajectories starting from very close initial points, $x_0$ and $y_0 = x_0 + \\delta_0$, their separation after $n$ iterations, $\\delta_n = y_n - x_n$, is expected to grow exponentially on average, following the relation $|\\delta_n| \\approx |\\delta_0| \\exp(n\\lambda)$ for a sufficiently large number of iterations $n$.\n\nConsider the logistic map with the growth parameter set to $r=3.7$. Two simulations are run starting from very close initial conditions:\n- Trajectory A starts at $x_0=0.5$\n- Trajectory B starts at $y_0 = 0.5 + 10^{-8}$\n\nAfter the system has evolved for $n=20$ iterations, the states of the two trajectories are found to be $x_{20} = 0.852310$ and $y_{20} = 0.852313$.\n\nUsing these values, estimate the Lyapunov exponent $\\lambda$ for the system. Round your final answer to three significant figures.", "solution": "The problem asks for an estimation of the Lyapunov exponent, $\\lambda$, for the logistic map at $r=3.7$, using the provided data for two initially close trajectories.\n\nThe relationship between the initial separation, $\\delta_0$, and the separation after $n$ iterations, $\\delta_n$, is given by:\n$$|\\delta_n| \\approx |\\delta_0| \\exp(n\\lambda)$$\n\nOur goal is to solve this equation for $\\lambda$. First, we isolate the exponential term:\n$$\\frac{|\\delta_n|}{|\\delta_0|} \\approx \\exp(n\\lambda)$$\n\nNext, we take the natural logarithm of both sides to eliminate the exponential function:\n$$\\ln\\left(\\frac{|\\delta_n|}{|\\delta_0|}\\right) \\approx n\\lambda$$\n\nFinally, we solve for $\\lambda$:\n$$\\lambda \\approx \\frac{1}{n} \\ln\\left(\\frac{|\\delta_n|}{|\\delta_0|}\\right)$$\n\nNow, we must calculate the values of $\\delta_0$ and $\\delta_n$ from the given information.\n\nThe initial conditions are $x_0=0.5$ and $y_0 = 0.5 + 10^{-8}$. The initial separation $\\delta_0$ is:\n$$\\delta_0 = y_0 - x_0 = (0.5 + 10^{-8}) - 0.5 = 10^{-8}$$\nThe absolute value is $|\\delta_0| = 10^{-8}$.\n\nThe states after $n=20$ iterations are given as $x_{20} = 0.852310$ and $y_{20} = 0.852313$. The final separation $\\delta_{20}$ is:\n$$\\delta_{20} = y_{20} - x_{20} = 0.852313 - 0.852310 = 0.000003$$\nThe absolute value is $|\\delta_{20}| = 0.000003 = 3 \\times 10^{-6}$.\n\nNow we can substitute these values into our expression for $\\lambda$ with $n=20$:\n$$\\lambda \\approx \\frac{1}{20} \\ln\\left(\\frac{|\\delta_{20}|}{|\\delta_0|}\\right) = \\frac{1}{20} \\ln\\left(\\frac{3 \\times 10^{-6}}{10^{-8}}\\right)$$\n\nLet's evaluate the argument of the logarithm first:\n$$\\frac{3 \\times 10^{-6}}{10^{-8}} = 3 \\times 10^{-6 - (-8)} = 3 \\times 10^2 = 300$$\n\nNow, substitute this back into the expression for $\\lambda$:\n$$\\lambda \\approx \\frac{1}{20} \\ln(300)$$\n\nUsing a calculator, we find the value of $\\ln(300)$:\n$$\\ln(300) \\approx 5.7037824744$$\n\nTherefore, the estimate for $\\lambda$ is:\n$$\\lambda \\approx \\frac{5.7037824744}{20} \\approx 0.2851891237$$\n\nThe problem requires the answer to be rounded to three significant figures.\nThe first significant figure is 2, the second is 8, and the third is 5. The next digit is 1, which is less than 5, so we round down (i.e., we do not change the last significant digit).\n$$\\lambda \\approx 0.285$$", "answer": "$$\\boxed{0.285}$$", "id": "1940452"}, {"introduction": "Lyapunov exponents are not exclusively used to identify chaos; they are a powerful tool for characterizing the stability of any orbit. In this problem, we shift our focus from a chaotic regime to a stable, periodic one within the same logistic map system. You will calculate the finite-time Lyapunov exponent for a period-2 orbit, which involves averaging the logarithmic derivative of the map over the two points of the cycle. This practice demonstrates that a negative exponent signifies an attracting, stable orbit, highlighting the broader utility of this metric in classifying the full spectrum of dynamical behaviors [@problem_id:2064908].", "problem": "A simplified model for the state of a nonlinear digital oscillator is described by the discrete one-dimensional logistic map, given by the equation:\n$$x_{n+1} = f(x_n) = r x_n (1 - x_n)$$\nwhere $x_n$ represents the normalized state of the oscillator at time step $n$, with $x_n \\in [0, 1]$. The behavior of this system is controlled by the parameter $r$. For a specific parameter value of $r = 3.2$, the system settles into a stable period-2 orbit after a transient phase. A period-2 orbit is a set of two distinct points, $\\{p_1, p_2\\}$, such that the system alternates between them indefinitely: $f(p_1) = p_2$ and $f(p_2) = p_1$.\n\nYour task is to calculate the finite-time Lyapunov exponent for this stable period-2 orbit.\n\nRound your final answer to four significant figures.", "solution": "We are given the logistic map $f(x)=r x (1 - x)$ with $r=3.2$, and the system settles into a stable period-2 orbit $\\{p_{1},p_{2}\\}$ satisfying $f(p_{1})=p_{2}$ and $f(p_{2})=p_{1}$. For a period-2 orbit, the finite-time Lyapunov exponent per iterate over one full period is\n$$\n\\lambda=\\frac{1}{2}\\left[\\ln|f'(p_{1})|+\\ln|f'(p_{2})|\\right]=\\frac{1}{2}\\ln\\left|f'(p_{1})f'(p_{2})\\right|.\n$$\nFor the logistic map, $f'(x)=r(1-2x)$. Hence\n$$\nf'(p_{1})f'(p_{2})=r^{2}(1-2p_{1})(1-2p_{2})=r^{2}\\left[1-2(p_{1}+p_{2})+4 p_{1}p_{2}\\right].\n$$\nFor the period-2 points of the logistic map (excluding fixed points), one has the explicit expressions\n$$\np_{1,2}=\\frac{r+1\\pm\\sqrt{(r-3)(r+1)}}{2r}.\n$$\nFrom these, the symmetric sums are\n$$\nS=p_{1}+p_{2}=\\frac{r+1}{r},\\qquad P=p_{1}p_{2}=\\frac{r+1}{r^{2}}.\n$$\nTherefore,\n$$\nf'(p_{1})f'(p_{2})=r^{2}\\left[1-2\\frac{r+1}{r}+4\\frac{r+1}{r^{2}}\\right]\n=r^{2}\\left[\\frac{-r^{2}+2r+4}{r^{2}}\\right]=-r^{2}+2r+4.\n$$\nThus the finite-time Lyapunov exponent for the period-2 orbit is\n$$\n\\lambda=\\frac{1}{2}\\ln\\left|-r^{2}+2r+4\\right|.\n$$\nSubstituting $r=3.2$ gives\n$$\n-r^{2}+2r+4=-10.24+6.4+4=0.16,\n$$\nso\n$$\n\\lambda=\\frac{1}{2}\\ln(0.16)=\\ln(0.4)\\approx -0.9162907319.\n$$\nRounded to four significant figures, this is $-0.9163$.", "answer": "$$\\boxed{-0.9163}$$", "id": "2064908"}, {"introduction": "Moving from one-dimensional maps to continuous physical systems requires more sophisticated computational techniques. This capstone practice challenges you to compute the maximum Lyapunov exponent for the chaotic Hénon-Heiles Hamiltonian system, a classic model in celestial mechanics and stellar dynamics. You will implement the standard algorithm of evolving two nearby trajectories with periodic renormalization and, most importantly, compare the results obtained from two different numerical integrators: a general-purpose Runge-Kutta method and a structure-preserving symplectic integrator. This exercise not only synthesizes the concept of trajectory separation in a realistic context but also provides critical insight into how the choice of computational tools can dramatically impact the validity of long-term simulations of dynamical systems [@problem_id:2446770].", "problem": "You will investigate how the choice of numerical integrator affects the computation of the maximum Lyapunov exponent for a chaotic Hamiltonian system. Consider the Hénon–Heiles Hamiltonian\n$$\nH(x,y,p_x,p_y) = \\tfrac{1}{2}\\left(p_x^2 + p_y^2\\right) + \\tfrac{1}{2}\\left(x^2 + y^2\\right) + x^2 y - \\tfrac{1}{3} y^3,\n$$\nwhich is separable as $H = T(p_x,p_y) + V(x,y)$ with kinetic energy $T = \\tfrac{1}{2}(p_x^2 + p_y^2)$ and potential energy $V = \\tfrac{1}{2}(x^2 + y^2) + x^2 y - \\tfrac{1}{3} y^3$. The corresponding Hamilton’s equations are\n$$\n\\dot{x} = \\frac{\\partial H}{\\partial p_x} = p_x, \\quad \\dot{y} = \\frac{\\partial H}{\\partial p_y} = p_y,\n$$\n$$\n\\dot{p}_x = -\\frac{\\partial H}{\\partial x} = -x - 2xy, \\quad \\dot{p}_y = -\\frac{\\partial H}{\\partial y} = -y - x^2 + y^2.\n$$\nYou will compute the maximum Lyapunov exponent using two numerical integrators: a time-reversible symplectic “velocity Verlet” scheme and the classical fourth-order Runge–Kutta method (Runge–Kutta of order four (RK4)). The maximum Lyapunov exponent is defined from the long-time exponential growth rate of an infinitesimal phase-space perturbation. Use nondimensional time units inherent to the Hamiltonian; report all exponents in inverse time units.\n\nYour program must:\n- Implement a time-reversible symplectic integrator that is appropriate for separable Hamiltonians $H = T(p) + V(q)$ using a kick–drift–kick composition with forces from $-\\nabla V$.\n- Implement a non-symplectic, non-time-reversible fourth-order Runge–Kutta integrator for the first-order system defined by Hamilton’s equations.\n- Compute the maximum Lyapunov exponent using the following protocol based on the foundational definition of exponential separation of nearby trajectories: evolve two trajectories, one reference $\\mathbf{z}(t)$ and one perturbed $\\mathbf{z}'(t)$ with initial separation of magnitude $d_0$, periodically measure the phase-space separation $d(t)$ at fixed time intervals $\\Delta t_r$, rescale the separation back to $d_0$ along its instantaneous direction, and accumulate the long-time average exponential growth rate. Use the Euclidean norm in the $4$-dimensional phase space $(x,y,p_x,p_y)$ for $d(t)$. Express the final maximum Lyapunov exponent in inverse time units.\n- For each test case below, compute two floating-point values: one using the symplectic method and one using RK4.\n\nUse the following test suite of parameter sets. For each case, the initial condition is constructed at a prescribed total energy $E$ by fixing $(x,y)$ and $p_y = 0$ and choosing $p_x  0$ so that $H(x,y,p_x,0) = E$. Specifically, set $x = 0$, choose $y$ as specified, and solve for $p_x = \\sqrt{2\\left(E - V(x,y)\\right)}$. The initial perturbation is along the $x$ coordinate with magnitude $d_0$ in the $4$-vector $(x,y,p_x,p_y)$. The phase-space separation is renormalized every $m$ steps. Compute the maximum Lyapunov exponent over a total time $T_{\\text{tot}}$.\n\nTest cases (use all numeric values exactly as given):\n- Case $1$: $E = 0.125$, $x = 0$, $y = 0.1$, $p_y = 0$, $d_0 = 10^{-8}$, time step $\\Delta t = 0.01$, renormalization interval $m = 10$ steps, total time $T_{\\text{tot}} = 200$.\n- Case $2$: $E = 0.125$, $x = 0$, $y = 0.1$, $p_y = 0$, $d_0 = 10^{-8}$, time step $\\Delta t = 0.04$, renormalization interval $m = 5$ steps, total time $T_{\\text{tot}} = 200$.\n- Case $3$: $E = 0.05$, $x = 0$, $y = 0.05$, $p_y = 0$, $d_0 = 10^{-8}$, time step $\\Delta t = 0.01$, renormalization interval $m = 10$ steps, total time $T_{\\text{tot}} = 200$.\n\nAngle units do not arise in this problem. All reported exponents must be in inverse time units of the nondimensional system. Your program must produce a single line of output containing the results as a comma-separated list of lists with the form\n$$\n\\left[\\,[\\lambda_{\\text{symp},1},\\lambda_{\\text{rk4},1}],\\,[\\lambda_{\\text{symp},2},\\lambda_{\\text{rk4},2}],\\,[\\lambda_{\\text{symp},3},\\lambda_{\\text{rk4},3}]\\,\\right],\n$$\nwhere each $\\lambda$ is rounded to $6$ decimal places. For example, the output format must look like\n$$\n\\left[[0.0,0.0],[0.0,0.0],[0.0,0.0]\\right]\n$$\nwith the actual computed values replacing the zeros.", "solution": "The problem presented is valid. It is a well-posed, scientifically grounded exercise in computational physics that requires the comparison of numerical integrators for a chaotic Hamiltonian system. All necessary data and definitions are provided, and the task is objective and verifiable. We will proceed with the solution.\n\nThe problem concerns the Hénon–Heiles system, a canonical model for chaos in classical mechanics. Its dynamics are governed by the Hamiltonian:\n$$\nH(x,y,p_x,p_y) = \\frac{1}{2}(p_x^2 + p_y^2) + \\frac{1}{2}(x^2 + y^2) + x^2 y - \\frac{1}{3} y^3\n$$\nThis Hamiltonian is separable into a kinetic part $T(\\mathbf{p}) = \\frac{1}{2}(p_x^2 + p_y^2)$ and a potential part $V(\\mathbf{q}) = \\frac{1}{2}(x^2 + y^2) + x^2 y - \\frac{1}{3} y^3$, where $\\mathbf{q} = (x, y)$ are the coordinates and $\\mathbf{p} = (p_x, p_y)$ are the conjugate momenta.\n\nThe evolution of the system in the $4$-dimensional phase space with state vector $\\mathbf{z} = (x, y, p_x, p_y)^T$ is described by Hamilton's equations, $\\dot{\\mathbf{z}} = \\{\\mathbf{z}, H\\}$, where $\\{\\cdot, \\cdot\\}$ is the Poisson bracket. Explicitly, these equations are:\n$$\n\\dot{x} = \\frac{\\partial H}{\\partial p_x} = p_x\n$$\n$$\n\\dot{y} = \\frac{\\partial H}{\\partial p_y} = p_y\n$$\n$$\n\\dot{p}_x = -\\frac{\\partial H}{\\partial x} = -(x + 2xy)\n$$\n$$\n\\dot{p}_y = -\\frac{\\partial H}{\\partial y} = -(y + x^2 - y^2)\n$$\nWe define the force vector as $\\mathbf{F}(\\mathbf{q}) = -\\nabla V(\\mathbf{q})$. The equations of motion for the momenta are thus $\\dot{\\mathbf{p}} = \\mathbf{F}(\\mathbf{q})$. For a Hamiltonian system, the total energy $E = H(\\mathbf{q}, \\mathbf{p})$ is a conserved quantity.\n\nWe are tasked to compute the maximum Lyapunov exponent using two distinct numerical integrators.\n\nFirst, the time-reversible symplectic integrator. For a separable Hamiltonian, we can use a geometric integrator based on a Suzuki–Trotter splitting of the Liouville operator $\\mathcal{L}_H = \\mathcal{L}_T + \\mathcal{L}_V$. A second-order accurate, symmetric splitting leads to the \"Kick-Drift-Kick\" (KDK) form of the velocity Verlet algorithm. For a single time step of size $\\Delta t$, the update from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ proceeds in three stages:\n$1$. **Kick (half step)**: The momenta are updated using the force at the current position for half a time step.\n$$\n\\mathbf{p}(t_n + \\Delta t/2) = \\mathbf{p}(t_n) + \\mathbf{F}(\\mathbf{q}(t_n)) \\frac{\\Delta t}{2}\n$$\n$2$. **Drift (full step)**: The positions are updated using the new momenta for a full time step. Since $T$ is purely quadratic in momenta, $\\dot{\\mathbf{q}} = \\nabla_{\\mathbf{p}} T = \\mathbf{p}$ (assuming mass $m=1$), so this step is a simple linear drift.\n$$\n\\mathbf{q}(t_{n+1}) = \\mathbf{q}(t_n) + \\mathbf{p}(t_n + \\Delta t/2) \\Delta t\n$$\n$3$. **Kick (half step)**: The momenta are updated again for half a time step, using the force at the new position.\n$$\n\\mathbf{p}(t_{n+1}) = \\mathbf{p}(t_n + \\Delta t/2) + \\mathbf{F}(\\mathbf{q}(t_{n+1})) \\frac{\\Delta t}{2}\n$$\nThis scheme is symplectic, meaning it preserves the phase-space volume element, and it is time-reversible. It does not conserve the energy $H$ exactly but conserves a nearby \"shadow\" Hamiltonian, leading to bounded energy fluctuations and excellent long-term stability.\n\nSecond, the classical Runge-Kutta method of order $4$ (RK$4$). This is a general-purpose, non-symplectic integrator for first-order ordinary differential equations of the form $\\dot{\\mathbf{z}} = \\mathbf{f}(t, \\mathbf{z})$. To apply RK$4$, we write Hamilton's equations in this vector form, where $\\mathbf{z} = (x, y, p_x, p_y)^T$ and $\\mathbf{f}(t, \\mathbf{z}) = (p_x, p_y, -x-2xy, -y-x^2+y^2)^T$. The update rule for a step $\\Delta t$ is:\n$$\n\\mathbf{z}_{n+1} = \\mathbf{z}_n + \\frac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nwhere the intermediate stages are computed as:\n$$\n\\mathbf{k}_1 = \\mathbf{f}(t_n, \\mathbf{z}_n)\n$$\n$$\n\\mathbf{k}_2 = \\mathbf{f}(t_n + \\Delta t/2, \\mathbf{z}_n + \\frac{\\Delta t}{2}\\mathbf{k}_1)\n$$\n$$\n\\mathbf{k}_3 = \\mathbf{f}(t_n + \\Delta t/2, \\mathbf{z}_n + \\frac{\\Delta t}{2}\\mathbf{k}_2)\n$$\n$$\n\\mathbf{k}_4 = \\mathbf{f}(t_n + \\Delta t, \\mathbf{z}_n + \\Delta t\\mathbf{k}_3)\n$$\nRK$4$ is highly accurate for short times but is not symplectic. In long-term integrations of Hamiltonian systems, it typically introduces numerical dissipation (or anti-dissipation), causing the energy to drift systematically, which can corrupt the true dynamics.\n\nThe maximum Lyapunov exponent, $\\lambda$, quantifies the rate of exponential divergence of nearby trajectories in phase space, a hallmark of chaos. We compute it using the specified protocol. We evolve a reference trajectory $\\mathbf{z}(t)$ and a perturbed trajectory $\\mathbf{z}'(t)$.\nThe procedure is as follows:\n$1$. **Initialization**: An initial state $\\mathbf{z}_0$ is determined from the given energy $E$ and coordinates $(x_0, y_0, p_{y0}) = (0, y_{\\text{case}}, 0)$, by solving $H(\\mathbf{z}_0) = E$ for $p_{x0}  0$:\n$$\np_{x0} = \\sqrt{2(E - V(x_0, y_0))}\n$$\nThe perturbed trajectory is initialized as $\\mathbf{z}'_0 = \\mathbf{z}_0 + \\delta \\mathbf{z}_0$, where $\\delta \\mathbf{z}_0$ is a vector of magnitude $d_0$ in the $x$-direction, i.e., $\\delta\\mathbf{z}_0 = (d_0, 0, 0, 0)$.\n$2$. **Evolution and Renormalization**: The two trajectories are evolved in parallel for a total time $T_{\\text{tot}}$. At specified intervals of $m$ steps (total time $\\Delta t_r = m \\Delta t$), the separation is measured and renormalized. Let $N_{\\text{renorm}} = \\lfloor T_{\\text{tot}} / \\Delta t_r \\rfloor$ be the total number of renormalizations. For each renormalization step $k=1, \\dots, N_{\\text{renorm}}$:\n    a. Let $t_k = k \\Delta t_r$. After evolving both trajectories to this time, calculate the separation vector $\\delta\\mathbf{z}(t_k) = \\mathbf{z}'(t_k) - \\mathbf{z}(t_k)$ and its Euclidean norm $d(t_k) = ||\\delta\\mathbf{z}(t_k)||_2$.\n    b. The growth factor for this interval is $d(t_k)/d_0$. Its logarithm is added to a running sum.\n    c. The perturbed trajectory is rescaled back towards the reference trajectory, preserving the direction of separation:\n    $$\n    \\mathbf{z}'(t_k) \\leftarrow \\mathbf{z}(t_k) + \\delta\\mathbf{z}(t_k) \\frac{d_0}{d(t_k)}\n    $$\n$3$. **Final Calculation**: The maximum Lyapunov exponent is the time-averaged rate of exponential growth:\n$$\n\\lambda \\approx \\frac{1}{T_{\\text{tot}}} \\sum_{k=1}^{N_{\\text{renorm}}} \\ln\\left(\\frac{d(t_k)}{d_0}\\right)\n$$\nThis procedure is performed for each test case, using both the symplectic and RK$4$ integrators, to compare their performance in capturing the chaotic dynamics.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum Lyapunov exponent for the Hénon-Heiles system\n    using a symplectic Verlet integrator and a non-symplectic RK4 integrator.\n    \"\"\"\n\n    # Test cases from the problem statement\n    test_cases = [\n        {'E': 0.125, 'y0': 0.1, 'p_y0': 0.0, 'd0': 1e-8, 'dt': 0.01, 'm': 10, 'T_tot': 200.0},\n        {'E': 0.125, 'y0': 0.1, 'p_y0': 0.0, 'd0': 1e-8, 'dt': 0.04, 'm': 5, 'T_tot': 200.0},\n        {'E': 0.05, 'y0': 0.05, 'p_y0': 0.0, 'd0': 1e-8, 'dt': 0.01, 'm': 10, 'T_tot': 200.0},\n    ]\n\n    # Hénon-Heiles system definitions\n    def potential(x, y):\n        return 0.5 * (x**2 + y**2) + x**2 * y - (1/3) * y**3\n\n    def force(q):\n        x, y = q\n        fx = -x - 2 * x * y\n        fy = -y - x**2 + y**2\n        return np.array([fx, fy])\n\n    def ode_rhs(z):\n        x, y, px, py = z\n        fx = -x - 2 * x * y\n        fy = -y - x**2 + y**2\n        return np.array([px, py, fx, fy])\n\n    # Numerical integrators\n    def step_verlet(z, dt):\n        \"\"\"A single step of the Kick-Drift-Kick (velocity) Verlet integrator.\"\"\"\n        q = z[:2]\n        p = z[2:]\n        \n        # Kick (half step)\n        p_half = p + 0.5 * dt * force(q)\n        \n        # Drift (full step)\n        q_new = q + dt * p_half\n        \n        # Kick (half step)\n        p_new = p_half + 0.5 * dt * force(q_new)\n        \n        return np.concatenate((q_new, p_new))\n\n    def step_rk4(z, dt):\n        \"\"\"A single step of the classical 4th-order Runge-Kutta integrator.\"\"\"\n        k1 = ode_rhs(z)\n        k2 = ode_rhs(z + 0.5 * dt * k1)\n        k3 = ode_rhs(z + 0.5 * dt * k2)\n        k4 = ode_rhs(z + dt * k3)\n        return z + (dt / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\n    def compute_lyapunov(integrator_step_func, z0, d0, dt, m, T_tot):\n        \"\"\"\n        Computes the maximum Lyapunov exponent using the specified algorithm.\n        \"\"\"\n        num_steps = int(round(T_tot / dt))\n        \n        z_ref = np.copy(z0)\n        \n        # Initial perturbation along x\n        pert_vec = np.array([d0, 0.0, 0.0, 0.0])\n        z_pert = z_ref + pert_vec\n\n        lyap_sum = 0.0\n        \n        for i in range(1, num_steps + 1):\n            z_ref = integrator_step_func(z_ref, dt)\n            z_pert = integrator_step_func(z_pert, dt)\n\n            if i % m == 0:\n                delta_z = z_pert - z_ref\n                d_t = np.linalg.norm(delta_z)\n                \n                if d_t > 0:\n                    lyap_sum += np.log(d_t / d0)\n                    # Renormalize the perturbation\n                    z_pert = z_ref + (d0 / d_t) * delta_z\n                else:\n                    # If separation collapses, re-perturb in a default direction\n                    # to avoid division by zero. This is unlikely to happen.\n                    z_pert = z_ref + pert_vec\n        \n        return lyap_sum / T_tot\n\n    results = []\n    for case in test_cases:\n        E = case['E']\n        x0 = 0.0\n        y0 = case['y0']\n        p_y0 = case['p_y0']\n        d0 = case['d0']\n        dt = case['dt']\n        m = case['m']\n        T_tot = case['T_tot']\n\n        # Calculate initial p_x\n        V0 = potential(x0, y0)\n        if E  V0:\n            raise ValueError(f\"Energy E={E} is less than potential V={V0} at initial point. No real solution for p_x.\")\n        p_x0 = np.sqrt(2 * (E - V0))\n        z0 = np.array([x0, y0, p_x0, p_y0])\n        \n        # Compute Lyapunov exponent for both methods\n        lambda_symp = compute_lyapunov(step_verlet, z0, d0, dt, m, T_tot)\n        lambda_rk4 = compute_lyapunov(step_rk4, z0, d0, dt, m, T_tot)\n        \n        results.append([lambda_symp, lambda_rk4])\n\n    # Format the output as specified\n    inner_parts = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2446770"}]}