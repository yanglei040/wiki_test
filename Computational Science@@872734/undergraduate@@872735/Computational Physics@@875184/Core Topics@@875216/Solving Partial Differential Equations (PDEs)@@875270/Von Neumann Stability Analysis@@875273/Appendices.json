{"hands_on_practices": [{"introduction": "Numerical methods inevitably introduce errors, but not all errors are created equal. High-frequency oscillations can obscure the true physical solution and are often the most challenging to control. This practice demonstrates a powerful idea: we can sometimes tune our numerical scheme to act as a selective filter, precisely targeting and eliminating the most troublesome error component. By finding the parameter value that makes the amplification factor zero for the shortest resolvable wavelength, you will gain hands-on insight into the practical use of numerical dissipation. [@problem_id:2225599]", "problem": "A numerical analyst is studying a finite difference scheme for solving a one-dimensional transport process. The stability of the scheme is analyzed by decomposing the numerical error into its Fourier modes. The amplification factor, $G$, which determines how the amplitude of a single Fourier mode with wave number $k$ evolves from one time step to the next, is found to be:\n$$ G = 1 - 2\\mu (1 - \\cos(k \\Delta x)) $$\nHere, $\\Delta x$ is the spatial grid spacing, and $\\mu$ is a dimensionless parameter that depends on the time step, grid spacing, and physical properties of the system being modeled.\n\nThe analyst is particularly concerned with high-frequency errors, specifically the error component that has a wavelength of exactly $2\\Delta x$, as this represents the most oscillatory error that the grid can resolve. The goal is to choose the simulation parameter $\\mu$ such that this specific error component is completely eliminated after just a single time step.\n\nDetermine the exact value of $\\mu$ required to achieve this. Express your answer as a decimal value.", "solution": "We analyze the Fourier mode with wavelength $\\lambda = 2\\Delta x$. For a Fourier mode, the relation between wavelength and wavenumber is $k = \\frac{2\\pi}{\\lambda}$, hence\n$$\nk\\Delta x = \\frac{2\\pi}{\\lambda}\\Delta x = \\frac{2\\pi}{2\\Delta x}\\Delta x = \\pi.\n$$\nSubstituting $k\\Delta x = \\pi$ into the amplification factor,\n$$\nG = 1 - 2\\mu\\left(1 - \\cos(k\\Delta x)\\right) = 1 - 2\\mu\\left(1 - \\cos(\\pi)\\right).\n$$\nUsing $\\cos(\\pi) = -1$,\n$$\nG = 1 - 2\\mu\\left(1 - (-1)\\right) = 1 - 2\\mu \\cdot 2 = 1 - 4\\mu.\n$$\nTo eliminate this error component after a single time step, its amplification factor must be zero, so we set $G = 0$:\n$$\n1 - 4\\mu = 0 \\quad \\Rightarrow \\quad \\mu = \\frac{1}{4}.\n$$\nExpressed as a decimal, this is $0.25$.", "answer": "$$\\boxed{0.25}$$", "id": "2225599"}, {"introduction": "A stable simulation is the bare minimum; a good simulation must also be physically plausible. For diffusive processes like heat transfer, we do not expect temperatures to oscillate wildly in space from one moment to the next. This exercise moves beyond the standard stability condition ($|G| \\le 1$) to explore a stricter requirement for non-oscillatory behavior ($G \\ge 0$). You will discover how ensuring this physical constraint leads to a more stringent limit on your simulation parameters, highlighting the important trade-off between computational efficiency and the physical fidelity of the solution. [@problem_id:2225566]", "problem": "In computational fluid dynamics, the one-dimensional heat equation, given by $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$, is often solved numerically. One of the simplest methods is the Forward-Time Central-Space (FTCS) scheme. Using a grid with time step $\\Delta t$ and spatial step $\\Delta x$, the FTCS scheme discretizes the heat equation as:\n\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\nHere, $u_j^n$ represents the temperature $u$ at spatial position $j \\Delta x$ and time step $n \\Delta t$, and $\\alpha$ is the thermal diffusivity.\n\nA von Neumann stability analysis is performed by substituting a Fourier mode of the form $u_j^n = G^n e^{i k j \\Delta x}$ into the discretized equation. Here, $G$ is the amplification factor, $k$ is the wave number, and $i = \\sqrt{-1}$. The behavior of $G$ determines the stability of the numerical scheme.\n\nLet the mesh Fourier number be defined as $\\mu = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$. The amplification factor $G$ can be expressed as a function of $\\mu$ and the dimensionless quantity $\\theta = k \\Delta x$. For a numerical solution to be physically plausible in certain contexts, it is desirable for the amplification to not introduce spurious oscillations. This can be achieved if the amplification factor $G$ is guaranteed to be real and non-negative for all possible wave numbers.\n\nDetermine the most restrictive condition on the mesh Fourier number $\\mu$ which ensures that the amplification factor $G$ is real and non-negative for all possible values of $\\theta$.\n\nA. $\\mu \\le \\frac{1}{\\sqrt{2}}$\n\nB. $\\mu \\le \\frac{1}{2}$\n\nC. $\\mu \\le \\frac{1}{4}$\n\nD. $\\mu \\le 1$", "solution": "The problem asks for the condition on the mesh Fourier number $\\mu$ that ensures the amplification factor $G$ of the Forward-Time Central-Space (FTCS) scheme is real and non-negative for all wave numbers.\n\nFirst, we must derive the expression for the amplification factor $G$. We start with the FTCS discretized equation:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\nWe introduce the mesh Fourier number $\\mu = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ to simplify the equation:\n$$\nu_j^{n+1} - u_j^n = \\mu (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n$$\nu_j^{n+1} = u_j^n + \\mu (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\nNow, we substitute the Fourier mode solution $u_j^n = G^n e^{i k j \\Delta x}$ into this equation. The terms become:\n- $u_j^{n+1} = G^{n+1} e^{i k j \\Delta x}$\n- $u_j^n = G^n e^{i k j \\Delta x}$\n- $u_{j+1}^n = G^n e^{i k (j+1) \\Delta x} = G^n e^{i k j \\Delta x} e^{i k \\Delta x}$\n- $u_{j-1}^n = G^n e^{i k (j-1) \\Delta x} = G^n e^{i k j \\Delta x} e^{-i k \\Delta x}$\n\nSubstituting these into the rearranged FTCS equation gives:\n$$\nG^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} + \\mu (G^n e^{i k j \\Delta x} e^{i k \\Delta x} - 2 G^n e^{i k j \\Delta x} + G^n e^{i k j \\Delta x} e^{-i k \\Delta x})\n$$\n\nWe can divide the entire equation by the common factor $G^n e^{i k j \\Delta x}$, assuming it is non-zero:\n$$\nG = 1 + \\mu (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x})\n$$\n\nLet $\\theta = k \\Delta x$. The expression for $G$ becomes:\n$$\nG = 1 + \\mu (e^{i\\theta} + e^{-i\\theta} - 2)\n$$\n\nUsing Euler's identity, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we can simplify $G$:\n$$\nG = 1 + \\mu (2\\cos(\\theta) - 2)\n$$\n$$\nG = 1 - 2\\mu(1 - \\cos(\\theta))\n$$\nSince $\\mu$ and $\\cos(\\theta)$ are real numbers, the amplification factor $G$ is always real. Therefore, we only need to find the condition for $G$ to be non-negative, i.e., $G \\ge 0$.\n\nThe condition is:\n$$\n1 - 2\\mu(1 - \\cos(\\theta)) \\ge 0\n$$\n\nThis inequality must hold for all possible values of $\\theta$. To find the most restrictive condition on $\\mu$, we need to find the minimum value of $G$ with respect to $\\theta$ and ensure that this minimum is non-negative.\n\nThe term $(1 - \\cos(\\theta))$ ranges from $0$ (when $\\theta = 0, \\pm 2\\pi, \\dots$) to $2$ (when $\\theta = \\pm \\pi, \\pm 3\\pi, \\dots$).\nThe function $G(\\theta) = 1 - 2\\mu(1 - \\cos(\\theta))$ will have its minimum value when the term being subtracted, $2\\mu(1 - \\cos(\\theta))$, is at its maximum. Assuming $\\mu  0$, this occurs when $(1 - \\cos(\\theta))$ is at its maximum value.\n\nThe maximum value of $(1 - \\cos(\\theta))$ is $2$. This occurs when $\\cos(\\theta) = -1$, i.e., at $\\theta = \\pm\\pi$.\n\nSubstituting this maximum value into the expression for $G$ gives the minimum value of $G$:\n$$\nG_{min} = 1 - 2\\mu(2) = 1 - 4\\mu\n$$\n\nFor $G$ to be non-negative for all $\\theta$, its minimum value must be non-negative:\n$$\nG_{min} \\ge 0\n$$\n$$\n1 - 4\\mu \\ge 0\n$$\n\nSolving for $\\mu$:\n$$\n1 \\ge 4\\mu\n$$\n$$\n\\mu \\le \\frac{1}{4}\n$$\n\nTherefore, the most restrictive condition on $\\mu$ that ensures $G \\ge 0$ for all wave numbers is $\\mu \\le 1/4$. This corresponds to option C.\n\nIt is worth noting that the standard von Neumann stability condition for the FTCS scheme is $|G| \\le 1$, which leads to $\\mu \\le 1/2$. This is a less strict condition and allows for $G$ to become negative (down to -1), which can introduce non-physical oscillations in the solution, even if the amplitude does not grow. The question specifically asks for the condition for non-negativity, which is more stringent.", "answer": "$$\\boxed{C}$$", "id": "2225566"}, {"introduction": "The choice of a numerical scheme is not arbitrary; it must respect the underlying physics of the equation being solved, such as the direction of information flow in an advection problem. This practice presents a critical thought experiment: what happens if we use an \"upwind\" scheme designed for flow in one direction when the actual flow is reversed? Analyzing this \"mismatched\" stencil serves as a powerful cautionary tale, revealing how a conditionally stable scheme can become catastrophically unstable under the wrong physical conditions. [@problem_id:2450096]", "problem": "Consider the linear advection equation $u_t + c\\,u_x = 0$ with constant wavespeed $c$ on a uniform spatial grid $x_j = j\\,\\Delta x$ and time levels $t^n = n\\,\\Delta t$, where $\\Delta x  0$ and $\\Delta t  0$. Define the Courant number $\\nu = c\\,\\Delta t/\\Delta x$. Suppose one uses the explicit one-step upwind scheme whose spatial stencil is chosen for the case $c0$, namely\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\nu\\,\\big(u_j^n - u_{j-1}^n\\big)\\,.\n$$\nNow assume that the wavespeed $c$ becomes negative, but the numerical update above is left unchanged (that is, the stencil is not adapted to the new sign of $c$). Which statement best describes the linear stability of this fixed-stencil method as a function of $\\nu$?\n\nA. The method remains stable whenever $\\Delta t$ satisfies the Courant-Friedrichs-Lewy (CFL) condition $0 \\le \\nu \\le 1$.\n\nB. The method is stable provided $|\\nu| \\le 1$.\n\nC. The method becomes unconditionally unstable: for any $\\Delta t > 0$ there exists a Fourier mode whose amplification factor has magnitude greater than $1$.\n\nD. The method remains neutrally stable with $|G|=1$ for all Fourier modes because advection is nondissipative.\n\nE. The method is stable if $\\nu \\le 0$ with $|\\nu| \\le 1/2$.", "solution": "We analyze stability from first principles using the linear constant-coefficient scheme and a Fourier mode ansatz. Consider a single Fourier mode $u_j^n = \\hat{u}^n \\, e^{\\mathrm{i} j \\theta}$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional wavenumber. Substituting this into the update\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\nu\\,\\big(u_j^n - u_{j-1}^n\\big)\n$$\nyields the amplification factor $G(\\theta)$ defined by $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^n$. Because $u_{j-1}^n = \\hat{u}^n e^{\\mathrm{i}(j-1)\\theta} = e^{-\\mathrm{i}\\theta} u_j^n$, we obtain\n$$\nG(\\theta) \\;=\\; 1 \\;-\\; \\nu\\,\\big(1 - e^{-\\mathrm{i}\\theta}\\big)\\,.\n$$\nLinear stability requires $\\sup_{\\theta} |G(\\theta)| \\le 1$. The scheme as written is the upwind choice for $c0$, which is known to be stable under $0 \\le \\nu \\le 1$. Here we are concerned with $c0$ while keeping the same stencil, so $\\nu0$. Let $\\nu = -\\mu$ with $\\mu0$. Then\n$$\nG(\\theta) \\;=\\; 1 \\;+\\; \\mu\\,\\big(1 - e^{-\\mathrm{i}\\theta}\\big)\n\\;=\\; (1+\\mu) \\;-\\; \\mu\\,e^{-\\mathrm{i}\\theta}\\,.\n$$\nCompute the magnitude squared:\n\\begin{align*}\n|G(\\theta)|^2\n= \\Big[(1+\\mu) - \\mu\\cos\\theta\\Big]^2 + \\Big[\\mu\\sin\\theta\\Big]^2 \\\\\n= (1+\\mu)^2 - 2\\mu(1+\\mu)\\cos\\theta + \\mu^2\\cos^2\\theta + \\mu^2\\sin^2\\theta \\\\\n= (1+\\mu)^2 - 2\\mu(1+\\mu)\\cos\\theta + \\mu^2 \\\\\n= 1 + 2\\mu + 2\\mu^2 \\;-\\; 2\\mu(1+\\mu)\\cos\\theta\\,.\n\\end{align*}\nBecause the coefficient of $\\cos\\theta$ is negative, $|G(\\theta)|^2$ is maximized at $\\cos\\theta = -1$ (i.e., at $\\theta = \\pi$), giving\n$$\n\\max_{\\theta} |G(\\theta)|^2 \\;=\\; 1 + 2\\mu + 2\\mu^2 + 2\\mu(1+\\mu)\n\\;=\\; 1 + 4\\mu + 4\\mu^2 \\;=\\; (1 + 2\\mu)^2\\,.\n$$\nHence\n$$\n\\max_{\\theta} |G(\\theta)| \\;=\\; 1 + 2\\mu \\;\\; 1 \\quad \\text{for all } \\mu0\\,.\n$$\nTherefore, as soon as $c0$ (so $\\nu0$) and $\\Delta t0$, there exists a Fourier mode (specifically, the highest-frequency mode with $\\theta=\\pi$) that grows in magnitude. The fixed-stencil method is thus unconditionally unstable when the sign of $c$ is negative but the stencil is not adapted.\n\nOption-by-option analysis:\n\nA. This claims stability under $0 \\le \\nu \\le 1$. When $c0$, we have $\\nu0$, so the stated condition cannot be met unless $\\Delta t=0$. More importantly, for any $\\nu0$, we just showed there exists a growing mode. Verdict: Incorrect.\n\nB. This claims stability for $|\\nu| \\le 1$. Taking $\\nu=-\\mu$ with any $\\mu \\in (0,1]$, we found $\\max_{\\theta} |G(\\theta)| = 1 + 2\\mu  1$, so the scheme is unstable even though $|\\nu|\\le 1$. Verdict: Incorrect.\n\nC. This states unconditional instability for the unadapted stencil: for any $\\Delta t0$ there exists a Fourier mode with $|G|1$. Our analysis shows $\\max_{\\theta} |G(\\theta)| = 1 + 2\\mu  1$ for all $\\mu0$ (equivalently, all $\\nu0$ with $\\Delta t0$). Verdict: Correct.\n\nD. This asserts neutral stability ($|G|=1$) on the grounds that the continuous advection equation is nondissipative. However, the discrete scheme with a mismatched (downwind) stencil is anti-diffusive and produces $|G|1$ for some modes. Verdict: Incorrect.\n\nE. This proposes conditional stability for $\\nu \\le 0$ with $|\\nu|\\le 1/2$. Setting $\\mu = |\\nu| \\in (0,1/2]$ still yields $\\max_{\\theta} |G(\\theta)| = 1+2\\mu  1$. Verdict: Incorrect.", "answer": "$$\\boxed{C}$$", "id": "2450096"}]}