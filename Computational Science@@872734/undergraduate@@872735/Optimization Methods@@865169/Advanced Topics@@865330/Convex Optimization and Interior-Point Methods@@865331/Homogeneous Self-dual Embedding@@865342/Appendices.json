{"hands_on_practices": [{"introduction": "The heart of the Homogeneous Self-Dual Embedding is a single skew-symmetric matrix that elegantly encodes the entire primal-dual system. This first practice focuses on the fundamental task of constructing this matrix, $Q$, for a concrete linear program. By assembling $Q$ from the problem data $A$, $b$, and $c$, you will gain a concrete understanding of how the optimality conditions are unified into a single linear relationship.", "problem": "Consider the linear program in standard primal-dual form with two decision variables and two equality constraints. The primal problem is to minimize $c^{\\top} x$ subject to $A x = b$ and $x \\ge 0$, and the dual problem is to maximize $b^{\\top} y$ subject to $A^{\\top} y + s = c$ and $s \\ge 0$. Let $A \\in \\mathbb{R}^{2 \\times 2}$, $b \\in \\mathbb{R}^{2}$, and $c \\in \\mathbb{R}^{2}$ be given by\n$$\nA = \\begin{pmatrix} 1  -1 \\\\ 2  3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 2 \\\\ 5 \\end{pmatrix}.\n$$\nUsing the canonical Homogeneous Self-Dual (HSD) embedding for linear programming, form the embedded skew-symmetric matrix $Q \\in \\mathbb{R}^{(n+m+1) \\times (n+m+1)}$ that acts on the stacked vector of augmented variables $(x, y, \\tau)$ and encodes the primal-dual system into a single linear relation. Then, verify directly by computation that $Q$ is skew-symmetric. Finally, let $S$ denote the sum of the squares of all entries of $Q$ (equivalently, the squared Frobenius norm of $Q$). Report the value of $S$ as your final answer. The final answer must be a single real number. Do not round.", "solution": "The canonical Homogeneous Self-Dual (HSD) embedding for a standard primal-dual linear programming pair seeks a non-trivial solution to a homogeneous system that encapsulates the Karush-Kuhn-Tucker (KKT) optimality conditions. This system can be expressed as a single linear relation involving a skew-symmetric matrix.\n\nThe primal-dual pair is given as:\n(P) minimize $c^{\\top} x$ subject to $A x = b, x \\ge 0$.\n(D) maximize $b^{\\top} y$ subject to $A^{\\top} y + s = c, s \\ge 0$.\n\nThe HSD formulation introduces a homogenizing variable $\\tau \\ge 0$ and a gap variable $\\kappa \\ge 0$. The KKT conditions are transformed into a homogeneous system:\n$A x - b \\tau = 0$\n$A^{\\top} y + s - c \\tau = 0$\n$c^{\\top} x - b^{\\top} y + \\kappa = 0$\nwith non-negativity constraints $x \\ge 0, s \\ge 0, \\tau \\ge 0, \\kappa \\ge 0$.\n\nThis system can be expressed compactly using a skew-symmetric matrix $Q$. Defining vectors $z = (x, y, \\tau)$ and $w = (s, 0_m, \\kappa)$, a standard formulation of the system is $w = -Qz$ where\n$$\nQ = \\begin{pmatrix}\n0_{n \\times n}  A^{\\top}  -c \\\\\n-A  0_{m \\times m}  b \\\\\nc^{\\top}  -b^{\\top}  0\n\\end{pmatrix}.\n$$\nThis matrix is skew-symmetric, i.e., $Q^T = -Q$.\n\nGiven the problem data: $n=2$, $m=2$.\n$A = \\begin{pmatrix} 1  -1 \\\\ 2  3 \\end{pmatrix}$, $b = \\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}$, $c = \\begin{pmatrix} 2 \\\\ 5 \\end{pmatrix}$.\n\nWe construct the sub-matrices needed for $Q$:\n$-A = \\begin{pmatrix} -1  1 \\\\ -2  -3 \\end{pmatrix}$, $A^T = \\begin{pmatrix} 1  2 \\\\ -1  3 \\end{pmatrix}$, $-c = \\begin{pmatrix} -2 \\\\ -5 \\end{pmatrix}$, $b = \\begin{pmatrix} 1 \\\\ 4 \\end{pmatrix}$, $c^T = \\begin{pmatrix} 2  5 \\end{pmatrix}$, $-b^T = \\begin{pmatrix} -1  -4 \\end{pmatrix}$.\n\nSubstituting these into the block structure for $Q$, which has dimensions $(2+2+1) \\times (2+2+1) = 5 \\times 5$:\n$$\nQ = \\begin{pmatrix}\n0  0  1  2  -2 \\\\\n0  0  -1  3  -5 \\\\\n-1  1  0  0  1 \\\\\n-2  -3  0  0  4 \\\\\n2  5  -1  -4  0\n\\end{pmatrix}\n$$\nThis matrix is visibly skew-symmetric by inspection (e.g., $Q_{13} = 1$ and $Q_{31}=-1$; $Q_{52}=5$ and $Q_{25}=-5$; diagonal elements are all zero).\n\nThe final step is to calculate $S$, the sum of the squares of all entries of $Q$, which is the squared Frobenius norm, $S = \\|Q\\|_F^2 = \\sum_{i,j} Q_{ij}^2$.\nBecause $Q$ is skew-symmetric, the sum of squares of its entries is twice the sum of squares of the entries in its strictly upper (or lower) triangular part. For the block matrix structure of $Q$, this simplifies to:\n$$ S = \\|Q\\|_F^2 = \\|-A\\|_F^2 + \\|A^T\\|_F^2 + \\|b\\|_2^2 + \\|-c\\|_2^2 + \\|-b^T\\|_2^2 + \\|c^T\\|_2^2 $$\nUsing the properties $\\|M\\|_F = \\|-M\\|_F = \\|M^T\\|_F$ and $\\|v\\|_2 = \\|-v\\|_2 = \\|v^T\\|_2$:\n$$ S = 2\\|A\\|_F^2 + 2\\|b\\|_2^2 + 2\\|c\\|_2^2 $$\nNow we calculate the individual squared norms:\n$\\|A\\|_F^2 = 1^2 + (-1)^2 + 2^2 + 3^2 = 1 + 1 + 4 + 9 = 15$.\n$\\|b\\|_2^2 = 1^2 + 4^2 = 1 + 16 = 17$.\n$\\|c\\|_2^2 = 2^2 + 5^2 = 4 + 25 = 29$.\n\nSubstituting these values into the expression for $S$:\n$$ S = 2(15) + 2(17) + 2(29) = 30 + 34 + 58 = 122 $$", "answer": "$$\\boxed{122}$$", "id": "3137126"}, {"introduction": "Once the HSD system is constructed, how do we find an optimal solution? This exercise tackles the \"happy path,\" where a solution exists and the embedding variable $\\tau  0$. You will work through the process of solving the embedded homogeneous system and then use $\\tau$ to scale the variables back, yielding the optimal primal solution $x$, dual solution $y$, and slack variable $s$ for the original problem.", "problem": "Consider the Linear Programming (LP) problem in conic form with decision vector $x \\in \\mathbb{R}^{2}$, constraint matrix $A \\in \\mathbb{R}^{1 \\times 2}$, and data $b \\in \\mathbb{R}$ and $c \\in \\mathbb{R}^{2}$:\n$$\n\\text{minimize } c^{\\top} x \\quad \\text{subject to } A x = b, \\; x \\in \\mathbb{R}_{+}^{2}.\n$$\nTake $A = \\begin{pmatrix} 1  1 \\end{pmatrix}$, $b = 1$, and $c = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$. The dual LP has variable $y \\in \\mathbb{R}$ and slack $s \\in \\mathbb{R}_{+}^{2}$.\n\nStarting from the fundamental Karush-Kuhn-Tucker (KKT) conditions for optimality of the primal-dual pair and the definition of the Homogeneous Self-Dual Embedding (HSDE), construct the standard skew-symmetric HSDE operator that encodes the primal-dual equalities and complementarity in a single linear relation. Then, for this specific LP:\n- Identify a vector $u = (x, y, \\tau)$ with $x \\in \\mathbb{R}_{+}^{2}$ and $\\tau  0$ that corresponds to a primal-dual optimal solution with equality residual $r = 0$ and duality gap $\\kappa = 0$.\n- Compute $v = (s, r, \\kappa)$ from the HSDE operator, and verify the conic membership of the relevant components.\n- When $\\tau  0$, recover the primal-dual variables $(x, s, y)$ from $(u, v)$ via the appropriate scaling implied by the HSDE construction, and report $(x_{1}, x_{2}, s_{1}, s_{2}, y)$.\n\nExpress your final answer as the single row vector $(x_{1}, x_{2}, s_{1}, s_{2}, y)$ without units. No rounding is required.", "solution": "The primal LP problem is:\n$$ \\text{minimize } c^{\\top} x = x_1 + 2x_2 $$\n$$ \\text{subject to } A x = x_1 + x_2 = 1, \\quad x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\in \\mathbb{R}_{+}^{2} $$\n\nThe corresponding dual LP problem is:\n$$ \\text{maximize } b^{\\top} y = y $$\n$$ \\text{subject to } A^{\\top} y + s = c, \\quad s = \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} \\in \\mathbb{R}_{+}^{2} $$\nWith the given data, the dual constraint expands to $y + s_1 = 1$ and $y + s_2 = 2$.\n\nThe Homogeneous Self-Dual Embedding (HSDE) formulates the KKT conditions as a homogeneous system with variables $\\tau$ and $\\kappa$. A solution corresponding to primal-dual optimality exists when we can find a solution with $\\tau  0$ and $\\kappa = 0$. The HSDE system is:\n1.  Primal feasibility: $Ax = b\\tau$\n2.  Dual feasibility: $A^{\\top}y + s = c\\tau$\n3.  Duality gap: $c^{\\top}x - b^{\\top}y = 0$ (since $\\kappa=0$)\n4.  Conic constraints: $x \\ge 0, s \\ge 0$\n5.  Complementarity: $x^{\\top}s = 0$\n\nSince we seek a solution with $\\tau  0$, we can simplify by setting $\\tau=1$ to find a particular solution. Any positive scalar multiple of this solution will also be valid. For $\\tau=1$:\n(i) $x_1 + x_2 = 1$\n(ii) $y + s_1 = 1$\n(iii) $y + s_2 = 2$\n(iv) $x_1 + 2x_2 - y = 0 \\implies y = x_1 + 2x_2$\nAnd conditions: $x_1, x_2, s_1, s_2 \\ge 0$, and $x_1s_1=0$, $x_2s_2=0$.\n\nFrom (i), $x_2 = 1 - x_1$. Substituting into (iv):\n$y = x_1 + 2(1 - x_1) = 2 - x_1$.\n\nFrom (ii) and (iii):\n$s_1 = 1 - y = 1 - (2 - x_1) = x_1 - 1$.\n$s_2 = 2 - y = 2 - (2 - x_1) = x_1$.\n\nNow, we apply the non-negativity constraints:\n- $x_1 \\ge 0$.\n- $x_2 = 1 - x_1 \\ge 0 \\implies x_1 \\le 1$.\n- $s_1 = x_1 - 1 \\ge 0 \\implies x_1 \\ge 1$.\n- $s_2 = x_1 \\ge 0$.\n\nCombining $x_1 \\le 1$ and $x_1 \\ge 1$ forces $x_1=1$.\nWith $x_1=1$, we find the other variables:\n- $x_2 = 1 - 1 = 0$.\n- $y = 2 - 1 = 1$.\n- $s_1 = 1 - 1 = 0$.\n- $s_2 = 1$.\n\nThis solution $(x_1, x_2, y, s_1, s_2) = (1, 0, 1, 0, 1)$ satisfies all non-negativity constraints. Let's check complementarity:\n- $x_1s_1 = 1 \\cdot 0 = 0$.\n- $x_2s_2 = 0 \\cdot 1 = 0$.\nThe conditions are satisfied.\n\nThe problem asks for:\n1.  A vector $u=(x, y, \\tau)$ with $\\tau=1$. From our derivation, $x = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ and $y=1$. Thus, $u = (x_1, x_2, y, \\tau) = (1, 0, 1, 1)$.\n2.  The vector $v=(s, r, \\kappa)$. Since this is an optimal solution, the primal residual $r=0$ and duality gap $\\kappa=0$. We found $s = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$. Thus, $v = (s_1, s_2, r, \\kappa) = (0, 1, 0, 0)$.\n3.  Recovery of the primal-dual variables. For a solution with $\\tau  0$, the optimal solution to the original LP is given by scaling the homogeneous variables by $\\tau$. Since we set $\\tau=1$, the variables are already scaled.\n    - Primal optimal solution: $x_{opt} = x/\\tau = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} / 1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n    - Dual optimal solution: $y_{opt} = y/\\tau = 1/1 = 1$.\n    - Dual optimal slacks: $s_{opt} = s/\\tau = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} / 1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\nThe required output is the row vector $(x_{1}, x_{2}, s_{1}, s_{2}, y)$. This is $(1, 0, 0, 1, 1)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  0  0  1  1 \\end{pmatrix}}\n$$", "id": "3137129"}, {"introduction": "Perhaps the most powerful feature of the HSD embedding is not just finding solutions, but gracefully handling cases where none exist. This practice delves into the important $\\tau = 0$ case, which signals infeasibility. You will work with a problem where both the primal and dual are infeasible, and discover how the structure of the HSD certificate vector provides a definitive diagnosis by separating the evidence for primal infeasibility from the evidence for dual infeasibility.", "problem": "Consider the canonical conic primal-dual pair defined as follows. The primal problem is to minimize $c^{\\top}x$ subject to $A x + s = b$ with $s \\in \\mathcal{K}$, and the dual problem is to maximize $-b^{\\top}y$ subject to $A^{\\top}y + c = 0$ with $y \\in \\mathcal{K}^{\\ast}$, where $\\mathcal{K}$ is a closed convex cone and $\\mathcal{K}^{\\ast}$ is its dual cone. For this exercise, take $n=2$ decision variables, $m=2$ equality constraints, the cone $\\mathcal{K} = \\mathbb{R}_{+}^{2}$, and data\n$$\nA = \\begin{pmatrix}\n0  0 \\\\\n0  0\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}\n-1 \\\\\n1\n\\end{pmatrix},\\quad\nc = \\begin{pmatrix}\n-2 \\\\\n0\n\\end{pmatrix}.\n$$\nTasks:\n1) Using only the definitions of feasibility for the primal and dual problems and the definition of the dual cone $\\mathcal{K}^{\\ast}$, prove that both the primal and the dual problems are infeasible for the given data.\n2) Starting from the conic primal-dual pair above and the fundamental idea of the Homogeneous Self-Dual Embedding (HSDE), derive the simplified HSDE equalities for this specific instance. Your derivation must identify the relationships among the variables $x \\in \\mathbb{R}^{2}$, $s \\in \\mathbb{R}^{2}$, $y \\in \\mathbb{R}^{2}$, $\\tau \\in \\mathbb{R}_{+}$, and $\\kappa \\in \\mathbb{R}_{+}$, and must establish from first principles which of these variables must be zero for any certificate returned by the HSDE on this instance.\n3) Explain rigorously how the HSDE certificate vector structure separates a primal infeasibility certificate from a dual infeasibility certificate in this instance, by specifying the conditions on the components $(x, y)$ under which each certificate arises. Then, derive the scalar $\\kappa$ in terms of $c$, $b$, $x$, and $y$ for this instance.\n4) Now instantiate concrete certificate choices consistent with the cone memberships to exhibit each type of infeasibility: take $y = \\begin{pmatrix}1\\\\0\\end{pmatrix}$ and $x = \\begin{pmatrix}1\\\\0\\end{pmatrix}$, with all other certificate components set as required by your HSDE derivation. Compute the corresponding values $\\kappa_{\\text{primal}}$ (using $x=\\mathbf{0}$ and the chosen $y$) and $\\kappa_{\\text{dual}}$ (using $y=\\mathbf{0}$ and the chosen $x$), and then compute the scalar difference $\\kappa_{\\text{dual}} - \\kappa_{\\text{primal}}$. Provide this difference as your final answer. No rounding is required; give the exact value with no units.", "solution": "The analysis of the problem will be presented in four parts, corresponding to the four tasks enumerated in the problem statement.\n\nFirst, we address the feasibility of the primal and dual problems.\nThe primal problem is to find $x \\in \\mathbb{R}^{2}$ such that there exists an $s \\in \\mathcal{K} = \\mathbb{R}_{+}^{2}$ satisfying the constraint $A x + s = b$. Given $A = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$, the term $A x$ is the zero vector $\\mathbf{0} \\in \\mathbb{R}^{2}$ for any $x$. The constraint simplifies to $\\mathbf{0} + s = b$, which means $s=b$. For the primal problem to be feasible, $s$ must belong to the cone $\\mathcal{K} = \\mathbb{R}_{+}^{2}$. This requires $b \\in \\mathbb{R}_{+}^{2}$. The given vector $b = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$ has a negative first component, $b_1 = -1$, so it does not belong to $\\mathbb{R}_{+}^{2}$. Therefore, the primal problem is infeasible.\n\nThe dual problem is to find $y \\in \\mathcal{K}^{\\ast}$ such that $A^{\\top}y + c = 0$. The cone is $\\mathcal{K} = \\mathbb{R}_{+}^{2}$, which is self-dual, so its dual cone is $\\mathcal{K}^{\\ast} = \\mathbb{R}_{+}^{2}$. The condition $y \\in \\mathcal{K}^{\\ast}$ means $y \\ge \\mathbf{0}$. The matrix $A^{\\top}$ is also the zero matrix $\\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$. The dual constraint $A^{\\top}y + c = 0$ thus simplifies to $\\mathbf{0} \\cdot y + c = \\mathbf{0}$, which implies $c = \\mathbf{0}$. However, the given vector is $c = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}$, which is not the zero vector. As the constraint $c = \\mathbf{0}$ cannot be satisfied, no such $y$ exists. Therefore, the dual problem is infeasible.\n\nSecond, we derive the simplified Homogeneous Self-Dual Embedding (HSDE) equalities for this instance. The HSDE embeds the KKT conditions into a larger, homogeneous linear system using parameters $\\tau \\ge 0$ and $\\kappa \\ge 0$. For this primal-dual pair, the HSDE system is:\n(1) $A x + s = \\tau b$\n(2) $A^{\\top}y + \\tau c = 0$\n(3) $b^{\\top}y + c^{\\top}x = -\\kappa$\n(4) $s \\in \\mathcal{K}, y \\in \\mathcal{K}^{\\ast}, \\tau \\ge 0, \\kappa \\ge 0$\nSubstituting the given data $A=\\mathbf{0}$, $b=\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$, $c=\\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}$, and $\\mathcal{K}=\\mathcal{K}^{\\ast}=\\mathbb{R}_{+}^{2}$:\nFrom (2), $\\mathbf{0}^{\\top}y + \\tau c = \\mathbf{0}$, which simplifies to $\\tau c = \\mathbf{0}$. Since $c \\neq \\mathbf{0}$, this immediately implies that $\\tau = 0$.\nFrom (1), with $\\tau=0$, we have $\\mathbf{0} \\cdot x + s = 0 \\cdot b$, which simplifies to $s = \\mathbf{0}$.\nThus, for any non-zero solution to the HSDE for this specific instance, the variables $\\tau$ and $s$ must be zero. The remaining HSDE conditions for a non-zero certificate vector $(x, y, \\kappa \\ge 0)$ are:\n$A^{\\top}y=0$ (which is $0=0$, trivially true), $y \\in \\mathbb{R}_{+}^{2}$, and $b^{\\top}y + c^{\\top}x = -\\kappa$.\n\nThird, we explain how the HSDE certificate separates primal and dual infeasibility. When the HSDE procedure yields a solution with $\\tau=0$, it provides a certificate of infeasibility. The certificate vector is $(x, y, s=\\mathbf{0}, \\tau=0, \\kappa  0)$. The condition $b^{\\top}y + c^{\\top}x = -\\kappa$ implies $b^{\\top}y + c^{\\top}x  0$.\nA certificate of primal infeasibility is a vector $y_p$ satisfying $A^{\\top}y_p = \\mathbf{0}$, $y_p \\in \\mathcal{K}^{\\ast}$, and $b^{\\top}y_p  0$. In our HSDE framework, if we find a solution where $x=\\mathbf{0}$ and $y \\neq \\mathbf{0}$, the conditions become $y \\in \\mathbb{R}_{+}^{2}$ and $b^{\\top}y = -\\kappa  0$. This HSDE solution component $y$ is precisely a certificate of primal infeasibility.\nA certificate of dual infeasibility is a vector $x_d$ satisfying $Ax_d = -s_d$ for some $s_d \\in \\mathcal{K}$ and $c^{\\top}x_d  0$. Since $A=\\mathbf{0}$, the condition $Ax_d \\in -\\mathcal{K}$ is trivially satisfied for any $x_d$ (with $s_d = \\mathbf{0}$). So we need an $x_d$ with $c^{\\top}x_d  0$. In our HSDE framework, if we find a solution where $y=\\mathbf{0}$ and $x \\neq \\mathbf{0}$, the conditions become $c^{\\top}x = -\\kappa  0$. This HSDE solution component $x$ is precisely a certificate of dual infeasibility.\nThe HSDE certificate vector $(x, y)$ is thus a composite certificate, where the $y$ component certifies primal infeasibility and the $x$ component certifies dual infeasibility. The scalar $\\kappa$ is derived from equation (3) of the HSDE system: $\\kappa = -b^{\\top}y - c^{\\top}x$.\n\nFourth, we instantiate concrete certificate choices and compute the required difference.\nFor a pure primal infeasibility certificate, we set $x = \\mathbf{0}$ and use the given $y = \\begin{pmatrix}1\\\\0\\end{pmatrix}$. We first verify that this choice of $y$ is valid: $y \\in \\mathbb{R}_{+}^{2}$ is true. The corresponding $\\kappa_{\\text{primal}}$ is:\n$$\n\\kappa_{\\text{primal}} = -b^{\\top}y - c^{\\top}\\mathbf{0} = -b^{\\top}y = -\\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -(-1 \\cdot 1 + 1 \\cdot 0) = -(-1) = 1\n$$\nFor a pure dual infeasibility certificate, we set $y = \\mathbf{0}$ and use the given $x = \\begin{pmatrix}1\\\\0\\end{pmatrix}$. The corresponding $\\kappa_{\\text{dual}}$ is:\n$$\n\\kappa_{\\text{dual}} = -b^{\\top}\\mathbf{0} - c^{\\top}x = -c^{\\top}x = -\\begin{pmatrix} -2  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -(-2 \\cdot 1 + 0 \\cdot 0) = -(-2) = 2\n$$\nThe problem asks for the scalar difference $\\kappa_{\\text{dual}} - \\kappa_{\\text{primal}}$.\n$$\n\\kappa_{\\text{dual}} - \\kappa_{\\text{primal}} = 2 - 1 = 1\n$$", "answer": "$$\\boxed{1}$$", "id": "3137092"}]}