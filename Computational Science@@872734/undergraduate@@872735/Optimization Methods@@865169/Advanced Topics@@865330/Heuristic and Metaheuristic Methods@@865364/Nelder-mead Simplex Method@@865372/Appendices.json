{"hands_on_practices": [{"introduction": "The Nelder-Mead algorithm's elegance lies in its geometric intuition. Each iteration begins with a crucial assessment of the current simplex to decide which direction to explore next. This initial exercise focuses on the very first step: identifying the worst-performing vertex and calculating the centroid of the remaining 'good' vertices, which serves as a pivot for improvement [@problem_id:2217758].", "problem": "In an effort to optimize a manufacturing process, an engineer is using the Nelder-Mead algorithm to find a set of two parameters, $x$ and $y$, that minimizes a cost function, $f(x,y)$. At the beginning of an iteration, the algorithm's simplex in the 2-dimensional parameter space consists of three vertices: $P_1$, $P_2$, and $P_3$. The coordinates of these vertices and their corresponding cost function values are given as follows:\n\n- Vertex $P_1$: coordinates $(\\frac{3}{2}, 2)$, with function value $f(P_1) = \\frac{25}{2}$.\n- Vertex $P_2$: coordinates $(3, \\frac{9}{2})$, with function value $f(P_2) = 25$.\n- Vertex $P_3$: coordinates $(\\frac{5}{2}, 1)$, with function value $f(P_3) = \\frac{17}{2}$.\n\nAs a preliminary step for determining the next test point, you need to identify the worst vertex (the one with the highest function value) and calculate the centroid of the remaining vertices.\n\nDetermine the coordinates $(x_w, y_w)$ of the worst vertex and the coordinates $(x_c, y_c)$ of the centroid of the other vertices. Your final answer should be a row matrix containing these four values in the order $(x_w, y_w, x_c, y_c)$. Provide the coordinates as exact fractions or integers.", "solution": "In the Nelder-Mead algorithm, the worst vertex is the one with the highest function value. Given the function values\n$$f(P_{1})=\\frac{25}{2}, \\quad f(P_{2})=25, \\quad f(P_{3})=\\frac{17}{2},$$\nwe note that\n$$25 > \\frac{25}{2}, \\quad 25 > \\frac{17}{2},$$\nso the worst vertex is $P_{2}$ with coordinates $(3, \\frac{9}{2})$. Thus $(x_{w}, y_{w})=(3, \\frac{9}{2})$.\n\nThe centroid of the remaining two vertices $P_{1}=(\\frac{3}{2},2)$ and $P_{3}=(\\frac{5}{2},1)$ is the average of their coordinates. Therefore,\n$$x_{c}=\\frac{\\frac{3}{2}+\\frac{5}{2}}{2}=\\frac{\\frac{8}{2}}{2}=\\frac{4}{2}=2,$$\n$$y_{c}=\\frac{2+1}{2}=\\frac{3}{2}.$$\nHence $(x_{c}, y_{c})=(2, \\frac{3}{2})$.\n\nThe requested row matrix in the order $(x_{w}, y_{w}, x_{c}, y_{c})$ is $\\begin{pmatrix}3 & \\frac{9}{2} & 2 & \\frac{3}{2}\\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} 3 & \\frac{9}{2} & 2 & \\frac{3}{2} \\end{pmatrix}}$$", "id": "2217758"}, {"introduction": "After identifying the worst vertex, the algorithm tries to replace it with a better one through a series of tactical moves. This comprehensive practice guides you through two full iterations of the Nelder-Mead method, challenging you to apply the rules for reflection, expansion, and contraction based on the landscape of the objective function [@problem_id:3155005]. Mastering this decision-making flowchart is key to understanding how the simplex navigates towards a minimum.", "problem": "Consider the derivative-free Nelder-Mead (NM) simplex method for unconstrained minimization in $\\mathbb{R}^{2}$, which iteratively updates a set of $3$ vertices (a simplex) using reflection, expansion, contraction, and shrink moves. Let the objective function be\n$$\nf(x_{1},x_{2})=\\max\\big\\{(x_{1}-1)^{2},\\,10(x_{2}+1)^{2}\\big\\}.\n$$\nUse the following classic NM coefficients: reflection coefficient $\\alpha=1$, expansion coefficient $\\gamma=2$, contraction coefficient $\\rho=\\frac{1}{2}$, and shrink coefficient $\\sigma=\\frac{1}{2}$. Start from the initial simplex with vertices\n$$\nx^{(1)}=(4,-2),\\quad x^{(2)}=(5,0),\\quad x^{(3)}=(2,-3).\n$$\nAt each iteration, order the vertices by increasing objective value so that $x^{(L)}$ is the best (lowest function value), $x^{(H)}$ is the worst (highest function value), and $x^{(G)}$ is the remaining vertex. Then compute the centroid $x^{(C)}$ of all points except $x^{(H)}$, reflect $x^{(H)}$ through $x^{(C)}$ via $x^{(R)}=x^{(C)}+\\alpha\\big(x^{(C)}-x^{(H)}\\big)$, and apply the standard NM decision rules to select among reflection, expansion, outside contraction, inside contraction, or shrink.\n\nPerform exactly $2$ iterations of the NM method under these rules. Predict, for each iteration, which move is accepted. Then, after completing the $2$ iterations, report the value of $f$ at the best vertex in the resulting simplex. Provide the exact value of this final objective.", "solution": "The problem requires performing exactly $2$ iterations of the Nelder-Mead (NM) simplex method for the objective function $f(x_{1},x_{2})=\\max\\big\\{(x_{1}-1)^{2},\\,10(x_{2}+1)^{2}\\big\\}$. The NM parameters are given as the reflection coefficient $\\alpha=1$, expansion coefficient $\\gamma=2$, contraction coefficient $\\rho=\\frac{1}{2}$, and shrink coefficient $\\sigma=\\frac{1}{2}$. The initial simplex is defined by the vertices $x^{(1)}=(4,-2)$, $x^{(2)}=(5,0)$, and $x^{(3)}=(2,-3)$.\n\n**Iteration 1**\n\nFirst, we evaluate the objective function at each of the initial vertices.\nThe vertex $x^{(1)}=(4,-2)$ has the function value:\n$$f(x^{(1)}) = f(4,-2) = \\max\\big\\{(4-1)^{2}, 10(-2+1)^{2}\\big\\} = \\max\\{3^{2}, 10(-1)^{2}\\} = \\max\\{9, 10\\} = 10$$\nThe vertex $x^{(2)}=(5,0)$ has the function value:\n$$f(x^{(2)}) = f(5,0) = \\max\\big\\{(5-1)^{2}, 10(0+1)^{2}\\big\\} = \\max\\{4^{2}, 10(1)^{2}\\} = \\max\\{16, 10\\} = 16$$\nThe vertex $x^{(3)}=(2,-3)$ has the function value:\n$$f(x^{(3)}) = f(2,-3) = \\max\\big\\{(2-1)^{2}, 10(-3+1)^{2}\\big\\} = \\max\\{1^{2}, 10(-2)^{2}\\} = \\max\\{1, 40\\} = 40$$\n\nNext, we order the vertices according to their function values, from best (lowest) to worst (highest).\nThe best vertex is $x^{(L)} = x^{(1)} = (4,-2)$, with $f_L = 10$.\nThe next-best vertex is $x^{(G)} = x^{(2)} = (5,0)$, with $f_G = 16$.\nThe worst vertex is $x^{(H)} = x^{(3)} = (2,-3)$, with $f_H = 40$.\n\nWe compute the centroid $x^{(C)}$ of all vertices except the worst one, $x^{(H)}$:\n$$x^{(C)} = \\frac{1}{2}(x^{(L)} + x^{(G)}) = \\frac{1}{2}\\big((4,-2) + (5,0)\\big) = \\frac{1}{2}(9,-2) = \\left(\\frac{9}{2}, -1\\right)$$\n\nNow, we perform the reflection step. The reflected point $x^{(R)}$ is computed using $\\alpha=1$:\n$$x^{(R)} = x^{(C)} + \\alpha(x^{(C)} - x^{(H)}) = 2x^{(C)} - x^{(H)} = 2\\left(\\frac{9}{2}, -1\\right) - (2,-3) = (9,-2) - (2,-3) = (7,1)$$\nWe evaluate the objective function at $x^{(R)}$:\n$$f_R = f(7,1) = \\max\\big\\{(7-1)^{2}, 10(1+1)^{2}\\big\\} = \\max\\{6^{2}, 10(2)^{2}\\} = \\max\\{36, 40\\} = 40$$\n\nWe apply the NM decision rules. We compare $f_R=40$ with $f_L=10$, $f_G=16$, and $f_H=40$.\nSince $f_R \\ge f_G$ (as $40 \\ge 16$), neither reflection nor expansion is accepted. We proceed to a contraction step.\nWe determine whether to perform an outside or inside contraction. Since $f_R \\ge f_H$ (as $40 \\ge 40$), an **inside contraction** is required.\nThe accepted move for the first iteration is an inside contraction.\n\nThe inside-contracted point $x_{IC}$ is computed with $\\rho=\\frac{1}{2}$:\n$$x_{IC} = x^{(C)} + \\rho(x^{(H)} - x^{(C)}) = (1-\\rho)x^{(C)} + \\rho x^{(H)} = \\frac{1}{2}x^{(C)} + \\frac{1}{2}x^{(H)}$$\n$$x_{IC} = \\frac{1}{2}\\left(\\frac{9}{2}, -1\\right) + \\frac{1}{2}(2,-3) = \\left(\\frac{9}{4}, -\\frac{1}{2}\\right) + \\left(1, -\\frac{3}{2}\\right) = \\left(\\frac{13}{4}, -2\\right)$$\nWe evaluate the objective function at $x_{IC}$:\n$$f_{IC} = f\\left(\\frac{13}{4}, -2\\right) = \\max\\left\\{\\left(\\frac{13}{4}-1\\right)^{2}, 10(-2+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{9}{4}\\right)^{2}, 10(-1)^{2}\\right\\} = \\max\\left\\{\\frac{81}{16}, 10\\right\\} = 10$$\nSince $f_{IC} < f_H$ (as $10 < 40$), the contraction is successful. We accept the new point $x_{IC}$ and replace the worst vertex $x^{(H)}$ with it.\nThe new simplex for the next iteration has vertices $\\{x^{(L)}, x^{(G)}, x_{IC}\\}$, which are $\\left\\{(4,-2), (5,0), \\left(\\frac{13}{4}, -2\\right)\\right\\}$.\n\n**Iteration 2**\n\nWe start with the new simplex and their corresponding function values:\n- $v_1 = (4,-2)$ with $f(v_1) = 10$.\n- $v_2 = (5,0)$ with $f(v_2) = 16$.\n- $v_3 = \\left(\\frac{13}{4}, -2\\right)$ with $f(v_3) = 10$.\n\nWe order these vertices:\nThe worst vertex is $x^{(H)} = v_2 = (5,0)$, with $f_H = 16$.\nThe other two vertices have the same best value. We can assign them arbitrarily. Let $x^{(L)} = v_1 = (4,-2)$ with $f_L=10$, and $x^{(G)} = v_3 = \\left(\\frac{13}{4}, -2\\right)$ with $f_G=10$.\n\nWe compute the centroid of the best points:\n$$x^{(C)} = \\frac{1}{2}(x^{(L)} + x^{(G)}) = \\frac{1}{2}\\left((4,-2) + \\left(\\frac{13}{4}, -2\\right)\\right) = \\frac{1}{2}\\left(\\frac{16+13}{4}, -4\\right) = \\frac{1}{2}\\left(\\frac{29}{4}, -4\\right) = \\left(\\frac{29}{8}, -2\\right)$$\n\nWe perform the reflection step with $\\alpha=1$:\n$$x^{(R)} = 2x^{(C)} - x^{(H)} = 2\\left(\\frac{29}{8}, -2\\right) - (5,0) = \\left(\\frac{29}{4}, -4\\right) - (5,0) = \\left(\\frac{29-20}{4}, -4\\right) = \\left(\\frac{9}{4}, -4\\right)$$\nWe evaluate the objective function at $x^{(R)}$:\n$$f_R = f\\left(\\frac{9}{4},-4\\right) = \\max\\left\\{\\left(\\frac{9}{4}-1\\right)^{2}, 10(-4+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{5}{4}\\right)^{2}, 10(-3)^{2}\\right\\} = \\max\\left\\{\\frac{25}{16}, 90\\right\\} = 90$$\n\nWe apply the NM rules with $f_R=90$, $f_L=10$, $f_G=10$, and $f_H=16$.\nSince $f_R \\ge f_G$ (as $90 \\ge 10$), we proceed to a contraction.\nSince $f_R \\ge f_H$ (as $90 \\ge 16$), an **inside contraction** is required.\nThe accepted move for the second iteration is again an inside contraction.\n\nThe inside-contracted point $x_{IC}$ is computed with $\\rho=\\frac{1}{2}$:\n$$x_{IC} = \\frac{1}{2}x^{(C)} + \\frac{1}{2}x^{(H)} = \\frac{1}{2}\\left(\\frac{29}{8}, -2\\right) + \\frac{1}{2}(5,0) = \\left(\\frac{29}{16}, -1\\right) + \\left(\\frac{5}{2}, 0\\right) = \\left(\\frac{29+40}{16}, -1\\right) = \\left(\\frac{69}{16}, -1\\right)$$\nWe evaluate the objective function at $x_{IC}$:\n$$f_{IC} = f\\left(\\frac{69}{16},-1\\right) = \\max\\left\\{\\left(\\frac{69}{16}-1\\right)^{2}, 10(-1+1)^{2}\\right\\} = \\max\\left\\{\\left(\\frac{53}{16}\\right)^{2}, 0\\right\\} = \\frac{2809}{256}$$\nTo check for acceptance, we compare $f_{IC}$ with $f_H$. $f_{IC} = \\frac{2809}{256} \\approx 10.97$, and $f_H=16$.\nSince $f_{IC} < f_H$, the contraction is successful. We replace $x^{(H)}$ with $x_{IC}$.\n\nThe final simplex after $2$ iterations consists of the vertices $\\left\\{(4,-2), \\left(\\frac{13}{4}, -2\\right), \\left(\\frac{69}{16}, -1\\right)\\right\\}$.\n\n**Final Result**\n\nThe problem asks for the value of $f$ at the best vertex in the resulting simplex. We examine the function values at the three final vertices:\n- $f(4,-2) = 10$\n- $f\\left(\\frac{13}{4}, -2\\right) = 10$\n- $f\\left(\\frac{69}{16}, -1\\right) = \\frac{2809}{256}$\n\nThe function values are $\\{10, 10, \\frac{2809}{256}\\}$. Since $\\frac{2809}{256} \\approx 10.97$, the minimum (best) value among these is $10$.\nThe accepted moves in the two iterations were: Inside Contraction, and Inside Contraction.\nThe value of $f$ at the best vertex in the final simplex is $10$.", "answer": "$$\\boxed{10}$$", "id": "3155005"}, {"introduction": "While the Nelder-Mead method is powerful, its success depends on a proper geometric setup. This conceptual exercise explores a common pitfall: starting with a 'degenerate' simplex, where all vertices lie in a lower-dimensional subspace [@problem_id:2217780]. By analyzing this scenario, you will gain a deeper appreciation for why a well-formed initial simplex is essential for the algorithm to effectively explore the entire search space.", "problem": "An engineering student is tasked with finding the minimum of a cost function $C(x, y)$ which depends on two design parameters, $x$ and $y$. They decide to use the Nelder-Mead algorithm, a popular numerical optimization method that does not require derivatives. For this two-dimensional problem, the algorithm works by iteratively updating a simplex, which is a triangle in the $xy$-plane.\n\nThe student initializes the algorithm with the following three vertices for the initial simplex:\n$v_1 = (3.0, 1.0)$\n$v_2 = (3.0, 4.0)$\n$v_3 = (3.0, 8.0)$\n\nWithout any knowledge of the cost function $C(x, y)$ or its values at these vertices, which of the following statements best describes a fundamental limitation the algorithm will face from the very beginning, preventing it from effectively exploring the two-dimensional search space to find the minimum?\n\nA. The starting simplex is too small, which will cause the algorithm to converge prematurely to a point that is not a local minimum.\nB. All vertices have the same x-coordinate, forming a degenerate simplex which is confined to a one-dimensional line and cannot explore variations in the x-direction.\nC. The centroid of the initial simplex will be identical to one of the vertices, causing the algorithm to enter an infinite loop.\nD. The algorithm requires at least one vertex to be at the origin $(0,0)$ to guarantee convergence.\nE. The reflection step of the algorithm will always generate a point outside the feasible design space, causing an immediate failure.", "solution": "A simplex in two dimensions must be a nondegenerate triangle, i.e., its three vertices must be noncollinear. A standard way to verify nondegeneracy is to compute the signed area using\n$$\nA=\\frac{1}{2}\\left|\\det\\begin{pmatrix}x_{2}-x_{1} & y_{2}-y_{1} \\\\ x_{3}-x_{1} & y_{3}-y_{1}\\end{pmatrix}\\right|.\n$$\nWith $v_{1}=(3,1)$, $v_{2}=(3,4)$, $v_{3}=(3,8)$, we have $x_{2}-x_{1}=0$ and $x_{3}-x_{1}=0$, hence\n$$\nA=\\frac{1}{2}\\left|\\det\\begin{pmatrix}0 & 3 \\\\ 0 & 7\\end{pmatrix}\\right|=\\frac{1}{2}\\left|0\\cdot 7-0\\cdot 3\\right|=0,\n$$\nso the three points are collinear and the initial simplex is degenerate, lying on the line $x=3$.\n\nNelder-Mead updates points using affine operations based on the centroid of the best $n$ vertices in $n$ dimensions. In two dimensions, with reflection coefficient $\\alpha$, expansion coefficient $\\gamma$, contraction coefficient $\\rho$, and shrink coefficient $\\sigma$, the operations generate new points of the forms\n$$\nx_{r}=x_{c}+\\alpha(x_{c}-x_{h}),\\quad x_{e}=x_{c}+\\gamma(x_{r}-x_{c}),\\quad x_{co}=x_{c}+\\rho(x_{h}-x_{c}),\n$$\nand shrink updates are affine combinations of existing vertices. If all vertices initially lie on the affine line $L=\\{(3,y): y\\in\\mathbb{R}\\}$, then the centroid $x_c$ also lies on $L$, and every affine combination of points on $L$ remains on $L$. Therefore, every reflected, expanded, contracted, or shrunk point remains on $L$. The algorithm is thus confined to a one-dimensional subspace and cannot explore variations in the $x$-direction, failing to explore the two-dimensional search space.\n\nChecking the alternatives:\n- A is not a fundamental limitation; size alone does not prevent two-dimensional exploration, whereas degeneracy does.\n- B correctly identifies the degeneracy: all $x$-coordinates are equal, confining the search to a line.\n- C is false here since the centroid is $x_{c}=(3,\\frac{1+4+8}{3})=(3,\\frac{13}{3})$, which is not any of the vertices, and, in general, Nelder-Mead does not require the centroid to differ from all vertices to proceed unless points coincide.\n- D is false; Nelder-Mead has no requirement that a vertex be at the origin.\n- E is unsupported; no feasible region is specified, and, geometrically, the reflections remain on the same line, not outside any defined domain.\n\nTherefore, the correct statement is B.", "answer": "$$\\boxed{B}$$", "id": "2217780"}]}