{"hands_on_practices": [{"introduction": "The condition number of a matrix quantifies its sensitivity to input errors, a crucial concept in numerical stability. This first exercise focuses on the fundamental definition of the 2-norm condition number, $\\kappa_2(A)$, as the ratio of the largest to the smallest singular values. By working with a simple diagonal matrix, you will build a solid intuition for this definition, as the singular values are directly related to the matrix's entries [@problem_id:2210789].", "problem": "In numerical linear algebra, the 2-norm condition number of an invertible matrix $A$, denoted $\\kappa_2(A)$, provides a measure of how sensitive the solution of the linear system $A\\mathbf{x} = \\mathbf{b}$ is to perturbations in the vector $\\mathbf{b}$. It is defined as the ratio of the largest singular value of $A$ to its smallest singular value.\n\nConsider a 2x2 real diagonal matrix $D$ given by\n$$D = \\begin{pmatrix} d_1 & 0 \\\\ 0 & d_2 \\end{pmatrix}$$\nIf the first diagonal element is $d_1 = 10$ and the 2-norm condition number of the matrix is $\\kappa_2(D) = 50$, what are all possible real values for the second diagonal element, $d_2$? Present your answers in ascending order as a single row matrix.", "solution": "The 2-norm condition number of an invertible matrix $A$ is defined by\n$$\n\\kappa_{2}(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)},\n$$\nwhere $\\sigma_{\\max}(A)$ and $\\sigma_{\\min}(A)$ denote the largest and smallest singular values of $A$, respectively.\n\nFor the diagonal matrix\n$$\nD = \\begin{pmatrix} d_{1} & 0 \\\\ 0 & d_{2} \\end{pmatrix},\n$$\nthe singular values are the absolute values of the diagonal entries, because the singular values are the square roots of the eigenvalues of $D^{\\top}D$, and\n$$\nD^{\\top}D = \\begin{pmatrix} d_{1}^{2} & 0 \\\\ 0 & d_{2}^{2} \\end{pmatrix},\n$$\nso the singular values are $|d_{1}|$ and $|d_{2}|$.\n\nGiven $d_{1} = 10$ and $\\kappa_{2}(D) = 50$, we have\n$$\n\\kappa_{2}(D) = \\frac{\\max\\{|d_{1}|,|d_{2}|\\}}{\\min\\{|d_{1}|,|d_{2}|\\}} = 50,\n$$\nwith the constraint $d_{2} \\neq 0$ (invertibility).\n\nConsider the two cases:\n1) If $|d_{1}| \\geq |d_{2}|$, then $\\sigma_{\\max} = |d_{1}| = 10$ and $\\sigma_{\\min} = |d_{2}|$, hence\n$$\n\\frac{10}{|d_{2}|} = 50 \\quad \\Rightarrow \\quad |d_{2}| = \\frac{10}{50} = \\frac{1}{5},\n$$\nso $d_{2} = \\pm \\frac{1}{5}$.\n\n2) If $|d_{2}| > |d_{1}|$, then $\\sigma_{\\max} = |d_{2}|$ and $\\sigma_{\\min} = |d_{1}| = 10$, hence\n$$\n\\frac{|d_{2}|}{10} = 50 \\quad \\Rightarrow \\quad |d_{2}| = 500,\n$$\nso $d_{2} = \\pm 500$.\n\nCollecting all real possibilities and listing them in ascending order gives $-500$, $-\\frac{1}{5}$, $\\frac{1}{5}$, $500$.", "answer": "$$\\boxed{\\begin{pmatrix}-500 & -\\frac{1}{5} & \\frac{1}{5} & 500\\end{pmatrix}}$$", "id": "2210789"}, {"introduction": "While the condition number provides a theoretical measure of sensitivity, seeing it in action makes the concept truly click. This practice moves from abstract definition to a concrete demonstration of what \"ill-conditioned\" means for a system of linear equations $Ax=b$. You will observe how a seemingly insignificant perturbation in the vector $b$ can lead to a dramatically different solution $x$, directly illustrating the error amplification that a large condition number warns against [@problem_id:1393603].", "problem": "Consider the linear system of equations $Ax=b$, where the matrix $A$ and vector $b$ are given by:\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.01 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}\n$$\nNow, suppose the right-hand side vector $b$ is perturbed to a new vector $b'$, leading to a new solution $x'$. The perturbed system is $Ax' = b'$, where:\n$$\nb' = \\begin{pmatrix} 2 \\\\ 2.01 \\end{pmatrix}\n$$\nLet $\\delta x = x' - x$ and $\\delta b = b' - b$ represent the changes in the solution and the right-hand side vector, respectively. Your task is to quantify the sensitivity of the system to this small perturbation.\n\nCalculate the amplification factor for this perturbation, which is defined as the ratio of the relative error in the solution to the relative error in the right-hand side vector. This factor is given by the expression:\n$$\n\\frac{\\|\\delta x\\| / \\|x\\|}{\\|\\delta b\\| / \\|b\\|}\n$$\nFor all vector norm calculations, use the standard Euclidean norm (also known as the $L_2$ norm), defined as $\\|v\\| = \\sqrt{v_1^2 + v_2^2 + \\dots + v_n^2}$ for a vector $v = (v_1, v_2, \\dots, v_n)$.\n\nProvide your answer as a single real number.", "solution": "We solve the unperturbed system $Ax=b$ with $A=\\begin{pmatrix}1 & 1 \\\\ 1 & 1.01\\end{pmatrix}$ and $b=\\begin{pmatrix}2 \\\\ 2\\end{pmatrix}$. Writing $x=\\begin{pmatrix}x_{1} \\\\ x_{2}\\end{pmatrix}$, the equations are\n$$\nx_{1}+x_{2}=2,\\quad x_{1}+1.01\\,x_{2}=2.\n$$\nSubtracting the first from the second gives\n$$\n0.01\\,x_{2}=0 \\implies x_{2}=0,\n$$\nand then $x_{1}=2$. Hence\n$$\nx=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}.\n$$\n\nFor the perturbed system $Ax'=b'$ with $b'=\\begin{pmatrix}2 \\\\ 2.01\\end{pmatrix}$, write $x'=\\begin{pmatrix}x_{1}' \\\\ x_{2}'\\end{pmatrix}$. The equations are\n$$\nx_{1}'+x_{2}'=2,\\quad x_{1}'+1.01\\,x_{2}'=2.01.\n$$\nSubtracting the first from the second gives\n$$\n0.01\\,x_{2}'=0.01 \\implies x_{2}'=1,\n$$\nand then $x_{1}'=1$. Hence\n$$\nx'=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}.\n$$\n\nTherefore the changes are\n$$\n\\delta x=x'-x=\\begin{pmatrix}-1 \\\\ 1\\end{pmatrix},\\quad \\delta b=b'-b=\\begin{pmatrix}0 \\\\ 0.01\\end{pmatrix}.\n$$\n\nUsing the Euclidean norm $\\|v\\|=\\sqrt{\\sum_{i} v_{i}^{2}}$, we compute\n$$\n\\|\\delta x\\|=\\sqrt{(-1)^{2}+1^{2}}=\\sqrt{2},\\quad \\|x\\|=\\sqrt{2^{2}+0^{2}}=2,\n$$\n$$\n\\|\\delta b\\|=\\sqrt{0^{2}+(0.01)^{2}}=0.01,\\quad \\|b\\|=\\sqrt{2^{2}+2^{2}}=\\sqrt{8}=2\\sqrt{2}.\n$$\n\nThe amplification factor is\n$$\n\\frac{\\|\\delta x\\|/\\|x\\|}{\\|\\delta b\\|/\\|b\\|}=\\frac{\\frac{\\sqrt{2}}{2}}{\\frac{0.01}{2\\sqrt{2}}}=\\frac{1}{\\sqrt{2}}\\cdot\\frac{2\\sqrt{2}}{0.01}=\\frac{2}{0.01}=200.\n$$", "answer": "$$\\boxed{200}$$", "id": "1393603"}, {"introduction": "Understanding that a system is ill-conditioned is one thing; understanding how to pinpoint its greatest vulnerability is another. This advanced practice challenges you to go beyond simply observing error amplification and instead actively design a perturbation that causes the maximum possible error for a given magnitude. By constructing the \"worst-case\" scenario, you will explore the deep connection between a matrix's singular vectors and the specific directions of maximum sensitivity, confirming that the theoretical bound set by the condition number can be practically achieved [@problem_id:3110439].", "problem": "Consider the linear system $A x = b$ with the spectral (two) norm, where\n$$\nA = \\begin{pmatrix}\n5 & 0 & 0 \\\\\n0 & 2 & 0 \\\\\n0 & 0 & 0.2\n\\end{pmatrix}, \\qquad\nb = \\begin{pmatrix}\n1 \\\\ 0 \\\\ 0\n\\end{pmatrix}.\n$$\nYou will study how perturbations in the right-hand side $b$ are amplified in the solution $x$ through the mapping $x = A^{-1} b$. Use only the following foundational facts and definitions:\n- For any matrix $M$, the operator norm induced by the Euclidean norm (the spectral norm) is defined by $\\|M\\|_{2} = \\max_{\\|v\\|_{2} = 1} \\|M v\\|_{2}$.\n- The condition number of an invertible matrix $A$ in the spectral norm is $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{-1}\\|_{2}$.\n- A perturbation $\\delta b$ in $b$ induces a change $\\delta x$ in the solution satisfying $A(x + \\delta x) = b + \\delta b$, hence $\\delta x = A^{-1} \\delta b$.\n\nSubject to the constraint that the relative perturbation magnitude is fixed as $\\|\\delta b\\|_{2} / \\|b\\|_{2} = 0.02$, design a perturbation $\\delta b$ that maximizes the relative solution change $\\|\\delta x\\|_{2} / \\|x\\|_{2}$ predicted by $\\kappa_{2}(A)$, and compute the resulting maximal value of $\\|\\delta x\\|_{2} / \\|x\\|_{2}$. Your final answer must be a single real number. Do not round your answer.", "solution": "The problem requires us to find the maximal relative change in the solution, $\\|\\delta x\\|_{2} / \\|x\\|_{2}$, of a linear system $A x = b$ for a given relative perturbation in the right-hand side, $\\|\\delta b\\|_{2} / \\|b\\|_{2} = 0.02$. We must design the perturbation vector $\\delta b$ to achieve this maximum.\n\nThe problem states that $A(x + \\delta x) = b + \\delta b$. Since $Ax = b$, by linearity we have $A \\delta x = \\delta b$, which implies $\\delta x = A^{-1} \\delta b$. The solution $x$ is given by $x = A^{-1} b$.\n\nThe quantity we want to maximize is the relative change in the solution, which can be expressed as:\n$$\n\\frac{\\|\\delta x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\|A^{-1} \\delta b\\|_{2}}{\\|A^{-1} b\\|_{2}}\n$$\nThe matrix $A$ and the vector $b$ are given:\n$$\nA = \\begin{pmatrix}\n5 & 0 & 0 \\\\\n0 & 2 & 0 \\\\\n0 & 0 & 0.2\n\\end{pmatrix}, \\qquad\nb = \\begin{pmatrix}\n1 \\\\ 0 \\\\ 0\n\\end{pmatrix}.\n$$\nSince $A$ and $b$ are fixed, the denominator $\\|A^{-1} b\\|_{2}$ is a constant value. To maximize the entire fraction, we must maximize the numerator $\\|A^{-1} \\delta b\\|_{2}$ subject to the given constraint on $\\delta b$.\n\nFirst, let's compute the components of the denominator. The inverse of the diagonal matrix $A$ is found by taking the reciprocal of each diagonal element:\n$$\nA^{-1} = \\begin{pmatrix}\n5^{-1} & 0 & 0 \\\\\n0 & 2^{-1} & 0 \\\\\n0 & 0 & 0.2^{-1}\n\\end{pmatrix} = \\begin{pmatrix}\n0.2 & 0 & 0 \\\\\n0 & 0.5 & 0 \\\\\n0 & 0 & 5\n\\end{pmatrix}\n$$\nNow, we compute the solution vector $x = A^{-1}b$:\n$$\nx = A^{-1} b = \\begin{pmatrix}\n0.2 & 0 & 0 \\\\\n0 & 0.5 & 0 \\\\\n0 & 0 & 5\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ 0\n\\end{pmatrix} = \\begin{pmatrix}\n0.2 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\nThe Euclidean norm of $x$ is:\n$$\n\\|x\\|_{2} = \\|A^{-1} b\\|_{2} = \\sqrt{0.2^2 + 0^2 + 0^2} = 0.2\n$$\nNext, we analyze the constraint on the perturbation $\\delta b$. The constraint is given as a relative magnitude:\n$$\n\\frac{\\|\\delta b\\|_{2}}{\\|b\\|_{2}} = 0.02\n$$\nThe norm of the given vector $b$ is:\n$$\n\\|b\\|_{2} = \\sqrt{1^2 + 0^2 + 0^2} = 1\n$$\nSubstituting this into the constraint gives the magnitude of the perturbation vector $\\delta b$:\n$$\n\\|\\delta b\\|_{2} = 0.02 \\times \\|b\\|_{2} = 0.02 \\times 1 = 0.02\n$$\nThe problem is now reduced to maximizing the numerator $\\|A^{-1} \\delta b\\|_{2}$ subject to the constraint that $\\|\\delta b\\|_{2} = 0.02$.\n\nBy the definition of the induced matrix norm (spectral norm), the maximum value of $\\|A^{-1}v\\|_{2}$ for any vector $v$ with norm $\\|v\\|_{2}=R$ is given by $\\|A^{-1}\\|_{2} R$. This maximum is achieved when $v$ is a singular vector of $A^{-1}$ corresponding to its largest singular value, $\\sigma_{max}(A^{-1})$.\n\nFor a symmetric matrix like $A^{-1}$, the singular values are the absolute values of its eigenvalues. The eigenvalues of a diagonal matrix are its diagonal entries. The eigenvalues of $A^{-1}$ are thus $\\lambda_1 = 0.2$, $\\lambda_2 = 0.5$, and $\\lambda_3 = 5$.\n\nThe largest singular value is $\\sigma_{max}(A^{-1}) = \\max(|0.2|, |0.5|, |5|) = 5$. This value is the spectral norm of $A^{-1}$:\n$$\n\\|A^{-1}\\|_{2} = 5\n$$\nThe singular vector (which is also the eigenvector) corresponding to this largest singular value $\\sigma_{max}(A^{-1})=5$ is the standard basis vector $e_3$:\n$$\ne_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nTo maximize $\\|A^{-1} \\delta b\\|_{2}$, we must align $\\delta b$ with this direction of maximum stretch. Thus, $\\delta b$ must be a multiple of $e_3$.\n$$\n\\delta b = c \\cdot e_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ c \\end{pmatrix}\n$$\nApplying the constraint $\\|\\delta b\\|_2 = 0.02$:\n$$\n\\|\\delta b\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ 0 \\\\ c \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^2 + 0^2 + c^2} = |c| = 0.02\n$$\nWe can choose $c=0.02$. The optimal perturbation is therefore:\n$$\n\\delta b = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0.02\n\\end{pmatrix}\n$$\nWith this choice, the value of the numerator $\\|A^{-1} \\delta b\\|_{2}$ becomes:\n$$\n\\|A^{-1} \\delta b\\|_{2} = \\left\\| \\begin{pmatrix}\n0.2 & 0 & 0 \\\\\n0 & 0.5 & 0 \\\\\n0 & 0 & 5\n\\end{pmatrix}\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0.02\n\\end{pmatrix} \\right\\|_{2} = \\left\\| \\begin{pmatrix}\n0 \\\\\n0 \\\\\n5 \\times 0.02\n\\end{pmatrix} \\right\\|_{2} = \\left\\| \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0.1\n\\end{pmatrix} \\right\\|_{2} = 0.1\n$$\nAlternatively, using the norm property: $\\|A^{-1} \\delta b\\|_{2} = \\|A^{-1}\\|_{2} \\|\\delta b\\|_{2} = 5 \\times 0.02 = 0.1$.\n\nFinally, we can compute the maximal relative solution change by substituting the values of the numerator and denominator:\n$$\n\\frac{\\|\\delta x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\|A^{-1}\\delta b\\|_{2}}{\\|A^{-1}b\\|_{2}} = \\frac{0.1}{0.2} = 0.5\n$$\nThis result is consistent with the upper bound given by the condition number. The condition number is $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$. The norm $\\|A\\|_2$ is the largest singular value of $A$, which is $\\max(5, 2, 0.2) = 5$. Thus, $\\kappa_2(A) = 5 \\times 5 = 25$. The general upper bound on relative error is $\\kappa_2(A) \\frac{\\|\\delta b\\|_2}{\\|b\\|_2} = 25 \\times 0.02 = 0.5$. The problem is constructed such that the specific choice of $b$ and the optimal choice of $\\delta b$ cause this worst-case bound to be attained.", "answer": "$$\\boxed{0.5}$$", "id": "3110439"}]}