{"hands_on_practices": [{"introduction": "为了真正掌握梁单元的精髓，我们必须从第一性原理出发，亲手推导其核心矩阵。本练习将指导你从欧拉-伯努利梁理论的应变能和虚功原理出发，为两节点梁单元推导刚度矩阵和一致节点荷载向量。通过这个基础练习，你将深刻理解有限元公式如何从连续介质力学原理中诞生。[@problem_id:2617208]", "problem": "考虑一个等截面 Euler–Bernoulli 梁单元，其杨氏模量 $E$、截面二次矩 $I$ 和长度 $L$ 均为常数。沿梁轴的局部坐标为 $x \\in [0,L]$，横向位移场为 $w(x)$，工程转角为 $\\theta(x) = dw/dx$。该单元在 $x=0$ 和 $x=L$ 处有 $2$ 个节点，其 $4$ 个节点自由度集合在向量 $\\mathbf{d}_e = \\begin{pmatrix} w_1  \\theta_1  w_2  \\theta_2 \\end{pmatrix}^{\\mathsf{T}}$ 中，其中 $w_1=w(0)$、$\\theta_1=\\theta(0)$、$w_2=w(L)$ 和 $\\theta_2=\\theta(L)$。一个大小为 $P$ 的集中端部荷载作用在 $x=L$ 处，方向为横向正方向，且在 $x=L$ 处没有外部施加的节点力矩。\n\n仅从 Euler–Bernoulli 弯曲理论的第一性原理出发，即：\n- 运动学：平截面在变形后仍保持为平面且垂直于变形后的梁中性轴，因此曲率 $\\kappa(x)$ 等于 $d^2 w/dx^2$，\n- 本构关系：弯矩 $M(x)=E I \\kappa(x)$，\n- 应变能：$U=\\frac{1}{2}\\int_{0}^{L} E I \\left( \\frac{d^2 w}{dx^2} \\right)^{2} dx$，\n- 以及虚功原理或总势能驻值原理，\n\n推导在局部坐标系下的 $2$ 节点 Euler–Bernoulli 梁单元刚度矩阵，以及与集中端部荷载 $P$ 相对应的一致单元节点荷载向量。使用基于 $4$ 个节点自由度的三次 Hermite 插值来表示 $w(x)$。清楚地陈述所用的插值函数、相关的曲率-位移算子，并执行获得单元刚度矩阵所需的精确积分。\n\n将你的最终结果表示为一个 $4 \\times 5$ 大小的增广矩阵，其前 $4$ 列是单元刚度矩阵，最后一列是对应于作用在 $x=L$ 处的横向端部荷载 $P$ 的一致单元节点荷载向量。答案应以 $E$、$I$、$L$ 和 $P$ 的符号形式表示。不要代入数值。不要在最终的矩阵中包含单位。", "solution": "该问题是有效的，因为它科学地基于经典的 Euler-Bernoulli 梁理论，是适定的，并为推导所要求的有限元矩阵提供了一套完整且一致的数据和原理。\n\n推导过程从总势能驻值原理开始。系统的总势能 $\\Pi$ 是内部应变能 $U$ 与外力势能 $\\Pi_{ext}$ 之和。当 $\\Pi$ 取驻值时，系统处于平衡状态，即其关于自由度的一阶变分为零。\n\nEuler-Bernoulli 梁的应变能由下式给出：\n$$U = \\frac{1}{2}\\int_{0}^{L} E I \\left( \\frac{d^2 w}{dx^2} \\right)^{2} dx$$\n其中 $E$ 是杨氏模量，$I$ 是截面二次矩，$w(x)$ 是横向位移场。\n\n外荷载是在 $x=L$ 处施加的集中力 $P$。该荷载所做的功为 $W_{ext} = P w(L)$。该外力的势能为 $\\Pi_{ext} = -W_{ext} = -P w(L)$。\n\n总势能为 $\\Pi = U + \\Pi_{ext} = \\frac{1}{2}\\int_{0}^{L} E I \\left( \\frac{d^2 w}{dx^2} \\right)^{2} dx - P w(L)$。\n\n问题指定了用节点自由度 $\\mathbf{d}_e = \\begin{pmatrix} w_1  \\theta_1  w_2  \\theta_2 \\end{pmatrix}^{\\mathsf{T}}$ 表示位移场 $w(x)$ 的三次 Hermite 插值。位移场写作 $w(x) = \\mathbf{N}(x)\\mathbf{d}_e$，其中 $\\mathbf{N}(x) = \\begin{pmatrix} N_1(x)  N_2(x)  N_3(x)  N_4(x) \\end{pmatrix}$ 是形函数向量。\n\n首先，我们推导形函数。假设一个一般的三次多项式 $w(x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3$。转角为 $\\theta(x) = w'(x) = a_1 + 2 a_2 x + 3 a_3 x^2$。通过施加节点条件来确定四个系数 $a_i$：\n$w(0) = w_1 \\implies a_0 = w_1$\n$\\theta(0) = \\theta_1 \\implies a_1 = \\theta_1$\n$w(L) = w_2 \\implies a_0 + a_1 L + a_2 L^2 + a_3 L^3 = w_2$\n$\\theta(L) = \\theta_2 \\implies a_1 + 2 a_2 L + 3 a_3 L^2 = \\theta_2$\n\n解此方程组，用节点自由度表示 $a_2$ 和 $a_3$，然后代回到 $w(x)$ 的表达式中，即可得到用 Hermite 形函数表示的位移场：\n$w(x) = N_1(x)w_1 + N_2(x)\\theta_1 + N_3(x)w_2 + N_4(x)\\theta_2$，其中：\n$N_1(x) = 1 - 3\\frac{x^2}{L^2} + 2\\frac{x^3}{L^3}$\n$N_2(x) = x - 2\\frac{x^2}{L} + \\frac{x^3}{L^2}$\n$N_3(x) = 3\\frac{x^2}{L^2} - 2\\frac{x^3}{L^3}$\n$N_4(x) = -\\frac{x^2}{L} + \\frac{x^3}{L^2}$\n\n接下来，我们建立曲率-位移关系。曲率为 $\\kappa(x) = w''(x)$。使用插值位移场，我们有：\n$\\kappa(x) = w''(x) = \\mathbf{N}''(x)\\mathbf{d}_e = \\mathbf{B}(x)\\mathbf{d}_e$\n曲率-位移算子 $\\mathbf{B}(x)$ 是形函数的二阶导数组成的行向量：\n$\\mathbf{B}(x) = \\begin{pmatrix} N_1''(x)  N_2''(x)  N_3''(x)  N_4''(x) \\end{pmatrix}$\n$N_1''(x) = -\\frac{6}{L^2} + \\frac{12x}{L^3}$\n$N_2''(x) = -\\frac{4}{L} + \\frac{6x}{L^2}$\n$N_3''(x) = \\frac{6}{L^2} - \\frac{12x}{L^3}$\n$N_4''(x) = -\\frac{2}{L} + \\frac{6x}{L^2}$\n\n现在，我们将插值场代入势能表达式中。应变能变为：\n$U = \\frac{1}{2}\\int_{0}^{L} E I (\\mathbf{B}(x)\\mathbf{d}_e)^2 dx = \\frac{1}{2} \\mathbf{d}_e^{\\mathsf{T}} \\left( E I \\int_{0}^{L} \\mathbf{B}(x)^{\\mathsf{T}}\\mathbf{B}(x) dx \\right) \\mathbf{d}_e$\n这个表达式将单元刚度矩阵 $\\mathbf{K}_e$ 定义为：\n$$\\mathbf{K}_e = E I \\int_{0}^{L} \\mathbf{B}(x)^{\\mathsf{T}}\\mathbf{B}(x) dx$$\n刚度矩阵的元素 $K_{ij}$ 为 $K_{ij} = E I \\int_{0}^{L} N_i''(x) N_j''(x) dx$。对每个元素执行精确积分，得到对称的 $4 \\times 4$ 矩阵。例如，第一个元素为：\n$K_{11} = E I \\int_{0}^{L} \\left(-\\frac{6}{L^2} + \\frac{12x}{L^3}\\right)^2 dx = E I \\int_{0}^{L} \\left(\\frac{36}{L^4} - \\frac{144x}{L^5} + \\frac{144x^2}{L^6}\\right) dx = EI \\left[\\frac{36x}{L^4} - \\frac{72x^2}{L^5} + \\frac{48x^3}{L^6}\\right]_0^L = EI \\left(\\frac{36}{L^3} - \\frac{72}{L^3} + \\frac{48}{L^3}\\right) = \\frac{12EI}{L^3}$。\n计算完所有不同的积分后，得到完整的刚度矩阵：\n$$\\mathbf{K}_e = \\frac{EI}{L^3} \\begin{pmatrix} 12  & 6L  & -12  & 6L \\\\ 6L  & 4L^2  & -6L  & 2L^2 \\\\ -12  & -6L  & 12  & -6L \\\\ 6L  & 2L^2  & -6L  & 4L^2 \\end{pmatrix}$$\n\n外力势能用节点自由度表示为：\n$\\Pi_{ext} = -P w(L) = -P \\mathbf{N}(L) \\mathbf{d}_e$。\n我们计算形函数在 $x=L$ 处的值：\n$N_1(L) = 1 - 3 + 2 = 0$\n$N_2(L) = L - 2L + L = 0$\n$N_3(L) = 3 - 2 = 1$\n$N_4(L) = -L + L = 0$\n所以，$\\mathbf{N}(L) = \\begin{pmatrix} 0  0  1  0 \\end{pmatrix}$，且 $\\Pi_{ext} = -P w_2$。\n\n总势能为 $\\Pi = \\frac{1}{2}\\mathbf{d}_e^{\\mathsf{T}}\\mathbf{K}_e\\mathbf{d}_e - P w_2$。\n总势能驻值原理要求 $\\delta \\Pi = 0$，这导出了方程组 $\\mathbf{K}_e \\mathbf{d}_e = \\mathbf{f}_e$。一致节点荷载向量 $\\mathbf{f}_e$ 由外力功 $W_{ext}$ 对节点自由度的偏导数给出，即 $\\mathbf{f}_e = (\\frac{\\partial W_{ext}}{\\partial\\mathbf{d}_e})^{\\mathsf{T}}$。\n$W_{ext} = Pw(L) = P \\mathbf{N}(L) \\mathbf{d}_e$。因此，$\\mathbf{f}_e = (P \\mathbf{N}(L))^{\\mathsf{T}} = P (\\mathbf{N}(L))^{\\mathsf{T}}$。\n代入 $\\mathbf{N}(L)$ 的值：\n$$\\mathbf{f}_e = P \\begin{pmatrix} 0  0  1  0 \\end{pmatrix}^{\\mathsf{T}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ P \\\\ 0 \\end{pmatrix}$$\n\n最后，我们通过将刚度矩阵和荷载向量并列放置，构建所要求的 $4 \\times 5$ 增广矩阵 $[\\mathbf{K}_e | \\mathbf{f}_e]$。\n$$[\\mathbf{K}_e | \\mathbf{f}_e] = \\begin{pmatrix}\n\\frac{12EI}{L^3} & \\frac{6EI}{L^2} & -\\frac{12EI}{L^3} & \\frac{6EI}{L^2} & 0 \\\\\n\\frac{6EI}{L^2} & \\frac{4EI}{L} & -\\frac{6EI}{L^2} & \\frac{2EI}{L} & 0 \\\\\n-\\frac{12EI}{L^3} & -\\frac{6EI}{L^2} & \\frac{12EI}{L^3} & -\\frac{6EI}{L^2} & P \\\\\n\\frac{6EI}{L^2} & \\frac{2EI}{L} & -\\frac{6EI}{L^2} & \\frac{4EI}{L} & 0\n\\end{pmatrix}$$\n这就完成了按要求从第一性原理出发的推导。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{12EI}{L^{3}}  & \\frac{6EI}{L^{2}}  & -\\frac{12EI}{L^{3}}  & \\frac{6EI}{L^{2}}  & 0 \\\\ \\frac{6EI}{L^{2}}  & \\frac{4EI}{L}  & -\\frac{6EI}{L^{2}}  & \\frac{2EI}{L}  & 0 \\\\ -\\frac{12EI}{L^{3}}  & -\\frac{6EI}{L^{2}}  & \\frac{12EI}{L^{3}}  & -\\frac{6EI}{L^{2}}  & P \\\\ \\frac{6EI}{L^{2}}  & \\frac{2EI}{L}  & -\\frac{6EI}{L^{2}}  & \\frac{4EI}{L}  & 0 \\end{pmatrix}}$$", "id": "2617208"}, {"introduction": "在掌握了点荷载的处理方法后，我们进一步探讨更普遍的分布荷载情况。本练习旨在阐明一个核心概念：一致荷载向量的计算仅依赖于外荷载的分布和单元的插值函数，而与单元的材料或截面属性（如抗弯刚度 $EI$）无关。通过一个抗弯刚度沿杆长变化的假想情景，本题将加深你对有限元方法中内外功解耦的理解。[@problem_id:3602701]", "problem": "考虑一个长度为 $L$ 的双节点欧拉-伯努利梁有限元（finite element (FE)），其抗弯刚度 $E I(x)$ 沿空间变化，且在整个单元上承受均布横向荷载 $q(x)=q_0$。设单元的广义位移向量为 $\\mathbf{d} = \\begin{bmatrix} w_1  \\theta_1  w_2  \\theta_2 \\end{bmatrix}^{\\mathsf{T}}$，其中 $w$ 是横向挠度，$\\theta=\\frac{dw}{dx}$ 是转角，单位为弧度。假设小应变和小挠度，并采用欧拉-伯努利运动学假设，即横截面在变形后保持为平面且垂直于变形后的中心线。\n\n从虚功原理和欧拉-伯努利梁的弱形式出发，构建与均布荷载 $q_0$ 对应的等效单元节点荷载向量 $\\mathbf{f}_e$。可以假设横向挠度场采用与所选自由度兼容的三次Hermite插值，但除了弱形式之外，不要假定任何最终的有限元公式。\n\n抗弯刚度呈线性变化，即 $E I(x) = E I_0 \\left(1 + \\alpha \\frac{x}{L}\\right)$，其中 $E I_0>0$，$\\alpha$ 是一个给定的无量纲常数。计算等效节点荷载向量 $\\mathbf{f}_e$ 的仅含 $q_0$ 和 $L$ 的闭式表达式，并简要解释为什么 $\\mathbf{f}_e$ 不依赖于 $E I(x)$，而最终的位移响应却依赖于它。\n\n将 $\\mathbf{f}_e$ 的最终答案表示为一个 $1 \\times 4$ 的行矩阵，仅用 $q_0$ 和 $L$ 表示。假设 $q_0$ 的单位是牛顿/米，$L$ 的单位是米，转角的单位是弧度；最终表达式中不要包含单位。不需要进行数值舍入；报告精确的符号结果。", "solution": "该问题经评估有效，因其自洽、在计算固体力学原理上有科学依据，且提法得当。我们可以继续进行求解。\n\n等效单元节点荷载向量的推导始于应用于欧拉-伯努利梁的虚功原理（PVW）。虚功原理指出，对于任何运动学上容许的虚位移场 $\\delta w(x)$，内虚功 $\\delta W_{\\text{int}}$ 等于外虚功 $\\delta W_{\\text{ext}}$。\n$$ \\delta W_{\\text{int}} = \\delta W_{\\text{ext}} $$\n对于欧拉-伯努利梁，内虚功是弯矩 $M(x)$ 与虚曲率 $\\delta\\kappa(x)$ 的乘积在单元长度 $L$ 上的积分。外虚功是横向均布荷载 $q(x)$ 与虚位移 $\\delta w(x)$ 的乘积的积分。\n$$ \\int_{0}^{L} M(x) \\delta\\kappa(x) dx = \\int_{0}^{L} q(x) \\delta w(x) dx $$\n使用本构关系 $M(x) = EI(x) \\kappa(x)$ 和运动学关系 $\\kappa(x) = \\frac{d^2w}{dx^2}$，虚功原理变为：\n$$ \\int_{0}^{L} EI(x) \\frac{d^2w}{dx^2} \\frac{d^2(\\delta w)}{dx^2} dx = \\int_{0}^{L} q(x) \\delta w(x) dx $$\n在有限元方法中，连续位移场 $w(x)$ 通过使用一组形函数 $\\mathbf{N}(x)$ 对节点自由度 $\\mathbf{d}$ 进行插值来近似。对于一个在 $x=0$ 处有节点位移 $w_1$、$\\theta_1$ 和在 $x=L$ 处有节点位移 $w_2$、$\\theta_2$ 的双节点梁单元，位移场由下式给出：\n$$ w(x) = \\mathbf{N}(x) \\mathbf{d} = N_1(x) w_1 + N_2(x) \\theta_1 + N_3(x) w_2 + N_4(x) \\theta_2 $$\n其中 $\\mathbf{d} = \\begin{bmatrix} w_1  \\theta_1  w_2  \\theta_2 \\end{bmatrix}^{\\mathsf{T}}$ 且 $\\mathbf{N}(x) = \\begin{bmatrix} N_1(x)  N_2(x)  N_3(x)  N_4(x) \\end{bmatrix}$。问题指定了三次Hermite插值函数，它们是：\n$N_1(x) = 1 - 3\\left(\\frac{x}{L}\\right)^2 + 2\\left(\\frac{x}{L}\\right)^3$\n$N_2(x) = x - 2L\\left(\\frac{x}{L}\\right)^2 + L\\left(\\frac{x}{L}\\right)^3 = x\\left(1-\\frac{x}{L}\\right)^2$\n$N_3(x) = 3\\left(\\frac{x}{L}\\right)^2 - 2\\left(\\frac{x}{L}\\right)^3$\n$N_4(x) = -L\\left(\\frac{x}{L}\\right)^2 + L\\left(\\frac{x}{L}\\right)^3 = \\frac{x^2}{L}\\left(\\frac{x}{L}-1\\right)$\n\n虚位移场 $\\delta w(x)$ 使用相同的形函数和虚节点位移 $\\delta\\mathbf{d}$ 进行插值：\n$$ \\delta w(x) = \\mathbf{N}(x) \\delta\\mathbf{d} $$\n等效节点荷载向量 $\\mathbf{f}_e$ 由一个关系式定义，该关系式将均布荷载所做的外虚功与等效节点荷载所做的功相等同：\n$$ \\delta W_{\\text{ext}} = \\int_0^L q(x) \\delta w(x) dx = \\int_0^L q(x) \\mathbf{N}(x) \\delta\\mathbf{d} dx = \\left( \\int_0^L q(x) \\mathbf{N}(x) dx \\right) \\delta\\mathbf{d} $$\n根据定义，$\\delta W_{\\text{ext}}$ 也由 $\\mathbf{f}_e^{\\mathsf{T}} \\delta\\mathbf{d}$ 给出。比较这两个表达式，我们确定等效荷载向量为：\n$$ \\mathbf{f}_e = \\left(\\int_0^L \\mathbf{N}(x)^{\\mathsf{T}} q(x) dx\\right) $$\n已知荷载是均匀的，$q(x)=q_0$，$\\mathbf{f}_e$ 的分量是通过将每个形函数乘以 $q_0$ 并在单元长度 $L$ 上积分来计算的。\n\n$\\mathbf{f}_e = \\begin{bmatrix} f_{e,1}  f_{e,2}  f_{e,3}  f_{e,4} \\end{bmatrix}^{\\mathsf{T}}$ 的分量是：\n$f_{e,1} = \\int_{0}^{L} q_0 N_1(x) dx = q_0 \\int_{0}^{L} \\left(1 - \\frac{3x^2}{L^2} + \\frac{2x^3}{L^3}\\right) dx = q_0 \\left[x - \\frac{x^3}{L^2} + \\frac{x^4}{2L^3}\\right]_0^L = q_0 \\left(L - L + \\frac{L}{2}\\right) = \\frac{q_0 L}{2}$\n\n$f_{e,2} = \\int_{0}^{L} q_0 N_2(x) dx = q_0 \\int_{0}^{L} \\left(x - \\frac{2x^2}{L} + \\frac{x^3}{L^2}\\right) dx = q_0 \\left[\\frac{x^2}{2} - \\frac{2x^3}{3L} + \\frac{x^4}{4L^2}\\right]_0^L = q_0 \\left(\\frac{L^2}{2} - \\frac{2L^2}{3} + \\frac{L^2}{4}\\right) = q_0 L^2 \\left(\\frac{6-8+3}{12}\\right) = \\frac{q_0 L^2}{12}$\n\n$f_{e,3} = \\int_{0}^{L} q_0 N_3(x) dx = q_0 \\int_{0}^{L} \\left(\\frac{3x^2}{L^2} - \\frac{2x^3}{L^3}\\right) dx = q_0 \\left[\\frac{x^3}{L^2} - \\frac{x^4}{2L^3}\\right]_0^L = q_0 \\left(L - \\frac{L}{2}\\right) = \\frac{q_0 L}{2}$\n\n$f_{e,4} = \\int_{0}^{L} q_0 N_4(x) dx = q_0 \\int_{0}^{L} \\left(-\\frac{x^2}{L} + \\frac{x^3}{L^2}\\right) dx = q_0 \\left[-\\frac{x^3}{3L} + \\frac{x^4}{4L^2}\\right]_0^L = q_0 \\left(-\\frac{L^2}{3} + \\frac{L^2}{4}\\right) = q_0 L^2 \\left(\\frac{-4+3}{12}\\right) = -\\frac{q_0 L^2}{12}$\n\n将这些分量组合成一个列向量得到：\n$$ \\mathbf{f}_e = \\begin{Bmatrix} \\frac{q_0 L}{2} \\\\ \\frac{q_0 L^2}{12} \\\\ \\frac{q_0 L}{2} \\\\ -\\frac{q_0 L^2}{12} \\end{Bmatrix} $$\n最终答案要求为 $1 \\times 4$ 的行矩阵，即 $\\mathbf{f}_e$ 的转置。\n\n等效荷载向量 $\\mathbf{f}_e$ 不依赖于抗弯刚度 $EI(x)$ 的原因从其推导过程中显而易见。虚功原理将问题分为内功项和外功项。将有限元近似代入完整的虚功原理可得：\n$$ \\delta\\mathbf{d}^{\\mathsf{T}} \\left( \\int_0^L \\mathbf{B}(x)^{\\mathsf{T}} EI(x) \\mathbf{B}(x) dx \\right) \\mathbf{d} = \\delta\\mathbf{d}^{\\mathsf{T}} \\left( \\int_0^L \\mathbf{N}(x)^{\\mathsf{T}} q(x) dx \\right) $$\n其中 $\\mathbf{B}(x)$ 是形函数二阶导数的矩阵。该方程导出单元体系 $\\mathbf{k}_e \\mathbf{d} = \\mathbf{f}_e$。单元刚度矩阵 $\\mathbf{k}_e = \\int_0^L \\mathbf{B}(x)^{\\mathsf{T}} EI(x) \\mathbf{B}(x) dx$ 代表了单元抵抗变形的能力，并明显依赖于 $EI(x)$。等效荷载向量 $\\mathbf{f}_e = \\left(\\int_0^L \\mathbf{N}(x)^{\\mathsf{T}} q(x) dx\\right)$ 代表与均布荷载 $q(x)$ 对应的功等效节点力。它的定义仅源于外虚功项，该项只涉及施加的荷载 $q(x)$ 和假定的位移场的几何形状（形函数 $\\mathbf{N}(x)$），而不涉及梁的材料或截面属性 ($EI(x)$)。位移响应 $\\mathbf{d} = \\mathbf{k}_e^{-1} \\mathbf{f}_e$ 最终通过刚度矩阵 $\\mathbf{k}_e$ 依赖于 $EI(x)$。提供可变抗弯刚度 $EI(x) = EI_0(1+\\alpha x/L)$ 是为了检验这一特定的理解；它影响刚度的计算，但不影响均布荷载的等效荷载向量。", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{q_0 L}{2}  & \\frac{q_0 L^2}{12}  & \\frac{q_0 L}{2}  & -\\frac{q_0 L^2}{12} \\end{pmatrix}} $$", "id": "3602701"}, {"introduction": "理论推导中的精确积分在真实的有限元软件中往往由数值积分（如高斯求积）所取代，这可能引入近似误差。本练习将带你深入探索这一实际问题，要求你分析当使用低阶数值积分（单点高斯求积）计算二次分布荷载下的一致节点力矩时所产生的误差。通过推导误差的封闭解，你将对数值积分的精度如何影响有限元分析结果有更具体的认识。[@problem_id:3602712]", "problem": "考虑有限元法 (FEM) 中一个长度为 $L$ 的双节点欧拉-伯努利梁单元，其横向位移场 $w(x)$ 由标准三次 Hermite 形函数插值。节点自由度分别为左右节点的横向位移 $w_{1}$ 和 $w_{2}$ 以及转角 $\\theta_{1}$ 和 $\\theta_{2}$。一个形式为 $q(x) = a + b x + c x^{2}$ 的分布横向荷载作用在单元上。从虚功原理和欧拉-伯努利运动学假设出发，推导左侧节点的精确一致节点弯矩（与 $\\theta_{1}$ 共轭的广义力），然后使用单元上的一点高斯-勒让德求积（高斯求积 (GQ)）对其进行近似。利用这些结果，得到由于欠积分引起的左侧节点弯矩误差 $\\Delta M_{1}$ 的闭合形式表达式，该误差定义为一点求积结果与精确一致值之间的差值。以牛顿·米 (N·m) 为单位表示最终误差 $\\Delta M_{1}$。不代入任何数值；最终答案必须是关于 $a$、$b$、$c$ 和 $L$ 的单一解析表达式。此外，基于多项式精确性，简要解释欠积分如何影响二次荷载下等效节点弯矩的精度。不要使用任何预先给定的单元荷载向量公式；从第一性原理出发，推导所有必要的关系式。无需四舍五入。", "solution": "基本依据是欧拉-伯努利梁的虚功原理。对于作用在梁上的分布横向荷载 $q(x)$，其外虚功为\n$$\n\\delta W_{\\text{ext}} = \\int_{0}^{L} \\delta w(x)\\, q(x)\\, dx,\n$$\n其中 $\\delta w(x)$ 是与单元运动学一致的虚横向位移。在欧拉-伯努利梁中，双节点单元内的横向位移 $w(x)$ 由三次 Hermite 形函数插值，使得单元场可以用节点自由度表示。引入无量纲坐标 $s = x/L$，其中 $s \\in [0,1]$，并写出插值式\n$$\nw(x) = w(s L) = h_{1}(s)\\, w_{1} + h_{2}(s)\\, L\\, \\theta_{1} + h_{3}(s)\\, w_{2} + h_{4}(s)\\, L\\, \\theta_{2},\n$$\n其中无量纲 Hermite 多项式 $h_{i}(s)$ 由 $w$ 和 $dw/dx$ 的节点插值条件确定。通过强制施加条件 $h_{1}(0)=1$, $h_{1}(1)=0$, $h_{1}'(0)=0$, $h_{1}'(1)=0$; $h_{2}(0)=0$, $h_{2}(1)=0$, $h_{2}'(0)=1$, $h_{2}'(1)=0$; $h_{3}(0)=0$, $h_{3}(1)=1$, $h_{3}'(0)=0$, $h_{3}'(1)=0$; 以及 $h_{4}(0)=0$, $h_{4}(1)=0$, $h_{4}'(0)=0$, $h_{4}'(1)=1$，可以得到在 $[0,1]$ 上众所周知的三次 Hermite 多项式，\n$$\nh_{1}(s) = 1 - 3 s^{2} + 2 s^{3}, \\quad h_{2}(s) = s - 2 s^{2} + s^{3}, \\quad h_{3}(s) = 3 s^{2} - 2 s^{3}, \\quad h_{4}(s) = - s^{2} + s^{3}.\n$$\n虚位移具有与节点自由度变分相同的形式：\n$$\n\\delta w(x) = h_{1}(s)\\, \\delta w_{1} + h_{2}(s)\\, L\\, \\delta \\theta_{1} + h_{3}(s)\\, \\delta w_{2} + h_{4}(s)\\, L\\, \\delta \\theta_{2}.\n$$\n代入虚功表达式并收集虚节点量的系数，得到一致单元荷载向量。与 $\\delta \\theta_{1}$ 共轭的广义力是左侧节点弯矩\n$$\nM_{1,\\text{exact}} = \\int_{0}^{L} \\big(L\\, h_{2}(x/L)\\big)\\, q(x)\\, dx.\n$$\n换元 $x = s L$ 和 $dx = L\\, ds$ 可得\n$$\nM_{1,\\text{exact}} = L^{2} \\int_{0}^{1} h_{2}(s)\\, q(s L)\\, ds.\n$$\n对于 $q(x) = a + b x + c x^{2}$，我们有 $q(s L) = a + b L\\, s + c L^{2}\\, s^{2}$。使用 $h_{2}(s) = s - 2 s^{2} + s^{3}$，被积函数是一个多项式：\n$$\nh_{2}(s)\\, q(s L) = (s - 2 s^{2} + s^{3})\\,(a + b L\\, s + c L^{2}\\, s^{2}).\n$$\n展开并合并同类项：\n$$\n= a s - 2 a s^{2} + a s^{3} \\;+\\; b L\\, s^{2} - 2 b L\\, s^{3} + b L\\, s^{4} \\;+\\; c L^{2}\\, s^{3} - 2 c L^{2}\\, s^{4} + c L^{2}\\, s^{5}.\n$$\n按 $s$ 的幂次分组，\n$$\n= a\\, s + (b L - 2 a)\\, s^{2} + (a - 2 b L + c L^{2})\\, s^{3} + (b L - 2 c L^{2})\\, s^{4} + (c L^{2})\\, s^{5}.\n$$\n在 $s \\in [0,1]$ 上使用 $\\int_{0}^{1} s^{n} ds = \\frac{1}{n+1}$逐项积分：\n$$\nM_{1,\\text{exact}} = L^{2} \\left[ a \\cdot \\frac{1}{2} + (b L - 2 a) \\cdot \\frac{1}{3} + (a - 2 b L + c L^{2}) \\cdot \\frac{1}{4} + (b L - 2 c L^{2}) \\cdot \\frac{1}{5} + (c L^{2}) \\cdot \\frac{1}{6} \\right].\n$$\n通过对 $a$、$b L$ 和 $c L^{2}$ 的系数进行分组来简化。对于 $a$：$\\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4} = \\frac{6 - 8 + 3}{12} = \\frac{1}{12}$。对于 $b L$：$\\frac{1}{3} - \\frac{1}{2} + \\frac{1}{5} = \\frac{10 - 15 + 6}{30} = \\frac{1}{30}$。对于 $c L^{2}$：$\\frac{1}{4} - \\frac{2}{5} + \\frac{1}{6} = \\frac{15 - 24 + 10}{60} = \\frac{1}{60}$。因此，\n$$\nM_{1,\\text{exact}} = \\frac{L^{2} a}{12} + \\frac{L^{3} b}{30} + \\frac{L^{4} c}{60}.\n$$\n现在使用在 $s \\in [0,1]$ 上的一点高斯-勒让德求积来近似 $M_{1}$，该方法对于次数最高为 1 的多项式能精确积分，并使用中点 $s = \\frac{1}{2}$ 和权重 $1$。近似值为\n$$\nM_{1,\\text{1pt}} = L^{2} \\left[ h_{2}\\!\\left(\\frac{1}{2}\\right) \\, q\\!\\left( \\frac{L}{2} \\right) \\right].\n$$\n计算 $h_{2}(1/2) = \\frac{1}{2} - 2 \\cdot \\frac{1}{4} + \\frac{1}{8} = \\frac{1}{8}$。同时，\n$$\nq\\!\\left( \\frac{L}{2} \\right) = a + b \\cdot \\frac{L}{2} + c \\cdot \\frac{L^{2}}{4}.\n$$\n因此，\n$$\nM_{1,\\text{1pt}} = L^{2} \\left[ \\frac{1}{8} \\left( a + \\frac{b L}{2} + \\frac{c L^{2}}{4} \\right) \\right] = \\frac{L^{2} a}{8} + \\frac{L^{3} b}{16} + \\frac{L^{4} c}{32}.\n$$\n将左侧节点弯矩的欠积分误差定义为\n$$\n\\Delta M_{1} = M_{1,\\text{1pt}} - M_{1,\\text{exact}}.\n$$\n代入推导出的表达式：\n$$\n\\Delta M_{1} = \\left( \\frac{L^{2} a}{8} - \\frac{L^{2} a}{12} \\right) + \\left( \\frac{L^{3} b}{16} - \\frac{L^{3} b}{30} \\right) + \\left( \\frac{L^{4} c}{32} - \\frac{L^{4} c}{60} \\right).\n$$\n简化每个括号：\n$$\n\\frac{1}{8} - \\frac{1}{12} = \\frac{3 - 2}{24} = \\frac{1}{24}, \\quad \\frac{1}{16} - \\frac{1}{30} = \\frac{15 - 8}{240} = \\frac{7}{240}, \\quad \\frac{1}{32} - \\frac{1}{60} = \\frac{15 - 8}{480} = \\frac{7}{480}.\n$$\n因此，\n$$\n\\Delta M_{1} = \\frac{L^{2} a}{24} + \\frac{7 L^{3} b}{240} + \\frac{7 L^{4} c}{480}.\n$$\n这就是对于二次荷载，由一点欠积分引起的左侧等效节点弯矩误差的闭合形式解析表达式。\n\n关于欠积分效应的讨论：精确的一致节点弯矩涉及形式为 $\\int_{0}^{1} h_{i}(s)\\, q(s L)\\, ds$ 的积分，其中 $h_{i}(s)$ 是三次多项式，而 $q(s L)$ 是关于 $s$ 的二次多项式。因此，被积函数是一个最高次数为 5 的多项式。具有 $n$ 个点的高斯-勒让德求积对于最高次数为 $2 n - 1$ 的多项式是精确的。因此，一个 3 点高斯法则 ($2 n - 1 = 5$) 可以精确地对这些项进行积分，从而得到精确的一致节点弯矩。相比之下，一点法则 ($2 n - 1 = 1$) 仅对最高次数为 1 的多项式是精确的；将其应用于次数为 3 到 5 的被积函数，会在等效节点弯矩中引入系统误差，如上文 $\\Delta M_{1}$ 所量化的那样。值得注意的是，即使对于常数荷载（$b = 0$，$c = 0$），误差 $\\Delta M_{1} = \\frac{L^{2} a}{24}$ 也不为零，因为被积函数 $h_{2}(s)\\, a$ 仍然是三次的。因此，欠积分损害了能量一致性以及从分布荷载到节点广义力的弯矩传递精度，误差的大小随 $L$ 和高阶系数 $b$ 和 $c$ 的增加而增加。推导出的表达式为二次荷载下左侧节点弯矩的这种效应提供了一个精确的度量。要求 $\\Delta M_{1}$ 的单位是牛顿·米 (N·m)。", "answer": "$$\\boxed{\\frac{L^{2} a}{24} + \\frac{7 L^{3} b}{240} + \\frac{7 L^{4} c}{480}}$$", "id": "3602712"}]}