{"hands_on_practices": [{"introduction": "本练习是掌握瑞利阻尼模型的起点。它引导我们通过经典方法，即在两个关键频率上匹配期望的阻尼比，来计算瑞利阻尼系数 $\\alpha$ 和 $\\beta$。通过推导和求解一个 $2 \\times 2$ 线性方程组，这项实践不仅巩固了核心的代数关系，还引入了数值条件数的概念，揭示了当选择的两个频率非常接近时可能出现的数值不稳定性问题[@problem_id:3515251]。", "problem": "一个层状土矿床的岩土力学有限元模型将在时域内进行地震激励下的模拟。其线性化的半离散平衡由二阶常微分运动方程 $ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{p}(t) $ 给出，其中 $ \\mathbf{M} $ 是质量矩阵，$ \\mathbf{K} $ 是刚度矩阵，$ \\mathbf{C} $ 是阻尼矩阵。采用瑞利阻尼模型，其中 $ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $，标量系数 $ \\alpha $ 和 $ \\beta $ 待标定。\n\n在与矿床的两个主剪切模态相关的圆角频率 $ \\omega_1 $ 和 $ \\omega_2 $ 处，指定了两个目标模态阻尼比 $ \\xi_1 $ 和 $ \\xi_2 $。从二阶线性单自由度模态方程出发，并利用线性振子的模态阻尼比定义，推导每个模态 $ i $ 的 $ \\xi_i $ 与 $ \\alpha, \\beta, \\omega_i $ 之间的关系。然后，建立关于 $ \\alpha $ 和 $ \\beta $ 的 $2\\times 2$ 线性系统，明确写为\n$$\n\\begin{bmatrix}\n\\frac{1}{2 \\omega_1}  \\frac{\\omega_1}{2} \\\\\n\\frac{1}{2 \\omega_2}  \\frac{\\omega_2}{2}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\alpha \\\\ \\beta\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\xi_1 \\\\ \\xi_2\n\\end{bmatrix},\n$$\n并以 $ \\xi_1, \\xi_2, \\omega_1, \\omega_2 $ 的形式求解其闭式解 $ \\alpha $ 和 $ \\beta $。\n\n最后，当频率比 $ r = \\omega_2 / \\omega_1 \\to 1 $ 时，分析上述系数矩阵相对于矩阵 $2$-范数的条件数，并描述当 $ r \\to 1 $ 时条件数的渐近行为。\n\n以符号闭式形式表示最终答案对 $ (\\alpha, \\beta) $。不需要进行数值计算。", "solution": "问题陈述验证如下。\n\n**步骤1：提取已知条件**\n- 岩土力学系统的线性化半离散运动方程为 $ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{p}(t) $。\n- $ \\mathbf{M} $ 是质量矩阵，$ \\mathbf{K} $ 是刚度矩阵，$ \\mathbf{C} $ 是阻尼矩阵。\n- 使用瑞利阻尼模型，定义为 $ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $，其中 $ \\alpha $ 和 $ \\beta $ 是标量系数。\n- 在两个不同的圆角频率 $ \\omega_1 $ 和 $ \\omega_2 $ 处分别指定了两个目标模态阻尼比 $ \\xi_1 $ 和 $ \\xi_2 $。\n- 任务是：\n    1. 推导模态阻尼比 $ \\xi_i $ 与系数 $ \\alpha $、$ \\beta $ 和模态频率 $ \\omega_i $ 之间的关系。\n    2. 求解所给定的 $ 2 \\times 2 $ 线性系统，得到用 $ \\xi_1, \\xi_2, \\omega_1, \\omega_2 $ 表示的 $ \\alpha $ 和 $ \\beta $。\n    3. 分析当频率比 $ r = \\omega_2 / \\omega_1 \\to 1 $ 时系统系数矩阵的条件数。\n    4. 提供 $ \\alpha $ 和 $ \\beta $ 的最终闭式表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于线性结构动力学的基本理论，这是工程学和物理学的核心课题。运动方程、模态分析和瑞利阻尼模型都是标准的、完善的概念。该问题在科学上和事实上都是合理的。\n- **适定性：** 该问题提供了执行所需推导和分析的所有必要信息和定义。只要 $ \\omega_1 \\neq \\omega_2 $（问题陈述中提到两个不同模态，隐含了此条件），$ \\alpha $ 和 $ \\beta $ 的解就是唯一的。所需的条件数分析是一个标准的数学过程。\n- **客观性：** 该问题使用精确、无歧义的数学和技术语言陈述，不含任何主观性或意见。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它具有科学依据、适定性、客观性和完整性。我现在将着手解决。\n\n根据要求，解答分为三部分：模态阻尼关系的推导、线性系统的求解以及条件数分析。\n\n**1. 模态阻尼比关系的推导**\n\n多自由度 (MDOF) 线性系统的运动方程为\n$$ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{p}(t) $$\n利用变换 $ \\mathbf{u}(t) = \\mathbf{\\Phi} \\mathbf{q}(t) $，解可以用系统的模态振型（特征向量）$ \\mathbf{\\Phi} $ 和模态坐标 $ \\mathbf{q}(t) $ 来表示。将此代入运动方程并左乘 $ \\mathbf{\\Phi}^T $ 得到\n$$ \\mathbf{\\Phi}^T \\mathbf{M} \\mathbf{\\Phi} \\ddot{\\mathbf{q}}(t) + \\mathbf{\\Phi}^T \\mathbf{C} \\mathbf{\\Phi} \\dot{\\mathbf{q}}(t) + \\mathbf{\\Phi}^T \\mathbf{K} \\mathbf{\\Phi} \\mathbf{q}(t) = \\mathbf{\\Phi}^T \\mathbf{p}(t) $$\n由于特征向量相对于质量矩阵和刚度矩阵的正交性，模态质量矩阵 $ \\mathbf{M}^* = \\mathbf{\\Phi}^T \\mathbf{M} \\mathbf{\\Phi} $ 和模态刚度矩阵 $ \\mathbf{K}^* = \\mathbf{\\Phi}^T \\mathbf{K} \\mathbf{\\Phi} $ 是对角的。第 $ i $ 个对角线元素是模态质量 $ m_i^* $ 和模态刚度 $ k_i^* $。\n\n对于瑞利阻尼模型 $ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $，模态阻尼矩阵为\n$$ \\mathbf{C}^* = \\mathbf{\\Phi}^T \\mathbf{C} \\mathbf{\\Phi} = \\mathbf{\\Phi}^T (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\mathbf{\\Phi} = \\alpha (\\mathbf{\\Phi}^T \\mathbf{M} \\mathbf{\\Phi}) + \\beta (\\mathbf{\\Phi}^T \\mathbf{K} \\mathbf{\\Phi}) = \\alpha \\mathbf{M}^* + \\beta \\mathbf{K}^* $$\n由于 $ \\mathbf{M}^* $ 和 $ \\mathbf{K}^* $ 是对角的，所以 $ \\mathbf{C}^* $ 也是对角的。这意味着方程组是解耦的。第 $ i $ 个模态的方程是一个单自由度 (SDOF) 方程：\n$$ m_i^* \\ddot{q}_i(t) + c_i^* \\dot{q}_i(t) + k_i^* q_i(t) = p_i^*(t) $$\n其中 $ q_i $ 是第 $ i $ 个模态坐标，$ p_i^* $ 是第 $ i $ 个模态力，$ c_i^* $ 是第 $ i $ 个模态阻尼系数，由 $ c_i^* = \\alpha m_i^* + \\beta k_i^* $ 给出。\n\n两边除以 $ m_i^* $ 得\n$$ \\ddot{q}_i(t) + \\frac{c_i^*}{m_i^*} \\dot{q}_i(t) + \\frac{k_i^*}{m_i^*} q_i(t) = \\frac{p_i^*(t)}{m_i^*} $$\n单自由度振子方程的标准形式是 $ \\ddot{x} + 2\\xi\\omega \\dot{x} + \\omega^2 x = f(t) $。通过比较，我们确定模态 $ i $ 的固有圆频率 $ \\omega_i $ 和模态阻尼比 $ \\xi_i $：\n$$ \\omega_i^2 = \\frac{k_i^*}{m_i^*} \\quad \\text{和} \\quad 2\\xi_i\\omega_i = \\frac{c_i^*}{m_i^*} $$\n代入 $ c_i^* $ 的表达式：\n$$ 2\\xi_i\\omega_i = \\frac{\\alpha m_i^* + \\beta k_i^*}{m_i^*} = \\alpha + \\beta \\left(\\frac{k_i^*}{m_i^*}\\right) = \\alpha + \\beta \\omega_i^2 $$\n最后，求解模态阻尼比 $ \\xi_i $ 得到所需的关系：\n$$ \\xi_i = \\frac{1}{2\\omega_i} (\\alpha + \\beta \\omega_i^2) = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2} $$\n\n**2. 求解关于 $ \\alpha $ 和 $ \\beta $ 的线性系统**\n\n利用上述为两个目标模态（$ i=1, 2 $）推导出的关系，我们得到一个关于两个未知数 $ \\alpha $ 和 $ \\beta $ 的两个线性方程组成的方程组：\n$$ \\xi_1 = \\frac{\\alpha}{2\\omega_1} + \\frac{\\beta\\omega_1}{2} $$\n$$ \\xi_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2} $$\n该系统可以写成问题中指定的矩阵形式：\n$$\n\\begin{bmatrix}\n\\frac{1}{2 \\omega_1}  \\frac{\\omega_1}{2} \\\\\n\\frac{1}{2 \\omega_2}  \\frac{\\omega_2}{2}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\alpha \\\\ \\beta\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\xi_1 \\\\ \\xi_2\n\\end{bmatrix}\n$$\n设系数矩阵为 $ \\mathbf{A} $。为了求解 $ \\begin{pmatrix} \\alpha  \\beta \\end{pmatrix}^T $，我们必须求 $ \\mathbf{A} $ 的逆。$ \\mathbf{A} $ 的行列式是\n$$ \\det(\\mathbf{A}) = \\left(\\frac{1}{2\\omega_1}\\right) \\left(\\frac{\\omega_2}{2}\\right) - \\left(\\frac{\\omega_1}{2}\\right) \\left(\\frac{1}{2\\omega_2}\\right) = \\frac{\\omega_2}{4\\omega_1} - \\frac{\\omega_1}{4\\omega_2} = \\frac{\\omega_2^2 - \\omega_1^2}{4\\omega_1\\omega_2} $$\n逆矩阵 $ \\mathbf{A}^{-1} $ 是\n$$ \\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\begin{bmatrix} \\frac{\\omega_2}{2}  -\\frac{\\omega_1}{2} \\\\ -\\frac{1}{2\\omega_2}  \\frac{1}{2\\omega_1} \\end{bmatrix} = \\frac{4\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\begin{bmatrix} \\frac{\\omega_2}{2}  -\\frac{\\omega_1}{2} \\\\ -\\frac{1}{2\\omega_2}  \\frac{1}{2\\omega_1} \\end{bmatrix} = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\begin{bmatrix} \\omega_2  -\\omega_1 \\\\ -1/\\omega_2  1/\\omega_1 \\end{bmatrix} $$\n通过用 $ \\mathbf{A}^{-1} $ 左乘阻尼比向量来获得解：\n$$ \\begin{bmatrix} \\alpha \\\\ \\beta \\end{bmatrix} = \\mathbf{A}^{-1} \\begin{bmatrix} \\xi_1 \\\\ \\xi_2 \\end{bmatrix} = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\begin{bmatrix} \\omega_2  -\\omega_1 \\\\ -1/\\omega_2  1/\\omega_1 \\end{bmatrix} \\begin{bmatrix} \\xi_1 \\\\ \\xi_2 \\end{bmatrix} $$\n进行矩阵-向量乘法，得到 $ \\alpha $ 和 $ \\beta $ 的闭式解：\n$$ \\alpha = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} (\\xi_1 \\omega_2 - \\xi_2 \\omega_1) $$\n$$ \\beta = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\left(-\\frac{\\xi_1}{\\omega_2} + \\frac{\\xi_2}{\\omega_1}\\right) = \\frac{2\\omega_1\\omega_2}{\\omega_2^2 - \\omega_1^2} \\left(\\frac{-\\xi_1\\omega_1 + \\xi_2\\omega_2}{\\omega_1\\omega_2}\\right) = \\frac{2(\\xi_2 \\omega_2 - \\xi_1 \\omega_1)}{\\omega_2^2 - \\omega_1^2} $$\n\n**3. 条件数分析**\n\n我们分析在频率比 $ r = \\omega_2 / \\omega_1 \\to 1 $ 的极限情况下，条件数 $ \\kappa_2(\\mathbf{A}) = ||\\mathbf{A}||_2 ||\\mathbf{A}^{-1}||_2 $。我们设 $ \\omega_2 = r \\omega_1 $ 并考察当 $ r \\to 1^+ $ 时的行为。\n\n首先，考虑矩阵 $ \\mathbf{A} $：\n$$ \\mathbf{A} = \\frac{1}{2} \\begin{bmatrix} \\omega_1^{-1}  \\omega_1 \\\\ (r\\omega_1)^{-1}  r\\omega_1 \\end{bmatrix} $$\n当 $ r \\to 1 $ 时，$ \\mathbf{A} $ 趋近于一个秩为1的矩阵 $ \\mathbf{A}_1 = \\frac{1}{2} \\begin{bmatrix} \\omega_1^{-1}  \\omega_1 \\\\ \\omega_1^{-1}  \\omega_1 \\end{bmatrix} $。$ 2 $-范数 $ ||\\mathbf{A}||_2 $ 是连续的，所以 $ ||\\mathbf{A}||_2 \\to ||\\mathbf{A}_1||_2 $。$ \\mathbf{A}_1 $ 的范数是其最大奇异值，它是有限且非零的（假设 $ \\omega_1 \\neq 0 $）。\n$ ||\\mathbf{A}_1||_2 = \\sigma_{max}(\\mathbf{A}_1) = \\sqrt{\\lambda_{max}(\\mathbf{A}_1^T \\mathbf{A}_1)} = \\sqrt{\\frac{1}{2}(\\omega_1^2 + \\omega_1^{-2})} $。因此，当 $ r \\to 1 $ 时，$ ||\\mathbf{A}||_2 $ 趋近于一个有限常数。\n\n接下来，考虑逆矩阵 $ \\mathbf{A}^{-1} $：\n$$ \\mathbf{A}^{-1} = \\frac{2\\omega_1 (r\\omega_1)}{(r\\omega_1)^2 - \\omega_1^2} \\begin{bmatrix} r\\omega_1  -\\omega_1 \\\\ -(r\\omega_1)^{-1}  \\omega_1^{-1} \\end{bmatrix} = \\frac{2r}{r^2 - 1} \\begin{bmatrix} r\\omega_1  -\\omega_1 \\\\ -(r\\omega_1)^{-1}  \\omega_1^{-1} \\end{bmatrix} $$\n当 $ r \\to 1 $ 时，项 $ r^2 - 1 = (r-1)(r+1) \\approx 2(r-1) $。前置因子表现为 $ \\frac{2(1)}{2(r-1)} = \\frac{1}{r-1} $。矩阵部分趋近于 $ \\begin{bmatrix} \\omega_1  -\\omega_1 \\\\ -\\omega_1^{-1}  \\omega_1^{-1} \\end{bmatrix} $。\n因此，$ ||\\mathbf{A}^{-1}||_2 $ 渐近增长为 $ O((r-1)^{-1}) $。这表明当两个频率越来越接近时，系统变得病态。病态的出现是因为矩阵 $ \\mathbf{A} $ 的两行变得几乎相同，使其在数值上接近奇异。\n\n条件数的渐近行为是\n$$ \\kappa_2(\\mathbf{A}) = ||\\mathbf{A}||_2 ||\\mathbf{A}^{-1}||_2 \\sim \\frac{C}{r-1} \\quad \\text{当 } r \\to 1 $$\n其中 $ C $ 是由极限范数决定的常数。\n$ C = ||\\mathbf{A}_1||_2 \\cdot \\lim_{r\\to 1} ||(r-1)\\mathbf{A}^{-1}||_2 = \\left(\\sqrt{\\frac{1}{2}(\\omega_1^2 + \\omega_1^{-2})}\\right) \\cdot \\left(\\sqrt{2(\\omega_1^2+\\omega_1^{-2})}\\right) = \\omega_1^2 + \\omega_1^{-2} $。\n因此，渐近行为的特征是：\n$$ \\kappa_2(\\mathbf{A}) \\sim \\frac{\\omega_1^2 + \\omega_1^{-2}}{r-1} = \\frac{\\omega_1(\\omega_1^2 + \\omega_1^{-2})}{\\omega_2 - \\omega_1} \\quad \\text{当 } \\omega_2 \\to \\omega_1 $$\n条件数随着频率间隔的倒数发散，这表明在标定相近频率的阻尼比时存在严重的数值敏感性。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{2\\omega_1\\omega_2(\\xi_1 \\omega_2 - \\xi_2 \\omega_1)}{\\omega_2^2 - \\omega_1^2}  \\frac{2(\\xi_2 \\omega_2 - \\xi_1 \\omega_1)}{\\omega_2^2 - \\omega_1^2} \\end{pmatrix} } $$", "id": "3515251"}, {"introduction": "在基础模型之上，本练习探讨了许多工程系统（如航空航天结构或无约束的机械部件）中的一个关键问题：刚体运动。通过一个简化的自由-自由杆模型，我们从第一性原理出发，论证了为何仅有刚度比例项 ($\\beta \\mathbf{K}$) 的阻尼无法耗散刚体模态的能量[@problem_id:3593239]。此练习突出了质量比例阻尼项 ($\\alpha \\mathbf{M}$) 在控制刚体漂移中的根本作用，从而加深了对 $\\alpha$ 和 $\\beta$ 各自物理角色的理解。", "problem": "考虑一个线性弹性体，它由一个双自由度（DOF）集总模型离散化，该模型代表具有均匀诺伊曼（无牵引）边界条件的一维自由-自由杆。其质量矩阵和刚度矩阵为\n$$\n\\mathbf{M} = m\n\\begin{bmatrix}\n1  0\\\\\n0  1\n\\end{bmatrix},\n\\qquad\n\\mathbf{K} = k\n\\begin{bmatrix}\n1  -1\\\\\n-1  1\n\\end{bmatrix},\n$$\n给定物理参数 $m=1.0$ 和 $k=20000$，其中 $m$ 的单位是千克，$k$ 的单位是牛顿/米。阻尼为瑞利比例阻尼，定义为\n$$\n\\mathbf{C} = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K},\n$$\n其中 $\\alpha$ 和 $\\beta$ 是实标量。半离散自由振动运动方程为\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}.\n$$\n您需要从第一性原理出发，论述在瑞利比例阻尼下，边界条件如何影响刚体运动的阻尼，并确定一个最小的质量比例阻尼系数，该系数能在不过度阻尼变形动力学的情况下控制这些运动。\n\n任务：\n1) 仅使用上述定义，不借助任何现成的模态阻尼公式，证明当 $\\alpha=0$ 时，刚度比例阻尼项 $\\beta\\,\\mathbf{K}$ 使与均匀诺伊曼边界条件相关的刚体运动不受阻尼。\n\n2) 预先选定刚度比例阻尼参数 $\\beta$，使得当 $\\alpha$ 可忽略不计时，该双自由度系统的唯一变形模态呈现出 $\\xi_{d0}=0.03$ 的模态阻尼比。施加设计要求，即在加入 $\\alpha$ 后，该变形模态的模态阻尼比不得超过 $\\xi_{\\max}=0.05$。此外，为控制刚体漂移，要求刚体运动速度的大小在一个 $T=0.5$ 秒的时间范围内衰减为原来的十分之一。确定满足这两个要求的最小 $\\alpha$ 值。\n\n说明：\n- 从 $\\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{C}\\,\\dot{\\mathbf{u}} + \\mathbf{K}\\,\\mathbf{u}=\\mathbf{0}$ 和给定的 $\\mathbf{C}$ 的瑞利形式出发，推导您使用的所有关系式。\n- 将您最终的 $\\alpha$ 数值四舍五入到四位有效数字。\n- 以 $\\mathrm{s}^{-1}$ 为单位表示最终的 $\\alpha$。", "solution": "对该系统的分析始于一个双自由度（DOF）系统的半离散自由振动运动方程：\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}\n$$\n其中 $\\mathbf{M}$ 是质量矩阵，$\\mathbf{C}$ 是阻尼矩阵，$\\mathbf{K}$ 是刚度矩阵。瑞利比例阻尼模型将阻尼矩阵定义为质量矩阵和刚度矩阵的线性组合：\n$$\n\\mathbf{C} = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K}\n$$\n该系统是一个自由-自由杆的模型，这意味着存在一个刚体模态。这一点反映在刚度矩阵 $\\mathbf{K}$ 的奇异性上。\n\n首先，我们通过求解广义特征值问题 $\\mathbf{K}\\mathbf{\\phi} = \\omega^2\\mathbf{M}\\mathbf{\\phi}$ 来确定无阻尼系统的自然频率和振型。\n$$\n\\det(\\mathbf{K} - \\omega^2\\mathbf{M}) = \\det\\left( k \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} - \\omega^2 m \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} \\right) = 0\n$$\n$$\n\\det\\left( \\begin{bmatrix} k-m\\omega^2  -k \\\\ -k  k-m\\omega^2 \\end{bmatrix} \\right) = (k-m\\omega^2)^2 - k^2 = 0\n$$\n这得出关于 $\\omega^2$ 的两个解：\n1. $k-m\\omega^2 = k \\implies m\\omega^2 = 0 \\implies \\omega_1^2 = 0$。这对应于刚体模态。\n2. $k-m\\omega^2 = -k \\implies m\\omega^2 = 2k \\implies \\omega_2^2 = \\frac{2k}{m}$。这对应于变形模态。\n\n相应的振型（特征向量）$\\mathbf{\\phi}_i$ 通过求解 $(\\mathbf{K} - \\omega_i^2\\mathbf{M})\\mathbf{\\phi}_i = \\mathbf{0}$ 得到。\n对于 $\\omega_1^2 = 0$：\n$$\nk \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} \\mathbf{\\phi}_1 = \\mathbf{0} \\implies \\mathbf{\\phi}_1 = c_1 \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n该振型代表两个质量的均匀平移，即刚体运动。\n对于 $\\omega_2^2 = \\frac{2k}{m}$：\n$$\n\\left( k \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} - \\frac{2k}{m} m \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} \\right) \\mathbf{\\phi}_2 = k \\begin{bmatrix} -1  -1 \\\\ -1  -1 \\end{bmatrix} \\mathbf{\\phi}_2 = \\mathbf{0} \\implies \\mathbf{\\phi}_2 = c_2 \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n$$\n该振型代表两个质量朝相反方向运动，即变形运动。\n\n**1) 刚度比例阻尼分析 ($\\alpha=0$)**\n\n题目要求证明当 $\\alpha=0$ 时，阻尼项 $\\mathbf{C} = \\beta\\mathbf{K}$ 使刚体运动不受阻尼。一个一般运动可以表示为各模态的叠加：$\\mathbf{u}(t) = q_1(t)\\mathbf{\\phi}_1 + q_2(t)\\mathbf{\\phi}_2$。通过只考虑第一模态，可以分离出刚体运动：$\\mathbf{u}_{rb}(t) = q_1(t)\\mathbf{\\phi}_1$。\n将此代入运动方程，其中 $\\mathbf{C} = \\beta\\mathbf{K}$：\n$$\n\\mathbf{M}(\\ddot{q}_1\\mathbf{\\phi}_1) + (\\beta\\mathbf{K})(\\dot{q}_1\\mathbf{\\phi}_1) + \\mathbf{K}(q_1\\mathbf{\\phi}_1) = \\mathbf{0}\n$$\n整理标量模态坐标：\n$$\n(\\mathbf{M}\\mathbf{\\phi}_1)\\ddot{q}_1 + (\\beta\\mathbf{K}\\mathbf{\\phi}_1)\\dot{q}_1 + (\\mathbf{K}\\mathbf{\\phi}_1)q_1 = \\mathbf{0}\n$$\n根据定义，刚体振型 $\\mathbf{\\phi}_1$ 位于刚度矩阵的零空间中，因此 $\\mathbf{K}\\mathbf{\\phi}_1 = \\mathbf{0}$。方程简化为：\n$$\n(\\mathbf{M}\\mathbf{\\phi}_1)\\ddot{q}_1 + \\mathbf{0} + \\mathbf{0} = \\mathbf{0} \\implies \\mathbf{M}\\mathbf{\\phi}_1\\ddot{q}_1 = \\mathbf{0}\n$$\n为得到一个标量方程，我们左乘 $\\mathbf{\\phi}_1^T$：\n$$\n\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1\\ddot{q}_1 = 0\n$$\n模态质量 $\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1$ 是一个正标量，因为 $\\mathbf{M}$ 是正定的，且 $\\mathbf{\\phi}_1$ 是一个非零向量。因此，我们必须有 $\\ddot{q}_1(t) = 0$。\n其解为 $\\dot{q}_1(t) = \\text{常数}$ 且 $q_1(t) = A + Bt$。这代表了恒定的速度和线性增加的位移，这是无阻尼刚体运动的特征。因此，刚度比例阻尼对刚体模态没有控制作用。\n\n**2) 确定最小的 $\\alpha$**\n\n现在我们考虑完整的瑞利阻尼模型 $\\mathbf{C} = \\alpha\\mathbf{M} + \\beta\\mathbf{K}$。我们通过满足所述的设计要求来继续进行。\n\n**确定 $\\beta$**\n\n首先，我们根据变形模态的条件确定 $\\beta$ 的值。将运动投影到模态基上。对于变形模态（$i=2$），通过将运动方程左乘 $\\mathbf{\\phi}_2^T$ 并代入 $\\mathbf{u}=q_2\\mathbf{\\phi}_2$ 来获得解耦的模态方程：\n$$\n\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2 \\ddot{q}_2 + \\mathbf{\\phi}_2^T\\mathbf{C}\\mathbf{\\phi}_2 \\dot{q}_2 + \\mathbf{\\phi}_2^T\\mathbf{K}\\mathbf{\\phi}_2 q_2 = 0\n$$\n使用 $\\mathbf{C} = \\alpha\\mathbf{M} + \\beta\\mathbf{K}$ 和质量归一化特征向量的正交关系（我们可以概念性地调用此关系，而无需进行归一化，只需除以模态质量 $M_2 = \\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2$）：\n$$\n\\ddot{q}_2 + \\frac{\\mathbf{\\phi}_2^T(\\alpha\\mathbf{M} + \\beta\\mathbf{K})\\mathbf{\\phi}_2}{\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2} \\dot{q}_2 + \\frac{\\mathbf{\\phi}_2^T\\mathbf{K}\\mathbf{\\phi}_2}{\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2} q_2 = 0\n$$\n认识到 $\\omega_2^2 = \\frac{\\mathbf{\\phi}_2^T\\mathbf{K}\\mathbf{\\phi}_2}{\\mathbf{\\phi}_2^T\\mathbf{M}\\mathbf{\\phi}_2}$，方程变为：\n$$\n\\ddot{q}_2 + \\left(\\alpha + \\beta\\omega_2^2\\right)\\dot{q}_2 + \\omega_2^2 q_2 = 0\n$$\n这是一个标准形式的二阶常微分方程 $\\ddot{q}_2 + 2\\xi_2\\omega_2\\dot{q}_2 + \\omega_2^2 q_2 = 0$，其中 $\\xi_2$ 是模态阻尼比。通过比较，我们得到 $2\\xi_2\\omega_2 = \\alpha + \\beta\\omega_2^2$，这给出：\n$$\n\\xi_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2}\n$$\n题目指出，当 $\\alpha$ 可忽略不计时，该模态的阻尼比为 $\\xi_{d0}=0.03$。所以，$\\xi_{d0} = \\frac{\\beta\\omega_2}{2}$。\n我们使用给定的参数 $m=1.0$ 和 $k=20000$ 来求 $\\omega_2$：\n$$\n\\omega_2 = \\sqrt{\\frac{2k}{m}} = \\sqrt{\\frac{2(20000)}{1.0}} = \\sqrt{40000} = 200 \\; \\text{rad}\\,\\mathrm{s}^{-1}\n$$\n现在我们可以求解 $\\beta$：\n$$\n\\beta = \\frac{2\\xi_{d0}}{\\omega_2} = \\frac{2(0.03)}{200} = \\frac{0.06}{200} = 0.0003\n$$\n\n**对 $\\alpha$ 应用设计约束**\n\n**约束1：变形模态的最大阻尼。**\n变形模态的阻尼比 $\\xi_2$ 不得超过 $\\xi_{\\max}=0.05$。\n$$\n\\xi_2 = \\frac{\\alpha}{2\\omega_2} + \\frac{\\beta\\omega_2}{2} \\le \\xi_{\\max}\n$$\n代入，项 $\\frac{\\beta\\omega_2}{2}$ 为 $\\xi_{d0}=0.03$：\n$$\n\\frac{\\alpha}{2\\omega_2} + 0.03 \\le 0.05 \\implies \\frac{\\alpha}{2(200)} \\le 0.02\n$$\n$$\n\\frac{\\alpha}{400} \\le 0.02 \\implies \\alpha \\le 400 \\times 0.02 \\implies \\alpha \\le 8.0\n$$\n这给出了 $\\alpha$ 的上界。\n\n**约束2：刚体运动的阻尼。**\n我们使用完整的阻尼矩阵来分析刚体模态（$i=1$）。$q_1(t)$ 的模态方程通过将 $\\mathbf{u}_{rb}(t) = q_1(t)\\mathbf{\\phi}_1$ 代入完整的运动方程并左乘 $\\mathbf{\\phi}_1^T$ 推导得出：\n$$\n\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1 \\ddot{q}_1 + \\mathbf{\\phi}_1^T(\\alpha\\mathbf{M} + \\beta\\mathbf{K})\\mathbf{\\phi}_1 \\dot{q}_1 + \\mathbf{\\phi}_1^T\\mathbf{K}\\mathbf{\\phi}_1 q_1 = 0\n$$\n使用 $\\mathbf{K}\\mathbf{\\phi}_1 = \\mathbf{0}$，方程简化为：\n$$\n(\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1) \\ddot{q}_1 + \\alpha(\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1) \\dot{q}_1 = 0\n$$\n除以非零的模态质量 $\\mathbf{\\phi}_1^T\\mathbf{M}\\mathbf{\\phi}_1$，我们得到：\n$$\n\\ddot{q}_1 + \\alpha \\dot{q}_1 = 0\n$$\n这是一个关于模态速度 $v_1(t) = \\dot{q}_1(t)$ 的一阶方程：$\\dot{v}_1 + \\alpha v_1 = 0$。其解为 $v_1(t) = v_1(0)\\exp(-\\alpha t)$。刚体运动的物理速度为 $\\dot{\\mathbf{u}}_{rb}(t) = \\dot{q}_1(t)\\mathbf{\\phi}_1 = v_1(t)\\mathbf{\\phi}_1$。\n要求是该速度的大小在 $T=0.5$ 秒内衰减为原来的十分之一。为了控制漂移，衰减必须至少达到这个程度。因此：\n$$\n\\frac{||\\dot{\\mathbf{u}}_{rb}(T)||}{||\\dot{\\mathbf{u}}_{rb}(0)||} = \\frac{|v_1(T)|}{|v_1(0)|} = \\exp(-\\alpha T) \\le \\frac{1}{10}\n$$\n对两边取自然对数：\n$$\n-\\alpha T \\le \\ln\\left(\\frac{1}{10}\\right) \\implies -\\alpha T \\le -\\ln(10)\n$$\n两边乘以 $-1$ 使不等号反向：\n$$\n\\alpha T \\ge \\ln(10) \\implies \\alpha \\ge \\frac{\\ln(10)}{T}\n$$\n使用 $T=0.5$：\n$$\n\\alpha \\ge \\frac{\\ln(10)}{0.5} = 2\\ln(10) \\approx 2 \\times 2.302585 = 4.60517\n$$\n这给出了 $\\alpha$ 的下界。\n\n**求最小的 $\\alpha$**\n\n我们必须找到满足这两个约束的最小 $\\alpha$：\n1. $\\alpha \\le 8.0$\n2. $\\alpha \\ge 4.60517...$\n\n有效的 $\\alpha$ 值的集合是区间 $[4.60517..., 8.0]$。此集合中 $\\alpha$ 的最小值为下界。\n$$\n\\alpha_{\\min} = 2\\ln(10) \\approx 4.60517\n$$\n四舍五入到四位有效数字，我们得到 $\\alpha = 4.605$。$\\alpha$ 的单位是 $\\mathrm{s}^{-1}$，因为 $\\alpha t$ 是无量纲的。", "answer": "$$\n\\boxed{4.605}\n$$", "id": "3593239"}, {"introduction": "本练习将我们从理想化的双点拟合带入到更真实的工程任务中，展示了如何利用多组带有不同置信度的实验数据来校准阻尼模型。这项实践引入了一种强大的统计方法——加权最小二乘法，以从实验或数值模态分析结果中找到最佳拟合的 $\\alpha$ 和 $\\beta$ 系数[@problem_id:3515260]。这不仅是模型验证中的常见任务，也构成了科学与工程领域参数辨识和数据拟合的基石。", "problem": "您的任务是使用模态分析的数值数据，为线性弹性粘性阻尼岩土力学系统校准比例阻尼模型。基本模型假设是阻尼矩阵是质量矩阵和刚度矩阵的线性组合。从线性连续体离散化的二阶运动方程出发，推导模态阻尼比对模态圆频率的函数依赖关系，然后为定义比例阻尼模型的系数构建一个加权最小二乘参数估计问题。在系数的非负约束条件下求解该估计问题。\n\n使用以下基础：\n- 应用于离散化连续体的牛顿第二定律：半离散运动方程为 $ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{0} $，其中 $ \\mathbf{M} $ 是质量矩阵，$ \\mathbf{C} $ 是阻尼矩阵，$ \\mathbf{K} $ 是刚度矩阵，$ \\mathbf{u}(t) $ 是位移向量。\n- 比例阻尼假设 (Rayleigh 阻尼)：$ \\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K} $，其中 $ \\alpha $ 和 $ \\beta $ 是待确定的非负标量。\n- 在经典假设下的模态分解会产生沿振动模态的解耦标量方程。\n\n您的程序应：\n1. 基于上述基础，推导模态阻尼比 $ \\xi(\\omega) $ 作为模态圆频率 $ \\omega $ 和比例阻尼系数 $ \\alpha $、$ \\beta $ 的函数表达式。\n2. 构建加权最小二乘问题，通过最小化模型计算的模态阻尼比与实验识别的模态阻尼比之间的加权误差平方和来估计 $ \\alpha $ 和 $ \\beta $。权重应作为正标量 $ w_i $ 乘以每个残差平方项。施加具有物理意义的约束 $ \\alpha \\ge 0 $ 和 $ \\beta \\ge 0 $。\n3. 实现一个数值稳定的算法，为每个测试用例求解带约束的加权最小二乘问题，并报告拟合参数和拟合优度。\n\n单位和数值输出要求：\n- 模态圆频率 $ \\omega_i $ 的单位为弧度/秒 (rad/s)。\n- 阻尼比 $ \\xi_i $ 是无量纲的。\n- 报告的 $ \\alpha $ 单位为 $ \\mathrm{s}^{-1} $，$ \\beta $ 单位为 $ \\mathrm{s} $。\n- 对于每个测试用例，计算阻尼比拟合的加权均方根误差 (RMSE)，定义为 $ \\sqrt{ \\frac{ \\sum_i w_i \\left( \\xi(\\omega_i) - \\xi_i \\right)^2 }{ \\sum_i w_i } } $ (无量纲)。\n- 将所有报告的浮点数输出四舍五入到六位小数。\n\n测试套件：\n为以下四个测试用例提供结果。每个测试用例包含一个模态圆频率列表 $ \\omega_i $ (单位 rad/s)，测量的阻尼比 $ \\xi_i $ (无量纲) 和正权重 $ w_i $：\n\n- 测试用例 1 (一般情况，中等分布，等权重):\n  - $ \\omega = [10, 20, 40, 80] $\n  - $ \\xi = [0.1027, 0.1988, 0.4029, 0.7951] $\n  - $ w = [1, 1, 1, 1] $\n\n- 测试用例 2 (双模态边界情况，不等权重，强调低频模态):\n  - $ \\omega = [15, 60] $\n  - $ \\xi = [0.0408333, 0.1508333] $\n  - $ w = [2.0, 0.5] $\n\n- 测试用例 3 (病态设计：重复的频率值，等权重):\n  - $ \\omega = [50, 50, 50] $\n  - $ \\xi = [0.2480, 0.2510, 0.2495] $\n  - $ w = [1, 1, 1] $\n\n- 测试用例 4 (宽频率范围，权重与频率成正比):\n  - $ \\omega = [0.5, 2, 5, 20, 100, 200] $\n  - $ \\xi = [0.0201, 0.0062, 0.0043, 0.0107, 0.0496, 0.1004] $\n  - $ w = [0.5, 2, 5, 20, 100, 200] $\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由方括号括起来的、逗号分隔的列表，其中有四个条目（每个测试用例一个）。每个条目本身必须是一个包含三个浮点数的列表 $ [\\alpha, \\beta, \\mathrm{RMSE}] $，对应于相应的测试用例，并四舍五入到六位小数。例如：\"[[a1,b1,e1],[a2,b2,e2],[a3,b3,e3],[a4,b4,e4]]\"。不应打印任何其他文本。", "solution": "任务是通过将模型与实验测量的模态阻尼数据进行拟合，来确定 Rayleigh 比例阻尼模型 $\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}$ 的最优非负系数 $\\alpha$ 和 $\\beta$。这将通过推导模态阻尼比与模态频率之间的关系、构建一个带约束的加权最小二乘问题以及实现一个数值解法来完成。\n\n出发点是线性粘性阻尼系统的半离散运动方程：\n$$\n\\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{C} \\dot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{0}\n$$\n此处，$\\mathbf{M}$ 是质量矩阵，$\\mathbf{K}$ 是刚度矩阵，$\\mathbf{C}$ 是阻尼矩阵，$\\mathbf{u}(t)$ 是节点位移向量。\n\n首先，我们通过求解广义特征值问题来确定无阻尼系统 ($\\mathbf{C} = \\mathbf{0}$) 的特性：\n$$\n\\mathbf{K} \\mathbf{\\phi}_i = \\omega_i^2 \\mathbf{M} \\mathbf{\\phi}_i\n$$\n这会得到自有圆频率 $\\omega_i$ 和相应的振型（特征向量）$\\mathbf{\\phi}_i$。振型具有相对于质量矩阵和刚度矩阵的正交性这一关键性质。假设特征向量是经 M 归一化的，我们有：\n$$\n\\mathbf{\\phi}_j^T \\mathbf{M} \\mathbf{\\phi}_i = \\delta_{ij} \\quad (\\text{M-正交归一性})\n$$\n$$\n\\mathbf{\\phi}_j^T \\mathbf{K} \\mathbf{\\phi}_i = \\omega_i^2 \\delta_{ij} \\quad (\\text{K-正交性})\n$$\n其中 $\\delta_{ij}$ 是克罗内克 δ (Kronecker delta)。\n\n接下来，我们使用模态坐标分析阻尼系统。位移向量 $\\mathbf{u}(t)$ 表示为振型的线性组合：\n$$\n\\mathbf{u}(t) = \\sum_{i=1}^{N} q_i(t) \\mathbf{\\phi}_i\n$$\n其中 $q_i(t)$ 是模态（或广义）坐标。将此模态展开式代入运动方程，并左乘任意振型 $\\mathbf{\\phi}_j^T$ 可得：\n$$\n\\mathbf{\\phi}_j^T \\mathbf{M} \\sum_{i} \\ddot{q}_i \\mathbf{\\phi}_i + \\mathbf{\\phi}_j^T \\mathbf{C} \\sum_{i} \\dot{q}_i \\mathbf{\\phi}_i + \\mathbf{\\phi}_j^T \\mathbf{K} \\sum_{i} q_i \\mathbf{\\phi}_i = 0\n$$\n利用正交性，上式可简化为：\n$$\n\\ddot{q}_j(t) + \\sum_{i} (\\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_i) \\dot{q}_i(t) + \\omega_j^2 q_j(t) = 0\n$$\n当且仅当模态阻尼矩阵 $\\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_i$ 是对角阵时，该方程组解耦为一组独立的标量微分方程。比例阻尼模型满足此条件。对于 Rayleigh 阻尼，$\\mathbf{C} = \\alpha \\mathbf{M} + \\beta \\mathbf{K}$，非对角项为：\n$$\n\\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_i = \\mathbf{\\phi}_j^T (\\alpha \\mathbf{M} + \\beta \\mathbf{K}) \\mathbf{\\phi}_i = \\alpha (\\mathbf{\\phi}_j^T \\mathbf{M} \\mathbf{\\phi}_i) + \\beta (\\mathbf{\\phi}_j^T \\mathbf{K} \\mathbf{\\phi}_i) = \\alpha(0) + \\beta(0) = 0 \\quad \\text{for } i \\neq j\n$$\n定义了模态阻尼的对角项为：\n$$\nc_j = \\mathbf{\\phi}_j^T \\mathbf{C} \\mathbf{\\phi}_j = \\alpha (\\mathbf{\\phi}_j^T \\mathbf{M} \\mathbf{\\phi}_j) + \\beta (\\mathbf{\\phi}_j^T \\mathbf{K} \\mathbf{\\phi}_j) = \\alpha(1) + \\beta(\\omega_j^2) = \\alpha + \\beta \\omega_j^2\n$$\n因此，对于每个模态 $j$，我们得到一个解耦的单自由度振子方程：\n$$\n\\ddot{q}_j(t) + (\\alpha + \\beta \\omega_j^2) \\dot{q}_j(t) + \\omega_j^2 q_j(t) = 0\n$$\n此类振子的标准形式为 $\\ddot{q} + 2\\xi\\omega_n\\dot{q} + \\omega_n^2 q = 0$，其中 $\\xi$ 是阻尼比，$\\omega_n$ 是自有频率。通过比较各项，我们确定 $\\omega_n = \\omega_j$ 和 $2\\xi_j\\omega_j = \\alpha + \\beta \\omega_j^2$。求解模态阻尼比 $\\xi_j$ 即可得到所需的函数关系：\n$$\n\\xi_j = \\xi(\\omega_j) = \\frac{\\alpha + \\beta \\omega_j^2}{2\\omega_j} = \\frac{\\alpha}{2\\omega_j} + \\frac{\\beta\\omega_j}{2}\n$$\n该方程构成了我们参数估计的基础。给定一组 $n$ 个实验数据点 $(\\omega_i, \\xi_i, w_i)$，其中 $\\omega_i$ 是测量的模态频率，$\\xi_i$ 是测量的模态阻尼比，$w_i  0$ 是反映每次测量置信度的权重。\n\n目标是找到非负参数 $\\alpha$ 和 $\\beta$，以最小化模型预测值与实验数据之间的加权残差平方和。目标函数 $S(\\alpha, \\beta)$ 为：\n$$\nS(\\alpha, \\beta) = \\sum_{i=1}^{n} w_i \\left( \\xi(\\omega_i) - \\xi_i \\right)^2 = \\sum_{i=1}^{n} w_i \\left( \\left(\\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2}\\right) - \\xi_i \\right)^2\n$$\n我们需要求解以下带约束的优化问题：\n$$\n\\min_{\\alpha, \\beta} S(\\alpha, \\beta) \\quad \\text{subject to} \\quad \\alpha \\ge 0, \\beta \\ge 0\n$$\n这是一个加权线性最小二乘问题。我们将其表示为矩阵形式。定义设计矩阵 $\\mathbf{A}$、参数向量 $\\mathbf{x}$ 和观测向量 $\\mathbf{b}$：\n$$\n\\mathbf{A} = \\begin{bmatrix}\n\\frac{1}{2\\omega_1}  \\frac{\\omega_1}{2} \\\\\n\\frac{1}{2\\omega_2}  \\frac{\\omega_2}{2} \\\\\n\\vdots  \\vdots \\\\\n\\frac{1}{2\\omega_n}  \\frac{\\omega_n}{2}\n\\end{bmatrix}, \\quad\n\\mathbf{x} = \\begin{bmatrix} \\alpha \\\\ \\beta \\end{bmatrix}, \\quad\n\\mathbf{b} = \\begin{bmatrix} \\xi_1 \\\\ \\xi_2 \\\\ \\vdots \\\\ \\xi_n \\end{bmatrix}\n$$\n问题是最小化 $\\|\\mathbf{W}^{1/2}(\\mathbf{Ax} - \\mathbf{b})\\|_2^2$，其中 $\\mathbf{W} = \\text{diag}(w_1, \\dots, w_n)$ 是对角权重矩阵。这等价于为一个变换后的系统求解标准最小二乘问题。令 $\\mathbf{A}' = \\mathbf{W}^{1/2}\\mathbf{A}$ 和 $\\mathbf{b}' = \\mathbf{W}^{1/2}\\mathbf{b}$。问题变为：\n$$\n\\min_{\\mathbf{x}} \\| \\mathbf{A}'\\mathbf{x} - \\mathbf{b}' \\|_2^2 \\quad \\text{subject to} \\quad \\mathbf{x} \\ge \\mathbf{0}\n$$\n这是一个非负最小二乘 (NNLS) 问题。可以使用已有的算法进行数值求解，例如由 Lawson 和 Hanson 开发的活动集方法，该方法鲁棒性强，并在科学计算库中广泛可用。\n\n每个测试用例的数值计算步骤如下：\n1. 根据给定的 $\\omega_i$ 和 $\\xi_i$ 数据，构建 $n \\times 2$ 的设计矩阵 $\\mathbf{A}$ 和 $n \\times 1$ 的观测向量 $\\mathbf{b}$。\n2. 构建权重平方根的向量 $\\sqrt{w_i}$。\n3. 通过将 $\\mathbf{A}$ 的每一行和 $\\mathbf{b}$ 的相应元素乘以对应的 $\\sqrt{w_i}$，创建加权矩阵 $\\mathbf{A}'$ 和向量 $\\mathbf{b}'$。\n4. 使用合适的数值求解器求解 NNLS 问题，得到 $\\mathbf{x} = [\\alpha, \\beta]^T$。\n5. 利用求得的最优 $\\alpha$ 和 $\\beta$，计算预测的阻尼比 $\\hat{\\xi}_i = \\frac{\\alpha}{2\\omega_i} + \\frac{\\beta\\omega_i}{2}$。\n6. 使用加权均方根误差 (RMSE) 计算拟合优度：\n$$\n\\text{RMSE} = \\sqrt{ \\frac{ \\sum_{i=1}^n w_i \\left( \\hat{\\xi}_i - \\xi_i \\right)^2 }{ \\sum_{i=1}^n w_i } }\n$$\n这提供了一种从实验数据校准 Rayleigh 阻尼模型的综合方法，并遵守了非负阻尼系数的物理约束。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves for Rayleigh damping coefficients for multiple test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"omega\": [10, 20, 40, 80],\n            \"xi\": [0.1027, 0.1988, 0.4029, 0.7951],\n            \"w\": [1, 1, 1, 1]\n        },\n        {\n            \"omega\": [15, 60],\n            \"xi\": [0.0408333, 0.1508333],\n            \"w\": [2.0, 0.5]\n        },\n        {\n            \"omega\": [50, 50, 50],\n            \"xi\": [0.2480, 0.2510, 0.2495],\n            \"w\": [1, 1, 1]\n        },\n        {\n            \"omega\": [0.5, 2, 5, 20, 100, 200],\n            \"xi\": [0.0201, 0.0062, 0.0043, 0.0107, 0.0496, 0.1004],\n            \"w\": [0.5, 2, 5, 20, 100, 200]\n        }\n    ]\n\n    all_results_str = []\n    \n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        omega = np.array(case[\"omega\"], dtype=float)\n        xi = np.array(case[\"xi\"], dtype=float)\n        w = np.array(case[\"w\"], dtype=float)\n\n        # 1. Construct the design matrix A\n        # The model is xi = (alpha / (2*omega)) + (beta * omega / 2)\n        # This is a linear system: xi = A * x, where x = [alpha, beta]\n        # A has two columns: [1/(2*omega), omega/2]\n        n_points = len(omega)\n        A = np.zeros((n_points, 2))\n        A[:, 0] = 1.0 / (2.0 * omega)\n        A[:, 1] = omega / 2.0\n        \n        # The vector of observations is b = xi\n        b = xi\n\n        # 2. Apply weights to formulate a standard NNLS problem\n        # We want to minimize sum(w * (A*x - b)**2), which is ||sqrt(W)*(A*x-b)||^2\n        # So we solve for x in (sqrt(W)*A)*x = sqrt(W)*b\n        sqrt_w = np.sqrt(w)\n        \n        # Apply weights by row-wise multiplication\n        A_w = A * sqrt_w[:, np.newaxis]\n        b_w = b * sqrt_w\n        \n        # 3. Solve the Non-Negative Least Squares (NNLS) problem\n        # This finds x = 0 that minimizes ||A_w * x - b_w||_2\n        x, _ = nnls(A_w, b_w)\n        alpha, beta = x[0], x[1]\n\n        # 4. Calculate the predicted damping ratios\n        xi_predicted = A @ x\n        \n        # 5. Calculate the weighted Root-Mean-Square Error (RMSE)\n        sum_weights = np.sum(w)\n        if sum_weights > 0:\n            weighted_squared_error_sum = np.sum(w * (xi_predicted - xi)**2)\n            rmse = np.sqrt(weighted_squared_error_sum / sum_weights)\n        else: # Should not happen with positive weights\n            rmse = 0.0\n\n        # Store results formatted to six decimal places\n        case_result_str = f\"[{alpha:.6f},{beta:.6f},{rmse:.6f}]\"\n        all_results_str.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "3515260"}]}