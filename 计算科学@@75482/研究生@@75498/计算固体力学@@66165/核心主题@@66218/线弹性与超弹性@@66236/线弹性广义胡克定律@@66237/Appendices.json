{"hands_on_practices": [{"introduction": "这项基础练习旨在从第一性原理出发，推导各向同性材料的刚度矩阵 [@problem_id:3567935]。你将从应变能密度函数入手，推导出以 Voigt 表示法书写的 $6 \\times 6$ 刚度矩阵。这项练习不仅能加深你对本构关系的理解，还能揭示热力学稳定性（即应变能正定性）如何约束泊松比 $\\nu$ 等材料常数的取值范围。", "problem": "考虑一个三维、小应变、线性弹性的各向同性固体，其特征为杨氏模量 $E0$ 和泊松比 $\\nu$（$-1  \\nu  \\frac{1}{2}$）。采用 Voigt 表示法，使用工程剪切约定将对称应力张量 $\\boldsymbol{\\sigma}$ 和应变张量 $\\boldsymbol{\\varepsilon}$ 映射为6维向量：\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{V}}=\\begin{pmatrix}\\sigma_{xx}  \\sigma_{yy}  \\sigma_{zz}  \\sigma_{yz}  \\sigma_{xz}  \\sigma_{xy}\\end{pmatrix}^{\\mathsf{T}},\\quad\n\\boldsymbol{\\varepsilon}^{\\mathrm{V}}=\\begin{pmatrix}\\varepsilon_{xx}  \\varepsilon_{yy}  \\varepsilon_{zz}  2\\varepsilon_{yz}  2\\varepsilon_{xz}  2\\varepsilon_{xy}\\end{pmatrix}^{\\mathsf{T}}.\n$$\n从一个与小应变下各向同性一致的、标架无关的二次应变能密度函数出发，结合单轴应力状态下杨氏模量 $E$ 和泊松比 $\\nu$ 的定义，推导广义胡克定律的形式 $\\boldsymbol{\\sigma}^{\\mathrm{V}}=\\boldsymbol{C}(E,\\nu)\\,\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$，并以 Voigt 记法计算显式的 $6\\times 6$ 刚度矩阵 $\\boldsymbol{C}(E,\\nu)$。然后，不援引任何现成的稳定性判据，通过分析相关的二次型来验证 $\\boldsymbol{C}(E,\\nu)$ 在 $-1  \\nu  \\frac{1}{2}$ 范围内的正定性。\n\n请提供你的最终结果，即以 $E$ 和 $\\nu$ 表示的 $6\\times 6$ Voigt 刚度矩阵 $\\boldsymbol{C}(E,\\nu)$ 的闭式解析表达式。无需进行数值计算。", "solution": "### 刚度矩阵的推导\n\n推导过程分四个阶段：(1) 建立各向同性应变能密度函数，(2) 推导应力-应变关系，(3) 将材料参数与 $E$ 和 $\\nu$ 相关联，以及 (4) 以 Voigt 形式组装刚度矩阵。\n\n**1. 各向同性应变能密度函数**\n\n对于小应变下的线性弹性材料，应变能密度 $W$ 是应变张量分量 $\\varepsilon_{ij}$ 的二次函数。对于各向同性材料，$W$ 必须在任何坐标系旋转下保持不变，这意味着它只能是应变张量 $\\boldsymbol{\\varepsilon}$ 的不变量的函数。使用应变不变量表示 $W$ 的最一般的二次形式通常用第一主不变量 $I_1 = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$ 和二阶项 $\\mathrm{tr}(\\boldsymbol{\\varepsilon}^2)$ 来表示：\n$$\nW(\\boldsymbol{\\varepsilon}) = \\frac{1}{2} \\lambda (I_1)^2 + \\mu \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}^2)\n$$\n其中 $\\lambda$ 和 $\\mu$ 是 Lamé 参数。因子 $\\frac{1}{2}$ 是约定俗成的。不变量用应变分量表示为：\n$$\nI_1 = \\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}\n$$\n$$\n\\mathrm{tr}(\\boldsymbol{\\varepsilon}^2) = \\varepsilon_{ij}\\varepsilon_{ji} = \\varepsilon_{xx}^2 + \\varepsilon_{yy}^2 + \\varepsilon_{zz}^2 + 2\\varepsilon_{xy}^2 + 2\\varepsilon_{xz}^2 + 2\\varepsilon_{yz}^2\n$$\n\n**2. 应力-应变关系**\n\n对称 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 的分量是通过将应变能密度对应变张量的相应分量求导得到的：\n$$\n\\sigma_{ij} = \\frac{\\partial W}{\\partial \\varepsilon_{ij}}\n$$\n使用链式法则和关系式 $\\frac{\\partial I_1}{\\partial \\varepsilon_{ij}} = \\delta_{ij}$ 和 $\\frac{\\partial \\mathrm{tr}(\\boldsymbol{\\varepsilon}^2)}{\\partial \\varepsilon_{ij}} = 2\\varepsilon_{ij}$（对于对称的 $\\boldsymbol{\\varepsilon}$），我们得到：\n$$\n\\sigma_{ij} = \\frac{\\partial}{\\partial \\varepsilon_{ij}} \\left( \\frac{1}{2} \\lambda (\\varepsilon_{kk})^2 + \\mu \\varepsilon_{lm}\\varepsilon_{ml} \\right) = \\lambda (\\varepsilon_{kk}) \\delta_{ij} + 2\\mu \\varepsilon_{ij}\n$$\n这就是张量形式的各向同性材料的广义胡克定律。\n\n**3. 将 Lamé 参数与 $E$ 和 $\\nu$ 相关联**\n\n我们考虑沿 $x$ 轴的单轴应力状态，其中 $\\sigma_{xx}$ 是唯一的非零应力分量。应力张量为：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n根据杨氏模量 $E$ 和泊松比 $\\nu$ 的定义，应变分量为 $\\varepsilon_{xx} = \\sigma_{xx}/E$，$\\varepsilon_{yy} = -\\nu\\varepsilon_{xx}$，以及 $\\varepsilon_{zz} = -\\nu\\varepsilon_{xx}$。剪应变为零。将这些代入张量形式的胡克定律：\n对于 $\\sigma_{yy}=0$：\n$$\n0 = \\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu\\varepsilon_{yy} = \\lambda(\\varepsilon_{xx} - \\nu\\varepsilon_{xx} - \\nu\\varepsilon_{xx}) + 2\\mu(-\\nu\\varepsilon_{xx})\n$$\n假设 $\\varepsilon_{xx} \\neq 0$，我们可以用它来除：\n$$\n0 = \\lambda(1 - 2\\nu) - 2\\mu\\nu \\implies \\lambda = \\frac{2\\mu\\nu}{1-2\\nu}\n$$\n对于 $\\sigma_{xx}$：\n$$\n\\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu\\varepsilon_{xx} = \\lambda\\varepsilon_{xx}(1 - 2\\nu) + 2\\mu\\varepsilon_{xx}\n$$\n杨氏模量为 $E = \\sigma_{xx} / \\varepsilon_{xx}$：\n$$\nE = \\lambda(1 - 2\\nu) + 2\\mu\n$$\n代入 $\\lambda$ 的表达式：\n$$\nE = \\left(\\frac{2\\mu\\nu}{1-2\\nu}\\right)(1 - 2\\nu) + 2\\mu = 2\\mu\\nu + 2\\mu = 2\\mu(1+\\nu)\n$$\n这给出了用 $E$ 和 $\\nu$ 表示 Lamé 参数的关系式：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}\n$$\n$$\n\\lambda = \\frac{2\\nu}{1-2\\nu} \\mu = \\frac{2\\nu}{1-2\\nu} \\frac{E}{2(1+\\nu)} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n$$\n我们还推导出一个重要的组合：\n$$\n\\lambda + 2\\mu = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E\\nu + E(1-2\\nu)}{(1+\\nu)(1-2\\nu)} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\n\n**4. 组装 $6\\times6$ 刚度矩阵**\n\n我们用工程应变 $\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{yz}=2\\varepsilon_{yz}, \\gamma_{xz}=2\\varepsilon_{xz}, \\gamma_{xy}=2\\varepsilon_{xy}$ 写出应力分量：\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz}\n$$\n$$\n\\sigma_{yy} = \\lambda\\varepsilon_{xx} + (\\lambda + 2\\mu)\\varepsilon_{yy} + \\lambda\\varepsilon_{zz}\n$$\n$$\n\\sigma_{zz} = \\lambda\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + (\\lambda + 2\\mu)\\varepsilon_{zz}\n$$\n$$\n\\sigma_{yz} = 2\\mu\\varepsilon_{yz} = \\mu(2\\varepsilon_{yz}) = \\mu\\gamma_{yz}\n$$\n$$\n\\sigma_{xz} = 2\\mu\\varepsilon_{xz} = \\mu(2\\varepsilon_{xz}) = \\mu\\gamma_{xz}\n$$\n$$\n\\sigma_{xy} = 2\\mu\\varepsilon_{xy} = \\mu(2\\varepsilon_{xy}) = \\mu\\gamma_{xy}\n$$\n这些方程可以写成矩阵形式 $\\boldsymbol{\\sigma}^{\\mathrm{V}} = \\boldsymbol{C} \\boldsymbol{\\varepsilon}^{\\mathrm{V}}$：\n$$\n\\boldsymbol{C} = \\begin{pmatrix}\n\\lambda+2\\mu  \\lambda  \\lambda  0  0  0 \\\\\n\\lambda  \\lambda+2\\mu  \\lambda  0  0  0 \\\\\n\\lambda  \\lambda  \\lambda+2\\mu  0  0  0 \\\\\n0  0  0  \\mu  0  0 \\\\\n0  0  0  0  \\mu  0 \\\\\n0  0  0  0  0  \\mu\n\\end{pmatrix}\n$$\n将用 $E$ 和 $\\nu$ 表示的 $\\lambda$ 和 $\\mu$ 的表达式代入，并提出公因子 $\\frac{E}{(1+\\nu)(1-2\\nu)}$，得到最终的矩阵。剪切的对角项为 $\\mu = \\frac{E}{2(1+\\nu)}$。为了适应提出的因子形式，我们将其写为：\n$$\n\\mu = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left( \\frac{(1+\\nu)(1-2\\nu)}{2(1+\\nu)} \\right) = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left( \\frac{1-2\\nu}{2} \\right)\n$$\n法向项为 $\\lambda+2\\mu = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}$ 和 $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n因此矩阵为：\n$$\n\\boldsymbol{C}(E,\\nu) = \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{pmatrix}\n1-\\nu  \\nu  \\nu  0  0  0 \\\\\n\\nu  1-\\nu  \\nu  0  0  0 \\\\\n\\nu  \\nu  1-\\nu  0  0  0 \\\\\n0  0  0  \\frac{1-2\\nu}{2}  0  0 \\\\\n0  0  0  0  \\frac{1-2\\nu}{2}  0 \\\\\n0  0  0  0  0  \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n$$\n\n### 正定性验证\n\n为保证热力学稳定性，对于任何非零应变状态，应变能密度 $W$ 都必须为正，即当 $\\boldsymbol{\\varepsilon} \\neq \\boldsymbol{0}$ 时 $W > 0$。应变能密度可以用 Voigt 记法写为 $W = \\frac{1}{2}(\\boldsymbol{\\varepsilon}^{\\mathrm{V}})^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$。因此，我们必须证明矩阵 $\\boldsymbol{C}$ 是正定的。这等价于证明对于任何非零应变向量 $\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$，二次型 $Q = (\\boldsymbol{\\varepsilon}^{\\mathrm{V}})^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{\\varepsilon}^{\\mathrm{V}}$ 均为正。\n\n由于 $\\boldsymbol{C}$ 的块对角结构，二次型可以分解为两部分，一部分用于法向应变，另一部分用于剪切应变：\n$$\nQ = Q_{\\text{normal}} + Q_{\\text{shear}}\n$$\n对于 $\\boldsymbol{\\varepsilon}^{\\mathrm{V}} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{yz}, \\gamma_{xz}, \\gamma_{xy})^{\\mathsf{T}}$，我们有：\n$$\nQ_{\\text{shear}} = \\mu (\\gamma_{yz}^2 + \\gamma_{xz}^2 + \\gamma_{xy}^2)\n$$\n由于给定 $E0$，对于任何非零剪应变，$Q_{\\text{shear}}  0$ 当且仅当 $\\mu  0$。\n$$\n\\mu = \\frac{E}{2(1+\\nu)}  0 \\implies 1+\\nu  0 \\implies \\nu  -1\n$$\n这确定了 $\\nu$ 的下界。\n\n法向应变部分为：\n$$\nQ_{\\text{normal}} = (\\lambda+2\\mu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + 2\\lambda(\\varepsilon_{xx}\\varepsilon_{yy}+\\varepsilon_{yy}\\varepsilon_{zz}+\\varepsilon_{zz}\\varepsilon_{xx})\n$$\n我们可以通过加减 $2\\nu(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2)$ 来重新整理这个表达式：\n$$\nQ_{\\text{normal}} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\left[ (1-\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + 2\\nu(\\varepsilon_{xx}\\varepsilon_{yy}+\\varepsilon_{yy}\\varepsilon_{zz}+\\varepsilon_{zz}\\varepsilon_{xx}) \\right]\n$$\n让我们分析方括号中的项：\n$$\n[\\dots] = (1-2\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + \\nu(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2 + 2\\varepsilon_{xx}\\varepsilon_{yy}+2\\varepsilon_{yy}\\varepsilon_{zz}+2\\varepsilon_{zz}\\varepsilon_{xx})\n$$\n$$\n[\\dots] = (1-2\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2) + \\nu(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz})^2\n$$\n为使整个二次型 $Q_{\\text{normal}}$ 为正，前置因子 $\\frac{E}{(1+\\nu)(1-2\\nu)}$ 必须为正。由于 $E0$ 且我们已确定 $1+\\nu0$，我们需要：\n$$\n1-2\\nu  0 \\implies \\nu  \\frac{1}{2}\n$$\n这确定了 $\\nu$ 的上界。\n现在，当 $-1  \\nu  \\frac{1}{2}$ 时，$1-2\\nu$ 和前置因子都为正。我们必须验证对于任何非零法向应变状态，括号中的项也为正。\n- 如果 $0 \\le \\nu  \\frac{1}{2}$，那么 $\\nu \\ge 0$ 且 $1-2\\nu > 0$。项 $(1-2\\nu)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2)$ 是非负的，$\\nu(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz})^2$ 也是非负的。其和仅在所有应变为零时才为零。因此，它是正定的。\n- 如果 $-1  \\nu  0$，项 $\\nu(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz})^2$ 是非正的。令 $\\varepsilon_v = \\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz}$。根据 Cauchy-Schwarz 不等式，$(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz})^2 \\le (1^2+1^2+1^2)(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2)$，所以 $\\varepsilon_v^2 \\le 3(\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+\\varepsilon_{zz}^2)$。\n让我们分析静水应变的情况，其中 $\\varepsilon_{xx}=\\varepsilon_{yy}=\\varepsilon_{zz}=\\varepsilon_0 \\neq 0$。括号中的二次型变为 $(1-2\\nu)(3\\varepsilon_0^2) + \\nu(3\\varepsilon_0)^2 = (3-6\\nu+9\\nu)\\varepsilon_0^2 = 3(1+\\nu)\\varepsilon_0^2$。由于 $\\nu  -1$，此项为正。\n对于任何其他应变状态，我们可以将应变分解为静水部分和偏部分。$3 \\times 3$ 法向刚度矩阵的特征值为 $2\\mu$（2重）和 $3\\lambda+2\\mu$（1重）。\n- $2\\mu  0 \\implies \\nu  -1$。\n- $3\\lambda+2\\mu = 3\\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E(3\\nu + 1-2\\nu)}{(1+\\nu)(1-2\\nu)} = \\frac{E}{1-2\\nu}$。如果 $\\nu  \\frac{1}{2}$，此项为正。\n由于对于 $-1  \\nu  \\frac{1}{2}$，$\\boldsymbol{C}$ 的两个块的所有特征值都为正，因此矩阵 $\\boldsymbol{C}$ 是正定的，这证实了材料在该范围内的稳定性。\n\n推导已完成，并按要求验证了正定性。最终结果是矩阵 $\\boldsymbol{C}(E,\\nu)$ 的显式形式。", "answer": "$$\n\\boxed{\n\\boldsymbol{C}(E,\\nu) = \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{pmatrix}\n1-\\nu  \\nu  \\nu  0  0  0 \\\\\n\\nu  1-\\nu  \\nu  0  0  0 \\\\\n\\nu  \\nu  1-\\nu  0  0  0 \\\\\n0  0  0  \\frac{1-2\\nu}{2}  0  0 \\\\\n0  0  0  0  \\frac{1-2\\nu}{2}  0 \\\\\n0  0  0  0  0  \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n}\n$$", "id": "3567935"}, {"introduction": "在推导出各向同性刚度矩阵后，这项实践将探讨其数值特性 [@problem_id:3567915]。通过计算该矩阵的条件数，特别是当材料接近不可压缩极限（$\\nu \\to 0.5$）时，你将深入理解为何某些材料模型会导致数值求解中的病态问题。这对于理解和诊断计算力学中迭代求解器的收敛性能至关重要。", "problem": "三维空间中的线性弹性、均质、各向同性固体遵循广义胡克定律，该定律通过一个四阶弹性张量将小应变张量映射到柯西应力张量。考虑 Kelvin 映射，它将对称二阶张量向量化为一个 6 维向量，其中剪切分量经过 $\\sqrt{2}$ 缩放，从而使得向量的欧几里得内积代表张量的物理双点积。在此设置下，四阶张量由一个对称的 $6\\times 6$ 矩阵表示。从线性动量守恒、标架无关性、小应变运动学和各向同性等基本原理出发，并结合线性弹性理论中关于各向同性四阶张量的经过充分检验的表示定理，推导各向同性材料的 Kelvin 形式刚度矩阵的结构，并用 Lamé 参数表示。使用通过杨氏模量 $E$、泊松比 $\\nu$ 以及体积模量 $K$ 表示的 Lamé 参数，来获得 Kelvin 形式矩阵的谱特性。\n\n您的任务是实现一个程序，对于一组给定的 $(E,\\nu)$ 对，该程序能：构建由各向同性假设和广义胡克定律所确定的 $6\\times 6$ Kelvin 形式刚度矩阵；计算其谱 2-范数条件数（最大特征值与最小特征值之比）；并利用对称正定 (SPD) 系统上共轭梯度 (CG) 方法的最坏情况理论，预测将误差的能量范数减小 $10^{-8}$ 倍所需的最少整数迭代次数。条件数是无量纲的，预测的迭代次数是无量纲整数。杨氏模量 $E$ 必须以帕斯卡 (N/m$^2$) 为单位提供。将条件数表示为四舍五入到 6 位有效数字的浮点数，迭代次数表示为整数。不涉及角度单位。不涉及百分比。\n\n您可以使用的基本且经过充分检验的依据包括：用 Lamé 参数 $(\\lambda,\\mu)$ 表示的弹性张量的各向同性表示法、Kelvin 映射保持内积的性质，以及应用于 SPD 矩阵的共轭梯度法的标准最坏情况收敛结果。请勿使用任何未经验证或临时的公式。\n\n测试套件：\n- 情况 1：$E=1.0\\times 10^{9}$ Pa, $\\nu=0.25$。\n- 情况 2：$E=1.0\\times 10^{9}$ Pa, $\\nu=0.4999$。\n- 情况 3：$E=1.0\\times 10^{9}$ Pa, $\\nu=-0.9$。\n- 情况 4：$E=1.0\\times 10^{9}$ Pa, $\\nu=0.0$。\n- 情况 5：$E=2.5\\times 10^{5}$ Pa, $\\nu=0.49$。\n\n每种情况所需的输出：\n- $6\\times 6$ Kelvin 形式刚度矩阵的谱条件数（无量纲），四舍五入到 6 位有效数字。\n- 根据 SPD 矩阵的标准最坏情况理论，保证能量范数误差减小 $10^{-8}$ 倍所需的最小整数 CG 迭代次数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是 $[{\\tt condition\\_number},{\\tt iteration\\_count}]$ 形式的双元素列表，不含空格。例如，两个假设用例的有效输出应为 $[[1.23456,42],[7.89,100]]$。", "solution": "我们从适用于小应变下的线性弹性、各向同性、均质固体的广义胡克定律开始。该定律指出，柯西应力张量 $\\boldsymbol{\\sigma}$ 通过一个四阶弹性张量 $\\mathbb{C}$ 与小应变张量 $\\boldsymbol{\\varepsilon}$ 相关联，如下所示：\n$$\n\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}.\n$$\n根据各向同性四阶张量的表示定理，与各向同性一致的 $\\mathbb{C}$ 的最一般形式为：\n$$\n\\mathbb{C} = \\lambda\\, \\mathbf{I}\\otimes \\mathbf{I} + 2\\mu\\, \\mathbb{I}_{\\text{sym}},\n$$\n其中 $\\lambda$ 和 $\\mu$ 是 Lamé 参数，$\\mathbf{I}$ 是二阶单位张量，而 $\\mathbb{I}_{\\text{sym}}$ 是四阶对称单位张量。Lamé 参数通过经过充分检验的关系式与杨氏模量 $E$ 和泊松比 $\\nu$ 相关联：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}.\n$$\n体积模量 $K$ 由下式给出：\n$$\nK = \\lambda + \\frac{2}{3}\\mu = \\frac{E}{3(1-2\\nu)}.\n$$\n\n为了分析条件作用和迭代求解器的行为，我们在 Kelvin 映射中进行操作。该映射将一个对称二阶张量向量化为一个 6 维向量，其中剪切分量经过 $\\sqrt{2}$ 缩放，以将张量内积保留为欧几里得内积。具体来说，定义 Kelvin 向量：\n$$\n\\mathbf{s} = \\begin{bmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sqrt{2}\\,\\sigma_{23} \\\\ \\sqrt{2}\\,\\sigma_{13} \\\\ \\sqrt{2}\\,\\sigma_{12} \\end{bmatrix}, \\qquad\n\\mathbf{e} = \\begin{bmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ \\sqrt{2}\\,\\varepsilon_{23} \\\\ \\sqrt{2}\\,\\varepsilon_{13} \\\\ \\sqrt{2}\\,\\varepsilon_{12} \\end{bmatrix}.\n$$\n在 Kelvin 形式下，广义胡克定律变成一个 $6\\times 6$ 矩阵方程：\n$$\n\\mathbf{s} = \\mathbf{C}_{K}\\,\\mathbf{e}.\n$$\n对于各向同性材料，代入表示式 $\\mathbb{C} = \\lambda\\, \\mathbf{I}\\otimes \\mathbf{I} + 2\\mu\\, \\mathbb{I}_{\\text{sym}}$ 并考虑 $\\sqrt{2}$ 缩放，可得：\n$$\n\\mathbf{C}_{K} =\n\\begin{bmatrix}\n\\lambda+2\\mu  \\lambda  \\lambda  0  0  0 \\\\\n\\lambda  \\lambda+2\\mu  \\lambda  0  0  0 \\\\\n\\lambda  \\lambda  \\lambda+2\\mu  0  0  0 \\\\\n0  0  0  2\\mu  0  0 \\\\\n0  0  0  0  2\\mu  0 \\\\\n0  0  0  0  0  2\\mu\n\\end{bmatrix}.\n$$\n对称性和正定性要求 $E0$ 和 $-1  \\nu  0.5$，在此条件下 $\\mu0$ 且 $K0$。$\\mathbf{C}_{K}$ 的特征结构可从体积-偏应力分解中得出。考虑体积（球形）方向\n$$\n\\mathbf{v}_{\\text{vol}} = \\frac{1}{\\sqrt{3}}\\begin{bmatrix}1\\\\1\\\\1\\\\0\\\\0\\\\0\\end{bmatrix},\n$$\n对其可以验证：\n$$\n\\mathbf{C}_{K}\\,\\mathbf{v}_{\\text{vol}} = (3K)\\,\\mathbf{v}_{\\text{vol}}.\n$$\n任何偏应变（无迹）方向——存在五个与 $\\mathbf{v}_{\\text{vol}}$ 正交的线性无关 Kelvin 向量——都是特征值为 $2\\mu$ 的特征向量。因此，$\\mathbf{C}_{K}$ 的谱为：\n$$\n\\{\\underbrace{3K}_{\\text{重数 }1},\\ \\underbrace{2\\mu,\\ 2\\mu,\\ 2\\mu,\\ 2\\mu,\\ 2\\mu}_{\\text{重数 }5}\\}.\n$$\n因为 $\\mathbf{C}_{K}$ 是对称正定的，其谱 2-范数条件数是最大特征值与最小特征值之比：\n$$\n\\kappa_{2}(\\mathbf{C}_{K}) = \\frac{\\max\\{3K,\\,2\\mu\\}}{\\min\\{3K,\\,2\\mu\\}}.\n$$\n使用 $K=\\dfrac{E}{3(1-2\\nu)}$ 和 $\\mu=\\dfrac{E}{2(1+\\nu)}$，我们发现 $\\kappa_{2}(\\mathbf{C}_{K})$ 与 $E$ 的总体尺度无关，仅取决于 $\\nu$。特别是，当 $\\nu\\to 0.5$（近不可压缩极限）时，$K\\to\\infty$ 而 $\\mu$ 保持有限，因此 $\\kappa_{2}(\\mathbf{C}_{K})\\to\\infty$。当 $\\nu=0$ 时，有 $3K=2\\mu=E$，得到 $\\kappa_{2}(\\mathbf{C}_{K})=1$。\n\n为了将条件与迭代求解器的行为联系起来，我们引用一个经过充分检验的、应用于 SPD 线性系统 $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$ 的共轭梯度法的最坏情况收敛界。其中，在能量范数 $\\|\\cdot\\|_{\\mathbf{A}}$ 下度量的误差满足：\n$$\n\\frac{\\|\\mathbf{e}_{k}\\|_{\\mathbf{A}}}{\\|\\mathbf{e}_{0}\\|_{\\mathbf{A}}} \\le 2\\left(\\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}\\right)^{k},\n$$\n其中 $\\kappa=\\kappa_{2}(\\mathbf{A})$。将有限元离散化中的 Kelvin 形式刚度矩阵解释为 SPD 算子，我们可以通过求解以下不等式来保守地估计保证能量范数误差减小 $10^{-8}$ 倍所需的最小整数 $k$：\n$$\n2\\left(\\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}\\right)^{k} \\le 10^{-8}\n$$\n求解 $k$ 并向上取整。定义\n$$\nq(\\kappa)=\\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}\\in[0,1), \\qquad \\text{和} \\qquad k_{\\min}=\\left\\lceil \\frac{\\ln\\left(10^{-8}/2\\right)}{\\ln\\left(q(\\kappa)\\right)}\\right\\rceil,\n$$\n特殊情况是当 $\\kappa=1$ 时 $k_{\\min}=1$（因为 $q(1)=0$）。\n\n算法设计：\n- 对于每个测试用例 $(E,\\nu)$（其中 $E0$ 且 $-1  \\nu  0.5$），计算 $\\mu=\\dfrac{E}{2(1+\\nu)}$ 和 $K=\\dfrac{E}{3(1-2\\nu)}$。\n- 计算两个不同的特征值 $3K$ 和 $2\\mu$，以及谱条件数 $\\kappa=\\dfrac{\\max\\{3K,2\\mu\\}}{\\min\\{3K,2\\mu\\}}$。\n- 使用上述最坏情况 CG 界计算 $k_{\\min}$。\n- 将 $\\kappa$ 四舍五入到 6 位有效数字，并将 $k_{\\min}$ 报告为整数。\n- 将结果聚合为 $[[\\kappa_{1},k_{\\min,1}],\\ldots,[\\kappa_{5},k_{\\min,5}]]$ 的形式，并作为不含空格的单行打印。\n\n科学真实性和边界情况：\n- 近不可压缩情况 $\\nu\\to 0.5$ 会产生非常大的 $\\kappa$，反映了严重的病态问题和最坏情况下的缓慢 CG 收敛，除非使用专门的预处理器或混合格式，这与计算固体力学的实践相符。\n- $\\nu=0$ 的情况得出 $\\kappa=1$ 和 $k_{\\min}=1$，表明对于在能量范数下等效于缩放单位阵的系统，可以立即收敛。\n- $\\nu$ 接近 $-1$ 的强拉胀材料会产生大的 $\\mu$ 和小的 $K$，同样导致大的 $\\kappa$ 和缓慢的最坏情况收敛。\n\n该程序为给定的测试套件实现这些步骤，并打印所需的列表。因为对于各向同性材料，条件数仅取决于 $\\nu$，所以改变 $E$ 不会影响 $\\kappa$，也不会改变算法或结论。根据要求，数值输出是无量纲的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_case(E: float, nu: float):\n    \"\"\"\n    Calculates the condition number and CG iterations for a given (E, nu) pair.\n    \"\"\"\n    if not (-1  nu  0.5):\n        return float('nan'), float('nan')\n\n    # Calculate Bulk Modulus (K) and Shear Modulus (mu)\n    mu = E / (2.0 * (1.0 + nu))\n    K = E / (3.0 * (1.0 - 2.0 * nu))\n\n    # The eigenvalues of the Kelvin-form stiffness matrix are 3K (volumetric)\n    # and 2mu (deviatoric).\n    lambda_vol = 3 * K\n    lambda_dev = 2 * mu\n\n    # Spectral 2-norm condition number\n    kappa = max(lambda_vol, lambda_dev) / min(lambda_vol, lambda_dev)\n\n    # Estimate worst-case CG iterations to reduce error norm by 10^-8\n    if abs(kappa - 1.0)  1e-9:\n        k_min = 1\n    else:\n        q = (np.sqrt(kappa) - 1) / (np.sqrt(kappa) + 1)\n        # Solve 2 * q^k = 10^-8 for k\n        k_min = np.ceil(np.log(0.5e-8) / np.log(q))\n\n    return kappa, int(k_min)\n\ndef run_tests():\n    \"\"\"\n    Runs all test cases and prints the results in the specified format.\n    \"\"\"\n    test_suite = [\n        {'E': 1.0e9, 'nu': 0.25},\n        {'E': 1.0e9, 'nu': 0.4999},\n        {'E': 1.0e9, 'nu': -0.9},\n        {'E': 1.0e9, 'nu': 0.0},\n        {'E': 2.5e5, 'nu': 0.49}\n    ]\n\n    output_list = []\n    for case in test_suite:\n        kappa, k_min = solve_case(case['E'], case['nu'])\n        # Format condition number to 6 significant figures\n        kappa_str = f\"{kappa:.6g}\"\n        output_list.append(f\"[{kappa_str},{k_min}]\")\n\n    print(f\"[{','.join(output_list)}]\")\n\nrun_tests()\n```", "id": "3567915"}, {"introduction": "最后的这项实践将理论付诸于完整的计算实现中 [@problem_id:3567978]。你将为一个由正交各向异性材料构成的结构编写程序来组装其全局刚度矩阵。此过程中的核心挑战在于，需要将每个单元局部坐标系下的材料本构张量正确地旋转到全局坐标系，这是有限元分析中处理复杂材料模型的一项关键技能。", "problem": "考虑一个处于平面应力状态下的二维小应变、线弹性、正交各向异性材料。该材料的本构四阶弹性张量在其与坐标轴 $\\{1,2\\}$ 对齐的局部材料坐标系中定义，其主性能由 $(E_1,E_2,\\nu_{12},G_{12})$ 给出。全局计算坐标系为 $\\{x,y\\}$。位移场采用线性三角形有限元进行近似，并使用数值积分来组装全局刚度矩阵。\n\n从计算固体力学中适用于线弹性的基本原理出发：\n- 小应变运动学通过位移场 $u$ 定义应变张量 $\\varepsilon$ 为 $\\varepsilon = \\tfrac{1}{2}(\\nabla u + \\nabla u^\\top)$，工程剪应变为 $\\gamma_{xy} = 2 \\varepsilon_{xy}$。\n- 广义胡克定律（线弹性）定义了应力-应变关系 $\\sigma = \\mathbb{C} : \\varepsilon$，其中 $\\mathbb{C}$ 是四阶弹性张量。\n- 线性化弹性力学的虚功原理得出单元刚度被积函数为 $B^\\top C B$，其中 $B$ 将节点位移映射到工程应变向量，而 $C$ 是与工程应变向量一致的本构矩阵。\n\n您的任务是实现一个程序，为一个小网格组装全局刚度矩阵 $K$，并为给定的位移场计算总应变能。需要实现的基本算法步骤如下：\n1. 根据 $(E_1,E_2,\\nu_{12},G_{12})$ 和 $\\nu_{21} = \\nu_{12} E_2 / E_1$ 构建局部平面应力四阶弹性张量 $\\mathbb{C}^{(loc)}$，使其满足主、次对称性。\n2. 对于每个单元，使用旋转矩阵 $Q(\\theta)$ 通过适当的张量前推，将 $\\mathbb{C}^{(loc)}$ 旋转到单元的全局坐标系。其中 $\\theta$ 是局部坐标轴 $1$ 与全局坐标轴 $x$ 之间的夹角。具体而言，计算 $\\mathbb{C}^{(glob)}_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl} \\,\\mathbb{C}^{(loc)}_{ijkl}$。\n3. 将旋转后的四阶张量 $\\mathbb{C}^{(glob)}$ 映射到与工程应变向量 $[\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}]^\\top$ 一致的 $3\\times 3$ 本构矩阵 $C$，注意 $\\gamma_{xy} = 2\\varepsilon_{xy}$。\n4. 对于每个具有节点 $\\{(x_1,y_1),(x_2,y_2),(x_3,y_3)\\}$ 的线性三角形单元，计算其常数应变-位移矩阵 $B$ 和单元面积 $A_e$。对于平面应力厚度 $t$，计算单元刚度 $K_e = t \\int_{\\Omega_e} B^\\top C B \\,\\mathrm{d}\\Omega$，对于线性三角形，该式可简化为 $K_e = t\\,A_e\\,B^\\top C B$。\n5. 通过将所有单元的贡献累加到相应的全局自由度中，组装全局刚度矩阵 $K$。\n6. 对于给定的节点位移向量 $u$，计算总应变能 $U = \\tfrac{1}{2} u^\\top K u$。\n\n几何与离散化：\n- 使用单位正方形，节点为 $(0,0)$、$(1,0)$、$(1,1)$、$(0,1)$，以及两个线性三角形单元：单元 $e_1$ 的节点为 $(0,0)\\rightarrow(1,0)\\rightarrow(1,1)$，单元 $e_2$ 的节点为 $(0,0)\\rightarrow(1,1)\\rightarrow(0,1)$。\n- 为每个单元指定一个不同的方向角 $\\theta$（以度为单位），表示局部材料坐标轴 $1$ 相对于全局坐标轴 $x$ 的旋转角度。\n\n给定位移场：\n- 场 A（单轴 $x$ 方向拉伸）：$u_x = \\epsilon_0 x$, $u_y = 0$，其中 $\\epsilon_0$ 是一个小的应变幅值。\n- 场 B（单轴 $y$ 方向拉伸）：$u_x = 0$, $u_y = \\epsilon_0 y$。\n\n单位：\n- 材料模量 $E_1$、$E_2$ 和 $G_{12}$ 必须以帕斯卡（$\\text{Pa}$）为单位指定。\n- 泊松比 $\\nu_{12}$ 是无量纲的。\n- 厚度 $t$ 必须以米（$\\text{m}$）为单位指定。\n- 坐标单位为米（$\\text{m}$）。\n- 应变幅值 $\\epsilon_0$ 是无量纲的。\n- 应变能以焦耳（$\\text{J}$）为单位报告。\n\n测试套件：\n- 测试用例1（正常情况）：材料 $(E_1,E_2,\\nu_{12},G_{12}) = (120\\times 10^9\\,\\text{Pa}, 60\\times 10^9\\,\\text{Pa}, 0.25, 40\\times 10^9\\,\\text{Pa})$，厚度 $t = 0.01\\,\\text{m}$，应变幅值 $\\epsilon_0 = 10^{-3}$，单元方向 $\\theta = [0^\\circ, 45^\\circ]$。计算场 A 下的能量 $U_x$ 和场 B 下的能量 $U_y$，单位均为 $\\text{J}$。\n- 测试用例2（边界方向）：与测试用例1相同的材料、厚度和 $\\epsilon_0$，但 $\\theta = [0^\\circ, 90^\\circ]$。计算能量 $U_x$ 和 $U_y$，单位为 $\\text{J}$。\n- 测试用例3（强正交各向异性边缘情况）：材料 $(E_1,E_2,\\nu_{12},G_{12}) = (200\\times 10^9\\,\\text{Pa}, 5\\times 10^9\\,\\text{Pa}, 0.20, 3\\times 10^9\\,\\text{Pa})$，厚度 $t = 0.01\\,\\text{m}$，$\\epsilon_0 = 10^{-3}$，单元方向 $\\theta = [0^\\circ, 90^\\circ]$。计算能量 $U_x$，单位为 $\\text{J}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$[U_x^{(1)},U_y^{(1)},U_x^{(2)},U_y^{(2)},U_x^{(3)}]$\n所有值都必须是浮点数，单位为 $\\text{J}$，不含任何附加文本。", "solution": "用户提供了一个在计算固体力学领域中明确定义的问题。该问题在科学上是合理的、自洽的，并且所有数据和所需步骤都已明确说明。核心任务是为一个简单的双单元网格实现有限元组装程序，并计算在给定系列位移场下的总应变能。\n\n解决方案严格遵循问题陈述中概述的算法步骤。\n\n**1. 局部坐标系中的本构张量 ($\\mathbb{C}^{(loc)}$)**\n对于处于平面应力状态的二维正交各向异性材料，其在局部材料坐标系 $\\{1,2\\}$ 中的柔度矩阵 $S$ 如下所示：\n$$\nS = \\begin{pmatrix} 1/E_1  -\\nu_{12}/E_1  0 \\\\ -\\nu_{21}/E_2  1/E_2  0 \\\\ 0  0  1/G_{12} \\end{pmatrix}\n$$\n柔度张量的对称性要求 $S_{12} = S_{21}$，这意味着 $\\nu_{12}/E_1 = \\nu_{21}/E_2$。这得出了问题中指定的关系 $\\nu_{21} = \\nu_{12} E_2 / E_1$。局部本构矩阵 $C^{(loc)}$ 是 $S$ 的逆：\n$$\nC^{(loc)} = S^{-1} = \\frac{1}{1-\\nu_{12}\\nu_{21}} \\begin{pmatrix} E_1  \\nu_{12}E_2  0 \\\\ \\nu_{21}E_1  E_2  0 \\\\ 0  0  (1-\\nu_{12}\\nu_{21})G_{12} \\end{pmatrix}\n$$\n这个 $3 \\times 3$ 矩阵将工程应力 $[\\sigma_{11}, \\sigma_{22}, \\sigma_{12}]^\\top$ 与工程应变 $[\\varepsilon_{11}, \\varepsilon_{22}, \\gamma_{12}]^\\top$ 联系起来。我们必须将其转换为一个四阶张量 $\\mathbb{C}^{(loc)}$，它关联应力张量 $\\sigma_{ij}$ 和应变张量 $\\varepsilon_{kl}$。对于坐标系与主轴对齐的正交各向异性材料，$\\mathbb{C}^{(loc)}_{ijkl}$ 的非零分量为：\n- $\\mathbb{C}^{(loc)}_{1111} = C^{(loc)}_{11}$\n- $\\mathbb{C}^{(loc)}_{2222} = C^{(loc)}_{22}$\n- $\\mathbb{C}^{(loc)}_{1122} = \\mathbb{C}^{(loc)}_{2211} = C^{(loc)}_{12}$\n- $\\mathbb{C}^{(loc)}_{1212} = \\mathbb{C}^{(loc)}_{1221} = \\mathbb{C}^{(loc)}_{2112} = \\mathbb{C}^{(loc)}_{2121} = C^{(loc)}_{33} = G_{12}$\n\n**2. 张量旋转至全局坐标系 ($\\mathbb{C}^{(glob)}$)**\n局部材料坐标系 $\\{1,2\\}$ 相对于全局坐标系 $\\{x,y\\}$ 旋转了一个角度 $\\theta$。四阶张量的分量从局部坐标系到全局坐标系的变换由指定的前推操作给出：\n$$\n\\mathbb{C}^{(glob)}_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl} \\mathbb{C}^{(loc)}_{ijkl}\n$$\n这里隐含了对重复指标的求和，而 $Q(\\theta)$ 是用于矢量分量的标准二维旋转矩阵：\n$$\nQ(\\theta) = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\n此操作可使用 `numpy.einsum` 高效实现。\n\n**3. 映射到全局本构矩阵 ($C$ from $\\mathbb{C}^{(glob)}$)**\n旋转后的四阶张量 $\\mathbb{C}^{(glob)}$ 必须映射回一个与工程应变向量 $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$ 一致的 $3 \\times 3$ 本构矩阵 $C$。$C$ 的分量源自张量关系 $\\sigma_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}$ 和工程关系 $\\sigma=C\\epsilon_{eng}$ 及 $\\gamma_{xy}=2\\varepsilon_{xy}$。这得出了以下映射关系（对伏伊特表示法使用基于 1 的索引，对张量索引 $x,y$ 使用 0,1）：\n- $C_{11} = \\mathbb{C}^{(glob)}_{xxxx}$\n- $C_{22} = \\mathbb{C}^{(glob)}_{yyyy}$\n- $C_{12} = C_{21} = \\mathbb{C}^{(glob)}_{xxyy}$\n- $C_{13} = C_{31} = \\mathbb{C}^{(glob)}_{xxxy}$\n- $C_{23} = C_{32} = \\mathbb{C}^{(glob)}_{yyxy}$\n- $C_{33} = \\mathbb{C}^{(glob)}_{xyxy}$\n由于 $\\mathbb{C}$ 的对称性，最终的矩阵 $C$ 是对称的。\n\n**4. 单元刚度矩阵 ($K_e$)**\n对于线性三角形单元（也称为常应变三角形或 CST），其应变场是恒定的。单元刚度矩阵计算如下：\n$$\nK_e = t \\int_{\\Omega_e} B^\\top C B \\, \\mathrm{d}\\Omega = t A_e B^\\top C B\n$$\n其中 $t$ 是厚度，$A_e$ 是单元面积，$B$ 是应变-位移矩阵。对于具有节点 $(x_1,y_1), (x_2,y_2), (x_3,y_3)$ 的三角形，$B$ 矩阵由下式给出：\n$$\nB = \\frac{1}{2A_e} \\begin{pmatrix}\nb_1  0  b_2  0  b_3  0 \\\\\n0  c_1  0  c_2  0  c_3 \\\\\nc_1  b_1  c_2  b_2  c_3  b_3\n\\end{pmatrix} \\quad\n\\begin{aligned}\nb_i = y_j - y_k \\\\\nc_i = x_k - x_j\n\\end{aligned} \\quad \\text{(循环 } i,j,k \\text{)}\n$$\n$K_e$ 是一个 $6 \\times 6$ 矩阵。\n\n**5. 全局刚度矩阵组装 ($K$)**\n对于此问题，全局刚度矩阵 $K$ 是一个 $8 \\times 8$ 矩阵（4个节点，每个节点2个自由度）。通过遍历所有单元，并将每个单元的 $K_e$ 贡献累加到相应的全局自由度中来组装它。\n\n**6. 应变能计算 ($U$)**\n在组装完全局刚度矩阵 $K$ 后，对于给定的全局节点位移向量 $u$，总应变能 $U$ 计算如下：\n$$\nU = \\frac{1}{2} u^\\top K u\n$$\n节点位移向量是通过在四个节点的坐标处计算指定的位移场 $u(x,y)$ 得到的。\n- 场 A ($u_x = \\epsilon_0 x, u_y = 0$) 得到 $u = [0, 0, \\epsilon_0, 0, \\epsilon_0, 0, 0, 0]^\\top$。\n- 场 B ($u_x = 0, u_y = \\epsilon_0 y$) 得到 $u = [0, 0, 0, 0, 0, \\epsilon_0, 0, \\epsilon_0]^\\top$。\n\n实现将这些步骤合并到一个脚本中，该脚本处理每个测试用例并计算所需的应变能。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the simulation, and print results.\n    \"\"\"\n    # Define geometry and mesh using 0-based indexing for nodes.\n    NODES = np.array([\n        [0.0, 0.0],  # Node 0\n        [1.0, 0.0],  # Node 1\n        [1.0, 1.0],  # Node 2\n        [0.0, 1.0]   # Node 3\n    ])\n    ELEMENTS = np.array([\n        [0, 1, 2],  # Element 0 (nodes (0,0)->(1,0)->(1,1))\n        [0, 2, 3]   # Element 1 (nodes (0,0)->(1,1)->(0,1))\n    ])\n    NUM_NODES = NODES.shape[0]\n    NUM_DOFS = 2 * NUM_NODES\n\n    def get_displacements(epsilon_0):\n        \"\"\"Computes nodal displacements for prescribed fields A and B.\"\"\"\n        u_A = np.zeros(NUM_DOFS)\n        u_B = np.zeros(NUM_DOFS)\n        for i, (x, y) in enumerate(NODES):\n            # Field A: u_x = epsilon_0 * x, u_y = 0\n            u_A[2 * i] = epsilon_0 * x\n            u_A[2 * i + 1] = 0.0\n            # Field B: u_x = 0, u_y = epsilon_0 * y\n            u_B[2 * i] = 0.0\n            u_B[2 * i + 1] = epsilon_0 * y\n        return u_A, u_B\n\n    def build_local_elasticity_tensor(E1, E2, nu12, G12):\n        \"\"\"Builds the local 4th-order plane-stress elasticity tensor.\"\"\"\n        nu21 = nu12 * E2 / E1\n        if 1.0 - nu12 * nu21  1e-12: # Check for stability\n            raise ValueError(\"Material stability condition (1-nu12*nu21 > 0) violated.\")\n        \n        factor = 1.0 / (1.0 - nu12 * nu21)\n        C11 = E1 * factor\n        C22 = E2 * factor\n        C12 = nu12 * E2 * factor\n        \n        C_tensor_loc = np.zeros((2, 2, 2, 2))\n        C_tensor_loc[0, 0, 0, 0] = C11\n        C_tensor_loc[1, 1, 1, 1] = C22\n        C_tensor_loc[0, 0, 1, 1] = C_tensor_loc[1, 1, 0, 0] = C12\n        C_tensor_loc[0, 1, 0, 1] = C_tensor_loc[1, 0, 1, 0] = \\\n        C_tensor_loc[0, 1, 1, 0] = C_tensor_loc[1, 0, 0, 1] = G12\n        return C_tensor_loc\n\n    def rotate_and_map_to_C_matrix(C_tensor_loc, theta_deg):\n        \"\"\"Rotates the elasticity tensor and maps it to a 3x3 constitutive matrix.\"\"\"\n        theta_rad = np.deg2rad(theta_deg)\n        c, s = np.cos(theta_rad), np.sin(theta_rad)\n        Q = np.array([[c, -s], [s, c]])\n        \n        C_tensor_glob = np.einsum('pi,qj,rk,sl,ijkl->pqrs', Q, Q, Q, Q, C_tensor_loc, optimize=True)\n        \n        C_glob_3x3 = np.array([\n            [C_tensor_glob[0, 0, 0, 0], C_tensor_glob[0, 0, 1, 1], C_tensor_glob[0, 0, 0, 1]],\n            [C_tensor_glob[1, 1, 0, 0], C_tensor_glob[1, 1, 1, 1], C_tensor_glob[1, 1, 0, 1]],\n            [C_tensor_glob[0, 1, 0, 0], C_tensor_glob[0, 1, 1, 1], C_tensor_glob[0, 1, 0, 1]]\n        ])\n        return C_glob_3x3\n\n    def calculate_element_stiffness(coords, thickness, C_glob_3x3):\n        \"\"\"Computes the 6x6 element stiffness matrix for a linear triangle.\"\"\"\n        (x1, y1), (x2, y2), (x3, y3) = coords[0], coords[1], coords[2]\n        area = 0.5 * abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n        \n        b1, b2, b3 = y2 - y3, y3 - y1, y1 - y2\n        c1, c2, c3 = x3 - x2, x1 - x3, x2 - x1\n        \n        B = (1.0 / (2.0 * area)) * np.array([\n            [b1, 0, b2, 0, b3, 0],\n            [0, c1, 0, c2, 0, c3],\n            [c1, b1, c2, b2, c3, b3]\n        ])\n        \n        return thickness * area * (B.T @ C_glob_3x3 @ B)\n\n    def process_case(material_props, t, thetas, epsilon_0, compute_fields):\n        \"\"\"Assembles the global stiffness matrix and computes strain energies.\"\"\"\n        C_tensor_loc = build_local_elasticity_tensor(*material_props)\n        K_global = np.zeros((NUM_DOFS, NUM_DOFS))\n        \n        for i, element_nodes in enumerate(ELEMENTS):\n            C_glob_3x3 = rotate_and_map_to_C_matrix(C_tensor_loc, thetas[i])\n            element_coords = NODES[element_nodes]\n            Ke = calculate_element_stiffness(element_coords, t, C_glob_3x3)\n            \n            dof_indices = []\n            for node_idx in element_nodes:\n                dof_indices.extend([2 * node_idx, 2 * node_idx + 1])\n            \n            global_indices = np.ix_(dof_indices, dof_indices)\n            K_global[global_indices] += Ke\n\n        u_A, u_B = get_displacements(epsilon_0)\n        \n        case_results = []\n        if 'A' in compute_fields:\n            U_A = 0.5 * u_A.T @ K_global @ u_A\n            case_results.append(U_A)\n        if 'B' in compute_fields:\n            U_B = 0.5 * u_B.T @ K_global @ u_B\n            case_results.append(U_B)\n        return case_results\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'material': (120e9, 60e9, 0.25, 40e9), 't': 0.01, 'epsilon_0': 1e-3, 'thetas': [0.0, 45.0], 'fields': ['A', 'B']},\n        {'material': (120e9, 60e9, 0.25, 40e9), 't': 0.01, 'epsilon_0': 1e-3, 'thetas': [0.0, 90.0], 'fields': ['A', 'B']},\n        {'material': (200e9, 5e9, 0.20, 3e9), 't': 0.01, 'epsilon_0': 1e-3, 'thetas': [0.0, 90.0], 'fields': ['A']}\n    ]\n\n    all_results = []\n    for case in test_cases:\n        results = process_case(case['material'], case['t'], case['thetas'], case['epsilon_0'], case['fields'])\n        all_results.extend(results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3567978"}]}