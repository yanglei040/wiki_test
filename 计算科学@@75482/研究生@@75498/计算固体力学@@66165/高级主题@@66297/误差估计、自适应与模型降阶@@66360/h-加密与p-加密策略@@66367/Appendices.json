{"hands_on_practices": [{"introduction": "p-refinement通过提高多项式次数来提升精度，但在显式动力学分析中，这种能力并非没有代价。本练习旨在揭示空间离散化与时间积分稳定性之间的深刻联系。通过推导显式中心差分法的时间步长限制，您将亲身体会到，随着多项式次数 $p$ 的增加，为保证数值稳定性，时间步长会受到多么严格的制约 [@problem_id:3569251]。", "problem": "考虑一个均匀杆中的一维线性弹性动力学，其由强形式 $\\rho \\, \\ddot{u}(x,t) = E \\, \\frac{\\partial^{2} u(x,t)}{\\partial x^{2}}$ 控制，定义域被划分为物理尺寸为 $h$ 的单元。使用标准的有限元半离散化方法，采用由 $p$ 次单元多项式组成的连续Galerkin空间（即所谓的 $p$-加密），并假设对半离散系统应用中心差分类型的显式时间积分方法。令 $c = \\sqrt{E/\\rho}$ 表示弹性波速。\n\n任务1：从强形式和Galerkin原理出发，推导半离散系统 $M \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0}$，并用形函数表示质量矩阵 $M$ 和刚度矩阵 $K$。\n\n任务2：在物理尺寸为 $h$ 的单元上，利用一个对 $p$ 次多项式有效的逆不等式，以及矩阵对 $(K,M)$ 的最大广义特征值 $\\omega_{\\max}^{2}$ 的瑞利商表征，推导出一个显式中心差分法的稳定性限制时间步长表达式 $\\Delta t_{\\max}$，该表达式需显示其对 $h$、$c$ 和 $p$ 的依赖关系。引入一个正常数 $C$ 来集合与方法和基相关的常数，使得最终的时间步长表达式形式为 $\\Delta t_{\\max} = \\text{(常数)} \\times \\text{(h, c, p 的函数)}$。\n\n任务3：基于相同的多项式空间，定性研究单元级一致质量矩阵的条件数在 $p$-加密下的变化，并将其与对角质量集中进行对比。你的讨论应基于范数等价以及从参考单元到物理单元的映射，并且必须明确说明条件数是否依赖于 $h$ 以及它如何随 $p$ 缩放。\n\n任务4（计算）：对于一个类似钢的杆，其参数为 $E = 210 \\times 10^{9}$ Pa，$\\rho = 7.8 \\times 10^{3}$ kg/m$^3$，$h = 2.0 \\times 10^{-2}$ m，$p = 6$，以及 $C = 0.6$，使用你推导的表达式计算稳定性限制的时间步长。首先计算 $c = \\sqrt{E/\\rho}$，然后代入你的 $\\Delta t_{\\max}$ 表达式。将你最终的 $\\Delta t_{\\max}$ 数值四舍五入到四位有效数字，并用秒 (s) 表示结果。", "solution": "该问题陈述具有科学依据、良定、客观且自洽，提出了一个计算固体力学中的标准问题。因此，该问题被认为是有效的。我们继续进行解答。\n\n**任务1：半离散系统的推导**\n\n均匀杆中一维线性弹性动力学的控制方程是波动方程的强形式：\n$$\n\\rho \\, \\ddot{u}(x,t) = E \\, \\frac{\\partial^{2} u(x,t)}{\\partial x^{2}} \\quad \\text{for } x \\in \\Omega\n$$\n其中 $\\rho$ 是材料密度，$E$ 是杨氏模量，$u(x,t)$ 是位移场，$\\ddot{u}$ 表示对时间 $t$ 的二阶偏导数。\n\n为使用Galerkin方法推导半离散系统，我们首先建立弱形式。我们将控制方程乘以一个来自容许变分空间 $V$ 的合适的检验函数 $v(x)$，并在空间域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} v(x) \\left( \\rho \\, \\ddot{u}(x,t) - E \\, \\frac{\\partial^{2} u(x,t)}{\\partial x^{2}} \\right) dx = 0 \\quad \\forall v \\in V\n$$\n我们可以将各项分开：\n$$\n\\int_{\\Omega} \\rho \\, v \\, \\ddot{u} \\, dx - \\int_{\\Omega} E \\, v \\, \\frac{\\partial^{2} u}{\\partial x^{2}} \\, dx = 0\n$$\n为了降低空间导数的阶数并将其分布在试探函数 $u$ 和检验函数 $v$ 之间，我们对第二项应用分部积分：\n$$\n\\int_{\\Omega} \\rho \\, v \\, \\ddot{u} \\, dx + \\int_{\\Omega} E \\, \\frac{\\partial v}{\\partial x} \\frac{\\partial u}{\\partial x} \\, dx - \\left[ E \\, v \\, \\frac{\\partial u}{\\partial x} \\right]_{\\partial \\Omega} = 0\n$$\n假设齐次自然边界条件（即边界上牵引力为零）或周期性边界条件，边界项 $\\left[ E \\, v \\, \\frac{\\partial u}{\\partial x} \\right]_{\\partial \\Omega}$ 将消失。于是弱形式为：求 $u(t) \\in V$ 使得对于所有 $v \\in V$：\n$$\n\\int_{\\Omega} \\rho \\, v \\, \\ddot{u} \\, dx + \\int_{\\Omega} E \\, \\frac{\\partial v}{\\partial x} \\frac{\\partial u}{\\partial x} \\, dx = 0\n$$\n在有限元法中，我们在有限维子空间 $V_h \\subset V$ 内逼近连续解 $u(x,t)$。逼近解 $u_h(x,t)$ 表示为基函数 $N_j(x)$ 和与时间相关的节点自由度 $u_j(t)$ 的线性组合：\n$$\nu(x,t) \\approx u_h(x,t) = \\sum_{j=1}^{N_{dof}} N_j(x) u_j(t)\n$$\n检验函数 $v(x)$ 从相同的基中选取，$v(x) = N_i(x)$ for $i=1, \\dots, N_{dof}$。将逼近式代入弱形式得到：\n$$\n\\int_{\\Omega} \\rho \\left( N_i \\right) \\left( \\sum_{j} N_j \\ddot{u}_j(t) \\right) dx + \\int_{\\Omega} E \\left( \\frac{d N_i}{d x} \\right) \\left( \\sum_{j} \\frac{d N_j}{d x} u_j(t) \\right) dx = 0\n$$\n由于此式必须对每个 $i=1, \\dots, N_{dof}$ 都成立，我们可以将其写成一个常微分方程组。根据线性性质，我们可以将求和项移出积分：\n$$\n\\sum_{j} \\left( \\int_{\\Omega} \\rho \\, N_i \\, N_j \\, dx \\right) \\ddot{u}_j(t) + \\sum_{j} \\left( \\int_{\\Omega} E \\, \\frac{d N_i}{d x} \\frac{d N_j}{d x} \\, dx \\right) u_j(t) = 0\n$$\n这是一个 $M \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0}$ 形式的矩阵系统，其中 $\\mathbf{u}$ 是节点位移向量。一致质量矩阵 $M$ 和刚度矩阵 $K$ 的各项由下式给出：\n$$\nM_{ij} = \\int_{\\Omega} \\rho \\, N_i(x) \\, N_j(x) \\, dx\n$$\n$$\nK_{ij} = \\int_{\\Omega} E \\, \\frac{d N_i(x)}{d x} \\frac{d N_j(x)}{d x} \\, dx\n$$\n由于材料是均匀的，$\\rho$ 和 $E$ 是常数，可以从积分中提出。\n\n**任务2：稳定性限制时间步长的推导**\n\n应用于系统 $M\\ddot{\\mathbf{u}} + K\\mathbf{u} = \\mathbf{0}$ 的显式中心差分时间积分格式的稳定性受限于半离散系统的最大固有频率 $\\omega_{\\max}$。稳定性条件是：\n$$\n\\Delta t \\le \\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}}\n$$\n固有频率 $\\omega$ 是广义特征值问题 $K\\mathbf{v} = \\lambda M\\mathbf{v}$ 的特征值 $\\lambda = \\omega^2$ 的平方根。最大特征值 $\\omega_{\\max}^2$ 可以由瑞利商表征：\n$$\n\\omega_{\\max}^2 = \\max_{\\mathbf{v} \\neq \\mathbf{0}} \\frac{\\mathbf{v}^T K \\mathbf{v}}{\\mathbf{v}^T M \\mathbf{v}}\n$$\n回到积分定义，对于任意向量 $\\mathbf{v}$ 及其对应的有限元函数 $v_h(x) = \\sum_i N_i(x) v_i$：\n$$\n\\mathbf{v}^T K \\mathbf{v} = \\int_{\\Omega} E \\left( \\frac{d v_h}{d x} \\right)^2 dx = E \\| v'_{h} \\|_{L^2(\\Omega)}^2\n$$\n$$\n\\mathbf{v}^T M \\mathbf{v} = \\int_{\\Omega} \\rho \\left( v_h \\right)^2 dx = \\rho \\| v_h \\|_{L^2(\\Omega)}^2\n$$\n将这些代入瑞利商并使用 $c^2 = E/\\rho$：\n$$\n\\omega_{\\max}^2 = \\max_{v_h \\in V_h \\setminus \\{0\\}} \\frac{E \\| v'_{h} \\|_{L^2(\\Omega)}^2}{\\rho \\| v_h \\|_{L^2(\\Omega)}^2} = c^2 \\max_{v_h \\in V_h \\setminus \\{0\\}} \\frac{\\| v'_{h} \\|_{L^2(\\Omega)}^2}{\\| v_h \\|_{L^2(\\Omega)}^2}\n$$\n这个比率的最大值由网格能分辨的最高频率模态决定，该模态局限于单个单元。我们在尺寸为 $h$ 的单个物理单元 $\\Omega_e$ 上分析该比率。使用到参考单元 $\\hat{\\Omega} = [-1, 1]$ 的仿射映射，$x(\\xi) = x_c + \\frac{h}{2}\\xi$，我们有 $dx = \\frac{h}{2}d\\xi$ 和 $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\xi}$。范数变换如下：\n$$\n\\| v'_{h} \\|_{L^2(\\Omega_e)}^2 = \\int_{\\Omega_e} \\left( \\frac{d v_h}{d x} \\right)^2 dx = \\int_{-1}^1 \\left( \\frac{2}{h} \\frac{d \\hat{v}_h}{d \\xi} \\right)^2 \\frac{h}{2} d\\xi = \\frac{2}{h} \\| \\hat{v}'_h \\|_{L^2(\\hat{\\Omega})}^2\n$$\n$$\n\\| v_h \\|_{L^2(\\Omega_e)}^2 = \\int_{\\Omega_e} (v_h)^2 dx = \\int_{-1}^1 (\\hat{v}_h)^2 \\frac{h}{2} d\\xi = \\frac{h}{2} \\| \\hat{v}_h \\|_{L^2(\\hat{\\Omega})}^2\n$$\n单元上的比率变为：\n$$\n\\frac{\\| v'_{h} \\|_{L^2(\\Omega_e)}^2}{\\| v_h \\|_{L^2(\\Omega_e)}^2} = \\frac{\\frac{2}{h} \\| \\hat{v}'_h \\|_{L^2(\\hat{\\Omega})}^2}{\\frac{h}{2} \\| \\hat{v}_h \\|_{L^2(\\hat{\\Omega})}^2} = \\frac{4}{h^2} \\frac{\\| \\hat{v}'_h \\|_{L^2(\\hat{\\Omega})}^2}{\\| \\hat{v}_h \\|_{L^2(\\hat{\\Omega})}^2}\n$$\n对于参考单元上的 $p$ 次多项式 $\\hat{v}_h$，一个标准的逆不等式表明，范数的比值是有界的，并且其最大值随多项式次数缩放。具体来说，存在一个常数 $C_{inv}$ 使得：\n$$\n\\max_{\\hat{v}_h \\in P_p(\\hat{\\Omega})} \\frac{\\| \\hat{v}'_h \\|_{L^2(\\hat{\\Omega})}^2}{\\| \\hat{v}_h \\|_{L^2(\\hat{\\Omega})}^2} \\propto p^4\n$$\n我们记此最大值为 $(C_{p} p^2)^2$，其中 $C_p$ 是一个依赖于多项式基的常数。因此：\n$$\n\\omega_{\\max}^2 \\approx c^2 \\frac{4}{h^2} (C_{p} p^2)^2 = \\left( \\frac{2 C_{p} c p^2}{h} \\right)^2\n$$\n这给出 $\\omega_{\\max} \\approx \\frac{2 C_{p} c p^2}{h}$。代入稳定性条件：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}} \\approx \\frac{2}{ \\frac{2 C_{p} c p^2}{h} } = \\frac{1}{C_{p}} \\frac{h}{c p^2}\n$$\n令 $C = 1/C_p$ 为一个集合了所有与方法和基相关的因子的正常数，我们得到所期望的表达式：\n$$\n\\Delta t_{\\max} = C \\frac{h}{c p^2}\n$$\n\n**任务3：单元质量矩阵的条件数**\n\n矩阵的条件数是其对扰动敏感性的度量。对于单元级一致质量矩阵 $M^e$，其条件数 $\\kappa(M^e)$ 是其最大特征值与最小特征值的比值，即 $\\kappa(M^e) = \\lambda_{\\max}(M^e) / \\lambda_{\\min}(M^e)$。\n\n$M^e$ 的各项为 $M^e_{ij} = \\rho \\int_{\\Omega_e} N_i N_j dx$。通过映射到参考单元 $\\hat{\\Omega}$：\n$$\nM^e_{ij} = \\rho \\int_{-1}^1 \\hat{N}_i(\\xi) \\hat{N}_j(\\xi) \\frac{h}{2} d\\xi = \\rho \\frac{h}{2} \\hat{M}_{ij}\n$$\n其中 $\\hat{M}$ 是参考单元质量矩阵。这表明 $M^e = \\rho \\frac{h}{2} \\hat{M}$。由于条件数对于乘以一个正常数是不变的，$\\kappa(M^e) = \\kappa(\\hat{M})$。这证明了单元一致质量矩阵的条件数**与单元尺寸 $h$ 无关**。\n\n对多项式次数 $p$ 的依赖性来自于 $\\kappa(\\hat{M})$。矩阵 $\\hat{M}$ 是参考单元上多项式基函数 $\\{\\hat{N}_i(\\xi)\\}_{i=0}^p$ 关于 $L^2$ 内积的格拉姆矩阵。对于常用的节点拉格朗日基（例如，在等距点或切比雪夫点上），随着 $p$ 的增加，基函数变得越来越相似（即正交性变差）。这种日益增长的线性相关性导致条件数 $\\kappa(\\hat{M})$ 随 $p$ 急剧增加。已知这种增长是超多项式的，通常被认为是**随 $p$ 呈指数增长**。\n\n相比之下，质量集中用一个对角矩阵 $M_L$ 来近似一致质量矩阵 $M$。对于单元级集中质量矩阵 $M_L^e$，一个常见的做法是将行和放在对角线上。对角矩阵的条件数就是最大对角元素与最小对角元素之比。对角元素的形式为 $M_{L,ii}^e = \\rho \\int_{\\Omega_e} N_i(x) dx = \\rho \\frac{h}{2} \\int_{-1}^1 \\hat{N}_i(\\xi) d\\xi$。最大与最小元素之比将取决于节点和基的选择，但对于标准选择（如高斯-洛巴托-勒让德节点），基函数的积分表现良好。最大与最小对角元素之比保持在一个小常数界限内，这实际上使得条件数 $\\kappa(M_L^e)$ 关于多项式次数 $p$ 是 $\\mathcal{O}(1)$ 阶的。与一致质量矩阵一样，其条件数也**与 $h$ 无关**。\n\n总之，对于单元级质量矩阵：\n- **一致质量矩阵**：$\\kappa(M^e)$ 与 $h$ 无关，但随 $p$ 呈指数增长，导致高阶单元出现严重的病态问题。\n- **集中质量矩阵**：$\\kappa(M_L^e)$ 与 $h$ 无关，且关于 $p$ 是 $\\mathcal{O}(1)$ 阶的，使其在 $p$-加密方面具有更强的数值鲁棒性。\n\n**任务4：计算**\n\n给定以下数值：\n杨氏模量，$E = 210 \\times 10^{9}$ Pa\n密度，$\\rho = 7.8 \\times 10^{3}$ kg/m$^3$\n单元尺寸，$h = 2.0 \\times 10^{-2}$ m\n多项式次数，$p = 6$\n常数，$C = 0.6$\n\n首先，我们计算弹性波速 $c$：\n$$\nc = \\sqrt{\\frac{E}{\\rho}} = \\sqrt{\\frac{210 \\times 10^{9}}{7.8 \\times 10^{3}}} = \\sqrt{\\frac{210}{7.8} \\times 10^6} \\approx \\sqrt{26.9230769 \\times 10^6} \\approx 5188.7452 \\text{ m/s}\n$$\n接下来，我们使用推导出的稳定性限制时间步长表达式 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = C \\frac{h}{c p^2}\n$$\n代入给定值：\n$$\n\\Delta t_{\\max} = (0.6) \\frac{2.0 \\times 10^{-2}}{ (5188.7452) \\times 6^2 }\n$$\n$$\n\\Delta t_{\\max} = \\frac{1.2 \\times 10^{-2}}{ (5188.7452) \\times 36 } = \\frac{1.2 \\times 10^{-2}}{ 186794.827 }\n$$\n$$\n\\Delta t_{\\max} \\approx 6.42420 \\times 10^{-8} \\text{ s}\n$$\n将结果四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{\\max} \\approx 6.424 \\times 10^{-8} \\text{ s}\n$$", "answer": "$$\n\\boxed{6.424 \\times 10^{-8}}\n$$", "id": "3569251"}, {"introduction": "在了解了p-refinement的挑战之后，我们来探索一个它能大放异彩的应用场景。本练习将带您解决实体力学中的一个典型难题——近不可压缩材料的体积锁定，并展示如何通过提高多项式次数来有效缓解这一数值病态。您将通过一个计算实验，直观地比较高阶单元与低阶单元在处理该问题上的性能差异，并理解为何p-refinement是一种优雅的解决方案 [@problem_id:3569277]。", "problem": "考虑一个占据域 $[0,1]\\times[0,1]$ 米的二维平面应变超弹性块。该材料遵循可压缩 Neo-Hookean 模型，在小应变极限下，该模型简化为线性弹性模型，其拉梅参数 $\\lambda$ 和 $\\mu$ 由 $\\mu = E/(2(1+\\nu))$ 和 $\\lambda = \\nu E/((1+\\nu)(1-2\\nu))$ 给出，其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。取 $E = 1$ 帕斯卡，并研究当 $\\nu \\to 0.5$ 时的近不可压缩极限。对于近不可压缩材料，体积锁定是有限元法 (FEM) 中一个已知的数值病态问题。一种缓解技术是选择性减缩积分 (SRI)，该技术使用减缩求积来计算对刚度的体积贡献，同时保持偏量贡献的完全积分。\n\n您将在一个固定的 $2\\times 2$ 四边形单元网格上实现一个有限元求解器，每个单元使用次数为 $p$ 的张量积拉格朗日多项式基（记作 $Q_p$）。网格建立在具有直边的单位正方形域上。几何映射是双线性的。位移场有两个分量，并假定为平面应变。\n\n边界条件和载荷如下：\n- 位于 $x=0$ 的左边界被夹紧：$u_x=0$ 和 $u_y=0$。\n- 在位于 $x=1$ 的右边界上施加一个均匀的剪切牵引力，其牵引力为 $\\mathbf{t} = [0, t_0]$ 牛顿/米，其中 $t_0 = 1$。所有其他边界均无牵引力。\n\n在小应变极限下，本构律为平面应变线性弹性张量 $\\mathbf{D}$ 作用于应变向量 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$，从而得到应力向量 $\\boldsymbol{\\sigma} = \\mathbf{D}\\boldsymbol{\\varepsilon}$。写作\n$$\n\\mathbf{D} = \\mathbf{D}_{\\text{dev}} + \\mathbf{D}_{\\text{vol}},\n$$\n其中\n$$\n\\mathbf{D}_{\\text{dev}} = \\begin{bmatrix} 2\\mu  0  0 \\\\ 0  2\\mu  0 \\\\ 0  0  \\mu \\end{bmatrix}, \\quad\n\\mathbf{D}_{\\text{vol}} = \\begin{bmatrix} \\lambda  \\lambda  0 \\\\ \\lambda  \\lambda  0 \\\\ 0  0  0 \\end{bmatrix}.\n$$\n选择性减缩积分 (SRI) 的实现方法是：使用对 $Q_p$ 足够阶数的高斯-勒让德求积对 $\\mathbf{D}_{\\text{dev}}$ 的刚度贡献进行积分，并使用单元中心的一个高斯点对 $\\mathbf{D}_{\\text{vol}}$ 的贡献进行积分。完全积分则对整个 $\\mathbf{D}$ 使用同样足够精确的高斯-勒让德求积。\n\n令 $u_{\\text{tip}}(p,\\nu)$ 表示在多项式次数为 $p$ 和泊松比为 $\\nu$ 的情况下，使用完全积分计算出的右上角 $(x=1,y=1)$ 的垂直位移。令 $u_{\\text{tip}}^{\\text{SRI}}(p_{\\max},\\nu)$ 表示使用高多项式次数 $p_{\\max}$ 和 SRI 计算出的相同物理量，该值将作为无锁定参考。定义相对差异\n$$\n\\delta(p,\\nu) = \\left|\\frac{u_{\\text{tip}}(p,\\nu) - u_{\\text{tip}}^{\\text{SRI}}(p_{\\max},\\nu)}{u_{\\text{tip}}^{\\text{SRI}}(p_{\\max},\\nu)}\\right|.\n$$\n对于一个固定的 $\\nu$，将阈值多项式次数 $p_{\\text{lock-free}}(\\nu)$ 定义为集合 $\\{1,2,3,4,5,6\\}$ 中满足 $\\delta(p,\\nu) \\le \\tau$ 的最小 $p$，其中容差 $\\tau = 0.02$。如果集合中不存在这样的 $p$，则报告 -1。\n\n从无体力情况下的线性动量平衡和小应变运动学出发，\n$$\n\\nabla\\cdot \\boldsymbol{\\sigma} = \\mathbf{0}, \\quad \\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T),\n$$\n推导离散有限元方程，并在指定的网格上实现完全积分和 SRI 的全局刚度矩阵和载荷向量的组装。对于 $Q_p$ 单元的完全积分，每个方向使用 $n=p$ 个点的高斯-勒让德求积。应用指定的边界条件，求解得到的线性系统，并提取 $u_{\\text{tip}}$ 和 $u_{\\text{tip}}^{\\text{SRI}}$。\n\n内部所有位移以米为单位表示，但最终输出必须是如下所述的无单位整数。角度单位不适用于此问题。\n\n测试组：\n- 情况 1：$\\nu = 0.30$。\n- 情况 2：$\\nu = 0.49$。\n- 情况 3：$\\nu = 0.499$。\n- 情况 4：$\\nu = 0.4999$。\n\n对于所有情况，按规定使用 $E = 1$ 和 $t_0 = 1$。使用 $p_{\\max} = 6$ 来计算 $u_{\\text{tip}}^{\\text{SRI}}$。对于每个测试情况，根据定义计算 $p_{\\text{lock-free}}(\\nu)$，容差为 $\\tau = 0.02$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按测试组顺序排列的结果，以逗号分隔并用方括号括起，即 $[p_{\\text{lock-free}}(0.30), p_{\\text{lock-free}}(0.49), p_{\\text{lock-free}}(0.499), p_{\\text{lock-free}}(0.4999)]$。", "solution": "该问题是有效的，因为它科学地基于计算固体力学的原理，是适定的，并且所有必要的参数和条件都已客观地指定。我们将基于有限元法（FEM）进行详细求解。\n\n在没有体力的情况下，静态平衡的控制方程是线性动量平衡：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0} \\quad \\text{in } \\Omega\n$$\n其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\Omega = [0,1] \\times [0,1]$ 是域。问题指定了位移 $\\mathbf{u}$ 和牵引力 $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ 的边界条件。\n应变 $\\boldsymbol{\\varepsilon}$ 和位移 $\\mathbf{u}$ 之间的关系由小应变运动学给出：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)\n$$\n材料遵循线性弹性本构律 $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$，其中对于平面应变，应力向量和应变向量分别为 $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^T$ 和 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$。平面应变刚度矩阵 $\\mathbf{D}$ 为：\n$$\n\\mathbf{D} = \\begin{bmatrix} \\lambda+2\\mu  \\lambda  0 \\\\ \\lambda  \\lambda+2\\mu  0 \\\\ 0  0  \\mu \\end{bmatrix}\n$$\n其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，根据杨氏模量 $E$ 和泊松比 $\\nu$ 定义。\n\n控制方程的弱形式是通过乘以一个测试函数 $\\mathbf{v}$（代表虚位移）并在域 $\\Omega$ 上积分得到的：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{v} \\, d\\Omega = 0\n$$\n利用散度定理和应力张量的对称性，可以得到虚功原理：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega = \\int_{\\Gamma_t} \\mathbf{t} \\cdot \\mathbf{v} \\, d\\Gamma\n$$\n其中 $\\boldsymbol{\\varepsilon}(\\mathbf{v})$ 是从测试函数 $\\mathbf{v}$ 导出的应变，右侧表示外牵引力在边界 $\\Gamma_t$ 上所做的功。\n\n在有限元法中，域 $\\Omega$ 被离散化为单元 $\\Omega_e$。在每个单元内，位移场 $\\mathbf{u}$ 被近似为：\n$$\n\\mathbf{u}(\\mathbf{x}) \\approx \\mathbf{u}^h(\\mathbf{x}) = \\sum_{a=1}^{N_{en}} N_a(\\mathbf{x}) \\mathbf{d}_a\n$$\n其中 $N_a$ 是形函数，$\\mathbf{d}_a = [d_{ax}, d_{ay}]^T$ 是单元第 $a$ 个节点的节点位移向量，$N_{en}$ 是每个单元的节点数。对于 $Q_p$ 单元，$N_{en} = (p+1)^2$。测试函数 $\\mathbf{v}$ 也以类似的方式近似。\n\n应变向量可以表示为节点位移的函数：\n$$\n\\boldsymbol{\\varepsilon} = \\sum_{a=1}^{N_{en}} \\mathbf{B}_a \\mathbf{d}_a\n$$\n其中矩阵 $\\mathbf{B}_a$ 将应变与节点位移联系起来，并包含形函数的导数：\n$$\n\\mathbf{B}_a = \\begin{bmatrix} \\frac{\\partial N_a}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_a}{\\partial y} \\\\ \\frac{\\partial N_a}{\\partial y}  \\frac{\\partial N_a}{\\partial x} \\end{bmatrix}\n$$\n这些导数是通过链式法则以及从具有坐标 $(\\xi, \\eta)$ 的参考单元 $[-1,1]^2$ 到物理单元的等参坐标变换的雅可比矩阵计算的。对于指定的直边矩形网格，该雅可比矩阵在每个单元内是常数。\n\n将离散化的场代入弱形式，并注意到它必须对任何有效的虚节点位移选择都成立，从而为每个单元导出一个线性方程组：\n$$\n\\mathbf{k}^e \\mathbf{d}^e = \\mathbf{f}^e\n$$\n单元刚度矩阵 $\\mathbf{k}^e$ 和力向量 $\\mathbf{f}^e$ 由以下公式给出：\n$$\n\\mathbf{k}^e = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, d\\Omega, \\quad \\mathbf{f}^e = \\int_{\\Gamma_e} \\mathbf{N}^T \\mathbf{t} \\, d\\Gamma\n$$\n其中 $\\mathbf{B}$ 和 $\\mathbf{N}$ 是收集单元中所有节点贡献的矩阵。\n\n积分使用高斯-勒让德求积进行数值计算。对于完全积分，单元刚度矩阵为：\n$$\n\\mathbf{k}^e_{\\text{full}} = \\sum_{i=1}^{n_{gp}} w_i (\\mathbf{B}(\\boldsymbol{\\xi}_i))^T \\mathbf{D} \\mathbf{B}(\\boldsymbol{\\xi}_i) |\\mathbf{J}(\\boldsymbol{\\xi}_i)|\n$$\n其中 $\\boldsymbol{\\xi}_i$ 是高斯点，$w_i$ 是权重，$|\\mathbf{J}|$ 是雅可比矩阵的行列式，$n_{gp}=p \\times p$ 是高斯点的数量。\n\n对于选择性减缩积分 (SRI)，刚度矩阵 $\\mathbf{D}$ 被分解为问题中定义的偏量部分 $\\mathbf{D}_{\\text{dev}}$ 和体积部分 $\\mathbf{D}_{\\text{vol}}$。单元刚度计算如下：\n$$\n\\mathbf{k}^e_{\\text{SRI}} = \\mathbf{k}^e_{\\text{dev}} + \\mathbf{k}^e_{\\text{vol}}\n$$\n$$\n\\mathbf{k}^e_{\\text{dev}} = \\sum_{i=1}^{p \\times p} w_i (\\mathbf{B}(\\boldsymbol{\\xi}_i))^T \\mathbf{D}_{\\text{dev}} \\mathbf{B}(\\boldsymbol{\\xi}_i) |\\mathbf{J}(\\boldsymbol{\\xi}_i)|\n$$\n$$\n\\mathbf{k}^e_{\\text{vol}} = \\left( \\sum_{j=1}^{1 \\times 1} w_j |\\mathbf{J}(\\boldsymbol{\\xi}_j)| \\right) (\\bar{\\mathbf{B}})^T \\mathbf{D}_{\\text{vol}} \\bar{\\mathbf{B}}\n$$\n其中偏量部分使用完整的 $p \\times p$ 求积法则进行积分，而体积部分则在单元中心 $(\\xi_j=(0,0))$ 使用单点积分。$\\bar{\\mathbf{B}}$ 是在此中心点计算的 $\\mathbf{B}$ 矩阵。\n\n通过对所有四个单元的贡献求和，组装成全局刚度矩阵 $\\mathbf{K}$ 和力向量 $\\mathbf{F}$。然后应用指定的边界条件。在 $x=0$ 处的夹紧条件（$u_x=u_y=0$）是本质边界条件，通过修改线性系统来强制执行。在 $x=1$ 处的剪切牵引力是自然边界条件，通过为该边界上的单元组装单元力向量 $\\mathbf{f}^e$ 来处理。\n\n在施加边界条件后，求解全局线性系统 $\\mathbf{K}\\mathbf{d}=\\mathbf{F}$，以获得所有节点位移的向量 $\\mathbf{d}$。然后从对应于物理坐标 $(1,1)$ 的节点处的 $\\mathbf{d}$ 中提取所需的尖端垂直位移 $u_{\\text{tip}}$。\n\n步骤如下：\n1. 对于测试组中的每个 $\\nu$，通过运行 $p=p_{\\max}=6$ 和 SRI 的有限元求解器，计算参考位移 $u_{\\text{tip}}^{\\text{SRI}}(p_{\\max},\\nu)$。\n2. 对于相同的 $\\nu$，遍历 $p \\in \\{1, 2, 3, 4, 5, 6\\}$。\n3. 在每次迭代中，使用完全积分计算 $u_{\\text{tip}}(p, \\nu)$。\n4. 计算相对差异 $\\delta(p,\\nu)$。\n5. 第一个使得 $\\delta(p, \\nu)$ 小于或等于容差 $\\tau=0.02$ 的 $p$ 值被记录为 $p_{\\text{lock-free}}(\\nu)$。如果找不到这样的 $p$，结果为 -1。\n对测试组中的所有 $\\nu$ 值重复此过程，以生成最终的输出列表。", "answer": "$$\n\\boxed{[1, 2, 4, 6]}\n$$", "id": "3569277"}, {"introduction": "理解了h-refinement和p-refinement各自的优缺点后，关键问题是如何在计算中自动地做出最优选择。本练习将引导您探索hp自适应方法的核心思想：通过分析分层多项式基的系数衰减规律，来估计解的局部光滑度。您需要构建一个无量纲指标，它能够可靠地区分解析性行为（适用p-refinement）和代数性行为（适用h-refinement），从而为智能网格自适应策略奠定理论基础 [@problem_id:3569257]。", "problem": "考虑一个在一维单元网格上定义的线性弹性模型问题，其中在每个单元上，局部有限元近似在一个分层正交多项式基（例如，归一化勒让德多项式）中表示为 $u_h(x)|_E = \\sum_{k=0}^{p} a_k \\,\\phi_k(x)$，其系数 $\\{a_k\\}$ 通过正交投影计算得到。在有限元方法（FEM）中，进行自适应网格尺寸加密（h-加密）和多项式次数提升（p-加密）时，一种常见的策略是根据每个单元上分层系数 $\\{|a_k|\\}$ 的衰减来推断精确解的局部正则性。\n\n使用谱近似理论中以下经过充分检验的事实作为基本依据：\n- 如果精确解在单元的邻域内是解析的，那么对于足够大的 $k$，模态系数的渐近形式为 $|a_k| \\sim C \\,\\rho^{-k} k^{\\sigma}$，其中常数 $C0$，$\\rho1$ 且 $\\sigma \\in \\mathbb{R}$。\n- 如果精确解仅具有局部有限的索博列夫正则性（例如，由于附近的奇点），其系数满足 $|a_k| \\sim C' \\, k^{-\\beta}$（其中常数 $C'0$ 且 $\\beta0$），则衰减是代数的。\n\n在一个当前多项式次数为 $p \\geq 3$ 的单元 $E$ 上，您只能获取最后三个非零模态的幅值 $\\{|a_{p-2}|, |a_{p-1}|, |a_p|\\}$。您的任务是：\n- 从上述渐近模型出发，构造一个无量纲指标 $\\Psi_p$，该指标仅使用 $\\{|a_{p-2}|, |a_{p-1}|, |a_p|\\}$，并且对于解析行为，它渐近收敛到一个严格为正的常数，而对于代数行为，它渐近收敛到零，从而能够在没有任何未知尺度因子（如 $C$ 或 $C'$）的情况下，在 h-加密和 p-加密之间做出可靠的局部决策。\n- 根据您的构造，推导临界判别阈值 $T_{\\star}$ 的封闭形式表达式，使得对于代数衰减，渐近地有 $\\Psi_p \\to T_{\\star}$，而对于解析衰减，有 $\\Psi_p \\to T_{\\star} + \\Delta$（其中 $\\Delta0$）。请用文字陈述加密逻辑，但您的最终答案必须是 $T_{\\star}$ 的单一封闭形式值。\n\n您的指标和中间推理过程应完全用 $\\{|a_{p-2}|, |a_{p-1}|, |a_p|\\}$ 和 $p$ 来表示。不得使用其他数据。最终答案必须是一个实数。无需四舍五入。", "solution": "该问题要求构造一个无量纲指标 $\\Psi_p$，用于基于分层有限元系数的渐近衰减来区分代数和解析解的行为。该指标必须是最后三个可用系数幅值 $\\{|a_{p-2}|, |a_{p-1}|, |a_p|\\}$ 和多项式次数 $p$ 的函数。基于此构造，我们必须推导出临界判别阈值 $T_{\\star}$。\n\n两种渐近衰减类型如下：\n1.  **解析行为：** $|a_k| \\sim C \\rho^{-k} k^{\\sigma}$，其中常数 $C0$，$\\rho1$，$\\sigma \\in \\mathbb{R}$。这是一种指数衰减，主要由 $\\rho^{-k}$ 项决定。\n2.  **代数行为：** $|a_k| \\sim C' k^{-\\beta}$，其中常数 $C'0$，$\\beta0$。\n\n区分这两种行为的一个稳健方法是在对数尺度上分析系数序列的性质。让我们考虑 $\\ln|a_k|$ 和 $\\ln k$ 之间的关系。\n\n对于代数衰减，我们有：\n$$ \\ln|a_k| \\sim \\ln(C' k^{-\\beta}) = \\ln C' - \\beta \\ln k $$\n这表明对于大的 $k$，$\\ln|a_k|$ 和 $\\ln k$ 之间存在线性关系，斜率为 $-\\beta$。\n\n对于解析衰减，我们有：\n$$ \\ln|a_k| \\sim \\ln(C \\rho^{-k} k^{\\sigma}) = \\ln C - k \\ln \\rho + \\sigma \\ln k $$\n由于存在 $-k \\ln \\rho$ 项，该关系在 $\\ln k$ 中不是线性的。\n\n在对数-对数图上，这种线性度的差异为我们的指标提供了基础。一条直线的曲率为零。我们可以构造一个指标来近似序列 $(\\ln k, \\ln|a_k|)$ 的曲率。让我们使用有限差分在对数-对数图上定义一个离散斜率 $S_k$：\n$$ S_k = \\frac{\\ln|a_k| - \\ln|a_{k-1}|}{\\ln k - \\ln(k-1)} = \\frac{\\ln(|a_k|/|a_{k-1}|)}{\\ln(k/(k-1))} $$\n对于纯代数衰减 $|a_k| = C'k^{-\\beta}$，该斜率为常数：\n$$ S_k = \\frac{\\ln((C'k^{-\\beta})/(C'(k-1)^{-\\beta}))}{\\ln(k/(k-1))} = \\frac{-\\beta \\ln(k/(k-1))}{\\ln(k/(k-1))} = -\\beta $$\n可以通过计算连续斜率 $S_{p-1}$ 和 $S_p$ 的差值来形成一个离散的曲率度量。为满足问题要求，即指标在解析情况下为正，我们将指标 $\\Psi_p$ 定义为：\n$$ \\Psi_p = S_{p-1} - S_p = \\frac{\\ln(|a_{p-1}|/|a_{p-2}|)}{\\ln((p-1)/(p-2))} - \\frac{\\ln(|a_p|/|a_{p-1}|)}{\\ln(p/(p-1))} $$\n该指标是无量纲的，并使用了指定的三个系数幅值 $\\{|a_{p-2}|, |a_{p-1}|, |a_p|\\}$ 和次数 $p$。\n\n现在，我们分析在两种情况下，当 $p$ 很大时 $\\Psi_p$ 的渐近行为。\n\n**情况1：代数衰减**\n如前所述，对于模型 $|a_k| = C' k^{-\\beta}$，我们有对所有 $k$ 均成立的 $S_k = -\\beta$。因此，对于这个理想化模型，\n$$ \\Psi_p = S_{p-1} - S_p = (-\\beta) - (-\\beta) = 0 $$\n对于渐近形式 $|a_k| \\sim C'k^{-\\beta}$，渐近展开中的高阶项将导致当 $p \\to \\infty$ 时 $\\Psi_p$ 趋近于 $0$。因此，对于代数衰减，渐近极限为 $0$。\n$$ \\lim_{p\\to\\infty} \\Psi_p = 0 $$\n\n**情况2：解析衰减**\n对于解析衰减， $|a_k| \\sim C \\rho^{-k} k^{\\sigma}$。斜率 $S_k$ 为：\n$$ S_k = \\frac{\\ln((C\\rho^{-k}k^{\\sigma})/(C\\rho^{-(k-1)}(k-1)^{\\sigma}))}{\\ln(k/(k-1))} = \\frac{-\\ln\\rho + \\sigma\\ln(k/(k-1))}{\\ln(k/(k-1))} = \\sigma - \\frac{\\ln\\rho}{\\ln(k/(k-1))} $$\n那么指标 $\\Psi_p$ 为：\n$$ \\Psi_p = S_{p-1} - S_p = \\left(\\sigma - \\frac{\\ln\\rho}{\\ln((p-1)/(p-2))}\\right) - \\left(\\sigma - \\frac{\\ln\\rho}{\\ln(p/(p-1))}\\right) = \\ln\\rho \\left( \\frac{1}{\\ln(p/(p-1))} - \\frac{1}{\\ln((p-1)/(p-2))} \\right) $$\n为了求 $p \\to \\infty$ 时的极限，我们分析 $f(k) = 1/\\ln(k/(k-1))$ 这一项。令 $x = 1/(k-1)$。当 $k \\to \\infty$ 时，$x \\to 0$。\n$$ \\ln\\left(\\frac{k}{k-1}\\right) = \\ln\\left(1+\\frac{1}{k-1}\\right) = \\ln(1+x) = x - \\frac{x^2}{2} + O(x^3) $$\n$$ f(k) = \\frac{1}{x - \\frac{x^2}{2} + O(x^3)} = \\frac{1}{x} \\left( \\frac{1}{1 - \\frac{x}{2} + O(x^2)} \\right) = \\frac{1}{x} \\left( 1 + \\frac{x}{2} + O(x^2) \\right) = \\frac{1}{x} + \\frac{1}{2} + O(x) $$\n将 $x = 1/(k-1)$ 代回：\n$$ f(k) = (k-1) + \\frac{1}{2} + O\\left(\\frac{1}{k}\\right) = k - \\frac{1}{2} + O\\left(\\frac{1}{k}\\right) $$\n现在我们可以计算 $\\Psi_p$ 的极限：\n$$ \\lim_{p\\to\\infty} \\Psi_p = \\lim_{p\\to\\infty} \\ln\\rho \\left( f(p) - f(p-1) \\right) $$\n$$ \\lim_{p\\to\\infty} \\Psi_p = \\lim_{p\\to\\infty} \\ln\\rho \\left( \\left[p - \\frac{1}{2} + O\\left(\\frac{1}{p}\\right)\\right] - \\left[(p-1) - \\frac{1}{2} + O\\left(\\frac{1}{p-1}\\right)\\right] \\right) $$\n$$ \\lim_{p\\to\\infty} \\Psi_p = \\lim_{p\\to\\infty} \\ln\\rho \\left( p - \\frac{1}{2} - p + 1 + \\frac{1}{2} + O\\left(\\frac{1}{p}\\right) \\right) = \\lim_{p\\to\\infty} \\ln\\rho \\left( 1 + O\\left(\\frac{1}{p}\\right) \\right) = \\ln\\rho $$\n因为 $\\rho1$，所以极限 $\\ln\\rho$ 是一个严格为正的常数。\n\n**结论与加密逻辑**\n我们构造的指标 $\\Psi_p$ 具有以下渐近极限：\n- 对于代数衰减：$\\lim_{p\\to\\infty} \\Psi_p = 0$。\n- 对于解析衰减：$\\lim_{p\\to\\infty} \\Psi_p = \\ln\\rho  0$。\n\n这满足了问题的要求。临界判别阈值 $T_{\\star}$ 的表达式被定义为 $\\Psi_p$ 在代数衰减情况下的渐近极限。\n$$ T_{\\star} = \\lim_{p\\to\\infty, \\text{algebraic}} \\Psi_p = 0 $$\n对于解析衰减，极限为 $T_{\\star} + \\Delta = 0 + \\ln\\rho$，其中 $\\Delta = \\ln\\rho  0$，与问题陈述一致。\n\n加密逻辑如下：在每个单元上，计算 $\\Psi_p$。如果 $\\Psi_p$ 的值接近 $T_{\\star} = 0$，则推断解具有较低的正则性（代数收敛），此时适合采用 h-加密（网格细分）策略。如果 $\\Psi_p$ 显著大于 $0$，则推断解是解析的，此时采用 p-加密（提高多项式次数）是实现快速收敛的更有效策略。\n\n问题要求给出 $T_{\\star}$ 的单一封闭形式值。根据我们的构造和分析，该值为 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3569257"}]}