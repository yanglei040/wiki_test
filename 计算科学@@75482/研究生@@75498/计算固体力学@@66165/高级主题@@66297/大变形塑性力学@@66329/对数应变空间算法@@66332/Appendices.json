{"hands_on_practices": [{"introduction": "任何本构模型的核心在于它如何将变形与应力联系起来。在对数应变空间中，这种关系对于各向同性材料而言尤其简洁明了。本练习旨在探索超弹性模型中体积（改变体积）响应与偏量（改变形状）响应的基本解耦 [@problem_id:3579134]。通过对两种纯变形模式的分析，您将巩固对材料参数（如体积模量 $K$ 和剪切模量 $G$）如何控制不同物理行为的理解，这是材料建模的基石。", "problem": "考虑一个在对数应变空间中建模的可压缩、各向同性、超弹性固体。令 $F$ 表示变形梯度，其极分解为 $F = R V$，其中 $R$ 是一个正常正交张量，$V$ 是左拉伸张量。对数 (Hencky) 应变定义为 $E = \\ln V$。任意二阶张量 $X$ 的偏量部分和体积部分分别定义为 $X_{\\mathrm{dev}} = X - \\frac{1}{3} \\operatorname{tr}(X) I$ 和 $X_{\\mathrm{vol}} = \\frac{1}{3} \\operatorname{tr}(X) I$。假设一个关于 $E$ 的二次、各向同性 Helmholtz 自由能密度形式为 $W(E) = \\frac{K}{2} \\left(\\operatorname{tr} E\\right)^{2} + G \\, E_{\\mathrm{dev}} : E_{\\mathrm{dev}}$，其中 $K$ 是体积模量，$G$ 是剪切模量，两者均为严格正值。Kirchhoff 应力 $\\tau$ 与 $E$ 在功上共轭，即对于弹性过程有 $\\mathrm{d} W = \\tau : \\mathrm{d} E$。\n\n考虑两种均匀变形：\n\n1. 由 $F_{v} = J_{v}^{1/3} I$ 指定的纯体积膨胀，其中 $J_{v} > 1$。\n2. 由主拉伸比为 $\\lambda_{s}$、$\\lambda_{s}^{-1}$ 和 $1$ 的左拉伸指定的等体积纯剪切拉伸，其中 $\\lambda_{s} > 1$。\n\n从上述定义和假设出发，并且不使用任何未经证明的简化公式，完成以下任务：\n\n- 基于给定的 $W(E)$，推导 $\\tau$ 关于 $E$ 及其偏量和体积部分的本构关系。\n- 对每种变形，显式计算 $E$ 和 $\\tau$ 的偏量和体积部分，并在适当时在主基底下表示。\n- 简要解释每种情况下结果的物理一致性，特别是关于 $K$ 和 $G$ 的作用。\n\n最后，定义标量比\n$$\nR := \\frac{\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\|}{\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\|},\n$$\n其中 $\\|\\cdot\\|$ 表示 Frobenius 范数，$\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}$ 是纯剪切拉伸的偏量 Kirchhoff 应力，$\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}$ 是纯体积膨胀的 Kirchhoff 应力的体积部分。将 $R$ 表示为关于 $K$、$G$、$\\lambda_{s}$ 和 $J_{v}$ 的闭式解析表达式。将此最终表达式作为您的答案。不要近似计算；无需四舍五入。最终答案是无量纲的，必须不带单位给出。", "solution": "问题陈述经验证具有科学依据，是适定的、客观的且自洽的。它基于连续介质力学和超弹性理论的既定原理。所提供的定义和条件足以且一致地推导出唯一解。\n\n第一步是从给定的 Helmholtz 自由能密度 $W(E)$ 推导 Kirchhoff 应力 $\\tau$ 的本构关系。自由能由下式给出\n$$\nW(E) = \\frac{K}{2} (\\operatorname{tr} E)^2 + G \\, E_{\\mathrm{dev}} : E_{\\mathrm{dev}}\n$$\n其中 $E$ 是对数应变，$K > 0$ 是体积模量，$G > 0$ 是剪切模量。$E$ 的偏量部分是 $E_{\\mathrm{dev}} = E - \\frac{1}{3} \\operatorname{tr}(E) I$。Kirchhoff 应力 $\\tau$ 与 $E$ 在功上共轭，意味着 $\\tau = \\frac{\\partial W}{\\partial E}$。我们可以通过考虑微分 $\\mathrm{d}W$ 来计算这个导数。\n\n$W$ 的全微分是 $\\mathrm{d}W = \\frac{\\partial W}{\\partial E} : \\mathrm{d}E$。我们计算 $W$ 的每一项的微分。\n\n对于第一项，即体积部分 $W_{\\mathrm{vol}} = \\frac{K}{2}(\\operatorname{tr} E)^2$:\n$$\n\\mathrm{d}W_{\\mathrm{vol}} = \\frac{K}{2} \\cdot 2(\\operatorname{tr} E) \\cdot \\mathrm{d}(\\operatorname{tr} E) = K(\\operatorname{tr} E) \\operatorname{tr}(\\mathrm{d}E)\n$$\n由于 $\\operatorname{tr}(\\mathrm{d}E) = I : \\mathrm{d}E$，我们有\n$$\n\\mathrm{d}W_{\\mathrm{vol}} = K(\\operatorname{tr} E) (I : \\mathrm{d}E) = (K(\\operatorname{tr} E) I) : \\mathrm{d}E\n$$\n这意味着应力的体积部分是 $\\tau_{\\mathrm{vol}} = \\frac{\\partial W_{\\mathrm{vol}}}{\\partial E} = K(\\operatorname{tr} E) I$。\n\n对于第二项，即偏量部分 $W_{\\mathrm{dev}} = G E_{\\mathrm{dev}} : E_{\\mathrm{dev}}$:\n$$\n\\mathrm{d}W_{\\mathrm{dev}} = G \\,\\mathrm{d}(E_{\\mathrm{dev}} : E_{\\mathrm{dev}}) = G (2 E_{\\mathrm{dev}} : \\mathrm{d}E_{\\mathrm{dev}})\n$$\n偏应变的微分是 $\\mathrm{d}E_{\\mathrm{dev}} = \\mathrm{d}(E - \\frac{1}{3}\\operatorname{tr}(E)I) = \\mathrm{d}E - \\frac{1}{3}\\mathrm{d}(\\operatorname{tr}(E))I = \\mathrm{d}E - \\frac{1}{3}(\\operatorname{tr}(\\mathrm{d}E))I$。\n将此代入 $\\mathrm{d}W_{\\mathrm{dev}}$ 的表达式中：\n$$\n\\mathrm{d}W_{\\mathrm{dev}} = 2G E_{\\mathrm{dev}} : \\left(\\mathrm{d}E - \\frac{1}{3}(\\operatorname{tr}(\\mathrm{d}E))I\\right) = 2G (E_{\\mathrm{dev}} : \\mathrm{d}E) - \\frac{2G}{3}(\\operatorname{tr}(\\mathrm{d}E))(E_{\\mathrm{dev}} : I)\n$$\n偏量张量的迹为零，所以 $E_{\\mathrm{dev}} : I = \\operatorname{tr}(E_{\\mathrm{dev}}) = 0$。因此，第二项消失。\n$$\n\\mathrm{d}W_{\\mathrm{dev}} = (2G E_{\\mathrm{dev}}) : \\mathrm{d}E\n$$\n这意味着应力的偏量部分是 $\\tau_{\\mathrm{dev}} = \\frac{\\partial W_{\\mathrm{dev}}}{\\partial E} = 2G E_{\\mathrm{dev}}$。\n\n结合体积部分和偏量部分，总的 Kirchhoff 应力为\n$$\n\\tau = \\tau_{\\mathrm{vol}} + \\tau_{\\mathrm{dev}} = K (\\operatorname{tr} E) I + 2G E_{\\mathrm{dev}}\n$$\n这就是所要求的本构关系。\n\n接下来，我们分析两种指定的变形。\n\n**1. 纯体积膨胀**\n变形梯度为 $F_{v} = J_{v}^{1/3} I$，其中 $J_{v} > 1$。由于 $F_v$ 是对称正定的，其极分解为 $F_v = R V$，其中 $R=I$，左拉伸张量 $V = F_v = J_{v}^{1/3} I$。\n主拉伸比均相等：$\\lambda_1 = \\lambda_2 = \\lambda_3 = J_{v}^{1/3}$。\n对数应变 $E$ 由 $E = \\ln V = \\ln(J_{v}^{1/3} I)$ 给出。对于任意标量 $c>0$，有 $\\ln(cI) = (\\ln c)I$。因此，\n$$\nE = (\\ln J_{v}^{1/3}) I = \\frac{1}{3}(\\ln J_{v}) I\n$$\n这是一个纯体积应变。其迹为 $\\operatorname{tr}(E) = \\operatorname{tr}(\\frac{1}{3}(\\ln J_{v}) I) = \\frac{1}{3}(\\ln J_{v}) \\operatorname{tr}(I) = \\frac{1}{3}(\\ln J_{v}) \\cdot 3 = \\ln J_{v}$。\n应变的体积部分是 $E_{\\mathrm{vol}} = \\frac{1}{3}\\operatorname{tr}(E)I = \\frac{1}{3}(\\ln J_{v})I = E$。\n应变的偏量部分是 $E_{\\mathrm{dev}} = E - E_{\\mathrm{vol}} = 0$。\n现在我们使用推导出的本构关系计算应力分量。\n此次膨胀的应力体积部分，记为 $\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}$，是：\n$$\n\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})} = K (\\operatorname{tr} E) I = K (\\ln J_{v}) I\n$$\n应力的偏量部分是：\n$$\n\\tau_{\\mathrm{dev}}^{(\\mathrm{vol\\,exp})} = 2G E_{\\mathrm{dev}} = 2G(0) = 0\n$$\n总应力 $\\tau^{(\\mathrm{vol\\,exp})} = K (\\ln J_{v}) I$ 是一个纯静水压力状态。这在物理上是一致的：在各向同性材料中，纯体积变化应引起与体积模量 $K$ 成正比的压力状应力，而无剪切应力。\n\n**2. 等体积纯剪切拉伸**\n该变形由一个左拉伸张量 $V$ 定义，其主拉伸比为 $\\lambda_{s}$、$\\lambda_{s}^{-1}$ 和 $1$，其中 $\\lambda_s > 1$。该变形是等体积的，因为体积比 $J = \\det(V) = \\lambda_{s} \\cdot \\lambda_{s}^{-1} \\cdot 1 = 1$。\n在主基底下，$V$ 可以表示为矩阵 $V = \\operatorname{diag}(\\lambda_{s}, \\lambda_{s}^{-1}, 1)$。\n在该基底下，对数应变张量 $E$ 为：\n$$\nE = \\ln V = \\operatorname{diag}(\\ln \\lambda_{s}, \\ln(\\lambda_{s}^{-1}), \\ln 1) = \\operatorname{diag}(\\ln \\lambda_{s}, -\\ln \\lambda_{s}, 0)\n$$\n这是一个纯偏应变。其迹为 $\\operatorname{tr}(E) = \\ln \\lambda_{s} - \\ln \\lambda_{s} + 0 = 0$。\n应变的体积部分是 $E_{\\mathrm{vol}} = \\frac{1}{3}\\operatorname{tr}(E)I = 0$。\n应变的偏量部分是 $E_{\\mathrm{dev}} = E - E_{\\mathrm{vol}} = E$。\n现在我们计算应力分量。\n此次剪切的应力体积部分，记为 $\\tau_{\\mathrm{vol}}^{(\\mathrm{shear})}$，是：\n$$\n\\tau_{\\mathrm{vol}}^{(\\mathrm{shear})} = K (\\operatorname{tr} E) I = K(0)I = 0\n$$\n应力的偏量部分，记为 $\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}$，是：\n$$\n\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})} = 2G E_{\\mathrm{dev}} = 2G E = 2G \\operatorname{diag}(\\ln \\lambda_{s}, -\\ln \\lambda_{s}, 0)\n$$\n总应力 $\\tau^{(\\mathrm{shear})} = 2G E$ 是纯偏应力。这也符合物理直觉：在各向同性材料中，纯形状变化（在恒定体积下）应引起与剪切模量 $G$ 成正比的纯偏应力状态，而无静水压力分量。\n\n**比值 R 的最终计算**\n比值 $R$ 定义为\n$$\nR := \\frac{\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\|}{\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\|},\n$$\n其中 $\\|\\cdot\\|$ 是 Frobenius 范数，定义为 $\\|A\\| = \\sqrt{\\operatorname{tr}(A^T A)}$。\n对于分子，我们计算 $\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})} = 2G \\operatorname{diag}(\\ln \\lambda_{s}, -\\ln \\lambda_{s}, 0)$ 的范数。\n$$\n(\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})})^T (\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}) = (\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})})^2 = (2G)^2 \\operatorname{diag}((\\ln \\lambda_{s})^2, (-\\ln \\lambda_{s})^2, 0^2) = 4G^2 \\operatorname{diag}((\\ln \\lambda_{s})^2, (\\ln \\lambda_{s})^2, 0)\n$$\n其迹为 $\\operatorname{tr}((\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})})^2) = 4G^2 ((\\ln \\lambda_{s})^2 + (\\ln \\lambda_{s})^2 + 0) = 8G^2 (\\ln \\lambda_{s})^2$。\n范数为 $\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\| = \\sqrt{8G^2 (\\ln \\lambda_{s})^2}$。由于 $G>0$ 且 $\\lambda_s > 1$ (因此 $\\ln \\lambda_s > 0$)，这可以简化为：\n$$\n\\|\\tau_{\\mathrm{dev}}^{(\\mathrm{shear})}\\| = 2\\sqrt{2} G \\ln \\lambda_{s}\n$$\n对于分母，我们计算 $\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})} = K (\\ln J_{v}) I$ 的范数。\n$$\n(\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})})^T (\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}) = (K (\\ln J_{v}) I)^T (K (\\ln J_{v}) I) = (K \\ln J_{v})^2 I^2 = (K \\ln J_{v})^2 I\n$$\n其迹为 $\\operatorname{tr}((K \\ln J_{v})^2 I) = (K \\ln J_{v})^2 \\operatorname{tr}(I) = 3(K \\ln J_{v})^2$。\n范数为 $\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\| = \\sqrt{3(K \\ln J_{v})^2}$。由于 $K>0$ 且 $J_v > 1$ (因此 $\\ln J_v > 0$)，这可以简化为：\n$$\n\\|\\tau_{\\mathrm{vol}}^{(\\mathrm{vol\\,exp})}\\| = \\sqrt{3} K \\ln J_{v}\n$$\n最后，比值 $R$ 是：\n$$\nR = \\frac{2\\sqrt{2} G \\ln \\lambda_{s}}{\\sqrt{3} K \\ln J_{v}}\n$$\n这就是比值 $R$ 的最终闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{2\\sqrt{2} G \\ln(\\lambda_{s})}{\\sqrt{3} K \\ln(J_{v})}}\n$$", "id": "3579134"}, {"introduction": "从弹性理论过渡到塑性理论需要一种算法来处理不可逆变形。弹性预测-塑性修正算法，即返回映射算法，是率无关塑性理论的工业标准方法。本实践将指导您在对数应变框架下，针对简单的单轴情况，推导并实现一个返回映射算法 [@problem_id:3579149]。掌握这种一维实现方法，将为您开发更复杂的、用于有限元分析的多维塑性模型奠定坚实的基础。", "problem": "请为在对数 (Hencky) 应变空间中进行的有限应变弹塑性单步单轴更新设计一个完整且可验证的算法。目标是计算在步骤结束时，一个承受指定总对数应变的单轴杆的更新后应力和塑性应变。推导必须从适用于在对数应变空间中建模的有限应变塑性力学的第一性原理开始，且实现必须遵循各向同性硬化率无关本构中的弹性预测/塑性修正结构。\n\n应使用的基本原理：\n- 运动学：在一维情况下，总拉伸率表示为 $\\lambda$，总对数应变 (Hencky 应变) 为 $h = \\ln \\lambda$。变形梯度的行列式 (雅可比行列式) 为 $J=\\lambda$，弹性对数应变和塑性对数应变之和为总对d数应变：$h = h_{\\mathrm{e}} + h_{\\mathrm{p}}$。\n- 功共轭性：Kirchhoff 应力 $\\tau$ 与对数应变率功共轭。在一维情况下，对数应变空间中的弹性本构关系为 $\\tau = E\\, h_{\\mathrm{e}} = E \\left(h - h_{\\mathrm{p}}\\right)$，其中 $E$ 是杨氏模量。\n- 塑性理论：使用带各向同性硬化的一维相关联率无关塑性理论。屈服函数为 $\\phi(\\tau,\\alpha) = |\\tau| - \\tau_{\\mathrm{y}}(\\alpha)$，其中 $\\tau_{\\mathrm{y}}(\\alpha)=\\tau_{\\mathrm{y0}}+H\\,\\alpha$，$α$ 是累积塑性应变，$\\tau_{\\mathrm{y0}}$ 是初始屈服应力，$H$ 是各向同性硬化模量。Kuhn–Tucker 条件、一致性条件和相关流动法则均成立。在一维情况下，塑性流动方向由 $\\tau$ 的符号给出。\n\n您必须：\n- 从这些基本原理出发，推导单轴情况下对数应变空间中的标量返回映射修正算法，不得引用任何未经证明的简化公式。清晰地展示在塑性状态下如何根据一致性条件获得塑性乘子。\n- 实现弹性预测和塑性修正，以计算步骤结束时的更新量：Kirchhoff 应力 $\\tau_{n+1}$、塑性对数应变 $h_{\\mathrm{p},n+1}$ 和累积塑性应变 $\\alpha_{n+1}$。最后，使用 $\\sigma_{n+1}=\\tau_{n+1}/\\lambda_{n+1}$（其中 $\\lambda_{n+1}=\\exp(h_{n+1})$）计算 Cauchy 应力 $\\sigma_{n+1}$。\n- 为便于数值报告，最终的 Cauchy 应力以兆帕 (MPa) 为单位表示。应变 $h_{\\mathrm{p}}$ 和 $\\alpha$ 是无量纲的。所有返回的浮点值必须四舍五入到 $6$ 位小数。\n\n每个测试用例的输入规范：\n- 材料参数：$E$ (单位 MPa)、$\\tau_{\\mathrm{y0}}$ (单位 MPa)、$H$ (单位 MPa)。\n- 步骤结束时的状态/输入：总对数应变 $h_{n+1}$ (无量纲)、先前的塑性对数应变 $h_{\\mathrm{p},n}$ (无量纲)、先前的累积塑性应变 $\\alpha_n$ (无量纲)。\n\n每个测试用例的输出规范：\n- 一个包含3个浮点数的列表 $[\\sigma_{n+1}, h_{\\mathrm{p},n+1}, \\alpha_{n+1}]$，其中 $\\sigma_{n+1}$ 的单位是 MPa，所有值都四舍五入到 $6$ 位小数。\n\n您的程序必须处理以下测试套件，并在单行中生成汇总结果。请精确使用下面提供的参数值。\n\n测试套件 (每个项目提供 $(E,\\tau_{\\mathrm{y0}},H,h_{n+1},h_{\\mathrm{p},n},\\alpha_n)$)：\n- 案例 A: $(200000, 300, 1000, 0.0005, 0.0, 0.0)$\n- 案例 B: $(210000, 250, 0, 0.003, 0.0, 0.0)$\n- 案例 C: $(70000, 100, 1000, 0.01, 0.0, 0.0)$\n- 案例 D: $(100000, 200, 500, -0.005, 0.0, 0.0)$\n- 案例 E: $(150000, 300, 200, 0.002, 0.0, 0.0)$\n- 案例 F: $(210000, 250, 5000, 0.003, 0.01, 0.01)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个类似 Python 列表的、由各案例列表组成的列表，不含空格，且每个浮点数四舍五入到 $6$ 位小数。例如，一个有效的格式应如下所示：$[[1.234000,0.000000,0.000000],[\\dots]]$，其中省略号表示其他案例。\n\n角度单位不适用。请确保科学真实性和数值一致性。无需用户输入；程序必须内嵌测试套件并按所述确切格式打印结果。", "solution": "用户提供的问题经评估为 **有效**。该问题在科学上基于连续介质力学和计算塑性力学的原理，问题设定良好、客观，并包含唯一解所需的所有必要信息。现将介绍在对数应变空间中针对有限应变单轴弹塑性的返回映射算法的推导和实现。\n\n### **1. 问题公式化**\n\n该问题涉及经历有限变形的单轴杆的状态更新。运动学通过总对数应变 $h = \\ln \\lambda$ 来描述，其中 $\\lambda$ 是拉伸率。该模型假设总对数应变可加法分解为弹性和塑性两部分：\n$$h = h_{\\mathrm{e}} + h_{\\mathrm{p}}$$\n一个时间步开始时（以下标 $n$ 表示）的材料状态由塑性对数应变 $h_{\\mathrm{p},n}$ 和累积塑性应变 $\\alpha_n$ 来表征。问题要求在给定步骤结束时（以下标 $n+1$ 表示）的总对数应变 $h_{n+1}$ 的情况下，求出更新后的状态 $\\{h_{\\mathrm{p},n+1}, \\alpha_{n+1}\\}$ 及相应的应力。\n\n本构关系如下：\n- **弹性关系**：Kirchhoff 应力 $\\tau$ 通过杨氏模量 $E$ 与弹性对数应变 $h_{\\mathrm{e}}$ 相关联：\n  $$\\tau = E h_{\\mathrm{e}} = E(h - h_{\\mathrm{p}})$$\n- **屈服条件**：当屈服函数 $\\phi$ 为正时发生塑性流动。对于一维各向同性硬化，屈服函数为：\n  $$\\phi(\\tau, \\alpha) = |\\tau| - \\tau_{\\mathrm{y}}(\\alpha) \\leq 0$$\n  其中屈服应力 $\\tau_{\\mathrm{y}}$ 是累积塑性应变 $\\alpha$ 的线性函数：\n  $$\\tau_{\\mathrm{y}}(\\alpha) = \\tau_{\\mathrm{y0}} + H \\alpha$$\n  这里，$\\tau_{\\mathrm{y0}}$ 是初始屈服应力，$H$ 是常数硬化模量。\n- **流动法则**：假设采用相关流动法则，其中塑性应变增量沿屈服函数对应力的梯度方向：\n  $$\\Delta h_{\\mathrm{p}} = h_{\\mathrm{p},n+1} - h_{\\mathrm{p},n} = \\Delta \\gamma \\frac{\\partial \\phi}{\\partial \\tau} = \\Delta \\gamma \\, \\text{sgn}(\\tau_{n+1})$$\n  其中 $\\Delta \\gamma \\geq 0$ 是该步骤的塑性乘子。\n- **硬化法则**：累积塑性应变增量等于塑性应变增量的绝对值，在一维情况下即为塑性乘子：\n  $$\\Delta \\alpha = \\alpha_{n+1} - \\alpha_n = |\\Delta h_{\\mathrm{p}}| = \\Delta \\gamma$$\n\n最终的 Cauchy 应力 $\\sigma_{n+1}$ 通过以下关系从 Kirchhoff 应力 $\\tau_{n+1}$ 获得：\n$$\\sigma_{n+1} = \\frac{\\tau_{n+1}}{J_{n+1}} = \\frac{\\tau_{n+1}}{\\lambda_{n+1}} = \\frac{\\tau_{n+1}}{\\exp(h_{n+1})}$$\n\n### **2. 算法推导：返回映射**\n\n该算法基于标准的弹性预测/塑性修正结构，这是一种隐式时间积分格式。\n\n#### **步骤 2.1：弹性预测**\n\n首先，假设该步骤完全是弹性的。塑性状态变量暂时保持不变。计算“试探”状态如下：\n- 试探塑性应变: $h_{\\mathrm{p, trial}} = h_{\\mathrm{p},n}$\n- 试探累积塑性应变: $\\alpha_{\\text{trial}} = \\alpha_n$\n- 试探弹性应变: $h_{\\mathrm{e, trial}} = h_{n+1} - h_{\\mathrm{p, trial}} = h_{n+1} - h_{\\mathrm{p},n}$\n- 试探 Kirchhoff 应力: 使用弹性定律计算：\n  $$\\tau_{\\text{trial}} = E h_{\\mathrm{e, trial}} = E (h_{n+1} - h_{\\mathrm{p},n})$$\n\n#### **步骤 2.2：屈服校核**\n\n根据屈服条件检查试探状态。步骤开始时的屈服应力为 $\\tau_{\\mathrm{y},n} = \\tau_{\\mathrm{y0}} + H \\alpha_n$。试探屈服函数值为：\n$$\\phi_{\\text{trial}} = |\\tau_{\\text{trial}}| - \\tau_{\\mathrm{y},n} = |\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n)$$\n\n- 如果 $\\phi_{\\text{trial}} \\le 0$，则弹性假设正确。试探状态即为最终状态。\n  - $\\tau_{n+1} = \\tau_{\\text{trial}}$\n  - $h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n}$\n  - $\\alpha_{n+1} = \\alpha_n$\n\n- 如果 $\\phi_{\\text{trial}} > 0$，则发生了塑性变形。试探状态违反了屈服条件，需要进行塑性修正。\n\n#### **步骤 2.3：塑性修正**\n\n当发生塑性变形时，步骤结束时的状态必须同时满足整套本构方程。这就是“返回映射”阶段，它将试探应力投影回更新后的屈服面上。需要求解的未知数 $\\{\\tau_{n+1}, h_{\\mathrm{p},n+1}, \\alpha_{n+1}, \\Delta\\gamma\\}$ 的方程组是：\n1.  **弹性关系**: $\\tau_{n+1} = E(h_{n+1} - h_{\\mathrm{p},n+1})$\n2.  **流动法则**: $h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$ (注意: $\\text{sgn}(\\tau_{n+1})=\\text{sgn}(\\tau_{\\text{trial}})$ 因为应力空间中的返回路径是径向的)\n3.  **硬化法则**: $\\alpha_{n+1} = \\alpha_n + \\Delta \\gamma$\n4.  **一致性条件**: $\\phi_{n+1} = |\\tau_{n+1}| - (\\tau_{\\mathrm{y0}} + H \\alpha_{n+1}) = 0$\n\n我们求解该方程组以获得塑性乘子 $\\Delta\\gamma$。将方程 (2) 代入方程 (1)：\n$$\\tau_{n+1} = E(h_{n+1} - (h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})))$$\n$$\\tau_{n+1} = E(h_{n+1} - h_{\\mathrm{p},n}) - E \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$$\n注意到 $E(h_{n+1} - h_{\\mathrm{p},n})$ 即为 $\\tau_{\\text{trial}}$，我们得到：\n$$\\tau_{n+1} = \\tau_{\\text{trial}} - E \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$$\n两边乘以 $\\text{sgn}(\\tau_{\\text{trial}})$ 并利用 $|\\tau| = \\tau \\cdot \\text{sgn}(\\tau)$ 和 $(\\text{sgn}(\\tau_{\\text{trial}}))^2=1$：\n$$|\\tau_{n+1}| = |\\tau_{\\text{trial}}| - E \\Delta \\gamma$$\n现在，将这个关于 $|\\tau_{n+1}|$ 的表达式和硬化法则 (方程 3) 代入一致性条件 (方程 4)：\n$$(|\\tau_{\\text{trial}}| - E \\Delta \\gamma) - (\\tau_{\\mathrm{y0}} + H (\\alpha_n + \\Delta \\gamma)) = 0$$\n整理以求解 $\\Delta\\gamma$：\n$$|\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n) = E \\Delta \\gamma + H \\Delta \\gamma$$\n左侧恰好是试探屈服函数值 $\\phi_{\\text{trial}}$：\n$$\\phi_{\\text{trial}} = (E + H) \\Delta \\gamma$$\n因此，塑性乘子被确定为：\n$$\\Delta \\gamma = \\frac{\\phi_{\\text{trial}}}{E + H} = \\frac{|\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n)}{E + H}$$\n由于我们处于塑性情况，$\\phi_{\\text{trial}} > 0$。又因为 $E > 0$ 和 $H \\ge 0$，所以 $\\Delta \\gamma > 0$，符合要求。\n\n已知 $\\Delta \\gamma$ 后，更新状态变量：\n- **累积塑性应变**：\n  $$\\alpha_{n+1} = \\alpha_n + \\Delta \\gamma$$\n- **塑性对数应变**：\n  $$h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$$\n- **Kirchhoff 应力**：根据一致性条件，我们知道 $|\\tau_{n+1}| = \\tau_{\\mathrm{y0}} + H \\alpha_{n+1}$。符号从试探状态保留。这提供了一个数值上稳健的更新方式：\n  $$\\tau_{n+1} = (\\tau_{\\mathrm{y0}} + H \\alpha_{n+1}) \\, \\text{sgn}(\\tau_{\\text{trial}})$$\n\n### **3. 最终算法总结**\n\n对于从状态 $n$ 到 $n+1$ 的每一步：\n1.  **输入**：材料参数 $\\{E, \\tau_{\\mathrm{y0}}, H\\}$，以及状态 $\\{h_{\\mathrm{p},n}, \\alpha_n, h_{n+1}\\}$。\n2.  **弹性预测**：计算试探 Kirchhoff 应力：\n    $$\\tau_{\\text{trial}} = E (h_{n+1} - h_{\\mathrm{p},n})$$\n3.  **屈服校核**：计算试探屈服函数值：\n    $$\\phi_{\\text{trial}} = |\\tau_{\\text{trial}}| - (\\tau_{\\mathrm{y0}} + H \\alpha_n)$$\n4.  **情况分析**：\n    a.  **如果 $\\phi_{\\text{trial}} \\le 0$ (弹性步)**：\n        - $\\tau_{n+1} = \\tau_{\\text{trial}}$\n        - $h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n}$\n        - $\\alpha_{n+1} = \\alpha_n$\n    b.  **如果 $\\phi_{\\text{trial}} > 0$ (塑性步)**：\n        - 计算塑性乘子：$\\Delta \\gamma = \\phi_{\\text{trial}} / (E + H)$\n        - 更新累积塑性应变：$\\alpha_{n+1} = \\alpha_n + \\Delta \\gamma$\n        - 更新塑性对数应变：$h_{\\mathrm{p},n+1} = h_{\\mathrm{p},n} + \\Delta \\gamma \\, \\text{sgn}(\\tau_{\\text{trial}})$\n        - 更新 Kirchhoff 应力：$\\tau_{n+1} = (\\tau_{\\mathrm{y0}} + H \\alpha_{n+1}) \\, \\text{sgn}(\\tau_{\\text{trial}})$\n5.  **最终应力计算**：计算 Cauchy (真实) 应力：\n    $$\\sigma_{n+1} = \\frac{\\tau_{n+1}}{\\exp(h_{n+1})}$$\n6.  **输出**：返回更新后的值集合 $\\{\\sigma_{n+1}, h_{\\mathrm{p},n+1}, \\alpha_{n+1}\\}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a series of uniaxial finite strain elastoplasticity problems\n    using a return-mapping algorithm in logarithmic strain space.\n    \"\"\"\n    # Test suite: (E, tau_y0, H, h_np1, h_p_n, alpha_n)\n    # E, tau_y0, H are in MPa. Strains are dimensionless.\n    test_cases = [\n        (200000.0, 300.0, 1000.0, 0.0005, 0.0, 0.0),      # Case A\n        (210000.0, 250.0, 0.0, 0.003, 0.0, 0.0),          # Case B\n        (70000.0, 100.0, 1000.0, 0.01, 0.0, 0.0),         # Case C\n        (100000.0, 200.0, 500.0, -0.005, 0.0, 0.0),       # Case D\n        (150000.0, 300.0, 200.0, 0.002, 0.0, 0.0),        # Case E\n        (210000.0, 250.0, 5000.0, 0.003, 0.01, 0.01),     # Case F\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E, tau_y0, H, h_np1, h_p_n, alpha_n = case\n\n        # 1. Elastic Predictor\n        tau_trial = E * (h_np1 - h_p_n)\n\n        # 2. Yield Check\n        # Current yield stress at the start of the step\n        tau_y_n = tau_y0 + H * alpha_n\n        phi_trial = np.abs(tau_trial) - tau_y_n\n\n        # 3. Case Analysis: Elastic or Plastic\n        if phi_trial = 0:\n            # Elastic step\n            tau_np1 = tau_trial\n            h_p_np1 = h_p_n\n            alpha_np1 = alpha_n\n        else:\n            # Plastic step: perform return mapping\n            # Calculate plastic multiplier\n            delta_gamma = phi_trial / (E + H)\n            \n            # Update state variables\n            alpha_np1 = alpha_n + delta_gamma\n            \n            # Handle the sign of trial stress for flow direction\n            # np.sign returns 0 for 0, but phi_trial > 0 implies tau_trial != 0\n            sign_tau_trial = np.sign(tau_trial)\n            h_p_np1 = h_p_n + delta_gamma * sign_tau_trial\n            \n            # Update Kirchhoff stress using the consistency condition (more robust)\n            tau_np1 = (tau_y0 + H * alpha_np1) * sign_tau_trial\n\n        # 4. Final Cauchy Stress Calculation\n        # Total stretch at the end of the step\n        lambda_np1 = np.exp(h_np1)\n        # Cauchy stress\n        sigma_np1 = tau_np1 / lambda_np1\n\n        # 5. Format results\n        # Round final values to 6 decimal places as required\n        result = [\n            round(sigma_np1, 6),\n            round(h_p_np1, 6),\n            round(alpha_np1, 6),\n        ]\n        all_results.append(result)\n\n    # Final print statement must be a single line in the exact specified format.\n    # The replace(\" \", \"\") ensures no spaces are present in the final output.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "3579149"}, {"introduction": "真实世界的变形很少是简单的比例加载；主应变轴通常会随时间旋转。一个稳健的算法必须能正确处理这些复杂的运动学过程。本数值实验对比了一种运动学上严谨的方法与一种忽略主轴旋转的简化方法 [@problem_id:3579110]。通过模拟非比例加载路径，您将揭示客观应力率和正确运动学更新的至关重要性，并发现有限应变模型实现中的一个常见陷阱。", "problem": "考虑一个三维均匀变形体，由空间速度梯度 $L(t)$ 描述，该梯度被加法分解为对称的变形率张量 $D(t)$ 和反对称的自旋张量 $W(t)$，即 $L(t) = D(t) + W(t)$。变形梯度 $F(t)$ 根据基本运动学定律 $\\dot{F}(t) = L(t) F(t)$ 演化，初始条件为 $F(0) = I$，其中 $I$ 是单位张量。Cauchy-Green 变形张量 $B(t)$ 定义为 $B(t) = F(t) F(t)^{\\mathrm{T}}$，它是对称正定 (SPD) 的。左拉伸张量 $V(t)$ 通过对 $F(t)$ 进行极分解得到，满足 $V(t)^2 = B(t)$。欧拉 Hencky (对数) 应变定义为 $E^{\\log}(t) = \\log(V(t))$，其中 $\\log(\\cdot)$ 表示主矩阵对数。\n\n为计算应力，假设在对数应变空间中，Kirchhoff 应力 $\\tau(t)$ 遵循各向同性 Hencky 弹性本构律，其中杨氏模量为 $E$，泊松比为 $\\nu$。体积模量 $K$ 和剪切模量 $G$ 分别为 $K = \\dfrac{E}{3(1 - 2 \\nu)}$ 和 $G = \\dfrac{E}{2(1 + \\nu)}$，应力计算公式为\n$$\n\\tau(t) = K \\,\\mathrm{tr}\\big(E^{\\log}(t)\\big)\\, I + 2 G \\left(E^{\\log}(t) - \\frac{1}{3} \\mathrm{tr}\\big(E^{\\log}(t)\\big) I \\right).\n$$\n\n您必须构建一个主轴旋转的加载路径，其中 $D(t)$ 和 $W(t)$ 是非对易的，然后比较两种应力评估算法：\n- 算法 A（共轴假设）：假设 $E^{\\log}(t)$ 和 $\\tau(t)$ 与一个固定的空间基底保持共轴，因此主轴不发生演化。仅通过在固定基底中积分 $D(t)$ 的对角元来更新 $E^{\\log}(t)$ 的主值，即 $E^{\\log}(t+\\Delta t) \\approx E^{\\log}(t) + \\mathrm{diag}(D(t)) \\Delta t$，并保持特征向量不变。\n- 算法 B（完全谱向更新）：通过 $\\dot{F} = L F$ 积分 $F(t)$，计算 $B(t)$，然后通过 $B(t)$ 的谱分解得到 $V(t)$，最后通过谱映射计算 $E^{\\log}(t) = \\log(V(t))$。使用这个 $E^{\\log}(t)$ 来计算 $\\tau(t)$。\n\n通过以下方式定义主轴旋转的加载路径\n$$\nD(t) = R_z(\\alpha t) \\, D_0 \\, R_z(\\alpha t)^{\\mathrm{T}}, \\quad W(t) = \\begin{bmatrix} 0  -\\beta  0 \\\\ \\beta  0  0 \\\\ 0  0  0 \\end{bmatrix},\n$$\n其中 $R_z(\\theta)$ 是绕 z 轴旋转角度 $\\theta$（以弧度为单位）的旋转张量，$D_0$ 是一个常数对角张量。参数 $\\alpha$ 和 $\\beta$ 是恒定速率（单位分别为 $\\mathrm{rad/s}$ 和 $\\mathrm{s}^{-1}$）。变形过程在总时间 $T$ 内进行，包含 $N$ 个大小为 $\\Delta t = T/N$ 的均匀时间步。时间演化通过显式积分 $\\dot{F} = L F$ 进行数值近似，更新方式为 $F_{n+1} \\approx (I + L_n \\Delta t) F_n$。\n\n对于每个测试用例，计算由算法 A 得出的最终 Kirchhoff 应力 $\\tau_{\\mathrm{coax}}$ 和由算法 B 得出的 $\\tau_{\\mathrm{spec}}$，并测量由以下公式定义的无量纲相对误差\n$$\n\\epsilon = \\frac{\\left\\| \\tau_{\\mathrm{coax}} - \\tau_{\\mathrm{spec}} \\right\\|_F}{\\left\\| \\tau_{\\mathrm{spec}} \\right\\|_F},\n$$\n其中 $\\|\\cdot\\|_F$ 是 Frobenius 范数。将最终输出表示为十进制数（无量纲）。\n\n所有用例使用以下材料参数：$E = 2.10 \\times 10^{11}$，$\\nu = 0.30$。角度单位为弧度。\n\n测试套件：\n- 用例 1（非对易，中等旋转）：$D_0 = \\mathrm{diag}(0.02, -0.02, 0.00)$ (单位 $\\mathrm{s}^{-1}$)，$\\alpha = 1.0$ (单位 $\\mathrm{rad/s}$)，$\\beta = 0.5$ (单位 $\\mathrm{s}^{-1}$)，$T = 0.5$ (单位 $\\mathrm{s}$)，$N = 2000$。\n- 用例 2（对易边界，各向同性拉伸）：$D_0 = \\mathrm{diag}(0.02, 0.02, 0.02)$ (单位 $\\mathrm{s}^{-1}$)，$\\alpha = 3.0$ (单位 $\\mathrm{rad/s}$)，$\\beta = 5.0$ (单位 $\\mathrm{s}^{-1}$)，$T = 0.3$ (单位 $\\mathrm{s}$)，$N = 1500$。\n- 用例 3（非对易，高速旋转）：$D_0 = \\mathrm{diag}(0.02, -0.02, 0.00)$ (单位 $\\mathrm{s}^{-1}$)，$\\alpha = 10.0$ (单位 $\\mathrm{rad/s}$)，$\\beta = 5.0$ (单位 $\\mathrm{s}^{-1}$)，$T = 0.2$ (单位 $\\mathrm{s}$)，$N = 4000$。\n- 用例 4（非对易，无自旋）：$D_0 = \\mathrm{diag}(0.02, -0.02, 0.00)$ (单位 $\\mathrm{s}^{-1}$)，$\\alpha = 1.0$ (单位 $\\mathrm{rad/s}$)，$\\beta = 0.0$ (单位 $\\mathrm{s}^{-1}$)，$T = 0.5$ (单位 $\\mathrm{s}$)，$N = 2000$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是相应测试用例的相对误差 $\\epsilon$，以十进制数报告。", "solution": "该问题要求对两种用于计算有限变形体中应力的数值算法进行批判性比较。这是计算固体力学中的一项核心任务。第一种算法（算法 A）采用与固定参考系共轴的简化假设，而第二种算法（算法 B）则实现了完全且运动学上正确的更新。比较是在一个涉及变形主轴旋转的特定加载路径下进行的，该路径旨在检验共轴假设的有效性。\n\n该分析基于有限变形连续介质力学的原理。变形状态由变形梯度张量 $F(t)$ 描述，它将材料矢量从参考构型映射到当前构型。其演化由基本运动学定律决定：\n$$\n\\dot{F}(t) = L(t) F(t)\n$$\n初始条件为 $F(0) = I$，其中 $I$ 是 $3 \\times 3$ 的单位张量。空间速度梯度 $L(t)$ 被加法分解为其对称部分，即变形率张量 $D(t)$，和其反对称部分，即自旋张量 $W(t)$：\n$$\nL(t) = D(t) + W(t)\n$$\n左 Cauchy-Green 变形张量 $B(t)$ 定义为 $B(t) = F(t) F(t)^{\\mathrm{T}}$。由于 $F(t)$ 是可逆的（对于任何物理变形），$B(t)$ 是一个对称正定 (SPD) 张量。极分解定理指出，$F(t)$ 可以唯一地分解为一个旋转和一个拉伸。在空间描述中，即为 $F(t) = V(t) R(t)$，其中 $V(t)$ 是左拉伸张量（也是 SPD），$R(t)$ 是一个纯旋转正交张量。根据 $B(t)$ 的定义，我们有 $V(t)^2 = B(t)$，这意味着 $V(t)$ 是 $B(t)$ 唯一的 SPD 平方根。\n\n本构行为由各向同性 Hencky 弹性模型规定。该模型假定在对数应变空间中存在线性关系。欧拉 Hencky (对数) 应变张量 $E^{\\log}(t)$ 定义为左拉伸张量的主矩阵对数：\n$$\nE^{\\log}(t) = \\log(V(t))\n$$\n然后，Kirchhoff 应力 $\\tau(t)$ 通过各向同性线弹性定律与 $E^{\\log}(t)$ 相关联：\n$$\n\\tau(t) = K \\,\\mathrm{tr}\\big(E^{\\log}(t)\\big)\\, I + 2 G \\left(E^{\\log}(t) - \\frac{1}{3} \\mathrm{tr}\\big(E^{\\log}(t)\\big) I \\right)\n$$\n其中 $\\mathrm{tr}(\\cdot)$ 表示张量的迹。材料常数是体积模量 $K$ 和剪切模量 $G$，它们由杨氏模量 $E$ 和泊松比 $\\nu$ 定义如下：\n$$\nK = \\frac{E}{3(1 - 2 \\nu)}, \\quad G = \\frac{E}{2(1 + \\nu)}\n$$\n问题定义了一个特定的加载路径，其特征是旋转的变形率张量 $D(t)$ 和恒定的自旋张量 $W(t)$：\n$$\nD(t) = R_z(\\alpha t) \\, D_0 \\, R_z(\\alpha t)^{\\mathrm{T}}\n$$\n$$\nW(t) = \\begin{bmatrix} 0  -\\beta  0 \\\\ \\beta  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n这里，$D_0$ 是一个常数对角张量，$\\alpha$ 是 $D(t)$ 主轴的旋转速率，$\\beta$ 控制额外刚体自旋的大小，$R_z(\\theta)$ 是绕 z 轴旋转角度 $\\theta$ 的旋转矩阵：\n$$\nR_z(\\theta) = \\begin{bmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{bmatrix}\n$$\n总变形发生在一个时间周期 $T_f$ 内，使用 $N$ 个大小为 $\\Delta t = T_f/N$ 的离散时间步。$F(t)$ 的演化使用显式前向欧拉格式 $F_{n+1} = (I + L_n \\Delta t) F_n$ 进行近似，其中下标 $n$ 表示在时间 $t_n = n \\Delta t$ 处的值。\n\n两种算法的实现如下：\n\n算法 B（完全谱向更新）：此算法作为参考解。它正确地对完整的运动学进行积分。\n1. 初始化 $F_0 = I$。\n2. 对于从 $0$ 到 $N-1$ 的每个时间步 $n$：\n    a. 计算当前时间 $t_n = n \\Delta t$。\n    b. 根据定义构造 $D(t_n)$ 和 $W(t_n)$。\n    c. 形成速度梯度 $L_n = D(t_n) + W(t_n)$。\n    d. 更新变形梯度：$F_{n+1} = (I + L_n \\Delta t) F_n$。\n3. 在最终时间 $T_f = N \\Delta t$，$F_{\\text{final}} = F_N$ 为最终变形梯度。\n4. 计算最终左 Cauchy-Green 张量：$B_{\\text{final}} = F_{\\text{final}} F_{\\text{final}}^{\\mathrm{T}}$。\n5. 对对称张量 $B_{\\text{final}}$ 进行谱分解：$B_{\\text{final}} = P \\Lambda_B P^{\\mathrm{T}}$，其中 $\\Lambda_B$ 是特征值 $\\lambda_i^B$ 的对角矩阵，$P$ 是相应特征向量的正交矩阵。\n6. $V_{\\text{final}}$ 的特征值为 $\\lambda_i = \\sqrt{\\lambda_i^B}$，其特征向量与 $B_{\\text{final}}$ 相同。对数应变 $E^{\\log}_{\\mathrm{spec}}$ 的特征值为 $\\epsilon_i = \\log(\\lambda_i) = \\frac{1}{2} \\log(\\lambda_i^B)$。\n7. 构建最终对数应变张量：$E^{\\log}_{\\mathrm{spec}} = P \\, \\mathrm{diag}(\\epsilon_1, \\epsilon_2, \\epsilon_3) \\, P^{\\mathrm{T}}$。\n8. 使用本构律和 $E^{\\log}_{\\mathrm{spec}}$ 计算最终 Kirchhoff 应力 $\\tau_{\\mathrm{spec}}$。\n\n算法 A（共轴假设）：这是一种简化的、且通常不正确的算法。它假设应变主轴在整个变形过程中在实验室坐标系中是固定的。\n1. 初始化对数应变张量 $E^{\\log}_{\\mathrm{coax}, 0} = \\mathbf{0}$，这是一个 $3 \\times 3$ 的零矩阵。\n2. 对于从 $0$ 到 $N-1$ 的每个时间步 $n$：\n    a. 计算当前时间 $t_n = n \\Delta t$。\n    b. 构造 $D(t_n)$。\n    c. 通过仅积分 $D(t_n)$ 的对角分量来更新对角对数应变张量：\n       $E^{\\log}_{\\mathrm{coax}, n+1} = E^{\\log}_{\\mathrm{coax}, n} + \\mathrm{diag}(D_{11}(t_n), D_{22}(t_n), D_{33}(t_n)) \\Delta t$。\n3. 在最终时间 $T_f$，最终应变为 $E^{\\log}_{\\mathrm{coax}} = E^{\\log}_{\\mathrm{coax}, N}$。\n4. 使用本构律和 $E^{\\log}_{\\mathrm{coax}}$ 计算最终 Kirchhoff 应力 $\\tau_{\\mathrm{coax}}$。\n\n简化方法的误差通过 Frobenius 范数中的相对差异来量化：\n$$\n\\epsilon = \\frac{\\left\\| \\tau_{\\mathrm{coax}} - \\tau_{\\mathrm{spec}} \\right\\|_F}{\\left\\| \\tau_{\\mathrm{spec}} \\right\\|_F}\n$$\n其中矩阵 $A$ 的 Frobenius 范数为 $\\|A\\|_F = \\sqrt{\\sum_{i,j} A_{ij}^2}$。\n\n预期该分析将显示，在加载是非比例的（即 $D(t)$ 的主轴旋转）情况下，算法 A 会产生显著误差，因为它错误地忽略了主应变方向的演化。对于各向同性拉伸的特殊情况（$D_0 = d_0 I$），$D(t)$ 变为恒定且各向同性（$D(t) = d_0 I$），这导致变形中主应变轴相对于材料不发生旋转。在这种特定情景（用例 2）下，两种算法应产生相同的结果，误差 $\\epsilon$ 预期为零（或接近机器精度）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational solid mechanics problem for the given test suite.\n    \"\"\"\n\n    # --- Material Parameters ---\n    E = 2.10e11  # Young's modulus\n    nu = 0.30    # Poisson's ratio\n\n    # --- Test Suite ---\n    test_cases = [\n        # Case 1: non-commutative, moderate rotation\n        {'D0_diag': [0.02, -0.02, 0.00], 'alpha': 1.0, 'beta': 0.5, 'T': 0.5, 'N': 2000},\n        # Case 2: commuting boundary, isotropic stretch\n        {'D0_diag': [0.02, 0.02, 0.02], 'alpha': 3.0, 'beta': 5.0, 'T': 0.3, 'N': 1500},\n        # Case 3: non-commutative, high rotation\n        {'D0_diag': [0.02, -0.02, 0.00], 'alpha': 10.0, 'beta': 5.0, 'T': 0.2, 'N': 4000},\n        # Case 4: non-commutative, no spin\n        {'D0_diag': [0.02, -0.02, 0.00], 'alpha': 1.0, 'beta': 0.0, 'T': 0.5, 'N': 2000},\n    ]\n\n    results = []\n\n    # --- Helper Functions ---\n    def get_rotation_matrix_z(theta):\n        \"\"\"Returns the rotation matrix around the z-axis by angle theta.\"\"\"\n        cos_t = np.cos(theta)\n        sin_t = np.sin(theta)\n        return np.array([\n            [cos_t, -sin_t, 0.0],\n            [sin_t,  cos_t, 0.0],\n            [0.0,    0.0,   1.0]\n        ])\n\n    def calculate_stress(E_log, K, G):\n        \"\"\"Calculates Kirchhoff stress from logarithmic strain.\"\"\"\n        I = np.eye(3)\n        tr_E_log = np.trace(E_log)\n        tau = K * tr_E_log * I + 2 * G * (E_log - (1/3) * tr_E_log * I)\n        return tau\n\n    # --- Main Loop ---\n    for case in test_cases:\n        # Unpack parameters\n        D0 = np.diag(case['D0_diag'])\n        alpha = case['alpha']\n        beta = case['beta']\n        T = case['T']\n        N = case['N']\n        \n        # Derived parameters\n        dt = T / N\n        K = E / (3 * (1 - 2 * nu))\n        G = E / (2 * (1 + nu))\n\n        # Initial conditions\n        F = np.eye(3) # For Algorithm B\n        E_log_coax = np.zeros((3, 3)) # For Algorithm A\n        W = np.array([\n            [0.0, -beta, 0.0],\n            [beta,  0.0, 0.0],\n            [0.0,  0.0, 0.0]\n        ])\n\n        # --- Time-stepping integration ---\n        for n in range(N):\n            t = n * dt\n            \n            # Common calculations\n            R_z = get_rotation_matrix_z(alpha * t)\n            D = R_z @ D0 @ R_z.T\n            \n            # --- Algorithm A update (Coaxial Assumption) ---\n            E_log_coax += np.diag(np.diag(D)) * dt\n            \n            # --- Algorithm B update (Full Spectral) ---\n            L = D + W\n            # Forward Euler update for F\n            F = (np.eye(3) + L * dt) @ F\n\n        # --- Post-processing after loop ---\n        \n        # Calculate final stress for Algorithm A\n        tau_coax = calculate_stress(E_log_coax, K, G)\n\n        # Calculate final stress for Algorithm B\n        B = F @ F.T\n        # Spectral decomposition of B\n        # eigh is for symmetric/hermitian matrices\n        eigvals_B, eigvecs_B = np.linalg.eigh(B)\n        \n        # Ensure eigenvalues are positive before sqrt\n        eigvals_B[eigvals_B  0] = 0\n        \n        eigvals_V = np.sqrt(eigvals_B)\n        \n        # To avoid log(0), handle zero eigenvalues carefully.\n        # Since stretches must be positive, log(stretch) should be well-defined.\n        # A zero eigenvalue in B would imply a singular deformation gradient F,\n        # which means the volume has collapsed to zero.\n        # We add a small epsilon to avoid numerical issues.\n        eigvals_E_log = np.log(eigvals_V + np.finfo(float).eps)\n\n        E_log_spec = eigvecs_B @ np.diag(eigvals_E_log) @ eigvecs_B.T\n        tau_spec = calculate_stress(E_log_spec, K, G)\n\n        # --- Error Calculation ---\n        norm_tau_spec = np.linalg.norm(tau_spec, 'fro')\n        norm_diff = np.linalg.norm(tau_coax - tau_spec, 'fro')\n        \n        if norm_tau_spec > np.finfo(float).eps:\n            error = norm_diff / norm_tau_spec\n        else:\n            # If the true stress is zero, the absolute error is more meaningful.\n            # For this problem, we can assume spec stress is non-zero\n            # except perhaps in trivial cases. Case 2 results in non-zero stress.\n            error = norm_diff\n\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3579110"}]}