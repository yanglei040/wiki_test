{"hands_on_practices": [{"introduction": "在任何有限元方法中，计算基函数的导数对于构建刚度矩阵都至关重要。本练习在等几何分析（IGA）的背景下强化了这项基本技能，从 Cox-de Boor 递归公式出发，并应用商法则来处理非均匀有理B样条（NURBS）的有理特性。通过这个从头开始的推导过程 [@problem_id:3594419]，你将深入理解在计算力学中形成求解系统所需的基本计算步骤。", "problem": "在计算固体力学的等几何分析 (IGA) 背景下，考虑一个定义在参数 $u \\in [0,1]$ 上的单变量非均匀有理 B 样条 (NURBS) 曲线，其开放节点向量为 $\\Xi = [0,0,0,1,1,1]$，多项式次数为 $p=2$。相关的 B 样条基函数 $N_{i,2}(u)$，$i \\in \\{1,2,3\\}$，由 Cox–de Boor 递归公式从分段常数函数和给定的节点向量递归定义。NURBS 基函数定义为\n$$\nR_i(u) = \\frac{w_i N_{i,2}(u)}{\\sum_{j=1}^{3} w_j N_{j,2}(u)},\n$$\n其中 $w_i$ 是正权重。在 T 样条中，当局部细化简化为单个张量积单元时，也会出现此类有理基作为局部混合函数，并且在刚度矩阵组装中需要它们的导数。\n\n任务：\n1) 从 Cox–de Boor 递归公式和给定的节点向量出发，推导二次 B 样条基函数 $N_{i,2}(u)$ 及其一阶导数 $\\partial_u N_{i,2}(u)$ 在 $u \\in (0,1)$ 上的显式表达式。\n2) 仅使用应用于上述 $R_i(u)$ 定义的商法则（并且不使用任何预先记下的 NURBS 导数公式），推导一个用 $N_{i,2}(u)$、$\\partial_u N_{i,2}(u)$ 和权重 $\\{w_i\\}_{i=1}^{3}$ 表示的 $\\partial_u R_i(u)$ 的通用表达式。\n3) 对于权重 $w = [1,2,1]$，计算三个一阶导数 $\\partial_u R_i(u)$ 在 $u = \\tfrac{1}{2}$ 处的值。\n\n答案规格：\n- 将您的最终答案以单个 $1 \\times 3$ 行矩阵的形式报告，其中包含 $\\partial_u R_1(\\tfrac{1}{2})$、$\\partial_u R_2(\\tfrac{1}{2})$、$\\partial_u R_3(\\tfrac{1}{2})$ 这三个值的精确形式。\n- 不包含单位，不要四舍五入；请提供精确的有理数。", "solution": "我们从第一性原理出发。B 样条基函数 $N_{i,p}(u)$ 由 Cox–de Boor 递归公式定义。对于 $p=0$，\n$$\nN_{i,0}(u) =\n\\begin{cases}\n1,  \\text{若 } \\xi_i \\le u  \\xi_{i+1}, \\\\\n0,  \\text{其他情况},\n\\end{cases}\n$$\n其中开放节点向量为 $\\Xi = [\\xi_1,\\ldots,\\xi_6] = [0,0,0,1,1,1]$。对于更高次数 $p \\ge 1$，\n$$\nN_{i,p}(u) = \\frac{u - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(u) + \\frac{\\xi_{i+p+1} - u}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(u),\n$$\n约定分母为零的项被解释为零。\n\n步骤 1：确定在 $u \\in (0,1)$ 上的 $N_{i,2}(u)$。\n- 对于 $p=0$ 和给定的 $\\Xi$，唯一的非退化区间是 $[\\xi_3,\\xi_4) = [0,1)$，因此对于 $u \\in [0,1)$ 有 $N_{3,0}(u) = 1$，而在 $u \\in (0,1)$ 上 $N_{1,0}(u) = N_{2,0}(u) = 0$。\n- 对于 $p=1$，使用递归公式：\n  - 对于 $i=2$，\n  $$\n  N_{2,1}(u) = \\frac{u - \\xi_2}{\\xi_{2+1} - \\xi_2} N_{2,0}(u) + \\frac{\\xi_{2+2} - u}{\\xi_{2+2} - \\xi_{2+1}} N_{3,0}(u)\n  = \\frac{u - 0}{0 - 0} \\cdot 0 + \\frac{1 - u}{1 - 0} \\cdot 1 = 1 - u.\n  $$\n  - 对于 $i=3$，\n  $$\n  N_{3,1}(u) = \\frac{u - \\xi_3}{\\xi_{3+1} - \\xi_3} N_{3,0}(u) + \\frac{\\xi_{3+2} - u}{\\xi_{3+2} - \\xi_{3+1}} N_{4,0}(u)\n  = \\frac{u - 0}{1 - 0} \\cdot 1 + \\frac{1 - u}{1 - 1} \\cdot 0 = u.\n  $$\n  所有其他的 $N_{i,1}(u)$ 在 $u \\in (0,1)$ 上均为零。\n- 对于 $p=2$：\n  - 对于 $i=1$，\n  $$\n  N_{1,2}(u) = \\frac{u - \\xi_1}{\\xi_{1+2} - \\xi_1} N_{1,1}(u) + \\frac{\\xi_{1+2+1} - u}{\\xi_{1+2+1} - \\xi_{1+1}} N_{2,1}(u)\n  = 0 + \\frac{1 - u}{1 - 0} (1 - u) = (1 - u)^{2}.\n  $$\n  - 对于 $i=2$，\n  $$\n  N_{2,2}(u) = \\frac{u - \\xi_2}{\\xi_{2+2} - \\xi_2} N_{2,1}(u) + \\frac{\\xi_{2+2+1} - u}{\\xi_{2+2+1} - \\xi_{2+1}} N_{3,1}(u)\n  = \\frac{u - 0}{1 - 0} (1 - u) + \\frac{1 - u}{1 - 0} u = 2u(1 - u).\n  $$\n  - 对于 $i=3$，\n  $$\n  N_{3,2}(u) = \\frac{u - \\xi_3}{\\xi_{3+2} - \\xi_3} N_{3,1}(u) + \\frac{\\xi_{3+2+1} - u}{\\xi_{3+2+1} - \\xi_{3+1}} N_{4,1}(u)\n  = \\frac{u - 0}{1 - 0} u + 0 = u^{2}.\n  $$\n因此，在 $u \\in (0,1)$ 上，\n$$\nN_{1,2}(u) = (1 - u)^{2}, \\quad N_{2,2}(u) = 2u(1 - u), \\quad N_{3,2}(u) = u^{2}.\n$$\n它们的一阶导数是\n$$\n\\partial_u N_{1,2}(u) = -2(1 - u) = 2(u - 1), \\quad \\partial_u N_{2,2}(u) = 2(1 - 2u), \\quad \\partial_u N_{3,2}(u) = 2u.\n$$\n\n步骤 2：通过商法则推导 $\\partial_u R_i(u)$。\n根据定义，\n$$\nR_i(u) = \\frac{w_i N_{i,2}(u)}{\\sum_{j=1}^{3} w_j N_{j,2}(u)}.\n$$\n定义分母（NURBS 权重函数）\n$$\nW(u) = \\sum_{j=1}^{3} w_j N_{j,2}(u),\n$$\n及其导数\n$$\n\\partial_u W(u) = \\sum_{j=1}^{3} w_j \\partial_u N_{j,2}(u).\n$$\n将商法则应用于 $R_i(u) = \\frac{w_i N_{i,2}(u)}{W(u)}$ 得到\n$$\n\\partial_u R_i(u) = \\frac{w_i \\partial_u N_{i,2}(u) \\, W(u) - w_i N_{i,2}(u) \\, \\partial_u W(u)}{[W(u)]^{2}}.\n$$\n\n步骤 3：当 $u = \\tfrac{1}{2}$ 且权重 $w = [1,2,1]$ 时进行求值。\n首先计算在 $u = \\tfrac{1}{2}$ 处的基函数值和导数值：\n$$\nN_{1,2}\\!\\left(\\tfrac{1}{2}\\right) = \\left(1 - \\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}, \\quad\nN_{2,2}\\!\\left(\\tfrac{1}{2}\\right) = 2 \\cdot \\tfrac{1}{2} \\cdot \\left(1 - \\tfrac{1}{2}\\right) = \\tfrac{1}{2}, \\quad\nN_{3,2}\\!\\left(\\tfrac{1}{2}\\right) = \\left(\\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}.\n$$\n$$\n\\partial_u N_{1,2}\\!\\left(\\tfrac{1}{2}\\right) = 2\\left(\\tfrac{1}{2} - 1\\right) = -1, \\quad\n\\partial_u N_{2,2}\\!\\left(\\tfrac{1}{2}\\right) = 2\\left(1 - 2 \\cdot \\tfrac{1}{2}\\right) = 0, \\quad\n\\partial_u N_{3,2}\\!\\left(\\tfrac{1}{2}\\right) = 2 \\cdot \\tfrac{1}{2} = 1.\n$$\n当 $w_1 = 1$，$w_2 = 2$，$w_3 = 1$ 时，\n$$\nW\\!\\left(\\tfrac{1}{2}\\right) = 1 \\cdot \\tfrac{1}{4} + 2 \\cdot \\tfrac{1}{2} + 1 \\cdot \\tfrac{1}{4} = \\tfrac{1}{4} + 1 + \\tfrac{1}{4} = \\tfrac{3}{2},\n$$\n并且\n$$\n\\partial_u W\\!\\left(\\tfrac{1}{2}\\right) = 1 \\cdot (-1) + 2 \\cdot 0 + 1 \\cdot 1 = 0.\n$$\n因此，对于每个 $i \\in \\{1,2,3\\}$，\n$$\n\\partial_u R_i\\!\\left(\\tfrac{1}{2}\\right) = \\frac{w_i \\, \\partial_u N_{i,2}\\!\\left(\\tfrac{1}{2}\\right) \\, W\\!\\left(\\tfrac{1}{2}\\right) - w_i \\, N_{i,2}\\!\\left(\\tfrac{1}{2}\\right) \\, \\partial_u W\\!\\left(\\tfrac{1}{2}\\right)}{\\left[W\\!\\left(\\tfrac{1}{2}\\right)\\right]^{2}}\n= \\frac{w_i \\, \\partial_u N_{i,2}\\!\\left(\\tfrac{1}{2}\\right) \\, \\tfrac{3}{2}}{\\left(\\tfrac{3}{2}\\right)^{2}}\n= \\frac{2}{3} \\, w_i \\, \\partial_u N_{i,2}\\!\\left(\\tfrac{1}{2}\\right).\n$$\n从而，\n$$\n\\partial_u R_1\\!\\left(\\tfrac{1}{2}\\right) = \\frac{2}{3} \\cdot 1 \\cdot (-1) = -\\frac{2}{3}, \\quad\n\\partial_u R_2\\!\\left(\\tfrac{1}{2}\\right) = \\frac{2}{3} \\cdot 2 \\cdot 0 = 0, \\quad\n\\partial_u R_3\\!\\left(\\tfrac{1}{2}\\right) = \\frac{2}{3} \\cdot 1 \\cdot 1 = \\frac{2}{3}.\n$$\n将这三个值收集到一个 $1 \\times 3$ 的行矩阵中，便得到所要求的精确有理数形式的最终结果。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{2}{3}  0  \\frac{2}{3}\\end{pmatrix}}$$", "id": "3594419"}, {"introduction": "为了捕捉局部特征而加密网格是分析中的一个关键过程。本练习探讨了B样条的经典加密方法——节点插入，并演示了如何将新的控制点计算为旧控制点的凸组合。通过构建加密矩阵 $T$ [@problem_id:3594387]，你将具体理解这一过程虽然在计算上是局部的，但如何产生结构化的全局效应，为理解T样条的优势奠定了基础。", "problem": "考虑一条在计算固体力学中用于等几何分析 (IGA) 的次数为 $p=2$ 的单变量开放非均匀有理B样条 (NURBS) 曲线，其初始开放节点矢量为 $\\Xi^{(0)} = [0,0,0, \\tfrac{1}{2}, 1,1,1]$，对应的控制点矢量为 $\\mathbf{C}^{(0)} \\in \\mathbb{R}^{4}$。在 $\\xi=\\tfrac{1}{4}$ 和 $\\xi=\\tfrac{3}{4}$ 处依次插入重复度为1的两个节点，生成加细后的节点矢量 $\\Xi^{(2)} = [0,0,0, \\tfrac{1}{4}, \\tfrac{1}{2}, \\tfrac{3}{4}, 1,1,1]$ 和加细后的控制点矢量 $\\mathbf{C}^{(2)} \\in \\mathbb{R}^{6}$。令 $\\mathbf{T} \\in \\mathbb{R}^{6 \\times 4}$ 表示全局加细矩阵，使得 $\\mathbf{C}^{(2)} = \\mathbf{T}\\,\\mathbf{C}^{(0)}$，该矩阵在加细过程中保持几何形状不变。\n\n从B样条基函数的 Cox–de Boor 递推定义和节点插入下的曲线不变性原理出发，推导在每次单节点插入步骤中更新控制点的局部凸组合关系。利用这些关系，显式地构建两个连续的局部加细算子，它们分别实现映射 $\\mathbf{C}^{(0)} \\mapsto \\mathbf{C}^{(1)}$ (插入 $\\xi=\\tfrac{1}{4}$ 后) 和 $\\mathbf{C}^{(1)} \\mapsto \\mathbf{C}^{(2)}$ (插入 $\\xi=\\tfrac{3}{4}$ 后)，并将它们的乘积构成全局加细矩阵 $\\mathbf{T}$。\n\n然后，从第一性原理出发，验证 $\\mathbf{T}$ 的每个元素都是非负的，并且 $\\mathbf{T}$ 的每行之和为 $1$，从而证明控制多边形的凸性保持以及加细后基函数的单位剖分性质的继承。最后，计算标量\n$$\nS \\;=\\; \\sum_{i=1}^{6} \\sum_{j=1}^{4} T_{ij}.\n$$\n将 $S$ 报告为一个无单位的实数。无需四舍五入。", "solution": "该问题要求构建并分析 B 样条曲线在顺序节点插入下的加细矩阵。我们将按要求从第一性原理出发。问题提到非均匀有理B样条 (NURBS)，但提供的控制点矢量在 $\\mathbb{R}^4$ 中，这对应于四个标量控制点。此设置描述的是一个B样条函数，它是所有权重等于1的NURBS曲线的特例。在这种情况下，标准的节点插入算法 (Boehm 算法) 直接适用于控制点。\n\n一个次数为 $p$ 的B样条曲线由一组控制点 $\\mathbf{P}_i$ 和一个节点矢量 $\\Xi$ 定义。如果控制点根据特定的局部凸组合规则进行更新，则可以保证曲线在节点插入下保持不变。设初始曲线为 $\\mathbf{C}(\\xi) = \\sum_{i=1}^{n} N_{i,p}(\\xi) \\mathbf{P}_i$，定义在节点矢量 $\\Xi = \\{\\xi_1, \\dots, \\xi_{n+p+1}\\}$ 上。当插入一个新节点 $\\bar{\\xi}$，使得 $\\xi_k \\le \\bar{\\xi}  \\xi_{k+1}$ 时，会生成一组新的 $n+1$ 个控制点 $\\bar{\\mathbf{P}}_i$ 和一个新的节点矢量 $\\bar{\\Xi}$。曲线不变性原理，结合B样条基函数的 Cox-de Boor 递推公式，得出了以下用于更新控制点的规则，即著名的 Boehm 算法：\n$$\n\\bar{\\mathbf{P}}_i = \\begin{cases}\n\\mathbf{P}_i  \\text{for } 1 \\le i \\le k-p \\\\\n(1 - \\alpha_i) \\mathbf{P}_{i-1} + \\alpha_i \\mathbf{P}_i  \\text{for } k-p+1 \\le i \\le k \\\\\n\\mathbf{P}_{i-1}  \\text{for } k+1 \\le i \\le n+1\n\\end{cases}\n$$\n其中系数 $\\alpha_i$ 由下式给出：\n$$\n\\alpha_i = \\frac{\\bar{\\xi} - \\xi_i}{\\xi_{i+p} - \\xi_i}\n$$\n这些公式定义了局部凸组合关系。对于 $k-p+1 \\le i \\le k$，新的控制点 $\\bar{\\mathbf{P}}_i$ 是两个相邻旧控制点 $\\mathbf{P}_{i-1}$ 和 $\\mathbf{P}_i$ 的凸组合，因为对于在开区间 $(\\xi_k, \\xi_{k+1})$ 中以重复度1插入的节点 $\\bar{\\xi}$，有 $0 \\le \\alpha_i  1$。\n\n现在我们将此过程应用于指定的两次节点插入。\n\n**步骤 1：在 $\\xi = \\frac{1}{4}$ 处进行第一次节点插入**\n初始设置为一条次数 $p=2$ 的曲线，有 $n^{(0)}=4$ 个控制点 $\\mathbf{C}^{(0)} = [\\mathbf{P}_1^{(0)}, \\mathbf{P}_2^{(0)}, \\mathbf{P}_3^{(0)}, \\mathbf{P}_4^{(0)}]^T$ 和节点矢量 $\\Xi^{(0)} = [\\xi_1, \\dots, \\xi_7] = [0,0,0, \\frac{1}{2}, 1,1,1]$。我们插入节点 $\\bar{\\xi} = \\frac{1}{4}$。必须找到一个索引 $k$ 使得 $\\xi_k \\le \\bar{\\xi}  \\xi_{k+1}$。从 $\\Xi^{(0)}$ 中，我们看到 $\\xi_3=0 \\le \\frac{1}{4}  \\frac{1}{2} = \\xi_4$，所以 $k=3$。\n\n新的集合将有 $n^{(1)}=4+1=5$ 个控制点，记作 $\\mathbf{C}^{(1)} = [\\mathbf{P}_1^{(1)}, \\dots, \\mathbf{P}_5^{(1)}]^T$。旧控制点受影响的索引范围是 $[k-p, k] = [3-2, 3] = [1, 3]$。更新规则如下生成新的控制点：\n- 对于 $i \\le k-p = 1$：$\\mathbf{P}_1^{(1)} = \\mathbf{P}_1^{(0)}$。\n- 对于 $i \\in [k-p+1, k] = [2, 3]$：\n  - 对于 $i=2$：$\\alpha_2 = \\frac{\\bar{\\xi} - \\xi_2}{\\xi_{2+p} - \\xi_2} = \\frac{\\frac{1}{4} - \\xi_2}{\\xi_4 - \\xi_2} = \\frac{\\frac{1}{4} - 0}{\\frac{1}{2} - 0} = \\frac{1}{2}$。\n    $\\mathbf{P}_2^{(1)} = (1-\\alpha_2)\\mathbf{P}_1^{(0)} + \\alpha_2 \\mathbf{P}_2^{(0)} = \\frac{1}{2}\\mathbf{P}_1^{(0)} + \\frac{1}{2}\\mathbf{P}_2^{(0)}$。\n  - 对于 $i=3$：$\\alpha_3 = \\frac{\\bar{\\xi} - \\xi_3}{\\xi_{3+p} - \\xi_3} = \\frac{\\frac{1}{4} - \\xi_3}{\\xi_5 - \\xi_3} = \\frac{\\frac{1}{4} - 0}{1 - 0} = \\frac{1}{4}$。\n    $\\mathbf{P}_3^{(1)} = (1-\\alpha_3)\\mathbf{P}_2^{(0)} + \\alpha_3 \\mathbf{P}_3^{(0)} = \\frac{3}{4}\\mathbf{P}_2^{(0)} + \\frac{1}{4}\\mathbf{P}_3^{(0)}$。\n- 对于 $i \\ge k+1 = 4$：\n  - 对于 $i=4$：$\\mathbf{P}_4^{(1)} = \\mathbf{P}_{4-1}^{(0)} = \\mathbf{P}_3^{(0)}$。\n  - 对于 $i=5$：$\\mathbf{P}_5^{(1)} = \\mathbf{P}_{5-1}^{(0)} = \\mathbf{P}_4^{(0)}$。\n\n关系 $\\mathbf{C}^{(1)} = \\mathbf{T}^{(1)} \\mathbf{C}^{(0)}$ 由 $5 \\times 4$ 的局部加细矩阵 $\\mathbf{T}^{(1)}$ 描述：\n$$\n\\mathbf{T}^{(1)} = \\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0 \\\\\n0  \\frac{3}{4}  \\frac{1}{4}  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n新的节点矢量是 $\\Xi^{(1)} = [0,0,0, \\frac{1}{4}, \\frac{1}{2}, 1,1,1]$。\n\n**步骤 2：在 $\\xi = \\frac{3}{4}$ 处进行第二次节点插入**\n现在我们加细由 $n^{(1)}=5$ 个控制点 $\\mathbf{C}^{(1)}$ 和节点矢量 $\\Xi^{(1)}$ 定义的曲线。设 $\\Xi^{(1)}$ 中的节点为 $\\eta_i$。我们有 $\\Xi^{(1)} = [\\eta_1, \\dots, \\eta_8] = [0,0,0, \\frac{1}{4}, \\frac{1}{2}, 1,1,1]$。我们插入节点 $\\bar{\\xi} = \\frac{3}{4}$。我们找到 $k$ 使得 $\\eta_k \\le \\bar{\\xi}  \\eta_{k+1}$。从 $\\Xi^{(1)}$ 中，我们看到 $\\eta_5 = \\frac{1}{2} \\le \\frac{3}{4}  1 = \\eta_6$，所以 $k=5$。\n\n新的集合将有 $n^{(2)}=5+1=6$ 个控制点 $\\mathbf{C}^{(2)} = [\\mathbf{P}_1^{(2)}, \\dots, \\mathbf{P}_6^{(2)}]^T$。更新规则是：\n- 对于 $i \\le k-p = 3$：$\\mathbf{P}_1^{(2)} = \\mathbf{P}_1^{(1)}$，$\\mathbf{P}_2^{(2)} = \\mathbf{P}_2^{(1)}$，$\\mathbf{P}_3^{(2)} = \\mathbf{P}_3^{(1)}$。\n- 对于 $i \\in [k-p+1, k] = [4, 5]$：\n  - 对于 $i=4$：$\\alpha_4 = \\frac{\\bar{\\xi} - \\eta_4}{\\eta_{4+p} - \\eta_4} = \\frac{\\frac{3}{4} - \\eta_4}{\\eta_6 - \\eta_4} = \\frac{\\frac{3}{4} - \\frac{1}{4}}{1 - \\frac{1}{4}} = \\frac{\\frac{1}{2}}{\\frac{3}{4}} = \\frac{2}{3}$。\n    $\\mathbf{P}_4^{(2)} = (1-\\alpha_4)\\mathbf{P}_3^{(1)} + \\alpha_4 \\mathbf{P}_4^{(1)} = \\frac{1}{3}\\mathbf{P}_3^{(1)} + \\frac{2}{3}\\mathbf{P}_4^{(1)}$。\n  - 对于 $i=5$：$\\alpha_5 = \\frac{\\bar{\\xi} - \\eta_5}{\\eta_{5+p} - \\eta_5} = \\frac{\\frac{3}{4} - \\eta_5}{\\eta_7 - \\eta_5} = \\frac{\\frac{3}{4} - \\frac{1}{2}}{1 - \\frac{1}{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}$。\n    $\\mathbf{P}_5^{(2)} = (1-\\alpha_5)\\mathbf{P}_4^{(1)} + \\alpha_5 \\mathbf{P}_5^{(1)} = \\frac{1}{2}\\mathbf{P}_4^{(1)} + \\frac{1}{2}\\mathbf{P}_5^{(1)}$。\n- 对于 $i \\ge k+1 = 6$：\n  - 对于 $i=6$：$\\mathbf{P}_6^{(2)} = \\mathbf{P}_{6-1}^{(1)} = \\mathbf{P}_5^{(1)}$。\n\n关系 $\\mathbf{C}^{(2)} = \\mathbf{T}^{(2)} \\mathbf{C}^{(1)}$ 由 $6 \\times 5$ 的局部加细矩阵 $\\mathbf{T}^{(2)}$ 定义：\n$$\n\\mathbf{T}^{(2)} = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  \\frac{1}{3}  \\frac{2}{3}  0 \\\\\n0  0  0  \\frac{1}{2}  \\frac{1}{2} \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n最终加细后的节点矢量为 $\\Xi^{(2)} = [0,0,0, \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}, 1,1,1]$，如问题所述。\n\n**全局加细矩阵 $\\mathbf{T}$**\n全局加细矩阵 $\\mathbf{T}$ 将初始控制点矢量 $\\mathbf{C}^{(0)}$ 直接变换到最终控制点矢量 $\\mathbf{C}^{(2)}$。它是两个连续局部加细算子的乘积：\n$\\mathbf{C}^{(2)} = \\mathbf{T}^{(2)}\\mathbf{C}^{(1)} = \\mathbf{T}^{(2)}(\\mathbf{T}^{(1)}\\mathbf{C}^{(0)}) = (\\mathbf{T}^{(2)}\\mathbf{T}^{(1)})\\mathbf{C}^{(0)}$。\n因此，$\\mathbf{T} = \\mathbf{T}^{(2)}\\mathbf{T}^{(1)}$。我们计算这个 $6 \\times 4$ 矩阵的乘积：\n$$\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  \\frac{1}{3}  \\frac{2}{3}  0 \\\\\n0  0  0  \\frac{1}{2}  \\frac{1}{2} \\\\\n0  0  0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0 \\\\\n0  \\frac{3}{4}  \\frac{1}{4}  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n逐行进行矩阵乘法：\n第 1 行: $[1,0,0,0]$\n第 2 行: $[\\frac{1}{2}, \\frac{1}{2}, 0, 0]$\n第 3 行: $[0, \\frac{3}{4}, \\frac{1}{4}, 0]$\n第 4 行: $\\frac{1}{3}[0, \\frac{3}{4}, \\frac{1}{4}, 0] + \\frac{2}{3}[0, 0, 1, 0] = [0, \\frac{1}{4}, \\frac{1}{12}, 0] + [0, 0, \\frac{2}{3}, 0] = [0, \\frac{1}{4}, \\frac{1+8}{12}, 0] = [0, \\frac{1}{4}, \\frac{3}{4}, 0]$\n第 5 行: $\\frac{1}{2}[0, 0, 1, 0] + \\frac{1}{2}[0, 0, 0, 1] = [0, 0, \\frac{1}{2}, \\frac{1}{2}]$\n第 6 行: $[0, 0, 0, 1]$\n\n所以，全局加细矩阵是：\n$$\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0 \\\\\n0  \\frac{3}{4}  \\frac{1}{4}  0 \\\\\n0  \\frac{1}{4}  \\frac{3}{4}  0 \\\\\n0  0  \\frac{1}{2}  \\frac{1}{2} \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n\n**$\\mathbf{T}$ 的性质验证**\n我们从第一性原理出发验证两个性质。\n1.  **非负性 ($T_{ij} \\ge 0$):** 局部加细矩阵的元素是非负的。对于对应未改变控制点的行，元素为 $0$ 或 $1$。对于对应新控制点的行，系数为 $1-\\alpha_i$ 和 $\\alpha_i$。由于 $\\xi_k \\le \\bar{\\xi}  \\xi_{k+1}$，且对于受影响的控制点有 $\\xi_i \\le \\bar{\\xi}$ 和 $\\xi_{i+p} > \\bar{\\xi}$，我们得到 $0 \\le \\alpha_i  1$。因此，$\\mathbf{T}^{(1)}$ 和 $\\mathbf{T}^{(2)}$ 中的所有元素都是非负的。两个非负矩阵的乘积也是一个非负矩阵，因为其元素是非负数的乘积之和：$T_{ij} = \\sum_k T^{(2)}_{ik} T^{(1)}_{kj} \\ge 0$。直接检查计算出的 $\\mathbf{T}$ 可确认其所有元素都是非负的。\n2.  **行和为一 ($\\sum_j T_{ij} = 1$):** 这个性质确保基函数构成单位剖分，这是通过加细继承下来的一个基本性质。对于任何局部加细矩阵，比如 $\\mathbf{A}$，其行和为 $1$。这是因为每个新控制点要么是旧控制点的复制（行中只有一个 $1$），要么是凸组合 $(1-\\alpha)\\mathbf{P}_{j-1} + \\alpha\\mathbf{P}_j$（行元素为 $(1-\\alpha)$ 和 $\\alpha$，和为 $1$）。每行之和为 $1$ 的矩阵称为行随机矩阵。设 $\\mathbf{e}_k$ 是一个包含 $k$ 个1的列向量。行和性质等价于 $\\mathbf{A}\\mathbf{e}_{n} = \\mathbf{e}_{m}$。对于我们的加细矩阵，有 $\\mathbf{T}^{(1)}\\mathbf{e}_{4} = \\mathbf{e}_{5}$ 和 $\\mathbf{T}^{(2)}\\mathbf{e}_{5} = \\mathbf{e}_{6}$。两个行随机矩阵的乘积也是行随机的：\n    $(\\mathbf{T}^{(2)}\\mathbf{T}^{(1)})\\mathbf{e}_4 = \\mathbf{T}^{(2)}(\\mathbf{T}^{(1)}\\mathbf{e}_4) = \\mathbf{T}^{(2)}\\mathbf{e}_5 = \\mathbf{e}_6$。\n    因此，$\\mathbf{T} = \\mathbf{T}^{(2)}\\mathbf{T}^{(1)}$ 的每一行之和必须为 $1$。我们可以在计算出的 $\\mathbf{T}$ 上显式地验证这一点：\n    第 1 行: $1+0+0+0=1$\n    第 2 行: $\\frac{1}{2}+\\frac{1}{2}+0+0=1$\n    第 3 行: $0+\\frac{3}{4}+\\frac{1}{4}+0=1$\n    第 4 行: $0+\\frac{1}{4}+\\frac{3}{4}+0=1$\n    第 5 行: $0+0+\\frac{1}{2}+\\frac{1}{2}=1$\n    第 6 行: $0+0+0+1=1$\n    验证成功。\n\n**$S$ 的最终计算**\n标量 $S$ 是矩阵 $\\mathbf{T}$ 中所有元素的总和：\n$$\nS = \\sum_{i=1}^{6} \\sum_{j=1}^{4} T_{ij}\n$$\n这可以计算为各行和的总和：\n$$\nS = \\sum_{i=1}^{6} \\left( \\sum_{j=1}^{4} T_{ij} \\right)\n$$\n正如我们刚刚证明和验证的，每行的和是 $1$。因此：\n$$\nS = \\sum_{i=1}^{6} 1 = 6\n$$\n$S$ 的值等于最终加细矩阵 $\\mathbf{T}$ 的行数。", "answer": "$$\\boxed{6}$$", "id": "3594387"}, {"introduction": "T样条的开发旨在实现真正的局部加密，避免不必要的节点传播，从而克服了标准B样条加密的全局性限制。本练习提供了一个实际场景 [@problem_id:3594368]，用于分析添加一个T型节点对网格的局部影响。通过量化基函数的变化并识别哪些相邻函数受到影响，你将能深刻体会到分析适应性T样条（ASTS）的强大功能和其背后的力学原理。", "problem": "考虑参数域 $\\Omega$ 上的一个二次分析适应性T样条 (ASTS) 基，其初始T网格是均匀的，由位于 $u=0,1,2,3$ 的垂直线和位于 $v=0,1,2,3$ 的水平线定义。因此，该网格包含由这些线界定的 $3\\times 3$ 个面。对于二次次数 ($p=q=2$)，锚点与面中心相关联，基函数的数量等于面的数量。使用标识符映射 $I(i,j)=(j-1)\\cdot 3+i$ 对锚点按行主序的面排序进行索引，其中列 $i\\in\\{1,2,3\\}$，行 $j\\in\\{1,2,3\\}$，因此中心面 $(i=2,j=2)$ 的标识符为 $I(2,2)=5$。\n\n一次局部加密通过在中心面 $(i=2,j=2)$ 内部添加一条位于 $u=1.5$ 的垂直网格段来插入一个T型节点。该网格段从上边缘 $v=2$ 开始，终止于下边缘的中点 $v=1$，从而在 $(u=1.5,v=1)$ 处创建一个T型节点。这将中心面分裂为两个面：一个左子面 $(2\\mathrm{L},2)$，其 $u\\in[1,1.5]$；以及一个右子面 $(2\\mathrm{R},2)$，其 $u\\in[1.5,2]$。为这些新增的锚点分配新标识符 $I(2\\mathrm{L},2)=10$ 和 $I(2\\mathrm{R},2)=11$。假设 $p=q=2$ 的分析适应性T样条延伸规则完全在行 $j=2$ 内强制执行，因此不会创建额外的面，且没有T型节点延伸相交；位于 $u=1.5$ 的新垂直段成为行 $j=2$ 中与中心面在 $u$ 方向上相邻的锚点的局部索引选择的一部分。\n\n仅使用偶数次 ($p=2$) 分析适应性T样条的定义属性以及从相邻网格线构造局部索引向量的方法，确定：\n- 加密后基函数总数的变化量 $\\Delta N$。\n- 通过加密添加的锚点的标识符。\n- 因插入位于 $u=1.5$ 的垂直段而导致其局部索引向量发生改变的锚点的标识符（这些锚点仍然存在），特别是在行 $j=2$ 内。\n\n将您的最终答案表示为一个单行矩阵，其中包含按以下顺序排列的五个条目：$\\Delta N$, $I_{\\text{add},1}$, $I_{\\text{add},2}$, $I_{\\text{alt},1}$, $I_{\\text{alt},2}$。无需进行四舍五入。", "solution": "该问题要求对二次分析适应性T样条 (ASTS) 基上的一个局部加密步骤进行分析。我们必须确定基函数数量的变化，识别新增的基函数（通过它们的锚点标识符），并识别因加密而定义被改变的现有基函数。\n\n首先，我们确定初始状态。问题定义了参数域 $\\Omega$ 上的一个均匀 $3 \\times 3$ T网格，其节点线位于 $u \\in \\{0, 1, 2, 3\\}$ 和 $v \\in \\{0, 1, 2, 3\\}$。这创建了 $9$ 个面。对于二次ASTS ($p=q=2$)，面、锚点和基函数之间存在一一对应关系。因此，初始基函数的数量为 $N_0 = 9$。锚点使用映射 $I(i,j) = (j-1) \\cdot 3 + i$ 进行索引，其中 $i$ 为列，$j$ 为行。中心行 ($j=2$) 的锚点是：\n- $I(1,2) = (2-1) \\cdot 3 + 1 = 4$\n- $I(2,2) = (2-1) \\cdot 3 + 2 = 5$\n- $I(3,2) = (2-1) \\cdot 3 + 3 = 6$\n\n局部加密操作包括插入一条位于 $u=1.5$ 的垂直网格段，该段从 $v=2$ 延伸到 $v=1$。此段平分了对应于锚点 $I(2,2) = 5$ 的中心面。原始面由 $u \\in [1,2]$ 和 $v \\in [1,2]$ 定义，被两个新面所取代：一个左子面，其 $u \\in [1,1.5]$；一个右子面，其 $u \\in [1.5,2]$，两者都在 $v \\in [1,2]$ 上。\n\n1.  **基函数数量的变化 ($\\Delta N$)**\n    基函数的数量等于面（和锚点）的数量。所描述的加密移除了一个面（原始中心面），并在其位置上添加了两个新面。\n    - 初始面/基函数数量：$N_0 = 9$。\n    - 最终面/基函数数量：$N_f = N_0 - 1 + 2 = 10$。\n    基函数总数的变化是：\n    $$ \\Delta N = N_f - N_0 = 10 - 9 = 1 $$\n\n2.  **新增锚点的标识符 ($I_{\\text{add}}$)**\n    加密将原始中心面 $I(2,2)=5$ 的锚点替换为对应于两个新子面的两个新锚点。问题陈述明确为这些新锚点分配了标识符：\n    - 左子面 $(2\\mathrm{L},2)$ 的锚点：$I(2\\mathrm{L},2) = 10$。\n    - 右子面 $(2\\mathrm{R},2)$ 的锚点：$I(2\\mathrm{R},2) = 11$。\n    因此，新增锚点的标识符是 $10$ 和 $11$。\n\n3.  **被改变锚点的标识符 ($I_{\\text{alt}}$)**\n    与锚点 $a$ 关联的T样条基函数 $N_a$ 的定义由其局部节点向量确定。对于二次 ($p=2$) T样条，在给定参数方向（例如 $u$ 方向）上的局部节点向量是通过从锚点沿正向和负向发出射线，收集其穿过的头 $p/2+1 = 2/2+1 = 2$ 条不同网格线的节点值来构造的。如果一个现有基函数的局部节点向量发生变化，则该基函数被改变。当它“看到”的网格线集合发生变化时，就会发生这种情况。\n\n    加密仅在区间 $v \\in [1,2]$ 上引入了一条位于 $u=1.5$ 的新垂直段。这意味着只有那些射线发出时 $v$ 坐标在此区间内的锚点才会受到影响。锚点位于其各自面的中心。\n    - 第 $j=1$ 行的锚点（例如，$I(1,1)=1$, $I(2,1)=2$, $I(3,1)=3$）：这些锚点中心位于 $v=0.5$。从这些锚点发出的射线不穿过 $v$ 区间 $[1,2]$，因此“看不到”位于 $u=1.5$ 的新线。它们的局部索引向量不变。\n    - 第 $j=3$ 行的锚点（例如，$I(1,3)=7$, $I(2,3)=8$, $I(3,3)=9$）：这些锚点中心位于 $v=2.5$。出于同样的原因，它们的局部索引向量也不变。\n    - 第 $j=2$ 行的锚点（例如，$I(1,2)=4$, $I(3,2)=6$）：这些锚点中心位于 $v=1.5$，该值位于区间 $v \\in [1,2]$ 内。它们在 $u$ 方向上的局部索引向量可能会被改变。我们来分析它们。\n\n    **锚点 $I(1,2)=4$**：此锚点位于面 $[0,1] \\times [1,2]$ 的中心，坐标为 $(0.5, 1.5)$。\n    - 我们检查从 $u=0.5$ 处沿正 $u$ 方向发出的射线。\n    - **加密前**：垂直网格线的集合为 $\\{0, 1, 2, 3\\}$。射线首先穿过 $u=1$，然后是 $u=2$。收集到的线为 $\\{1, 2\\}$。\n    - **加密后**：从 $v=1.5$ 可见的垂直网格线集合为 $\\{0, 1, 1.5, 2, 3\\}$。射线首先穿过 $u=1$，然后是 $u=1.5$。收集到的线为 $\\{1, 1.5\\}$。\n    - 由于用于构造局部节点向量的线集发生了变化，与锚点 $4$ 关联的基函数被改变。\n\n    **锚点 $I(3,2)=6$**：此锚点位于面 $[2,3] \\times [1,2]$ 的中心，坐标为 $(2.5, 1.5)$。\n    - 我们检查从 $u=2.5$ 处沿负 $u$ 方向发出的射线。\n    - **加密前**：垂直网格线的集合为 $\\{0, 1, 2, 3\\}$。射线首先穿过 $u=2$，然后是 $u=1$。收集到的线为 $\\{2, 1\\}$。\n    - **加密后**：从 $v=1.5$ 可见的垂直网格线集合为 $\\{0, 1, 1.5, 2, 3\\}$。射线首先穿过 $u=2$，然后是 $u=1.5$。收集到的线为 $\\{2, 1.5\\}$。\n    - 锚点 $6$ 的局部节点向量也被改变。\n\n    问题通过特别询问“在行 $j=2$ 内”被改变的锚点来证实了我们的分析范围。锚点 $I(2,2)=5$ 被移除，而不是被改变。因此，其基函数被改变的锚点的标识符是 $4$ 和 $6$。\n\n    **结果总结：**\n    - 基函数数量的变化：$\\Delta N = 1$。\n    - 新增锚点的标识符：$10$ 和 $11$。\n    - 在行 $j=2$ 中被改变的锚点的标识符：$4$ 和 $6$。\n\n    最终答案是一个行矩阵，按指定顺序包含这五个值：$(\\Delta N, I_{\\text{add},1}, I_{\\text{add},2}, I_{\\text{alt},1}, I_{\\text{alt},2})$。我们将按升序列出新增和被改变的标识符。\n\n    最终的值集是 $(1, 10, 11, 4, 6)$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1  10  11  4  6 \\end{pmatrix} } $$", "id": "3594368"}]}