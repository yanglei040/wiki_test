{"hands_on_practices": [{"introduction": "本练习侧重于塑性模型的物理基础。通过使用量纲分析——一种在物理和工程中极为强大的工具——我们可以揭示材料参数之间的基本关系。本实践将引导您从 Orowan 关系和位错迁移率定律中推导出一个特征时间尺度，从而增强您对微观机制如何决定宏观响应速率的物理直觉。[@problem_id:3552438]", "problem": "一个具有单一活动滑移系的单晶承受柯西应力张量 $\\boldsymbol{\\sigma}$，使得滑移系上的分解剪应力为 $\\tau = \\boldsymbol{s} \\cdot \\boldsymbol{\\sigma} \\, \\boldsymbol{m}$，其中 $\\boldsymbol{s}$ 是滑移方向上的单位矢量，$\\boldsymbol{m}$ 是滑移面的单位法向量。假设该滑移系上的塑性滑移速率遵循基于位错的 Orowan 关系式 $\\dot{\\gamma} = \\rho \\, b \\, v$，其中 $\\rho$ 是总可动位错线密度，$b$ 是伯格斯矢量的大小，$v$ 是沿滑移方向的平均位错速度。假设一个应力控制的迁移率法则 $v(\\tau,g) = M \\, g \\, \\varphi(\\tau/g)$，其中 $g$ 是当前的滑移阻力（其物理量纲与剪应力相同），$M$ 是一个恒定的迁移率系数，$\\varphi$ 是一个无量纲函数，满足 $\\varphi(1)=1$ 且仅依赖于比值 $\\tau/g$。\n\n从这些陈述出发，仅使用单位一致性和标度论证，构建一个特征时间尺度 $t_{\\star}$，使得无量纲滑移速率 $\\widehat{\\dot{\\gamma}} = \\dot{\\gamma} \\, t_{\\star}$ 可简化为 $\\widehat{\\dot{\\gamma}} = \\varphi(\\widehat{\\tau})$，其中 $\\widehat{\\tau} = \\tau/g$。推导 $t_{\\star}$ 关于 $\\rho$、$b$、$M$ 和 $g$ 的显式表达式。将所有时间尺度以秒表示。最终答案必须是 $t_{\\star}$ 的一个单一闭式解析表达式。", "solution": "问题要求为一个单晶塑性模型推导一个特征时间尺度 $t_{\\star}$。推导过程需要基于单位一致性和标度论证，并从所提供的本构关系出发。\n\n首先，我们陈述给定的物理定律。给定滑移系上的塑性滑移速率 $\\dot{\\gamma}$ 由 Orowan 关系式描述：\n$$\n\\dot{\\gamma} = \\rho \\, b \\, v\n$$\n其中 $\\rho$ 是可动位错密度，$b$ 是伯格斯矢量的大小，$v$ 是平均位错速度。\n\n位错速度 $v$ 本身是分解剪应力 $\\tau$ 和滑移阻力 $g$ 的函数。给定的迁移率法则是：\n$$\nv(\\tau, g) = M \\, g \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n此处，$M$ 是一个迁移率系数，$\\varphi$ 是归一化应力 $\\tau/g$ 的一个无量纲函数。\n\n目标是找到一个特征时间尺度 $t_{\\star}$，使得定义为 $\\widehat{\\dot{\\gamma}} = \\dot{\\gamma} \\, t_{\\star}$ 的无量纲滑移速率可以纯粹表示为无量纲应力 $\\widehat{\\tau} = \\tau/g$ 的函数。具体来说，目标关系是：\n$$\n\\widehat{\\dot{\\gamma}} = \\varphi(\\widehat{\\tau})\n$$\n它可以写成：\n$$\n\\dot{\\gamma} \\, t_{\\star} = \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\n为了找到 $t_{\\star}$ 的表达式，我们可以将给定的定律相互代入。我们首先将位错速度 $v$ 的表达式代入 $\\dot{\\gamma}$ 的 Orowan 关系式中：\n$$\n\\dot{\\gamma} = \\rho \\, b \\, \\left(M \\, g \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\\right)\n$$\n这个方程可以通过组合各项来重新整理：\n$$\n\\dot{\\gamma} = (\\rho \\, b \\, M \\, g) \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\n现在，我们将这个推导出的 $\\dot{\\gamma}$ 表达式与目标无量纲形式进行比较。目标形式可以重新整理以表达 $\\dot{\\gamma}$：\n$$\n\\dot{\\gamma} = \\frac{1}{t_{\\star}} \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\n为了使这两个 $\\dot{\\gamma}$ 的表达式对于任何非平凡函数 $\\varphi$ 都等效，乘以函数 $\\varphi(\\tau/g)$ 的系数必须相等。因此，我们可以令相应的项相等：\n$$\n\\rho \\, b \\, M \\, g = \\frac{1}{t_{\\star}}\n$$\n\n解此方程得到特征时间尺度 $t_{\\star}$，即为所求的表达式：\n$$\nt_{\\star} = \\frac{1}{\\rho \\, b \\, M \\, g}\n$$\n\n为确保此结果的正确性，我们进行量纲分析，以确认 $t_{\\star}$ 的确具有时间的单位。令 $[X]$ 表示物理量 $X$ 以质量 ($M_{\\text{dim}}$)、长度 ($L$) 和时间 ($T$) 等基本量纲表示的物理量纲。\n\n*   滑移速率 $\\dot{\\gamma}$ 是剪切应变率，其量纲为时间的倒数。因此，$[\\dot{\\gamma}] = T^{-1}$。\n*   位错密度 $\\rho$ 是单位体积内的位错线长度。因此，$[\\rho] = L/L^3 = L^{-2}$。\n*   伯格斯矢量大小 $b$ 是一个长度。因此，$[b] = L$。\n*   位错速度 $v$ 是长度每单位时间。因此，$[v] = L T^{-1}$。\n*   Orowan 关系式在量纲上是一致的：$[\\dot{\\gamma}] = [\\rho][b][v] \\implies T^{-1} = (L^{-2})(L)(L T^{-1}) = T^{-1}$。\n*   分解剪应力 $\\tau$ 和滑移阻力 $g$ 具有应力（力/面积）的量纲。力的量纲是 $M_{\\text{dim}} L T^{-2}$，所以应力的量纲是 $M_{\\text{dim}} L^{-1} T^{-2}$。因此，$[\\tau] = [g] = M_{\\text{dim}} L^{-1} T^{-2}$。\n*   函数 $\\varphi$ 及其参数 $\\tau/g$ 是无量纲的。\n*   从迁移率法则 $v = M g \\varphi(\\tau/g)$，我们可以找到迁移率系数 $M$ 的量纲：\n    $$[M] = \\frac{[v]}{[g]} = \\frac{L T^{-1}}{M_{\\text{dim}} L^{-1} T^{-2}} = M_{\\text{dim}}^{-1} L^2 T$$\n*   现在，我们检查我们推导的 $t_{\\star}$ 表达式的量纲：\n    $$[t_{\\star}] = \\frac{1}{[\\rho][b][M][g]} = \\frac{1}{(L^{-2})(L)(M_{\\text{dim}}^{-1} L^{2} T)(M_{\\text{dim}} L^{-1} T^{-2})}$$\n    组合分母中每个基本量纲的指数：\n    *   质量 ($M_{\\text{dim}}$): $-1 + 1 = 0$\n    *   长度 ($L$): $-2 + 1 + 2 - 1 = 0$\n    *   时间 ($T$): $1 - 2 = -1$\n    所以，分母的量纲是 $[ \\rho \\, b \\, M \\, g ] = T^{-1}$。\n*   因此，$t_{\\star}$ 的量纲是：\n    $$[t_{\\star}] = \\frac{1}{T^{-1}} = T$$\n这证实了推导出的 $t_{\\star}$ 表达式具有时间的物理量纲。在国际单位制（SI）中，其单位是秒。问题陈述要求“将所有时间尺度以秒表示”，通过推导一个量纲上为时间的表达式，这个要求得到了满足。\n\n提供的条件 $\\varphi(1)=1$ 可以作为一个额外的检验。当 $\\tau=g$ 时，我们有 $\\widehat{\\tau} = 1$。目标形式给出 $\\widehat{\\dot{\\gamma}} = \\varphi(1) = 1$，这意味着 $\\dot{\\gamma} t_{\\star} = 1$，或 $\\dot{\\gamma} = 1/t_{\\star}$。从本构定律可知，当 $\\tau=g$ 时，速度为 $v = M g \\varphi(1) = M g$。滑移速率则为 $\\dot{\\gamma} = \\rho b v = \\rho b M g$。将两个 $\\dot{\\gamma}$ 的结果相等，得到 $1/t_{\\star} = \\rho b M g$，这再次得出 $t_{\\star} = 1/(\\rho b M g)$。这加强了结果的有效性。\n\n如要求，最终表达式仅依赖于材料参数 $\\rho$、$b$、$M$ 和内状态变量 $g$。", "answer": "$$\n\\boxed{\\frac{1}{\\rho \\, b \\, M \\, g}}\n$$", "id": "3552438"}, {"introduction": "建立计算模型的一个关键步骤是验证：确保代码正确地求解了预设的数学方程。本实践涉及计算力学的一个基石：为一个简化的单滑移模型推导出一个封闭形式的解析解，并用它来验证数值实现。掌握这一过程对于建立对更复杂模拟结果的信心至关重要。[@problem_id:3552456]", "problem": "考虑一个承受简剪切的单晶体的小应变、率无关、单滑移本构模型。目标是在单调加载下，通过解析闭式解来验证一个计算实现。材料响应被限制在小应变范围内，应力为柯西应力。使用以下基本原理和定义。\n\n1. 运动学和弹性：在量值为 $\\gamma$ 的工程简剪切作用下，小应变张量的非零分量为 $e_{xy} = \\gamma/2$。对于剪切模量为 $G$ 的各向同性线弹性体，剪切应力为 $\\sigma_{xy} = 2 G e^{e}_{xy}$，其中 $e^{e}_{xy}$ 是弹性剪切应变。在纯剪切加载中，由于 $e_{xy} = e^{e}_{xy} + e^{p}_{xy}$，该式可简化为 $\\sigma_{xy} = G \\gamma - 2 G e^{p}_{xy}$。\n\n2. 滑移引起的塑性应变：对于具有单位滑移方向 $m$ 和单位滑移面法向 $n$（其中 $m \\perp n$）的单个滑移系，塑性应变张量为 $e^{p} = \\gamma_{p} \\operatorname{sym}(m \\otimes n)$，其中 $\\gamma_{p}$ 是塑性滑移，且 $\\operatorname{sym}(m \\otimes n) = \\frac{1}{2} \\left(m \\otimes n + n \\otimes m\\right)$。因此，塑性剪切应变分量为 $e^{p}_{xy} = \\gamma_{p} S_{xy}$，其中 $S_{xy} = \\frac{m_{x} n_{y} + m_{y} n_{x}}{2}$。\n\n3. 分解剪切应力：滑移系上的分解剪切应力为 $\\tau = m \\cdot \\sigma \\cdot n = m_{i} \\sigma_{ij} n_{j}$。对于纯剪切应力 $\\sigma_{xy}$，该式简化为 $\\tau = 2 S_{xy} \\sigma_{xy}$。\n\n4. 流动法则和硬化：带有线性各向同性硬化的率无关流动法则为 $|\\tau| = \\tau_{0} + h \\, \\gamma_{p}^{\\mathrm{eq}}$，其中 $\\tau_{0}$ 是初始临界分解剪切应力，$h$ 是硬化模量，对于单滑移，$\\gamma_{p}^{\\mathrm{eq}} = |\\gamma_{p}|$。在单调加载下，$\\gamma_{p}$ 的符号与 $\\tau$ 的符号相匹配，当满足屈服准则时，滑移激活条件生效。\n\n任务：从上述基础出发，推导并实现 $\\sigma_{xy}$ 作为施加的工程剪切 $\\gamma$、剪切模量 $G$、滑移取向 $(m, n)$、初始临界分解剪切应力 $\\tau_{0}$ 和硬化模量 $h$ 的函数的解析分段解。\n\n要求：\n- 通过强制分解剪切应力与流动法则的平衡，推导屈服剪切 $\\gamma_{y}$ 和塑性滑移 $\\gamma_{p}$ 作为输入参数的函数。\n- 对于在所施加应力下，滑移系不承受分解剪切 ($S_{xy} = 0$) 的加载情况，确保解析解简化为纯弹性响应。\n- 在一个程序中实现推导出的分段公式，为下面的每个测试用例计算 $\\sigma_{xy}$。\n\n物理和数值单位：\n- 所有应力必须以帕斯卡表示。\n- 工程剪切 $\\gamma$ 是无量纲的。\n- 最终输出必须以帕斯卡表示，为浮点数。\n\n测试套件：\n使用以下参数集，以国际单位制 (SI) 表示。在所有情况下，材料的剪切模量为 $G = 25 \\times 10^{9}$ Pa，初始临界分解剪切应力为 $\\tau_{0} = 50 \\times 10^{6}$ Pa。滑移方向和法向以 $\\mathbb{R}^{3}$ 中的单位向量给出，$h$ 的单位为帕斯卡。\n1. 情况 A (屈服后，正剪切): $h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.01$。\n2. 情况 B (屈服前): $h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.001$。\n3. 情况 C (理想塑性，屈服后): $h = 0$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.05$。\n4. 情况 D (在此加载状态下不活动的滑移取向): $h = 200 \\times 10^{6}$ Pa, $m = \\left(\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0\\right)$, $n = \\left(\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2}, 0\\right)$, $\\gamma = 0.01$。\n5. 情况 E (屈服后，负剪切): $h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = -0.01$。\n\n程序输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果 (例如：\"[$\\text{result1}$,$\\text{result2}$,$\\text{result3}$]\")。\n- 该列表必须按 A、B、C、D、E 的顺序包含五个情况计算出的 $\\sigma_{xy}$ 值，单位为帕斯卡。", "solution": "问题陈述被评估为有效。它基于连续介质力学和晶体塑性力学的原理，具有科学依据，并且问题适定，目标明确，数据充分，使用客观、正式的语言进行表述。所提供的参数和条件是自洽且物理上合理的。因此，我们可以进行推导和求解。\n\n目标是推导剪切应力 $\\sigma_{xy}$ 作为施加的工程剪切应变 $\\gamma$ 的函数的解析分段表达式。该推导基于所提供的、用于小应变条件下率无关单滑移模型的一组本构方程。\n\n控制方程如下：\n1.  总应变 $e_{xy}$ 分解为弹性部分 $e^e_{xy}$ 和塑性部分 $e^p_{xy}$：$e_{xy} = e^e_{xy} + e^p_{xy}$。总剪切应变由 $e_{xy} = \\gamma / 2$ 给出。\n2.  弹性应力-应变关系（剪切胡克定律）：$\\sigma_{xy} = 2 G e^e_{xy}$，其中 $G$ 是剪切模量。结合应变分解，我们得到 $\\sigma_{xy} = 2 G (e_{xy} - e^p_{xy}) = G \\gamma - 2 G e^p_{xy}$。\n3.  源于滑移的塑性应变：塑性剪切应变分量 $e^p_{xy}$ 通过 $e^p_{xy} = \\gamma_p S_{xy}$ 与特定滑移系上的塑性滑移量 $\\gamma_p$ 相关联，其中 $S_{xy} = \\frac{1}{2}(m_x n_y + m_y n_x)$ 是简剪切的几何因子，由滑移方向向量 $m$ 和滑移面法向向量 $n$ 推导得出。\n4.  分解剪切应力：驱动滑移的应力是分解剪切应力 $\\tau$，对于纯剪切应力状态 $\\sigma_{xy}$，其表达式为 $\\tau = 2 S_{xy} \\sigma_{xy}$。\n5.  屈服准则和流动法则（库恩-塔克条件）：只有当分解剪切应力达到临界值时，才会发生塑性滑移。对于线性各向同性硬化，这由 $|\\tau| = \\tau_0 + h \\gamma_p^{\\mathrm{eq}}$ 给出，其中 $\\tau_0$ 是初始临界分解剪切应力，$h$ 是硬化模量，对于单滑移，$\\gamma_p^{\\mathrm{eq}} = |\\gamma_p|$。如果 $|\\tau|  \\tau_0 + h |\\gamma_p|$，则滑移不激活（$\\gamma_p=0$）。对于单调加载，塑性滑移的符号遵循分解剪切应力的符号：$\\operatorname{sgn}(\\gamma_p) = \\operatorname{sgn}(\\tau)$。\n\n现在我们可以通过考虑弹性和塑性区域来推导分段解。\n\n**1. 弹性区**\n在弹性区，没有塑性滑移，因此 $\\gamma_p = 0$。\n- 根据方程(3)，塑性应变为零：$e^p_{xy} = 0$。\n- 根据方程(2)，应力-应变关系是线性的：$\\sigma_{xy} = G \\gamma$。\n- 此时分解剪切应力为 $\\tau = 2 S_{xy} \\sigma_{xy} = 2 S_{xy} G \\gamma$。\n只要未满足屈服准则，即 $|\\tau| \\le \\tau_0$，该区域就成立。代入 $\\tau$ 的表达式：\n$$|2 S_{xy} G \\gamma| \\le \\tau_0$$\n$$|\\gamma| \\le \\frac{\\tau_0}{2 G |S_{xy}|}$$\n这定义了屈服剪切应变 $\\gamma_y$:\n$$\\gamma_y = \\frac{\\tau_0}{2 G |S_{xy}|}$$\n因此，对于施加的剪切 $|\\gamma| \\le \\gamma_y$，材料响应是纯弹性的，且 $\\sigma_{xy} = G \\gamma$。\n\n如果 $S_{xy}=0$，则出现一种特殊情况。在这种情况下，对于任何施加的应力，分解剪切应力 $\\tau = 2 S_{xy} \\sigma_{xy} = 0$。由于 $\\tau_0 > 0$，屈服准则 $|\\tau| \\ge \\tau_0$ 永远无法满足。因此，$\\gamma_p$ 始终为零，对于所有的 $\\gamma$ 值，响应都是纯弹性的：$\\sigma_{xy} = G \\gamma$。\n\n**2. 塑性区**\n当 $|\\gamma| > \\gamma_y$ (且 $S_{xy} \\neq 0$) 时，发生塑性滑移。必须同时求解该方程组。对于单调加载，屈服条件是激活的：\n$$|\\tau| = \\tau_0 + h |\\gamma_p|$$\n我们来建立符号约定。对于从零应力状态开始的单调加载，我们可以假设 $\\operatorname{sgn}(\\sigma_{xy}) = \\operatorname{sgn}(\\gamma)$。分解剪切应力的符号为 $\\operatorname{sgn}(\\tau) = \\operatorname{sgn}(2 S_{xy} \\sigma_{xy}) = \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\sigma_{xy}) = \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$。流动法则要求 $\\operatorname{sgn}(\\gamma_p) = \\operatorname{sgn}(\\tau)$。\n因此，$\\gamma_p = |\\gamma_p| \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$。\n\n应力表达式（方程2）可以使用方程(3)展开：\n$$\\sigma_{xy} = G \\gamma - 2 G S_{xy} \\gamma_p = G \\gamma - 2 G S_{xy} \\left( |\\gamma_p| \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma) \\right)$$\n$$\\sigma_{xy} = G \\gamma - 2 G |S_{xy}| \\operatorname{sgn}(\\gamma) |\\gamma_p|$$\n激活的屈服准则可以写成 $\\tau = (\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\tau)$。代入 $\\tau = 2 S_{xy} \\sigma_{xy}$ 和 $\\operatorname{sgn}(\\tau)$:\n$$2 S_{xy} \\sigma_{xy} = (\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$$\n两边除以 $2S_{xy}$ 得到 $\\sigma_{xy}$ 的第二个表达式：\n$$\\sigma_{xy} = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)}{2 S_{xy}} = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\gamma)}{2 |S_{xy}|}$$\n令 $\\sigma_{xy}$ 的两个表达式相等：\n$$G \\gamma - 2 G |S_{xy}| \\operatorname{sgn}(\\gamma) |\\gamma_p| = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\gamma)}{2 |S_{xy}|}$$\n为了求解 $|\\gamma_p|$，我们可以将整个方程乘以 $\\operatorname{sgn}(\\gamma)$ (因为 $|\\operatorname{sgn}(\\gamma)|=1$)：\n$$G |\\gamma| - 2 G |S_{xy}| |\\gamma_p| = \\frac{\\tau_0 + h |\\gamma_p|}{2 |S_{xy}|}$$\n$$2 G |S_{xy}| |\\gamma| - 4 G S_{xy}^2 |\\gamma_p| = \\tau_0 + h |\\gamma_p|$$\n$$|\\gamma_p| (h + 4 G S_{xy}^2) = 2 G |S_{xy}| |\\gamma| - \\tau_0$$\n$$|\\gamma_p| = \\frac{2 G |S_{xy}| |\\gamma| - \\tau_0}{h + 4 G S_{xy}^2}$$\n这个 $|\\gamma_p|$ 的表达式在 $|\\gamma| > \\gamma_y$ 时有效。请注意，在屈服点处，即 $|\\gamma|=\\gamma_y=\\tau_0/(2G|S_{xy}|)$ 时，分子变为零，正确地得出 $|\\gamma_p|=0$。\n\n最后，我们将 $|\\gamma_p|$ 代回到 $\\sigma_{xy}$ 的更简单表达式中：\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\tau_0 + h \\left( \\frac{2 G |S_{xy}| |\\gamma| - \\tau_0}{h + 4 G S_{xy}^2} \\right) \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{\\tau_0 (h + 4 G S_{xy}^2) + h (2 G |S_{xy}| |\\gamma| - \\tau_0)}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{\\tau_0 h + 4 G S_{xy}^2 \\tau_0 + 2 G h |S_{xy}| |\\gamma| - h \\tau_0}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{4 G S_{xy}^2 \\tau_0 + 2 G h |S_{xy}| |\\gamma|}{h + 4 G S_{xy}^2} \\right]$$\n从括号内的分子中分解出 $2G|S_{xy}|$：\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{2 G |S_{xy}| (2 |S_{xy}| \\tau_0 + h |\\gamma|)}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\operatorname{sgn}(\\gamma) \\frac{G (2 |S_{xy}| \\tau_0 + h |\\gamma|)}{h + 4 G S_{xy}^2}$$\n使用 $\\gamma = |\\gamma| \\operatorname{sgn}(\\gamma)$，我们得到塑性区的最终表达式：\n$$\\sigma_{xy} = \\frac{G (2 |S_{xy}| \\tau_0 \\operatorname{sgn}(\\gamma) + h \\gamma)}{h + 4 G S_{xy}^2}$$\n\n**分段解总结**\n\n1.  计算几何因子 $S_{xy} = \\frac{1}{2}(m_x n_y + m_y n_x)$。\n2.  如果 $S_{xy} = 0$，响应始终是弹性的：\n    $$\\sigma_{xy} = G \\gamma$$\n3.  如果 $S_{xy} \\neq 0$，计算屈服剪切应变 $\\gamma_y = \\frac{\\tau_0}{2 G |S_{xy}|}$。\n    a.  如果 $|\\gamma| \\le \\gamma_y$ (弹性区):\n        $$\\sigma_{xy} = G \\gamma$$\n    b.  如果 $|\\gamma| > \\gamma_y$ (塑性区):\n        $$\\sigma_{xy} = \\frac{G (2 |S_{xy}| \\tau_0 \\operatorname{sgn}(\\gamma) + h \\gamma)}{h + 4 G S_{xy}^2}$$\n\n实现将对每个测试用例遵循此逻辑。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the shear stress for a single crystal under simple shear\n    based on an analytical single-slip constitutive model.\n    \"\"\"\n    G = 25.0e9  # Shear modulus in Pa\n    tau0 = 50.0e6  # Initial critical resolved shear stress in Pa\n\n    # Test cases: (h, m, n, gamma)\n    test_cases = [\n        # Case A: Post-yield, positive shear\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.01),\n        # Case B: Pre-yield\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.001),\n        # Case C: Perfect plasticity, post-yield\n        (0.0, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.05),\n        # Case D: Inactive slip orientation\n        (200.0e6, np.array([np.sqrt(2)/2, np.sqrt(2)/2, 0.0]), np.array([np.sqrt(2)/2, -np.sqrt(2)/2, 0.0]), 0.01),\n        # Case E: Post-yield, negative shear\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), -0.01)\n    ]\n\n    results = []\n\n    for h, m, n, gamma in test_cases:\n        # 1. Calculate the geometric factor S_xy\n        # S_xy = (m_x * n_y + m_y * n_x) / 2\n        S_xy = 0.5 * (m[0] * n[1] + m[1] * n[0])\n\n        sigma_xy = 0.0\n\n        # 2. Check if the slip system is active for this loading\n        # np.isclose is used for robust floating-point comparison\n        if np.isclose(S_xy, 0.0):\n            # Purely elastic response if the resolved shear stress is always zero\n            sigma_xy = G * gamma\n        else:\n            # 3. Calculate yield shear strain\n            abs_S_xy = np.abs(S_xy)\n            gamma_y = tau0 / (2.0 * G * abs_S_xy)\n\n            # 4. Determine if loading is elastic or plastic\n            if np.abs(gamma) = gamma_y:\n                # a. Elastic regime\n                sigma_xy = G * gamma\n            else:\n                # b. Plastic regime\n                sign_gamma = np.sign(gamma)\n                \n                # Numerator of the analytical solution for the plastic regime\n                numerator = G * (2.0 * abs_S_xy * tau0 * sign_gamma + h * gamma)\n                \n                # Denominator of the analytical solution for the plastic regime\n                denominator = h + 4.0 * G * S_xy**2\n                \n                sigma_xy = numerator / denominator\n\n        results.append(sigma_xy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3552456"}, {"introduction": "从微小变形过渡到有限变形会引入显著的复杂性，尤其是在如何正确更新塑性变形梯度 $F^{\\mathrm p}$ 方面。本练习旨在解决现代晶体塑性实现方法的核心问题：使用指数映射对流动法则进行客观积分。您将推导出这个基本更新格式，并数值验证其基本属性，例如客观性和体积守恒，这些对于物理上真实的模拟至关重要。[@problem_id:3552451]", "problem": "考虑一个处于有限变形状态下的单晶，其总变形梯度可通过运动学乘法分解为弹性和塑性两部分，即 $F = F^{\\mathrm e} F^{\\mathrm p}$。重点关注由点阵（中间）构型中的晶体滑移驱动的塑性变形梯度 $F^{\\mathrm p}$ 的演化。假设塑性速度梯度 $L^{\\mathrm p}$ 的基本定义为各滑移系上剪切速率的叠加，即 $L^{\\mathrm p} = \\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} \\, s_{\\alpha} \\otimes m_{\\alpha}$，其中 $s_{\\alpha}$ 是单位滑移方向，$m_{\\alpha}$ 是单位滑移面法线，且满足 $s_{\\alpha} \\cdot m_{\\alpha} = 0$，而 $\\dot{\\gamma}_{\\alpha}$ 是滑移系 $\\alpha$ 上的滑移速率。定义塑性流动的速率方程为 $ \\dot{F}^{\\mathrm p} = L^{\\mathrm p} F^{\\mathrm p}$。假设 $L^{\\mathrm p}$ 在点阵参考系中计算，并在所关注的时间增量内保持恒定。\n\n从速率方程 $ \\dot{F}^{\\mathrm p} = L^{\\mathrm p} F^{\\mathrm p}$ 出发，根据第一性原理推导在步长内 $L^{\\mathrm p}$ 为常数时，$F^{\\mathrm p}$ 在大小为 $\\Delta t$ 的时间增量上的客观有限步长更新。您的推导必须指明在点阵参考系发生真正交旋转变化时保证客观性的数学结构，以及当所有 $\\alpha$ 均满足 $s_{\\alpha} \\cdot m_{\\alpha} = 0$ 时晶体塑性的等体积特性。推导仅可基于以下内容：乘法分解、塑性速度梯度定义为并矢和、时不变矩阵 $A$ 的线性常微分方程 $ \\dot{X} = A X$，以及在叠加点阵旋转 $Q$ (其中 $Q^{\\mathsf T} Q = I$) 下的客观性定义。\n\n在一个程序中实现您推导的算法，以评估指定的测试用例。在下面的所有测试中，使用三维向量和矩阵。角度（如果使用）必须以弧度为单位进行解释。输出不需要物理单位。\n\n测试套件规范：\n\n- 测试 1（正常路径，两个活动滑移系）：取两个滑移系，$s_{1} = [\\,1,\\,0,\\,0\\,]^{\\mathsf T}$，$m_{1} = [\\,0,\\,1,\\,0\\,]^{\\mathsf T}$ 和 $s_{2} = [\\,0,\\,1,\\,0\\,]^{\\mathsf T}$，$m_{2} = [\\,0,\\,0,\\,1\\,]^{\\mathsf T}$。设滑移速率为 $\\dot{\\gamma}_{1} = 0.01$ 和 $\\dot{\\gamma}_{2} = 0.02$，时间步长为 $\\Delta t = 0.1$，初始塑性变形梯度为 $F^{\\mathrm p}_{n} = I$。计算 $F^{\\mathrm p}_{n+1}$。将 $F^{\\mathrm p}_{n+1}$ 的行列式作为测试结果报告，格式为浮点数。\n\n- 测试 2（边界情况，零滑移）：使用与测试 1 相同的两个滑移系，但设置 $\\dot{\\gamma}_{1} = 0$ 和 $\\dot{\\gamma}_{2} = 0$，时间步长 $\\Delta t = 0.5$，初始塑性变形梯度 $F^{\\mathrm p}_{n} = I$。将 $F^{\\mathrm p}_{n+1} - I$ 的 Frobenius 范数作为测试结果报告，格式为浮点数。\n\n- 测试 3（点阵参考系旋转下的客观性）：重用测试 1 中的 $L^{\\mathrm p}$ 和 $\\Delta t = 0.1$。设 $Q$ 为一个绕 z 轴、角度为 $\\theta = \\pi/6$ (弧度) 的真正交旋转。构建 $L^{\\mathrm p}_{Q} = Q L^{\\mathrm p} Q^{\\mathsf T}$。计算该步长内塑性演化的两种更新方式：一种是在旋转后的参考系中应用更新，另一种是旋转未旋转参考系中的更新结果。将这两种更新结果之差的 Frobenius 范数是否小于或等于容差 $10^{-12}$ 的布尔真值作为测试结果报告。\n\n- 测试 4（可交换的滑移并矢）：构建两个可交换的滑移并矢，取 $s_{1} = [\\,1,\\,0,\\,0\\,]^{\\mathsf T}$，$m_{1} = [\\,0,\\,1,\\,0\\,]^{\\mathsf T}$ 和 $s_{2} = [\\,0,\\,0,\\,1\\,]^{\\mathsf T}$，$m_{2} = [\\,0,\\,1,\\,0\\,]^{\\mathsf T}$。定义 $A = a \\, s_{1} \\otimes m_{1}$ 和 $B = b \\, s_{2} \\otimes m_{2}$，其中 $a = 0.2$，$b = 0.3$。在 $\\Delta t = 1$ 的情况下，计算由 $A + B$ 生成的更新，并将其与由 $A$ 和 $B$ 生成的更新的有序乘积进行比较。将它们之差的 Frobenius 范数作为测试结果报告，格式为浮点数。\n\n- 测试 5（不可交换的滑移并矢）：构建两个不可交换的滑移并矢，取 $s_{1} = [\\,1,\\,0,\\,0\\,]^{\\mathsf T}$，$m_{1} = [\\,0,\\,1,\\,0\\,]^{\\mathsf T}$ 和 $s_{2} = [\\,0,\\,1,\\,0\\,]^{\\mathsf T}$，$m_{2} = [\\,1,\\,0,\\,0\\,]^{\\mathsf T}$。定义 $A = a \\, s_{1} \\otimes m_{1}$ 和 $B = b \\, s_{2} \\otimes m_{2}$，其中 $a = 0.2$，$b = 0.3$。在 $\\Delta t = 1$ 的情况下，计算由 $A + B$ 生成的更新，并将其与由 $A$ 和 $B$ 生成的更新的有序乘积进行比较。将它们之差的 Frobenius 范数作为测试结果报告，格式为浮点数。\n\n您的程序必须将测试 1–5 的结果汇总到一行输出中，结果包含在一个以逗号分隔的列表中，并用方括号括起来，例如 $[r_{1}, r_{2}, r_{3}, r_{4}, r_{5}]$，其中 $r_{1}$–$r_{5}$ 是按测试 1 到 5 顺序排列的所需值；$r_{1}$、$r_{2}$、$r_{4}$ 和 $r_{5}$ 是浮点数，而 $r_{3}$ 是布尔值。", "solution": "该问题要求在有限变形下单晶塑性的背景下，推导塑性变形梯度 $F^{\\mathrm p}$ 的有限步长更新算法，并实现该算法以评估几个测试用例。\n\n推导的起点是总变形梯度 $F$ 分解为弹性部分 $F^{\\mathrm e}$ 和塑性部分 $F^{\\mathrm p}$ 的运动学乘法关系 $F = F^{\\mathrm e} F^{\\mathrm p}$。塑性变形的演化由在中间（或点阵）构型中表示的流动法则控制。该法则将塑性变形梯度的变化率 $\\dot{F}^{\\mathrm p}$ 与塑性速度梯度 $L^{\\mathrm p}$ 联系起来，形成一个线性常微分方程（ODE）：\n$$\n\\dot{F}^{\\mathrm p} = L^{\\mathrm p} F^{\\mathrm p}\n$$\n塑性速度梯度 $L^{\\mathrm p}$ 定义为所有活动晶体滑移系贡献的总和：\n$$\nL^{\\mathrm p} = \\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} \\, s_{\\alpha} \\otimes m_{\\alpha}\n$$\n其中对于每个滑移系 $\\alpha$，$\\dot{\\gamma}_{\\alpha}$ 是标量剪切速率，$s_{\\alpha}$ 是代表滑移方向的单位向量，$m_{\\alpha}$ 是垂直于滑移面的单位向量。晶体滑移的一个基本属性是滑移方向位于滑移面内，这意味着正交性：$s_{\\alpha} \\cdot m_{\\alpha} = 0$。\n\n问题陈述我们必须推导 $F^{\\mathrm p}$ 在一个有限时间增量 $\\Delta t$ 内的更新，在此期间假定 $L^{\\mathrm p}$ 是恒定的。我们已知步长开始时的塑性变形梯度值 $F^{\\mathrm p}_n = F^{\\mathrm p}(t_n)$，并寻求步长结束时的值 $F^{\\mathrm p}_{n+1} = F^{\\mathrm p}(t_n + \\Delta t)$。\n\n控制方程 $\\dot{F}^{\\mathrm p} = L^{\\mathrm p} F^{\\mathrm p}$ 是一个具有常系数矩阵 $L^{\\mathrm p}$ 的一阶线性常微分方程组。对于形式为 $\\dot{X}(t) = A X(t)$、具有常数矩阵 $A$ 和初始条件 $X(t_0) = X_0$ 的初值问题，其通解为 $X(t) = \\exp(A(t-t_0)) X_0$，其中 $\\exp(\\cdot)$ 表示矩阵指数。\n\n将此标准结果应用于我们的特定问题，我们将 $X(t)$ 对应于 $F^{\\mathrm p}(t)$，$A$ 对应于 $L^{\\mathrm p}$，初始时间 $t_0$ 对应于 $t_n$。因此，在时间 $t = t_n + \\Delta t$ 的解是：\n$$\nF^{\\mathrm p}(t_n + \\Delta t) = \\exp(L^{\\mathrm p} ( (t_n + \\Delta t) - t_n) ) F^{\\mathrm p}(t_n)\n$$\n这就给出了所需的有限步长更新公式：\n$$\nF^{\\mathrm p}_{n+1} = \\exp(L^{\\mathrm p} \\Delta t) F^{\\mathrm p}_n\n$$\n这是指数映射更新，是解决此类问题的一种常用积分算法。\n\n接下来，我们必须根据两个关键物理原则来分析这个结果：塑性的等体积（体积保持）性质和在叠加点阵刚体旋转下的客观性。\n\n首先，我们来讨论等体积特性。由晶体滑移引起的塑性变形不会导致体积变化。在数学上，这表示为 $\\det(F^{\\mathrm p}) = 1$。我们的更新方案必须保持这一属性。从一个等体积状态 $\\det(F^{\\mathrm p}_n) = 1$（例如，一个未变形状态，其中 $F^{\\mathrm p}_n = I$，即单位张量）开始，我们必须证明 $\\det(F^{\\mathrm p}_{n+1}) = 1$。\n对更新方程取行列式：\n$$\n\\det(F^{\\mathrm p}_{n+1}) = \\det(\\exp(L^{\\mathrm p} \\Delta t) F^{\\mathrm p}_n) = \\det(\\exp(L^{\\mathrm p} \\Delta t)) \\det(F^{\\mathrm p}_n)\n$$\n矩阵指数的一个基本性质是，对于任何方阵 $A$，有 $\\det(\\exp(A)) = \\exp(\\mathrm{tr}(A))$，其中 $\\mathrm{tr}(\\cdot)$ 是迹算子。应用此性质，我们得到：\n$$\n\\det(F^{\\mathrm p}_{n+1}) = \\exp(\\mathrm{tr}(L^{\\mathrm p} \\Delta t)) \\det(F^{\\mathrm p}_n) = \\exp(\\Delta t \\cdot \\mathrm{tr}(L^{\\mathrm p})) \\det(F^{\\mathrm p}_n)\n$$\n塑性速度梯度的迹为：\n$$\n\\mathrm{tr}(L^{\\mathrm p}) = \\mathrm{tr}\\left(\\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} \\, s_{\\alpha} \\otimes m_{\\alpha}\\right) = \\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} \\, \\mathrm{tr}(s_{\\alpha} \\otimes m_{\\alpha})\n$$\n并矢积 $a \\otimes b$（由矩阵 $ab^{\\mathsf T}$ 表示）的迹是 $\\mathrm{tr}(ab^{\\mathsf T}) = b^{\\mathsf T} a = a \\cdot b$。因此：\n$$\n\\mathrm{tr}(L^{\\mathrm p}) = \\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} (s_{\\alpha} \\cdot m_{\\alpha})\n$$\n如问题所述，滑移方向与滑移面法线正交，因此对所有 $\\alpha$ 都有 $s_{\\alpha} \\cdot m_{\\alpha} = 0$。这意味着 $\\mathrm{tr}(L^{\\mathrm p}) = 0$。\n将此结果代回行列式表达式中：\n$$\n\\det(F^{\\mathrm p}_{n+1}) = \\exp(0) \\det(F^{\\mathrm p}_n) = 1 \\cdot \\det(F^{\\mathrm p}_n) = \\det(F^{\\mathrm p}_n)\n$$\n这证实了该更新法则能正确地保持体积，即如果 $\\det(F^{\\mathrm p}_n) = 1$，则 $\\det(F^{\\mathrm p}_{n+1}) = 1$。$L^{\\mathrm p}$ 的无迹性是保证此性质的数学结构。\n\n第二，我们分析客观性。物理定律应独立于观察者的参考系。我们考虑通过一个不随时间变化的真正交旋转 $Q$（即 $Q^{\\mathsf T}Q=I$ 且 $\\det Q = 1$）来改变点阵构型的参考系。原始参考系中的张量 $A$ 在旋转后的参考系中变换为 $A' = QAQ^{\\mathsf T}$。向量变换为 $v' = Qv$。塑性变形梯度 $F^{\\mathrm p}$ 将向量从参考构型映射到中间（点阵）构型；因此，其变换为 $F'^{\\mathrm p} = QF^{\\mathrm p}$。\n滑移向量变换为 $s'_{\\alpha} = Qs_{\\alpha}$ 和 $m'_{\\alpha} = Qm_{\\alpha}$。旋转后参考系中的塑性速度梯度为：\n$$\nL'^{\\mathrm p} = \\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} s'_{\\alpha} \\otimes m'_{\\alpha} = \\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} (Qs_{\\alpha}) \\otimes (Qm_{\\alpha}) = \\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} Q(s_{\\alpha} \\otimes m_{\\alpha})Q^{\\mathsf T} = Q \\left(\\sum_{\\alpha} \\dot{\\gamma}_{\\alpha} s_{\\alpha} \\otimes m_{\\alpha}\\right) Q^{\\mathsf T} = QL^{\\mathrm p}Q^{\\mathsf T}\n$$\n这证实了 $L^{\\mathrm p}$ 的变换法则。旋转后参考系中的更新为 $F'^{\\mathrm p}_{n+1} = \\exp(L'^{\\mathrm p} \\Delta t) F'^{\\mathrm p}_n$。我们必须验证这与旋转原始参考系的结果是一致的，即 $F'^{\\mathrm p}_{n+1} = QF^{\\mathrm p}_{n+1}$。\n让我们展开 $F'^{\\mathrm p}_{n+1}$ 的表达式：\n$$\nF'^{\\mathrm p}_{n+1} = \\exp(Q L^{\\mathrm p} Q^{\\mathsf T} \\Delta t) (Q F^{\\mathrm p}_n)\n$$\n矩阵指数的另一个核心性质是，对于任何可逆矩阵 $P$，有 $\\exp(PAP^{-1}) = P\\exp(A)P^{-1}$。由于 $Q$ 是正交的，所以 $Q^{-1}=Q^{\\mathsf T}$。因此，我们可以写出：\n$$\n\\exp(Q (L^{\\mathrm p} \\Delta t) Q^{\\mathsf T}) = Q \\exp(L^{\\mathrm p} \\Delta t) Q^{\\mathsf T}\n$$\n将此代入 $F'^{\\mathrm p}_{n+1}$ 的更新方程中：\n$$\nF'^{\\mathrm p}_{n+1} = \\left(Q \\exp(L^{\\mathrm p} \\Delta t) Q^{\\mathsf T}\\right) (Q F^{\\mathrm p}_n) = Q \\exp(L^{\\mathrm p} \\Delta t) (Q^{\\mathsf T}Q) F^{\\mathrm p}_n = Q \\exp(L^{\\mathrm p} \\Delta t) I F^{\\mathrm p}_n = Q (\\exp(L^{\\mathrm p} \\Delta t) F^{\\mathrm p}_n)\n$$\n识别出括号中的项是来自原始参考系更新的 $F^{\\mathrm p}_{n+1}$，我们有：\n$$\nF'^{\\mathrm p}_{n+1} = Q F^{\\mathrm p}_{n+1}\n$$\n这表明指数映射更新是客观的。在旋转后的参考系中执行更新过程，与将在原始参考系中更新得到的张量进行旋转，产生相同的结果。性质 $\\exp(Q A Q^{\\mathsf T}) = Q \\exp(A) Q^{\\mathsf T}$ 是保证客观性的关键数学结构。\n\n该实现将使用数值稳定的库函数 `scipy.linalg.expm` 来计算矩阵指数，并基于此推导出的更新过程来评估指定的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the five test cases specified in the problem statement regarding\n    the update of the plastic deformation gradient in single crystal plasticity.\n    \"\"\"\n    \n    # Store results for each test case\n    results = []\n\n    # --- Test 1 (happy path, two active slip systems) ---\n    s1 = np.array([1., 0., 0.])\n    m1 = np.array([0., 1., 0.])\n    s2 = np.array([0., 1., 0.])\n    m2 = np.array([0., 0., 1.])\n    gamma_dot1 = 0.01\n    gamma_dot2 = 0.02\n    delta_t = 0.1\n    Fp_n = np.eye(3)\n\n    Lp = gamma_dot1 * np.outer(s1, m1) + gamma_dot2 * np.outer(s2, m2)\n    Fp_n_plus_1 = expm(Lp * delta_t) @ Fp_n\n    result1 = np.linalg.det(Fp_n_plus_1)\n    results.append(result1)\n\n    # --- Test 2 (boundary case, zero slip) ---\n    gamma_dot1_t2 = 0.0\n    gamma_dot2_t2 = 0.0\n    delta_t_t2 = 0.5\n    Fp_n_t2 = np.eye(3)\n\n    Lp_t2 = gamma_dot1_t2 * np.outer(s1, m1) + gamma_dot2_t2 * np.outer(s2, m2)\n    Fp_n_plus_1_t2 = expm(Lp_t2 * delta_t_t2) @ Fp_n_t2\n    result2 = np.linalg.norm(Fp_n_plus_1_t2 - np.eye(3), 'fro')\n    results.append(result2)\n\n    # --- Test 3 (objectivity under lattice frame rotation) ---\n    Lp_t3 = np.copy(Lp) # Reuse Lp from Test 1\n    delta_t_t3 = 0.1\n    theta = np.pi / 6.0\n    c, s = np.cos(theta), np.sin(theta)\n    Q = np.array([[c, -s, 0.],\n                  [s,  c, 0.],\n                  [0., 0., 1.]])\n    Fp_n_t3 = np.eye(3)\n\n    # Path 1: Update in original frame, then rotate the result\n    Fp_n_plus_1_orig = expm(Lp_t3 * delta_t_t3) @ Fp_n_t3\n    update_rotated = Q @ Fp_n_plus_1_orig\n\n    # Path 2: Rotate inputs, then update in rotated frame\n    Lp_Q = Q @ Lp_t3 @ Q.T\n    Fp_n_Q = Q @ Fp_n_t3 # Transformed initial state\n    rotated_update = expm(Lp_Q * delta_t_t3) @ Fp_n_Q\n    \n    diff_norm = np.linalg.norm(update_rotated - rotated_update, 'fro')\n    tolerance = 1e-12\n    result3 = diff_norm = tolerance\n    results.append(result3)\n\n    # --- Test 4 (commuting slip dyads) ---\n    s1_t4 = np.array([1., 0., 0.])\n    m1_t4 = np.array([0., 1., 0.])\n    s2_t4 = np.array([0., 0., 1.])\n    m2_t4 = np.array([0., 1., 0.])\n    a = 0.2\n    b = 0.3\n    delta_t_t4 = 1.0\n\n    A = a * np.outer(s1_t4, m1_t4)\n    B = b * np.outer(s2_t4, m2_t4)\n\n    # Update generated by sum\n    U_sum = expm((A + B) * delta_t_t4)\n    # Ordered product of updates\n    U_prod = expm(A * delta_t_t4) @ expm(B * delta_t_t4)\n    \n    result4 = np.linalg.norm(U_sum - U_prod, 'fro')\n    results.append(result4)\n\n    # --- Test 5 (noncommuting slip dyads) ---\n    s1_t5 = np.array([1., 0., 0.])\n    m1_t5 = np.array([0., 1., 0.])\n    s2_t5 = np.array([0., 1., 0.])\n    m2_t5 = np.array([1., 0., 0.])\n    a_t5 = 0.2\n    b_t5 = 0.3\n    delta_t_t5 = 1.0\n\n    A_t5 = a_t5 * np.outer(s1_t5, m1_t5)\n    B_t5 = b_t5 * np.outer(s2_t5, m2_t5)\n    \n    # Update generated by sum\n    U_sum_t5 = expm((A_t5 + B_t5) * delta_t_t5)\n    # Ordered product of updates. The problem statement does not specify order.\n    # For non-commuting matrices, exp(A)exp(B) != exp(B)exp(A) in general.\n    # We choose one consistent order.\n    U_prod_t5 = expm(A_t5 * delta_t_t5) @ expm(B_t5 * delta_t_t5)\n\n    result5 = np.linalg.norm(U_sum_t5 - U_prod_t5, 'fro')\n    results.append(result5)\n    \n    # Final print statement in the exact required format.\n    # The str() for a boolean correctly produces 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3552451"}]}