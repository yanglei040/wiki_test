{"hands_on_practices": [{"introduction": "第一个练习提供了对应变协调概念的基础性检验。你将首先推导著名的圣维南（Saint-Venant）平面应变协调条件，然后将其应用于一个给定的应变场，以确定是否存在一个连续的、单值的位移场。这项练习对于掌握协调方程的直接应用至关重要([@problem_id:3603534])。", "problem": "考虑一个在$x$-$y$平面内单连通域上的二维无穷小运动学（小应变）问题。设面内位移场为$(u(x,y), v(x,y))$，面外位移受到约束，满足平面应变条件。线性化应变分量由以下基本运动学关系定义\n\n$$\n\\epsilon_{xx} = u_{,x}, \\quad \\epsilon_{yy} = v_{,y}, \\quad \\epsilon_{xy} = \\frac{1}{2}\\left(u_{,y} + v_{,x}\\right).\n$$\n\n在单连通区域上存在这样一个二次连续可微位移场的充分必要条件是，应变场满足一个标量偏微分关系。该关系是通过从上述运动学等式中消去位移得到的，仅利用了足够光滑场的混合偏导数的交换性。\n\n给定显式的平面应变场\n\n$$\n\\epsilon_{xx}(x,y) = x, \\quad \\epsilon_{yy}(x,y) = -x, \\quad \\epsilon_{xy}(x,y) = y,\n$$\n\n请完成以下任务：\n- 从上面给出的应变-位移定义和混合偏导数的交换性出发，消去$u$和$v$以推导标量平面应变协调条件。\n- 对给定的$\\epsilon_{ij}(x,y)$，计算所得标量微分表达式的值，并说明其值。\n- 根据您的计算结果，说明给定的应变场在“存在生成它（在单连通域上）的位移$(u,v)$”这一意义上是否是运动学协调的。\n\n将该场的标量协调表达式的值作为最终答案。不需要单位。最终答案中不要提供任何中间表达式。如果得到的是精确值，则无需四舍五入。", "solution": "该问题要求从基本应变-位移关系推导平面应变协调条件，然后对给定的应变场评估此条件。\n\n分析始于在二维笛卡尔坐标系$(x,y)$中给出的无穷小应变-位移关系：\n$$\n\\epsilon_{xx} = \\frac{\\partial u}{\\partial x} \\quad (1)\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial v}{\\partial y} \\quad (2)\n$$\n$$\n\\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right) \\quad \\text{或} \\quad 2\\epsilon_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} \\quad (3)\n$$\n其中$u(x,y)$和$v(x,y)$是位移场的分量。\n\n目标是通过消去位移分量$u$和$v$，找到一个仅包含应变分量$\\epsilon_{xx}$、$\\epsilon_{yy}$和$\\epsilon_{xy}$的关系。这可以通过对上述表达式进行微分，并利用二次连续可微（$C^2$）位移场的偏微分次序无关（即混合偏导数的交换性）这一性质来实现。对于接下来的推导，我们将假设位移场至少是$C^3$的，这确保了必要的应变导数是连续的，并且它们的混合偏导数可以交换。\n\n我们可以用应变的一阶导数来表示位移的二阶导数。为了消去$u$和$v$，我们必须建立一个恒等式。一种常见的方法是对各应变分量求二阶导数，从而通过位移的三阶导数将它们联系起来。\n\n将方程(1)对$y$求两次导数：\n$$\n\\frac{\\partial^2 \\epsilon_{xx}}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2}\\left(\\frac{\\partial u}{\\partial x}\\right) = \\frac{\\partial^3 u}{\\partial x \\partial y^2}\n$$\n将方程(2)对$x$求两次导数：\n$$\n\\frac{\\partial^2 \\epsilon_{yy}}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}\\left(\\frac{\\partial v}{\\partial y}\\right) = \\frac{\\partial^3 v}{\\partial y \\partial x^2}\n$$\n将方程(3)对$x$求一次导数，再对$y$求一次导数：\n$$\n2\\frac{\\partial^2 \\epsilon_{xy}}{\\partial x \\partial y} = \\frac{\\partial^2}{\\partial x \\partial y}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right) = \\frac{\\partial^3 u}{\\partial x \\partial y^2} + \\frac{\\partial^3 v}{\\partial y \\partial x^2}\n$$\n在上述表达式中，我们利用了足够光滑的$u$和$v$场的混合偏导数的交换性（例如，$\\frac{\\partial^3 u}{\\partial y^2 \\partial x} = \\frac{\\partial^3 u}{\\partial x \\partial y^2}$）。\n\n现在，我们可以将$u$和$v$的三阶导数表达式代入最后一个方程：\n$$\n2\\frac{\\partial^2 \\epsilon_{xy}}{\\partial x \\partial y} = \\frac{\\partial^2 \\epsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\epsilon_{yy}}{\\partial x^2}\n$$\n这就是所求的标量平面应变协调条件，也称为平面问题的Saint-Venant协调方程。为了在单连通域中存在单值位移场，应变场必须满足此方程。通过将所有项移到一边，可以得到标量协调表达式的标准形式：\n$$\n\\frac{\\partial^2 \\epsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\epsilon_{yy}}{\\partial x^2} - 2\\frac{\\partial^2 \\epsilon_{xy}}{\\partial x \\partial y} = 0\n$$\n现在问题要求针对给定的应变场，计算该方程左侧表达式的值：\n$$\n\\epsilon_{xx}(x,y) = x\n$$\n$$\n\\epsilon_{yy}(x,y) = -x\n$$\n$$\n\\epsilon_{xy}(x,y) = y\n$$\n我们计算必要的二阶偏导数：\n对于$\\epsilon_{xx}$：\n$$\n\\frac{\\partial \\epsilon_{xx}}{\\partial y} = \\frac{\\partial}{\\partial y}(x) = 0\n$$\n$$\n\\frac{\\partial^2 \\epsilon_{xx}}{\\partial y^2} = \\frac{\\partial}{\\partial y}(0) = 0\n$$\n对于$\\epsilon_{yy}$：\n$$\n\\frac{\\partial \\epsilon_{yy}}{\\partial x} = \\frac{\\partial}{\\partial x}(-x) = -1\n$$\n$$\n\\frac{\\partial^2 \\epsilon_{yy}}{\\partial x^2} = \\frac{\\partial}{\\partial x}(-1) = 0\n$$\n对于$\\epsilon_{xy}$：\n$$\n\\frac{\\partial \\epsilon_{xy}}{\\partial y} = \\frac{\\partial}{\\partial y}(y) = 1\n$$\n$$\n\\frac{\\partial^2 \\epsilon_{xy}}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x}(1) = 0\n$$\n将这些结果代入标量协调表达式：\n$$\n\\frac{\\partial^2 \\epsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\epsilon_{yy}}{\\partial x^2} - 2\\frac{\\partial^2 \\epsilon_{xy}}{\\partial x \\partial y} = 0 + 0 - 2(0) = 0\n$$\n对于给定的应变场，标量协调表达式的值为$0$。\n\n由于协调方程恒成立（即，对于所有点$(x,y)$，表达式的值均为$0$），因此给定的应变场是运动学协调的。这意味着存在一个单值的、二次连续可微的位移场$(u(x,y), v(x,y))$，它在单连通域上生成该应变场。\n最终答案即为此表达式的值。", "answer": "$$\n\\boxed{0}\n$$", "id": "3603534"}, {"introduction": "在固体力学中，运动学协调性和静力学平衡是两个独立的基本原理。本练习通过一个精心构建的假设情景来探讨它们之间的关系，证明一个满足平衡条件的应力场不一定对应于一个协调的应变场([@problem_id:3603573])。通过解决这个问题，你将更深刻地理解这些核心概念的独立性，这对于正确构建和诊断计算模型至关重要。", "problem": "考虑二维空间中的平面小应变线性运动学，其笛卡尔坐标为 $(x,y)$，并令域为 $\\Omega=\\mathbb{R}^{2}$。根据一个经过充分检验的事实，当满足以下条件时，无体力情况下的平衡得以保证，由此可从一个 Airy 应力函数 $\\Phi(x,y)$ 构建出应力场 $\\sigma(x,y)$：\n$$\n\\sigma_{xx}=\\frac{\\partial^{2}\\Phi}{\\partial y^{2}},\\quad \\sigma_{yy}=\\frac{\\partial^{2}\\Phi}{\\partial x^{2}},\\quad \\sigma_{xy}=-\\frac{\\partial^{2}\\Phi}{\\partial x\\,\\partial y},\n$$\n这保证了 $\\nabla\\cdot\\sigma=\\mathbf{0}$。考虑特定的 Airy 应力函数\n$$\n\\Phi(x,y)=\\frac{a}{12}\\,y^{4},\n$$\n其中 $a$ 是一个非零常数，其单位为压强/长度²。一个被测试的求解器采用了一种刻意设置的非物理线性本构映射，该映射通过一个标量柔度将应力转换为应变，\n$$\n\\varepsilon(x,y)=\\alpha\\,\\sigma(x,y),\n$$\n其中 $\\alpha>0$ 是一个常数，其单位为压强的倒数。该映射保持了张量的对称性，但除了在退化情况下，它并非从任何应变能密度函数导出。此处使用它是为了对应力测试那些将平衡与协调性混为一谈的算法。\n\n仅从位移场 $\\mathbf{u}(x,y)$ 的小应变运动学定义 $\\varepsilon=\\frac{1}{2}\\left(\\nabla \\mathbf{u}+(\\nabla \\mathbf{u})^{\\top}\\right)$ 出发，并利用足够光滑场的混合偏导数的可交换性，推导平面小应变的必要标量协调条件，并为由上述 $\\Phi$ 和 $\\alpha$ 产生的应变场计算相应的非协调性度量 $I(x,y)$。你的最终答案必须是 $I(x,y)$ 的一个单一闭式解析表达式，且仅用 $a$ 和 $\\alpha$ 表示。不需要数值近似，最终答案框中不应包含任何单位。", "solution": "该问题要求推导二维小应变协调条件，并随后对由给定的 Airy 应力函数和一个非标准本构律生成的应变场进行此条件的评估。整个过程的关键在于一个数学要求，即对于一个给定的应变场 $\\varepsilon(x,y)$，必须存在一个连续、单值的位移场 $\\mathbf{u}(x,y)$。\n\n首先，我们推导一般协调条件。在二维笛卡尔坐标 $(x,y)$ 中，小应变张量的分量由位移矢量分量 $u_x(x,y)$ 和 $u_y(x,y)$ 定义如下：\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} \\quad (1)\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} \\quad (2)\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) \\quad (3)\n$$\n为使一个应变场能够积分得到一个单值位移场，其应变分量必须满足某个微分约束。这个约束可以通过从方程 $(1)$、$(2)$ 和 $(3)$ 中消去位移分量 $u_x$ 和 $u_y$ 来找到。我们可以通过微分来实现这一点。假设位移场足够光滑，以至于可以交换偏导数的顺序（如问题所述），我们按以下步骤进行。\n\n将方程 $(1)$ 对 $y$ 求两次导数：\n$$\n\\frac{\\partial^2 \\varepsilon_{xx}}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2}\\left(\\frac{\\partial u_x}{\\partial x}\\right) = \\frac{\\partial^3 u_x}{\\partial y^2 \\partial x}\n$$\n将方程 $(2)$ 对 $x$ 求两次导数：\n$$\n\\frac{\\partial^2 \\varepsilon_{yy}}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}\\left(\\frac{\\partial u_y}{\\partial y}\\right) = \\frac{\\partial^3 u_y}{\\partial x^2 \\partial y}\n$$\n将这两个结果相加得到：\n$$\n\\frac{\\partial^2 \\varepsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\varepsilon_{yy}}{\\partial x^2} = \\frac{\\partial^3 u_x}{\\partial y^2 \\partial x} + \\frac{\\partial^3 u_y}{\\partial x^2 \\partial y} \\quad (4)\n$$\n现在，将方程 $(3)$ 乘以 $2$ 后，先对 $x$ 再对 $y$ 求导：\n$$\n2\\frac{\\partial^2 \\varepsilon_{xy}}{\\partial x \\partial y} = \\frac{\\partial^2}{\\partial x \\partial y}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{\\partial^3 u_x}{\\partial x \\partial y^2} + \\frac{\\partial^3 u_y}{\\partial x^2 \\partial y}\n$$\n由于假设了混合偏导数的可交换性，我们有 $\\frac{\\partial^3 u_x}{\\partial y^2 \\partial x} = \\frac{\\partial^3 u_x}{\\partial x \\partial y^2}$。因此，该表达式的右侧与方程 $(4)$ 的右侧相同。通过令等式两边的左侧相等，我们得到了平面小应变的协调方程：\n$$\n\\frac{\\partial^2 \\varepsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\varepsilon_{yy}}{\\partial x^2} = 2 \\frac{\\partial^2 \\varepsilon_{xy}}{\\partial x \\partial y}\n$$\n我们记为 $I(x,y)$ 的非协调性度量，被定义为该方程的残差。$I(x,y)$ 的非零值意味着该应变场不能从一个连续的单值位移场导出。\n$$\nI(x,y) = \\frac{\\partial^2 \\varepsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\varepsilon_{yy}}{\\partial x^2} - 2 \\frac{\\partial^2 \\varepsilon_{xy}}{\\partial x \\partial y}\n$$\n接下来，我们针对所提供的特定情况计算这个非协调性度量。应力场由 Airy 应力函数 $\\Phi(x,y) = \\frac{a}{12}y^4$ 导出。\n应力分量为：\n$$\n\\sigma_{xx} = \\frac{\\partial^2 \\Phi}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2}\\left(\\frac{a}{12}y^4\\right) = \\frac{\\partial}{\\partial y}\\left(\\frac{4a}{12}y^3\\right) = \\frac{\\partial}{\\partial y}\\left(\\frac{a}{3}y^3\\right) = ay^2\n$$\n$$\n\\sigma_{yy} = \\frac{\\partial^2 \\Phi}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}\\left(\\frac{a}{12}y^4\\right) = 0\n$$\n$$\n\\sigma_{xy} = -\\frac{\\partial^2 \\Phi}{\\partial x \\partial y} = -\\frac{\\partial}{\\partial x}\\left(\\frac{\\partial}{\\partial y}\\left(\\frac{a}{12}y^4\\right)\\right) = -\\frac{\\partial}{\\partial x}\\left(\\frac{a}{3}y^3\\right) = 0\n$$\n问题指定了一个通过标量柔度 $\\alpha$ 将应变与应力关联起来的本构律：$\\varepsilon(x,y) = \\alpha \\sigma(x,y)$。将此应用于应力分量，得到应变分量：\n$$\n\\varepsilon_{xx}(x,y) = \\alpha \\sigma_{xx} = \\alpha a y^2\n$$\n$$\n\\varepsilon_{yy}(x,y) = \\alpha \\sigma_{yy} = 0\n$$\n$$\n\\varepsilon_{xy}(x,y) = \\alpha \\sigma_{xy} = 0\n$$\n最后，我们将这些应变分量代入非协调性度量 $I(x,y)$ 的表达式中。我们计算所需的二阶偏导数：\n对于 $\\varepsilon_{xx}$ 项：\n$$\n\\frac{\\partial \\varepsilon_{xx}}{\\partial y} = \\frac{\\partial}{\\partial y}(\\alpha a y^2) = 2 \\alpha a y\n$$\n$$\n\\frac{\\partial^2 \\varepsilon_{xx}}{\\partial y^2} = \\frac{\\partial}{\\partial y}(2 \\alpha a y) = 2 \\alpha a\n$$\n对于 $\\varepsilon_{yy}$ 项：\n$$\n\\frac{\\partial^2 \\varepsilon_{yy}}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}(0) = 0\n$$\n对于 $\\varepsilon_{xy}$ 项：\n$$\n2 \\frac{\\partial^2 \\varepsilon_{xy}}{\\partial x \\partial y} = 2 \\frac{\\partial^2}{\\partial x \\partial y}(0) = 0\n$$\n将这些结果代入非协调性度量的定义中，得到：\n$$\nI(x,y) = (2 \\alpha a) + (0) - (0) = 2 \\alpha a\n$$\n非协调性度量 $I(x,y)$ 是一个常数，与空间坐标 $x$ 和 $y$ 无关。其非零值证实了由给定的应力函数和非物理本构律生成的应变场确实是不协调的。", "answer": "$$\\boxed{2\\alpha a}$$", "id": "3603573"}, {"introduction": "从纯理论走向计算实践，这最后一个练习解决了一个关键问题：如何处理一个不协调的应变场？你将设计并实现一个数值算法，将任意给定的应变场投影到协调应变空间上([@problem_id:3603578])。这项动手编程任务将使你掌握一种强大的技术，该技术在数据处理和高等有限元方法中用于强制实现运动学一致性。", "problem": "考虑在具有周期性边界条件的二维单位环面 $\\mathbb{T}^2 = [0,1)^2$ 上的一个周期性矢量位移场 $\\mathbf{u} : \\mathbb{T}^2 \\to \\mathbb{R}^2$。无穷小应变场由对称梯度定义为 $\\boldsymbol{\\epsilon} = \\operatorname{sym}\\nabla \\mathbf{u}$，其中对于任何具有分量 $v_i$ 的矢量场 $\\mathbf{v}$，其对称梯度为 $(\\operatorname{sym}\\nabla \\mathbf{v})_{ij} = \\tfrac{1}{2}(\\partial_i v_j + \\partial_j v_i)$。如果存在一个位移场 $\\mathbf{u}$ 使得 $\\boldsymbol{\\epsilon} = \\operatorname{sym}\\nabla \\mathbf{u}$，则该应变场称为协调应变场。所有协调应变的集合是 $\\mathbb{T}^2$ 上平方可积对称张量场的一个线性子空间。您的任务是通过求解以下约束最小化问题来构造一个正交投影算子 $\\Pi_{\\text{comp}}$，该算子将任意给定的应变场映射到 $L^2$ 意义上最近的协调应变：给定一个目标应变场 $\\boldsymbol{\\epsilon}$，找到一个位移场 $\\mathbf{u}$，使其最小化泛函\n$$\n\\mathcal{J}(\\mathbf{u}) = \\int_{\\mathbb{T}^2} \\left\\| \\operatorname{sym}\\nabla \\mathbf{u}(\\mathbf{x}) - \\boldsymbol{\\epsilon}(\\mathbf{x}) \\right\\|_F^2 \\, d\\mathbf{x},\n$$\n并将投影定义为 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}] = \\operatorname{sym}\\nabla \\mathbf{u}^\\star$，其中 $\\mathbf{u}^\\star$ 是最小化子。该最小化子在具有零空间平均值的周期性、平方可积位移场中寻找，以消除刚体运动模式，即 $\\int_{\\mathbb{T}^2} \\mathbf{u}(\\mathbf{x}) \\, d\\mathbf{x} = \\mathbf{0}$。\n\n您的任务是：\n- 基于连续介质运动学和变分法的第一性原理，推导在所述周期性边界条件和零均值约束下最小化 $\\mathcal{J}(\\mathbf{u})$所对应的欧拉-拉格朗日方程。然后，在 $\\mathbb{T}^2$ 上的傅里叶域中重新表述所得方程，从而为每个非零波矢获得一个关于 $\\mathbf{u}$ 的傅里叶系数的线性代数系统。请说明如何处理零波矢。\n- 设计一种谱方法算法来计算 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}]$，步骤如下：\n  $1)$ 将输入应变场变换到傅里叶域，\n  $2)$ 求解每个波矢的线性系统以获得位移场的傅里葉系数，\n  $3)$ 在傅里叶域中应用对称梯度来重构协调应变，以及\n  $4)$ 进行逆变换以返回物理空间。在均匀网格上使用快速傅里叶变换 (FFT)。\n- 将该算法实现为一个程序，该程序在 $[0,1)^2$上使用大小为 $N \\times N$（其中 $N = 32$）的均匀网格、周期性边界条件以及傅里叶波数 $k_i = 2\\pi \\, \\mathrm{fftfreq}(N)$（其中 $i \\in \\{x,y\\}$）。此处，$\\mathrm{fftfreq}$ 表示网格间距为 $h = 1/N$ 的标准离散傅里叶频率映射。\n- 为了验证，请使用 $\\mathbb{T}^2$ 上平面应变中的离散 Saint-Venant 协调条件。对于足够光滑的场，该条件指出协调应变满足\n$$\n\\frac{\\partial^2 \\epsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\epsilon_{yy}}{\\partial x^2} - 2 \\frac{\\partial^2 \\epsilon_{xy}}{\\partial x \\partial y} = 0,\n$$\n并用谱方法在网格上计算此残差。\n\n您的程序必须评估以下四个测试用例并计算指定的定量结果：\n\n- 测试用例 $1$ (已协调的输入)：设 $\\mathbf{u}_1(\\mathbf{x})$ 的分量为 $u_{1x}(x,y) = \\sin(2\\pi x) + 0.3 \\cos(2\\pi y)$ 和 $u_{1y}(x,y) = -0.4 \\cos(2\\pi x) + \\sin(4\\pi y)$。定义 $\\boldsymbol{\\epsilon}^{(1)} = \\operatorname{sym}\\nabla \\mathbf{u}_1$。计算 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}^{(1)}]$ 并报告其 $L^2$ 相对误差\n$$\nr_1 = \\frac{\\left\\| \\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}^{(1)}] - \\boldsymbol{\\epsilon}^{(1)} \\right\\|_{L^2}}{\\left\\| \\boldsymbol{\\epsilon}^{(1)} \\right\\|_{L^2}},\n$$\n离散化为每个场在网格上逐点 Frobenius 范数平方的空间平均值的平方根。\n\n- 测试用例 $2$ (通用的非协调输入)：通过为每个分量在网格上抽取独立的标准正态样本，对称化以强制 $\\epsilon_{xy} = \\epsilon_{yx}$，应用乘子为 $\\exp(-\\alpha \\lVert \\mathbf{k} \\rVert^2)$（其中 $\\alpha = 0.1$）的谱低通滤波器，并强制零均值，来构造一个光滑随机对称应变场 $\\boldsymbol{\\epsilon}^{(2)}$。进行投影得到 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}^{(2)}]$，并报告 Saint-Venant 残差的均方根 (RMS) 值\n$$\nr_2 = \\left( \\left\\langle \\left( \\frac{\\partial^2 \\epsilon_{xx}}{\\partial y^2} + \\frac{\\partial^2 \\epsilon_{yy}}{\\partial x^2} - 2 \\frac{\\partial^2 \\epsilon_{xy}}{\\partial x \\partial y} \\right)^2 \\right\\rangle \\right)^{1/2}\n$$\n该值在 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}^{(2)}]$ 上计算，其中 $\\langle \\cdot \\rangle$ 表示离散空间平均值。\n\n- 测试用例 $3$ (均匀非协调输入)：设 $\\boldsymbol{\\epsilon}^{(3)}$ 为空间常数，其分量为 $\\epsilon_{xx} = 0.1$, $\\epsilon_{yy} = -0.02$, $\\epsilon_{xy} = 0.05$。在所述的周期性、零均值位移约束下计算 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}^{(3)}]$ 并报告其 $L^2$ 范数\n$$\nr_3 = \\left\\| \\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}^{(3)}] \\right\\|_{L^2}.\n$$\n\n- 测试用例 $4$ (协调部分与均匀部分之和)：设 $\\mathbf{u}_2(\\mathbf{x})$ 的分量为 $u_{2x}(x,y) = 0.5 \\cos(2\\pi x + 0.25) + 0.2 \\sin(2\\pi y)$ 和 $u_{2y}(x,y) = 0.3 \\sin(2\\pi x) - 0.6 \\cos(2\\pi y + 0.3)$。定义 $\\boldsymbol{\\epsilon}^{(4a)} = \\operatorname{sym}\\nabla \\mathbf{u}_2$，并使 $\\boldsymbol{\\epsilon}^{(4b)}$ 等于测试用例 3 中的相同空间常数应变。设 $\\boldsymbol{\\epsilon}^{(4)} = \\boldsymbol{\\epsilon}^{(4a)} + \\boldsymbol{\\epsilon}^{(4b)}$。计算投影并报告 $L^2$ 相对误差\n$$\nr_4 = \\frac{\\left\\| \\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}^{(4)}] - \\boldsymbol{\\epsilon}^{(4a)} \\right\\|_{L^2}}{\\left\\| \\boldsymbol{\\epsilon}^{(4a)} \\right\\|_{L^2}}.\n$$\n\n实现要求：\n- 对于所有测试，在 $[0,1)^2$ 上的每个方向使用 $N = 32$ 个网格点，并使用角波数 $k_x = 2\\pi \\,\\mathrm{fftfreq}(N)$ 和 $k_y = 2\\pi \\,\\mathrm{fftfreq}(N)$ 以谱方法计算空间导数。\n- 通过将位移的零波数（$\\mathbf{k} = \\mathbf{0}$）傅里叶系数设置为零来强制执行周期性、零均值的位移约束，这意味着协调应变的空间平均值为零。因此，任何均匀应变的投影都是零场。\n- 对于测试用例 2 中的随机场，将随机数生成器种子固定为 $42$ 以确保可复现性。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，即 $[r_1,r_2,r_3,r_4]$，每个值都四舍五入到六位小数，并表示为小数点后恰好有六位数字的十进制数。\n- 输出行中不允许有任何额外的文本或空格。", "solution": "该问题要求构造一个正交投影算子 $\\Pi_{\\text{comp}}$，它将一个给定的二维应变场 $\\boldsymbol{\\epsilon}$ 映射到最近的协调应变场。如果一个应变场可以表示为矢量位移场 $\\operatorname{sym}\\nabla \\mathbf{u}$ 的对称梯度，则该应变场是协调的。“最近”是在 $L^2$ 意义下定义的，这引出一个约束最小化问题。该问题设定在二维单位环面 $\\mathbb{T}^2$ 上，意味着存在周期性边界条件，并包含一个位移场空间平均值为零的约束以消除刚体平移。\n\n### 第一步：问题验证\n- **已知条件**：\n    - 定义域：具有周期性边界条件的二维单位环面 $\\mathbb{T}^2 = [0,1)^2$。\n    - 位移场：$\\mathbf{u} : \\mathbb{T}^2 \\to \\mathbb{R}^2$。\n    - 无穷小应变场：$\\boldsymbol{\\epsilon} = \\operatorname{sym}\\nabla \\mathbf{u}$，其中 $(\\operatorname{sym}\\nabla \\mathbf{u})_{ij} = \\tfrac{1}{2}(\\partial_i u_j + \\partial_j u_i)$。\n    - 待最小化的泛函：$\\mathcal{J}(\\mathbf{u}) = \\int_{\\mathbb{T}^2} \\left\\| \\operatorname{sym}\\nabla \\mathbf{u}(\\mathbf{x}) - \\boldsymbol{\\epsilon}(\\mathbf{x}) \\right\\|_F^2 \\, d\\mathbf{x}$。\n    - 约束条件：$\\int_{\\mathbb{T}^2} \\mathbf{u}(\\mathbf{x}) \\, d\\mathbf{x} = \\mathbf{0}$。\n    - 投影算子：$\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}] = \\operatorname{sym}\\nabla \\mathbf{u}^\\star$，其中 $\\mathbf{u}^\\star$ 是最小化子。\n    - 计算网格：$N \\times N$，其中 $N=32$。\n    - 波数：$k_i = 2\\pi \\, \\mathrm{fftfreq}(N)$，网格间距 $h=1/N$。\n    - 测试用例和要计算的特定量 ($r_1, r_2, r_3, r_4$) 已完全指定。\n\n- **验证**：\n    - **科学依据**：该问题植根于线性弹性和连续介质力学的基础理论。应变、协调性和变分原理的使用都是标准概念。\n    - **适定性**：该问题是希尔伯特空间上的一个经典二次最小化问题（最小二乘投影）。欧拉-拉格朗日方程构成一个适定的椭圆型偏微分方程组。对 $\\mathbf{u}$ 的零均值约束通过消除微分算子的核（刚体模式）来确保唯一解。\n    - **客观性**：该问题使用精确的数学和物理术语陈述，没有任何主观性。所有数据、约束和要求的输出都已明确定义。\n\n- **结论**：该问题是有效的。它是计算固体力学中一个定义明確的标准问题。\n\n### 第二步：推导与算法设计\n\n#### 欧拉-拉格朗日方程的推导\n目标是找到最小化泛函 $\\mathcal{J}(\\mathbf{u})$ 的位移场 $\\mathbf{u}$。最小化子 $\\mathbf{u}^\\star$ 满足以下条件：对于任何容许的变分 $\\delta\\mathbf{u}$，$\\mathcal{J}$ 的一阶变分都为零。被积函数是 Frobenius 范数的平方，对于一个对称的 $2 \\times 2$ 张量场 $\\mathbf{A}$，其值为 $\\|\\mathbf{A}\\|_F^2 = A_{xx}^2 + A_{yy}^2 + 2 A_{xy}^2$。\n设 $\\boldsymbol{\\epsilon}_{\\text{comp}} = \\operatorname{sym}\\nabla \\mathbf{u}$。该泛函为：\n$$\n\\mathcal{J}(\\mathbf{u}) = \\int_{\\mathbb{T}^2} \\left[ (\\epsilon_{\\text{comp},xx} - \\epsilon_{xx})^2 + (\\epsilon_{\\text{comp},yy} - \\epsilon_{yy})^2 + 2(\\epsilon_{\\text{comp},xy} - \\epsilon_{xy})^2 \\right] d\\mathbf{x}\n$$\n一阶变分为 $\\delta\\mathcal{J} = 0$：\n$$\n\\delta\\mathcal{J} = \\int_{\\mathbb{T}^2} 2(\\boldsymbol{\\epsilon}_{\\text{comp}} - \\boldsymbol{\\epsilon}) : \\delta\\boldsymbol{\\epsilon}_{\\text{comp}} \\, d\\mathbf{x} = 0\n$$\n其中 $\\mathbf{A}:\\mathbf{B} = \\sum_{ij} A_{ij}B_{ij}$ 是 Frobenius 内积。代入 $\\delta\\boldsymbol{\\epsilon}_{\\text{comp}} = \\operatorname{sym}\\nabla(\\delta\\mathbf{u})$：\n$$\n\\int_{\\mathbb{T}^2} (\\boldsymbol{\\epsilon}_{\\text{comp}} - \\boldsymbol{\\epsilon}) : \\operatorname{sym}\\nabla(\\delta\\mathbf{u}) \\, d\\mathbf{x} = 0\n$$\n利用 $(\\boldsymbol{\\epsilon}_{\\text{comp}} - \\boldsymbol{\\epsilon})$ 的对称性和内积的性质，上式变为：\n$$\n\\int_{\\mathbb{T}^2} (\\boldsymbol{\\epsilon}_{\\text{comp}} - \\boldsymbol{\\epsilon}) : \\nabla(\\delta\\mathbf{u}) \\, d\\mathbf{x} = 0\n$$\n应用分部积分法（环面上的散度定理），并注意到由于周期性边界项消失：\n$$\n- \\int_{\\mathbb{T}^2} \\operatorname{div}(\\boldsymbol{\\epsilon}_{\\text{comp}} - \\boldsymbol{\\epsilon}) \\cdot \\delta\\mathbf{u} \\, d\\mathbf{x} = 0\n$$\n此式必须对任何容许变分 $\\delta\\mathbf{u}$ 成立。容许变分空间由所有周期性、零均值的矢量场组成。这意味着 $\\operatorname{div}(\\boldsymbol{\\epsilon}_{\\text{comp}} - \\boldsymbol{\\epsilon})$ 项必须是一个常矢量。由于它本身也必须是零均值才能与所有零均值测试函数正交，所以它必须是零矢量。因此，我们得到了强形式的欧拉-拉格朗日方程：\n$$\n\\operatorname{div}(\\boldsymbol{\\epsilon}_{\\text{comp}}) = \\operatorname{div}(\\boldsymbol{\\epsilon}) \\quad \\text{或} \\quad \\sum_{i} \\partial_i (\\operatorname{sym}\\nabla \\mathbf{u})_{ij} = \\sum_{i} \\partial_i \\epsilon_{ij} \\quad \\text{for } j \\in \\{x,y\\}\n$$\n\n#### 傅里叶空间中的公式\n由于环面 $\\mathbb{T}^2$ 上的周期性边界条件，很自然地使用傅里叶级数表示。函数 $f(\\mathbf{x})$ 及其傅里叶级数系数 $\\hat{f}(\\mathbf{k})$ 通过 $f(\\mathbf{x}) = \\sum_{\\mathbf{k}} \\hat{f}(\\mathbf{k}) e^{i \\mathbf{k} \\cdot \\mathbf{x}}$ 相关联。偏导数算子 $\\partial_j$ 在傅里叶域中变为乘以 $i k_j$：$\\widehat{\\partial_j f}(\\mathbf{k}) = i k_j \\hat{f}(\\mathbf{k})$。\n对欧拉-拉格朗日方程逐分量应用傅里叶变换，我们为每个波矢 $\\mathbf{k}=(k_x, k_y)$ 获得一个关于傅里葉系数 $\\hat{\\mathbf{u}}(\\mathbf{k})=(\\hat{u}_x, \\hat{u}_y)$ 的线性代数方程组。\n欧拉-拉格朗日方程变为：\n$$\n\\sum_i i k_i (\\widehat{\\operatorname{sym}\\nabla \\mathbf{u}})_{ij} = \\sum_i i k_i \\hat{\\epsilon}_{ij}\n$$\n代入 $(\\widehat{\\operatorname{sym}\\nabla \\mathbf{u}})_{ij} = \\frac{1}{2}(i k_i \\hat{u}_j + i k_j \\hat{u}_i)$：\n$$\n-\\frac{1}{2} \\sum_i (k_i^2 \\hat{u}_j + k_i k_j \\hat{u}_i) = i \\sum_i k_i \\hat{\\epsilon}_{ij}\n$$\n这就得到了一个关于 $\\hat{\\mathbf{u}}(\\mathbf{k})$ 的 $2 \\times 2$ 线性系统：\n$$\n\\begin{pmatrix}\nk_x^2 + \\frac{1}{2} k_y^2 & \\frac{1}{2} k_x k_y \\\\\n\\frac{1}{2} k_x k_y & k_y^2 + \\frac{1}{2} k_x^2\n\\end{pmatrix}\n\\begin{pmatrix} \\hat{u}_x \\\\ \\hat{u}_y \\end{pmatrix}\n= -i\n\\begin{pmatrix}\nk_x \\hat{\\epsilon}_{xx} + k_y \\hat{\\epsilon}_{xy} \\\\\nk_x \\hat{\\epsilon}_{xy} + k_y \\hat{\\epsilon}_{yy}\n\\end{pmatrix}\n$$\n该矩阵的行列式为 $\\frac{1}{2}(k_x^2 + k_y^2)^2 = \\frac{1}{2} \\|\\mathbf{k}\\|^4$。对于任何 $\\mathbf{k} \\neq \\mathbf{0}$，此行列式非零，保证了每个非零波矢的 $\\hat{\\mathbf{u}}(\\mathbf{k})$ 都有唯一解。\n\n对于零波矢 $\\mathbf{k}=\\mathbf{0}$，方程变为平凡的 ($0=0$)。解由约束条件 $\\int_{\\mathbb{T}^2} \\mathbf{u}(\\mathbf{x}) d\\mathbf{x} = \\mathbf{0}$ 决定，这在傅里叶域中即为 $\\hat{\\mathbf{u}}(\\mathbf{0}) = \\mathbf{0}$。\n\n#### 算法\n投影 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}]$ 通过谱方法计算如下：\n1.  **正向 FFT**：给定 $N \\times N$ 网格上 $\\boldsymbol{\\epsilon}$ 的分量，计算它们的离散傅里叶变换 $\\hat{\\epsilon}_{xx}, \\hat{\\epsilon}_{yy}, \\hat{\\epsilon}_{xy}$。\n2.  **求解 $\\hat{\\mathbf{u}}$**：对于每个波矢 $\\mathbf{k}=(k_x, k_y)$：\n    - 如果 $\\mathbf{k}=\\mathbf{0}$，则设 $\\hat{\\mathbf{u}}(\\mathbf{0}) = \\mathbf{0}$。\n    - 如果 $\\mathbf{k}\\neq\\mathbf{0}$，求解关于 $\\hat{\\mathbf{u}}(\\mathbf{k})$ 的 $2 \\times 2$ 线性系统。这可以通过对每个 $\\mathbf{k}$ 解析地求 $2 \\times 2$ 矩阵的逆来高效完成。\n3.  **在傅里葉域中寻找协调应变**：使用傅里叶空间中对称梯度算子的关系式，计算投影应变的傅里叶系数 $\\hat{\\boldsymbol{\\epsilon}}_{\\text{comp}} = \\widehat{\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}]}$：\n    $$\n    \\hat{\\epsilon}_{\\text{comp},xx} = i k_x \\hat{u}_x, \\quad\n    \\hat{\\epsilon}_{\\text{comp},yy} = i k_y \\hat{u}_y, \\quad\n    \\hat{\\epsilon}_{\\text{comp},xy} = \\frac{i}{2}(k_y \\hat{u}_x + k_x \\hat{u}_y)\n    $$\n    注意，$\\hat{\\mathbf{u}}(\\mathbf{0})=\\mathbf{0}$ 意味着 $\\hat{\\boldsymbol{\\epsilon}}_{\\text{comp}}(\\mathbf{0})=\\mathbf{0}$。这意味着投影后的协调应变具有零空间平均值。因此，任何空间均匀（常数）的输入应变场都将投影为零场。\n4.  **逆向 FFT**：对 $\\hat{\\boldsymbol{\\epsilon}}_{\\text{comp}}$ 的分量执行逆傅里葉变换，以在物理空间中获得协调应变场 $\\Pi_{\\text{comp}}[\\boldsymbol{\\epsilon}]$。\n\n该算法针对指定的四个测试用例实现。计算过程，包括 Saint-Venant 残差的导数和范数，酌情使用谱方法或在离散网格上执行。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem, orchestrating the test cases and printing the final results.\n    \"\"\"\n    #\n    # Global parameters\n    #\n    N = 32\n    ALPHA = 0.1\n    RNG_SEED = 42\n\n    #\n    # Grid and wavenumbers setup\n    #\n    h = 1.0 / N\n    x = np.arange(N) * h\n    X, Y = np.meshgrid(x, x, indexing='ij')\n\n    # Angular wavenumbers for a domain of size 1.0 discretized with N points.\n    # The frequencies from fftfreq are in cycles per sample spacing. With d=h=1/N, these\n    # are in cycles per unit distance.\n    freq = np.fft.fftfreq(N, d=h)\n    k = 2 * np.pi * freq\n    KX, KY = np.meshgrid(k, k, indexing='ij')\n\n    #\n    # Helper functions\n    #\n    def l2_norm(eps_xx, eps_yy, eps_xy):\n        \"\"\"Computes the discrete L2 norm of a strain field.\"\"\"\n        # Pointwise Frobenius norm squared: eps_xx^2 + eps_yy^2 + 2 * eps_xy^2\n        integrand = eps_xx**2 + eps_yy**2 + 2 * eps_xy**2\n        # The integral is approximated by the mean over the grid (area is 1).\n        mean_val = np.mean(integrand)\n        return np.sqrt(mean_val)\n\n    def project_to_compatible(eps_xx, eps_yy, eps_xy):\n        \"\"\"\n        Projects a strain field onto the space of compatible strains using Fourier method.\n        \"\"\"\n        # 1. Transform input strain to Fourier domain\n        eps_xx_hat = np.fft.fft2(eps_xx)\n        eps_yy_hat = np.fft.fft2(eps_yy)\n        eps_xy_hat = np.fft.fft2(eps_xy)\n        \n        # 2. Solve per-wavevector linear systems for u_hat\n        k_norm_sq = KX**2 + KY**2\n        # Mask for k != 0 to avoid division by zero\n        nonzero_k_mask = k_norm_sq > 1e-15\n\n        # RHS vector b = -i * [k_x*eps_xx_hat + k_y*eps_xy_hat, k_x*eps_xy_hat + k_y*eps_yy_hat]\n        b_x = -1j * (KX * eps_xx_hat + KY * eps_xy_hat)\n        b_y = -1j * (KX * eps_xy_hat + KY * eps_yy_hat)\n\n        # The system is M * u_hat = b. We solve using M_inv.\n        # Determinant of M is 0.5 * k_norm_sq^2\n        det_M = 0.5 * k_norm_sq**2\n        \n        u_x_hat = np.zeros((N, N), dtype=np.complex128)\n        u_y_hat = np.zeros((N, N), dtype=np.complex128)\n\n        # Compute inv(det(M)) only for non-zero k\n        inv_det_M = np.zeros_like(det_M)\n        inv_det_M[nonzero_k_mask] = 1.0 / det_M[nonzero_k_mask]\n        \n        # Apply M_inv to b for k != 0\n        u_x_hat[nonzero_k_mask] = inv_det_M[nonzero_k_mask] * (\n            (KY[nonzero_k_mask]**2 + 0.5 * KX[nonzero_k_mask]**2) * b_x[nonzero_k_mask] - \n            (0.5 * KX[nonzero_k_mask] * KY[nonzero_k_mask]) * b_y[nonzero_k_mask]\n        )\n        u_y_hat[nonzero_k_mask] = inv_det_M[nonzero_k_mask] * (\n            -(0.5 * KX[nonzero_k_mask] * KY[nonzero_k_mask]) * b_x[nonzero_k_mask] + \n            (KX[nonzero_k_mask]**2 + 0.5 * KY[nonzero_k_mask]**2) * b_y[nonzero_k_mask]\n        )\n        # u_hat(k=0) is already zero from initialization, enforcing zero mean displacement.\n\n        # 3. Reconstruct compatible strain in Fourier domain\n        eps_comp_xx_hat = 1j * KX * u_x_hat\n        eps_comp_yy_hat = 1j * KY * u_y_hat\n        eps_comp_xy_hat = 0.5j * (KY * u_x_hat + KX * u_y_hat)\n\n        # 4. Invert transform to get compatible strain in physical space\n        eps_comp_xx = np.real(np.fft.ifft2(eps_comp_xx_hat))\n        eps_comp_yy = np.real(np.fft.ifft2(eps_comp_yy_hat))\n        eps_comp_xy = np.real(np.fft.ifft2(eps_comp_xy_hat))\n\n        return eps_comp_xx, eps_comp_yy, eps_comp_xy\n\n    #\n    # Test case functions\n    #\n    def run_test_case_1():\n        eps1_xx = 2 * np.pi * np.cos(2 * np.pi * X)\n        eps1_yy = 4 * np.pi * np.cos(4 * np.pi * Y)\n        eps1_xy = 0.4 * np.pi * np.sin(2 * np.pi * X) - 0.3 * np.pi * np.sin(2 * np.pi * Y)\n        eps1_comp_xx, eps1_comp_yy, eps1_comp_xy = project_to_compatible(eps1_xx, eps1_yy, eps1_xy)\n        norm_diff = l2_norm(eps1_comp_xx - eps1_xx, eps1_comp_yy - eps1_yy, eps1_comp_xy - eps1_xy)\n        norm_orig = l2_norm(eps1_xx, eps1_yy, eps1_xy)\n        return norm_diff / norm_orig\n\n    def run_test_case_2():\n        rng = np.random.default_rng(RNG_SEED)\n        eps2_xx_raw = rng.standard_normal((N, N))\n        eps2_yy_raw = rng.standard_normal((N, N))\n        eps2_xy_raw = rng.standard_normal((N, N))\n        \n        k_norm_sq = KX**2 + KY**2\n        filter_mult = np.exp(-ALPHA * k_norm_sq)\n\n        def apply_filter(field):\n            field_hat = np.fft.fft2(field)\n            field_hat[0, 0] = 0\n            return np.real(np.fft.ifft2(field_hat * filter_mult))\n\n        eps2_xx = apply_filter(eps2_xx_raw)\n        eps2_yy = apply_filter(eps2_yy_raw)\n        eps2_xy = apply_filter(eps2_xy_raw)\n        \n        eps2_comp_xx, eps2_comp_yy, eps2_comp_xy = project_to_compatible(eps2_xx, eps2_yy, eps2_xy)\n\n        eps2_comp_xx_hat = np.fft.fft2(eps2_comp_xx)\n        eps2_comp_yy_hat = np.fft.fft2(eps2_comp_yy)\n        eps2_comp_xy_hat = np.fft.fft2(eps2_comp_xy)\n        \n        residual_hat = -KY**2 * eps2_comp_xx_hat - KX**2 * eps2_comp_yy_hat + 2 * KX * KY * eps2_comp_xy_hat\n        residual = np.real(np.fft.ifft2(residual_hat))\n        \n        return np.sqrt(np.mean(residual**2))\n\n    def run_test_case_3():\n        eps3_xx = 0.1 * np.ones((N, N))\n        eps3_yy = -0.02 * np.ones((N, N))\n        eps3_xy = 0.05 * np.ones((N, N))\n        eps3_comp_xx, eps3_comp_yy, eps3_comp_xy = project_to_compatible(eps3_xx, eps3_yy, eps3_xy)\n        return l2_norm(eps3_comp_xx, eps3_comp_yy, eps3_comp_xy)\n\n    def run_test_case_4():\n        eps4a_xx = -np.pi * np.sin(2 * np.pi * X + 0.25)\n        eps4a_yy = 1.2 * np.pi * np.sin(2 * np.pi * Y + 0.3)\n        eps4a_xy = 0.5 * (0.2 * 2 * np.pi * np.cos(2*np.pi*Y) + 0.3 * 2 * np.pi * np.cos(2*np.pi*X))\n\n        eps4b_xx = 0.1 * np.ones((N, N))\n        eps4b_yy = -0.02 * np.ones((N, N))\n        eps4b_xy = 0.05 * np.ones((N, N))\n\n        eps4_xx, eps4_yy, eps4_xy = eps4a_xx + eps4b_xx, eps4a_yy + eps4b_yy, eps4a_xy + eps4b_xy\n        eps4_comp_xx, eps4_comp_yy, eps4_comp_xy = project_to_compatible(eps4_xx, eps4_yy, eps4_xy)\n        \n        norm_diff = l2_norm(eps4_comp_xx - eps4a_xx, eps4_comp_yy - eps4a_yy, eps4_comp_xy - eps4a_xy)\n        norm_orig = l2_norm(eps4a_xx, eps4a_yy, eps4a_xy)\n        return norm_diff / norm_orig\n\n    r1 = run_test_case_1()\n    r2 = run_test_case_2()\n    r3 = run_test_case_3()\n    r4 = run_test_case_4()\n\n    results = [r1, r2, r3, r4]\n    \n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3603578"}]}