{"hands_on_practices": [{"introduction": "本次实践是您将虚功原理应用于计算力学的第一步。我们将从抽象的原理出发，为非线性弹性系统推导出具体的代数方程——即残差向量。[@problem_id:3561387] 这个练习将引导您完成这个过程，是将物理问题转化为计算机可以理解和求解的语言的基础。", "problem": "一根长度为 $L$、横截面积恒为 $A$ 的棱柱状土柱被建模为一个一维小应变超弹性体，其储存能量密度为 $W(\\varepsilon)$，其中轴向应变为 $\\varepsilon = \\frac{du}{dx}$，Cauchy 应力为 $\\sigma(\\varepsilon) = \\frac{\\partial W(\\varepsilon)}{\\partial \\varepsilon}$。该土柱在轴向受到均匀体力 $b_0$ 的作用，其位移本质边界条件为 $u(0)=0$，在 $x=L$ 处为无面力自然边界。从虚功原理出发，推导平衡的弱形式，然后为一个跨越整个土柱的单一双节点等参线性单元构建有限维残差。储存能量密度为\n$$\nW(\\varepsilon) = \\mu\\varepsilon^{2} + \\alpha\\varepsilon^{4}, \\quad \\mu>0,\\ \\alpha>0,\n$$\nCauchy 应力由 $\\sigma(\\varepsilon)=\\frac{\\partial W(\\varepsilon)}{\\partial \\varepsilon}$ 定义。使用有限元法 (FEM)，在参考区间 $\\xi\\in[-1,1]$ 上采用标准线性形函数 $N_1(\\xi) = \\frac{1-\\xi}{2}$ 和 $N_2(\\xi) = \\frac{1+\\xi}{2}$，并使用两点 Gauss-Legendre 求积进行数值积分。清晰地指出试探函数和检验函数的无限维函数空间，以及评估残差所需的求积分量。将离散残差简化为与 $x=L$ 处自由度相关的单个方程。将最终答案表示为标量残差 $R(u_2)$ 的一个单一闭式解析表达式，用 $u_2$、$L$、$A$、$\\mu$、$\\alpha$ 和 $b_0$ 表示。无需进行数值计算，也无需四舍五入。将最终答案写成一个解析表达式。", "solution": "首先验证问题的科学性、适定性和客观性。\n\n### 步骤 1：提取已知条件\n- **区域：** 长度为 $L$、横截面积恒为 $A$ 的一维土柱。区域为 $x \\in [0, L]$。\n- **本构模型：** 超弹性材料，储存能量密度为 $W(\\varepsilon) = \\mu\\varepsilon^{2} + \\alpha\\varepsilon^{4}$，其中 $\\mu>0$ 且 $\\alpha>0$。\n- **应力-应变关系：** Cauchy 应力 $\\sigma(\\varepsilon) = \\frac{\\partial W(\\varepsilon)}{\\partial \\varepsilon}$。\n- **运动学：** 小应变，轴向应变 $\\varepsilon = \\frac{du}{dx}$。\n- **荷载：** 均匀轴向体力 $b_0$。\n- **边界条件：**\n  - $x=0$ 处的本质 (Dirichlet) 边界条件：$u(0)=0$。\n  - $x=L$ 处的自然 (Neumann) 边界条件：无面力，意味着施加的面力为零。\n- **离散化：** 一个跨越整个区域 $[0, L]$ 的双节点等参线性有限元。\n- **形函数：** 在参考区间 $\\xi \\in [-1, 1]$ 上，线性形函数为 $N_1(\\xi) = \\frac{1-\\xi}{2}$ 和 $N_2(\\xi) = \\frac{1+\\xi}{2}$。\n- **数值积分：** 两点 Gauss-Legendre 求积。\n- **目标：** 推导 $x=L$ 处自由度 $u_2$ 的标量残差 $R(u_2)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是应用在连续介质力学中的非线性有限元分析的标准练习。\n- **科学性：** 该问题的公式基于虚功原理、超弹性性和有限元方法，这些都是计算力学中的基本概念。所选的储存能量函数是描述非线性弹性的一个简单但有效的多项式形式。\n- **适定性：** 问题提供了推导所要求的残差代数表达式所需的全部信息（几何、材料定律、荷载、边界条件和离散化方法）。边界条件是悬臂杆在自重作用下的标准边界条件，这使得问题是适定的。\n- **客观性：** 问题陈述使用了精确、明确的技术语言。所有术语均为该领域的标准术语。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。现在开始求解过程。\n\n### 求解推导\n\n物体的平衡由虚功原理 (PVW) 控制，该原理指出，对于任何运动学上容许的虚位移，内虚功等于外虚功。\n\n平衡方程的弱形式由虚功原理推导得出。对于一维物体，其表述为：寻找一个位移场 $u$，属于试探函数空间 $\\mathcal{S}$，使得对于所有来自检验函数空间 $\\mathcal{V}$ 的虚位移 $\\delta u$，以下方程成立：\n$$\n\\int_{0}^{L} \\delta\\varepsilon \\, \\sigma(\\varepsilon) \\, A \\, dx = \\int_{0}^{L} \\delta u \\, b_0 \\, A \\, dx + [\\delta u \\, T]_{x=L}\n$$\n其中 $\\varepsilon = \\frac{du}{dx}$ 是轴向应变，$\\delta\\varepsilon = \\frac{d(\\delta u)}{dx}$ 是虚应变，$T$ 是边界上施加的面力。\n\n无限维试探空间 $\\mathcal{S}$ 和检验空间 $\\mathcal{V}$ 根据边界条件定义：\n- 试探空间：$\\mathcal{S} = \\{ u \\in H^1(0, L) \\mid u(0)=0 \\}$\n- 检验空间：$\\mathcal{V} = \\{ \\delta u \\in H^1(0, L) \\mid \\delta u(0)=0 \\}$\n这里，$H^1(0, L)$ 是在 $(0,L)$ 上函数值及其一阶导数均平方可积的 Sobolev 空间。\n\n问题陈述在 $x=L$ 处为无面力自然边界，这意味着施加的面力 $T$ 为零。因此，弱形式简化为：\n$$\n\\int_{0}^{L} \\sigma(\\varepsilon) \\frac{d(\\delta u)}{dx} A \\, dx - \\int_{0}^{L} b_0 \\delta u A \\, dx = 0\n$$\n\n现在我们使用一个双节点有限元来离散化区域。节点 1 位于 $x_1=0$，节点 2 位于 $x_2=L$。位移场 $u(x)$ 通过节点位移 $u_1$ 和 $u_2$ 近似为 $u^h(x)$：\n$$\nu^h(x) = N_1(x) u_1 + N_2(x) u_2\n$$\n边界条件 $u(0)=0$ 意味着 $u_1=0$。因此，位移场的近似为：\n$$\nu^h(x) = N_2(x) u_2\n$$\n虚位移同样近似为：$\\delta u^h(x) = N_2(x) \\delta u_2$。\n\n从参考坐标 $\\xi \\in [-1, 1]$ 到物理坐标 $x \\in [0, L]$ 的等参映射由下式给出：\n$$\nx(\\xi) = N_1(\\xi)x_1 + N_2(\\xi)x_2 = \\frac{1-\\xi}{2}(0) + \\frac{1+\\xi}{2}(L) = \\frac{L(1+\\xi)}{2}\n$$\n该变换的雅可比行列式为 $J = \\frac{dx}{d\\xi} = \\frac{L}{2}$。其逆为 $\\frac{d\\xi}{dx} = \\frac{1}{J} = \\frac{2}{L}$。\n\n应变 $\\varepsilon$ 近似为 $\\varepsilon^h = \\frac{du^h}{dx}$。使用链式法则：\n$$\n\\varepsilon^h = \\frac{du^h}{d\\xi} \\frac{d\\xi}{dx} = \\left( \\frac{dN_2}{d\\xi} u_2 \\right) \\frac{1}{J} = \\left( \\frac{1}{2} u_2 \\right) \\frac{2}{L} = \\frac{u_2}{L}\n$$\n值得注意的是，应变在整个单元内是恒定的。虚应变为 $\\delta\\varepsilon^h = \\frac{\\delta u_2}{L}$。\n\nCauchy 应力 $\\sigma$ 由 $\\sigma(\\varepsilon) = \\frac{\\partial W}{\\partial \\varepsilon} = 2\\mu\\varepsilon + 4\\alpha\\varepsilon^3$ 给出。代入 $\\varepsilon^h$ 的表达式：\n$$\n\\sigma(\\varepsilon^h) = 2\\mu\\left(\\frac{u_2}{L}\\right) + 4\\alpha\\left(\\frac{u_2}{L}\\right)^3\n$$\n应力在整个单元内也是恒定的。\n\n将离散近似代入弱形式：\n$$\n\\int_{0}^{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) \\left( \\frac{\\delta u_2}{L} \\right) A \\, dx - \\int_{0}^{L} b_0 (N_2(x) \\delta u_2) A \\, dx = 0\n$$\n由于 $\\delta u_2$ 是代表自由节点处虚位移的任意标量，我们可以将其提取出来。剩余的表达式定义了自由度 $u_2$ 的标量残差 $R(u_2)$：\n$$\nR(u_2) = \\int_{0}^{L} \\frac{A}{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) dx - \\int_{0}^{L} b_0 N_2(x) A \\, dx\n$$\n第一个积分的被积函数关于 $x$ 是常数：\n$$\n\\int_{0}^{L} \\frac{A}{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) dx = \\frac{A}{L} \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) \\int_{0}^{L} dx = A \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right)\n$$\n这是内力分量。\n\n第二个积分对应于外力。我们使用指定的两点 Gauss-Legendre 求积来计算它。在 $\\xi \\in [-1, 1]$ 上的求积点是 $\\xi_1 = -\\frac{1}{\\sqrt{3}}$ 和 $\\xi_2 = \\frac{1}{\\sqrt{3}}$，权重是 $w_1 = w_2 = 1$。\n$$\n\\int_{0}^{L} b_0 N_2(x) A \\, dx = \\int_{-1}^{1} b_0 N_2(\\xi) A J \\, d\\xi \\approx \\sum_{i=1}^{2} w_i \\left[ b_0 N_2(\\xi_i) A J \\right]\n$$\n由于 $A$、$b_0$ 和 $J=\\frac{L}{2}$ 是常数：\n$$\nb_0 A \\frac{L}{2} \\sum_{i=1}^{2} w_i N_2(\\xi_i) = b_0 A \\frac{L}{2} \\left[ (1) \\frac{1+\\xi_1}{2} + (1) \\frac{1+\\xi_2}{2} \\right]\n$$\n$$\n= b_0 A \\frac{L}{2} \\left[ \\frac{1 - 1/\\sqrt{3}}{2} + \\frac{1 + 1/\\sqrt{3}}{2} \\right] = b_0 A \\frac{L}{2} \\left( \\frac{2}{2} \\right) = \\frac{A b_0 L}{2}\n$$\n由于被积函数 $N_2(\\xi)$ 是一个一阶多项式，两点 Gauss 求积是精确的。\n\n结合内力和外力项，残差 $R(u_2)$ 为：\n$$\nR(u_2) = A \\left( 2\\mu\\frac{u_2}{L} + 4\\alpha\\frac{u_2^3}{L^3} \\right) - \\frac{A b_0 L}{2}\n$$\n这可以重写为：\n$$\nR(u_2) = \\frac{2A\\mu u_2}{L} + \\frac{4A\\alpha u_2^3}{L^3} - \\frac{A b_0 L}{2}\n$$\n这是与自由度 $u_2$ 相关的标量残差的最终闭式表达式。", "answer": "$$\n\\boxed{\\frac{2A\\mu u_2}{L} + \\frac{4A\\alpha u_2^3}{L^3} - \\frac{A b_0 L}{2}}\n$$", "id": "3561387"}, {"introduction": "在建立了非线性平衡方程（残差）之后，接下来的挑战是如何求解它们。本次实践将向您展示如何通过对内力向量进行一致性线性化，来推导相容切线刚度矩阵。[@problem_id:3591302] 该矩阵是牛顿-拉夫逊方法（Newton-Raphson method）的基石，也是求解固体力学中非线性问题的核心。", "problem": "考虑一个沿 $x$ 轴放置的、未变形长度为 $L$、恒定横截面积为 $A$ 的双节点等参杆有限元，该单元承受小应变。轴向位移场由标准线性形函数 $N_{1}(x)=1-\\frac{x}{L}$ 和 $N_{2}(x)=\\frac{x}{L}$ 近似表示为 $u_{h}(x)=N_{1}(x)\\,u_{1}+N_{2}(x)\\,u_{2}$，其中 $u_{1}$ 和 $u_{2}$ 是节点轴向位移。材料为一维超弹性固体，其亥姆霍兹自由能密度为 $\\psi(\\varepsilon)=\\frac{1}{2}\\,E\\,\\varepsilon^{2}+\\frac{\\alpha}{4}\\,\\varepsilon^{4}$，其中 $\\varepsilon$ 是小轴向应变，$E0$ 是线性弹性模量，$\\alpha \\ge 0$ 是材料非线性参数。\n\n仅使用虚功原理 (PVW) 和源于自由能的定义，建立单元内虚功的公式，并推导出单元内力向量。然后，通过对节点位移向量 $\\mathbf{u}_{e}=[u_{1}\\;\\;u_{2}]^{T}$ 进行一致性线性化，推导该单元的一致切线刚度矩阵，用 $A$、$L$、$E$、$\\alpha$、$u_{1}$ 和 $u_{2}$ 表示。\n\n假设等温条件，忽略体力与面力，并在小应变、一维框架下进行分析。\n\n将最终答案表示为关于 $u_{1}$ 和 $u_{2}$ 的单个闭合形式 $2\\times 2$ 矩阵函数，不带单位。不要通过引入中间常量来简化。无需进行数值计算。", "solution": "该问题是有效的，因为它科学地基于连续介质力学和有限元方法的原理，信息充分，问题适定，并且陈述客观。\n\n针对特定的一维超弹性杆单元，一致切线刚度矩阵的推导过程分为四个步骤：建立运动学关系，根据给定的自由能定义本构关系，通过虚功原理 (PVW) 建立内力向量，最后对内力向量进行线性化。\n\n**步骤 1：运动学**\n\n单元内的轴向位移场 $u_{h}(x)$ 是通过线性形函数 $N_{1}(x) = 1 - \\frac{x}{L}$ 和 $N_{2}(x) = \\frac{x}{L}$ 从节点位移 $u_{1}$ 和 $u_{2}$ 插值得到的。\n用矩阵形式表示为 $u_{h}(x) = \\mathbf{N}(x)\\mathbf{u}_{e}$，其中 $\\mathbf{N}(x) = \\begin{pmatrix} N_{1}(x)  N_{2}(x) \\end{pmatrix}$ 且 $\\mathbf{u}_{e} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$。\n\n在小应变框架下，轴向应变 $\\varepsilon$ 是位移场的空间导数：\n$$\n\\varepsilon(x) = \\frac{d u_{h}}{dx} = \\frac{d\\mathbf{N}}{dx}\\mathbf{u}_{e}\n$$\n形函数矩阵的导数是应变-位移矩阵 $\\mathbf{B}$：\n$$\n\\mathbf{B}(x) = \\frac{d\\mathbf{N}}{dx} = \\begin{pmatrix} \\frac{dN_{1}}{dx}  \\frac{dN_{2}}{dx} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix}\n$$\n由于 $\\mathbf{B}$ 是常数，因此应变 $\\varepsilon$ 在整个单元内是均匀的：\n$$\n\\varepsilon = \\mathbf{B}\\mathbf{u}_{e} = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix} \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} = \\frac{u_{2} - u_{1}}{L}\n$$\n\n**步骤 2：本构关系**\n\n该材料是超弹性的，其行为由亥姆霍兹自由能密度 $\\psi(\\varepsilon)$ 控制。对于等温过程，轴向应力 $\\sigma$ 与轴向应变 $\\varepsilon$ 是热力学共轭的，通过对 $\\psi$ 关于 $\\varepsilon$ 求导得到：\n$$\n\\sigma = \\frac{\\partial\\psi}{\\partial\\varepsilon}\n$$\n给定自由能密度 $\\psi(\\varepsilon) = \\frac{1}{2}\\,E\\,\\varepsilon^{2}+\\frac{\\alpha}{4}\\,\\varepsilon^{4}$，应力为：\n$$\n\\sigma = \\frac{\\partial}{\\partial\\varepsilon} \\left( \\frac{1}{2}\\,E\\,\\varepsilon^{2}+\\frac{\\alpha}{4}\\,\\varepsilon^{4} \\right) = E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3}\n$$\n这是一个非线性应力-应变关系。\n\n**步骤 3：内力向量**\n\n虚功原理 (PVW) 指出，内虚功 $\\delta W_{int}$ 等于外虚功 $\\delta W_{ext}$。对于处于平衡状态的单元，我们考虑其内部部分。内虚功是应力在整个单元体积 $V$ 上对虚应变 $\\delta\\varepsilon$ 的积分。\n$$\n\\delta W_{int} = \\int_{V} \\sigma \\, \\delta\\varepsilon \\, dV\n$$\n在一维情况下，$dV = A\\,dx$，其中 $A$ 是横截面积。虚应变由 $\\delta\\varepsilon = \\mathbf{B}\\,\\delta\\mathbf{u}_{e}$ 给出。将此代入 $\\delta W_{int}$ 的表达式中：\n$$\n\\delta W_{int} = \\int_{0}^{L} \\sigma \\, (\\mathbf{B}\\,\\delta\\mathbf{u}_{e}) \\, A \\, dx\n$$\n由于节点虚位移 $\\delta\\mathbf{u}_{e}$ 是任意的且不是 $x$ 的函数，我们可以将其写为：\n$$\n\\delta W_{int} = \\delta\\mathbf{u}_{e}^{T} \\left( \\int_{0}^{L} \\mathbf{B}^{T} \\, \\sigma \\, A \\, dx \\right)\n$$\n根据定义，括号中的表达式是单元内力向量 $\\mathbf{f}_{int}$：\n$$\n\\mathbf{f}_{int} = \\int_{0}^{L} \\mathbf{B}^{T} \\, \\sigma \\, A \\, dx\n$$\n由于 $\\mathbf{B}$、$\\sigma$（因为 $\\varepsilon$ 是均匀的）和 $A$ 在单元长度上都是常数，积分可以简化为：\n$$\n\\mathbf{f}_{int} = A \\, L \\, \\mathbf{B}^{T} \\, \\sigma\n$$\n代入 $\\mathbf{B}$ 和 $\\sigma$ 的表达式：\n$$\n\\mathbf{f}_{int} = A \\, L \\, \\begin{pmatrix} -\\frac{1}{L} \\\\ \\frac{1}{L} \\end{pmatrix} (E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3}) = A \\, \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} (E\\,\\varepsilon + \\alpha\\,\\varepsilon^{3})\n$$\n最后，代入 $\\varepsilon = \\frac{u_{2} - u_{1}}{L}$：\n$$\n\\mathbf{f}_{int} = A \\, \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\left( E\\frac{u_{2} - u_{1}}{L} + \\alpha\\left(\\frac{u_{2} - u_{1}}{L}\\right)^{3} \\right)\n$$\n\n**步骤 4：一致切线刚度矩阵**\n\n一致切线刚度矩阵 $\\mathbf{K}_{T}$ 是通过内力向量 $\\mathbf{f}_{int}$ 对节点位移向量 $\\mathbf{u}_{e}$ 的线性化得到的。这对应于求 $\\mathbf{f}_{int}$ 的雅可比矩阵：\n$$\n\\mathbf{K}_{T} = \\frac{\\partial \\mathbf{f}_{int}}{\\partial \\mathbf{u}_{e}} = \\begin{pmatrix} \\frac{\\partial (f_{int})_{1}}{\\partial u_{1}}  \\frac{\\partial (f_{int})_{1}}{\\partial u_{2}} \\\\ \\frac{\\partial (f_{int})_{2}}{\\partial u_{1}}  \\frac{\\partial (f_{int})_{2}}{\\partial u_{2}} \\end{pmatrix}\n$$\n让我们计算其分量。$\\mathbf{f}_{int}$ 的分量为：\n$$\n(f_{int})_{1} = -A \\left( \\frac{E}{L}(u_{2} - u_{1}) + \\frac{\\alpha}{L^{3}}(u_{2} - u_{1})^{3} \\right)\n$$\n$$\n(f_{int})_{2} = +A \\left( \\frac{E}{L}(u_{2} - u_{1}) + \\frac{\\alpha}{L^{3}}(u_{2} - u_{1})^{3} \\right)\n$$\n求偏导数：\n$$\nK_{T,11} = \\frac{\\partial (f_{int})_{1}}{\\partial u_{1}} = -A \\left( \\frac{E}{L}(-1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(-1) \\right) = \\frac{AE}{L} + \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\n$$\nK_{T,12} = \\frac{\\partial (f_{int})_{1}}{\\partial u_{2}} = -A \\left( \\frac{E}{L}(1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(1) \\right) = -\\frac{AE}{L} - \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\n$$\nK_{T,21} = \\frac{\\partial (f_{int})_{2}}{\\partial u_{1}} = A \\left( \\frac{E}{L}(-1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(-1) \\right) = -\\frac{AE}{L} - \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\n$$\nK_{T,22} = \\frac{\\partial (f_{int})_{2}}{\\partial u_{2}} = A \\left( \\frac{E}{L}(1) + \\frac{\\alpha}{L^{3}} \\cdot 3(u_{2} - u_{1})^{2}(1) \\right) = \\frac{AE}{L} + \\frac{3A\\alpha}{L^{3}}(u_{2} - u_{1})^{2}\n$$\n将这些分量组合成矩阵，得到一致切线刚度矩阵的最终表达式：\n$$\n\\mathbf{K}_{T} = \\begin{pmatrix} \\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}}  -\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} \\\\ -\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}}  \\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} \\end{pmatrix}\n$$\n该矩阵是对称的，正如所预期的。如果非线性材料参数 $\\alpha = 0$，该矩阵正确地简化为杆单元的标准线性刚度矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}}   -\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}} \\\\\n-\\frac{AE}{L} - \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}}   \\frac{AE}{L} + \\frac{3A\\alpha(u_{2} - u_{1})^{2}}{L^{3}}\n\\end{pmatrix}\n}\n$$", "id": "3591302"}, {"introduction": "虚功原理的威力远不止于处理简单的保守系统。本次实践将探讨一个更高级的场景，它涉及在稳定性分析（例如颤振）中至关重要的非保守“随动”荷载。[@problem_id:3591290] 您将看到虚功原理如何自然地处理这些力，并导出一个非对称的切线刚度矩阵——这是此类系统一个反直觉但至关重要的特征。", "problem": "考虑一个在有限元法 (FEM) 中使用的平面双节点直杆单元。该杆的初始构型中，节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(L,0)$，其中 $L0$ 是未变形长度。节点 $1$ 是固定的。节点 $2$ 在 $x$ 和 $y$ 方向上分别发生平移位移 $(u_x,u_y)$。一个大小恒定为 $P0$ 的非保守随动荷载施加于节点 $2$，其方向始终沿着变形构型中杆轴线的当前单位法向量。该杆是超弹性的，具有对称的内切线贡献，但您应只关注外部随动荷载对切线的贡献。\n\n使用虚功原理 (PVW)，从基本弱形式陈述开始，即平衡时总虚功为零：$\\delta W_{\\text{int}} - \\delta W_{\\text{ext}} = 0$，其中 $\\delta W_{\\text{int}}$ 是内虚功，$\\delta W_{\\text{ext}}$ 是由随动荷载引起的外虚功。将内虚功视为产生对称的切线贡献，并仅考虑外部随动荷载的贡献以证明不对称性。\n\n设从节点 $1$ 到节点 $2$ 的当前向量为 $\\mathbf{r} = (x,y)$，其中 $x=L+u_x$ 和 $y=u_y$，其长度为 $R=\\sqrt{x^2+y^2}$。定义沿杆的当前单位切向量为 $\\mathbf{t} = \\mathbf{r}/R$，相应的单位法向量为 $\\mathbf{n} = (-t_y, t_x) = \\left(-\\dfrac{y}{R}, \\dfrac{x}{R}\\right)$。则由随动荷载引起的节点 $2$ 上的外部节点力为 $\\mathbf{f}_{\\text{ext}} = P\\,\\mathbf{n}$。\n\n构造离散外虚功 $\\delta W_{\\text{ext}} = \\mathbf{f}_{\\text{ext}} \\cdot \\delta \\mathbf{u}_2$，并通过关于 $(u_x,u_y)$ 的一致线性化，求得对 $2\\times 2$ 切线矩阵的外部贡献 $\\mathbf{K}_{\\text{ext}} = \\dfrac{\\partial \\mathbf{f}_{\\text{ext}}}{\\partial \\mathbf{u}_2}$。计算 $\\mathbf{K}_{\\text{ext}}$ 的非对角线元素之差 $k_{12} - k_{21}$，并将其表示为关于 $P$、$L$、$u_x$ 和 $u_y$ 的闭式解析表达式。\n\n您的最终答案必须是一个单一的闭式解析表达式。所求量 $k_{12}-k_{21}$ 的单位是 $\\mathrm{N/m}$；请确保您的表达式在量纲上与力每长度一致。无需四舍五入。", "solution": "用户希望我解决一个计算固体力学问题。\n\n### 第1步：提取已知条件\n- 一个平面的、双节点的直杆单元。\n- 初始构型：节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(L,0)$，其中 $L0$。\n- 边界条件：节点 $1$ 固定。\n- 节点变量：节点 $2$ 的位移为 $(u_x, u_y)$。\n- 施加荷载：一个大小恒定为 $P0$ 的非保守随动荷载施加于节点 $2$。\n- 荷载方向：荷载沿杆轴线的当前单位法向量 $\\mathbf{n}$ 作用。\n- 虚功原理 (PVW)：平衡时 $\\delta W_{\\text{int}} - \\delta W_{\\text{ext}} = 0$。\n- 节点 $2$ 的当前位置向量：$\\mathbf{r} = (x,y)$，其中 $x=L+u_x$ 且 $y=u_y$。\n- 杆的当前长度：$R = \\sqrt{x^2+y^2}$。\n- 当前单位切向量：$\\mathbf{t} = \\mathbf{r}/R$。\n- 当前单位法向量：$\\mathbf{n} = (-t_y, t_x) = \\left(-\\dfrac{y}{R}, \\dfrac{x}{R}\\right)$。\n- 节点 $2$ 上的外部节点力向量：$\\mathbf{f}_{\\text{ext}} = P\\,\\mathbf{n}$。\n- 节点 $2$ 的位移向量：$\\mathbf{u}_2 = (u_x, u_y)$。\n- 外虚功：$\\delta W_{\\text{ext}} = \\mathbf{f}_{\\text{ext}} \\cdot \\delta \\mathbf{u}_2$。\n- 对切线矩阵的外部贡献：$\\mathbf{K}_{\\text{ext}} = \\dfrac{\\partial \\mathbf{f}_{\\text{ext}}}{\\partial \\mathbf{u}_2}$。\n- 所求量：$\\mathbf{K}_{\\text{ext}}$ 的非对角线元素之差 $k_{12} - k_{21}$。\n\n### 第2步：使用提取的已知条件进行验证\n根据指定标准对问题进行验证：\n- **科学依据**：该问题描述了非线性连续介质力学和有限元分析中的一个经典设置。随动荷载是导致非对称切线刚度矩阵的非保守荷载的一个广为人知的来源。虚功原理是此分析的基本基础。该问题在科学上是合理的。\n- **适定性**：该问题提供了推导所求量所需的所有定义和方程。目标明确，且存在唯一的解析解。\n- **客观性**：该问题使用精确的数学和工程术语进行陈述。没有主观或模棱两可的陈述。\n\n该问题不违反任何无效性标准。它是计算力学中一个标准的、可形式化的问题。\n\n### 第3步：结论与行动\n问题有效。我将继续进行求解。\n\n### 解的推导\n目标是计算外部切线矩阵 $\\mathbf{K}_{\\text{ext}}$ 的非对角线元素之差 $k_{12} - k_{21}$。该矩阵定义为外部力向量 $\\mathbf{f}_{\\text{ext}}$ 关于节点位移向量 $\\mathbf{u}_2$ 的雅可比矩阵。\n\n节点 $2$ 的位移向量为 $\\mathbf{u}_2 = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix}$。\n节点 $2$ 的当前位置由向量 $\\mathbf{r} = \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} L+u_x \\\\ u_y \\end{pmatrix}$ 给出。\n杆的当前长度为 $R = \\|\\mathbf{r}\\| = \\sqrt{x^2+y^2} = \\sqrt{(L+u_x)^2 + u_y^2}$。\n\n外部随动荷载向量 $\\mathbf{f}_{\\text{ext}}$ 施加于节点 $2$，由 $\\mathbf{f}_{\\text{ext}} = P\\,\\mathbf{n}$ 给出。单位法向量 $\\mathbf{n}$ 定义为 $\\mathbf{n} = \\begin{pmatrix} -y/R \\\\ x/R \\end{pmatrix}$。\n将 $x$、$y$ 和 $R$ 的表达式代入，我们用位移 $u_x$ 和 $u_y$ 来表示力向量 $\\mathbf{f}_{\\text{ext}}$：\n$$\n\\mathbf{f}_{\\text{ext}} = \\begin{pmatrix} f_1 \\\\ f_2 \\end{pmatrix} = P \\begin{pmatrix} -u_y / \\sqrt{(L+u_x)^2 + u_y^2} \\\\ (L+u_x) / \\sqrt{(L+u_x)^2 + u_y^2} \\end{pmatrix} = \\frac{P}{R} \\begin{pmatrix} -y \\\\ x \\end{pmatrix}\n$$\n\n外部切线矩阵 $\\mathbf{K}_{\\text{ext}}$ 是一个 $2 \\times 2$ 矩阵，定义为：\n$$\n\\mathbf{K}_{\\text{ext}} = \\frac{\\partial \\mathbf{f}_{\\text{ext}}}{\\partial \\mathbf{u}_2} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial u_x}  \\frac{\\partial f_1}{\\partial u_y} \\\\ \\frac{\\partial f_2}{\\partial u_x}  \\frac{\\partial f_2}{\\partial u_y} \\end{pmatrix} = \\begin{pmatrix} k_{11}  k_{12} \\\\ k_{21}  k_{22} \\end{pmatrix}\n$$\n为了计算 $\\mathbf{K}_{\\text{ext}}$ 的分量，我们需要 $R$ 对 $u_x$ 和 $u_y$ 的偏导数：\n$$\n\\frac{\\partial R}{\\partial u_x} = \\frac{\\partial}{\\partial u_x} \\left( (L+u_x)^2 + u_y^2 \\right)^{1/2} = \\frac{1}{2R} \\cdot 2(L+u_x) = \\frac{L+u_x}{R} = \\frac{x}{R}\n$$\n$$\n\\frac{\\partial R}{\\partial u_y} = \\frac{\\partial}{\\partial u_y} \\left( (L+u_x)^2 + u_y^2 \\right)^{1/2} = \\frac{1}{2R} \\cdot 2u_y = \\frac{u_y}{R} = \\frac{y}{R}\n$$\n\n现在我们可以计算非对角线分量 $k_{12}$ 和 $k_{21}$。\n\n分量 $k_{12} = \\frac{\\partial f_1}{\\partial u_y}$：\n$$\nf_1 = -P \\frac{u_y}{R} = -P \\frac{y}{R}\n$$\n使用商法则求导：\n$$\nk_{12} = \\frac{\\partial}{\\partial u_y} \\left( -P \\frac{y}{R} \\right) = -P \\left( \\frac{(\\frac{\\partial y}{\\partial u_y})R - y(\\frac{\\partial R}{\\partial u_y})}{R^2} \\right)\n$$\n因为 $y=u_y$，我们有 $\\frac{\\partial y}{\\partial u_y} = 1$。代入此式以及 $\\frac{\\partial R}{\\partial u_y} = \\frac{y}{R}$：\n$$\nk_{12} = -P \\left( \\frac{1 \\cdot R - y \\cdot \\frac{y}{R}}{R^2} \\right) = -P \\left( \\frac{R - \\frac{y^2}{R}}{R^2} \\right) = -P \\left( \\frac{R^2 - y^2}{R^3} \\right)\n$$\n因为 $R^2 = x^2 + y^2$，我们有 $R^2 - y^2 = x^2$。\n$$\nk_{12} = -P \\frac{x^2}{R^3} = -P \\frac{(L+u_x)^2}{\\left( (L+u_x)^2 + u_y^2 \\right)^{3/2}}\n$$\n\n分量 $k_{21} = \\frac{\\partial f_2}{\\partial u_x}$：\n$$\nf_2 = P \\frac{L+u_x}{R} = P \\frac{x}{R}\n$$\n使用商法则：\n$$\nk_{21} = \\frac{\\partial}{\\partial u_x} \\left( P \\frac{x}{R} \\right) = P \\left( \\frac{(\\frac{\\partial x}{\\partial u_x})R - x(\\frac{\\partial R}{\\partial u_x})}{R^2} \\right)\n$$\n因为 $x=L+u_x$，我们有 $\\frac{\\partial x}{\\partial u_x} = 1$。代入此式以及 $\\frac{\\partial R}{\\partial u_x} = \\frac{x}{R}$：\n$$\nk_{21} = P \\left( \\frac{1 \\cdot R - x \\cdot \\frac{x}{R}}{R^2} \\right) = P \\left( \\frac{R - \\frac{x^2}{R}}{R^2} \\right) = P \\left( \\frac{R^2 - x^2}{R^3} \\right)\n$$\n因为 $R^2 = x^2 + y^2$，我们有 $R^2 - x^2 = y^2$。\n$$\nk_{21} = P \\frac{y^2}{R^3} = P \\frac{u_y^2}{\\left( (L+u_x)^2 + u_y^2 \\right)^{3/2}}\n$$\n\n最后，我们计算差值 $k_{12} - k_{21}$：\n$$\nk_{12} - k_{21} = \\left( -P \\frac{x^2}{R^3} \\right) - \\left( P \\frac{y^2}{R^3} \\right) = -P \\frac{x^2 + y^2}{R^3}\n$$\n代入 $x^2 + y^2 = R^2$：\n$$\nk_{12} - k_{21} = -P \\frac{R^2}{R^3} = -\\frac{P}{R}\n$$\n将此结果用问题指定的变量 $P$、$L$、$u_x$ 和 $u_y$ 表示：\n$$\nk_{12} - k_{21} = -\\frac{P}{\\sqrt{(L+u_x)^2 + u_y^2}}\n$$\n该结果非零（因为 $P0$），证明了外部切线矩阵 $\\mathbf{K}_{\\text{ext}}$ 是不对称的，这是非保守随动荷载的一个关键特征。\n\n量纲检查证实了一致性。力 $P$ 的单位是力 [F]。长度 $R$（以及变量 $L$、$u_x$、$u_y$）的单位是长度 [L]。量 $k_{12} - k_{21}$ 的单位是刚度 [F/L]，这与 N/m 的单位一致。该表达式在量纲上是正确的。", "answer": "$$\n\\boxed{-\\frac{P}{\\sqrt{(L+u_x)^2 + u_y^2}}}\n$$", "id": "3591290"}]}