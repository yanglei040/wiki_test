{"hands_on_practices": [{"introduction": "在数值相对论中，任何稳定性分析的第一步都是从时空度规本身确定物理传播速度的上限。这个练习将指导你从3+1分解下的度规分量（即 Lapse 函数 $\\alpha$、Shift 矢量 $\\beta^i$ 和空间度规 $\\gamma_{ij}$）推导出坐标特征速度。掌握此方法后，你将能够构建一个实用的时间步长估算器，这是确保模拟稳定性的基石。[@problem_id:3487841]", "problem": "您的任务是设计并实现一个用于引力波和双黑洞并合的数值相对论模拟中的局部库朗-弗里德里希斯-列维 (CFL) 条件估计器，该估计器需要考虑时空曲率。该估计器必须基于一个双曲系统在局域标准正交四足基中的主符号来构建，然后映射到与数值网格相关的坐标速度。\n\n起点和要求：\n- 使用广义相对论的3+1分解，其中包含lapse函数 $\\alpha$、shift矢量 $\\beta^i$ 和空间度规 $\\gamma_{ij}$，这里 $i,j \\in \\{x,y,z\\}$。假设 $\\gamma_{ij}$ 是对称正定的，并且对于本问题，您可以限制为对角形式的 $\\gamma_{ij}$。\n- 使用一个无质量波状双曲系统的主符号，其特征面相对于时空度规是零性的。在一个局域标准正交四足基 $\\{e_0, e_a\\}$ 中（其中 $e_0$ 是类时的，$e_a$（$a \\in \\{1,2,3\\}$）是类空标准正交的），沿每个空间三足方向的特征速度为 $\\pm 1$（以光速等于1的单位制）。\n- 通过归一化坐标基矢量从空间度规 $\\gamma_{ij}$ 构建标准正交三足方向，使得每个三足矢量 $n^i$ 都满足 $\\gamma_{ij} n^i n^j = 1$。然后，从零性条件 $g_{\\mu\\nu} dx^{\\mu} dx^{\\nu} = 0$ 和3+1线元出发，通过投影这些零性方向来推导沿每个网格轴的坐标特征速度，其中要包括 $\\alpha$ 和 $\\beta^i$ 的影响。\n- 通过汇总每个网格轴上最大模的坐标速度，并将它们与网格间距 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 相结合，来定义与CFL条件相关的局域谱半径。使用适用于多空间维度中显式线方法积分器的加和形式。\n- 实现一个预测器，对于给定的候选时间步长 $\\Delta t$，如果该候选时间步长超过了您的CFL估计器给出的局域最大允许时间步长，则将该位置标记为“预测不稳定”。\n\n观测不稳定性模型：\n- 为了测试您的估计器的预测能力，通过计算方向库朗数之和 $\\sum_i \\lambda_i \\Delta t / \\Delta x_i$ 来定义一个“观测到的”不稳定性判据，其中使用您推导出的相同坐标特征速度 $\\lambda_i$。如果这个和超过 $1$，则标记为不稳定。这为显式格式中的不稳定性提供了一个简单的、局域的、基于模型的观测代理。\n- 使用国际单位制 (SI)。网格间距 $\\Delta x_i$ 以米表示，时间步长 $\\Delta t$ 以秒表示，速度以米/秒表示。使用光速 $c = 299,792,458\\,\\mathrm{m/s}$ 将无量纲特征速度（它们是 $c$ 的分数）转换为国际单位制速度。\n\n程序输入和输出：\n- 您的程序必须为以下包含五个不同局域状态的测试套件实现上述估计器和观测不稳定性模型。每个测试用例由 $\\alpha$、$\\beta^i$、对角 $\\gamma_{ii}$、以米为单位的网格间距 $(\\Delta x, \\Delta y, \\Delta z)$ 和以秒为单位的施加时间步长 $\\Delta t$ 指定：\n    1. 用例A（中等曲率，适度漂移）：$\\alpha = 0.7$，$\\beta^i = (0.05, 0.02, 0.0)$，$\\gamma_{ii} = (2.0736, 2.0736, 2.0736)$，$(\\Delta x, \\Delta y, \\Delta z) = (150, 150, 150)\\,\\mathrm{m}$，$\\Delta t = 3.0\\times 10^{-4}\\,\\mathrm{s}$。\n    2. 用例B（强曲率，类视界，轴向漂移）：$\\alpha = 0.2$，$\\beta^i = (0.05, 0.0, 0.0)$，$\\gamma_{ii} = (16.0, 16.0, 16.0)$，$(\\Delta x, \\Delta y, \\Delta z) = (100, 100, 100)\\,\\mathrm{m}$，$\\Delta t = 2.0\\times 10^{-4}\\,\\mathrm{s}$。\n    3. 用例C（各向异性度规和网格）：$\\alpha = 0.9$，$\\beta^i = (0.2, -0.1, 0.05)$，$\\gamma_{ii} = (1.5, 2.5, 3.5)$，$(\\Delta x, \\Delta y, \\Delta z) = (200, 100, 50)\\,\\mathrm{m}$，$\\Delta t = 4.0\\times 10^{-4}\\,\\mathrm{s}$。\n    4. 用例D（平直三足，零漂移，等式边界）：$\\alpha = 1.0$，$\\beta^i = (0.0, 0.0, 0.0)$，$\\gamma_{ii} = (1.0, 1.0, 1.0)$，$(\\Delta x, \\Delta y, \\Delta z) = (300, 300, 300)\\,\\mathrm{m}$，$\\Delta t = 3.338\\times 10^{-7}\\,\\mathrm{s}$。\n    5. 用例E（类并合核心，非平凡漂移）：$\\alpha = 0.5$，$\\beta^i = (0.1, 0.08, 0.0)$，$\\gamma_{ii} = (10.0, 10.0, 10.0)$，$(\\Delta x, \\Delta y, \\Delta z) = (75, 75, 150)\\,\\mathrm{m}$，$\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$。\n- 对每个用例，计算：\n    1. 根据您的局域CFL估计器计算出的预测最大稳定时间步长 $\\Delta t_{\\max}$（以秒为单位）。\n    2. 一个指示预测不稳定性的布尔值，定义为 $\\Delta t > \\Delta t_{\\max}$。\n    3. 一个指示观测到不稳定性的布尔值，由局域加和库朗判据 $\\sum_i \\lambda_i \\Delta t / \\Delta x_i > 1$ 定义，其中 $\\lambda_i$ 是沿各轴的坐标特征速度（单位为米/秒）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须是扁平的，并按顺序包含五个用例的结果：用例A的 $\\Delta t_{\\max}$（浮点数，单位为秒）、用例A的预测不稳定性（布尔值）、用例A的观测不稳定性（布尔值），然后是用例B、用例C、用例D和用例E的相同三元组。例如，输出应如下所示\n$[\\Delta t_{\\max,A},\\mathrm{predA},\\mathrm{obsA},\\Delta t_{\\max,B},\\mathrm{predB},\\mathrm{obsB},\\ldots]$。\n\n注释：\n- 此问题不涉及角度；不需要特殊的角度单位。\n- 所有速度必须一致处理：四足特征速度以光速为单位是 $\\pm 1$，坐标速度在与以米为单位的网格间距结合前，必须使用 $c$ 转换为米/秒。\n- 通过遵守 $\\alpha^2 \\ge \\beta_{\\perp}^2$ 的要求来确保科学真实性，从而使时间坐标保持类时性。所提供的测试套件满足此条件。", "solution": "用户提供的问题经评估有效。它在科学上基于数值相对论的既定原理和时空的3+1分解。该问题是适定的，提供了推导唯一、确定性解所需的一套完整且一致的数据和定义。其语言客观且正式。该任务是在广义相对论背景下推导和应用库朗-弗里德里希斯-列维 (CFL) 稳定性条件的一个标准但并非不重要的练习。\n\n求解过程首先从时空度规推导坐标特征速度，然后利用这些速度构建对时间步长的CFL限制。\n\n**1. 坐标特征速度的推导**\n\n在广义相对论中，确定波状系统特征速度的基本原理是信息沿时空度规 $g_{\\mu\\nu}$ 的零性测地线传播。零性路径由条件 $ds^2 = g_{\\mu\\nu} dx^\\mu dx^\\nu = 0$ 定义。\n\n问题指定使用Arnowitt-Deser-Misner (ADM) 或 3+1 形式体系，其中时空线元 $ds^2$ 分解为：\n$$ds^2 = -\\alpha^2 dt^2 + \\gamma_{ij} (dx^i - \\beta^i dt)(dx^j - \\beta^j dt)$$\n此处，$\\alpha$ 是lapse函数，$\\beta^i$ 是shift矢量，$\\gamma_{ij}$ 是给定时间切片上的三维空间度规。指标 $i, j$ 的取值范围为1到3（或 $x, y, z$）。\n\n为求出光信号的坐标速度 $v^i = dx^i/dt$，我们令 $ds^2=0$ 并除以 $dt^2$：\n$$-\\alpha^2 + \\gamma_{ij} \\left(\\frac{dx^i}{dt} - \\beta^i\\right)\\left(\\frac{dx^j}{dt} - \\beta^j\\right) = 0$$\n代入 $v^i = dx^i/dt$，我们得到坐标速度空间中未来光锥边界的方程：\n$$\\gamma_{ij} (v^i - \\beta^i)(v^j - \\beta^j) = \\alpha^2$$\n该方程描述了 $v^i$ 速度空间中的一个椭球体。为了确定CFL条件，我们需要沿每个网格轴的最大可能坐标速度。让我们找出沿 $x$-轴的最大速度，记为 $\\lambda_x$。这对应于在椭球体约束下求 $v^x$ 的最大值。\n\n令 $w^i = v^i - \\beta^i$。约束变为 $\\gamma_{ij} w^i w^j = \\alpha^2$。我们想求 $v^x = w^x + \\beta^x$ 的极值。这等价于求 $w^x$ 的极值。由于问题指出 $\\gamma_{ij}$ 是对角的，我们可以写出 $\\gamma_{ij} = \\text{diag}(\\gamma_{xx}, \\gamma_{yy}, \\gamma_{zz})$。约束方程简化为：\n$$\\gamma_{xx} (w^x)^2 + \\gamma_{yy} (w^y)^2 + \\gamma_{zz} (w^z)^2 = \\alpha^2$$\n为求 $w^x$ 的最大值和最小值，我们令 $w^y = 0$ 和 $w^z = 0$。这得到：\n$$\\gamma_{xx} (w^x)^2 = \\alpha^2 \\implies w^x = \\pm \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\n因此，坐标速度 $v^x$ 的极值为：\n$$v^x_{\\pm} = \\beta^x + w^x = \\beta^x \\pm \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\n与CFL条件相关的特征速度是具有最大模的速度。它由以下公式给出：\n$$\\lambda_x = \\max(|v^x_+|, |v^x_-|) = \\max\\left(\\left|\\beta^x + \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}\\right|, \\left|\\beta^x - \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}\\right|\\right)$$\n由于 $\\alpha>0$ 且 $\\sqrt{\\gamma_{xx}}>0$，这可以简化为：\n$$\\lambda_x = |\\beta^x| + \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\n以此类推，沿 $y$ 轴和 $z$ 轴的最大模特征速度为：\n$$\\lambda_y = |\\beta^y| + \\frac{\\alpha}{\\sqrt{\\gamma_{yy}}}$$\n$$\\lambda_z = |\\beta^z| + \\frac{\\alpha}{\\sqrt{\\gamma_{zz}}}$$\n这些速度 $\\lambda_i$ 是无量纲的，以光速 $c$ 为单位表示。为了将它们转换为国际单位制（m/s），我们乘以 $c = 299792458 \\, \\mathrm{m/s}$。令 $\\lambda_{i, \\text{SI}} = c \\cdot \\lambda_i$。\n\n**2. CFL条件和不稳定性判据**\n\n对于使用显式线方法格式求解的多维双曲系统，CFL稳定性条件的一种常见形式是加和形式。方向库朗数之和必须小于或等于一个常数 $C_{\\text{CFL}}$，其量级为1。问题指定了一个对应于 $C_{\\text{CFL}} = 1$ 的稳定性极限。该条件是：\n$$\\Delta t \\left( \\frac{\\lambda_{x, \\text{SI}}}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}}}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}}}{\\Delta z} \\right) \\le 1$$\n其中 $\\Delta x, \\Delta y, \\Delta z$ 是以米为单位的网格间距。\n\n从这个不等式，我们可以确定最大稳定时间步长 $\\Delta t_{\\max}$：\n$$\\Delta t_{\\max} = \\left( \\frac{\\lambda_{x, \\text{SI}}}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}}}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}}}{\\Delta z} \\right)^{-1}$$\n代入 $\\lambda_{i, \\text{SI}}$ 的表达式：\n$$\\Delta t_{\\max} = \\left[ c \\left( \\frac{|\\beta^x| + \\alpha/\\sqrt{\\gamma_{xx}}}{\\Delta x} + \\frac{|\\beta^y| + \\alpha/\\sqrt{\\gamma_{yy}}}{\\Delta y} + \\frac{|\\beta^z| + \\alpha/\\sqrt{\\gamma_{zz}}}{\\Delta z} \\right) \\right]^{-1}$$\n\n问题为给定的试验时间步长 $\\Delta t$ 定义了两个不稳定性判据：\n1.  **预测不稳定性**：这是一个布尔标志，如果给定的时间步长 $\\Delta t$ 超过计算出的最大允许时间步长 $\\Delta t_{\\max}$，则为真。\n    $$\\text{Predicted Instability} = (\\Delta t > \\Delta t_{\\max})$$\n2.  **观测不稳定性**：这是一个布尔标志，如果方向库朗数之和超过1，则为真。\n    $$\\text{Observed Instability} = \\left( \\frac{\\lambda_{x, \\text{SI}} \\Delta t}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}} \\Delta t}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}} \\Delta t}{\\Delta z} > 1 \\right)$$\n通过代数重排可以清楚地看出，这两个条件在逻辑上是等价的。如果 $\\sum_i (\\lambda_{i, \\text{SI}} \\Delta t / \\Delta x_i) > 1$，那么 $\\Delta t > (\\sum_i \\lambda_{i, \\text{SI}} / \\Delta x_i)^{-1}$，这与 $\\Delta t > \\Delta t_{\\max}$ 是相同的。\n\n**3. 算法实现**\n\n对每个提供的测试用例，执行以下计算步骤：\n1.  提取局域度规分量 $\\alpha$、$\\beta^i = (\\beta^x, \\beta^y, \\beta^z)$ 和对角 $\\gamma_{ii} = (\\gamma_{xx}, \\gamma_{yy}, \\gamma_{zz})$，以及网格间距 $(\\Delta x, \\Delta y, \\Delta z)$ 和试验时间步长 $\\Delta t$。\n2.  使用推导出的公式计算无量纲特征速度 $\\lambda_x, \\lambda_y, \\lambda_z$。\n3.  计算 $\\Delta t_{\\max}$ 表达式的分母，即CFL时间尺度倒数之和：$S = c \\left( \\frac{\\lambda_x}{\\Delta x} + \\frac{\\lambda_y}{\\Delta y} + \\frac{\\lambda_z}{\\Delta z} \\right)$。\n4.  计算最大稳定时间步长：$\\Delta t_{\\max} = 1/S$。\n5.  评估预测不稳定性：比较 $\\Delta t > \\Delta t_{\\max}$ 得到的布尔值结果。\n6.  评估观测不稳定性：比较 $\\Delta t \\cdot S > 1$ 得到的布尔值结果。\n7.  收集每个用例的三元组结果（$\\Delta t_{\\max}$，预测不稳定性，观测不稳定性）。\n8.  将所有结果格式化为单个扁平列表以供最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a local CFL estimator for numerical relativity simulations,\n    evaluates it for several test cases, and predicts stability.\n    \"\"\"\n    # Define physical constants and test cases as per the problem statement.\n    C_LIGHT = 299792458.0  # Speed of light in m/s\n\n    test_cases = [\n        # Case A (moderate curvature, modest shift)\n        {\n            \"name\": \"A\",\n            \"alpha\": 0.7,\n            \"beta\": np.array([0.05, 0.02, 0.0]),\n            \"gamma_ii\": np.array([2.0736, 2.0736, 2.0736]),\n            \"delta_x\": np.array([150.0, 150.0, 150.0]),\n            \"delta_t\": 3.0e-4,\n        },\n        # Case B (strong curvature, near-horizon-like, axial shift)\n        {\n            \"name\": \"B\",\n            \"alpha\": 0.2,\n            \"beta\": np.array([0.05, 0.0, 0.0]),\n            \"gamma_ii\": np.array([16.0, 16.0, 16.0]),\n            \"delta_x\": np.array([100.0, 100.0, 100.0]),\n            \"delta_t\": 2.0e-4,\n        },\n        # Case C (anisotropic metric and grid)\n        {\n            \"name\": \"C\",\n            \"alpha\": 0.9,\n            \"beta\": np.array([0.2, -0.1, 0.05]),\n            \"gamma_ii\": np.array([1.5, 2.5, 3.5]),\n            \"delta_x\": np.array([200.0, 100.0, 50.0]),\n            \"delta_t\": 4.0e-4,\n        },\n        # Case D (flat triad, zero shift, equality edge)\n        {\n            \"name\": \"D\",\n            \"alpha\": 1.0,\n            \"beta\": np.array([0.0, 0.0, 0.0]),\n            \"gamma_ii\": np.array([1.0, 1.0, 1.0]),\n            \"delta_x\": np.array([300.0, 300.0, 300.0]),\n            \"delta_t\": 3.338e-7,\n        },\n        # Case E (merger-core-like, nontrivial shift)\n        {\n            \"name\": \"E\",\n            \"alpha\": 0.5,\n            \"beta\": np.array([0.1, 0.08, 0.0]),\n            \"gamma_ii\": np.array([10.0, 10.0, 10.0]),\n            \"delta_x\": np.array([75.0, 75.0, 150.0]),\n            \"delta_t\": 1.0e-4,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        beta = case[\"beta\"]\n        gamma_ii = case[\"gamma_ii\"]\n        delta_x = case[\"delta_x\"]\n        delta_t = case[\"delta_t\"]\n\n        # 1. Derive the largest-magnitude coordinate characteristic speeds.\n        # These speeds are dimensionless (in units of c).\n        # The formula is lambda_i = |beta^i| + alpha / sqrt(gamma_ii).\n        sqrt_gamma_ii = np.sqrt(gamma_ii)\n        lambda_dimless = np.abs(beta) + alpha / sqrt_gamma_ii\n\n        # 2. Formulate the CFL condition to find the maximum stable timestep.\n        # The additive form is dt * sum(lambda_i_SI / dx_i) = 1.\n        # lambda_i_SI are the speeds in SI units (m/s).\n        lambda_si = C_LIGHT * lambda_dimless\n        \n        # This is the sum term S = sum(lambda_i_SI / dx_i), with units of 1/s.\n        cfl_sum_term = np.sum(lambda_si / delta_x)\n\n        # The maximum stable timestep is dt_max = 1 / S.\n        delta_t_max = 1.0 / cfl_sum_term\n\n        # 3. Evaluate the instability criteria for the given trial step delta_t.\n        \n        # Predicted instability: True if delta_t  delta_t_max.\n        predicted_instability = delta_t  delta_t_max\n\n        # Observed instability: True if sum of Courant numbers  1.\n        # This is equivalent to sum(lambda_i * dt / dx_i)  1,\n        # or dt * sum(lambda_i / dx_i)  1, which is dt * cfl_sum_term  1.\n        observed_instability = (delta_t * cfl_sum_term)  1.0\n        \n        all_results.extend([delta_t_max, predicted_instability, observed_instability])\n\n    # Final print statement in the exact required format.\n    # The format string converts floats and booleans to their string representations.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3487841"}, {"introduction": "确定了物理速度限制后，下一步是选择一个既稳定又高效的数值格式。本练习探讨了强稳定性保持（Strong Stability Preserving, SSP）龙格-库塔（Runge-Kutta）时间积分方法，该方法在保持单调性等关键性质的同时，允许比简单方法大得多的时间步长。你将学习如何通过分析其 Shu-Osher 形式来找到 SSP 系数，这是最大化计算效率的关键。[@problem_id:3487852]", "problem": "在数值相对论中，规范驱动通常包含沿移位矢量的平流，我们通过一个规范变量 $g(x,t)$ 的线性平流模型将其在一维空间中理想化，\n$$\n\\partial_{t} g + \\beta\\, \\partial_{x} g = 0,\n$$\n其中 $\\beta$ 是（可能很大的）移位速度。考虑一个间距为 $h>0$ 的均匀网格和一种单调一阶迎风空间离散格式，该格式保证了只要时间步长 $\\Delta t$ 满足以下条件，前向欧拉法就具有单调性：\n$$\n\\Delta t \\le \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}.\n$$\n我们将以 Shu–Osher 形式写出的显式强保稳龙格-库塔 (SSPRK) 格式应用于由平流方程空间离散得到的半离散常微分方程 $\\dot{u} = L(u)$。如果一个 SSPRK 方法可以表示为前向欧拉步的凸组合，则称该方法在前向欧拉法所对应的凸泛函下单调性得以保持；在这种情况下，存在一个强保稳系数 $c_{\\mathrm{SSP}}0$，使得只要满足以下条件，该龙格-库塔方法就保持单调性：\n$$\n\\Delta t \\le c_{\\mathrm{SSP}}\\, \\Delta t_{\\mathrm{FE}}.\n$$\n假设计算预算允许每个时间步最多有四个阶段。考虑以下 Shu–Osher 形式的 SSPRK 格式：\n1. 两阶段、二阶格式 $\\mathrm{SSPRK}(2,2)$:\n$$\n\\begin{aligned}\nu^{(1)} = u^{n} + \\Delta t\\, L\\!\\left(u^{n}\\right), \\\\\nu^{n+1} = \\frac{1}{2}\\, u^{n} + \\frac{1}{2}\\left[ u^{(1)} + \\Delta t\\, L\\!\\left(u^{(1)}\\right) \\right].\n\\end{aligned}\n$$\n2. 三阶段、三阶格式 $\\mathrm{SSPRK}(3,3)$:\n$$\n\\begin{aligned}\nu^{(1)} = u^{n} + \\Delta t\\, L\\!\\left(u^{n}\\right), \\\\\nu^{(2)} = \\frac{3}{4}\\, u^{n} + \\frac{1}{4}\\left[ u^{(1)} + \\Delta t\\, L\\!\\left(u^{(1)}\\right) \\right], \\\\\nu^{n+1} = \\frac{1}{3}\\, u^{n} + \\frac{2}{3}\\left[ u^{(2)} + \\Delta t\\, L\\!\\left(u^{(2)}\\right) \\right].\n\\end{aligned}\n$$\n3. 一个四阶段、三阶格式 $\\mathrm{SSPRK}(4,3)$:\n$$\n\\begin{aligned}\nu^{(1)} = u^{n} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{n}\\right), \\\\\nu^{(2)} = u^{(1)} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{(1)}\\right), \\\\\nu^{(3)} = \\frac{2}{3}\\, u^{n} + \\frac{1}{3}\\left[ u^{(2)} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{(2)}\\right) \\right], \\\\\nu^{n+1} = u^{(3)} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{(3)}\\right).\n\\end{aligned}\n$$\n从强保稳时间步进法作为前向欧拉步凸组合的定义出发，通过识别 Shu–Osher 分解中出现的最大的前向欧拉子步长（作为 $\\Delta t$ 的一部分），确定上述每种格式的强保稳系数 $c_{\\mathrm{SSP}}$。然后，在每个时间步最多四个阶段的限制下，选择能使允许的单调时间步长最大化的格式阶数，并计算对应的平流主导的规范方程的 Courant–Friedrichs–Lewy 时间步长限制 $\\Delta t_{\\max}$。将您的最终答案表示为关于 $h$ 和 $\\beta$ 的单个解析表达式。不需要进行数值舍入。", "solution": "用户提供了一个问题陈述，在尝试解决之前需要进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：规范变量 $g(x,t)$ 的线性平流模型由 $\\partial_{t} g + \\beta\\, \\partial_{x} g = 0$ 给出，其中 $\\beta$ 是移位速度。\n- **离散化**：使用间距为 $h>0$ 的均匀网格和单调一阶迎风空间离散，得到半离散常微分方程（ODE）系统 $\\dot{u} = L(u)$。\n- **前向欧拉（FE）单调性条件**：只要时间步长 $\\Delta t$ 满足 $\\Delta t \\le \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$，前向欧拉法就是单调的。\n- **强保稳（SSP）条件**：如果一个显式 SSP 龙格-库塔（SSPRK）方法可以表示为前向欧拉步的凸组合，则该方法保持单调性。对于一个 SSP 系数为 $c_{\\mathrm{SSP}}0$ 的 SSPRK 方法，当时间步长 $\\Delta t$ 满足 $\\Delta t \\le c_{\\mathrm{SSP}}\\, \\Delta t_{\\mathrm{FE}}$ 时，单调性成立。\n- **计算约束**：计算预算允许每个时间步最多四个阶段。\n- **SSPRK 格式（Shu-Osher 形式）**：\n    1.  **SSPRK(2,2)**（两阶段、二阶）：\n        $$\n        \\begin{aligned}\n        u^{(1)} = u^{n} + \\Delta t\\, L(u^{n}), \\\\\n        u^{n+1} = \\frac{1}{2}\\, u^{n} + \\frac{1}{2}\\left[ u^{(1)} + \\Delta t\\, L(u^{(1)}) \\right].\n        \\end{aligned}\n        $$\n    2.  **SSPRK(3,3)**（三阶段、三阶）：\n        $$\n        \\begin{aligned}\n        u^{(1)} = u^{n} + \\Delta t\\, L(u^{n}), \\\\\n        u^{(2)} = \\frac{3}{4}\\, u^{n} + \\frac{1}{4}\\left[ u^{(1)} + \\Delta t\\, L(u^{(1)}) \\right], \\\\\n        u^{n+1} = \\frac{1}{3}\\, u^{n} + \\frac{2}{3}\\left[ u^{(2)} + \\Delta t\\, L(u^{(2)}) \\right].\n        \\end{aligned}\n        $$\n    3.  **SSPRK(4,3)**（四阶段、三阶）：\n        $$\n        \\begin{aligned}\n        u^{(1)} = u^{n} + \\frac{1}{2}\\, \\Delta t\\, L(u^{n}), \\\\\n        u^{(2)} = u^{(1)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(1)}), \\\\\n        u^{(3)} = \\frac{2}{3}\\, u^{n} + \\frac{1}{3}\\left[ u^{(2)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(2)}) \\right], \\\\\n        u^{n+1} = u^{(3)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(3)}).\n        \\end{aligned}\n        $$\n- **任务**：\n    1.  确定每种格式的 SSP 系数 $c_{\\mathrm{SSP}}$。\n    2.  选择能使允许的单调时间步长最大化的格式阶数。\n    3.  计算相应的最大时间步长限制 $\\Delta t_{\\max}$，用 $h$ 和 $\\beta$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题经过了严格的验证程序。\n- **科学依据**：该问题基于偏微分方程数值分析中的既定概念，特别是应用于双曲守恒律的强保稳（SSP）时间步进法理论。所提出的格式是标准的，并且在科学文献中有详细记载。数值相对论和规范驱动的背景是恰当和现实的。该问题是科学上合理的。\n- **适定性**：该问题结构清晰。提供了格式的定义，并描述了确定 SSP 系数的方法。目标明确：计算系数并执行约束优化。存在唯一解。\n- **客观性**：该问题以精确的数学语言陈述，没有主观性或偏见。\n- **不完整或矛盾的设置**：该问题是自洽的。提供了所有必要的方程、定义和约束。不存在矛盾。\n- **其他缺陷**：该问题并非无关紧要、比喻性的或超出科学验证的范围。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供一个完整、合理的解答。\n\n### 解答\n该问题要求我们确定三种给定的龙格-库塔格式的强保稳（SSP）系数 $c_{\\mathrm{SSP}}$，然后找出其中允许的最大时间步长。\n\n一个以 Shu-Osher 形式写出的 SSPRK 方法，可以解释为前向欧拉（FE）算子的凸组合。算子 $\\mathcal{F}(\\delta t) v = v + \\delta t L(v)$ 表示步长为 $\\delta t$ 的一个前向欧拉步。对于用单调格式离散化的线性平流方程，只要 $\\delta t \\le \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$，该算子就保持单调性。\n\nSSPRK 格式的 Shu-Osher 形式包含形如 $u^{(k)} + \\gamma_i \\Delta t L(u^{(k)})$ 的项，这对应于一个有效步长为 $\\delta t_i = \\gamma_i \\Delta t$ 的前向欧拉步。为了使整个 SSPRK 格式保持单调性，其中的每一个前向欧拉子步都必须是单调的。这对格式定义中出现的所有分数系数 $\\gamma_i$ 施加了条件 $\\gamma_i \\Delta t \\le \\Delta t_{\\mathrm{FE}}$。\n\n这导致了 SSPRK 方法的全局时间步长限制：\n$$\n\\Delta t \\max_i(\\gamma_i) \\le \\Delta t_{\\mathrm{FE}} \\implies \\Delta t \\le \\frac{1}{\\max_i(\\gamma_i)} \\Delta t_{\\mathrm{FE}}\n$$\n通过将其与给定定义 $\\Delta t \\le c_{\\mathrm{SSP}} \\Delta t_{\\mathrm{FE}}$ 进行比较，我们确定 SSP 系数为：\n$$\nc_{\\mathrm{SSP}} = \\frac{1}{\\max_i(\\gamma_i)}\n$$\n其中 $\\max_i(\\gamma_i)$ 是格式的 Shu-Osher 分解中乘以 $\\Delta t L(\\cdot)$ 的最大分数系数。我们现在分析每种格式以找到这个值。\n\n**1. SSPRK(2,2) 格式：**\n该格式为：\n$$\n\\begin{aligned}\nu^{(1)} = u^{n} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{n}) \\\\\nu^{n+1} = \\frac{1}{2}\\, u^{n} + \\frac{1}{2}\\left[ u^{(1)} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{(1)}) \\right]\n\\end{aligned}\n$$\n$\\Delta t L(\\cdot)$ 的分数系数在第一阶段为 $\\gamma_1 = 1$，在第二阶段为 $\\gamma_2 = 1$。\n最大分数系数是 $\\max(\\gamma_i) = 1$。\nSSP 系数是 $c_{\\mathrm{SSP}} = \\frac{1}{1} = 1$。\n时间步长限制为 $\\Delta t \\le 1 \\cdot \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$。\n\n**2. SSPRK(3,3) 格式：**\n该格式为：\n$$\n\\begin{aligned}\nu^{(1)} = u^{n} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{n}) \\\\\nu^{(2)} = \\frac{3}{4}\\, u^{n} + \\frac{1}{4}\\left[ u^{(1)} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{(1)}) \\right] \\\\\nu^{n+1} = \\frac{1}{3}\\, u^{n} + \\frac{2}{3}\\left[ u^{(2)} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{(2)}) \\right]\n\\end{aligned}\n$$\n$\\Delta t L(\\cdot)$ 的分数系数为 $\\gamma_1 = 1$、$\\gamma_2 = 1$ 和 $\\gamma_3 = 1$。\n最大分数系数是 $\\max(\\gamma_i) = 1$。\nSSP 系数是 $c_{\\mathrm{SSP}} = \\frac{1}{1} = 1$。\n时间步长限制为 $\\Delta t \\le 1 \\cdot \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$。\n\n**3. SSPRK(4,3) 格式：**\n该格式为：\n$$\n\\begin{aligned}\nu^{(1)} = u^{n} + \\frac{1}{2}\\, \\Delta t\\, L(u^{n}) \\\\\nu^{(2)} = u^{(1)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(1)}) \\\\\nu^{(3)} = \\frac{2}{3}\\, u^{n} + \\frac{1}{3}\\left[ u^{(2)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(2)}) \\right] \\\\\nu^{n+1} = u^{(3)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(3)})\n\\end{aligned}\n$$\n$\\Delta t L(\\cdot)$ 的分数系数为 $\\gamma_1 = 1/2$、$\\gamma_2 = 1/2$、$\\gamma_3 = 1/2$ 和 $\\gamma_4 = 1/2$。\n最大分数系数是 $\\max(\\gamma_i) = \\frac{1}{2}$。\nSSP 系数是 $c_{\\mathrm{SSP}} = \\frac{1}{1/2} = 2$。\n时间步长限制为 $\\Delta t \\le 2 \\cdot \\Delta t_{\\mathrm{FE}} = 2 \\frac{h}{|\\beta|}$。\n\n**比较与优化：**\n题目要求我们在最多使用四个阶段的约束下，选择能使允许的单调时间步长最大化的格式阶数。所提供的格式满足此约束。\n\n我们来总结一下每种格式允许的最大时间步长：\n- **SSPRK(2,2)**（二阶，2 阶段）：$\\Delta t \\le \\frac{h}{|\\beta|}$\n- **SSPRK(3,3)**（三阶，3 阶段）：$\\Delta t \\le \\frac{h}{|\\beta|}$\n- **SSPRK(4,3)**（三阶，4 阶段）：$\\Delta t \\le 2\\frac{h}{|\\beta|}$\n\n根据所提供的格式，比较每个阶数允许的最大时间步长：\n- 对于二阶，最大时间步长为 $\\frac{h}{|\\beta|}$（来自 SSPRK(2,2)）。\n- 对于三阶，最大时间步长为 $2\\frac{h}{|\\beta|}$（来自 SSPRK(4,3)）。\n\n三阶格式允许比二阶格式更大的时间步长。具体来说，SSPRK(4,3) 格式提供了所有选项中最大的时间步长。因此，在给定条件下，允许的最大单调时间步长 $\\Delta t_{\\max}$ 由 SSPRK(4,3) 格式确定。\n\n对应的 Courant-Friedrichs-Lewy (CFL) 时间步长限制是：\n$$\n\\Delta t_{\\max} = 2 \\cdot \\Delta t_{\\mathrm{FE}} = 2 \\frac{h}{|\\beta|}\n$$", "answer": "$$\n\\boxed{2 \\frac{h}{|\\beta|}}\n$$", "id": "3487852"}, {"introduction": "数值相对论中的真实模拟本质上是非线性的，这为稳定性分析带来了新的挑战。最后的这个练习将引导你超越传统的基于速度的CFL条件，考虑一个更精细的稳定性概念。你将实现一个“非线性CFL”阈值，该阈值同时考虑了激波形成时间，从而揭示数值稳定性与物理现象解析度之间的深刻联系。[@problem_id:3487869]", "problem": "考虑一个用于数值相对论中的非线性规范波测试的一维代理模型，该模型由一个标量一阶非线性双曲偏微分方程描述：\n$$\n\\partial_t u + a(u)\\,\\partial_x u = 0, \\quad a(u) = c_0\\left(1 + \\beta u^2\\right),\n$$\n其中 $u=u(x,t)$ 是一个无量纲的规范波振幅，$x$ 是位置（单位：米），$t$ 是时间（单位：秒），$c_0$ 是一个恒定的特征速度（单位：米/秒），$\\beta$ 是一个无量纲的非线性参数。假设初始数据形式为\n$$\nu(x,0) = A \\sin(k x),\n$$\n其中振幅 $A$（无量纲），波数 $k$ 的单位为弧度/米。角度必须以弧度为单位进行处理。\n\n您需要为一个通过时间上的前向欧拉法推进的显式、单调有限体积方法估计一个“非线性Courant-Friedrichs-Lewy (CFL) 阈值”。该方法旨在捕捉类平流行为。显式时间步长 $\\Delta t$ 必须同时满足：(i) 一个基于最大特征速度推导出的、与速度相关的CFL界限，以及 (ii) 一个依赖于振幅的界限，该界限确保陡峭化和激波的形成被延迟到一个选定的最小步数之后，以便让数值耗散发挥作用。您必须将此估计与一个使用线性特征速度的线性化CFL预测进行对比。\n\n使用以下基本且经过充分检验的事实：\n\n- 对于具有非线性速度 $a(u)$ 的守恒律类型平流，特征线满足 $\\frac{dx}{dt}=a(u)$，且斜率 $w=\\partial_x u$（对于光滑解）根据以下方程演化：\n$$\n\\frac{d}{dt} w = -a'(u)\\, w^2,\n$$\n其中 $a'(u) = \\frac{d}{du}a(u)$。\n- 如果 $u(x,0)=A\\sin(kx)$ 且 $a'(u)\\neq 0$，则梯度爆炸（激波形成）的最早时间为\n$$\nt_s = \\frac{1}{\\max_x\\left(a'(u(x,0))\\,|\\partial_x u(x,0)|\\right)}.\n$$\n- 对于非线性速度 $a(u)=c_0(1+\\beta u^2)$ 和初始条件 $u(x,0)=A\\sin(kx)$，我们有 $a'(u)=2c_0\\beta u$ 和 $\\partial_x u(x,0)=Ak\\cos(kx)$，这得出\n$$\nt_s = \\frac{1}{c_0\\,\\beta\\,A^2\\,k}.\n$$\n- 对于一个安全因子为 $\\nu\\in(0,1]$ 的显式单调方法，其基于速度的CFL界限为\n$$\n\\Delta t_{\\text{speed}} = \\nu \\frac{\\Delta x}{a_{\\max}}, \\quad a_{\\max} = \\max_x |a(u(x,0))| = c_0\\left(1+\\beta A^2\\right),\n$$\n其中 $\\Delta x$ 是网格间距，单位为米。\n- 线性化CFL预测（忽略依赖于振幅的速度）为\n$$\n\\Delta t_{\\text{lin}} = \\nu \\frac{\\Delta x}{c_0}.\n$$\n\n将非线性CFL阈值定义为\n$$\n\\Delta t_{\\text{nl}} = \\min\\left(\\Delta t_{\\text{speed}},\\, \\frac{t_s}{M}\\right),\n$$\n其中 $M$ 是一个选定的正整数，代表在达到解析陡峭化时间 $t_s$ 之前所需的最小显式时间步数，从而体现了延迟激波形成以允许数值耗散发挥作用的实际要求。如果 $\\beta=0$，则将 $t_s$ 视为 $+\\infty$，因此 $\\Delta t_{\\text{nl}}=\\Delta t_{\\text{speed}}$。\n\n您的任务是编写一个程序，为每个测试用例计算并返回数对 $[\\Delta t_{\\text{nl}},\\,\\Delta t_{\\text{lin}}]$，两者均以秒为单位表示。角度必须以弧度处理，并且所有物理单位必须保持一致：$c_0$ 的单位是米/秒，$\\Delta x$ 的单位是米， $k$ 的单位是弧度/米。使用 $k = 2\\pi/L$，其中 $L$ 是波长，单位为米。\n\n测试套件参数集：\n- 案例1（具有中等非线性度的通用“理想路径”）：$c_0 = 2.99792458\\times 10^8$ 米/秒，$\\Delta x = 1000$ 米，$\\beta = 0.1$，$A = 0.5$，$L = 1.0\\times 10^6$ 米，$\\nu = 0.9$，$M = 50$。\n- 案例2（边界条件，线性化极限）：$c_0 = 2.99792458\\times 10^8$ 米/秒，$\\Delta x = 500$ 米，$\\beta = 0.0$，$A = 0.8$，$L = 1.0\\times 10^5$ 米，$\\nu = 1.0$，$M = 20$。\n- 案例3（边缘案例，强非线性，激波时间界限占主导）：$c_0 = 3.0\\times 10^8$ 米/秒，$\\Delta x = 100$ 米，$\\beta = 1.0$，$A = 1.0$，$L = 1.0\\times 10^4$ 米，$\\nu = 0.8$，$M = 100$。\n- 案例4（边缘案例，细网格，基于速度的界限占主导）：$c_0 = 2.99792458\\times 10^8$ 米/秒，$\\Delta x = 1$ 米，$\\beta = 0.5$，$A = 0.9$，$L = 1.0\\times 10^5$ 米，$\\nu = 0.95$，$M = 200$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的Python风格列表的列表形式的结果，每个内部列表包含两个浮点数 $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$（单位为秒），并按测试套件案例的顺序排列（例如，$[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$）。", "solution": "问题陈述已经过验证，被认为是合理、自洽且适定的。任务是为一个用于数值相对论的规范波方程简化模型计算两种类型的时间步长阈值：一个线性化阈值和一个非线性阈值。该计算将针对四个不同的参数集执行。\n\n问题的核心涉及应用指定的 Courant-Friedrichs-Lewy (CFL) 条件公式，这是双曲偏微分方程显式时间积分格式稳定性的一个必要条件。问题引入了一个“非线性CFL阈值” $\\Delta t_{\\text{nl}}$，它创新地将标准的基于速度的CFL限制与一个和激波形成时间 $t_s$ 相关的启发式约束相结合。这捕捉到了解析高速波传播和管理由非线性陡峭化引起的不连续点（激波）形成这两方面的双重数值挑战。\n\n为每个测试用例计算所需值 $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$ 的流程如下。\n\n首先，我们为给定案例定义物理和数值参数：特征速度 $c_0$、网格间距 $\\Delta x$、非线性参数 $\\beta$、初始振幅 $A$、波长 $L$、CFL安全因子 $\\nu$ 以及激波延迟步数 $M$。\n\n波数 $k$ 是根据波长 $L$ 通过标准关系推导出来的：\n$$\nk = \\frac{2\\pi}{L}\n$$\n\n接下来，我们计算线性化的CFL时间步长 $\\Delta t_{\\text{lin}}$。该值基于波速恒定且等于 $c_0$ 的假设，忽略了任何非线性的、依赖于振幅的效应。它是一个用于比较的基线。公式如下：\n$$\n\\Delta t_{\\text{lin}} = \\nu \\frac{\\Delta x}{c_0}\n$$\n此处，$\\Delta x / c_0$ 表示速度为 $c_0$ 的波穿过一个网格单元所需的时间，而 $\\nu \\in (0, 1]$ 是一个安全因子。\n\n然后，我们计算非线性CFL阈值 $\\Delta t_{\\text{nl}}$ 所需的组成部分。该阈值必须满足两个独立的约束。\n\n第一个约束是基于速度的CFL条件 $\\Delta t_{\\text{speed}}$。该条件考虑了局部波速 $a(u) = c_0(1 + \\beta u^2)$ 依赖于波振幅 $u$ 这一事实。为保证稳定性，时间步长必须受定义域内可能出现的最大波速 $a_{\\max}$ 的限制。对于初始条件 $u(x,0) = A \\sin(kx)$，最大振幅为 $A$，因此最大速度为：\n$$\na_{\\max} = \\max_x |a(u(x,0))| = c_0\\left(1+\\beta A^2\\right)\n$$\n相应的基于速度的时间步长限制是：\n$$\n\\Delta t_{\\text{speed}} = \\nu \\frac{\\Delta x}{a_{\\max}} = \\nu \\frac{\\Delta x}{c_0\\left(1+\\beta A^2\\right)}\n$$\n\n第二个约束与非线性波的陡峭化有关。非线性双曲方程的一个关键特征是，光滑的初始数据有在有限时间内发展出垂直梯度、形成激波的趋势。问题给出了这个激波形成时间 $t_s$ 的公式：\n$$\nt_s = \\frac{1}{c_0\\,\\beta\\,A^2\\,k}\n$$\n问题引入了一个实际要求，即数值模拟必须在达到此解析激波时间之前运行至少 $M$ 个时间步。这确保了数值方法有机会捕捉陡峭化过程，并且其固有的数值耗散可以正则化可能形成的激波。该约束表示为 $\\Delta t \\le t_s / M$。当 $\\beta = 0$ 时会出现一个重要的特殊情况。在这种线性平流情景下，不会发生陡峭化，所以 $t_s$ 实际上是无限的。问题明确指出，在这种情况下，这第二个约束被忽略。\n\n最后，非线性CFL阈值 $\\Delta t_{\\text{nl}}$ 被定义为这两个界限中更严格的一个：即基于速度的限制和陡峭化限制。\n$$\n\\Delta t_{\\text{nl}} = \\min\\left(\\Delta t_{\\text{speed}},\\, \\frac{t_s}{M}\\right)\n$$\n如果 $\\beta=0$，这简化为 $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{speed}}$，由于 $a_{\\max} = c_0$，它进一步简化为 $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{lin}}$。\n\n通过将这些步骤应用于测试套件中提供的每个参数集，我们可以系统地计算数值对 $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$ 并以指定的格式呈现它们。下面将对每个案例执行计算。\n\n案例1：$c_0 = 2.99792458\\times 10^8$，$\\Delta x = 1000$，$\\beta = 0.1$，$A = 0.5$，$L = 1.0\\times 10^6$，$\\nu = 0.9$，$M = 50$。\n- $k = 2\\pi / (1.0 \\times 10^6) \\approx 6.283 \\times 10^{-6}$ 弧度/米。\n- $\\Delta t_{\\text{lin}} = 0.9 \\times 1000 / (2.99792458 \\times 10^8) \\approx 3.002077 \\times 10^{-6}$ 秒。\n- $a_{\\max} = c_0(1 + 0.1 \\times 0.5^2) = 1.025\\,c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 1.025 \\approx 2.928855 \\times 10^{-6}$ 秒。\n- $t_s = 1 / (c_0 \\times 0.1 \\times 0.5^2 \\times k) \\approx 0.021236$ 秒。\n- $t_s/M = 0.021236 / 50 \\approx 4.2471 \\times 10^{-4}$ 秒。\n- $\\Delta t_{\\text{nl}} = \\min(2.928855 \\times 10^{-6}, 4.2471 \\times 10^{-4}) = 2.928855 \\times 10^{-6}$ 秒。\n\n案例2：$c_0 = 2.99792458\\times 10^8$，$\\Delta x = 500$，$\\beta = 0.0$，$A = 0.8$，$L = 1.0\\times 10^5$，$\\nu = 1.0$，$M = 20$。\n- $\\beta = 0$，所以 $t_s \\to \\infty$ 且 $a_{\\max} = c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} = 1.0 \\times 500 / (2.99792458 \\times 10^8) \\approx 1.667821 \\times 10^{-6}$ 秒。\n- $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{speed}} = 1.667821 \\times 10^{-6}$ 秒。\n\n案例3：$c_0 = 3.0\\times 10^8$，$\\Delta x = 100$，$\\beta = 1.0$，$A = 1.0$，$L = 1.0\\times 10^4$，$\\nu = 0.8$，$M = 100$。\n- $k = 2\\pi / (1.0 \\times 10^4) \\approx 6.283 \\times 10^{-4}$ 弧度/米。\n- $\\Delta t_{\\text{lin}} = 0.8 \\times 100 / (3.0 \\times 10^8) \\approx 2.666667 \\times 10^{-7}$ 秒。\n- $a_{\\max} = c_0(1 + 1.0 \\times 1.0^2) = 2.0\\,c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 2.0 \\approx 1.333333 \\times 10^{-7}$ 秒。\n- $t_s = 1 / (c_0 \\times 1.0 \\times 1.0^2 \\times k) \\approx 5.30516 \\times 10^{-6}$ 秒。\n- $t_s/M = 5.30516 \\times 10^{-6} / 100 \\approx 5.30516 \\times 10^{-8}$ 秒。\n- $\\Delta t_{\\text{nl}} = \\min(1.333333 \\times 10^{-7}, 5.30516 \\times 10^{-8}) = 5.30516 \\times 10^{-8}$ 秒。\n\n案例4：$c_0 = 2.99792458\\times 10^8$，$\\Delta x = 1$，$\\beta = 0.5$，$A = 0.9$，$L = 1.0\\times 10^5$，$\\nu = 0.95$，$M = 200$。\n- $k = 2\\pi / (1.0 \\times 10^5) \\approx 6.283 \\times 10^{-5}$ 弧度/米。\n- $\\Delta t_{\\text{lin}} = 0.95 \\times 1 / (2.99792458 \\times 10^8) \\approx 3.168850 \\times 10^{-9}$ 秒。\n- $a_{\\max} = c_0(1 + 0.5 \\times 0.9^2) = 1.405\\,c_0$。\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 1.405 \\approx 2.255409 \\times 10^{-9}$ 秒。\n- $t_s = 1 / (c_0 \\times 0.5 \\times 0.9^2 \\times k) \\approx 1.31102 \\times 10^{-4}$ 秒。\n- $t_s/M = 1.31102 \\times 10^{-4} / 200 \\approx 6.5551 \\times 10^{-7}$ 秒。\n- $\\Delta t_{\\text{nl}} = \\min(2.255409 \\times 10^{-9}, 6.5551 \\times 10^{-7}) = 2.255409 \\times 10^{-9}$ 秒。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the nonlinear and linearized CFL time step thresholds\n    for a given set of test cases modeling a nonlinear gauge wave.\n    \"\"\"\n\n    # test_cases are lists of tuples (c0, dx, beta, A, L, nu, M)\n    test_cases = [\n        (2.99792458e8, 1000.0, 0.1, 0.5, 1.0e6, 0.9, 50),\n        (2.99792458e8, 500.0, 0.0, 0.8, 1.0e5, 1.0, 20),\n        (3.0e8, 100.0, 1.0, 1.0, 1.0e4, 0.8, 100),\n        (2.99792458e8, 1.0, 0.5, 0.9, 1.0e5, 0.95, 200),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c0, dx, beta, A, L, nu, M = case\n\n        # Calculate the wavenumber k\n        k = 2 * np.pi / L\n\n        # Calculate the linearized CFL time step, dt_lin\n        dt_lin = nu * dx / c0\n\n        # Calculate the speed-based CFL time step, dt_speed\n        a_max = c0 * (1.0 + beta * A**2)\n        dt_speed = nu * dx / a_max\n        \n        # Calculate the nonlinear CFL threshold, dt_nl\n        if beta == 0.0:\n            # For the linear case, t_s is infinite, so the steepening\n            # bound is not a constraint. dt_nl is just dt_speed.\n            dt_nl = dt_speed\n        else:\n            # Calculate the shock formation time, t_s\n            # The denominator c0 * beta * A^2 * k must be non-zero\n            # because beta != 0.\n            t_s = 1.0 / (c0 * beta * A**2 * k)\n            \n            # The nonlinear CFL threshold is the minimum of the speed-based\n            # limit and the shock-steepening limit.\n            dt_nl = min(dt_speed, t_s / M)\n        \n        results.append([dt_nl, dt_lin])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is desired.\n    formatted_results = \",\".join(map(str, results))\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```", "id": "3487869"}]}