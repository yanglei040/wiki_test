{"hands_on_practices": [{"introduction": "在尝试求解一个反问题之前，我们必须首先确定我们所寻求的参数是否能够被我们的测量所“看见”。本练习将通过一个热弹性杆问题，指导你构建灵敏度矩阵（雅可比矩阵），并利用其奇异值分解来量化参数的可识别性，这对于设计有效的实验和测量策略至关重要。[@problem_id:3511212]", "problem": "考虑一根占据区间 $x \\in [0,L]$ 的一维热弹性杆，其横截面积为 $A$，热导率为 $k$，热膨胀系数为 $\\alpha$，杨氏模量为 $E$。该杆受到稳态体积热源 $s$ 的作用，在 $x=L$ 处有指定热通量 $q$，并在 $x=0$ 处有固定温度。其一维稳态能量平衡和准静态力学平衡由以下基本定律和经过充分检验的公式控制：\n\n- 稳态热传导：$- \\dfrac{d}{dx}\\left( k \\dfrac{dT}{dx} \\right) = s$。\n- 包含热应变的线性热弹性理论：$\\sigma = E \\left( \\dfrac{du}{dx} - \\alpha (T - T_{\\mathrm{ref}}) \\right)$ 和力学平衡 $ \\dfrac{d\\sigma}{dx} = 0$。\n- 边界条件：$T(0) = T_0$，$-k \\dfrac{dT}{dx}(L) = q$， $u(0)=0$，以及在 $x=L$ 处的牵引力等于一个指定的单位面积外力 $F_{\\mathrm{ext}}/A$，即 $\\sigma(L) = \\dfrac{F_{\\mathrm{ext}}}{A}$。\n\n设参数向量为 $p = [k,\\alpha,E]^{\\top}$。将正演状态场（温度和位移）表示为 $T(x;p)$ 和 $u(x;p)$。定义两个将这些场映射到观测数据的测量算子：\n- 仅温度测量：$B_T(T,u) = \\left[T(x_1), T(x_2), \\dots, T(x_{m_T})\\right]^{\\top}$。\n- 仅位移测量：$B_u(T,u) = \\left[u(x_1), u(x_2), \\dots, u(x_{m_u})\\right]^{\\top}$。\n\n对于给定的算子 $B \\in \\{B_T, B_u\\}$，雅可比矩阵（也称为灵敏度矩阵）定义为 $J_B = \\dfrac{\\partial B(T,u)}{\\partial p}\\big|_{p=p^{\\star}}$，在一个标称参数点 $p^{\\star}$ 处进行评估。相对于所选测量的可观测性通过 $J_B$ 的数值秩及其奇异值的分布来评估。\n\n仅从上述基本定律和边界条件出发，推导出正演解 $T(x;p)$ 和 $u(x;p)$，然后在标称参数 $p^{\\star}$ 处推导雅可比矩阵的各项 $\\dfrac{\\partial T(x_i)}{\\partial k}$、$\\dfrac{\\partial T(x_i)}{\\partial \\alpha}$、$\\dfrac{\\partial T(x_i)}{\\partial E}$ 和 $\\dfrac{\\partial u(x_i)}{\\partial k}$、$\\dfrac{\\partial u(x_i)}{\\partial \\alpha}$、$\\dfrac{\\partial u(x_i)}{\\partial E}$。针对指定的传感器位置，组装矩阵 $J_{B_T}$ 和 $J_{B_u}$。\n\n使用奇异值分解计算 $J_{B_T}$ 和 $J_{B_u}$ 的奇异值，将它们按降序排序，并将数值秩确定为大于阈值 $\\tau = 10^{-12} \\, \\sigma_{\\max}$ 的奇异值数量，其中 $\\sigma_{\\max}$ 是相应矩阵的最大奇异值。如果一个矩阵没有奇异值（例如，所有项都为零），在本任务中其秩根据定义为 $0$。报告奇异值为实数，不带单位，四舍五入到 $8$ 位小数。\n\n您的程序必须评估以下三个测试用例。在所有情况下，使用 $L = 1.0$（单位 $\\mathrm{m}$），$A = 1.0$（单位 $\\mathrm{m}^2$），$T_0 = 300.0$（单位 $\\mathrm{K}$），$T_{\\mathrm{ref}} = 300.0$（单位 $\\mathrm{K}$），$s = 10^5$（单位 $\\mathrm{W\\,m^{-3}}$），$q = 5 \\times 10^4$（单位 $\\mathrm{W\\,m^{-2}}$），以及标称参数向量 $p^{\\star} = [k,\\alpha,E]^{\\top} = [200.0, 10^{-5}, 10^8]^{\\top}$，其中 $k$ 的单位是 $\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$\\alpha$ 的单位是 $\\mathrm{K^{-1}}$，$E$ 的单位是 $\\mathrm{Pa}$。\n\n- 测试用例 1（通用信息配置）：\n  - 外力：$F_{\\mathrm{ext}} = 10^6$（单位 $\\mathrm{N}$）。\n  - 温度传感器位置：$x = [0.25, 0.5, 0.75]$（单位 $\\mathrm{m}$）。\n  - 位移传感器位置：$x = [0.25, 0.5, 0.75]$（单位 $\\mathrm{m}$）。\n\n- 测试用例 2（边界退化配置）：\n  - 外力：$F_{\\mathrm{ext}} = 10^6$（单位 $\\mathrm{N}$）。\n  - 温度传感器位置：$x = [0.0]$（单位 $\\mathrm{m}$）。\n  - 位移传感器位置：$x = [0.0]$（单位 $\\mathrm{m}$）。\n\n- 测试用例 3（力学载荷可辨识性丧失）：\n  - 外力：$F_{\\mathrm{ext}} = 0.0$（单位 $\\mathrm{N}$）。\n  - 温度传感器位置：$x = [0.25, 0.5, 0.75]$（单位 $\\mathrm{m}$）。\n  - 位移传感器位置：$x = [0.25, 0.5, 0.75]$（单位 $\\mathrm{m}$）。\n\n对于每个测试用例，计算：\n- $J_{B_T}$ 的数值秩及其奇异值列表（降序排列）。\n- $J_{B_u}$ 的数值秩及其奇异值列表（降序排列）。\n\n最终输出格式要求：\n您的程序应生成单行输出，包含所有测试用例的结果，形式为一个案例列表，其中每个案例表示为 $[\\mathrm{rank\\_T}, \\mathrm{rank\\_u}, [\\sigma^{(T)}_1, \\sigma^{(T)}_2, \\dots], [\\sigma^{(u)}_1, \\sigma^{(u)}_2, \\dots]]$ 的列表。最终输出必须是单行、单个 Python 列表字面量，例如：\n$[[\\mathrm{rank\\_T},\\mathrm{rank\\_u},[\\dots],[\\dots]],[\\mathrm{rank\\_T},\\mathrm{rank\\_u},[\\dots],[\\dots]],[\\mathrm{rank\\_T},\\mathrm{rank\\_u},[\\dots],[\\dots]]]$。\n输出中的所有奇异值必须四舍五入到 $8$ 位小数。数值结果不应打印单位。", "solution": "用户希望我解决一个热弹性问题，这涉及到推导温度场和位移场的解析解，计算这些场关于材料参数的雅可比（灵敏度）矩阵，然后针对特定的测量配置评估这些矩阵的数值秩和奇异值。\n\n### 1. 问题验证\n\n首先，对照要求的标准验证问题陈述。\n\n**1.1. 提取的已知信息**\n- **控制方程**：\n  - 稳态热传导：$- \\frac{d}{dx}\\left( k \\frac{dT}{dx} \\right) = s$\n  - 线性热弹性：$\\sigma = E \\left( \\frac{du}{dx} - \\alpha (T - T_{\\mathrm{ref}}) \\right)$\n  - 力学平衡：$ \\frac{d\\sigma}{dx} = 0$\n- **边界条件**：$T(0) = T_0$，$-k \\frac{dT}{dx}(L) = q$， $u(0)=0$， $\\sigma(L) = \\frac{F_{\\mathrm{ext}}}{A}$。\n- **参数向量**：$p = [k, \\alpha, E]^{\\top}$。\n- **测量算子**：$B_T$ 用于点 $x_i$ 处的温度，$B_u$ 用于点 $x_i$ 处的位移。\n- **雅可比矩阵**：$J_B = \\frac{\\partial B(T,u)}{\\partial p}$ 在一个标称参数点 $p^{\\star}$ 处评估。\n- **常数**：$L=1.0$，$A=1.0$，$T_0=300.0$，$T_{\\mathrm{ref}}=300.0$，$s=10^5$，$q=5 \\times 10^4$。\n- **标称参数 ($p^{\\star}$)**：$k=200.0$，$\\alpha=10^{-5}$，$E=10^8$。\n- **测试用例**：三个用例，具有不同的外力 $F_{\\mathrm{ext}}$ 和传感器位置。\n- **任务**：计算雅可比矩阵 $J_{B_T}$ 和 $J_{B_u}$ 的数值秩和奇异值。\n- **数值秩定义**：奇异值 $\\sigma_i$ 满足 $\\sigma_i > 10^{-12} \\sigma_{\\max}$ 的数量。\n\n**1.2. 验证结论**\n该问题在科学上基于标准的连续介质力学，是适定的、客观的且自洽的。提供的方程和边界条件是一维热弹性学的标准形式。执行灵敏度分析和评估可观测性的任务在反问题和参数估计的背景下是一个定义明确且有意义的练习。问题陈述没有违反任何无效性标准。因此，该问题被认为是**有效的**。\n\n### 2. 解析推导\n\n求解需要推导正演解 $T(x;p)$ 和 $u(x;p)$，然后是它们对参数 $k$、$\\alpha$ 和 $E$ 的灵敏度。\n\n**2.1. 温度的正演解 $T(x)$**\n假设热导率 $k$ 和热源 $s$ 为常数，稳态热传导方程为：\n$$ -k \\frac{d^2T}{dx^2} = s $$\n对 $x$ 积分两次，得到温度的通解：\n$$ T(x) = -\\frac{s}{2k}x^2 + C_1 x + C_2 $$\n积分常数 $C_1$ 和 $C_2$ 由边界条件确定。\n1. 在 $x=0$ 处，$T(0) = T_0$：\n   $$ T(0) = C_2 = T_0 $$\n2. 在 $x=L$ 处，$-k \\frac{dT}{dx}(L) = q$：\n   $$ \\frac{dT}{dx} = -\\frac{s}{k}x + C_1 $$\n   $$ -k \\left( -\\frac{s}{k}L + C_1 \\right) = q \\implies sL - kC_1 = q \\implies C_1 = \\frac{sL - q}{k} $$\n将常数代回，稳态温度场为：\n$$ T(x; k) = T_0 + \\frac{sL-q}{k}x - \\frac{s}{2k}x^2 $$\n\n**2.2. 位移的正演解 $u(x)$**\n由力学平衡 $\\frac{d\\sigma}{dx} = 0$，应力 $\\sigma$ 在整个杆上是恒定的。$x=L$ 处的边界条件给出 $\\sigma(L) = F_{\\mathrm{ext}}/A$，所以对所有 $x$ 都有 $\\sigma(x) = F_{\\mathrm{ext}}/A$。\n本构关系为：\n$$ \\sigma = E \\left( \\frac{du}{dx} - \\alpha (T(x) - T_{\\mathrm{ref}}) \\right) $$\n解出应变梯度 $\\frac{du}{dx}$：\n$$ \\frac{du}{dx} = \\frac{\\sigma}{E} + \\alpha(T(x) - T_{\\mathrm{ref}}) = \\frac{F_{\\mathrm{ext}}}{AE} + \\alpha(T(x) - T_{\\mathrm{ref}}) $$\n从 $0$ 到 $x$ 积分，并应用边界条件 $u(0)=0$：\n$$ u(x) = \\int_0^x \\left(\\frac{F_{\\mathrm{ext}}}{AE} + \\alpha(T(\\xi) - T_{\\mathrm{ref}})\\right) d\\xi $$\n鉴于 $T_0 = T_{\\mathrm{ref}}$，我们有 $T(\\xi) - T_{\\mathrm{ref}} = T(\\xi) - T_0 = \\frac{sL-q}{k}\\xi - \\frac{s}{2k}\\xi^2$。\n进行积分：\n$$ u(x) = \\frac{F_{\\mathrm{ext}}}{AE}x + \\alpha \\int_0^x \\left( \\frac{sL-q}{k}\\xi - \\frac{s}{2k}\\xi^2 \\right) d\\xi $$\n$$ u(x; k, \\alpha, E) = \\frac{F_{\\mathrm{ext}}}{AE}x + \\frac{\\alpha}{k} \\left( \\frac{sL-q}{2}x^2 - \\frac{s}{6}x^3 \\right) $$\n\n**2.3. 雅可比（灵敏度）推导**\n雅可比矩阵的元素是 $T(x)$ 和 $u(x)$ 对参数 $p=[k, \\alpha, E]^{\\top}$ 中每个参数的偏导数，在标称点 $p^{\\star}$ 处求值。\n\n**温度灵敏度：**\n温度场 $T(x;k)$ 仅依赖于 $k$。\n$$ \\frac{\\partial T}{\\partial k} = \\frac{\\partial}{\\partial k} \\left( T_0 + \\frac{1}{k} \\left((sL-q)x - \\frac{s}{2}x^2\\right) \\right) = -\\frac{1}{k^2} \\left((sL-q)x - \\frac{s}{2}x^2\\right) = -\\frac{T(x) - T_0}{k} $$\n$$ \\frac{\\partial T}{\\partial \\alpha} = 0 $$\n$$ \\frac{\\partial T}{\\partial E} = 0 $$\n\n**位移灵敏度：**\n位移场 $u(x; k, \\alpha, E)$ 依赖于所有三个参数。\n$$ \\frac{\\partial u}{\\partial k} = \\frac{\\partial}{\\partial k} \\left( \\frac{\\alpha}{k} \\left( \\frac{sL-q}{2}x^2 - \\frac{s}{6}x^3 \\right) \\right) = -\\frac{\\alpha}{k^2} \\left( \\frac{sL-q}{2}x^2 - \\frac{s}{6}x^3 \\right) $$\n$$ \\frac{\\partial u}{\\partial \\alpha} = \\frac{1}{k} \\left( \\frac{sL-q}{2}x^2 - \\frac{s}{6}x^3 \\right) $$\n$$ \\frac{\\partial u}{\\partial E} = \\frac{\\partial}{\\partial E} \\left( \\frac{F_{\\mathrm{ext}}}{AE}x \\right) = -\\frac{F_{\\mathrm{ext}}}{AE^2}x $$\n注意到 $\\frac{\\partial u}{\\partial k} = -\\frac{\\alpha}{k} \\frac{\\partial u}{\\partial \\alpha}$，这表明雅可比矩阵 $J_{B_u}$ 的前两列之间存在线性依赖关系。\n\n### 3. 计算实现\n\n对于每个测试用例，使用推导出的灵敏度公式和给定的测量位置来组装雅可比矩阵 $J_{B_T}$ 和 $J_{B_u}$。\n- $J_{B_T}$ 是一个 $m_T \\times 3$ 矩阵，其中第 $i$ 行为 $[\\frac{\\partial T(x_i)}{\\partial k}, \\frac{\\partial T(x_i)}{\\partial \\alpha}, \\frac{\\partial T(x_i)}{\\partial E}]$。\n- $J_{B_u}$ 是一个 $m_u \\times 3$ 矩阵，其中第 $i$ 行为 $[\\frac{\\partial u(x_i)}{\\partial k}, \\frac{\\partial u(x_i)}{\\partial \\alpha}, \\frac{\\partial u(x_i)}{\\partial E}]$。\n\n使用 `numpy.linalg.svd` 计算每个矩阵的奇异值分解（SVD）。通过计算大于阈值 $\\tau = 10^{-12} \\sigma_{\\max}$（其中 $\\sigma_{\\max}$ 是最大奇异值）的奇异值数量来确定数值秩。如果 $\\sigma_{\\max}=0$，则秩为 $0$。然后将奇异值四舍五入到 $8$ 位小数。所有测试用例的结果被整理成一个单一的列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the thermoelastic parameter identifiability problem.\n    \"\"\"\n    # Global constants for all test cases\n    L = 1.0  # m\n    A = 1.0  # m^2\n    T0 = 300.0  # K\n    T_ref = 300.0  # K\n    s = 1.0e5  # W/m^3\n    q = 5.0e4  # W/m^2\n    k_star = 200.0  # W/(m*K)\n    alpha_star = 1.0e-5  # 1/K\n    E_star = 1.0e8  # Pa\n\n    # Test case definitions\n    test_cases = [\n        {'F_ext': 1.0e6, 'x_T_sensors': [0.25, 0.5, 0.75], 'x_u_sensors': [0.25, 0.5, 0.75]},\n        {'F_ext': 1.0e6, 'x_T_sensors': [0.0], 'x_u_sensors': [0.0]},\n        {'F_ext': 0.0, 'x_T_sensors': [0.25, 0.5, 0.75], 'x_u_sensors': [0.25, 0.5, 0.75]},\n    ]\n\n    # Pre-calculate common terms using nominal parameter values\n    # Sensitivity of temperature with respect to k\n    def dT_dk(x):\n        return -1.0 / k_star**2 * ((s * L - q) * x - s / 2.0 * x**2)\n\n    # Common thermal term in displacement sensitivities\n    def u_thermal_term(x):\n        return (s * L - q) / 2.0 * x**2 - s / 6.0 * x**3\n\n    # Sensitivity of displacement with respect to k\n    def du_dk(x):\n        return -alpha_star / k_star**2 * u_thermal_term(x)\n\n    # Sensitivity of displacement with respect to alpha\n    def du_dalpha(x):\n        return 1.0 / k_star * u_thermal_term(x)\n\n    # Sensitivity of displacement with respect to E\n    def du_dE(x, F_ext):\n        if E_star == 0: return 0.0\n        return -F_ext / (A * E_star**2) * x\n\n    def analyze_jacobian(J):\n        \"\"\"Computes SVD, numerical rank, and formats singular values for a Jacobian.\"\"\"\n        num_rows, num_cols = J.shape\n        \n        # SVD returns min(m, n) singular values\n        s_vals = np.linalg.svd(J, compute_uv=False)\n        \n        # Handle zero matrix or matrices with zero singular values\n        if not s_vals.any():\n            sigma_max = 0.0\n        else:\n            sigma_max = s_vals[0]\n        \n        # Determine numerical rank\n        rank = 0\n        if sigma_max > 0:\n            threshold = 1.0e-12 * sigma_max\n            rank = np.sum(s_vals > threshold)\n        \n        # Round singular values for output\n        rounded_s_vals = [round(val, 8) for val in s_vals]\n        \n        return rank, rounded_s_vals\n\n    all_results = []\n    for case in test_cases:\n        F_ext = case['F_ext']\n        x_T_sensors = case['x_T_sensors']\n        x_u_sensors = case['x_u_sensors']\n        \n        m_T = len(x_T_sensors)\n        m_u = len(x_u_sensors)\n        \n        # Assemble Temperature Jacobian J_B_T (m_T x 3)\n        J_T = np.zeros((m_T, 3))\n        for i, x in enumerate(x_T_sensors):\n            J_T[i, 0] = dT_dk(x)\n            # d_T/d_alpha and d_T/d_E are zero\n            J_T[i, 1] = 0.0\n            J_T[i, 2] = 0.0\n        \n        # Assemble Displacement Jacobian J_B_u (m_u x 3)\n        J_u = np.zeros((m_u, 3))\n        for i, x in enumerate(x_u_sensors):\n            J_u[i, 0] = du_dk(x)\n            J_u[i, 1] = du_dalpha(x)\n            J_u[i, 2] = du_dE(x, F_ext)\n            \n        # Analyze both Jacobians\n        rank_T, svals_T = analyze_jacobian(J_T)\n        rank_u, svals_u = analyze_jacobian(J_u)\n        \n        all_results.append([rank_T, rank_u, svals_T, svals_u])\n\n    # Print final result in the specified Python list literal format\n    print(all_results)\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3511212"}, {"introduction": "大多数反问题都是不适定 (ill-posed) 的，需要通过正则化来找到一个稳定的解。本练习深入探讨了 $L^1$ 正则化，这是一种强大的技术，可以促进解的稀疏性，非常适用于识别诸如清晰界面或局部源等特征。你将从第一性原理出发推导最优性条件，并将其应用于解决一个具体问题，从而深入理解著名的软阈值算子的内在机制。[@problem_id:3511240]", "problem": "考虑一个耦合热力系统，其正向模型将一个无量纲化的材料参数向量 $\\theta \\in \\mathbb{R}^{n}$ 映射到一个无量纲化的传感器输出向量 $F(\\theta) \\in \\mathbb{R}^{m}$，该输出向量是通过耦合了热传导和线性弹性力学的多物理场仿真获得的。假设测量值 $y \\in \\mathbb{R}^{m}$ 被加性噪声污染，该噪声可以很好地用一个零均值高斯随机变量来建模，并假设参数 $\\theta$ 用稀疏先验进行建模，该先验可以很好地用一个独立的拉普拉斯分布来表示。由此产生的最大后验 (MAP) 估计器通过最小化复合目标函数得到\n$$\nJ(\\theta) = \\|F(\\theta) - y\\|^{2} + \\lambda \\|\\theta\\|_{1},\n$$\n其中 $\\lambda > 0$ 是一个正则化参数。\n\nA部分：从凸次微分的定义出发，并使用可微映射的链式法则，推导在一般（可能非线性）情况下目标函数 $J(\\theta)$ 的一个最小化子 $\\theta^{\\star}$ 所满足的 Karush-Kuhn-Tucker (KKT) 条件。特别地，描述 $\\ell^{1}$-范数 $\\|\\theta\\|_{1}$ 的次梯度在最优性条件中的作用。\n\nB部分：现在考虑一个降阶线性化模型，该模型通过将耦合仿真投影到一组占主导地位的灵敏度模态的标准正交基上获得，因此 $F(\\theta) = A \\theta$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 满足 $A^{\\top} A = I$。对于一个 $n = 3$ 的特定实例，假设标准正交化和无量纲化得到 $A = I$，测量数据向量为\n$$\ny = \\begin{pmatrix} \\tfrac{5}{2} \\\\ \\tfrac{4}{5} \\\\ -\\tfrac{6}{5} \\end{pmatrix},\n$$\n且正则化参数为 $\\lambda = 1$。使用您推导出的 KKT 条件，计算唯一的最小化子\n$$\n\\theta^{\\star} = \\arg\\min_{\\theta \\in \\mathbb{R}^{3}} \\|A\\theta - y\\|^{2} + \\lambda \\|\\theta\\|_{1}.\n$$\n将最终的参数估计表示为一个无量纲的行向量。无需四舍五入；请给出精确值。", "solution": "问题陈述已经过验证，被认为是有效的。它在多物理场建模、反问题和凸优化领域具有科学依据。该问题是适定的、客观的，并包含推导唯一且有意义的解所需的所有信息。\n\n目标是为复合目标函数找到一个最小化子 $\\theta^{\\star}$\n$$\nJ(\\theta) = \\|F(\\theta) - y\\|^{2} + \\lambda \\|\\theta\\|_{1}\n$$\n该函数是一个可微的数据保真项 $f(\\theta) = \\|F(\\theta) - y\\|^{2}$ 与一个不可微但凸的正则化项 $g(\\theta) = \\lambda \\|\\theta\\|_{1}$ 的和。使用欧几里得范数，所以 $\\|v\\|^2 = v^\\top v$。\n\n由于 $J(\\theta)$ 是一个凸函数，一个点 $\\theta^{\\star}$ 是全局最小化子的充要条件是零向量属于 $J$ 在 $\\theta^{\\star}$ 处的次微分。这是一阶最优性的充要条件：\n$$\n0 \\in \\partial J(\\theta^{\\star})\n$$\n\n### A部分：Karush-Kuhn-Tucker (KKT) 条件的推导\n\n我们使用次微分的求和法则，该法则指出，如果 $f$ 是一个凸的可微函数，$g$ 是一个凸函数，则 $\\partial (f+g)(\\theta) = \\nabla f(\\theta) + \\partial g(\\theta)$。将此应用于 $J(\\theta) = f(\\theta) + g(\\theta)$，最优性条件变为：\n$$\n0 \\in \\nabla f(\\theta^{\\star}) + \\partial g(\\theta^{\\star})\n$$\n这可以重写为：\n$$\n-\\nabla f(\\theta^{\\star}) \\in \\partial g(\\theta^{\\star})\n$$\n\n首先，我们计算保真项 $f(\\theta) = \\|F(\\theta) - y\\|^{2} = (F(\\theta) - y)^{\\top}(F(\\theta) - y)$ 的梯度。使用向量值函数的链式法则，$f$ 关于 $\\theta$ 的梯度是：\n$$\n\\nabla f(\\theta) = 2 (D F(\\theta))^{\\top} (F(\\theta) - y)\n$$\n其中 $D F(\\theta)$ 是正向映射 $F$ 在 $\\theta$ 处求值的雅可比矩阵，其元素为 $(D F(\\theta))_{ij} = \\frac{\\partial F_i}{\\partial \\theta_j}$。\n\n接下来，我们描述正则化项 $g(\\theta) = \\lambda \\|\\theta\\|_{1} = \\lambda \\sum_{i=1}^{n} |\\theta_i|$ 的次微分。由于 $g(\\theta)$ 是可分的，其次微分是其各个分量次微分的笛卡尔积。绝对值函数 $|\\cdot|$ 在点 $u \\in \\mathbb{R}$ 处的次微分是：\n$$\n\\partial(|u|) = \\begin{cases} \\{\\text{sign}(u)\\}  \\text{if } u \\neq 0 \\\\ [-1, 1]  \\text{if } u = 0 \\end{cases}\n$$\n因此，$g(\\theta)$ 的次微分是 $\\partial g(\\theta) = \\lambda \\partial (\\|\\theta\\|_{1})$，它是所有向量 $s \\in \\mathbb{R}^n$ 的集合，使得对于每个分量 $i=1, \\dots, n$：\n$$\ns_i \\in \\lambda \\partial(|\\theta_i|)\n$$\n这意味着如果 $\\theta_i \\neq 0$，则 $s_i = \\lambda \\text{sign}(\\theta_i)$；如果 $\\theta_i = 0$，则 $s_i \\in [-\\lambda, \\lambda]$。\n\n将这些代入最优性条件 $-\\nabla f(\\theta^{\\star}) \\in \\partial g(\\theta^{\\star})$，我们得到 KKT 条件。令 $v = -\\nabla f(\\theta^{\\star}) = -2 (D F(\\theta^{\\star}))^{\\top} (F(\\theta^{\\star}) - y)$。关于 $\\theta^{\\star}$ 各分量的条件是：\n\\begin{enumerate}\n    \\item 如果 $\\theta_i^{\\star} \\neq 0$，则 $v_i = \\lambda \\text{sign}(\\theta_i^{\\star})$。这意味着 $|v_i| = \\lambda$。\n    \\item 如果 $\\theta_i^{\\star} = 0$，则 $v_i \\in [-\\lambda, \\lambda]$。这意味着 $|v_i| \\le \\lambda$。\n\\end{enumerate}\n总结来说，对于每个分量 $i$，我们有：\n$$\n-2 \\left[(D F(\\theta^{\\star}))^{\\top} (F(\\theta^{\\star}) - y)\\right]_i =\n\\begin{cases}\n\\lambda \\text{sign}(\\theta_i^{\\star})  \\text{if } \\theta_i^{\\star} \\neq 0 \\\\\ns_i \\text{ with } |s_i| \\le \\lambda  \\text{if } \\theta_i^{\\star} = 0\n\\end{cases}\n$$\n$\\ell^1$-范数的次梯度的作用是诱导稀疏性。对于任何非零分量 $\\theta_i^{\\star}$，保真项负梯度的相应分量的模必须恰好等于正则化参数 $\\lambda$。对于任何为零的分量 $\\theta_i^{\\star}$，保真项负梯度的相应分量的模必须小于或等于 $\\lambda$。这就产生了一个“死区”，如果梯度不够强（即其模小于 $\\lambda$），最优参数值将被强制为零。\n\n### B部分：最小化子的计算\n\n在B部分，我们给定一个简化的线性模型 $F(\\theta) = A\\theta$，其中 $A=I \\in \\mathbb{R}^{3 \\times 3}$，$n=3$，$\\lambda=1$，数据向量为 $y = \\begin{pmatrix} \\frac{5}{2} \\\\ \\frac{4}{5} \\\\ -\\frac{6}{5} \\end{pmatrix}$。\n\n目标函数变为：\n$$\nJ(\\theta) = \\|I\\theta - y\\|^{2} + 1 \\cdot \\|\\theta\\|_{1} = \\|\\theta - y\\|^{2} + \\|\\theta\\|_{1}\n$$\n保真项是 $f(\\theta) = \\|\\theta - y\\|^2$，其梯度是 $\\nabla f(\\theta) = 2(\\theta - y)$。\n在A部分推导出的 KKT 条件得以显著简化。当 $F(\\theta)=\\theta$ 时，我们有 $D F(\\theta) = I$。\n条件是 $-2(\\theta^{\\star} - y) \\in \\partial(\\|\\theta^{\\star}\\|_{1})$，因为 $\\lambda=1$。\n这个问题是可分的，意味着我们可以独立求解每个分量 $\\theta_i^{\\star}$：\n$$\n-2(\\theta_i^{\\star} - y_i) \\in \\partial(|\\theta_i^{\\star}|) \\quad \\text{for } i=1, 2, 3.\n$$\n这等价于 $2(y_i - \\theta_i^{\\star}) \\in \\partial(|\\theta_i^{\\star}|)$。令 $s_i = 2(y_i - \\theta_i^{\\star})$。\n\n我们对每个分量 $\\theta_i^{\\star}$ 的三种可能情况进行分析：\n\\begin{enumerate}\n    \\item 如果 $\\theta_i^{\\star} > 0$：$\\partial(|\\theta_i^{\\star}|) = \\{1\\}$。所以，$2(y_i - \\theta_i^{\\star}) = 1$，这给出 $\\theta_i^{\\star} = y_i - \\frac{1}{2}$。这个解是一致的，当且仅当 $y_i - \\frac{1}{2} > 0$，即 $y_i > \\frac{1}{2}$。\n    \\item 如果 $\\theta_i^{\\star}  0$：$\\partial(|\\theta_i^{\\star}|) = \\{-1\\}$。所以，$2(y_i - \\theta_i^{\\star}) = -1$，这给出 $\\theta_i^{\\star} = y_i + \\frac{1}{2}$。这个解是一致的，当且仅当 $y_i + \\frac{1}{2}  0$，即 $y_i  -\\frac{1}{2}$。\n    \\item 如果 $\\theta_i^{\\star} = 0$：$\\partial(|\\theta_i^{\\star}|) = [-1, 1]$。所以，$2(y_i - 0) \\in [-1, 1]$，这给出 $|2y_i| \\le 1$，或 $|y_i| \\le \\frac{1}{2}$。\n\\end{enumerate}\n这三种情况定义了软阈值算子 $\\mathcal{S}_{\\alpha}(x) = \\text{sign}(x)\\max(|x|-\\alpha, 0)$。在这里，阈值是 $\\alpha = \\lambda/2 = 1/2$。所以，$\\theta_i^{\\star} = \\mathcal{S}_{1/2}(y_i)$。\n\n我们现在将此应用于给定的 $y$ 的分量：\n\\begin{itemize}\n    \\item 对于 $i=1$：$y_1 = \\frac{5}{2} = 2.5$。由于 $y_1 > \\frac{1}{2}$，我们处于情况1。\n    $$\n    \\theta_1^{\\star} = y_1 - \\frac{1}{2} = \\frac{5}{2} - \\frac{1}{2} = \\frac{4}{2} = 2\n    $$\n    \\item 对于 $i=2$：$y_2 = \\frac{4}{5} = 0.8$。由于 $y_2 > \\frac{1}{2}$，我们处于情况1。\n    $$\n    \\theta_2^{\\star} = y_2 - \\frac{1}{2} = \\frac{4}{5} - \\frac{1}{2} = \\frac{8}{10} - \\frac{5}{10} = \\frac{3}{10}\n    $$\n    \\item 对于 $i=3$：$y_3 = -\\frac{6}{5} = -1.2$。由于 $y_3  -\\frac{1}{2}$，我们处于情况2。\n    $$\n    \\theta_3^{\\star} = y_3 + \\frac{1}{2} = -\\frac{6}{5} + \\frac{1}{2} = -\\frac{12}{10} + \\frac{5}{10} = -\\frac{7}{10}\n    $$\n\\end{itemize}\n唯一的最小化子是 $\\theta^{\\star} = \\begin{pmatrix} 2 \\\\ \\frac{3}{10} \\\\ -\\frac{7}{10} \\end{pmatrix}$。问题要求以无量纲行向量的形式给出答案。\n$$\n\\theta^{\\star} = \\begin{pmatrix} 2  \\frac{3}{10}  -\\frac{7}{10} \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  \\frac{3}{10}  -\\frac{7}{10}\n\\end{pmatrix}\n}\n$$", "id": "3511240"}, {"introduction": "与寻找单一“最佳”解不同，贝叶斯方法旨在刻画参数的完整后验概率分布，从而提供对不确定性的全面看法。在本练习中，你将研究一个耦合多物理场系统，通过推导后验协方差，来观察前向模型中的物理耦合和先验假设如何转化为参数估计中的统计相关性。这是理解反问题解的可信度的关键技能。[@problem_id:3511225]", "problem": "考虑一个包含两个耦合子系统的线性化多物理场反问题。设参数向量为 $\\,\\theta \\in \\mathbb{R}^{4}\\,$，分块为 $\\,\\theta = \\begin{bmatrix} u \\\\ v \\end{bmatrix}\\,$，其中 $\\,u \\in \\mathbb{R}^{2}\\,$ 且 $\\,v \\in \\mathbb{R}^{2}\\,$。耦合正向模型在参考状态附近的线性化产生一个块雅可比矩阵，该矩阵依赖于一个非负耦合标量 $\\,c \\in \\mathbb{R}\\,$。具体来说，定义 $\\,2 \\times 2\\,$ 的块矩阵\n- $\\,A = \\begin{bmatrix} 1.0  0.2 \\\\ 0.3  1.5 \\end{bmatrix}\\,$,\n- $\\,B = \\begin{bmatrix} 1.2  -0.1 \\\\ 0.0  0.9 \\end{bmatrix}\\,$,\n- $\\,C = \\begin{bmatrix} 0.5  0.1 \\\\ -0.2  0.4 \\end{bmatrix}\\,$,\n- $\\,D = \\begin{bmatrix} -0.3  0.2 \\\\ 0.6  0.1 \\end{bmatrix}\\,$,\n并构成 $\\,4 \\times 4\\,$ 的雅可比矩阵\n$$\nJ(c) \\;=\\;\n\\begin{bmatrix}\nA  c\\,C \\\\\nc\\,D  B\n\\end{bmatrix}.\n$$\n假设加性高斯观测噪声的协方差为 $\\,\\Sigma \\in \\mathbb{R}^{4 \\times 4}\\,$，其为块对角矩阵，$\\,2 \\times 2\\,$ 的块矩阵为\n- $\\,\\Sigma_{1} = \\begin{bmatrix} 0.04  0.0 \\\\ 0.0  0.01 \\end{bmatrix}\\,$,\n- $\\,\\Sigma_{2} = \\begin{bmatrix} 0.09  0.0 \\\\ 0.0  0.09 \\end{bmatrix}\\,$,\n因此 $\\,\\Sigma = \\operatorname{blkdiag}(\\Sigma_{1}, \\Sigma_{2})\\,$。假设 $\\,\\theta\\,$ 服从零均值高斯先验，其块对角协方差 $\\,\\Gamma \\in \\mathbb{R}^{4 \\times 4}\\,$ 由以下给定\n- $\\,\\Gamma_{u} = \\begin{bmatrix} 0.5  0.1 \\\\ 0.1  0.7 \\end{bmatrix}\\,$,\n- $\\,\\Gamma_{v} = \\begin{bmatrix} 0.6  -0.05 \\\\ -0.05  0.8 \\end{bmatrix}\\,$,\n因此 $\\,\\Gamma = \\operatorname{blkdiag}(\\Gamma_{u}, \\Gamma_{v})\\,$。\n\n从贝叶斯法则、高斯先验、加性高斯噪声以及正向模型在参考点的一阶线性化出发，推导 $\\,\\theta\\,$ 的后验分布的高斯近似。仅使用以下基础：\n- 高斯先验 $\\,\\theta \\sim \\mathcal{N}(0,\\Gamma)\\,$。\n- 加性高斯噪声 $\\,\\varepsilon \\sim \\mathcal{N}(0,\\Sigma)\\,$。\n- 线性化观测模型 $\\,y \\approx J(c)\\,\\theta + \\varepsilon\\,$。\n\n然后，使用您推导的结果，定义近似后验协方差 $\\,S(c,\\Sigma,\\Gamma) \\in \\mathbb{R}^{4 \\times 4}\\,$。将 $\\,S\\,$ 按照 $\\,\\theta = [u;v]\\,$ 的形式进行分块，以提取块矩阵 $\\,S_{uu} \\in \\mathbb{R}^{2 \\times 2}\\,$, $\\,S_{uv} \\in \\mathbb{R}^{2 \\times 2}\\,$ 和 $\\,S_{vv} \\in \\mathbb{R}^{2 \\times 2}\\,$。根据这些块矩阵，计算 $\\,u\\,$ 和 $\\,v\\,$ 之间的后验互相关，公式如下\n$$\n\\mathrm{Corr}_{uv} \\;=\\; \\operatorname{diag}(S_{uu})^{-\\tfrac{1}{2}} \\; S_{uv} \\; \\operatorname{diag}(S_{vv})^{-\\tfrac{1}{2}},\n$$\n其中 $\\,\\operatorname{diag}(M)\\,$ 表示包含 $\\,M\\,$ 对角线元素的对角矩阵，而 $\\,X^{-\\tfrac{1}{2}}\\,$ 表示一个对角矩阵，其通过对 $\\,X\\,$ 的对角线元素逐元素取平方根然后求倒数得到。\n\n您的目标是为每个指定的测试用例计算 $\\,\\mathrm{Corr}_{uv}\\,$ 的弗罗贝尼乌斯范数，其定义为\n$$\n\\|\\mathrm{Corr}_{uv}\\|_{F} \\;=\\; \\sqrt{\\sum_{i=1}^{2}\\sum_{j=1}^{2} (\\mathrm{Corr}_{uv})_{ij}^{2}}.\n$$\n该范数量化了两个参数块之间引起的总后验相关性，并且预期会随着耦合强度 $\\,c\\,$ 以及先验和噪声尺度的变化而变化。\n\n实现一个完整的程序，对于每个测试用例，构造 $\\,J(c)\\,$、$\\,\\Sigma\\,$ 和 $\\,\\Gamma\\,$，计算近似后验协方差 $\\,S\\,$，提取 $\\,S_{uu}\\,$、$\\,S_{uv}\\,$、$\\,S_{vv}\\,$，构成 $\\,\\mathrm{Corr}_{uv}\\,$，并输出弗罗贝尼乌斯范数 $\\,\\|\\mathrm{Corr}_{uv}\\|_{F}\\,$，结果为浮点数，四舍五入至六位小数。\n\n测试套件：\n- 使用上面定义的基础矩阵 $\\,A\\,$, $\\,B\\,$, $\\,C\\,$, $\\,D\\,$, $\\,\\Sigma_{1}\\,$, $\\,\\Sigma_{2}\\,$, $\\,\\Gamma_{u}\\,$, $\\,\\Gamma_{v}\\,$。\n- 对于每个测试用例，定义缩放因子 $\\,\\alpha > 0\\,$ 和 $\\,\\beta > 0\\,$，并设置 $\\,\\Gamma = \\alpha \\cdot \\operatorname{blkdiag}(\\Gamma_{u}, \\Gamma_{v})\\,$ 和 $\\,\\Sigma = \\beta \\cdot \\operatorname{blkdiag}(\\Sigma_{1}, \\Sigma_{2})\\,$。雅可比矩阵 $\\,J(c)\\,$ 如上定义。\n- 评估以下五个情况，每个情况以三元组 $\\,\\big(c,\\alpha,\\beta\\big)\\,$ 的形式给出：\n    1. $\\,\\big(0.0,\\,1.0,\\,1.0\\big)\\,$。\n    2. $\\,\\big(0.25,\\,1.0,\\,1.0\\big)\\,$。\n    3. $\\,\\big(1.0,\\,1.0,\\,1.0\\big)\\,$。\n    4. $\\,\\big(1.0,\\,1.0,\\,10.0\\big)\\,$。\n    5. $\\,\\big(4.0,\\,2.0,\\,0.5\\big)\\,$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。输出必须是一个包含五个浮点数的列表，按上述顺序对应于五个测试用例，每个浮点数四舍五入到六位小数，例如 $\\,\\big[\\text{r}_{1},\\text{r}_{2},\\text{r}_{3},\\text{r}_{4},\\text{r}_{5}\\big]\\,$。不应打印任何额外的文本或行。\n- 不涉及物理单位；所有量均为无量纲实数。", "solution": "该问题要求在一个线性化的多物理场反问题中，在高斯假设下，计算一个度量指标，即后验互相关矩阵的弗罗贝尼乌斯范数。第一步是推导后验协方差矩阵的解析形式，这是所有后续计算的基础。\n\n该问题在贝叶斯框架内进行表述。给定观测值 $y$ 时参数 $\\theta$ 的后验概率分布由贝叶斯法则给出：\n$$\np(\\theta | y) \\propto p(y | \\theta) p(\\theta)\n$$\n其中 $p(y | \\theta)$ 是似然，而 $p(\\theta)$ 是先验。\n\n问题指定参数向量 $\\theta \\in \\mathbb{R}^{4}$ 服从高斯先验，以零为中心，协方差矩阵为 $\\Gamma \\in \\mathbb{R}^{4 \\times 4}$。该先验的概率密度函数 (PDF) 为：\n$$\np(\\theta) = \\frac{1}{\\sqrt{(2\\pi)^4 |\\Gamma|}} \\exp\\left(-\\frac{1}{2} \\theta^T \\Gamma^{-1} \\theta\\right) \\propto \\exp\\left(-\\frac{1}{2} \\theta^T \\Gamma^{-1} \\theta\\right)\n$$\n其中 $|\\Gamma|$ 表示 $\\Gamma$ 的行列式。\n\n观测模型是正向模型的线性化，表示为 $y \\approx J(c)\\theta + \\varepsilon$，其中 $J(c) \\in \\mathbb{R}^{4 \\times 4}$ 是雅可比矩阵，$\\varepsilon$ 是加性高斯噪声，其分布为 $\\varepsilon \\sim \\mathcal{N}(0, \\Sigma)$。这意味着在给定参数向量 $\\theta$ 的情况下观测到 $y$ 的似然也是高斯的：\n$$\np(y | \\theta) = \\frac{1}{\\sqrt{(2\\pi)^4 |\\Sigma|}} \\exp\\left(-\\frac{1}{2} (y - J(c)\\theta)^T \\Sigma^{-1} (y - J(c)\\theta)\\right) \\propto \\exp\\left(-\\frac{1}{2} (y - J(c)\\theta)^T \\Sigma^{-1} (y - J(c)\\theta)\\right)\n$$\n\n将先验和似然代入贝叶斯法则，后验 PDF 为：\n$$\np(\\theta|y) \\propto \\exp\\left(-\\frac{1}{2} (y - J(c)\\theta)^T \\Sigma^{-1} (y - J(c)\\theta)\\right) \\exp\\left(-\\frac{1}{2} \\theta^T \\Gamma^{-1} \\theta\\right)\n$$\n$$\np(\\theta|y) \\propto \\exp\\left(-\\frac{1}{2} \\left[ (y - J(c)\\theta)^T \\Sigma^{-1} (y - J(c)\\theta) + \\theta^T \\Gamma^{-1} \\theta \\right]\\right)\n$$\n指数中的表达式是 $\\theta$ 的二次函数。这表明后验分布也是高斯分布，记为 $\\theta|y \\sim \\mathcal{N}(\\mu_{\\text{post}}, S)$。具有均值 $\\mu$ 和协方差 $S$ 的一般多元高斯分布的 PDF 正比于 $\\exp\\left(-\\frac{1}{2} (\\theta - \\mu)^T S^{-1} (\\theta - \\mu)\\right)$。为了确定后验协方差 $S$，我们展开 $p(\\theta|y)$ 的指数并对 $\\theta$ 进行配方：\n$$\n\\begin{aligned}\nL(\\theta) = (y - J(c)\\theta)^T \\Sigma^{-1} (y - J(c)\\theta) + \\theta^T \\Gamma^{-1} \\theta \\\\\n= (y^T - \\theta^T J(c)^T) \\Sigma^{-1} (y - J(c)\\theta) + \\theta^T \\Gamma^{-1} \\theta \\\\\n= y^T \\Sigma^{-1} y - y^T \\Sigma^{-1} J(c)\\theta - \\theta^T J(c)^T \\Sigma^{-1} y + \\theta^T J(c)^T \\Sigma^{-1} J(c)\\theta + \\theta^T \\Gamma^{-1} \\theta\n\\end{aligned}\n$$\n由于 $\\Sigma^{-1}$ 是对称的，且项 $y^T \\Sigma^{-1} J(c)\\theta$ 是一个标量，它等于其转置 $\\theta^T J(c)^T \\Sigma^{-1} y$。按 $\\theta$ 的幂次对各项进行分组：\n$$\nL(\\theta) = \\theta^T \\left( J(c)^T \\Sigma^{-1} J(c) + \\Gamma^{-1} \\right) \\theta - 2y^T \\Sigma^{-1} J(c)\\theta + y^T \\Sigma^{-1} y\n$$\n将其与一般高斯 PDF 的指数 $-\\frac{1}{2}(\\theta^T S^{-1} \\theta - 2\\mu^T S^{-1} \\theta + \\mu^T S^{-1} \\mu)$ 进行比较，我们可以从 $\\theta$ 的二次项中识别出后验协方差矩阵的逆，也称为后验精度矩阵：\n$$\nS^{-1} = J(c)^T \\Sigma^{-1} J(c) + \\Gamma^{-1}\n$$\n因此，后验协方差矩阵 $S$ 是该表达式的逆：\n$$\nS(c, \\Sigma, \\Gamma) = \\left( J(c)^T \\Sigma^{-1} J(c) + \\Gamma^{-1} \\right)^{-1}\n$$\n这就是推导出的近似后验协方差矩阵的表达式。问题不要求计算后验均值，因此我们无需计算它。\n\n计算过程如下：\n对于每个由三元组 $(c, \\alpha, \\beta)$ 定义的测试用例，我们执行以下步骤：\n1.  根据问题陈述定义基础矩阵 $A, B, C, D, \\Sigma_1, \\Sigma_2, \\Gamma_u, \\Gamma_v$。\n2.  构造缩放后的先验协方差 $\\Gamma = \\alpha \\cdot \\operatorname{blkdiag}(\\Gamma_u, \\Gamma_v)$ 和缩放后的噪声协方差 $\\Sigma = \\beta \\cdot \\operatorname{blkdiag}(\\Sigma_1, \\Sigma_2)$。块对角构造使用提供的 $2 \\times 2$ 矩阵作为完整的 $4 \\times 4$ 矩阵的对角块。\n3.  构造雅可比矩阵 $J(c) = \\begin{bmatrix} A  cC \\\\ cD  B \\end{bmatrix}$。当 $c=0$ 时，雅可比矩阵变为块对角矩阵：$J(0) = \\begin{bmatrix} A  \\mathbf{0} \\\\ \\mathbf{0}  B \\end{bmatrix}$。\n4.  计算矩阵的逆 $\\Gamma^{-1}$ 和 $\\Sigma^{-1}$。\n5.  计算后验精度矩阵 $H = J(c)^T \\Sigma^{-1} J(c) + \\Gamma^{-1}$。\n6.  对精度矩阵求逆以获得后验协方差矩阵：$S = H^{-1}$。\n7.  将 $4 \\times 4$ 矩阵 $S$ 划分为四个 $2 \\times 2$ 的块，与 $\\theta = [u; v]$ 的分块方式一致：\n    $$\n    S = \\begin{bmatrix} S_{uu}  S_{uv} \\\\ S_{vu}  S_{vv} \\end{bmatrix}\n    $$\n8.  计算后验互相关矩阵 $\\mathrm{Corr}_{uv}$。这需要用后验标准差来归一化互协方差块 $S_{uv}$。对 $u$ 的归一化矩阵是 $N_u = \\operatorname{diag}(S_{uu})^{-\\frac{1}{2}}$，对 $v$ 的归一化矩阵是 $N_v = \\operatorname{diag}(S_{vv})^{-\\frac{1}{2}}$。这些对角矩阵的元素为 $(N_u)_{ii} = 1/\\sqrt{(S_{uu})_{ii}}$ 和 $(N_v)_{jj} = 1/\\sqrt{(S_{vv})_{jj}}$。于是互相关矩阵为：\n    $$\n    \\mathrm{Corr}_{uv} = N_u S_{uv} N_v\n    $$\n9.  计算所得互相关矩阵的弗罗贝尼乌斯范数：\n    $$\n    \\|\\mathrm{Corr}_{uv}\\|_{F} = \\sqrt{\\sum_{i=1}^{2}\\sum_{j=1}^{2} \\left(\\mathrm{Corr}_{uv}\\right)_{ij}^{2}}\n    $$\n10. 测试用例的最终结果是此范数，四舍五入到六位小数。\n\n作为一个概念性检验，考虑耦合常数 $c=0$ 的情况。雅可比矩阵 $J(0)$ 是块对角矩阵。由于先验协方差 $\\Gamma$ 和噪声协方差 $\\Sigma$ 也都是块对角矩阵，后验精度矩阵 $S^{-1}$ 也将是块对角矩阵。它的逆，即后验协方差 $S$，也必须是块对角矩阵。这意味着非对角块 $S_{uv}$ 将是一个零矩阵。因此，$\\mathrm{Corr}_{uv}$ 是一个零矩阵，其弗罗贝尼乌斯范数为 $0$。这证实了在物理模型中没有耦合的情况下，两个子系统的参数是后验不相关的，这与问题设置的预期相符。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Frobenius norm of the posterior cross-correlation matrix\n    for a set of test cases in a linearized multiphysics inverse problem.\n    \"\"\"\n    # Define the base matrices as given in the problem statement.\n    A = np.array([[1.0, 0.2], [0.3, 1.5]])\n    B = np.array([[1.2, -0.1], [0.0, 0.9]])\n    C = np.array([[0.5, 0.1], [-0.2, 0.4]])\n    D = np.array([[-0.3, 0.2], [0.6, 0.1]])\n\n    Sigma_1 = np.array([[0.04, 0.0], [0.0, 0.01]])\n    Sigma_2 = np.array([[0.09, 0.0], [0.0, 0.09]])\n\n    Gamma_u = np.array([[0.5, 0.1], [0.1, 0.7]])\n    Gamma_v = np.array([[0.6, -0.05], [-0.05, 0.8]])\n    \n    # Define the test cases as (c, alpha, beta).\n    test_cases = [\n        (0.0, 1.0, 1.0),\n        (0.25, 1.0, 1.0),\n        (1.0, 1.0, 1.0),\n        (1.0, 1.0, 10.0),\n        (4.0, 2.0, 0.5),\n    ]\n\n    results = []\n    \n    # Helper to create a 4x4 block diagonal matrix from two 2x2 blocks\n    def block_diag(block1, block2):\n        mat = np.zeros((4, 4))\n        mat[0:2, 0:2] = block1\n        mat[2:4, 2:4] = block2\n        return mat\n\n    for case in test_cases:\n        c, alpha, beta = case\n\n        # 1. Construct the problem matrices for the current test case.\n        # Jacobian J(c)\n        J_c = np.block([\n            [A, c * C],\n            [c * D, B]\n        ])\n\n        # Prior covariance Gamma\n        Gamma = alpha * block_diag(Gamma_u, Gamma_v)\n        \n        # Noise covariance Sigma\n        Sigma = beta * block_diag(Sigma_1, Sigma_2)\n        \n        # 2. Compute the posterior covariance S = (J^T * Sigma^-1 * J + Gamma^-1)^-1\n        try:\n            Gamma_inv = np.linalg.inv(Gamma)\n            Sigma_inv = np.linalg.inv(Sigma)\n        except np.linalg.LinAlgError:\n            results.append(np.nan)\n            continue\n            \n        # Posterior precision matrix (inverse of posterior covariance)\n        H = J_c.T @ Sigma_inv @ J_c + Gamma_inv\n        \n        try:\n            # Posterior covariance matrix S\n            S = np.linalg.inv(H)\n        except np.linalg.LinAlgError:\n            results.append(np.nan)\n            continue\n\n        # 3. Partition S and extract sub-blocks\n        S_uu = S[0:2, 0:2]\n        S_uv = S[0:2, 2:4]\n        S_vv = S[2:4, 2:4]\n\n        # 4. Compute the posterior cross-correlation matrix Corr_uv\n        diag_S_uu = np.diag(S_uu)\n        diag_S_vv = np.diag(S_vv)\n        \n        # Check for non-positive variances before taking square root\n        if np.any(diag_S_uu = 0) or np.any(diag_S_vv = 0):\n            results.append(np.nan) # Mathematically impossible for a valid covariance matrix\n            continue\n        \n        # Normalization matrices: diag(M)^(-1/2)\n        norm_mat_u = np.diag(1.0 / np.sqrt(diag_S_uu))\n        norm_mat_v = np.diag(1.0 / np.sqrt(diag_S_vv))\n        \n        Corr_uv = norm_mat_u @ S_uv @ norm_mat_v\n        \n        # 5. Compute the Frobenius norm of Corr_uv\n        frob_norm = np.linalg.norm(Corr_uv, 'fro')\n        \n        # 6. Append the rounded result.\n        results.append(round(frob_norm, 6))\n\n    # Format the final output as specified\n    print(results)\n\nsolve()\n```", "id": "3511225"}]}