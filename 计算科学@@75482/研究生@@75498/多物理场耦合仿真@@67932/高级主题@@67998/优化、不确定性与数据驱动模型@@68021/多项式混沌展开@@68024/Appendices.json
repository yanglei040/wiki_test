{"hands_on_practices": [{"introduction": "多项式混沌展开的复杂性和计算成本，直接取决于所选多项式基函数集合的大小。这个练习将带你深入理解PCE基底的组合结构，特别是总次数截断方法。通过从第一性原理推导基函数数量的公式并系统地列出它们[@problem_id:3523172]，你将对PCE的构建模块有一个具体而深入的认识。", "problem": "考虑一个多物理场仿真中耦合的热弹性-流体系统的非侵入式多项式混沌展开 (PCE)。不确定性输入由一个随机向量 $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$ 建模，该向量具有 $d$ 个独立分量，对应五个材料和耦合参数 ($d=5$)。为构建一个有限维近似，您使用一个总阶截断多重指标集，定义为\n$$\n\\Lambda_{\\mathrm{TD}}(p) \\equiv \\left\\{ \\alpha \\in \\mathbb{N}_{0}^{d} : \\|\\alpha\\|_{1} \\le p \\right\\},\n$$\n其中 $\\|\\alpha\\|_{1} = \\sum_{i=1}^{d} \\alpha_{i}$ 且 $p$ 是最大多项式阶数 ($p=3$)。PCE 基函数由 $\\alpha \\in \\Lambda_{\\mathrm{TD}}(p)$ 索引，并关于输入测度正交。\n\n从多重指标的基本定义和组合计数（可重复组合）的第一性原理出发，推导在 $d=5$ 和 $p=3$ 条件下指标集 $\\Lambda_{\\mathrm{TD}}(p)$ 的基数，且不使用任何预先记忆的快捷公式。然后，按字典序明确地枚举所有满足 $\\|\\alpha\\|_{1} \\le 3$ 的多重指标 $\\alpha \\in \\mathbb{N}_{0}^{5}$。", "solution": "该问题要求推导一个总阶截断多重指标集的基数，并为一个特定情况明确枚举其元素。该集合定义为 $\\Lambda_{\\mathrm{TD}}(p) \\equiv \\left\\{ \\alpha \\in \\mathbb{N}_{0}^{d} : \\|\\alpha\\|_{1} \\le p \\right\\}$，其中维度 $d=5$，最大多项式阶数 $p=3$。\n\n首先，我们按照要求，从组合计数的第一性原理出发，推导 $\\Lambda_{\\mathrm{TD}}(p)$ 的基数，记为 $|\\Lambda_{\\mathrm{TD}}(p)|$。条件是对于一个多重指标 $\\alpha = (\\alpha_1, \\alpha_2, \\dots, \\alpha_d)$，其中每个 $\\alpha_i$ 是非负整数，其和必须满足 $\\sum_{i=1}^{d} \\alpha_i \\le p$。\n\n通过引入一个辅助的非负整数变量 $\\alpha_{d+1} \\in \\mathbb{N}_0$（通常称为松弛变量），可以将这个不等式转化为一个等式。我们定义 $\\alpha_{d+1}$ 使得其和恰好等于 $p$：\n$$\n\\alpha_1 + \\alpha_2 + \\dots + \\alpha_d + \\alpha_{d+1} = p\n$$\n对于任何满足原不等式 $\\sum_{i=1}^{d} \\alpha_i = k \\le p$ 的非负整数集 $(\\alpha_1, \\dots, \\alpha_d)$，都存在一个唯一的非负整数 $\\alpha_{d+1} = p - k$ 来满足该等式。反之，对于该等式的任何非负整数解 $(\\alpha_1, \\dots, \\alpha_d, \\alpha_{d+1})$，其前 $d$ 个分量满足原不等式。因此，$d$ 个变量的不等式的解的数量与 $d+1$ 个变量的等式的非负整数解的数量相同。\n\n后一个问题是一个经典的组合问题，称为“可重复组合”，可以使用“隔板法”来解决。我们需要找到将和 $p$ 分成 $d+1$ 个非负整数项的方法数。这等价于将 $p$ 个相同的物品（星）和 $(d+1)-1 = d$ 个相同的分隔物（隔板）排成一列。序列中的总位置数为 $p+d$。选择 $d$ 个隔板（或等价地，$p$ 个星）的位置的方法数决定了唯一解的数量。这个计数由二项式系数给出：\n$$\n|\\Lambda_{\\mathrm{TD}}(p)| = \\binom{p+d}{d} = \\binom{p+d}{p}\n$$\n这个从基本的隔板法类比得出的推导，满足了不使用预先记忆的快捷公式的要求。\n\n现在，我们将此推导出的公式应用于给定的具体参数：$d=5$ 和 $p=3$。\n$$\n|\\Lambda_{\\mathrm{TD}}(3)| = \\binom{3+5}{5} = \\binom{8}{5}\n$$\n二项式系数的值计算如下：\n$$\n\\binom{8}{5} = \\frac{8!}{5!(8-5)!} = \\frac{8!}{5!3!} = \\frac{8 \\times 7 \\times 6}{3 \\times 2 \\times 1} = 8 \\times 7 = 56\n$$\n对于 $d=5$ 的情况，指标集 $\\Lambda_{\\mathrm{TD}}(3)$ 的基数是 $56$。\n\n其次，我们明确枚举所有满足 $\\alpha_i \\in \\mathbb{N}_0$ 和 $\\sum_{i=1}^{5} \\alpha_i \\le 3$ 的 $56$ 个多重指标 $\\alpha = (\\alpha_1, \\alpha_2, \\alpha_3, \\alpha_4, \\alpha_5)$。枚举结果按字典序呈现。\n\n完整的多重指标列表如下：\n$ (0,0,0,0,0), (0,0,0,0,1), (0,0,0,0,2), (0,0,0,0,3), (0,0,0,1,0), (0,0,0,1,1), (0,0,0,1,2), (0,0,0,2,0), (0,0,0,2,1), (0,0,0,3,0), (0,0,1,0,0), (0,0,1,0,1), (0,0,1,0,2), (0,0,1,1,0), (0,0,1,1,1), (0,0,1,2,0), (0,0,2,0,0), (0,0,2,0,1), (0,0,2,1,0), (0,0,3,0,0), (0,1,0,0,0), (0,1,0,0,1), (0,1,0,0,2), (0,1,0,1,0), (0,1,0,1,1), (0,1,0,2,0), (0,1,1,0,0), (0,1,1,0,1), (0,1,1,1,0), (0,1,2,0,0), (0,2,0,0,0), (0,2,0,0,1), (0,2,0,1,0), (0,2,1,0,0), (0,3,0,0,0), (1,0,0,0,0), (1,0,0,0,1), (1,0,0,0,2), (1,0,0,1,0), (1,0,0,1,1), (1,0,0,2,0), (1,0,1,0,0), (1,0,1,0,1), (1,0,1,1,0), (1,0,2,0,0), (1,1,0,0,0), (1,1,0,0,1), (1,1,0,1,0), (1,1,1,0,0), (1,2,0,0,0), (2,0,0,0,0), (2,0,0,0,1), (2,0,0,1,0), (2,0,1,0,0), (2,1,0,0,0), (3,0,0,0,0) $", "answer": "$$\n\\boxed{56}\n$$", "id": "3523172"}, {"introduction": "理论必须与实践相结合。在理解了PCE的基底之后，我们来关注一个核心问题：如何计算展开式中的系数。这个练习[@problem_id:3523191]将指导你实现伪谱投影法，这是一种高效的非侵入式技术。通过使用数值求积法来计算系数并验证其准确性，你将在连续的数学理论和其离散的计算实现之间建立起一座关键的桥梁。", "problem": "考虑一个随机输入向量 $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$，其分量是独立同分布的标准正态随机变量。令 $\\{\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\}_{\\alpha \\in \\mathbb{N}_{0}^{d}}$ 表示由概率学家 Hermite 多项式构建的张量化正交多项式混沌基。也就是说，对于一个多重索引 $\\alpha = (\\alpha_{1},\\dots,\\alpha_{d})$，定义\n$$\n\\Psi_{\\alpha}(\\boldsymbol{\\xi}) \\;=\\; \\prod_{k=1}^{d} \\psi_{\\alpha_{k}}(\\xi_{k}),\n$$\n其中 $\\psi_{n}(\\xi)$ 是标准正态测度下的 $n$ 次一维正交多项式。概率学家 Hermite 多项式 $\\mathrm{He}_{n}(\\xi)$ 满足递推关系：$\\mathrm{He}_{0}(\\xi)=1$，$\\mathrm{He}_{1}(\\xi)=\\xi$，以及当 $n \\geq 1$ 时，$\\mathrm{He}_{n+1}(\\xi)=\\xi\\,\\mathrm{He}_{n}(\\xi) - n\\,\\mathrm{He}_{n-1}(\\xi)$。正交多项式为 $\\psi_{n}(\\xi) = \\mathrm{He}_{n}(\\xi)/\\sqrt{n!}$，由此得到 $\\mathbb{E}[\\psi_{m}(\\xi)\\psi_{n}(\\xi)] = \\delta_{mn}$，因此 $\\mathbb{E}[\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\Psi_{\\beta}(\\boldsymbol{\\xi})] = \\delta_{\\alpha\\beta}$。\n\n伪谱投影通过以下方式计算平方可积模型响应 $u(\\boldsymbol{\\xi})$ 的多项式混沌系数：\n$$\nc_{\\alpha} \\;=\\; \\mathbb{E}\\big[u(\\boldsymbol{\\xi})\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\big],\n$$\n对于所选截断中的所有多重索引 $\\alpha$。考虑总次数截断集\n$$\n\\mathcal{A}_{p}^{(d)} \\;=\\; \\Big\\{ \\alpha \\in \\mathbb{N}_{0}^{d} \\,:\\, \\sum_{k=1}^{d} \\alpha_{k} \\leq p \\Big\\},\n$$\n其中 $p \\in \\mathbb{N}_{0}$ 为指定的总次数，$d \\in \\mathbb{N}$ 为维度。\n\n为了近似计算期望，使用由一维 Gauss–Hermite 法则构建的张量积 Gauss–Hermite 求积法，并通过变量替换将用于积分 $\\int_{\\mathbb{R}} f(x)\\,e^{-x^{2}}\\,dx$ 的 Gauss–Hermite 横坐标和权重映射到标准正态期望 $\\mathbb{E}[f(\\xi)]$。得到的张量积求积法应对任何多变量多项式精确，前提是该多项式在每个坐标上的次数最多为 $2m-1$，其中 $m$ 是一维 Gauss–Hermite 点的数量。你的程序必须：\n- 实现伪谱投影，使用张量积求积法计算所有 $\\alpha \\in \\mathcal{A}_{p}^{(d)}$ 的系数 $c_{\\alpha}$。\n- 从第一性原理出发，确定并报告为精确积分总次数为 $p$ 的投影中出现的任何多项式乘积所需的最小一维求积阶数 $m$（即每个维度的 Gauss–Hermite 点数），以及张量积节点的总数 $M = m^{d}$。\n- 对于给定的测试套件（如下所述），将 $u(\\boldsymbol{\\xi})$ 构建为具有已知系数的有限混沌展开，并通过报告最大绝对系数误差来数值验证计算出的系数与真实系数是否匹配。\n\n测试套件。对于以下每个参数集 $(d,p)$，将 $u(\\boldsymbol{\\xi}) = \\sum_{\\alpha \\in \\mathcal{A}_{p}^{(d)}} c_{\\alpha}^{\\mathrm{true}}\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})$ 的真实非零系数 $\\{c_{\\alpha}^{\\mathrm{true}}\\}$ 定义为所列出的值。任何未明确列出的系数均为零。对于每种情况，计算：\n- 最小一维求积阶数 $m$。\n- 张量积节点的总数 $M = m^{d}$。\n- 最大绝对差 $\\max_{\\alpha \\in \\mathcal{A}_{p}^{(d)}} |c_{\\alpha}^{\\mathrm{quad}} - c_{\\alpha}^{\\mathrm{true}}|$。\n\n使用以下案例：\n- 案例 A：$d = 1$，$p = 3$，其中\n  $c_{(0)}^{\\mathrm{true}} = 1.3$, $c_{(1)}^{\\mathrm{true}} = -0.7$, $c_{(2)}^{\\mathrm{true}} = 0.5$, $c_{(3)}^{\\mathrm{true}} = -0.2$。\n- 案例 B：$d = 2$，$p = 2$，其中\n  $c_{(0,0)}^{\\mathrm{true}} = 0.9$, $c_{(1,0)}^{\\mathrm{true}} = -0.4$, $c_{(0,1)}^{\\mathrm{true}} = 0.75$, $c_{(2,0)}^{\\mathrm{true}} = 0.3$, $c_{(0,2)}^{\\mathrm{true}} = -0.35$, $c_{(1,1)}^{\\mathrm{true}} = 0.25$。\n- 案例 C：$d = 3$，$p = 3$，其中\n  $c_{(0,0,0)}^{\\mathrm{true}} = 1.0$, $c_{(1,0,0)}^{\\mathrm{true}} = -0.2$, $c_{(0,1,0)}^{\\mathrm{true}} = 0.15$, $c_{(0,0,1)}^{\\mathrm{true}} = 0.1$, $c_{(2,0,0)}^{\\mathrm{true}} = 0.05$, $c_{(0,2,0)}^{\\mathrm{true}} = -0.04$, $c_{(0,0,2)}^{\\mathrm{true}} = 0.03$, $c_{(1,1,0)}^{\\mathrm{true}} = -0.06$, $c_{(1,0,1)}^{\\mathrm{true}} = 0.07$, $c_{(0,1,1)}^{\\mathrm{true}} = -0.02$, $c_{(3,0,0)}^{\\mathrm{true}} = 0.01$, $c_{(0,3,0)}^{\\mathrm{true}} = -0.008$, $c_{(0,0,3)}^{\\mathrm{true}} = 0.006$, $c_{(2,1,0)}^{\\mathrm{true}} = 0.004$。\n- 案例 D：$d = 2$，$p = 0$，其中\n  $c_{(0,0)}^{\\mathrm{true}} = 2.5$。\n\n输出规范。你的程序必须生成单行输出，其中包含一个扁平的、逗号分隔的列表，按 A、B、C、D 的顺序列出各个案例的结果。对于每个案例，按顺序附加：\n- 最小一维求积阶数 $m$（一个整数），\n- 张量积节点的总数 $M$（一个整数），\n- 最大绝对系数误差（一个浮点数）。\n\n因此，最终输出必须是形如 [m_A,M_A,err_A,m_B,M_B,err_B,m_C,M_C,err_C,m_D,M_D,err_D] 的单个列表，除了表示该列表所必需的内容外，不包含任何额外的文本或空白字符。", "solution": "我们从一个随机输入 $\\boldsymbol{\\xi} \\in \\mathbb{R}^{d}$ 开始，其分量是独立的标准正态随机变量。在此测度下，概率学家 Hermite 多项式 $\\mathrm{He}_{n}(\\xi)$ 构成一个相对于标准正态密度的正交族。通过定义正交一维基 $\\psi_{n}(\\xi) = \\mathrm{He}_{n}(\\xi)/\\sqrt{n!}$，我们获得了 $d$ 维下的正交张量基：\n$$\n\\Psi_{\\alpha}(\\boldsymbol{\\xi}) \\;=\\; \\prod_{k=1}^{d} \\psi_{\\alpha_{k}}(\\xi_{k}), \\qquad \\alpha \\in \\mathbb{N}_{0}^{d},\n$$\n根据独立性和一维正交性，它满足 $\\mathbb{E}\\big[\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\Psi_{\\beta}(\\boldsymbol{\\xi})\\big] = \\delta_{\\alpha\\beta}$。\n\n对于一个平方可积的模型响应 $u(\\boldsymbol{\\xi})$，伪谱投影将模式 $\\alpha$ 的系数定义为\n$$\nc_{\\alpha} \\;=\\; \\mathbb{E}\\big[u(\\boldsymbol{\\xi})\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\big] \\;=\\; \\int_{\\mathbb{R}^{d}} u(\\boldsymbol{\\xi})\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\, \\prod_{k=1}^{d} \\phi(\\xi_{k})\\,d\\boldsymbol{\\xi},\n$$\n其中 $\\phi(\\xi)$ 是标准正态密度。出于计算目的，这个期望使用张量积 Gauss–Hermite 求积法则来近似。一个具有 $m$ 个点的一维 Gauss–Hermite 法则可以精确地积分任何次数至多为 $2m-1$ 的多项式 $q$ 的 $\\int_{\\mathbb{R}} q(x)e^{-x^{2}}dx$。为了将其应用于标准正态期望，我们使用变量替换 $\\xi = \\sqrt{2}\\,x$，得到\n$$\n\\mathbb{E}[f(\\xi)] \\;=\\; \\frac{1}{\\sqrt{\\pi}} \\int_{\\mathbb{R}} f(\\sqrt{2}\\,x)\\,e^{-x^{2}}\\,dx.\n$$\n因此，如果 $\\{(x_{i},w_{i})\\}_{i=1}^{m}$ 是针对 $e^{-x^{2}}$ 的 Gauss–Hermite 节点和权重，我们得到期望的求积近似为：\n$$\n\\mathbb{E}[f(\\xi)] \\;\\approx\\; \\frac{1}{\\sqrt{\\pi}} \\sum_{i=1}^{m} w_{i}\\, f\\big(\\sqrt{2}\\,x_{i}\\big).\n$$\n在具有独立坐标的 $d$ 维空间中，张量积求积法得到\n$$\n\\mathbb{E}[f(\\boldsymbol{\\xi})] \\;\\approx\\; \\frac{1}{\\pi^{d/2}} \\sum_{i_{1}=1}^{m}\\cdots\\sum_{i_{d}=1}^{m} \\Big(\\prod_{k=1}^{d} w_{i_{k}}\\Big) \\, f\\big(\\sqrt{2}\\,x_{i_{1}},\\dots,\\sqrt{2}\\,x_{i_{d}}\\big).\n$$\n\n最小求积阶数。我们考虑截断基集 $\\mathcal{A}_{p}^{(d)} = \\{\\alpha \\in \\mathbb{N}_{0}^{d}: \\sum_{k=1}^{d}\\alpha_{k}\\le p\\}$。对于每个系数，\n$$\nc_{\\alpha} \\;=\\; \\mathbb{E}\\big[u(\\boldsymbol{\\xi})\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})\\big].\n$$\n当 $u(\\boldsymbol{\\xi})$ 本身是一个总次数至多为 $p$ 的多项式混沌时：\n$$\nu(\\boldsymbol{\\xi}) \\;=\\; \\sum_{\\beta \\in \\mathcal{A}_{p}^{(d)}} c_{\\beta}^{\\mathrm{true}}\\, \\Psi_{\\beta}(\\boldsymbol{\\xi}),\n$$\n被积函数 $u(\\boldsymbol{\\xi})\\Psi_{\\alpha}(\\boldsymbol{\\xi})$ 是两个正交多项式的乘积。作为每个坐标 $\\xi_{k}$ 的函数，该乘积是一个多项式，其在 $\\xi_{k}$ 上的次数至多为 $\\alpha_{k} + \\beta_{k} \\le 2p$，并且所有坐标的总次数也至多为 $2p$。每个维度有 $m$ 个点的 $d$ 维张量积 Gauss–Hermite 法则对于任何被积函数都是精确的，只要该被积函数（相对于 $e^{-x^{2}}$）在每个坐标上都是一个次数至多为 $2m-1$ 的多项式。在向标准正态测度的变量替换下，每个坐标的次数保持不变。因此，为了对任意 $\\alpha,\\beta \\in \\mathcal{A}_{p}^{(d)}$ 精确地积分所有这类乘积，只需满足\n$$\n2m - 1 \\;\\ge\\; 2p \\quad \\Longleftrightarrow \\quad m \\;\\ge\\; p + 1/2,\n$$\n并且最小一维求积阶数为 $m_{\\min} = p + 1$。张量积节点的总数为 $M = m^{d} = (p+1)^{d}$。\n\n算法设计。对于每个测试案例 $(d,p)$：\n- 构建多重索引集 $\\mathcal{A}_{p}^{(d)}$。\n- 计算 $m = p+1$ 和 $M = m^{d}$。\n- 为权重 $e^{-x^{2}}$ 生成一维 Gauss–Hermite 节点和权重 $\\{(x_{i},w_{i})\\}_{i=1}^{m}$，并通过 $\\xi_{i} = \\sqrt{2}\\,x_{i}$ 和 $\\tilde{w}_{i} = w_{i}/\\sqrt{\\pi}$ 将它们转换为标准正态求积节点和权重。\n- 构造节点和权重的 $d$ 维张量积。\n- 使用概率学家 Hermite 多项式 $\\mathrm{He}_{n}(\\xi)$ 的递推关系和 $\\sqrt{n!}$ 的归一化，计算一维正交多项式 $\\psi_{n}(\\xi)$（对于 $n=0,\\dots,p$）在每个维度求积横坐标上的值。\n- 通过对相应的 $\\Psi_{\\beta}(\\boldsymbol{\\xi})$ 贡献求和，使用给定的真实系数在求积网格上合成 $u(\\boldsymbol{\\xi})$。\n- 对于每个 $\\alpha \\in \\mathcal{A}_{p}^{(d)}$，在网格上评估 $\\Psi_{\\alpha}(\\boldsymbol{\\xi})$ 并将 $c_{\\alpha}^{\\mathrm{quad}}$ 计算为加权和 $c_{\\alpha}^{\\mathrm{quad}} \\approx \\sum w^{(d)}\\, u(\\boldsymbol{\\xi})\\,\\Psi_{\\alpha}(\\boldsymbol{\\xi})$。\n- 与真实系数进行比较并报告最大绝对误差。\n\n验证。因为 $u$ 是一个总次数至多为 $p$ 的多项式混沌，并且我们选择 $m = p+1$，所以张量积 Gauss–Hermite 法则对于投影中出现的逐坐标多项式次数是精确的。因此，在不考虑浮点舍入误差的情况下，我们预期对于所有 $\\alpha \\in \\mathcal{A}_{p}^{(d)}$ 都有 $c_{\\alpha}^{\\mathrm{quad}} = c_{\\alpha}^{\\mathrm{true}}$，从而产生的最大绝对误差在机器精度的量级。程序将为每个案例输出元组 $(m, M, \\max_{\\alpha}|c_{\\alpha}^{\\mathrm{quad}} - c_{\\alpha}^{\\mathrm{true}}|)$，并按规定连接成一个单一的方括号列表。", "answer": "```python\nimport numpy as np\nimport math\nfrom itertools import product\n\ndef hermite_probabilists_orthonormal_values(x, nmax):\n    \"\"\"\n    Compute values of orthonormal probabilists' Hermite polynomials psi_n at points x,\n    for n = 0..nmax. Returns an array of shape (nmax+1, len(x)).\n    psi_n = He_n / sqrt(n!), with He_0=1, He_1=x, He_{n+1} = x He_n - n He_{n-1}.\n    \"\"\"\n    x = np.asarray(x)\n    N = nmax + 1\n    vals = np.zeros((N, x.size), dtype=float)\n    # He_0\n    He_nm1 = np.ones_like(x)\n    vals[0, :] = He_nm1 / math.sqrt(math.factorial(0))\n    if nmax == 0:\n        return vals\n    # He_1\n    He_n = x.copy()\n    vals[1, :] = He_n / math.sqrt(math.factorial(1))\n    for n in range(1, nmax):\n        He_np1 = x * He_n - n * He_nm1\n        vals[n+1, :] = He_np1 / math.sqrt(math.factorial(n+1))\n        He_nm1, He_n = He_n, He_np1\n    return vals\n\ndef multiindex_total_degree(d, p):\n    \"\"\"\n    Generate all multi-indices alpha in N_0^d with total degree sum(alpha) = p.\n    Order: lexicographic increasing by alpha.\n    \"\"\"\n    indices = []\n    for alpha in product(range(p + 1), repeat=d):\n        if sum(alpha) = p:\n            indices.append(tuple(alpha))\n    return indices\n\ndef tensor_product_gh_quadrature(d, m):\n    \"\"\"\n    Construct d-dimensional tensor product Gauss-Hermite quadrature for standard normal expectation.\n    One-dimensional rule: nodes x_i, weights w_i integrate \\int f(x) e^{-x^2} dx exactly up to deg 2m-1.\n    Transform to standard normal: xi_i = sqrt(2) * x_i, wtilde_i = w_i / sqrt(pi).\n    Returns grid nodes of shape (num_nodes, d) and weights of shape (num_nodes,).\n    \"\"\"\n    # 1D Gauss-Hermite for e^{-x^2}\n    x1d, w1d = np.polynomial.hermite.hermgauss(m)  # nodes/weights for e^{-x^2}\n    # Transform to standard normal expectation weights\n    xi1d = np.sqrt(2.0) * x1d\n    w1d_tilde = w1d / math.sqrt(math.pi)\n    # Tensor product\n    grids = np.meshgrid(*([xi1d] * d), indexing='ij')\n    nodes = np.stack([g.reshape(-1) for g in grids], axis=1)\n    # Weights as product\n    wg = w1d_tilde\n    wgrids = np.meshgrid(*([wg] * d), indexing='ij')\n    weights = np.ones_like(wgrids[0])\n    for wg_comp in wgrids:\n        weights = weights * wg_comp\n    weights = weights.reshape(-1)\n    return nodes, weights, xi1d, w1d_tilde\n\ndef build_u_on_grid(d, p, coeffs_true, xi1d, basis1d_cache):\n    \"\"\"\n    Build u on the full tensor grid using the chaos expansion with given true coefficients.\n    coeffs_true: dict mapping multiindex tuple to coefficient.\n    xi1d: 1D nodes per dimension (same across dims).\n    basis1d_cache: list of size d, each entry is (vals), where vals has shape (p+1, m).\n    Returns u_grid array of shape (m,)*d.\n    \"\"\"\n    m = xi1d.size\n    shape = (m,) * d\n    u_grid = np.zeros(shape, dtype=float)\n    # For broadcasting per dim, precompute basis grids per dim and degree\n    # B[k][n] has shape (m,)*d, storing psi_n evaluated along dimension k and broadcast on others.\n    B = []\n    for k in range(d):\n        vals_k = basis1d_cache[k]  # shape (p+1, m)\n        Bk = []\n        for n in range(p+1):\n            vec = vals_k[n, :]  # length m\n            resh = [1]*d\n            resh[k] = m\n            arr = vec.reshape(resh)\n            # Broadcast to full grid lazily during multiplication\n            Bk.append(arr)\n        B.append(Bk)\n    # Sum contributions\n    for alpha, c in coeffs_true.items():\n        if sum(alpha) > p:\n            continue  # outside truncation\n        phi = np.ones(shape, dtype=float)\n        for k in range(d):\n            phi = phi * B[k][alpha[k]]\n        u_grid += c * phi\n    return u_grid\n\ndef project_coefficients(d, p, u_grid, w_grid, xi1d, basis1d_cache, indices):\n    \"\"\"\n    Compute coefficients c_alpha via quadrature for alpha in indices.\n    u_grid: values of u on tensor grid of shape (m,)*d.\n    w_grid: tensor product weights on the same grid shape.\n    basis1d_cache: list per dim with shape (p+1, m).\n    indices: list of multi-indices to project.\n    Returns a dict mapping alpha to c_alpha.\n    \"\"\"\n    m = xi1d.size\n    shape = (m,) * d\n    # Precompute B grids as in build_u_on_grid\n    B = []\n    for k in range(d):\n        vals_k = basis1d_cache[k]  # shape (p+1, m)\n        Bk = []\n        for n in range(p+1):\n            vec = vals_k[n, :]  # length m\n            resh = [1]*d\n            resh[k] = m\n            arr = vec.reshape(resh)\n            Bk.append(arr)\n        B.append(Bk)\n    c = {}\n    for alpha in indices:\n        phi = np.ones(shape, dtype=float)\n        for k in range(d):\n            phi = phi * B[k][alpha[k]]\n        # Weighted inner product E[u * Psi_alpha]\n        val = np.sum(w_grid * u_grid * phi)\n        c[alpha] = float(val)\n    return c\n\ndef run_case(d, p, coeffs_true):\n    # Minimal quadrature level and total nodes\n    m = p + 1\n    nodes, weights, xi1d, w1d_tilde = tensor_product_gh_quadrature(d, m)\n    # Build tensor weight grid\n    m1 = xi1d.size\n    wgrids = np.meshgrid(*([w1d_tilde]*d), indexing='ij')\n    w_grid = np.ones_like(wgrids[0])\n    for wg in wgrids:\n        w_grid = w_grid * wg\n    # Basis values per dimension\n    basis1d_cache = [hermite_probabilists_orthonormal_values(xi1d, p) for _ in range(d)]\n    # Build u on grid\n    u_grid = build_u_on_grid(d, p, coeffs_true, xi1d, basis1d_cache)\n    # Multi-indices\n    indices = multiindex_total_degree(d, p)\n    # Project\n    c_quad = project_coefficients(d, p, u_grid, w_grid, xi1d, basis1d_cache, indices)\n    # Prepare true coefficients vector aligned with indices\n    true_vec = np.array([coeffs_true.get(alpha, 0.0) for alpha in indices], dtype=float)\n    quad_vec = np.array([c_quad[alpha] for alpha in indices], dtype=float)\n    max_err = float(np.max(np.abs(true_vec - quad_vec))) if indices else 0.0\n    M = m ** d\n    return m, M, max_err\n\ndef solve():\n    # Define test cases\n    # Case A: d=1, p=3\n    coeffs_A = {\n        (0,): 1.3,\n        (1,): -0.7,\n        (2,): 0.5,\n        (3,): -0.2,\n    }\n    # Case B: d=2, p=2\n    coeffs_B = {\n        (0,0): 0.9,\n        (1,0): -0.4,\n        (0,1): 0.75,\n        (2,0): 0.3,\n        (0,2): -0.35,\n        (1,1): 0.25,\n    }\n    # Case C: d=3, p=3\n    coeffs_C = {\n        (0,0,0): 1.0,\n        (1,0,0): -0.2,\n        (0,1,0): 0.15,\n        (0,0,1): 0.1,\n        (2,0,0): 0.05,\n        (0,2,0): -0.04,\n        (0,0,2): 0.03,\n        (1,1,0): -0.06,\n        (1,0,1): 0.07,\n        (0,1,1): -0.02,\n        (3,0,0): 0.01,\n        (0,3,0): -0.008,\n        (0,0,3): 0.006,\n        (2,1,0): 0.004,\n    }\n    # Case D: d=2, p=0\n    coeffs_D = {\n        (0,0): 2.5,\n    }\n\n    test_cases = [\n        (1, 3, coeffs_A),\n        (2, 2, coeffs_B),\n        (3, 3, coeffs_C),\n        (2, 0, coeffs_D),\n    ]\n\n    results = []\n    for d, p, coeffs in test_cases:\n        m, M, err = run_case(d, p, coeffs)\n        results.append(str(m))\n        results.append(str(M))\n        # Format error with sufficient precision but concise\n        results.append(f\"{err:.16g}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3523191"}, {"introduction": "多项式混沌展开的真正威力，在于我们能从其系数中提取出深刻的物理洞见。最后一个练习[@problem_id:3523157]将展示如何利用一个已知的PCE模型进行完整的全局敏感度分析。我们将直接从系数出发，推导并计算模型的总方差和索博尔指数（Sobol' indices），这清晰地揭示了PCE在不确定性量化中最具吸引力的优势之一。", "problem": "在一个共轭传热-热弹性耦合问题中，一个降阶模型用于预测一个微型换热器在不确定的热学和力学边界条件下的稳态界面温度响应 $u(\\boldsymbol{\\xi})$。不确定性输入被映射为三个独立的标准化变量 $\\boldsymbol{\\xi}=(\\xi_{1},\\xi_{2},\\xi_{3})$，其中 $\\xi_{i}\\sim \\mathcal{U}[-1,1]$ 且相互独立。一个多项式混沌展开 (Polynomial Chaos Expansion, PCE) 将模型输出表示为\n$$\nu(\\boldsymbol{\\xi})=\\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\,\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}),\n$$\n其中 $\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})=\\prod_{i=1}^{3}\\varphi_{\\alpha_{i}}(\\xi_{i})$，而 $\\{\\varphi_{n}\\}_{n\\ge 0}$ 是区间 $[-1,1]$ 上关于均匀测度的标准正交勒让德多项式，即 $\\mathbb{E}[\\varphi_{n}(\\xi)\\varphi_{m}(\\xi)]=\\delta_{nm}$ 且 $\\varphi_{0}(\\xi)=1$。因此，该多元基是标准正交的：$\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})]=\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$。通过非侵入式PCE标定获得的非零系数为\n- $c_{(0,0,0)}=2$,\n- $c_{(1,0,0)}=\\frac{1}{2}$, $c_{(0,1,0)}=-\\frac{1}{4}$, $c_{(0,0,1)}=\\frac{1}{8}$,\n- $c_{(2,0,0)}=\\frac{1}{4}$, $c_{(0,2,0)}=-\\frac{1}{8}$, $c_{(0,0,2)}=\\frac{1}{16}$,\n- $c_{(1,1,0)}=\\frac{1}{8}$, $c_{(1,0,1)}=-\\frac{1}{16}$, $c_{(0,1,1)}=\\frac{1}{32}$, $c_{(1,1,1)}=-\\frac{1}{32}$,\n所有其他 $c_{\\boldsymbol{\\alpha}}$ 均为零。\n\n基于基的正交性、方差的定义 $\\mathbb{V}[u]=\\mathbb{E}\\big[(u-\\mathbb{E}[u])^{2}\\big]$ 以及基于方差的全局灵敏度分析的定义（一阶Sobol指数 $S_{i}=\\mathbb{V}\\big(\\mathbb{E}[u\\mid \\xi_{i}]\\big)/\\mathbb{V}[u]$ 和全局Sobol指数 $S_{T_{i}}=1-\\mathbb{V}\\big(\\mathbb{E}[u\\mid \\boldsymbol{\\xi}_{\\sim i}]\\big)/\\mathbb{V}[u]$，其中 $\\boldsymbol{\\xi}_{\\sim i}$ 表示除 $\\xi_{i}$ 之外的所有输入），完成以下任务：\n\n1. 推导用系数 $c_{\\boldsymbol{\\alpha}}$ 表示的 $\\mathbb{V}[u]$ 的表达式。\n2. 推导一阶Sobol指数 $S_{i}$ 的表达式，用与仅依赖于变量 $\\xi_{i}$ 的多重指标 $\\boldsymbol{\\alpha}$ 相关联的 $c_{\\boldsymbol{\\alpha}}^{2}$ 的和来表示。\n3. 推导全局Sobol指数 $S_{T_{i}}$ 的表达式，用与满足 $\\alpha_{i}>0$ 的多重指标 $\\boldsymbol{\\alpha}$ 相关联的 $c_{\\boldsymbol{\\alpha}}^{2}$ 的和来表示。\n4. 使用所给的系数，计算当 $i\\in\\{1,2,3\\}$ 时推导出的表达式的值。\n\n将最终答案表示为一个单行矩阵\n$$\n\\big[\\ \\mathbb{V}[u],\\ S_{1},\\ S_{2},\\ S_{3},\\ S_{T_{1}},\\ S_{T_{2}},\\ S_{T_{3}}\\ \\big]\n$$\n其值为精确的最简分数。无需四舍五入，也无需报告单位。", "solution": "在尝试求解之前，对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 模型输出：$u(\\boldsymbol{\\xi})$，其中 $\\boldsymbol{\\xi}=(\\xi_{1},\\xi_{2},\\xi_{3})$。\n- 输入变量：$\\xi_{i}$ 独立同分布于 $\\xi_{i}\\sim \\mathcal{U}[-1,1]$，对于 $i=1, 2, 3$。\n- 多项式混沌展开 (PCE)：$u(\\boldsymbol{\\xi})=\\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\,\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})$。\n- 基函数：$\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})=\\prod_{i=1}^{3}\\varphi_{\\alpha_{i}}(\\xi_{i})$。\n- 单变量多项式：$\\{\\varphi_{n}\\}_{n\\ge 0}$ 是 $[-1,1]$ 上的标准正交勒让德多项式，满足 $\\mathbb{E}[\\varphi_{n}(\\xi)\\varphi_{m}(\\xi)]=\\delta_{nm}$ 且 $\\varphi_{0}(\\xi)=1$。\n- 多元基性质：基 $\\{\\psi_{\\boldsymbol{\\alpha}}\\}$ 是标准正交的，$\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\psi_{\\boldsymbol{\\beta}}(\\boldsymbol{\\xi})]=\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$。\n- 非零PCE系数 ($c_{\\boldsymbol{\\alpha}}$)：\n  - $c_{(0,0,0)}=2$\n  - $c_{(1,0,0)}=\\frac{1}{2}$, $c_{(0,1,0)}=-\\frac{1}{4}$, $c_{(0,0,1)}=\\frac{1}{8}$\n  - $c_{(2,0,0)}=\\frac{1}{4}$, $c_{(0,2,0)}=-\\frac{1}{8}$, $c_{(0,0,2)}=\\frac{1}{16}$\n  - $c_{(1,1,0)}=\\frac{1}{8}$, $c_{(1,0,1)}=-\\frac{1}{16}$, $c_{(0,1,1)}=\\frac{1}{32}$\n  - $c_{(1,1,1)}=-\\frac{1}{32}$\n- 所有其他系数 $c_{\\boldsymbol{\\alpha}}$ 均为零。\n- 定义：\n  - 方差：$\\mathbb{V}[u]=\\mathbb{E}\\big[(u-\\mathbb{E}[u])^{2}\\big]$。\n  - 一阶Sobol指数：$S_{i}=\\mathbb{V}\\big(\\mathbb{E}[u\\mid \\xi_{i}]\\big)/\\mathbb{V}[u]$。\n  - 全局Sobol指数：$S_{T_{i}}=1-\\mathbb{V}\\big(\\mathbb{E}[u\\mid \\boldsymbol{\\xi}_{\\sim i}]\\big)/\\mathbb{V}[u]$，其中 $\\boldsymbol{\\xi}_{\\sim i}$ 表示除 $\\xi_{i}$ 之外的所有输入。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于不确定性量化理论，特别是使用多项式混沌展开进行灵敏度分析。这是计算科学与工程中一个标准且成熟的方法论。\n- **适定性：** 所有必要的信息，包括展开的形式、基函数的性质以及所有非零系数的数值，都已提供。任务定义清晰，并可导出一个唯一的解。\n- **客观性：** 该问题以精确的数学术语表述，没有任何主观性或模糊性。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答\n\n解答过程需要依次完成四个任务：用PCE系数推导总方差、一阶Sobol指数和全局Sobol指数的表达式，然后计算这些量的值。\n\n**1. 方差 $\\mathbb{V}[u]$ 的推导**\n\n首先计算模型输出 $u(\\boldsymbol{\\xi})$ 的均值。利用期望算子的线性性和基函数的标准正交性：\n$$\n\\mathbb{E}[u] = \\mathbb{E}\\left[\\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\right] = \\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})]\n$$\n由于 $\\psi_{\\boldsymbol{0}}(\\boldsymbol{\\xi})=\\varphi_{0}(\\xi_1)\\varphi_{0}(\\xi_2)\\varphi_{0}(\\xi_3)=1 \\cdot 1 \\cdot 1 = 1$，基函数的期望为：\n$$\n\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})] = \\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\\psi_{\\boldsymbol{0}}(\\boldsymbol{\\xi})] = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{0}}\n$$\n其中 $\\boldsymbol{0} = (0,0,0)$ 是零多重指标。因此，均值就是第一个系数：\n$$\n\\mathbb{E}[u] = \\sum_{\\boldsymbol{\\alpha}\\in \\mathbb{N}_{0}^{3}} c_{\\boldsymbol{\\alpha}}\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{0}} = c_{\\boldsymbol{0}} = c_{(0,0,0)}\n$$\n方差定义为 $\\mathbb{V}[u] = \\mathbb{E}[u^2] - (\\mathbb{E}[u])^2$。我们计算均方值 $\\mathbb{E}[u^2]$：\n$$\n\\mathbb{E}[u^2] = \\mathbb{E}\\left[\\left(\\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\alpha}}\\right)\\left(\\sum_{\\boldsymbol{\\beta}} c_{\\boldsymbol{\\beta}}\\psi_{\\boldsymbol{\\beta}}\\right)\\right] = \\sum_{\\boldsymbol{\\alpha},\\boldsymbol{\\beta}} c_{\\boldsymbol{\\alpha}}c_{\\boldsymbol{\\beta}}\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\beta}}]\n$$\n利用标准正交性 $\\mathbb{E}[\\psi_{\\boldsymbol{\\alpha}}\\psi_{\\boldsymbol{\\beta}}] = \\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}}$：\n$$\n\\mathbb{E}[u^2] = \\sum_{\\boldsymbol{\\alpha},\\boldsymbol{\\beta}} c_{\\boldsymbol{\\alpha}}c_{\\boldsymbol{\\beta}}\\delta_{\\boldsymbol{\\alpha}\\boldsymbol{\\beta}} = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}}^2\n$$\n将这些结果代入方差公式，得到：\n$$\n\\mathbb{V}[u] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}}^2 - c_{\\boldsymbol{0}}^2 = \\sum_{\\boldsymbol{\\alpha}\\neq\\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\n$$\n这就是所求的总方差表达式。\n\n**2. 一阶Sobol指数 $S_i$ 的推导**\n\n一阶Sobol指数为 $S_i = \\mathbb{V}_i / \\mathbb{V}[u]$，其中 $\\mathbb{V}_i = \\mathbb{V}[\\mathbb{E}[u \\mid \\xi_i]]$。我们首先计算条件期望 $\\mathbb{E}[u \\mid \\xi_i]$：\n$$\n\\mathbb{E}[u \\mid \\xi_i] = \\mathbb{E}\\left[\\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\xi_i \\right] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\mathbb{E}\\left[\\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\xi_i \\right]\n$$\n由于变量 $\\xi_j$ 的独立性，条件期望变为：\n$$\n\\mathbb{E}\\left[\\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\xi_i \\right] = \\varphi_{\\alpha_i}(\\xi_i) \\prod_{j \\neq i} \\mathbb{E}[\\varphi_{\\alpha_j}(\\xi_j)]\n$$\n由于 $\\mathbb{E}[\\varphi_{\\alpha_j}(\\xi_j)] = \\delta_{\\alpha_j, 0}$，仅当对所有 $j \\neq i$ 都有 $\\alpha_j = 0$ 时，乘积 $\\prod_{j \\neq i} \\delta_{\\alpha_j, 0}$ 才非零（且等于1）。这将求和限制在那些最多只有一个非零分量，且该分量必须在位置 $i$ 上的多重指标。\n令 $\\mathcal{A}_i = \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_0^3 \\mid \\alpha_j = 0, \\forall j \\neq i\\}$。那么：\n$$\nu_i \\equiv \\mathbb{E}[u \\mid \\xi_i] = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i} c_{\\boldsymbol{\\alpha}} \\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi}) = \\sum_{k=0}^{\\infty} c_{(0,..,k,..,0)} \\varphi_k(\\xi_i)\n$$\n方差 $\\mathbb{V}_i = \\mathbb{V}[u_i]$ 是这个部分和的方差。其均值为 $\\mathbb{E}[u_i]=\\mathbb{E}[\\mathbb{E}[u|\\xi_i]]=\\mathbb{E}[u]=c_{\\boldsymbol{0}}$。使用与总方差相同的逻辑：\n$$\n\\mathbb{V}_i = \\mathbb{E}[u_i^2] - (\\mathbb{E}[u_i])^2 = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i} c_{\\boldsymbol{\\alpha}}^2 - c_{\\boldsymbol{0}}^2 = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\n$$\n这个和包含了其多重指标仅与变量 $\\xi_i$ 相关的系数的平方。所以，一阶指数为：\n$$\nS_i = \\frac{\\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{A}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2}\n$$\n\n**3. 全局Sobol指数 $S_{T_i}$ 的推导**\n\n全局Sobol指数为 $S_{T_i} = 1 - \\mathbb{V}[\\mathbb{E}[u \\mid \\boldsymbol{\\xi}_{\\sim i}]] / \\mathbb{V}[u]$。我们计算对除 $\\xi_i$ 以外的所有变量（记为 $\\boldsymbol{\\xi}_{\\sim i}$）的条件期望：\n$$\n\\mathbb{E}[u \\mid \\boldsymbol{\\xi}_{\\sim i}] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\mathbb{E}\\left[\\prod_{j=1}^3 \\varphi_{\\alpha_j}(\\xi_j) \\mid \\boldsymbol{\\xi}_{\\sim i} \\right] = \\sum_{\\boldsymbol{\\alpha}} c_{\\boldsymbol{\\alpha}} \\left(\\prod_{j \\neq i} \\varphi_{\\alpha_j}(\\xi_j) \\right) \\mathbb{E}[\\varphi_{\\alpha_i}(\\xi_i)]\n$$\n同样，$\\mathbb{E}[\\varphi_{\\alpha_i}(\\xi_i)] = \\delta_{\\alpha_i, 0}$。求和被限制在 $\\alpha_i = 0$ 的指标 $\\boldsymbol{\\alpha}$ 上。令 $\\mathcal{B}_i = \\{\\boldsymbol{\\alpha} \\in \\mathbb{N}_0^3 \\mid \\alpha_i=0 \\}$。那么：\n$$\nu_{\\sim i} \\equiv \\mathbb{E}[u \\mid \\boldsymbol{\\xi}_{\\sim i}] = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i} c_{\\boldsymbol{\\alpha}} \\psi_{\\boldsymbol{\\alpha}}(\\boldsymbol{\\xi})\n$$\n这一项的方差是 $\\mathbb{V}[u_{\\sim i}] = \\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2$。然后，\n$$\nS_{T_i} = 1 - \\frac{\\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2} = \\frac{\\left(\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2\\right) - \\left(\\sum_{\\boldsymbol{\\alpha} \\in \\mathcal{B}_i, \\boldsymbol{\\alpha} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2\\right)}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2}\n$$\n所有非零多重指标的集合 $\\{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}\\}$ 可以被划分为 $\\beta_i=0$ 的部分（即 $\\mathcal{B}_i \\setminus \\{\\boldsymbol{0}\\}$）和 $\\beta_i  0$ 的部分。分子是所有满足 $\\alpha_i  0$ 的多重指标 $\\boldsymbol{\\alpha}$ 对应的 $c_{\\boldsymbol{\\alpha}}^2$ 的和。\n$$\nS_{T_i} = \\frac{\\sum_{\\boldsymbol{\\alpha} \\text{ with } \\alpha_i  0} c_{\\boldsymbol{\\alpha}}^2}{\\sum_{\\boldsymbol{\\beta} \\neq \\boldsymbol{0}} c_{\\boldsymbol{\\beta}}^2}\n$$\n\n**4. 表达式求值**\n\n首先，我们计算总方差 $\\mathbb{V}[u] = \\sum_{\\boldsymbol{\\alpha}\\neq\\boldsymbol{0}} c_{\\boldsymbol{\\alpha}}^2$。给定的非零系数（对于 $\\boldsymbol{\\alpha} \\neq \\boldsymbol{0}$）的平方是：\n- $c_{(1,0,0)}^2 = (\\frac{1}{2})^2 = \\frac{1}{4}$\n- $c_{(0,1,0)}^2 = (-\\frac{1}{4})^2 = \\frac{1}{16}$\n- $c_{(0,0,1)}^2 = (\\frac{1}{8})^2 = \\frac{1}{64}$\n- $c_{(2,0,0)}^2 = (\\frac{1}{4})^2 = \\frac{1}{16}$\n- $c_{(0,2,0)}^2 = (-\\frac{1}{8})^2 = \\frac{1}{64}$\n- $c_{(0,0,2)}^2 = (\\frac{1}{16})^2 = \\frac{1}{256}$\n- $c_{(1,1,0)}^2 = (\\frac{1}{8})^2 = \\frac{1}{64}$\n- $c_{(1,0,1)}^2 = (-\\frac{1}{16})^2 = \\frac{1}{256}$\n- $c_{(0,1,1)}^2 = (\\frac{1}{32})^2 = \\frac{1}{1024}$\n- $c_{(1,1,1)}^2 = (-\\frac{1}{32})^2 = \\frac{1}{1024}$\n$\\mathbb{V}[u] = \\frac{1}{4} + \\frac{1}{16} + \\frac{1}{64} + \\frac{1}{16} + \\frac{1}{64} + \\frac{1}{256} + \\frac{1}{64} + \\frac{1}{256} + \\frac{1}{1024} + \\frac{1}{1024}$\n$\\mathbb{V}[u] = \\frac{256+64+16+64+16+4+16+4+1+1}{1024} = \\frac{442}{1024} = \\frac{221}{512}$.\n\n接下来，我们计算用于 $S_i$ 的部分方差：\n- $\\mathbb{V}_1 = c_{(1,0,0)}^2 + c_{(2,0,0)}^2 = \\frac{1}{4} + \\frac{1}{16} = \\frac{5}{16}$.\n- $\\mathbb{V}_2 = c_{(0,1,0)}^2 + c_{(0,2,0)}^2 = \\frac{1}{16} + \\frac{1}{64} = \\frac{5}{64}$.\n- $\\mathbb{V}_3 = c_{(0,0,1)}^2 + c_{(0,0,2)}^2 = \\frac{1}{64} + \\frac{1}{256} = \\frac{5}{256}$.\n$S_1 = \\frac{5/16}{221/512} = \\frac{5}{16} \\cdot \\frac{512}{221} = \\frac{5 \\cdot 32}{221} = \\frac{160}{221}$.\n$S_2 = \\frac{5/64}{221/512} = \\frac{5}{64} \\cdot \\frac{512}{221} = \\frac{5 \\cdot 8}{221} = \\frac{40}{221}$.\n$S_3 = \\frac{5/256}{221/512} = \\frac{5}{256} \\cdot \\frac{512}{221} = \\frac{5 \\cdot 2}{221} = \\frac{10}{221}$.\n\n最后，我们计算用于 $S_{T_i}$ 的部分方差：\n- $\\mathbb{V}_{T_1} = c_{(1,0,0)}^2+c_{(2,0,0)}^2+c_{(1,1,0)}^2+c_{(1,0,1)}^2+c_{(1,1,1)}^2 = \\frac{1}{4}+\\frac{1}{16}+\\frac{1}{64}+\\frac{1}{256}+\\frac{1}{1024} = \\frac{256+64+16+4+1}{1024} = \\frac{341}{1024}$.\n- $\\mathbb{V}_{T_2} = c_{(0,1,0)}^2+c_{(0,2,0)}^2+c_{(1,1,0)}^2+c_{(0,1,1)}^2+c_{(1,1,1)}^2 = \\frac{1}{16}+\\frac{1}{64}+\\frac{1}{64}+\\frac{1}{1024}+\\frac{1}{1024} = \\frac{64+16+16+1+1}{1024} = \\frac{98}{1024} = \\frac{49}{512}$.\n- $\\mathbb{V}_{T_3} = c_{(0,0,1)}^2+c_{(0,0,2)}^2+c_{(1,0,1)}^2+c_{(0,1,1)}^2+c_{(1,1,1)}^2 = \\frac{1}{64}+\\frac{1}{256}+\\frac{1}{256}+\\frac{1}{1024}+\\frac{1}{1024} = \\frac{16+4+4+1+1}{1024} = \\frac{26}{1024} = \\frac{13}{512}$.\n$S_{T_1} = \\frac{341/1024}{442/1024} = \\frac{341}{442}$.\n$S_{T_2} = \\frac{49/512}{221/512} = \\frac{49}{221}$.\n$S_{T_3} = \\frac{13/512}{221/512} = \\frac{13}{221} = \\frac{1}{17}$.\n\n将最终结果整理成所要求的矩阵格式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{221}{512}  \\frac{160}{221}  \\frac{40}{221}  \\frac{10}{221}  \\frac{341}{442}  \\frac{49}{221}  \\frac{1}{17} \\end{pmatrix}}\n$$", "id": "3523157"}]}