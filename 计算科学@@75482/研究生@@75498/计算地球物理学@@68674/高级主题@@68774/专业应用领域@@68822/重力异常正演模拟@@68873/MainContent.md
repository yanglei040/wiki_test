## 引言
[重力异常](@entry_id:750038)正演模拟是[地球物理学](@entry_id:147342)中连接地下地质模型与地表重力观测数据的关键桥梁。它使我们能够量化特定地质构造（如矿体、盆地或俯冲带）所产生的[引力](@entry_id:175476)效应，是地质解释、资源勘探和[地球动力学](@entry_id:749832)研究的基石。然而，从抽象的物理定律到能够预测复杂地质现实的计算模型，存在一个知识鸿沟。如何将[牛顿引力](@entry_id:159796)理论转化为稳健的数值算法？如何利用这些算法解决从区域勘探到全球尺度的多样化问题？本文旨在系统性地解答这些问题，为读者构建一个从理论到实践的完整知识框架。

在接下来的内容中，我们将分三步深入探索这一领域。第一章“原理与机制”将奠定理论基础，从[引力场](@entry_id:169425)的物理本质和泊松方程出发，详细介绍空间域和波数域的正演模[拟核](@entry_id:178267)心算法。第二章“应用与跨学科联系”将视野扩展到实际应用，展示正演模拟如何在解决地质构造解释、[大地测量学](@entry_id:272545)以及多物理场[联合反演](@entry_id:750950)等前沿问题中发挥作用。最后，在第三章“动手实践”中，您将通过具体的编程练习，亲手实现并验证关键的正演模型，将理论知识转化为实践能力。让我们首先从构建这一切的基石——[引力场](@entry_id:169425)的基本原理与机制开始。

## 原理与机制

### [引力场](@entry_id:169425)基础

在[牛顿引力](@entry_id:159796)理论的框架下，任何有质量的物体都会在其周围空间产生一个[引力场](@entry_id:169425)。这个场的性质由两个密切相关的物理量来描述：标量**[引力势](@entry_id:160378)**（gravitational potential） $\phi(\mathbf{r})$ 和矢量**[引力](@entry_id:175476)加速度**（gravitational acceleration） $\mathbf{g}(\mathbf{r})$。理解这两个量及其关系是[重力正演模拟](@entry_id:750039)的出发点。

[引力势](@entry_id:160378) $\phi(\mathbf{r})$ 在物理上定义为将单位质量的测试物体从无穷远处（[势能](@entry_id:748988)基准点，通常设为零）移动到场点 $\mathbf{r}$ 所需做的功。对于一个由密度[分布](@entry_id:182848)为 $\rho(\mathbf{r}')$ 的连续体产生的[引力场](@entry_id:169425)，其在空间任意一点 $\mathbf{r}$ 的[引力势](@entry_id:160378)可以通过对所有质量微元 $dm' = \rho(\mathbf{r}') d^3\mathbf{r}'$ 的贡献进行积分得到。根据这一定义，并采用吸引势为负的惯例，[引力势](@entry_id:160378)的表达式为：
$$
\phi(\mathbf{r}) = -G \int_{\mathbb{R}^3} \frac{\rho(\mathbf{r}')}{\|\mathbf{r} - \mathbf{r}'\|} d^3\mathbf{r}'
$$
其中 $G$ 是[万有引力常数](@entry_id:262704)。此式表明，[引力势](@entry_id:160378)是一个标量场，其数值在空间中平滑变化。由于 $\rho \ge 0$ 和 $G > 0$，[引力势](@entry_id:160378) $\phi(\mathbf{r})$ 通常为负值或零，这形象地描绘了质量在空间中创造的“[势阱](@entry_id:151413)”。

[引力](@entry_id:175476)加速度 $\mathbf{g}(\mathbf{r})$ 则是放置在场点 $\mathbf{r}$ 的单位质量测试物体所受到的[引力](@entry_id:175476)。根据[牛顿万有引力定律](@entry_id:170220)，这个力指向源质量，因此[引力](@entry_id:175476)加速度的表达式为：
$$
\mathbf{g}(\mathbf{r}) = -G \int_{\mathbb{R}^3} \rho(\mathbf{r}') \frac{\mathbf{r} - \mathbf{r}'}{\|\mathbf{r} - \mathbf{r}'\|^3} d^3\mathbf{r}'
$$
这是一个矢量场，其在每一点的方向都指向[引力源](@entry_id:271552)。

[引力势](@entry_id:160378)和[引力](@entry_id:175476)加速度之间存在着深刻的内在联系。[引力场](@entry_id:169425)是一个**保守场**，这意味着[引力](@entry_id:175476)所做的功与路径无关，只取决于起点和终点。在数学上，这等价于[引力场](@entry_id:169425)可以表示为某个[标量场的梯度](@entry_id:270765)。具体地，[引力](@entry_id:175476)加速度是[引力势](@entry_id:160378)的负梯度：
$$
\mathbf{g}(\mathbf{r}) = -\nabla \phi(\mathbf{r})
$$
这个关系式至关重要，它意味着我们可以通过求解较为简单的[标量势](@entry_id:276177)场，然后通过求梯度来获得矢量[加速度场](@entry_id:266595)。负号表示物体会沿着[势能](@entry_id:748988)下降最快的方向加速，即“滚下”[势阱](@entry_id:151413)。

除了积分形式，我们还可以用[微分方程](@entry_id:264184)来描述[引力场](@entry_id:169425)。对关系式 $\mathbf{g} = -\nabla\phi$ 两边取散度，并结合[引力场](@entry_id:169425)的微分形式高斯定律 $\nabla \cdot \mathbf{g} = -4\pi G \rho$，我们可以得到描述[引力势](@entry_id:160378)的[偏微分方程](@entry_id:141332)：
$$
\nabla \cdot (-\nabla \phi) = -4\pi G \rho(\mathbf{r}) \quad \implies \quad \nabla^2 \phi(\mathbf{r}) = 4\pi G \rho(\mathbf{r})
$$
这就是著名的**泊松方程** (Poisson's equation)。它表明，[引力势](@entry_id:160378)场的[拉普拉斯算子](@entry_id:146319)与该点的质量密度成正比。在没有[质量分布](@entry_id:158451)的源外区域（$\rho(\mathbf{r}) = 0$），泊松方程简化为**[拉普拉斯方程](@entry_id:143689)** (Laplace's equation)：$\nabla^2 \phi(\mathbf{r}) = 0$。满足[拉普拉斯方程](@entry_id:143689)的函数被称为**[调和函数](@entry_id:746864)**，这揭示了[引力势](@entry_id:160378)在源外区域具有平滑且无[极值](@entry_id:145933)的特性。

最后，当观测点 $\mathbf{r}$ 远离一个总质量为 $M = \int \rho(\mathbf{r}') d^3\mathbf{r}'$ 的有限体积源时，$\|\mathbf{r}\| \gg \|\mathbf{r}'\|$，[引力势](@entry_id:160378)可以近似为：
$$
\phi(\mathbf{r}) \approx -\frac{GM}{\|\mathbf{r}\|}
$$
这与一个位于坐标原点的点质量所产生的势相同。这意味着在远处，任何有限大小的物体的[引力](@entry_id:175476)效应主要由其总质量决定，其内部复杂的结构变得次要。[@problem_id:3597401]

### [重力异常](@entry_id:750038)的概念

在地球物理勘探中，我们通常不关心由整个地球产生的绝对重力值，而是更关注由局部地质体密度变化引起的重[力场](@entry_id:147325)微小变化，即**[重力异常](@entry_id:750038)** (gravity anomaly)。这是因为这些异常直接反映了地下介质的非均匀性，例如矿床、盆地、断层等。

为了定义和计算[重力异常](@entry_id:750038)，我们首先引入一个**参考密度模型** $\rho_{\text{ref}}(\mathbf{x})$，它代表了我们已知的或假设的背景地球结构。实际地球的密度模型为 $\rho(\mathbf{x})$。两者的差异被称为**密度差** (density contrast)：
$$
\Delta\rho(\mathbf{x}) = \rho(\mathbf{x}) - \rho_{\text{ref}}(\mathbf{x})
$$
[重力异常](@entry_id:750038) $\delta\mathbf{g}$ 定义为观测到的重[力场](@entry_id:147325) $\mathbf{g}_{\text{obs}}$（由 $\rho(\mathbf{x})$ 产生）与参考模型预测的重[力场](@entry_id:147325) $\mathbf{g}_{\text{ref}}$（由 $\rho_{\text{ref}}(\mathbf{x})$ 产生）之差：
$$
\delta\mathbf{g}(\mathbf{x}) = \mathbf{g}_{\text{obs}}(\mathbf{x}) - \mathbf{g}_{\text{ref}}(\mathbf{x})
$$
一个核心原理是，在[牛顿引力](@entry_id:159796)理论中，[重力异常](@entry_id:750038)仅仅依赖于密度差 $\Delta\rho$，而与绝对密度无关。这是因为从密度到[引力场](@entry_id:169425)的正演映射是一个**线性算子** $\mathcal{F}$。根据[引力](@entry_id:175476)加速度的积分表达式，我们可以看到 $\mathbf{g} = \mathcal{F}[\rho]$ 是线性的，即 $\mathcal{F}[c_1\rho_1 + c_2\rho_2] = c_1\mathcal{F}[\rho_1] + c_2\mathcal{F}[\rho_2]$。因此：
$$
\delta\mathbf{g} = \mathcal{F}[\rho] - \mathcal{F}[\rho_{\text{ref}}] = \mathcal{F}[\rho - \rho_{\text{ref}}] = \mathcal{F}[\Delta\rho]
$$
这个性质（也称为**叠加原理**）是重力正演与反演的基石。它极大地简化了问题：我们只需对密度异常体进行建模，而无需对整个地球进行建模。一个直观的例子是，如果我们同时向真实模型和参考模型中添加一个相同的质量块，它们的密度差 $\Delta\rho$ 不变，因此计算出的[重力异常](@entry_id:750038)也保持不变。[@problem_id:3597398]

在实践中，将原始重力观测[数据转换](@entry_id:170268)为可供地质解释的[重力异常](@entry_id:750038)，需要进行一系列[标准化](@entry_id:637219)的校正，以剥离已知的、与地下目标地质体无关的[引力](@entry_id:175476)效应。

1.  **正常重力** (Normal Gravity): 首先，我们需要一个全球性的参考重[力场](@entry_id:147325)。这通常由一个与地球总质量和自转速率相匹配的旋转[椭球体](@entry_id:165811)（参考椭球体）来定义，其表面的理论重力值称为正常重力 $\gamma(\phi)$，它随纬度 $\phi$ 而变化。

2.  **自由空气异常** (Free-Air Anomaly): 测点通常位于参考[椭球体](@entry_id:165811)之上一定高程 $H$ 处。为了将测点观测值 $g_{\text{obs}}$ 与同一高程的理论值进行比较，需要进行**自由空气校正** (free-air correction)。该校正项近似为 $H \cdot (\partial\gamma/\partial h)$，其中 $\partial\gamma/\partial h \approx -0.3086 \, \text{mGal/m}$ 是正常重力的垂直梯度。自由空气异常 $\Delta g_{FA}$ 的计算方式是：
    $$
    \Delta g_{FA} = g_{\text{obs}} - (\gamma(\phi) + H \frac{\partial\gamma}{\partial h})
    $$
    该异常校正了测点高程的影响，但仍然包含了测点与参考水准面之间所有地形质量（如山脉）的[引力](@entry_id:175476)贡献。

3.  **布格异常** (Bouguer Anomaly): 为了分离出来自地下的异常，我们必须移除地形质量的[引力](@entry_id:175476)效应。最简单的**布格校正** (Bouguer correction) 是减去一个厚度为 $H$、密度为 $\rho_T$ 的无限大水平薄板（布格板）的[引力](@entry_id:175476)贡献，其值为 $2\pi G \rho_T H$。这样得到的异常称为（简单）布格异常 $\Delta g_B$。

4.  **完全布格异常** (Complete Bouguer Anomaly): 真实地形并非平坦的薄板。测点周围的山谷（相对于薄板的[质量亏损](@entry_id:139284)）和山峰（形状不规则）都会产生影响。**地形校正** (terrain correction) $\delta g_T$ 就是为了补偿布格板模型与真实地形之间的差异。地形校正值通常为正，加到简单布格异常上，得到完全布格异常 $\Delta g_{CB}$：
    $$
    \Delta g_{CB} = \Delta g_B + \delta g_T
    $$
    完全布格异常 $\Delta g_{CB}$ 已经移除了参考场、测点高程和地形质量的全部影响，因此它最能代表参考水准面（通常是[大地水准面](@entry_id:749836)）以下的地壳内部密度不[均匀性](@entry_id:152612)所产生的[引力](@entry_id:175476)效应。因此，当我们构建一个只包含地下密度异常体的正演模型时，其计算结果应该与完全布格异常进行比较。在地形平坦的地区，地形校正可以忽略不计，此时使用简单布格异常即可。[@problem_id:3597478]

### 空间域正演模拟

空间域正演模拟的目标是，给定一个描述地下密度差[分布](@entry_id:182848)的模型 $\Delta\rho(\mathbf{x})$，计算其在指定观测点产生的[重力异常](@entry_id:750038) $\delta\mathbf{g}$。

#### 简单几何体：球体

最简单的地质模型之一是均匀密度的球体。根据**[球壳定理](@entry_id:157834)**，任何球对称质量体对其外部一点产生的[引力](@entry_id:175476)，等效于将其全部[质量集中](@entry_id:175432)于球心的一点质量所产生的[引力](@entry_id:175476)。对于一个半径为 $a$、密度差为 $\Delta\rho$ 的球体，其异常质量为 $M = \frac{4}{3}\pi a^3 \Delta\rho$。在球心正上方距离为 $z$ 的一点，其垂直[重力异常](@entry_id:750038) $g_z$（定义向下为正）为：
$$
g_z(z) = \frac{GM}{z^2} = \frac{4\pi G a^3 \Delta\rho}{3z^2}
$$
这个简单的解析解为了解[重力异常](@entry_id:750038)的基本性质提供了极好的直觉。例如，它表明异常强度随距离的平方而迅速衰减。更有趣的是，我们可以用它来分析一个实际问题：一个完全埋藏于地下的球体（球心埋深为 $d$，且 $d \ge a$），其在地面正上方产生的[重力异常](@entry_id:750038)在何种埋深下最大？函数 $g_s(d) = C/d^2$ (其中 $C$ 是常数) 在其定义域 $d \in [a, \infty)$ 上是一个单调递减函数。因此，异常值在允许的最小埋深处取得最大值，即当球体顶部恰好接触地表时（$d=a$）。[@problem_id:3597410]

#### 复杂几何体：矩形棱柱法

对于任意复杂形状的地质体，通常没有解析解。标准的数值方法是将其**离散化**为许多规则形状的小单元，然后利用[线性叠加原理](@entry_id:196987)，将总异常计算为所有小单元贡献之和。在[重力模拟](@entry_id:750044)中，最常用的单元是**矩形棱柱** (rectangular prism)。

一个具有恒定密度差 $\Delta\rho_q$ 的矩形棱柱 $q$ 在观测点 $\mathbf{r}_n$ 产生的垂直[重力异常](@entry_id:750038) $g_{z,nq}$ 可以通过对其体积进行[三重积分](@entry_id:183331)得到。幸运的是，这个积分存在一个闭合的解析解。如果棱柱的坐标范围为 $[x_{q,1}, x_{q,2}] \times [y_{q,1}, y_{q,2}] \times [z_{q,1}, z_{q,2}]$，观测点坐标为 $(x_n, y_n, z_n)$，我们可以定义相对坐标 $X_i = x_{q,i} - x_n, Y_j = y_{q,j} - y_n, Z_k = z_{q,k} - z_n$，以及到各顶点的距离 $r_{ijk} = \sqrt{X_i^2+Y_j^2+Z_k^2}$。那么，该棱柱的贡献可以表示为对其8个顶点 $(i,j,k \in \{1,2\})$ 的一个函数求和：
$$
g_{z,nq} = G \Delta\rho_q \sum_{i=1}^2 \sum_{j=1}^2 \sum_{k=1}^2 (-1)^{i+j+k} \mu(X_i, Y_j, Z_k)
$$
其中，函数 $\mu$ 是一个包含对数和反正切项的复杂表达式：
$$
\mu(X, Y, Z) = -\left[ X\ln(Y+r) + Y\ln(X+r) - Z\arctan\left(\frac{XY}{Zr}\right) \right]
$$
这个公式（最早由 Nagy (1966) 和 Blakely (1995) 等人推广）是计算重力正演的核心。通过将地下模型剖分为成千上万个矩形棱柱，并对每个棱柱应用此公式求和，我们就能计算出任意复杂模型的重力响应。这个过程可以写成一个矩阵向量乘积 $\mathbf{g} = \mathbf{A}\boldsymbol{\rho}$，其中 $\boldsymbol{\rho}$ 是所有棱柱的密度向量，$\mathbf{g}$ 是所有测点的[重力异常](@entry_id:750038)向量，而矩阵 $\mathbf{A}$ 就是由上述解析解构成的**正演算子**或**敏感度矩阵**。[@problem_id:3597409]

一个直接的应用就是对**地形**的重力效应进行精确建模。在进行地形校正时，我们可以将数字高程模型（DEM）下方的地形体划分成一系列紧邻的矩形棱柱。每个棱柱的底面位于参考基准面（如 $z=0$），顶面高度由DEM给出。通过对所有这些棱柱（密度差为 $\rho_{\text{rock}} - \rho_{\text{air}}$）的[引力](@entry_id:175476)贡献求和，我们就能精确计算出地形的[引力](@entry_id:175476)效应，这比简单的布格板加地形校正更为精确。[@problem_id:3597456]

#### 奇异性处理

在数值实现矩形棱柱法时，一个必须处理的技术难题是**奇异性**。当观测点恰好位于某个棱柱的内部、边上或顶点上时，积分核中的分母 $\|\mathbf{r} - \mathbf{r}'\|^3$ 会出现零值，导致被积函数发散。

处理这个问题的一个有效方法是“挖洞法”：以[奇异点](@entry_id:199525) $\mathbf{x}$ 为中心，挖出一个半径为 $\eta$ 的小球 $B_\eta(\mathbf{x})$，将原棱柱 $C$ 的积分拆分为球内和球外两部分 $C \setminus B_\eta(\mathbf{x})$。球外部分的被积函数是有界的，可以用标准[数值积分](@entry_id:136578)计算。对于球内部分的积分，我们可以进行解析分析。对于[引力](@entry_id:175476)**加速度**核 $\frac{\mathbf{r} - \mathbf{r}'}{\|\mathbf{r} - \mathbf{r}'\|^3}$，由于其奇对称性，当在一个以[奇异点](@entry_id:199525)为中心对称的区域（如球体）上积分时，其结果恒为零：
$$
\int_{B_\eta(\mathbf{x})} \frac{\mathbf{x} - \mathbf{r}'}{\|\mathbf{x} - \mathbf{r}'\|^3} dV' = \mathbf{0}
$$
这意味着，当观测点位于源内部时，该点周围对称小球内的物质对其自身的[引力](@entry_id:175476)加速度贡献为零。因此，[引力](@entry_id:175476)加速度的总值就等于球外部分的积分。这个结论大大简化了奇异性处理。值得注意的是，这个优雅的抵消性质对[引力](@entry_id:175476)**势**核 $1/\|\mathbf{r}-\mathbf{r}'\|$ 是不成立的，其在球内的积分不为零。[@problem_id:3597425]

### 波数域正演模拟

除了在空间域直接积分，我们还可以在**波数域**（或频率域）进行正演模拟。这种方法对于具有特定几何形态（如层状介质）的模型尤其高效，并且能为我们理解位场的基本性质提供深刻的见解。

其理论基础源于[拉普拉斯方程](@entry_id:143689)在波数域的表达。对于源外区域（$\nabla^2 \Phi = 0$），对其进行关于水平坐标 $(x,y)$ 的[二维傅里叶变换](@entry_id:273583)，可以得到一个关于垂直坐标 $z$ 的常微分方程：
$$
\frac{d^2 \hat{\Phi}}{dz^2} - k^2 \hat{\Phi} = 0
$$
其中 $\hat{\Phi}(\mathbf{k}, z)$ 是[位场](@entry_id:143025)的二维傅里叶谱，$\mathbf{k}=(k_x, k_y)$ 是水平[波数](@entry_id:172452)矢量，$k = \|\mathbf{k}\|$ 是水平波数的大小。这个方程的通解是 $A e^{kz} + B e^{-kz}$。根据物理上的有界性条件（当 $z \to \infty$ 时位场应保持有界），我们必须舍弃增长的解，只保留衰减的解。因此，在 $z>0$ 的源外上半空间，[位场](@entry_id:143025)谱的垂直依赖关系为：
$$
\hat{\Phi}(\mathbf{k}, z) = \hat{\Phi}(\mathbf{k}, 0) \exp(-kz)
$$
这个关系被称为**[向上延拓](@entry_id:756371)** (upward continuation) 算子。它表明，从 $z=0$ 平面到更高 $z$ 平面的位场，其高频（大 $k$）成分会受到指数级的衰减。这解释了为什么离源越远，[位场](@entry_id:143025)异常就越平滑。

利用这个原理，我们可以推导层状介质的[重力异常](@entry_id:750038)谱。对于一个由多个界面 $z=h_i(x,y)$ 和密度差 $\Delta\rho_i$ 构成的模型，其在观测高度 $z_0$ 的垂直[重力异常](@entry_id:750038)谱 $\hat{g}_z$ 可以表示为所有界面起伏贡献之和：
$$
\hat{g}_z(\mathbf{k}, z_0) = 2\pi G \exp(-kz_0) \sum_i \Delta\rho_i \mathcal{F}[\exp(k h_i(x,y))]
$$
其中 $\mathcal{F}[\cdot]$ 表示[二维傅里叶变换](@entry_id:273583)。这个公式（Parker's formula）将[非线性](@entry_id:637147)的正演问题（因为界面深度 $h_i$ 在指数项内）转化为了一个在[波数](@entry_id:172452)域的直接计算，对于快速计算层状模型的重力响应非常有用。[@problem_id:3597471]

[波数](@entry_id:172452)域的分析也揭示了[重力反演](@entry_id:750042)的一个根本难题。[向上延拓](@entry_id:756371)是天然的低通滤波过程，而其逆过程——**[向下延拓](@entry_id:748654)** (downward continuation)，即从高处观测推断低处场值的过程——则需要在[波数](@entry_id:172452)域乘以一个指数增长的因子 $\exp(kz)$。当观测数据含有噪声时，这个因子会极大地放大高频噪声，导致结果极不稳定。这是一个典型的**[不适定问题](@entry_id:182873)** (ill-posed problem)。

为了解决这个问题，必须引入**正则化** (regularization) 技术。例如，**[吉洪诺夫正则化](@entry_id:140094)** (Tikhonov regularization) 通过在优化目标函数中加入一个惩罚[模型复杂度](@entry_id:145563)的稳定项来约束解。对于[向下延拓](@entry_id:748654)问题，正则化的解在波数域可以表示为一个滤波器作用于不稳定解上。例如，零阶[吉洪诺夫正则化](@entry_id:140094)解为：
$$
\hat{m}_\alpha(k) = \frac{\exp(kz_m)}{1 + \alpha^2 \exp(2kz_m)} \hat{d}(k)
$$
其中 $\hat{d}(k)$ 是在高度 $z_m$ 观测的数据谱，$\alpha$ 是正则化参数。这个滤波器在低频时接近不稳定的 $\exp(kz_m)$ 因子，但在高频时迅速衰减，从而抑制了噪声的放大，获得了稳定且有意义的解。更高阶的正则化（如惩罚梯度的范数）则会对高频施加更强的抑制。[@problem_id:3597464]

### 全球尺度建模：球谐函数

当研究范围从区域扩展到全球时，地球的曲率变得不可忽略，直角[坐标系](@entry_id:156346)不再适用。此时，最自然的数学工具是**[球谐函数](@entry_id:178380)** (spherical harmonics)。在[球坐标系](@entry_id:167517) $(r, \theta, \phi)$ 中，任何在球体外部满足拉普拉斯方程的[位场](@entry_id:143025)（如地球的外部引力势）都可以展开为球谐函数的级数：
$$
V(r, \theta, \phi) = \frac{GM}{r} \sum_{n=0}^{\infty} \left(\frac{a}{r}\right)^n \sum_{m=0}^{n} \bar{P}_{nm}(\cos\theta) \left[ \bar{C}_{nm}\cos(m\phi) + \bar{S}_{nm}\sin(m\phi) \right]
$$
其中 $a$ 是地球参考半径，$GM$ 是地心引力常数，$\bar{P}_{nm}$ 是完全[标准化](@entry_id:637219)的[缔合勒让德函数](@entry_id:173859)，$\bar{C}_{nm}$ 和 $\bar{S}_{nm}$ 是描述地球质量非[均匀分布](@entry_id:194597)的球谐系数。

[引力](@entry_id:175476)加速度的径向分量 $g_r$ 可以通过对势 $V$ 求 $r$ 的偏导数得到。由于 $V$ 的每一项对 $r$ 的依赖关系是 $r^{-(n+1)}$，求导后会得到 $-(n+1)r^{-(n+2)}$。因此，$g_r$ 的表达式为：
$$
g_r(r, \theta, \phi) = \frac{\partial V}{\partial r} = -\frac{GM}{r^2} \sum_{n=0}^{\infty} (n+1) \left(\frac{a}{r}\right)^n \sum_{m=0}^{n} \bar{P}_{nm}(\cos\theta) \left[ \dots \right]
$$
[球谐函数](@entry_id:178380)的**阶** $n$ 与空间波长 $\lambda$ 密切相关，近似关系为 $\lambda \approx 2\pi a/n$。低阶项 $(n$ 小) 对应长波特征，高阶项 $(n$ 大) 对应短波特征。

在实际应用中，球谐模型总是被截断到一个最大阶数 $L_{\max}$。这种截断相当于一个低通滤波器，所有波长短于约 $2\pi a/L_{\max}$ 的重[力场](@entry_id:147325)结构都会被滤除。这就是为什么高分辨率的全球重[力场](@entry_id:147325)模型需要展开到非常高的阶数（如 EGM2008 模型展开到了2160阶）。

此外，从 $g_r$ 的表达式可以看出，阶数为 $n$ 的项的振幅随半径 $r$ 的变化规律为 $r^{-(n+2)}$。这意味着，高阶（短波）信号比低阶（长波）信号随高度的增加衰减得更快。具体来说，在高度 $h$ 处的信号强度相对于地表 $(r=a)$ 的衰减因子为 $(a/(a+h))^{n+2}$。这一特性解释了为什么精细的[重力异常](@entry_id:750038)只能通过低空航空重力测量或低[轨道](@entry_id:137151)卫星（如 GOCE）才能探测到，而高[轨道](@entry_id:137151)卫星主要用于研究地球重[力场](@entry_id:147325)的长波成分。[@problem_id:3597396]