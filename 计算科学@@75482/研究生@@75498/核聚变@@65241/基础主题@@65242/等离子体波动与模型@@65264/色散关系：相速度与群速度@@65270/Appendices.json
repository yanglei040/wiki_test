{"hands_on_practices": [{"introduction": "为打下坚实的基础，我们从一个等离子体物理学中的经典问题入手：普通波（O-波）的传播。该练习将引导你从色散关系中推导出群速度，并分析其在临界截止频率附近的行为。掌握这种计算对于理解等离子体反射计等诊断技术至关重要，在这些技术中，波的传播特性被用来探测等离子体的密度分布。[@problem_id:3694650]", "problem": "考虑寻常电磁波模（O模）在冷、均匀、无磁化的电子等离子体中的传播，这与磁约束核聚变装置中的波注入和诊断相关。电子等离子体频率定义为 $\\omega_{pe}=\\sqrt{n_{e} e^{2}/(\\epsilon_{0} m_{e})}$，其中 $n_{e}$ 是电子数密度，$e$ 是元电荷，$\\epsilon_{0}$ 是真空介电常数，$m_{e}$ 是电子质量。对于O模，折射率 $n$ 满足色散关系 $n^{2}=1-\\omega_{pe}^{2}/\\omega^{2}$，其中 $\\omega$ 是波的角频率，$n\\equiv c k/\\omega$，$k$ 是波数，$c$ 是真空中的光速。相速度定义为 $v_{p}=\\omega/k$，群速度定义为 $v_{g}=\\mathrm{d}\\omega/\\mathrm{d}k$。\n\n仅使用这些基本定义和给定的O模色散关系，推导群速度在截止频率附近的行为，并证明当 $\\omega\\to\\omega_{pe}^{+}$ 时，$v_{g}\\to 0$。然后，引入小参数 $\\delta=\\omega/\\omega_{pe}-1$（其中 $\\delta0$），并计算当 $\\delta\\to 0^{+}$ 时 $v_{g}$ 随 $\\delta$ 变化的主导阶标度关系。将 $v_{g}$ 的最终答案用国际单位制（m/s）表示。不需要进行数值计算；仅提供主导阶项的闭式符号表达式。", "solution": "在进行解答之前，对问题陈述进行了严格验证。\n\n### 第1步：提取已知条件\n-   物理系统是冷、均匀、无磁化的电子等离子体。\n-   波模是寻常电磁波模（O模）。\n-   电子等离子体频率：$\\omega_{pe}=\\sqrt{n_{e} e^{2}/(\\epsilon_{0} m_{e})}$，其中 $n_{e}$ 是电子数密度，$e$ 是元电荷，$\\epsilon_{0}$ 是真空介电常数，$m_{e}$ 是电子质量。\n-   O模色散关系：$n^{2}=1-\\omega_{pe}^{2}/\\omega^{2}$。\n-   $\\omega$ 是波的角频率。\n-   折射率定义：$n\\equiv c k/\\omega$，其中 $k$ 是波数，$c$ 是真空中的光速。\n-   相速度定义：$v_{p}=\\omega/k$。\n-   群速度定义：$v_{g}=\\mathrm{d}\\omega/\\mathrm{d}k$。\n-   任务1：证明当 $\\omega\\to\\omega_{pe}^{+}$ 时，$v_{g}\\to 0$。\n-   任务2：定义小参数 $\\delta=\\omega/\\omega_{pe}-1$（其中 $\\delta0$），并计算当 $\\delta\\to 0^{+}$ 时 $v_{g}$ 随 $\\delta$ 变化的主导阶标度关系。\n-   任务3：将 $v_{g}$ 的最终答案用国际单位制（m/s）表示为主导阶项的闭式符号表达式。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了O模在冷、无磁化等离子体中的色散。所提供的方程，包括等离子体频率的定义和色散关系，是等离子体物理学中的标准和基本内容。该场景与核聚变研究中的应用（如波加热和诊断，例如反射计）直接相关。该问题是科学合理的。\n-   **适定性**：该问题是适定的。它提供了推导所需量所必需的所有定义和方程。目标明确，可以从所提供的信息中获得唯一解。\n-   **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。没有主观或基于意见的主张。\n-   **未检测到其他缺陷**：该问题是完整的、一致的、现实的（在冷等离子体的理想模型内），并且结构合理。\n\n### 第3步：结论与行动\n问题有效。将提供解答。\n\n### 解答推导\n\n分析从给定的O模色散关系和折射率的定义开始。\n色散关系由下式给出：\n$$n^{2} = 1 - \\frac{\\omega_{pe}^{2}}{\\omega^{2}}$$\n折射率 $n$ 定义为：\n$$n = \\frac{ck}{\\omega}$$\n将 $n$ 的定义代入色散关系，得到角频率 $\\omega$ 和波数 $k$ 之间的直接关系：\n$$\\left(\\frac{ck}{\\omega}\\right)^{2} = 1 - \\frac{\\omega_{pe}^{2}}{\\omega^{2}}$$\n两边乘以 $\\omega^{2}$ 得：\n$$c^{2}k^{2} = \\omega^{2} - \\omega_{pe}^{2}$$\n这可以重新排列以将 $\\omega$ 表示为 $k$ 的函数，这是色散关系的标准形式：\n$$\\omega^{2}(k) = \\omega_{pe}^{2} + c^{2}k^{2}$$\n为使波能够传播（即，$k$ 为实数），必须有 $\\omega^{2} \\ge \\omega_{pe}^{2}$，这意味着 $\\omega \\ge \\omega_{pe}$（因为 $\\omega$ 是非负的）。频率 $\\omega_{pe}$ 被称为截止频率。\n\n群速度 $v_{g}$ 定义为 $\\omega$ 对 $k$ 的导数：\n$$v_{g} = \\frac{\\mathrm{d}\\omega}{\\mathrm{d}k}$$\n为求此导数，我们将色散关系 $\\omega^{2} = \\omega_{pe}^{2} + c^{2}k^{2}$ 对 $k$ 求导：\n$$\\frac{\\mathrm{d}}{\\mathrm{d}k}(\\omega^{2}) = \\frac{\\mathrm{d}}{\\mathrm{d}k}(\\omega_{pe}^{2} + c^{2}k^{2})$$\n在左侧使用链式法则，并注意到 $\\omega_{pe}$ 和 $c$ 是常数，我们得到：\n$$2\\omega \\frac{\\mathrm{d}\\omega}{\\mathrm{d}k} = 2c^{2}k$$\n解出 $\\frac{\\mathrm{d}\\omega}{\\mathrm{d}k}$ 得到群速度：\n$$v_{g} = \\frac{c^{2}k}{\\omega}$$\n\n首先，我们分析 $v_{g}$ 在截止频率附近的行为，即当 $\\omega \\to \\omega_{pe}^{+}$ 时。根据色散关系 $\\omega^{2} = \\omega_{pe}^{2} + c^{2}k^{2}$，当 $\\omega$ 从上方趋近于 $\\omega_{pe}$ 时，项 $c^{2}k^{2} = \\omega^{2} - \\omega_{pe}^{2}$ 必然趋近于 $0$。由于 $c$ 是一个非零常数，这意味着 $k \\to 0^{+}$。现在我们可以计算 $v_{g}$ 的极限：\n$$\\lim_{\\omega \\to \\omega_{pe}^{+}} v_{g} = \\lim_{\\omega \\to \\omega_{pe}^{+}, k \\to 0^{+}} \\frac{c^{2}k}{\\omega} = \\frac{c^{2}(0)}{\\omega_{pe}} = 0$$\n这证明了群速度在截止频率处趋于零，符合要求。\n\n接下来，我们推导当小参数 $\\delta = \\omega/\\omega_{pe} - 1$（其中 $\\delta  0$ 且 $\\delta \\to 0^{+}$）时 $v_{g}$ 的主导阶标度关系。将 $v_{g}$ 表示为 $\\omega$ 的函数会很方便。一个简单的方法是结合使用关系式 $v_g = c^2k/\\omega$ 和色散关系的初始形式 $n = \\sqrt{1 - \\omega_{pe}^2/\\omega^2}$。由于 $n=ck/\\omega$，我们有 $k = \\omega n/c$。将此代入 $v_g$ 的表达式中：\n$$v_{g} = \\frac{c^{2}}{\\omega} \\left(\\frac{\\omega n}{c}\\right) = cn$$\n因此，群速度就是光速乘以折射率。\n$$v_{g} = c \\sqrt{1 - \\frac{\\omega_{pe}^{2}}{\\omega^{2}}}$$\n现在，我们引入参数 $\\delta$：\n$$\\delta = \\frac{\\omega}{\\omega_{pe}} - 1 \\implies \\frac{\\omega}{\\omega_{pe}} = 1 + \\delta \\implies \\frac{\\omega_{pe}}{\\omega} = \\frac{1}{1 + \\delta}$$\n将此代入 $v_{g}$ 的表达式中：\n$$v_{g} = c \\sqrt{1 - \\left(\\frac{1}{1 + \\delta}\\right)^{2}} = c \\sqrt{\\frac{(1+\\delta)^{2} - 1}{(1+\\delta)^{2}}}$$\n化简平方根下的项：\n$$v_{g} = c \\frac{\\sqrt{1 + 2\\delta + \\delta^{2} - 1}}{1 + \\delta} = c \\frac{\\sqrt{2\\delta + \\delta^{2}}}{1 + \\delta}$$\n为了找到当 $\\delta \\to 0^{+}$ 时的主导阶标度关系，我们可以从分子中提出 $\\delta$ 的最低次幂：\n$$v_{g} = c \\frac{\\sqrt{2\\delta(1 + \\delta/2)}}{1 + \\delta}$$\n对于非常小的 $\\delta$，项 $(1 + \\delta/2)$ 趋近于 $1$，分母中的项 $(1 + \\delta)$ 趋近于 $1$。更正式地，我们可以对小 $\\delta$ 展开表达式：\n$$v_{g} = c \\frac{\\sqrt{2\\delta}\\sqrt{1 + \\delta/2}}{1 + \\delta} = c \\sqrt{2\\delta} \\cdot (1 + \\delta/2)^{1/2} \\cdot (1 + \\delta)^{-1}$$\n对于小 $x$，使用二项式近似 $(1+x)^{a} \\approx 1+ax$：\n$$(1 + \\delta/2)^{1/2} \\approx 1 + \\frac{1}{2}\\left(\\frac{\\delta}{2}\\right) = 1 + \\frac{\\delta}{4}$$\n$$(1 + \\delta)^{-1} \\approx 1 - \\delta$$\n将这些代回 $v_{g}$ 的表达式中：\n$$v_{g} \\approx c \\sqrt{2\\delta} \\left(1 + \\frac{\\delta}{4}\\right) (1 - \\delta) = c \\sqrt{2\\delta} \\left(1 - \\delta + \\frac{\\delta}{4} - \\frac{\\delta^2}{4}\\right) = c \\sqrt{2\\delta} \\left(1 - \\frac{3\\delta}{4} - O(\\delta^2)\\right)$$\n$$v_{g} \\approx c\\sqrt{2\\delta} - \\frac{3c}{4}\\delta\\sqrt{2\\delta} - \\dots$$\n主导阶项是 $\\delta$ 的最低次幂项，即 $\\delta^{1/2}$。因此，主导阶标度关系为：\n$$v_{g} \\approx c\\sqrt{2\\delta}$$\n该表达式的单位是速度（m/s），因为 $c$ 的单位是 m/s，而 $\\delta$ 是无量纲的，满足题目要求。", "answer": "$$\\boxed{c\\sqrt{2\\delta}}$$", "id": "3694650"}, {"introduction": "接下来，我们将探讨在更极端的条件下波的特性如何变化，特别是在高强度电磁场的影响下。本练习深入探讨了相对论性非线性，即波本身的振幅会改变等离子体介质，从而改变其自身的色散关系。通过推导依赖于振幅的群速度，你将深入了解与高功率波加热和惯性约束聚变相关的复杂相互作用。[@problem_id:3694655]", "problem": "一束高强度、圆偏振的电磁（EM）平面波，其角频率为 $\\omega$，振幅 $E_0$ 缓变，沿 $z$ 方向传播进入一个均匀的、离子固定不动的冷电子等离子体中，这种情况存在于与惯性约束和磁约束核聚变相关的某些物理机制中。平衡电子数密度为 $n_0$，在国际单位制（SI）中，电子等离子体频率为 $\\omega_{pe} \\equiv \\sqrt{\\frac{n_0 e^2}{m_e \\varepsilon_0}}$，其中 $e$ 是元电荷，$m_e$ 是电子质量，$\\varepsilon_0$ 是真空介电常数。在相对论性强度下，电子在波场中的颤动变为相对论性的，电子的有效质量因洛伦兹因子 $\\gamma$ 而增加，而 $\\gamma$ 取决于波的振幅。\n\n从麦克斯韦方程组和冷相对论电子流体方程（忽略碰撞和离子运动）出发，考虑一个单色横向电磁波，并假设其为圆偏振，从而使得电子颤动的洛伦兹因子为常数。定义归一化振幅 $a \\equiv \\frac{e E_0}{m_e c \\omega}$，其中 $c$ 为真空中的光速，并利用电子颤动的相对论运动学来得到以 $a$ 表示的 $\\gamma$。然后，推导等离子体中依赖于振幅的横向电磁波色散关系，并计算群速度 $v_g$ 作为振幅 $a$ 的函数（在对波数求导时将 $a$ 视为参数）。将 $v_g(a)$ 的最终答案用 $c$、$\\omega$、$\\omega_{pe}$ 和 $a$ 表示，并以米/秒为单位给出。不需要进行数值计算，也无需四舍五入；请给出一个闭合形式的解析表达式。", "solution": "该问题是有效的，因为它科学地基于相对论等离子体物理学和电磁学的原理，问题陈述清晰且提供了所有必要信息，并以客观、正式的语言表述。我们开始求解。\n\n单个电子在电磁波场中的运动由相对论洛伦兹力方程决定。对于冷电子流体，忽略压力项并假设离子固定不动，动量方程为：\n$$\n\\frac{\\partial \\mathbf{p}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{p} = -e (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})\n$$\n其中 $\\mathbf{p} = \\gamma m_e \\mathbf{v}$ 是相对论动量，$\\gamma = (1 - v^2/c^2)^{-1/2}$ 是洛伦兹因子，$\\mathbf{v}$ 是电子流体速度，$m_e$ 是电子静止质量，$e$ 是元电荷。对于沿 $z$ 轴传播的横向平面波，场 $\\mathbf{E}$ 和 $\\mathbf{B}$ 是 $(z,t)$ 的函数，且位于 $x-y$ 平面内。电子的主要运动也在横向平面内。在对电子颤动的一级近似中，我们可以忽略对流项 $(\\mathbf{v} \\cdot \\nabla) \\mathbf{p}$ 和洛伦兹力的纵向分量（有质动力）。动量方程简化为：\n$$\n\\frac{d \\mathbf{p}_\\perp}{d t} \\approx -e \\mathbf{E}_\\perp\n$$\n这里我们已经转为跟随流体元的全时间导数。设圆偏振电场表示为 $\\mathbf{E} = E_0 (\\hat{\\mathbf{x}} + i\\hat{\\mathbf{y}}) \\exp[i(kz - \\omega t)]$ 的实部。为简化积分，我们使用形式 $\\mathbf{E} = E_0 (\\hat{\\mathbf{x}} \\cos(kz - \\omega t) + \\hat{\\mathbf{y}} \\sin(kz - \\omega t))$。对时间积分，得到横向动量：\n$$\n\\mathbf{p}_\\perp = -e \\int \\mathbf{E}(t) dt = -e E_0 \\left( \\hat{\\mathbf{x}} \\frac{\\sin(kz - \\omega t)}{-\\omega} + \\hat{\\mathbf{y}} \\frac{-\\cos(kz - \\omega t)}{-\\omega} \\right) = \\frac{e E_0}{\\omega} \\left( \\hat{\\mathbf{x}} \\sin(kz - \\omega t) - \\hat{\\mathbf{y}} \\cos(kz - \\omega t) \\right)\n$$\n横向动量的模的平方不随时间变化：\n$$\np_\\perp^2 = \\left(\\frac{e E_0}{\\omega}\\right)^2 \\left( \\sin^2(kz - \\omega t) + \\cos^2(kz - \\omega t) \\right) = \\left(\\frac{e E_0}{\\omega}\\right)^2\n$$\n洛伦兹因子 $\\gamma$ 通过相对论能量-动量关系 $E_{rel}^2 = (pc)^2 + (m_e c^2)^2$ 与动量相关，其中 $E_{rel} = \\gamma m_e c^2$。假设电子没有净纵向漂移，其总动量就是横向颤动动量，$p = p_\\perp$。\n$$\n(\\gamma m_e c^2)^2 = p_\\perp^2 c^2 + (m_e c^2)^2\n$$\n两边同除以 $(m_e c^2)^2$，我们得到：\n$$\n\\gamma^2 = \\frac{p_\\perp^2}{m_e^2 c^2} + 1\n$$\n代入 $p_\\perp$ 的表达式：\n$$\n\\gamma^2 = \\frac{1}{m_e^2 c^2} \\left(\\frac{e E_0}{\\omega}\\right)^2 + 1\n$$\n使用给定的归一化振幅定义，$a \\equiv \\frac{e E_0}{m_e c \\omega}$，我们可以写出：\n$$\n\\gamma^2 = a^2 + 1\n$$\n由于 $\\gamma \\ge 1$，我们有 $\\gamma = \\sqrt{1 + a^2}$。这是第一个要求的结果。由于是圆偏振，对于固定的波振幅 $E_0$，$\\gamma$ 是一个常数。\n\n接下来，我们推导色散关系。我们从麦克斯韦方程组在有电流密度 $\\mathbf{J}$ 的介质中导出的波动方程开始：\n$$\n\\nabla^2 \\mathbf{E} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = \\mu_0 \\frac{\\partial \\mathbf{J}}{\\partial t} = \\frac{1}{\\varepsilon_0 c^2} \\frac{\\partial \\mathbf{J}}{\\partial t}\n$$\n电流密度由 $\\mathbf{J} = -n_e e \\mathbf{v}$ 给出。对于高频波，我们可以用背景平衡密度 $n_0$ 来近似电子密度 $n_e$。速度为 $\\mathbf{v} = \\mathbf{p} / (\\gamma m_e)$。因此，横向电流密度为：\n$$\n\\mathbf{J}_\\perp = -n_0 e \\mathbf{v}_\\perp = -\\frac{n_0 e}{\\gamma m_e} \\mathbf{p}_\\perp\n$$\n我们寻找形式为 $\\mathbf{E} \\propto \\exp[i(kz - \\omega t)]$ 的谐波解。对于这样的波，算符变为 $\\partial/\\partial t \\to -i\\omega$ 和 $\\nabla \\to i k \\hat{\\mathbf{z}}$。动量方程 $\\frac{d\\mathbf{p}_\\perp}{dt} = -e\\mathbf{E}_\\perp$ 变为 $-i\\omega \\mathbf{p}_\\perp = -e \\mathbf{E}_\\perp$，这给出 $\\mathbf{p}_\\perp = \\frac{e}{i\\omega} \\mathbf{E}_\\perp$。\n将此代入电流密度的表达式中：\n$$\n\\mathbf{J}_\\perp = -\\frac{n_0 e}{\\gamma m_e} \\left(\\frac{e}{i\\omega} \\mathbf{E}_\\perp\\right) = \\frac{i n_0 e^2}{\\gamma m_e \\omega} \\mathbf{E}_\\perp\n$$\n现在，将此电流密度代入波动方程。对于横向波，$\\nabla^2 \\mathbf{E}_\\perp = -k^2 \\mathbf{E}_\\perp$。\n$$\n-k^2 \\mathbf{E}_\\perp - \\frac{1}{c^2}(-i\\omega)^2 \\mathbf{E}_\\perp = \\frac{1}{\\varepsilon_0 c^2}(-i\\omega) \\left(\\frac{i n_0 e^2}{\\gamma m_e \\omega} \\mathbf{E}_\\perp\\right)\n$$\n简化方程：\n$$\n\\left(-k^2 + \\frac{\\omega^2}{c^2}\\right) \\mathbf{E}_\\perp = \\frac{n_0 e^2}{\\varepsilon_0 c^2 \\gamma m_e} \\mathbf{E}_\\perp\n$$\n对于非平庸解（$\\mathbf{E}_\\perp \\neq 0$），标量系数必须为零。使用非相对论电子等离子体频率的定义 $\\omega_{pe}^2 \\equiv \\frac{n_0 e^2}{m_e \\varepsilon_0}$，我们得到色散关系：\n$$\n-k^2 + \\frac{\\omega^2}{c^2} = \\frac{\\omega_{pe}^2}{c^2 \\gamma}\n$$\n两边乘以 $c^2$ 并重新整理，得到所需的形式：\n$$\n\\omega^2 = k^2 c^2 + \\frac{\\omega_{pe}^2}{\\gamma}\n$$\n代入 $\\gamma = \\sqrt{1 + a^2}$，依赖于振幅的色散关系为：\n$$\n\\omega^2 = k^2 c^2 + \\frac{\\omega_{pe}^2}{\\sqrt{1 + a^2}}\n$$\n这是第二个要求的结果。\n\n最后，我们计算群速度 $v_g = \\frac{d\\omega}{dk}$。题目指定在求导过程中将振幅 $a$ 视为固定参数。我们对色散关系关于 $k$ 进行隐式求导：\n$$\n\\frac{d}{dk}(\\omega^2) = \\frac{d}{dk}\\left(k^2 c^2 + \\frac{\\omega_{pe}^2}{\\sqrt{1 + a^2}}\\right)\n$$\n$$\n2\\omega \\frac{d\\omega}{dk} = 2k c^2 + 0\n$$\n右边的第二项为零，因为 $\\omega_{pe}$ 和 $a$ 在对 $k$ 求导时被视为常数。\n求解群速度 $v_g = \\frac{d\\omega}{dk}$：\n$$\nv_g = \\frac{k c^2}{\\omega}\n$$\n为了用 $\\omega$、$\\omega_{pe}$、$c$ 和 $a$ 来表示 $v_g$，我们必须消去 $k$。从色散关系中，我们求解 $k$：\n$$\nk^2 c^2 = \\omega^2 - \\frac{\\omega_{pe}^2}{\\sqrt{1 + a^2}}\n$$\n假设波向前传播（$k > 0$），我们取正平方根：\n$$\nk = \\frac{1}{c} \\sqrt{\\omega^2 - \\frac{\\omega_{pe}^2}{\\sqrt{1+a^2}}}\n$$\n将 $k$ 的这个表达式代入 $v_g$ 的方程中：\n$$\nv_g = \\frac{c^2}{\\omega} \\left(\\frac{1}{c} \\sqrt{\\omega^2 - \\frac{\\omega_{pe}^2}{\\sqrt{1+a^2}}}\\right) = \\frac{c}{\\omega} \\sqrt{\\omega^2 - \\frac{\\omega_{pe}^2}{\\sqrt{1+a^2}}}\n$$\n通过从平方根中提出 $\\omega^2$ 因子，可以简化此表达式：\n$$\nv_g(a) = c \\sqrt{1 - \\frac{\\omega_{pe}^2}{\\omega^2 \\sqrt{1+a^2}}}\n$$\n单位正确，为米/秒，因为它是 $c$ 乘以一个无量纲因子。这是群速度作为归一化振幅 $a$ 的函数的最终表达式。", "answer": "$$\\boxed{c \\sqrt{1 - \\frac{\\omega_{pe}^2}{\\omega^2 \\sqrt{1+a^2}}}}$$", "id": "3694655"}, {"introduction": "最后，我们通过一个计算问题将理论与应用联系起来，该问题模拟了电子回旋共振加热（ECRH），这是加热聚变等离子体的一种主要方法。你将基于非均匀托卡马克等离子体中非寻常波（X-波）的群速度，实现一个射线追踪算法。这个练习展示了群速度的概念如何成为设计和优化真实聚变能源系统的关键工具。[@problem_id:3694669]", "problem": "考虑在环形磁约束装置中的电子回旋共振加热 (ECRH)，其中电子回旋共振加热 (ECRH) 电磁波以非常波偏振 (X-模) 方式发射。环形磁场由一维分布 $B(R) = B_0 R_0 / R$ 建模，其中 $R$ 是大半径，$B_0$ 是在 $R_0$ 处的磁场，$R$ 在物理合理的范围内变化。电子密度分布由 $n_e(R) = n_0 \\exp\\left(-\\left(\\frac{R - R_0}{a}\\right)^2\\right)$ 建模，其中 $n_0$ 和 $a$ 是常数。一个角频率为 $\\omega$ 的ECRH波从半径为 $R_{\\text{launch}}$ 的低场侧以相对于磁场方向的固定角度 $\\theta$ 发射。假设回旋吸收发生在二次谐波处，即 $s \\Omega_e(R) = \\omega$，其中 $s = 2$，$\\Omega_e(R) = e B(R) / m_e$，$e$ 是元电荷，$m_e$ 是电子质量。\n\n从几何光学极限以及相速度和群速度的定义出发，您必须推导并实现一个基于群速度的径向坐标 $R(t)$ 的射线追踪算法。推导必须从公认的物理原理开始：\n- 由麦克斯韦方程组和一个磁化电子流体控制的冷等离子体电磁波传播，以及通过折射率 $n(\\omega, R, \\theta)$ 表示的X模（非常模）的标准冷等离子体色散关系。\n- 相速度定义 $v_{\\text{ph}} = \\omega / k$ 和群速度定义 $v_g = \\partial \\omega / \\partial k$。\n假设介质缓慢变化，并使用局部均匀近似，使 $\\theta$ 沿射线保持固定。在此近似下，折射率 $n(\\omega, R, \\theta)$ 用于计算射线追踪所需的波数大小 $k(\\omega, R, \\theta) = n(\\omega, R, \\theta)\\,\\omega/c$ 和群速度大小 $v_g(\\omega, R, \\theta)$。如果在波的路径上任何一点出现 $n^2(\\omega, R, \\theta) \\le 0$，您必须将其视为波被阻断，这表示截止或倏逝。\n\n实现以下内容：\n1. 使用 $B(R) = B_0 R_0 / R$、$n_e(R) = n_0 \\exp\\left(-\\left(\\frac{R - R_0}{a}\\right)^2\\right)$、$\\Omega_e(R) = e B(R) / m_e$ 和 $\\omega_{pe}(R) = \\sqrt{\\frac{n_e(R) e^2}{\\varepsilon_0 m_e}}$，其中 $\\varepsilon_0$ 是真空介电常数。使用无碰撞冷等离子体，并在高频电子回旋范围内忽略离子在介电响应中的作用。\n2. 使用冷等离子体非常模 (X-模) 色散关系计算对于一般 $\\theta$ 的折射率 $n(\\omega, R, \\theta)$ 以及相关的 $k(\\omega, R, \\theta) = n(\\omega, R, \\theta)\\,\\omega/c$，其中 $c$ 是光速。为了计算群速度大小 $v_g(\\omega, R, \\theta)$，将介质视为在 $k$ 的大小方面局部各向同性。仅在 $n^2(\\omega, R, \\theta)  0$ 的地方强制传播。\n3. 使用 $dR/dt = v_g(\\omega, R, \\theta)\\,\\sin(\\theta)$ 对径向位置 $R(t)$ 进行射线追踪，选择符号以使射线最初从低场侧 ($R_{\\text{launch}}$) 向减小的 $R$ 方向移动。当满足二次谐波共振条件 $s \\Omega_e(R) = \\omega$ 时停止积分。如果射线在到达共振点之前遇到 $n^2(\\omega, R, \\theta) \\le 0$ 的区域，或者共振点在定义域之外，则报告无吸收。\n4. 以米 ($\\text{m}$) 为单位表示吸收位置，四舍五入到三位小数。如果未发生吸收（被阻断或越界），则该情况输出 $-1.000$。\n\n使用以下固定的物理常数和参数：\n- $c = 299792458.0\\ \\text{m/s}$，\n- $e = 1.602176634 \\times 10^{-19}\\ \\text{C}$，\n- $m_e = 9.1093837015 \\times 10^{-31}\\ \\text{kg}$，\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\text{F/m}$，\n- $B_0 = 2.5\\ \\text{T}$，\n- $R_0 = 2.0\\ \\text{m}$，\n- $n_0 = 5.0 \\times 10^{19}\\ \\text{m}^{-3}$，\n- $a = 0.6\\ \\text{m}$，\n- $R_{\\min} = 1.2\\ \\text{m}$，\n- $R_{\\max} = 3.2\\ \\text{m}$，\n- $R_{\\text{launch}} = 3.0\\ \\text{m}$，\n- $s = 2$。\n\n角度规定：将 $\\theta$ 解释为度，并在内部转换为弧度。\n\n数值积分规定：\n- 使用固定时间步长 $\\Delta t = 1.0 \\times 10^{-10}\\ \\text{s}$。\n- 使用最大积分时间 $T_{\\max} = 5.0 \\times 10^{-7}\\ \\text{s}$。\n- 通过监测 $s \\Omega_e(R) - \\omega$ 的符号来检测共振点的穿越，并对穿越点进行线性插值以获得子步长精度。\n- 使用 $n(\\omega, R, \\theta)$ 对 $\\omega$ 在固定 $R$ 和 $\\theta$ 下的数值微分，从色散关系中获得 $v_g(\\omega, R, \\theta)$。用一个小的 $\\omega$ 分数扰动来实现一个稳定的中心差分。\n\n测试套件：\n计算以下四个测试用例的吸收位置。每个测试用例是一对 $(\\theta, f)$，其中 $f$ 是频率（单位赫兹），$\\theta$ 是发射角（单位度）。您的程序必须生成以米为单位的结果，四舍五入到三位小数。\n- 情况 1：$(\\theta = 60.0,\\ f = 140.0 \\times 10^{9})$。\n- 情况 2：$(\\theta = 20.0,\\ f = 110.0 \\times 10^{9})$。\n- 情况 3：$(\\theta = 80.0,\\ f = 170.0 \\times 10^{9})$。\n- 情况 4：$(\\theta = 60.0,\\ f = 240.0 \\times 10^{9})$。\n\n最终输出格式：\n您的程序应生成单行输出，包含所有给定测试用例的吸收半径，以米为单位表示并四舍五入到三位小数，形式为用方括号括起来的逗号分隔列表（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$）。不应打印任何其他文本。", "solution": "用户希望在一个简化的托卡马克等离子体模型中解决电子回旋共振加热 (ECRH) 波的射线追踪问题。\n\n### 步骤1：提取给定信息\n\n-   **磁场分布**：$B(R) = B_0 R_0 / R$，其中 $B_0 = 2.5\\ \\text{T}$，$R_0 = 2.0\\ \\text{m}$。\n-   **电子密度分布**：$n_e(R) = n_0 \\exp\\left(-\\left(\\frac{R - R_0}{a}\\right)^2\\right)$，其中 $n_0 = 5.0 \\times 10^{19}\\ \\text{m}^{-3}$，$a = 0.6\\ \\text{m}$。\n-   **波类型**：非常波偏振 (X-模) 电磁波。\n-   **吸收条件**：二次谐波回旋共振，$s \\Omega_e(R) = \\omega$，谐波数 $s = 2$。\n-   **频率**：电子回旋频率 $\\Omega_e(R) = e B(R) / m_e$ 和电子等离子体频率 $\\omega_{pe}(R) = \\sqrt{\\frac{n_e(R) e^2}{\\varepsilon_0 m_e}}$。\n-   **色散关系**：冷等离子体X模色散，关联角频率 $\\omega$、波数 $k$ 和与磁场的角度 $\\theta$。折射率为 $n(\\omega, R, \\theta) = c k / \\omega$。\n-   **射线追踪模型**：几何光学极限，径向坐标 $R(t)$ 的射线追踪方程由 $dR/dt = v_g(\\omega, R, \\theta)\\,\\sin(\\theta)$ 给出。选择符号以保证从 $R_{\\text{launch}}$ 开始的初始向内传播。角度 $\\theta$ 固定。\n-   **群速度**：$v_g = \\partial \\omega / \\partial k$，将通过数值微分从色散关系计算。问题指定为此计算将介质视为局部各向同性，即 $v_g = (dk/d\\omega)^{-1}$。\n-   **阻断条件**：如果折射率的平方 $n^2(\\omega, R, \\theta)$ 小于或等于 $0$，则波被阻断。\n-   **积分参数**：\n    -   初始位置：$R_{\\text{launch}} = 3.0\\ \\text{m}$。\n    -   定义域：$R \\in [R_{\\min}, R_{\\max}]$，其中 $R_{\\min} = 1.2\\ \\text{m}$，$R_{\\max} = 3.2\\ \\text{m}$。\n    -   数值积分：固定时间步长 $\\Delta t = 1.0 \\times 10^{-10}\\ \\text{s}$，最大时间 $T_{\\max} = 5.0 \\times 10^{-7}\\ \\text{s}$。\n    -   共振检测：$s \\Omega_e(R) - \\omega$ 符号改变时进行线性插值。\n-   **物理常数**：\n    -   $c = 299792458.0\\ \\text{m/s}$\n    -   $e = 1.602176634 \\times 10^{-19}\\ \\text{C}$\n    -   $m_e = 9.1093837015 \\times 10^{-31}\\ \\text{kg}$\n    -   $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\text{F/m}$\n-   **测试用例**：\n    -   情况 1：$(\\theta = 60.0^\\circ, f = 140.0 \\times 10^9\\ \\text{Hz})$\n    -   情况 2：$(\\theta = 20.0^\\circ, f = 110.0 \\times 10^9\\ \\text{Hz})$\n    -   情况 3：$(\\theta = 80.0^\\circ, f = 170.0 \\times 10^9\\ \\text{Hz})$\n    -   情况 4：$(\\theta = 60.0^\\circ, f = 240.0 \\times 10^9\\ \\text{Hz})$\n-   **输出**：吸收半径 $R$，单位为米，四舍五入至三位小数。若不发生吸收，输出 $-1.000$。\n\n### 步骤2：使用提取的给定信息进行验证\n\n-   **科学依据**：该问题在等离子体物理学原理，特别是电磁波在磁化等离子体中的传播（ECRH）方面有坚实的基础。磁场（$1/R$ 分布）、电子密度（高斯分布）的模型以及冷等离子体色散关系的使用是聚变研究中标准（尽管简化了）的表示方法。\n-   **适定性**：该问题是适定的。它提供了明确的目标（找到吸收半径）、所有必要的物理模型和参数、射线的初始条件以及终止条件（共振、截止或离开定义域）。数值方法也已指定，确保可以为每个测试用例确定唯一的解。\n-   **客观性**：问题陈述完全是定量的和客观的，没有主观或模糊的语言。\n-   **完整性与一致性**：提供了所有必需的信息。问题设置中没有明显的矛盾。具有固定角度 $\\theta$ 的简化一维射线追踪方法是问题明确要求的、一致的近似。\n-   **真实性**：磁场、密度和装置尺寸的参数是当代环形约束装置（托卡马克）的特征。波频率是ECRH系统的典型频率。\n-   **结论**：该问题是有效的、科学上合理的，并且在计算上是可行的。\n\n### 步骤3：推导与算法设计\n\n解决方案需要设计和实现一个数值射线追踪算法。该算法的核心是在射线路径的每一点计算群速度。\n\n**1. 作为半径R函数的物理量**\n\n物理环境由大半径 $R$ 定义。关键量是：\n-   磁场：$B(R) = B_0 R_0 / R$\n-   电子数密度：$n_e(R) = n_0 \\exp\\left(-\\left(\\frac{R - R_0}{a}\\right)^2\\right)$\n-   电子回旋频率：$\\Omega_e(R) = e B(R) / m_e$\n-   电子等离子体频率：$\\omega_{pe}(R) = \\sqrt{n_e(R) e^2 / (\\varepsilon_0 m_e)}$\n\n**2. X模的色散关系**\n\n冷等离子体中波的折射率 $n$ 取决于其频率 $\\omega$ 和局部等离子体参数。对于非常 (X) 模，折射率的平方 $n^2$ 由Appleton-Lassen方程给出。用归一化参数 $X = (\\omega_{pe}/\\omega)^2$ 和 $Y = (\\Omega_e/\\omega)$ 表示，X模的公式是：\n$$ n^2 = 1 - \\frac{X}{1 - \\frac{Y^2\\sin^2\\theta}{2(1-X)} - \\sqrt{\\frac{Y^4\\sin^4\\theta}{4(1-X)^2} + Y^2\\cos^2\\theta}} $$\n其中 $\\theta$ 是波矢 $\\vec{k}$ 和磁场 $\\vec{B}$ 之间的夹角。波仅在 $n^2 > 0$ 的地方传播。如果 $n^2 \\le 0$，波处于“截止”状态，不传播。我们必须在数值上处理 $X=1$（即 $\\omega=\\omega_{pe}$）处的奇点。\n\n**3. 群速度计算**\n\n群速度大小 $v_g$ 定义为 $v_g = d\\omega/dk$。这可以通过对波数 $k$ 关于 $\\omega$ 的导数求逆来计算：\n$$ v_g = \\left( \\frac{dk}{d\\omega} \\right)^{-1} $$\n根据折射率的定义，$k(\\omega, R, \\theta) = n(\\omega, R, \\theta) \\frac{\\omega}{c}$。使用乘法法则进行微分：\n$$ \\frac{dk}{d\\omega} = \\frac{1}{c} \\left( n(\\omega, R, \\theta) + \\omega \\frac{\\partial n(\\omega, R, \\theta)}{\\partial \\omega} \\right) $$\n因此，群速度是：\n$$ v_g = c \\left( n + \\omega \\frac{\\partial n}{\\partial \\omega} \\right)^{-1} $$\n偏导数 $\\partial n / \\partial \\omega$ 使用中心差分格式和小的扰动 $\\Delta\\omega$ 进行数值计算：\n$$ \\frac{\\partial n}{\\partial \\omega} \\approx \\frac{n(\\omega + \\Delta\\omega, R, \\theta) - n(\\omega - \\Delta\\omega, R, \\theta)}{2 \\Delta\\omega} $$\n\n**4. 射线追踪算法**\n\n我们追踪波包的径向位置 $R(t)$。问题指定射线的径向速度为：\n$$ \\frac{dR}{dt} = v_{g,R} $$\n问题规定使用 $v_g \\sin(\\theta)$，并选择符号以实现初始向内运动。发射点在 $R_{\\text{launch}} = 3.0\\ \\text{m}$，位于低场侧（$R$ 越大，$B$ 越小）。射线向减小的 $R$ 方向移动。因此，我们将径向速度设为负值：\n$$ \\frac{dR}{dt} = -|v_g \\sin(\\theta)| $$\n我们使用前向欧拉法进行数值积分，固定时间步长 $\\Delta t$：\n$$ R(t + \\Delta t) = R(t) + \\frac{dR}{dt} \\Delta t $$\n\n积分逐步进行：\n1.  初始化 $R = R_{\\text{launch}}$ 和 $t=0$。\n2.  开始一个循环，直到 $t \\ge T_{\\max}$。\n3.  在当前位置 $R(t)$：\n    a. 检查边界条件：如果 $R  R_{\\min}$ 或 $R > R_{\\max}$，终止并报告无吸收。\n    b. 检查截止条件：计算 $n^2(\\omega, R, \\theta)$。如果 $n^2 \\le 0$，终止并报告无吸收。\n    c. 计算群速度 $v_g(\\omega, R, \\theta)$。\n    d. 使用欧拉步长计算下一个位置 $R(t+\\Delta t)$。\n    e. 检查共振穿越：共振条件是 $f(R) = s \\Omega_e(R) - \\omega = 0$。我们检查 $f(R)$ 的符号在当前步 $R(t)$ 和下一步 $R(t+\\Delta t)$ 之间是否改变。如果改变（从负到正，因为当 $R$ 减小时 $\\Omega_e$ 增加），则已穿越共振点。\n    f. 如果穿越共振点，使用线性插值找到精确的吸收半径 $R_{abs}$。\n       $$ R_{abs} = R(t) - f(R(t)) \\frac{R(t+\\Delta t) - R(t)}{f(R(t+\\Delta t)) - f(R(t))} $$\n       该值为该测试用例的结果。\n    g. 如果没有穿越，将 $R(t)$ 更新为 $R(t+\\Delta t)$ 并继续。\n4.  如果循环完成而未找到吸收，报告无吸收（$-1.000$）。\n对每个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ECRH ray-tracing problem for the given test cases.\n    \"\"\"\n    \n    # ------------------- Constants and Parameters -------------------\n    # Physical Constants\n    C = 299792458.0  # Speed of light in vacuum, m/s\n    E_CHARGE = 1.602176634e-19  # Elementary charge, C\n    M_E = 9.1093837015e-31  # Electron mass, kg\n    EPS_0 = 8.8541878128e-12  # Vacuum permittivity, F/m\n\n    # Plasma and Machine Parameters\n    B0 = 2.5  # Magnetic field at R0, T\n    R0 = 2.0  # Major radius of magnetic axis, m\n    N0 = 5.0e19  # Electron density at R0, m^-3\n    A = 0.6  # Density profile width, m\n    R_MIN = 1.2  # Minimum major radius of domain, m\n    R_MAX = 3.2  # Maximum major radius of domain, m\n    R_LAUNCH = 3.0  # Launch major radius, m\n    S = 2  # Harmonic number\n\n    # Numerical Parameters\n    DT = 1.0e-10  # Time step, s\n    T_MAX = 5.0e-7  # Maximum integration time, s\n    OMEGA_PERT_FRAC = 1e-6 # Fractional perturbation for numerical derivative\n    X_TOL = 1e-10 # Tolerance for X=1 singularity\n\n    test_cases = [\n        (60.0, 140.0e9),\n        (20.0, 110.0e9),\n        (80.0, 170.0e9),\n        (60.0, 240.0e9),\n    ]\n\n    # --- Helper functions for physical quantities ---\n\n    memo_omega_pe = {}\n    def omega_pe(R):\n        if R in memo_omega_pe: return memo_omega_pe[R]\n        ne_val = N0 * np.exp(-((R - R0) / A)**2)\n        if ne_val == 0: return 0.0\n        result = np.sqrt(ne_val * E_CHARGE**2 / (EPS_0 * M_E))\n        memo_omega_pe[R] = result\n        return result\n\n    memo_omega_e = {}\n    def omega_e(R):\n        if R in memo_omega_e: return memo_omega_e[R]\n        b_val = B0 * R0 / R\n        result = E_CHARGE * b_val / M_E\n        memo_omega_e[R] = result\n        return result\n\n    memo_n_squared = {}\n    def get_n_squared(omega, R, theta_rad):\n        if (omega, R, theta_rad) in memo_n_squared:\n            return memo_n_squared[(omega, R, theta_rad)]\n\n        if R == 0: return -1.0\n\n        w_pe = omega_pe(R)\n        w_e = omega_e(R)\n\n        X = (w_pe / omega)**2 if omega != 0 else np.inf\n        Y = w_e / omega if omega != 0 else np.inf\n        \n        # Handle singularity at X=1 (omega = omega_pe)\n        if abs(1.0 - X)  X_TOL:\n            sin_theta = np.sin(theta_rad)\n            if sin_theta == 0:\n                 # Parallel propagation: X-mode branch connects to R-wave\n                 n_sq = 1 - X / (1 + Y) if (1 + Y) != 0 else -1.0\n            elif 1.0 - X > 0:\n                 # Limit for X -> 1-\n                 n_sq = 1 + (1-X)/(Y**2 * sin_theta**2)\n            else:\n                 # Limit for X -> 1+ (cutoff)\n                 n_sq = 1 - X\n            memo_n_squared[(omega, R, theta_rad)] = n_sq\n            return n_sq\n\n        sin_theta_sq = np.sin(theta_rad)**2\n        cos_theta_sq = np.cos(theta_rad)**2\n        Y_T_sq = Y**2 * sin_theta_sq\n        Y_L_sq = Y**2 * cos_theta_sq\n\n        term_in_sqrt = (Y**4 * sin_theta_sq**2) / (4 * (1 - X)**2) + Y_L_sq\n        if term_in_sqrt  0: return -1.0\n        \n        sqrt_term = np.sqrt(term_in_sqrt)\n        denom_main = 1 - (Y_T_sq / (2 * (1 - X))) - sqrt_term\n        \n        if abs(denom_main)  1e-12: return -1.0\n        \n        n_sq = 1 - X / denom_main\n        memo_n_squared[(omega, R, theta_rad)] = n_sq\n        return n_sq\n\n    memo_vg = {}\n    def get_group_velocity(omega, R, theta_rad):\n        if (omega, R, theta_rad) in memo_vg:\n            return memo_vg[(omega, R, theta_rad)]\n\n        n_sq_center = get_n_squared(omega, R, theta_rad)\n        if n_sq_center = 0: return None\n\n        n_center = np.sqrt(n_sq_center)\n        \n        delta_omega = omega * OMEGA_PERT_FRAC\n        \n        n_sq_p = get_n_squared(omega + delta_omega, R, theta_rad)\n        n_p = np.sqrt(max(0, n_sq_p))\n        \n        n_sq_m = get_n_squared(omega - delta_omega, R, theta_rad)\n        n_m = np.sqrt(max(0, n_sq_m))\n\n        dn_domega = (n_p - n_m) / (2 * delta_omega)\n        \n        denom_vg = n_center + omega * dn_domega\n        \n        if abs(denom_vg)  1e-12: return None\n            \n        vg = C / denom_vg\n        memo_vg[(omega, R, theta_rad)] = vg\n        return vg\n    \n    def solve_case(theta_deg, f):\n        # Clear memos for each new case\n        memo_omega_pe.clear()\n        memo_omega_e.clear()\n        memo_n_squared.clear()\n        memo_vg.clear()\n\n        omega = 2 * np.pi * f\n        theta_rad = np.deg2rad(theta_deg)\n        \n        R = R_LAUNCH\n        \n        res_func = lambda r: S * omega_e(r) - omega\n        res_val_curr = res_func(R)\n\n        max_steps = int(T_MAX / DT)\n        for _ in range(max_steps):\n            if not (R_MIN = R = R_MAX):\n                return -1.0\n\n            n_sq = get_n_squared(omega, R, theta_rad)\n            if n_sq = 0:\n                return -1.0\n                \n            vg = get_group_velocity(omega, R, theta_rad)\n            if vg is None or not np.isfinite(vg):\n                return -1.0\n\n            v_radial = -abs(vg * np.sin(theta_rad))\n            R_next = R + v_radial * DT\n\n            res_val_next = res_func(R_next)\n            \n            if res_val_curr = 0 and res_val_next > 0:\n                frac = -res_val_curr / (res_val_next - res_val_curr)\n                R_absorb = R + frac * (R_next - R)\n                return R_absorb\n            \n            R = R_next\n            res_val_curr = res_val_next\n            \n        return -1.0\n\n    results = []\n    for case in test_cases:\n        theta, f_hz = case\n        absorption_radius = solve_case(theta, f_hz)\n        results.append(f\"{absorption_radius:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3694669"}]}