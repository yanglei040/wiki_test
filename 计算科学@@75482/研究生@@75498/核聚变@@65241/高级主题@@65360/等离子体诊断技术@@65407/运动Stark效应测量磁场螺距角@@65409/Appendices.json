{"hands_on_practices": [{"introduction": "在我们深入探讨运动斯塔克效应（MSE）诊断的复杂应用之前，首要任务是掌握其最基本但至关重要的一步：精确校准。这个练习将引导您通过一个标准的实验校准流程，利用反转环向磁场的方法，来区分真实的物理信号与仪器固有的系统误差。通过这个实践 [@problem_id:3710066]，您将学会如何从原始测量数据中提取磁场螺距角和仪器偏移量这两个关键参数，这是确保所有后续测量准确性的基石。", "problem": "一种基于中性束的动斯塔克效应 (MSE) 诊断用于推断托卡马克聚变等离子体外侧中平面的磁螺距角。考虑一个局部右手正交归一基矢，其单位矢量为 $\\,\\hat{\\boldsymbol{e}}_{r}\\,$ (径向向外)，$\\,\\hat{\\boldsymbol{e}}_{t}\\,$ (环向沿等离子体电流方向) 和 $\\,\\hat{\\boldsymbol{e}}_{z}\\,$ (垂直向上)。在测量位置，磁场可写为 $\\boldsymbol{B} = B_{t}\\,\\hat{\\boldsymbol{e}}_{t} + B_{p}\\,\\hat{\\boldsymbol{e}}_{z}$，中性束速度近似为径向，即 $\\boldsymbol{v} = v_{b}\\,\\hat{\\boldsymbol{e}}_{r}$。磁螺距角定义为 $\\theta_{p} = \\arctan\\!\\big(B_{p}/B_{t}\\big)$，取值范围为 $\\theta_{p}\\in(0,\\pi/2)$。\n\n与氢巴尔末-$\\alpha$发射相关的动斯塔克电场由基于洛伦兹力的构造 $\\boldsymbol{E}_{\\mathrm{m}} = \\boldsymbol{v}\\times\\boldsymbol{B}$ 给出。在MSE中，发射光的线性偏振轴与 $\\boldsymbol{E}_{\\mathrm{m}}$ 对齐，诊断系统测量在 $\\hat{\\boldsymbol{e}}_{t}$–$\\hat{\\boldsymbol{e}}_{z}$ 平面内的偏振方向角 $\\psi$，该角度以 $+\\hat{\\boldsymbol{e}}_{z}$ 轴为参考，向 $+\\hat{\\boldsymbol{e}}_{t}$ 方向的旋转为正。由于光学未对准，仪器存在一个未知的恒定角度偏移 $\\delta$，因此测量角度 $\\psi$ 遵循 $\\psi = \\alpha + \\delta$，其中 $\\alpha$ 是由物理原理决定的真实偏振角。\n\n为了校准 $\\delta$ 并验证诊断系统，进行了两次在其他方面完全相同的实验，其中环向磁场 $B_{t}$ 的符号被反转（大小不变，$B_{p}$ 不变），从而得到两个测量的偏振角：\n- 实验 A (环向磁场 $B_{t}>0$): $\\psi_{A} = -12.5$ 度，\n- 实验 B (环向磁场 $B_{t}<0$): $\\psi_{B} = +14.3$ 度。\n\n从适用于此情景的第一性原理出发——即动电场的定义 $\\boldsymbol{E}_{\\mathrm{m}} = \\boldsymbol{v}\\times\\boldsymbol{B}$ 以及MSE偏振轴与 $\\boldsymbol{E}_{\\mathrm{m}}$ 的对齐——推导 $\\psi_{A}$、$\\psi_{B}$、磁螺距角 $\\theta_{p}$ 和仪器偏移 $\\delta$ 之间的关系。然后，利用这两个验证实验求解 $\\theta_{p}$ 和 $\\delta$。\n\n以弧度表示 $\\theta_{p}$ 和 $\\delta$ 的最终答案。将答案四舍五入到四位有效数字。以行向量的形式按 $\\theta_{p}$、$\\delta$ 的顺序提供这两个值。", "solution": "首先对问题进行验证，以确保其科学上合理、内容自洽且提法得当。\n\n**问题验证**\n\n1.  **提取已知条件**：\n    -   坐标系：一个局部右手正交归一基矢，单位矢量为 $\\,\\hat{\\boldsymbol{e}}_{r}\\,$ (径向向外)，$\\,\\hat{\\boldsymbol{e}}_{t}\\,$ (环向沿等离子体电流方向) 和 $\\,\\hat{\\boldsymbol{e}}_{z}\\,$ (垂直向上)。\n    -   磁场：$\\boldsymbol{B} = B_{t}\\,\\hat{\\boldsymbol{e}}_{t} + B_{p}\\,\\hat{\\boldsymbol{e}}_{z}$。\n    -   中性束速度：$\\boldsymbol{v} = v_{b}\\,\\hat{\\boldsymbol{e}}_{r}$。\n    -   动斯塔克电场：$\\boldsymbol{E}_{\\mathrm{m}} = \\boldsymbol{v}\\times\\boldsymbol{B}$。\n    -   磁螺距角：$\\theta_{p} = \\arctan\\!\\big(B_{p}/B_{t}\\big)$，其中 $\\theta_{p}\\in(0,\\pi/2)$。此定义适用于 $B_{t}>0$ 的情况。\n    -   偏振对齐：发射光的线性偏振轴与 $\\boldsymbol{E}_{\\mathrm{m}}$ 对齐。\n    -   偏振角测量：在 $\\hat{\\boldsymbol{e}}_{t}$–$\\hat{\\boldsymbol{e}}_{z}$ 平面内测量偏振方向角 $\\psi$，以 $+\\hat{\\boldsymbol{e}}_{z}$ 轴为参考，向 $+\\hat{\\boldsymbol{e}}_{t}$ 方向的旋转为正。\n    -   仪器偏移：测量角度 $\\psi$ 与真实物理角度 $\\alpha$ 的关系为 $\\psi = \\alpha + \\delta$，其中 $\\delta$ 是一个未知的恒定偏移量。\n    -   实验 A：环向磁场 $B_{t} > 0$，测量角度 $\\psi_{A} = -12.5^{\\circ}$。\n    -   实验 B：环向磁场反向 ($B_{t} \\to -B_{t}$)，大小不变，$B_p$ 不变。测量角度 $\\psi_{B} = +14.3^{\\circ}$。\n\n2.  **使用提取的已知条件进行验证**：\n    -   问题具有科学依据，描述了托卡马克中一种标准的动斯塔克效应 (MSE) 诊断测量和校准程序，该程序基于电磁学的基本原理 (洛伦兹力)。\n    -   问题提法得当，提供了两个测量值 ($\\psi_{A}$ 和 $\\psi_{B}$) 来求解两个未知数 (螺距角 $\\theta_{p}$ 和偏移量 $\\delta$)。\n    -   问题是客观的，使用了物理学和工程学中常见的精确技术语言。\n    -   设置是完整和一致的，没有明显的矛盾或缺失信息。给定的数值对于此类实验是符合实际的。\n\n3.  **结论与行动**：问题有效。将提供完整的解答。\n\n**推导与求解**\n\n求解过程首先推导动斯塔克电场矢量 $\\boldsymbol{E}_{\\mathrm{m}}$ 的表达式。\n电场由运动电荷在磁场中受到的洛伦兹力表达式给出：\n$$ \\boldsymbol{E}_{\\mathrm{m}} = \\boldsymbol{v}\\times\\boldsymbol{B} $$\n代入给定的速度 $\\boldsymbol{v} = v_{b}\\,\\hat{\\boldsymbol{e}}_{r}$ 和磁场 $\\boldsymbol{B} = B_{t}\\,\\hat{\\boldsymbol{e}}_{t} + B_{p}\\,\\hat{\\boldsymbol{e}}_{z}$ 的表达式：\n$$ \\boldsymbol{E}_{\\mathrm{m}} = (v_{b}\\,\\hat{\\boldsymbol{e}}_{r}) \\times (B_{t}\\,\\hat{\\boldsymbol{e}}_{t} + B_{p}\\,\\hat{\\boldsymbol{e}}_{z}) $$\n使用叉积的分配律：\n$$ \\boldsymbol{E}_{\\mathrm{m}} = v_{b}B_{t}(\\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{t}) + v_{b}B_{p}(\\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{z}) $$\n基矢 $(\\hat{\\boldsymbol{e}}_{r}, \\hat{\\boldsymbol{e}}_{t}, \\hat{\\boldsymbol{e}}_{z})$ 是右手正交归一的。因此，基矢的叉积为：\n$$ \\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{t} = \\hat{\\boldsymbol{e}}_{z} $$\n$$ \\hat{\\boldsymbol{e}}_{r} \\times \\hat{\\boldsymbol{e}}_{z} = -\\hat{\\boldsymbol{e}}_{t} $$\n将这些结果代入 $\\boldsymbol{E}_{\\mathrm{m}}$ 的表达式：\n$$ \\boldsymbol{E}_{\\mathrm{m}} = v_{b}B_{t}\\hat{\\boldsymbol{e}}_{z} - v_{b}B_{p}\\hat{\\boldsymbol{e}}_{t} $$\nMSE偏振与 $\\boldsymbol{E}_{\\mathrm{m}}$ 对齐。诊断系统测量该矢量在 $\\hat{\\boldsymbol{e}}_{t}$–$\\hat{\\boldsymbol{e}}_{z}$ 平面内的方向。真实偏振角 $\\alpha$ 是相对于 $+\\hat{\\boldsymbol{e}}_{z}$ 轴定义的，向 $+\\hat{\\boldsymbol{e}}_{t}$ 轴的正向旋转为正。这意味着在测量平面的坐标系中，以 $\\hat{\\boldsymbol{e}}_{z}$ 为水平轴，以 $\\hat{\\boldsymbol{e}}_{t}$ 为竖直轴，角度 $\\alpha$ 是标准的极角。这个角的正切值是矢量 $\\boldsymbol{E}_{\\mathrm{m}}$ 的 $\\hat{\\boldsymbol{e}}_{t}$ 分量与 $\\hat{\\boldsymbol{e}}_{z}$ 分量的比值。\n设 $E_t$ 和 $E_z$ 分别是 $\\boldsymbol{E}_{\\mathrm{m}}$ 沿 $\\hat{\\boldsymbol{e}}_{t}$ 和 $\\hat{\\boldsymbol{e}}_{z}$ 的分量。\n$$ E_t = -v_{b}B_{p} $$\n$$ E_z = v_{b}B_{t} $$\n那么真实偏振角 $\\alpha$ 的正切值为：\n$$ \\tan(\\alpha) = \\frac{E_t}{E_z} = \\frac{-v_{b}B_{p}}{v_{b}B_{t}} = -\\frac{B_{p}}{B_{t}} $$\n磁螺距角 $\\theta_{p}$ 在 $B_t>0$ 时定义为 $\\theta_{p} = \\arctan(B_{p}/B_{t})$，由于 $\\theta_p \\in (0, \\pi/2)$，这意味着 $\\tan(\\theta_{p}) = B_{p}/B_{t}$。\n\n我们现在分别分析这两个实验。\n\n**实验 A**：\n环向磁场为正，$B_{t} > 0$。我们将此磁场表示为 $B_{t, \\mathrm{ref}}$。极向场为 $B_p$。真实偏振角 $\\alpha_{A}$ 由下式给出：\n$$ \\tan(\\alpha_{A}) = -\\frac{B_{p}}{B_{t, \\mathrm{ref}}} = -\\tan(\\theta_{p}) $$\n因为 $\\theta_{p} \\in (0, \\pi/2)$，所以 $\\alpha_{A}$ 的解为 $\\alpha_{A} = -\\theta_{p}$。测量角度 $\\psi_{A}$ 通过仪器偏移 $\\delta$ 与 $\\alpha_{A}$ 相关联：\n$$ \\psi_{A} = \\alpha_{A} + \\delta = -\\theta_{p} + \\delta $$\n\n**实验 B**：\n环向磁场反向，其值为 $-B_{t, \\mathrm{ref}}$。极向场 $B_p$ 保持不变。真实偏振角 $\\alpha_{B}$ 为：\n$$ \\tan(\\alpha_{B}) = -\\frac{B_{p}}{-B_{t, \\mathrm{ref}}} = \\frac{B_{p}}{B_{t, \\mathrm{ref}}} = \\tan(\\theta_{p}) $$\n$\\alpha_{B}$ 的解为 $\\alpha_{B} = \\theta_{p}$。测量角度 $\\psi_{B}$ 为：\n$$ \\psi_{B} = \\alpha_{B} + \\delta = \\theta_{p} + \\delta $$\n\n我们现在得到一个包含两个未知数 $\\theta_{p}$ 和 $\\delta$ 的二元线性方程组：\n1. $ \\psi_{A} = \\delta - \\theta_{p} $\n2. $ \\psi_{B} = \\delta + \\theta_{p} $\n\n为了求解 $\\delta$，我们将两个方程相加：\n$$ \\psi_{A} + \\psi_{B} = (\\delta - \\theta_{p}) + (\\delta + \\theta_{p}) = 2\\delta $$\n$$ \\delta = \\frac{\\psi_{A} + \\psi_{B}}{2} $$\n为了求解 $\\theta_{p}$，我们用第二个方程减去第一个方程：\n$$ \\psi_{B} - \\psi_{A} = (\\delta + \\theta_{p}) - (\\delta - \\theta_{p}) = 2\\theta_{p} $$\n$$ \\theta_{p} = \\frac{\\psi_{B} - \\psi_{A}}{2} $$\n\n现在，我们代入实验中的数值：$\\psi_{A} = -12.5^{\\circ}$ 和 $\\psi_{B} = +14.3^{\\circ}$。\n$$ \\delta = \\frac{-12.5^{\\circ} + 14.3^{\\circ}}{2} = \\frac{1.8^{\\circ}}{2} = 0.9^{\\circ} $$\n$$ \\theta_{p} = \\frac{14.3^{\\circ} - (-12.5^{\\circ})}{2} = \\frac{14.3^{\\circ} + 12.5^{\\circ}}{2} = \\frac{26.8^{\\circ}}{2} = 13.4^{\\circ} $$\n\n题目要求最终答案以弧度表示，并四舍五入到四位有效数字。我们使用转换因子 $\\pi \\text{ 弧度} = 180^{\\circ}$。\n$$ \\theta_{p} = 13.4^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} \\approx 0.2338746 \\text{ rad} $$\n$$ \\delta = 0.9^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} \\approx 0.01570796 \\text{ rad} $$\n四舍五入到四位有效数字：\n$$ \\theta_{p} \\approx 0.2339 \\text{ rad} $$\n$$ \\delta \\approx 0.01571 \\text{ rad} $$\n最终答案以行向量 $(\\theta_p, \\delta)$ 的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2339  0.01571\n\\end{pmatrix}\n}\n$$", "id": "3710066"}, {"introduction": "在静态校准之后，下一步是评估诊断系统在动态条件下的性能，这对于研究等离子体中的快速波动（如磁流体不稳定性）至关重要。本练习将理论与信号处理相结合，探讨了诊断系统的时间分辨率如何影响对振荡信号的测量。您将学习如何将仪器的时间积分效应和中性束的渡越时间效应建模为线性滤波器 [@problem_id:3710058]，并计算它们对测量信号幅度的衰减作用，从而更深刻地理解测量结果与真实物理过程之间的关系。", "problem": "氘动态斯塔克效应（MSE）偏振计通过观测中性束的巴尔末-α发射的偏振角，来推断环形聚变等离子体中的磁螺距角。在非相对论极限下，一个以速度$\\mathbf{v}$穿过磁场$\\mathbf{B}$的原子会感受到一个有效电场$\\mathbf{E}_{\\mathrm{mot}}=\\mathbf{v}\\times\\mathbf{B}$，这会产生斯塔克分裂并使发射的辐射产生线性偏振。对于标准的观测几何和适当的校准，测量的偏振角$\\theta_{p}(t)$在主导阶上跟踪局部的磁螺距角$\\gamma(t)$。\n\n假设真实的螺距角包含一个单模振荡，\n$$\n\\gamma(t)=\\gamma_{0}+A_{0}\\sin\\!\\left(2\\pi f_{0}\\,t\\right),\n$$\n其振幅为$A_{0}$，频率为$f_{0}$。偏振计采用同步解调，并通过在持续时间为$T_{\\mathrm{int}}$的矩形积分区间上对解调信号进行时间平均，从而在每个采集窗口形成一个估计值。光学收集几何定义了沿着弦长为$L$的中性束的一个有限空间范围，因此，在一个固定的观测位置，测量包含了穿过该区间的原子所发射的光；这会产生一个额外的有效矩形平均，其宽度等于中性束渡越时间$\\tau_{\\mathrm{tr}}=L/v_{b}$，其中$v_{b}$是由束能量$E_{b}$通过非相对论动能关系决定的中性束速度。你可以假设估计器对于围绕校准设定点的小角度扰动是线性的，原子的辐射寿命与$T_{\\mathrm{int}}$相比可以忽略不计，并且数据系统在每个不重叠的积分窗口内以足够的采样率采样一个估计值以避免混叠。\n\n仅从这些原理出发，推导从$\\gamma(t)$到测量值$\\theta_{\\mathrm{est}}(t)$的振幅传递函数，并用它计算在以下条件下$f_{0}$分量的测量振幅$A_{\\mathrm{meas}}$：\n- $E_{b}=80\\ \\text{keV}$ 氘，\n- $f_{0}=10^{4}\\ \\text{Hz}$，\n- $A_{0}=1.20\\ \\text{degrees}$，\n- $T_{\\mathrm{int}}=50\\ \\mu\\text{s}$，\n- $L=5.0\\ \\text{cm}$。\n\n你的最终答案$A_{\\mathrm{meas}}$用度表示，并将结果四舍五入到四位有效数字。", "solution": "用户希望找到由动态斯塔克效应（MSE）偏振计检测到的、聚变等离子体中振荡磁螺距角的测量振幅。测量过程涉及两种不同的平均效应，可以将其建模为作用于真实螺距角信号的线性滤波器。\n\n### 第1步：问题验证\n\n**1.1. 提取已知条件：**\n- 真实螺距角信号：$\\gamma(t)=\\gamma_{0}+A_{0}\\sin\\!\\left(2\\pi f_{0}\\,t\\right)$\n- 真实振幅：$A_{0}=1.20\\ \\text{degrees}$\n- 振荡频率：$f_{0}=10^{4}\\ \\text{Hz}$\n- 束类型：氘\n- 束能量：$E_{b}=80\\ \\text{keV}$\n- 积分时间：$T_{\\mathrm{int}}=50\\ \\mu\\text{s}$\n- 弦长：$L=5.0\\ \\text{cm}$\n- 束能量与速度之间的关系：非相对论动能关系，$E_b = \\frac{1}{2}m v_b^2$。\n- 渡越时间、弦长和束速度之间的关系：$\\tau_{\\mathrm{tr}}=L/v_{b}$\n- 估计器对于小角度扰动是线性的。\n- 测量受到两个矩形平均过程的影响：一个在$T_{\\mathrm{int}}$上，一个在$\\tau_{\\mathrm{tr}}$上。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题基于核聚变研究中广泛应用的动态斯塔克效应（MSE）诊断方法。其物理模型，包括动生电场$\\mathbf{E}_{\\mathrm{mot}}=\\mathbf{v}\\times\\mathbf{B}$以及使用线性系统理论对测量效应进行建模，都是标准且合适的。对于能量为$80\\ \\text{keV}$的氘束，非相对论近似是有效的，因为其动能（$0.080\\ \\text{MeV}$）远小于氘核的静止质量能量（约$1876\\ \\text{MeV}$）。\n- **适定性：** 问题提供了清晰的输入信号和测量系统的描述。它要求计算输出信号的振幅，这可以根据所提供的信息唯一确定。\n- **客观性：** 问题以精确、定量的术语陈述，没有歧义或主观内容。\n- **完整性和一致性：** 提供了所有必要的数据。问题是自洽的。氘的质量是一个可以查阅的标准物理常数。\n- **可行性：** 给定的频率、时间和长度尺度值对于现代托卡马克实验是符合实际的。\n\n**1.3. 结论与行动：**\n问题有效。将提供完整的解答。\n\n### 第2步：推导振幅传递函数\n\n测量过程被描述为线性的。因此，它可以用脉冲响应$h(t)$来表征，或者等效地，用频域传递函数$H(f) = \\mathcal{F}\\{h(t)\\}$来表征，其中$\\mathcal{F}$表示傅里叶变换。问题指出，测量过程涉及两个连续的平均效应，可以建模为两个线性时不变（LTI）滤波器的级联。总传递函数$H(f)$是各个传递函数的乘积。\n\n**2.1. 滤波器1：时间积分**\n偏振计在持续时间为$T_{\\mathrm{int}}$的区间上执行时间平均。这对应于输入信号与一个宽度为$T_{\\mathrm{int}}$、幅度为$1/T_{\\mathrm{int}}$的矩形脉冲的卷积。其脉冲响应为$h_{\\mathrm{int}}(t) = \\frac{1}{T_{\\mathrm{int}}}\\text{rect}(\\frac{t}{T_{\\mathrm{int}}})$, 其中当$|x| \\le 1/2$时$\\text{rect}(x)$为1，否则为0。相应的传递函数是该脉冲的傅里叶变换：\n$$\nH_{\\mathrm{int}}(f) = \\mathcal{F}\\left\\{\\frac{1}{T_{\\mathrm{int}}}\\text{rect}\\left(\\frac{t}{T_{\\mathrm{int}}}\\right)\\right\\} = \\frac{\\sin(\\pi f T_{\\mathrm{int}})}{\\pi f T_{\\mathrm{int}}}\n$$\n这通常使用归一化sinc函数$\\text{sinc}(x) = \\sin(\\pi x)/(\\pi x)$来表示。因此，\n$$\nH_{\\mathrm{int}}(f) = \\text{sinc}(f T_{\\mathrm{int}})\n$$\n\n**2.2. 滤波器2：空间（渡越时间）平均**\n测量对沿着弦长$L$发射的光进行积分。中性束原子以速度$v_b$行进这段距離。这种空间积分等效于在渡越时间$\\tau_{\\mathrm{tr}} = L/v_b$上的时间平均。这个效应是另一个矩形平均滤波器，其脉冲响应为$h_{\\mathrm{tr}}(t) = \\frac{1}{\\tau_{\\mathrm{tr}}}\\text{rect}(\\frac{t}{\\tau_{\\mathrm{tr}}})$。相应的传递函数是：\n$$\nH_{\\mathrm{tr}}(f) = \\mathcal{F}\\left\\{\\frac{1}{\\tau_{\\mathrm{tr}}}\\text{rect}\\left(\\frac{t}{\\tau_{\\mathrm{tr}}}\\right)\\right\\} = \\frac{\\sin(\\pi f \\tau_{\\mathrm{tr}})}{\\pi f \\tau_{\\mathrm{tr}}} = \\text{sinc}(f \\tau_{\\mathrm{tr}})\n$$\n\n**2.3. 总传递函数**\n对于一个级联系统，总传递函数是各个传递函数的乘积：\n$$\nH(f) = H_{\\mathrm{int}}(f) \\cdot H_{\\mathrm{tr}}(f) = \\text{sinc}(f T_{\\mathrm{int}}) \\cdot \\text{sinc}(f \\tau_{\\mathrm{tr}})\n$$\n对于正弦输入信号$\\gamma(t) = \\gamma_0 + A_0 \\sin(2\\pi f_0 t)$，测量信号的振荡分量的振幅$A_{\\mathrm{meas}}$将由输入振幅$A_0$乘以在输入频率$f_0$处求值的传递函数的模给出。\n$$\nA_{\\mathrm{meas}} = A_0 \\cdot |H(f_0)| = A_0 \\cdot |\\text{sinc}(f_0 T_{\\mathrm{int}}) \\cdot \\text{sinc}(f_0 \\tau_{\\mathrm{tr}})|\n$$\n\n### 第3步：数值计算\n\n**3.1. 计算束速度 ($v_b$)**\n我们使用非相对论动能公式$E_b = \\frac{1}{2} m_d v_b^2$，其中$m_d$是氘核的质量。\n首先，将束能量$E_b$转换为焦耳：\n$E_b = 80\\ \\text{keV} = 80 \\times 10^3 \\text{ eV} = 80 \\times 10^3 \\cdot (1.602176634 \\times 10^{-19} \\text{ J}) = 1.2817413 \\times 10^{-14} \\text{ J}$。\n氘核的质量为$m_d \\approx 3.3435837 \\times 10^{-27} \\text{ kg}$。\n现在，求解$v_b$：\n$$\nv_b = \\sqrt{\\frac{2 E_b}{m_d}} = \\sqrt{\\frac{2 \\cdot (1.2817413 \\times 10^{-14} \\text{ J})}{3.3435837 \\times 10^{-27} \\text{ kg}}} \\approx 2.76899 \\times 10^6 \\text{ m/s}\n$$\n\n**3.2. 计算渡越时间 ($\\tau_{\\mathrm{tr}}$)**\n弦长为 $L = 5.0\\ \\text{cm} = 0.050\\ \\text{m}$。\n$$\n\\tau_{\\mathrm{tr}} = \\frac{L}{v_b} = \\frac{0.050 \\text{ m}}{2.76899 \\times 10^6 \\text{ m/s}} \\approx 1.80571 \\times 10^{-8} \\text{ s}\n$$\n\n**3.3. 计算在$f_0$处的传递函数模**\n已知$f_0 = 10^4\\ \\text{Hz}$和$T_{\\mathrm{int}} = 50\\ \\mu\\text{s} = 5.0 \\times 10^{-5}\\ \\text{s}$。\nsinc函数的自变量为：\n- 对于积分时间：$x_{\\mathrm{int}} = f_0 T_{\\mathrm{int}} = (10^4 \\text{ Hz}) \\cdot (5.0 \\times 10^{-5} \\text{ s}) = 0.5$。\n- 对于渡越时间：$x_{\\mathrm{tr}} = f_0 \\tau_{\\mathrm{tr}} = (10^4 \\text{ Hz}) \\cdot (1.80571 \\times 10^{-8} \\text{ s}) = 1.80571 \\times 10^{-4}$。\n\n现在使用定义$\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$计算传递函数的分量：\n- $H_{\\mathrm{int}}(f_0) = \\text{sinc}(0.5) = \\frac{\\sin(\\pi \\cdot 0.5)}{\\pi \\cdot 0.5} = \\frac{\\sin(\\pi/2)}{\\pi/2} = \\frac{1}{\\pi/2} = \\frac{2}{\\pi}$。\n- $H_{\\mathrm{tr}}(f_0) = \\text{sinc}(1.80571 \\times 10^{-4})$。由于自变量非常小，这个值非常接近1。更精确地：\n$$\n\\text{sinc}(1.80571 \\times 10^{-4}) = \\frac{\\sin(\\pi \\cdot 1.80571 \\times 10^{-4})}{\\pi \\cdot 1.80571 \\times 10^{-4}} \\approx 0.999999946\n$$\n总传递函数的模为：\n$$\n|H(f_0)| = |\\text{sinc}(0.5) \\cdot \\text{sinc}(1.80571 \\times 10^{-4})| = \\left|\\frac{2}{\\pi} \\cdot 0.999999946\\right| \\approx 0.63661973\n$$\n由于所有自变量都为正且小于1，sinc函数均为正值，因此绝对值是多余的。\n\n**3.4. 计算测量振幅 ($A_{\\mathrm{meas}}$)**\n最后，使用给定的真实振幅$A_0 = 1.20\\ \\text{degrees}$计算测量振幅：\n$$\nA_{\\mathrm{meas}} = A_0 \\cdot |H(f_0)| = 1.20 \\text{ degrees} \\cdot 0.63661973 \\approx 0.76394368 \\text{ degrees}\n$$\n将结果四舍五入到四位有效数字得到$0.7639\\ \\text{degrees}$。", "answer": "$$\n\\boxed{0.7639}\n$$", "id": "3710058"}, {"introduction": "真实等离子体环境的复杂性要求我们建立超越理想化假设的精细物理模型。这个综合性练习要求您从基本原理出发，构建一个包含碰撞辐射过程、退极化效应以及未分辨谱线精细结构等多种真实物理效应的完整MSE前向模型。通过编写代码实现该算法 [@problem_id:3710071]，您将把理论知识转化为可执行的计算工具，直接模拟在不同等离子体条件下MSE诊断的响应，这代表了从理论物理到实验数据分析的关键一步。", "problem": "将一束中性氢诊断束注入环形磁约束装置中，利用动斯塔克效应（MSE）来推断磁螺距角。在运动中性粒子的静止坐标系中，动生电场由Lorentz变换产生，并通过矢量叉乘给出。产生的巴尔末-α发射具有线性偏振分量，其取向由局域动生电场决定，但观测到的偏振可能会受到碰撞-辐射过程和原子排列退偏振的影响。\n\n从基本原理和经过充分检验的公式出发，推导一个计算推断磁螺距角的算法，其中包括碰撞-辐射源项和碰撞退偏振对未分辨斯塔克分量的影响。然后将此算法实现为一个完整、可运行的程序，该程序能够评估指定的测试套件，并以精确的格式输出所需结果。\n\n使用以下建模假设和定义：\n\n- 动斯塔克效应 (MSE)：在磁场 $\\mathbf{B}$ 中以速度 $\\mathbf{v}$ 运动的中性粒子所感受到的动生电场为 $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$。发射辐射的主要线性偏振方向与 $\\mathbf{E}$ 在观测平面上的投影方向一致。\n- 坐标系：令 $\\hat{\\mathbf{t}}$ 表示环向单位矢量，$\\hat{\\mathbf{p}}$ 表示极向单位矢量，$\\hat{\\mathbf{r}}$ 表示径向单位矢量。假设束速度为 $\\mathbf{v} = v \\, \\hat{\\mathbf{r}}$，相机沿 $\\hat{\\mathbf{r}}$ 方向观测，因此观测平面由 $\\hat{\\mathbf{t}}$ 和 $\\hat{\\mathbf{p}}$ 张成。\n- 磁螺距角：定义磁螺距角 $\\psi$ 为 $\\psi = \\arctan2(B_{\\mathrm{p}}, B_{\\mathrm{t}})$，其中 $B_{\\mathrm{t}}$ 是 $\\mathbf{B}$ 的环向分量，$B_{\\mathrm{p}}$ 是 $\\mathbf{B}$ 的极向分量。角度必须以弧度表示。\n- 未分辨的斯塔克分量：将发射建模为两个由 $i \\in \\{1,2\\}$ 索引的未分辨谱线分量的非相干和，每个分量具有内禀线性偏振度 $P_i^0$ 和偏振角 $\\theta_i$，其与动生电场取向 $\\theta_E$ 的偏移量为 $\\pm \\delta$，即 $\\theta_1 = \\theta_E + \\delta$ 和 $\\theta_2 = \\theta_E - \\delta$。这些偏移量解释了仪器无法单独分辨的精细结构子能级的各向异性。\n- 碰撞-辐射稳态：对每个分量 $i$，将谱线强度建模为 $$I_i = \\frac{S_i}{A_i + \\gamma_{q,i}},$$ 其中 $S_i$ 是由激发和束碰撞过程产生的有效源率，$A_i$ 是Einstein自发辐射率，$\\gamma_{q,i}$ 是碰撞淬灭率。令源为 $$S_i = n_e C_i + S_{\\mathrm{beam},i},$$ 其中 $n_e$ 是电子密度，$C_i$ 是电子碰撞激发速率系数，$S_{\\mathrm{beam},i}$ 是一个与束相关的源项。\n- 排列的退偏振：分量 $i$ 观测到的线性偏振度因原子排列的碰撞退偏振而降低，其关系式为 $$P_i = P_i^0 \\, \\frac{A_i}{A_i + \\gamma_{\\mathrm{dep},i}},$$ 其中 $\\gamma_{\\mathrm{dep},i}$ 是二阶排列的退偏振率。\n- 斯托克斯参数合成：对每个分量，线性斯托克斯参数为 $$Q_i = P_i I_i \\cos(2 \\theta_i), \\quad U_i = P_i I_i \\sin(2 \\theta_i).$$ 总线性斯托克斯参数为 $Q = Q_1 + Q_2$ 和 $U = U_1 + U_2$。观测平面内的净观测偏振角为 $$\\theta_{\\mathrm{meas}} = \\frac{1}{2} \\arctan2(U, Q).$$\n- 角度恢复与归一化：在所述几何条件下，观测平面内动生电场的取向与磁螺距角的关系为 $$\\theta_E = \\arctan2(E_y, E_x), \\quad \\mathbf{E} = v B_{\\mathrm{t}} \\, \\hat{\\mathbf{p}} - v B_{\\mathrm{p}} \\, \\hat{\\mathbf{t}},$$ 因此 $$\\theta_E = \\arctan2(B_{\\mathrm{t}}, -B_{\\mathrm{p}}), \\quad \\psi = \\theta_E - \\frac{\\pi}{2} \\quad (\\mathrm{mod} \\ \\pi).$$ 将推斷的磁螺距角估计值恢复为 $$\\hat{\\psi} = \\theta_{\\mathrm{meas}} - \\frac{\\pi}{2},$$ 并通过加减 $\\pi$ 的整数倍将 $\\hat{\\psi}$ 归一化到主区间 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$。\n- 数值稳健性：如果相对于总强度的净线性偏振度 $P_{\\mathrm{net}} = \\frac{\\sqrt{Q^2 + U^2}}{I_1 + I_2}$，低于阈值 $\\varepsilon$，则设置 $\\theta_{\\mathrm{meas}} = \\theta_E$ 以避免角度恢复中的数值不稳定性。使用 $\\varepsilon = 10^{-6}$。\n\n将上述内容实现为一个评估以下测试套件的程序。所有物理量均采用国际单位制（SI）单位：磁场单位为特斯拉，速度单位为米/秒，速率单位为秒⁻¹，密度单位为米⁻³，角度单位为弧度。程序必须按如下规定，为每个案例生成以弧度表示的推断磁螺距角。\n\n测试套件参数集 (每个案例列出了 $(B_{\\mathrm{t}}, B_{\\mathrm{p}}, v, A_1, A_2, \\gamma_{\\mathrm{dep},1}, \\gamma_{\\mathrm{dep},2}, \\gamma_{q,1}, \\gamma_{q,2}, n_e, C_1, C_2, S_{\\mathrm{beam},1}, S_{\\mathrm{beam},2}, P_1^0, P_2^0, \\delta)$):\n\n- 案例1 (基准，低密度，近平衡分量):\n  - $(B_{\\mathrm{t}}, B_{\\mathrm{p}}) = (2.1, 0.3)$\n  - $v = 2.5 \\times 10^{6}$\n  - $(A_1, A_2) = (4.7 \\times 10^{7}, 4.7 \\times 10^{7})$\n  - $(\\gamma_{\\mathrm{dep},1}, \\gamma_{\\mathrm{dep},2}) = (1.0 \\times 10^{6}, 1.0 \\times 10^{6})$\n  - $(\\gamma_{q,1}, \\gamma_{q,2}) = (5.0 \\times 10^{5}, 5.0 \\times 10^{5})$\n  - $n_e = 1.0 \\times 10^{19}$\n  - $(C_1, C_2) = (1.0 \\times 10^{-14}, 1.0 \\times 10^{-14})$\n  - $(S_{\\mathrm{beam},1}, S_{\\mathrm{beam},2}) = (1.0 \\times 10^{6}, 1.0 \\times 10^{6})$\n  - $(P_1^0, P_2^0) = (0.8, 0.8)$\n  - $\\delta = 0.03490658503988659$ (即，$2$ 度对应的弧度值)\n- 案例2 (中等密度，退偏振和CR不平衡):\n  - $(B_{\\mathrm{t}}, B_{\\mathrm{p}}) = (3.0, 0.9)$\n  - $v = 2.2 \\times 10^{6}$\n  - $(A_1, A_2) = (4.7 \\times 10^{7}, 4.5 \\times 10^{7})$\n  - $(\\gamma_{\\mathrm{dep},1}, \\gamma_{\\mathrm{dep},2}) = (2.0 \\times 10^{7}, 1.5 \\times 10^{7})$\n  - $(\\gamma_{q,1}, \\gamma_{q,2}) = (5.0 \\times 10^{6}, 7.0 \\times 10^{6})$\n  - $n_e = 5.0 \\times 10^{19}$\n  - $(C_1, C_2) = (1.0 \\times 10^{-14}, 0.8 \\times 10^{-14})$\n  - $(S_{\\mathrm{beam},1}, S_{\\mathrm{beam},2}) = (3.0 \\times 10^{6}, 2.0 \\times 10^{6})$\n  - $(P_1^0, P_2^0) = (0.8, 0.75)$\n  - $\\delta = 0.05$\n- 案例3 (高退偏振，极小的极向场):\n  - $(B_{\\mathrm{t}}, B_{\\mathrm{p}}) = (2.5, 0.01)$\n  - $v = 2.5 \\times 10^{6}$\n  - $(A_1, A_2) = (4.7 \\times 10^{7}, 4.7 \\times 10^{7})$\n  - $(\\gamma_{\\mathrm{dep},1}, \\gamma_{\\mathrm{dep},2}) = (1.0 \\times 10^{9}, 1.0 \\times 10^{9})$\n  - $(\\gamma_{q,1}, \\gamma_{q,2}) = (1.0 \\times 10^{7}, 1.0 \\times 10^{7})$\n  - $n_e = 1.0 \\times 10^{20}$\n  - $(C_1, C_2) = (1.0 \\times 10^{-14}, 1.0 \\times 10^{-14})$\n  - $(S_{\\mathrm{beam},1}, S_{\\mathrm{beam},2}) = (1.0 \\times 10^{6}, 1.0 \\times 10^{6})$\n  - $(P_1^0, P_2^0) = (0.8, 0.8)$\n  - $\\delta = 0.02$\n- 案例4 (极向场反号，不对称速率):\n  - $(B_{\\mathrm{t}}, B_{\\mathrm{p}}) = (2.0, -0.2)$\n  - $v = 2.5 \\times 10^{6}$\n  - $(A_1, A_2) = (4.8 \\times 10^{7}, 4.6 \\times 10^{7})$\n  - $(\\gamma_{\\mathrm{dep},1}, \\gamma_{\\mathrm{dep},2}) = (3.0 \\times 10^{7}, 2.0 \\times 10^{7})$\n  - $(\\gamma_{q,1}, \\gamma_{q,2}) = (1.0 \\times 10^{6}, 2.0 \\times 10^{6})$\n  - $n_e = 2.0 \\times 10^{19}$\n  - $(C_1, C_2) = (1.2 \\times 10^{-14}, 1.0 \\times 10^{-14})$\n  - $(S_{\\mathrm{beam},1}, S_{\\mathrm{beam},2}) = (1.5 \\times 10^{6}, 1.3 \\times 10^{6})$\n  - $(P_1^0, P_2^0) = (0.85, 0.80)$\n  - $\\delta = 0.03$\n\n算法要求：\n\n- 根据 $\\mathbf{E} = v B_{\\mathrm{t}} \\, \\hat{\\mathbf{p}} - v B_{\\mathrm{p}} \\, \\hat{\\mathbf{t}}$ 计算 $\\theta_E = \\arctan2(B_{\\mathrm{t}}, -B_{\\mathrm{p}})$。\n- 对于每个分量 $i$，计算 $S_i, I_i, P_i, \\theta_i$，然后计算斯托克斯参数 $Q_i$ 和 $U_i$；求和得到 $Q, U$；计算 $\\theta_{\\mathrm{meas}}$；如果需要，应用小偏振度回退（使用 $\\varepsilon = 10^{-6}$），设置 $\\theta_{\\mathrm{meas}} = \\theta_E$。\n- 计算 $\\hat{\\psi} = \\theta_{\\mathrm{meas}} - \\frac{\\pi}{2}$ 并将 $\\hat{\\psi}$ 归一化到 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含所有案例推断出的磁螺距角 $\\hat{\\psi}$（以弧度为单位），形式为方括号括起来的逗号分隔列表（例如，$[\\hat{\\psi}_1,\\hat{\\psi}_2,\\hat{\\psi}_3,\\hat{\\psi}_4]$）。不应打印任何其他文本。", "solution": "该问题要求推导并实现一个算法，用以根据磁约束等离子体中的动斯塔克效应（MSE）测量值计算推断的磁螺距角 $\\hat{\\psi}$。该模型必须考虑碰撞-辐射（CR）效应、碰撞退偏振以及未分辨的精细结构分量的存在。问题陈述已经过验证，被认为是科学上合理、适定且内部一致的。我们现在将着手对解决方案进行系统性的、基于原理的推导。\n\n该算法按顺序进行：首先根据磁场和电场确定理想的偏振取向，然后计算两个未分辨光谱线分量各自的强度和偏振态，接着将它们组合以求得净观测偏振，最后根据此观测结果推断磁螺距角。\n\n**步骤1：确定理想偏振角 $\\theta_E$**\n\n中性束粒子以速度 $\\mathbf{v}$ 穿过磁场 $\\mathbf{B}$，在其静止坐标系中感受到一个由Lorentz变换给出的动生电场 $\\mathbf{E}$：\n$$ \\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B} $$\n问题定义了一个右手坐标系，其单位矢量 $(\\hat{\\mathbf{r}}, \\hat{\\mathbf{p}}, \\hat{\\mathbf{t}})$ 分别对应径向、极向和环向。束速度被设定为纯径向，$\\mathbf{v} = v \\, \\hat{\\mathbf{r}}$，且关心平面（即观测平面）内的磁场为 $\\mathbf{B} = B_{\\mathrm{p}} \\, \\hat{\\mathbf{p}} + B_{\\mathrm{t}} \\, \\hat{\\mathbf{t}}$。\n\n叉乘计算如下：\n$$ \\mathbf{E} = - (v \\, \\hat{\\mathbf{r}}) \\times (B_{\\mathrm{p}} \\, \\hat{\\mathbf{p}} + B_{\\mathrm{t}} \\, \\hat{\\mathbf{t}}) = -v B_{\\mathrm{p}} (\\hat{\\mathbf{r}} \\times \\hat{\\mathbf{p}}) - v B_{\\mathrm{t}} (\\hat{\\mathbf{r}} \\times \\hat{\\mathbf{t}}) $$\n利用右手系的恒等式 $\\hat{\\mathbf{r}} \\times \\hat{\\mathbf{p}} = \\hat{\\mathbf{t}}$ 和 $\\hat{\\mathbf{r}} \\times \\hat{\\mathbf{t}} = -\\hat{\\mathbf{p}}$，我们得到：\n$$ \\mathbf{E} = -v B_{\\mathrm{p}} \\, \\hat{\\mathbf{t}} - v B_{\\mathrm{t}} (-\\hat{\\mathbf{p}}) = v B_{\\mathrm{t}} \\, \\hat{\\mathbf{p}} - v B_{\\mathrm{p}} \\, \\hat{\\mathbf{t}} $$\n这与问题中提供的表达式相符。观测平面由 $\\hat{\\mathbf{t}}$ 和 $\\hat{\\mathbf{p}}$ 张成。将环向 $\\hat{\\mathbf{t}}$ 与观测平面的水平轴（$x$轴）关联，极向 $\\hat{\\mathbf{p}}$ 与垂直轴（$y$轴）关联，则动生电场的分量为 $E_x = -v B_{\\mathrm{p}}$ 和 $E_y = v B_{\\mathrm{t}}$。\n\n该电场的取向角 $\\theta_E$ 由下式给出：\n$$ \\theta_E = \\arctan2(E_y, E_x) = \\arctan2(v B_{\\mathrm{t}}, -v B_{\\mathrm{p}}) $$\n由于 $v > 0$，此式可简化为问题中给出的公式：\n$$ \\theta_E = \\arctan2(B_{\\mathrm{t}}, -B_{\\mathrm{p}}) $$\n\n**步骤2：对发射分量建模**\n\n总发射被建模为两个由 $i \\in \\{1, 2\\}$ 索引的未分辨斯塔克分量的非相干和。对于每个分量，我们必须计算其强度 $I_i$ 和观测到的偏振度 $P_i$。\n\n源率 $S_i$ 是电子碰撞激发和束相关过程贡献的总和：\n$$ S_i = n_e C_i + S_{\\mathrm{beam},i} $$\n强度 $I_i$ 由该源率与自发辐射（$A_i$）和碰撞淬灭（$\\gamma_{q,i}$）的退布居率之间的平衡决定：\n$$ I_i = \\frac{S_i}{A_i + \\gamma_{q,i}} $$\n内禀线性偏振 $P_i^0$ 因原子排列的碰撞退偏振而降低，其速率为 $\\gamma_{\\mathrm{dep},i}$。观测到的偏振度 $P_i$ 为：\n$$ P_i = P_i^0 \\frac{A_i}{A_i + \\gamma_{\\mathrm{dep},i}} $$\n两个分量的偏振角 $\\theta_1$ 和 $\\theta_2$ 相对于动生电场取向 $\\theta_E$ 对称地偏移一个角度 $\\delta$：\n$$ \\theta_1 = \\theta_E + \\delta $$\n$$ \\theta_2 = \\theta_E - \\delta $$\n\n**步骤3：合成净斯托克斯参数**\n\n线性偏振态由斯托克斯参数 $Q$ 和 $U$ 描述。对每个分量，它们是：\n$$ Q_i = P_i I_i \\cos(2\\theta_i) $$\n$$ U_i = P_i I_i \\sin(2\\theta_i) $$\n由于假设各分量为非相干和，总斯托克斯参数是各分量参数之和：\n$$ Q = Q_1 + Q_2 $$\n$$ U = U_1 + U_2 $$\n\n**步骤4：确定测量的偏振角 $\\theta_{\\mathrm{meas}}$**\n\n净观测偏振角 $\\theta_{\\mathrm{meas}}$ 从总斯托克斯参数导出：\n$$ \\theta_{\\mathrm{meas}} = \\frac{1}{2}\\arctan2(U, Q) $$\n需要进行数值稳健性检查。如果净线性偏振度 $P_{\\mathrm{net}}$ 低于阈值 $\\varepsilon = 10^{-6}$，则认为测量不可靠，并将该角默认设为理想角 $\\theta_E$。\n$$ P_{\\mathrm{net}} = \\frac{\\sqrt{Q^2 + U^2}}{I_1 + I_2} $$\n其逻辑如下：\n- 如果 $P_{\\mathrm{net}}  \\varepsilon$，则 $\\theta_{\\mathrm{meas}} = \\theta_E$。\n- 否则，$\\theta_{\\mathrm{meas}} = \\frac{1}{2}\\arctan2(U, Q)$。\n\n**步骤5：推断并归一化磁螺距角 $\\hat{\\psi}$**\n\n磁螺距角 $\\psi$ 定义为 $\\psi = \\arctan2(B_{\\mathrm{p}}, B_{\\mathrm{t}})$。$\\psi$ 与动生电场角 $\\theta_E$ 之间的关系是 $\\psi = \\theta_E - \\frac{\\pi}{2}$ (模 $\\pi$)。推断的螺距角 $\\hat{\\psi}$ 是通过用测量角 $\\theta_{\\mathrm{meas}}$ 替换理想角 $\\theta_E$ 得到的：\n$$ \\hat{\\psi} = \\theta_{\\mathrm{meas}} - \\frac{\\pi}{2} $$\n最后，这个推断角必须归一化到主区间 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$。这可以通过重复加或减 $\\pi$ 直至数值落在所需范围内来实现。一个稳健的迭代过程如下：\n1. 令 $\\phi = \\hat{\\psi}$。\n2. 当 $\\phi \\le -\\frac{\\pi}{2}$ 时，令 $\\phi \\leftarrow \\phi + \\pi$。\n3. 当 $\\phi  \\frac{\\pi}{2}$ 时，令 $\\phi \\leftarrow \\phi - \\pi$。\n最终结果为 $\\phi$。\n\n至此完成了算法的推导。实现部分将对每个给定的测试案例遵循以上步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the inferred magnetic pitch angle based on the Motional Stark Effect model.\n    \"\"\"\n    # Test suite parameter sets:\n    # (B_t, B_p, v, A_1, A_2, gamma_dep_1, gamma_dep_2, gamma_q_1, gamma_q_2, \n    #  n_e, C_1, C_2, S_beam_1, S_beam_2, P_1_0, P_2_0, delta)\n    test_cases = [\n        # Case 1 (baseline, low density, near-balanced components)\n        (2.1, 0.3, 2.5e6, 4.7e7, 4.7e7, 1.0e6, 1.0e6, 5.0e5, 5.0e5, \n         1.0e19, 1.0e-14, 1.0e-14, 1.0e6, 1.0e6, 0.8, 0.8, 0.03490658503988659),\n        # Case 2 (moderate density, depolarization and CR imbalance)\n        (3.0, 0.9, 2.2e6, 4.7e7, 4.5e7, 2.0e7, 1.5e7, 5.0e6, 7.0e6, \n         5.0e19, 1.0e-14, 0.8e-14, 3.0e6, 2.0e6, 0.8, 0.75, 0.05),\n        # Case 3 (high depolarization, very small poloidal field)\n        (2.5, 0.01, 2.5e6, 4.7e7, 4.7e7, 1.0e9, 1.0e9, 1.0e7, 1.0e7, \n         1.0e20, 1.0e-14, 1.0e-14, 1.0e6, 1.0e6, 0.8, 0.8, 0.02),\n        # Case 4 (sign-reversed poloidal field, asymmetric rates)\n        (2.0, -0.2, 2.5e6, 4.8e7, 4.6e7, 3.0e7, 2.0e7, 1.0e6, 2.0e6, \n         2.0e19, 1.2e-14, 1.0e-14, 1.5e6, 1.3e6, 0.85, 0.80, 0.03),\n    ]\n\n    results = []\n    \n    # Numerical robustness threshold\n    epsilon = 1e-6\n\n    for case in test_cases:\n        (B_t, B_p, v, A1, A2, gamma_dep1, gamma_dep2, gamma_q1, gamma_q2, \n         n_e, C1, C2, S_beam1, S_beam2, P1_0, P2_0, delta) = case\n\n        # Step 1: Calculate Electric Field Orientation, theta_E\n        theta_E = np.arctan2(B_t, -B_p)\n\n        # Step 2: Calculate properties for each component\n        # Component 1\n        S1 = n_e * C1 + S_beam1\n        I1 = S1 / (A1 + gamma_q1)\n        P1 = P1_0 * (A1 / (A1 + gamma_dep1))\n        theta1 = theta_E + delta\n\n        # Component 2\n        S2 = n_e * C2 + S_beam2\n        I2 = S2 / (A2 + gamma_q2)\n        P2 = P2_0 * (A2 / (A2 + gamma_dep2))\n        theta2 = theta_E - delta\n\n        # Step 3: Synthesize total Stokes parameters\n        # Component 1 Stokes parameters\n        Q1 = P1 * I1 * np.cos(2 * theta1)\n        U1 = P1 * I1 * np.sin(2 * theta1)\n\n        # Component 2 Stokes parameters\n        Q2 = P2 * I2 * np.cos(2 * theta2)\n        U2 = P2 * I2 * np.sin(2 * theta2)\n\n        # Total Stokes parameters\n        Q_total = Q1 + Q2\n        U_total = U1 + U2\n\n        # Step 4: Calculate Measured Polarization Angle, theta_meas\n        I_total = I1 + I2\n        \n        # Avoid division by zero if total intensity is zero\n        if I_total == 0:\n            P_net = 0\n        else:\n            P_net = np.sqrt(Q_total**2 + U_total**2) / I_total\n\n        if P_net  epsilon:\n            theta_meas = theta_E\n        else:\n            theta_meas = 0.5 * np.arctan2(U_total, Q_total)\n\n        # Step 5: Infer and normalize the magnetic pitch angle\n        psi_hat_raw = theta_meas - np.pi / 2\n        \n        # Normalize psi_hat to the interval (-pi/2, pi/2]\n        psi_hat = psi_hat_raw\n        while psi_hat = -np.pi / 2:\n            psi_hat += np.pi\n        while psi_hat > np.pi / 2:\n            psi_hat -= np.pi\n            \n        results.append(psi_hat)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3710071"}]}