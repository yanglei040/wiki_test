{"hands_on_practices": [{"introduction": "微波反射计的核心是通过测量反射波的相位延迟来推断等离子体密度分布。但除了沿路径累积的相位外，在截止层反射的瞬间会发生什么？本练习将挑战您超越简单的 WKB 近似，使用更精确的全波分析来计算反射系数，揭示在截止点发生的关键相移。理解这个物理细节对于从原始数据中准确重构密度剖面至关重要。[@problem_id:3709516]", "problem": "一维垂直入射的寻常模（O-模）微波反射计探测一个磁化等离子体，其电子密度分布沿坐标 $x$ 单调递增，其中 $x=0$ 表示角频率为 $\\omega$ 的截止位置。将等离子体视为冷的且无碰撞的，因此横向电场 $E(x)$ 服从从冷等离子体中的麦克斯韦方程组推导出的标量波动方程：\n$$\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0,$$\n其中\n$$k^{2}(x) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega_{p}^{2}(x)}{\\omega^{2}}\\right),\\quad \\omega_{p}^{2}(x) = \\frac{n_{e}(x)e^{2}}{\\varepsilon_{0} m_{e}},$$\n这里 $c$ 是光速，$e$ 是元电荷，$\\varepsilon_{0}$ 是真空介电常数，$m_{e}$ 是电子质量。假设在截止点附近，等离子体频率的平方是局域线性的，\n$$\\omega_{p}^{2}(x) \\approx \\omega^{2} + \\frac{\\omega^{2}}{L_{n}}\\,x,$$\n具有恒定的密度标长 $L_{n}0$，因此转折点位于 $x=0$，振荡区为 $x0$。\n\n将振荡区中的前向和后向 Wentzel–Kramers–Brillouin (WKB) 波定义为\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\,\\exp\\!\\left(i\\int_{x}^{0}\\!k(s)\\,ds\\right) + A_{r}\\,\\exp\\!\\left(-i\\int_{x}^{0}\\!k(s)\\,ds\\right)\\right],$$\n且指数相位中不包含额外的恒定相位偏移。复反射系数定义为 $R \\equiv A_{r}/A_{i}$。\n\n仅使用基本的波传播原理和单个转折点附近的渐近匹配：\n- 在一个实值的、无损的转折点强加单位反射率且没有任何转折点相位偏移的假设下，推导反射系数 $R_{\\text{WKB}}$ 的领头阶 WKB 预测。\n- 独立地，通过适当的变量缩放将 $x=0$ 附近的局域波动方程简化为 Airy 方程，来进行全波分析；对 $x0$ 施加衰减的物理条件，并使用大负宗量渐近式与 $x0$ 的振荡 WKB 形式进行匹配。在与上述相同的相位归一化下，提取相应的全波反射系数 $R_{\\text{Airy}}$。\n- 对于中等梯度（有限的 $L_{n}$），通过计算幅度差 $\\Delta|R| \\equiv |R_{\\text{Airy}}| - |R_{\\text{WKB}}|$ 和相位差 $\\Delta\\phi \\equiv \\arg(R_{\\text{Airy}}) - \\arg(R_{\\text{WKB}})$ 来量化两种方法之间的差异。\n\n将你的最终答案表示为双分量行向量 $\\big[\\Delta|R|,\\ \\Delta\\phi\\big]$，其中 $\\Delta|R|$ 是无量纲的，$\\Delta\\phi$ 以弧度为单位。无需四舍五入；请提供精确结果。", "solution": "问题陈述已经过验证，被认为是波动物理学中一个有效、自洽且有科学依据的问题。尽管在描述性文本中关于“前向”和“后向”波的记法存在微小的模糊性，但所提供的数学定义是明确且充分的，足以得出唯一解。我们将严格遵守所提供的数学定义。\n\n该问题要求比较简化的 Wentzel–Kramers–Brillouin (WKB) 反射模型与使用 Airy 方程的全波分析。目标是计算从这两种方法推导出的反射系数在幅度和相位上的差异。\n\n首先，我们澄清反射系数的记法。问题将振荡区 ($x0$) 的 WKB 解定义为：\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\,\\exp\\!\\left(i\\int_{x}^{0}\\!k(s)\\,ds\\right) + A_{r}\\,\\exp\\!\\left(-i\\int_{x}^{0}\\!k(s)\\,ds\\right)\\right]$$\n为确定哪一项对应入射波，哪一项对应反射波，我们分析相传播的方向。假设时间依赖关系为 $\\exp(-i\\omega t)$，则每一项的总相位为：\n1.  含 $A_{i}$ 的项：相位为 $\\phi_{i}(x,t) = \\int_{x}^{0} k(s)\\,ds - \\omega t$。相速度为 $v_{p} = -\\frac{\\partial \\phi_{i}/\\partial t}{\\partial \\phi_{i}/\\partial x} = -\\frac{-\\omega}{-k(x)} = -\\frac{\\omega}{k(x)}$。由于当 $x0$ 时 $k(x)0$，因此 $v_{p}0$。此波沿 $-x$ 方向传播，远离位于 $x=0$ 的截止点，因此是**反射波**。\n2.  含 $A_{r}$ 的项：相位为 $\\phi_{r}(x,t) = -\\int_{x}^{0} k(s)\\,ds - \\omega t$。相速度为 $v_{p} = -\\frac{\\partial \\phi_{r}/\\partial t}{\\partial \\phi_{r}/\\partial x} = -\\frac{-\\omega}{k(x)} = \\frac{\\omega}{k(x)}$。由于当 $x0$ 时 $k(x)0$，因此 $v_{p}0$。此波沿 $+x$ 方向传播，朝向位于 $x=0$ 的截止点，因此是**入射波**。\n\n因此，$A_{i}$ 是反射波的复振幅，$A_{r}$ 是入射波的复振幅。反射系数定义为 $R \\equiv A_{r}/A_{i}$。这是入射波振幅与反射波振幅之比，是反射系数标准定义的倒数。我们将按照问题给出的明确定义进行计算。\n\n**第一部分：WKB 预测 ($R_{\\text{WKB}}$)**\n\n问题指定了一个简化的 WKB 模型，其特征为“单位反射率且没有任何转折点相位偏移”。\n- “单位反射率”意味着入射波和反射波的振幅大小相等。用标准术语来说，即 $|A_{\\text{reflected}}|/|A_{\\text{incident}}| = 1$。在问题的记法中，这是 $|A_{i}|/|A_{r}| = 1$，这意味着 $|R_{\\text{WKB}}| = |A_{r}/A_{i}| = 1$。\n- “没有任何转折点相位偏移”被解释为反射过程在入射波和反射波之间不引入相位移动。在标准定义中，这意味着 $\\arg(A_{\\text{reflected}}/A_{\\text{incident}}) = 0$。在问题的记法中，这意味着 $\\arg(A_{i}/A_{r}) = 0$，所以 $\\arg(R_{\\text{WKB}}^{-1}) = 0$。这又意味着 $\\arg(R_{\\text{WKB}}) = 0$。\n\n结合这两个假设，我们得到：\n$$R_{\\text{WKB}} = |R_{\\text{WKB}}|\\exp(i \\arg(R_{\\text{WKB}})) = 1 \\cdot \\exp(i \\cdot 0) = 1$$\n因此， $|R_{\\text{WKB}}| = 1$ 且 $\\arg(R_{\\text{WKB}}) = 0$。\n\n**第二部分：全波分析 ($R_{\\text{Airy}}$)**\n\n我们现在对截止点 $x=0$ 附近进行全波分析。波动方程为 $\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0$。在 $x=0$ 附近，波数的平方 $k^{2}(x)$ 使用给定的 $\\omega_{p}^{2}(x)$ 线性分布来近似：\n$$k^{2}(x) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega_{p}^{2}(x)}{\\omega^{2}}\\right) \\approx \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega^{2} + \\frac{\\omega^{2}}{L_{n}}x}{\\omega^{2}}\\right) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - 1 - \\frac{x}{L_{n}}\\right) = -\\frac{\\omega^{2}}{c^{2}L_{n}}x$$\n波动方程变为：\n$$\\frac{d^{2}E}{dx^{2}} - \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)x E = 0$$\n这是 Airy 方程的一种形式。为了将其简化为标准形式 $y''(z) - z y(z) = 0$，我们引入变量替换 $z = \\alpha x$。导数变换为 $\\frac{d}{dx} = \\alpha\\frac{d}{dz}$ 和 $\\frac{d^{2}}{dx^{2}} = \\alpha^{2}\\frac{d^{2}}{dz^{2}}$。代入波动方程得到：\n$$\\alpha^{2}\\frac{d^{2}E}{dz^{2}} - \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)\\frac{z}{\\alpha} E = 0 \\implies \\frac{d^{2}E}{dz^{2}} - \\left(\\frac{\\omega^{2}}{\\alpha^{3}c^{2}L_{n}}\\right)z E = 0$$\n我们要求 $zE$ 项的系数为 $1$，因此 $\\frac{\\omega^{2}}{\\alpha^{3}c^{2}L_{n}} = 1$，由此得出缩放因子：\n$$\\alpha = \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)^{1/3}$$\nAiry 方程的通解是第一类和第二类 Airy 函数 $Ai(z)$ 和 $Bi(z)$ 的线性组合。对于 $x0$，我们有 $z0$。物理条件是波在倏逝区 ($x0$) 必须衰减。由于当 $z \\to \\infty$ 时 $Ai(z)$ 指数衰减，而 $Bi(z)$ 指数增长，因此物理上合理的解必须正比于 $Ai(z)$。\n$$E(x) = C \\cdot Ai(z) = C \\cdot Ai\\left( \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)^{1/3} x \\right)$$\n为了求得反射系数，我们将此解在大负宗量 ($z \\to -\\infty$，对应于 $x0$) 时的渐近形式与 WKB 形式进行匹配。当 $z0$ 时，$Ai(z)$ 的渐近展开式为：\n$$Ai(z) \\sim \\frac{1}{\\sqrt{\\pi}(-z)^{1/4}} \\sin\\left(\\frac{2}{3}(-z)^{3/2} + \\frac{\\pi}{4}\\right)$$\n我们现在用 WKB 相位积分 $\\Phi(x) = \\int_{x}^{0} k(s)\\,ds$ 来表示正弦函数的宗量。对于 $x0$，$k(s) = \\sqrt{-\\frac{\\omega^{2}}{c^{2}L_{n}}s} = \\alpha^{3/2}\\sqrt{-s}$。\n$$\\Phi(x) = \\int_{x}^{0} \\alpha^{3/2}\\sqrt{-s}\\,ds = \\alpha^{3/2} \\left[-\\frac{2}{3}(-s)^{3/2}\\right]_{x}^{0} = \\frac{2}{3}\\alpha^{3/2}(-x)^{3/2} = \\frac{2}{3}(-\\alpha x)^{3/2} = \\frac{2}{3}(-z)^{3/2}$$\nWKB 解中的振幅因子 $1/\\sqrt{k(x)}$ 也可以与 $z$ 关联：$\\sqrt{k(x)} = (\\alpha^{3/2}\\sqrt{-x})^{1/2} = \\alpha^{3/4}(-x)^{1/4} = \\alpha^{1/2}(-\\alpha x)^{1/4} = \\alpha^{1/2}(-z)^{1/4}$。因此，$1/\\sqrt{k(x)} \\propto 1/(-z)^{1/4}$。振幅的依赖关系相匹配。\n我们现在使用复指数重写正弦函数，以匹配 WKB 形式：\n$$\\sin\\left(\\Phi(x) + \\frac{\\pi}{4}\\right) = \\frac{1}{2i}\\left[\\exp\\left(i\\Phi(x) + i\\frac{\\pi}{4}\\right) - \\exp\\left(-i\\Phi(x) - i\\frac{\\pi}{4}\\right)\\right]$$\n$$= \\frac{1}{2i}\\left[e^{i\\pi/4}\\exp(i\\Phi(x)) - e^{-i\\pi/4}\\exp(-i\\Phi(x))\\right]$$\n所以，$E(x)$ 的渐近解正比于：\n$$E(x) \\propto \\frac{1}{\\sqrt{k(x)}} \\left[ e^{i\\pi/4}\\exp\\left(i\\int_{x}^{0}k(s)ds\\right) - e^{-i\\pi/4}\\exp\\left(-i\\int_{x}^{0}k(s)ds\\right) \\right]$$\n我们将其与问题的 WKB 形式进行匹配：\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\exp\\left(i\\int_{x}^{0}k(s)ds\\right) + A_{r}\\exp\\left(-i\\int_{x}^{0}k(s)ds\\right) \\right]$$\n通过比较相应指数项的系数，我们发现：\n$$A_{i} \\propto e^{i\\pi/4}$$\n$$A_{r} \\propto -e^{-i\\pi/4}$$\n全波反射系数 $R_{\\text{Airy}}$ 是比值 $A_{r}/A_{i}$：\n$$R_{\\text{Airy}} = \\frac{-e^{-i\\pi/4}}{e^{i\\pi/4}} = -e^{-i\\pi/2} = -(-\\cos(\\pi/2) - i\\sin(\\pi/2)) = -(-i) = i$$\n所以，从全波分析中，我们得到 $R_{\\text{Airy}} = i$。其幅度和相位为：\n$$|R_{\\text{Airy}}| = |i| = 1$$\n$$\\arg(R_{\\text{Airy}}) = \\arg(i) = \\frac{\\pi}{2}$$\n这个结果表明，从线性密度剖面反射会在标准反射系数中引入一个 $\\pi/2$ 的相移，这对应于非标准定义的系数 $R$ 的一个 $\\pi/2$ 的相位。\n\n**第三部分：量化差异**\n\n最后，我们计算全波（Airy）结果与简化 WKB 结果之间的差异。\n幅度差为：\n$$\\Delta|R| = |R_{\\text{Airy}}| - |R_{\\text{WKB}}| = 1 - 1 = 0$$\n相位差为：\n$$\\Delta\\phi = \\arg(R_{\\text{Airy}}) - \\arg(R_{\\text{WKB}}) = \\frac{\\pi}{2} - 0 = \\frac{\\pi}{2}$$\n差异完全在于相位。简化的 WKB 模型未能捕捉到从连续势垒反射时发生的 $\\pi/2$ 相移，这是 WKB 连接公式中的一个著名结果。\n\n最终答案表示为双分量行向量 $[\\Delta|R|, \\Delta\\phi]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\pi}{2}\n\\end{pmatrix}\n}\n$$", "id": "3709516"}, {"introduction": "为了构建一个密度剖面，我们不仅需要理解反射的物理过程，还必须能精确定位每一次反射发生的位置。本练习将深入探讨调频连续波 (FMCW) 反射计的工作原理。通过从傅里叶分析的第一性原理出发，您将推导出仪器的扫频带宽与其空间分辨率之间的基本关系，从而理解限制反射计诊断性能的关键因素。[@problem_id:3709454]", "problem": "考虑在一维径向坐标为$r$的冷磁化等离子体中的寻常模（O-mode）微波反射计，其中电子密度剖面$n_{e}(r)$产生一个局域电子等离子体频率$\\omega_{\\mathrm{pe}}(r) = \\sqrt{n_{e}(r) e^{2}/(\\epsilon_{0} m_{e})}$。对于垂直于截止层传播的O模，冷等离子体色散关系为$k^{2} c^{2} = \\omega^{2} - \\omega_{\\mathrm{pe}}^{2}(r)$，群速度为$v_{g}(\\omega,r) = \\partial \\omega / \\partial k$。一台调频连续波（FMCW）反射计发射一个线性啁啾信号$s(t)$，其瞬时频率在持续时间$T$内围绕某个中心频率在总带宽$B$上单调扫描。接收到的场是发射场的延迟版本，该延迟是由于到局域截止层的双程传播（去和回）造成的。假设：\n\n- 几何光学极限有效，且反射发生在$\\omega = \\omega_{\\mathrm{pe}}(r_{\\mathrm{c}})$的局域截止层。\n- 在截止层附近感兴趣的小径向区间内，群速度可以近似为一个常数$v_{g} \\approx c/n_{g}$，其中$n_{g}$是在截止层处计算的局域群折射率。\n- 匹配滤波器（或去啁啾加频谱估计）处理可以建模为在扫描带宽$B$上对信号瞬时频率内容的积分。\n\n从O模的色散关系和群速度的定义出发，并利用有限带宽信号的傅里叶分析第一性原理，推导出一个关于两个相邻截止层之间最小可分辨径向间隔$\\Delta r$的闭式解析表达式，该表达式应使用啁啾带宽$B$、光速$c$和群折射率$n_{g}$来表示。您的推导必须从信号的有限带宽出发来论证时间延迟分辨率，而不能引用任何已知的雷达捷径公式。请清晰地陈述您使用的任何中间关系，并将最终的$\\Delta r$表示为仅包含$B$、$c$和$n_{g}$的单个解析表达式。不需要进行数值计算。请仅以解析表达式的形式给出最终结果。", "solution": "该问题要求使用O模微波反射计，求解等离子体中两个相邻截止层之间的最小可分辨径向间隔$\\Delta r$。推导需要基于波传播和傅里叶分析的第一性原理，并给定了一系列物理模型和假设。\n\n连接径向距离与测量的基本关系是微波信号的飞行时间。信号从天线传播出去，在截止层反射，然后返回天线。对于在径向位置$r_c$发生的反射，其总往返时间延迟$\\tau$由群速度$v_g$的倒数在双程路径上的积分给出：\n$$\n\\tau(r_c) = 2 \\int_{r_{\\text{antenna}}}^{r_c} \\frac{dr}{v_g(r)}\n$$\n问题指出我们可以做一个重要的简化：对于感兴趣的小径向区间，群速度可以近似为一个常数，$v_g \\approx c/n_g$，其中$c$是真空中的光速，$n_g$是一个常数局域群折射率。在此假设下，传播介质实际上是非色散的，传播到位置$r$的层的往返延迟（从天线处$r_{\\text{antenna}}=0$开始测量）可简化为：\n$$\n\\tau(r) = \\frac{2r}{v_g} = \\frac{2r}{c/n_g} = \\frac{2 n_g r}{c}\n$$\n现在，考虑位于径向位置$r_1$和$r_2$的两个不同但邻近的截止层。设这些层之间的间隔为$\\Delta r = r_2 - r_1$。从这两层反射的信号的往返时间延迟分别为$\\tau_1 = 2 n_g r_1 / c$和$\\tau_2 = 2 n_g r_2 / c$。时间延迟之差为：\n$$\n\\Delta \\tau = \\tau_2 - \\tau_1 = \\frac{2 n_g r_2}{c} - \\frac{2 n_g r_1}{c} = \\frac{2 n_g (r_2 - r_1)}{c} = \\frac{2 n_g \\Delta r}{c}\n$$\n根据这个关系，我们可以用时间延迟差$\\Delta \\tau$来表示径向间隔$\\Delta r$：\n$$\n\\Delta r = \\frac{c \\Delta \\tau}{2 n_g}\n$$\n问题现在简化为求最小可分辨时间延迟$\\Delta \\tau_{\\mathrm{min}}$。这个最小时间分辨率由探测信号的特性决定，特别是其带宽$B$。根据要求，推导必须源于傅里叶分析的第一性原理。\n\n信号处理的一个基本原理（源于傅里叶变换的性质）是，在时域中分辨特征的能力与信号在频域中的带宽成反比。为了形式化地说明这一点，我们考虑一个理想信号，其频谱内容均匀分布在带宽$B$（单位为Hz）内，而在其他地方为零。这样的信号具有矩形频谱。对于基带信号，其频谱$S(f)$可以写成：\n$$\nS(f) = \\begin{cases} 1  |f| \\leq B/2 \\\\ 0  |f| > B/2 \\end{cases}\n$$\n相应的时域信号$s(t)$由$S(f)$的傅里叶逆变换给出：\n$$\ns(t) = \\int_{-\\infty}^{\\infty} S(f) \\exp(i 2 \\pi f t) df = \\int_{-B/2}^{B/2} \\exp(i 2 \\pi f t) df\n$$\n计算该积分得到：\n$$\ns(t) = \\left[ \\frac{\\exp(i 2 \\pi f t)}{i 2 \\pi t} \\right]_{-B/2}^{B/2} = \\frac{\\exp(i \\pi B t) - \\exp(-i \\pi B t)}{i 2 \\pi t} = \\frac{2i \\sin(\\pi B t)}{i 2 \\pi t} = B \\frac{\\sin(\\pi B t)}{\\pi B t}\n$$\n这个函数被称为sinc函数。由带宽$B$能形成的最短脉冲的时间形状是一个sinc脉冲。\n\n为了确定两个反射脉冲之间的最小可分辨时间间隔，我们应用瑞利判据（Rayleigh criterion）。该判据指出，当一个脉冲的峰值与另一个脉冲的第一个零点（最小值）重合时，两个相同的脉冲恰好可以被分辨。脉冲$s(t) \\propto \\sin(\\pi B t)/(\\pi B t)$的主峰出现在$t=0$处。第一个零点出现在正弦函数的宗量等于$\\pm \\pi$时。因此，$\\pi B t = \\pm \\pi$，这得出$t = \\pm 1/B$。所以，从sinc脉冲的峰值到其第一个零点的时域距离是$1/B$。\n\n根据瑞利判据，两个相隔时间延迟$\\Delta \\tau$的此类脉冲，如果这个间隔等于从峰值到第一个零点的距离，则它们是最小可分辨的。因此，最小可分辨时间延迟是：\n$$\n\\Delta \\tau_{\\mathrm{min}} = \\frac{1}{B}\n$$\n这个结果，$\\Delta \\tau_{\\mathrm{min}} B = 1$，是时间-带宽不确定性原理的一种体现。\n\n最后，我们将这个最小可分辨时间延迟的表达式代入我们的径向间隔方程中。由此可求得最小可分辨径向间隔$\\Delta r$为：\n$$\n\\Delta r = \\frac{c \\Delta \\tau_{\\mathrm{min}}}{2 n_g} = \\frac{c}{2 n_g B}\n$$\n该表达式按要求从第一性原理推导，给出了反射计的空间分辨率与信号带宽$B$、光速$c$以及等离子体介质的有效群折射率$n_g$之间的关系。", "answer": "$$\\boxed{\\frac{c}{2 n_{g} B}}$$", "id": "3709454"}, {"introduction": "现在，让我们将理论付诸实践。真实的托卡马克等离子体具有复杂的、随空间变化的密度和磁场剖面，这与简单的理论模型不同。这项综合性练习要求您为更复杂的 X 模（非寻常模）推导截止条件，并编写一个程序来计算在真实托卡马克几何中，探测频率与截止半径之间的映射关系。您将通过计算发现并理解一个关键的实际挑战：这种映射关系可能是非单调的，这使得从频率到半径的反演过程变得复杂。[@problem_id:3709550]", "problem": "给定一个磁化的环向约束等离子体，你需要计算从入射微波频率到垂直入射的非凡模（X模）截止的径向位置的映射，并从第一性原理出发，论证空间变化的电子回旋角频率如何导致该映射出现非单调行为。此任务必须以冷等离子体波传播理论进行形式化，并作为一个完整的、可运行的程序来执行。\n\n等离子体、几何形状和剖面规定如下：\n- 小半径为 $a = 0.6$ 米。\n- 大半径为 $R_0 = 1.7$ 米。\n- 环向磁场强度剖面为 $B(r) = B_0 \\, \\dfrac{R_0}{R_0 + r}$，其中 $B_0 = 5.0$ 特斯拉， $r \\in [0,a]$ 单位为米。\n- 电子数密度剖面为 $n_e(r) = n_{\\text{edge}} + \\left(n_0 - n_{\\text{edge}}\\right) \\left(1 - \\left(\\dfrac{r}{a}\\right)^2\\right)^{\\alpha}$，其中 $n_0 = 2.0 \\times 10^{20}$ $\\text{m}^{-3}$，$n_{\\text{edge}} = 0.2 \\times 10^{20}$ $\\text{m}^{-3}$，$\\alpha = 1.5$。\n\n所有波均严格垂直于磁场发射和传播。分析必须从线性介质中的麦克斯韦方程组以及磁化电子流体的冷等离子体介电响应开始。定义并使用电子等离子体角频率 $\\omega_{pe}(r) = \\sqrt{\\dfrac{n_e(r) e^2}{\\varepsilon_0 m_e}}$ 和电子回旋角频率 $\\omega_{ce}(r) = \\dfrac{e B(r)}{m_e}$，其中 $e$ 是元电荷，$m_e$ 是电子质量，$\\varepsilon_0$ 是真空介电常数。你必须基于这些基本原理和垂直传播的相应非凡模色散关系，推导出确定给定入射角频率 $\\omega = 2\\pi f$ 的径向截止位置的条件。然后，使用推导出的条件，计算映射 $f \\mapsto r_c(f)$，其中 $r_c(f)$ 表示X模发生截止的半径集合。如果存在多个分支或多个解，你必须包含所有截止半径。\n\n你的推导不能依赖于预先给定的非凡模截止最终公式。必须从第一性原理推导色散关系和截止条件。你必须明确指出 $\\omega_{ce}(r)$ 的空间变化如何能够在映射 $f \\mapsto r_c(f)$ 中产生非单调行为，包括该映射可能失去单调性或产生模糊反演的条件。\n\n使用的常数（国际单位制）为：$e = 1.602176634 \\times 10^{-19}$ 库仑，$m_e = 9.1093837015 \\times 10^{-31}$ 千克，$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}$ 法拉/米。\n\n实现一个算法，对于每个指定的频率，在 $r \\in [0,a]$ 范围内搜索所有满足X模截止条件的半径。允许使用数值求根方法，且该方法必须对零、一或多个解的情况具有鲁棒性。所有返回的截止半径都必须以米为单位，并四舍五入到四位小数。\n\n测试套件：\n- 频率（单位：赫兹）：$f \\in \\{40 \\times 10^{9},\\, 55 \\times 10^{9},\\, 80 \\times 10^{9},\\, 150 \\times 10^{9},\\, 220 \\times 10^{9}\\}$。\n- 选择这些测试用例是为了涵盖：一个低频情况，其中截止可能需要高密度；一个近边界情况，其中较低的非凡模分支可能随频率表现出非单调行为；一个针对较高的非凡模分支密度要求的临界情况；以及较高的频率情况，其中较低的非凡模分支占主导地位。\n\n你的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个元素对应一个测试频率（按上述顺序），并且必须是该频率下所有存在的X模分支的截止半径（单位为米，四舍五入到四位小数）的列表，并按升序排列。例如，正确格式的输出形状为 $[[r_{1,1}, r_{1,2}, \\dots],[r_{2,1},\\dots],\\dots]$。如果给定频率下不存在截止，则为该频率输出一个空列表。半径的最终输出单位必须是米，并四舍五入到四位小数。", "solution": "该问题被评估为有效，因为它在科学上基于冷等离子体物理学，参数定义齐全，问题设定良好，并且其表述是客观的。它代表了磁化等离子体中波传播研究的一个标准（尽管不简单）问题。\n\n### 从第一性原理推导\n\n分析始于线性、无源介质的麦克斯韦方程组，并假设所有场都具有 $e^{-i\\omega t}$ 形式的谐波时间依赖性。等离子体中电场 $\\mathbf{E}$ 的波动方程推导如下：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E}\n$$\n其中 $\\omega$ 是波的角频率，$c$ 是真空中的光速，$\\mathbf{K}$ 是等离子体的相对介电张量。假设一个形式为 $\\mathbf{E} \\propto e^{i\\mathbf{k} \\cdot \\mathbf{r}}$ 的平面波解，其中 $\\mathbf{k}$ 是波矢量，波动方程变为一个代数方程：\n$$\n\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}) + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0\n$$\n引入折射率 $N = kc/\\omega$，上式简化为：\n$$\n\\left( \\mathbf{K} - N^2 \\mathbf{I} + N^2 \\frac{\\mathbf{k}\\mathbf{k}}{k^2} \\right) \\cdot \\mathbf{E} = 0\n$$\n为了使 $\\mathbf{E}$ 存在非平凡解，该矩阵的行列式必须为零。这个条件给出了等离子体中波的色散关系。\n\n对于背景磁场 $\\mathbf{B}$沿z轴的冷磁化等离子体，其介电张量 $\\mathbf{K}$ 为：\n$$\n\\mathbf{K} = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\n分量 $S$、$D$ 和 $P$ 是Stix参数，用电子等离子体频率 $\\omega_{pe}(r) = \\sqrt{n_e(r) e^2 / (\\varepsilon_0 m_e)}$ 和电子回旋频率 $\\omega_{ce}(r) = e B(r) / m_e$ 来定义：\n$$\nS = 1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} \\quad, \\quad D = \\frac{\\omega_{ce}\\omega_{pe}^2}{\\omega(\\omega^2 - \\omega_{ce}^2)} \\quad, \\quad P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2}\n$$\n问题指定传播严格垂直于磁场。我们可以将 $\\mathbf{k}$ 设在x轴方向，即 $\\mathbf{k} = k\\mathbf{\\hat{x}}$。波动方程的行列式条件分裂为两种独立的模式。一种是寻常模（O模），其色散关系为 $N^2 = P$，这里不予讨论。另一种是非凡模（X模），其色散关系为：\n$$\nN_X^2 = \\frac{S^2 - D^2}{S}\n$$\n波的截止定义为折射率 $N$ 变为零的位置，导致波被反射。对于X模，$N_X^2 = 0$ 意味着分子 $S^2-D^2$ 必须为零（假设 $S \\neq 0$，后者对应于共振）。\n将分子因式分解为 $(S-D)(S+D) = 0$，我们得到两个不同的截止条件：\n1.  $S+D = 0 \\implies 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + \\omega_{ce})} = 0$\n2.  $S-D = 0 \\implies 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega - \\omega_{ce})} = 0$\n\n对于给定的入射波频率 $\\omega$，当满足其中一个条件时，就会在径向位置 $r_c$ 发生截止。整理这些方程，可以得到用截止半径 $r_c$ 处的等离子体参数表示的截止条件：\n1.  **右旋（R）截止：** $\\omega^2 + \\omega \\omega_{ce}(r_c) - \\omega_{pe}^2(r_c) = 0$。这对应于入射频率 $\\omega$ 等于局域的“右旋”截止频率 $\\omega_R(r_c) = \\frac{1}{2}\\left(-\\omega_{ce}(r_c) + \\sqrt{\\omega_{ce}(r_c)^2 + 4\\omega_{pe}^2(r_c)}\\right)$。\n2.  **左旋（L）截止：** $\\omega^2 - \\omega \\omega_{ce}(r_c) - \\omega_{pe}^2(r_c) = 0$。这对应于 $\\omega$ 等于局域的“左旋”截止频率 $\\omega_L(r_c) = \\frac{1}{2}\\left(\\omega_{ce}(r_c) + \\sqrt{\\omega_{ce}(r_c)^2 + 4\\omega_{pe}^2(r_c)}\\right)$。\n\n### 非单调性分析\n\n问题要求解释频率到截止半径的映射 $f \\mapsto r_c(f)$ 如何变得非单调。这种行为由截止频率 $\\omega_L(r)$ 和 $\\omega_R(r)$ 的空间剖面决定。\n\n关键的等离子体参数，即磁场 $B(r)$ 和电子密度 $n_e(r)$，在 $r \\in [0, a]$ 范围内都是关于小半径 $r$ 的单调递减函数。因此，它们对应的特征频率 $\\omega_{ce}(r)$ 和 $\\omega_{pe}(r)$ 也随 $r$ 单调递减。\n\n左旋截止频率 $\\omega_L(r)$ 是多个随 $r$ 单调递减项的和，因此它本身也是一个单调递减函数。因此，对于任何在 $\\omega_L(r)$ 范围内的给定入射频率 $\\omega$，该分支将恰好有一个截止半径 $r_c$。\n\n右旋截止频率 $\\omega_R(r)$ 涉及一个差值。它关于 $r$ 的导数为：\n$$\n\\frac{d\\omega_R}{dr} = \\frac{1}{2} \\left( -\\frac{d\\omega_{ce}}{dr} + \\frac{\\omega_{ce}\\frac{d\\omega_{ce}}{dr} + 2\\frac{d(\\omega_{pe}^2)}{dr}}{\\sqrt{\\omega_{ce}^2 + 4\\omega_{pe}^2}} \\right)\n$$\n由于 $\\frac{d\\omega_{ce}}{dr}  0$ 且 $\\frac{d(\\omega_{pe}^2)}{dr}  0$，项 $-\\frac{d\\omega_{ce}}{dr}$ 为正，而分数项为负。$\\frac{d\\omega_R}{dr}$ 的符号取决于这两项之间的竞争。正项源于磁场的衰减，而负项则由密度和磁场的衰减共同驱动。这种竞争可能导致 $\\omega_R(r)$ 剖面呈非单调性；它可能有一个局部最大值。如果一个入射频率 $\\omega$ 低于这个最大值但高于边界（$r=0$ 或 $r=a$）处的值，则可能存在两个不同的径向位置满足 $\\omega = \\omega_R(r)$，从而导致两个截止点。这使得对于R分支的映射 $f \\mapsto r_c(f)$ 变得模糊，这是旨在测量密度剖面的反射计诊断的一个关键特征。\n\n### 算法设计\n\n要计算映射 $f \\mapsto r_c(f)$，我们必须为每个给定频率 $f$ 找到两个截止条件方程的根：\n$G_R(r, \\omega) = \\omega^2 + \\omega \\omega_{ce}(r) - \\omega_{pe}^2(r) = 0$\n$G_L(r, \\omega) = \\omega^2 - \\omega \\omega_{ce}(r) - \\omega_{pe}^2(r) = 0$\n其中 $\\omega = 2\\pi f$。\n\n算法如下：\n1.  对于每个输入频率 $f_{test}$，计算相应的角频率 $\\omega$。\n2.  为了在定义域 $r \\in [0, a]$ 内稳健地找到所有根，我们将此区间离散化为大量子区间。\n3.  对于每个子区间，我们检查 $G_R(r, \\omega)$ 和 $G_L(r, \\omega)$ 是否存在符号变化。\n4.  如果在子区间 $[r_i, r_{i+1}]$ 内检测到符号变化，则在该区间上使用数值求根算法（例如Brent方法）来找到精确的根。\n5.  收集为 $G_R$ 和 $G_L$ 找到的所有根。\n6.  将收集到的根列表按升序排序并四舍五入到指定的精度。这样就得到了给定频率下所有截止半径的集合。\n对所有测试频率重复此过程。", "answer": "```python\nimport numpy as np\nfrom scipy import optimize\nfrom scipy.constants import e, m_e, epsilon_0, pi\n\ndef solve():\n    \"\"\"\n    Computes the extraordinary mode (X-mode) cutoff radii for given microwave\n    frequencies in a model tokamak plasma.\n    \"\"\"\n    \n    # Define plasma and geometry parameters from the problem statement\n    a = 0.6  # Minor radius in meters\n    R0 = 1.7  # Major radius in meters\n    B0 = 5.0  # Magnetic field on-axis in Tesla\n    n0 = 2.0e20  # Central electron density in m^-3\n    n_edge = 0.2e20  # Edge electron density in m^-3\n    alpha = 1.5  # Density profile shape parameter\n\n    # Define the test frequencies in Hertz\n    test_cases = [40e9, 55e9, 80e9, 150e9, 220e9]\n    \n    # Pre-calculate physical constant ratios for efficiency\n    e_over_me = e / m_e\n    e2_over_eps0_me = e**2 / (epsilon_0 * m_e)\n\n    def B_field(r):\n        \"\"\"Calculates the toroidal magnetic field strength at minor radius r.\"\"\"\n        return B0 * R0 / (R0 + r)\n\n    def n_electron(r):\n        \"\"\"Calculates the electron number density at minor radius r.\"\"\"\n        # This vectorized version handles both scalar and array inputs for r\n        # and correctly handles r > a by clipping the base of the power.\n        term_base = 1 - (np.asanyarray(r) / a)**2\n        if isinstance(term_base, np.ndarray):\n            term_base[term_base  0] = 0\n        elif term_base  0:\n            term_base = 0\n            \n        return n_edge + (n0 - n_edge) * term_base**alpha\n\n    def omega_ce(r):\n        \"\"\"Calculates the electron cyclotron angular frequency.\"\"\"\n        return e_over_me * B_field(r)\n\n    def omega_pe_sq(r):\n        \"\"\"Calculates the square of the electron plasma angular frequency.\"\"\"\n        return e2_over_eps0_me * n_electron(r)\n\n    # --- Cutoff condition functions G(r) = 0 ---\n    # G_R corresponds to the Right-hand cutoff: w^2 + w*w_ce - w_pe^2 = 0\n    def G_R(r, omega):\n        return omega**2 + omega * omega_ce(r) - omega_pe_sq(r)\n\n    # G_L corresponds to the Left-hand cutoff: w^2 - w*w_ce - w_pe^2 = 0\n    def G_L(r, omega):\n        return omega**2 - omega * omega_ce(r) - omega_pe_sq(r)\n\n    def find_all_roots(func, omega, r_min=0., r_max=a, num_points=10000):\n        \"\"\"\n        Finds all roots of `func(r, omega) = 0` in the interval [r_min, r_max].\n        \"\"\"\n        r_grid = np.linspace(r_min, r_max, num_points)\n        f_vals = func(r_grid, omega)\n        \n        roots = []\n        for i in range(num_points - 1):\n            # A root exists if the function crosses the axis\n            if np.sign(f_vals[i]) != np.sign(f_vals[i+1]):\n                try:\n                    root = optimize.brentq(func, r_grid[i], r_grid[i+1], args=(omega,))\n                    roots.append(root)\n                except ValueError:\n                    # This should not be reached due to the np.sign check,\n                    # but serves as a safeguard.\n                    pass\n        \n        # Check if a root is exactly at a grid point (can be missed by sign change)\n        # We only need to check at the start of intervals, as the end is the next start\n        if np.isclose(f_vals[0], 0):\n            roots.append(r_grid[0])\n        # And finally check the last point of the domain\n        if np.isclose(f_vals[-1], 0):\n            roots.append(r_grid[-1])\n\n        # Return a sorted list of unique roots\n        return sorted(list(set(roots)))\n\n    results = []\n    for f_hz in test_cases:\n        omega_val = 2 * pi * f_hz\n        \n        # Find roots for both L and R cutoff branches\n        roots_R_branch = find_all_roots(G_R, omega_val)\n        roots_L_branch = find_all_roots(G_L, omega_val)\n        \n        all_roots = sorted(roots_R_branch + roots_L_branch)\n        \n        # Round roots to four decimal places as required\n        rounded_roots = [round(r, 4) for r in all_roots]\n        \n        results.append(rounded_roots)\n\n    # Format the final output string to exactly match the problem specification\n    # e.g., [[r1.1,r1.2],[r2.1],[],...]\n    inner_parts = []\n    for r_list in results:\n        inner_parts.append(f\"[{','.join(map(str, r_list))}]\")\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3709550"}]}