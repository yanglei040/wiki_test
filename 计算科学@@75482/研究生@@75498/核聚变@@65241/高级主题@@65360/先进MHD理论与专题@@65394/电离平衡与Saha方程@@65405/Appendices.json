{"hands_on_practices": [{"introduction": "本节的第一个实践旨在巩固对萨哈电离平衡的基本理解。通过从第一性原理（化学势）出发推导萨哈方程，并将其应用于聚变等离子体中的关键元素——氘，你将能够亲手计算在给定温度和密度下的电离度。这个练习不仅能加深对理论的理解，还为分析更复杂的等离子体电离状态奠定了基础。[@problem_id:3705104]", "problem": "一个在温度为 $T$ 时处于局部热力学平衡 (LTE) 状态下的空间均匀、准中性的氘等离子体，由中性氘原子 $\\mathrm{D}^{0}$、单电离氘核 $\\mathrm{D}^{+}$ 和电子 $e^{-}$ 组成。假设所有组分均为非相对论性、非简并的理想气体，并忽略激发束缚态、连续谱降低以及除电子自旋外的任何简并。在基态近似下处理内配分函数，其中中性氘的电子简并度为 $g_{0} = 2$，氘核的内禀简并度为 $g_{1} = 1$，电子的自旋简并度为 $g_{e} = 2$。氘的第一电离能为 $\\chi = 13.6\\,\\mathrm{eV}$（在此处所需的精度范围内，其数值与氢相等）。等离子体是准中性的，因此 $n_{\\mathrm{D}^{+}} = n_{e}$。\n\n从化学平衡条件和通过单粒子平动配分函数表示的理想气体化学势表达式出发，推导数密度 $n_{e}$、$n_{\\mathrm{D}^{+}}$ 和 $n_{\\mathrm{D}^{0}}$ 之间的平衡关系，并由此求出电离分数\n$$\nx \\equiv \\frac{n_{\\mathrm{D}^{+}}}{n_{\\mathrm{D}^{0}} + n_{\\mathrm{D}^{+}}}\n$$\n用 $T$ 和给定的 $n_{e}$ 表示的表达式。然后，在 $T$ 使得 $k_{B} T = 1\\,\\mathrm{eV}$ 且 $n_{e} = 10^{20}\\,\\mathrm{m}^{-3}$ 的条件下，计算 $x$ 的值。在数值计算中使用以下常数：普朗克常数 $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$，电子质量 $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$，以及 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n\n将您的电离分数四舍五入到四位有效数字，并以纯小数（无单位）的形式表示。利用您推导的表达式的标度关系，简要论证为什么在相同的 $n_e$ 下，当 $T$ 使得 $k_{B} T \\sim 10\\,\\mathrm{eV}$ 时，电离分数会趋近于 1。", "solution": "该问题是有效的，因为它代表了统计力学和等离子体物理学中一个基于既定科学原理的标准且适定的问题。所有必要的信息和常数都已提供，不存在内部矛盾或科学上不成立的前提。\n\n中性氘 $\\mathrm{D}^0$ 电离成一个氘核 $\\mathrm{D}^+$ 和一个电子 $e^-$ 的过程由以下反应描述：\n$$\n\\mathrm{D}^0 \\rightleftharpoons \\mathrm{D}^+ + e^-\n$$\n在局部热力学平衡 (LTE) 状态下，各组分的化学势通过化学平衡条件相关联：\n$$\n\\mu_{\\mathrm{D}^0} = \\mu_{\\mathrm{D}^+} + \\mu_{e}\n$$\n我们将使用下标 $0$、$1$ 和 $e$ 分别表示 $\\mathrm{D}^0$、$\\mathrm{D}^+$ 和 $e^-$，因此有 $\\mu_0 = \\mu_1 + \\mu_e$。\n\n对于非相对论性、非简并的理想气体，在温度 $T$ 下，一个数密度为 $n_i$、质量为 $m_i$、基态简并度为 $g_i$ 的组分 $i$ 的化学势由下式给出：\n$$\n\\mu_i = -k_B T \\ln\\left( \\frac{Z_i^{\\text{trans}} Z_i^{\\text{int}}}{N_i} \\right) + E_i^{\\text{rest}}\n$$\n其中 $N_i$ 是体积 $V$ 中的粒子数（$n_i=N_i/V$），$E_i^{\\text{rest}}$ 是静止能量，$Z_i^{\\text{int}}$ 是内配分函数（近似为 $g_i$），$Z_i^{\\text{trans}}$ 是单粒子平动配分函数：\n$$\nZ_i^{\\text{trans}} = V \\left( \\frac{2\\pi m_i k_B T}{h^2} \\right)^{3/2}\n$$\n将 $Z_i^{\\text{trans}}$ 和 $Z_i^{\\text{int}}=g_i$ 代入 $\\mu_i$ 的表达式，我们得到：\n$$\n\\mu_i = -k_B T \\ln\\left[ \\frac{g_i}{n_i} \\left( \\frac{2\\pi m_i k_B T}{h^2} \\right)^{3/2} \\right] + E_i^{\\text{rest}}\n$$\n将此应用于反应中的各组分：\n$$\n\\mu_0 = -k_B T \\ln\\left[ \\frac{g_0}{n_0} \\left( \\frac{2\\pi m_0 k_B T}{h^2} \\right)^{3/2} \\right] + m_0 c^2\n$$\n$$\n\\mu_1 = -k_B T \\ln\\left[ \\frac{g_1}{n_1} \\left( \\frac{2\\pi m_1 k_B T}{h^2} \\right)^{3/2} \\right] + m_1 c^2\n$$\n$$\n\\mu_e = -k_B T \\ln\\left[ \\frac{g_e}{n_e} \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\right] + m_e c^2\n$$\n静止能量通过电离能 $\\chi$ 联系起来。中性原子 $m_0$ 的静止质量是其组分质量之和减去结合能：$m_0 c^2 = m_1 c^2 + m_e c^2 - \\chi$。因此，$m_0 c^2 - m_1 c^2 - m_e c^2 = -\\chi$。\n\n将化学势代入平衡条件 $\\mu_0 = \\mu_1 + \\mu_e$ 并整理得到：\n$$\nm_0 c^2 - m_1 c^2 - m_e c^2 = k_B T \\left[ \\ln\\left(\\frac{g_0}{n_0}(\\dots)^{3/2}\\right) - \\ln\\left(\\frac{g_1}{n_1}(\\dots)^{3/2}\\right) - \\ln\\left(\\frac{g_e}{n_e}(\\dots)^{3/2}\\right) \\right]\n$$\n$$\n-\\chi = -k_B T \\ln \\left[ \\frac{n_1 n_e}{n_0} \\frac{g_0}{g_1 g_e} \\left( \\frac{m_0}{m_1 m_e} \\frac{h^2}{2\\pi k_B T} \\right)^{3/2} \\right]\n$$\n我们使用极好的近似 $m_0 \\approx m_1$，因为电子质量 $m_e$ 和结合能 $\\chi/c^2$ 与氘核质量相比可以忽略不计。质量项变为 $(m_1 / (m_1 m_e))^{3/2} = m_e^{-3/2}$。\n$$\n\\frac{\\chi}{k_B T} = \\ln \\left[ \\frac{n_1 n_e}{n_0} \\frac{g_0}{g_1 g_e} \\left( \\frac{h^2}{2\\pi m_e k_B T} \\right)^{3/2} \\right]\n$$\n取指数并整理得到萨哈电离方程：\n$$\n\\frac{n_1 n_e}{n_0} = \\frac{g_1 g_e}{g_0} \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\n使用给定的简并度 $g_0=2$、$g_1=1$ 和 $g_e=2$，简并度因子为 $\\frac{g_1 g_e}{g_0} = \\frac{1 \\cdot 2}{2} = 1$。平衡关系为：\n$$\n\\frac{n_1 n_e}{n_0} = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\n问题指明了准中性条件，$n_{\\mathrm{D}^{+}} = n_e$，这意味着 $n_1 = n_e$。电离分数定义为 $x \\equiv \\frac{n_1}{n_0 + n_1}$。根据这个定义，我们可以写出 $n_0 = n_1 \\frac{1-x}{x}$。将这些关系代入萨哈方程：\n$$\n\\frac{n_1 \\cdot n_1}{n_1 \\frac{1-x}{x}} = \\frac{n_1 x}{1-x} = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\n由于 $n_1=n_e$，我们有：\n$$\n\\frac{n_e x}{1-x} = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right) \\equiv S(T)\n$$\n我们解出 $x$：\n$$\nx n_e = (1-x) S(T) \\implies x(n_e + S(T)) = S(T) \\implies x = \\frac{S(T)}{n_e + S(T)} = \\frac{1}{1 + n_e/S(T)}\n$$\n这就给出了用 $T$ 和 $n_e$ 表示的电离分数 $x$：\n$$\nx = \\left[ 1 + n_e \\left( \\frac{h^2}{2\\pi m_e k_B T} \\right)^{3/2} \\exp\\left(\\frac{\\chi}{k_B T}\\right) \\right]^{-1}\n$$\n现在，我们在给定条件下计算 $x$ 的值：$k_B T = 1\\,\\mathrm{eV}$ 且 $n_e = 10^{20}\\,\\mathrm{m}^{-3}$。电离能为 $\\chi = 13.6\\,\\mathrm{eV}$。\n首先，我们将 $k_B T$ 转换为焦耳：$k_B T = 1\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n指数部分的参数为 $\\chi/(k_B T) = 13.6\\,\\mathrm{eV} / 1\\,\\mathrm{eV} = 13.6$。\n我们来计算通常称为量子浓度 $n_Q$ 的项：\n$$\nn_Q = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2}\n$$\n使用给定的常数：\n$m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$\n$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n$$\n\\frac{2\\pi m_e k_B T}{h^2} = \\frac{2\\pi (9.10938... \\times 10^{-31}\\,\\mathrm{kg})(1.60217... \\times 10^{-19}\\,\\mathrm{J})}{(6.62607... \\times 10^{-34}\\,\\mathrm{J\\,s})^2} \\approx 2.090226 \\times 10^{18}\\,\\mathrm{m}^{-2}\n$$\n$$\nn_Q \\approx (2.090226 \\times 10^{18}\\,\\mathrm{m}^{-2})^{3/2} \\approx 3.02425 \\times 10^{27}\\,\\mathrm{m}^{-3}\n$$\n现在我们可以计算 $S(T) = n_Q \\exp(-\\chi/k_B T)$：\n$$\nS(T) \\approx (3.02425 \\times 10^{27}\\,\\mathrm{m}^{-3}) \\exp(-13.6) \\approx (3.02425 \\times 10^{27}\\,\\mathrm{m}^{-3}) (1.23735 \\times 10^{-6})\n$$\n$$\nS(T) \\approx 3.74198 \\times 10^{21}\\,\\mathrm{m}^{-3}\n$$\n最后，我们计算电离分数 $x$：\n$$\nx = \\frac{S(T)}{n_e + S(T)} = \\frac{3.74198 \\times 10^{21}\\,\\mathrm{m}^{-3}}{10^{20}\\,\\mathrm{m}^{-3} + 3.74198 \\times 10^{21}\\,\\mathrm{m}^{-3}} = \\frac{3.74198 \\times 10^{21}}{0.1 \\times 10^{21} + 3.74198 \\times 10^{21}}\n$$\n$$\nx = \\frac{3.74198}{3.84198} \\approx 0.973971...\n$$\n四舍五入到四位有效数字，我们得到 $x \\approx 0.9740$。\n\n为了论证为什么在相同的 $n_e$ 下，当 $k_B T \\sim 10\\,\\mathrm{eV}$ 时电离分数 $x$ 趋近于 1，我们分析表达式 $x = (1 + n_e/S(T))^{-1}$。要使 $x \\to 1$，比值 $n_e/S(T)$ 必须趋近于 0，这意味着 $S(T)$ 必须变得远大于常数 $n_e$。$S(T)$ 的温度依赖关系由下式给出：\n$$\nS(T) \\propto T^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\n幂律项 $T^{3/2}$ 和指数项 $\\exp(-\\chi/k_B T)$ 都是温度的强增函数。当我们将 $k_B T$ 从 $1\\,\\mathrm{eV}$ 增加到 $10\\,\\mathrm{eV}$（增加了 10 倍）时，$T^{3/2}$ 项增加了 $10^{3/2} \\approx 31.6$ 倍。指数项从 $\\exp(-13.6/1) = \\exp(-13.6) \\approx 1.24 \\times 10^{-6}$ 变为 $\\exp(-13.6/10) = \\exp(-1.36) \\approx 0.257$。指数因子大约增加了 $2 \\times 10^5$ 倍。\n$S(T)$ 的这种综合性的大幅增加使其远大于 $n_e = 10^{20}\\,\\mathrm{m}^{-3}$。结果，比值 $n_e/S(T)$ 变得非常接近于零，因此 $x = (1 + n_e/S(T))^{-1}$ 趋近于 1。等离子体变得几乎完全电离。", "answer": "$$\n\\boxed{0.9740}\n$$", "id": "3705104"}, {"introduction": "在掌握了基本的萨哈方程之后，下一个实践将引导你探索原子内部结构对电离平衡的影响。通过在计算中引入激发态的贡献，你将量化这些高能级态如何改变电离分数，并将其与仅考虑基态的简化模型进行比较。这个练习突出了在精确建模等离子体时，考虑详细原子物理过程的重要性。[@problem_id:3705161]", "problem": "一个空间均匀、等温、准中性的氘等离子体处于碰撞热平衡状态，其中只含有中性氘原子和单电离的氘离子，电子被视为理想的麦克斯韦-玻尔兹曼气体。温度为 $T$，当能量以电子伏特表示时，$k_B T$ 等于 $T$（即，本题中的 $T$ 表示以 $\\mathrm{eV}$ 为单位的 $k_B T$），电子数密度 $n_e$ 由更大的聚变系统的约束外部固定。假设所有组分均表现为理想气体行为，且反应 $\\mathrm{D} \\rightleftharpoons \\mathrm{D}^{+} + e^{-}$ 处于热力学平衡状态。\n\n仅使用基本平衡热力学、包含内配分函数的理想气体统计力学以及经过充分检验的原子数据，推导平衡电离关系式，用 $T$、$n_e$ 以及中性原子和离子的内配分函数表示比值 $n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}$。将 $\\mathrm{D}^{+}$ 的内配分函数视为1。对于中性氘原子，取基态简并度 $g_1 = 2$，并且只包括来自 $n=2$ 和 $n=3$ 流形的激发态贡献，其简并度为 $g_n = 2 n^2$，高于基态的激发能分别为 $\\Delta E_2 = 10.20\\,\\mathrm{eV}$ 和 $\\Delta E_3 = 12.09\\,\\mathrm{eV}$。第一电离能为 $\\chi = 13.60\\,\\mathrm{eV}$。电子的自旋简并因子为 $2$。你可以假设，在给定的密度下，更高 $n$ 值的能态被等离子体微场抑制，因此将中性原子的内配分函数截断到 $n=3$ 是足够的。\n\n令 $x \\equiv n_{\\mathrm{D}^{+}}/(n_{\\mathrm{D}}+n_{\\mathrm{D}^{+}})$ 为纯氘系统的电离分数，因此准中性意味着 $n_e = n_{\\mathrm{D}^{+}}$。用 $T$、$n_e$ 和内配分函数表示 $x$，然后数值计算比值 $R \\equiv x_{\\text{exc}}/x_{\\text{ground}}$，其中 $x_{\\text{ground}}$ 是仅使用基态的中性配分函数计算的，而 $x_{\\text{exc}}$ 是按要求包括了 $n=2$ 和 $n=3$ 激发态贡献计算的。\n\n使用 $T = 2.00\\,\\mathrm{eV}$ 和 $n_e = 1.00 \\times 10^{25}\\,\\mathrm{m}^{-3}$。物理常数：电子质量 $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$，普朗克常数 $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$，玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$，基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，真空介电常数 $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m}^{-1}$。将最终比值 $R$ 表示为一个无量纲小数，并将答案四舍五入到四位有效数字。", "solution": "该问题被认为是有效的，因为它科学上基于平衡统计力学，给出的数据完整且一致，问题阐述清晰，并且在表述上是客观的。它代表了萨哈电离方程在等离子体物理学中的一个标准应用。\n\n该问题要求推导反应 $\\mathrm{D} \\rightleftharpoons \\mathrm{D}^{+} + e^{-}$ 的电离平衡关系式，然后根据指定条件数值计算电离分数的比值。\n\n在热力学平衡中，反应中各组分的化学势由以下关系式关联：\n$$\n\\mu_{\\mathrm{D}} = \\mu_{\\mathrm{D}^{+}} + \\mu_{e}\n$$\n其中 $\\mu_{\\mathrm{D}}$、$\\mu_{\\mathrm{D}^{+}}$ 和 $\\mu_{e}$ 分别是中性氘原子、氘离子和电子的化学势。\n\n对于非简并的理想气体，组分 $i$ 的化学势由下式给出：\n$$\n\\mu_i = k_B T \\ln\\left(\\frac{n_i}{Q_i}\\right)\n$$\n其中 $n_i$ 是数密度，$Q_i$ 是单粒子配分函数。配分函数 $Q_i$ 可以分为平动和内部两个部分，$Q_i = Q_{i, \\text{trans}} Z_i$。一个更完整的化学势表达式，明确包含了组分的基态能量 $E_{i,0}$，是：\n$$\n\\mu_i = E_{i,0} + k_B T \\ln\\left(\\frac{n_i}{Q_{i, \\text{trans}} Z_i}\\right)\n$$\n其中 $Z_i$ 是内配分函数，其能量是相对于该组分的基态来测量的。对于质量为 $m_i$、温度为 $T_K$（单位为开尔文）的粒子，单位体积的平动配分函数是：\n$$\nQ_{i, \\text{trans}} = \\left(\\frac{2\\pi m_i k_B T_K}{h^2}\\right)^{3/2}\n$$\n让我们将能量零点定义为一个自由的氘核 ($\\mathrm{D}^{+}$) 和一个静止的自由电子 ($e^{-}$) 的状态。根据这个约定：\n- 中性氘原子的基态能量是 $E_{\\mathrm{D},0} = -\\chi$，其中 $\\chi$ 是第一电离能。\n- 氘离子的基态能量是 $E_{\\mathrm{D}^{+},0} = 0$。\n- 电子的基态能量是 $E_{e,0} = 0$。\n\n平衡条件变为：\n$$\n-\\chi + k_B T_K \\ln\\left(\\frac{n_{\\mathrm{D}}}{Q_{\\mathrm{D, trans}} Z_{\\mathrm{D}}}\\right) = k_B T_K \\ln\\left(\\frac{n_{\\mathrm{D}^{+}}}{Q_{\\mathrm{D}^{+}, \\text{trans}} Z_{\\mathrm{D}^{+}}}\\right) + k_B T_K \\ln\\left(\\frac{n_{e}}{Q_{e, \\text{trans}} Z_{e}}\\right)\n$$\n其中 $Z_{\\mathrm{D}}$、$Z_{\\mathrm{D}^{+}}$ 和 $Z_{e}$ 是内配分函数。重新整理以求解密度比，得到：\n$$\n\\ln\\left(\\frac{n_{\\mathrm{D}^{+}} n_e}{n_{\\mathrm{D}}}\\right) = -\\frac{\\chi}{k_B T_K} + \\ln\\left(\\frac{Q_{\\mathrm{D}^{+}, \\text{trans}} Q_{e, \\text{trans}}}{Q_{\\mathrm{D, trans}}}\\frac{Z_{\\mathrm{D}^{+}} Z_e}{Z_{\\mathrm{D}}}\\right)\n$$\n$$\n\\frac{n_{\\mathrm{D}^{+}} n_e}{n_{\\mathrm{D}}} = \\frac{Q_{\\mathrm{D}^{+}, \\text{trans}} Q_{e, \\text{trans}}}{Q_{\\mathrm{D, trans}}}\\frac{Z_{\\mathrm{D}^{+}} Z_e}{Z_{\\mathrm{D}}} \\exp\\left(-\\frac{\\chi}{k_B T_K}\\right)\n$$\n中性原子和离子的质量近似相等，$m_{\\mathrm{D}} \\approx m_{\\mathrm{D}^{+}}$，所以它们的平动配分函数几乎相互抵消，$Q_{\\mathrm{D}, \\text{trans}} \\approx Q_{\\mathrm{D}^{+}, \\text{trans}}$。电子的内配分函数是其自旋简并度，$Z_e = g_e = 2$。\n这简化为萨哈电离方程：\n$$\n\\frac{n_{\\mathrm{D}^{+}} n_e}{n_{\\mathrm{D}}} = 2 \\frac{Z_{\\mathrm{D}^{+}}}{Z_{\\mathrm{D}}} \\left(\\frac{2\\pi m_e k_B T_K}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T_K}\\right)\n$$\n问题将温度 $T$ 定义为以电子伏特 ($\\mathrm{eV}$) 为单位的 $k_B T_K$。设 $T_{\\text{eV}}$ 表示这个值。那么 $k_B T_K = e T_{\\text{eV}}$，类似地 $\\chi = e \\chi_{\\text{eV}}$。使用问题中的符号，其中 $T$ 和 $\\chi$ 代表以 $\\mathrm{eV}$ 为单位的值：\n$$\n\\frac{n_{\\mathrm{D}^{+}} n_e}{n_{\\mathrm{D}}} = 2 \\frac{Z_{\\mathrm{D}^{+}}}{Z_{\\mathrm{D}}(T)} \\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{T}\\right)\n$$\n因此，比值 $n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}$ 为：\n$$\n\\frac{n_{\\mathrm{D}^{+}}}{n_{\\mathrm{D}}} = \\frac{2}{n_e} \\frac{Z_{\\mathrm{D}^{+}}}{Z_{\\mathrm{D}}(T)} \\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{T}\\right)\n$$\n这就是所要求的电离平衡关系式。\n\n问题将电离分数定义为 $x \\equiv n_{\\mathrm{D}^{+}}/(n_{\\mathrm{D}}+n_{\\mathrm{D}^{+}})$，并指出对于纯氘系统，准中性意味着 $n_e = n_{\\mathrm{D}^{+}}$。在 $n_e$ 是固定的外部约束下，这意味着 $n_{\\mathrm{D}^{+}}$ 也是固定的。萨哈方程随后决定了中性原子密度 $n_{\\mathrm{D}}$：\n$$\n\\frac{n_e^2}{n_{\\mathrm{D}}} = 2 \\frac{Z_{\\mathrm{D}^{+}}}{Z_{\\mathrm{D}}(T)} \\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{T}\\right) \\equiv S(T)\n$$\n让我们为等式右边定义一个组合项，它依赖于温度和所涉及的配分函数：\n$$\n\\frac{n_{\\mathrm{D}^{+}}}{n_{\\mathrm{D}}} = \\frac{S(T)}{n_e^2} n_{\\mathrm{D}^{+}} = \\frac{S(T)}{n_e}\n$$\n电离分数 $x$ 可以写成：\n$$\nx = \\frac{n_{\\mathrm{D}^{+}}}{n_{\\mathrm{D}}+n_{\\mathrm{D}^{+}}} = \\frac{n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}}{1+n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}} = \\frac{S(T)/n_e}{1+S(T)/n_e}\n$$\n让我们定义一个无量纲量 $Y$，它概括了等离子体条件和原子物理之间的相互作用，但独立于中性原子的内部结构：\n$$\nY \\equiv \\frac{2 Z_{\\mathrm{D}^{+}}}{n_e} \\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{T}\\right)\n$$\n那么 $S(T) = Y n_e / Z_{\\mathrm{D}}(T)$，电离分数是 $x = \\frac{Y/Z_{\\mathrm{D}}(T)}{1+Y/Z_{\\mathrm{D}}(T)} = \\frac{Y}{Z_{\\mathrm{D}}(T)+Y}$。\n\n问题要求计算比值 $R \\equiv x_{\\text{exc}}/x_{\\text{ground}}$。\n对于 $x_{\\text{ground}}$，中性原子的配分函数只包括基态：$Z_{\\mathrm{D, ground}} = g_1 = 2$。\n$$\nx_{\\text{ground}} = \\frac{Y}{Z_{\\mathrm{D, ground}}+Y} = \\frac{Y}{2+Y}\n$$\n对于 $x_{\\text{exc}}$，配分函数包括高达 $n=3$ 的激发态：\n$$\nZ_{\\mathrm{D, exc}}(T) = g_1 e^{-\\Delta E_1/T} + g_2 e^{-\\Delta E_2/T} + g_3 e^{-\\Delta E_3/T}\n$$\n给定 $g_n=2n^2$，我们有 $g_1=2$，$g_2=8$，$g_3=18$。当 $\\Delta E_1=0$ 时：\n$$\nZ_{\\mathrm{D, exc}}(T) = 2 + 8 \\exp(-\\Delta E_2/T) + 18 \\exp(-\\Delta E_3/T)\n$$\n$$\nx_{\\text{exc}} = \\frac{Y}{Z_{\\mathrm{D, exc}}(T)+Y}\n$$\n因此，比值 $R$ 是：\n$$\nR = \\frac{x_{\\text{exc}}}{x_{\\text{ground}}} = \\frac{Y/(Z_{\\mathrm{D, exc}}+Y)}{Y/(Z_{\\mathrm{D, ground}}+Y)} = \\frac{Z_{\\mathrm{D, ground}}+Y}{Z_{\\mathrm{D, exc}}+Y}\n$$\n\n现在，我们使用所提供的数据进行数值计算：\n$T = 2.00\\,\\mathrm{eV}$，$n_e = 1.00 \\times 10^{25}\\,\\mathrm{m}^{-3}$，$\\chi = 13.60\\,\\mathrm{eV}$，$\\Delta E_2 = 10.20\\,\\mathrm{eV}$，$\\Delta E_3 = 12.09\\,\\mathrm{eV}$。\n$m_e = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$，$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$，$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，$Z_{\\mathrm{D}^{+}} = 1$。\n\n首先，计算无量纲量 $Y$：\n$$\nY = \\frac{2 \\times 1}{1.00 \\times 10^{25}} \\left(\\frac{2\\pi (9.1093837 \\times 10^{-31}) (1.602176634 \\times 10^{-19}) (2.00)}{(6.62607015 \\times 10^{-34})^2}\\right)^{3/2} \\exp\\left(-\\frac{13.60}{2.00}\\right)\n$$\n计算对应于量子浓度的项：\n$$\n\\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} = (4.176214 \\times 10^{18})^{3/2} \\mathrm{m}^{-3} = 8.55393 \\times 10^{27} \\mathrm{m}^{-3}\n$$\n计算指数项：\n$$\n\\exp(-13.60/2.00) = \\exp(-6.80) = 1.11391 \\times 10^{-3}\n$$\n现在组合 $Y$：\n$$\nY = \\frac{2}{1.00 \\times 10^{25}} \\times (8.55393 \\times 10^{27}) \\times (1.11391 \\times 10^{-3}) = 1.90591\n$$\n接下来，计算配分函数：\n$Z_{\\mathrm{D, ground}} = 2$。\n$$\nZ_{\\mathrm{D, exc}} = 2 + 8 \\exp\\left(-\\frac{10.20}{2.00}\\right) + 18 \\exp\\left(-\\frac{12.09}{2.00}\\right)\n$$\n$$\nZ_{\\mathrm{D, exc}} = 2 + 8 \\exp(-5.1) + 18 \\exp(-6.045)\n$$\n$$\nZ_{\\mathrm{D, exc}} = 2 + 8(0.00609675) + 18(0.00236987) = 2 + 0.048774 + 0.042658 = 2.091432\n$$\n最后，计算比值 $R$：\n$$\nR = \\frac{Z_{\\mathrm{D, ground}}+Y}{Z_{\\mathrm{D, exc}}+Y} = \\frac{2 + 1.90591}{2.091432 + 1.90591} = \\frac{3.90591}{3.997342}\n$$\n$$\nR = 0.977127\n$$\n四舍五入到四位有效数字，我们得到 $0.9771$。", "answer": "$$\\boxed{0.9771}$$", "id": "3705161"}, {"introduction": "最后一个实践将你的技能从单次电离计算提升到模拟实际聚变等离子体中常见杂质元素的完整电荷态分布。你需要编写一个程序，通过迭代应用萨哈方程来计算碳元素在不同电荷态下的布居数。这个计算练习不仅是理论的应用，更是通向实际等离子体诊断和辐射建模等高级课题的关键一步，并能锻炼你处理数值计算稳定性的能力。[@problem_id:3705162]", "problem": "要求您编写一个完整、可运行的程序，仅使用统计力学和化学平衡的第一性原理，计算在局域热力学平衡下，非简并理想等离子体中碳的平衡电荷态分布。该等离子体由给定的温度 $T$ 和电子数密度 $n_e$ 表征。目标是计算碳（核电荷 $Z=6$）在电荷态 $q=0,1,2,3,4,5,6$ 下的离子分数向量 $f_{Z,q}$，其中 $f_{Z,q}$ 是处于电荷态 $q$ 的碳原子核所占的比例，且 $\\sum_{q=0}^{6} f_{Z,q} = 1$。您不得假设任何已有的简化公式；相反，您的程序必须遵循从核心定义出发的有原则的推导过程。\n\n假设与基础：\n- 等离子体处于热平衡和化学平衡状态，是稀薄、非简并的，并且在温度 $T$ 下可以很好地用麦克斯韦-玻尔兹曼统计进行描述。\n- 对于每个 $q \\in \\{0,\\dots,5\\}$，电离-复合平衡由反应 $\\mathrm{C}^{q} + e^- \\leftrightarrow \\mathrm{C}^{q+1}$ 在平衡状态下化学势相等所决定。\n- 对于非相对论理想气体极限下的每种物种 $s$，其化学势是通过数密度 $n_s$、经由热德布罗意波长的平动配分函数以及内配分函数表示的正则配分函数的标准结果。\n- 对于每个碳电荷态，其内配分函数近似为其基态贡献 $U_q \\approx 1$（对所有 $q \\in \\{0,\\dots,6\\}$），电子自旋简并度贡献一个因子 $2$。这个近似分离了对 $T$ 和 $n_e$ 的依赖关系，同时在本问题的测试条件下保持了科学上的合理性。\n- 碳的逐级电离能是作为常数给出的物理输入，必须严格按照下面给出的数值使用。\n\n数据与常数：\n- 逐级电离能 $\\chi_q$（对于 $q \\in \\{0,\\dots,5\\}$），单位为电子伏特 (eV)：$\\chi_0 = 11.2603$, $\\chi_1 = 24.383$, $\\chi_2 = 47.8878$, $\\chi_3 = 64.4939$, $\\chi_4 = 392.0905$, $\\chi_5 = 489.993$。\n- 电子质量 $m_e = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$。\n- 普朗克常数 $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$。\n- 电子伏特到焦耳的转换关系：$1\\ \\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J}$。\n\n您的程序必须：\n1. 从化学平衡条件 $\\mu_{q} + \\mu_e = \\mu_{q+1}$ 以及理想、非简并化学势关于数密度和配分函数的表达式出发，推导出比率 $r_q = n_{q+1}/n_q$（对于 $q \\in \\{0,\\dots,5\\}$）作为 $T$, $n_e$, $m_e$, $k_{\\mathrm{B}}$, $h$, $U_q$, $U_{q+1}$ 和 $\\chi_q$ 的函数。不要假设任何简化公式；从第一性原理计算热德布罗意波长，并强制执行包含电离能 $\\chi_q$ 的细致平衡。\n2. 根据 $r_q$ 和一个单一的乘法常数，计算所有七个相对布居数 $\\{n_q\\}_{q=0}^{6}$，然后进行归一化以获得分数 $f_{Z,q} = n_q / \\sum_{j=0}^{6} n_j$。\n3. 实现数值稳定的逻辑来处理极端参数值，以避免上溢或下溢。推荐的方法是在计算中间乘积时使用对数，并在进行指数运算前通过最大对数值进行移位。\n4. 将每个分数 $f_{Z,q}$ 四舍五入到6位小数后输出。\n\n单位和输入规范：\n- 温度 $T$ 必须以开尔文（$\\mathrm{K}$）为单位。\n- 电子密度 $n_e$ 必须以 $\\mathrm{m}^{-3}$ 为单位。\n- 电离能以电子伏特为单位提供，使用前必须转换为焦耳。\n- 输出的分数 $f_{Z,q}$ 是无量纲的。\n\n测试套件：\n您的程序必须按顺序计算以下五个案例的结果：\n- 案例 1：$T = 5000\\ \\mathrm{K}$, $n_e = 10^{20}\\ \\mathrm{m}^{-3}$。\n- 案例 2：$T = 10^{6}\\ \\mathrm{K}$, $n_e = 10^{10}\\ \\mathrm{m}^{-3}$。\n- 案例 3：$T = 2\\times 10^{5}\\ \\mathrm{K}$, $n_e = 10^{28}\\ \\mathrm{m}^{-3}$。\n- 案例 4：$T = 10^{7}\\ \\mathrm{K}$, $n_e = 10^{20}\\ \\mathrm{m}^{-3}$。\n- 案例 5：$T = 3\\times 10^{4}\\ \\mathrm{K}$, $n_e = 10^{16}\\ \\mathrm{m}^{-3}$。\n\n必需的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个结果列表，每个测试案例对应一个结果。每个结果是一个包含七个浮点数 $[f_{Z,0}, f_{Z,1}, f_{Z,2}, f_{Z,3}, f_{Z,4}, f_{Z,5}, f_{Z,6}]$ 的列表，四舍五入到6位小数。整个输出必须是单行，使用逗号分隔值且无空格，例如：`[[0.1,0.2,0.3,0.4,0.0,0.0,0.0],[\\dots],\\dots]`。", "solution": "该问题经评估为有效。这是一个适定的、有科学依据的统计等离子体物理问题，内容自洽且无矛盾。所提供的数据和常数在物理上是准确的，并且要求的第一性原理推导是统计力学中的一个标准而严谨的程序。\n\n目标是计算在给定温度 $T$ 和电子数密度 $n_e$ 下，等离子体中碳离子的平衡电荷态分布。该分布由每个电荷态 $q \\in \\{0, 1, \\dots, 6\\}$ 的分数 $f_{Z,q}$ 描述，其中对于碳，$Z=6$。\n\n解决方案的基础在于等离子体中发生的电离-复合反应的化学平衡原理。对于每个相邻的电离态对，反应为：\n$$ \\mathrm{C}^q + e^- \\leftrightarrow \\mathrm{C}^{q+1} $$\n在局域热力学平衡（LTE）中，反应物和产物的化学势是平衡的：\n$$ \\mu_q + \\mu_e = \\mu_{q+1} $$\n其中 $\\mu_q$、$\\mu_e$ 和 $\\mu_{q+1}$ 分别是电荷为 $q$ 的碳离子、电子和电荷为 $q+1$ 的碳离子的化学势。\n\n对于一个非简并、非相对论的理想气体，物种 $s$ 的化学势由以下公式给出：\n$$ \\mu_s = k_{\\mathrm{B}} T \\ln\\left(\\frac{n_s}{U_s} \\Lambda_s^3\\right) + E_s^{\\text{ground}} $$\n在此，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$n_s$ 是数密度，$U_s$ 是内配分函数，$E_s^{\\text{ground}}$ 是基态能量，$\\Lambda_s$ 是热德布罗意波长：\n$$ \\Lambda_s = \\sqrt{\\frac{h^2}{2 \\pi m_s k_{\\mathrm{B}} T}} $$\n其中 $h$ 是普朗克常数，$m_s$ 是该物种的质量。\n\n我们将此公式应用于反应中的每种粒子：\n对于电子（$s=e$，质量 $m_e$，密度 $n_e$）：内配分函数是其自旋简并度，$U_e = 2S+1 = 2$。我们将其基态能量设为参考零点，$E_e^{\\text{ground}} = 0$。\n$$ \\mu_e = k_{\\mathrm{B}} T \\ln\\left(\\frac{n_e}{2} \\left(\\frac{h^2}{2 \\pi m_e k_{\\mathrm{B}} T}\\right)^{3/2}\\right) $$\n对于电荷态为 $q$ 的离子（$s=q$，质量 $m_q$，密度 $n_q$）：内配分函数为 $U_q$。其基态能量为 $E_q^{\\text{ground}}$。\n$$ \\mu_q = k_{\\mathrm{B}} T \\ln\\left(\\frac{n_q}{U_q} \\left(\\frac{h^2}{2 \\pi m_q k_{\\mathrm{B}} T}\\right)^{3/2}\\right) + E_q^{\\text{ground}} $$\n对于电荷态为 $q+1$ 的离子（$s=q+1$，质量 $m_{q+1}$，密度 $n_{q+1}$）：内配分函数为 $U_{q+1}$。其基态能量为 $E_{q+1}^{\\text{ground}} = E_q^{\\text{ground}} + \\chi_q$，其中 $\\chi_q$ 是从态 $q$ 电离到 $q+1$ 所需的能量。\n$$ \\mu_{q+1} = k_{\\mathrm{B}} T \\ln\\left(\\frac{n_{q+1}}{U_{q+1}} \\left(\\frac{h^2}{2 \\pi m_{q+1} k_{\\mathrm{B}} T}\\right)^{3/2}\\right) + E_{q+1}^{\\text{ground}} $$\n\n将这些代入平衡条件 $\\mu_{q+1} = \\mu_q + \\mu_e$：\n$$ k_{\\mathrm{B}} T \\ln\\left(\\frac{n_{q+1}\\Lambda_{q+1}^3}{U_{q+1}}\\right) + E_{q+1}^{\\text{ground}} = k_{\\mathrm{B}} T \\ln\\left(\\frac{n_q\\Lambda_q^3}{U_q}\\right) + E_q^{\\text{ground}} + k_{\\mathrm{B}} T \\ln\\left(\\frac{n_e\\Lambda_e^3}{2}\\right) $$\n重新整理各项可得：\n$$ k_{\\mathrm{B}} T \\ln\\left(\\frac{n_{q+1} n_e^{-1}}{n_q} \\frac{U_q}{U_{q+1}} \\frac{2 \\Lambda_{q+1}^3}{\\Lambda_q^3 \\Lambda_e^3}\\right) = E_q^{\\text{ground}} - E_{q+1}^{\\text{ground}} = -\\chi_q $$\n离子热波长之比 $(\\Lambda_{q+1}/\\Lambda_q)^3 = (m_q/m_{q+1})^{3/2} \\approx 1$，因为由于失去一个电子而导致的离子质量变化是可忽略的（$m_e \\ll m_q$）。方程简化为：\n$$ \\ln\\left(\\frac{n_{q+1}}{n_q n_e} \\frac{U_q}{U_{q+1}} \\frac{2}{\\Lambda_e^3}\\right) = -\\frac{\\chi_q}{k_{\\mathrm{B}} T} $$\n求解数密度之比得到萨哈电离方程：\n$$ \\frac{n_{q+1}}{n_q} = n_e \\frac{U_{q+1}}{U_q} \\frac{\\Lambda_e^3}{2} \\exp\\left(-\\frac{\\chi_q}{k_{\\mathrm{B}} T}\\right) $$\n代入 $\\Lambda_e$ 的表达式并使用指定的近似 $U_{q+1}/U_q \\approx 1$，我们得到递推关系 $r_q = n_{q+1}/n_q$：\n$$ r_q = \\frac{1}{n_e} \\frac{2 U_{q+1}}{U_q} \\left( \\frac{2 \\pi m_e k_{\\mathrm{B}} T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi_q}{k_{\\mathrm{B}} T}\\right) \\quad \\text{for } q \\in \\{0, \\dots, 5\\} $$\n电离能 $\\chi_q$ 必须从电子伏特转换为焦耳。\n\n计算出比率 $r_q$ 后，我们可以找到所有电荷态的相对布居数。设 $P_q$ 为电荷态 $q$ 相对于中性态 $q=0$ 的布居数。我们设 $P_0 = 1$。\n$$ P_0 = 1 $$\n$$ P_1 = r_0 P_0 = r_0 $$\n$$ P_2 = r_1 P_1 = r_1 r_0 $$\n$$ P_q = \\prod_{j=0}^{q-1} r_j \\quad \\text{for } q \\in \\{1, \\dots, 6\\} $$\n处于电荷态 $q$ 的离子分数 $f_{Z,q}$ 则是相对布居数 $P_q$ 除以所有相对布居数的总和：\n$$ f_{Z,q} = \\frac{P_q}{\\sum_{j=0}^{6} P_j} $$\n为确保对乘积和指数运算中的上溢和下溢具有数值稳定性，计算在对数域中进行。设 $L_q = \\ln(P_q)$。递推关系变为：\n$$ L_0 = 0 $$\n$$ L_q = L_{q-1} + \\ln(r_{q-1}) \\quad \\text{for } q \\in \\{1, \\dots, 6\\} $$\n其中 $\\ln(r_q) = \\ln(2) - \\ln(n_e) + \\frac{3}{2}\\ln\\left(\\frac{2 \\pi m_e k_{\\mathrm{B}} T}{h^2}\\right) - \\frac{\\chi_q}{k_{\\mathrm{B}} T}$。\n分数使用标准的稳定 softmax 方法计算。设 $L_{\\max} = \\max_{j}\\{L_j\\}$。\n$$ f_{Z,q} = \\frac{\\exp(L_q)}{\\sum_{j=0}^{6} \\exp(L_j)} = \\frac{\\exp(L_q - L_{\\max})}{\\sum_{j=0}^{6} \\exp(L_j - L_{\\max})} $$\n这个过程保证了指数函数的参数是非正的，从而防止上溢，并确保和中至少有一项为 $1$，从而防止整个和的下溢。最终分数按要求四舍五入到6位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the equilibrium charge-state distribution for carbon in a plasma\n    using the Saha ionization equation derived from first principles.\n    \"\"\"\n\n    # Define physical constants in SI units.\n    M_E = 9.1093837015e-31  # Electron mass (kg)\n    K_B = 1.380649e-23      # Boltzmann constant (J/K)\n    H = 6.62607015e-34       # Planck constant (J*s)\n    EV_TO_J = 1.602176634e-19 # Conversion factor from eV to Joules\n\n    # Successive ionization energies for carbon in eV.\n    # chi_q is the energy to go from state q to q+1.\n    chi_ev = np.array([\n        11.2603,    # C^0 -> C^1\n        24.383,     # C^1 -> C^2\n        47.8878,    # C^2 -> C^3\n        64.4939,    # C^3 -> C^4\n        392.0905,   # C^4 -> C^5\n        489.993     # C^5 -> C^6\n    ])\n\n    # Convert ionization energies to Joules.\n    chi_j = chi_ev * EV_TO_J\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (5000, 1e20),      # Case 1: T in K, n_e in m^-3\n        (1e6, 1e10),       # Case 2\n        (2e5, 1e28),       # Case 3\n        (1e7, 1e20),       # Case 4\n        (3e4, 1e16)        # Case 5\n    ]\n\n    all_results = []\n\n    # Pre-calculate the constant part of the thermal factor's logarithm.\n    # This is ln(2 * (2*pi*m_e*k_B / h^2)^1.5)\n    log_thermal_const = np.log(2) + 1.5 * (\n        np.log(2 * np.pi * M_E * K_B / (H**2))\n    )\n\n    for T, n_e in test_cases:\n        # Vector of log-ratios log(n_{q+1}/n_q).\n        # We need to implement r_q = (1/n_e) * 2 * (2*pi*m*k*T/h^2)^1.5 * exp(-chi_q/kT)\n        # log(r_q) = log(2) - log(n_e) + 1.5*log(2*pi*m*k/h^2) + 1.5*log(T) - chi_q/kT\n        \n        # log(Saha Factor) = log(2/n_e) + 1.5*log(T) + 1.5*log_const_part\n        log_saha_factor_base = log_thermal_const + 1.5 * np.log(T) - np.log(n_e)\n\n        # Boltzmann factor exponent.\n        boltzmann_exp = -chi_j / (K_B * T)\n        \n        # Calculate log of each ratio r_q.\n        log_r = log_saha_factor_base + boltzmann_exp\n\n        # Calculate log of relative populations log(P_q) where P_q = n_q / n_0.\n        # log_P[0] = log(P_0) = log(1) = 0.\n        log_P = np.zeros(7)\n        for q in range(6):\n            log_P[q + 1] = log_P[q] + log_r[q]\n        \n        # Normalize for numerical stability (softmax technique).\n        # Shift by max log-population to prevent overflow/underflow.\n        log_P_max = np.max(log_P)\n        norm_log_P = log_P - log_P_max\n        \n        # Exponentiate to get relative populations.\n        relative_populations = np.exp(norm_log_P)\n        \n        # Calculate the sum for normalization.\n        sum_populations = np.sum(relative_populations)\n        \n        # Compute the final fractions.\n        fractions = relative_populations / sum_populations\n        \n        # Round each fraction to 6 decimal places.\n        rounded_fractions = [round(f, 6) for f in fractions]\n        \n        # Format the result as a string without spaces inside the list.\n        case_str = f\"[{','.join(map(str, rounded_fractions))}]\"\n        all_results.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3705162"}]}