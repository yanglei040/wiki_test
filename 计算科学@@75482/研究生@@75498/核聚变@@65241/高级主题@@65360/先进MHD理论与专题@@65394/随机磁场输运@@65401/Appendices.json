{"hands_on_practices": [{"introduction": "要理解随机磁场输运，我们首先需要理解磁力线本身的混沌特性。标准映射（Standard Map）是一个强大而简洁的工具，用于研究从规则运动到广泛混沌的转变。这项实践将通过计算李雅普诺夫指数和扩散系数这两个该领域的基本度量，为您提供量化混沌和输运的第一手经验。[@problem_id:3720048]", "problem": "考虑一个用于核聚变装置中随机磁场输运的数学模型，其中磁力线被视为哈密顿系统的轨迹。在作用量-角度坐标 $(\\theta,I)$ 中，以环向角作为演化参数，静磁场线遵循正则哈密顿方程 $d\\theta/d\\phi = \\partial H/\\partial I$ 和 $dI/d\\phi = -\\partial H/\\partial \\theta$，其中 $H(\\theta,I,\\phi)$ 在环向角 $\\phi$ 上是 $2\\pi$ 周期的。对于单个主导的共振微扰，每个环向周期进行一次采样的频闪庞加莱映射可简化为一种保面积的扭转映射，称为Chirikov–Taylor标准映射，它可作为有理面附近磁力线的映射模型。圆柱上的标准映射由以下正则更新规则定义：\n$$\nI_{n+1} = I_n + K \\sin(\\theta_n), \\quad \\theta_{n+1} = \\theta_n + I_{n+1} \\mod 2\\pi,\n$$\n其中 $n$ 是在庞加莱截面上的穿越次数索引，$K$ 是一个与微扰强度成正比的非负参数，$\\theta_n \\in [0,2\\pi)$ 是一个角度变量，$I_n \\in \\mathbb{R}$ 是一个与径向漂移成正比的类作用量变量。在此模型中，磁力线输运通过两个度量来量化：\n1. 有限时间扩散系数\n$$\nD_N(K) = \\frac{1}{2N}\\left\\langle (I_N - I_0)^2 \\right\\rangle,\n$$\n其中 $\\langle \\cdot \\rangle$ 表示对指定初始条件系综的平均，$N$ 是映射迭代次数。\n2. 有限时间最大李雅普诺夫指数\n$$\n\\lambda_N(K) = \\left\\langle \\frac{1}{N}\\sum_{n=0}^{N-1} \\ln \\frac{\\left\\|\\delta \\mathbf{v}_{n+1}\\right\\|}{\\left\\|\\delta \\mathbf{v}_{n}\\right\\|} \\right\\rangle,\n$$\n该指数由演化无穷小微扰 $\\delta \\mathbf{v}_n = (\\delta \\theta_n, \\delta I_n)$ 的切映射计算得出，通过雅可比矩阵\n$$\nJ(\\theta_n) = \n\\begin{pmatrix}\n1 + K \\cos(\\theta_n) & 1 \\\\\nK \\cos(\\theta_n) & 1\n\\end{pmatrix},\n$$\n其中范数 $\\|\\cdot\\|$ 取为欧几里得范数。此李雅普诺夫指数测量相邻磁力线之间分离的平均指数率，是混沌的一个正则指标。该映射是保面积的，即 $\\det J(\\theta_n) = 1$。当 $K$ 足够小时，系统表现出Kolmogorov–Arnold–Moser (KAM) 不变曲线，随着 $K$ 的增加，这些曲线会逐渐破裂。\n\n任务：从静磁场线的正则哈密顿结构和到离散保面积映射的频闪简化出发，实现一个程序，对下列每个测试用例：\n- 对一个由 $M$ 个确定性初始条件组成的系综，演化标准映射 $N$ 次迭代。这些初始条件定义为 $\\theta_0$ 在 $[0,2\\pi)$ 内均匀分布，且所有系综成员的 $I_0 = 0$。使用弧度制角度。\n- 通过对系综求 $(I_N - I_0)^2$ 的平均值，然后除以 $2N$ 来计算 $D_N(K)$。\n- 通过对系综中的每个成员在 $J(\\theta_n)$ 下同时演化切动力学来计算 $\\lambda_N(K)$。所有成员的初始切向量为 $(\\delta \\theta_0,\\delta I_0) = (1,0)$。在每一步，累加范数增量的对数，并将切向量重整化为单位范数以防止数值溢出。将有限时间指数在系综上平均，得到 $\\lambda_N(K)$。\n\n角度必须以弧度处理。$D_N(K)$ 或 $\\lambda_N(K)$ 没有需要报告的物理单位，因为该模型是无量纲的。\n\n测试套件：\n- 情况1（可积边界）：$K = 0.0$, $N = 4000$, $M = 128$。\n- 情况2（近可积）：$K = 0.5$, $N = 4000$, $M = 128$。\n- 情况3（临近KAM曲线破裂）：$K = 0.971635$, $N = 8000$, $M = 128$。\n- 情况4（强混沌）：$K = 3.0$, $N = 4000$, $M = 128$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表用方括号括起。每个测试用例贡献一个双元素列表 $[D_N(K),\\lambda_N(K)]$，两个条目都格式化为小数点后六位的浮点数。最终输出不得有空格。例如，两个用例的输出将如下所示：$[[0.000000,0.000000],[1.234567,0.890123]]$。\n\n目标是：\n- 通过使用磁力线动力学的正则结构和保面积映射来模拟庞加莱输运，确保科学真实性。\n- 通过将映射和切动力学建立在哈密顿形式和雅可比传播的基础上，而不是调用特设的输运公式，来展示第一性原理推导。\n- 使用指定的系综和重整化方案，提供数值稳定和确定性的计算。", "solution": "该问题要求实现一个数值模拟，为Chirikov-Taylor标准映射计算两个关键的输运度量——有限时间扩散系数 $D_N(K)$ 和有限时间最大李雅普诺夫指数 $\\lambda_N(K)$。该映射是哈密顿动力学中的一个范式模型，代表了环形聚变装置中共振磁面附近磁力线的频闪演化。该解决方案基于对映射方程和相关切映射在一组初始条件的统计系综上进行直接数值积分。\n\n整个过程植根于第一性原理，从静磁场线的正则哈密顿结构开始，这保证了其演化保留相空间体积。简化为像标准映射这样的离散保面积映射，是等离子体物理和非线性动力学中的标准技术。保面积性质，在数学上表示为 $\\det(J)=1$（其中 $J$ 是映射的雅可比矩阵），是底层哈密顿形式的直接结果。\n\n算法设计如下：\n\n**1. 系综初始化**\n\n为了获得具有统计意义的输运系数，我们模拟一个包含 $M$ 个轨迹的系综。问题指定了确定性的初始条件。\n- 所有 $M$ 个系综成员的初始类作用量变量都设置为 $I_0 = 0$。这对应于所有磁力线都从同一个未受扰动的共振面开始。\n- 初始角度变量 $\\theta_0$ 在区间 $[0, 2\\pi)$ 上均匀分布。为了进行确定性、可复现的计算，我们使用公式 $\\theta_{0,j} = \\frac{2\\pi j}{M}$（其中 $j=0, 1, \\dots, M-1$）生成 $M$ 个等间距的点。\n\n**2. 状态向量演化**\n\n对于 $M$ 个初始条件 $(\\theta_{0,j}, I_{0,j})$ 中的每一个，标准映射被迭代 $N$ 步。第 $n+1$ 步的状态由第 $n$ 步的状态通过以下正则更新规则计算得出：\n$$\nI_{n+1} = I_n + K \\sin(\\theta_n)\n$$\n$$\n\\theta_{n+1} = (\\theta_n + I_{n+1}) \\pmod{2\\pi}\n$$\n在这里，取模运算确保角度 $\\theta$ 保持在基本域 $[0, 2\\pi)$ 内。这些方程被迭代应用于 $n = 0, 1, \\dots, N-1$，以获得最终状态 $(\\theta_{N,j}, I_{N,j})$。\n\n**3. 扩散系数 $D_N(K)$ 的计算**\n\n扩散系数 $D_N(K)$ 量化了作用量变量 $I$ 在 $N$ 次迭代中的均方位移，并在系综上取平均。它是磁力线径向输运的一个度量。其定义为：\n$$\nD_N(K) = \\frac{1}{2N}\\left\\langle (I_N - I_0)^2 \\right\\rangle\n$$\n尖括号 $\\langle \\cdot \\rangle$ 表示系综平均。对于我们指定的系综，其中所有成员的 $I_0 = 0$，计算简化为：\n$$\nD_N(K) = \\frac{1}{2N} \\left( \\frac{1}{M} \\sum_{j=1}^{M} (I_{N,j})^2 \\right) = \\frac{1}{2NM} \\sum_{j=1}^{M} I_{N,j}^2\n$$\n这在 $N$ 次迭代完成后，通过计算最终作用量值平方 $I_{N,j}^2$ 的均值，并乘以因子 $1/(2N)$ 来得到。\n\n**4. 李雅普诺夫指数 $\\lambda_N(K)$ 的计算**\n\n最大李雅普诺夫指数 $\\lambda_N(K)$ 测量相邻轨迹发散的平均指数率，是混沌的一个基本指标。它通过沿一条轨迹演化一个无穷小切向量 $\\delta \\mathbf{v}_n = (\\delta \\theta_n, \\delta I_n)$ 来计算。该向量的演化由切映射控制，这是一个由雅可比矩阵 $J(\\theta_n)$ 定义的线性变换：\n$$\n\\delta \\mathbf{v}_{n+1} = J(\\theta_n) \\delta \\mathbf{v}_n, \\quad \\text{其中} \\quad J(\\theta_n) =\n\\begin{pmatrix}\n1 + K \\cos(\\theta_n) & 1 \\\\\nK \\cos(\\theta_n) & 1\n\\end{pmatrix}\n$$\n直接迭代这个线性映射将导致数值溢出，因为在混沌区域，$\\delta \\mathbf{v}_n$ 的范数呈指数增长。为了确保数值稳定性，在系综中每条轨迹的每次迭代步骤中都采用标准的重整化程序。\n\n程序如下：\n- **初始化**：对于每条轨迹 $j$，初始切向量被设置为一个单位向量，指定为 $\\delta \\mathbf{v}_{0,j} = (1, 0)$。一个用于累加增长因子对数的运行总和 $S_j$ 初始化为 $0$。\n- **迭代 ($n=0, \\dots, N-1$)**：\n    1. 使用在轨迹当前位置 $\\theta_{n,j}$ 处计算的雅可比矩阵，将切向量演化一步：$\\delta \\mathbf{v}'_{n+1,j} = J(\\theta_{n,j}) \\delta \\mathbf{v}_{n,j}$。\n    2. 计算所得向量的欧几里得范数：$d_{n+1,j} = \\|\\delta \\mathbf{v}'_{n+1,j}\\|$。这代表了在第 $n+1$ 步的局部拉伸因子。\n    3. 将该因子的自然对数加到运行总和中：$S_j \\leftarrow S_j + \\ln(d_{n+1,j})$。\n    4. 为下一次迭代，将切向量重整化为单位长度：$\\delta \\mathbf{v}_{n+1,j} = \\delta \\mathbf{v}'_{n+1,j} / d_{n+1,j}$。\n- **最终计算**：经过 $N$ 次迭代后，每条轨迹的有限时间李雅普诺夫指数为 $\\lambda_{N,j} = S_j / N$。最终值是系综的平均值：\n$$\n\\lambda_N(K) = \\langle \\lambda_{N,j} \\rangle = \\frac{1}{M} \\sum_{j=1}^{M} \\frac{S_j}{N}\n$$\n这个算法正确地实现了李雅普诺夫指数的定义 $\\lambda_N(K) = \\frac{1}{N} \\langle \\sum_{n=0}^{N-1} \\ln (\\|\\delta \\mathbf{v}_{n+1}\\| / \\|\\delta \\mathbf{v}_n\\|) \\rangle$，因为每一步的重整化确保了 $\\|\\delta \\mathbf{v}_n\\|$ 始终为 $1$。\n\n该实现将利用 `numpy` 在整个系综上进行向量化操作，从而极大地提高计算效率。每个测试用例将按顺序处理，应用上述算法生成配对 $[D_N(K), \\lambda_N(K)]$，然后将其格式化为所需的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_transport_coeffs(K, N, M):\n    \"\"\"\n    Computes the finite-time diffusion coefficient and Lyapunov exponent for the standard map.\n\n    Args:\n        K (float): The stochasticity parameter of the standard map.\n        N (int): The number of map iterations.\n        M (int): The number of ensemble members.\n\n    Returns:\n        tuple[float, float]: A tuple containing (D_N, lambda_N).\n    \"\"\"\n    # 1. Initialize ensemble and state variables\n    # Initial angles are uniformly spaced in [0, 2*pi).\n    thetas = np.linspace(0.0, 2.0 * np.pi, M, endpoint=False)\n    # Initial actions are all zero.\n    Is = np.zeros(M, dtype=np.float64)\n\n    # 2. Initialize tangent vectors and Lyapunov exponent accumulator\n    # Initial tangent vectors are (1, 0) for all ensemble members.\n    delta_thetas = np.ones(M, dtype=np.float64)\n    delta_Is = np.zeros(M, dtype=np.float64)\n    # Accumulator for the sum of logarithms of norms for each trajectory.\n    log_norm_sum = np.zeros(M, dtype=np.float64)\n\n    # 3. Evolve the map and tangent vectors for N steps\n    for _ in range(N):\n        # Store current theta for Jacobian calculation\n        theta_n = thetas\n        \n        # Update state vector (I, theta) according to the standard map equations\n        I_next = Is + K * np.sin(theta_n)\n        theta_next = np.mod(theta_n + I_next, 2.0 * np.pi)\n        \n        # Update states for the next iteration\n        thetas = theta_next\n        Is = I_next\n        \n        # Evolve the tangent vector using the Jacobian matrix\n        # J(theta_n) = [[1 + K*cos(theta_n), 1], [K*cos(theta_n), 1]]\n        K_cos_theta = K * np.cos(theta_n)\n        \n        d_theta_prime = (1.0 + K_cos_theta) * delta_thetas + delta_Is\n        d_I_prime = K_cos_theta * delta_thetas + delta_Is\n        \n        # Calculate the Euclidean norm of the new tangent vector\n        norms = np.sqrt(d_theta_prime**2 + d_I_prime**2)\n        \n        # Add the log of the norm to the accumulator.\n        # Handle cases where norm might be zero to avoid log(0).\n        # For this problem, with initial vector (1,0), norms will be >= 1 for K>=0.\n        log_norm_sum += np.log(norms)\n        \n        # Renormalize the tangent vector to unit length\n        # Add a small epsilon to avoid division by zero, although not strictly necessary here.\n        # As norms >= 1, we can safely divide.\n        delta_thetas = d_theta_prime / norms\n        delta_Is = d_I_prime / norms\n\n    # 4. Calculate final transport coefficients\n    # Diffusion coefficient: D_N = (I_N - I_0)^2> / (2*N)\n    # Since I_0 = 0, this simplifies to", "id": "3720048"}, {"introduction": "在探索了混沌的定性性质之后，下一步是将其与物理输运进行定量联系。本练习从抽象的映射模型转向真实的等离子体，使用统计力学的基石——Green-Kubo关系，来推导电子热扩散系数。该练习将展示如何结合磁场随机性和其他碰撞或湍流过程的效应，以确定最终的有效输运率。[@problem_id:3705786]", "problem": "在环形磁约束装置中，重叠的磁岛产生随机磁场，通过 Rechester–Rosenbluth (RR) 机制驱动电子热输运。考虑电子沿着随机磁力线运动，其瞬时径向速度建模为 $v_{r}(t) = v_{\\parallel}(t)\\, b_{r}(s(t))$，其中 $v_{\\parallel}$ 是平行速度，$b_{r} \\equiv \\delta B_{r}/B$ 是归一化的径向磁扰动。假设涨落量具有以下有物理依据的统计特性：\n- 由于具有有限平行相关时间 $\\tau_{\\parallel}$ 的湍流螺距角散射，电子平行速度自相关呈指数衰减，即 $\\langle v_{\\parallel}(0)\\, v_{\\parallel}(t)\\rangle = v_{\\text{th},e}^{2}\\, \\exp(-t/\\tau_{\\parallel})$，其中 $v_{\\text{th},e} = \\sqrt{2 T_{e}/m_{e}}$ 是电子热速度，$T_{e}$ 是以能量单位表示的电子温度，$m_{e}$ 是电子质量。\n- 沿着磁力线的归一化径向磁扰动相关性随平行弧长 $s$ 在相关长度 $L_{c}$ 上呈指数衰减，即 $\\langle b_{r}(0)\\, b_{r}(s)\\rangle = (\\delta B/B)^{2}\\, \\exp(-|s|/L_{c})$，其中 $\\delta B/B$ 是均方根分数磁扰动幅度。\n- 在一个相关区间内，平行运动近似为弹道运动，因此 $s(t) \\approx v_{\\text{th},e}\\, t$。\n\n从跨场热扩散系数的 Green–Kubo 定义出发，\n$$\n\\chi_{e} = \\int_{0}^{\\infty} \\langle v_{r}(0)\\, v_{r}(t)\\rangle \\, dt,\n$$\n推导有效电子热扩散系数 $\\chi_{e,\\text{eff}}$ 的闭合形式表达式，该表达式同时考虑了沿磁力线的磁退相干和由湍流散射引起的有限平行相关时间。然后，对以下代表具有磁岛重叠的托卡马克等离子体的参数，数值计算 $\\chi_{e,\\text{eff}}$：\n- 大半径 $R = 1.8\\,\\text{m}$，安全因子 $q = 2.7$，因此 $L_{c} = \\pi q R$，\n- 电子温度 $T_{e} = 2.5\\,\\text{keV}$，\n- 分数磁扰动幅度 $\\delta B/B = 7.0 \\times 10^{-4}$，\n- 平行相关时间 $\\tau_{\\parallel} = 3.0\\,\\mu\\text{s}$。\n\n将 $\\chi_{e,\\text{eff}}$ 的最终数值答案四舍五入到三位有效数字。以 $\\text{m}^{2}\\,\\text{s}^{-1}$ 为单位表示 $\\chi_{e,\\text{eff}}$ 的值。", "solution": "该问题被认为是有效的，因为它在科学上基于等离子体物理和统计力学的原理，提法良好，有足够的信息和清晰的定义来得出唯一解，并且以客观、正式的语言陈述。我们可以开始求解。\n\n问题要求推导有效电子热扩散系数 $\\chi_{e,\\text{eff}}$ 并进行后续的数值计算。我们从给定的跨场热扩散系数的 Green–Kubo 定义开始：\n$$\n\\chi_{e} = \\int_{0}^{\\infty} \\langle v_{r}(0)\\, v_{r}(t)\\rangle \\, dt\n$$\n瞬时径向速度由模型 $v_{r}(t) = v_{\\parallel}(t)\\, b_{r}(s(t))$ 给出，其中 $v_{\\parallel}(t)$ 是平行速度，$b_{r}(s(t))$ 是归一化的径向磁扰动，$s(t)$ 是平行弧长坐标。Green-Kubo 公式的被积函数是该径向速度的自相关函数：\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\langle [v_{\\parallel}(0)\\, b_{r}(s(0))] \\cdot [v_{\\parallel}(t)\\, b_{r}(s(t))] \\rangle\n$$\n在时间 $t=0$ 时，弧长为 $s(0)=0$。表达式变为：\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\langle v_{\\parallel}(0)\\, b_{r}(0) \\, v_{\\parallel}(t)\\, b_{r}(s(t)) \\rangle\n$$\n在此类模型中，一个标准且有物理动机的假设是，由湍流螺距角散射驱动的平行速度涨落，与由磁流体动力学（MHD）不稳定性或外部共振场等不同物理现象引起的磁场空间涨落，在统计上是独立的。这种统计独立性允许将四点相关函数分解为两个两点相关函数的乘积：\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\langle v_{\\parallel}(0)\\, v_{\\parallel}(t)\\rangle \\langle b_{r}(0)\\, b_{r}(s(t)) \\rangle\n$$\n问题给出了这些相关函数的显式形式：\n$$\n\\langle v_{\\parallel}(0)\\, v_{\\parallel}(t)\\rangle = v_{\\text{th},e}^{2}\\, \\exp(-t/\\tau_{\\parallel})\n$$\n$$\n\\langle b_{r}(0)\\, b_{r}(s)\\rangle = (\\delta B/B)^{2}\\, \\exp(-|s|/L_{c})\n$$\n将这些代入径向速度自相关的表达式中，得到：\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\left( v_{\\text{th},e}^{2}\\, \\exp(-t/\\tau_{\\parallel}) \\right) \\left( (\\delta B/B)^{2}\\, \\exp(-|s(t)|/L_{c}) \\right)\n$$\n问题指出，在一个相关区间内，对电子使用弹道平行运动近似，表示为 $s(t) \\approx v_{\\text{th},e}\\, t$。对于积分域 $t \\ge 0$，这意味着 $|s(t)| = v_{\\text{th},e}\\, t$。将此代入相关函数，得到：\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\exp(-t/\\tau_{\\parallel}) \\exp(-v_{\\text{th},e} t / L_{c})\n$$\n通过合并指数项，我们得到：\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\exp\\left( -t \\left( \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\right) \\right)\n$$\n现在我们可以执行 Green–Kubo 公式所要求的积分，以求得有效热扩散系数，我们将其记为 $\\chi_{e,\\text{eff}}$：\n$$\n\\chi_{e,\\text{eff}} = \\int_{0}^{\\infty} v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\exp\\left( -t \\left( \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\right) \\right) dt\n$$\n与积分变量 $t$ 无关的项可以被提出来：\n$$\n\\chi_{e,\\text{eff}} = v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\int_{0}^{\\infty} \\exp\\left( -t \\left( \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\right) \\right) dt\n$$\n该积分是标准形式 $\\int_{0}^{\\infty} \\exp(-at)\\,dt = 1/a$，其中速率常数为 $a = \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}$。执行积分得到有效电子热扩散系数的最终闭合形式表达式：\n$$\n\\chi_{e,\\text{eff}} = \\frac{v_{\\text{th},e}^{2} (\\delta B/B)^{2}}{\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}}\n$$\n这个表达式正确地包含了来自平行速度散射（时间尺度为 $\\tau_{\\parallel}$）和磁场结构（有效渡越时间尺度为 $L_c / v_{\\text{th},e}$）的组合退相干效应。\n\n接下来，我们使用给定的参数和基本物理常数对此表达式进行数值计算。所有计算都将以国际单位制（SI）单位进行。给定的参数是：\n- 大半径：$R = 1.8\\,\\text{m}$\n- 安全因子：$q = 2.7$\n- 电子温度：$T_{e} = 2.5\\,\\text{keV}$\n- 磁扰动幅度：$\\delta B/B = 7.0 \\times 10^{-4}$\n- 平行相关时间：$\\tau_{\\parallel} = 3.0\\,\\mu\\text{s} = 3.0 \\times 10^{-6}\\,\\text{s}$\n\n我们还使用以下基本常数：\n- 电子质量：$m_{e} \\approx 9.10938 \\times 10^{-31}\\,\\text{kg}$\n- 基本电荷：$e \\approx 1.60218 \\times 10^{-19}\\,\\text{C}$，从而得到转换关系 $1\\,\\text{keV} \\approx 1.60218 \\times 10^{-16}\\,\\text{J}$。\n\n首先，我们计算必要的导出量：\n1. 磁场相关长度 $L_{c}$：\n$$L_{c} = \\pi q R = \\pi \\times 2.7 \\times 1.8\\,\\text{m} \\approx 15.2681\\,\\text{m}$$\n2. 以焦耳为单位的电子温度，注意到 $T_e$ 是以能量单位给出的：\n$$T_{e} = 2.5\\,\\text{keV} \\times \\frac{1.60218 \\times 10^{-16}\\,\\text{J}}{1\\,\\text{keV}} \\approx 4.00545 \\times 10^{-16}\\,\\text{J}$$\n3. 电子热速度 $v_{\\text{th},e}$：\n$$v_{\\text{th},e} = \\sqrt{\\frac{2 T_{e}}{m_{e}}} = \\sqrt{\\frac{2 \\times (4.00545 \\times 10^{-16}\\,\\text{J})}{9.10938 \\times 10^{-31}\\,\\text{kg}}} \\approx \\sqrt{8.7940 \\times 10^{14}\\,\\text{m}^{2}\\,\\text{s}^{-2}} \\approx 2.96547 \\times 10^{7}\\,\\text{m}\\,\\text{s}^{-1}$$\n\n现在，我们计算 $\\chi_{e,\\text{eff}}$ 表达式的分子和分母。\n- 分子, $v_{\\text{th},e}^{2} (\\delta B/B)^{2}$:\n$$v_{\\text{th},e}^{2} (\\delta B/B)^{2} = (2.96547 \\times 10^{7}\\,\\text{m}\\,\\text{s}^{-1})^{2} \\times (7.0 \\times 10^{-4})^{2}$$\n$$\\approx (8.7940 \\times 10^{14}\\,\\text{m}^{2}\\,\\text{s}^{-2}) \\times (4.9 \\times 10^{-7}) \\approx 4.30906 \\times 10^{8}\\,\\text{m}^{2}\\,\\text{s}^{-2}$$\n- 分母，即两个退相干率之和, $\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}$：\n  - 散射率：$\\frac{1}{\\tau_{\\parallel}} = \\frac{1}{3.0 \\times 10^{-6}\\,\\text{s}} \\approx 3.33333 \\times 10^{5}\\,\\text{s}^{-1}$\n  - 磁结构渡越率：$\\frac{v_{\\text{th},e}}{L_{c}} = \\frac{2.96547 \\times 10^{7}\\,\\text{m}\\,\\text{s}^{-1}}{15.2681\\,\\text{m}} \\approx 1.94228 \\times 10^{6}\\,\\text{s}^{-1}$\n  - 分母中的总速率是它们的和：\n    $$\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\approx (3.33333 \\times 10^{5} + 1.94228 \\times 10^{6})\\,\\text{s}^{-1} \\approx 2.27561 \\times 10^{6}\\,\\text{s}^{-1}$$\n\n最后，我们通过将分子除以分母来计算 $\\chi_{e,\\text{eff}}$：\n$$\n\\chi_{e,\\text{eff}} = \\frac{v_{\\text{th},e}^{2} (\\delta B/B)^{2}}{\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}} \\approx \\frac{4.30906 \\times 10^{8}\\,\\text{m}^{2}\\,\\text{s}^{-2}}{2.27561 \\times 10^{6}\\,\\text{s}^{-1}} \\approx 189.359\\,\\text{m}^{2}\\,\\text{s}^{-1}\n$$\n问题要求将最终数值答案四舍五入到三位有效数字。\n$$\n\\chi_{e,\\text{eff}} \\approx 189\\,\\text{m}^{2}\\,\\text{s}^{-1}\n$$", "answer": "$$\\boxed{189}$$", "id": "3705786"}, {"introduction": "最后的这项实践将在理论系数与聚变装置中的实际后果之间架起一座桥梁。通过将随机扩散系数的概念应用于等离子体边界的简化模型，我们可以计算出到达壁的粒子通量。这个练习阐明了对混沌磁力线的抽象研究如何直接影响我们对等离子体与壁相互作用等关键现象的理解和预测。[@problem_id:3720053]", "problem": "在一个与核聚变相关的环形磁约束装置中，假设紧邻磁分界面的一个宽度为 $w$ 的窄层受到随机扰动，导致磁场线呈现径向漂移。将电子导心视作无源示踪物，其沿着磁场线以近似于分界面处电子热速度的平行速度运动，并设垂直于磁场的运动完全由磁场线的随机性引起。该层的径向坐标为 $x \\in [0,w]$，其中 $x=0$ 位于分界面（核心区一侧），$x=w$ 位于一个完全吸收壁。\n\n假设以下具有物理动机的假说：\n- 瞬时径向导心速度可以写为 $v_{r}(t) = v_{\\parallel}\\,\\delta b(t)$，其中 $v_{\\parallel}$ 是电子的平行速度，而 $\\delta b(t) \\doteq \\delta B_{\\perp}(t)/B$ 是一个零均值的平稳随机过程，代表归一化的垂直磁扰动。\n- 过程 $\\delta b(t)$ 的方差为 $\\langle \\delta b^{2} \\rangle = (\\delta B/B)^{2}$，并具有指数自相关函数 $\\langle \\delta b(0)\\,\\delta b(t) \\rangle = (\\delta B/B)^{2}\\exp(-|t|/\\tau_{c})$，其相关时间 $\\tau_{c} \\doteq L_{c}/v_{\\parallel}$ 由平行相关长度 $L_{c}$ 决定。\n- 从 Green–Kubo 关系式（该关系式将扩散系数表示为速度自相关函数的时间积分）出发，推导由随机磁场产生的有效横场粒子扩散系数 $D$，用 $v_{\\parallel}$、$L_{c}$ 和 $\\delta B/B$ 表示。\n\n在随机层中，将电子粒子密度 $n(x)$ 建模为在一维（1D）稳态横场扩散下演化，扩散系数 $D$ 为常数，且无体积源或汇，因此稳态满足 $0 = \\frac{d}{dx}\\!\\left(D\\,\\frac{dn}{dx}\\right)$。施加边界条件：在分界面处 $n(0)=n_{\\text{sep}}$（狄利克雷条件，由与核心区的快速平行平衡固定）和在壁面处 $n(w)=0$（完全吸收）。据此，确定壁面处的向外粒子通量密度 $\\Gamma_{w}$。\n\n使用以下参数：\n- 分界面处的电子温度 $T_{e} = 2.0\\,\\text{keV}$（将 $T_{e}$ 视为能量，因此 $k_{B}T_{e}$ 通过基本电荷与以焦耳为单位的 $T_{e}$ 等同）。\n- 基本电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\text{C}$。\n- 电子质量 $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\text{kg}$。\n- 相对磁扰动幅度 $\\delta B/B = 1.0 \\times 10^{-3}$。\n- 平行相关长度 $L_{c} = 15\\,\\text{m}$。\n- 随机层宽度 $w = 0.020\\,\\text{m}$。\n- 分界面密度 $n_{\\text{sep}} = 5.0 \\times 10^{19}\\,\\text{m}^{-3}$。\n\n取 $v_{\\parallel}$ 等于电子热速度 $v_{\\text{th},e} \\doteq \\sqrt{2 T_{e} e / m_{e}}$。以 $\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位，给出壁面处向外粒子通量密度 $\\Gamma_{w}$ 的最终数值，并将答案四舍五入到三位有效数字。", "solution": "问题陈述经评估有效。它在科学上基于等离子体物理学和磁约束聚变的原理，特别关注随机磁场中的粒子输运。该问题设定良好，具有明确的物理模型、控制方程和边界条件，可导出唯一解。给定的参数对于托卡马克边缘等离子体是物理上现实的。语言客观而精确。因此，将推导解答。\n\n问题分两大部分解决：首先，推导有效横场粒子扩散系数 $D$；其次，计算壁面处的粒子通量密度 $\\Gamma_w$。\n\n**第1部分：横场粒子扩散系数 $D$ 的推导**\n\nGreen–Kubo 关系式给出了扩散系数的一般表达式，即速度自相关函数的时间积分。对于径向扩散系数 $D$，该关系式为：\n$$\nD = \\int_{0}^{\\infty} \\langle v_r(0) v_r(t) \\rangle \\, dt\n$$\n其中 $v_r(t)$ 是粒子导心的瞬时径向速度，$\\langle \\dots \\rangle$ 表示对平稳随机过程的系综平均。\n\n问题陈述径向速度由 $v_r(t) = v_{\\parallel} \\delta b(t)$ 给出，其中 $v_{\\parallel}$ 是恒定的电子平行速度，$\\delta b(t)$ 是归一化的垂直磁扰动。将此代入 Green–Kubo 公式，我们得到：\n$$\nD = \\int_{0}^{\\infty} \\langle (v_{\\parallel} \\delta b(0)) (v_{\\parallel} \\delta b(t)) \\rangle \\, dt\n$$\n由于 $v_{\\parallel}$ 是一个常数，可以将其移到系综平均的外部：\n$$\nD = v_{\\parallel}^2 \\int_{0}^{\\infty} \\langle \\delta b(0) \\delta b(t) \\rangle \\, dt\n$$\n问题指定了随机过程 $\\delta b(t)$ 的自相关函数为：\n$$\n\\langle \\delta b(0) \\delta b(t) \\rangle = \\left(\\frac{\\delta B}{B}\\right)^2 \\exp\\left(-\\frac{|t|}{\\tau_c}\\right)\n$$\n其中 $(\\delta B/B)$ 是相对磁扰动幅度，$\\tau_c$ 是相关时间。\n\n将此代入 $D$ 的表达式，并注意到积分区间为 $t \\ge 0$（因此 $|t|=t$）：\n$$\nD = v_{\\parallel}^2 \\left(\\frac{\\delta B}{B}\\right)^2 \\int_{0}^{\\infty} \\exp\\left(-\\frac{t}{\\tau_c}\\right) \\, dt\n$$\n该积分为标准指数积分：\n$$\n\\int_{0}^{\\infty} \\exp\\left(-\\frac{t}{\\tau_c}\\right) \\, dt = \\left[ -\\tau_c \\exp\\left(-\\frac{t}{\\tau_c}\\right) \\right]_{0}^{\\infty} = -\\tau_c(0 - 1) = \\tau_c\n$$\n因此，扩散系数为：\n$$\nD = v_{\\parallel}^2 \\left(\\frac{\\delta B}{B}\\right)^2 \\tau_c\n$$\n问题进一步给出了关系式 $\\tau_c = L_c / v_{\\parallel}$，其中 $L_c$ 是平行相关长度。用此替换 $\\tau_c$：\n$$\nD = v_{\\parallel}^2 \\left(\\frac{\\delta B}{B}\\right)^2 \\left(\\frac{L_c}{v_{\\parallel}}\\right)\n$$\n这简化为扩散系数的最终表达式，通常称为 Rechester-Rosenbluth 扩散系数：\n$$\nD = v_{\\parallel} L_c \\left(\\frac{\\delta B}{B}\\right)^2\n$$\n\n**第2部分：向外粒子通量密度 $\\Gamma_w$ 的计算**\n\n随机层中的稳态一维粒子守恒方程如下：\n$$\n\\frac{d}{dx}\\left(D \\frac{dn}{dx}\\right) = 0\n$$\n其中 $n(x)$ 是电子粒子密度，$x \\in [0,w]$ 是径向坐标。\n\n由于上面推导出的扩散系数 $D$ 相对于位置 $x$ 是常数，方程简化为：\n$$\nD \\frac{d^2n}{dx^2} = 0 \\quad \\implies \\quad \\frac{d^2n}{dx^2} = 0\n$$\n这个二阶常微分方程的通解是 $x$ 的线性函数：\n$$\nn(x) = C_1 x + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n\n边界条件为：\n1.  在分界面（$x=0$）：$n(0) = n_{\\text{sep}}$\n2.  在壁面（$x=w$）：$n(w) = 0$\n\n应用第一个边界条件：\n$$\nn(0) = C_1(0) + C_2 = n_{\\text{sep}} \\quad \\implies \\quad C_2 = n_{\\text{sep}}\n$$\n应用第二个边界条件：\n$$\nn(w) = C_1 w + C_2 = 0 \\quad \\implies \\quad C_1 w + n_{\\text{sep}} = 0 \\quad \\implies \\quad C_1 = -\\frac{n_{\\text{sep}}}{w}\n$$\n因此，随机层中的密度分布为：\n$$\nn(x) = -\\frac{n_{\\text{sep}}}{w} x + n_{\\text{sep}} = n_{\\text{sep}}\\left(1 - \\frac{x}{w}\\right)\n$$\n粒子通量密度 $\\Gamma(x)$ 由菲克第一扩散定律给出：\n$$\n\\Gamma(x) = -D \\frac{dn}{dx}\n$$\n计算密度梯度：\n$$\n\\frac{dn}{dx} = \\frac{d}{dx}\\left[n_{\\text{sep}}\\left(1 - \\frac{x}{w}\\right)\\right] = -\\frac{n_{\\text{sep}}}{w}\n$$\n将此代入通量表达式：\n$$\n\\Gamma(x) = -D \\left(-\\frac{n_{\\text{sep}}}{w}\\right) = \\frac{D n_{\\text{sep}}}{w}\n$$\n通量在整个层中是恒定的，这符合没有内部源或汇的稳态情况。壁面处的向外粒子通量密度 $\\Gamma_w$ 就是这个恒定值：\n$$\n\\Gamma_w = \\frac{D n_{\\text{sep}}}{w}\n$$\n代入第1部分中 $D$ 的表达式：\n$$\n\\Gamma_w = \\frac{v_{\\parallel} L_c \\left(\\frac{\\delta B}{B}\\right)^2 n_{\\text{sep}}}{w}\n$$\n\n**第3部分：数值计算**\n\n现在我们将给定的数值代入 $\\Gamma_w$ 的最终表达式。\n\n首先，计算电子平行速度 $v_{\\parallel}$，取其为电子热速度 $v_{\\text{th},e}$。问题陈述 $v_{\\text{th},e} \\doteq \\sqrt{2 T_{e} e / m_{e}}$，其中 $T_e = 2.0\\,\\text{keV}$ 被解释为能量。以焦耳为单位的能量是 $E = (2.0 \\times 10^3\\,\\text{eV}) \\times e = (2.0 \\times 10^3) \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\text{C}) \\approx 3.204 \\times 10^{-16}\\,\\text{J}$。\n\n使用给定的常数：\n$T_e e = (2.0 \\times 10^3) \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\text{J}) = 3.204\\,353\\,268 \\times 10^{-16}\\,\\text{J}$\n$m_e = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\text{kg}$\n\n$$\nv_{\\parallel} = \\sqrt{\\frac{2 T_e e}{m_e}} = \\sqrt{\\frac{2 \\times (3.204\\,353\\,268 \\times 10^{-16}\\,\\text{J})}{9.109\\,383\\,7015 \\times 10^{-31}\\,\\text{kg}}} \\approx 2.652\\,382\\,9 \\times 10^7\\,\\text{m}\\,\\text{s}^{-1}\n$$\n\n现在，使用其余参数组合 $\\Gamma_w$ 的表达式：\n$L_c = 15\\,\\text{m}$\n$\\delta B/B = 1.0 \\times 10^{-3}$\n$n_{\\text{sep}} = 5.0 \\times 10^{19}\\,\\text{m}^{-3}$\n$w = 0.020\\,\\text{m}$\n\n$$\n\\Gamma_w = \\frac{(2.652\\,382\\,9 \\times 10^7\\,\\text{m}\\,\\text{s}^{-1}) \\times (15\\,\\text{m}) \\times (1.0 \\times 10^{-3})^2 \\times (5.0 \\times 10^{19}\\,\\text{m}^{-3})}{0.020\\,\\text{m}}\n$$\n$$\n\\Gamma_w = \\frac{(2.652\\,382\\,9 \\times 10^7) \\times 15 \\times (1.0 \\times 10^{-6}) \\times (5.0 \\times 10^{19})}{0.020} \\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n$$\n\\Gamma_w \\approx 9.946\\,436 \\times 10^{23}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n按要求将结果四舍五入到三位有效数字：\n$$\n\\Gamma_w \\approx 9.95 \\times 10^{23}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$", "answer": "$$\\boxed{9.95 \\times 10^{23}}$$", "id": "3720053"}]}