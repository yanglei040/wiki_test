{"hands_on_practices": [{"introduction": "本练习提供了一个直接、基础的实践，用于检验环形等离子体中的核心平衡条件 $\\nabla p = \\mathbf{J} \\times \\mathbf{B}$。通过从给定的压力和磁场分布出发，我们将从第一性原理出发计算方程的两边，以确定等离子体是否以及在何处处于力平衡状态。这项实践旨在加深对基本物理原理的理解，并强调并非所有任意的场和压力分布都能构成一个有效的磁流体动力学平衡态。[@problem_id:3723288]", "problem": "考虑一个大环径比托卡马克，它可以近似为一个笔直的、轴对称的、小半径为 $a$ 的圆柱体，采用柱坐标系 $(r,\\theta,z)$，其中 $r \\in [0,a]$。等离子体压强是一个磁通函数，由下式给出\n$$\np(r) = p_{0}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)^{2},\n$$\n其中 $p_{0} > 0$。磁场是轴对称的，并且只有极向和环向分量，\n$$\n\\mathbf{B}(r) = B_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}} + B_{z}(r)\\,\\hat{\\mathbf{z}},\n$$\n其中\n$$\nB_{\\theta}(r) = B_{p0}\\,\\frac{r}{a}\\left(1 - \\frac{r^{2}}{a^{2}}\\right),\\qquad B_{z}(r) = B_{0}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right),\n$$\n其中 $B_{p0} > 0$，$B_{0} > 0$，且 $0 \\le \\varepsilon \\ll 1$ 是一个无量纲参数，描述了在大环径比极限下环向场的弱径向变化。假设理想静态磁流体力学 (MHD) 模型，并采用国际单位制 (SI)，真空磁导率为 $\\mu_{0}$。\n\n仅从洛伦兹力密度 $\\mathbf{f}_{L}=\\mathbf{J}\\times\\mathbf{B}$、压强梯度力密度 $\\mathbf{f}_{p}=\\nabla p$ 和麦克斯韦-安培定律 $\\mu_{0}\\mathbf{J}=\\nabla\\times\\mathbf{B}$ 的基本定义出发（并结合柱坐标系中的标准矢量微积分算子），计算力平衡残差的径向分量\n$$\nf_{\\mathrm{res}}(r) \\equiv \\big(\\nabla p - \\mathbf{J}\\times\\mathbf{B}\\big)\\cdot \\hat{\\mathbf{r}},\n$$\n将其表示为 $r$ 的显式解析函数，并用给定的常数 $p_{0}$、$B_{0}$、$B_{p0}$、$a$、$\\varepsilon$ 和 $\\mu_{0}$ 表示。将 $r$ 视为 $[0,a]$ 上的连续变量，不要进行任何数值代入。\n\n您的任务是从第一性原理推导出 $f_{\\mathrm{res}}(r)$，并以国际单位制将其结果表示为一个闭合形式表达式。您还应该根据 $f_{\\mathrm{res}}(r)$ 的符号和零点，用文字解释平衡条件在哪些 $r$ 区域成立或不成立。最终报告的答案必须是 $f_{\\mathrm{res}}(r)$ 的单一显式表达式；不需要进行数值取整。如果出现角度，单位必须是弧度；然而，本问题中不需要进行角度求值。力密度的单位用 $\\mathrm{N}\\,\\mathrm{m}^{-3}$ 表示。", "solution": "此问题需要经过验证。\n\n### 步骤 1：提取已知条件\n-   几何形状：笔直、轴对称、小半径为 $a$ 的圆柱体。\n-   坐标系：柱坐标 $(r,\\theta,z)$，其中 $r \\in [0,a]$。\n-   等离子体压强：$p(r) = p_{0}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)^{2}$，其中 $p_{0} > 0$。\n-   磁场：$\\mathbf{B}(r) = B_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}} + B_{z}(r)\\,\\hat{\\mathbf{z}}$。\n    -   极向分量：$B_{\\theta}(r) = B_{p0}\\,\\frac{r}{a}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)$，其中 $B_{p0} > 0$。\n    -   环向分量：$B_{z}(r) = B_{0}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right)$，其中 $B_{0} > 0$ 且 $0 \\le \\varepsilon \\ll 1$。\n-   物理模型：理想静态磁流体力学 (MHD)。\n-   基本方程：\n    -   洛伦兹力密度：$\\mathbf{f}_{L}=\\mathbf{J}\\times\\mathbf{B}$。\n    -   压强梯度力密度：$\\mathbf{f}_{p}=\\nabla p$。\n    -   麦克斯韦-安培定律：$\\mu_{0}\\mathbf{J}=\\nabla\\times\\mathbf{B}$。\n-   任务：计算力平衡残差的径向分量 $f_{\\mathrm{res}}(r) \\equiv \\big(\\nabla p - \\mathbf{J}\\times\\mathbf{B}\\big)\\cdot \\hat{\\mathbf{r}}$，作为 $r$ 的显式函数，并给出解释。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是理想磁流体力学理论应用于简化等离子体约束几何（柱形箍缩）的一个标准练习。给定的条件是自洽且一致的，所有必要的函数和参数都已指定。所给定的压强和磁场分布是等离子体物理文献中使用的物理上合理的模型。该任务是基于基本矢量微积分和麦克斯韦方程组的直接、良态的计算。语言客观而精确。此问题有效。\n\n### 步骤 3：结论与行动\n此问题有效。将提供完整解答。\n\n任务是计算力平衡残差的径向分量，定义为 $f_{\\mathrm{res}}(r) = (\\nabla p - \\mathbf{J}\\times\\mathbf{B})\\cdot\\hat{\\mathbf{r}}$。这需要计算压强梯度的径向分量 $(\\nabla p)\\cdot\\hat{\\mathbf{r}}$ 和洛伦兹力的径向分量 $(\\mathbf{J}\\times\\mathbf{B})\\cdot\\hat{\\mathbf{r}}$。我们从给定的基本定义出发，逐项进行计算。\n\n首先，我们计算压强梯度项。压强 $p$ 仅是 $r$ 的函数。在柱坐标系中，梯度算子为 $\\nabla = \\hat{\\mathbf{r}}\\frac{\\partial}{\\partial r} + \\hat{\\boldsymbol{\\theta}}\\frac{1}{r}\\frac{\\partial}{\\partial\\theta} + \\hat{\\mathbf{z}}\\frac{\\partial}{\\partial z}$。因此，压强梯度只有一个径向分量：\n$$\n\\nabla p = \\frac{dp}{dr}\\hat{\\mathbf{r}}.\n$$\n我们计算给定压强分布 $p(r) = p_{0}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)^{2}$ 的导数：\n$$\n\\frac{dp}{dr} = p_{0} \\cdot 2\\left(1 - \\frac{r^{2}}{a^{2}}\\right) \\cdot \\left(-\\frac{2r}{a^{2}}\\right) = -\\frac{4p_{0}r}{a^{2}}\\left(1 - \\frac{r^{2}}{a^{2}}\\right).\n$$\n因此，压强梯度力密度的径向分量是 $(\\nabla p)\\cdot\\hat{\\mathbf{r}} = \\frac{dp}{dr}$。\n\n其次，我们使用麦克斯韦-安培定律 $\\mathbf{J} = \\frac{1}{\\mu_{0}}\\nabla\\times\\mathbf{B}$ 计算电流密度 $\\mathbf{J}$。磁场由 $\\mathbf{B}(r) = B_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}} + B_{z}(r)\\,\\hat{\\mathbf{z}}$ 给出。对于没有径向分量的轴对称场，在柱坐标系中的旋度简化为：\n$$\n\\nabla\\times\\mathbf{B} = \\hat{\\boldsymbol{\\theta}}\\left(-\\frac{\\partial B_{z}}{\\partial r}\\right) + \\hat{\\mathbf{z}}\\frac{1}{r}\\frac{\\partial(rB_{\\theta})}{\\partial r}.\n$$\n这意味着电流密度有极向 ($\\theta$) 和环向 ($z$) 分量：$\\mathbf{J}(r) = J_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}} + J_{z}(r)\\,\\hat{\\mathbf{z}}$。\n极向分量 $J_{\\theta}(r)$ 可由 $B_{z}(r) = B_{0}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right)$ 的导数求得：\n$$\n\\frac{dB_{z}}{dr} = B_{0}\\left(-\\frac{2\\varepsilon r}{a^{2}}\\right) = -\\frac{2\\varepsilon B_{0}r}{a^2}.\n$$\n$$\nJ_{\\theta}(r) = -\\frac{1}{\\mu_{0}}\\frac{dB_{z}}{dr} = \\frac{2\\varepsilon B_{0}r}{\\mu_{0}a^{2}}.\n$$\n环向分量 $J_{z}(r)$ 可由 $rB_{\\theta}(r)$ 的导数求得。已知 $B_{\\theta}(r) = \\frac{B_{p0}}{a}r\\left(1 - \\frac{r^{2}}{a^{2}}\\right) = \\frac{B_{p0}}{a}\\left(r - \\frac{r^{3}}{a^{2}}\\right)$，我们有：\n$$\nrB_{\\theta}(r) = \\frac{B_{p0}}{a}\\left(r^{2} - \\frac{r^{4}}{a^{2}}\\right).\n$$\n$$\n\\frac{d(rB_{\\theta})}{dr} = \\frac{B_{p0}}{a}\\left(2r - \\frac{4r^{3}}{a^{2}}\\right) = \\frac{2B_{p0}r}{a}\\left(1 - \\frac{2r^{2}}{a^{2}}\\right).\n$$\n$$\nJ_{z}(r) = \\frac{1}{\\mu_{0}r}\\frac{d(rB_{\\theta})}{dr} = \\frac{1}{\\mu_{0}r}\\left[\\frac{2B_{p0}r}{a}\\left(1 - \\frac{2r^{2}}{a^{2}}\\right)\\right] = \\frac{2B_{p0}}{\\mu_{0}a}\\left(1 - \\frac{2r^{2}}{a^{2}}\\right).\n$$\n\n第三，我们计算洛伦兹力密度 $\\mathbf{J}\\times\\mathbf{B}$。由于 $\\mathbf{J}$ 和 $\\mathbf{B}$ 都在 $\\theta-z$ 平面内，它们的叉乘将是纯径向的：\n$$\n\\mathbf{J}\\times\\mathbf{B} = (J_{\\theta}\\hat{\\boldsymbol{\\theta}} + J_{z}\\hat{\\mathbf{z}})\\times(B_{\\theta}\\hat{\\boldsymbol{\\theta}} + B_{z}\\hat{\\mathbf{z}}) = J_{\\theta}B_{z}(\\hat{\\boldsymbol{\\theta}}\\times\\hat{\\mathbf{z}}) + J_{z}B_{\\theta}(\\hat{\\mathbf{z}}\\times\\hat{\\boldsymbol{\\theta}}) = (J_{\\theta}B_{z} - J_{z}B_{\\theta})\\hat{\\mathbf{r}}.\n$$\n其径向分量为 $(\\mathbf{J}\\times\\mathbf{B})\\cdot\\hat{\\mathbf{r}} = J_{\\theta}B_{z} - J_{z}B_{\\theta}$。代入磁场和电流分量的表达式：\n$$\nJ_{\\theta}B_{z} = \\left(\\frac{2\\varepsilon B_{0}r}{\\mu_{0}a^{2}}\\right) \\left(B_{0}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right)\\right) = \\frac{2\\varepsilon B_{0}^{2}r}{\\mu_{0}a^{2}}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right).\n$$\n$$\nJ_{z}B_{\\theta} = \\left(\\frac{2B_{p0}}{\\mu_{0}a}\\left(1 - \\frac{2r^{2}}{a^{2}}\\right)\\right) \\left(B_{p0}\\frac{r}{a}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)\\right) = \\frac{2B_{p0}^{2}r}{\\mu_{0}a^{2}}\\left(1 - \\frac{2r^{2}}{a^{2}}\\right)\\left(1 - \\frac{r^{2}}{a^{2}}\\right).\n$$\n$J_{z}B_{\\theta}$ 项中的乘积可以展开为：\n$$\n\\left(1 - \\frac{2r^{2}}{a^{2}}\\right)\\left(1 - \\frac{r^{2}}{a^{2}}\\right) = 1 - \\frac{r^{2}}{a^{2}} - \\frac{2r^{2}}{a^{2}} + \\frac{2r^{4}}{a^{4}} = 1 - 3\\frac{r^{2}}{a^{2}} + 2\\frac{r^{4}}{a^{4}}.\n$$\n所以，径向洛伦兹力为：\n$$\n(\\mathbf{J}\\times\\mathbf{B})\\cdot\\hat{\\mathbf{r}} = \\frac{2\\varepsilon B_{0}^{2}r}{\\mu_{0}a^{2}}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right) - \\frac{2B_{p0}^{2}r}{\\mu_{0}a^{2}}\\left(1 - 3\\frac{r^{2}}{a^{2}} + 2\\frac{r^{4}}{a^{4}}\\right).\n$$\n\n最后，我们组合力平衡残差 $f_{\\mathrm{res}}(r) = \\frac{dp}{dr} - (\\mathbf{J}\\times\\mathbf{B})\\cdot\\hat{\\mathbf{r}}$：\n$$\nf_{\\mathrm{res}}(r) = -\\frac{4p_{0}r}{a^{2}}\\left(1 - \\frac{r^{2}}{a^{2}}\\right) - \\left[ \\frac{2\\varepsilon B_{0}^{2}r}{\\mu_{0}a^{2}}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right) - \\frac{2B_{p0}^{2}r}{\\mu_{0}a^{2}}\\left(1 - 3\\frac{r^{2}}{a^{2}} + 2\\frac{r^{4}}{a^{4}}\\right) \\right].\n$$\n为了得到一个清晰的多项式形式，我们可以提出公因式并按 $r$ 的幂次分组。让我们提出 $\\frac{2r}{\\mu_{0}a^{2}}$：\n$$\nf_{\\mathrm{res}}(r) = \\frac{2r}{\\mu_{0}a^{2}} \\left[ -2\\mu_{0}p_{0}\\left(1 - \\frac{r^{2}}{a^{2}}\\right) - \\varepsilon B_{0}^{2}\\left(1 - \\varepsilon \\frac{r^{2}}{a^{2}}\\right) + B_{p0}^{2}\\left(1 - 3\\frac{r^{2}}{a^{2}} + 2\\frac{r^{4}}{a^{4}}\\right) \\right].\n$$\n在方括号内展开并按 $r^2/a^2$ 的幂次合并同类项：\n$$\nf_{\\mathrm{res}}(r) = \\frac{2r}{\\mu_{0}a^{2}} \\left[ (-2\\mu_{0}p_{0} - \\varepsilon B_{0}^{2} + B_{p0}^{2}) + (2\\mu_{0}p_{0} + \\varepsilon^{2}B_{0}^{2} - 3B_{p0}^{2})\\frac{r^{2}}{a^{2}} + (2B_{p0}^{2})\\frac{r^{4}}{a^{4}} \\right].\n$$\n这可以写成关于 $r$ 的显式多项式：\n$$\nf_{\\mathrm{res}}(r) = \\frac{2}{\\mu_{0}a^2}(B_{p0}^2 - 2\\mu_{0}p_{0} - \\varepsilon B_{0}^2)r + \\frac{2}{\\mu_{0}a^4}(2\\mu_{0}p_{0} - 3B_{p0}^{2} + \\varepsilon^{2}B_{0}^{2})r^3 + \\frac{4B_{p0}^{2}}{\\mu_{0}a^6}r^5.\n$$\n\n解释：量 $f_{\\mathrm{res}}(r)$ 表示在给定分布下，维持等离子体于静态所需的不平衡的净径向力密度。作用在等离子体流元上的物理力是 $\\mathbf{F} = -\\nabla p + \\mathbf{J}\\times\\mathbf{B}$。残差是 $f_{\\mathrm{res}}(r) = -F_r$，其中 $F_r$ 是 $\\mathbf{F}$ 的径向分量。\n-   如果 $f_{\\mathrm{res}}(r) = 0$，则等离子体在该特定半径 $r$ 处处于径向力平衡状态。由压强梯度产生的向外力 $(-\\nabla p)_r$ 与向内的洛伦兹力 $(\\mathbf{J}\\times\\mathbf{B})_r$ 完全平衡。\n-   如果 $f_{\\mathrm{res}}(r)  0$，意味着 $F_r > 0$。作用在等离子体上的净物理力径向向外。这意味着向外的压强梯度力超过了约束洛伦兹力，该半径处的等离子体将趋于膨胀。\n-   如果 $f_{\\mathrm{res}}(r) > 0$，意味着 $F_r  0$。净物理力径向向内。洛伦兹力对等离子体压强的约束过强，该半径处的等离子体将趋于被压缩。\n\n从推导的表达式可知，$f_{\\mathrm{res}}(0) = 0$，这是轴对称性的一个结果；在中心处力必须为零。对于 $r > 0$，平衡条件 $f_{\\mathrm{res}}(r) = 0$ 要求解一个关于 $r^2$ 的二次方程的根。通常情况下，对于任意参数，该方程不会对所有 $r$ 都成立，这意味着所选的分布不代表一个真正的磁流体力学平衡。平衡可能仅在区间 $r \\in (0, a]$ 内的离散半径处存在（如果存在的话）。", "answer": "$$\\boxed{\\frac{2}{\\mu_{0}a^2}(B_{p0}^2 - 2\\mu_{0}p_{0} - \\varepsilon B_{0}^2)r + \\frac{2}{\\mu_{0}a^4}(2\\mu_{0}p_{0} - 3B_{p0}^{2} + \\varepsilon^{2}B_{0}^{2})r^3 + \\frac{4B_{p0}^{2}}{\\mu_{0}a^6}r^5}$$", "id": "3723288"}, {"introduction": "与检验一个给定状态不同，本练习侧重于如何*构建*一个平衡态。我们将使用描述轴对称磁流体动力学平衡的主方程——Grad-Shafranov方程，并探索其一类重要的解析解，即Solov’ev解。这个问题将展示如何为具有椭圆形截面的成形等离子体找到环向磁通函数 $\\psi$ 的解析解，从而将抽象的理论框架与实际的等离子体位形控制联系起来。[@problem_id:3723296]", "problem": "考虑一个静态、轴对称的磁流体力学 (MHD) 平衡，其处于柱坐标系 $(R,\\phi,Z)$ 中，且满足 $\\partial/\\partial\\phi=0$。该平衡满足力平衡方程 $\\nabla p=\\mathbf{j}\\times\\mathbf{B}$，以及方程 $\\nabla\\times\\mathbf{B}=\\mu_{0}\\mathbf{j}$ 和 $\\nabla\\cdot\\mathbf{B}=0$。通过磁场的标准轴对称表示引入极向磁通函数 $\\psi(R,Z)$，并从这些方程中推导控制 $\\psi(R,Z)$ 的标量方程。\n\n假设一个 Solov’ev 类平衡，其中压强和环向场函数的平方是 $\\psi$ 的线性函数，即 $\\mathrm{d}p/\\mathrm{d}\\psi=-A$ 和 $\\mathrm{d}F^{2}/\\mathrm{d}\\psi=-B$，其中 $A>0$ 且 $B$ 为实常数。在一个大环径比托卡马克中，其大半径为 $R_{0}\\gg a$，在等离子体内部采用领头阶近似，即当 $R$ 作为源项中的乘法因子出现时，$R\\simeq R_{0}$。同时，在局域坐标 $x\\equiv R-R_{0}$ 和 $Z$ 中，用其领头阶形式近似微分算子。\n\n施加一个对应于上下对称、拉长截面的成形狄利克雷边界条件：最外闭合磁面是由下式给出的椭圆\n$$\n\\frac{x^{2}}{a^{2}}+\\frac{Z^{2}}{\\kappa^{2}a^{2}}=1,\n$$\n并在此边界上取 $\\psi=0$。确定在上述近似和边界条件下，满足控制方程的等离子体内部磁通函数 $\\psi(R,Z)$ 的解析表达式。请用参数 $\\mu_{0}$、$A$、$B$、$R_{0}$、$a$、$\\kappa$ 以及坐标 $R$ 和 $Z$ 将最终答案表示为单个闭式表达式。无需进行数值计算或四舍五入，最终方框内的表达式不应包含任何物理单位。如果在您的推导或答案中出现任何角变量，请以弧度为单位说明；预计最终表达式中不会出现角变量。", "solution": "我们从磁流体力学 (MHD) 的静磁力平衡方程出发，\n$$\n\\nabla p=\\mathbf{j}\\times\\mathbf{B},\n$$\n以及静磁学的麦克斯韦方程组，\n$$\n\\nabla\\times\\mathbf{B}=\\mu_{0}\\mathbf{j},\\qquad \\nabla\\cdot\\mathbf{B}=0.\n$$\n在柱坐标系 $(R,\\phi,Z)$ 中，当系统具有轴对称性（$\\partial/\\partial\\phi=0$）时，我们通过标准表示法引入极向磁通函数 $\\psi(R,Z)$ 和环向场函数 $F(\\psi)$\n$$\n\\mathbf{B}=\\frac{1}{R}\\nabla\\phi\\times\\nabla\\psi+\\frac{F(\\psi)}{R}\\,\\nabla\\phi,\n$$\n该表示法恒满足 $\\nabla\\cdot\\mathbf{B}=0$。利用 $\\nabla\\times\\mathbf{B}=\\mu_{0}\\mathbf{j}$，可以计算出电流密度，并将力平衡方程投影到垂直于磁面的方向上，从而得到 Grad–Shafranov (GS) 方程。这个众所周知的结果（通过标准矢量微积分恒等式推导）是\n$$\n\\Delta^{*}\\psi=-\\mu_{0}R^{2}\\frac{\\mathrm{d}p}{\\mathrm{d}\\psi}-\\frac{1}{2}\\frac{\\mathrm{d}F^{2}}{\\mathrm{d}\\psi},\n$$\n其中 Grad–Shafranov 算子为\n$$\n\\Delta^{*}\\psi\\equiv R\\frac{\\partial}{\\partial R}\\!\\left(\\frac{1}{R}\\frac{\\partial\\psi}{\\partial R}\\right)+\\frac{\\partial^{2}\\psi}{\\partial Z^{2}}=\\frac{\\partial^{2}\\psi}{\\partial R^{2}}-\\frac{1}{R}\\frac{\\partial\\psi}{\\partial R}+\\frac{\\partial^{2}\\psi}{\\partial Z^{2}}.\n$$\n\n在 Solov’ev 类中，我们取\n$$\n\\frac{\\mathrm{d}p}{\\mathrm{d}\\psi}=-A,\\qquad \\frac{\\mathrm{d}F^{2}}{\\mathrm{d}\\psi}=-B,\n$$\n其中常数 $A>0$ 且 $B$ 为实数。代入 Grad–Shafranov 方程，得到线性非齐次方程\n$$\n\\Delta^{*}\\psi=\\mu_{0}A\\,R^{2}+\\frac{B}{2}.\n$$\n\n现在我们应用所述的大环径比近似。令 $R_{0}\\gg a$ 表示大半径，并引入局域坐标 $x\\equiv R-R_{0}$ 和 $Z$，其中 $|x|,|Z|\\lesssim a\\ll R_{0}$。那么，对于小参数 $a/R_{0}$，取其领头阶，当 $R$ 乘以源项时，近似为 $R\\simeq R_{0}$，因此右侧有 $R^{2}\\simeq R_{0}^{2}$，并将 Grad–Shafranov 算子替换为其领头阶形式\n$$\n\\Delta^{*}\\psi=\\frac{\\partial^{2}\\psi}{\\partial R^{2}}-\\frac{1}{R}\\frac{\\partial\\psi}{\\partial R}+\\frac{\\partial^{2}\\psi}{\\partial Z^{2}}\\simeq \\frac{\\partial^{2}\\psi}{\\partial x^{2}}+\\frac{\\partial^{2}\\psi}{\\partial Z^{2}},\n$$\n其中被忽略的项 $-(1/R)\\,\\partial\\psi/\\partial R$ 比保留的二阶导数项小一个 $a/R_{0}$ 的量级。在这些近似下，等离子体内部的控制方程简化为 $(x,Z)$ 平面上的一个常数源泊松方程：\n$$\n\\frac{\\partial^{2}\\psi}{\\partial x^{2}}+\\frac{\\partial^{2}\\psi}{\\partial Z^{2}}=S,\\qquad S\\equiv \\mu_{0}A\\,R_{0}^{2}+\\frac{B}{2}.\n$$\n\n我们在椭圆\n$$\n\\frac{x^{2}}{a^{2}}+\\frac{Z^{2}}{\\kappa^{2}a^{2}}=1,\n$$\n上施加成形的狄利克雷边界条件 $\\psi=0$，该椭圆描述了一个小半径为 $a$、伸长率为 $\\kappa$ 的上下对称的拉长截面。由于源是常数，一个二次的试探解可以满足泊松方程和边界条件：\n$$\n\\psi(x,Z)=C\\left(1-\\frac{x^{2}}{a^{2}}-\\frac{Z^{2}}{\\kappa^{2}a^{2}}\\right),\n$$\n其中 $C$ 是待定的常数振幅。该试探解在指定的椭圆上为零，并在其内部是光滑的。\n\n计算其拉普拉斯算子：\n$$\n\\frac{\\partial^{2}\\psi}{\\partial x^{2}}=\\frac{\\partial^{2}}{\\partial x^{2}}\\left[C\\left(1-\\frac{x^{2}}{a^{2}}-\\frac{Z^{2}}{\\kappa^{2}a^{2}}\\right)\\right]=-\\,\\frac{2C}{a^{2}},\n$$\n$$\n\\frac{\\partial^{2}\\psi}{\\partial Z^{2}}=\\frac{\\partial^{2}}{\\partial Z^{2}}\\left[C\\left(1-\\frac{x^{2}}{a^{2}}-\\frac{Z^{2}}{\\kappa^{2}a^{2}}\\right)\\right]=-\\,\\frac{2C}{\\kappa^{2}a^{2}}.\n$$\n因此，\n$$\n\\frac{\\partial^{2}\\psi}{\\partial x^{2}}+\\frac{\\partial^{2}\\psi}{\\partial Z^{2}}=-\\,\\frac{2C}{a^{2}}\\left(1+\\frac{1}{\\kappa^{2}}\\right).\n$$\n将此结果与常数源 $S$ 相等，可得\n$$\n-\\,\\frac{2C}{a^{2}}\\left(1+\\frac{1}{\\kappa^{2}}\\right)=S\\quad\\Rightarrow\\quad C=-\\,\\frac{S\\,a^{2}}{2\\left(1+\\frac{1}{\\kappa^{2}}\\right)}.\n$$\n\n代入 $S=\\mu_{0}A\\,R_{0}^{2}+B/2$ 和 $x=R-R_{0}$，得到所需的闭式磁通函数：\n$$\n\\psi(R,Z)=-\\,\\frac{\\left(\\mu_{0}A\\,R_{0}^{2}+\\frac{B}{2}\\right)a^{2}}{2\\left(1+\\frac{1}{\\kappa^{2}}\\right)}\\left(1-\\frac{(R-R_{0})^{2}}{a^{2}}-\\frac{Z^{2}}{\\kappa^{2}a^{2}}\\right).\n$$\n\n这个表达式明确地展示了成形的边界是如何通过几何参数 $a$ 和 $\\kappa$ 进入解中的。在大环径比近似的领头阶下，它求解了在拉长截面上具有指定狄利克雷边界条件的、由 Solov’ev 项驱动的 Grad–Shafranov 方程。最终表达式中没有出现角变量，因此不需要指定角度单位。", "answer": "$$\\boxed{-\\,\\frac{\\left(\\mu_{0}A\\,R_{0}^{2}+\\frac{B}{2}\\right)a^{2}}{2\\left(1+\\frac{1}{\\kappa^{2}}\\right)}\\left(1-\\frac{(R-R_{0})^{2}}{a^{2}}-\\frac{Z^{2}}{\\kappa^{2}a^{2}}\\right)}$$", "id": "3723296"}, {"introduction": "最后的这项实践将我们从解析方法带入现代计算技术的前沿，这对于现实的聚变研究至关重要。我们将处理一个更复杂的物理情景——各向异性等离子体，其平行和垂直于磁力线的压强不尽相同。您的任务是数值求解一个广义的平衡方程，并利用其解来评估关键的微观不稳定性判据（火龙管不稳定性与磁镜不稳定性），从而在宏观平衡与动理学稳定性之间建立桥梁。[@problem_id:3723284]", "problem": "你需要编写一个完整的、可运行的程序，该程序从静态磁流体动力学力平衡和麦克斯韦方程组出发，构建一个轴对称环向平衡，并为具有各向异性压力的等离子体评估软管和磁镜稳定性约束。计算必须在一个代表大环径比、圆形截面托卡马克的矩形域上，用极向磁通函数 $\\psi(R,Z)$ 来表述。假设系统具有轴对称性（即不依赖于环向角）。\n\n使用的基本原理：\n- 在没有位移电流的情况下的静磁麦克斯韦方程组：$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{j}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$，其中 $\\mathbf{B}$ 是磁场，$\\mathbf{j}$ 是电流密度，$\\mu_0$ 是自由空间的磁导率。\n- 静态动量平衡：$\\nabla \\cdot \\mathbf{P} + \\mathbf{j} \\times \\mathbf{B} = \\mathbf{0}$，其中各向异性压力张量为 $\\mathbf{P} = p_{\\perp}(\\psi)\\,\\mathbf{I} + \\left(p_{\\parallel}(\\psi) - p_{\\perp}(\\psi)\\right)\\,\\mathbf{b}\\mathbf{b}$，$\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$ 是沿磁场的单位矢量。\n- 在柱坐标 $(R,\\phi,Z)$ 中的轴对称场表示：磁场可以分解为极向磁通函数 $\\psi(R,Z)$ 和环向场函数 $F(\\psi)$，即 $\\mathbf{B} = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} + \\frac{F(\\psi)}{R}\\hat{\\boldsymbol{\\phi}}$，因此有 $B_R = -\\frac{1}{R}\\frac{\\partial \\psi}{\\partial Z}$，$B_Z = \\frac{1}{R}\\frac{\\partial \\psi}{\\partial R}$ 和 $B_\\phi = \\frac{F(\\psi)}{R}$。\n\n你的程序必须：\n1. 从给定的基本原理出发，推导出一个适用于大环径比、圆形截面托卡马克的极向磁通 $\\psi(R,Z)$ 的可计算控制方程，并在矩形域 $\\{(R,Z): R \\in [R_0 - a, R_0 + a], Z \\in [-a, a]\\}$ 上实现一个一致的有限差分格式，边界条件为狄利克雷边界条件 $\\psi = 0$。你必须使用适用于此几何中 $\\psi(R,Z)$ 的轴对称环向算子。由于 $F(\\psi)$ 以及压力 $p_{\\parallel}(\\psi)$ 和 $p_{\\perp}(\\psi)$ 对 $\\psi$ 的依赖性，该问题本质上是非线性的，但你可以在一个明确陈述且合理的近似范围内，采用一种科学上一致的线性化策略作为你推导的一部分。\n\n2. 计算出 $\\psi(R,Z)$ 后，通过结合由 $\\psi$ 得到的极向场和由 $F(\\psi)$ 得到的环向场，计算内部网格上总磁场的大小 $|\\mathbf{B}|$。具体来说，使用 $B_R = -\\frac{1}{R}\\frac{\\partial \\psi}{\\partial Z}$，$B_Z = \\frac{1}{R}\\frac{\\partial \\psi}{\\partial R}$ 和 $B_\\phi = \\frac{F(\\psi)}{R}$ 来计算 $|\\mathbf{B}|^2 = B_R^2 + B_Z^2 + B_\\phi^2$。\n\n3. 使用各向异性压力 $p_{\\parallel}(\\psi)$ 和 $p_{\\perp}(\\psi)$，在每个内部网格点上评估局域软管和磁镜稳定性约束：\n   - 软管不稳定性要求一个关联 $p_{\\parallel}(\\psi)$、$p_{\\perp}(\\psi)$ 和 $|\\mathbf{B}|$ 的界限，以防止出现负的磁力线张力。你需要建立并评估这个最小张力不等式。\n   - 磁镜不稳定性要求一个关联比率 $p_{\\perp}(\\psi)/p_{\\parallel}(\\psi)$ 和一个基于 $|\\mathbf{B}|$ 的合适等离子体贝塔值的界限，以防止局域磁阱的形成。你需要建立并评估这个局域不等式。\n\n4. 对于每个测试案例，确定平衡是否在整个内部区域内同时满足软管稳定性和磁镜稳定性。如果所有内部网格点都满足这两个约束，则该测试案例被认为是“稳定的”；否则是“不稳定的”。\n\n科学和数值规范：\n- 使用国际单位制（SI）。磁场 $|\\mathbf{B}|$ 必须以特斯拉为单位，压力 $p$ 必须以帕斯卡为单位，长度（如 $R_0$ 和 $a$）必须以米为单位，且 $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$。\n- 域参数：使用一个覆盖集合 $\\{(R,Z): R \\in [R_0 - a, R_0 + a], Z \\in [-a, a]\\}$ 的矩形网格，其中 $R_0$ 是大半径，$a$ 是小半径。角度不直接使用，无需单位规范。\n- 磁通边界：在计算域的边界上施加 $\\psi = 0$。\n- 环向场规范：将 $F(\\psi)$ 指定为一个仅依赖于 $\\psi$ 且由单个无量纲形状参数表征的光滑函数。你必须确保 $B_\\phi$ 在整个域内具有现实的托卡马克量级（约为几个特斯拉）。\n- 压力剖面：将 $p_{\\parallel}(\\psi)$ 和 $p_{\\perp}(\\psi)$ 指定为仅是 $\\psi$ 的函数，每个都由一个共同的基线磁通剖面 $p_{\\mathrm{base}}(\\psi)$ 和一个恒定的各向异性偏移构成，并通过保持压力在整个域内为非负来确保物理真实性。\n\n测试套件：\n你必须实现一组固定的三个测试案例，参数如下；所有在你推导中出现的其他未指定量必须被一致地定义并在所有案例中重复使用：\n\n- 案例 A（标称稳定区）：\n  - $R_0 = 3.0\\ \\mathrm{m}$，$a = 0.8\\ \\mathrm{m}$。\n  - $B_0 = 5.0\\ \\mathrm{T}$。\n  - 参考磁通标度：$\\psi_{\\mathrm{ref}} = B_0 a^2$（单位：韦伯）。\n  - 环向场函数参数：$F(\\psi) = R_0 B_0 \\left(1 - f_1 \\frac{\\psi}{\\psi_{\\mathrm{ref}}}\\right)$，其中 $f_1 = 0.01$。\n  - 基线压力剖面：$p_{\\mathrm{base}}(\\psi) = p_0 \\left(1 - \\alpha \\frac{\\psi}{\\psi_{\\mathrm{ref}}}\\right)$，其中 $p_0 = 5.0 \\times 10^5\\ \\mathrm{Pa}$ 且 $\\alpha = 0.2$。\n  - 各向异性：$p_{\\parallel}(\\psi) = p_{\\mathrm{base}}(\\psi) + \\delta$，$p_{\\perp}(\\psi) = p_{\\mathrm{base}}(\\psi) - \\delta$，其中 $\\delta = 1.0 \\times 10^5\\ \\mathrm{Pa}$。\n\n- 案例 B（旨在在核心区附近违反软管不稳定性条件，同时保持压力非负）：\n  - $R_0 = 3.0\\ \\mathrm{m}$，$a = 0.8\\ \\mathrm{m}$。\n  - $B_0 = 5.0\\ \\mathrm{T}$。\n  - $\\psi_{\\mathrm{ref}} = B_0 a^2$。\n  - $f_1 = 0.01$。\n  - $p_{\\mathrm{base}}(\\psi) = p_0 \\left(1 - \\alpha \\frac{\\psi}{\\psi_{\\mathrm{ref}}}\\right)$，其中 $p_0 = 3.0 \\times 10^7\\ \\mathrm{Pa}$ 且 $\\alpha = 0.05$。\n  - 各向异性：$p_{\\parallel}(\\psi) = p_{\\mathrm{base}}(\\psi) + \\delta$，$p_{\\perp}(\\psi) = p_{\\mathrm{base}}(\\psi) - \\delta$，其中 $\\delta = 1.2 \\times 10^7\\ \\mathrm{Pa}$。\n\n- 案例 C（旨在在核心区附近违反磁镜不稳定性条件）：\n  - $R_0 = 3.0\\ \\mathrm{m}$，$a = 0.8\\ \\mathrm{m}$。\n  - $B_0 = 5.0\\ \\mathrm{T}$。\n  - $\\psi_{\\mathrm{ref}} = B_0 a^2$。\n  - $f_1 = 0.01$。\n  - $p_{\\mathrm{base}}(\\psi) = p_0 \\left(1 - \\alpha \\frac{\\psi}{\\psi_{\\mathrm{ref}}}\\right)$，其中 $p_0 = 4.5 \\times 10^7\\ \\mathrm{Pa}$ 且 $\\alpha = 0.05$。\n  - 各向异性：$p_{\\parallel}(\\psi) = p_{\\mathrm{base}}(\\psi) + \\delta$，$p_{\\perp}(\\psi) = p_{\\mathrm{base}}(\\psi) - \\delta$，其中 $\\delta = -5.0 \\times 10^6\\ \\mathrm{Pa}$。\n\n算法要求：\n- 在至少有 $32 \\times 32$ 个内部点的均匀网格上离散化控制方程 $\\psi$，强制执行狄利克雷边界 $\\psi=0$，并使用数值稳定的方法求解得到的线性系统。\n- 计算 $|\\mathbf{B}|$ 并在所有内部点上评估软管和磁镜约束。\n- 对于每个案例，输出一个布尔值，说明平衡在整个域内是否处处稳定（true）或不稳定（false）。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 [案例 A, 案例 B, 案例 C]，例如，“[True,False,True]”。输出为布尔值（无单位）。", "solution": "用户要求构建一个具有各向异性压力的轴对称环向磁流体动力学（MHD）平衡，并进行稳定性分析。这需要为极向磁通函数 $\\psi(R,Z)$ 推导一个控制偏微分方程（PDE），对其进行数值求解，然后评估稳定性判据。\n\n### 第1部分：控制平衡方程的推导\n\n出发点是具有各向异性压力张量 $\\mathbf{P}$ 的等离子体的静态动量平衡方程：\n$$ \\mathbf{j} \\times \\mathbf{B} = \\nabla \\cdot \\mathbf{P} \\quad (*)$$\n其中 $\\mathbf{j}$ 是电流密度，$\\mathbf{B}$ 是磁场，压力张量由 $\\mathbf{P} = p_{\\perp} \\mathbf{I} + (p_{\\parallel} - p_{\\perp})\\mathbf{b}\\mathbf{b}$ 给出，$\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$ 是沿磁场的单位矢量。压力 $p_{\\parallel}(\\psi)$ 和 $p_{\\perp}(\\psi)$ 是极向磁通 $\\psi$ 的函数。\n\n在轴对称系统中，磁场可以用柱坐标 $(R, \\phi, Z)$ 表示为：\n$$ \\mathbf{B} = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} + \\frac{F(\\psi)}{R}\\hat{\\boldsymbol{\\phi}} $$\n其中 $\\mathbf{B}_p = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}}$ 是极向场，$B_\\phi = \\frac{F(\\psi)}{R}$ 是环向场。根据安培定律 $\\mu_0 \\mathbf{j} = \\nabla \\times \\mathbf{B}$，可以推导出电流密度的极向和环向分量：\n$$ \\mathbf{j}_p = \\frac{F'(\\psi)}{\\mu_0}\\mathbf{B}_p \\quad \\text{和} \\quad j_\\phi = -\\frac{1}{\\mu_0 R} \\Delta^* \\psi $$\n其中 $F'(\\psi) = dF/d\\psi$，$\\Delta^*$ 是 Grad-Shafranov 算子：\n$$ \\Delta^* \\psi \\equiv R^2 \\nabla \\cdot \\left(\\frac{1}{R^2}\\nabla\\psi\\right) = R\\frac{\\partial}{\\partial R}\\left(\\frac{1}{R}\\frac{\\partial\\psi}{\\partial R}\\right) + \\frac{\\partial^2\\psi}{\\partial Z^2} $$\n将这些代入方程 $(*)$ 的左侧得到：\n$$ \\mathbf{j} \\times \\mathbf{B} = (j_\\phi \\hat{\\boldsymbol{\\phi}} + \\mathbf{j}_p) \\times (B_\\phi \\hat{\\boldsymbol{\\phi}} + \\mathbf{B}_p) = j_\\phi (\\hat{\\boldsymbol{\\phi}} \\times \\mathbf{B}_p) + B_\\phi (\\mathbf{j}_p \\times \\hat{\\boldsymbol{\\phi}}) = -\\frac{\\Delta^*\\psi + F F'}{\\mu_0 R^2}\\nabla\\psi $$\n方程 $(*)$ 的右侧可以展开为：\n$$ \\nabla \\cdot \\mathbf{P} = \\nabla p_{\\perp} + (p_{\\parallel} - p_{\\perp}) (\\mathbf{b}\\cdot\\nabla)\\mathbf{b} + \\mathbf{b}(\\mathbf{b}\\cdot\\nabla(p_{\\parallel}-p_{\\perp})) $$\n由于 $p_{\\parallel}$ 和 $p_{\\perp}$ 仅依赖于 $\\psi$，且 $\\mathbf{B} \\cdot \\nabla\\psi = 0$，最后一项为零。矢量 $(\\mathbf{b}\\cdot\\nabla)\\mathbf{b} = \\boldsymbol{\\kappa}$ 是磁力线曲率。令等式两边相等得到：\n$$ -\\frac{\\Delta^*\\psi + F F'}{\\mu_0 R^2}\\nabla\\psi = p'_{\\perp} \\nabla\\psi + (p_{\\parallel} - p_{\\perp})\\boldsymbol{\\kappa} $$\n将此方程沿 $\\nabla\\psi$ 方向投影，得到广义 Grad-Shafranov 方程：\n$$ \\Delta^*\\psi + F F' = -\\mu_0 R^2 p'_{\\perp} - \\mu_0 (p_{\\parallel} - p_{\\perp}) \\frac{R^2 \\boldsymbol{\\kappa}\\cdot\\nabla\\psi}{|\\nabla\\psi|^2} \\quad (**) $$\n这个方程是高度非线性的，难以直接求解。问题指定了一个“大环径比、圆形截面”的托卡马克，这提示我们可以用反环径比 $\\epsilon = a/R_0 \\ll 1$ 进行展开。各向同性压力梯度项 $\\nabla p_{\\perp} \\sim p_{\\perp}/a$，而涉及曲率的各向异性项为 $(p_{\\parallel}-p_{\\perp})\\boldsymbol{\\kappa} \\sim (p_{\\parallel}-p_{\\perp})/R_0$。各向异性项与各向同性项之比为 $\\epsilon$ 量级。因此，作为一种“科学上一致的线性化策略”，我们只保留 $\\epsilon$ 展开中的最低阶项，这相当于忽略各向异性力项。\n\n这一简化得到了标准（各向同性）的 Grad-Shafranov 方程：\n$$ \\Delta^*\\psi = -\\mu_0 R^2 p'(\\psi) - F(\\psi)F'(\\psi) $$\n我们将 $p'(\\psi)$ 等同于给定的 $p'_{\\perp}(\\psi)$，因为在问题设定中它们是相同的。\n\n对于大环径比托卡马克，我们可以通过设置 $R \\approx R_0$ 和算子 $\\Delta^* \\approx \\nabla^2 = \\frac{\\partial^2}{\\partial R^2} + \\frac{\\partial^2}{\\partial Z^2}$ 来进一步近似几何因子。方程变为：\n$$ \\nabla^2\\psi \\approx -\\mu_0 R_0^2 p'(\\psi) - F(\\psi)F'(\\psi) $$\n问题提供了关于 $\\psi$ 的线性函数：\n- $p'(\\psi) = p'_{\\perp} = -p_0 \\alpha / \\psi_{\\mathrm{ref}}$（一个常数）。\n- $F(\\psi) = F_0 - F_1 \\psi$，其中 $F_0 = R_0 B_0$，$F_1 = R_0 B_0 f_1 / \\psi_{\\mathrm{ref}}$。\n- $F(\\psi)F'(\\psi) = (F_0 - F_1\\psi)(-F_1) = -F_0 F_1 + F_1^2 \\psi$。\n\n将这些代入近似方程，得到一个亥姆霍兹类型的线性偏微分方程：\n$$ \\nabla^2\\psi = -\\mu_0 R_0^2 p' - (-F_0 F_1 + F_1^2 \\psi) $$\n$$ \\nabla^2\\psi - F_1^2 \\psi = -\\mu_0 R_0^2 p' + F_0 F_1 $$\n令 $k^2 = F_1^2$ 和 $S = F_0 F_1 - \\mu_0 R_0^2 p'$，我们得到最终需要求解的控制方程：\n$$ \\nabla^2\\psi - k^2 \\psi = S $$\n该方程受限于矩形域边界上的狄利克雷边界条件 $\\psi = 0$。\n\n### 第2部分：数值解\n\n我们在具有间距 $\\Delta R$ 和 $\\Delta Z$ 的均匀笛卡尔网格 $(R_i, Z_j)$ 上离散化亥姆霍兹方程。对于内部点 $(i, j)$，拉普拉斯算子使用标准的五点有限差分模板进行近似：\n$$ \\frac{\\psi_{i+1,j}-2\\psi_{i,j}+\\psi_{i-1,j}}{(\\Delta R)^2} + \\frac{\\psi_{i,j+1}-2\\psi_{i,j}+\\psi_{i,j-1}}{(\\Delta Z)^2} - k^2 \\psi_{i,j} = S $$\n该方程被重组为一个大型稀疏线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x}$ 是一个包含所有内部网格点上 $\\psi$ 未知值的向量。矩阵 $A$ 和向量 $\\mathbf{b}$ 基于差分模板和边界条件构建。使用稀疏线性代数求解器求解该系统，以找到 $\\psi(R,Z)$。\n\n### 第3部分：稳定性分析\n\n在获得平衡解 $\\psi(R,Z)$ 后，我们计算磁场 $\\mathbf{B}$，并在每个内部网格点上评估软管和磁镜稳定性判据。\n\n1.  **磁场计算**：$\\mathbf{B}$ 的分量是使用中心差分计算 $\\psi$ 的导数得到的：\n    - $B_R(R,Z) = -\\frac{1}{R}\\frac{\\partial \\psi}{\\partial Z}$\n    - $B_Z(R,Z) = \\frac{1}{R}\\frac{\\partial \\psi}{\\partial R}$\n    - $B_\\phi(R,Z) = \\frac{F(\\psi)}{R}$\n    磁场强度为 $|\\mathbf{B}| = \\sqrt{B_R^2+B_Z^2+B_\\phi^2}$。\n\n2.  **软管不稳定性**：这种不稳定性由过大的平行压力驱动，它可能克服磁力线的张力。稳定性条件是有效张力必须为正：\n    $$ \\frac{|\\mathbf{B}|^2}{\\mu_0} + p_{\\perp}(\\psi) - p_{\\parallel}(\\psi) > 0 $$\n    给定 $p_{\\parallel}(\\psi) - p_{\\perp}(\\psi) = 2\\delta$，该条件简化为 $\\frac{|\\mathbf{B}|^2}{\\mu_0} > 2\\delta$。\n\n3.  **磁镜不稳定性**：这种不稳定性由磁场曲率有利区域内的过大垂直压力驱动，导致粒子被捕获并聚集在一起。使用的稳定性条件是：\n    $$ p_{\\perp}(\\psi) \\left( \\frac{p_{\\perp}(\\psi)}{p_{\\parallel}(\\psi)} - 1 \\right) \\le \\frac{|\\mathbf{B}|^2}{2\\mu_0} $$\n只有当区域内部的每个点都满足这两个条件时，平衡才被视为“稳定的”。如果有任何一个判据在任何一个点上被违反，则该平衡是“不稳定的”。", "answer": "```python\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    \n    # Grid resolution\n    N_grid = 48  # Use a reasonably fine grid (e.g., 48x48 total points)\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case A: Nominal stable regime\n        {'R0': 3.0, 'a': 0.8, 'B0': 5.0, 'f1': 0.01, 'p0': 5.0e5, 'alpha': 0.2, 'delta': 1.0e5},\n        # Case B: Intended firehose violation\n        {'R0': 3.0, 'a': 0.8, 'B0': 5.0, 'f1': 0.01, 'p0': 3.0e7, 'alpha': 0.05, 'delta': 1.2e7},\n        # Case C: Intended mirror violation\n        {'R0': 3.0, 'a': 0.8, 'B0': 5.0, 'f1': 0.01, 'p0': 4.5e7, 'alpha': 0.05, 'delta': -5.0e6},\n    ]\n\n    results = []\n    for case in test_cases:\n        is_stable = solve_equilibrium_and_check_stability(\n            case['R0'], case['a'], case['B0'], case['f1'],\n            case['p0'], case['alpha'], case['delta'], N_grid\n        )\n        results.append(is_stable)\n    \n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_equilibrium_and_check_stability(R0, a, B0, f1, p0, alpha, delta, N):\n    \"\"\"\n    Solves for the MHD equilibrium and checks firehose/mirror stability for one test case.\n    \n    Args:\n        R0 (float): Major radius [m]\n        a (float): Minor radius [m]\n        B0 (float): Reference toroidal field [T]\n        f1 (float): Dimensionless parameter for F(psi)\n        p0 (float): Reference pressure [Pa]\n        alpha (float): Dimensionless parameter for p_base(psi)\n        delta (float): Anisotropy pressure offset [Pa]\n        N (int): Number of grid points in each dimension (R and Z)\n    \n    Returns:\n        bool: True if stable everywhere, False otherwise.\n    \"\"\"\n    mu0 = 4 * np.pi * 1e-7\n\n    # 1. Setup Domain and Constants for the Helmholtz Equation\n    NR, NZ = N, N\n    R_vec = np.linspace(R0 - a, R0 + a, NR)\n    Z_vec = np.linspace(-a, a, NZ)\n    delta_R = R_vec[1] - R_vec[0]\n    delta_Z = Z_vec[1] - Z_vec[0]\n\n    psi_ref = B0 * a**2\n    p_prime = -p0 * alpha / psi_ref\n    \n    F0 = R0 * B0\n    F1 = R0 * B0 * f1 / psi_ref\n    \n    k_sq = F1**2\n    S = F0 * F1 - mu0 * R0**2 * p_prime\n\n    # 2. Construct and Solve the Linear System (A*psi = b)\n    num_interior_pts = (NR - 2) * (NZ - 2)\n    A = sparse.lil_matrix((num_interior_pts, num_interior_pts))\n    b = np.full(num_interior_pts, S)\n\n    def to_k(i, j):\n        # Map 2D grid index (i,j) to 1D vector index k\n        return (i - 1) * (NZ - 2) + (j - 1)\n\n    for i in range(1, NR - 1):  # Iterate over interior R points\n        for j in range(1, NZ - 1):  # Iterate over interior Z points\n            k = to_k(i, j)\n            # Helmholtz operator stencil\n            # Note: The problem derivation leads to ∇²ψ - k²ψ = S, so k² term is negative on the LHS.\n            A[k, k] = -k_sq - 2 / delta_R**2 - 2 / delta_Z**2\n            # Neighbors\n            if i > 1: A[k, to_k(i - 1, j)] = 1 / delta_R**2\n            if i  NR - 2: A[k, to_k(i + 1, j)] = 1 / delta_R**2\n            if j > 1: A[k, to_k(i, j - 1)] = 1 / delta_Z**2\n            if j  NZ - 2: A[k, to_k(i, j + 1)] = 1 / delta_Z**2\n    \n    psi_vec = spsolve(A.tocsr(), b)\n    psi_grid = np.zeros((NR, NZ))\n    # Reshape solution vector back into the 2D grid\n    psi_grid[1:-1, 1:-1] = psi_vec.reshape((NR - 2, NZ - 2))\n\n    # 3. Post-Process: Calculate B-field and check stability\n    \n    # Calculate derivatives of psi using central differences\n    psi_R = np.zeros_like(psi_grid)\n    psi_Z = np.zeros_like(psi_grid)\n    \n    psi_R[1:-1, :] = (psi_grid[2:, :] - psi_grid[:-2, :]) / (2 * delta_R)\n    psi_Z[:, 1:-1] = (psi_grid[:, 2:] - psi_grid[:, :-2]) / (2 * delta_Z)\n\n    # Iterate over all interior points to check stability\n    for i in range(1, NR - 1):\n        for j in range(1, NZ - 1):\n            R = R_vec[i]\n            psi = psi_grid[i, j]\n            \n            # B-field components\n            B_R_val = -1 / R * psi_Z[i, j]\n            B_Z_val = 1 / R * psi_R[i, j]\n            F_psi = F0 - F1 * psi\n            B_phi_val = F_psi / R\n            B_sq = B_R_val**2 + B_Z_val**2 + B_phi_val**2\n\n            # Anisotropic pressures\n            p_base = p0 * (1 - alpha * psi / psi_ref)\n            p_parallel = p_base + delta\n            p_perp = p_base - delta\n\n            # Ensure pressures are non-negative, if not, it's non-physical/unstable\n            if p_parallel  0 or p_perp  0:\n                return False\n\n            # Check Firehose Stability: B^2/mu0 + p_perp - p_parallel > 0\n            if (B_sq / mu0 + (p_perp - p_parallel)) = 0:\n                return False  # Firehose unstable\n\n            # Check Mirror Stability: p_perp * (p_perp/p_parallel - 1) = B^2 / (2*mu0)\n            if p_parallel = 1e-9: # Avoid division by zero, treat as unstable\n                 return False\n            if p_perp * (p_perp / p_parallel - 1) > B_sq / (2 * mu0):\n                return False  # Mirror unstable\n\n    # If all points are stable\n    return True\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3723284"}]}