{"hands_on_practices": [{"introduction": "安全因子 $q$ 是决定托卡马克等离子体稳定性的核心参数。这个练习将引导你通过在一个简化的、轴对称的托卡马克模型中，直接沿磁力线计算线积分，从第一性原理出发来计算 $q$ 值[@problem_id:3723432]。这项实践将加深你对安全因子物理定义的理解，并锻炼你在环形几何中进行积分计算的关键技能。", "problem": "考虑一个具有圆形同心磁通量面的大环径比轴对称托卡马克。设小半径为 $r$ 的磁通量面在柱坐标系 $(R,\\phi,Z)$ 中由角向角 $\\theta$ 和环向角 $\\phi$ 参数化为\n$$R(\\theta) = R_{0} + r\\cos\\theta,\\quad Z(\\theta) = r\\sin\\theta,$$\n其中角度以弧度为单位。磁场 $\\mathbf{B}(R,Z)$ 由环向场线圈产生的环向分量和由给定的角向磁通函数生成的角向分量组成。具体而言：\n- 环向分量与一组圆形环向场线圈一致，由下式给出\n$$\\mathbf{B}_{\\phi}(R) = \\frac{B_{0} R_{0}}{R}\\,\\mathbf{e}_{\\phi},$$\n其中 $\\mathbf{e}_{\\phi}$ 是环向单位矢量，$B_{0}$ 是磁轴 $R=R_{0}$ 处的环向磁场。\n- 角向分量通过轴对称角向磁通函数 $\\psi(r)$ 定义为\n$$\\mathbf{B}_{\\text{pol}} = \\frac{1}{R}\\,\\nabla\\psi(r)\\times \\mathbf{e}_{\\phi}。$$\n\n使用安全因子 $q(\\psi)$ 的基本定义，即磁力线每绕角向一圈所走的环向圈数。要计算给定磁通量面上的 $q(\\psi)$，需沿该磁通量面上的磁力线计算角向和环向的线积分。然后，验证您的结果与 $\\mathbf{B}_{\\phi}(R)$ 中编码的环向场线圈几何形状的一致性。\n\n计算数据：\n- 大半径 $R_{0} = 2.8\\ \\mathrm{m}$。\n- 磁通量面小半径 $r = 0.40\\ \\mathrm{m}$。\n- 等离子体小半径 $a = 0.60\\ \\mathrm{m}$。\n- 轴上环向场 $B_{0} = 4.5\\ \\mathrm{T}$。\n- 角向磁通函数 $\\psi(r) = \\psi_{0}\\,(r/a)^{2}$，其中 $\\psi_{0} = 0.50\\ \\mathrm{Wb}$，理解为每弧度的角向磁通量。\n\n通过显式执行沿磁通量面 $r = 0.40\\ \\mathrm{m}$ 上磁力线的必要角向和环向线积分，计算该磁通量面上的安全因子 $q(\\psi)$。在您的推导中，确认环向场线圈的几何形状意味着 $R B_{\\phi}$ 在该磁通量面上是常数。将您的最终答案表示为一个无量纲数。将您的答案四舍五入到四位有效数字。", "solution": "安全因子 $q$ 的计算可以通过沿磁力线积分得到。以下是详细的推导步骤：\n\n1.  **安全因子 $q$ 的定义**\n    安全因子 $q$ 的积分定义为：\n    $$ q = \\frac{1}{2\\pi} \\oint \\frac{d\\phi}{d\\theta} d\\theta $$\n    其中 $\\frac{d\\phi}{d\\theta}$ 表示在磁面上磁力线的斜率。\n\n2.  **磁力线方程**\n    磁力线由方程 $d\\mathbf{l} / ds = \\mathbf{B}$ 描述。在环形几何中，这意味着沿磁力线的极向和环向位移之比等于磁场分量之比：\n    $$ \\frac{dl_\\phi}{dl_p} = \\frac{B_\\phi}{B_p} $$\n    其中 $dl_p = r d\\theta$ 是极向弧长微元，$dl_\\phi = R d\\phi$ 是环向弧长微元，$B_p$ 和 $B_\\phi$ 分别是极向和环向磁场的大小。\n    代入后可得：\n    $$ \\frac{R d\\phi}{r d\\theta} = \\frac{B_\\phi}{B_p} \\implies \\frac{d\\phi}{d\\theta} = \\frac{r B_\\phi}{R B_p} $$\n\n3.  **计算磁场分量**\n    *   环向磁场 $B_\\phi$ 直接由题目给出：$B_\\phi = \\frac{B_0 R_0}{R}$。\n    *   极向磁场 $B_p$ 是极向磁场矢量的大小，$|\\mathbf{B}_{\\text{pol}}| = B_p$。根据定义 $\\mathbf{B}_{\\text{pol}} = \\frac{1}{R}\\nabla\\psi \\times \\mathbf{e}_\\phi$，其大小为 $B_p = \\frac{|\\nabla\\psi|}{R}$。\n    *   对于仅依赖于 $r$ 的磁通函数 $\\psi(r) = \\psi_0(r/a)^2$，其梯度大小为 $|\\nabla\\psi| = |\\frac{d\\psi}{dr}| = \\frac{2\\psi_0 r}{a^2}$。\n    *   因此，极向磁场大小为 $B_p(r,R) = \\frac{1}{R} \\frac{2\\psi_0 r}{a^2}$。\n\n4.  **构建积分**\n    将 $B_\\phi$ 和 $B_p$ 的表达式代入 $\\frac{d\\phi}{d\\theta}$ 的公式中：\n    $$ \\frac{d\\phi}{d\\theta} = \\frac{r \\left( \\frac{B_0 R_0}{R} \\right)}{R \\left( \\frac{1}{R} \\frac{2\\psi_0 r}{a^2} \\right)} = \\frac{r \\frac{B_0 R_0}{R}}{\\frac{2\\psi_0 r}{a^2}} = \\frac{B_0 R_0 a^2}{2\\psi_0 R} $$\n    将 $R = R_0 + r\\cos\\theta$ 代入，得到积分核：\n    $$ \\frac{d\\phi}{d\\theta} = \\frac{B_0 R_0 a^2}{2\\psi_0 (R_0 + r\\cos\\theta)} $$\n\n5.  **求解积分**\n    将上式代入 $q$ 的定义并积分：\n    $$ q(r) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{B_0 R_0 a^2}{2\\psi_0 (R_0 + r\\cos\\theta)} d\\theta = \\frac{B_0 R_0 a^2}{4\\pi\\psi_0} \\int_0^{2\\pi} \\frac{d\\theta}{R_0 + r\\cos\\theta} $$\n    使用标准积分公式 $\\int_0^{2\\pi} \\frac{d\\theta}{A+B\\cos\\theta} = \\frac{2\\pi}{\\sqrt{A^2-B^2}}$ (对于 $A>|B|$)，此处 $A=R_0$, $B=r$。\n    $$ q(r) = \\frac{B_0 R_0 a^2}{4\\pi\\psi_0} \\left( \\frac{2\\pi}{\\sqrt{R_0^2-r^2}} \\right) = \\frac{B_0 R_0 a^2}{2\\psi_0 \\sqrt{R_0^2-r^2}} $$\n\n6.  **代入数值计算**\n    给定参数: $R_0 = 2.8\\ \\mathrm{m}$, $r = 0.40\\ \\mathrm{m}$, $a = 0.60\\ \\mathrm{m}$, $B_0 = 4.5\\ \\mathrm{T}$, $\\psi_0 = 0.50\\ \\mathrm{Wb}$。\n    $$ q = \\frac{(4.5)(2.8)(0.60)^2}{2(0.50)\\sqrt{(2.8)^2 - (0.40)^2}} = \\frac{4.536}{\\sqrt{7.84 - 0.16}} = \\frac{4.536}{\\sqrt{7.68}} $$\n    $$ q \\approx \\frac{4.536}{2.771281} \\approx 1.63683 $$\n    四舍五入到四位有效数字，结果是 $1.637$。\n\n7.  **验证 $R B_{\\phi}$ 的恒定性**\n    根据环向场的定义 $\\mathbf{B}_{\\phi}(R) = \\frac{B_{0} R_{0}}{R}\\,\\mathbf{e}_{\\phi}$，其大小为 $B_{\\phi} = \\frac{B_{0} R_{0}}{R}$。因此，乘积 $R B_{\\phi} = R \\left( \\frac{B_0 R_0}{R} \\right) = B_0 R_0$。由于 $B_0$ 和 $R_0$ 都是常数，所以 $R B_{\\phi}$ 在整个空间中都是常数，自然也在任何一个磁通量面上是常数。这与由外部环向场线圈在无等离子体电流情况下产生的真空环向场是一致的。", "answer": "$$\\boxed{1.637}$$", "id": "3723432"}, {"introduction": "为了简化磁流体动力学平衡和稳定性分析，物理学家们发展了如布泽尔坐标（Boozer coordinates）等特殊的磁坐标系。这个练习的目标是推导布泽尔坐标系下的雅可比行列式 $J_{\\text{Boozer}}$[@problem_id:3723461]。通过这个推导，你将揭示坐标系的几何性质（由 $J_{\\text{Boozer}}$ 体现）与磁场物理量（如场强 $B$ 和流函数 $I(\\psi), G(\\psi)$）之间的深刻联系，这是理解高级磁约束理论不可或缺的一步。", "problem": "考虑一个具有嵌套磁通量面的环向约束等离子体，这些磁通量面由标量磁通函数 $\\psi$ 标记，每个磁通量面由角坐标 $(\\theta,\\zeta)$ 参数化。假设存在一个不随时变的磁场 $\\mathbf{B}$，它与磁通量面相切，因此有 $\\mathbf{B}\\cdot\\nabla\\psi=0$。令 $(\\psi,\\theta,\\zeta)$ 为 Boozer 磁坐标，其定义使得磁场具有直磁力线，其特征由旋转变换 $\\iota(\\psi)$（在每个磁通量面上为常数）决定，并且磁场的协变分量仅依赖于 $\\psi$，即\n$$\n\\mathbf{B} = I(\\psi)\\,\\nabla\\theta + G(\\psi)\\,\\nabla\\zeta,\n$$\n其中 $I(\\psi)$ 和 $G(\\psi)$ 是磁通函数。定义坐标变换 $\\mathbf{r}(\\psi,\\theta,\\zeta)$ 的 Boozer 雅可比行列式 $J_{\\text{Boozer}}$ 为\n$$\nJ_{\\text{Boozer}} \\equiv \\left(\\nabla\\psi\\cdot\\nabla\\theta\\times\\nabla\\zeta\\right)^{-1}.\n$$\n从直磁力线条件和曲线坐标的基本微分几何恒等式出发，用 $B\\equiv|\\mathbf{B}|$, $I(\\psi)$, $G(\\psi)$ 和 $\\iota(\\psi)$ 来推导 $J_{\\text{Boozer}}$。然后，讨论磁通归一化的改变 $\\psi\\mapsto\\psi' = F(\\psi)$（其中 $F'(\\psi)0$）如何影响 $J_{\\text{Boozer}}$ 以及您表达式中出现的组合项 $G(\\psi)+\\iota(\\psi) I(\\psi)$。\n\n你的最终答案必须是 $J_{\\text{Boozer}}(\\psi,\\theta,\\zeta)$ 的一个单一闭合形式解析表达式，用 $B$, $I(\\psi)$, $G(\\psi)$ 和 $\\iota(\\psi)$ 表示。不需要进行数值计算，最终答案中不应包含任何单位。如果您引入了任何中间常数或函数，请将它们从最终表达式中消除，以使答案仅包含 $B$, $I(\\psi)$, $G(\\psi)$ 和 $\\iota(\\psi)$。", "solution": "以下是 Boozer 坐标系下雅可比行列式的推导步骤。\n\n1.  **Boozer 坐标系下磁场的表示**\n    在 Boozer 坐标系 $(\\psi, \\theta, \\zeta)$ 中，磁场 $\\mathbf{B}$ 在逆变基矢 $(\\nabla\\psi, \\nabla\\theta, \\nabla\\zeta)$ 下的协变表示为：\n    $$ \\mathbf{B} = I(\\psi)\\nabla\\theta + G(\\psi)\\nabla\\zeta $$\n    其中 $I(\\psi)$ 和 $G(\\psi)$ 是仅依赖于磁通坐标 $\\psi$ 的流函数。\n\n2.  **计算磁场大小的平方 $B^2$**\n    将磁场向量与其自身进行点积：\n    $$ B^2 = \\mathbf{B} \\cdot \\mathbf{B} = \\mathbf{B} \\cdot (I(\\psi)\\nabla\\theta + G(\\psi)\\nabla\\zeta) = I(\\psi)(\\mathbf{B} \\cdot \\nabla\\theta) + G(\\psi)(\\mathbf{B} \\cdot \\nabla\\zeta) $$\n    项 $\\mathbf{B} \\cdot \\nabla\\theta$ 和 $\\mathbf{B} \\cdot \\nabla\\zeta$ 是磁场的逆变分量，分别记作 $B^\\theta$ 和 $B^\\zeta$。因此：\n    $$ B^2 = I(\\psi)B^\\theta + G(\\psi)B^\\zeta $$\n\n3.  **应用直场线条件**\n    直场线坐标的一个定义特征是，磁力线在 $(\\theta, \\zeta)$ 平面上的投影是斜率为常数（旋转变换 $\\iota(\\psi)$）的直线。这意味着磁场逆变分量之比等于旋转变换：\n    $$ \\frac{d\\theta}{d\\zeta} = \\frac{B^\\theta}{B^\\zeta} = \\iota(\\psi) \\implies B^\\theta = \\iota(\\psi)B^\\zeta $$\n    将此关系代入 $B^2$ 的表达式：\n    $$ B^2 = I(\\psi)(\\iota(\\psi)B^\\zeta) + G(\\psi)B^\\zeta = (G(\\psi) + \\iota(\\psi)I(\\psi))B^\\zeta $$\n\n4.  **应用磁场无散度条件**\n    物理磁场必须是无散度的，即 $\\nabla \\cdot \\mathbf{B} = 0$。在一般曲线坐标中，无散度条件写为：\n    $$ \\nabla \\cdot \\mathbf{B} = \\frac{1}{J} \\left( \\frac{\\partial}{\\partial\\psi}(J B^\\psi) + \\frac{\\partial}{\\partial\\theta}(J B^\\theta) + \\frac{\\partial}{\\partial\\zeta}(J B^\\zeta) \\right) = 0 $$\n    其中 $J$ 是雅可比行列式 $J \\equiv (\\nabla\\psi\\cdot\\nabla\\theta\\times\\nabla\\zeta)^{-1}$。由于磁力线位于磁通量面上，我们有 $B^\\psi = \\mathbf{B} \\cdot \\nabla\\psi = 0$。Boozer 坐标通过巧妙的构造使得乘积 $J B^\\theta$ 和 $J B^\\zeta$ 都仅是 $\\psi$ 的函数，这自动满足了无散度方程。\n\n5.  **磁通坐标的归一化**\n    根据 Boozer 坐标的标准约定，磁通坐标 $\\psi$ 被归一化，使得 $2\\pi\\psi$ 等于穿过极向截面的环向磁通量 $\\Psi_t$。环向磁通量对 $\\psi$ 的导数为：\n    $$ \\frac{d\\Psi_t}{d\\psi} = \\int_0^{2\\pi} J B^\\zeta d\\theta = 2\\pi (J B^\\zeta) $$\n    由于我们假定 $d\\Psi_t/d\\psi = 2\\pi$，可得 Boozer 坐标的一个关键属性：\n    $$ J_{\\text{Boozer}} B^\\zeta = 1 \\implies B^\\zeta = \\frac{1}{J_{\\text{Boozer}}} $$\n\n6.  **推导最终表达式**\n    将 $B^\\zeta = 1/J_{\\text{Boozer}}$ 代入步骤3中得到的 $B^2$ 表达式中：\n    $$ B^2 = (G(\\psi) + \\iota(\\psi)I(\\psi)) \\left( \\frac{1}{J_{\\text{Boozer}}} \\right) $$\n    整理可得 Boozer 雅可bi行列式的最终表达式：\n    $$ J_{\\text{Boozer}}(\\psi, \\theta, \\zeta) = \\frac{G(\\psi) + \\iota(\\psi)I(\\psi)}{B^2} $$\n    这个表达式揭示了 Boozer 坐标的几何特性（由雅可比行列式 $J$ 体现）与磁场的物理量（流函数 $G, I$、旋转变换 $\\iota$ 和场强大小 $B$）之间的深刻联系。\n\n7.  **关于磁通归一化的讨论**\n    如果改变磁通标签 $\\psi \\to \\psi' = F(\\psi)$，其中 $F' > 0$：\n    *   雅可比行列式变换为 $J' = J/F'$。\n    *   流函数 $G, I$ 和旋转变换 $\\iota$ 的值在同一个物理磁面上是不变的，所以 $G'(\\psi') = G(\\psi)$, $I'(\\psi') = I(\\psi)$, $\\iota'(\\psi') = \\iota(\\psi)$。因此，组合项 $G(\\psi)+\\iota(\\psi)I(\\psi)$ 的值在坐标变换下是**不变的**。\n    *   我们的推导依赖于 $d\\Psi_t/d\\psi = 2\\pi$ 的归一化。对于新坐标 $\\psi'$，有 $d\\Psi_t/d\\psi' = (d\\Psi_t/d\\psi)(d\\psi/d\\psi') = 2\\pi / F'$。一个更普适、不依赖归一化的关系是 $J B^\\zeta = \\frac{1}{2\\pi}\\frac{d\\Psi_t}{d\\psi}$。代入后可验证，我们的最终表达式与坐标变换是一致的。", "answer": "$$\n\\boxed{\\frac{G(\\psi) + \\iota(\\psi) I(\\psi)}{B^{2}}}\n$$", "id": "3723461"}, {"introduction": "在理论分析和数值模拟中，选择合适的磁坐标系至关重要，不同的选择会对计算效率和精度产生显著影响。这个编程练习将引导你对布泽尔（Boozer）坐标和滨田（Hamada）坐标进行定量比较[@problem_id:3723408]。通过计算一个典型物理量在不同坐标系下的积分均匀性，你将亲身体会到这些坐标系的特性如何转化为实际的数值优势，从而理解在实践中进行坐标系选择的依据。", "problem": "考虑一个用于核聚变的环形约束装置中的单个嵌套磁通量面。设该磁通量面由环向磁通量 $\\psi$ 标记，并由直场线角 $(\\theta,\\zeta)$ 参数化，其中 $\\theta \\in [0,2\\pi)$ 是极向角，$\\zeta \\in [0,2\\pi)$ 是环向角，两者均以弧度为单位。该磁通量面上的磁场强度由一个截断的傅里叶级数表示\n$$\nB(\\theta,\\zeta) = B_0 \\left[ 1 + \\epsilon \\cos(m\\,\\theta - n\\,\\zeta) \\right],\n$$\n其中 $B_0$ 的单位是特斯拉（Tesla），$m$ 和 $n$ 是整数模数，$\\epsilon$ 是一个无量纲振幅，满足 $0 \\le \\epsilon  1$ 以确保 $B(\\theta,\\zeta)  0$。假设理想磁流体力学（MHD）平衡，并且存在直场线磁坐标系。\n\n两种广泛使用的磁坐标系是 Boozer 坐标系和 Hamada 坐标系。在 Boozer 坐标系中，一个经过充分检验的特性是 $B^2 J$ 是一个通量函数，其中 $J$ 是坐标变换 $(\\psi,\\theta,\\zeta) \\mapsto (x,y,z)$ 的雅可比行列式，而通量函数仅依赖于 $\\psi$。在 Hamada 坐标系中，一个经过充分检验的特性是 $J$ 本身就是一个通量函数。在单个磁通量面上，任何通量函数都可以被视为关于 $(\\theta,\\zeta)$ 的常数，并被吸收到归一化中。因此，为了在单个磁通量面上进行数值积分，可以将雅可比行列式的角度依赖性建模为\n- Hamada: $J_{\\mathrm{H}}(\\theta,\\zeta) \\propto 1$,\n- Boozer: $J_{\\mathrm{B}}(\\theta,\\zeta) \\propto \\dfrac{1}{B(\\theta,\\zeta)^2}$,\n这不包括那些不影响均匀性度量的乘法常数。\n\n设 $f(\\theta,\\zeta)$ 是一个需要在磁通量面上求平均的目标被积函数。在任何坐标系中，磁通量面平均值都正比于\n$$\n\\langle f \\rangle \\propto \\int_0^{2\\pi}\\int_0^{2\\pi} f(\\theta,\\zeta)\\, J(\\theta,\\zeta)\\, d\\theta\\, d\\zeta.\n$$\n在实际的数值场线追踪和积分中，通常使用对 $(\\theta,\\zeta)$ 的简单均匀采样，因此有效被积函数 $g(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J(\\theta,\\zeta)$ 的均匀性直接影响离散化误差。一个有原则的、与坐标系无关的偏好准则是选择能最小化 $g$ 的变异系数的坐标系，对于离散样本 $\\{g_k\\}_{k=1}^K$，其定义为\n$$\n\\mathrm{CV}(g) = \\frac{\\sqrt{\\mathrm{Var}(g)}}{\\mathbb{E}[g]}.\n$$\n此处，$\\mathbb{E}[g]$ 和 $\\mathrm{Var}(g)$ 表示在 $(\\theta,\\zeta)$ 的均匀网格上的样本均值和样本方差。\n\n您的任务是实现这个偏好准则，并针对每个测试用例，在给定指数 $p$ 的情况下，对于 $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$ 这一选择，判断 Boozer 坐标系是否优于 Hamada 坐标系。具体而言：\n\n1. 对于每个测试用例，在一个 $N=512$ 的 $N \\times N$ 点的均匀网格上构造 $B(\\theta,\\zeta)$，覆盖 $\\theta \\in [0,2\\pi)$ 和 $\\zeta \\in [0,2\\pi)$（以弧度为单位）。\n2. 用给定的 $p$（无量纲）定义 $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$。\n3. 构造 $g_{\\mathrm{H}}(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J_{\\mathrm{H}}(\\theta,\\zeta)$（其中 $J_{\\mathrm{H}}(\\theta,\\zeta) = 1$）和 $g_{\\mathrm{B}}(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J_{\\mathrm{B}}(\\theta,\\zeta)$（其中 $J_{\\mathrm{B}}(\\theta,\\zeta) = \\dfrac{1}{B(\\theta,\\zeta)^2}$）。乘法归一化常数是无关紧要的，因为变异系数是尺度不变的。\n4. 计算 $\\mathrm{CV}(g_{\\mathrm{B}})$ 和 $\\mathrm{CV}(g_{\\mathrm{H}})$ 作为浮点数。\n5. 当且仅当 $\\mathrm{CV}(g_{\\mathrm{B}})  \\mathrm{CV}(g_{\\mathrm{H}})$ 时，判定 Boozer 坐标系为更优选择。\n\n请为以下用于检验不同区域的参数值测试套件提供结果：\n- 测试 $1$（$p=2$ 时的理想情况）：$B_0 = 5$ 特斯拉，$\\epsilon = 0.1$，$m = 1$，$n = 1$，$p = 2$。\n- 测试 $2$（无变化的边界情况）：$B_0 = 5$ 特斯拉，$\\epsilon = 0$，$m = 1$，$n = 1$，$p = 1$。\n- 测试 $3$（被积函数均匀时偏好 Hamada）：$B_0 = 3$ 特斯拉，$\\epsilon = 0.25$，$m = 2$，$n = 3$，$p = 0$。\n- 测试 $4$（非平凡比较）：$B_0 = 2$ 特斯拉，$\\epsilon = 0.3$，$m = 3$，$n = 1$，$p = 1$。\n- 测试 $5$（强但正的变化）：$B_0 = 4$ 特斯拉，$\\epsilon = 0.9$，$m = 1$，$n = 2$，$p = 2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$ [result_1,result_2,\\dots,result_5] $），其中每个条目都是一个布尔值，根据上述准则指示相应测试是否偏好 Boozer 坐标系。在整个过程中，角度必须以弧度处理。不需要外部输入，输出中也不应出现物理单位。", "solution": "该问题的解决逻辑如下：\n\n1.  **目标与准则**：\n    目标是为函数 $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$ 的磁面平均积分选择最优坐标系（Boozer或Hamada）。选择准则是最小化有效被积函数 $g(\\theta,\\zeta) = f(\\theta,\\zeta)J(\\theta,\\zeta)$ 的变异系数(CV)，因为这对应于在均匀网格上进行数值积分时更小的离散化误差。\n\n2.  **有效被积函数**：\n    根据问题陈述，两种坐标系下雅可比行列式 $J$ 的角度依赖性（忽略常数比例因子）为：\n    *   Hamada坐标系: $J_{\\mathrm{H}} \\propto 1$。\n    *   Boozer坐标系: $J_{\\mathrm{B}} \\propto 1/B^2$。\n\n    因此，两种坐标系下的有效被积函数 $g$ 分别为：\n    *   Hamada: $g_{\\mathrm{H}}(\\theta,\\zeta) = f \\cdot J_{\\mathrm{H}} = B^p \\cdot 1 = B(\\theta,\\zeta)^p$。\n    *   Boozer: $g_{\\mathrm{B}}(\\theta,\\zeta) = f \\cdot J_{\\mathrm{B}} = B^p \\cdot (1/B^2) = B(\\theta,\\zeta)^{p-2}$。\n\n3.  **量化均匀性**：\n    均匀性由变异系数 $\\mathrm{CV}(g) = \\sigma_g / \\mu_g$ 度量，其中 $\\mu_g$ 和 $\\sigma_g$ 分别是 $g$ 在 $(\\theta, \\zeta)$ 域上的均值和标准差。$\\mathrm{CV}$ 值越小，函数越均匀。Boozer坐标系被判为更优的条件是：\n    $$ \\mathrm{CV}(g_{\\mathrm{B}})  \\mathrm{CV}(g_{\\mathrm{H}}) $$\n\n4.  **数值实现**：\n    对于每个测试用例，我们执行以下步骤：\n    a.  在一个 $512 \\times 512$ 的均匀网格上生成 $(\\theta, \\zeta)$ 的值。\n    b.  根据公式 $B(\\theta,\\zeta) = B_0 [ 1 + \\epsilon \\cos(m\\theta - n\\zeta) ]$ 计算网格上所有点的 $B$ 值。\n    c.  计算网格上所有点的 $g_{\\mathrm{H}} = B^p$ 和 $g_{\\mathrm{B}} = B^{p-2}$ 的值。\n    d.  分别计算 $g_{\\mathrm{H}}$ 和 $g_{\\mathrm{B}}$ 数组的均值和标准差，从而得到 $\\mathrm{CV}(g_{\\mathrm{H}})$ 和 $\\mathrm{CV}(g_{\\mathrm{B}})$。\n    e.  比较这两个 $\\mathrm{CV}$ 值，得出该测试用例下Boozer坐标系是否更优的布尔结果。\n\n5.  **特殊情况分析**：\n    *   当 $p=2$ 时，$g_{\\mathrm{B}} = B^0 = 1$ 是一个常数，其 $\\mathrm{CV}$ 为0。只要 $\\epsilon > 0$，$g_{\\mathrm{H}} = B^2$ 就不是常数，其 $\\mathrm{CV} > 0$。因此，Boozer坐标系总是更优。\n    *   当 $p=0$ 时，$g_{\\mathrm{H}} = B^0 = 1$ 是一个常数，其 $\\mathrm{CV}$ 为0。只要 $\\epsilon > 0$，$g_{\\mathrm{B}} = B^{-2}$ 就不是常数，其 $\\mathrm{CV} > 0$。因此，Hamada坐标系总是更优（即Boozer不是更优）。\n    *   当 $\\epsilon=0$ 时，$B$ 是常数，因此 $g_{\\mathrm{H}}$ 和 $g_{\\mathrm{B}}$ 都是常数，它们的 $\\mathrm{CV}$ 均为0。不等式 $0  0$ 为假，因此Boozer不被判为更優。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of choosing between Boozer and Hamada coordinates based on\n    the uniformity of an effective integrand for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (B0, epsilon, m, n, p).\n    test_cases = [\n        (5.0, 0.1, 1, 1, 2.0),\n        (5.0, 0.0, 1, 1, 1.0),\n        (3.0, 0.25, 2, 3, 0.0),\n        (2.0, 0.3, 3, 1, 1.0),\n        (4.0, 0.9, 1, 2, 2.0),\n    ]\n\n    results = []\n    N = 512\n\n    # Create the angular grids for theta and zeta.\n    # The grid covers [0, 2*pi) as specified.\n    angles = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    theta_grid, zeta_grid = np.meshgrid(angles, angles, indexing='ij')\n\n    for b0, epsilon, m, n, p in test_cases:\n        # Calculate the magnetic field B(theta, zeta) on the grid.\n        # B = B_0 * [1 + epsilon * cos(m*theta - n*zeta)]\n        if epsilon == 0.0:\n            # Handle the constant field case to avoid floating point noise.\n            B_grid = np.full((N, N), b0)\n        else:\n            B_grid = b0 * (1 + epsilon * np.cos(m * theta_grid - n * zeta_grid))\n\n        # Form the effective integrands g_H and g_B.\n        # g_H is proportional to B^p\n        # g_B is proportional to B^(p-2)\n        if p == 0.0:\n            g_H = np.ones((N, N))\n        else:\n            g_H = np.power(B_grid, p)\n        \n        if p == 2.0:\n            g_B = np.ones((N, N))\n        else:\n            g_B = np.power(B_grid, p - 2)\n\n        # Calculate the coefficient of variation (CV) for each integrand.\n        # CV(g) = std(g) / mean(g).\n        # We use the population standard deviation (numpy.std default, ddof=0),\n        # as the grid represents the entire population of discrete points.\n        \n        # Denominators (means) are guaranteed to be positive since B > 0.\n        mean_g_H = np.mean(g_H)\n        std_g_H = np.std(g_H)\n        cv_H = 0.0 if mean_g_H == 0 else std_g_H / mean_g_H\n\n        mean_g_B = np.mean(g_B)\n        std_g_B = np.std(g_B)\n        cv_B = 0.0 if mean_g_B == 0 else std_g_B / mean_g_B\n\n        # Decide if Boozer coordinates are preferred.\n        # The criterion is CV(g_B)  CV(g_H).\n        is_boozer_preferred = cv_B  cv_H\n        results.append(is_boozer_preferred)\n\n    # Final print statement in the exact required format.\n    # The results list contains booleans, which need to be converted to lowercase strings.\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nsolve()\n```", "id": "3723408"}]}