## 引言
在现代宇宙学中，理解发光的星系如何栖居于不可见的暗物质晕网络中，是连接理论与观测的基石。子晕丰度匹配（Subhalo Abundance Matching, SHAM）作为一种强大而直观的经验模型，为这一难题提供了优雅的解决方案。其旨在解决的核心问题是：如何在不进行复杂[流体动力学模拟](@entry_id:142279)的情况下，将大型[N体模拟](@entry_id:157492)预测的暗[物质结构](@entry_id:269505)与观测到的星系总体进行有效关联，从而生成可检验的预言。

本文将系统地引导读者深入SHAM的世界。在“原则与机制”一章，您将掌握其基于数密度匹配的核心思想，以及如何选择合适的晕属性、区分中心与卫星星系，并处理散布效应。接下来，“应用与跨学科联系”将展示SHAM如何用于预测星系[聚类](@entry_id:266727)、解释星系形成偏倚，并启发其他学科的研究。最后，“动手实践”部分将通过具体计算问题，巩固您对理论的理解和应用能力。

## 原则与机制

在理解宇宙[大尺度结构](@entry_id:158990)中星系与[暗物质晕](@entry_id:147523)之间的联系时，子晕丰度匹配（Subhalo Abundance Matching, SHAM）提供了一个强大而直观的经验性框架。本章将深入探讨 SHAM 的基本原则、核心机制及其在构建模拟星系表中的实际应用。我们将从最基础的丰度匹配概念出发，逐步引入处理散布、区分中心星系与卫星星系、以及将模型扩展至不同宇宙演化时期的复杂技术。

### 丰度匹配的基本原则

SHAM 的核心假设是，一个星系的某个内禀属性（通常是[恒星质量](@entry_id:157648) $M_{\star}$）与它所居住的暗物质（子）晕的某个属性（用一个标量 $X$ 表示，如质量或最大[圆周速度](@entry_id:161552)）之间存在一个单调的对应关系。这个假设源于一个物理直觉：更大、更深的暗物质[势阱](@entry_id:151413)应该能够形成并束缚住更多的恒星。

在最简单的形式，即无散布的情况下，这种对应关系通过匹配累积数密度来确定。给定一个观测到的星系[恒星质量](@entry_id:157648)函数 $\phi(M_{\star})$ 和一个从数值模拟中测量的（子）晕属性函数 $\psi(X)$，我们可以定义各自的累积[数密度](@entry_id:268986)：

$n_{\mathrm{gal}}(>M_{\star}) = \int_{M_{\star}}^{\infty} \phi(M'_{\star}) dM'_{\star}$

$n_{\mathrm{(sub)halo}}(>X) = \int_{X}^{\infty} \psi(X') dX'$

其中，$n_{\mathrm{gal}}(>M_{\star})$ 是单位共动体积内[恒星质量](@entry_id:157648)大于 $M_{\star}$ 的星系的数量密度，$n_{\mathrm{(sub)halo}}(>X)$ 则是（子）晕属性值大于 $X$ 的数量密度。SHAM 的基本方程就是令这两个[数密度](@entry_id:268986)相等：

$n_{\mathrm{gal}}(>M_{\star}) = n_{\mathrm{(sub)halo}}(>X)$

这个方程隐含地定义了一个严格单调的函数关系 $M_{\star}(X)$。一旦这个关系被确定，我们就可以将模拟中的每一个（子）晕赋予一个星系，其[恒星质量](@entry_id:157648)由该（子）晕的属性 $X$ 决定。更重要的是，这个被赋予的星系将继承其宿主（子）晕的位置和速度，即其在相空间中的[分布](@entry_id:182848)。这使得 SHAM 成为构建模拟星系表（mock galaxy catalog）并预测星系聚类等[可观测量](@entry_id:267133)的有效工具 [@problem_id:3492424]。

值得注意的是，SHAM 与另一种流行的星系-[暗物质晕](@entry_id:147523)连接模型——晕占据[分布](@entry_id:182848)（Halo Occupation Distribution, HOD）——在概念上存在根本区别。HOD 是一个统计模型，它描述的是一个质量为 $M_{\mathrm{halo}}$ 的主晕中包含 $N$ 个特定类型星系的[概率分布](@entry_id:146404) $P(N|M_{\mathrm{halo}})$，而不涉及将单个星系与单个子晕一一对应 [@problem_id:3492424]。

一个常见的误解是，丰度匹配要求星系[质量函数](@entry_id:158970) $\phi(M_{\star})$ 和晕属性函数 $\psi(X)$ 具有相同的形状。实际上，它们通过转换的[雅可比行列式](@entry_id:137120)（Jacobian）联系在一起。对丰度匹配方程两边关于 $M_{\star}$ 求导，我们得到：

$\phi(M_{\star}) = \psi(X(M_{\star})) \frac{dX}{dM_{\star}}$

这个关系表明，正是因为 $\phi(M_{\star})$ 和 $\psi(X)$ 的形状通常非常不同，才导致了非平庸的、[非线性](@entry_id:637147)的 $M_{\star}(X)$ 关系 [@problem_id:3492424]。

### 选择匹配的暗物质晕总体

在应用 SHAM 时，一个基本问题是：我们应该将星系与哪个[暗物质晕](@entry_id:147523)总体进行匹配？通常有两种选择：只使用独立的暗物质主晕（distinct host halos），或者使用所有可分辨的束缚结构，即包括主晕和它们内部的子晕（subhalos）。

如果只使用主晕，我们实际上是在假设所有星系都是位于各自[暗物质晕](@entry_id:147523)中心的**中心星系**（central galaxies）。然而，观测表明，相当一部分星系是作为**卫星星系**（satellite galaxies）存在于更大的系统（如星系群和星系团）之中的。这些卫星星系居住在主晕内部的子晕中。因此，一个更完备的 SHAM 模型必须包含子晕。

将子晕加入匹配总体会如何改变 $M_{\star}(X)$ 的映射关系呢？在任何给定的属性值 $X$ 上，包含子晕的累积[数密度](@entry_id:268986) $n_{\mathrm{(sub)halo}}(>X)$ 总是大于或等于只包含主晕的累积[数密度](@entry_id:268986) $n_{\mathrm{halo}}(>X)$。为了匹配一个固定的星系累积数密度 $n_{\mathrm{gal}}(>M_{\star})$，当使用包含子晕的总体时，我们必须在晕属性 $X$ 上达到一个更高的阈值。也就是说，对于给定的 $M_{\star}$，从包含子晕的总体中推断出的属性值 $X_{\mathrm{a}}(M_{\star})$ 会比从只包含主晕的总体中推断出的属性值 $X_{\mathrm{d}}(M_{\star})$ 更大。这似乎有违直觉，但可以这样理解：我们将匹配对象扩展到了一个更大、更有“竞争力”的池子中，要达到相同的排名（即累积[数密度](@entry_id:268986)），自然需要更高的“分数”（即属性 $X$ 的值）[@problem_id:3492485]。

这个效应主要影响中低质量的星系。对于质量极大的星系，它们非常稀有，几乎总是作为中心星系存在于最巨大的暗物质晕中。在这些质量尺度上，子晕的贡献可以忽略不计，因此 $n_{\mathrm{(sub)halo}}(>X) \approx n_{\mathrm{halo}}(>X)$，两种匹配方案下的映射关系也趋于一致 [@problem_id:3492485]。

### 选择合适的晕属性代理（Proxy）

选择了匹配的暗物质晕总体后，下一个关键问题是选择哪个物理属性 $X$ 作为星系质量的代理。一个好的代理应该与星系的[恒星质量](@entry_id:157648)有紧密的物理关联，并且对于卫星星系而言，这种关联不应被其进入主晕后所经历的复杂环境过程所破坏。

常见的代理包括：
- **晕质量**：例如，基于某个固定过密度定义的质量 $M_{\mathrm{vir}}$ 或 $M_{200c}$。
- **最大[圆周速度](@entry_id:161552)** $V_{\mathrm{max}}$：定义为晕[圆周速度](@entry_id:161552)曲线 $V_c(r) = \sqrt{G M(<r)/r}$ 的峰值。