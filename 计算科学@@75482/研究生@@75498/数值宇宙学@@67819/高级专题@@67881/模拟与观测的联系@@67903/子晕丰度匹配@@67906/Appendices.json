{"hands_on_practices": [{"introduction": "亚晕丰度匹配（SHAM）的核心在于将星系和（亚）晕的累积数密度一一对应。本练习将通过一个实际计算，探讨当观测的星系恒星质量存在系统性偏差时，这种不确定性如何通过SHAM的映射关系传递到推断的暗晕质量上。通过这个练习 [@problem_id:3492426]，你将深入理解误差传播在建立星系-暗晕联系中的关键作用，并掌握如何量化输入目录的系统误差对模型推断结果的影响。", "problem": "次晕丰度匹配（Subhalo Abundance Matching, SHAM）的一个基本出发点是，通过将高于某一恒星质量阈值的星系的累积数密度与高于相应晕代理阈值的（次）晕的累积数密度相等，可以获得星系恒星质量与晕代理之间的单调映射。考虑一个红移 $z \\approx 0$ 的SHAM模型，其中代理是峰值入轨前质量，记为 $M_{\\mathrm{peak}}$。令 $\\log$ 表示以10为底的对数。假设在当前SHAM阈值附近的一个狭窄质量范围内，存在以下局域幂律描述：\n- 累积恒星质量函数在局域上为 $n_{\\mathrm{g}}(>M_{\\star}) \\propto M_{\\star}^{-\\beta}$，其中 $\\beta = 1.6$。\n- 独立主晕的累积丰度在局域上为 $n_{\\mathrm{host}}(>M) \\propto M^{-\\gamma_{\\mathrm{h}}}$，其中 $\\gamma_{\\mathrm{h}} = 0.9$。\n- 次晕的累积丰度（在宇宙学体积内，对所有主晕进行计数）在局域上为 $n_{\\mathrm{sub}}(>M) \\propto M^{-\\gamma_{\\mathrm{s}}}$，其中 $\\gamma_{\\mathrm{s}} = 1.2$。\n- 在当前的SHAM阈值处，卫星分数为 $f_{\\mathrm{sat},0} = 0.22$。\n\n假设一个均匀的系统性偏移影响了所有的恒星质量估计，使得 $\\Delta \\log M_{\\star} = +0.10$（即，所有恒星质量都被高估了 $0.10$ dex）。根据SHAM匹配累积丰度的要求，这会在推断的 $M_{\\mathrm{peak}}$ 阈值中导致一个移动。将幂律近似视为在小的移动范围内有效，并计算到移动的一阶。\n\n仅使用上述原理，且不假设任何进一步的拟合公式，计算：\n1. 在系统性恒星质量偏移后，为保持丰度匹配条件所需的感生移动 $\\Delta \\log M_{\\mathrm{peak}}$。\n2. 在移动后的 $M_{\\mathrm{peak}}$ 阈值处评估的新卫星分数 $f_{\\mathrm{sat}}$。\n\n请按 $\\left(\\Delta \\log M_{\\mathrm{peak}}, f_{\\mathrm{sat}}\\right)$ 的顺序提供您的最终答案，形式为两个数字。将您的数值结果四舍五入到四位有效数字。用 dex 表示 $\\Delta \\log M_{\\mathrm{peak}}$，用无量纲小数表示 $f_{\\mathrm{sat}}$。", "solution": "该问题是有效的。它在科学上基于宇宙学中的次晕丰度匹配（SHAM）原理，问题陈述清晰，信息充分，可得到唯一解，并且陈述客观。我们可以着手求解。\n\n次晕丰度匹配（SHAM）的核心原理是星系与（次）晕之间累积数密度的相等关系。设 $M_{\\star}$ 为星系恒星质量，$M_{\\mathrm{peak}}$ 为晕质量代理（峰值入轨前质量）。SHAM条件为：\n$$n_{\\mathrm{g}}(>M_{\\star}) = n_{\\mathrm{halo}}(>M_{\\mathrm{peak}})$$\n晕的总数密度 $n_{\\mathrm{halo}}$ 是独立主晕的数密度 $n_{\\mathrm{host}}$ 和次晕的数密度 $n_{\\mathrm{sub}}$ 之和。\n$$n_{\\mathrm{halo}}(>M_{\\mathrm{peak}}) = n_{\\mathrm{host}}(>M_{\\mathrm{peak}}) + n_{\\mathrm{sub}}(>M_{\\mathrm{peak}})$$\n\n对于这些累积丰度，我们有给定的局域幂律描述：\n-   星系恒星质量函数：$n_{\\mathrm{g}}(>M_{\\star}) = C_{\\mathrm{g}} M_{\\star}^{-\\beta}$，其中 $\\beta = 1.6$。\n-   主晕质量函数：$n_{\\mathrm{host}}(>M) = C_{\\mathrm{h}} M^{-\\gamma_{\\mathrm{h}}}$，其中 $\\gamma_{\\mathrm{h}} = 0.9$。\n-   次晕质量函数：$n_{\\mathrm{sub}}(>M) = C_{\\mathrm{s}} M^{-\\gamma_{\\mathrm{s}}}$，其中 $\\gamma_{\\mathrm{s}} = 1.2$。\n这里，$C_{\\mathrm{g}}$、$C_{\\mathrm{h}}$ 和 $C_{\\mathrm{s}}$ 是归一化常数。\n\n令 $m_{\\star} = \\log M_{\\star}$ 和 $m_{\\mathrm{p}} = \\log M_{\\mathrm{peak}}$ 表示质量以10为底的对数。在特定丰度下应用的SHAM方程建立了一个关系 $m_{\\mathrm{p}}(m_{\\star})$。给定恒星质量的系统性移动 $\\Delta m_{\\star} = +0.10$，我们需要找到保持丰度匹配的晕质量阈值的感生移动 $\\Delta m_{\\mathrm{p}}$。我们计算到一阶，这对于小移动是合适的。\n\n这意味着由 $\\Delta m_{\\star}$ 引起的 $n_{\\mathrm{g}}$ 的变化必须由 $\\Delta m_{\\mathrm{p}}$ 引起的 $n_{\\mathrm{halo}}$ 的变化来补偿，以使总丰度保持匹配。以微分形式表示，即 $dn_{\\mathrm{g}} = dn_{\\mathrm{halo}}$。\n\n让我们来表示这些微分。\n对于星系：\n$n_{\\mathrm{g}} \\propto (10^{m_{\\star}})^{-\\beta} = 10^{-\\beta m_{\\star}}$。\n$dn_{\\mathrm{g}} = \\frac{dn_{\\mathrm{g}}}{dm_{\\star}} dm_{\\star} = (-\\beta \\ln 10) n_{\\mathrm{g}} dm_{\\star}$。\n\n对于晕：\n$n_{\\mathrm{halo}} = n_{\\mathrm{host}} + n_{\\mathrm{sub}} \\propto 10^{-\\gamma_{\\mathrm{h}} m_{\\mathrm{p}}} + C' 10^{-\\gamma_{\\mathrm{s}} m_{\\mathrm{p}}}$，其中 $C'$ 是一个相对归一化系数。\n$dn_{\\mathrm{halo}} = \\frac{dn_{\\mathrm{halo}}}{dm_{\\mathrm{p}}} dm_{\\mathrm{p}} = \\left( \\frac{dn_{\\mathrm{host}}}{dm_{\\mathrm{p}}} + \\frac{dn_{\\mathrm{sub}}}{dm_{\\mathrm{p}}} \\right) dm_{\\mathrm{p}}$。\n$\\frac{dn_{\\mathrm{host}}}{dm_{\\mathrm{p}}} = (-\\gamma_{\\mathrm{h}} \\ln 10) n_{\\mathrm{host}}$。\n$\\frac{dn_{\\mathrm{sub}}}{dm_{\\mathrm{p}}} = (-\\gamma_{\\mathrm{s}} \\ln 10) n_{\\mathrm{sub}}$。\n所以，$dn_{\\mathrm{halo}} = \\left( (-\\gamma_{\\mathrm{h}} \\ln 10) n_{\\mathrm{host}} - (\\gamma_{\\mathrm{s}} \\ln 10) n_{\\mathrm{sub}} \\right) dm_{\\mathrm{p}}$。\n\n令微分相等 $dn_{\\mathrm{g}} = dn_{\\mathrm{halo}}$：\n$(-\\beta \\ln 10) n_{\\mathrm{g}} dm_{\\star} = \\left( (-\\gamma_{\\mathrm{h}} \\ln 10) n_{\\mathrm{host}} - (\\gamma_{\\mathrm{s}} \\ln 10) n_{\\mathrm{sub}} \\right) dm_{\\mathrm{p}}$。\n在匹配阈值处，$n_{\\mathrm{g}} = n_{\\mathrm{host}} + n_{\\mathrm{sub}}$。代入此式并消去 $(-\\ln 10)$：\n$\\beta (n_{\\mathrm{host}} + n_{\\mathrm{sub}}) dm_{\\star} = (\\gamma_{\\mathrm{h}} n_{\\mathrm{host}} + \\gamma_{\\mathrm{s}} n_{\\mathrm{sub}}) dm_{\\mathrm{p}}$。\n\n求解移动的比率：\n$\\frac{dm_{\\mathrm{p}}}{dm_{\\star}} = \\frac{\\beta (n_{\\mathrm{host}} + n_{\\mathrm{sub}})}{\\gamma_{\\mathrm{h}} n_{\\mathrm{host}} + \\gamma_{\\mathrm{s}} n_{\\mathrm{sub}}}$。\n为了计算分母，我们使用初始卫星分数 $f_{\\mathrm{sat},0} = 0.22$。卫星分数是次晕的数密度除以晕的总数密度：\n$f_{\\mathrm{sat},0} = \\frac{n_{\\mathrm{sub}}}{n_{\\mathrm{host}} + n_{\\mathrm{sub}}}$。\n这意味着 $n_{\\mathrm{host}} = (1 - f_{\\mathrm{sat},0})(n_{\\mathrm{host}} + n_{\\mathrm{sub}})$。\n将比率 $\\frac{dm_{\\mathrm{p}}}{dm_{\\star}}$ 的分子和分母同除以 $(n_{\\mathrm{host}} + n_{\\mathrm{sub}})$ 得到：\n$\\frac{dm_{\\mathrm{p}}}{dm_{\\star}} = \\frac{\\beta}{\\gamma_{\\mathrm{h}} \\frac{n_{\\mathrm{host}}}{n_{\\mathrm{host}} + n_{\\mathrm{sub}}} + \\gamma_{\\mathrm{s}} \\frac{n_{\\mathrm{sub}}}{n_{\\mathrm{host}} + n_{\\mathrm{sub}}}} = \\frac{\\beta}{\\gamma_{\\mathrm{h}}(1-f_{\\mathrm{sat},0}) + \\gamma_{\\mathrm{s}} f_{\\mathrm{sat},0}}$。\n\n现在，我们可以计算移动 $\\Delta \\log M_{\\mathrm{peak}} = \\Delta m_{\\mathrm{p}}$。对于小的有限移动，$\\Delta m_{\\mathrm{p}} \\approx \\frac{dm_{\\mathrm{p}}}{dm_{\\star}} \\Delta m_{\\star}$。\n$\\Delta \\log M_{\\mathrm{peak}} = \\left( \\frac{\\beta}{\\gamma_{\\mathrm{h}}(1-f_{\\mathrm{sat},0}) + \\gamma_{\\mathrm{s}} f_{\\mathrm{sat},0}} \\right) \\Delta \\log M_{\\star}$。\n代入给定值：\n$\\beta = 1.6$，$\\gamma_{\\mathrm{h}} = 0.9$，$\\gamma_{\\mathrm{s}} = 1.2$，$f_{\\mathrm{sat},0} = 0.22$，以及 $\\Delta \\log M_{\\star} = 0.10$。\n分母是 $\\gamma_{\\mathrm{h}}(1-f_{\\mathrm{sat},0}) + \\gamma_{\\mathrm{s}} f_{\\mathrm{sat},0} = 0.9 \\times (1-0.22) + 1.2 \\times 0.22 = 0.9 \\times 0.78 + 0.264 = 0.702 + 0.264 = 0.966$。\n$\\Delta \\log M_{\\mathrm{peak}} = \\frac{1.6}{0.966} \\times 0.10 \\approx 1.6563147 \\times 0.10 \\approx 0.16563$。\n四舍五入到四位有效数字，$\\Delta \\log M_{\\mathrm{peak}} = 0.1656$。\n\n接下来，我们计算在移动后的质量阈值处的新卫星分数 $f_{\\mathrm{sat}}$。新的阈值是 $M_{\\mathrm{peak},1} = M_{\\mathrm{peak},0} \\cdot 10^{\\Delta \\log M_{\\mathrm{peak}}}$。\n新的卫星分数是 $f_{\\mathrm{sat}} = \\frac{n_{\\mathrm{sub}}(>M_{\\mathrm{peak},1})}{n_{\\mathrm{host}}(>M_{\\mathrm{peak},1}) + n_{\\mathrm{sub}}(>M_{\\mathrm{peak},1})}$。\n使用幂律形式，我们可以用旧的数密度表示新的数密度：\n$n_{\\mathrm{host}}(>M_{\\mathrm{peak},1}) = n_{\\mathrm{host}}(>M_{\\mathrm{peak},0}) \\left(\\frac{M_{\\mathrm{peak},1}}{M_{\\mathrm{peak},0}}\\right)^{-\\gamma_{\\mathrm{h}}} = n_{\\mathrm{host},0} \\left(10^{\\Delta \\log M_{\\mathrm{peak}}}\\right)^{-\\gamma_{\\mathrm{h}}} = n_{\\mathrm{host},0} \\cdot 10^{-\\gamma_{\\mathrm{h}}\\Delta \\log M_{\\mathrm{peak}}}$。\n$n_{\\mathrm{sub}}(>M_{\\mathrm{peak},1}) = n_{\\mathrm{sub}}(>M_{\\mathrm{peak},0}) \\left(\\frac{M_{\\mathrm{peak},1}}{M_{\\mathrm{peak},0}}\\right)^{-\\gamma_{\\mathrm{s}}} = n_{\\mathrm{sub},0} \\left(10^{\\Delta \\log M_{\\mathrm{peak}}}\\right)^{-\\gamma_{\\mathrm{s}}} = n_{\\mathrm{sub},0} \\cdot 10^{-\\gamma_{\\mathrm{s}}\\Delta \\log M_{\\mathrm{peak}}}$。\n\n新的卫星分数是：\n$f_{\\mathrm{sat}} = \\frac{n_{\\mathrm{sub},0} \\cdot 10^{-\\gamma_{\\mathrm{s}}\\Delta \\log M_{\\mathrm{peak}}}}{n_{\\mathrm{host},0} \\cdot 10^{-\\gamma_{\\mathrm{h}}\\Delta \\log M_{\\mathrm{peak}}} + n_{\\mathrm{sub},0} \\cdot 10^{-\\gamma_{\\mathrm{s}}\\Delta \\log M_{\\mathrm{peak}}}}$。\n我们可以用 $f_{\\mathrm{sat},0}$ 和初始总丰度 $n_{\\mathrm{tot},0}$ 来表示 $n_{\\mathrm{host},0}$ 和 $n_{\\mathrm{sub},0}$：\n$n_{\\mathrm{sub},0} = f_{\\mathrm{sat},0} n_{\\mathrm{tot},0}$ 和 $n_{\\mathrm{host},0} = (1-f_{\\mathrm{sat},0}) n_{\\mathrm{tot},0}$。\n代入并消去 $n_{\\mathrm{tot},0}$：\n$f_{\\mathrm{sat}} = \\frac{f_{\\mathrm{sat},0} \\cdot 10^{-\\gamma_{\\mathrm{s}}\\Delta \\log M_{\\mathrm{peak}}}}{(1-f_{\\mathrm{sat},0}) \\cdot 10^{-\\gamma_{\\mathrm{h}}\\Delta \\log M_{\\mathrm{peak}}} + f_{\\mathrm{sat},0} \\cdot 10^{-\\gamma_{\\mathrm{s}}\\Delta \\log M_{\\mathrm{peak}}}}$。\n为了简化，将分子和分母同除以 $10^{-\\gamma_{\\mathrm{s}}\\Delta \\log M_{\\mathrm{peak}}}$：\n$f_{\\mathrm{sat}} = \\frac{f_{\\mathrm{sat},0}}{(1-f_{\\mathrm{sat},0}) \\cdot 10^{(\\gamma_{\\mathrm{s}}-\\gamma_{\\mathrm{h}})\\Delta \\log M_{\\mathrm{peak}}} + f_{\\mathrm{sat},0}}$。\n\n现在，我们代入数值：\n$f_{\\mathrm{sat},0} = 0.22$，$\\gamma_{\\mathrm{s}} - \\gamma_{\\mathrm{h}} = 1.2 - 0.9 = 0.3$，以及 $\\Delta \\log M_{\\mathrm{peak}} \\approx 0.16563147$。\n指数是 $(\\gamma_{\\mathrm{s}}-\\gamma_{\\mathrm{h}})\\Delta \\log M_{\\mathrm{peak}} = 0.3 \\times 0.16563147 \\approx 0.0496894$。\n指数项是 $10^{0.0496894} \\approx 1.12128$。\n分母是 $(1-0.22) \\times 1.12128 + 0.22 = 0.78 \\times 1.12128 + 0.22 \\approx 0.874598 + 0.22 = 1.094598$。\n$f_{\\mathrm{sat}} = \\frac{0.22}{1.094598} \\approx 0.20100488$。\n四舍五入到四位有效数字，新的卫星分数是 $f_{\\mathrm{sat}} = 0.2010$。\n\n最终结果是 $\\Delta \\log M_{\\mathrm{peak}} \\approx 0.1656$ 和 $f_{\\mathrm{sat}} \\approx 0.2010$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1656  0.2010\n\\end{pmatrix}\n}\n$$", "id": "3492426"}, {"introduction": "使用亚晕丰度匹配（SHAM）构建模拟星系表（mock catalog）的准确性，在很大程度上取决于N体模拟中暗晕表的完备性。然而，数值模拟在探测低质量亚晕时往往存在不完备性。这个练习 [@problem_id:3492412] 直面这一实际挑战，要求你基于一个简化的不完备性模型，推导观测到的卫星星系比例与真实值之间的关系，并提出修正方法。完成此练习有助于培养对模拟数据系统误差的洞察力，并掌握量化和修正这类偏差的关键技能。", "problem": "通过子晕丰度匹配 (Subhalo Abundance Matching, SHAM) 构建一个阈值选取的星系样本，假设恒星质量与子晕峰值圆周速度之间存在单调映射关系。设该选取由峰值圆周速度 $V_{\\rm cut}$ 处的一个截断定义，因此 $V_{\\rm peak} \\ge V_{\\rm cut}$ 的子晕承载了样本星系。卫星星系占比定义为 $f_{\\rm sat} \\equiv N_{\\rm sat}/(N_{\\rm cen}+N_{\\rm sat})$，其中 $N_{\\rm sat}$ 和 $N_{\\rm cen}$ 分别是卫星星系和中心星系的真实数量。\n\n一个低分辨率模拟在阈值附近存在子晕探测不完备性的问题，该问题使用更高分辨率的模拟进行校准。高分辨率校准表明了以下完备性模型：对于 $V_{\\rm peak} \\in [V_{\\rm cut}, (1+\\Delta)V_{\\rm cut}]$ 的卫星子晕，其探测概率为 $c_{\\rm s}=0.7$（即 $30\\%$ 的不完备性），而对于 $V_{\\rm peak} > (1+\\Delta)V_{\\rm cut}$，完备性为 $1$。在整个相关范围内，中心星系的探测是完备的。假设 $\\Delta = 0.1$。在 $V_{\\rm cut}$ 附近，累积卫星子晕速度函数可以很好地用局部幂律 $N_{\\rm sat}(>v) \\propto v^{-\\gamma}$ 来近似，其中 $\\gamma = 3$。在低分辨率模拟中测量得到的观测卫星星系占比为 $f_{\\rm sat}^{\\rm obs} = 0.22$。\n\n从 $f_{\\rm sat}$ 的定义和上述完备性模型出发，推导真实卫星星系占比 $f_{\\rm sat}^{\\rm true}$ 与观测占比 $f_{\\rm sat}^{\\rm obs}$ 之间的关系，并用它来估计由不完备性引起的偏差。然后，提出一种利用高分辨率校准从 $f_{\\rm sat}^{\\rm obs}$ 中恢复 $f_{\\rm sat}^{\\rm true}$ 的修正方法。在上述假设下，数值计算修正后的卫星星系占比 $f_{\\rm sat}^{\\rm true}$。将最终答案表示为四舍五入到四位有效数字的小数。", "solution": "我们首先建立观测到的卫星数量 $N_{\\mathrm{sat}}^{\\mathrm{obs}}$ 与真实数量 $N_{\\mathrm{sat}}^{\\mathrm{true}}$ 之间的关系。中心星系的探测是完备的，所以 $N_{\\mathrm{cen}}^{\\mathrm{obs}} = N_{\\mathrm{cen}}^{\\mathrm{true}}$。\n\n根据完备性模型，观测到的卫星数量是：\n$$N_{\\mathrm{sat}}^{\\mathrm{obs}}(>V_{\\mathrm{cut}}) = c_{\\mathrm{s}} \\left[ N_{\\mathrm{sat}}^{\\mathrm{true}}(>V_{\\mathrm{cut}}) - N_{\\mathrm{sat}}^{\\mathrm{true}}(>(1+\\Delta)V_{\\mathrm{cut}}) \\right] + N_{\\mathrm{sat}}^{\\mathrm{true}}(>(1+\\Delta)V_{\\mathrm{cut}})$$\n第一项表示在速度区间 $[V_{\\mathrm{cut}}, (1+\\Delta)V_{\\mathrm{cut}}]$ 内以概率 $c_{\\mathrm{s}}$ 探测到的卫星数量，第二项表示在速度大于 $(1+\\Delta)V_{\\mathrm{cut}}$ 时以概率 1 探测到的卫星数量。\n\n利用给定的幂律关系 $N_{\\mathrm{sat}}(>v) \\propto v^{-\\gamma}$，我们可以写出：\n$$N_{\\mathrm{sat}}^{\\mathrm{true}}(>(1+\\Delta)V_{\\mathrm{cut}}) = N_{\\mathrm{sat}}^{\\mathrm{true}}(>V_{\\mathrm{cut}}) \\cdot \\left(\\frac{(1+\\Delta)V_{\\mathrm{cut}}}{V_{\\mathrm{cut}}}\\right)^{-\\gamma} = N_{\\mathrm{sat}}^{\\mathrm{true}}(>V_{\\mathrm{cut}}) \\cdot (1+\\Delta)^{-\\gamma}$$\n\n将此关系代入 $N_{\\mathrm{sat}}^{\\mathrm{obs}}$ 的表达式中：\n$$N_{\\mathrm{sat}}^{\\mathrm{obs}} = c_{\\mathrm{s}} \\left[ N_{\\mathrm{sat}}^{\\mathrm{true}} - N_{\\mathrm{sat}}^{\\mathrm{true}}(1+\\Delta)^{-\\gamma} \\right] + N_{\\mathrm{sat}}^{\\mathrm{true}}(1+\\Delta)^{-\\gamma}$$\n$$N_{\\mathrm{sat}}^{\\mathrm{obs}} = N_{\\mathrm{sat}}^{\\mathrm{true}} \\left[ c_{\\mathrm{s}}(1 - (1+\\Delta)^{-\\gamma}) + (1+\\Delta)^{-\\gamma} \\right] = N_{\\mathrm{sat}}^{\\mathrm{true}} \\left[ c_{\\mathrm{s}} + (1 - c_{\\mathrm{s}})(1+\\Delta)^{-\\gamma} \\right]$$\n我们定义这个比例因子为 $R = \\frac{N_{\\mathrm{sat}}^{\\mathrm{obs}}}{N_{\\mathrm{sat}}^{\\mathrm{true}}} = c_{\\mathrm{s}} + (1-c_{\\mathrm{s}})(1+\\Delta)^{-\\gamma}$。\n\n接下来，我们利用卫星星系占比的定义。真实占比为 $f_{\\mathrm{sat}}^{\\mathrm{true}} = \\frac{N_{\\mathrm{sat}}^{\\mathrm{true}}}{N_{\\mathrm{cen}}^{\\mathrm{true}} + N_{\\mathrm{sat}}^{\\mathrm{true}}}$，观测占比为 $f_{\\mathrm{sat}}^{\\mathrm{obs}} = \\frac{N_{\\mathrm{sat}}^{\\mathrm{obs}}}{N_{\\mathrm{cen}}^{\\mathrm{obs}} + N_{\\mathrm{sat}}^{\\mathrm{obs}}} = \\frac{N_{\\mathrm{sat}}^{\\mathrm{obs}}}{N_{\\mathrm{cen}}^{\\mathrm{true}} + N_{\\mathrm{sat}}^{\\mathrm{obs}}}$。\n\n使用赔率（odds ratio）可以更方便地建立两者关系。真实赔率为 $O_{\\mathrm{true}} = \\frac{f_{\\mathrm{sat}}^{\\mathrm{true}}}{1-f_{\\mathrm{sat}}^{\\mathrm{true}}} = \\frac{N_{\\mathrm{sat}}^{\\mathrm{true}}}{N_{\\mathrm{cen}}^{\\mathrm{true}}}$。观测赔率为 $O_{\\mathrm{obs}} = \\frac{f_{\\mathrm{sat}}^{\\mathrm{obs}}}{1-f_{\\mathrm{sat}}^{\\mathrm{obs}}} = \\frac{N_{\\mathrm{sat}}^{\\mathrm{obs}}}{N_{\\mathrm{cen}}^{\\mathrm{true}}}$。\n它们之间的关系是：\n$$\\frac{O_{\\mathrm{obs}}}{O_{\\mathrm{true}}} = \\frac{N_{\\mathrm{sat}}^{\\mathrm{obs}}/N_{\\mathrm{cen}}^{\\mathrm{true}}}{N_{\\mathrm{sat}}^{\\mathrm{true}}/N_{\\mathrm{cen}}^{\\mathrm{true}}} = \\frac{N_{\\mathrm{sat}}^{\\mathrm{obs}}}{N_{\\mathrm{sat}}^{\\mathrm{true}}} = R$$\n因此，修正关系为 $O_{\\mathrm{true}} = O_{\\mathrm{obs}} / R$。由此，我们可以从观测值 $f_{\\mathrm{sat}}^{\\mathrm{obs}}$ 计算出真实值 $f_{\\mathrm{sat}}^{\\mathrm{true}}$：\n$$f_{\\mathrm{sat}}^{\\mathrm{true}} = \\frac{O_{\\mathrm{true}}}{1+O_{\\mathrm{true}}} = \\frac{O_{\\mathrm{obs}}/R}{1+O_{\\mathrm{obs}}/R}$$\n\n现在我们代入数值进行计算：\n给定参数为 $c_{\\mathrm{s}}=0.7$, $\\Delta=0.1$, $\\gamma=3$。\n$$R = 0.7 + (1-0.7)(1+0.1)^{-3} = 0.7 + 0.3 \\times (1.1)^{-3} = 0.7 + \\frac{0.3}{1.331} \\approx 0.7 + 0.2253944 \\approx 0.9253944$$\n观测到的卫星占比为 $f_{\\mathrm{sat}}^{\\mathrm{obs}} = 0.22$。对应的观测赔率为：\n$$O_{\\mathrm{obs}} = \\frac{0.22}{1-0.22} = \\frac{0.22}{0.78} \\approx 0.2820513$$\n真实的赔率为：\n$$O_{\\mathrm{true}} = \\frac{O_{\\mathrm{obs}}}{R} \\approx \\frac{0.2820513}{0.9253944} \\approx 0.3047904$$\n最后，计算真实的卫星星系占比：\n$$f_{\\mathrm{sat}}^{\\mathrm{true}} = \\frac{O_{\\mathrm{true}}}{1+O_{\\mathrm{true}}} \\approx \\frac{0.3047904}{1+0.3047904} \\approx 0.233590$$\n将结果四舍五入到四位有效数字，得到 $f_{\\mathrm{sat}}^{\\mathrm{true}} = 0.2336$。", "answer": "$$\\boxed{0.2336}$$", "id": "3492412"}, {"introduction": "在宇宙学模拟中，“暗晕”的定义并非绝对，而是依赖于所使用的暗晕寻找算法及其参数。本练习 [@problem_id:3492474] 探讨了改变一个常用的“朋友的朋友”（FoF）算法的关键参数——连接长度（linking length）——会如何影响暗晕质量函数，并进而改变SHAM的推断结果。通过推导一个重整化因子来消除这种算法依赖性，你将学会如何协调和统一来自不同暗晕表的结果，确保最终的科学结论不受分析流程中人为选择的影响。", "problem": "一个宇宙学 $N$ 体模拟通过“朋友的朋友”(Friends-of-Friends, FoF) 晕寻找器进行后处理。在 FoF 中，无量纲的连接长度 $b$（以平均粒子间距为单位）控制着结构的渗流：增加 $b$ 倾向于将邻近的超密度区合并成更大的宿主结构，而减小 $b$ 则倾向于将它们分裂开。在子晕丰度匹配 (Subhalo Abundance Matching, SHAM) 中，通过令累积数密度相等，将星系恒星质量 $M_{\\star}$ 赋给晕或子晕：将累积星系恒星质量函数 $n_{\\mathrm{gal}}(>M_{\\star})$ 与累积晕属性函数 $n_{\\mathrm{halo}}(>X)$ 进行匹配，其中 $X$ 是一个单调的晕属性（例如，峰值圆周速度或峰值质量）。\n\n考虑一个使用 FoF 连接长度 $b_{0}$ 构建的参考星表，它为属性 $X$ 生成了一个宿主累积分布 $n_{b_{0}}(>X)$。设 $X_{0}$ 是某个基准恒星质量 $M_{\\star,0}$ 下满足 $n_{\\mathrm{gal}}(>M_{\\star,0}) = n_{b_{0}}(>X_{0})$ 的 $X$ 值。现在用一个不同的连接长度 $b$ 重新处理同一次模拟，生成一个新的星表。根据经验，在 $X_{0}$ 附近观测到改变 $b$ 会产生两种稳健的效应：\n\n- 渗流导致的、高于任何局部阈值的独立宿主数量的减少，其量化为在 $X_{0}$ 邻域内，相对于 $b_{0}$，在 $b$ 时因合并而消失的宿主所占的比例 $f_{p}(b)$。\n- 该邻域内测得的宿主属性的乘法重标定，$X \\mapsto X_{b} = q(b)\\,X$，其中 $q(b) > 0$。\n\n假设在 $X_{0}$ 附近，函数 $n_{b_{0}}(>X)$ 是可微且单调的，并且其局部对数斜率\n$$\n\\gamma(X_{0}) \\equiv -\\left.\\frac{d\\ln n_{b_{0}}(>X)}{d\\ln X}\\right|_{X_{0}}\n$$\n在所关注的小区间内近似恒定。同时假设 $f_{p}(b)$ 和 $q(b)$ 在此区间内近似恒定。\n\n推导 $X$ 轴的一个乘法重整化因子 $r(b)$，使得在 $b$-星表中用 $X' = r(b)\\,X$ 替换 $X$ 后，可以在 $X_{0}$ 附近恢复到一阶精度下的等式\n$$\nn_{b}(>X') = n_{b_{0}}(>X)\n$$\n从而在 SHAM 中对于不同 $b$ 的选择下保持 $n_{\\mathrm{gal}}(>M_{\\star})$ 不变。将你的最终答案表示为 $r(b)$ 关于 $q(b)$、$f_{p}(b)$ 和 $\\gamma(X_{0})$ 的单个闭合形式解析表达式。不需要进行数值计算，最终表达式中也不应包含任何单位。", "solution": "经评估，问题陈述有效。其科学依据源于数值宇宙学、晕寻找算法（“朋友的朋友”）以及子晕丰度匹配（SHAM）技术的原理。该问题提法恰当，所有必要的量、假设和关系都已定义，从而能够得到唯一且有意义的解。语言客观精确，设定自洽一致。未发现任何满足无效标准的缺陷。因此，将推导解答。\n\n我们的目标是找到一个乘法重整化因子 $r(b)$，使得经过重标定的晕属性 $X' = r(b)X$ 能够在“朋友的朋友”(FoF) 连接长度 $b$ 的不同选择下保持丰度匹配关系不变。具体而言，我们要求在新星表（用连接长度 $b$ 生成）中，在 $X'$ 处评估的晕的累积数密度，等于参考星表（用连接长度 $b_0$ 生成）中，在原始属性值 $X$ 处评估的累积数密度。该条件表示为：\n$$\nn_{b}(>X') = n_{b_{0}}(>X)\n$$\n为进行推导，我们必须首先建立新累积函数 $n_{b}(>X)$ 和参考累积函数 $n_{b_{0}}(>X)$ 之间的关系。问题陈述了将连接长度从 $b_0$ 更改为 $b$ 的两种效应：\n\n1.  比例为 $f_{p}(b)$ 的宿主发生合并，从而从独立宿主星表中移除。这使得计数减少了因子 $(1 - f_{p}(b))$。\n2.  剩余宿主的测量属性 $X$ 被重标定为一个新值 $X_b = q(b)X$。\n\n让我们确定新星表中任意阈值 $\\tilde{X}$ 的累积数密度 $n_b(>\\tilde{X})$。如果一个晕的重标定属性 $X_b$ 大于 $\\tilde{X}$，那么它就被计入 $n_b(>\\tilde{X})$。使用重标定关系，该条件变为 $q(b)X > \\tilde{X}$，这等价于 $X > \\tilde{X}/q(b)$。这意味着对 $n_b(>\\tilde{X})$ 有贡献的晕，正是在参考 $b_0$ 星表中原始属性 $X$ 大于 $\\tilde{X}/q(b)$ 的那些晕。\n\n在参考星表中，这类晕的数密度是 $n_{b_{0}}(> \\tilde{X}/q(b))$。考虑到渗流导致的宿主损失，新星表中的数密度减少了比例 $f_p(b)$。因此，两个累积函数之间的关系是：\n$$\nn_b(>\\tilde{X}) = (1 - f_p(b)) n_{b_{0}}\\left(> \\frac{\\tilde{X}}{q(b)}\\right)\n$$\n现在，我们将所要求的条件应用于重整化属性 $X' = r(b)X$。我们在上述方程中设 $\\tilde{X} = X'$，并使其等于 $n_{b_{0}}(>X)$：\n$$\n(1 - f_p(b)) n_{b_{0}}\\left(> \\frac{X'}{q(b)}\\right) = n_{b_{0}}(>X)\n$$\n问题指明，参考累积函数的局部对数斜率 $\\gamma(X_{0}) \\equiv -\\frac{d\\ln n_{b_{0}}(>X)}{d\\ln X}$ 在 $X_0$ 处，在所关注的区间内是近似恒定的。这意味着 $n_{b_{0}}(>X)$ 在该区域可以近似为一个幂律：\n$$\nn_{b_{0}}(>X) \\propto X^{-\\gamma(X_{0})}\n$$\n为了在推导过程中简化符号，我们记 $\\gamma \\equiv \\gamma(X_0)$。比例常数是无关紧要的，因为它会被消掉。将此幂律形式代入我们的方程中：\n$$\n(1 - f_p(b)) \\left( \\frac{X'}{q(b)} \\right)^{-\\gamma} = (X)^{-\\gamma}\n$$\n现在，我们将 $X' = r(b)X$ 代入此表达式：\n$$\n(1 - f_p(b)) \\left( \\frac{r(b)X}{q(b)} \\right)^{-\\gamma} = X^{-\\gamma}\n$$\n我们可以分离各项：\n$$\n(1 - f_p(b)) (r(b))^{-\\gamma} (q(b))^{\\gamma} X^{-\\gamma} = X^{-\\gamma}\n$$\n假设 $X > 0$，我们可以消去两边的 $X^{-\\gamma}$ 项：\n$$\n(1 - f_p(b)) (r(b))^{-\\gamma} (q(b))^{\\gamma} = 1\n$$\n我们的目标是解出 $r(b)$。我们首先分离出包含 $r(b)$ 的项：\n$$\n(r(b))^{-\\gamma} = \\frac{1}{(1 - f_p(b)) (q(b))^{\\gamma}} = (1 - f_p(b))^{-1} (q(b))^{-\\gamma}\n$$\n为了解出 $r(b)$，我们将方程两边取 $-1/\\gamma$ 次幂：\n$$\nr(b) = \\left[ (1 - f_p(b))^{-1} (q(b))^{-\\gamma} \\right]^{-\\frac{1}{\\gamma}}\n$$\n将指数应用于括号内的每个因子：\n$$\nr(b) = \\left((1 - f_p(b))^{-1}\\right)^{-\\frac{1}{\\gamma}} \\left((q(b))^{-\\gamma}\\right)^{-\\frac{1}{\\gamma}}\n$$\n$$\nr(b) = (1 - f_p(b))^{\\frac{1}{\\gamma}} (q(b))^{1}\n$$\n代回 $\\gamma = \\gamma(X_0)$ 的完整定义，我们得到重整化因子的最终表达式：\n$$\nr(b) = q(b) \\left(1 - f_p(b)\\right)^{\\frac{1}{\\gamma(X_0)}}\n$$\n当将此因子 $r(b)$ 乘到由 FoF 连接长度 $b$ 生成的星表中的晕属性 $X$ 上时，它同时校正了属性值的变化和晕数量计数的变化，从而确保了通过 SHAM 推断的星系属性保持一致。", "answer": "$$\n\\boxed{q(b) \\left(1 - f_p(b)\\right)^{\\frac{1}{\\gamma(X_0)}}}\n$$", "id": "3492474"}]}