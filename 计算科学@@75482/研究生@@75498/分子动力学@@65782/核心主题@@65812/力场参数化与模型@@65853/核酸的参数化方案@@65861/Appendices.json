{"hands_on_practices": [{"introduction": "这个实践提供了一个基础练习，用于计算稳定核酸结构的非键相互作用能 [@problem_id:3430376]。通过将 Lennard-Jones 和库仑势函数应用于一个简化的二聚体模型，你将对范德华力和静电作用如何促成碱基堆积这一DNA中的关键现象，获得定量的理解。这种动手计算对于解释相互作用能和领会分子力场的物理基础至关重要。", "problem": "在分子动力学（MD）核酸参数化方案的背景下，考虑一个堆积的腺嘌呤-胸腺嘧啶二聚体的简化粗粒化双位点表示。每个核碱基由两个相互作用位点表示，其非键参数源自一个拟合量子力学目标数据的方案，并使用 Lorentz–Berthelot 混合规则将以原子为中心的范德华项与静电项相结合。假设碱基堆积是平行的，并以物理上合理的平面间距分开，横向偏移反映在给定的位点间距离中。使用标准的 $12-6$ Lennard–Jones 势、用于组合不同位点的 Lorentz–Berthelot 混合规则，以及点电荷的未屏蔽库仑相互作用。以千焦每摩尔 (kJ mol$^{-1}$)、纳米 (nm) 和元电荷 ($e$) 为单位的库仑常数是 $k_{\\mathrm{c}} = 138.935456 \\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$。能量必须以千焦每摩尔计算。\n\n这两个相互作用对及其参数如下：\n- 对 $1$：腺嘌呤位点 $A_1$ 和胸腺嘧啶位点 $T_1$\n  - 部分电荷：$q_{A_1} = -0.01\\,e$， $q_{T_1} = +0.01\\,e$\n  - Lennard–Jones 参数：$\\sigma_{A_1} = 0.340\\,\\mathrm{nm}$， $\\epsilon_{A_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$；$\\sigma_{T_1} = 0.340\\,\\mathrm{nm}$， $\\epsilon_{T_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n  - 位点间距：$r_1 = 0.350\\,\\mathrm{nm}$\n- 对 $2$：腺嘌呤位点 $A_2$ 和胸腺嘧啶位点 $T_2$\n  - 部分电荷：$q_{A_2} = -0.03\\,e$， $q_{T_2} = +0.03\\,e$\n  - Lennard–Jones 参数：$\\sigma_{A_2} = 0.325\\,\\mathrm{nm}$， $\\epsilon_{A_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$；$\\sigma_{T_2} = 0.296\\,\\mathrm{nm}$， $\\epsilon_{T_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n  - 位点间距：$r_2 = 0.370\\,\\mathrm{nm}$\n\n从 $12-6$ Lennard–Jones 势和库仑定律的基本定义出发，使用 Lorentz–Berthelot 混合规则获得每对的不同位点 Lennard–Jones 参数，然后计算 Lennard–Jones 贡献 $E_{\\mathrm{LJ}}$ 和库仑贡献 $E_{\\mathrm{C}}$ 对堆积二聚体相互作用能的贡献：\n- 计算并求和 $E_{\\mathrm{LJ},1}$ 和 $E_{\\mathrm{LJ},2}$ 以获得 $E_{\\mathrm{LJ}}$。\n- 计算并求和 $E_{\\mathrm{C},1}$ 和 $E_{\\mathrm{C},2}$ 以获得 $E_{\\mathrm{C}}$。\n\n最后，以单个标量的形式报告量值比 $R = \\left|E_{\\mathrm{LJ}}\\right| / \\left|E_{\\mathrm{C}}\\right|$，该比例定量评估了哪个项在稳定化中占主导地位。将您的最终值 $R$ 四舍五入到四位有效数字。将 $R$ 表示为无量纲数。", "solution": "该问题被评估为有效，因为它具有科学依据、提法明确、客观且内容完整。这是分子力学和生物物理化学领域的一个标准计算问题。所有必要的数据和常数都已提供，并且所需的计算也已明确说明。\n\n两个粗粒化核碱基之间的总相互作用能是 Lennard-Jones ($E_{\\mathrm{LJ}}$) 和库仑 ($E_{\\mathrm{C}}$) 贡献的总和。对两个相互作用对分别计算这些贡献，然后求和。\n\n两个相距为 $r$ 的位点之间的 Lennard-Jones 相互作用能 $E_{\\mathrm{LJ}}(r)$ 由 $12-6$ 势给出：\n$$E_{\\mathrm{LJ}}(r) = 4\\epsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6} \\right]$$\n其中 $\\sigma_{ij}$ 是势能为零时的距离，$\\epsilon_{ij}$ 是相互作用的位点对 $i$ 和 $j$ 的势阱深度。\n\n两个相距为 $r$ 的点电荷 $q_i$ 和 $q_j$ 之间的库仑相互作用能 $E_{\\mathrm{C}}(r)$ 由库仑定律给出：\n$$E_{\\mathrm{C}}(r) = k_{\\mathrm{c}} \\frac{q_i q_j}{r}$$\n其中 $k_{\\mathrm{c}}$ 是库仑常数，给定为 $k_{\\mathrm{c}} = 138.935456 \\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$。\n\n不同位点间相互作用的参数（$\\sigma_{ij}$ 和 $\\epsilon_{ij}$）是使用 Lorentz–Berthelot 混合规则根据单个位点的参数（$\\sigma_i$、$\\epsilon_i$ 和 $\\sigma_j$、$\\epsilon_j$）确定的：\n$\\sigma_{ij}$ 的算术平均值：\n$$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}$$\n$\\epsilon_{ij}$ 的几何平均值：\n$$\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$$\n\n我们现在将这些原理应用于每个相互作用对。\n\n对 $1$：腺嘌呤位点 $A_1$ 和胸腺嘧啶位点 $T_1$。\n给定参数为：\n$q_{A_1} = -0.01\\,e$, $q_{T_1} = +0.01\\,e$\n$\\sigma_{A_1} = 0.340\\,\\mathrm{nm}$, $\\epsilon_{A_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n$\\sigma_{T_1} = 0.340\\,\\mathrm{nm}$, $\\epsilon_{T_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n$r_1 = 0.350\\,\\mathrm{nm}$\n\n首先，我们计算 $A_1$-$T_1$ 对的混合 Lennard-Jones 参数：\n$\\sigma_1 = \\sigma_{A_1 T_1} = \\frac{\\sigma_{A_1} + \\sigma_{T_1}}{2} = \\frac{0.340\\,\\mathrm{nm} + 0.340\\,\\mathrm{nm}}{2} = 0.340\\,\\mathrm{nm}$\n$\\epsilon_1 = \\epsilon_{A_1 T_1} = \\sqrt{\\epsilon_{A_1} \\epsilon_{T_1}} = \\sqrt{(0.45\\,\\mathrm{kJ\\,mol^{-1}}) \\times (0.45\\,\\mathrm{kJ\\,mol^{-1}})} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n\n现在，我们计算对 $1$ 的 Lennard-Jones 能量：\n$E_{\\mathrm{LJ},1} = 4\\epsilon_1 \\left[ \\left(\\frac{\\sigma_1}{r_1}\\right)^{12} - \\left(\\frac{\\sigma_1}{r_1}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},1} = 4(0.45) \\left[ \\left(\\frac{0.340}{0.350}\\right)^{12} - \\left(\\frac{0.340}{0.350}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},1} = 1.8 \\left[ (0.971428...)^{12} - (0.971428...)^{6} \\right]$\n$E_{\\mathrm{LJ},1} = 1.8 [0.705315... - 0.839830...] = 1.8(-0.134515...) = -0.242127...\\,\\mathrm{kJ\\,mol^{-1}}$\n\n接下来，我们计算对 $1$ 的库仑能量：\n$E_{\\mathrm{C},1} = k_{\\mathrm{c}} \\frac{q_{A_1} q_{T_1}}{r_1} = (138.935456) \\frac{(-0.01\\,e)(+0.01\\,e)}{0.350\\,\\mathrm{nm}}$\n$E_{\\mathrm{C},1} = 138.935456 \\frac{-0.0001}{0.350} = -0.0396958...\\,\\mathrm{kJ\\,mol^{-1}}$\n\n对 $2$：腺嘌呤位点 $A_2$ 和胸腺嘧啶位点 $T_2$。\n给定参数为：\n$q_{A_2} = -0.03\\,e$, $q_{T_2} = +0.03\\,e$\n$\\sigma_{A_2} = 0.325\\,\\mathrm{nm}$, $\\epsilon_{A_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n$\\sigma_{T_2} = 0.296\\,\\mathrm{nm}$, $\\epsilon_{T_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n$r_2 = 0.370\\,\\mathrm{nm}$\n\n首先，我们计算 $A_2$-$T_2$ 对的混合 Lennard-Jones 参数：\n$\\sigma_2 = \\sigma_{A_2 T_2} = \\frac{\\sigma_{A_2} + \\sigma_{T_2}}{2} = \\frac{0.325\\,\\mathrm{nm} + 0.296\\,\\mathrm{nm}}{2} = 0.3105\\,\\mathrm{nm}$\n$\\epsilon_2 = \\epsilon_{A_2 T_2} = \\sqrt{\\epsilon_{A_2} \\epsilon_{T_2}} = \\sqrt{(0.30\\,\\mathrm{kJ\\,mol^{-1}}) \\times (0.30\\,\\mathrm{kJ\\,mol^{-1}})} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n\n现在，我们计算对 $2$ 的 Lennard-Jones 能量：\n$E_{\\mathrm{LJ},2} = 4\\epsilon_2 \\left[ \\left(\\frac{\\sigma_2}{r_2}\\right)^{12} - \\left(\\frac{\\sigma_2}{r_2}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},2} = 4(0.30) \\left[ \\left(\\frac{0.3105}{0.370}\\right)^{12} - \\left(\\frac{0.3105}{0.370}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},2} = 1.2 \\left[ (0.839189...)^{12} - (0.839189...)^{6} \\right]$\n$E_{\\mathrm{LJ},2} = 1.2 [0.121800... - 0.349000...] = 1.2(-0.227200...) = -0.272640...\\,\\mathrm{kJ\\,mol^{-1}}$\n\n接下来，我们计算对 $2$ 的库仑能量：\n$E_{\\mathrm{C},2} = k_{\\mathrm{c}} \\frac{q_{A_2} q_{T_2}}{r_2} = (138.935456) \\frac{(-0.03\\,e)(+0.03\\,e)}{0.370\\,\\mathrm{nm}}$\n$E_{\\mathrm{C},2} = 138.935456 \\frac{-0.0009}{0.370} = -0.338271...\\,\\mathrm{kJ\\,mol^{-1}}$\n\n总能量通过对每对的贡献求和得到。\n总 Lennard-Jones 能量：\n$E_{\\mathrm{LJ}} = E_{\\mathrm{LJ},1} + E_{\\mathrm{LJ},2} = (-0.242127...) + (-0.272640...) = -0.514767...\\,\\mathrm{kJ\\,mol^{-1}}$\n\n总库仑能量：\n$E_{\\mathrm{C}} = E_{\\mathrm{C},1} + E_{\\mathrm{C},2} = (-0.0396958...) + (-0.338271...) = -0.377967...\\,\\mathrm{kJ\\,mol^{-1}}$\n\n最后，我们计算量值比 $R = \\left|E_{\\mathrm{LJ}}\\right| / \\left|E_{\\mathrm{C}}\\right|$：\n$R = \\frac{|-0.514767...\\,\\mathrm{kJ\\,mol^{-1}}|}{|-0.377967...\\,\\mathrm{kJ\\,mol^{-1}}|}$\n$R = \\frac{0.514767...}{0.377967...} = 1.361937...$\n\n问题要求将 $R$ 的最终值四舍五入到四位有效数字。\n$R \\approx 1.362$\n该比值大于 $1$，表明在这个特定的粗粒化模型和几何结构中，Lennard-Jones 项对吸引稳定能的贡献大于静电项。", "answer": "$$\\boxed{1.362}$$", "id": "3430376"}, {"introduction": "这个实践模拟了力场开发中的一个核心工作流程：从量子力学（QM）数据中推导柔性二面角的参数 [@problem_id:3430386]。你将实现一个流程，为关键的糖苷键扭转角（$\\chi$）拟合一个经典扭转势，以匹配目标QM能量曲线。这个练习阐明了第一性原理计算的准确性如何被转移到大规模分子动力学模拟所需的高效函数形式中。", "problem": "您的任务是，从第一性原理出发，实现一个协议，利用提供的量子力学（QM）扫描来更新核酸糖苷扭转（$\\chi$）参数，并在测试模拟中量化这些更新后的参数如何改变构象热力学。目标背景是经典分子动力学和核酸参数化。\n\n基本原理：\n- 经典统计力学：对于具有势能 $U(\\chi)$ 的坐标 $\\chi$，其玻尔兹曼分布意味着概率密度 $p(\\chi) \\propto \\exp(-\\beta U(\\chi))$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- 经典力场通过傅里叶级数表示二面角的扭转势。对于 $\\chi$，其扭转项被建模为余弦级数分量的总和，每个分量都具有一个整数重数和一个待拟合确定的振幅。\n\n目标：\n给定糖苷扭转角 $\\chi$ 的一维QM能量扫描 $U_{\\mathrm{QM}}(\\chi)$，以及基线非扭转分子力学能量 $U_{0}(\\chi)$，估算更新后的扭转振幅，使其与 $U_{0}(\\chi)$ 结合时能最好地重现QM能量曲线。然后，根据更新后的总势能 $U_{\\mathrm{tot}}(\\chi) = U_{0}(\\chi) + V_{\\mathrm{tors}}(\\chi)$ 计算热力学度量。具体而言：\n- 通过在给定的网格点上最小化 $U_{\\mathrm{QM}}(\\chi)$ 与 $U_{0}(\\chi) + V_{\\mathrm{tors}}(\\chi)$ 之间的平方偏差，为一组预定义的重数拟合扭转振幅。\n- 根据 $U_{\\mathrm{tot}}(\\chi)$ 的玻尔兹曼加权积分，计算anti和syn构象区域之间的自由能差。\n- 计算anti和syn之间转换的能垒高度，其值为连接两个极小值点的最小弧路径上的最高能量与相应极小值点能量之差。\n\n使用的模型定义：\n- 使用形式为\n$$\nV_{\\mathrm{tors}}(\\chi) = \\sum_{n \\in \\mathcal{N}} \\frac{1}{2} k_{n} \\left(1 + \\cos(n \\chi)\\right),\n$$\n的扭转模型，其中 $\\mathcal{N}$ 是一组整数重数，$k_{n}$ 是待拟合的振幅。\n- 拟合准则是关于 $\\{k_{n}\\}_{n \\in \\mathcal{N}}$ 对\n$$\n\\sum_{i} \\left[ U_{\\mathrm{QM}}(\\chi_{i}) - U_{0}(\\chi_{i}) - V_{\\mathrm{tors}}(\\chi_{i}) \\right]^{2},\n$$\n进行最小二乘法最小化。\n- 区域 $\\mathcal{R}$ 的自由能为\n$$\nG(\\mathcal{R}) = -k_{\\mathrm{B}} T \\ln \\left( \\int_{\\chi \\in \\mathcal{R}} \\exp\\left[-\\beta U_{\\mathrm{tot}}(\\chi)\\right] \\, d\\chi \\right),\n$$\n需要报告的自由能差为\n$$\n\\Delta G = G(\\mathrm{syn}) - G(\\mathrm{anti}),\n$$\n单位为千卡/摩尔。\n- 定义沿连接 $U_{\\mathrm{tot}}(\\chi)$ 上anti和syn极小值点的最小弧路径的能垒高度为\n$$\n\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,anti}}),\n$$\n$$\n\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,syn}}),\n$$\n单位为千卡/摩尔，其中弧是圆上两条角度路径中较短的一条。\n\n角度单位和能量单位：\n- 所有角度 $\\chi$ 必须以弧度为单位。\n- 所有能量必须以千卡/摩尔（kcal/mol）为单位。\n- 使用 $T = 300$ 开尔文和 $k_{\\mathrm{B}} = 0.0019872041$ 千卡/摩尔/开尔文。\n\n区域定义：\n- Anti区域：$\\chi \\in \\left[-\\frac{5\\pi}{6}, -\\frac{\\pi}{3}\\right]$。\n- Syn区域：$\\chi \\in \\left[0, \\frac{7\\pi}{9}\\right]$。\n这些边界是核酸糖苷扭转构象异构体的典型值，并为anti和syn构象提供了科学上合理的窗口。\n\n数值实现要求：\n- 使用提供的网格点和模型，通过线性最小二乘法进行拟合。\n- 在 $\\chi$ 网格上使用梯形法则进行数值积分。\n- 通过在限制于相应区域的网格上扫描 $U_{\\mathrm{tot}}(\\chi)$ 来识别每个区域的极小值点。\n\n测试套件：\n实现您的程序以解决以下三个测试用例。在所有情况下，使用一个包含 $N=72$ 个角度 $\\chi_{i}$ 的均匀网格，范围为 $[-\\pi, \\pi)$，即 $\\chi_{i} = -\\pi + \\frac{2\\pi i}{N}$，其中 $i \\in \\{0,1,\\dots,N-1\\}$。\n\n- 测试用例1：重数集 $\\mathcal{N} = \\{1,2,3\\}$。基线 $U_{0}(\\chi) = a_{0} + a_{1} \\cos(\\chi)$，其中 $a_{0} = 0.5$，$a_{1} = 0.1$。QM扫描为\n$$\nU_{\\mathrm{QM}}(\\chi) = 1.2 + 1.8\\left(1 + \\cos(\\chi)\\right) + 0.6\\left(1 + \\cos(3\\chi)\\right) + 0.2 \\cos(2\\chi).\n$$\n\n- 测试用例2：重数集 $\\mathcal{N} = \\{1,2,3\\}$。基线 $U_{0}(\\chi) = a_{0} + a_{1} \\cos(\\chi)$，其中 $a_{0} = 0.3$，$a_{1} = 0.2$。QM扫描为\n$$\nU_{\\mathrm{QM}}(\\chi) = 0.8 + 0.2\\left(1 + \\cos(\\chi)\\right) + 2.5\\left(1 + \\cos(3\\chi)\\right) + 0.4 \\cos(2\\chi) + 0.2 \\cos(4\\chi).\n$$\n\n- 测试用例3：重数集 $\\mathcal{N} = \\{1,2,3\\}$。基线 $U_{0}(\\chi) = a_{0} + a_{1} \\cos(\\chi)$，其中 $a_{0} = 0.4$，$a_{1} = -0.05$。QM扫描为\n$$\nU_{\\mathrm{QM}}(\\chi) = 0.4 + 0.05\\left(1 + \\cos(\\chi)\\right) + 0.08\\left(1 + \\cos(3\\chi)\\right) + 0.02 \\cos(2\\chi).\n$$\n\n所需输出：\n对于每个测试用例，计算并返回一个列表，其中包含：\n- 按顺序排列的拟合振幅 $k_{1}$、$k_{2}$、$k_{3}$。\n- 自由能差 $\\Delta G$（单位：千卡/摩尔）。\n- 能垒高度 $\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}}$（单位：千卡/摩尔）。\n- 能垒高度 $\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}}$（单位：千卡/摩尔）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个测试用例的结果，格式为用方括号括起来的逗号分隔列表，不含空格，具体格式如下：\n$$\n\\left[\\left[k_{1},k_{2},k_{3},\\Delta G,\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}},\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}}\\right],\\left[\\cdots\\right],\\left[\\cdots\\right]\\right]\n$$\n其中每个数值条目都是一个十进制浮点数。例如，打印的行应类似于\n$$\n\\left[[0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0]\\right],\n$$\n但用您计算的值替换零。\n\n科学真实性：所有定义和参数选择均在核酸扭转参数化和经典分子动力学的标准实践范围内。角度使用弧度，能量使用千卡/摩尔。您的算法必须是确定性的和自包含的，无需外部文件或输入。", "solution": "该问题要求实现一个计算协议，以优化核酸糖苷角 $\\chi$ 的扭转参数，并随后分析此优化的热力学后果。该过程涉及将扭转势模型拟合到量子力学（QM）数据，然后使用得到的总势能面来计算构象自由能和过渡能垒。\n\n该程序针对三个不同的测试用例执行，每个用例都有其自己的QM能量扫描和基线分子力学（MM）能量。解决方案分为三个主要的计算阶段：（1）通过线性最小二乘法进行参数拟合，（2）计算*syn*和*anti*构象之间的自由能差 $\\Delta G$，以及（3）计算这两种状态之间转换的能垒 $\\Delta E$。\n\n首先，我们建立计算环境。角度 $\\chi$ 在一个包含 $N=72$ 个点的均匀网格上离散化，该网格跨越区间 $[-\\pi, \\pi)$。网格点由 $\\chi_{i} = -\\pi + \\frac{2\\pi i}{N}$ 给出，其中 $i=0, 1, \\dots, N-1$。所有能量单位均为千卡/摩尔（kcal/mol），角度单位为弧度。温度设定为 $T=300$ K，玻尔兹曼常数为 $k_{\\mathrm{B}} = 0.0019872041$ kcal mol$^{-1}$ K$^{-1}$。逆热能 $\\beta = 1/(k_{\\mathrm{B}}T)$ 是一个反复出现的因子。\n\n**1. 扭转参数拟合**\n\n主要目标是确定势能函数中一组扭转重数 $\\mathcal{N} = \\{1, 2, 3\\}$ 的振幅 $\\{k_{n}\\}$：\n$$\nV_{\\mathrm{tors}}(\\chi) = \\sum_{n \\in \\mathcal{N}} \\frac{1}{2} k_{n} \\left(1 + \\cos(n \\chi)\\right)\n$$\n总势能是基线非扭转能量 $U_{0}(\\chi)$ 和这个新的扭转项之和：$U_{\\mathrm{tot}}(\\chi) = U_{0}(\\chi) + V_{\\mathrm{tors}}(\\chi)$。振幅 $\\{k_n\\}$ 是通过在网格点 $\\{\\chi_i\\}$ 上最小化目标QM能量曲线 $U_{\\mathrm{QM}}(\\chi)$ 与 $U_{\\mathrm{tot}}(\\chi)$ 之间的平方差之和来找到的。\n目标是最小化残差平方和 $S$：\n$$\nS = \\sum_{i} \\left[ U_{\\mathrm{QM}}(\\chi_{i}) - \\left(U_{0}(\\chi_{i}) + V_{\\mathrm{tors}}(\\chi_{i})\\right) \\right]^{2}\n$$\n让我们定义一个目标能量校正 $Y(\\chi) = U_{\\mathrm{QM}}(\\chi) - U_{0}(\\chi)$。问题简化为用模型 $V_{\\mathrm{tors}}(\\chi)$ 拟合 $Y(\\chi)$：\n$$\nY(\\chi) \\approx \\sum_{n \\in \\mathcal{N}} k_n \\left( \\frac{1}{2}(1 + \\cos(n\\chi)) \\right)\n$$\n这是一个线性最小二乘问题。设 $\\mathbf{y}$ 是一个元素为 $y_i = Y(\\chi_i)$ 的向量，设 $\\mathbf{k}$ 是未知振幅的向量 $[k_1, k_2, k_3]^T$。设 $\\mathbf{A}$ 为设计矩阵，其中每一列对应于在网格点上求值的基函数。$\\mathbf{A}$ 的元素为 $A_{in} = \\frac{1}{2}(1 + \\cos(n\\chi_i))$，其中 $n \\in \\{1, 2, 3\\}$。问题是找到最小化 $\\|\\mathbf{A}\\mathbf{k} - \\mathbf{y}\\|_2^2$ 的 $\\mathbf{k}$。这可以使用标准的线性最小二乘求解器来解决，例如 `numpy.linalg.lstsq` 提供的求解器。\n\n**2. 自由能差计算**\n\n一旦确定了最优振幅 $\\{k_n\\}$，整个网格上的总势能 $U_{\\mathrm{tot}}(\\chi)$ 就完全确定了。*syn*和*anti*构象的相对稳定性通过自由能差 $\\Delta G = G(\\mathrm{syn}) - G(\\mathrm{anti})$ 来量化。在角度区域 $\\mathcal{R}$ 上定义的构象态的自由能由下式给出：\n$$\nG(\\mathcal{R}) = -k_{\\mathrm{B}} T \\ln \\left( Z_{\\mathcal{R}} \\right) = -k_{\\mathrm{B}} T \\ln \\left( \\int_{\\chi \\in \\mathcal{R}} e^{-\\beta U_{\\mathrm{tot}}(\\chi)} \\, d\\chi \\right)\n$$\n其中 $Z_{\\mathcal{R}}$ 是该区域的配分函数。那么自由能差为：\n$$\n\\Delta G = -k_{\\mathrm{B}} T \\ln\\left(\\frac{Z_{\\mathrm{syn}}}{Z_{\\mathrm{anti}}}\\right)\n$$\n区域定义为 $\\mathcal{R}_{\\mathrm{anti}} = [-\\frac{5\\pi}{6}, -\\frac{\\pi}{3}]$ 和 $\\mathcal{R}_{\\mathrm{syn}} = [0, \\frac{7\\pi}{9}]$。积分是通过在落入各自区域的网格点 $\\{\\chi_i\\}$ 上使用梯形法则进行数值计算的。具体来说，我们在每个网格点计算玻尔兹曼加权被积函数 $p(\\chi_i) = \\exp(-\\beta U_{\\mathrm{tot}}(\\chi_i))$，然后对每个区域中的角度对这个离散函数进行积分。\n\n**3. 过渡能垒高度计算**\n\n*anti*和*syn*态之间转换的能垒是从总势能面 $U_{\\mathrm{tot}}(\\chi)$ 计算得出的。首先，通过分别在*anti*和*syn*区域内所有网格点 $\\chi_i$ 中找到 $U_{\\mathrm{tot}}(\\chi_i)$ 的最小值，来定位每个状态的能量极小值点 $U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,anti}})$ 和 $U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,syn}})$。设这些极小值点处的角度为 $\\chi_{\\mathrm{min,anti}}$ 和 $\\chi_{\\mathrm{min,syn}}$。\n\n这两个极小值点之间的过渡路径取为周期性域 $[-\\pi, \\pi)$ 上两条可能弧线中较短的一条。设两个极小值点角度为 $\\alpha_1$ 和 $\\alpha_2$。如果 $|\\alpha_1 - \\alpha_2| \\le \\pi$，则较短的弧是它们之间的角度集合；否则，是“环绕”圆周的角度集合。沿此离散路径的最高能量点 $\\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi)$ 被识别出来。然后，能垒高度计算为该最大能量与每个极小值点能量之差：\n$$\n\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,anti}})\n$$\n$$\n\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,syn}})\n$$\n整个协议依次应用于提供的三个测试用例，并为每个用例收集六个所需的输出值（$k_1$、$k_2$、$k_3$、$\\Delta G$、$\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}}$、$\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}}$）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a protocol to update and analyze nucleic acid glycosidic torsion parameters.\n\n    This function executes a three-step process for each of the provided test cases:\n    1. Fits torsional potential amplitudes (k_n) to a quantum mechanics (QM) energy scan\n       using linear least squares.\n    2. Calculates the free energy difference (ΔG) between the 'anti' and 'syn' conformers\n       based on the newly parameterized potential.\n    3. Computes the energy barriers (ΔE) for transitions between these conformers.\n    \n    The final results for all test cases are formatted and printed as a single line,\n    adhering to the problem's specified output format.\n    \"\"\"\n\n    # --- Global Constants and Definitions ---\n    T = 300.0  # Kelvin\n    KB = 0.0019872041  # kcal/mol/K\n    BETA = 1.0 / (KB * T)\n    N = 72  # Number of grid points\n\n    # Angle grid in radians\n    chi = np.linspace(-np.pi, np.pi, N, endpoint=False)\n\n    # Region definitions in radians\n    anti_region = (-5 * np.pi / 6, -np.pi / 3)\n    syn_region = (0, 7 * np.pi / 9)\n\n    # Multiplicities for the torsional model\n    multiplicities = np.array([1, 2, 3])\n\n    test_cases = [\n        {\n            \"a0\": 0.5, \"a1\": 0.1,\n            \"u_qm_func\": lambda c: 1.2 + 1.8 * (1 + np.cos(c)) + 0.6 * (1 + np.cos(3 * c)) + 0.2 * np.cos(2 * c)\n        },\n        {\n            \"a0\": 0.3, \"a1\": 0.2,\n            \"u_qm_func\": lambda c: 0.8 + 0.2 * (1 + np.cos(c)) + 2.5 * (1 + np.cos(3 * c)) + 0.4 * np.cos(2 * c) + 0.2 * np.cos(4 * c)\n        },\n        {\n            \"a0\": 0.4, \"a1\": -0.05,\n            \"u_qm_func\": lambda c: 0.4 + 0.05 * (1 + np.cos(c)) + 0.08 * (1 + np.cos(3 * c)) + 0.02 * np.cos(2 * c)\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # --- Step 1: Parameter Fitting ---\n        u0_func = lambda c: case[\"a0\"] + case[\"a1\"] * np.cos(c)\n        u_qm_func = case[\"u_qm_func\"]\n\n        u0 = u0_func(chi)\n        u_qm = u_qm_func(chi)\n\n        # Target for fitting\n        y = u_qm - u0\n\n        # Design matrix A for V_tors = A * k\n        A = np.zeros((N, len(multiplicities)))\n        for i, n in enumerate(multiplicities):\n            A[:, i] = 0.5 * (1 + np.cos(n * chi))\n\n        # Solve the linear least-squares problem: A*k = y\n        k_fit, _, _, _ = np.linalg.lstsq(A, y, rcond=None)\n        k1, k2, k3 = k_fit\n\n        # Reconstruct the total potential with fitted parameters\n        v_tors = np.dot(A, k_fit)\n        u_tot = u0 + v_tors\n\n        # --- Step 2: Free Energy Difference ---\n        integrand = np.exp(-BETA * u_tot)\n\n        anti_mask = (chi >= anti_region[0]) & (chi <= anti_region[1])\n        syn_mask = (chi >= syn_region[0]) & (chi <= syn_region[1])\n\n        integral_anti = np.trapz(integrand[anti_mask], x=chi[anti_mask])\n        integral_syn = np.trapz(integrand[syn_mask], x=chi[syn_mask])\n\n        # Avoid log(0) or division by zero\n        if integral_anti <= 0 or integral_syn <= 0:\n            delta_g = np.nan\n        else:\n            delta_g = -(1.0 / BETA) * np.log(integral_syn / integral_anti)\n\n        # --- Step 3: Barrier Height Calculation ---\n        # Find minima in each region\n        u_anti_region = u_tot[anti_mask]\n        chi_anti_region = chi[anti_mask]\n        min_idx_anti = np.argmin(u_anti_region)\n        u_min_anti = u_anti_region[min_idx_anti]\n        chi_min_anti = chi_anti_region[min_idx_anti]\n\n        u_syn_region = u_tot[syn_mask]\n        chi_syn_region = chi[syn_mask]\n        min_idx_syn = np.argmin(u_syn_region)\n        u_min_syn = u_syn_region[min_idx_syn]\n        chi_min_syn = chi_syn_region[min_idx_syn]\n        \n        # Identify the shorter arc between the two minima\n        angle1 = min(chi_min_anti, chi_min_syn)\n        angle2 = max(chi_min_anti, chi_min_syn)\n\n        if (angle2 - angle1) <= np.pi:\n            # The direct path is shorter\n            arc_mask = (chi >= angle1) & (chi <= angle2)\n        else:\n            # The path \"wrapping around\" is shorter\n            arc_mask = (chi <= angle1) | (chi >= angle2)\n            \n        # Find the maximum energy on the arc\n        u_max_arc = np.max(u_tot[arc_mask])\n\n        # Calculate barrier heights\n        delta_e_anti_to_syn = u_max_arc - u_min_anti\n        delta_e_syn_to_anti = u_max_arc - u_min_syn\n\n        case_results = [k1, k2, k3, delta_g, delta_e_anti_to_syn, delta_e_syn_to_anti]\n        all_results.append(case_results)\n\n    # --- Final Output Formatting ---\n    result_strings = []\n    for res_list in all_results:\n        # Format individual list to \"[v1,v2,v3,...]\"\n        result_strings.append(f\"[{','.join(map(str, res_list))}]\")\n    \n    # Format all lists into \"[[...],[...],...]\"\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3430386"}, {"introduction": "一个力场的最终验证在于其再现实验测量结果的能力。这个实践通过探究1-4非键相互作用缩放因子如何影响核糖环的构象系综，来展示这一关键的验证步骤 [@problem_id:3430408]。你将计算产生的构象布居，并预测系综平均的NMR J-耦合常数，从而将你的计算模型与实验数据直接进行比较，并学习如何优化参数以实现物理真实性。", "problem": "您的任务是编写一个完整、可运行的程序，该程序需模拟 1–4 非键相互作用缩放对核糖环构象平衡以及系综平均核磁共振 (NMR) 标量耦合的影响，采用一种简化但有科学依据的方案，该方案与核酸分子动力学 (MD) 力场的参数化流程一致。\n\n您必须使用的基本原理包括：(i) 通过玻尔兹曼分布的经典统计力学，(ii) 用于系综平均的叠加原理，以及 (iii) 用于 NMR 中邻位标量耦合的 Karplus 关系式。基于这些原理，推导出计算作为能量函数的系综布居数以及从这些布居数计算平均可观测量的算法。\n\n假设核糖环的赝旋转存在一个三态构象模型，构象异构体由 $i \\in \\{1,2,3\\}$ 标记，其中 $i=1$ 对应 C3′-内型，$i=2$ 对应 C2′-内型，$i=3$ 对应 O4′-内型。在给定的 1–4 缩放条件下，构象异构体 $i$ 的总势能为\n$$\nE_i(S_\\text{elec}, S_\\text{LJ}) \\;=\\; E_i^{(0)} \\;+\\; S_\\text{elec}\\,E_{i,\\text{elec}}^{(1\\text{–}4)} \\;+\\; S_\\text{LJ}\\,E_{i,\\text{LJ}}^{(1\\text{–}4)},\n$$\n其中 $E_i^{(0)}$ 是构象异构体 $i$ 不包括 1–4 非键项的基线分子内能量，$E_{i,\\text{elec}}^{(1\\text{–}4)}$ 和 $E_{i,\\text{LJ}}^{(1\\text{–}4)}$ 是构象异构体 $i$ 的静电和 Lennard-Jones (LJ) 1–4 相互作用贡献，而 $S_\\text{elec}$ 和 $S_\\text{LJ}$ 分别是静电和 Lennard-Jones 1–4 缩放因子。\n\n使用以下物理上合理的参数，能量单位为千焦耳/摩尔，温度单位为开尔文：\n- 温度 $T = 298$。\n- 气体常数 $R = 8.314462618\\times 10^{-3}$。\n- 基线能量：$E_1^{(0)} = 0.0$, $E_2^{(0)} = 0.8$, $E_3^{(0)} = 4.0$。\n- 静电 1–4 项：$E_{1,\\text{elec}}^{(1\\text{–}4)} = -0.6$, $E_{2,\\text{elec}}^{(1\\text{–}4)} = -0.2$, $E_{3,\\text{elec}}^{(1\\text{–}4)} = -0.1$。\n- Lennard-Jones 1–4 项：$E_{1,\\text{LJ}}^{(1\\text{–}4)} = 0.4$, $E_{2,\\text{LJ}}^{(1\\text{–}4)} = 0.1$, $E_{3,\\text{LJ}}^{(1\\text{–}4)} = 0.2$。\n\n设两种邻位质子-质子耦合的构象异构体特异性二面角（单位：度）为：\n- 对于 $\\,^3J_{\\text{H1′–H2′}}$: $\\varphi_{12}^{(1)} = 60$, $\\varphi_{12}^{(2)} = 180$, $\\varphi_{12}^{(3)} = 300$。\n- 对于 $\\,^3J_{\\text{H3′–H4′}}$: $\\varphi_{34}^{(1)} = 180$, $\\varphi_{34}^{(2)} = 60$, $\\varphi_{34}^{(3)} = 300$。\n\n使用形式如下的 Karplus 关系式计算邻位耦合\n$$\nJ(\\varphi) \\;=\\; A\\cos^2(\\varphi) \\;+\\; B\\cos(\\varphi) \\;+\\; C,\n$$\n参数为 $A = 7.09$, $B = -1.42$, $C = 1.77$，并在计算余弦函数时将 $\\varphi$ 解释为弧度。计算出的 $J$ 值单位必须为赫兹。对于每个构象异构体 $i$，耦合值为 $J_{12}^{(i)} = J(\\varphi_{12}^{(i)})$ 和 $J_{34}^{(i)} = J(\\varphi_{34}^{(i)})$。\n\n构象异构体的布居数由玻尔兹曼分布确定。定义 $\\beta = 1/(RT)$ 和未归一化权重 $w_i = \\exp\\!\\big(-\\beta\\,E_i(S_\\text{elec}, S_\\text{LJ})\\big)$。构象异构体 $i$ 的归一化布居数为 $p_i = w_i / \\sum_{j=1}^{3} w_j$。系综平均耦合为\n$$\n\\langle J_{12} \\rangle \\;=\\; \\sum_{i=1}^{3} p_i\\,J_{12}^{(i)}, \n\\qquad\n\\langle J_{34} \\rangle \\;=\\; \\sum_{i=1}^{3} p_i\\,J_{34}^{(i)}.\n$$\n\n将这些系综平均耦合与固定的实验参考值（单位：赫兹）进行比较：\n- $J_{12}^{\\text{(exp)}} = 5.50$,\n- $J_{34}^{\\text{(exp)}} = 6.90$.\n\n按以下公式计算均方根误差 (RMSE)，单位为赫兹\n$$\n\\text{RMSE} \\;=\\; \\sqrt{\\tfrac{1}{2}\\left(\\left(\\langle J_{12} \\rangle - J_{12}^{\\text{(exp)}}\\right)^2 + \\left(\\langle J_{34} \\rangle - J_{34}^{\\text{(exp)}}\\right)^2\\right)}.\n$$\n\n您的程序必须为每个指定的测试用例计算 RMSE（单位：赫兹），结果为浮点数。输入中的角度必须以度为单位处理，但在进行三角函数求值时需转换为弧度；能量必须以千焦耳/摩尔为单位处理。使用 $T = 298$ 和 $R = 8.314462618\\times 10^{-3}$ 计算 $\\beta$，并以赫兹为单位将最终的 RMSE 结果表示为浮点数。\n\n测试集：评估以下四对缩放参数 $(S_\\text{elec}, S_\\text{LJ})$：\n1. $(1.0, 1.0)$,\n2. $(0.8333333333, 0.5)$,\n3. $(0.0, 0.0)$,\n4. $(1.2, 1.2)$.\n\n最终输出格式：您的程序应生成单行输出，其中包含四个 RMSE 结果，顺序与上述测试用例相同，形式为用方括号括起来的逗号分隔列表，例如 `[r_1,r_2,r_3,r_4]`。每个 $r_k$ 必须是一个浮点数。不应打印任何其他文本。所有数值答案均以赫兹为单位，并且必须在此单行输出上表示为十进制浮点值。", "solution": "该问题已经过验证，被确定为科学上合理、定义明确且完整。为获得唯一且有意义的解，所有必需的数据和定义均已提供。该问题模拟了计算生物物理学中用于力场参数化的一个标准流程，其基础是统计力学原理及其在结构生物学中的应用。\n\n解将通过系统地应用所提供的原理和方程推导得出。目标是为一组缩放参数 $(S_\\text{elec}, S_\\text{LJ})$ 计算计算所得的与实验所得的 NMR J-耦合之间的均方根误差 (RMSE)。该框架涉及一个用于核糖环构象的三态模型。\n\n首先，我们确定整个计算过程中使用的常数。给定温度 $T = 298 \\text{ K}$，气体常数 $R = 8.314462618 \\times 10^{-3} \\text{ kJ mol}^{-1} \\text{K}^{-1}$。由此，我们定义热能项 $\\beta = 1/(RT)$。\n$$\n\\beta = \\frac{1}{RT} = \\frac{1}{(8.314462618 \\times 10^{-3} \\text{ kJ mol}^{-1} \\text{K}^{-1}) \\times (298 \\text{ K})} \\approx 0.403597 \\text{ mol kJ}^{-1}\n$$\n\n该模型的核心包含三个不同的构象态，由 $i \\in \\{1, 2, 3\\}$ 索引。每个态 $i$ 的势能是 1–4 非键相互作用缩放因子 $S_\\text{elec}$ 和 $S_\\text{LJ}$ 的函数。能量由以下线性组合给出：\n$$\nE_i(S_\\text{elec}, S_\\text{LJ}) = E_i^{(0)} + S_\\text{elec}\\,E_{i,\\text{elec}}^{(1\\text{–}4)} + S_\\text{LJ}\\,E_{i,\\text{LJ}}^{(1\\text{–}4)}\n$$\n此处，$E_i^{(0)}$ 是基线能量，$E_{i,\\text{elec}}^{(1\\text{–}4)}$ 和 $E_{i,\\text{LJ}}^{(1\\text{–}4)}$ 分别是静电和 Lennard-Jones 1–4 相互作用能。为这三个态提供的参数如下（单位均为 kJ/mol）：\n- 态 $i=1$ (C3′-内型): $E_1^{(0)} = 0.0$, $E_{1,\\text{elec}}^{(1\\text{–}4)} = -0.6$, $E_{1,\\text{LJ}}^{(1\\text{–}4)} = 0.4$。\n- 态 $i=2$ (C2′-内型): $E_2^{(0)} = 0.8$, $E_{2,\\text{elec}}^{(1\\text{–}4)} = -0.2$, $E_{2,\\text{LJ}}^{(1\\text{–}4)} = 0.1$。\n- 态 $i=3$ (O4′-内型): $E_3^{(0)} = 4.0$, $E_{3,\\text{elec}}^{(1\\text{–}4)} = -0.1$, $E_{3,\\text{LJ}}^{(1\\text{–}4)} = 0.2$。\n\n根据统计力学原理，每个态 $i$ 在热平衡时的布居数 $p_i$ 由其玻尔兹曼权重决定。未归一化权重 $w_i$ 根据态的能量 $E_i$ 计算得出：\n$$\nw_i = \\exp(-\\beta E_i)\n$$\n然后，通过将单个权重除以所有权重之和（即配分函数 $Z = \\sum_{j=1}^{3} w_j$），可得到归一化布居数 $p_i$：\n$$\np_i = \\frac{w_i}{\\sum_{j=1}^{3} w_j}\n$$\n布居数依赖于缩放因子 $(S_\\text{elec}, S_\\text{LJ})$，因为能量 $E_i$ 依赖于它们。\n\n接下来，我们将每个构象异构体的结构与一个可观测量——NMR 标量耦合 $J$ 联系起来。Karplus 关系式提供了一个函数，可将邻位二面角 $\\varphi$ 映射到一个 J-耦合值：\n$$\nJ(\\varphi) = A\\cos^2(\\varphi) + B\\cos(\\varphi) + C\n$$\n给定参数为 $A = 7.09$, $B = -1.42$, $C = 1.77$。输入的二面角以度为单位，在计算余弦函数时必须通过 $\\varphi_{\\text{rad}} = \\varphi_{\\text{deg}} \\times \\pi / 180$ 转换为弧度。\n\n问题定义了两种特定的耦合 $\\,^3J_{\\text{H1′–H2′}}$ 和 $\\,^3J_{\\text{H3′–H4′}}$，它们取决于每个态 $i$ 的二面角 $\\varphi_{12}^{(i)}$ 和 $\\varphi_{34}^{(i)}$。我们预先计算这些态特异性的耦合值 $J_{12}^{(i)}$ 和 $J_{34}^{(i)}$，因为它们与缩放因子无关。\n\n对于 $\\,^3J_{\\text{H1′–H2′}}$:\n- $J_{12}^{(1)} = J(60^\\circ) = J(\\pi/3 \\text{ rad}) = 7.09\\cos^2(\\pi/3) - 1.42\\cos(\\pi/3) + 1.77 = 7.09(0.5)^2 - 1.42(0.5) + 1.77 = 2.8325 \\text{ Hz}$。\n- $J_{12}^{(2)} = J(180^\\circ) = J(\\pi \\text{ rad}) = 7.09\\cos^2(\\pi) - 1.42\\cos(\\pi) + 1.77 = 7.09(-1)^2 - 1.42(-1) + 1.77 = 10.28 \\text{ Hz}$。\n- $J_{12}^{(3)} = J(300^\\circ) = J(5\\pi/3 \\text{ rad}) = 7.09\\cos^2(5\\pi/3) - 1.42\\cos(5\\pi/3) + 1.77 = 7.09(0.5)^2 - 1.42(0.5) + 1.77 = 2.8325 \\text{ Hz}$。\n\n对于 $\\,^3J_{\\text{H3′–H4′}}$:\n- $J_{34}^{(1)} = J(180^\\circ) = 10.28 \\text{ Hz}$。\n- $J_{34}^{(2)} = J(60^\\circ) = 2.8325 \\text{ Hz}$。\n- $J_{34}^{(3)} = J(300^\\circ) = 2.8325 \\text{ Hz}$。\n\n实验测得的 J-耦合是所有热力学可及构象的系综平均值。系综平均耦合 $\\langle J_{12} \\rangle$ 和 $\\langle J_{34} \\rangle$ 计算为态特异性耦合的加权平均值，其中权重为布居数 $p_i$：\n$$\n\\langle J_{12} \\rangle = \\sum_{i=1}^{3} p_i J_{12}^{(i)}\n\\qquad\n\\langle J_{34} \\rangle = \\sum_{i=1}^{3} p_i J_{34}^{(i)}\n$$\n\n最后，我们通过将计算出的系综平均值与固定的实验参考值进行比较，来评估我们模型在给定缩放因子 $(S_\\text{elec}, S_\\text{LJ})$ 下的质量：$J_{12}^{\\text{(exp)}} = 5.50 \\text{ Hz}$ 和 $J_{34}^{\\text{(exp)}} = 6.90 \\text{ Hz}$。偏差通过均方根误差 (RMSE) 进行量化：\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{2}\\left( (\\langle J_{12} \\rangle - J_{12}^{\\text{(exp)}})^2 + (\\langle J_{34} \\rangle - J_{34}^{\\text{(exp)}})^2 \\right)}\n$$\n\n对于每个测试用例 $(S_\\text{elec}, S_\\text{LJ})$ 的算法流程如下：\n$1$. 对于每个构象异构体 $i \\in \\{1, 2, 3\\}$，计算总能量 $E_i(S_\\text{elec}, S_\\text{LJ})$。\n$2$. 使用这些能量，计算玻尔兹曼权重 $w_i$ 并将其归一化以获得布居数 $p_i$。\n$3$. 使用预先计算的 $J^{(i)}$ 值和计算出的布居数 $p_i$ 来计算系综平均耦合 $\\langle J_{12} \\rangle$ 和 $\\langle J_{34} \\rangle$。\n$4$. 通过将平均耦合与实验目标值进行比较，计算最终的 RMSE 值。\n\n此流程将针对四对指定的缩放因子进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMSE between calculated and experimental NMR J-couplings\n    for a three-state ribose model as a function of 1-4 scaling factors.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.0),\n        (0.8333333333, 0.5),\n        (0.0, 0.0),\n        (1.2, 1.2),\n    ]\n\n    # --- Constants and Physical Parameters ---\n    T = 298.0  # Temperature in Kelvin\n    R = 8.314462618e-3  # Gas constant in kJ/mol/K\n    beta = 1.0 / (R * T)  # Thermal energy term in (kJ/mol)^-1\n\n    # --- Energy Parameters (in kJ/mol) ---\n    # Rows correspond to states i=1, 2, 3. Columns are E0, E_elec, E_lj.\n    energy_params = np.array([\n        # E_i^(0), E_{i,elec}^{(1-4)}, E_{i,LJ}^{(1-4)}\n        [0.0, -0.6, 0.4],  # State 1: C3'-endo\n        [0.8, -0.2, 0.1],  # State 2: C2'-endo\n        [4.0, -0.1, 0.2],  # State 3: O4'-endo\n    ])\n    E0 = energy_params[:, 0]\n    E_elec_14 = energy_params[:, 1]\n    E_lj_14 = energy_params[:, 2]\n\n    # --- Karplus Relation Parameters and Angles ---\n    A_karp, B_karp, C_karp = 7.09, -1.42, 1.77  # J in Hz\n\n    # Dihedral angles for each conformer (in degrees)\n    phi_12_deg = np.array([60.0, 180.0, 300.0])  # For J_H1'-H2'\n    phi_34_deg = np.array([180.0, 60.0, 300.0])  # For J_H3'-H4'\n\n    # Convert angles to radians for trigonometric functions\n    phi_12_rad = np.deg2rad(phi_12_deg)\n    phi_34_rad = np.deg2rad(phi_34_deg)\n\n    # --- Experimental Data ---\n    J12_exp = 5.50  # Hz\n    J34_exp = 6.90  # Hz\n\n    # --- Pre-computation of State-Specific J-Couplings ---\n    def karplus(phi_rad, A, B, C):\n        \"\"\"Calculates J-coupling from dihedral angle using the Karplus relation.\"\"\"\n        cos_phi = np.cos(phi_rad)\n        return A * cos_phi**2 + B * cos_phi + C\n\n    # J-couplings for each of the 3 conformers\n    J12_conf = karplus(phi_12_rad, A_karp, B_karp, C_karp)\n    J34_conf = karplus(phi_34_rad, A_karp, B_karp, C_karp)\n\n    results = []\n    for S_elec, S_LJ in test_cases:\n        # Step 1: Calculate total energy for each conformer\n        E_total = E0 + S_elec * E_elec_14 + S_LJ * E_lj_14\n\n        # Step 2: Calculate Boltzmann weights and populations\n        weights = np.exp(-beta * E_total)\n        populations = weights / np.sum(weights)\n\n        # Step 3: Calculate ensemble-averaged J-couplings\n        J12_avg = np.sum(populations * J12_conf)\n        J34_avg = np.sum(populations * J34_conf)\n\n        # Step 4: Compute the Root-Mean-Square Error (RMSE)\n        err_sq_12 = (J12_avg - J12_exp)**2\n        err_sq_34 = (J34_avg - J34_exp)**2\n        rmse = np.sqrt(0.5 * (err_sq_12 + err_sq_34))\n        results.append(rmse)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3430408"}]}