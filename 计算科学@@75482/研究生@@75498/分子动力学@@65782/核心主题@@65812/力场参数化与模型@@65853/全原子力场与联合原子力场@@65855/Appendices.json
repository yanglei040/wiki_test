{"hands_on_practices": [{"introduction": "创建联合原子（UA）模型的第一步是明确如何从高分辨率的全原子（AA）表示中定义新的粗粒化位点。这个练习将通过一个具体实例——叔丁基基团，指导你推导精确的数学变换矩阵。通过亲手实践，你将深刻理解UA位点通常是如何通过其对应原子组的质心来定义的，这是构建任何粗粒化模型的基础。[@problem_id:3395042]", "problem": "考虑叔丁基（tert-butyl）基团，它由一个中心碳原子与三个甲基键合而成。在全原子表示法中，有 $4$ 个碳原子和 $9$ 个氢原子，总共 $13$ 个原子。设碳的原子质量为 $m_{\\mathrm{C}}$，氢的原子质量为 $m_{\\mathrm{H}}$。你将构建一个联合原子表示法，通过将每个甲基替换为位于 $\\mathrm{CH}_{3}$ 基团质心的单个联合原子位点，并保留中心碳原子作为其自身的位点，从而保留以重原子为中心的基团的质心位置。因此，该联合原子模型有 $4$ 个位点。\n\n使用质心的基本定义：对于任何由位置为 $\\{\\mathbf{r}_{i}\\}$、质量为 $\\{m_{i}\\}$ 的原子组成的基团 $g$，其质心位置为 $\\mathbf{R}_{g} = \\left(\\sum_{i \\in g} m_{i} \\mathbf{r}_{i}\\right)\\big/\\left(\\sum_{i \\in g} m_{i}\\right)$。将从全原子坐标到联合原子坐标的映射视为一个线性变换。\n\n采用以下明确的全原子索引和坐标堆叠约定。将原子标记如下：\n$1$：中心碳原子 $\\mathrm{C}_{0}$；$2$：甲基碳原子 $\\mathrm{C}_{1}$；$3$：甲基碳原子 $\\mathrm{C}_{2}$；$4$：甲基碳原子 $\\mathrm{C}_{3}$；$5,6,7$：连接到 $\\mathrm{C}_{1}$ 的氢原子 $\\mathrm{H}_{11}, \\mathrm{H}_{12}, \\mathrm{H}_{13}$；$8,9,10$：连接到 $\\mathrm{C}_{2}$ 的氢原子 $\\mathrm{H}_{21}, \\mathrm{H}_{22}, \\mathrm{H}_{23}$；$11,12,13$：连接到 $\\mathrm{C}_{3}$ 的氢原子 $\\mathrm{H}_{31}, \\mathrm{H}_{32}, \\mathrm{H}_{33}$。将全原子笛卡尔坐标堆叠为 $39 \\times 1$ 的向量 $\\mathbf{r}_{\\mathrm{AA}} = \\left(x_{1}, x_{2}, \\dots, x_{13}, y_{1}, y_{2}, \\dots, y_{13}, z_{1}, z_{2}, \\dots, z_{13}\\right)^{\\mathsf{T}}$，并将联合原子坐标堆叠为 $12 \\times 1$ 的向量 $\\mathbf{r}_{\\mathrm{UA}} = \\left(X_{0}, X_{1}, X_{2}, X_{3}, Y_{0}, Y_{1}, Y_{2}, Y_{3}, Z_{0}, Z_{1}, Z_{2}, Z_{3}\\right)^{\\mathsf{T}}$，其中索引 $0$ 表示中心碳原子位点，$1,2,3$ 表示甲基位点。\n\n仅从质心定义和坐标映射的线性性出发，推导出唯一的线性变换矩阵 $A$，使得 $\\mathbf{r}_{\\mathrm{UA}} = A\\,\\mathbf{r}_{\\mathrm{AA}}$，并且联合原子位点的位置恰好是其关联基团指定的质心。使用与一个显式的 $4 \\times 13$ 权重矩阵的克罗内克积，以闭合形式表示 $A$，该权重矩阵的元素是 $m_{\\mathrm{C}}$ 和 $m_{\\mathrm{H}}$ 的有理函数。本题中无舍入。请提供 $A$ 的最终表达式作为答案。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n**步骤 1：提取的已知条件**\n- **系统：** 叔丁基（tert-butyl）基团。\n- **全原子 (AA) 表示法：** $4$ 个碳原子，$9$ 个氢原子（共 $13$ 个原子）。\n- **原子质量：** 碳为 $m_{\\mathrm{C}}$，氢为 $m_{\\mathrm{H}}$。\n- **联合原子 (UA) 表示法：** $4$ 个位点。一个位点用于中心碳原子。三个位点用于三个甲基($\\mathrm{CH}_{3}$)，每个位点位于其对应基团的质心。\n- **质心 (COM) 定义：** 对于一个由位置为 $\\{\\mathbf{r}_{i}\\}$、质量为 $\\{m_{i}\\}$ 的原子组成的基团 $g$，其质心位置为 $\\mathbf{R}_{g} = \\left(\\sum_{i \\in g} m_{i} \\mathbf{r}_{i}\\right)\\big/\\left(\\sum_{i \\in g} m_{i}\\right)$。\n- **AA 原子索引：** $1$：$\\mathrm{C}_{0}$（中心）；$2,3,4$：甲基碳原子 $\\mathrm{C}_{1}, \\mathrm{C}_{2}, \\mathrm{C}_{3}$；$5,6,7$：$\\mathrm{C}_{1}$ 上的氢原子；$8,9,10$：$\\mathrm{C}_{2}$ 上的氢原子；$11,12,13$：$\\mathrm{C}_{3}$ 上的氢原子。\n- **AA 坐标向量：** $\\mathbf{r}_{\\mathrm{AA}} = \\left(x_{1}, \\dots, x_{13}, y_{1}, \\dots, y_{13}, z_{1}, \\dots, z_{13}\\right)^{\\mathsf{T}}$，一个 $39 \\times 1$ 的向量。\n- **UA 位点索引：** $0$：中心位点（$\\mathrm{C}_{0}$）；$1,2,3$：甲基位点。\n- **UA 坐标向量：** $\\mathbf{r}_{\\mathrm{UA}} = \\left(X_{0}, X_{1}, X_{2}, X_{3}, Y_{0}, Y_{1}, Y_{2}, Y_{3}, Z_{0}, Z_{1}, Z_{2}, Z_{3}\\right)^{\\mathsf{T}}$，一个 $12 \\times 1$ 的向量。\n- **目标：** 求线性变换矩阵 $A$，使得 $\\mathbf{r}_{\\mathrm{UA}} = A\\,\\mathbf{r}_{\\mathrm{AA}}$，并以涉及一个 $4 \\times 13$ 权重矩阵的克罗内克积的闭合形式表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是良定的、客观的。它基于经典力学（质心）和线性代数的基本原理，这些是计算化学和物理学中用于开发粗粒化模型的标准工具。所有术语都得到了精确定义，原子和位点索引是明确的，坐标向量的结构也已指定。该问题是自洽的，不包含任何矛盾或歧义。它要求根据所提供的定义进行数学推导，从而得出一个唯一的、可验证的解。该问题未违反任何无效性标准。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整的解答。\n\n**变换矩阵的推导**\n\n联合原子 (UA) 位点是基于全原子 (AA) 粒子基团定义的。设 $\\mathbf{R}_{j}$ 表示第 $j$ 个 UA 位点的位置向量，$\\mathbf{r}_{i}$ 表示第 $i$ 个 AA 原子的位置向量。该问题定义了四个 UA 位点。\n\n1.  **UA 位点 $0$ (中心碳原子):** 该位点对应于索引为 $1$ 的中心碳原子。该基团仅包含这一个原子。应用质心公式：\n    $$\n    \\mathbf{R}_{0} = \\frac{m_{\\mathrm{C}} \\mathbf{r}_{1}}{m_{\\mathrm{C}}} = \\mathbf{r}_{1}\n    $$\n\n2.  **UA 位点 $1$ (第一个甲基):** 该位点是第一个甲基的质心，该甲基包含碳原子 $2$ ($\\mathrm{C}_{1}$) 和氢原子 $5$、$6$ 和 $7$。一个甲基的总质量为 $M_{\\mathrm{CH_3}} = m_{\\mathrm{C}} + 3m_{\\mathrm{H}}$。\n    $$\n    \\mathbf{R}_{1} = \\frac{m_{\\mathrm{C}} \\mathbf{r}_{2} + m_{\\mathrm{H}} \\mathbf{r}_{5} + m_{\\mathrm{H}} \\mathbf{r}_{6} + m_{\\mathrm{H}} \\mathbf{r}_{7}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}}\n    $$\n\n3.  **UA 位点 $2$ (第二个甲基):** 该位点是第二个甲基的质心，该甲基包含碳原子 $3$ ($\\mathrm{C}_{2}$) 和氢原子 $8$、$9$ 和 $10$。\n    $$\n    \\mathbf{R}_{2} = \\frac{m_{\\mathrm{C}} \\mathbf{r}_{3} + m_{\\mathrm{H}} \\mathbf{r}_{8} + m_{\\mathrm{H}} \\mathbf{r}_{9} + m_{\\mathrm{H}} \\mathbf{r}_{10}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}}\n    $$\n\n4.  **UA 位点 $3$ (第三个甲基):** 该位点是第三个甲基的质心，该甲基包含碳原子 $4$ ($\\mathrm{C}_{3}$) 和氢原子 $11$、$12$ 和 $13$。\n    $$\n    \\mathbf{R}_{3} = \\frac{m_{\\mathrm{C}} \\mathbf{r}_{4} + m_{\\mathrm{H}} \\mathbf{r}_{11} + m_{\\mathrm{H}} \\mathbf{r}_{12} + m_{\\mathrm{H}} \\mathbf{r}_{13}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}}\n    $$\n\n这些向量方程表示对每个笛卡尔分量 ($x, y, z$) 独立成立的线性变换。让我们考虑 $x$ 分量。设 $\\mathbf{X}_{\\mathrm{UA}} = (X_{0}, X_{1}, X_{2}, X_{3})^{\\mathsf{T}}$ 为 UA 位点 $x$ 坐标的向量，$\\mathbf{x}_{\\mathrm{AA}} = (x_{1}, x_{2}, \\dots, x_{13})^{\\mathsf{T}}$ 为 AA 原子 $x$ 坐标的向量。它们的关系是 $\\mathbf{X}_{\\mathrm{UA}} = W \\mathbf{x}_{\\mathrm{AA}}$，其中 $W$ 是一个 $4 \\times 13$ 的权重矩阵。\n\n$W$ 的元素是来自质心方程的系数。让我们为甲基定义基于质量的权重：\n$w_{\\mathrm{C}} = \\frac{m_{\\mathrm{C}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}}$ 和 $w_{\\mathrm{H}} = \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}}$。\n\n$\\mathbf{X}_{\\mathrm{UA}}$ 的分量是：\n$X_0 = x_1$\n$X_1 = w_{\\mathrm{C}} x_2 + w_{\\mathrm{H}} x_5 + w_{\\mathrm{H}} x_6 + w_{\\mathrm{H}} x_7$\n$X_2 = w_{\\mathrm{C}} x_3 + w_{\\mathrm{H}} x_8 + w_{\\mathrm{H}} x_9 + w_{\\mathrm{H}} x_{10}$\n$X_3 = w_{\\mathrm{C}} x_4 + w_{\\mathrm{H}} x_{11} + w_{\\mathrm{H}} x_{12} + w_{\\mathrm{H}} x_{13}$\n\n根据这些方程，我们可以逐行构建矩阵 $W$。\n- 第 1 行 (对应于 $X_0$): $x_1$ 的系数是 $1$，所有其他系数都是 $0$。\n- 第 2 行 (对应于 $X_1$): $x_2$ 的系数是 $w_{\\mathrm{C}}$，$x_5, x_6, x_7$ 的系数是 $w_{\\mathrm{H}}$。所有其他系数都是 $0$。\n- 第 3 行 (对应于 $X_2$): $x_3$ 的系数是 $w_{\\mathrm{C}}$，$x_8, x_9, x_{10}$ 的系数是 $w_{\\mathrm{H}}$。所有其他系数都是 $0$。\n- 第 4 行 (对应于 $X_3$): $x_4$ 的系数是 $w_{\\mathrm{C}}$，$x_{11}, x_{12}, x_{13}$ 的系数是 $w_{\\mathrm{H}}$。所有其他系数都是 $0$。\n\n这给出了显式的 $4 \\times 13$ 矩阵 $W$：\n$$\nW = \\begin{pmatrix}\n1  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & w_{\\mathrm{C}}  & 0  & 0  & w_{\\mathrm{H}}  & w_{\\mathrm{H}}  & w_{\\mathrm{H}}  & 0  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & w_{\\mathrm{C}}  & 0  & 0  & 0  & 0  & w_{\\mathrm{H}}  & w_{\\mathrm{H}}  & w_{\\mathrm{H}}  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & w_{\\mathrm{C}}  & 0  & 0  & 0  & 0  & 0  & 0  & w_{\\mathrm{H}}  & w_{\\mathrm{H}}  & w_{\\mathrm{H}}\n\\end{pmatrix}\n$$\n\n完整变换将 $12 \\times 1$ 的向量 $\\mathbf{r}_{\\mathrm{UA}}$ 与 $39 \\times 1$ 的向量 $\\mathbf{r}_{\\mathrm{AA}}$ 联系起来。鉴于向量的堆叠格式：\n$\\mathbf{r}_{\\mathrm{UA}} = \\begin{pmatrix} \\mathbf{X}_{\\mathrm{UA}} \\\\ \\mathbf{Y}_{\\mathrm{UA}} \\\\ \\mathbf{Z}_{\\mathrm{UA}} \\end{pmatrix}$ 和 $\\mathbf{r}_{\\mathrm{AA}} = \\begin{pmatrix} \\mathbf{x}_{\\mathrm{AA}} \\\\ \\mathbf{y}_{\\mathrm{AA}} \\\\ \\mathbf{z}_{\\mathrm{AA}} \\end{pmatrix}$。\n\n线性关系为：\n$\\mathbf{X}_{\\mathrm{UA}} = W \\mathbf{x}_{\\mathrm{AA}}$\n$\\mathbf{Y}_{\\mathrm{UA}} = W \\mathbf{y}_{\\mathrm{AA}}$\n$\\mathbf{Z}_{\\mathrm{UA}} = W \\mathbf{z}_{\\mathrm{AA}}$\n\n我们可以将完整变换 $\\mathbf{r}_{\\mathrm{UA}} = A \\mathbf{r}_{\\mathrm{AA}}$ 写成分块矩阵形式：\n$$\n\\begin{pmatrix} \\mathbf{X}_{\\mathrm{UA}} \\\\ \\mathbf{Y}_{\\mathrm{UA}} \\\\ \\mathbf{Z}_{\\mathrm{UA}} \\end{pmatrix} = \\begin{pmatrix}\nW  & \\mathbf{0}  & \\mathbf{0} \\\\\n\\mathbf{0}  & W  & \\mathbf{0} \\\\\n\\mathbf{0}  & \\mathbf{0}  & W\n\\end{pmatrix}\n\\begin{pmatrix} \\mathbf{x}_{\\mathrm{AA}} \\\\ \\mathbf{y}_{\\mathrm{AA}} \\\\ \\mathbf{z}_{\\mathrm{AA}} \\end{pmatrix}\n$$\n其中 $\\mathbf{0}$ 是 $4 \\times 13$ 的零矩阵。完整的变换矩阵 $A$ 是这个 $12 \\times 39$ 的分块对角矩阵。\n\n这种结构是克罗内克积 $I_3 \\otimes W$ 的定义，其中 $I_3$ 是 $3 \\times 3$ 的单位矩阵。\n$$\nA = I_3 \\otimes W =\n\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n\\otimes W\n$$\n这就是问题所要求的闭合形式表达式。最终答案包括这个克罗内克积与显式矩阵 $W$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n\\otimes\n\\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & \\frac{m_{\\mathrm{C}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & 0 & 0 & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & \\frac{m_{\\mathrm{C}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & 0 & 0 & 0 & 0 & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\frac{m_{\\mathrm{C}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & 0 & 0 & 0 & 0 & 0 & 0 & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}} & \\frac{m_{\\mathrm{H}}}{m_{\\mathrm{C}} + 3m_{\\mathrm{H}}}\n\\end{pmatrix}\n}\n$$", "id": "3395042"}, {"introduction": "在定义了几何映射之后，下一个挑战是如何处理像原子部分电荷这样的物理属性。本练习探讨了在非极性分子的UA模型中一种常见的简化方法：将化学基团（如$\\mathrm{CH_3}$和$\\mathrm{CH_2}$）视为电中性。你将为丙烷分子设计一个电荷重分布方案，并量化这一简化对分子总偶极矩的影响，从而揭示计算效率与静电相互作用精度之间的权衡。[@problem_id:3395043]", "problem": "一种线性饱和烃——丙烷，在经典分子动力学中使用的两种静电参数化方案中被建模：一种是带有约束静电势 (RESP) 电荷的全原子 (AA) 模型，另一种是联合原子 (UA) 模型，其中甲基 ($\\mathrm{CH_3}$) 和亚甲基 ($\\mathrm{CH_2}$) 位点被视为单个赝原子。在 AA 模型中，每个碳原子和氢原子都带有部分电荷。在用于非极性烷烃的 UA 模型中，$\\mathrm{CH_3}$ 和 $\\mathrm{CH_2}$ 位点被认为是电中性的，这消除了基团内的静电相互作用，同时保持范德华相互作用不变。目标是从第一性原理出发，推导出一个能强制使 UA $\\mathrm{CH_3}$ 和 $\\mathrm{CH_2}$ 位点保持电中性的电荷重分布程序，然后量化由此导致的分子偶极矩变化。\n\n考虑以下丙烷的 AA 模型几何结构和 RESP 电荷：\n- 碳原子沿 $x$ 轴放置，位置为 $\\mathbf{r}_{\\mathrm{C1}} = (-1.54, 0, 0)\\,\\mathrm{\\AA}$、$\\mathbf{r}_{\\mathrm{C2}} = (0, 0, 0)\\,\\mathrm{\\AA}$ 和 $\\mathbf{r}_{\\mathrm{C3}} = (1.54, 0, 0)\\,\\mathrm{\\AA}$。\n- 碳氢键长为 $d_{\\mathrm{CH}} = 1.09\\,\\mathrm{\\AA}$。\n- 末端的$\\mathrm{CH_3}$氢原子（围绕 C1 和 C3）相对于各自的 C–C 键轴呈四面体排列。设 $s = \\frac{2\\sqrt{2}}{3}$。对于左侧的$\\mathrm{CH_3}$（连接到 C1），定义角度 $\\varphi_{k} \\in \\{25^\\circ,145^\\circ,265^\\circ\\}$ 和单位向量 $\\mathbf{u}^{\\mathrm{L}}_{k} = \\left(-\\frac{1}{3},\\, s\\cos\\varphi_{k},\\, s\\sin\\varphi_{k}\\right)$；三个氢原子的位置为 $\\mathbf{r}_{\\mathrm{H}k} = \\mathbf{r}_{\\mathrm{C1}} + d_{\\mathrm{CH}}\\mathbf{u}^{\\mathrm{L}}_{k}$，其中 $k=1,2,3$。对于右侧的$\\mathrm{CH_3}$（连接到 C3），定义角度 $\\psi_{k} \\in \\{-40^\\circ, 80^\\circ, 200^\\circ\\}$ 和单位向量 $\\mathbf{u}^{\\mathrm{R}}_{k} = \\left(\\frac{1}{3},\\, s\\cos\\psi_{k},\\, s\\sin\\psi_{k}\\right)$；三个氢原子的位置为 $\\mathbf{r}_{\\mathrm{H}k} = \\mathbf{r}_{\\mathrm{C3}} + d_{\\mathrm{CH}}\\mathbf{u}^{\\mathrm{R}}_{k}$，其中 $k=6,7,8$。\n- 中间的$\\mathrm{CH_2}$氢原子对称地放置在 $\\mathbf{r}_{\\mathrm{H4}} = \\left(0,\\, \\frac{d_{\\mathrm{CH}}}{\\sqrt{2}},\\, \\frac{d_{\\mathrm{CH}}}{\\sqrt{2}}\\right)\\,\\mathrm{\\AA}$ 和 $\\mathbf{r}_{\\mathrm{H5}} = \\left(0,\\, -\\frac{d_{\\mathrm{CH}}}{\\sqrt{2}},\\, -\\frac{d_{\\mathrm{CH}}}{\\sqrt{2}}\\right)\\,\\mathrm{\\AA}$。\n- RESP 电荷（以基本电荷 $e$ 为单位）分配如下：$q_{\\mathrm{C1}} = -0.30$，$q_{\\mathrm{H1}} = q_{\\mathrm{H2}} = q_{\\mathrm{H3}} = +0.10$；$q_{\\mathrm{C2}} = -0.21$，$q_{\\mathrm{H4}} = q_{\\mathrm{H5}} = +0.11$；$q_{\\mathrm{C3}} = -0.28$，$q_{\\mathrm{H6}} = q_{\\mathrm{H7}} = q_{\\mathrm{H8}} = +0.09$。分子总电荷为零。C1 处的$\\mathrm{CH_3}$基团是电中性的，C2 处的$\\mathrm{CH_2}$基团带有 $+0.01\\,e$ 的电荷，而 C3 处的$\\mathrm{CH_3}$基团带有 $-0.01\\,e$ 的电荷。\n\n从分子偶极矩作为电荷一阶矩的经典定义出发，\n$$\n\\boldsymbol{\\mu} = \\sum_{i} q_{i} \\,\\mathbf{r}_{i},\n$$\n执行以下操作：\n1. 推导一个程序以获得 UA 电荷，该程序在保持分子总电荷不变的同时，强制使每个$\\mathrm{CH_3}$和$\\mathrm{CH_2}$位点保持电中性。您的重分布必须在每个位点内部进行（即，只改变属于$\\mathrm{CH_3}$或$\\mathrm{CH_2}$基团的原子），并且应该是最小侵入性的，例如使用等权重约束 $q_{i}' = q_{i} - w_{i} Q_{\\mathrm{group}}$，其中权重 $w_{i}$ 满足 $\\sum_{\\mathrm{group}} w_{i} = 1$。\n2. 使用上述 AA 几何结构和电荷，计算 AA 分子偶极矩的大小 $|\\boldsymbol{\\mu}_{\\mathrm{AA}}|$。\n3. 在具有电中性$\\mathrm{CH_3}$和$\\mathrm{CH_2}$位点的 UA 模型中，这些位点上的静电荷被设置为零。计算由此产生的偶极矩大小的变化，\n$$\n\\Delta \\mu = \\left|\\boldsymbol{\\mu}_{\\mathrm{AA}}\\right| - \\left|\\boldsymbol{\\mu}_{\\mathrm{UA}}\\right|,\n$$\n并报告其数值。\n\n以德拜为单位表示最终的 $\\Delta \\mu$。使用换算关系 $1\\,e\\cdot\\mathrm{\\AA} = 4.80320427\\,\\mathrm{Debye}$。将您的最终答案四舍五入到四位有效数字。", "solution": "该问题需要一个分三部分的解答：首先，推导一个通用的电荷重分布程序；其次，为给定的丙烷分子计算全原子 (AA) 偶极矩；第三，确定在过渡到联合原子 (UA) 模型时偶极矩大小的变化。\n\n**第一部分：电荷重分布程序的推导**\n\n目标是推导一个程序，该程序从一组初始的原子部分电荷 $q_i$ 出发，强制使分子内的每个官能团（例如$\\mathrm{CH_3}$或$\\mathrm{CH_2}$）保持电中性。该程序必须在每个基团内部局部作用，并保持分子总电荷。\n\n设一个特定基团由 $N_{\\mathrm{group}}$ 个原子组成，用 $i$ 索引。该基团的初始电荷是其组成原子电荷的总和：\n$$\nQ_{\\mathrm{group}} = \\sum_{i \\in \\mathrm{group}} q_i\n$$\n我们寻求一组新的电荷 $q_i'$，使得新的基团电荷 $Q'_{\\mathrm{group}}$ 为零：\n$$\nQ'_{\\mathrm{group}} = \\sum_{i \\in \\mathrm{group}} q_i' = 0\n$$\n问题建议了一种形式为 $q_{i}' = q_{i} - \\Delta q_i$ 的最小侵入性变换，其中调整量 $\\Delta q_i = w_{i} Q_{\\mathrm{group}}$ 与基团的总电荷成正比。权重 $w_i$ 受条件 $\\sum_{i \\in \\mathrm{group}} w_i = 1$ 的约束。这确保了从基团中移除的总电荷等于其初始电荷：\n$$\n\\sum_{i \\in \\mathrm{group}} \\Delta q_i = \\sum_{i \\in \\mathrm{group}} w_i Q_{\\mathrm{group}} = Q_{\\mathrm{group}} \\sum_{i \\in \\mathrm{group}} w_i = Q_{\\mathrm{group}} \\cdot 1 = Q_{\\mathrm{group}}\n$$\n因此，新的基团电荷变为 $Q'_{\\mathrm{group}} = \\sum q_i' = \\sum (q_i - \\Delta q_i) = \\sum q_i - \\sum \\Delta q_i = Q_{\\mathrm{group}} - Q_{\\mathrm{group}} = 0$，符合要求。\n\n问题进一步提出了一个“等权重约束”。对于一个最小侵入性程序，最直接的解释是电荷重分布在基团内的所有原子上均匀进行。对于一个包含 $N_{\\mathrm{group}}$ 个原子的基团，这意味着每个原子具有相等的权重 $w_i = 1/N_{\\mathrm{group}}$。\n\n因此，电荷重分布程序如下：对于属于具有初始总电荷 $Q_{\\mathrm{group}}$ 并包含 $N_{\\mathrm{group}}$ 个原子的特定基团的每个原子 $i$，新的电荷 $q_i'$ 由下式给出：\n$$\nq_i' = q_i - \\frac{Q_{\\mathrm{group}}}{N_{\\mathrm{group}}}\n$$\n当此程序应用于一个初始电中性分子的所有基团时，将保持分子总电荷不变，因为所有基团电荷的总和 $\\sum Q_{\\mathrm{group}}$ 为零。\n\n**第二部分和第三部分：偶极矩及其差值的计算**\n\n分子偶极矩 $\\boldsymbol{\\mu}$ 是所有电荷-位置乘积的矢量和：\n$$\n\\boldsymbol{\\mu} = \\sum_{i} q_{i} \\,\\mathbf{r}_{i}\n$$\n在本问题的背景下，偶极矩大小的总变化为 $\\Delta \\mu = \\left|\\boldsymbol{\\mu}_{\\mathrm{AA}}\\right| - \\left|\\boldsymbol{\\mu}_{\\mathrm{UA}}\\right|$。\n\n首先，我们确定指定的 UA 模型的偶极矩。问题陈述：“在用于非极性烷烃的 UA 模型中，$\\mathrm{CH_3}$ 和 $\\mathrm{CH_2}$ 位点被认为是电中性的”。这意味着代表一个基团的每个赝原子的电荷为零。UA 偶极矩是这些赝原子的总和：\n$$\n\\boldsymbol{\\mu}_{\\mathrm{UA}} = \\sum_{\\mathrm{groups}} Q'_{\\mathrm{group}} \\mathbf{R}_{\\mathrm{group}}\n$$\n其中对所有基团 $Q'_{\\mathrm{group}} = 0$。因此，UA 偶极矩为零：\n$$\n\\boldsymbol{\\mu}_{\\mathrm{UA}} = \\mathbf{0} \\quad \\implies \\quad \\left|\\boldsymbol{\\mu}_{\\mathrm{UA}}\\right| = 0\n$$\n因此，偶极矩大小的变化简化为 AA 偶极矩的大小：\n$$\n\\Delta \\mu = \\left|\\boldsymbol{\\mu}_{\\mathrm{AA}}\\right|\n$$\n接下来，我们通过使用提供的 AA 几何结构和电荷，对所有 11 个原子的贡献求和来计算 $\\boldsymbol{\\mu}_{\\mathrm{AA}}$。我们可以按官能团位点（$\\mathrm{C1}$-基团、$\\mathrm{C2}$-基团、$\\mathrm{C3}$-基团）对原子进行分组。\n总的 AA 偶极矩为 $\\boldsymbol{\\mu}_{\\mathrm{AA}} = \\boldsymbol{\\mu}_{\\mathrm{C1-group}} + \\boldsymbol{\\mu}_{\\mathrm{C2-group}} + \\boldsymbol{\\mu}_{\\mathrm{C3-group}}$。\n\n来自左侧$\\mathrm{CH_3}$基团（原子 $\\mathrm{C1, H1, H2, H3}$）的贡献：\n氢原子的位置是 $\\mathbf{r}_{\\mathrm{H}k} = \\mathbf{r}_{\\mathrm{C1}} + d_{\\mathrm{CH}}\\mathbf{u}^{\\mathrm{L}}_{k}$，其中 $k=1,2,3$。电荷是 $q_{\\mathrm{C1}}=-0.30\\,e$ 和 $q_{\\mathrm{H(1-3)}}=+0.10\\,e$。基团的总电荷是 $Q_{\\mathrm{C1-group}} = q_{\\mathrm{C1}} + 3q_{\\mathrm{H(1-3)}} = -0.30 + 3(0.10) = 0\\,e$。\n该基团的偶极矩为：\n$$\n\\boldsymbol{\\mu}_{\\mathrm{C1-group}} = q_{\\mathrm{C1}}\\mathbf{r}_{\\mathrm{C1}} + \\sum_{k=1}^{3} q_{\\mathrm{H(1-3)}} (\\mathbf{r}_{\\mathrm{C1}} + d_{\\mathrm{CH}}\\mathbf{u}^{\\mathrm{L}}_{k}) = (q_{\\mathrm{C1}} + 3q_{\\mathrm{H(1-3)}})\\mathbf{r}_{\\mathrm{C1}} + q_{\\mathrm{H(1-3)}}d_{\\mathrm{CH}} \\sum_{k=1}^{3} \\mathbf{u}^{\\mathrm{L}}_{k}\n$$\n由于 $Q_{\\mathrm{C1-group}}=0$，这可以简化为 $\\boldsymbol{\\mu}_{\\mathrm{C1-group}} = q_{\\mathrm{H(1-3)}}d_{\\mathrm{CH}} \\sum_{k=1}^{3} \\mathbf{u}^{\\mathrm{L}}_{k}$。\n角度 $\\varphi_k \\in \\{25^\\circ, 145^\\circ, 265^\\circ\\}$ 相隔 $120^\\circ$。对于任意角度 $\\theta$，$\\sum_{j=0}^{2} \\cos(\\theta+j\\cdot 120^\\circ)=0$ 且 $\\sum_{j=0}^{2} \\sin(\\theta+j\\cdot 120^\\circ)=0$。\n因此，单位向量的和为：\n$$\n\\sum_{k=1}^{3} \\mathbf{u}^{\\mathrm{L}}_{k} = \\left(\\sum_{k=1}^{3} -\\frac{1}{3},\\, s\\sum_{k=1}^{3}\\cos\\varphi_{k},\\, s\\sum_{k=1}^{3}\\sin\\varphi_{k}\\right) = (-1, 0, 0)\n$$\n所以，$\\boldsymbol{\\mu}_{\\mathrm{C1-group}} = (+0.10\\,e) \\cdot (1.09\\,\\mathrm{\\AA}) \\cdot (-1, 0, 0) = (-0.109, 0, 0)\\,e\\cdot\\mathrm{\\AA}$。\n\n来自中间$\\mathrm{CH_2}$基团（原子 $\\mathrm{C2, H4, H5}$）的贡献：\n位置是 $\\mathbf{r}_{\\mathrm{C2}} = (0,0,0)\\,\\mathrm{\\AA}$、$\\mathbf{r}_{\\mathrm{H4}} = (0, d_{\\mathrm{CH}}/\\sqrt{2}, d_{\\mathrm{CH}}/\\sqrt{2})\\,\\mathrm{\\AA}$ 和 $\\mathbf{r}_{\\mathrm{H5}} = (0, -d_{\\mathrm{CH}}/\\sqrt{2}, -d_{\\mathrm{CH}}/\\sqrt{2})\\,\\mathrm{\\AA}$。电荷是 $q_{\\mathrm{C2}}=-0.21\\,e$ 和 $q_{\\mathrm{H4}}=q_{\\mathrm{H5}}=+0.11\\,e$。\n$$\n\\boldsymbol{\\mu}_{\\mathrm{C2-group}} = q_{\\mathrm{C2}}\\mathbf{r}_{\\mathrm{C2}} + q_{\\mathrm{H4}}\\mathbf{r}_{\\mathrm{H4}} + q_{\\mathrm{H5}}\\mathbf{r}_{\\mathrm{H5}}\n$$\n$$\n\\boldsymbol{\\mu}_{\\mathrm{C2-group}} = (-0.21)\\cdot(0,0,0) + (+0.11)\\cdot(0, \\frac{1.09}{\\sqrt{2}}, \\frac{1.09}{\\sqrt{2}}) + (+0.11)\\cdot(0, -\\frac{1.09}{\\sqrt{2}}, -\\frac{1.09}{\\sqrt{2}}) = (0,0,0)\\,e\\cdot\\mathrm{\\AA}\n$$\n由于对称性，该基团对总偶极矩的贡献为零。\n\n来自右侧$\\mathrm{CH_3}$基团（原子 $\\mathrm{C3, H6, H7, H8}$）的贡献：\n该基团的总电荷是 $Q_{\\mathrm{C3-group}} = q_{\\mathrm{C3}} + 3q_{\\mathrm{H(6-8)}} = -0.28 + 3(0.09) = -0.01\\,e$。\n该基团的偶极矩贡献是 $\\boldsymbol{\\mu}_{\\mathrm{C3-group}} = Q_{\\mathrm{C3-group}}\\mathbf{r}_{\\mathrm{C3}} + q_{\\mathrm{H(6-8)}}d_{\\mathrm{CH}} \\sum_{k=6}^{8} \\mathbf{u}^{\\mathrm{R}}_{k}$。\n角度 $\\psi_k \\in \\{-40^\\circ, 80^\\circ, 200^\\circ\\}$ 也相隔 $120^\\circ$，因此正弦和余弦项的和为零。\n$$\n\\sum_{k=6}^{8} \\mathbf{u}^{\\mathrm{R}}_{k} = \\left(\\sum_{k=6}^{8} \\frac{1}{3},\\, s\\sum_{k=6}^{8}\\cos\\psi_{k},\\, s\\sum_{k=6}^{8}\\sin\\psi_{k}\\right) = (1, 0, 0)\n$$\n代入数值：\n$$\n\\boldsymbol{\\mu}_{\\mathrm{C3-group}} = (-0.01\\,e)\\cdot(1.54, 0, 0)\\,\\mathrm{\\AA} + (+0.09\\,e)\\cdot(1.09\\,\\mathrm{\\AA})\\cdot(1, 0, 0)\n$$\n$$\n\\boldsymbol{\\mu}_{\\mathrm{C3-group}} = (-0.0154, 0, 0) + (0.0981, 0, 0) = (0.0827, 0, 0)\\,e\\cdot\\mathrm{\\AA}\n$$\n\n总 AA 偶极矩：\n$$\n\\boldsymbol{\\mu}_{\\mathrm{AA}} = (-0.109, 0, 0) + (0, 0, 0) + (0.0827, 0, 0) = (-0.0263, 0, 0)\\,e\\cdot\\mathrm{\\AA}\n$$\n其大小为 $|\\boldsymbol{\\mu}_{\\mathrm{AA}}| = 0.0263\\,e\\cdot\\mathrm{\\AA}$。\n\n最后，我们计算 $\\Delta \\mu$ 并将其转换为德拜：\n$$\n\\Delta \\mu = |\\boldsymbol{\\mu}_{\\mathrm{AA}}| = 0.0263\\,e\\cdot\\mathrm{\\AA}\n$$\n使用换算因子 $1\\,e\\cdot\\mathrm{\\AA} = 4.80320427\\,\\mathrm{Debye}$：\n$$\n\\Delta \\mu = 0.0263 \\times 4.80320427\\,\\mathrm{Debye} \\approx 0.1263236... \\,\\mathrm{Debye}\n$$\n四舍五入到四位有效数字得到 $\\Delta \\mu = 0.1263\\,\\mathrm{Debye}$。", "answer": "$$\\boxed{0.1263}$$", "id": "3395043"}, {"introduction": "一个成功的UA模型必须能够再现AA系统的关键物理行为，而这需要通过仔细的参数化来实现。这项高级练习将带你深入参数校准的核心过程，要求你校准一个UA扭转势，以匹配AA模型给出的构象异构体布居。最终，你将使用校准后的模型来预测一个宏观性质——持续长度（persistence length），从而完整地体验模型开发、校准和验证的全过程。[@problem_id:3395123]", "problem": "您将处理一个简化的线性烷烃旋转异构态校准任务，该任务在全原子（all-atom）和联合原子（united-atom）参数化背景下进行。目标是重新校准联合原子（UA）的扭转势垒，以再现饱和烃三种主要二面角状态的全原子（AA）构象异构体布居，然后预测相对于AA的链持久长度。联合原子模型将显式的氢原子合并到其母碳位点上，而全原子模型则显式地处理每个原子。校准必须在固定温度下进行，使用一个在所有考虑的链中共享的单一UA扭转势垒参数。\n\n基本原理：\n- 统计力学平衡：二面角 $\\phi$ 的玻尔兹曼概率密度为 $p(\\phi) \\propto \\exp\\left(-\\beta V(\\phi)\\right)$，其中 $V(\\phi)$ 是扭转势能，$\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- AA表示法中的构象异构体布居：对于由 $i$ 索引、自由能为 $F_i$ 的离散构象异构体，其布居满足 $\\pi_i \\propto \\exp\\left(-\\beta F_i\\right)$。\n- 离散蠕虫状链近似中的持久长度：如果连续的键取向通过一个具有分布 $p(\\theta)$ 的独立转角 $\\theta$ 去相关，则每一步的相关性为 $\\langle \\cos \\theta \\rangle$，持久长度 $l_p$ 遵循 $\\exp\\left(-b/l_p\\right) = \\langle \\cos \\theta \\rangle$，其中 $b$ 是步长。因此 $l_p = -b / \\ln \\langle \\cos \\theta \\rangle$。\n\n模型与假设：\n1. UA扭转势：假设扭转势仅通过三角函数形式依赖于二面角\n   $$V(\\phi; k_3) = k_3 \\left(1 + \\cos(3\\phi)\\right),$$\n   其中 $k_3$ 是待校准的单一UA势垒参数，$\\phi \\in [0, 2\\pi)$ 是以弧度为单位的二面角。根据典型的烷烃扭转能学，该形式在反式（trans）和旁式（gauche）区域附近产生极小值。\n2. 构象异构体窗口（所有角度以弧度为单位）：定义反式窗口为 $\\phi \\in [5\\pi/6, 7\\pi/6]$，正旁式窗口为 $\\phi \\in [\\pi/6, \\pi/2]$，负旁式窗口为 $\\phi \\in [3\\pi/2, 11\\pi/6]$。每种构象异构体的概率通过在相应窗口上对玻尔兹曼密度进行积分，并用所有三个窗口的总和进行归一化得到。\n3. AA目标布居：对于每条链，假设AA自由能对于反式状态为 $F_{\\mathrm{t}}$，对于每个旁式状态（正、负对称）为 $F_{\\mathrm{g}}$。AA目标概率为\n   $$p_{\\mathrm{t}}^{\\mathrm{AA}} = \\frac{e^{-\\beta F_{\\mathrm{t}}}}{Z}, \\quad p_{\\mathrm{g}^+}^{\\mathrm{AA}} = \\frac{e^{-\\beta F_{\\mathrm{g}}}}{Z}, \\quad p_{\\mathrm{g}^-}^{\\mathrm{AA}} = \\frac{e^{-\\beta F_{\\mathrm{g}}}}{Z},$$\n   其中\n   $$Z = e^{-\\beta F_{\\mathrm{t}}} + 2 e^{-\\beta F_{\\mathrm{g}}}.$$\n4. 持久长度映射：将每步的有效转角近似为反式状态的 $0$ 和每个旁式状态的 $\\Delta = \\pi/3$，因此\n   $$\\langle \\cos \\theta \\rangle = p_{\\mathrm{t}} \\cos(0) + p_{\\mathrm{g}^+} \\cos(\\Delta) + p_{\\mathrm{g}^-} \\cos(\\Delta) = p_{\\mathrm{t}} + (p_{\\mathrm{g}^+} + p_{\\mathrm{g}^-}) \\cos(\\pi/3).$$\n   则持久长度为\n   $$l_p = -\\frac{b}{\\ln \\left( p_{\\mathrm{t}} + (p_{\\mathrm{g}^+} + p_{\\mathrm{g}^-}) \\cos(\\pi/3) \\right)},$$\n   其中 $b$ 是碳-碳键长。\n\n校准任务：\n- 确定单一UA势垒参数 $k_3$（单位为 $\\mathrm{kcal/mol}$），该参数能同时最小化所有三个构象异构体窗口和所有给定烷烃链上，UA概率与AA目标概率之间的平方差之和。\n\n预测任务：\n- 使用校准后的 $k_3$，计算每条链的UA持久长度 $l_p^{\\mathrm{UA}}$ 和AA持久长度 $l_p^{\\mathrm{AA}}$，然后报告每条链的比率 $r = l_p^{\\mathrm{UA}} / l_p^{\\mathrm{AA}}$。\n\n常数与单位：\n- 使用 $T = 298 \\,\\mathrm{K}$，$k_{\\mathrm{B}} = 1.987204 \\times 10^{-3} \\,\\mathrm{kcal}\\, \\mathrm{mol}^{-1}\\, \\mathrm{K}^{-1}$，以及 $b = 0.154 \\,\\mathrm{nm}$。所有能量 $F_i$ 和 $k_3$ 的单位均为 $\\mathrm{kcal/mol}$。所有角度单位均为弧度。持久长度应以 $\\mathrm{nm}$ 计算，但最终要求的量是无量纲的比率 $l_p^{\\mathrm{UA}} / l_p^{\\mathrm{AA}}$，它不需要单位。\n\n数值说明：\n- 使用足够精细的均匀网格（例如，至少 $10^5$ 个点）在 $\\phi \\in [0, 2\\pi)$ 上对所有窗口积分进行数值计算，以提供稳定的概率。\n- 在 $k_3 \\in [0, 5]$ 上使用标量有界最小化来获得校准后的UA势垒。\n\n测试套件：\n提供三条具有不同长度和AA自由能的链，分别代表丁烷、己烷和癸烷。对于每条链，按如下方式指定 $(n_{\\mathrm{C}}, F_{\\mathrm{t}}, F_{\\mathrm{g}})$：\n1. 丁烷：$n_{\\mathrm{C}} = 4$，$F_{\\mathrm{t}} = 0.0 \\,\\mathrm{kcal/mol}$，$F_{\\mathrm{g}} = 0.60 \\,\\mathrm{kcal/mol}$。\n2. 己烷：$n_{\\mathrm{C}} = 6$，$F_{\\mathrm{t}} = 0.0 \\,\\mathrm{kcal/mol}$，$F_{\\mathrm{g}} = 0.50 \\,\\mathrm{kcal/mol}$。\n3. 癸烷：$n_{\\mathrm{C}} = 10$，$F_{\\mathrm{t}} = 0.0 \\,\\mathrm{kcal/mol}$，$F_{\\mathrm{g}} = 0.45 \\,\\mathrm{kcal/mol}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个结果 $[r_{\\mathrm{butane}}, r_{\\mathrm{hexane}}, r_{\\mathrm{decane}}]$，形式为用方括号括起来的逗号分隔列表，每个值四舍五入到六位小数（例如，$[0.912345,0.923456,0.934567]$）。不应打印任何额外文本。", "solution": "问题陈述已经过分析，并被认为是有效的。它在科学上基于统计力学和高分子物理学的原理，问题设定良好，信息充足，可得出唯一解，并以客观、定量的方式呈现。所有必要的常数、模型和约束都已提供，并且没有内部矛盾。\n\n任务是通过对三种不同线性烷烃的全原子（AA）构象异构体布居进行校准，来确定一个单一的联合原子（UA）扭转势垒参数 $k_3$。随后，此校准参数将用于预测每种烷烃的UA模型相对于AA模型的持久长度。\n\n解决方案分为两个主要阶段：参数 $k_3$ 的校准和持久长度比率的预测。\n\n**阶段1：扭转势垒参数 $k_3$ 的校准**\n\n校准的核心是找到 $k_3$ 的值，该值能最小化UA模型预测的构象异构体布居与从AA模型派生的目标布居之间的差异。\n\n首先，我们定义物理常数和逆温度 $\\beta$。\n- 温度 $T = 298 \\,\\mathrm{K}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.987204 \\times 10^{-3} \\,\\mathrm{kcal}\\, \\mathrm{mol}^{-1}\\, \\mathrm{K}^{-1}$。\n- 逆温度 $\\beta = \\frac{1}{k_{\\mathrm{B}} T} = \\frac{1}{(1.987204 \\times 10^{-3} \\,\\mathrm{kcal}\\, \\mathrm{mol}^{-1}\\, \\mathrm{K}^{-1})(298 \\,\\mathrm{K})} \\approx 1.6883 \\,\\mathrm{mol/kcal}$。\n\n接下来，我们处理三条链中每一条的数据 $j \\in \\{\\text{丁烷, 己烷, 癸烷}\\}$。\n\n**1.1. 全原子（AA）目标概率的计算**\n对于每条链 $j$，给定反式（$F_{\\mathrm{t},j}$）和旁式（$F_{\\mathrm{g},j}$）状态的自由能，我们计算目标概率。这三种状态的配分函数为 $Z_j = e^{-\\beta F_{\\mathrm{t},j}} + 2 e^{-\\beta F_{\\mathrm{g},j}}$。概率为：\n$$ p_{\\mathrm{t},j}^{\\mathrm{AA}} = \\frac{e^{-\\beta F_{\\mathrm{t},j}}}{Z_j} $$\n$$ p_{\\mathrm{g}^+,j}^{\\mathrm{AA}} = p_{\\mathrm{g}^-,j}^{\\mathrm{AA}} = \\frac{e^{-\\beta F_{\\mathrm{g},j}}}{Z_j} $$\n这些概率之和为1：$p_{\\mathrm{t},j}^{\\mathrm{AA}} + p_{\\mathrm{g}^+,j}^{\\mathrm{AA}} + p_{\\mathrm{g}^-,j}^{\\mathrm{AA}} = 1$。由于自由能的对称性，$p_{\\mathrm{g}^+,j}^{\\mathrm{AA}} = p_{\\mathrm{g}^-,j}^{\\mathrm{AA}}$。\n\n**1.2. 联合原子（UA）概率的计算**\nUA概率依赖于扭转势 $V(\\phi; k_3) = k_3 \\left(1 + \\cos(3\\phi)\\right)$。构象异构体的概率通过在指定的二面角窗口上对未归一化的玻尔兹曼密度 $w(\\phi; k_3) = \\exp(-\\beta V(\\phi; k_3))$进行积分，并用所有三个窗口的积分总和进行归一化来求得。\n\n窗口为：\n- 反式 (t)：$\\phi \\in [\\frac{5\\pi}{6}, \\frac{7\\pi}{6}]$\n- 正旁式 (g+)：$\\phi \\in [\\frac{\\pi}{6}, \\frac{\\pi}{2}]$\n- 负旁式 (g-)：$\\phi \\in [\\frac{3\\pi}{2}, \\frac{11\\pi}{6}]$\n\n我们为给定的 $k_3$ 定义未归一化的积分：\n$$ I_{\\mathrm{t}}(k_3) = \\int_{5\\pi/6}^{7\\pi/6} w(\\phi; k_3) d\\phi $$\n$$ I_{\\mathrm{g}^+}(k_3) = \\int_{\\pi/6}^{\\pi/2} w(\\phi; k_3) d\\phi $$\n$$ I_{\\mathrm{g}^-}(k_3) = \\int_{3\\pi/2}^{11\\pi/6} w(\\phi; k_3) d\\phi $$\n总归一化因子为 $I_{\\text{total}}(k_3) = I_{\\mathrm{t}}(k_3) + I_{\\mathrm{g}^+}(k_3) + I_{\\mathrm{g}^-}(k_3)$。\nUA概率与具体链无关，其表达式为：\n$$ p_{\\mathrm{t}}^{\\mathrm{UA}}(k_3) = \\frac{I_{\\mathrm{t}}(k_3)}{I_{\\text{total}}(k_3)}, \\quad p_{\\mathrm{g}^+}^{\\mathrm{UA}}(k_3) = \\frac{I_{\\mathrm{g}^+}(k_3)}{I_{\\text{total}}(k_3)}, \\quad p_{\\mathrm{g}^-}^{\\mathrm{UA}}(k_3) = \\frac{I_{\\mathrm{g}^-}(k_3)}{I_{\\text{total}}(k_3)} $$\n势能 $V(\\phi; k_3)$ 以及g+和g-的积分窗口是对称的，这意味着 $I_{\\mathrm{g}^+}(k_3) = I_{\\mathrm{g}^-}(k_3)$，因此 $p_{\\mathrm{g}^+}^{\\mathrm{UA}}(k_3) = p_{\\mathrm{g}^-}^{\\mathrm{UA}}(k_3)$。这些积分必须进行数值计算。我们使用一个精细的 $\\phi$ 值网格，并通过求和来近似积分。\n\n**1.3. 目标函数与最小化**\n目标是找到单一参数 $k_3$，它能最小化所有三条链和所有三种构象异构体上UA和AA概率之间的平方差之和（SSD）。目标函数 $\\mathcal{L}(k_3)$ 为：\n$$ \\mathcal{L}(k_3) = \\sum_{j \\in \\{\\text{chains}\\}} \\left[ (p_{\\mathrm{t}}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{t},j}^{\\mathrm{AA}})^2 + (p_{\\mathrm{g}^+}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{g}^+,j}^{\\mathrm{AA}})^2 + (p_{\\mathrm{g}^-}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{g}^-,j}^{\\mathrm{AA}})^2 \\right] $$\n考虑到对称性 $p_{\\mathrm{g}^+}^{\\mathrm{UA}}=p_{\\mathrm{g}^-}^{\\mathrm{UA}}$ 和 $p_{\\mathrm{g}^+,j}^{\\mathrm{AA}}=p_{\\mathrm{g}^-,j}^{\\mathrm{AA}}$，这可以简化为：\n$$ \\mathcal{L}(k_3) = \\sum_{j} \\left[ (p_{\\mathrm{t}}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{t},j}^{\\mathrm{AA}})^2 + 2(p_{\\mathrm{g}^+}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{g}^+,j}^{\\mathrm{AA}})^2 \\right] $$\n使用归一化条件 $p_{\\mathrm{t}} + 2p_{\\mathrm{g}^+} = 1$，我们得到 $p_{\\mathrm{g}^+} = (1 - p_{\\mathrm{t}})/2$。将其代入旁式状态的误差项中可得：\n$$ 2 \\left(\\frac{1 - p_{\\mathrm{t}}^{\\mathrm{UA}}}{2} - \\frac{1 - p_{\\mathrm{t},j}^{\\mathrm{AA}}}{2}\\right)^2 = 2 \\left(\\frac{p_{\\mathrm{t},j}^{\\mathrm{AA}} - p_{\\mathrm{t}}^{\\mathrm{UA}}}{2}\\right)^2 = \\frac{1}{2} (p_{\\mathrm{t}}^{\\mathrm{UA}} - p_{\\mathrm{t},j}^{\\mathrm{AA}})^2 $$\n因此，总目标函数显著简化为：\n$$ \\mathcal{L}(k_3) = \\sum_{j} \\left[ (p_{\\mathrm{t}}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{t},j}^{\\mathrm{AA}})^2 + \\frac{1}{2}(p_{\\mathrm{t}}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{t},j}^{\\mathrm{AA}})^2 \\right] = \\frac{3}{2} \\sum_{j} (p_{\\mathrm{t}}^{\\mathrm{UA}}(k_3) - p_{\\mathrm{t},j}^{\\mathrm{AA}})^2 $$\n最小化 $\\mathcal{L}(k_3)$ 等价于仅最小化反式概率的平方误差之和。我们对 $k_3 \\in [0, 5]$ kcal/mol 执行有界标量最小化，以找到最优值 $k_3^{\\text{opt}}$。\n\n**阶段2：持久长度比率的预测**\n\n利用校准后的 $k_3^{\\text{opt}}$，我们计算最终的UA概率，然后继续计算AA和UA模型的持久长度。\n\n**2.1. $\\langle\\cos\\theta\\rangle$的计算**\n持久长度 $l_p$ 依赖于转角的平均余弦值 $\\langle \\cos\\theta \\rangle$。使用给定的映射（反式状态转角 $\\theta=0$，旁式状态转角 $\\theta=\\pi/3$），我们有：\n$$ \\langle\\cos\\theta\\rangle = p_{\\mathrm{t}}\\cos(0) + (p_{\\mathrm{g}^+} + p_{\\mathrm{g}^-})\\cos(\\pi/3) = p_{\\mathrm{t}} + (1 - p_{\\mathrm{t}})\\cos(\\pi/3) $$\n由于 $\\cos(\\pi/3) = 0.5$，这可以简化为：\n$$ \\langle\\cos\\theta\\rangle = p_{\\mathrm{t}} + 0.5(1 - p_{\\mathrm{t}}) = 0.5(1 + p_{\\mathrm{t}}) $$\n这个关系对AA和UA模型都成立。对于每条链 $j$，我们有：\n$$ \\langle\\cos\\theta\\rangle_{j}^{\\mathrm{AA}} = 0.5(1 + p_{\\mathrm{t},j}^{\\mathrm{AA}}) $$\n$$ \\langle\\cos\\theta\\rangle^{\\mathrm{UA}} = 0.5(1 + p_{\\mathrm{t}}^{\\mathrm{UA}}(k_3^{\\text{opt}})) $$\n请注意，$\\langle\\cos\\theta\\rangle^{\\mathrm{UA}}$ 对所有链都是相同的，因为它仅依赖于全局校准的 $p_{\\mathrm{t}}^{\\mathrm{UA}}$。\n\n**2.2. 持久长度比率的计算**\n持久长度由 $l_p = -b / \\ln \\langle\\cos\\theta\\rangle$ 给出，其中 $b = 0.154 \\,\\mathrm{nm}$ 是键长。每条链的比率 $r_j = l_p^{\\mathrm{UA}} / l_p^{\\mathrm{AA}}$ 为：\n$$ r_j = \\frac{l_{p,j}^{\\mathrm{UA}}}{l_{p,j}^{\\mathrm{AA}}} = \\frac{-b / \\ln \\langle\\cos\\theta\\rangle^{\\mathrm{UA}}}{-b / \\ln \\langle\\cos\\theta\\rangle_{j}^{\\mathrm{AA}}} = \\frac{\\ln \\langle\\cos\\theta\\rangle_{j}^{\\mathrm{AA}}}{\\ln \\langle\\cos\\theta\\rangle^{\\mathrm{UA}}} $$\n这个最终比率是无量纲的，因为键长常数 $b$ 被消掉了。我们为三种烷烃中的每一种计算这个比率。\n\n整个过程在以下Python代码中以数值方式实现，遵循了指定的数值方法和常数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the rotational isomeric state calibration and prediction problem.\n    \"\"\"\n    # Define constants and test cases as per the problem statement\n    T = 298.0  # Temperature in K\n    KB = 1.987204e-3  # Boltzmann constant in kcal/mol/K\n    B_NM = 0.154  # C-C bond length in nm\n    BETA = 1.0 / (KB * T) # Inverse temperature in mol/kcal\n\n    # Test suite: (name, n_C, F_t, F_g)\n    test_cases = [\n        (\"butane\", 4, 0.0, 0.60),\n        (\"hexane\", 6, 0.0, 0.50),\n        (\"decane\", 10, 0.0, 0.45),\n    ]\n\n    # --- Numerical Grid and Conformer Windows ---\n    N_POINTS = 100001\n    phi = np.linspace(0, 2 * np.pi, N_POINTS, endpoint=False)\n\n    # Define conformer windows in radians\n    # Trans: [5pi/6, 7pi/6]\n    trans_mask = (phi >= 5 * np.pi / 6)  (phi = 7 * np.pi / 6)\n    # Gauche+: [pi/6, pi/2]\n    gpos_mask = (phi >= np.pi / 6)  (phi = np.pi / 2)\n    # Gauche-: [3pi/2, 11pi/6]\n    gneg_mask = (phi >= 3 * np.pi / 2)  (phi = 11 * np.pi / 6)\n\n    # --- Stage 1: Calibration ---\n\n    # 1.1 Calculate AA target probabilities for all chains\n    aa_probs_all_chains = []\n    for name, n_c, F_t, F_g in test_cases:\n        Z = np.exp(-BETA * F_t) + 2 * np.exp(-BETA * F_g)\n        p_t_aa = np.exp(-BETA * F_t) / Z\n        p_g_aa = np.exp(-BETA * F_g) / Z\n        aa_probs_all_chains.append({'t': p_t_aa, 'g+': p_g_aa, 'g-': p_g_aa})\n\n    # Cache for UA probability calculation to avoid re-computation\n    ua_prob_cache = {}\n\n    def calculate_ua_probs(k3):\n        \"\"\"\n        Calculates UA conformer probabilities for a given k3.\n        \"\"\"\n        if k3 in ua_prob_cache:\n            return ua_prob_cache[k3]\n\n        V = k3 * (1 + np.cos(3 * phi))\n        boltzmann_factor = np.exp(-BETA * V)\n\n        # Numerical integration by summing over grid points\n        I_t = np.sum(boltzmann_factor[trans_mask])\n        I_gpos = np.sum(boltzmann_factor[gpos_mask])\n        I_gneg = np.sum(boltzmann_factor[gneg_mask])\n        \n        # Due to symmetry, I_gpos should equal I_gneg, but we calculate both for robustness.\n        I_total = I_t + I_gpos + I_gneg\n\n        if I_total == 0:\n            # Avoid division by zero; equiprobable distribution if no states are populated\n            p_t_ua = 1.0 / 3.0\n            p_gpos_ua = 1.0 / 3.0\n            p_gneg_ua = 1.0 / 3.0\n        else:\n            p_t_ua = I_t / I_total\n            p_gpos_ua = I_gpos / I_total\n            p_gneg_ua = I_gneg / I_total\n\n        probs = {'t': p_t_ua, 'g+': p_gpos_ua, 'g-': p_gneg_ua}\n        ua_prob_cache[k3] = probs\n        return probs\n\n    def objective_function(k3):\n        \"\"\"\n        Objective function to minimize: sum of squared differences of probabilities.\n        \"\"\"\n        ua_probs = calculate_ua_probs(k3)\n        ssd = 0.0\n        # As derived, we only need to minimize the error on the trans probability\n        # The full sum is implemented here for clarity, but the simplified form is equivalent\n        for aa_probs in aa_probs_all_chains:\n            ssd += (ua_probs['t'] - aa_probs['t'])**2\n            ssd += (ua_probs['g+'] - aa_probs['g+'])**2\n            ssd += (ua_probs['g-'] - aa_probs['g-'])**2\n        return ssd\n\n    # 1.3 Minimize the objective function to find the optimal k3\n    opt_result = minimize_scalar(\n        objective_function,\n        bounds=(0, 5), # kcal/mol\n        method='bounded'\n    )\n    k3_opt = opt_result.x\n\n    # --- Stage 2: Prediction ---\n\n    # 2.1 Calculate final UA probabilities with the optimal k3\n    ua_probs_opt = calculate_ua_probs(k3_opt)\n    p_t_ua_opt = ua_probs_opt['t']\n\n    # 2.2 Calculate persistence length ratios for each chain\n    results = []\n    cos_theta_ua = 0.5 * (1 + p_t_ua_opt)\n    log_cos_theta_ua = np.log(cos_theta_ua)\n\n    for i in range(len(test_cases)):\n        p_t_aa = aa_probs_all_chains[i]['t']\n        \n        cos_theta_aa = 0.5 * (1 + p_t_aa)\n        log_cos_theta_aa = np.log(cos_theta_aa)\n\n        # Handle edge case where cos_theta is 1, causing log(1)=0\n        if log_cos_theta_ua == 0:\n            # If UA model predicts perfect alignment, ratio depends on AA\n            # If AA also perfectly aligned, persistence is infinite, ratio is 1.\n            # If AA not aligned, UA is infinitely more persistent, ratio is inf.\n            # This case is physically unlikely with the given potential.\n            ratio = 1.0 if log_cos_theta_aa == 0 else float('inf')\n        else:\n            ratio = log_cos_theta_aa / log_cos_theta_ua\n        \n        results.append(ratio)\n        \n    # Format and print the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3395123"}]}