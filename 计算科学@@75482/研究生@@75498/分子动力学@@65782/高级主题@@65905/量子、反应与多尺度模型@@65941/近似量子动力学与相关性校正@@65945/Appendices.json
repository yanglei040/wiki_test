{"hands_on_practices": [{"introduction": "对于任何近似量子动力学方法，谐振子都是一个基础的基准模型。环状聚合物分子动力学（RPMD）和质心分子动力学（CMD）等方法被设计为对该体系精确，本练习将通过精确计算其久保变换相关函数来揭示其背后的原因。这项实践[@problem_id:3396060]旨在加深理解精确量子结果与这些近似方法所要再现的目标之间的联系。", "problem": "考虑一个一维量子谐振子，其哈密顿算符为 $\\hat H=\\frac{\\hat p^2}{2m}+\\frac{1}{2}m\\omega^2 \\hat q^2$，其中 $m$ 是质量，$\\omega$ 是角频率。设系统处于逆温度为 $\\beta$ 的热平衡状态，其配分函数为 $Z=\\mathrm{Tr}\\left[\\exp(-\\beta \\hat H)\\right]$，正则平均为 $\\langle \\cdot \\rangle_{\\beta}=\\mathrm{Tr}\\left[\\exp(-\\beta \\hat H)\\,\\cdot\\,\\right]/Z$。海森堡绘景算符定义为 $\\hat A(t)=\\exp(\\frac{i}{\\hbar}\\hat H t)\\,\\hat A\\,\\exp(-\\frac{i}{\\hbar}\\hat H t)$，虚时演化定义为 $\\hat A(-i\\hbar\\lambda)=\\exp(\\lambda \\hat H)\\,\\hat A\\,\\exp(-\\lambda \\hat H)$，其中 $\\lambda\\in[0,\\beta]$。Kubo变换的位置自相关函数定义为\n$$\nC_{qq}^{\\mathrm{K}}(t)=\\frac{1}{\\beta}\\int_{0}^{\\beta}\\mathrm{d}\\lambda\\,\\big\\langle \\hat q(-i\\hbar\\lambda)\\,\\hat q(t)\\big\\rangle_{\\beta} .\n$$\n该相关函数是近似量子动力学方法的核心，例如环形聚合物分子动力学 (RPMD) 和质心分子动力学 (CMD)，这些方法以Kubo变换的相关函数为目标，并且对于谐振系统是精确的。\n\n从上述基本定义出发，除了标准算符代数和热平均外不使用任何快捷公式，推导谐振子的 $C_{qq}^{\\mathrm{K}}(t)$ 的闭合形式表达式，然后得到其在 $t=0$ 附近直到并包括 $t^{4}$ 阶项的短时展开。\n\n不需要数值近似；请提供精确的解析表达式。以符号表达式形式给出最终答案。不要包含单位。", "solution": "此问题基于量子统计力学的科学原理，定义明确且表述客观，因此是有效的。我们可以着手进行推导。\n\n问题要求推导一维量子谐振子的Kubo变换位置自相关函数 $C_{qq}^{\\mathrm{K}}(t)$ 及其短时展开。给定的定义是\n$$\nC_{qq}^{\\mathrm{K}}(t)=\\frac{1}{\\beta}\\int_{0}^{\\beta}\\mathrm{d}\\lambda\\,\\big\\langle \\hat q(-i\\hbar\\lambda)\\,\\hat q(t)\\big\\rangle_{\\beta} .\n$$\n哈密顿算符为 $\\hat H=\\frac{\\hat p^2}{2m}+\\frac{1}{2}m\\omega^2 \\hat q^2$。\n\n为了方便计算，我们分别引入湮灭算符 $\\hat a$ 和产生算符 $\\hat a^\\dagger$。它们的定义如下：\n$$\n\\hat a = \\sqrt{\\frac{m\\omega}{2\\hbar}}\\left(\\hat q + \\frac{i}{m\\omega}\\hat p\\right), \\quad \\hat a^\\dagger = \\sqrt{\\frac{m\\omega}{2\\hbar}}\\left(\\hat q - \\frac{i}{m\\omega}\\hat p\\right).\n$$\n位置算符 $\\hat q$ 和哈密顿算符 $\\hat H$ 可以用这些算符表示：\n$$\n\\hat q = \\sqrt{\\frac{\\hbar}{2m\\omega}}(\\hat a + \\hat a^\\dagger),\n$$\n$$\n\\hat H = \\hbar\\omega\\left(\\hat a^\\dagger \\hat a + \\frac{1}{2}\\right).\n$$\n在海森堡绘景中，湮灭算符和产生算符的时间演化由下式给出：\n$$\n\\hat a(t) = \\exp\\left(\\frac{i}{\\hbar}\\hat H t\\right)\\hat a\\exp\\left(-\\frac{i}{\\hbar}\\hat H t\\right) = \\hat a \\exp(-i\\omega t),\n$$\n$$\n\\hat a^\\dagger(t) = \\exp\\left(\\frac{i}{\\hbar}\\hat H t\\right)\\hat a^\\dagger\\exp\\left(-\\frac{i}{\\hbar}\\hat H t\\right) = \\hat a^\\dagger \\exp(i\\omega t).\n$$\n因此，含时演化的位置算符为：\n$$\n\\hat q(t) = \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(\\hat a(t) + \\hat a^\\dagger(t)\\right) = \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(\\hat a \\exp(-i\\omega t) + \\hat a^\\dagger \\exp(i\\omega t)\\right).\n$$\n类似地，虚时演化由 $\\hat A(-i\\hbar\\lambda)=\\exp(\\lambda \\hat H)\\hat A\\exp(-\\lambda \\hat H)$ 给出。对于 $\\hat a$ 和 $\\hat a^\\dagger$，这得到：\n$$\n\\hat a(-i\\hbar\\lambda) = \\exp(\\lambda \\hat H) \\hat a \\exp(-\\lambda \\hat H) = \\hat a \\exp(-\\hbar\\omega\\lambda),\n$$\n$$\n\\hat a^\\dagger(-i\\hbar\\lambda) = \\exp(\\lambda \\hat H) \\hat a^\\dagger \\exp(-\\lambda \\hat H) = \\hat a^\\dagger \\exp(\\hbar\\omega\\lambda).\n$$\n因此，虚时演化的位置算符为：\n$$\n\\hat q(-i\\hbar\\lambda) = \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(\\hat a(-i\\hbar\\lambda) + \\hat a^\\dagger(-i\\hbar\\lambda)\\right) = \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(\\hat a \\exp(-\\hbar\\omega\\lambda) + \\hat a^\\dagger \\exp(\\hbar\\omega\\lambda)\\right).\n$$\n接下来，我们计算乘积 $\\hat q(-i\\hbar\\lambda)\\hat q(t)$ 的热期望值：\n$$\n\\big\\langle \\hat q(-i\\hbar\\lambda)\\,\\hat q(t)\\big\\rangle_{\\beta} = \\left\\langle \\left( \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(\\hat a e^{-\\hbar\\omega\\lambda} + \\hat a^\\dagger e^{\\hbar\\omega\\lambda}\\right) \\right) \\left( \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(\\hat a e^{-i\\omega t} + \\hat a^\\dagger e^{i\\omega t}\\right) \\right) \\right\\rangle_{\\beta}\n$$\n$$\n= \\frac{\\hbar}{2m\\omega} \\left\\langle \\hat a\\hat a e^{-\\hbar\\omega\\lambda}e^{-i\\omega t} + \\hat a\\hat a^\\dagger e^{-\\hbar\\omega\\lambda}e^{i\\omega t} + \\hat a^\\dagger\\hat a e^{\\hbar\\omega\\lambda}e^{-i\\omega t} + \\hat a^\\dagger\\hat a^\\dagger e^{\\hbar\\omega\\lambda}e^{i\\omega t} \\right\\rangle_{\\beta}.\n$$\n对于处于热平衡的系统，产生算符和湮灭算符数目不等的项的期望值为零，所以 $\\langle \\hat a\\hat a \\rangle_{\\beta} = 0$ 且 $\\langle \\hat a^\\dagger\\hat a^\\dagger \\rangle_{\\beta} = 0$。我们剩下：\n$$\n\\big\\langle \\hat q(-i\\hbar\\lambda)\\,\\hat q(t)\\big\\rangle_{\\beta} = \\frac{\\hbar}{2m\\omega} \\left( \\langle \\hat a\\hat a^\\dagger \\rangle_{\\beta} e^{-\\hbar\\omega\\lambda}e^{i\\omega t} + \\langle \\hat a^\\dagger\\hat a \\rangle_{\\beta} e^{\\hbar\\omega\\lambda}e^{-i\\omega t} \\right).\n$$\n粒子数算符 $\\hat n = \\hat a^\\dagger \\hat a$ 的热平均遵循玻色-爱因斯坦分布：\n$$\n\\langle \\hat a^\\dagger \\hat a \\rangle_{\\beta} = \\langle \\hat n \\rangle_{\\beta} = \\frac{1}{\\exp(\\beta\\hbar\\omega) - 1}.\n$$\n使用对易关系 $[\\hat a, \\hat a^\\dagger] = 1$，我们有 $\\hat a\\hat a^\\dagger = \\hat a^\\dagger\\hat a + 1$。因此，\n$$\n\\langle \\hat a\\hat a^\\dagger \\rangle_{\\beta} = \\langle \\hat a^\\dagger\\hat a + 1 \\rangle_{\\beta} = \\langle \\hat n \\rangle_{\\beta} + 1 = \\frac{1}{\\exp(\\beta\\hbar\\omega) - 1} + 1 = \\frac{\\exp(\\beta\\hbar\\omega)}{\\exp(\\beta\\hbar\\omega) - 1}.\n$$\n将这些平均值代回，我们得到：\n$$\n\\big\\langle \\hat q(-i\\hbar\\lambda)\\,\\hat q(t)\\big\\rangle_{\\beta} = \\frac{\\hbar}{2m\\omega} \\left[ \\left(\\frac{e^{\\beta\\hbar\\omega}}{e^{\\beta\\hbar\\omega} - 1}\\right) e^{i\\omega t} e^{-\\hbar\\omega\\lambda} + \\left(\\frac{1}{e^{\\beta\\hbar\\omega} - 1}\\right) e^{-i\\omega t} e^{\\hbar\\omega\\lambda} \\right].\n$$\n现在我们根据 $C_{qq}^{\\mathrm{K}}(t)$ 的定义，将此表达式对 $\\lambda$ 从 $0$ 积分到 $\\beta$：\n$$\nC_{qq}^{\\mathrm{K}}(t) = \\frac{1}{\\beta} \\frac{\\hbar}{2m\\omega} \\left[ \\left(\\frac{e^{\\beta\\hbar\\omega}}{e^{\\beta\\hbar\\omega} - 1}\\right) e^{i\\omega t} \\int_0^\\beta e^{-\\hbar\\omega\\lambda}\\mathrm{d}\\lambda + \\left(\\frac{1}{e^{\\beta\\hbar\\omega} - 1}\\right) e^{-i\\omega t} \\int_0^\\beta e^{\\hbar\\omega\\lambda}\\mathrm{d}\\lambda \\right].\n$$\n这些积分是初等的：\n$$\n\\int_0^\\beta e^{-\\hbar\\omega\\lambda}\\mathrm{d}\\lambda = \\left[ \\frac{e^{-\\hbar\\omega\\lambda}}{-\\hbar\\omega} \\right]_0^\\beta = \\frac{e^{-\\beta\\hbar\\omega}-1}{-\\hbar\\omega} = \\frac{1-e^{-\\beta\\hbar\\omega}}{\\hbar\\omega}.\n$$\n$$\n\\int_0^\\beta e^{\\hbar\\omega\\lambda}\\mathrm{d}\\lambda = \\left[ \\frac{e^{\\hbar\\omega\\lambda}}{\\hbar\\omega} \\right]_0^\\beta = \\frac{e^{\\beta\\hbar\\omega}-1}{\\hbar\\omega}.\n$$\n代入积分结果：\n$$\nC_{qq}^{\\mathrm{K}}(t) = \\frac{\\hbar}{2m\\omega\\beta} \\left[ \\left(\\frac{e^{\\beta\\hbar\\omega}}{e^{\\beta\\hbar\\omega} - 1}\\right) e^{i\\omega t} \\left(\\frac{1-e^{-\\beta\\hbar\\omega}}{\\hbar\\omega}\\right) + \\left(\\frac{1}{e^{\\beta\\hbar\\omega} - 1}\\right) e^{-i\\omega t} \\left(\\frac{e^{\\beta\\hbar\\omega}-1}{\\hbar\\omega}\\right) \\right].\n$$\n让我们简化每一项的系数。对于第一项的系数：\n$$\n\\left(\\frac{e^{\\beta\\hbar\\omega}}{e^{\\beta\\hbar\\omega} - 1}\\right) \\left(\\frac{1-e^{-\\beta\\hbar\\omega}}{\\hbar\\omega}\\right) = \\left(\\frac{e^{\\beta\\hbar\\omega}}{e^{\\beta\\hbar\\omega} - 1}\\right) \\left(\\frac{(e^{\\beta\\hbar\\omega}-1)/e^{\\beta\\hbar\\omega}}{\\hbar\\omega}\\right) = \\frac{1}{\\hbar\\omega}.\n$$\n对于第二项的系数：\n$$\n\\left(\\frac{1}{e^{\\beta\\hbar\\omega} - 1}\\right) \\left(\\frac{e^{\\beta\\hbar\\omega}-1}{\\hbar\\omega}\\right) = \\frac{1}{\\hbar\\omega}.\n$$\n$C_{qq}^{\\mathrm{K}}(t)$ 的表达式显著简化为：\n$$\nC_{qq}^{\\mathrm{K}}(t) = \\frac{\\hbar}{2m\\omega\\beta} \\left[ \\frac{e^{i\\omega t}}{\\hbar\\omega} + \\frac{e^{-i\\omega t}}{\\hbar\\omega} \\right] = \\frac{1}{2m\\omega^2\\beta} \\left(e^{i\\omega t} + e^{-i\\omega t}\\right).\n$$\n使用欧拉公式 $e^{ix} + e^{-ix} = 2\\cos(x)$，我们得到最终的闭合形式表达式：\n$$\nC_{qq}^{\\mathrm{K}}(t) = \\frac{1}{m\\omega^2\\beta} \\cos(\\omega t).\n$$\n这个非常简洁的结果等价于逆温度为 $\\beta$ 的谐振子的经典位置自相关函数。\n\n对于问题的第二部分，我们需要求出 $C_{qq}^{\\mathrm{K}}(t)$ 在 $t=0$ 附近直到 $t^4$ 阶的短时展开。我们使用余弦函数的泰勒级数：\n$$\n\\cos(x) = 1 - \\frac{x^2}{2!} + \\frac{x^4}{4!} - O(x^6).\n$$\n代入 $x = \\omega t$：\n$$\n\\cos(\\omega t) = 1 - \\frac{(\\omega t)^2}{2} + \\frac{(\\omega t)^4}{24} + O(t^6).\n$$\n将此展开式代入我们的 $C_{qq}^{\\mathrm{K}}(t)$ 表达式中：\n$$\nC_{qq}^{\\mathrm{K}}(t) = \\frac{1}{m\\omega^2\\beta} \\left( 1 - \\frac{\\omega^2 t^2}{2} + \\frac{\\omega^4 t^4}{24} + O(t^6) \\right).\n$$\n分配前置因子，我们得到所需的短时展开：\n$$\nC_{qq}^{\\mathrm{K}}(t) = \\frac{1}{m\\omega^2\\beta} - \\frac{t^2}{2m\\beta} + \\frac{\\omega^2 t^4}{24m\\beta} + O(t^6).\n$$\n直到并包括 $t^4$ 阶项的展开式为 $\\frac{1}{m\\omega^2\\beta} - \\frac{t^2}{2m\\beta} + \\frac{\\omega^2 t^4}{24m\\beta}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{m\\omega^{2}\\beta}\\cos(\\omega t) & \\frac{1}{m\\omega^{2}\\beta} - \\frac{t^{2}}{2m\\beta} + \\frac{\\omega^{2}t^{4}}{24m\\beta} \\end{pmatrix}}\n$$", "id": "3396060"}, {"introduction": "在理解了理想的谐振子情况之后，我们转向实际的模拟问题。路径积分模拟需要为聚合物链珠选择一个坐标系，而这一选择会显著影响模拟的效率和稳定性。本练习[@problem_id:3396126]通过分析两种常见选择——简正模和阶梯坐标——的动能度规张量，来探讨它们的优劣。理解这一点对于优化模拟参数和正确应用恒温器至关重要。", "problem": "考虑一个质量为 $m$ 的一维量子粒子，其处于逆温 $\\beta$ 下，通过四珠路径积分离散化（环状聚合物，P=4）表示。设珠子位置集合成列向量 $\\mathbf{q} = (q_{1}, q_{2}, q_{3}, q_{4})^{\\mathrm{T}}$，共轭的珠子动量集合成 $\\mathbf{p} = (p_{1}, p_{2}, p_{3}, p_{4})^{\\mathrm{T}}$。经典的环状聚合物动能为 $T(\\mathbf{p}) = \\sum_{j=1}^{4} p_{j}^{2}/(2 m)$。考虑两种线性坐标变换：\n\n1. 简正模变换 $\\mathbf{Q} = \\mathbf{R}\\,\\mathbf{q}$，其中 $\\mathbf{R}$ 是一个正交的 $4 \\times 4$ 矩阵，它将环状聚合物哈密顿量中的谐波弹簧项对角化。\n\n2. 一种分段式内坐标变换 $\\mathbf{u} = \\mathbf{T}\\,\\mathbf{q}$，其明确定义为\n$$\n\\begin{aligned}\nu_{1} = \\tfrac{1}{4}\\,(q_{1} + q_{2} + q_{3} + q_{4}),\\\\\nu_{2} = q_{2} - q_{1},\\\\\nu_{3} = q_{3} - q_{2},\\\\\nu_{4} = q_{4} - q_{3}.\n\\end{aligned}\n$$\n\n对于每种变换，定义相应的共轭动量，使得向新相空间变量的变换是正则的，并推导变换后动能的二次型形式 $T = \\tfrac{1}{2 m}\\,\\tilde{\\mathbf{p}}^{\\mathrm{T}} \\mathbf{G} \\,\\tilde{\\mathbf{p}}$，从而确定每种表示下的动能度规矩阵 $\\mathbf{G}$。仅使用基本原理（正则1-形式的不变性和线性代数），按以下步骤进行：\n\n- 推导简正模表示下的 $\\mathbf{G}_{\\mathrm{nm}}$ 并解释其结构。\n- 通过显式计算矩阵 $\\mathbf{T}\\,\\mathbf{T}^{\\mathrm{T}}$ 来推导分段表示下的 $\\mathbf{G}_{\\mathrm{st}}$。\n- 以精确的闭合形式计算 $\\mathbf{G}_{\\mathrm{st}}$ 的所有特征值及其相关的条件数 $\\kappa_{\\mathrm{st}} \\equiv \\lambda_{\\max}(\\mathbf{G}_{\\mathrm{st}})/\\lambda_{\\min}(\\mathbf{G}_{\\mathrm{st}})$。\n- 确定简正模表示的 $\\kappa_{\\mathrm{nm}}$ 并证明你的结果。\n\n然后，利用你的结果，给出比值的精确值\n$$\n\\frac{\\kappa_{\\mathrm{st}}}{\\kappa_{\\mathrm{nm}}}.\n$$\n\n最后，根据你的推导，简要讨论这两种动能度规对环状聚合物分子动力学（RPMD）和质心分子动力学（CMD）中数值稳定性和恒温控制的影响，特别关注内模刚度以及用于解耦或阻尼高频模式以提高近似 Kubo 变换相关函数保真度的策略。你最终报告的答案必须是比值 $\\kappa_{\\mathrm{st}}/\\kappa_{\\mathrm{nm}}$ 的单个精确值。不需要四舍五入，最终答案中也不应包含任何物理单位。", "solution": "该问题要求分析在两种不同的线性坐标变换（简正模变换和分段变换）下一个 $P=4$ 珠子的环状聚合物的动能表达式。问题的核心是推导每种情况下的动能度规矩阵 $\\mathbf{G}$，通过其特征值和条件数分析其性质，并讨论其对路径积分分子动力学模拟的影响。\n\n一个通用的线性坐标变换由 $\\mathbf{u} = \\mathbf{A}\\,\\mathbf{q}$ 给出，其中 $\\mathbf{q}$ 是原始的笛卡尔珠子坐标，$\\mathbf{A}$ 是变换矩阵。为确保到新相空间变量 $(\\mathbf{u}, \\mathbf{p}_u)$ 的变换是正则的，旧动量 $\\mathbf{p}$ 和新动量 $\\mathbf{p}_u$ 之间的关系必须保持哈密顿方程的结构。这可以通过要求正则1-形式不变来实现，对于这种类型的变换，可以忽略一个全微分项。不变性条件是 $\\mathbf{p}^{\\mathrm{T}} d\\mathbf{q} = \\mathbf{p}_u^{\\mathrm{T}} d\\mathbf{u}$。\n从坐标变换中，我们得到微分之间的关系 $d\\mathbf{u} = \\mathbf{A}\\,d\\mathbf{q}$。将此代入不变性条件得到：\n$\\mathbf{p}^{\\mathrm{T}} d\\mathbf{q} = \\mathbf{p}_u^{\\mathrm{T}} (\\mathbf{A}\\,d\\mathbf{q}) = (\\mathbf{p}_u^{\\mathrm{T}} \\mathbf{A}) d\\mathbf{q}$\n由于这对于任何无穷小位移 $d\\mathbf{q}$ 都必须成立，我们必须有 $\\mathbf{p}^{\\mathrm{T}} = \\mathbf{p}_u^{\\mathrm{T}} \\mathbf{A}$，转置后得到动量向量之间的关系：\n$\\mathbf{p} = \\mathbf{A}^{\\mathrm{T}} \\mathbf{p}_u$\n\n原始笛卡尔表示中的动能为 $T(\\mathbf{p}) = \\sum_{j=1}^{4} p_{j}^{2}/(2 m)$，其矩阵形式为 $T = \\frac{1}{2m} \\mathbf{p}^{\\mathrm{T}}\\mathbf{p}$。我们可以通过代入 $\\mathbf{p}$ 的变换规则，用新动量 $\\mathbf{p}_u$ 来表示它：\n$T = \\frac{1}{2m} (\\mathbf{A}^{\\mathrm{T}} \\mathbf{p}_u)^{\\mathrm{T}} (\\mathbf{A}^{\\mathrm{T}} \\mathbf{p}_u) = \\frac{1}{2m} \\mathbf{p}_u^{\\mathrm{T}} \\mathbf{A} \\mathbf{A}^{\\mathrm{T}} \\mathbf{p}_u$\n将其与一般二次型 $T = \\frac{1}{2m} \\tilde{\\mathbf{p}}^{\\mathrm{T}} \\mathbf{G} \\tilde{\\mathbf{p}}$ 相比较，我们确定动能度规张量为 $\\mathbf{G} = \\mathbf{A}\\mathbf{A}^{\\mathrm{T}}$。这个通用结果将用于两种变换。\n\n**1. 简正模表示**\n简正模变换为 $\\mathbf{Q} = \\mathbf{R}\\,\\mathbf{q}$。问题指出变换矩阵 $\\mathbf{R}$ 是正交的。根据定义，正交矩阵满足属性 $\\mathbf{R}\\mathbf{R}^{\\mathrm{T}} = \\mathbf{R}^{\\mathrm{T}}\\mathbf{R} = \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n使用上面推导的通用公式，简正模表示的动能度规 $\\mathbf{G}_{\\mathrm{nm}}$ 为：\n$\\mathbf{G}_{\\mathrm{nm}} = \\mathbf{R}\\mathbf{R}^{\\mathrm{T}} = \\mathbf{I}$\n动能度规是 $4 \\times 4$ 的单位矩阵。这种简单的形式是简正模变换正交性的直接结果。正交变换是珠子坐标的 $P$ 维空间中的旋转（或反射），它保持了欧几里得范数。因此，与动量向量范数的平方成正比的动能，保持其简单的各向同性形式 $T = \\frac{1}{2m} \\sum_{k=1}^4 P_k^2$，其中 $P_k$ 是与简正模 $Q_k$ 共轭的动量。\n单位矩阵 $\\mathbf{I}$ 的特征值都等于 $1$。因此，$\\lambda_{\\max}(\\mathbf{G}_{\\mathrm{nm}}) = 1$ 且 $\\lambda_{\\min}(\\mathbf{G}_{\\mathrm{nm}}) = 1$。条件数 $\\kappa_{\\mathrm{nm}}$ 是这些特征值的比值：\n$\\kappa_{\\mathrm{nm}} = \\frac{\\lambda_{\\max}(\\mathbf{G}_{\\mathrm{nm}})}{\\lambda_{\\min}(\\mathbf{G}_{\\mathrm{nm}})} = \\frac{1}{1} = 1$\n\n**2. 分段表示**\n分段变换 $\\mathbf{u} = \\mathbf{T}\\,\\mathbf{q}$ 定义为：\n$u_{1} = \\tfrac{1}{4}\\,(q_{1} + q_{2} + q_{3} + q_{4})$\n$u_{2} = q_{2} - q_{1}$\n$u_{3} = q_{3} - q_{2}$\n$u_{4} = q_{4} - q_{3}$\n从这些方程中，我们可以构建变换矩阵 $\\mathbf{T}$：\n$$\n\\mathbf{T} = \\begin{pmatrix}\n1/4 & 1/4 & 1/4 & 1/4 \\\\\n-1 & 1 & 0 & 0 \\\\\n0 & -1 & 1 & 0 \\\\\n0 & 0 & -1 & 1\n\\end{pmatrix}\n$$\n分段表示的动能度规 $\\mathbf{G}_{\\mathrm{st}}$ 由 $\\mathbf{T}\\mathbf{T}^{\\mathrm{T}}$ 给出。我们显式计算这个乘积。$\\mathbf{T}$ 的转置是：\n$$\n\\mathbf{T}^{\\mathrm{T}} = \\begin{pmatrix}\n1/4 & -1 & 0 & 0 \\\\\n1/4 & 1 & -1 & 0 \\\\\n1/4 & 0 & 1 & -1 \\\\\n1/4 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n现在，我们执行矩阵乘法 $\\mathbf{G}_{\\mathrm{st}} = \\mathbf{T}\\mathbf{T}^{\\mathrm{T}}$：\n$$\n\\mathbf{G}_{\\mathrm{st}} = \\begin{pmatrix}\n1/4 & 1/4 & 1/4 & 1/4 \\\\\n-1 & 1 & 0 & 0 \\\\\n0 & -1 & 1 & 0 \\\\\n0 & 0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1/4 & -1 & 0 & 0 \\\\\n1/4 & 1 & -1 & 0 \\\\\n1/4 & 0 & 1 & -1 \\\\\n1/4 & 0 & 0 & 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4(1/16) & -1/4+1/4 & -1/4+1/4 & -1/4+1/4 \\\\\n-1/4+1/4 & 1+1 & -1 & 0 \\\\\n-1/4+1/4 & -1 & 1+1 & -1 \\\\\n-1/4+1/4 & 0 & -1 & 1+1\n\\end{pmatrix}\n$$\n$$\n\\mathbf{G}_{\\mathrm{st}} = \\begin{pmatrix}\n1/4 & 0 & 0 & 0 \\\\\n0 & 2 & -1 & 0 \\\\\n0 & -1 & 2 & -1 \\\\\n0 & 0 & -1 & 2\n\\end{pmatrix}\n$$\n为了找到 $\\mathbf{G}_{\\mathrm{st}}$ 的特征值，我们注意到它是一个分块对角矩阵。第一个块是值为 $1/4$ 的 $1 \\times 1$ 矩阵，因此一个特征值是 $\\lambda_1 = 1/4$。第二个块是 $3 \\times 3$ 矩阵：\n$$\n\\mathbf{M} = \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}\n$$\n$\\mathbf{M}$ 的特征值通过求解特征方程 $\\det(\\mathbf{M} - \\lambda\\mathbf{I}) = 0$ 找到：\n$$\n\\det \\begin{pmatrix} 2-\\lambda & -1 & 0 \\\\ -1 & 2-\\lambda & -1 \\\\ 0 & -1 & 2-\\lambda \\end{pmatrix} = (2-\\lambda)((2-\\lambda)^2-1) - (-1)(-(2-\\lambda)) = (2-\\lambda)(\\lambda^2 - 4\\lambda + 3) - (2-\\lambda) = (2-\\lambda)(\\lambda^2-4\\lambda+2) = 0\n$$\n一个根是 $\\lambda = 2$。另外两个根来自二次方程 $\\lambda^2 - 4\\lambda + 2 = 0$，解得 $\\lambda = \\frac{4 \\pm \\sqrt{16-8}}{2} = 2 \\pm \\sqrt{2}$。\n因此，这个 $3 \\times 3$ 块的特征值为 $\\{2-\\sqrt{2}, 2, 2+\\sqrt{2}\\}$。\n$\\mathbf{G}_{\\mathrm{st}}$ 的完整特征值集合是 $\\{1/4, 2-\\sqrt{2}, 2, 2+\\sqrt{2}\\}$。\n为了找到条件数 $\\kappa_{\\mathrm{st}}$，我们确定最大和最小特征值。\n数值上，它们大约是 $\\{0.25, 0.586, 2, 3.414\\}$。\n$\\lambda_{\\max}(\\mathbf{G}_{\\mathrm{st}}) = 2+\\sqrt{2}$\n$\\lambda_{\\min}(\\mathbf{G}_{\\mathrm{st}}) = 1/4$\n条件数为：\n$\\kappa_{\\mathrm{st}} = \\frac{\\lambda_{\\max}(\\mathbf{G}_{\\mathrm{st}})}{\\lambda_{\\min}(\\mathbf{G}_{\\mathrm{st}})} = \\frac{2+\\sqrt{2}}{1/4} = 4(2+\\sqrt{2}) = 8+4\\sqrt{2}$\n\n**3. 条件数之比**\n最终要求的计算是比值 $\\kappa_{\\mathrm{st}}/\\kappa_{\\mathrm{nm}}$：\n$$\n\\frac{\\kappa_{\\mathrm{st}}}{\\kappa_{\\mathrm{nm}}} = \\frac{8+4\\sqrt{2}}{1} = 8+4\\sqrt{2}\n$$\n\n**4. 对RPMD和CMD影响的讨论**\n动能度规 $\\mathbf{G}$ 及其条件数 $\\kappa$ 对像 RPMD 和 CMD 这样的路径积分模拟方法的稳定性和效率有着深远的影响。运动方程包含项 $\\dot{\\mathbf{u}} = m^{-1}\\mathbf{G}\\mathbf{p}_u$，这意味着 $\\mathbf{G}$ 的特征值直接影响广义模式的有效质量。\n对于简正模坐标，$\\mathbf{G}_{\\mathrm{nm}} = \\mathbf{I}$ 且 $\\kappa_{\\mathrm{nm}}=1$。这表明动能在简正模动量空间中是各向同性的。所有简正模具有相同的有效质量 $m$。虽然由于谐波势的存在，自由环状聚合物的振动频率 $\\omega_k \\propto \\sin(k\\pi/P)$ 是分散的，但每个模式的惯性响应是相同的。这使得系统从动力学角度来看是良态的，允许直接的恒温控制，其中单个摩擦系数可以同等地应用于所有模式。\n\n对于分段坐标，动能度规 $\\mathbf{G}_{\\mathrm{st}}$ 不是对角的，其条件数 $\\kappa_{\\mathrm{st}} = 8+4\\sqrt{2} \\approx 13.66$ 显著大于 $1$。这个大的条件数表明分段模式的有效质量存在巨大差异，其由 $m_k^{\\mathrm{eff}} = m/\\lambda_k$ 给出。模式的范围从重的质心（$m_1^{\\mathrm{eff}} = m/(1/4) = 4m$）到轻的内模（例如，$m^{\\mathrm{eff}} = m/(2+\\sqrt{2}) \\approx 0.29m$）。这种差异导致了微分方程组的刚性问题，其中最高频率的内模决定了模拟为保持稳定所必须采用的非常小的积分步长。这严重限制了探索物理上相关的慢模式（质心）的构象空间的效率。\n\n此外，这种刚性使恒温控制变得复杂。一个简单的朗之万恒温器，若对所有模式施加相同的摩擦，要么会对慢速的质心欠阻尼，要么会对快速的内模过阻尼。这可能导致人为效应，例如“零点能泄漏”问题，即能量非物理地从热的、刚性的内模流向质心模式。为了规避这个问题，需要专门的恒温控制方案（例如，路径积分朗之万方程，PILE），这些方案应用依赖于模式的摩擦，强力阻尼高频内模。这对于精确采样正则分布和在 RPMD 与 CMD 中获得正确的 Kubo 变换相关函数都是至关重要的，因为它有助于将非物理的内模动力学与质心的物理动力学解耦。总之，虽然分段坐标在势能的局部耦合方面可能提供优势，但它们在动力学的动能部分引入了重大挑战，这些挑战由动能度规的大条件数来量化。", "answer": "$$\\boxed{8 + 4\\sqrt{2}}$$", "id": "3396126"}, {"introduction": "真实的分子系统是高度非谐的，这正是像质心分子动力学（CMD）这类近似方法的局限性所在。本练习[@problem_id:3396103]将处理一个著名的模拟偏差——振动频率随温度变化的“红移”现象。通过推导并应用一个一阶校正，你将深入了解 CMD 误差的来源，并掌握提高其精度的策略。", "problem": "考虑一个质量为 $m$ 的一维量子粒子，在由四次形式 $V(q)=\\tfrac{1}{2} m \\omega_0^2 q^2 + \\tfrac{\\lambda}{4} q^4$ 近似的对称非谐势中演化。在基于质心分子动力学 (CMD) 的近似量子动力学中，Kubo 变换相关函数的振动峰位通常从质心坐标所经历的有效曲率中读取。根据经验观察，CMD 相对于精确的量子峰表现出红移，尤其是在低温下。您的任务是利用质心涨落推导一个温度相关的校正公式 $\\Delta \\omega(\\beta)$ 来解释这种红移，并对弱非和谐四次势进行数值实现和测试。\n\n您必须从以下基本基础开始：\n- 量子配分函数的虚时路径积分表示产生了一个与环状聚合物的经典同构，该聚合物具有一个特殊的质心坐标 $q_c$，即珠子坐标的算术平均值。\n- 在质心近似中，准谐振频率可以通过有效曲率到频率的映射与质心平均力势 $U_c(q_c)$ 在平衡点附近的曲率相关联。\n- 对于弱非谐性，可以通过将瞬时曲率替换为其热平均值（即通过替换 $q^2 \\mapsto \\langle q^2 \\rangle$）来获得振动频率的自洽类谐波估计。\n- 对于频率为 $\\omega_0$ 的谐波参考，精确的量子位置方差为 $\\sigma_Q^2(\\beta) = \\dfrac{\\hbar}{2 m \\omega_0} \\coth\\!\\left(\\dfrac{\\beta \\hbar \\omega_0}{2}\\right)$，质心方差为 $\\sigma_c^2(\\beta) = \\dfrac{k_{\\mathrm{B}} T}{m \\omega_0^2} = \\dfrac{1}{\\beta m \\omega_0^2}$。\n- 四次势的曲率为 $V''(q) = m \\omega_0^2 + 3 \\lambda q^2$。\n\n任务：\n- 仅使用上述基础，推导 CMD 红移校正 $\\Delta \\omega(\\beta)$ 的一阶（关于 $\\lambda$）解析表达式。该校正定义为 CMD 估计频率与准谐波量子估计频率之差，并用 $\\lambda$、$\\omega_0$、$m$ 以及方差 $\\sigma_c^2(\\beta)$ 和 $\\sigma_Q^2(\\beta)$ 之差明确表示。您的推导必须通过展开将曲率映射到频率的平方根来进行受控的弱非谐性近似，并且必须清楚地说明所有近似。\n- 在整个数值部分采用约化单位，即 $m=\\hbar=k_{\\mathrm{B}}=1$，因此所有输入和输出都是无量纲的。\n- 实现一个程序，对于给定的弱非谐四次势的 $(\\beta,\\omega_0,\\lambda)$，使用上面提供的谐波参考方差 $\\sigma_c^2(\\beta)$ 和 $\\sigma_Q^2(\\beta)$（其中 $m=\\hbar=k_{\\mathrm{B}}=1$）来计算您推导的 $\\Delta \\omega(\\beta)$。\n- 使用以下参数三元组 $(\\beta,\\omega_0,\\lambda)$ 的测试套件，这些参数被选择用于探测不同的区域：\n  - 案例 A（理想情况，中等温度，弱非谐性）：$(\\beta,\\omega_0,\\lambda) = (\\,1.0,\\,2.0,\\,0.05\\,)$。\n  - 案例 B（低温，较强非谐性）：$(\\beta,\\omega_0,\\lambda) = (\\,5.0,\\,3.0,\\,0.20\\,)$。\n  - 案例 C（谐波极限边界）：$(\\beta,\\omega_0,\\lambda) = (\\,2.0,\\,1.5,\\,0.0\\,)$。\n  - 案例 D（高温边界）：$(\\beta,\\omega_0,\\lambda) = (\\,0.10,\\,4.0,\\,0.10\\,)$。\n  - 案例 E（极低温，软四次势）：$(\\beta,\\omega_0,\\lambda) = (\\,10.0,\\,1.0,\\,0.05\\,)$。\n- 您的程序必须按规定顺序计算每个案例的校正值 $\\Delta \\omega(\\beta)$，并将其四舍五入到 $8$ 位小数后输出。\n\n角度和单位约定：\n- 所有频率和参数都是无量纲的，因为 $m=\\hbar=k_{\\mathrm{B}}=1$，并且角度没有明确出现。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D,\\text{result}_E]$，其中每个 $\\text{result}_\\cdot$ 是一个四舍五入到 $8$ 位小数的浮点值。\n\n交付内容：\n- 提供完整的推导过程以及能够为给定测试套件打印指定输出的最终可运行程序。", "solution": "该问题要求推导对于一维四次势中粒子的质心分子动力学 (CMD) 估计的振动频率相对于准谐波量子估计的红移的一阶校正。\n\n势由 $V(q) = \\frac{1}{2} m \\omega_0^2 q^2 + \\frac{\\lambda}{4} q^4$ 给出。相应的瞬时曲率是二阶导数，$V''(q) = m \\omega_0^2 + 3 \\lambda q^2$。\n\n一个自洽的准谐振频率 $\\omega$ 可以从该曲率的热平均值中估算。有效力常数 $k_{eff}$ 取为热平均值 $\\langle V''(q) \\rangle$，频率由 $\\omega^2 = k_{eff}/m$ 给出。\n$$ m \\omega^2 = \\langle V''(q) \\rangle = \\langle m \\omega_0^2 + 3 \\lambda q^2 \\rangle = m \\omega_0^2 + 3 \\lambda \\langle q^2 \\rangle $$\n这导出了频率平方的通用表达式：\n$$ \\omega^2 = \\omega_0^2 + \\frac{3 \\lambda}{m} \\langle q^2 \\rangle $$\n不同近似之间的关键区别在于均方位移 $\\langle q^2 \\rangle$ 的选择。\n\n首先，我们基于这种自洽方法建立一个参考量子频率。对于弱非谐势，我们可以用频率为 $\\omega_0$ 的谐振子的精确方差来近似真实的量子热平均 $\\langle q^2 \\rangle_Q$。这被提供为 $\\sigma_Q^2(\\beta)$。因此，我们的近似量子频率 $\\omega_{Q,approx}$ 由下式确定：\n$$ \\omega_{Q,approx}^2 = \\omega_0^2 + \\frac{3 \\lambda}{m} \\sigma_Q^2(\\beta) $$\n其中谐波量子方差为 $\\sigma_Q^2(\\beta) = \\dfrac{\\hbar}{2 m \\omega_0} \\coth\\!\\left(\\dfrac{\\beta \\hbar \\omega_0}{2}\\right)$。\n\n接下来，我们为 CMD 构建相应的频率。CMD 有效地描述了路径积分质心坐标 $q_c$ 的动力学。质心的分布比单个珠子的完整量子分布更窄。问题暗示，CMD 对频率的估计可以通过在我们的自洽公式中使用质心坐标的方差 $\\sigma_c^2(\\beta)$ 来代替完整的量子方差来获得。这抓住了质心分布“尺寸”减小如何影响感知到的平均曲率的本质。因此，CMD 频率 $\\omega_{CMD}$ 由下式给出：\n$$ \\omega_{CMD}^2 = \\omega_0^2 + \\frac{3 \\lambda}{m} \\sigma_c^2(\\beta) $$\n其中谐波质心方差为 $\\sigma_c^2(\\beta) = \\dfrac{k_{\\mathrm{B}} T}{m \\omega_0^2} = \\dfrac{1}{\\beta m \\omega_0^2}$。\n\n频率位移 $\\Delta \\omega(\\beta)$ 是差值 $\\omega_{CMD} - \\omega_{Q,approx}$。\n$$ \\Delta \\omega(\\beta) = \\sqrt{\\omega_0^2 + \\frac{3 \\lambda}{m} \\sigma_c^2(\\beta)} - \\sqrt{\\omega_0^2 + \\frac{3 \\lambda}{m} \\sigma_Q^2(\\beta)} $$\n为了获得非谐性参数 $\\lambda$ 的一阶表达式，我们对平方根函数进行泰勒展开 $\\sqrt{A+x} \\approx \\sqrt{A} + \\frac{x}{2\\sqrt{A}}$（对于小的 $x$）。我们可以将频率重写为：\n$$ \\omega = \\omega_0 \\sqrt{1 + \\frac{3 \\lambda}{m \\omega_0^2} \\langle q^2 \\rangle} $$\n应用展开式 $\\sqrt{1+\\epsilon} \\approx 1 + \\frac{1}{2}\\epsilon$（对于小的 $\\epsilon = \\frac{3 \\lambda}{m \\omega_0^2} \\langle q^2 \\rangle$）：\n$$ \\omega \\approx \\omega_0 \\left(1 + \\frac{1}{2} \\frac{3 \\lambda}{m \\omega_0^2} \\langle q^2 \\rangle \\right) = \\omega_0 + \\frac{3 \\lambda}{2 m \\omega_0} \\langle q^2 \\rangle $$\n将此线性近似应用于 $\\omega_{CMD}$ 和 $\\omega_{Q,approx}$：\n$$ \\omega_{CMD} \\approx \\omega_0 + \\frac{3 \\lambda}{2 m \\omega_0} \\sigma_c^2(\\beta) $$\n$$ \\omega_{Q,approx} \\approx \\omega_0 + \\frac{3 \\lambda}{2 m \\omega_0} \\sigma_Q^2(\\beta) $$\n从第一个表达式中减去第二个表达式，得到所需的频率位移一阶校正：\n$$ \\Delta \\omega(\\beta) = \\omega_{CMD} - \\omega_{Q,approx} \\approx \\left(\\omega_0 + \\frac{3 \\lambda}{2 m \\omega_0} \\sigma_c^2(\\beta)\\right) - \\left(\\omega_0 + \\frac{3 \\lambda}{2 m \\omega_0} \\sigma_Q^2(\\beta)\\right) $$\n$$ \\Delta \\omega(\\beta) \\approx \\frac{3 \\lambda}{2 m \\omega_0} \\left( \\sigma_c^2(\\beta) - \\sigma_Q^2(\\beta) \\right) $$\n这是红移的最终解析表达式。它是关于 $\\lambda$ 的一阶表达式，并明确地依赖于质心方差和量子方差之差，正如所要求的。由于已知在任何有限温度下 $\\sigma_c^2(\\beta)  \\sigma_Q^2(\\beta)$（即质心比单个珠子更局域化），因此对于 $\\lambda > 0$，位移 $\\Delta \\omega(\\beta)$ 将为负，对应于红移，这与 CMD 的经验观察结果一致。\n\n对于数值实现，我们使用约化单位，其中 $m=1$, $\\hbar=1$, $k_{\\mathrm{B}}=1$。公式变为：\n$$ \\sigma_c^2(\\beta) = \\frac{1}{\\beta \\omega_0^2} $$\n$$ \\sigma_Q^2(\\beta) = \\frac{1}{2 \\omega_0} \\coth\\left(\\frac{\\beta \\omega_0}{2}\\right) $$\n$$ \\Delta \\omega(\\beta) = \\frac{3 \\lambda}{2 \\omega_0} \\left( \\frac{1}{\\beta \\omega_0^2} - \\frac{1}{2 \\omega_0} \\coth\\left(\\frac{\\beta \\omega_0}{2}\\right) \\right) $$\n此表达式将被实现以评估给定测试案例的校正。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the CMD frequency red-shift correction for a weakly\n    anharmonic quartic potential based on a derived first-order formula.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (beta, omega0, lambda)\n    test_cases = [\n        (1.0, 2.0, 0.05),   # Case A\n        (5.0, 3.0, 0.20),   # Case B\n        (2.0, 1.5, 0.0),    # Case C\n        (0.10, 4.0, 0.10),  # Case D\n        (10.0, 1.0, 0.05),  # Case E\n    ]\n\n    results = []\n\n    # The required numpy version (1.23.5) does not have np.coth.\n    # We implement it manually.\n    def coth(x):\n        \"\"\"\n        Calculates the hyperbolic cotangent.\n        This implementation is stable for a wide range of x values.\n        \"\"\"\n        # For very large x, tanh(x) -> 1, so coth(x) -> 1.\n        # This check is for robustness, though not strictly required by the test cases.\n        if x > 30: \n            return 1.0\n        return 1.0 / np.tanh(x)\n\n\n    for case in test_cases:\n        beta, omega0, lam = case\n\n        # The special case of lambda = 0 (harmonic potential) must result in a zero shift.\n        if lam == 0.0:\n            results.append(0.0)\n            continue\n            \n        # The problem is defined for omega0 > 0.\n        \n        # Reduced units are used: m = 1, h_bar = 1, k_B = 1.\n\n        # Calculate the harmonic centroid variance\n        # sigma_c^2(beta) = 1 / (beta * m * omega0^2)\n        sigma_c_sq = 1.0 / (beta * omega0**2)\n\n        # Calculate the harmonic quantum position variance\n        # sigma_Q^2(beta) = (hbar / (2 * m * omega0)) * coth(beta * hbar * omega0 / 2)\n        coth_arg = beta * omega0 / 2.0\n        sigma_Q_sq = (1.0 / (2.0 * omega0)) * coth(coth_arg)\n\n        # Calculate the first-order frequency shift\n        # Delta_omega(beta) = (3 * lambda / (2 * m * omega0)) * (sigma_c^2 - sigma_Q^2)\n        delta_omega = (3.0 * lam / (2.0 * omega0)) * (sigma_c_sq - sigma_Q_sq)\n        \n        results.append(delta_omega)\n\n    # Format the results to 8 decimal places and print in the specified format.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3396103"}]}