{"hands_on_practices": [{"introduction": "为了真正掌握软核势如何防止端点奇点，进行一次直接计算是很有帮助的。本练习要求您计算一个特定中间态的软核Lennard-Jones势，并将其与简单的线性标度势进行比较。这个对比将量化地展示软核修正的效果，这对于在炼金术变换过程中维持数值稳定性至关重要。[@problem_id:3447059]", "problem": "在采用双拓扑方案的炼金自由能计算中，一个消失位点的范德华相互作用由耦合参数 $\\lambda$ 调制，并使用软核势进行正则化以避免端点奇异性。考虑在经典分子动力学框架中，一个 Lennard-Jones (LJ) 位点与一个环境位点相互作用，两者间距为 $r$。Lennard-Jones 参数为 $\\epsilon=0.2~\\text{kcal/mol}$ 和 $\\sigma=3.5~\\text{\\AA}$。软核正则化引入了一个距离修正，该修正由单位为 $\\text{\\AA}^6$ 的参数 $\\alpha$ 控制，并引入了用于 $\\lambda$ 依赖振幅的缩放指数 $p$ 和用于 $(1-\\lambda)$ 依赖软化的缩放指数 $q$。假设采用广泛使用的软核范式，其中 LJ 相互作用按 $\\lambda^p$ 缩放，并且对势中的分母通过一个依赖于 $\\alpha$ 和 $(1-\\lambda)^q$ 的附加位移项进行软化。\n\n在耦合状态 $\\lambda=0.5$、间距 $r=3.5~\\text{\\AA}$，且参数为 $\\alpha=0.5~\\text{\\AA}^6$、$p=1$ 和 $q=2$ 时，计算软核 Lennard-Jones 势 $U_{\\text{sc}}^{\\text{LJ}}(r;\\lambda)$，并将其与同一点的线性缩放 Lennard-Jones 值进行比较，后者定义为不对标准 Lennard-Jones 相互作用进行软核正则化，而是直接通过 $\\lambda$ 进行线性缩放得到的势。以单个数字报告差值 $\\Delta U = U_{\\text{sc}}^{\\text{LJ}}(r;\\lambda) - U_{\\text{lin}}^{\\text{LJ}}(r;\\lambda)$。最终能量以 kcal/mol 为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求在一组特定条件下，计算软核 Lennard-Jones (LJ) 势 $U_{\\text{sc}}^{\\text{LJ}}(r;\\lambda)$ 与线性缩放 LJ 势 $U_{\\text{lin}}^{\\text{LJ}}(r;\\lambda)$ 之间的差值 $\\Delta U$。\n\n首先，我们确定两个相距为 $r$ 的位点之间的标准 Lennard-Jones 势的函数形式：\n$$\nU_{\\text{LJ}}(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n$$\n此处，$\\epsilon$ 代表势阱深度，$\\sigma$ 是粒子间势能为零时的有限距离。\n\n问题将线性缩放 Lennard-Jones 势 $U_{\\text{lin}}^{\\text{LJ}}$ 定义为标准 LJ 势由耦合参数 $\\lambda$ 线性缩放得到。其函数形式为：\n$$\nU_{\\text{lin}}^{\\text{LJ}}(r; \\lambda) = \\lambda U_{\\text{LJ}}(r) = \\lambda \\cdot 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n$$\n给定的值为：$\\epsilon = 0.2 \\text{ kcal/mol}$，$\\sigma = 3.5 \\text{ \\AA}$，$\\lambda = 0.5$ 以及 $r = 3.5 \\text{ \\AA}$。一个关键的简化来自于间距 $r$ 与 LJ 参数 $\\sigma$ 相同这一事实。将 $r = \\sigma$ 代入 $U_{\\text{lin}}^{\\text{LJ}}$ 的表达式中，得到：\n$$\nU_{\\text{lin}}^{\\text{LJ}}(r=\\sigma; \\lambda=0.5) = 0.5 \\cdot 4(0.2) \\left[ \\left(\\frac{\\sigma}{\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{\\sigma}\\right)^{6} \\right] = 0.4 \\left[ 1^{12} - 1^6 \\right] = 0.4 \\left[ 1 - 1 \\right] = 0 \\text{ kcal/mol}\n$$\n因此，在指定条件下，线性缩放的势能精确为零。\n\n接下来，我们定义软核 Lennard-Jones 势 $U_{\\text{sc}}^{\\text{LJ}}$。问题陈述相互作用按 $\\lambda^p$ 缩放，且分母通过一个依赖于 $\\alpha$ 和 $(1-\\lambda)^q$ 的附加位移项进行软化。这对应于一种广泛使用的软核势形式，其中标准 LJ 势中的 $r^6$ 项被一个软化项所取代。鉴于 $\\alpha$ 的单位是 $\\text{\\AA}^6$，最合乎逻辑和标准的解释是项 $r^6$ 被 $(r^6 + \\alpha(1-\\lambda)^q)$ 所取代。完整的势为：\n$$\nU_{\\text{sc}}^{\\text{LJ}}(r; \\lambda) = \\lambda^p \\cdot 4\\epsilon \\left[ \\frac{\\sigma^{12}}{(r^6 + \\alpha(1-\\lambda)^q)^2} - \\frac{\\sigma^6}{r^6 + \\alpha(1-\\lambda)^q} \\right]\n$$\n问题提供了缩放指数 $p=1$ 和 $q=2$，以及软核参数 $\\alpha = 0.5 \\text{ \\AA}^6$。我们像之前一样使用其他参数：$\\epsilon = 0.2 \\text{ kcal/mol}$，$\\sigma = 3.5 \\text{ \\AA}$，$r = 3.5 \\text{ \\AA}$，以及 $\\lambda = 0.5$。\n\n让我们计算该表达式的各个组成部分。\n总缩放因子为 $\\lambda^p \\cdot 4\\epsilon = (0.5)^1 \\cdot 4(0.2) = 0.4 \\text{ kcal/mol}$。\n附加软化项为 $\\alpha(1-\\lambda)^q = 0.5 \\cdot (1-0.5)^2 = 0.5 \\cdot (0.5)^2 = 0.5 \\cdot 0.25 = 0.125 \\text{ \\AA}^6$。\n裸距离依赖项为 $r^6 = (3.5)^6 \\text{ \\AA}^6$ 和 $\\sigma^6 = (3.5)^6 \\text{ \\AA}^6$。令 $S = \\sigma^6 = (3.5)^6$。\n$S = (3.5^2)^3 = (12.25)^3 = 1838.265625 \\text{ \\AA}^6$。\n软化的分母项为 $r^6 + \\alpha(1-\\lambda)^q = S + 0.125 = 1838.265625 + 0.125 = 1838.390625 \\text{ \\AA}^6$。\n\n将这些值代入 $U_{\\text{sc}}^{\\text{LJ}}$ 的表达式中：\n$$\nU_{\\text{sc}}^{\\text{LJ}} = 0.4 \\left[ \\frac{S^2}{(S + 0.125)^2} - \\frac{S}{S + 0.125} \\right]\n$$\n为简化括号中的项，我们使用通分：\n$$\n\\frac{S^2 - S(S + 0.125)}{(S + 0.125)^2} = \\frac{S^2 - S^2 - 0.125S}{(S + 0.125)^2} = \\frac{-0.125S}{(S + 0.125)^2}\n$$\n现在，我们计算势能：\n$$\nU_{\\text{sc}}^{\\text{LJ}} = 0.4 \\left[ \\frac{-0.125 \\cdot (1838.265625)}{(1838.390625)^2} \\right] \\text{ kcal/mol}\n$$\n分数的分子为 $-0.125 \\times 1838.265625 = -229.783203125$。\n分母为 $(1838.390625)^2 = 3379693.359573364$。\n$$\nU_{\\text{sc}}^{\\text{LJ}} = 0.4 \\left[ \\frac{-229.783203125}{3379693.359573364} \\right] \\approx 0.4 \\cdot (-6.79893900 \\times 10^{-5})\n$$\n$$\nU_{\\text{sc}}^{\\text{LJ}} \\approx -2.7195756 \\times 10^{-5} \\text{ kcal/mol}\n$$\n问题要求计算差值 $\\Delta U = U_{\\text{sc}}^{\\text{LJ}} - U_{\\text{lin}}^{\\text{LJ}}$。既然我们发现 $U_{\\text{lin}}^{\\text{LJ}} = 0$，那么差值就是软核势的值。\n$$\n\\Delta U = -2.7195756 \\times 10^{-5} - 0 = -2.7195756 \\times 10^{-5} \\text{ kcal/mol}\n$$\n最后，我们必须将结果四舍五入到四位有效数字。第五位有效数字是 $5$，因此我们将前一位数字向上取整。\n$$\n\\Delta U \\approx -2.720 \\times 10^{-5} \\text{ kcal/mol}\n$$\n这个结果说明软核势偏离了简单的线性缩放，引入了一个小的能量修正，这对于在炼金转换过程中维持数值稳定性至关重要。", "answer": "$$\n\\boxed{-2.720 \\times 10^{-5}}\n$$", "id": "3447059"}, {"introduction": "通过热力学积分法计算炼金术自由能，其核心在于对势能相对于耦合参数 $\\lambda$ 的导数进行系综平均。本练习将通过要求您推导这个关键量 $\\partial U / \\partial \\lambda$，为您提供处理软核势微积分的实践经验。完成此推导将阐明各种标度参数如何影响炼金术路径上的自由能梯度，并加深对自由能计算中被积函数的理解。[@problem_id:3447014]", "problem": "在炼金术变换的分子动力学 (MD) 模拟中，使用软核势来正则化相互作用能相对于无量纲耦合参数 $\\lambda \\in [0,1]$ 插值时的奇点。考虑由粒子间距 $r$ 定义的软核 Lennard-Jones (LJ) 势\n$$\nU_{\\text{sc}}^{\\text{LJ}}(r;\\lambda) = \\lambda^{p}\\,4\\epsilon\\left[\\frac{\\sigma^{12}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{2}} - \\frac{\\sigma^{6}}{r^{6}+\\alpha(1-\\lambda)^{q}}\\right],\n$$\n其中 $\\epsilon0$ 和 $\\sigma0$ 是常规的 Lennard-Jones 参数，$\\alpha0$ 是软核参数，$p0$ 和 $q0$ 是用于控制能量学随 $\\lambda$ 变化的标度指数。从该势的定义和微积分中的链式法则出发，推导在 $r$ 固定时其偏导数 $\\partial U_{\\text{sc}}^{\\text{LJ}}/\\partial \\lambda$，并对结果进行代数简化，以明确分离出与 $\\lambda^{p-1}$ 和 $(1-\\lambda)^{q-1}$ 成正比的贡献项。最终答案需表示为仅包含 $r$、$\\lambda$、$p$、$q$、$\\epsilon$、$\\sigma$ 和 $\\alpha$ 的单一闭合形式解析表达式。无需进行数值计算或四舍五入。", "solution": "该问题要求推导软核 Lennard-Jones 势 $U_{\\text{sc}}^{\\text{LJ}}(r;\\lambda)$ 相对于耦合参数 $\\lambda$ 的偏导数。该势由下式给出：\n$$\nU_{\\text{sc}}^{\\text{LJ}}(r;\\lambda) = \\lambda^{p}\\,4\\epsilon\\left[\\frac{\\sigma^{12}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{2}} - \\frac{\\sigma^{6}}{r^{6}+\\alpha(1-\\lambda)^{q}}\\right]\n$$\n在进行此偏微分时，参数 $r, \\epsilon, \\sigma, \\alpha, p, q$ 被视为常数。为简化计算，我们为公共分母表达式定义一个辅助函数 $D(\\lambda)$：\n$$\nD(\\lambda) = r^{6}+\\alpha(1-\\lambda)^{q}\n$$\n根据这个定义，势 $U_{\\text{sc}}^{\\text{LJ}}$ 可以重写为：\n$$\nU_{\\text{sc}}^{\\text{LJ}}(\\lambda) = 4\\epsilon \\lambda^{p} \\left( \\sigma^{12} D(\\lambda)^{-2} - \\sigma^{6} D(\\lambda)^{-1} \\right)\n$$\n我们需要计算 $\\frac{\\partial U_{\\text{sc}}^{\\text{LJ}}}{\\partial \\lambda}$。该函数的结构是两个依赖于 $\\lambda$ 的项的乘积，即 $\\lambda^p$ 和括号中的表达式，我们可以将后者记为 $f(\\lambda) = 4\\epsilon \\left( \\sigma^{12} D(\\lambda)^{-2} - \\sigma^{6} D(\\lambda)^{-1} \\right)$。我们应用微分的乘法法则：\n$$\n\\frac{\\partial U_{\\text{sc}}^{\\text{LJ}}}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} (\\lambda^{p}) \\cdot f(\\lambda) + \\lambda^{p} \\cdot \\frac{\\partial f(\\lambda)}{\\partial \\lambda}\n$$\n首先，我们计算第一项因子 $\\lambda^p$ 的导数：\n$$\n\\frac{\\partial}{\\partial \\lambda} (\\lambda^{p}) = p\\lambda^{p-1}\n$$\n这给出了导数的第一项：\n$$\n\\text{第一项} = p\\lambda^{p-1} \\cdot 4\\epsilon \\left( \\sigma^{12} D(\\lambda)^{-2} - \\sigma^{6} D(\\lambda)^{-1} \\right)\n$$\n此项与 $\\lambda^{p-1}$ 成正比，符合要求。\n\n接下来，我们计算第二项因子 $f(\\lambda)$ 的导数。这需要使用链式法则，因为 $f$ 通过 $D(\\lambda)$ 依赖于 $\\lambda$。\n$$\n\\frac{\\partial f(\\lambda)}{\\partial \\lambda} = \\frac{\\partial f}{\\partial D} \\cdot \\frac{\\partial D}{\\partial \\lambda}\n$$\n我们首先求出 $D(\\lambda)$ 相对于 $\\lambda$ 的导数：\n$$\n\\frac{\\partial D}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( r^{6}+\\alpha(1-\\lambda)^{q} \\right) = \\alpha \\cdot q(1-\\lambda)^{q-1} \\cdot (-1) = -\\alpha q(1-\\lambda)^{q-1}\n$$\n然后，我们求出 $f(D)$ 相对于 $D$ 的导数：\n$$\n\\frac{\\partial f}{\\partial D} = \\frac{\\partial}{\\partial D} \\left[ 4\\epsilon \\left( \\sigma^{12} D^{-2} - \\sigma^{6} D^{-1} \\right) \\right] = 4\\epsilon \\left( \\sigma^{12}(-2)D^{-3} - \\sigma^{6}(-1)D^{-2} \\right)\n$$\n$$\n\\frac{\\partial f}{\\partial D} = 4\\epsilon \\left( -2\\sigma^{12}D^{-3} + \\sigma^{6}D^{-2} \\right)\n$$\n使用链式法则组合这些结果：\n$$\n\\frac{\\partial f(\\lambda)}{\\partial \\lambda} = 4\\epsilon \\left( \\sigma^{6}D^{-2} - 2\\sigma^{12}D^{-3} \\right) \\cdot \\left( -\\alpha q(1-\\lambda)^{q-1} \\right)\n$$\n$$\n\\frac{\\partial f(\\lambda)}{\\partial \\lambda} = 4\\epsilon \\alpha q(1-\\lambda)^{q-1} \\left( 2\\sigma^{12}D^{-3} - \\sigma^{6}D^{-2} \\right)\n$$\n那么总导数的第二项是 $\\lambda^{p} \\cdot \\frac{\\partial f(\\lambda)}{\\partial \\lambda}$：\n$$\n\\text{第二项} = \\lambda^{p} \\cdot 4\\epsilon \\alpha q(1-\\lambda)^{q-1} \\left( 2\\sigma^{12}D(\\lambda)^{-3} - \\sigma^{6}D(\\lambda)^{-2} \\right)\n$$\n此项与 $(1-\\lambda)^{q-1}$ 成正比，符合要求。\n\n完整导数是第一项和第二项的和：\n$$\n\\frac{\\partial U_{\\text{sc}}^{\\text{LJ}}}{\\partial \\lambda} = p\\lambda^{p-1} \\cdot 4\\epsilon \\left( \\sigma^{12} D^{-2} - \\sigma^{6} D^{-1} \\right) + \\lambda^{p} \\cdot 4\\epsilon \\alpha q(1-\\lambda)^{q-1} \\left( 2\\sigma^{12}D^{-3} - \\sigma^{6}D^{-2} \\right)\n$$\n最后，我们将 $D(\\lambda) = r^{6}+\\alpha(1-\\lambda)^{q}$ 的定义代回表达式中，以获得用指定变量表示的最终答案。\n$$\n\\frac{\\partial U_{\\text{sc}}^{\\text{LJ}}}{\\partial \\lambda} = 4\\epsilon p\\lambda^{p-1} \\left[ \\frac{\\sigma^{12}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{2}} - \\frac{\\sigma^{6}}{r^{6}+\\alpha(1-\\lambda)^{q}} \\right] + 4\\epsilon \\alpha q \\lambda^{p} (1-\\lambda)^{q-1} \\left[ \\frac{2\\sigma^{12}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{3}} - \\frac{\\sigma^{6}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{2}} \\right]\n$$\n该表达式是完整的偏导数，经过代数简化，明确分离了与 $\\lambda^{p-1}$ 和 $(1-\\lambda)^{q-1}$ 成正比的贡献项。", "answer": "$$\n\\boxed{4\\epsilon p\\lambda^{p-1} \\left( \\frac{\\sigma^{12}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{2}} - \\frac{\\sigma^{6}}{r^{6}+\\alpha(1-\\lambda)^{q}} \\right) + 4\\epsilon \\alpha q \\lambda^{p} (1-\\lambda)^{q-1} \\left( \\frac{2\\sigma^{12}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{3}} - \\frac{\\sigma^{6}}{\\left(r^{6}+\\alpha(1-\\lambda)^{q}\\right)^{2}} \\right)}\n$$", "id": "3447014"}, {"introduction": "一次炼金术变换涉及修改的不仅仅是单个非键相互作用，它要求对整个势能函数进行一致的处理。本练习探讨了一个关键的实践问题：在双拓扑结构框架中，应如何处理键合项（键、角、二面角）和其他分子内特殊相互作用。通过对不同选项的推理，您将学会如何构建一个稳定且热力学上合理的哈密顿量，从而避免那些可能导致模拟不稳定的常见陷阱。[@problem_id:3446976]", "problem": "在分子动力学 (MD) 中，对水中的一个溶质进行双拓扑炼金自由能计算，以将同一母体骨架上的取代基 $X$ 转换为取代基 $Y$。该双拓扑设置包含两个不相交的炼金原子集：集合 $A$ (代表 $X$) 和集合 $B$ (代表 $Y$)。在每个端点，只有一个取代基应与环境相互作用，中间的耦合由参数 $\\lambda \\in [0,1]$ 控制。该模拟使用软核非键势来避免在开启或关闭相互作用时出现奇异点。\n\n考虑总势能，其示意性地写作\n$$\nU(\\mathbf{r};\\lambda) = U_{\\mathrm{bond}}^{A} + U_{\\mathrm{bond}}^{B} + U_{1\\text{--}4}^{A} + U_{1\\text{--}4}^{B} + U_{\\mathrm{env}}(\\mathbf{r};\\lambda) + U_{A\\text{--}B}(\\mathbf{r};\\lambda),\n$$\n其中 $U_{\\mathrm{bond}}^{A}$ 和 $U_{\\mathrm{bond}}^{B}$ 是集合 $A$ 和 $B$ 内部的键合项（键、角、二面角）的总和，$U_{1\\text{--}4}^{A}$ 和 $U_{1\\text{--}4}^{B}$ 是 $A$ 和 $B$ 内部的特殊 $1$–$4$ 分子内非键项（采用力场规定的任何标准 $1$–$4$ 修正因子），$U_{\\mathrm{env}}(\\mathbf{r};\\lambda)$ 包含了炼金原子与系统其余部分（包括溶剂和溶质的非炼金部分）之间的所有相互作用，$U_{A\\text{--}B}(\\mathbf{r};\\lambda)$ 包含了集合 $A$ 和 $B$ 之间的任何交叉相互作用。\n\n您的目标是，在采用软核非键势的双拓扑方案下，为炼金区域内的键合项和 $1$–$4$ 相互作用选择一个缩放策略，该策略需满足以下第一性原理要求：\n\n- 在 $\\lambda=0$ 时，只有拓扑 $A$ 与环境发生非键相互作用；在 $\\lambda=1$ 时，只有拓扑 $B$ 与环境发生非键相互作用，并且端点对应于两种状态的物理哈密顿量。\n- 通过热力学积分计算的自由能差，\n$$\n\\Delta F = \\int_{0}^{1} \\left\\langle \\frac{\\partial U(\\mathbf{r};\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda,\n$$\n必须是良定义的，即路径上的 $\\partial U/\\partial \\lambda$ 是有限且连续的，并且没有重复计算相互作用。\n- 在开启或关闭相互作用时，不会因粒子重叠而产生伪奇异点或端点灾难。\n\n以下哪种策略在热力学上与这些要求一致？\n\nA. 对两种拓扑，都保持 $U_{\\mathrm{bond}}^{A}$、$U_{\\mathrm{bond}}^{B}$、$U_{1\\text{--}4}^{A}$ 和 $U_{1\\text{--}4}^{B}$ 的完全强度且与 $\\lambda$ 无关；对于所有 $\\lambda$，设置 $U_{A\\text{--}B}(\\mathbf{r};\\lambda)=0$；仅使用软核非键势缩放炼金原子与环境之间的相互作用，使得 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)=(1-\\lambda)\\,U_{\\mathrm{env}}^{A,\\mathrm{sc}} + \\lambda\\,U_{\\mathrm{env}}^{B,\\mathrm{sc}}$。\n\nB. 将涉及任何炼金原子的所有相互作用（包括键、角、二面角和 $1$–$4$ 项）随 $\\lambda$ 线性缩放，并在关闭键合项时对其应用软核函数形式，以便解耦拓扑内的所有内部结构在相应的端点处坍缩。\n\nC. 保持键合项 $U_{\\mathrm{bond}}^{A}$ 和 $U_{\\mathrm{bond}}^{B}$ 恒定，但将涉及炼金原子的所有 $1$–$4$ 相互作用（包括 $A$ 内部和 $B$ 内部的分子内 $1$–$4$ 对）与 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)$ 一起使用软核势进行缩放。\n\nD. 保持所有分子内项恒定，但仅将 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)$ 的库仑部分随 $\\lambda$ 线性缩放且不使用软核，同时保持 Lennard-Jones 部分不缩放，以避免在小间距处过度正则化；允许 $U_{A\\text{--}B}(\\mathbf{r};\\lambda)$ 在中间 $\\lambda$ 值处非零以平滑过渡。\n\n选择唯一的最佳选项，并根据上述基本要求进行论证，包括对炼金区域内键合项和 $1$–$4$ 相互作用处理的明确推理。", "solution": "用户希望得到一个关于分子动力学中炼金自由能计算问题的、经过审慎验证的解决方案。\n\n### 问题验证\n\n首先，我将根据指定标准验证问题陈述。\n\n#### 第 1 步：提取已知条件\n\n*   **系统**：对水中的一个溶质进行的双拓扑炼金自由能计算。\n*   **转换**：取代基 $X$（由原子集 $A$ 代表）被转换为取代基 $Y$（由原子集 $B$ 代表）。集合 $A$ 和 $B$ 不相交。\n*   **耦合参数**：$\\lambda \\in [0,1]$。\n*   **势能**：$U(\\mathbf{r};\\lambda) = U_{\\mathrm{bond}}^{A} + U_{\\mathrm{bond}}^{B} + U_{1\\text{--}4}^{A} + U_{1\\text{--}4}^{B} + U_{\\mathrm{env}}(\\mathbf{r};\\lambda) + U_{A\\text{--}B}(\\mathbf{r};\\lambda)$。\n*   **术语定义**：\n    *   $U_{\\mathrm{bond}}^{A}, U_{\\mathrm{bond}}^{B}$：集合 $A$ 和 $B$ 内部的键合项。\n    *   $U_{1\\text{--}4}^{A}, U_{1\\text{--}4}^{B}$：$A$ 和 $B$ 内部的特殊 $1$–$4$ 分子内非键项。\n    *   $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)$：炼金原子（$A$ 或 $B$）与环境之间的相互作用。\n    *   $U_{A\\text{--}B}(\\mathbf{r};\\lambda)$：集合 $A$ 和 $B$ 之间的交叉相互作用。\n*   **方法**：使用软核非键势来避免奇异点。\n*   **有效缩放策略的要求**：\n    1.  端点对应：在 $\\lambda=0$ 时，只有拓扑 $A$ 与环境发生非键相互作用。在 $\\lambda=1$ 时，只有拓扑 $B$ 与环境发生非键相互作用。端点必须对应于两种状态的物理哈密顿量。\n    2.  良定义的自由能积分：$\\Delta F = \\int_{0}^{1} \\left\\langle \\frac{\\partial U(\\mathbf{r};\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda$ 必须是良定义的，意味着 $\\partial U/\\partial \\lambda$ 是有限且连续的，并且没有重复计算。\n    3.  无奇异点：不应产生奇异点或端点灾难。\n\n#### 第 2 步：使用提取的已知条件进行验证\n\n*   **科学基础**：该问题坚实地植根于统计力学和计算化学的原理。双拓扑炼金计算是分子建模中用于计算相对结合或溶剂化自由能的一种标准（尽管复杂）的技术。所使用的术语（$U_{\\mathrm{bond}}$、软核势、热力学积分）在该领域是标准的。该问题在科学上是合理的。\n*   **定义明确**：该问题提供了一个明确的目标（选择一个热力学上一致的策略）和一组明确、严格的约束条件（物理端点、良定义的积分、无奇异点）。它的结构旨在根据已建立的生物物理模拟原理，在选项中找到唯一的最佳答案。\n*   **客观性**：语言是技术性的、精确的，并且没有主观性。这些要求是客观的标准，可以用来评判各个选项。\n\n#### 第 3 步：结论和行动\n\n问题陈述是有效的。这是一个关于在分子动力学中正确实施常用方法的、表述良好的问题，需要对潜在的物理和数学原理有扎实的理解。我现在将进行解决方案的推导和选项分析。\n\n### 热力学一致策略的推导\n\n目标是找到一个连接具有取代基 $X$ 的溶质物理状态（状态 A）和具有取代基 $Y$ 的物理状态（状态 B）之间的映射，这个映射必须是平滑且在热力学上合理的。自由能差通过热力学积分计算，$\\Delta F = \\int_{0}^{1} \\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} d\\lambda$。\n\n1.  **要求 3：无奇异点**：非键相互作用（Lennard-Jones 或库仑）的产生或消失可能导致奇异点。例如，如果一个势能项 $U_{nb}$ 按 $\\lambda$ 缩放，当 $\\lambda \\to 0$ 时，随着粒子靠近（$r \\to 0$），其导数 $\\partial U_{nb}/\\partial\\lambda$ 可能会发散。软核势是专门为修改小 $r$ 处的势而设计的，以使势及其对 $\\lambda$ 的导数都保持有限。因此，任何作为 $\\lambda$ 函数的非键相互作用项都必须用软核形式实现。这适用于 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)$，也可能适用于 $U_{A\\text{--}B}(\\mathbf{r};\\lambda)$ 或内部非键项（如果它们被缩放的话）。\n\n2.  **要求 1：物理端点**：这是一个关键而微妙的要求。严格的解释意味着在 $\\lambda=0$ 时，总势能函数 $U(\\mathbf{r}; \\lambda=0)$ 与状态 A 的物理哈密顿量 $U_{\\text{phys}, A}$ 完全相同。这将意味着与原子集 $B$ 相关的所有能量项都必须为零：$U_{\\mathrm{bond}}^{B}=0$，$U_{1\\text{--}4}^{B}=0$，并且 $U_{\\mathrm{env}}$ 中与 $B$ 相关的部分也必须为零。对称地，在 $\\lambda=1$ 时，与 $A$ 相关的所有项都必须为零。关闭键合项（$U_{\\mathrm{bond}}$）是有问题的，因为它会使取代基“坍缩”或“爆炸”，导致模拟路径出现病态，收敛性差。\n\n    在双拓扑计算的背景下，一个更实用和标准的解释是，端点哈密顿量生成的系综可以恢复状态的物理性质。如果虚拟原子（例如，在 $\\lambda=0$ 时的集合 $B$）具有一个恒定（与 $\\lambda$ 无关）的内部势，并且不与系统的其余部分相互作用，它们对总能量的贡献是一个恒定的偏移量，对配分函数的贡献是一个常数因子。这个恒定的贡献不影响导数 $\\partial U / \\partial \\lambda$，因此对计算出的 $\\Delta F$ 没有贡献。由此产生的自由能差对应于一个明确定义的热力学循环：\n    $$ \\Delta F_{\\text{calc}} = (F_{Y,\\text{solv}} + F_{A,\\text{dummy}}) - (F_{X,\\text{solv}} + F_{B,\\text{dummy}}) = \\Delta F_{\\text{solv}} + \\Delta F_{\\text{dummy}} $$\n    这是一个有效的方法，前提是 $\\Delta F_{\\text{dummy}}$ 项要么为零，要么可以计算并减去。为了模拟的稳定性，保持虚拟基团内部结构的完整性是非常有利的。这可以防止非物理构象并提高采样效率。为了保持结构完整，键合项（$U_{\\mathrm{bond}}$）和邻近的非键项（$U_{1-4}$）都必须维持。\n\n3.  **要求 2：良定义的积分**：这要求 $\\partial U / \\partial \\lambda$ 是有限且连续的。通过对缩放的非键项使用软核势，并避免以产生不稳定性的方式缩放键合项，可以确保这一点。如果像 $U_{\\mathrm{bond}}$ 和 $U_{1\\text{--}4}$ 这样的内部势保持恒定（与 $\\lambda$ 无关），它们对 $\\partial U / \\partial \\lambda$ 的贡献为零，从而简化计算并增强稳定性。\n\n基于这些原则，一个最优且一致的策略将是：\n*   保持分子内势 $U_{\\mathrm{bond}}^{A}$、$U_{\\mathrm{bond}}^{B}$、$U_{1\\text{--}4}^{A}$ 和 $U_{1\\text{--}4}^{B}$ 恒定且与 $\\lambda$ 无关。这维持了“真实”和“虚拟”取代基的结构完整性，防止了虚拟基团的非物理坍缩，并确保了稳定的模拟路径。由于这些项是恒定的，它们对 $\\Delta F$ 积分没有贡献。\n*   使用软核势来缩放与环境的相互作用。具体来说，集合 $A$ 与环境的相互作用 $U_{\\mathrm{env}}^A$ 应从 $\\lambda=0$ 到 $\\lambda=1$ 逐渐减小，而集合 $B$ 与环境的相互作用 $U_{\\mathrm{env}}^B$ 应逐渐增大。一个典型的函数形式是 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda) = f(\\lambda) U_{\\mathrm{env}}^{A,\\mathrm{sc}} + g(\\lambda) U_{\\mathrm{env}}^{B,\\mathrm{sc}}$，例如 $f(\\lambda)=1-\\lambda$ 和 $g(\\lambda)=\\lambda$。\n*   恰当地处理交叉相互作用 $U_{A\\text{--}B}$。设置 $U_{A\\text{--}B}=0$ 是最简单的选择，尽管添加一个软排斥势可以有益于防止两种拓扑之间的非物理重叠。\n\n这个综合策略为计算提供了一个稳定且热力学上一致的路径。\n\n### 逐项分析\n\n**A. 对两种拓扑，都保持 $U_{\\mathrm{bond}}^{A}$、$U_{\\mathrm{bond}}^{B}$、$U_{1\\text{--}4}^{A}$ 和 $U_{1\\text{--}4}^{B}$ 的完全强度且与 $\\lambda$ 无关；对于所有 $\\lambda$，设置 $U_{A\\text{--}B}(\\mathbf{r};\\lambda)=0$；仅使用软核非键势缩放炼金原子与环境之间的相互作用，使得 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)=(1-\\lambda)\\,U_{\\mathrm{env}}^{A,\\mathrm{sc}} + \\lambda\\,U_{\\mathrm{env}}^{B,\\mathrm{sc}}$。**\n\n此策略与从第一性原理推导出的策略相匹配。它通过保持炼金基团的所有内部相互作用（$U_{\\mathrm{bond}}$ 和 $U_{1\\text{--}4}$）恒定，正确地维持了它们的内部结构，这对模拟稳定性和避免虚拟基团的非物理构象至关重要。它正确地使用软核势来缩放环境相互作用以避免奇异点，满足了要求 $2$ 和 $3$。它遵循一个标准的、有效的热力学循环。\n**结论：正确。**\n\n**B. 将涉及任何炼金原子的所有相互作用（包括键、角、二面角和 $1$–$4$ 项）随 $\\lambda$ 线性缩放，并在关闭键合项时对其应用软核函数形式，以便解耦拓扑内的所有内部结构在相应的端点处坍缩。**\n\n此策略有两个严重缺陷。首先，“对键合项应用软核函数形式”的概念在物理上和技术上都是无意义的。软核势解决了非键势在 $r=0$ 处的 $1/r^n$ 发散问题；键合势（如谐振子）没有这种类型的奇异点。其次，将键合相互作用缩放到零会导致虚拟基团失去其结构完整性并“坍缩”或“爆炸”。这会产生一条病态的、高能量的过渡路径，极难采样，导致收敛性差和滞后现象。虽然它可能满足对“物理端点”要求的最严格解释，但这是以创建一条不可行的模拟路径为代价的。\n**结论：不正确。**\n\n**C. 保持键合项 $U_{\\mathrm{bond}}^{A}$ 和 $U_{\\mathrm{bond}}^{B}$ 恒定，但将涉及炼金原子的所有 $1$–$4$ 相互作用（包括 $A$ 内部和 $B$ 内部的分子内 $1$–$4$ 对）与 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)$ 一起使用软核势进行缩放。**\n\n此策略比 B 有所改进，但包含一个关键缺陷。虽然它正确地保持了共价键结构（$U_{\\mathrm{bond}}$）恒定，但它缩放了分子内 $1$–$4$ 相互作用。$1$–$4$ 相互作用（Lennard-Jones 和库仑力的组合）对于维持正确的局部构象至关重要，例如芳香环的平面性或烷基链中正确的交错构象。为虚拟基团关闭这些相互作用会使其采纳高度非物理的几何构型（例如，自相交），这会破坏模拟的稳定性并污染统计系综。因此，保持这些 $1$–$4$ 相互作用的策略 A 更优越。\n**结论：不正确。**\n\n**D. 保持所有分子内项恒定，但仅将 $U_{\\mathrm{env}}(\\mathbf{r};\\lambda)$ 的库仑部分随 $\\lambda$ 线性缩放且不使用软核，同时保持 Lennard-Jones 部分不缩放，以避免在小间距处过度正则化；允许 $U_{A\\text{--}B}(\\mathbf{r};\\lambda)$ 在中间 $\\lambda$ 值处非零以平滑过渡。**\n\n此策略基于多个理由从根本上是无效的。首先，线性缩放库仑势而*不*使用软核形式是导致“端点灾难”的典型方案——它保证了 $\\Delta F$ 的积分将发散。这违反了要求 $2$ 和 $3$。其次，保持 Lennard-Jones 部分不缩放意味着在所有 $\\lambda$ 值下，$A$ 和 $B$ 都与环境有范德华相互作用，这从根本上违反了其中一个基团应完全解耦的端点要求。此策略是一系列与炼金计算基本原则相矛盾的做法的集合。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3446976"}]}