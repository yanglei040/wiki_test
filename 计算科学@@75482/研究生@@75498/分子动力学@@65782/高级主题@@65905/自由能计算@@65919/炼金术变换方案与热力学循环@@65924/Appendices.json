{"hands_on_practices": [{"introduction": "在深入研究复杂分子系统的炼金术自由能计算之前，通过一个简单且可解析求解的模型来验证我们的核心方法是至关重要的。本练习将使用经典的一维谐振子，从第一性原理出发，通过两种独立的方法——直接评估配分函数和进行热力学积分——来推导亥姆霍兹自由能变。通过证明这两种方法得到相同的结果，我们可以为热力学积分这一强大工具的有效性和准确性建立坚实的理论信心 ([@problem_id:3394752])。", "problem": "考虑一个分子动力学（MD）中的炼金术变换方案，其中一个质量为 $m$ 的单个粒子被限制在一维谐振子势中，其力常数为 $k$。需要在绝对温度为 $T$ 的正则系综中，计算两个热力学态 $A$ 和 $B$ 之间的亥姆霍兹自由能变化，这两个状态的力常数分别为 $k_A$ 和 $k_B$。该变换通过引入一个耦合参数 $\\lambda \\in [0,1]$ 来实现，该参数对力常数进行线性插值，即 $k(\\lambda) = (1-\\lambda) k_A + \\lambda k_B$。您可以假设经典哈密顿量为 $H(x,p;k) = \\frac{p^{2}}{2m} + \\frac{1}{2} k x^{2}$，正则配分函数的定义为 $Z(k) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\!\\big(-\\beta H(x,p;k)\\big)\\, dx\\, dp$（其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$h$ 为任意固定的相空间晶胞尺寸常数），以及亥姆霍兹自由能的定义为 $F(k) = -k_{\\mathrm{B}} T \\ln Z(k)$（其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数）。请仅依赖这些基本定义以及诸如能量均分定理等经过充分检验的结果。\n\n任务：通过显式计算配分函数并取其对数比值，从第一性原理推导亥姆霍兹自由能变化 $\\Delta F = F(k_B) - F(k_A)$ 的解析表达式。然后，独立地通过沿炼金术路径 $k(\\lambda)$ 进行热力学积分来验证是否能得到相同的表达式，此过程中仅使用可以从正则分布中解析计算的系综平均值。\n\n将每个粒子的最终亥姆霍兹自由能变化以焦耳为单位，表示为关于 $k_A$、$k_B$、$k_{\\mathrm{B}}$ 和 $T$ 的单个封闭形式解析表达式。无需代入任何数值，也无需四舍五入。仅提供最终的解析表达式。", "solution": "首先根据提供的标准对问题进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 系统：一个质量为 $m$ 的单个粒子。\n- 势能：一维谐振子势 $V(x) = \\frac{1}{2} k x^{2}$。\n- 热力学态：力常数为 $k_A$ 的状态 $A$ 和力常数为 $k_B$ 的状态 $B$。\n- 系综：绝对温度为 $T$ 的正则系综。\n- 炼金术路径：耦合参数 $\\lambda \\in [0,1]$ 通过 $k(\\lambda) = (1-\\lambda) k_A + \\lambda k_B$ 对力常数进行线性插值。\n- 哈密顿量：$H(x,p;k) = \\frac{p^{2}}{2m} + \\frac{1}{2} k x^{2}$。\n- 配分函数：$Z(k) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(-\\beta H(x,p;k))\\, dx\\, dp$。\n- 逆温度：$\\beta = 1/(k_{\\mathrm{B}} T)$。\n- 相空间常数：$h$。\n- 亥姆霍兹自由能：$F(k) = -k_{\\mathrm{B}} T \\ln Z(k)$。\n- 常数：玻尔兹曼常数 $k_{\\mathrm{B}}$。\n- 任务：使用两种不同方法推导亥姆霍兹自由能变化 $\\Delta F = F(k_B) - F(k_A)$：(1) 直接计算配分函数和 (2) 热力学积分。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学基础**：该问题是经典统计力学中的一个标准基础练习。所涉及的系统（经典谐振子）、系综（正则系综）以及定义（哈密顿量、配分函数、亥姆霍兹自由能）都是该领域的基础。炼金术变换和热力学积分的概念是计算化学中用于计算自由能差异的一项成熟且关键的技术。该问题在科学上是合理的。\n- **适定性**：问题定义清晰。它要求对一个简单的、可解析求解的系统，使用两种指定的标准方法推导一个特定的物理量 $\\Delta F$。所有必要的定义和参数都已提供。存在唯一、稳定且有意义的解。\n- **客观性**：语言精确、专业，没有任何主观或模糊的陈述。\n\n**第三步：结论与行动**\n问题有效。这是一个统计力学中适定的、有科学依据的问题。现在开始求解过程。\n\n### 亥姆霍兹自由能变化 $\\Delta F$ 的推导\n\n任务是使用两种独立的方法推导 $\\Delta F = F(k_B) - F(k_A)$ 的表达式。\n\n**方法一：从配分函数直接计算**\n\n首先，我们计算给定力常数 $k$ 的正则配分函数 $Z(k)$。\n哈密顿量为 $H(x,p;k) = \\frac{p^2}{2m} + \\frac{1}{2} k x^2$。\n配分函数由下式给出：\n$$Z(k) = \\frac{1}{h} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left(\\frac{p^2}{2m} + \\frac{1}{2}k x^2\\right)\\right) \\,dx\\,dp$$\n该积分可以分离为动量部分和位置部分：\n$$Z(k) = \\frac{1}{h} \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) dp \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k x^2}{2}\\right) dx \\right)$$\n两个积分都是标准的高斯积分形式 $\\int_{-\\infty}^{\\infty} \\exp(-ay^2) dy = \\sqrt{\\pi/a}$。\n\n对于动量积分，系数为 $a_p = \\frac{\\beta}{2m}$。因此，\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) dp = \\sqrt{\\frac{\\pi}{\\beta/(2m)}} = \\sqrt{\\frac{2\\pi m}{\\beta}}$$\n\n对于位置积分，系数为 $a_x = \\frac{\\beta k}{2}$。因此，\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k x^2}{2}\\right) dx = \\sqrt{\\frac{\\pi}{\\beta k/2}} = \\sqrt{\\frac{2\\pi}{\\beta k}}$$\n\n结合这些结果，配分函数为：\n$$Z(k) = \\frac{1}{h} \\sqrt{\\frac{2\\pi m}{\\beta}} \\sqrt{\\frac{2\\pi}{\\beta k}} = \\frac{2\\pi}{h\\beta} \\sqrt{\\frac{m}{k}}$$\n\n亥姆霍兹自由能为 $F(k) = -k_{\\mathrm{B}}T \\ln Z(k)$。状态 $A$ 和 $B$ 之间的自由能变化 $\\Delta F$ 为：\n$$\\Delta F = F(k_B) - F(k_A) = \\left(-k_{\\mathrm{B}}T \\ln Z(k_B)\\right) - \\left(-k_{\\mathrm{B}}T \\ln Z(k_A)\\right)$$\n$$\\Delta F = -k_{\\mathrm{B}}T \\left( \\ln Z(k_B) - \\ln Z(k_A) \\right) = -k_{\\mathrm{B}}T \\ln\\left(\\frac{Z(k_B)}{Z(k_A)}\\right)$$\n我们计算配分函数的比值：\n$$\\frac{Z(k_B)}{Z(k_A)} = \\frac{\\frac{2\\pi}{h\\beta} \\sqrt{\\frac{m}{k_B}}}{\\frac{2\\pi}{h\\beta} \\sqrt{\\frac{m}{k_A}}} = \\frac{\\sqrt{m/k_B}}{\\sqrt{m/k_A}} = \\sqrt{\\frac{k_A}{k_B}} = \\left(\\frac{k_A}{k_B}\\right)^{1/2}$$\n将该比值代回 $\\Delta F$ 的表达式中：\n$$\\Delta F = -k_{\\mathrm{B}}T \\ln\\left(\\left(\\frac{k_A}{k_B}\\right)^{1/2}\\right) = -k_{\\mathrm{B}}T \\cdot \\frac{1}{2} \\ln\\left(\\frac{k_A}{k_B}\\right)$$\n利用对数性质 $\\ln(a/b) = -\\ln(b/a)$，我们得到最终表达式：\n$$\\Delta F = \\frac{1}{2} k_{\\mathrm{B}}T \\ln\\left(\\frac{k_B}{k_A}\\right)$$\n\n**方法二：热力学积分**\n\n第二种方法涉及对哈密顿量关于耦合参数 $\\lambda$ 的导数的系综平均值进行积分。基本公式为：\n$$\\Delta F = \\int_0^1 \\left\\langle \\frac{\\partial H}{\\partial \\lambda} \\right\\rangle_{\\lambda} d\\lambda$$\n哈密顿量通过力常数 $k(\\lambda) = (1-\\lambda)k_A + \\lambda k_B$ 依赖于 $\\lambda$。\n$$H(\\lambda) = H(x,p;k(\\lambda)) = \\frac{p^2}{2m} + \\frac{1}{2} k(\\lambda) x^2$$\n首先，我们求哈密顿量关于 $\\lambda$ 的导数：\n$$\\frac{\\partial H}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( \\frac{1}{2} k(\\lambda) x^2 \\right) = \\frac{1}{2} x^2 \\frac{dk}{d\\lambda}$$\n由于 $k(\\lambda) = k_A + \\lambda(k_B - k_A)$，其导数为 $\\frac{dk}{d\\lambda} = k_B - k_A$。\n因此：\n$$\\frac{\\partial H}{\\partial \\lambda} = \\frac{1}{2}(k_B - k_A)x^2$$\n接下来，我们计算这个量在力常数为 $k(\\lambda)$ 的系统中的正则系综平均值，记为 $\\langle \\dots \\rangle_{\\lambda}$：\n$$\\left\\langle \\frac{\\partial H}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\left\\langle \\frac{1}{2}(k_B - k_A)x^2 \\right\\rangle_{\\lambda} = \\frac{1}{2}(k_B - k_A) \\langle x^2 \\rangle_{\\lambda}$$\n项 $\\langle x^2 \\rangle_{\\lambda}$ 是粒子在力常数为 $k(\\lambda)$ 的谐振子势中的均方位移。我们可以使用允许的能量均分定理来求得此值。该定理指出，哈密顿量中的每个二次项对平均总能量的贡献为 $\\frac{1}{2} k_{\\mathrm{B}} T$。势能为 $V(x) = \\frac{1}{2}k(\\lambda)x^2$，这是一个单一的二次自由度。\n$$\\langle V \\rangle = \\left\\langle \\frac{1}{2}k(\\lambda)x^2 \\right\\rangle_{\\lambda} = \\frac{1}{2} k_{\\mathrm{B}} T$$\n由此，我们解出 $\\langle x^2 \\rangle_{\\lambda}$：\n$$\\frac{1}{2}k(\\lambda) \\langle x^2 \\rangle_{\\lambda} = \\frac{1}{2} k_{\\mathrm{B}} T \\implies \\langle x^2 \\rangle_{\\lambda} = \\frac{k_{\\mathrm{B}} T}{k(\\lambda)}$$\n将此结果代回系综平均值的表达式中：\n$$\\left\\langle \\frac{\\partial H}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\frac{1}{2}(k_B - k_A) \\frac{k_{\\mathrm{B}} T}{k(\\lambda)} = \\frac{k_{\\mathrm{B}} T (k_B - k_A)}{2 k(\\lambda)}$$\n现在，我们对 $\\lambda$ 从 $0$ 到 $1$ 进行积分：\n$$\\Delta F = \\int_0^1 \\frac{k_{\\mathrm{B}} T (k_B - k_A)}{2 k(\\lambda)} d\\lambda$$\n代入 $k(\\lambda)$ 的表达式：\n$$\\Delta F = \\frac{k_{\\mathrm{B}} T (k_B - k_A)}{2} \\int_0^1 \\frac{1}{(1-\\lambda)k_A + \\lambda k_B} d\\lambda$$\n令 $u(\\lambda) = (1-\\lambda)k_A + \\lambda k_B = k_A + \\lambda(k_B - k_A)$。则 $du = (k_B - k_A)d\\lambda$。积分变为：\n$$\\int \\frac{1}{u} \\frac{du}{k_B-k_A} = \\frac{1}{k_B-k_A} \\ln(u)$$\n假设 $k_A \\neq k_B$，积分为：\n$$\\int_0^1 \\frac{1}{k_A + \\lambda(k_B - k_A)} d\\lambda = \\left[ \\frac{\\ln(k_A + \\lambda(k_B - k_A))}{k_B - k_A} \\right]_0^1$$\n$$= \\frac{\\ln(k_A + (k_B - k_A)) - \\ln(k_A)}{k_B - k_A} = \\frac{\\ln(k_B) - \\ln(k_A)}{k_B - k_A}$$\n将此结果代回 $\\Delta F$ 的表达式中：\n$$\\Delta F = \\frac{k_{\\mathrm{B}} T (k_B - k_A)}{2} \\left(\\frac{\\ln(k_B) - \\ln(k_A)}{k_B - k_A}\\right)$$\n项 $(k_B - k_A)$ 被消去：\n$$\\Delta F = \\frac{k_{\\mathrm{B}} T}{2} (\\ln(k_B) - \\ln(k_A)) = \\frac{1}{2} k_{\\mathrm{B}} T \\ln\\left(\\frac{k_B}{k_A}\\right)$$\n两种方法得出了相同的结果，这证实了推导的正确性。亥姆霍兹自由能变化的最终表达式是从第一性原理推导出来的。", "answer": "$$\n\\boxed{\\frac{1}{2} k_{\\mathrm{B}} T \\ln\\left(\\frac{k_B}{k_A}\\right)}\n$$", "id": "3394752"}, {"introduction": "从解析理论转向计算实践，我们必须面对一个现实：分子动力学模拟只能在离散的耦合参数 $\\lambda$ 点上提供系综平均值 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$。因此，为了获得总自由能差 $\\Delta F$，我们必须对这些离散数据点进行数值积分。本练习专注于热力学积分计算中的这一关键步骤，您将使用高斯-勒让德求积法来近似积分，并学习如何通过比较不同阶数的求积规则来估计离散化误差，这是评估计算结果可靠性的重要技能 ([@problem_id:3394784])。", "problem": "在经典分子动力学 (MD) 炼金术自由能计算中，两个由耦合参数 $\\lambda \\in [0,1]$ 连接的状态之间的 Helmholtz 自由能差，可以通过热力学积分，由以下基本恒等式计算得出\n$$\n\\Delta F \\;=\\; \\int_{0}^{1} \\left\\langle \\frac{\\partial U(\\mathbf{r};\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda,\n$$\n其中 $U(\\mathbf{r};\\lambda)$ 是在耦合参数为 $\\lambda$ 时构型 $\\mathbf{r}$ 的势能，而 $\\langle \\cdot \\rangle_{\\lambda}$ 表示在固定 $\\lambda$ 下的正则系综平均。给定在单个炼金术路径中，在选定的 $\\lambda$ 值处测量的一组系综平均值 $\\left\\langle \\partial U/\\partial \\lambda \\right\\rangle_{\\lambda}$。请使用 $[0,1]$ 上的 Gauss–Legendre 求积法来近似该积分，并通过比较两种不同阶数的求积结果来估计离散化误差。\n\n使用 $[0,1]$ 上的三点 Gauss–Legendre 法则，其节点和权重为：\n- 节点：$\\lambda^{(3)}_{0} = \\tfrac{1}{2}$，$\\lambda^{(3)}_{\\pm} = \\tfrac{1}{2}\\left(1 \\pm \\sqrt{\\tfrac{3}{5}}\\right) \\approx 0.11270166538,\\; 0.88729833462$。\n- 权重：$W^{(3)}_{0} = \\tfrac{4}{9}$，$W^{(3)}_{\\pm} = \\tfrac{5}{18}$。\n\n为了进行误差估计，还需计算 $[0,1]$ 上的两点 Gauss–Legendre 法则：\n- 节点：$\\lambda^{(2)}_{\\pm} = \\tfrac{1}{2}\\left(1 \\pm \\tfrac{1}{\\sqrt{3}}\\right) \\approx 0.21132486541,\\; 0.78867513459$。\n- 权重：$W^{(2)}_{\\pm} = \\tfrac{1}{2}$。\n\n测得的系综平均值 $\\left\\langle \\partial U/\\partial \\lambda \\right\\rangle_{\\lambda}$ (单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$) 如下：\n- 当 $\\lambda = 0.11270166538$ 时：$14.88$。\n- 当 $\\lambda = 0.50000000000$ 时：$17.00$。\n- 当 $\\lambda = 0.88729833462$ 时：$18.40$。\n- 当 $\\lambda = 0.21132486541$ 时：$15.55$。\n- 当 $\\lambda = 0.78867513459$ 时：$17.85$。\n\n任务：\n1. 使用 $[0,1]$ 上的三点节点和权重，计算 $\\Delta F$ 的三点 Gauss–Legendre 估计值 $\\Delta F_{(3)}$。\n2. 使用 $[0,1]$ 上的两点节点和权重，计算两点 Gauss–Legendre 估计值 $\\Delta F_{(2)}$。\n3. 将离散化误差估计为 $\\varepsilon_{\\mathrm{disc}} = \\left|\\Delta F_{(3)} - \\Delta F_{(2)}\\right|$。\n\n将 $\\Delta F_{(3)}$ 和 $\\varepsilon_{\\mathrm{disc}}$ 均以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示，并将两者都四舍五入至四位有效数字。将您的最终答案以单个行向量 $\\big[\\Delta F_{(3)},\\, \\varepsilon_{\\mathrm{disc}}\\big]$ 的形式报告。", "solution": "该问题要求使用热力学积分方法数值计算 Helmholtz 自由能差 $\\Delta F$。基本恒等式如下：\n$$\n\\Delta F = \\int_{0}^{1} \\left\\langle \\frac{\\partial U(\\mathbf{r};\\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda\n$$\n我们将被积函数，即势能对耦合参数 $\\lambda$ 的梯度的正则系综平均值，记为 $f(\\lambda) = \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda}$。该积分将在区间 $\\lambda \\in [0,1]$ 上使用 Gauss–Legendre 求积进行近似。\n\n一个通用的 $N$ 点 Gauss–Legendre 求积法则将函数 $f(\\lambda)$ 在区间 $[0,1]$ 上的定积分近似为一个加权和：\n$$\n\\int_{0}^{1} f(\\lambda) \\, d\\lambda \\approx \\sum_{i=1}^{N} W^{(N)}_{i} f(\\lambda^{(N)}_{i})\n$$\n其中 $\\lambda^{(N)}_{i}$ 是求积节点，而 $W^{(N)}_{i}$ 是 $[0,1]$ 上 $N$ 点法则对应的权重。\n\n首先，我们计算三点 Gauss–Legendre 估计值 $\\Delta F_{(3)}$。题目提供了节点、权重以及函数 $f(\\lambda)$ 在这些节点上的值。\n三点节点为 $\\lambda^{(3)}_{0} = \\frac{1}{2}$ 和 $\\lambda^{(3)}_{\\pm} = \\frac{1}{2}\\left(1 \\pm \\sqrt{\\frac{3}{5}}\\right)$。\n相应的权重为 $W^{(3)}_{0} = \\frac{4}{9}$ 和 $W^{(3)}_{\\pm} = \\frac{5}{18}$。\n给定的函数值（单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$）如下：\n$f(\\frac{1}{2}(1 - \\sqrt{\\frac{3}{5}})) \\approx f(0.11270166538) = 14.88$\n$f(\\frac{1}{2}) = f(0.50000000000) = 17.00$\n$f(\\frac{1}{2}(1 + \\sqrt{\\frac{3}{5}})) \\approx f(0.88729833462) = 18.40$\n\n因此，三点估计值是权重与函数值的乘积之和：\n$$\n\\Delta F_{(3)} = \\sum_{i=1}^{3} W^{(3)}_{i} f(\\lambda^{(3)}_{i}) = W^{(3)}_{-}f(\\lambda^{(3)}_{-}) + W^{(3)}_{0}f(\\lambda^{(3)}_{0}) + W^{(3)}_{+}f(\\lambda^{(3)}_{+})\n$$\n代入所给数值：\n$$\n\\Delta F_{(3)} = \\left(\\frac{5}{18}\\right)(14.88) + \\left(\\frac{4}{9}\\right)(17.00) + \\left(\\frac{5}{18}\\right)(18.40)\n$$\n为了进行精确计算，我们使用公分母 $18$：\n$$\n\\Delta F_{(3)} = \\frac{5 \\times 14.88 + 8 \\times 17.00 + 5 \\times 18.40}{18}\n$$\n$$\n\\Delta F_{(3)} = \\frac{74.4 + 136.0 + 92.0}{18} = \\frac{302.4}{18} = 16.8\n$$\n其值为 $\\Delta F_{(3)} = 16.8 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n接下来，我们计算两点 Gauss–Legendre 估计值 $\\Delta F_{(2)}$，它将用于误差估计。\n两点节点为 $\\lambda^{(2)}_{\\pm} = \\frac{1}{2}\\left(1 \\pm \\frac{1}{\\sqrt{3}}\\right)$。\n权重为 $W^{(2)}_{\\pm} = \\frac{1}{2}$。\n给定的函数值（单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$）如下：\n$f(\\frac{1}{2}(1 - \\frac{1}{\\sqrt{3}})) \\approx f(0.21132486541) = 15.55$\n$f(\\frac{1}{2}(1 + \\frac{1}{\\sqrt{3}})) \\approx f(0.78867513459) = 17.85$\n\n两点估计值为：\n$$\n\\Delta F_{(2)} = \\sum_{i=1}^{2} W^{(2)}_{i} f(\\lambda^{(2)}_{i}) = W^{(2)}_{-}f(\\lambda^{(2)}_{-}) + W^{(2)}_{+}f(\\lambda^{(2)}_{+})\n$$\n代入所给数值：\n$$\n\\Delta F_{(2)} = \\left(\\frac{1}{2}\\right)(15.55) + \\left(\\frac{1}{2}\\right)(17.85) = \\frac{15.55 + 17.85}{2}\n$$\n$$\n\\Delta F_{(2)} = \\frac{33.40}{2} = 16.7\n$$\n其值为 $\\Delta F_{(2)} = 16.7 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n最后，我们将离散化误差 $\\varepsilon_{\\mathrm{disc}}$ 估计为三点估计值和两点估计值之间的绝对差。此过程假设更高阶的法则能产生更准确的结果。\n$$\n\\varepsilon_{\\mathrm{disc}} = |\\Delta F_{(3)} - \\Delta F_{(2)}|\n$$\n$$\n\\varepsilon_{\\mathrm{disc}} = |16.8 - 16.7| = 0.1\n$$\n误差估计值为 $\\varepsilon_{\\mathrm{disc}} = 0.1 \\, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n问题要求将 $\\Delta F_{(3)}$ 和 $\\varepsilon_{\\mathrm{disc}}$ 均四舍五入到四位有效数字。\n$\\Delta F_{(3)}$ 的计算值为 $16.8$。为用四位有效数字表示，我们写作 $16.80$。\n$\\varepsilon_{\\mathrm{disc}}$ 的计算值为 $0.1$。为用四位有效数字表示，我们写作 $0.1000$。\n\n最终答案是包含这两个值的行向量：$[\\Delta F_{(3)}, \\varepsilon_{\\mathrm{disc}}]$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 16.80 & 0.1000 \\end{pmatrix}}\n$$", "id": "3394784"}, {"introduction": "自由能计算的最终目标通常是预测如相对结合亲和力这样的宏观热力学性质，这需要将单个炼金术变换组合成一个完整的闭合热力学循环。本练习将理论付诸于药物设计等领域的实际应用，要求您根据一个典型的相对结合自由能计算的热力学循环，来计算 $\\Delta \\Delta G_{\\text{bind}}$。本练习强调了对模拟结果进行严谨统计分析的重要性，特别是如何正确地传递各个计算分支（legs）的统计不确定性，并考虑它们之间存在的相关性，从而得到一个既准确又可靠的最终结果 ([@problem_id:3394803])。", "problem": "两个配体，记为$A$和$B$，通过标准炼金术变换方案，在分子动力学（MD）模拟中使用Bennett接受率（BAR）方法估算了它们的相对结合自由能。炼金术变换的两个分支是：在结合的蛋白质-配体复合物中$A \\to B$的变换，以及在体相溶剂中$A \\to B$的变换。根据相对结合的热力学循环，所求的量是$B$和$A$之间的相对结合自由能差$\\Delta \\Delta G_{\\text{bind}}$。BAR估计量返回无偏的自由能差及其相关的单标准差不确定度。假设两个分支的BAR估计值在统计上是相关的，因为使用了相同的微扰方案和共同的随机种子。\n\n给定以下BAR输出：\n- 复合物分支：$\\Delta G_{A \\to B}^{\\text{complex}} = -14.22 \\ \\text{kJ mol}^{-1}$，不确定度为 $0.35 \\ \\text{kJ mol}^{-1}$。\n- 溶剂分支：$\\Delta G_{A \\to B}^{\\text{solvent}} = -9.87 \\ \\text{kJ mol}^{-1}$，不确定度为 $0.41 \\ \\text{kJ mol}^{-1}$。\n\n两个分支估计值之间的经验皮尔逊相关系数为 $r = 0.55$。将不确定度视为单标准差值（高斯近似），并忽略估计量的偏差。从热力学循环以及相关随机变量线性组合的协方差和方差的定义出发，推导$\\Delta \\Delta G_{\\text{bind}}$及其传播的标准不确定度的表达式，该表达式需考虑分支间的协方差。使用提供的数据计算数值。\n\n将您的最终数值结果表示为两个数：首先是$\\Delta \\Delta G_{\\text{bind}}$的值，其次是其传播的单标准差不确定度，单位均为千焦/摩尔。将您的答案四舍五入到三位有效数字。", "solution": "该问题是有效的，因为它科学地基于统计热力学和误差传播原理，问题设定良好并提供了所有必要数据，且表述客观。\n\n该问题要求计算相对结合自由能 $\\Delta \\Delta G_{\\text{bind}}$ 及其相关的不确定度。这需要利用热力学循环和相关变量的误差传播原理。\n\n首先，我们建立一个热力学循环，将配体$A$和$B$的结合自由能与炼金术变换自由能联系起来。该循环涉及四个过程：\n1.  配体$A$与蛋白质结合：$P + A \\rightarrow P \\cdot A$，自由能变为 $\\Delta G_{\\text{bind},A}$。\n2.  配体$A$在与蛋白质结合的状态下炼金术变换为配体$B$：$P \\cdot A \\rightarrow P \\cdot B$，自由能变为 $\\Delta G_{A \\to B}^{\\text{complex}}$。\n3.  配体$B$从蛋白质解离（结合的逆过程）：$P \\cdot B \\rightarrow P + B$，自由能变为 $-\\Delta G_{\\text{bind},B}$。\n4.  配体$B$在溶剂中炼金术变换为配体$A$（给定溶剂分支的逆过程）：$B \\rightarrow A$，自由能变为 $-\\Delta G_{A \\to B}^{\\text{solvent}}$。\n\n由于吉布斯自由能$G$是一个状态函数，这个闭合循环的总自由能变化必须为零：\n$$\n\\Delta G_{\\text{cycle}} = \\Delta G_{\\text{bind},A} + \\Delta G_{A \\to B}^{\\text{complex}} - \\Delta G_{\\text{bind},B} - \\Delta G_{A \\to B}^{\\text{solvent}} = 0\n$$\n配体$B$相对于配体$A$的相对结合自由能定义为 $\\Delta \\Delta G_{\\text{bind}} = \\Delta G_{\\text{bind},B} - \\Delta G_{\\text{bind},A}$。重排热力学循环方程以求解该量，我们得到：\n$$\n\\Delta \\Delta G_{\\text{bind}} = \\Delta G_{A \\to B}^{\\text{complex}} - \\Delta G_{A \\to B}^{\\text{solvent}}\n$$\n这是相对结合自由能的基本表达式。\n\n让我们将两个BAR估计的自由能变化表示为随机变量：\n$X = \\Delta G_{A \\to B}^{\\text{complex}}$\n$Y = \\Delta G_{A \\to B}^{\\text{solvent}}$\n\n给定的值为：\n- $X$的平均值：$\\mu_X = -14.22 \\ \\text{kJ mol}^{-1}$\n- $X$的标准差：$\\sigma_X = 0.35 \\ \\text{kJ mol}^{-1}$\n- $Y$的平均值：$\\mu_Y = -9.87 \\ \\text{kJ mol}^{-1}$\n- $Y$的标准差：$\\sigma_Y = 0.41 \\ \\text{kJ mol}^{-1}$\n- $X$和$Y$之间的皮尔逊相关系数：$r = 0.55$\n\n相对结合自由能的值是平均值之差：\n$$\n\\Delta \\Delta G_{\\text{bind}} = \\mu_X - \\mu_Y = -14.22 - (-9.87) = -14.22 + 9.87 = -4.35 \\ \\text{kJ mol}^{-1}\n$$\n\n接下来，我们推导传播不确定度的表达式。不确定度是$\\Delta \\Delta G_{\\text{bind}}$的标准差，我们将其表示为$\\sigma_{\\Delta \\Delta G}$。两个相关随机变量$X$和$Y$之差的方差由下式给出：\n$$\n\\text{Var}(X - Y) = \\text{Var}(X) + \\text{Var}(Y) - 2 \\text{Cov}(X, Y)\n$$\n方差是标准差的平方，因此$\\text{Var}(X) = \\sigma_X^2$且$\\text{Var}(Y) = \\sigma_Y^2$。协方差$\\text{Cov}(X, Y)$与皮尔逊相关系数$r$和标准差的关系如下：\n$$\n\\text{Cov}(X, Y) = r \\cdot \\sigma_X \\cdot \\sigma_Y\n$$\n将这些代入方差公式，我们得到：\n$$\n\\sigma_{\\Delta \\Delta G}^2 = \\text{Var}(X - Y) = \\sigma_X^2 + \\sigma_Y^2 - 2 r \\sigma_X \\sigma_Y\n$$\n传播的标准不确定度是该方差的平方根：\n$$\n\\sigma_{\\Delta \\Delta G} = \\sqrt{\\sigma_X^2 + \\sigma_Y^2 - 2 r \\sigma_X \\sigma_Y}\n$$\n现在，我们将给定的数值代入此表达式：\n$$\n\\sigma_{\\Delta \\Delta G} = \\sqrt{(0.35)^2 + (0.41)^2 - 2(0.55)(0.35)(0.41)}\n$$\n计算平方根内的各项：\n- $\\sigma_X^2 = (0.35)^2 = 0.1225$\n- $\\sigma_Y^2 = (0.41)^2 = 0.1681$\n- $2 r \\sigma_X \\sigma_Y = 2 \\times 0.55 \\times 0.35 \\times 0.41 = 1.1 \\times 0.1435 = 0.15785$\n\n将这些值代回方差方程：\n$$\n\\sigma_{\\Delta \\Delta G}^2 = 0.1225 + 0.1681 - 0.15785 = 0.2906 - 0.15785 = 0.13275\n$$\n不确定度是平方根：\n$$\n\\sigma_{\\Delta \\Delta G} = \\sqrt{0.13275} \\approx 0.3643487... \\ \\text{kJ mol}^{-1}\n$$\n问题要求将结果四舍五入到三位有效数字。\n计算出的相对结合自由能值为 $\\Delta \\Delta G_{\\text{bind}} = -4.35 \\ \\text{kJ mol}^{-1}$，这已经是三位有效数字。\n计算出的不确定度，四舍五入到三位有效数字后，为 $\\sigma_{\\Delta \\Delta G} = 0.364 \\ \\text{kJ mol}^{-1}$。\n\n最终的数值结果是 $\\Delta \\Delta G_{\\text{bind}} = -4.35 \\ \\text{kJ mol}^{-1}$ 和 $\\sigma_{\\Delta \\Delta G} = 0.364 \\ \\text{kJ mol}^{-1}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-4.35 & 0.364\n\\end{pmatrix}\n}\n$$", "id": "3394803"}]}