{"hands_on_practices": [{"introduction": "在分子模拟中，维持正确的立体化学构型至关重要。异常扭转势（improper torsion potential）是确保手性中心和平面基团几何形状的关键工具。本练习将通过一个基础计算，帮助您理解异常扭转势如何通过能量惩罚来防止手性中心的构型翻转。通过这个练习 [@problem_id:3457050]，您将能够量化构型翻转的能量代价，并深入理解在有限温度的分子动力学模拟中，手性中心为何能够保持其结构稳定性。", "problem": "考虑一个具有单一手性中心的分子，该手性中心由四个原子定义，其排列方式使得面外假二面角（由类二面角坐标 $\\phi$ 表示）是从构成参考平面的三个原子测量到第四个原子的角度。在分子动力学（MD）中，与广义坐标对其优选值的微小偏离相关的势能，通常通过围绕最小值点的泰勒展开的二次项来建模。假设在平衡点附近，该假二面角自由度由一个谐振恢复势控制，该势的特征是劲度系数 $\\kappa$ 和优选角 $\\phi_{0}$，其中在 $\\phi = \\phi_{0}$ 处达到最小值，曲率由 $\\kappa$ 设定。\n\n某个特定构型的 $\\phi = +0.25$ 弧度，参数为 $\\kappa = 50.0$ kJ mol$^{-1}$ rad$^{-2}$ 和 $\\phi_{0} = 0.35$ 弧度。在手性中心进行了一次反转操作，通过将第四个原子相对于参考平面进行反射，从而翻转了 $\\phi$ 的符号，而所有其他坐标保持不变，导致 $\\phi \\to -\\phi$。\n\n仅使用最小值点附近的势能谐振近似，计算仅由此假二面角坐标引起的能量变化 $\\Delta E$，定义为反转构型的能量减去原始构型的能量，并以千焦每摩尔为单位表示最终值。最终数值结果需四舍五入至四位有效数字。角度必须以弧度处理。\n\n此外，定性地解释在此情况下该反转在能量上是有利的还是不利的，并评论其对有限温度下平衡态MD采样过程中手性中心稳定性的影响。", "solution": "分子的势能可以描述为其坐标的标量函数 $U$。在一个稳定平衡点附近，标准方法是使用 $U$ 相对于某个广义坐标在最小值点附近的泰勒展开。对于一个单一坐标 $\\phi$，其最小值出现在 $\\phi = \\phi_{0}$ 处，局部曲率为 $\\kappa$，展开式中的最低非平凡阶给出了谐振近似\n$$\nU(\\phi) \\approx U(\\phi_{0}) + \\frac{1}{2}\\,\\kappa\\,(\\phi - \\phi_{0})^{2},\n$$\n其中 $U(\\phi_{0})$ 是在 $\\phi_{0}$ 处的最小能量。此形式源于泰勒展开的二阶项，其中 $\\kappa$ 等于二阶导数 $\\left.\\frac{d^{2}U}{d\\phi^{2}}\\right|_{\\phi_{0}}$。\n\n我们需要计算因假二面角反转（$\\phi \\to -\\phi$）而引起的能量变化 $\\Delta E$。定义\n$$\n\\Delta E \\equiv U(-\\phi) - U(\\phi),\n$$\n并使用谐振近似，我们得到\n$$\n\\Delta E = \\frac{1}{2}\\,\\kappa\\,\\big[(-\\phi - \\phi_{0})^{2} - (\\phi - \\phi_{0})^{2}\\big].\n$$\n我们对这个差值进行代数化简。注意\n$$\n(-\\phi - \\phi_{0})^{2} = (\\phi + \\phi_{0})^{2},\n$$\n所以\n$$\n\\Delta E = \\frac{1}{2}\\,\\kappa\\,\\big[(\\phi + \\phi_{0})^{2} - (\\phi - \\phi_{0})^{2}\\big].\n$$\n使用恒等式 $(a+b)^{2} - (a-b)^{2} = 4ab$，令 $a = \\phi$ 和 $b = \\phi_{0}$，我们得到\n$$\n\\Delta E = \\frac{1}{2}\\,\\kappa\\,(4\\phi\\,\\phi_{0}) = 2\\,\\kappa\\,\\phi\\,\\phi_{0}.\n$$\n这个表达式表明，反转时的能量变化对 $\\phi$ 和 $\\phi_{0}$ 都是线性的，并且当 $\\phi_{0} \\neq 0$ 时不为零。当 $\\phi$ 和 $\\phi_{0}$ 同号时，$\\Delta E > 0$，反转会增加能量；当它们异号时，$\\Delta E  0$，反转会降低能量。\n\n代入给定的数值 $\\kappa = 50.0$ kJ mol$^{-1}$ rad$^{-2}$，$\\phi = 0.25$ 弧度，以及 $\\phi_{0} = 0.35$ 弧度，我们计算\n$$\n\\Delta E = 2 \\times 50.0 \\times 0.25 \\times 0.35 \\ \\text{kJ mol}^{-1}.\n$$\n首先，$2 \\times 50.0 = 100.0$，且 $0.25 \\times 0.35 = 0.0875$。因此，\n$$\n\\Delta E = 100.0 \\times 0.0875 \\ \\text{kJ mol}^{-1} = 8.75 \\ \\text{kJ mol}^{-1}.\n$$\n四舍五入到四位有效数字，结果是 $8.750$ kJ mol$^{-1}$。\n\n关于定性影响，注意到在原始构型中 $\\phi$ 和 $\\phi_{0}$ 均为正值，所以 $\\Delta E > 0$，因此在假二面角作用下，该反转在能量上是不利的。这种不对称性是因为优选的面外几何构型因非零的 $\\phi_{0}$ 而偏离零点，这反映了手性约束。在有限温度下的平衡态分子动力学（MD）中，与原始态相比，向反转态的跃迁被一个与 $\\exp(-\\Delta E/(k_{B}T))$ 成正比的 Boltzmann 因子所抑制，其中 $k_{B}$ 是 Boltzmann 常数，$T$ 是绝对温度。因此，一个正的 $\\Delta E$ 会稳定手性中心，抵抗反转，从而降低采样到反转构型的概率，并增加在谐振区间内消旋化的有效势垒。因此，在热涨落不足以克服与反转相关的能量惩罚的时间尺度上，该手性构型保持动力学稳定。", "answer": "$$\\boxed{8.750}$$", "id": "3457050"}, {"introduction": "从维持静态几何结构的异常扭转，我们转向探索决定分子构象灵活性的正常扭转（proper torsion）。这个练习 [@problem_id:3457058] 搭建了一座从微观势能函数到宏观系综平均可观测量之间的桥梁。您将从统计力学的第一性原理出发，推导在给定扭转势下某个构象自由度的热力学平均值，这对于解释模拟结果以及将其与实验数据（例如核磁共振耦合常数）进行比较至关重要。", "problem": "考虑分子中的一个孤立的真二面角 $\\phi$，在分子动力学 (MD) 中通过单项余弦扭转势进行建模。设扭转能为 $V(\\phi) = V_{0} - C \\cos(n \\phi - \\delta)$，其中 $C>0$ 是扭转振幅，$n \\in \\mathbb{N}$ 是周期性（每 $2\\pi$ 的极小值数量），$\\delta \\in [0,2\\pi)$ 是相位偏移。角度 $\\phi$ 以弧度为单位。在温度为 $T$ 的正则系综中，角概率密度由 $P(\\phi) \\propto \\exp(-\\beta V(\\phi))$ 给出，其中 $\\beta = 1/(k_{B} T)$，$k_{B}$ 是玻尔兹曼常数。\n\n从此单项余弦势出发，从正则系综期望值的定义和上述概率密度开始，以解析闭合形式计算正则平均值 $\\langle \\cos(n \\phi) \\rangle$。你的推导必须从统计力学的第一性原理开始，如有必要可以使用公认的特殊函数，但不得假定目标公式。简要地用文字讨论 $\\langle \\cos(n \\phi) \\rangle$ 对温度 $T$ 的定性依赖关系（高温和低温极限）。将 $\\langle \\cos(n \\phi) \\rangle$ 的最终答案表示为单一的闭合形式解析表达式。无需进行数值计算。", "solution": "对于一个由连续变量 $\\phi$ 描述且处于热平衡状态的系统，其可观测量 $A(\\phi)$ 的正则平均（或期望值）由统计力学的基本原理给出：\n$$\n\\langle A(\\phi) \\rangle = \\frac{\\int A(\\phi) \\exp(-\\beta V(\\phi)) d\\phi}{\\int \\exp(-\\beta V(\\phi)) d\\phi}\n$$\n其中积分是在系统的所有可能状态上进行的。对于二面角 $\\phi$，积分范围是 $[0, 2\\pi)$。概率密度为 $P(\\phi) = N \\exp(-\\beta V(\\phi))$，其中 $N$ 是归一化常数，它是分母积分（配分函数 $Z$）的倒数。\n\n我们需要计算 $\\langle \\cos(n \\phi) \\rangle$。势能由 $V(\\phi) = V_{0} - C \\cos(n \\phi - \\delta)$ 给出。\n将 $A(\\phi) = \\cos(n \\phi)$ 和势能 $V(\\phi)$ 代入期望值公式可得：\n$$\n\\langle \\cos(n \\phi) \\rangle = \\frac{\\int_0^{2\\pi} \\cos(n \\phi) \\exp(-\\beta [V_{0} - C \\cos(n \\phi - \\delta)]) d\\phi}{\\int_0^{2\\pi} \\exp(-\\beta [V_{0} - C \\cos(n \\phi - \\delta)]) d\\phi}\n$$\n项 $\\exp(-\\beta V_0)$ 是一个常数，可以从分子和分母中提取出来，因此它会消去。\n$$\n\\langle \\cos(n \\phi) \\rangle = \\frac{\\int_0^{2\\pi} \\cos(n \\phi) \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi}{\\int_0^{2\\pi} \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi}\n$$\n为简化积分，我们进行变量替换。令 $u = n\\phi - \\delta$。这意味着 $\\phi = (u + \\delta)/n$ 且 $d\\phi = du/n$。$\\phi$ 从 $0$ 到 $2\\pi$ 的积分限对应于 $u$ 从 $-\\delta$ 到 $2\\pi n - \\delta$ 的积分限。该积分区间的长度为 $2\\pi n$。\n被积函数是关于 $u$ 的函数，周期为 $2\\pi$。对于任何周期为 $2\\pi$ 的函数 $f(u)$，其在长度为 $2\\pi n$ 的区间上的积分是在长度为 $2\\pi$ 的区间上的积分的 $n$ 倍：\n$$\n\\int_{-\\delta}^{2\\pi n - \\delta} f(u) du = n \\int_0^{2\\pi} f(u) du\n$$\n我们首先计算分母，即配分函数 $Z$（相差一个因子 $\\exp(-\\beta V_0)$）。\n$$\nZ = \\int_0^{2\\pi} \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi = \\int_{-\\delta}^{2\\pi n - \\delta} \\exp(\\beta C \\cos(u)) \\frac{du}{n}\n$$\n利用周期性论证：\n$$\nZ = \\frac{1}{n} \\left( n \\int_0^{2\\pi} \\exp(\\beta C \\cos(u)) du \\right) = \\int_0^{2\\pi} \\exp(\\beta C \\cos(u)) du\n$$\n这个积分与零阶第一类修正贝塞尔函数 $I_0(x)$ 有关，其积分表示为：\n$$\nI_0(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\exp(x \\cos\\theta) d\\theta\n$$\n因此，当 $x = \\beta C$ 时，我们有 $Z = 2\\pi I_0(\\beta C)$。\n\n现在，我们计算分子积分，记为 $I_{num}$：\n$$\nI_{num} = \\int_0^{2\\pi} \\cos(n \\phi) \\exp(\\beta C \\cos(n \\phi - \\delta)) d\\phi\n$$\n应用同样的变量替换 $u = n\\phi - \\delta$，我们还需要用 $u$ 来表示 $\\cos(n\\phi)$。由 $n\\phi=u+\\delta$ 可得 $\\cos(n\\phi)=\\cos(u+\\delta) = \\cos(u)\\cos(\\delta) - \\sin(u)\\sin(\\delta)$。\n$$\nI_{num} = \\int_{-\\delta}^{2\\pi n - \\delta} [\\cos(u)\\cos(\\delta) - \\sin(u)\\sin(\\delta)] \\exp(\\beta C \\cos(u)) \\frac{du}{n}\n$$\n再次利用周期性论证：\n$$\nI_{num} = \\int_{0}^{2\\pi} [\\cos(u)\\cos(\\delta) - \\sin(u)\\sin(\\delta)] \\exp(\\beta C \\cos(u)) du\n$$\n我们可以将其分成两个积分：\n$$\nI_{num} = \\cos(\\delta) \\int_{0}^{2\\pi} \\cos(u) \\exp(\\beta C \\cos(u)) du - \\sin(\\delta) \\int_{0}^{2\\pi} \\sin(u) \\exp(\\beta C \\cos(u)) du\n$$\n第二个积分为零。被积函数 $f(u) = \\sin(u) \\exp(\\beta C \\cos(u))$ 在区间 $[0, 2\\pi]$ 上是关于 $u=\\pi$ 的奇函数（即 $f(2\\pi - u) = -f(u)$），因此它在这个对称区间上的积分为零。\n第一个积分与一阶第一类修正贝塞尔函数 $I_1(x)$ 有关，其积分表示为：\n$$\nI_1(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\cos(\\theta) \\exp(x \\cos\\theta) d\\theta\n$$\n因此，当 $x = \\beta C$ 时，该积分为 $\\int_{0}^{2\\pi} \\cos(u) \\exp(\\beta C \\cos(u)) du = 2\\pi I_1(\\beta C)$。\n这样我们就得到：\n$$\nI_{num} = \\cos(\\delta) [2\\pi I_1(\\beta C)] - \\sin(\\delta) [0] = 2\\pi \\cos(\\delta) I_1(\\beta C)\n$$\n最后，我们通过计算分子与分母的比值来计算期望值：\n$$\n\\langle \\cos(n \\phi) \\rangle = \\frac{I_{num}}{Z} = \\frac{2\\pi \\cos(\\delta) I_1(\\beta C)}{2\\pi I_0(\\beta C)} = \\cos(\\delta) \\frac{I_1(\\beta C)}{I_0(\\beta C)}\n$$\n代入 $\\beta = 1/(k_B T)$，其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度，我们得到最终表达式。\n\n对温度 $T$ 的定性依赖关系：\n温度依赖性包含在贝塞尔函数的自变量中，即 $x = \\beta C = C/(k_B T)$。\n\n1.  **高温极限 ($T \\to \\infty$):**\n    当 $T \\to \\infty$ 时，$\\beta \\to 0$，因此 $x \\to 0$。对于小的 $x$，贝塞尔函数的级数展开为 $I_0(x) \\approx 1$ 和 $I_1(x) \\approx x/2$。\n    该比值变为 $\\frac{I_1(x)}{I_0(x)} \\approx \\frac{x/2}{1} = \\frac{x}{2}$。\n    当 $T \\to \\infty$ 时，$x \\to 0$，因此该比值趋近于 $0$。所以，$\\langle \\cos(n \\phi) \\rangle \\to 0$。\n    从物理上讲，在高温下，热能 $k_B T$ 远大于势垒高度（与 $C$ 成正比），因此二面角近乎自由旋转。所有角度 $\\phi$ 的出现概率几乎相等，而 $\\cos(n\\phi)$ 在均匀分布上的平均值为零。\n\n2.  **低温极限 ($T \\to 0$):**\n    当 $T \\to 0$ 时，$\\beta \\to \\infty$，因此 $x \\to \\infty$。对于大的 $x$，该比值的渐近展开为 $\\frac{I_1(x)}{I_0(x)} \\sim 1 - \\frac{1}{2x} + O(x^{-2})$。\n    当 $T \\to 0$ 时，$x \\to \\infty$，因此该比值趋近于 $1$。所以，$\\langle \\cos(n \\phi) \\rangle \\to \\cos(\\delta)$。\n    从物理上讲，在低温下，系统热能很小，会“冻结”在最低能量状态。当 $\\cos(n\\phi-\\delta)$ 取最大值，即 $\\cos(n\\phi-\\delta)=1$ 时，势能 $V(\\phi) = V_0 - C\\cos(n\\phi-\\delta)$ 达到最小。这发生在角度 $\\phi$ 满足 $n\\phi - \\delta = 2k\\pi$（其中 $k$ 为某个整数）处，即 $n\\phi = \\delta + 2k\\pi$。对于任何这些最小能量角，$\\cos(n\\phi) = \\cos(\\delta+2k\\pi) = \\cos(\\delta)$。在 $T=0$ 时，系统完全处于这些极小值点，因此平均值恰好是极小值点处的值。", "answer": "$$\n\\boxed{\\cos(\\delta) \\frac{I_1\\left(\\frac{C}{k_B T}\\right)}{I_0\\left(\\frac{C}{k_B T}\\right)}}\n$$", "id": "3457058"}, {"introduction": "势能面的形状决定了分子的动力学行为，本练习 [@problem_id:3457049] 将定量地探索这一核心关联。这是一个综合性的实践，它将分析理论（如高摩擦极限下的克莱默斯速率理论）与计算编程相结合，以预测一个物理过程——平面基团的翘曲或手性翻转——的速率。通过完成此练习，您将亲身体验力场参数（如扭转常数）如何直接控制构象变化的动力学，并学会如何运用基础理论来分析和预测这些动态事件。", "problem": "您的任务是为一个受异常扭转作用的平面基团构建并分析一个降维一维模型，该模型用于描述平面外畸变。降维坐标是一个平面外角，用 $\\phi$ 表示，单位为弧度。总势能 $U(\\phi)$ 定义为一个对称双阱项 $U_{\\mathrm{base}}(\\phi)$ 和一个谐振异常扭转项 $U_{\\mathrm{imp}}(\\phi)$ 的和。前者模拟了固有的翘曲趋势，后者则惩罚了对平面性的偏离：\n$$\nU(\\phi) \\equiv U_{\\mathrm{base}}(\\phi) + U_{\\mathrm{imp}}(\\phi), \\quad\nU_{\\mathrm{base}}(\\phi) = a \\,\\phi^{4} - b \\,\\phi^{2}, \\quad\nU_{\\mathrm{imp}}(\\phi) = \\tfrac{1}{2} k_{\\mathrm{imp}} \\,\\phi^{2}.\n$$\n这里，$a$ 和 $b$ 是表征基线平面外能量学的固定参数，$k_{\\mathrm{imp}}$ 是一个可调节的异常扭转力常数，用于强制实现平面性。假设使用以下常数和单位：\n- 能量单位为千卡/摩尔 (kcal/mol)。\n- 时间单位为皮秒 (ps)。\n- 角度单位为弧度。\n- 温度单位为开尔文 (K)。\n- 参数：$a = 5.0$ kcal/mol/rad$^{4}$，$b = 2.0$ kcal/mol/rad$^{2}$。\n- 转动摩擦系数（高摩擦机制）$\\zeta = 5.0$ kcal/mol·ps/rad$^{2}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 0.001987204258$ kcal/mol/K。\n\n从统计力学和动力学的基本原理出发，包括将牛顿定律应用于受强耗散（过阻尼机制）影响的一维坐标，以及在高摩擦极限下关于热激活势垒穿越的标准且经过充分检验的结果，完成以下任务：\n1. 对于使系统保持为对称双阱的 $k_{\\mathrm{imp}}$，确定 $U(\\phi)$ 的驻点（极小值点和鞍点）、阱间翻转的势垒高度 $\\Delta U$，以及在极小值点和鞍点处的曲率 $U''$。\n2. 使用物理上合理的髙摩擦（过阻尼）热激活理论，推导一个关于意外的平面外翘曲和手性翻转速率 $k(T)$（单位为 ps$^{-1}$）的表达式，该表达式是绝对温度 $T$、势垒高度、曲率和摩擦系数 $\\zeta$ 的函数。得出阿伦尼乌斯形式 $k(T) = A \\exp(-E_{\\mathrm{a}}/(k_{\\mathrm{B}} T))$，并明确地用 $a$、$b$、$k_{\\mathrm{imp}}$ 和 $\\zeta$ 表示活化能 $E_{\\mathrm{a}}$（单位为 kcal/mol）和指前因子 $A$（单位为 ps$^{-1}$）。\n3. 实现一个程序，对于每个指定的 $k_{\\mathrm{imp}}$，在几个温度下计算 $k(T)$，通过对 $\\ln k$ 与 $1/T$进行线性回归来拟合阿伦尼乌斯形式，从而数值化地提取 $(E_{\\mathrm{a}}, A)$，并报告这些提取出的参数。\n\n重要约束：\n- 在过阻尼、高摩擦机制下工作，并假设所选的 $k_{\\mathrm{imp}}$ 能使 $U(\\phi)$ 保持为具有两个极小值点和一个居间的鞍点的对称双阱。根据给定参数，这为您必须在推导中确定的 $k_{\\mathrm{imp}}$ 施加了一个严格的上限。请勿考虑此范围之外的值。\n- 所有能量均以 kcal/mol 表示，所有时间以 ps 表示，角度以弧度表示，温度以 K 表示。提取的活化能必须以 kcal/mol 为单位，指前因子必须以 ps$^{-1}$ 为单位。\n- 您的程序必须使用您推导出的 $k(T)$ 解析表达式计算速率，然后执行线性回归，为每个 $k_{\\mathrm{imp}}$ 提取阿伦尼乌斯参数 $(E_{\\mathrm{a}}, A)$。\n\n测试套件：\n- 使用以下异常扭转常数（kcal/mol/rad$^{2}$）：$k_{\\mathrm{imp}} \\in \\{0.5,\\, 2.0,\\, 3.5,\\, 3.9\\}$。\n- 使用以下温度（K）：$T \\in \\{300,\\, 400,\\, 500,\\, 600\\}$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含结果，形式为逗号分隔的列表的列表，每个内部列表对应一个 $k_{\\mathrm{imp}}$，顺序与上面给定的一致。每个内部列表必须为 $[E_{\\mathrm{a}}, A]$ 的形式，其中 $E_{\\mathrm{a}}$ 是拟合的活化能（kcal/mol），$A$ 是拟合的指前因子（ps$^{-1}$）。将 $E_{\\mathrm{a}}$ 和 $A$ 都四舍五入到六位小数。\n- 示例格式（仅作说明）：[[Ea_for_k0,A_for_k0],[Ea_for_k1,A_for_k1],...]。", "solution": "总势能 $U(\\phi)$ 由基线双阱势和一个谐振异常扭转项的和给出：\n$$U(\\phi) = a \\phi^4 - b \\phi^2 + \\frac{1}{2} k_{\\mathrm{imp}} \\phi^2$$\n通过合并二次项，可以简化此式：\n$$U(\\phi) = a \\phi^4 - \\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right) \\phi^2$$\n让我们定义一个有效参数 $b' = b - \\frac{1}{2} k_{\\mathrm{imp}}$。势能随后以对称双阱势的典范形式表示：\n$$U(\\phi) = a \\phi^4 - b' \\phi^2$$\n为了使该势描述一个在 $\\phi=0$ 处有势垒分隔的双阱，二次项的系数 $b'$ 必须为正。这对异常扭转力常数 $k_{\\mathrm{imp}}$ 施加了一个约束：\n$$b' > 0 \\implies b - \\frac{1}{2} k_{\\mathrm{imp}} > 0 \\implies k_{\\mathrm{imp}}  2b$$\n给定参数 $b = 2.0$ kcal/mol/rad$^2$，力常数的上限为 $k_{\\mathrm{imp}}  4.0$ kcal/mol/rad$^2$。所提供的测试值 $k_{\\mathrm{imp}} \\in \\{0.5, 2.0, 3.5, 3.9\\}$ 均满足此条件，确保系统保持为双阱。\n\n**1. 驻点、势垒高度和曲率**\n\n通过将 $U(\\phi)$ 对 $\\phi$ 的一阶导数设为零来找到势的驻点：\n$$U'(\\phi) = \\frac{dU}{d\\phi} = 4a \\phi^3 - 2b' \\phi = 2\\phi(2a\\phi^2 - b') = 0$$\n此方程产生三个驻点解：\n$$ \\phi = 0, \\quad \\text{and} \\quad \\phi = \\pm\\sqrt{\\frac{b'}{2a}} $$\n为了对这些点进行分类，我们计算二阶导数 $U''(\\phi)$：\n$$U''(\\phi) = \\frac{d^2U}{d\\phi^2} = 12a \\phi^2 - 2b'$$\n- 在 $\\phi = 0$ 处，曲率为 $U''(0) = -2b'$。由于 $b' > 0$，曲率为负，表明这是一个局部极大值。这是势的鞍点，位于 $\\phi_{\\mathrm{sad}} = 0$。鞍点处的曲率为 $U''(\\phi_{\\mathrm{sad}}) = -2b'$。\n- 在 $\\phi = \\pm\\sqrt{b'/(2a)}$ 处，曲率为 $U''(\\pm\\sqrt{b'/(2a)}) = 12a(b'/(2a)) - 2b' = 6b' - 2b' = 4b'$。由于 $b' > 0$，曲率为正，表明这是局部极小值。这两个点是两个势阱的位置，$\\phi_{\\mathrm{min}} = \\pm\\sqrt{b'/(2a)}$。极小值点处的曲率为 $U''(\\phi_{\\mathrm{min}}) = 4b'$。\n\n势垒高度 $\\Delta U$ 是鞍点与其中一个极小值点之间的势能差：\n$$\\Delta U = U(\\phi_{\\mathrm{sad}}) - U(\\phi_{\\mathrm{min}})$$\n$$U(\\phi_{\\mathrm{sad}}) = U(0) = a(0)^4 - b'(0)^2 = 0$$\n$$U(\\phi_{\\mathrm{min}}) = a\\left(\\frac{b'}{2a}\\right)^2 - b'\\left(\\frac{b'}{2a}\\right) = \\frac{(b')^2}{4a} - \\frac{(b')^2}{2a} = -\\frac{(b')^2}{4a}$$\n因此，势垒高度为：\n$$\\Delta U = 0 - \\left(-\\frac{(b')^2}{4a}\\right) = \\frac{(b')^2}{4a}$$\n\n**2. 速率表达式和阿伦尼乌斯参数**\n\n问题指定了高摩擦（过阻尼）机制下的动力学。热激活势垒穿越的速率由 Kramers 理论描述。对于高摩擦极限（也称为 Smoluchowski 极限）下的一维势，从一个阱中逃逸的速率常数 $k(T)$ 由以下公式给出：\n$$k(T) = \\frac{\\sqrt{U''(\\phi_{\\mathrm{min}}) \\cdot |U''(\\phi_{\\mathrm{sad}})|}}{2\\pi \\zeta} \\exp\\left(-\\frac{\\Delta U}{k_{\\mathrm{B}} T}\\right)$$\n其中 $\\zeta$ 是摩擦系数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。$|U''(\\phi_{\\mathrm{sad}})|$ 是鞍点处（负）曲率的绝对值。\n\n我们代入上一节中推导出的表达式：\n- $\\Delta U = \\frac{(b')^2}{4a}$\n- $U''(\\phi_{\\mathrm{min}}) = 4b'$\n- $|U''(\\phi_{\\mathrm{sad}})| = |-2b'| = 2b'$\n\n曲率的乘积为 $U''(\\phi_{\\mathrm{min}}) \\cdot |U''(\\phi_{\\mathrm{sad}})| = (4b')(2b') = 8(b')^2$。其平方根为 $\\sqrt{8(b')^2} = 2\\sqrt{2} b'$（因为 $b' > 0$）。\n将这些代入速率公式中得到：\n$$k(T) = \\frac{2\\sqrt{2} b'}{2\\pi \\zeta} \\exp\\left(-\\frac{(b')^2}{4a k_{\\mathrm{B}} T}\\right)$$\n简化并用 $b$ 和 $k_{\\mathrm{imp}}$ 的定义替换 $b'$：\n$$k(T) = \\frac{\\sqrt{2} \\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)}{\\pi \\zeta} \\exp\\left(-\\frac{\\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)^2}{4a k_{\\mathrm{B}} T}\\right)$$\n将此速率表达式与经验性的阿伦尼乌斯方程 $k(T) = A \\exp(-E_{\\mathrm{a}}/(k_{\\mathrm{B}} T))$ 进行比较。通过直接比较，我们确定活化能 $E_{\\mathrm{a}}$ 和指前因子 $A$：\n- 活化能：$E_{\\mathrm{a}} = \\Delta U = \\frac{\\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)^2}{4a}$\n- 指前因子：$A = \\frac{\\sqrt{2} \\left(b - \\frac{1}{2} k_{\\mathrm{imp}}\\right)}{\\pi \\zeta}$\n这些是理论上的阿伦尼乌斯参数。请注意，指前因子 $A$ 与温度无关，这与高摩擦模型一致。\n\n**3. 数值实现**\n\n程序将实现推导出的表达式。对于每个给定的 $k_{\\mathrm{imp}}$ 值，它将首先计算理论参数 $E_{\\mathrm{a}}$ 和 $A$。然后，它将计算测试套件中每个温度 $T_i$ 下的速率 $k(T_i)$。为了按要求通过回归提取阿伦尼乌斯参数，我们通过取自然对数来变换阿伦尼乌斯方程：\n$$\\ln k(T) = \\ln A - \\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}}} \\left(\\frac{1}{T}\\right)$$\n这是一个 $y = c + mx$ 形式的线性方程，其中 $y = \\ln k$，$x = 1/T$，截距为 $c = \\ln A$，斜率为 $m = -E_{\\mathrm{a}}/k_{\\mathrm{B}}$。\n程序将对计算出的数据点 $(\\frac{1}{T_i}, \\ln k(T_i))$ 进行线性回归，以找到斜率 $m$ 和截距 $c$。然后，拟合的阿伦尼乌斯参数可恢复为：\n- $E_{\\mathrm{a}}^{\\text{fit}} = -m \\cdot k_{\\mathrm{B}}$\n- $A^{\\text{fit}} = \\exp(c)$\n由于数据是从完美的阿伦尼乌斯形式生成的，拟合参数将与理论值在机器精度内匹配。最终输出将是一个列表，包含每个 $k_{\\mathrm{imp}}$ 的配对 $[E_{\\mathrm{a}}^{\\text{fit}}, A^{\\text{fit}}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates and fits Arrhenius parameters for an out-of-plane puckering model.\n    \"\"\"\n    # Define the constants from the problem statement.\n    # Energy in kcal/mol, time in ps, angle in radians, temperature in K.\n    a = 5.0  # kcal/mol/rad^4\n    b = 2.0  # kcal/mol/rad^2\n    zeta = 5.0  # kcal/mol*ps/rad^2\n    k_B = 0.001987204258  # kcal/mol/K\n\n    # Define the test cases from the problem statement.\n    k_imp_values = [0.5, 2.0, 3.5, 3.9]  # kcal/mol/rad^2\n    temperatures = [300, 400, 500, 600] # K\n\n    # List to store the final results for all k_imp values\n    all_results = []\n\n    for k_imp in k_imp_values:\n        # Effective quadratic coefficient b_prime\n        b_prime = b - 0.5 * k_imp\n\n        # The problem constraints ensure b_prime > 0, so no check is strictly needed.\n\n        # 1. Calculate theoretical Arrhenius parameters (E_a, A) based on the derivation.\n        # Activation energy E_a = (b_prime^2) / (4*a)\n        E_a_theo = (b_prime**2) / (4 * a)\n        # Pre-exponential factor A = (sqrt(2) * b_prime) / (pi * zeta)\n        A_theo = (np.sqrt(2) * b_prime) / (np.pi * zeta)\n\n        # 2. Generate data points for regression. The problem specifies fitting the\n        #    calculated rates to an Arrhenius form.\n        T_inv = 1.0 / np.array(temperatures)\n\n        # Calculate rates k(T) using the derived theoretical expression.\n        rates = A_theo * np.exp(-E_a_theo / (k_B * np.array(temperatures)))\n        ln_k = np.log(rates)\n\n        # 3. Perform a linear regression of ln(k) vs 1/T.\n        # np.polyfit(x, y, 1) returns [slope, intercept] for the best-fit line y = slope*x + intercept.\n        slope, intercept = np.polyfit(T_inv, ln_k, 1)\n\n        # 4. Extract E_a and A from the regression parameters.\n        # From ln(k) = ln(A) - (E_a / k_B) * (1/T):\n        # slope = -E_a / k_B  =>  E_a = -slope * k_B\n        # intercept = ln(A)   =>  A = exp(intercept)\n        E_a_fit = -slope * k_B\n        A_fit = np.exp(intercept)\n\n        # 5. Append the rounded results for the current k_imp to the main list.\n        # The problem asks for rounding to six decimal places.\n        all_results.append([round(E_a_fit, 6), round(A_fit, 6)])\n\n    # 6. Format the final output string exactly as specified.\n    # The required format is [[E_a1,A_1],[E_a2,A_2],...] with no spaces.\n    inner_strings = []\n    for res_pair in all_results:\n        inner_strings.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    final_output_str = f\"[{','.join(inner_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "3457049"}]}