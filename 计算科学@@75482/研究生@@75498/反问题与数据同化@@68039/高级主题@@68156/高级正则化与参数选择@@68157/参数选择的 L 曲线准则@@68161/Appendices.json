{"hands_on_practices": [{"introduction": "本练习旨在巩固L曲线方法的数学基础。[@problem_id:3394293] 我们将推导吉洪诺夫正则化解的解析形式，并证明其对正则化参数 $\\lambda$ 的平滑依赖性，这是确保L曲线是一条可微路径并能通过曲率分析的关键前提。", "problem": "考虑线性反问题中的Tikhonov正则化最小二乘问题，该问题寻求$x_{\\lambda}$作为泛函$J_{\\lambda}(x) = \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|L x\\|_{2}^{2}$的极小值点，其中$A \\in \\mathbb{R}^{m \\times n}$是列满秩矩阵，$b \\in \\mathbb{R}^{m}$，$\\lambda > 0$是正则化参数，$L \\in \\mathbb{R}^{p \\times n}$是正则化算子。必要最优性条件导出了正规方程$(A^\\top A + \\lambda^{2} L^\\top L) x_{\\lambda} = A^\\top b$。在标准情况$L = I$下，用于参数选择的L曲线准则分析了作为$\\lambda$的函数的参数曲线$\\left(\\ln \\|A x_{\\lambda} - b\\|_{2}, \\ln \\|x_{\\lambda}\\|_{2}\\right)$，这要求$x_{\\lambda}$对$\\lambda$有光滑依赖性。\n\n(a) 从上述最优性条件出发，在$L = I$和$A$列满秩的假设下，推导用$A$、$b$和$\\lambda$表示的$x_{\\lambda}$的表达式。证明映射$\\lambda \\mapsto x_{\\lambda}$对于所有实数$\\lambda$都是光滑的。\n\n(b) 使用(a)部分的结果，考虑由下式给出的特定列满秩矩阵$A \\in \\mathbb{R}^{3 \\times 2}$和向量$b \\in \\mathbb{R}^{3}$\n$$\nA = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n1  1\n\\end{pmatrix}, \n\\qquad\nb = \\begin{pmatrix}\n1 \\\\\n2 \\\\\n0\n\\end{pmatrix}.\n$$\n为此$(A,b)$计算$x_{\\lambda}$作为$\\lambda$的显式闭式函数。\n\n你的最终答案应为(b)部分得到的$x_{\\lambda}$的表达式，使用$\\texttt{pmatrix}$环境写成单行形式。不需要数值近似，也不涉及单位。", "solution": "问题陈述被评估为有效。这是一个数值线性代数和反问题中的适定问题，基于成熟的数学原理。该问题是自洽的，提供了所有必要的数据和定义。给定的矩阵和向量是一致的，并且假设（例如，$A$具有列满秩）是适当的，以确保唯一且有意义的解。\n\n(a) 我们从特定情况（正则化算子为单位矩阵$L = I$）下的Tikhonov正则化正规方程开始。需要最小化的泛函是$J_{\\lambda}(x) = \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|x\\|_{2}^{2}$。必要最优性条件$\\nabla_x J_{\\lambda}(x) = 0$导出了正规方程：\n$$\n(A^\\top A + \\lambda^{2} I) x_{\\lambda} = A^\\top b\n$$\n这里，$A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$，$x_{\\lambda} \\in \\mathbb{R}^{n}$，且$I$是$n \\times n$的单位矩阵。\n\n为了推导$x_{\\lambda}$的表达式，我们必须证明矩阵$M(\\lambda) = A^\\top A + \\lambda^{2} I$是可逆的。已知$A$是列满秩的。这意味着它的列是线性无关的，并且对于任何非零向量$v \\in \\mathbb{R}^{n}$，乘积$Av$是$\\mathbb{R}^{m}$中的一个非零向量。因此，对于任何$v \\neq 0$，欧几里得范数的平方$\\|Av\\|_{2}^{2} = v^\\top A^\\top A v$是严格为正的。这就是$A^\\top A$是对称正定（SPD）矩阵的定义。\n\n现在，考虑对任意实数$\\lambda$的矩阵$M(\\lambda)$。对于任意非零向量$v \\in \\mathbb{R}^{n}$，其二次型为：\n$$\nv^\\top M(\\lambda) v = v^\\top (A^\\top A + \\lambda^{2} I) v = v^\\top A^\\top A v + \\lambda^{2} v^\\top I v = \\|Av\\|_{2}^{2} + \\lambda^{2} \\|v\\|_{2}^{2}\n$$\n由于$A$是列满秩，$\\|Av\\|_{2}^{2} > 0$。由于$v \\neq 0$，$\\|v\\|_{2}^{2} > 0$。对于任意实数$\\lambda$，$\\lambda^2 \\ge 0$。因此，和$\\|Av\\|_{2}^{2} + \\lambda^{2} \\|v\\|_{2}^{2}$是严格为正的。这表明对于所有实数$\\lambda$，$M(\\lambda)$都是正定的。正定矩阵总是可逆的。\n\n由于$A^\\top A + \\lambda^2 I$对所有实数$\\lambda$都是可逆的，我们可以唯一地解出$x_{\\lambda}$：\n$$\nx_{\\lambda} = (A^\\top A + \\lambda^2 I)^{-1} A^\\top b\n$$\n为了证明映射$\\lambda \\mapsto x_{\\lambda}$对于所有实数$\\lambda$都是光滑的，我们考察$x_{\\lambda}(\\lambda)$的结构。向量$x_\\lambda$是矩阵$(A^\\top A + \\lambda^2 I)^{-1}$与常向量$A^\\top b$的乘积。矩阵$A^\\top A + \\lambda^2 I$的元素是$\\lambda$的多项式函数（最高次数为2）。\n\n矩阵$C$的逆可以表示为$C^{-1} = \\frac{1}{\\det(C)} \\text{adj}(C)$，其中$\\text{adj}(C)$是伴随矩阵。\n1. 行列式$\\det(A^\\top A + \\lambda^2 I)$是$\\lambda$的多项式。正如我们已经证明的，对于所有实数$\\lambda$，$A^\\top A + \\lambda^2 I$都是正定的，因此它的所有特征值都是正的。行列式作为特征值的乘积，对于所有实数$\\lambda$也严格为正。因此，多项式$\\det(A^\\top A + \\lambda^2 I)$没有实根。\n2. 伴随矩阵$\\text{adj}(A^\\top A + \\lambda^2 I)$的元素是代数余子式，它们是子矩阵的行列式。由于$A^\\top A + \\lambda^2 I$的元素是$\\lambda$的多项式，伴随矩阵的元素也是$\\lambda$的多项式。\n\n逆矩阵$(A^\\top A + \\lambda^2 I)^{-1}$的每个元素都是一个$\\lambda$的多项式与另一个$\\lambda$的多项式（行列式）的比。由于分母多项式没有实根，每个元素都是一个有理函数，它对所有实数$\\lambda$都有定义且无穷次可微（即光滑的）。\n\n向量$x_{\\lambda}$是通过将这个由光滑函数组成的矩阵与常向量$A^\\top b$相乘得到的。$x_{\\lambda}$的每个分量是这些光滑函数的线性组合，因此其本身也是$\\lambda$的光滑函数。因此，映射$\\lambda \\mapsto x_{\\lambda}$对于所有实数$\\lambda$都是光滑的。\n\n(b) 给定特定的矩阵$A \\in \\mathbb{R}^{3 \\times 2}$和向量$b \\in \\mathbb{R}^{3}$：\n$$\nA = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n1  1\n\\end{pmatrix}, \n\\qquad\nb = \\begin{pmatrix}\n1 \\\\\n2 \\\\\n0\n\\end{pmatrix}\n$$\n$A$的列显然是线性无关的，所以$A$是列满秩的。首先，我们计算$A^\\top A$和$A^\\top b$。\n$$\nA^\\top = \\begin{pmatrix}\n1  0  1 \\\\\n0  1  1\n\\end{pmatrix}\n$$\n$$\nA^\\top A = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 1(1)+0(0)+1(1)  1(0)+0(1)+1(1) \\\\ 0(1)+1(0)+1(1)  0(0)+1(1)+1(1) \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\nA^\\top b = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1(1)+0(2)+1(0) \\\\ 0(1)+1(2)+1(0) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n接下来，我们构造矩阵$M(\\lambda) = A^\\top A + \\lambda^2 I$：\n$$\nM(\\lambda) = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} + \\lambda^2 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2+\\lambda^2  1 \\\\ 1  2+\\lambda^2 \\end{pmatrix}\n$$\n我们求这个矩阵的逆。它的行列式是：\n$$\n\\det(M(\\lambda)) = (2+\\lambda^2)^2 - 1^2 = 4 + 4\\lambda^2 + \\lambda^4 - 1 = \\lambda^4 + 4\\lambda^2 + 3\n$$\n这可以因式分解为$(\\lambda^2+1)(\\lambda^2+3)$。逆矩阵是：\n$$\nM(\\lambda)^{-1} = \\frac{1}{(\\lambda^2+1)(\\lambda^2+3)} \\begin{pmatrix} 2+\\lambda^2  -1 \\\\ -1  2+\\lambda^2 \\end{pmatrix}\n$$\n最后，我们计算$x_{\\lambda} = M(\\lambda)^{-1} (A^\\top b)$：\n$$\nx_{\\lambda} = \\frac{1}{(\\lambda^2+1)(\\lambda^2+3)} \\begin{pmatrix} 2+\\lambda^2  -1 \\\\ -1  2+\\lambda^2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n$$\nx_{\\lambda} = \\frac{1}{(\\lambda^2+1)(\\lambda^2+3)} \\begin{pmatrix} 1(2+\\lambda^2) - 1(2) \\\\ -1(1) + 2(2+\\lambda^2) \\end{pmatrix}\n$$\n$$\nx_{\\lambda} = \\frac{1}{(\\lambda^2+1)(\\lambda^2+3)} \\begin{pmatrix} 2+\\lambda^2 - 2 \\\\ -1 + 4 + 2\\lambda^2 \\end{pmatrix}\n$$\n$$\nx_{\\lambda} = \\frac{1}{(\\lambda^2+1)(\\lambda^2+3)} \\begin{pmatrix} \\lambda^2 \\\\ 2\\lambda^2+3 \\end{pmatrix}\n$$\n这给出了$x_{\\lambda}$各分量的闭式表达式：\n$$\nx_{\\lambda} = \\begin{pmatrix} \\frac{\\lambda^2}{(\\lambda^2+1)(\\lambda^2+3)} \\\\ \\frac{2\\lambda^2+3}{(\\lambda^2+1)(\\lambda^2+3)} \\end{pmatrix}\n$$\n这就是所要求的$x_{\\lambda}$作为$\\lambda$的函数的显式表达式。最终答案是包含这两个分量的列向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\lambda^2}{(\\lambda^2+1)(\\lambda^2+3)} \\\\ \\frac{2\\lambda^2+3}{(\\lambda^2+1)(\\lambda^2+3)} \\end{pmatrix}}\n$$", "id": "3394293"}, {"introduction": "本实践通过奇异值分解（SVD）深入探讨L曲线形状的来源。[@problem_id:3394301] 通过将残差和解范数分解到问题的谱空间中，您将看到吉洪诺夫正则化如何充当一个滤波器，并理解L曲线如何直观地展现了数据拟合与解稳定性之间的权衡。", "problem": "考虑线性反问题 $A x = b$，其中 $A \\in \\mathbb{R}^{m \\times n}$，以及零阶 Tikhonov 正则化解\n$$\nx_{\\lambda} \\in \\arg \\min_{x \\in \\mathbb{R}^{n}} \\left\\{ \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|x\\|_{2}^{2} \\right\\},\n$$\n其中 $\\lambda > 0$ 是正则化参数。设 $A$ 的奇异值分解（SVD）为 $A = U \\Sigma V^{\\top}$，其中奇异值 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots \\geq \\sigma_{r} > 0$ 位于 $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 的对角线上，左奇异向量为 $\\{u_{i}\\}_{i=1}^{m}$（$U$ 的列），右奇异向量为 $\\{v_{i}\\}_{i=1}^{n}$（$V$ 的列）。将数据分解为 $b = \\sum_{i=1}^{r} (u_{i}^{\\top} b) u_{i} + b_{\\perp}$，其中 $b_{\\perp}$ 是与 $A$ 的值域正交的分量。定义残差范数 $r(\\lambda) := \\|A x_{\\lambda} - b\\|_{2}$ 和解的半范数 $p(\\lambda) := \\|x_{\\lambda}\\|_{2}$。\n\n任务：\n1) 从 $x_{\\lambda}$ 的定义和 $A$ 的 SVD 出发，推导以下表达式\n$$\nr(\\lambda)^{2} \\;=\\; \\sum_{i=1}^{r} \\left(\\frac{\\lambda^{2}}{\\sigma_{i}^{2} + \\lambda^{2}}\\right)^{2} (u_{i}^{\\top} b)^{2} \\;+\\; \\|b_{\\perp}\\|_{2}^{2},\n\\quad\np(\\lambda)^{2} \\;=\\; \\sum_{i=1}^{r} \\left(\\frac{\\sigma_{i}^{2}}{\\sigma_{i}^{2} + \\lambda^{2}}\\right)^{2} \\frac{(u_{i}^{\\top} b)^{2}}{\\sigma_{i}^{2}}.\n$$\n2) 分析 $r(\\lambda)$ 和 $p(\\lambda)$ 如何依赖于 $\\lambda$ 以及数据系数 $(u_{i}^{\\top} b)$ 相对于奇异值 $\\sigma_{i}$ 的衰减率，包括它们在 $\\lambda \\to 0^{+}$ 和 $\\lambda \\to \\infty$ 时的极限。\n3) 将 L-曲线定义为参数曲线 $L(\\lambda) = \\big(\\ln r(\\lambda), \\ln p(\\lambda)\\big)$。平面参数曲线 $(x(\\lambda), y(\\lambda))$ 的曲率由下式给出\n$$\n\\kappa(\\lambda) \\;=\\; \\frac{|x'(\\lambda)\\, y''(\\lambda) \\;-\\; y'(\\lambda)\\, x''(\\lambda)|}{\\big(x'(\\lambda)^{2} + y'(\\lambda)^{2}\\big)^{3/2}}.\n$$\n对于奇异值 $\\sigma_{1} = 10$, $\\sigma_{2} = 1$, $\\sigma_{3} = 0.1$，数据系数 $u_{1}^{\\top} b = 1$, $u_{2}^{\\top} b = 0.01$, $u_{3}^{\\top} b = 0.0001$，且 $b_{\\perp} = 0$ 的特定三维问题，计算 L-曲线在 $\\lambda = 1$ 处的曲率 $\\kappa(1)$。将您的最终答案四舍五入到 4 位有效数字。最终答案无单位，必须以单个实数的形式给出。", "solution": "该问题要求对一个反问题的 Tikhonov 正则化解 $x_{\\lambda}$ 进行三部分分析。首先，我们推导残差范数和解范数的表达式。其次，我们分析它们的行为。第三，我们计算一个特定情况下 L-曲线的曲率。\n\n**第 1 部分：$r(\\lambda)^2$ 和 $p(\\lambda)^2$ 的推导**\n\nTikhonov 正则化解 $x_{\\lambda}$ 最小化泛函 $J(x) = \\|A x - b\\|_{2}^{2} + \\lambda^{2} \\|x\\|_{2}^{2}$。通过将 $J(x)$ 对 $x$ 的梯度设为零来找到最小值：\n$$\n\\nabla_{x} J(x) = 2 A^{\\top}(A x - b) + 2 \\lambda^{2} x = 0.\n$$\n这导出了正规方程组：\n$$\n(A^{\\top}A + \\lambda^{2} I) x_{\\lambda} = A^{\\top}b.\n$$\n因此，解为 $x_{\\lambda} = (A^{\\top}A + \\lambda^{2} I)^{-1} A^{\\top}b$。我们代入奇异值分解（SVD）$A = U \\Sigma V^{\\top}$。\n$A^{\\top}A = (V \\Sigma^{\\top} U^{\\top})(U \\Sigma V^{\\top}) = V \\Sigma^{\\top}\\Sigma V^{\\top}$。矩阵 $\\Sigma^{\\top}\\Sigma$ 是一个 $n \\times n$ 的对角矩阵，其对角线元素为 $\\sigma_i^2$（$i=1, \\dots, r$），其他地方为零。我们将其记为 $\\Sigma_n^2$。\n所以，$A^{\\top}A = V \\Sigma_n^2 V^{\\top}$。\n另外，$A^{\\top}b = V \\Sigma^{\\top} U^{\\top}b$。\n将这些代入 $x_{\\lambda}$ 的表达式中：\n$$\nx_{\\lambda} = (V \\Sigma_n^2 V^{\\top} + \\lambda^{2} V V^{\\top})^{-1} V \\Sigma^{\\top} U^{\\top}b = (V(\\Sigma_n^2 + \\lambda^{2} I)V^{\\top})^{-1} V \\Sigma^{\\top} U^{\\top}b.\n$$\n使用性质 $(XYZ)^{-1} = Z^{-1}Y^{-1}X^{-1}$ 以及 $V^{-1}=V^{\\top}$，我们得到：\n$$\nx_{\\lambda} = V(\\Sigma_n^2 + \\lambda^{2} I)^{-1}V^{\\top} V \\Sigma^{\\top} U^{\\top}b = V (\\Sigma_n^2 + \\lambda^{2} I)^{-1} \\Sigma^{\\top} U^{\\top}b.\n$$\n矩阵 $(\\Sigma_n^2 + \\lambda^{2} I)^{-1} \\Sigma^{\\top}$ 是一个 $n \\times m$ 的矩阵。其非零元素在对角线上，值为 $\\frac{\\sigma_i}{\\sigma_i^2 + \\lambda^2}$（$i=1, \\dots, r$）。\n令 $\\hat{b}_i = u_i^{\\top}b$。向量 $U^{\\top}b$ 包含这些系数。\n$(\\Sigma_n^2 + \\lambda^2 I)^{-1} \\Sigma^{\\top}$ 作用于 $U^{\\top}b$ 会产生一个 $\\mathbb{R}^n$ 中的向量，其第 $i$ 个分量为 $\\frac{\\sigma_i \\hat{b}_i}{\\sigma_i^2 + \\lambda^2}$（$i=1, \\dots, r$），其他分量为零。\n乘以 $V$ 将此向量表示在右奇异向量基 $\\{v_i\\}$ 中：\n$$\nx_{\\lambda} = \\sum_{i=1}^{r} \\frac{\\sigma_i (u_i^{\\top}b)}{\\sigma_i^2 + \\lambda^2} v_i.\n$$\n现在我们计算解的半范数 $p(\\lambda) = \\|x_{\\lambda}\\|_2$。由于向量 $\\{v_i\\}$ 是标准正交的，范数的平方是系数的平方和：\n$$\np(\\lambda)^2 = \\|x_{\\lambda}\\|_2^2 = \\sum_{i=1}^{r} \\left(\\frac{\\sigma_i (u_i^{\\top}b)}{\\sigma_i^2 + \\lambda^2}\\right)^2 = \\sum_{i=1}^{r} \\left(\\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}\\right)^2 \\frac{(u_i^{\\top}b)^2}{\\sigma_i^2}.\n$$\n这验证了第二个公式。\n\n接下来，我们计算残差范数 $r(\\lambda) = \\|A x_{\\lambda} - b\\|_2$。\n首先，求 $A x_{\\lambda}$：\n$$\nA x_{\\lambda} = (U \\Sigma V^{\\top}) \\left( \\sum_{j=1}^{r} \\frac{\\sigma_j (u_j^{\\top}b)}{\\sigma_j^2 + \\lambda^2} v_j \\right) = \\sum_{j=1}^{r} \\frac{\\sigma_j (u_j^{\\top}b)}{\\sigma_j^2 + \\lambda^2} (U \\Sigma V^{\\top} v_j).\n$$\n由于 $V^{\\top}v_j=e_j$（第 $j$ 个标准基向量）且 $\\Sigma e_j = \\sigma_j e_j$，我们有 $U\\Sigma V^{\\top}v_j = U (\\sigma_j e_j) = \\sigma_j u_j$。\n$$\nA x_{\\lambda} = \\sum_{j=1}^{r} \\frac{\\sigma_j^2 (u_j^{\\top}b)}{\\sigma_j^2 + \\lambda^2} u_j.\n$$\n残差向量为 $A x_{\\lambda} - b$。使用给定的分解 $b = \\sum_{i=1}^{r} (u_i^{\\top}b)u_i + b_{\\perp}$：\n$$\nA x_{\\lambda} - b = \\sum_{i=1}^{r} \\left(\\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2} - 1\\right) (u_i^{\\top}b) u_i - b_{\\perp} = \\sum_{i=1}^{r} \\left(\\frac{-\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right) (u_i^{\\top}b) u_i - b_{\\perp}.\n$$\n向量 $\\{u_i\\}$ 是标准正交的，并且与 $b_{\\perp}$ 正交。因此，范数的平方为：\n$$\nr(\\lambda)^2 = \\|A x_{\\lambda} - b\\|_2^2 = \\sum_{i=1}^{r} \\left(\\frac{-\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right)^2 (u_i^{\\top}b)^2 + \\|b_{\\perp}\\|_2^2 = \\sum_{i=1}^{r} \\left(\\frac{\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right)^2 (u_i^{\\top}b)^2 + \\|b_{\\perp}\\|_2^2.\n$$\n这验证了第一个公式。\n\n**第 2 部分：$r(\\lambda)$ 和 $p(\\lambda)$ 的分析**\n\n函数 $p(\\lambda)$ 和 $r(\\lambda)$ 关于 $\\lambda > 0$ 表现出单调行为。\n项 $\\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2}$ 是 $\\lambda$ 的递减函数。由于它在 $p(\\lambda)^2$ 的求和中是平方项，所以 $p(\\lambda)$ 必定是 $\\lambda$ 的严格递减函数。\n项 $\\frac{\\lambda^2}{\\sigma_i^2+\\lambda^2} = 1 - \\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2}$ 是 $\\lambda$ 的递增函数。由于它在 $r(\\lambda)^2$ 的求和中是平方项，所以 $r(\\lambda)$ 必定是 $\\lambda$ 的严格递增函数。\n\n当 $\\lambda \\to 0^{+}$ 时的极限：\n当 $\\lambda \\to 0^{+}$ 时，$\\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2} \\to 1$。因此，$p(\\lambda)^2 \\to \\sum_{i=1}^{r} \\frac{(u_i^{\\top}b)^2}{\\sigma_i^2}$。这是 Moore-Penrose 伪逆解 $x^{\\dagger} = \\sum_{i=1}^r \\frac{u_i^{\\top}b}{\\sigma_i}v_i$ 的范数平方。如果不满足离散 Picard 条件（即 $|u_i^{\\top}b|$ 的衰减速度慢于 $\\sigma_i$），在连续情况下该范数可能非常大或无穷大。\n当 $\\lambda \\to 0^{+}$ 时，$\\frac{\\lambda^2}{\\sigma_i^2+\\lambda^2} \\to 0$。因此，$r(\\lambda)^2 \\to \\|b_{\\perp}\\|_2^2$。这是数据中与 $A$ 的值域正交的分量的范数，代表了可能的最小残差（最小二乘残差）。\n\n当 $\\lambda \\to \\infty$ 时的极限：\n当 $\\lambda \\to \\infty$ 时，$\\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2} \\sim \\frac{\\sigma_i^2}{\\lambda^2} \\to 0$。因此，$p(\\lambda)^2 \\to 0$。解被严重阻尼并趋近于零向量。\n当 $\\lambda \\to \\infty$ 时，$\\frac{\\lambda^2}{\\sigma_i^2+\\lambda^2} \\to 1$。因此，$r(\\lambda)^2 \\to \\sum_{i=1}^r(u_i^{\\top}b)^2 + \\|b_{\\perp}\\|_2^2 = \\|b\\|_2^2$。当 $x_\\lambda \\to 0$ 时，残差 $Ax_\\lambda-b$ 趋近于 $-b$，因此其范数趋近于 $\\|b\\|_2$。\n\nL-曲线绘制了 $\\ln p(\\lambda)$ 对 $\\ln r(\\lambda)$ 的关系，由于这种行为，它通常呈 L 形。小的 $\\lambda$ 值对应于垂直部分（小残差，大解范数），而大的 $\\lambda$ 值对应于水平部分（大残差，小解范数）。\n\n**第 3 部分：曲率计算**\n\n我们已知 L-曲线 $L(\\lambda) = (x(\\lambda), y(\\lambda)) = (\\ln r(\\lambda), \\ln p(\\lambda))$，并被要求计算在特定情况下的曲率 $\\kappa(1)$。\n使用范数的平方 $\\rho(\\lambda) = r(\\lambda)^2$ 和 $\\pi(\\lambda) = p(\\lambda)^2$ 来计算更方便。曲线坐标则为 $x(\\lambda) = \\frac{1}{2}\\ln \\rho(\\lambda)$ 和 $y(\\lambda) = \\frac{1}{2}\\ln \\pi(\\lambda)$。\n我们需要 $x(\\lambda)$ 和 $y(\\lambda)$ 在 $\\lambda = 1$ 处的一阶和二阶导数。\n$x'(\\lambda) = \\frac{\\rho'(\\lambda)}{2\\rho(\\lambda)}$, $x''(\\lambda) = \\frac{\\rho''(\\lambda)\\rho(\\lambda) - (\\rho'(\\lambda))^2}{2\\rho(\\lambda)^2}$。\n$y'(\\lambda) = \\frac{\\pi'(\\lambda)}{2\\pi(\\lambda)}$, $y''(\\lambda) = \\frac{\\pi''(\\lambda)\\pi(\\lambda) - (\\pi'(\\lambda))^2}{2\\pi(\\lambda)^2}$。\n\n问题指定了 $\\sigma_1 = 10, \\sigma_2 = 1, \\sigma_3 = 0.1$，且 $b_{\\perp}=0$。数据系数的平方为 $\\beta_1 = (u_1^{\\top}b)^2=1^2=1$, $\\beta_2 = (u_2^{\\top}b)^2=(0.01)^2=10^{-4}$, $\\beta_3 = (u_3^{\\top}b)^2=(0.0001)^2=10^{-8}$。\n函数为：\n$\\rho(\\lambda) = \\sum_{i=1}^{3} \\left(\\frac{\\lambda^2}{\\sigma_i^2 + \\lambda^2}\\right)^{2} \\beta_i$，以及 $\\pi(\\lambda) = \\sum_{i=1}^{3} \\frac{\\sigma_i^2 \\beta_i}{(\\sigma_i^2 + \\lambda^2)^2}$。\n它们对 $\\lambda$ 的导数为：\n$\\rho'(\\lambda) = 4\\lambda^3 \\sum_{i=1}^{3} \\frac{\\sigma_i^2 \\beta_i}{(\\sigma_i^2 + \\lambda^2)^3}$。\n$\\pi'(\\lambda) = -4\\lambda \\sum_{i=1}^{3} \\frac{\\sigma_i^2 \\beta_i}{(\\sigma_i^2 + \\lambda^2)^3}$。\n在 $\\lambda=1$ 时，我们有 $\\rho'(1) = -\\pi'(1)$。\n$\\rho''(\\lambda)=12\\lambda^2 \\sum_{i=1}^{3} \\frac{\\beta_i \\sigma_i^2(\\sigma_i^2 - \\lambda^2)}{(\\sigma_i^2 + \\lambda^2)^4}$。\n$\\pi''(\\lambda) = \\sum_{i=1}^{3} \\frac{\\beta_i \\sigma_i^2 (20\\lambda^2 - 4\\sigma_i^2)}{(\\sigma_i^2 + \\lambda^2)^4}$。\n\n在 $\\lambda=1$ 时：\n$\\rho(1) = (\\frac{1}{101})^2(1) + (\\frac{1}{2})^2(10^{-4}) + (\\frac{1}{1.01})^2(10^{-8}) \\approx 1.2304 \\times 10^{-4}$。\n$\\pi(1) = \\frac{100(1)}{101^2} + \\frac{1(10^{-4})}{2^2} + \\frac{0.01(10^{-8})}{1.01^2} \\approx 9.8280 \\times 10^{-3}$。\n$\\rho'(1) = 4(\\frac{100}{101^3} + \\frac{10^{-4}}{2^3} + \\frac{0.001}{1.01^3}) \\approx 4.3824 \\times 10^{-4}$。\n因此 $\\pi'(1) \\approx -4.3824 \\times 10^{-4}$。\n$\\rho''(1) = 12(\\frac{100(99)}{101^4} + \\frac{1(10^{-4})(0)}{2^4} + \\frac{0.01(10^{-8})(-0.99)}{1.01^4}) \\approx 1.1416 \\times 10^{-3}$。\n$\\pi''(1) = \\frac{100(20-400)}{101^4} + \\frac{10^{-4}(20-4)}{2^4} + \\frac{0.01(10^{-8})(20-0.04)}{1.01^4} \\approx -2.6517 \\times 10^{-4}$。\n\n现在我们计算 L-曲线坐标的导数：\n$x'(1) = \\frac{\\rho'(1)}{2\\rho(1)} \\approx \\frac{4.3824 \\times 10^{-4}}{2(1.2304 \\times 10^{-4})} \\approx 1.7809$。\n$y'(1) = \\frac{\\pi'(1)}{2\\pi(1)} \\approx \\frac{-4.3824 \\times 10^{-4}}{2(9.8280 \\times 10^{-3})} \\approx -0.022293$。\n$x''(1) = \\frac{\\rho''(1)\\rho(1) - \\rho'(1)^2}{2\\rho(1)^2} \\approx \\frac{(1.1416 \\times 10^{-3})(1.2304 \\times 10^{-4}) - (4.3824 \\times 10^{-4})^2}{2(1.2304 \\times 10^{-4})^2} \\approx -1.7036$。\n$y''(1) = \\frac{\\pi''(1)\\pi(1) - \\pi'(1)^2}{2\\pi(1)^2} \\approx \\frac{(-2.6517 \\times 10^{-4})(9.8280 \\times 10^{-3}) - (-4.3824 \\times 10^{-4})^2}{2(9.8280 \\times 10^{-3})^2} \\approx -0.014484$。\n\n最后，将这些值代入曲率公式 $\\kappa(\\lambda) = \\frac{|x' y'' - y' x''|}{(x'^2 + y'^2)^{3/2}}$：\n分子：\n$|x'(1)y''(1) - y'(1)x''(1)| \\approx |(1.7809)(-0.014484) - (-0.022293)(-1.7036)|$\n$\\approx |-0.025795 - 0.037976| = |-0.063771| = 0.063771$。\n分母：\n$(x'(1)^2+y'(1)^2)^{3/2} \\approx ((1.7809)^2 + (-0.022293)^2)^{3/2}$\n$\\approx (3.1716 + 0.000497)^{3/2} = (3.1721)^{3/2} \\approx 5.6482$。\n\n$\\kappa(1) \\approx \\frac{0.063771}{5.6482} \\approx 0.0112905$。\n四舍五入到 4 位有效数字，曲率为 $0.01129$。", "answer": "$$\\boxed{0.01129}$$", "id": "3394301"}, {"introduction": "本练习通过一个编程任务将理论付诸实践。[@problem_id:3394295] 您将为一个模拟反问题实现L曲线角点的寻找，并将其选择的参数与理论上的皮卡尔条件进行比较，从而亲手验证L曲线作为一种有效启发式方法的价值。", "problem": "给定一个代表逆热方程的合成线性逆问题，其特征是指数衰减的奇异值分解 (SVD)。设正向算子建模为 $$A = U \\Sigma V^{\\top},$$ 其中 $$\\Sigma = \\operatorname{diag}(\\sigma_1,\\dots,\\sigma_n), \\quad \\sigma_i = \\exp(-\\alpha (i-1)),$$ 且 $$\\alpha > 0.$$ 设未知量在右奇异向量基中建模为 $$x_{\\text{true}} = \\sum_{i=1}^n c_i v_i,$$ 其系数为 $$c_i = s_i \\, i^{-p}, \\quad s_i \\in \\{-1,+1\\}.$$ 数据生成方式为 $$b = A x_{\\text{true}} + \\varepsilon,$$ 其中 $$\\varepsilon$$ 是一个均值为零的 Gaussian 噪声向量，其各分量独立且标准差为 $$\\delta.$$ 数据在左奇异向量基中的系数为 $$\\beta_i = u_i^{\\top} b = \\sigma_i c_i + \\eta_i,$$ 其中 $$\\eta_i \\sim \\mathcal{N}(0,\\delta^2)$$ 且对于不同的 $$i$$ 相互独立。\n\n考虑使用参数 $$\\lambda > 0$$ 的零阶 Tikhonov 正则化，它通过谱滤波因子 $$f_i(\\lambda) = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$$ 定义了滤波解。相应的残差范数和解的范数分别是 $$\\rho(\\lambda) = \\left\\|A x_{\\lambda} - b\\right\\|_2$$ 和 $$\\eta(\\lambda) = \\left\\|x_{\\lambda}\\right\\|_2.$$ L-曲线是当 $$\\lambda$$ 在对数网格上变化时绘制的参数曲线 $$\\left(\\log \\rho(\\lambda), \\log \\eta(\\lambda)\\right)$$。此处，L-曲线的拐角定义为当以 $$\\log \\lambda$$ 为参数时，该对数-对数平面中曲率最大的点。\n\n在此合成设定（其中真实系数是已知的）下，Picard 参数指标 $$k_{\\ast}$$ 定义为满足 $$\\sigma_i \\, |c_i| \\le \\delta$$ 的最小指标 $$i \\in \\{1,\\dots,n\\}$$。\n\n您的任务是编写一个完整、可运行的程序，该程序能够：\n- 如上所述，在 SVD 域中生成合成问题，不显式构造 $$U$$ 或 $$V$$，而是直接使用由 $$\\beta_i = \\sigma_i c_i + \\eta_i$$ 定义的 $$\\{\\sigma_i\\}$$ 和 $$\\{\\beta_i\\}$$。\n- 使用覆盖范围 $$\\left[\\sigma_n \\cdot 10^{-2}, \\sigma_1 \\cdot 10^{2}\\right]$$ 的对数间隔 $$\\lambda$$ 值网格计算 L-曲线。\n- 使用离散中心差分，将 L-曲线拐角 $$\\lambda_{\\text{corner}}$$ 估计为以 $$\\log \\lambda$$ 为参数时 $$\\left(\\log \\rho(\\lambda), \\log \\eta(\\lambda)\\right)$$ 的曲率最大值点。\n- 根据滤波因子计算拐角处的过渡指标 $$i_{\\text{trans}} = \\arg\\min_{i} \\left| f_i(\\lambda_{\\text{corner}}) - \\tfrac{1}{2} \\right|$$。\n- 使用 $$\\delta$$ 和已知的 $$\\{c_i\\}$$ 计算如上定义的 Picard 参数 $$k_{\\ast}$$。\n- 通过两个定量标准验证对齐性：\n  1. 通过 $$e_{\\lambda} = \\left|\\log_{10}\\left(\\frac{\\lambda_{\\text{corner}}}{\\sigma_{k_{\\ast}}}\\right)\\right|$$ 衡量 $$\\lambda_{\\text{corner}}$$ 与 $$\\sigma_{k_{\\ast}}$$ 的接近程度。\n  2. 通过 $$e_{\\text{idx}} = \\left|i_{\\text{trans}} - k_{\\ast}\\right|$$ 衡量 $$i_{\\text{trans}}$$ 与 $$k_{\\ast}$$ 的接近程度。\n- 对于每个测试用例，如果 $$e_{\\lambda} \\le 0.2$$ 和 $$e_{\\text{idx}} \\le 1$$ 同时成立，则返回 $$\\text{True}$$，否则返回 $$\\text{False}$$。\n\n使用以下测试套件，每个用例由 $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right)$$ 指定：\n- 用例 $$1$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(80,\\,0.12,\\,2.0,\\,10^{-4},\\,1\\right).$$\n- 用例 $$2$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(120,\\,0.08,\\,1.5,\\,5\\times 10^{-4},\\,2\\right).$$\n- 用例 $$3$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(100,\\,0.20,\\,3.0,\\,10^{-3},\\,3\\right).$$\n- 用例 $$4$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(100,\\,0.12,\\,2.5,\\,10^{-6},\\,4\\right).$$\n- 用例 $$5$$: $$\\left(n,\\alpha,p,\\delta,\\text{seed}\\right) = \\left(80,\\,0.12,\\,1.5,\\,5\\times 10^{-3},\\,5\\right).$$\n\n实现细节和要求：\n- 您必须使用 $$\\{\\sigma_i\\}$$、$$\\{\\beta_i\\}$$ 和 $$f_i(\\lambda)$$，根据谱公式计算 $$\\rho(\\lambda)$$ 和 $$\\eta(\\lambda)$$，而无需解线性系统。\n- 对于参数 $$t=\\log \\lambda$$，必须使用中心有限差分和平面内的标准曲率公式来计算 L-曲线的曲率。\n- 不使用角度，也不涉及任何物理单位。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$$[r_1,r_2,r_3,r_4,r_5]$$），其中每个 $$r_j$$ 是如上定义的测试用例 $$j$$ 的布尔值。", "solution": "所提出的问题是逆问题领域中一个有效且适定的数值练习。它涉及在 Tikhonov 正则化中应用和验证用于选择正则化参数的 L-曲线准则。该问题在科学上基于已建立的逆问题理论，内容自洽，并为获得唯一的、可验证的解提供了所有必要的定义和数据。我们将着手提供一个完整的解。\n\n问题的核心是分析一个线性逆问题 $$Ax = b$$，其中算子 $$A$$ 是病态的，意味着其奇异值 $$\\sigma_i$$ 快速衰减至零。这使得朴素解 $$x = A^{-1}b$$ 对数据 $$b$$ 中的噪声高度敏感。该问题完全在 $$A$$ 的谱域中建立，这避免了从奇异值分解 (SVD) $$A = U \\Sigma V^{\\top}$$ 构造矩阵 $$U$$ 和 $$V$$ 的需要，从而可以进行高效的模拟。\n\n奇异值由 $$\\sigma_i = \\exp(-\\alpha (i-1))$$ 给出，其中 $$i \\in \\{1, \\dots, n\\}$$ 且给定衰减率 $$\\alpha > 0$$。真实未知解 $$x_{\\text{true}}$$ 由其在右奇异向量基 $$\\{v_i\\}$$ 中的系数 $$c_i$$ 定义，$$x_{\\text{true}} = \\sum_{i=1}^n c_i v_i$$，其中 $$c_i = s_i \\, i^{-p}$$ 且 $$s_i \\in \\{-1, +1\\}$$。这些系数的衰减率 $$p$$ 表征了 $$x_{\\text{true}}$$ 的光滑度。数据 $$b$$ 由真实解生成，并受到标准差为 $$\\delta$$ 的加性 Gaussian 噪声 $$\\varepsilon$$ 的污染，$$b = A x_{\\text{true}} + \\varepsilon$$。该问题可以完全由数据在左奇异向量基 $$\\{u_i\\}$$ 中的系数 $$\\beta_i = u_i^{\\top}b$$ 来描述。根据线性和 SVD 的性质，这些系数由 $$\\beta_i = \\sigma_i c_i + \\eta_i$$ 给出，其中 $$\\eta_i = u_i^{\\top}\\varepsilon$$ 是服从正态分布 $$\\mathcal{N}(0, \\delta^2)$$ 的独立同分布随机变量。\n\n采用 Tikhonov 正则化来寻找一个稳定的近似解。对于给定的正则化参数 $$\\lambda > 0$$，零阶 Tikhonov 正则化解 $$x_{\\lambda}$$ 最小化泛函 $$\\|Ax - b\\|_2^2 + \\lambda^2 \\|x\\|_2^2$$。在 SVD 基中，该解表示为 $$x_{\\lambda} = \\sum_{i=1}^n f_i(\\lambda) \\frac{\\beta_i}{\\sigma_i} v_i$$。项 $$f_i(\\lambda)$$ 是谱滤波因子，由 $$f_i(\\lambda) = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$$ 给出。这些因子平滑地衰减了对应于小奇异值的解的分量，这些分量被噪声严重污染。\n\n正则化解的质量关键取决于 $$\\lambda$$ 的选择。L-曲线是为此目的常用的一种启发式方法。它是解范数的对数 $$\\zeta(\\lambda) = \\log \\|x_{\\lambda}\\|_2$$ 与残差范数的对数 $$\\xi(\\lambda) = \\log \\|A x_{\\lambda} - b\\|_2$$ 的参数图。这些范数可以在谱域中高效计算，而无需构成任何矩阵：\n解的范数由下式给出：\n$$ \\eta(\\lambda)^2 = \\|x_{\\lambda}\\|_2^2 = \\sum_{i=1}^n \\left( f_i(\\lambda) \\frac{\\beta_i}{\\sigma_i} \\right)^2 = \\sum_{i=1}^n \\left( \\frac{\\sigma_i \\beta_i}{\\sigma_i^2 + \\lambda^2} \\right)^2 $$\n残差范数由下式给出：\n$$ \\rho(\\lambda)^2 = \\|A x_{\\lambda} - b\\|_2^2 = \\sum_{i=1}^n \\left( (f_i(\\lambda) - 1)\\beta_i \\right)^2 = \\sum_{i=1}^n \\left( \\frac{-\\lambda^2 \\beta_i}{\\sigma_i^2 + \\lambda^2} \\right)^2 = \\sum_{i=1}^n \\left( \\frac{\\lambda^2 \\beta_i}{\\sigma_i^2 + \\lambda^2} \\right)^2 $$\n所得曲线通常呈 'L' 形。最优的 $$\\lambda$$ 被选择在此 L 形的“拐角”处，这代表了在最小化数据失配（残差）和控制解的大小以防止噪声放大之间的一种权衡。\n\n该问题将拐角定义为当 L-曲线以 $$t = \\log \\lambda$$ 为参数时曲率最大的点。对于一个参数曲线 $$(x(t), y(t))$$，其曲率 $$\\kappa(t)$$ 由下式给出：\n$$ \\kappa(t) = \\frac{|x'(t) y''(t) - y'(t) x''(t)|}{(x'(t)^2 + y'(t)^2)^{3/2}} $$\n此处，$$x(t)=\\xi(e^t)$$ 且 $$y(t)=\\zeta(e^t)$$。我们为从对数网格中选取的一组离散 $$\\lambda_j$$ 值计算 L-曲线，这对应于参数 $$t_j = \\log \\lambda_j$$ 的一个均匀网格。曲率公式所需的一阶和二阶导数使用中心有限差分进行近似。对于一个在步长为 $$h_t$$ 的均匀网格 $$t_j$$ 上的函数 $$g(t)$$，我们有：\n$$ g'(t_j) \\approx \\frac{g(t_{j+1}) - g(t_{j-1})}{2h_t}, \\quad g''(t_j) \\approx \\frac{g(t_{j+1}) - 2g(t_j) + g(t_{j-1})}{h_t^2} $$\n值 $$\\lambda_{\\text{corner}}$$ 是使计算出的离散曲率最大化的那个 $$\\lambda_j$$。\n\n这种启发式方法的有效性通过将结果与离散 Picard 条件进行比较来检验。该条件指出，为了恢复有意义的解，数据系数的信号部分 $$|\\sigma_i c_i|$$ 必须大于噪声水平 $$\\delta$$。Picard 参数指标 $$k_{\\ast}$$ 被定义为该条件被违反的最小指标 $$i$$，即 $$\\sigma_i |c_i| \\le \\delta$$。这个指标标志着信号主导的谱分量和噪声主导的谱分量之间的边界。一个好的正则化参数 $$\\lambda$$ 应该滤除指标 $$i > k_{\\ast}$$ 的分量，并保留指标 $$i \\le k_{\\ast}$$ 的分量。滤波函数 $$f_i(\\lambda)$$ 在 $$\\sigma_i \\approx \\lambda$$ 附近从 $$\\approx 1$$ 过渡到 $$\\approx 0$$。因此，一个最优的 $$\\lambda$$ 应该接近 $$\\sigma_{k_{\\ast}}$$。\n\n这个假设通过两个度量标准进行检验：\n1.  正则化参数的接近度：$$e_{\\lambda} = \\left|\\log_{10}\\left(\\frac{\\lambda_{\\text{corner}}}{\\sigma_{k_{\\ast}}}\\right)\\right|$$。这衡量了 $$\\lambda_{\\text{corner}}$$ 和 Picard 指标处的奇异值在数量级上的一致性。接受阈值为 $$e_{\\lambda} \\le 0.2$$。\n2.  过渡指标的接近度：$$e_{\\text{idx}} = \\left|i_{\\text{trans}} - k_{\\ast}\\right|$$。过渡指标 $$i_{\\text{trans}}$$ 定义为使滤波因子 $$f_i(\\lambda_{\\text{corner}})$$ 最接近 $$1/2$$ 的指标 $$i$$。这发生在 $$\\sigma_i \\approx \\lambda_{\\text{corner}}$$ 时，因此 $$i_{\\text{trans}}$$ 提供了由 L-曲线识别的有效秩的另一个估计。接受阈值为 $$e_{\\text{idx}} \\le 1$$。\n\n程序将为每个测试用例执行这整个过程，包括生成合成数据，计算 L-曲线及其拐角，找到 $$k_{\\ast}$$ 和 $$i_{\\text{trans}}$$，最后评估两个验证标准以返回一个布尔结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the L-curve validation problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # (n, alpha, p, delta, seed)\n        (80, 0.12, 2.0, 1e-4, 1),\n        (120, 0.08, 1.5, 5e-4, 2),\n        (100, 0.20, 3.0, 1e-3, 3),\n        (100, 0.12, 2.5, 1e-6, 4),\n        (80, 0.12, 1.5, 5e-3, 5),\n    ]\n\n    results = []\n    num_lambda_points = 400\n\n    for n, alpha, p, delta, seed in test_cases:\n        # Step 1: Generate the synthetic problem data in the SVD domain\n        np.random.seed(seed)\n        i = np.arange(1, n + 1)\n        \n        # Singular values\n        sigma = np.exp(-alpha * (i - 1))\n        \n        # True solution coefficients\n        s = np.random.choice([-1, 1], size=n)\n        c = s * (i**(-p))\n        \n        # Noisy data coefficients\n        eta = np.random.normal(0, delta, size=n)\n        beta = sigma * c + eta\n\n        # Step 2: Compute the L-curve\n        # Define a logarithmic grid for lambda\n        lambda_min = sigma[-1] * 1e-2\n        lambda_max = sigma[0] * 1e2\n        lambda_vals = np.logspace(np.log10(lambda_min), np.log10(lambda_max), num_lambda_points)\n\n        log_rho_vals = np.zeros(num_lambda_points)\n        log_eta_vals = np.zeros(num_lambda_points)\n\n        for j, lam in enumerate(lambda_vals):\n            lam_sq = lam**2\n            sigma_sq = sigma**2\n            \n            # Filter factors\n            f = sigma_sq / (sigma_sq + lam_sq)\n            \n            # Residual norm (squared)\n            rho_sq = np.sum(((f - 1) * beta)**2)\n            \n            # Solution norm (squared)\n            eta_sq = np.sum((f * beta / sigma)**2)\n            \n            log_rho_vals[j] = 0.5 * np.log(rho_sq)\n            log_eta_vals[j] = 0.5 * np.log(eta_sq)\n\n        # Step 3: Estimate the L-curve corner by maximizing curvature\n        # Parametrization is t = log(lambda), which is uniform\n        t_vals = np.log(lambda_vals)\n        h_t = t_vals[1] - t_vals[0]\n        \n        # Use central differences for derivatives on interior points\n        x = log_rho_vals\n        y = log_eta_vals\n\n        dx_dt = (x[2:] - x[:-2]) / (2 * h_t)\n        dy_dt = (y[2:] - y[:-2]) / (2 * h_t)\n        \n        d2x_dt2 = (x[2:] - 2 * x[1:-1] + x[:-2]) / (h_t**2)\n        d2y_dt2 = (y[2:] - 2 * y[1:-1] + y[:-2]) / (h_t**2)\n\n        # Curvature formula\n        numerator = np.abs(dx_dt * d2y_dt2 - dy_dt * d2x_dt2)\n        denominator = (dx_dt**2 + dy_dt**2)**1.5\n        \n        # Avoid division by zero, although not expected for a standard L-curve\n        # Set curvature to 0 where denominator is close to zero\n        kappa = np.zeros_like(numerator)\n        valid_indices = denominator > 1e-16\n        kappa[valid_indices] = numerator[valid_indices] / denominator[valid_indices]\n        \n        # Find lambda corresponding to max curvature\n        # The curvature is computed on interior points (index 1 to N-2)\n        # So the max index must be offset by 1\n        corner_idx_in_kappa = np.argmax(kappa)\n        corner_idx = corner_idx_in_kappa + 1\n        lambda_corner = lambda_vals[corner_idx]\n\n        # Step 4: Compute the transition index\n        f_corner = sigma**2 / (sigma**2 + lambda_corner**2)\n        i_trans = np.argmin(np.abs(f_corner - 0.5)) + 1 # 1-based index\n\n        # Step 5: Compute the Picard parameter index k_star\n        signal_strength = sigma * np.abs(c)\n        # Find first index i where signal is = noise level.\n        # np.where returns a tuple of arrays; we want the first element of the first array.\n        k_star_candidates = np.where(signal_strength = delta)[0]\n        # In case the condition is never met for the given n, which is unlikely\n        if len(k_star_candidates) == 0:\n            k_star = n\n        else:\n            k_star = k_star_candidates[0] + 1 # 1-based index\n        \n        # Step 6: Validate the alignment with the two criteria\n        sigma_k_star = sigma[k_star - 1]\n        e_lambda = np.abs(np.log10(lambda_corner / sigma_k_star))\n        e_idx = np.abs(i_trans - k_star)\n\n        # Final boolean check\n        is_aligned = (e_lambda = 0.2) and (e_idx = 1)\n        results.append(is_aligned)\n\n    # Format the final output string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3394295"}]}