{"hands_on_practices": [{"introduction": "全局不稳定性分析的核心在于将控制方程转化为一个可以求解的矩阵特征值问题。本练习以经典的 Ginzburg-Landau 方程为例，指导你完成这一基本步骤 [@problem_id:3323898]。通过实践，你将学会如何为对流-扩散系统选择合适的物理边界条件，并应用谱方法进行数值离散化，这是确保分析准确性的关键。", "problem": "考虑线性复金兹堡-朗道方程，这是一个用于缓变对流-扩散系统中全局不稳定性的典型模型：在有限区间 $x \\in [0,L]$ 上，$\\partial_t q = \\mu(x) q + U \\,\\partial_x q + D \\,\\partial_{xx} q$。其中，$q(x,t) \\in \\mathbb{C}$ 是复振幅，$\\mu(x) \\in \\mathbb{C}$ 是一个给定的空间变化系数，$U \\in \\mathbb{R}$ 是一个恒定的平流速度，$D \\in \\mathbb{C}$ 是一个恒定的复扩散系数，且 $\\mathrm{Re}(D) > 0$ 以确保抛物适定性。假设 $U > 0$，因此 $x=0$ 是上游（流入）边界，$x=L$ 是下游（流出）边界。在全局不稳定性分析中，我们通过构建控制方程右侧算子的线性特征值问题，来寻求全局模态的时间增长率和空间结构。\n\n哪个选项正确地在 $[0,L]$ 上建立了全局特征值问题，为该二阶空间算子指定了物理上合适的流入/流出边界条件，并概述了一个使用切比雪夫多项式的科学合理的谱配置求解策略，包括正确的域映射和微分缩放？\n\nA. 使用时间法向模态假设 $q(x,t) = \\hat{q}(x)\\, \\exp(\\lambda t)$，得到在 $x \\in [0,L]$ 上的特征值问题 $\\lambda \\,\\hat{q}(x) = \\mu(x)\\,\\hat{q}(x) + U\\,\\partial_x \\hat{q}(x) + D\\,\\partial_{xx} \\hat{q}(x)$，其中上游流入边界条件为 $\\hat{q}(0) = 0$，下游流出边界条件为 $\\partial_x \\hat{q}(L) = 0$（一个用于对流流出的齐次辐射型条件）。通过将 $x = \\frac{L}{2}(1+\\xi)$ 从 $\\xi \\in [-1,1]$ 进行映射，在切比雪夫-高斯-洛巴托（CGL）点上通过谱配置法离散化 $\\hat{q}(x)$，因此 $\\partial_x = \\frac{2}{L}\\,\\partial_\\xi$ 且 $\\partial_{xx} = \\left(\\frac{2}{L}\\right)^2 \\partial_{\\xi\\xi}$。构建离散算子 $\\mathbf{L} = \\mathrm{diag}(\\mu(x_j)) + U\\,\\frac{2}{L}\\,\\mathbf{D}_\\xi + D\\,\\left(\\frac{2}{L}\\right)^2 \\mathbf{D}_\\xi^{(2)}$，通过替换相应的行来施加两个边界条件以强制 $\\hat{q}(0)=0$ 和 $\\partial_x \\hat{q}(L)=0$，并求解标准特征值问题 $\\mathbf{L}\\,\\hat{\\mathbf{q}} = \\lambda\\,\\hat{\\mathbf{q}}$ 以得到 $\\lambda \\in \\mathbb{C}$ 和全局模态 $\\hat{\\mathbf{q}}$。\n\nB. 施加周期性边界条件 $\\hat{q}(0) = \\hat{q}(L)$ 和 $\\partial_x \\hat{q}(0) = \\partial_x \\hat{q}(L)$ 来模拟一个无边界的域，并使用傅里叶谱方法在均匀网格上进行离散化。构建一个广义特征值问题 $\\mathbf{M}\\,\\lambda\\,\\hat{\\mathbf{q}} = \\mathbf{L}\\,\\hat{\\mathbf{q}}$，其中质量矩阵 $\\mathbf{M}$ 从梯形法则求积权重中获得，然后计算 $\\lambda$ 和 $\\hat{\\mathbf{q}}$。\n\nC. 使用时间法向模态假设推导出 $\\lambda \\,\\hat{q}(x) = \\mu(x)\\,\\hat{q}(x) + U\\,\\partial_x \\hat{q}(x) + D\\,\\partial_{xx} \\hat{q}(x)$，在流入处施加两个边界条件：$\\hat{q}(0) = 0$ 和 $\\partial_x \\hat{q}(0) = 0$（因为流入需要严格控制），使流出不受约束，并使用切比雪夫-高斯-洛巴托点在 $\\xi \\in [-1,1]$ 上进行离散化，直接在 $x \\in [0,L]$ 上使用未缩放的微分矩阵 $\\mathbf{D}_\\xi$ 和 $\\mathbf{D}_\\xi^{(2)}$，而没有进行映射或导数重缩放。求解 $\\mathbf{L}\\,\\hat{\\mathbf{q}} = \\lambda\\,\\hat{\\mathbf{q}}$。\n\nD. 在两端设置齐次狄利克雷边界条件 $\\hat{q}(0) = 0$ 和 $\\hat{q}(L) = 0$ 以避免数值反射，并使用直接在 $[0,L]$ 上构建的切比雪夫多项式进行离散化，方法是在物理节点 $x_j = L\\,\\cos(\\pi j/N)$（其中 $j \\in \\{0,\\dots, N\\}$）上评估切比雪夫微分矩阵，构建一个广义特征值问题 $\\mathbf{M}\\,\\lambda\\,\\hat{\\mathbf{q}} = \\mathbf{L}\\,\\hat{\\mathbf{q}}$ 以考虑非均匀网格间距。然后计算主导特征值以诊断全局不稳定性。", "solution": "用户希望我扮演一位严谨的STEM教授，分析一个计算流体动力学问题。\n\n### 第一步：提取已知条件\n\n-   **控制方程**：线性复金兹堡-朗道（CGL）方程：$\\partial_t q = \\mu(x) q + U \\,\\partial_x q + D \\,\\partial_{xx} q$。\n-   **域**：有限区间 $x \\in [0,L]$。\n-   **因变量**：$q(x,t) \\in \\mathbb{C}$，复振幅。\n-   **系数和常数**：\n    -   $\\mu(x) \\in \\mathbb{C}$：一个给定的空间变化系数。\n    -   $U \\in \\mathbb{R}$：一个恒定的平流速度，且 $U > 0$。\n    -   $D \\in \\mathbb{C}$：一个恒定的复扩散系数。\n-   **条件**：\n    -   $\\mathrm{Re}(D) > 0$：确保方程是抛物线型且适定的。\n    -   $x=0$ 是上游（流入）边界。\n    -   $x=L$ 是下游（流出）边界。\n-   **任务**：确定全局特征值问题的正确设置，包括物理上合适的边界条件和合理的谱配置求解策略。\n\n### 第二步：使用提取的已知条件进行验证\n\n根据验证标准评估问题陈述。\n\n-   **科学依据**：线性复金兹堡-朗道方程是物理学和流体动力学中的一个典型模型，广泛用于研究模式形成和向湍流的过渡。其在全局不稳定性分析中的应用是计算流体动力学中一个标准且成熟的课题。条件 $\\mathrm{Re}(D) > 0$ 保证了适定性。整个设置在科学上是合理的。\n-   **适定性**：问题要求确定建立一个适定的特征值问题的正确程序。问题陈述本身定义清晰，结构明确，旨在根据物理学和数值分析的既定原则，在选项中找到唯一的正确答案。\n-   **客观性**：问题使用了精确、无歧义的技术语言陈述。没有主观或基于意见的元素。\n\n该问题没有表现出任何列出的缺陷（例如，科学上不合理、不完整、含糊不清）。它是偏微分方程数值分析领域的一个标准的、适定的问题。\n\n### 第三步：结论与行动\n\n问题陈述是**有效的**。我将继续推导解决方案并评估各个选项。\n\n### 解的推导\n\n目标是找到全局模态，这些解在时间上呈指数增长或衰减，同时保持固定的空间结构。\n\n1.  **特征值问题的构建**：\n    我们从控制偏微分方程（PDE）开始：\n    $$\n    \\partial_t q = \\mu(x) q + U \\,\\partial_x q + D \\,\\partial_{xx} q\n    $$\n    我们寻找形式为 $q(x,t) = \\hat{q}(x) e^{\\lambda t}$ 的解，这被称为时间法向模态假设。在这里，$\\lambda \\in \\mathbb{C}$ 是复时间特征值，$\\hat{q}(x)$ 是相应的空间特征函数，或称为全局模态。特征值的实部 $\\mathrm{Re}(\\lambda)$ 决定了模态的时间增长率。正的 $\\mathrm{Re}(\\lambda)$ 表示一个线性不稳定的全局模态。\n    将该假设代入PDE，我们得到：\n    $$\n    \\lambda \\hat{q}(x) e^{\\lambda t} = \\mu(x) \\hat{q}(x) e^{\\lambda t} + U \\,\\partial_x \\hat{q}(x) e^{\\lambda t} + D \\,\\partial_{xx} \\hat{q}(x) e^{\\lambda t}\n    $$\n    两边同除以非零项 $e^{\\lambda t}$，得到线性常微分特征值问题：\n    $$\n    \\lambda \\hat{q}(x) = \\left( \\mu(x) + U \\partial_x + D \\partial_{xx} \\right) \\hat{q}(x)\n    $$\n    这可以简写为 $\\mathcal{L}\\hat{q} = \\lambda\\hat{q}$，其中 $\\mathcal{L} = \\mu(x) + U \\partial_x + D \\partial_{xx}$ 是线性算子。\n\n2.  **边界条件 (BCs)**：\n    算子 $\\mathcal{L}$ 在空间上是二阶的，需要在域 $x \\in [0,L]$ 上施加两个边界条件。边界条件的选择至关重要，必须反映开放流系统的物理特性。\n    -   **流入 ($x=0$)**：由于 $U > 0$，流动是从左到右。为了模拟一个不稳定性在内部产生（绝对/全局不稳定性）而不是从上游传入的系统，标准做法是施加一个齐次狄利克雷边界条件。这可以防止任何扰动进入域内。\n        $$\n        \\hat{q}(0) = 0\n        $$\n    -   **流出 ($x=L$)**：流出边界的边界条件应允许扰动以最小的非物理反射离开域。一个完美的无反射边界条件可能很难推导。一个常见且有效的近似，特别是在流出边界足够远的情况下，是齐次诺伊曼（零梯度）条件。这个“软”边界条件可以防止扰动振幅在边界处的人为“堆积”。\n        $$\n        \\partial_x \\hat{q}(L) = 0\n        $$\n    这组边界条件，即流入处的狄利克雷条件和流出处的诺伊曼条件，是对流-扩散系统的标准且物理上合理的选择。\n\n3.  **数值解法：谱配置**：\n    谱配置法是离散化该特征值问题的一种精确方法。切比雪夫多项式基是处理非周期性问题的理想选择。\n    -   **域映射**：切比雪夫方法定义在一个规范域上，通常是 $\\xi \\in [-1,1]$。物理域 $x \\in [0,L]$ 必须映射到这个计算域。唯一的仿射映射是：\n        $$\n        x(\\xi) = \\frac{L}{2}(1+\\xi)\n        $$\n    -   **导数缩放**：我们使用链式法则来转换空间导数：\n        $$\n        \\frac{d}{dx} = \\frac{d\\xi}{dx} \\frac{d}{d\\xi} = \\frac{2}{L} \\frac{d}{d\\xi} \\implies \\partial_x = \\frac{2}{L} \\partial_\\xi\n        $$\n        $$\n        \\frac{d^2}{dx^2} = \\left(\\frac{2}{L}\\right)^2 \\frac{d^2}{d\\xi^2} \\implies \\partial_{xx} = \\left(\\frac{2}{L}\\right)^2 \\partial_{\\xi\\xi}\n        $$\n    -   **离散化**：函数 $\\hat{q}(x)$ 由其在一组配置点上的值 $\\hat{\\mathbf{q}}$ 来表示。切比雪夫-高斯-洛巴托（CGL）点，$\\xi_j = \\cos(\\pi j/N)$（其中 $j=0, \\dots, N$），是一个标准选择，因为它们包括了边界点 $\\xi_0 = 1$（映射到 $x_0=L$）和 $\\xi_N = -1$（映射到 $x_N=0$）。导数 $\\partial_\\xi$ 和 $\\partial_{\\xi\\xi}$ 通过与切比雪夫微分矩阵 $\\mathbf{D}_\\xi$ 和 $\\mathbf{D}_\\xi^{(2)}$ 的矩阵-向量乘法来近似。\n    -   **矩阵特征值问题**：连续算子 $\\mathcal{L}$ 被离散化为一个矩阵 $\\mathbf{L}$：\n        $$\n        \\mathbf{L} = \\mathrm{diag}(\\mu(x_j)) + U \\left(\\frac{2}{L}\\mathbf{D}_\\xi\\right) + D \\left(\\left(\\frac{2}{L}\\right)^2 \\mathbf{D}_\\xi^{(2)}\\right)\n        $$\n    特征值问题变成一个标准的矩阵特征值问题 $\\mathbf{L}\\hat{\\mathbf{q}} = \\lambda \\hat{\\mathbf{q}}$。\n    -   **边界条件的施加**：通过修改矩阵系统来施加边界条件。对于配置法，这通常是通过用边界条件的离散形式替换矩阵方程中对应于边界点的行来完成的。例如，修改对应于 $x_N=0$ 的行以强制 $\\hat{q}_N=0$，并修改对应于 $x_0=L$ 的行以强制 $\\partial_x \\hat{q}(L) = 0$ 的离散形式，这是 $\\hat{\\mathbf{q}}$ 元素的一个线性组合。这样就产生了一个适定的代数特征值问题，可以进行数值求解。\n\n### 逐项分析\n\n**A. 使用时间法向模态假设 $q(x,t) = \\hat{q}(x)\\, \\exp(\\lambda t)$，得到在 $x \\in [0,L]$ 上的特征值问题 $\\lambda \\,\\hat{q}(x) = \\mu(x)\\,\\hat{q}(x) + U\\,\\partial_x \\hat{q}(x) + D\\,\\partial_{xx} \\hat{q}(x)$，其中上游流入边界条件为 $\\hat{q}(0) = 0$，下游流出边界条件为 $\\partial_x \\hat{q}(L) = 0$（一个用于对流流出的齐次辐射型条件）。通过将 $x = \\frac{L}{2}(1+\\xi)$ 从 $\\xi \\in [-1,1]$ 进行映射，在切比雪夫-高斯-洛巴托（CGL）点上通过谱配置法离散化 $\\hat{q}(x)$，因此 $\\partial_x = \\frac{2}{L}\\,\\partial_\\xi$ 且 $\\partial_{xx} = \\left(\\frac{2}{L}\\right)^2 \\partial_{\\xi\\xi}$。构建离散算子 $\\mathbf{L} = \\mathrm{diag}(\\mu(x_j)) + U\\,\\frac{2}{L}\\,\\mathbf{D}_\\xi + D\\,\\left(\\frac{2}{L}\\right)^2 \\mathbf{D}_\\xi^{(2)}$，通过替换相应的行来施加两个边界条件以强制 $\\hat{q}(0)=0$ 和 $\\partial_x \\hat{q}(L)=0$，并求解标准特征值问题 $\\mathbf{L}\\,\\hat{\\mathbf{q}} = \\lambda\\,\\hat{\\mathbf{q}}$ 以得到 $\\lambda \\in \\mathbb{C}$ 和全局模态 $\\hat{\\mathbf{q}}$。**\n\n该选项严谨地遵循了上述推导的标准、科学合理的过程。特征值问题是正确的。边界条件对于开放流系统是物理上合适的。谱配置方法，包括域映射、导数缩放、CGL点的选择以及矩阵构建，都描述得正确。边界条件的施加和最终构建为标准特征值问题的过程也是正确的。将 $\\partial_x \\hat{q}(L) = 0$ 称为“辐射型”条件在这种情况下是可以接受的，因为它是出射波的一个简单近似。\n**结论：正确**\n\n**B. 施加周期性边界条件 $\\hat{q}(0) = \\hat{q}(L)$ 和 $\\partial_x \\hat{q}(0) = \\partial_x \\hat{q}(L)$ 来模拟一个无边界的域，并使用傅里叶谱方法在均匀网格上进行离散化。构建一个广义特征值问题 $\\mathbf{M}\\,\\lambda\\,\\hat{\\mathbf{q}} = \\mathbf{L}\\,\\hat{\\mathbf{q}}$，其中质量矩阵 $\\mathbf{M}$ 从梯形法则求积权重中获得，然后计算 $\\lambda$ 和 $\\hat{\\mathbf{q}}$。**\n\n这个选项根本上是错误的。周期性边界条件模拟的是一个闭环系统，其中 $x=L$ 处的流出立即成为 $x=0$ 处的流入。这对于所描述的流入-流出问题在物理上是不正确的。因此，使用为周期性问题设计的傅里叶谱方法是不合适的。\n**结论：错误**\n\n**C. 使用时间法向模态假设推导出 $\\lambda \\,\\hat{q}(x) = \\mu(x)\\,\\hat{q}(x) + U\\,\\partial_x \\hat{q}(x) + D\\,\\partial_{xx} \\hat{q}(x)$，在流入处施加两个边界条件：$\\hat{q}(0) = 0$ 和 $\\partial_x \\hat{q}(0) = 0$（因为流入需要严格控制），使流出不受约束，并使用切比雪夫-高斯-洛巴托点在 $\\xi \\in [-1,1]$ 上进行离散化，直接在 $x \\in [0,L]$ 上使用未缩放的微分矩阵 $\\mathbf{D}_\\xi$ 和 $\\mathbf{D}_\\xi^{(2)}$，而没有进行映射或导数重缩放。求解 $\\mathbf{L}\\,\\hat{\\mathbf{q}} = \\lambda\\,\\hat{\\mathbf{q}}$。**\n\n这个选项包含两个关键错误。首先，对于一个二阶常微分方程，在一端（$x=0$）施加两个边界条件，而在另一端（$x=L$）不施加任何条件，会使边值问题变得不适定。其次，将为区间 $[-1,1]$ 定义的切比雪夫微分矩阵直接应用于不同的区间 $[0,L]$，而不进行适当的映射和导数缩放，在数学上是错误的，并将产生无意义的结果。\n**结论：错误**\n\n**D. 在两端设置齐次狄利克雷边界条件 $\\hat{q}(0) = 0$ 和 $\\hat{q}(L) = 0$ 以避免数值反射，并使用直接在 $[0,L]$ 上构建的切比雪夫多项式进行离散化，方法是在物理节点 $x_j = L\\,\\cos(\\pi j/N)$（其中 $j \\in \\{0,\\dots, N\\}$）上评估切比雪夫微分矩阵，构建一个广义特征值问题 $\\mathbf{M}\\,\\lambda\\,\\hat{\\mathbf{q}} = \\mathbf{L}\\,\\hat{\\mathbf{q}}$ 以考虑非均匀网格间距。然后计算主导特征值以诊断全局不稳定性。**\n\n这个选项有几个缺陷。首先，流出条件 $\\hat{q}(L)=0$ 是一个“硬”壁面条件，已知在对流系统中会导致显著的非物理反射，这与所述的避免反射的目标相悖。诺伊曼或罗宾条件通常更优越。其次，对网格点的描述是错误的：$x_j = L\\,\\cos(\\pi j/N)$ 描述的是在 $[-L, L]$ 区间内的点，而不是 $[0,L]$。到 $[0,L]$ 上CGL点的正确映射是 $x_j = \\frac{L}{2}(1+\\cos(\\pi j/N))$。第三，对于广义特征值问题（GEP）的理由是不正确的。GEP通常产生于伽辽金或有限元格式，而不是为了在配置格式中“考虑非均匀网格间距”，后者自然地导出一个标准特征值问题。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "3323898"}, {"introduction": "全局稳定性分析的最终目标通常是理解流动行为如何随雷诺数或马赫数等关键参数而变化。本练习提供了一个动手编程的机会，你将通过一个降阶模型（ROM）进行参数连续性研究 [@problem_id:3323974]。通过追踪特征值、识别模态转换和定位不同失稳机制相互作用的临界点，你将亲身体验流动失稳分析在揭示复杂物理现象中的威力。", "problem": "考虑一个通过围绕定常基态的线性化可压缩Navier–Stokes方程建模的可压缩腔体流的全局不稳定性。主导全局模态被定义为线性算子的特征对 $\\{\\lambda,\\mathbf{q}\\}$，满足 $\\mathcal{L}(\\mathrm{Re},\\mathrm{Ma},\\mathrm{Pr})\\,\\mathbf{q}=\\lambda\\,\\mathbf{q}$，其中 $\\mathrm{Re}$ 是雷诺数，$\\mathrm{Ma}$ 是马赫数，$\\mathrm{Pr}$ 是普朗特数。为关注剪切层不稳定性与声学共振之间的相互作用，使用一个双自由度的降阶模型（ROM）。在该模型中，解耦的剪切层模态和声学模态具有复特征值 $\\lambda_s^0=\\alpha_s+i\\,\\omega_s$ 和 $\\lambda_a^0=\\alpha_a+i\\,\\omega_a$。耦合的全局算子是一个 $2\\times 2$ 的复矩阵\n$$\n\\mathbf{L}(\\mathrm{Re},\\mathrm{Ma},\\mathrm{Pr},s)=\n\\begin{bmatrix}\n\\lambda_s^0  \\kappa \\\\\n\\kappa  \\lambda_a^0\n\\end{bmatrix},\n$$\n其中 $s\\in[0,1]$ 是一个无量纲耦合尺度参数，用于模拟腔体的声学反射率。设解耦的增长率和角频率由围绕基准点 $(\\mathrm{Re}_0,\\mathrm{Ma}_0,\\mathrm{Pr}_0)$ 的以下无量纲校准定义：\n$$\n\\alpha_s(\\mathrm{Re},\\mathrm{Pr})=\\alpha_{s0}+\\alpha_{s1}\\,\\frac{\\mathrm{Re}-\\mathrm{Re}_0}{\\mathrm{Re}_0}-\\alpha_{s2}\\,(\\mathrm{Pr}-\\mathrm{Pr}_0),\n\\quad\n\\omega_s(\\mathrm{Re})=\\omega_{s0}+\\omega_{s1}\\,\\sqrt{\\mathrm{Re}},\n$$\n$$\n\\alpha_a(\\mathrm{Ma},\\mathrm{Pr})=\\alpha_{a0}+\\alpha_{a1}\\,(\\mathrm{Ma}-\\mathrm{Ma}_0)-\\alpha_{a2}\\,(\\mathrm{Pr}-\\mathrm{Pr}_0),\n\\quad\n\\omega_a(\\mathrm{Ma})=\\omega_{a0}+\\omega_{a1}\\,\\mathrm{Ma},\n$$\n并设流体动力-声学耦合为\n$$\n\\kappa(\\mathrm{Re},\\mathrm{Ma},s)=s\\left(\\kappa_1\\,\\mathrm{Ma}+\\kappa_2\\,\\sqrt{\\mathrm{Re}}\\right).\n$$\n使用以下物理上合理的无量纲常数\n$$\n\\mathrm{Re}_0=600,\\quad \\mathrm{Ma}_0=0.6,\\quad \\mathrm{Pr}_0=0.72,\n$$\n$$\n\\alpha_{s0}=-0.05,\\quad \\alpha_{s1}=0.12,\\quad \\alpha_{s2}=0.02,\n\\quad\n\\omega_{s0}=0.7,\\quad \\omega_{s1}=0.03,\n$$\n$$\n\\alpha_{a0}=-0.08,\\quad \\alpha_{a1}=0.15,\\quad \\alpha_{a2}=0.01,\n\\quad\n\\omega_{a0}=0.4,\\quad \\omega_{a1}=1.2,\n$$\n$$\n\\kappa_1=0.02,\\quad \\kappa_2=0.005.\n$$\n所有量均为无量纲。主导全局特征值 $\\lambda_{\\max}$ 是 $\\mathbf{L}$ 的具有最大实部的特征值。在给定的参数点，通过其特征向量 $\\mathbf{v}_{\\max}$ 对主导模态进行分类：如果第一个分量的绝对值大于或等于第二个分量的绝对值，则标记为剪切层模态（整数 $0$）；否则，标记为声学模态（整数 $1$）。\n\n您的程序必须实现参数延拓，即沿参数路径评估 $\\lambda_{\\max}$ 并跟踪模态分类。此外，对于固定的 $\\mathrm{Pr}$，估计剪切层分支和声学分支之间的余维-2交叉点，该交叉点是\n$$\n\\alpha_s(\\mathrm{Re},\\mathrm{Pr})=\\alpha_a(\\mathrm{Ma},\\mathrm{Pr}),\n\\qquad\n\\omega_s(\\mathrm{Re})=\\omega_a(\\mathrm{Ma}),\n$$\n的联立解，标记了等增长率和等频率流形的交点。\n\n实现以下测试套件并计算所要求的结果。除非另有说明，每个测试都使用上述常数和 $\\mathrm{Pr}=\\mathrm{Pr}_0$：\n\n- 测试1（$\\mathrm{Re}$ 的延拓）：在 $\\mathrm{Ma}=0.6$，$s=1.0$ 的条件下，使 $\\mathrm{Re}$ 在 $300$ 到 $900$ 之间以 $121$ 个步长均匀变化，计算并返回沿路径遇到的主导特征值 $\\lambda_{\\max}$ 的最大实部（一个浮点数）。\n\n- 测试2（$\\mathrm{Ma}$ 中的分类切换）：在 $\\mathrm{Re}=600$，$s=1.0$ 的条件下，使 $\\mathrm{Ma}$ 在 $0.2$ 到 $1.2$ 之间以 $101$ 个步长均匀变化，找到并返回主导模态分类在剪切层模态（$0$）和声学模态（$1$）之间发生切换的最小 $\\mathrm{Ma}$ 值，使用 $\\mathrm{Ma}=0.2$ 时的分类作为参考（一个浮点数）。如果没有发生切换，则返回 $\\mathrm{NaN}$。\n\n- 测试3（沿 $(\\mathrm{Re},\\mathrm{Ma})$ 路径到余维-2交叉点的距离）：在 $s=1.0$ 的条件下，对于在 $101$ 个均匀间隔值上采样的参数路径 $\\mathrm{Re}(t)=650+50\\,t$，$\\mathrm{Ma}(t)=0.85+0.1\\,t$ ($t\\in[0,1]$)，计算沿路径遇到的\n$$\nD(t)=\\sqrt{\\left[\\alpha_s(\\mathrm{Re}(t),\\mathrm{Pr}_0)-\\alpha_a(\\mathrm{Ma}(t),\\mathrm{Pr}_0)\\right]^2+\\left[\\omega_s(\\mathrm{Re}(t))-\\omega_a(\\mathrm{Ma}(t))\\right]^2}\n$$\n的最小值（一个浮点数）。\n\n- 测试4（域内解耦余维-2交叉点的存在性）：在 $s=0.0$（解耦极限）和 $\\mathrm{Pr}=\\mathrm{Pr}_0$ 的条件下，求解方程组\n$$\n\\alpha_s(\\mathrm{Re},\\mathrm{Pr}_0)=\\alpha_a(\\mathrm{Ma},\\mathrm{Pr}_0),\\qquad \\omega_s(\\mathrm{Re})=\\omega_a(\\mathrm{Ma}),\n$$\n得到 $(\\mathrm{Re}^\\star,\\mathrm{Ma}^\\star)$，并返回一个布尔值，指示解是否存在于域 $\\mathrm{Re}\\in[500,800]$ 和 $\\mathrm{Ma}\\in[0.5,1.0]$ 内。通过第一个方程消去 $\\mathrm{Re}$，然后对第二个方程求解 $\\mathrm{Ma}$，使用稳健的一维求根方法；如果不存在解，则返回 false。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试1到4的顺序排列结果，例如 $[r_1,r_2,r_3,r_4]$。所有输出必须是无量纲浮点数或布尔值，与上述规定完全一致。", "solution": "该问题是有效的，因为它在流体动力学领域（特别是全局不稳定性分析）具有科学依据，并提出了一组适定、客观且可通过计算验证的任务。该模型虽然经过简化，却是复杂流动中模态相互作用的标准降阶表示。所有参数、常数和函数都已明确定义，从而可以直接、无歧义地实现。\n\n解决方案首先实现控制物理模型，然后系统地处理四个测试用例中的每一个。\n\n### 1. 模型构建\n\n问题的核心是分析一个 $2 \\times 2$ 的复矩阵 $\\mathbf{L}$，它作为一个降阶模型（ROM），用于描述可压缩腔体流中剪切层模态和声学模态之间的相互作用。该矩阵由下式给出：\n$$\n\\mathbf{L}(\\mathrm{Re},\\mathrm{Ma},\\mathrm{Pr},s)=\n\\begin{bmatrix}\n\\lambda_s^0  \\kappa \\\\\n\\kappa  \\lambda_a^0\n\\end{bmatrix}\n$$\n对角线元素 $\\lambda_s^0 = \\alpha_s + i\\,\\omega_s$ 和 $\\lambda_a^0 = \\alpha_a + i\\,\\omega_a$ 分别代表解耦的剪切层模态和声学模态的复特征值。非对角线元素 $\\kappa$ 代表它们之间的耦合强度。它们对物理参数（雷诺数 $\\mathrm{Re}$、马赫数 $\\mathrm{Ma}$、普朗特数 $\\mathrm{Pr}$ 和耦合尺度 $s$）的依赖关系由一组线性和简单的非线性校准函数定义。\n\n提供的常数如下：\n- 基态：$\\mathrm{Re}_0=600$，$\\mathrm{Ma}_0=0.6$，$\\mathrm{Pr}_0=0.72$。\n- 剪切层系数：$\\alpha_{s0}=-0.05$，$\\alpha_{s1}=0.12$，$\\alpha_{s2}=0.02$，$\\omega_{s0}=0.7$，$\\omega_{s1}=0.03$。\n- 声学系数：$\\alpha_{a0}=-0.08$，$\\alpha_{a1}=0.15$，$\\alpha_{a2}=0.01$，$\\omega_{a0}=0.4$，$\\omega_{a1}=1.2$。\n- 耦合系数：$\\kappa_1=0.02$，$\\kappa_2=0.005$。\n\n所有测试均在固定的普朗特数 $\\mathrm{Pr}=\\mathrm{Pr}_0=0.72$ 下进行。这简化了增长率 $\\alpha_s$ 和 $\\alpha_a$ 的表达式，因为 $(\\mathrm{Pr}-\\mathrm{Pr}_0)$ 项始终为零。工作方程如下：\n$$\n\\alpha_s(\\mathrm{Re}) = \\alpha_{s0}+\\alpha_{s1}\\,\\frac{\\mathrm{Re}-\\mathrm{Re}_0}{\\mathrm{Re}_0} = -0.05+0.12\\,\\frac{\\mathrm{Re}-600}{600}\n$$\n$$\n\\omega_s(\\mathrm{Re}) = \\omega_{s0}+\\omega_{s1}\\,\\sqrt{\\mathrm{Re}} = 0.7+0.03\\,\\sqrt{\\mathrm{Re}}\n$$\n$$\n\\alpha_a(\\mathrm{Ma}) = \\alpha_{a0}+\\alpha_{a1}\\,(\\mathrm{Ma}-\\mathrm{Ma}_0) = -0.08+0.15\\,(\\mathrm{Ma}-0.6)\n$$\n$$\n\\omega_a(\\mathrm{Ma}) = \\omega_{a0}+\\omega_{a1}\\,\\mathrm{Ma} = 0.4+1.2\\,\\mathrm{Ma}\n$$\n$$\n\\kappa(\\mathrm{Re},\\mathrm{Ma},s) = s\\left(\\kappa_1\\,\\mathrm{Ma}+\\kappa_2\\,\\sqrt{\\mathrm{Re}}\\right) = s\\left(0.02\\,\\mathrm{Ma}+0.005\\,\\sqrt{\\mathrm{Re}}\\right)\n$$\n\n### 2. 特征值问题与模态分类\n\n矩阵 $\\mathbf{L}$ 的特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{L} - \\lambda\\mathbf{I}) = 0$ 的根：\n$$\n(\\lambda_s^0 - \\lambda)(\\lambda_a^0 - \\lambda) - \\kappa^2 = 0\n$$\n这是一个关于 $\\lambda$ 的二次方程，其解为：\n$$\n\\lambda = \\frac{\\lambda_s^0 + \\lambda_a^0}{2} \\pm \\frac{\\sqrt{(\\lambda_s^0 - \\lambda_a^0)^2 + 4\\kappa^2}}{2}\n$$\n主导全局特征值 $\\lambda_{\\max}$ 是具有最大实部 $\\mathrm{Re}(\\lambda)$ 的特征值。\n\n主导模态根据其对应的特征向量 $\\mathbf{v}_{\\max} = [v_1, v_2]^T$ 进行分类。如果 $|v_1| \\ge |v_2|$，则该模态被分类为剪切层模态（整数 $0$）；否则，为声学模态（整数 $1$）。与特征值 $\\lambda$ 对应的特征向量可以通过求解 $(\\mathbf{L} - \\lambda\\mathbf{I})\\mathbf{v} = \\mathbf{0}$ 找到。对于 $\\kappa \\ne 0$，一个有效的特征向量是 $\\mathbf{v} = [\\kappa, \\lambda - \\lambda_s^0]^T$。分类则基于比较 $|\\kappa|$ 和 $|\\lambda_{\\max} - \\lambda_s^0|$。\n\n### 3. 测试用例的实现\n\n开发了一个计算程序来处理这四个具体的测试。\n\n**测试1：$\\mathrm{Re}$ 的延拓**\n在 $\\mathrm{Ma}=0.6$ 和 $s=1.0$ 的条件下，参数 $\\mathrm{Re}$ 在 $300$到$900$之间以$121$个步长变化。在每一步，构建矩阵 $\\mathbf{L}$，计算其特征值，并存储主导特征值 $\\lambda_{\\max}$ 的实部。最终结果是沿此路径遇到的这些存储实部的最大值。\n\n**测试2：$\\mathrm{Ma}$ 中的分类切换**\n在 $\\mathrm{Re}=600$ 和 $s=1.0$ 的条件下，参数 $\\mathrm{Ma}$ 在 $0.2$ 到 $1.2$ 之间以 $101$ 个步长变化。首先，在初始点 $\\mathrm{Ma}=0.2$ 确定模态分类（剪切层或声学）。然后，对于后续的 $\\mathrm{Ma}$ 值，重新对模态进行分类。测试返回分类与初始分类不同的第一个（最小的）$\\mathrm{Ma}$ 值。如果整个路径上没有发生此类切换，则结果为 $\\mathrm{NaN}$。\n\n**测试3：到余维-2交叉点的距离**\n在 $(\\mathrm{Re}, \\mathrm{Ma})$ 平面中，一个参数路径由 $\\mathrm{Re}(t)=650+50t$ 和 $\\mathrm{Ma}(t)=0.85+0.1t$ 定义，其中 $t \\in [0,1]$，在 $101$ 个点上采样。在每个点，计算距离度量 $D(t)$：\n$$\nD(t)=\\sqrt{\\left[\\alpha_s(\\mathrm{Re}(t))-\\alpha_a(\\mathrm{Ma}(t))\\right]^2+\\left[\\omega_s(\\mathrm{Re}(t))-\\omega_a(\\mathrm{Ma}(t))\\right]^2}\n$$\n该度量表示复平面中解耦特征值 $(\\alpha_s, \\omega_s)$ 和 $(\\alpha_a, \\omega_a)$ 之间的欧几里得距离。最终结果是沿路径找到的 $D(t)$ 的最小值。\n\n**测试4：解耦余维-2交叉点的存在性**\n该测试需要求解一个由两个非线性方程组成的方程组，以确定 $(\\mathrm{Re}, \\mathrm{Ma})$ 的值，该值定义了一个余维-2交叉点，在该点解耦的特征值相等（$\\lambda_s^0 = \\lambda_a^0$）：\n$$\n(1) \\quad \\alpha_s(\\mathrm{Re}) = \\alpha_a(\\mathrm{Ma})\n$$\n$$\n(2) \\quad \\omega_s(\\mathrm{Re}) = \\omega_a(\\mathrm{Ma})\n$$\n代入 $\\mathrm{Pr}=\\mathrm{Pr}_0$ 的显式公式：\n$$\n(1) \\quad -0.05+0.12\\,\\frac{\\mathrm{Re}-600}{600} = -0.08+0.15\\,(\\mathrm{Ma}-0.6)\n$$\n$$\n(2) \\quad 0.7+0.03\\,\\sqrt{\\mathrm{Re}} = 0.4+1.2\\,\\mathrm{Ma}\n$$\n方程(1)在 $\\mathrm{Re}$ 和 $\\mathrm{Ma}$ 上是线性的。简化后可得直接关系：$\\mathrm{Re} = 750\\,\\mathrm{Ma}$。\n将此关系代入方程(2)可得到一个关于 $\\mathrm{Ma}$ 的单非线性方程：\n$$\n0.7+0.03\\,\\sqrt{750\\,\\mathrm{Ma}} - (0.4+1.2\\,\\mathrm{Ma}) = 0\n$$\n使用数值求根算法（如 Brent 方法）求解该方程以得到 $\\mathrm{Ma}$。对根 $\\mathrm{Ma}^\\star$ 的搜索在由问题指定域 $\\mathrm{Ma}\\in[0.5,1.0]$ 和 $\\mathrm{Re}\\in[500,800]$ 的交集派生出的区间内进行。后一个约束意味着 $\\mathrm{Ma} \\in [500/750, 800/750] \\approx [0.667, 1.067]$。因此，对 $\\mathrm{Ma}^\\star$ 的搜索在 $[2/3, 1.0]$ 区间内进行。如果在此区间内找到一个根，则表示在指定域内存在一个解 $(\\mathrm{Re}^\\star, \\mathrm{Ma}^\\star)$，函数返回 `True`；否则，返回 `False`。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem and print the results for all test cases.\n    \"\"\"\n\n    # --- Model Constants ---\n    Re0, Ma0, Pr0 = 600.0, 0.6, 0.72\n    alpha_s0, alpha_s1, alpha_s2 = -0.05, 0.12, 0.02\n    omega_s0, omega_s1 = 0.7, 0.03\n    alpha_a0, alpha_a1, alpha_a2 = -0.08, 0.15, 0.01\n    omega_a0, omega_a1 = 0.4, 1.2\n    kappa1, kappa2 = 0.02, 0.005\n\n    # --- Model Functions (with Pr = Pr0) ---\n    def alpha_s(Re):\n        return alpha_s0 + alpha_s1 * (Re - Re0) / Re0\n    \n    def omega_s(Re):\n        return omega_s0 + omega_s1 * np.sqrt(Re)\n\n    def alpha_a(Ma):\n        return alpha_a0 + alpha_a1 * (Ma - Ma0)\n    \n    def omega_a(Ma):\n        return omega_a0 + omega_a1 * Ma\n\n    def kappa(Re, Ma, s):\n        return s * (kappa1 * Ma + kappa2 * np.sqrt(Re))\n\n    def get_leading_mode(Re, Ma, s):\n        \"\"\"\n        Computes the leading eigenvalue and its classification for given parameters.\n        \"\"\"\n        lambda_s_0 = alpha_s(Re) + 1j * omega_s(Re)\n        lambda_a_0 = alpha_a(Ma) + 1j * omega_a(Ma)\n        k = kappa(Re, Ma, s)\n\n        # Build the L matrix\n        L = np.array([[lambda_s_0, k], [k, lambda_a_0]], dtype=complex)\n        \n        # Eigen decomposition\n        evals, evecs = np.linalg.eig(L)\n        \n        # Find leading eigenvalue (max real part)\n        idx_max = np.argmax(np.real(evals))\n        lambda_max = evals[idx_max]\n        \n        # Get corresponding eigenvector\n        v_max = evecs[:, idx_max]\n        \n        # Classify the mode\n        # 0 for shear-layer, 1 for acoustic\n        classification = 0 if np.abs(v_max[0]) >= np.abs(v_max[1]) else 1\n        \n        return lambda_max, classification\n\n    # --- Test Case 1: Continuation in Re ---\n    def test1():\n        Ma, s = 0.6, 1.0\n        Re_path = np.linspace(300, 900, 121)\n        max_real_parts = []\n        for Re in Re_path:\n            lambda_max, _ = get_leading_mode(Re, Ma, s)\n            max_real_parts.append(np.real(lambda_max))\n        return np.max(max_real_parts)\n\n    # --- Test Case 2: Classification switch in Ma ---\n    def test2():\n        Re, s = 600.0, 1.0\n        Ma_path = np.linspace(0.2, 1.2, 101)\n        \n        # Get reference classification at the start of the path\n        _, ref_class = get_leading_mode(Re, Ma_path[0], s)\n        \n        # Find the first point of switch\n        for Ma in Ma_path[1:]:\n            _, current_class = get_leading_mode(Re, Ma, s)\n            if current_class != ref_class:\n                return Ma\n        \n        return np.nan\n\n    # --- Test Case 3: Distance to codimension-2 crossing ---\n    def test3():\n        t_path = np.linspace(0, 1, 101)\n        distances = []\n        \n        for t in t_path:\n            Re_t = 650.0 + 50.0 * t\n            Ma_t = 0.85 + 0.1 * t\n            \n            val_alpha_s = alpha_s(Re_t)\n            val_omega_s = omega_s(Re_t)\n            val_alpha_a = alpha_a(Ma_t)\n            val_omega_a = omega_a(Ma_t)\n            \n            dist = np.sqrt((val_alpha_s - val_alpha_a)**2 + (val_omega_s - val_omega_a)**2)\n            distances.append(dist)\n            \n        return np.min(distances)\n\n    # --- Test Case 4: Existence of uncoupled codimension-2 crossing ---\n    def test4():\n        # From Eq1 (alpha_s = alpha_a), we derive Re = 750 * Ma\n        re_of_ma = lambda ma: 750.0 * ma\n\n        # We need to find the root of f(Ma) = omega_s(Re(Ma)) - omega_a(Ma) = 0\n        def f_ma(ma):\n            re = re_of_ma(ma)\n            return omega_s(re) - omega_a(ma)\n\n        # Domain constraints from the problem\n        re_min, re_max = 500.0, 800.0\n        ma_min, ma_max = 0.5, 1.0\n        \n        # Combine constraints: find search interval for Ma\n        ma_from_re_min = re_min / 750.0 # 500/750 = 2/3\n        ma_from_re_max = re_max / 750.0 # 800/750 ~ 1.067\n        \n        search_ma_min = max(ma_min, ma_from_re_min)\n        search_ma_max = min(ma_max, ma_from_re_max)\n        \n        # Check if the search interval is valid\n        if search_ma_min >= search_ma_max:\n             return False\n\n        try:\n            # Brent's method requires endpoints f(a) and f(b) to have different signs\n            optimize.brentq(f_ma, search_ma_min, search_ma_max)\n            return True\n        except ValueError:\n            # This exception is raised if f(a) and f(b) have the same sign\n            return False\n\n    # --- Execute all tests and format output ---\n    results = [test1(), test2(), test3(), test4()]\n    \n    # Format according to specifications in the problem description\n    print(f\"[{results[0]},{results[1]},{results[2]},{str(results[3]).lower()}]\")\n\nsolve()\n```", "id": "3323974"}]}