{"hands_on_practices": [{"introduction": "在尝试为一个给定的马尔可夫链寻找满足细致平衡条件的平稳分布 $\\pi$ 之前，一个更基本的问题是：这样的分布是否存在？本练习将引导你使用柯尔莫哥洛夫循环准则 (Kolmogorov's cycle criterion)，这是细致平衡方程的一个直接推论，来回答这个问题。通过一个具体的三状态链，你将实践如何从理论上验证一个转移矩阵的可逆性，并在此基础上求解其平稳分布。[@problem_id:3302632]", "problem": "考虑一个状态空间为 $\\{1,2,3\\}$ 的离散时间马尔可夫链 (MC)，其转移概率由以下随机矩阵 $P = (P_{ij})$ 给出：\n$$\nP \\;=\\;\n\\begin{pmatrix}\nP_{11}  P_{12}  P_{13} \\\\\nP_{21}  P_{22}  P_{23} \\\\\nP_{31}  P_{32}  P_{33}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\frac{2}{5}  \\frac{2}{5}  \\frac{1}{5} \\\\\n\\frac{1}{2}  \\frac{1}{6}  \\frac{1}{3} \\\\\n\\frac{3}{10}  \\frac{2}{5}  \\frac{3}{10}\n\\end{pmatrix}.\n$$\n关于一个严格为正的不变分布 $\\pi = (\\pi_{1},\\pi_{2},\\pi_{3})$ 的可逆性（细致平衡）意味着对于所有 $i,j \\in \\{1,2,3\\}$，都有 $\\pi_{i} P_{ij} = \\pi_{j} P_{ji}$。一个经典的可逆性判据涉及沿闭合环路的循环约束。从离散时间马尔可夫链、平稳性和细致平衡的核心定义出发，推导三状态链的循环判据，然后用它来判断对于上述矩阵 $P$ 是否存在某个严格为正的 $\\pi$ 使其满足细致平衡。如果满足，求解 $\\pi$，并满足归一化条件 $\\sum_{i=1}^{3} \\pi_{i} = 1$。如果细致平衡不成立，请用循环判据证明此结论。将你的最终答案表示为归一化向量 $\\pi$；无需四舍五入，答案必须是精确值。", "solution": "问题陈述是离散时间马尔可夫链理论中的一个有效练习。它是自洽的、数学上合理的、且是良定的。我们将开始解答。\n\n首先，我们根据问题陈述的要求建立理论基础。\n\n在有限状态空间 $\\mathcal{S}$ 上的离散时间马尔可夫链是一个随机变量序列 $\\{X_n\\}_{n \\ge 0}$，其取值于 $\\mathcal{S}$，并满足马尔可夫性质：对于任何状态 $i, j, i_0, \\ldots, i_{n-1} \\in \\mathcal{S}$，\n$$\nP(X_{n+1}=j | X_n=i, X_{n-1}=i_{n-1}, \\dots, X_0=i_0) = P(X_{n+1}=j | X_n=i).\n$$\n对于时齐链，这个概率与 $n$ 无关，并记为转移概率 $P_{ij} = P(X_{n+1}=j | X_n=i)$。这些概率构成了转移矩阵 $P = (P_{ij})$。\n\n一个概率分布 $\\pi = (\\pi_i)_{i \\in \\mathcal{S}}$ 被称为平稳分布或不变分布，如果它是转移算子的不动点。也就是说，如果在时刻 $n$ 链处于状态 $i$ 的概率为 $\\pi_i$，那么在时刻 $n+1$ 它处于状态 $j$ 的概率为 $\\pi_j$。这可以由方程 $\\pi = \\pi P$ 表示，其分量形式为：\n$$\n\\pi_j = \\sum_{i \\in \\mathcal{S}} \\pi_i P_{ij} \\quad \\text{for all } j \\in \\mathcal{S}.\n$$\n\n如果对于所有状态 $i, j \\in \\mathcal{S}$，马尔可夫链满足以下条件，则称其是可逆的，或称其关于分布 $\\pi$ 满足细致平衡条件：\n$$\n\\pi_i P_{ij} = \\pi_j P_{ji}.\n$$\n细致平衡条件是平稳性的一个充分但不必要条件。为了证明这一点，我们曾将细致平衡方程对所有状态 $i$ 求和：\n$$\n\\sum_{i \\in \\mathcal{S}} \\pi_i P_{ij} = \\sum_{i \\in \\mathcal{S}} \\pi_j P_{ji} = \\pi_j \\sum_{i \\in \\mathcal{S}} P_{ji}.\n$$\n左边的项是向量 $\\pi P$ 的第 $j$ 个分量。为了证明它等于 $\\pi_j$，我们必须改为对 $j$ 求和细致平衡方程：\n$$\n\\sum_{j \\in \\mathcal{S}} \\pi_i P_{ij} = \\sum_{j \\in \\mathcal{S}} \\pi_j P_{ji}.\n$$\n左边可以简化为 $\\pi_i \\sum_{j \\in \\mathcal{S}} P_{ij} = \\pi_i \\cdot 1 = \\pi_i$，因为随机矩阵的行和为1。因此，方程变为 $\\pi_i = \\sum_{j \\in \\mathcal{S}} \\pi_j P_{ji}$。通过令 $i \\to j$ 和 $j \\to i$ 重新标记索引，得到 $\\pi_j = \\sum_{i \\in \\mathcal{S}} \\pi_i P_{ij}$，这正是平稳性条件。\n\n接下来，我们推导循环判据（Kolmogorov可逆性判据）。假设对于一个严格为正的分布 $\\pi > 0$，细致平衡条件 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 成立。考虑任意一个状态的闭合环路（循环）$i_1, i_2, \\ldots, i_k, i_1$。由细致平衡条件，我们可以写出：\n$$\n\\frac{P_{i_m i_{m+1}}}{P_{i_{m+1} i_m}} = \\frac{\\pi_{i_{m+1}}}{\\pi_{i_m}}\n$$\n对于循环中的任意相邻状态对，只要分母中的转移概率非零。\n沿循环 $i_1 \\to i_2 \\to \\dots \\to i_k \\to i_1$ (其中 $i_{k+1}=i_1$) 取乘积：\n$$\n\\prod_{m=1}^{k} \\frac{P_{i_m i_{m+1}}}{P_{i_{m+1} i_m}} = \\frac{P_{i_1 i_2}}{P_{i_2 i_1}} \\cdot \\frac{P_{i_2 i_3}}{P_{i_3 i_2}} \\cdots \\frac{P_{i_k i_1}}{P_{i_1 i_k}} = \\frac{\\pi_{i_2}}{\\pi_{i_1}} \\cdot \\frac{\\pi_{i_3}}{\\pi_{i_2}} \\cdots \\frac{\\pi_{i_1}}{\\pi_{i_k}} = 1.\n$$\n这意味着沿任意循环的转移概率乘积必须等于沿同一循环反方向的转移概率乘积：\n$$\nP_{i_1 i_2} P_{i_2 i_3} \\cdots P_{i_k i_1} = P_{i_1 i_k} P_{i_k i_{k-1}} \\cdots P_{i_2 i_1}.\n$$\n对于一个在 $\\mathcal{S}=\\{1, 2, 3\\}$ 上的三状态链，任何长度大于3的循环都由更小的循环组成。长度为2的循环（例如 $1 \\to 2 \\to 1$）给出平凡恒等式 $P_{12}P_{21} = P_{12}P_{21}$。因此，只需检查长度为3的循环 $1 \\to 2 \\to 3 \\to 1$ 的条件即可。该判据是：\n$$\nP_{12} P_{23} P_{31} = P_{13} P_{32} P_{21}.\n$$\n左边的乘积对应于路径 $1 \\to 2 \\to 3 \\to 1$，右边的乘积对应于反向路径 $1 \\to 3 \\to 2 \\to 1$。\n\n我们现在将此判据应用于给定的转移矩阵：\n$$\nP =\n\\begin{pmatrix}\n\\frac{2}{5}  \\frac{2}{5}  \\frac{1}{5} \\\\\n\\frac{1}{2}  \\frac{1}{6}  \\frac{1}{3} \\\\\n\\frac{3}{10}  \\frac{2}{5}  \\frac{3}{10}\n\\end{pmatrix}.\n$$\n相关的转移概率是：\n$P_{12} = \\frac{2}{5}$, $P_{23} = \\frac{1}{3}$, $P_{31} = \\frac{3}{10}$.\n$P_{13} = \\frac{1}{5}$, $P_{32} = \\frac{2}{5}$, $P_{21} = \\frac{1}{2}$.\n\n我们计算循环 $1 \\to 2 \\to 3 \\to 1$ 的乘积：\n$$\nP_{12} P_{23} P_{31} = \\left(\\frac{2}{5}\\right) \\left(\\frac{1}{3}\\right) \\left(\\frac{3}{10}\\right) = \\frac{6}{150} = \\frac{1}{25}.\n$$\n接下来，我们计算反向循环 $1 \\to 3 \\to 2 \\to 1$ 的乘积：\n$$\nP_{13} P_{32} P_{21} = \\left(\\frac{1}{5}\\right) \\left(\\frac{2}{5}\\right) \\left(\\frac{1}{2}\\right) = \\frac{2}{50} = \\frac{1}{25}.\n$$\n由于 $P_{12} P_{23} P_{31} = P_{13} P_{32} P_{21}$，循环判据得到满足。因此，对于此马尔可夫链，存在一个满足细致平衡条件的严格为正的不变分布 $\\pi$。\n\n我们现在来求解这个分布 $\\pi = (\\pi_1, \\pi_2, \\pi_3)$。细致平衡方程为：\n1. $\\pi_1 P_{12} = \\pi_2 P_{21} \\implies \\pi_1 \\left(\\frac{2}{5}\\right) = \\pi_2 \\left(\\frac{1}{2}\\right)$\n2. $\\pi_2 P_{23} = \\pi_3 P_{32} \\implies \\pi_2 \\left(\\frac{1}{3}\\right) = \\pi_3 \\left(\\frac{2}{5}\\right)$\n\n从方程（1）中，我们将 $\\pi_2$ 用 $\\pi_1$ 表示：\n$$\n\\pi_2 = \\pi_1 \\frac{2/5}{1/2} = \\pi_1 \\left(\\frac{4}{5}\\right).\n$$\n从方程（2）中，我们将 $\\pi_3$ 用 $\\pi_2$ 表示：\n$$\n\\pi_3 = \\pi_2 \\frac{1/3}{2/5} = \\pi_2 \\left(\\frac{5}{6}\\right).\n$$\n代入 $\\pi_2$ 的表达式：\n$$\n\\pi_3 = \\left(\\frac{4}{5}\\pi_1\\right) \\left(\\frac{5}{6}\\right) = \\frac{4}{6}\\pi_1 = \\frac{2}{3}\\pi_1.\n$$\n现在我们有 $\\pi_2 = \\frac{4}{5}\\pi_1$ 和 $\\pi_3 = \\frac{2}{3}\\pi_1$。我们使用归一化条件 $\\sum_{i=1}^{3} \\pi_i = 1$：\n$$\n\\pi_1 + \\pi_2 + \\pi_3 = 1\n$$\n$$\n\\pi_1 + \\frac{4}{5}\\pi_1 + \\frac{2}{3}\\pi_1 = 1\n$$\n$$\n\\pi_1 \\left(1 + \\frac{4}{5} + \\frac{2}{3}\\right) = 1\n$$\n为了对分数求和，我们找到公分母，即 $15$：\n$$\n\\pi_1 \\left(\\frac{15}{15} + \\frac{12}{15} + \\frac{10}{15}\\right) = 1\n$$\n$$\n\\pi_1 \\left(\\frac{15+12+10}{15}\\right) = 1\n$$\n$$\n\\pi_1 \\left(\\frac{37}{15}\\right) = 1 \\implies \\pi_1 = \\frac{15}{37}.\n$$\n现在我们求 $\\pi_2$ 和 $\\pi_3$：\n$$\n\\pi_2 = \\frac{4}{5}\\pi_1 = \\frac{4}{5} \\left(\\frac{15}{37}\\right) = \\frac{12}{37}.\n$$\n$$\n\\pi_3 = \\frac{2}{3}\\pi_1 = \\frac{2}{3} \\left(\\frac{15}{37}\\right) = \\frac{10}{37}.\n$$\n因此，满足细致平衡的唯一归一化平稳分布是 $\\pi = \\left(\\frac{15}{37}, \\frac{12}{37}, \\frac{10}{37}\\right)$。所有分量都严格为正，符合要求。最后检查确认归一化：$\\frac{15}{37} + \\frac{12}{37} + \\frac{10}{37} = \\frac{37}{37} = 1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{15}{37}  \\frac{12}{37}  \\frac{10}{37}\n\\end{pmatrix}\n}\n$$", "id": "3302632"}, {"introduction": "细致平衡不仅是检验马尔可夫链可逆性的一个属性，更是在设计MCMC算法时必须遵循的构造性原则。本练习模拟了一个常见的编程陷阱：当提议分布依赖于当前状态（非对称）时，误用一个为对称提议设计的“朴素”接受率。你的任务是运用细致平衡方程，诊断出问题所在，并推导出正确的Metropolis-Hastings接受概率，从而“修复”这个算法。[@problem_id:3302655]", "problem": "考虑一个在状态空间 $\\{0,1,2\\}$ 上，以分布 $\\pi$ 为目标分布的有限状态马尔可夫链蒙特卡洛 (MCMC) 方法，其中 $\\pi(0)=\\frac{1}{2}$，$\\pi(1)=\\frac{1}{3}$，以及 $\\pi(2)=\\frac{1}{6}$。有两个确定性提议核可用：一个顺时针核 $K^{+}$，定义为若 $y\\equiv x+1\\ (\\mathrm{mod}\\ 3)$ 则 $K^{+}(x,y)=1$，否则 $K^{+}(x,y)=0$；以及一个逆时针核 $K^{-}$，定义为若 $y\\equiv x-1\\ (\\mathrm{mod}\\ 3)$ 则 $K^{-}(x,y)=1$，否则 $K^{-}(x,y)=0$。提议机制是一个依赖于状态的混合模型：在当前状态 $x$，$K^{+}$ 以权重 $w(x)$ 被选择，$K^{-}$ 以权重 $1-w(x)$ 被选择，其中 $w(0)=\\frac{3}{4}$，$w(1)=\\frac{1}{2}$，以及 $w(2)=\\frac{1}{4}$。因此，单步提议概率为 $q(x,y)=w(x)K^{+}(x,y)+\\big(1-w(x)\\big)K^{-}(x,y)$。\n\n假设一个实践者实现了一个幼稚的接受规则，该规则错误地假设提议是对称的，并对所有 $x\\neq y$ 使用 $\\alpha_{\\mathrm{naive}}(x,y)=\\min\\!\\big(1,\\frac{\\pi(y)}{\\pi(x)}\\big)$。仅使用细致平衡的定义，即对于所有状态 $x,y$ 且 $x\\neq y$，有 $\\pi(x)P(x,y)=\\pi(y)P(y,x)$，其中 $P(x,y)=q(x,y)\\alpha(x,y)$ 表示转移核，并利用概率法则，计算比率\n$$\\rho=\\frac{\\pi(0)\\,q(0,1)\\,\\alpha_{\\mathrm{naive}}(0,1)}{\\pi(1)\\,q(1,0)\\,\\alpha_{\\mathrm{naive}}(1,0)}$$\n以证明在该幼稚规则下，对于状态对 $(0,1)$，细致平衡被破坏。\n\n然后，从相同的细致平衡基本定义出发，不假设任何快捷公式，推导在给定的依赖状态的混合提议 $q(x,y)$ 下，能够恢复从 $0$到$1$ 转换的可逆性的接受概率 $\\alpha_{\\mathrm{corr}}(0,1)$。将你的最终答案表示为单个最简分数。无需四舍五入。", "solution": "该问题的分析将分两部分进行。首先，我们将通过计算指定的比率 $\\rho$ 来证明幼稚的接受规则违反了细致平衡条件。其次，我们将推导正确的接受概率 $\\alpha_{\\mathrm{corr}}(0,1)$，该概率恢复了从状态 $0$到$1$ 的转换的细致平衡。\n\n给定的参数如下：\n状态空间：$S = \\{0, 1, 2\\}$\n目标分布：$\\pi(0) = \\frac{1}{2}$，$\\pi(1) = \\frac{1}{3}$，$\\pi(2) = \\frac{1}{6}$\n顺时针提议：$K^{+}(x,y)=1$ 若 $y \\equiv x+1 \\pmod{3}$\n逆时针提议：$K^{-}(x,y)=1$ 若 $y \\equiv x-1 \\pmod{3}$\n依赖状态的混合权重：$w(0)=\\frac{3}{4}$，$w(1)=\\frac{1}{2}$，$w(2)=\\frac{1}{4}$\n组合提议概率：$q(x,y)=w(x)K^{+}(x,y)+\\big(1-w(x)\\big)K^{-}(x,y)$\n\n细致平衡（可逆性）的基本条件指出，对于一个具有平稳分布 $\\pi$ 和转移概率 $P(x,y)$ 的马尔可夫链，在平衡状态下，从状态 $x$ 到 $y$ 的转移率必须等于从 $y$ 到 $x$ 的转移率。对于任何一对不同的状态 $x, y \\in S$，这表示为：\n$$ \\pi(x) P(x,y) = \\pi(y) P(y,x) $$\n对于一个Metropolis-Hastings类型的算法，当 $x \\neq y$ 时，转移概率由 $P(x,y) = q(x,y)\\alpha(x,y)$ 给出，其中 $q(x,y)$ 是提议概率，$\\alpha(x,y)$ 是接受概率。\n\n### 第一部分：使用幼稚规则对细致平衡的违反\n\n我们被要求计算比率 $\\rho = \\frac{\\pi(0)\\,q(0,1)\\,\\alpha_{\\mathrm{naive}}(0,1)}{\\pi(1)\\,q(1,0)\\,\\alpha_{\\mathrm{naive}}(1,0)}$ 来表明对于状态对 $(0,1)$，细致平衡被破坏。细致平衡成立当且仅当这个比率等于 $1$。\n\n首先，我们计算必要的提议概率 $q(0,1)$ 和 $q(1,0)$。\n对于转移 $0 \\to 1$：\n提议的状态 $y=1$ 是从当前状态 $x=0$ 顺时针方向，因为 $1 \\equiv 0+1 \\pmod{3}$。因此，$K^{+}(0,1)=1$ 且 $K^{-}(0,1)=0$。\n提议概率为：\n$q(0,1) = w(0)K^{+}(0,1) + (1-w(0))K^{-}(0,1) = w(0) \\cdot 1 + (1-w(0)) \\cdot 0 = w(0) = \\frac{3}{4}$。\n\n对于转移 $1 \\to 0$：\n提议的状态 $y=0$ 是从当前状态 $x=1$ 逆时针方向，因为 $0 \\equiv 1-1 \\pmod{3}$。因此，$K^{+}(1,0)=0$ 且 $K^{-}(1,0)=1$。\n提议概率为：\n$q(1,0) = w(1)K^{+}(1,0) + (1-w(1))K^{-}(1,0) = w(1) \\cdot 0 + (1-w(1)) \\cdot 1 = 1-w(1) = 1-\\frac{1}{2} = \\frac{1}{2}$。\n\n接下来，我们使用幼稚规则 $\\alpha_{\\mathrm{naive}}(x,y)=\\min\\left(1,\\frac{\\pi(y)}{\\pi(x)}\\right)$ 来计算接受概率。\n对于转移 $0 \\to 1$：\n$\\alpha_{\\mathrm{naive}}(0,1) = \\min\\left(1, \\frac{\\pi(1)}{\\pi(0)}\\right) = \\min\\left(1, \\frac{1/3}{1/2}\\right) = \\min\\left(1, \\frac{2}{3}\\right) = \\frac{2}{3}$。\n\n对于转移 $1 \\to 0$：\n$\\alpha_{\\mathrm{naive}}(1,0) = \\min\\left(1, \\frac{\\pi(0)}{\\pi(1)}\\right) = \\min\\left(1, \\frac{1/2}{1/3}\\right) = \\min\\left(1, \\frac{3}{2}\\right) = 1$。\n\n现在我们可以计算 $\\rho$ 的分子和分母。\n正向通量（与从 $0$ 到 $1$ 的概率流成正比）是：\n$\\pi(0)\\,q(0,1)\\,\\alpha_{\\mathrm{naive}}(0,1) = \\frac{1}{2} \\cdot \\frac{3}{4} \\cdot \\frac{2}{3} = \\frac{6}{24} = \\frac{1}{4}$。\n\n反向通量（与从 $1$ 到 $0$ 的概率流成正比）是：\n$\\pi(1)\\,q(1,0)\\,\\alpha_{\\mathrm{naive}}(1,0) = \\frac{1}{3} \\cdot \\frac{1}{2} \\cdot 1 = \\frac{1}{6}$。\n\n因此，比率 $\\rho$ 是：\n$$ \\rho = \\frac{1/4}{1/6} = \\frac{6}{4} = \\frac{3}{2} $$\n由于 $\\rho = \\frac{3}{2} \\neq 1$，正向和反向通量不平衡。这证明了忽略了提议分布 $q(x,y)$ 不对称性的幼稚接受规则，未能满足状态对 $(0,1)$ 的细致平衡条件。\n\n### 第二部分：正确接受概率的推导\n\n为了恢复细致平衡，必须选择接受概率 $\\alpha_{\\mathrm{corr}}(x,y)$，使得对于所有 $x \\neq y$：\n$$ \\pi(x) q(x,y) \\alpha_{\\mathrm{corr}}(x,y) = \\pi(y) q(y,x) \\alpha_{\\mathrm{corr}}(y,x) $$\n我们必须找到满足此方程的 $\\alpha_{\\mathrm{corr}}(x,y)$ 和 $\\alpha_{\\mathrm{corr}}(y,x)$ 的解，同时遵守接受概率必须在区间 $[0,1]$ 内的约束。一种最大化接受率的标准方法是将其中一个概率设置为其最大可能值 $1$。\n\n让我们重新整理这个方程：\n$$ \\frac{\\alpha_{\\mathrm{corr}}(x,y)}{\\alpha_{\\mathrm{corr}}(y,x)} = \\frac{\\pi(y) q(y,x)}{\\pi(x) q(x,y)} $$\n定义 Metropolis-Hastings 比率 $R_{xy} = \\frac{\\pi(y) q(y,x)}{\\pi(x) q(x,y)}$。\n情况1：$R_{xy} \\le 1$。我们希望最大化接受概率。我们可以将两者中较大的 $\\alpha_{\\mathrm{corr}}(y,x)$ 设置为其最大值 $1$。然后方程决定了 $\\alpha_{\\mathrm{corr}}(x,y) = R_{xy}$。由于 $R_{xy} \\le 1$，这个选择是有效的。所以，$\\alpha_{\\mathrm{corr}}(x,y) = R_{xy}$ 且 $\\alpha_{\\mathrm{corr}}(y,x) = 1$。\n\n情况2：$R_{xy} > 1$。在这种情况下，$\\frac{1}{R_{xy}} < 1$。我们可以将 $\\alpha_{\\mathrm{corr}}(x,y)$ 设置为其最大值 $1$。方程则要求 $1 = R_{xy} \\cdot \\alpha_{\\mathrm{corr}}(y,x)$，这得出 $\\alpha_{\\mathrm{corr}}(y,x) = \\frac{1}{R_{xy}}$。由于 $\\frac{1}{R_{xy}} < 1$，这个选择是有效的。所以，$\\alpha_{\\mathrm{corr}}(x,y) = 1$ 且 $\\alpha_{\\mathrm{corr}}(y,x) = \\frac{1}{R_{xy}}$。\n\n这两种情况可以使用最小值函数紧凑地表示：\n$$ \\alpha_{\\mathrm{corr}}(x,y) = \\min\\left(1, R_{xy}\\right) = \\min\\left(1, \\frac{\\pi(y) q(y,x)}{\\pi(x) q(x,y)}\\right) $$\n这是 Metropolis-Hastings 接受概率的一般形式。\n\n我们现在应用这个公式来找到 $\\alpha_{\\mathrm{corr}}(0,1)$ 的具体值。我们需要计算比率 $R_{01}$：\n$$ R_{01} = \\frac{\\pi(1) q(1,0)}{\\pi(0) q(0,1)} $$\n使用我们已经计算出的值：\n$\\pi(0) = \\frac{1}{2}$\n$\\pi(1) = \\frac{1}{3}$\n$q(0,1) = \\frac{3}{4}$\n$q(1,0) = \\frac{1}{2}$\n\n分子是 $\\pi(1) q(1,0) = \\frac{1}{3} \\cdot \\frac{1}{2} = \\frac{1}{6}$。\n分母是 $\\pi(0) q(0,1) = \\frac{1}{2} \\cdot \\frac{3}{4} = \\frac{3}{8}$。\n\n比率是：\n$$ R_{01} = \\frac{1/6}{3/8} = \\frac{1}{6} \\cdot \\frac{8}{3} = \\frac{8}{18} = \\frac{4}{9} $$\n最后，从 $0$ 到 $1$ 的转移的正确接受概率是：\n$$ \\alpha_{\\mathrm{corr}}(0,1) = \\min\\left(1, \\frac{4}{9}\\right) = \\frac{4}{9} $$\n当在 MCMC 模拟中使用这个值时，将确保对于状态对 $(0,1)$，细致平衡条件得到满足。", "answer": "$$ \\boxed{\\frac{4}{9}} $$", "id": "3302655"}, {"introduction": "一个MCMC采样器在形式上满足细致平衡条件，并不能保证它在实际应用中是高效的。本练习探讨了一个微妙但关键的性能问题：即使算法正确，当提议分布的尾部比目标分布的尾部“更轻”时，链会发生什么？通过分析这种情况，你将深入理解为何满足细致平衡只是构建一个有效采样器的第一步，而算法的收敛速度和探索效率同样至关重要。[@problem_id:3302604]", "problem": "考虑一个在 $\\mathbb{R}$ 上的目标概率密度 $\\,\\pi(x)\\,$，该密度是重尾的，例如自由度为 $\\,\\nu>0\\,$ 的 Student-$t$ 密度，使得对于大的 $\\,|x|\\,$，$\\,\\pi(x)\\asymp c\\,|x|^{-(\\nu+1)}\\,$，其中 $\\,c>0\\,$ 是某个常数。令 $\\,q(x)\\,$ 是一个轻尾的提议密度，例如高斯密度 $\\,\\mathcal{N}(0,1)\\,$。考虑在马尔可夫链蒙特卡洛（MCMC）中使用的独立 Metropolis–Hastings 核：给定当前状态 $\\,X=x\\,$，独立于 $\\,x\\,$ 提议 $\\,Y\\sim q(\\cdot)\\,$，并根据一个选择的接受规则接受 $\\,Y\\,$，该规则使得最终的马尔可夫转移核相对于 $\\,\\pi\\,$ 是可逆的。用 $\\,P(x,\\mathrm{d}y)\\,$ 表示单步转移核。\n\n从细致平衡（可逆性）的定义出发，即对于所有可测集 $\\,A,B\\subset\\mathbb{R}\\,$，\n$$\n\\int_A \\pi(x) P(x,B)\\,\\mathrm{d}x \\;=\\; \\int_B \\pi(y) P(y,A)\\,\\mathrm{d}y,\n$$\n以及重尾函数与轻尾函数的基本性质，分析以下陈述。选择所有正确的陈述，并通过上述定义和独立提议的结构进行推理来证明你的选择。\n\nA. 对于任何在 $\\,\\mathbb{R}\\,$ 上具有全支撑的提议密度 $\\,q\\,$，如果选择接受规则以满足细致平衡所蕴含的可逆性对称，那么得到的独立 Metropolis–Hastings 核 $\\,P\\,$ 相对于 $\\,\\pi\\,$ 是可逆的，无论 $\\,q\\,$ 相对于 $\\,\\pi\\,$ 是轻尾还是重尾。\n\nB. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么当链当前处于一个远尾状态 $\\,x\\,$（即 $\\,|x|\\to\\infty\\,$）时，对于一个落在中心附近的典型提议 $\\,y\\sim q(\\cdot)\\,$，其接受概率会随着 $\\,|x|\\to\\infty\\,$ 而趋于 $\\,0\\,$。因此，链在尾部会变得极其“粘滞”。\n\nC. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么链的不变分布将不再是 $\\,\\pi\\,$，因为在这种不匹配下，从中心到尾部的提议总是被拒绝。\n\nD. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾但在 $\\,\\mathbb{R}\\,$ 上有全支撑，那么尽管 $\\,\\pi\\,$ 是平稳的，该链不可能是 Harris 常返的。\n\nE. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么该链不可能是一致遍历的，因为在这种情况下 $\\,\\sup_{x\\in\\mathbb{R}} \\pi(x)/q(x) = \\infty\\,$，这排除了一个全局次要化条件。", "solution": "该问题要求分析关于独立 Metropolis-Hastings (M-H) 算法的几个陈述，其中目标分布 $\\pi(x)$ 是重尾的，而提议分布 $q(x)$ 是轻尾的。\n\n首先，我们来形式化独立 Metropolis-Hastings 核的组成部分。\n从状态 $x$ 到新状态 $y$ 的提议是从密度 $q(y)$ 中抽取的，因此提议核密度为 $q(x,y) = q(y)$。\n接受概率 $\\alpha(x,y)$ 被选择以满足关于 $\\pi$ 的细致平衡条件。标准选择是：\n$$ \\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y) q(y, x)}{\\pi(x) q(x, y)} \\right) $$\n对于独立采样器，这变成：\n$$ \\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y) q(x)}{\\pi(x) q(y)} \\right) $$\n单步转移核 $P(x, \\mathrm{d}y)$ 可以表示为：\n$$ P(x, \\mathrm{d}y) = \\alpha(x, y) q(y) \\mathrm{d}y + \\left(1 - \\int_{\\mathbb{R}} \\alpha(x, z) q(z) \\mathrm{d}z \\right) \\delta_x(\\mathrm{d}y) $$\n其中 $\\delta_x$ 是在 $x$ 处的狄拉克测度。\n\n问题陈述指出 $\\pi(x)$ 是重尾的，例如对于大的 $|x|$，$\\pi(x) \\asymp c|x|^{-(\\nu+1)}$。提议分布 $q(x)$ 是轻尾的，例如高斯分布 $\\mathcal{N}(0,1)$，其中 $q(x) \\propto \\exp(-x^2/2)$。这种不匹配的一个关键后果是比率 $w(x) = \\pi(x)/q(x)$ 的行为。对于大的 $|x|$，该比率趋于无穷大：\n$$ \\lim_{|x|\\to\\infty} \\frac{\\pi(x)}{q(x)} = \\infty $$\n我们现在分析每个陈述。\n\n**A. 对于任何在 $\\,\\mathbb{R}\\,$ 上具有全支撑的提议密度 $\\,q\\,$，如果选择接受规则以满足细致平衡所蕴含的可逆性对称，那么得到的独立 Metropolis–Hastings 核 $\\,P\\,$ 相对于 $\\,\\pi\\,$ 是可逆的，无论 $\\,q\\,$ 相对于 $\\,\\pi\\,$ 是轻尾还是重尾。**\n\n该陈述是正确的。可逆性（也称为满足细致平衡条件）是 Metropolis-Hastings 算法构造的基础。问题陈述本身就指明了选择接受规则以确保可逆性。标准的 M-H 接受概率 $\\alpha(x, y)$ 是专门设计用来对非对角转移概率强制实施细致平衡条件的，即 $\\pi(x) q(x,y) \\alpha(x,y) = \\pi(y) q(y,x) \\alpha(y,x)$。这反过来保证了完整的核 $P(x, \\mathrm{d}y)$ 关于 $\\pi$ 是可逆的，意味着 $\\int_A \\pi(x) P(x,B)\\,\\mathrm{d}x = \\int_B \\pi(y) P(y,A)\\,\\mathrm{d}y$。这是算法设计的结构性属性，不依赖于 $\\pi$ 和 $q$ 的尾部性质，而是依赖于 $\\alpha(x,y)$ 的函数形式。尾部性质影响链的*性能*和遍历性质（例如，收敛速度），而不影响 $\\pi$ 是所构造核的可逆分布这一事实。因此，该陈述是关于 M-H 算法的正确断言。\n\n**结论：正确**\n\n**B. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么当链当前处于一个远尾状态 $\\,x\\,$（即 $\\,|x|\\to\\infty\\,$）时，对于一个落在中心附近的典型提议 $\\,y\\sim q(\\cdot)\\,$，其接受概率会随着 $\\,|x|\\to\\infty\\,$ 而趋于 $\\,0\\,$。因此，链在尾部会变得极其“粘滞”。**\n\n该陈述是正确的。让我们分析接受概率 $\\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y) q(x)}{\\pi(x) q(y)} \\right)$。我们可以将该比率重写为 $\\frac{\\pi(y)/q(y)}{\\pi(x)/q(x)}$。\n设 $x$ 是一个处于远尾部的状态，因此 $|x| \\to \\infty$。一个“典型”的提议 $y$ 是从轻尾密度 $q(\\cdot)$ 中抽取的，因此 $y$ 很可能位于一个中心区域，在此区域中 $\\pi(y)$ 和 $q(y)$ 都不可忽略，因此比率 $\\pi(y)/q(y)$ 是一个有限正常数。\n如前所述，由于 $q$ 比 $\\pi$ 轻尾，比率 $\\pi(x)/q(x) \\to \\infty$ 当 $|x| \\to \\infty$ 时。\n因此，最小值内的项表现为：\n$$ \\lim_{|x|\\to\\infty} \\frac{\\pi(y) q(x)}{\\pi(x) q(y)} = \\frac{\\pi(y)}{q(y)} \\lim_{|x|\\to\\infty} \\frac{q(x)}{\\pi(x)} = \\frac{\\pi(y)}{q(y)} \\cdot 0 = 0 $$\n所以，$\\lim_{|x|\\to\\infty} \\alpha(x, y) = 0$。接受一个离开状态 $x$ 的移动的总概率是 $\\int_{\\mathbb{R}} \\alpha(x, y) q(y) \\mathrm{d}y$，当 $|x| \\to \\infty$ 时，它也趋于 $0$。这意味着如果链游走到远尾部，它几乎总是会拒绝提议并停留在状态 $x$。这种行为被恰当地描述为“粘滞”。\n\n**结论：正确**\n\n**C. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么链的不变分布将不再是 $\\,\\pi\\,$，因为在这种不匹配下，从中心到尾部的提议总是被拒绝。**\n\n该陈述是错误的。如在对陈述 A 的分析中所述，M-H 核被构造成关于 $\\pi$ 是可逆的。关于分布 $\\pi$ 的可逆性的一个推论是 $\\pi$ 是该链的一个平稳（或不变）分布。由尾部不匹配引起的问题关系到链有效探索状态空间并收敛到 $\\pi$ 的能力，而不是不变分布本身的身份。\n此外，所提供的推理是有缺陷的。一个从中心（状态 $x$）到尾部（状态 $y$，其中 $|y|\\to\\infty$）的提议的接受概率为 $\\alpha(x, y) = \\min \\left( 1, \\frac{\\pi(y)/q(y)}{\\pi(x)/q(x)} \\right)$。对于一个固定的中心状态 $x$，$\\pi(x)/q(x)$ 是一个有限常数。当 $|y|\\to\\infty$ 时，$\\pi(y)/q(y) \\to \\infty$。因此，最小值内的比率趋于 $\\infty$，并且 $\\alpha(x,y) \\to 1$。向尾部的移动实际上以接近 $1$ 的概率被接受。问题不在于拒绝；而在于这样的移动几乎从未被*提议*，因为 $y$ 是从轻尾分布 $q$ 中抽取的。\n\n**结论：错误**\n\n**D. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾但在 $\\,\\mathbb{R}\\,$ 上有全支撑，那么尽管 $\\,\\pi\\,$ 是平稳的，该链不可能是 Harris 常返的。**\n\n该陈述是错误的。如果从任何起始点 $x_0$ 出发，到达任何满足 $\\pi(A) > 0$ 的集合 $A$ 的概率都为正，那么马尔可夫链是 $\\pi$-不可约的。对于独立采样器，如果提议密度 $q(y)$ 在所有 $\\pi(y)$ 为正的 $y$ 处都为正（这里满足此条件，因为高斯分布和 Student-t 分布在 $\\mathbb{R}$ 上都有全支撑），则该链是 $\\pi$-不可约的。MCMC 理论中的标准结果（例如，Mengersen  Tweedie, 1996）指出，一个 $\\pi$-不可约的 M-H 链是 Harris 常返的。Harris 常返意味着链保证会无限次地访问任何具有正 $\\pi$-测度的集合。陈述 B 中描述的“粘滞性”影响收敛和探索的*速率*（即，链不是几何遍历的），但它并不阻止链最终离开尾部并探索整个空间。因此，该链实际上是 Harris 常返的。\n\n**结论：错误**\n\n**E. 如果 $\\,q\\,$ 比 $\\,\\pi\\,$ 轻尾，那么该链不可能是一致遍历的，因为在这种情况下 $\\,\\sup_{x\\in\\mathbb{R}} \\pi(x)/q(x) = \\infty\\,$，这排除了一个全局次要化条件。**\n\n该陈述是正确的。如果一个马尔可夫链在全变差距离上向平稳分布 $\\pi$ 的收敛是一致快速的，即对于某个与起始状态 $x$ 无关的 $R < \\infty$ 和 $\\rho < 1$，有 $\\|P^n(x, \\cdot) - \\pi(\\cdot)\\|_{TV} \\le R \\rho^n$，则该链是一致遍历的。独立采样器是一致遍历的一个充要条件是目标密度与提议密度的比率是一致有界的：\n$$ \\sup_{x\\in\\mathbb{R}} \\frac{\\pi(x)}{q(x)} < \\infty $$\n如前所述，当 $\\pi$ 是重尾而 $q$ 是轻尾时，这个条件被违反了；上确界是无穷大。这个条件之所以是必要的，是因为一致遍历性等价于存在一个形式为 $P(x, \\mathrm{d}y) \\ge \\epsilon \\nu(\\mathrm{d}y)$ 的全局次要化条件，其中 $\\epsilon > 0$ 且 $\\nu$ 是一个概率测度。如果 $\\sup_x \\pi(x)/q(x) = \\infty$，可以证明对于任何潜在的次要化测度，当 $x$ 被带到尾部时，转移核的下界必须趋于 $0$，从而排除了一个一致的（即，与 $x$ 无关的）次要化。因此，该链不能是一致遍历的，并且所提供的推理是合理的。\n\n**结论：正确**", "answer": "$$\\boxed{ABE}$$", "id": "3302604"}]}