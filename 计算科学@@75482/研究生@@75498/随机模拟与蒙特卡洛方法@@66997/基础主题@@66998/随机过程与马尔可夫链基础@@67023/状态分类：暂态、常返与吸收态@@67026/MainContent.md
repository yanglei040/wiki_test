## 引言
[马尔可夫链](@entry_id:150828)是描述无记忆[随机过程](@entry_id:159502)的强大数学模型，在科学与工程的众多领域中扮演着核心角色。然而，要真正利用其预测能力，一个根本性的问题必须得到解答：当一个系统随时间演化时，它的[长期行为](@entry_id:192358)是怎样的？系统会稳定在某个状态，还是会在不同状态间无休止地游走，抑或最终被某个“陷阱”捕获而停止演化？对这些问题的回答，构成了[马尔可夫链状态分类](@entry_id:270812)理论的核心，也是本文旨在解决的知识鸿沟。

本文将通过三个层层递进的章节，系统地引导读者掌握[状态分类](@entry_id:276397)的理论与实践。在第一章“原理与机制”中，我们将建立坚实的理论基础，从暂态、[常返态](@entry_id:276969)和吸收态的数学定义出发，逐步揭示状态空间的内在结构，并介绍如[基本矩阵](@entry_id:275638)等强大的定量分析工具。接着，在第二章“应用与跨学科联系”中，我们将这些抽象概念与实际问题相连接，展示[状态分类](@entry_id:276397)如何在[统计计算](@entry_id:637594)、机器学习和[群体遗传学](@entry_id:146344)等前沿领域中发挥关键作用，从而诊断算法行为、解释自然现象。最后，通过第三章“动手实践”中的精选问题，读者将有机会亲手应用所学知识，解决从模型截断偏差分析到[系统稳定性](@entry_id:273248)评估等具体挑战，将理论洞察转化为实践能力。

## 原理与机制

在理解[马尔可夫链的长期行为](@entry_id:272323)时，对其[状态空间](@entry_id:177074)进行分类是核心的第一步。一个状态的类别决定了链在访问该状态后的未来轨迹：是必然会一次又一次地返回，还是有可能一去不返？本章将深入探讨[状态分类](@entry_id:276397)的基本原理与机制，从基本定义出发，逐步引入更深刻的结构性见解与分析工具。

### 状态的基本分类

从直观上讲，[马尔可夫链](@entry_id:150828)中的状态可以根据其长期可访问性分为三种类型：**[常返态](@entry_id:276969) (recurrent states)**，即一旦访问，未来必然会再次返回；**暂态 (transient states)**，即访问后，存在非零概率永远不再返回；以及**[吸收态](@entry_id:161036) (absorbing states)**，即一旦进入，就永远无法离开。为了严谨地描述这些概念，我们需要引入一些关键的数学量。

考虑一个具有可数[状态空间](@entry_id:177074) $\mathcal{S}$ 和[转移矩阵](@entry_id:145510) $P$ 的时齐[马尔可夫链](@entry_id:150828)。对于任意状态 $i \in \mathcal{S}$，假设链从 $X_0 = i$ 出发。

我们定义首次返回时间 $T_i = \inf\{n \ge 1 : X_n = i\}$。这是一个[随机变量](@entry_id:195330)，表示从状态 $i$ 出发后首次返回到 $i$ 所需的步数。如果链永远不返回 $i$，则 $T_i = \infty$。基于此，我们可以定义**[首次返回概率](@entry_id:275671)** $f_{ii} = \mathbb{P}_i(T_i  \infty)$，即从状态 $i$ 出发后，在有限时间内能再次返回到状态 $i$ 的概率。

这个概率是区分[常返态](@entry_id:276969)和暂态的根本依据：

-   如果 $f_{ii} = 1$，意味着从状态 $i$ 出发后，返回到 $i$ 是一个必然事件。我们称这样的状态 $i$ 为**[常返态](@entry_id:276969)**。
-   如果 $f_{ii}  1$，意味着从状态 $i$ 出发后，存在一个正的概率 $1-f_{ii}$ 使得链永远不会再返回到 $i$。我们称这样的状态 $i$ 为**暂态**。

一个特殊但重要的[常返态](@entry_id:276969)是**[吸收态](@entry_id:161036)**。如果一个状态 $i$ 的单步自转移概率 $P(i,i) = 1$，那么一旦进入状态 $i$，链将永远停留在那里。在这种情况下，首次返回时间 $T_i=1$，因此 $f_{ii}=1$，表明[吸收态](@entry_id:161036)是[常返态](@entry_id:276969)的一种特殊情况 [@problem_id:3295756]。

另一个强大的分类工具是**[格林函数](@entry_id:147802) (Green's function)**，它衡量了从状态 $i$ 出发，链在所有时间（包括初始时刻）访问状态 $i$ 的期望总次数。其定义为 $G_{ii} = \sum_{n=0}^{\infty} P^n(i,i)$，其中 $P^n(i,i)$ 是从 $i$ 出发经过 $n$ 步后回到 $i$ 的概率。

[首次返回概率](@entry_id:275671) $f_{ii}$ 与[格林函数](@entry_id:147802) $G_{ii}$ 之间存在一个深刻的联系。通过在每次成功返回状态 $i$ 时应用强[马尔可夫性质](@entry_id:139474)，我们可以将返回过程看作一个[更新过程](@entry_id:273573)。每次返回后，链以概率 $f_{ii}$ 再次尝试返回。因此，在有限时间内恰好返回 $k$ 次的概率服从[几何分布](@entry_id:154371)。访问状态 $i$ 的期望总次数 $G_{ii}$（包括第0步的访问）可以表示为一个[几何级数](@entry_id:158490)之和 [@problem_id:3295756]：

$$
G_{ii} = 1 + \sum_{k=1}^{\infty} f_{ii}^k = \begin{cases} \frac{1}{1 - f_{ii}}  \text{如果 } f_{ii}  1 \\ \infty  \text{如果 } f_{ii} = 1 \end{cases}
$$

这个关系为我们提供了[状态分类](@entry_id:276397)的等价判据：

-   状态 $i$ 是**暂态**当且仅当 $f_{ii}  1$，这等价于 $G_{ii}  \infty$。
-   状态 $i$ 是**[常返态](@entry_id:276969)**当且仅当 $f_{ii} = 1$，这等价于 $G_{ii} = \infty$。

这个等价关系非常有用，因为在某些情况下，计算 $P^n(i,i)$ 的级数和可能比直接计算 $f_{ii}$ 更容易，反之亦然。

### [状态空间](@entry_id:177074)的结构分解

对单个状态的分类固然重要，但[马尔可夫链](@entry_id:150828)的动态行为是由状态之间的相互关系决定的。这些关系将[状态空间分解](@entry_id:175473)为具有一致行为的[子集](@entry_id:261956)。

关键概念是**互通 (communication)**。如果从状态 $i$ 可以通过有限步（概率为正）到达状态 $j$（记为 $i \to j$），并且从 $j$ 也可以到达 $i$（$j \to i$），我们就说状态 $i$ 和 $j$ 是互通的，记为 $i \leftrightarrow j$。互通是一种[等价关系](@entry_id:138275)，它将整个状态空间 $\mathcal{S}$ 分割成若干个不相交的**[互通类](@entry_id:267280) (communicating classes)**。

[状态分类](@entry_id:276397)的一个基本定理是：**常返性和暂态性是类属性**。也就是说，如果一个[互通类](@entry_id:267280)中的某个状态是常返的，那么该类中的所有状态都是常返的。同样，如果某个状态是暂态的，那么该类中的所有状态也都是暂态的。

这使得我们可以将[分类问题](@entry_id:637153)从单个状态提升到对[互通类](@entry_id:267280)的分类。一个[互通类](@entry_id:267280)是常返的还是暂态的，取决于它是否“封闭”。一个状态[子集](@entry_id:261956) $C \subseteq \mathcal{S}$ 被称为**[闭集](@entry_id:136446) (closed set)**，如果从 $C$ 中的任何状态出发，都不可能离开 $C$。换言之，对于所有 $i \in C$ 和 $j \notin C$，都有 $P(i,j) = 0$。

对于一个有限状态[马尔可夫链](@entry_id:150828)，一个[互通类](@entry_id:267280)是常返的当且仅当它是一个[闭集](@entry_id:136446)。如果一个[互通类](@entry_id:267280)不是[闭集](@entry_id:136446)，那么它必然是暂态的，因为存在从该类“泄漏”到其他类的路径，而一旦离开，由于[互通类](@entry_id:267280)的定义，就再也无法返回。

通过识别所有的[互通类](@entry_id:267280)并判断它们是否为[闭集](@entry_id:136446)，我们就可以对整个状态空间进行分解。例如，考虑一个具有状态空间 $\mathcal{S}=\{1,2,3,4,5,6\}$ 和如下[转移矩阵](@entry_id:145510)的马尔可夫链 [@problem_id:3295795]：

$$
P=\begin{pmatrix}
0  \tfrac{1}{2}  \tfrac{1}{4}  \tfrac{1}{4}  0  0\\
\tfrac{1}{4}  \tfrac{1}{4}  0  0  0  \tfrac{1}{2}\\
0  \tfrac{1}{4}  \tfrac{1}{2}  0  \tfrac{1}{4}  0\\
0  0  0  \tfrac{1}{2}  \tfrac{1}{2}  0\\
0  0  0  \tfrac{1}{3}  \tfrac{2}{3}  0\\
0  0  0  0  0  1
\end{pmatrix}
$$

我们可以通过以下步骤来分解[状态空间](@entry_id:177074)：
1.  **识别[互通类](@entry_id:267280)**：通过检查转移概率，我们发现 $1 \leftrightarrow 2 \leftrightarrow 3$（例如 $1 \to 2$，$2 \to 1$），所以 $\mathcal{T}=\{1,2,3\}$ 是一个[互通类](@entry_id:267280)。同样，$4 \leftrightarrow 5$，所以 $\mathcal{R}_1=\{4,5\}$ 是一个[互通类](@entry_id:267280)。最后，$P(6,6)=1$ 意味着状态 $6$ 只与自身互通，形成一个单点类 $\mathcal{R}_2=\{6\}$。
2.  **判断类别**：
    -   对于类 $\mathcal{T}=\{1,2,3\}$，存在从该类到外部的转移，例如 $P(1,4)=\frac{1}{4}0$。因此，这个类不是[闭集](@entry_id:136446)，它是一个**暂态类**。
    -   对于类 $\mathcal{R}_1=\{4,5\}$，从状态 $4$ 和 $5$ 出发的所有转移都停留在 $\mathcal{R}_1$ 内（第4行和第5行的和在第4、5列上为1）。因此，它是一个[闭集](@entry_id:136446)，从而是一个**[常返类](@entry_id:273689)**。
    -   对于类 $\mathcal{R}_2=\{6\}$，状态 $6$ 是一个[吸收态](@entry_id:161036)，显然是一个[闭集](@entry_id:136446)，因此也是一个**[常返类](@entry_id:273689)**。

完成这个分解后，我们可以通过重排状态的次序，将[转移矩阵](@entry_id:145510) $P$ 写成一种**[规范形](@entry_id:153058)式 (canonical form)**。将所有暂态排在前面，然后是各个[常返类](@entry_id:273689)，矩阵会呈现出块上三角结构：

$$
P^* = \begin{pmatrix}
Q  R \\
\mathbf{0}  S
\end{pmatrix}
$$

其中，$Q$ 是暂态之间的转移矩阵，$R$ 是从暂态到[常返态](@entry_id:276969)的[转移矩阵](@entry_id:145510)，$S$ 是[常返类](@entry_id:273689)内部的转移矩阵（自身也是一个或多个[随机矩阵](@entry_id:269622)构成的[块对角矩阵](@entry_id:145530)），$\mathbf{0}$ 是一个[零矩阵](@entry_id:155836)，表示从[常返态](@entry_id:276969)无法回到暂态。对于上述例子，按 $(1,2,3,4,5,6)$ 排序，其矩阵已经是规范形式了，可以分解为 [@problem_id:3295795]：
$$
P^*=\begin{pmatrix}
Q  R_1  R_2\\
\mathbf{0}  S_1  \mathbf{0}\\
\mathbf{0}  \mathbf{0}  S_2
\end{pmatrix}
$$
其中 $Q$ 是 $\mathcal{T}$ 内部的转移， $S_1$ 是 $\mathcal{R}_1$ 内部的转移，$S_2=(1)$ 是 $\mathcal{R}_2$ 的转移。这种分解清晰地揭示了链的长期行为：链最终会离开暂态类 $\mathcal{T}$ 并被某个[常返类](@entry_id:273689)（$\mathcal{R}_1$ 或 $\mathcal{R}_2$）“捕获”。

### 暂态行为的定量分析

对于那些终将被吸收的马尔可夫链，我们不仅关心它“是否”会被吸收，更关心“如何”被吸收。具体而言，我们想知道：从一个暂态出发，平均需要多长时间才会被吸收？以及最终被某个特定[吸收态](@entry_id:161036)捕获的概率是多少？

考虑一个具有暂态集 $\mathcal{T}$ 和吸收态集 $\mathcal{A}$ 的马尔可夫链，其规范形式为 $P = \begin{pmatrix} Q  R \\ \mathbf{0}  I \end{pmatrix}$。这里的 $Q$ 是一个亚[随机矩阵](@entry_id:269622) (sub-stochastic matrix)，因为它的某些行和小于1，代表着逃逸到[吸收态](@entry_id:161036)的概率。

正如之前 $G_{ii} = \sum P^n(i,i)$ 衡量了返回自身的期望次数，我们可以定义一个**[基本矩阵](@entry_id:275638) (fundamental matrix)** $N$，其元素 $N_{ij}$ 表示从暂态 $i$ 出发，在被吸收之前访问暂态 $j$ 的期望次数。这个矩阵可以通过 $Q$ 的幂级数得到：
$$
N = \sum_{k=0}^{\infty} Q^k
$$
由于 $Q$ 的行和小于等于1且链终将被吸收，可以证明 $Q^n \to \mathbf{0}$，因此这个级数收敛，并且等于 $(I-Q)^{-1}$。所以，$N = (I-Q)^{-1}$。

有了[基本矩阵](@entry_id:275638) $N$，我们便可以回答关于吸收过程的定量问题 [@problem_id:3295784]：

1.  **[期望吸收时间](@entry_id:637112)**：从暂态 $i$ 出发，在被吸收之前，总共在暂态集 $\mathcal{T}$ 中停留的期望步数，就是从 $i$ 出发访问所有暂态 $j \in \mathcal{T}$ 的期望次数之和。令 $t_i$ 为从状态 $i$ 开始的[期望吸收时间](@entry_id:637112)，则 $t_i = \sum_{j \in \mathcal{T}} N_{ij}$。如果我们将 $t$ 表示为所有 $t_i$ 组成的列向量，$\mathbf{1}$ 是一个全为1的列向量，那么这个关系可以简洁地写成：
    $$
    t = N \mathbf{1}
    $$
    这个结果也可以通过对 $t_i = 1 + \sum_{j \in \mathcal{T}} Q_{ij} t_j$ 这个[线性方程组](@entry_id:148943)进行求解得到，该[方程组](@entry_id:193238)正是 $(I-Q)t = \mathbf{1}$。

2.  **[吸收概率](@entry_id:265511)**：从暂态 $i$ 出发，最终被特定吸收态 $j$ 捕获的概率是多少？令 $B$ 为一个矩阵，其元素 $B_{ij}$ 表示从暂态 $i$ 最终被[吸收态](@entry_id:161036) $j$ 吸收的概率。通过考虑第一步转移，我们可以建立 $B$ 与 $N$ 和 $R$ 的关系。从暂态 $i$ 到[吸收态](@entry_id:161036) $j$ 的路径，要么在第一步直接通过 $R_{ij}$ 到达，要么先转移到某个暂态 $k$，然后从 $k$ 再被 $j$ 吸收。对所有可能性求和，最终可以得到一个优美的公式：
    $$
    B = NR
    $$

例如，对于一个具有暂态集 $\{1,2,3\}$ 和[吸收集](@entry_id:276239) $\{4,5\}$ 的链，其子矩阵 $Q$ 和 $R$ 为 [@problem_id:3295784]：
$$
Q = \begin{pmatrix} \frac{1}{2}  \frac{3}{10}  0 \\ 0  \frac{2}{5}  \frac{2}{5} \\ 0  0  \frac{1}{5} \end{pmatrix}, \quad R = \begin{pmatrix} \frac{1}{5}  0 \\ \frac{1}{5}  0 \\ \frac{3}{10}  \frac{1}{2} \end{pmatrix}
$$
通过计算 $N=(I-Q)^{-1}$，我们可以求得从状态2出发，最终被状态5吸收的概率。计算得到 $b_{25} = \frac{5}{12}$。这些计算为我们提供了关于暂态动力学的精确预测。

### 高级分析工具

除了基本定义和[矩阵代数](@entry_id:153824)，我们还可以运用更强大的数学工具来分析和理解[状态分类](@entry_id:276397)。

#### 命中概率与无限状态链

在无限[状态空间](@entry_id:177074)中，一个[互通类](@entry_id:267280)中的所有状态都可能是暂态的（例如，一维简单[随机游走](@entry_id:142620)）。在这种情况下，我们需要一个判据来确定链是否会“漂移到无穷远处”。**命中概率 (hitting probability)** 提供了一个有力的工具。

对于状态空间中的一个[子集](@entry_id:261956) $A$，我们定义从状态 $i$ 出发，最终能到达集合 $A$ 的概率为 $h(i) = \mathbb{P}_i(T_A  \infty)$，其中 $T_A = \inf\{t \ge 0 : X_t \in A\}$。显然，如果 $i \in A$，则 $h(i)=1$。对于 $i \notin A$，通过对第一步进行条件分析，可以得到一个[线性方程组](@entry_id:148943)：
$$
h(i) = \sum_{j \in \mathcal{S}} P_{ij} h(j)
$$
这个[方程组](@entry_id:193238)的解（在满足 $0 \le h(i) \le 1$ 条件下的最小非负解）给出了命中概率。

现在，考虑一个无限状态链，我们想判断状态是否暂态。我们可以选择一个有限的集合 $A$，并计算从 $A$ 外部的状态 $i$ 命中 $A$ 的概率 $h(i)$。如果存在某个 $i \notin A$ 使得 $h(i)  1$，这说明从状态 $i$ 出发，有非零的概率永远不会访问集合 $A$。如果从 $i$ 可达的所有状态构成一个[互通类](@entry_id:267280)，那么这个结果就证明了整个[互通类](@entry_id:267280)是暂态的 [@problem_id:3295799]。因为如果这个类是常返的，那么从类中任何一点出发，最终都会以概率1访问类中的任何其他点，包括集合 $A$ 的邻居，并最终有非零概率进入 $A$。反复尝试最终会使得到达 $A$ 的概率为1，这与 $h(i)1$ 矛盾。

例如，对于一个在 $\mathbb{N}_0$ 上的[随机游走](@entry_id:142620)，其向右漂移的概率 $p > 0.5$。若我们关心状态 $\{2,3,\dots\}$ 是否是暂态，我们可以计算它们[命中集](@entry_id:262296)合 $A=\{0,1\}$ 的概率。通过求解相应的递归关系，可以发现对于 $i \ge 2$，命中概率 $h(i)  1$，这直接证明了该链具有向无穷远处漂移的趋势，因此 $\{2,3,\dots\}$ 是暂态的 [@problem_id:3295799]。

#### 谱方法

暂态行为与暂态[转移矩阵](@entry_id:145510) $Q$ 的谱性质密切相关。一个重要的结果是，当且仅当 $Q$ 的**谱半径** $\rho(Q)$（即其模最大的[特征值](@entry_id:154894)的模）严格小于1时，$Q^n$ 的元素才会随着 $n \to \infty$ 收敛到0。这为判断暂态性提供了另一种方法 [@problem_id:3295767]。
$$
\lim_{n\to\infty} Q^n = \mathbf{0} \iff \rho(Q)  1
$$
$\rho(Q)1$ 保证了[基本矩阵](@entry_id:275638)级数 $N = \sum Q^k$ 的收敛。此外，谱半径还提供了一个强大的分析工具，用于在不直接计算矩阵逆的情况下估计[基本矩阵](@entry_id:275638) $N$ 的大小。利用任何相容的[矩阵范数](@entry_id:139520)，我们有 $\rho(Q) \le \|Q\|$。这导致了对 $N$ 的范数的[上界](@entry_id:274738)估计：
$$
\|N\| = \|(I-Q)^{-1}\| \le \sum_{n=0}^{\infty} \|Q^n\| \le \sum_{n=0}^{\infty} \|Q\|^n = \frac{1}{1-\|Q\|}
$$
这个界在 $\|Q\|1$ 时成立。例如，使用[无穷范数](@entry_id:637586) $\|Q\|_{\infty}$（最大行和），我们可以快速得到 $N_{ij}$ 的一个上界，这在分析大型复杂系统时尤其有用 [@problem_id:3295767]。

#### 鞅方法与常返性的细分

[常返态](@entry_id:276969)本身还可以进一步细分。如果一个状态 $i$ 是常返的，我们关心其返回的期望时间 $\mathbb{E}_i[T_i]$。

-   如果 $\mathbb{E}_i[T_i]  \infty$，称状态 $i$ 是**[正常返](@entry_id:195139) (positive recurrent)**。
-   如果 $\mathbb{E}_i[T_i] = \infty$，称状态 $i$ 是**[零常返](@entry_id:276939) (null recurrent)**。

[零常返](@entry_id:276939)是一个微妙的概念：你总是会回来，但平均回来的时间是无限长的。[正常返](@entry_id:195139)、[零常返](@entry_id:276939)和暂态这三种类型对应了马尔可夫链三种截然不同的长期行为。

**[鞅](@entry_id:267779) (Martingale)** 方法为区分这三种情况提供了深刻的见解。通过构造一个关于[马尔可夫链](@entry_id:150828)的（超）[鞅](@entry_id:267779)，并应用[可选停止定理](@entry_id:267890)，我们可以推导出期望命中时间的界或精确值。

考虑一个过程 $M_t = f(X_t) + c \cdot t$，其中 $f$ 是一个测试函数，$c$ 是一个常数。如果我们能选择 $f$ 和 $c$ 使得 $M_t$ 成为一个[鞅](@entry_id:267779)或[超鞅](@entry_id:271504)，那么我们就可以得到关于 $t$ 的信息。例如，在一个一维生灭链中，通过选择合适的测试函数（如线性函数 $f(n)=n$ 或[指数函数](@entry_id:161417) $f(n)=e^{\theta n}$），我们可以分析过程的“漂移” [@problem_id:3295785]。

-   如果存在一个测试函数，使得链有朝向某个集合 $A$ 的负漂移，这通常意味着命中 $A$ 的期望时间是有限的，对应于**[正常返](@entry_id:195139)**。
-   如果漂移为零，期望命中时间通常是无限的，对应于**[零常返](@entry_id:276939)**。
-   如果漂移是正的（远离 $A$），链可能会永远不命中 $A$，对应于**暂态**。

通过这种方法，我们可以精确地计算出在[正常返](@entry_id:195139)情况下（例如，生灭链中[死亡率](@entry_id:197156)大于出生率时）的期望命中时间 [@problem_id:3295785]。

### 精炼与进阶概念

#### 周期性

除了常返性/暂态性，状态还有一个称为**周期 (period)** 的重要属性。状态 $i$ 的周期 $d(i)$ 定义为所有从 $i$ 出发返回 $i$ 的可能步数 $n \ge 1$（即 $P^n(i,i)>0$）的[最大公约数](@entry_id:142947)。如果 $d(i)=1$，状态是**非周期的 (aperiodic)**；如果 $d(i)>1$，状态是**周期的 (periodic)**。

周期性也是一个类属性。周期性本身并不影响一个状态是常返还是暂态。例如，一个确定性的三状态循环 $1 \to 2 \to 3 \to 1$ 中的所有状态都是常返的，但它们的周期都是3 [@problem_id:3295754]。周期性约束了返回可能发生的时间（只能是周期的倍数），但常返性只关心返回事件是否“最终”会发生。一个常见的误解是周期性会妨碍[稳态分布](@entry_id:149079)的存在，但实际上，任何有限状态的不可约[马尔可夫链](@entry_id:150828)（无论是否周期性）都存在唯一的稳态分布 [@problem_id:3295754]。

#### [准稳态分布](@entry_id:753961)

在[吸收马尔可夫链](@entry_id:185661)中，所有轨迹最终都会被吸收。一个自然的问题是：在被吸收之前的很长一段时间里，链在暂态集上的[分布](@entry_id:182848)是怎样的？这个问题的答案由**[准稳态分布](@entry_id:753961) (Quasi-Stationary Distribution, QSD)** 给出。

QSD是一个定义在暂态集 $\mathcal{T}$ 上的[概率分布](@entry_id:146404) $\nu$，它具有这样的性质：如果链在时刻 $n$ 的[分布](@entry_id:182848)是 $\nu$（条件是尚未被吸收），那么在时刻 $n+1$，只要还未被吸收，其[分布](@entry_id:182848)仍然是 $\nu$。数学上，$\nu$ 是暂态转移矩阵 $Q$ 的主左[特征向量](@entry_id:151813)，对应的[特征值](@entry_id:154894) $\lambda_{PF}$（$Q$的谱半径）是单步存活概率 [@problem_id:3295753]。

在某些条件下（例如 $Q$ 是不可约和非周期的），从任何初始暂态[分布](@entry_id:182848)出发，只要链尚未被吸收，其状态[分布](@entry_id:182848)都会收敛到这个唯一的QSD。这个极限被称为**雅格伦极限 (Yaglom limit)** [@problem_id:3295753]。

#### [时间可逆性](@entry_id:274492)

常返性的概念还有一个更深的层面，可以通过**[时间反演](@entry_id:182076) (time reversal)** 来揭示。给定一个具有[不变测度](@entry_id:202044) $\pi$ 的[马尔可夫链](@entry_id:150828)，我们可以定义其时间反演过程。反演链的转移核 $P^*$ 由下式给出：
$$
P^*(j,i) = \frac{\pi(i) P(i,j)}{\pi(j)}
$$
一个非常优美的结果是，对于任何在[不变测度](@entry_id:202044) $\pi$ 支撑集中的状态 $i$，其在原链和反演链下的 $n$ 步返回概率是完全相同的，即 $(P^*)^n(i,i) = P^n(i,i)$ 对所有 $n \ge 1$ 成立 [@problem_id:3295758]。这意味着，一个状态在原链下是常返（或暂态）的，当且仅当它在反演链下也是常返（或暂态）的。这个性质揭示了常返性是一种不依赖于时间方向的内在结构属性。

#### 对时变链的注记

本章讨论的[分类理论](@entry_id:153976)主要针对时齐马尔可夫链。对于**时变 (time-inhomogeneous)** 链，即转移概率 $P_n$ 随时间 $n$ 变化的链，[状态分类](@entry_id:276397)变得异常复杂。一个状态可能在某些时期表现出暂态行为，而在另一些时期表现出常返行为。其长期行为取决于转移概率的累积效应。简单地对转移概率进行[时间平均](@entry_id:267915)（例如，计算 $\bar{P} = \lim \frac{1}{m}\sum P_n$）并不能保证得到正确的分类。在某些情况下，即使平均漂移为零，如果链在“坏”的时期（例如，向无穷远漂移）停留的时间足够长且增长迅速，整个链也可能表现出暂态性 [@problem_id:3295805]。这提醒我们，将时齐理论直接推广到时变情况需要非常谨慎。