{"hands_on_practices": [{"introduction": "在我们运用一个基本定理之前，验证其正确性并建立直观理解是至关重要的。本练习将通过一个具体的例子来验证我们讨论的基石——散度定理 ([@problem_id:3402021])。通过显式计算一个向量场的散度在单位球上的体积分，以及该向量场穿过球面的通量积分，我们将证实二者的恒等关系，并为通量平衡原理建立直观认识，该原理是有限体积法等数值方法的核心。", "problem": "考虑单位球 $B_{1}(0) \\subset \\mathbb{R}^{n}$（其中 $n \\geq 2$）、其边界 $\\partial B_{1}(0) = \\mathbb{S}^{n-1}$，以及由 $\\mathbf{F}(x) = x$ 定义的矢量场 $\\mathbf{F} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$。令 $\\mathbf{n}$ 表示 $\\partial B_{1}(0)$ 上的外向单位法向量。从散度作为雅可比矩阵的迹的定义以及散度定理出发，仅使用关于 $B_{1}(0)$ 的体积和 $\\mathbb{S}^{n-1}$ 的表面积的公认公式，计算积分 $\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx$ 和 $\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$，并通过显式计算验证它们相等。在偏微分方程（PDE）数值解的背景下，将此等式解释为有限体积离散化中单元通量平衡的一致性检验。将这两个积分的共同值以一个关于 $n$ 的单一闭式解析表达式报告。无需四舍五入。", "solution": "问题陈述经评估有效。它具有科学依据，是适定且客观的。它提出了一个矢量微积分中的标准练习，并与偏微分方程数值方法的原理有明确联系。该问题是自洽的，没有矛盾或歧义。\n\n我们现在将分别计算这两个积分，然后验证它们相等，从而得出解答。\n\n首先，我们计算体积分 $\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx$。\n矢量场由 $\\mathbf{F}(x) = x$ 给出，在笛卡尔坐标系中为 $\\mathbf{F}(x_1, \\dots, x_n) = (x_1, \\dots, x_n)$。$\\mathbf{F}$ 的分量为 $F_i(x) = x_i$，其中 $i=1, \\dots, n$。\n\n$\\mathbf{F}$ 的散度定义为其雅可比矩阵的迹。雅可比矩阵 $J_{\\mathbf{F}}$ 的元素为 $(J_{\\mathbf{F}})_{ij} = \\frac{\\partial F_i}{\\partial x_j}$。在本例中，$\\frac{\\partial F_i}{\\partial x_j} = \\frac{\\partial x_i}{\\partial x_j} = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克 delta 符号。因此，雅可比矩阵是 $n \\times n$ 的单位矩阵 $I_n$。\n散度是雅可比矩阵的迹：\n$$\n\\operatorname{div} \\mathbf{F} = \\operatorname{tr}(J_{\\mathbf{F}}) = \\sum_{i=1}^{n} \\frac{\\partial F_i}{\\partial x_i} = \\sum_{i=1}^{n} \\frac{\\partial x_i}{\\partial x_i} = \\sum_{i=1}^{n} 1 = n\n$$\n由于散度是一个常数，体积分的计算很简单：\n$$\n\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx = \\int_{B_{1}(0)} n \\, dx = n \\int_{B_{1}(0)} 1 \\, dx = n \\cdot \\operatorname{Volume}(B_{1}(0))\n$$\n$n$ 维球体（半径为 $R$）的体积由公式 $V_n(R) = \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)} R^n$ 给出。对于单位球 $B_{1}(0)$，我们有 $R=1$，所以其体积为：\n$$\n\\operatorname{Volume}(B_{1}(0)) = V_n(1) = \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)}\n$$\n将此代入我们的积分表达式，得到：\n$$\n\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx = n \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)}\n$$\n\n接下来，我们计算面积分 $\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$。\n单位球 $B_1(0)$ 的边界是单位球面 $\\mathbb{S}^{n-1} = \\{x \\in \\mathbb{R}^n : \\|x\\| = 1\\}$。对于以原点为中心的球面，其表面上一点 $x$ 的外向单位法向量 $\\mathbf{n}$ 与位置向量 $x$ 平行。它由 $\\mathbf{n} = \\frac{x}{\\|x\\|}$ 给出。\n由于我们的曲面是单位球面，对于任何 $x \\in \\mathbb{S}^{n-1}$，都有 $\\|x\\|=1$。因此，外向单位法向量就是 $\\mathbf{n} = x$。\n\n被积函数是点积 $\\mathbf{F} \\cdot \\mathbf{n}$。由于 $\\mathbf{F}(x)=x$ 且 $\\mathbf{n}=x$，我们有：\n$$\n\\mathbf{F}(x) \\cdot \\mathbf{n}(x) = x \\cdot x = \\|x\\|^2\n$$\n因为我们是在单位球面上积分，所以曲面上所有点的 $\\|x\\|=1$。因此，被积函数是常数，等于 $1$：\n$$\n\\mathbf{F} \\cdot \\mathbf{n} = 1^2 = 1\n$$\n面积分变为：\n$$\n\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS = \\int_{\\mathbb{S}^{n-1}} 1 \\, dS = \\operatorname{Area}(\\mathbb{S}^{n-1})\n$$\n这是 $(n-1)$ 维单位球面的表面积。一个半径为 $R$ 的 $(n-1)$ 维球面的表面积公式为 $A_{n-1}(R) = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}R^{n-1}$。对于单位球面，$R=1$，所以其面积为：\n$$\n\\operatorname{Area}(\\mathbb{S}^{n-1}) = A_{n-1}(1) = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}\n$$\n因此，面积分的值为：\n$$\n\\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}\n$$\n\n根据散度定理，这两个积分必须相等。我们现在通过对表达式的显式计算来验证这一点。\n体积分的结果是 $n \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)}$。面积分的结果是 $\\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}$。\n我们使用伽玛函数的基本递推关系式 $\\Gamma(z+1)=z\\Gamma(z)$。令 $z = \\frac{n}{2}$。则我们有：\n$$\n\\Gamma\\left(\\frac{n}{2}+1\\right) = \\frac{n}{2} \\Gamma\\left(\\frac{n}{2}\\right)\n$$\n将此代入体积分的表达式中：\n$$\nn \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2}+1)} = n \\frac{\\pi^{n/2}}{\\frac{n}{2}\\Gamma(\\frac{n}{2})} = \\frac{n \\cdot 2}{n} \\frac{\\pi^{n/2}}{\\Gamma(\\frac{n}{2})} = \\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}\n$$\n这个结果与面积分的值完全相同。因此，通过直接计算验证了等式成立。这两个积分的共同值是 $\\frac{2\\pi^{n/2}}{\\Gamma(\\frac{n}{2})}$。\n\n在偏微分方程数值解的背景下，这个等式是基本守恒律的一种体现。有限体积法建立在守恒律的积分形式之上。对于形式为 $\\frac{\\partial u}{\\partial t} + \\operatorname{div}\\mathbf{J} = s$ 的偏微分方程，其中 $\\mathbf{J}$ 是通量矢量， $s$ 是源项，在一个控制体积（一个单元） $\\Omega_i$ 上积分并应用散度定理可得：\n$$\n\\frac{d}{dt}\\int_{\\Omega_i} u \\, dx + \\int_{\\partial \\Omega_i} \\mathbf{J} \\cdot \\mathbf{n} \\, dS = \\int_{\\Omega_i} s \\, dx\n$$\n这个方程表明，单元中 $u$ 的总量变化率由穿过单元边界的 $\\mathbf{J}$ 的净通量以及单元内部的总源/汇活动所平衡。\n本问题在一个稳态情况（无时间依赖性）下展示了这一点，其中矢量场是 $\\mathbf{F}$，“源”项是 $\\operatorname{div}\\mathbf{F}$，单元是单位球 $B_1(0)$。等式 $\\int_{B_{1}(0)} \\operatorname{div} \\mathbf{F} \\, dx = \\int_{\\partial B_{1}(0)} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$ 是这种精确平衡的解析表达式。有限体积离散化使用单元内部的值来近似体积积分（源项），并使用单元面上的值来近似面积分（通量项）。这两种形式在解析上等价的事实是一个关键的一致性条件。一个鲁棒的数值格式必须尊重这一性质，确保离散散度算子和离散通量计算是相容的。这种单元平衡正是有限体积法具有局部和全局守恒性的原因，这在物理输运现象的模拟中是一个非常理想的属性。在实现更复杂的数值近似之前，通过一个简单案例验证这个恒等式，可以确认其基本原理的有效性。", "answer": "$$\n\\boxed{\\frac{2\\pi^{n/2}}{\\Gamma\\left(\\frac{n}{2}\\right)}}\n$$", "id": "3402021"}, {"introduction": "格林恒等式是散度定理的直接推论，为分析偏微分方程提供了强大工具。本练习 ([@problem_id:3402022]) 侧重于应用格林第二恒等式，以揭示满足拉普拉斯方程的调和函数所具有的一个重要性质。这一结果并非纯粹的理论猎奇，它构成了将区域问题转化为边界问题求解的基础，是边界元方法等现代数值技术的核心思想。", "problem": "考虑半径为 $R>0$ 的三维球体 $B_{R}(0) \\subset \\mathbb{R}^{3}$ 及其边界 $\\partial B_{R}(0)$。令 $u$ 和 $v$ 为在 $\\overline{B_{R}(0)}$ 上二次连续可微且在 $B_{R}(0)$ 上调和的实值函数，即在 $B_{R}(0)$ 上有 $\\Delta u=0$ 和 $\\Delta v=0$，其中 $\\Delta$ 表示拉普拉斯算子。在偏微分方程（PDE）的数值方法中，边界积分公式经常使用散度定理来构建关联解的通量和迹的恒等式。从散度定理和拉普拉斯算子的定义出发，推导将 $\\int_{\\partial B_{R}(0)}(u\\,\\frac{\\partial v}{\\partial n}-v\\,\\frac{\\partial u}{\\partial n})\\,\\mathrm{d}S$ 与 $B_{R}(0)$ 上的体积分关联起来的边界积分恒等式，然后计算在以下特殊情况下的边界积分值：\n$$\nu(x)=\\sum_{l=0}^{L}\\sum_{m=-l}^{l} a_{l m}\\,|x|^{l}\\,Y_{l}^{m}\\!\\left(\\frac{x}{|x|}\\right),\\qquad\nv(x)=\\sum_{l=0}^{L}\\sum_{m=-l}^{l} b_{l m}\\,|x|^{l}\\,Y_{l}^{m}\\!\\left(\\frac{x}{|x|}\\right),\n$$\n其中 $L\\geq 1$ 为固定整数，$a_{l m}$ 和 $b_{l m}$ 为实系数，$\\{Y_{l}^{m}\\}_{l\\geq 0,\\,-l\\leq m\\leq l}$ 是单位球面 $S^{2}$ 上的实球谐函数，关于 $S^{2}$ 上的曲面积分测度 $\\mathrm{d}\\omega$ 是标准正交的，因此\n$$\n\\int_{S^{2}} Y_{l}^{m}(\\omega)\\,Y_{k}^{n}(\\omega)\\,\\mathrm{d}\\omega=\\delta_{l k}\\,\\delta_{m n}.\n$$\n此处 $\\delta_{l k}$ 表示克罗内克δ函数，$\\frac{\\partial}{\\partial n}$ 是 $\\partial B_{R}(0)$ 上的外法向导数，$\\mathrm{d}S$ 是 $\\partial B_{R}(0)$ 上的曲面积分测度。您的最终结果必须是精确表达式。无需四舍五入。给出以下表达式的精确值\n$$\nI(R)=\\int_{\\partial B_{R}(0)}\\left(u\\,\\frac{\\partial v}{\\partial n}-v\\,\\frac{\\partial u}{\\partial n}\\right)\\,\\mathrm{d}S.\n$$", "solution": "该问题的分析将分两个阶段进行。首先，我将使用散度定理推导将指定的边界积分与体积分关联起来的一般积分恒等式。这被称为格林第二恒等式。其次，我将此恒等式应用于调和函数 $u$ 和 $v$ 的特定情况，以计算积分 $I(R)$。然后，通过直接计算边界积分来明确验证该结果。\n\n令 $V$ 为 $\\mathbb{R}^{3}$ 中的一个紧致区域，其边界 $\\partial V$ 是分片光滑的。令 $\\mathbf{F}$ 为在包含 $V$ 的一个开集上连续可微的向量场。散度定理表述如下：\n$$\n\\int_{V} (\\nabla \\cdot \\mathbf{F}) \\, \\mathrm{d}V = \\oint_{\\partial V} (\\mathbf{F} \\cdot \\mathbf{n}) \\, \\mathrm{d}S\n$$\n其中 $\\mathbf{n}$ 是 $\\partial V$ 上的单位外法向量。\n\n为推导格林恒等式，我们为 $\\mathbf{F}$ 选择一个涉及两个标量函数（比如 $\\phi$ 和 $\\psi$）的特定形式，并假设它们在 $V$ 上是二次连续可微的。令 $\\mathbf{F} = \\phi \\nabla \\psi$。该向量场的分量为 $F_i = \\phi \\frac{\\partial \\psi}{\\partial x_i}$。\n\n$\\mathbf{F}$ 的散度由乘法法则给出：\n$$\n\\nabla \\cdot \\mathbf{F} = \\nabla \\cdot (\\phi \\nabla \\psi) = (\\nabla \\phi) \\cdot (\\nabla \\psi) + \\phi (\\nabla \\cdot \\nabla \\psi) = \\nabla \\phi \\cdot \\nabla \\psi + \\phi \\Delta \\psi\n$$\n边界上的项变为：\n$$\n\\mathbf{F} \\cdot \\mathbf{n} = (\\phi \\nabla \\psi) \\cdot \\mathbf{n} = \\phi (\\nabla \\psi \\cdot \\mathbf{n}) = \\phi \\frac{\\partial \\psi}{\\partial n}\n$$\n其中 $\\frac{\\partial \\psi}{\\partial n}$ 是 $\\psi$ 在外法线 $\\mathbf{n}$ 方向上的方向导数。\n\n将这些表达式代入散度定理，得到格林第一恒等式：\n$$\n\\int_{V} (\\nabla \\phi \\cdot \\nabla \\psi + \\phi \\Delta \\psi) \\, \\mathrm{d}V = \\oint_{\\partial V} \\phi \\frac{\\partial \\psi}{\\partial n} \\, \\mathrm{d}S\n$$\n现在，我们令 $\\phi=u$ 和 $\\psi=v$，其中 $u$ 和 $v$ 是问题陈述中给出的函数。该恒等式变为：\n$$\n\\int_{B_{R}(0)} (\\nabla u \\cdot \\nabla v + u \\Delta v) \\, \\mathrm{d}V = \\int_{\\partial B_{R}(0)} u \\frac{\\partial v}{\\partial n} \\, \\mathrm{d}S\n$$\n由于该恒等式对任何一对足够光滑的函数都成立，我们可以交换 $u$ 和 $v$ 的角色：\n$$\n\\int_{B_{R}(0)} (\\nabla v \\cdot \\nabla u + v \\Delta u) \\, \\mathrm{d}V = \\int_{\\partial B_{R}(0)} v \\frac{\\partial u}{\\partial n} \\, \\mathrm{d}S\n$$\n从第一个方程中减去第二个方程，并注意到标量积是对称的（$\\nabla u \\cdot \\nabla v = \\nabla v \\cdot \\nabla u$），我们得到格林第二恒等式：\n$$\n\\int_{B_{R}(0)} (u \\Delta v - v \\Delta u) \\, \\mathrm{d}V = \\int_{\\partial B_{R}(0)} \\left(u \\frac{\\partial v}{\\partial n} - v \\frac{\\partial u}{\\partial n}\\right) \\, \\mathrm{d}S\n$$\n这个恒等式提供了所要求的边界积分 $I(R)$ 与球体 $B_{R}(0)$ 上的体积分之间的关系。\n\n现在，我们继续计算积分 $I(R)$。问题陈述指出函数 $u$ 和 $v$ 在 $B_{R}(0)$ 上是调和的。根据定义，如果一个函数的拉普拉斯算子为零，则该函数是调和的。因此，我们有：\n$$\n\\Delta u = 0 \\quad \\text{and} \\quad \\Delta v = 0 \\quad \\text{for all } x \\in B_{R}(0)\n$$\n为 $u$ 和 $v$ 提供的显式形式由立体谐波 $r^{l}Y_{l}^{m}(\\omega)$ 的线性组合构成，已知这些是调和函数，因此满足此条件。\n\n将 $\\Delta u = 0$ 和 $\\Delta v = 0$ 代入格林第二恒等式，体积分变为：\n$$\n\\int_{B_{R}(0)} (u \\cdot 0 - v \\cdot 0) \\, \\mathrm{d}V = \\int_{B_{R}(0)} 0 \\, \\mathrm{d}V = 0\n$$\n因此，边界积分的值为：\n$$\nI(R) = \\int_{\\partial B_{R}(0)} \\left(u \\frac{\\partial v}{\\partial n} - v \\frac{\\partial u}{\\partial n}\\right) \\, \\mathrm{d}S = 0\n$$\n这个结果是调和函数的一个基本性质。\n\n为求完整并作为严格的验证，我们也可以使用给定的 $u$ 和 $v$ 的表达式直接计算边界积分。\n边界 $\\partial B_{R}(0)$ 是半径为 $R$ 的球面。在球坐标中，边界上的点 $x$ 可以写为 $x = R\\omega$，其中 $\\omega$ 是单位球面 $S^2$ 上的一个点。曲面积分测度为 $\\mathrm{d}S = R^2 \\mathrm{d}\\omega$。外法向导数是径向导数，即 $\\frac{\\partial}{\\partial n} = \\frac{\\partial}{\\partial r}$。\n\n让我们计算在边界 $|x|=r=R$ 上的函数及其法向导数。\n$$\nu(x)\\Big|_{r=R} = \\sum_{l=0}^{L}\\sum_{m=-l}^{l} a_{l m}\\,R^{l}\\,Y_{l}^{m}(\\omega)\n$$\n$$\nv(x)\\Big|_{r=R} = \\sum_{k=0}^{L}\\sum_{n=-k}^{k} b_{k n}\\,R^{k}\\,Y_{k}^{n}(\\omega)\n$$\n（我们对 $v$ 使用不同的索引 $(k,n)$ 以避免混淆。）\n$u$ 的法向导数为：\n$$\n\\frac{\\partial u}{\\partial n} = \\frac{\\partial}{\\partial r} \\left( \\sum_{l=0}^{L}\\sum_{m=-l}^{l} a_{l m}\\,r^{l}\\,Y_{l}^{m}(\\omega) \\right) = \\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{l m}\\,l r^{l-1}\\,Y_{l}^{m}(\\omega)\n$$\n请注意，$l=0$ 的项是一个常数，其关于 $r$ 的导数为零。在 $r=R$ 时：\n$$\n\\frac{\\partial u}{\\partial n}\\Big|_{r=R} = \\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{l m}\\,l R^{l-1}\\,Y_{l}^{m}(\\omega)\n$$\n同理，对 $v$ 有：\n$$\n\\frac{\\partial v}{\\partial n}\\Big|_{r=R} = \\sum_{k=1}^{L}\\sum_{n=-k}^{k} b_{k n}\\,k R^{k-1}\\,Y_{k}^{n}(\\omega)\n$$\n积分 $I(R)$ 由两项组成。我们来计算第一项 $u \\frac{\\partial v}{\\partial n}$ 的积分：\n$$\n\\int_{\\partial B_{R}(0)} u\\,\\frac{\\partial v}{\\partial n}\\,\\mathrm{d}S = \\int_{S^2} \\left(\\sum_{l,m} a_{lm} R^l Y_l^m(\\omega)\\right) \\left(\\sum_{k,n} b_{kn} k R^{k-1} Y_k^n(\\omega)\\right) R^2\\,\\mathrm{d}\\omega\n$$\n$$\n= \\sum_{l,m}\\sum_{k,n} a_{lm} b_{kn} k R^{l+k+1} \\int_{S^2} Y_l^m(\\omega) Y_k^n(\\omega)\\,\\mathrm{d}\\omega\n$$\n使用标准正交条件 $\\int_{S^2} Y_{l}^{m}(\\omega)\\,Y_{k}^{n}(\\omega)\\,\\mathrm{d}\\omega=\\delta_{l k}\\,\\delta_{m n}$：\n$$\n= \\sum_{l,m}\\sum_{k,n} a_{lm} b_{kn} k R^{l+k+1} \\delta_{lk}\\delta_{mn}\n$$\n克罗内克δ函数使得对 $k$ 和 $n$ 的求和坍缩，令 $k=l$ 和 $n=m$。对 $k$ 从 $1$ 开始的求和意味着最终对 $l$ 的求和也从 $1$ 开始。\n$$\n= \\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{lm} b_{lm} l R^{2l+1}\n$$\n现在我们计算第二项 $v \\frac{\\partial u}{\\partial n}$ 的积分：\n$$\n\\int_{\\partial B_{R}(0)} v\\,\\frac{\\partial u}{\\partial n}\\,\\mathrm{d}S = \\int_{S^2} \\left(\\sum_{l,m} b_{lm} R^l Y_l^m(\\omega)\\right) \\left(\\sum_{k,n} a_{kn} k R^{k-1} Y_k^n(\\omega)\\right) R^2\\,\\mathrm{d}\\omega\n$$\n$$\n= \\sum_{l,m}\\sum_{k,n} b_{lm} a_{kn} k R^{l+k+1} \\int_{S^2} Y_l^m(\\omega) Y_k^n(\\omega)\\,\\mathrm{d}\\omega\n$$\n$$\n= \\sum_{l,m}\\sum_{k,n} b_{lm} a_{kn} k R^{l+k+1} \\delta_{lk}\\delta_{mn} = \\sum_{l=1}^{L}\\sum_{m=-l}^{l} b_{lm} a_{lm} l R^{2l+1}\n$$\n由于系数的乘法是可交换的（$a_{lm}b_{lm} = b_{lm}a_{lm}$），这个表达式与第一个表达式相同。\n两项相减得到 $I(R)$：\n$$\nI(R) = \\left(\\sum_{l=1}^{L}\\sum_{m=-l}^{l} a_{lm} b_{lm} l R^{2l+1}\\right) - \\left(\\sum_{l=1}^{L}\\sum_{m=-l}^{l} b_{lm} a_{lm} l R^{2l+1}\\right) = 0\n$$\n直接计算验证了应用格林第二恒等式得到的结果。该积分的值为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "3402022"}, {"introduction": "理论的最终目标往往是构建稳健的数值求解器。这项综合性练习 ([@problem_id:3402011]) 将引导您从零开始，利用格林第三恒等式为拉普拉斯方程构建一个完整的边界元方法 (BEM) 求解器。您将亲手离散化边界积分方程，实施数值方案，并用它来研究计算科学中的一个关键问题：在面对具有挑战性的几何结构时，不同积分方程提法（单层与双层势）的数值稳定性。", "problem": "考虑一个标量场 $u$ 在有界多连通域中满足 $\\Delta u = 0$ 的二维拉普拉斯方程。设 $\\Omega \\subset \\mathbb{R}^2$ 是以原点为中心、半径为 $R_0$ 的外圆内部，并从中移除了两个圆形孔洞。每个孔洞都是半径为 $r$ 的圆，中心位于 $(\\pm c, 0)$，其中 $c = r + g/2$，$g > 0$ 是孔洞之间的间隙。$\\Omega$ 的边界是 $\\Gamma = \\Gamma_0 \\cup \\Gamma_1 \\cup \\Gamma_2$ 的不交并集，其中 $\\Gamma_0$ 是外边界，$\\Gamma_1, \\Gamma_2$ 是两个孔洞的边界。假设 $\\Gamma_0$ 是逆时针定向的，$\\Gamma_1, \\Gamma_2$ 是顺时针定向的，因此单位法向量 $\\mathbf{n}$ 总是从 $\\Omega$ 向外指向。任务是使用格林第三恒等式和散度定理推导调和插值的边界积分公式，然后构建一个计算方案来求解内部狄利克雷问题，最后研究当孔洞趋于接触时，单层表示法与双层表示法各自的稳定性。\n\n基本基础：\n- 在 $\\Omega$ 中的拉普拉斯方程 $\\Delta u = 0$ 且在边界 $\\Gamma$ 上具有狄利克雷边界条件 $u = g$ 的问题，若 $g$ 连续，则有唯一解。\n- 二维拉普拉斯算子的自由空间格林函数为 $G(\\mathbf{x}, \\mathbf{y}) = -\\dfrac{1}{2\\pi} \\log \\|\\mathbf{x} - \\mathbf{y}\\|$。\n- 格林第三恒等式指出，对于 $\\mathbf{x} \\in \\Omega$ 且在 $\\Omega$ 中具有足够光滑性的调和函数 $u$，\n$$\nu(\\mathbf{x}) = \\int_{\\Gamma} \\left( \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} u(\\mathbf{y}) - G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u}{\\partial n}(\\mathbf{y}) \\right) \\, ds(\\mathbf{y}).\n$$\n- 单层势和双层势定义为\n$$\n(\\mathcal{S}\\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, ds(\\mathbf{y}), \\quad\n(\\mathcal{D}\\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} \\, \\mu(\\mathbf{y}) \\, ds(\\mathbf{y}),\n$$\n其边界迹（从 $\\Omega$ 内部取极限）由下式给出\n$$\n\\gamma^{-} \\mathcal{S} \\sigma = S \\sigma \\quad \\text{(连续)}, \\qquad\n\\gamma^{-} \\mathcal{D} \\mu = \\left( \\frac{1}{2} I + K \\right) \\mu,\n$$\n其中边界积分算子 $S$ 和 $K$ 的核函数为\n$$\nS(\\mathbf{x}, \\mathbf{y}) = G(\\mathbf{x}, \\mathbf{y}), \\qquad\nK(\\mathbf{x}, \\mathbf{y}) = \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} = \\frac{1}{2\\pi} \\frac{\\mathbf{n}(\\mathbf{y}) \\cdot (\\mathbf{x} - \\mathbf{y})}{\\|\\mathbf{x} - \\mathbf{y}\\|^2}.\n$$\n\n问题：\n1. 仅使用上述基本定义和散度定理，推导在 $\\Omega$ 中具有给定边界数据 $u=g$ on $\\Gamma$ 的内部狄利克雷问题的边界积分方程，使用：\n   - 单层表示 $u = \\mathcal{S}\\sigma$，导出第一类边界积分方程 $S \\sigma = g$ on $\\Gamma$。\n   - 双层表示 $u = \\mathcal{D}\\mu$，导出第二类边界积分方程 $\\left(\\dfrac{1}{2} I + K\\right) \\mu = g$ on $\\Gamma$。\n   证明这两种表示法为何都有效，并讨论第一类和第二类积分方程在数值稳定性（条件数）方面的预期差异，特别是当边界相互接近时。\n\n2. 开发一个基于 Nyström 离散化的数值方案，使用参数化圆上的周期性梯形法则来求解未知的边界密度 $\\sigma$ 和 $\\mu$。角度以弧度为单位。为使方案鲁棒且简单，对对数核函数应用一个小的局部正则化，即将 $\\|\\mathbf{x} - \\mathbf{y}\\|$ 替换为 $\\sqrt{\\|\\mathbf{x} - \\mathbf{y}\\|^2 + \\varepsilon^2}$，这既用于对数函数内部，也用于平方反比分母中，其中 $\\varepsilon$ 选择为每个边界分量上局部弧长间距的一半。明确说明你使用的所有参数化、单位法向量和求积权重。\n\n3. 选择调和“真值”场为 $z^3$ 的实部，即\n$$\nu^{\\star}(x, y) = \\operatorname{Re}\\{(x + i y)^3\\} = x^3 - 3 x y^2,\n$$\n它在整个 $\\mathbb{R}^2$ 上是调和的。用它来在所有边界分量上设置狄利克雷数据 $g = u^{\\star}$。在求解边界积分方程后，通过在指定的目标点上评估层势来插值 $\\Omega$ 内部的调和解，并报告相对于目标集上的 $u^{\\star}$ 的相对 $\\ell^2$ 误差。\n\n4. 稳定性研究：对于当两个内边界相互接近时增加的几何难度，计算两种表示法的离散系统矩阵的谱条件数（$\\ell^2$ 范数下最大奇异值与最小奇异值的比值）。讨论条件数如何随间隙 $g$ 变化，并比较单层与双层表示法。\n\n必须严格遵循的实现细节：\n- 几何：外边界使用 $R_0 = 1$。两个内边界均使用 $r = 0.2$。对于给定的间隙 $g$，设置 $c = r + g/2$，中心位于 $(\\pm c, 0)$。\n- 边界离散化：在 $\\Gamma_0$（外圆）上使用 $N_0 = 160$ 个求积节点，在每个内圆上使用 $N_1 = N_2 = 80$ 个节点。使用均匀角度 $\\theta \\in [0, 2\\pi)$。\n- 法向量：取从 $\\Omega$ 指出的法向量。对于角度为 $\\theta$ 的外边界点，使用 $\\mathbf{n}_0(\\theta) = (\\cos \\theta, \\sin \\theta)$。对于中心在 $(\\pm c, 0)$ 的孔洞上角度为 $\\theta$ 的内边界点，使用 $\\mathbf{n}_{\\text{inner}}(\\theta) = -(\\cos \\theta, \\sin \\theta)$。\n- 求积权重：在半径为 $R$ 的圆上，弧长元素为 $ds = R \\, d\\theta$。使用梯形权重 $w = R \\cdot \\dfrac{2\\pi}{N}$。\n- 核函数正则化：在对数和平方反比分母中，将 $\\|\\mathbf{x} - \\mathbf{y}\\|$ 替换为 $\\sqrt{\\|\\mathbf{x} - \\mathbf{y}\\|^2 + \\varepsilon^2}$；设源点的 $\\varepsilon$ 为其局部弧长间距的一半。\n- 用于误差估计的内部目标点：使用以下九个点的集合\n$$\n\\{(0, y): y \\in \\{-0.75, -0.5, -0.25, 0, 0.25, 0.5, 0.75\\}\\} \\cup \\{(0.5, 0.5), (-0.5, 0.5)\\}.\n$$\n在下述所有测试案例中，这些点必须位于 $\\Omega$ 内部。\n\n测试套件：\n- 使用三个间隙值 $g \\in \\{0.3, 0.1, 0.03\\}$。\n- 对每个 $g$，求解并评估两种表示法：单层（记为 \"single\"）和双层（记为 \"double\"）。\n- 对每种情况，计算：\n  1. 系统矩阵的谱条件数。\n  2. 在九个目标点上，插值解相对于 $u^{\\star}$ 的相对 $\\ell^2$ 误差。\n\n最终输出规范：\n- 你的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个条目是一个测试案例的 $[\\text{条件数}, \\text{相对误差}]$ 对，顺序如下：\n  - $(g=0.3, \\text{single})$, $(g=0.3, \\text{double})$, $(g=0.1, \\text{single})$, $(g=0.1, \\text{double})$, $(g=0.03, \\text{single})$, $(g=0.03, \\text{double})$。\n- 每对必须是两个浮点数的列表。例如，正确格式的输出是：\n  - [[cond_03_single,err_03_single],[cond_03_double,err_03_double],...,[cond_003_double,err_003_double]]\n不涉及物理单位。所有角度必须以弧度为单位。代码必须是一个完整的、可运行的程序，不需要用户输入，并遵守指定的执行环境。数值方案必须直接从上述原理和定义实现，除了梯形法则和所述的正则化之外，不得引用或使用任何预先推导的捷径求积公式。", "solution": "该问题被评估为有效。它在科学上基于偏微分方程和势理论，是适定的、客观的，并为数值实验提供了一套完整且一致的定义和参数。我们可以继续进行求解。\n\n### 第1部分：边界积分方程的推导和稳定性\n\n目标是在域 $\\Omega \\subset \\mathbb{R}^2$ 中求解拉普拉斯方程 $\\Delta u = 0$，并在边界 $\\Gamma = \\partial \\Omega$ 上满足给定的狄利克雷边界条件 $u = g$。\n\n**单层表示法：**\n我们寻求一个单层势形式的解，\n$$\nu(\\mathbf{x}) = (\\mathcal{S}\\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\sigma(\\mathbf{y}) \\, ds(\\mathbf{y})\n$$\n其中 $\\sigma(\\mathbf{y})$ 是定义在边界 $\\Gamma$ 上的未知密度函数。对于任何可积密度 $\\sigma$，这样定义的势 $u(\\mathbf{x})$ 在 $\\Omega$ 中是调和的。为了满足边界条件，我们必须强制当 $\\mathbf{x} \\in \\Omega$ 趋近于边界 $\\Gamma$ 时，$u(\\mathbf{x}) \\to g(\\mathbf{x})$。\n\n已知单层势 $\\mathcal{S}\\sigma$ 在边界 $\\Gamma$ 上是连续的。因此，当 $\\mathbf{x}$ 从 $\\Omega$ 内部趋近于 $\\mathbf{z} \\in \\Gamma$ 时，取 $u(\\mathbf{x})$ 的极限得到：\n$$\n\\gamma^{-} u(\\mathbf{z}) = \\gamma^{-} (\\mathcal{S}\\sigma)(\\mathbf{z}) = (S\\sigma)(\\mathbf{z})\n$$\n其中 $S$ 是核函数为 $S(\\mathbf{z}, \\mathbf{y}) = G(\\mathbf{z}, \\mathbf{y})$ 的边界积分算子。在 $\\Gamma$ 上施加狄利克雷条件 $u=g$ 导致了未知密度 $\\sigma$ 的边界积分方程 (BIE)：\n$$\n(S\\sigma)(\\mathbf{z}) = g(\\mathbf{z}), \\quad \\mathbf{z} \\in \\Gamma.\n$$\n这是一个第一类弗雷德霍姆积分方程。\n\n**双层表示法：**\n或者，我们寻求一个双层势形式的解，\n$$\nu(\\mathbf{x}) = (\\mathcal{D}\\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial n(\\mathbf{y})} \\mu(\\mathbf{y}) \\, ds(\\mathbf{y})\n$$\n其中 $\\mu(\\mathbf{y})$ 是未知密度函数。这个势在 $\\Omega$ 中也是调和的。与单层势不同，双层势在边界上存在跳跃间断。给出的从内部取极限的迹公式为：\n$$\n\\gamma^{-} u(\\mathbf{z}) = \\gamma^{-} (\\mathcal{D}\\mu)(\\mathbf{z}) = \\left( \\frac{1}{2} I + K \\right) \\mu (\\mathbf{z})\n$$\n其中 $I$ 是恒等算子，$K$ 是核函数为 $K(\\mathbf{z}, \\mathbf{y}) = \\frac{\\partial G(\\mathbf{z}, \\mathbf{y})}{\\partial n(\\mathbf{y})}$ 的边界积分算子。为了满足狄利克雷条件 $u=g$，我们将内部迹设为 $g$：\n$$\n\\left( \\frac{1}{2} I + K \\right) \\mu (\\mathbf{z}) = g(\\mathbf{z}), \\quad \\mathbf{z} \\in \\Gamma.\n$$\n这是一个第二类弗雷德霍姆积分方程。\n\n**关于数值稳定性的讨论：**\n第一类弗雷德霍姆积分方程，如 $S\\sigma = g$，通常是不适定的。算子 $S$ 具有对数核，在典型的函数空间（例如 $L^2(\\Gamma)$）上是紧算子。对于一个紧算子，其离散表示的奇异值倾向于聚集在零点。这意味着矩阵求逆是不稳定的，导致条件数很大，并且通常随着离散化精度的提高而增长。从物理上看，$S$ 是一个平滑算子，从平滑的数据 $g$ 中恢复可能不平滑的密度 $\\sigma$ 是一个不稳定的过程。\n\n相比之下，第二类弗雷德霍姆积分方程 $(A+T)\\phi=f$，其中 $T$ 是紧算子而 $A$ 可逆（这里 $A=\\frac{1}{2}I$），通常是适定的。算子 $(\\frac{1}{2}I + K)$ 的特征值因恒等分量而被移离零点。对于内部狄利克雷问题，已知 $-\\frac{1}{2}$ 不在 $K$ 的谱中，这保证了算子是可逆的，并且问题是适定的。由此产生的线性系统通常是良态的。\n\n当边界相互接近时（即间隙 $g \\to 0$），对于位于相对边界上的点 $\\mathbf{x}$ 和 $\\mathbf{y}$，核函数 $S(\\mathbf{x}, \\mathbf{y})$ 和 $K(\\mathbf{x}, \\mathbf{y})$ 变得近似奇异。这通常会恶化两种表示法的矩阵条件数。然而，预计这种效应对第一类方程的影响要严重得多，其条件数的增长速度应远快于第二类方程。\n\n### 第2部分：数值方案 - Nyström 离散化\n\n我们将边界 $\\Gamma$ 离散化为一组 $N$ 个节点 $\\{\\mathbf{x}_j\\}_{j=1}^N$。总边界为 $\\Gamma = \\Gamma_0 \\cup \\Gamma_1 \\cup \\Gamma_2$，分别用 $N_0, N_1, N_2$ 个点离散，使得 $N = N_0 + N_1 + N_2$。\n\n**边界参数化和求积：**\n- 外圆 $\\Gamma_0$：半径 $R_0 = 1$，中心 $(0,0)$。对于 $j=1, \\dots, N_0$：\n  $$ \\theta_j = \\frac{2\\pi j}{N_0}, \\quad \\mathbf{x}_j = (R_0 \\cos \\theta_j, R_0 \\sin \\theta_j), \\quad \\mathbf{n}_j = (\\cos \\theta_j, \\sin \\theta_j) $$\n  求积权重为 $w_j = R_0 \\frac{2\\pi}{N_0}$。\n- 内圆 $\\Gamma_1$：半径 $r=0.2$，中心 $(c, 0)$，其中 $c=r+g/2$。对于 $j=1, \\dots, N_1$：\n  $$ \\theta_j = \\frac{2\\pi j}{N_1}, \\quad \\mathbf{x}_{N_0+j} = (c + r \\cos \\theta_j, r \\sin \\theta_j), \\quad \\mathbf{n}_{N_0+j} = -(\\cos \\theta_j, \\sin \\theta_j) $$\n  求积权重为 $w_{N_0+j} = r \\frac{2\\pi}{N_1}$。\n- 内圆 $\\Gamma_2$：半径 $r=0.2$，中心 $(-c, 0)$。对于 $j=1, \\dots, N_2$：\n  $$ \\theta_j = \\frac{2\\pi j}{N_2}, \\quad \\mathbf{x}_{N_0+N_1+j} = (-c + r \\cos \\theta_j, r \\sin \\theta_j), \\quad \\mathbf{n}_{N_0+N_1+j} = -(\\cos \\theta_j, \\sin \\theta_j) $$\n  求积权重为 $w_{N_0+N_1+j} = r \\frac{2\\pi}{N_2}$。\n\n使用 Nyström 方法和周期梯形法则将积分方程近似为线性系统。积分 $\\int_\\Gamma f(\\mathbf{y}) ds(\\mathbf{y})$ 近似为 $\\sum_{j=1}^N f(\\mathbf{x}_j) w_j$。\n\n**矩阵组装：**\n设 $\\{\\mathbf{x}_i\\}_{i=1}^N$ 是所有 $N$ 个边界节点的集合。\n\n- **单层矩阵 ($S$)：** 方程 $S\\sigma=g$ 变为线性系统 $\\mathbf{S}\\boldsymbol{\\sigma} = \\mathbf{g}$，其中 $\\boldsymbol{\\sigma}$ 是密度值 $\\sigma(\\mathbf{x}_j)$ 的向量，$\\mathbf{g}$ 是边界数据 $g(\\mathbf{x}_i)$ 的向量。矩阵元素为：\n  $$ S_{ij} = G_{\\text{reg}}(\\mathbf{x}_i, \\mathbf{x}_j) w_j $$\n  其中正则化的格林函数为 $G_{\\text{reg}}(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi} \\log \\sqrt{\\|\\mathbf{x}-\\mathbf{y}\\|^2 + \\varepsilon_j^2}$。正则化参数 $\\varepsilon_j$ 取决于源点 $\\mathbf{x}_j$，并设为其弧长间距的一半：$\\varepsilon_j = w_j/2$。当 $i=j$ 时，$\\|\\mathbf{x}_i - \\mathbf{x}_j\\|=0$，此时元素为 $S_{ii} = -\\frac{1}{2\\pi} \\log(\\varepsilon_i) w_i$。\n\n- **双层矩阵 ($\\frac{1}{2}I+K$)：** 方程 $(\\frac{1}{2}I+K)\\mu=g$ 变为系统 $\\mathbf{A}\\boldsymbol{\\mu}=\\mathbf{g}$。矩阵 $\\mathbf{A}$ 的元素为：\n  $$ A_{ij} = \\frac{1}{2}\\delta_{ij} + K_{\\text{reg}}(\\mathbf{x}_i, \\mathbf{x}_j) w_j $$\n  其中 $\\delta_{ij}$ 是克罗内克 delta。正则化的核函数为\n  $$ K_{\\text{reg}}(\\mathbf{x}_i, \\mathbf{x}_j) = \\frac{1}{2\\pi} \\frac{\\mathbf{n}_j \\cdot (\\mathbf{x}_i - \\mathbf{x}_j)}{\\|\\mathbf{x}_i - \\mathbf{x}_j\\|^2 + \\varepsilon_j^2} $$\n  对于对角线元素 ($i=j$)，分子 $\\mathbf{n}_j \\cdot (\\mathbf{x}_j - \\mathbf{x}_j) = 0$，因此 $K_{\\text{reg}}(\\mathbf{x}_j, \\mathbf{x}_j)=0$。这简化了对角线矩阵元素为 $A_{jj} = \\frac{1}{2}$。\n\n### 第3部分：解的评估和误差分析\n\n一旦求解出密度向量（$\\boldsymbol{\\sigma}$ 或 $\\boldsymbol{\\mu}$）的线性系统，便可以通过评估相应的离散化势来找到任意内部目标点 $\\mathbf{z}$ 处的解 $u$。\n\n- **单层插值：**\n  $$ u(\\mathbf{z}) \\approx \\sum_{j=1}^N G(\\mathbf{z}, \\mathbf{x}_j) \\sigma_j w_j $$\n- **双层插值：**\n  $$ u(\\mathbf{z}) \\approx \\sum_{j=1}^N \\frac{\\partial G(\\mathbf{z}, \\mathbf{x}_j)}{\\partial n(\\mathbf{x}_j)} \\mu_j w_j $$\n请注意，对于内部目标点 $\\mathbf{z}$，$\\|\\mathbf{z}-\\mathbf{x}_j\\| \\neq 0$，因此核函数不需要正则化。\n\n数值解的准确性通过在内部目标点集 $\\{\\mathbf{z}_k\\}_{k=1}^M$ 上与已知的“真值”解 $u^{\\star}(x, y) = x^3 - 3 x y^2$ 进行比较来评估。相对 $\\ell^2$ 误差计算如下：\n$$\n\\text{Error} = \\frac{\\sqrt{\\sum_{k=1}^M |u(\\mathbf{z}_k) - u^{\\star}(\\mathbf{z}_k)|^2}}{\\sqrt{\\sum_{k=1}^M |u^{\\star}(\\mathbf{z}_k)|^2}}\n$$\n\n### 第4部分：稳定性分析\n\n离散系统的稳定性通过系统矩阵的谱条件数 $\\text{cond}(\\mathbf{A}) = \\|\\mathbf{A}\\|_2 \\|\\mathbf{A}^{-1}\\|_2$ 来衡量。这是矩阵 $\\mathbf{A}$ 的最大奇异值与最小奇异值之比。大的条件数表示解对输入数据的扰动高度敏感，预示着数值不稳定性。我们将针对不同间隙 $g$ 值，计算单层矩阵 $\\mathbf{S}$ 和双层矩阵 $\\mathbf{A} = \\frac{1}{2}\\mathbf{I} + \\mathbf{K}$ 的条件数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 2D Laplace BIE problem for a multiply connected domain,\n    analyzes conditioning and error for single- and double-layer formulations.\n    \"\"\"\n    \n    # --- Problem Parameters ---\n    R0 = 1.0\n    r = 0.2\n    N0 = 160\n    N1 = 80\n    N2 = 80\n    N_total = N0 + N1 + N2\n    gaps = [0.3, 0.1, 0.03]\n    \n    target_points = np.array([\n        [0.0, -0.75], [0.0, -0.5], [0.0, -0.25], [0.0, 0.0],\n        [0.0, 0.25], [0.0, 0.5], [0.0, 0.75],\n        [0.5, 0.5], [-0.5, 0.5]\n    ])\n\n    results = []\n\n    def u_star(x, y):\n        \"\"\"Analytical solution u*(x,y) = Re(z^3).\"\"\"\n        return x**3 - 3 * x * y**2\n\n    u_star_targets = u_star(target_points[:, 0], target_points[:, 1])\n    norm_u_star = np.linalg.norm(u_star_targets)\n\n    for g in gaps:\n        c = r + g / 2.0\n        \n        # --- Generate Boundary Nodes and Quadrature ---\n        nodes = np.zeros((N_total, 2))\n        normals = np.zeros((N_total, 2))\n        weights = np.zeros(N_total)\n        \n        # Gamma_0 (outer circle)\n        theta0 = 2 * np.pi * np.arange(N0) / N0\n        nodes[:N0, 0] = R0 * np.cos(theta0)\n        nodes[:N0, 1] = R0 * np.sin(theta0)\n        normals[:N0, 0] = np.cos(theta0)\n        normals[:N0, 1] = np.sin(theta0)\n        weights[:N0] = R0 * 2 * np.pi / N0\n\n        # Gamma_1 (inner circle 1)\n        start_idx, end_idx = N0, N0 + N1\n        theta1 = 2 * np.pi * np.arange(N1) / N1\n        nodes[start_idx:end_idx, 0] = c + r * np.cos(theta1)\n        nodes[start_idx:end_idx, 1] = r * np.sin(theta1)\n        normals[start_idx:end_idx, 0] = -np.cos(theta1)\n        normals[start_idx:end_idx, 1] = -np.sin(theta1)\n        weights[start_idx:end_idx] = r * 2 * np.pi / N1\n\n        # Gamma_2 (inner circle 2)\n        start_idx, end_idx = N0 + N1, N_total\n        theta2 = 2 * np.pi * np.arange(N2) / N2\n        nodes[start_idx:end_idx, 0] = -c + r * np.cos(theta2)\n        nodes[start_idx:end_idx, 1] = r * np.sin(theta2)\n        normals[start_idx:end_idx, 0] = -np.cos(theta2)\n        normals[start_idx:end_idx, 1] = -np.sin(theta2)\n        weights[start_idx:end_idx] = r * 2 * np.pi / N2\n\n        epsilons = weights / 2.0\n        \n        # RHS vector from boundary data\n        g_vec = u_star(nodes[:, 0], nodes[:, 1])\n\n        # --- Assemble matrices ---\n        # diffs(i, j, k) = nodes(i, k) - nodes(j, k)\n        diffs = nodes[:, np.newaxis, :] - nodes[np.newaxis, :, :]\n        dist_sq = np.sum(diffs**2, axis=2)\n        \n        # Regularization term for source points j\n        reg_dist_sq = dist_sq + epsilons[np.newaxis, :]**2\n        \n        # Kernel matrices (weighted)\n        # G(xi, yj) matrix entries\n        S_kernel_vals = (-1.0 / (2.0 * np.pi)) * 0.5 * np.log(reg_dist_sq)\n        S_matrix = S_kernel_vals * weights[np.newaxis, :]\n        \n        # dG/dn(xi, yj) matrix entries\n        n_dot_diff = np.sum(diffs * normals[np.newaxis, :, :], axis=2)\n        K_kernel_vals = (1.0 / (2.0 * np.pi)) * n_dot_diff / reg_dist_sq\n        # Diagonal K_ii should be zero due to numertor n_i . (x_i-x_i) = 0\n        np.fill_diagonal(K_kernel_vals, 0)\n        K_matrix_weighted = K_kernel_vals * weights[np.newaxis, :]\n        \n        A_double_layer = 0.5 * np.identity(N_total) + K_matrix_weighted\n        A_single_layer = S_matrix\n\n        # --- Interpolation Kernels (Target points to Boundary source points) ---\n        diffs_interp = target_points[:, np.newaxis, :] - nodes[np.newaxis, :, :]\n        dist_sq_interp = np.sum(diffs_interp**2, axis=2)\n        \n        S_interp_kernel = (-1.0 / (2.0 * np.pi)) * 0.5 * np.log(dist_sq_interp)\n        \n        n_dot_diff_interp = np.sum(diffs_interp * normals[np.newaxis, :, :], axis=2)\n        K_interp_kernel = (1.0 / (2.0 * np.pi)) * n_dot_diff_interp / dist_sq_interp\n\n        # --- SINGLE-LAYER ---\n        formulation = \"single\"\n        # Solve for density\n        sigma = np.linalg.solve(A_single_layer, g_vec)\n        # Compute condition number\n        cond_single = np.linalg.cond(A_single_layer)\n        # Interpolate solution\n        u_computed_single = (S_interp_kernel * weights[np.newaxis, :]) @ sigma\n        # Compute error\n        error_single = np.linalg.norm(u_computed_single - u_star_targets) / norm_u_star\n        results.append([cond_single, error_single])\n        \n        # --- DOUBLE-LAYER ---\n        formulation = \"double\"\n        # Solve for density\n        mu = np.linalg.solve(A_double_layer, g_vec)\n        # Compute condition number\n        cond_double = np.linalg.cond(A_double_layer)\n        # Interpolate solution\n        u_computed_double = (K_interp_kernel * weights[np.newaxis, :]) @ mu\n        # Compute error\n        error_double = np.linalg.norm(u_computed_double - u_star_targets) / norm_u_star\n        results.append([cond_double, error_double])\n            \n    # Final print statement\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3402011"}]}