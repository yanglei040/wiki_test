{"hands_on_practices": [{"introduction": "要从根本上理解狄利克雷边界条件是如何影响偏微分方程数值解的，一个有效方法是明确地分离边界和内部的相互作用。本练习将引导你通过舒尔补 (Schur complement) 来系统地消去内部未知数，从而推导出离散的狄利克雷-诺伊曼 (Dirichlet-to-Neumann, DtN) 映射 [@problem_id:3407312]。这个过程不仅能让你深入理解边界数据如何决定整体解的行为，也为你将来学习区域分解 (domain decomposition) 等高等算法打下坚实的理论基础。", "problem": "考虑区间 $[0,L]$ 上的齐次拉普拉斯偏微分方程 (PDE) $u''(x) = 0$，其端点处给定未知的狄利克雷边界数据。使用包含 $N+2$ 个点的均匀网格对 $[0,L]$ 进行离散化，点为 $x_j = j h$，其中 $h = \\frac{L}{N+1}$。边界节点索引为 $j = 0$ 和 $j = N+1$，内部节点索引为 $j = 1,2,\\dots,N$。令有限差分法 (FDM) 使用标准的中心二阶差分算子，使得内部场 $u_j$ 对所有 $j = 1,\\dots,N$ 均满足 $u_{j-1} - 2 u_j + u_{j+1} = 0$。用向量 $u_b = \\begin{pmatrix} u_0 \\\\ u_{N+1} \\end{pmatrix}$ 表示边界狄利克雷数据，用 $u_i = \\begin{pmatrix} u_1 \\\\ \\vdots \\\\ u_N \\end{pmatrix}$ 表示内部未知向量。将在端点处的离散外法向通量向量定义为 $q = \\begin{pmatrix} q_L \\\\ q_R \\end{pmatrix}$，其中在 $x = 0$ 处 $q_L = -\\frac{u_1 - u_0}{h}$，在 $x = L$ 处 $q_R = \\frac{u_{N+1} - u_N}{h}$。 \n\n从有限差分格式导出的块结构线性系统出发，使用 Schur 补消去内部未知数 $u_i$，并表示离散的狄利克雷-诺伊曼 (Steklov) 映射 $S_h$，使得 $q = S_h\\, u_b$。在您的推导中，从离散拉普拉斯算子和 Schur 补的定义开始，并论证每一步代数运算。然后，在使用带嵌套剖分排序的稀疏 Cholesky 分解时，用大-$\\mathcal{O}$表示法分析在 $m \\times m$ 网格（具有 $(m-2)^2$ 个内部节点）上为二维离散拉普拉斯算子构造和应用 Schur 补的计算成本。最后，通过刻画您所推导的一维 $S_h$ 的对称性、（半）正定性以及零空间的存在与否，讨论离散 Steklov 问题的稳定性，包括其非零特征值随 $h$ 和 $N$ 的缩放关系。\n\n请提供 $2 \\times 2$ 矩阵 $S_h$ 关于 $N$ 和 $h$ 的显式闭式解析表达式作为最终答案。本题无需进行数值取整。", "solution": "本题要求推导和分析一维拉普拉斯方程的离散狄利克雷-诺伊曼 (DtN) 映射，分析一个相关的二维问题的计算成本，并对所推导的一维 DtN 映射进行稳定性分析。\n\n### 第 1 部分：离散 DtN 映射 $S_h$ 的推导\n\n我们从区间 $[0, L]$ 上的偏微分方程 $u''(x) = 0$ 的有限差分离散化开始。该区域被离散化为 $N+2$ 个点 $x_j = j h$，$j=0, 1, \\dots, N+1$，其中 $h = L/(N+1)$。内部节点 $u_j$ ($j=1, \\dots, N$) 的控制方程由中心二阶差分公式给出：\n$$u_{j-1} - 2 u_j + u_{j+1} = 0$$\n这 $N$ 个线性方程组可以通过将解向量划分为内部未知数 $u_i = (u_1, u_2, \\dots, u_N)^T$ 和边界值 $u_b = (u_0, u_{N+1})^T$ 来写成块矩阵形式。\n\n对于 $j=1$，我们有 $u_0 - 2u_1 + u_2 = 0$。\n对于 $j=2, \\dots, N-1$，我们有 $u_{j-1} - 2u_j + u_{j+1} = 0$。\n对于 $j=N$，我们有 $u_{N-1} - 2u_N + u_{N+1} = 0$。\n\n分离内部项和边界项后，我们得到一个关于内部未知数 $u_i$ 的系统：\n$$\n\\begin{pmatrix}\n-2  1  0  \\dots  0 \\\\\n1  -2  1  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  1  -2  1 \\\\\n0  \\dots  0  1  -2\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ \\vdots \\\\ u_{N-1} \\\\ u_N \\end{pmatrix}\n+\n\\begin{pmatrix}\nu_0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ u_{N+1}\n\\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这可以表示为紧凑的块形式 $A_{ii} u_i + A_{ib} u_b = 0$，其中：\n$A_{ii}$ 是一个 $N \\times N$ 的对称三对角矩阵，表示内部离散拉普拉斯算子：\n$$A_{ii} = \\begin{pmatrix}\n-2  1   \\\\\n1  -2  1  \\\\\n \\ddots  \\ddots  \\ddots \\\\\n  1  -2  1 \\\\\n   1  -2\n\\end{pmatrix}$$\n$A_{ib}$ 是一个 $N \\times 2$ 的矩阵，用于将内部与边界耦合：\n$$A_{ib} = \\begin{pmatrix}\n1  0 \\\\\n0  0 \\\\\n\\vdots  \\vdots \\\\\n0  0 \\\\\n0  1\n\\end{pmatrix} = \\begin{pmatrix} e_1  e_N \\end{pmatrix}$$\n其中 $e_j$ 是 $\\mathbb{R}^N$ 中的第 $j$ 个标准基向量。\n\n为了消去内部未知数 $u_i$，我们用边界数据 $u_b$ 来求解它们：\n$$u_i = -A_{ii}^{-1} A_{ib} u_b$$\n接下来，我们用 $u_i$ 和 $u_b$ 表示离散外法向通量向量 $q = (q_L, q_R)^T$。通量定义为 $q_L = -\\frac{u_1 - u_0}{h}$ 和 $q_R = \\frac{u_{N+1} - u_N}{h}$。写成矩阵形式为：\n$$q = \\frac{1}{h}\\begin{pmatrix} u_0 - u_1 \\\\ u_{N+1} - u_N \\end{pmatrix} = \\frac{1}{h}\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}u_b + \\frac{1}{h}\\begin{pmatrix} -1  0  \\dots  0 \\\\ 0  \\dots  0  -1 \\end{pmatrix}u_i$$\n这对应于块形式 $q = C u_b + B u_i$，其中：\n$C = \\frac{1}{h}I_2$ 和 $B = \\frac{1}{h}\\begin{pmatrix} -e_1^T \\\\ -e_N^T \\end{pmatrix}$\n将 $u_i$ 的表达式代入 $q$ 的方程中，得到 DtN 映射 $S_h$：\n$$q = C u_b + B(-A_{ii}^{-1} A_{ib} u_b) = (C - B A_{ii}^{-1} A_{ib}) u_b$$\n因此，DtN 映射（即系统的 Schur 补）为 $S_h = C - B A_{ii}^{-1} A_{ib}$。\n\n为了找到 $S_h$ 的显式表达式，我们需要 $A_{ii}$ 的逆。这个特定的三对角矩阵的逆有解析解：\n$$(A_{ii}^{-1})_{jk} = -\\frac{1}{N+1} \\min(j,k)(N+1-\\max(j,k)) = -\\frac{1}{N+1} \\begin{cases} j(N+1-k)   \\text{若 } j \\le k \\\\ k(N+1-j)   \\text{若 } j > k \\end{cases}$$\n我们首先计算矩阵乘积 $B A_{ii}^{-1} A_{ib}$：\n$$B A_{ii}^{-1} A_{ib} = \\left( \\frac{1}{h}\\begin{pmatrix} -e_1^T \\\\ -e_N^T \\end{pmatrix} \\right) A_{ii}^{-1} \\begin{pmatrix} e_1  e_N \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -e_1^T A_{ii}^{-1} e_1   -e_1^T A_{ii}^{-1} e_N \\\\ -e_N^T A_{ii}^{-1} e_1   -e_N^T A_{ii}^{-1} e_N \\end{pmatrix}$$\n这些元素是使用 $A_{ii}^{-1}$ 的公式计算的：\n$e_1^T A_{ii}^{-1} e_1 = (A_{ii}^{-1})_{11} = -\\frac{1(N+1-1)}{N+1} = -\\frac{N}{N+1}$\n$e_1^T A_{ii}^{-1} e_N = (A_{ii}^{-1})_{1N} = -\\frac{1(N+1-N)}{N+1} = -\\frac{1}{N+1}$\n$e_N^T A_{ii}^{-1} e_1 = (A_{ii}^{-1})_{N1} = -\\frac{1(N+1-N)}{N+1} = -\\frac{1}{N+1}$\n$e_N^T A_{ii}^{-1} e_N = (A_{ii}^{-1})_{NN} = -\\frac{N(N+1-N)}{N+1} = -\\frac{N}{N+1}$\n将这些代回乘积的表达式中：\n$$B A_{ii}^{-1} A_{ib} = \\frac{1}{h} \\begin{pmatrix} -(-\\frac{N}{N+1})   -(-\\frac{1}{N+1}) \\\\ -(-\\frac{1}{N+1})   -(-\\frac{N}{N+1}) \\end{pmatrix} = \\frac{1}{h(N+1)}\\begin{pmatrix} N   1 \\\\ 1   N \\end{pmatrix}$$\n最后，我们计算 $S_h$：\n$$S_h = C - B A_{ii}^{-1} A_{ib} = \\frac{1}{h}\\begin{pmatrix} 1   0 \\\\ 0   1 \\end{pmatrix} - \\frac{1}{h(N+1)}\\begin{pmatrix} N   1 \\\\ 1   N \\end{pmatrix}$$\n$$S_h = \\frac{1}{h(N+1)}\\begin{pmatrix} N+1   0 \\\\ 0   N+1 \\end{pmatrix} - \\frac{1}{h(N+1)}\\begin{pmatrix} N   1 \\\\ 1   N \\end{pmatrix}$$\n$$S_h = \\frac{1}{h(N+1)}\\begin{pmatrix} 1   -1 \\\\ -1   1 \\end{pmatrix}$$\n这是 $2 \\times 2$ 矩阵 $S_h$ 的显式形式。值得注意的是，由于 $h=L/(N+1)$，我们有 $L=h(N+1)$。因此，$S_h = \\frac{1}{L}\\begin{pmatrix} 1   -1 \\\\ -1   1 \\end{pmatrix}$，这与连续问题 $u''(x)=0$ 的 DtN 映射完全相同。这是因为中心差分格式对于作为一维拉普拉斯方程解的线性函数是精确的。\n\n### 第 2 部分：二维情况下的计算成本\n\n对于 $m \\times m$ 网格上的二维离散拉普拉斯算子，内部节点的数量为 $M = (m-2)^2$。问题是找到在使用带嵌套剖分排序的稀疏 Cholesky 分解时，构造和应用 Schur 补 $S = A_{bb} - A_{bi} A_{ii}^{-1} A_{ib}$ 的成本。内部矩阵 $A_{ii}$ 的维度为 $M \\times M$。\n边界节点的数量为 $N_b = m^2 - (m-2)^2 = 4m-4 = \\mathcal{O}(m)$。\n\n**构造 $S$ 的成本：**\n$S$ 的构造涉及三个主要步骤：\n1.  **$A_{ii}$ 的分解**：对于一个有 $M$ 个顶点的二维网格图，嵌套剖分算法提供了一个稀疏 Cholesky 分解 $A_{ii} = LL^T$，其计算成本（浮点运算次数）为 $\\mathcal{O}(M^{3/2})$。代入 $M=\\mathcal{O}(m^2)$，成本为 $\\mathcal{O}((m^2)^{3/2}) = \\mathcal{O}(m^3)$。\n2.  **求解 $X = A_{ii}^{-1} A_{ib}$**：这涉及到对 $A_{ib}$ 的 $N_b = \\mathcal{O}(m)$ 列中的每一列求解一个系统 $A_{ii}x = c$。使用嵌套剖分得到的稀疏因子 $L$ 进行一次求解（前向/后向代入）的成本是 $\\mathcal{O}(M \\log M)$。当 $M=\\mathcal{O}(m^2)$ 时，一次求解的成本为 $\\mathcal{O}(m^2 \\log m)$。对所有 $N_b$ 列执行此操作的总成本为 $N_b \\times \\mathcal{O}(m^2 \\log m) = \\mathcal{O}(m) \\times \\mathcal{O}(m^2 \\log m) = \\mathcal{O}(m^3 \\log m)$。\n3.  **矩阵乘法**：计算 $A_{bi}X$ 的成本由前面的步骤主导。矩阵 $X$ 是大小为 $M \\times N_b$ 的稠密矩阵，但 $A_{bi}$ 是稀疏的，只有 $\\mathcal{O}(m)$ 个非零元。\n\n构造稠密的 Schur 补矩阵 $S$ 的总成本由多次求解主导，其复杂度为 $\\mathcal{O}(m^3 \\log m)$。\n\n**应用 $S$ 的成本：**\n一旦矩阵 $S$被显式构造出来，它就是一个稠密的 $N_b \\times N_b$ 矩阵，其中 $N_b = \\mathcal{O}(m)$。将 $S$ 应用于边界向量 $u_b$ 对应于矩阵-向量乘积 $S u_b$。其成本为 $\\mathcal{O}(N_b^2) = \\mathcal{O}((4m-4)^2) = \\mathcal{O}(m^2)$。\n\n### 第 3 部分：一维 $S_h$ 的稳定性分析\n\n我们分析 $S_h = \\frac{1}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 的性质。\n\n**对称性**：该矩阵是对称的，因为 $(S_h)_{12} = (S_h)_{21} = -1/L$。也就是说，$S_h = S_h^T$。这是预料之中的，因为算子是自伴的，并且所使用的离散化也是对称的。\n\n**正定性与零空间**：我们考察 $u_b = (u_0, u_{N+1})^T$ 的二次型 $u_b^T S_h u_b$：\n$$u_b^T S_h u_b = \\frac{1}{L} \\begin{pmatrix} u_0  u_{N+1} \\end{pmatrix} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_{N+1} \\end{pmatrix} = \\frac{1}{L} (u_0 - u_{N+1})^2$$\n由于 $L > 0$，对所有 $u_b$ 我们都有 $u_b^T S_h u_b \\ge 0$。因此，$S_h$ 是半正定的。它不是正定的，因为对于 $u_0 = u_{N+1}$ 的非零向量，该二次型为零。\n$S_h$ 的零空间由满足 $S_h u_b = 0$ 的向量 $u_b$ 组成。这个条件给出 $u_0 - u_{N+1} = 0$，所以 $u_0 = u_{N+1}$。零空间由向量 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 张成。在物理上，这对应于一个常数边界条件 $u(0)=u(L)$，对于问题 $u''(x)=0$ 来说，这意味着一个常数解 $u(x)=c$。常数解的导数为零，因此在边界处的通量为零，这与 $q=S_h u_b=0$ 一致。\n\n**特征值与缩放关系**：我们通过求解 $\\det(S_h - \\lambda I) = 0$ 来找到特征值 $\\lambda$：\n$$\\det \\begin{pmatrix} \\frac{1}{L} - \\lambda   -\\frac{1}{L} \\\\ -\\frac{1}{L}   \\frac{1}{L} - \\lambda \\end{pmatrix} = \\left(\\frac{1}{L} - \\lambda\\right)^2 - \\left(\\frac{1}{L}\\right)^2 = 0$$\n这得到 $(\\frac{1}{L} - \\lambda) = \\pm \\frac{1}{L}$，从而得出特征值 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\frac{2}{L}$。\n零特征值对应于零空间。非零特征值为 $\\lambda_2 = \\frac{2}{L}$。由于我们已经确定，对于固定的区域长度 $L$，$S_h$ 与离散化参数 $h$ 和 $N$ 无关，因此其非零特征值也是一个常数 $\\frac{2}{L}$。所以，非零特征值相对于 $h$ 和 $N$ 的缩放关系是 $\\mathcal{O}(1)$。", "answer": "$$\n\\boxed{\\frac{1}{h(N+1)} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}}\n$$", "id": "3407312"}, {"introduction": "虽然高阶格式能够显著提升数值解的精度，但其更宽的计算模板也给边界处理带来了挑战。一个设计不当的边界格式可能会引入非物理的数值反射，从而污染整个计算区域的解。在这个练习中，你将为一个六阶紧致格式推导一个稳定的“鬼点” (ghost-point) 边界封闭格式，目标是最小化边界引起的伪反射 [@problem_id:3407334]。这项实践将深化你对数值波传播与色散关系的理解，是开发高保真模拟程序的关键一步。", "problem": "考虑半无限带状区域中的二维泊松方程，特化为拉普拉斯方程，\n$$\n-\\Delta u(x,y) \\;=\\; 0,\\qquad x\\ge 0,\\; y\\in\\mathbb{R},\n$$\n其狄利克雷边界条件为\n$$\nu(0,y)\\;=\\;g(y)\\;=\\;\\exp(i k y),\n$$\n其中 $k0$ 是一个给定的空间频率。用均匀网格 $x_i=i h$, $i=0,1,2,\\dots$ 对半直线上的 $x$ 方向进行离散化，网格间距为 $h0$，并通过傅里叶模式 $\\exp(i k y)$ 的分离变量法来考虑对 $y$ 的依赖关系，从而将连续偏微分方程 (PDE) 简化为关于 $x$ 的常微分方程，\n$$\n\\frac{d^2 u}{dx^2}(x) \\;-\\; k^2\\,u(x)\\;=\\;0.\n$$\n对于 $x$ 方向二阶导数的内部近似，使用如下形式的对称三点紧致六阶有限差分关系\n$$\n\\alpha\\, u''_{i-1} \\;+\\; u''_{i} \\;+\\; \\alpha\\,u''_{i+1}\n\\;=\\; \\frac{1}{h^2}\\left[a\\left(u_{i-1}-2u_i+u_{i+1}\\right) \\;+\\; b\\left(u_{i-2}-2u_i+u_{i+2}\\right)\\right],\n$$\n其中的待定常数 $\\alpha$、$a$、$b$ 将通过在 $x_i$ 点进行泰勒展开并强制满足六阶相容性来确定。在内部，将简化的常微分方程 $u''(x_i)=k^2 u(x_i)$ 在 $i-1$、$i$ 和 $i+1$ 点应用于上述紧致关系式，从而得到 $\\{u_i\\}_{i\\ge 0}$ 的线性递推关系。\n\n你需要通过令 $u_0=g(0)=1$ 来施加 $i=0$ 处的狄利克雷边界条件，并使用几何鬼点关系来闭合差分格式\n$$\nu_{-m} \\;=\\; \\lambda^{m}\\,u_0,\\qquad m=1,2,3,\n$$\n其中有一个待选的实数参数 $\\lambda0$。对于分离出的边界模式 $\\exp(i k y)$，内部递推关系允许形式为 $u_i=r^i$（其中 $i\\ge 0$ 且 $|r|1$）的几何正规模解（衰减分支）。虚假的边界反射对应于增长分支的任何非零混合。为了最小化这种振荡狄利克雷数据的虚假反射边界模式，选择的 $\\lambda$ 应使几何闭合关系精确匹配衰减的内部模式。\n\n从第一性原理出发：\n- 确定保证紧致二阶导数公式具有六阶相容性的系数 $\\alpha$、$a$ 和 $b$，\n- 推导与简化常微分方程相关的模式 $u_i=r^i$ 的离散内部符号，\n- 然后计算最优几何因子 $\\lambda$ 作为无量纲波数 $\\xi=k h$ 的函数的闭式表达式。\n\n你的最终答案必须是 $\\lambda(\\xi)$ 的单一闭式解析表达式，其中 $\\xi=k h$。不需要进行数值近似或四舍五入。答案需要用 $\\xi$ 和根式精确表示。", "solution": "用户希望找到用于六阶紧致有限差分格式的鬼点边界条件实现的最优几何因子 $\\lambda$。问题主要分三个阶段进行：\n1.  确定有限差分格式的系数。\n2.  推导应用于简化常微分方程 (ODE) 的格式的离散色散关系（特征方程）。\n3.  施加边界条件并求解最优参数 $\\lambda$。\n\n### 第一部分：确定六阶紧致格式的系数\n\n在网格点 $x_i$ 处，给定的用于二阶导数 $u''$ 的对称三点紧致有限差分关系为：\n$$\n\\alpha\\, u''_{i-1} \\;+\\; u''_{i} \\;+\\; \\alpha\\,u''_{i+1}\n\\;=\\; \\frac{1}{h^2}\\left[a\\left(u_{i-1}-2u_i+u_{i+1}\\right) \\;+\\; b\\left(u_{i-2}-2u_i+u_{i+2}\\right)\\right]\n$$\n为了确定系数 $\\alpha$、$a$ 和 $b$ 以满足六阶相容性，我们在点 $x_i$ 附近对所有项进行泰勒级数展开。令 $u^{(n)}_i$ 表示 $u(x)$ 在 $x_i$ 处的 $n$ 阶导数。\n左侧 (LHS) 展开为：\n$$\n\\text{LHS} = \\alpha(u''_i - h u'''_i + \\frac{h^2}{2}u^{(4)}_i - \\frac{h^3}{6}u^{(5)}_i + \\frac{h^4}{24}u^{(6)}_i - \\dots) + u''_i + \\alpha(u''_i + h u'''_i + \\frac{h^2}{2}u^{(4)}_i + \\frac{h^3}{6}u^{(5)}_i + \\frac{h^4}{24}u^{(6)}_i + \\dots)\n$$\n$$\n\\text{LHS} = (1+2\\alpha)u''_i + \\alpha h^2 u^{(4)}_i + \\frac{\\alpha h^4}{12}u^{(6)}_i + \\frac{\\alpha h^6}{360}u^{(8)}_i + O(h^8)\n$$\n右侧 (RHS) 各项展开为：\n$$\nu_{i-1}-2u_i+u_{i+1} = h^2 u''_i + \\frac{h^4}{12}u^{(4)}_i + \\frac{h^6}{360}u^{(6)}_i + \\frac{h^8}{20160}u^{(8)}_i + O(h^{10})\n$$\n$$\nu_{i-2}-2u_i+u_{i+2} = 4h^2 u''_i + \\frac{16h^4}{12}u^{(4)}_i + \\frac{64h^6}{360}u^{(6)}_i + \\frac{256h^8}{20160}u^{(8)}_i + O(h^{10})\n$$\n将这些组合得到 RHS：\n$$\n\\text{RHS} = \\frac{1}{h^2} \\left[ a(h^2 u''_i + \\frac{h^4}{12}u^{(4)}_i + \\dots) + b(4h^2 u''_i + \\frac{4h^4}{3}u^{(4)}_i + \\dots) \\right]\n$$\n$$\n\\text{RHS} = (a+4b)u''_i + \\left(\\frac{a}{12}+\\frac{4b}{3}\\right)h^2 u^{(4)}_i + \\left(\\frac{a}{360}+\\frac{64b}{360}\\right)h^4 u^{(6)}_i + \\left(\\frac{a}{20160}+\\frac{256b}{20160}\\right)h^6 u^{(8)}_i + O(h^8)\n$$\n为了使该关系对任意光滑函数 $u(x)$ 成立，两边各阶导数的系数必须匹配。通过匹配到所需阶数的项，我们得到一个线性方程组。\n\\begin{itemize}\n    \\item $u''_i$ 的系数：$1+2\\alpha = a+4b$ (归一化)\n    \\item $u^{(4)}_i$ 的系数：$\\alpha = \\frac{a}{12}+\\frac{4b}{3} \\implies 12\\alpha = a+16b$\n    \\item $u^{(6)}_i$ 的系数：$\\frac{\\alpha}{12} = \\frac{a+64b}{360} \\implies 30\\alpha = a+64b$\n\\end{itemize}\n如果这三个方程得到满足，截断误差将为 $h^6$ 阶，从而使该格式达到六阶精度。我们求解这个关于 $\\alpha, a, b$ 的 $3 \\times 3$ 方程组：\n第三个方程减去第二个方程：$(a+64b-30\\alpha) - (a+16b-12\\alpha) = 0 \\Rightarrow 48b - 18\\alpha = 0 \\Rightarrow 8b = 3\\alpha$。\n第二个方程减去第一个方程：$(a+16b-12\\alpha) - (a+4b-1-2\\alpha) = 0 \\Rightarrow 12b-10\\alpha = -1$。\n将 $b = \\frac{3}{8}\\alpha$ 代入最后一个方程：$12(\\frac{3}{8}\\alpha) - 10\\alpha = -1 \\Rightarrow \\frac{9}{2}\\alpha - 10\\alpha = -1 \\Rightarrow -\\frac{11}{2}\\alpha = -1 \\Rightarrow \\alpha = \\frac{2}{11}$。\n然后，$b = \\frac{3}{8}\\left(\\frac{2}{11}\\right) = \\frac{3}{44}$。\n最后，使用归一化方程：$a = 1+2\\alpha-4b = 1+2\\left(\\frac{2}{11}\\right)-4\\left(\\frac{3}{44}\\right) = 1+\\frac{4}{11}-\\frac{3}{11} = 1+\\frac{1}{11} = \\frac{12}{11}$。\n系数为：$\\alpha = \\frac{2}{11}$，$a = \\frac{12}{11}$，$b = \\frac{3}{44}$。\n\n### 第二部分：推导特征方程\n\n问题考虑简化的常微分方程 $u''(x) - k^2 u(x) = 0$。我们通过在紧致有限差分公式中的每个点 $j=i-1, i, i+1$ 处设置 $u''_j = k^2 u_j$ 来将其施加在网格上：\n$$\n\\alpha(k^2 u_{i-1}) + (k^2 u_i) + \\alpha(k^2 u_{i+1}) = \\frac{1}{h^2}\\left[a(u_{i-1}-2u_i+u_{i+1}) + b(u_{i-2}-2u_i+u_{i+2})\\right]\n$$\n令 $\\xi = kh$ 为无量纲波数。则 $k^2 = \\xi^2/h^2$。两边乘以 $h^2$，我们得到网格值 $u_i$ 的线性递推关系：\n$$\n\\xi^2 (\\alpha u_{i-1} + u_i + \\alpha u_{i+1}) = a(u_{i-1}-2u_i+u_{i+1}) + b(u_{i-2}-2u_i+u_{i+2})\n$$\n我们寻找形式为 $u_i = r^i$ 的几何正规模解。将其代入递推关系并除以 $r^i$ 得到关于 $r$ 的特征方程：\n$$\n\\xi^2 (\\alpha r^{-1} + 1 + \\alpha r) = a(r^{-1}-2+r) + b(r^{-2}-2+r^2)\n$$\n这是一个倒数（回文）方程。为了求解它，令 $y = r+r^{-1}$。则 $r^2+r^{-2} = (r+r^{-1})^2 - 2 = y^2-2$。方程变为：\n$$\n\\xi^2 (\\alpha y + 1) = a(y-2) + b(y^2-4)\n$$\n整理成关于 $y$ 的二次方程：\n$$\nb y^2 + (a-\\alpha\\xi^2)y - (2a+4b+\\xi^2) = 0\n$$\n代入推导出的系数 $\\alpha = \\frac{2}{11}$，$a = \\frac{12}{11}$，$b = \\frac{3}{44}$ 并乘以 44：\n$$\n3 y^2 + \\left(44\\frac{12}{11}-44\\frac{2}{11}\\xi^2\\right)y - \\left(88\\frac{12}{11}+176\\frac{3}{44}+44\\xi^2\\right) = 0\n$$\n$$\n3 y^2 + (48-8\\xi^2)y - (96+12+44\\xi^2) = 0\n$$\n$$\n3 y^2 + (48-8\\xi^2)y - (108+44\\xi^2) = 0\n$$\n这个关于 $y$ 的二次方程的根由以下公式给出：\n$$\ny = \\frac{-(48-8\\xi^2) \\pm \\sqrt{(48-8\\xi^2)^2 - 4(3)(-(108+44\\xi^2))}}{2(3)}\n$$\n$$\ny = \\frac{8\\xi^2-48 \\pm \\sqrt{(64\\xi^4 - 768\\xi^2 + 2304) + (1296 + 528\\xi^2)}}{6}\n$$\n$$\ny = \\frac{8\\xi^2-48 \\pm \\sqrt{64\\xi^4 - 240\\xi^2 + 3600}}{6}\n$$\n在 $x\\ge 0$ 上的连续问题需要一个衰减解 $u(x) \\propto e^{-kx}$。其离散类比是 $u_i \\propto r^i$，其中 $r = e^{-kh} = e^{-\\xi}$。对于小的 $\\xi$，$r \\approx 1-\\xi$，因此 $y = r+r^{-1} \\approx (1-\\xi) + (1+\\xi) = 2$。\n当 $\\xi=0$ 时，$y$ 的根为 $y = \\frac{-48 \\pm \\sqrt{3600}}{6} = \\frac{-48 \\pm 60}{6}$，解得 $y_1=2$ 和 $y_2=-18$。\n物理分支对应于 $y_1=2$。对于 $\\xi>0$，我们在二次公式中取“+”号以得到与 $y=2$ 相连的分支。\n$$\ny_{phys} = \\frac{8\\xi^2-48 + \\sqrt{64\\xi^4 - 240\\xi^2 + 3600}}{6} = \\frac{4\\xi^2-24 + \\sqrt{16\\xi^4 - 60\\xi^2 + 900}}{3}\n$$\n\n### 第三部分：确定最优几何因子 $\\lambda$\n\n内部衰减解的形式为 $u_i = C r_p^i$（对于 $i \\ge 0$），其中 $r_p$ 是物理衰减根，满足 $|r_p|1$。这个根可以通过求解 $r+r^{-1}=y_{phys}$ 从 $y_{phys}$ 得到，这会产生两个根，一个在单位圆内，一个在单位圆外。衰减根是：\n$$\nr_p = \\frac{y_{phys} - \\sqrt{y_{phys}^2-4}}{2}\n$$\n问题指出，鬼点闭合关系 $u_{-m} = \\lambda^m u_0$ 必须“精确匹配衰减的内部模式”。如果将内部解 $u_i = r_p^i u_0$ 向后外推，它将意味着 $u_{-1} = r_p^{-1} u_0$，$u_{-2} = r_p^{-2} u_0$，依此类推。\n将此与给定的闭合关系 $u_{-1} = \\lambda u_0$ 比较，我们必须有 $\\lambda = r_p^{-1}$。\n因此，$\\lambda$ 的值是 $r+r^{-1}=y_{phys}$ 的另一个根，即增长的那个根：\n$$\n\\lambda = r_p^{-1} = \\frac{y_{phys} + \\sqrt{y_{phys}^2-4}}{2}\n$$\n代入 $y_{phys}$ 的表达式：\n$$\n\\lambda = \\frac{1}{2}\\left( \\frac{4\\xi^2-24 + \\sqrt{16\\xi^4 - 60\\xi^2 + 900}}{3} + \\sqrt{\\left(\\frac{4\\xi^2-24 + \\sqrt{16\\xi^4 - 60\\xi^2 + 900}}{3}\\right)^2 - 4} \\right)\n$$\n这就是 $\\lambda(\\xi)$ 的闭式表达式。", "answer": "$$\\boxed{\\frac{1}{2}\\left( \\frac{4\\xi^2-24 + \\sqrt{16\\xi^4 - 60\\xi^2 + 900}}{3} + \\sqrt{\\left(\\frac{4\\xi^2-24 + \\sqrt{16\\xi^4 - 60\\xi^2 + 900}}{3}\\right)^2 - 4} \\right)}$$", "id": "3407334"}]}