{"hands_on_practices": [{"introduction": "后验误差估计的理论根基在于残差，即数值解在多大程度上不满足原始偏微分方程。本练习将理论付诸实践，要求您在一个简单的模型问题上，通过手动计算来构建经典的基于残差的误差指示器 ([@problem_id:3359755])。通过这个过程，您将深入理解单元内部残差和单元边界上的通量跳跃是如何量化离散误差的，为更复杂的自适应算法打下坚实的基础。", "problem": "考虑单位正方形域 $\\Omega = (0,1)^2$ 上的模型椭圆偏微分方程 (PDE) $-\\Delta u = f$，其在边界 $\\partial \\Omega$ 上具有齐次狄利克雷边界条件 $u=0$。设 $\\mathcal{T}_h$ 是 $\\Omega$ 的一个协调三角剖分，它由沿从 $(0,0)$ 到 $(1,1)$ 的对角线分割正方形得到的两个三角形组成：\n- $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$，\n- $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$。\n内部边（面）为 $F = \\operatorname{conv}\\{(0,0),(1,1)\\}$。\n\n设 $u_h \\in V_h$ 是一个协调的 $\\mathbb{P}_1$ （分片线性）有限元函数，由节点值\n$u_h(0,0)=0$，$u_h(1,0)=1$，$u_h(1,1)=2$，$u_h(0,1)=0.7$ 确定，并设在 $\\Omega$ 中 $f \\equiv 1$。假设对称扩散张量是单位矩阵，因此算子为 $-\\Delta$。对于每个单元 $K \\in \\mathcal{T}_h$，用 $h_K$ 表示其直径（$K$ 的任意两个顶点之间的最大距离），对于每条边 $F$，用 $h_F$ 表示其长度。对于任意子域 $D \\subset \\mathbb{R}^2$，将 $L^2$ 范数写作 $\\|g\\|_{0,D}^2 = \\int_D |g|^2$。\n\n从弱形式和格林恒等式出发，推导单元指标 $\\eta_K$ 和内部边指标 $\\eta_F$ 的显式基于残差的公式，这些公式仅依赖于局部积分和已知的片常数梯度 $\\nabla u_h|_K$。然后，使用这些公式：\n- 计算单元 $K_1$ 上的 $\\eta_{K_1}$，其中 $h_{K_1}$ 选为其直径，\n- 计算内部边 $F$ 上的 $\\eta_F$，其中 $h_F$ 选为边长，\n并定义 $K_1$ 的组合局部指标为\n$$\n\\Theta(K_1) = \\sqrt{\\eta_{K_1}^{2} + \\frac{1}{2}\\,\\eta_{F}^{2}}.\n$$\n\n将 $\\Theta(K_1)$ 的最终值表示为单个简化的解析表达式。不需要数值舍入，也不涉及物理单位。", "solution": "该问题要求针对泊松问题 $-\\Delta u = f$，在单位正方形 $\\Omega = (0,1)^2$ 的一个特定三角剖分上，为一个给定的分片线性函数 $u_h$ 计算局部后验误差指标。\n\n首先，我们必须推导基于残差的误差指标的公式。出发点是问题的弱形式：找到 $u \\in H_0^1(\\Omega)$，使得对于所有测试函数 $v \\in H_0^1(\\Omega)$，\n$$\n\\int_\\Omega \\nabla u \\cdot \\nabla v \\, d\\mathbf{x} = \\int_\\Omega f v \\, d\\mathbf{x}.\n$$\n设 $e = u - u_h$ 为误差，其中 $u_h \\in V_h$ 是给定的有限元函数。对于任意 $v \\in H_0^1(\\Omega)$，误差方程为\n$$\n\\int_\\Omega \\nabla e \\cdot \\nabla v \\, d\\mathbf{x} = \\int_\\Omega f v \\, d\\mathbf{x} - \\int_\\Omega \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x}.\n$$\n我们对包含 $u_h$ 的项逐单元应用分部积分（格林恒等式）：\n$$\n\\int_\\Omega \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\int_K \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K (-\\Delta u_h) v \\, d\\mathbf{x} + \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds \\right),\n$$\n其中 $\\mathbf{n}_K$ 是单元 $K$ 边界 $\\partial K$ 的外单位法向量。将此代入误差方程得到：\n$$\n\\int_\\Omega \\nabla e \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\int_K (f + \\Delta u_h) v \\, d\\mathbf{x} - \\sum_{K \\in \\mathcal{T}_h} \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds.\n$$\n对单元边界的求和可以重组为对三角剖分的所有边（或面）$\\mathcal{F}_h$ 的求和。对于由两个单元 $K_1$ 和 $K_2$ 共享的内部边 $F$，其贡献为 $\\int_F (\\nabla u_h|_{K_1} \\cdot \\mathbf{n}_1 + \\nabla u_h|_{K_2} \\cdot \\mathbf{n}_2) v \\, ds$。括号中的项定义为法向通量在 $F$ 上的跳跃，记作$\\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket_F$。由于在 $\\partial\\Omega$ 上 $v=0$，边界边项消失。误差方程变为：\n$$\n\\int_\\Omega \\nabla e \\cdot \\nabla v \\, d\\mathbf{x} = \\sum_{K \\in \\mathcal{T}_h} \\int_K (f + \\Delta u_h) v \\, d\\mathbf{x} + \\sum_{F \\in \\mathcal{F}_h^i} \\int_F \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket_F v \\, ds,\n$$\n其中 $\\mathcal{F}_h^i$ 是内部边的集合。后验误差分析通过一个量（误差估计子）来界定误差范数 $\\| \\nabla e \\|_{0,\\Omega}$，该量依赖于单元残差 $R_K = f + \\Delta u_h$ 和边跳跃残差 $J_F = \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket_F$。\n\n我们在此采用的局部误差指标的标准定义是：\n- 单元 $K$ 的单元指标：$\\eta_K = h_K \\| R_K \\|_{0,K} = h_K \\| f + \\Delta u_h \\|_{0,K}$。\n- 内部边 $F$ 的边指标：$\\eta_F = h_F^{1/2} \\| J_F \\|_{0,F} = h_F^{1/2} \\| \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket \\|_{0,F}$。\n\n问题提供了一个协调的 $\\mathbb{P}_1$ 有限元函数 $u_h$，它是分片线性的。因此，其拉普拉斯算子 $\\Delta u_h$ 在每个单元 $K$ 的内部为零。公式简化为：\n- $\\eta_K = h_K \\| f \\|_{0,K}$。\n- $\\eta_F = h_F^{1/2} \\| \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket \\|_{0,F}$。\n\n现在我们为给定的设置计算这些量。\n该三角剖分由两个三角形组成：\n- $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$，一个面积为 $|K_1| = 1/2$ 的直角三角形。\n- $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$，一个面积为 $|K_2| = 1/2$ 的直角三角形。\n内部边为 $F = \\operatorname{conv}\\{(0,0),(1,1)\\}$。\n\n函数 $u_h$ 在每个单元上是线性的。\n在 $K_1$ 上，$u_h(x,y) = a_1 x + b_1 y + c_1$。使用节点值 $u_h(0,0)=0$, $u_h(1,0)=1$, $u_h(1,1)=2$：\n- $u_h(0,0) = c_1 = 0$。\n- $u_h(1,0) = a_1 = 1$。\n- $u_h(1,1) = a_1 + b_1 = 2 \\implies 1 + b_1 = 2 \\implies b_1 = 1$。\n所以，$u_h|_{K_1}(x,y) = x+y$。在 $K_1$ 上的梯度是常数：$\\nabla u_h|_{K_1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n在 $K_2$ 上，$u_h(x,y) = a_2 x + b_2 y + c_2$。使用节点值 $u_h(0,0)=0$, $u_h(0,1)=0.7$, $u_h(1,1)=2$：\n- $u_h(0,0) = c_2 = 0$。\n- $u_h(0,1) = b_2 = 0.7$。\n- $u_h(1,1) = a_2 + b_2 = 2 \\implies a_2 + 0.7 = 2 \\implies a_2 = 1.3$。\n所以，$u_h|_{K_2}(x,y) = 1.3x + 0.7y$。在 $K_2$ 上的梯度是常数：$\\nabla u_h|_{K_2} = \\begin{pmatrix} 1.3 \\\\ 0.7 \\end{pmatrix}$。\n\n接下来，我们计算指标 $\\eta_{K_1}$ 和 $\\eta_F$。\n\n**$\\eta_{K_1}$的计算**：\n- $K_1$ 的直径 $h_{K_1}$ 是其最长边的长度。边长分别为 $1$、$1$ 和 $\\sqrt{(1-0)^2 + (1-0)^2} = \\sqrt{2}$。因此，$h_{K_1} = \\sqrt{2}$。\n- 源函数为 $f \\equiv 1$。\n- $\\|f\\|_{0,K_1}^2 = \\int_{K_1} f^2 d\\mathbf{x} = \\int_{K_1} 1^2 d\\mathbf{x} = |K_1| = \\frac{1}{2}$。\n- $\\|f\\|_{0,K_1} = \\sqrt{1/2} = 1/\\sqrt{2}$。\n- $\\eta_{K_1} = h_{K_1} \\|f\\|_{0,K_1} = \\sqrt{2} \\cdot \\frac{1}{\\sqrt{2}} = 1$。\n\n**$\\eta_F$的计算**：\n- 边 $F$ 是从 $(0,0)$ 到 $(1,1)$ 的线段。其长度为 $h_F = \\sqrt{1^2+1^2} = \\sqrt{2}$。\n- 穿过 $F$ 的法向通量跳跃为 $J_F = \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket = (\\nabla u_h|_{K_1} - \\nabla u_h|_{K_2}) \\cdot \\mathbf{n}$，其中 $\\mathbf{n}$ 是 $F$ 上的单位法向量。我们选择从 $K_1$ 指向 $K_2$ 的法线。边 $F$ 位于直线 $y=x$ 上。$K_1$ 位于区域 $y \\le x$ 中，$K_2$ 位于区域 $y \\ge x$ 中。从 $K_1$ 到 $K_2$ 的法线是 $\\mathbf{n} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$。\n- 梯度的差异为 $\\nabla u_h|_{K_1} - \\nabla u_h|_{K_2} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1.3 \\\\ 0.7 \\end{pmatrix} = \\begin{pmatrix} -0.3 \\\\ 0.3 \\end{pmatrix}$。\n- 跳跃 $J_F$ 沿 $F$ 为常数：\n$J_F = \\begin{pmatrix} -0.3 \\\\ 0.3 \\end{pmatrix} \\cdot \\frac{1}{\\sqrt{2}}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}((-0.3)(-1) + (0.3)(1)) = \\frac{0.3+0.3}{\\sqrt{2}} = \\frac{0.6}{\\sqrt{2}}$。\n- 现在我们计算 $J_F$ 在边 $F$ 上的 $L^2$ 范数：\n$\\|J_F\\|_{0,F}^2 = \\int_F |J_F|^2 ds = |J_F|^2 \\int_F ds = |J_F|^2 h_F = \\left(\\frac{0.6}{\\sqrt{2}}\\right)^2 \\sqrt{2} = \\frac{0.36}{2}\\sqrt{2} = 0.18\\sqrt{2}$。\n- 指标 $\\eta_F$ 为：\n$\\eta_F^2 = h_F \\|J_F\\|_{0,F}^2 = \\sqrt{2} \\cdot (0.18\\sqrt{2}) = 0.18 \\cdot 2 = 0.36$。\n因此，$\\eta_F = \\sqrt{0.36} = 0.6 = \\frac{3}{5}$。\n\n最后，我们计算 $K_1$ 的组合局部指标：\n$$\n\\Theta(K_1) = \\sqrt{\\eta_{K_1}^{2} + \\frac{1}{2}\\,\\eta_{F}^{2}}.\n$$\n代入计算出的值：\n$$\n\\Theta(K_1) = \\sqrt{1^2 + \\frac{1}{2}(0.6)^2} = \\sqrt{1 + \\frac{1}{2}(0.36)} = \\sqrt{1 + 0.18} = \\sqrt{1.18}.\n$$\n为了将其表示为简化的解析表达式，我们使用分数：\n$$\n\\Theta(K_1) = \\sqrt{\\frac{118}{100}} = \\frac{\\sqrt{118}}{\\sqrt{100}} = \\frac{\\sqrt{118}}{10}.\n$$\n数字 $118$ 分解为 $2 \\times 59$，所以平方根无法进一步简化。", "answer": "$$\n\\boxed{\\frac{\\sqrt{118}}{10}}\n$$", "id": "3359755"}, {"introduction": "在求解非线性问题时，我们不仅要处理网格离散带来的误差，还要面对代数求解器（如牛顿法）迭代求解产生的线性化误差。为了实现计算效率的最大化，我们必须明智地平衡这两种误差源。本练习 ([@problem_id:3359724]) 探讨了如何利用后验误差估计量来设计一个智能的牛顿法停止准则，确保代数迭代的求解精度与当前网格的离散精度相匹配，避免在“坏”网格上进行不必要的精确求解。", "problem": "考虑一个强单调、利普希茨非线性椭圆边值问题：在变分意义下，求 $u \\in V$ 使得 $A(u)=f$，其中 $V$ 是一个连续嵌入到 $H^{1}_{0}(\\Omega)$ 的希尔伯特空间，$A:V \\to V'$ 是一个非线性算子，其 Gâteaux 导数为 $A'(w)$，并且存在常数 $0  \\alpha \\le L  \\infty$ 使得对于所有 $w,v \\in V$，满足强单调性和利普希茨连续性条件\n$$\\langle A(w)-A(v), w-v \\rangle \\ge \\alpha \\|w-v\\|_{E}^{2}, \\qquad \\|A(w)-A(v)\\|_{V'} \\le L \\|w-v\\|_{E},$$\n其中 $\\|\\cdot\\|_{E}$ 是一个与 $H^{1}_{0}(\\Omega)$ 范数等价的能量范数，$\\langle \\cdot,\\cdot \\rangle$ 是 $V' \\times V$ 上的对偶配对。设 $V_{h} \\subset V$ 是有限元法（FEM）意义下的一个协调有限元空间，并令 $u_{h}^{\\star} \\in V_{h}$ 表示满足离散残差方程 $F_{h}(u_{h}^{\\star})=0$ 的精确离散解，其中 $F_{h}(w_{h}) \\in V_{h}'$ 由 $F_{h}(w_{h})[v_{h}] := \\langle A(w_{h}), v_{h} \\rangle - \\langle f, v_{h} \\rangle$ 对所有 $v_{h} \\in V_{h}$ 定义。假设有一个残差型后验误差估计子 $\\eta_{h}(w_{h}) \\ge 0$ 可用，使得对于某个网格无关的可靠性常数 $C_{\\mathrm{rel}} \\ge 1$ 和所有足够接近 $u_{h}^{\\star}$ 的 $w_{h} \\in V_{h}$，有\n$$\\|u - u_{h}^{\\star}\\|_{E} \\le C_{\\mathrm{rel}} \\,\\eta_{h}(u_{h}^{\\star}) \\approx C_{\\mathrm{rel}} \\,\\eta_{h}(w_{h}),$$\n其中该近似表示估计子在接近 $u_{h}^{\\star}$ 的迭代点处是稳定的。假设使用牛顿法求解该离散非线性系统：给定 $u_{h}^{k} \\in V_{h}$，求 $\\delta u_{h}^{k} \\in V_{h}$ 解\n$$\\langle A'(u_{h}^{k}) \\,\\delta u_{h}^{k}, v_{h} \\rangle = - F_{h}(u_{h}^{k})[v_{h}] \\quad \\text{对所有 } v_{h} \\in V_{h}, \\qquad u_{h}^{k+1} := u_{h}^{k} + \\delta u_{h}^{k}。$$\n令线性化误差为 $e_{\\mathrm{lin}}^{k} := u_{h}^{\\star} - u_{h}^{k}$，离散化误差为 $e_{\\mathrm{disc}} := u - u_{h}^{\\star}$。一个实际的目标是在每个网格上，当线性化误差与由 $\\eta_{h}$ 指示的离散化误差相平衡时，停止牛顿迭代，从而在网格加密之前，进一步的非线性迭代不具成本效益。\n\n对于一个与 $h$ 和 $k$ 无关的固定参数 $0  \\theta  1$，以下哪个停止准则是为实现这种平衡而设置的合适的实用规则？\n\nA. 在第一个满足 $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$ 的 $k$ 处停止。\n\nB. 在第一个满足 $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$ 的 $k$ 处停止。\n\nC. 在第一个满足 $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})^{2}$ 的 $k$ 处停止。\n\nD. 在第一个满足 $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\|F_{h}(u_{h}^{k-1})\\|_{V_{h}'}$ 的 $k$ 处停止。\n\nE. 在第一个满足 $\\eta_{h}(u_{h}^{k}) \\le \\theta \\,\\|\\delta u_{h}^{k}\\|_{E}$ 的 $k$ 处停止。", "solution": "目标是为牛顿法设计一个实用的停止准则，以平衡线性化误差 $\\|e_{\\mathrm{lin}}^{k}\\|_E = \\|u_{h}^{\\star} - u_{h}^{k}\\|_E$ 与离散化误差 $\\|e_{\\mathrm{disc}}\\|_E = \\|u - u_{h}^{\\star}\\|_E$。一个合理的平衡原则是，当代数求解器（牛顿法）贡献的误差（线性化误差）小于当前网格固有误差（离散化误差）的某个比例时，停止求解。这可以表述为：\n$$ \\|e_{\\mathrm{lin}}^{k}\\|_E \\le \\gamma \\|e_{\\mathrm{disc}}\\|_E $$\n其中 $\\gamma$ 是某个选定的容差参数（在问题中记为 $\\theta$）。\n\n量 $\\|e_{\\mathrm{lin}}^{k}\\|_E$ 和 $\\|e_{\\mathrm{disc}}\\|_E$ 无法直接计算。我们必须依赖可计算的估计。\n1.  问题为离散化误差提供了一个可靠的估计子 $\\eta_h$：$\\|e_{\\mathrm{disc}}\\|_E \\le C_{\\mathrm{rel}}\\eta_h(u_h^\\star)$。由于估计子的稳定性，对于接近 $u_h^\\star$ 的 $u_h^k$，我们可以使用 $\\eta_h(u_h^k)$ 作为 $\\eta_h(u_h^\\star)$ 的一个实际替代。因此，我们期望的准则的右侧可以用 $\\eta_h(u_h^k)$ 的倍数来估计。\n2.  我们需要一个线性化误差 $\\|e_{\\mathrm{lin}}^{k}\\|_E$ 的可计算估计。让我们分析牛顿迭代中可获得的量：更新量 $\\delta u_h^k$ 和残差 $F_h(u_h^k)$。\n\n**线性化误差与可计算量之间的关系**\n\n-   **牛顿更新量 $\\delta u_h^k$**：在牛顿法的标准假设下，特别是当迭代点 $u_h^k$ 足够接近解 $u_h^\\star$ 时，更新量的范数近似于误差的范数。具体来说，可以证明\n    $$ \\lim_{k \\to \\infty, u_h^k \\to u_h^\\star} \\frac{\\|\\delta u_h^k\\|_E}{\\|e_{\\mathrm{lin}}^k\\|_E} = 1 $$\n    这意味着对于后续的迭代，$\\|\\delta u_h^k\\|_E$ 是对线性化误差 $\\|u_h^\\star - u_h^k\\|_E$ 的一个非常准确且计算方便的估计子。\n\n-   **离散残差 $F_h(u_h^k)$**：残差的范数 $\\|F_h(u_h^k)\\|_{V_h'}$ 也与线性化误差相关。\n    -   根据 $A$ 的利普希茨连续性：\n        $$ \\|F_h(u_h^k)\\|_{V_h'} = \\sup_{v_h \\in V_h, \\|v_h\\|_E=1} \\langle A(u_h^k) - A(u_h^\\star), v_h \\rangle \\le \\|A(u_h^k) - A(u_h^\\star)\\|_{V'} \\le L \\|u_h^k - u_h^\\star\\|_E = L \\|e_{\\mathrm{lin}}^k\\|_E. $$\n    -   根据 $A$ 的强单调性：\n        $$ \\alpha \\|e_{\\mathrm{lin}}^k\\|_E^2 = \\alpha \\|u_h^k - u_h^\\star\\|_E^2 \\le \\langle A(u_h^k) - A(u_h^\\star), u_h^k - u_h^\\star \\rangle = F_h(u_h^k)[u_h^k - u_h^\\star]. $$\n        使用对偶范数的定义，我们得到：\n        $$ \\alpha \\|e_{\\mathrm{lin}}^k\\|_E^2 \\le \\|F_h(u_h^k)\\|_{V_h'} \\|u_h^k - u_h^\\star\\|_E = \\|F_h(u_h^k)\\|_{V_h'} \\|e_{\\mathrm{lin}}^k\\|_E. $$\n        这意味着 $\\|e_{\\mathrm{lin}}^k\\|_E \\le \\frac{1}{\\alpha} \\|F_h(u_h^k)\\|_{V_h'}$。\n    -   结合这两个不等式，我们有：\n        $$ \\frac{1}{L} \\|F_h(u_h^k)\\|_{V_h'} \\le \\|e_{\\mathrm{lin}}^k\\|_E \\le \\frac{1}{\\alpha} \\|F_h(u_h^k)\\|_{V_h'}. $$\n    这表明线性化误差 $\\|e_{\\mathrm{lin}}^k\\|_E$ 与离散残差范数 $\\|F_h(u_h^k)\\|_{V_h'}$ 是范数等价的。等价常数取决于算子 $A$ 的性质。\n\n**评估停止准则**\n\n期望的实用准则为 $\\|e_{\\mathrm{lin}}^k\\|_E \\le \\theta' \\eta_h(u_h^k)$，其中 $\\theta'$ 是某个参数。现在我们可以评估给定的选项。\n\n-   **A. 在第一个满足 $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$ 的 $k$ 处停止。**\n    该准则使用 $\\|\\delta u_h^k\\|_E$ 作为线性化误差 $\\|e_{\\mathrm{lin}}^k\\|_E$ 的估计子。如上所述，这是一个渐近精确且计算成本低的估计子。该准则直接实现了平衡原则：当估计的线性化误差是估计的离散化误差的一小部分 $\\theta$ 时停止。这是自适应有限元软件中一个标准的、非常实用的规则。\n    **判断：正确。**\n\n-   **B. 在第一个满足 $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\eta_{h}(u_{h}^{k})$ 的 $k$ 处停止。**\n    该准则使用残差范数 $\\|F_h(u_h^k)\\|_{V_h'}$ 作为线性化误差的代理。由于 $\\|e_{\\mathrm{lin}}^k\\|_E$ 和 $\\|F_h(u_h^k)\\|_{V_h'}$ 是范数等价的，该准则也体现了相同的平衡原则。它等价于当 $C_1 \\|e_{\\mathrm{lin}}^k\\|_E \\le \\theta \\eta_h(u_h^k)$（对于某个常数 $C_1 > 0$）时停止。由于 $\\theta$ 是一个可调参数，这是平衡目标的一个有效表述。虽然计算上可能不如选项 A 实用（对偶范数 $\\| \\cdot \\|_{V_h'}$ 的评估可能成本高昂），但它是一个理论上合理且适当的规则。\n    **判断：正确。**\n\n-   **C. 在第一个满足 $\\|\\delta u_{h}^{k}\\|_{E} \\le \\theta \\,\\eta_{h}(u_{h}^{k})^{2}$ 的 $k$ 处停止。**\n    该准则将线性化误差估计 $\\|\\delta u_h^k\\|_E$ 与离散化误差估计的平方进行比较。如果网格尺寸 $h$ 很小，$\\eta_h(u_h^k)$ 将会很小，而 $\\eta_h(u_h^k)^2$ 将会小得多。这条规则会迫使非线性求解器继续迭代，直到线性化误差相对于离散化误差可以忽略不计。这在计算上是浪费的，因为总误差仍将由离散化误差主导。这种做法被称为“过度求解”，与高效自适应方法的目标背道而驰。\n    **判断：不正确。**\n\n-   **D. 在第一个满足 $\\|F_{h}(u_{h}^{k})\\|_{V_{h}'} \\le \\theta \\,\\|F_{h}(u_{h}^{k-1})\\|_{V_{h}'}$ 的 $k$ 处停止。**\n    该准则要求每一步的残差范数都减少一个因子 $\\theta  1$。这是任何迭代求解器的一个标准收敛性检查。然而，这是一个关于求解器进展的*内部*检查，并未将求解器的状态与离散化误差联系起来。它完全忽略了估计子 $\\eta_h$，因此未能执行所要求的误差分量平衡。人们可能满足了这个准则，但线性化误差仍然远大于或远小于离散化误差。\n    **判断：不正确。**\n\n-   **E. 在第一个满足 $\\eta_{h}(u_{h}^{k}) \\le \\theta \\,\\|\\delta u_{h}^{k}\\|_{E}$ 的 $k$ 处停止。**\n    这可以改写为 $\\|\\delta u_{h}^{k}\\|_{E} \\ge \\frac{1}{\\theta} \\eta_{h}(u_{h}^{k})$。由于 $\\theta  1$，我们有 $1/\\theta > 1$。该准则建议在估计的线性化误差*大于*估计的离散化误差时停止。这与期望的目标相反。它会过早地终止牛顿迭代，此时线性化误差仍然是总误差的主导部分。正确的策略是迭代直到线性化误差成为离散化误差的一个*小部分*。\n    **判断：不正确。**\n\n选项 A 和 B 都是实现了平衡线性化误差和离散化误差原则的适当规则。它们都将线性化误差的一个有效的、可计算的度量与离散化误差的后验估计进行比较。", "answer": "$$\\boxed{AB}$$", "id": "3359724"}, {"introduction": "经典的后验误差估计理论在标准椭圆问题中表现出色，但面对像相场模型（如 Allen-Cahn 方程）这样的多尺度复杂问题时，我们需要设计更精细的指示器。本练习 ([@problem_id:3359770]) 引导您为 Allen-Cahn 方程构建一个定制化的误差指示器，它不仅包含传统的残差项，还特别加入了捕捉界面曲率和惩罚界面分辨率不足（相对于界面宽度 $\\varepsilon$）的项。通过编程实现这一高级指示器，您将体验到如何为前沿科学问题量身定制误差估计工具，以有效驱动自适应网格加密。", "problem": "为稳态 Allen–Cahn 算子构建一个后验误差指示子，该指示子能随扩散界面宽度正确缩放，捕捉曲率驱动的界面误差，同时强制执行界面分辨率准则。考虑一维（空间维度为 $1$）的 Allen–Cahn 偏微分方程（PDE）：\n$$u_t = \\varepsilon^2 u_{xx} - f(u), \\quad f(u) = u^3 - u,$$ \n定义在区域 $[-L,L]$ 上，其中 $L0$，界面宽度参数 $\\varepsilon \\in (0,1)$。其稳态方程为\n$$\\varepsilon^2 u_{xx} - f(u) = 0.$$\n一个经典的稳态前沿剖面是\n$$u(x) = \\tanh\\!\\left(\\frac{x}{\\sqrt{2}\\,\\varepsilon}\\right),$$ \n其过渡层的厚度量级为 $\\mathcal{O}(\\varepsilon)$。\n\n您将使用协调、连续、分片线性有限元函数 $u_h$（也可解释为在均匀网格上的分片线性节点插值），该函数通过在 $[-L,L]$ 上包含 $N$ 个单元的均匀网格上对精确剖面进行节点插值得到。令 $h = 2L/N$ 表示单元尺寸。您的任务是推导并实现一个在每个单元 $K$ 上的可计算残差型后验误差指示子 $\\eta_K$ 和一个全局估计子 $\\mathcal{E}$，它们满足以下所有条件：\n\n- 它们仅由 $u_h$ 可得的量构建（在估计子计算过程中，除了用于定义 $u_h$ 的节点值外，不使用关于精确解 $u$ 的任何信息）。\n- 它们能随 $\\varepsilon$ 正确缩放，以反映界面附近扩散与反应之间的平衡。\n- 它们包含一个曲率驱动的代理项，以反映界面运动和几何误差随曲率缩放的事实，并且已知 Allen–Cahn 动力学在锐利界面极限下是由曲率驱动的。\n- 它们包含一个界面分辨率指示子，当 $h$ 相对于 $\\varepsilon$ 和局部梯度大小不够小时，该指示子将惩罚分辨率不足的情况。\n\n从稳态算子 \n$$\\mathcal{L}(u) := \\varepsilon^2 u_{xx} - f(u),$$ \n的变分结构以及带非线性的反应扩散算子的标准基于残差的后验估计出发，推导、论证并实现在 $[-L,L]$ 均匀网格上的以下可计算逐单元量：\n\n1. 一个单元残差贡献 $I_{1,K}$，其启发于强残差 $R_K(x) := \\mathcal{L}(u_h)|_K(x)$ 和局部气泡函数稳定性界。在每个单元内部，对于分片线性的 $u_h$，有 $u_h'' \\equiv 0$ 且 $R_K(x) = - f(u_h(x))$。使用基于求积的近似来计算\n$$I_{1,K}^2 := h_K^2 \\,\\Big\\|\\; f(u_h)\\;\\Big\\|_{L^2(K)}^2 \\approx h_K \\int_K \\big(f(u_h(x))\\big)^2 \\,dx.$$\n\n2. 一个边跳跃贡献 $I_{2,K}$，它将内部节点通量跳跃 \n$$J_i := \\varepsilon\\,\\big|\\,\\llbracket u_h'\\rrbracket(x_i)\\,\\big|,$$ \n（其中 $\\llbracket u_h'\\rrbracket(x_i)$ 是导数在内部节点 $x_i$ 上的跳跃）分配到两个相邻的单元。对于均匀网格和分片线性的 $u_h$，单元斜率是常数，跳跃由相邻斜率计算。将每个 $J_i$ 平均分配给其左右相邻的单元，使得每个单元从其两个端点（如果是内部单元）各累积一半。\n\n3. 一个界面分辨率贡献 $I_{3,K}$，当局部无量纲比 \n$$\\rho_K := \\frac{h_K \\,\\max_{x\\in K}|u_h'(x)|}{\\varepsilon}$$ \n超过阈值 $\\rho_0$ 时，该项会惩罚分辨率不足的情况。使用 \n$$I_{3,K} := \\max\\!\\big(0, \\rho_K - \\rho_0\\big),$$ \n并固定阈值为 $\\rho_0 = 0.5$。\n\n4. 一个曲率代理贡献 $I_{4,K}$，其启发于曲率驱动的界面运动和将界面几何误差与 $\\varepsilon\\,\\kappa$（其中 $\\kappa$ 是曲率）联系起来的匹配渐近缩放。在一维中，水平集曲率代理可以通过 \n$$\\kappa(x_i) \\approx \\frac{|u_{xx}(x_i)|}{|u_x(x_i)| + \\delta},$$ \n来近似，其中 $\\delta0$ 是一个小数以避免除以零；在节点处使用 $u_h$ 节点值的中心有限差分来近似 $u_{xx}$ 和 $u_x$。定义单元贡献为\n$$I_{4,K} := \\varepsilon\\, h_K \\,\\max_{x_i \\in \\partial K} \\kappa(x_i)。$$\n\n将以上各项组合成单个单元指示子 \n$$\\eta_K := \\sqrt{ I_{1,K}^2 + I_{2,K}^2 + I_{4,K}^2 } \\;+\\; I_{3,K},$$ \n并定义全局估计子 \n$$\\mathcal{E} := \\Big(\\sum_{K} \\eta_K^2 \\Big)^{1/2}。$$\n\n为精确前沿 \n$$u(x) = \\tanh\\!\\left(\\frac{x}{\\sqrt{2}\\,\\varepsilon}\\right)$$ \n在 $[-L,L]$（其中 $L=1$）上包含 $N$ 个单元的均匀网格上的插值函数 $u_h$ 实现上述指示子。使用两点高斯求积来近似 $I_{1,K}$ 中的积分。对节点曲率代理使用中心差分，并按规定分配跳跃项。设置 $\\rho_0 = 0.5$ 并在曲率代理中使用 $\\delta = 10^{-12}$。\n\n您的程序必须为以下每个测试用例（即测试套件）计算 $\\mathcal{E}$：\n\n- 情况 A（分辨率良好）：$\\varepsilon = 0.05$，$L = 1$，$N = 200$。\n- 情况 B（临界分辨率）：$\\varepsilon = 0.05$，$L = 1$，$N = 40$。\n- 情况 C（薄界面，分辨率临界）：$\\varepsilon = 0.01$，$L = 1$，$N = 200$。\n- 情况 D（分辨率不足）：$\\varepsilon = 0.02$，$L = 1$，$N = 20$。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的实数列表，每个数字精确到小数点后六位，顺序为 [情况 A, 情况 B, 情况 C, 情况 D]。例如：\n\"[0.123456,0.234567,0.345678,0.456789]\"。不应打印其他任何文本。\n\n在此设置中，所有量均为纯数学量且无量纲；不需要物理单位。不涉及角度。不使用百分比。要求的输出是实数。", "solution": "该问题涉及一维空间中的稳态 Allen-Cahn 方程，由下式给出\n$$ \\mathcal{L}(u) := \\varepsilon^2 u_{xx} - f(u) = 0, $$\n其中反应项为 $f(u) = u^3 - u$。该方程定义在区域 $[-L, L]$ 上，其中 $L=1$。参数 $\\varepsilon \\in (0,1)$ 控制过渡层的宽度。精确解的剖面由下式给出\n$$ u(x) = \\tanh\\left(\\frac{x}{\\sqrt{2}\\,\\varepsilon}\\right) $$\n\n我们的任务是为一个连续的分片线性有限元近似解 $u_h$ 计算一个后验误差估计子 $\\mathcal{E}$。该近似解 $u_h$ 是通过在均匀网格上对精确解 $u(x)$ 进行节点插值而构造的。\n\n首先，我们定义离散设置。区域 $[-L, L]$被划分为 $N$ 个均匀单元，$K_j = [x_{j-1}, x_j]$，其中 $j=1, \\dots, N$。网格节点为 $x_i = -L + i \\cdot h$，其中 $i=0, \\dots, N$，$h = 2L/N$ 是均匀的单元尺寸。近似解 $u_h$ 在每个单元 $K_j$ 上是线性的，其节点值由 $u_h(x_i) = u(x_i)$ 给出。令 $u_i$ 表示节点值 $u_h(x_i)$。\n\n全局误差估计子 $\\mathcal{E}$ 定义为逐单元指示子 $\\eta_K$ 的 $l^2$ 和：\n$$ \\mathcal{E} := \\left(\\sum_{j=1}^{N} \\eta_{K_j}^2\\right)^{1/2}。$$\n对于一个单元 $K_j$，其单元指示子 $\\eta_{K_j}$ 是一个复合量，定义如下：\n$$ \\eta_{K_j} := \\sqrt{ I_{1,K_j}^2 + I_{2,K_j}^2 + I_{4,K_j}^2 } \\;+\\; I_{3,K_j}。$$\n我们现在详细说明每个分量 $I_{m,K_j}$ 的计算。\n\n**1. 单元残差贡献 $I_{1,K}$**\n该项量化了每个单元内由偏微分方程残差引起的误差。强残差为 $R(u_h) = \\varepsilon^2 u_{h,xx} - f(u_h)$。由于 $u_h$ 是分片线性的，其二阶导数 $u_{h,xx}$ 在每个单元内部为零。因此，单元 $K_j$ 上的残差简化为 $R(u_h)|_{K_j}(x) = -f(u_h(x))$。该贡献定义为：\n$$ I_{1,K_j}^2 = h_j \\int_{K_j} \\left(f(u_h(x))\\right)^2 dx。$$\n为了计算该积分，我们在参考区间 $[-1, 1]$ 上使用两点高斯求积，求积点为 $\\xi_{1,2} = \\mp 1/\\sqrt{3}$，权重为 $\\omega_{1,2} = 1$。从参考坐标 $\\xi$ 到物理坐标 $x \\in K_j = [x_{j-1}, x_j]$ 的映射为 $x(\\xi) = x_{j-1} + \\frac{h}{2}(1+\\xi)$。在点 $x(\\xi)$ 处 $u_h$ 的值由其节点值 $u_{j-1}$ 和 $u_j$ 线性插值给出：$u_h(x(\\xi)) = u_{j-1}\\frac{1-\\xi}{2} + u_j\\frac{1+\\xi}{2}$。\n$u_h$ 在求积点的值为：\n$$ u_{h,1} = u_h(x(-1/\\sqrt{3})) = u_{j-1}\\frac{1+1/\\sqrt{3}}{2} + u_j\\frac{1-1/\\sqrt{3}}{2} $$\n$$ u_{h,2} = u_h(x(+1/\\sqrt{3})) = u_{j-1}\\frac{1-1/\\sqrt{3}}{2} + u_j\\frac{1+1/\\sqrt{3}}{2} $$\n该积分随后近似为：\n$$ \\int_{K_j} (f(u_h(x)))^2 dx \\approx \\frac{h}{2} \\sum_{q=1}^2 (f(u_{h,q}))^2 = \\frac{h}{2} \\left[ (f(u_{h,1}))^2 + (f(u_{h,2}))^2 \\right]。$$\n因此，我们有：\n$$ I_{1,K_j}^2 \\approx \\frac{h^2}{2} \\left[ \\left(u_{h,1}^3 - u_{h,1}\\right)^2 + \\left(u_{h,2}^3 - u_{h,2}\\right)^2 \\right]。$$\n\n**2. 边跳跃贡献 $I_{2,K}$**\n该项说明了 $u_h$ 的导数在内部节点上的跳跃，这对误差有贡献。在每个单元 $K_j$ 上，斜率 $s_j = u_h'|_{K_j}$ 是常数：$s_j = (u_j - u_{j-1})/h$。在内部节点 $x_i$（$i=1, \\dots, N-1$）处导数的跳跃是 $\\llbracket u_h' \\rrbracket(x_i) = s_{i+1} - s_i$。问题在每个内部节点处定义了一个量 $J_i$：\n$$ J_i := \\varepsilon\\,\\big|\\,\\llbracket u_h'\\rrbracket(x_i)\\,\\big| = \\varepsilon |s_{i+1} - s_i| = \\frac{\\varepsilon}{h} |(u_{i+1}-u_i) - (u_i-u_{i-1})| = \\frac{\\varepsilon}{h} |u_{i+1} - 2u_i + u_{i-1}|。$$\n这个跳跃 $J_i$ 被平均分配给两个相邻的单元 $K_i$ 和 $K_{i+1}$。对于一个内部单元 $K_j$（$j=2, \\dots, N-1$），它从其左节点 $x_{j-1}$ 和右节点 $x_j$ 接收贡献。其贡献为：\n$$ I_{2,K_j} = \\frac{1}{2}(J_{j-1} + J_j) = \\frac{\\varepsilon}{2} (|s_j - s_{j-1}| + |s_{j+1} - s_j|)。$$\n对于边界单元 $K_1$ 和 $K_N$，我们假设在区域边界 $x_0$ 和 $x_N$ 处没有跳跃。因此：\n$$ I_{2,K_1} = \\frac{1}{2}J_1 = \\frac{\\varepsilon}{2} |s_2 - s_1| $$\n$$ I_{2,K_N} = \\frac{1}{2}J_{N-1} = \\frac{\\varepsilon}{2} |s_N - s_{N-1}|。$$\n\n**3. 界面分辨率贡献 $I_{3,K}$**\n如果网格尺寸 $h$ 相对于界面宽度 $\\varepsilon$ 过大而无法解析界面剖面，该项将作为惩罚项。它基于无量纲比：\n$$ \\rho_{K_j} := \\frac{h \\,\\max_{x\\in K_j}|u_h'(x)|}{\\varepsilon} = \\frac{h |s_j|}{\\varepsilon} = \\frac{|u_j - u_{j-1}|}{\\varepsilon}。$$\n该贡献被定义为一个惩罚项，当此比率超过阈值 $\\rho_0 = 0.5$ 时激活：\n$$ I_{3,K_j} := \\max\\!\\big(0, \\rho_{K_j} - \\rho_0\\big)。$$\n该项在平方根之外被加到指示子中，强调其作为对分辨率不足的惩罚作用。\n\n**4. 曲率代理贡献 $I_{4,K}$**\n该项的动机是，在 Allen-Cahn 方程的锐利界面极限下，界面按曲率流演化。表示界面几何形状的误差与曲率有关。在一维中，节点 $x_i$ 处的曲率代理 $\\kappa$ 可以使用节点值的中心差分来近似：\n$$ \\kappa(x_i) \\approx \\frac{|u_{xx}(x_i)|}{|u_x(x_i)| + \\delta}。$$\n我们对内部节点（$i=1, \\dots, N-1$）的导数近似如下：\n$$ u_x(x_i) \\approx \\frac{u_{i+1} - u_{i-1}}{2h}, \\quad u_{xx}(x_i) \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}。$$\n对于边界节点 $x_0$ 和 $x_N$，由于无法使用中心差分，我们设置 $\\kappa(x_0)=0$ 和 $\\kappa(x_N)=0$。这是合理的，因为界面中心在 $x=0$ 处，且解的剖面在区域边界 $x=\\pm L$ 处几乎是常数。一个小的正则化参数 $\\delta=10^{-12}$ 可防止除以零。\n单元贡献 $I_{4,K_j}$ 随后定义为：\n$$ I_{4,K_j} := \\varepsilon\\, h \\,\\max_{x_i \\in \\{x_{j-1}, x_j\\}} \\kappa(x_i) = \\varepsilon\\, h \\,\\max(\\kappa(x_{j-1}), \\kappa(x_j))。$$\n\n在所有四个分量都定义好后，我们可以为每个单元 $j=1, \\dots, N$ 计算 $\\eta_{K_j}$，并最终为问题陈述中提供的每个测试用例计算全局估计子 $\\mathcal{E}$。", "answer": "\"[0.170669,0.697476,0.490715,0.999677]\"", "id": "3359770"}]}