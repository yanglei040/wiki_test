{"hands_on_practices": [{"introduction": "任何龙格-库塔（Runge-Kutta）方法的核心特性是其精度阶数，它直接决定了算法的收敛速度。此练习提供了一个绝佳的动手实践机会，您将通过直接计算来验证经典的四阶龙格-库塔（RK4）方法如何满足其代数“阶数条件”[@problem_id:3441463]。通过这个过程，您将加深对龙格-库塔方法系数与其理论精度之间内在联系的理解。", "problem": "考虑由线性守恒律的间断Galerkin（DG）空间离散化产生的半离散系统，其形式为 $y^{\\prime}(t)=F(y(t))$，其中 $y(t)\\in\\mathbb{R}^{N}$ 且 $F:\\mathbb{R}^{N}\\to\\mathbb{R}^{N}$ 足够光滑。在一个Runge-Kutta间断Galerkin（RKDG）格式中，时间积分通过一个显式$s$阶Runge-Kutta（RK）方法执行，该方法由其Butcher表系数$\\{A,b,c\\}$表征，其中$A\\in\\mathbb{R}^{s\\times s}$是严格下三角矩阵，$b\\in\\mathbb{R}^{s}$，并且$c\\in\\mathbb{R}^{s}$满足$c=A\\boldsymbol{1}$，其中$\\boldsymbol{1}\\in\\mathbb{R}^{s}$是全1向量。经典的4阶Runge-Kutta方法（记为RK4）被广泛用于RKDG时间离散化。\n\n从显式Runge-Kutta方法的基本定义以及通过Butcher根树理论和B级数的阶的概念出发，执行以下操作：\n\n- 写出经典RK4方法的Butcher表系数 $\\{A,b,c\\}$。\n- 使用最高到4阶的基本根树阶条件（从将方法的B级数与精确流的B级数相匹配推导得出），验证所有最高到4阶的代数阶条件。特别地，使用涉及$A$，$b$和$c$的标准代数形式，即\n  $$b^{\\top}\\boldsymbol{1},\\quad b^{\\top}c,\\quad b^{\\top}(c.\\!^{2}),\\quad b^{\\top}Ac,\\quad b^{\\top}(c.\\!^{3}),\\quad b^{\\top}A(c.\\!^{2}),\\quad b^{\\top}\\big(c\\!.\\!(Ac)\\big),\\quad b^{\\top}AAc$$\n  其中 $c.\\!^{k}$ 表示分量幂运算，而 $c\\!.\\!(Ac)$ 表示分量乘法。\n- 定义验证残差\n  $$S \\;=\\; \\big(b^{\\top}\\boldsymbol{1}-1\\big)^{2} \\;+\\; \\big(b^{\\top}c-\\tfrac{1}{2}\\big)^{2} \\;+\\; \\big(b^{\\top}(c.\\!^{2})-\\tfrac{1}{3}\\big)^{2} \\;+\\; \\big(b^{\\top}Ac-\\tfrac{1}{6}\\big)^{2} \\;+\\; \\big(b^{\\top}(c.\\!^{3})-\\tfrac{1}{4}\\big)^{2} \\;+\\; \\big(b^{\\top}A(c.\\!^{2})-\\tfrac{1}{12}\\big)^{2} \\;+\\; \\big(b^{\\top}\\big(c\\!.\\!(Ac)\\big)-\\tfrac{1}{8}\\big)^{2} \\;+\\; \\big(b^{\\top}AAc-\\tfrac{1}{24}\\big)^{2}.$$\n\n计算$S$的精确值，作为一个实数。无需四舍五入，不涉及单位。你的最终答案必须是单个实数。", "solution": "该问题要求我们执行一系列与经典四阶Runge-Kutta方法（RK4）相关的计算，特别是验证其最高到4阶的阶条件，然后计算验证残差$S$。\n\n首先，我们陈述经典RK4方法的Butcher表系数$\\{A, b, c\\}$，这是一个$s=4$阶的显式Runge-Kutta方法。其Butcher表如下：\n$$\n\\begin{array}{c|cccc}\n0 & 0 & 0 & 0 & 0 \\\\\n\\frac{1}{2} & \\frac{1}{2} & 0 & 0 & 0 \\\\\n\\frac{1}{2} & 0 & \\frac{1}{2} & 0 & 0 \\\\\n1 & 0 & 0 & 1 & 0 \\\\\n\\hline\n& \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6}\n\\end{array}\n$$\n从此表中，我们提取矩阵$A$和向量$b$和$c$：\n$$ A = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ \\frac{1}{2} & 0 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix}, \\quad b = \\begin{pmatrix} \\frac{1}{6} \\\\ \\frac{1}{3} \\\\ \\frac{1}{3} \\\\ \\frac{1}{6} \\end{pmatrix}, \\quad c = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 1 \\end{pmatrix} $$\n全1向量$\\boldsymbol{1}$为$\\boldsymbol{1} = [1, 1, 1, 1]^{\\top}$。我们可以验证简化假设$c = A\\boldsymbol{1}$：\n$$ A\\boldsymbol{1} = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ \\frac{1}{2} & 0 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 1 \\end{pmatrix} = c $$\n该条件得到满足。\n\n接下来，我们开始验证八个代数阶条件。\n\n1阶条件： $b^{\\top}\\boldsymbol{1} = 1$\n$$ b^{\\top}\\boldsymbol{1} = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{6} + \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{6} = \\frac{1+2+2+1}{6} = \\frac{6}{6} = 1 $$\n该条件得到满足。\n\n2阶条件： $b^{\\top}c = \\frac{1}{2}$\n$$ b^{\\top}c = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 1 \\end{pmatrix} = \\frac{1}{6}(0) + \\frac{1}{3}\\left(\\frac{1}{2}\\right) + \\frac{1}{3}\\left(\\frac{1}{2}\\right) + \\frac{1}{6}(1) = 0 + \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{6} = \\frac{3}{6} = \\frac{1}{2} $$\n该条件得到满足。\n\n3阶条件：\n1. $b^{\\top}(c.\\!^{2}) = \\frac{1}{3}$\n$c$的分量平方是 $c.\\!^{2} = [0^2, (\\frac{1}{2})^2, (\\frac{1}{2})^2, 1^2]^{\\top} = [0, \\frac{1}{4}, \\frac{1}{4}, 1]^{\\top}$。\n$$ b^{\\top}(c.\\!^{2}) = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{1}{4} \\\\ \\frac{1}{4} \\\\ 1 \\end{pmatrix} = \\frac{1}{6}(0) + \\frac{1}{3}\\left(\\frac{1}{4}\\right) + \\frac{1}{3}\\left(\\frac{1}{4}\\right) + \\frac{1}{6}(1) = 0 + \\frac{1}{12} + \\frac{1}{12} + \\frac{1}{6} = \\frac{2}{12} + \\frac{2}{12} = \\frac{4}{12} = \\frac{1}{3} $$\n该条件得到满足。\n\n2. $b^{\\top}Ac = \\frac{1}{6}$\n首先，我们计算向量$Ac$：\n$$ Ac = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ \\frac{1}{2} & 0 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix} $$\n然后，我们计算点积：\n$$ b^{\\top}Ac = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix} = \\frac{1}{3}\\left(\\frac{1}{4}\\right) + \\frac{1}{6}\\left(\\frac{1}{2}\\right) = \\frac{1}{12} + \\frac{1}{12} = \\frac{2}{12} = \\frac{1}{6} $$\n该条件得到满足。\n\n4阶条件：\n1. $b^{\\top}(c.\\!^{3}) = \\frac{1}{4}$\n$c$的分量立方是 $c.\\!^{3} = [0^3, (\\frac{1}{2})^3, (\\frac{1}{2})^3, 1^3]^{\\top} = [0, \\frac{1}{8}, \\frac{1}{8}, 1]^{\\top}$。\n$$ b^{\\top}(c.\\!^{3}) = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{1}{8} \\\\ \\frac{1}{8} \\\\ 1 \\end{pmatrix} = \\frac{1}{3}\\left(\\frac{1}{8}\\right) + \\frac{1}{3}\\left(\\frac{1}{8}\\right) + \\frac{1}{6}(1) = \\frac{1}{24} + \\frac{1}{24} + \\frac{1}{6} = \\frac{2}{24} + \\frac{4}{24} = \\frac{6}{24} = \\frac{1}{4} $$\n该条件得到满足。\n\n2. $b^{\\top}A(c.\\!^{2}) = \\frac{1}{12}$\n我们有 $c.\\!^{2} = [0, \\frac{1}{4}, \\frac{1}{4}, 1]^{\\top}$。首先，计算 $A(c.\\!^{2})$：\n$$ A(c.\\!^{2}) = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ \\frac{1}{2} & 0 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{1}{4} \\\\ \\frac{1}{4} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{8} \\\\ \\frac{1}{4} \\end{pmatrix} $$\n然后，我们计算点积：\n$$ b^{\\top}A(c.\\!^{2}) = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{8} \\\\ \\frac{1}{4} \\end{pmatrix} = \\frac{1}{3}\\left(\\frac{1}{8}\\right) + \\frac{1}{6}\\left(\\frac{1}{4}\\right) = \\frac{1}{24} + \\frac{1}{24} = \\frac{2}{24} = \\frac{1}{12} $$\n该条件得到满足。\n\n3. $b^{\\top}\\big(c\\!.\\!(Ac)\\big) = \\frac{1}{8}$\n我们有 $Ac = [0, 0, \\frac{1}{4}, \\frac{1}{2}]^{\\top}$。分量乘积 $c\\!.\\!(Ac)$ 是：\n$$ c\\!.\\!(Ac) = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 1 \\end{pmatrix} .\\!* \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\cdot 0 \\\\ \\frac{1}{2} \\cdot 0 \\\\ \\frac{1}{2} \\cdot \\frac{1}{4} \\\\ 1 \\cdot \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{8} \\\\ \\frac{1}{2} \\end{pmatrix} $$\n然后，我们计算点积：\n$$ b^{\\top}\\big(c\\!.\\!(Ac)\\big) = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{8} \\\\ \\frac{1}{2} \\end{pmatrix} = \\frac{1}{3}\\left(\\frac{1}{8}\\right) + \\frac{1}{6}\\left(\\frac{1}{2}\\right) = \\frac{1}{24} + \\frac{1}{12} = \\frac{1+2}{24} = \\frac{3}{24} = \\frac{1}{8} $$\n该条件得到满足。\n\n4. $b^{\\top}AAc = \\frac{1}{24}$\n我们有 $Ac = [0, 0, \\frac{1}{4}, \\frac{1}{2}]^{\\top}$。首先，计算 $AAc = A(Ac)$：\n$$ A(Ac) = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ \\frac{1}{2} & 0 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ \\frac{1}{4} \\end{pmatrix} $$\n然后，我们计算点积：\n$$ b^{\\top}AAc = \\begin{pmatrix} \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ \\frac{1}{4} \\end{pmatrix} = \\frac{1}{6}\\left(\\frac{1}{4}\\right) = \\frac{1}{24} $$\n该条件得到满足。\n\n最后，我们计算验证残差$S$：\n$$ S \\;=\\; \\big(b^{\\top}\\boldsymbol{1}-1\\big)^{2} \\;+\\; \\big(b^{\\top}c-\\tfrac{1}{2}\\big)^{2} \\;+\\; \\big(b^{\\top}(c.\\!^{2})-\\tfrac{1}{3}\\big)^{2} \\;+\\; \\big(b^{\\top}Ac-\\tfrac{1}{6}\\big)^{2} \\;+\\; \\big(b^{\\top}(c.\\!^{3})-\\tfrac{1}{4}\\big)^{2} \\;+\\; \\big(b^{\\top}A(c.\\!^{2})-\\tfrac{1}{12}\\big)^{2} \\;+\\; \\big(b^{\\top}\\big(c\\!.\\!(Ac)\\big)-\\tfrac{1}{8}\\big)^{2} \\;+\\; \\big(b^{\\top}AAc-\\tfrac{1}{24}\\big)^{2} $$\n如上所示，对于经典的RK4方法，每个阶条件都精确满足。因此，总和中的每一项都为零。\n$$ S = (1-1)^2 + (\\tfrac{1}{2}-\\tfrac{1}{2})^2 + (\\tfrac{1}{3}-\\tfrac{1}{3})^2 + (\\tfrac{1}{6}-\\tfrac{1}{6})^2 + (\\tfrac{1}{4}-\\tfrac{1}{4})^2 + (\\tfrac{1}{12}-\\tfrac{1}{12})^2 + (\\tfrac{1}{8}-\\tfrac{1}{8})^2 + (\\tfrac{1}{24}-\\tfrac{1}{24})^2 = 0 $$", "answer": "$$\\boxed{0}$$", "id": "3441463"}, {"introduction": "在求解双曲型偏微分方程时，仅仅保证精度是不够的，维持解的稳定性（例如总变差不增或无新振荡）同样至关重要。强稳定性保持（Strong Stability Preserving, SSP）方法正是为此而生，此练习将指导您推导一个著名的三阶SSP-RK方法的“Shu-Osher”表示形式[@problem_id:3441464]。这项实践揭示了SSP方法如何被巧妙地构造为一系列稳定（满足CFL条件）的前向欧拉步骤的凸组合，从而从根本上保证了其稳定性。", "problem": "考虑一个一维标量守恒律，其空间离散采用间断 Galerkin (DG) 方法，并使用单调数值通量和稳定斜率限制器，由此产生一个形式为 $u^{\\prime}(t)=L(u(t))$ 的常微分方程组。假设存在一个范数或半范数 $\\|\\cdot\\|$ 和一个前向欧拉时间步长阈值 $\\Delta t_{\\mathrm{FE}}>0$，使得对于所有的 $u$，只要满足 $0\\le \\Delta t\\le \\Delta t_{\\mathrm{FE}}$，前向欧拉步 $u^{+}=u+\\Delta t\\,L(u)$ 在该范数下都是非扩张的。\n\n设时间离散方法为 Shu 和 Osher 提出的三阶段三阶强稳定性保持 Runge–Kutta (SSPRK) 方法，记为 SSPRK($3,3$)，其 Butcher 形式由以下系数给出：\n- $c_{1}=0$, $c_{2}=1$, $c_{3}=\\tfrac{1}{2}$,\n- $a_{21}=1$, $a_{31}=\\tfrac{1}{4}$, $a_{32}=\\tfrac{1}{4}$，其余 $a_{ij}=0$,\n- $b_{1}=\\tfrac{1}{6}$, $b_{2}=\\tfrac{1}{6}$, $b_{3}=\\tfrac{2}{3}$。\n\n从与这些 Butcher 系数相关联的显式 Runge–Kutta 阶段定义和更新出发，推导每个阶段的 Shu–Osher 凸组合表示，即把每个内部阶段和最终更新表示为形如 $Y+\\Delta t\\,L(Y)$ 的项的凸组合。然后，使用强稳定性保持 (SSP) 的定义——如果一个方法在 $0\\le \\Delta t \\le C\\,\\Delta t_{\\mathrm{FE}}$ 的条件下，可以写成有效前向欧拉子步长至多为 $\\Delta t$ 的前向欧拉步的凸组合，则该方法是 SSP 的，系数为 $C>0$——根据你得到的凸组合，计算 SSPRK($3,3$) 的最优 SSP 系数 $C$。\n\n最终答案仅提供 $C$ 的值。不包含任何单位。无需四舍五入。", "solution": "问题要求推导三阶段三阶强稳定性保持 Runge–Kutta 方法 SSPRK($3,3$) 的 Shu–Osher 凸组合表示，并随后计算其最优 SSP 系数 $C$。\n\n常微分方程组由 $u^{\\prime}(t)=L(u(t))$ 给出。前向欧拉方法 $u^{+} = u + \\Delta t\\,L(u)$ 被假定在范数 $\\|\\cdot\\|$ 下是非扩张的，即 $\\|u^{+}\\| \\le \\|u\\|$，只要时间步长 $\\Delta t$ 满足 $0 \\le \\Delta t \\le \\Delta t_{\\mathrm{FE}}$。\n\nSSPRK($3,3$) 方法由以下 Butcher 系数定义：\n$c_{1}=0$, $c_{2}=1$, $c_{3}=\\frac{1}{2}$\n$a_{21}=1$\n$a_{31}=\\frac{1}{4}$, $a_{32}=\\frac{1}{4}$\n$b_{1}=\\frac{1}{6}$, $b_{2}=\\frac{1}{6}$, $b_{3}=\\frac{2}{3}$\n\n令 $u_n$ 表示在时间 $t_n$ 的数值解。显式 Runge-Kutta 方法通过在中间阶段计算函数 $L$ 的值来计算 $t_{n+1} = t_n + \\Delta t$ 时的解。我们用 $Y_i$ 表示 $L$ 的参数。\n\n一般三阶段 RK 方法的标准形式是：\n$k_1 = L(Y_1)$，其中 $Y_1 = u_n$\n$k_2 = L(Y_2)$，其中 $Y_2 = u_n + \\Delta t \\, a_{21} k_1$\n$k_3 = L(Y_3)$，其中 $Y_3 = u_n + \\Delta t (a_{31} k_1 + a_{32} k_2)$\n$u_{n+1} = u_n + \\Delta t (b_1 k_1 + b_2 k_2 + b_3 k_3)$\n\n使用 SSPRK($3,3$) 的给定系数：\n$Y_1 = u_n$\n$Y_2 = u_n + \\Delta t L(Y_1)$\n$Y_3 = u_n + \\frac{\\Delta t}{4} L(Y_1) + \\frac{\\Delta t}{4} L(Y_2)$\n$u_{n+1} = u_n + \\frac{\\Delta t}{6} L(Y_1) + \\frac{\\Delta t}{6} L(Y_2) + \\frac{2\\Delta t}{3} L(Y_3)$\n\n任务是把这个方法改写成 Shu–Osher 凸组合形式，其中每个阶段都表示为先前阶段值和类前向欧拉步的凸组合。我们如下定义中间解 $u^{(i)}$，从 $u^{(0)} = u_n$ 开始。\n\n**阶段 1：**\n第一阶段更新，通常记作 $u^{(1)}$，是由 $u_n$ 出发的一个前向欧拉步形成的：\n$u^{(1)} = u_n + \\Delta t L(u_n) = u^{(0)} + \\Delta t L(u^{(0)})$\n这显然是一个（只有一个项的）凸组合。注意到 $u^{(1)}$ 与用于计算 $k_2$ 的阶段值 $Y_2$ 相同。因此，$L(Y_2) = L(u^{(1)})$。\n\n**阶段 2：**\n计算的下一阶段，我们称之为 $u^{(2)}$，对应于阶段值 $Y_3$。我们必须将 $Y_3$ 表示为凸组合。\n$u^{(2)} \\equiv Y_3 = u_n + \\frac{\\Delta t}{4} L(u_n) + \\frac{\\Delta t}{4} L(u^{(1)})$\n根据 $u^{(1)}$ 的定义，我们可以写出 $L(u_n) = \\frac{u^{(1)} - u_n}{\\Delta t}$。将此代入 $u^{(2)}$ 的表达式中：\n$u^{(2)} = u_n + \\frac{\\Delta t}{4} \\left( \\frac{u^{(1)} - u_n}{\\Delta t} \\right) + \\frac{\\Delta t}{4} L(u^{(1)})$\n$u^{(2)} = u_n + \\frac{1}{4}(u^{(1)} - u_n) + \\frac{\\Delta t}{4} L(u^{(1)})$\n$u^{(2)} = \\frac{3}{4} u_n + \\frac{1}{4} u^{(1)} + \\frac{1}{4} \\Delta t L(u^{(1)})$\n这可以组合为：\n$u^{(2)} = \\frac{3}{4} u_n + \\frac{1}{4} \\left( u^{(1)} + \\Delta t L(u^{(1)}) \\right)$\n这将 $u^{(2)}$ 表示为 $u_n$（即 $u^{(0)}$）和项 $u^{(1)} + \\Delta t L(u^{(1)})$ 的凸组合。该项是从 $u^{(1)}$ 开始、步长为 $\\Delta t$ 的前向欧拉步。系数 $\\frac{3}{4}$ 和 $\\frac{1}{4}$ 是正数，且和为 1。\n\n**阶段 3 (最终更新):**\n最后，我们将解 $u_{n+1}$ 表示为涉及 $u_n$、$u^{(1)}$ 和 $u^{(2)}$ 的凸组合。SSPRK($3,3$) 最终阶段的规范 Shu-Osher 形式是：\n$u_{n+1} = \\frac{1}{3} u_n + \\frac{2}{3} \\left( u^{(2)} + \\Delta t L(u^{(2)}) \\right)$\n这是 $u_n$ 和一个从 $u^{(2)}$ 开始、步长为 $\\Delta t$ 的前向欧拉步的凸组合。系数是 $\\frac{1}{3}$ 和 $\\frac{2}{3}$。\n让我们验证此形式与 Butcher 公式等价：\n$u_{n+1} = \\frac{1}{3} u_n + \\frac{2}{3} u^{(2)} + \\frac{2}{3} \\Delta t L(u^{(2)})$\n代入 $u^{(2)} = u_n + \\frac{\\Delta t}{4} L(u_n) + \\frac{\\Delta t}{4} L(u^{(1)})$ 的表达式：\n$u_{n+1} = \\frac{1}{3} u_n + \\frac{2}{3} \\left( u_n + \\frac{\\Delta t}{4} L(u_n) + \\frac{\\Delta t}{4} L(u^{(1)}) \\right) + \\frac{2}{3} \\Delta t L(u^{(2)})$\n$u_{n+1} = \\left(\\frac{1}{3} + \\frac{2}{3}\\right) u_n + \\frac{2}{12} \\Delta t L(u_n) + \\frac{2}{12} \\Delta t L(u^{(1)}) + \\frac{2}{3} \\Delta t L(u^{(2)})$\n$u_{n+1} = u_n + \\frac{1}{6} \\Delta t L(u_n) + \\frac{1}{6} \\Delta t L(u^{(1)}) + \\frac{2}{3} \\Delta t L(u^{(2)})$\n这与 Butcher 更新公式相匹配，因为 $L(u_n)$、$L(u^{(1)})$ 和 $L(u^{(2)})$ 分别对应于 $k_1$、$k_2$ 和 $k_3$。\n\n完整的 Shu–Osher 表示为：\n1. $u^{(0)} = u_n$\n2. $u^{(1)} = u^{(0)} + \\Delta t L(u^{(0)})$\n3. $u^{(2)} = \\frac{3}{4} u^{(0)} + \\frac{1}{4} \\left( u^{(1)} + \\Delta t L(u^{(1)}) \\right)$\n4. $u_{n+1} = \\frac{1}{3} u^{(0)} + \\frac{2}{3} \\left( u^{(2)} + \\Delta t L(u^{(2)}) \\right)$\n\n现在，我们确定最优的 SSP 系数 $C$。如果在时间步长限制 $\\Delta t \\le C \\Delta t_{\\mathrm{FE}}$ 下，解的范数不增加，即 $\\|u_{n+1}\\| \\le \\|u_n\\|$，则该方法是 SSP 的。如果 Shu-Osher 表示的每个阶段本身都是一个非扩张操作，则可以实现此性质。\n\n我们将前向欧拉算子表示为 $FE(y, \\delta t) = y + \\delta t L(y)$。已知如果 $\\delta t \\le \\Delta t_{\\mathrm{FE}}$，则 $\\|FE(y, \\delta t)\\| \\le \\|y\\|$。\n\n这些阶段可以写成：\n1. $u^{(1)} = FE(u^{(0)}, \\Delta t)$\n2. $u^{(2)} = \\frac{3}{4} u^{(0)} + \\frac{1}{4} FE(u^{(1)}, \\Delta t)$\n3. $u_{n+1} = \\frac{1}{3} u^{(0)} + \\frac{2}{3} FE(u^{(2)}, \\Delta t)$\n\n为了使方法是非扩张的，即 $\\|u_{n+1}\\| \\le \\|u_n\\| = \\|u^{(0)}\\|$，我们必须确保每一步都保持这个性质。\n1. 为了 $\\|u^{(1)}\\| \\le \\|u^{(0)}\\|$，我们需要 $FE(u^{(0)}, \\Delta t)$ 中使用的步长不超过 $\\Delta t_{\\mathrm{FE}}$。这给出了条件 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$。\n\n2. 假设 $\\|u^{(1)}\\| \\le \\|u^{(0)}\\|$，我们分析 $u^{(2)}$。\n$\\|u^{(2)}\\| = \\left\\| \\frac{3}{4} u^{(0)} + \\frac{1}{4} FE(u^{(1)}, \\Delta t) \\right\\|$\n根据三角不等式和凸组合的性质：\n$\\|u^{(2)}\\| \\le \\frac{3}{4} \\|u^{(0)}\\| + \\frac{1}{4} \\|FE(u^{(1)}, \\Delta t)\\|$\n为了 $\\|FE(u^{(1)}, \\Delta t)\\| \\le \\|u^{(1)}\\|$，我们要求其步长 $\\Delta t$ 满足 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$。\n如果此条件成立，则 $\\|u^{(2)}\\| \\le \\frac{3}{4} \\|u^{(0)}\\| + \\frac{1}{4} \\|u^{(1)}\\| \\le \\frac{3}{4} \\|u^{(0)}\\| + \\frac{1}{4} \\|u^{(0)}\\| = \\|u^{(0)}\\|$。所以 $\\|u^{(2)}\\| \\le \\|u_n\\|$。\n\n3. 假设 $\\|u^{(2)}\\| \\le \\|u^{(0)}\\|$，我们分析 $u_{n+1}$。\n$\\|u_{n+1}\\| = \\left\\| \\frac{1}{3} u^{(0)} + \\frac{2}{3} FE(u^{(2)}, \\Delta t) \\right\\|$\n$\\|u_{n+1}\\| \\le \\frac{1}{3} \\|u^{(0)}\\| + \\frac{2}{3} \\|FE(u^{(2)}, \\Delta t)\\|$\n为了 $\\|FE(u^{(2)}, \\Delta t)\\| \\le \\|u^{(2)}\\|$，我们要求 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$。\n如果此条件成立，则 $\\|u_{n+1}\\| \\le \\frac{1}{3} \\|u^{(0)}\\| + \\frac{2}{3} \\|u^{(2)}\\| \\le \\frac{1}{3} \\|u^{(0)}\\| + \\frac{2}{3} \\|u^{(0)}\\| = \\|u^{(0)}\\|$。所以 $\\|u_{n+1}\\| \\le \\|u_n\\|$。\n\n所有三个阶段都要求前向欧拉步是非扩张的，而它们的有效步长都为 $\\Delta t$。其条件始终是 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$。因此，要使 SSPRK($3,3$) 方法是 SSP 的，总的时间步长限制是 $\\Delta t \\le 1 \\cdot \\Delta t_{\\mathrm{FE}}$。\n\n将此结果与定义 $\\Delta t \\le C \\Delta t_{\\mathrm{FE}}$ 进行比较，最优（可能的最大）SSP 系数为 $C=1$。", "answer": "$$\\boxed{1}$$", "id": "3441464"}]}