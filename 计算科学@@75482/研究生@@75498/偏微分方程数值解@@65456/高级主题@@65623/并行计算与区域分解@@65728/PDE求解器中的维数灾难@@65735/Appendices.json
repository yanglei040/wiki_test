{"hands_on_practices": [{"introduction": "本练习是对维度灾难的初步探索。通过分析作为数学物理基石的高维热方程，您将直接观察到空间维度 $d$ 的增加如何严重限制显式方法的稳定性，并增加隐式方法的计算成本。这项实践将巩固您对经典数值格式为何在高维情况下失效的理解，并阐明本文所讨论的先进技术的必要性。[@problem_id:3454722]", "problem": "考虑在具有周期性边界条件的 $d$ 维环面上的时变热方程，\n$$\nu_{t} = \\Delta u \\quad \\text{on} \\quad \\mathbb{T}^{d},\n$$\n其中 $\\mathbb{T}^{d}$ 表示 $d$ 个长度为 $1$ 的圆的笛卡尔积。使用均匀网格对空间进行离散化，每个维度有 $m$ 个点（假设 $m$ 为偶数），网格间距为 $h = \\frac{1}{m}$，并用标准的二阶中心差分算子近似拉普拉斯算子 $\\Delta$，从而半离散系统具有以下形式\n$$\n\\frac{d \\mathbf{u}(t)}{dt} = A \\, \\mathbf{u}(t),\n$$\n其中 $A$ 是具有周期性边界条件的 $d$ 维离散拉普拉斯算子。令 $N = m^{d}$ 表示网格点的总数。\n\n仅使用傅里叶模、循环矩阵以及由负半定算子生成的收缩半群的基本性质，完成以下任务：\n\n1. 推导 $A$ 的谱（以离散傅里叶模指数表示），并确定最小（最负）的特征值，将其表示为 $d$ 和 $h$ 的函数。\n\n2. 对于标量线性测试方程 $y'(t) = \\lambda y(t)$，当应用于半离散热方程时，刻画以下时间步进策略的稳定区域（即放大因子满足 $|G(z)| \\leq 1$ 的 $z = \\Delta t \\, \\lambda$ 的集合）：\n   - 交替方向隐式（ADI）方法，理解为一种标准的 Douglas 型分裂，它沿着每个空间坐标使用隐式子步骤顺序求解。\n   - 指数积分法，通过快速傅里叶变换（FFT）计算 $\\exp(\\Delta t A)$ 的精确作用。\n   - 算子分裂格式，例如跨越 $d$ 个坐标方向的一阶 Lie 分裂和二阶 Strang 分裂。\n\n   证明后两种方法在此设置下是无条件稳定的，并讨论 ADI 方法对于扩散算子无条件稳定的条件。\n\n3. 对于以下方法，推导每个时间步的主阶运算量，将其表示为 $d$、$m$ 和 $N$ 的函数：\n   - 使用沿每个坐标方向和每条网格线的循环三对角求解的 ADI 方法，\n   - 使用 $d$ 维 FFT 实现的指数积分法，\n   - 通过沿每个坐标方向并在所有线上顺序执行一维 FFT 实现的分裂方法。\n\n   用大 $\\mathcal{O}$ 符号将这些运算量表示为 $d$、$N$ 和 $\\log m$ 的函数。\n\n最后，作为量化显式方法维数灾难的基准，确定将前向欧拉法应用于半离散系统 $d\\mathbf{u}/dt = A \\mathbf{u}$ 时的最大稳定时间步长 $\\Delta t_{\\max}$，并用 $d$ 和 $h$ 表示。将最终的 $\\Delta t_{\\max}$ 以单一的封闭形式解析表达式给出。最终表达式无需四舍五入，也无需单位。", "solution": "问题陈述经评估有效。它在科学上基于偏微分方程数值分析的原理，问题设定清晰一致，适定性良好，并以客观、正式的语言表述。它提出了一个可以使用既定数学技术严格解决的标准但非平凡的问题。\n\n解决方案通过处理问题陈述中概述的每个任务来进行。\n\n### 1. 离散拉普拉斯算子的谱\n\n在 $d$ 维环面 $\\mathbb{T}^d$ 上的热方程 $u_t = \\Delta u$ 的半离散系统由 $\\frac{d\\mathbf{u}(t)}{dt} = A \\mathbf{u}(t)$ 给出，其中 $A$ 是表示在均匀网格（网格间距为 $h = \\frac{1}{m}$）上并带有周期性边界条件的拉普拉斯算子 $\\Delta$ 的标准二阶有限差分近似的矩阵。网格点总数为 $N=m^d$。\n\n算子 $A$ 可以表示为一维离散拉普拉斯算子之和：\n$$\nA = \\sum_{j=1}^{d} A_j\n$$\n其中 $A_j$ 表示第 $j$ 个坐标方向上的离散拉普拉斯算子。使用克罗内克积表示法，即为 $A = A_{1D} \\otimes I \\otimes \\dots \\otimes I + I \\otimes A_{1D} \\otimes \\dots \\otimes I + \\dots + I \\otimes \\dots \\otimes I \\otimes A_{1D}$，其中 $A_{1D}$ 是一维问题的 $m \\times m$ 矩阵。\n\n在一维情况下，对于网格点 $x_i = i h$（$i=0, \\dots, m-1$），$A_{1D}$ 对网格函数 $u$ 的作用由下式给出：\n$$\n(A_{1D} u)_i = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n由于周期性边界条件，下标对 $m$ 取模。这种结构使得 $A_{1D}$ 成为一个循环矩阵。任何 $m \\times m$ 循环矩阵的特征向量都是离散傅里叶模。波数为 $k \\in \\{0, 1, \\dots, m-1\\}$ 的离散傅里叶模是一个向量 $\\mathbf{v}_k$，其分量为 $(\\mathbf{v}_k)_j = \\exp(i 2 \\pi k x_j / L) = \\exp(i 2 \\pi k j / m)$，因为区域长度 $L=1$。\n\n将 $A_{1D}$ 应用于 $\\mathbf{v}_k$：\n$$\n(A_{1D} \\mathbf{v}_k)_j = \\frac{\\exp(i \\frac{2\\pi k(j+1)}{m}) - 2\\exp(i \\frac{2\\pi k j}{m}) + \\exp(i \\frac{2\\pi k(j-1)}{m})}{h^2}\n$$\n$$\n= \\frac{\\exp(i \\frac{2\\pi k j}{m})}{h^2} \\left( \\exp(i \\frac{2\\pi k}{m}) - 2 + \\exp(-i \\frac{2\\pi k}{m}) \\right)\n$$\n$$\n= (\\mathbf{v}_k)_j \\frac{2}{h^2} \\left( \\cos(\\frac{2\\pi k}{m}) - 1 \\right)\n$$\n使用恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，上式变为：\n$$\n= (\\mathbf{v}_k)_j \\left( -\\frac{4}{h^2} \\sin^2(\\frac{\\pi k}{m}) \\right)\n$$\n因此，一维算子 $A_{1D}$ 的特征值为：\n$$\n\\lambda_{1D, k} = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi k}{m}\\right), \\quad \\text{for } k \\in \\{0, 1, \\dots, m-1\\}\n$$\n$d$ 维算子 $A$ 的特征值是组成它的一维算子特征值之和。$A$ 的一个特征向量是一维特征向量的张量积 $\\mathbf{v}_{\\mathbf{k}} = \\mathbf{v}_{k_1} \\otimes \\mathbf{v}_{k_2} \\otimes \\dots \\otimes \\mathbf{v}_{k_d}$，其中 $\\mathbf{k} = (k_1, \\dots, k_d)$ 是一个波数的多重指标，每个 $k_j \\in \\{0, 1, \\dots, m-1\\}$。对应的特征值 $\\lambda_{\\mathbf{k}}$ 为：\n$$\n\\lambda_{\\mathbf{k}} = \\sum_{j=1}^{d} \\lambda_{1D, k_j} = -\\frac{4}{h^2} \\sum_{j=1}^{d} \\sin^2\\left(\\frac{\\pi k_j}{m}\\right)\n$$\n这就是 $A$ 的谱。所有特征值都是实数且非正，所以 $A$ 是一个负半定算子。\n\n最负的特征值 $\\lambda_{\\min}(A)$ 出现在和 $\\sum_{j=1}^{d} \\sin^2(\\frac{\\pi k_j}{m})$ 最大化时。当 $\\theta = \\pi/2 + n\\pi$（其中 $n$ 为整数）时，项 $\\sin^2(\\theta)$ 取得最大值 $1$。对于 $k_j \\in \\{0, \\dots, m-1\\}$，参数为 $\\frac{\\pi k_j}{m}$。我们需要 $\\frac{\\pi k_j}{m} = \\frac{\\pi}{2}$，这得到 $k_j = m/2$。由于给定 $m$ 是偶数，所以 $k_j=m/2$ 是一个整数，也是一个有效的波数。这对应于网格上可分辨的最高频率模式。为了使和最大化，我们必须对所有的 $j=1, \\dots, d$ 选择 $k_j = m/2$。\n$$\n\\lambda_{\\min}(A) = -\\frac{4}{h^2} \\sum_{j=1}^{d} \\sin^2\\left(\\frac{\\pi (m/2)}{m}\\right) = -\\frac{4}{h^2} \\sum_{j=1}^{d} \\sin^2\\left(\\frac{\\pi}{2}\\right) = -\\frac{4}{h^2} \\sum_{j=1}^{d} 1\n$$\n$$\n\\lambda_{\\min}(A) = -\\frac{4d}{h^2}\n$$\n\n### 2. 时间步进策略的稳定性\n\n对于 $y' = \\lambda y$ 的数值方法，如果放大因子 $G(z)$（其中 $z = \\Delta t \\lambda$）满足 $|G(z)| \\le 1$，则该方法是稳定的。对于系统 $\\mathbf{u}' = A\\mathbf{u}$，此条件必须对 $A$ 的每个特征值 $\\lambda_k$ 对应的 $z_k = \\Delta t \\lambda_k$ 成立。由于所有的 $\\lambda_k \\le 0$，我们只需要考虑 $z \\in [\\Delta t \\lambda_{\\min}, 0]$。\n\n- **指数积分法：** 此方法计算半离散系统在一个时间步长内的精确解：$\\mathbf{u}_{n+1} = \\exp(\\Delta t A) \\mathbf{u}_n$。放大算子是 $\\mathcal{G} = \\exp(\\Delta t A)$，放大因子是 $G(z_k) = \\exp(z_k) = \\exp(\\Delta t \\lambda_k)$。由于 $A$ 是负半定的，其特征值 $\\lambda_k$ 是非正的。因此，对于任何 $\\Delta t > 0$，都有 $\\Delta t \\lambda_k \\le 0$。放大因子的模为 $|G(z_k)| = |\\exp(\\Delta t \\lambda_k)| = \\exp(\\Delta t \\lambda_k) \\le \\exp(0) = 1$。这对所有特征值和任何 $\\Delta t > 0$ 的选择都成立。因此，指数积分法是无条件稳定的。这依赖于负半定算子生成一个收缩半群 $\\|\\exp(tA)\\|_2 \\le 1$（对于 $t \\ge 0$）的基本性质。\n\n- **算子分裂格式：** 算子 $A$ 被分裂为 $A = \\sum_{j=1}^d A_j$。\n  - 一阶 Lie 分裂通过 $\\mathcal{G}_{Lie} = \\prod_{j=1}^d \\exp(\\Delta t A_j)$ 来近似 $\\exp(\\Delta t A)$。\n  - 二阶 Strang 分裂使用对称积，例如 $\\mathcal{G}_{Strang} = \\exp(\\frac{\\Delta t}{2} A_1) \\dots \\exp(\\frac{\\Delta t}{2} A_d) \\exp(\\frac{\\Delta t}{2} A_d) \\dots \\exp(\\frac{\\Delta t}{2} A_1)$。\n  每个算子 $A_j$ 本身就是一个一维离散拉普拉斯算子，因此是负半定的。因此，每个分量算子 $\\exp(s A_j)$（对于 $s > 0$）都生成一个收缩，即 $\\|\\exp(s A_j)\\|_2 \\le 1$。Lie 分裂和 Strang 分裂的完整放大算子都是此类收缩算子的乘积。算子乘积的 $L_2$-范数受其范数乘积的限制。因此，$\\|\\mathcal{G}_{Lie}\\|_2 \\le \\prod_{j=1}^d \\|\\exp(\\Delta t A_j)\\|_2 \\le 1$，类似地 $\\|\\mathcal{G}_{Strang}\\|_2 \\le 1$。两种格式在 $L_2$-范数下对于任何 $\\Delta t > 0$ 都是无条件稳定的。\n\n- **交替方向隐式（ADI）方法：** ADI 方法将像 Crank-Nicolson 这样的方法的隐式算子 $(\\mathbf{I} - \\frac{\\Delta t}{2} A)$ 分解为易于求逆的一维算子的乘积 $\\prod_{j=1}^d (\\mathbf{I} - \\frac{\\Delta t}{2} A_j)$。对于具有可交换算子 $A_j$ 的扩散问题（如此处的笛卡尔网格上的情况），ADI 格式的稳定性与其所近似的底层方法的稳定性相关联。例如，基于 Crank-Nicolson 的 Douglas-Gunn 格式是无条件稳定的。对应于算子 $A_j$ 和特征值 $\\lambda_{1D,k_j}$ 的每个一维 Crank-Nicolson 步骤的放大因子是 $G_j = (1 + \\frac{\\Delta t}{2}\\lambda_{1D,k_j})/(1 - \\frac{\\Delta t}{2}\\lambda_{1D,k_j})$。由于 $\\lambda_{1D,k_j} \\le 0$，所以对于任何 $\\Delta t > 0$ 都有 $|G_j| \\le 1$。傅里叶域中的总放大因子是这些项的乘积，其模也受 $1$ 的限制。因此，对于这个特定问题（线性、常系数扩散在笛卡尔网格上），Douglas 型的 ADI 格式是无条件稳定的。如果算子 $A_j$ 不可交换，这种稳定性可能会丧失，这种情况发生在有混合导数、非笛卡尔网格或变系数的问题中。\n\n### 3. 每个时间步的运算量\n\n令 $N=m^d$ 为网格点总数。\n\n- **ADI：** 该方法涉及求解 $d$ 个一维隐式系统序列。对于每个维度 $j$，必须求解 $m^{d-1}$ 个独立的一维系统，即该维度上每条网格线对应一个系统。每个系统的大小为 $m \\times m$，并且由于周期性边界条件而呈循环三对角形式。一个循环三对角系统可以在 $\\mathcal{O}(m)$ 次运算内求解（例如，使用 Sherman-Morrison 公式）。一个方向的总成本是 $m^{d-1} \\times \\mathcal{O}(m) = \\mathcal{O}(m^d) = \\mathcal{O}(N)$。因为要对 $d$ 个方向中的每一个都这样做，所以每个时间步的总运算量是 $\\mathcal{O}(d N)$。\n\n- **指数积分法：** $\\exp(\\Delta t A)$ 的作用通过 FFT 计算。该算法是：(1) 对状态向量 $\\mathbf{u}_n$ 进行正向 $d$ 维 FFT，(2) 将变换后的向量与预先计算的因子 $\\exp(\\Delta t \\lambda_{\\mathbf{k}})$ 进行逐元素相乘，以及 (3) 进行逆向 $d$ 维 FFT。在 $m \\times \\dots \\times m$ 网格上的 $d$ 维 FFT 是通过沿每个维度顺序应用大小为 $m$ 的一维 FFT 来执行的。沿选定维度的所有 $m^{d-1}$ 条线上执行大小为 $m$ 的一维 FFT 的成本是 $m^{d-1} \\times \\mathcal{O}(m \\log m) = \\mathcal{O}(N \\log m)$。这对所有 $d$ 个维度重复进行。因此，$d$ 维 FFT 的成本是 $\\mathcal{O}(d N \\log m)$。乘法步骤需要 $\\mathcal{O}(N)$。主要成本是正向和逆向 FFT，因此每个时间步的总运算量是 $\\mathcal{O}(d N \\log m)$。\n\n- **分裂方法：** 像 Lie 分裂这样的分裂方法涉及应用 $d$ 个形如 $\\exp(\\Delta t A_j)$ 的算子。每次应用，例如 $\\mathbf{v} \\mapsto \\exp(\\Delta t A_j)\\mathbf{v}$，是沿维度 $j$ 对所有网格线进行的一维热方程求解。这可以通过使用一维 FFT 高效地完成。对于维度 $j$ 中的 $m^{d-1}$ 条线中的每一条，执行一次正向一维 FFT、与指数因子相乘以及一次逆向一维 FFT。一次这样的方向求解的成本是 $m^{d-1} \\times \\mathcal{O}(m \\log m) = \\mathcal{O}(N \\log m)$。由于在 Lie 分裂中有 $d$ 个这样的步骤（在 Strang 分裂中有 $\\mathcal{O}(d)$ 个步骤），每个时间步的总运算量是 $\\mathcal{O}(d N \\log m)$。\n\n### 最终任务：前向欧拉法的时间步长限制\n\n应用于 $\\frac{d\\mathbf{u}}{dt} = A\\mathbf{u}$ 的前向欧拉法由下式给出：\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t A \\mathbf{u}_n = (\\mathbf{I} + \\Delta t A) \\mathbf{u}_n\n$$\n放大算子是 $\\mathcal{G}(A) = \\mathbf{I} + \\Delta t A$。为了保证稳定性，其谱半径必须不大于 $1$。$\\mathcal{G}(A)$ 的特征值是 $g_k = 1 + \\Delta t \\lambda_k$，其中 $\\lambda_k$ 是 $A$ 的特征值。我们需要对所有的 $k$ 都有 $|g_k| \\le 1$。\n$$\n|1 + \\Delta t \\lambda_k| \\le 1\n$$\n由于特征值 $\\lambda_k$ 是实数且非正，这个不等式等价于：\n$$\n-1 \\le 1 + \\Delta t \\lambda_k \\le 1\n$$\n右边的不等式 $1+\\Delta t \\lambda_k \\le 1$ 意味着 $\\Delta t \\lambda_k \\le 0$，这总是成立的，因为 $\\Delta t > 0$ 且 $\\lambda_k \\le 0$。\n左边的不等式 $-1 \\le 1 + \\Delta t \\lambda_k$ 意味着 $-2 \\le \\Delta t \\lambda_k$，或者 $\\Delta t (-\\lambda_k) \\le 2$。\n\n这个条件必须对所有特征值 $\\lambda_k$ 成立。最严格的情况是对于具有最大模的特征值，即 $\\lambda_{\\min}(A)$。\n$$\n\\Delta t (-\\lambda_{\\min}(A)) \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2}{-\\lambda_{\\min}(A)}\n$$\n因此，最大稳定时间步长 $\\Delta t_{\\max}$ 是 $\\frac{2}{-\\lambda_{\\min}(A)}$。从第 1 部分，我们推导出 $\\lambda_{\\min}(A) = -\\frac{4d}{h^2}$。代入这个值：\n$$\n\\Delta t_{\\max} = \\frac{2}{-(-4d/h^2)} = \\frac{2}{4d/h^2} = \\frac{2h^2}{4d} = \\frac{h^2}{2d}\n$$\n这个严格的限制 $\\Delta t_{\\max} \\propto h^2/d$ 体现了显式方法的维数灾难，因为时间步长不仅必须随着空间分辨率的提高而减小，还必须随着维数的增加而减小。", "answer": "$$\n\\boxed{\\frac{h^{2}}{2d}}\n$$", "id": "3454722"}, {"introduction": "在了解了维度灾难的表现形式后，下一个练习将直接比较一种受其影响的方法和一种旨在规避它的现代代理方法。您将分析一个用于双曲守恒律的传统戈杜诺夫（Godunov）类求解器，其复杂度呈指数级爆炸（$2^d$），并将其与一个基于福克-普朗克（Fokker-Planck）方程的概率模型进行对比，后者的成本与这种指数级增长无关。这个练习突显了处理高维问题的一个关键策略：用一个更易于管理的随机或统计等价问题来替代一个计算上极其复杂的确定性问题。[@problem_id:3454649]", "problem": "考虑在每个空间维度上有 $N$ 个网格单元的 $d$ 维笛卡尔网格上提出的双曲守恒律 $\\partial_t u + \\nabla \\cdot F(u) = 0$。一种有限体积戈杜诺夫型方法通过计算数值通量来推进网格单元的平均值，在多维情况下，这会耦合每个超立方体角点处的 $2^d$ 个局部状态。您的任务是研究每个时间步长的原始局部问题数量如何随空间维度 $d$ 变化，并构建和分析一个基于概率密度函数偏微分方程（PDE）的概率代理模型，以取代多维黎曼求解器。\n\n您必须完成三个部分：\n\n1. 多维黎曼求解器的复杂度模型。\n   - 从戈杜诺夫通量作为局部黎曼问题的解的定义以及 $d$ 维超立方体的组合结构出发，推导出每个时间步的操作计数，\n     $$W_{\\mathrm{R}}(d,N) = N^d \\cdot 2^d,$$\n     这被解释为整个网格上每个时间步长的角点耦合、$2^d$ 状态局部问题的数量。\n   - 解释为什么因子 $2^d$ 作为超立方体角点状态的数量出现，以及为什么 $N^d$ 是网格单元的数量。\n\n2. 基于概率密度函数偏微分方程的概率代理模型。\n   - 将 $U(\\mathbf{x},t)$ 在每个空间点上建模为一个随机变量，其在状态空间变量 $s \\in \\mathbb{R}$ 上的概率密度为 $p(s;\\mathbf{x},t)$。利用均值守恒写出\n     $$\\partial_t \\mu(\\mathbf{x},t) + \\nabla \\cdot \\mathbb{E}[F(U(\\mathbf{x},t))] = 0,$$\n     其中 $\\mu(\\mathbf{x},t) = \\mathbb{E}[U(\\mathbf{x},t)]$ 且 $\\mathbb{E}[F(U)] = \\int_{\\mathbb{R}} F(s) p(s;\\mathbf{x},t)\\,\\mathrm{d}s.$\n   - 通过为密度 $p$ 在状态变量 $s$ 中指定一个演化偏微分方程来封闭系统，该方程在主导阶上保持均值和方差。一个有原则的选择是福克-普朗克（Fokker–Planck，也称为前向柯尔莫哥洛夫）方程，\n     $$\\partial_t p(s;\\mathbf{x},t) + \\partial_s\\big(a(s;\\mu,\\sigma)\\,p(s;\\mathbf{x},t)\\big) = \\nu\\,\\partial_s^2 p(s;\\mathbf{x},t),$$\n     其中 $a(s;\\mu,\\sigma) = -\\gamma\\,(s-\\mu)$ 是一个线性漂移，$\\nu \\ge 0$ 是一个扩散系数，其选择是为了匹配目标方差 $\\sigma^2(\\mathbf{x},t)$，该方差根据与所选漂移和扩散一致的封闭常微分方程演化。论证这个一维偏微分方程在 $s$ 上的、每个网格单元使用 $S$ 个点的一阶有限体积或有限差分离散，每个空间网格单元和每个时间步的运算量与 $S$ 成正比。\n   - 推导出每个时间步的代理模型操作计数，\n     $$W_{\\mathrm{PDF}}(d,N,S) = N^d \\cdot S,$$\n     其中 $S$ 是用于近似 $\\mathbb{E}[F(U)]$ 积分和更新 $p$ 的状态空间网格点数。\n\n3. 在基准通量上的定量比较和求积精度评估。\n   - 考虑具有 $d$ 个相同分量的特定通量 $F(u) = \\big(u^2/2,\\ldots,u^2/2\\big)$。\n   - 对于具有给定 $(d,N,S,\\mu,\\sigma)$ 的独立测试用例，令密度 $p(s)$ 为均值为 $\\mu$、标准差为 $\\sigma$ 的高斯分布。计算每个分量的精确平均通量大小，\n     $$\\Phi_{\\mathrm{exact}} = \\frac{1}{2}\\,\\mathbb{E}[U^2] = \\frac{1}{2}\\left(\\mu^2 + \\sigma^2\\right)。$$\n   - 使用在截断区间 $[\\mu - 4\\sigma,\\ \\mu + 4\\sigma]$ 上的 $S$ 个节点的复合梯形法则来近似 $\\Phi_{\\mathrm{exact}}$：\n     $$\\Phi_{\\mathrm{trap}}(S;\\mu,\\sigma) = \\frac{1}{2}\\int_{\\mu-4\\sigma}^{\\mu+4\\sigma} s^2 \\, \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\!\\Big(-\\frac{(s-\\mu)^2}{2\\sigma^2}\\Big)\\,\\mathrm{d}s,$$\n     用 $S$ 个均匀间隔的点进行离散化。定义绝对求积误差\n     $$\\mathrm{err}(S;\\mu,\\sigma) = \\big|\\Phi_{\\mathrm{trap}}(S;\\mu,\\sigma) - \\Phi_{\\mathrm{exact}}\\big|。$$\n   - 对于每个测试用例，计算并报告三元组 $\\big(W_{\\mathrm{R}}(d,N),\\ W_{\\mathrm{PDF}}(d,N,S),\\ \\mathrm{err}(S;\\mu,\\sigma)\\big)$。\n\n您必须使用的基本依据：\n- 用于双曲守恒律的有限体积方法的定义以及 $d$ 维中超立方体角点数为 $2^d$。\n- 在某个密度下函数期望的定义以及高斯概率密度函数。\n- 作为状态空间中概率守恒律的福克-普朗克方程及其有限差分离散的成本随状态网格点数的伸缩关系。\n\n您的程序必须实现操作计数公式和求积误差计算。您无需模拟物理空间中的完整演化；相反，您必须为指定的通量和高斯密度量化成本和求积误差。\n\n测试套件：\n- 情况 1：$(d,N,S,\\mu,\\sigma) = (3,16,9,0.8,0.3)$。\n- 情况 2：$(d,N,S,\\mu,\\sigma) = (5,8,17,1.0,0.5)$。\n- 情况 3：$(d,N,S,\\mu,\\sigma) = (7,4,33,1.2,0.4)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个外部列表中的逗号分隔的三元组列表。每个三元组必须是 $[W_{\\mathrm{R}},W_{\\mathrm{PDF}},\\mathrm{err}]$ 的形式，其中 $W_{\\mathrm{R}}$ 和 $W_{\\mathrm{PDF}}$ 是整数，$\\mathrm{err}$ 是浮点数。例如：\n  - $[[10,20,0.125],[\\ldots],[\\ldots]]$。", "solution": "该问题是有效的，因为它具有科学依据、内容完备且提法得当。我们按照要求分三部分进行解答。\n\n**1. 多维黎曼求解器的复杂度模型**\n\n该问题考虑在一个 $d$ 维笛卡尔网格上求解一个双曲守恒律 $\\partial_t u + \\nabla \\cdot F(u) = 0$。该网格在 $d$ 个空间维度中的每一个维度上都包含 $N$ 个网格单元或控制体积。\n\n计算域中的总网格单元数是每个维度上网格单元数的乘积，即 $N^d$。有限体积法在每个时间步为这 $N^d$ 个网格单元中的每一个计算网格单元平均状态变量的更新。因此，每个时间步的总计算功 $W$ 必须与 $N^d$ 成正比。\n\n单个网格单元的更新需要计算其边界上的数值通量。问题描述了一种戈多诺夫型方法，其中通量计算在多维情况下尤为复杂。具体来说，它涉及到在每个网格单元的角点（顶点）处求解局部问题。在 $d$ 维笛卡尔网格中，一个网格单元是一个超立方体。$d$ 维超立方体的一个基本几何特性是它拥有 $2^d$ 个顶点。例如，在 $d=1$ 维中的线段有 $2^1=2$ 个端点，在 $d=2$ 维中的正方形有 $2^2=4$ 个角，在 $d=3$ 维中的立方体有 $2^3=8$ 个角。\n\n问题指出，数值通量的计算耦合了在每个超立方体角点相遇的 $2^d$ 个网格单元的局部状态。这定义了一个必须解决的“局部问题”。总工作负载通过计算整个网格上每个时间步需要解决的此类局部问题的数量来建模。通过假设更新一个网格单元的工作量与发生这些复杂相互作用的角点数量成正比，每个网格单元的工作量按 $2^d$ 的比例缩放。\n\n结合这两个因素——总网格单元数和每个网格单元的工作量——我们得到了总操作计数。每个时间步需要解决的角点耦合局部问题的总数是网格单元数 $N^d$ 和每个网格单元的角点数 $2^d$ 的乘积。这得出了复杂度模型：\n$$W_{\\mathrm{R}}(d,N) = N^d \\cdot 2^d$$\n这个表达式突显了“维度灾难”：计算成本随空间维度 $d$ 指数增长，这使得标准的高阶、多维戈多诺夫型方法在 $d > 3$ 或 $d > 4$ 时变得异常昂贵。\n\n**2. 基于概率密度函数偏微分方程的概率代理模型**\n\n为了规避指数级缩放，引入了一个代理模型。我们不再追踪确切的状态 $u(\\mathbf{x}, t)$，而是将其建模为一个随机变量 $U(\\mathbf{x}, t)$，由一个概率密度函数（PDF）$p(s;\\mathbf{x},t)$ 来表征，其中 $s$ 是状态空间变量。然后，演化用该分布的统计量来描述。\n\n均值 $\\mu(\\mathbf{x},t) = \\mathbb{E}[U]$ 的演化通过对原始守恒律取期望得到，结果是：\n$$\\partial_t \\mu(\\mathbf{x},t) + \\nabla \\cdot \\mathbb{E}[F(U(\\mathbf{x},t))] = 0$$\n其中期望通量为 $\\mathbb{E}[F(U)] = \\int_{\\mathbb{R}} F(s) p(s;\\mathbf{x},t)\\,\\mathrm{d}s$。这个方程是不封闭的，因为 $\\mu$ 的演化依赖于完整的概率密度函数 $p(s)$。\n\n通过为概率密度函数 $p(s)$ 本身指定一个输运方程来提供封闭。问题指定了一个福克-普朗克方程，这是一个在状态空间变量 $s$ 中的一维平流-扩散方程：\n$$\\partial_t p(s;\\mathbf{x},t) + \\partial_s\\big(a(s;\\mu,\\sigma)\\,p(s;\\mathbf{x},t)\\big) = \\nu\\,\\partial_s^2 p(s;\\mathbf{x},t)$$\n这个方程必须在物理域网格的 $N^d$ 个空间单元中的每一个内部局部求解。关键是，无论物理空间维度 $d$ 是多少，这个偏微分方程始终是一维的（在变量 $s$ 中）。\n\n为了数值求解这个偏微分方程，连续的状态空间 $s$被离散化为一组 $S$ 个网格点。将标准的数值方法，如有限差分或有限体积格式，应用于这个在 $S$ 个点上的一维偏微分方程，推进一个时间步需要与 $S$ 成正比的操作数。例如，一个用于 $p_j^{n+1}$ 的显式格式将依赖于相邻点的值（例如，$p_{j-1}^n, p_j^n, p_{j+1}^n$），导致 $O(S)$ 的计算成本。\n\n类似地，期望通量积分 $\\mathbb{E}[F(U)]$ 使用在状态空间中相同的 $S$ 个点上的求积法则来近似，这也会产生与 $S$ 成正比的成本。因此，每个空间单元的总工作量包括求解一维福克-普朗克方程和计算矩积分，这两者的计算量都按 $O(S)$ 缩放。\n\n由于这项工作必须对 $N^d$ 个空间单元中的每一个都执行，因此代理模型每个时间步的总操作计数是网格单元数和每个单元在状态空间中工作量的乘积：\n$$W_{\\mathrm{PDF}}(d,N,S) = N^d \\cdot S$$\n该模型将对维度 $d$ 的指数依赖 $2^d$ 替换为对状态空间离散点数 $S$ 的线性依赖。$S$ 的值由表示概率密度函数和计算其矩的期望精度决定，但它与 $d$ 无关。这种从指数缩放到代数缩放的单位单元成本转变是代理方法在高维问题中的关键优势。\n\n**3. 定量比较和求积精度**\n\n我们现在对特定的通量函数 $F(u) = (u^2/2, \\ldots, u^2/2)$ 和状态变量 $U$ 的高斯概率密度函数进行定量比较。\n\n期望通量的分量是 $\\mathbb{E}[F_i(U)] = \\mathbb{E}[U^2/2] = \\frac{1}{2}\\mathbb{E}[U^2]$。概率论中的一个标准结果表明，对于均值为 $\\mu$、方差为 $\\sigma^2$ 的随机变量 $U$，其二阶矩为 $\\mathbb{E}[U^2] = \\mu^2 + \\sigma^2$。因此，平均通量分量的精确值为：\n$$\\Phi_{\\mathrm{exact}} = \\frac{1}{2}\\left(\\mu^2 + \\sigma^2\\right)$$\n\n这个精确值使用数值求积来近似。问题指定了在截断区间 $[\\mu - 4\\sigma, \\mu + 4\\sigma]$ 上使用 $S$ 个点的复合梯形法则。需要近似的积分为：\n$$\\Phi_{\\mathrm{approx}}(S;\\mu,\\sigma) = \\int_{\\mu-4\\sigma}^{\\mu+4\\sigma} \\frac{s^2}{2} \\, p(s;\\mu,\\sigma)\\,\\mathrm{d}s$$\n其中 $p(s;\\mu,\\sigma)$ 是高斯概率密度函数：\n$$p(s;\\mu,\\sigma) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(s-\\mu)^2}{2\\sigma^2}\\right)$$\n复合梯形法则通过用 $S$ 个均匀间隔的点 $\\{s_i\\}_{i=0}^{S-1}$ 离散化区间并求所得梯形的面积之和来近似此积分。\n\n然后，绝对求积误差定义为近似值和精确值之间的差：\n$$\\mathrm{err}(S;\\mu,\\sigma) = \\big|\\Phi_{\\mathrm{approx}}(S;\\mu,\\sigma) - \\Phi_{\\mathrm{exact}}\\big|$$\n\n对于每个测试用例 $(\\mathrm{d}, N, S, \\mu, \\sigma)$，我们计算三元组 $(W_{\\mathrm{R}}(d,N), W_{\\mathrm{PDF}}(d,N,S), \\mathrm{err}(S;\\mu,\\sigma))$。由所提供的程序计算出的结果展示了这种权衡。对于低维度（例如 $d=3$），如果 $S$ 足够大（$S > 2^3 = 8$），常规方法可能具有竞争力甚至更便宜。然而，随着维度 $d$ 的增加，$W_{\\mathrm{R}}$呈指数增长，而 $W_{\\mathrm{PDF}}$ 的缩放则温和得多，只要适度的 $S$ 能为求积提供足够的精度，代理模型的计算优势很快就会确立。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Calculates operational counts and quadrature error for three test cases\n    comparing a standard multidimensional solver with a probabilistic surrogate.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (d, N, S, mu, sigma)\n    test_cases = [\n        (3, 16, 9, 0.8, 0.3),\n        (5, 8, 17, 1.0, 0.5),\n        (7, 4, 33, 1.2, 0.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        d, N, S, mu, sigma = case\n\n        # 1. Calculate the operation count for the multidimensional Riemann solver.\n        # W_R = N^d * 2^d\n        # Python's integers handle arbitrary size, so no overflow issues.\n        work_riemann = N**d * 2**d\n\n        # 2. Calculate the operation count for the probabilistic surrogate model.\n        # W_PDF = N^d * S\n        work_pdf = N**d * S\n\n        # 3. Calculate the quadrature error for the expected flux.\n        \n        # 3a. Compute the exact mean flux magnitude per component.\n        # Phi_exact = E[U^2]/2 = (mu^2 + sigma^2)/2\n        phi_exact = 0.5 * (mu**2 + sigma**2)\n\n        # 3b. Approximate the flux using the composite trapezoidal rule.\n        # The integration is over the interval [mu - 4*sigma, mu + 4*sigma].\n        # This interval captures >99.99% of the probability mass for a Gaussian.\n        a = mu - 4 * sigma\n        b = mu + 4 * sigma\n\n        # Generate S uniformly spaced nodes for the quadrature.\n        s_nodes = np.linspace(a, b, S)\n\n        # Evaluate the Gaussian PDF at these nodes.\n        pdf_values = norm.pdf(s_nodes, loc=mu, scale=sigma)\n\n        # The integrand is (s^2 / 2) * p(s), but the problem statement's integral\n        # form is for E[U^2]/2 in the text, but the integral is defined for E[U^2]\n        # with a 1/2 outside. We follow the formula:\n        # Phi_trap = (1/2) * Integral[s^2 * p(s) ds]\n        integrand = s_nodes**2 * pdf_values\n        \n        # Use numpy's trapezoidal rule for numerical integration.\n        integral_val = np.trapz(integrand, s_nodes)\n        phi_trap = 0.5 * integral_val\n\n        # 3c. Compute the absolute quadrature error.\n        quadrature_error = abs(phi_trap - phi_exact)\n\n        # Store the triplet of results.\n        # Ensure work counts are integers as specified.\n        results.append([int(work_riemann), int(work_pdf), quadrature_error])\n\n    # Final print statement in the exact required format: [[...],[...],[...]]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3454649"}, {"introduction": "我们最后的练习将介绍一种战胜维度灾难最强大的范式之一：利用低秩结构。许多高维函数，包括偏微分方程的解，都可以通过低秩张量进行精确近似，从而避免了存储指数级数量的参数。通过分析具有可分离源项的泊松方程的解，您将推导出其张量列（Tensor Train, TT）秩，并看到这些秩如何能够保持很小且与网格大小无关，这揭示了基于张量的求解器可以利用的隐藏简洁性。[@problem_id:3454672]", "problem": "考虑单位超立方体 $\\Omega=(0,1)^{d}$ 上的 $d$ 维泊松方程，其带有齐次狄利克雷边界条件：\n$$\n-\\Delta u(\\boldsymbol{x})=f(\\boldsymbol{x}), \\quad \\boldsymbol{x}=(x_{1},\\dots,x_{d})\\in\\Omega, \\qquad u|_{\\partial\\Omega}=0.\n$$\n假设右端项在以下意义上是秩为 $r$ 的严格可分离函数：\n$$\nf(\\boldsymbol{x})=\\sum_{k=1}^{r}\\prod_{i=1}^{d} \\varphi_{ik}(x_{i}),\n$$\n并且，至关重要的是，对于每个 $i\\in\\{1,\\dots,d\\}$ 和 $k\\in\\{1,\\dots,r\\}$，因子 $\\varphi_{ik}$ 是 $(0,1)$ 上的一个一维狄利克雷特征函数：\n$$\n-\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}} \\varphi_{ik}(x)=\\lambda_{ik}\\,\\varphi_{ik}(x), \\qquad \\varphi_{ik}(0)=\\varphi_{ik}(1)=0,\n$$\n其中 $\\lambda_{ik}>0$。再假设这 $r$ 个乘积函数 $\\left\\{\\prod_{i=1}^{d}\\varphi_{ik}(x_{i})\\right\\}_{k=1}^{r}$ 在 $L^{2}(\\Omega)$ 中是线性无关的。\n\n你使用 $N$ 个内部网格点对每个维度进行离散化，采用标准的二阶中心有限差分格式，得到离散的 $d$ 维狄利克雷拉普拉斯算子，其形式为 $d$ 个相同的一维三对角算子的克罗内克和，并将离散解表示为一个大小为 $N\\times\\cdots\\times N$ 的 $d$ 阶张量。\n\n仅从以下几点出发：\n- 用于求解带齐次狄利克雷边界条件的 $(0,1)^{d}$ 上的 $-\\Delta$ 的变量分离法，\n- 一维狄利克雷拉普拉斯算子的特征函数构成一个正交基，并且 $d$ 维拉普拉斯算子可被此类特征函数的张量积对角化这一事实，\n- 一个 $d$ 阶数组的张量列 (TT) 分解和 TT 秩的定义，\n\n在精确算术下，推导离散解张量的所有TT分解中的最大TT秩的最小可能值，并将其表示为关于 $r$ 和 $d$ 的闭式表达式。你的推导必须阐明该秩如何以及为何随 $r$ 缩放，为何它与 $N$ 无关，以及在所述的可分离性条件下，它对 $d$ 的依赖性至多是弱的。\n\n给出你的最终答案，形式为一个单独的符号表达式。不包含任何单位。不要四舍五入。", "solution": "用户希望找到一个特定的 $d$ 维泊松方程离散解的最大张量列 (TT) 秩的最小可能值。\n\n### 步骤 1：问题验证\n\n**提取已知条件：**\n1.  **偏微分方程：** 单位超立方体 $\\Omega=(0,1)^{d}$ 上的 $d$ 维泊松方程，带有齐次狄利克雷边界条件：\n    $$-\\Delta u(\\boldsymbol{x})=f(\\boldsymbol{x}), \\quad \\boldsymbol{x}=(x_{1},\\dots,x_{d})\\in\\Omega, \\qquad u|_{\\partial\\Omega}=0.$$\n2.  **源项结构：** 右端项 $f(\\boldsymbol{x})$ 是 $r$ 个可分离函数的和：\n    $$f(\\boldsymbol{x})=\\sum_{k=1}^{r}\\prod_{i=1}^{d} \\varphi_{ik}(x_{i}).$$\n3.  **分量函数性质：** 每个因子 $\\varphi_{ik}(x_i)$ 是 $(0,1)$ 上的一个一维狄利克雷特征函数：\n    $$-\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}} \\varphi_{ik}(x)=\\lambda_{ik}\\,\\varphi_{ik}(x), \\qquad \\varphi_{ik}(0)=\\varphi_{ik}(1)=0,$$\n    其中 $\\lambda_{ik}>0$。\n4.  **线性无关性：** 这 $r$ 个乘积函数 $\\left\\{\\prod_{i=1}^{d}\\varphi_{ik}(x_{i})\\right\\}_{k=1}^{r}$ 在 $L^{2}(\\Omega)$ 中是线性无关的。\n5.  **离散化：** 每个维度都采用标准的二阶中心有限差分格式，用 $N$ 个内部网格点进行离散化。离散解是一个大小为 $N\\times\\cdots\\times N$ 的 $d$ 阶张量。\n6.  **出发前提：** 推导必须从 (a) 拉普拉斯算子的变量分离法，(b) 其特征函数的性质，以及 (c) 张量列 (TT) 分解和秩的定义出发。\n7.  **目标：** 推导离散解张量的最大TT秩的最小可能值，并将其表示为关于 $r$ 和 $d$ 的闭式表达式。\n\n**使用提取的已知条件进行验证：**\n该问题具有科学依据、适定且客观。它根植于偏微分方程数值分析和低秩张量分解的既有理论。前提在数学上是一致的，目标也明确定义了。所有术语在这些领域都是标准的。该问题结构是一个标准的模型问题，用于分析基于张量的求解器的性能。因此，该问题是有效的。\n\n### 步骤 2：解张量结构的推导\n\n$(0,1)$ 上的一维狄利克雷特征函数为 $\\sin(m\\pi x)$，对应的特征值为 $(m\\pi)^2$，其中整数 $m \\ge 1$。因此，对于某个整数模 $m_{ik} \\ge 1$，每个 $\\varphi_{ik}(x_i)$ 必定与 $\\sin(m_{ik}\\pi x_i)$ 成正比。相应的特征值为 $\\lambda_{ik} = (m_{ik}\\pi)^2$。\n\n通过变量分离法，带有齐次狄利克雷边界条件的 $\\Omega=(0,1)^d$ 上的 $d$ 维拉普拉斯算子 $-\\Delta$ 的特征函数是一维特征函数的张量积：\n$$ \\Psi_{\\boldsymbol{m}}(\\boldsymbol{x}) = \\prod_{i=1}^{d} \\sin(m_i \\pi x_i) $$\n其中 $\\boldsymbol{m}=(m_1, \\dots, m_d)$ 是一个正整数的多重指标。相应的特征值为 $\\Lambda_{\\boldsymbol{m}} = \\sum_{i=1}^d (m_i \\pi)^2$。\n\n给定的源项 $f(\\boldsymbol{x})$ 是 $r$ 个此类特征函数的线性组合：\n$$ f(\\boldsymbol{x}) = \\sum_{k=1}^{r} C_k \\Psi_{\\boldsymbol{m}_k}(\\boldsymbol{x}) $$\n对于某些系数 $C_k$ 和不同的多重指标 $\\boldsymbol{m}_k = (m_{1k}, \\dots, m_{dk})$。乘积函数的线性无关条件确保了这 $r$ 个多重指标是不同的。\n\n解 $u(\\boldsymbol{x})$ 是通过将拉普拉斯逆算子 $(-\\Delta)^{-1}$ 应用于 $f(\\boldsymbol{x})$ 得到的。由于 $\\Psi_{\\boldsymbol{m}_k}$ 是 $-\\Delta$ 的特征函数，我们有 $(-\\Delta)^{-1}\\Psi_{\\boldsymbol{m}_k} = \\Lambda_{\\boldsymbol{m}_k}^{-1} \\Psi_{\\boldsymbol{m}_k}$。解为：\n$$ u(\\boldsymbol{x}) = \\sum_{k=1}^{r} \\frac{C_k}{\\Lambda_{\\boldsymbol{m}_k}} \\Psi_{\\boldsymbol{m}_k}(\\boldsymbol{x}) = \\sum_{k=1}^{r} \\frac{C_k}{\\sum_{i=1}^{d} (m_{ik}\\pi)^2} \\prod_{i=1}^{d} \\sin(m_{ik} \\pi x_i). $$\n\n在每个维度用 $N$ 个内部网格点进行离散化后，连续函数和算子被其离散对应物所取代。\n- 函数 $\\sin(m\\pi x)$ 由一个向量 $\\mathbf{s}_m \\in \\mathbb{R}^N$ 表示，其分量是正弦函数在网格点上的取值。这些向量 $\\{\\mathbf{s}_m\\}_{m=1}^N$ 是 $N \\times N$ 维有限差分拉普拉斯矩阵 $A_{1D}$ 的特征向量。设其对应的离散特征值为 $\\mu_m$。\n- 特征函数 $\\Psi_{\\boldsymbol{m}_k}(\\boldsymbol{x})$ 由一个秩-1张量 $T_k = \\mathbf{s}_{m_{1k}} \\otimes \\mathbf{s}_{m_{2k}} \\otimes \\dots \\otimes \\mathbf{s}_{m_{dk}}$ 表示。\n- 离散解是一个大小为 $N \\times \\dots \\times N$ 的 $d$ 阶张量 $U$。它是线性系统 $A U = F$ 的解，其中 $A$ 是离散的 $d$ 维拉普拉斯算子，$F$ 是 $f$ 的离散表示。$A$ 的特征向量是秩-1张量 $T_k$，相应的特征值是 $\\Lambda'_k = \\sum_{i=1}^d \\mu_{m_{ik}}$。\n- 离散源张量为 $F = \\sum_{k=1}^r C'_k T_k$，其中 $C'_k$ 为某些系数。\n- 因此，离散解张量 $U$ 由下式给出：\n$$ U = A^{-1}F = \\sum_{k=1}^{r} \\frac{C'_k}{\\Lambda'_{k}} T_k = \\sum_{k=1}^{r} \\gamma_k (\\mathbf{s}_{m_{1k}} \\otimes \\dots \\otimes \\mathbf{s}_{m_{dk}}) $$\n其中 $\\gamma_k = C'_k/\\Lambda'_{k}$。由于 $\\Lambda'_{k} > 0$ 且我们假设源项非平凡 ($C'_k \\neq 0$)，所以系数 $\\gamma_k$ 非零。该表达式表明，解张量 $U$ 是 $r$ 个秩-1张量之和。由于构成张量的秩-1张量集合 $\\{T_k\\}_{k=1}^r$ 是由对应于不同多重指标 $\\{\\boldsymbol{m}_k\\}_{k=1}^r$ 的正交向量构建的，它们在张量空间中构成一个正交集，因此是线性无关的。这意味着解张量 $U$ 的典范秩（或 CP 秩）恰好为 $r$。\n\n### 步骤 3：张量列 (TT) 秩的推导\n\n张量的张量列 (TT) 秩定义为其任何 TT 分解中的最大秩的最小可能值。设 TT 秩向量为 $(r_0, r_1, \\dots, r_d)$，其中 $r_0=r_d=1$。中间秩由张量的矩阵化（或展开）的秩定义：\n$$ r_p = \\text{rank}(U_{(p)}), \\quad p=1, \\dots, d-1 $$\n其中 $U_{(p)}$ 是一个大小为 $N^p \\times N^{d-p}$ 的矩阵，通过将张量 $U$ 的前 $p$ 个指标和后 $d-p$ 个指标分组重塑而成。最大TT秩为 $\\max_{p=1,\\dots,d-1} r_p$。\n\n让我们分析解张量 $U$ 的秩 $r_p$：\n$$ U_{(p)} = \\left( \\sum_{k=1}^{r} \\gamma_k T_k \\right)_{(p)} = \\sum_{k=1}^{r} \\gamma_k (T_k)_{(p)}. $$\n每个 $(T_k)_{(p)}$ 是一个秩-1矩阵，可以写成两个向量 $L_k \\in \\mathbb{R}^{N^p}$ 和 $R_k \\in \\mathbb{R}^{N^{d-p}}$ 的外积：\n$$ (T_k)_{(p)} = L_k R_k^T, $$\n其中 $L_k = \\mathbf{s}_{m_{1k}} \\otimes \\dots \\otimes \\mathbf{s}_{m_{pk}}$ 且 $R_k = \\mathbf{s}_{m_{p+1,k}} \\otimes \\dots \\otimes \\mathbf{s}_{m_{dk}}$。\n矩阵化 $U_{(p)}$ 是 $r$ 个秩-1矩阵的和：\n$$ U_{(p)} = \\sum_{k=1}^{r} \\gamma_k L_k R_k^T. $$\n该矩阵的秩最多为 $r$。为了确定其确切值，我们必须考虑模式 $\\{m_{ik}\\}$ 的具体结构。\n\n考虑一个满足问题条件的特定模式选择。令 $m_{ik} = k$ 对于所有 $i \\in \\{1, \\dots, d\\}$ 和 $k \\in \\{1, \\dots, r\\}$。多重指标为 $\\boldsymbol{m}_k = (k, k, \\dots, k)$。对于 $k=1, \\dots, r$，这些指标是不同的，所以相应的乘积函数是线性无关的。\n对于这个选择，让我们计算 TT 秩。\n对于任何 $p \\in \\{1, \\dots, d-1\\}$，“左”向量为：\n$$ L_k = \\underbrace{\\mathbf{s}_k \\otimes \\dots \\otimes \\mathbf{s}_k}_{p \\text{ 次}}. $$\n集合 $\\{L_k\\}_{k=1}^r$ 包含 $r$ 个向量。由于基向量 $\\{\\mathbf{s}_k\\}_{k=1}^N$ 是正交的，张量积 $\\{L_k\\}_{k=1}^r$ 也是正交的，因此是线性无关的。\n“右”向量为：\n$$ R_k = \\underbrace{\\mathbf{s}_k \\otimes \\dots \\otimes \\mathbf{s}_k}_{d-p \\text{ 次}}. $$\n同样，集合 $\\{R_k\\}_{k=1}^r$ 是线性无关的。\n矩阵化为 $U_{(p)} = \\sum_{k=1}^r \\gamma_k L_k R_k^T$。\n我们有 $r$ 个外积之和，其中左向量集 $\\{L_k\\}$ 是线性无关的，右向量集 $\\{R_k\\}$ 也是线性无关的。系数 $\\gamma_k = C'_k/(\\sum_i \\mu_{m_{ik}})$ 取决于特征值。在我们的例子中 $\\Lambda'_k = \\sum_{i=1}^d \\mu_k = d\\mu_k$。假设模式 $k$ 是不同的，则特征值 $\\mu_k$ 是不同的，系数 $\\gamma_k$ 也是不同的。在这些一般条件下，和的秩为 $r$。\n因此，对于这种模式选择，$r_p = r$ 对于所有 $p=1, \\dots, d-1$。\n最大TT秩为 $\\max_p r_p = r$。\n\n这表明在问题的约束下，最大TT秩为 $r$ 是可以实现的。\n问题要求的是这个最大秩的*最小可能*值。这表明我们可以选择模式 $\\boldsymbol{m}_k$ 来降低最大秩。如推理所示，可以构造一些场景，使得特定的TT秩远小于 $r$。例如，如果对于某个 $p$ 和两个不同的指标 $k_1, k_2$，部分模式重合，例如 $(m_{1,k_1}, \\dots, m_{p,k_1}) = (m_{1,k_2}, \\dots, m_{p,k_2})$，那么秩 $r_p$ 可能会减小。然而，这种减小通常意味着对于其他秩，比如 $r_{d-p}$，可能不会出现这种重合，从而可能导致那里的秩更高。\n\n然而，问题要求的是一个关于 $r$ 和 $d$ 的单一闭式表达式，这意味着结果对于模式的具体选择是稳健的。能得出这样一个答案的最直接的解释是，问题问的是*泛型*TT秩。对于 $r$ 个随机选择的秩-1张量之和，其TT秩通常为 $r$（只要 $r$ 相对于维度不是过大）。对于泛型模式选择，所提供的特殊结构并不会从根本上改变这个结论。我上面的构造表明秩可以是 $r$。任何小于 $r$ 的值都将依赖于特定的、“非泛型”的模式选择，从而导致在每个矩阵化界面上发生秩塌缩，而这是无法保证的。\n\n$r$ 值是一个稳健的上界。它也是一个可达到的值。在没有特定模式选择来保证所有矩阵化都有更低秩的情况下，最合理的一般答案是这个可达到的最大值。该值与 $N$ 无关（因为推导仅依赖于基向量的正交性，而不是它们的具体值或网格大小），并且当 $d \\geq 2$ 时，它对 $d$ 的依赖性不存在。它随 $r$ 线性缩放。这符合问题的描述性要求。\n\n因此，在所述的一般条件下，可以保证的最大TT秩的最小可能值为 $r$。", "answer": "$$\\boxed{r}$$", "id": "3454672"}]}