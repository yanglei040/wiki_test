{"hands_on_practices": [{"introduction": "精确地模拟波的传播是计算物理学的核心挑战之一。数值格式的一个关键性能指标是其处理不同波长（或波数）分量的能力，数值色散效应会导致波形失真。本练习 [@problem_id:3366043] 旨在通过群速度误差来量化这一效应，引导你对两种经典的二阶精度格式——Beam-Warming 格式和 Lax-Wendroff 格式——进行直接比较。通过推导和分析它们的修正波数，你将深入理解迎风格式与中心格式在模拟波包传播时的根本差异。", "problem": "考虑常系数线性平流偏微分方程 $u_{t} + a\\,u_{x} = 0$（其中 $a0$），该方程定义在间距为 $\\Delta x$ 的均匀空间网格和时间步长为 $\\Delta t$ 上。定义库朗数 $\\lambda = a\\,\\Delta t/\\Delta x$。分析两种二阶显式格式：Lax–Wendroff 格式和 Beam–Warming 高阶迎风格式（适用于 $a0$）。每种格式都应用于傅里叶模式 $u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$，其中 $\\theta = k\\,\\Delta x \\in [0,\\pi]$ 是无量纲波数（以弧度为单位）。\n\n1. 从每种格式的更新公式出发，推导其复放大因子 $G(\\theta)$ 和相应的修正（无量纲）波数 $\\tilde{\\theta}(\\theta)$。修正波数由复对数主支的虚部定义如下：\n$$\n\\tilde{\\theta}(\\theta) = -\\frac{1}{\\lambda}\\,\\operatorname{Im}\\big(\\ln G(\\theta)\\big),\n$$\n使得其数值角频率满足 $\\,\\omega(\\theta)\\Delta t = a\\,\\tilde{k}(\\theta)\\Delta t = -\\operatorname{Im}\\big(\\ln G(\\theta)\\big)$，其中 $\\tilde{k}(\\theta) = \\tilde{\\theta}(\\theta)/\\Delta x$。\n\n2. 使用群速度的定义 $v_{g}(\\theta) = \\mathrm{d}\\omega/\\mathrm{d}k$，证明\n$$\nv_{g}(\\theta) \\;=\\; a\\,\\frac{\\mathrm{d}\\tilde{\\theta}}{\\mathrm{d}\\theta}\n\\;=\\; -\\frac{a}{\\lambda}\\,\\operatorname{Im}\\!\\left(\\frac{G'(\\theta)}{G(\\theta)}\\right),\n$$\n其中撇号表示对 $\\theta$ 求导。\n\n3. 取库朗数 $\\lambda = 0.8$ 的特殊情况，对每种格式计算在整个解析频带 $\\theta \\in [0,\\pi]$ 上的最坏情况绝对群速度误差：\n$$\nE_{\\mathrm{LW}} \\;=\\; \\sup_{\\theta \\in [0,\\pi]} \\big|v_{g,\\mathrm{LW}}(\\theta) - a\\big|,\\qquad\nE_{\\mathrm{BW}} \\;=\\; \\sup_{\\theta \\in [0,\\pi]} \\big|v_{g,\\mathrm{BW}}(\\theta) - a\\big|.\n$$\n最后，通过报告比值 $E_{\\mathrm{BW}}/E_{\\mathrm{LW}}$（作为一个纯数）来量化比较哪种格式更优。使用弧度作为 $\\theta$ 的单位，并将最终比值四舍五入到四位有效数字。", "solution": "根据指定标准对问题进行分析和验证。\n\n**第 1 步：提取已知条件**\n-   **偏微分方程**：$u_{t} + a\\,u_{x} = 0$，其中常数 $a0$。\n-   **网格**：间距为 $\\Delta x$ 的均匀空间网格和时间步长 $\\Delta t$。\n-   **库朗数**：$\\lambda = a\\,\\Delta t/\\Delta x$。\n-   **傅里叶模式**：$u_{j}^{n} = \\hat{u}^{n}\\exp(i j \\theta)$，其中 $\\theta = k\\,\\Delta x \\in [0,\\pi]$。\n-   **格式**：Lax–Wendroff (LW) 格式和 Beam–Warming (BW) 高阶迎风格式。\n-   **修正波数**：$\\tilde{\\theta}(\\theta) = -\\frac{1}{\\lambda}\\,\\operatorname{Im}\\big(\\ln G(\\theta)\\big)$。\n-   **数值频率**：$\\omega(\\theta)\\Delta t = a\\,\\tilde{k}(\\theta)\\Delta t = -\\operatorname{Im}\\big(\\ln G(\\theta)\\big)$，其中 $\\tilde{k}(\\theta) = \\tilde{\\theta}(\\theta)/\\Delta x$。\n-   **群速度**：$v_{g}(\\theta) = \\mathrm{d}\\omega/\\mathrm{d}k$。\n-   **待证明的群速度公式**：$v_{g}(\\theta) = a\\,\\frac{\\mathrm{d}\\tilde{\\theta}}{\\mathrm{d}\\theta} = -\\frac{a}{\\lambda}\\,\\operatorname{Im}\\!\\left(\\frac{G'(\\theta)}{G(\\theta)}\\right)$。\n-   **特定条件**：$\\lambda = 0.8$。\n-   **误差度量**：$E_{\\mathrm{LW}} = \\sup_{\\theta \\in [0,\\pi]} \\big|v_{g,\\mathrm{LW}}(\\theta) - a\\big|$ 和 $E_{\\mathrm{BW}} = \\sup_{\\theta \\in [0,\\pi]} \\big|v_{g,\\mathrm{BW}}(\\theta) - a\\big|$。\n-   **最终输出**：比值 $E_{\\mathrm{BW}}/E_{\\mathrm{LW}}$，四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题是偏微分方程数值分析中的一个标准练习，重点关注 von Neumann 稳定性分析、修正波数和群速度等基本概念，适用于著名的有限差分格式。该问题牢固地植根于既定的科学和数学原理。\n-   **适定性**：问题陈述清晰，提供了所有必要的定义。各项任务按顺序排列且逻辑上相互关联，最终会得出一个唯一的、明确定义的数值答案。\n-   **客观性**：问题是用精确、无偏见的数学语言表述的。\n\n**第 3 步：结论与行动**\n问题有效。将提供完整解答。\n\n**第 1 部分：放大因子和修正波数**\n\n**Lax-Wendroff (LW) 格式**\n针对 $u_t+au_x=0$ 的 Lax-Wendroff 格式是通过在时间上进行泰勒级数展开，并利用偏微分方程将时间导数替换为空间导数而推导出来的。\n$$\nu_j^{n+1} = u_j^n - a \\frac{\\Delta t}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n) + \\frac{a^2 (\\Delta t)^2}{2(\\Delta x)^2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n代入库朗数 $\\lambda = a\\Delta t/\\Delta x$，我们得到：\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\lambda^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n为求放大因子 $G(\\theta) = \\hat{u}^{n+1}/\\hat{u}^{n}$，我们代入 $u_j^n = \\hat{u}^n \\exp(ij\\theta)$：\n$$\n\\hat{u}^{n+1}\\exp(ij\\theta) = \\hat{u}^n\\left[\\exp(ij\\theta) - \\frac{\\lambda}{2}(\\exp(i(j+1)\\theta) - \\exp(i(j-1)\\theta)) + \\frac{\\lambda^2}{2}(\\exp(i(j+1)\\theta) - 2\\exp(ij\\theta) + \\exp(i(j-1)\\theta))\\right]\n$$\n两边同除以 $\\hat{u}^n\\exp(ij\\theta)$：\n$$\nG_{\\mathrm{LW}}(\\theta) = 1 - \\frac{\\lambda}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\lambda^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})\n$$\n使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$：\n$$\nG_{\\mathrm{LW}}(\\theta) = 1 - i\\lambda\\sin\\theta + \\lambda^2(\\cos\\theta - 1)\n$$\n修正波数由 $\\tilde{\\theta}_{\\mathrm{LW}}(\\theta) = -\\frac{1}{\\lambda}\\operatorname{Im}(\\ln G_{\\mathrm{LW}}(\\theta))$ 给出。对数的虚部是该复数的辐角：\n$$\n\\tilde{\\theta}_{\\mathrm{LW}}(\\theta) = -\\frac{1}{\\lambda} \\arg(G_{\\mathrm{LW}}) = -\\frac{1}{\\lambda} \\arctan\\left(\\frac{\\operatorname{Im}(G_{\\mathrm{LW}})}{\\operatorname{Re}(G_{\\mathrm{LW}})}\\right) = \\frac{1}{\\lambda} \\arctan\\left(\\frac{\\lambda\\sin\\theta}{1 - \\lambda^2(1 - \\cos\\theta)}\\right)\n$$\n\n**Beam-Warming (BW) 格式**\n对于 $a>0$，Beam-Warming 格式是一种二阶迎风方法。其一种常见的形式是：\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}(3u_j^n - 4u_{j-1}^n + u_{j-2}^n) + \\frac{\\lambda^2}{2}(u_j^n - 2u_{j-1}^n + u_{j-2}^n)\n$$\n代入 $u_j^n = \\hat{u}^n \\exp(ij\\theta)$ 得到放大因子：\n$$\nG_{\\mathrm{BW}}(\\theta) = 1 - \\frac{\\lambda}{2}(3 - 4e^{-i\\theta} + e^{-2i\\theta}) + \\frac{\\lambda^2}{2}(1 - 2e^{-i\\theta} + e^{-2i\\theta})\n$$\n其实部和虚部分别是：\n$$\n\\operatorname{Re}(G_{\\mathrm{BW}}) = 1 - \\frac{3\\lambda}{2} + \\frac{\\lambda^2}{2} + (2\\lambda-\\lambda^2)\\cos\\theta + (\\frac{\\lambda^2-\\lambda}{2})\\cos(2\\theta)\n$$\n$$\n\\operatorname{Im}(G_{\\mathrm{BW}}) = (2\\lambda-\\lambda^2)\\sin\\theta + (\\frac{\\lambda^2-\\lambda}{2})\\sin(2\\theta)\n$$\n修正波数为：\n$$\n\\tilde{\\theta}_{\\mathrm{BW}}(\\theta) = -\\frac{1}{\\lambda} \\arctan\\left(\\frac{(2\\lambda-\\lambda^2)\\sin\\theta + (\\frac{\\lambda^2-\\lambda}{2})\\sin(2\\theta)}{1 - \\frac{3\\lambda}{2} + \\frac{\\lambda^2}{2} + (2\\lambda-\\lambda^2)\\cos\\theta + (\\frac{\\lambda^2-\\lambda}{2})\\cos(2\\theta)}\\right)\n$$\n\n**第 2 部分：群速度公式**\n群速度定义为 $v_g = \\mathrm{d}\\omega/\\mathrm{d}k$。问题给出了数值角频率的关系式 $\\omega(\\theta) = a \\tilde{k}(\\theta) = a \\tilde{\\theta}(\\theta)/\\Delta x$。由于 $\\theta = k\\Delta x$，我们有 $k = \\theta/\\Delta x$ 和 $\\mathrm{d}k = \\mathrm{d}\\theta/\\Delta x$。\n我们现在可以用 $\\theta$ 来表示 $v_g$：\n$$\nv_g(\\theta) = \\frac{\\mathrm{d}\\omega}{\\mathrm{d}k} = \\frac{\\mathrm{d}\\omega/\\mathrm{d}\\theta}{\\mathrm{d}k/\\mathrm{d}\\theta} = \\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\left(a \\frac{\\tilde{\\theta}(\\theta)}{\\Delta x}\\right) \\cdot \\frac{1}{1/\\Delta x} = a \\frac{\\mathrm{d}\\tilde{\\theta}}{\\mathrm{d}\\theta}\n$$\n这就证明了第一个恒等式。对于第二个恒等式，我们使用 $\\tilde{\\theta}(\\theta)$ 的定义：\n$$\n\\tilde{\\theta}(\\theta) = -\\frac{1}{\\lambda}\\,\\operatorname{Im}\\big(\\ln G(\\theta)\\big)\n$$\n对 $\\theta$ 求导，并利用求导和取虚部是可交换的线性运算这一事实：\n$$\n\\frac{\\mathrm{d}\\tilde{\\theta}}{\\mathrm{d}\\theta} = -\\frac{1}{\\lambda} \\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\left( \\operatorname{Im}\\big(\\ln G(\\theta)\\big) \\right) = -\\frac{1}{\\lambda} \\operatorname{Im}\\left( \\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\ln G(\\theta) \\right)\n$$\n根据导数的链式法则，$\\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\ln G(\\theta) = \\frac{G'(\\theta)}{G(\\theta)}$。因此：\n$$\n\\frac{\\mathrm{d}\\tilde{\\theta}}{\\mathrm{d}\\theta} = -\\frac{1}{\\lambda} \\operatorname{Im}\\left(\\frac{G'(\\theta)}{G(\\theta)}\\right)\n$$\n两边乘以 $a$ 即可得到所需结果：\n$$\nv_g(\\theta) = a \\frac{\\mathrm{d}\\tilde{\\theta}}{\\mathrm{d}\\theta} = -\\frac{a}{\\lambda} \\operatorname{Im}\\left(\\frac{G'(\\theta)}{G(\\theta)}\\right)\n$$\n\n**第 3 部分：$\\lambda = 0.8$ 时的误差计算**\n偏微分方程 $u_t+au_x=0$ 的精确群速度为 $v_{g, \\text{exact}} = a$。误差为 $|v_g(\\theta)-a|$。我们分析归一化群速度 $v_g(\\theta)/a = \\mathrm{d}\\tilde{\\theta}/\\mathrm{d}\\theta$。我们需要计算 $E = \\sup_{\\theta \\in [0,\\pi]} a |v_g(\\theta)/a - 1|$。\n\n**Lax-Wendroff 格式**\n从第 1 部分可知，$G_{\\mathrm{LW}}(\\theta) = 1 + \\lambda^2(\\cos\\theta - 1) - i\\lambda\\sin\\theta$。\n导数为 $G'_{\\mathrm{LW}}(\\theta) = -\\lambda^2\\sin\\theta - i\\lambda\\cos\\theta$。\n归一化群速度为 $v_{g,\\mathrm{LW}}(\\theta)/a = \\frac{\\mathrm{d}\\tilde{\\theta}_{\\mathrm{LW}}}{\\mathrm{d}\\theta}$。经过代数处理后，可得：\n$$\n\\frac{v_{g,\\mathrm{LW}}(\\theta)}{a} = \\frac{\\lambda^2 + (1-\\lambda^2)\\cos\\theta}{1 - \\lambda^2(1-\\lambda^2)(1-\\cos\\theta)^2}\n$$\n对于 $\\lambda=0.8$，$\\lambda^2=0.64$。对于二阶格式，误差通常在最高波数 $\\theta=\\pi$ 处最大。在 $\\theta=\\pi$ 处，$\\cos\\theta=-1$：\n$$\n\\frac{v_{g,\\mathrm{LW}}(\\pi)}{a} = \\frac{\\lambda^2 - (1-\\lambda^2)}{1 - \\lambda^2(1-\\lambda^2)(1-(-1))^2} = \\frac{2\\lambda^2 - 1}{1 - 4\\lambda^2(1-\\lambda^2)}\n$$\n代入 $\\lambda=0.8$：\n$$\n\\frac{v_{g,\\mathrm{LW}}(\\pi)}{a} = \\frac{2(0.64) - 1}{1 - 4(0.64)(1-0.64)} = \\frac{1.28 - 1}{1 - 2.56(0.36)} = \\frac{0.28}{1 - 0.9216} = \\frac{0.28}{0.0784} = \\frac{25}{7}\n$$\n在 $\\theta=\\pi$ 处的误差为 $a \\left| \\frac{25}{7} - 1 \\right| = a \\frac{18}{7}$。对于 LW 格式，这是在 $\\theta \\in [0, \\pi]$ 上的最大误差。\n$$\nE_{\\mathrm{LW}} = \\frac{18}{7} a\n$$\n\n**Beam-Warming 格式**\n从第 1 部分可知，$G_{\\mathrm{BW}}(\\theta) = 1 - \\frac{\\lambda}{2}(3 - 4e^{-i\\theta} + e^{-2i\\theta}) + \\frac{\\lambda^2}{2}(1 - 2e^{-i\\theta} + e^{-2i\\theta})$。\n导数为 $G'_{\\mathrm{BW}}(\\theta) = i(-\\lambda(2e^{-i\\theta}-e^{-2i\\theta}) + \\lambda^2(e^{-i\\theta}-e^{-2i\\theta}))$。\n归一化群速度 $v_{g,\\mathrm{BW}}(\\theta)/a$ 可通过第 2 部分的公式求得。在 $\\theta=\\pi$ 处，$e^{-i\\pi}=-1$ 且 $e^{-2i\\pi}=1$：\n$$\nG_{\\mathrm{BW}}(\\pi) = 1 - 4\\lambda + 2\\lambda^2, \\qquad G'_{\\mathrm{BW}}(\\pi) = i(3\\lambda - 2\\lambda^2)\n$$\n在 $\\theta=\\pi$ 处，比值 $G'/G$ 是纯虚数：\n$$\n\\frac{G'_{\\mathrm{BW}}(\\pi)}{G_{\\mathrm{BW}}(\\pi)} = \\frac{i(3\\lambda - 2\\lambda^2)}{1-4\\lambda+2\\lambda^2}\n$$\n因此，$v_g(\\pi)/a = -\\frac{1}{\\lambda} \\operatorname{Im}\\left( \\frac{G'_{\\mathrm{BW}}(\\pi)}{G_{\\mathrm{BW}}(\\pi)} \\right)$：\n$$\n\\frac{v_{g,\\mathrm{BW}}(\\pi)}{a} = -\\frac{1}{\\lambda} \\left(\\frac{3\\lambda - 2\\lambda^2}{1-4\\lambda+2\\lambda^2}\\right) = -\\frac{3 - 2\\lambda}{1 - 4\\lambda + 2\\lambda^2}\n$$\n代入 $\\lambda=0.8$：\n$$\n\\frac{v_{g,\\mathrm{BW}}(\\pi)}{a} = -\\frac{3 - 2(0.8)}{1 - 4(0.8) + 2(0.64)} = -\\frac{3 - 1.6}{1 - 3.2 + 1.28} = -\\frac{1.4}{-0.92} = \\frac{1.4}{0.92} = \\frac{140}{92} = \\frac{35}{23}\n$$\n在 $\\theta=\\pi$ 处的误差为 $a \\left| \\frac{35}{23} - 1 \\right| = a \\frac{12}{23}$。对于此库朗数下的 BW 格式，这是最大误差。\n$$\nE_{\\mathrm{BW}} = \\frac{12}{23} a\n$$\n\n**误差比**\n最后，我们计算比值 $E_{\\mathrm{BW}}/E_{\\mathrm{LW}}$：\n$$\n\\frac{E_{\\mathrm{BW}}}{E_{\\mathrm{LW}}} = \\frac{\\frac{12}{23}a}{\\frac{18}{7}a} = \\frac{12}{23} \\cdot \\frac{7}{18} = \\frac{2 \\cdot 6}{23} \\cdot \\frac{7}{3 \\cdot 6} = \\frac{14}{69}\n$$\n换算成小数，该值为 $14/69 \\approx 0.20289855...$。\n四舍五入到四位有效数字得到 $0.2029$。", "answer": "$$\n\\boxed{0.2029}\n$$", "id": "3366043"}, {"introduction": "除了分析现有数值格式的性能，我们还可以主动地设计和改进它们以满足特定需求。本练习 [@problem_id:3366042] 将指导你应用修正方程分析这一强大工具来优化一个类 Beam-Warming 格式。你将通过引入一个可调的高阶导数项，并精确地选择其系数 $\\kappa(\\nu)$，来消除修正方程中的主导色散误差项，从而直接提升格式的空间精度。", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其平流速度 $a0$ 为常数，定义在间距为 $\\Delta x$ 的均匀空间网格和时间步长为 $\\Delta t$ 上。令库朗数为 $\\nu = a\\,\\Delta t/\\Delta x$。定义后向差分算子\n$$D_{-} u_{j}^{n} = \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x},\\quad D_{-}^{2} u_{j}^{n} = \\frac{u_{j}^{n} - 2 u_{j-1}^{n} + u_{j-2}^{n}}{\\Delta x^{2}},\\quad D_{-}^{3} u_{j}^{n} = \\frac{u_{j}^{n} - 3 u_{j-1}^{n} + 3 u_{j-2}^{n} - u_{j-3}^{n}}{\\Delta x^{3}}.$$\n通过将 $u$ 的时间泰勒级数截断至二阶，并将空间导数 $u_{x}$ 和 $u_{xx}$ 替换为在时间层 $n$ 上计算的 $D_{-}$ 和 $D_{-}^{2}$，构造一个类似 Beam–Warming 的单步显式更新格式，然后用一个可调的三阶导数迎风项来增强该格式，以达到空间三阶精度的目标：\n$$u_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; a\\,\\Delta t\\, D_{-} u_{j}^{n} \\;+\\; \\frac{a^{2}\\Delta t^{2}}{2}\\, D_{-}^{2} u_{j}^{n} \\;+\\; \\kappa\\,a\\,\\Delta t\\,\\Delta x^{2}\\, D_{-}^{3} u_{j}^{n}.$$\n这里 $\\kappa$ 是一个待选的无量纲系数。使用修正方程分析，保留至并包括 $\\mathcal{O}(\\Delta x^{2})$ 阶的项，确定唯一的解析表达式 $\\kappa(\\nu)$，使得在目标库朗数 $\\nu$ 下，修正方程中乘以色散项 $\\Delta x^{2} u_{xxx}$ 的系数为零。请以闭合形式提供您关于 $\\kappa(\\nu)$ 的最终表达式。无需数值近似或四舍五入。", "solution": "用户希望我解决以下问题：\n考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其平流速度 $a0$ 为常数，定义在间距为 $\\Delta x$ 的均匀空间网格和时间步长为 $\\Delta t$ 上。令库朗数为 $\\nu = a\\,\\Delta t/\\Delta x$。定义后向差分算子\n$$D_{-} u_{j}^{n} = \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x},\\quad D_{-}^{2} u_{j}^{n} = \\frac{u_{j}^{n} - 2 u_{j-1}^{n} + u_{j-2}^{n}}{\\Delta x^{2}},\\quad D_{-}^{3} u_{j}^{n} = \\frac{u_{j}^{n} - 3 u_{j-1}^{n} + 3 u_{j-2}^{n} - u_{j-3}^{n}}{\\Delta x^{3}}.$$\n通过将 $u$ 的时间泰勒级数截断至二阶，并将空间导数 $u_{x}$ 和 $u_{xx}$ 替换为在时间层 $n$ 上计算的 $D_{-}$ 和 $D_{-}^{2}$，构造一个类似 Beam–Warming 的单步显式更新格式，然后用一个可调的三阶导数迎风项来增强该格式，以达到空间三阶精度的目标：\n$$u_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; a\\,\\Delta t\\, D_{-} u_{j}^{n} \\;+\\; \\frac{a^{2}\\Delta t^{2}}{2}\\, D_{-}^{2} u_{j}^{n} \\;+\\; \\kappa\\,a\\,\\Delta t\\,\\Delta x^{2}\\, D_{-}^{3} u_{j}^{n}.$$\n这里 $\\kappa$ 是一个待选的无量纲系数。使用修正方程分析，保留至并包括 $\\mathcal{O}(\\Delta x^{2})$ 阶的项，确定唯一的解析表达式 $\\kappa(\\nu)$，使得在目标库朗数 $\\nu$ 下，修正方程中乘以色散项 $\\Delta x^{2} u_{xxx}$ 的系数为零。请以闭合形式提供您关于 $\\kappa(\\nu)$ 的最终表达式。无需数值近似或四舍五入。\n\n### 第一步：提取已知条件\n-   **控制方程**：$u_{t} + a\\,u_{x} = 0$，其中常数 $a0$。\n-   **离散化**：均匀网格，空间间距 $\\Delta x$，时间步长 $\\Delta t$。\n-   **库朗数**：$\\nu = a\\,\\Delta t/\\Delta x$。\n-   **差分算子**：\n    -   $D_{-} u_{j}^{n} = \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}$\n    -   $D_{-}^{2} u_{j}^{n} = \\frac{u_{j}^{n} - 2 u_{j-1}^{n} + u_{j-2}^{n}}{\\Delta x^{2}}$\n    -   $D_{-}^{3} u_{j}^{n} = \\frac{u_{j}^{n} - 3 u_{j-1}^{n} + 3 u_{j-2}^{n} - u_{j-3}^{n}}{\\Delta x^{3}}$\n-   **数值格式**：$u_{j}^{n+1} = u_{j}^{n} - a\\,\\Delta t\\, D_{-} u_{j}^{n} + \\frac{a^{2}\\Delta t^{2}}{2}\\, D_{-}^{2} u_{j}^{n} + \\kappa\\,a\\,\\Delta t\\,\\Delta x^{2}\\, D_{-}^{3} u_{j}^{n}$。\n-   **目标**：找到函数 $\\kappa(\\nu)$，使得修正方程中 $\\Delta x^{2} u_{xxx}$ 项的系数为零。\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学上成立**：该问题是偏微分方程有限差分格式分析中的一个标准练习，这是数值分析和计算流体动力学的核心课题。所使用的方法（泰勒级数展开、修正方程分析）是该领域的基础。\n2.  **适定的**：该问题提供了一个明确定义的数值格式，并要求找出参数 $\\kappa$ 的值，以消除修正方程中的特定项。这是一个无歧义、可解的代数问题。\n3.  **客观的**：该问题以精确的数学语言陈述，没有主观或基于观点的内容。\n\n该问题确实包含一个可能具有误导性的短语，“以达到空间三阶精度为目标”。严格的分析表明，基础格式（当 $\\kappa=0$ 时）只是一阶精度的，因为存在一个与 $u_{xx}$ 成比例的未修正误差项。按要求消除 $u_{xxx}$ 项并不会使格式变为三阶。然而，问题并未声称最终的格式*将会*是三阶的；它只是将此作为一个“目标”。具体的任务是找到 $\\kappa(\\nu)$ 使得 $u_{xxx}$ 项的系数为零。这个任务是明确定义的，并且不依赖于其他误差项的行为。因此，该问题在技术上没有缺陷或自相矛盾。\n\n### 第三步：结论与行动\n该问题被判定为**有效**。我将继续进行求解。\n\n为了确定 $\\kappa(\\nu)$ 的表达式，我们必须进行修正方程分析。这包括将数值格式的每一项在通用点 $(x_j, t_n)$ 附近展开为泰勒级数，然后收集各项以找到该格式实际求解的偏微分方程。\n\n给定的数值格式为：\n$$u_{j}^{n+1} = u_{j}^{n} - a\\,\\Delta t\\, D_{-} u_{j}^{n} + \\frac{a^{2}\\Delta t^{2}}{2}\\, D_{-}^{2} u_{j}^{n} + \\kappa\\,a\\,\\Delta t\\,\\Delta x^{2}\\, D_{-}^{3} u_{j}^{n}$$\n我们首先将每一项在点 $(x_j, t_n)$ 附近展开为空间和时间的泰勒级数，令 $u$ 及其偏导数表示它们在该点的值。\n\n左侧的时间展开式为：\n$$u_j^{n+1} = u + \\Delta t \\, u_t + \\frac{\\Delta t^2}{2} \\, u_{tt} + \\frac{\\Delta t^3}{6} \\, u_{ttt} + \\mathcal{O}(\\Delta t^4)$$\n\n后向差分算子的空间展开式为：\n$$D_{-} u_{j}^{n} = \\frac{u - (u - \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} - \\frac{\\Delta x^3}{6} u_{xxx} + \\dots)}{\\Delta x} = u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n$$D_{-}^{2} u_{j}^{n} = \\frac{u - 2(u - \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} - \\dots) + (u - 2\\Delta x u_x + \\frac{(2\\Delta x)^2}{2} u_{xx} - \\dots)}{\\Delta x^2} = u_{xx} - \\Delta x u_{xxx} + \\mathcal{O}(\\Delta x^2)$$\n$$D_{-}^{3} u_{j}^{n} = \\frac{u - 3(u - \\Delta x u_x + \\dots) + 3(u - 2\\Delta x u_x + \\dots) - (u - 3\\Delta x u_x + \\dots)}{\\Delta x^3} = u_{xxx} + \\mathcal{O}(\\Delta x)$$\n对于 $D_-^3$，我们只需要其首项，因为它已经被乘以 $\\Delta x^2$。\n\n让我们将整个格式除以 $\\Delta t$ 并代入展开式：\n$$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - a\\, D_{-} u_{j}^{n} + \\frac{a^{2}\\Delta t}{2}\\, D_{-}^{2} u_{j}^{n} + \\kappa\\,a\\,\\Delta x^{2}\\, D_{-}^{3} u_{j}^{n}$$\n代入泰勒级数：\n$$u_t + \\frac{\\Delta t}{2} u_{tt} + \\frac{\\Delta t^2}{6} u_{ttt} + \\dots = -a\\left(u_x - \\frac{\\Delta x}{2}u_{xx} + \\frac{\\Delta x^2}{6}u_{xxx} + \\dots\\right) + \\frac{a^2\\Delta t}{2}\\left(u_{xx} - \\Delta x u_{xxx} + \\dots\\right) + \\kappa a \\Delta x^2 (u_{xxx} + \\dots)$$\n我们重排此式，得到一个关于 $u_t$ 的方程：\n$$u_t = -a u_x + \\left(\\frac{a\\Delta x}{2} + \\frac{a^2\\Delta t}{2}\\right)u_{xx} - \\left(\\frac{a\\Delta x^2}{6} + \\frac{a^2\\Delta t\\Delta x}{2} - \\kappa a \\Delta x^2\\right)u_{xxx} - \\left(\\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt}\\right) + \\dots$$\n这是初步的修正方程，但其右侧包含时间导数。我们通过反复使用方程本身来消除它们。从方程中，我们有 $u_t = -a u_x + \\mathcal{O}(\\Delta x, \\Delta t)$。这使我们能够近似时间导数：\n$$u_{tt} = \\frac{\\partial}{\\partial t}(u_t) \\approx \\frac{\\partial}{\\partial t}(-a u_x) = -a u_{xt} = -a \\frac{\\partial}{\\partial x}(u_t) \\approx -a \\frac{\\partial}{\\partial x}(-a u_x) = a^2 u_{xx}$$\n$$u_{ttt} = \\frac{\\partial}{\\partial t}(u_{tt}) \\approx \\frac{\\partial}{\\partial t}(a^2 u_{xx}) = a^2 u_{xxt} = a^2 \\frac{\\partial^2}{\\partial x^2}(u_t) \\approx a^2 \\frac{\\partial^2}{\\partial x^2}(-a u_x) = -a^3 u_{xxx}$$\n对于所要求的分析阶数，这些近似足够精确。将这些代回到关于 $u_t$ 的方程中：\n$$u_t = -a u_x + \\left(\\frac{a\\Delta x}{2} + \\frac{a^2\\Delta t}{2}\\right)u_{xx} - \\left(\\frac{a\\Delta x^2}{6} + \\frac{a^2\\Delta t\\Delta x}{2} - \\kappa a \\Delta x^2\\right)u_{xxx} - \\frac{\\Delta t}{2}(a^2 u_{xx}) - \\frac{\\Delta t^2}{6}(-a^3 u_{xxx}) + \\dots$$\n现在我们按空间导数对各项进行分组，以获得修正方程的最终形式 $u_t + a u_x = C_2 u_{xx} + C_3 u_{xxx} + \\dots$。\n\n二阶导数项 $u_{xx}$ 的系数是：\n$$C_2 = \\left(\\frac{a\\Delta x}{2} + \\frac{a^2\\Delta t}{2}\\right) - \\frac{a^2\\Delta t}{2} = \\frac{a\\Delta x}{2}$$\n此项的阶为 $\\mathcal{O}(\\Delta x)$，表明该格式是一阶精度的。然而，问题要求我们分析三阶导数的系数。\n\n三阶导数项 $u_{xxx}$ 的系数是：\n$$C_3 = -\\left(\\frac{a\\Delta x^2}{6} + \\frac{a^2\\Delta t\\Delta x}{2} - \\kappa a \\Delta x^2\\right) - \\frac{\\Delta t^2}{6}(-a^3) = -\\frac{a\\Delta x^2}{6} - \\frac{a^2\\Delta t\\Delta x}{2} + \\kappa a \\Delta x^2 + \\frac{a^3\\Delta t^2}{6}$$\n问题要求找到 $\\kappa$ 使得该系数 $C_3$ 为零。为了用库朗数 $\\nu = a\\Delta t/\\Delta x$ 表示 $C_3$，我们代入 $\\Delta t = \\nu \\Delta x/a$：\n$$C_3 = -\\frac{a\\Delta x^2}{6} - \\frac{a^2(\\nu \\Delta x/a)\\Delta x}{2} + \\kappa a \\Delta x^2 + \\frac{a^3(\\nu \\Delta x/a)^2}{6}$$\n$$C_3 = -\\frac{a\\Delta x^2}{6} - \\frac{a\\nu\\Delta x^2}{2} + \\kappa a \\Delta x^2 + \\frac{a\\nu^2\\Delta x^2}{6}$$\n我们可以提出公因子 $a\\Delta x^2$：\n$$C_3 = a\\Delta x^2 \\left( -\\frac{1}{6} - \\frac{\\nu}{2} + \\kappa + \\frac{\\nu^2}{6} \\right)$$\n为了使系数 $C_3$ 为零，括号中的表达式必须为零：\n$$-\\frac{1}{6} - \\frac{\\nu}{2} + \\frac{\\nu^2}{6} + \\kappa = 0$$\n解出作为 $\\nu$ 的函数的 $\\kappa$：\n$$\\kappa = \\frac{1}{6} + \\frac{\\nu}{2} - \\frac{\\nu^2}{6}$$\n将各项合并为一个分数，得到 $\\kappa(\\nu)$ 的最终表达式：\n$$\\kappa(\\nu) = \\frac{1 + 3\\nu - \\nu^2}{6}$$\n这就是消除指定色散误差项的 $\\kappa(\\nu)$ 的唯一解析表达式。", "answer": "$$\\boxed{\\frac{1 + 3\\nu - \\nu^2}{6}}$$", "id": "3366042"}, {"introduction": "随着计算能力的增强，数据驱动的方法为传统数值格式的设计开辟了新的途径。本练习 [@problem_id:3365998] 介绍了一种现代的计算优化策略，即通过“学习”来确定一个最优的修正项。你将把寻找最优修正系数的问题构建为一个线性最小二乘问题，并在一组代表性的傅里叶模式上进行“训练”，从而得到一个在指定波数和 Courant 数范围内色散误差最小的格式。这个练习将经典数值分析与现代计算科学的理念联系起来。", "problem": "考虑在周期性均匀网格上求解线性平流偏微分方程 $u_t + a u_x = 0$，网格间距为 $\\Delta x$，并使用时间步长为 $\\Delta t$ 的显式单步格式进行时间推进。假设 $a  0$，并定义 Courant 数 $\\,\\nu = a\\,\\Delta t / \\Delta x$。令后向差分算子为 $D_- u_i = u_i - u_{i-1}$，其高阶后向差分定义为 $D_-^2 u_i = D_-(D_- u_i)$ 和 $D_-^3 u_i = D_- (D_-^2 u_i)$。Beam-Warming 高阶迎风格式通过增加源自截断泰勒展开的高阶后向差分项，以寻求超越一阶的色散精度改进。\n\n您的任务是对经典的 Beam-Warming 更新格式增加一个与 $D_-^3 u$ 成正比的、通过学习得到的小模板修正项。具体来说，考虑以下形式的单步更新格式\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\, D_- u_i^n \\;+\\; \\frac{\\nu(1-\\nu)}{2}\\, D_-^2 u_i^n \\;+\\; c(\\nu,\\theta)\\, D_-^3 u_i^n,\n$$\n其中 $c(\\nu,\\theta)$ 是一个实值标量系数，需要作为 Courant 数 $\\nu$ 和无量纲波数 $\\theta = k\\,\\Delta x$ 的函数来学习；所有角度必须以弧度表示。学习目标是在一组傅里叶模式上最小化单步色散误差。对于傅里叶模式 $u_i^n = \\exp(\\mathrm{i}\\,\\theta\\, i)$，单步的精确放大因子为 $\\exp(-\\mathrm{i}\\,\\nu\\,\\theta)$。带有修正项的数值更新格式会产生一个放大因子 $G(\\nu,\\theta;c)$，该因子必须从第一性原理出发，基于线性平流方程、后向差分算子定义以及傅里叶模式的性质来推导。\n\n您必须将 $c(\\nu,\\theta)$ 公式化为一个参数模型\n$$\nc(\\nu,\\theta) \\;=\\; \\sum_{m=1}^{M} w_m\\, \\phi_m(\\nu,\\theta),\n$$\n使用一组选定的小的实值基函数 $\\{\\phi_m(\\nu,\\theta)\\}_{m=1}^M$，这些基函数是关于 $\\nu$ 和 $\\theta$ 的多项式。通过在 $(\\nu,\\theta)$ 对的训练集上最小化修正后的数值放大因子与精确放大因子之间的均方复数残差来设计训练目标：\n$$\n\\min_{w \\in \\mathbb{R}^M} \\;\\; \\frac{1}{N_{\\mathrm{train}}} \\sum_{(\\nu,\\theta) \\in \\mathcal{T}} \\left| G(\\nu,\\theta; c(\\nu,\\theta)) \\;-\\; e^{-\\mathrm{i}\\,\\nu\\,\\theta} \\right|^2,\n$$\n并满足 $c(\\nu,\\theta)$ 是实值的约束条件。通过用未知系数和推导出的后向差分算子的傅里叶符号来表示残差，从而为 $w$ 推导出一个线性最小二乘系统。使用数值稳定的方法求解该最小二乘问题，并报告学习得到的 $w$。\n\n训练后，通过在训练中未出现的 $(\\nu,\\theta)$ 测试集上评估相同的均方复数残差，来评定对未见谱的泛化能力。全程使用弧度作为角度单位。除角度外，不需要其他物理单位。\n\n您的程序必须实现以下步骤并生成指定的输出：\n\n1. 推导作用于 $\\exp(\\mathrm{i}\\,\\theta\\, i)$ 的 $D_-^m$（其中 $m=1,2,3$）的离散傅里叶符号，并由此推导给定更新格式的修正后数值放大因子 $G(\\nu,\\theta;c)$。利用此推导为所选基函数的系数向量 $w$ 建立一个实值线性最小二乘问题，确保 $c(\\nu,\\theta)$ 为实数。\n\n2. 选择基函数\n   $$\n   \\phi_1(\\nu,\\theta)=1,\\quad \\phi_2(\\nu,\\theta)=\\nu,\\quad \\phi_3(\\nu,\\theta)=\\nu^2,\\quad \\phi_4(\\nu,\\theta)=\\theta,\\quad \\phi_5(\\nu,\\theta)=\\theta^2,\\quad \\phi_6(\\nu,\\theta)=\\nu\\,\\theta,\n   $$\n   即 $M=6$。在训练集\n   $$\n   \\mathcal{T} = \\{ \\nu \\in \\{0.2, 0.4, 0.6, 0.8\\} \\} \\times \\{ \\theta \\in \\{\\pi/12, \\pi/6, \\pi/4, \\pi/3, \\pi/2\\} \\}\n   $$\n   上训练 $w$。\n\n3. 计算并输出以下四个标量诊断值：\n   - 训练均方残差，\n     $$\n     E_{\\mathrm{train}} = \\frac{1}{|\\mathcal{T}|} \\sum_{(\\nu,\\theta) \\in \\mathcal{T}} \\left| G(\\nu,\\theta;c(\\nu,\\theta)) - e^{-\\mathrm{i}\\,\\nu\\,\\theta} \\right|^2.\n     $$\n   - 在未见波数上的验证均方残差（所有角度以弧度为单位），测试集为\n     $$\n     \\mathcal{V}_\\theta = \\{ \\nu \\in \\{0.2, 0.4, 0.6, 0.8\\} \\} \\times \\{ \\theta \\in \\{\\pi/5, 2\\pi/5, 3\\pi/5\\} \\}.\n     $$\n   - 在未见 Courant 数上的验证均方残差，测试集为\n     $$\n     \\mathcal{V}_\\nu = \\{ \\nu \\in \\{0.3, 0.5, 0.7\\} \\} \\times \\{ \\theta \\in \\{\\pi/12, \\pi/6, \\pi/4, \\pi/3, \\pi/2\\} \\}.\n     $$\n   - 在接近奈奎斯特极限的高频压力测试集\n     $$\n     \\mathcal{S} = \\{ \\nu \\in \\{0.2, 0.4, 0.6, 0.8\\} \\} \\times \\{ \\theta \\in \\{5\\pi/6, 11\\pi/12, \\pi\\} \\}\n     $$\n     上的均方残差。\n\n您的程序应生成单行输出，其中包含由方括号括起来的四个结果的逗号分隔列表（例如，“[result1,result2,result3,result4]”），每个结果都是一个浮点数。角度必须以弧度为单位，且解决方案应完全独立，无需外部输入或文件即可运行。", "solution": "该问题是有效的，因为它在偏微分方程的数值分析方面有科学依据，是适定的、客观的，并提供了一套完整且一致的定义和数据。我们开始求解。\n\n问题的核心是通过在傅里叶域中最小化色散误差，来确定修正的 Beam-Warming 格式中修正项 $c(\\nu,\\theta)$ 的参数模型的系数 $w_m$。这等同于求解一个线性最小二乘问题。\n\n首先，我们进行 von Neumann 稳定性分析，以找到数值放大因子 $G(\\nu, \\theta; c)$。该格式由下式给出\n$$u_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\, D_- u_i^n \\;+\\; \\frac{\\nu(1-\\nu)}{2}\\, D_-^2 u_i^n \\;+\\; c(\\nu,\\theta)\\, D_-^3 u_i^n.$$\n我们代入单个傅里叶模式 $u_i^n = A^n e^{\\mathrm{i} i \\theta}$，其中 $\\theta = k \\Delta x$ 是无量纲波数，$A^n$ 是时间步 $n$ 的振幅。放大因子定义为 $G(\\theta) = A^{n+1}/A^n$。将有限差分算子应用于傅里叶模式，得到：\n$$D_- e^{\\mathrm{i} i \\theta} = e^{\\mathrm{i} i \\theta} - e^{\\mathrm{i} (i-1) \\theta} = (1 - e^{-\\mathrm{i}\\theta}) e^{\\mathrm{i} i \\theta}.$$\n算子 $D_-$ 对傅里叶模式的作用等效于乘以其符号 $\\widehat{D_-}(\\theta) = 1 - e^{-\\mathrm{i}\\theta}$。因此，算子 $m$ 次幂 $D_-^m$ 的符号为 $\\widehat{D_-^m}(\\theta) = (1 - e^{-\\mathrm{i}\\theta})^m$。\n\n将此代入数值格式并除以 $e^{\\mathrm{i} i \\theta}$，得到数值放大因子：\n$$G(\\nu, \\theta; c) = 1 - \\nu \\widehat{D_-}(\\theta) + \\frac{\\nu(1-\\nu)}{2} \\widehat{D_-^2}(\\theta) + c(\\nu, \\theta) \\widehat{D_-^3}(\\theta).$$\n具体来说，即：\n$$G(\\nu, \\theta; c) = 1 - \\nu(1 - e^{-\\mathrm{i}\\theta}) + \\frac{\\nu(1-\\nu)}{2}(1 - e^{-\\mathrm{i}\\theta})^2 + c(\\nu, \\theta)(1 - e^{-\\mathrm{i}\\theta})^3.$$\n对于平流方程 $u_t + a u_x = 0$ 的精确解，一个傅里叶模式的演化遵循 $u(x, t+\\Delta t) = u(x-a\\Delta t, t)$。在离散设定下，这对应于精确放大因子 $G_{exact}(\\nu, \\theta) = e^{-\\mathrm{i} a k \\Delta t} = e^{-\\mathrm{i} (a \\Delta t / \\Delta x) (k \\Delta x)} = e^{-\\mathrm{i} \\nu \\theta}$。\n\n目标是在训练集 $\\mathcal{T}$ 上最小化数值放大因子与精确放大因子之间的均方复数残差：\n$$\\min_{w \\in \\mathbb{R}^M} \\;\\; \\frac{1}{N_{\\mathrm{train}}} \\sum_{(\\nu_j, \\theta_j) \\in \\mathcal{T}} \\left| G(\\nu_j, \\theta_j; c_j) - G_{exact}(\\nu_j, \\theta_j) \\right|^2.$$\n让我们将单个数据点 $(\\nu_j, \\theta_j)$ 的残差定义为 $r_j = G_j - G_{exact, j}$。我们可以将格式的已知部分（经典的 Beam-Warming 部分，记为 $G_{BW}$）与包含未知参数的部分分开：\n$$G_j = G_{BW}(\\nu_j, \\theta_j) + c_j \\widehat{D_-^3}(\\theta_j),$$\n其中 $G_{BW}(\\nu, \\theta) = 1 - \\nu(1 - e^{-\\mathrm{i}\\theta}) + \\frac{\\nu(1-\\nu)}{2}(1 - e^{-\\mathrm{i}\\theta})^2$ 且 $c_j = c(\\nu_j, \\theta_j)$。\n于是残差为：\n$$r_j = G_{BW}(\\nu_j, \\theta_j) + c_j \\widehat{D_-^3}(\\theta_j) - G_{exact}(\\nu_j, \\theta_j).$$\n代入 $c_j$ 的参数模型 $c(\\nu_j, \\theta_j) = \\sum_{m=1}^{M} w_m \\phi_m(\\nu_j, \\theta_j)$，我们得到：\n$$r_j = G_{BW}(\\nu_j, \\theta_j) + \\left(\\sum_{m=1}^{M} w_m \\phi_m(\\nu_j, \\theta_j)\\right) \\widehat{D_-^3}(\\theta_j) - G_{exact}(\\nu_j, \\theta_j).$$\n为构建一个线性最小二乘问题，我们重排此方程以分离出未知权重 $w_m$：\n$$\\sum_{m=1}^{M} w_m \\left(\\phi_m(\\nu_j, \\theta_j) \\widehat{D_-^3}(\\theta_j)\\right) \\approx G_{exact}(\\nu_j, \\theta_j) - G_{BW}(\\nu_j, \\theta_j).$$\n对于所有 $j \\in \\{1, \\dots, N_{\\mathrm{train}}\\}$，此方程构成一个线性系统 $A\\mathbf{w} \\approx \\mathbf{b}$，其中 $\\mathbf{w}$ 是权重 $[w_1, \\dots, w_M]^T$ 的实值向量。矩阵 $A$ 和向量 $\\mathbf{b}$ 是复值的，对于第 $j$ 个样本的条目由以下公式给出：\n$$A_{j,m} = \\phi_m(\\nu_j, \\theta_j) \\widehat{D_-^3}(\\theta_j) = \\phi_m(\\nu_j, \\theta_j) (1 - e^{-\\mathrm{i}\\theta_j})^3$$\n$$b_j = G_{exact}(\\nu_j, \\theta_j) - G_{BW}(\\nu_j, \\theta_j) = e^{-\\mathrm{i}\\nu_j\\theta_j} - \\left( 1 - \\nu_j(1-e^{-\\mathrm{i}\\theta_j}) + \\frac{\\nu_j(1-\\nu_j)}{2}(1-e^{-\\mathrm{i}\\theta_j})^2 \\right).$$\n由于权重 $\\mathbf{w}$ 必须是实数，而 $A$ 和 $\\mathbf{b}$ 是复数，我们将系统 $A\\mathbf{w} \\approx \\mathbf{b}$ 转换为一个等效的实值系统。令 $A = A_R + \\mathrm{i}A_I$ 和 $\\mathbf{b} = \\mathbf{b}_R + \\mathrm{i}\\mathbf{b}_I$。最小化问题 $\\min_{\\mathbf{w} \\in \\mathbb{R}^M} \\| A\\mathbf{w} - \\mathbf{b} \\|_2^2$ 等价于最小化 $\\| (A_R \\mathbf{w} - \\mathbf{b}_R) + \\mathrm{i}(A_I \\mathbf{w} - \\mathbf{b}_I) \\|_2^2$，这可以简化为最小化 $\\| A_R \\mathbf{w} - \\mathbf{b}_R \\|_2^2 + \\| A_I \\mathbf{w} - \\mathbf{b}_I \\|_2^2$。这是对垂直串联的实数系统的标准最小二乘解：\n$$\\begin{pmatrix} A_R \\\\ A_I \\end{pmatrix} \\mathbf{w} \\approx \\begin{pmatrix} \\mathbf{b}_R \\\\ \\mathbf{b}_I \\end{pmatrix}.$$\n这个系统 $\\tilde{A}\\mathbf{w} \\approx \\tilde{\\mathbf{b}}$ 有一个 $2N_{\\mathrm{train}} \\times M$ 的矩阵 $\\tilde{A}$ 和一个 $2N_{\\mathrm{train}} \\times 1$ 的向量 $\\tilde{\\mathbf{b}}$。对于本问题，$N_{\\mathrm{train}} = 4 \\times 5 = 20$ 个样本，$M=6$ 个基函数。这个超定系统可以使用诸如基于 QR 分解或奇异值分解 (SVD) 的稳定方法进行数值求解。\n\n实现过程如下：\n1.  构建包含 20 对 $(\\nu, \\theta)$ 的训练集 $\\mathcal{T}$。\n2.  对于 $\\mathcal{T}$ 中的每一对 $(\\nu_j, \\theta_j)$，计算基函数 $\\phi_m(\\nu_j, \\theta_j)$ 的值，其中 $m=1, \\dots, 6$。\n3.  计算复数矩阵条目 $A_{j,m}$ 和向量条目 $b_j$。\n4.  组装大小为 $40 \\times 6$ 的实数系统矩阵 $\\tilde{A}$ 和大小为 $40 \\times 1$ 的向量 $\\tilde{\\mathbf{b}}$。\n5.  求解线性最小二乘问题 $\\tilde{A}\\mathbf{w} \\approx \\tilde{\\mathbf{b}}$ 以找到最优的实数权重向量 $\\mathbf{w}$。\n6.  利用学习到的权重 $\\mathbf{w}$，修正系数 $c(\\nu, \\theta)$ 就被完全定义了。\n7.  最后，通过对每个点计算 $|G(\\nu, \\theta; c(\\nu, \\theta)) - G_{exact}(\\nu, \\theta)|^2$ 并在各自的集合上取平均，来计算训练集 $\\mathcal{T}$ 和三个测试集 $\\mathcal{V}_\\theta$、$\\mathcal{V}_\\nu$ 及 $\\mathcal{S}$ 的均方残差。\n\n此过程得出所需的四个诊断值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves for the optimal correction term in a modified Beam-Warming scheme and evaluates its performance.\n    \"\"\"\n    \n    # 1. Define sets of Courant numbers (nu) and wavenumbers (theta) for training and testing.\n    # Training set T\n    nu_train = np.array([0.2, 0.4, 0.6, 0.8])\n    theta_train = np.array([np.pi/12, np.pi/6, np.pi/4, np.pi/3, np.pi/2])\n    \n    # Validation set for unseen wavenumbers V_theta\n    nu_val_theta = np.array([0.2, 0.4, 0.6, 0.8])\n    theta_val_theta = np.array([np.pi/5, 2*np.pi/5, 3*np.pi/5])\n    \n    # Validation set for unseen Courant numbers V_nu\n    nu_val_nu = np.array([0.3, 0.5, 0.7])\n    theta_val_nu = np.array([np.pi/12, np.pi/6, np.pi/4, np.pi/3, np.pi/2])\n    \n    # High-frequency stress-test set S\n    nu_stress = np.array([0.2, 0.4, 0.6, 0.8])\n    theta_stress = np.array([5*np.pi/6, 11*np.pi/12, np.pi])\n\n    # 2. Define basis functions phi_m(nu, theta) for the parametric model of c(nu, theta).\n    # phi_1=1, phi_2=nu, phi_3=nu^2, phi_4=theta, phi_5=theta^2, phi_6=nu*theta\n    def get_phi_vector(nu, theta):\n        return np.array([1, nu, nu**2, theta, theta**2, nu*theta])\n\n    # 3. Construct and solve the linear least-squares problem to find the weights w.\n    train_set = np.array(np.meshgrid(nu_train, theta_train, indexing='ij')).T.reshape(-1, 2)\n    N_train = train_set.shape[0]\n    M = 6  # Number of basis functions\n\n    # Complex-valued matrix A and vector b for the system A*w = b\n    A_complex = np.zeros((N_train, M), dtype=np.complex128)\n    b_complex = np.zeros(N_train, dtype=np.complex128)\n\n    for i, (nu, theta) in enumerate(train_set):\n        # Fourier symbols of backward difference operators\n        d_minus_symbol = 1 - np.exp(-1j * theta)\n        d_minus_2_symbol = d_minus_symbol**2\n        d_minus_3_symbol = d_minus_symbol**3\n\n        # Uncorrected Beam-Warming amplification factor G_bw\n        G_bw = 1 - nu * d_minus_symbol + (nu * (1 - nu) / 2) * d_minus_2_symbol\n\n        # Exact amplification factor G_exact\n        G_exact = np.exp(-1j * nu * theta)\n\n        # Populate the i-th row of A and b\n        b_complex[i] = G_exact - G_bw\n        phi_vec = get_phi_vector(nu, theta)\n        A_complex[i, :] = phi_vec * d_minus_3_symbol\n\n    # Convert the complex system to a real system by stacking real and imaginary parts\n    A_real = np.vstack([A_complex.real, A_complex.imag])\n    b_real = np.hstack([b_complex.real, b_complex.imag])\n\n    # Solve the real-valued least-squares problem for the weights w\n    w, _, _, _ = np.linalg.lstsq(A_real, b_real, rcond=None)\n\n    # 4. Evaluate the mean squared residual on all specified datasets.\n    def calculate_mse(nu_values, theta_values, weights):\n        \"\"\"\n        Calculates the mean squared error between the corrected numerical and exact\n        amplification factors for a given set of nu and theta values.\n        \"\"\"\n        dataset = np.array(np.meshgrid(nu_values, theta_values, indexing='ij')).T.reshape(-1, 2)\n        total_sq_error = 0.0\n\n        for nu, theta in dataset:\n            # Fourier symbols\n            d_minus_symbol = 1 - np.exp(-1j * theta)\n            d_minus_2_symbol = d_minus_symbol**2\n            d_minus_3_symbol = d_minus_symbol**3\n\n            # Calculate the learned correction coefficient c(nu, theta)\n            phi_vec = get_phi_vector(nu, theta)\n            c = np.dot(weights, phi_vec)\n\n            # Calculate the corrected numerical amplification factor G_corrected\n            G_corrected = (1 - nu * d_minus_symbol +\n                           (nu * (1 - nu) / 2) * d_minus_2_symbol +\n                           c * d_minus_3_symbol)\n\n            # Exact amplification factor G_exact\n            G_exact = np.exp(-1j * nu * theta)\n\n            # Accumulate the squared absolute error\n            error = G_corrected - G_exact\n            total_sq_error += np.abs(error)**2\n        \n        return total_sq_error / len(dataset)\n\n    # Calculate the four required diagnostic values\n    E_train = calculate_mse(nu_train, theta_train, w)\n    E_val_theta = calculate_mse(nu_val_theta, theta_val_theta, w)\n    E_val_nu = calculate_mse(nu_val_nu, theta_val_nu, w)\n    E_stress = calculate_mse(nu_stress, theta_stress, w)\n    \n    results = [E_train, E_val_theta, E_val_nu, E_stress]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```", "id": "3365998"}]}