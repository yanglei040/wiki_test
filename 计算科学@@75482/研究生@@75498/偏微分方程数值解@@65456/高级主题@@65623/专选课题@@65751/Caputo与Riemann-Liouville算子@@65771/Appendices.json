{"hands_on_practices": [{"introduction": "本练习解决了一个在数值求解分数阶微分方程时的基本实践挑战。与常微分方程不同，标准初始条件通常无法直接整合到许多分数阶导数的数值格式中。本题将指导您使用标准的解分离技术来处理这一问题，这是为 Caputo 型分数阶问题构建稳健求解器的关键第一步。[@problem_id:3368432]", "problem": "考虑由阶数为 $\\alpha \\in (1,2)$ 的Caputo分数阶导数所控制的线性分数阶演化问题，\n$$ {}^{C}D_{0+}^{\\alpha} u(t) + A u(t) = g(t), \\quad t \\ge 0, $$\n其经典初始条件为 $u(0) = u_{0}$ 和 $u'(0) = u_{1}$。此处，${}^{C}D_{0+}^{\\alpha}$ 表示Caputo导数，$A$ 是巴拿赫空间上的一个给定的有界线性算子，$g(t)$ 是一个给定的源项。对于 $\\alpha \\in (1,2)$，Caputo导数通过复合 $ {}^{C}D_{0+}^{\\alpha} u(t) = I_{0+}^{2-\\alpha} u''(t)$ 来定义，其中 $I_{0+}^{\\beta}$ 是阶数为 $\\beta>0$ 的Riemann–Liouville分数阶积分。\n\n您的任务是使用卷积求积（CQ）方法，在均匀网格 $t_{n} = n h$, $n \\in \\mathbb{N}_{0}$ 上，以恒定时间步长 $h>0$ 对 ${}^{C}D_{0+}^{\\alpha} u(t)$ 进行时间离散化。为了将经典初始条件纳入CQ公式中，请将解分解为 $u(t) = p(t) + v(t)$，其中多项式部分为 $p(t) = u_{0} + u_{1} t$，余项 $v(t)$ 满足 $v(0) = 0$ 和 $v'(0) = 0$。请仅使用Caputo导数的基本定义、其与Riemann–Liouville分数阶积分的关系，以及卷积求积通过用离散符号替换 $s$ 来近似拉普拉斯域映射的原理，来论证为何这种分解是恰当的。\n\n论证多项式部分 $p(t)$ 在CQ格式的离散右端项序列中产生一个已知的修正项，并且在时间层 $t_{n}$ 处的该修正项为 $c^{n} = -A p(t_{n})$。然后，将该修正序列的生成函数（也称为$z$变换）定义为\n$$ C(\\zeta) = \\sum_{n=0}^{\\infty} c^{n} \\zeta^{n}, \\quad |\\zeta| < 1, $$\n并推导出一个用 $\\zeta$、$h$、$u_{0}$、$u_{1}$ 和 $A$ 表示的 $C(\\zeta)$ 的闭式表达式。\n\n您的最终答案应为 $C(\\zeta)$ 的单个解析表达式；无需四舍五入，表达式中不应包含任何单位。", "solution": "首先对问题进行验证，以确保其科学上合理、适定且客观。\n\n### 步骤1：提取已知条件\n- **微分方程**: ${}^{C}D_{0+}^{\\alpha} u(t) + A u(t) = g(t)$, $t \\ge 0$。\n- **分数阶**: $\\alpha \\in (1,2)$。\n- **导数定义**: Caputo导数 ${}^{C}D_{0+}^{\\alpha} u(t)$ 定义为 ${}^{C}D_{0+}^{\\alpha} u(t) = I_{0+}^{2-\\alpha} u''(t)$，其中 $I_{0+}^{\\beta}$ 是阶数为 $\\beta>0$ 的Riemann–Liouville分数阶积分。\n- **初始条件**: $u(0) = u_{0}$ 和 $u'(0) = u_{1}$。\n- **算子**: $A$ 是巴拿赫空间上的一个有界线性算子。\n- **源项**: $g(t)$。\n- **离散化**: 采用卷积求积（CQ）方法，在网格 $t_{n} = n h$, $n \\in \\mathbb{N}_{0}$ 上使用恒定时间步长 $h>0$。\n- **解的分解**: $u(t) = p(t) + v(t)$，其中 $p(t) = u_{0} + u_{1} t$，且 $v(t)$ 满足 $v(0) = 0$ 和 $v'(0) = 0$。\n- **修正项**: 问题假定在时间层 $t_n$ 处的修正项由 $c^{n} = -A p(t_{n})$ 给出。\n- **生成函数**: $C(\\zeta) = \\sum_{n=0}^{\\infty} c^{n} \\zeta^{n}$, for $|\\zeta| < 1$。\n- **目标**: 推导 $C(\\zeta)$ 的闭式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在分数阶微分方程的数值分析这一数学领域内是良定义的。Caputo导数的定义、其与Riemann-Liouville积分的关系以及卷积求积方法的使用都是标准的。所提出的解分解是在此背景下处理非齐次初始条件的一种常用技术。所有术语都定义清晰，任务是基于所提供框架的直接数学推导。该问题有科学依据、客观且自洽。未检测到任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。将提供一个完整的、有理有据的解法。\n\n### 解法推导\n\n问题的核心在于理解如何将非齐次初始条件纳入卷积求积（CQ）格式中。CQ方法基本上是基于近似那些在拉普拉斯域中表现为简单乘法的算子。\n\n阶数为 $\\alpha \\in (m-1, m)$ 的Caputo导数的拉普拉斯变换由下式给出：\n$$ \\mathcal{L}\\{{}^{C}D_{0+}^{\\alpha}f(t)\\}(s) = s^{\\alpha}\\hat{f}(s) - \\sum_{k=0}^{m-1} s^{\\alpha-1-k} f^{(k)}(0) $$\n对于我们的问题，$\\alpha \\in (1,2)$，因此 $m=2$。经过拉普拉斯变换的方程是：\n$$ \\left( s^{\\alpha}\\hat{u}(s) - s^{\\alpha-1}u(0) - s^{\\alpha-2}u'(0) \\right) + A\\hat{u}(s) = \\hat{g}(s) $$\nCQ直接近似于拉普拉斯域中与乘以 $s^{\\alpha}$ 相对应的算子。而涉及初始条件的项 $-s^{\\alpha-1}u(0) - s^{\\alpha-2}u'(0)$ 不符合这种卷积结构。\n\n提出的分解 $u(t) = p(t) + v(t)$（其中 $p(t) = u_{0} + u_{1}t$）正是为了规避这个问题。多项式 $p(t)$ 被构造来满足给定的初始条件：\n$$ p(0) = u_{0} + u_{1}(0) = u_{0} = u(0) $$\n$$ p'(0) = u_{1} = u'(0) $$\n这意味着余项 $v(t) = u(t) - p(t)$ 必须满足齐次初始条件：\n$$ v(0) = u(0) - p(0) = u_{0} - u_{0} = 0 $$\n$$ v'(0) = u'(0) - p'(0) = u_{1} - u_{1} = 0 $$\n对于像 $v(t)$ 这样直到 $m-1$ 阶的初始条件都为零的函数，其Caputo导数的拉普拉斯变换会大大简化：\n$$ \\mathcal{L}\\{{}^{C}D_{0+}^{\\alpha}v(t)\\}(s) = s^{\\alpha}\\hat{v}(s) $$\n这个表达式现在表示时域中的一个纯卷积，而这正是CQ方法被设计用来离散化的结构。\n\n我们现在将分解式 $u(t) = p(t) + v(t)$ 代入原始微分方程中：\n$$ {}^{C}D_{0+}^{\\alpha} (p(t) + v(t)) + A(p(t) + v(t)) = g(t) $$\n利用算子 ${}^{C}D_{0+}^{\\alpha}$ 和 $A$ 的线性性质：\n$$ {}^{C}D_{0+}^{\\alpha}p(t) + {}^{C}D_{0+}^{\\alpha}v(t) + A p(t) + A v(t) = g(t) $$\n一个关键步骤是计算多项式部分 $p(t)$ 的Caputo导数。根据定义 ${}^{C}D_{0+}^{\\alpha} f(t) = I_{0+}^{2-\\alpha} f''(t)$（对于 $\\alpha \\in (1,2)$），我们计算 $p(t) = u_{0} + u_{1} t$ 的二阶导数：\n$$ p'(t) = u_{1} $$\n$$ p''(t) = 0 $$\n因此，$p(t)$ 的Caputo导数为零：\n$$ {}^{C}D_{0+}^{\\alpha}p(t) = I_{0+}^{2-\\alpha} (0) = 0 $$\n这是一个普遍性质：如果导数的阶数 $\\alpha$ 满足 $\\lceil\\alpha\\rceil > k$，则 $k$ 次多项式的Caputo导数为零。此处，$\\lceil\\alpha\\rceil = 2$ 且 $p(t)$ 的次数为 $1$。\n\n将此结果代回，方程变为：\n$$ {}^{C}D_{0+}^{\\alpha}v(t) + A p(t) + A v(t) = g(t) $$\n重新整理，将包含 $v(t)$ 的项分离到左侧，我们得到一个关于 $v(t)$ 的方程：\n$$ {}^{C}D_{0+}^{\\alpha}v(t) + A v(t) = g(t) - A p(t) $$\n这个关于 $v(t)$ 的方程具有齐次初始条件，因此处于应用卷积求积的标准形式。项 $-A p(t)$ 充当一个修正的源项。当在网格点 $t_n = nh$ 上以步长 $h$ 对该方程进行时间离散化时，该项成为每一步需要求解的线性系统右端的一个已知序列。这证明了问题陈述中关于多项式部分 $p(t)$ 产生一个已知修正项的说法是合理的。在时间 $t_n$ 处的修正项恰好是：\n$$ c^n = - A p(t_n) = -A(u_0 + u_1 t_n) = -A(u_0 + u_1 n h) $$\n下一个任务是求出此修正序列 $c^n$ 的生成函数 $C(\\zeta)$。根据定义：\n$$ C(\\zeta) = \\sum_{n=0}^{\\infty} c^n \\zeta^n = \\sum_{n=0}^{\\infty} \\left[ -A(u_0 + u_1 n h) \\right] \\zeta^n $$\n由于 $A$ 是一个有界线性算子，它可以与求和运算交换：\n$$ C(\\zeta) = -A \\left( \\sum_{n=0}^{\\infty} (u_0 + u_1 n h) \\zeta^n \\right) $$\n我们可以将和式分为两部分：\n$$ C(\\zeta) = -A \\left( \\sum_{n=0}^{\\infty} u_0 \\zeta^n + \\sum_{n=0}^{\\infty} u_1 n h \\zeta^n \\right) $$\n$$ C(\\zeta) = -A \\left( u_0 \\sum_{n=0}^{\\infty} \\zeta^n + u_1 h \\sum_{n=0}^{\\infty} n \\zeta^n \\right) $$\n我们现在计算这两个无穷级数，它们都是标准形式，其中 $|\\zeta| < 1$：\n第一个是几何级数：\n$$ \\sum_{n=0}^{\\infty} \\zeta^n = \\frac{1}{1-\\zeta} $$\n第二个级数可以通过对几何级数求导得到：\n$$ \\frac{d}{d\\zeta} \\left( \\sum_{n=0}^{\\infty} \\zeta^n \\right) = \\sum_{n=1}^{\\infty} n \\zeta^{n-1} = \\sum_{n=0}^{\\infty} n \\zeta^{n-1} $$\n$$ \\frac{d}{d\\zeta} \\left( \\frac{1}{1-\\zeta} \\right) = \\frac{1}{(1-\\zeta)^2} $$\n乘以 $\\zeta$ 得到所求的级数：\n$$ \\sum_{n=0}^{\\infty} n \\zeta^n = \\zeta \\sum_{n=0}^{\\infty} n \\zeta^{n-1} = \\frac{\\zeta}{(1-\\zeta)^2} $$\n将这些表达式代回 $C(\\zeta)$ 的方程中：\n$$ C(\\zeta) = -A \\left( u_0 \\frac{1}{1-\\zeta} + u_1 h \\frac{\\zeta}{(1-\\zeta)^2} \\right) $$\n为了得到一个单一的闭式表达式，我们找到公分母 $(1-\\zeta)^2$：\n$$ C(\\zeta) = -A \\left( \\frac{u_0 (1-\\zeta)}{(1-\\zeta)^2} + \\frac{u_1 h \\zeta}{(1-\\zeta)^2} \\right) $$\n$$ C(\\zeta) = -A \\left( \\frac{u_0 - u_0 \\zeta + u_1 h \\zeta}{(1-\\zeta)^2} \\right) $$\n在分子中提取因子 $\\zeta$，得到修正序列生成函数的最终表达式：\n$$ C(\\zeta) = -A \\frac{u_0 + (u_1 h - u_0)\\zeta}{(1-\\zeta)^2} $$\n这个表达式就是用给定参数 $\\zeta$、$h$、$u_0$、$u_1$ 和算子 $A$ 表示的 $C(\\zeta)$ 的闭式形式。", "answer": "$$\n\\boxed{-A \\frac{u_{0} + (u_{1} h - u_{0})\\zeta}{(1-\\zeta)^{2}}}\n$$", "id": "3368432"}, {"introduction": "在实现一种数值格式后，一个关键步骤是分析其精度。本练习深入探讨了两种常用方法的局部截断误差分析，揭示了分数阶导数的非局域性以及解在初始时刻附近的典型行为如何影响收敛性。理解这些误差结构，正如本题所探讨的，对于诊断性能问题和正确解释数值结果至关重要。[@problem_id:3368459]", "problem": "考虑在偏微分方程(PDE)的数值解中，对$\\,\\alpha\\in(0,1)\\,$阶的时间分数阶卡普托(Caputo)导数的逼近。对于一个充分光滑的函数$\\,u(t)\\,$，其卡普托导数定义为\n$$\n{}^{C}D_{t}^{\\alpha} u(t) \\;=\\; \\frac{1}{\\Gamma(1-\\alpha)} \\int_{0}^{t} (t-\\tau)^{-\\alpha}\\, u'(\\tau)\\, \\mathrm{d}\\tau,\n$$\n其中$\\,\\Gamma(\\cdot)\\,$是伽马(Gamma)函数。假设时间网格是均匀的$\\,t_{n}=nh\\,$，其中$\\,h>0\\,$且$\\,n\\ge 1\\,$为整数。逼近$\\,{}^{C}D_{t}^{\\alpha} u(t_{n})\\,$的两种广泛使用的离散算子是：\n- 后向Grünwald–Letnikov分数阶差分，其权重为二项式系数$\\,(-1)^{k}\\binom{\\alpha}{k}\\,$；\n- 由梯形法则生成的Lubich卷积求积，其符号基于有理逼近$\\,\\delta(\\zeta) = \\frac{2(1-\\zeta)}{1+\\zeta}\\,$.\n\n对于测试函数$\\,u(t)=t^{\\mu}\\,$，其中$\\,\\mu>0\\,$使得$\\,u(0)=0\\,$，因此有$\\,{}^{C}D_{t}^{\\alpha} u(t)={}^\\mathrm{RL}D_{t}^{\\alpha} u(t)\\,$。当$\\,h\\to 0\\,$时，确定每种方法在$\\,t_{n}\\,$处的主阶局部截断误差。也就是说，找到常数$\\,c_{\\mathrm{GL}}(\\alpha,\\mu)\\,$和$\\,c_{\\mathrm{CQ}}(\\alpha,\\mu)\\,$，使得\n$$\n\\mathcal{E}_{\\mathrm{GL}}(t_{n};h) \\;=\\; c_{\\mathrm{GL}}(\\alpha,\\mu)\\, h\\, t_{n}^{\\mu-\\alpha-1} \\;+\\; \\mathcal{O}\\!\\left(h^{2}\\, t_{n}^{\\mu-\\alpha-2}\\right),\n$$\n和\n$$\n\\mathcal{E}_{\\mathrm{CQ}}(t_{n};h) \\;=\\; c_{\\mathrm{CQ}}(\\alpha,\\mu)\\, h^{2}\\, t_{n}^{\\mu-\\alpha-2} \\;+\\; \\mathcal{O}\\!\\left(h^{3}\\, t_{n}^{\\mu-\\alpha-3}\\right),\n$$\n在正则性条件$\\,\\mu>\\alpha\\,$（对于Grünwald–Letnikov逼近）和$\\,\\mu>\\alpha+1\\,$（对于梯形法则卷积求积）下成立。用$\\,\\Gamma(\\cdot)\\,$以闭合形式表示$\\,c_{\\mathrm{GL}}(\\alpha,\\mu)\\,$和$\\,c_{\\mathrm{CQ}}(\\alpha,\\mu)\\,$。\n\n此外，定性解释这些主项中$\\,t_{n}\\,$的指数如何反映每种方法对$\\,t=0\\,$附近初始数据正则性的敏感度，以及这对分数阶PDE求解器中的时间步长选择或修正策略有何影响。\n\n将你的最终答案以单行矩阵的形式给出，包含$\\,c_{\\mathrm{GL}}(\\alpha,\\mu)\\,$和$\\,c_{\\mathrm{CQ}}(\\alpha,\\mu)\\,$，不带单位。无需进行数值四舍五入。", "solution": "该问题陈述具有科学依据，是适定的、客观的。它提出了分数阶微分方程数值分析中的一个标准任务。所提供的定义、方法和条件都是标准的且一致的。因此，该问题是有效的，下面给出解答。\n\n对于连续算子${}^{C}D_{t}^{\\alpha}$的一个数值逼近$D_h^\\alpha$，其局部截断误差定义为$\\mathcal{E}(t_n;h) = D_h^\\alpha u(t_n) - {}^{C}D_{t}^{\\alpha} u(t_n)$。我们针对测试函数$u(t) = t^{\\mu}$（其中$\\mu>0$）来分析这两种指定的方法。\n\n首先，我们确定精确的导数。由于当$\\mu > 0$时$u(0) = 0$，卡普托(Caputo)导数${}^{C}D_{t}^{\\alpha} u(t)$等价于黎曼-刘维尔(Riemann-Liouville, RL)导数${}^\\mathrm{RL}D_{t}^{\\alpha} u(t)$。RL导数作用于幂函数的标准公式是\n$$\n{}^{C}D_{t}^{\\alpha} u(t) = {}^\\mathrm{RL}D_{t}^{\\alpha} t^{\\mu} = \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+1-\\alpha)} t^{\\mu-\\alpha}\n$$\n此公式在$\\mu > -1$时有效，这已由条件$\\mu>0$满足。\n\n接下来，我们通过检查相应离散算子在拉普拉斯(Laplace)域（变量为$s$）中的符号，并将其与精确分数阶导数算子$D_t^\\alpha$的符号$s^\\alpha$进行比较，来分析每种数值方法。误差算子是离散算子与连续算子之差。\n\n**1. 后向Grünwald–Letnikov (GL)逼近**\n\n后向GL算子通过其在时间网格上的作用来定义，可以用后向移位算子$B$（其中$B u(t_n) = u(t_{n-1})$）表示：\n$$\nD_{h,\\mathrm{GL}}^\\alpha u(t_n) = h^{-\\alpha} \\sum_{k=0}^{n} (-1)^k \\binom{\\alpha}{k} u(t_{n-k}) = h^{-\\alpha} (1-B)^\\alpha u(t_n)\n$$\n在拉普拉斯域中，移位算子$B$对应于乘以$e^{-sh}$。因此，GL算子的符号是\n$$\n\\sigma_{\\mathrm{GL}}(s) = \\left(\\frac{1-e^{-sh}}{h}\\right)^{\\alpha}\n$$\n为了找到主阶误差，我们对小$s$（对应于时间上的缓慢变化或长波长）展开此符号：\n$$\ne^{-sh} = 1 - sh + \\frac{(sh)^2}{2} - \\frac{(sh)^3}{6} + \\mathcal{O}((sh)^4)\n$$\n将此代入符号表达式中，得到\n$$\n\\frac{1-e^{-sh}}{h} = \\frac{1 - \\left(1 - sh + \\frac{1}{2}s^2h^2 - \\dots\\right)}{h} = s - \\frac{1}{2} s^2 h + \\mathcal{O}(h^2)\n$$\n现在，我们使用广义二项式定理$(1+x)^a = 1 + ax + \\mathcal{O}(x^2)$将上式升至$\\alpha$次幂：\n$$\n\\sigma_{\\mathrm{GL}}(s) = \\left(s - \\frac{1}{2} s^2 h + \\mathcal{O}(h^2)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{1}{2} s h + \\mathcal{O}(h^2)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{\\alpha}{2} s h + \\mathcal{O}(h^2)\\right) = s^\\alpha - \\frac{\\alpha h}{2} s^{\\alpha+1} + \\mathcal{O}(h^2)\n$$\n误差算子的符号是$\\sigma_{\\mathrm{GL}}(s) - s^\\alpha = -\\frac{\\alpha h}{2} s^{\\alpha+1} + \\mathcal{O}(h^2)$。\n这意味着误差算子的主项是$-\\frac{\\alpha h}{2} D_t^{\\alpha+1}$。将此算子应用于测试函数$u(t) = t^\\mu$，得到局部截断误差的主项：\n$$\n\\mathcal{E}_{\\mathrm{GL}}(t_n;h) \\approx -\\frac{\\alpha h}{2} {}^\\mathrm{RL}D_{t}^{\\alpha+1} t^{\\mu} \\Big|_{t=t_n}\n$$\n使用RL导数作用于幂函数的公式：\n$$\n\\mathcal{E}_{\\mathrm{GL}}(t_n;h) \\approx -\\frac{\\alpha h}{2} \\left( \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+1-(\\alpha+1))} t^{\\mu-(\\alpha+1)} \\right) \\Big|_{t=t_n} = -\\frac{\\alpha h}{2} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha)} t_n^{\\mu-\\alpha-1}\n$$\n此表达式在条件$\\mu > \\alpha$下有效，保证了分母中伽马函数的宗量不是非正整数。\n将其与给定形式$\\mathcal{E}_{\\mathrm{GL}}(t_{n};h) = c_{\\mathrm{GL}}(\\alpha,\\mu)\\, h\\, t_{n}^{\\mu-\\alpha-1} + \\dots$进行比较，我们确定常数为\n$$\nc_{\\mathrm{GL}}(\\alpha,\\mu) = -\\frac{\\alpha}{2} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha)}\n$$\n\n**2. 使用梯形法则的Lubich卷积求积(CQ)**\n\n此逼近的符号由$(\\delta(e^{-sh})/h)^\\alpha$给出，其中$\\delta(\\zeta) = \\frac{2(1-\\zeta)}{1+\\zeta}$。因此，算子符号为\n$$\n\\sigma_{\\mathrm{CQ}}(s) = \\left(\\frac{1}{h} \\frac{2(1-e^{-sh})}{1+e^{-sh}}\\right)^{\\alpha}\n$$\n我们可以使用双曲函数来简化该分数：\n$$\n\\frac{1-e^{-sh}}{1+e^{-sh}} = \\frac{e^{sh/2}-e^{-sh/2}}{e^{sh/2}+e^{-sh/2}} = \\tanh\\left(\\frac{sh}{2}\\right)\n$$\n符号变为\n$$\n\\sigma_{\\mathrm{CQ}}(s) = \\left(\\frac{2}{h} \\tanh\\left(\\frac{sh}{2}\\right)\\right)^{\\alpha}\n$$\n我们对小$z$展开$\\tanh(z)$：$\\tanh(z) = z - \\frac{z^3}{3} + \\mathcal{O}(z^5)$。令$z=sh/2$，我们得到\n$$\n\\frac{2}{h} \\tanh\\left(\\frac{sh}{2}\\right) = \\frac{2}{h} \\left( \\frac{sh}{2} - \\frac{1}{3}\\left(\\frac{sh}{2}\\right)^3 + \\mathcal{O}(h^5) \\right) = s - \\frac{s^3 h^2}{12} + \\mathcal{O}(h^4)\n$$\n将此升至$\\alpha$次幂：\n$$\n\\sigma_{\\mathrm{CQ}}(s) = \\left(s - \\frac{s^3 h^2}{12} + \\mathcal{O}(h^4)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{s^2 h^2}{12} + \\mathcal{O}(h^4)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{\\alpha s^2 h^2}{12} + \\mathcal{O}(h^4)\\right) = s^\\alpha - \\frac{\\alpha h^2}{12} s^{\\alpha+2} + \\mathcal{O}(h^4)\n$$\n误差算子的符号是$\\sigma_{\\mathrm{CQ}}(s) - s^\\alpha = -\\frac{\\alpha h^2}{12} s^{\\alpha+2} + \\mathcal{O}(h^4)$。\n因此，误差算子的主项是$-\\frac{\\alpha h^2}{12} D_t^{\\alpha+2}$。将其应用于$u(t) = t^\\mu$：\n$$\n\\mathcal{E}_{\\mathrm{CQ}}(t_n;h) \\approx -\\frac{\\alpha h^2}{12} {}^\\mathrm{RL}D_{t}^{\\alpha+2} t^{\\mu} \\Big|_{t=t_n} = -\\frac{\\alpha h^2}{12} \\left( \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+1-(\\alpha+2))} t^{\\mu-(\\alpha+2)} \\right) \\Big|_{t=t_n} = -\\frac{\\alpha h^2}{12} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha-1)} t_n^{\\mu-\\alpha-2}\n$$\n这在$\\mu > \\alpha+1$时有效。将其与给定形式$\\mathcal{E}_{\\mathrm{CQ}}(t_{n};h) = c_{\\mathrm{CQ}}(\\alpha,\\mu)\\, h^{2}\\, t_{n}^{\\mu-\\alpha-2} + \\dots$进行比较，我们发现\n$$\nc_{\\mathrm{CQ}}(\\alpha,\\mu) = -\\frac{\\alpha}{12} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha-1)}\n$$\n\n**定性解释**\n\n主阶局部截断误差分别为$\\mathcal{E}_{\\mathrm{GL}} \\propto h t_n^{\\mu-\\alpha-1}$和$\\mathcal{E}_{\\mathrm{CQ}} \\propto h^2 t_n^{\\mu-\\alpha-2}$。每一项中$t_n$的指数为误差行为提供了关键的洞察。\n\n**对初始正则性的敏感度：** $u(t)=t^\\mu$中的参数$\\mu$表征了函数在$t=0$处的正则性（光滑度）。$t_n$的指数分别是GL方法的$\\mu-\\alpha-1$和CQ方法的$\\mu-\\alpha-2$。\n对于分数阶PDE的典型解，解的正则性$\\mu$与分数阶$\\alpha$相关。一种常见情况是$\\mu \\approx \\alpha$，这模拟了初始时刻的弱奇异性。\n在GL方法的正则性要求$\\mu > \\alpha$下，指数$\\mu-\\alpha-1$可以为负（例如，如果$\\alpha < \\mu < \\alpha+1$）。类似地，对于CQ方法，要求$\\mu > \\alpha+1$允许指数$\\mu-\\alpha-2$为负（例如，如果$\\alpha+1 < \\mu < \\alpha+2$）。\n负指数$t_n^\\beta$（其中$\\beta < 0$）意味着局部截断误差在$t=0$附近（即$n$较小时）最大，并随着$t_n$的增加而衰减。这表明两种方法都对时间区间开始处解的低正则性高度敏感。CQ方法的误差项包含$t_n^{\\mu-\\alpha-2}$，其衰减速度比GL误差快一个$t_n$的幂次，但在$t=0$处也具有更强的奇异性。尽管CQ在$h$上形式上是二阶的，但这种巨大的初始误差可能会污染全局解，从而可能抵消其在均匀时间步长下高阶精度的优势。\n\n**对时间步进的影响：** 局部截断误差在$t \\to 0$时趋于无界的性质表明，均匀时间步长$h$并非最优。在最初几个步长中产生的巨大误差可能会主导全局误差。为了保持精度，在$t=0$附近需要比之后的时间点小得多的时间步长。这推动了高级分数阶PDE求解器中的两种主要策略：\n$1$. **分级网格(Graded Meshes)：** 时间网格在$t=0$附近被加密。一个常见的选择是幂律网格，$t_k = T(k/N)^r$，其中$k=1, \\dots, N$，$r \\ge 1$是分级指数，其选择旨在平衡整个区间的误差。更高的分级指数$r$导致在$t=0$附近更密集的加密。\n$2$. **起始修正(Starting Corrections)：** 在最初的几个时间步中使用一种特殊的、更高阶的数值方法来精确地解析初始奇异性。在这个初始阶段之后，求解器切换回计算成本较低的主格式（如GL或CQ）来完成剩余的模拟，因为此时解已变得更加光滑。\n\n总之，误差项中$t_n$的指数是分数阶导数的非局部性和解在$t=0$处典型奇异行为所带来挑战的直接数学体现。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\alpha}{2} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha)} & -\\frac{\\alpha}{12} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha-1)} \\end{pmatrix}}\n$$", "id": "3368459"}, {"introduction": "前面的分析强调了初始解的奇异性会降低标准数值方法在均匀网格上的精度。这个高级练习从分析转向设计，要求您开发一个解决方案：一个非均匀的“分级”网格。通过推导最优的网格分级参数 $\\gamma$，您将学习如何根据解的行为策略性地调整离散化，从而恢复理论收敛阶，构建一个高精度且高效的数值求解器。[@problem_id:3368445]", "problem": "考虑时间分数阶扩散型初值问题\n$$\n{}^C D_{t}^{\\beta} u(t) + \\mathcal{A} u(t) = f(t), \\quad t \\in (0,T], \\qquad u(0)=u_0,\n$$\n其中 $0 < \\beta < 1$，${}^C D_{t}^{\\beta}$ 表示 Caputo 分数阶导数，$\\mathcal{A}$ 是一个扇形空间算子，使得解 $u$ 是唯一确定且连续依赖于数据的。回顾阶为 $\\beta$ 的 Caputo 导数定义为\n$$\n{}^C D_{t}^{\\beta} u(t) := \\frac{1}{\\Gamma(1-\\beta)} \\int_{0}^{t} (t-s)^{-\\beta} u'(s)\\,ds,\n$$\n它可以表示为 Riemann–Liouville 分数阶积分（阶为 $1-\\beta$）的形式，即 ${}^C D_{t}^{\\beta} u = I^{1-\\beta} u'$，其中\n$$\nI^{\\nu}v(t) := \\frac{1}{\\Gamma(\\nu)}\\int_{0}^{t} (t-s)^{\\nu-1} v(s)\\,ds, \\quad \\nu>0.\n$$\n假设精确解在初始时刻表现出如下形式的奇异性\n$$\nu(t) = u_0 + c\\, t^{\\alpha} + \\text{higher-order terms as } t \\downarrow 0,\n$$\n其中 $c \\neq 0$ 和 $\\alpha \\in (0,1]$ 为常数。考虑在一个分级时间网格 $0=t_0 < t_1 < \\dots < t_N = T$ 上对该问题进行离散化，网格点由 $t_n = T(n/N)^{\\gamma}$ 定义，其中 $\\gamma \\ge 1$ 是分级参数。一个常见的离散化方法（如L1格式的变体）通过对精确解的分段线性插值函数求 Caputo 导数来近似该导数。这种方法的相容性误差有两个主要来源：(1) 由格式对光滑解的固有近似精度所产生的局部误差，其在分级网格上的收敛阶为 $O(N^{-(2-\\beta)})$；(2) 由 $t=0$ 附近初始奇异性引起的全局误差，其大小由第一个时间步 $t_1$ 的长度决定。\n\n您的任务是通过平衡这两种误差来源来推导最小的分级参数 $\\gamma$。具体来说，求出 $\\gamma$ 的表达式，使得由初始奇异性 $u(t) \\sim t^{\\alpha}$ 产生的全局误差贡献，其关于时间步总数 $N$ 的收敛阶，与格式的局部相容性误差阶 $O(N^{-(2-\\beta)})$ 相匹配。您的最终答案应为一个用 $\\alpha$ 和 $\\beta$ 表示的 $\\gamma$ 的单个解析表达式。", "solution": "该问题要求推导用于求解时间分数阶扩散方程的时间网格的最小分级参数 $\\gamma$。推导必须基于一个平衡两种误差来源的一致性分析：局部近似误差和由初始奇异性引起的全局误差。\n\n设时间离散化在时刻 $t_n$ 的相容性误差为 $\\mathcal{T}_n$。该格式通过在分级网格上对精确解 $u$ 进行分段线性插值（我们记为 $\\Pi_1 u$）并求其 Caputo 导数，来近似精确解的 Caputo 导数 ${}^C D_{t}^{\\beta}u(t_n)$。因此，误差为：\n$$\n\\mathcal{T}_n = {}^C D_{t}^{\\beta}u(t_n) - {}^C D_{t}^{\\beta}(\\Pi_1 u)(t_n)\n$$\n使用 Caputo 分数阶导数的定义 ${}^C D_{t}^{\\beta} v = I^{1-\\beta} v'$，我们可以将误差写为：\n$$\n\\mathcal{T}_n = \\frac{1}{\\Gamma(1-\\beta)} \\int_{0}^{t_n} (t_n-s)^{-\\beta} \\left( u'(s) - (\\Pi_1 u)'(s) \\right) ds\n$$\n$(\\Pi_1 u)'(s)$ 项是分段线性插值函数的导数。在任何给定的子区间 $[t_{k-1}, t_k]$ 上，它是一个常数，等于割线的斜率：\n$$\n(\\Pi_1 u)'(s) = \\frac{u(t_k) - u(t_{k-1})}{t_k - t_{k-1}} \\quad \\text{for } s \\in (t_{k-1}, t_k)\n$$\n我们可以将 $\\mathcal{T}_n$ 的积分分解为对时间步长的求和：\n$$\n\\mathcal{T}_n = \\sum_{k=1}^{n} \\frac{1}{\\Gamma(1-\\beta)} \\int_{t_{k-1}}^{t_k} (t_n-s)^{-\\beta} \\left( u'(s) - \\frac{u(t_k) - u(t_{k-1})}{t_k - t_{k-1}} \\right) ds\n$$\n总相容性误差 $\\mathcal{T}_n$ 可以理解为源于问题陈述中概述的两个不同贡献。我们分析每个贡献相对于时间步数 $N$ 的标度。\n\n1.  **局部相容性误差的主阶标度。**\n\n这个贡献来自于最近一个时间步 $[t_{n-1}, t_n]$ 上的近似误差。它反映了该格式对于光滑解的精度。令 $\\tau_n = t_n - t_{n-1}$。对于一个足够光滑的函数 $u(t)$（具体来说，$u \\in C^2([t_{n-1}, t_n])$），用区间 $[t_{n-1}, t_n]$ 上的常数割线斜率来近似导数 $u'(s)$ 的误差是 $O(\\tau_n)$。对通过分段线性插值近似 Caputo 导数积分形式的更详细分析表明，局部截断误差的标度为 $O(\\tau_n^{2-\\beta})$。\n\n分级网格由 $t_n = T(n/N)^\\gamma$ 定义。时间步长为 $\\tau_n = t_n - t_{n-1} = T N^{-\\gamma} (n^\\gamma - (n-1)^\\gamma)$。对于大的 $n$，例如 $n \\approx N$，我们可以使用中值定理来近似：$n^\\gamma - (n-1)^\\gamma \\approx \\gamma n^{\\gamma-1}$。因此，在固定时间 $t_n=t$ 处，其中 $n = N(t/T)^{1/\\gamma}$，时间步长为：\n$$\n\\tau_n \\approx T N^{-\\gamma} \\gamma \\left(N(t/T)^{1/\\gamma}\\right)^{\\gamma-1} = T N^{-\\gamma} \\gamma N^{\\gamma-1} (t/T)^{1 - 1/\\gamma} = \\frac{T\\gamma}{N} \\left(\\frac{t}{T}\\right)^{1 - 1/\\gamma}\n$$\n这表明对于任何固定时间 $t \\in (0, T]$，局部时间步长 $\\tau_n$ 为 $O(N^{-1})$ 阶。因此，标度为 $O(\\tau_n^{2-\\beta})$ 的局部相容性误差具有以下关于 $N$ 的标度：\n$$\n\\text{Error (Local)} \\sim O\\left( (N^{-1})^{2-\\beta} \\right) = O\\left(N^{-(2-\\beta)}\\right)\n$$\n这是光滑解所期望的收敛阶。\n\n2.  **由初始奇异性引起的全局误差的主阶标度。**\n\n这个贡献来自于插值误差的累积，特别是来自 $t=0$ 附近区域的误差，在该区域解表现出 $u(t) = u_0 + c t^\\alpha + O(t^{>\\alpha})$ 形式的奇异性，其中 $\\alpha \\in (0,1]$。这种非光滑行为在均匀网格上用线性插值很难精确捕捉。带有在 $t=0$ 附近加密步长的分级网格，就是为了缓解这个问题而设计的。\n\n这个全局误差的主要部分源于第一个时间步 $[t_0, t_1] = [0, t_1]$。这个区间的长度是 $t_1 = T(1/N)^\\gamma = T N^{-\\gamma}$。在这个区间上，函数 $u(t) - u_0 \\approx c t^\\alpha$ 与其线性插值函数 $(\\Pi_1 u)(t) - u_0 = \\frac{u(t_1)-u(t_0)}{t_1}t \\approx c t_1^{\\alpha-1} t$ 有显著差异。在 $[0, t_1]$ 上，函数与其线性插值函数之间的最大差值与函数在该区间上的总变差成正比，其标度为 $t_1^\\alpha$。\n$$\n\\max_{s \\in [0, t_1]} | (u(s)-u_0) - ((\\Pi_1 u)(s)-u_0) | \\sim O(t_1^\\alpha)\n$$\n代入 $t_1 = T N^{-\\gamma}$，在第一个时间步中产生的插值误差的量级为：\n$$\nO\\left( (N^{-\\gamma})^\\alpha \\right) = O\\left(N^{-\\gamma\\alpha}\\right)\n$$\n这个初始的大误差随后被分数阶导数核 $(t_n-s)^{-\\beta}$ 的长程记忆性向前传播。虽然核的影响随时间减弱，但由 $t=0$ 附近的网格分级决定的初始误差大小，决定了这个全局误差贡献的标度。因此，源于初始奇异性的误差的主阶标度为：\n$$\n\\text{Error (Global/Singularity)} \\sim O\\left(N^{-\\gamma\\alpha}\\right)\n$$\n\n**平衡误差贡献。**\n\nL1 型格式的整体时间相容性误差由这两个误差源中较大者主导。因此，总误差标度为：\n$$\n\\mathcal{T}_{total} \\sim O\\left(N^{-(2-\\beta)}\\right) + O\\left(N^{-\\gamma\\alpha}\\right)\n$$\n为了恢复 $2-\\beta$ 的设计收敛阶（这是该格式可能达到的最优阶），来自奇异性的误差贡献不能成为瓶颈。这要求奇异性误差的衰减速度至少与局部误差一样快。用指数来表示，这意味着：\n$$\n\\gamma\\alpha \\ge 2-\\beta\n$$\n问题要求能够达到此条件的最小分级参数 $\\gamma$。最小值对应于两种误差贡献相平衡的情况，这确保了网格的加密程度刚好足以处理奇异性，而又不会过分加密导致计算效率低下。当指数相等时，达到这种平衡：\n$$\n\\gamma\\alpha = 2-\\beta\n$$\n解出最小分级参数 $\\gamma$，我们得到显式表达式：\n$$\n\\gamma = \\frac{2-\\beta}{\\alpha}\n$$\n$\\gamma$ 的这一选择确保了来自初始奇异性的误差贡献与格式固有的局部误差相匹配，从而恢复了 $2-\\beta$ 的最优收敛阶。", "answer": "$$\n\\rule{0pt}{2em}\n\\boxed{\\frac{2-\\beta}{\\alpha}}\n$$", "id": "3368445"}]}