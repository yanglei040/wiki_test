{"hands_on_practices": [{"introduction": "理论学习了隐式格式的优点，但其真正的价值在与显式格式的对比中才更加凸显。本练习将通过冯·诺依曼稳定性分析，探讨一种结合了显式处理对流项和隐式处理扩散项的混合（IMEX）格式。通过推导其稳定性条件[@problem_id:3406598]，你将亲身体会到为何对于包含刚性项（如扩散）的方程，隐式处理是维持计算稳定性的关键。", "problem": "考虑线性对流-扩散方程 $u_{t} + a u_{x} = \\nu u_{xx}$，其中 $u(x,t)$ 是周期性空间域 $x \\in [0,L]$ 上的一个标量场，对流速度 $a \\in \\mathbb{R}$ 和扩散系数 $\\nu \\ge 0$ 为常数。设空间网格为均匀网格，间距为 $h = L/N$，网格点为 $x_{j} = jh$（$j$ 为整数），并考虑离散时间层 $t^{n} = n\\,\\Delta t$。定义二阶中心有限差分算子：\n- 一阶导数 $D_{0}u_{j}^{n} = \\dfrac{u_{j+1}^{n} - u_{j-1}^{n}}{2h}$，\n- 二阶导数 $D_{2}u_{j}^{n} = \\dfrac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{h^{2}}$。\n研究隐式-显式 (IMEX) 时间离散，该方法通过前向欧拉法显式处理对流项，通过后向欧拉法隐式处理扩散项：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,D_{0}u_{j}^{n} \\;=\\; \\nu\\,D_{2}u_{j}^{n+1}.\n$$\n假设空间周期性，并通过代入单个傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i j \\theta)$ 进行 von Neumann 傅里叶分析，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数。引入无量纲对流库朗数 $c = \\dfrac{a\\,\\Delta t}{h}$ 和扩散数 $r = \\dfrac{\\nu\\,\\Delta t}{h^{2}}$。推导以闭式形式表示的放大因子 $G_{\\text{IMEX}}(\\theta)$，其定义为 $\\hat{u}^{n+1} = G_{\\text{IMEX}}(\\theta)\\,\\hat{u}^{n}$。然后，通过施加 von Neumann 稳定性条件 $|G_{\\text{IMEX}}(\\theta)| \\le 1$（对于所有 $\\theta \\in [-\\pi,\\pi]$），确定保证所有傅里叶模稳定的最小非负扩散数 $r$，作为 $c$ 的函数。与在上述 IMEX 方法中设置 $a = 0$ 得到的纯隐式扩散格式进行定性比较。\n\n请提供最小扩散数作为 $c$ 的函数 $r_{\\min}(c)$ 的精确闭式表达式作为最终答案。无需数值近似，最终答案中不报告单位。", "solution": "该问题要求分析线性对流-扩散方程的隐式-显式 (IMEX) 时间离散格式。分析将分三步进行：首先，使用 von Neumann 分析推导放大因子；其次，确定稳定性条件和最小扩散数 $r_{\\min}(c)$；第三，与纯隐式格式进行定性比较。\n\n一维对流-扩散方程由下式给出：\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx}\n$$\n其中 $u(x,t)$ 是标量场，$a$ 是对流速度，$\\nu$ 是扩散系数。空间域是周期性的。\n\n该问题定义了在空间上使用二阶中心有限差分进行半离散化。IMEX 时间步进格式使用前向欧拉法显式处理对流项，使用后向欧拉法隐式处理扩散项：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,D_{0}u_{j}^{n} = \\nu\\,D_{2}u_{j}^{n+1}\n$$\n此处，$u_j^n \\approx u(x_j, t^n)$，$\\Delta t$ 是时间步长，差分算子定义为 $D_{0}u_{j}^{n} = \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2h}$ 和 $D_{2}u_{j}^{n} = \\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{h^{2}}$。\n\n为了进行 von Neumann 稳定性分析，我们将单个傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i j \\theta)$ 代入格式中，其中 $\\theta = k h$ 是波数 $k$ 对应的无量纲波数。放大因子由关系式 $\\hat{u}^{n+1} = G_{\\text{IMEX}}(\\theta)\\,\\hat{u}^{n}$ 定义。\n\n首先，我们找出差分算子作用于该模的傅里叶表示：\n$$\nD_{0}u_{j}^{n} = \\frac{\\hat{u}^{n}\\exp(i(j+1)\\theta) - \\hat{u}^{n}\\exp(i(j-1)\\theta)}{2h} = \\frac{\\hat{u}^{n}\\exp(ij\\theta)}{2h}(\\exp(i\\theta) - \\exp(-i\\theta)) = \\frac{2i\\sin(\\theta)}{2h}\\hat{u}^{n}\\exp(ij\\theta) = \\frac{i\\sin(\\theta)}{h}u_{j}^{n}\n$$\n$$\nD_{2}u_{j}^{n+1} = \\frac{\\hat{u}^{n+1}\\exp(i(j+1)\\theta) - 2\\hat{u}^{n+1}\\exp(ij\\theta) + \\hat{u}^{n+1}\\exp(i(j-1)\\theta)}{h^2} = \\frac{\\hat{u}^{n+1}\\exp(ij\\theta)}{h^2}(\\exp(i\\theta) - 2 + \\exp(-i\\theta))\n$$\n使用恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，这可简化为：\n$$\nD_{2}u_{j}^{n+1} = \\frac{2\\cos(\\theta) - 2}{h^2}\\hat{u}^{n+1}\\exp(ij\\theta) = \\frac{-2(1-\\cos(\\theta))}{h^2}u_{j}^{n+1}\n$$\n使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\nD_{2}u_{j}^{n+1} = \\frac{-4\\sin^2(\\theta/2)}{h^2}u_{j}^{n+1}\n$$\n将这些表达式代入 IMEX 格式并消去公因子 $\\exp(ij\\theta)$：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n}}{\\Delta t} + a\\left(\\frac{i\\sin(\\theta)}{h}\\right)\\hat{u}^{n} = \\nu\\left(\\frac{-4\\sin^2(\\theta/2)}{h^2}\\right)\\hat{u}^{n+1}\n$$\n重新整理各项，将 $\\hat{u}^{n+1}$ 和 $\\hat{u}^{n}$ 分组：\n$$\n\\hat{u}^{n+1}\\left(\\frac{1}{\\Delta t} + \\nu\\frac{4\\sin^2(\\theta/2)}{h^2}\\right) = \\hat{u}^{n}\\left(\\frac{1}{\\Delta t} - a\\frac{i\\sin(\\theta)}{h}\\right)\n$$\n将整个方程乘以 $\\Delta t$：\n$$\n\\hat{u}^{n+1}\\left(1 + \\frac{4\\nu\\Delta t}{h^2}\\sin^2(\\theta/2)\\right) = \\hat{u}^{n}\\left(1 - i\\frac{a\\Delta t}{h}\\sin(\\theta)\\right)\n$$\n引入无量纲库朗数 $c = \\frac{a\\Delta t}{h}$ 和扩散数 $r = \\frac{\\nu\\Delta t}{h^2}$：\n$$\n\\hat{u}^{n+1}\\left(1 + 4r\\sin^2(\\theta/2)\\right) = \\hat{u}^{n}(1 - ic\\sin(\\theta))\n$$\n因此，放大因子 $G_{\\text{IMEX}}(\\theta) = \\hat{u}^{n+1}/\\hat{u}^{n}$ 为：\n$$\nG_{\\text{IMEX}}(\\theta) = \\frac{1 - ic\\sin(\\theta)}{1 + 4r\\sin^2(\\theta/2)}\n$$\nvon Neumann 稳定性条件要求对于所有 $\\theta \\in [-\\pi, \\pi]$ 成立 $|G_{\\text{IMEX}}(\\theta)| \\le 1$。我们分析其模的平方：\n$$\n|G_{\\text{IMEX}}(\\theta)|^2 = \\frac{|1 - ic\\sin(\\theta)|^2}{|1 + 4r\\sin^2(\\theta/2)|^2} = \\frac{1^2 + (-c\\sin(\\theta))^2}{(1 + 4r\\sin^2(\\theta/2))^2} = \\frac{1 + c^2\\sin^2(\\theta)}{(1 + 4r\\sin^2(\\theta/2))^2}\n$$\n稳定性条件变为：\n$$\n\\frac{1 + c^2\\sin^2(\\theta)}{(1 + 4r\\sin^2(\\theta/2))^2} \\le 1\n$$\n由于分母是实数且为正（对于 $r \\ge 0$），我们可以两边同乘得到：\n$$\n1 + c^2\\sin^2(\\theta) \\le \\left(1 + 4r\\sin^2(\\theta/2)\\right)^2 = 1 + 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\n两边减去 $1$ 得到：\n$$\nc^2\\sin^2(\\theta) \\le 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\n使用倍角恒等式 $\\sin(\\theta) = 2\\sin(\\theta/2)\\cos(\\theta/2)$：\n$$\nc^2\\left(4\\sin^2(\\theta/2)\\cos^2(\\theta/2)\\right) \\le 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\n如果 $\\sin(\\theta/2) = 0$ （即 $\\theta=0$），不等式为 $0 \\le 0$，恒成立。对于 $\\sin(\\theta/2) \\neq 0$，我们可以除以正量 $4\\sin^2(\\theta/2)$：\n$$\nc^2\\cos^2(\\theta/2) \\le 2r + 4r^2\\sin^2(\\theta/2)\n$$\n为了找到对 $r$ 最严格的条件，令 $S = \\sin^2(\\theta/2)$。当 $\\theta$ 的范围是 $[-\\pi, \\pi]$ 时，$S$ 的范围是 $[0, 1]$。使用 $\\cos^2(\\theta/2) = 1 - S$，不等式变为：\n$$\nc^2(1 - S) \\le 2r + 4r^2S\n$$\n该不等式必须对所有 $S \\in [0, 1]$ 成立。我们重新整理各项以分离出 $S$：\n$$\nc^2 - 2r \\le c^2S + 4r^2S = (c^2 + 4r^2)S\n$$\n我们定义一个函数 $F(S) = (c^2 + 4r^2)S - (c^2 - 2r)$。我们需要对所有 $S \\in [0, 1]$，$F(S) \\ge 0$。$S$ 的系数 $m = c^2 + 4r^2$ 是这个关于 $S$ 的线性函数的斜率。由于 $r \\ge 0$，斜率 $m$ 始终是非负的。\n对于一个区间上的非递减线性函数，其最小值在区间的左端点处取得。因此，为确保对所有 $S \\in [0, 1]$ 成立 $F(S) \\ge 0$，我们只需在 $S=0$ 处施加该条件：\n$$\nF(0) \\ge 0 \\implies (c^2+4r^2)(0) - (c^2 - 2r) \\ge 0\n$$\n$$\n-(c^2 - 2r) \\ge 0 \\implies 2r - c^2 \\ge 0\n$$\n这给出了稳定性条件：\n$$\nr \\ge \\frac{c^2}{2}\n$$\n因此，对于任意给定的库朗数 $c$，保证稳定的最小非负扩散数 $r$ 为 $r_{\\min}(c) = \\frac{c^2}{2}$。\n\n为了进行定性比较，考虑纯隐式扩散格式，这对应于在 IMEX 方法中设置 $a=0$。如果 $a=0$，则库朗数 $c=0$。放大因子变为：\n$$\nG_{\\text{diffusion}}(\\theta) = G_{\\text{IMEX}}(\\theta)|_{c=0} = \\frac{1}{1 + 4r\\sin^2(\\theta/2)}\n$$\n由于 $r \\ge 0$ 且 $\\sin^2(\\theta/2) \\ge 0$，分母总是大于等于 $1$。因此，对于所有 $\\theta$ 和任意 $r \\ge 0$， $|G_{\\text{diffusion}}(\\theta)| \\le 1$。这意味着扩散方程的纯隐式离散格式（向后时间中心空间，BTCS）是无条件稳定的。\n\n相比之下，IMEX 格式只是条件稳定的。对流项的显式处理引入了不稳定的可能性。在傅里叶空间中，对流项的前向欧拉离散贡献了因子 $1 - ic\\sin(\\theta)$，其模为 $\\sqrt{1+c^2\\sin^2\\theta} \\ge 1$。仅此一项就会导致无条件不稳定。扩散项的隐式处理提供了一个阻尼因子 $(1 + 4r\\sin^2(\\theta/2))^{-1}$。稳定性条件 $r \\ge c^2/2$ 量化了为抵消显式对流（由 $c$ 度量）引起的放大效应并确保净放大因子的模不超过1所需的最小隐式扩散量（由 $r$ 度量）。该条件可以用物理参数重写为 $\\frac{\\nu\\Delta t}{h^2} \\ge \\frac{1}{2}(\\frac{a\\Delta t}{h})^2$，简化后为 $\\Delta t \\le \\frac{2\\nu}{a^2}$。这是一个依赖于物理系数的时间步长限制，这是显式或部分显式方法的一个标志。", "answer": "$$\n\\boxed{\\frac{c^{2}}{2}}\n$$", "id": "3406598"}, {"introduction": "理解了基本稳定性后，我们来探讨一个更贴近实际的挑战：如何处理非光滑初始数据。本练习将分析一种巧妙的变参数策略，即初始阶段采用具有强耗散性的后向欧拉法，随后切换到高精度的Crank-Nicolson法。通过分析此策略[@problem_id:3406590]，你将深入理解L-稳定性和A-稳定性的区别，并学会如何设计算法以在抑制初始伪振荡的同时，保持整体的高阶精度。", "problem": "考虑一维热方程，这是一个典型的抛物型偏微分方程 (PDE)，\n$$\nu_t = \\nu u_{xx}, \\quad x \\in (0,1), \\quad t>0,\n$$\n其具有齐次 Dirichlet 边界条件和初始数据 $u(x,0)=u_0(x)$，该初始数据是平方可积的，但不一定光滑。假设在空间上，我们在尺寸为 $h$ 的均匀网格上使用标准的二阶中心有限差分方法（finite difference method, FDM），得到半离散的常微分方程 (ODE)\n$$\n\\frac{d}{dt} \\mathbf{u}(t) = A \\mathbf{u}(t),\n$$\n其中 $A$ 是从带有 Dirichlet 边界条件的拉普拉斯算子得到的刚度矩阵，该矩阵是对称负定的，其特征值 $\\lambda_j  0$ 的量级为 $|\\lambda_j| = \\mathcal{O}(h^{-2})$。考虑时间上采用均匀时间步长 $\\Delta t$ 的 $\\theta$-方法，\n$$\n\\left(I - \\theta \\,\\Delta t \\, A\\right)\\mathbf{u}^{n+1} = \\left(I + (1-\\theta)\\,\\Delta t \\, A\\right)\\mathbf{u}^{n},\n$$\n应用于该半离散系统。我们研究一种可变 $\\theta$ 策略：前 $m$ 步取 $\\theta=1$（完全隐式的向后欧拉法），之后的所有步骤取 $\\theta = 1/2$（Crank–Nicolson 方法）。假设 $m$ 是一个与 $\\Delta t$ 和 $h$ 无关的固定整数，并且精确解的抛物平滑特性使得当 $t>0$ 时，$u(\\cdot,t)$ 在空间上是光滑的。\n\n使用标量测试方程 $y'(t)=\\lambda y(t)$（其中 $\\lambda0$）来表示单个刚性模态，并利用抛物半群 $e^{tA}$ 的经典平滑性质，分析这种可变 $\\theta$ 策略如何影响：\n- 对由非光滑初始数据引起的初始高频分量（初始层）的阻尼，以及\n- 在固定的最终时间 $T>0$ 时该方法的整体时间精度。\n\n在这些假设下，下列哪个陈述最为准确？\n\nA. 固定数量的初始向后欧拉步（$\\theta=1$）会强力阻尼与大的负特征值相关的高频分量，而随后的 Crank–Nicolson（$\\theta=1/2$）步在解变得光滑后，在时间 $t=T$ 处能产生二阶精度；因此，该组合策略既能阻尼初始层，又能保持二阶精度。\n\nB. 因为向后欧拉法只是一阶精度的，所以在开始时使用任何 $\\theta=1$ 的步骤都会迫使整个计算在时间 $t=T$ 处全局上是一阶精度的，无论之后采取了多少 Crank–Nicolson 步。\n\nC. 初始的向后欧拉步会增加最高频模态的振幅，然后由 Crank–Nicolson 方法进行修正；尽管如此，在 $t=T$ 时的整体精度仍然是二阶的。\n\nD. 对于标量测试方程，对于大的负 $\\Delta t\\,\\lambda$ 值，向后欧拉法（$\\theta=1$）和 Crank–Nicolson 方法（$\\theta=1/2$）具有相同的放大因子，因此从 $\\theta=1$ 切换到 $\\theta=1/2$ 不会影响初始层的阻尼。\n\nE. 在存在非光滑初始数据的情况下，要恢复二阶精度，启动步骤必须是显式的；以 $\\theta=1$ 开始既不能改善阻尼，也不能恢复二阶精度。", "solution": "问题陈述已经过验证，被认为是合理、适定且科学正确的。\n\n该问题要求分析一种用于热方程数值解的可变时间步长策略。具体来说，该策略使用几步一阶向后欧拉法（$\\theta=1$），然后对所有后续步驟使用二阶 Crank–Nicolson 方法（$\\theta=1/2$）。我们需要评估该策略在两个方面的影响：对来自非光滑数据的初始高频分量的阻尼，以及在固定的最终时间 $T > 0$ 时的整体时间精度。\n\n让我们使用提供的框架分别分析这两个方面。\n\n**1. 高频分量的阻尼**\n\n半离散系统 $\\frac{d}{dt}\\mathbf{u}(t) = A\\mathbf{u}(t)$ 是刚性的。刚性源于矩阵 $A$ 的特征值 $\\lambda_j$ 跨越了很大的数量级范围，其中 $|\\lambda_j|_{max} = \\mathcal{O}(h^{-2})$。具有大数量级的特征值对应于高频空间模态。非光滑的初始数据 $u_0(x)$ 在这些高频特征模态上将有显著的投影。一个好的数值格式必须能快速阻尼这些分量，模仿热方程的物理平滑特性。\n\n时间步进格式在这些模态上的行为通过标量测试方程 $y'(t) = \\lambda y(t)$ 来分析，其中 $\\lambda  0$ 代表 $A$ 的一个特征值。更新规则是 $y^{n+1} = R(z) y^n$，其中 $z = \\lambda \\Delta t$，$R(z)$ 是该方法的放大因子。对于 $\\theta$-方法，放大因子是：\n$$\nR(z) = \\frac{1 + (1-\\theta)z}{1 - \\theta z}\n$$\n我们关心的是 $R(z)$ 对高频模态的行为，这对应于 $z \\to -\\infty$。\n\n- **向后欧拉法 ($\\theta=1$):** 用于前 $m$ 步。\n放大因子是 $R_{BE}(z) = \\frac{1}{1-z}$。在极限 $z \\to -\\infty$下，我们有：\n$$\n\\lim_{z \\to -\\infty} R_{BE}(z) = \\lim_{z \\to -\\infty} \\frac{1}{1-z} = 0\n$$\n这个性质，即放大因子对于无限刚性分量趋于零，被称为 L-稳定性。这意味着向后欧拉法能非常强力地阻尼高频分量。这对于处理富含此类分量的初始非光滑数据是非常理想的。\n\n- **Crank–Nicolson 方法 ($\\theta=1/2$):** 用于 $n \\ge m$ 的步骤。\n放大因子是 $R_{CN}(z) = \\frac{1 + z/2}{1 - z/2}$。在极限 $z \\to -\\infty$下，我们有：\n$$\n\\lim_{z \\to -\\infty} R_{CN}(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2} = -1\n$$\n这意味着 Crank–Nicolson 方法不阻尼高频分量；它在每个时间步保持其振幅，同时翻转其符号。如果存在此类分量，这将导致数值解中出现持续的高频振荡。这个性质被称为 A-稳定性，它比 L-稳定性弱。\n\n因此，最初使用几步向后欧拉法的策略至关重要。它有效地阻尼了由非光滑数据引起的初始高频误差，从而在数值上“平滑”了解。几步之后，解变得光滑，高频分量变得可以忽略不计，此时可以切换到更精确的 Crank-Nicolson 方法，而不必担心振荡伪影。\n\n**2. 整体时间精度**\n\n向后欧拉法在时间上是一阶精度的（局部截断误差 $\\tau_{BE} = \\mathcal{O}(\\Delta t^2)$），而 Crank–Nicolson 方法是二阶精度的（$\\tau_{CN} = \\mathcal{O}(\\Delta t^3)$）。一个朴素的分析可能会认为，使用任何数量的一阶步骤都会将整个计算的全局精度降低到一阶。\n\n然而，对于抛物型问题，需要更精细的分析。关键在于精确解算子 $e^{tA}$ 的平滑性质。对于 $t > 0$，即使 $u_0$ 不光滑，解 $u(t) = e^{tA}u_0$ 也是光滑的。$u(t)$ 的时间导数在 $t=0$ 时是奇异的，但在 $t>0$ 时变得有界。例如，对于 $t>0$，有 $\\|A^k u(t)\\| \\le C_k t^{-k} \\|u_0\\|$。\n\n局部截断误差项依赖于这些导数。向后欧拉步骤的一阶误差是在早期时间 $t_n = n\\Delta t$ (对于 $n=0, \\dots, m-1$) 产生的。虽然在这些初始时刻局部截断误差常数很大，但误差本身在向前传播时会被格式所阻尼。抛物方程的平滑性质意味着，在开始时引入的误差在稍后的时间 $T$ 产生的影响会减小。\n\n一项严格的分析（由 Rannacher 等人开创）表明，对于固定数量的初始步驟 $m$（与 $\\Delta t$ 和 $h$无关），在固定的最终时间 $T > m\\Delta t$ 处的全局误差主要由积分主体部分所用方法的精度决定。来自少数启动步骤的一阶误差不会污染整体的二阶精度。在时间 $T$ 的全局误差表现为 $\\mathcal{O}(\\Delta t^2)$。\n\n因此，该组合策略成功地利用了两种方法的优点：向后欧拉法的强阻尼特性处理初始的非光滑性，以及 Crank–Nicolson 方法的高精度用于后续已平滑解的演化，从而得到一种既鲁棒又具有二阶精度的方法。\n\n**选项评估：**\n\n- **A.** 该陈述声称初始的向后欧拉（BE）步阻尼了高频分量，而随后的 Crank–Nicolson（CN）步产生了二阶精度，组合策略实现了这两个目标。我们的分析证实了这两点。BE 步因其 L-稳定性提供了必要的阻尼。由于抛物型问题的平滑特性，整体精度保持在 $\\mathcal{O}(\\Delta t^2)$。**正确。**\n\n- **B.** 该陈述声称任何使用 BE 都会迫使全局精度变为一阶。这是一个常见的误解，忽略了抛物型平滑的特定背景。如分析所示，来自初始步骤的一阶误差在稍后的时间 $T$ 不会主导全局误差。**错误。**\n\n- **C.** 该陈述声称 BE 步会*增加*高频模态的振幅。这在事实上是错误的。如放大因子 $R_{BE}(z) = 1/(1-z)$ 所示，对于 $\\text{Re}(z) \\le 0$，其模长总是小于或等于 1，并且对于大的负 $z$ 值，它趋近于 0。这是一种阻尼方法。**错误。**\n\n- **D.** 该陈述声称 BE 和 CN 对于大的负 $\\Delta t \\lambda$ 具有相同的放大因子。我们计算得出 $\\lim_{z \\to -\\infty} R_{BE}(z) = 0$ 和 $\\lim_{z \\to -\\infty} R_{CN}(z) = -1$。它们并不相同。这两个极限之间的差异正是该启动策略有效的原因。**错误。**\n\n- **E.** 该陈述提出了多个错误的说法。首先，它暗示必须使用显式启动；对于刚性问题，由于稳定性的限制，这将是灾难性的。其次，它声称 $\\theta=1$ (BE) 不能改善阻尼，这与事实相反——其 L-稳定性正是其在阻尼方面的主要优势。第三，它声称 BE 无法恢复二阶精度，这也与该启动策略的既定理论相矛盾。**错误。**\n\n最终结论：唯一准确的陈述是 A。", "answer": "$$\\boxed{A}$$", "id": "3406590"}, {"introduction": "在保证了数值稳定性之后，下一个核心问题是如何高效地获得精确的解。本练习将引导你分析热传导方程的全隐式格式，并推导其全局误差的主要来源。通过平衡时间离散和空间离散引入的误差[@problem_id:3406599]，你将学会如何根据问题的物理特性和离散格式的精度来理性地选择时间步长与空间步长的关系，这是实现高效计算的关键一步。", "problem": "考虑空间区间 $[0,1]$ 上的齐次一维热偏微分方程 (PDE) $u_{t}=\\kappa u_{xx}$，其边界条件为齐次狄利克雷边界条件，初始数据为光滑函数 $u(x,0)=\\sin(\\pi x)$。设其精确解为 $u(x,t)=\\sin(\\pi x)\\exp(-\\kappa \\pi^{2} t)$，适用于任何 $t \\ge 0$。使用大小为 $h$ 的均匀网格对空间域进行离散化，并用标准的二阶中心有限差分算子来近似 $u_{xx}$。使用时间步长为 $\\Delta t$ 的全隐式后向欧拉法，将时间推进到一个固定的时间视界 $T>0$。关注与 $\\sin(\\pi x)$ 相关的单个离散傅里叶-正弦模态，并假设有足够的光滑性来保证关于此模态的泰勒展开和线性化是合理的。\n\n从此模态的离散拉普拉斯特征值和由线方法产生的相应线性常微分方程的后向欧拉放大因子的定义出发，推导在时间 $T$ 的全局点误差的主阶渐近模型。该模型应表示为一个与 $\\Delta t$ 成正比的时间贡献项和一个与 $h^{2}$ 成正比的空间贡献项之和。仅使用第一性原理，如 $\\ln(1+z)$ 和 $\\sin(z)$ 的泰勒级数，以及本征模的精确解形式。然后，通过强制实施标度关系 $\\Delta t=C h^{2}$ 并要求主阶时间误差贡献和空间误差贡献的量级相等（以平衡误差），确定常数 $C$ 关于 $\\kappa$ 的闭式表达式。\n\n您的最终答案必须是 $C$ 的显式表达式。不要提供不等式或方程。无需进行数值四舍五入。", "solution": "本题要求在标度关系 $\\Delta t = C h^{2}$ 下，平衡热方程数值解的主阶时间误差和空间误差的常数 $C$。求解此问题需要对全局误差进行仔细的渐近分析。\n\n控制偏微分方程 (PDE) 是一维热方程：\n$$u_{t} = \\kappa u_{xx}$$\n其定义域为 $x \\in [0, 1]$，边界条件为齐次狄利克雷边界条件 $u(0, t) = u(1, t) = 0$，初始条件为 $u(x, 0) = \\sin(\\pi x)$。此初值问题的精确解为 $u(x, t) = \\sin(\\pi x) \\exp(-\\kappa \\pi^{2} t)$。\n\n首先，我们使用均匀网格 $x_j = j h$ 对空间域进行离散化，其中 $j = 0, 1, \\dots, N$，$h = 1/N$。在 $x_j$ 处的二阶空间导数 $u_{xx}$ 通过二阶标准中心有限差分算子进行近似：\n$$u_{xx}(x_j, t) \\approx \\frac{u(x_{j+1}, t) - 2u(x_j, t) + u(x_{j-1}, t)}{h^2}$$\n将此应用于PDE，得到一个常微分方程组 (ODEs)，这种技术被称为线方法。设 $u_j(t)$ 是 $u(x_j, t)$ 的近似。半离散系统为：\n$$\\frac{du_j}{dt} = \\kappa \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}$$\n初始条件 $\\sin(\\pi x)$ 是连续拉普拉斯算子的一个本征函数。其离散对应项 $v_j = \\sin(\\pi x_j) = \\sin(j \\pi h)$ 是离散拉普拉斯矩阵的一个本征向量。我们来求其对应的特征值，记为 $\\lambda_h$。\n将离散算子应用于 $v_j$：\n$$\\frac{v_{j+1} - 2v_j + v_{j-1}}{h^2} = \\frac{\\sin((j+1)\\pi h) - 2\\sin(j\\pi h) + \\sin((j-1)\\pi h)}{h^2}$$\n使用三角恒等式 $\\sin(A+B) + \\sin(A-B) = 2\\sin(A)\\cos(B)$，我们得到：\n$$\\frac{2\\sin(j\\pi h)\\cos(\\pi h) - 2\\sin(j\\pi h)}{h^2} = \\left(\\frac{2(\\cos(\\pi h) - 1)}{h^2}\\right) \\sin(j\\pi h)$$\n因此，特征值为 $\\lambda_h = \\frac{2(\\cos(\\pi h) - 1)}{h^2}$。\n此模态振幅的ODE（我们称之为 $U(t)$）变为 $\\frac{dU}{dt} = \\kappa \\lambda_h U(t)$。\n\n接下来，我们分析由这种空间离散化引入的误差。我们将 $\\lambda_h$ 对 $h$ 进行泰勒级数展开。使用 $\\cos(z) = 1 - \\frac{z^2}{2!} + \\frac{z^4}{4!} - O(z^6)$ 的级数展开式：\n$$\\lambda_h = \\frac{2}{h^2} \\left( \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - O(h^6)\\right) - 1 \\right) = \\frac{2}{h^2} \\left( -\\frac{\\pi^2 h^2}{2} + \\frac{\\pi^4 h^4}{24} - O(h^6) \\right)$$\n$$\\lambda_h = -\\pi^2 + \\frac{\\pi^4 h^2}{12} - O(h^4)$$\n对于模态 $\\sin(\\pi x)$，连续算子 $-\\frac{\\partial^2}{\\partial x^2}$ 的特征值为 $\\pi^2$，因此 $u_{xx}$ 的特征值为 $-\\pi^2$。空间离散化引入的误差为 $\\lambda_h - (-\\pi^2) \\approx \\frac{\\pi^4 h^2}{12}$。\n\n现在，我们对 ODE $\\frac{dU}{dt} = \\kappa \\lambda_h U(t)$ 应用时间步长为 $\\Delta t$ 的全隐式后向欧拉法。设 $U^n$ 是 $U(n\\Delta t)$ 的近似值。\n$$\\frac{U^{n+1} - U^n}{\\Delta t} = \\kappa \\lambda_h U^{n+1}$$\n解出 $U^{n+1}$，我们得到 $U^{n+1} = \\frac{1}{1 - \\kappa \\lambda_h \\Delta t} U^n$。一个时间步的放大因子是 $g_{BE} = (1 - \\kappa \\lambda_h \\Delta t)^{-1}$。\n经过 $n_{steps} = T/\\Delta t$ 步后，在时间 $T$ 的振幅的数值解为 $U(T) \\approx (g_{BE})^{T/\\Delta t} U(0)$。\n\n在时间 $T$ 的精确解的振幅为 $\\exp(-\\kappa \\pi^2 T)$。\n在时间 $T$ 的数值解的振幅为 $( (1 - \\kappa \\lambda_h \\Delta t)^{-1} )^{T/\\Delta t}$。\n为了分析误差，我们比较这两个量的对数。\n精确振幅因子的对数为 $-\\kappa \\pi^2 T$。\n数值振幅因子的对数为：\n$$ \\ln\\left( (g_{BE})^{T/\\Delta t} \\right) = \\frac{T}{\\Delta t} \\ln(g_{BE}) = -\\frac{T}{\\Delta t} \\ln(1 - \\kappa \\lambda_h \\Delta t)$$\n使用泰勒级数 $\\ln(1-z) = -z - \\frac{z^2}{2} - O(z^3)$，其中 $z = \\kappa \\lambda_h \\Delta t$：\n$$-\\frac{T}{\\Delta t} \\left( -(\\kappa \\lambda_h \\Delta t) - \\frac{(\\kappa \\lambda_h \\Delta t)^2}{2} - O((\\Delta t)^3) \\right) = T \\kappa \\lambda_h + \\frac{T}{2} (\\kappa \\lambda_h)^2 \\Delta t + O((\\Delta t)^2)$$\n现在我们代入 $\\lambda_h$ 的展开式：\n$$T \\kappa \\left(-\\pi^2 + \\frac{\\pi^4 h^2}{12} + O(h^4)\\right) + \\frac{T}{2} \\left(\\kappa \\left(-\\pi^2 + O(h^2)\\right)\\right)^2 \\Delta t + O((\\Delta t)^2)$$\n$$ = -T \\kappa \\pi^2 + T \\kappa \\frac{\\pi^4 h^2}{12} + \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t + \\text{h.o.t.}$$\n精确振幅的对数是 $-T \\kappa \\pi^2$。振幅对数的误差是二者之差：\n$$\\text{Error}_{\\ln} \\approx \\left( T \\kappa \\frac{\\pi^4 h^2}{12} \\right) + \\left( \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right)$$\n与 $h^2$ 成正比的项源于空间离散化，与 $\\Delta t$ 成正比的项源于时间离散化。\n\n在时间 $T$ 的全局点误差为 $E_j(T) = u(x_j, T) - u_j^N$，其中 $N=T/\\Delta t$。\n$$E_j(T) = \\sin(\\pi x_j) \\left( \\exp(-\\kappa \\pi^2 T) - \\left(g_{BE}\\right)^{T/\\Delta t} \\right)$$\n设 $A_{exact} = \\exp(-\\kappa \\pi^2 T)$ 和 $A_{num} = (g_{BE})^{T/\\Delta t}$。我们有 $\\ln(A_{num}) \\approx \\ln(A_{exact}) + \\text{Error}_{\\ln}$。\n因此 $A_{num} \\approx A_{exact} \\exp(\\text{Error}_{\\ln})$。对于小误差，$\\exp(\\text{Error}_{\\ln}) \\approx 1 + \\text{Error}_{\\ln}$。\n所以 $A_{num} \\approx A_{exact} (1 + \\text{Error}_{\\ln})$。\n振幅的误差为 $A_{exact} - A_{num} \\approx -A_{exact} \\cdot \\text{Error}_{\\ln}$。\n点误差为：\n$$E_j(T) \\approx -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\left( T \\kappa \\frac{\\pi^4 h^2}{12} + \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right)$$\n这给出了全局误差的主阶渐近模型。括号中的第一项是空间误差贡献，第二项是时间误差贡献。\n\n问题要求平衡这两项贡献的量级。\n$$ \\left| \\text{空间贡献} \\right| = \\left| -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) T \\kappa \\frac{\\pi^4 h^2}{12} \\right| $$\n$$ \\left| \\text{时间贡献} \\right| = \\left| -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right| $$\n假设 $x_j \\in (0,1)$，$T>0$，$\\kappa>0$，我们可以令其正值部分相等：\n$$ \\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) T \\kappa \\frac{\\pi^4 h^2}{12} = \\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t $$\n消去两边的公因子（它们非零）：\n$$ \\kappa \\frac{\\pi^4 h^2}{12} = \\frac{\\kappa^2 \\pi^4 \\Delta t}{2} $$\n进一步消去 $\\kappa$ 和 $\\pi^4$ 进行化简，得到：\n$$ \\frac{h^2}{12} = \\frac{\\kappa \\Delta t}{2} $$\n问题强制要求标度关系为 $\\Delta t = C h^2$。将其代入方程：\n$$ \\frac{h^2}{12} = \\frac{\\kappa (C h^2)}{2} $$\n我们从两边消去 $h^2$ (因为 $h \\neq 0$)：\n$$ \\frac{1}{12} = \\frac{\\kappa C}{2} $$\n最后，我们解出常数 $C$：\n$$ \\kappa C = \\frac{2}{12} = \\frac{1}{6} $$\n$$ C = \\frac{1}{6\\kappa} $$\n对于给定的数值格式和问题，这个 $C$ 值平衡了主阶的空间和时间截断误差。", "answer": "$$\\boxed{\\frac{1}{6\\kappa}}$$", "id": "3406599"}]}