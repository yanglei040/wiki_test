{"hands_on_practices": [{"introduction": "物理量如浓度或绝对温度等在本质上是非负的。一个理想的数值格式应该能保持解的这种“保正性”。虽然连续形式的热方程是保正的，并且在满足一定条件时，一些简单的显式方法（如前向欧拉法）也是保正的，但无条件稳定的Crank-Nicolson方法却出人意料地不具备这个性质。这个练习将通过一个模拟扩散过程的简单 $2 \\times 2$ 矩阵系统，让您亲手构建一个反例。通过计算导致正性丧失的临界时间步长，您将对Crank-Nicolson方法的这一重要限制有一个具体的理解。[@problem_id:3360619]", "problem": "考虑半离散形式的线性抛物线初值问题 $u^{\\prime}(t)=-A\\,u(t)$，其中 $A\\in\\mathbb{R}^{2\\times 2}$ 是矩阵\n$$\nA=\\begin{pmatrix}\n2  -1\\\\\n-1  2\n\\end{pmatrix}.\n$$\n假设使用步长为 $\\Delta t0$ 的 Crank–Nicolson (CN) 方法执行单个时间步，将解从 $u^{n}$ 推进到 $u^{n+1}$。正性的概念是按分量定义的：如果向量 $v\\in\\mathbb{R}^{2}$ 的每个分量都满足 $v_{i}\\ge 0$，则称该向量为正向量。\n\n矩阵 $A$ 具有非正的非对角元素和正的逆矩阵，因此 $A$ 在标准意义上是一个非奇异 $M$-矩阵。由 $-A$ 生成的连续半群保持正性。然而，对于某些 $\\Delta t$ 的选择，Crank–Nicolson 方法可能无法保持正性。\n\n从线性系统的 Crank–Nicolson 方法的基本定义以及 $M$-矩阵的定义出发，完成以下任务：\n- 在 Crank–Nicolson 方法下，对于系统 $u^{\\prime}=-A u$，推导将 $u^{n}$ 映射到 $u^{n+1}$ 的单步线性更新算子。\n- 使用正的初始向量 $u^{n}=e_{1}=(1,0)^{\\top}$，确定使得 $u^{n+1}$ 的第一个分量严格为负的最小正时间步长 $\\Delta t$。\n\n你的最终答案必须是这个最小 $\\Delta t$ 的一个精确表达式。不要进行四舍五入。", "solution": "该问题要求找到最小的正时间步长 $\\Delta t$，使得应用于系统 $u^{\\prime}(t) = -A u(t)$ 的 Crank-Nicolson (CN) 方法不再保持正性。具体来说，我们需要找到一个临界 $\\Delta t$ 值，从正的初始向量 $u^n = e_1$ 出发，在该步长下解的第一个分量变为负数。\n\n首先，我们推导 Crank-Nicolson 方法的单步线性更新算子。该方法在时间区间 $[t_n, t_{n+1}]$（其中 $t_{n+1} = t_n + \\Delta t$）上对微分方程 $u' = -A u$ 进行近似，形式如下：\n$$ \\frac{u^{n+1} - u^{n}}{\\Delta t} = \\frac{1}{2} \\left( (-A u^{n+1}) + (-A u^{n}) \\right) $$\n其中 $u^n$ 和 $u^{n+1}$ 分别是在时间 $t_n$ 和 $t_{n+1}$ 处解的数值近似值。\n\n为了找到将 $u^n$ 映射到 $u^{n+1}$ 的更新算子，我们必须对 $u^{n+1}$ 求解：\n$$ u^{n+1} - u^{n} = -\\frac{\\Delta t}{2} A u^{n+1} - \\frac{\\Delta t}{2} A u^{n} $$\n重新整理各项，将含 $u^{n+1}$ 的项移到左边，含 $u^{n}$ 的项移到右边，得到：\n$$ u^{n+1} + \\frac{\\Delta t}{2} A u^{n+1} = u^{n} - \\frac{\\Delta t}{2} A u^{n} $$\n提出向量 $u^{n+1}$ 和 $u^{n}$：\n$$ \\left(I + \\frac{\\Delta t}{2} A\\right) u^{n+1} = \\left(I - \\frac{\\Delta t}{2} A\\right) u^{n} $$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n对 $u^{n+1}$ 求解，我们得到：\n$$ u^{n+1} = \\left(I + \\frac{\\Delta t}{2} A\\right)^{-1} \\left(I - \\frac{\\Delta t}{2} A\\right) u^{n} $$\n这就定义了单步线性更新算子，或称放大矩阵 $G$：\n$$ G = \\left(I + \\frac{\\Delta t}{2} A\\right)^{-1} \\left(I - \\frac{\\Delta t}{2} A\\right) $$\n\n现在，我们为给定的矩阵 $A = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$ 显式计算该算子。为简化符号，设 $k = \\frac{\\Delta t}{2}$。由于 $\\Delta t  0$，我们有 $k  0$。$G$ 的表达式变为：\n$$ G = (I + kA)^{-1} (I - kA) $$\n首先，我们计算此表达式中的两个矩阵：\n$$ I+kA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + k \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 1+2k  -k \\\\ -k  1+2k \\end{pmatrix} $$\n$$ I-kA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - k \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 1-2k  k \\\\ k  1-2k \\end{pmatrix} $$\n接下来，我们求 $(I+kA)$ 的逆矩阵。其行列式为：\n$$ \\det(I+kA) = (1+2k)(1+2k) - (-k)(-k) = (1+2k)^2 - k^2 = 1+4k+4k^2 - k^2 = 1+4k+3k^2 $$\n对行列式进行因式分解，得到 $\\det(I+kA) = (1+k)(1+3k)$。因为 $k0$，所以行列式不为零，逆矩阵存在。\n逆矩阵由下式给出：\n$$ (I+kA)^{-1} = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1+2k  k \\\\ k  1+2k \\end{pmatrix} $$\n现在我们可以计算算子 $G$：\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1+2k  k \\\\ k  1+2k \\end{pmatrix} \\begin{pmatrix} 1-2k  k \\\\ k  1-2k \\end{pmatrix} $$\n进行矩阵乘法：\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} (1+2k)(1-2k)+k^2  (1+2k)k+k(1-2k) \\\\ k(1-2k)+(1+2k)k  k^2+(1+2k)(1-2k) \\end{pmatrix} $$\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-4k^2+k^2  k+2k^2+k-2k^2 \\\\ k-2k^2+k+2k^2  k^2+1-4k^2 \\end{pmatrix} $$\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2  2k \\\\ 2k  1-3k^2 \\end{pmatrix} $$\n这就是更新算子的显式形式。\n\n问题要求在给定初始向量 $u^n = e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 的情况下，找出使得 $u^{n+1}$ 的第一个分量严格为负的最小 $\\Delta t  0$。我们计算 $u^{n+1}$：\n$$ u^{n+1} = G u^n = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2  2k \\\\ 2k  1-3k^2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n$$ u^{n+1} = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2 \\\\ 2k \\end{pmatrix} $$\n所以 $u^{n+1}$ 的分量是：\n$$ (u^{n+1})_1 = \\frac{1-3k^2}{(1+k)(1+3k)} \\quad \\text{和} \\quad (u^{n+1})_2 = \\frac{2k}{(1+k)(1+3k)} $$\n我们要找到使 $(u^{n+1})_1  0$ 成立的关于 $\\Delta t$ 的条件。\n$$ \\frac{1-3k^2}{(1+k)(1+3k)}  0 $$\n因为 $k = \\Delta t/2  0$，所以分母 $(1+k)(1+3k)$ 总是正的。因此，该不等式成立的充要条件是分子为负：\n$$ 1-3k^2  0 $$\n$$ 1  3k^2 $$\n$$ k^2 > \\frac{1}{3} $$\n因为 $k0$，我们对两边取正平方根：\n$$ k > \\frac{1}{\\sqrt{3}} $$\n现在，我们代回 $k = \\frac{\\Delta t}{2}$：\n$$ \\frac{\\Delta t}{2} > \\frac{1}{\\sqrt{3}} $$\n$$ \\Delta t > \\frac{2}{\\sqrt{3}} $$\n对于开区间 $(\\frac{2}{\\sqrt{3}}, \\infty)$ 内的任何时间步长 $\\Delta t$，$u^{n+1}$ 的第一个分量都严格为负。问题要求的是满足此条件的“最小正时间步长”。这对应于这组值的下确界。在边界值 $\\Delta t = \\frac{2}{\\sqrt{3}}$ 处，第一个分量 $(u^{n+1})_1$ 为零。对于任何比此值大无穷小的 $\\Delta t$，该分量都会变为负值。因此，标志着保持正性与破坏正性之间边界的临界值就是这个下确界。\n\n失去正性属性的最小正时间步长 $\\Delta t$ 是 $\\frac{2}{\\sqrt{3}}$。这也可以将分母有理化后写成 $\\frac{2\\sqrt{3}}{3}$。", "answer": "$$\\boxed{\\frac{2}{\\sqrt{3}}}$$", "id": "3360619"}, {"introduction": "一个数值格式的总体精度取决于空间和时间两方面的离散误差。通常情况下，这些误差会累加起来，但在某些特殊情况下，我们可以巧妙地选择离散参数，使得主导误差项相互抵消，从而实现“超收敛”（superconvergence）。这个练习将挑战您去分析Crank-Nicolson方法的主导时间误差和标准中心差分格式的主导空间误差。通过为特定的傅里叶模态设置误差抵消的条件，您将设计出一个在该模态上具有超乎预期精度的格式，从而揭示时间步长、网格尺寸和数值误差之间错综复杂的关系。[@problem_id:3360618]", "problem": "考虑一维热方程 $u_{t} = \\nu u_{xx}$，定义在周期性域 $x \\in [0,L]$ 上，其中 $\\nu  0$ 是热扩散系数。设 $x_{j} = j h$，$j = 0,1,\\dots,M-1$，其中 $h = L/M$，$t_{n} = n \\Delta t$。使用 Crank–Nicolson (CN) 方法在时间上、使用标准的中心二阶差分近似 $u_{xx}$ 在空间上，对 $u_{t} = \\nu u_{xx}$ 进行离散化：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} + \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{h^{2}} \\right).\n$$\n假设初始条件为单个傅里叶模式 $u(x,0) = \\exp(\\mathrm{i} k_{0} x)$，其波数 $k_{0} = \\frac{2\\pi m_{0}}{L}$，对于某个固定的非零整数 $m_{0}$。对于此模式，单个时间步长内的精确连续时间放大为 $\\exp(-\\nu k_{0}^{2} \\Delta t)$。应用于此模式的全离散 CN 格式有一个放大因子，该因子可以用离散拉普拉斯算子的特征值表示，而特征值取决于 $h$。\n\n从基本原理——线性常系数偏微分方程的傅里叶模式分析、中心二阶差分的修正波数以及 CN 方法的 Padé 近似解释——出发，推导一个时间步长内放大因子对数的主阶组合误差，并设计网格与时间步长的比率，使得对于特定模式 $k_{0}$，主阶空间离散误差与主阶 CN 时间积分误差相互抵消（该模式的超收敛）。明确地，确定无量綱比率 $\\Delta t / h$ 的唯一闭式表达式，以实现这种主阶抵消。\n\n将你的最终答案表示为 $\\Delta t / h$ 的单个闭式解析表达式。无需四舍五入，最终表达式中不应包含单位。", "solution": "问题要求我们找到时间步长 $\\Delta t$ 与空间步长 $h$ 的一个特定比率，使得在使用 Crank-Nicolson (CN) 数值方法求解热方程时，对于单个傅里叶模式解，主阶空间离散误差能够抵消主阶时间离散误差。\n\n一维热方程由下式给出：\n$$\nu_{t} = \\nu u_{xx}\n$$\n所提供的 Crank-Nicolson 离散化格式为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} + \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{h^{2}} \\right)\n$$\n我们分析该格式在单个傅里叶模式 $u(x,t) = \\exp(-\\nu k_{0}^{2} t) \\exp(\\mathrm{i} k_{0} x)$ 上的行为。其空间部分为 $\\exp(\\mathrm{i} k_{0} x)$。其离散对应形式为 $u_{j}^{n} = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} x_{j}) = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$，其中 $G_{num}$ 是每个时间步长 $\\Delta t$ 的数值放大因子。\n\n让我们将这种形式的解代入 CN 格式。\n空间上的有限差分算子 $\\delta_x^2$ 对空间部分的作用如下：\n$$\n\\delta_x^2 u_{j} = u_{j+1} - 2u_{j} + u_{j-1} = \\exp(\\mathrm{i} k_{0} (j+1) h) - 2\\exp(\\mathrm{i} k_{0} j h) + \\exp(\\mathrm{i} k_{0} (j-1) h)\n$$\n$$\n= \\exp(\\mathrm{i} k_{0} j h) \\left( \\exp(\\mathrm{i} k_{0} h) - 2 + \\exp(-\\mathrm{i} k_{0} h) \\right)\n$$\n$$\n= \\exp(\\mathrm{i} k_{0} j h) \\left( 2\\cos(k_{0}h) - 2 \\right) = -4\\sin^{2}\\left(\\frac{k_{0}h}{2}\\right) \\exp(\\mathrm{i} k_{0} j h)\n$$\n因此，离散拉普拉斯算子 $\\frac{\\delta_x^2}{h^2}$ 对该模式的作用是乘以特征值 $\\lambda_{h}(k_{0})$：\n$$\n\\lambda_{h}(k_{0}) = -\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{k_{0}h}{2}\\right)\n$$\n将 $u_{j}^{n} = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$ 代入 CN 格式方程可得：\n$$\n\\frac{(G_{num})^{n+1} - (G_{num})^{n}}{\\Delta t} \\exp(\\mathrm{i} k_{0} j h) = \\frac{\\nu}{2} \\left( (G_{num})^{n} \\lambda_{h}(k_{0}) \\exp(\\mathrm{i} k_{0} j h) + (G_{num})^{n+1} \\lambda_{h}(k_{0}) \\exp(\\mathrm{i} k_{0} j h) \\right)\n$$\n两边除以 $(G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$ (假设其非零)，我们得到一个关于 $G_{num}$ 的方程：\n$$\n\\frac{G_{num} - 1}{\\Delta t} = \\frac{\\nu}{2} \\lambda_{h}(k_{0}) (1 + G_{num})\n$$\n解出 $G_{num}$：\n$$\nG_{num} - 1 = \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2} (1 + G_{num})\n$$\n$$\nG_{num}\\left(1 - \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2}\\right) = 1 + \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2}\n$$\n$$\nG_{num} = \\frac{1 + \\frac{1}{2} \\nu \\Delta t \\lambda_{h}(k_{0})}{1 - \\frac{1}{2} \\nu \\Delta t \\lambda_{h}(k_{0})}\n$$\n令 $z_{h} = \\nu \\Delta t \\lambda_{h}(k_{0})$。数值放大因子为 $G_{num} = \\frac{1+z_{h}/2}{1-z_{h}/2}$。这是对 $\\exp(z_h)$ 的 $(1,1)$-Padé 近似。\n\n问题关注的是放大因子对数的误差。对于连续偏微分方程，在一个时间步长 $\\Delta t$ 内的精确放大因子是 $G_{exact} = \\exp(-\\nu k_{0}^{2} \\Delta t)$。精确放大指数是 $\\log(G_{exact}) = -\\nu k_{0}^{2} \\Delta t$。数值放大指数是 $\\log(G_{num})$。误差是 $E = \\log(G_{num}) - \\log(G_{exact})$。\n\n为了找到主阶误差，我们对 $\\log(G_{num})$ 关于小参数 $h$ 和 $\\Delta t$ 进行展开。\n首先，我们对离散特征值 $\\lambda_{h}(k_{0})$ 关于小 $h$ 进行展开，使用 $\\sin(x) = x - x^3/6 + \\mathcal{O}(x^5)$ 的泰勒级数：\n$$\n\\lambda_{h}(k_{0}) = -\\frac{4}{h^{2}}\\left( \\frac{k_{0}h}{2} - \\frac{1}{6}\\left(\\frac{k_{0}h}{2}\\right)^{3} + \\mathcal{O}(h^5) \\right)^{2}\n$$\n$$\n= -\\frac{4}{h^{2}}\\left( \\frac{k_{0}^{2}h^{2}}{4} - 2\\frac{k_{0}h}{2}\\frac{k_{0}^{3}h^{3}}{48} + \\mathcal{O}(h^6) \\right)\n$$\n$$\n= -\\frac{4}{h^{2}}\\left( \\frac{k_{0}^{2}h^{2}}{4} - \\frac{k_{0}^{4}h^{4}}{48} + \\mathcal{O}(h^6) \\right) = -k_{0}^{2} + \\frac{k_{0}^{4}h^{2}}{12} + \\mathcal{O}(h^4)\n$$\n$-k_{0}^{2}$ 项对应于精确的微分算子 $\\frac{\\partial^2}{\\partial x^2}$，而 $\\frac{k_{0}^{4}h^{2}}{12}$ 是特征值的主阶空间离散误差项。\n\n接下来，我们对 $\\log(G_{num})=\\log\\left(\\frac{1+z_{h}/2}{1-z_{h}/2}\\right)$ 关于小 $z_{h}$ 进行展开。使用 $\\log(1+x) = x - x^2/2 + x^3/3 - \\dots$：\n$$\n\\log(G_{num}) = \\log(1+z_{h}/2) - \\log(1-z_{h}/2)\n$$\n$$\n= \\left(\\frac{z_{h}}{2} - \\frac{1}{2}\\left(\\frac{z_{h}}{2}\\right)^{2} + \\frac{1}{3}\\left(\\frac{z_{h}}{2}\\right)^{3} - \\dots\\right) - \\left(-\\frac{z_{h}}{2} - \\frac{1}{2}\\left(-\\frac{z_{h}}{2}\\right)^{2} - \\frac{1}{3}\\left(-\\frac{z_{h}}{2}\\right)^{3} - \\dots\\right)\n$$\n$$\n= \\left(\\frac{z_{h}}{2} - \\frac{z_{h}^{2}}{8} + \\frac{z_{h}^{3}}{24} - \\dots\\right) - \\left(-\\frac{z_{h}}{2} - \\frac{z_{h}^{2}}{8} - \\frac{z_{h}^{3}}{24} - \\dots\\right)\n$$\n$$\n\\log(G_{num}) = z_{h} + \\frac{z_{h}^{3}}{12} + \\mathcal{O}(z_{h}^{5})\n$$\n如果数值方法能完美重现 $\\exp(z_h)$，那么 $z_{h}$ 项将是精确的，但 $\\frac{z_h^3}{12}$ 是 CN 方法在放大因子对数中的主阶时间误差。\n\n现在，我们结合这些展开式。我们将 $\\lambda_h(k_0)$ 的展开式代入 $z_{h}$：\n$$\nz_{h} = \\nu \\Delta t \\lambda_{h}(k_{0}) = \\nu \\Delta t \\left(-k_{0}^{2} + \\frac{k_{0}^{4}h^{2}}{12} + \\mathcal{O}(h^4)\\right)\n$$\n$$\n= -\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} + \\mathcal{O}(h^4 \\Delta t)\n$$\n现在我们将此代入 $\\log(G_{num})$ 的展开式中。我们只需要保留主阶项。$z_h$ 的最低阶是 $\\mathcal{O}(\\Delta t)$。所以 $z_h^3$ 是 $\\mathcal{O}(\\Delta t^3)$。\n$$\n\\log(G_{num}) = \\left(-\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12}\\right) + \\frac{1}{12}\\left(-\\nu k_{0}^{2} \\Delta t\\right)^{3} + \\text{H.O.T.}\n$$\n$$\n\\log(G_{num}) = -\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12} + \\text{H.O.T.}\n$$\n放大指数的总误差为 $E = \\log(G_{num}) - \\log(G_{exact})$：\n$$\nE = \\left(-\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12}\\right) - (-\\nu k_{0}^{2} \\Delta t) + \\text{H.O.T.}\n$$\n$$\nE = \\underbrace{\\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12}}_{\\text{空间误差}} - \\underbrace{\\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12}}_{\\text{时间误差}} + \\text{H.O.T.}\n$$\n第一项源于空间离散误差（$\\mathcal{O}(h^2)$），第二项源于 CN 方法的时间离散误差（在格式中为 $\\mathcal{O}(\\Delta t^2)$，在放大指数中表现为 $\\mathcal{O}(\\Delta t^3)$）。\n\n为了实现模式 $k_{0}$ 的主阶误差抵消，我们必须将这两项之和设为零：\n$$\n\\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12} = 0\n$$\n假设 $\\nu, k_{0}, \\Delta t \\neq 0$，我们可以除以公因子：\n$$\n\\nu k_{0}^{4} h^{2} \\Delta t = \\nu^{3} k_{0}^{6} \\Delta t^{3}\n$$\n$$\nh^{2} = \\nu^{2} k_{0}^{2} \\Delta t^{2}\n$$\n对两边取平方根（因为 $h, \\nu, k_0  0, \\Delta t  0$）：\n$$\nh = \\nu k_{0} \\Delta t\n$$\n问题要求的是比率 $\\Delta t / h$。重新整理方程可得：\n$$\n\\frac{\\Delta t}{h} = \\frac{1}{\\nu k_{0}}\n$$\n这是导致指定傅里叶模式的主阶空间误差和时间误差相互抵消的唯一无量纲比率，从而实现该模式的超收敛。", "answer": "$$\n\\boxed{\\frac{1}{\\nu k_{0}}}\n$$", "id": "3360618"}, {"introduction": "多步方法的全局误差是每一步局部误差累积的结果。虽然Crank-Nicolson是一个二阶方法，但这种高精度依赖于每一步计算的协调一致，如果计算的“第一步”就出了差错，会发生什么呢？本练习探讨了仅在第一个时间步使用一个精度较低的一阶方法所带来的后果。通过追踪这个初始“缺陷”如何在后续精确的Crank-Nicolson步骤中传播，您将证明它会污染整个求解过程，并将全局精度降低到一阶，这深刻地揭示了“链条的强度取决于其最薄弱环节”的道理。[@problem_id:3360622]", "problem": "考虑周期域上的一维热方程 $u_{t}=\\nu u_{xx}$。对于单个空间傅里叶模式 $k$，线方法将该偏微分方程简化为标量常微分方程 $a'(t)=-\\mu a(t)$，其中 $\\mu=\\nu k^{2}0$，初始振幅为 $a(0)=a_{0}$。Crank–Nicolson 方法（隐式梯形法则）用于以固定的时间步长 $\\Delta t0$ 对该模式进行时间推进（步数 $n\\geq 1$），而第一步则通过一个辅助程序初始化，该程序产生的第一步值 $a^{1}$ 在 $t=\\Delta t$ 时仅具有一阶精度。具体来说，假设\n$$\na^{1}=a(\\Delta t)+c\\,\\Delta t+O(\\Delta t^{2}),\n$$\n其中 $c$ 是一个与 $\\Delta t$ 无关的常数，仅取决于 $\\mu$、$a_{0}$ 和所选的初始化程序。令 $T=N\\Delta t$ 为一个固定的最终时间，其中整数 $N\\geq 2$，并将 $t_{n}=n\\Delta t$ 时的离散 Crank–Nicolson 解记为 $a^{n}$，将时间 $T$ 时的精确解记为 $a(T)$。\n\n从 Crank–Nicolson 是应用于线方法常微分方程 $a'(t)=-\\mu a(t)$ 的梯形法则这一核心定义出发，并仅使用线性常系数常微分方程指数解的基本性质，推导当 $\\Delta t\\to 0$ 时全局时间误差 $e^{N}=a^{N}-a(T)$ 的主阶项，并证明其与 $\\Delta t$ 成正比。用 $\\mu$、$T$ 和 $c$ 显式计算 $\\Delta t$ 的系数。然后，简要解释为什么如果在第一步应用缺陷修正，使得 $t=\\Delta t$ 处的梯形法则残差为 $O(\\Delta t^{3})$，该系数会消失。\n\n将您的最终答案表示为 $e^{N}$ 中 $\\Delta t$ 系数的单个闭式解析表达式；无需单位，也无需四舍五入。", "solution": "问题要求求解将 Crank-Nicolson 方法应用于一个模型常微分方程时的全局时间误差的主阶项，其中第一步是用一个一阶精度的方法计算的。问题还要求给出主误差项的系数，并解释为什么在特定的缺陷修正下该项会消失。\n\n首先，我们确定精确解和数值格式。线方法将偏微分方程简化为单个傅里叶模式的常微分方程 (ODE)：\n$$\na'(t) = -\\mu a(t)\n$$\n初始条件为 $a(0) = a_0$ 且 $\\mu  0$。精确解为\n$$\na(t) = a_0 \\exp(-\\mu t)\n$$\nCrank-Nicolson 方法是应用于此 ODE 的隐式梯形法则。对于步数 $n \\ge 1$，其定义为：\n$$\n\\frac{a^{n+1} - a^n}{\\Delta t} = \\frac{1}{2}\\left(-\\mu a^{n+1} - \\mu a^n\\right)\n$$\n解出 $a^{n+1}$ 得到递推关系：\n$$\na^{n+1}\\left(1 + \\frac{\\mu \\Delta t}{2}\\right) = a^n\\left(1 - \\frac{\\mu \\Delta t}{2}\\right)\n$$\n$$\na^{n+1} = \\frac{1 - \\mu \\Delta t/2}{1 + \\mu \\Delta t/2} a^n\n$$\n令 $R(\\mu\\Delta t) = \\frac{1 - \\mu \\Delta t/2}{1 + \\mu \\Delta t/2}$ 为 Crank-Nicolson 方法的放大因子。当 $n \\ge 1$ 时，数值解由 $a^{n+1} = R(\\mu\\Delta t) a^n$ 给出。\n\n在时间 $t_n = n\\Delta t$ 的全局误差定义为 $e^n = a^n - a(t_n)$。给定第一步提供的值 $a^1$ 满足其误差为：\n$$\ne^1 = a^1 - a(\\Delta t) = c\\,\\Delta t + O(\\Delta t^2)\n$$\n其中 $c$ 是一个常数。这是第一步的一阶局部误差。\n\n对于 $n \\ge 1$，我们可以推导出全局误差的递推关系：\n$$\ne^{n+1} = a^{n+1} - a(t_{n+1}) = R(\\mu\\Delta t)a^n - a(t_{n+1})\n$$\n代入 $a^n = e^n + a(t_n)$：\n$$\ne^{n+1} = R(\\mu\\Delta t)(e^n + a(t_n)) - a(t_{n+1}) = R(\\mu\\Delta t)e^n + \\left( R(\\mu\\Delta t)a(t_n) - a(t_{n+1}) \\right)\n$$\n括号中的项是单步误差，我们将其记为 $d_{n+1}$。它表示将单个 Crank-Nicolson 步应用于 $t_n$ 处的精确解所引入的误差。由于 $a(t_{n+1}) = \\exp(-\\mu\\Delta t)a(t_n)$，我们有：\n$$\nd_{n+1} = \\left( R(\\mu\\Delta t) - \\exp(-\\mu\\Delta t) \\right) a(t_n)\n$$\n为了找到 $d_{n+1}$ 的阶数，我们将 $R(z)$ 和 $\\exp(-z)$ 在 $z=0$ 附近对 $z=\\mu\\Delta t$ 进行泰勒级数展开：\n$$\n\\exp(-z) = 1 - z + \\frac{z^2}{2} - \\frac{z^3}{6} + O(z^4)\n$$\n$$\nR(z) = \\frac{1-z/2}{1+z/2} = (1-z/2)\\left(1 - \\frac{z}{2} + \\frac{z^2}{4} - \\frac{z^3}{8} + \\dots \\right) = 1 - z + \\frac{z^2}{2} - \\frac{z^3}{4} + O(z^4)\n$$\n两者之差为：\n$$\nR(z) - \\exp(-z) = \\left(-\\frac{1}{4} + \\frac{1}{6}\\right)z^3 + O(z^4) = -\\frac{1}{12}z^3 + O(z^4)\n$$\n因此，单步误差为：\n$$\nd_{n+1} = \\left(-\\frac{1}{12}(\\mu\\Delta t)^3 + O(\\Delta t^4)\\right)a(t_n) = O(\\Delta t^3)\n$$\n这证实了 Crank-Nicolson 方法的局部误差为 $O(\\Delta t^3)$，使其成为一个二阶精度的方法。\n\n对于 $n \\ge 1$，误差递推关系为 $e^{n+1} = R(\\mu\\Delta t)e^n + d_{n+1}$。为了求出最终时间 $T=N\\Delta t$ 时的全局误差 $e^N$，我们从 $e^1$ 开始展开此递推关系：\n$$\ne^N = R^{N-1}e^1 + R^{N-2}d_2 + R^{N-3}d_3 + \\dots + R^0 d_N = R^{N-1}e^1 + \\sum_{j=2}^{N} R^{N-j}d_j\n$$\n现在我们在保持 $T=N\\Delta t$ 固定的情况下，分析当 $\\Delta t \\to 0$ 时每一项的大小。\n\n1.  **来自初始误差的贡献：** 第一项是 $R^{N-1}e^1$。\n    当 $\\Delta t \\to 0$ 时，$N = T/\\Delta t \\to \\infty$。放大因子可以近似为 $R(\\mu\\Delta t) = \\exp(-\\mu\\Delta t) + O(\\Delta t^3)$。\n    $R^{N-1}$ 次方可以分析如下：\n    $$\n    R^{N-1} = \\left(\\exp(-\\mu\\Delta t) + O(\\Delta t^3)\\right)^{N-1}\n    $$\n    使用二项式展开，这等于 $\\left(\\exp(-\\mu\\Delta t)\\right)^{N-1} + (N-1)\\left(\\exp(-\\mu\\Delta t)\\right)^{N-2}O(\\Delta t^3) + \\dots$。\n    第一项是 $\\exp(-\\mu(N-1)\\Delta t) = \\exp(-\\mu(T-\\Delta t)) = \\exp(-\\mu T)\\exp(\\mu\\Delta t) = \\exp(-\\mu T)(1 + O(\\Delta t))$。\n    修正项的阶数为 $(T/\\Delta t) \\cdot \\Delta t^3 = O(\\Delta t^2)$。\n    所以，$R^{N-1} = \\exp(-\\mu T) + O(\\Delta t)$。\n    因此，来自初始误差的贡献为：\n    $$\n    R^{N-1}e^1 \\approx (\\exp(-\\mu T) + O(\\Delta t)) (c\\Delta t + O(\\Delta t^2)) = c\\exp(-\\mu T)\\Delta t + O(\\Delta t^2)\n    $$\n    来自初始误差的主阶项是 $c\\exp(-\\mu T)\\Delta t$。\n\n2.  **来自累积局部误差的贡献：** 第二项是和式 $\\sum_{j=2}^{N} R^{N-j}d_j$。\n    单步误差 $d_j$ 是 $O(\\Delta t^3)$。对于所有 $j$，放大因子 $R^{N-j} = O(1)$。这个和式有 $N-1$ 项。\n    这个和的总贡献大约是 $(N-1) \\times O(\\Delta t^3) \\approx (T/\\Delta t) \\times O(\\Delta t^3) = O(\\Delta t^2)$。\n    更正式地，该和是一个积分的黎曼和近似：\n    $$\n    \\sum_{j=2}^{N} R^{N-j}d_j \\approx \\sum_{j=1}^{N-1} \\exp(-\\mu(N-1-j)\\Delta t) \\left( -\\frac{1}{12}(\\mu\\Delta t)^3 a(t_j) \\right)\n    $$\n    可以证明，这会计算出一个 $O(\\Delta t^2)$ 阶的表达式。主项来自于局部截断误差之和，对于一个二阶方法，已知其阶数为 $\\Delta t^2$。\n\n结合这两部分的贡献，全局误差为：\n$$\ne^N = c\\exp(-\\mu T)\\Delta t + O(\\Delta t^2)\n$$\n在第一步引入的一阶误差主导了整体误差，将全局精度降低到一阶。全局误差的主阶项与 $\\Delta t$ 成正比。$\\Delta t$ 的系数是 $c\\exp(-\\mu T)$。\n\n最后，我们考虑在第一步进行缺陷修正的效果。问题陈述该修正“强制使 $t=\\Delta t$ 处的梯形法则残差为 $O(\\Delta t^3)$”。对于一个值 $a^1$ 的残差是 $\\rho(a^1) = \\frac{a^1-a_0}{\\Delta t} + \\frac{\\mu}{2}(a^1+a_0)$。\n一个标准的 Crank-Nicolson 步，我们称之为 $a^1_{CN}$，会将此残差设为零。如前所示，此步是二阶精度的，意味着单步误差 $a^1_{CN} - a(\\Delta t)$ 实际上是 $O(\\Delta t^3)$。\n如果一个修正后的值 $\\tilde{a}^1$ 的残差为 $\\rho(\\tilde{a}^1)=O(\\Delta t^3)$，这意味着\n$$\n\\tilde{a}^1 - a^1_{CN} = O(\\Delta t^4)\n$$\n因此，这个修正后第一步的误差是\n$$\n\\tilde{e}^1 = \\tilde{a}^1 - a(\\Delta t) = (a^1_{CN} + O(\\Delta t^4)) - a(\\Delta t) = (a(\\Delta t) + O(\\Delta t^3)) - a(\\Delta t) + O(\\Delta t^4) = O(\\Delta t^3)\n$$\n这意味着修正后的第一步至少是二阶精度的；在其误差展开式中没有 $O(\\Delta t)$ 项。在问题陈述的误差形式 $e^1 = c\\Delta t + O(\\Delta t^2)$ 的背景下，这意味着常数 $c$ 必须为零。\n当 $c=0$ 时，主阶全局误差项的系数 $c\\exp(-\\mu T)$ 变为零。全局误差随后由 $O(\\Delta t^2)$ 项决定，从而恢复了 Crank-Nicolson 格式预期的二阶精度。", "answer": "$$\n\\boxed{c\\exp(-\\mu T)}\n$$", "id": "3360622"}]}