{"hands_on_practices": [{"introduction": "我们从一个基础但至关重要的练习开始。通过解析求解一个带有Robin和Neumann边界条件的一维稳态扩散问题，我们可以直观地理解边界条件如何确定解的具体形式。这个练习不仅能巩固对常微分方程求解的掌握，也为更复杂的数值分析提供了基准和洞察力([@problem_id:3457537])。", "problem": "考虑稳态一维扩散，其中常数扩散率被缩放为单位1，因此标量场 $u(x)$ 的控制守恒方程为通量散度为零。在菲克扩散（Fickian diffusion）下，通量为 $J(x)=-u'(x)$，稳态守恒方程 $\\frac{dJ}{dx}=0$ 意味着对于 $x \\in (0,L)$，有二阶常微分方程 $-u''(x)=0$，其中 $L0$ 是区域长度。在 $x=0$ 处的边界服从一个罗宾（Robin）边界条件，表示场与其法向导数的线性组合，$u(0)+k\\,u'(0)=a$，其中 $k0$ 和 $a$ 是给定的常数。在 $x=L$ 处的边界服从一个诺伊曼（Neumann）边界条件，规定了法向导数，$u'(L)=b$，其中 $b$ 是一个给定的常数。仅使用控制守恒方程和这些边界条件作为基本依据，推导在 $(0,L)$ 上 $u(x)$ 关于参数 $k$、$a$、$b$ 和 $L$ 的唯一解析表达式。以封闭形式提供您最终的 $u(x)$ 表达式。不需要四舍五入，最终答案中不包含任何物理单位。", "solution": "用户希望我批判性地验证并在有效的情况下解决以下问题：\n给定在区域 $x \\in (0,L)$ 上的一维稳态扩散过程，由方程 $-u''(x)=0$ 控制，边界条件为 $u(0)+k\\,u'(0)=a$ 和 $u'(L)=b$。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 控制方程：$-u''(x) = 0$，对于 $x \\in (0,L)$。这是从守恒方程 $\\frac{dJ}{dx}=0$ 和通量定律 $J(x)=-u'(x)$ 推导出来的。\n- 区域：$x \\in (0,L)$，其中 $L0$。\n- 在 $x=0$ 处的边界条件：一个罗宾（Robin）条件，$u(0)+k\\,u'(0)=a$。参数 $k$ 和 $a$ 是给定的常数，且 $k0$。\n- 在 $x=L$ 处的边界条件：一个诺伊曼（Neumann）条件，$u'(L)=b$。参数 $b$ 是一个给定的常数。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用其标准数学公式（一个带边界条件的二阶常微分方程）描述了一个基本的物理过程（稳态扩散或热传导）。这是数学物理学中的一个典型问题。该模型是科学合理的。\n- **适定性：** 该问题是一个二阶常微分方程（ODE），需要两个边界条件来确定唯一解。它在区域的两端（$x=0$ 和 $x=L$）各提供了一个条件。对于像 $u''(x)=0$ 这样的简单常微分方程，罗宾条件和诺伊曼条件的组合通常会得到一个唯一的、稳定的解。该问题是适定的。\n- **客观性：** 问题陈述使用精确、标准的数学语言编写，没有歧义、主观性或个人观点。\n- **其他缺陷：** 该问题是自洽的，提供了所有必要信息。给定条件之间没有矛盾。参数是符号性的，约束条件（$L0$, $k0$）在物理上是合理的。该问题是一个标准练习，并非微不足道、故作高深或结构不良。\n\n**第三步：结论与行动**\n该问题有效。我将继续进行求解。\n\n### 求解推导\n\n分析始于控制守恒方程，即通量散度为零，表示为 $\\frac{dJ}{dx}=0$。这意味着通量 $J(x)$ 在整个区域 $(0,L)$ 内必须是一个常数。我们用 $J_0$ 表示这个常数通量。\n$$J(x) = J_0$$\n问题根据菲克定律（Fick's law）和单位扩散率定义了通量：\n$$J(x) = -u'(x)$$\n结合这两个陈述，我们发现标量场的一阶导数 $u'(x)$ 也必须是一个常数。\n$$-u'(x) = J_0 \\implies u'(x) = -J_0$$\n为了确定这个常数导数的值，我们使用在 $x=L$ 处指定的诺伊曼边界条件：\n$$u'(L) = b$$\n由于 $u'(x)$ 在整个区域上是恒定的，它在任何点 $x$ 的值都必须与其在 $x=L$ 处的值相同。因此，我们有：\n$$u'(x) = b$$\n这个结果对所有 $x \\in (0,L)$ 都有效。该方程也与初始的控制方程 $-u''(x) = -\\frac{d}{dx}(b) = 0$ 一致。\n\n为了求得标量场 $u(x)$，我们将它的导数表达式 $u'(x)=b$ 对 $x$ 进行积分：\n$$u(x) = \\int u'(x) \\, dx = \\int b \\, dx = bx + C$$\n其中 $C$ 是积分常数。\n\n为了确定 $C$ 的值，我们应用剩下的边界条件，即在 $x=0$ 处的罗宾条件：\n$$u(0) + k\\,u'(0) = a$$\n根据我们得到的 $u(x)$ 和 $u'(x)$ 的表达式，我们可以计算在 $x=0$ 处各项的值：\n$$u(0) = b(0) + C = C$$\n$$u'(0) = b$$\n将这些代入罗宾条件，得到一个关于常数 $C$ 的代数方程：\n$$C + k(b) = a$$\n求解 $C$，我们得到：\n$$C = a - kb$$\n最后，我们将积分常数 $C$ 的这个表达式代回到 $u(x)$ 的通解中，以获得标量场的唯一解析表达式：\n$$u(x) = bx + (a - kb)$$\n此解对 $x \\in (0,L)$ 有效。函数 $u(x)$ 用给定的参数 $a$、$b$ 和 $k$ 表示。区域长度 $L$ 对于定义问题的区域至关重要，但由于控制方程的特定形式和所提供的边界条件（特别是在常数通量问题上的诺伊曼条件），$L$ 并未显式出现在 $u(x)$ 的最终函数形式中。", "answer": "$$\\boxed{u(x) = bx + a - kb}$$", "id": "3457537"}, {"introduction": "与狄利克雷(Dirichlet)问题不同，诺伊曼(Neumann)问题并非对所有数据都保证有解。这个练习将引导你推导一个关键的“可解性条件”或“相容性条件”([@problem_id:3457511])。通过应用散度定理，我们将揭示一个深刻的物理原则：域内源项的总和必须与通过边界的通量相平衡，这是寻求数值解之前必须满足的理论前提。", "problem": "考虑在以原点为中心的单位圆盘定义的域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的偏微分方程 (PDE) 诺伊曼问题，该域定义为 $\\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x^{2} + y^{2} \\le 1\\}$，其边界为 $\\partial \\Omega = \\{(x,y) \\in \\mathbb{R}^{2} : x^{2} + y^{2} = 1\\}$。设 $u : \\overline{\\Omega} \\to \\mathbb{R}$ 满足偏微分方程\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \\qquad \\frac{\\partial u}{\\partial n} = g \\quad \\text{on } \\partial \\Omega,\n$$\n其中 $\\Delta$ 是拉普拉斯算子，$\\frac{\\partial u}{\\partial n}$ 表示在 $\\partial \\Omega$ 上的外法向导数。从散度定理以及拉普拉斯算子和法向通量的基本性质出发，推导诺伊曼问题可解的必要积分相容性条件。\n\n然后，对于在单位圆上由极角 $\\theta \\in [0,2\\pi)$ 参数化的给定数据 $f(x,y) = x$ 和边界数据 $g(\\theta) = \\cos\\theta$，通过精确计算所需的积分，评估所推导的相容性条件是否满足。如果相容性条件不满足，则通过向诺伊曼边界数据添加一个常数 $\\kappa$（即用 $g + \\kappa$ 替换 $g$）来对其中一个数据进行最小侵入性调整，并确定强制满足相容性条件的唯一常数 $\\kappa^{\\star}$。给出 $\\kappa^{\\star}$ 的值。\n\n你的最终答案必须是一个不带单位的实数。如果需要近似计算，说明会指定有效数字；但此处要求精确计算。", "solution": "所述问题是有效的。它涉及偏微分方程理论中的一个经典课题，即带诺伊曼边界条件的泊松方程的可解性条件。所有给定的数据和定义都是标准的、自洽的。该问题提出了一个数学上明确定义并能得出唯一解的多步骤任务。\n\n问题是求解满足偏微分方程\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega,\n$$\n并服从诺伊曼边界条件\n$$\n\\frac{\\partial u}{\\partial n} = g \\quad \\text{on } \\partial \\Omega.\n$$\n的解 $u$。此处，$\\Omega$ 是 $\\mathbb{R}^2$ 中的单位圆盘，$\\Delta = \\nabla \\cdot \\nabla$ 是拉普拉斯算子，$\\frac{\\partial u}{\\partial n} = \\nabla u \\cdot \\mathbf{n}$ 是 $u$ 在边界 $\\partial \\Omega$ 上的外法向导数。\n\n首先，我们推导解 $u$ 存在的必要相容性条件。我们首先在域 $\\Omega$ 上对PDE进行积分：\n$$\n\\iint_{\\Omega} (-\\Delta u) \\, dA = \\iint_{\\Omega} f \\, dA.\n$$\n左侧可以使用散度定理进行变换，该定理指出，对于向量场 $\\mathbf{F}$，有 $\\iint_{\\Omega} (\\nabla \\cdot \\mathbf{F}) \\, dA = \\oint_{\\partial\\Omega} \\mathbf{F} \\cdot \\mathbf{n} \\, ds$。我们选择向量场为 $u$ 的梯度，即 $\\mathbf{F} = \\nabla u$。那么，$\\nabla \\cdot \\mathbf{F} = \\nabla \\cdot (\\nabla u) = \\Delta u$。应用散度定理，我们得到：\n$$\n\\iint_{\\Omega} \\Delta u \\, dA = \\oint_{\\partial\\Omega} (\\nabla u \\cdot \\mathbf{n}) \\, ds.\n$$\n根据法向导数的定义，$\\nabla u \\cdot \\mathbf{n} = \\frac{\\partial u}{\\partial n}$。边界条件表明 $\\frac{\\partial u}{\\partial n} = g$。将这些代入方程中得到：\n$$\n\\iint_{\\Omega} \\Delta u \\, dA = \\oint_{\\partial\\Omega} g \\, ds.\n$$\n现在，回到我们积分后的PDE，我们有：\n$$\n-\\left( \\oint_{\\partial\\Omega} g \\, ds \\right) = \\iint_{\\Omega} f \\, dA.\n$$\n重新整理这些项，我们得到可解性条件或相容性条件：\n$$\n\\iint_{\\Omega} f \\, dA + \\oint_{\\partial\\Omega} g \\, ds = 0.\n$$\n这个条件代表了一种物理上的平衡：域内的总源 $f$ 必须与通过边界的总通量 $g$ 相平衡。\n\n接下来，我们需要找到一个唯一的常数 $\\kappa^{\\star}$，使得带有修正后边界数据 $g_{\\text{new}} = g + \\kappa^{\\star}$ 的问题是可解的。这个新问题的相容性条件是：\n$$\n\\iint_{\\Omega} f \\, dA + \\oint_{\\partial\\Omega} (g + \\kappa^{\\star}) \\, ds = 0.\n$$\n利用积分的线性性质，我们可以分离边界积分：\n$$\n\\iint_{\\Omega} f \\, dA + \\oint_{\\partial\\Omega} g \\, ds + \\oint_{\\partial\\Omega} \\kappa^{\\star} \\, ds = 0.\n$$\n因为 $\\kappa^{\\star}$ 是一个常数，所以可以从积分中提出来：\n$$\n\\iint_{\\Omega} f \\, dA + \\oint_{\\partial\\Omega} g \\, ds + \\kappa^{\\star} \\oint_{\\partial\\Omega} ds = 0.\n$$\n求解 $\\kappa^{\\star}$，我们得到：\n$$\n\\kappa^{\\star} = - \\frac{\\iint_{\\Omega} f \\, dA + \\oint_{\\partial\\Omega} g \\, ds}{\\oint_{\\partial\\Omega} ds}.\n$$\n为了求出 $\\kappa^{\\star}$ 的值，我们必须根据给定的数据 $f(x,y) = x$，$g(\\theta) = \\cos\\theta$ 在单位圆盘 $\\Omega$ 上计算这三个积分。\n\n我们来计算域积分 $\\iint_{\\Omega} f \\, dA$。使用极坐标会很方便，其中 $x = r\\cos\\theta$，$y = r\\sin\\theta$，面积元为 $dA = r \\, dr \\, d\\theta$。域 $\\Omega$ 由 $0 \\le r \\le 1$ 和 $0 \\le \\theta  2\\pi$ 描述。\n$$\n\\iint_{\\Omega} f \\, dA = \\iint_{\\Omega} x \\, dA = \\int_{0}^{2\\pi} \\int_{0}^{1} (r\\cos\\theta) \\, r \\, dr \\, d\\theta.\n$$\n我们可以分离积分：\n$$\n\\iint_{\\Omega} x \\, dA = \\left( \\int_{0}^{1} r^2 \\, dr \\right) \\left( \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta \\right).\n$$\n关于 $r$ 的积分是 $\\int_{0}^{1} r^2 \\, dr = \\left[ \\frac{r^3}{3} \\right]_{0}^{1} = \\frac{1}{3}$。\n关于 $\\theta$ 的积分是 $\\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta = [\\sin\\theta]_{0}^{2\\pi} = \\sin(2\\pi) - \\sin(0) = 0 - 0 = 0$。\n因此，域积分是 $\\iint_{\\Omega} f \\, dA = \\frac{1}{3} \\times 0 = 0$。这个结果也可以通过域 $\\Omega$ 关于 $y$ 轴的对称性以及被积函数 $f(x,y)=x$ 是 $x$ 的奇函数来推断。\n\n接下来，我们计算边界积分 $\\oint_{\\partial\\Omega} g \\, ds$。边界 $\\partial\\Omega$ 是单位圆，$r=1$。弧长元是 $ds = r \\, d\\theta = 1 \\cdot d\\theta = d\\theta$。函数 $g$ 给出为 $g(\\theta) = \\cos\\theta$。\n$$\n\\oint_{\\partial\\Omega} g \\, ds = \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta.\n$$\n如前所算，这个积分是 $0$。\n\n最后，我们计算积分 $\\oint_{\\partial\\Omega} ds$。这个积分仅表示边界的总弧长，也就是单位圆的周长。\n$$\n\\oint_{\\partial\\Omega} ds = 2\\pi r \\bigg|_{r=1} = 2\\pi.\n$$\n\n现在我们将这些值代入 $\\kappa^{\\star}$ 的表达式中：\n$$\n\\kappa^{\\star} = - \\frac{0 + 0}{2\\pi} = - \\frac{0}{2\\pi} = 0.\n$$\n结果 $\\kappa^{\\star}=0$ 表明，原始的 $g(\\theta)=\\cos\\theta$ 问题已经满足相容性条件，因此不需要对边界数据进行调整即可存在解。“最小侵入性调整”就是加上零。", "answer": "$$\\boxed{0}$$", "id": "3457511"}, {"introduction": "理论的正确性必须通过实践来检验。在编写数值代码时，如何确保其实现是正确的？本练习引入了“人造解方法”(Method of Manufactured Solutions, MMS)，这是一种严格验证数值代码准确性的黄金标准([@problem_id:3457485])。你将为一个具有已知精确解的问题实施一个二阶有限差分格式，并通过计算误差和收敛阶来系统地验证你的代码是否达到了理论预期。", "problem": "考虑在区间 $[0,1]$ 上设定的一个一维稳态泊松边值问题，其具有一个制造的光滑精确解。控制方程为一个二阶常微分方程，可被解释为一维偏微分方程，\n$$-u''(x) = f(x), \\quad x \\in [0,1],$$\n同时在左端点施加罗宾边界条件，在右端点施加狄利克雷边界条件，\n$$a\\,u(0) + b\\,u'(0) = c, \\qquad u(1) = u_{\\mathrm{R}},$$\n其中 $a$ 和 $b$ 是给定的非负常数且 $b0$，常数 $c$ 的选择是为了匹配在 $x=0$ 处的制造精确解，而 $u_{\\mathrm{R}}$ 的选择是为了匹配在 $x=1$ 处的制造精确解。需要实现的方法是一个在间距为 $h$ 的均匀网格上的二阶精度有限差分格式，使用一个虚拟点来施加罗宾边界条件，从而使 $u'(0)$ 的中心差分近似保持二阶精度。目标是使用制造解方法（MMS）来验证观测到的精度阶。\n\n从以下符合上下文的基本概念出发：\n- 二阶导数的定义及其在均匀网格上的有限差分近似：对于内部网格点 $x_i = i h$（其中 $h = 1/N$，$i$为整数），$-u''(x_i)$ 的中心有限差分近似为\n$$\\frac{2\\,u_i - u_{i-1} - u_{i+1}}{h^2},$$\n其中 $u_i \\approx u(x_i)$ 表示在网格点 $x_i$ 处对精确解 $u(x)$ 的数值近似。\n- 制造解方法（MMS）：选择一个光滑的精确解 $u(x)$，计算 $f(x)$ 和边界数据，使得该精确解满足边值问题，然后进行离散化，并将数值解与精确解进行比较，以测量误差并推断观测到的精度阶。\n\n您必须实现以下步骤，不得使用简化公式，也不得提供中间目标表达式：\n1. 选择制造精确解\n$$u(x) = e^{x} + \\sin(2\\pi x),$$\n解析地计算导数 $u'(x)$ 和二阶导数 $u''(x)$，并通过下式定义源项\n$$f(x) = -u''(x).$$\n2. 根据精确解设置边界数据：\n$$c = a\\,u(0) + b\\,u'(0), \\qquad u_{\\mathrm{R}} = u(1).$$\n3. 用均匀网格 $x_i = i h$（$i = 0,1,\\dots,N$，$h=1/N$）离散化定义域。为未知数 $\\{u_i\\}_{i=0}^{N-1}$ 组装一个二阶精度的有限差分系统，通过将 $u_N = u_{\\mathrm{R}}$ 并入最后一个方程的右侧来施加 $x=1$ 处的狄利克雷边界，并使用虚拟点 $u_{-1}$ 以及 $u'(0)$ 的二阶中心差分近似\n$$u'(0) \\approx \\frac{u_1 - u_{-1}}{2h},$$\n来施加 $x=0$ 处的罗宾边界，并通过罗宾边界条件消去虚拟值 $u_{-1}$，以生成一个仅涉及未知数 $u_0$ 和 $u_1$ 的线性方程。\n4. 通过直接三对角求解器求解所得的三对角线性系统，以获得网格点 $\\{x_i\\}_{i=0}^{N-1}$ 处的数值解。\n5. 计算网格点 $\\{x_i\\}_{i=0}^{N-1}$ 上数值解与精确解之间的误差，并测量两种范数：\n   - 离散 $L^2$ 范数\n   $$\\|e\\|_{L^2,h} = \\left( h \\sum_{i=0}^{N-1} \\left|u_i - u(x_i)\\right|^2 \\right)^{1/2},$$\n   - 离散 $L^{\\infty}$ 范数\n   $$\\|e\\|_{L^{\\infty},h} = \\max_{0 \\le i \\le N-1} \\left|u_i - u(x_i)\\right|.$$\n6. 使用网格间距为 $\\{h_k\\}$ 的多次网格细化，通过对 $\\log(\\|e\\|)$ 与 $\\log(h)$ 进行线性回归来拟合模型 $\\|e\\| \\approx C h^p$，从而估计每种范数下的观测精度阶 $p$。\n\n设计一个测试套件，涵盖一般情况、极限情况和刚性罗宾情况：\n- 情况 1：$a = 1.3$, $b = 0.7$, 网格细化 $N \\in \\{32, 64, 128, 256\\}$。\n- 情况 2（$x=0$ 处为纯诺伊曼条件）：$a = 0.0$, $b = 1.0$, 网格细化 $N \\in \\{32, 64, 128, 256\\}$。\n- 情况 3（刚性罗宾条件）：$a = 10.0$, $b = 0.5$, 网格细化 $N \\in \\{32, 64, 128, 256\\}$。\n\n对于每种情况，计算离散 $L^2$ 范数和离散 $L^{\\infty}$ 范数下的观测精度阶，并将每个观测阶数四舍五入到小数点后3位。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身必须是该用例下 $\\left[p_{L^2}, p_{L^{\\infty}}\\right]$ 顺序的双元素列表。例如，输出格式必须为\n$$[\\,[p_{L^2}^{(1)},p_{L^{\\infty}}^{(1)}],\\,[p_{L^2}^{(2)},p_{L^{\\infty}}^{(2)}],\\,[p_{L^2}^{(3)},p_{L^{\\infty}}^{(3)}]\\,].$$\n问题中不涉及物理单位，也没有出现角度。所有数值都必须以无量纲量的形式给出。每个测试用例的最终答案必须是按规定四舍五入到三位小数的实数。", "solution": "该问题要求实现一个二阶精度的有限差分方法，以求解一维泊松边值问题，并使用制造解方法（MMS）来验证数值格式的精度阶。该问题是良定的，并且基于标准的数值分析原理。\n\n控制方程是在定义域 $x \\in [0,1]$ 上的一维泊松方程：\n$$-u''(x) = f(x)$$\n该方程受限于左端点（$x=0$）的罗宾边界条件和右端点（$x=1$）的狄利克雷边界条件：\n$$a\\,u(0) + b\\,u'(0) = c, \\qquad u(1) = u_{\\mathrm{R}}$$\n这里，$a \\ge 0$ 和 $b  0$ 是给定的常数。\n\n步骤 1：制造解与源项\n制造解方法始于假设一个光滑的精确解。根据题目要求，我们选择：\n$$u(x) = e^{x} + \\sin(2\\pi x)$$\n该函数的一阶和二阶导数通过解析计算得出：\n$$u'(x) = \\frac{d}{dx} \\left( e^{x} + \\sin(2\\pi x) \\right) = e^{x} + 2\\pi\\cos(2\\pi x)$$\n$$u''(x) = \\frac{d^2}{dx^2} \\left( e^{x} + \\sin(2\\pi x) \\right) = e^{x} - (2\\pi)^2\\sin(2\\pi x) = e^{x} - 4\\pi^2\\sin(2\\pi x)$$\n然后，通过将 $u''(x)$ 代入控制方程来确定源项 $f(x)$，以确保我们选择的 $u(x)$ 确实是一个解：\n$$f(x) = -u''(x) = -e^{x} + 4\\pi^2\\sin(2\\pi x)$$\n\n步骤 2：边界数据\n边界数据常数 $c$ 和 $u_{\\mathrm{R}}$ 是通过强制让制造解满足边界条件来确定的。\n在左边界 $x=0$ 处：\n$$u(0) = e^0 + \\sin(0) = 1$$\n$$u'(0) = e^0 + 2\\pi\\cos(0) = 1 + 2\\pi$$\n因此，$c$ 的值是给定参数 $a$ 和 $b$ 的函数：\n$$c = a\\,u(0) + b\\,u'(0) = a(1) + b(1 + 2\\pi) = a + b(1+2\\pi)$$\n在右边界 $x=1$ 处：\n$$u(1) = e^1 + \\sin(2\\pi) = e$$\n因此，狄利克雷值 $u_{\\mathrm{R}}$ 为：\n$$u_{\\mathrm{R}} = u(1) = e$$\n\n步骤 3：有限差分離散化\n将定义域 $[0,1]$ 离散化为均匀网格，网格点为 $x_i = ih$，其中 $i=0, 1, \\dots, N$，$h=1/N$ 是网格间距。我们的目标是求解在节点 $i=0, 1, \\dots, N-1$ 处未知量的数值近似 $u_i \\approx u(x_i)$。\n\n对于任意内部网格点 $x_i$（其中 $i \\in \\{1, 2, \\dots, N-2\\}$），二阶导数 $-u''(x_i)$ 使用二阶中心差分公式进行近似：\n$$-u''(x_i) \\approx \\frac{-u_{i-1} + 2u_i - u_{i+1}}{h^2} = f(x_i)$$\n这给出了每个内部节点的方程：\n$$-u_{i-1} + 2u_i - u_{i+1} = h^2 f(x_i)$$\n\n在右边界，对于节点 $x_{N-1}$，有限差分方程包含了已知的狄利克雷值 $u_N=u_{\\mathrm{R}}$：\n$$\\frac{-u_{N-2} + 2u_{N-1} - u_N}{h^2} = f(x_{N-1})$$\n重新整理，将已知量移到右侧，得到：\n$$-u_{N-2} + 2u_{N-1} = h^2 f(x_{N-1}) + u_{\\mathrm{R}}$$\n\n在左边界 $x_0=0$ 处，我们使用位于 $x_{-1} = -h$ 的虚拟点来保持二阶精度。在 $x_0$ 处的离散化偏微分方程为：\n$$\\frac{-u_{-1} + 2u_0 - u_1}{h^2} = f(x_0)$$\n罗宾条件中的导数 $u'(0)$ 也使用包含虚拟点的二阶中心差分进行近似：\n$$u'(0) \\approx \\frac{u_1 - u_{-1}}{2h}$$\n将其代入罗宾边界条件 $a u_0 + b u'(0) = c$ 中，得到：\n$$a u_0 + b \\left(\\frac{u_1 - u_{-1}}{2h}\\right) = c$$\n虚拟值 $u_{-1}$ 是一个人为产物，必须被消去。我们对边界条件方程求解 $u_{-1}$：\n$$u_{-1} = u_1 - \\frac{2h}{b}(c - a u_0)$$\n将 $u_{-1}$ 的这个表达式代入 $x_0$ 处的离散化偏微分方程，得到：\n$$\\frac{-(u_1 - \\frac{2h}{b}(c - a u_0)) + 2u_0 - u_1}{h^2} = f(x_0)$$\n两边乘以 $h^2$ 并化简：\n$$ -u_1 + \\frac{2h}{b}(c - a u_0) + 2u_0 - u_1 = h^2 f(x_0)$$\n$$ -2u_1 - \\frac{2ha}{b}u_0 + 2u_0 = h^2 f(x_0) - \\frac{2h}{b}c $$\n最后，我们将包含未知数 $u_0$ 和 $u_1$ 的项组合到左侧，得到我们线性系统的第一个方程：\n$$\\left(2 - \\frac{2ha}{b}\\right)u_0 - 2u_1 = h^2 f(x_0) - \\frac{2h}{b}c$$\n\n步骤 4：线性系统的组装与求解\n关于 $N$ 个未知数 $\\vec{U} = [u_0, u_1, \\dots, u_{N-1}]^T$ 的 $N$ 个线性方程构成一个矩阵系统 $A\\vec{U} = \\vec{d}$。矩阵 $A$ 是一个 $N \\times N$ 的三对角矩阵，$\\vec{d}$ 是大小为 $N$ 的右端向量。\n矩阵 $A$ 的非零元素为：\n主对角线：对于 $i=1, \\dots, N-1$，有 $A_{ii} = 2$，以及 $A_{00} = 2 - \\frac{2ha}{b}$。\n次对角线：对于 $i=1, \\dots, N-1$，有 $A_{i,i-1} = -1$。\n超对角线：对于 $i=1, \\dots, N-2$，有 $A_{i,i+1} = -1$，以及 $A_{0,1} = -2$。\n\n右端向量 $\\vec{d}$ 的分量为：\n$d_0 = h^2 f(x_0) - \\frac{2h}{b}c$。\n$d_i = h^2 f(x_i)$，其中 $i=1, \\dots, N-2$。\n$d_{N-1} = h^2 f(x_{N-1}) + u_{\\mathrm{R}}$。\n\n使用专门针对带状矩阵的直接求解器对该三对角系统进行数值求解，以得到向量 $\\vec{U}$。\n\n步骤 5 和 6：误差计算与精度阶\n在获得数值解 $\\{u_i\\}_{i=0}^{N-1}$ 后，计算每个网格点处的误差为 $e_i = u_i - u(x_i)$。误差的大小使用两种离散范数来量化：\n离散 $L^2$ 范数：$\\|e\\|_{L^2,h} = \\left( h \\sum_{i=0}^{N-1} |e_i|^2 \\right)^{1/2}$。\n离散 $L^{\\infty}$ 范数：$\\|e\\|_{L^{\\infty},h} = \\max_{0 \\le i \\le N-1} |e_i|$。\n\n数值方法的理论精度阶 $p$ 意味着当网格间距 $h \\to 0$ 时，对于某个常数 $C$，误差范数的缩放关系为 $\\|e\\| \\approx C h^p$。取对数后得到一个线性关系：$\\log(\\|e\\|) \\approx \\log(C) + p \\log(h)$。因此，精度阶 $p$ 可以通过对一系列网格细化 $h_k = 1/N_k$ 生成的数据点 $(\\log(h_k), \\log(\\|e\\|_k))$ 进行线性拟合，估计为拟合直线的斜率。对问题中指定的三个测试用例中的每一个都重复此过程。", "answer": "[[2.000, 2.000], [2.000, 2.000], [2.000, 2.000]]", "id": "3457485"}]}