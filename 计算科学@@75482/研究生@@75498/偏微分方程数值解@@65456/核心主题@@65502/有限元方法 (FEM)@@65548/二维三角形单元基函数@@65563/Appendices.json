{"hands_on_practices": [{"introduction": "在二维三角单元上构建有限元方法，其核心在于使用一套合适的基函数。重心坐标（Barycentric coordinates）构成了最基本的线性拉格朗日单元的基石。本练习旨在将重心坐标的抽象定义与其直观的几何意义联系起来，通过计算子三角形面积与总面积之比来确定一个点的重心坐标，从而将理论付诸实践。", "problem": "考虑一个二维非退化三角形，其顶点为 $\\boldsymbol{x}_1=(1,2)$、$\\boldsymbol{x}_2=(4,3)$ 和 $\\boldsymbol{x}_3=(2,7)$。在有限元法 (FEM) 的线性拉格朗日有限元设置中，点 $\\boldsymbol{x}=(2.5,3.5)$ 相对于有序顶点 $\\{\\boldsymbol{x}_1,\\boldsymbol{x}_2,\\boldsymbol{x}_3\\}$ 的重心坐标 $\\lambda_1$、$\\lambda_2$ 和 $\\lambda_3$ 是满足节点条件 $\\lambda_i(\\boldsymbol{x}_j)=\\delta_{ij}$ 和单位分解约束 $\\lambda_1+\\lambda_2+\\lambda_3=1$ 的唯一仿射函数。仅从这些定义性质和“三角形面积等于底乘以相应高的一半”这一基本几何事实出发，通过将原始三角形划分为由点 $\\boldsymbol{x}$ 和各边形成的三个子三角形来计算重心坐标，并通过将其直接代入定义关系式（即 $\\lambda_1+\\lambda_2+\\lambda_3=1$ 和 $\\boldsymbol{x}=\\lambda_1\\boldsymbol{x}_1+\\lambda_2\\boldsymbol{x}_2+\\lambda_3\\boldsymbol{x}_3$）来验证其正确性。将最终答案表示为按 $(\\lambda_1,\\lambda_2,\\lambda_3)$ 顺序排列的三个重心坐标的行矩阵。无需四舍五入，不涉及单位。", "solution": "首先评估问题的有效性。\n**步骤 1：提取已知条件**\n- 三角形顶点：$\\boldsymbol{x}_1=(1,2)$、$\\boldsymbol{x}_2=(4,3)$、$\\boldsymbol{x}_3=(2,7)$。\n- 三角形被指定为非退化的。\n- 一个点 $\\boldsymbol{x}=(2.5,3.5)$。\n- 重心坐标 $\\lambda_1, \\lambda_2, \\lambda_3$ 被定义为满足以下条件的唯一仿射函数：\n  1. 节点条件：$\\lambda_i(\\boldsymbol{x}_j)=\\delta_{ij}$。\n  2. 单位分解：$\\lambda_1+\\lambda_2+\\lambda_3=1$。\n- 计算必须通过将重心坐标与由点 $\\boldsymbol{x}$ 和主三角形顶点形成的子三角形的面积相关联来进行。\n- 以面积的几何定义“底乘以高的一半”为出发点。\n- 必须通过确认单位分解和仿射组合 $\\boldsymbol{x}=\\lambda_1\\boldsymbol{x}_1+\\lambda_2\\boldsymbol{x}_2+\\lambda_3\\boldsymbol{x}_3$ 来验证结果。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。它提出了一个计算几何和有限元分析中的标准问题。所有必要数据均已提供，且定义与既定的数学原理一致。使用面积的几何定义的约束是一个教学上的要求，它导向重心坐标的标准面积比定义。该问题没有任何逻辑缺陷、歧义或矛盾。使用行列式公式快速检查主三角形的面积，$\\frac{1}{2} |1(3-7) + 4(7-2) + 2(2-3)| = \\frac{1}{2} |-4 + 20 - 2| = \\frac{14}{2} = 7$，确认面积非零，因此该三角形确实如所述为非退化的。\n\n**步骤 3：结论与行动**\n问题有效。将提供严谨的解答。\n\n**求解推导**\n一个点 $\\boldsymbol{x}$ 相对于三角形 $T$ 的顶点 $(\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3)$ 的重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 由各子三角形面积与主三角形面积之比给出。具体来说，如果 $A$ 是由顶点 $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3$ 构成的三角形 $T$ 的面积，而 $A_1, A_2, A_3$ 分别是由顶点 $(\\boldsymbol{x}, \\boldsymbol{x}_2, \\boldsymbol{x}_3)$、$(\\boldsymbol{x}_1, \\boldsymbol{x}, \\boldsymbol{x}_3)$ 和 $(\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x})$ 构成的子三角形的面积，那么重心坐标定义为：\n$$ \\lambda_1 = \\frac{A_1}{A}, \\quad \\lambda_2 = \\frac{A_2}{A}, \\quad \\lambda_3 = \\frac{A_3}{A} $$\n这个定义隐含地满足单位分解，$\\sum \\lambda_i = \\frac{A_1+A_2+A_3}{A} = \\frac{A}{A}=1$，前提是点 $\\boldsymbol{x}$ 在三角形 $T$ 内部。\n\n问题要求从面积的几何定义出发。一个从此原理推导出的计算高效的方法是使用行列式（或鞋带）公式。由按逆时针顺序排列的顶点 $(x_a, y_a)$、$(x_b, y_b)$ 和 $(x_c, y_c)$ 构成的三角形的有向面积由以下公式给出：\n$$ \\text{Area} = \\frac{1}{2} \\det \\begin{pmatrix} x_a  y_a  1 \\\\ x_b  y_b  1 \\\\ x_c  y_c  1 \\end{pmatrix} = \\frac{1}{2} [x_a(y_b - y_c) + x_b(y_c - y_a) + x_c(y_a - y_b)] $$\n这是从顶点坐标计算面积的直接代数形式化。\n\n给定的顶点是 $\\boldsymbol{x}_1=(1,2)$、$\\boldsymbol{x}_2=(4,3)$ 和 $\\boldsymbol{x}_3=(2,7)$。点是 $\\boldsymbol{x}=(2.5,3.5)$，可以写成 $(\\frac{5}{2}, \\frac{7}{2})$。\n\n首先，我们计算由 $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3$ 定义的三角形 $T$ 的总面积 $A$。\n$$ A = \\frac{1}{2} \\left| \\det \\begin{pmatrix} 1  2  1 \\\\ 4  3  1 \\\\ 2  7  1 \\end{pmatrix} \\right| $$\n行列式的值是 $1(3 \\cdot 1 - 7 \\cdot 1) - 2(4 \\cdot 1 - 2 \\cdot 1) + 1(4 \\cdot 7 - 2 \\cdot 3) = 1(3-7) - 2(4-2) + 1(28-6) = -4 - 2(2) + 22 = -4-4+22 = 14$。\n由于行列式为正，顶点是按逆时针顺序排列的。面积为 $A = \\frac{1}{2}(14) = 7$。\n\n接下来，我们计算由顶点 $\\boldsymbol{x}, \\boldsymbol{x}_2, \\boldsymbol{x}_3$ 构成的子三角形的面积 $A_1$。\n$$ A_1 = \\frac{1}{2} \\det \\begin{pmatrix} 2.5  3.5  1 \\\\ 4  3  1 \\\\ 2  7  1 \\end{pmatrix} = \\frac{1}{2} [2.5(3-7) - 3.5(4-2) + 1(28-6)] $$\n$$ A_1 = \\frac{1}{2} [2.5(-4) - 3.5(2) + 22] = \\frac{1}{2}[-10 - 7 + 22] = \\frac{1}{2}(5) = 2.5 = \\frac{5}{2} $$\n因此，$\\lambda_1 = \\frac{A_1}{A} = \\frac{2.5}{7} = \\frac{5/2}{7} = \\frac{5}{14}$。\n\n接下来，我们计算由顶点 $\\boldsymbol{x}_1, \\boldsymbol{x}, \\boldsymbol{x}_3$ 构成的子三角形的面积 $A_2$。\n$$ A_2 = \\frac{1}{2} \\det \\begin{pmatrix} 1  2  1 \\\\ 2.5  3.5  1 \\\\ 2  7  1 \\end{pmatrix} = \\frac{1}{2} [1(3.5-7) - 2(2.5-2) + 1(17.5-7)] $$\n$$ A_2 = \\frac{1}{2} [-3.5 - 2(0.5) + 10.5] = \\frac{1}{2}[-3.5 - 1 + 10.5] = \\frac{1}{2}(6) = 3 $$\n因此，$\\lambda_2 = \\frac{A_2}{A} = \\frac{3}{7}$。\n\n最后，我们计算由顶点 $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}$ 构成的子三角形的面积 $A_3$。\n$$ A_3 = \\frac{1}{2} \\det \\begin{pmatrix} 1  2  1 \\\\ 4  3  1 \\\\ 2.5  3.5  1 \\end{pmatrix} = \\frac{1}{2} [1(3-3.5) - 2(4-2.5) + 1(14-7.5)] $$\n$$ A_3 = \\frac{1}{2} [-0.5 - 2(1.5) + 6.5] = \\frac{1}{2}[-0.5 - 3 + 6.5] = \\frac{1}{2}(3) = 1.5 = \\frac{3}{2} $$\n因此，$\\lambda_3 = \\frac{A_3}{A} = \\frac{1.5}{7} = \\frac{3/2}{7} = \\frac{3}{14}$。\n\n计算出的重心坐标为 $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{5}{14}, \\frac{3}{7}, \\frac{3}{14})$。\n\n**验证**\n我们根据给定的两个条件来验证结果。\n1. 单位分解：\n$$ \\lambda_1 + \\lambda_2 + \\lambda_3 = \\frac{5}{14} + \\frac{3}{7} + \\frac{3}{14} = \\frac{5}{14} + \\frac{6}{14} + \\frac{3}{14} = \\frac{5+6+3}{14} = \\frac{14}{14} = 1 $$\n该条件满足。\n\n2. 仿射组合：\n我们必须检查是否 $\\boldsymbol{x} = \\lambda_1\\boldsymbol{x}_1+\\lambda_2\\boldsymbol{x}_2+\\lambda_3\\boldsymbol{x}_3$。\n等式右边是：\n$$ \\frac{5}{14}(1,2) + \\frac{3}{7}(4,3) + \\frac{3}{14}(2,7) = \\frac{5}{14}(1,2) + \\frac{6}{14}(4,3) + \\frac{3}{14}(2,7) $$\n对于 x 坐标：\n$$ \\frac{1}{14}(5 \\cdot 1 + 6 \\cdot 4 + 3 \\cdot 2) = \\frac{1}{14}(5 + 24 + 6) = \\frac{35}{14} = \\frac{5}{2} = 2.5 $$\n对于 y 坐标：\n$$ \\frac{1}{14}(5 \\cdot 2 + 6 \\cdot 3 + 3 \\cdot 7) = \\frac{1}{14}(10 + 18 + 21) = \\frac{49}{14} = \\frac{7}{2} = 3.5 $$\n得到的点是 $(2.5, 3.5)$，与给定的点 $\\boldsymbol{x}$ 相等。此条件也满足。\n\n两项检查都证实了所计算的重心坐标的正确性。\n最终答案是坐标集 $(\\lambda_1, \\lambda_2, \\lambda_3)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{14}  \\frac{3}{7}  \\frac{3}{14} \\end{pmatrix}}\n$$", "id": "3458200"}, {"introduction": "为了在有限元分析中获得更高的精度，我们通常会采用高次多项式基函数，例如二次（$P2$）拉格朗日单元。本练习展示了如何利用基本的线性重心坐标来构造这些更高阶的基函数。通过验证二次边基函数在所有节点（包括顶点和边中点）上的取值，您将深入理解其满足克罗内克-德尔塔（Kronecker delta）性质的关键特征，这是确保插值准确性的根本。", "problem": "考虑一个位于 $\\mathbb{R}^{2}$ 中的非退化三角形 $T$，其顶点为 $\\boldsymbol{x}_{1}$、$\\boldsymbol{x}_{2}$ 和 $\\boldsymbol{x}_{3}$。令 $\\lambda_{1}$、$\\lambda_{2}$ 和 $\\lambda_{3}$ 表示 $T$ 上的重心坐标，它们被定义为满足 $\\lambda_{i}(\\boldsymbol{x}_{j}) = \\delta_{ij}$（其中 $i,j \\in \\{1,2,3\\}$）以及在 $T$ 上 $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$ 的唯一仿射函数，$\\delta_{ij}$ 是克罗内克δ。在 $T$ 上的二次拉格朗日有限元空间中，六个插值节点是三角形的顶点和各边的中点：\n$$\n\\boldsymbol{x}_{1},\\quad \\boldsymbol{x}_{2},\\quad \\boldsymbol{x}_{3},\\quad \\frac{\\boldsymbol{x}_{1}+\\boldsymbol{x}_{2}}{2},\\quad \\frac{\\boldsymbol{x}_{2}+\\boldsymbol{x}_{3}}{2},\\quad \\frac{\\boldsymbol{x}_{3}+\\boldsymbol{x}_{1}}{2}.\n$$\n将与边 $(1,2)$ 相关联的候选边基函数定义为 $N_{12}(\\boldsymbol{x}) = 4\\,\\lambda_{1}(\\boldsymbol{x})\\,\\lambda_{2}(\\boldsymbol{x})$。从重心坐标和上述插值节点的基本定义出发，按所列顺序确定 $N_{12}$ 在这六个节点处的值。将最终答案表示为一个单行矩阵。无需进行四舍五入。", "solution": "该问题要求在一个三角形 $T$ 上的六个指定插值节点处，计算候选二次基函数 $N_{12}(\\boldsymbol{x})$ 的值。这些节点包括三个顶点 $\\boldsymbol{x}_{1}, \\boldsymbol{x}_{2}, \\boldsymbol{x}_{3}$ 和三条边的中点。该函数通过重心坐标 $\\lambda_{1}(\\boldsymbol{x})$ 和 $\\lambda_{2}(\\boldsymbol{x})$ 定义为 $N_{12}(\\boldsymbol{x}) = 4\\,\\lambda_{1}(\\boldsymbol{x})\\,\\lambda_{2}(\\boldsymbol{x})$。\n\n计算过程依赖于重心坐标的两个基本性质：\n1.  对于三角形的任意顶点 $\\boldsymbol{x}_{j}$，重心坐标函数 $\\lambda_{i}(\\boldsymbol{x})$ 满足 $\\lambda_{i}(\\boldsymbol{x}_{j}) = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ。这意味着 $\\lambda_{i}$ 在顶点 $\\boldsymbol{x}_{i}$ 处的值为 $1$，在所有其他顶点处的值为 $0$。\n2.  重心坐标是仿射函数。这意味着对于任意两点 $\\boldsymbol{a}、\\boldsymbol{b}$ 和一个标量 $t \\in \\mathbb{R}$，有 $\\lambda_{i}(t\\boldsymbol{a} + (1-t)\\boldsymbol{b}) = t\\lambda_{i}(\\boldsymbol{a}) + (1-t)\\lambda_{i}(\\boldsymbol{b})$。\n\n我们按指定顺序计算 $N_{12}(\\boldsymbol{x})$ 在六个节点上每一个节点的值。\n\n1.  **在顶点 $\\boldsymbol{x}_{1}$ 处**：\n    我们使用性质 $\\lambda_{i}(\\boldsymbol{x}_{j}) = \\delta_{ij}$。相关重心坐标的值为 $\\lambda_{1}(\\boldsymbol{x}_{1}) = 1$ 和 $\\lambda_{2}(\\boldsymbol{x}_{1}) = 0$。\n    因此，该函数的值为：\n    $$N_{12}(\\boldsymbol{x}_{1}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{1})\\,\\lambda_{2}(\\boldsymbol{x}_{1}) = 4 \\cdot 1 \\cdot 0 = 0$$\n\n2.  **在顶点 $\\boldsymbol{x}_{2}$ 处**：\n    重心坐标的值为 $\\lambda_{1}(\\boldsymbol{x}_{2}) = 0$ 和 $\\lambda_{2}(\\boldsymbol{x}_{2}) = 1$。\n    因此，该函数的值为：\n    $$N_{12}(\\boldsymbol{x}_{2}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{2})\\,\\lambda_{2}(\\boldsymbol{x}_{2}) = 4 \\cdot 0 \\cdot 1 = 0$$\n\n3.  **在顶点 $\\boldsymbol{x}_{3}$ 处**：\n    重心坐标的值为 $\\lambda_{1}(\\boldsymbol{x}_{3}) = 0$ 和 $\\lambda_{2}(\\boldsymbol{x}_{3}) = 0$。\n    因此，该函数的值为：\n    $$N_{12}(\\boldsymbol{x}_{3}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{3})\\,\\lambda_{2}(\\boldsymbol{x}_{3}) = 4 \\cdot 0 \\cdot 0 = 0$$\n\n4.  **在边 $(1,2)$ 的中点 $\\boldsymbol{x}_{12} = \\frac{\\boldsymbol{x}_{1}+\\boldsymbol{x}_{2}}{2}$ 处**：\n    我们使用重心坐标的仿射性质，其中 $t = \\frac{1}{2}$，$\\boldsymbol{a} = \\boldsymbol{x}_{1}$，以及 $\\boldsymbol{b} = \\boldsymbol{x}_{2}$。对于 $\\lambda_{1}$：\n    $$\\lambda_{1}(\\boldsymbol{x}_{12}) = \\lambda_{1}\\left(\\frac{1}{2}\\boldsymbol{x}_{1} + \\frac{1}{2}\\boldsymbol{x}_{2}\\right) = \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{1}) + \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{2}) = \\frac{1}{2}(1) + \\frac{1}{2}(0) = \\frac{1}{2}$$\n    对于 $\\lambda_{2}$：\n    $$\\lambda_{2}(\\boldsymbol{x}_{12}) = \\lambda_{2}\\left(\\frac{1}{2}\\boldsymbol{x}_{1} + \\frac{1}{2}\\boldsymbol{x}_{2}\\right) = \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{1}) + \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{2}) = \\frac{1}{2}(0) + \\frac{1}{2}(1) = \\frac{1}{2}$$\n    现在我们可以计算该函数的值：\n    $$N_{12}(\\boldsymbol{x}_{12}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{12})\\,\\lambda_{2}(\\boldsymbol{x}_{12}) = 4 \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} = 1$$\n\n5.  **在边 $(2,3)$ 的中点 $\\boldsymbol{x}_{23} = \\frac{\\boldsymbol{x}_{2}+\\boldsymbol{x}_{3}}{2}$ 处**：\n    使用仿射性质，其中 $\\boldsymbol{a} = \\boldsymbol{x}_{2}$ 和 $\\boldsymbol{b} = \\boldsymbol{x}_{3}$：\n    $$\\lambda_{1}(\\boldsymbol{x}_{23}) = \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{2}) + \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{3}) = \\frac{1}{2}(0) + \\frac{1}{2}(0) = 0$$\n    $$\\lambda_{2}(\\boldsymbol{x}_{23}) = \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{2}) + \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{3}) = \\frac{1}{2}(1) + \\frac{1}{2}(0) = \\frac{1}{2}$$\n    该函数的值为：\n    $$N_{12}(\\boldsymbol{x}_{23}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{23})\\,\\lambda_{2}(\\boldsymbol{x}_{23}) = 4 \\cdot 0 \\cdot \\frac{1}{2} = 0$$\n\n6.  **在边 $(3,1)$ 的中点 $\\boldsymbol{x}_{31} = \\frac{\\boldsymbol{x}_{3}+\\boldsymbol{x}_{1}}{2}$ 处**：\n    使用仿射性质，其中 $\\boldsymbol{a} = \\boldsymbol{x}_{3}$ 和 $\\boldsymbol{b} = \\boldsymbol{x}_{1}$：\n    $$\\lambda_{1}(\\boldsymbol{x}_{31}) = \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{3}) + \\frac{1}{2}\\lambda_{1}(\\boldsymbol{x}_{1}) = \\frac{1}{2}(0) + \\frac{1}{2}(1) = \\frac{1}{2}$$\n    $$\\lambda_{2}(\\boldsymbol{x}_{31}) = \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{3}) + \\frac{1}{2}\\lambda_{2}(\\boldsymbol{x}_{1}) = \\frac{1}{2}(0) + \\frac{1}{2}(0) = 0$$\n    该函数的值为：\n    $$N_{12}(\\boldsymbol{x}_{31}) = 4\\,\\lambda_{1}(\\boldsymbol{x}_{31})\\,\\lambda_{2}(\\boldsymbol{x}_{31}) = 4 \\cdot \\frac{1}{2} \\cdot 0 = 0$$\n\n按所要求的顺序总结结果：\n-   $N_{12}(\\boldsymbol{x}_{1}) = 0$\n-   $N_{12}(\\boldsymbol{x}_{2}) = 0$\n-   $N_{12}(\\boldsymbol{x}_{3}) = 0$\n-   $N_{12}(\\frac{\\boldsymbol{x}_{1}+\\boldsymbol{x}_{2}}{2}) = 1$\n-   $N_{12}(\\frac{\\boldsymbol{x}_{2}+\\boldsymbol{x}_{3}}{2}) = 0$\n-   $N_{12}(\\frac{\\boldsymbol{x}_{3}+\\boldsymbol{x}_{1}}{2}) = 0$\n\n这些值构成了所要求的行矩阵的分量。函数 $N_{12}(\\boldsymbol{x})$ 确实是与边 $(1,2)$ 的中点相关联的二次拉格朗日基函数，因为它在该节点处的值为 $1$，而在所有其他指定节点处的值为 $0$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0  1  0  0 \\end{pmatrix}}\n$$", "id": "3458251"}, {"introduction": "掌握了基函数的理论后，一个关键的进阶是理解它们在实际计算中的应用和挑战。在有限元方法中，刚度矩阵和质量矩阵的积分通常是通过数值求积来近似完成的。本练习模拟了一个真实的计算场景，要求您分析使用低精度求积公式计算质量矩阵时，对拉普拉斯特征值问题解的影响，这个过程在文献中也被称为“变分犯罪”（variational crime）。通过这个实践，您将深刻体会到基函数多项式的阶次与所需数值积分精度的内在联系。", "problem": "考虑在域 $\\Omega = [0,1]^{2}$ 上带有齐次狄利克雷边界条件的拉普拉斯特征值问题 $-\\Delta u = \\lambda u$。使用有限元法（FEM）通过一个由两个三角形组成的协调网格对 $\\Omega$ 进行离散化：$T_{1}$ 的顶点为 $(0,0)$、$(1,0)$、$(0,1)$，$T_{2}$ 的顶点为 $(1,1)$、$(1,0)$、$(0,1)$。使用二次拉格朗日三角形单元（多项式次数为2，记为 $P2$）。在所有边界自由度（位于 $\\partial \\Omega$ 上的所有顶点和边中点）上强制施加狄利克雷边界条件，使得唯一的全局自由度是位于 $(1,0)$ 和 $(0,1)$ 之间内部边的中点。将其全局形函数表示为 $\\varphi$。在任意三角形的重心坐标 $(\\lambda_{1},\\lambda_{2},\\lambda_{3})$ 中，与顶点 $i$ 和 $j$ 之间边关联的 $P2$ 边中点基函数为 $\\phi_{ij} = 4 \\lambda_{i} \\lambda_{j}$。\n\n在这些条件下，离散广义特征问题简化为标量瑞利商\n$$\n\\lambda = \\frac{\\int_{\\Omega} |\\nabla \\varphi|^{2} \\, d\\Omega}{\\int_{\\Omega} \\varphi^{2} \\, d\\Omega}.\n$$\n刚度积分 $\\int_{\\Omega} |\\nabla \\varphi|^{2} \\, d\\Omega$ 是物理坐标系下的一个总次数为 2 的多项式，可以通过任何对次数为 2 的多项式精确的求积法则进行精确积分。质量积分 $\\int_{\\Omega} \\varphi^{2} \\, d\\Omega$ 是物理坐标系下的一个总次数为 4 的多项式，要求至少为 4 次的精确积分。通过将 $T_{1}$ 和 $T_{2}$ 上的每个精确质量积分替换为对称的 2 次三角形求积法则来定义质量的一致性误差，该求积法则使用三个点，其重心坐标为 $(1/6,1/6,2/3)$ 及其循环置换，每个点的权重等于 $A/3$，其中 $A$ 是三角形的面积。\n\n从拉普拉斯特征值问题的弱形式和重心坐标中 $P2$ 三角形基函数的定义出发，推导并计算：\n1. 这个单自由度离散问题的精确特征值 $\\lambda$。\n2. 当质量积分使用指定的 2 次求积法则计算，而刚度积分精确计算时，得到的扰动特征值 $\\tilde{\\lambda}$。\n3. 特征值偏移 $\\delta \\lambda = \\tilde{\\lambda} - \\lambda$。\n\n将 $\\delta \\lambda$ 的最终答案精确表示为一个有理数。不需要四舍五入。", "solution": "用户要求我解决一个涉及有限元法（FEM）求解拉普拉斯特征值问题的问题。\n\n### 第一步：提取已知条件\n- **问题**：在域 $\\Omega = [0,1]^2$ 上的拉普拉斯特征值问题 $-\\Delta u = \\lambda u$。\n- **边界条件**：在 $\\partial\\Omega$ 上的齐次狄利克雷边界条件。\n- **离散化**：一个由两个三角形组成的协调网格：\n    - $T_1$ 的顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$。\n    - $T_2$ 的顶点为 $(1,1)$、$(1,0)$ 和 $(0,1)$。\n- **单元类型**：二次拉格朗日三角形单元（$P2$，多项式次数为2）。\n- **自由度（DOFs）**：所有边界自由度均设为零。唯一的全局自由度位于 $(1,0)$ 和 $(0,1)$ 之间内部边的中点。其全局形函数为 $\\varphi$。\n- **基函数定义**：在重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 中，与顶点 $i$ 和 $j$ 之间边关联的 $P2$ 边中点基函数为 $\\phi_{ij} = 4\\lambda_i\\lambda_j$。\n- **特征值计算**：离散问题简化为标量瑞利商：$\\lambda = \\frac{\\int_{\\Omega} |\\nabla \\varphi|^2 \\, d\\Omega}{\\int_{\\Omega} \\varphi^2 \\, d\\Omega}$。\n- **数值积分**：\n    - **刚度**：刚度积分 $\\int_{\\Omega} |\\nabla \\varphi|^2 \\, d\\Omega$ 将被精确计算。\n    - **质量**：精确质量积分 $\\int_{\\Omega} \\varphi^2 \\, d\\Omega$ 将与一个近似质量积分进行比较。\n    - **求积法则**：近似质量积分在每个单元上使用对称的 2 次三角形求积法则计算。\n        - 点：重心坐标 $(1/6, 1/6, 2/3)$ 及其循环置换。\n        - 权重：每个点权重为 $A/3$，其中 $A$ 是三角形的面积。\n- **任务**：\n    1. 计算精确特征值 $\\lambda$。\n    2. 使用指定的求积法则计算质量积分，得到扰动特征值 $\\tilde{\\lambda}$。\n    3. 计算特征值偏移 $\\delta\\lambda = \\tilde{\\lambda} - \\lambda$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，是有限元法在经典偏微分方程上的标准应用。问题是适定的，具有清晰的域、网格、基函数和单一自由度，从而得到唯一的离散特征值。问题是客观的，所有术语都定义明确。使用数值求积并分析其对计算特征值的影响（这一概念被称为“变分犯罪”）是数值分析中的一个标准课题。设置是完整且内部一致的。\n\n### 第三步：判断和行动\n问题有效。我将继续进行求解。\n\n###\n求解需要计算单个自由度的刚度矩阵项 $A_{11} = \\int_{\\Omega} |\\nabla \\varphi|^2 \\, d\\Omega$ 和质量矩阵项 $M_{11} = \\int_{\\Omega} \\varphi^2 \\, d\\Omega$。由于这是一个 $1 \\times 1$ 系统，我们用标量 $A$ 和 $M$ 来表示它们。域 $\\Omega$ 是两个三角形 $T_1$ 和 $T_2$ 的并集。全局基函数 $\\varphi$ 在两个三角形上都非零。我们可以将积分写成单元上的和：\n$A = \\int_{T_1} |\\nabla \\varphi|^2 \\, dA + \\int_{T_2} |\\nabla \\varphi|^2 \\, dA$。\n$M = \\int_{T_1} \\varphi^2 \\, dA + \\int_{T_2} \\varphi^2 \\, dA$。\n\n**1. 在每个三角形上定义基函数**\n\n**在三角形 $T_1$ 上：**\n顶点为 $V_1=(0,0)$、$V_2=(1,0)$ 和 $V_3=(0,1)$。自由度位于 $V_2$ 和 $V_3$ 之间的边上。因此，局部基函数为 $\\varphi_1 = 4\\lambda_2\\lambda_3$。\n在 $T_1$ 上的重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 与笛卡尔坐标 $(x,y)$ 的关系如下：\n$(x,y) = \\lambda_1(0,0) + \\lambda_2(1,0) + \\lambda_3(0,1) = (\\lambda_2, \\lambda_3)$。\n所以，$\\lambda_2=x$ 且 $\\lambda_3=y$。条件 $\\lambda_1+\\lambda_2+\\lambda_3=1$ 给出 $\\lambda_1=1-x-y$。\n在笛卡尔坐标系中，$T_1$ 上的基函数为 $\\varphi_1(x,y) = 4xy$。\n\n**在三角形 $T_2$ 上：**\n顶点为 $(1,1)$、$(1,0)$、$(0,1)$。我们将其标记为 $V_1'=(1,1)$、$V_2'=(1,0)$、$V_3'=(0,1)$。自由度位于 $V_2'$ 和 $V_3'$ 之间的边上。局部基函数为 $\\varphi_2 = 4\\lambda_2'\\lambda_3'$，其中 $\\lambda_i'$ 是 $T_2$ 的重心坐标。\n与笛卡尔坐标的关系为：\n$(x,y) = \\lambda_1'(1,1) + \\lambda_2'(1,0) + \\lambda_3'(0,1) = (\\lambda_1'+\\lambda_2', \\lambda_1'+\\lambda_3')$。\n根据 $\\lambda_1'+\\lambda_2'+\\lambda_3'=1$，我们求解 $\\lambda_i'$：$\\lambda_1' = x+y-1$，$\\lambda_2' = 1-y$，$\\lambda_3' = 1-x$。\n在笛卡尔坐标系中，$T_2$ 上的基函数为 $\\varphi_2(x,y) = 4(1-y)(1-x)$。\n\n**2. 计算精确刚度积分 $A$**\n\n**在 $T_1$ 上：**\n$\\varphi_1 = 4xy \\implies \\nabla\\varphi_1 = (4y, 4x)$。\n$|\\nabla\\varphi_1|^2 = 16(y^2+x^2)$。\n$T_1$ 的积分域为 $0 \\le x \\le 1$ 和 $0 \\le y \\le 1-x$。\n$\\int_{T_1} |\\nabla\\varphi_1|^2 dA = 16 \\int_0^1 \\int_0^{1-x} (x^2+y^2) \\,dy\\,dx = 16 \\int_0^1 \\left[x^2y + \\frac{y^3}{3}\\right]_0^{1-x} dx$\n$= 16 \\int_0^1 \\left(x^2(1-x) + \\frac{(1-x)^3}{3}\\right) dx = 16 \\left(\\int_0^1 (x^2-x^3)dx + \\frac{1}{3}\\int_0^1(1-x)^3 dx\\right)$\n$= 16 \\left( \\left[\\frac{x^3}{3}-\\frac{x^4}{4}\\right]_0^1 + \\frac{1}{3}\\left[-\\frac{(1-x)^4}{4}\\right]_0^1 \\right) = 16 \\left( \\left(\\frac{1}{3}-\\frac{1}{4}\\right) + \\frac{1}{3}\\left(0 - (-\\frac{1}{4})\\right) \\right)$\n$= 16 \\left(\\frac{1}{12} + \\frac{1}{12}\\right) = 16 \\left(\\frac{2}{12}\\right) = \\frac{16}{6} = \\frac{8}{3}$。\n\n**在 $T_2$ 上：**\n$\\varphi_2 = 4(1-x)(1-y) \\implies \\nabla\\varphi_2 = (-4(1-y), -4(1-x))$。\n$|\\nabla\\varphi_2|^2 = 16((1-y)^2 + (1-x)^2)$。\n$T_2$ 的积分域由 $x+y \\ge 1$、$x \\le 1$、$y \\le 1$ 定义。通过对称变换 $x' = 1-x$，$y' = 1-y$，该积分与 $T_1$ 上的积分相同。\n$\\int_{T_2} |\\nabla\\varphi_2|^2 dA = \\frac{8}{3}$。\n\n**总刚度：**\n$A = \\frac{8}{3} + \\frac{8}{3} = \\frac{16}{3}$。\n\n**3. 计算精确质量积分 $M$**\n\n**在 $T_1$ 上：**\n$\\varphi_1^2 = (4xy)^2 = 16x^2y^2$。\n$\\int_{T_1} \\varphi_1^2 dA = 16 \\int_0^1 \\int_0^{1-x} x^2y^2 \\,dy\\,dx = 16 \\int_0^1 x^2 \\left[\\frac{y^3}{3}\\right]_0^{1-x} dx = \\frac{16}{3} \\int_0^1 x^2(1-x)^3 dx$。\n使用贝塔函数，$\\int_0^1 t^a(1-t)^b dt = \\frac{a!b!}{(a+b+1)!}$：\n$\\int_0^1 x^2(1-x)^3 dx = \\frac{2!3!}{(2+3+1)!} = \\frac{2 \\cdot 6}{6!} = \\frac{12}{720} = \\frac{1}{60}$。\n所以，$\\int_{T_1} \\varphi_1^2 dA = \\frac{16}{3} \\cdot \\frac{1}{60} = \\frac{16}{180} = \\frac{4}{45}$。\n\n**在 $T_2$ 上：**\n$\\varphi_2^2 = 16(1-x)^2(1-y)^2$。根据对称性，该积分与 $T_1$ 上的积分相同。\n$\\int_{T_2} \\varphi_2^2 dA = \\frac{4}{45}$。\n\n**总质量：**\n$M = \\frac{4}{45} + \\frac{4}{45} = \\frac{8}{45}$。\n\n**4. 计算精确特征值 $\\lambda$**\n$\\lambda = \\frac{A}{M} = \\frac{16/3}{8/45} = \\frac{16}{3} \\times \\frac{45}{8} = 2 \\times 15 = 30$。\n\n**5. 计算近似质量积分 $\\tilde{M}$**\n求积法则为 $\\int_T f dA \\approx \\frac{\\text{Area}(T)}{3} \\sum_{k=1}^3 f(q_k)$。\n求积点的重心坐标为 $q_1 = (1/6, 1/6, 2/3)$、$q_2 = (2/3, 1/6, 1/6)$ 和 $q_3 = (1/6, 2/3, 1/6)$。每个三角形的面积为 $A_1 = A_2 = 1/2$。\n\n**在 $T_1$ 上：**\n被积函数为 $\\varphi_1^2 = 16\\lambda_2^2\\lambda_3^2$。\n- $f(q_1) = 16 (\\lambda_2(q_1))^2(\\lambda_3(q_1))^2 = 16(1/6)^2(2/3)^2 = 16 \\cdot \\frac{1}{36} \\cdot \\frac{4}{9} = \\frac{64}{324} = \\frac{16}{81}$。\n- $f(q_2) = 16 (\\lambda_2(q_2))^2(\\lambda_3(q_2))^2 = 16(1/6)^2(1/6)^2 = 16 \\cdot \\frac{1}{1296} = \\frac{1}{81}$。\n- $f(q_3) = 16 (\\lambda_2(q_3))^2(\\lambda_3(q_3))^2 = 16(2/3)^2(1/6)^2 = 16 \\cdot \\frac{4}{9} \\cdot \\frac{1}{36} = \\frac{64}{324} = \\frac{16}{81}$。\n$\\tilde{M}_1 = \\frac{A_1}{3} (f(q_1)+f(q_2)+f(q_3)) = \\frac{1/2}{3} \\left(\\frac{16}{81} + \\frac{1}{81} + \\frac{16}{81}\\right) = \\frac{1}{6} \\frac{33}{81} = \\frac{1}{6} \\frac{11}{27} = \\frac{11}{162}$。\n\n**在 $T_2$ 上：**\n局部基函数 $\\varphi_2=4\\lambda_2'\\lambda_3'$ 在其自身的重心坐标系中与 $\\varphi_1$ 具有相同的形式。计算过程完全相同。\n$\\tilde{M}_2 = \\frac{11}{162}$。\n\n**总近似质量：**\n$\\tilde{M} = \\tilde{M}_1 + \\tilde{M}_2 = \\frac{11}{162} + \\frac{11}{162} = \\frac{22}{162} = \\frac{11}{81}$。\n\n**6. 计算扰动特征值 $\\tilde{\\lambda}$**\n刚度积分是精确计算的，所以我们使用 $A = 16/3$。\n$\\tilde{\\lambda} = \\frac{A}{\\tilde{M}} = \\frac{16/3}{11/81} = \\frac{16}{3} \\times \\frac{81}{11} = 16 \\times \\frac{27}{11} = \\frac{432}{11}$。\n\n**7. 计算特征值偏移 $\\delta\\lambda$**\n$\\delta\\lambda = \\tilde{\\lambda} - \\lambda = \\frac{432}{11} - 30 = \\frac{432 - 30 \\times 11}{11} = \\frac{432 - 330}{11} = \\frac{102}{11}$。", "answer": "$$\n\\boxed{\\frac{102}{11}}\n$$", "id": "3458222"}]}