{"hands_on_practices": [{"introduction": "要真正理解偏微分方程 (Partial Differential Equations, PDEs) 离散化后的矩阵结构，最好的方法就是亲手构建这些矩阵。第一个练习将从最基本的构建模块——二阶导数的有限差分算子——开始。我们将超越教科书中理想化的均匀网格，直接处理更具挑战性也更贴近实际的非均匀网格情形，运用保守型方法推导出一个三点差分格式 [@problem_id:3418706]。这项实践不仅能锻炼从第一性原理出发进行推导的能力，还能让你深刻体会到网格的疏密变化是如何直接影响离散矩阵的对称性和具体数值的。", "problem": "考虑作用于在有界区间 $[a,b]$ 上定义且具有狄利克雷边界条件的足够光滑的标量场 $u(x)$ 的线性二阶导数算子 $L u = \\frac{d^{2}u}{dx^{2}}$。设 $\\{x_{i}\\}_{i=0}^{n}$ 是一个严格单调的非均匀网格，其中 $x_{0} = a$，$x_{n} = b$，并且对于所有内部索引 $i \\in \\{1,\\dots,n-1\\}$ 均满足 $x_{i-1}  x_i  x_{i+1}$。定义局部间距为 $h_{i+\\frac{1}{2}} = x_{i+1} - x_{i}  0$ 和 $h_{i-\\frac{1}{2}} = x_{i} - x_{i-1}  0$。仅使用基本定义（极限和泰勒展开）以及将 $\\frac{d^{2}u}{dx^{2}}$ 解释为梯度之散度的保守形式解释，推导在内部节点 $x_{i}$ 处 $L u$ 的一个三点有限差分近似。该近似仅依赖于节点值 $u_{i-1}$、$u_{i}$ 和 $u_{i+1}$，并且在 $u$ 的光滑性假设下是二阶相容的。然后，写出将节点值向量 $(u_{0},u_{1},\\dots,u_{n})^{\\top}$ 映射到内部节点 $\\{1,\\dots,n-1\\}$ 处离散二阶导数向量 $(L_{h}u)_{i}$ 的离散算子所对应的三对角矩阵表示 $A$，并给出对角线元素 $A_{i,i}$ 和非对角线元素 $A_{i,i-1}$、$A_{i,i+1}$ 关于 $h_{i-\\frac{1}{2}}$ 和 $h_{i+\\frac{1}{2}}$ 的显式公式。最终答案必须是这三个元素按 $(A_{i,i-1}, A_{i,i}, A_{i,i+1})$ 顺序排列的单行，以闭式解析表达式的形式给出。无需进行舍入。为清晰起见，在首次出现时，应以“偏微分方程（Partial Differential Equations, PDEs）”的形式定义该术语。", "solution": "该问题要求在非均匀网格上推导二阶导数算子 $L u = \\frac{d^{2}u}{dx^{2}}$ 的三点有限差分近似。推导过程需基于算子的保守形式解释，这是有限体积法的基础，并能确保许多以偏微分方程（Partial Differential Equations, PDEs）形式表达的物理定律的数值解具有守恒性质。\n\n该算子的保守形式为 $L u = \\frac{d}{dx} \\left( \\frac{du}{dx} \\right)$，它将二阶导数表示为通量的散度，其中通量为梯度 $F(x) = \\frac{du}{dx}$。\n\n我们在每个内部节点 $x_i$ 周围构建一个控制体积（或单元）$C_i$。该控制体积的一个自然选择是由节点之间的中点所界定的区间：$C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$，其中 $x_{i-\\frac{1}{2}} = \\frac{x_{i-1} + x_i}{2}$ 且 $x_{i+\\frac{1}{2}} = \\frac{x_i + x_{i+1}}{2}$。\n\n该控制体积的长度由 $\\Delta x_i = x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}$ 给出。利用局部间距的定义，$h_{i+\\frac{1}{2}} = x_{i+1} - x_i$ 和 $h_{i-\\frac{1}{2}} = x_i - x_{i-1}$，我们可以将此长度表示为：\n$$ \\Delta x_i = \\left(\\frac{x_i + x_{i+1}}{2}\\right) - \\left(\\frac{x_{i-1} + x_i}{2}\\right) = \\frac{x_{i+1} - x_{i-1}}{2} = \\frac{(x_{i+1} - x_i) + (x_i - x_{i-1})}{2} = \\frac{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}}{2} $$\n节点 $x_i$ 处的有限差分近似 $(L_h u)_i$ 是通过在控制体积 $C_i$ 上对算子 $L u$ 进行平均，然后对所得表达式进行离散化来构建的。\n$$ (L_h u)_i \\approx \\frac{1}{\\Delta x_i} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\frac{d}{dx} \\left( \\frac{du}{dx} \\right) dx $$\n根据微积分基本定理，该积分简化为控制体积边界处通量之差：\n$$ (L_h u)_i \\approx \\frac{1}{\\Delta x_i} \\left[ \\left( \\frac{du}{dx} \\right)_{x_{i+\\frac{1}{2}}} - \\left( \\frac{du}{dx} \\right)_{x_{i-\\frac{1}{2}}} \\right] $$\n接下来，我们使用基于相邻节点值的二阶精确中心差分近似来逼近单元面 $x_{i+\\frac{1}{2}}$ 和 $x_{i-\\frac{1}{2}}$ 处的通量（一阶导数）：\n$$ \\left( \\frac{du}{dx} \\right)_{x_{i+\\frac{1}{2}}} \\approx \\frac{u(x_{i+1}) - u(x_i)}{x_{i+1} - x_i} = \\frac{u_{i+1} - u_i}{h_{i+\\frac{1}{2}}} $$\n$$ \\left( \\frac{du}{dx} \\right)_{x_{i-\\frac{1}{2}}} \\approx \\frac{u(x_i) - u(x_{i-1})}{x_i - x_{i-1}} = \\frac{u_i - u_{i-1}}{h_{i-\\frac{1}{2}}} $$\n将这些通量近似值代入 $(L_h u)_i$ 的表达式中，得到离散算子：\n$$ (L_h u)_i = \\frac{1}{\\frac{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}}{2}} \\left( \\frac{u_{i+1} - u_i}{h_{i+\\frac{1}{2}}} - \\frac{u_i - u_{i-1}}{h_{i-\\frac{1}{2}}} \\right) $$\n为确定相应矩阵 $A$ 的元素，我们重排此表达式以识别 $u_{i-1}$、$u_i$ 和 $u_{i+1}$ 的系数：\n$$ (L_h u)_i = \\frac{2}{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}} \\left[ \\left(\\frac{1}{h_{i-\\frac{1}{2}}}\\right)u_{i-1} - \\left(\\frac{1}{h_{i-\\frac{1}{2}}} + \\frac{1}{h_{i+\\frac{1}{2}}}\\right)u_i + \\left(\\frac{1}{h_{i+\\frac{1}{2}}}\\right)u_{i+1} \\right] $$\n我们可以化简 $u_i$ 的系数：\n$$ -\\left(\\frac{1}{h_{i-\\frac{1}{2}}} + \\frac{1}{h_{i+\\frac{1}{2}}}\\right) = -\\frac{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}}{h_{i-\\frac{1}{2}}h_{i+\\frac{1}{2}}} $$\n离散算子为 $(L_h u)_i = A_{i,i-1}u_{i-1} + A_{i,i}u_i + A_{i,i+1}u_{i+1}$。构成矩阵表示 $A$ 的第 $i$ 行的系数为：\n\n对于次对角线元素：\n$$ A_{i,i-1} = \\frac{2}{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}} \\cdot \\frac{1}{h_{i-\\frac{1}{2}}} = \\frac{2}{h_{i-\\frac{1}{2}}(h_{i-\\frac{1}{2}} + h_{i+\\frac{1}{2}})} $$\n对于超对角线元素：\n$$ A_{i,i+1} = \\frac{2}{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}} \\cdot \\frac{1}{h_{i+\\frac{1}{2}}} = \\frac{2}{h_{i+\\frac{1}{2}}(h_{i-\\frac{1}{2}} + h_{i+\\frac{1}{2}})} $$\n对于对角线元素：\n$$ A_{i,i} = \\frac{2}{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}} \\cdot \\left(-\\frac{h_{i+\\frac{1}{2}} + h_{i-\\frac{1}{2}}}{h_{i-\\frac{1}{2}}h_{i+\\frac{1}{2}}}\\right) = -\\frac{2}{h_{i-\\frac{1}{2}}h_{i+\\frac{1}{2}}} $$\n泰勒级数分析表明，该格式的局部截断误差为 $T_i = (L_h u)_i - u''_i = \\frac{h_{i+\\frac{1}{2}} - h_{i-\\frac{1}{2}}}{3}u'''_i + O(h^2_{max})$。在一般的非均匀网格上，该格式是一阶精确的。如题目所要求，在网格间距平滑变化（即 $|h_{i+\\frac{1}{2}} - h_{i-\\frac{1}{2}}| = O(h^2_{max})$）或在均匀网格（$h_{i+\\frac{1}{2}} = h_{i-\\frac{1}{2}}$）的条件下，它能达到二阶相容性。该推导方法本身是稳健的，并导出一个唯一的三点模板。\n\n因此，所求的矩阵 $A$ 第 $i$ 行的元素，按 $(A_{i,i-1}, A_{i,i}, A_{i,i+1})$ 顺序排列，由以上推导的表达式给出。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2}{h_{i-\\frac{1}{2}}(h_{i-\\frac{1}{2}} + h_{i+\\frac{1}{2}})}  -\\frac{2}{h_{i-\\frac{1}{2}}h_{i+\\frac{1}{2}}}  \\frac{2}{h_{i+\\frac{1}{2}}(h_{i-\\frac{1}{2}} + h_{i+\\frac{1}{2}})} \\end{pmatrix}}\n$$", "id": "3418706"}, {"introduction": "构建了基本的差分算子后，我们来探讨边界条件如何塑造整个矩阵的全局特性。本练习将分析带有齐次诺伊曼 (Neumann) 边界条件（即边界通量为零）的一维扩散方程 [@problem_id:3418673]。你将通过从控制体积分的守恒原理出发，证明物理上的质量守恒定律如何直接转化为一个关键的代数性质：离散矩阵的行和为零，从而导致矩阵是奇异的。这项练习揭示了 PDE 问题中的物理内涵（如守恒律）与其离散矩阵的代数属性（如零空间和半正定性）之间的深刻联系，这是理解和求解许多物理问题的关键。", "problem": "考虑一维椭圆型偏微分方程 (PDE) $-\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}\\right)=f(x)$，定义在区间 $[0,L]$ 上，并具有齐次 Neumann 边界条件 $u_{x}(0)=0$ 和 $u_{x}(L)=0$，其中 $a(x)$ 是一个严格为正且足够光滑的函数。设 $\\{x_{i}\\}_{i=1}^{N}$ 是一个间距为 $h=L/(N-1)$ 的均匀网格，并定义界面位置 $x_{i+\\frac{1}{2}}=\\frac{x_{i}+x_{i+1}}{2}$ 及其相关的正系数 $a_{i+\\frac{1}{2}} \\approx a(x_{i+\\frac{1}{2}})$。\n\n从每个网格点周围的控制体积上的守恒律出发，推导标准的二阶通量差分有限差分离散格式。在此格式中，离散算子 $A \\in \\mathbb{R}^{N \\times N}$ 通过扩散通量的离散散度作用于网格值向量 $\\boldsymbol{u}=\\left(u_{1},\\dots,u_{N}\\right)^{\\top}$，并通过将边界通量设置为零来实现齐次 Neumann 边界条件。在不引用任何预先声明的矩阵恒等式或 $A$ 的已知性质的情况下，使用控制体积守恒原理和通量连续性来证明 $A$ 的行和为零，并确定常数向量是 $A$ 的一个右零向量。\n\n最后，根据这些结构性质和 $a(x)$ 的正性，推断出 $A$ 的最小特征值是什么。最终答案以单个实数形式给出。无需四舍五入。", "solution": "本题要求推导和分析由一维椭圆型偏微分方程的有限差分离散所产生的矩阵算子。\n\n控制方程为守恒律：\n$$ -\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}\\right) = f(x) \\quad \\text{for } x \\in [0,L] $$\n具有齐次 Neumann 边界条件 $u_{x}(0)=0$ 和 $u_{x}(L)=0$。\n设扩散通量定义为 $F(x) = -a(x)\\frac{du}{dx}$。该偏微分方程可以重写为 $\\frac{dF}{dx} = f(x)$。\n\n我们从守恒律的积分形式出发，在围绕网格点 $x_i$ 的控制体积 $V_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ 上进行积分。将偏微分方程在 $V_i$ 上积分得到：\n$$ \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} -\\frac{d}{dx}\\left(a(x)\\frac{du}{dx}\\right) dx = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} f(x) dx $$\n对左边应用微积分基本定理得到：\n$$ -\\left[a(x)\\frac{du}{dx}\\right]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} = \\left[-a(x)\\frac{du}{dx}\\right]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} = F\\left(x_{i+\\frac{1}{2}}\\right) - F\\left(x_{i-\\frac{1}{2}}\\right) $$\n这给出了控制体积 $V_i$ 的精确守恒关系：流出该体积的净通量等于其内部源的积分。\n\n现在我们对这个关系式进行离散化。网格点为 $\\{x_i\\}_{i=1}^N$，均匀间距为 $h=L/(N-1)$。解在网格点 $x_i$ 处的值记为 $u_i$。在界面 $x_{i+\\frac{1}{2}}$ 处的通量 $F(x)$ 使用二阶中心差分来近似导数：\n$$ \\frac{du}{dx}\\bigg|_{x_{i+\\frac{1}{2}}} \\approx \\frac{u_{i+1}-u_i}{h} $$\n于是，离散通量定义为：\n$$ F_{i+\\frac{1}{2}} := -a_{i+\\frac{1}{2}}\\frac{u_{i+1}-u_i}{h} $$\n其中 $a_{i+\\frac{1}{2}}  0$ 是界面上给定的系数值。\n\n离散算子 $A$ 的定义使得向量 $A\\boldsymbol{u}$ 的第 $i$ 个分量表示来自控制体积 $V_i$ 的离散净通量。这对应于积分守恒律的左边，$F_{i+1/2} - F_{i-1/2}$。\n因此，我们定义算子 $A$ 在向量 $\\boldsymbol{u} = (u_1, \\dots, u_N)^\\top$ 上的作用为：\n$$ (A\\boldsymbol{u})_i = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} $$\n\n对于内部节点 $i \\in \\{2, 3, \\dots, N-1\\}$，我们代入离散通量的定义：\n$$ (A\\boldsymbol{u})_i = \\left(-a_{i+\\frac{1}{2}}\\frac{u_{i+1}-u_i}{h}\\right) - \\left(-a_{i-\\frac{1}{2}}\\frac{u_i-u_{i-1}}{h}\\right) $$\n$$ (A\\boldsymbol{u})_i = \\frac{1}{h} \\left[ -a_{i-\\frac{1}{2}}u_{i-1} + (a_{i-\\frac{1}{2}} + a_{i+\\frac{1}{2}})u_i - a_{i+\\frac{1}{2}}u_{i+1} \\right] $$\n这个表达式定义了矩阵 $A$ 的第 $i$ 行（对于 $i \\in \\{2, \\dots, N-1\\}$）的元素。\n\n对于边界节点，我们按照规定，通过将边界通量设为零来实现齐次 Neumann 条件。\n在左边界 $x=x_1=0$ 处，条件 $u_x(0)=0$ 意味着 $F(0)=0$。$x_1$ 的控制体积概念上是 $[x_{\\frac{1}{2}}, x_{\\frac{3}{2}}]$。域边界处的通量是 $F_{\\frac{1}{2}}$。因此我们设 $F_{\\frac{1}{2}}=0$。\n对于 $i=1$:\n$$ (A\\boldsymbol{u})_1 = F_{\\frac{3}{2}} - F_{\\frac{1}{2}} = F_{\\frac{3}{2}} - 0 = -a_{\\frac{3}{2}}\\frac{u_2-u_1}{h} = \\frac{1}{h}\\left(a_{\\frac{3}{2}}u_1 - a_{\\frac{3}{2}}u_2\\right) $$\n\n在右边界 $x=x_N=L$ 处，条件 $u_x(L)=0$ 意味着 $F(L)=0$。$x_N$ 的控制体积是 $[x_{N-\\frac{1}{2}}, x_{N+\\frac{1}{2}}]$。此边界处的通量是 $F_{N+\\frac{1}{2}}$。我们设 $F_{N+\\frac{1}{2}}=0$。\n对于 $i=N$:\n$$ (A\\boldsymbol{u})_N = F_{N+\\frac{1}{2}} - F_{N-\\frac{1}{2}} = 0 - F_{N-\\frac{1}{2}} = - \\left(-a_{N-\\frac{1}{2}}\\frac{u_N-u_{N-1}}{h}\\right) = \\frac{1}{h}\\left(-a_{N-\\frac{1}{2}}u_{N-1} + a_{N-\\frac{1}{2}}u_N\\right) $$\n\n题目要求我们证明 $A$ 的行和为零。第 $i$ 行元素的和由 $\\sum_{j=1}^N A_{ij}$ 给出。这个和可以通过计算 $(A\\boldsymbol{c})_i$ 来求得，其中 $\\boldsymbol{c}$ 是所有分量都等于 $1$ 的常数向量，即对于所有 $j=1, \\dots, N$，有 $c_j=1$。\n对于常数向量场 $\\boldsymbol{u}=\\boldsymbol{c}$，离散通量为：\n$$ F_{i+\\frac{1}{2}} = -a_{i+\\frac{1}{2}}\\frac{c_{i+1}-c_i}{h} = -a_{i+\\frac{1}{2}}\\frac{1-1}{h} = 0 $$\n这对所有界面 $i=1, \\dots, N-1$ 都成立。因此，所有内部通量都为零。边界通量 $F_{\\frac{1}{2}}$ 和 $F_{N+\\frac{1}{2}}$ 根据定义也为零。\n$A$ 对 $\\boldsymbol{c}$ 的作用是：\n$$ (A\\boldsymbol{c})_i = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} = 0 - 0 = 0 $$\n这对所有 $i=1, \\dots, N$ 都成立。由于 $(A\\boldsymbol{c})_i = \\sum_{j=1}^N A_{ij} c_j = \\sum_{j=1}^N A_{ij}$，我们已经证明了 $A$ 的每一行的元素之和都为零。这个结果直接源于控制体积守恒原理（即结构 $(A\\boldsymbol{u})_i = F_{i+1/2} - F_{i-1/2}$）和离散通量的性质（即对于常数场，通量为零），这可以看作是通量连续性的一种形式。\n\n方程 $A\\boldsymbol{c} = \\boldsymbol{0}$ 表明非零常数向量 $\\boldsymbol{c}$ 是矩阵 $A$ 的一个右零向量。根据特征值和特征向量的定义，这意味着 $\\lambda=0$ 是 $A$ 的一个特征值，而 $\\boldsymbol{c}$ 是其对应的特征向量。\n\n为了确定 $0$ 是否是最小特征值，我们分析二次型 $\\boldsymbol{u}^\\top A \\boldsymbol{u}$。矩阵 $A$ 是对称的，这可以从它的元素看出：$A_{i,i+1} = -a_{i+\\frac{1}{2}}/h$ 和 $A_{i+1,i} = -a_{(i+1)-\\frac{1}{2}}/h = -a_{i+\\frac{1}{2}}/h$。因此，它的所有特征值都是实数。\n$$ \\boldsymbol{u}^\\top A \\boldsymbol{u} = \\sum_{i=1}^N u_i (A\\boldsymbol{u})_i = \\sum_{i=1}^N u_i (F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}) $$\n应用分部求和法：\n$$ \\boldsymbol{u}^\\top A \\boldsymbol{u} = \\sum_{i=1}^{N-1} F_{i+\\frac{1}{2}}(u_i - u_{i+1}) + u_N F_{N+\\frac{1}{2}} - u_1 F_{\\frac{1}{2}} $$\n使用边界条件 $F_{\\frac{1}{2}} = 0$ 和 $F_{N+\\frac{1}{2}} = 0$，上式简化为：\n$$ \\boldsymbol{u}^\\top A \\boldsymbol{u} = \\sum_{i=1}^{N-1} F_{i+\\frac{1}{2}}(u_i - u_{i+1}) $$\n代入离散通量的定义 $F_{i+\\frac{1}{2}} = -a_{i+\\frac{1}{2}}\\frac{u_{i+1}-u_i}{h} = a_{i+\\frac{1}{2}}\\frac{u_i-u_{i+1}}{h}$：\n$$ \\boldsymbol{u}^\\top A \\boldsymbol{u} = \\sum_{i=1}^{N-1} \\left(a_{i+\\frac{1}{2}}\\frac{u_i-u_{i+1}}{h}\\right) (u_i - u_{i+1}) = \\frac{1}{h}\\sum_{i=1}^{N-1} a_{i+\\frac{1}{2}}(u_i - u_{i+1})^2 $$\n由于 $h0$，$a_{i+\\frac{1}{2}}0$（由 $a(x)$ 的严格正性给出），以及 $(u_i - u_{i+1})^2 \\ge 0$，二次型 $\\boldsymbol{u}^\\top A \\boldsymbol{u}$ 总是非负的。\n$$ \\boldsymbol{u}^\\top A \\boldsymbol{u} \\ge 0 $$\n这意味着矩阵 $A$ 是半正定的。对称半正定矩阵的一个性质是它们的所有特征值 $\\lambda$ 都是非负的，即 $\\lambda \\ge 0$。\n\n我们已经确定了两个事实：\n1. $A$ 的所有特征值都大于或等于 $0$。\n2. $A$ 存在一个恰好等于 $0$ 的特征值。\n\n结合这两个事实，我们推断出矩阵 $A$ 的最小特征值必须是 $0$。\n等式 $\\boldsymbol{u}^\\top A \\boldsymbol{u} = 0$ 成立当且仅当对于所有 $i=1, \\dots, N-1$ 都有 $u_i-u_{i+1}=0$，这意味着 $u_1=u_2=\\dots=u_N$。这证实了零空间是由常数向量 $\\boldsymbol{c}$ 张成的，并且特征值 $0$ 的重数为 $1$。所有其他特征值都是严格为正的。\n因此，最小特征值为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3418673"}, {"introduction": "现实世界的问题很少是一维的。当我们从一维扩展到二维时，离散矩阵的结构会如何演变？本练习将通过离散一个矩形域上的二维泊松 (Poisson) 方程来回答这个问题 [@problem_id:3418648]。你将学习到一个优雅而强大的工具——克罗内克积 (Kronecker product)，它能够让我们利用一维离散算子的已知信息来构造二维算子矩阵。更重要的是，这种结构化的方法使得我们可以直接从一维问题的特征值和特征向量出发，推导出整个二维大系统的特征值和特征向量，这对于分析和设计高效的多维问题求解器至关重要。", "problem": "考虑矩形区域上的二维泊松方程，其带有齐次狄利克雷边界条件，\n$$\n-\\frac{\\partial^{2} u}{\\partial x^{2}}(x,y) - \\frac{\\partial^{2} u}{\\partial y^{2}}(x,y) = f(x,y), \\quad (x,y) \\in (0,L_{x}) \\times (0,L_{y}), \\quad u(x,y) = 0 \\text{ on } \\partial\\big((0,L_{x}) \\times (0,L_{y})\\big).\n$$\n使用均匀网格对区域内部进行离散化，该网格在 $x$ 方向有 $n_{x}$ 个内部点，在 $y$ 方向有 $n_{y}$ 个内部点，间距分别为 $h_{x} = \\frac{L_{x}}{n_{x}+1}$ 和 $h_{y} = \\frac{L_{y}}{n_{y}+1}$。通过对内部网格点进行字典序排序，构建标准的二阶中心有限差分（此处的有限差分定义为一种在网格上用差商替换导数的方法）矩阵 $A \\in \\mathbb{R}^{n_x n_y \\times n_x n_y}$ 来近似负拉普拉斯算子 $-\\Delta$。令 $T_{n}$ 表示一个 $n \\times n$ 的三对角矩阵，其对角线上元素为 $2$，次对角线和超对角线上元素为 $-1$。该矩阵源于对带有齐次狄利克雷条件的负二阶导数进行一维二阶中心有限差分离散化。那么 $A$ 具有克罗内克和结构\n$$\nA = \\frac{1}{h_{x}^{2}}\\, T_{n_{x}} \\otimes I_{n_{y}} \\;+\\; \\frac{1}{h_{y}^{2}}\\, I_{n_{x}} \\otimes T_{n_{y}},\n$$\n其中 $I_{m}$ 表示 $m \\times m$ 的单位矩阵，$\\otimes$ 表示克罗内克积（矩阵 $X \\in \\mathbb{R}^{a \\times b}$ 和 $Y \\in \\mathbb{R}^{c \\times d}$ 的克罗内克积是一个 $\\mathbb{R}^{ac \\times bd}$ 中的分块矩阵，定义为 $X \\otimes Y = [x_{ij} Y]_{i,j}$）。\n\n从带有齐次狄利克雷边界条件的一维二阶中心有限差分算子的定义，以及克罗内克积的标准性质——特别是 $(X \\otimes I)(v \\otimes w) = (Xv) \\otimes w$ 和 $(I \\otimes Y)(v \\otimes w) = v \\otimes (Yw)$——出发，推导一维矩阵 $T_{n_{x}}$ 和 $T_{n_{y}}$ 的特征对，然后为 $A$ 构建张量积特征向量，以严格证明 $A$ 的特征值是一维特征值经 $h_{x}$ 和 $h_{y}$ 缩放后的和。\n\n你的最终任务是为 $A$ 的一个通用特征值 $\\lambda_{p,q}$ 提供一个单一的封闭形式解析表达式，该特征值对应于模式指数 $p \\in \\{1,\\dots,n_{x}\\}$ 和 $q \\in \\{1,\\dots,n_{y}\\}$，并且表达式中只包含 $p$、$q$、$n_{x}$、$n_{y}$、$h_{x}$ 和 $h_{y}$。不需要数值近似，最终表达式中不使用任何单位。", "solution": "问题陈述经评估有效。它具有科学依据，问题提法得当且客观。它提出了一个偏微分方程数值分析中的标准问题，并为严格推导提供了所有必要的定义和约束。该问题是自洽的、一致的，并且不违反任何无效标准。\n\n按照要求，推导过程分两个主要阶段进行：首先，确定一维有限差分矩阵 $T_n$ 的特征对；其次，利用这些特征对构建二维矩阵 $A$ 的特征对。\n\n**第1部分：一维矩阵 $T_n$ 的特征对**\n\n矩阵 $T_n$ 是一个 $n \\times n$ 的三对角矩阵，主对角线元素为 $2$，第一条次对角线和超对角线元素为 $-1$。$T_n$ 的特征值方程为 $T_n v = \\mu v$，其中 $\\mu$ 是特征值，$v \\in \\mathbb{R}^n$ 是对应的特征向量，其分量为 $v_j$。对于 $j \\in \\{1, \\dots, n\\}$，该矩阵-向量方程的第 $j$ 行为：\n$$\n-v_{j-1} + 2v_j - v_{j+1} = \\mu v_j.\n$$\n这些方程由从连续问题的齐次狄利克雷条件导出的边界条件补充，即 $v_0 = 0$ 和 $v_{n+1} = 0$。该方程可以重写为一个齐次二阶线性差分方程：\n$$\nv_{j+1} + (\\mu - 2)v_j + v_{j-1} = 0.\n$$\n我们寻找形如 $v_j = \\sin(j\\theta)$ 的解，其中 $\\theta$ 是某个角度。这个选择的动机来自于其连续对应物——二阶导数算子——的特征函数。边界条件 $v_0 = \\sin(0 \\cdot \\theta) = 0$ 立即得到满足。另一边界的条件 $v_{n+1}=0$ 要求：\n$$\n\\sin((n+1)\\theta) = 0.\n$$\n这意味着 $(n+1)\\theta$ 必须是 $\\pi$ 的整数倍。我们记 $(n+1)\\theta_p = p\\pi$，其中 $p$ 是一个整数索引。为了获得 $n$ 个线性无关的特征向量，我们可以选择 $p \\in \\{1, 2, \\dots, n\\}$。这给出角度：\n$$\n\\theta_p = \\frac{p\\pi}{n+1}, \\quad p \\in \\{1, 2, \\dots, n\\}.\n$$\n因此，第 $p$ 个特征向量（记为 $v_p^{(n)}$）的分量由下式给出：\n$$\n(v_p^{(n)})_j = \\sin\\left(\\frac{jp\\pi}{n+1}\\right), \\quad j \\in \\{1, 2, \\dots, n\\}.\n$$\n为了找到对应的特征值 $\\mu_p$，我们将此解代回差分方程：\n$$\n-\\sin\\left(\\frac{(j-1)p\\pi}{n+1}\\right) + 2\\sin\\left(\\frac{jp\\pi}{n+1}\\right) - \\sin\\left(\\frac{(j+1)p\\pi}{n+1}\\right) = \\mu_p \\sin\\left(\\frac{jp\\pi}{n+1}\\right).\n$$\n使用三角和差化积恒等式 $\\sin(\\alpha-\\beta) + \\sin(\\alpha+\\beta) = 2\\sin(\\alpha)\\cos(\\beta)$，我们可以简化左侧的第一项和第三项：\n$$\n\\sin\\left(\\frac{jp\\pi}{n+1} - \\frac{p\\pi}{n+1}\\right) + \\sin\\left(\\frac{jp\\pi}{n+1} + \\frac{p\\pi}{n+1}\\right) = 2\\sin\\left(\\frac{jp\\pi}{n+1}\\right)\\cos\\left(\\frac{p\\pi}{n+1}\\right).\n$$\n将其代回，方程变为：\n$$\n2\\sin\\left(\\frac{jp\\pi}{n+1}\\right) - 2\\sin\\left(\\frac{jp\\pi}{n+1}\\right)\\cos\\left(\\frac{p\\pi}{n+1}\\right) = \\mu_p \\sin\\left(\\frac{jp\\pi}{n+1}\\right).\n$$\n提出正弦项（对于特征向量，该项不恒为零）：\n$$\n\\left[2 - 2\\cos\\left(\\frac{p\\pi}{n+1}\\right)\\right] \\sin\\left(\\frac{jp\\pi}{n+1}\\right) = \\mu_p \\sin\\left(\\frac{jp\\pi}{n+1}\\right).\n$$\n由此，我们确定矩阵 $T_n$ 的特征值 $\\mu_p^{(n)}$ 为：\n$$\n\\mu_p^{(n)} = 2 - 2\\cos\\left(\\frac{p\\pi}{n+1}\\right).\n$$\n使用半角公式 $1 - \\cos(2\\alpha) = 2\\sin^2(\\alpha)$，其中 $\\alpha = \\frac{p\\pi}{2(n+1)}$，我们得到 $T_n$ 特征值的最终形式：\n$$\n\\mu_p^{(n)} = 4\\sin^2\\left(\\frac{p\\pi}{2(n+1)}\\right), \\quad p \\in \\{1, 2, \\dots, n\\}.\n$$\n\n**第2部分：二维矩阵 $A$ 的特征对**\n\n二维问题的矩阵 $A$ 由克罗内克和给出：\n$$\nA = \\frac{1}{h_{x}^{2}}\\, T_{n_{x}} \\otimes I_{n_{y}} \\;+\\; \\frac{1}{h_{y}^{2}}\\, I_{n_{x}} \\otimes T_{n_{y}}.\n$$\n设 $(\\mu_p^{(n_x)}, v_p^{(n_x)})$ 为 $T_{n_x}$ 的特征对（其中 $p \\in \\{1, \\dots, n_x\\}$），$(\\mu_q^{(n_y)}, v_q^{(n_y)})$ 为 $T_{n_y}$ 的特征对（其中 $q \\in \\{1, \\dots, n_y\\}$），如第1部分所推导。我们构造 $A$ 的候选特征向量，作为一维特征向量的张量积：\n$$\nw_{p,q} = v_p^{(n_x)} \\otimes v_q^{(n_y)}.\n$$\n我们现在将矩阵 $A$ 应用于此向量 $w_{p,q}$：\n$$\nA w_{p,q} = \\left( \\frac{1}{h_{x}^{2}}\\, T_{n_{x}} \\otimes I_{n_{y}} \\;+\\; \\frac{1}{h_{y}^{2}}\\, I_{n_{x}} \\otimes T_{n_{y}} \\right) ( v_p^{(n_x)} \\otimes v_q^{(n_y)} ).\n$$\n根据线性性质，我们可以将向量分配到和中的每一项：\n$$\nA w_{p,q} = \\frac{1}{h_{x}^{2}}\\, (T_{n_{x}} \\otimes I_{n_{y}}) ( v_p^{(n_x)} \\otimes v_q^{(n_y)} ) \\;+\\; \\frac{1}{h_{y}^{2}}\\, (I_{n_{x}} \\otimes T_{n_{y}}) ( v_p^{(n_x)} \\otimes v_q^{(n_y)} ).\n$$\n使用所提供的克罗内克积的性质：\n\\begin{align*} (T_{n_{x}} \\otimes I_{n_{y}}) ( v_p^{(n_x)} \\otimes v_q^{(n_y)} ) = (T_{n_{x}} v_p^{(n_x)}) \\otimes v_q^{(n_y)} \\\\ (I_{n_{x}} \\otimes T_{n_{y}}) ( v_p^{(n_x)} \\otimes v_q^{(n_y)} ) = v_p^{(n_x)} \\otimes (T_{n_{y}} v_q^{(n_y)}) \\end{align*}\n由于 $v_p^{(n_x)}$ 和 $v_q^{(n_y)}$ 分别是 $T_{n_x}$ 和 $T_{n_y}$ 的特征向量，我们有 $T_{n_{x}} v_p^{(n_x)} = \\mu_p^{(n_x)} v_p^{(n_x)}$ 和 $T_{n_{y}} v_q^{(n_y)} = \\mu_q^{(n_y)} v_q^{(n_y)}$。将这些代入上面的表达式：\n\\begin{align*} (T_{n_{x}} v_p^{(n_x)}) \\otimes v_q^{(n_y)} = (\\mu_p^{(n_x)} v_p^{(n_x)}) \\otimes v_q^{(n_y)} = \\mu_p^{(n_x)} (v_p^{(n_x)} \\otimes v_q^{(n_y)}) = \\mu_p^{(n_x)} w_{p,q} \\\\ v_p^{(n_x)} \\otimes (T_{n_{y}} v_q^{(n_y)}) = v_p^{(n_x)} \\otimes (\\mu_q^{(n_y)} v_q^{(n_y)}) = \\mu_q^{(n_y)} (v_p^{(n_x)} \\otimes v_q^{(n_y)}) = \\mu_q^{(n_y)} w_{p,q} \\end{align*}\n将这些结果代回关于 $A w_{p,q}$ 的方程：\n$$\nA w_{p,q} = \\frac{1}{h_{x}^{2}}\\, (\\mu_p^{(n_x)} w_{p,q}) \\;+\\; \\frac{1}{h_{y}^{2}}\\, (\\mu_q^{(n_y)} w_{p,q}).\n$$\n提出 $w_{p,q}$：\n$$\nA w_{p,q} = \\left( \\frac{\\mu_p^{(n_x)}}{h_x^2} + \\frac{\\mu_q^{(n_y)}}{h_y^2} \\right) w_{p,q}.\n$$\n这是一个关于 $A$ 的特征值方程。向量 $w_{p,q}$ 是 $A$ 的一个特征向量，对应的特征值（记为 $\\lambda_{p,q}$）是：\n$$\n\\lambda_{p,q} = \\frac{\\mu_p^{(n_x)}}{h_x^2} + \\frac{\\mu_q^{(n_y)}}{h_y^2}.\n$$\n这表明二维矩阵 $A$ 的特征值是一维特征值缩放后的和，其中 $p \\in \\{1, \\dots, n_x\\}$ 且 $q \\in \\{1, \\dots, n_y\\}$。\n\n**第3部分：$A$ 的特征值的最终表达式**\n\n最后，我们将第1部分中推导的一维特征值表达式代入 $\\lambda_{p,q}$ 的公式：\n$$\n\\mu_p^{(n_x)} = 4\\sin^2\\left(\\frac{p\\pi}{2(n_x+1)}\\right)\n$$\n$$\n\\mu_q^{(n_y)} = 4\\sin^2\\left(\\frac{q\\pi}{2(n_y+1)}\\right)\n$$\n因此，$A$ 的特征值 $\\lambda_{p,q}$ 是：\n$$\n\\lambda_{p,q} = \\frac{1}{h_x^2} \\left[ 4\\sin^2\\left(\\frac{p\\pi}{2(n_x+1)}\\right) \\right] + \\frac{1}{h_y^2} \\left[ 4\\sin^2\\left(\\frac{q\\pi}{2(n_y+1)}\\right) \\right].\n$$\n这就是所要求的 $A$ 的一个通用特征值的封闭形式解析表达式，用 $p$、$q$、$n_{x}$、$n_{y}$、$h_{x}$ 和 $h_{y}$ 表示。\n$$\n\\lambda_{p,q} = \\frac{4}{h_x^2}\\sin^2\\left(\\frac{p\\pi}{2(n_x+1)}\\right) + \\frac{4}{h_y^2}\\sin^2\\left(\\frac{q\\pi}{2(n_y+1)}\\right).\n$$", "answer": "$$\\boxed{\\frac{4}{h_{x}^{2}}\\sin^{2}\\left(\\frac{p\\pi}{2(n_{x}+1)}\\right) + \\frac{4}{h_{y}^{2}}\\sin^{2}\\left(\\frac{q\\pi}{2(n_{y}+1)}\\right)}$$", "id": "3418648"}]}