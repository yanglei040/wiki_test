{"hands_on_practices": [{"introduction": "阿诺尔迪(Arnoldi)过程是推广的最小残差法(GMRES)等克雷洛夫子空间方法的核心。它通过一个迭代过程，为克雷洛夫子空间构建一个标准正交基，同时生成一个上Hessenberg矩阵。本练习将指导您对一个具体的非对称矩阵手动执行阿诺尔迪过程的初始步骤，从而让您对该算法的内部工作机制有一个清晰的、计算层面的理解 [@problem_id:3411908]。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是非对称上三角矩阵\n$$\nA=\\begin{bmatrix}\n2 & 10 & 0\\\\\n0 & 3 & 1\\\\\n0 & 0 & 4\n\\end{bmatrix},\n$$\n并考虑线性系统 $A x = b$，该系统可能源于偏微分方程（PDE）的有限维离散化。设初始猜测为 $x_0=0$，右端项为 $b=\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$，因此初始残差为 $r_0=b-A x_0=b$。使用 Arnoldi 过程，采用欧几里得内积和经典的 Gram–Schmidt 正交化，从 $v_1=r_0/\\|r_0\\|_2$ 开始，执行恰好两步 Arnoldi 迭代，构建标准正交基向量 $v_1$、$v_2$、$v_3$ 以及生成的 $(3 \\times 2)$ 上 Hessenberg 矩阵 $\\underline{H}_2$。在您的构建过程中，明确计算正交化中使用的所有投影系数和归一化常数，并组装 $V_3=\\begin{bmatrix}v_1 & v_2 & v_3\\end{bmatrix}$ 和 $\\underline{H}_2$。如果发生精确分解（exact breakdown），请解释它如何影响 $v_3$ 的定义和 $\\underline{H}_2$ 的结构，并提供一个明确的标准正交补全来定义与 Arnoldi 关系 $A V_2 = V_3 \\underline{H}_2$ 一致的 $v_3$。作为您的最终答案，请以精确形式给出 $\\underline{H}_2$ 的标量次对角线元素 $h_{32}$。不要对您的答案进行四舍五入。", "solution": "该问题要求对给定的线性系统使用 Arnoldi 过程构建一个标准正交基和一个 Hessenberg 矩阵。首先，验证该问题是适定的、科学上合理的，并包含唯一解过程所需的所有必要信息。\n\nArnoldi 过程是一种迭代方法，用于为 Krylov 子空间 $\\mathcal{K}_m(A, v_1) = \\text{span}\\{v_1, Av_1, \\ldots, A^{m-1}v_1\\}$ 构建一个标准正交基 $\\{v_1, v_2, \\ldots, v_m\\}$。该过程还生成一个上 Hessenberg 矩阵 $\\underline{H}_{m-1} \\in \\mathbb{R}^{m \\times (m-1)}$，其元素是 Gram-Schmidt 正交化过程中的系数。其主导关系是 $AV_{m-1} = V_m \\underline{H}_{m-1}$，其中 $V_k = \\begin{bmatrix} v_1 & \\cdots & v_k \\end{bmatrix}$。\n\n算法流程如下。对于 $j=1, 2, \\ldots, m-1$：\n1. 计算 $w = Av_j$。\n2. 对于 $i=1, \\ldots, j$，计算投影系数 $h_{ij} = v_i^T w$。\n3. 计算待正交化的向量：$\\tilde{v}_{j+1} = w - \\sum_{i=1}^j h_{ij}v_i$。\n4. 计算归一化常数 $h_{j+1,j} = \\|\\tilde{v}_{j+1}\\|_2$。\n5. 如果 $h_{j+1,j} = 0$，则发生精确分解；停止。否则，令 $v_{j+1} = \\tilde{v}_{j+1}/h_{j+1,j}$。\n\n给定矩阵 $A=\\begin{bmatrix} 2 & 10 & 0\\\\ 0 & 3 & 1\\\\ 0 & 0 & 4 \\end{bmatrix}$，右端向量 $b=\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$，以及初始猜测 $x_0=0$。\n\n**第0步：初始化**\n初始残差为 $r_0 = b - Ax_0 = b = \\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$。\nArnoldi 过程的起始向量是 $v_1 = r_0 / \\|r_0\\|_2$。\n$r_0$ 的欧几里得范数为 $\\|r_0\\|_2 = \\sqrt{1^2+1^2+1^2} = \\sqrt{3}$。\n因此，第一个标准正交基向量是 $v_1 = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$。\n\n**第1步：构建 $v_2$ 和 $\\underline{H}_2$ 的第一列**\n首先，我们计算乘积 $w_1 = Av_1$：\n$$ w_1 = \\begin{bmatrix} 2 & 10 & 0\\\\ 0 & 3 & 1\\\\ 0 & 0 & 4 \\end{bmatrix} \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} \\right) = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}2+10\\\\3+1\\\\4\\end{pmatrix} = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} $$\n接着，我们将 $w_1$ 对 $v_1$ 进行正交化。投影系数 $h_{11}$ 为：\n$$ h_{11} = v_1^T w_1 = \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1 & 1 & 1\\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} \\right) = \\frac{1}{3}(12+4+4) = \\frac{20}{3} $$\n下一个未归一化的向量 $\\tilde{v}_2$ 是：\n$$ \\tilde{v}_2 = w_1 - h_{11}v_1 = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} - \\frac{20}{3} \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} = \\frac{1}{3\\sqrt{3}}\\left(3\\begin{pmatrix}12\\\\4\\\\4\\end{pmatrix} - 20\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}\\right) = \\frac{1}{3\\sqrt{3}}\\begin{pmatrix}36-20\\\\12-20\\\\12-20\\end{pmatrix} = \\frac{1}{3\\sqrt{3}}\\begin{pmatrix}16\\\\-8\\\\-8\\end{pmatrix} = \\frac{8}{3\\sqrt{3}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n归一化常数 $h_{21}$ 是 $\\tilde{v}_2$ 的范数：\n$$ h_{21} = \\|\\tilde{v}_2\\|_2 = \\left\\| \\frac{8}{3\\sqrt{3}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} \\right\\|_2 = \\frac{8}{3\\sqrt{3}} \\sqrt{2^2+(-1)^2+(-1)^2} = \\frac{8}{3\\sqrt{3}}\\sqrt{6} = \\frac{8\\sqrt{2}}{3} $$\n由于 $h_{21} \\neq 0$，没有发生分解。我们对 $\\tilde{v}_2$ 进行归一化得到 $v_2$：\n$$ v_2 = \\frac{\\tilde{v}_2}{h_{21}} = \\frac{\\frac{8}{3\\sqrt{3}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix}}{\\frac{8\\sqrt{2}}{3}} = \\frac{1}{\\sqrt{3}\\sqrt{2}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n\n**第2步：构建 $v_3$ 和 $\\underline{H}_2$ 的第二列**\n我们计算乘积 $w_2 = Av_2$：\n$$ w_2 = \\begin{bmatrix} 2 & 10 & 0\\\\ 0 & 3 & 1\\\\ 0 & 0 & 4 \\end{bmatrix} \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} \\right) = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}4-10\\\\-3-1\\\\-4\\end{pmatrix} = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} $$\n接着，我们将 $w_2$ 对 $\\{v_1, v_2\\}$ 进行正交化。投影系数为：\n$$ h_{12} = v_1^T w_2 = \\left( \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1 & 1 & 1\\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} \\right) = \\frac{-6-4-4}{\\sqrt{18}} = \\frac{-14}{3\\sqrt{2}} = -\\frac{7\\sqrt{2}}{3} $$\n$$ h_{22} = v_2^T w_2 = \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2 & -1 & -1\\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} \\right) = \\frac{1}{6}(-12+4+4) = \\frac{-4}{6} = -\\frac{2}{3} $$\n未归一化的向量 $\\tilde{v}_3$ 是：\n$$ \\tilde{v}_3 = w_2 - h_{12}v_1 - h_{22}v_2 = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} - \\left(-\\frac{7\\sqrt{2}}{3}\\right)\\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} - \\left(-\\frac{2}{3}\\right)\\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n$$ \\tilde{v}_3 = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} + \\frac{7\\sqrt{2}}{3\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} + \\frac{2}{3\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} $$\n为了合并这些项，我们使用公因子 $\\frac{1}{3\\sqrt{6}}$。注意 $\\frac{7\\sqrt{2}}{3\\sqrt{3}} = \\frac{7\\sqrt{2}\\sqrt{2}}{3\\sqrt{3}\\sqrt{2}} = \\frac{14}{3\\sqrt{6}}$。\n$$ \\tilde{v}_3 = \\frac{1}{3\\sqrt{6}} \\left( 3\\begin{pmatrix}-6\\\\-4\\\\-4\\end{pmatrix} + 14\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix} + 2\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix} \\right) = \\frac{1}{3\\sqrt{6}} \\begin{pmatrix}-18+14+4\\\\-12+14-2\\\\-12+14-2\\end{pmatrix} = \\frac{1}{3\\sqrt{6}}\\begin{pmatrix}0\\\\0\\\\0\\end{pmatrix} = 0 $$\n得到的向量 $\\tilde{v}_3$ 是零向量。这标志着 Arnoldi 过程发生了精确分解。\n\n**精确分解分析**\n次对角线元素 $h_{32}$ 是归一化常数，即 $\\tilde{v}_3$ 的范数：\n$$ h_{32} = \\|\\tilde{v}_3\\|_2 = \\|0\\|_2 = 0 $$\n精确分解（$h_{j+1,j}=0$）意味着 Krylov 子空间“停滞”；其维度为 $j$。在这里，对于所有 $m \\geq 2$，$\\mathcal{K}_m(A, v_1)$ 的维度都是 2。这是因为空间 $\\mathcal{K}_2(A, v_1) = \\text{span}\\{v_1, v_2\\}$ 是一个 A-不变子空间。条件 $\\tilde{v}_3=0$ 等价于 $Av_2 = h_{12}v_1 + h_{22}v_2$，这证明了这种不变性。\n\nArnoldi 关系是 $AV_2 = V_3\\underline{H}_2$。由于 $h_{32}=0$，第二列的关系 $Av_2 = h_{12}v_1 + h_{22}v_2 + h_{32}v_3$ 简化为 $Av_2 = h_{12}v_1 + h_{22}v_2$，这与 $v_3$ 无关。\n问题要求我们通过一个明确的标准正交补全来定义 $v_3$。我们必须找到一个与 $v_1$ 和 $v_2$ 都正交的单位向量 $v_3$。设 $v_3=(x,y,z)^T$。\n$ v_1^T v_3 = \\frac{1}{\\sqrt{3}}(x+y+z) = 0 \\implies x+y+z=0 $\n$ v_2^T v_3 = \\frac{1}{\\sqrt{6}}(2x-y-z) = 0 \\implies 2x-y-z=0 $\n将这两个方程相加得到 $3x=0$，所以 $x=0$。这意味着 $y+z=0$，或 $z=-y$。\n该向量必须是 $\\begin{pmatrix}0\\\\y\\\\-y\\end{pmatrix}$ 的形式。要成为单位向量，其范数必须为 1：\n$ \\| \\begin{pmatrix}0\\\\y\\\\-y\\end{pmatrix} \\|_2 = \\sqrt{0^2+y^2+(-y)^2} = \\sqrt{2y^2} = |y|\\sqrt{2} = 1 \\implies |y|=\\frac{1}{\\sqrt{2}} $。\n我们选择 $y=\\frac{1}{\\sqrt{2}}$，这给出了一个可能的补全：$v_3 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}0\\\\1\\\\-1\\end{pmatrix}$。\n\n**最终构建的矩阵**\n标准正交基向量为：\n$v_1 = \\frac{1}{\\sqrt{3}}\\begin{pmatrix}1\\\\1\\\\1\\end{pmatrix}$, $v_2 = \\frac{1}{\\sqrt{6}}\\begin{pmatrix}2\\\\-1\\\\-1\\end{pmatrix}$, $v_3 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}0\\\\1\\\\-1\\end{pmatrix}$。\n矩阵 $V_3$ 是：\n$$ V_3=\\begin{bmatrix}v_1 & v_2 & v_3\\end{bmatrix} = \\begin{bmatrix} \\frac{1}{\\sqrt{3}} & \\frac{2}{\\sqrt{6}} & 0 \\\\ \\frac{1}{\\sqrt{3}} & -\\frac{1}{\\sqrt{6}} & \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{3}} & -\\frac{1}{\\sqrt{6}} & -\\frac{1}{\\sqrt{2}} \\end{bmatrix} $$\n由计算出的系数组装的 $(3 \\times 2)$ 上 Hessenberg 矩阵 $\\underline{H}_2$ 是：\n$$ \\underline{H}_2 = \\begin{pmatrix} h_{11} & h_{12} \\\\ h_{21} & h_{22} \\\\ 0 & h_{32} \\end{pmatrix} = \\begin{pmatrix} \\frac{20}{3} & -\\frac{7\\sqrt{2}}{3} \\\\ \\frac{8\\sqrt{2}}{3} & -\\frac{2}{3} \\\\ 0 & 0 \\end{pmatrix} $$\n我们关注的次对角线元素是 $h_{32}$，其值为 0。", "answer": "$$\\boxed{0}$$", "id": "3411908"}, {"introduction": "迭代法的收敛行为可能非常复杂，尤其是对于非正规(nonnormal)矩阵。本练习探讨了一个看似违反直觉的场景：一个高度非正规的矩阵反而导致了GMRES方法的瞬时收敛 [@problem_id:3411872]。通过这个计算，您将认识到一个关键点，即GMRES的性能不仅取决于矩阵本身，还深刻地依赖于初始残差向量与矩阵不变子空间之间的关系。", "problem": "考虑一个线性系统，它是一个一维稳态对流-扩散偏微分方程（PDE）的迎风偏置离散化的玩具模型，该模型导出一个高度非正规的上三角系数矩阵。设\n$$\nA=\\begin{bmatrix}1 & 100\\\\0 & 2\\end{bmatrix},\\quad b=\\begin{bmatrix}1\\\\0\\end{bmatrix},\\quad x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}.\n$$\n应用非重启动的广义最小残差（GMRES）方法（广义最小残差法（GMRES）是一种Krylov子空间方法，在第$k$次迭代时，它从$x_{0}+\\mathcal{K}_{k}(A,r_{0})$中选择$x_{k}$来最小化残差$r_{k}=b-Ax_{k}$的欧几里得范数，其中$r_{0}=b-Ax_{0}$且$\\mathcal{K}_{k}(A,r_{0})=\\operatorname{span}\\{r_{0},Ar_{0},\\dots,A^{k-1}r_{0}\\}$），使用标准的欧几里得内积且不加预处理。\n\n从$x_{0}$开始，显式计算前两个GMRES迭代解$x_{1}$和$x_{2}$以及相应的残差$r_{1}$和$r_{2}$，以及它们的欧几里得范数$\\|r_{1}\\|_{2}$和$\\|r_{2}\\|_{2}$。然后，仅使用基本定义（Krylov子空间、残差多项式、不变子空间和非正规性），定性地解释矩阵非正规性在这些数据的残差下降过程中所起的作用。\n\n对于最后的数值项，报告第二步残差欧几里得范数$\\|r_{2}\\|_{2}$的精确值。不要对答案进行四舍五入。", "solution": "我们从广义最小残差（GMRES）方法的定义性质开始。给定$A\\in\\mathbb{R}^{n\\times n}$，$b\\in\\mathbb{R}^{n}$和$x_{0}\\in\\mathbb{R}^{n}$，GMRES在第$k$次迭代时从$x_{0}+\\mathcal{K}_{k}(A,r_{0})$中选择一个近似解$x_{k}$，其中$\\mathcal{K}_{k}(A,r_{0})=\\operatorname{span}\\{r_{0},Ar_{0},\\dots,A^{k-1}r_{0}\\}$且$r_{0}=b-Ax_{0}$，以最小化欧几里得范数$\\|r_{k}\\|_{2}=\\|b-Ax_{k}\\|_{2}$。Arnoldi过程构建了$\\mathcal{K}_{k}(A,r_{0})$的一个标准正交基和一个上Hessenberg矩阵，该矩阵编码了$A$在该子空间上的投影；GMRES通过求解一个小的最小二乘问题来实现残差最小化。\n\n我们从基本原理开始计算。根据给定的数据，\n$$\nA=\\begin{bmatrix}1 & 100\\\\0 & 2\\end{bmatrix},\\quad b=\\begin{bmatrix}1\\\\0\\end{bmatrix},\\quad x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}.\n$$\n初始残差为\n$$\nr_{0}=b-Ax_{0}=b=\\begin{bmatrix}1\\\\0\\end{bmatrix},\\quad \\|r_{0}\\|_{2}=\\left\\|\\begin{bmatrix}1\\\\0\\end{bmatrix}\\right\\|_{2}=1.\n$$\n因此，第一个Arnoldi向量是\n$$\nv_{1}=\\frac{r_{0}}{\\|r_{0}\\|_{2}}=\\begin{bmatrix}1\\\\0\\end{bmatrix}.\n$$\n将$A$作用于$v_{1}$：\n$$\nw=Av_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}.\n$$\n将$w$投影到$v_{1}$上，得到第一个Hessenberg矩阵元素$h_{11}$和下一个Arnoldi残差：\n$$\nh_{11}=v_{1}^{\\top}w=\\begin{bmatrix}1&0\\end{bmatrix}\\begin{bmatrix}1\\\\0\\end{bmatrix}=1,\\qquad w\\leftarrow w-h_{11}v_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}-1\\cdot\\begin{bmatrix}1\\\\0\\end{bmatrix}=\\begin{bmatrix}0\\\\0\\end{bmatrix}.\n$$\n因此，$h_{21}=\\|w\\|_{2}=0$，这表明Arnoldi过程在第1步发生中断。这种中断是良性的，意味着$\\mathcal{K}_{1}(A,r_{0})$是$A$的一个不变子空间。\n\n在迭代$k=1$时，GMRES求解$1\\times 1$的最小二乘问题\n$$\n\\min_{y\\in\\mathbb{R}}\\left\\|\\beta e_{1}-H_{1}y\\right\\|_{2},\\quad \\beta=\\|r_{0}\\|_{2}=1,\\quad H_{1}=[h_{11}]=[1].\n$$\n最小化子是$y_{1}=1$。第一个迭代解是\n$$\nx_{1}=x_{0}+V_{1}y_{1}=x_{0}+v_{1}\\,y_{1}=\\begin{bmatrix}0\\\\0\\end{bmatrix}+1\\cdot\\begin{bmatrix}1\\\\0\\end{bmatrix}=\\begin{bmatrix}1\\\\0\\end{bmatrix}.\n$$\n相应的残差是\n$$\nr_{1}=b-Ax_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix}-\\begin{bmatrix}1\\\\0\\end{bmatrix}=\\begin{bmatrix}0\\\\0\\end{bmatrix},\\quad \\|r_{1}\\|_{2}=0.\n$$\n因为在迭代$k=1$时残差已经为零，GMRES终止。如果形式上进行到$k=2$，迭代解保持不变：\n$$\nx_{2}=x_{1}=\\begin{bmatrix}1\\\\0\\end{bmatrix},\\quad r_{2}=b-Ax_{2}=\\begin{bmatrix}0\\\\0\\end{bmatrix},\\quad \\|r_{2}\\|_{2}=0.\n$$\n\n现在我们使用基本概念来解释非正规性在观测到的残差下降中所起的作用。如果$AA^{\\top}\\neq A^{\\top}A$，则矩阵$A$是非正规的；这里，\n$$\nAA^{\\top}=\\begin{bmatrix}10001&200\\\\200&4\\end{bmatrix}\\neq \\begin{bmatrix}1&100\\\\100&10004\\end{bmatrix}=A^{\\top}A,\n$$\n所以$A$是非正规的。非正规性与非正交的特征向量以及$A$的幂或作用于$A$的残差多项式的范数可能出现瞬时增长相关联，即使所有特征值都位于复平面中可能预示衰减的区域。然而，Krylov子空间方法的行为不僅取决于$A$的谱，还取决于初始残差$r_{0}$如何投影到$A$的不变子空间上。\n\n在我们的例子中，$v_{1}=r_{0}/\\|r_{0}\\|_{2}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$是$A$的一个特征向量，对应的特征值为$\\lambda_{1}=1$，因为\n$$\nA\\begin{bmatrix}1\\\\0\\end{bmatrix}=\\begin{bmatrix}1\\\\0\\end{bmatrix}.\n$$\n因此，$\\mathcal{K}_{1}(A,r_{0})=\\operatorname{span}\\{r_{0}\\}$是$A$的一个不变子空间。一步之后的GMRES残差可以用一个满足$p_{1}(0)=1$的1次残差多项式$p_{1}$表示为\n$$\nr_{1}=p_{1}(A)r_{0}.\n$$\n因为$r_{0}$位于与$\\lambda_{1}=1$相关联的不变子空间中，选择$p_{1}(t)=1-t$会得到$r_{1}=(I-A)r_{0}=0$。GMRES通过在$\\mathcal{K}_{1}(A,r_{0})$上最小化残差范数，有效地发现了这个零化多项式，并在单步内得到$r_{1}=0$。换句话说，尽管$A$具有强非正规性（大的上非对角元素），但初始残差与一个不变的特征方向对齐，该方向与非正规耦合解耦；这防止了任何瞬时放大，并导致了立即收敛。如果$r_{0}$在另一个特征方向上有分量，那么特征向量的非正交性可能会在最终衰减之前引发非平凡的瞬态行为，但由于$r_{0}$的特殊对齐，这种情况在这里没有发生。\n\n因此，第二步残差欧几里得范数的精确值是$\\|r_{2}\\|_{2}=0$。", "answer": "$$\\boxed{0}$$", "id": "3411872"}, {"introduction": "在实践中，我们通常用一个小的残差范数来判断迭代解的质量，但这可能具有误导性。本练习揭示了求解非正规线性系统时的一个关键问题：一个极小的残差范数可能与一个巨大的真实误差并存 [@problem_id:3411893]。通过分析一个典型例子，您将学习如何量化这种残差与误差之间的放大效应，并理解为什么仅仅监控残差范数可能导致我们接受一个实际上很差的解。", "problem": "考虑线性系统 $A x = b$，该系统源于对一维常系数线性平流方程 $u_{t} + c\\,u_{x} = f$ 在双单元均匀网格上使用齐次狄利克雷边界条件和一阶迎风空间离散化进行后向欧拉时间离散化。对于单个时间步长 $\\Delta t$ 和网格间距 $\\Delta x$，得到的 $2 \\times 2$ 系统矩阵可以写成 $A = I + N$ 的形式，其中 $I$ 是单位矩阵，$N$ 是严格上三角矩阵，其 $(N)_{12} = M$，所有其他项均为零，其中 $M = c\\,\\Delta t/\\Delta x > 0$。对于大的 $M$ 值，该矩阵 $A$ 是高度非正规的。\n\n设 $x$ 为精确解，$x_{k}$ 为由Krylov子空间方法（如广义最小残差法(GMRES)）产生的第 $k$ 次迭代解。将残差表示为 $r_{k} = b - A x_{k}$，误差表示为 $e_{k} = x - x_{k}$。对于任何非奇异矩阵，基本关系给出 $A e_{k} = r_{k}$，因此 $e_{k} = A^{-1} r_{k}$。\n\n通过Schur分解定义偏离正规性：如果 $A = Q T Q^{*}$，其中 $Q$ 是酉矩阵，$T = \\Lambda + N_{\\text{schur}}$ 是上三角矩阵（$\\Lambda$ 是对角矩阵，$N_{\\text{schur}}$ 是严格上三角矩阵），则设 $\\delta(A) = \\|N_{\\text{schur}}\\|_{2}$。对于当前的 $2 \\times 2$ 矩阵，$A$ 已经是上三角矩阵，所以 $\\delta(A) = \\|N\\|_{2} = M$。\n\n假设经过 $k$ 次迭代后，残差为 $r_{k} = \\begin{pmatrix} 0 \\\\ \\varepsilon \\end{pmatrix}$，其中 $\\varepsilon = 10^{-6}$，其范数很小。量化残差范数和误差范数之间可能差距的放大因子由算子范数 $\\|A^{-1}\\|_{2}$ 给出，因为 $\\|e_{k}\\|_{2} \\leq \\|A^{-1}\\|_{2} \\,\\|r_{k}\\|_{2}$。\n\n仅使用上述结构性事实和 $\\delta(A)$ 的定义，推导 $\\|A^{-1}\\|_{2}$ 关于 $M = \\delta(A)$ 的解析表达式，然后在 $M = 10^{6}$ 处计算该表达式的值。报告残差-误差放大因子估计值 $G_{\\text{est}} = \\|A^{-1}\\|_{2}$，四舍五入到四位有效数字。最终报告值中不包含任何单位。", "solution": "问题陈述已经过严格验证，被认为是数值线性代数领域一个有效、适定的问题。它具有科学依据、内容自洽且客观。不存在矛盾、歧义或不成立的前提。因此，我们可以着手求解。\n\n问题要求给出由 $G_{\\text{est}} = \\|A^{-1}\\|_{2}$ 给出的残差-误差放大因子的解析表达式，以及其在特定情况下的数值。矩阵 $A$ 是为 $2 \\times 2$ 系统定义的，形式为 $A = I + N$，其中 $I$ 是单位矩阵，$N$ 是一个严格上三角矩阵。\n\n根据问题描述，我们有：\n$I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n矩阵 $N$ 是严格上三角矩阵，其中 $(N)_{12} = M$，所有其他项均为零。因此，\n$N = \\begin{pmatrix} 0 & M \\\\ 0 & 0 \\end{pmatrix}$\n所以系统矩阵 $A$ 是：\n$$A = I + N = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} 0 & M \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix}$$\n问题陈述指出，偏离正规性为 $\\delta(A) = M$。\n\n为了找到放大因子 $\\|A^{-1}\\|_{2}$，我们首先计算 $A$ 的逆矩阵。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵由 $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$ 给出。\n对于我们的矩阵 $A$，有 $a=1, b=M, c=0, d=1$。行列式为 $\\det(A) = (1)(1) - (M)(0) = 1$。\n其逆矩阵是：\n$$A^{-1} = \\frac{1}{1} \\begin{pmatrix} 1 & -M \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & -M \\\\ 0 & 1 \\end{pmatrix}$$\n\n接下来，我们计算 $A^{-1}$ 的2-范数。任何矩阵 $B$ 的2-范数，记为 $\\|B\\|_{2}$，是矩阵乘积 $B^*B$ 的最大特征值的平方根，其中 $B^*$ 是 $B$ 的共轭转置。这里，$B = A^{-1}$。由于 $A^{-1}$ 的所有项都是实数，其共轭转置就是其转置。\n$$(A^{-1})^* = (A^{-1})^T = \\begin{pmatrix} 1 & 0 \\\\ -M & 1 \\end{pmatrix}$$\n现在，我们构建乘积 $(A^{-1})^*A^{-1}$：\n$$(A^{-1})^*A^{-1} = \\begin{pmatrix} 1 & 0 \\\\ -M & 1 \\end{pmatrix} \\begin{pmatrix} 1 & -M \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (1)(1)+(0)(0) & (1)(-M)+(0)(1) \\\\ (-M)(1)+(1)(0) & (-M)(-M)+(1)(1) \\end{pmatrix} = \\begin{pmatrix} 1 & -M \\\\ -M & M^2+1 \\end{pmatrix}$$\n该矩阵的特征值 $\\lambda$ 是其特征方程 $\\det((A^{-1})^*A^{-1} - \\lambda I) = 0$ 的根。\n$$\\det\\begin{pmatrix} 1-\\lambda & -M \\\\ -M & M^2+1-\\lambda \\end{pmatrix} = 0$$\n$$(1-\\lambda)(M^2+1-\\lambda) - (-M)(-M) = 0$$\n$$M^2 + 1 - \\lambda - \\lambda M^2 - \\lambda + \\lambda^2 - M^2 = 0$$\n$$\\lambda^2 - (M^2+2)\\lambda + 1 = 0$$\n我们使用二次公式求解这个关于 $\\lambda$ 的二次方程：\n$$\\lambda = \\frac{-[-(M^2+2)] \\pm \\sqrt{[-(M^2+2)]^2 - 4(1)(1)}}{2(1)} = \\frac{M^2+2 \\pm \\sqrt{(M^2+2)^2 - 4}}{2}$$\n$$\\lambda = \\frac{M^2+2 \\pm \\sqrt{M^4+4M^2+4 - 4}}{2} = \\frac{M^2+2 \\pm \\sqrt{M^4+4M^2}}{2}$$\n由于给定 $M>0$，我们可以从平方根中提取因子 $M^2$：\n$$\\lambda = \\frac{M^2+2 \\pm \\sqrt{M^2(M^2+4)}}{2} = \\frac{M^2+2 \\pm M\\sqrt{M^2+4}}{2}$$\n两个特征值是 $\\lambda_1 = \\frac{M^2+2 + M\\sqrt{M^2+4}}{2}$ 和 $\\lambda_2 = \\frac{M^2+2 - M\\sqrt{M^2+4}}{2}$。\n2-范数的平方 $\\|A^{-1}\\|_{2}^2$ 是这两个特征值中较大的一个，即 $\\lambda_{max}$。\n$$\\lambda_{max} = \\frac{M^2+2 + M\\sqrt{M^2+4}}{2}$$\n因此，问题的第一部分得到解决：$\\|A^{-1}\\|_{2}$ 关于 $M = \\delta(A)$ 的解析表达式为：\n$$\\|A^{-1}\\|_{2} = \\sqrt{\\frac{M^2+2 + M\\sqrt{M^2+4}}{2}}$$\n第二部分是在 $M = 10^6$ 时计算该表达式的值。设 $G_{\\text{est}} = \\|A^{-1}\\|_{2}$。\n$$G_{\\text{est}} = \\sqrt{\\frac{(10^6)^2+2 + 10^6\\sqrt{(10^6)^2+4}}{2}} = \\sqrt{\\frac{10^{12}+2 + 10^6\\sqrt{10^{12}+4}}{2}}$$\n对于一个非常大的 $M$ 值，例如 $M=10^6$，我们可以分析该表达式的行为。项 $\\sqrt{M^2+4}$ 非常接近 $M$。使用二项式展开，$\\sqrt{M^2+4} = M\\sqrt{1+4/M^2} \\approx M(1 + \\frac{1}{2}\\frac{4}{M^2}) = M + \\frac{2}{M}$。\n将此代入 $\\lambda_{max}$ 的表达式中：\n$$\\lambda_{max} \\approx \\frac{M^2+2 + M(M+2/M)}{2} = \\frac{M^2+2+M^2+2}{2} = M^2+2$$\n所以，$\\|A^{-1}\\|_2 \\approx \\sqrt{M^2+2} \\approx M$。\n对于 $M=10^6$，$G_{\\text{est}}$ 的值预计将非常接近 $10^6$。\n精确的数值计算得出：\n$$G_{\\text{est}} \\approx 1000000.000001$$\n用科学记数法表示，这是 $1.000000000001 \\times 10^6$。\n问题要求将此值四舍五入到四位有效数字。\n$$G_{\\text{est}} \\approx 1.000 \\times 10^6$$\n这个结果突显了在具有高度非正规矩阵的系统中，即使残差很小，也可能存在巨大的误差放大。范数为 $\\|r_k\\|_2 = \\varepsilon = 10^{-6}$ 的小残差 $r_k$ 可能对应一个范数 $\\|e_k\\|_2$ 大至 $\\|A^{-1}\\|_2\\|r_k\\|_2 \\approx (10^6)(10^{-6}) = 1$ 的误差 $e_k$。误差范数的量级可以为1，这意味着尽管残差非常小，计算出的解 $x_k$ 可能没有一位是正确的。", "answer": "$$\\boxed{1.000 \\times 10^6}$$", "id": "3411893"}]}