{"hands_on_practices": [{"introduction": "在以单元为中心的格式中，解变量定义在网格单元的中心，而不是在物理边界上。这就提出了一个问题：我们如何精确地施加在边界上指定的狄利克雷（Dirichlet）条件？本练习将通过一个基本且直观的线性外插法来解决这个问题，通过在计算域外设置一个“虚拟单元”的值来确保边界条件得以满足 [@problem_id:3368871]。这种方法是有限体积法中处理边界条件的一项基本技术。", "problem": "考虑一个一维域 $[0,L]$，使用均匀的单元中心离散化方法来求解一个偏微分方程 (PDE)。设存在 $N$ 个内部单元，因此网格间距为 $\\Delta x = L/N$。单元中心的坐标为 $x_{i} = (i-\\tfrac{1}{2})\\Delta x$（其中 $i=1,\\dots,N$），并在 $x_{0} = -\\tfrac{1}{2}\\Delta x$ 和 $x_{N+1} = L + \\tfrac{1}{2}\\Delta x$ 处设置两个虚拟单元中心。给定狄利克雷边界条件 $u(0) = \\alpha$ 和 $u(L) = \\beta$。在单元中心的有限差分或有限体积格式中，边界附近的离散模板需要虚拟值 $u_{0}$ 和 $u_{N+1}$。\n\n仅从单元中心网格的几何定义和狄利克雷边界数据出发，通过要求跨越每个边界的线性重构在物理边界处与给定的边界值相匹配来施加边界条件，同时使用位于 $x=\\Delta x/2$（左侧）和 $x=L-\\Delta x/2$（右侧）的相邻内部单元中心值。具体而言，在左边界，使用一个通过 $(x_{0},u_{0})$ 和 $(x_{1},u_{1})$ 的线性函数，其在 $x=0$ 处的值等于 $\\alpha$；在右边界，使用一个通过 $(x_{N},u_{N})$ 和 $(x_{N+1},u_{N+1})$ 的线性函数，其在 $x=L$ 处的值等于 $\\beta$。\n\n推导虚拟值 $u_{0}$ 和 $u_{N+1}$ 关于 $\\alpha$、$\\beta$、$u_{1}$ 和 $u_{N}$ 的闭式表达式。你的最终答案必须表示为一个包含两个虚拟值的符号形式的单行矩阵。不需要进行数值计算或四舍五入。", "solution": "该问题陈述已经过验证，被认为是科学严谨、适定、客观和完整的。它描述了在单元中心有限差分或有限体积格式中实施狄利克雷边界条件的标准且正确的程序。可以根据所提供的信息推导出严谨的解。\n\n我们的任务是通过施加狄利克雷边界条件 $u(0) = \\alpha$ 和 $u(L) = \\beta$ 来求出虚拟单元变量 $u_0$ 和 $u_{N+1}$ 的值。施加过程通过跨边界的线性重构来完成。\n\n首先，我们考虑位于 $x=0$ 的左边界。问题陈述要求我们必须使用一个通过点 $(x_0, u_0)$ 和 $(x_1, u_1)$ 的线性函数，并要求其在 $x=0$ 处的值等于 $\\alpha$。这些点的坐标由网格定义给出：\n$x_0 = -\\frac{1}{2}\\Delta x$\n$x_1 = \\frac{1}{2}\\Delta x$\n因此，这两个点是 $(-\\frac{1}{2}\\Delta x, u_0)$ 和 $(\\frac{1}{2}\\Delta x, u_1)$。\n\n一个通过两点 $(x_a, y_a)$ 和 $(x_b, y_b)$ 的线性函数 $u(x)$ 可以用点斜式写出：\n$u(x) = y_a + \\frac{y_b - y_a}{x_b - x_a}(x - x_a)$\n代入我们的点 $(x_0, u_0)$ 和 $(x_1, u_1)$，我们得到：\n$u(x) = u_0 + \\frac{u_1 - u_0}{x_1 - x_0}(x - x_0)$\nx坐标的差值为 $x_1 - x_0 = \\frac{1}{2}\\Delta x - (-\\frac{1}{2}\\Delta x) = \\Delta x$。\n将此结果和 $x_0$ 的表达式代入方程，得到：\n$u(x) = u_0 + \\frac{u_1 - u_0}{\\Delta x}(x - (-\\frac{1}{2}\\Delta x))$\n$u(x) = u_0 + \\frac{u_1 - u_0}{\\Delta x}(x + \\frac{1}{2}\\Delta x)$\n\n现在我们施加边界条件 $u(0) = \\alpha$：\n$\\alpha = u(0) = u_0 + \\frac{u_1 - u_0}{\\Delta x}(0 + \\frac{1}{2}\\Delta x)$\n$\\alpha = u_0 + \\frac{u_1 - u_0}{\\Delta x}(\\frac{1}{2}\\Delta x)$\n$\\alpha = u_0 + \\frac{1}{2}(u_1 - u_0)$\n$\\alpha = u_0 + \\frac{1}{2}u_1 - \\frac{1}{2}u_0$\n$\\alpha = \\frac{1}{2}u_0 + \\frac{1}{2}u_1$\n该方程表明，边界上的值是相邻虚拟单元中心和内部单元中心值的算术平均值，这是预料之中的，因为边界 $x=0$ 是位置 $x_0$ 和 $x_1$ 的几何中点。\n\n为了求出虚拟值 $u_0$，我们对其求解：\n$2\\alpha = u_0 + u_1$\n$u_0 = 2\\alpha - u_1$\n\n接下来，我们考虑位于 $x=L$ 的右边界。过程是类似的。我们使用一个通过点 $(x_N, u_N)$ 和 $(x_{N+1}, u_{N+1})$ 的线性函数，并要求其在 $x=L$ 处的值为 $\\beta$。坐标为：\n$x_N = L - \\frac{1}{2}\\Delta x$\n$x_{N+1} = L + \\frac{1}{2}\\Delta x$\n这两个点是 $(L - \\frac{1}{2}\\Delta x, u_N)$ 和 $(L + \\frac{1}{2}\\Delta x, u_{N+1})$。\n\n使用通过点 $(x_N, u_N)$ 的直线点斜式：\n$u(x) = u_N + \\frac{u_{N+1} - u_N}{x_{N+1} - x_N}(x - x_N)$\nx坐标的差值为 $x_{N+1} - x_N = (L + \\frac{1}{2}\\Delta x) - (L - \\frac{1}{2}\\Delta x) = \\Delta x$。\n将此结果和 $x_N$ 的表达式代入方程，得到：\n$u(x) = u_N + \\frac{u_{N+1} - u_N}{\\Delta x}(x - (L - \\frac{1}{2}\\Delta x))$\n\n现在我们施加边界条件 $u(L) = \\beta$：\n$\\beta = u(L) = u_N + \\frac{u_{N+1} - u_N}{\\Delta x}(L - (L - \\frac{1}{2}\\Delta x))$\n$\\beta = u_N + \\frac{u_{N+1} - u_N}{\\Delta x}(\\frac{1}{2}\\Delta x)$\n$\\beta = u_N + \\frac{1}{2}(u_{N+1} - u_N)$\n$\\beta = u_N + \\frac{1}{2}u_{N+1} - \\frac{1}{2}u_N$\n$\\beta = \\frac{1}{2}u_N + \\frac{1}{2}u_{N+1}$\n和之前一样，边界上的值是相邻内部单元中心和虚拟单元中心值的算术平均值，因为 $x=L$ 是 $x_N$ 和 $x_{N+1}$ 的中点。\n\n为了求出虚拟值 $u_{N+1}$，我们对其求解：\n$2\\beta = u_N + u_{N+1}$\n$u_{N+1} = 2\\beta - u_N$\n\n推导出的虚拟值表达式为 $u_0 = 2\\alpha - u_1$ 和 $u_{N+1} = 2\\beta - u_N$。根据要求，这些表达式是用给定的边界值 $\\alpha$ 和 $\\beta$ 以及相邻的内部单元值 $u_1$ 和 $u_N$ 来表示的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\alpha - u_1  & 2\\beta - u_N\n\\end{pmatrix}\n}\n$$", "id": "3368871"}, {"introduction": "与以单元为中心的格式不同，在以顶点为中心的格式中，节点可以直接位于物理边界上，这为施加狄利克雷条件提供了便利。然而，当处理涉及导数的诺伊曼（Neumann）边界条件时，我们仍然需要一种方法来关联边界内外的数值。本练习将探讨如何利用泰勒级数展开来推导出一个“虚拟顶点”的值，以确保离散格式满足指定的精度要求 [@problem_id:3368909]。这是有限差分法分析中的一块基石，它展示了如何将数学理论转化为稳健的数值实现。", "problem": "考虑一个定义在区间 $[0,L]$ 上的一维偏微分方程 (PDE)，该方程将通过一个以顶点为中心的格式在间距为 $h>0$ 的均匀网格上进行离散化。对于整数 $j$，顶点位于 $x_j=jh$，其中 $x_0=0$ 是边界顶点。令 $u_j$ 表示在顶点 $x_j$ 处精确解 $u(x)$ 的离散近似值。为了在 $x_0$ 处构造一个二阶精度的内部格式，我们在 $x_{-1}=-h$ 处引入一个虚拟顶点值 $u_{-1}$。\n\n施加诺伊曼边界条件 $u_x(0)=\\gamma$，其中 $\\gamma$ 是一个给定的常数。离散边界通量将通过一种邻近边界的单边差分计算，该差分使用虚拟顶点来模拟对称性，即跨越边界的两点公式，\n$$\n\\frac{u_1 - u_{-1}}{2h}.\n$$\n从第一性原理出发，以导数的定义和标准的泰勒展开为起点，推导虚拟顶点值 $u_{-1}$ 的表达式（用 $u_1$、$h$ 和 $\\gamma$ 表示），使得在 $x_0$ 处的上述单边差分等于 $\\gamma$，并且在 $h$ 上具有二阶精度。以闭合形式提供 $u_{-1}$ 的最终表达式。不需要进行四舍五入，最终表达式中也不应包含任何单位。", "solution": "问题要求在一个以顶点为中心的有限差分格式中，推导用于实现诺伊曼边界条件 $u_x(0) = \\gamma$ 的虚拟顶点值 $u_{-1}$ 的表达式。推导必须从第一性原理出发，使用泰勒级数，并确保最终的实现是二阶精度的。\n\n设偏微分方程的精确解由函数 $u(x)$ 表示。区域通过间距为 $h$ 的均匀网格进行离散化，其中顶点位置为 $x_j = jh$。边界位于 $x_0 = 0$。在顶点 $x_j$ 处的离散值用 $u_j$ 表示，它是 $u(x_j)$ 的一个近似值。为了处理 $x_0=0$ 处的边界条件，我们在 $x_{-1} = -h$ 处引入一个虚拟顶点，其对应值为 $u_{-1}$。\n\n推导的核心在于泰勒定理。我们将函数 $u(x)$ 在边界点 $x_0 = 0$ 周围展开为泰勒级数。在相邻顶点 $x_1 = h$ 和虚拟顶点位置 $x_{-1} = -h$ 处的解的值可以表示为：\n$$u(h) = u(0) + h u_x(0) + \\frac{h^2}{2!} u_{xx}(0) + \\frac{h^3}{3!} u_{xxx}(0) + \\mathcal{O}(h^4)$$\n$$u(-h) = u(0) - h u_x(0) + \\frac{h^2}{2!} u_{xx}(0) - \\frac{h^3}{3!} u_{xxx}(0) + \\mathcal{O}(h^4)$$\n其中 $u_x(0)$、$u_{xx}(0)$ 和 $u_{xxx}(0)$ 分别表示 $u(x)$ 在 $x=0$ 处的一阶、二阶和三阶导数。\n\n问题指定边界通量由类中心差分公式 $\\frac{u_1 - u_{-1}}{2h}$ 来近似。为了分析这个公式作为 $u_x(0)$ 近似的精度，我们考察其局部截断误差 (LTE)。局部截断误差是通过将精确解的值 $u(x_j)$ 代入离散公式，并将结果与它所要近似的精确量进行比较来找到的。在这里，我们分析表达式 $\\frac{u(h) - u(-h)}{2h}$。\n\n从 $u(h)$ 的泰勒展开式中减去 $u(-h)$ 的泰勒展开式，我们得到：\n$$u(h) - u(-h) = \\left( u(0) + h u_x(0) + \\frac{h^2}{2} u_{xx}(0) + \\frac{h^3}{6} u_{xxx}(0) \\right) - \\left( u(0) - h u_x(0) + \\frac{h^2}{2} u_{xx}(0) - \\frac{h^3}{6} u_{xxx}(0) \\right) + \\mathcal{O}(h^5)$$\n$h$ 的偶数次幂项相互抵消：\n$$u(h) - u(-h) = 2h u_x(0) + \\frac{2h^3}{6} u_{xxx}(0) + \\mathcal{O}(h^5) = 2h u_x(0) + \\frac{h^3}{3} u_{xxx}(0) + \\mathcal{O}(h^5)$$\n\n两边除以 $2h$ 得到导数的中心差分近似表达式：\n$$\\frac{u(h) - u(-h)}{2h} = u_x(0) + \\frac{h^2}{6} u_{xxx}(0) + \\mathcal{O}(h^4)$$\n\n局部截断误差 $\\tau$ 是离散近似（使用精确解的值）与精确导数之间的差值：\n$$\\tau = \\frac{u(h) - u(-h)}{2h} - u_x(0) = \\frac{h^2}{6} u_{xxx}(0) + \\mathcal{O}(h^4)$$\n由于误差的首项与 $h^2$ 成正比，这证实了中心差分公式为一阶导数 $u_x(0)$ 提供了一个二阶精度的近似。\n\n在确定了所选公式的二阶精度之后，我们现在用它来定义虚拟顶点值 $u_{-1}$。数值格式通过将导数的离散近似值设置为指定值 $\\gamma$ 来施加边界条件。我们用它们的离散对应值 $u_1$ 和 $u_{-1}$ 来替换精确值 $u(h)$ 和 $u(-h)$。$u_{-1}$ 的值不是 $u(-h)$ 的直接近似，而是由以下强制施加边界条件的代数关系定义：\n$$\\frac{u_1 - u_{-1}}{2h} = \\gamma$$\n这个方程是诺伊曼边界条件 $u_x(0) = \\gamma$ 的离散实现，并且如局部截断误差分析所示，它是一个二阶精度的实现。\n\n最后一步是解这个方程以求得虚拟顶点值 $u_{-1}$。\n两边乘以 $2h$：\n$$u_1 - u_{-1} = 2h\\gamma$$\n重新整理各项以分离出 $u_{-1}$：\n$$u_{-1} = u_1 - 2h\\gamma$$\n该表达式用内部顶点值 $u_1$、网格间距 $h$ 和边界条件常数 $\\gamma$ 表示了虚拟顶点 $u_{-1}$ 的值，这与一个二阶精度格式相一致。", "answer": "$$\\boxed{u_1 - 2h\\gamma}$$", "id": "3368909"}, {"introduction": "掌握了基本边界条件的处理后，我们将探讨网格配置选择对复杂系统（如流体流动）的深远影响。本练习将揭示一个经典的陷阱：一个看似合理的离散化选择可能导致非物理的数值伪影。通过分析不可压斯托克斯（Stokes）方程，您将证明一个简单的同位（collocated）网格（变量均位于顶点）无法捕捉特定的压力振荡模式，即所谓的“棋盘”不稳定性，而交错网格（压力位于单元中心）则能正确耦合压力和速度 [@problem_id:3368859]。这个例子鲜明地突出了不同网格排列在稳定性和物理保真度之间的关键权衡。", "problem": "考虑单位正方形域上的不可压缩斯托克斯方程，两个方向均采用周期性边界条件。方程由动量平衡方程 $-\\nabla p + \\mu \\Delta \\boldsymbol{u} = \\boldsymbol{0}$ 和不可压缩约束 $\\nabla \\cdot \\boldsymbol{u} = 0$ 给出，其中 $p$ 是压力，$\\mu$ 是动力粘度，$\\boldsymbol{u} = (u,v)$ 是速度。假设一个由投影法产生的半离散压力到速度更新步骤：由给定压力场预测的速度为 $\\boldsymbol{u}^{*} = -\\frac{\\Delta t}{\\rho} \\nabla p$，其中 $\\Delta t$ 是时间步长，$\\rho$ 是密度。在此预测阶段忽略扩散项。\n\n在具有 $N \\times N$ 个点和网格间距 $h = \\frac{1}{N}$ 的均匀方形网格上，考虑两种空间离散化方案：\n\n1. 顶点中心配置排列，其中 $u$、$v$ 和 $p$ 都存储在顶点 $\\{(i,j)\\}_{i,j=0}^{N-1}$ 上。在顶点 $(i,j)$ 处的离散梯度 $\\nabla p$ 由标准的二点中心差分近似，\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2h}, \n\\quad \n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2h}.\n$$\n通过节点速度的线性插值，定义用于顶点 $(i,j)$ 处离散散度的面法向预测速度：\n$$\nu^{*}_{i+\\frac{1}{2},j} = \\frac{u^{*}_{i+1,j} + u^{*}_{i,j}}{2}, \n\\quad \nu^{*}_{i-\\frac{1}{2},j} = \\frac{u^{*}_{i,j} + u^{*}_{i-1,j}}{2},\n$$\n$$\nv^{*}_{i,j+\\frac{1}{2}} = \\frac{v^{*}_{i,j+1} + v^{*}_{i,j}}{2}, \n\\quad \nv^{*}_{i,j-\\frac{1}{2}} = \\frac{v^{*}_{i,j} + v^{*}_{i,j-1}}{2}.\n$$\n则顶点 $(i,j)$ 处的离散散度为\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{i,j} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h}.\n$$\n\n2. 单元中心排列，其中 $p$ 存储在单元中心 $\\{(i,j)\\}_{i,j=0}^{N-1}$，而 $u$ 和 $v$ 存储在相应的单元面上。进入面法向预测速度的离散梯度取为单单元差分：\n$$\nu^{*}_{i+\\frac{1}{2},j} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i+1,j} - p_{i,j}}{h}, \n\\quad \nv^{*}_{i,j+\\frac{1}{2}} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j+1} - p_{i,j}}{h}.\n$$\n单元中心 $(i,j)$ 处的离散散度为\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{i,j} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h}.\n$$\n\n为配置排列构造棋盘格压力模态作为反例：\n- 对于顶点中心配置情况，在顶点处定义 $p_{i,j} = p_{0} (-1)^{i+j}$，其中 $p_{0}$ 是一个常数振幅。\n- 对于单元中心情况，在单元中心处定义 $p_{i,j} = p_{0} (-1)^{i+j}$。\n\n从上述基本定义出发，不引入任何额外的稳定化或滤波，推导离散的预测速度场，并计算两种排列在棋盘格压力模态下在一般位置 $(i,j)$ 处的相应离散散度。然后，取每个散度表达式的绝对值，并将 $p_{0}$、$\\Delta t$、$\\rho$ 和 $h$ 视为符号常数，计算定义为如下的比率 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}}\\right|}{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}}\\right|}.\n$$\n\n以单个简化的实数或闭式解析表达式的形式给出最终答案。不需要单位。如果您选择引入任何数值近似，请将最终答案四舍五入到四位有效数字。", "solution": "目标是计算在指定的棋盘格压力模态下，比率 $\\mathcal{R} = \\frac{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}}\\right|}{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}}\\right|}$ 的值。这需要推导顶点中心配置排列和单元中心排列下预测速度场 $(\\nabla \\cdot \\boldsymbol{u}^{*})$ 的离散散度。\n\n首先，我们分析顶点中心配置排列。\n压力场在顶点处定义为 $p_{i,j} = p_{0} (-1)^{i+j}$，其中 $p_{0}$ 是一个常数振幅。在顶点 $(i,j)$ 处的预测速度分量由 $\\boldsymbol{u}^{*} = -\\frac{\\Delta t}{\\rho} \\nabla p$ 给出，其中梯度由中心差分近似。我们来计算顶点 $(i,j)$ 处离散压力梯度的分量：\n$x$ 分量为：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2h} = \\frac{p_{0}(-1)^{(i+1)+j} - p_{0}(-1)^{(i-1)+j}}{2h}\n$$\n提出公因子：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( (-1)^{1} - (-1)^{-1} \\right) = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( -1 - (-1) \\right) = 0\n$$\n类似地，$y$ 分量为：\n$$\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2h} = \\frac{p_{0}(-1)^{i+(j+1)} - p_{0}(-1)^{i+(j-1)}}{2h}\n$$\n$$\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( (-1)^{1} - (-1)^{-1} \\right) = \\frac{p_{0}(-1)^{i+j}}{2h} \\left( -1 - (-1) \\right) = 0\n$$\n由于离散压力梯度处处为零，因此顶点处的预测速度分量也为零：\n$$\nu^{*}_{i,j} = -\\frac{\\Delta t}{\\rho} \\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = 0\n$$\n$$\nv^{*}_{i,j} = -\\frac{\\Delta t}{\\rho} \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = 0\n$$\n散度是使用面中心的速度计算的，而这些速度是通过节点速度的线性插值获得的。由于所有节点速度都为零，插值得到的面法向速度也为零：\n$$\nu^{*}_{i \\pm \\frac{1}{2},j} = 0 \\quad \\text{and} \\quad v^{*}_{i,j \\pm \\frac{1}{2}} = 0\n$$\n因此，顶点 $(i,j)$ 处的离散散度恒为零：\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h} = \\frac{0 - 0}{h} + \\frac{0 - 0}{h} = 0\n$$\n这表明，没有稳定化的配置排列对棋盘格压力模态完全不敏感。\n\n接下来，我们分析单元中心排列。\n压力场在单元中心处定义为 $p_{i,j} = p_{0} (-1)^{i+j}$。预测的面法向速度是直接根据相邻单元中心的压力差计算的。我们来计算单元 $(i,j)$ 各个面上的速度：\n单元右侧面上的速度为：\n$$\nu^{*}_{i+\\frac{1}{2},j} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i+1,j} - p_{i,j}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{(i+1)+j} - p_{0}(-1)^{i+j} \\right)\n$$\n$$\nu^{*}_{i+\\frac{1}{2},j} = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} ((-1)^{1} - 1) = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} (-2) = \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\n单元左侧面上的速度为：\n$$\nu^{*}_{i-\\frac{1}{2},j} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j} - p_{i-1,j}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{i+j} - p_{0}(-1)^{(i-1)+j} \\right)\n$$\n$$\nu^{*}_{i-\\frac{1}{2},j} = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} (1 - (-1)^{-1}) = -\\frac{\\Delta t p_{0}}{\\rho h} (-1)^{i+j} (2) = -\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\n类似地，对于顶面和底面上的速度：\n$$\nv^{*}_{i,j+\\frac{1}{2}} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j+1} - p_{i,j}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{i+(j+1)} - p_{0}(-1)^{i+j} \\right) = \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\n$$\nv^{*}_{i,j-\\frac{1}{2}} = -\\frac{\\Delta t}{\\rho} \\frac{p_{i,j} - p_{i,j-1}}{h} = -\\frac{\\Delta t}{\\rho h} \\left( p_{0}(-1)^{i+j} - p_{0}(-1)^{i+(j-1)} \\right) = -\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\n$$\n现在，我们计算单元中心 $(i,j)$ 处的离散散度：\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{u^{*}_{i+\\frac{1}{2},j} - u^{*}_{i-\\frac{1}{2},j}}{h} + \\frac{v^{*}_{i,j+\\frac{1}{2}} - v^{*}_{i,j-\\frac{1}{2}}}{h}\n$$\n代入推导出的面速度表达式：\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{1}{h} \\left( \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} - \\left(-\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\\right) \\right) + \\frac{1}{h} \\left( \\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} - \\left(-\\frac{2 \\Delta t p_{0}}{\\rho h} (-1)^{i+j}\\right) \\right)\n$$\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{1}{h} \\left( \\frac{4 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} \\right) + \\frac{1}{h} \\left( \\frac{4 \\Delta t p_{0}}{\\rho h} (-1)^{i+j} \\right)\n$$\n$$\n(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}} = \\frac{8 \\Delta t p_{0}}{\\rho h^2} (-1)^{i+j}\n$$\n这个结果非零，表明单元中心（交错）排列能正确地耦合棋盘格模态下的压力和速度。\n\n最后，我们计算比率 $\\mathcal{R}$。\n$$\n\\mathcal{R} = \\frac{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{collocated}}\\right|}{\\left|(\\nabla \\cdot \\boldsymbol{u}^{*})_{\\text{cell-centered}}\\right|} = \\frac{|0|}{\\left|\\frac{8 \\Delta t p_{0}}{\\rho h^2} (-1)^{i+j}\\right|}\n$$\n假设物理和数值常数 $p_{0}, \\Delta t, \\rho,$ 和 $h$ 均不为零，则分母不为零。分母的绝对值为 $\\frac{8 |\\Delta t p_{0}|}{\\rho h^2}$，因为 $\\rho > 0$ 且 $h > 0$。\n$$\n\\mathcal{R} = \\frac{0}{\\frac{8 |\\Delta t p_{0}|}{\\rho h^2}} = 0\n$$\n最终的比率恰好为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3368859"}]}