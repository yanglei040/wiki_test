## 引言
[变分原理](@entry_id:198028)是理论物理学中最深刻、最优美的思想之一，它断言物理系统的行为遵循使某个全局量（如作用量或能量）取平稳值的路径。在电磁学领域，这一原理不仅为[麦克斯韦方程组](@entry_id:150940)提供了更高层次的视角，更构成了现代计算电磁学不可或缺的理论基石。然而，许多工程师和研究人员虽然熟练使用基于有限元法等方法的仿真软件，却可能对其背后的变分思想缺乏系统性的理解，难以充分利用其威力解决更深层次的理论和设计挑战。本文旨在填补这一知识鸿沟，系统性地揭示[变分原理](@entry_id:198028)的精髓及其在电磁学中的广泛应用。

本文将引导读者踏上一段从抽象理论到具体应用的探索之旅。在“原理与机制”一章中，我们将从[最小作用量原理](@entry_id:138921)和能量泛函出发，阐明[变分法](@entry_id:163656)如何导出场方程，并介绍作为数值方法基础的弱形式与[伽辽金法](@entry_id:749698)。我们还将探索[诺特定理](@entry_id:145690)所揭示的[对称性与守恒律](@entry_id:160300)的深刻联系，以及[保结构算法](@entry_id:755563)如何在离散世界中继承连续物理的内在几何结构。随后，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示这些原理如何化身为强大的工具，应用于[谐振腔](@entry_id:274488)分析、波导计算、器件优化（伴随方法）、[逆问题](@entry_id:143129)成像和误差估计等实际工程和科学问题中，并揭示其与等离子体物理、计算科学等领域的交叉融合。最后，“动手实践”部分将提供一系列精心设计的问题，帮助读者亲手运用变分思想解决具体的电磁学难题。通过这三个章节的学习，读者将对[电磁学中的变分原理](@entry_id:756444)建立起一个全面而深入的认识。

## 原理与机制

### [最小作用量原理](@entry_id:138921)与泛函的平稳性

物理学的许多基本定律，包括经典力学、电磁学和量子力学，都可以通过一个优美而深刻的统一框架来表述：**[变分原理](@entry_id:198028)**。其核心思想是，一个物理系统所遵循的演化路径或所处的平衡状态，是某个称作**作用量**或能量的标量**泛函** (functional) 取**平稳值**（通常是最小值或最大值）的路径或状态。泛函是“函数的函数”，它以一个或多个函数为输入，输出一个标量值。分析泛函如何随其输入函数的微小变化而变化的过程，称为**[变分法](@entry_id:163656)** (calculus of variations)。

在电磁学中，这一原理为我们提供了一个从更高层次推导和理解场方程的强大工具。让我们从最简单的情形——静电学——开始。在由[介电常数](@entry_id:146714)为 $\varepsilon(\mathbf{x})$ 的[电介质](@entry_id:147163)填充的无源区域 $\mathcal{V}$ 中，总的[静电能](@entry_id:267406)量是一个依赖于[电势](@entry_id:267554)[分布](@entry_id:182848) $V(\mathbf{x})$ 的泛函：

$W_e[V] = \frac{1}{2} \int_{\mathcal{V}} \mathbf{E} \cdot \mathbf{D} \, d\mathcal{V} = \frac{1}{2} \int_{\mathcal{V}} \varepsilon(\mathbf{x}) |\mathbf{E}|^2 \, d\mathcal{V} = \frac{1}{2} \int_{\mathcal{V}} \varepsilon(\mathbf{x}) |\nabla V|^2 \, d\mathcal{V}$

这里我们使用了关系式 $\mathbf{E} = -\nabla V$。

一个基本的物理原理，即**汤姆孙定理** (Thomson's theorem)，指出：在一个由若干个处于固定[电势](@entry_id:267554)（即**狄利克雷边界条件**）的导体所界定的区域内，真实的静电势[分布](@entry_id:182848) $V(\mathbf{x})$ 是所有满足相同边界条件的光滑函数中，使总静电[能量泛函](@entry_id:170311) $W_e$ 达到最小值的那个函数。换言之，大自然选择了一种能够以最低能量存储方式来建立[电场](@entry_id:194326)的[电势](@entry_id:267554)[分布](@entry_id:182848)。这个[能量最小化](@entry_id:147698)原理的数学表达，正是求解该泛函的[欧拉-拉格朗日方程](@entry_id:137827)，其结果等价于我们熟知的[静电学](@entry_id:140489)基本方程——无源区域中的[高斯定律](@entry_id:141493)：$\nabla \cdot (\varepsilon \nabla V) = 0$。

我们可以通过一个具体的例子来深入理解这一原理的应用 [@problem_id:3359373]。考虑一个长直同轴电缆，内外导体半径分别为 $a$ 和 $b$，其间填充着径向非均匀的[电介质](@entry_id:147163)，[介电常数](@entry_id:146714)为 $\varepsilon(r) = \varepsilon_0 [1 + \kappa(r/a)^2]$。内外导体分别接地 ($V(a)=0$) 和施加电压 $V_0$ ($V(b)=V_0$)。根据汤姆孙定理，真实的[电势](@entry_id:267554)[分布](@entry_id:182848) $V(r)$ 使得单位长度的静电[能量泛函](@entry_id:170311)

$W'_e[\tilde{V}] = \pi \int_a^b \varepsilon(r) r \left(\frac{d\tilde{V}}{dr}\right)^2 dr$

在所有满足 $\tilde{V}(a)=0$ 和 $\tilde{V}(b)=V_0$ 的可容许试探[电势](@entry_id:267554) $\tilde{V}(r)$ 中取最小值。

这个[最小化原理](@entry_id:169952)不仅具有深刻的理论意义，还为近似计算提供了强大的**[里兹法](@entry_id:168680)** (Ritz method)。即使我们无法求得精确解，也可以构造一个包含可调参数的**[试探函数](@entry_id:756165)族** (family of trial functions)，然后通过最小化能量来确定这些参数的最优值，从而得到一个近似解。例如，对于上述同轴电缆问题，我们可以构造一个单参数的试探[电势](@entry_id:267554)族 $\tilde{V}_t(r)$。通过计算该试探[电势](@entry_id:267554)对应的能量 $W'_e(t)$，并根据 $W'_e = \frac{1}{2}C'V_0^2$ 得到一个依赖于参数 $t$ 的电容泛函 $C'(t)$。根据[变分原理](@entry_id:198028)，我们知道 $C'(t)$ 的最小值将是对真实电容的一个上界估计。通过对 $C'(t)$ 求导并令其为零，我们可以找到最优参数 $t_{opt}$，从而得到电容的近似值 $C'_{approx} = C'(t_{opt})$。在介质非均匀性参数 $\kappa$ 很小的情况下，我们可以运用微扰思想，在未扰动问题（$\kappa=0$，此时最优参数为 $t=0$）的最优解附近进行计算，从而高效地获得电容的一阶精确近似解 [@problem_id:3359373]。

与静电[能量泛函](@entry_id:170311)相对应，在[静磁学](@entry_id:140120)中也存在一个对偶的**余能泛函** (complementary energy functional)。对于给定边界上的切向[磁场](@entry_id:153296)（**[诺伊曼边界条件](@entry_id:142124)**），真实的[磁场](@entry_id:153296)[分布](@entry_id:182848)将最小化磁场强度 $\mathbf{H}$ 的余能泛函 $W_{mc}[\tilde{\mathbf{H}}] = \frac{1}{2} \int \mu |\tilde{\mathbf{H}}|^2 d\mathcal{V}$ [@problem_id:3359373]。这些对偶的能量原理构成了[变分方法](@entry_id:163656)在静场问题中应用的基础。

### 从连续到离散：[弱形式](@entry_id:142897)与[伽辽金法](@entry_id:749698)

[变分原理](@entry_id:198028)不仅为[场论](@entry_id:155241)提供了优雅的数学表述，更是现代[计算电磁学](@entry_id:265339)中**有限元法** (Finite Element Method, FEM) 等数值方法的理论基石。将一个[微分方程](@entry_id:264184)问题转化为等价的积分形式，即**[弱形式](@entry_id:142897)** (weak formulation)，是连接连续物理定律与离散[代数方程](@entry_id:272665)组的桥梁。

推导[弱形式](@entry_id:142897)的标准流程是：将原始[微分方程](@entry_id:264184)（称为**强形式**）两边同乘一个任意的**[检验函数](@entry_id:166589)** (test function) $v$，然后在整个求解域上积分。接着，通过**分部积分** (integration by parts)，将[高阶导数](@entry_id:140882)的作用“转移”一部分到[检验函数](@entry_id:166589)上。这样做有两个主要好处：一是降低了对解[函数光滑性](@entry_id:161935)的要求（例如，[二阶微分方程](@entry_id:269365)只需解一阶可导），二是边界条件可以自然地被并入积分项中。

以一个一维[谐振腔](@entry_id:274488)的[本征模](@entry_id:174677)问题为例 [@problem_id:3359405]，其[电场](@entry_id:194326)分量 $E(x)$ 满足标量[亥姆霍兹方程](@entry_id:149977)：

$-\frac{d^2 E}{dx^2} = \lambda \epsilon(x) E(x), \quad x \in (0,1)$

边界为[理想电导体](@entry_id:753331)（PEC），要求 $E(0)=0, E(1)=0$。我们选择一个满足相同[齐次边界条件](@entry_id:750371) ($v(0)=v(1)=0$) 的检验函数 $v(x)$，将方程两边同乘 $v(x)$ 并积分：

$\int_0^1 \frac{dE}{dx}\frac{dv}{dx} dx = \lambda \int_0^1 \epsilon(x) E(x) v(x) dx$

这就是该问题的弱形式。它要求我们寻找一个**[试探函数](@entry_id:756165)** (trial function) $E(x)$（来自某个合适的函数空间），使得对于该空间中所有的[检验函数](@entry_id:166589) $v(x)$，上述积分等式都成立。

**[伽辽金法](@entry_id:749698)** (Galerkin method) 是将此连续的[弱形式](@entry_id:142897)问题转化为离散的代数问题的核心思想。其步骤如下：
1.  将求解域离散化为若干个小的单元（例如，一维[区间划分](@entry_id:264619)为小段）。
2.  在一个由有限个**[基函数](@entry_id:170178)** (basis functions) $\phi_j(x)$ 张成的有限维函数[子空间](@entry_id:150286)中寻找近似解。近似解 $E_h(x)$ 表示为这些[基函数](@entry_id:170178)的[线性组合](@entry_id:154743)：$E_h(x) = \sum_{j} u_j \phi_j(x)$，其中 $u_j$ 是待求的未知系数。
3.  [伽辽金法](@entry_id:749698)的精髓在于，选择与[基函数](@entry_id:170178)相同的函数集作为[检验函数](@entry_id:166589)，即 $v(x) = \phi_i(x)$。
4.  将近似解的表达式代入[弱形式](@entry_id:142897)，并依次令检验函数为每一个[基函数](@entry_id:170178) $\phi_i(x)$，即可得到一个关于未知系数 $u_j$ 的线性代数方程组。

对于上述亥姆霍兹本征值问题 [@problem_id:3359405]，这个过程最终会导出一个广义矩阵本征值问题：

$K \mathbf{u} = \lambda M \mathbf{u}$

其中，向量 $\mathbf{u}$ 包含了未知的节点场值。**刚度矩阵** (stiffness matrix) $K$ 和**[质量矩阵](@entry_id:177093)** (mass matrix) $M$ 的元素分别由[基函数](@entry_id:170178)的导数乘积积分和[基函数](@entry_id:170178)本身与介质参数的乘积积分得到：

$K_{ij} = \int_0^1 \frac{d\phi_i}{dx}\frac{d\phi_j}{dx} dx$
$M_{ij} = \int_0^1 \epsilon(x) \phi_i(x) \phi_j(x) dx$

通过求解这个矩阵[本征值问题](@entry_id:142153)，我们就能得到[谐振腔](@entry_id:274488)的离散近似本征频率（由 $\lambda$ 决定）及其对应的[场模](@entry_id:189270)式（由[本征向量](@entry_id:151813) $\mathbf{u}$ 决定）。这一从变分原理出发，经由[弱形式](@entry_id:142897)，最终到达[伽辽金离散化](@entry_id:172164)的路径，是现代计算科学中求解偏微分方程的普适[范式](@entry_id:161181)。

### [对称性与守恒律](@entry_id:160300)：电磁学中的诺特定理

变分原理的威力远不止于此。德国数学家 [Emmy Noether](@entry_id:155198) 在 20 世纪初证明了一个物理学中最深刻的定理之一——**[诺特定理](@entry_id:145690)** (Noether's Theorem)。该定理指出，物理系统[作用量泛函](@entry_id:169216)的每一种连续**对称性** (symmetry)，都对应着一个**[守恒量](@entry_id:150267)** (conserved quantity)。这为我们理解物理守恒律的起源提供了根本性的视角。

我们可以将[诺特定理](@entry_id:145690)应用于[电磁场](@entry_id:265881)的**[作用量泛函](@entry_id:169216)** (action functional) [@problem_id:3359388]。在无[材料色散](@entry_id:199072)的区域中，[电磁场](@entry_id:265881)与[电流源](@entry_id:275668) $(\rho, \mathbf{J})$ 相互作用的作用量为：

$S[\mathbf{A}, \phi] = \int_{t_0}^{t_1} \int_{\mathcal{V}} \left( \frac{\varepsilon}{2} |\mathbf{E}|^2 - \frac{1}{2\mu} |\mathbf{B}|^2 + \mathbf{J} \cdot \mathbf{A} - \rho \phi \right) d\mathbf{x} dt$

其中拉格朗日密度 $\mathcal{L} = \frac{\varepsilon}{2} |\mathbf{E}|^2 - \frac{1}{2\mu} |\mathbf{B}|^2 + \mathbf{J} \cdot \mathbf{A} - \rho \phi$ 是通过[四维势](@entry_id:188407) $(\mathbf{A}, \phi)$ 及其导数定义的。

通过考察这个作用量的对称性，我们可以推导出电磁学的基本守恒律：

1.  **[时间平移对称性](@entry_id:261093)**：如果[拉格朗日量](@entry_id:174593)不显含时间 $t$（例如，在无源情况下），则作用量在[时间平移](@entry_id:261541) $t \mapsto t + \delta t$ 下保持不变。根据[诺特定理](@entry_id:145690)，这对应着**总[电磁能](@entry_id:264720)量的守恒**。其守恒量正是系统的[哈密顿量](@entry_id:172864)，即总能量 $U = \int_{\mathcal{V}} (\frac{\varepsilon}{2}|\mathbf{E}|^2 + \frac{1}{2\mu}|\mathbf{B}|^2) d\mathbf{x}$。

2.  **空间[平移对称性](@entry_id:171614)**：如果系统在空间上是均匀的（例如，在自由空间或[周期性边界条件](@entry_id:147809)下），作用量在空间平移 $\mathbf{x} \mapsto \mathbf{x} + \delta\mathbf{x}$ 下不变。对应的[守恒量](@entry_id:150267)是**总[电磁动量](@entry_id:268129)** $\mathbf{P} = \int_{\mathcal{V}} \varepsilon\mu (\mathbf{E} \times \mathbf{H}) d\mathbf{x}$，其中[动量密度](@entry_id:271360)正比于坡印亭矢量。

3.  **[规范对称性](@entry_id:136438)**：[电磁场](@entry_id:265881)的势 $(\mathbf{A}, \phi)$ 存在**[规范自由度](@entry_id:160491)** (gauge freedom)。在规范变换 $(\mathbf{A}, \phi) \mapsto (\mathbf{A} + \nabla\chi, \phi - \partial\chi/\partial t)$ 下，物理场 $\mathbf{E}$ 和 $\mathbf{B}$ 保持不变。为了使包含源项的作用量也在此变换下保持不变，源 $(\rho, \mathbf{J})$ 必须满足[电荷守恒](@entry_id:264158)的连续性方程 $\partial\rho/\partial t + \nabla \cdot \mathbf{J} = 0$。因此，规范对称性深刻地蕴含了**[电荷守恒](@entry_id:264158)定律**。同时，它也保证了高斯定律 $\nabla \cdot \mathbf{D} = \rho$ 在时间演化中的[自洽性](@entry_id:160889)。

[诺特定理](@entry_id:145690)揭示了守恒律并非孤立的经验法则，而是时空与[内禀对称性](@entry_id:168727)的直接数学推论，是物理定律底层结构美的体现。

### 离散化中的结构保持：几何与辛方法

既然连续系统中的守恒律源于对称性，一个自然而关键的问题是：当我们将连续的场方程离散化为数值模型时，这些守恒律还能被保持吗？答案是：不一定。常规的数值方法（如标准[有限差分](@entry_id:167874)或有限元法）往往会破坏原始物理系统的内在几何或[代数结构](@entry_id:137052)，导致[能量漂移](@entry_id:748982)、[电荷](@entry_id:275494)不守恒等非物理现象，从而降低了长期仿真的可信度。

**[保结构算法](@entry_id:755563)** (Structure-preserving algorithms) 的目标正是克服这一缺陷。其核心思想是，在离散层面模仿连续系统的基本结构。**[有限元外微分](@entry_id:174585)** (Finite Element Exterior Calculus, FEEC) 是一种强大的现代框架，它为[电磁场](@entry_id:265881)的离散化提供了系统性的几何观点 [@problem_id:3359388]。在 FEEC 中：

-   标量场（如[电荷密度](@entry_id:144672) $\rho$）被看作离散在网格**节点**上的 **0-链**。
-   矢量场（如[电场](@entry_id:194326) $\mathbf{E}$）被看作离散在网格**边**上的 **1-链**。
-   面通量场（如[磁场](@entry_id:153296) $H$ 的面分量）被看作离散在网格**面**上的 **2-链**。
-   微分算子（梯度、[旋度和散度](@entry_id:269913)）被代数化的**[关联矩阵](@entry_id:263683)**（如节点-边矩阵 $B_1$ 和 边-面矩阵 $B_2$）所取代。

这种方法的精妙之处在于，它能精确地保持[微分几何](@entry_id:145818)中的核心恒等式。例如，连续情形下的恒等式 $\nabla \times (\nabla \phi) = \mathbf{0}$ ([梯度的旋度](@entry_id:274168)为零)在离散层面被精确地体现为矩阵关系 $B_2 B_1 = \mathbf{0}$。这保证了[离散梯度](@entry_id:171970)和[旋度算子](@entry_id:184984)之间的拓扑关系是正确的。

在[时间离散化](@entry_id:169380)方面，源于离散[变分原理](@entry_id:198028)的**辛积分器** (symplectic integrators)，如**隐式[中点规则](@entry_id:177487)** (implicit midpoint rule)，能够精确地保持线性哈密顿系统的二次[不变量](@entry_id:148850)。对于无源的麦克斯韦方程，其[半离散系统](@entry_id:754680)（空间离散，时间连续）可以写成 $\partial_t \mathbf{u} = A \mathbf{u}$ 的形式，其中状态向量 $\mathbf{u}$ 包含所有电场和磁场自由度，而矩阵 $A$ 是一个**斜对称矩阵** ($A^T = -A$)。使用隐式[中点规则](@entry_id:177487)对这样的系统进行时间步进，可以证明离散能量 $\mathcal{H}_d = \frac{1}{2} \mathbf{u}^T \mathbf{u}$ 在每一步都是**精确守恒**的 [@problem_id:3359388]。

结合 FEEC 空间离散和辛时间积分，我们可以构造出能够精确保持某些守恒律的数值格式。例如，对于满足连续性方程的源，离散的高斯定律残差 $\mathbf{g} = B_1 \mathbf{E} - \rho$ 可以在整个仿真过程中保持恒定（如果初始为零，则永远为零）。然而，并非所有守恒律都能被完美保持。动量守恒源于连续的空间[平移对称性](@entry_id:171614)，而任何网格都破坏了这种连续对称性，只剩下离散的平移对称性。因此，即使采用[保结构算法](@entry_id:755563)，离散动量通常也无法精确守恒 [@problem_id:3359388]。这揭示了一个深刻的道理：数值方法的保结构特性是选择性的，理解哪些结构被保持、哪些被破坏，对于设计高保真度的计算模型至关重要。

### 先进[变分方法](@entry_id:163656)：稳定性与[混合方法](@entry_id:163463)

一个成功的变分数值方法不仅需要能收敛到正确解，还必须保证其数值**稳定性** (stability)。在求解矢量场问题（如麦克斯韦方程）时，一个特别棘手的问题是**伪模** (spurious modes) 的出现。直接对矢量亥姆霍兹方程 $\nabla \times (\nabla \times \mathbf{E}) - k^2 \mathbf{E} = \mathbf{0}$ 进行朴素的[有限元离散化](@entry_id:193156)，常常会产生大量无物理意义的、数值噪声驱动的解。

这个问题的根源在于，连续的旋度-[旋度算子](@entry_id:184984) $(\nabla \times \nabla \times)$ 有一个巨大的零空间（核），它包含了所有[梯度场](@entry_id:264143)（形如 $\nabla\phi$ 的场）。在连续的[弱形式](@entry_id:142897)中，通过与[亥姆霍兹分解](@entry_id:181767)和[高斯定律](@entry_id:141493) $\nabla \cdot (\epsilon \mathbf{E}) = 0$ 结合，这个零空间被正确地处理了。但在离散层面，如果有限元空间选择不当，离散[算子的核](@entry_id:272757)可能比物理上应有的更大，从而污染了数值解。

为了根除伪模，现代[计算电磁学](@entry_id:265339)采用了**混合变分方法** (mixed variational formulations) [@problem_id:3359370]。其核心思想不是只求解一个主变量（如 $\mathbf{E}$），而是同时求解多个场变量，并通过引入**[拉格朗日乘子](@entry_id:142696)** (Lagrange multiplier) 来显式地强制执行物理约束。例如，我们可以引入一个乘子 $p$ 来弱形式地强制执行无散度条件 $\nabla \cdot \mathbf{D} = 0$。这会将原问题转化为一个**[鞍点问题](@entry_id:174221)** (saddle-point problem)。

[鞍点问题](@entry_id:174221)的稳定性由一个关键的数学条件——**Babuška-Brezzi (LBB) 条件**（或称 **[inf-sup 条件](@entry_id:174538)**）——来保证。这个条件要求为约束算子（此处为[散度算子](@entry_id:265975)）选择的[试探函数](@entry_id:756165)空间和[拉格朗日乘子](@entry_id:142696)空间必须是“相容的”，以确保离散系统的[适定性](@entry_id:148590)，且其稳定性不随[网格加密](@entry_id:168565)而退化。我们可以借鉴[不可压缩流体](@entry_id:181066)力学中的速度-压力混合单元设计来获得启发，那里同样需要满足 LBB 条件来避免压力伪模 [@problem_id:3359370]。

[有限元外微分](@entry_id:174585) (FEEC) 框架再次为我们提供了系统性的指导。它揭示了 de Rham 希尔伯特复形中各个[函数空间](@entry_id:143478)之间的深刻联系。为了构造一个稳定的[混合格式](@entry_id:167436)来求解麦克斯韦方程，我们需要为不同的物理量选择合适的有限元空间，以精确地模拟这个连续的复形结构。对于一个 $(\mathbf{E}, \mathbf{D}, p)$ 三场[混合格式](@entry_id:167436)，一个被证明是 LBB 稳定的选择是 [@problem_id:3359370]：
-   [电场](@entry_id:194326) $\mathbf{E}$ 属于 $H(\mathrm{curl})$ 空间，应采用**Nédélec 边元** (edge elements) 离散。
-   [电位移场](@entry_id:273493) $\mathbf{D}$ 属于 $H(\mathrm{div})$ 空间，应采用**Raviart-Thomas 面元** (face elements) 离散。
-   [拉格朗日乘子](@entry_id:142696) $p$ 属于 $L^2$ 空间，应采用**不连续的分片多项式**离散。

这种基于 de Rham 复形构造的稳定单元族，保证了 LBB 条件对网格尺寸 $h$ 一致成立，从而彻底消除了伪模问题，是现代高性能[电磁仿真](@entry_id:748890)的基石。

### 应用与拓展

变分原理的思想和方法贯穿于计算电磁学的各个分支。以下是两个典型的应用领域。

#### 涡流问题（[磁准静态近似](@entry_id:267739)）

在**磁准静态** (Magnetoquasistatic, MQS) 近似下，我们处理的是变化较慢的[磁场](@entry_id:153296)问题，此时[位移电流](@entry_id:190231) $\partial\mathbf{D}/\partial t$ 可以忽略不计。这主要适用于涡流、[感应加热](@entry_id:192046)和电机等领域。一个典型的涡流问题可以被表述为一个在每个时刻最小化导体中总[焦耳热](@entry_id:150496)功率的[变分问题](@entry_id:756445) [@problem_id:3359381]：

最小化 $\mathcal{J} = \int_{\Omega} \sigma |\mathbf{E}|^2 dV$

这个最小化过程必须受到 MQS 物理定律的约束。使用磁矢量位 $\mathbf{A}$ 和电标量位 $\phi$，这些定律可以写成关于势的方程。特别地，[安培定律](@entry_id:140092)变为 $\nabla \times (\mu^{-1} \nabla \times \mathbf{A}) = \mathbf{J}_s + \sigma \mathbf{E}$，[电场](@entry_id:194326)为 $\mathbf{E} = -\partial\mathbf{A}/\partial t - \nabla\phi$。由于势的不唯一性，必须施加一个**[规范条件](@entry_id:749730)**来固定解。在 MQS 问题中，**[库仑规范](@entry_id:273044)** ($\nabla \cdot \mathbf{A} = 0$) 是一个常用且有效的选择。需要注意的是，尽管在某些特殊情况下可以选择更简单的**时间规范** ($\phi=0$)，但这通常会错误地忽略由[电荷](@entry_id:275494)在[材料界面](@entry_id:751731)积累产生的保守[电场](@entry_id:194326)分量，因此在一般情况下是不正确的 [@problem_id:3359381]。

#### 散射问题：[有限元法](@entry_id:749389) vs. [边界元法](@entry_id:141290)

对于开放区域的[电磁散射](@entry_id:182193)问题，[变分原理](@entry_id:198028)催生了两种主流的数值方法：基于区域离散的有限元法 (FEM) 和基于边界离散的**[边界元法](@entry_id:141290)** (Boundary Element Method, BEM) [@problem_id:3359402]。

-   **FEM** 通常在包围散射体的一个有限计算域上求解，并在人工截断边界上施加**[吸收边界条件](@entry_id:164672)**（如 Silver-Müller 条件）来模拟波向无穷远的辐射。其优点是通用性强，可以处理任意复杂的非均匀材料。但其离散化的是一个二阶偏微分算子，导致最终的系统[矩阵[条件](@entry_id:142689)数](@entry_id:145150)随网格尺寸 $h$ 的减小而迅速恶化，通常为 $\mathcal{O}(h^{-2})$。

-   **BEM** 利用[格林函数](@entry_id:147802)将问题转化为只在散射体表面上的积分方程。格林函数本身就满足了无穷远处的辐射条件，因此 BEM 天然地解决了开放区域问题。通过构造**[组合场积分方程](@entry_id:747497)** (Combined-Field Integral Equation, CFIE)，可以得到**第二类 Fredholm 积分方程**。这类方程具有极好的数学性质，其[伽辽金离散化](@entry_id:172164)得到的矩阵系统，其条件数在网格加密时保持有界，即 $\mathcal{O}(1)$ [@problem_id:3359402]。这是 BEM 相比于 FEM 的一个巨大优势。然而，BEM 产生的矩阵是稠密的，并且其[条件数](@entry_id:145150)对频率（[波数](@entry_id:172452) $k$）的依赖性是一个具有挑战性的研究课题。

综上所述，[变分原理](@entry_id:198028)不仅为电磁理论提供了深刻的统一视角，更通过弱形式、[伽辽金法](@entry_id:749698)、[保结构离散化](@entry_id:755564)和先进的混合公式等概念，为整个[计算电磁学](@entry_id:265339)领域奠定了坚实的理论基础和强大的方法论。