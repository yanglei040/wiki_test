{"hands_on_practices": [{"introduction": "我们从一个静电学中的经典问题开始：点电荷与接地导体球的相互作用。该练习旨在通过镜像法将复杂的边界值问题转化为一个等效但更简单的点电荷系统问题。通过首先验证镜像电荷配置确实满足了导体表面的零电势边界条件，然后利用相互作用能计算电荷所受的力，您将加深对镜像法有效性及其物理应用的理解 [@problem_id:3316502]。", "problem": "在介电常数为 $\\varepsilon_{0}$ 的自由空间中，一个大小为 $q$ 的点电荷位于 $z$ 轴上的位置 $\\mathbf{r}_{0} = (0,0,r_{0})$ 处，其中 $r_{0} > a$。该点电荷位于一个以原点为中心、半径为 $a$ 的接地的理想导电球体之外。开尔文镜像法解通过在 $z$ 轴上的位置 $\\mathbf{r}' = (0,0,r')$ 放置一个镜像电荷 $q'$ 来替代该接地导体球，其中 $r' = a^{2}/r_{0}$ 且 $q' = - q a / r_{0}$，使得球外的总电势是 $q$ 和 $q'$ 的库仑电势的叠加。\n\n仅使用接地导体的定义边界条件和点电荷的库仑电势，完成以下任务：\n\n1) 从点电荷产生静电势的基本表达式和接地导体表面电势必须为零的边界条件出发，验证在球面 $r = a$ 上，对于所有极角 $\\theta$，总电势恒为零。\n\n2) 从静电能泛函 $U = \\tfrac{1}{2} \\int \\rho(\\mathbf{r}) V(\\mathbf{r}) \\,\\mathrm{d}^{3}\\mathbf{r}$ 和导体电势保持为零的事实出发，将真实电荷与感应电荷之间的相互作用能简化为一种仅涉及由镜像电荷在真实电荷位置处产生的电势的形式。然后，将此相互作用能对 $r_{0}$ 求导（保持 $q$ 和 $a$ 固定），以获得作用在真实电荷上的精确径向力 $F_{r}$。采用约定 $F_{r} > 0$ 对应于 $+\\hat{\\mathbf{r}}$ 方向（$r_{0}$ 增加的方向）的力。\n\n答案要求：\n- 将最终的力 $F_{r}$ 表示为关于 $q$、$a$、$r_{0}$ 和 $\\varepsilon_{0}$ 的单个闭合形式解析表达式。\n- 以牛顿为单位表示最终的力。\n- 最终的方框答案必须只包含解析表达式，不带单位。", "solution": "此问题包含两部分。第一部分是验证接地导电球体的镜像电荷法解。第二部分要求通过对静电相互作用能求导来计算作用在点电荷上的力。\n\n### 第一部分：验证边界条件\n\n问题假设，对于位于 $\\mathbf{r}_{0} = (0,0,r_{0})$ 的点电荷 $q$，在半径为 $a$ 的接地导电球体外的区域 $r \\ge a$ 中的静电势 $V$ 可以通过用位于 $\\mathbf{r}' = (0,0,r')$ 的镜像电荷 $q'$ 替换球体来求得。镜像电荷的大小和位置由 $q' = - q a / r_{0}$ 和 $r' = a^{2}/r_{0}$ 给出。\n\n球外任意点 $\\mathbf{r}$ 的总电势是真实电荷 $q$ 和镜像电荷 $q'$ 产生的电势的叠加。位于位置 $\\mathbf{r}_Q$ 的点电荷 $Q$ 的库仑电势由 $V_Q(\\mathbf{r}) = \\frac{Q}{4\\pi\\varepsilon_{0}|\\mathbf{r} - \\mathbf{r}_Q|}$ 给出。\n\n因此，总电势为：\n$$V(\\mathbf{r}) = \\frac{1}{4\\pi\\varepsilon_{0}} \\left( \\frac{q}{|\\mathbf{r} - \\mathbf{r}_{0}|} + \\frac{q'}{|\\mathbf{r} - \\mathbf{r}'|} \\right)$$\n我们需要验证在球体表面各处，即对于所有满足 $|\\mathbf{r}| = a$ 的点 $\\mathbf{r}$，该电势均为零。该球面上的一个点可以在球坐标中描述为 $(a, \\theta, \\phi)$。由于电荷分布的柱对称性（两个电荷都位于 $z$ 轴上），电势将不依赖于方位角 $\\phi$。\n\n设球面上的点为 $\\mathbf{r}$。从原点到该点的矢量大小为 $a$。真实电荷位于 $\\mathbf{r}_{0} = r_{0}\\hat{\\mathbf{z}}$，镜像电荷位于 $\\mathbf{r}' = r'\\hat{\\mathbf{z}}$。分母中的距离可以用余弦定理求出。设 $\\theta$ 为矢量 $\\mathbf{r}$ 与 $z$ 轴之间的夹角。\n\n从球面上的点 $\\mathbf{r}$到真实电荷 $q$ 的距离是：\n$$|\\mathbf{r} - \\mathbf{r}_{0}| = \\sqrt{|\\mathbf{r}|^2 + |\\mathbf{r}_{0}|^2 - 2\\mathbf{r}\\cdot\\mathbf{r}_{0}} = \\sqrt{a^2 + r_{0}^2 - 2ar_{0}\\cos\\theta}$$\n从球面上的点 $\\mathbf{r}$到镜像电荷 $q'$ 的距离是：\n$$|\\mathbf{r} - \\mathbf{r}'| = \\sqrt{|\\mathbf{r}|^2 + |\\mathbf{r}'|^2 - 2\\mathbf{r}\\cdot\\mathbf{r}'} = \\sqrt{a^2 + (r')^2 - 2ar'\\cos\\theta}$$\n现在，我们计算在球面 $r=a$ 上的电势 $V(\\mathbf{r})$：\n$$V(r=a, \\theta) = \\frac{1}{4\\pi\\varepsilon_{0}} \\left( \\frac{q}{\\sqrt{a^2 + r_{0}^2 - 2ar_{0}\\cos\\theta}} + \\frac{q'}{\\sqrt{a^2 + (r')^2 - 2ar'\\cos\\theta}} \\right)$$\n代入给定的 $q'$ 和 $r'$ 的表达式：$q' = -q a/r_{0}$ 和 $r' = a^2/r_{0}$。\n$$V(r=a, \\theta) = \\frac{q}{4\\pi\\varepsilon_{0}} \\left( \\frac{1}{\\sqrt{a^2 + r_{0}^2 - 2ar_{0}\\cos\\theta}} - \\frac{a/r_{0}}{\\sqrt{a^2 + (a^2/r_{0})^2 - 2a(a^2/r_{0})\\cos\\theta}} \\right)$$\n让我们简化第二项的分母：\n$$\\sqrt{a^2 + \\frac{a^4}{r_{0}^2} - \\frac{2a^3}{r_{0}}\\cos\\theta} = \\sqrt{\\frac{a^2}{r_{0}^2} (r_{0}^2 + a^2 - 2ar_{0}\\cos\\theta)} = \\frac{a}{r_{0}} \\sqrt{r_{0}^2 + a^2 - 2ar_{0}\\cos\\theta}$$\n将此结果代回电势的表达式中：\n$$V(r=a, \\theta) = \\frac{q}{4\\pi\\varepsilon_{0}} \\left( \\frac{1}{\\sqrt{a^2 + r_{0}^2 - 2ar_{0}\\cos\\theta}} - \\frac{a/r_{0}}{\\frac{a}{r_{0}} \\sqrt{a^2 + r_{0}^2 - 2ar_{0}\\cos\\theta}} \\right)$$\n$$V(r=a, \\theta) = \\frac{q}{4\\pi\\varepsilon_{0}} \\left( \\frac{1}{\\sqrt{a^2 + r_{0}^2 - 2ar_{0}\\cos\\theta}} - \\frac{1}{\\sqrt{a^2 + r_{0}^2 - 2ar_{0}\\cos\\theta}} \\right) = 0$$\n这个结果对所有极角 $\\theta$ 的值都有效。因此，球体表面的电势恒为零，满足了接地导体的边界条件。\n\n### 第二部分：从相互作用能计算力\n\n问题要求从系统的相互作用能推导出作用在电荷 $q$ 上的力。在电势 $V$ 中的电荷分布 $\\rho$ 的静电能是 $U = \\tfrac{1}{2} \\int \\rho(\\mathbf{r}) V(\\mathbf{r}) \\,\\mathrm{d}^{3}\\mathbf{r}$。对于一个由点电荷 $q$ 和一个接地导体组成的系统，储存在电场中的总能量（即相互作用能）由 $U_{\\text{int}} = \\tfrac{1}{2} q V_{\\text{ind}}(\\mathbf{r}_{0})$ 给出，其中 $V_{\\text{ind}}(\\mathbf{r}_{0})$ 是由导体上的感应电荷在电荷 $q$ 的位置产生的电势。\n\n静电学唯一性定理保证了在区域 $r>a$ 内的电势与真实电荷 $q$ 和镜像电荷 $q'$ 产生的电势完全相同。因此，对于所有满足 $|\\mathbf{r}| \\ge a$ 的 $\\mathbf{r}$，由感应表面电荷产生的电势 $V_{\\text{ind}}(\\mathbf{r})$ 与由镜像电荷产生的电势 $V_{q'}(\\mathbf{r})$ 完全相同。\n$$V_{\\text{ind}}(\\mathbf{r}_{0}) = V_{q'}(\\mathbf{r}_{0}) = \\frac{1}{4\\pi\\varepsilon_{0}} \\frac{q'}{|\\mathbf{r}_{0} - \\mathbf{r}'|}$$\n真实电荷位于 $\\mathbf{r}_{0} = (0,0,r_{0})$，镜像电荷位于 $\\mathbf{r}' = (0,0,r')$。它们之间的距离是 $|\\mathbf{r}_{0} - \\mathbf{r}'| = r_{0} - r'$。注意，由于 $r_{0} > a$，我们有 $r' = a^2/r_{0}  a$，因此 $r_{0} - r'  0$。\n现在可以将相互作用能表示为 $r_{0}$ 的函数：\n$$U_{\\text{int}}(r_{0}) = \\frac{1}{2} q V_{q'}(\\mathbf{r}_{0}) = \\frac{1}{2} q \\left( \\frac{1}{4\\pi\\varepsilon_{0}} \\frac{q'}{r_{0} - r'} \\right)$$\n代入 $q' = -q a / r_{0}$ 和 $r' = a^2/r_{0}$：\n$$U_{\\text{int}}(r_{0}) = \\frac{1}{2} q \\left( \\frac{1}{4\\pi\\varepsilon_{0}} \\frac{-q a/r_{0}}{r_{0} - a^2/r_{0}} \\right) = \\frac{-q^2 a}{8\\pi\\varepsilon_{0}} \\frac{1/r_{0}}{(r_{0}^2 - a^2)/r_{0}}$$\n$$U_{\\text{int}}(r_{0}) = -\\frac{q^2 a}{8\\pi\\varepsilon_{0}(r_{0}^2 - a^2)}$$\n作用在电荷 $q$ 上的力与势能的关系为 $\\mathbf{F} = -\\nabla U$。由于能量仅依赖于径向坐标 $r_{0}$，因此力是纯径向的，$\\mathbf{F} = F_{r}\\hat{\\mathbf{r}}$，其中 $F_{r} = - \\frac{\\mathrm{d}U_{\\text{int}}}{\\mathrm{d}r_{0}}$。给定的约定是 $F_{r}0$ 对应于排斥力（在 $+\\hat{\\mathbf{r}}$ 方向）。\n对相互作用能关于 $r_{0}$ 求导（保持 $q$ 和 $a$ 不变）：\n$$F_{r} = -\\frac{\\mathrm{d}}{\\mathrm{d}r_{0}} \\left( -\\frac{q^2 a}{8\\pi\\varepsilon_{0}(r_{0}^2 - a^2)} \\right)$$\n$$F_{r} = \\frac{q^2 a}{8\\pi\\varepsilon_{0}} \\frac{\\mathrm{d}}{\\mathrm{d}r_{0}} \\left( (r_{0}^2 - a^2)^{-1} \\right)$$\n使用链式法则：\n$$F_{r} = \\frac{q^2 a}{8\\pi\\varepsilon_{0}} \\left[ -1 \\cdot (r_{0}^2 - a^2)^{-2} \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}r_{0}}(r_{0}^2 - a^2) \\right]$$\n$$F_{r} = \\frac{q^2 a}{8\\pi\\varepsilon_{0}} \\left[ -(r_{0}^2 - a^2)^{-2} \\cdot (2r_{0}) \\right]$$\n$$F_{r} = -\\frac{2q^2 a r_{0}}{8\\pi\\varepsilon_{0}(r_{0}^2 - a^2)^2} = -\\frac{q^2 a r_{0}}{4\\pi\\varepsilon_{0}(r_{0}^2 - a^2)^2}$$\n负号表示力是吸引力，指向球心（在 $-\\hat{\\mathbf{r}}$ 方向），这与靠近接地导体的电荷所受的力相符。", "answer": "$$\n\\boxed{-\\frac{q^2 a r_{0}}{4\\pi\\varepsilon_{0}(r_{0}^2 - a^2)^2}}\n$$", "id": "3316502"}, {"introduction": "在掌握了导体边界的镜像法之后，我们将这一概念推广到更一般的情况：两种不同介电材料形成的平直界面。此练习要求您应用电场和电位移场的连续性边界条件，来确定界面两侧的等效镜像电荷。通过这个过程，您不仅能解决介质界面问题，还能通过分析介电常数 $\\varepsilon$ 趋于极端时的极限情况，重新推导出理想导体的镜像结果，从而深刻理解这些看似不同的边界条件内在的统一性 [@problem_id:3316430]。", "problem": "考虑一个位于 $z=0$ 的平面界面，该界面分隔了两种均匀、各向同性、非磁性介质，其介电常数分别为 $\\epsilon_{1}$（对于 $z0$）和 $\\epsilon_{2}$（对于 $z0$）。一个点电荷 $q$ 位于上方介质 $z0$ 中的 $(0,0,d)$ 处，其中 $d0$。在上方区域，寻求一个静电势表示，该表示由位于 $(0,0,d)$ 的真实电荷的电势与位于 $(0,0,-d)$ 的单个未知镜像电荷 $q'$ 的电势叠加而成。在下方区域，假设一个静电势表示，该表示仅由位于 $(0,0,d)$ 的未知强度的等效源产生，并且在 $z0$ 内没有奇点。\n\n使用专用于静电学的麦克斯韦方程组、本构关系 $\\mathbf{D}=\\epsilon \\mathbf{E}$ 以及无电荷平面界面上的电磁边界条件，确定镜像电荷比 $q'/q$（用 $\\epsilon_{1}$ 和 $\\epsilon_{2}$ 表示），而无需援引任何已知的镜像理论公式。然后，分析 $\\epsilon_{2}\\to\\infty$ 和 $\\epsilon_{2}\\to 0$ 的极限情况，以分别推导出理想电导体 (PEC) 和理想磁导体 (PMC) 的镜像极限。\n\n将你的最终答案表示为一个行矩阵，其中包含 $q'/q$ 的两个极限值，顺序为 $\\left(\\lim_{\\epsilon_{2}\\to\\infty} q'/q,\\ \\lim_{\\epsilon_{2}\\to 0} q'/q\\right)$。无需四舍五入。最终答案是无量纲的。", "solution": "我们首先按照问题的规定，建立两个区域中的静电势。设位置矢量为 $\\mathbf{r}$。由于问题具有方位对称性，我们将使用柱坐标 $(\\rho, \\phi, z)$，其中 $\\rho = \\sqrt{x^2 + y^2}$。\n\n点电荷 $q$ 位于区域 1（$z0$）的 $(0,0,d)$ 处，该区域的介电常数为 $\\epsilon_1$。两种介质之间的界面是平面 $z=0$。区域 2（$z0$）的介电常数为 $\\epsilon_2$。\n\n区域 1（$z0$）中的电势 $V_1$ 由位于 $(0,0,d)$ 的原始电荷 $q$ 的电势和位于 $(0,0,-d)$ 的镜像电荷 $q'$ 的电势叠加而成。从观测点 $(\\rho, \\phi, z)$ 到电荷 $q$ 的距离为 $R_1 = \\sqrt{\\rho^2 + (z-d)^2}$。到镜像电荷 $q'$ 的距离为 $R_2 = \\sqrt{\\rho^2 + (z+d)^2}$。因此，在介电常数为 $\\epsilon_1$ 的区域 1 中，电势为：\n$$V_1(\\rho, z) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{R_1} + \\frac{q'}{R_2} \\right) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + (z-d)^2}} + \\frac{q'}{\\sqrt{\\rho^2 + (z+d)^2}} \\right)$$\n\n区域 2（$z0$）中的电势 $V_2$ 的构建方式，仿佛它源于位于原始电荷位置 $(0,0,d)$ 处的单个等效电荷 $q''$。问题表述要求此电势表示在满足 $z=0$ 处边界条件的同时，在 $z0$ 区域内非奇异。建立此电势的标准且最直接的方法是将其表示为一种便于匹配边界条件的形式。我们将 $V_2$ 写作与 $V_1$ 具有相同的归一化常数，以简化电势连续性条件：\n$$V_2(\\rho, z) = \\frac{1}{4\\pi\\epsilon_1} \\frac{q''}{R_1} = \\frac{1}{4\\pi\\epsilon_1} \\frac{q''}{\\sqrt{\\rho^2 + (z-d)^2}}$$\n这种形式正确地将从区域 2 看到的场源置于 $(0,0,d)$ 处，并确保由于 $d0$，在区域 2（$z0$）内没有源（奇点）。\n\n未知电荷 $q'$ 和 $q''$ 通过应用无电荷界面 $z=0$ 处的静电场边界条件来确定：\n1.  电场 $\\mathbf{E}$ 的切向分量连续，这意味着静电势 $V$ 连续：$V_1(\\rho, z=0) = V_2(\\rho, z=0)$。\n2.  电位移场 $\\mathbf{D}$ 的法向分量连续：$\\mathbf{\\hat{n}} \\cdot (\\mathbf{D}_1 - \\mathbf{D}_2) = 0$。在界面 $z=0$ 处，法向量 $\\mathbf{\\hat{n}}$ 为 $\\mathbf{\\hat{z}}$。使用本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 和 $\\mathbf{E} = -\\nabla V$，该条件变为在 $z=0$ 处 $\\epsilon_1 E_{1z} = \\epsilon_2 E_{2z}$，或者明确地写为：\n    $$\\epsilon_1 \\left(-\\frac{\\partial V_1}{\\partial z}\\right)\\bigg|_{z=0} = \\epsilon_2 \\left(-\\frac{\\partial V_2}{\\partial z}\\right)\\bigg|_{z=0}$$\n\n让我们应用第一个边界条件，$z=0$ 处 $V_1 = V_2$。\n在 $z=0$ 处，$R_1 = R_2 = \\sqrt{\\rho^2 + d^2}$。\n$$V_1(\\rho, 0) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + d^2}} + \\frac{q'}{\\sqrt{\\rho^2 + d^2}} \\right) = \\frac{q+q'}{4\\pi\\epsilon_1\\sqrt{\\rho^2 + d^2}}$$\n$$V_2(\\rho, 0) = \\frac{1}{4\\pi\\epsilon_1} \\frac{q''}{\\sqrt{\\rho^2 + d^2}}$$\n对所有 $\\rho$ 令二者相等，得到我们关于电荷的第一个关系式：\n$$q+q' = q''$$\n\n现在，我们应用第二个边界条件。我们首先需要电势对 $z$ 的导数。\n$$\\frac{\\partial V_1}{\\partial z} = \\frac{1}{4\\pi\\epsilon_1} \\left[ q \\left( -\\frac{z-d}{(\\rho^2 + (z-d)^2)^{3/2}} \\right) + q' \\left( -\\frac{z+d}{(\\rho^2 + (z+d)^2)^{3/2}} \\right) \\right]$$\n在 $z=0$ 处求值：\n$$\\frac{\\partial V_1}{\\partial z}\\bigg|_{z=0} = \\frac{1}{4\\pi\\epsilon_1} \\left[ \\frac{qd}{(\\rho^2 + d^2)^{3/2}} - \\frac{q'd}{(\\rho^2 + d^2)^{3/2}} \\right] = \\frac{d(q-q')}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}}$$\n\n对于区域 2 中的电势：\n$$\\frac{\\partial V_2}{\\partial z} = \\frac{1}{4\\pi\\epsilon_1} \\left[ q'' \\left( -\\frac{z-d}{(\\rho^2 + (z-d)^2)^{3/2}} \\right) \\right]$$\n在 $z=0$ 处求值：\n$$\\frac{\\partial V_2}{\\partial z}\\bigg|_{z=0} = \\frac{1}{4\\pi\\epsilon_1} \\left[ \\frac{q''d}{(\\rho^2 + d^2)^{3/2}} \\right] = \\frac{dq''}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}}$$\n\n将这些代入第二个边界条件 $\\epsilon_1 \\frac{\\partial V_1}{\\partial z}|_{z=0} = \\epsilon_2 \\frac{\\partial V_2}{\\partial z}|_{z=0}$：\n$$\\epsilon_1 \\left( \\frac{d(q-q')}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}} \\right) = \\epsilon_2 \\left( \\frac{dq''}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}} \\right)$$\n公共因子相消，得到我们的第二个关系式：\n$$q-q' = \\frac{\\epsilon_2}{\\epsilon_1} q''$$\n\n我们现在有一个关于 $q'$ 和 $q''$ 的二元线性方程组：\n$$(1) \\quad q+q' = q''$$\n$$(2) \\quad q-q' = \\frac{\\epsilon_2}{\\epsilon_1} q''$$\n将 (1) 代入 (2) 以消去 $q''$：\n$$q-q' = \\frac{\\epsilon_2}{\\epsilon_1} (q+q')$$\n我们需要求出比率 $q'/q$。两边乘以 $\\epsilon_1$ 以消去分母：\n$$\\epsilon_1(q-q') = \\epsilon_2(q+q')$$\n$$\\epsilon_1 q - \\epsilon_1 q' = \\epsilon_2 q + \\epsilon_2 q'$$\n重新整理，将含 $q$ 和 $q'$ 的项分组：\n$$\\epsilon_1 q - \\epsilon_2 q = \\epsilon_1 q' + \\epsilon_2 q'$$\n$$q(\\epsilon_1 - \\epsilon_2) = q'(\\epsilon_1 + \\epsilon_2)$$\n解出比率 $q'/q$：\n$$\\frac{q'}{q} = \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\n\n接下来，我们分析两个指定的极限情况。\n\n情况1：理想电导体 (PEC) 极限，$\\epsilon_2 \\to \\infty$。\n理想电导体是一种具有无限电导率的材料，在静电学中，其行为如同具有无限介电常数的介质。该边界条件迫使其表面上的切向电场为零，从而电势也为零（假设其接地，这是电势的隐式参考点）。\n$$\\lim_{\\epsilon_2 \\to \\infty} \\frac{q'}{q} = \\lim_{\\epsilon_2 \\to \\infty} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\n为计算该极限，我们将分子和分母同除以 $\\epsilon_2$：\n$$\\lim_{\\epsilon_2 \\to \\infty} \\frac{\\frac{\\epsilon_1}{\\epsilon_2} - 1}{\\frac{\\epsilon_1}{\\epsilon_2} + 1} = \\frac{0-1}{0+1} = -1$$\n在此极限下，$q' = -q$，这是导体平面另一侧镜像电荷的众所周知的结果。\n\n情况2：理想磁导体 (PMC) 极限，$\\epsilon_2 \\to 0$。\n理想磁导体是理想电导体的理论对偶。在静电学中，取 $\\epsilon_2 \\to 0$ 的极限对应于表面上电场法向分量为零的边界条件。\n$$\\lim_{\\epsilon_2 \\to 0} \\frac{q'}{q} = \\lim_{\\epsilon_2 \\to 0} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\n将 $\\epsilon_2 = 0$ 直接代入表达式：\n$$\\frac{\\epsilon_1 - 0}{\\epsilon_1 + 0} = \\frac{\\epsilon_1}{\\epsilon_1} = 1$$\n在此极限下，$q' = q$，这是理想磁导体表面另一侧镜像电荷的已知结果。\n\n最终答案要求一个包含这两个极限值的行矩阵，并按指定顺序排列。\n第一个值是 PEC 极限的结果，$-1$。\n第二个值是 PMC 极限的结果，$1$。\n因此，行矩阵为 $(-1, 1)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -1  1 \\end{pmatrix}}\n$$", "id": "3316430"}, {"introduction": "将理论物理模型转化为可靠的数值算法时，我们必须面对有限精度计算带来的挑战。这个练习将镜像理论从静态分析带入动态（时谐）计算领域，并聚焦于一个关键的数值稳定性问题。当源点与其镜像点非常接近时，直接对它们各自贡献的场进行相减会导致“灾难性对消”（subtractive cancellation），从而产生巨大的相对误差。通过分析此问题的渐近行为并评估不同的数值策略，您将学会如何通过解析重构或泰勒展开等方法来保持计算精度，这是开发稳健高效的电磁仿真工具所必需的实践技能 [@problem_id:3316475]。", "problem": "考虑一个位于自由空间中 $z=0$ 处平面理想电导体（PEC）上方的一个时谐源。在频域中，电场 $\\mathbf{E}$ 由麦克斯韦方程组控制，这可以利用并矢格林函数来表示。为了分离并分析镜像理论中固有的一个特定数值稳定性问题，我们考虑使用标量亥姆霍兹格林函数 $G(\\mathbf{r},\\mathbf{r}') = \\dfrac{e^{i k |\\mathbf{r}-\\mathbf{r}'|}}{4 \\pi |\\mathbf{r}-\\mathbf{r}'|}$ 作为并矢格林函数相关分量的代理核，其中 $k$ 是自由空间波数。\n\n设一点源位于 $\\mathbf{r}_{s}=(0,0,h)$，其中 $h0$ 很小，并设 $\\mathbf{r}=(\\rho,0,z)$ 表示一个观测点，其中 $z0$。利用PEC边界条件，镜像理论导出一个在 $\\mathbf{r}$ 处的标量势代理表示，形式为直接贡献和镜像贡献的叠加，\n$$\n\\Phi(\\mathbf{r}) = G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}}),\n$$\n其中 $\\mathbf{r}_{s}^{\\mathrm{im}}=(0,0,-h)$ 是源关于平面 $z=0$ 的镜像。\n\n当源高度 $h \\to 0^{+}$ 很小时，在 $z0$ 的上半空间的广大区域内，这两个格林函数项变得几乎相等，以至于它们的差值可能比每一项的量级小数个数量级。在具有机器单位舍入 $\\epsilon_{\\mathrm{mach}}$ 的有限精度算术中，如果朴素地逐项求差，这将导致严重的相消抵消。\n\n从上述基本定义和链式法则出发，分析当 $h \\to 0^{+}$ 时差值 $G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ 的渐近行为，并根据 $h$, $z$, $\\rho$, $k$ 和 $\\epsilon_{\\mathrm{mach}}$ 推导出朴素减法操作的条件。然后，严格关注定点精度算术（即 $\\epsilon_{\\mathrm{mach}}$ 是固定的，不允许扩展精度），确定下列策略中哪些能够通过解析性的重新缩放、重组或重构，在 $h \\to 0^{+}$ 时一致地保持 $\\Phi(\\mathbf{r})$ 的 $\\mathcal{O}(1)$ 相对精度，哪些不能。\n\nA. 在双精度下直接计算 $G(\\mathbf{r},\\mathbf{r}_{s})$ 和 $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ 并将它们相减，以直接的正向顺序（从最大量级到最小量级）对任何额外的镜像项（如果存在）求和，从而计算 $\\Phi(\\mathbf{r})$。\n\nB. 对于每个贡献 $G(\\mathbf{r},\\mathbf{r}_{+})-G(\\mathbf{r},\\mathbf{r}_{-})$ 形式差值的对称镜像对（其中 $\\mathbf{r}_{\\pm}$ 关于 $z=0$ 镜像对称），代数上分解出公共项，并使用避免灾难性抵消的恒等式来计算小的差值，例如通过平方差公式表示 $R_{+}-R_{-}$，并使用对小参数的数值稳定程序来计算 $e^{i k (R_{-}-R_{+})}-1$；更一般地，用从 $h$ 的泰勒展开中得到的第一个非零项替换小高度差。\n\nC. 对镜像项列表使用Kahan补偿求和，而不进行任何解析性的重组或重新缩放；这会减少求和的舍入误差，因此即使精确结果为 $\\mathcal{O}(h)$，也能保证 $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$ 的相对误差。\n\nD. 使用其谱（Sommerfeld）积分表示来重构半空间格林函数，并通过Ewald分裂法或Poisson求和将其计算为一个快速收敛的实空间近场和谱或模态远场的和，每一部分都以匹配的精度计算；这避免了几乎相等的镜像贡献之间的相消抵消。\n\nE. 在相减之前，将每一项 $G(\\mathbf{r},\\mathbf{r}_{s})$ 和 $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ 按其自身的量级进行归一化（即单独重新缩放各项），然后相减并取消缩放结果；这可以防止在减去几乎相等的项时发生有效数字的损失。", "solution": "### 推导与分析\n\n标量势 $\\Phi(\\mathbf{r})$ 由两个格林函数项的差值给出：\n$$\n\\Phi(\\mathbf{r}) = G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})\n$$\n源和镜像的位置分别是 $\\mathbf{r}_{s}=(0,0,h)$ 和 $\\mathbf{r}_{s}^{\\mathrm{im}}=(0,0,-h)$。观测点是 $\\mathbf{r}=(\\rho,0,z)$。从源和镜像源到观测点的距离是：\n$$\nR_{s} = |\\mathbf{r} - \\mathbf{r}_{s}| = \\sqrt{\\rho^2 + (z-h)^2}\n$$\n$$\nR_{im} = |\\mathbf{r} - \\mathbf{r}_{s}^{\\mathrm{im}}| = \\sqrt{\\rho^2 + (z+h)^2}\n$$\n因此，势为：\n$$\n\\Phi(\\mathbf{r}) = \\frac{e^{ikR_s}}{4\\pi R_s} - \\frac{e^{ikR_{im}}}{4\\pi R_{im}}\n$$\n当源高度 $h$ 趋近于 $0$ 时，我们观察到 $R_s \\to \\sqrt{\\rho^2+z^2}$ 和 $R_{im} \\to \\sqrt{\\rho^2+z^2}$。因此，$R_s \\approx R_{im}$，这导致 $G(\\mathbf{r},\\mathbf{r}_{s}) \\approx G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$。对这个差值的直接数值计算涉及两个几乎相等的浮点数相减，这是灾难性相消抵消的典型案例。\n\n为了分析此问题的严重性，我们求出当 $h$ 很小时 $\\Phi(\\mathbf{r})$ 的渐近行为。我们可以将 $\\Phi(\\mathbf{r})$ 视为 $f(h) - f(-h)$，其中 $f(h) = G(\\mathbf{r}, (0,0,h))$。在 $h=0$ 附近进行泰勒展开得到：\n$$\nf(h) = f(0) + f'(0)h + \\mathcal{O}(h^2)\n$$\n$$\nf(-h) = f(0) - f'(0)h + \\mathcal{O}(h^2)\n$$\n那么差值为：\n$$\n\\Phi(\\mathbf{r}) = f(h) - f(-h) = 2 f'(0) h + \\mathcal{O}(h^3)\n$$\n主阶行为是关于 $h$ 的线性关系。导数 $f'(0)$ 对应于 $\\left. \\frac{\\partial G(\\mathbf{r}, \\mathbf{r}')}{\\partial z'} \\right|_{z'=0}$，其中 $\\mathbf{r}'=(0,0,z')$。\n格林函数关于源坐标 $z'$ 的导数是：\n$$\n\\frac{\\partial G}{\\partial z'} = \\frac{\\partial}{\\partial z'} \\left(\\frac{e^{ikR}}{4\\pi R}\\right) = \\frac{e^{ikR}(ikR - 1)}{4\\pi R^2} \\frac{\\partial R}{\\partial z'}\n$$\n其中 $R = \\sqrt{\\rho^2+(z-z')^2}$。$R$ 的导数是 $\\frac{\\partial R}{\\partial z'} = -\\frac{z-z'}{R}$。在 $z'=0$ 处求值，我们有 $R_0 = \\sqrt{\\rho^2+z^2}$ 和 $\\left.\\frac{\\partial R}{\\partial z'}\\right|_{z'=0} = -z/R_0$。\n所以，\n$$\nf'(0) = \\left. \\frac{\\partial G}{\\partial z'} \\right|_{z'=0} = -\\frac{z}{4\\pi R_0^3} e^{ikR_0}(ikR_0 - 1)\n$$\n因此，对于小的 $h$：\n$$\n\\Phi(\\mathbf{r}) \\approx -2h \\frac{z}{4\\pi R_0^3} e^{ikR_0}(ikR_0-1)\n$$\n单个项 $G(\\mathbf{r},\\mathbf{r}_{s})$ 和 $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ 的量级是 $\\mathcal{O}(1)$，而它们的差 $\\Phi(\\mathbf{r})$ 的量级是 $\\mathcal{O}(h)$。\n在浮点数算术中，计算 $G(\\mathbf{r},\\mathbf{r}_{s})$ 的绝对误差约为 $\\epsilon_{\\mathrm{mach}} |G(\\mathbf{r},\\mathbf{r}_{s})|$。因此，差值的绝对误差在 $\\epsilon_{\\mathrm{mach}} |G(\\mathbf{r},\\mathbf{r}_{s})|$ 的量级上，即 $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$。\n计算出的 $\\Phi(\\mathbf{r})$ 的相对误差是：\n$$\n\\text{相对误差} = \\frac{\\text{绝对误差}}{|\\Phi(\\mathbf{r})|} \\approx \\frac{\\mathcal{O}(\\epsilon_{\\mathrm{mach}})}{\\mathcal{O}(h)} = \\mathcal{O}\\left(\\frac{\\epsilon_{\\mathrm{mach}}}{h}\\right)\n$$\n当 $h \\to 0^{+}$ 时，这个相对误差无界增长。为了保持 $\\mathcal{O}(1)$ 的相对精度（即一个有界的相对误差，理想情况下为 $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$），策略必须避免这种 $1/h$ 的缩放行为。\n\n### 逐项分析\n\n**A. 在双精度下直接计算 $G(\\mathbf{r},\\mathbf{r}_{s})$ 和 $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ 并将它们相减，以直接的正向顺序（从最大量级到最小量级）对任何额外的镜像项（如果存在）求和，从而计算 $\\Phi(\\mathbf{r})$。**\n此选项描述了上面分析过的朴素减法。如推导所示，该方法遭受灾难性抵消，导致相对误差按 $\\mathcal{O}(1/h)$ 比例缩放。因此，当 $h \\to 0^{+}$ 时，它无法保持 $\\mathcal{O}(1)$ 的相对精度。提及其他镜像项与主源及其直接镜像之间的核心抵消问题无关。\n**结论：不正确。**\n\n**B. 对于每个贡献 $G(\\mathbf{r},\\mathbf{r}_{+})-G(\\mathbf{r},\\mathbf{r}_{-})$ 形式差值的对称镜像对（其中 $\\mathbf{r}_{\\pm}$ 关于 $z=0$ 镜像对称），代数上分解出公共项，并使用避免灾难性抵消的恒等式来计算小的差值，例如通过平方差公式表示 $R_{+}-R_{-}$，并使用对小参数的数值稳定程序来计算 $e^{i k (R_{-}-R_{+})}-1$；更一般地，用从 $h$ 的泰勒展开中得到的第一个非零项替换小高度差。**\n此选项提出了两种有效的解析重构方法。\n1.  **代数重组：** 小差值 $R_{im} - R_s$ 可以通过 $R_{im} - R_s = \\frac{R_{im}^2 - R_s^2}{R_{im} + R_s} = \\frac{4zh}{R_{im} + R_s}$ 精确计算。项 $e^{ikR_s} - e^{ikR_{im}}$ 可以分解为 $e^{ikR_{im}}(e^{ik(R_s - R_{im})} - 1)$，其中小参数的复指数减 1 可以被精确计算（例如，使用 `expm1` 函数或其复数等价物）。通过仔细重组 $\\Phi(\\mathbf{r})$ 完整表达式中的各项，将几乎相等的数相减替换为良态量的乘法和除法。\n2.  **泰勒展开：** 使用泰勒级数的第一个非零项 $\\Phi(\\mathbf{r}) \\approx 2h \\left. \\frac{\\partial G}{\\partial z'} \\right|_{z'=0}$，直接计算出 $\\mathcal{O}(h)$ 的结果，无需任何减法。因子 $h$ 和导数分别计算然后相乘。这完全避免了抵消。\n这两种方法都是解决此问题的标准、有效技术，并将保持 $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$ 的相对误差。\n**结论：正确。**\n\n**C. 对镜像项列表使用Kahan补偿求和，而不进行任何解析性的重组或重新缩放；这会减少求和的舍入误差，因此即使精确结果为 $\\mathcal{O}(h)$，也能保证 $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$ 的相对误差。**\nKahan求和是一种旨在减轻对一长串浮点数求和时舍入误差累积的算法。它不解决，也无法解决两个几乎相等的数之差的相消抵消问题。有效数字的损失发生在单一操作 $G(\\mathbf{r},\\mathbf{r}_{s}) - G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ 内部，在任何求和算法应用于更长的项列表之前。对于仅有的两项，Kahan求和等同于直接减法。在此背景下声称它“保证 $\\mathcal{O}(\\epsilon_{\\mathrm{mach}})$ 的相对误差”是错误的。\n**结论：不正确。**\n\n**D. 使用其谱（Sommerfeld）积分表示来重构半空间格林函数，并通过Ewald分裂法或Poisson求和将其计算为一个快速收敛的实空间近场和谱或模态远场的和，每一部分都以匹配的精度计算；这避免了几乎相等的镜像贡献之间的相消抵消。**\n此选项建议将问题从空间域转换到谱域。半空间格林函数可以写成Sommerfeld积分。被积函数中导致抵消的项 $e^{-u_0|z-h|} - e^{-u_0(z+h)}$，可以解析地重写为 $2e^{-u_0 z} \\sinh(u_0 h)$。对于小的 $h$，$\\sinh(u_0h) \\approx u_0h$，这使得对 $h$ 的依赖性显式化，并消除了数值减法。随后的数值积分是良态的。虽然Ewald/Poisson方法通常用于周期性问题（无限镜像），但它们是相同原理的典范：通过解析重构来改善收敛性和数值稳定性。这类通用方法成功地避免了抵消问题。\n**结论：正确。**\n\n**E. 在相减之前，将每一项 $G(\\mathbf{r},\\mathbf{r}_{s})$ 和 $G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$ 按其自身的量级进行归一化（即单独重新缩放各项），然后相减并取消缩放结果；这可以防止在减去几乎相等的项时发生有效数字的损失。**\n这个策略是无效的。设 $G_s = G(\\mathbf{r},\\mathbf{r}_{s})$ 和 $G_{im} = G(\\mathbf{r},\\mathbf{r}_{s}^{\\mathrm{im}})$。当 $h \\to 0^{+}$ 时，我们有 $G_s \\approx G_{im}$，这意味着不仅它们的量级几乎相等（$|G_s| \\approx |G_{im}|$)，它们的相位也几乎相等。所提议的程序涉及计算归一化项的差值 $\\hat{G}_s - \\hat{G}_{im} = G_s/|G_s| - G_{im}/|G_{im}|$。由于 $G_s \\approx G_{im}$，因此单位范数的复数 $\\hat{G}_s$ 和 $\\hat{G}_{im}$ 也几乎相等。将它们相减将导致与原始问题中相同的有效数字的灾难性抵消。这种归一化仅仅是重新排列了计算，而没有解决根本的不稳定性。\n**结论：不正确。**", "answer": "$$\\boxed{BD}$$", "id": "3316475"}]}