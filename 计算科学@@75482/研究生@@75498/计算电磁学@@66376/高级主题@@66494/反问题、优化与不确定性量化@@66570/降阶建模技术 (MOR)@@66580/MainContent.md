## 引言
在现代科学与工程计算中，尤其是在[计算电磁学](@entry_id:265339)领域，对复杂物理现象的精确模拟往往依赖于对[偏微分方程](@entry_id:141332)（如麦克斯韦方程组）的精细离散化。这虽然保证了精度，但其代价是产生了具有数百万甚至更多自由度的超大规模动力系统，即[全阶模型](@entry_id:171001)（FOM）。直接对这些模型进行[时域仿真](@entry_id:755983)、[频域](@entry_id:160070)扫描或优化设计，其计算成本常常高得令人望而却步，严重制约了设计迭代和实时分析的能力。[降阶建模](@entry_id:177038)（Reduced-Order Modeling, ROM）技术应运而生，它旨在解决这一根本矛盾：通过系统性的数学方法，构建一个维度极低（阶数 $r \ll n$）却能高度保真地复现原始系统动态行为的代理模型。

本文旨在为研究生及相关领域研究人员提供一份关于[降阶建模](@entry_id:177038)技术的系统性指南。我们将跨越三个核心章节，从基本原理到前沿应用，逐步揭示[降阶建模](@entry_id:177038)的强大威力。在“原理与机制”一章中，我们将奠定理论基础，阐明[降阶建模](@entry_id:177038)如何从[全阶模型](@entry_id:171001)出发，通过投影原理实现维度约减，并详细介绍两种主流的投影基构建方法：数据驱动的恰当[正交分解](@entry_id:148020)（POD）和基于系统理论的[矩匹配](@entry_id:144382)。接着，在“应用与跨学科交叉”一章中，我们将展示这些理论在实践中的应用，探讨如何保持模型的物理结构（如无源性），如何耦合[多物理场](@entry_id:164478)系统，以及如何利用超缩减等技术克服[非线性](@entry_id:637147)带来的挑战。最后，在“动手实践”部分，我们将通过一系列精心设计的练习，将理论知识转化为实践技能。通过本文的学习，读者将能够深刻理解[降阶建模](@entry_id:177038)的核心思想，并掌握将其应用于解决实际工程与科学问题的能力。

## 原理与机制

在[计算电磁学](@entry_id:265339)中，通过[有限元法 (FEM)](@entry_id:176633)、[时域有限差分法 (FDTD)](@entry_id:261431) 或[矩量法 (MoM)](@entry_id:277025) 等方法对[麦克斯韦方程组](@entry_id:150940)进行离散化，通常会产生一个大规模的[常微分方程](@entry_id:147024) (ODE) 或[微分代数方程 (DAE)](@entry_id:193643) 系统。这类系统被称为[全阶模型](@entry_id:171001) (Full-Order Model, FOM)，是[降阶建模](@entry_id:177038)的出发点。

### [全阶模型](@entry_id:171001)：动力系统的起点

对于线性的、时不变的电磁系统，其[全阶模型](@entry_id:171001)通常可以表示为以下一阶描述符状态空间形式：

$$
E \dot{x}(t) = A x(t) + B u(t)
$$
$$
y(t) = C x(t) + D u(t)
$$

其中，$x(t) \in \mathbb{R}^{n}$ 是包含离散[电场和磁场](@entry_id:261347)自由度的[状态向量](@entry_id:154607)，$n$ 是系统的阶数，通常非常大（可达数百万）。$u(t)$ 和 $y(t)$ 分别是输入（例如，端口激励）和输出（例如，端口电压或[散射参数](@entry_id:754557)）。矩阵 $E, A, B, C, D$ 分别是描述符矩阵、系统矩阵、输入矩阵、输出矩阵和直通矩阵。

这些矩阵的具体结构和性质取决于所采用的[离散化方法](@entry_id:272547)。例如，在使用卷曲共形元（如 Nédélec 单元）进行[有限元离散化](@entry_id:193156)时，我们可以从[麦克斯韦方程组的弱形式](@entry_id:756666)出发，系统地推导出这些矩阵。考虑一个由[介电常数](@entry_id:146714)为 $\varepsilon(\mathbf{x})$、磁导率为 $\mu(\mathbf{x})$ 和[电导率](@entry_id:137481)为 $\sigma(\mathbf{x})$ 的材料填充的有界域 $\Omega$，其边界为[理想电导体](@entry_id:753331) (PEC)。通过[伽辽金法](@entry_id:749698)，我们可以得到一个[块矩阵](@entry_id:148435)形式的描述符系统，其中状态向量 $x(t)$ 由[电场和磁场](@entry_id:261347)的系数向量 $[e(t); h(t)]$ 构成。描述符矩阵 $E$ 通常是[对称正定](@entry_id:145886)的，包含了由[介电常数](@entry_id:146714)和[磁导率](@entry_id:154559)产生的质量矩阵 $M_{\varepsilon}$ 和 $M_{\mu}$。[系统矩阵](@entry_id:172230) $A$ 包含由电导率产生的阻尼项以及由离散[旋度算子](@entry_id:184984)产生的耦合项，其结构通常是反对称的（在无损情况下）。这种结构直接反映了[麦克斯韦方程组](@entry_id:150940)的内在物理特性。从这个[状态空间模型](@entry_id:137993)出发，我们可以推导出系统的[传递函数](@entry_id:273897) $H(s) = C(sE - A)^{-1}B + D$，它在[频域](@entry_id:160070)中描述了系统的输入-输出关系。[@problem_id:3345220]

不同的[离散化方法](@entry_id:272547)会产生具有不同特性的系统矩阵。基于[有限元法 (FEM)](@entry_id:176633) 的模型通常具有稀疏的、[对称正定](@entry_id:145886)的[质量矩阵](@entry_id:177093)和系统矩阵。基于[时域有限差分法 (FDTD)](@entry_id:261431) 的模型，如果采用集总质量近似，其质量矩阵是稀疏的[对角矩阵](@entry_id:637782)，这使得[显式时间积分](@entry_id:165797)方案非常高效。相比之下，基于[边界积分方程](@entry_id:746942)的[矩量法 (MoM)](@entry_id:277025) 通常产生稠密的、复对称的（但非厄米）[阻抗矩阵](@entry_id:274892)，这是因为[格林函数](@entry_id:147802)具有全局支持，导致所有[基函数](@entry_id:170178)之间都存在相互作用。理解这些FOM的[代数结构](@entry_id:137052)（如[稀疏性](@entry_id:136793)、对称性）对于选择和应用合适的降阶技术至关重要。[@problem_id:3345201]

### 投影原理

[降阶建模](@entry_id:177038)的核心思想是用一个低维[子空间](@entry_id:150286)来近似高维状态空间。具体来说，我们假设高维[状态向量](@entry_id:154607) $x(t)$ 可以由一个低维[坐标向量](@entry_id:153319) $y(t) \in \mathbb{R}^{r}$ ($r \ll n$) 通过一个固定的试探基 $V \in \mathbb{R}^{n \times r}$ 来近似，即 $x(t) \approx V y(t)$。

将此近似代入原始系统，我们得到一个残差 $r(t) = E V \dot{y}(t) - A V y(t) - B u(t)$。为了确定降阶模型 (Reduced-Order Model, ROM) 的[动力学方程](@entry_id:751029)，我们需要通过施加一个[正交性条件](@entry_id:168905)来最小化这个残差。在 **[彼得罗夫-伽辽金](@entry_id:174072) ([Petrov-Galerkin](@entry_id:174072)) 投影** 框架中，我们要求残差与另一个测试基 $W \in \mathbb{R}^{n \times r}$ 的[列空间](@entry_id:156444)正交，即 $W^{\top} r(t) = 0$。这导出了[降阶模型](@entry_id:754172)：

$$
E_r \dot{y}(t) = A_r y(t) + B_r u(t)
$$
$$
y_r(t) = C_r y(t) + D u(t)
$$

其中，$E_r = W^{\top} E V$, $A_r = W^{\top} A V$, $B_r = W^{\top} B$, $C_r = C V$。当 $W=V$ 时，这被称为 **伽辽金 (Galerkin) 投影**。

这种投影方法并非任意选择，而是有其深刻的理论依据。考虑一个[稳态](@entry_id:182458)问题 $A x = b$，其降阶近似为 $A V y \approx b$。我们可以将寻找最优降阶坐标 $y$ 的问题表述为最小化残差 $r(y) = b - A V y$ 的范数。如果我们在一个由某个厄米正定矩阵 $E$ 诱导的能量范数 $\|u\|_E = \sqrt{u^* E u}$ 中最小化残差，即最小化 $\|r(y)\|_E^2$，可以推导出最优坐标 $y$ 必须满足的法方程：

$$
(V^{\ast} A^{\ast} E A V) y = V^{\ast} A^{\ast} E b
$$

如果我们希望[彼得罗夫-伽辽金方法](@entry_id:753372)得到的降阶系统 $(W^{\ast} A V) y = W^{\ast} b$ 对于任意激励 $b$ 都能给出与上述能量范数最小化相同的解，那么通过比较两个方程，可以唯一地确定最优的测试基 $W$。该最优测试基为：

$$
W = E A V
$$

这个结果为投影方法提供了坚实的理论基础，表明特定的投影选择对应于在特定的[能量范数](@entry_id:274966)下最小化系统残差。这不仅是一种数学上的构造，更是一种物理上寻找最优近似的方式。[@problem_id:3345274]

### 投影基的构建

投影方法有效性的关键在于如何构建一个能够高效捕捉系统主要动态行为的低维基 $V$。构建基的方法主要分为两大类：数据驱动方法和系统理论方法。

#### 数据驱动的基构建：恰当[正交分解](@entry_id:148020) (POD)

恰当[正交分解](@entry_id:148020) (Proper Orthogonal Decomposition, POD)，也称为[主成分分析](@entry_id:145395) (PCA)，是一种从系统演化的一系列“快照”中提取[最优基](@entry_id:752971)的方法。“最优”的含义是，对于给定的基维度 $r$，POD基能够最大程度地捕捉快照集合中所包含的能量。

假设我们通过高保真仿真获得了一系列[电场](@entry_id:194326)快照 $\{\mathbf{E}(\mathbf{x}, t_i)\}_{i=1}^{m}$。在电磁学中，能量是核心的物理量。因此，我们使用[能量内积](@entry_id:167297) $\langle \mathbf{u}, \mathbf{v} \rangle_{\epsilon} := \int_{\Omega} \epsilon(\mathbf{x})\,\mathbf{u}(\mathbf{x}) \cdot \mathbf{v}(\mathbf{x})\,\mathrm{d}\mathbf{x}$ 来衡量场。将快照在有限元基下展开为系数向量 $\mathbf{a}_i$，这个[能量内积](@entry_id:167297)可以用能量加权质量矩阵 $M_{\epsilon}$ 表示为 $\langle \mathbf{E}_i, \mathbf{E}_k \rangle_{\epsilon} = \mathbf{a}_i^{\top} M_{\epsilon} \mathbf{a}_k$。所有快照之间的能量相关性可以由快照[相关矩阵](@entry_id:262631) $C = S^{\top} M_{\epsilon} S$ 来描述，其中 $S = [\mathbf{a}_1, \dots, \mathbf{a}_m]$ 是快照矩阵。[@problem_id:3345200]

POD基的构建可以通过对能量加权的快照矩阵 $\tilde{S} = M_{\epsilon}^{1/2} S$ 进行[奇异值分解](@entry_id:138057) (Singular Value Decomposition, SVD) 来实现。设 $\tilde{S} = U \Sigma V^{\top}$，其中 $U$ 的列向量 $\mathbf{u}_k$ 是[左奇异向量](@entry_id:751233)。那么，POD基的系数向量可以被证明是 $\mathbf{c}_k = (M_{\epsilon}^{1/2})^{-1} \mathbf{u}_k$。这个构造出的基在[能量内积](@entry_id:167297)下是正交的。

更重要的是，SVD提供了一种直接的误差度量。快照集的总能量可以表示为 $\mathcal{E}_{\text{total}} = \sum_{j} \sigma_{j}^{2}$，其中 $\sigma_j$ 是奇异值。一个由前 $r$ 个POD[基向量](@entry_id:199546)构成的截断基所能捕捉的能量为 $\mathcal{E}_{\text{captured}}(r) = \sum_{j=1}^{r} \sigma_{j}^{2}$。因此，能量捕获率为：

$$
\eta(r) = \frac{\sum_{j=1}^{r} \sigma_{j}^{2}}{\sum_{j=1}^{\text{all}} \sigma_{j}^{2}}
$$

这个公式为选择降阶模型的阶数 $r$ 提供了一个定量的、基于物理的准则。例如，要捕获至少99%的能量，我们只需选择最小的 $r$ 使得 $\eta(r) \ge 0.99$。[@problem_id:3345200]

#### 系统理论的基构建：[矩匹配](@entry_id:144382)

与数据驱动的方法不同，系统理论方法直接从系统的[传递函数](@entry_id:273897) $H(s)$ 出发来构建基。其核心思想是 **[矩匹配](@entry_id:144382) (moment matching)**。[传递函数](@entry_id:273897) $H(s)$ 在某个频点 $s_0$ 附近的[泰勒展开](@entry_id:145057)（或在 $s=\infty$ 附近的洛朗展开）的系数被称为系统的矩。如果一个[降阶模型](@entry_id:754172) $H_r(s)$ 的矩与原始模型 $H(s)$ 的矩在前几项上相匹配，那么这两个模型在频点 $s_0$ 附近的行为将非常相似。

在算法上，[矩匹配](@entry_id:144382)通常通过构建 **克里洛夫[子空间](@entry_id:150286) (Krylov subspace)** 来实现。例如，匹配 $H(s)$ 在 $s=0$ 处的矩等价于在块克里洛夫[子空间](@entry_id:150286) $\mathcal{K}(A^{-1}E, A^{-1}B)$ 上进行投影。

一个特别重要的情形是在 $s=\infty$ 处进行[矩匹配](@entry_id:144382)。[传递函数](@entry_id:273897)在 $s=\infty$ 处的洛朗展开 $H(s) = \sum_{k=0}^{\infty} \frac{\mu_k}{s^{k+1}}$ 的系数 $\mu_k$ 被称为 **马尔可夫参数 (Markov parameters)**，它们与系统冲激响应在 $t=0$ 处的初始时间导数[一一对应](@entry_id:143935)。因此，在 $s=\infty$ 处匹配矩等价于匹配系统在初始时刻的短时行为。这对于分析具有时延的系统尤其有用。例如，一个包含时延项 $\exp(-s\tau)$ 的系统，其[传递函数](@entry_id:273897)是非有理的。然而，在 $s \to \infty$ 的极限下，指数衰减项 $\exp(-s\tau)$ 比任何 $1/s$ 的幂次都衰减得快，因此它对任何有限阶的代数矩都没有贡献。这意味着系统的短时行为（在时延 $\tau$ 生效之前）完全由其无时延部分决定。通过在 $s=\infty$ 处匹配矩，我们可以构建一个有理函数近似，它能精确捕捉系统的初始[上升时间](@entry_id:263755)特性。我们可以利用[矩匹配](@entry_id:144382)误差的界来确定需要匹配多少个矩（即[降阶模型](@entry_id:754172)的阶数）才能满足给定的短时响应精度要求。[@problem_id:3345229]

### 高级主题与物理约束

#### 物理[可实现性](@entry_id:193701)：[无源性](@entry_id:171773)

一个在物理上可实现的电磁模型必须是 **无源的 (passive)**，这意味着它不能自发产生能量。在时域中，无源性通过[耗散不等式](@entry_id:188634)来定义：系统存[储能](@entry_id:264866)量的变化率不能超过供给给系统的功率，即 $\dot{V}(t) \le u(t)^{\top} y(t)$，其中 $V(t)$ 是存储的能量。对于一个由描述符系统描述的模型，其存[储能](@entry_id:264866)量通常具有二次型形式 $V(x) = \frac{1}{2}x^{\top} E_r x$，其中 $E_r$ 是[对称正定](@entry_id:145886)的。[@problem_id:3345255]

在[频域](@entry_id:160070)中，[无源性](@entry_id:171773)等价于一个更易于检验的数学性质：系统的[传递函数](@entry_id:273897) $H(s)$ 必须是 **正实 (positive real)** 的。一个函数 $H(s)$ 是正实的，如果：
1. $H(s)$ 在开[右半平面](@entry_id:277010) $\Re(s) > 0$ 内是解析的（即系统是稳定的）。
2. 对于所有实数 $s$，$H(s)$ 是实数。
3. 对于所有 $\Re(s) > 0$，其厄米部分 $H(s) + H(s)^*$ 是半正定的。

一个关键问题是，标准的降阶过程（如[伽辽金投影](@entry_id:145611)）并不总是能保证[无源性](@entry_id:171773)得以保留。即使原始的[全阶模型](@entry_id:171001)是无源的，其降阶模型也可能变为有源的，从而产生非物理的[振荡](@entry_id:267781)或发散。确保无源性是结构保持降阶 (structure-preserving model reduction) 的核心目标。一种保证无源性的方法是采用与定义能量的[内积](@entry_id:158127)相匹配的投影方案。例如，如果系统的耗散性由矩阵 $M$ 定义，那么使用一个在 $M$ [内积](@entry_id:158127)下正交的POD基，并结合在 $M$ [内积](@entry_id:158127)下的[伽辽金投影](@entry_id:145611)，可以保证[降阶模型](@entry_id:754172)继承原始系统的[耗散性](@entry_id:162959)和稳定性。[@problem_id:3345261]

#### 最优与近最优降阶：$H_2$ 范数与 IRKA

除了匹配特定频点的矩，我们还可以寻求在某个全局频率范围上最优的降阶模型。一个常用的度量是系统的 **$H_2$ 范数**，它衡量了系统对[白噪声](@entry_id:145248)输入的能量响应，或者等价地，系统冲激响应的能量。$H_2$ 最优降阶的目标是找到一个阶数为 $r$ 的降阶模型 $H_r(s)$，使得误差系统的 $H_2$ 范数 $\|H(s) - H_r(s)\|_{H_2}$ 最小。

$H_2$ 最优降阶的[一阶必要条件](@entry_id:170730)是，[降阶模型](@entry_id:754172) $H_r(s)$ 必须在原始模型 $H(s)$ 的某些点上进行插值。具体来说，如果 $\lambda_i$ 是降阶模型的极点，那么插值点就是这些极点的镜像点 $s_i = -\lambda_i$（对于[实数系](@entry_id:157774)统）。

**迭代有理克里洛夫算法 (Iterative Rational Krylov Algorithm, IRKA)** 是一种寻求满足这些 $H_2$ [最优性条件](@entry_id:634091)的[迭代算法](@entry_id:160288)。IRKA 的过程可以概括为一个[不动点迭代](@entry_id:749443)：
1.  给定一组初始插值点（或称为“偏移”）$\{s_i\}$。
2.  构建一个投影基 $V$ 和 $W$，使得降阶模型 $H_r(s)$ 在这些点上插值于 $H(s)$。
3.  计算降阶模型的新极点 $\{\lambda_i\}$。
4.  将新的插值点设置为这些新极点的镜像 $s_i \leftarrow -\lambda_i$。
5.  重复步骤2-4直至收敛。

当应用于具有奇异描述符矩阵 $E$ 的[微分代数方程 (DAE)](@entry_id:193643) 系统时，必须特别小心。这类系统的[传递函数](@entry_id:273897)可能包含一个与无限[特征值](@entry_id:154894)相关的多项式部分和一个与有限[特征值](@entry_id:154894)相关的严格真有理部分。由于 $H_2$ 范数仅对严格真[有理函数](@entry_id:154279)有定义，因此正确的做法是先将[系统分解](@entry_id:274870)，分离出严格真有理部分，然后仅对该部分应用 IRKA。[@problem_id:3345215]

#### 黑箱建模：矢量拟合 (VF)

在许多实际应用中，我们可能无法访问系统的内部状态空间矩阵 $(A, E, B, C)$，而只能通过仿真或测量获得其在某些频率点上的输入-输出数据，例如[散射参数](@entry_id:754557) (S-parameters)。在这种“黑箱”场景下，**矢量拟合 (Vector Fitting, VF)** 是一种强大的技术，用于从[频域](@entry_id:160070)数据中辨识出一个有理函数形式的[降阶模型](@entry_id:754172) $H_r(s) = \sum_{k=1}^{r} \frac{R_k}{s-p_k} + D$。

VF 的核心思想是巧妙地避开[非线性](@entry_id:637147)的极点辨识问题。它首先将问题重新表述为一个线性化的超定[最小二乘问题](@entry_id:164198)，通过引入一个共同的分母来同时拟合分子和分母的系数。然后，通过求解一个小规模的特征值问题来找到分母多项式的零点，这些零点就成为模型的新极点。这个“极点重定位”的过程被迭代进行，直到极点收敛。一旦稳定的极点被确定，最后一步是求解一个简单的线性最小二乘问题来计算残差矩阵 $R_k$ 和直通项 $D$。

需要强调的是，由VF算法直接得到的模型并不保证无源性，即使原始数据是无源的。因此，一个关键的后处理步骤是 **[无源性](@entry_id:171773)强制 (passivity enforcement)**，即对拟合出的模型进行微调，以确保其满足正实性条件，同时尽量不影响拟合精度。[@problem_id:3345231]

### [参数化](@entry_id:272587)[降阶建模](@entry_id:177038) (pMOR)

在设计和优化电磁器件时，我们通常需要研究系统性能如何随某个几何或材料参数 $\mu$（例如，频率、尺寸、[介电常数](@entry_id:146714)）的变化而变化。对每个参数点都进行一次全阶仿真和降阶是不可行的。**[参数化](@entry_id:272587)[降阶建模](@entry_id:177038) (Parametric Model Order Reduction, pMOR)** 的目标是构建一个单一的、能够对整个参数范围都有效的[降阶模型](@entry_id:754172)。

pMOR 的关键是实现计算过程的 **离线-在线 (offline-online)** 分解。昂贵的、与参数无关的计算在“离线”阶段一次性完成；而对于任何给定的新参数值，只需要在“在线”阶段进行非常快速的计算。

这种分解的先决条件是系统算子对参数的 **仿射依赖性 (affine parameter dependence)**，即系统矩阵可以表示为 $A(\mu) = \sum_{q=1}^{Q} \theta_q(\mu) A_q$，其中 $\theta_q(\mu)$ 是依赖于参数的标量函数，而 $A_q$ 是与参数无关的常数矩阵。在这种情况下，我们可以离线计算每个常数矩阵 $A_q$ 的降阶版本 $A_{r,q} = V^{\top} A_q V$。在线阶段，对于一个新的参数 $\mu$，我们只需计算标量 $\theta_q(\mu)$，然后通过[线性组合](@entry_id:154743) $A_r(\mu) = \sum_{q} \theta_q(\mu) A_{r,q}$ 来快速组装降阶系统矩阵。[@problem_id:3345242]

然而，许多实际问题中的参数依赖性是非仿射的。例如，[介电常数](@entry_id:146714)对频率的依赖关系可能很复杂。**[经验插值法](@entry_id:748957) (Empirical Interpolation Method, EIM)** 是一种强大的技术，用于为非[仿射函数](@entry_id:635019)创建一个近似的仿射表示。EIM 通过一个[贪心算法](@entry_id:260925)，从函数快照中选择一组[基函数](@entry_id:170178) $\{u_q(x)\}$ 和一组“魔术点” $\{x_q\}$，使得任何非[仿射函数](@entry_id:635019) $f(x, \mu)$ 都可以近似为 $f(x, \mu) \approx \sum_{q=1}^{Q} \theta_q(\mu) u_q(x)$。系数 $\theta_q(\mu)$ 通过求解一个在魔术点上进行插值的小规模 ($Q \times Q$) [线性系统](@entry_id:147850)来快速确定。通过将 EIM 应用于非仿射的系统矩阵项，我们可以恢复仿射结构，从而实现高效的[离线-在线分解](@entry_id:177117)，极大地扩展了 pMOR 的[适用范围](@entry_id:636189)。[@problem_id:3345282]