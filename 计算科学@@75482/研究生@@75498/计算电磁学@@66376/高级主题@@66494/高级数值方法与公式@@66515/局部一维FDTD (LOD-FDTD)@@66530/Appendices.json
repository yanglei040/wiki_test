{"hands_on_practices": [{"introduction": "一维LOD-FDTD（等价于Crank-Nicolson格式）的一个主要优点是其无条件稳定性，但这并非没有代价。本练习通过分析该方法固有的数值色散来探讨这一权衡。你将通过求解一个挑战性的问题——即找到最小化色散误差的最优时间步长——来揭示该方法的一个基本特性，其令人意外的结论将凸显它与标准显式FDTD方法的核心差异。[@problem_id:3325286]", "problem": "考虑一个无损耗、均匀、无源的一维电磁介质，其介电常数为 $\\varepsilon$，磁导率为 $\\mu$，波速为 $c = 1/\\sqrt{\\varepsilon \\mu}$。设空间网格是均匀的，间距为 $\\Delta$，并考虑一维的局部一维时域有限差分 (LOD-FDTD) 离散化，该离散化可简化为标准交错 Yee 网格上采用中心空间差分的一阶麦克斯韦旋度方程的梯形 (Crank–Nicolson) 时间离散化。假设网格是无限扩展的周期性网格，因此傅里叶 (von Neumann) 分析适用，并考虑在第一布里渊区 $k \\in [0, \\pi/\\Delta]$ 内波数大小为 $k$ 的平面波解。\n\n定义由 LOD-FDTD 格式所蕴含的数值角频率 $\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$，以及物理角频率 $\\omega_{\\text{phys}}(k) = c\\,k$。定义在布里渊区上的积分色散误差泛函\n$$\n\\mathcal{E}(\\Delta t) = \\int_{-\\pi/\\Delta}^{\\pi/\\Delta} \\left(\\omega_{\\text{num}}(k; \\Delta t, \\Delta) - \\omega_{\\text{phys}}(k)\\right)^{2} \\, \\mathrm{d}k.\n$$\n从麦克斯韦方程和所述的 LOD-FDTD 离散化出发，通过 von Neumann 分析推导出 $\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$，并确定在固定 $\\Delta$ 的情况下使 $\\mathcal{E}(\\Delta t)$ 最小化的时间步长 $\\Delta t$ 的值。如果最小值仅在极限情况下达到，请报告该极限值。将您的最终答案表示为最优 $\\Delta t$ 的单个闭式值，单位为秒。\n\n然后，简要地将此最优选择与一维显式 Yee 时域有限差分 (FDTD) 方法中由精度驱动的时间步长选择进行对比，讨论 Courant 比率如何影响同一布里渊区内的数值色散。您的最终答案必须是使 $\\mathcal{E}(\\Delta t)$ 最小化的最优 $\\Delta t$ 的单个数值或闭式表达式；最终答案框内不要包含任何单位。", "solution": "该问题要求解出在一维局部一维时域有限差分 (LOD-FDTD) 格式下，使给定的积分色散误差泛函最小化的时间步长 $\\Delta t$ 的值。\n\n### 步骤一：问题验证\n\n**1.1. 提取已知条件：**\n- **介质：** 无损耗、均匀、无源的一维电磁介质。\n- **常数：** 介电常数 $\\varepsilon$、磁导率 $\\mu$、波速 $c = 1/\\sqrt{\\varepsilon \\mu}$。\n- **网格：** 均匀空间网格，间距为 $\\Delta$。无限扩展的周期性网格。\n- **离散化格式：** 一维 LOD-FDTD，具体为标准交错 Yee 网格上采用中心空间差分的一阶麦克斯韦旋度方程的梯形 (Crank–Nicolson) 时间离散化。\n- **分析：** 傅里叶 (von Neumann) 分析，用于波数大小为 $k$ 且在第一布里渊区 $k \\in [0, \\pi/\\Delta]$ 内的平面波解。\n- **定义：**\n    - 数值角频率：$\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$。\n    - 物理角频率：$\\omega_{\\text{phys}}(k) = c\\,k$。\n- **误差泛函：**\n$$ \\mathcal{E}(\\Delta t) = \\int_{-\\pi/\\Delta}^{\\pi/\\Delta} \\left(\\omega_{\\text{num}}(k; \\Delta t, \\Delta) - \\omega_{\\text{phys}}(k)\\right)^{2} \\, \\mathrm{d}k $$\n- **目标：**\n    1. 推导 $\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$。\n    2. 在固定 $\\Delta$ 的情况下，确定使 $\\mathcal{E}(\\Delta t)$ 最小化的 $\\Delta t$ 的值。\n    3. 简要地将此最优 $\\Delta t$ 与显式一维 Yee FDTD 方法的最优值进行对比。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题基于麦克斯韦方程及其通过 FDTD 方法的数值解，这是计算电磁学的基石。数值色散、von Neumann 分析和误差泛函等概念都是标准且科学合理的。\n- **适定性：** 问题设定了一个清晰的优化任务：最小化一个明确定义的泛函。定义是精确的。\n- **客观性：** 问题以精确、客观的数学和物理语言陈述。\n\n**1.3. 结论：**\n问题陈述具有科学依据、自洽且适定。这是一个计算物理学中的有效问题。\n\n### 步骤二：数值色散关系的推导\n\n我们从 TEz 极化（场分量为 $E_z$ 和 $H_y$）的一维麦克斯韦方程开始：\n$$ \\frac{\\partial E_z}{\\partial t} = -\\frac{1}{\\varepsilon} \\frac{\\partial H_y}{\\partial x} $$\n$$ \\frac{\\partial H_y}{\\partial t} = -\\frac{1}{\\mu} \\frac{\\partial E_z}{\\partial x} $$\n在交错 Yee 网格上，我们记 $E_z(i\\Delta, n\\Delta t) \\equiv E_{z,i}^n$ 和 $H_y((i+1/2)\\Delta, n\\Delta t) \\equiv H_{y,i+1/2}^n$。Crank-Nicolson 离散化（时间上的梯形法则）结合中心空间差分给出：\n$$ \\frac{E_{z,i}^{n+1} - E_{z,i}^n}{\\Delta t} = -\\frac{1}{2\\varepsilon\\Delta} \\left[ (H_{y,i+1/2}^{n+1} - H_{y,i-1/2}^{n+1}) + (H_{y,i+1/2}^n - H_{y,i-1/2}^n) \\right] $$\n$$ \\frac{H_{y,i+1/2}^{n+1} - H_{y,i+1/2}^n}{\\Delta t} = -\\frac{1}{2\\mu\\Delta} \\left[ (E_{z,i+1}^{n+1} - E_{z,i}^{n+1}) + (E_{z,i+1}^n - E_{z,i}^n) \\right] $$\n我们通过代入平面波拟设来进行 von Neumann 分析：\n$$ E_{z,i}^n = \\hat{E}_z \\exp[j(k i\\Delta - \\omega_{\\text{num}} n\\Delta t)] $$\n$$ H_{y,i+1/2}^n = \\hat{H}_y \\exp[j(k(i+1/2)\\Delta - \\omega_{\\text{num}} n\\Delta t)] $$\n其中 $j = \\sqrt{-1}$。设放大因子为 $G = \\exp(-j\\omega_{\\text{num}}\\Delta t)$。将拟设代入离散方程，得到关于振幅 $\\hat{E}_z$ 和 $\\hat{H}_y$ 的线性方程组：\n$$ \\hat{E}_z (G-1) = -\\frac{\\Delta t}{2\\varepsilon\\Delta} \\left( \\hat{H}_y \\exp(j k\\Delta/2) - \\hat{H}_y \\exp(-j k\\Delta/2) \\right) (G+1) $$\n$$ \\hat{H}_y (G-1) = -\\frac{\\Delta t}{2\\mu\\Delta} \\left( \\hat{E}_z \\exp(j k\\Delta/2) - \\hat{E}_z \\exp(-j k\\Delta/2) \\right) (G+1) $$\n使用 $\\exp(j\\theta) - \\exp(-j\\theta) = 2j\\sin(\\theta)$ 进行简化：\n$$ \\hat{E}_z (G-1) = -\\frac{j\\Delta t}{\\varepsilon\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) (G+1) \\hat{H}_y $$\n$$ \\hat{H}_y (G-1) = -\\frac{j\\Delta t}{\\mu\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) (G+1) \\hat{E}_z $$\n为得到非平凡解，我们将这两个方程相乘并消去 $\\hat{E}_z \\hat{H}_y$：\n$$ (G-1)^2 = (j^2) \\frac{(\\Delta t)^2}{\\varepsilon\\mu\\Delta^2} \\sin^2\\left(\\frac{k\\Delta}{2}\\right) (G+1)^2 $$\n使用 $c=1/\\sqrt{\\varepsilon\\mu}$，我们得到：\n$$ (G-1)^2 = -\\frac{c^2(\\Delta t)^2}{\\Delta^2} \\sin^2\\left(\\frac{k\\Delta}{2}\\right) (G+1)^2 $$\n开平方根并整理得到 $G$：\n$$ \\frac{G-1}{G+1} = \\pm j \\frac{c\\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) $$\n根据定义 $G = \\exp(-j\\omega_{\\text{num}}\\Delta t)$ 和恒等式 $\\frac{\\exp(-j\\phi)-1}{\\exp(-j\\phi)+1} = -j\\tan(\\phi/2)$：\n$$ -j\\tan\\left(\\frac{\\omega_{\\text{num}}\\Delta t}{2}\\right) = \\pm j \\frac{c\\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) $$\n选择具有物理意义的正频率解：\n$$ \\tan\\left(\\frac{\\omega_{\\text{num}}\\Delta t}{2}\\right) = \\frac{c\\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) $$\n解出 $\\omega_{\\text{num}}$ 得到数值色散关系：\n$$ \\omega_{\\text{num}}(k; \\Delta t, \\Delta) = \\frac{2}{\\Delta t} \\arctan\\left(\\frac{c \\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) $$\n\n### 步骤三：误差泛函的最小化\n\n色散误差泛函由下式给出：\n$$ \\mathcal{E}(\\Delta t) = \\int_{-\\pi/\\Delta}^{\\pi/\\Delta} \\left[ \\frac{2}{\\Delta t} \\arctan\\left(\\frac{c \\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) - ck \\right]^{2} \\, \\mathrm{d}k $$\n被积函数是非负的，所以 $\\mathcal{E}(\\Delta t) \\ge 0$。我们寻求 $\\mathcal{E}(\\Delta t)$ 的最小值。我们研究被积函数作为 $\\Delta t$ 的函数的行为。\n为清晰起见，我们引入无量纲变量。设 $S = c\\Delta t/\\Delta$ 为 Courant 数，$u = k\\Delta/2$。积分变量 $k$ 的范围是 $[-\\pi/\\Delta, \\pi/\\Delta]$，所以 $u$ 的范围是 $[-\\pi/2, \\pi/2]$。物理频率为 $\\omega_{\\text{phys}} = ck = c(2u/\\Delta)$。方括号内的表达式变为：\n$$ \\frac{2c}{S\\Delta} \\arctan(S \\sin u) - \\frac{2cu}{\\Delta} = \\frac{2c}{\\Delta} \\left( \\frac{\\arctan(S \\sin u)}{S} - u \\right) $$\n泛函可以重写为：\n$$ \\mathcal{E}(S) = \\int_{-\\pi/2}^{\\pi/2} \\left[ \\frac{2c}{\\Delta} \\left( \\frac{\\arctan(S \\sin u)}{S} - u \\right) \\right]^2 \\frac{2}{\\Delta} \\mathrm{d}u = \\frac{8c^2}{\\Delta^3} \\int_{-\\pi/2}^{\\pi/2} \\left( \\frac{\\arctan(S \\sin u)}{S} - u \\right)^2 \\mathrm{d}u $$\n我们寻求关于 $S > 0$ 最小化 $\\mathcal{E}(S)$。这等价于对每个 $u$ 最小化被积函数中的平方误差项。让我们分析函数 $g(S, u) = \\frac{\\arctan(S \\sin u)}{S} - u$。\n\n考虑一个固定的 $u \\in (0, \\pi/2]$。设 $x = \\sin u$，所以 $x \\in (0, 1]$。我们分析函数 $h(S) = \\frac{\\arctan(Sx)}{S}$ 作为 $S > 0$ 的函数的行为。\n$h(S)$ 关于 $S$ 的导数是：\n$$ \\frac{\\mathrm{d}h}{\\mathrm{d}S} = \\frac{\\frac{x}{1+(Sx)^2}S - \\arctan(Sx)}{S^2} = \\frac{1}{S^2} \\left( \\frac{Sx}{1+(Sx)^2} - \\arctan(Sx) \\right) $$\n设 $z = Sx$。对于 $z>0$，我们分析项 $p(z) = \\frac{z}{1+z^2} - \\arctan(z)$ 的符号。\n其导数为 $p'(z) = \\frac{(1+z^2) - z(2z)}{(1+z^2)^2} - \\frac{1}{1+z^2} = \\frac{1-z^2-(1+z^2)}{(1+z^2)^2} = \\frac{-2z^2}{(1+z^2)^2}$。\n对于 $z > 0$，$p'(z) < 0$。由于 $p(0)=0$，因此对于所有 $z > 0$，$p(z) < 0$。\n这意味着对于所有 $S>0$，$\\frac{\\mathrm{d}h}{\\mathrm{d}S} < 0$。因此，对于任何固定的 $u \\in (0, \\pi/2]$，$h(S)$ 是 $S$ 的严格递减函数。\n完整的误差项是 $g(S, u) = h(S) - u$。由于 $h(S)$ 是 $S$ 的严格递减函数，所以 $g(S, u)$ 也是。\n让我们检查在 $S \\to 0$ 时的误差值：\n$$ \\lim_{S\\to 0} g(S, u) = \\lim_{S\\to 0} \\frac{\\arctan(S \\sin u)}{S} - u = \\sin u - u $$\n对于 $u \\in (0, \\pi/2]$，我们知道 $\\sin u < u$，所以这个极限误差是负的。\n由于 $g(S, u)$ 从一个负的初始值严格递减，因此对于所有 $S > 0$ 和 $u \\in (0, \\pi/2]$，$g(S, u)$ 都是负的。\n因此，误差的量值 $|g(S, u)|$ 是 $S$ 的严格递增函数。因此，被积函数与 $g(S, u)^2 = |g(S, u)|^2$ 成正比，对于任何 $u \\in (0, \\pi/2]$，它都是 $S$（也就是 $\\Delta t$）的严格递增函数。\n因此，总积分误差 $\\mathcal{E}(\\Delta t)$ 是 $\\Delta t$ 在 $\\Delta t \\ge 0$ 上的单调递增函数。\n在定义域 $[0, \\infty)$ 上，单调递增函数的最小值出现在边界处，即在极限 $\\Delta t \\to 0$ 时。\n\n使积分色散误差泛函最小化的时间步长值为 $\\Delta t = 0$。\n\n### 步骤四：与显式 Yee FDTD 的对比\n\n对于 LOD-FDTD (Crank-Nicolson) 格式，最优时间步长为 $\\Delta t = 0$ 的这一发现，与标准一维显式蛙跳 Yee FDTD 格式的行为形成了鲜明对比。\n\n对于一维显式 Yee 格式，其数值色散关系为：\n$$ \\omega_{\\text{num,Yee}} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{c \\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) $$\n该格式是条件稳定的，要求 Courant 数 $S = c\\Delta t/\\Delta \\le 1$。\nYee 格式的色散误差是 $\\omega_{\\text{num,Yee}} - \\omega_{\\text{phys}}$。我们可以问，这个误差是否可以对所有 $k$ 都变为零。这将要求：\n$$ \\frac{2}{\\Delta t} \\arcsin\\left(S \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) = ck $$\n代入 $S = c\\Delta t/\\Delta$ 和 $u=k\\Delta/2$：\n$$ \\frac{c}{S\\Delta} \\arcsin(S\\sin u) = \\frac{cu}{\\Delta} \\implies \\arcsin(S\\sin u) = Su $$\n这个方程对所有 $u \\in [-\\pi/2, \\pi/2]$ 成立，当且仅当 $S=1$。在这个特定值下，$\\arcsin(\\sin u) = u$，数值色散关系变为 $\\omega_{\\text{num,Yee}} = ck = \\omega_{\\text{phys}}$。\n这意味着对于一维显式 Yee 格式，选择时间步长 $\\Delta t = \\Delta/c$（即在 Courant 稳定性极限 $S=1$ 下运行）可以完全消除数值色散。对于这个选择，泛函 $\\mathcal{E}(\\Delta t)$ 将恒等于零。\n\n**总结：**\n- 隐式 **LOD-FDTD (Crank-Nicolson) 格式** 是无条件稳定的，但对于任何 $\\Delta t > 0$ 都始终存在色散。积分色散误差仅在极限 $\\Delta t \\to 0$ 时才最小化。\n- 显式 **Yee FDTD 格式** 是条件稳定的 ($c\\Delta t/\\Delta \\le 1$)，但拥有一个“神奇时间步长” $\\Delta t = \\Delta/c$，在该步长下它完全没有数值色散。这代表了一个有限、非零的精度最优选择。\n\n这凸显了一个根本性的权衡：隐式格式以固有的色散为代价提供了无条件的稳定性，而显式格式可以实现完美的精度（无色散），但其时间步长受到稳定性约束。", "answer": "$$ \\boxed{0} $$", "id": "3325286"}, {"introduction": "在前一个练习揭示了LOD-FDTD固有的色散误差会随时间步长增加后，本练习将这一概念具体化。你将分析LOD格式的非线性色散关系如何影响高斯脉冲的传播，通过计算群延迟和脉冲展宽导致的幅度衰减，你将亲身体验到利用该方法无条件稳定性而选择大时间步长所带来的实际后果。[@problem_id:3325272]", "problem": "您的任务是设计一个高斯调制平面波激励，并使用局部一维时域有限差分 (LOD-FDTD) 离散化方法，计算在一维均匀介质中探针处的预期到达时间和振幅。目标是阐明 LOD 格式产生的数值色散如何在一个大的时间步长 $\\,\\Delta t\\,$ 下改变群延迟和包络振幅。在自由空间中进行计算，光速 $\\,c = 299{,}792{,}458\\,$ m/s。激励是一个时域高斯包络 $\\,g(t) = \\exp\\!\\big(-\\frac{t^2}{2\\sigma_t^2}\\big)\\,$，它调制一个角频率为 $\\,\\omega_0 = 2\\pi f_0\\,$ 的单色载波，峰值振幅为 $\\,A_0 = 1\\,$。\n\n您的推导应基于：\n- 无损、各向同性、均匀介质中平面波的一维 Maxwell 方程组，其中 $\\,\\partial_t E = \\frac{1}{\\varepsilon}\\partial_x H\\,$ 且 $\\,\\partial_t H = \\frac{1}{\\mu}\\partial_x E\\,$，并有 $\\,c = \\frac{1}{\\sqrt{\\varepsilon\\mu}}\\,$。\n- 在平面波拟设下，一维空间中的局部一维 (LOD) 时间中心隐式离散格式产生的数值色散关系具有以下形式\n$$\n\\tan\\!\\left(\\frac{\\omega\\,\\Delta t}{2}\\right) = \\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)\\,\\sin\\!\\left(\\frac{k\\,\\Delta x}{2}\\right),\n$$\n其中 $\\,\\Delta x\\,$ 是均匀空间步长，$\\,\\Delta t\\,$ 是时间步长，$\\,\\omega\\,$ 是角频率，$\\,k\\,$ 是波数。\n\n根据此色散关系，计算：\n1. 距离源 $\\,L\\,$ 处的探针的群延迟 $\\,t_{\\text{arr}}\\,$，其定义为累积相位对角频率的导数，\n$$\nt_{\\text{arr}} = L\\,\\frac{d k}{d\\omega},\n$$\n其中 $\\,\\frac{d k}{d\\omega}\\,$ 是由 LOD 格式在载波频率 $\\,\\omega_0\\,$ 处引入的群速度的倒数。\n\n2. 由于数值色散引起的包络展宽，在探针处的振幅比 $\\,R = \\frac{A_{\\text{out}}}{A_0}\\,$。对于一个窄带高斯包络，假设输出时间标准差满足\n$$\n\\sigma_{\\text{out}}^2 = \\sigma_t^2 + \\frac{\\big(\\beta_2\\,L\\big)^2}{\\sigma_t^2},\n$$\n其中 $\\,\\beta_2 = \\frac{d^2 k}{d\\omega^2}\\,$ 是波数对角频率的二阶导数，在 $\\,\\omega_0\\,$ 处求值。振幅比则由包络的能量守恒得出，\n$$\nR = \\frac{\\sigma_t}{\\sigma_{\\text{out}}}.\n$$\n\n使用 LOD 色散关系，以 $\\,\\Delta x\\,$、$\\,\\Delta t\\,$ 和 $\\,\\omega_0\\,$ 表示来计算 $\\,\\frac{d k}{d\\omega}\\,$ 和 $\\,\\frac{d^2 k}{d\\omega^2}\\,$。引入通过以下方式隐式定义的无量纲变量 $\\,\\Omega_0 = \\frac{\\omega_0 \\Delta t}{2}\\,$ 和 $\\,K_0 = k_0 \\Delta x\\,$\n$$\nK_0 = 2\\,\\arcsin\\!\\left(\\frac{1}{S}\\,\\tan(\\Omega_0)\\right), \\quad S = \\frac{c\\,\\Delta t}{\\Delta x},\n$$\n前提是 $\\,\\left|\\frac{1}{S}\\tan(\\Omega_0)\\right| \\leq 1\\,$。然后计算\n$$\n\\frac{d k}{d\\omega} = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos\\!\\left(\\frac{K_0}{2}\\right)},\n$$\n和\n$$\n\\frac{d^2 k}{d\\omega^2} = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\tan(\\Omega_0)\\,\\Delta t}{\\cos\\!\\left(\\frac{K_0}{2}\\right)} \\;+\\; \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\sin\\!\\left(\\frac{K_0}{2}\\right)}{2\\,\\cos^2\\!\\left(\\frac{K_0}{2}\\right)} \\cdot \\left[\\frac{\\Delta x}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos\\!\\left(\\frac{K_0}{2}\\right)}\\right].\n$$\n\n您的程序必须对以下四个测试用例评估 $\\,t_{\\text{arr}}\\,$ 和 $\\,R\\,$，并将最终结果以单行形式输出，格式为方括号内以逗号分隔的列表。到达时间必须以纳秒表示，振幅比必须是无单位的小数。输出必须包含八个浮点数，顺序为 $[t_1,R_1,t_2,R_2,t_3,R_3,t_4,R_4]$，每个数都四舍五入到六位小数。\n\n测试套件：\n- 用例 1 (理想情况，中等 $\\,\\Delta t\\,$):\n    - $\\,\\Delta x = 1.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 1.0\\,$ m,\n    - $\\,f_0 = 5.0\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 5.0\\times 10^{-10}\\,$ s,\n    - 类库朗数 $\\,S = \\frac{c\\,\\Delta t}{\\Delta x} = 0.5\\,$.\n\n- 用例 2 (大 $\\,\\Delta t\\,$，相同载波):\n    - $\\,\\Delta x = 1.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 1.0\\,$ m,\n    - $\\,f_0 = 5.0\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 5.0\\times 10^{-10}\\,$ s,\n    - $\\,S = 2.0\\,$.\n\n- 用例 3 (更大的 $\\,\\Delta t\\,$，使用更低载波以维持传播模式):\n    - $\\,\\Delta x = 1.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 1.0\\,$ m,\n    - $\\,f_0 = 3.0\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 2.0\\times 10^{-10}\\,$ s,\n    - $\\,S = 3.0\\,$.\n\n- 用例 4 (更粗的网格和非常大的 $\\,\\Delta t\\,$，低载波):\n    - $\\,\\Delta x = 2.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 2.0\\,$ m,\n    - $\\,f_0 = 1.5\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 3.0\\times 10^{-10}\\,$ s,\n    - $\\,S = 4.0\\,$.\n\n诸如 $\\,\\Omega_0\\,$ 和 $\\,K_0\\,$ 的角度量必须以弧度处理。如果对于任何测试用例，参数 $\\,\\left|\\frac{1}{S}\\tan(\\Omega_0)\\right|\\,$ 超过 $\\,1\\,$，则将该用例视为非传播情况，并为到达时间和振幅比返回 $\\,\\text{NaN}\\,$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表，顺序为 $[t_1,R_1,t_2,R_2,t_3,R_3,t_4,R_4]$，其中每个 $\\,t_i\\,$ 以纳秒为单位，每个 $\\,R_i\\,$ 是一个无单位的小数，所有数值均四舍五入到六位小数。", "solution": "该问题要求计算一个高斯调制平面波的群延迟和振幅衰减，该平面波在通过局部一维时域有限差分 (LOD-FDTD) 格式模拟的一维介质中传播。该分析基于此方法固有的数值色散关系。\n\n此问题被认为是有效的，因为它在科学上基于计算电磁学和波传播的原理，是适定的（提供了所有必要的信息和公式），并以客观、正式的语言表述。所提供的波数对角频率的一阶和二阶导数公式已经通过对给定色散关系进行微分验证，并被证实是正确的。因此，我们可以继续进行完整求解。\n\n所涉及的基本物理原理是数值色散。在理想真空中，平面波的所有频率分量都以光速 $c$ 传播。角频率 $\\omega$ 和波数 $k$ 之间的关系是线性的：$k = \\omega/c$。因此，群速度 $v_g = (dk/d\\omega)^{-1}$ 是一个常数且等于 $c$。这意味着脉冲形状在传播过程中保持不变。\n\n像 FDTD 这样的数值离散化方法，在离散的时空网格上近似连续的 Maxwell 方程组。这种近似在数值频率 $\\omega$ 和数值波数 $k$ 之间引入了非线性关系，该关系由数值色散关系描述。对于指定的 LOD-FDTD 格式，该关系为：\n$$\n\\tan\\left(\\frac{\\omega\\,\\Delta t}{2}\\right) = S\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\n$$\n其中 $\\Delta x$ 是空间步长，$\\Delta t$ 是时间步长，而 $S = c\\,\\Delta t/\\Delta x$ 是一个类库朗数。LOD-FDTD 方法的一个关键优势是其无条件稳定性，允许 $S > 1$，这在标准的显式 FDTD 方法中是不允许的。然而，使用大的时间步长（大的 $S$）会带来显著的数值色散，而本问题旨在量化此效应。\n\n数值色散对脉冲的影响有两个方面：\n1. 脉冲包络以群速度 $v_g = (dk/d\\omega)^{-1}$ 传播，该速度在载波频率 $\\omega_0$ 处计算。因此，在距离 $L$ 处的到达时间 $t_{\\text{arr}}$ 由群延迟给出，即 $t_{\\text{arr}} = L/v_g = L\\,(dk/d\\omega)|_{\\omega_0}$。\n2. 脉冲的不同频率分量以略微不同的速度传播，导致脉冲随时间展宽或“色散”。这种现象由群延迟色散 (GDD) 参数 $\\beta_2 = d^2k/d\\omega^2|_{\\omega_0}$ 来量化。对于一个初始时间标准差为 $\\sigma_t$ 的高斯脉冲，在传播距离 $L$ 后，其输出脉冲宽度 $\\sigma_{\\text{out}}$ 由 $\\sigma_{\\text{out}}^2 = \\sigma_t^2 + (\\beta_2 L)^2/\\sigma_t^2$ 给出。假设脉冲能量守恒，随着脉冲展宽，其峰值振幅必须减小。输出与输入振幅之比 $R$ 由 $R = \\sigma_t / \\sigma_{\\text{out}}$ 给出。\n\n每个测试用例的计算过程如下：\n\n**步骤 1：计算派生参数**\n对于每个测试用例，给定基本参数 $\\Delta x$、$L$、$f_0$、$\\sigma_t$ 和 $S$，我们首先计算辅助参数。\n- 光速, $c = 299792458 \\, \\text{m/s}$。\n- 载波角频率, $\\omega_0 = 2\\pi f_0$。\n- 时间步长, $\\Delta t = S \\cdot \\Delta x / c$。\n\n**步骤 2：检查传播模式**\n可以重新排列数值色散关系以求解波数 $k$。\n$$\nk = \\frac{2}{\\Delta x} \\arcsin\\left(\\frac{1}{S} \\tan\\left(\\frac{\\omega \\Delta t}{2}\\right)\\right)\n$$\n对于对应于传播波的实值波数 $k$，$\\arcsin$ 函数的参数必须在区间 $[-1, 1]$ 内。我们定义无量纲频率 $\\Omega_0 = \\omega_0 \\Delta t / 2$ 并在载波频率处计算该参数：\n$$\n\\text{arg} = \\frac{1}{S} \\tan(\\Omega_0)\n$$\n如果 $|\\text{arg}| > 1$，波数将变为复数，代表一个倏逝（非传播）模式。对于这种情况，到达时间和振幅是未定义的，我们报告 `NaN`。\n\n**步骤 3：计算数值波数及其导数**\n如果模式是传播的，我们继续计算载波频率处的无量纲波数 $K_0 = k_0 \\Delta x$：\n$$\nK_0 = 2 \\arcsin\\left(\\frac{1}{S} \\tan(\\Omega_0)\\right)\n$$\n在确定 $\\Omega_0$ 和 $K_0$ 后，我们使用提供的、预先推导的公式来计算 $k$ 相对于 $\\omega$ 的一阶和二阶导数：\n- 群速度的倒数：\n$$\n\\frac{dk}{d\\omega} = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos(K_0/2)}\n$$\n- GDD 参数, $\\beta_2 = \\frac{d^2k}{d\\omega^2}$：\n$$\n\\beta_2 = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\tan(\\Omega_0)\\,\\Delta t}{\\cos(K_0/2)} + \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\sin(K_0/2)}{2\\,\\cos^2(K_0/2)} \\left[\\frac{\\Delta x}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos(K_0/2)}\\right]\n$$\n\n**步骤 4：计算最终量**\n- 计算群延迟（到达时间）并将其转换为纳秒：\n$$\nt_{\\text{arr}} = L \\cdot \\frac{dk}{d\\omega} \\quad (\\text{以秒为单位}) \\implies t_{\\text{arr, ns}} = t_{\\text{arr}} \\cdot 10^9\n$$\n- 计算输出时间标准差：\n$$\n\\sigma_{\\text{out}} = \\sqrt{\\sigma_t^2 + \\frac{(\\beta_2 L)^2}{\\sigma_t^2}}\n$$\n- 然后求得振幅比：\n$$\nR = \\frac{\\sigma_t}{\\sigma_{\\text{out}}}\n$$\n对四个测试用例中的每一个都执行此过程，并将结果编译为指定的输出格式。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the group delay and amplitude ratio for a Gaussian pulse in a 1D\n    LOD-FDTD simulation based on its numerical dispersion relation.\n    \"\"\"\n    # Define physical constant\n    c = 299792458.0  # Speed of light in m/s\n\n    # Test cases from the problem statement\n    # Each tuple: (Δx, L, f₀, σₜ, S)\n    test_cases = [\n        # Case 1: happy path, moderate Δt\n        (1.0e-2, 1.0, 5.0e9, 5.0e-10, 0.5),\n        # Case 2: large Δt, same carrier\n        (1.0e-2, 1.0, 5.0e9, 5.0e-10, 2.0),\n        # Case 3: larger Δt with lower carrier\n        (1.0e-2, 1.0, 3.0e9, 2.0e-10, 3.0),\n        # Case 4: coarser grid and very large Δt\n        (2.0e-2, 2.0, 1.5e9, 3.0e-10, 4.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        dx, L, f0, sigma_t, S = case\n        \n        # Step 1: Calculate derived parameters\n        omega0 = 2.0 * np.pi * f0\n        dt = S * dx / c\n        \n        # Step 2: Check for propagating mode\n        Omega_0 = omega0 * dt / 2.0\n        \n        # Argument for the arcsin function\n        arg_arcsin = np.tan(Omega_0) / S\n        \n        if abs(arg_arcsin) > 1.0:\n            # Non-propagating (evanescent) mode\n            t_ns = np.nan\n            R = np.nan\n            results.extend([t_ns, R])\n            continue\n\n        # Step 3: Compute numerical wavenumber and derivatives\n        # Dimensionless wavenumber\n        K_0 = 2.0 * np.arcsin(arg_arcsin)\n        \n        # Pre-calculate trigonometric terms for efficiency and clarity\n        cos_Omega_0 = np.cos(Omega_0)\n        tan_Omega_0 = np.tan(Omega_0)\n        sec_sq_Omega_0 = 1.0 / (cos_Omega_0**2)\n        cos_K0_half = np.cos(K_0 / 2.0)\n        sin_K0_half = np.sin(K_0 / 2.0)\n\n        # Inverse group velocity (dk/dω)\n        dk_domega = (1.0 / c) * sec_sq_Omega_0 / cos_K0_half\n        \n        # GDD parameter (d²k/dω²)\n        # This parameter is beta_2 in the problem description.\n        beta2_term1 = (1.0 / c) * (sec_sq_Omega_0 * tan_Omega_0 * dt) / cos_K0_half\n        \n        # The expression in square brackets in the problem statement\n        beta2_term2_factor = (dx / c) * sec_sq_Omega_0 / cos_K0_half\n        beta2_term2 = (1.0 / c) * (sec_sq_Omega_0 * sin_K0_half) / (2.0 * cos_K0_half**2) * beta2_term2_factor\n        \n        beta2 = beta2_term1 + beta2_term2\n        \n        # Step 4: Calculate final quantities\n        # Arrival time (group delay) in seconds\n        t_arr = L * dk_domega\n        # Convert to nanoseconds\n        t_ns = t_arr * 1e9\n\n        # Output pulse temporal standard deviation squared\n        sigma_out_sq = sigma_t**2 + ((beta2 * L)**2) / sigma_t**2\n        sigma_out = np.sqrt(sigma_out_sq)\n        \n        # Amplitude ratio\n        R = sigma_t / sigma_out\n        \n        results.extend([t_ns, R])\n\n    # Format the final output as specified\n    formatted_results = [f\"{val:.6f}\" if not np.isnan(val) else \"nan\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3325272"}, {"introduction": "当将LOD-FDTD方法推广到多维空间时，一个源于方向算符不可交换性的新误差——分裂误差——便会出现。本练习设计了一个二维周期性盒子中的数值实验，用于直接测量由Strang分裂格式引起的累积相位误差。通过这个实践，你将对把一个多维问题分解为一系列一维更新所需付出的代价有一个定量的理解。[@problem_id:3325222]", "problem": "考虑真空中的麦克斯韦方程组，其描述了关于 $z$ 轴的二维横磁极化，其中非零场分量为 $H_x$、$H_y$ 和 $E_z$。控制方程为\n$$\n\\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial y},\\quad \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial x},\\quad \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon_0}\\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right),\n$$\n其中 $\\varepsilon_0$ 为真空介电常数，$\\mu_0$ 为真空磁导率。设光速为 $c = 1/\\sqrt{\\varepsilon_0 \\mu_0}$。在一个长度为 $L_x$ 和 $L_y$ 的矩形周期域（一个“周期性盒子”）上，允许的空间傅里叶模式的波数为\n$$\nk_x = \\frac{2\\pi n_x}{L_x},\\quad k_y = \\frac{2\\pi n_y}{L_y},\n$$\n其中 $n_x$ 和 $n_y$ 是整数。对于单个傅里叶模式，场根据一个线性常微分方程演化\n$$\n\\frac{d}{dt}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix} = \\mathbf{M}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix},\n$$\n其中\n$$\n\\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y, \\quad \\mathbf{M}_x = \\begin{bmatrix}0 & 0 & 0 \\\\ 0 & 0 & \\frac{i k_x}{\\mu_0} \\\\ 0 & \\frac{i k_x}{\\varepsilon_0} & 0\\end{bmatrix},\\quad \\mathbf{M}_y = \\begin{bmatrix}0 & 0 & -\\frac{i k_y}{\\mu_0} \\\\ 0 & 0 & 0 \\\\ -\\frac{i k_y}{\\varepsilon_0} & 0 & 0\\end{bmatrix}.\n$$\n对于角频率为 $\\omega = c \\sqrt{k_x^2 + k_y^2}$ 的平面波，其精确解是在与本征值 $\\lambda_\\pm = \\pm i \\omega$ 相关联的不变子空间中的一个旋转，其在时间增量 $\\Delta t$ 内的单步演化由矩阵指数 $\\exp(\\Delta t\\,\\mathbf{M})$ 给出。在一个局域一维 (LOD) 分裂算子格式中，$\\Delta t$ 上的时间更新算子由一个 Strang 型乘积近似\n$$\n\\mathbf{G}_\\text{LOD}(\\Delta t) = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right)\\,\\exp\\!\\left(\\Delta t\\,\\mathbf{M}_y\\right)\\,\\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right),\n$$\n这对应于半离散傅里叶模式在时间上的二阶局域一维 (LOD) 时域有限差分 (FDTD) 算子分裂。\n\n设计一个周期性盒子实验，从与本征值 $\\lambda_- = -i \\omega$ 相关联的物理平面波本征向量开始，根据此本征向量一致地初始化场，并在每个周期固定步数为 $m$ 的情况下，使用 LOD 分裂算子执行 $N$ 个周期的时间演化。一个周期为 $T = 2\\pi/\\omega$，时间步长为 $\\Delta t = T/m$。$N$ 个周期后，将累积相位定义为 $\\mathbf{G}_\\text{LOD}(\\Delta t)$ 的主导复本征值的总辐角乘以总步数 $N m$。$N$ 个周期后的精确累积相位为 $-2\\pi N$ 弧度。累积相位误差是数值累积相位与精确累积相位之差，以弧度表示。\n\n您必须通过使用指定的分解 $\\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y$ 将误差与算子分裂结构联系起来，但您的程序应从分裂算子中数值计算累积相位误差。所有角度必须以弧度表示。在国际单位制中使用 $\\varepsilon_0 = 8.854\\,187\\,817\\times 10^{-12}\\,\\mathrm{F/m}$、$\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$ 和 $c = 1/\\sqrt{\\varepsilon_0 \\mu_0}$。\n\n实现一个程序，对于下面的每个测试用例，为指定的周期性盒子构造 $\\mathbf{M}_x$ 和 $\\mathbf{M}_y$，计算 $\\mathbf{G}_\\text{LOD}(\\Delta t)$，找出 $\\mathbf{G}_\\text{LOD}(\\Delta t)$ 的最接近精确单步相位因子 $\\exp(-i\\omega\\Delta t)$ 的本征值，并报告 $N$ 个周期后的累积相位误差，结果为一个浮点数，单位为弧度。\n\n测试套件参数集（每个元组列出 $(L_x\\,\\mathrm{[m]}, L_y\\,\\mathrm{[m]}, n_x, n_y, N, m)$）：\n1. $(L_x = 1.0, L_y = 1.0, n_x = 1, n_y = 0, N = 5, m = 20)$\n2. $(L_x = 1.0, L_y = 1.0, n_x = 1, n_y = 1, N = 10, m = 20)$\n3. $(L_x = 0.5, L_y = 0.75, n_x = 2, n_y = 1, N = 5, m = 6)$\n4. $(L_x = 1.2, L_y = 0.8, n_x = 0, n_y = 1, N = 3, m = 12)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_j$ 是相应测试用例的累积相位误差，单位为弧度。", "solution": "起点是真空中关于二维横磁极化的麦克斯韦方程组。方程如下：\n$$\n\\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial y},\\quad \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial x},\\quad \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon_0}\\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right).\n$$\n在一个长度为 $L_x$ 和 $L_y$ 的周期性盒子上，一个波数为 $k_x = 2\\pi n_x/L_x$ 和 $k_y = 2\\pi n_y/L_y$ 的空间傅里叶模式将偏微分方程转换为关于傅里叶振幅的线性常微分方程。使用复数表示法，时间导数作用于场振幅向量，而导数映射为乘以 $i k_x$ 和 $i k_y$。这得到了紧凑形式：\n$$\n\\frac{d}{dt}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix} = \\mathbf{M}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix},\\quad \\mathbf{M} = \\begin{bmatrix}0 & 0 & -\\frac{i k_y}{\\mu_0} \\\\ 0 & 0 & \\frac{i k_x}{\\mu_0} \\\\ -\\frac{i k_y}{\\varepsilon_0} & \\frac{i k_x}{\\varepsilon_0} & 0\\end{bmatrix}.\n$$\n很自然地可以将 $\\mathbf{M}$ 分解为 $\\mathbf{M}_x$ 和 $\\mathbf{M}_y$，以分离 $x$ 和 $y$ 方向的耦合：\n$$\n\\mathbf{M}_x = \\begin{bmatrix}0 & 0 & 0 \\\\ 0 & 0 & \\frac{i k_x}{\\mu_0} \\\\ 0 & \\frac{i k_x}{\\varepsilon_0} & 0\\end{bmatrix},\\quad \\mathbf{M}_y = \\begin{bmatrix}0 & 0 & -\\frac{i k_y}{\\mu_0} \\\\ 0 & 0 & 0 \\\\ -\\frac{i k_y}{\\varepsilon_0} & 0 & 0\\end{bmatrix},\\quad \\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y.\n$$\n在单个时间步长 $\\Delta t$ 内的连续时间精确演化是 $\\exp(\\Delta t\\,\\mathbf{M})$。我们所考虑的局域一维 (LOD) 分裂算子格式应用了 Strang 对称分裂\n$$\n\\mathbf{G}_\\text{LOD}(\\Delta t) = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right)\\,\\exp\\!\\left(\\Delta t\\,\\mathbf{M}_y\\right)\\,\\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right).\n$$\n该算子在时间上是二阶精确的。Strang 乘积是通过交替执行 $x$ 方向算子的半步和 $y$ 方向算子的全步来构造的。$\\mathbf{G}_\\text{LOD}(\\Delta t)$ 与精确解 $\\exp(\\Delta t\\,\\mathbf{M})$ 的偏差由 $\\mathbf{M}_x$ 和 $\\mathbf{M}_y$ 的非对易性决定。对于 Strang 分裂，Baker–Campbell–Hausdorff 展开式得出\n$$\n\\mathbf{G}_\\text{LOD}(\\Delta t) = \\exp\\left(\\Delta t\\,\\mathbf{M} + \\frac{\\Delta t^3}{24}\\left([\\,\\mathbf{M}_x,[\\,\\mathbf{M}_x,\\mathbf{M}_y]\\,] + 2[\\,\\mathbf{M}_y,[\\,\\mathbf{M}_x,\\mathbf{M}_y]\\,]\\right) + O(\\Delta t^5)\\right),\n$$\n其中 $[\\,\\cdot,\\cdot\\,]$ 表示对易子。对易子项的存在表明，如果 $k_x = 0$ 或 $k_y = 0$，则 $\\mathbf{M}_x$ 或 $\\mathbf{M}_y$ 为零，对易子为零，分裂算子与精确算子匹配，从而消除了由分裂引起的相位误差。当 $k_x \\neq 0$ 和 $k_y \\neq 0$ 时，对易子非零，主要局部误差的量级为 $O(\\Delta t^3)$；在固定的总时长（例如，总时间为 $N T$ 的固定周期数 $N$）内，全局误差累积的量级为 $O(\\Delta t^2)$。\n\n对于平面波，角频率为 $\\omega = c \\sqrt{k_x^2 + k_y^2}$，其中 $c = 1/\\sqrt{\\varepsilon_0 \\mu_0}$。一个位于与本征值 $\\lambda_- = -i \\omega$ 对应的精确物理本征向量上的一致初始条件，可以通过任意选择 $E_z(0)$（例如，$E_z(0) = 1$）并设置\n$$\nH_x(0) = \\frac{k_y}{\\mu_0 \\omega} E_z(0),\\quad H_y(0) = -\\frac{k_x}{\\mu_0 \\omega} E_z(0),\n$$\n来给出，这确保了在精确算子下 $\\frac{d}{dt}[H_x,H_y,E_z]^T = -i\\omega[H_x,H_y,E_z]^T$。\n\n为了计算在每个周期 $m$ 步、共 $N$ 个周期后，在 LOD 分裂下的累积相位误差，我们定义时间步长 $\\Delta t = \\frac{2\\pi}{\\omega m}$ 和总步数 $n = N m$。该物理模式的精确单步相位因子是 $\\exp(-i\\omega\\Delta t)$。分裂算子 $\\mathbf{G}_\\text{LOD}(\\Delta t)$ 是一个 $3\\times 3$ 的复数矩阵，其本征值近似于精确因子。物理上相关的分裂本征值是与 $\\exp(-i\\omega\\Delta t)$ 最接近的那个。其复辐角，记为 $\\theta_\\text{LOD} = \\arg(\\lambda_\\text{LOD})$，近似于 $-\\omega\\Delta t$。那么 $n$ 步后的数值累积相位为 $n\\,\\theta_\\text{LOD}$。精确累积相位为 $-\\omega \\Delta t\\,n = -2\\pi N$。累积相位误差为\n$$\n\\Delta\\phi = n\\,\\theta_\\text{LOD} - (-2\\pi N),\n$$\n以弧度表示。\n\n算法流程如下：\n1. 对于每个测试用例 $(L_x, L_y, n_x, n_y, N, m)$，计算 $k_x = 2\\pi n_x/L_x$、$k_y = 2\\pi n_y/L_y$、$\\omega = c \\sqrt{k_x^2 + k_y^2}$ 和 $\\Delta t = 2\\pi/(\\omega m)$。\n2. 根据上述公式构建 $\\mathbf{M}_x$ 和 $\\mathbf{M}_y$，并使用矩阵指数计算分裂算子 $\\mathbf{G}_\\text{LOD}(\\Delta t)$。\n3. 计算 $\\mathbf{G}_\\text{LOD}(\\Delta t)$ 的本征值，并选择复平面上与 $\\exp(-i\\omega\\Delta t)$ 最接近的一个。\n4. 计算 $\\theta_\\text{LOD} = \\arg(\\lambda_\\text{LOD})$，然后计算 $\\Delta\\phi = (N m)\\,\\theta_\\text{LOD} - (-2\\pi N)$，单位为弧度。\n5. 报告 $\\Delta\\phi$。\n\n与算子分裂结构的关系通过分解 $\\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y$ 以及当 $k_x$ 和 $k_y$ 均非零时的非零对易子 $[\\,\\mathbf{M}_x,\\mathbf{M}_y\\,]$ 体现出来，这产生了主要的相位误差。当其中一个波数为零时，对易子为零，分裂算子变得精确，导致对所有 $N$ 累积相位误差为零。\n\n测试套件包含以下参数集：\n1. $(L_x = 1.0\\,\\mathrm{m}, L_y = 1.0\\,\\mathrm{m}, n_x = 1, n_y = 0, N = 5, m = 20)$，用于验证当 $k_y = 0$ 时误差为零。\n2. $(L_x = 1.0\\,\\mathrm{m}, L_y = 1.0\\,\\mathrm{m}, n_x = 1, n_y = 1, N = 10, m = 20)$，作为一个具有中等时间分辨率的一般情况。\n3. $(L_x = 0.5\\,\\mathrm{m}, L_y = 0.75\\,\\mathrm{m}, n_x = 2, n_y = 1, N = 5, m = 6)$，用于探究更大的时间步长和更强的分裂误差累积。\n4. $(L_x = 1.2\\,\\mathrm{m}, L_y = 0.8\\,\\mathrm{m}, n_x = 0, n_y = 1, N = 3, m = 12)$，用于验证当 $k_x = 0$ 时误差为零。\n\n要求的输出格式为单行，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_j$ 是对应第 $j$ 个测试用例的累积相位误差，单位为弧度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef compute_phase_error(Lx, Ly, nx, ny, N_cycles, m_steps_per_period):\n    # Physical constants (SI units)\n    eps0 = 8.854187817e-12  # F/m\n    mu0 = 4.0 * np.pi * 1e-7  # H/m\n    c = 1.0 / np.sqrt(eps0 * mu0)\n\n    # Wavenumbers for periodic box\n    kx = 2.0 * np.pi * nx / Lx\n    ky = 2.0 * np.pi * ny / Ly\n    k_mag = np.sqrt(kx**2 + ky**2)\n    if k_mag == 0.0:\n        # No wave (DC mode); define zero error\n        return 0.0\n\n    # Angular frequency and time step\n    omega = c * k_mag\n    dt = (2.0 * np.pi) / (omega * m_steps_per_period)\n    n_steps = N_cycles * m_steps_per_period\n\n    # Construct Mx and My matrices (3x3 complex)\n    i = 1j\n    Mx = np.array([[0.0+0.0j, 0.0+0.0j, 0.0+0.0j],\n                   [0.0+0.0j, 0.0+0.0j, (i * kx) / mu0],\n                   [0.0+0.0j, (i * kx) / eps0, 0.0+0.0j]], dtype=np.complex128)\n\n    My = np.array([[0.0+0.0j, 0.0+0.0j, -(i * ky) / mu0],\n                   [0.0+0.0j, 0.0+0.0j, 0.0+0.0j],\n                   [-(i * ky) / eps0, 0.0+0.0j, 0.0+0.0j]], dtype=np.complex128)\n\n    # Strang LOD step operator\n    G = expm(0.5 * dt * Mx) @ expm(dt * My) @ expm(0.5 * dt * Mx)\n\n    # Exact one-step phase factor for the physical mode\n    lambda_exact = np.exp(-1j * omega * dt)\n\n    # Eigenvalues of the split operator\n    eigvals = np.linalg.eigvals(G)\n\n    # Select eigenvalue closest to exact one-step factor\n    idx = np.argmin(np.abs(eigvals - lambda_exact))\n    lambda_lod = eigvals[idx]\n\n    # Accumulated phases\n    theta_lod = np.angle(lambda_lod)          # radians per step (LOD)\n    total_phase_lod = n_steps * theta_lod     # radians after N cycles\n    total_phase_exact = -omega * dt * n_steps # equals -2*pi*N\n\n    # Phase error in radians\n    phase_error = total_phase_lod - total_phase_exact\n    return float(phase_error)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Lx [m], Ly [m], nx, ny, N, m)\n    test_cases = [\n        (1.0, 1.0, 1, 0, 5, 20),\n        (1.0, 1.0, 1, 1, 10, 20),\n        (0.5, 0.75, 2, 1, 5, 6),\n        (1.2, 0.8, 0, 1, 3, 12),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, nx, ny, N, m = case\n        result = compute_phase_error(Lx, Ly, nx, ny, N, m)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3325222"}]}