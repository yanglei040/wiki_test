{"hands_on_practices": [{"introduction": "有限体积时域（FVTD）方法构建于麦克斯韦方程组的积分形式之上。第一个练习 [@problem_id:3307958] 将我们带回这一基础，要求我们分析单个孤立控制体积内的场演化。通过研究一个均匀场的简单情况，我们可以清晰地看到 FVTD 的核心机制：单元平均场的时间变化率由穿过其边界的场通量净值直接决定。", "problem": "考虑一个用于计算电磁学的时域有限体积法 (FVTD) 中的单个立方控制体。该立方体的边长为 $\\Delta$，其边界 $\\partial V$ 由六个平面组成，每个平面的向外单位法向量为 $\\mathbf{n}_{f}$。立方体内部无源，因此自由电流密度 $\\mathbf{J}=\\mathbf{0}$ 且不存在外加磁单极子。在某一瞬间，立方体内的电场和磁场是均匀的，分别等于 $\\mathbf{E}=(E_{0},0,0)$ 和 $\\mathbf{H}=(0,H_{0},0)$。\n\n从基本原理（麦克斯韦方程组的局域微分形式）出发，并使用与 FVTD 框架一致的体积分和适当的矢量积分恒等式，计算：\n1. 净表面积分通量矢量\n$$\\mathbf{F}_{E}\\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{E}\\, \\mathrm{d}S \\quad \\text{和} \\quad \\mathbf{F}_{H}\\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{H}\\, \\mathrm{d}S.$$\n2. 单元平均磁通量密度和单元平均电通量密度的瞬时时间导数，\n$$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle \\quad \\text{和} \\quad \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle,$$\n其中 $\\langle \\mathbf{B}\\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{B}\\,\\mathrm{d}V$，$\\langle \\mathbf{D}\\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{D}\\,\\mathrm{d}V$，且 $V=\\Delta^{3}$ 是立方体的体积。\n\n将 $\\mathbf{F}_{E}$ 以伏特-米为单位表示，$\\mathbf{F}_{H}$ 以安培-米为单位表示，$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ 以特斯拉每秒为单位表示，$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$ 以库仑每平方米秒为单位表示。将您的最终答案表示为一个单行矩阵，按以下顺序包含：\n$$\\left[F_{E,x},\\,F_{E,y},\\,F_{E,z},\\,F_{H,x},\\,F_{H,y},\\,F_{H,z},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{x},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{y},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{z},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{x},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{y},\\,\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{z}\\right].$$\n\n无需四舍五入。最终答案必须是如上所述的单个解析表达式。", "solution": "对该问题的分析始于无源区域内的麦克斯韦方程组的局域微分形式，在该区域中自由电流密度 $\\mathbf{J}=\\mathbf{0}$ 且不存在磁单极子。两个相关的方程是法拉第电磁感应定律和安培-麦克斯韦定律：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\n这里，$\\mathbf{E}$ 是电场，$\\mathbf{H}$ 是磁场，$\\mathbf{B}$ 是磁通量密度，$\\mathbf{D}$ 是电通量密度。\n\n该问题要求计算两类量：表面积分通量矢量和单元平均场的时间导数。这两种计算都依赖于一个通用的矢量积分恒等式，该恒等式将矢量场的旋度的体积分与该体积边界上的面积分联系起来。对于任意连续可微的矢量场 $\\mathbf{A}$ 和一个体积为 $V$、边界面为 $\\partial V$ 的区域，该恒等式为：\n$$ \\int_{V} (\\nabla \\times \\mathbf{A}) \\, \\mathrm{d}V = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{A} \\, \\mathrm{d}S $$\n其中 $\\mathbf{n}$ 是面元 $\\mathrm{d}S$ 的向外单位法向量。\n\n问题陈述，在所考虑的瞬间，立方控制体内的电场和磁场是均匀的。具体来说，$\\mathbf{E}=(E_{0},0,0)$ 和 $\\mathbf{H}=(0,H_{0},0)$，其中 $E_{0}$ 和 $H_{0}$ 是常数。一个矢量场是均匀的（即在空间上是常数）的一个关键推论是其旋度处处为零。\n对于电场 $\\mathbf{E}$：\n$$ \\nabla \\times \\mathbf{E} = \\nabla \\times (E_{0}\\hat{\\mathbf{x}}) = \\mathbf{0} $$\n对于磁场 $\\mathbf{H}$：\n$$ \\nabla \\times \\mathbf{H} = \\nabla \\times (H_{0}\\hat{\\mathbf{y}}) = \\mathbf{0} $$\n\n首先，我们计算净表面积分通量矢量 $\\mathbf{F}_{E}$ 和 $\\mathbf{F}_{H}$。\n\n对于 $\\mathbf{F}_{E}$：\n其定义为 $\\mathbf{F}_{E} \\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{E}\\, \\mathrm{d}S$，这等价于闭合曲面积分 $\\oint_{\\partial V}\\mathbf{n}\\times \\mathbf{E}\\, \\mathrm{d}S$。应用上述矢量积分恒等式：\n$$ \\mathbf{F}_{E} = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{E} \\, \\mathrm{d}S = \\int_{V} (\\nabla \\times \\mathbf{E}) \\, \\mathrm{d}V $$\n由于 $\\mathbf{E}$ 是均匀的，所以在体积 $V$ 内处处有 $\\nabla \\times \\mathbf{E} = \\mathbf{0}$。因此，该积分变为：\n$$ \\mathbf{F}_{E} = \\int_{V} \\mathbf{0} \\, \\mathrm{d}V = \\mathbf{0} $$\n因此，矢量 $\\mathbf{F}_{E}$ 是零矢量 $(0,0,0)$，单位为伏特-米。\n\n对于 $\\mathbf{F}_{H}$：\n同样的逻辑也适用。其定义为 $\\mathbf{F}_{H} \\equiv \\sum_{f\\in \\partial V}\\int_{f}\\mathbf{n}_{f}\\times \\mathbf{H}\\, \\mathrm{d}S$。应用矢量积分恒等式：\n$$ \\mathbf{F}_{H} = \\oint_{\\partial V} \\mathbf{n} \\times \\mathbf{H} \\, \\mathrm{d}S = \\int_{V} (\\nabla \\times \\mathbf{H}) \\, \\mathrm{d}V $$\n由于 $\\mathbf{H}$ 是均匀的，所以在体积 $V$ 内处处有 $\\nabla \\times \\mathbf{H} = \\mathbf{0}$。因此：\n$$ \\mathbf{F}_{H} = \\int_{V} \\mathbf{0} \\, \\mathrm{d}V = \\mathbf{0} $$\n因此，矢量 $\\mathbf{F}_{H}$ 也是零矢量 $(0,0,0)$，单位为安培-米。\n\n接下来，我们计算单元平均通量密度的瞬时时间导数 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ 和 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$。这体现了时域有限体积法（FVTD）的核心原理，即将单元平均场的时间演化与穿过单元边界的通量联系起来。\n\n对于 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$：\n我们首先将法拉第定律 $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$ 在控制体 $V$ 上积分：\n$$ \\int_{V} (\\nabla \\times \\mathbf{E}) \\, \\mathrm{d}V = - \\int_{V} \\frac{\\partial \\mathbf{B}}{\\partial t} \\, \\mathrm{d}V $$\n左侧根据定义即为 $\\mathbf{F}_{E}$。对于右侧，由于体积 $V$ 不随时间变化，时间导数可以移到积分符号外：\n$$ - \\int_{V} \\frac{\\partial \\mathbf{B}}{\\partial t} \\, \\mathrm{d}V = - \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} \\mathbf{B} \\, \\mathrm{d}V $$\n单元平均磁通量密度为 $\\langle \\mathbf{B} \\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{B}\\,\\mathrm{d}V$，所以 $\\int_{V}\\mathbf{B}\\,\\mathrm{d}V = V\\langle \\mathbf{B} \\rangle$。将其代入：\n$$ - \\frac{\\mathrm{d}}{\\mathrm{d}t} (V\\langle \\mathbf{B} \\rangle) = -V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle $$\n将积分后的法拉第定律的变换后的左右两侧相等，得到半离散 FVTD 更新方程：\n$$ \\mathbf{F}_{E} = -V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle $$\n我们已经确定了 $\\mathbf{F}_{E} = \\mathbf{0}$。由于体积 $V = \\Delta^3$ 是非零的，我们必然有：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B} \\rangle = \\mathbf{0} $$\n该矢量的分量为 $(0,0,0)$，单位为特斯拉每秒。\n\n对于 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$：\n对于安培-麦克斯韦定律 $\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}$（因为 $\\mathbf{J}=\\mathbf{0}$），我们遵循一个类似的过程。在体积 $V$ 上积分：\n$$ \\int_{V} (\\nabla \\times \\mathbf{H}) \\, \\mathrm{d}V = \\int_{V} \\frac{\\partial \\mathbf{D}}{\\partial t} \\, \\mathrm{d}V $$\n左侧根据定义即为 $\\mathbf{F}_{H}$。右侧也进行类似变换：\n$$ \\int_{V} \\frac{\\partial \\mathbf{D}}{\\partial t} \\, \\mathrm{d}V = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V} \\mathbf{D} \\, \\mathrm{d}V = V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle $$\n其中 $\\langle \\mathbf{D} \\rangle \\equiv \\frac{1}{V}\\int_{V}\\mathbf{D}\\,\\mathrm{d}V$。这给出了第二个 FVTD 更新方程：\n$$ \\mathbf{F}_{H} = V \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle $$\n我们已经确定了 $\\mathbf{F}_{H} = \\mathbf{0}$。因此：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D} \\rangle = \\mathbf{0} $$\n该矢量的分量为 $(0,0,0)$，单位为库仑每平方米秒。\n\n总之，在给定瞬间，场 $\\mathbf{E}$ 和 $\\mathbf{H}$ 的空间均匀性意味着它们的旋度为零。这立即得出结论：表面通量积分 $\\mathbf{F}_{E}$ 和 $\\mathbf{F}_{H}$ 均为零。通过麦克斯韦方程组的积分形式，这又意味着相应的单元平均通量密度 $\\langle \\mathbf{B} \\rangle$ 和 $\\langle \\mathbf{D} \\rangle$ 的时间导数在该瞬间也为零。\n\n最终答案是一个行矩阵，依次包含 $\\mathbf{F}_E$、$\\mathbf{F}_H$、$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{B}\\rangle$ 和 $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle \\mathbf{D}\\rangle$ 的 $x, y, z$ 分量。所有 12 个分量都为零。\n$$ [F_{E,x}, F_{E,y}, F_{E,z}] = [0, 0, 0] $$\n$$ [F_{H,x}, F_{H,y}, F_{H,z}] = [0, 0, 0] $$\n$$ [\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{x}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{y}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle B\\rangle\\right)_{z}] = [0, 0, 0] $$\n$$ [\\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{x}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{y}, \\left(\\frac{\\mathrm{d}}{\\mathrm{d}t}\\langle D\\rangle\\right)_{z}] = [0, 0, 0] $$\n得到的行矩阵完全由零组成。", "answer": "$$ \\boxed{\n\\begin{pmatrix}\n0  & 0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0 &  0\n\\end{pmatrix}\n} $$", "id": "3307958"}, {"introduction": "实际的电磁仿真常常涉及不同材料之间的界面，场在这些界面上可能是不连续的。一个稳健的数值格式必须能正确处理波在这些界面上的反射和透射。这个实践 [@problem_id:3307955] 通过构建一个一维黎曼问题来深入探讨这一挑战，要求您计算作为现代FVTD方法基石的“Godunov通量”——即界面上的精确解。", "problem": "考虑在一个具有平面分界面 $x=0$ 的非均匀、无损耗、无源介质中，麦克斯韦方程组的一维横电 (TE) 配置。两种材料各占据一个半空间：介质 $1$ 位于 $x<0$ 区域，其介电常数为 $\\epsilon_1$，磁导率为 $\\mu_1$；介质 $2$ 位于 $x>0$ 区域，其介电常数为 $\\epsilon_2$，磁导率为 $\\mu_2$。切向场分量为 $E_y(x,t)$ 和 $H_z(x,t)$。控制方程为简化到一维的麦克斯韦旋度方程，\n$$\n\\frac{\\partial D_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0, \n\\qquad\n\\frac{\\partial B_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0,\n$$\n以及本构关系 $D_y=\\epsilon(x) E_y$ 和 $B_z=\\mu(x) H_z$，其中当 $x<0$ 时 $\\epsilon(x)=\\epsilon_1$，当 $x>0$ 时 $\\epsilon(x)=\\epsilon_2$，$\\mu(x)$ 的情况也类似。假设在 $x=0$ 处没有自由表面电流或电荷，因此切向场在分界面上是连续的。\n\n在有限体积时域方法中，可以对守恒变量 $\\boldsymbol{Q}=(D_y, B_z)^{\\top}$ 和通量 $\\boldsymbol{F}(\\boldsymbol{Q})=(H_z, E_y)^{\\top}$，将方程组写成守恒形式，并使用 $x=0$ 处的精确界面黎曼解来定义戈杜诺夫 (Godunov) 数值通量 $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$。\n\n假设左侧介质的参数为 $\\epsilon_1=\\epsilon_0$、$\\mu_1=\\mu_0$，右侧介质的参数为 $\\epsilon_2=4\\epsilon_0$、$\\mu_2=\\mu_0$。设 $t=0^+$ 时的初始数据为：一个从左侧入射的右行平面波，在介质 $1$ 中形成左态 $(E_y,H_z)=(1, 1/Z_1)$；以及在介质 $2$ 中形成静止的右态 $(E_y,H_z)=(0,0)$。其中，波阻抗为 $Z_i=\\sqrt{\\mu_i/\\epsilon_i}$ 且 $Z_0=\\sqrt{\\mu_0/\\epsilon_0}$。\n\n从麦克斯韦方程组和切向场的界面连续性条件出发，用适用于每种介质的特征变量来推导精确的界面黎曼解，并由此确定：\n- 在 $x=0$ 处的戈杜诺夫 (Godunov) 数值通量 $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$，以及\n- 透射到介质 $2$ 中的电场振幅 $E_y$。\n\n将最终答案表示为一个单行向量，其各项依次为 $H_z^{\\ast}$、$E_y^{\\ast}$ 和透射电场 $E_y$ 的振幅，并以包含 $Z_0$ 的闭式解析表达式给出。不要代入 $Z_0$ 的数值。最终答案中不要附加单位；默认第一项的单位是 $H_z$ 的单位，第二和第三项的单位是 $E_y$ 的单位。无需进行舍入。", "solution": "该问题要求确定两种介电介质平面分界面上的戈杜诺夫 (Godunov) 数值通量和透射电场振幅。这是一个针对线性双曲型方程组（即一维麦克斯韦方程组）的经典黎曼问题。\n\n在均匀介质 $i$（介电常数为 $\\epsilon_i$，磁导率为 $\\mu_i$）中，控制方程为：\n$$\n\\epsilon_i \\frac{\\partial E_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0\n$$\n$$\n\\mu_i \\frac{\\partial H_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0\n$$\n该方程组可以写成矩阵形式 $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A}_i \\frac{\\partial \\boldsymbol{U}}{\\partial x} = \\boldsymbol{0}$，其中 $\\boldsymbol{U} = (E_y, H_z)^{\\top}$，系统矩阵为 $\\boldsymbol{A}_i = \\begin{pmatrix} 0  & 1/\\epsilon_i \\\\ 1/\\mu_i &  0 \\end{pmatrix}$。\n\n为了求解黎曼问题，我们进行特征分析。$\\boldsymbol{A}_i$ 的特征值可通过求解 $\\det(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\lambda^2 - 1/(\\epsilon_i\\mu_i) = 0$ 得到，这给出了特征速度 $\\lambda = \\pm v_i$，其中 $v_i = 1/\\sqrt{\\epsilon_i\\mu_i}$ 是光在介质 $i$ 中的速度。\n\n相应的左特征向量 $\\boldsymbol{l}$ 可通过求解 $\\boldsymbol{l}^{\\top}(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\boldsymbol{0}$ 得到。\n对于 $\\lambda = +v_i$：$\\boldsymbol{l}_1^{\\top} = (1, Z_i)$，其中 $Z_i = \\sqrt{\\mu_i/\\epsilon_i}$ 是介质 $i$ 的波阻抗。\n对于 $\\lambda = -v_i$：$\\boldsymbol{l}_2^{\\top} = (1, -Z_i)$。\n\n特征变量（或黎曼不变量）是通过将左特征向量与状态向量 $\\boldsymbol{U}$ 进行点积得到的。\n1. 量 $w_1 = \\boldsymbol{l}_1^{\\top}\\boldsymbol{U} = E_y + Z_i H_z$ 沿着向左传播的特征线（即斜率为 $dx/dt = -v_i$ 的线）保持不变。\n2. 量 $w_2 = \\boldsymbol{l}_2^{\\top}\\boldsymbol{U} = E_y - Z_i H_z$ 沿着向右传播的特征线（即斜率为 $dx/dt = +v_i$ 的线）保持不变。\n\n初始条件指定了在 $t=0$ 时刻 $x=0$ 处的一个间断，它将介质 $1$ 中的左态 $(E_{y,L}, H_{z,L})$ 与介质 $2$ 中的右态 $(E_{y,R}, H_{z,R})$ 分开。对于 $t>0$，在分界面 $x=0$ 处的解是一个常数状态，即所谓的星区状态，$(E_y^{\\ast}, H_z^{\\ast})$。此状态是分界面上黎曼问题的解，并为戈杜诺夫 (Godunov) 通量 $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$ 提供了数值。\n\n这个星区状态必须通过从分界面传播开的波与初始状态相连接。\n- 星区状态 $(E_y^{\\ast}, H_z^{\\ast})$ 通过介质 $1$ 中的一个左行波与左态 $(E_{y,L}, H_{z,L})$ 相连接。跨过此波，特征变量 $E_y + Z_1 H_z$ 是守恒的。\n$$ E_y^{\\ast} + Z_1 H_z^{\\ast} = E_{y,L} + Z_1 H_{z,L} $$\n- 星区状态 $(E_y^{\\ast}, H_z^{\\ast})$ 通过介质 $2$ 中的一个右行波与右态 $(E_{y,R}, H_{z,R})$ 相连接。跨过此波，特征变量 $E_y - Z_2 H_z$ 是守恒的。\n$$ E_y^{\\ast} - Z_2 H_z^{\\ast} = E_{y,R} - Z_2 H_{z,R} $$\n\n我们现在代入问题中给出的具体参数。\n对于介质 $1$ ($x<0$)：$\\epsilon_1 = \\epsilon_0$，$\\mu_1 = \\mu_0$。波阻抗为 $Z_1 = \\sqrt{\\mu_1/\\epsilon_1} = \\sqrt{\\mu_0/\\epsilon_0} = Z_0$。\n对于介质 $2$ ($x>0$)：$\\epsilon_2 = 4\\epsilon_0$，$\\mu_2 = \\mu_0$。波阻抗为 $Z_2 = \\sqrt{\\mu_2/\\epsilon_2} = \\sqrt{\\mu_0/(4\\epsilon_0)} = \\frac{1}{2}\\sqrt{\\mu_0/\\epsilon_0} = \\frac{1}{2}Z_0$。\n\n初始状态为：\n- 左态 $(L)$：一个 $E_y=1$ 的右行波。对于这样的波，$H_z = E_y/Z_1$。所以，$(E_{y,L}, H_{z,L}) = (1, 1/Z_1) = (1, 1/Z_0)$。\n- 右态 $(R)$：静止介质。$(E_{y,R}, H_{z,R}) = (0, 0)$。\n\n将这些代入特征变量的两个守恒方程中：\n根据介质 $1$ 中的左行波：\n$$ E_y^{\\ast} + Z_0 H_z^{\\ast} = 1 + Z_0 \\left(\\frac{1}{Z_0}\\right) = 1+1=2 $$\n根据介质 $2$ 中的右行波：\n$$ E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0 - \\frac{1}{2}Z_0(0) = 0 $$\n\n我们得到一个关于 $E_y^{\\ast}$ 和 $H_z^{\\ast}$ 的二元线性方程组：\n1. $E_y^{\\ast} + Z_0 H_z^{\\ast} = 2$\n2. $E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0$\n\n从方程 $(2)$，我们得到 $E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast}$。\n将此代入方程 $(1)$：\n$$ \\left(\\frac{1}{2}Z_0 H_z^{\\ast}\\right) + Z_0 H_z^{\\ast} = 2 $$\n$$ \\frac{3}{2}Z_0 H_z^{\\ast} = 2 $$\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n\n现在，我们求解 $E_y^{\\ast}$：\n$$ E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast} = \\frac{1}{2}Z_0 \\left(\\frac{4}{3Z_0}\\right) = \\frac{4}{6} = \\frac{2}{3} $$\n\n分界面上的戈杜诺夫 (Godunov) 数值通量为 $\\boldsymbol{F}^{\\ast} = (H_z^{\\ast}, E_y^{\\ast})^{\\top}$。其分量为：\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n$$ E_y^{\\ast} = \\frac{2}{3} $$\n\n最后需要确定的是透射到介质 $2$ 中的电场振幅。透射到介质 $2$ 中的波是连接初始右态 $(0,0)$ 与星区状态 $(E_y^{\\ast}, H_z^{\\ast})$ 的右行波。在 $0 < x < v_2 t$ 区域内的场是恒定的，等于 $(E_y^{\\ast}, H_z^{\\ast})$。因此，透射电场的振幅恰好是 $E_y^{\\ast}$。\n$$ E_{y, \\text{transmitted}} = E_y^{\\ast} = \\frac{2}{3} $$\n\n问题要求将三个值（$H_z^{\\ast}$、$E_y^{\\ast}$ 和透射电场 $E_y$ 的振幅）表示为一个单行向量。它们依次是：$\\frac{4}{3Z_0}$、$\\frac{2}{3}$ 和 $\\frac{2}{3}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4}{3Z_0} & \\frac{2}{3} & \\frac{2}{3} \\end{pmatrix}}\n$$", "id": "3307955"}, {"introduction": "虽然数值格式可以近似连续方程，但它们可能累积误差，从而违反基本的物理定律，例如磁场的无散度条件（$\\nabla \\cdot \\mathbf{B} = 0$）。这个高级练习 [@problem_id:3307998] 介绍了一种强大的技术，称为双曲散度清理，以纠正此问题。您将探索如何增广麦克斯韦方程组，以创建一个能够主动传输和耗散这些数值散度误差的系统，从而确保仿真的物理保真度。", "problem": "一个在所有空间方向上间距均为 $\\Delta$ 的均匀笛卡尔网格被用于通过有限体积时域 (FVTD) 方法求解真空中的麦克斯韦方程组。假设磁感应场初始无散，即 $\\nabla \\cdot \\mathbf{B} = 0$，但允许在之后的时刻因截断而引入微小的散度误差。为构建一个在有限体积框架下与守恒律兼容的最小散度清理步骤，考虑通过广义拉格朗日乘子 (GLM) 双曲清理方法，使用一个标量清理场 $\\psi$ 来增广法拉第定律。\n\n从真空中的微分形式麦克斯韦方程组出发，通过将标量场 $\\psi$ 的梯度添加到法拉第定律中来增广该系统，并为 $\\psi$ 指定一个带有两个正常数 $c_{h}$（一个特征双曲清理速度）和 $c_{p}$（一个量纲为时间倒数的抛物阻尼参数）的弛豫方程。在连续极限下，推导控制散度误差 $D \\equiv \\nabla \\cdot \\mathbf{B}$ 的闭合演化方程，并求出对于波数大小为 $k = |\\mathbf{k}|$ 的傅里叶模式 $D(\\mathbf{x},t) \\propto \\exp(s t + i \\mathbf{k}\\cdot \\mathbf{x})$ 的色散关系 $s = s(\\mathbf{k})$。\n\n通过要求可分辨的最高网格模式 $k_{\\max} = \\pi/\\Delta$ 达到临界阻尼，来定义一个“最小”参数选择，使得该模式的散度误差在不振荡的情况下以最快速度衰减。在此临界阻尼选择下，对于模式 $k_{\\max}$ 的散度误差幅值的渐近指数衰减率（即 $s$ 的实部）是多少？以一个用 $c_{h}$ 和 $\\Delta$ 表示的单一闭合形式符号表达式给出你的最终答案。在最终的方框答案中不要包含单位。", "solution": "该问题要求在使用广义拉格朗日乘子 (GLM) 双曲清理方法的有限体积时域 (FVTD) 格式中，推导散度误差的渐近指数衰减率。我们首先将所描述的方程组形式化。\n\n标准的真空中麦克斯韦方程组被修改。具体来说，法拉第电磁感应定律被一个标量清理场 $\\psi$ 的梯度所增广：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} + \\nabla \\times \\mathbf{E} = -\\nabla \\psi\n$$\n引入一个关于 $\\psi$ 的弛豫方程，根据问题描述和量纲一致性，该方程具有阻尼波动方程源项的形式。令 $c_h$ 为双曲清理速度，$c_p$ 为抛物阻尼率（量纲为时间倒数）。与这些定义以及标准 GLM 公式相符的 $\\psi$ 方程是：\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 (\\nabla \\cdot \\mathbf{B}) = -c_p \\psi\n$$\n散度误差定义为 $D \\equiv \\nabla \\cdot \\mathbf{B}$。我们的目标是推导一个关于 $D$ 的闭合演化方程。\n\n首先，我们对增广的法拉第定律取散度。假设场足够光滑，可以交换空间和时间导数，我们得到：\n$$\n\\nabla \\cdot \\left( \\frac{\\partial \\mathbf{B}}{\\partial t} \\right) + \\nabla \\cdot (\\nabla \\times \\mathbf{E}) = -\\nabla \\cdot (\\nabla \\psi)\n$$\n旋度的散度恒为零（$\\nabla \\cdot (\\nabla \\times \\mathbf{E}) = 0$）。这得到：\n$$\n\\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{B}) = -\\nabla^2 \\psi\n$$\n用散度误差 $D$ 表示，这是我们的第一个控制方程：\n$$\n\\frac{\\partial D}{\\partial t} = -\\nabla^2 \\psi \\quad (\\text{Eq. } 1)\n$$\n$\\psi$ 的弛豫方程可以用 $D$ 表示为：\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 D = -c_p \\psi \\quad (\\text{Eq. } 2)\n$$\n我们现在得到了一个关于 $D$ 和 $\\psi$ 的耦合线性偏微分方程组。为了得到一个关于 $D$ 的单一闭合方程，我们可以消去 $\\psi$。我们将方程 $1$ 对时间 $t$ 求导：\n$$\n\\frac{\\partial^2 D}{\\partial t^2} = -\\nabla^2 \\left( \\frac{\\partial \\psi}{\\partial t} \\right)\n$$\n从方程 2，我们可以将 $\\frac{\\partial \\psi}{\\partial t}$ 表示为 $\\frac{\\partial \\psi}{\\partial t} = -c_h^2 D - c_p \\psi$。将其代入前一个方程得到：\n$$\n\\frac{\\partial^2 D}{\\partial t^2} = -\\nabla^2 (-c_h^2 D - c_p \\psi) = c_h^2 \\nabla^2 D + c_p \\nabla^2 \\psi\n$$\n现在，我们可以使用方程 1 来代换 $\\nabla^2 \\psi$：$\\nabla^2 \\psi = -\\frac{\\partial D}{\\partial t}$。这会得到：\n$$\n\\frac{\\partial^2 D}{\\partial t^2} = c_h^2 \\nabla^2 D + c_p \\left( -\\frac{\\partial D}{\\partial t} \\right)\n$$\n重新整理各项，我们得到关于散度误差 $D$ 的闭合演化方程：\n$$\n\\frac{\\partial^2 D}{\\partial t^2} + c_p \\frac{\\partial D}{\\partial t} - c_h^2 \\nabla^2 D = 0\n$$\n这是一个阻尼波动方程，其中 $c_h$ 是散度波的传播速度，$c_p$ 是阻尼系数。\n\n接下来，我们通过考虑一个形如 $D(\\mathbf{x}, t) = \\hat{D} \\exp(s t + i \\mathbf{k} \\cdot \\mathbf{x})$ 的傅里叶模式来推导色散关系，其中 $\\hat{D}$ 是一个常数，$s$ 是复频率，$\\mathbf{k}$ 是波矢。其导数为：\n$$\n\\frac{\\partial D}{\\partial t} = s D, \\quad \\frac{\\partial^2 D}{\\partial t^2} = s^2 D, \\quad \\nabla^2 D = -|\\mathbf{k}|^2 D = -k^2 D\n$$\n将这些代入 $D$ 的演化方程：\n$$\ns^2 D + c_p (s D) - c_h^2 (-k^2 D) = 0\n$$\n两边同除以 $D$（对于非平凡模式，$D$ 不为零），得到特征方程，即色散关系：\n$$\ns^2 + c_p s + c_h^2 k^2 = 0\n$$\n这是一个关于 $s$ 的二次方程。其根由二次求根公式给出：\n$$\ns(k) = \\frac{-c_p \\pm \\sqrt{c_p^2 - 4 c_h^2 k^2}}{2}\n$$\n问题指定了一个基于可分辨最高网格模式的临界阻尼的“最小”参数选择。在间距为 $\\Delta$ 的均匀笛卡尔网格上，最高可分辨波数（奈奎斯特波数）为：\n$$\nk_{\\max} = \\frac{\\pi}{\\Delta}\n$$\n当关于 $s$ 的二次方程的判别式为零时，发生临界阻尼。这确保了该模式在不振荡的情况下以最快速度衰减。我们将 $k = k_{\\max}$ 时的判别式设为零：\n$$\nc_p^2 - 4 c_h^2 k_{\\max}^2 = 0\n$$\n解出 $c_p$（因为 $c_p$ 和 $c_h$ 是正常数）：\n$$\nc_p = 2 c_h k_{\\max} = 2 c_h \\frac{\\pi}{\\Delta}\n$$\n对于指定的临界阻尼条件，此方程以清理速度 $c_h$ 和网格间距 $\\Delta$ 的形式确定了阻尼参数 $c_p$。\n\n最后，我们需要找到在此条件下，模式 $k_{\\max}$ 的渐近指数衰减率，即 $s$ 的实部。对于任何临界阻尼模式，$s$ 的解是特征方程的唯一重根，这在判别式为零时出现。这个根的值是：\n$$\ns = \\frac{-c_p}{2}\n$$\n我们代入刚从临界阻尼条件推导出的 $c_p$ 表达式：\n$$\ns = -\\frac{1}{2} \\left( 2 c_h \\frac{\\pi}{\\Delta} \\right) = -\\frac{\\pi c_h}{\\Delta}\n$$\n这个 $s$ 的值是纯实数。问题要求的是 $s$ 的实部，因此就是这个值本身。这就是在临界阻尼条件下，可分辨最高模式的散度误差幅值的指数衰减率。", "answer": "$$\\boxed{-\\frac{\\pi c_h}{\\Delta}}$$", "id": "3307998"}]}