{"hands_on_practices": [{"introduction": "规范自由度的概念初看起来可能有些抽象。本练习旨在将其具体化。我们将看到，即使对于一个简单的均匀静态磁场，也存在多种描述它的矢量势。通过亲手构造两个满足库仑规范但具有不同对称性的矢量势 [@problem_id:3310127]，并找出连接它们的规范函数，我们可以直观地理解不同的数学形式如何描述完全相同的物理现实。", "problem": "一个静态、空间均匀的磁场由 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$ 给出，其中 $B_{0}$ 是一个常数。在国际单位制 (SI) 中，电磁场可以用标量势和矢量势 $(\\phi,\\mathbf{A})$ 来表示，它们满足关系式 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 和 $\\mathbf{E} = -\\nabla \\phi - \\partial \\mathbf{A}/\\partial t$。势的规范变换通过引入一个标量规范函数 $\\chi$ 来定义，使得 $\\mathbf{A}' = \\mathbf{A} + \\nabla \\chi$ 和 $\\phi' = \\phi - \\partial \\chi/\\partial t$，同时保持物理场 $\\mathbf{E}$ 和 $\\mathbf{B}$ 不变。\n\n从这些基本定义出发，完成以下任务：\n\n1. 施加库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$，并为 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$ 构造一个矢量势 $\\mathbf{A}_{\\mathrm{sym}}(\\mathbf{r})$，该矢量势是空间坐标的线性函数，并表现出绕 $\\hat{\\mathbf{z}}$ 轴的旋转对称性。\n\n2. 在相同的库仑规范下，为 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$ 构造第二个矢量势 $\\mathbf{A}_{\\mathrm{tran}}(\\mathbf{r})$，该矢量势沿 $\\hat{\\mathbf{x}}$ 轴具有平移不变性，其分量不依赖于 $x$ 或 $z$，仅依赖于 $y$。\n\n3. 使用规范变换关系，确定将 $\\mathbf{A}_{\\mathrm{sym}}$ 变换为 $\\mathbf{A}_{\\mathrm{tran}}$ 的标量规范函数 $\\chi(x,y,z)$，并验证此规范函数保持库仑规范，即在 $\\nabla \\cdot \\mathbf{A}_{\\mathrm{sym}} = 0$ 的条件下，有 $\\nabla \\cdot \\mathbf{A}_{\\mathrm{tran}} = 0$。\n\n假设全过程不依赖于时间（静态场），因此 $\\partial \\chi/\\partial t = 0$ 且 $\\phi$ 可取为常数。将你的最终答案表示为标量规范函数 $\\chi(x,y,z)$ 的显式解析表达式。最终表达式中无需进行数值取整，也无需报告单位。", "solution": "该问题要求为一均匀磁场构造两个不同的矢量势，并确定将一个矢量势变换为另一个的标量规范函数。该过程如问题陈述中所述，分为三个部分。\n\n磁场 $\\mathbf{B}$ 和磁矢量势 $\\mathbf{A}$ 之间的基本关系由 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 给出。场被假设为静态的，因此所有对时间的导数都为零。\n\n给定的磁场为 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$，其中 $B_{0}$ 是一个常数。在笛卡尔坐标系中，这意味着我们必须找到一个矢量势 $\\mathbf{A}(x,y,z) = A_{x}\\hat{\\mathbf{x}} + A_{y}\\hat{\\mathbf{y}} + A_{z}\\hat{\\mathbf{z}}$，使其旋度为 $\\mathbf{B}$：\n$$ \\nabla \\times \\mathbf{A} = \\left(\\frac{\\partial A_z}{\\partial y} - \\frac{\\partial A_y}{\\partial z}\\right)\\hat{\\mathbf{x}} + \\left(\\frac{\\partial A_x}{\\partial z} - \\frac{\\partial A_z}{\\partial x}\\right)\\hat{\\mathbf{y}} + \\left(\\frac{\\partial A_y}{\\partial x} - \\frac{\\partial A_x}{\\partial y}\\right)\\hat{\\mathbf{z}} = B_{0}\\hat{\\mathbf{z}} $$\n这意味着以下分量方程：\n$$(1) \\quad \\frac{\\partial A_z}{\\partial y} - \\frac{\\partial A_y}{\\partial z} = 0$$\n$$(2) \\quad \\frac{\\partial A_x}{\\partial z} - \\frac{\\partial A_z}{\\partial x} = 0$$\n$$(3) \\quad \\frac{\\partial A_y}{\\partial x} - \\frac{\\partial A_x}{\\partial y} = B_{0}$$\n\n**第一部分：对称矢量势 $\\mathbf{A}_{\\mathrm{sym}}$ 的构造**\n\n我们需要找到一个满足库仑规范条件 $\\nabla \\cdot \\mathbf{A}_{\\mathrm{sym}} = 0$ 的矢量势 $\\mathbf{A}_{\\mathrm{sym}}$，它对空间坐标 $(x,y,z)$ 是线性的，并表现出绕 $\\hat{\\mathbf{z}}$ 轴的旋转对称性。\n\n绕 $\\hat{\\mathbf{z}}$ 轴的旋转对称性条件暗示了 $\\mathbf{A}$ 的形式应与 $\\mathbf{r} \\times \\hat{\\mathbf{z}} = (x\\hat{\\mathbf{x}} + y\\hat{\\mathbf{y}}) \\times \\hat{\\mathbf{z}} = y\\hat{\\mathbf{x}} - x\\hat{\\mathbf{y}}$ 成正比。让我们提出一个形式为 $\\mathbf{A}_{\\mathrm{sym}} = C(y\\hat{\\mathbf{x}} - x\\hat{\\mathbf{y}})$ 的试探解，其中 $C$ 为某个常数。该形式是坐标的线性函数。\n\n让我们检查这个试探解的旋度：\n$$ \\nabla \\times \\mathbf{A}_{\\mathrm{sym}} = \\nabla \\times (C y\\hat{\\mathbf{x}} - C x\\hat{\\mathbf{y}}) = \\hat{\\mathbf{z}}\\left(\\frac{\\partial(-Cx)}{\\partial x} - \\frac{\\partial(Cy)}{\\partial y}\\right) = \\hat{\\mathbf{z}}(-C - C) = -2C\\hat{\\mathbf{z}} $$\n为了匹配给定的磁场 $\\mathbf{B} = B_{0}\\hat{\\mathbf{z}}$，我们必须有 $-2C = B_{0}$，这给出 $C = -B_{0}/2$。\n\n因此，矢量势为 $\\mathbf{A}_{\\mathrm{sym}} = -\\frac{B_{0}}{2}(y\\hat{\\mathbf{x}} - x\\hat{\\mathbf{y}}) = \\frac{B_{0}}{2}(-y\\hat{\\mathbf{x}} + x\\hat{\\mathbf{y}})$。\n让我们验证它是否满足库仑规范条件 $\\nabla \\cdot \\mathbf{A}_{\\mathrm{sym}} = 0$：\n$$ \\nabla \\cdot \\mathbf{A}_{\\mathrm{sym}} = \\frac{\\partial}{\\partial x}\\left(-\\frac{B_{0}}{2}y\\right) + \\frac{\\partial}{\\partial y}\\left(\\frac{B_{0}}{2}x\\right) + \\frac{\\partial}{\\partial z}(0) = 0 + 0 + 0 = 0 $$\n条件得到满足。所以，对称矢量势为：\n$$ \\mathbf{A}_{\\mathrm{sym}} = \\frac{B_{0}}{2}(-y\\hat{\\mathbf{x}} + x\\hat{\\mathbf{y}}) $$\n\n**第二部分：平移不变矢量势 $\\mathbf{A}_{\\mathrm{tran}}$ 的构造**\n\n接下来，我们寻找一个不同的矢量势 $\\mathbf{A}_{\\mathrm{tran}}$，它也满足库仑规范（$\\nabla \\cdot \\mathbf{A}_{\\mathrm{tran}} = 0$），但具有不同的对称性质：它必须沿 $\\hat{\\mathbf{x}}$ 轴平移不变，并且其分量只依赖于坐标 $y$。\n\n这些约束意味着 $\\mathbf{A}_{\\mathrm{tran}} = \\mathbf{A}_{\\mathrm{tran}}(y)$，即 $\\partial \\mathbf{A}_{\\mathrm{tran}}/\\partial x = 0$ 和 $\\partial \\mathbf{A}_{\\mathrm{tran}}/\\partial z = 0$。让我们将 $\\mathbf{A}_{\\mathrm{tran}}(y)$ 写为 $A_{x}(y)\\hat{\\mathbf{x}} + A_{y}(y)\\hat{\\mathbf{y}} + A_{z}(y)\\hat{\\mathbf{z}}$。\n\n库仑规范条件 $\\nabla \\cdot \\mathbf{A}_{\\mathrm{tran}} = 0$ 变为：\n$$ \\frac{\\partial A_x}{\\partial x} + \\frac{\\partial A_y}{\\partial y} + \\frac{\\partial A_z}{\\partial z} = 0 + \\frac{d A_y}{d y} + 0 = 0 $$\n这意味着 $A_y(y)$ 是一个常数。通过一个简单的减去一个常矢量势的操作（这是一种规范变换），我们可以将这个常数设为零，因此 $A_{y} = 0$。\n\n现在我们应用旋度条件 $\\nabla \\times \\mathbf{A}_{\\mathrm{tran}} = B_{0}\\hat{\\mathbf{z}}$：\n根据方程(1)：$\\frac{d A_z}{d y} - \\frac{\\partial A_y}{\\partial z} = \\frac{d A_z}{d y} - 0 = 0$，这意味着 $A_z(y)$ 也是一个常数。我们可以将这个常数设为零，所以 $A_{z} = 0$。\n根据方程(2)：$\\frac{\\partial A_x}{\\partial z} - \\frac{\\partial A_z}{\\partial x} = 0 - 0 = 0$。此方程得到满足。\n根据方程(3)：$\\frac{\\partial A_y}{\\partial x} - \\frac{\\partial A_x}{\\partial y} = 0 - \\frac{d A_x}{d y} = B_{0}$。这给出 $\\frac{d A_x}{d y} = -B_{0}$。\n\n对 $y$ 积分，我们得到 $A_{x}(y) = -B_{0}y + K$，其中 $K$ 是一个积分常数。在一个势分量上增加一个常数不会改变磁场，所以为简单起见，我们可以选择 $K=0$。\n\n因此，平移不变矢量势为：\n$$ \\mathbf{A}_{\\mathrm{tran}} = -B_{0}y \\hat{\\mathbf{x}} $$\n\n**第三部分：标量规范函数 $\\chi$ 的确定**\n\n这两个矢量势 $\\mathbf{A}_{\\mathrm{sym}}$ 和 $\\mathbf{A}_{\\mathrm{tran}}$ 描述的是同一个磁场，它们通过一个规范变换相关联。这意味着存在一个标量函数 $\\chi(x,y,z)$，使得 $\\mathbf{A}_{\\mathrm{tran}} = \\mathbf{A}_{\\mathrm{sym}} + \\nabla\\chi$。我们需要找到这个函数 $\\chi$。\n\n重排变换方程，我们得到 $\\nabla\\chi = \\mathbf{A}_{\\mathrm{tran}} - \\mathbf{A}_{\\mathrm{sym}}$。让我们计算这个差分矢量：\n$$ \\mathbf{A}_{\\mathrm{tran}} - \\mathbf{A}_{\\mathrm{sym}} = (-B_{0}y\\hat{\\mathbf{x}}) - \\left(\\frac{B_{0}}{2}(-y\\hat{\\mathbf{x}} + x\\hat{\\mathbf{y}})\\right) $$\n$$ \\mathbf{A}_{\\mathrm{tran}} - \\mathbf{A}_{\\mathrm{sym}} = \\left(-B_{0}y + \\frac{B_{0}}{2}y\\right)\\hat{\\mathbf{x}} + \\left(0 - \\frac{B_{0}}{2}x\\right)\\hat{\\mathbf{y}} = -\\frac{B_{0}}{2}y\\hat{\\mathbf{x}} - \\frac{B_{0}}{2}x\\hat{\\mathbf{y}} $$\n所以，我们有 $\\nabla\\chi = \\frac{\\partial \\chi}{\\partial x}\\hat{\\mathbf{x}} + \\frac{\\partial \\chi}{\\partial y}\\hat{\\mathbf{y}} + \\frac{\\partial \\chi}{\\partial z}\\hat{\\mathbf{z}} = -\\frac{B_{0}}{2}y\\hat{\\mathbf{x}} - \\frac{B_{0}}{2}x\\hat{\\mathbf{y}}$。\n\n这给了我们 $\\chi$ 的偏导数：\n$$ \\frac{\\partial \\chi}{\\partial x} = -\\frac{B_{0}}{2}y $$\n$$ \\frac{\\partial \\chi}{\\partial y} = -\\frac{B_{0}}{2}x $$\n$$ \\frac{\\partial \\chi}{\\partial z} = 0 $$\n从第三个方程可知，$\\chi$ 不依赖于 $z$，所以 $\\chi = \\chi(x,y)$。\n将第一个方程对 $x$ 积分：\n$$ \\chi(x,y) = \\int \\left(-\\frac{B_{0}}{2}y\\right) dx = -\\frac{B_{0}}{2}xy + f(y) $$\n其中 $f(y)$ 是一个只依赖于 $y$ 的积分函数。\n\n为了找到 $f(y)$，我们将 $\\chi$ 的这个表达式对 $y$ 求导，并使其等于第二个偏导数方程：\n$$ \\frac{\\partial \\chi}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(-\\frac{B_{0}}{2}xy + f(y)\\right) = -\\frac{B_{0}}{2}x + \\frac{df}{dy} $$\n将此与 $\\frac{\\partial \\chi}{\\partial y} = -\\frac{B_{0}}{2}x$ 比较，我们发现 $\\frac{df}{dy} = 0$。这意味着 $f(y)$ 是一个常数，由于它不影响梯度 $\\nabla\\chi$，我们可以将其设为零。\n因此，所求的标量规范函数是：\n$$ \\chi(x,y,z) = -\\frac{B_{0}}{2}xy $$\n\n最后，我们必须验证这个规范变换保持库仑规范。从 $\\mathbf{A}$ 到 $\\mathbf{A}' = \\mathbf{A} + \\nabla\\chi$ 的规范变换保持库仑规范（$\\nabla \\cdot \\mathbf{A} = 0 \\implies \\nabla \\cdot \\mathbf{A}' = 0$）的充要条件是规范函数 $\\chi$ 满足拉普拉斯方程 $\\nabla^2\\chi=0$。\n让我们计算我们的函数 $\\chi$ 的拉普拉斯算子：\n$$ \\nabla^2\\chi = \\frac{\\partial^2 \\chi}{\\partial x^2} + \\frac{\\partial^2 \\chi}{\\partial y^2} + \\frac{\\partial^2 \\chi}{\\partial z^2} $$\n$$ \\frac{\\partial^2}{\\partial x^2}\\left(-\\frac{B_{0}}{2}xy\\right) = \\frac{\\partial}{\\partial x}\\left(-\\frac{B_{0}}{2}y\\right) = 0 $$\n$$ \\frac{\\partial^2}{\\partial y^2}\\left(-\\frac{B_{0}}{2}xy\\right) = \\frac{\\partial}{\\partial y}\\left(-\\frac{B_{0}}{2}x\\right) = 0 $$\n$$ \\frac{\\partial^2}{\\partial z^2}\\left(-\\frac{B_{0}}{2}xy\\right) = 0 $$\n所以，$\\nabla^2\\chi = 0+0+0 = 0$。条件得到满足，这证实了由于 $\\mathbf{A}_{\\mathrm{sym}}$ 处于库仑规范中，$\\mathbf{A}_{\\mathrm{tran}}$ 也必定如此。这与我们在第二部分中的独立验证是一致的。", "answer": "$$ \\boxed{-\\frac{B_{0}}{2}xy} $$", "id": "3310127"}, {"introduction": "在上一个练习的基础上，我们从被动观察规范自由度转向主动利用它来简化问题。本练习将演示如何精心构造一个时变规范变换，以达到特定的目的——在这里是消除标量势，从而进入时间规范（Temporal gauge）。这个过程凸显了规范变换在理论分析和数值计算中的强大实用性，因为它允许我们选择最便于求解的数学框架 [@problem_id:3310151]。", "problem": "在自由空间中，设光速 $c=1$ 以进行归一化，电场和磁场通过电磁势定义为 $ \\mathbf{E}(\\mathbf{x}, t) = -\\nabla \\phi(\\mathbf{x}, t) - \\partial_{t} \\mathbf{A}(\\mathbf{x}, t)$ 和 $\\mathbf{B}(\\mathbf{x}, t) = \\nabla \\times \\mathbf{A}(\\mathbf{x}, t)$。在不改变 $\\mathbf{E}$ 和 $\\mathbf{B}$ 的势的变换下，这些场是保持不变的。仅使用这些定义和这种不变性，推导由一个标量规范函数参数化的势的一般变换。然后，对于给定的标量势和在初始时刻 $t_{0}$ 的矢量势的指定散度，构造一个显式的规范函数，该函数使得变换后的标量势在所有后续时刻都为零，同时将变换后的矢量势在 $t_{0}$ 的散度设置为一个预定目标值。\n\n设 $\\mathbf{k} \\in \\mathbb{R}^{3}$ 且 $|\\mathbf{k}| \\neq 0$， $t_{0} \\in \\mathbb{R}$，以及常数 $\\Phi_{0}, \\lambda, F_{0}, G_{0} \\in \\mathbb{R}$ 且 $\\lambda > 0$。标量势为\n$$\n\\phi(\\mathbf{x}, t) = \\Phi_{0} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x}),\n$$\n在 $t_{0}$ 时刻矢量势的散度为\n$$\n\\nabla \\cdot \\mathbf{A}(\\mathbf{x}, t_{0}) = F_{0} \\sin(\\mathbf{k} \\cdot \\mathbf{x}).\n$$\n要求你构造一个标量规范函数 $\\chi(\\mathbf{x}, t)$，使得对于所有 $t$ 都有 $\\phi'(\\mathbf{x}, t) = 0$ 并且 $\\nabla \\cdot \\mathbf{A}'(\\mathbf{x}, t_{0}) = G_{0} \\cos(\\mathbf{k} \\cdot \\mathbf{x})$，其中带撇的量表示变换后的势。将最终的规范函数 $\\chi(\\mathbf{x}, t)$ 表示为单个闭式解析表达式。无需进行数值取整，最终表达式中也无需报告物理单位。", "solution": "问题要求完成两个任务：首先，推导电磁势 $\\phi$ 和 $\\mathbf{A}$ 的规范变换的一般形式；其次，构造一个特定的规范函数 $\\chi(\\mathbf{x}, t)$，该函数将一组给定的势进行变换以满足指定条件。\n\n首先，我们推导一般规范变换。电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 由标量势 $\\phi$ 和矢量势 $\\mathbf{A}$ 定义如下：\n$$\n\\mathbf{E}(\\mathbf{x}, t) = -\\nabla \\phi(\\mathbf{x}, t) - \\frac{\\partial \\mathbf{A}(\\mathbf{x}, t)}{\\partial t}\n$$\n$$\n\\mathbf{B}(\\mathbf{x}, t) = \\nabla \\times \\mathbf{A}(\\mathbf{x}, t)\n$$\n这里，我们使用归一化 $c=1$。规范变换是势的一种改变，比如从 $(\\phi, \\mathbf{A})$ 变为 $(\\phi', \\mathbf{A}')$，它使物理场 $\\mathbf{E}$ 和 $\\mathbf{B}$ 保持不变。设新势与旧势的关系如下：\n$$\n\\phi'(\\mathbf{x}, t) = \\phi(\\mathbf{x}, t) + \\delta \\phi(\\mathbf{x}, t)\n$$\n$$\n\\mathbf{A}'(\\mathbf{x}, t) = \\mathbf{A}(\\mathbf{x}, t) + \\delta \\mathbf{A}(\\mathbf{x}, t)\n$$\n磁场的不变性 $\\mathbf{B}' = \\mathbf{B}$ 要求：\n$$\n\\nabla \\times \\mathbf{A}' = \\nabla \\times \\mathbf{A} \\implies \\nabla \\times (\\mathbf{A} + \\delta \\mathbf{A}) = \\nabla \\times \\mathbf{A} \\implies \\nabla \\times \\delta \\mathbf{A} = \\mathbf{0}\n$$\n一个旋度为零的矢量场总可以表示为一个标量函数的梯度。我们引入一个标量规范函数 $\\chi(\\mathbf{x}, t)$，使得：\n$$\n\\delta \\mathbf{A}(\\mathbf{x}, t) = \\nabla \\chi(\\mathbf{x}, t)\n$$\n接下来，电场的不变性 $\\mathbf{E}' = \\mathbf{E}$ 要求：\n$$\n-\\nabla \\phi' - \\frac{\\partial \\mathbf{A}'}{\\partial t} = -\\nabla \\phi - \\frac{\\partial \\mathbf{A}}{\\partial t}\n$$\n代入变换后的势：\n$$\n-\\nabla (\\phi + \\delta \\phi) - \\frac{\\partial}{\\partial t}(\\mathbf{A} + \\delta \\mathbf{A}) = -\\nabla \\phi - \\frac{\\partial \\mathbf{A}}{\\partial t}\n$$\n这可化简为：\n$$\n-\\nabla(\\delta \\phi) - \\frac{\\partial(\\delta \\mathbf{A})}{\\partial t} = \\mathbf{0}\n$$\n现在，代入 $\\delta \\mathbf{A} = \\nabla \\chi$：\n$$\n-\\nabla(\\delta \\phi) - \\frac{\\partial}{\\partial t}(\\nabla \\chi) = \\mathbf{0} \\implies \\nabla\\left(\\delta \\phi + \\frac{\\partial \\chi}{\\partial t}\\right) = \\mathbf{0}\n$$\n这意味着量 $\\delta \\phi + \\frac{\\partial \\chi}{\\partial t}$ 必须仅是时间的函数，而与空间坐标无关。任何这样的函数都可以被吸收到 $\\chi$ 的定义中，而不会改变 $\\nabla \\chi$。按照惯例，这个函数被设为零。因此，我们有：\n$$\n\\delta \\phi = -\\frac{\\partial \\chi}{\\partial t}\n$$\n所以，势的一般规范变换为：\n$$\n\\phi'(\\mathbf{x}, t) = \\phi(\\mathbf{x}, t) - \\frac{\\partial \\chi(\\mathbf{x}, t)}{\\partial t}\n$$\n$$\n\\mathbf{A}'(\\mathbf{x}, t) = \\mathbf{A}(\\mathbf{x}, t) + \\nabla \\chi(\\mathbf{x}, t)\n$$\n\n现在，我们进行第二个任务：构造特定的规范函数 $\\chi(\\mathbf{x}, t)$。我们已知初始标量势和在时刻 $t_0$ 的矢量势散度：\n$$\n\\phi(\\mathbf{x}, t) = \\Phi_{0} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n$$\n\\nabla \\cdot \\mathbf{A}(\\mathbf{x}, t_{0}) = F_{0} \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n该变换必须对变换后的势 $\\phi'$ 和 $\\mathbf{A}'$ 满足两个条件：\n1. 对所有 $t$，$\\phi'(\\mathbf{x}, t) = 0$。\n2. $\\nabla \\cdot \\mathbf{A}'(\\mathbf{x}, t_{0}) = G_{0} \\cos(\\mathbf{k} \\cdot \\mathbf{x})$。\n\n根据第一个条件和 $\\phi$ 的变换规则：\n$$\n\\phi'(\\mathbf{x}, t) = \\phi(\\mathbf{x}, t) - \\frac{\\partial \\chi(\\mathbf{x}, t)}{\\partial t} = 0\n$$\n这给出了一个关于 $\\chi$ 的微分方程：\n$$\n\\frac{\\partial \\chi(\\mathbf{x}, t)}{\\partial t} = \\phi(\\mathbf{x}, t) = \\Phi_{0} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n对时间 $t$ 积分，我们得到 $\\chi(\\mathbf{x}, t)$：\n$$\n\\chi(\\mathbf{x}, t) = \\int \\Phi_{0} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) \\, dt = \\Phi_{0} \\cos(\\mathbf{k} \\cdot \\mathbf{x}) \\int \\exp(-\\lambda t) \\, dt\n$$\n$$\n\\chi(\\mathbf{x}, t) = \\Phi_{0} \\cos(\\mathbf{k} \\cdot \\mathbf{x}) \\left( -\\frac{1}{\\lambda} \\exp(-\\lambda t) \\right) + C(\\mathbf{x})\n$$\n此处，$C(\\mathbf{x})$ 是一个积分“常数”，它可以是位置 $\\mathbf{x}$ 的任意函数。所以，\n$$\n\\chi(\\mathbf{x}, t) = -\\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + C(\\mathbf{x})\n$$\n接下来，我们使用第二个条件来确定函数 $C(\\mathbf{x})$。矢量势的变换为 $\\mathbf{A}' = \\mathbf{A} + \\nabla \\chi$。对其取散度：\n$$\n\\nabla \\cdot \\mathbf{A}' = \\nabla \\cdot \\mathbf{A} + \\nabla \\cdot (\\nabla \\chi) = \\nabla \\cdot \\mathbf{A} + \\nabla^2 \\chi\n$$\n第二个条件是在 $t=t_0$ 时指定的：\n$$\n\\nabla \\cdot \\mathbf{A}'(\\mathbf{x}, t_{0}) = \\nabla \\cdot \\mathbf{A}(\\mathbf{x}, t_{0}) + \\nabla^2 \\chi(\\mathbf{x}, t_{0})\n$$\n代入给定的和目标的表达式：\n$$\nG_{0} \\cos(\\mathbf{k} \\cdot \\mathbf{x}) = F_{0} \\sin(\\mathbf{k} \\cdot \\mathbf{x}) + \\nabla^2 \\chi(\\mathbf{x}, t_{0})\n$$\n这将 $\\nabla^2 \\chi(\\mathbf{x}, t_0)$ 与给定的函数联系起来。让我们从我们为 $\\chi$ 找到的表达式计算 $\\nabla^2 \\chi$：\n$$\n\\nabla^2 \\chi(\\mathbf{x}, t) = \\nabla^2 \\left( -\\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + C(\\mathbf{x}) \\right)\n$$\n我们需要计算 $\\cos(\\mathbf{k} \\cdot \\mathbf{x})$ 的拉普拉斯算子。\n$$\n\\nabla (\\cos(\\mathbf{k} \\cdot \\mathbf{x})) = -\\sin(\\mathbf{k} \\cdot \\mathbf{x}) \\nabla(\\mathbf{k} \\cdot \\mathbf{x}) = -\\mathbf{k} \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n$$\n\\nabla^2 (\\cos(\\mathbf{k} \\cdot \\mathbf{x})) = \\nabla \\cdot (-\\mathbf{k} \\sin(\\mathbf{k} \\cdot \\mathbf{x})) = -\\mathbf{k} \\cdot \\nabla(\\sin(\\mathbf{k} \\cdot \\mathbf{x})) = -\\mathbf{k} \\cdot (\\mathbf{k} \\cos(\\mathbf{k} \\cdot \\mathbf{x})) = -|\\mathbf{k}|^2 \\cos(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n因此，$\\chi$ 的拉普拉斯算子为：\n$$\n\\nabla^2 \\chi(\\mathbf{x}, t) = -\\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t) (-|\\mathbf{k}|^2 \\cos(\\mathbf{k} \\cdot \\mathbf{x})) + \\nabla^2 C(\\mathbf{x}) = \\frac{\\Phi_{0} |\\mathbf{k}|^2}{\\lambda} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\nabla^2 C(\\mathbf{x})\n$$\n在 $t=t_0$ 处求值：\n$$\n\\nabla^2 \\chi(\\mathbf{x}, t_{0}) = \\frac{\\Phi_{0} |\\mathbf{k}|^2}{\\lambda} \\exp(-\\lambda t_0) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\nabla^2 C(\\mathbf{x})\n$$\n将此结果与第二个条件得出的表达式相等：\n$$\nG_{0} \\cos(\\mathbf{k} \\cdot \\mathbf{x}) - F_{0} \\sin(\\mathbf{k} \\cdot \\mathbf{x}) = \\frac{\\Phi_{0} |\\mathbf{k}|^2}{\\lambda} \\exp(-\\lambda t_0) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\nabla^2 C(\\mathbf{x})\n$$\n这就得到了一个关于 $C(\\mathbf{x})$ 的泊松型方程：\n$$\n\\nabla^2 C(\\mathbf{x}) = \\left( G_{0} - \\frac{\\Phi_{0} |\\mathbf{k}|^2}{\\lambda} \\exp(-\\lambda t_0) \\right) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) - F_{0} \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n为了找到 $C(\\mathbf{x})$ 的一个特解，我们假设一个与右侧空间依赖性相匹配的形式：\n$$\nC(\\mathbf{x}) = C_1 \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + C_2 \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n这个试探函数的拉普拉斯算子是：\n$$\n\\nabla^2 C(\\mathbf{x}) = C_1 (-|\\mathbf{k}|^2 \\cos(\\mathbf{k} \\cdot \\mathbf{x})) + C_2 (-|\\mathbf{k}|^2 \\sin(\\mathbf{k} \\cdot \\mathbf{x})) = -C_1 |\\mathbf{k}|^2 \\cos(\\mathbf{k} \\cdot \\mathbf{x}) - C_2 |\\mathbf{k}|^2 \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n通过将 $\\cos(\\mathbf{k} \\cdot \\mathbf{x})$ 和 $\\sin(\\mathbf{k} \\cdot \\mathbf{x})$ 的系数与 $\\nabla^2 C(\\mathbf{x})$ 的方程进行比较，我们可以解出 $C_1$ 和 $C_2$。\n对于 $\\cos(\\mathbf{k} \\cdot \\mathbf{x})$ 项：\n$$\n-C_1 |\\mathbf{k}|^2 = G_{0} - \\frac{\\Phi_{0} |\\mathbf{k}|^2}{\\lambda} \\exp(-\\lambda t_0) \\implies C_1 = -\\frac{G_{0}}{|\\mathbf{k}|^2} + \\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t_0)\n$$\n对于 $\\sin(\\mathbf{k} \\cdot \\mathbf{x})$ 项：\n$$\n-C_2 |\\mathbf{k}|^2 = -F_{0} \\implies C_2 = \\frac{F_{0}}{|\\mathbf{k}|^2}\n$$\n由于 $|\\mathbf{k}| \\neq 0$，这些表达式是良定义的。因此函数 $C(\\mathbf{x})$ 就被确定了（相差一个任意的调和函数，为了得到最简单的构造，我们将其设为零）。\n$$\nC(\\mathbf{x}) = \\left(\\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t_0) - \\frac{G_{0}}{|\\mathbf{k}|^2}\\right) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\frac{F_{0}}{|\\mathbf{k}|^2} \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n最后，我们将这个 $C(\\mathbf{x})$ 代回到 $\\chi(\\mathbf{x}, t)$ 的表达式中：\n$$\n\\chi(\\mathbf{x}, t) = -\\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + C(\\mathbf{x})\n$$\n$$\n\\chi(\\mathbf{x}, t) = -\\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\left(\\frac{\\Phi_{0}}{\\lambda} \\exp(-\\lambda t_0) - \\frac{G_{0}}{|\\mathbf{k}|^2}\\right) \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\frac{F_{0}}{|\\mathbf{k}|^2} \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$\n将含有 $\\cos(\\mathbf{k} \\cdot \\mathbf{x})$ 的项合并，得到规范函数 $\\chi(\\mathbf{x}, t)$ 的最终闭式表达式：\n$$\n\\chi(\\mathbf{x}, t) = \\left[ \\frac{\\Phi_{0}}{\\lambda} (\\exp(-\\lambda t_0) - \\exp(-\\lambda t)) - \\frac{G_{0}}{|\\mathbf{k}|^2} \\right] \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\frac{F_{0}}{|\\mathbf{k}|^2} \\sin(\\mathbf{k} \\cdot \\mathbf{x})\n$$", "answer": "$$\n\\boxed{\\left[ \\frac{\\Phi_{0}}{\\lambda} \\left( \\exp(-\\lambda t_{0}) - \\exp(-\\lambda t) \\right) - \\frac{G_{0}}{|\\mathbf{k}|^2} \\right] \\cos(\\mathbf{k} \\cdot \\mathbf{x}) + \\frac{F_{0}}{|\\mathbf{k}|^2} \\sin(\\mathbf{k} \\cdot \\mathbf{x})}\n$$", "id": "3310151"}, {"introduction": "最后一个练习将我们带到计算电磁学的核心，揭示了在离散化麦克斯韦方程组时，规范自由度所带来的深刻影响。我们将探讨规范自由度如何与计算区域的拓扑结构（由贝蒂数表征）相结合，在有限元方法的系统矩阵中产生一个非平凡的零空间 [@problem_id:3310133]。理解并量化这个零空间的维度，对于开发稳定且准确的数值求解器至关重要。", "problem": "考虑一个有界、连通或非连通、可定向的三维区域，其边界为分片光滑。该区域的拓扑由零阶贝蒂数 $b_0$（连通分支的数量）和一阶贝蒂数 $b_1$（一阶同调群的秩，等价于独立的一维孔洞数量）来表征。设此区域通过一个与有限元法（FEM）de Rham 复形和边元（第一类 Nédélec）空间相容的整合四面体网格进行离散化。未知量是与静磁或时谐 curl-curl 算子关联的边元空间中的一个离散矢量势 $\\mathbf{A}_h$。假设切向边界条件满足标准的离散正合序列成立。\n\n从以下基本依据出发：\n- 静态或时谐设置下的麦克斯韦方程组：$\\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{A}\\right) = \\mathbf{J}$，其中存在规范自由度 $\\mathbf{A} \\mapsto \\mathbf{A} + \\nabla \\phi$，对于任何足够光滑的标量势 $\\phi$。\n- 离散 de Rham 复形和除调和场外的正合性：离散梯度 $G$ 将基于节点的势映射到基于边的场，离散旋度 $C$ 将基于边的场映射到基于面的场，并且 $C$ 的核由离散梯度和一个反映拓扑的有限维调和空间组成。\n- 霍奇分解原理和贝蒂数：在一个由 $b_0$ 和 $b_1$ 描述拓扑的区域上，无旋且无散的场的调和子空间的维数等于 $b_1$，常数标量场为梯度算子贡献一个 $b_0$ 维的零空间。\n\n请您：\n1) 基于上述第一性原理，推导作用于边元空间上的离散 curl-curl 算子的零空间维数的表达式，并明确区分来自规范自由度和调和子空间的贡献。您的推导必须明确节点数 $n_0$（节点标量空间的维数）、零阶贝蒂数 $b_0$ 和一阶贝蒂数 $b_1$ 如何决定与规范相关的零空间和调和零空间的维数。\n2) 提出一组最小的线性约束，以消除整个零空间，并清楚地区分需要多少约束来移除规范模态，以及需要多少约束来移除调和模态。请以不依赖任何特定网格细节的方式描述这些约束，并解释为什么它们是充分的。\n3) 实现一个程序，对于一组给定的测试用例 $(n_0, b_0, b_1)$，计算：\n- 与规范相关的零空间的维数，为一个非负整数。\n- 调和零空间的维数，为一个非负整数。\n- 总零度（前两项之和）。\n您的算法必须由您在第 $1)$ 项中的推导和第 $2)$ 项中的约束来证明其合理性。\n\n对于数值评估，请使用以下参数测试套件，每个参数对应一种不同的拓扑情况。在每种情况下，$n_0$ 是标量节点数，$b_0$ 是零阶贝蒂数，$b_1$ 是一阶贝蒂数：\n- 情况 A（单个实心环）：$(n_0, b_0, b_1) = (120, 1, 1)$。\n- 情况 B（退化边界情况，单连通分支中的单个节点）：$(n_0, b_0, b_1) = (1, 1, 0)$。\n- 情况 C（亏格为二的单个连通分支）：$(n_0, b_0, b_1) = (80, 1, 2)$。\n- 情况 D（两个不相交的实心环）：$(n_0, b_0, b_1) = (200, 2, 2)$。\n- 情况 E（单连通的单个连通分支）：$(n_0, b_0, b_1) = (57, 1, 0)$。\n\n您的程序应为每种情况计算一个列表 $[\\text{total\\_nullity}, \\text{gauge\\_nullity}, \\text{harmonic\\_nullity}]$，其中每个条目都是一个整数。最终输出必须是包含这些列表的单行，顺序与情况的顺序相同，例如：\n\"[[x_A,y_A,z_A],[x_B,y_B,z_B],[x_C,y_C,z_C],[x_D,y_D,z_D],[x_E,y_E,z_E]]\"\n其中每个 $x_\\cdot$、$y_\\cdot$ 和 $z_\\cdot$ 都是整数。本问题不要求物理单位。不涉及角度。不涉及百分比。", "solution": "该问题要求推导有限元分析中离散 curl-curl 算子零空间的维数，并构建一组最小约束来消除它。该分析基于四面体网格上离散 de Rham 复形的代数结构。\n\n令离散微分形式的有限维向量空间表示如下：$S_0$ 是节点上的标量函数空间（0-形式），$S_1$ 是沿边积分的矢量函数空间（1-形式，即 Nédélec 边元空间），$S_2$ 是在面上积分的矢量函数空间（2-形式）。这些空间的维数分别是节点数 $n_0$、边数 $n_1$ 和面数 $n_2$。\n\n离散微分算子是梯度 $G: S_0 \\to S_1$、旋度 $C: S_1 \\to S_2$ 和散度 $D: S_2 \\to S_3$。序列 $S_0 \\xrightarrow{G} S_1 \\xrightarrow{C} S_2 \\xrightarrow{D} S_3$ 构成一个离散 de Rham 复形。如问题所述，该复形的一个基本性质是它在同调意义下是正合的，而同调由区域的拓扑决定。\n\n问题关注的是离散 curl-curl 算子的零空间，其矩阵形式可以写为 $K = C^T M_{\\mu^{-1}} C$，其中 $C$ 是离散旋度的矩阵表示，$M_{\\mu^{-1}}$ 是代表材料属性 $\\mu^{-1}$ 的对称正定矩阵。一个矢量势 $\\mathbf{A}_h \\in S_1$ 处于 $K$ 的零空间中，当且仅当 $K \\mathbf{A}_h = 0$。由于 $M_{\\mu^{-1}}$ 的正定性，条件 $K \\mathbf{A}_h = 0$ 等价于 $C \\mathbf{A}_h = 0$。因此，离散 curl-curl 算子的零空间恰好是离散旋度算子的核，即 $\\ker(C)$。\n\n**1. 零空间维数的推导**\n\n根据应用于离散 de Rham 复形的霍奇理论原理，旋度算子的核可以分解为两个正交子空间的直和：梯度算子的像 $\\text{im}(G)$ 和一阶调和场的空间 $\\mathcal{H}_1$。\n$$\n\\ker(C) = \\text{im}(G) \\oplus \\mathcal{H}_1\n$$\n总零空间的维数是这两个子空间维数之和：$\\dim(\\ker(C)) = \\dim(\\text{im}(G)) + \\dim(\\mathcal{H}_1)$。\n\n**调和零空间的维数：**\n空间 $\\mathcal{H}_1$ 由离散 1-形式（边场）组成，它们是无旋的（$C\\mathbf{A}_h = 0$）和无散的（$G^T M_\\epsilon \\mathbf{A}_h = 0$，其中 $M_\\epsilon$ 是介电常数矩阵，用于适当的霍奇星算子定义的散度），但它们不是任何全局标量 0-形式（节点势）的梯度。该空间的维数是区域的一个拓扑不变量，由一阶贝蒂数 $b_1$ 给出。这被明确陈述为一个给定原则。\n$$\n\\dim(\\mathcal{H}_1) = b_1\n$$\n$\\mathcal{H}_1$ 的这 $b_1$ 个基向量对应于矢量势围绕区域中 $b_1$ 个独立的不可收缩回路（“孔洞”）的非平凡环流。它们是零空间中所谓的“拓扑”或“调和”模态的来源。\n\n**与规范相关的零空间的维数：**\n子空间 $\\text{im}(G)$ 由所有是某个离散标量势 $\\phi_h \\in S_0$ 的梯度的离散矢量场组成。也就是说，对于任何 $\\mathbf{A}_h \\in \\text{im}(G)$，存在一个 $\\phi_h \\in S_0$ 使得 $\\mathbf{A}_h = G \\phi_h$。该子空间对应于连续理论中的规范自由度 $\\mathbf{A} \\mapsto \\mathbf{A} + \\nabla \\phi$。因此，$\\text{im}(G)$ 是与规范相关的零空间。\n\n为了求其维数，我们对离散梯度算子 $G: S_0 \\to S_1$ 应用秩-零度定理：\n$$\n\\dim(S_0) = \\dim(\\ker(G)) + \\dim(\\text{im}(G))\n$$\n$G$ 的定义域维数 $\\dim(S_0)$ 是网格中的节点数 $n_0$。\n\n梯度算子的核 $\\ker(G)$ 由所有满足 $G \\phi_h = 0$ 的标量势 $\\phi_h \\in S_0$ 组成。此条件意味着网格中任意一条边的两个节点上的势值相同。因此，势在网格的每个连通分支上必须是常数。连通分支的数量由零阶贝蒂数 $b_0$ 给出。可以由 $b_0$ 个指示函数构造出 $\\ker(G)$ 的一组基，其中第 $i$ 个基函数在第 $i$ 个连通分支的所有节点上等于 $1$，在其他地方等于 $0$。因此，梯度算子核的维数是：\n$$\n\\dim(\\ker(G)) = b_0\n$$\n将此代入秩-零度定理，得到：\n$$\nn_0 = b_0 + \\dim(\\text{im}(G))\n$$\n解出与规范相关的零空间的维数，我们发现：\n$$\n\\dim(\\text{im}(G)) = n_0 - b_0\n$$\n\n**总零度：**\n结合两个子空间的维数，得到离散 curl-curl 算子零空间的总维数：\n$$\n\\text{总零度} = \\dim(\\ker(C)) = \\dim(\\text{im}(G)) + \\dim(\\mathcal{H}_1) = (n_0 - b_0) + b_1\n$$\n总结来说，维数分别为：\n-   与规范相关的零空间的维数：$n_0 - b_0$\n-   调和零空间的维数：$b_1$\n-   总零度：$n_0 - b_0 + b_1$\n\n**2. 最小线性约束集**\n\n为了获得 curl-curl 方程的唯一解，必须施加数量等于总零度的线性无关约束。这些约束必须被选择以消除规范模态和调和模态。\n\n**规范模态的约束：**\n有 $n_0 - b_0$ 个规范自由度需要消除。这些对应于 $\\text{im}(G)$ 中的非零场。一种标准且与网格无关的描述约束的方法是“树规法”。对于网格的 $b_0$ 个连通分支中的每一个，构建一个由节点和边组成的图的生成树。一个具有 $n_{0,i}$ 个节点的分支的生成树包含 $n_{0,i} - 1$ 条边。所有分支的这些生成树的并集构成了整个网格图的“最大森林”。该森林中的总边数为 $\\sum_{i=1}^{b_0} (n_{0,i} - 1) = (\\sum_{i=1}^{b_0} n_{0,i}) - (\\sum_{i=1}^{b_0} 1) = n_0 - b_0$。\n然后通过将与该最大森林中的边相关联的自由度设置为零来施加约束。这等效于强制矢量势 $\\mathbf{A}_h$ 沿着森林中 $n_0 - b_0$ 条边中每一条的线积分为零。此过程有效地将标量势 $\\phi_h$ 在每个分支上固定至一个常数，这足以消除所有非平凡的梯度场。\n\n**调和模态的约束：**\n有 $b_1$ 个调和模态需要消除。这些模态不是梯度，其特征是围绕区域的不可收缩回路具有非零环流。为了消除它们，必须约束这些环流。\n约束是通过识别一组 $b_1$ 个独立的、不可收缩的闭合路径 $\\{\\gamma_1, \\gamma_2, \\ldots, \\gamma_{b_1}\\}$ 来制定的，这些路径构成了区域一阶同调群的基。每个路径 $\\gamma_j$“环绕”一个拓扑孔洞。这 $b_1$ 个约束在于规定矢量势 $\\mathbf{A}_h$ 沿这些路径中每一条的环流，通常是通过将它们设置为零：\n$$\n\\oint_{\\gamma_j} \\mathbf{A}_h \\cdot d\\mathbf{l} = 0, \\quad \\text{for } j = 1, \\ldots, b_1\n$$\n这 $b_1$ 个约束与前述的 $n_0 - b_0$ 个规范约束是独立的，它们共同构成一个由 $(n_0 - b_0) + b_1$ 个约束组成的最小集合，足以消除 curl-curl 算子的整个零空间，从而使系统矩阵非奇异。\n\n**3. 算法的合理性**\n程序的算法直接实现了推导出的公式：\n-   `gauge_nullity` = $n_0 - b_0$\n-   `harmonic_nullity` = $b_1$\n-   `total_nullity` = `gauge_nullity` + `harmonic_nullity` = $(n_0 - b_0) + b_1$\n\n如上文推导，这些公式是将离散 de Rham 复形和霍奇分解应用于有限元空间的直接结果。输入 $(n_0, b_0, b_1)$ 正是决定相关空间维数和拓扑特征的参数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the nullity of the discrete curl-curl operator for various\n    domain topologies based on given parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n_0, b_0, b_1)\n    # n_0: number of scalar nodes\n    # b_0: zero-th Betti number (number of connected components)\n    # b_1: first Betti number (number of independent 1D holes/tunnels)\n    test_cases = [\n        (120, 1, 1),  # Case A: single solid torus\n        (1, 1, 0),    # Case B: degenerate case, single node\n        (80, 1, 2),   # Case C: single component of genus two\n        (200, 2, 2),  # Case D: two disjoint solid tori\n        (57, 1, 0),   # Case E: simply connected single component\n    ]\n\n    results = []\n    for case in test_cases:\n        n0, b0, b1 = case\n        \n        # The derivation shows that the nullspace of the discrete curl-curl\n        # operator is the kernel of the discrete curl operator, C.\n        # This kernel decomposes into a direct sum of two subspaces:\n        # 1. The image of the discrete gradient (gauge modes).\n        # 2. The space of discrete harmonic fields (topological modes).\n        \n        # Dimension of the gauge-related nullspace = dim(im(G))\n        # From the rank-nullity theorem on the gradient operator G,\n        # dim(im(G)) = dim(domain(G)) - dim(ker(G))\n        # dim(domain(G)) is the number of nodes, n_0.\n        # dim(ker(G)) is the number of connected components, b_0.\n        # Therefore, gauge_nullity = n_0 - b_0.\n        if n0  b0:\n             # This case is physically/topologically inconsistent, but for\n             # robustness, we handle it. The number of nodes cannot be less\n             # than the number of connected components.\n             gauge_nullity = 0\n        else:\n             gauge_nullity = n0 - b0\n        \n        # Dimension of the harmonic nullspace.\n        # This is a topological invariant equal to the first Betti number, b_1.\n        harmonic_nullity = b1\n        \n        # Total nullity is the sum of the two.\n        total_nullity = gauge_nullity + harmonic_nullity\n        \n        results.append([total_nullity, gauge_nullity, harmonic_nullity])\n\n    # Format the output string exactly as required by the problem statement.\n    # Example format: [[x_A,y_A,z_A],[x_B,y_B,z_B],...]\n    # Each inner list is formatted as '[x,y,z]' without spaces.\n    inner_results_str = [f\"[{t},{g},{h}]\" for t, g, h in results]\n    final_output_str = f\"[{','.join(inner_results_str)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "3310133"}]}