{"hands_on_practices": [{"introduction": "增长因子是衡量 LU 分解稳定性的一个关键指标。这个练习提供了一种直接的方式来理解其定义，即在一个特定的矩阵上手动执行带部分主元选择的高斯消去法 [@problem_id:3581067]。通过逐步追踪算法，我们可以观察到元素大小的变化，并精确地计算出增长因子，从而对该过程建立起具体的认识。", "problem": "考虑对矩阵 $A(\\epsilon) \\in \\mathbb{R}^{3 \\times 3}$ 应用带部分主元选择的高斯消去法 (GEPP)，该矩阵定义为\n$$\nA(\\epsilon) \\;=\\; \\begin{bmatrix}\n1  1  1 \\\\\n1  \\epsilon  1 \\\\\n1  1  \\epsilon\n\\end{bmatrix},\n$$\n其中 $\\epsilon$ 是一个满足 $0  \\epsilon  1$ 的固定标量。部分主元选择使用以下确定性决胜规则：当活动列中两个或多个候选主元行具有相等的最大绝对值时，选择行索引最小的那一行。定义 GEPP 的增长因子为\n$$\n\\rho(A) \\;=\\; \\frac{\\displaystyle \\max_{k \\in \\{0,1,2,3\\}} \\max_{i,j} \\big|a^{(k)}_{ij}\\big|}{\\displaystyle \\max_{i,j} \\big|a^{(0)}_{ij}\\big|},\n$$\n其中 $A^{(0)} = A(\\epsilon)$，$A^{(k)}$ 表示经过 $k$ 步消去后的活动子矩阵（因此 $A^{(3)}$ 是上三角因子 $U$）。从 GEPP 和增长因子的核心定义出发，根据所述的主元选择规则，对 $A(\\epsilon)$ 显式地执行消去过程，并推导出一个关于 $\\epsilon$ 的 $\\rho(A)$ 的闭式表达式。然后，根据您的推导，解释参数 $\\epsilon$ 如何影响该矩阵族在 GEPP 下的元素增长。请以 $\\epsilon$ 的单个闭式解析表达式的形式给出 $\\rho(A)$ 的最终答案。无需四舍五入。", "solution": "问题要求计算对一个特定的 $3 \\times 3$ 矩阵 $A(\\epsilon)$ 应用带部分主元选择的高斯消去法 (GEPP) 时的增长因子 $\\rho(A)$。分析将通过显式地执行消去步骤来进行。\n\n给定的矩阵是：\n$$\nA(\\epsilon) = A^{(0)} = \\begin{bmatrix}\n1  1  1 \\\\\n1  \\epsilon  1 \\\\\n1  1  \\epsilon\n\\end{bmatrix}\n$$\n其中 $\\epsilon$ 是一个满足 $0  \\epsilon  1$ 的标量。\n\n增长因子的定义为：\n$$\n\\rho(A) = \\frac{\\displaystyle \\max_{k \\in \\{0,1,2,3\\}} \\max_{i,j} \\big|a^{(k)}_{ij}\\big|}{\\displaystyle \\max_{i,j} \\big|a^{(0)}_{ij}\\big|}\n$$\n这里，$A^{(0)}$ 是初始矩阵。项 $\\max_{i,j} |a^{(k)}_{ij}|$ 指的是在消去的第 $k$ 步之后出现的整个矩阵中任何元素的最大绝对值。对于 $k \\in \\{1, 2\\}$，$A^{(k)}$ 是活动子矩阵，但增长因子定义的分子考虑了直到并包括最终上三角矩阵 $U = A^{(3)}$ 所产生的所有元素。\n\n首先，我们确定增长因子表达式的分母。这是初始矩阵 $A^{(0)}$ 中元素的最大绝对值。\n$$\n\\max_{i,j} \\big|a^{(0)}_{ij}\\big| = \\max \\left\\{ |1|, |\\epsilon| \\right\\}\n$$\n由于 $0  \\epsilon  1$，最大绝对值为 $1$。\n$$\n\\max_{i,j} \\big|a^{(0)}_{ij}\\big| = 1\n$$\n到目前为止发现的最大元素量级，即对分子有贡献的值，也是 $1$。\n\n现在，我们执行 GEPP 的步骤。\n\n**第1步：第1列的消去**\n\n$A^{(0)}$ 的第一列是 $\\begin{bmatrix} 1  1  1 \\end{bmatrix}^T$。具有最大绝对值的元素是 $1$，它出现在所有三行中。指定的确定性决胜规则要求选择行索引最小的候选行。因此，选择第 $1$ 行作为主元行。主元元素是 $a_{11} = 1$。不需要行交换。\n\n消去的乘子是：\n$$\nm_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1}{1} = 1\n$$\n$$\nm_{31} = \\frac{a_{31}}{a_{11}} = \\frac{1}{1} = 1\n$$\n\n新行的计算方式为 $R_2 \\leftarrow R_2 - m_{21}R_1$ 和 $R_3 \\leftarrow R_3 - m_{31}R_1$：\n第 2 行: $[1, \\epsilon, 1] - 1 \\cdot [1, 1, 1] = [0, \\epsilon - 1, 0]$\n第 3 行: $[1, 1, \\epsilon] - 1 \\cdot [1, 1, 1] = [0, 0, \\epsilon - 1]$\n\n经过第一步消去后的矩阵，我们记为 $M^{(1)}$，是：\n$$\nM^{(1)} = \\begin{bmatrix}\n1  1  1 \\\\\n0  \\epsilon-1  0 \\\\\n0  0  \\epsilon-1\n\\end{bmatrix}\n$$\n活动子矩阵是 $A^{(1)}$：\n$$\nA^{(1)} = \\begin{bmatrix}\n\\epsilon-1  0 \\\\\n0  \\epsilon-1\n\\end{bmatrix}\n$$\n新生成的元素是 $\\epsilon-1$ 和 $0$。由于 $0  \\epsilon  1$，我们有 $-1  \\epsilon-1  0$，所以 $|\\epsilon-1| = 1-\\epsilon$。因为 $1-\\epsilon  1$，到目前为止（在 $A^{(0)}$ 和 $M^{(1)}$ 中）所见任何元素的最大绝对值仍然是 $1$。\n\n**第2步：第2列的消去**\n\n消去在活动子矩阵 $A^{(1)}$ 上进行。$A^{(1)}$ 的第一列是 $\\begin{bmatrix} \\epsilon-1 \\\\ 0 \\end{bmatrix}$。最大绝对值是 $|\\epsilon-1| = 1-\\epsilon$，位于子矩阵的第一行（对应于完整矩阵的第 $2$ 行）。这是我们的主元元素。不需要行交换。\n\n主元元素是 $a^{(1)}_{11} = \\epsilon-1$。乘子是：\n$$\nm_{32} = \\frac{a^{(1)}_{21}}{a^{(1)}_{11}} = \\frac{0}{\\epsilon-1} = 0\n$$\n由于乘子是 $0$，后续的行更新 $R_3 \\leftarrow R_3 - m_{32}R_2$ 不会改变第 $3$ 行。第二步后的矩阵 $M^{(2)}$ 与 $M^{(1)}$ 相同：\n$$\nM^{(2)} = \\begin{bmatrix}\n1  1  1 \\\\\n0  \\epsilon-1  0 \\\\\n0  0  \\epsilon-1\n\\end{bmatrix}\n$$\n没有生成新的元素值。活动的 $1 \\times 1$ 子矩阵是 $A^{(2)} = [\\epsilon-1]$。\n\n**第3步：最终矩阵**\n\n消去过程完成。最终的上三角矩阵是 $U = A^{(3)} = M^{(2)}$。\n$$\nU = A^{(3)} = \\begin{bmatrix}\n1  1  1 \\\\\n0  \\epsilon-1  0 \\\\\n0  0  \\epsilon-1\n\\end{bmatrix}\n$$\n\n**增长因子的计算**\n\n$\\rho(A)$ 的分子是在所有阶段（$k=0, 1, 2, 3$）中遇到的任何元素的最大绝对值。在矩阵 $A^{(0)}, M^{(1)}, M^{(2)}, U$ 中出现的所有元素的集合是 $\\{1, \\epsilon, \\epsilon-1, 0\\}$。\n这些元素的绝对值是 $\\{1, \\epsilon, 1-\\epsilon, 0\\}$。\n由于 $0  \\epsilon  1$，$\\epsilon$ 和 $1-\\epsilon$ 都严格介于 $0$ 和 $1$ 之间。\n因此，这些绝对值的最大值是 $1$。\n$$\n\\max_{k \\in \\{0,1,2,3\\}} \\max_{i,j} \\big|a^{(k)}_{ij}\\big| = 1\n$$\n现在，我们可以计算增长因子：\n$$\n\\rho(A) = \\frac{1}{1} = 1\n$$\n\n**参数 $\\epsilon$ 的影响**\n\n推导表明，对于 $0  \\epsilon  1$ 范围内的任何 $\\epsilon$ 值，增长因子 $\\rho(A)$ 都等于 $1$。增长因子为 $1$ 表示在消去过程中没有发生元素增长；量级最大的元素存在于原始矩阵中。对于这个特定的矩阵族和给定的 GEPP 过程，该算法是完全稳定的。参数 $\\epsilon$ 影响中间和最终矩阵项的值（例如 $\\epsilon-1$），但由于问题的结构和部分主元选择的性质，这些新项的量级从未超过初始最大项的量级。因此，对于这个问题，$\\epsilon$ 对元素增长没有影响。", "answer": "$$\\boxed{1}$$", "id": "3581067"}, {"introduction": "在理解了如何计算增长因子之后，正确地衡量一个计算解的误差至关重要。这个练习通过一个精心构造的病态缩放矩阵的例子，探讨了范数向后误差和分量向后误差之间的区别 [@problem_id:3581031]。您会发现，即使增长因子可能很小，误差度量的选择也会极大地改变我们对解的准确性的结论，这突出了分量分析的重要性。", "problem": "考虑使用带部分主元的高斯消去法，在精确算术中计算一个线性系统的近似解，但最后一次舍入产生了一个非零残差。设 $M = 10^{8}$ 且 $\\eta = \\frac{1}{5}$。定义矩阵和右端项\n$$\nA = \\begin{pmatrix} M  0 \\\\ 0  1 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} M \\\\ 1 - \\eta \\end{pmatrix}.\n$$\n假设计算出的解是\n$$\n\\hat{x} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n设残差为 $r = b - A \\hat{x}$。使用无穷范数 $\\|\\cdot\\|_{\\infty}$。\n\n1. 计算无穷范数下的范数向后误差，\n$$\n\\mu_{\\infty} = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\,\\|\\hat{x}\\|_{\\infty} + \\|b\\|_{\\infty}},\n$$\n以及分量向后误差，\n$$\n\\omega_{\\infty} = \\left\\|\\,|r| \\oslash \\left(|A|\\,|\\hat{x}| + |b|\\right)\\,\\right\\|_{\\infty},\n$$\n其中 $|\\,\\cdot\\,|$ 表示逐项绝对值，$\\oslash$ 表示逐项除法。\n\n2. 计算对 $A$ 进行部分主元消去的主元增长因子，\n$$\n\\gamma_{\\infty}(A) = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $U$ 是对 $A$ 进行带部分主元的高斯消去法得到的上三角因子。\n\n3. 使用 $\\mu_{\\infty}$ 和 $\\omega_{\\infty}$ 的值，计算比率\n$$\n\\rho = \\frac{\\omega_{\\infty}}{\\mu_{\\infty}}.\n$$\n\n简要解释为什么在这个例子中，即使主元增长因子是最小的，范数向后误差与分量向后误差相比也可能具有误导性地小。\n\n将您计算的 $\\rho$ 的最终数值结果四舍五入到四位有效数字。", "solution": "首先验证问题以确保其科学性、适定性和客观性。\n\n**步骤 1：提取已知条件**\n- 常数：$M = 10^{8}$\n- 常数：$\\eta = \\frac{1}{5}$\n- 矩阵：$A = \\begin{pmatrix} M  0 \\\\ 0  1 \\end{pmatrix}$\n- 向量：$b = \\begin{pmatrix} M \\\\ 1 - \\eta \\end{pmatrix}$\n- 计算解：$\\hat{x} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n- 残差定义：$r = b - A \\hat{x}$\n- 范数：无穷范数 $\\|\\cdot\\|_{\\infty}$\n- 范数向后误差：$\\mu_{\\infty} = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\,\\|\\hat{x}\\|_{\\infty} + \\|b\\|_{\\infty}}$\n- 分量向后误差：$\\omega_{\\infty} = \\left\\|\\,|r| \\oslash \\left(|A|\\,|\\hat{x}| + |b|\\right)\\,\\right\\|_{\\infty}$，其中 $|\\,\\cdot\\,|$ 是逐项绝对值，$\\oslash$ 是逐项除法。\n- 主元增长因子：$\\gamma_{\\infty}(A) = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|}$，其中 $U$ 是对 $A$ 进行带部分主元的高斯消去法得到的上三角因子。\n- 比率：$\\rho = \\frac{\\omega_{\\infty}}{\\mu_{\\infty}}$\n- 最终指令：将 $\\rho$ 四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学性**：该问题使用了数值线性代数中关于向后误差分析和 LU 分解稳定性的标准定义。这些概念是该领域的基础。\n- **适定性**：所有必要的数据和定义都已提供。矩阵 $A$ 是非奇异的。计算是适定的。\n- **客观性**：问题使用精确的数学语言和定义陈述，没有任何主观性。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n**第 1 部分：计算 $\\mu_{\\infty}$ 和 $\\omega_{\\infty}$**\n\n首先，我们计算残差向量 $r$。\n乘积 $A\\hat{x}$ 为：\n$$\nA\\hat{x} = \\begin{pmatrix} M  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} M \\cdot 1 + 0 \\cdot 1 \\\\ 0 \\cdot 1 + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} M \\\\ 1 \\end{pmatrix}\n$$\n右端向量 $b$ 为：\n$$\nb = \\begin{pmatrix} M \\\\ 1 - \\eta \\end{pmatrix} = \\begin{pmatrix} 10^{8} \\\\ 1 - \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} 10^{8} \\\\ \\frac{4}{5} \\end{pmatrix}\n$$\n残差 $r = b - A\\hat{x}$ 为：\n$$\nr = \\begin{pmatrix} M \\\\ 1 - \\eta \\end{pmatrix} - \\begin{pmatrix} M \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} M - M \\\\ (1 - \\eta) - 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\eta \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{1}{5} \\end{pmatrix}\n$$\n接下来，我们计算求 $\\mu_{\\infty}$ 所需的范数：\n$$\n\\|r\\|_{\\infty} = \\max\\left(|0|, |-\\frac{1}{5}|\\right) = \\frac{1}{5}\n$$\n$$\n\\|A\\|_{\\infty} = \\max\\left(|M| + |0|, |0| + |1|\\right) = \\max(M, 1) = M = 10^{8}\n$$\n$$\n\\|\\hat{x}\\|_{\\infty} = \\max(|1|, |1|) = 1\n$$\n$$\n\\|b\\|_{\\infty} = \\max\\left(|M|, |1 - \\eta|\\right) = \\max\\left(10^{8}, \\frac{4}{5}\\right) = M = 10^{8}\n$$\n现在我们计算范数向后误差 $\\mu_{\\infty}$：\n$$\n\\mu_{\\infty} = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\,\\|\\hat{x}\\|_{\\infty} + \\|b\\|_{\\infty}} = \\frac{\\frac{1}{5}}{M \\cdot 1 + M} = \\frac{\\frac{1}{5}}{2M} = \\frac{1}{10M} = \\frac{1}{10 \\cdot 10^{8}} = 10^{-9}\n$$\n接下来，我们计算分量向后误差 $\\omega_{\\infty}$ 所需的量。我们需要向量 $|r| \\oslash (|A|\\,|\\hat{x}| + |b|)$。\n$$\n|r| = \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\end{pmatrix}, \\quad |A| = \\begin{pmatrix} M  0 \\\\ 0  1 \\end{pmatrix}, \\quad |\\hat{x}| = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad |b| = \\begin{pmatrix} M \\\\ 1 - \\eta \\end{pmatrix} = \\begin{pmatrix} M \\\\ \\frac{4}{5} \\end{pmatrix}\n$$\n分母向量为：\n$$\n|A|\\,|\\hat{x}| + |b| = \\begin{pmatrix} M  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} M \\\\ \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} M \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} M \\\\ \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} 2M \\\\ 1 + \\frac{4}{5} \\end{pmatrix} = \\begin{pmatrix} 2M \\\\ \\frac{9}{5} \\end{pmatrix}\n$$\n现在我们进行逐项除法：\n$$\n|r| \\oslash \\left(|A|\\,|\\hat{x}| + |b|\\right) = \\begin{pmatrix} 0 / (2M) \\\\ (\\frac{1}{5}) / (\\frac{9}{5}) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{5} \\cdot \\frac{5}{9} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{9} \\end{pmatrix}\n$$\n分量向后误差 $\\omega_{\\infty}$ 是这个结果向量的无穷范数：\n$$\n\\omega_{\\infty} = \\left\\| \\begin{pmatrix} 0 \\\\ \\frac{1}{9} \\end{pmatrix} \\right\\|_{\\infty} = \\max\\left(|0|, |\\frac{1}{9}|\\right) = \\frac{1}{9}\n$$\n\n**第 2 部分：计算主元增长因子 $\\gamma_{\\infty}(A)$**\n\n矩阵为 $A = \\begin{pmatrix} M  0 \\\\ 0  1 \\end{pmatrix}$。为了执行带部分主元的高斯消去法，我们检查第一列。绝对值最大的元素是 $a_{11} = M$。因为它已经在主元位置 $(1,1)$，所以不需要行交换。置换矩阵是单位矩阵，$P=I$。\n消去步骤涉及使用主元 $a_{11}$ 将其下方的元素置为零。其下方唯一的元素是 $a_{21}=0$，它已经是零。因此，不执行任何消去操作。\n$LU$ 分解为 $A = LU$。下三角矩阵 $L$ 是单位矩阵，上三角矩阵 $U$ 等于 $A$。\n$$\nL = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\qquad U = A = \\begin{pmatrix} M  0 \\\\ 0  1 \\end{pmatrix}\n$$\n主元增长因子为：\n$$\n\\gamma_{\\infty}(A) = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|} = \\frac{\\max(|M|, |0|, |0|, |1|)}{\\max(|M|, |0|, |0|, |1|)} = \\frac{M}{M} = 1\n$$\n增长因子为 $1$ 是可能的最小值，表明 LU 分解过程是完全稳定的。\n\n**第 3 部分：计算 $\\rho$ 及解释**\n\n比率 $\\rho$ 为：\n$$\n\\rho = \\frac{\\omega_{\\infty}}{\\mu_{\\infty}} = \\frac{1/9}{10^{-9}} = \\frac{1}{9} \\times 10^{9} \\approx 111,111,111.11 \\dots\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\rho \\approx 1.111 \\times 10^{8}\n$$\n**解释：**\n范数向后误差 $\\mu_{\\infty} = 10^{-9}$ 和分量向后误差 $\\omega_{\\infty} = \\frac{1}{9}$ 之间的巨大差异突显了范数度量对于不良缩放问题的一个关键弱点。\n\n范数向后误差 $\\mu_{\\infty}$ 具有误导性地小，因为其分母 $\\|A\\|_{\\infty} \\|\\hat{x}\\|_{\\infty} + \\|b\\|_{\\infty}$ 被 $A$ 和 $b$ 中的最大项（即 $M=10^8$）所主导。范数计算汇总了信息，第一个方程 $M x_1 = M$ 的大尺度掩盖了第二个较小尺度方程 $x_2=1-\\eta$ 的细节。残差的范数 $\\|r\\|_{\\infty}=\\frac{1}{5}$ 被一个非常大的数（$2M$）除，产生了一个微小的结果。这给人一种错误的印象，即计算出的解 $\\hat{x}$ 对整个系统来说是“好的”。\n\n相比之下，分量向后误差 $\\omega_{\\infty}$ 在取最大值之前，分别分析了每个分量方程相对于其数据的误差。\n- 对于第一个方程，分量误差为 $0$，因为 $|r_1|/(|A\\hat{x}|_1 + |b|_1) = 0/(M+M) = 0$。\n- 对于第二个方程，分量误差为 $|r_2|/(|A\\hat{x}|_2 + |b|_2) = |-\\eta|/(|1| + |1-\\eta|) = (\\frac{1}{5})/(1+\\frac{4}{5}) = (\\frac{1}{5})/(\\frac{9}{5}) = \\frac{1}{9}$。\n总的 $\\omega_{\\infty}$ 是这些值的最大值，即 $\\frac{1}{9}$，这个值并不小。这正确地表明，第二个方程在相对意义上没有得到很好的满足，因为该方程的数据都是 $1$ 这个量级的。\n\n最小的主元增长因子 $\\gamma_{\\infty}(A)=1$ 证实了问题不是由高斯消去算法期间的任何误差放大引起的。这种差异完全是由于原始问题数据的不良缩放造成的，其中系数和右端项的条目相差多个数量级。对于这类问题，分量向后误差为解的质量提供了更具洞察力和更可靠的度量。", "answer": "$$\n\\boxed{1.111 \\times 10^8}\n$$", "id": "3581031"}, {"introduction": "在前一个练习的基础上，本练习将分量向后误差的概念应用于一个更实际的场景 [@problem_id:3581065]。给定一个由回代步骤得到的计算解（模拟了浮点运算的结果），您将计算出精确的分量向后误差。这个练习加强了误差分析的实际应用，并展示了在存在数值不精确性的情况下如何量化解的质量。", "problem": "考虑求解上三角系统 $U x = y$，该系统是在带部分主元法的下-上 (LU) 分解中求解 $U$ 的阶段产生的。上三角矩阵 $U \\in \\mathbb{R}^{4 \\times 4}$ 的对角线元素均为 1，\n$$\nU \\;=\\;\n\\begin{pmatrix}\n1  2.5  -3.1  4.0 \\\\\n0  1  0.75  -2.2 \\\\\n0  0  1  1.6 \\\\\n0  0  0  1\n\\end{pmatrix},\n$$\n右端项为\n$$\ny \\;=\\; \\begin{pmatrix} 5.0 \\\\ -1.3 \\\\ 2.7 \\\\ -0.9 \\end{pmatrix}.\n$$\n回代法在国际电气与电子工程师协会 (IEEE) binary64 (双精度) 浮点运算中执行，采用“四舍六入五成双”的舍入规则。由回代法返回的计算解 $\\hat{x}$ 观测值为\n$$\n\\hat{x} \\;=\\; \\begin{pmatrix}\n37.39650000000001 \\\\\n-6.385000000000002 \\\\\n4.140000000000001 \\\\\n-0.8999999999999999\n\\end{pmatrix}.\n$$\n使用线性系统求解中分量形式后向误差的形式化定义，确定此 $U$ 求解过程中 $\\hat{x}$ 的分量形式后向误差。将最终答案表示为单个无量纲标量，并四舍五入至四位有效数字。", "solution": "用户想要确定对于给定的上三角线性系统 $Ux=y$ 的计算解 $\\hat{x}$ 的分量形式后向误差。\n\n对于线性系统 $Ax=b$ 的计算解 $\\hat{x}$，其分量形式后向误差的形式化定义为最小的非负标量 $\\omega$，使得解 $\\hat{x}$ 是某个扰动系统 $(A + \\Delta A)\\hat{x} = b + \\Delta b$ 的精确解，其中扰动在分量上满足 $|\\Delta A| \\le \\omega|A|$ 和 $|\\Delta b| \\le \\omega|b|$。该值的计算公式为：\n$$ \\omega = \\max_i \\frac{|(b - A\\hat{x})_i|}{(|A||\\hat{x}| + |b|)_i} $$\n在本问题中，系统由 $U x = y$ 给出，其中 $U \\in \\mathbb{R}^{4 \\times 4}$ 是一个上三角矩阵。因此，计算解 $\\hat{x}$ 的分量形式后向误差 $\\omega$ 为：\n$$ \\omega = \\max_i \\frac{|(y - U\\hat{x})_i|}{(|U||\\hat{x}| + |y|)_i} $$\n计算过程分三步进行：\n1.  计算残差向量 $r = y - U\\hat{x}$。\n2.  计算分母向量 $d = |U||\\hat{x}| + |y|$。\n3.  计算 $|r_i|/d_i$ 的逐元素比率并找出最大值。\n\n给定数据如下：\n$$\nU \\;=\\;\n\\begin{pmatrix}\n1  2.5  -3.1  4.0 \\\\\n0  1  0.75  -2.2 \\\\\n0  0  1  1.6 \\\\\n0  0  0  1\n\\end{pmatrix}, \\;\\;\ny \\;=\\; \\begin{pmatrix} 5.0 \\\\ -1.3 \\\\ 2.7 \\\\ -0.9 \\end{pmatrix}, \\;\\;\n\\hat{x} \\;=\\; \\begin{pmatrix}\n37.39650000000001 \\\\\n-6.385000000000002 \\\\\n4.140000000000001 \\\\\n-0.8999999999999999\n\\end{pmatrix}.\n$$\n\n第 1 步：计算残差 $r = y - U\\hat{x}$。\n首先，我们计算乘积 $z = U\\hat{x}$。计算以足够的精度进行，以避免有效位损失。\n$$ z_4 = (U\\hat{x})_4 = 1 \\cdot \\hat{x}_4 = -0.8999999999999999 $$\n$$ z_3 = (U\\hat{x})_3 = 1 \\cdot \\hat{x}_3 + 1.6 \\cdot \\hat{x}_4 = 4.140000000000001 + 1.6(-0.8999999999999999) = 2.7000000000000013 $$\n$$ z_2 = (U\\hat{x})_2 = 1 \\cdot \\hat{x}_2 + 0.75 \\cdot \\hat{x}_3 - 2.2 \\cdot \\hat{x}_4 = -6.385000000000002 + 0.75(4.140000000000001) - 2.2(-0.8999999999999999) = -1.3000000000000018 $$\n$$ z_1 = (U\\hat{x})_1 = 1 \\cdot \\hat{x}_1 + 2.5 \\cdot \\hat{x}_2 - 3.1 \\cdot \\hat{x}_3 + 4.0 \\cdot \\hat{x}_4 = 37.39650000000001 + 2.5(-6.385000000000002) - 3.1(4.140000000000001) + 4.0(-0.8999999999999999) = 5.0 $$\n因此，乘积为 $U\\hat{x} = \\begin{pmatrix} 5.0 \\\\ -1.3000000000000018 \\\\ 2.7000000000000013 \\\\ -0.8999999999999999 \\end{pmatrix}$。\n残差向量 $r = y - U\\hat{x}$ 为：\n$$ r = \\begin{pmatrix} 5.0 \\\\ -1.3 \\\\ 2.7 \\\\ -0.9 \\end{pmatrix} - \\begin{pmatrix} 5.0 \\\\ -1.3000000000000018 \\\\ 2.7000000000000013 \\\\ -0.8999999999999999 \\end{pmatrix} = \\begin{pmatrix} 0.0 \\\\ 1.7763568394002505 \\times 10^{-15} \\\\ -1.3322676295501878 \\times 10^{-15} \\\\ -1.1102230246251565 \\times 10^{-16} \\end{pmatrix} $$\n其分量绝对值为 $|r| = \\begin{pmatrix} 0.0 \\\\ 1.7763568394002505 \\times 10^{-15} \\\\ 1.3322676295501878 \\times 10^{-15} \\\\ 1.1102230246251565 \\times 10^{-16} \\end{pmatrix}$。\n\n第 2 步：计算分母 $d = |U||\\hat{x}| + |y|$。\n我们取 $U$、$\\hat{x}$ 和 $y$ 的分量绝对值：\n$$ |U| = \\begin{pmatrix} 1  2.5  3.1  4.0 \\\\ 0  1  0.75  2.2 \\\\ 0  0  1  1.6 \\\\ 0  0  0  1 \\end{pmatrix}, \\;\\; |\\hat{x}| = \\begin{pmatrix} 37.39650000000001 \\\\ 6.385000000000002 \\\\ 4.140000000000001 \\\\ 0.8999999999999999 \\end{pmatrix}, \\;\\; |y| = \\begin{pmatrix} 5.0 \\\\ 1.3 \\\\ 2.7 \\\\ 0.9 \\end{pmatrix} $$\n接下来，我们计算乘积 $v = |U||\\hat{x}|$：\n$$ v_4 = 1 \\cdot |\\hat{x}_4| = 0.8999999999999999 $$\n$$ v_3 = 1 \\cdot |\\hat{x}_3| + 1.6 \\cdot |\\hat{x}_4| = 4.140000000000001 + 1.6(0.8999999999999999) = 5.580000000000001 $$\n$$ v_2 = 1 \\cdot |\\hat{x}_2| + 0.75 \\cdot |\\hat{x}_3| + 2.2 \\cdot |\\hat{x}_4| = 6.385000000000002 + 0.75(4.140000000000001) + 2.2(0.8999999999999999) = 11.470000000000002 $$\n$$ v_1 = 1 \\cdot |\\hat{x}_1| + 2.5 \\cdot |\\hat{x}_2| + 3.1 \\cdot |\\hat{x}_3| + 4.0 \\cdot |\\hat{x}_4| = 37.39650000000001 + 2.5(6.385000000000002) + 3.1(4.140000000000001) + 4.0(0.8999999999999999) = 69.79300000000002 $$\n因此， $|U||\\hat{x}| = \\begin{pmatrix} 69.79300000000002 \\\\ 11.470000000000002 \\\\ 5.580000000000001 \\\\ 0.8999999999999999 \\end{pmatrix}$。\n最后，分母向量为 $d = |U||\\hat{x}|+|y|$：\n$$ d = \\begin{pmatrix} 69.79300000000002 \\\\ 11.470000000000002 \\\\ 5.580000000000001 \\\\ 0.8999999999999999 \\end{pmatrix} + \\begin{pmatrix} 5.0 \\\\ 1.3 \\\\ 2.7 \\\\ 0.9 \\end{pmatrix} = \\begin{pmatrix} 74.79300000000002 \\\\ 12.770000000000003 \\\\ 8.280000000000001 \\\\ 1.7999999999999998 \\end{pmatrix} $$\n\n第 3 步：计算比率并找到最大值。\n令 $\\rho_i = |r_i|/d_i$。\n$$ \\rho_1 = \\frac{0.0}{74.79300000000002} = 0.0 $$\n$$ \\rho_2 = \\frac{1.7763568394002505 \\times 10^{-15}}{12.770000000000003} \\approx 1.391039 \\times 10^{-16} $$\n$$ \\rho_3 = \\frac{1.3322676295501878 \\times 10^{-15}}{8.280000000000001} \\approx 1.608995 \\times 10^{-16} $$\n$$ \\rho_4 = \\frac{1.1102230246251565 \\times 10^{-16}}{1.7999999999999998} \\approx 6.167906 \\times 10^{-17} $$\n分量形式的后向误差 $\\omega$ 是这些值的最大值：\n$$ \\omega = \\max(0.0, 1.391039 \\times 10^{-16}, 1.608995 \\times 10^{-16}, 6.167906 \\times 10^{-17}) $$\n最大值是 $\\rho_3$，约等于 $1.6089947216789706 \\times 10^{-16}$。\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$ \\omega \\approx 1.609 \\times 10^{-16} $$\n这就是分量形式的后向误差，一个无量纲的标量。", "answer": "$$\n\\boxed{1.609 \\times 10^{-16}}\n$$", "id": "3581065"}]}