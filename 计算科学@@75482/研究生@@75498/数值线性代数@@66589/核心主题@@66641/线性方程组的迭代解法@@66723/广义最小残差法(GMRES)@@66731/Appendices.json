{"hands_on_practices": [{"introduction": "这个练习为理解GMRES方法提供了一个具体的切入点。GMRES的第一步完美体现了其核心思想：在不断扩大的搜索空间中寻找最佳近似解。本练习将此过程简化为一个一维优化问题，要求你在第一个Krylov子空间 $\\mathcal{K}_1$ 中找到最优解。通过完成这个基础计算 [@problem_id:2214790]，你将对贯穿整个算法的残差最小化原则建立起坚实的直觉。", "problem": "广义最小残差（GMRES）方法是一种迭代算法，用于求解线性方程组 $Ax=b$ 的近似解。考虑由矩阵 $A$ 和向量 $b$ 定义的线性系统：\n$$\nA = \\begin{pmatrix} 2  1 \\\\ -1  3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n从初始猜测 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，应用一步GMRES算法求得第一个近似解 $x_1$。将您的答案表示为分量为有理数的列向量。", "solution": "GMRES在仿射空间 $x_{0}+\\mathcal{K}_{1}(A,r_{0})$ 上最小化残差的2-范数，其中 $r_{0}=b-Ax_{0}$ 且 $\\mathcal{K}_{1}(A,r_{0})=\\mathrm{span}\\{r_{0}\\}$。当 $x_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$ 时，我们有\n$$\nr_{0}=b=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\n经过一步GMRES后，$x_{1}$ 的形式为 $x_{1}=x_{0}+\\alpha r_{0}$，其中选择 $\\alpha$ 来最小化\n$$\n\\|b-A(x_{0}+\\alpha r_{0})\\|_{2}=\\|r_{0}-\\alpha A r_{0}\\|_{2}.\n$$\n令 $w=A r_{0}$。则最小化问题为 $\\min_{\\alpha}\\|r_{0}-\\alpha w\\|_{2}^{2}$。使用欧几里得内积，定义\n$$\n\\phi(\\alpha)=(r_{0}-\\alpha w)^{T}(r_{0}-\\alpha w)=r_{0}^{T}r_{0}-2\\alpha w^{T}r_{0}+\\alpha^{2}w^{T}w.\n$$\n令 $\\frac{d\\phi}{d\\alpha}=0$ 得\n$$\n-2\\,w^{T}r_{0}+2\\alpha\\,w^{T}w=0 \\quad\\Rightarrow\\quad \\alpha=\\frac{w^{T}r_{0}}{w^{T}w}.\n$$\n计算 $w$ 和所需的内积：\n$$\nw=A r_{0}=A b=\\begin{pmatrix}2  1\\\\ -1  3\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=\\begin{pmatrix}4\\\\5\\end{pmatrix},\\quad\nw^{T}r_{0}=\\begin{pmatrix}4  5\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=14,\\quad\nw^{T}w=4^{2}+5^{2}=41.\n$$\n因此\n$$\n\\alpha=\\frac{14}{41},\\qquad x_{1}=x_{0}+\\alpha r_{0}=\\frac{14}{41}\\begin{pmatrix}1\\\\2\\end{pmatrix}=\\begin{pmatrix}\\frac{14}{41}\\\\ \\frac{28}{41}\\end{pmatrix}.\n$$\n这个 $x_{1}$ 是GMRES(1)的迭代结果，即在 $x_{0}+\\mathrm{span}\\{r_{0}\\}$ 上残差范数的最小化子。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{14}{41}\\\\ \\frac{28}{41}\\end{pmatrix}}$$", "id": "2214790"}, {"introduction": "在掌握了单步迭代的原理之后，我们现在将深入探讨多步GMRES迭代的完整机制。这个综合性练习将引导你实践构成该方法计算核心的两个关键部分。你将首先使用Arnoldi过程为Krylov子空间构建一个标准正交基，然后利用Givens旋转来求解由此产生的小规模最小二乘问题，以找到解的最佳更新量 [@problem_id:3616841]。这个练习让你能亲手操作，详细地观察算法的实际运行过程。", "problem": "考虑一个小型非对称线性系统，该系统源于线性化地震走时层析成像中使用的一维稳态平流扩散算子的粗糙有限体积离散化。设系统矩阵为\n$$\nA = \\begin{pmatrix}\n1  0  0 \\\\\n1  3  0 \\\\\n0  1  2\n\\end{pmatrix},\n$$\n右端项为\n$$\nb = \\begin{pmatrix}\n1 \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\n初始猜测值为\n$$\nx_0 = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n从初始残差 $r_0 = b - A x_0$ 开始，执行两步阿诺尔迪过程，构建当 $m = 2$ 时的标准正交基 $V_{m+1}$ 和 $(m+1) \\times m$ 的上海森堡矩阵 $\\bar{H}_m$。然后，对 $\\bar{H}_m$ 应用两次连续的吉文斯旋转以消除其次对角线元素，从而得到一个上三角矩阵 $R_m$，同时更新变换后的右端项。利用此结果显式地计算广义最小残差（GMRES）迭代解 $x_m = x_0 + V_m y$ 和残差 $r_m = b - A x_m$。将 $x_m$ 的三个分量和 $r_m$ 的三个分量依次作为一个单行矩阵报告。无需四舍五入，也无需物理单位。在首次使用广义最小残差（GMRES）时对其进行定义，并从第一性原理出发，从克雷洛夫子空间构建和标准正交化开始进行推导。", "solution": "首先验证问题，以确保其是适定的、有科学依据且自洽的。\n\n### 步骤 1：提取已知条件\n- 系统矩阵：$A = \\begin{pmatrix} 1  0  0 \\\\ 1  3  0 \\\\ 0  1  2 \\end{pmatrix}$\n- 右端项向量：$b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n- 初始猜测值：$x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n- GMRES 步数（克雷洛夫子空间维度）：$m = 2$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **有科学依据**：该问题涉及广义最小残差（GMRES）方法，这是数值线性代数中用于求解非对称线性系统的标准基础算法。地震层析成像的背景是此类方法的有效应用领域。该问题在数学上和科学上都是合理的。\n- **适定性**：矩阵 $A$ 是一个 $3 \\times 3$ 的下三角矩阵。其行列式是对角线元素的乘积，即 $\\det(A) = 1 \\cdot 3 \\cdot 2 = 6 \\neq 0$。由于矩阵是非奇异的，系统 $Ax = b$ 存在唯一解。该问题要求执行一个明确定义的算法（GMRES）的特定步数，这将得到一个唯一的迭代解 $x_2$。\n- **客观性**：问题陈述使用了精确的数学定义，不包含任何主观或模糊的语言。\n- **完备性**：所有执行计算所需的数据（$A$、$b$、$x_0$ 和 $m$）均已提供。\n\n### 步骤 3：结论与行动\n该问题有效。将提供详细的解法。\n\n---\n\n广义最小残差（GMRES）方法是一种用于求解线性方程组 $Ax = b$ 的迭代算法，尤其适用于矩阵 $A$ 是大型、稀疏且非对称的情况。从一个初始猜测值 $x_0$ 开始，GMRES 在仿射空间 $x_0 + \\mathcal{K}_m(A, r_0)$ 中寻找一个近似解 $x_m$，其中 $\\mathcal{K}_m(A, r_0) = \\text{span}\\{r_0, Ar_0, \\dots, A^{m-1}r_0\\}$ 是由 $A$ 和初始残差 $r_0 = b - Ax_0$ 生成的 $m$ 阶克雷洛夫子空间。选择迭代解 $x_m$ 以最小化残差的欧几里得范数，即 $x_m = \\arg \\min_{z \\in x_0 + \\mathcal{K}_m} \\|b - Az\\|_2$。\n\n求解过程包括三个主要阶段：\n1.  使用阿诺尔迪过程为克雷洛夫子空间 $\\mathcal{K}_{m+1}(A, r_0)$ 生成一个标准正交基 $V_{m+1}$ 和一个上海森堡矩阵 $\\bar{H}_m$。\n2.  求解一个小型最小二乘问题，以找到向量 $y_m$，该向量使克雷洛夫子空间中的残差最小化。\n3.  计算近似解 $x_m = x_0 + V_m y_m$ 和相应的残差 $r_m = b - A x_m$。\n\n现在我们对给定问题，在 $m=2$ 的情况下执行这些步骤。\n\n**1. 初始设置与阿诺尔迪过程**\n\n首先，计算初始残差 $r_0$：\n$$\nr_0 = b - A x_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 1  3  0 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n其范数为 $\\|r_0\\|_2 = \\sqrt{1^2 + 0^2 + 0^2} = 1$。\n克雷洛夫子空间的第一个基向量是：\n$$\nv_1 = \\frac{r_0}{\\|r_0\\|_2} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n现在，我们执行 $m=2$ 步阿诺尔迪过程。\n\n**步骤 k=1：**\n计算 $w_1 = A v_1$：\n$$\nw_1 = \\begin{pmatrix} 1  0  0 \\\\ 1  3  0 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n将 $w_1$ 与之前的基向量（这里只有 $v_1$）正交化：\n$$\nh_{1,1} = v_1^T w_1 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = 1\n$$\n$$\n\\tilde{w}_1 = w_1 - h_{1,1} v_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - 1 \\cdot \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n计算范数和下一个基向量：\n$$\nh_{2,1} = \\|\\tilde{w}_1\\|_2 = \\sqrt{0^2 + 1^2 + 0^2} = 1\n$$\n$$\nv_2 = \\frac{\\tilde{w}_1}{h_{2,1}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n\n**步骤 k=2：**\n计算 $w_2 = A v_2$：\n$$\nw_2 = \\begin{pmatrix} 1  0  0 \\\\ 1  3  0 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix}\n$$\n将 $w_2$ 与 $v_1$ 和 $v_2$ 正交化：\n$$\nh_{1,2} = v_1^T w_2 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix} = 0\n$$\n$$\nh_{2,2} = v_2^T w_2 = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix} = 3\n$$\n$$\n\\tilde{w}_2 = w_2 - h_{1,2} v_1 - h_{2,2} v_2 = \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix} - 0 \\cdot \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 \\cdot \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n计算范数和下一个基向量：\n$$\nh_{3,2} = \\|\\tilde{w}_2\\|_2 = \\sqrt{0^2 + 0^2 + 1^2} = 1\n$$\n$$\nv_3 = \\frac{\\tilde{w}_2}{h_{3,2}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n阿诺尔迪过程得到标准正交基矩阵 $V_3 = [v_1, v_2, v_3] = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = I$ 和 $(m+1) \\times m = 3 \\times 2$ 的上海森堡矩阵 $\\bar{H}_2$：\n$$\n\\bar{H}_2 = \\begin{pmatrix} h_{1,1}  h_{1,2} \\\\ h_{2,1}  h_{2,2} \\\\ 0  h_{3,2} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 1  3 \\\\ 0  1 \\end{pmatrix}\n$$\n\n**2. 最小二乘问题与吉文斯旋转**\n\nGMRES 迭代解为 $x_m = x_0 + V_m y_m$，其中 $y_m$ 是以下最小二乘问题的解：\n$$\ny_m = \\arg \\min_{y \\in \\mathbb{R}^m} \\| \\|r_0\\|_2 e_1 - \\bar{H}_m y \\|_2\n$$\n对于 $m=2$ 且 $\\|r_0\\|_2=1$，该问题变为：\n$$\ny_2 = \\arg \\min_{y \\in \\mathbb{R}^2} \\left\\| \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 1  3 \\\\ 0  1 \\end{pmatrix} y \\right\\|_2\n$$\n我们通过应用一系列吉文斯旋转将 $\\bar{H}_2$ 变换为一个上三角矩阵 $R_2$ 来解决此问题。\n\n**第一次吉文斯旋转 $\\Omega_1$：**\n为消除元素 $h_{2,1}=1$，我们对第 1 行和第 2 行应用一次旋转。\n设 $a = h_{1,1} = 1$，$b = h_{2,1} = 1$。旋转系数为 $c = \\frac{a}{\\sqrt{a^2+b^2}} = \\frac{1}{\\sqrt{2}}$ 和 $s = \\frac{b}{\\sqrt{a^2+b^2}} = \\frac{1}{\\sqrt{2}}$。\n旋转矩阵为 $\\Omega_1 = \\begin{pmatrix} c  s  0 \\\\ -s  c  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2}  1/\\sqrt{2}  0 \\\\ -1/\\sqrt{2}  1/\\sqrt{2}  0 \\\\ 0  0  1 \\end{pmatrix}$。\n将 $\\Omega_1$ 应用于 $\\bar{H}_2$：\n$$\n\\Omega_1 \\bar{H}_2 = \\begin{pmatrix} 1/\\sqrt{2}  1/\\sqrt{2}  0 \\\\ -1/\\sqrt{2}  1/\\sqrt{2}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  3 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2}  3/\\sqrt{2} \\\\ 0  3/\\sqrt{2} \\\\ 0  1 \\end{pmatrix}\n$$\n将 $\\Omega_1$ 应用于右端项向量 $g = \\|r_0\\|_2 e_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$：\n$$\n\\Omega_1 g = \\begin{pmatrix} 1/\\sqrt{2}  1/\\sqrt{2}  0 \\\\ -1/\\sqrt{2}  1/\\sqrt{2}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\\\ 0 \\end{pmatrix}\n$$\n\n**第二次吉文斯旋转 $\\Omega_2$：**\n为消除位置 $(3,2)$ 上的元素 $1$，我们对变换后系统的第 2 行和第 3 行应用一次旋转。\n设 $a = 3/\\sqrt{2}$，$b = 1$。旋转系数为 $c = \\frac{a}{\\sqrt{a^2+b^2}} = \\frac{3/\\sqrt{2}}{\\sqrt{9/2+1}} = \\frac{3/\\sqrt{2}}{\\sqrt{11/2}} = \\frac{3}{\\sqrt{11}}$ 和 $s = \\frac{b}{\\sqrt{a^2+b^2}} = \\frac{1}{\\sqrt{11/2}} = \\frac{\\sqrt{2}}{\\sqrt{11}}$。\n旋转矩阵为 $\\Omega_2 = \\begin{pmatrix} 1  0  0 \\\\ 0  c  s \\\\ 0  -s  c \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  3/\\sqrt{11}  \\sqrt{2}/\\sqrt{11} \\\\ 0  -\\sqrt{2}/\\sqrt{11}  3/\\sqrt{11} \\end{pmatrix}$。\n将 $\\Omega_2$ 应用于 $\\Omega_1 \\bar{H}_2$：\n$$\n\\Omega_2 (\\Omega_1 \\bar{H}_2) = \\begin{pmatrix} 1  0  0 \\\\ 0  3/\\sqrt{11}  \\sqrt{2}/\\sqrt{11} \\\\ 0  -\\sqrt{2}/\\sqrt{11}  3/\\sqrt{11} \\end{pmatrix} \\begin{pmatrix} \\sqrt{2}  3/\\sqrt{2} \\\\ 0  3/\\sqrt{2} \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2}  3/\\sqrt{2} \\\\ 0  \\frac{9}{\\sqrt{22}} + \\frac{\\sqrt{2}}{\\sqrt{11}} \\\\ 0  \\frac{-3\\sqrt{2}}{\\sqrt{22}} + \\frac{3}{\\sqrt{11}} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2}  3/\\sqrt{2} \\\\ 0  \\sqrt{11/2} \\\\ 0  0 \\end{pmatrix}\n$$\n这就得到了上三角矩阵 $R_2 = \\begin{pmatrix} \\sqrt{2}  3/\\sqrt{2} \\\\ 0  \\sqrt{11/2} \\end{pmatrix}$。\n将 $\\Omega_2$ 应用于变换后的右端项 $\\Omega_1 g$：\n$$\ng' = \\Omega_2 (\\Omega_1 g) = \\begin{pmatrix} 1  0  0 \\\\ 0  3/\\sqrt{11}  \\sqrt{2}/\\sqrt{11} \\\\ 0  -\\sqrt{2}/\\sqrt{11}  3/\\sqrt{11} \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ -3/\\sqrt{22} \\\\ 1/\\sqrt{11} \\end{pmatrix}\n$$\n最小二乘问题现在等价于求解 $R_2 y_2 = g'_1$，其中 $g'_1$ 由 $g'$ 的前两个分量组成。\n$$\n\\begin{pmatrix} \\sqrt{2}  3/\\sqrt{2} \\\\ 0  \\sqrt{11/2} \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ -3/\\sqrt{22} \\end{pmatrix}\n$$\n通过回代求解：\n由第二行得：\n$\\sqrt{11/2} \\cdot y_2 = -3/\\sqrt{22} \\implies y_2 = \\frac{-3}{\\sqrt{22}} \\frac{\\sqrt{2}}{\\sqrt{11}} = \\frac{-3}{\\sqrt{11}\\sqrt{2}} \\frac{\\sqrt{2}}{\\sqrt{11}} = -\\frac{3}{11}$。\n由第一行得：\n$\\sqrt{2} \\cdot y_1 + (3/\\sqrt{2}) y_2 = 1/\\sqrt{2} \\implies \\sqrt{2} \\cdot y_1 + (3/\\sqrt{2})(-3/11) = 1/\\sqrt{2}$。\n$\\sqrt{2} \\cdot y_1 = 1/\\sqrt{2} + 9/(11\\sqrt{2}) = \\frac{11+9}{11\\sqrt{2}} = \\frac{20}{11\\sqrt{2}}$。\n$y_1 = \\frac{20}{11\\sqrt{2}} \\frac{1}{\\sqrt{2}} = \\frac{20}{22} = \\frac{10}{11}$。\n所以，$y_2 = \\begin{pmatrix} 10/11 \\\\ -3/11 \\end{pmatrix}$。\n\n**3. 计算解和残差**\n\nGMRES 迭代解 $x_2$ 为：\n$$\nx_2 = x_0 + V_2 y_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 10/11 \\\\ -3/11 \\end{pmatrix} = \\begin{pmatrix} 10/11 \\\\ -3/11 \\\\ 0 \\end{pmatrix}\n$$\n最终残差 $r_2$ 为：\n$$\nr_2 = b - A x_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 1  3  0 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 10/11 \\\\ -3/11 \\\\ 0 \\end{pmatrix}\n$$\n$$\nA x_2 = \\begin{pmatrix} 1 \\cdot (10/11) \\\\ 1 \\cdot (10/11) + 3 \\cdot (-3/11) \\\\ 1 \\cdot (-3/11) \\end{pmatrix} = \\begin{pmatrix} 10/11 \\\\ 1/11 \\\\ -3/11 \\end{pmatrix}\n$$\n$$\nr_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 10/11 \\\\ 1/11 \\\\ -3/11 \\end{pmatrix} = \\begin{pmatrix} 1/11 \\\\ -1/11 \\\\ 3/11 \\end{pmatrix}\n$$\n最终结果由 $x_2$ 的三个分量和其后 $r_2$ 的三个分量组成。\n$x_2 = (10/11, -3/11, 0)$\n$r_2 = (1/11, -1/11, 3/11)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{10}{11}  -\\frac{3}{11}  0  \\frac{1}{11}  -\\frac{1}{11}  \\frac{3}{11} \\end{pmatrix}\n}\n$$", "id": "3616841"}, {"introduction": "GMRES的性能与系统矩阵的谱特性以及初始残差的性质密切相关。这个概念性练习探讨了一个极具启发性的特殊情况：当初始残差恰好是矩阵的一个特征向量时会发生什么？通过分析这一场景 [@problem_id:3244797]，你将揭示导致GMRES最佳性能（一步收敛）和最差性能之一（完全停滞）的条件。理解这些极端情况将使你对控制算法收敛性的因素有更深刻的认识。", "problem": "考虑在复数域上将非预处理的广义最小残差方法（GMRES）应用于线性系统 $A x = b$，其中 $A \\in \\mathbb{C}^{n \\times n}$ 且 $b \\in \\mathbb{C}^{n}$。设初始猜测为 $x_0 \\in \\mathbb{C}^{n}$，初始残差为 $r_0 = b - A x_0$。假设线性系统是相容的（即，至少存在一个 $x \\in \\mathbb{C}^{n}$ 使得 $A x = b$）。GMRES 在第 $k$ 次迭代时，在 $x_0 + \\mathcal{K}_k(A, r_0)$ 中寻找一个 $x_k$，使得残差范数 $\\|b - A x_k\\|_2$ 最小化，其中第 $k$ 个克雷洛夫子空间为 $\\mathcal{K}_k(A, r_0) = \\operatorname{span}\\{r_0, A r_0, \\dots, A^{k-1} r_0\\}$。\n\n进一步假设 $r_0$ 是 $A$ 的一个特征向量，其特征值为 $\\lambda \\in \\mathbb{C}$，即 $A r_0 = \\lambda r_0$。\n\n在这些假设下，选择所有正确的陈述。\n\nA. 如果 $\\lambda \\neq 0$，非重启动的 GMRES 在 1 次迭代内收敛到一个（可能不唯一的）精确解。\n\nB. 如果 $\\lambda = 0$，那么对于所有 $k \\geq 1$，GMRES 的残差范数满足 $\\|r_k\\|_2 = \\|r_0\\|_2$，即 GMRES 完全停滞。\n\nC. 对于每个 $k \\geq 1$，克雷洛夫子空间 $\\mathcal{K}_k(A, r_0)$ 的维数最多为 1。\n\nD. 如果 $\\lambda$ 不是实数，那么即使在 $\\mathbb{C}$ 上，GMRES 也无法在任何迭代中减小残差范数。\n\nE. 对于任何重启动参数 $m \\geq 1$，重启动的 GMRES$(m)$ 要么在 $\\lambda \\neq 0$ 时在 1 次迭代内收敛，要么在 $\\lambda = 0$ 时完全停滞，这与非重启动的行为一致。", "solution": "用户提供了一个关于广义最小残差（GMRES）方法在特定条件下行为的问题陈述。我将首先验证问题陈述，然后进行完整的求解并评估各个选项。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 方法：非预处理的广义最小残差方法（GMRES）。\n- 线性系统：$A x = b$，其中 $A \\in \\mathbb{C}^{n \\times n}$，$b \\in \\mathbb{C}^{n}$。\n- 初始猜测：$x_0 \\in \\mathbb{C}^{n}$。\n- 初始残差：$r_0 = b - A x_0$。\n- 系统属性：假设线性系统是相容的。\n- GMRES 目标：在第 $k$ 次迭代时，寻找 $x_k \\in x_0 + \\mathcal{K}_k(A, r_0)$ 以最小化 $\\|b - A x_k\\|_2$。\n- 克雷洛夫子空间：$\\mathcal{K}_k(A, r_0) = \\operatorname{span}\\{r_0, A r_0, \\dots, A^{k-1} r_0\\}$。\n- 特殊条件：$r_0$ 是 $A$ 的一个特征向量，其特征值为 $\\lambda \\in \\mathbb{C}$，即 $A r_0 = \\lambda r_0$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于数值线性代数中完善的理论，特别是求解线性系统的迭代方法。GMRES、克雷洛夫子空间、特征向量和特征值都是标准的、严格定义的数学概念。\n- **适定性**：该问题是适定的。它提出了一套明确的假设，并要求基于这些假设对具体陈述进行评估。可以推导出一组确定的正确结论。\n- **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n- **完整性与一致性**：问题陈述是自洽的。诸如系统 $A x = b$ 的相容性和 $r_0$ 的特征向量属性等假设都已明确陈述，并构成了分析的一致基础。虽然 $r_0$ 是特征向量这一条件是一种特殊情况，但它并不矛盾。\n\n**步骤3：结论与行动**\n问题陈述是有效的。这是一个关于 GMRES 算法性质的标准（尽管是特定的）问题。我将继续推导解答。\n\n### 推导与解答\n\n非预处理 GMRES 方法在第 $k$ 次迭代的核心是寻找一个形式为 $x_k = x_0 + z_{k-1}$ 的近似解，其中 $z_{k-1} \\in \\mathcal{K}_k(A, r_0)$，该解能最小化残差 $r_k = b - A x_k$ 的欧几里得范数。\n\n残差可以表示为：\n$$r_k = b - A(x_0 + z_{k-1}) = (b - A x_0) - A z_{k-1} = r_0 - A z_{k-1}$$\n由于 $z_{k-1} \\in \\mathcal{K}_k(A, r_0)$，它可以写成克雷洛夫基向量的线性组合：\n$$z_{k-1} = c_0 r_0 + c_1 A r_0 + \\dots + c_{k-1} A^{k-1} r_0$$\n对于某些标量 $c_0, c_1, \\dots, c_{k-1} \\in \\mathbb{C}$。\n\n关键假设是 $r_0$ 是 $A$ 的一个特征向量，其特征值为 $\\lambda$，所以 $A r_0 = \\lambda r_0$。这对克雷洛夫子空间的结构有深远的影响。通过归纳法，我们可以证明对于任何整数 $j \\ge 0$，$A^j r_0 = \\lambda^j r_0$。\n- 基本情况（$j=1$）：$A^1 r_0 = \\lambda^1 r_0$ 是给定的。\n- 归纳步骤：假设 $A^j r_0 = \\lambda^j r_0$。那么 $A^{j+1} r_0 = A(A^j r_0) = A(\\lambda^j r_0) = \\lambda^j (A r_0) = \\lambda^j (\\lambda r_0) = \\lambda^{j+1} r_0$。\n\n因此，第 $k$ 个克雷洛夫子空间是：\n$$\\mathcal{K}_k(A, r_0) = \\operatorname{span}\\{r_0, \\lambda r_0, \\lambda^2 r_0, \\dots, \\lambda^{k-1} r_0\\}$$\n如果 $r_0 = 0$，初始猜测 $x_0$ 是一个精确解，问题就变得微不足道了。我们假设 $r_0 \\neq 0$。在这种情况下，克雷洛夫子空间的所有生成向量都是 $r_0$ 的标量倍。因此，该子空间本身就是 $r_0$ 的张成空间：\n$$\\mathcal{K}_k(A, r_0) = \\operatorname{span}\\{r_0\\} \\quad \\text{for all } k \\ge 1$$\n这意味着用于更新的搜索空间的维数最多为 1，并且不随 $k$ 增加。\n\n任何向量 $z_{k-1} \\in \\mathcal{K}_k(A, r_0)$ 都可以写成 $z_{k-1} = \\alpha r_0$ 的形式，其中 $\\alpha \\in \\mathbb{C}$ 是某个标量。GMRES 的迭代解是 $x_k = x_0 + \\alpha r_0$。相应的残差是：\n$$r_k = r_0 - A(\\alpha r_0) = r_0 - \\alpha (A r_0) = r_0 - \\alpha (\\lambda r_0) = (1 - \\alpha \\lambda) r_0$$\nGMRES 选择 $\\alpha$ 以最小化 $\\|r_k\\|_2 = \\|(1 - \\alpha \\lambda) r_0\\|_2 = |1 - \\alpha \\lambda| \\|r_0\\|_2$。由于我们假设 $r_0 \\neq 0$，这等价于最小化标量因子 $|1 - \\alpha \\lambda|$。\n\n我们根据 $\\lambda$ 的值分析两种情况。\n\n**情况1：$\\lambda \\neq 0$**\n由于 $\\lambda \\in \\mathbb{C}$ 是非零的，我们可以选择标量 $\\alpha \\in \\mathbb{C}$ 为 $\\alpha = 1/\\lambda$。通过这个选择：\n$$|1 - \\alpha \\lambda| = |1 - (1/\\lambda)\\lambda| = |1-1| = 0$$\n这意味着最小残差范数为 0。这个最小值在第一次迭代（$k=1$）时就达到了，此时搜索空间为 $\\mathcal{K}_1(A, r_0) = \\operatorname{span}\\{r_0\\}$。GMRES 将找到这个最优的 $\\alpha$ 并产生一个残差 $r_1=0$。因此，$x_1$ 是一个精确解，方法在 1 次迭代内收敛。\n\n**情况2：$\\lambda = 0$**\n如果特征值为 $\\lambda = 0$，残差表达式变为：\n$$r_k = (1 - \\alpha \\cdot 0) r_0 = r_0$$\n无论如何选择 $\\alpha$，残差 $r_k$ 都等于 $r_0$。残差范数为 $\\|r_k\\|_2 = \\|r_0\\|_2$，无法减小。该方法从第一次迭代开始就完全停滞。\n\n现在我们来评估每个陈述。\n\n### 逐项分析\n\n**A. 如果 $\\lambda \\neq 0$，非重启动的 GMRES 在 1 次迭代内收敛到一个（可能不唯一的）精确解。**\n如情况1中所推导，如果 $\\lambda \\neq 0$，GMRES 找到一个系数 $\\alpha = 1/\\lambda$，使得残差 $r_1$ 等于零向量。这意味着 $x_1 = x_0 + (1/\\lambda)r_0$ 是一个精确解。问题陈述保证了至少存在一个解（系统是相容的）。如果 $A$ 是奇异的，解可能不唯一，但 $x_1$ 将是其中一个解。因此，该陈述是准确的。\n**结论：正确**\n\n**B. 如果 $\\lambda = 0$，那么对于所有 $k \\geq 1$，GMRES 的残差范数满足 $\\|r_k\\|_2 = \\|r_0\\|_2$，即 GMRES 完全停滞。**\n如情况2中所推导，如果 $\\lambda = 0$，任何步骤 $k$ 的残差都是 $r_k = r_0$。因此最小残差范数为 $\\|r_0\\|_2$。残差范数完全不减小。这就是完全停滞的定义。系统 $Ax=b$ 的相容性与 $Ar_0=0$ 相结合，意味着 $r_0$ 必须位于 $A$ 的值域中，这是该情景在数学上成立的必要条件，但题目前提保证了这一点。停滞的结论成立。\n**结论：正确**\n\n**C. 对于每个 $k \\geq 1$，克雷洛夫子空间 $\\mathcal{K}_k(A, r_0)$ 的维数最多为 1。**\n如初始推导中所示，$A^j r_0 = \\lambda^j r_0$ 对于所有 $j \\ge 0$ 成立。子空间 $\\mathcal{K}_k(A, r_0)$ 是向量 $\\{r_0, \\lambda r_0, \\dots, \\lambda^{k-1} r_0\\}$ 的张成空间，所有这些向量都与 $r_0$ 共线。如果 $r_0 \\neq 0$，该子空间的维数恰好为 1。如果 $r_0 = 0$，维数为 0。在所有情况下，维数最多为 1。\n**结论：正确**\n\n**D. 如果 $\\lambda$ 不是实数，那么即使在 $\\mathbb{C}$ 上，GMRES 也无法在任何迭代中减小残差范数。**\n一个非实数的 $\\lambda$ 是 $\\lambda \\neq 0$ 的一个特例。根据对选项 A 的分析，对于任何非零的 $\\lambda \\in \\mathbb{C}$（包括非实数值），GMRES 都可以找到一个复标量 $\\alpha = 1/\\lambda$，在一次迭代中将残差范数减小到 0。因此，这个陈述是错误的。\n**结论：错误**\n\n**E. 对于任何重启动参数 $m \\geq 1$，重启动的 GMRES$(m)$ 要么在 $\\lambda \\neq 0$ 时在 1 次迭代内收敛，要么在 $\\lambda = 0$ 时完全停滞，这与非重启动的行为一致。**\nGMRES($m$) 执行最多 $m$ 次标准 GMRES 迭代，然后重启动。\n- 如果 $\\lambda \\neq 0$：如 A 所示，GMRES 的第一个（非重启动）循环将在其第一步（$k=1$）就找到精确解。算法将在得到精确解时终止，而无需完成第一个 $m$ 步循环或重启动。因此，它在 1 次迭代内收敛。\n- 如果 $\\lambda = 0$：在第一个 $m$ 步的循环中，对于所有 $k \\in \\{1, \\dots, m\\}$，残差保持为 $r_k = r_0$。在循环结束时，新的近似解是 $x_m$，残差是 $r_m = r_0$。方法以新的初始猜测 $x_{_0}^{\\prime} = x_m$ 重启动。新的初始残差是 $r_{_0}^{\\prime} = b - A x_{_0}^{\\prime} = b - A x_m = r_m = r_0$。下一个循环的条件与原始问题相同：初始残差是 $r_0$，它是 $A$ 的一个特征向量，特征值为 $\\lambda=0$。这个过程将重复，残差永远不会减小。这是完全停滞。\n该陈述准确地描述了两种情况下的行为。\n**结论：正确**", "answer": "$$\\boxed{ABCE}$$", "id": "3244797"}]}