## 引言
[QR算法](@entry_id:145597)是[数值线性代数](@entry_id:144418)中用于解决[矩阵特征值问题](@entry_id:142446)的基石。它以其稳健性和可靠性而著称，构成了许多现代[科学计算](@entry_id:143987)软件库的核心。然而，在其高效的实用版本之下，隐藏着一个更简单、更具启发性的形式——[无位移QR算法](@entry_id:756287)。理解这一基础算法的工作原理是掌握更高级[特征值计算](@entry_id:145559)技术的关键第一步。

本文旨在深入剖析[无位移QR算法](@entry_id:756287)，填补从简单定义到深刻理解其行为之间的知识鸿沟。我们将揭示为何一个简单的迭代过程 ($A_k \to Q_kR_k \to A_{k+1}=R_kQ_k$) 能够神奇地揭示出矩阵的[特征值](@entry_id:154894)。

在接下来的章节中，您将学习到：首先，在“原理与机制”部分，我们将剖析算法的迭代过程、收敛目标（舒尔形式）以及其与[子空间迭代](@entry_id:168266)之间深刻的数学联系。接着，在“应用与跨学科联系”部分，我们将探讨其在实际计算中的优化策略，并揭示其在动力系统和计算力学等领域的广泛应用。最后，通过“动手实践”部分的一系列练习，您将有机会亲手计算和分析，从而巩固这些核心理论知识。

## 原理与机制

本章深入探讨了[无位移QR算法](@entry_id:756287)的数学原理和核心机制。在前一章介绍其背景和应用之后，我们现在将剖析该算法的迭代过程、收敛目标、驱动其收敛的深层联系，以及在各种情况下的具体表现。

### 无位移QR迭代：定义与核心机制

[无位移QR算法](@entry_id:756287)是一种用于计算[矩阵特征值](@entry_id:156365)的迭代方法。其核心思想是通过一系列**正交[相似变换](@entry_id:152935)**（orthogonal similarity transformations）逐步将一个矩阵转化为更简单的形式（如上三角或[对角形式](@entry_id:264850)），同时保持其[特征值](@entry_id:154894)不变。

算法的定义如下：给定一个实数方阵 $A \in \mathbb{R}^{n \times n}$，我们构造一个矩阵序列 $\{A_k\}_{k=0}^{\infty}$。

1.  初始化：$A_0 = A$。
2.  迭代步骤：对于 $k=0, 1, 2, \dots$，
    a.  对 $A_k$ 进行 **QR分解**（QR factorization），得到 $A_k = Q_k R_k$，其中 $Q_k$ 是一个**正交矩阵**（orthogonal matrix，$Q_k^\top Q_k = I$），$R_k$ 是一个**[上三角矩阵](@entry_id:150931)**（upper triangular matrix）。
    b.  以相反的顺序乘以上述因子，构造下一个矩阵：$A_{k+1} = R_k Q_k$。

这个过程的精妙之处在于，每一步生成的 $A_{k+1}$ 都与 $A_k$ **相似**（similar）。由于 $Q_k$ 是正交的，我们可以从 $A_k = Q_k R_k$ 推导出 $R_k = Q_k^\top A_k$。将其代入 $A_{k+1}$ 的定义中，我们得到：

$$
A_{k+1} = R_k Q_k = (Q_k^\top A_k) Q_k = Q_k^\top A_k Q_k
$$

这表明 $A_{k+1}$ 是通过对 $A_k$ 进行正交相似变换得到的。由于[相似变换](@entry_id:152935)不改变矩阵的[特征值](@entry_id:154894)，因此序列中的所有矩阵 $A_0, A_1, A_2, \dots$ 都拥有与初始矩阵 $A$ 完全相同的[特征值](@entry_id:154894)谱。[QR算法](@entry_id:145597)的本质就是通过这种迭代方式，使得矩阵的[特征值](@entry_id:154894)信息从其复杂的结构中逐渐“浮现”到更明显的位置（通常是对角线）。

为了具体理解这一过程，我们来看一个简单的例子 [@problem_id:3598477]。考虑一个 $2 \times 2$ 的[实对称矩阵](@entry_id:192806)：

$$
A_0 = \begin{pmatrix} 2  1 \\ 1  2 \end{pmatrix}
$$

**第一次迭代 (计算 $A_1$)**:

我们首先需要对 $A_0$ 进行QR分解。这可以通过对 $A_0$ 的列向量应用**[格拉姆-施密特正交化](@entry_id:143035)**（Gram-Schmidt process）来实现。设 $A_0$ 的列向量为 $a_1 = \begin{pmatrix} 2 \\ 1 \end{pmatrix}$ 和 $a_2 = \begin{pmatrix} 1 \\ 2 \end{pmatrix}$。

正交化过程产生正交矩阵 $Q_0$ 的列 $q_1, q_2$：
$q_1 = \frac{1}{\sqrt{5}} \begin{pmatrix} 2 \\ 1 \end{pmatrix}$
$q_2 = \frac{1}{\sqrt{5}} \begin{pmatrix} -1 \\ 2 \end{pmatrix}$

因此，$Q_0 = \frac{1}{\sqrt{5}} \begin{pmatrix} 2  -1 \\ 1  2 \end{pmatrix}$。
[上三角矩阵](@entry_id:150931) $R_0$ 可以通过 $R_0 = Q_0^\top A_0$ 计算得到：

$$
R_0 = \frac{1}{\sqrt{5}} \begin{pmatrix} 2  1 \\ -1  2 \end{pmatrix} \begin{pmatrix} 2  1 \\ 1  2 \end{pmatrix} = \frac{1}{\sqrt{5}} \begin{pmatrix} 5  4 \\ 0  3 \end{pmatrix}
$$

接下来，我们计算 $A_1 = R_0 Q_0$：

$$
A_1 = \left( \frac{1}{\sqrt{5}} \begin{pmatrix} 5  4 \\ 0  3 \end{pmatrix} \right) \left( \frac{1}{\sqrt{5}} \begin{pmatrix} 2  -1 \\ 1  2 \end{pmatrix} \right) = \frac{1}{5} \begin{pmatrix} 14  3 \\ 3  6 \end{pmatrix}
$$

注意到 $A_1$ 仍然是一个[对称矩阵](@entry_id:143130)，其非对角元素 $\frac{3}{5}$ 的[绝对值](@entry_id:147688)小于 $A_0$ 的非对角元素 $1$。这暗示着矩阵正在向[对角形式](@entry_id:264850)收敛。

**第二次迭代 (计算 $A_2$)**:

我们对 $A_1 = \frac{1}{5} \begin{pmatrix} 14  3 \\ 3  6 \end{pmatrix}$ 重复相同的过程。计算其QR分解 $A_1 = Q_1 R_1$ 并构造 $A_2 = R_1 Q_1$。经过类似的计算 [@problem_id:3598477]，我们得到：

$$
A_2 = \frac{1}{41} \begin{pmatrix} 122  9 \\ 9  42 \end{pmatrix} \approx \begin{pmatrix} 2.9756  0.2195 \\ 0.2195  1.0244 \end{pmatrix}
$$

我们可以观察到，非对角元素 $\frac{9}{41} \approx 0.2195$ 进一步减小。同时，对角元素 $(A_2)_{11} \approx 2.9756$ 和 $(A_2)_{22} \approx 1.0244$ 正在逼近 $A_0$ 的真实[特征值](@entry_id:154894) $\lambda_1 = 3$ 和 $\lambda_2 = 1$。

在实际计算中，对于更大的矩阵，[格拉姆-施密特过程](@entry_id:141060)存在数值不稳定性。更稳健的QR分解方法，如**[豪斯霍尔德变换](@entry_id:168808)**（Householder transformations）[@problem_id:3598498] 或**[吉文斯旋转](@entry_id:167475)**（Givens rotations），被广泛使用。这些方法通过一系列正交反射或旋转，系统地将矩阵的次对角[线元](@entry_id:196833)素清零，从而得到上三角形式。

### 迭代的目标：收敛于舒尔形式

[QR算法](@entry_id:145597)迭代的最终目标是什么？对于任意方阵，这个目标由**[舒尔分解](@entry_id:155150)定理**（Schur decomposition theorem）给出。该定理指出，任何一个复方阵 $A \in \mathbb{C}^{n \times n}$ 都可以被酉相似变换（unitary similarity transformation）为一个上三角矩阵 $T$：

$$
A = U T U^*
$$

其中 $U$ 是一个**[酉矩阵](@entry_id:138978)**（unitary matrix，$U^* U = I$），$T$ 是上三角矩阵。$T$ 的对角[线元](@entry_id:196833)素恰好是 $A$ 的[特征值](@entry_id:154894)。这个 $T$ 被称为 $A$ 的**复舒尔形式**（complex Schur form）。

然而，当我们的初始矩阵 $A$ 是实矩阵时，我们通常希望在实数算术内完成所有计算。如果 $A$ 拥有复数[特征值](@entry_id:154894)，它们必然以共轭对（$\mu \pm i\nu$）的形式出现。在这种情况下，不可能将 $A$ 通过实[正交变换](@entry_id:155650)完全三角化。取而代之的目标是**[实舒尔形式](@entry_id:190856)**（real Schur form） [@problem_id:3598476]。

[实舒尔分解](@entry_id:156451)定理表明，任何实方阵 $A \in \mathbb{R}^{n \times n}$ 都可以被正交[相似变换](@entry_id:152935)为一个**拟上三角矩阵**（quasi-upper triangular matrix）$T$：

$$
A = Q T Q^\top
$$

其中 $Q$ 是实[正交矩阵](@entry_id:169220)，$T$ 是一个块[上三角矩阵](@entry_id:150931)。$T$ 的对角线由两种类型的块组成：
-   $1 \times 1$ 的块，其值为 $A$ 的实[特征值](@entry_id:154894)。
-   $2 \times 2$ 的块，其[特征值](@entry_id:154894)为 $A$ 的一对[复共轭](@entry_id:174690)[特征值](@entry_id:154894)。

[无位移QR算法](@entry_id:756287)的收敛目标正是这个[实舒尔形式](@entry_id:190856)。随着迭代次数 $k$ 的增加，矩阵 $A_k$ 会逐渐趋近于一个拟[上三角矩阵](@entry_id:150931)，其非对角线（或块非对角线）元素趋于零。

### 收敛的引擎：与[子空间迭代](@entry_id:168266)的深刻联系

为什么 $A_{k+1} = R_k Q_k$ 这样简单的操作能够导向深刻的舒尔形式？其背后的驱动力在于[QR算法](@entry_id:145597)与一个更基本的概念——**[子空间迭代](@entry_id:168266)**（subspace iteration），或称**同时[幂迭代](@entry_id:141327)**（simultaneous power iteration）——之间存在着代数等价性 [@problem_id:3598454]。

让我们定义累积的正交变换矩阵 $\mathcal{Q}_k = Q_0 Q_1 \cdots Q_{k-1}$ 和累积的[上三角矩阵](@entry_id:150931) $\mathcal{R}_k = R_{k-1} \cdots R_0$。通过对QR迭代关系进行归纳，可以证明一个至关重要的恒等式：

$$
A^k = (Q_0 Q_1 \cdots Q_{k-1})(R_{k-1} \cdots R_0) = \mathcal{Q}_k \mathcal{R}_k
$$

这个等式表明，$\mathcal{Q}_k \mathcal{R}_k$ 恰好是矩阵 $A$ 的 $k$ 次幂 $A^k$ 的QR分解。这意味着，[QR算法](@entry_id:145597)中产生的累积[正交矩阵](@entry_id:169220) $\mathcal{Q}_k$ 的列向量，构成了对 $A^k$ 的列向量进行正交化后得到的标准正交基。

这正是[子空间迭代](@entry_id:168266)的核心思想。基本的**幂法**（power method）通过反[复乘](@entry_id:168088)以 $A$ 来找到模最大的[特征值](@entry_id:154894)对应的[特征向量](@entry_id:151813)，因为 $A^k v$ 中与模最大[特征值](@entry_id:154894)相关的分量会以指数级速度增长，主导整个向量的方向。[子空间迭代](@entry_id:168266)将此思想推广到一组向量：它通过反复将 $A$ 应用于一个[子空间](@entry_id:150286)，并定期进行正交化（以防止所有向量都收敛到同一个主导方向），来同时逼近多个[特征向量](@entry_id:151813)或[不变子空间](@entry_id:152829)。

[QR算法](@entry_id:145597)可以被看作是一种特别优雅的[子空间迭代](@entry_id:168266)实现。假设 $A$ 的[特征值](@entry_id:154894)按模严格递减，即 $|\lambda_1| > |\lambda_2| > \cdots > |\lambda_n| > 0$。[子空间迭代](@entry_id:168266)理论告诉我们，$\mathcal{Q}_k$ 的前 $j$ 个列向量所张成的[子空间](@entry_id:150286)，将收敛到由 $A$ 的前 $j$ 个（按模排序）[特征向量](@entry_id:151813)所张成的**主导[不变子空间](@entry_id:152829)**（dominant invariant subspace）。

由于 $A_k = \mathcal{Q}_k^\top A \mathcal{Q}_k$，这意味着 $A_k$ 是 $A$ 在这个由 $\mathcal{Q}_k$ 的列构成的基下的表示。当这个基收敛到能够将 $A$ 按[特征值](@entry_id:154894)模长排序的舒尔向量基时，$A_k$ 自然就收敛到了一个上三角形式，其对角[线元](@entry_id:196833)素近似按模长递减的顺序[排列](@entry_id:136432)着 $A$ 的[特征值](@entry_id:154894) [@problem_id:3598454] [@problem_id:3598512]。

对于一种重要的特殊矩阵——**上黑森贝格矩阵**（upper Hessenberg matrix，即 $A_{ij} = 0$ 对所有 $i > j+1$），[QR算法](@entry_id:145597)与**克雷洛夫子空间**（Krylov subspace）之间存在直接联系。可以证明，如果 $A_0$ 是一个上黑森贝格矩阵，其[QR分解](@entry_id:139154) $A_0 = Q_0 R_0$ 得到的 $Q_0$ 的前 $m$ 列所张成的[子空间](@entry_id:150286)，恰好等于由 $A_0$ 和[标准基向量](@entry_id:152417) $e_1$ 生成的 $m$ 阶克雷洛夫子空间 $\mathcal{K}_m(A_0, e_1) = \operatorname{span}\{e_1, A_0 e_1, \dots, A_0^{m-1} e_1\}$ [@problem_id:3598465]。这进一步揭示了[QR算法](@entry_id:145597)与矩阵多项式和[子空间方法](@entry_id:200957)之间的深层结构关联。

### 收敛的量化分析

我们已经从定性上理解了[QR算法](@entry_id:145597)的收敛性，现在我们来探讨其收敛速度。对于一个上黑森贝格矩阵（[QR算法](@entry_id:145597)的每一步都保持此结构），我们可以推导出次对角[线元](@entry_id:196833)素的收敛速度 [@problem_id:3598512]。

设 $b_{i+1,i}^{(k)}$ 为矩阵 $A_k$ 的 $(i+1, i)$ 位置的次对角线元素。通过分析QR迭代的定义 $A_k = Q_k R_k$ 和 $A_{k+1} = R_k Q_k$，可以建立一个[递推关系](@entry_id:189264)：

$$
b_{i+1,i}^{(k+1)} = b_{i+1,i}^{(k)} \frac{(R_k)_{i+1,i+1}}{(R_k)_{i,i}}
$$

当 $k \to \infty$ 时，$A_k$ 趋于上三角舒尔形式 $T$，其对角元为按模排序的[特征值](@entry_id:154894) $T_{ii} = \lambda_i$。同时，$R_k$ 的对角元 $|(R_k)_{ii}|$ 也将收敛到[特征值](@entry_id:154894)的模 $|\lambda_i|$。因此，我们可以得到次对角线元素模的渐进行为：

$$
\lim_{k \to \infty} \frac{|b_{i+1,i}^{(k+1)}|}{|b_{i+1,i}^{(k)}|} = \frac{|\lambda_{i+1}|}{|\lambda_i|}
$$

这个结果表明，[无位移QR算法](@entry_id:756287)的收敛是**线性**的，其收敛因子由相邻[特征值](@entry_id:154894)（按模排序后）的模长之比决定。这个比值越小，收敛越快。这为我们之前的定性观察提供了坚实的定量依据：[特征值](@entry_id:154894)的模长分离得越好，算法收敛得越快。

### 病态行为与实际考量

尽管[无位移QR算法](@entry_id:756287)在理论上很优美，但在实践中存在一些局限性，了解这些“病态”行为对于理解现代[QR算法](@entry_id:145597)的演进至关重要。

#### 收敛停滞：模长相等的[特征值](@entry_id:154894)

当矩阵存在两个或多个模长相等的[特征值](@entry_id:154894)时，即 $|\lambda_i| = |\lambda_{i+1}|$，[收敛速度](@entry_id:636873)公式中的比值为 $1$。这意味着对应的次对角[线元](@entry_id:196833)素 $b_{i+1,i}^{(k)}$ 将不会收敛到零。这是因为[子空间迭代](@entry_id:168266)无法区分模长相同的特征方向。

例如，如果一个实矩阵有一对[特征值](@entry_id:154894) $\{2, -2\}$，它们的模长都等于 $2$ [@problem_id:3598456]。[无位移QR算法](@entry_id:756287)将能够将矩阵分解为一个块上三角形式，其中一个 $2 \times 2$ 的块对应于这对[特征值](@entry_id:154894)。然而，算法无法进一步将这个 $2 \times 2$ 的块三角化（即所谓的**“放缩”**或**deflation**失败）。这个块的次对角[线元](@entry_id:196833)素会持续存在，导致收敛停滞。这是推动使用**位移策略**（shifting strategies）来打破这种对称性、加速收敛的最主要原因。

#### [非正规矩阵](@entry_id:752668)与[瞬时增长](@entry_id:263654)

对于**[正规矩阵](@entry_id:185943)**（normal matrix，满足 $A A^* = A^* A$），如对称矩阵或反对称矩阵，[QR算法](@entry_id:145597)的收敛过程通常是单调的，即非对角元素的范数会随着迭代稳定下降。

然而，对于**[非正规矩阵](@entry_id:752668)**（non-normal matrix），情况可能大不相同。特别是当矩阵的[特征向量](@entry_id:151813)高度非正交（即[特征基](@entry_id:151409)接近线性相关）时，QR迭代过程中的非对角元素在最终衰减之前，可能会经历一个显著的**[瞬时增长](@entry_id:263654)**（transient growth）阶段 [@problem_id:3598474]。

这种现象的根源在于[非正规矩阵](@entry_id:752668)的幂 $\|A^k\|$ 即使在谱半径 $\rho(A)  1$ 时也可能在初期急剧增长。由于[QR算法](@entry_id:145597)与对 $A^k$ 的列进行[正交化](@entry_id:149208)等价，这种内在的增长行为会传递到 $A_k$ 的结构中，导致其非对角元素暂时变大。一个矩阵的[非正规性](@entry_id:752585)程度可以通过其[换位子](@entry_id:158878) $\|A^*A - AA^*\|$ 的范数来衡量。初始的正交[相似变换](@entry_id:152935)（如将[矩阵化](@entry_id:751739)为黑森贝格形式）会保持这种[非正规性](@entry_id:752585)，因此即使在高效的[隐式QR算法](@entry_id:750559)中，[瞬时增长](@entry_id:263654)的可能性依然存在 [@problem_id:3598474]。

#### [对称矩阵](@entry_id:143130)的理想情况

当 $A$ 是一个[实对称矩阵](@entry_id:192806)时，其所有[特征值](@entry_id:154894)都是实数，且存在一组标准正交的[特征向量](@entry_id:151813)。在这种情况下，[实舒尔形式](@entry_id:190856)是对角矩阵 $\Lambda$。[无位移QR算法](@entry_id:756287)表现得非常好：
-   $A_k$ 收敛于一个[对角矩阵](@entry_id:637782)，其对角元素为 $A$ 的[特征值](@entry_id:154894)。
-   累积的正交矩阵 $\mathcal{Q}_k$ 收敛于由 $A$ 的标准[正交特征向量](@entry_id:155522)构成的矩阵。

我们可以通过数值实验清晰地观察到这一过程，即 $\mathcal{Q}_k$ 的列向量与真实的[特征向量](@entry_id:151813)之间的夹角会随着迭代次数的增加而迅速趋于零 [@problem_id:3598511]。

#### 缩放效应

在实现算法时，一个实际问题是算法对输入矩阵的缩放是否敏感。考虑将算法应用于 $\alpha A$（其中 $\alpha > 0$）而不是 $A$。通过归纳法可以证明，在每一步中，若 $A_k = Q_k R_k$，则 $(\alpha A)_k = \alpha A_k$，并且对应的[QR分解](@entry_id:139154)因子满足 $Q_k^{(\alpha)} = Q_k$ 和 $R_k^{(\alpha)} = \alpha R_k$ [@problem_id:3598499]。

这意味着：
-   **绝对收敛判据**（如 $\|\operatorname{Off}(A_k)\|_F \le \tau$）是**尺度敏感**的。对 $\alpha A$ 应用此判据等价于对 $A$ 应用 $\|\operatorname{Off}(A_k)\|_F \le \tau/\alpha$，所需的迭代次数会随 $\alpha$ 的变化而变化。
-   **相对[收敛判据](@entry_id:158093)**（如 $\|\operatorname{Off}(A_k)\|_F / \|A_k\|_F \le \varepsilon$）是**尺度不变**的。因为分子和分母都会被 $\alpha$ 同等缩放，其比值保持不变。

因此，在设计[QR算法](@entry_id:145597)的[停止准则](@entry_id:136282)时，使用相对度量通常是更稳健的选择。

总之，[无位移QR算法](@entry_id:756287)虽然简单，但它揭示了[矩阵特征值](@entry_id:156365)计算中许多深刻的数学联系。其收敛性根植于幂法和[子空间迭代](@entry_id:168266)，其效率取决于[特征值](@entry_id:154894)的分离情况，其行为则反映了矩阵的正规性。对这些原理的理解，是掌握更高级的实用[特征值算法](@entry_id:139409)（如[带位移的QR算法](@entry_id:149245)）的基石。