{"hands_on_practices": [{"introduction": "对于正规矩阵，其特征向量矩阵 $V$ 可以选择为酉矩阵，此时其谱条件数 $\\kappa_2(V) = 1$。Bauer-Fike 定理的界限因此简化为一个优雅的形式，表明特征值的位移量不超过扰动的大小。本练习旨在通过构造一个特定的秩一扰动，来精确地达到这个理论上限，从而证明对于正规矩阵，Bauer-Fike 界是紧的（sharp）[@problem_id:3585033]。这个构造清晰地揭示了定理在理想条件下的行为。", "problem": "设 $n \\geq 2$ 且设 $A \\in \\mathbb{C}^{n \\times n}$ 为一个正规矩阵，因此存在一个酉矩阵 $U \\in \\mathbb{C}^{n \\times n}$ 和一个对角矩阵 $\\Lambda = \\operatorname{diag}(\\lambda_{1},\\ldots,\\lambda_{n})$ 使得 $A = U \\Lambda U^{*}$。固定一个索引 $k \\in \\{1,\\ldots,n\\}$ 和一个实标量 $t > 0$。构造一个秩为1且与 $A$ 的第 $k$ 个特征向量对齐的扰动 $E \\in \\mathbb{C}^{n \\times n}$，使得其谱范数满足 $\\|E\\|_{2} = t$。并从基本原理出发，验证 $A+E$ 的谱是通过将 $A$ 的一个特征值移动一个大小为 $t$ 的实数量，而其余特征值保持不变得到的。由此得出结论，对于您的构造，Bauer-Fike 定理为 $A$ 所规定的半径（当 $A$ 是正规矩阵时的“Bauer-Fike 半径”）恰好通过一次特征值位移得以实现。\n\n请以 $t$ 的闭式表达式给出所实现的位移大小的精确值。不需要进行数值舍入，也不涉及单位。", "solution": "问题陈述经解析和验证，具有科学依据，提法恰当且完整。我们开始进行解答。\n\n设 $A \\in \\mathbb{C}^{n \\times n}$ 是一个 $n \\geq 2$ 的正规矩阵。根据正规矩阵的谱定理，存在一个酉矩阵 $U \\in \\mathbb{C}^{n \\times n}$ 和一个对角矩阵 $\\Lambda = \\operatorname{diag}(\\lambda_{1},\\ldots,\\lambda_{n})$ 使得 $A = U \\Lambda U^{*}$。$U$ 的列向量，记为 $u_1, u_2, \\ldots, u_n$，构成了 $A$ 的一组标准正交特征向量基。也就是说，对于每个 $j \\in \\{1,\\ldots,n\\}$ 都有 $A u_j = \\lambda_j u_j$，并且标准正交性条件为 $u_i^* u_j = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克 (Kronecker) δ函数。\n\n问题要求构造一个秩为1的扰动 $E \\in \\mathbb{C}^{n \\times n}$，它对于一个固定的索引 $k \\in \\{1,\\ldots,n\\}$ “与 $A$ 的第 $k$ 个特征向量对齐”，使得其谱范数为 $\\|E\\|_{2} = t$，其中 $t > 0$ 是给定的实标量。\n\n我们来构造矩阵 $E$。$A$ 的第 $k$ 个特征向量是 $u_k$。一个与 $u_k$ 对齐的秩为1的矩阵可以构造为包含 $u_k$ 的外积。最直接且同时是 Hermitian 矩阵的构造形式为 $E = \\alpha u_k u_k^*$，其中 $\\alpha \\in \\mathbb{C}$ 是某个标量。\n\n我们验证所构造矩阵 $E$ 的性质：\n1.  **秩**：由于 $u_k$ 是一个非零向量（因为它是酉矩阵的一列），只要 $\\alpha \\neq 0$，矩阵 $E = \\alpha u_k u_k^*$ 的秩就是1。\n2.  **谱范数**：我们必须满足条件 $\\|E\\|_2 = t$。$E$ 的谱范数由下式给出\n    $$ \\|E\\|_2 = \\|\\alpha u_k u_k^*\\|_2 = |\\alpha| \\|u_k u_k^*\\|_2 $$\n    矩阵 $P_k = u_k u_k^*$ 是到由 $u_k$ 张成的一维子空间上的正交投影算子。由于 $u_k$ 是单位向量（$u_k^* u_k = 1$），$P_k$ 是一个 Hermitian 矩阵和幂等矩阵（$P_k^2 = P_k$）。它的特征值为 $1$（特征向量为 $u_k$）和 $0$（重数为 $n-1$，对应于与 $u_k$ 正交的子空间）。半正定 Hermitian 矩阵的奇异值就是其特征值。因此，$P_k$ 的最大奇异值为 $1$，这意味着 $\\|P_k\\|_2 = 1$。\n    因此，我们有 $\\|E\\|_2 = |\\alpha|$。给定条件是 $\\|E\\|_2 = t$，这意味着 $|\\alpha| = t$。问题暗示特征值位移是一个实数量。满足此条件的一个简单选择是取 $\\alpha$ 为实数。由于给定 $t>0$，我们可以选择 $\\alpha = t$。\n    因此，我们将扰动矩阵定义为 $E = t u_k u_k^*$。该矩阵秩为1且满足 $\\|E\\|_2 = t$。\n\n接下来，我们必须从基本原理出发，验证此扰动对 $A$ 的谱的影响。设扰动后的矩阵为 $A' = A + E = A + t u_k u_k^*$。我们将通过测试它对 $A$ 的特征向量的作用来找到 $A'$ 的特征值。\n\n对于 $A$ 的任意特征向量 $u_j$（其中 $j \\neq k$）：\n$$ A' u_j = (A + t u_k u_k^*) u_j = A u_j + t u_k (u_k^* u_j) $$\n由于集合 $\\{u_1, \\ldots, u_n\\}$ 是标准正交的，当 $j \\neq k$ 时内积 $u_k^* u_j = 0$。因此，第二项消失：\n$$ A' u_j = A u_j = \\lambda_j u_j $$\n这表明对于每个 $j \\in \\{1,\\ldots,n\\} \\setminus \\{k\\}$，$\\lambda_j$ 是 $A'$ 的一个特征值，其对应的特征向量仍为 $u_j$。这解释了 $A'$ 的 $n-1$ 个特征值。\n\n现在，我们考虑特征向量 $u_k$：\n$$ A' u_k = (A + t u_k u_k^*) u_k = A u_k + t u_k (u_k^* u_k) $$\n由于 $u_k$ 是一个单位向量，$u_k^* u_k = \\|u_k\\|_2^2 = 1$。表达式简化为：\n$$ A' u_k = A u_k + t u_k = \\lambda_k u_k + t u_k = (\\lambda_k + t) u_k $$\n这表明 $(\\lambda_k + t)$ 是 $A'$ 的一个特征值，其对应的特征向量是 $u_k$。\n\n总而言之，扰动矩阵 $A+E$ 的谱恰好是\n$$ \\sigma(A+E) = \\{\\lambda_1, \\ldots, \\lambda_{k-1}, \\lambda_k + t, \\lambda_{k+1}, \\ldots, \\lambda_n\\} $$\n$A$ 的恰好一个特征值，即 $\\lambda_k$，被移动了一个实数量 $t$，而其他 $n-1$ 个特征值保持不变。这个位移的大小是 $|t|$，因为我们已知 $t > 0$，所以它等于 $t$。\n\n最后，我们将此结果与鲍尔-菲克定理联系起来。对于一个可对角化矩阵 $A=V\\Lambda V^{-1}$，该定理指出，对于扰动矩阵 $A+E$ 的任意特征值 $\\mu$，存在 $A$ 的一个特征值 $\\lambda$，使得 $|\\lambda - \\mu| \\le \\kappa_2(V) \\|E\\|_2$，其中 $\\kappa_2(V)$ 是 $V$ 的谱条件数。对于一个正规矩阵 $A$，特征向量矩阵 $V$ 可以选择为酉矩阵，即 $V=U$。对于酉矩阵，$\\kappa_2(U) = \\|U\\|_2 \\|U^{-1}\\|_2 = 1 \\cdot 1 = 1$。因此，该定理简化为：对于 $A+E$ 的任意特征值 $\\mu$，存在 $A$ 的一个特征值 $\\lambda$，使得\n$$ |\\lambda - \\mu| \\le \\|E\\|_2 $$\n在我们的例子中，$\\|E\\|_2 = t$，因此该定理保证对于任意 $\\mu \\in \\sigma(A+E)$，我们有 $\\min_{\\lambda_j \\in \\sigma(A)} |\\lambda_j - \\mu| \\le t$。数量 $t$ 就是“鲍尔-菲克半径”。\n\n我们构造的扰动 $E = t u_k u_k^*$ 导致了一个新的特征值 $\\mu' = \\lambda_k + t$。我们现在检查这个新特征值到 $A$ 原始谱的距离：\n$$ \\min_{\\lambda_j \\in \\sigma(A)} |\\lambda_j - \\mu'| = \\min_{\\lambda_j \\in \\sigma(A)} |\\lambda_j - (\\lambda_k+t)| $$\n显然，当我们选择 $\\lambda_j = \\lambda_k$ 时，可以达到最小值，得到的距离为\n$$ |\\lambda_k - (\\lambda_k+t)| = |-t| = t $$\n这个距离恰好等于鲍尔-菲克定理提供的上界 $t = \\|E\\|_2$。因此，这个构造表明，对于正规矩阵，该界是紧的 (sharp)，因为它可以被精确达到。特征值 $\\lambda_k$ 的位移大小为 $t$。\n\n问题要求给出所实现的位移大小的精确值。位移本身是新特征值与旧特征值之差，即 $(\\lambda_k + t) - \\lambda_k = t$。此位移的大小为 $|t|$。由于给定 $t>0$，其大小就是 $t$。", "answer": "$$\n\\boxed{t}\n$$", "id": "3585033"}, {"introduction": "与正规矩阵的稳定性形成鲜明对比，非正规矩阵的特征值可能对微小扰动异常敏感，而这种敏感性被特征向量矩阵的条件数 $\\kappa_2(V)$ 所量化。本练习将引导你分析一个条件数极大的“近亏损”（nearly defective）矩阵，其特征向量几乎线性相关。你将通过显式计算验证，一个微小的扰动在巨大条件数的放大下，如何能引起不成比例的巨大特征值位移，从而直观地揭示非正规性在数值计算中的关键作用 [@problem_id:3585025]。", "problem": "设 $A \\in \\mathbb{C}^{2 \\times 2}$ 是矩阵 $A = \\begin{pmatrix} 1  1 \\\\ 0  1 + \\delta \\end{pmatrix}$，其中 $\\delta$ 是一个小的正参数，并考虑秩-1扰动 $E = \\begin{pmatrix} 0  0 \\\\ \\varepsilon  0 \\end{pmatrix}$，其中 $\\varepsilon$ 是一个小的正参数。矩阵 $A$ 是可对角化的，因为它有两个不同的特征值 $1$ 和 $1 + \\delta$，但它又是近乎亏损的，因为当 $\\delta \\to 0^{+}$ 时，其特征向量变得近乎线性相关。在诱导算子2-范数（谱范数）下进行计算。\n\n任务：\n- 仅使用可对角化矩阵的谱性质和范数的次可乘性，从第一性原理推导一个关于 $A + E$ 的特征值可以偏离 $A$ 的特征值多远的界限，该界限用 $A$ 的特征向量矩阵 $V$ 的条件数 $\\kappa_{2}(V) = \\|V\\|_{2} \\,\\|V^{-1}\\|_{2}$ 和扰动大小 $\\|E\\|_{2}$ 来表示。\n- 显式地构造 $A$ 的特征向量矩阵 $V$，并通过奇异值分解（SVD）精确计算出 $\\kappa_{2}(V)$ 关于 $\\delta$ 的表达式。\n- 通过求解一个 $2 \\times 2$ 矩阵的特征方程，计算 $A + E$ 的精确特征值以及在扰动 $E$ 下 $A$ 的每个特征值的精确位移。\n- 取特例 $\\delta = 10^{-8}$ 和 $\\varepsilon = 10^{-6}$，并数值计算定义为如下的比例 $R$\n$$\nR = \\frac{\\text{基于对角化的范数论证预测的特征值移动上界}}{\\text{从精确的 $2 \\times 2$ 公式计算出的实际特征值位移}}。\n$$\n\n返回 $R$ 作为一个纯数。将你的最终答案四舍五入到四位有效数字。不需要报告单位。", "solution": "该问题经验证在科学上是合理的、良定的、客观的和完整的。这是数值线性代数中关于特征值扰动理论的一个标准问题。我们可以开始解答。\n\n解答按照题目要求分为四个部分。\n\n**第一部分：特征值扰动界的推导**\n\n设 $A \\in \\mathbb{C}^{n \\times n}$ 是一个可对角化的矩阵。那么存在一个可逆矩阵 $V$（其列是 $A$ 的特征向量）和一个对角矩阵 $\\Lambda$（其对角线元素是相应的特征值 $\\lambda_1, \\dots, \\lambda_n$），使得 $A = V \\Lambda V^{-1}$。\n\n设 $E$ 是一个扰动矩阵，$\\mu$ 是扰动后矩阵 $A+E$ 的一个特征值，其对应的特征向量为 $x \\neq 0$。定义关系为：\n$$(A+E)x = \\mu x$$\n这可以重写为：\n$$(\\mu I - A)x = Ex$$\n如果 $\\mu$ 是 $A$ 的一个特征值，即 $\\mu \\in \\sigma(A)$，那么距离 $\\min_{\\lambda \\in \\sigma(A)} |\\mu-\\lambda| = 0$。我们寻求推导的界是非负的，因此它将平凡地成立。\n\n假设 $\\mu$ 不是 $A$ 的特征值。在这种情况下，矩阵 $\\mu I - A$ 是可逆的。因此我们可以写出：\n$$x = (\\mu I - A)^{-1} Ex$$\n我们将 $A$ 的对角化代入逆的表达式中：\n$$\\mu I - A = \\mu I - V \\Lambda V^{-1} = V(\\mu I)V^{-1} - V \\Lambda V^{-1} = V(\\mu I - \\Lambda)V^{-1}$$\n其逆矩阵为：\n$$(\\mu I - A)^{-1} = (V(\\mu I - \\Lambda)V^{-1})^{-1} = V(\\mu I - \\Lambda)^{-1}V^{-1}$$\n将此代回 $x$ 的方程中：\n$$x = V(\\mu I - \\Lambda)^{-1}V^{-1}Ex$$\n现在，我们对两边取诱导算子2-范数（谱范数，记为 $\\|\\cdot\\|_2$）。因为 $x \\neq 0$，所以 $\\|x\\|_2 > 0$。\n$$\\|x\\|_2 = \\|V(\\mu I - \\Lambda)^{-1}V^{-1}Ex\\|_2$$\n使用矩阵范数的次可乘性（$\\|AB\\|_2 \\le \\|A\\|_2 \\|B\\|_2$）：\n$$\\|x\\|_2 \\le \\|V\\|_2 \\|(\\mu I - \\Lambda)^{-1}\\|_2 \\|V^{-1}\\|_2 \\|E\\|_2 \\|x\\|_2$$\n因为 $\\|x\\|_2 > 0$，我们可以用它来除两边：\n$$1 \\le \\|V\\|_2 \\|V^{-1}\\|_2 \\|(\\mu I - \\Lambda)^{-1}\\|_2 \\|E\\|_2$$\n特征向量矩阵 $V$ 在2-范数下的条件数是 $\\kappa_2(V) = \\|V\\|_2 \\|V^{-1}\\|_2$。不等式变为：\n$$1 \\le \\kappa_2(V) \\|(\\mu I - \\Lambda)^{-1}\\|_2 \\|E\\|_2$$\n矩阵 $\\mu I - \\Lambda$ 是一个对角矩阵：\n$$\\mu I - \\Lambda = \\text{diag}(\\mu-\\lambda_1, \\dots, \\mu-\\lambda_n)$$\n它的逆矩阵也是对角矩阵：\n$$(\\mu I - \\Lambda)^{-1} = \\text{diag}\\left(\\frac{1}{\\mu-\\lambda_1}, \\dots, \\frac{1}{\\mu-\\lambda_n}\\right)$$\n一个对角矩阵的2-范数是其对角线元素绝对值的最大值：\n$$\\|(\\mu I - \\Lambda)^{-1}\\|_2 = \\max_{i} \\left|\\frac{1}{\\mu-\\lambda_i}\\right| = \\frac{1}{\\min_{i} |\\mu-\\lambda_i|}$$\n将此代入我们的主不等式中得到：\n$$1 \\le \\kappa_2(V) \\frac{1}{\\min_{i} |\\mu-\\lambda_i|} \\|E\\|_2$$\n重新整理以分离出特征值距离，得到所期望的界，这被称为鲍尔-菲克定理 (Bauer-Fike Theorem)：\n$$\\min_{i} |\\mu-\\lambda_i| \\le \\kappa_2(V) \\|E\\|_2$$\n这为扰动后矩阵 $A+E$ 的任何特征值 $\\mu$ 与 $A$ 的特征值集合之间的距离提供了一个上界。因此，可能的最大位移受限于 $\\kappa_2(V) \\|E\\|_2$。\n\n**第二部分：特征向量矩阵及其条件数**\n\n给定矩阵为 $A = \\begin{pmatrix} 1  1 \\\\ 0  1 + \\delta \\end{pmatrix}$。因为 $A$ 是上三角矩阵，所以特征值是其对角线元素：$\\lambda_1 = 1$ 和 $\\lambda_2 = 1+\\delta$。\n\n对于 $\\lambda_1 = 1$：$(A-\\lambda_1 I)v_1 = 0 \\implies \\begin{pmatrix} 0  1 \\\\ 0  \\delta \\end{pmatrix}v_1 = 0$。一个合适的特征向量是 $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n对于 $\\lambda_2 = 1+\\delta$：$(A-\\lambda_2 I)v_2 = 0 \\implies \\begin{pmatrix} -\\delta  1 \\\\ 0  0 \\end{pmatrix}v_2 = 0$。一个合适的特征向量是 $v_2 = \\begin{pmatrix} 1 \\\\ \\delta \\end{pmatrix}$。\n\n特征向量矩阵 $V$ 及其逆矩阵 $V^{-1}$ 是：\n$$V = \\begin{pmatrix} 1  1 \\\\ 0  \\delta \\end{pmatrix}, \\quad V^{-1} = \\frac{1}{\\delta} \\begin{pmatrix} \\delta  -1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  -1/\\delta \\\\ 0  1/\\delta \\end{pmatrix}$$\n为了计算 $\\kappa_2(V) = \\sigma_{\\max}(V) / \\sigma_{\\min}(V)$，其中 $\\sigma$ 是 $V$ 的奇异值，我们求解 $V^\\top V$ 的特征值的平方根：\n$$V^\\top V = \\begin{pmatrix} 1  0 \\\\ 1  \\delta \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  \\delta \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1+\\delta^2 \\end{pmatrix}$$\n特征方程是 $\\det(V^\\top V - \\lambda I)=0$：\n$$(1-\\lambda)(1+\\delta^2-\\lambda) - 1 = 0 \\implies \\lambda^2 - (2+\\delta^2)\\lambda + \\delta^2 = 0$$\n$V^\\top V$ 的特征值是 $V$ 的奇异值的平方：\n$$\\sigma(V)^2 = \\frac{(2+\\delta^2) \\pm \\sqrt{(2+\\delta^2)^2 - 4\\delta^2}}{2} = \\frac{2+\\delta^2 \\pm \\sqrt{4+\\delta^4}}{2}$$\n奇异值为 $\\sigma_{\\max}(V)=\\sqrt{\\frac{2+\\delta^2+\\sqrt{4+\\delta^4}}{2}}$ 和 $\\sigma_{\\min}(V)=\\sqrt{\\frac{2+\\delta^2-\\sqrt{4+\\delta^4}}{2}}$。\n条件数是其比值：\n$$\\kappa_2(V) = \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)} = \\sqrt{\\frac{2+\\delta^2+\\sqrt{4+\\delta^4}}{2+\\delta^2-\\sqrt{4+\\delta^4}}}$$\n对分母进行有理化：\n$$\\kappa_2(V) = \\sqrt{\\frac{(2+\\delta^2+\\sqrt{4+\\delta^4})^2}{(2+\\delta^2)^2-(4+\\delta^4)}} = \\frac{2+\\delta^2+\\sqrt{4+\\delta^4}}{\\sqrt{4+4\\delta^2+\\delta^4-4-\\delta^4}} = \\frac{2+\\delta^2+\\sqrt{4+\\delta^4}}{2\\delta}$$\n这就是 $\\kappa_2(V)$ 的精确表达式。\n\n**第三部分：扰动后矩阵的精确特征值和位移**\n\n扰动后的矩阵是 $A+E = \\begin{pmatrix} 1  1 \\\\ 0  1+\\delta \\end{pmatrix} + \\begin{pmatrix} 0  0 \\\\ \\varepsilon  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ \\varepsilon  1+\\delta \\end{pmatrix}$。\n特征方程 $\\det(A+E - \\mu I) = 0$ 是：\n$$\\det\\begin{pmatrix} 1-\\mu  1 \\\\ \\varepsilon  1+\\delta-\\mu \\end{pmatrix} = (1-\\mu)(1+\\delta-\\mu) - \\varepsilon = 0$$\n$$\\mu^2 - (2+\\delta)\\mu + (1+\\delta-\\varepsilon) = 0$$\n求解这个关于特征值 $\\mu$ 的二次方程：\n$$\\mu = \\frac{(2+\\delta) \\pm \\sqrt{(2+\\delta)^2 - 4(1+\\delta-\\varepsilon)}}{2} = \\frac{2+\\delta \\pm \\sqrt{4+4\\delta+\\delta^2 - 4-4\\delta+4\\varepsilon}}{2}$$\n$$\\mu = \\frac{2+\\delta \\pm \\sqrt{\\delta^2+4\\varepsilon}}{2}$$\n$A+E$ 的特征值为 $\\mu_1 = \\frac{2+\\delta - \\sqrt{\\delta^2+4\\varepsilon}}{2}$ 和 $\\mu_2 = \\frac{2+\\delta + \\sqrt{\\delta^2+4\\varepsilon}}{2}$。对于小的 $\\varepsilon$，$\\mu_1 \\approx 1 = \\lambda_1$ 并且 $\\mu_2 \\approx 1+\\delta=\\lambda_2$。\n$\\lambda_1$ 的位移是 $|\\mu_1 - \\lambda_1| = |\\frac{2+\\delta - \\sqrt{\\delta^2+4\\varepsilon}}{2} - 1| = |\\frac{\\delta - \\sqrt{\\delta^2+4\\varepsilon}}{2}| = \\frac{\\sqrt{\\delta^2+4\\varepsilon}-\\delta}{2}$。\n$\\lambda_2$ 的位移是 $|\\mu_2 - \\lambda_2| = |\\frac{2+\\delta + \\sqrt{\\delta^2+4\\varepsilon}}{2} - (1+\\delta)| = |\\frac{\\sqrt{\\delta^2+4\\varepsilon}-\\delta}{2}| = \\frac{\\sqrt{\\delta^2+4\\varepsilon}-\\delta}{2}$。\n两个特征值的实际位移是相同的。\n\n**第四部分：比例R的数值计算**\n\n比例 $R$ 定义为预测上界除以实际位移。\n扰动矩阵是 $E = \\begin{pmatrix} 0  0 \\\\ \\varepsilon  0 \\end{pmatrix}$。其2-范数为 $\\|E\\|_2 = \\sigma_{\\max}(E) = \\varepsilon$。\n预测上界： $\\kappa_2(V) \\|E\\|_2 = \\left(\\frac{2+\\delta^2+\\sqrt{4+\\delta^4}}{2\\delta}\\right)\\varepsilon$。\n实际位移： $\\frac{\\sqrt{\\delta^2+4\\varepsilon}-\\delta}{2}$。\n\n该比例为：\n$$R = \\frac{\\left(\\frac{2+\\delta^2+\\sqrt{4+\\delta^4}}{2\\delta}\\right)\\varepsilon}{\\frac{\\sqrt{\\delta^2+4\\varepsilon}-\\delta}{2}} = \\frac{(2+\\delta^2+\\sqrt{4+\\delta^4})\\varepsilon}{\\delta(\\sqrt{\\delta^2+4\\varepsilon}-\\delta)}$$\n为简化，我们通过将分子和分母同乘以 $(\\sqrt{\\delta^2+4\\varepsilon}+\\delta)$ 来对分母进行有理化：\n$$R = \\frac{(2+\\delta^2+\\sqrt{4+\\delta^4})\\varepsilon(\\sqrt{\\delta^2+4\\varepsilon}+\\delta)}{\\delta((\\delta^2+4\\varepsilon)-\\delta^2)} = \\frac{(2+\\delta^2+\\sqrt{4+\\delta^4})\\varepsilon(\\sqrt{\\delta^2+4\\varepsilon}+\\delta)}{4\\varepsilon\\delta}$$\n消去 $\\varepsilon$，我们得到 $R$ 的一个简化的精确表达式：\n$$R = \\left(\\frac{2+\\delta^2+\\sqrt{4+\\delta^4}}{2\\delta}\\right) \\left(\\frac{\\sqrt{\\delta^2+4\\varepsilon}+\\delta}{2}\\right) = \\kappa_2(V) \\left(\\frac{\\sqrt{\\delta^2+4\\varepsilon}+\\delta}{2}\\right)$$\n我们现在代入数值 $\\delta = 10^{-8}$ 和 $\\varepsilon = 10^{-6}$。\n第一项是 $\\kappa_2(V)$。由于 $\\delta=10^{-8}$ 非常小，$\\delta^2=10^{-16}$ 和 $\\delta^4=10^{-32}$ 与常数相比可以忽略不计。\n$$\\kappa_2(V) = \\frac{2+10^{-16}+\\sqrt{4+10^{-32}}}{2 \\times 10^{-8}} \\approx \\frac{2+2}{2 \\times 10^{-8}} = \\frac{4}{2 \\times 10^{-8}} = 2 \\times 10^8$$\n更精确地，对小的 $x$ 使用二项式近似 $\\sqrt{4+x} \\approx 2+x/4$：\n$\\kappa_2(V) \\approx \\frac{2+\\delta^2+2+\\delta^4/4}{2\\delta} = \\frac{4+\\delta^2+\\delta^4/4}{2\\delta} = \\frac{2}{\\delta}+\\frac{\\delta}{2}+\\frac{\\delta^3}{8} = 2 \\times 10^8 + 0.5 \\times 10^{-8} + \\dots$\n\n第二项是 $\\frac{\\sqrt{\\delta^2 + 4\\varepsilon} + \\delta}{2}$。我们有 $\\delta^2 = 10^{-16}$ 和 $4\\varepsilon = 4 \\times 10^{-6}$。由于 $\\delta^2 \\ll 4\\varepsilon$：\n$$\\sqrt{\\delta^2+4\\varepsilon} = \\sqrt{10^{-16} + 4 \\times 10^{-6}} = \\sqrt{4 \\times 10^{-6} (1 + 0.25 \\times 10^{-10})} = 2 \\times 10^{-3} \\sqrt{1+0.25 \\times 10^{-10}}$$\n对小的 $y$ 使用 $\\sqrt{1+y} \\approx 1+y/2$：\n$$\\sqrt{\\delta^2+4\\varepsilon} \\approx 2 \\times 10^{-3} (1 + 0.125 \\times 10^{-10}) = 2 \\times 10^{-3} + 0.25 \\times 10^{-13}$$\n$R$ 的第二项是：\n$$\\frac{(2 \\times 10^{-3} + 0.25 \\times 10^{-13}) + 10^{-8}}{2} \\approx \\frac{2 \\times 10^{-3} + 10^{-8}}{2} = 10^{-3} + 0.5 \\times 10^{-8}$$\n现在，我们将这两项相乘来求 $R$：\n$$R \\approx (2 \\times 10^8 + 0.5 \\times 10^{-8}) (10^{-3} + 0.5 \\times 10^{-8})$$\n$$R \\approx (2 \\times 10^8)(10^{-3}) + (2 \\times 10^8)(0.5 \\times 10^{-8}) + (0.5 \\times 10^{-8})(10^{-3}) + \\dots$$\n$$R \\approx 2 \\times 10^5 + 1 + 0.5 \\times 10^{-11} + \\dots$$\n$$R \\approx 200001$$\n其值为 $R = 200001.0000025...$。题目要求我们将此结果四舍五入到四位有效数字。\n这个数是 $2.00001 \\times 10^5$。前四位有效数字是 $2$、$0$、$0$、$0$。第五位数字是 $0$，所以我们向下舍入（即保持第四位数字不变）。\n结果，保留四位有效数字，是 $2.000 \\times 10^5$。", "answer": "$$\\boxed{2.000 \\times 10^{5}}$$", "id": "3585025"}, {"introduction": "将理论洞察力转化为计算实践是数值线性代数的核心技能。这个练习要求你编写一个程序，以系统地构建具有不同条件数的矩阵，从理想的正交情况到高度病态的非正规情况。你将实现一个算法，以寻找一个“对抗性”扰动方向，目的是在给定扰动范数下最大化特征值的实际位移，并将此位移与Bauer-Fike理论界限进行比较，从而在实践中验证该定理的预测能力 [@problem_id:3585060]。", "problem": "您需要实现一个完整的程序，该程序使用通常称为Bauer-Fike半径的概念，为可对角化矩阵构建、分析和验证其特征值扰动行为。所有数学对象都必须以纯数学术语进行处理，并给出明确的定义。推导和算法的基础必须从以下原则和定义开始：可对角化矩阵的定义、谱（二）范数、二范数条件数以及矩阵的奇异值分解（SVD）。您不得依赖于这些定义之外的任何未经证明的简化公式，并且您的程序必须完全按照规定计算所有量。\n\n定义和任务：\n1. 一个方阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 是可对角化的，如果存在一个可逆矩阵 $V \\in \\mathbb{R}^{3 \\times 3}$ 和一个对角矩阵 $\\Lambda \\in \\mathbb{R}^{3 \\times 3}$ 使得 $A = V \\Lambda V^{-1}$。$\\Lambda$ 的对角线元素是 $A$ 的特征值。\n2. 一个矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 的谱二范数定义为 $\\lVert M \\rVert_2 = \\sigma_{\\max}(M)$，其中 $\\sigma_{\\max}(M)$ 是 $M$ 的最大奇异值，而奇异值是 $M^\\top M$ 的特征值的非负平方根。使用奇异值分解（SVD）来计算奇异值。\n3. 一个可逆矩阵 $V$ 的二范数条件数定义为 $\\kappa_2(V) = \\lVert V \\rVert_2 \\, \\lVert V^{-1} \\rVert_2$。等价地，如果 $\\sigma_{\\max}(V)$ 和 $\\sigma_{\\min}(V)$ 表示 $V$ 的最大和最小奇异值，则 $\\kappa_2(V) = \\sigma_{\\max}(V)/\\sigma_{\\min}(V)$。\n4. 给定一个扰动矩阵 $E \\in \\mathbb{R}^{3 \\times 3}$ 及其谱二范数 $\\lVert E \\rVert_2$，定义 $V$ 和 $\\lVert E \\rVert_2$ 的Bauer-Fike半径为 $r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2) \\coloneqq \\kappa_2(V) \\, \\lVert E \\rVert_2$。该量通常用于限定矩阵 $A$ 在扰动 $E$ 下可能发生的特征值位移。\n5. 对于一个可对角化的矩阵 $A = V \\Lambda V^{-1}$ 和一个对角矩阵 $\\Delta = \\mathrm{diag}(\\delta_1,\\delta_2,\\delta_3)$，考虑结构化扰动 $E = V \\Delta V^{-1}$。在这种情况下，有 $A + E = V (\\Lambda + \\Delta) V^{-1}$，因此 $A + E$ 的特征值恰好被 $\\Delta$ 的对角线元素所平移。对于给定的 $V$ 和选定的对角方向 $d = (d_1, d_2, d_3)$（其中 $\\max_i |d_i| = 1$），设置 $E(d,\\alpha) = V \\,\\mathrm{diag}(\\alpha d_1, \\alpha d_2, \\alpha d_3)\\, V^{-1}$ 并缩放 $\\alpha$ 以使 $\\lVert E(d,\\alpha) \\rVert_2$ 等于规定值。这样就构建了一个与所选对角线方向对齐的对抗性扰动。\n\n您的程序必须：\n- 构建三个可对角化矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，这些矩阵具有指定的谱和特意设计的对角化矩阵 $V$，以探索二范数条件数的不同范围。您必须通过在$x\\text{-}z$平面上的固定角度旋转，然后进行各向异性对角缩放来构建 $V$，以产生大的 $\\kappa_2(V)$、中等的 $\\kappa_2(V)$，以及在一个基准情况下，通过使用正交对角化矩阵使 $\\kappa_2(V) = 1$。旋转角必须以弧度指定。\n- 对于每种情况，根据指定的谱计算 $A = V \\Lambda V^{-1}$，根据 $V$ 的SVD计算 $\\kappa_2(V)$，并针对给定的 $\\lVert E \\rVert_2$ 计算 $r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2)$。\n- 实现一个对满足 $\\max_i |d_i| = 1$ 的对角方向 $d$ 的搜索，以找到一个使 $\\lVert V \\,\\mathrm{diag}(d)\\, V^{-1} \\rVert_2$ 这个量最小化的对抗性方向。对于选定的方向，缩放 $\\alpha$ 以使 $\\lVert E(d,\\alpha) \\rVert_2$ 与规定值匹配，构成 $E(d,\\alpha)$，并计算 $A$ 和 $A + E(d,\\alpha)$ 的特征值。将观察到的最大特征值位移量化为 $s = \\max_j \\min_i \\left| \\lambda_j(A+E) - \\lambda_i(A) \\right|$（将每个扰动后的特征值与绝对值上最接近的原始特征值配对，并取这些最小距离中的最大值）。\n- 对于每种情况，返回比率 $s / r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2)$ 作为浮点数。该比率量化了对抗性扰动与Bauer-Fike半径的接近程度。\n\n角度单位说明：所有旋转角都必须以弧度表示。\n\n测试套件：\n- 案例1（大的 $\\kappa_2(V)$）：\n  - 谱：$\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{1.0, -2.0, 4.0\\}$，所以 $\\Lambda = \\mathrm{diag}(1.0, -2.0, 4.0)$。\n  - 旋转角：$\\theta = \\pi/4$（弧度）。使用$y$轴旋转矩阵\n    $$W(\\theta) = \\begin{bmatrix}\n    \\cos\\theta  0  \\sin\\theta \\\\\n    0  1  0 \\\\\n    -\\sin\\theta  0  \\cos\\theta\n    \\end{bmatrix}.$$\n  - 对角缩放：$\\Sigma = \\mathrm{diag}(1, s, s^2)$，其中 $s = 10^{-2}$。\n  - 对角化矩阵V：$V = \\Sigma \\, W(\\theta)^\\top$。\n  - 规定的扰动谱范数：$\\lVert E \\rVert_2 = \\varepsilon = 10^{-2}$。\n- 案例2（中等的 $\\kappa_2(V)$）：\n  - 谱：$\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{0.5, -1.5, 3.0\\}$，所以 $\\Lambda = \\mathrm{diag}(0.5, -1.5, 3.0)$。\n  - 旋转角：$\\theta = \\pi/4$（弧度）。\n  - 对角缩放：$\\Sigma = \\mathrm{diag}(1, s, s^2)$，其中 $s = 0.3$。\n  - 对角化矩阵V：$V = \\Sigma \\, W(\\theta)^\\top$。\n  - 规定的扰动谱范数：$\\lVert E \\rVert_2 = \\varepsilon = 5 \\times 10^{-3}$。\n- 案例3（基准正交对角化矩阵V，$\\kappa_2(V) = 1$）：\n  - 谱：$\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{2.0, 0.0, -1.0\\}$，所以 $\\Lambda = \\mathrm{diag}(2.0, 0.0, -1.0)$。\n  - 对角化矩阵V：$V = I_3$，$3 \\times 3$ 单位矩阵，因此不应用旋转。\n  - 规定的扰动谱范数：$\\lVert E \\rVert_2 = \\varepsilon = 10^{-3}$。\n\n算法要求：\n- 对于每种情况，通过 $V$ 的SVD，使用比率 $\\sigma_{\\max}(V)/\\sigma_{\\min}(V)$ 计算 $\\kappa_2(V)$。\n- 计算 $r_{\\mathrm{BF}}(V, \\varepsilon) = \\kappa_2(V)\\,\\varepsilon$。\n- 对满足 $\\max_i |d_i| = 1$ 的对角方向 $d$ 进行搜索，包括一组确定的规范模式和一组具有固定种子的随机集，以近似最小化 $\\lVert V \\,\\mathrm{diag}(d)\\, V^{-1} \\rVert_2$。\n- 对于最小化的 $d$，设置 $\\alpha = \\varepsilon / \\lVert V \\,\\mathrm{diag}(d)\\, V^{-1} \\rVert_2$ 以强制 $\\lVert E(d,\\alpha) \\rVert_2 = \\varepsilon$，构建 $E(d,\\alpha)$，计算 $A$ 和 $A + E(d,\\alpha)$ 的特征值，并计算 $s$。\n- 输出一行，其中包含一个用方括号括起来的逗号分隔列表，其中包含三种情况下（按案例1、案例2、案例3的顺序）的三个比率 $s / r_{\\mathrm{BF}}(V, \\varepsilon)$。每个项目都必须是浮点数。\n\n您的程序必须以“[r1,r2,r3]”的格式精确地产生一行输出。", "solution": "用户提供了一个有效的问题陈述。\n\n该问题要求对可对角化矩阵的鲍尔-菲克定理的紧致性进行计算性研究。具体来说，我们需要构建三个具有不同条件数的特征向量矩阵的矩阵，应用结构化的对抗性扰动，并将产生的最大特征值位移与鲍尔-菲克半径提供的理论上界进行比较。\n\n该问题的理论基础建立在数值线性代中的几个关键概念之上。令 $A \\in \\mathbb{R}^{n \\times n}$ 是一个可对角化的矩阵。根据定义，存在一个可逆矩阵 $V$ 和一个对角矩阵 $\\Lambda$ 使得：\n$$ A = V \\Lambda V^{-1} $$\n$V$ 的列是 $A$ 的特征向量，$\\Lambda$ 的对角线元素（表示为 $\\lambda_1, \\lambda_2, \\ldots, \\lambda_n$）是相应的特征值。\n\n当 $A$ 被另一个矩阵 $E$ 扰动时，结果矩阵是 $A+E$。鲍尔-菲克定理为 $A$ 的特征值可能移动的幅度提供了一个界限。它指出，对于 $A+E$ 的任何特征值 $\\mu$，都存在一个 $A$ 的特征值 $\\lambda_i$，使得：\n$$ |\\mu - \\lambda_i| \\le \\kappa_2(V) \\lVert E \\rVert_2 $$\n这里，$\\lVert E \\rVert_2$ 是 $E$ 的谱范数（或2-范数），定义为 $E$ 的最大奇异值 $\\sigma_{\\max}(E)$。量 $\\kappa_2(V)$ 是特征向量矩阵 $V$ 的2-范数条件数，定义为：\n$$ \\kappa_2(V) = \\lVert V \\rVert_2 \\lVert V^{-1} \\rVert_2 = \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)} $$\n其中 $\\sigma_{\\max}(V)$ 和 $\\sigma_{\\min}(V)$ 分别是 $V$ 的最大和最小奇异值。乘积 $\\kappa_2(V) \\lVert E \\rVert_2$ 在问题中被定义为鲍尔-菲克半径，即 $r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2)$。\n\n该问题研究了一类特殊形式的结构化扰动 $E = V \\Delta V^{-1}$，其中 $\\Delta = \\mathrm{diag}(\\delta_1, \\delta_2, \\ldots, \\delta_n)$ 是一个对角矩阵。对于这样的扰动，扰动后的矩阵为：\n$$ A + E = V \\Lambda V^{-1} + V \\Delta V^{-1} = V (\\Lambda + \\Delta) V^{-1} $$\n这表明 $A+E$ 与 $A$ 具有相同的特征向量矩阵 $V$，其特征值为 $\\mu_j = \\lambda_j + \\delta_j$。问题要求构建一个谱范数规定为 $\\lVert E \\rVert_2 = \\varepsilon$ 的矩阵 $E$。我们通过一个对角矩阵 $\\mathrm{diag}(d)$ 来定义扰动方向，其中 $d=(d_1, d_2, d_3)$ 且 $\\max_i |d_i|=1$。然后，整个扰动由一个因子 $\\alpha$ 进行缩放，因此 $\\Delta = \\alpha \\, \\mathrm{diag}(d)$。扰动矩阵是 $E(d, \\alpha) = V \\, (\\alpha \\, \\mathrm{diag}(d)) \\, V^{-1} = \\alpha (V \\, \\mathrm{diag}(d) \\, V^{-1})$。\n为了强制 $\\lVert E(d, \\alpha) \\rVert_2 = \\varepsilon$，我们必须有：\n$$ |\\alpha| \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2 = \\varepsilon $$\n我们选择一个正的 $\\alpha$，所以 $\\alpha = \\varepsilon / \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2$。\n\n对于这种结构化扰动，最大特征值位移由 $s = \\max_j \\min_i |\\mu_j - \\lambda_i|$ 度量。由于 $\\mu_j = \\lambda_j + \\alpha d_j$，并假设 $\\alpha$ 足够小，与 $\\mu_j$ 最接近的原始特征值是 $\\lambda_j$ 本身。距离是 $|\\mu_j - \\lambda_j| = |\\alpha d_j|$。那么最大位移为：\n$$ s = \\max_j |\\alpha d_j| = \\alpha \\max_j|d_j| = \\alpha $$\n最后一个等式成立，因为我们选择的 $d$ 满足 $\\max_j|d_j|=1$。\n\n最终我们关心的量是观察到的最大位移 $s$ 与鲍尔-菲克界限 $r_{\\mathrm{BF}}$ 的比率：\n$$ \\frac{s}{r_{\\mathrm{BF}}} = \\frac{\\alpha}{\\kappa_2(V) \\varepsilon} = \\frac{\\varepsilon / \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2}{\\kappa_2(V) \\varepsilon} = \\frac{1}{\\kappa_2(V) \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2} $$\n问题要求通过搜索找到一个对抗性方向 $d$，以最小化量 $\\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2$。这种 $d$ 的选择将最大化比率 $s/r_{\\mathrm{BF}}$，从而创建一个对于此类结构化扰动尽可能接近饱和鲍尔-菲克界限的扰动。\n\n每个测试案例的计算步骤如下：\n1.  **构建矩阵**：根据提供的谱 $\\Lambda$ 和对角化矩阵 $V$ 的参数（旋转角 $\\theta$，缩放参数 $s$），构建 $V$，然后构建 $A = V \\Lambda V^{-1}$。对于案例3，$V$ 直接作为单位矩阵 $I_3$ 给出。\n2.  **计算条件数和界限**：计算 $V$ 的奇异值以求得 $\\kappa_2(V) = \\sigma_{\\max}(V) / \\sigma_{\\min}(V)$。使用给定的扰动范数 $\\varepsilon$ 计算鲍尔-菲克半径 $r_{\\mathrm{BF}} = \\kappa_2(V) \\varepsilon$。\n3.  **寻找对抗性方向**：数值搜索一个满足 $\\max_i |d_i|=1$ 的方向向量 $d$，以近似最小化 $\\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2$。搜索空间通过确定性向量（单位立方体的面中心和顶点）和一组随机向量的组合进行采样，以确保彻底的探索。\n4.  **构建扰动**：使用上一步找到的最优方向 $d^*$，计算缩放因子 $\\alpha = \\varepsilon / \\lVert V \\, \\mathrm{diag}(d^*) \\, V^{-1} \\rVert_2$。扰动矩阵则为 $E = V \\, \\mathrm{diag}(\\alpha d^*) \\, V^{-1}$。\n5.  **计算位移和比率**：计算 $A$ 和 $A+E$ 的特征值。通过将每个扰动后的特征值与最接近的原始特征值配对，找到最大位移 $s = \\max_j \\min_i |\\lambda_j(A+E) - \\lambda_i(A)|$。最后，计算比率 $s / r_{\\mathrm{BF}}$。\n\n此程序将应用于所有三个指定的测试案例，这些案例旨在探索高条件数、中等条件数以及理想的正交情况（$\\kappa_2(V)=1$）下的各种情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the full analysis for the three test cases as specified in the problem.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (large kappa_2(V))\n        {\n            \"lambdas\": [1.0, -2.0, 4.0],\n            \"theta\": np.pi / 4,\n            \"s_scale\": 1e-2,\n            \"epsilon\": 1e-2,\n            \"v_is_identity\": False\n        },\n        # Case 2 (moderate kappa_2(V))\n        {\n            \"lambdas\": [0.5, -1.5, 3.0],\n            \"theta\": np.pi / 4,\n            \"s_scale\": 0.3,\n            \"epsilon\": 5e-3,\n            \"v_is_identity\": False\n        },\n        # Case 3 (baseline, kappa_2(V)=1)\n        {\n            \"lambdas\": [2.0, 0.0, -1.0],\n            \"theta\": 0.0, # Not used, but for completeness\n            \"s_scale\": 1.0, # Not used\n            \"epsilon\": 1e-3,\n            \"v_is_identity\": True\n        }\n    ]\n\n    results = []\n    \n    # Generate candidate directions 'd' for the search\n    # Deterministic candidates: face centers and vertices of the unit cube\n    det_candidates = []\n    # Face centers\n    for i in range(3):\n        for sign in [-1, 1]:\n            d = np.zeros(3)\n            d[i] = sign\n            det_candidates.append(d)\n    # Vertices\n    for i in [-1, 1]:\n        for j in [-1, 1]:\n            for k in [-1, 1]:\n                det_candidates.append(np.array([i, j, k], dtype=float))\n    \n    # Random candidates\n    rng = np.random.default_rng(seed=42)\n    rand_candidates = rng.uniform(-1, 1, size=(1000, 3))\n    max_abs = np.max(np.abs(rand_candidates), axis=1, keepdims=True)\n    rand_candidates /= max_abs\n    \n    all_candidates_d = np.unique(np.vstack(det_candidates + list(rand_candidates)), axis=0)\n\n    for case in test_cases:\n        Lambda = np.diag(case[\"lambdas\"])\n        epsilon = case[\"epsilon\"]\n\n        # Step 1: Construct Matrices\n        if case[\"v_is_identity\"]:\n            V = np.identity(3)\n        else:\n            theta = case[\"theta\"]\n            s_param = case[\"s_scale\"]\n            W_theta = np.array([\n                [np.cos(theta),  0, np.sin(theta)],\n                [0,              1, 0            ],\n                [-np.sin(theta), 0, np.cos(theta)]\n            ])\n            Sigma = np.diag([1, s_param, s_param**2])\n            V = Sigma @ W_theta.T\n        \n        A = V @ Lambda @ np.linalg.inv(V)\n\n        # Step 2: Compute Condition Number and Bound\n        singular_values_V = np.linalg.svd(V, compute_uv=False)\n        kappa_2_V = singular_values_V[0] / singular_values_V[-1]\n        r_bf = kappa_2_V * epsilon\n\n        # Step 3: Find Adversarial Direction\n        V_inv = np.linalg.inv(V)\n        min_norm_M_d = np.inf\n        best_d = None\n\n        for d in all_candidates_d:\n            M_d = V @ np.diag(d) @ V_inv\n            norm_M_d = np.linalg.norm(M_d, 2)\n            if norm_M_d  min_norm_M_d:\n                min_norm_M_d = norm_M_d\n                best_d = d\n        \n        # Step 4: Construct Perturbation\n        alpha = epsilon / min_norm_M_d\n        Delta = np.diag(alpha * best_d)\n        E = V @ Delta @ V_inv\n        \n        # Verify norm of E\n        # norm_E = np.linalg.norm(E, 2)\n        # assert np.isclose(norm_E, epsilon)\n\n        A_plus_E = A + E\n\n        # Step 5: Calculate Displacement and Ratio\n        # Eigenvalues of A are known, but we recompute for robustness.\n        # They may not be sorted, so we sort them.\n        eigvals_A = np.sort(np.linalg.eigvals(A).real)\n        eigvals_A_plus_E = np.sort(np.linalg.eigvals(A_plus_E).real)\n        \n        # Calculate s = max_j min_i |lambda_j(A+E) - lambda_i(A)|\n        dist_matrix = np.abs(eigvals_A_plus_E[:, np.newaxis] - eigvals_A[np.newaxis, :])\n        min_dists = np.min(dist_matrix, axis=1)\n        s = np.max(min_dists)\n\n        # In this specific structured perturbation, s should be ~alpha.\n        # We use the rigorously computed s as per problem statement.\n        \n        ratio = s / r_bf\n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3585060"}]}