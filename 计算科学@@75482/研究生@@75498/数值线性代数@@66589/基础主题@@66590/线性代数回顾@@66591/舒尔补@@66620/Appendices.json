{"hands_on_practices": [{"introduction": "要真正掌握舒尔补，我们必须从抽象的定义走向具体的计算。第一个练习提供了一个直接的、动手的机会，来为一个简单的分块矩阵计算舒尔补 [@problem_id:1074949]。通过手动执行分块高斯消元的步骤，您将巩固对公式 $S = D - C A^{-1} B$ 的理解，并对子块如何相互作用产生直观感受。", "problem": "考虑如下定义的 $3 \\times 3$ 实矩阵 $M$：\n$$\nM = \\begin{bmatrix}\n4  1  2 \\\\\n3  5  6 \\\\\n4  7  8\n\\end{bmatrix}.\n$$\n将 $M$ 分块，其中左上角块 $A$ 是 $1 \\times 1$ 的，右上角块 $B$ 是 $1 \\times 2$ 的，左下角块 $C$ 是 $2 \\times 1$ 的，右下角块 $D$ 是 $2 \\times 2$ 的。使用分块高斯消元法，计算 $A$ 在 $M$ 中的舒尔补 (Schur complement)，记为 $S = D - C A^{-1} B$。报告所得的 $2 \\times 2$ 舒尔补矩阵 $S$ 的第二行第一列的元素。", "solution": "1. 将矩阵 $M$ 分块如下：\n$$\nM=\\begin{pmatrix}\nA  B \\\\\nC  D\n\\end{pmatrix},\n\\quad \\text{其中} \\quad\nA=[4],\\;\nB=\\begin{bmatrix}1  2\\end{bmatrix},\\;\nC=\\begin{pmatrix}3\\\\4\\end{pmatrix},\\;\nD=\\begin{pmatrix}5  6\\\\7  8\\end{pmatrix}.\n$$\n2. 因为 $A$ 是标量 $4$，其逆为：\n$$\nA^{-1} = \\frac{1}{4}.\n$$\n3. 计算乘积 $C A^{-1} B$：\n$$\nC A^{-1} B = \\begin{pmatrix}3\\\\4\\end{pmatrix} \\left(\\frac{1}{4}\\right) \\begin{bmatrix}1  2\\end{bmatrix}\n= \\frac{1}{4} \\begin{pmatrix}3  6\\\\4  8\\end{pmatrix}\n= \\begin{pmatrix}\\frac{3}{4}  \\frac{3}{2}\\\\ 1  2\\end{pmatrix}.\n$$\n4. 舒尔补为：\n$$\nS = D - C A^{-1} B\n= \\begin{pmatrix}5  6\\\\7  8\\end{pmatrix}\n- \\begin{pmatrix}\\frac{3}{4}  \\frac{3}{2}\\\\1  2\\end{pmatrix}\n= \\begin{pmatrix}5-\\frac{3}{4}  6-\\frac{3}{2} \\\\ 7-1  8-2\\end{pmatrix}\n= \\begin{pmatrix}\\frac{17}{4}  \\frac{9}{2} \\\\ 6  6\\end{pmatrix}.\n$$\n5. $S$ 的第二行第一列的元素是：\n$$\nS_{2,1} = 6.\n$$", "answer": "$$\\boxed{6}$$", "id": "1074949"}, {"introduction": "虽然构造舒尔补是一个强大的代数工具，但其数值性质需要我们审慎考察。本练习提出了一个发人深省的场景，它表明即使原始矩阵的子块具有完美的条件数，所产生的舒尔补也可能变得严重病态 [@problem_id:3222493]。这项实践对于培养对分块消元方法中潜在的数值稳定性挑战的认识至关重要。", "problem": "考虑一个 $2 \\times 2$ 的分块线性系统，其分块矩阵为\n$$\nM \\;=\\; \\begin{pmatrix}\nA  B \\\\\nC  D\n\\end{pmatrix},\n$$\n其中\n$$\nA \\;=\\; I_{2}, \\quad B \\;=\\; \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix}, \\quad C \\;=\\; B^{\\top}, \\quad D \\;=\\; 0_{2},\n$$\n且 $\\varepsilon \\in (0,1]$。通过进行分块高斯消去法来消去与 $A$ 相关的变量，可以得到 $A$ 在 $M$ 中的舒尔补 $S$。使用谱范数和 $2$-范数条件数 $\\kappa_{2}(\\cdot)$ 的基本定义，计算 $\\kappa_{2}(S)$ 作为 $\\varepsilon$ 的函数的精确封闭形式表达式。请以关于 $\\varepsilon$ 的单个简化解析表达式的形式给出最终答案。", "solution": "该问题要求计算给定 $2 \\times 2$ 分块矩阵 $M$ 的舒尔补的 $2$-范数条件数 $\\kappa_2(S)$。该分块矩阵为\n$$\nM \\;=\\; \\begin{pmatrix}\nA  B \\\\\nC  D\n\\end{pmatrix}\n$$\n其中各分块为\n$$\nA \\;=\\; I_{2} \\;=\\; \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad B \\;=\\; \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix}, \\quad C \\;=\\; B^{\\top}, \\quad D \\;=\\; 0_{2} \\;=\\; \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n参数 $\\varepsilon$ 被限制在区间 $\\varepsilon \\in (0,1]$ 内。\n\n矩阵 $M$ 中分块 $A$ 的舒尔补 $S$ 是通过分块高斯消去过程形成的。$A$ 在 $M$ 中的舒尔补的一般公式为\n$$\nS \\;=\\; D - CA^{-1}B.\n$$\n这个定义是明确的，因为矩阵 $A = I_2$ 是可逆的，其逆矩阵为 $A^{-1} = I_2^{-1} = I_2$。\n\n现在我们可以将给定的矩阵代入 $S$ 的公式中。矩阵 $C$ 是 $B$ 的转置：\n$$\nC \\;=\\; B^{\\top} \\;=\\; \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix}^{\\top} \\;=\\; \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix}.\n$$\n注意到 $C=B$。将各分块代入 $S$ 的定义中：\n$$\nS \\;=\\; 0_{2} - B^{\\top} I_{2} B \\;=\\; -B^{\\top}B.\n$$\n现在，我们计算乘积 $B^{\\top}B$：\n$$\nS \\;=\\; - \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix} \\;=\\; - \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 0  1 \\cdot 0 + 0 \\cdot \\varepsilon \\\\ 0 \\cdot 1 + \\varepsilon \\cdot 0  0 \\cdot 0 + \\varepsilon \\cdot \\varepsilon \\end{pmatrix} \\;=\\; - \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon^2 \\end{pmatrix}.\n$$\n因此，舒尔补是这个对角矩阵 $S = \\begin{pmatrix} -1  0 \\\\ 0  -\\varepsilon^2 \\end{pmatrix}$。\n\n下一步是计算 $S$ 的 $2$-范数条件数，记为 $\\kappa_{2}(S)$。对于一个可逆矩阵 $S$，其条件数的定义是\n$$\n\\kappa_{2}(S) \\;=\\; \\|S\\|_{2} \\|S^{-1}\\|_{2},\n$$\n其中 $\\| \\cdot \\|_{2}$ 是谱范数（矩阵 $2$-范数）。矩阵 $S$ 是可逆的，因为它的行列式为 $\\det(S) = (-1)(-\\varepsilon^2) = \\varepsilon^2$，对于 $\\varepsilon \\in (0,1]$，该值非零。\n\n对于任意矩阵 $X$，谱范数 $\\|X\\|_{2}$ 定义为 $X$ 的最大奇异值 $\\sigma_{\\max}(X)$。奇异值是 $X^{\\top}X$ 的特征值的平方根。\n\n在我们的例子中，矩阵 $S$ 是一个实对称矩阵。对于对称矩阵，奇异值是其特征值的绝对值。对角矩阵的特征值是其对角线上的元素。因此，$S$ 的特征值为 $\\lambda_1 = -1$ 和 $\\lambda_2 = -\\varepsilon^2$。\n\n$S$ 的谱范数是其特征值绝对值的最大值：\n$$\n\\|S\\|_{2} \\;=\\; \\max(|\\lambda_1|, |\\lambda_2|) \\;=\\; \\max(|-1|, |-\\varepsilon^2|) \\;=\\; \\max(1, \\varepsilon^2).\n$$\n给定 $\\varepsilon \\in (0,1]$，我们有 $0  \\varepsilon \\le 1$，这意味着 $0  \\varepsilon^2 \\le 1$。因此，\n$$\n\\|S\\|_{2} \\;=\\; \\max(1, \\varepsilon^2) \\;=\\; 1.\n$$\n\n接下来，我们计算逆矩阵的范数，$\\|S^{-1}\\|_{2}$。首先，我们求出 $S^{-1}$：\n$$\nS^{-1} \\;=\\; \\left(- \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon^2 \\end{pmatrix}\\right)^{-1} \\;=\\; - \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon^2 \\end{pmatrix}^{-1} \\;=\\; - \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\varepsilon^2} \\end{pmatrix} \\;=\\; \\begin{pmatrix} -1  0 \\\\ 0  -\\frac{1}{\\varepsilon^2} \\end{pmatrix}.\n$$\n矩阵 $S^{-1}$ 也是对称的。其特征值是其对角线元素，$\\mu_1 = -1$ 和 $\\mu_2 = -1/\\varepsilon^2$。$S^{-1}$ 的谱范数是其特征值绝对值的最大值：\n$$\n\\|S^{-1}\\|_{2} \\;=\\; \\max(|\\mu_1|, |\\mu_2|) \\;=\\; \\max(|-1|, |-\\frac{1}{\\varepsilon^2}|) \\;=\\; \\max\\left(1, \\frac{1}{\\varepsilon^2}\\right).\n$$\n因为 $\\varepsilon \\in (0,1]$，我们知道 $0  \\varepsilon^2 \\le 1$，这意味着 $\\frac{1}{\\varepsilon^2} \\ge 1$。因此，\n$$\n\\|S^{-1}\\|_{2} \\;=\\; \\max\\left(1, \\frac{1}{\\varepsilon^2}\\right) \\;=\\; \\frac{1}{\\varepsilon^2}.\n$$\n最后，我们通过将两个范数相乘来计算条件数：\n$$\n\\kappa_{2}(S) \\;=\\; \\|S\\|_{2} \\|S^{-1}\\|_{2} \\;=\\; 1 \\cdot \\frac{1}{\\varepsilon^2} \\;=\\; \\frac{1}{\\varepsilon^2}.\n$$\n\n对于对称矩阵，一个更直接的替代方法是将条件数计算为最大绝对特征值与最小绝对特征值的比值：\n$$\n\\kappa_2(S) = \\frac{\\max_i |\\lambda_i|}{\\min_j |\\lambda_j|}.\n$$\n$S$ 的特征值的绝对值为 $1$ 和 $\\varepsilon^2$。这些值的最大值和最小值是：\n$$\n\\max(|\\lambda_1|, |\\lambda_2|) = \\max(1, \\varepsilon^2) = 1,\n$$\n$$\n\\min(|\\lambda_1|, |\\lambda_2|) = \\min(1, \\varepsilon^2) = \\varepsilon^2,\n$$\n因为 $\\varepsilon \\in (0,1]$。\n因此，条件数为\n$$\n\\kappa_{2}(S) \\;=\\; \\frac{1}{\\varepsilon^2}.\n$$\n两种方法得到相同的结果。条件数的最终表达式是 $\\varepsilon$ 的一个函数。", "answer": "$$\n\\boxed{\\frac{1}{\\varepsilon^2}}\n$$", "id": "3222493"}, {"introduction": "在现代大规模科学计算中，由于舒尔补矩阵的规模和潜在的稠密性，显式地构造它往往计算成本过高。最后的这项实践介绍了现代的“无矩阵”（matrix-free）方法，这对于高效求解此类问题至关重要 [@problem_id:3595834]。您将探索如何在从不计算舒尔补矩阵本身的情况下，使用迭代求解器将其逆矩阵作用于一个向量，这项技术是高级数值算法的基石。", "problem": "设矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 可依尺寸分块为\n$$\nA \\;=\\; \\begin{bmatrix}\nA_{11}  A_{12} \\\\\nA_{21}  A_{22}\n\\end{bmatrix},\n$$\n其中 $A_{11} \\in \\mathbb{R}^{n_1 \\times n_1}$ 为非奇异矩阵，$A_{22} \\in \\mathbb{R}^{n_2 \\times n_2}$，且 $n_1 + n_2 = n$。假设 $A_{11}$ 的一个LU分解（Lower–Upper decomposition）$A_{11} = L_{11} U_{11}$ 已知，其中 $L_{11}$ 和 $U_{11}$ 是三角且非奇异的矩阵。$A$ 中关于 $A_{11}$ 的舒尔补（Schur complement）记为 $S_{22\\cdot 11} \\in \\mathbb{R}^{n_2 \\times n_2}$。给定一个向量 $v \\in \\mathbb{R}^{n_2}$，要求在不显式构造 $S_{22\\cdot 11}$ 的情况下，实现操作 $y = S_{22\\cdot 11}^{-1} v$。\n\n允许使用的基本操作如下：\n- 使用 $L_{11}$ 和 $U_{11}$ 进行三角求解（因此，对于给定的 $t \\in \\mathbb{R}^{n_1}$，可以通过求解 $L_{11} s = t$ 和 $U_{11} w = s$ 来计算 $w = A_{11}^{-1} t$），\n- 与 $A_{21}$ 和 $A_{12}$ 的矩阵-向量乘积，\n- 与 $A_{22}$ 的矩阵-向量乘积，\n- 标准的迭代线性求解器，其仅要求能够将线性算子作用于向量。\n\n根据数值线性代数中块高斯消元和基于算子的迭代方法的基本原理，在所述约束下且不构造 $S_{22\\cdot 11}$ 的情况下，以下哪种策略能正确实现 $y = S_{22\\cdot 11}^{-1} v$？\n\nA. 使用克里洛夫子空间法（Krylov subspace method）求解 $S_{22\\cdot 11} y = v$，其中算子作用 $z \\mapsto S_{22\\cdot 11} z$ 的实现如下：给定 $z \\in \\mathbb{R}^{n_2}$，计算 $t = A_{12} z$，求解 $L_{11} s = t$ 和 $U_{11} w = s$ 得到 $w = A_{11}^{-1} t$，计算 $r = A_{21} w$，并返回 $A_{22} z - r$。\n\nB. 使用克里洛夫子空间法求解 $S_{22\\cdot 11} y = v$，其中算子作用 $z \\mapsto S_{22\\cdot 11} z$ 的实现如下：给定 $z \\in \\mathbb{R}^{n_2}$，计算 $t = A_{12} z$，求解 $L_{11} s = t$ 和 $U_{11} w = s$ 得到 $w = A_{11}^{-1} t$，计算 $r = A_{21} w$，并返回 $A_{22} z + r$。\n\nC. 求解镶边系统 $A \\begin{bmatrix} x \\\\ y \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ v \\end{bmatrix}$，首先计算 $y = A_{22}^{-1} v$，然后通过三角求解计算 $x = -A_{11}^{-1} A_{12} y$，并将得到的 $y$ 作为 $S_{22\\cdot 11}^{-1} v$。\n\nD. 使用 Sherman–Morrison–Woodbury 恒等式，通过使用 $A_{11}$ 的三角求解以及与 $A_{21}$、$A_{12}$ 和 $A_{22}$ 的矩阵-向量乘积，精确计算 $y = A_{22}^{-1} v - A_{22}^{-1} A_{21} A_{11}^{-1} A_{12} A_{22}^{-1} v$。", "solution": "问题的目标是在不显式构造舒尔补矩阵 $S_{22\\cdot 11}$ 的情况下，计算向量 $y = S_{22\\cdot 11}^{-1} v$。这等价于求解线性系统 $S_{22\\cdot 11} y = v$。\n\n由于我们不能显式构造 $S_{22\\cdot 11}$，直接求解方法（如LU分解）是不可行的。然而，诸如共轭梯度法（CG）或广义最小残差法（GMRES）之类的克里洛夫子空间迭代求解器正适用于此种情况。这类方法的核心要求是能够高效地计算矩阵与任意向量的乘积（即“算子作用”），而无需存储整个矩阵。\n\n在本问题中，我们需要为迭代求解器提供一个函数，该函数接收一个向量 $z \\in \\mathbb{R}^{n_2}$ 并返回乘积 $S_{22\\cdot 11} z$。我们来推导这个操作的步骤。\n\n根据舒尔补的定义：\n$$\nS_{22\\cdot 11} = A_{22} - A_{21} A_{11}^{-1} A_{12}\n$$\n因此，它与向量 $z$ 的乘积为：\n$$\nS_{22\\cdot 11} z = (A_{22} - A_{21} A_{11}^{-1} A_{12}) z = A_{22} z - A_{21} (A_{11}^{-1} (A_{12} z))\n$$\n我们可以利用问题中允许的基本操作，将这个计算过程分解为一系列可执行的步骤：\n1.  计算向量 $t = A_{12} z$。这是一个矩阵-向量乘积。\n2.  计算向量 $w = A_{11}^{-1} t$。由于 $A_{11}$ 的LU分解 $A_{11} = L_{11} U_{11}$ 已知，这一步通过求解线性系统 $A_{11} w = t$ 来完成，即先通过前向替换解 $L_{11} s = t$ 得到 $s$，然后通过后向替换解 $U_{11} w = s$ 得到 $w$。这正是利用给定的三角求解操作。\n3.  计算向量 $r = A_{21} w$。这是另一个矩阵-向量乘积。\n4.  最终结果是 $A_{22} z - r$。这包括一个矩阵-向量乘积和一个向量减法。\n\n现在，我们分析给出的四个选项：\n\n**A.** 该选项描述的算子作用过程如下：给定 $z$，计算 $t = A_{12} z$，求解 $A_{11}^{-1}t$ 得到 $w$，计算 $r = A_{21} w$，最后返回 $A_{22} z - r$。这与我们上面推导的步骤完全吻合。因此，使用该算子作用的克里洛夫子空间法是求解 $S_{22\\cdot 11} y = v$ 的正确策略。\n\n**B.** 该选项的最后一步是返回 $A_{22} z + r$。这在减法项上有一个符号错误，计算的是 $(A_{22} + A_{21} A_{11}^{-1} A_{12})z$，而不是 $S_{22\\cdot 11} z$。因此，该选项不正确。\n\n**C.** 该选项提出求解镶边系统 $A \\begin{bmatrix} x \\\\ y \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ v \\end{bmatrix}$。虽然这个系统的解 $y$ 确实是 $S_{22\\cdot 11}^{-1} v$，但该选项描述的求解过程是错误的。它声称首先计算 $y = A_{22}^{-1} v$，这不仅在逻辑上是错误的（它忽略了 $A_{21}$ 和 $A_{12}$ 的影响），而且还使用了 $A_{22}^{-1}$，这是一个不允许使用的基本操作（问题没有提供 $A_{22}$ 的分解）。因此，该选项不正确。\n\n**D.** 该选项引用了Sherman-Morrison-Woodbury恒等式，但给出的公式是错误的，并且它同样要求计算 $A_{22}^{-1}v$，这超出了允许的操作范围。因此，该选项不正确。\n\n综上所述，只有选项A描述了在给定约束下正确且可行的无矩阵策略。", "answer": "$$\\boxed{A}$$", "id": "3595834"}]}