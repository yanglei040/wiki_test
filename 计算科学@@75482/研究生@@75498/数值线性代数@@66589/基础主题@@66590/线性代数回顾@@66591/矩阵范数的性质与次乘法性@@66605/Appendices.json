{"hands_on_practices": [{"introduction": "次可加性（submultiplicativity）属性，即 $\\|AB\\|_2 \\le \\|A\\|_2 \\|B\\|_2$，是矩阵分析的基石。本次练习将超越简单记忆该不等式，深入探讨一个关键问题：该不等式在何种情况下会趋近或完全等同于等式？通过一个精心构造的例子 [@problem_id:3568447]，您将探索奇异向量的对齐如何导致最大化的放大效应，即便矩阵本身是近奇异的。这一现象被称为“伪共振”（pseudoresonance），它将加深您对非正常矩阵及其在动力系统中产生瞬时增长（transient growth）作用的理解。", "problem": "考虑诱导欧几里得矩阵范数（也称为谱范数），它对任意实矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 定义为 $\\|A\\|_{2} = \\max_{\\|x\\|_{2}=1} \\|A x\\|_{2}$。并回想其次乘性 $\\|A B\\|_{2} \\le \\|A\\|_{2}\\,\\|B\\|_{2}$ 和奇异值分解 (SVD) 表示 $A = U \\Sigma V^{\\top}$，其中 $U, V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma$ 是对角线上为非负对角元（奇异值）的对角矩阵。设 $n=2$，并令 $u, w, v, z, y, t \\in \\mathbb{R}^{2}$ 为单位向量，使得 $U=[u\\; w]$、$V=[v\\; z]$ 和 $W=[y\\; t]$ 是正交矩阵。对于参数 $\\varepsilon \\in (0,1)$，定义\n$$\nA_{\\varepsilon} = U \\begin{pmatrix} 1 & 0 \\\\ 0 & \\varepsilon \\end{pmatrix} V^{\\top}, \\qquad B_{\\varepsilon} = V \\begin{pmatrix} 1 & 0 \\\\ 0 & \\varepsilon \\end{pmatrix} W^{\\top}.\n$$\n因此，$A_{\\varepsilon}$ 和 $B_{\\varepsilon}$ 的奇异值为 $1$ 和 $\\varepsilon$，并且对于小的 $\\varepsilon$ 它们是近奇异的（它们的条件数是 $1/\\varepsilon$）。再考虑由 $V' = [z\\; v]$（即交换 $V$ 的列）构成的未对齐乘积，\n$$\nB'_{\\varepsilon} = V' \\begin{pmatrix} 1 & 0 \\\\ 0 & \\varepsilon \\end{pmatrix} W^{\\top}.\n$$\n回答以下多项选择题，选择所有正确的选项。你的推理应基于上述核心定义，不应假设任何未说明的性质。\n\n下列关于 $\\|A_{\\varepsilon} B_{\\varepsilon}\\|_{2}$、$\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_{2}$ 以及 $\\|A B\\|_{2} \\le \\|A\\|_{2} \\|B\\|_{2}$ 中近似相等背后的机制的陈述，哪些是正确的？\n\nA. 在诱导欧几里得范数中，如果 $B$ 的主左奇异向量等于 $A$ 的主右奇异向量，则 $\\|A B\\|_{2} = \\|A\\|_{2}\\, \\|B\\|_{2}$。\n\nB. 对于上面定义的对齐因子 $A_{\\varepsilon}$ 和 $B_{\\varepsilon}$，对所有 $\\varepsilon \\in (0,1)$，都有 $\\|A_{\\varepsilon} B_{\\varepsilon}\\|_{2} = \\|A_{\\varepsilon}\\|_{2}\\, \\|B_{\\varepsilon}\\|_{2}$，尽管 $A_{\\varepsilon}$ 和 $B_{\\varepsilon}$ 都是近奇异的（条件数为 $1/\\varepsilon$）。\n\nC. 对于未对齐的因子 $B'_{\\varepsilon}$，有 $\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_{2} = \\varepsilon$，因此比率 $\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_{2} / (\\|A_{\\varepsilon}\\|_{2}\\, \\|B'_{\\varepsilon}\\|_{2})$ 等于 $\\varepsilon$。\n\nD. 对于任何酉不变范数（包括谱范数），等式 $\\|A B\\| = \\|A\\|\\, \\|B\\|$ 成立的必要条件是 $A$ 和 $B$ 都是正规矩阵。\n\nE. 上述对齐情况是非正规乘积中一种被称为伪共振的放大机制的例证：左、右奇异向量的近共振对齐导致了在次乘性界中的近似相等，并因此产生了与各自放大率之积相当的瞬时增长，尽管每个因子都是近奇异的。\n\n选择所有正确的选项。", "solution": "首先将对问题陈述的科学合理性、一致性和适定性进行验证。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **范数定义**：对于 $A \\in \\mathbb{R}^{n \\times n}$，诱导欧几里得矩阵范数（谱范数）为 $\\|A\\|_{2} = \\max_{\\|x\\|_{2}=1} \\|A x\\|_{2}$。\n- **性质**：次乘性，$\\|A B\\|_{2} \\le \\|A\\|_{2}\\,\\|B\\|_{2}$。\n- **矩阵表示**：奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U, V \\in \\mathbb{R}^{n \\times n}$ 为正交矩阵，$\\Sigma$ 为对角线上有非负对角元（奇异值）的对角矩阵。\n- **参数**：维数为 $n=2$。参数 $\\varepsilon$ 在区间 $(0,1)$ 内。\n- **向量和矩阵定义**：\n    - $u, w, v, z, y, t \\in \\mathbb{R}^{2}$ 是单位向量。\n    - $U=[u\\; w]$, $V=[v\\; z]$, 和 $W=[y\\; t]$ 是正交矩阵。\n    - $A_{\\varepsilon} = U \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} V^{\\top}$。\n    - $B_{\\varepsilon} = V \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} W^{\\top}$。\n    - 题目指出 $A_{\\varepsilon}$ 和 $B_{\\varepsilon}$ 的奇异值为 $1$ 和 $\\varepsilon$，且它们的条件数为 $1/\\varepsilon$。\n    - $V' = [z\\; v]$。\n    - $B'_{\\varepsilon} = V' \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} W^{\\top}$。\n- **问题**：评估关于 $\\|A_{\\varepsilon} B_{\\varepsilon}\\|_{2}$、$\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_{2}$ 以及次乘性不等式中近似相等条件的五个陈述的正确性。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学基础**：本问题属于数值线性代数领域。所有定义——谱范数、SVD、正交矩阵、条件数——都是标准的且在数学上是正确的。构造矩阵 $A_{\\varepsilon}$、$B_{\\varepsilon}$ 和 $B'_{\\varepsilon}$ 是阐释矩阵乘积性质的常用且有效的方法。本问题在科学上是合理的。\n- **适定性**：问题要求计算特定的矩阵范数并评估理论陈述。所给的设定提供了执行这些任务所需的所有必要信息，从而能够得出唯一且有意义的答案。\n- **客观性**：问题以精确的数学语言陈述，没有主观或模糊的术语。\n- **完整性与一致性**：定义是自洽的。$U=[u\\; w]$、$V=[v\\; z]$ 和 $W=[y\\; t]$ 是正交矩阵这一事实，意味着它们各自的列向量是标准正交的，这与它们是单位向量的初始陈述是一致的。从 $V=[v\\; z]$ 构造 $V'=[z\\; v]$ 正确地得到了另一个正交矩阵，因为它只是 $V$ 的一个列置换。没有内部矛盾。\n\n**第 3 步：结论与行动**\n问题陈述有效。可以开始分析。\n\n### 解题推导\n\n首先，我们确定给定矩阵的谱范数。谱范数 $\\|A\\|_2$ 等于 $A$ 的最大奇异值 $\\sigma_{\\max}(A)$。奇异值在与正交矩阵相乘时保持不变。\n\n对于 $A_{\\varepsilon} = U \\Sigma_{\\varepsilon} V^{\\top}$，其中 $\\Sigma_{\\varepsilon} = \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix}$，奇异值为 $1$ 和 $\\varepsilon$。因为 $\\varepsilon \\in (0,1)$，所以最大奇异值为 $1$。\n因此，$\\|A_{\\varepsilon}\\|_2 = 1$。\n\n对于 $B_{\\varepsilon} = V \\Sigma_{\\varepsilon} W^{\\top}$，奇异值也为 $1$ 和 $\\varepsilon$。\n因此，$\\|B_{\\varepsilon}\\|_2 = 1$。\n\n对于 $B'_{\\varepsilon} = V' \\Sigma_{\\varepsilon} W^{\\top}$，因为 $V'$ 也是一个正交矩阵，所以奇异值同样为 $1$ 和 $\\varepsilon$。\n因此，$\\|B'_{\\varepsilon}\\|_2 = 1$。\n\n现在，我们评估每个选项。\n\n**A. 在诱导欧几里得范数中，如果 $B$ 的主左奇异向量等于 $A$ 的主右奇异向量，则 $\\|A B\\|_{2} = \\|A\\|_{2}\\, \\|B\\|_{2}$。**\n\n设 $A$ 的 SVD 为 $A = U_A \\Sigma_A V_A^{\\top}$，$B$ 的 SVD 为 $B = U_B \\Sigma_B V_B^{\\top}$。奇异值排序为 $\\sigma_1(A) \\ge \\sigma_2(A) \\ge \\dots$ 和 $\\sigma_1(B) \\ge \\sigma_2(B) \\ge \\dots$。范数为 $\\|A\\|_2 = \\sigma_1(A)$ 和 $\\|B\\|_2 = \\sigma_1(B)$。\n\n$A$ 的主右奇异向量是 $V_A$ 的第一列，记作 $v_{A1}$。\n$B$ 的主左奇异向量是 $U_B$ 的第一列，记作 $u_{B1}$。\n假设是 $v_{A1} = u_{B1}$。\n\n让我们考虑 $AB$ 作用在特定单位向量 $x = v_{B1}$ 上的情况，它是 $B$ 的主右奇异向量。\n首先，$Bx = B v_{B1} = (U_B \\Sigma_B V_B^{\\top}) v_{B1} = U_B \\Sigma_B e_1 = U_B (\\sigma_1(B)e_1) = \\sigma_1(B)u_{B1} = \\|B\\|_2 u_{B1}$。\n接下来，我们计算 $A(Bx)$：\n$A(Bx) = A(\\|B\\|_2 u_{B1}) = \\|B\\|_2 A u_{B1}$。\n使用假设 $u_{B1} = v_{A1}$：\n$A u_{B1} = A v_{A1} = (U_A \\Sigma_A V_A^{\\top}) v_{A1} = U_A \\Sigma_A e_1 = U_A (\\sigma_1(A)e_1) = \\sigma_1(A) u_{A1} = \\|A\\|_2 u_{A1}$。\n将此代回，我们得到：\n$A(Bx) = \\|B\\|_2 (\\|A\\|_2 u_{A1}) = \\|A\\|_2 \\|B\\|_2 u_{A1}$。\n\n现在，我们取范数：\n$\\|ABv_{B1}\\|_2 = \\| \\|A\\|_2 \\|B\\|_2 u_{A1} \\|_2 = \\|A\\|_2 \\|B\\|_2 \\|u_{A1}\\|_2$。\n因为 $u_{A1}$ 是一个正交矩阵的列，所以它是一个单位向量，故 $\\|u_{A1}\\|_2 = 1$。\n因此，对于特定的单位向量 $x=v_{B1}$，我们有 $\\|ABx\\|_2 = \\|A\\|_2 \\|B\\|_2$。\n\n矩阵范数的定义是 $\\|AB\\|_2 = \\max_{\\|x\\|_2=1} \\|ABx\\|_2$。既然我们找到了一个向量，使得范数 $\\|ABx\\|_2$ 达到了值 $\\|A\\|_2 \\|B\\|_2$，我们必有 $\\|AB\\|_2 \\ge \\|A\\|_2 \\|B\\|_2$。\n结合次乘性 $\\|AB\\|_2 \\le \\|A\\|_2 \\|B\\|_2$，这证明了 $\\|AB\\|_2 = \\|A\\|_2 \\|B\\|_2$。\n\n结论：**正确**。\n\n**B. 对于上面定义的对齐因子 $A_{\\varepsilon}$ 和 $B_{\\varepsilon}$，对所有 $\\varepsilon \\in (0,1)$，都有 $\\|A_{\\varepsilon} B_{\\varepsilon}\\|_{2} = \\|A_{\\varepsilon}\\|_{2}\\, \\|B_{\\varepsilon}\\|_{2}$，尽管 $A_{\\varepsilon}$ 和 $B_{\\varepsilon}$ 都是近奇异的（条件数为 $1/\\varepsilon$）。**\n\n让我们计算乘积 $A_{\\varepsilon} B_{\\varepsilon}$：\n$A_{\\varepsilon} B_{\\varepsilon} = \\left(U \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} V^{\\top}\\right) \\left(V \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} W^{\\top}\\right)$。\n因为 $V$ 是正交矩阵，所以 $V^{\\top}V = I$，其中 $I$ 是单位矩阵。\n$A_{\\varepsilon} B_{\\varepsilon} = U \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} I \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} W^{\\top} = U \\left(\\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix}\\right)^2 W^{\\top}$。\n对角矩阵的平方是：\n$\\left(\\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix}\\right)^2 = \\begin{pmatrix} 1^2  & 0 \\\\ 0  & \\varepsilon^2 \\end{pmatrix} = \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon^2 \\end{pmatrix}$。\n所以，$A_{\\varepsilon} B_{\\varepsilon} = U \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon^2 \\end{pmatrix} W^{\\top}$。\n这个表达式是 $A_{\\varepsilon} B_{\\varepsilon}$ 的 SVD。奇异值为 $1$ 和 $\\varepsilon^2$。\n谱范数是最大奇异值：$\\|A_{\\varepsilon} B_{\\varepsilon}\\|_2 = 1$。\n各自范数的乘积是 $\\|A_{\\varepsilon}\\|_{2}\\, \\|B_{\\varepsilon}\\|_{2} = 1 \\cdot 1 = 1$。\n因此，$\\|A_{\\varepsilon} B_{\\varepsilon}\\|_{2} = \\|A_{\\varepsilon}\\|_{2}\\, \\|B_{\\varepsilon}\\|_{2}$ 成立。\n该陈述正确地指出这些矩阵是近奇异的，条件数为 $\\kappa_2(A_\\varepsilon) = \\sigma_{\\max}/\\sigma_{\\min} = 1/\\varepsilon$。这是一个事实性观察。\n这个情况是选项 A 中原理的一个具体例子。$A_{\\varepsilon}$ 的主右奇异向量是 $V$ 的第一列，即 $v$。$B_{\\varepsilon}$ 的主左奇异向量也是 $V$ 的第一列，即 $v$。它们是相同的。\n\n结论：**正确**。\n\n**C. 对于未对齐的因子 $B'_{\\varepsilon}$，有 $\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_{2} = \\varepsilon$，因此比率 $\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_{2} / (\\|A_{\\varepsilon}\\|_{2}\\, \\|B'_{\\varepsilon}\\|_{2})$ 等于 $\\varepsilon$。**\n\n让我们计算乘积 $A_{\\varepsilon} B'_{\\varepsilon}$：\n$A_{\\varepsilon} B'_{\\varepsilon} = \\left(U \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} V^{\\top}\\right) \\left(V' \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} W^{\\top}\\right)$。\n我们需要计算矩阵乘积 $V^{\\top}V'$。\n$V = [v\\; z]$，所以 $V^{\\top} = \\begin{pmatrix} v^{\\top} \\\\ z^{\\top} \\end{pmatrix}$。$V' = [z\\; v]$。\n$V^{\\top}V' = \\begin{pmatrix} v^{\\top} \\\\ z^{\\top} \\end{pmatrix} [z\\; v] = \\begin{pmatrix} v^{\\top}z  & v^{\\top}v \\\\ z^{\\top}z  & z^{\\top}v \\end{pmatrix}$。\n因为 $V$ 是正交的，它的列 $\\{v, z\\}$ 是标准正交的。因此，$v^{\\top}v=1$，$z^{\\top}z=1$，且 $v^{\\top}z=z^{\\top}v=0$。\n$V^{\\top}V' = \\begin{pmatrix} 0  & 1 \\\\ 1  & 0 \\end{pmatrix}$，这是一个置換矩阵。我们称之为 $P$。\n乘积变为 $A_{\\varepsilon} B'_{\\varepsilon} = U \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} P \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} W^{\\top}$。\n让我们计算中间的矩阵：\n$\\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} \\begin{pmatrix} 0  & 1 \\\\ 1  & 0 \\end{pmatrix} \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 0  & 1 \\\\ \\varepsilon  & 0 \\end{pmatrix} \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 0  & \\varepsilon \\\\ \\varepsilon  & 0 \\end{pmatrix}$。\n令 $M = \\begin{pmatrix} 0  & \\varepsilon \\\\ \\varepsilon  & 0 \\end{pmatrix}$。乘积为 $A_{\\varepsilon} B'_{\\varepsilon} = U M W^{\\top}$。\n范数为 $\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_2 = \\|U M W^{\\top}\\|_2 = \\|M\\|_2$，这是由于范数的酉不变性。\n$M$ 的奇异值是 $M^{\\top}M$ 特征值的平方根。\n$M^{\\top}M = \\begin{pmatrix} 0  & \\varepsilon \\\\ \\varepsilon  & 0 \\end{pmatrix} \\begin{pmatrix} 0  & \\varepsilon \\\\ \\varepsilon  & 0 \\end{pmatrix} = \\begin{pmatrix} \\varepsilon^2  & 0 \\\\ 0  & \\varepsilon^2 \\end{pmatrix}$。\n$M^{\\top}M$ 的特征值为 $\\lambda_1 = \\varepsilon^2$ 和 $\\lambda_2 = \\varepsilon^2$。\n$M$ 的奇异值为 $\\sigma_1 = \\sqrt{\\varepsilon^2} = \\varepsilon$ 和 $\\sigma_2 = \\sqrt{\\varepsilon^2} = \\varepsilon$。\n最大奇异值为 $\\varepsilon$。所以，$\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_2 = \\|M\\|_2 = \\varepsilon$。\n陈述的第一部分是正确的。\n现在看比率：\n$\\frac{\\|A_{\\varepsilon} B'_{\\varepsilon}\\|_{2}}{\\|A_{\\varepsilon}\\|_{2}\\, \\|B'_{\\varepsilon}\\|_{2}} = \\frac{\\varepsilon}{1 \\cdot 1} = \\varepsilon$。\n整个陈述是正确的。\n\n结论：**正确**。\n\n**D. 对于任何酉不变范数（包括谱范数），等式 $\\|A B\\| = \\|A\\|\\, \\|B\\|$ 成立的必要条件是 $A$ 和 $B$ 都是正规矩阵。**\n\n一个矩阵 $X$ 是正规的，如果 $X X^{*} = X^{*} X$。对于实矩阵，这是 $X X^{\\top} = X^{\\top} X$。\n这是一个很强的论断，可以用一个反例来推翻。\n让我们检查选项 B 中的矩阵，我们已经证明了 $\\|A_{\\varepsilon} B_{\\varepsilon}\\|_2 = \\|A_{\\varepsilon}\\|_2 \\|B_{\\varepsilon}\\|_2$。让我们检查 $A_{\\varepsilon}$ 是否是正规的。\n$A_{\\varepsilon} = U \\Sigma_{\\varepsilon} V^{\\top}$，其中 $\\Sigma_{\\varepsilon} = \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon \\end{pmatrix}$。\n$A_{\\varepsilon}^{\\top} = V \\Sigma_{\\varepsilon} U^{\\top}$。\n$A_{\\varepsilon} A_{\\varepsilon}^{\\top} = (U \\Sigma_{\\varepsilon} V^{\\top})(V \\Sigma_{\\varepsilon} U^{\\top}) = U \\Sigma_{\\varepsilon}^2 U^{\\top}$。\n$A_{\\varepsilon}^{\\top} A_{\\varepsilon} = (V \\Sigma_{\\varepsilon} U^{\\top})(U \\Sigma_{\\varepsilon} V^{\\top}) = V \\Sigma_{\\varepsilon}^2 V^{\\top}$。\n要使 $A_{\\varepsilon}$ 是正规的，我们必须有 $A_{\\varepsilon} A_{\\varepsilon}^{\\top} = A_{\\varepsilon}^{\\top} A_{\\varepsilon}$，这意味着 $U \\Sigma_{\\varepsilon}^2 U^{\\top} = V \\Sigma_{\\varepsilon}^2 V^{\\top}$。\n因为 $\\varepsilon \\in (0,1)$，$\\Sigma_{\\varepsilon}^2 = \\begin{pmatrix} 1  & 0 \\\\ 0  & \\varepsilon^2 \\end{pmatrix}$ 不是单位矩阵的倍数。矩阵 $U \\Sigma_{\\varepsilon}^2 U^{\\top}$ 的特征空间由 $U$ 的列张成，而 $V \\Sigma_{\\varepsilon}^2 V^{\\top}$ 的特征空间由 $V$ 的列张成。如果 $U \\ne V$（并且 $V$ 不仅仅是通过列交换或符号更改与 $U$ 简单相关），这些矩阵将不相等。题目除了说 $U$ 和 $V$ 是正交的之外，没有说明它们之间的任何关系，所以我们不能假设它们相等。\n因此，$A_{\\varepsilon}$ 和 $B_{\\varepsilon}$ 一般来说不是正规矩阵。然而，它们满足等式条件。这直接作为该陈述的一个反例。\n\n结论：**不正确**。\n\n**E. 上述对齐情况是非正规乘积中一种被称为伪共振的放大机制的例证：左、右奇异向量的近共振对齐导致了在次乘性界中的近似相等，并因此产生了与各自放大率之积相当的瞬时增长，尽管每个因子都是近奇异的。**\n\n这个陈述为前面的计算提供了一个概念性的解释。让我们分析它的各个组成部分。\n- “上述对齐情况是非正规乘积中一种……放大机制的例证...”：如 D 中所示，$A_{\\varepsilon}$ 和 $B_{\\varepsilon}$ 通常是非正规的。“放大”指的是乘积的范数达到了可能的最大值 $\\|A\\|_2 \\|B\\|_2$，与未对齐情况下的抵消效应相反（选项 C），在那种情况下范数是一个小得多的值 $\\varepsilon$。\n- “...常被称为伪共振...”：在非正规矩阵的研究中，这是一个标准的技术术語，用来描述一个算子的输出强烈激发了后续算子的输入，从而导致巨大的总体响应的现象。\n- “...左、右奇异向量的近共振对齐...”：对于 $A_{\\varepsilon}$ 和 $B_{\\varepsilon}$ 的情况，对齐是完美的（共振的），而不仅仅是近共振的。$A_{\\varepsilon}$ 的主右奇异向量 ($v$) 与 $B_{\\varepsilon}$ 的主左奇异向量 ($v$) 完全相同。这就是范数具有乘性的机制，如 A 中所示。\n- “...导致了在次乘性界中的近似相等...”：在我们的例子中，它产生的是精确的相等，这是近似相等的极限情况。\n- “...并因此产生了与各自放大率之积相当的瞬时增长...”：“各自的放大率”是范数 $\\|A_{\\varepsilon}\\|_2=1$ 和 $\\|B_{\\varepsilon}\\|_2=1$。乘积是 $1$。乘积的范数 $\\|A_{\\varepsilon}B_{\\varepsilon}\\|_2=1$ 等于这个乘积。“瞬时增长”这个术语描述了矩阵的乘积或幂的一种行为，即即使长期行为（由谱半径决定）是衰减的，其范数也可能很大。这个例子是导致这种增长机制的一个两步说明。\n- “...尽管每个因子都是近奇异的。”：这是正确的，条件数是 $1/\\varepsilon$，对于小的 $\\varepsilon$ 来说很大。这突显了虽然每个矩阵在某些方向上强烈收缩向量，但共振对齐确保了这些收缩方向被避开。\n\n该陈述使用该领域的既定术语，对选项 A、B 和 C 中展示的数学现象进行了物理上和概念上准确的描述。\n\n结论：**正确**。", "answer": "$$\\boxed{ABCE}$$", "id": "3568447"}, {"introduction": "在数值分析中，理解问题的敏感性至关重要。本次练习 [@problem_id:3568440] 提供了一种动手实践的方法，让您领会为何条件数 $\\kappa(A)$ 是衡量线性系统敏感性的关键指标。您的任务是构造一个特定的扰动，使其几乎“饱和”次可加性界限，从而具体展示矩阵的奇异值结构如何决定其对扰动的响应。通过揭示条件数作为“最坏情况”放大场景的结果，本次练习将巩固这一抽象概念。", "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 为一个可逆矩阵。考虑由欧几里得范数（谱范数）诱导的算子范数，对任意矩阵 $M$ 定义为 $\\|M\\|_{2} \\coloneqq \\sup_{\\|x\\|_{2}=1} \\|Mx\\|_{2}$。设 $A$ 的奇异值分解为 $A = U \\Sigma V^{\\top}$，其中 $U, V \\in \\mathbb{R}^{n \\times n}$ 为正交矩阵，$\\Sigma = \\operatorname{diag}(\\sigma_{1}, \\sigma_{2}, \\dots, \\sigma_{n})$，奇异值为 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\dots \\geq \\sigma_{n} > 0$。谱条件数定义为 $\\kappa_{2}(A) \\coloneqq \\|A\\|_{2} \\, \\|A^{-1}\\|_{2}$。\n\n仅使用上述定义和诱导算子范数的次乘性，构造一个秩一扰动方向 $E \\in \\mathbb{R}^{n \\times n}$，在约束条件 $\\|E\\|_{2} = \\|A\\|_{2}$ 下最大化 $\\|A^{-1} E\\|_{2}$，从而对于小的 $\\delta A$，在一阶逆灵敏度界 $\\|A^{-1} \\delta A\\|_{2} \\leq \\|A^{-1}\\|_{2} \\, \\|\\delta A\\|_{2}$ 中近似达到等式。将 $E$ 直接用 $A$ 的奇异向量表示，并确定 $\\|A^{-1} E\\|_{2}$ 的结果值，将其表示为关于 $A$ 的奇异值的闭式解析表达式。您的最终答案应该是 $\\|A^{-1} E\\|_{2}$ 的表达式；无需四舍五入。", "solution": "首先验证该问题，以确保其科学上成立、适定且客观。\n\n### 第1步：提取已知信息\n- $A \\in \\mathbb{R}^{n \\times n}$ 是一个可逆矩阵。\n- 对任意矩阵 $M$，诱导算子范数（谱范数）定义为 $\\|M\\|_{2} \\coloneqq \\sup_{\\|x\\|_{2}=1} \\|Mx\\|_{2}$。\n- $A$ 的奇异值分解（SVD）为 $A = U \\Sigma V^{\\top}$，其中 $U, V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma = \\operatorname{diag}(\\sigma_{1}, \\sigma_{2}, \\dots, \\sigma_{n})$。\n- 奇异值按 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\dots \\geq \\sigma_{n} > 0$ 排序。条件 $\\sigma_{n} > 0$ 与 $A$ 可逆是一致的。\n- 任务是构造一个秩一扰动矩阵 $E \\in \\mathbb{R}^{n \\times n}$，使其服从约束 $\\|E\\|_{2} = \\|A\\|_{2}$。\n- 目标是最大化 $\\|A^{-1} E\\|_{2}$ 的值。\n- 最终答案必须是用 $A$ 的奇异值表示的 $\\|A^{-1} E\\|_{2}$ 的最大值。\n\n### 第2步：使用提取的已知信息进行验证\n- **科学依据**：该问题完全属于数值线性代数领域。所有定义——SVD、谱范数、条件数——都是标准的且陈述正确。不等式 $\\|A^{-1} \\delta A\\|_{2} \\leq \\|A^{-1}\\|_{2} \\, \\|\\delta A\\|_{2}$ 是诱导算子范数次乘性的直接结果，这是一个基本性质。\n- **适定性**：该问题要求在一个矩阵的紧集（具有固定谱范数的秩一矩阵 $E$ 的集合）上最大化一个连续函数 $\\|A^{-1} E\\|_{2}$。解必然存在。目标和约束清晰明确。\n- **客观性**：问题以精确的数学语言陈述，不含任何主观性。\n- **结论**：该问题是有效的，因为它是自洽的、科学上可靠且适定的。\n\n### 第3步：求解过程\n\n我们的目标是找到一个秩一矩阵 $E$，在约束 $\\|E\\|_{2} = \\|A\\|_{2}$ 下最大化 $\\|A^{-1} E\\|_{2}$。\n\n首先，我们用 $A$ 的SVD（$A = U \\Sigma V^{\\top}$）来表示其性质。矩阵的谱范数等于其最大的奇异值。因此，$\\|A\\|_{2} = \\sigma_{1}$。于是对 $E$ 的约束为 $\\|E\\|_{2} = \\sigma_{1}$。\n\n$A$ 的逆矩阵为 $A^{-1} = (U \\Sigma V^{\\top})^{-1} = (V^{\\top})^{-1} \\Sigma^{-1} U^{-1} = V \\Sigma^{-1} U^{\\top}$，因为 $U$ 和 $V$ 是正交矩阵（$U^{-1} = U^{\\top}$，$V^{-1} = V^{\\top}$）。$A^{-1}$ 的奇异值是 $A$ 的奇异值的倒数。给定排序 $\\sigma_{1} \\geq \\dots \\geq \\sigma_{n} > 0$，$A^{-1}$ 的奇异值为 $1/\\sigma_{n} \\geq \\dots \\geq 1/\\sigma_{1} > 0$。$A^{-1}$ 的谱范数是其最大的奇异值，所以 $\\|A^{-1}\\|_{2} = 1/\\sigma_{n}$。\n\n问题要求 $E$ 是一个秩一矩阵。任何秩一矩阵都可以表示为两个向量的外积，$E = uv^{\\top}$，其中 $u, v \\in \\mathbb{R}^{n}$ 为非零向量。这种矩阵的谱范数由 $\\|E\\|_{2} = \\|uv^{\\top}\\|_{2} = \\|u\\|_{2}\\|v\\|_{2}$ 给出。对 $E$ 的约束变为 $\\|u\\|_{2}\\|v\\|_{2} = \\sigma_{1}$。\n\n现在，我们分析目标函数 $\\|A^{-1} E\\|_{2}$。代入 $E = uv^{\\top}$，我们得到：\n$$\n\\|A^{-1} E\\|_{2} = \\|A^{-1} (uv^{\\top})\\|_{2} = \\|(A^{-1}u)v^{\\top}\\|_{2}\n$$\n这是另一个秩一矩阵的范数。使用与之前相同的性质，我们得到：\n$$\n\\|(A^{-1}u)v^{\\top}\\|_{2} = \\|A^{-1}u\\|_{2} \\|v^{\\top}\\|_{2} = \\|A^{-1}u\\|_{2} \\|v\\|_{2}\n$$\n所以，我们的目标是在约束 $\\|u\\|_{2}\\|v\\|_{2} = \\sigma_{1}$ 下最大化 $\\|A^{-1}u\\|_{2} \\|v\\|_{2}$。我们可以从约束中解出 $\\|v\\|_{2} = \\sigma_{1} / \\|u\\|_{2}$（因为 $u$ 是非零向量）并将其代入目标函数：\n$$\n\\text{maximize } \\|A^{-1}u\\|_{2} \\left( \\frac{\\sigma_{1}}{\\|u\\|_{2}} \\right) = \\sigma_{1} \\frac{\\|A^{-1}u\\|_{2}}{\\|u\\|_{2}}\n$$\n这将问题简化为在所有非零向量 $u \\in \\mathbb{R}^{n}$ 上最大化瑞利商 $\\frac{\\|A^{-1}u\\|_{2}}{\\|u\\|_{2}}$。根据诱导范数的定义，该商的最大值就是算子本身的范数：\n$$\n\\sup_{u \\neq 0} \\frac{\\|A^{-1}u\\|_{2}}{\\|u\\|_{2}} = \\|A^{-1}\\|_{2} = \\frac{1}{\\sigma_{n}}\n$$\n当 $u$ 是 $A^{-1}$ 对应其最大奇异值 $1/\\sigma_{n}$ 的右奇异向量时，达到此最大值。$A^{-1}$ 的SVD为 $V (\\Sigma^{-1}) U^{\\top}$。$A^{-1}$ 的左奇异向量是 $V$ 的列向量，右奇异向量是 $U$ 的列向量。对应奇异值 $1/\\sigma_{n}$ 的右奇异向量是 $U$ 的第 $n$ 列，我们记为 $u_{n}$。\n\n因此，为最大化我们的目标函数，我们必须选择 $u$ 为 $u_{n}$ 的某个倍数，即 $u = c u_{n}$，其中标量 $c \\neq 0$。\n\n在确定了 $u$ 的最优方向后，我们现在可以构造矩阵 $E$。我们选择 $u = u_{n}$。那么 $\\|u\\|_{2} = \\|u_{n}\\|_{2} = 1$。约束 $\\|u\\|_{2}\\|v\\|_{2} = \\sigma_{1}$ 意味着 $\\|v\\|_{2} = \\sigma_{1}$。$v$ 的方向不影响 $\\|A^{-1}E\\|_{2}$ 的大小，所以我们有一定的自由度。一个合理的选择是使用 $A$ 的一个奇异向量。我们选择 $v$ 与 $v_{1}$ 成正比，$v_{1}$ 是 $A$ 对应于其最大奇异值 $\\sigma_{1}$ 的右奇异向量。我们设 $v = \\sigma_{1} v_{1}$。这个选择满足范数约束：$\\|v\\|_{2} = \\|\\sigma_{1} v_{1}\\|_{2} = \\sigma_{1}\\|v_{1}\\|_{2} = \\sigma_{1} \\cdot 1 = \\sigma_{1}$。\n\n基于这些选择，我们的秩一扰动矩阵为：\n$$\nE = uv^{\\top} = u_{n} (\\sigma_{1} v_{1})^{\\top} = \\sigma_{1} u_{n} v_{1}^{\\top}\n$$\n我们来验证这个 $E$ 的范数：\n$$\n\\|E\\|_{2} = \\|\\sigma_{1} u_{n} v_{1}^{\\top}\\|_{2} = \\sigma_{1} \\|u_{n}\\|_{2} \\|v_{1}\\|_{2} = \\sigma_{1} \\cdot 1 \\cdot 1 = \\sigma_{1} = \\|A\\|_{2}\n$$\n约束得到满足。现在我们计算对于这个特定的 $E$ 的 $\\|A^{-1} E\\|_{2}$ 值：\n$$\nA^{-1} E = (V \\Sigma^{-1} U^{\\top}) (\\sigma_{1} u_{n} v_{1}^{\\top}) = \\sigma_{1} (V \\Sigma^{-1} U^{\\top} u_{n}) v_{1}^{\\top}\n$$\n由于 $u_{n}$ 是 $U$ 的第 $n$ 列，$U^{\\top}u_{n}$ 是第 $n$ 个标准基向量 $e_{n}$。\n$$\nA^{-1} E = \\sigma_{1} (V \\Sigma^{-1} e_{n}) v_{1}^{\\top}\n$$\n乘積 $\\Sigma^{-1}e_{n}$ 得到一个在第 $n$ 个位置为 $1/\\sigma_{n}$、其余位置为零的向量。\n$$\nA^{-1} E = \\sigma_{1} V \\left( \\frac{1}{\\sigma_{n}} e_{n} \\right) v_{1}^{\\top} = \\frac{\\sigma_{1}}{\\sigma_{n}} (V e_{n}) v_{1}^{\\top}\n$$\n向量 $Ve_{n}$ 是 $V$ 的第 $n$ 列，记为 $v_{n}$。\n$$\nA^{-1} E = \\frac{\\sigma_{1}}{\\sigma_{n}} v_{n} v_{1}^{\\top}\n$$\n这个结果矩阵的范数是：\n$$\n\\|A^{-1} E\\|_{2} = \\left\\| \\frac{\\sigma_{1}}{\\sigma_{n}} v_{n} v_{1}^{\\top} \\right\\|_{2} = \\frac{\\sigma_{1}}{\\sigma_{n}} \\|v_{n} v_{1}^{\\top}\\|_{2} = \\frac{\\sigma_{1}}{\\sigma_{n}} \\|v_{n}\\|_{2} \\|v_{1}\\|_{2}\n$$\n由于 $v_{1}$ 和 $v_{n}$ 是正交矩阵 $V$ 的列向量，它们都是单位向量，所以 $\\|v_{1}\\|_{2} = 1$ 且 $\\|v_{n}\\|_{2} = 1$。因此，最大值为：\n$$\n\\|A^{-1} E\\|_{2} = \\frac{\\sigma_{1}}{\\sigma_{n}}\n$$\n这个值恰好是 $A$ 的谱条件数 $\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2} = \\sigma_{1} (1/\\sigma_{n})$。这表明我们构造的扰动 $E$ 使次乘性不等式 $\\|A^{-1} E\\|_{2} \\leq \\|A^{-1}\\|_{2} \\|E\\|_{2}$ 达到饱和，即取得等号。", "answer": "$$\n\\boxed{\\frac{\\sigma_{1}}{\\sigma_{n}}}\n$$", "id": "3568440"}, {"introduction": "矩阵范数并非纯粹的理论构造，它们是分析实际算法行为的重要工具。在这次实践练习 [@problem_id:3272411] 中，您将运用次可加性知识来分析雅可比法（Jacobi method）的稳定性，这是一种经典的线性系统迭代求解器。通过推导误差传播公式，并将理论误差界限与数值计算结果进行比较，您将直接洞察迭代矩阵的性质如何支配整个过程的收敛性与稳定性。这项基于编程的练习将理论与计算实践紧密联系起来。", "problem": "给定一个具有实非奇异系数矩阵的方形线性系统，要求您量化经过 $k$ 步的雅可比迭代近似对初始猜测中的扰动的敏感度。您的任务是从雅可比方法的定义出发，该方法是一个迭代过程，它分离系数矩阵的对角线，并在每一步中，在将非对角项移到右侧后，求解一个对角系统。以此为基础，推断由两个不同初始猜测产生的两次迭代结果之间的差异是如何随迭代演变的。具体而言，您需要从有限维向量空间上的线性算子的性质和诱导范数的次可乘性出发进行推理，以获得初始猜测中的扰动如何经过 $k$ 步传播的显式表达式。然后，实现一个程序，利用这一理解来定量评估特定测试用例中的敏感度。\n\n对每个测试用例，执行以下任务：\n- 通过分离系数矩阵 $A$ 的对角线并在每一步仅使用该对角线进行求解，构建雅可比迭代。您必须将迭代表示为 $x^{(k+1)} = T(x^{(k)})$ 形式的仿射映射，并识别一个仅依赖于 $A$ 和 $b$ 的常数向量。\n- 利用更新对于 $x^{(k)}$ 的基本线性性质以及迭代的不动点解释，从第一性原理推导出一个将初始猜测中的扰动 $e^{(0)}$ 与 $k$ 步后的扰动 $e^{(k)}$ 相关联的显式公式。您的推导必须从迭代定义、线性映射的性质以及诱导矩阵范数的性质出发；除这些基础外，不得假定任何专门的快捷恒等式。\n- 对于给定的 $k$，计算以下四个量：\n  1. 放大因子 $r = \\lVert e^{(k)} \\rVert_{2} / \\lVert e^{(0)} \\rVert_{2}$，约定如果 $\\lVert e^{(0)} \\rVert_{2} = 0$ 则 $r = 0$。\n  2. 放大因子的一个诱导 $2$-范数上界，由 $\\lVert B \\rVert_{2}^{k}$ 给出，其中 $B$ 是将 $x^{(k)}$ 映射到 $x^{(k+1)}$ 线性部分的线性算子。使用由欧几里得范数诱导的主（谱）范数，并在 $k=0$ 时将此上界设置为 $1$。\n  3. 谱半径 $\\rho(B)$。\n  4. 基于谱半径的线性收敛条件的布尔指示符，即 $\\rho(B) < 1$ 是否成立。\n- 数值上实现雅可比迭代，以 $x^{(0)}$ 为起点计算 $x^{(k)}$，并同样以 $x^{(0)} + e^{(0)}$ 为起点进行计算，然后取二者之差以获得 $e^{(k)}$。对向量使用欧几里得范数，对矩阵使用诱导 $2$-范数。对于矩阵的诱导 $2$-范数，使用最大奇异值。对于谱半径，使用特征值的最大模。\n\n使用以下测试套件。每个测试用例由 $(A,b,x^{(0)},e^{(0)},k)$ 指定。\n- 测试用例 $1$：\n  - $A = \\begin{bmatrix} 4  & 1  & 0 \\\\ 1  & 3  & 1 \\\\ 0  & 1  & 2 \\end{bmatrix}$，\n    $b = \\begin{bmatrix} 1 \\\\ 2 \\\\ 3 \\end{bmatrix}$，\n    $x^{(0)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$，\n    $e^{(0)} = \\begin{bmatrix} 10^{-3} \\\\ -2 \\cdot 10^{-3} \\\\ 10^{-3} \\end{bmatrix}$，\n    $k = 10$。\n- 测试用例 $2$：\n  - $A = \\begin{bmatrix} 2  & 1 \\\\ 1  & 2 \\end{bmatrix}$，\n    $b = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$，\n    $x^{(0)} = \\begin{bmatrix} \\tfrac{1}{2} \\\\ -\\tfrac{1}{2} \\end{bmatrix}$，\n    $e^{(0)} = \\begin{bmatrix} 10^{-6} \\\\ -10^{-6} \\end{bmatrix}$，\n    $k = 25$。\n- 测试用例 $3$：\n  - $A = \\begin{bmatrix} 1  & 0.99 \\\\ 0.99  & 1 \\end{bmatrix}$，\n    $b = \\begin{bmatrix} 2 \\\\ -1 \\end{bmatrix}$，\n    $x^{(0)} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，\n    $e^{(0)} = \\begin{bmatrix} 10^{-4} \\\\ 0 \\end{bmatrix}$，\n    $k = 50$。\n- 测试用例 $4$：\n  - $A = \\begin{bmatrix} 1  & 1.2 \\\\ 1.2  & 1 \\end{bmatrix}$，\n    $b = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$，\n    $x^{(0)} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，\n    $e^{(0)} = \\begin{bmatrix} 10^{-6} \\\\ 2 \\cdot 10^{-6} \\end{bmatrix}$，\n    $k = 5$。\n- 测试用例 $5$ (边界步数 $k=0$):\n  - $A = \\begin{bmatrix} 3  & -1  & 0 \\\\ -1  & 3  & -1 \\\\ 0  & -1  & 3 \\end{bmatrix}$，\n    $b = \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\end{bmatrix}$，\n    $x^{(0)} = \\begin{bmatrix} 0.1 \\\\ -0.1 \\\\ 0.05 \\end{bmatrix}$，\n    $e^{(0)} = \\begin{bmatrix} 2 \\cdot 10^{-3} \\\\ -10^{-3} \\\\ 3 \\cdot 10^{-3} \\end{bmatrix}$，\n    $k = 0$。\n- 测试用例 $6$ (零扰动 $e^{(0)}$):\n  - $A = \\begin{bmatrix} 4  & -1 \\\\ -2  & 5 \\end{bmatrix}$，\n    $b = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，\n    $x^{(0)} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，\n    $e^{(0)} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$，\n    $k = 7$。\n\n最终输出规范：\n- 对于每个测试用例，您的程序必须生成一个包含四个条目 $[r,\\ \\lVert B \\rVert_{2}^{k},\\ \\rho(B),\\ \\text{conv}]$ 的列表，其中 $\\text{conv}$ 是一个布尔值，当且仅当 $\\rho(B) < 1$ 时为 $\\text{True}$。\n- 所有浮点输出必须四舍五入到 $8$ 位小数。\n- 程序必须打印单行，该行由一个列表组成，其中包含按测试用例 1 到 6 顺序排列的各个用例的列表，不得包含任何其他文本。例如，打印的行必须类似于 $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$，其中每个 $\\cdot$ 是一个小数点后恰好有 $8$ 位数字的小数或一个布尔值 $\\text{True}/\\text{False}$。", "solution": "此问题经评估为有效。它科学地植根于线性系统迭代法的既定理论，这是数值分析中的一个核心课题。该问题是适定的，为每个测试用例提供了所有必要的数据 $(A, b, x^{(0)}, e^{(0)}, k)$。矩阵 $A$ 被确认为非奇异的，并且具有非零的对角元素，从而确保雅可比迭代是良定义的。所用术语精确，目标可量化且明确无误。\n\n### 1. 雅可比迭代的推导\n\n该问题涉及一个方形线性方程组，可以写成矩阵形式：\n$$\nA \\mathbf{x} = \\mathbf{b}\n$$\n其中 $A$ 是一个实非奇异 $n \\times n$ 系数矩阵，$\\mathbf{x}$ 是 $n \\times 1$ 的未知向量，$\\mathbf{b}$ 是 $n \\times 1$ 的右侧向量。\n\n雅可比方法是求解此类系统的一种迭代算法。其核心思想是将矩阵 $A$ 分解为其对角部分 $D$、其严格下三角部分 $L$ 和其严格上三角部分 $U$ 的和。\n$$\nA = D + L + U\n$$\n将此分解代入原方程，得到：\n$$\n(D + L + U) \\mathbf{x} = \\mathbf{b}\n$$\n雅可比方法是通过重排此方程，将包含对角矩阵 $D$ 的项分离到左侧，并以此来定义一个迭代更新规则而推导出来的。设 $\\mathbf{x}^{(k)}$ 是在第 $k$ 次迭代时解 $\\mathbf{x}$ 的近似值。下一个近似值 $\\mathbf{x}^{(k+1)}$ 通过求解以下系统来计算：\n$$\nD \\mathbf{x}^{(k+1)} = - (L + U) \\mathbf{x}^{(k)} + \\mathbf{b}\n$$\n这是一个对角系统，只要 $D$ 是可逆的，就很容易求解。矩阵 $D$ 可逆当且仅当 $A$ 的所有对角元素非零，这个条件对所有提供的测试用例都成立。因此，我们可以通过左乘 $D$ 的逆矩阵 $D^{-1}$ 来获得显式迭代公式：\n$$\n\\mathbf{x}^{(k+1)} = -D^{-1}(L + U) \\mathbf{x}^{(k)} + D^{-1}\\mathbf{b}\n$$\n这个方程是一个形式为 $\\mathbf{x}^{(k+1)} = T(\\mathbf{x}^{(k)})$ 的仿射映射，其中变换 $T$ 由 $T(\\mathbf{z}) = B\\mathbf{z} + \\mathbf{c}$ 给出。矩阵 $B$ 和向量 $\\mathbf{c}$ 是常数，定义如下：\n- 雅可比迭代矩阵：$B = -D^{-1}(L + U)$\n- 常数向量：$\\mathbf{c} = D^{-1}\\mathbf{b}$\n\n因此，雅可比迭代可以紧凑地写为：\n$$\n\\mathbf{x}^{(k+1)} = B\\mathbf{x}^{(k)} + \\mathbf{c}\n$$\n\n### 2. 扰动的传播\n\n我们希望分析该方法对初始猜测中扰动的敏感度。设 $\\mathbf{x}^{(0)}$ 为一个初始猜测，并设 $\\tilde{\\mathbf{x}}^{(0)}$ 为一个受扰动的初始猜测，定义为：\n$$\n\\tilde{\\mathbf{x}}^{(0)} = \\mathbf{x}^{(0)} + \\mathbf{e}^{(0)}\n$$\n其中 $\\mathbf{e}^{(0)}$ 是初始扰动向量。\n\n设 $\\{\\mathbf{x}^{(k)}\\}_{k=0}^{\\infty}$ 是从 $\\mathbf{x}^{(0)}$ 开始生成的迭代序列，设 $\\{\\tilde{\\mathbf{x}}^{(k)}\\}_{k=0}^{\\infty}$ 是从 $\\tilde{\\mathbf{x}}^{(0)}$ 开始生成的序列。两个序列都遵循相同的雅可比更新规则：\n$$\n\\mathbf{x}^{(k+1)} = B\\mathbf{x}^{(k)} + \\mathbf{c}\n$$\n$$\n\\tilde{\\mathbf{x}}^{(k+1)} = B\\tilde{\\mathbf{x}}^{(k)} + \\mathbf{c}\n$$\n定义第 $k$ 步的扰动为两个迭代值之差：$\\mathbf{e}^{(k)} = \\tilde{\\mathbf{x}}^{(k)} - \\mathbf{x}^{(k)}$。为了找出此扰动如何传播，我们用第二个迭代方程减去第一个：\n$$\n\\tilde{\\mathbf{x}}^{(k+1)} - \\mathbf{x}^{(k+1)} = (B\\tilde{\\mathbf{x}}^{(k)} + \\mathbf{c}) - (B\\mathbf{x}^{(k)} + \\mathbf{c})\n$$\n常数向量 $\\mathbf{c}$ 被消去。\n$$\n\\mathbf{e}^{(k+1)} = B\\tilde{\\mathbf{x}}^{(k)} - B\\mathbf{x}^{(k)}\n$$\n由于矩阵-向量乘法的线性性质，我们可以将矩阵 $B$ 提取出来：\n$$\n\\mathbf{e}^{(k+1)} = B(\\tilde{\\mathbf{x}}^{(k)} - \\mathbf{x}^{(k)})\n$$\n代入 $\\mathbf{e}^{(k)}$ 的定义，得到扰动的递归关系：\n$$\n\\mathbf{e}^{(k+1)} = B \\mathbf{e}^{(k)}\n$$\n通过将此递归关系展开回初始扰动 $\\mathbf{e}^{(0)}$，我们得到 $k$ 步后扰动的显式表达式：\n$$\n\\mathbf{e}^{(k)} = B \\mathbf{e}^{(k-1)} = B(B \\mathbf{e}^{(k-2)}) = \\cdots = B^k \\mathbf{e}^{(0)}\n$$\n这个基本结果 $\\mathbf{e}^{(k)} = B^k \\mathbf{e}^{(0)}$ 表明，第 $k$ 步的扰动是通过将雅可比迭代矩阵的 $k$ 次方作用于初始扰动得到的。\n\n### 3. 敏感度分析与上界\n\n为了量化敏感度，我们考察放大因子 $r$，其定义为第 $k$ 步扰动的模与初始扰动模的比值。使用欧几里得向量范数 $(\\lVert \\cdot \\rVert_2)$，这表示为：\n$$\nr = \\frac{\\lVert \\mathbf{e}^{(k)} \\rVert_2}{\\lVert \\mathbf{e}^{(0)} \\rVert_2}\n$$\n（约定当 $\\lVert \\mathbf{e}^{(0)} \\rVert_2 = 0$ 时，$r=0$）。\n\n使用公式 $\\mathbf{e}^{(k)} = B^k \\mathbf{e}^{(0)}$，我们可以为此因子建立一个上界。我们对等式两边取 $2$-范数：\n$$\n\\lVert \\mathbf{e}^{(k)} \\rVert_2 = \\lVert B^k \\mathbf{e}^{(0)} \\rVert_2\n$$\n根据诱导矩阵范数的定义，$\\lVert M\\mathbf{v} \\rVert \\le \\lVert M \\rVert \\lVert \\mathbf{v} \\rVert$。应用此定义，我们得到：\n$$\n\\lVert \\mathbf{e}^{(k)} \\rVert_2 \\le \\lVert B^k \\rVert_2 \\lVert \\mathbf{e}^{(0)} \\rVert_2\n$$\n此外，诱导矩阵范数是次可乘的，即 $\\lVert M_1 M_2 \\rVert \\le \\lVert M_1 \\rVert \\lVert M_2 \\rVert$。将此性质应用 $k-1$ 次，得到：\n$$\n\\lVert B^k \\rVert_2 = \\lVert B \\cdot B \\cdots B \\rVert_2 \\le \\lVert B \\rVert_2 \\cdot \\lVert B \\rVert_2 \\cdots \\lVert B \\rVert_2 = (\\lVert B \\rVert_2)^k\n$$\n结合这些不等式，我们得出了扰动范数的一个上界：\n$$\n\\lVert \\mathbf{e}^{(k)} \\rVert_2 \\le (\\lVert B \\rVert_2)^k \\lVert \\mathbf{e}^{(0)} \\rVert_2\n$$\n两边同时除以 $\\lVert \\mathbf{e}^{(0)} \\rVert_2$ 得到放大因子的一个上界：\n$$\nr = \\frac{\\lVert \\mathbf{e}^{(k)} \\rVert_2}{\\lVert \\mathbf{e}^{(0)} \\rVert_2} \\le (\\lVert B \\rVert_2)^k\n$$\n这个不等式提供了一个最坏情况下的界限，说明了初始扰动经过 $k$ 次迭代后可能被放大的程度。$B$ 的诱导 $2$-范数 $\\lVert B \\rVert_2$ 是其最大奇异值（即谱范数）。对于任意初始猜测，雅可比方法收敛的条件是迭代矩阵的谱半径 $\\rho(B)$ 小于 $1$。谱半径是矩阵 $B$ 特征值的最大绝对值。\n\n### 4. 数值实现\n\n程序将对每个测试用例执行以下步骤：\n1.  从给定的矩阵 $A$ 和向量 $\\mathbf{b}$ 构建雅可比迭代矩阵 $B = -D^{-1}(L+U)$ 和常数向量 $\\mathbf{c} = D^{-1}\\mathbf{b}$。\n2.  模拟两次并行的、各进行 $k$ 步的雅可比迭代：一次从 $\\mathbf{x}^{(0)}$ 开始以得到 $\\mathbf{x}^{(k)}$，另一次从 $\\tilde{\\mathbf{x}}^{(0)} = \\mathbf{x}^{(0)} + \\mathbf{e}^{(0)}$ 开始以得到 $\\tilde{\\mathbf{x}}^{(k)}$。\n3.  计算最终的扰动 $\\mathbf{e}^{(k)} = \\tilde{\\mathbf{x}}^{(k)} - \\mathbf{x}^{(k)}$。\n4.  计算放大因子 $r = \\lVert \\mathbf{e}^{(k)} \\rVert_2 / \\lVert \\mathbf{e}^{(0)} \\rVert_2$，并处理 $\\mathbf{e}^{(0)} = \\mathbf{0}$ 的情况。\n5.  计算理论上界 $(\\lVert B \\rVert_2)^k$。$\\lVert B \\rVert_2$ 的值使用 `numpy.linalg.norm(B, 2)` 计算。当 $k=0$ 时，该界为 $1$。\n6.  通过找出 $B$ 的特征值的最大绝对值来计算谱半径 $\\rho(B)$，特征值通过 `numpy.linalg.eigvals(B)` 获得。\n7.  确定收敛指示符，如果 $\\rho(B) < 1$ 则为 `True`，否则为 `False`。\n8.  将四个结果量格式化为一个列表，其中浮点数四舍五入到 $8$ 位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Jacobi sensitivity problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": np.array([[4, 1, 0], [1, 3, 1], [0, 1, 2]], dtype=float),\n            \"b\": np.array([1, 2, 3], dtype=float),\n            \"x0\": np.array([0, 0, 0], dtype=float),\n            \"e0\": np.array([1e-3, -2e-3, 1e-3], dtype=float),\n            \"k\": 10,\n        },\n        {\n            \"A\": np.array([[2, 1], [1, 2]], dtype=float),\n            \"b\": np.array([1, 1], dtype=float),\n            \"x0\": np.array([0.5, -0.5], dtype=float),\n            \"e0\": np.array([1e-6, -1e-6], dtype=float),\n            \"k\": 25,\n        },\n        {\n            \"A\": np.array([[1, 0.99], [0.99, 1]], dtype=float),\n            \"b\": np.array([2, -1], dtype=float),\n            \"x0\": np.array([0, 0], dtype=float),\n            \"e0\": np.array([1e-4, 0], dtype=float),\n            \"k\": 50,\n        },\n        {\n            \"A\": np.array([[1, 1.2], [1.2, 1]], dtype=float),\n            \"b\": np.array([1, 0], dtype=float),\n            \"x0\": np.array([0, 0], dtype=float),\n            \"e0\": np.array([1e-6, 2e-6], dtype=float),\n            \"k\": 5,\n        },\n        {\n            \"A\": np.array([[3, -1, 0], [-1, 3, -1], [0, -1, 3]], dtype=float),\n            \"b\": np.array([1, 1, 1], dtype=float),\n            \"x0\": np.array([0.1, -0.1, 0.05], dtype=float),\n            \"e0\": np.array([2e-3, -1e-3, 3e-3], dtype=float),\n            \"k\": 0,\n        },\n        {\n            \"A\": np.array([[4, -1], [-2, 5]], dtype=float),\n            \"b\": np.array([0, 1], dtype=float),\n            \"x0\": np.array([0, 0], dtype=float),\n            \"e0\": np.array([0, 0], dtype=float),\n            \"k\": 7,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        A, b, x0, e0, k = case[\"A\"], case[\"b\"], case[\"x0\"], case[\"e0\"], case[\"k\"]\n\n        # 1. Construct the Jacobi iteration matrix B and vector c.\n        D = np.diag(np.diag(A))\n        D_inv = np.diag(1 / np.diag(D))\n        L_plus_U = A - D\n        B = -D_inv @ L_plus_U\n        c = D_inv @ b\n\n        # 2. Simulate iterations to find e^{(k)}.\n        x_k = x0.copy()\n        xtilde_k = (x0 + e0).copy()\n        for _ in range(k):\n            x_k = B @ x_k + c\n            xtilde_k = B @ xtilde_k + c\n        e_k = xtilde_k - x_k\n\n        # 3. Compute amplification factor r.\n        norm_e0 = np.linalg.norm(e0, 2)\n        if norm_e0 == 0:\n            r = 0.0\n        else:\n            norm_ek = np.linalg.norm(e_k, 2)\n            r = norm_ek / norm_e0\n\n        # 4. Compute the upper bound on amplification.\n        if k == 0:\n            bound = 1.0\n        else:\n            norm_B_2 = np.linalg.norm(B, 2)\n            bound = norm_B_2**k\n\n        # 5. Compute the spectral radius rho(B).\n        eigenvalues = np.linalg.eigvals(B)\n        rho_B = np.max(np.abs(eigenvalues))\n\n        # 6. Determine convergence condition.\n        conv = rho_B  1.0\n\n        all_results.append([r, bound, rho_B, conv])\n\n    # Format the final output string exactly as specified.\n    output_str = []\n    for r_val, bound_val, rho_val, conv_val in all_results:\n        r_str = f\"{r_val:.8f}\"\n        bound_str = f\"{bound_val:.8f}\"\n        rho_str = f\"{rho_val:.8f}\"\n        conv_str = str(conv_val)\n        output_str.append(f\"[{r_str},{bound_str},{rho_str},{conv_str}]\")\n    \n    print(f\"[{','.join(output_str)}]\")\n\nsolve()\n```", "id": "3272411"}]}