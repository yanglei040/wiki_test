{"hands_on_practices": [{"introduction": "循环矩阵在信号处理、图像分析和科学计算中无处不在，其独特的结构孕育了高效的计算方法。本练习旨在揭示循环矩阵的代数结构与其谱性质之间的深刻联系。通过动手推导，你将发现其特征值可以直接通过离散傅里叶变换（DFT）得到，并进一步理解如何利用快速傅里叶变换（FFT）将矩阵向量乘法的计算复杂度从 $O(n^2)$ 显著降低到 $O(n \\log n)$，这构成了许多快速算法的核心。[@problem_id:3580686]", "problem": "设 $n \\in \\mathbb{N}$ 且 $C \\in \\mathbb{C}^{n \\times n}$ 是一个循环矩阵，其第一列为 $(c_0,c_1,\\dots,c_{n-1})^{\\top}$，记作 $C=\\mathrm{circ}(c_0,\\dots,c_{n-1})$。定义 $\\omega_n=\\exp(-2\\pi \\mathrm{i}/n)$，并且对于每个满足 $0 \\leq k \\leq n-1$ 的整数 $k$，考虑向量 $v_k \\in \\mathbb{C}^n$，其第 $j$ 个分量为 $[v_k]_j=\\omega_n^{jk}$（其中 $0 \\leq j \\leq n-1$）。从循环矩阵的定义和离散傅里叶变换 (DFT) 的基本性质出发，推导 $C$ 的第 $k$ 个特征值的闭式表达式，该表达式用 $(c_j)_{j=0}^{n-1}$ 和 $\\omega_n$ 表示。\n\n另外，考虑使用快速傅里叶变换 (FFT) 计算给定单个向量 $x \\in \\mathbb{C}^n$ 的矩阵向量乘积 $Cx$。假设 $n$ 是 $2$ 的幂，并且您使用基-$2$ Cooley–Tukey 快速傅里叶变换 (FFT)，该算法对长度为 $n$ 的复数输入执行 $n\\log_2(n)$ 次复数加法和 $(n/2)\\log_2(n)$ 次复数乘法；假设逆 FFT 的运算次数相同。假设通过 FFT 计算 $Cx$ 的过程为：计算 $c$ 的 DFT、计算 $x$ 的 DFT、在频域中进行逐元素复数乘法，然后应用逆 DFT 返回时域，并且假设 $c$ 的 DFT 不是预先计算的。将一次复数加法的单位成本和一次复数乘法的单位成本都视为 $1$，并忽略内存访问成本。在这些假设下，提供一个关于 $n$ 的单一闭式解析表达式，表示用这种基于 FFT 的方法计算一次 $Cx$ 所需的复数算术运算总次数。\n\n您的最终答案必须是按规定收集了两个结果的单个解析表达式或双元素行矩阵。无需四舍五入。", "solution": "用户提出了一个关于循环矩阵的两部分问题。第一部分要求推导循环矩阵的特征值。第二部分要求计算使用基于 FFT 的方法进行循环矩阵与向量相乘的计算成本。该问题已经过验证，被认为是自洽的、有科学依据且提法良好的。\n\n解决方案根据问题的结构分为两部分呈现。\n\n第 1 部分：循环矩阵的特征值\n\n设 $C \\in \\mathbb{C}^{n \\times n}$ 是一个由其第一列 $c = (c_0, c_1, \\dots, c_{n-1})^{\\top}$ 定义的循环矩阵。使用从 $0$ 开始的索引（行索引 $i$ 和列索引 $j$，其中 $0 \\le i, j \\le n-1$），矩阵的元素由 $C_{ij} = c_{(i-j) \\pmod n}$ 给出。\n\n问题为 $k \\in \\{0, 1, \\dots, n-1\\}$ 定义了一组向量 $v_k \\in \\mathbb{C}^n$。向量 $v_k$ 的第 $j$ 个分量由 $[v_k]_j = \\omega_n^{jk}$ 给出，其中 $\\omega_n = \\exp(-2\\pi \\mathrm{i}/n)$。\n\n为了找到与向量 $v_k$ 对应的特征值 $\\lambda_k$，我们必须通过验证特征值方程 $Cv_k = \\lambda_k v_k$ 来证明 $v_k$ 是 $C$ 的一个特征向量。我们计算矩阵向量乘积 $Cv_k$ 的第 $i$ 个分量：\n$$\n[Cv_k]_i = \\sum_{j=0}^{n-1} C_{ij} [v_k]_j\n$$\n代入 $C_{ij}$ 和 $[v_k]_j$ 的表达式：\n$$\n[Cv_k]_i = \\sum_{j=0}^{n-1} c_{(i-j) \\pmod n} \\omega_n^{jk}\n$$\n为了简化这个求和，我们进行变量替换。令 $l = (i-j) \\pmod n$。当索引 $j$ 从 $0$ 遍历到 $n-1$ 时，对于一个固定的 $i$，索引 $l$ 也会恰好遍历一次从 $0$ 到 $n-1$ 的所有值。由 $l$ 的定义可知 $j \\equiv i-l \\pmod n$。\n由于 $\\omega_n^n = \\exp(-2\\pi \\mathrm{i}) = 1$，我们有 $\\omega_n^{nk} = (\\omega_n^n)^k = 1$。这意味着对于任意整数 $a$，都有 $\\omega_n^{a \\pmod n} = \\omega_n^a$。因此，$\\omega_n^{jk} = \\omega_n^{((i-l) \\pmod n)k} = \\omega_n^{(i-l)k}$。\n代入后，求和式变为：\n$$\n[Cv_k]_i = \\sum_{l=0}^{n-1} c_l \\omega_n^{(i-l)k}\n$$\n我们可以将依赖于 $i$ 的项从求和中分离出来：\n$$\n[Cv_k]_i = \\sum_{l=0}^{n-1} c_l \\omega_n^{ik} \\omega_n^{-lk} = \\omega_n^{ik} \\left( \\sum_{l=0}^{n-1} c_l \\omega_n^{-lk} \\right)\n$$\n项 $\\omega_n^{ik}$ 是向量 $v_k$ 的第 $i$ 个分量，即 $[v_k]_i$。括号中的项是一个不依赖于分量索引 $i$ 的标量值。我们用 $\\lambda_k$ 表示这个标量。\n$$\n\\lambda_k = \\sum_{l=0}^{n-1} c_l \\omega_n^{-lk}\n$$\n因此，我们证明了对于所有 $i \\in \\{0, 1, \\dots, n-1\\}$，都有 $[Cv_k]_i = \\lambda_k [v_k]_i$，这证实了 $v_k$ 是 $C$ 的一个特征向量，其对应的特征值为 $\\lambda_k$。\n\n为了符号上的一致性，将求和索引 $l$ 替换为 $j$，第 $k$ 个特征值的闭式表达式为：\n$$\n\\lambda_k = \\sum_{j=0}^{n-1} c_j \\omega_n^{-jk}\n$$\n这个表达式给出了与问题中定义的特定特征向量 $v_k$ 相关联的特征值。\n\n第 2 部分：通过 FFT 计算 $Cx$ 的计算成本\n\n问题要求计算使用指定的基于 FFT 的方法计算矩阵向量乘积 $y = Cx$ 所需的复数算术运算总次数。\n\n乘积 $Cx$ 是向量 $c$（$C$ 的第一列）和向量 $x$ 的循环卷积。$y$ 的分量由 $y_i = \\sum_{j=0}^{n-1} c_{(i-j)\\pmod n} x_j$ 给出。\n\n卷积定理指出，两个向量的循环卷积的离散傅里叶变换 (DFT) 是它们各自 DFT 的逐元素乘积。即 $\\text{DFT}(y) = \\text{DFT}(c) \\odot \\text{DFT}(x)$，其中 $\\odot$ 表示逐元素乘法。为了得到 $y$，我们接着应用逆离散傅里叶变换 (IDFT)：$y = \\text{IDFT}(\\text{DFT}(c) \\odot \\text{DFT}(x))$。\n\n如问题中所述，该过程包括以下四个步骤：\n1.  计算向量 $c$ 的 DFT，我们称之为 $\\hat{c} = \\text{DFT}(c)$。\n2.  计算向量 $x$ 的 DFT，我们称之为 $\\hat{x} = \\text{DFT}(x)$。\n3.  计算逐元素乘积 $\\hat{y} = \\hat{c} \\odot \\hat{x}$。\n4.  计算 $\\hat{y}$ 的 IDFT 以获得最终结果 $y = \\text{IDFT}(\\hat{y})$。\n\n这些操作的成本是给定的。对于长度为 $n$ 的输入，其中 $n$ 是 $2$ 的幂，基-$2$ Cooley-Tukey FFT 需要：\n-   复数加法: $A_{FFT} = n\\log_2(n)$\n-   复数乘法: $M_{FFT} = \\frac{n}{2}\\log_2(n)$\n\n问题指出一次 IDFT 的成本与一次 FFT 的成本相同。一次复数加法和一次复数乘法的单位成本均为 $1$。单次 FFT 或 IDFT 所需的复数算术运算总次数是加法和乘法次数的总和：\n$$\nC_{transform} = A_{FFT} + M_{FFT} = n\\log_2(n) + \\frac{n}{2}\\log_2(n) = \\frac{3}{2}n\\log_2(n)\n$$\n现在，我们对过程中每个步骤的成本求和：\n1.  $\\text{DFT}(c)$ 的成本：$C_{transform} = \\frac{3}{2}n\\log_2(n)$。\n2.  $\\text{DFT}(x)$ 的成本：$C_{transform} = \\frac{3}{2}n\\log_2(n)$。\n3.  逐元素乘积的成本：此步骤涉及 $n$ 对复数的乘法。成本是 $n$ 次复数乘法，对应于 $n$ 次运算。\n4.  $\\text{IDFT}(\\hat{y})$ 的成本：$C_{transform} = \\frac{3}{2}n\\log_2(n)$。\n\n复数算术运算的总次数是这四个步骤成本的总和：\n$$\n\\text{Total Cost} = C(\\text{DFT}(c)) + C(\\text{DFT}(x)) + C(\\text{product}) + C(\\text{IDFT})\n$$\n$$\n\\text{Total Cost} = \\left(\\frac{3}{2}n\\log_2(n)\\right) + \\left(\\frac{3}{2}n\\log_2(n)\\right) + n + \\left(\\frac{3}{2}n\\log_2(n)\\right)\n$$\n将这些项相加：\n$$\n\\text{Total Cost} = 3 \\times \\left(\\frac{3}{2}n\\log_2(n)\\right) + n = \\frac{9}{2}n\\log_2(n) + n\n$$\n这就是所要求的、表示复数算术运算总次数的单一闭式解析表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sum_{j=0}^{n-1} c_j \\omega_n^{-jk}  \\frac{9n}{2}\\log_{2}(n) + n \\end{pmatrix}}\n$$", "id": "3580686"}, {"introduction": "托普利茨矩阵是另一类具有常数对角线结构的重要特殊矩阵，常见于微分方程数值解和时间序列分析。本练习将引导你探究一个更微妙但至关重要的性质：正规性。你将通过第一性原理推导一个三对角托普利茨矩阵成为正规矩阵的充要条件，并理解这如何确保矩阵可以被酉对角化，从而催生出基于结构的高效特征值算法，这与通用的、不利用任何结构的算法形成鲜明对比。[@problem_id:3580745]", "problem": "设 $T \\in \\mathbb{C}^{n \\times n}$ 是一个三对角托普利茨矩阵，其主对角线上的元素为 $t_{0} = a \\in \\mathbb{C}$，第一上对角线上的元素为 $t_{1} = b \\in \\mathbb{C}$，第一下对角线上的元素为 $t_{-1} = c \\in \\mathbb{C}$，其他位置均为零。与 $T$ 相关联的托普利茨符号是三角多项式 $f(\\theta) = a + b \\exp(i \\theta) + c \\exp(-i \\theta)$。\n\n仅使用线性代数的核心定义，即正规矩阵的定义（$T^{*} T = T T^{*}$）、托普利茨矩阵的结构（常数对角线）以及谱范数（$\\| \\cdot \\|_{2}$），从基本原理出发，推导 $T$ 为正规矩阵时 $b$ 和 $c$ 需满足的充要条件。根据托普利茨符号 $f(\\theta)$ 在变换 $\\theta \\mapsto -\\theta$ 下的对称性来解释这个条件。\n\n接下来，在您所得到正规性条件下，构造一个对角酉缩放，使得 $T$ 的第一上对角线和第一下对角线相等，并论证为何这意味着 $T$ 可以通过一个结构化变换（例如，可通过快速傅里叶变换（FFT）实现的离散正弦变换（DST））进行酉可对角化，并讨论这对于特征值计算，与没有可利用结构的通用算法相比，有何意义。\n\n最后，当该条件被违反时，通过计算换位子 $[T, T^{*}] = T T^{*} - T^{*} T$ 的谱范数的闭式形式（作为 $a$、$b$、$c$ 和 $n$ 的函数），来量化其与正规性的偏离程度。您的最终答案必须是 $\\|[T, T^{*}]\\|_{2}$ 的单一闭式解析表达式，无需四舍五入。", "solution": "该问题要求对一个三对角托普利茨矩阵 $T \\in \\mathbb{C}^{n \\times n}$ 进行多部分分析。我们将依次处理每个部分，从推导正规性条件开始。在本次分析中，我们假设 $n \\ge 2$，因为对于 $n=1$ 的情况，第一上、下对角线的概念是平凡的。\n\n首先，我们定义矩阵 $T$ 及其共轭转置 $T^{*}$。矩阵 $T$ 的元素为 $T_{ii} = a$，$T_{i,i+1} = b$ 以及 $T_{i+1,i} = c$（其中 $i \\in \\{1, \\dots, n-1\\}$），其他位置的元素为零。\n$$\nT = \\begin{pmatrix}\na  b  0  \\dots  0 \\\\\nc  a  b  \\ddots  \\vdots \\\\\n0  c  a  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  b \\\\\n0  \\dots  0  c  a\n\\end{pmatrix}\n$$\n共轭转置 $T^{*}$ 由 $(T^{*})_{ij} = \\overline{T_{ji}}$ 给出。它也是一个托普利茨矩阵，主对角线上为 $\\bar{a}$，第一上对角线上为 $\\bar{c}$，第一下对角线上为 $\\bar{b}$。\n$$\nT^{*} = \\begin{pmatrix}\n\\bar{a}  \\bar{c}  0  \\dots  0 \\\\\n\\bar{b}  \\bar{a}  \\bar{c}  \\ddots  \\vdots \\\\\n0  \\bar{b}  \\bar{a}  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  \\bar{c} \\\\\n0  \\dots  0  \\bar{b}  \\bar{a}\n\\end{pmatrix}\n$$\n\n如果一个矩阵与其共轭转置可交换，即 $T T^{*} = T^{*} T$，则该矩阵是正规的。我们计算这两个乘积的元素。\n\n$T T^{*}$ 的元素为：\n对于对角元素，$(T T^{*})_{ii} = \\sum_{k=1}^{n} T_{ik} \\overline{T_{ik}} = \\sum_{k=1}^{n} |T_{ik}|^2$。\n- $(T T^{*})_{11} = |T_{11}|^2 + |T_{12}|^2 = |a|^2 + |b|^2$。\n- 对于 $1  i  n$，$(T T^{*})_{ii} = |T_{i,i-1}|^2 + |T_{ii}|^2 + |T_{i,i+1}|^2 = |c|^2 + |a|^2 + |b|^2$。\n- $(T T^{*})_{nn} = |T_{n,n-1}|^2 + |T_{nn}|^2 = |c|^2 + |a|^2$。\n\n对于非对角元素，我们只需要检查第一上、下对角线，因为两个三对角矩阵的乘积是一个五对角矩阵，但在这种特殊情况下，它仍然是三对角矩阵。\n- 上对角线（$1 \\le i \\le n-1$）：$(T T^{*})_{i,i+1} = \\sum_k T_{ik} \\overline{T_{i+1,k}} = T_{ii}\\overline{T_{i+1,i}} + T_{i,i+1}\\overline{T_{i+1,i+1}} = a\\bar{c} + b\\bar{a}$。\n- 下对角线（$1 \\le i \\le n-1$）：$(T T^{*})_{i+1,i} = \\sum_k T_{i+1,k} \\overline{T_{ik}} = T_{i+1,i}\\overline{T_{ii}} + T_{i+1,i+1}\\overline{T_{i,i+1}} = c\\bar{a} + a\\bar{b}$。\n\n$T^{*} T$ 的元素为：\n对于对角元素，$(T^{*} T)_{ii} = \\sum_{k=1}^{n} (T^{*})_{ik} T_{ki} = \\sum_{k=1}^{n} \\overline{T_{ki}} T_{ki} = \\sum_{k=1}^{n} |T_{ki}|^2$。\n- $(T^{*} T)_{11} = |T_{11}|^2 + |T_{21}|^2 = |a|^2 + |c|^2$。\n- 对于 $1  i  n$，$(T^{*} T)_{ii} = |T_{i-1,i}|^2 + |T_{ii}|^2 + |T_{i+1,i}|^2 = |b|^2 + |a|^2 + |c|^2$。\n- $(T^{*} T)_{nn} = |T_{n-1,n}|^2 + |T_{nn}|^2 = |b|^2 + |a|^2$。\n\n对于非对角元素：\n- 上对角线（$1 \\le i \\le n-1$）：$(T^{*} T)_{i,i+1} = \\sum_k (T^{*})_{ik} T_{k,i+1} = (T^{*})_{ii}T_{i,i+1} + (T^{*})_{i,i+1}T_{i+1,i+1} = \\bar{a}b + \\bar{c}a$。\n- 下对角线（$1 \\le i \\le n-1$）：$(T^{*} T)_{i+1,i} = \\sum_k (T^{*})_{i+1,k} T_{ki} = (T^{*})_{i+1,i}T_{ii} + (T^{*})_{i+1,i+1}T_{i+1,i} = \\bar{b}a + \\bar{a}c$。\n\n令 $T T^{*} = T^{*} T$ 相等：\n- 上对角线元素为 $a\\bar{c} + b\\bar{a}$ 和 $\\bar{a}b + \\bar{c}a$，它们是相等的。\n- 下对角线元素为 $c\\bar{a} + a\\bar{b}$ 和 $\\bar{b}a + \\bar{a}c$，它们也是相等的。\n- 对于 $1  i  n$ 的对角元素，两者均为 $|a|^2+|b|^2+|c|^2$。\n- 角上的对角元素提供了唯一的约束条件。\n  - $(T T^{*})_{11} = (T^{*} T)_{11} \\implies |a|^2 + |b|^2 = |a|^2 + |c|^2 \\implies |b|^2 = |c|^2$。\n  - $(T T^{*})_{nn} = (T^{*} T)_{nn} \\implies |c|^2 + |a|^2 = |b|^2 + |a|^2 \\implies |c|^2 = |b|^2$。\n两者给出相同的条件。由于模非负，这等价于 $|b| = |c|$。这就是 $T$ 为正规矩阵的充要条件。\n\n问题要求根据托普利茨符号 $f(\\theta) = a + b \\exp(i\\theta) + c \\exp(-i\\theta)$ 在 $\\theta \\mapsto -\\theta$ 下的对称性来解释这个条件。条件 $|b|=|c|$ 本身并不会对符号强制一个简单的对称性，如 $f(\\theta)=f(-\\theta)$ 或 $|f(\\theta)|=|f(-\\theta)|$。实际上，这种联系更为微妙，并由问题的下一部分揭示。条件 $|b|=|c|$ 正是确保 $T$ 酉相似于一个对称矩阵所需要的。设 $T'$ 是这个对称矩阵。它的符号 $f'(\\theta)$ 将是一个偶函数，$f'(\\theta) = f'(-\\theta)$，这表现出了所要求的对称性。酉相似变换保持正规性，因此这建立了一个间接的联系：$T$ 是正规的，当且仅当它酉相似于一个其符号为对称的矩阵 $T'$。\n\n我们来将其形式化。在正规性条件 $|b|=|c|$ 下，我们可以写出 $c/b = \\exp(i\\phi)$，其中 $\\phi \\in \\mathbb{R}$ 是某个相位，假设 $b \\neq 0$。如果 $b=0$，则 $c=0$，$T$ 是对角矩阵，因而是正规的。如果 $b\\neq 0$，令 $\\gamma = \\sqrt{c/b} = \\exp(i\\phi/2)$。注意 $|\\gamma|=1$。\n构造一个对角酉矩阵 $D$，其元素为 $d_k = \\gamma^{k-1}$，其中 $k=1, \\dots, n$。因为 $|d_k| = |\\gamma|^{k-1} = 1$，所以 $D$ 确实是酉矩阵（$D^*D=I$）。\n考虑相似变换 $T' = D^{*} T D$。$T'$ 的元素为：\n- $(T')_{ii} = \\overline{d_i} T_{ii} d_i = |d_i|^2 a = a$。\n- $(T')_{i, i+1} = \\overline{d_i} T_{i, i+1} d_{i+1} = \\overline{\\gamma^{i-1}} b \\gamma^i = \\gamma b = \\sqrt{c/b} \\cdot b = \\sqrt{bc}$。\n- $(T')_{i+1, i} = \\overline{d_{i+1}} T_{i+1, i} d_i = \\overline{\\gamma^i} c \\gamma^{i-1} = \\bar{\\gamma} c = \\sqrt{b/c} \\cdot c = \\sqrt{bc}$。\n得到的矩阵 $T'$ 是一个对称三对角托普利茨矩阵：\n$$\nT' = \\begin{pmatrix}\na  \\sqrt{bc}  0  \\dots  0 \\\\\n\\sqrt{bc}  a  \\sqrt{bc}  \\ddots  \\vdots \\\\\n0  \\sqrt{bc}  a  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  \\sqrt{bc} \\\\\n0  \\dots  0  \\sqrt{bc}  a\n\\end{pmatrix}\n$$\n由于 $T'$ 是对称的，其托普利茨符号为 $f'(\\theta) = a + \\sqrt{bc}(\\exp(i\\theta) + \\exp(-i\\theta)) = a + 2\\sqrt{bc}\\cos(\\theta)$。该符号是 $\\theta$ 的偶函数，即 $f'(\\theta) = f'(-\\theta)$，这就是我们所寻求的对称性。\n\n一个实对称三对角托普利茨矩阵已知可由离散正弦变换（DST）对角化。特征向量矩阵是 $S$，其元素为 $S_{jk} = \\sqrt{\\frac{2}{n+1}} \\sin(\\frac{jk\\pi}{n+1})$。该矩阵是正交的，因此也是酉矩阵。$T'$ 的特征值由著名的公式给出：$\\lambda_k = a + 2\\sqrt{bc} \\cos(\\frac{k\\pi}{n+1})$，其中 $k=1, \\dots, n$。无论 $a$ 和 $\\sqrt{bc}$ 是否为实数，矩阵 $S$ 都能对角化 $T'$。所以，$S^* T' S = \\Lambda$，其中 $\\Lambda = \\text{diag}(\\lambda_1, \\dots, \\lambda_n)$。\n由于 $T = D T' D^{*}$，我们有 $T = D(S\\Lambda S^{*})D^{*} = (DS)\\Lambda(S^{*}D^{*}) = (DS)\\Lambda(DS)^{*}$。\n矩阵 $T$ 可由酉矩阵 $U = DS$ 对角化。这是一个结构化变换，是一个对角酉矩阵和一个 DST 矩阵的乘积。\n\n这种结构对特征值计算具有深远的影响。对于一个通用的 $n \\times n$ 矩阵，使用例如 QR 算法计算特征值，需要 $O(n^3)$ 次浮点运算。对于我们的正规三对角托普利茨矩阵，我们有特征值的闭式解析表达式。所有 $n$ 个特征值都可以在 $O(n)$ 时间内计算出来。构成 $U=DS$ 各列的特征向量也可以被高效地计算。使用快速傅里叶变换（FFT）算法，DST 矩阵 $S$ 作用于一个向量的计算可以在 $O(n \\log n)$ 时间内完成。因此，任何一个特征向量都可以在 $O(n \\log n)$ 时间内计算出来，而完整的特征向量矩阵 $U$ 可以在 $O(n^2 \\log n)$ 时间内构成，这相比于通用方法是一个显著的改进。\n\n最后，我们通过计算换位子 $[T, T^{*}] = T T^{*} - T^{*} T$ 的谱范数 $\\| \\cdot \\|_2$ 来量化其与正规性的偏离程度。根据我们之前的计算，我们发现 $T T^{*}$ 和 $T^{*} T$ 的非对角元素和中间部分的对角元素是相同的。换位子矩阵 $C = [T, T^{*}]$ 中唯一的非零元素位于角落：\n- $C_{11} = (T T^{*})_{11} - (T^{*} T)_{11} = (|a|^2+|b|^2) - (|a|^2+|c|^2) = |b|^2-|c|^2$。\n- $C_{nn} = (T T^{*})_{nn} - (T^{*} T)_{nn} = (|c|^2+|a|^2) - (|b|^2+|a|^2) = |c|^2-|b|^2$。\n所有其他元素 $C_{ij}$ 均为 $0$。该换位子矩阵是一个对角矩阵，形式如下：\n$$\n[T, T^{*}] = \\text{diag}(|b|^2-|c|^2, 0, \\dots, 0, |c|^2-|b|^2)\n$$\n矩阵的谱范数是其最大的奇异值。对于正规矩阵（对角矩阵就是一种正规矩阵），谱范数是其特征值绝对值的最大值。对角矩阵的特征值就是其对角元素。\n$[T, T^{*}]$ 的特征值是 $\\{|b|^2-|c|^2, 0, \\dots, 0, |c|^2-|b|^2\\}$。\n因此，谱范数为：\n$$\n\\|[T, T^{*}]\\|_{2} = \\max\\{||b|^2-|c|^2|, |0|, ||c|^2-|b|^2|\\}\n$$\n由于 $||c|^2-|b|^2| = |-(|b|^2-|c|^2)| = ||b|^2-|c|^2|$，范数就是角上元素的绝对值。\n$$\n\\|[T, T^{*}]\\|_{2} = \\left| |b|^2-|c|^2 \\right|\n$$\n该量为零当且仅当 $|b|=|c|$，这证实了我们的正规性条件。它提供了一个连续的度量，衡量 $T$ 偏离正规矩阵的程度。这种偏离仅取决于非对角元素模的平方差，并且与 $a$ 和 $n$ 无关（对于 $n \\ge 2$）。", "answer": "$$\n\\boxed{\\left| |b|^2 - |c|^2 \\right|}\n$$", "id": "3580745"}, {"introduction": "在多项式插值等问题中，数值稳定性是一个核心挑战，而经典的范德蒙矩阵因其随阶数增长而迅速恶化的条件数而臭名昭著。本练习将让你亲身体验如何通过巧妙的基变换和节点选取来攻克这一难题。你将证明，当使用切比雪夫多项式作为基，并在特定的切比雪夫节点上进行求值时，得到的“类范德蒙”矩阵具有极佳的、与维度无关的常数条件数，从而深刻理解为何选择正确的数学表示是设计稳健数值算法的基石。[@problem_id:3580739]", "problem": "设 $n \\geq 2$，考虑一个基于第一类切比雪夫多项式构建的实数范德蒙型求值矩阵。定义切比雪夫节点 $t_i \\in [-1,1]$ 为 $t_i = \\cos\\!\\left(\\frac{(2i-1)\\pi}{2n}\\right)$，其中 $i = 1,\\dots,n$。令 $\\{T_k\\}_{k=0}^{n-1}$ 表示第一类切比雪夫多项式，其特征为恒等式 $T_k(\\cos \\theta) = \\cos(k\\theta)$ 对所有实数 $\\theta$ 成立。构建一个 $n \\times n$ 矩阵 $\\Phi$，其元素为 $\\Phi_{ij} = T_{j-1}(t_i)$。从矩阵 2-范数条件数 $\\kappa_{2}(A)$ 是最大奇异值与最小奇异值之比的定义出发，并仅使用关于切比雪夫多项式和三角和的标准性质，推导出 $\\kappa_{2}(\\Phi)$ 的一个闭式表达式。然后，利用单项式 $\\{z^{k}\\}_{k=0}^{n-1}$ 和切比雪夫多项式 $\\{T_k(z)\\}_{k=0}^{n-1}$ 之间的基本基变换关系，解释为什么选择切比雪夫节点会减缓单项式范德蒙矩阵的条件数相对于 $[-1,1]$ 中等距节点的增长。你的最终答案必须是 $\\kappa_{2}(\\Phi)$ 的一个单一解析表达式。", "solution": "问题要求做两件事：第一，推导特定切比雪夫-范德蒙矩阵 $\\Phi$ 的 2-范数条件数 $\\kappa_2(\\Phi)$ 的闭式表达式；第二，解释为什么选择切比雪夫节点对于标准单项式范德蒙矩阵的条件数是有利的。\n\n首先，我们求解条件数 $\\kappa_2(\\Phi)$。矩阵 $\\Phi$ 是一个 $n \\times n$ 矩阵，其元素为 $\\Phi_{ij} = T_{j-1}(t_i)$，其中 $i,j \\in \\{1, \\dots, n\\}$。点 $t_i$ 是切比雪夫节点 $t_i = \\cos\\left(\\frac{(2i-1)\\pi}{2n}\\right)$，$T_k(x)$ 是 $k$ 次第一类切比雪夫多项式。条件数 $\\kappa_2(\\Phi)$ 定义为 $\\Phi$ 的最大奇异值与最小奇异值之比，即 $\\kappa_2(\\Phi) = \\frac{\\sigma_{\\max}(\\Phi)}{\\sigma_{\\min}(\\Phi)}$。$\\Phi$ 的奇异值是矩阵 $\\Phi^T \\Phi$ 的特征值的平方根。\n\n我们来计算矩阵乘积 $\\Phi^T \\Phi$。$\\Phi^T \\Phi$ 的第 $j$ 行第 $k$ 列的元素由下式给出：\n$$ (\\Phi^T \\Phi)_{jk} = \\sum_{i=1}^{n} (\\Phi^T)_{ji} \\Phi_{ik} = \\sum_{i=1}^{n} \\Phi_{ij} \\Phi_{ik} = \\sum_{i=1}^{n} T_{j-1}(t_i) T_{k-1}(t_i) $$\n这个和是切比雪夫多项式 $T_{j-1}$ 和 $T_{k-1}$ 在切比雪夫节点集 $\\{t_i\\}_{i=1}^n$ 上的离散内积。这组节点对这些多项式表现出离散正交性。我们来证明这个性质。\n\n令 $\\theta_i = \\frac{(2i-1)\\pi}{2n}$，其中 $i=1, \\dots, n$。则 $t_i = \\cos(\\theta_i)$。使用定义性质 $T_k(\\cos\\theta) = \\cos(k\\theta)$，该和变为：\n$$ \\sum_{i=1}^{n} T_{j-1}(\\cos\\theta_i) T_{k-1}(\\cos\\theta_i) = \\sum_{i=1}^{n} \\cos((j-1)\\theta_i) \\cos((k-1)\\theta_i) $$\n使用积化和差三角恒等式 $\\cos(A)\\cos(B) = \\frac{1}{2}(\\cos(A+B) + \\cos(A-B))$，该和为：\n$$ \\frac{1}{2} \\sum_{i=1}^{n} \\left[ \\cos((j+k-2)\\theta_i) + \\cos((j-k)\\theta_i) \\right] $$\n我们需要对整数 $m$ 计算一般形式的和 $S_m = \\sum_{i=1}^{n} \\cos(m\\theta_i)$。这个和是复几何级数 $\\sum_{i=1}^{n} \\exp(im\\theta_i)$ 的实部。\n$$ \\sum_{i=1}^{n} \\exp(im\\theta_i) = \\sum_{i=1}^{n} \\exp\\left(im\\frac{(2i-1)\\pi}{2n}\\right) = \\exp\\left(-im\\frac{\\pi}{2n}\\right) \\sum_{i=1}^{n} \\left(\\exp\\left(im\\frac{\\pi}{n}\\right)\\right)^i $$\n令 $r = \\exp(im\\pi/n)$。该和是一个几何级数 $\\sum_{i=1}^n r^i = r\\frac{1-r^n}{1-r}$，前提是 $r \\neq 1$。\n项 $r^n = \\exp(im\\pi) = (-1)^m$。\n如果 $m$ 是 $2n$ 的非零倍数，则 $r=1$。对于我们问题中的相关索引，$j,k \\in \\{1,\\dots,n\\}$，所以 $j-k$ 的范围是 $-(n-1)$到 $n-1$，$j+k-2$ 的范围是 $0$到 $2n-2$。因此，$m=j-k$ 或 $m=j+k-2$ 永远不会是 $2n$ 的非零倍数。\n如果 $m=0$，则 $S_0 = \\sum_{i=1}^n \\cos(0) = n$。\n如果 $m \\neq 0$ 且不是 $2n$ 的倍数，则几何级数的和为 $\\exp(-im\\pi/2n) \\cdot \\exp(im\\pi/n) \\frac{1 - (-1)^m}{1-\\exp(im\\pi/n)} = \\exp(im\\pi/2n) \\frac{1 - (-1)^m}{1-\\exp(im\\pi/n)}$。\n如果 $m$ 是一个非零偶数，$1-(-1)^m = 0$，所以和为 $0$。\n如果 $m$ 是一个奇数，$1-(-1)^m = 2$。和变为 $\\frac{2\\exp(im\\pi/2n)}{1-\\exp(im\\pi/n)} = \\frac{2\\exp(im\\pi/2n)}{\\exp(im\\pi/2n)(\\exp(-im\\pi/2n)-\\exp(im\\pi/2n))} = \\frac{2}{-2i\\sin(m\\pi/2n)} = \\frac{i}{\\sin(m\\pi/2n)}$。其实部为 $0$。\n因此，对于任何满足 $0  |m|  2n$ 的整数 $m$，$S_m = \\sum_{i=1}^n \\cos(m\\theta_i) = 0$。\n\n现在我们分析和 $(\\Phi^T \\Phi)_{jk} = \\frac{1}{2}(S_{j+k-2} + S_{j-k})$。\n情况 1：$j \\neq k$。则 $j-k \\neq 0$。并且，$1 \\le |j-k| \\le n-1$。所以 $S_{j-k}=0$。同时，$1 \\le j+k-2 \\le 2n-3$（因为 $j, k \\ge 1, j \\neq k$），所以 $S_{j+k-2}=0$。因此，$(\\Phi^T \\Phi)_{jk} = 0$。\n情况 2：$j = k$。则 $j-k=0$ 且 $S_{j-k} = S_0 = n$。和变为 $\\frac{1}{2}(S_{2(j-1)} + n)$。\n子情况 2a：$j=k=1$。多项式次数为 $0$。$2(j-1)=0$。$S_{2(j-1)}=S_0=n$。和为 $\\frac{1}{2}(n+n) = n$。\n子情况 2b：$j=k \\in \\{2, \\dots, n\\}$。多项式次数为 $1, \\dots, n-1$。令 $m=2(j-1)$。则 $2 \\le m \\le 2n-2$。在此范围内，$m$ 是一个非零偶数，所以 $S_m=0$。和为 $\\frac{1}{2}(0+n) = n/2$。\n\n综合这些结果，$\\Phi^T \\Phi$ 是一个对角矩阵：\n$$ \\Phi^T \\Phi = \\text{diag}\\left(n, \\frac{n}{2}, \\frac{n}{2}, \\dots, \\frac{n}{2}\\right) $$\n$\\Phi^T \\Phi$ 的特征值是其对角线元素。它们是 $\\lambda_{\\max} = n$（重数为 $1$）和 $\\lambda = n/2$（重数为 $n-1$）。\n$\\Phi$ 的奇异值是这些特征值的平方根。由于 $n \\ge 2$，我们有 $n  n/2$，所以最大奇异值为 $\\sigma_{\\max}(\\Phi) = \\sqrt{n}$，最小奇异值为 $\\sigma_{\\min}(\\Phi) = \\sqrt{n/2}$。\n因此，2-范数条件数为：\n$$ \\kappa_2(\\Phi) = \\frac{\\sigma_{\\max}(\\Phi)}{\\sigma_{\\min}(\\Phi)} = \\frac{\\sqrt{n}}{\\sqrt{n/2}} = \\sqrt{\\frac{n}{n/2}} = \\sqrt{2} $$\n\n现在，对于问题的第二部分，我们解释为什么选择切比雪夫节点会减缓单项式范德蒙矩阵条件数的增长。\n令 $p(z) = \\sum_{k=0}^{n-1} c_k z^k$ 是一个在单项式基 $\\{z^k\\}$ 中次数至多为 $n-1$ 的多项式。多项式插值问题，即寻找 $p(z)$ 使得 $p(x_i) = y_i$ 对 $i=1,\\dots,n$ 成立，引出线性系统 $V\\mathbf{c} = \\mathbf{y}$，其中 $V$ 是单项式范德蒙矩阵，其元素为 $V_{ij} = x_i^{j-1}$。\n同一个多项式可以在切比雪夫多项式基 $\\{T_k(z)\\}_{k=0}^{n-1}$ 中表示为 $p(z) = \\sum_{k=0}^{n-1} a_k T_k(z)$。在此基下的插值问题是 $\\Phi\\mathbf{a} = \\mathbf{y}$，其中 $\\Phi$ 是问题第一部分中的矩阵，其元素为 $\\Phi_{ij} = T_{j-1}(x_i)$。\n系数向量 $\\mathbf{c}$ 和 $\\mathbf{a}$ 之间存在线性变换。令 $C$ 为基变换矩阵，使得 $\\mathbf{c} = C\\mathbf{a}$。$C$ 的元素由 $T_k(z)$ 展开式中单项式的系数确定。这个矩阵 $C$ 与插值节点 $\\{x_i\\}$ 的选择无关。\n从 $\\mathbf{a} = C^{-1}\\mathbf{c}$ 和 $\\Phi\\mathbf{a} = \\mathbf{y}$，我们得到 $\\Phi C^{-1} \\mathbf{c} = \\mathbf{y}$。将其与 $V\\mathbf{c} = \\mathbf{y}$ 比较，我们发现关系 $V = \\Phi C^{-1}$。\n因此，范德蒙矩阵的条件数与 $\\Phi$ 和 $C^{-1}$ 的条件数相关：$\\kappa_2(V) \\le \\kappa_2(\\Phi) \\kappa_2(C^{-1})$。这表明 $V$ 的条件数受到 $\\Phi$ 的条件数的影响。\n\n节点集之间的关键区别在于 $\\Phi$ 的条件数。\n1.  **切比雪夫节点**：正如我们已经严格证明的，当节点 $\\{x_i\\}$ 是切比雪夫节点 $t_i = \\cos(\\frac{(2i-1)\\pi}{2n})$ 时，矩阵 $\\Phi$ 的条件数极好，为 $\\kappa_2(\\Phi) = \\sqrt{2}$，这是一个与 $n$ 无关的小常数。这是 $\\Phi$ 的列向量关于在这些节点上求和所定义的离散内积是相互正交的直接结果。\n\n2.  **等距节点**：如果我们在 $[-1,1]$ 中选择等距节点，例如 $x_i = -1 + 2(i-1)/(n-1)$，离散正交性就会丧失。用这些节点构成的矩阵 $\\Phi_{\\text{eq}}$ 远非正交，并且已知其条件数 $\\kappa_2(\\Phi_{\\text{eq}})$ 会随着 $n$ 迅速增长。\n\n基变换矩阵 $C$ 的条件数是适中的；其条件数随 $n$ 多项式增长。因此，不同节点集下 $\\kappa_2(V)$ 增长的巨大差异主要归因于 $\\kappa_2(\\Phi)$ 的差异。\n对于等距节点，$\\Phi_{\\text{eq}}$ 的病态条件导致 $\\kappa_2(V_{\\text{eq}})$ 的指数级增长，已知其数量级为 $O(2^n)$。对于切比雪夫节点，$\\Phi_{\\text{cheb}}$ 优良的、为常数的条件数意味着 $\\kappa_2(V_{\\text{cheb}})$ 的增长要温和得多。通过选择切比雪夫节点，我们确保了对于表现良好的切比雪夫基的求值矩阵 $\\Phi$ 本身是良态的，这反过来又缓和了对于同一组节点的单项式范德蒙矩阵 $V$ 的病态条件。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "3580739"}]}