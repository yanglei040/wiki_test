{"hands_on_practices": [{"introduction": "配分函数 $Z = \\sum_{i} g_{i} \\exp(-\\beta E_{i})$ 是统计力学的基石，但其直接计算常常受到数值不稳定性的困扰。当能级 $E_i$ 的绝对值很大时，求和项可能变得极大（上溢）或极小（下溢），从而导致不准确的结果。本练习 [@problem_id:3260986] 介绍了一种关键的稳定化技术，即通过提出基态能量因子来确保指数函数的参数保持在可控范围内，从而实现稳健的计算。", "problem": "在统计力学的正则系综中，配分函数定义为 $Z = \\sum_{i} g_{i} \\exp\\!\\big(-E_{i}/(k_{\\mathrm{B}} T)\\big)$，其中 $g_{i}$ 是能级 $i$ 的简并度，$E_{i}$ 是其能量，$T$ 是绝对温度，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。在有限精度浮点运算中，当某些 $\\exp\\!\\big(-E_{i}/(k_{\\mathrm{B}} T)\\big)$ 的量级极大或极小时，直接求和可能会导致上溢或下溢。\n\n从 $Z$ 的定义和指数函数的基本性质出发，推导出一个 $Z$ 的重构形式。该形式通过提出基态能量 $E_{0}$ 的因子，使得剩余的和由至多为单位量级的项组成。解释为什么这种重构形式在计算 $\\ln Z$ 时能缓解上溢和下溢问题。\n\n然后，将你的重构形式应用于一个三能级系统。该系统温度为 $T$，其简并度和能量以下列无量纲形式给出，其中使用 $\\beta \\equiv 1/(k_{\\mathrm{B}} T)$：\n- $\\beta E_{0} = -1000$, $g_{0} = 1$,\n- $\\beta E_{1} = \\beta E_{0} + 500 \\ln 10$, $g_{1} = 10^{500}$,\n- $\\beta E_{2} = \\beta E_{0} + 1200 \\ln 10$, $g_{2} = 10^{900}$.\n\n使用你的稳定化表达式计算该系统的 $\\ln Z$。将你最终的 $\\ln Z$ 数值结果四舍五入到 $6$ 位有效数字。答案是无量纲的；只需报告数字即可。", "solution": "该问题陈述具有科学依据，提法明确，并且需要应用一种标准的数值稳定化技术。因此，将提供解答。\n\n正则配分函数 $Z$ 由下式给出\n$$\nZ = \\sum_{i} g_{i} \\exp\\left(-\\frac{E_{i}}{k_{\\mathrm{B}} T}\\right)\n$$\n使用定义 $\\beta \\equiv 1/(k_{\\mathrm{B}} T)$，上式变为\n$$\nZ = \\sum_{i} g_{i} \\exp(-\\beta E_{i})\n$$\n\n**第1部分：Z的重构**\n\n为了稳定计算，我们找出基态能量 $E_{0}$，它是系统中的最低能量（对于所有 $i$，$E_{0} \\le E_{i}$）。我们可以从和式中提出与该能量对应的项。我们通过加上再减去 $E_0$ 来重写指数部分：\n$$\n-\\beta E_{i} = -\\beta (E_{i} - E_{0} + E_{0}) = -\\beta(E_{i} - E_{0}) - \\beta E_{0}\n$$\n将此代入 $Z$ 的表达式中：\n$$\nZ = \\sum_{i} g_{i} \\exp\\big(-\\beta(E_{i} - E_{0}) - \\beta E_{0}\\big)\n$$\n利用指数函数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将各项分开：\n$$\nZ = \\sum_{i} g_{i} \\exp\\big(-\\beta(E_{i} - E_{0})\\big) \\exp(-\\beta E_{0})\n$$\n由于项 $\\exp(-\\beta E_{0})$ 是对指标 $i$ 求和的每一项的公因子，因此可以将其从和式中提出：\n$$\nZ = \\exp(-\\beta E_{0}) \\sum_{i} g_{i} \\exp\\big(-\\beta(E_{i} - E_{0})\\big)\n$$\n这就是所求的配分函数的重构形式。令 $\\Delta E_{i} = E_{i} - E_{0}$ 为能态 $i$ 相对于基态的能量。则表达式为：\n$$\nZ = \\exp(-\\beta E_{0}) \\sum_{i} g_{i} \\exp(-\\beta \\Delta E_{i})\n$$\n\n**第2部分：缓解计算 $\\ln Z$ 时的上溢和下溢问题**\n\n为了计算 $\\ln Z$，我们对重构后的表达式取自然对数：\n$$\n\\ln Z = \\ln \\left( \\exp(-\\beta E_{0}) \\sum_{i} g_{i} \\exp\\big(-\\beta(E_{i} - E_{0})\\big) \\right)\n$$\n利用性质 $\\ln(ab) = \\ln(a) + \\ln(b)$：\n$$\n\\ln Z = \\ln\\big(\\exp(-\\beta E_{0})\\big) + \\ln\\left( \\sum_{i} g_{i} \\exp\\big(-\\beta(E_{i} - E_{0})\\big) \\right)\n$$\n$$\n\\ln Z = -\\beta E_{0} + \\ln\\left( \\sum_{i} g_{i} \\exp\\big(-\\beta(E_{i} - E_{0})\\big) \\right)\n$$\n这种形式可以避免数值上溢和下溢，原因如下：\n1.  **防止上溢**：$Z$ 的原始表达式包含 $\\exp(-\\beta E_i)$ 这样的项。如果某个能级 $E_i$ 是很大的负数，则其参数 $-\\beta E_i$ 会成为一个很大的正数，导致 $\\exp(-\\beta E_i)$ 超出标准浮点表示的上限而上溢。在重构后的表达式中，和式内指数项的参数是 $-\\beta (E_{i} - E_{0})$。由于 $E_{0}$ 是基态能量，对于所有的 $i$ 都有 $E_{i} \\ge E_{0}$，这意味着 $(E_{i} - E_{0}) \\ge 0$。又因为 $\\beta = 1/(k_{\\mathrm{B}} T) > 0$，所以参数总是非正数：$-\\beta(E_{i} - E_{0}) \\le 0$。因此，指数项 $\\exp(-\\beta(E_i-E_0))$ 的值总是在范围 $(0, 1]$ 内。这防止了任何单个指数项发生上溢。\n2.  **防止下溢**：在原始表达式中，如果所有能量 $E_i$ 都是很大的正数，那么所有项 $\\exp(-\\beta E_i)$ 可能会变得极小，并在有限精度下下溢为 $0$。这可能导致计算出错误的 $Z=0$ 和 $\\ln Z = -\\infty$。在重构后的和式中，基态（$i=0$）对应的项是 $g_{0} \\exp(-\\beta(E_{0} - E_{0})) = g_{0}\\exp(0) = g_{0}$。由于简并度 $g_0$ 通常是一个正整数（本题中 $g_0=1$），因此和式的值保证至少为 $g_0$。这防止了整个和式下溢为零，从而确保了对数函数有一个有效的参数。\n\n该技术将计算指数和的对数（“log-sum-exp”运算）这一数值不稳定的任务，转化为一个大项 ($-\\beta E_0$) 与一个良态和式的对数之和，从而保证了数值稳定性。\n\n**第3部分：应用于三能级系统**\n\n我们将 $\\ln Z$ 的稳定化公式应用于给定系统：\n$$\n\\ln Z = -\\beta E_{0} + \\ln\\Big(g_{0} \\exp\\big(-\\beta(E_{0}-E_{0})\\big) + g_{1} \\exp\\big(-\\beta(E_{1}-E_{0})\\big) + g_{2} \\exp\\big(-\\beta(E_{2}-E_{0})\\big)\\Big)\n$$\n给定的值为：\n- $-\\beta E_{0} = 1000$\n- $g_{0} = 1$\n- $g_{1} = 10^{500}$ 且 $\\beta(E_{1} - E_{0}) = 500 \\ln 10$\n- $g_{2} = 10^{900}$ 且 $\\beta(E_{2} - E_{0}) = 1200 \\ln 10$\n\n我们来计算对数内的各项：\n- 第0项：$g_{0} \\exp(0) = 1 \\cdot 1 = 1$。\n- 第1项：$g_{1} \\exp(-\\beta(E_{1}-E_{0})) = 10^{500} \\exp(-500 \\ln 10)$。利用恒等式 $a \\exp(b \\ln c) = a \\exp(\\ln(c^b)) = a c^b$，我们有：\n  $$\n  10^{500} \\exp(-500 \\ln 10) = 10^{500} \\exp\\big(\\ln(10^{-500})\\big) = 10^{500} \\cdot 10^{-500} = 10^{0} = 1\n  $$\n- 第2项：$g_{2} \\exp(-\\beta(E_{2}-E_{0})) = 10^{900} \\exp(-1200 \\ln 10)$。类似地：\n  $$\n  10^{900} \\exp(-1200 \\ln 10) = 10^{900} \\exp\\big(\\ln(10^{-1200})\\big) = 10^{900} \\cdot 10^{-1200} = 10^{-300}\n  $$\n\n因此，对数内的和为：\n$$\n\\text{Sum} = 1 + 1 + 10^{-300} = 2 + 10^{-300}\n$$\n现在，我们计算 $\\ln Z$：\n$$\n\\ln Z = 1000 + \\ln(2 + 10^{-300})\n$$\n项 $10^{-300}$ 是一个极小的正数。对于任何小的 $x$，$\\ln(a+x)$ 在 $a$ 附近的泰勒展开式为 $\\ln(a) + x/a + O(x^2)$。此处，$a=2$，$x=10^{-300}$。\n$$\n\\ln(2 + 10^{-300}) \\approx \\ln(2) + \\frac{10^{-300}}{2}\n$$\n$\\ln(2)$ 的值约为 $0.69314718$。修正项 $0.5 \\times 10^{-300}$ 远小于最终答案所需的精度。因此，为了四舍五入到 $6$ 位有效数字，我们可以将 $\\ln(2 + 10^{-300})$ 近似为 $\\ln(2)$。\n$$\n\\ln Z \\approx 1000 + \\ln(2) \\approx 1000 + 0.6931471805... = 1000.6931471805...\n$$\n题目要求将最终结果四舍五入到 $6$ 位有效数字。$1000.693147...$ 的前六位有效数字是 $1, 0, 0, 0, 6, 9$。第七位有效数字是 $3$，小于 $5$，所以我们向下舍入（即截断）。\n$$\n\\ln Z \\approx 1000.69\n$$", "answer": "$$\n\\boxed{1000.69}\n$$", "id": "3260986"}, {"introduction": "热力学中的一个核心原则是尺度一致性（size consistency），即对于由无相互作用部分组成的复合系统，其自由能等于各部分自由能之和。这一性质直接源于其配分函数的乘法特性，$Z_{A \\cdot B} = Z_A Z_B$。本练习 [@problem_id:2805747] 提供了对该原则的动手数值验证，要求你分别计算并比较由单个片段和显式构建的复合系统得到的自由能。", "problem": "要求您在正则系综中，为有限温度下的无相互作用片段构建广延一致性与广延性的数值验证。请完全使用无量纲亥姆霍兹自由能，其定义为 $\\phi \\equiv \\beta F = -\\ln Z$，其中 $F$ 为亥姆霍兹自由能，$Z$ 为正则配分函数，$\\beta \\equiv 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 为玻尔兹曼常数，$T$ 为绝对温度。对于一个具有离散能级 $\\{E_i\\}$ 和简并度 $\\{g_i\\}$ 的系统，其配分函数为 $Z = \\sum_i g_i \\exp(-\\beta E_i)$。对于两个哈密顿量可交换且可加的无相互作用片段 $A$ 和 $B$，复合系统 $A \\cdot B$ 的配分函数具有乘积形式 $Z_{A \\cdot B} = Z_A Z_B$，这意味着通过 $\\phi_{A \\cdot B} = \\phi_A + \\phi_B$ 实现广延一致性。\n\n您的任务是实现一个程序，对每个提供的测试用例执行以下操作：\n- 给定片段 $A$ 的能量 $\\{E_i^A\\}$ 和简并度 $\\{g_i^A\\}$，片段 $B$ 的能量 $\\{E_j^B\\}$ 和简并度 $\\{g_j^B\\}$，以及逆温度 $\\beta$，计算：\n  1. 通过对求和 $\\sum_i g_i^A \\exp(-\\beta E_i^A)$ 和 $\\sum_j g_j^B \\exp(-\\beta E_j^B)$ 进行数值稳定化，分别计算 $\\ln Z_A$ 和 $\\ln Z_B$。\n  2. 通过显式地枚举具有能量 $\\{E_i^A + E_j^B\\}$ 和简并度 $\\{g_i^A g_j^B\\}$ 的复合谱，并对相应的求和进行稳定化，来计算 $\\ln Z_{A \\cdot B}$。\n  3. 无量纲自由能 $\\phi_A = -\\ln Z_A$、$\\phi_B = -\\ln Z_B$ 和 $\\phi_{A \\cdot B} = -\\ln Z_{A \\cdot B}$。\n  4. 一个布尔值，指示广延一致性条件是否在数值容差范围内成立：$\\lvert \\phi_{A \\cdot B} - (\\phi_A + \\phi_B) \\rvert \\le \\epsilon$，其中 $\\epsilon = 10^{-12}$。\n- 所有能量均应视为任意一致单位，输出为无量纲自由能。不涉及角度。输出中无需物理单位，因为 $\\phi$ 是无量纲的。\n\n使用以下测试套件。每个测试用例是一个元组 $(\\beta, \\{E_i^A\\}, \\{g_i^A\\}, \\{E_j^B\\}, \\{g_j^B\\})$：\n- 用例 1：$\\beta = 0.7$, $\\{E_i^A\\} = [0.0, 1.0, 2.0]$, $\\{g_i^A\\} = [1, 2, 1]$, $\\{E_j^B\\} = [0.0, 0.5]$, $\\{g_j^B\\} = [1, 3]$。\n- 用例 2 (高温极限)：$\\beta = 10^{-6}$, $\\{E_i^A\\} = [0.0, 10.0, 20.0]$, $\\{g_i^A\\} = [1, 1, 1]$, $\\{E_j^B\\} = [0.0, 30.0]$, $\\{g_j^B\\} = [2, 1]$。\n- 用例 3 (具有基态简并度的低温极限)：$\\beta = 100.0$, $\\{E_i^A\\} = [0.0, 0.01]$, $\\{g_i^A\\} = [2, 1]$, $\\{E_j^B\\} = [0.0, 0.02]$, $\\{g_j^B\\} = [3, 5]$。\n- 用例 4 (负能级和正能级，单能级伴侣)：$\\beta = 2.3$, $\\{E_i^A\\} = [-0.5, 0.0, 0.5]$, $\\{g_i^A\\} = [1, 3, 2]$, $\\{E_j^B\\} = [1.23456]$, $\\{g_j^B\\} = [7]$。\n- 用例 5 (大能量偏移以测试数值稳定性)：$\\beta = 0.4$, $\\{E_i^A\\} = [50.2, 51.9]$, $\\{g_i^A\\} = [4, 1]$, $\\{E_j^B\\} = [0.3, 0.9, 2.1]$, $\\{g_j^B\\} = [1, 2, 1]$。\n\n算法要求：\n- 使用 log-sum-exp 变换实现 $\\ln Z$ 的数值稳定计算：若 $a_k = \\ln g_k - \\beta E_k$，则 $\\ln Z = m + \\ln \\sum_k \\exp(a_k - m)$，其中 $m = \\max_k a_k$。\n- 对 $A \\cdot B$ 显式使用复合能量-简并度枚举，即枚举所有对 $(i,j)$ 以形成能量 $E_i^A + E_j^B$ 和简并度 $g_i^A g_j^B$。不要通过简单地将 $\\ln Z_A$ 和 $\\ln Z_B$ 相加来计算 $\\ln Z_{A \\cdot B}$，因为目的是数值上验证此等式。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，例如 $[ \\text{result1}, \\text{result2}, \\text{result3}, \\ldots ]$。\n- 每个结果都是一个布尔值，指示对应测试用例的 $\\lvert \\phi_{A \\cdot B} - (\\phi_A + \\phi_B) \\rvert \\le 10^{-12}$ 是否成立。", "solution": "我们从具有简并度的离散谱的正则系综定义开始。对于一个在逆温度 $\\beta \\equiv 1/(k_{\\mathrm{B}} T)$ 下，具有能级 $\\{E_i\\}$ 和简并度 $\\{g_i\\}$ 的系统，其正则配分函数为\n$$\nZ = \\sum_{i} g_i \\exp(-\\beta E_i).\n$$\n亥姆霍兹自由能为 $F = -k_{\\mathrm{B}} T \\ln Z$。无量纲亥姆霍兹自由能定义为 $\\phi \\equiv \\beta F = - \\ln Z$。因此，如果我们能以数值稳定的方式计算 $\\ln Z$，那么 $\\phi = -\\ln Z$ 就直接得出。\n\n对于两个无相互作用的片段 $A$ 和 $B$，其哈密顿算符 $\\hat{H}_A$ 和 $\\hat{H}_B$ 对复合系统而言是可交换且可加的，复合系统 $A \\cdot B$ 的能级是所有成对的和 $E_{ij}^{A \\cdot B} = E_i^A + E_j^B$，相应的简并度是乘积 $g_{ij}^{A \\cdot B} = g_i^A g_j^B$。那么，复合系统的配分函数为\n$$\nZ_{A \\cdot B} = \\sum_{i,j} g_i^A g_j^B \\exp\\!\\left(-\\beta (E_i^A + E_j^B)\\right) \n= \\left(\\sum_i g_i^A \\exp(-\\beta E_i^A)\\right)\\left(\\sum_j g_j^B \\exp(-\\beta E_j^B)\\right) = Z_A Z_B.\n$$\n取对数并使用 $\\phi$ 的定义，我们得到\n$$\n\\phi_{A \\cdot B} = -\\ln Z_{A \\cdot B} = -\\ln(Z_A Z_B) = -\\ln Z_A - \\ln Z_B = \\phi_A + \\phi_B.\n$$\n在热力学和有限温度的背景下，这种可加性体现了广延一致性与广延性：对于无相互作用的片段，总系统的自由能是各片段自由能的总和。\n\n算法设计：\n- 直接对 $\\sum_i g_i \\exp(-\\beta E_i)$ 求和可能会遇到下溢或上溢问题，特别是对于大的 $\\beta$ 或大的能量偏移。为确保数值稳定性，我们使用 log-sum-exp 变换。定义 $a_i \\equiv \\ln g_i - \\beta E_i$。那么\n$$\n\\ln Z = \\ln \\sum_i \\exp(a_i) = m + \\ln \\sum_i \\exp(a_i - m),\n$$\n其中 $m \\equiv \\max_i a_i$。这将指数进行平移，使得最大的指数为零，从而将求和保持在数值安全的范围内。\n- 对于复合系统 $A \\cdot B$，我们显式地枚举所有对 $(i,j)$ 以形成复合能量 $E_{ij} = E_i^A + E_j^B$ 和简并度 $g_{ij} = g_i^A g_j^B$，然后应用相同的 log-sum-exp 方法计算 $\\ln Z_{A \\cdot B}$。这样可以避免通过 $\\ln Z_{A \\cdot B} = \\ln Z_A + \\ln Z_B$ 简单地强制等式成立，而是对其进行数值验证。\n- 计算出 $\\ln Z_A$、$\\ln Z_B$ 和 $\\ln Z_{A \\cdot B}$ 后，我们计算 $\\phi_A = -\\ln Z_A$、$\\phi_B = -\\ln Z_B$ 和 $\\phi_{A \\cdot B} = -\\ln Z_{A \\cdot B}$，并测试是否 $\\lvert \\phi_{A \\cdot B} - (\\phi_A + \\phi_B) \\rvert \\le \\epsilon$，其中 $\\epsilon = 10^{-12}$。\n\n测试覆盖范围说明：\n- 用例 1 提供了在中等 $\\beta$ 下能量和简并度的通用混合情况，以测试一般情况。\n- 用例 2 使用非常小的 $\\beta$（高温），因此许多状态的贡献几乎相等；这测试了当指数接近1时的稳定性。\n- 用例 3 使用非常大的 $\\beta$（低温），以确保基态占主导地位，并测试简并度在低温极限下的作用。\n- 用例 4 包括负能量和一个单能级伴侣，以测试能量平移和谱尺寸不对称时的行为。\n- 用例 5 包括大的正能量偏移，以对 log-sum-exp 稳定化进行压力测试，并避免朴素求和中的下溢。\n\n该程序实现了一个函数来稳健地计算 $\\ln Z$，然后将其应用于片段 $A$ 和 $B$ 以及通过显式枚举构建的复合系统。对于每个用例，它输出一个布尔值，指示广延一致性条件是否在规定的数值容差内成立。最终输出是包含布尔值列表的单行，格式如指定。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef log_partition(energies, degeneracies, beta):\n    \"\"\"\n    Compute ln Z for a discrete spectrum using a numerically stable log-sum-exp.\n    energies: 1D array-like of energy levels E_i\n    degeneracies: 1D array-like of positive degeneracies g_i (integers)\n    beta: float inverse temperature\n    \"\"\"\n    E = np.array(energies, dtype=float).ravel()\n    g = np.array(degeneracies, dtype=float).ravel()\n    if E.size != g.size:\n        raise ValueError(\"Energies and degeneracies must have the same length.\")\n    if np.any(g = 0):\n        raise ValueError(\"Degeneracies must be positive.\")\n    a = np.log(g) - beta * E\n    m = np.max(a)\n    # log-sum-exp\n    logZ = m + np.log(np.sum(np.exp(a - m)))\n    return logZ\n\ndef composite_spectrum(energies_A, degeneracies_A, energies_B, degeneracies_B):\n    \"\"\"\n    Enumerate composite spectrum energies and degeneracies for noninteracting A and B.\n    Returns flattened arrays of composite energies and degeneracies.\n    \"\"\"\n    E_A = np.array(energies_A, dtype=float).ravel()\n    g_A = np.array(degeneracies_A, dtype=float).ravel()\n    E_B = np.array(energies_B, dtype=float).ravel()\n    g_B = np.array(degeneracies_B, dtype=float).ravel()\n    # Pairwise sums via broadcasting\n    E_AB = (E_A[:, None] + E_B[None, :]).reshape(-1)\n    # Pairwise degeneracy products via outer product\n    g_AB = (g_A[:, None] * g_B[None, :]).reshape(-1)\n    return E_AB, g_AB\n\ndef dimensionless_free_energy_logZ(logZ):\n    \"\"\"\n    Convert ln Z to the dimensionless Helmholtz free energy phi = - ln Z.\n    \"\"\"\n    return -logZ\n\ndef validate_case(beta, E_A, g_A, E_B, g_B, tol=1e-12):\n    \"\"\"\n    For a single test case, compute phi_A, phi_B, phi_AB and check size consistency:\n    |phi_AB - (phi_A + phi_B)| = tol\n    \"\"\"\n    # ln Z for A and B\n    lnZ_A = log_partition(E_A, g_A, beta)\n    lnZ_B = log_partition(E_B, g_B, beta)\n\n    # Composite by explicit enumeration\n    E_AB, g_AB = composite_spectrum(E_A, g_A, E_B, g_B)\n    lnZ_AB = log_partition(E_AB, g_AB, beta)\n\n    # Dimensionless Helmholtz free energies\n    phi_A = dimensionless_free_energy_logZ(lnZ_A)\n    phi_B = dimensionless_free_energy_logZ(lnZ_B)\n    phi_AB = dimensionless_free_energy_logZ(lnZ_AB)\n\n    diff = abs(phi_AB - (phi_A + phi_B))\n    return diff = tol\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (beta, energies_A, degeneracies_A, energies_B, degeneracies_B)\n    test_cases = [\n        (0.7, [0.0, 1.0, 2.0], [1, 2, 1], [0.0, 0.5], [1, 3]),\n        (1e-6, [0.0, 10.0, 20.0], [1, 1, 1], [0.0, 30.0], [2, 1]),\n        (100.0, [0.0, 0.01], [2, 1], [0.0, 0.02], [3, 5]),\n        (2.3, [-0.5, 0.0, 0.5], [1, 3, 2], [1.23456], [7]),\n        (0.4, [50.2, 51.9], [4, 1], [0.3, 0.9, 2.1], [1, 2, 1]),\n    ]\n\n    results = []\n    for case in test_cases:\n        beta, E_A, g_A, E_B, g_B = case\n        result = validate_case(beta, E_A, g_A, E_B, g_B, tol=1e-12)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2805747"}, {"introduction": "统计力学提供了不同的系综（如正则系综、巨正则系综）来描述处于不同物理约束下的系统。一个深刻的概念是系综等价性：在热力学极限下，这些不同的描述会收敛并给出相同的宏观性质。本练习 [@problem_id:3489860] 深入探讨了这一原理，通过比较在正则系综（固定粒子数）和巨正则系综（固定化学势）中计算的点缺陷模型的相应热力学势，展示了巨正则方法在处理可变粒子数系统时的强大功能与便利性。", "problem": "考虑一个晶体固体的非相互作用点缺陷模型，该模型具有固定数量的可用晶格位置。假设有 $D$ 个等效且独立的位点，每个位点最多可以容纳一个点缺陷（例如，一个空位）。创建一个缺陷需要耗费能量 $ \\epsilon_f $（形成能），以电子伏特 (eV) 为单位。该系统与一个大热库接触，该热库在绝对温度 $ T $（以开尔文为单位）下，将与缺陷数量共轭的有效化学势 $ \\mu $（以 eV 为单位）固定。假设这些位点不相互作用，并且除了提供 $D$ 个可用位点外，主体自由度对缺陷统计没有贡献。\n\n您的任务如下，仅从统计系综的第一性原理定义出发：\n\n1) 从巨正则 (GC) 系综的巨配分函数定义 $ \\Xi = \\sum_{\\text{microstates}} \\exp\\left[-\\beta \\left(E - \\mu N\\right)\\right] $（其中 $ \\beta = 1/(k_{\\mathrm{B}} T) $，$ k_{\\mathrm{B}} $ 为玻尔兹曼常数）出发，推导此缺陷系统的巨势 $ \\Omega(T,V,\\mu) = - k_{\\mathrm{B}} T \\ln \\Xi $ 的显式闭合表达式，其中 $ V $ 是系统体积。清晰地陈述为达到最终形式所使用的任何因子分解步骤和假设，并用 $ T $ 和无量纲活度 $ z \\equiv \\exp\\left(\\beta(\\mu - \\epsilon_f)\\right) $ 来表示单位位点的巨势 $ \\omega = \\Omega/D $。\n\n2) 在缺陷数 $ n $ 固定（$ 0 \\le n \\le D $）的正则 (C) 系综中，从正则配分函数定义 $ Z_n = \\sum_{\\text{microstates at fixed }n} \\exp(-\\beta E) $ 出发。通过组合学方法对微观态进行计数，推导此模型 $ Z_n $ 的精确表达式。然后写出单位位点的亥姆霍兹自由能 $ f(n,D,T) = F/D = - (k_{\\mathrm{B}} T/D) \\ln Z_n $，并将其表示为适合在有限 $ D $ 下进行数值计算的形式。\n\n3) 利用系综之间的勒让德变换结构，在固定的 $ \\mu $下定义正则系综到巨正则系综的比较量为 $ \\phi_D(n; T, \\mu) = f(n,D,T) - \\mu \\, (n/D) $，并通过在最接近 GC 平均缺陷数 $ \\langle n \\rangle = D \\, \\frac{z}{1+z} $ 的整数 $ n^\\star $ 处计算 $ \\phi_D $，将其与 GC 单位位点的巨势 $ \\omega(T,\\mu) $进行比较。从第一性原理出发，讨论为什么当 $ D \\to \\infty $（热力学极限）时，$ \\phi_D(n^\\star; T,\\mu) \\to \\omega(T,\\mu) $，并量化 GC 系综中粒子数涨落随 $ D $ 的标度关系。\n\n4) 编写一个程序，对于一组给定的参数 $ (D, T, \\epsilon_f, \\mu) $，计算以下四个量：\n   - 单位位点的巨势 $ \\omega(T,\\mu) $，以 eV 为单位。\n   - 在 $ n^\\star $ 处计算的单位位点正则勒让德变换量 $ \\phi_D(n^\\star; T,\\mu) $，以 eV 为单位，使用具有数值稳定对数的 $ Z_n $ 的精确有限 $ D $ 组合表达式。\n   - 单位位点的绝对差异 $ \\delta = \\left| \\omega(T,\\mu) - \\phi_D(n^\\star; T,\\mu) \\right| $，以 eV 为单位。\n   - GC 系综中缺陷分数（单位位点的缺陷数）的标准差 $ \\delta x = \\sqrt{\\mathrm{Var}(n)}/D = \\sqrt{ \\frac{z}{1+z} \\left(1 - \\frac{z}{1+z}\\right) \\frac{1}{D} } $，此为无量纲量。\n\n使用 $ k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5} $ eV/K，所有能量以 eV 表示，所有温度以 K 表示。程序不得读取任何输入，并且必须为以下五个测试用例（测试套件）计算输出：\n\n-   用例 1：$ D = 1000 $，$ T = 1000 $ K，$ \\epsilon_f = 1.0 $ eV，$ \\mu = 0.2 $ eV。\n-   用例 2：$ D = 1000 $，$ T = 600 $ K，$ \\epsilon_f = 0.5 $ eV，$ \\mu = 0.3 $ eV。\n-   用例 3：$ D = 1000 $，$ T = 800 $ K，$ \\epsilon_f = 0.6 $ eV，$ \\mu = 0.6 $ eV。\n-   用例 4：$ D = 100000 $，$ T = 800 $ K，$ \\epsilon_f = 0.8 $ eV，$ \\mu = 0.3 $ eV。\n-   用例 5：$ D = 50 $，$ T = 400 $ K，$ \\epsilon_f = 0.2 $ eV，$ \\mu = 0.35 $ eV。\n\n数值要求：\n-   对组合因子使用稳定的对数，例如通过伽马函数的对数来计算 $ \\ln \\binom{D}{n} $。\n-   选择 $ n^\\star $ 时，使用 $ n^\\star = \\mathrm{round}\\!\\left(D \\, \\frac{z}{1+z}\\right) $ 并将其限制在区间 $ [0, D] $ 内。\n\n最终输出格式：\n-   您的程序应生成单行输出，其中包含一个含五个元素的列表，每个元素对应一个测试用例。每个元素本身是按 $ [\\omega, \\phi_D(n^\\star), \\delta, \\delta x] $ 顺序排列的四个浮点数列表。该列表必须以方括号括起来的逗号分隔列表形式打印，例如 $ [[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],\\dots] $。", "solution": "首先根据指定标准验证问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   系统：晶体固体的非相互作用点缺陷模型。\n-   等效且独立的位点数：$D$。\n-   位点占据情况：每个位点最多容纳一个缺陷。\n-   缺陷形成能：$\\epsilon_f$（以 eV 为单位）。\n-   任务 1 的热力学系综：巨正则 (GC) 系综，与固定绝对温度 $T$（以开尔文为单位）和有效化学势 $\\mu$（以 eV 为单位）的热库接触。\n-   巨配分函数定义：$\\Xi = \\sum_{\\text{microstates}} \\exp\\left[-\\beta \\left(E - \\mu N\\right)\\right]$。\n-   逆温度：$\\beta = 1/(k_{\\mathrm{B}} T)$。\n-   玻尔兹曼常数：$k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}$ eV/K。\n-   巨势定义：$\\Omega(T,V,\\mu) = -k_{\\mathrm{B}} T \\ln \\Xi$。\n-   单位位点的巨势：$\\omega = \\Omega/D$。\n-   活度定义：$z \\equiv \\exp\\left(\\beta(\\mu - \\epsilon_f)\\right)$。\n-   任务 2 的热力学系综：正则 (C) 系综，具有固定数量的缺陷 $n$，其中 $0 \\le n \\le D$。\n-   正则配分函数定义：$Z_n = \\sum_{\\text{microstates at fixed }n} \\exp(-\\beta E)$。\n-   单位位点的亥姆霍兹自由能：$f(n,D,T) = F/D = - (k_{\\mathrm{B}} T/D) \\ln Z_n$。\n-   比较量：$\\phi_D(n; T, \\mu) = f(n,D,T) - \\mu \\, (n/D)$。\n-   比较的计算点：$n^\\star$，最接近 GC 平均缺陷数 $\\langle n \\rangle = D \\, \\frac{z}{1+z}$ 的整数。具体来说，$n^\\star = \\mathrm{round}\\!\\left(D \\, \\frac{z}{1+z}\\right)$，并限制在 $[0, D]$ 区间内。\n-   缺陷分数的涨落：$\\delta x = \\sqrt{\\mathrm{Var}(n)}/D = \\sqrt{ \\frac{z}{1+z} \\left(1 - \\frac{z}{1+z}\\right) \\frac{1}{D} }$。\n-   测试用例：\n    1.  $D = 1000$, $T = 1000$ K, $\\epsilon_f = 1.0$ eV, $\\mu = 0.2$ eV.\n    2.  $D = 1000$, $T = 600$ K, $\\epsilon_f = 0.5$ eV, $\\mu = 0.3$ eV.\n    3.  $D = 1000$, $T = 800$ K, $\\epsilon_f = 0.6$ eV, $\\mu = 0.6$ eV.\n    4.  $D = 100000$, $T = 800$ K, $\\epsilon_f = 0.8$ eV, $\\mu = 0.3$ eV.\n    5.  $D = 50$, $T = 400$ K, $\\epsilon_f = 0.2$ eV, $\\mu = 0.35$ eV.\n-   数值要求：对组合因子使用稳定的对数（例如，通过对数伽马函数）。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题描述了一个标准的格气模型，这是凝聚态物理中统计力学的基石。所有引用的定义和原理（$\\Xi, Z, \\Omega, F$, 系综理论）都是基础且公认的。\n-   **适定性**：问题定义清晰，提供了所有必要的参数和方程。它要求进行特定的推导和计算，从而得到一个唯一的、有意义的结果。\n-   **客观性**：问题以精确、定量的术语陈述，没有任何主观或模糊的语言。\n\n问题陳述在科学上是合理的、自洽的且适定的。它不违反任何无效性标准。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。将提供完整解答。\n\n---\n\n### 解答推导与说明\n\n本问题使用非相互作用点缺陷模型，探讨了巨正则 (GC) 系综与正则 (C) 系综之间的关系。我们将为每个系综推导热力学势，然后证明它们在热力学极限下是等价的。\n\n**1) 巨正则系综和巨势 ($\\omega$)**\n\n巨配分函数定义为 $\\Xi = \\sum_{\\text{all microstates}} \\exp\\left[-\\beta \\left(E - \\mu N\\right)\\right]$。系统的微观态由 $D$ 个可用位点中每个位点的占据情况指定。设位点 $i$ 的状态由变量 $s_i$ 表示，如果该位点被缺陷占据，则 $s_i=1$，如果为空，则 $s_i=0$。\n\n对于一个给定的微观态 $\\{s_1, s_2, ..., s_D\\}$，缺陷总数为 $N = \\sum_{i=1}^D s_i$，总能量为 $E = \\sum_{i=1}^D s_i \\epsilon_f = N \\epsilon_f$，因为缺陷不相互作用。\n\n单个微观态的配分函数指数项为：\n$$ E - \\mu N = N \\epsilon_f - \\mu N = N (\\epsilon_f - \\mu) = (\\sum_{i=1}^D s_i)(\\epsilon_f - \\mu) = \\sum_{i=1}^D s_i (\\epsilon_f - \\mu) $$\n对所有微观态的求和是对 $\\{s_1, ..., s_D\\}$ 所有可能值的求和，其中每个 $s_i$ 可以是 $0$ 或 $1$。\n$$ \\Xi = \\sum_{s_1=0}^1 \\sum_{s_2=0}^1 \\dots \\sum_{s_D=0}^1 \\exp\\left[ -\\beta \\sum_{i=1}^D s_i (\\epsilon_f - \\mu) \\right] $$\n利用性质 $\\exp(\\sum x_i) = \\prod \\exp(x_i)$，我们可以写出：\n$$ \\Xi = \\sum_{s_1=0}^1 \\dots \\sum_{s_D=0}^1 \\prod_{i=1}^D \\exp\\left[ -\\beta s_i (\\epsilon_f - \\mu) \\right] $$\n由于位点是独立的，乘积之和可以分解为求和之积：\n$$ \\Xi = \\prod_{i=1}^D \\left( \\sum_{s_i=0}^1 \\exp\\left[ -\\beta s_i (\\epsilon_f - \\mu) \\right] \\right) $$\n让我们计算单个位点 $i$ 的求和：\n$$ \\sum_{s_i=0}^1 \\exp\\left[ -\\beta s_i (\\epsilon_f - \\mu) \\right] = \\exp(0) + \\exp\\left[ -\\beta(\\epsilon_f - \\mu) \\right] = 1 + \\exp\\left[ \\beta(\\mu - \\epsilon_f) \\right] $$\n由于所有 $D$ 个位点都是等效的，这个单位点配分函数（我们称之为 $\\xi_1$）对所有位点都是相同的。\n$$ \\xi_1 = 1 + \\exp\\left[ \\beta(\\mu - \\epsilon_f) \\right] $$\n因此，总巨配分函数为 $\\Xi = (\\xi_1)^D$。\n$$ \\Xi = \\left( 1 + \\exp\\left[ \\beta(\\mu - \\epsilon_f) \\right] \\right)^D $$\n巨势 $\\Omega$ 由 $\\Omega = -k_{\\mathrm{B}} T \\ln \\Xi$ 给出。\n$$ \\Omega(T, \\mu) = -k_{\\mathrm{B}} T \\ln \\left[ \\left( 1 + \\exp\\left[ \\beta(\\mu - \\epsilon_f) \\right] \\right)^D \\right] = -D k_{\\mathrm{B}} T \\ln \\left( 1 + \\exp\\left[ \\beta(\\mu - \\epsilon_f) \\right] \\right) $$\n单位位点的巨势 $\\omega = \\Omega/D$ 为：\n$$ \\omega(T, \\mu) = -k_{\\mathrm{B}} T \\ln \\left( 1 + \\exp\\left[ \\beta(\\mu - \\epsilon_f) \\right] \\right) $$\n使用给定的活度定义 $z = \\exp\\left( \\beta(\\mu - \\epsilon_f) \\right)$，表达式简化为：\n$$ \\omega(T, \\mu) = -k_{\\mathrm{B}} T \\ln(1+z) $$\n\n**2) 正则系综和亥姆霍兹自由能 ($f$)**\n\n在正则系综中，缺陷数 $n$ 是固定的（$0 \\le n \\le D$）。正则配分函数为 $Z_n = \\sum_{\\text{microstates at fixed }n} \\exp(-\\beta E)$。\n对于固定的缺陷数 $n$，任何微观态的能量都是 $E = n \\epsilon_f$，这在该子系综的所有微观态中是恒定的。\n因此，我们可以将能量项从求和中提出来：\n$$ Z_n = \\exp(-\\beta n \\epsilon_f) \\sum_{\\text{microstates at fixed }n} 1 $$\n这个求和只是计算将 $n$ 个不可区分的缺陷排列在 $D$ 个可区分位点上的方式数。这由二项式系数 $\\binom{D}{n}$ 给出。\n$$ Z_n = \\binom{D}{n} \\exp(-\\beta n \\epsilon_f) $$\n亥姆霍兹自由能为 $F_n = -k_{\\mathrm{B}} T \\ln Z_n$。\n$$ F_n = -k_{\\mathrm{B}} T \\ln\\left[ \\binom{D}{n} \\exp(-\\beta n \\epsilon_f) \\right] = -k_{\\mathrm{B}} T \\left[ \\ln\\binom{D}{n} - \\beta n \\epsilon_f \\right] = n \\epsilon_f - k_{\\mathrm{B}} T \\ln\\binom{D}{n} $$\n单位位点的亥姆霍兹自由能 $f(n,D,T) = F_n/D$ 为：\n$$ f(n,D,T) = \\frac{n \\epsilon_f}{D} - \\frac{k_{\\mathrm{B}} T}{D} \\ln\\binom{D}{n} $$\n为了数值稳定性，特别是对于大的 $D$ 和 $n$，项 $\\ln\\binom{D}{n}$ 使用伽马函数的对数来计算，即 $\\ln(k!) = \\ln(\\Gamma(k+1))$。\n$$ \\ln\\binom{D}{n} = \\ln(D!) - \\ln(n!) - \\ln((D-n)!) = \\ln(\\Gamma(D+1)) - \\ln(\\Gamma(n+1)) - \\ln(\\Gamma(D-n+1)) $$\n\n**3) 系综等价性与涨落**\n\n正则系综和巨正则系綜之间的联系是通过勒让德变换建立的。巨势 $\\Omega$ 是勒让德变换后的亥姆霍兹自由能的最小值：$\\Omega(T, \\mu) = \\min_n (F_n - \\mu n)$。对于宏观系统（大 $D$），这个最小值非常尖锐，意味着热力学性质由具有平均粒子数 $\\langle n \\rangle$ 的状态主导。这就是系综等价性原理。\n\n我们被要求将 $\\omega = \\Omega/D$ 与在最接近 $\\langle n \\rangle$ 的整数 $n^\\star$ 处计算的量 $\\phi_D(n; T, \\mu) = f(n,D,T) - \\mu (n/D)$ 进行比较。\n$$ \\phi_D(n; T, \\mu) = \\frac{F_n - \\mu n}{D} $$\n在热力学极限 ($D \\to \\infty$)下，我们期望 $\\phi_D(\\langle n \\rangle; T, \\mu) \\to \\omega(T,\\mu)$。为了证明这一点，我们对大 $D$ 和 $n$ 使用斯特林近似来处理 $\\ln\\binom{D}{n}$。令 $x = n/D$ 为缺陷分数：\n$$ \\frac{1}{D}\\ln\\binom{D}{n} \\approx -[x \\ln x + (1-x)\\ln(1-x)] $$\n这一项表示单位位点的构型熵（除以 $k_{\\mathrm{B}}$）。将其代入 $f$ 的表达式中：\n$$ f(x,T) \\approx x \\epsilon_f + k_{\\mathrm{B}} T [x \\ln x + (1-x)\\ln(1-x)] $$\n需要最小化的函数是 $\\phi(x; T, \\mu) = f(x,T) - \\mu x$。平衡浓度 $x_{eq}$ 通过将其对 $x$ 的导数设为零来找到：\n$$ \\frac{\\partial \\phi}{\\partial x} = \\epsilon_f + k_{\\mathrm{B}} T[\\ln x + 1 - \\ln(1-x) - 1] - \\mu = 0 $$\n$$ \\epsilon_f - \\mu + k_{\\mathrm{B}} T \\ln\\left(\\frac{x}{1-x}\\right) = 0 \\implies \\frac{x}{1-x} = \\exp\\left(-\\beta(\\epsilon_f - \\mu)\\right) = \\exp\\left(\\beta(\\mu - \\epsilon_f)\\right) = z $$\n求解 $x$ 得到 $x_{eq} = \\frac{z}{1+z}$，这恰好是 GC 系综中的平均缺陷分数 $\\langle n \\rangle / D$。\n\n将 $x_{eq}$ 代回 $\\phi(x; T, \\mu)$ 中得到：\n$$ \\phi_{min} = x_{eq}(\\epsilon_f - \\mu) + k_{\\mathrm{B}} T [x_{eq} \\ln x_{eq} + (1-x_{eq})\\ln(1-x_{eq})] $$\n使用 $\\ln(\\frac{x_{eq}}{1-x_{eq}}) = \\beta(\\mu - \\epsilon_f)$，代入并进行代数简化后表明，该表达式可简化为：\n$$ \\phi_{min} = -k_{\\mathrm{B}} T \\ln(1+z) = \\omega(T,\\mu) $$\n这证实了在热力学极限下系综的等价性。对于有限 $D$ 的量 $\\phi_D(n^\\star; T,\\mu)$ 是对此最小值的近似，并且当 $D \\to \\infty$ 时收敛于 $\\omega$。\n\nGC 系综中粒子数 $n$ 的涨落量化了围绕 $\\langle n \\rangle$ 分布的“宽度”。方差为 $\\mathrm{Var}(n) = k_{\\mathrm{B}} T (\\partial \\langle n \\rangle / \\partial \\mu)_T$。如在思考过程中推導的，这给出：\n$$ \\mathrm{Var}(n) = D \\frac{z}{(1+z)^2} = D \\left(\\frac{z}{1+z}\\right) \\left(1 - \\frac{z}{1+z}\\right) $$\n*缺陷分数* $x=n/D$ 的涨落由其标准差给出：\n$$ \\delta x = \\frac{\\sqrt{\\mathrm{Var}(n)}}{D} = \\frac{\\sqrt{D z/(1+z)^2}}{D} = \\frac{1}{\\sqrt{D}} \\frac{\\sqrt{z}}{1+z} $$\n这表明强度量 $x$ 的涨落与 $1/\\sqrt{D}$ 成标度关系，并在热力学极限 ($D \\to \\infty$)下消失，这是系综变得等价的一个关键原因。\n\n**4) 程序实现**\n\n所提供的程序实现了这些推导出的公式，为每个测试用例计算所要求的四个量。它使用 `numpy` 进行数值运算，并使用 `scipy.special.gammaln` 对正则自由能中的组合项进行数值稳定的计算。其逻辑遵循了上述详细步骤：计算 GC 系综的量，确定 $n^\\star$，计算相应的正则系综量 $\\phi_D$，最后计算差异 $\\delta$ 和涨落 $\\delta x$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Solves the statistical mechanics problem for point defects in a crystal\n    for a given set of test cases.\n    \"\"\"\n    \n    # Constants\n    k_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: D=1000, T=1000 K, eps_f=1.0 eV, mu=0.2 eV\n        (1000, 1000.0, 1.0, 0.2),\n        # Case 2: D=1000, T=600 K, eps_f=0.5 eV, mu=0.3 eV\n        (1000, 600.0, 0.5, 0.3),\n        # Case 3: D=1000, T=800 K, eps_f=0.6 eV, mu=0.6 eV\n        (1000, 800.0, 0.6, 0.6),\n        # Case 4: D=100000, T=800 K, eps_f=0.8 eV, mu=0.3 eV\n        (100000, 800.0, 0.8, 0.3),\n        # Case 5: D=50, T=400 K, eps_f=0.2 eV, mu=0.35 eV\n        (50, 400.0, 0.2, 0.35),\n    ]\n\n    results = []\n    for D, T, eps_f, mu in test_cases:\n        # Part 1: Grand Canonical (GC) calculations\n        beta = 1.0 / (k_B * T)\n        z = np.exp(beta * (mu - eps_f))\n        \n        # omega: grand potential per site\n        omega = -k_B * T * np.log(1 + z)\n\n        # Part 3/4: Determine n_star for canonical calculation\n        n_mean = D * z / (1.0 + z)\n        # n_star: integer closest to the mean defect number, clamped to [0, D]\n        n_star = int(np.round(n_mean))\n        n_star = max(0, min(D, n_star))\n\n        # Part 2: Canonical (C) calculations at n_star\n        # f_per_site: Helmholtz free energy per site\n        if n_star == 0 or n_star == D:\n            ln_comb = 0.0\n        else:\n            # Numerically stable log of binomial coefficient using log-gamma\n            ln_comb = gammaln(D + 1) - gammaln(n_star + 1) - gammaln(D - n_star + 1)\n        \n        f_per_site = (n_star * eps_f / D) - (k_B * T / D) * ln_comb\n        \n        # phi_D_n_star: Legendre-transformed canonical quantity\n        phi_D_n_star = f_per_site - mu * (n_star / D)\n        \n        # Part 4: Final quantities\n        # delta: absolute discrepancy per site\n        delta = np.abs(omega - phi_D_n_star)\n        \n        # delta_x: standard deviation of defect fraction in GC ensemble\n        x_mean = z / (1.0 + z)\n        var_n_over_D_sq = (x_mean * (1.0 - x_mean)) / D\n        delta_x = np.sqrt(var_n_over_D_sq)\n\n        results.append([omega, phi_D_n_star, delta, delta_x])\n\n    # Format the final output string as specified\n    inner_strings = [f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3489860"}]}