{"hands_on_practices": [{"introduction": "本练习是固态物理学的基石，我们将在此应用拉格朗日形式主义分析一维双原子晶格。该模型是理解诸如氯化钠（NaCl）等晶体中振动模式的基础。通过推导色散关系，您将亲眼见证声学和光学声子支的概念如何从第一性原理中自然产生，从而在抽象的分析力学与材料的实际属性之间建立起关键的联系。", "problem": "考虑一个一维中心对称双原子链，该模型用于模拟与计算材料科学相关的离子晶体中的纵向晶格振动。该链由两种原子周期性交替排列组成，其质量分别为 $m_{1}$ 和 $m_{2}$。最近邻原子由刚度为 $K$ 的相同谐振子弹簧耦合。相邻原子间的平衡间距为 $a/2$，因此长度为 $a$ 的原胞包含两个原子。设 $u_{n}(t)$ 表示第 $n$ 个原胞中质量为 $m_{1}$ 的原子偏离其平衡位置的微小纵向位移，设 $v_{n}(t)$ 表示同一原胞中质量为 $m_{2}$ 的原子的相应位移。\n\n使用小振动的拉格朗日形式，并假设仅存在最近邻谐振相互作用，推导 $u_{n}(t)$ 和 $v_{n}(t)$ 的线性运动方程，并通过寻找具有布洛赫形式的简正模解来获得色散关系，其特征是波矢 $k$ 位于第一布里渊区 $[-\\pi/a,\\pi/a]$。从第一性原理出发，辨别声学支和光学支。在您的推理中，从该链的拉格朗日量 $L = T - V$ 的基本定义开始，写出以 $\\{u_{n},v_{n}\\}$ 表示的动能和势能，并应用欧拉-拉格朗日方程来获得产生色散关系的本征值问题。通过考察长波极限，简要论证哪个符号对应于声学支与光学支，并评论在布里渊区中心 $k=0$ 和边界 $k=\\pi/a$ 处的行为。\n\n请提供两个解析色散关系 $\\omega_{\\mathrm{ac}}(k)$ 和 $\\omega_{\\mathrm{op}}(k)$ 作为最终答案，以 $k$、$a$、$m_{1}$、$m_{2}$ 和 $K$ 的显式闭合形式表达式给出。将您的最终结果表示为两个关于 $k$ 的函数，不带任何单位。无需进行数值计算。", "solution": "用户要求我解决一个经典的固态物理问题：推导一维双原子晶格的色散关系。\n\n这是我的计划：\n1.  **验证问题：**\n    *   **步骤1：提取已知条件：** 我将列出所有给定的参数和定义：\n        *   一维中心对称双原子链。\n        *   质量：$m_1$ 和 $m_2$。\n        *   最近邻耦合：刚度为 $K$ 的谐振子弹簧。\n        *   平衡间距：$a/2$。\n        *   原胞长度：$a$。\n        *   第 $n$ 个原胞中质量 $m_1$ 的位移：$u_n(t)$。\n        *   第 $n$ 个原胞中质量 $m_2$ 的位移：$v_n(t)$。\n        *   任务：使用拉格朗日形式 ($L=T-V$) 求运动方程。\n        *   任务：寻找具有布洛赫形式的简正模解，其波矢 $k$ 位于第一布里渊区 $[-\\pi/a, \\pi/a]$。\n        *   任务：推导色散关系 $\\omega(k)$。\n        *   任务：辨别声学支和光学支。\n        *   任务：通过考察长波极限 ($k \\to 0$) 以及在 $k=0$ 和 $k=\\pi/a$ 处的行为进行论证。\n        *   最终答案：$\\omega_{\\mathrm{ac}}(k)$ 和 $\\omega_{\\mathrm{op}}(k)$ 的显式闭合形式表达式。\n\n    *   **步骤2：验证：** 我需要根据我的验证标准来检查问题。\n        *   **科学依据：** 是的，这是固态物理和材料科学中的一个标准的、基本的问题。它是晶格动力学的一个教科书级例子。\n        *   **适定性：** 是的，问题定义清晰。它指明了模型、方法（拉格朗日）和期望的输出。存在唯一解。\n        *   **客观性：** 是的，语言精确且技术性强。没有主观成分。\n        *   **其他缺陷：**\n            *   **科学谬误：** 无。该模型是一个公认的物理近似。\n            *   **无法形式化/不相关：** 该问题高度可形式化，并与所述的计算材料科学中的分析力学主题直接相关。\n            *   **不完整/矛盾：** 设置是完整的。所有必要的参数（$m_1, m_2, K, a$）和变量（$u_n, v_n$）都已定义。\n            *   **不切实际/不可行：** 该模型是一种理想化，但它是一个标准的、具有物理意义的模型。\n            *   **不适定/结构不良：** 结构清晰，能够导出一个唯一解。\n            *   **伪深刻/琐碎：** 这是一个非凡的、经典的问题，需要对力学和波物理学有扎实的理解。\n            *   **外部可验证性：** 结果是标准的，并且可以验证。\n\n    *   **步骤3：结论：** 问题是**有效的**。我将继续解答。\n\n2.  **解决问题：**\n    *   **步骤1：定义系统和坐标。**\n        *   原子位于平衡位置。\n        *   在原胞 $n$ 中，质量 $m_1$ 位于 $x_{n,1}^{(0)} = na$。\n        *   在原胞 $n$ 中，质量 $m_2$ 位于 $x_{n,2}^{(0)} = na + a/2$。\n        *   位移分别是原胞 $n$ 中 $m_1$ 的 $u_n(t)$ 和 $m_2$ 的 $v_n(t)$。\n        *   实际位置是：\n            *   $x_{n,1}(t) = na + u_n(t)$\n            *   $x_{n,2}(t) = na + a/2 + v_n(t)$\n\n    *   **步骤2：写出拉格朗日量 $L = T - V$。**\n        *   **动能 (T)：** 链中所有原子的动能之和。我们可以考虑每个原胞的动能，然后对所有 $n$ 求和。\n            *   $T = \\sum_n \\left( \\frac{1}{2} m_1 \\dot{u}_n^2 + \\frac{1}{2} m_2 \\dot{v}_n^2 \\right)$\n        *   **势能 (V)：** 储存在弹簧中的势能之和。每个弹簧连接两个相邻的原子。我们需要小心处理索引。\n            *   我们来考虑原胞*内部*和*之间*的弹簧。\n            *   原胞 $n-1$ 的质量 $m_2$ 与原胞 $n$ 的质量 $m_1$ 之间的弹簧。\n                *   原胞 $n-1$ 中 $m_2$ 的平衡位置：$(n-1)a + a/2$。\n                *   原胞 $n$ 中 $m_1$ 的平衡位置：$na$。\n                *   平衡间距：$na - ((n-1)a + a/2) = a/2$。\n                *   原胞 $n-1$ 中 $m_2$ 的实际位置：$(n-1)a + a/2 + v_{n-1}$。\n                *   原胞 $n$ 中 $m_1$ 的实际位置：$na + u_n$。\n                *   此弹簧的伸长量：$(na + u_n) - ((n-1)a + a/2 + v_{n-1}) - a/2 = u_n - v_{n-1}$。\n                *   势能：$\\frac{1}{2} K (u_n - v_{n-1})^2$。\n            *   原胞 $n$ 的质量 $m_1$ 与原胞 $n$ 的质量 $m_2$ 之间的弹簧。\n                *   平衡间距：$a/2$。\n                *   实际位置：$na + u_n$ 和 $na + a/2 + v_n$。\n                *   此弹簧的伸长量：$(na + a/2 + v_n) - (na + u_n) - a/2 = v_n - u_n$。\n                *   势能：$\\frac{1}{2} K (v_n - u_n)^2$。\n            *   总势能是所有这些弹簧的能量之和。等等，如果我这样求和，会重复计算。让我们更精确一些。让我们对弹簧求和。\n            *   $V = \\sum_n \\left( \\frac{1}{2} K (v_n - u_n)^2 + \\frac{1}{2} K (u_{n+1} - v_n)^2 \\right)$。这样写更好。连接到质量 $v_n$ 的两个弹簧分别在其左侧（与 $u_n$ 相连）和右侧（与 $u_{n+1}$ 相连）。\n            *   所以，$V = \\frac{1}{2} K \\sum_n \\left( (v_n - u_n)^2 + (u_{n+1} - v_n)^2 \\right)$。这看起来是正确的。它是链中所有弹簧的势能之和。\n\n        *   **拉格朗日量 (L)：**\n            *   $L = T - V = \\sum_n \\left[ \\frac{1}{2} m_1 \\dot{u}_n^2 + \\frac{1}{2} m_2 \\dot{v}_n^2 - \\frac{1}{2} K (v_n - u_n)^2 - \\frac{1}{2} K (u_{n+1} - v_n)^2 \\right]$。\n\n    *   **步骤3：应用欧拉-拉格朗日方程。**\n        *   方程为：\n            *   $\\frac{d}{dt} \\left( \\frac{\\partial L}{\\partial \\dot{u}_n} \\right) - \\frac{\\partial L}{\\partial u_n} = 0$\n            *   $\\frac{d}{dt} \\left( \\frac{\\partial L}{\\partial \\dot{v}_n} \\right) - \\frac{\\partial L}{\\partial v_n} = 0$\n\n        *   **对于 $u_n$:**\n            *   $\\frac{\\partial L}{\\partial \\dot{u}_n} = m_1 \\dot{u}_n$\n            *   $\\frac{d}{dt} \\left( \\frac{\\partial L}{\\partial \\dot{u}_n} \\right) = m_1 \\ddot{u}_n$\n            *   $\\frac{\\partial L}{\\partial u_n}$ 来自 $V$ 的求和中的三项。含 $(v_n - u_n)^2$ 的项和含 $(u_n - v_{n-1})^2$ 的项。让我们使用我的第二种V的形式：$V = \\frac{1}{2} K \\sum_j \\left( (v_j - u_j)^2 + (u_{j+1} - v_j)^2 \\right)$。\n            *   $L$ 中包含 $u_n$ 的项是：$-\\frac{1}{2}K(v_n-u_n)^2$ 和 $-\\frac{1}{2}K(u_n - v_{n-1})^2$。第二项来自 $V$ 的求和中 $j=n-1$ 的项，它包含 $(u_{n} - v_{n-1})^2$。\n            *   $\\frac{\\partial L}{\\partial u_n} = - \\frac{1}{2} K \\frac{\\partial}{\\partial u_n} (v_n - u_n)^2 - \\frac{1}{2} K \\frac{\\partial}{\\partial u_n} (u_n - v_{n-1})^2$\n            *   $\\frac{\\partial L}{\\partial u_n} = -K(v_n - u_n)(-1) - K(u_n - v_{n-1})(1) = K(v_n - u_n) - K(u_n - v_{n-1}) = K(v_n + v_{n-1} - 2u_n)$。\n            *   所以，第一个运动方程是：$m_1 \\ddot{u}_n = K (v_n + v_{n-1} - 2u_n)$。\n\n        *   **对于 $v_n$:**\n            *   $\\frac{\\partial L}{\\partial \\dot{v}_n} = m_2 \\dot{v}_n$\n            *   $\\frac{d}{dt} \\left( \\frac{\\partial L}{\\partial \\dot{v}_n} \\right) = m_2 \\ddot{v}_n$\n            *   $L$ 中包含 $v_n$ 的项是：$-\\frac{1}{2}K(v_n-u_n)^2$ 和 $-\\frac{1}{2}K(u_{n+1} - v_n)^2$。\n            *   $\\frac{\\partial L}{\\partial v_n} = - \\frac{1}{2} K \\frac{\\partial}{\\partial v_n} (v_n - u_n)^2 - \\frac{1}{2} K \\frac{\\partial}{\\partial v_n} (u_{n+1} - v_n)^2$\n            *   $\\frac{\\partial L}{\\partial v_n} = -K(v_n - u_n)(1) - K(u_{n+1} - v_n)(-1) = -K(v_n - u_n) + K(u_{n+1} - v_n) = K(u_n + u_{n+1} - 2v_n)$。\n            *   所以，第二个运动方程是：$m_2 \\ddot{v}_n = K (u_{n+1} + u_n - 2v_n)$。\n\n        *   运动方程：\n            *   $m_1 \\ddot{u}_n = K(v_n + v_{n-1} - 2u_n)$\n            *   $m_2 \\ddot{v}_n = K(u_{n+1} + u_n - 2v_n)$\n        *   这看起来是正确的。这是一个耦合的微分-差分方程组。\n\n    *   **步骤4：寻找简正模解。**\n        *   由于晶格的周期性，我们假设一个平面波解（布洛赫形式）。原胞 $n$ 中的位移通过一个相位因子与原胞 $0$ 中的位移相关联。原胞 $n$ 的平衡位置是 $na$。\n        *   $u_n(t) = U \\exp[i(k(na) - \\omega t)]$\n        *   $v_n(t) = V \\exp[i(k(na+a/2) - \\omega t)]$。不，问题陈述将 $u_n$ 和 $v_n$ 定义为属于*同一个*原胞 $n$。相位应取决于原胞指数。\n        *   正确的试探解形式：\n            *   $u_n(t) = U \\exp[i(kna - \\omega t)]$\n            *   $v_n(t) = V \\exp[i(kna - \\omega t)]$\n            *   $U$ 和 $V$ 是原胞中两个原子的复振幅。位置依赖性由原胞指数 $n$ 正确地捕捉。\n\n        *   让我们计算时间导数和位移项：\n            *   $\\ddot{u}_n = -\\omega^2 u_n = -\\omega^2 U \\exp[i(kna - \\omega t)]$\n            *   $\\ddot{v}_n = -\\omega^2 v_n = -\\omega^2 V \\exp[i(kna - \\omega t)]$\n            *   $v_{n-1} = V \\exp[i(k(n-1)a - \\omega t)] = V \\exp[i(kna - \\omega t)] \\exp[-ika] = v_n \\exp[-ika]$。\n            *   $u_{n+1} = U \\exp[i(k(n+1)a - \\omega t)] = U \\exp[i(kna - \\omega t)] \\exp[ika] = u_n \\exp[ika]$。\n\n        *   将这些代入运动方程：\n            *   $-m_1 \\omega^2 U \\exp[i(kna - \\omega t)] = K(V \\exp[i(kna - \\omega t)] + V \\exp[i(kna - \\omega t)]\\exp[-ika] - 2U \\exp[i(kna - \\omega t)])$\n            *   $-m_2 \\omega^2 V \\exp[i(kna - \\omega t)] = K(U \\exp[i(kna - \\omega t)]\\exp[ika] + U \\exp[i(kna - \\omega t)] - 2V \\exp[i(kna - \\omega t)])$\n\n        *   消去两边的公因子 $\\exp[i(kna - \\omega t)]$：\n            *   $-m_1 \\omega^2 U = K(V (1 + \\exp[-ika]) - 2U)$\n            *   $-m_2 \\omega^2 V = K(U (1 + \\exp[ika]) - 2V)$\n\n        *   重新排列成关于振幅 $(U, V)$ 的矩阵方程：\n            *   $(2K - m_1 \\omega^2) U - K(1 + \\exp[-ika]) V = 0$\n            *   $-K(1 + \\exp[ika]) U + (2K - m_2 \\omega^2) V = 0$\n\n        *   这是一个 $M \\begin{pmatrix} U \\\\ V \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 形式的齐次线性方程组。为了得到非平凡解 $(U, V) \\neq (0, 0)$，系数矩阵的行列式必须为零。\n        *   $\\det \\begin{pmatrix} 2K - m_1 \\omega^2  -K(1 + \\exp[-ika]) \\\\ -K(1 + \\exp[ika])  2K - m_2 \\omega^2 \\end{pmatrix} = 0$\n\n    *   **步骤5：求解行列式方程（久期方程）。**\n        *   $(2K - m_1 \\omega^2)(2K - m_2 \\omega^2) - K^2(1 + \\exp[-ika])(1 + \\exp[ika]) = 0$\n        *   让我们展开这些项：\n            *   第二项是 $K^2 (1 + \\exp[ika] + \\exp[-ika] + \\exp[ika]\\exp[-ika])$。\n            *   使用 $\\exp[ika] + \\exp[-ika] = 2\\cos(ka)$，它变为 $K^2 (1 + 2\\cos(ka) + 1) = K^2(2 + 2\\cos(ka)) = 2K^2(1 + \\cos(ka))$。\n            *   使用半角恒等式 $1 + \\cos(2\\theta) = 2\\cos^2(\\theta)$，我们有 $1 + \\cos(ka) = 2\\cos^2(ka/2)$。\n            *   所以，该项是 $2K^2(2\\cos^2(ka/2)) = 4K^2\\cos^2(ka/2)$。\n            *   啊哈，也许可以直接检查乘积：$(1 + \\exp[-ika])(1 + \\exp[ika]) = |\\exp[-ika/2](\\exp[ika/2] + \\exp[-ika/2])|^2 = |\\exp[-ika/2](2\\cos(ka/2))|^2 = (2\\cos(ka/2))^2 = 4\\cos^2(ka/2)$。这简化了问题。\n            *   等等，$(1+e^{-i\\theta})(1+e^{i\\theta}) = 1+e^{i\\theta}+e^{-i\\theta}+1 = 2+2\\cos\\theta$。\n            *   $2+2\\cos(ka) = 2(1+\\cos(ka)) = 2(2\\cos^2(ka/2)) = 4\\cos^2(ka/2)$。是的，这没错。\n\n        *   久期方程为：\n            *   $(2K - m_1 \\omega^2)(2K - m_2 \\omega^2) - 4K^2 \\cos^2(ka/2) = 0$\n\n        *   展开第一部分：\n            *   $4K^2 - 2K(m_1+m_2)\\omega^2 + m_1 m_2 \\omega^4 - 4K^2 \\cos^2(ka/2) = 0$\n\n        *   重新排列为关于 $\\omega^2$ 的二次方程：\n            *   $m_1 m_2 (\\omega^2)^2 - 2K(m_1+m_2)\\omega^2 + 4K^2 - 4K^2 \\cos^2(ka/2) = 0$\n            *   $m_1 m_2 (\\omega^2)^2 - 2K(m_1+m_2)\\omega^2 + 4K^2 (1 - \\cos^2(ka/2)) = 0$\n            *   使用 $1 - \\cos^2(x) = \\sin^2(x)$:\n            *   $m_1 m_2 (\\omega^2)^2 - 2K(m_1+m_2)\\omega^2 + 4K^2 \\sin^2(ka/2) = 0$\n\n        *   设 $x = \\omega^2$。该方程为 $Ax^2 + Bx + C = 0$，其中：\n            *   $A = m_1 m_2$\n            *   $B = -2K(m_1+m_2)$\n            *   $C = 4K^2 \\sin^2(ka/2)$\n\n        *   解为 $x = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$：\n            *   $\\omega^2 = \\frac{2K(m_1+m_2) \\pm \\sqrt{(-2K(m_1+m_2))^2 - 4(m_1 m_2)(4K^2 \\sin^2(ka/2))}}{2 m_1 m_2}$\n            *   $\\omega^2 = \\frac{2K(m_1+m_2) \\pm \\sqrt{4K^2(m_1+m_2)^2 - 16 K^2 m_1 m_2 \\sin^2(ka/2)}}{2 m_1 m_2}$\n            *   从平方根中提出 $4K^2$：\n            *   $\\omega^2 = \\frac{2K(m_1+m_2) \\pm 2K \\sqrt{(m_1+m_2)^2 - 4 m_1 m_2 \\sin^2(ka/2)}}{2 m_1 m_2}$\n            *   $\\omega^2 = \\frac{K(m_1+m_2) \\pm K \\sqrt{m_1^2 + 2m_1m_2 + m_2^2 - 4 m_1 m_2 \\sin^2(ka/2)}}{m_1 m_2}$\n            *   这是解的一种形式。让我们尝试简化平方根下的项。它似乎不能进一步漂亮地简化。\n            *   让我们与一个已知形式进行核对。通常的形式是 $\\omega^2 = K( \\frac{1}{m_1} + \\frac{1}{m_2} ) \\pm K \\sqrt{ ( \\frac{1}{m_1} + \\frac{1}{m_2} )^2 - \\frac{4\\sin^2(ka/2)}{m_1 m_2} }$。\n            *   让我将我的表达式除以 $m_1 m_2$：\n            *   $\\omega^2 = \\frac{K(m_1+m_2)}{m_1 m_2} \\pm \\frac{K}{m_1 m_2} \\sqrt{(m_1+m_2)^2 - 4 m_1 m_2 \\sin^2(ka/2)}$\n            *   $\\omega^2 = K(\\frac{1}{m_2} + \\frac{1}{m_1}) \\pm K \\sqrt{\\frac{(m_1+m_2)^2}{(m_1 m_2)^2} - \\frac{4 m_1 m_2 \\sin^2(ka/2)}{(m_1 m_2)^2}}$\n            *   $\\omega^2 = K(\\frac{1}{m_1} + \\frac{1}{m_2}) \\pm K \\sqrt{(\\frac{m_1+m_2}{m_1 m_2})^2 - \\frac{4 \\sin^2(ka/2)}{m_1 m_2}}$\n            *   $\\omega^2 = K(\\frac{1}{m_1} + \\frac{1}{m_2}) \\pm K \\sqrt{(\\frac{1}{m_1} + \\frac{1}{m_2})^2 - \\frac{4 \\sin^2(ka/2)}{m_1 m_2}}$\n            *   这与标准形式相符。推导是正确的。\n\n    *   **步骤6：辨别声学支和光学支。**\n        *   这两个解对应于 $\\omega^2$ 表达式中的正号和负号。\n        *   让我们分析长波极限，即 $k \\to 0$。在此极限下，$\\sin(ka/2) \\approx ka/2$。\n        *   项 $\\frac{4 \\sin^2(ka/2)}{m_1 m_2} \\approx \\frac{4 (ka/2)^2}{m_1 m_2} = \\frac{k^2 a^2}{m_1 m_2}$。此项很小。\n        *   表达式变为：$\\omega^2 \\approx K(\\frac{1}{m_1} + \\frac{1}{m_2}) \\pm K \\sqrt{(\\frac{1}{m_1} + \\frac{1}{m_2})^2 - \\frac{k^2 a^2}{m_1 m_2}}$。\n        *   让我们使用近似 $\\sqrt{A^2 - \\epsilon} = A \\sqrt{1 - \\epsilon/A^2} \\approx A(1 - \\epsilon/(2A^2)) = A - \\epsilon/(2A)$。\n        *   这里 $A = (\\frac{1}{m_1} + \\frac{1}{m_2})$ 且 $\\epsilon = \\frac{k^2 a^2}{m_1 m_2}$。\n        *   所以，$\\sqrt{(\\frac{1}{m_1} + \\frac{1}{m_2})^2 - \\frac{k^2 a^2}{m_1 m_2}} \\approx (\\frac{1}{m_1} + \\frac{1}{m_2}) - \\frac{k^2 a^2 / (m_1 m_2)}{2(\\frac{1}{m_1} + \\frac{1}{m_2})}$。\n\n        *   **情况1：正号（光学支）**\n            *   $\\omega^2_{\\mathrm{op}} \\approx K(\\frac{1}{m_1} + \\frac{1}{m_2}) + K \\left[ (\\frac{1}{m_1} + \\frac{1}{m_2}) - \\dots \\right]$。\n            *   让我们在 $k=0$ 处精确计算。此时 $\\sin(ka/2) = 0$。\n            *   $\\omega^2(k=0) = K(\\frac{1}{m_1} + \\frac{1}{m_2}) \\pm K \\sqrt{(\\frac{1}{m_1} + \\frac{1}{m_2})^2} = K(\\frac{1}{m_1} + \\frac{1}{m_2}) \\pm K(\\frac{1}{m_1} + \\frac{1}{m_2})$。\n            *   正号：$\\omega^2_{\\mathrm{op}}(k=0) = 2K(\\frac{1}{m_1} + \\frac{1}{m_2}) = 2K \\frac{m_1+m_2}{m_1 m_2}$。这是一个非零频率。这对应于**光学支**。\n                *   对于光学支，在 $k=0$ 时，我们来考察其运动。运动方程变为：\n                    * $(2K - m_1 \\omega^2) U - 2K V = 0$\n                    * $-2K U + (2K - m_2 \\omega^2) V = 0$\n                * 代入 $\\omega^2 = \\omega^2_{\\mathrm{op}}(0)$:\n                    * $(2K - m_1 [2K(\\frac{1}{m_1} + \\frac{1}{m_2})]) U - 2K V = 0$\n                    * $(2K - 2K - 2K\\frac{m_1}{m_2}) U - 2K V = 0$\n                    * $-2K\\frac{m_1}{m_2} U - 2K V = 0 \\Rightarrow m_1 U = -m_2 V$。\n                * 这意味着原胞中的两个原子向相反方向运动。原胞的质心 $m_1 U + m_2 V$ 是静止的。这是光学模式的特征。如果原子带电（如问题所述的离子晶体），它可被电场（光）激发。\n\n        *   **情况2：负号（声学支）**\n            *   在 $k=0$ 时的负号：$\\omega^2_{\\mathrm{ac}}(k=0) = K(\\frac{1}{m_1} + \\frac{1}{m_2}) - K(\\frac{1}{m_1} + \\frac{1}{m_2}) = 0$。所以 $\\omega_{\\mathrm{ac}}(0)=0$。这是**声学支**的特征。\n            *   让我们求 $k=0$ 处的斜率。对于小 $k$：\n            *   $\\omega^2_{\\mathrm{ac}} \\approx K(\\frac{1}{m_1} + \\frac{1}{m_2}) - K \\left[ (\\frac{1}{m_1} + \\frac{1}{m_2}) - \\frac{k^2 a^2 / (m_1 m_2)}{2(\\frac{1}{m_1} + \\frac{1}{m_2})} \\right]$\n            *   $\\omega^2_{\\mathrm{ac}} \\approx K \\frac{k^2 a^2 / (m_1 m_2)}{2(\\frac{m_1+m_2}{m_1 m_2})} = K \\frac{k^2 a^2}{2(m_1+m_2)}$\n            *   $\\omega_{\\mathrm{ac}}(k) \\approx \\sqrt{\\frac{K a^2}{2(m_1+m_2)}} |k|$。\n            *   对于小 $k$ 值，这是一个线性色散关系 $\\omega = v_s |k|$，其中 $v_s$ 是声速。这证实了它是声学支。在长波长下，原胞中的原子同相运动。\n            *   我们来检查 $k=0$ 时的运动。方程为 $(2K - m_1 \\omega^2) U - 2K V = 0$。当 $\\omega=0$ 时，变为 $2K U - 2K V = 0$，即 $U=V$。原胞中的两个原子一起移动，这对应于晶体的整体平移。对于 $k \\to 0$，$U \\approx V$，所以相邻原胞也几乎同相移动。这是一种长波长的声波。\n\n    *   **论证总结：**\n        *   当 $k \\to 0$ 时 $\\omega \\to 0$ 的分支是声学支。它描述了类似于声波的长波长振动，其中原胞中的原子同相运动。这对应于 $\\omega^2$ 解中的负号。\n        *   在 $k=0$ 时 $\\omega$ 为有限非零值的的分支是光学支。它描述了两个子晶格（$m_1$ 型和 $m_2$ 型原子）彼此反向振荡的振动。这对应于正号。\n\n    *   **步骤7：在布里渊区边界（$k = \\pi/a$）的行为。**\n        *   在 $k = \\pi/a$ 时，我们有 $ka = \\pi$，所以 $ka/2 = \\pi/2$。\n        *   $\\sin(ka/2) = \\sin(\\pi/2) = 1$。\n        *   久期方程中的项 $4K^2 \\sin^2(ka/2)$ 变为 $4K^2$。\n        *   二次方程为 $m_1 m_2 (\\omega^2)^2 - 2K(m_1+m_2)\\omega^2 + 4K^2 = 0$。\n        *   让我们解出 $\\omega^2$。\n        *   $\\omega^2 = \\frac{2K(m_1+m_2) \\pm \\sqrt{4K^2(m_1+m_2)^2 - 16K^2 m_1 m_2}}{2m_1 m_2}$\n        *   $\\omega^2 = \\frac{K(m_1+m_2) \\pm K \\sqrt{(m_1+m_2)^2 - 4m_1 m_2}}{m_1 m_2}$\n        *   $\\omega^2 = \\frac{K(m_1+m_2) \\pm K \\sqrt{m_1^2 + 2m_1m_2 + m_2^2 - 4m_1 m_2}}{m_1 m_2}$\n        *   $\\omega^2 = \\frac{K(m_1+m_2) \\pm K \\sqrt{(m_1-m_2)^2}}{m_1 m_2} = \\frac{K(m_1+m_2) \\pm K |m_1-m_2|}{m_1 m_2}$。\n\n        *   不失一般性，假设 $m_1  m_2$。则 $|m_1-m_2| = m_1-m_2$。\n        *   两个频率为：\n            *   $\\omega^2_{\\mathrm{op}}(\\pi/a) = \\frac{K(m_1+m_2) + K(m_1-m_2)}{m_1 m_2} = \\frac{2Km_1}{m_1 m_2} = \\frac{2K}{m_2}$。\n            *   $\\omega^2_{\\mathrm{ac}}(\\pi/a) = \\frac{K(m_1+m_2) - K(m_1-m_2)}{m_1 m_2} = \\frac{2Km_2}{m_1 m_2} = \\frac{2K}{m_1}$。\n        *   在布里渊区边界，较高的频率（光学支）对应于较轻质量（此例中为 $m_2$）的振动，而较低的频率（声学支）对应于较重质量（此例中为 $m_1$）的振动。这在物理上是合理的：在 $k=\\pi/a$ 时，相邻原胞之间的相位差为 $\\exp(i\\pi)=-1$。对于声学模式（较低能量），较重的原子振动而较轻的原子静止。对于光学模式（较高能量），较轻的原子振动而较重的原子静止。让我们从运动方程中验证这一点。\n        * 在 $k=\\pi/a$ 时，$1+e^{-i\\pi} = 1-1=0$，且 $1+e^{i\\pi}=1-1=0$。\n        * 运动方程解耦了！\n            * $(2K - m_1 \\omega^2) U = 0$\n            * $(2K - m_2 \\omega^2) V = 0$\n        * 这给出了两个独立的解：\n            * 解1：$U \\ne 0, V = 0$。则 $\\omega^2 = 2K/m_1$。\n            * 解2：$U = 0, V \\ne 0$。则 $\\omega^2 = 2K/m_2$。\n        * 频率为 $\\omega = \\sqrt{2K/m_1}$ 的解对应于 $m_1$ 原子子晶格振动，而 $m_2$ 子晶格静止。\n        * 频率为 $\\omega = \\sqrt{2K/m_2}$ 的解对应于 $m_2$ 原子子晶格振动，而 $m_1$ 子晶格静止。\n        * 较高的频率属于光学支，较低的频率属于声学支。\n        * 所以如果 $m_1  m_2$，那么 $2K/m_1  2K/m_2$。\n        * $\\omega^2_{\\text{ac}}(\\pi/a) = 2K/m_1$ （较重质量振动）。\n        * $\\omega^2_{\\text{op}}(\\pi/a) = 2K/m_2$ （较轻质量振动）。\n        * 这与完整解的结果相符。逻辑是合理的。\n\n    *   **最终答案的构建：**\n        *   问题要求给出 $\\omega_{\\mathrm{ac}}(k)$ 和 $\\omega_{\\mathrm{op}}(k)$。\n        *   我推导出了 $\\omega^2$。我需要取平方根。\n        *   $\\omega^2_{\\pm} = K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) \\pm K\\sqrt{\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)^2 - \\frac{4\\sin^2(ka/2)}{m_1 m_2}}$。\n        *   光学支对应于正号：\n            *   $\\omega_{\\mathrm{op}}(k) = \\sqrt{K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) + K\\sqrt{\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)^2 - \\frac{4\\sin^2(ka/2)}{m_1 m_2}}}$\n        *   声学支对应于负号：\n            *   $\\omega_{\\mathrm{ac}}(k) = \\sqrt{K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) - K\\sqrt{\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)^2 - \\frac{4\\sin^2(ka/2)}{m_1 m_2}}}$\n        *   这是最终的解析表达式。需要根据规则用 LaTeX 书写。\n\n    *   **推理和步骤回顾：**\n        1.  **拉格朗日量:** $L = T - V$。\n            *   $T = \\sum_n (\\frac{1}{2}m_1\\dot{u}_n^2 + \\frac{1}{2}m_2\\dot{v}_n^2)$。正确。\n            *   $V = \\frac{1}{2}K \\sum_n ((v_n-u_n)^2 + (u_{n+1}-v_n)^2)$。正确。\n        2.  **欧拉-拉格朗日方程:**\n            *   $m_1 \\ddot{u}_n = K (v_n + v_{n-1} - 2u_n)$。我的推导是 $m_1 \\ddot{u}_n = K(v_n - u_n) - K(u_n - v_{n-1}) = K(v_n+v_{n-1}-2u_n)$。看起来正确。我们直接用力来检查。在 $na$ 处的 $m_1$ 受到的力来自于 $na+a/2-a=na-a/2$ 处的 $m_2$（即 $v_{n-1}$）和 $na+a/2$ 处的 $m_2$（即 $v_n$）。不，这不对。平衡位置是 $m_1$ 在 $na$，$m_2$ 在 $na+a/2$。$u_n$ 的相互作用近邻是 $v_{n-1}$ 和 $v_n$。\n            *   我们直接用力来检查。作用在原胞 $n$ 中 $m_1$ 上的力：\n                *   右侧弹簧（与原胞 $n$ 的 $m_2$ 相连）：$F_{\\text{right}} = K((x_{n,2}-x_{n,1})-a/2) = K((na+a/2+v_n)-(na+u_n)-a/2) = K(v_n-u_n)$。\n                *   左侧弹簧（与原胞 $n-1$ 的 $m_2$ 相连）：原胞 $n-1$ 中 $m_2$ 的平衡位置是 $(n-1)a+a/2$。所以其位置是 $(n-1)a+a/2+v_{n-1}$。\n                *   $F_{\\text{left}} = -K( (x_{n,1}-x_{n-1,2}) - a/2) = -K( (na+u_n) - ((n-1)a+a/2+v_{n-1}) - a/2) = -K(u_n - v_{n-1})$。\n                *   总力：$m_1 \\ddot{u}_n = F_{\\text{right}} + F_{\\text{left}} = K(v_n-u_n) - K(u_n-v_{n-1}) = K(v_n+v_{n-1}-2u_n)$。这证实了从拉格朗日量推导的运动方程。\n            *   $m_2 \\ddot{v}_n = K (u_{n+1} + u_n - 2v_n)$。\n                *   作用在原胞 $n$ 中 $m_2$ 上的力：近邻是原胞 $n$ 的 $m_1$ 和原胞 $n+1$ 的 $m_1$。\n                *   左侧弹簧（与原胞 $n$ 的 $m_1$ 相连）：$F_{\\text{left}} = -K((x_{n,2}-x_{n,1})-a/2) = -K(v_n-u_n)$。\n                *   右侧弹簧（与原胞 $n+1$ 的 $m_1$ 相连）：原胞 $n+1$ 中 $m_1$ 的平衡位置是 $(n+1)a$。位置是 $(n+1)a+u_{n+1}$。\n                *   $F_{\\text{right}} = K((x_{n+1,1}-x_{n,2})-a/2) = K(((n+1)a+u_{n+1})-(na+a/2+v_n)-a/2) = K(u_{n+1}-v_n)$。\n                *   总力：$m_2 \\ddot{v}_n = F_{\\text{left}} + F_{\\text{right}} = -K(v_n-u_n) + K(u_{n+1}-v_n) = K(u_{n+1}+u_n-2v_n)$。这也证实了运动方程。\n        3.  **平面波试探解:**\n            *   $u_n = U e^{i(kna-\\omega t)}$, $v_n = V e^{i(kna-\\omega t)}$。\n            *   $v_{n-1} = V e^{i(k(n-1)a-\\omega t)} = v_n e^{-ika}$。正确。\n            *   $u_{n+1} = U e^{i(k(n+1)a-\\omega t)} = u_n e^{ika}$。正确。\n        4.  **代入与特征方程:**\n            *   $-m_1 \\omega^2 U = K(V + V e^{-ika} - 2U)$\n            *   $-m_2 \\omega^2 V = K(U e^{ika} + U - 2V)$\n            *   $(2K-m_1\\omega^2)U - K(1+e^{-ika})V = 0$\n            *   $-K(1+e^{ika})U + (2K-m_2\\omega^2)V = 0$\n            *   行列式给出：$(2K-m_1\\omega^2)(2K-m_2\\omega^2) - K^2(1+e^{-ika})(1+e^{ika})=0$。\n            *   $(1+e^{-ika})(1+e^{ika}) = 2+2\\cos(ka) = 4\\cos^2(ka/2)$。正确。\n            *   推导出 $m_1 m_2 (\\omega^2)^2 - 2K(m_1+m_2)\\omega^2 + 4K^2 \\sin^2(ka/2) = 0$ 的过程是正确的。\n        5.  **二次方程求解:** 二次公式的应用和随后的简化为标准形式是正确的。\n        6.  **分支辨别:** 在 $k \\to 0$ 处的分析正确地辨别了声学支（$-$ 号，$\\omega \\to 0$）和光学支（$+$ 号，$\\omega \\to \\text{常数}$）。\n        7.  **最终表达式:** $\\omega_{\\mathrm{ac}}(k)$ 和 $\\omega_{\\mathrm{op}}(k)$ 的最终表达式是正确的。\n\n一切似乎都井然有序。我现在将按照所有格式规则来写解答。\n我必须小心LaTeX格式。所有数学实体，包括单字母变量和数字，都必须在LaTeX中。\n最终答案框必须只包含LaTeX表达式。\n最终的表达式很长。我应该仔细检查括号和平方根。\n$\\omega_{\\mathrm{ac}}(k) = \\sqrt{K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) - K\\sqrt{\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)^2 - \\frac{4}{m_1 m_2}\\sin^2\\left(\\frac{ka}{2}\\right)}}$\n$\\omega_{\\mathrm{op}}(k) = \\sqrt{K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) + K\\sqrt{\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)^2 - \\frac{4}{m_1 m_2}\\sin^2\\left(\\frac{ka}{2}\\right)}}$\n看起来不错。我必须注意不要在LaTeX中把`sin^2(x)`写成`\\sin^2(x)`，而应该是`\\sin^{2}(x)`。这是一个常见的错误。我们再检查一下规则。`x^{a+b}`。所以它应该是`\\sin^{2}(...)`。好的。\n问题陈述要求最终答案为 `\\omega_{\\mathrm{ac}}(k)` 和 `\\omega_{\\mathrm{op}}(k)`。我的两个表达式正是如此。我将它们以行向量的形式列在一个 `pmatrix` 中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\omega_{\\mathrm{ac}}(k) = \\sqrt{K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) - K\\sqrt{\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right)^{2} - \\frac{4}{m_{1}m_{2}}\\sin^{2}\\left(\\frac{ka}{2}\\right)}} \\\\\n\\omega_{\\mathrm{op}}(k) = \\sqrt{K\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right) + K\\sqrt{\\left(\\frac{1}{m_{1}} + \\frac{1}{m_{2}}\\right)^{2} - \\frac{4}{m_{1}m_{2}}\\sin^{2}\\left(\\frac{ka}{2}\\right)}}\n\\end{pmatrix}\n}\n$$", "id": "3432860"}, {"introduction": "在对耦合振子进行分析 [@problem_id:3432860] 的基础上，本练习将采用一种计算方法。您将实现一个正则变换来对角化一个通用质量弹簧系统的哈密顿量，从而有效地找到其简正模式。这是计算材料科学中计算声子谱的一种强大技术，这个动手编程练习将使辛变换的抽象概念具体化，并展示其在简化复杂动力学问题中的实用性。", "problem": "考虑一个一维合金晶格，其模型为由线性弹簧连接的有限点质量链，具有最近邻相互作用。设广义坐标为位移，收集在向量 $\\boldsymbol{x} \\in \\mathbb{R}^N$ 中，其中 $N$ 为质量点数量，并设共轭动量为 $\\boldsymbol{p} \\in \\mathbb{R}^N$。质量矩阵为对角矩阵 $\\mathbf{M} = \\mathrm{diag}(m_1, \\dots, m_N)$，其中 $m_i \\gt 0$ 的单位为千克；刚度矩阵 $\\mathbf{K} \\in \\mathbb{R}^{N \\times N}$ 为对称矩阵，由刚度为 $k$ (单位为牛顿/米) 的最近邻弹簧构建。拉格朗日量为 $L = T - V$，其中动能 $T = \\tfrac{1}{2} \\dot{\\boldsymbol{x}}^\\top \\mathbf{M} \\dot{\\boldsymbol{x}}$，势能 $V = \\tfrac{1}{2} \\boldsymbol{x}^\\top \\mathbf{K} \\boldsymbol{x}$。共轭动量为 $\\boldsymbol{p} = \\partial L / \\partial \\dot{\\boldsymbol{x}} = \\mathbf{M} \\dot{\\boldsymbol{x}}$，哈密顿量为 $H(\\boldsymbol{x}, \\boldsymbol{p}) = \\tfrac{1}{2} \\boldsymbol{p}^\\top \\mathbf{M}^{-1} \\boldsymbol{p} + \\tfrac{1}{2} \\boldsymbol{x}^\\top \\mathbf{K} \\boldsymbol{x}$。\n\n任务：从这些基本定义出发，推导并实现一个实线性正则变换（相空间上的辛映射），将哈密顿量解耦为一系列具有非负角频率的独立谐振子之和。该变换需适用于计算材料科学中的声子计算。您的实现必须：\n- 根据给定的链规范，使用自由或固定边界条件构建 $\\mathbf{M}$ 和 $\\mathbf{K}$。自由端不与墙壁连接，固定端通过刚度为 $k$ 的弹簧与墙壁连接。\n- 生成一个辛变换矩阵 $\\mathbf{S}$，将 $(\\boldsymbol{x}, \\boldsymbol{p})$ 映射到新的正则坐标 $(\\boldsymbol{Q}, \\boldsymbol{P})$。在新坐标下，哈密顿量呈现解耦的二次型 $H = \\tfrac{1}{2} \\sum_i \\left(P_i^2 + \\omega_i^2 Q_i^2\\right)$，其中 $\\omega_i \\ge 0$ 为角频率，单位为弧度/秒。\n- 通过计算与辛条件的偏差的 Frobenius 范数来验证辛性，即 $\\left\\| \\mathbf{S}^\\top \\mathbf{J} \\mathbf{S} - \\mathbf{J} \\right\\|_F$，其中 $\\mathbf{J} = \\begin{bmatrix} \\mathbf{0}  \\mathbf{I} \\\\ -\\mathbf{I}  \\mathbf{0} \\end{bmatrix}$，$\\mathbf{I}$ 是 $N \\times N$ 的单位矩阵。\n- 在变换后的坐标系中，通过计算变换后的势能度规和动能度规的非对角线元素的最大绝对值来量化解耦质量。具体来说，如果变换为 $(\\boldsymbol{Q}, \\boldsymbol{P}) = \\mathbf{S} (\\boldsymbol{x}, \\boldsymbol{p})$，则哈密顿二次型矩阵变换为 $\\mathbf{H}' = \\mathbf{S}^{-\\top} \\,\\mathrm{diag}(\\mathbf{K}, \\mathbf{M}^{-1})\\, \\mathbf{S}^{-1}$；从 $\\mathbf{H}'$ 中提取左上角的 $N \\times N$ 块（$\\boldsymbol{Q}$ 中的势能度规）和右下角的 $N \\times N$ 块（$\\boldsymbol{P}$ 中的动能度规），并报告其非对角线元素的最大绝对值。\n\n物理和数值单位：\n- 质量 $m_i$ 必须以千克为单位指定。\n- 弹簧常数 $k$ 必须以牛顿/米为单位指定。\n- 角频率 $\\omega_i$ 必须表示为实值浮点数，单位为弧度/秒。\n\n角度单位：\n- 任何角度量必须使用弧度。\n\n您的程序必须实现上述要求，并将其应用于以下测试套件。对于每个案例，按所述构建 $\\mathbf{M}$ 和 $\\mathbf{K}$，计算正则解耦，并返回指定的输出。\n\n测试套件：\n- 案例 A（包含声学零模的正常路径）：$N = 3$，质量为 $[1.0, 2.0, 1.5]$ 千克，弹簧刚度 $k = 100.0$ 牛顿/米，两端均为自由边界条件。\n- 案例 B（固定端，无零模）：$N = 3$，质量为 $[1.0, 2.0, 1.5]$ 千克，弹簧刚度 $k = 100.0$ 牛顿/米，两端均为固定边界条件（每端通过刚度为 $k$ 的弹簧与墙壁连接）。\n- 案例 C（近简并合金）：$N = 4$，质量为 $[1.0, 1.01, 0.99, 1.0]$ 千克，弹簧刚度 $k = 50.0$ 牛顿/米，两端均为固定边界条件。\n\n每个测试用例的必需输出：\n- 一个包含 $N$ 个角频率 $\\omega_i$ 的列表，按升序排列，单位为弧度/秒。\n- 一个等于 Frobenius 范数 $\\left\\| \\mathbf{S}^\\top \\mathbf{J} \\mathbf{S} - \\mathbf{J} \\right\\|_F$ 的浮点数。\n- 一个等于变换后势能度规（$\\mathbf{H}'$ 的左上块）的最大绝对非对角线项的浮点数。\n- 一个等于变换后动能度规（$\\mathbf{H}'$ 的右下块）的最大绝对非对角线项的浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起，每个测试用例对应一个形式为 $[\\text{频率}, \\text{辛误差}, \\text{最大非对角势能项}, \\text{最大非对角动能项}]$ 的子列表。例如，包含三个测试用例的输出应具有 $[[\\cdots], [\\cdots], [\\cdots]]$ 的形式，其中每个内部列表都符合指定结构。", "solution": "我们从应用于耦合质量-弹簧系统的分析力学的基本定义出发。广义坐标 $\\boldsymbol{x} \\in \\mathbb{R}^N$ 汇集了 $N$ 个质量点的位移，其质量矩阵为对角矩阵 $\\mathbf{M} = \\mathrm{diag}(m_1, \\dots, m_N)$，刚度矩阵为对称矩阵 $\\mathbf{K}$。拉格朗日量为 $L = T - V$，其中 $T = \\tfrac{1}{2} \\dot{\\boldsymbol{x}}^\\top \\mathbf{M} \\dot{\\boldsymbol{x}}$，$V = \\tfrac{1}{2} \\boldsymbol{x}^\\top \\mathbf{K} \\boldsymbol{x}$。共轭动量为 $\\boldsymbol{p} = \\partial L / \\partial \\dot{\\boldsymbol{x}} = \\mathbf{M} \\dot{\\boldsymbol{x}}$，哈密顿量为 $H(\\boldsymbol{x}, \\boldsymbol{p}) = \\tfrac{1}{2} \\boldsymbol{p}^\\top \\mathbf{M}^{-1} \\boldsymbol{p} + \\tfrac{1}{2} \\boldsymbol{x}^\\top \\mathbf{K} \\boldsymbol{x}$。\n\n我们的目标是找到一个实线性正则变换，将哈密顿量解耦为一系列非耦合谐振子之和。相空间 $\\mathbb{R}^{2N}$ 上的一个实线性正则变换由一个辛矩阵 $\\mathbf{S} \\in \\mathbb{R}^{2N \\times 2N}$ 表示，该矩阵满足 $\\mathbf{S}^\\top \\mathbf{J} \\mathbf{S} = \\mathbf{J}$，其中 $\\mathbf{J} = \\begin{bmatrix} \\mathbf{0}  \\mathbf{I} \\\\ -\\mathbf{I}  \\mathbf{0} \\end{bmatrix}$。我们寻求一个 $\\mathbf{S}$，使得在新的正则坐标 $(\\boldsymbol{Q}, \\boldsymbol{P}) = \\mathbf{S} (\\boldsymbol{x}, \\boldsymbol{p})$ 下，哈密顿量变为\n$$\nH = \\tfrac{1}{2} \\sum_{i=1}^N \\left( P_i^2 + \\omega_i^2 Q_i^2 \\right),\n$$\n其中角频率 $\\omega_i$ 为非负。\n\n基于第一性原理的构造方法：\n- 第一步（质量归一化）：通过一个正则的块对角缩放来定义质量加权坐标。考虑变换 $(\\boldsymbol{y}, \\boldsymbol{\\pi}_y) = (\\mathbf{M}^{1/2} \\boldsymbol{x}, \\mathbf{M}^{-1/2} \\boldsymbol{p})$。该变换由块对角矩阵 $\\mathbf{S}_1 = \\mathrm{diag}(\\mathbf{M}^{1/2}, \\mathbf{M}^{-1/2})$ 生成。为了验证辛性，对于一个块对角变换 $\\mathrm{diag}(\\mathbf{A}, \\mathbf{B})$，条件 $\\mathbf{S}_1^\\top \\mathbf{J} \\mathbf{S}_1 = \\mathbf{J}$ 成立的充要条件是 $\\mathbf{A}^\\top \\mathbf{B} = \\mathbf{I}$。此处 $\\mathbf{A} = \\mathbf{M}^{1/2}$ 和 $\\mathbf{B} = \\mathbf{M}^{-1/2}$ 满足 $\\mathbf{A}^\\top \\mathbf{B} = \\mathbf{M}^{1/2} \\mathbf{M}^{-1/2} = \\mathbf{I}$。在这些坐标下，哈密顿量变为\n$$\nH = \\tfrac{1}{2} \\boldsymbol{\\pi}_y^\\top \\boldsymbol{\\pi}_y + \\tfrac{1}{2} \\boldsymbol{y}^\\top \\mathbf{C} \\boldsymbol{y},\n$$\n其中 $\\mathbf{C} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$ 对于稳定系统是对称半正定矩阵。\n\n- 第二步（正交解耦）：用一个正交矩阵 $\\mathbf{O}$ 对角化 $\\mathbf{C}$，即 $\\mathbf{O}^\\top \\mathbf{C} \\mathbf{O} = \\boldsymbol{\\Omega}^2 = \\mathrm{diag}(\\omega_1^2, \\dots, \\omega_N^2)$，其中 $\\omega_i \\ge 0$。执行旋转 $(\\boldsymbol{Q}, \\boldsymbol{P}) = (\\mathbf{O}^\\top \\boldsymbol{y}, \\mathbf{O}^\\top \\boldsymbol{\\pi}_y)$。这第二个变换是辛变换，其矩阵为 $\\mathbf{S}_2 = \\mathrm{diag}(\\mathbf{O}^\\top, \\mathbf{O}^\\top)$，因为 $\\mathbf{O}$ 是正交的，并且条件 $\\mathbf{A}^\\top \\mathbf{B} = \\mathbf{I}$ 再次成立。因此，复合变换 $\\mathbf{S} = \\mathbf{S}_2 \\mathbf{S}_1$ 是辛变换，并导出解耦的哈密顿量\n$$\nH = \\tfrac{1}{2} \\boldsymbol{P}^\\top \\boldsymbol{P} + \\tfrac{1}{2} \\boldsymbol{Q}^\\top \\boldsymbol{\\Omega}^2 \\boldsymbol{Q} = \\tfrac{1}{2} \\sum_{i=1}^N \\left( P_i^2 + \\omega_i^2 Q_i^2 \\right).\n$$\n\n具体来说，将 $(\\boldsymbol{x}, \\boldsymbol{p})$ 映射到 $(\\boldsymbol{Q}, \\boldsymbol{P})$ 的完整辛映射 $\\mathbf{S}$ 是\n$$\n\\mathbf{S} = \\begin{bmatrix}\n\\mathbf{O}^\\top \\mathbf{M}^{1/2}  \\mathbf{0} \\\\\n\\mathbf{0}  \\mathbf{O}^\\top \\mathbf{M}^{-1/2}\n\\end{bmatrix},\n$$\n该映射满足 $\\mathbf{S}^\\top \\mathbf{J} \\mathbf{S} = \\mathbf{J}$，因为 $(\\mathbf{O}^\\top \\mathbf{M}^{1/2})^\\top (\\mathbf{O}^\\top \\mathbf{M}^{-1/2}) = \\mathbf{M}^{1/2} \\mathbf{O} \\mathbf{O}^\\top \\mathbf{M}^{-1/2} = \\mathbf{I}$。\n\n算法实现：\n- 为一维链构建 $\\mathbf{K}$，弹簧常数为 $k$，通过组合最近邻的贡献。对于每对相邻的 $(i, i+1)$，将 $k$ 加到对角线元素 $(i,i)$ 和 $(i+1,i+1)$ 上，将 $-k$ 加到非对角线元素 $(i,i+1)$ 和 $(i+1,i)$ 上。对于固定边界条件，将额外的 $k$ 加到 $(1,1)$ 和 $(N,N)$ 元素上，以表示连接到刚性墙壁的末端弹簧。对于自由边界条件，不添加墙壁弹簧。\n- 设置 $\\mathbf{M} = \\mathrm{diag}(m_1, \\dots, m_N)$，使用给定的质量（单位：千克）。\n- 使用质量的对角平方根形成 $\\mathbf{C} = \\mathbf{M}^{-1/2} \\mathbf{K} \\mathbf{M}^{-1/2}$。使用对称特征值求解器对角化 $\\mathbf{C}$，得到特征对 $(\\omega_i^2, \\boldsymbol{v}_i)$ 和正交特征向量矩阵 $\\mathbf{O} = [\\boldsymbol{v}_1, \\dots, \\boldsymbol{v}_N]$。将特征值按升序排序，并计算 $\\omega_i = \\sqrt{\\max(0, \\omega_i^2)}$ 以确保非负性。\n- 如上构建辛矩阵 $\\mathbf{S}$，并通过计算 Frobenius 范数 $\\left\\| \\mathbf{S}^\\top \\mathbf{J} \\mathbf{S} - \\mathbf{J} \\right\\|_F$ 来验证辛性。\n- 通过将哈密顿二次型矩阵 $\\mathrm{diag}(\\mathbf{K}, \\mathbf{M}^{-1})$ 变换为 $\\mathbf{H}' = \\mathbf{S}^{-\\top} \\,\\mathrm{diag}(\\mathbf{K}, \\mathbf{M}^{-1})\\, \\mathbf{S}^{-1}$ 来量化解耦；然后提取左上块 $\\mathbf{H}'_{QQ}$ 和右下块 $\\mathbf{H}'_{PP}$。在精确计算中，$\\mathbf{H}'_{QQ} = \\boldsymbol{\\Omega}^2$ 且 $\\mathbf{H}'_{PP} = \\mathbf{I}$。计算这些块的非对角线元素的最大绝对值以评估数值解耦效果。\n- 单位：质量单位为千克，弹簧常数单位为牛顿/米，角频率单位为弧度/秒。\n\n测试套件覆盖范围：\n- 案例 A 练习了具有声学零模（$\\omega = 0$）的自由边界链，这是平移不变性的典型特征，确保实现能正确处理半正定刚度。\n- 案例 B 使用固定边界条件来消除零模，产生严格为正的频率，并在正定设置中测试变换。\n- 案例 C 使用几乎相等的质量来引发近简并性，探测正交对角化和辛构造的数值稳定性。\n\n代码实现了上述推导，按要求构建了 $\\mathbf{M}$ 和 $\\mathbf{K}$，计算了 $\\boldsymbol{\\omega}$、辛偏差范数以及变换后势能和动能度规的最大非对角线幅值，并以所需的单行列表嵌套列表格式打印结果。", "answer": "```python\nimport numpy as np\n\ndef build_chain_matrices(N, masses, k, boundary):\n    \"\"\"\n    Build mass matrix M (diagonal) and stiffness matrix K for a 1D chain.\n    boundary: 'free' or 'fixed'\n    \"\"\"\n    M = np.diag(masses)\n    K = np.zeros((N, N), dtype=float)\n    # Nearest-neighbor springs\n    for i in range(N - 1):\n        K[i, i] += k\n        K[i + 1, i + 1] += k\n        K[i, i + 1] -= k\n        K[i + 1, i] -= k\n    # Boundary springs to walls if fixed\n    if boundary == 'fixed':\n        K[0, 0] += k\n        K[-1, -1] += k\n    elif boundary == 'free':\n        pass\n    else:\n        raise ValueError(\"boundary must be 'free' or 'fixed'\")\n    return M, K\n\ndef symplectic_decouple(M, K, atol_clip=1e-12):\n    \"\"\"\n    Compute symplectic transformation S that decouples the Hamiltonian:\n    H = 1/2 p^T M^{-1} p + 1/2 x^T K x\n    Returns frequencies (ascending), symplectic error, max offdiag of transformed\n    potential metric, max offdiag of transformed kinetic metric.\n    \"\"\"\n    N = M.shape[0]\n    # Mass square roots\n    masses = np.diag(M)\n    Msqrt = np.diag(np.sqrt(masses))\n    Minv = np.diag(1.0 / masses)\n    Minv_sqrt = np.diag(1.0 / np.sqrt(masses))\n\n    # Mass-weighted stiffness\n    C = Minv_sqrt @ K @ Minv_sqrt\n    # Symmetric eigen-decomposition\n    w2, O = np.linalg.eigh(C)  # ascending eigenvalues\n    # Clip small negative eigenvalues from numerical noise\n    w2_clipped = np.maximum(w2, 0.0)\n    w = np.sqrt(w2_clipped)\n\n    # Build symplectic matrix S = diag(O^T Msqrt, O^T Minv_sqrt)\n    A = O.T @ Msqrt\n    B = O.T @ Minv_sqrt\n    zero = np.zeros_like(A)\n    S = np.block([[A, np.zeros((N, N))],\n                  [np.zeros((N, N)), B]])\n\n    # Symplectic check: || S^T J S - J ||_F\n    I = np.eye(N)\n    J = np.block([[np.zeros((N, N)), I],\n                  [-I, np.zeros((N, N))]])\n    symp_err = np.linalg.norm(S.T @ J @ S - J, ord='fro')\n\n    # Transform Hamiltonian quadratic form Hmat = diag(K, M^{-1})\n    Hmat = np.block([[K, np.zeros((N, N))],\n                     [np.zeros((N, N)), Minv]])\n    # Compute S^{-1} via block diagonal inverse\n    # Since S is block diagonal with invertible blocks A and B:\n    # S^{-1} = diag(A^{-1}, B^{-1})\n    A_inv = np.linalg.inv(A)\n    B_inv = np.linalg.inv(B)\n    S_inv = np.block([[A_inv, np.zeros((N, N))],\n                      [np.zeros((N, N)), B_inv]])\n    S_inv_T = S_inv.T\n    Hprime = S_inv_T @ Hmat @ S_inv\n\n    # Extract transformed potential and kinetic metric blocks\n    Hqq = Hprime[:N, :N]\n    Hpp = Hprime[N:, N:]\n\n    # Compute maximum absolute off-diagonal entries\n    def max_offdiag_abs(Mblock):\n        Moff = Mblock - np.diag(np.diag(Mblock))\n        if Moff.size == 0:\n            return 0.0\n        return float(np.max(np.abs(Moff)))\n\n    pot_off = max_offdiag_abs(Hqq)\n    kin_off = max_offdiag_abs(Hpp)\n\n    return w.tolist(), float(symp_err), float(pot_off), float(kin_off)\n\ndef solve():\n    # Define test cases as per the problem statement\n    test_cases = [\n        # Case A: N=3, masses [1.0, 2.0, 1.5], k=100.0, boundary='free'\n        {\"N\": 3, \"masses\": [1.0, 2.0, 1.5], \"k\": 100.0, \"boundary\": \"free\"},\n        # Case B: N=3, masses [1.0, 2.0, 1.5], k=100.0, boundary='fixed'\n        {\"N\": 3, \"masses\": [1.0, 2.0, 1.5], \"k\": 100.0, \"boundary\": \"fixed\"},\n        # Case C: N=4, masses [1.0, 1.01, 0.99, 1.0], k=50.0, boundary='fixed'\n        {\"N\": 4, \"masses\": [1.0, 1.01, 0.99, 1.0], \"k\": 50.0, \"boundary\": \"fixed\"},\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        masses = np.array(case[\"masses\"], dtype=float)\n        k = float(case[\"k\"])\n        boundary = case[\"boundary\"]\n        M, K = build_chain_matrices(N, masses, k, boundary)\n        freqs, symp_err, pot_off, kin_off = symplectic_decouple(M, K)\n        results.append([freqs, symp_err, pot_off, kin_off])\n\n    # Final print statement in the exact required format.\n    # Ensure deterministic float formatting via default repr; lists-of-lists printed as requested.\n    print(str(results).replace(' ', ''))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3432798"}, {"introduction": "本练习将带您进入分析力学在凝聚态物理中的前沿应用，在这些应用中，拉格朗日量可能包含几何相位效应。您将分析一个包含依赖于速度的“贝里相位”项的系统，该项类似于位形空间中的磁场。这个问题将挑战您对正则动量与机械动量以及物理定律规范不变性的理解，揭示哈密顿形式主义如何优雅地处理这些复杂的非标准动力学问题。", "problem": "考虑一个处于长波极限下的极性晶体，其中软极性光学模由一个有效质量为 $M$ 的广义位移坐标 $\\boldsymbol{q} \\in \\mathbb{R}^d$ 来表示。由于作为晶体固体中现代极化理论基础的绝热电子响应，有效晶格拉格朗日量获得了一个在 $\\boldsymbol{q}$ 中光滑的额外贝里相位项。得到的有效拉格朗日量为\n$$\nL(\\boldsymbol{q},\\dot{\\boldsymbol{q}}) = \\frac{1}{2} M \\, \\dot{\\boldsymbol{q}} \\cdot \\dot{\\boldsymbol{q}} + \\boldsymbol{A}(\\boldsymbol{q}) \\cdot \\dot{\\boldsymbol{q}} - V(\\boldsymbol{q}),\n$$\n其中 $\\boldsymbol{A}(\\boldsymbol{q})$ 是一个源于电子贝里相位的类规范矢量势，$V(\\boldsymbol{q})$ 是有效势能。贝里曲率张量定义为 $\\Omega_{ij}(\\boldsymbol{q}) = \\partial_i A_j(\\boldsymbol{q}) - \\partial_j A_i(\\boldsymbol{q})$，其中 $\\partial_i \\equiv \\partial/\\partial q_i$。在三维空间中，可以等价地使用矢量贝里曲率 $\\boldsymbol{\\Omega}(\\boldsymbol{q}) = \\nabla \\times \\boldsymbol{A}(\\boldsymbol{q})$。\n\n从分析力学的基本定义（欧拉-拉格朗日方程、正则动量和哈密顿方程）出发，可以推导出贝里相位项如何修正运动方程，以及正则动量与力学动量有何不同。此外，分析规范变换 $\\boldsymbol{A}(\\boldsymbol{q}) \\to \\boldsymbol{A}(\\boldsymbol{q}) + \\nabla \\chi(\\boldsymbol{q})$ 的效应，其中 $\\chi(\\boldsymbol{q})$ 是一个光滑标量函数。\n\n选择所有适用于此系统的正确陈述：\n\nA. 贝里相位项为欧拉-拉格朗日动力学贡献了一个反对称的、依赖于速度的力，得到\n$$\nM \\ddot{q}_i = -\\partial_i V(\\boldsymbol{q}) + \\sum_j \\Omega_{ij}(\\boldsymbol{q}) \\, \\dot{q}_j.\n$$\n\nB. 正则动量等于力学动量，即 $p_i = M \\dot{q}_i$，且哈密頓量为 $H(\\boldsymbol{q},\\boldsymbol{p}) = \\boldsymbol{p}^2/(2M) + V(\\boldsymbol{q})$，因此 $\\boldsymbol{A}(\\boldsymbol{q})$ 的存在不影响哈密顿量。\n\nC. 正则动量为 $p_i = M \\dot{q}_i + A_i(\\boldsymbol{q})$，用正则变量写出的哈密頓量为\n$$\nH(\\boldsymbol{q},\\boldsymbol{p}) = \\frac{1}{2M} \\big(\\boldsymbol{p} - \\boldsymbol{A}(\\boldsymbol{q}) \\big)^2 + V(\\boldsymbol{q}).\n$$\n在规范变换 $\\boldsymbol{A} \\to \\boldsymbol{A} + \\nabla \\chi$ 下，物理轨迹是不变的。\n\nD. 贝里相位项 $\\boldsymbol{A}(\\boldsymbol{q}) \\cdot \\dot{\\boldsymbol{q}}$ 的存在必然使得变量 $(\\boldsymbol{q},\\boldsymbol{p})$ 中的泊松括号变为非正则的，因此 $\\{q_i, q_j\\} \\neq 0$ 且 $\\{q_i, p_j\\} \\neq \\delta_{ij}$。\n\nE. 在三维空间中，贝里曲率在位形空间中如同磁场一样作用，额外的力具有矢量形式\n$$\nM \\ddot{\\boldsymbol{q}} = -\\nabla V(\\boldsymbol{q}) + \\dot{\\boldsymbol{q}} \\times \\boldsymbol{\\Omega}(\\boldsymbol{q}),\n$$\n该力是规范不变的，因为 $\\boldsymbol{\\Omega} = \\nabla \\times \\boldsymbol{A}$。", "solution": "问题陈述经过严格审查，被认为是有效的。它在科学上基于分析力学的既定原理及其在凝聚态物理中的应用，特别是涉及贝里相位的现代极化理论。这个问题是良定的，提供了一个完整的拉格朗日量，从中可以推导出所有需要的量。术语精确客观。设定中没有矛盾、歧义或事实错误。因此，我们可以进行严格的推导和分析。\n\n系统的拉格朗日量由下式给出：\n$$\nL(\\boldsymbol{q},\\dot{\\boldsymbol{q}}) = \\frac{1}{2} M \\sum_k \\dot{q}_k^2 + \\sum_k A_k(\\boldsymbol{q}) \\dot{q}_k - V(\\boldsymbol{q})\n$$\n我们将使用这个拉格朗日量来推导运动方程、正则动量和哈密顿量，然后评估每个给定的陈述。\n\n首先，我们来推导欧拉-拉格朗日运动方程，其形式为 $\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}_i}\\right) - \\frac{\\partial L}{\\partial q_i} = 0$。\n\n我们计算 $L$ 所需的偏导数：\n$$\n\\frac{\\partial L}{\\partial \\dot{q}_i} = M \\dot{q}_i + A_i(\\boldsymbol{q})\n$$\n$$\n\\frac{\\partial L}{\\partial q_i} = \\sum_j \\frac{\\partial A_j(\\boldsymbol{q})}{\\partial q_i} \\dot{q}_j - \\frac{\\partial V(\\boldsymbol{q})}{\\partial q_i} = \\sum_j (\\partial_i A_j) \\dot{q}_j - \\partial_i V(\\boldsymbol{q})\n$$\n接下来，我们计算 $\\frac{\\partial L}{\\partial \\dot{q}_i}$ 的全时间导数：\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}_i}\\right) = \\frac{d}{dt} \\left( M \\dot{q}_i + A_i(\\boldsymbol{q}(t)) \\right) = M \\ddot{q}_i + \\frac{d A_i(\\boldsymbol{q}(t))}{dt}\n$$\n使用链式法则，$\\frac{d A_i}{dt} = \\sum_j \\frac{\\partial A_i}{\\partial q_j} \\frac{d q_j}{dt} = \\sum_j (\\partial_j A_i) \\dot{q}_j$。\n所以，\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}_i}\\right) = M \\ddot{q}_i + \\sum_j (\\partial_j A_i) \\dot{q}_j\n$$\n将这些表达式代入欧拉-拉格朗日方程：\n$$\n\\left( M \\ddot{q}_i + \\sum_j (\\partial_j A_i) \\dot{q}_j \\right) - \\left( \\sum_j (\\partial_i A_j) \\dot{q}_j - \\partial_i V(\\boldsymbol{q}) \\right) = 0\n$$\n重新整理各项，得到运动方程：\n$$\nM \\ddot{q}_i = \\sum_j (\\partial_i A_j - \\partial_j A_i) \\dot{q}_j - \\partial_i V(\\boldsymbol{q})\n$$\n使用贝里曲率张量的定义 $\\Omega_{ij}(\\boldsymbol{q}) = \\partial_i A_j(\\boldsymbol{q}) - \\partial_j A_i(\\boldsymbol{q})$，我们得到：\n$$\nM \\ddot{q}_i = -\\partial_i V(\\boldsymbol{q}) + \\sum_j \\Omega_{ij}(\\boldsymbol{q}) \\dot{q}_j\n$$\n这是广义坐标 $\\boldsymbol{q}$ 的第 $i$ 个分量的运动方程。\n\n现在，我们转向哈密顿表述。与 $q_i$ 共轭的正则动量 $p_i$ 定义为：\n$$\np_i = \\frac{\\partial L}{\\partial \\dot{q}_i} = M \\dot{q}_i + A_i(\\boldsymbol{q})\n$$\n力学动量为 $\\pi_i = M \\dot{q}_i$。因此，正则动量和力学动量不相同；它们通过 $p_i = \\pi_i + A_i(\\boldsymbol{q})$ 相关联。\n\n哈密顿量 $H$ 通过勒让德变换 $H = \\sum_i p_i \\dot{q}_i - L$ 得到：\n$$\nH = \\sum_i (M \\dot{q}_i + A_i) \\dot{q}_i - \\left( \\frac{1}{2} M \\sum_k \\dot{q}_k^2 + \\sum_k A_k \\dot{q}_k - V(\\boldsymbol{q}) \\right)\n$$\n$$\nH = M |\\dot{\\boldsymbol{q}}|^2 + \\boldsymbol{A} \\cdot \\dot{\\boldsymbol{q}} - \\frac{1}{2} M |\\dot{\\boldsymbol{q}}|^2 - \\boldsymbol{A} \\cdot \\dot{\\boldsymbol{q}} + V(\\boldsymbol{q}) = \\frac{1}{2} M |\\dot{\\boldsymbol{q}}|^2 + V(\\boldsymbol{q})\n$$\n为了用正则变量 $(\\boldsymbol{q}, \\boldsymbol{p})$ 表示哈密顿量，我们必须消去 $\\dot{\\boldsymbol{q}}$。根据正则动量的定义，我们有 $M \\dot{\\boldsymbol{q}} = \\boldsymbol{p} - \\boldsymbol{A}(\\boldsymbol{q})$，或者 $\\dot{\\boldsymbol{q}} = \\frac{1}{M}(\\boldsymbol{p} - \\boldsymbol{A}(\\boldsymbol{q}))$。将此代入 $H$ 的表达式中：\n$$\nH(\\boldsymbol{q}, \\boldsymbol{p}) = \\frac{1}{2} M \\left| \\frac{1}{M}(\\boldsymbol{p} - \\boldsymbol{A}(\\boldsymbol{q})) \\right|^2 + V(\\boldsymbol{q})\n$$\n$$\nH(\\boldsymbol{q}, \\boldsymbol{p}) = \\frac{1}{2M} \\big(\\boldsymbol{p} - \\boldsymbol{A}(\\boldsymbol{q})\\big)^2 + V(\\boldsymbol{q})\n$$\n\n有了这些基础性结果，我们现在可以评估每个陈述。\n\n**A. 贝里相位项为欧拉-拉格朗日动力学贡献了一个反对称的、依赖于速度的力，得到 $$M \\ddot{q}_i = -\\partial_i V(\\boldsymbol{q}) + \\sum_j \\Omega_{ij}(\\boldsymbol{q}) \\, \\dot{q}_j. $$**\n我们对欧拉-拉格朗日运动方程的推导恰好得到了这个结果。源于贝里相位的力项是 $F_{i, \\text{Berry}} = \\sum_j \\Omega_{ij}(\\boldsymbol{q}) \\dot{q}_j$。这个力明显依赖于速度 $\\dot{\\boldsymbol{q}}$。根据定义，贝里曲率张量 $\\Omega_{ij} = \\partial_i A_j - \\partial_j A_i$ 是反对称的，因为 $\\Omega_{ji} = \\partial_j A_i - \\partial_i A_j = -(\\partial_i A_j - \\partial_j A_i) = -\\Omega_{ij}$。因此，该陈述是对系统动力学的正确描述。\n**结论：正确。**\n\n**B. 正则动量等于力学动量，即 $p_i = M \\dot{q}_i$，且哈密顿量为 $H(\\boldsymbol{q},\\boldsymbol{p}) = \\boldsymbol{p}^2/(2M) + V(\\boldsymbol{q})$，因此 $\\boldsymbol{A}(\\boldsymbol{q})$ 的存在不影响哈密顿量。**\n我们的推导表明正则动量是 $p_i = M \\dot{q}_i + A_i(\\boldsymbol{q})$。这不等于力学动量 $M \\dot{q}_i$，因为 $\\boldsymbol{A}(\\boldsymbol{q})$ 非零。推导出的哈密顿量是 $H(\\boldsymbol{q},\\boldsymbol{p}) = \\frac{1}{2M} (\\boldsymbol{p} - \\boldsymbol{A}(\\boldsymbol{q}))^2 + V(\\boldsymbol{q})$，它显式地依赖于 $\\boldsymbol{A}(\\boldsymbol{q})$。该陈述在两点上都是不正确的。\n**结论：不正确。**\n\n**C. 正则动量为 $p_i = M \\dot{q}_i + A_i(\\boldsymbol{q})$，用正则变量写出的哈密顿量为 $$ H(\\boldsymbol{q},\\boldsymbol{p}) = \\frac{1}{2M} \\big(\\boldsymbol{p} - \\boldsymbol{A}(\\boldsymbol{q}) \\big)^2 + V(\\boldsymbol{q}). $$ 在规范变换 $\\boldsymbol{A} \\to \\boldsymbol{A} + \\nabla \\chi$ 下，物理轨迹是不变的。**\n我们对正则动量和哈密顿量的推导证实了此陈述中给出的表达式。让我们分析规范变换 $\\boldsymbol{A} \\to \\boldsymbol{A}' = \\boldsymbol{A} + \\nabla \\chi$。拉格朗日量变换为 $L \\to L' = L + (\\nabla \\chi) \\cdot \\dot{\\boldsymbol{q}}$。由于 $\\frac{d\\chi(\\boldsymbol{q}(t))}{dt} = \\sum_i \\frac{\\partial \\chi}{\\partial q_i} \\dot{q}_i = (\\nabla \\chi) \\cdot \\dot{\\boldsymbol{q}}$，新的拉格朗日量是 $L' = L + \\frac{d\\chi}{dt}$。在拉格朗日量上增加一个全时间导数不会改变欧拉-拉格朗日运动方程，因为对于固定的端点，作用量的变分 $\\delta \\int (d\\chi/dt) dt = \\delta [\\chi]_{\\text{boundary}}$ 为零。因此，作为运动方程解的物理轨迹确实是不变的。\n**结论：正确。**\n\n**D. 贝里相位项 $\\boldsymbol{A}(\\boldsymbol{q}) \\cdot \\dot{\\boldsymbol{q}}$ 的存在必然使得变量 $(\\boldsymbol{q},\\boldsymbol{p})$ 中的泊松括号变为非正则的，因此 $\\{q_i, q_j\\} \\neq 0$ 且 $\\{q_i, p_j\\} \\neq \\delta_{ij}$。**\n这个陈述误解了哈密顿力学的本质。通过勒让德变换得到的变量 $(\\boldsymbol{q}, \\boldsymbol{p})$ 根据定义就是正则坐标和正则动量。它们构成一个正则相空间，在此空间中，基本的泊松括号根据构造就是 $\\{q_i, q_j\\} = 0$，$\\{p_i, p_j\\} = 0$ 和 $\\{q_i, p_j\\} = \\delta_{ij}$。拉格朗日量中像 $\\boldsymbol{A}(\\boldsymbol{q}) \\cdot \\dot{\\boldsymbol{q}}$ 这样的项的存在，改变了速度和正则动量之间的关系，但它不改变正则相空间本身的基本代数结构。非正则变量（例如速度）的括号 $\\{\\dot{q}_i, \\dot{q}_j\\} = \\Omega_{ij}/M^2$ 可能非零，但关于正则变量 $(\\boldsymbol{q}, \\boldsymbol{p})$ 的断言是根本不正确的。\n**结论：不正确。**\n\n**E. 在三维空间中，贝里曲率在位形空间中如同磁场一样作用，额外的力具有矢量形式 $$ M \\ddot{\\boldsymbol{q}} = -\\nabla V(\\boldsymbol{q}) + \\dot{\\boldsymbol{q}} \\times \\boldsymbol{\\Omega}(\\boldsymbol{q}), $$ 该力是规范不变的，因为 $\\boldsymbol{\\Omega} = \\nabla \\times \\boldsymbol{A}$。**\n与磁场的类比是恰当的。这个力是一种类洛伦兹力，但作用于广义坐标 $\\boldsymbol{q}$ 的位形空间中。我们来验证这个力的矢量形式。矢量叉积 $\\dot{\\boldsymbol{q}} \\times \\boldsymbol{\\Omega}$ 的第 $i$ 个分量由 $\\sum_{jk} \\epsilon_{ijk} \\dot{q}_j \\Omega_k$ 给出。在三维中，矢量贝里曲率为 $\\boldsymbol{\\Omega} = \\nabla \\times \\boldsymbol{A}$，因此其分量为 $\\Omega_k = \\sum_{lm} \\epsilon_{klm} \\partial_l A_m$。力的第 $i$ 个分量是 $\\sum_{jk} \\epsilon_{ijk} \\dot{q}_j (\\sum_{lm} \\epsilon_{klm} \\partial_l A_m)$。使用恒等式 $\\sum_k \\epsilon_{ijk} \\epsilon_{klm} = \\delta_{il}\\delta_{jm} - \\delta_{im}\\delta_{jl}$，这变为：$\\sum_{jlm} (\\delta_{il}\\delta_{jm} - \\delta_{im}\\delta_{jl}) \\dot{q}_j (\\partial_l A_m) = \\sum_j \\dot{q}_j (\\partial_i A_j) - \\sum_j \\dot{q}_j (\\partial_j A_i) = \\sum_j (\\partial_i A_j - \\partial_j A_i) \\dot{q}_j = \\sum_j \\Omega_{ij} \\dot{q}_j$。这与我们之前推导出的力项相匹配。因此，运动的矢量方程是正确的。$\\boldsymbol{\\Omega}$ 的规范不变性源于矢量恒等式 $\\nabla \\times (\\nabla \\chi) = 0$。在变换 $\\boldsymbol{A} \\to \\boldsymbol{A}' = \\boldsymbol{A} + \\nabla \\chi$ 下，曲率变为 $\\boldsymbol{\\Omega}' = \\nabla \\times \\boldsymbol{A}' = \\nabla \\times (\\boldsymbol{A} + \\nabla \\chi) = \\nabla \\times \\boldsymbol{A} + \\nabla \\times (\\nabla \\chi) = \\boldsymbol{\\Omega}$。由于 $\\boldsymbol{\\Omega}$ 是规范不变的，所以这个力以及整个运动方程也是规范不变的。\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "3432813"}]}