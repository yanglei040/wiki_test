{"hands_on_practices": [{"introduction": "本练习旨在连接经典热力学与电化学。通过使用已发表的实验生成自由能，您将计算铁普尔贝图中的关键平衡边界，从而加深对能斯特方程的理解。这项练习 [@problem_id:3480104] 不仅有助于重现一个众所周知的图，还引入了敏感性分析，让您深入了解哪些物种的能量对图的特征影响最为关键。", "problem": "要求您实现一个完整、可运行的程序，该程序使用第一性原理热力学来计算铁 Pourbaix 图中关键边界的平衡电极电势，并评估哪些边界对标准生成吉布斯自由能的微小变化最为敏感。计算必须基于以下以国际单位制 (SI) 表述的基本关系和常数。\n\n基本物理基础：\n- 物种 $i$ 的标准生成吉布斯自由能为 $\\Delta G_{f,i}^\\circ$，单位是 $\\mathrm{J/mol}$。\n- 反应的标准吉布斯自由能为 $\\Delta G^\\circ = \\sum_i \\nu_i \\Delta G_{f,i}^\\circ$，其中 $\\nu_i$ 是物种 $i$ 的化学计量系数（产物为正，反应物为负）。\n- 对于包含 $n$ 个电子的氧化还原半反应，平衡时的 Nernst 关系式为 $E = E^\\circ - \\dfrac{R T}{n F} \\ln Q$，其中 $E^\\circ = -\\dfrac{\\Delta G^\\circ}{n F}$，$Q$ 是反应商 $Q = \\prod_i a_i^{\\nu_i}$（$a_i$ 为活度），$R$ 是通用气体常数，$T$ 是绝对温度，$F$ 是法拉第常数。\n- 活度取值为：$a_{\\mathrm{H^+}} = 10^{-\\mathrm{pH}}$，$a_{\\mathrm{Fe^{2+}}} = 10^{-6}$，$a_{\\mathrm{Fe^{3+}}} = 10^{-6}$，所有纯固体和液态水的活度 $a_i = 1$。电子的活度不计入 $Q$。\n\n使用的常数：\n- $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。\n- $T = 298.15\\,\\mathrm{K}$。\n- $F = 96485\\,\\mathrm{C/mol}$。\n\n物种及其标准生成吉布斯自由能（单位：$\\mathrm{J/mol}$）：\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe(s)}) = 0$。\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe^{2+}(aq)}) = -89100$。\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe^{3+}(aq)}) = -14700$。\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe_2O_3(s)}) = -742200$。\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe_3O_4(s)}) = -1015400$。\n- $\\Delta G_{f}^\\circ(\\mathrm{H_2O(l)}) = -237130$。\n- $\\Delta G_{f}^\\circ(\\mathrm{H^+(aq)}) = 0$。\n\n待分析的半反应（以还原反应形式书写），其中 $n$ 为电子数，$\\nu_i$ 为化学计量系数：\n- 边界 $\\mathrm{B1}$ (金属溶解/还原): $\\mathrm{Fe^{2+}(aq)} + 2\\,e^- \\rightleftharpoons \\mathrm{Fe(s)}$。此处 $n = 2$，$\\nu_{\\mathrm{Fe^{2+}}} = -1$，$\\nu_{\\mathrm{Fe(s)}} = +1$。\n- 边界 $\\mathrm{B2}$ (三价铁/二价铁): $\\mathrm{Fe^{3+}(aq)} + e^- \\rightleftharpoons \\mathrm{Fe^{2+}(aq)}$。此处 $n = 1$，$\\nu_{\\mathrm{Fe^{3+}}} = -1$，$\\nu_{\\mathrm{Fe^{2+}}} = +1$。\n- 边界 $\\mathrm{B3}$ (赤铁矿到二价铁): $\\mathrm{Fe_2O_3(s)} + 6\\,\\mathrm{H^+(aq)} + 2\\,e^- \\rightleftharpoons 2\\,\\mathrm{Fe^{2+}(aq)} + 3\\,\\mathrm{H_2O(l)}$。此处 $n = 2$，$\\nu_{\\mathrm{Fe_2O_3}} = -1$，$\\nu_{\\mathrm{H^+}} = -6$，$\\nu_{\\mathrm{Fe^{2+}}} = +2$，$\\nu_{\\mathrm{H_2O}} = +3$。\n- 边界 $\\mathrm{B4}$ (磁铁矿到二价铁): $\\mathrm{Fe_3O_4(s)} + 8\\,\\mathrm{H^+(aq)} + 2\\,e^- \\rightleftharpoons 3\\,\\mathrm{Fe^{2+}(aq)} + 4\\,\\mathrm{H_2O(l)}$。此处 $n = 2$，$\\nu_{\\mathrm{Fe_3O_4}} = -1$，$\\nu_{\\mathrm{H^+}} = -8$，$\\nu_{\\mathrm{Fe^{2+}}} = +3$，$\\nu_{\\mathrm{H_2O}} = +4$。\n\n任务：\n1. 对于三个测试 $\\mathrm{pH}$ 值 $0$、$7$ 和 $14$，使用上述基本关系计算边界 $\\mathrm{B1}$、$\\mathrm{B2}$、$\\mathrm{B3}$ 和 $\\mathrm{B4}$ 相对于标准氢电极 (SHE) 的平衡电势 $E$ (单位：伏特)。每个电势以 $\\mathrm{V}$ 为单位表示，并四舍五入到三位小数。\n2. 定义一个边界敏感度指标 $S_b = \\max_i \\left( \\dfrac{|\\nu_i|}{n_b F} \\right)$，其中最大值是针对边界 $b$ 中贡献了非零 $\\Delta G_f^\\circ$ 的所有物种 $i$，$n_b$ 是边界 $b$ 的电子数，$F$ 是法拉第常数。该 $S_b$ 的单位是 $\\mathrm{V/J}$，它衡量了单个 $\\Delta G_f^\\circ$ 每单位变化所引起的 $E$ 的最大绝对变化量。使用从 1 开始的索引 $\\{1,2,3,4\\}$，找出 $\\{\\mathrm{B1},\\mathrm{B2},\\mathrm{B3},\\mathrm{B4}\\}$ 中最敏感边界的索引。\n\n单位和角度约束：\n- 所有电势必须以相对于 SHE 的 $\\mathrm{V}$ 为单位报告。\n- 活度是无量纲的；$\\mathrm{pH}$ 是无量纲的。\n- 不涉及角度。\n\n测试套件：\n- 测试用例 1：$\\mathrm{pH} = 0$。\n- 测试用例 2：$\\mathrm{pH} = 7$。\n- 测试用例 3：$\\mathrm{pH} = 14$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按固定顺序包含十二个计算出的电势 $[\\mathrm{B1}@\\mathrm{pH}=0,\\mathrm{B2}@\\mathrm{pH}=0,\\mathrm{B3}@\\mathrm{pH}=0,\\mathrm{B4}@\\mathrm{pH}=0,\\mathrm{B1}@\\mathrm{pH}=7,\\mathrm{B2}@\\mathrm{pH}=7,\\mathrm{B3}@\\mathrm{pH}=7,\\mathrm{B4}@\\mathrm{pH}=7,\\mathrm{B1}@\\mathrm{pH}=14,\\mathrm{B2}@\\mathrm{pH}=14,\\mathrm{B3}@\\mathrm{pH}=14,\\mathrm{B4}@\\mathrm{pH}=14]$，其后附加最敏感边界的从 1 开始的整数索引作为第十三个元素。输出结构示例如下：$[e_{1,0},e_{2,0},e_{3,0},e_{4,0},e_{1,7},e_{2,7},e_{3,7},e_{4,7},e_{1,14},e_{2,14},e_{3,14},e_{4,14},b_{\\mathrm{max}}]$，其中每个 $e_{\\cdot,\\cdot}$ 是一个四舍五入到三位小数的浮点数（单位为伏特），$b_{\\mathrm{max}}$ 是一个整数。", "solution": "用户提供的问题已经过评估，并被确定为**有效**。它在科学上基于化学热力学和电化学原理，问题提法严谨，提供了所有必要的信息，并且没有矛盾或含糊之处。因此，我们可以进行完整的解答。\n\n该问题要求计算在指定的 $\\mathrm{pH}$ 值下，与铁 Pourbaix 图相关的四个不同半反应的平衡电极电势，并分析这些电势对标准生成吉布斯自由能变化的敏感度。\n\n控制平衡电极电势 $E$ 的基本关系是 Nernst 方程：\n$$E = E^\\circ - \\frac{R T}{n F} \\ln Q$$\n其中 $E^\\circ$ 是标准电极电势，$R$ 是通用气体常数，$T$ 是绝对温度，$n$ 是反应中转移的电子摩尔数，$F$ 是法拉第常数，$Q$ 是反应商。\n\n标准电势 $E^\\circ$ 通过以下公式与反应的标准吉布斯自由能变 $\\Delta G^\\circ$ 相关：\n$$E^\\circ = -\\frac{\\Delta G^\\circ}{n F}$$\n而 $\\Delta G^\\circ$ 由反应物和产物的标准生成吉布斯自由能 $\\Delta G_{f,i}^\\circ$ 计算得出：\n$$\\Delta G^\\circ = \\sum_i \\nu_i \\Delta G_{f,i}^\\circ$$\n其中 $\\nu_i$ 是化学计量系数（产物为正，反应物为负）。\n\n反应商 $Q$ 由各物种的活度 $a_i$ 的乘积给出，每个活度都取其化学计量系数的幂次方：\n$$Q = \\prod_i a_i^{\\nu_i}$$\n\n提供的常数和参数如下：\n- 通用气体常数，$R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。\n- 绝对温度，$T = 298.15\\,\\mathrm{K}$。\n- 法拉第常数，$F = 96485\\,\\mathrm{C/mol}$。\n- 活度：$a_{\\mathrm{Fe^{2+}}} = 10^{-6}$，$a_{\\mathrm{Fe^{3+}}} = 10^{-6}$，$a_{\\mathrm{H^+}} = 10^{-\\mathrm{pH}}$，纯固体和液态水的活度 $a_i = 1$。\n\n标准生成吉布斯自由能 $\\Delta G_f^\\circ$（单位：$\\mathrm{J/mol}$）：\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe(s)}) = 0$\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe^{2+}(aq)}) = -89100$\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe^{3+}(aq)}) = -14700$\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe_2O_3(s)}) = -742200$\n- $\\Delta G_{f}^\\circ(\\mathrm{Fe_3O_4(s)}) = -1015400$\n- $\\Delta G_{f}^\\circ(\\mathrm{H_2O(l)}) = -237130$\n- $\\Delta G_{f}^\\circ(\\mathrm{H^+(aq)}) = 0$\n\n在给定温度下，计算能斯特前置因子会很方便：\n$\\frac{RT}{F} = \\frac{8.314462618\\,\\mathrm{J/(mol \\cdot K)} \\times 298.15\\,\\mathrm{K}}{96485\\,\\mathrm{C/mol}} \\approx 0.0256926\\,\\mathrm{V}$。\n对于涉及 $\\mathrm{pH}$（一个以 10 为底的对数标度）的计算，使用 $\\frac{RT}{F} \\ln(10) \\approx 0.059159\\,\\mathrm{V}$ 会很方便。我们将其设为 $V_{10}$。\n于是，Nernst 方程可以写为 $E = E^\\circ - \\frac{V_{10}}{n} \\log_{10} Q$。\n\n**第一部分：平衡电势的计算**\n\n我们现在将分析在 $\\mathrm{pH}$ 值为 $0$、$7$ 和 $14$ 时每个边界的情况。\n\n**边界 B1: $\\mathrm{Fe^{2+}(aq)} + 2\\,e^- \\rightleftharpoons \\mathrm{Fe(s)}$**\n- $n = 2$。\n- $\\Delta G^\\circ = \\Delta G_{f}^\\circ(\\mathrm{Fe(s)}) - \\Delta G_{f}^\\circ(\\mathrm{Fe^{2+}(aq)}) = 0 - (-89100) = 89100\\,\\mathrm{J/mol}$。\n- $E^\\circ = -\\frac{89100\\,\\mathrm{J/mol}}{2 \\times 96485\\,\\mathrm{C/mol}} \\approx -0.46173\\,\\mathrm{V}$。\n- $Q = \\frac{a_{\\mathrm{Fe(s)}}}{a_{\\mathrm{Fe^{2+}}}} = \\frac{1}{10^{-6}} = 10^6$。\n- $E = E^\\circ - \\frac{V_{10}}{2} \\log_{10}(10^6) = E^\\circ - \\frac{V_{10}}{2} \\times 6 = E^\\circ - 3 \\times V_{10} \\approx -0.46173 - 3 \\times 0.059159 \\approx -0.63921\\,\\mathrm{V}$。\n- 该电势与 $\\mathrm{pH}$ 无关。\n- 对于所有 $\\mathrm{pH}$ 值，$E_{\\mathrm{B1}} \\approx -0.639\\,\\mathrm{V}$。\n\n**边界 B2: $\\mathrm{Fe^{3+}(aq)} + e^- \\rightleftharpoons \\mathrm{Fe^{2+}(aq)}$**\n- $n = 1$。\n- $\\Delta G^\\circ = \\Delta G_{f}^\\circ(\\mathrm{Fe^{2+}(aq)}) - \\Delta G_{f}^\\circ(\\mathrm{Fe^{3+}(aq)}) = -89100 - (-14700) = -74400\\,\\mathrm{J/mol}$。\n- $E^\\circ = -\\frac{-74400\\,\\mathrm{J/mol}}{1 \\times 96485\\,\\mathrm{C/mol}} \\approx 0.77109\\,\\mathrm{V}$。\n- $Q = \\frac{a_{\\mathrm{Fe^{2+}}}}{a_{\\mathrm{Fe^{3+}}}} = \\frac{10^{-6}}{10^{-6}} = 1$。\n- $E = E^\\circ - \\frac{V_{10}}{1} \\log_{10}(1) = E^\\circ \\approx 0.77109\\,\\mathrm{V}$。\n- 该电势也与 $\\mathrm{pH}$ 无关。\n- 对于所有 $\\mathrm{pH}$ 值，$E_{\\mathrm{B2}} \\approx 0.771\\,\\mathrm{V}$。\n\n**边界 B3: $\\mathrm{Fe_2O_3(s)} + 6\\,\\mathrm{H^+(aq)} + 2\\,e^- \\rightleftharpoons 2\\,\\mathrm{Fe^{2+}(aq)} + 3\\,\\mathrm{H_2O(l)}$**\n- $n = 2$。\n- $\\Delta G^\\circ = \\left(2\\Delta G_{f}^\\circ(\\mathrm{Fe^{2+}}) + 3\\Delta G_{f}^\\circ(\\mathrm{H_2O})\\right) - \\left(\\Delta G_{f}^\\circ(\\mathrm{Fe_2O_3}) + 6\\Delta G_{f}^\\circ(\\mathrm{H^+})\\right)$\n- $\\Delta G^\\circ = \\left(2(-89100) + 3(-237130)\\right) - \\left((-742200) + 6(0)\\right) = (-178200 - 711390) + 742200 = -147390\\,\\mathrm{J/mol}$。\n- $E^\\circ = -\\frac{-147390\\,\\mathrm{J/mol}}{2 \\times 96485\\,\\mathrm{C/mol}} \\approx 0.76379\\,\\mathrm{V}$。\n- $Q = \\frac{a_{\\mathrm{Fe^{2+}}}^2 a_{\\mathrm{H_2O}}^3}{a_{\\mathrm{Fe_2O_3}} a_{\\mathrm{H^+}}^6} = \\frac{(10^{-6})^2 \\cdot 1^3}{1 \\cdot (10^{-\\mathrm{pH}})^6} = \\frac{10^{-12}}{10^{-6\\,\\mathrm{pH}}} = 10^{6\\,\\mathrm{pH}-12}$。\n- $E = E^\\circ - \\frac{V_{10}}{2} \\log_{10}(10^{6\\,\\mathrm{pH}-12}) = E^\\circ - \\frac{V_{10}}{2}(6\\,\\mathrm{pH}-12) = E^\\circ - V_{10}(3\\,\\mathrm{pH}-6)$。\n- 在 $\\mathrm{pH}=0$ 时：$E \\approx 0.76379 - 0.059159(0-6) = 0.76379 + 0.35495 \\approx 1.119\\,\\mathrm{V}$。\n- 在 $\\mathrm{pH}=7$ 时：$E \\approx 0.76379 - 0.059159(21-6) = 0.76379 - 0.88738 \\approx -0.124\\,\\mathrm{V}$。\n- 在 $\\mathrm{pH}=14$ 时：$E \\approx 0.76379 - 0.059159(42-6) = 0.76379 - 2.12972 \\approx -1.366\\,\\mathrm{V}$。\n\n**边界 B4: $\\mathrm{Fe_3O_4(s)} + 8\\,\\mathrm{H^+(aq)} + 2\\,e^- \\rightleftharpoons 3\\,\\mathrm{Fe^{2+}(aq)} + 4\\,\\mathrm{H_2O(l)}$**\n- $n = 2$。\n- $\\Delta G^\\circ = \\left(3\\Delta G_{f}^\\circ(\\mathrm{Fe^{2+}}) + 4\\Delta G_{f}^\\circ(\\mathrm{H_2O})\\right) - \\left(\\Delta G_{f}^\\circ(\\mathrm{Fe_3O_4}) + 8\\Delta G_{f}^\\circ(\\mathrm{H^+})\\right)$\n- $\\Delta G^\\circ = \\left(3(-89100) + 4(-237130)\\right) - \\left((-1015400) + 8(0)\\right) = (-267300 - 948520) + 1015400 = -200420\\,\\mathrm{J/mol}$。\n- $E^\\circ = -\\frac{-200420\\,\\mathrm{J/mol}}{2 \\times 96485\\,\\mathrm{C/mol}} \\approx 1.03859\\,\\mathrm{V}$。\n- $Q = \\frac{a_{\\mathrm{Fe^{2+}}}^3 a_{\\mathrm{H_2O}}^4}{a_{\\mathrm{Fe_3O_4}} a_{\\mathrm{H^+}}^8} = \\frac{(10^{-6})^3 \\cdot 1^4}{1 \\cdot (10^{-\\mathrm{pH}})^8} = \\frac{10^{-18}}{10^{-8\\,\\mathrm{pH}}} = 10^{8\\,\\mathrm{pH}-18}$。\n- $E = E^\\circ - \\frac{V_{10}}{2} \\log_{10}(10^{8\\,\\mathrm{pH}-18}) = E^\\circ - \\frac{V_{10}}{2}(8\\,\\mathrm{pH}-18) = E^\\circ - V_{10}(4\\,\\mathrm{pH}-9)$。\n- 在 $\\mathrm{pH}=0$ 时：$E \\approx 1.03859 - 0.059159(0-9) = 1.03859 + 0.53243 \\approx 1.571\\,\\mathrm{V}$。\n- 在 $\\mathrm{pH}=7$ 时：$E \\approx 1.03859 - 0.059159(28-9) = 1.03859 - 1.12402 \\approx -0.085\\,\\mathrm{V}$。\n- 在 $\\mathrm{pH}=14$ 时：$E \\approx 1.03859 - 0.059159(56-9) = 1.03859 - 2.78047 \\approx -1.742\\,\\mathrm{V}$。\n\n**第二部分：敏感度分析**\n\n边界电势 $E_b$ 对特定 $\\Delta G_{f,i}^\\circ$ 变化的敏感度由 $\\frac{\\partial E_b}{\\partial \\Delta G_{f,i}^\\circ} = -\\frac{\\nu_i}{n_b F}$ 给出。敏感度指标 $S_b$ 定义为该导数绝对值在所有具有非零 $\\Delta G_{f,i}^\\circ$ 的物种 $i$ 上的最大值：\n$$S_b = \\max_i \\left( \\left| -\\frac{\\nu_i}{n_b F} \\right| \\right) = \\max_i \\left( \\frac{|\\nu_i|}{n_b F} \\right)$$\n\n- **边界 B1：** $n_1=2$。唯一具有非零 $\\Delta G_{f}^\\circ$ 的物种是 $\\mathrm{Fe^{2+}(aq)}$，其 $\\nu=-1$。\n  $S_1 = \\frac{|-1|}{2 F} = \\frac{1}{2F}$。\n\n- **边界 B2：** $n_2=1$。具有非零 $\\Delta G_{f}^\\circ$ 的物种是 $\\mathrm{Fe^{3+}(aq)}$ ($\\nu=-1$) 和 $\\mathrm{Fe^{2+}(aq)}$ ($\\nu=+1$)。\n  $S_2 = \\max\\left(\\frac{|-1|}{1F}, \\frac{|+1|}{1F}\\right) = \\frac{1}{F}$。\n\n- **边界 B3：** $n_3=2$。具有非零 $\\Delta G_{f}^\\circ$ 的物种：$\\mathrm{Fe_2O_3(s)}$ ($\\nu=-1$)、$\\mathrm{Fe^{2+}(aq)}$ ($\\nu=+2$)、$\\mathrm{H_2O(l)}$ ($\\nu=+3$)。\n  $S_3 = \\max\\left(\\frac{|-1|}{2F}, \\frac{|+2|}{2F}, \\frac{|+3|}{2F}\\right) = \\frac{3}{2F} = \\frac{1.5}{F}$。\n\n- **边界 B4：** $n_4=2$。具有非零 $\\Delta G_{f}^\\circ$ 的物种：$\\mathrm{Fe_3O_4(s)}$ ($\\nu=-1$)、$\\mathrm{Fe^{2+}(aq)}$ ($\\nu=+3$)、$\\mathrm{H_2O(l)}$ ($\\nu=+4$)。\n  $S_4 = \\max\\left(\\frac{|-1|}{2F}, \\frac{|+3|}{2F}, \\frac{|+4|}{2F}\\right) = \\frac{4}{2F} = \\frac{2}{F}$。\n\n比较各敏感度：$S_1 = \\frac{0.5}{F}$，$S_2 = \\frac{1}{F}$，$S_3 = \\frac{1.5}{F}$，$S_4 = \\frac{2}{F}$。\n最大敏感度是 $S_4$，对应于边界 B4。从 1 开始的索引是 $4$。这是因为该电势对水（$\\mathrm{H_2O}$）的吉布斯自由能依赖性最强，其化学计量系数 $|\\nu|=4$ 相对于电子数 $n=2$ 是最大的。\n\n最终结果总结：\n- **pH = 0：** $E_{\\mathrm{B1}}=-0.639\\,\\mathrm{V}$，$E_{\\mathrm{B2}}=0.771\\,\\mathrm{V}$，$E_{\\mathrm{B3}}=1.119\\,\\mathrm{V}$，$E_{\\mathrm{B4}}=1.571\\,\\mathrm{V}$。\n- **pH = 7：** $E_{\\mathrm{B1}}=-0.639\\,\\mathrm{V}$，$E_{\\mathrm{B2}}=0.771\\,\\mathrm{V}$，$E_{\\mathrm{B3}}=-0.124\\,\\mathrm{V}$，$E_{\\mathrm{B4}}=-0.085\\,\\mathrm{V}$。\n- **pH = 14：** $E_{\\mathrm{B1}}=-0.639\\,\\mathrm{V}$，$E_{\\mathrm{B2}}=0.771\\,\\mathrm{V}$，$E_{\\mathrm{B3}}=-1.366\\,\\mathrm{V}$，$E_{\\mathrm{B4}}=-1.742\\,\\mathrm{V}$。\n- **最敏感的边界：** B4（索引为 4）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes equilibrium electrode potentials for iron Pourbaix diagram boundaries\n    and determines the boundary most sensitive to Gibbs free energy changes.\n    \"\"\"\n    # Define physical constants\n    R = 8.314462618  # J/(mol*K)\n    T = 298.15        # K\n    F = 96485         # C/mol\n\n    # Standard Gibbs free energies of formation (J/mol)\n    G_f = {\n        'Fe(s)': 0,\n        'Fe2+(aq)': -89100,\n        'Fe3+(aq)': -14700,\n        'Fe2O3(s)': -742200,\n        'Fe3O4(s)': -1015400,\n        'H2O(l)': -237130,\n        'H+(aq)': 0,\n        'e-': 0  # not a chemical species, but useful for data structure\n    }\n\n    # Activities of species\n    activities = {\n        'Fe2+(aq)': 10**-6,\n        'Fe3+(aq)': 10**-6,\n        'Fe(s)': 1,\n        'Fe2O3(s)': 1,\n        'Fe3O4(s)': 1,\n        'H2O(l)': 1,\n    }\n\n    # Define the half-reactions (boundaries)\n    # stoich coeffs: positive for products, negative for reactants\n    boundaries = {\n        'B1': {'n': 2, 'stoich': {'Fe(s)': 1, 'Fe2+(aq)': -1}},\n        'B2': {'n': 1, 'stoich': {'Fe2+(aq)': 1, 'Fe3+(aq)': -1}},\n        'B3': {'n': 2, 'stoich': {'Fe2+(aq)': 2, 'H2O(l)': 3, 'Fe2O3(s)': -1, 'H+(aq)': -6}},\n        'B4': {'n': 2, 'stoich': {'Fe2+(aq)': 3, 'H2O(l)': 4, 'Fe3O4(s)': -1, 'H+(aq)': -8}},\n    }\n\n    # pH test cases\n    test_cases_ph = [0, 7, 14]\n    \n    # Store all computed potentials in order\n    all_potentials = []\n\n    # Task 1: Calculate potentials\n    for ph in test_cases_ph:\n        # Update H+ activity for the current pH\n        activities['H+(aq)'] = 10**(-ph)\n        \n        # Order is B1, B2, B3, B4 for each pH\n        for b_name in ['B1', 'B2', 'B3', 'B4']:\n            boundary_data = boundaries[b_name]\n            n = boundary_data['n']\n            stoich = boundary_data['stoich']\n            \n            # Calculate delta_G_reaction\n            delta_G_reaction = 0\n            for species, nu in stoich.items():\n                delta_G_reaction += nu * G_f[species]\n\n            # Calculate E_standard\n            E_standard = -delta_G_reaction / (n * F)\n\n            # Calculate reaction quotient Q\n            Q = 1.0\n            for species, nu in stoich.items():\n                if species != 'e-':\n                    Q *= activities[species]**nu\n\n            # Calculate potential E using Nernst equation\n            # Handle Q=0 case to avoid math domain errors, though not expected here\n            if Q > 0:\n                E = E_standard - (R * T) / (n * F) * np.log(Q)\n            else: # Should not happen with given activities\n                E = -np.inf if any(activities[s] == 0 for s, nu in stoich.items() if nu > 0) else np.inf\n\n            all_potentials.append(E)\n\n    # Task 2: Calculate sensitivities and find the most sensitive boundary\n    sensitivities = {}\n    for b_idx, b_name in enumerate(['B1', 'B2', 'B3', 'B4'], 1):\n        boundary_data = boundaries[b_name]\n        n = boundary_data['n']\n        stoich = boundary_data['stoich']\n        \n        max_nu_over_nF = 0\n        for species, nu in stoich.items():\n            # Consider only species with non-zero Gibbs free energy of formation\n            if G_f.get(species, 0) != 0:\n                current_sens = abs(nu) / (n * F)\n                if current_sens > max_nu_over_nF:\n                    max_nu_over_nF = current_sens\n        \n        sensitivities[b_idx] = max_nu_over_nF\n        \n    most_sensitive_boundary_index = max(sensitivities, key=sensitivities.get)\n\n    # Prepare final output list\n    # Format potentials to 3 decimal places\n    formatted_potentials = [f\"{p:.3f}\" for p in all_potentials]\n    \n    # Combine results\n    final_results = formatted_potentials + [str(most_sensitive_boundary_index)]\n\n    # Print in the required format\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "3480104"}, {"introduction": "为了从第一性原理构建普尔贝图，我们需要一种方法将密度泛函理论（DFT）计算的总能量与电化学环境联系起来。计算氢电极（Computational Hydrogen Electrode, CHE）模型提供了这一关键的桥梁。本练习 [@problem_id:3480091] 将指导您计算一个基本表面反应的自由能变化，演示在给定的电极电势 $U$ 和 $\\mathrm{pH}$ 值下，如何确定一个质子-电子对的化学势。", "problem": "金属氧化物表面上的单个氢吸附步骤可以写为半反应 $* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$，其中 $*$ 表示一个空的表面位点。仅从以化学势表示的反应自由能的定义以及氢氧化还原电对的平衡条件出发，使用计算氢电极 (Computational Hydrogen Electrode, CHE) 形式化方法，推导在有限电极电势和酸度下该质子-电子转移的电化学自由能变化表达式。然后根据第一性原理的输入数据进行数值计算。\n\n假设在温度 $T = 298.15$ K 下，通过密度泛函理论 (Density Functional Theory, DFT) 获得一个表面晶胞的以下数据：\n- 总能量：$E_{\\mathrm{DFT}}(*) = -385.000$ eV, $E_{\\mathrm{DFT}}(*\\mathrm{H}) = -388.750$ eV, $E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) = -7.000$ eV。\n- 有限温度自由能校正（吸附物的零点能加热振动贡献；1 bar下 $\\mathrm{H}_{2}$ 的表格化零点能加熵校正）：$\\Delta G_{\\mathrm{corr}}(*) = 0.000$ eV, $\\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) = 0.290$ eV, $\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) = -0.160$ eV。\n\n设电极电势相对于标准氢电极 (Standard Hydrogen Electrode, SHE) 为 $U = -0.200$ V，酸度为 $\\mathrm{pH} = 3$。使用玻尔兹曼常数 $k_{B} = 8.617333262145 \\times 10^{-5}$ eV K$^{-1}$ 和数学常数 $\\ln 10$。将基本电荷 $e$ 隐式处理，使得以电子伏特为单位的 $eU$ 在数值上等于以伏特为单位的 $U$。\n\n以电子伏特为单位表示 $* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$ 的最终反应自由能。将您的答案四舍五入至四位有效数字。", "solution": "该问题要求推导表面上单个氢吸附步骤的电化学自由能变化 $\\Delta G$，并随后进行数值计算。该反应由下式给出：\n$$* + (\\mathrm{H}^{+} + e^{-}) \\rightarrow *\\mathrm{H}$$\n其中 $*$ 代表一个空的表面位点，而 $*\\mathrm{H}$ 代表吸附在该位点上的一个氢原子。\n\n推导从反应自由能的基本定义开始，即产物和反应物的化学势 ($\\mu$) 之差：\n$$ \\Delta G = \\mu_{*\\mathrm{H}} - (\\mu_{*} + \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}}) $$\n\n在计算材料科学中，表面物种（裸位点 $*$ 和吸附氢的位点 $*\\mathrm{H}$）的化学势近似于其吉布斯自由能 ($G$)。吉布斯自由能通过将有限温度自由能校正 $\\Delta G_{\\mathrm{corr}}$ 加到从密度泛函理论 (Density Functional Theory, DFT) 获得的总能量 $E_{\\mathrm{DFT}}$ 上来计算。\n$$ \\mu_{*} \\approx G_{*} = E_{\\mathrm{DFT}}(*) + \\Delta G_{\\mathrm{corr}}(*) $$\n$$ \\mu_{*\\mathrm{H}} \\approx G_{*\\mathrm{H}} = E_{\\mathrm{DFT}}(*\\mathrm{H}) + \\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) $$\n\n主要挑战在于确定电化学环境中质子-电子对的化学势 $\\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}}$。计算氢电极 (Computational Hydrogen Electrode, CHE) 形式化方法为此提供了一个可靠的方法。CHE 模型通过考虑析氢/氧化反应的平衡，将 $(\\mathrm{H}^{+} + e^{-})$ 对的化学势与气态氢 $\\mathrm{H}_{2}$ 的化学势联系起来：\n$$ \\mathrm{H}^{+} + e^{-} \\leftrightarrow \\frac{1}{2} \\mathrm{H}_{2}(\\mathrm{g}) $$\n根据标准氢电极 (Standard Hydrogen Electrode, SHE) 的定义，在标准条件下，该反应处于平衡状态：电极电势 $U = 0$ V (相对于SHE)，酸度 $\\mathrm{pH} = 0$（对应于质子活度 $a_{\\mathrm{H}^{+}} = 1$），氢气压力 $p_{\\mathrm{H}_{2}} = 1$ bar，在给定温度 $T$ 下。在平衡状态下，反应物和产物的化学势相等。因此，在标准条件下：\n$$ \\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0) = \\frac{1}{2}\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} $$\n标准条件下氢气的化学势 $\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ}$ 的计算方法与表面物种类似：\n$$ \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} = E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) + \\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) $$\n因此，在标准条件下：\n$$ \\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0) = \\frac{1}{2} \\left[ E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) + \\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) \\right] $$\n\n现在，我们引入非标准电极电势 $U$ 和酸度 $\\mathrm{pH}$ 的影响。\n相对于 SHE，在电势 $U$ 下，一个电子的化学势会移动 $-eU$，其中 $e$ 是基本电荷：\n$$ \\mu_{e^{-}}(U) = \\mu_{e^{-}}(U=0) - eU $$\n质子的化学势取决于其活度 $a_{\\mathrm{H}^{+}}$：\n$$ \\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} + k_{B} T \\ln(a_{\\mathrm{H}^{+}}) $$\n使用酸度的定义 $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$，我们可以写作 $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}} = \\exp(-\\mathrm{pH} \\ln 10)$。将此代入 $\\mu_{\\mathrm{H}^{+}}$ 的表达式得到：\n$$ \\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} - k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\n结合这些项，在任意 $U$ 和 $\\mathrm{pH}$ 下，$(\\mathrm{H}^{+} + e^{-})$ 对的化学势为：\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = (\\mu_{\\mathrm{H}^{+}}^{\\circ} + k_{B} T \\ln(a_{\\mathrm{H}^{+}})) + (\\mu_{e^{-}}(U=0) - eU) $$\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = (\\mu_{\\mathrm{H}^{+}}^{\\circ} + \\mu_{e^{-}}(U=0)) - eU + k_{B} T \\ln(a_{\\mathrm{H}^{+}}) $$\n代入 CHE 平衡条件和 $a_{\\mathrm{H}^{+}}$ 的表达式：\n$$ \\mu_{\\mathrm{H}^{+}} + \\mu_{e^{-}} = \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} - eU - k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\n最后，我们将此表达式代回反应自由能 $\\Delta G$ 的原始方程：\n$$ \\Delta G = (\\mu_{*\\mathrm{H}} - \\mu_{*}) - \\left( \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} - eU - k_{B} T \\ln(10) \\cdot \\mathrm{pH} \\right) $$\n重新整理各项，我们得到：\n$$ \\Delta G = \\left( \\mu_{*\\mathrm{H}} - \\mu_{*} - \\frac{1}{2} \\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} \\right) + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n括号中的项是在标准条件下从气态 $\\mathrm{H}_{2}$ 吸附氢的吉布斯自由能，通常表示为 $\\Delta G_{*\\mathrm{H}}^{\\circ}$：\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = (\\mu_{*\\mathrm{H}} - \\mu_{*}) - \\frac{1}{2}\\mu_{\\mathrm{H}_{2}(\\text{g})}^{\\circ} $$\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = \\left[E_{\\mathrm{DFT}}(*\\mathrm{H}) - E_{\\mathrm{DFT}}(*) - \\frac{1}{2}E_{\\mathrm{DFT}}(\\mathrm{H}_{2})\\right] + \\left[\\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) - \\Delta G_{\\mathrm{corr}}(*) - \\frac{1}{2}\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2})\\right] $$\n因此，电化学自由能变化的最终表达式为：\n$$ \\Delta G(U, \\mathrm{pH}) = \\Delta G_{*\\mathrm{H}}^{\\circ} + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n\n现在，我们使用所提供的数据对该表达式进行数值计算。\n问题指明，将基本电荷 $e$ 处理为使得以电子伏特 (eV) 为单位的 $eU$ 在数值上等于以伏特 (V) 为单位的 $U$。\n\n首先，我们计算 $\\Delta G_{*\\mathrm{H}}^{\\circ}$ 的 DFT 能量贡献，即吸附能 $\\Delta E_{\\text{ads}}$：\n$$ \\Delta E_{\\text{ads}} = E_{\\mathrm{DFT}}(*\\mathrm{H}) - E_{\\mathrm{DFT}}(*) - \\frac{1}{2}E_{\\mathrm{DFT}}(\\mathrm{H}_{2}) $$\n$$ \\Delta E_{\\text{ads}} = -388.750 \\, \\text{eV} - (-385.000 \\, \\text{eV}) - \\frac{1}{2}(-7.000 \\, \\text{eV}) $$\n$$ \\Delta E_{\\text{ads}} = (-388.750 + 385.000 + 3.500) \\, \\text{eV} = -0.250 \\, \\text{eV} $$\n\n其次，我们计算自由能校正贡献 $\\Delta(\\Delta G_{\\mathrm{corr}})$：\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = \\Delta G_{\\mathrm{corr}}(*\\mathrm{H}) - \\Delta G_{\\mathrm{corr}}(*) - \\frac{1}{2}\\Delta G_{\\mathrm{corr}}(\\mathrm{H}_{2}) $$\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = 0.290 \\, \\text{eV} - 0.000 \\, \\text{eV} - \\frac{1}{2}(-0.160 \\, \\text{eV}) $$\n$$ \\Delta(\\Delta G_{\\mathrm{corr}}) = (0.290 + 0.080) \\, \\text{eV} = 0.370 \\, \\text{eV} $$\n\n第三，我们计算 $\\Delta G_{*\\mathrm{H}}^{\\circ}$：\n$$ \\Delta G_{*\\mathrm{H}}^{\\circ} = \\Delta E_{\\text{ads}} + \\Delta(\\Delta G_{\\mathrm{corr}}) = -0.250 \\, \\text{eV} + 0.370 \\, \\text{eV} = 0.120 \\, \\text{eV} $$\n\n第四，我们计算与电势和 pH 相关的项。\n与电势相关的项是 $eU$。给定 $U = -0.200$ V，此项为：\n$$ eU = -0.200 \\, \\text{eV} $$\n与 pH 相关的项是 $k_{B} T \\ln(10) \\cdot \\mathrm{pH}$。给定 $T = 298.15$ K, $k_B=8.617333262145 \\times 10^{-5}$ eV K$^{-1}$，以及 $\\mathrm{pH} = 3$：\n$$ k_{B} T \\ln(10) \\cdot \\mathrm{pH} = (8.617333262145 \\times 10^{-5} \\, \\text{eV K}^{-1})(298.15 \\, \\text{K})(\\ln 10)(3) $$\n$$ k_{B} T \\ln(10) \\cdot \\mathrm{pH} \\approx (0.02569256 \\, \\text{eV})(2.302585)(3) \\approx 0.177479 \\, \\text{eV} $$\n\n最后，我们将所有分量相加，求得总反应自由能 $\\Delta G$：\n$$ \\Delta G = \\Delta G_{*\\mathrm{H}}^{\\circ} + eU + k_{B} T \\ln(10) \\cdot \\mathrm{pH} $$\n$$ \\Delta G \\approx 0.120 \\, \\text{eV} + (-0.200 \\, \\text{eV}) + 0.177479 \\, \\text{eV} $$\n$$ \\Delta G \\approx 0.097479 \\, \\text{eV} $$\n\n将最终结果四舍五入至四位有效数字，我们得到：\n$$ \\Delta G \\approx 0.09748 \\, \\text{eV} $$", "answer": "$$\n\\boxed{0.09748}\n$$", "id": "3480091"}, {"introduction": "最后的这项练习将前面练习中的原理整合到一个完整的计算工作流程中。您将开发一个程序，该程序能直接从第一性原理数据自动生成电势-$\\mathrm{pH}$ 平衡线。这项任务 [@problem_id:3480020] 是本章概念的实际应用，让您具备从头开始为新材料体系构建普尔贝图的技能。", "problem": "您的任务是编写一个完整、可运行的程序，该程序实现一个基于第一性原理热力学的、有原则的计算工作流程，用以构建 Pourbaix（电位-pH）图的电化学反应线。该程序必须接收由密度泛函理论 (DFT) 总能量、热化学修正和溶液活度组成的数据，然后组合候选反应并计算其对应的 $E$–$\\mathrm{pH}$ 线方程。该工作流程必须基于电化学反应的平衡条件以及化学势的热力学定义。推导必须从以下基础开始：\n- 反应的吉布斯自由能变化满足 $\\Delta G = \\Delta G^{\\circ} + R T \\ln Q$，其中 $R$ 是气体常数，$T$ 是绝对温度，$Q$ 是由物种活度构成的反应商，而 $\\Delta G^{\\circ}$ 是从标准化学势计算出的标准吉布斯自由能变化。\n- 物种 $i$ 的化学势为 $\\mu_i = \\mu_i^{\\circ} + R T \\ln a_i$，其中 $a_i$ 是物种 $i$ 的活度。\n- 电子的电化学势为 $\\mu_e = - F E$，其中 $F$ 是法拉第常数，$E$ 是相对于标准氢电极 (SHE) 的电极电位。\n- 将平衡电位与反应热力学联系起来的 Nernst 关系式为 $E = - \\Delta G^{\\circ} / (n F) - (R T / (n F)) \\ln Q$，其中 $n$ 是反应中转移的电子数。\n\n您必须实现以下科学上真实且自洽的模型假设：\n1. 凝聚相和分子的标准化学势是根据 DFT 能量加上指定温度下的热化学修正计算得出。对于物种 $i$，使用 $\\mu_i^{\\circ}(T) = E_i^{\\mathrm{DFT}} + \\Delta_i^{\\mathrm{corr}}(T)$，单位为每个化学式单位的电子伏特。您的程序代码必须使用 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$ 和亚佛加德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$ 将电子伏特转换为焦耳/摩尔。\n2. 使用计算氢电极 (Computational Hydrogen Electrode, CHE) 惯例，以避免需要明确的 $\\mu_{\\mathrm{H^+}}^{\\circ}$：在相对于标准氢电极 $E = 0$ 且 $\\mathrm{pH} = 0$ 时，$\\mu_{\\mathrm{H^+}}^{\\circ} + \\mu_e^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。由于在 $E = 0$ 时 $\\mu_e^{\\circ} = 0$，这就设定了在计算 $\\Delta G^{\\circ}$ 时 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。\n3. 对于活度，设定 $a_{\\mathrm{H_2O}} = 1$（纯液体）和在 $1\\,\\mathrm{bar}$ 时 $a_{\\mathrm{H_2}} = 1$；对于水溶液中的离子，使用提供的活度 $a_i$ 作为输入；对于固体，将活度设定为 $1$。\n\n您的程序必须从提供的相和能量中组合出以下类型的候选反应：\n- 两种金属氧化物之间通过水耦合的氧交换，其氧数差为 $\\Delta O$：对于具有相同金属化学计量和氧数 $O_A$ 和 $O_B$ 的固体 $A$ 和 $B$，定义 $\\Delta O = O_B - O_A$。若 $\\Delta O > 0$，构建氧化半反应 $A + \\Delta O\\,\\mathrm{H_2O} \\rightarrow B + 2 \\Delta O\\,\\mathrm{H^+} + 2 \\Delta O\\, e^-$。若 $\\Delta O < 0$，构建相应的还原半反应 $A + 2 (-\\Delta O)\\,\\mathrm{H^+} + 2 (-\\Delta O)\\, e^- \\rightarrow B + (-\\Delta O)\\,\\mathrm{H_2O}$。这些反应有 $n = 2 \\lvert \\Delta O \\rvert$ 个电子和净质子化学计量 $s_{\\mathrm{H}} = \\nu_{\\mathrm{H^+}}^{\\mathrm{products}} - \\nu_{\\mathrm{H^+}}^{\\mathrm{reactants}} = \\pm 2 \\lvert \\Delta O \\rvert$。\n- 金属溶解为水合阳离子：$M \\rightarrow M^{2+} + 2 e^-$，此反应有 $n = 2$ 且 $s_{\\mathrm{H}} = 0$。\n\n给定一个反应，将排除 $\\mathrm{H^+}$ 活度的反应商定义为 $Q_{\\mathrm{nonH}}$，其由所有非质子物种的活度，根据常规的产物除以反应物的惯例及化学计量次方构成。将 $E$–$\\mathrm{pH}$ 线写为 $E(\\mathrm{pH}) = b + m \\,\\mathrm{pH}$，其中截距为 $b$，斜率为 $m$：\n- $b = - \\Delta G^{\\circ} / (n F) - (R T / (n F)) \\ln Q_{\\mathrm{nonH}}$，\n- $m = (R T / (n F))\\, s_{\\mathrm{H}} \\ln 10$，使用 $\\ln a_{\\mathrm{H^+}} = - \\mathrm{pH} \\ln 10$。\n\n您的程序必须实现上述内容，为每个测试反应计算 $b$ 和 $m$，然后在指定的 $\\mathrm{pH}$ 值下评估 $E(\\mathrm{pH})$。\n\n使用的常数：\n- $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，\n- $F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$，\n- $T = 298.15\\,\\mathrm{K}$。\n\n物种数据（所有能量和修正均以每个化学式单位的电子伏特给出；您的程序必须在内部将其转换为焦耳/摩尔）：\n- 固态金属 $M$：$E_M^{\\mathrm{DFT}} = -6.00$，$\\Delta_M^{\\mathrm{corr}} = +0.05$，\n- 氧化物 $MO$：$E_{MO}^{\\mathrm{DFT}} = -12.50$，$\\Delta_{MO}^{\\mathrm{corr}} = +0.20$，\n- 氧化物 $MO_2$：$E_{MO_2}^{\\mathrm{DFT}} = -19.80$，$\\Delta_{MO_2}^{\\mathrm{corr}} = +0.30$，\n- 液态水 $\\mathrm{H_2O}$：$E_{\\mathrm{H_2O}}^{\\mathrm{DFT}} = -14.20$，$\\Delta_{\\mathrm{H_2O}}^{\\mathrm{corr}} = +0.56$，\n- 氢气 $\\mathrm{H_2}$：$E_{\\mathrm{H_2}}^{\\mathrm{DFT}} = -6.80$，$\\Delta_{\\mathrm{H_2}}^{\\mathrm{corr}} = +0.41$，\n- 水合阳离子 $M^{2+}$：$E_{M^{2+}}^{\\mathrm{DFT}} = -2.00$，溶剂化和热化学修正 $\\Delta_{M^{2+}}^{\\mathrm{corr}} = -4.00$（合并后，以电子伏特为单位得出总的 $\\mu_{M^{2+}}^{\\circ}$）。\n\n假设氧的化学计量为 $O_M = 0$，$O_{MO} = 1$，$O_{MO_2} = 2$。\n\n测试套组和所需输出：\n- 测试案例 1：反应 $R_1$：$M + \\mathrm{H_2O} \\rightarrow MO + 2 \\mathrm{H^+} + 2 e^-$，使用 $\\mathrm{pH} = 7$，$a_{M^{2+}}$ 不涉及。输出列表 $[m, b, E(7)]$，所有值以伏特为单位，$m$ 以伏特/pH 单位为单位。\n- 测试案例 2：反应 $R_2$：$MO + \\mathrm{H_2O} \\rightarrow MO_2 + 2 \\mathrm{H^+} + 2 e^-$，使用 $\\mathrm{pH} = 14$，$a_{M^{2+}}$ 不涉及。输出 $[m, b, E(14)]$。\n- 测试案例 3：反应 $R_3$：$MO + 2 \\mathrm{H^+} + 2 e^- \\rightarrow M + \\mathrm{H_2O}$，使用 $\\mathrm{pH} = 0$，$a_{M^{2+}}$ 不涉及。输出 $[m, b, E(0)]$。\n- 测试案例 4：反应 $R_4$：$M \\rightarrow M^{2+} + 2 e^-$，使用 $\\mathrm{pH} = 7$，$a_{M^{2+}} = 10^{-6}$。输出 $[m, b, E(7)]$。\n- 测试案例 5：再次使用反应 $R_4$，在 $\\mathrm{pH} = 7$ 下，但 $a_{M^{2+}} = 1$。输出 $[m, b, E(7)]$。\n\n您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，并用方括号括起来（例如，`[[m1,b1,E1],[m2,b2,E2],...]`）。所有电位以伏特表示，斜率以伏特/pH 单位表示。所有输出都必须是浮点数。程序代码必须是自包含的，且不需任何输入。", "solution": "计算工作流程的核心在于，将半反应的总电化学吉布斯自由能变化在平衡时设为零，并分离出标准化学势和活度的贡献。对于一个转移 $n$ 个电子的半反应，其电化学反应的平衡条件为 $\\sum_i \\nu_i \\mu_i + n \\mu_e = 0$，其中 $\\nu_i$ 是物种 $i$ 的化学计量系数（惯例上产物为正，反应物为负），$\\mu_i$ 是物种 $i$ 的化学势，而 $\\mu_e$ 是电子的电化学势。使用 $\\mu_i = \\mu_i^{\\circ} + R T \\ln a_i$ 和 $\\mu_e = - F E$，我们可以写出\n$$\n\\sum_i \\nu_i \\mu_i^{\\circ} + R T \\sum_i \\nu_i \\ln a_i - n F E = 0.\n$$\n将标准态项 $\\sum_i \\nu_i \\mu_i^{\\circ} \\equiv \\Delta G^{\\circ}$ 和活度衍生项 $R T \\sum_i \\nu_i \\ln a_i \\equiv R T \\ln Q$ 集合起来，并辨识出能斯特关系，我们得到\n$$\nE = - \\frac{\\Delta G^{\\circ}}{n F} - \\frac{R T}{n F} \\ln Q.\n$$\n为了分离出对 $\\mathrm{pH}$ 的依赖性，将反应商分为质子和非质子贡献：$\\ln Q = \\ln Q_{\\mathrm{nonH}} + s_{\\mathrm{H}} \\ln a_{\\mathrm{H^+}}$，其中 $s_{\\mathrm{H}} = \\nu_{\\mathrm{H^+}}^{\\mathrm{products}} - \\nu_{\\mathrm{H^+}}^{\\mathrm{reactants}}$ 是出现在商中的 $\\mathrm{H^+}$ 的净化学计量系数，且 $\\ln a_{\\mathrm{H^+}} = - \\mathrm{pH} \\ln 10$。因此，电位可以写成 $\\mathrm{pH}$ 的线性方程式：\n$$\nE(\\mathrm{pH}) = \\left[ - \\frac{\\Delta G^{\\circ}}{n F} - \\frac{R T}{n F} \\ln Q_{\\mathrm{nonH}} \\right] + \\left( \\frac{R T}{n F} s_{\\mathrm{H}} \\ln 10 \\right) \\mathrm{pH} \\equiv b + m\\,\\mathrm{pH},\n$$\n其截距为 $b = - \\Delta G^{\\circ} /(n F) - (R T /(n F)) \\ln Q_{\\mathrm{nonH}}$，斜率为 $m = (R T /(n F)) s_{\\mathrm{H}} \\ln 10$。$m$ 的符号由 $s_{\\mathrm{H}}$ 决定：如果质子是净产物，$s_{\\mathrm{H}} > 0$ 且 $m > 0$；如果质子是净反应物，$s_{\\mathrm{H}} < 0$ 且 $m < 0$；如果没有质子出现，$s_{\\mathrm{H}} = 0$ 且 $m = 0$。\n\n标准态吉布斯自由能 $\\mu_i^{\\circ}$ 是从第一性原理计算得出的，公式为 $\\mu_i^{\\circ}(T) = E_i^{\\mathrm{DFT}} + \\Delta_i^{\\mathrm{corr}}(T)$，使用了在温度 $T$ 下的 DFT 总能量和热化学修正。由于输入是以每个化学式单位的电子伏特给出，程序代码必须通过 $1\\,\\mathrm{eV}/\\text{formula unit} \\mapsto (1.602176634 \\times 10^{-19}\\,\\mathrm{J}) \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}) \\approx 96485.33212\\,\\mathrm{J/mol}$ 转换为焦耳/摩尔。计算氢电极 (CHE) 惯例通过在 $E = 0$ 和 $\\mathrm{pH} = 0$ 时强制与氢气达到平衡来设定质子的标准化学势，而无需直接进行 DFT 评估：$\\mu_{\\mathrm{H^+}}^{\\circ} + \\mu_e^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$ 且 $\\mu_e^{\\circ} = 0$，从而得出 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。此惯例允许完全根据所提供的固体和分子的基于 DFT 的能量来计算 $\\Delta G^{\\circ}$。\n\n反应的组合遵循基于物理的、通过水进行氧交换的化学计量：\n- 对于氧数为 $O_A$ 和 $O_B$ 的固体 $A$ 和 $B$，定义 $\\Delta O = O_B - O_A$。若 $\\Delta O > 0$，构建 $A + \\Delta O\\,\\mathrm{H_2O} \\rightarrow B + 2\\Delta O\\,\\mathrm{H^+} + 2\\Delta O\\,e^-$，其中 $n = 2 \\Delta O$ 且 $s_{\\mathrm{H}} = + 2 \\Delta O$。若 $\\Delta O < 0$，构建 $A + 2 (-\\Delta O)\\,\\mathrm{H^+} + 2 (-\\Delta O)\\,e^- \\rightarrow B + (-\\Delta O)\\,\\mathrm{H_2O}$，其中 $n = 2 (-\\Delta O)$ 且 $s_{\\mathrm{H}} = - 2 (-\\Delta O)$。\n- 对于金属溶解，$M \\rightarrow M^{2+} + 2 e^-$，我们有 $n = 2$ 且 $s_{\\mathrm{H}} = 0$。\n\n标准反应自由能计算如下：\n$$\n\\Delta G^{\\circ} = \\sum_{i \\in \\text{products}} \\nu_i \\mu_i^{\\circ} - \\sum_{j \\in \\text{reactants}} \\nu_j \\mu_j^{\\circ},\n$$\n在适用时包含 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。非质子反应商为：\n$$\n\\ln Q_{\\mathrm{nonH}} = \\sum_{i \\in \\text{products, } i \\neq \\mathrm{H^+}} \\nu_i \\ln a_i - \\sum_{j \\in \\text{reactants, } j \\neq \\mathrm{H^+}} \\nu_j \\ln a_j,\n$$\n其中固体和纯液体的活度 $a_i$ 为 $1$，在 $1\\,\\mathrm{bar}$ 时 $\\mathrm{H_2}$ 的活度为 $1$，水合离子使用所提供的值。\n\n算法步骤：\n1. 解析物种数据并计算所有物种的 $\\mu_i^{\\circ}$（单位为电子伏特），然后转换为焦耳/摩尔。\n2. 使用 CHE 惯例设定 $\\mu_{\\mathrm{H^+}}^{\\circ} = \\frac{1}{2} \\mu_{\\mathrm{H_2}}^{\\circ}$。\n3. 组合反应：\n   - $R_1$：$M + \\mathrm{H_2O} \\rightarrow MO + 2 \\mathrm{H^+} + 2 e^-$，其中 $n = 2$，$s_{\\mathrm{H}} = +2$。\n   - $R_2$：$MO + \\mathrm{H_2O} \\rightarrow MO_2 + 2 \\mathrm{H^+} + 2 e^-$，其中 $n = 2$，$s_{\\mathrm{H}} = +2$。\n   - $R_3$：$MO + 2 \\mathrm{H^+} + 2 e^- \\rightarrow M + \\mathrm{H_2O}$，其中 $n = 2$，$s_{\\mathrm{H}} = -2$。\n   - $R_4$：$M \\rightarrow M^{2+} + 2 e^-$，其中 $n = 2$，$s_{\\mathrm{H}} = 0$。\n4. 对于每个反应，从化学计量总和中计算 $\\Delta G^{\\circ}$（单位为焦耳/摩尔），从活度图中计算 $\\ln Q_{\\mathrm{nonH}}$，并透过 $b = - \\Delta G^{\\circ} /(n F) - (R T /(n F)) \\ln Q_{\\mathrm{nonH}}$ 和 $m = (R T /(n F))\\, s_{\\mathrm{H}} \\ln 10$ 形成 $b$ 和 $m$。\n5. 对于每个测试案例，在指定的 $\\mathrm{pH}$ 值下评估 $E(\\mathrm{pH}) = b + m\\,\\mathrm{pH}$。\n6. 按照所需格式将结果输出为单行。\n\n值得注意的是，在 $T = 298.15\\,\\mathrm{K}$ 时，有 $(R T / F) \\approx 0.025693\\,\\mathrm{V}$ 和 $(R T / F)\\ln 10 \\approx 0.05916\\,\\mathrm{V}$。因此，对于水耦合反应，其中 $s_{\\mathrm{H}} = \\pm 2$ 且 $n = 2$，斜率的绝对值约为每 pH 单位 $0.05916\\,\\mathrm{V}$，其符号由质子是产生还是消耗决定。溶解反应的 $m = 0$，其截距会随着水合阳离子活度通过 $-(R T /(n F)) \\ln a_{M^{2+}}$ 而移动。\n\n该程序实现了这些步骤，并产生以伏特为单位的浮点数输出，斜率以伏特/pH 单位表示，并按照规范汇总到一个单一的方括号列表中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Physical constants\n    R = 8.314462618  # J/mol/K\n    F = 96485.33212  # C/mol\n    T = 298.15       # K\n    LN10 = np.log(10.0)\n\n    # Conversion: 1 eV per formula unit -> J/mol\n    EV_TO_J_PER_MOL = 1.602176634e-19 * 6.02214076e23  # ~96485.33212 J/mol\n\n    # Species standard chemical potentials (mu^0) in eV per formula unit\n    # DFT energies + corrections\n    species_mu0_eV = {\n        \"M(s)\": -6.00 + 0.05,          # -5.95 eV\n        \"MO(s)\": -12.50 + 0.20,        # -12.30 eV\n        \"MO2(s)\": -19.80 + 0.30,       # -19.50 eV\n        \"H2O(l)\": -14.20 + 0.56,       # -13.64 eV\n        \"H2(g)\": -6.80 + 0.41,         # -6.39 eV\n        \"M2+(aq)\": -2.00 + (-4.00),    # -6.00 eV\n        # H+(aq) is set via CHE below\n    }\n\n    # CHE convention: mu^0(H+) = 0.5 * mu^0(H2)\n    species_mu0_eV[\"H+(aq)\"] = 0.5 * species_mu0_eV[\"H2(g)\"]\n\n    # Convert to J/mol\n    species_mu0_Jmol = {k: v * EV_TO_J_PER_MOL for k, v in species_mu0_eV.items()}\n\n    # Activities (defaults; solids and pure liquids have activity 1)\n    default_activities = {\n        \"M(s)\": 1.0,\n        \"MO(s)\": 1.0,\n        \"MO2(s)\": 1.0,\n        \"H2O(l)\": 1.0,\n        \"H2(g)\": 1.0,\n        \"H+(aq)\": None,   # handled via pH\n        \"M2+(aq)\": None,  # set per test case where relevant\n    }\n\n    # Reaction representation: dict with reactants/products lists of (species, coeff),\n    # electron count n, and net proton coefficient s_H = nu_H+_prod - nu_H+_react.\n    def reaction(name, reactants, products, n):\n        # Compute s_H from stoichiometry\n        def coeff_in(side):\n            for sp, nu in side:\n                if sp == \"H+(aq)\":\n                    return nu\n            return 0.0\n        s_H = coeff_in(products) - coeff_in(reactants)\n        return {\"name\": name, \"reactants\": reactants, \"products\": products, \"n\": n, \"s_H\": s_H}\n\n    # Assemble the specific test reactions\n    # R1: M + H2O -> MO + 2 H+ + 2 e-\n    R1 = reaction(\n        \"R1\",\n        reactants=[(\"M(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        products=[(\"MO(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        n=2\n    )\n    # R2: MO + H2O -> MO2 + 2 H+ + 2 e-\n    R2 = reaction(\n        \"R2\",\n        reactants=[(\"MO(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        products=[(\"MO2(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        n=2\n    )\n    # R3: MO + 2 H+ + 2 e- -> M + H2O\n    R3 = reaction(\n        \"R3\",\n        reactants=[(\"MO(s)\", 1.0), (\"H+(aq)\", 2.0)],\n        products=[(\"M(s)\", 1.0), (\"H2O(l)\", 1.0)],\n        n=2\n    )\n    # R4: M -> M2+ + 2 e-\n    R4 = reaction(\n        \"R4\",\n        reactants=[(\"M(s)\", 1.0)],\n        products=[(\"M2+(aq)\", 1.0)],\n        n=2\n    )\n\n    reactions = {\"R1\": R1, \"R2\": R2, \"R3\": R3, \"R4\": R4}\n\n    # Compute Delta G^0 (J/mol) and ln Q_nonH for a given reaction given activities\n    def compute_deltaG0_and_lnQ_nonH(rx, activities):\n        # Sum mu^0 for products and reactants\n        G_products = 0.0\n        G_reactants = 0.0\n        for sp, nu in rx[\"products\"]:\n            mu0 = species_mu0_Jmol[sp]\n            G_products += nu * mu0\n        for sp, nu in rx[\"reactants\"]:\n            mu0 = species_mu0_Jmol[sp]\n            G_reactants += nu * mu0\n        deltaG0 = G_products - G_reactants  # J/mol\n\n        # ln Q excluding H+; solids and pure liquids default to activity 1\n        lnQ_nonH = 0.0\n        # Products\n        for sp, nu in rx[\"products\"]:\n            if sp == \"H+(aq)\":\n                continue\n            a = activities.get(sp, default_activities.get(sp, 1.0))\n            if a is None:\n                # If not specified, treat as unity activity\n                a = 1.0\n            lnQ_nonH += nu * np.log(a)\n        # Reactants\n        for sp, nu in rx[\"reactants\"]:\n            if sp == \"H+(aq)\":\n                continue\n            a = activities.get(sp, default_activities.get(sp, 1.0))\n            if a is None:\n                a = 1.0\n            lnQ_nonH -= nu * np.log(a)\n\n        return deltaG0, lnQ_nonH\n\n    # Compute line parameters (slope m and intercept b) and E at given pH\n    def compute_line(rx, pH, activities):\n        deltaG0, lnQ_nonH = compute_deltaG0_and_lnQ_nonH(rx, activities)\n        n = rx[\"n\"]\n        s_H = rx[\"s_H\"]\n        # Intercept and slope\n        b = - deltaG0 / (n * F) - (R * T / (n * F)) * lnQ_nonH\n        m = (R * T / (n * F)) * s_H * LN10\n        E_pH = b + m * pH\n        return m, b, E_pH\n\n    # Define test cases: (reaction_key, pH, activity overrides)\n    test_cases = [\n        (\"R1\", 7.0, {}),                      # R1 at pH 7\n        (\"R2\", 14.0, {}),                     # R2 at pH 14\n        (\"R3\", 0.0, {}),                      # R3 at pH 0\n        (\"R4\", 7.0, {\"M2+(aq)\": 1e-6}),       # R4 at pH 7, trace cation activity\n        (\"R4\", 7.0, {\"M2+(aq)\": 1.0}),        # R4 at pH 7, unit cation activity\n    ]\n\n    results = []\n    for key, pH, acts in test_cases:\n        rx = reactions[key]\n        m, b, E_pH = compute_line(rx, pH, acts)\n        results.append([m, b, E_pH])\n\n    # Final print statement in the exact required format.\n    # Ensure pure Python float serialization without extra text.\n    def format_list(lst):\n        return \"[\" + \",\".join(map(lambda x: str(x), lst)) + \"]\"\n    print(\"[\" + \",\".join(format_list(res) for res in results) + \"]\")\n\nsolve()\n```", "id": "3480020"}]}