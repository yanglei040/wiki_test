{"hands_on_practices": [{"introduction": "表面能是理解和预测材料表面行为的核心物理量。在计算材料科学中，平板模型（slab model）是计算表面能最常用的方法。这个练习将指导你完成一个基础但至关重要的计算：从密度泛函理论（DFT）得到的总能量中提取表面能 $\\gamma$，并对计算中固有的有限尺寸效应进行初步修正。通过这个实践 [@problem_id:3490960]，你将掌握表面能计算的基本公式，并初步认识到获得精确结果所面临的挑战。", "problem": "我们使用密度泛函理论（DFT）对一个对称的晶体材料板层进行建模。该板层包含 $N$ 个原子，具有两个面积均为 $A$ 的等效表面，表面之间由厚度为 $L_{\\mathrm{vac}}$ 的真空层隔开。在零温下，板层的总能量为 $E_{\\mathrm{slab}}$，每个原子的体相参考能量为 $E_{\\mathrm{bulk}}$。假设对于所选的晶胞，DFT总能量等于零压下的内能。\n\n从零温下表面过剩自由能（即从体相材料中创造单位面积表面所需的可逆功）的定义出发，并假设对称板层的体相和表面贡献具有可加性，请推导出一个用 $E_{\\mathrm{slab}}$、$E_{\\mathrm{bulk}}$、$N$ 和 $A$ 表示的表面能 $\\gamma$ 的可计算表达式。使用此表达式，并通过下述偏差模型修正有限板层厚度和有限真空尺寸带来的影响，计算半无限表面能 $\\gamma_{\\infty}$ 的最佳估计值。\n\n使用以下数据：\n- $E_{\\mathrm{bulk}} = -5.432 \\ \\mathrm{eV/}$原子，\n- $E_{\\mathrm{slab}} = -636.234 \\ \\mathrm{eV}$，\n- $N = 120$，\n- $A = 100 \\ \\text{\\AA}^{2}$ （每个表面），\n- $L_{\\mathrm{vac}} = 15 \\ \\text{\\AA}$，\n- 计算得到的有限尺寸表面能 $\\gamma(N,L_{\\mathrm{vac}})$ 相对于半无限值 $\\gamma_{\\infty}$ 存在偏差，偏差量为以下两个正偏差项之和：\n  $$\\delta_{t}(N) = C_{t} \\exp\\!\\left(-\\frac{N}{\\xi}\\right), \\quad \\delta_{v}(L_{\\mathrm{vac}}) = C_{v} \\exp\\!\\left(-\\frac{L_{\\mathrm{vac}}}{\\lambda}\\right),$$\n  其中 $C_{t} = 0.12 \\ \\mathrm{J/m^{2}}$，$\\xi = 30$，$C_{v} = 0.25 \\ \\mathrm{J/m^{2}}$，$\\lambda = 5 \\ \\text{\\AA}$。\n\n单位转换常数：\n- $1 \\ \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\ \\mathrm{J}$，\n- $1 \\ \\text{\\AA}^{2} = 1 \\times 10^{-20} \\ \\mathrm{m}^{2}$。\n\n任务：\n1. 根据上述第一性原理，推导 $\\gamma(N,L_{\\mathrm{vac}})$ 的公式。\n2. 根据提供的DFT能量计算 $\\gamma(N,L_{\\mathrm{vac}})$，并将结果转换为 $\\mathrm{J/m^{2}}$。\n3. 使用偏差模型，通过移除有限尺寸偏差来计算 $\\gamma_{\\infty}$。\n4. 在你的推理中，通过量化 $\\delta_{t}(N)$ 和 $\\delta_{v}(L_{\\mathrm{vac}})$ 各自的贡献来分析误差预算，并评论对于给定的设置，哪个误差来源占主导地位。\n\n你的答案只需提供 $\\gamma_{\\infty}$ 的最终最佳估计值。将你的答案四舍五入到四位有效数字。以 $\\mathrm{J/m^{2}}$ 为单位表示最终结果（在最终方框内的数字中不要包含单位）。", "solution": "该问题提法恰当且科学上合理，描述了在计算材料科学中通过第一性原理计算确定表面能的标准流程。因此，我们可以开始解题。\n\n该问题要求一步步地推导和计算半无限表面能 $\\gamma_{\\infty}$，并对板层计算中存在的有限尺寸效应进行修正。\n\n**1. 表面能公式的推导**\n\n表面能 $\\gamma$ 定义为表面相对于体相材料每单位面积的过剩自由能。在零温下，这等同于过剩内能。对于一个具有两个面积为 $A$ 的表面的对称板层模型，其总能量 $E_{\\mathrm{slab}}$ 被建模为体相中等量原子（$N$个）的能量与创造两个表面所需能量之和。\n\n在体相参考态中，$N$ 个原子的总能量由 $N E_{\\mathrm{bulk}}$ 给出。总的表面创造能是单位面积表面能 $\\gamma$、每个表面的面积 $A$ 以及表面数量（2）的乘积。因此，总的表面能为 $2A\\gamma$。\n\n基于可加性假设，我们可以将板层的总能量写为：\n$$E_{\\mathrm{slab}} = N E_{\\mathrm{bulk}} + 2A\\gamma$$\n这个方程描述了从一个包含 $N$ 个原子且真空层厚度为 $L_{\\mathrm{vac}}$ 的板层计算出的有限尺寸表面能，我们将其记为 $\\gamma(N, L_{\\mathrm{vac}})$。重新整理该方程以求解此量，可得到所需的可计算表达式：\n$$\\gamma(N, L_{\\mathrm{vac}}) = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2A}$$\n\n**2. 有限尺寸表面能的计算**\n\n我们从密度泛函理论（DFT）计算中得到以下数据：\n- 板层总能量: $E_{\\mathrm{slab}} = -636.234 \\ \\mathrm{eV}$\n- 每原子体相能量: $E_{\\mathrm{bulk}} = -5.432 \\ \\mathrm{eV/}$原子\n- 板层中的原子数: $N = 120$\n- 每个表面的面积: $A = 100 \\ \\text{\\AA}^{2}$\n\n首先，我们计算板层中的总过剩能量，即我们表达式中的分子部分：\n$$E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}} = -636.234 \\ \\mathrm{eV} - (120 \\times -5.432 \\ \\mathrm{eV})$$\n$$E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}} = -636.234 \\ \\mathrm{eV} - (-651.84 \\ \\mathrm{eV})$$\n$$E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}} = 15.606 \\ \\mathrm{eV}$$\n这个正值代表了创造两个表面的能量代价。两个表面的总面积是 $2A = 2 \\times 100 \\ \\text{\\AA}^{2} = 200 \\ \\text{\\AA}^{2}$。\n\n现在，我们计算以 $\\mathrm{eV/\\text{\\AA}^2}$ 为单位的 $\\gamma(N, L_{\\mathrm{vac}})$：\n$$\\gamma(N, L_{\\mathrm{vac}}) = \\frac{15.606 \\ \\mathrm{eV}}{200 \\ \\text{\\AA}^{2}} = 0.07803 \\ \\mathrm{eV/\\text{\\AA}^2}$$\n为了将其转换为国际单位制（SI）单位（$\\mathrm{J/m^2}$），我们使用所提供的转换因子：\n- $1 \\ \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\ \\mathrm{J}$\n- $1 \\ \\text{\\AA}^{2} = 1 \\times 10^{-20} \\ \\mathrm{m}^{2}$\n转换因子为：\n$$\\frac{1 \\ \\mathrm{eV}}{1 \\ \\text{\\AA}^2} = \\frac{1.602176634 \\times 10^{-19} \\ \\mathrm{J}}{1 \\times 10^{-20} \\ \\mathrm{m}^2} = 16.02176634 \\ \\mathrm{J/m^2}$$\n应用此转换：\n$$\\gamma(N, L_{\\mathrm{vac}}) = 0.07803 \\ \\mathrm{eV/\\text{\\AA}^2} \\times 16.02176634 \\ \\frac{\\mathrm{J/m^2}}{\\mathrm{eV/\\text{\\AA}^2}} \\approx 1.250167 \\ \\mathrm{J/m^2}$$\n\n**3. 半无限表面能的计算**\n\n由于板层的有限厚度和有限的真空层间距，计算出的值 $\\gamma(N, L_{\\mathrm{vac}})$ 存在偏差。问题提供了一个模型，其中观测到的表面能是真实的半无限值加上两个正的偏差项：\n$$\\gamma(N, L_{\\mathrm{vac}}) = \\gamma_{\\infty} + \\delta_{t}(N) + \\delta_{v}(L_{\\mathrm{vac}})$$\n因此，通过减去这些偏差可以找到半无限表面能的最佳估计值：\n$$\\gamma_{\\infty} = \\gamma(N, L_{\\mathrm{vac}}) - \\delta_{t}(N) - \\delta_{v}(L_{\\mathrm{vac}})$$\n\n首先，我们计算由有限板层厚度引起的偏差 $\\delta_{t}(N)$：\n$$\\delta_{t}(N) = C_{t} \\exp\\left(-\\frac{N}{\\xi}\\right)$$\n使用给定的参数 $C_{t} = 0.12 \\ \\mathrm{J/m^{2}}$，$N = 120$ 和 $\\xi = 30$：\n$$\\delta_{t}(120) = 0.12 \\ \\mathrm{J/m^{2}} \\times \\exp\\left(-\\frac{120}{30}\\right) = 0.12 \\times \\exp(-4) \\ \\mathrm{J/m^{2}}$$\n$$\\delta_{t}(120) \\approx 0.12 \\times 0.0183156 \\approx 0.002198 \\ \\mathrm{J/m^{2}}$$\n\n接下来，我们计算由有限真空尺寸引起的偏差 $\\delta_{v}(L_{\\mathrm{vac}})$：\n$$\\delta_{v}(L_{\\mathrm{vac}}) = C_{v} \\exp\\left(-\\frac{L_{\\mathrm{vac}}}{\\lambda}\\right)$$\n使用给定的参数 $C_{v} = 0.25 \\ \\mathrm{J/m^{2}}$，$L_{\\mathrm{vac}} = 15 \\ \\text{\\AA}$ 和 $\\lambda = 5 \\ \\text{\\AA}$：\n$$\\delta_{v}(15) = 0.25 \\ \\mathrm{J/m^{2}} \\times \\exp\\left(-\\frac{15}{5}\\right) = 0.25 \\times \\exp(-3) \\ \\mathrm{J/m^{2}}$$\n$$\\delta_{v}(15) \\approx 0.25 \\times 0.0497871 \\approx 0.012447 \\ \\mathrm{J/m^{2}}$$\n\n现在我们可以计算 $\\gamma_{\\infty}$：\n$$\\gamma_{\\infty} \\approx 1.250167 \\ \\mathrm{J/m^{2}} - 0.002198 \\ \\mathrm{J/m^{2}} - 0.012447 \\ \\mathrm{J/m^{2}}$$\n$$\\gamma_{\\infty} \\approx 1.235522 \\ \\mathrm{J/m^{2}}$$\n\n按要求将最终结果四舍五入到四位有效数字，得到 $1.236 \\ \\mathrm{J/m^{2}}$。\n\n**4. 误差预算分析**\n\n有限尺寸偏差的两个来源是穿过板层的表面间相互作用（$\\delta_{t}(N)$）和穿过真空的表面间相互作用（$\\delta_{v}(L_{\\mathrm{vac}})$）。我们已计算出它们的贡献分别为：\n- 有限厚度偏差: $\\delta_{t}(120) \\approx 0.0022 \\ \\mathrm{J/m^{2}}$\n- 有限真空偏差: $\\delta_{v}(15) \\approx 0.0124 \\ \\mathrm{J/m^{2}}$\n\n通过比较这两个值，我们可以确定本次特定计算中的主导误差来源。偏差的比值是：\n$$\\frac{\\delta_{v}(15)}{\\delta_{t}(120)} \\approx \\frac{0.012447}{0.002198} \\approx 5.7$$\n由有限真空尺寸引起的偏差 $\\delta_{v}$ 约是由有限板层厚度引起的偏差 $\\delta_{t}$ 的 $5.7$ 倍。指数衰减参数 $N/\\xi=4$ 和 $L_{\\mathrm{vac}}/\\lambda=3$ 表明，虽然板层相当厚（将误差抑制了 $\\exp(-4)$ 倍），但真空层的收敛性相对较差（仅将误差抑制了 $\\exp(-3)$ 倍）。因此，对于给定的计算设置，两个板层表面穿过真空的相互作用是有限尺寸误差的主导来源。要获得更精确的计算结果，最有效的方法是增加真空厚度 $L_{\\mathrm{vac}}$。", "answer": "$$\\boxed{1.236}$$", "id": "3490960"}, {"introduction": "一个精确的表面能计算远不止于单次能量减法；它需要一套严谨的收敛性测试和外推方案，以消除有限尺寸效应并将结果外推至半无限大的理想表面。不同的物理误差来源（如电子态交叠、静电相互作用）具有不同的衰减行为，这决定了我们应采用指数还是代数外推形式。这个练习 [@problem_id:3491035] 挑战你设计一个完整的计算流程，迫使你基于材料（半导体 vs. 金属）的物理特性来论证你的方法论，这是从执行计算到设计研究的关键一步。", "problem": "你的任务是使用密度泛函理论 (DFT) 中的一系列板层模型计算，来确定一个非极性重构半导体表面的表面能 $\\,\\gamma\\,$。目标材料是一种共价半导体，具有有限的体带隙 $\\,E_g\\,$，并且在费米能级处没有本征金属性表面态。你将模拟一个由 $\\,N\\,$ 个原子层组成的周期性重复板层，其面内面积为 $\\,A\\,$，真空层厚度为 $\\,t_v\\,$，并施加周期性边界条件。你将从板层总能量 $\\,E_{\\mathrm{slab}}(N)\\,$ 和一个单独收敛的每层体相能量 $\\,E_{\\mathrm{bulk}}\\,$ 中提取 $\\,\\gamma\\,$。假设横向晶格常数被约束为弛豫后的体相值，并且板层的两个表面在晶体学上是相同的，都表现出相同的 $(2\\times 1)$ 表面重构。总能量计算是自旋非极化的，并在零温下进行。\n\n从 $\\,\\gamma\\,$ 的定义（即从体相中创造一个表面所关联的每单位面积的过剩自由能）出发，并基于第一性原理对重复板层计算中出现的有限尺寸效应误差（包括跨板层的电子态交叠、周期性边界条件下的长程静电相互作用、由表面应力引起的弹性耦合以及量子尺寸效应）进行推理，选择一个选项，该选项为这种半导体的、非极性的、对称的重构情况，提出了一个物理上合理且可系统验证的收敛方案和外推形式，以获得在无限厚度极限下的 $\\,\\gamma\\,$。你的选择应与费米能级处没有金属性态、存在有限的体带隙以及固定的面内晶格常数等条件相一致。\n\nA. 在固定的真空层厚度 $\\,t_v\\gtrsim 15\\,\\text{\\AA}\\,$ 下，进行一系列对称板层计算，其中 $\\,N\\in\\{8,12,16,20,24\\}\\,$，两个表面进行相同的重构，且面内晶格常数固定为弛豫后的体相值。完全弛豫离子位置，除了中心几层固定在体相位置以定义中面。对于每个 $\\,N\\,$，使用具有相同数值设置的体相和板层计算来计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N) - N\\,E_{\\mathrm{bulk}}\\big)/(2A)\\,$。使用 $\\,\\gamma(N) = \\gamma_{\\infty} + C\\,\\exp\\!\\big(-N a/\\xi\\big)\\,$ 进行外推，其中 $\\,a\\,$ 是层间距，$\\,\\xi\\,$ 是一个作为拟合参数处理的电子衰减长度。通过用加倍的 $\\,t_v\\,$ 重复计算两个 $\\,N\\,$ 值，来验证 $\\,\\gamma_{\\infty}\\,$ 对 $\\,t_v\\,$ 不敏感。通过板层中带隙表面态的倏逝波交叠以及在所述约束条件下不存在长程静电或全局弹性 $\\,1/N\\,$ 项来证明指数形式的合理性。\n\nB. 构建非对称板层，其顶部是感兴趣的重构表面，底部是氢钝化表面，弛豫所有离子，并允许面内晶格常数随 $\\,N\\,$ 变化。忽略真空中的任何偶极矩校正。对于 $\\,N\\in\\{6,8,10,12,14\\}\\,$，计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N) - N\\,E_{\\mathrm{bulk}}\\big)/A\\,$，并使用 $\\,\\gamma(N) = \\gamma_{\\infty} + D/N\\,$ 对 $\\,\\gamma(N)\\,$ 关于 $\\,1/N\\,$ 进行线性外推，将 $\\,1/N\\,$ 的行为归因于板层偶极矩和两个端面之间的弹性耦合。\n\nC. 对于相同的非极性半导体性重构，构建对称板层，其中 $\\,N\\in\\{9,11,13,15,17\\}\\,$，并将 $\\,\\gamma(N)\\,$ 拟合到一个振荡的代数形式 $\\,\\gamma(N) = \\gamma_{\\infty} + \\big[C\\cos(2k_F N a + \\phi)\\big]/N^2\\,$，其中 $\\,k_F\\,$ 和 $\\,\\phi\\,$ 被视为拟合参数，其依据是费米能级处的量子阱态会引起类 Friedel 振荡。\n\nD. 使用对称板层，其中 $\\,N\\in\\{10,14,18\\}\\,$，在固定的 $\\,t_v\\,$ 下，将 $\\,\\gamma(N)\\,$ 拟合为 $\\,\\gamma(N) = \\gamma_{\\infty} + C/N\\,$ 的 $\\,1/N\\,$ 线性关系，其论点是表面应力通常会产生一种长程弹性相互作用，该作用在即使是有带隙的材料中也主导着有限尺寸效应误差；如果三个点几乎在一条直线上，则接受该拟合。\n\n对于本案例，哪个选项是最恰当且最能自圆其说的方案和外推形式？", "solution": "我们从具有两个相同表面的板层的表面能定义开始。设 $\\,E_{\\mathrm{slab}}(N)\\,$ 是一个由 $\\,N\\,$ 个原子层组成的对称板层的总能量，其面内面积为 $\\,A\\,$，并设 $\\,E_{\\mathrm{bulk}}\\,$ 表示使用一致的数值设置计算的每层体相能量。表面能定义为在半无限极限下每单位表面积的过剩能量，\n$$\n\\gamma \\equiv \\lim_{N\\to\\infty}\\frac{E_{\\mathrm{slab}}(N) - N\\,E_{\\mathrm{bulk}}}{2A}.\n$$\n在实践中，人们计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N)-N E_{\\mathrm{bulk}}\\big)/(2A)\\,$ 并将 $\\,\\gamma(N)\\,$ 外推到 $\\,N\\to\\infty\\,$。\n\n在重复板层计算中影响 $\\,\\gamma(N)\\,$ 的有限尺寸效应误差可以根据其物理来源进行分解：\n\n- 跨板层的电子态交叠：在具有体带隙 $\\,E_g0\\,$ 且没有金属性表面能带穿过费米能级的半导体中，与表面微扰相关的 Kohn–Sham 态作为复能带结构的倏逝解衰减进入体相。如果 $\\,\\kappa\\,$ 是沿表面法线方向带隙中波矢的最小虚部，则振幅按 $\\,\\exp(-\\kappa z)\\,$ 衰减，因此两个表面之间的耦合按 $\\,\\exp(-2\\kappa L)\\,$ 衰减，其中 $\\,L\\,$ 是板层厚度。等效地，对于间距为 $\\,a\\,$ 的 $\\,N\\,$ 层，这导致了指数修正 $\\,\\sim \\exp(-N a/\\xi)\\,$，其衰减长度为 $\\,\\xi\\sim 1/\\kappa\\,$。因此，在没有金属性表面态的有带隙系统中，$\\,\\gamma(N)\\,$ 中的主要电子有限尺寸效应误差在 $\\,N\\,$ 上是指数形式的。\n\n- 长程静电相互作用：在重复板层中沿表面法线方向的总偶极矩会在周期性边界条件下的真空区域中产生一个虚假的均匀电场，从而产生一个与原胞尺寸成代数关系的修正（通常是 $\\,\\sim 1/t_v\\,$ 或 $\\,\\sim 1/N\\,$，取决于设置）。对于具有相同端面的对称非极性板层，由于对称性，净偶极矩为 $\\,0\\,$，因此这个人为效应在主导阶上是不存在的。如果板层是不对称的，应施加偶极矩校正以消除该电场；否则，一个虚假的 $\\,1/N\\,$ 依赖关系可能会主导表观收敛。\n\n- 弹性耦合与表面应力：如果允许面内晶格常数对每个 $\\,N\\,$ 进行弛豫，两个表面应力层可以通过有限厚度的薄膜耦合，导致一个依赖于 $\\,N\\,$ 的面内应变和每单位面积的弹性应变能，其标度关系为 $\\,\\sim 1/N\\,$。然而，如果将面内晶格常数固定为体相平衡值（这是旨在达到半无限极限的表面计算的通常做法），全局面内应变将被抑制；剩余的弹性应变能仍然局域在每个表面附近，并且不会在 $\\,\\gamma(N)\\,$ 中产生主导的 $\\,1/N\\,$ 项。\n\n- 金属中的量子尺寸效应：对于金属性薄膜，费米能级处态的限制会产生振荡修正，该修正呈代数衰减，通常为 $\\,\\sim \\cos(2 k_F L + \\phi)/L^2\\,$，其中 $\\,k_F\\,$ 是费米波矢，$\\,\\phi\\,$ 是一个相位。在具有有限带隙且没有金属性表面能带穿过费米能级的半导体中，不存在这种振荡的代数行为。\n\n- 真空层分离：周期性重复板层之间的静电和交换关联相互作用随 $\\,t_v\\,$ 衰减。对于中性、对称的板层，主导误差随 $\\,t_v\\,$ 呈指数衰减，其衰减速率由面内方向的最小倒格矢和真空中的倏逝衰减决定；验证 $\\,\\gamma_{\\infty}\\,$ 对 $\\,t_v\\,$ 不敏感可以检查虚假的原胞间相互作用是否可以忽略。\n\n基于这些原则，对于具有固定面内晶格常数的非极性、对称、重构的半导体表面，一个合理的收敛方案应该：\n\n- 使用两个表面等价的对称板层，以避免产生净偶极矩，从而避免虚假的静电 $\\,1/N\\,$ 项。\n- 将面内晶格常数固定为体相值，以抑制全局弹性 $\\,1/N\\,$ 耦合。\n- 在足够宽的范围内改变 $\\,N\\,$ 以分辨出指数衰减。\n- 使用一致的体相和板层数值设置为能量提供干净的参考基准。\n- 通过使用更大的 $\\,t_v\\,$ 进行抽查，来验证 $\\,\\gamma_{\\infty}\\,$ 对 $\\,t_v\\,$ 不敏感。\n- 将 $\\,\\gamma(N)\\,$ 拟合为指数形式，其物理动机是在有带隙的主体材料中表面微扰的倏逝波交叠。\n\n我们现在评估每个选项：\n\n选项 A：该方案使用具有相同重构的对称板层，将面内晶格常数固定为体相值，并使用共享的数值设置计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N) - N E_{\\mathrm{bulk}}\\big)/(2A)\\,$。它提出了指数外推 $\\,\\gamma(N) = \\gamma_{\\infty} + C\\,\\exp(-N a/\\xi)\\,$ 并通过对一个子集加倍 $\\,t_v\\,$ 来验证真空收敛性。其理由是跨越有带隙体相的倏逝波交叠以及不存在净偶极矩和全局弹性 $\\,1/N\\,$ 项。这与第一性原理的预期相符：在没有金属性表面态、具有对称端面和固定面内参数的半导体中，主导的有限尺寸修正对 $\\,N\\,$ 呈指数关系。对真空不敏感性和一致参考基准的检查是恰当的。结论：正确。\n\n选项 B：这使用了一个带有氢钝化的非对称板层，并忽略了偶极矩校正，然后拟合 $\\,1/N\\,$ 依赖关系。非对称板层沿表面法线方向产生净偶极矩，在周期性边界条件下产生虚假的内部电场和依赖于厚度的静电相互作用。忽略偶极矩校正会导致一个虚假的类 $\\,1/N\\,$ 趋势，这并不能反映目标表面的本征表面能。允许面内晶格常数随 $\\,N\\,$ 变化会进一步引入弹性 $\\,1/N\\,$ 耦合，这不能代表在固定体相晶格下的半无限表面。在非对称定义中，每单位面积的能量也错误地只用了单个 $\\,A\\,$，而没有仔细区分两个不同端面的贡献。结论：不正确。\n\n选项 C：这假设了振荡的代数有限尺寸效应 $\\,\\sim \\cos(2 k_F N a + \\phi)/N^2\\,$，这是金属性量子尺寸效应的特征。问题指定了一个具有有限带隙且在费米能级没有金属性表面态的半导体，因此费米能级上没有传播态来产生类 Friedel 振荡。因此，这种外推形式不适用于所述情况。结论：不正确。\n\n选项 D：这使用了对称板层，但对 $\\,1/N\\,$ 进行线性拟合，其论点是表面应力通常会产生一个主导的 $\\,1/N\\,$ 项。在面内晶格常数固定为体相值的情况下，主导的全局弹性 $\\,1/N\\,$ 项被抑制；剩余的弹性应变能局域在表面，不会产生主导的 $\\,1/N\\,$ 衰减。在有带隙的系统中，主导的电子耦合是指数形式的。此外，仅使用三个点不足以可靠地区分指数收敛和代数收敛。结论：不正确。\n\n因此，对于给定的非极性半导体对称表面，唯一在物理上合理且可系统验证的选项是选项 A。", "answer": "$$\\boxed{A}$$", "id": "3491035"}, {"introduction": "材料表面并非静止不变，它们会发生重构以寻求更低的能量状态。理解不同重构态之间的转变对于揭示催化、晶体生长等动态过程至关重要。这个练习将带你进入表面动力学的领域，要求你为寻找两个表面重构态之间的最小能量路径（Minimum Energy Path, MEP）设计一个“微动弹性带”（Nudged Elastic Band, NEB）计算方案 [@problem_id:3491011]。你将思考如何构建初始路径、如何通过力投影将体系“推向”最小能量路径，以及如何精确锁定定义了活化能垒 $E_a$ 的过渡态，从而将你的技能从静态能量计算扩展到动力学过程模拟。", "problem": "您正在使用密度泛函理论 (DFT) 模拟半导体板坯上两种亚稳态重构表面态之间的转变。该表面由一个包含 $M$ 个原子层的周期性超胞表示；底部的 $m$ 层被约束在其体相位置，并由氢原子封端以消除悬挂键，而顶部的 $M-m$ 层则完全弛豫。势能是所有原子坐标 $\\mathbf{R}$ 的函数 $E(\\mathbf{R})$，作用在原子上的物理力是负梯度 $-\\nabla E(\\mathbf{R})$。连接两个局域极小值的最小能量路径 (MEP) 是构型空间中的一条路径，在该路径上的每一点，垂直于路径的力分量都为零，并且 MEP 上唯一的一阶鞍点将激活能 $E_a$ 定义为鞍点与所选初始极小值之间的能量差。\n\n您的任务是规划一个微动弹性带 (NEB) 计算，以获得两种重构表面态之间的 MEP 和 $E_a$。假设两种重构在一个共同的超胞中是相称的，并且所有图像的电子结构设置（平面波截断能、$k$ 点网格、展宽）都将相同。\n\n哪个选项最能为该表面问题勾勒出一个科学上合理且完整的 NEB 工作流程，并具体解决了初始路径生成、力投影和收敛标准的问题？\n\nA. 使用一个可容纳两种重构的共同超胞。通过对两个弛豫端点结构之间仅未约束原子的笛卡尔坐标进行线性插值来生成初始路径，保持所有图像中底部的 $m$ 层和氢封端固定不变。放置 $N$ 个初始间距近似均匀的中间图像。通过恒定刚度 $k$ 的谐振子弹簧连接相邻图像以保持均匀间距。在每个几何优化步骤中，根据相邻图像及其能量在图像 $i$ 处定义一个局部切线 $\\hat{\\tau}_i$ 以避免扭结，将真实力 $-\\nabla E(\\mathbf{R}_i)$ 垂直于 $\\hat{\\tau}_i$ 进行投影以将图像驱动到 MEP 上，并仅沿 $\\hat{\\tau}_i$ 施加弹簧力以控制图像的分布。一旦能带大致收敛，通过移除最高能量中间图像的弹簧力并反转真实力的平行分量，将其提升为爬升图像，以收敛到鞍点。当所有非端点图像上垂直于路径的力分量的最大范数低于选定阈值（例如 $0.02\\,\\text{eV}\\,\\text{\\AA}^{-1}$），图像间距近似均匀，且端点保持在其弛豫能量时，即为收敛。将 $E_a$ 报告为爬升图像的能量（不含任何弹簧贡献）与所选初始态能量之差。\n\nB. 为每个图像使用独立的 $k$ 点网格以降低成本。通过对所有原子位置（包括受约束层）进行线性插值来生成初始路径，以确保连续性。用弹簧连接图像，并在每一步将真实力和弹簧力都垂直于路径进行投影，以使图像不会沿能带滑动。当所有图像的优化步骤之间的总 DFT 能量变化小于 $10^{-4}\\,\\text{eV}$ 时，即为收敛。将 $E_a$ 报告为最终态和初始态能量之差。\n\nC. 使用一组密集的 $N$ 个图像，通过在周期性晶胞内对分数（直接）坐标进行线性插值来初始化，允许所有原子（包括底部的 $m$ 层）移动以避免偏差。施加刚度为 $k$ 的弹簧，并在垂直和平行方向上都包含弹簧力以加固能带。不修改能带进行爬升；而是从最高能量图像的总能量（包括弹簧能量贡献）中读取鞍点能量。当所有图像的平均力大小降至 $0.05\\,\\text{eV}\\,\\text{\\AA}^{-1}$ 以下时，即为收敛。将 $E_a$ 报告为最高图像相对于端点能量平均值的能量。\n\nD. 使用少量图像，并通过对端点结构进行随机扰动来初始化能带，以避免偏差。在优化过程中，定义一个切线，并仅沿切线投影真实力，将垂直分量设置为零以防止“切角”。在垂直方向施加弹簧力以使能带保持在 MEP 附近。当第一个和最后一个图像之间的弧长不再变化时，即为收敛。将 $E_a$ 报告为最大弹簧力乘以平均图像间距。\n\n选择最佳选项。", "solution": "用户提供了一个关于在计算材料科学中规划微动弹性带 (NEB) 计算的问题陈述。第一步是验证问题陈述本身。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **系统**：半导体板坯的两种亚稳态重构表面态之间的转变。\n- **模型**：一个包含 $M$ 个原子层的周期性超胞。\n- **约束条件**：底部的 $m$ 层被约束在体相位置。\n- **边界条件**：底面由氢原子封端。\n- **自由度**：顶部的 $M-m$ 层完全弛豫。\n- **物理原理**：势能是 $E(\\mathbf{R})$，力是 $-\\nabla E(\\mathbf{R})$。\n- **定义**：\n    - 最小能量路径 (MEP)：路径上任意一点垂直于路径的力分量为零的路径。\n    - 激活能 ($E_a$)：MEP 上的一阶鞍点与初始极小值之间的能量差。\n- **任务**：选择一个能勾勒出科学上合理且完整的 NEB 工作流程的最佳选项，以找到 MEP 和 $E_a$。\n- **假设**：\n    - 两种重构都适用于一个共同的超胞。\n    - 所有图像的电子结构设置（平面波截断能、$k$ 点网格、展宽）均相同。\n\n**步骤 2：使用提取的已知条件进行验证**\n对问题陈述的科学合理性、清晰度和完整性进行审视。\n\n- **科学依据**：该问题牢固地植根于计算材料科学和固态物理学的原理。使用密度泛函理论 (DFT)、带有固定层的板坯模型、氢钝化以及最小能量路径 (MEP) 的概念，都是研究表面现象的标准且有效技术。NEB 方法、MEP 和激活能的定义与已发表的文献（例如，Henkelman、Uberuaga、Jónsson）一致。\n- **适定性**：该问题是适定的。它要求对一个具有正确、既定程序的标准计算任务的几种提议工作流程进行评估。目标是在选项中找出“最佳”（即最正确和最完整）的描述。\n- **客观性**：语言技术性强、精确，没有主观或模棱两可的术语。所有术语在该领域都是标准的。\n\n**步骤 3：结论和行动**\n问题陈述在科学上是合理的、适定的、客观的且自洽的。它描述了计算研究中的一个标准、现实的场景。没有发现任何缺陷。因此，该问题是**有效的**。解决方案将通过推导 NEB 方法的原理并评估每个选项来继续。\n\n### 正确 NEB 工作流程的推导\n\n微动弹性带 (NEB) 方法是一种用于寻找系统已知初始态和最终态之间最小能量路径 (MEP) 的算法。该路径由系统的离散图像集（或副本）$\\lbrace \\mathbf{R}_0, \\mathbf{R}_1, \\ldots, \\mathbf{R}_N, \\mathbf{R}_{N+1} \\rbrace$ 表示，其中 $\\mathbf{R}_0$ 和 $\\mathbf{R}_{N+1}$ 分别是弛豫后的初始态和最终态。\n\n1.  **初始路径生成**：通常通过对 $\\mathbf{R}_0$ 和 $\\mathbf{R}_{N+1}$ 之间可移动原子的原子坐标进行线性插值，来生成一个合理的路径初始猜测。在给定问题的背景下，只应插值顶部 $M-m$ 层中原子的坐标，而底部 $m$ 层中的原子和封端的氢原子必须在所有图像中保持在其受约束的位置固定不变。\n\n2.  **NEB 中的力**：每个中间图像 $\\mathbf{R}_i$（对于 $i=1, \\ldots, N$）都会在一个特定的 NEB 力的作用下进行弛豫。这个力是两个分量的和：\n    - 源自势能面 $E(\\mathbf{R})$ 的真实力的垂直分量。设真实力为 $\\mathbf{F}_i^{\\text{true}} = -\\nabla E(\\mathbf{R}_i)$。其垂直于局部路径切线 $\\hat{\\tau}_i$ 的分量是 $(\\mathbf{F}_i^{\\text{true}})_{\\perp}$。该分量将图像驱动向 MEP。\n    - 一个虚拟弹簧力的平行分量，$(\\mathbf{F}_i^{\\text{spring}})_{\\parallel}$。弹簧力 $\\mathbf{F}_i^{\\text{spring}}$ 作用于相邻图像之间，以确保它们大致保持等距，防止它们滑入能量极小值。仅使用其平行于路径的分量可以防止弹簧力干扰路径向 MEP 的弛豫。\n\n    因此，作用在图像 $i$ 上的总 NEB 力为：\n    $$ \\mathbf{F}_i^{\\text{NEB}} = (\\mathbf{F}_i^{\\text{true}})_{\\perp} + (\\mathbf{F}_i^{\\text{spring}})_{\\parallel} $$\n    或者，用势梯度表示：\n    $$ \\mathbf{F}_i^{\\text{NEB}} = (-\\nabla E(\\mathbf{R}_i))_{\\perp} + (\\mathbf{F}_i^{\\text{spring}})_{\\parallel} $$\n    局部路径切线 $\\hat{\\tau}_i$ 被精确定义，通常使用能量加权方案以避免路径中的扭结，正如原始文献中所述。\n\n3.  **爬升图像 NEB (CI-NEB)**：标准 NEB 可能无法将图像精确定位在鞍点。CI-NEB 修改纠正了这一点。一旦能带部分收敛，能量最高的图像 $\\mathbf{R}_{i_{\\text{max}}}$ 被指定为“爬升图像”。对于此图像，弹簧力被移除，真实力的平行分量被反转。作用在爬升图像上的力变为：\n    $$ \\mathbf{F}_{i_{\\text{max}}}^{\\text{CI}} = (\\mathbf{F}_{i_{\\text{max}}}^{\\text{true}})_{\\perp} - (\\mathbf{F}_{i_{\\text{max}}}^{\\text{true}})_{\\parallel} = -\\nabla E(\\mathbf{R}_{i_{\\text{max}}}) + 2(\\nabla E(\\mathbf{R}_{i_{\\text{max}}}) \\cdot \\hat{\\tau}_{i_{\\text{max}}})\\hat{\\tau}_{i_{\\text{max}}} $$\n    这个力驱动图像沿 MEP 向上攀升势能面，以精确收敛到一阶鞍点，其中 $\\nabla E = \\mathbf{0}$。\n\n4.  **收敛和激活能**：当任何中间图像中任何原子上的最大力降至指定阈值以下时，计算即收敛。一个稳健的标准是基于垂直于路径的力的大小，因为这表明已收敛到 MEP。一旦收敛，激活能 $E_a$ 计算为收敛的爬升图像的势能 $E(\\mathbf{R}_{i_{\\text{max}}})$ 与初始态能量 $E(\\mathbf{R}_0)$ 之差：\n    $$ E_a = E(\\mathbf{R}_{i_{\\text{max}}}) - E(\\mathbf{R}_0) $$\n    虚拟的弹簧能量对物理激活能没有贡献。\n\n### 选项评估\n\n**A. 使用一个可容纳两种重构的共同超胞。通过对两个弛豫端点结构之间仅未约束原子的笛卡尔坐标进行线性插值来生成初始路径，保持所有图像中底部的 $m$ 层和氢封端固定不变。放置 $N$ 个初始间距近似均匀的中间图像。通过恒定刚度 $k$ 的谐振子弹簧连接相邻图像以保持均匀间距。在每个几何优化步骤中，根据相邻图像及其能量在图像 $i$ 处定义一个局部切线 $\\hat{\\tau}_i$ 以避免扭结，将真实力 $-\\nabla E(\\mathbf{R}_i)$ 垂直于 $\\hat{\\tau}_i$ 进行投影以将图像驱动到 MEP 上，并仅沿 $\\hat{\\tau}_i$ 施加弹簧力以控制图像的分布。一旦能带大致收敛，通过移除最高能量中间图像的弹簧力并反转真实力的平行分量，将其提升为爬升图像，以收敛到鞍点。当所有非端点图像上垂直于路径的力分量的最大范数低于选定阈值（例如 $0.02\\,\\text{eV}\\,\\text{\\AA}^{-1}$），图像间距近似均匀，且端点保持在其弛豫能量时，即为收敛。将 $E_a$ 报告为爬升图像的能量（不含任何弹簧贡献）与所选初始态能量之差。**\n\n此选项对最先进的 CI-NEB 方法进行了细致而准确的描述，并正确应用于指定的板坯模型问题。\n- **初始路径**：正确地只插值可移动原子。\n- **力投影**：正确地描述了“微动”——使用垂直的真实力和并行的弹簧力。提及基于能量的切线是一个高级且正确的细节。\n- **鞍点搜索**：正确地描述了爬升图像的修改。\n- **收敛**：使用了一个物理上有意义且稳健的基于力的标准。示例值 $0.02\\,\\text{eV}\\,\\text{\\AA}^{-1}$ 是高质量计算的标准值。\n- **$E_a$ 计算**：正确地定义了相对于初始态的激活能，使用收敛的鞍点图像的能量，并排除了虚拟的弹簧能量。\n结论：**正确**。\n\n**B. 为每个图像使用独立的 $k$ 点网格以降低成本。通过对所有原子位置（包括受约束层）进行线性插值来生成初始路径，以确保连续性。用弹簧连接图像，并在每一步将真实力和弹簧力都垂直于路径进行投影，以使图像不会沿能带滑动。当所有图像的优化步骤之间的总 DFT 能量变化小于 $10^{-4}\\,\\text{eV}$ 时，即为收敛。将 $E_a$ 报告为最终态和初始态能量之差。**\n\n这个选项包含几个基本错误。\n- **$k$ 点网格**：使用不同的网格意味着每个图像存在于不同的势能面上，使得 MEP 成为一个定义不明确的概念。这是一个关键的科学错误。\n- **初始路径**：插值受约束的原子违反了问题的物理设置。\n- **力投影**：将弹簧力垂直于路径投影是错误的；它应该是平行的。将真实力垂直投影是正确的，但给出的理由（“以使图像不会滑动”）不精确；移除平行的真实力才是防止滑动的关键。\n- **收敛**：基于能量的收敛标准在几何优化中通常不如基于力的标准可靠。\n- **$E_a$ 计算**：最终态和初始态能量之差是反应能 $\\Delta E$，而不是激活能 $E_a$。\n结论：**不正确**。\n\n**C. 使用一组密集的 $N$ 个图像，通过在周期性晶胞内对分数（直接）坐标进行线性插值来初始化，允许所有原子（包括底部的 $m$ 层）移动以避免偏差。施加刚度为 $k$ 的弹簧，并在垂直和平行方向上都包含弹簧力以加固能带。不修改能带进行爬升；而是从最高能量图像的总能量（包括弹簧能量贡献）中读取鞍点能量。当所有图像的平均力大小降至 $0.05\\,\\text{eV}\\,\\text{\\AA}^{-1}$ 以下时，即为收敛。将 $E_a$ 报告为最高图像相对于端点能量平均值的能量。**\n\n这个选项也存在根本性缺陷。\n- **初始路径**：对于定义的问题，允许受约束的原子移动是不正确的。\n- **力投影**：包含垂直的弹簧力直接违反了 NEB 算法的设计；它会将路径从 MEP 上拉开。\n- **鞍点搜索**：不使用爬升图像只能得到鞍点的近似值。更严重的是，将虚拟的弹簧能量包含在物理势垒计算中是一个严重的概念错误。\n- **收敛**：平均力是一个弱标准；必须控制最大力。\n- **$E_a$ 计算**：势垒必须相对于初始态计算，而不是端点的平均值（除非它们是简并的）。\n结论：**不正确**。\n\n**D. 使用少量图像，并通过对端点结构进行随机扰动来初始化能带，以避免偏差。在优化过程中，定义一个切线，并仅沿切线投影真实力，将垂直分量设置为零以防止“切角”。在垂直方向施加弹簧力以使能带保持在 MEP 附近。当第一个和最后一个图像之间的弧长不再变化时，即为收敛。将 $E_a$ 报告为最大弹簧力乘以平均图像间距。**\n\n这个选项表明对 NEB 方法完全不理解。\n- **初始路径**：随机初始化是一个糟糕的策略，很可能导致一个高度复杂和不符合物理的路径，从而无法收敛。\n- **力投影**：对力投影的描述完全是颠倒的。垂直的真实力是必不可少的，并且*不*能设置为零。弹簧力是平行于路径施加的，而不是垂直的。\n- **收敛**：弧长对于寻找像 MEP 这样的驻定路径不是一个有效的收敛标准。\n- **$E_a$ 计算**：所提出的 $E_a$ 公式是荒谬的，没有物理基础。\n结论：**不正确**。\n\n### 结论\n\n选项 A 是唯一一个为指定问题描述了科学有效、完整且稳健工作流程的选项。它正确地捕捉了 CI-NEB 方法的细微之处及其在现实表面科学模型中的应用。选项 B、C 和 D 在物理模型、算法和分析的多个方面都存在根本性错误。", "answer": "$$\\boxed{A}$$", "id": "3491011"}]}