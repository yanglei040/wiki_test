## 引言
在计算材料科学领域，从[第一性原理计算](@entry_id:198754)到宏观连续介质模拟，任何模型的预测都无法摆脱不确定性的阴影。这些不确定性源于模型本身的近似、参数的[测量误差](@entry_id:270998)，以及系统固有的随机性。因此，仅仅给出一个预测值是远远不够的；更重要的是要理解并量化这个预测的可信度。不确定性量化（UQ）与[误差传播](@entry_id:147381)正是应对这一挑战的核心[科学方法](@entry_id:143231)，它使得我们能够评估模拟结果的可靠性，指导后续的实验与计算，并最终做出更稳健的科学决策。然而，许多研究人员对如何系统性地处理和报告不确定性感到困惑，导致研究结论的可靠性难以评估。

本文旨在填补这一知识鸿沟，为计算材料科学的研究生和学者提供一个关于不确定性量化与[误差传播](@entry_id:147381)的全面指南。我们将会从基础出发，逐步深入到高级的应用框架中。在“原理与机制”一章，您将学习不确定性的基本分类、[误差传播](@entry_id:147381)的数学工具（如[Delta方法](@entry_id:276272)）、敏感性分析以及强大的[贝叶斯推断](@entry_id:146958)框架。接着，在“应用与跨学科连接”一章，我们将展示这些理论如何在[计算材料科学](@entry_id:145245)的核心问题（如[多尺度建模](@entry_id:154964)）以及实验数据分析中发挥作用，并将其视野拓展到系统生物学、地球科学等交叉学科，彰显UQ方法的普适性。最后，“动手实践”部分将通过一系列具体的计算问题，引导您亲手实现和应用关键的UQ技术。通过本次学习，您将掌握一套评估和传达计算结果可信度的系统性方法论。

## 原理与机制

在计算材料科学中，任何模型的预测都不可避免地伴随着不确定性。理解、量化并传播这些不确定性，对于评估模拟结果的可靠性、指导实验设计以及做出稳健的科学决策至关重要。本章将深入探讨不确定性量化 (UQ) 的核心原理与机制，从不确定性的基本分类出发，系统介绍[误差传播](@entry_id:147381)、敏感性分析、贝叶斯推断框架以及验证方法。

### 不确定性与误差的分类

在深入研究量化技术之前，我们必须首先建立一个关于不确定性来源和类型的清晰分类法。

#### [偶然不确定性与认知不确定性](@entry_id:746346)

在不确定性量化领域，一个核心的区分是**[偶然不确定性](@entry_id:154011) (Aleatoric Uncertainty)** 和 **[认知不确定性](@entry_id:149866) (Epistemic Uncertainty)**。

**[偶然不确定性](@entry_id:154011)**源于系统固有的、不可避免的随机性。它通常与测量过程中的噪声、[材料微观结构](@entry_id:198422)中的随机变化或热波动等现象相关。即使我们拥有完美的模型和无限的数据，这种不确定性依然存在，因此它也被称为**不可约减的不确定性 (irreducible uncertainty)**。在统计模型中，它通常表现为[预测分布](@entry_id:165741)的[方差](@entry_id:200758)。

**认知不确定性**则源于我们知识的缺乏。这包括对模型形式的无知（例如，选择哪个密度泛函或[力场](@entry_id:147325)）、对模型参数的不确定（例如，材料的[弹性模量](@entry_id:198862)或[屈服强度](@entry_id:162154)的精确值），以及由[数值近似](@entry_id:161970)（如[有限元网格](@entry_id:174862)或[平面波截断能](@entry_id:753474)）引入的误差。原则上，通过收集更多数据、改进模型或提高计算精度，认知不确定性是可以被**约减的 (reducible)**。

在实践中，区分并分别量化这两种不确定性具有重要意义。例如，如果预测的总不确定性主要由认知不确定性主导，这表明我们的模型本身存在改进空间；反之，如果偶然不确定性占主导，则意味着预测精度已接近该系统固有的物理极限。

一个强大的量化工具是**[全方差定律](@entry_id:184705) (Law of Total Variance)**。假设我们有一个由 $K$ 个不同模型组成的**集成 (ensemble)**，其中每个模型 $k$ 都是通过不同方式（例如，不同的随机种子或数据集）训练得到的。我们可以将[模型选择](@entry_id:155601)本身视为一个[随机变量](@entry_id:195330)。对于任何一个预测量 $Y$，其总[方差](@entry_id:200758)可以分解为：
$$
\mathrm{Var}(Y) = \mathbb{E}_{k}[\mathrm{Var}(Y|k)] + \mathrm{Var}_{k}(\mathbb{E}[Y|k])
$$
这个公式优雅地将总[不确定性分解](@entry_id:183314)为两个部分：
1.  **[偶然不确定性](@entry_id:154011)贡献**: $\sigma^2_{\text{aleatoric}} = \mathbb{E}_{k}[\mathrm{Var}(Y|k)]$。这一项是给定模型 $k$ 条件下 $Y$ 的[方差](@entry_id:200758)在所有模型上的期望。在实践中，如果每个模型都能预测其自身的偶然[方差](@entry_id:200758) $v_k^Y$（例如，通过学习数据中的噪声），那么偶然不确定性的估计量就是这些[方差](@entry_id:200758)的平均值：$\hat{\sigma}^2_{\text{aleatoric}} = \frac{1}{K} \sum_{k=1}^K v_k^Y$。
2.  **认知不确定性贡献**: $\sigma^2_{\text{epistemic}} = \mathrm{Var}_{k}(\mathbb{E}[Y|k])$。这一项是不同模型预测均值 $\mathbb{E}[Y|k]$ 之间的[方差](@entry_id:200758)。它直接量化了模型之间的“[分歧](@entry_id:193119)”或不一致性，反映了我们对“正确”模型的无知。其实际估计量是集成成员预测均值的样本[方差](@entry_id:200758)：$\hat{\sigma}^2_{\text{epistemic}} = \frac{1}{K-1} \sum_{k=1}^K (\hat{y}_k - \bar{\hat{y}})^2$，其中 $\hat{y}_k$ 是模型 $k$ 的预测均值，$\bar{\hat{y}}$ 是集成预测的平均值。

这种分解方法在现代[机器学习势函数](@entry_id:138428)中尤为重要。例如，一个由多个独立训练的[神经网](@entry_id:276355)络[原子间势](@entry_id:177673)组成的集成，不仅可以提供对能量和力的预测，还可以通过分析集成成员的预测一致性来评估其在原子[构型空间](@entry_id:149531)中特定区域的可靠性 [@problem_id:3499836]。

#### 计算模型中的误差来源

除了上述分类，我们还可以从计算工作流的角度识别几个关键的误差来源：
- **[参数不确定性](@entry_id:264387) (Parametric Uncertainty)**: 模型输入参数（如材料常数）通常是通过实验测量或更高层次的计算得到的，其本身就带有不确定性。
- **结构不确定性 (Structural Uncertainty)** 或称 **[模型形式误差](@entry_id:274198) (Model-Form Error)**: 计算模型总是真实物理过程的近似。例如，所有的经典[原子间势](@entry_id:177673)都忽略了量子效应，而大多数密度泛函近似也只是对真实交换关联泛函的近似。
- **[离散化误差](@entry_id:748522) (Discretization Error)**: 将连续的数学方程（如[Kohn-Sham方程](@entry_id:143968)或弹性力学方程）转化为可在计算机上求解的离散形式时引入的误差。这与网格密度、时间步长或[基组](@entry_id:160309)大小直接相关。
- **[统计误差](@entry_id:755391) (Statistical Error)**: 在依赖于采样的模拟方法（如分子动力学或[蒙特卡洛](@entry_id:144354)）中，由于模拟时间或样本数量有限而产生的误差。
- **测量误差 (Measurement Error)**: 用于校准或验证模型的实验数据本身含有的不确定性。

这些误差来源并非相互独立，并且它们可以被映射到[偶然不确定性](@entry_id:154011)和认知不确定性的分类中。例如，[参数不确定性](@entry_id:264387)和结构不确定性是典型的[认知不确定性](@entry_id:149866)，而[测量误差](@entry_id:270998)通常被建模为[偶然不确定性](@entry_id:154011)。离散化和[统计误差](@entry_id:755391)也是认知性的，因为它们可以通过增加计算资源（如加密网格或延长模拟）来减小。

### [误差传播](@entry_id:147381)与[敏感性分析](@entry_id:147555)

一旦我们识别并量化了输入端的不确定性，下一步就是理解它们如何传播到模型的最终输出。

#### [不确定性传播](@entry_id:146574)：[Delta方法](@entry_id:276272)

**[Delta方法](@entry_id:276272)**，也称为**一阶二矩 (First-Order Second-Moment, FOSM)** 方法，是一种广泛应用的近似技术，用于估计一个函数输出的[方差](@entry_id:200758)。假设我们有一个输出量 $Y$，它是输入参数矢量 $\boldsymbol{\theta} = [\theta_1, \dots, \theta_d]^T$ 的函数，即 $Y = g(\boldsymbol{\theta})$。如果我们知道输入参数的均值 $\boldsymbol{\mu}_\theta$ 和[协方差矩阵](@entry_id:139155) $\Sigma_\theta$，我们可以通过在均值点对 $g$ 进行一阶泰勒展开来近似 $Y$ 的[方差](@entry_id:200758)：
$$
\mathrm{Var}(Y) \approx \nabla g(\boldsymbol{\mu}_\theta)^T \Sigma_\theta \nabla g(\boldsymbol{\mu}_\theta)
$$
其中 $\nabla g(\boldsymbol{\mu}_\theta)$ 是函数 $g$ 对参数 $\boldsymbol{\theta}$ 的梯度（或[敏感性系数](@entry_id:273552)）在均值点 $\boldsymbol{\mu}_\theta$ 的取值。

这个方法在许多物理模型中都非常有效。考虑一个简单的一维[弹塑性](@entry_id:193198)模型，其应力 $\sigma$ 在达到屈服后是总应变 $\varepsilon$、初始屈服应力 $\sigma_y$ 和[硬化](@entry_id:177483)模量 $H$ 的函数。如果我们知道 $\sigma_y$ 和 $H$ 是具有给定均值、[标准差](@entry_id:153618)和[相关系数](@entry_id:147037) $\rho$ 的不确定参数，我们就可以推导出应力 $\sigma$ 在塑性区的解析表达式 $\sigma(\varepsilon; \sigma_y, H) = \frac{E\sigma_y + EH\varepsilon}{E+H}$，其中 $E$ 是[杨氏模量](@entry_id:140430)。通过计算 $\sigma$ 对 $\sigma_y$ 和 $H$ 的[偏导数](@entry_id:146280)，并应用[Delta方法](@entry_id:276272)公式，我们可以估算由材料[参数不确定性](@entry_id:264387)引起的应力预测[方差](@entry_id:200758) $\mathrm{Var}_{\text{param}}[\sigma(\varepsilon)]$ [@problem_id:3499880]。

更有趣的是，我们常常需要将不同来源的不确定性结合起来。例如，在有限元模拟中，除了[参数不确定性](@entry_id:264387)，还存在与网格尺寸 $h$ 相关的**[离散化误差](@entry_id:748522)**。这类误差有时可以通过伴随方法 (adjoint-based methods) 估计，并建模为一个独立的、均值为零的[随机变量](@entry_id:195330)，其[方差](@entry_id:200758) $\mathrm{Var}_{\text{disc}}$ 等于[误差估计](@entry_id:141578)值 $\eta_h$ 的平方。假设[离散化误差](@entry_id:748522)与[参数不确定性](@entry_id:264387)统计独立，总[方差](@entry_id:200758)就是两者之和：$\mathrm{Var}_{\text{tot}} = \mathrm{Var}_{\text{param}} + \mathrm{Var}_{\text{disc}}$。

[Delta方法](@entry_id:276272)同样适用于由多个中间计算步骤得到的最终量。例如，在分子动力学 (MD) 模拟中，通过在两个相邻温度 $T_1$ 和 $T_2$ 下的模拟来计算[热容](@entry_id:137594) $C_V$。其估算子通常是一个斜率：$\widehat{C}_V = \frac{E_2^{\text{obs}} - E_1^{\text{obs}}}{T_2^{\text{obs}} - T_1^{\text{obs}}}$，其中 $E_i^{\text{obs}}$ 和 $T_i^{\text{obs}}$ 是在温度 $T_i$ 下观测到的平均总能量和平均温度。这两个观测量本身都带有[统计误差](@entry_id:755391)和由数值积分算法（如时间步长 $\Delta t$）引入的偏差。通过应用[Delta方法](@entry_id:276272)于这个比率函数，我们可以将能量和温度的[方差](@entry_id:200758)及[协方差传播](@entry_id:747989)到最终的 $C_V$ 估计值的不确定性中 [@problem_id:3499863]。

#### 时间序列中的[统计误差](@entry_id:755391)量化

在MD和[蒙特卡洛模拟](@entry_id:193493)中，连续采集的样本（如能量、压力）通常是时间相关的。直接使用[独立同分布](@entry_id:169067)样本的[方差](@entry_id:200758)公式 $\mathrm{Var}(\bar{X}) = \sigma^2/N$ 会严重低估样本均值的真实[方差](@entry_id:200758)。为了正确处理这种相关性，我们需要引入**[积分自相关时间](@entry_id:637326) (integrated autocorrelation time)** $\tau$ 的概念。对于一个平稳时间序列，样本均值的[方差](@entry_id:200758)可以近似为：
$$
\mathrm{Var}(\bar{X}) \approx \frac{\sigma^2}{N} (2\tau)
$$
其中 $\sigma^2$ 是单一样本的[方差](@entry_id:200758)，$N$ 是样本总数。这个表达式可以被直观地理解为：我们将 $N$ 个相关样本“重新打包”成 $N_{\text{eff}} = N/(2\tau)$ 个等效的[独立样本](@entry_id:177139)。$N_{\text{eff}}$ 被称为**有效样本数 (effective sample size)**。

这个原理在许多计算方法中至关重要。以**[热力学积分](@entry_id:156321) (Thermodynamic Integration)** 为例，计算自由能差 $\Delta F = \int_0^1 \langle \frac{\partial U_\lambda}{\partial \lambda} \rangle_\lambda d\lambda$ 需要在多个[耦合参数](@entry_id:747983) $\lambda_i$ 的离散点上进行模拟，以估算被积函数 $\langle X(\lambda_i) \rangle$。每次模拟都会产生一个时间相关的序列。因此，每个 $\bar{X}_i$ 的[方差](@entry_id:200758)都必须使用[积分自相关时间](@entry_id:637326)来计算。当使用[数值积分](@entry_id:136578)规则（如梯形法则）组合这些点时，$\Delta F$ 的估计值是这些 $\bar{X}_i$ 的[线性组合](@entry_id:154743)。因此，$\Delta F$ 的总不确定性可以通过[误差传播公式](@entry_id:275155)计算，该公式不仅包括每个 $\bar{X}_i$ 的[方差](@entry_id:200758)，还可能包括不同 $\lambda_i$ 窗口之间样本均值的协[方差](@entry_id:200758) [@problem_id:3499807]。

#### [离散化误差](@entry_id:748522)的量化：外推法

[离散化误差](@entry_id:748522)是[认知不确定性](@entry_id:149866)的一种，可以通过系统性地改变离散化参数（如网格尺寸 $h$ 或[平面波截断能](@entry_id:753474) $E_{\text{cut}}$）并外推到无限精度（$h \to 0$ 或 $E_{\text{cut}} \to \infty$）来估计和减小。通常假设误差遵循[幂律](@entry_id:143404)形式，例如，对于DFT计算的总能量 $E$，可以假设 $E(E_{\text{cut}}) = E_{\infty} + C E_{\text{cut}}^{-p}$，其中 $E_{\infty}$ 是理想的无限[截断能](@entry_id:177594)下的能量。

**[理查森外推法](@entry_id:137237) (Richardson Extrapolation)** 是一种强大的技术，它利用在一系列[几何级数](@entry_id:158490)变化的离散化参数下得到的结果，来估计收敛值 $E_{\infty}$、收敛阶数 $p$ 和[误差常数](@entry_id:168754) $C$。例如，通过在三个成[等比级数](@entry_id:158490)的[截断能](@entry_id:177594) $E_{\text{cut},1}, E_{\text{cut},2}, E_{\text{cut},3}$ 下进行计算，我们可以建立一个[方程组](@entry_id:193238)来求解这三个未知数。这不仅提供了一个更精确的 $E_{\infty}$ 估计值，还直接量化了在每个特定[截断能](@entry_id:177594)下的[离散化误差](@entry_id:748522)大小 $|E(E_{\text{cut},i}) - E_{\infty}|$ [@problem_id:3499838]。此外，如果原始计算本身带有随机噪声（如迭代求解器中的随机性），我们还可以通过[Delta方法](@entry_id:276272)将这种[噪声传播](@entry_id:266175)到外推值 $E_{\infty}$ 的置信区间上。

#### [全局敏感性分析](@entry_id:171355)：[Sobol'指数](@entry_id:165435)

[误差传播](@entry_id:147381)告诉我们总的不确定性有多大，而**敏感性分析 (Sensitivity Analysis)** 则告诉我们哪个输入参数对输出不确定性的贡献最大。**[全局敏感性分析](@entry_id:171355) (Global Sensitivity Analysis, GSA)** 方法，如基于[方差](@entry_id:200758)的方法，可以在整个输入参数空间内评估参数的重要性。

**[Sobol'指数](@entry_id:165435)** 是最流行的GSA度量之一。它基于所谓的**ANOVA[方差分解](@entry_id:272134)**，将总输出[方差](@entry_id:200758) $V$ 分解为由单个参数、参数对、参数三元组等引起的贡献之和。
- **一阶[Sobol'指数](@entry_id:165435)** $S_i = \frac{\mathrm{Var}_{\theta_i}(\mathbb{E}_{\boldsymbol{\theta}_{\sim i}}[Y|\theta_i])}{V}$，量化了参数 $\theta_i$ 单独对总[方差](@entry_id:200758)的贡献（即“主效应”）。
- **总阶[Sobol'指数](@entry_id:165435)** $T_i = \frac{\mathbb{E}_{\boldsymbol{\theta}_{\sim i}}(\mathrm{Var}_{\theta_i}[Y|\boldsymbol{\theta}_{\sim i}])}{V}$，量化了由 $\theta_i$ 引起的所有[方差](@entry_id:200758)贡献，包括其自身的主效应以及它与其他所有参数的交互效应。

高效估计这些指数的一种标准方法是**Saltelli采样方案**。该方法通过巧妙地组合来自两个[独立样本](@entry_id:177139)矩阵 $\mathbf{A}$ 和 $\mathbf{B}$ 的模型评估结果，构造出对 $S_i$ 和 $T_i$ 分子和分母的[蒙特卡洛估计](@entry_id:637986)量。例如，$S_i$ 的分子可以通过 $\frac{1}{N} \sum_{j=1}^{N} f(\mathbf{b}_j) (f(\mathbf{a}_{j, \sim i}, b_{j,i}) - f(\mathbf{a}_j))$ 来估计，而 $T_i$ 的分子则可以通过 $\frac{1}{2N} \sum_{j=1}^{N} (f(\mathbf{a}_j) - f(\mathbf{a}_{j, \sim i}, b_{j,i}))^2$ 来估计 [@problem_id:3499853]。通过计算这些指数，研究者可以识别出哪些物理参数对模型预测影响最大，从而指导未来的研究重点，例如，应该更精确地测量哪个参数。

### 贝叶斯[不确定性量化](@entry_id:138597)框架

贝叶斯方法为处理和组合多种不确定性来源提供了一个统一且强大的概率框架。其核心是使用[概率分布](@entry_id:146404)来表达对未知量的信念，并利用贝叶斯定理通过观测数据来更新这些信念。

#### [贝叶斯模型平均](@entry_id:168960)

当面临多个竞争性的模型假设（例如，多个不同的赝势或交换关联泛函）时，选择其中任何一个都可能引入不可控的结构不确定性。**[贝叶斯模型平均](@entry_id:168960) (Bayesian Model Averaging, BMA)** 提供了一种不选择单一“最佳”模型，而是综合所有模型预测的原则性方法。

在BMA中，我们为每个模型 $m$ 分配一个先验概率 $\pi(m)$，代表我们对该模型是“真实”模型的初始信念。然后，我们使用一个校准数据集 $\mathcal{D}$ 来计算每个模型的**证据 (evidence)** 或**[边际似然](@entry_id:636856) (marginal likelihood)** $p(\mathcal{D}|m)$。根据贝叶斯定理，模型的后验概率为：
$$
\pi(m|\mathcal{D}) = \frac{p(\mathcal{D}|m)\pi(m)}{\sum_{m'} p(\mathcal{D}|m')\pi(m')}
$$
这个[后验概率](@entry_id:153467) $\pi(m|\mathcal{D})$ 量化了在看到数据后，我们对模型 $m$ 的更新信念。

对于一个新输入 $x^\star$ 的预测，BMA通过对所有模型的预测进行加权平均来得到最终的[预测分布](@entry_id:165741)，权重就是模型的[后验概率](@entry_id:153467)：
$$
p(y^\star|x^\star, \mathcal{D}) = \sum_m p(y^\star|x^\star, m) \pi(m|\mathcal{D})
$$
最终的BMA预测均值和[方差](@entry_id:200758)可以根据全期望和[全方差定律](@entry_id:184705)计算得出。BMA预测的[方差](@entry_id:200758)自然地包含了模型内部的[偶然不确定性](@entry_id:154011)（加权的平[均方差](@entry_id:153618)）和模型之间的[认知不确定性](@entry_id:149866)（预测均值之间的[方差](@entry_id:200758)）[@problem_id:3499797]。

#### 使用高斯过程进行校准和差异建模

在许多情况下，我们知道我们的计算模型（例如DFT）是系统性不准确的。仅仅校准其内部参数可能不足以使其与高精度实验数据匹配。**Kennedy-O'Hagan (KOH) 框架** 提出了一种优雅的解决方案，它明确地对计算模型和现实之间的**差异 (discrepancy)** $\delta(x)$ 进行建模。模型的基本形式是：
$$
y_{\text{exp}}(x) = \eta(x, \theta) + \delta(x) + \epsilon
$$
其中，$y_{\text{exp}}(x)$ 是实验观测值，$\eta(x, \theta)$ 是带有可校准物理参数 $\theta$ 的[计算模型](@entry_id:152639)输出，$\delta(x)$ 是[模型差异](@entry_id:198101)项，$\epsilon$ 是实验[测量噪声](@entry_id:275238)。

在这个框架中，我们通常对未知的函数 $\eta$（如果它计算成本很高）和 $\delta$ 赋予**高斯过程 (Gaussian Process, GP)** 先验。GP是一种灵活的[非参数模型](@entry_id:201779)，它将函数视为一个无限维[高斯分布](@entry_id:154414)中的一个样本点。GP由其[均值函数](@entry_id:264860)和[协方差函数](@entry_id:265031)（或**核函数 (kernel)**）完全定义，后者编码了关于[函数平滑](@entry_id:201048)度、长度尺度等[先验信念](@entry_id:264565)。

通过这个[分层贝叶斯模型](@entry_id:169496)，我们可以：
1.  **构建代理模型**：如果计算模型 $\eta(x, \theta)$ 本身计算成本高昂，我们可以先用少量模拟运行结果训练一个GP代理模型（或称模拟器），该代理模型能以极低的成本在任意 $(x, \theta)$ 点上提供快速的预测均值和[方差](@entry_id:200758) [@problem_id:3499868]。
2.  **校准物理参数**: 利用实验数据 $\mathcal{D} = \{(x_i, y_{\text{exp},i})\}$，我们可以推断出物理参数 $\theta$ 和差异函数 $\delta(x)$ 的后验分布。通常，这涉及计算在给定 $\theta$ 值下的[边际似然](@entry_id:636856)，并找到使该似然最大化的 $\hat{\theta}$。
3.  **量化差异**: GP模型为差异函数 $\delta(x)$ 提供了[后验均值](@entry_id:173826)和置信区间，这使我们能够“学习”到[计算模型](@entry_id:152639)的系统性偏差在何处以及有多大。
4.  **进行不确定性预测**: 在新的输入点 $x^\star$，我们可以得到 $y_{\text{exp}}(x^\star)$ 的[后验预测分布](@entry_id:167931)。这个[分布](@entry_id:182848)会自然地包含来自所有来源的不确定性：校准参数 $\theta$ 的后验不确定性、[计算模型](@entry_id:152639)代理的预测不确定性、[模型差异](@entry_id:198101) $\delta$ 的不确定性，以及[测量噪声](@entry_id:275238) [@problem_id:3499895]。

一个关键的挑战是**[可辨识性](@entry_id:194150) (identifiability)**。如果差异模型 $\delta(x)$ 的GP先验过于灵活（例如，其长度尺度非常小或幅度非常大），它可能会“吸收”本应由物理参数 $\theta$ 解释的变化，导致 $\theta$ 的校准结果不稳定或无意义。因此，在实践中，仔细选择GP先验并评估参数的[可辨识性](@entry_id:194150)至关重要 [@problem_id:3499868]。

### 不确定性模型的验证

最后，一个完整的[不确定性量化](@entry_id:138597)工作流必须包括对其自身预测的验证。我们不仅要问“预测值是什么？”，还要问“我们的[不确定性估计](@entry_id:191096)（即误差棒）本身是否可信？”

一个关键的验证指标是**校准 (calibration)**。一个良好校准的不确定性模型，其预测的概率应该与观测到的频率相匹配。对于[置信区间](@entry_id:142297)或[可信区间](@entry_id:176433)，这意味着一个号称为 $95\%$ 的[可信区间](@entry_id:176433)集合，在长期来看，应该确实包含了大约 $95\%$ 的真实观测值。

我们可以通过计算**经验覆盖率 (empirical coverage)** $\hat{c}$ 来评估这一点。假设我们有一组 $n$ 个留出的实验数据点 $\{y_i\}$，以及对每个数据点预测的 $95\%$ 可信区间 $[L_i, U_i]$。经验覆盖率定义为：
$$
\hat{c} = \frac{1}{n} \sum_{i=1}^{n} \mathbf{1}\{ y_i \in [L_i, U_i] \}
$$
其中 $\mathbf{1}\{\cdot\}$ 是指示函数。

- 如果 $\hat{c} \approx 0.95$，说明我们的UQ模型是良好校准的。
- 如果 $\hat{c} \ll 0.95$，模型是**过分自信 (overconfident)** 的，其预测的误差棒太小。
- 如果 $\hat{c} \gg 0.95$，模型是**过分保守 (underconfident)** 的，其预测的误差棒太大。

计算可信区间 $[L_i, U_i]$ 的方法取决于[后验预测分布](@entry_id:167931)的形式。对于[高斯分布](@entry_id:154414)，它由均值和[标准差](@entry_id:153618)以及标准正态分布的分位数（例如，对于 $95\%$ 区间，$\pm 1.96$）确定。对于由MCMC等方法产生的经验样本集，区间则由样本的经验分位数（例如，$2.5\%$ 和 $97.5\%$ 分位数）确定 [@problem_id:3499869]。通过检查经验覆盖率，我们可以对整个UQ框架的可靠性建立信心，或发现需要改进的地方。