{"hands_on_practices": [{"introduction": "在温度加速动力学（TAD）中，稀有事件的速率通常使用谐振子过渡态理论（HTST）进行估算。该理论中的一个关键参数是尝试频率，即指前因子（$\\nu$），它反映了对速率的熵贡献。本练习将通过一个具体案例，让您亲手根据系统在能量最低点和鞍点处的振动特性来计算指前因子 [@problem_id:3492175]，这对于理解局部势能面如何决定反应动力学至关重要。", "problem": "一个非线性三原子团簇在温度加速动力学 (TAD) 框架内进行模拟。在简谐近似下，初始极小值点和一阶鞍点处的Hessian矩阵已被投影到与刚性平移和旋转正交的三维内振动子空间上。在这个投影子空间中，笛卡尔坐标Hessian矩阵（势能相对于原子笛卡尔位移的二阶导数）是对角矩阵，其对角元以 $\\mathrm{eV}/\\mathrm{\\AA}^{2}$ 为单位，由下式给出：\n- 极小值点: $\\mathrm{diag}(5,\\,12,\\,20)$，\n- 鞍点: $\\mathrm{diag}(-2,\\,8,\\,30)$，\n其中鞍点处的负值对应于沿反应坐标的单一不稳定模式。\n\n所有三个原子都相同，质量为 $m = 28\\,\\mathrm{u}$。使用简谐过渡态理论 (HTST) 和简谐简正模式近似，计算由该鞍点介导的稀有事件的 HTST 尝试频率（指前因子）。明确处理极小值点处的三个内振动模式和鞍点处的两个稳定内振动模式。你可以假设振动配分函数处于经典（高温）极限。物理常数: $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$, $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$, $1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$。\n\n将最终的指前因子以 $\\mathrm{s}^{-1}$ 为单位表示，并将答案四舍五入到三位有效数字。\n\n在你的解答中，完成计算后，简要解释在温度加速动力学中，不同事件的 HTST 指前因子存在巨大差异的物理根源。", "solution": "目标是计算单个反应事件的简谐过渡态理论 (HTST) 尝试频率（指前因子）。我们从正则过渡态理论开始，其速率由下式给出：\n$$\nk = \\frac{k_{B} T}{h}\\,\\frac{Q^{\\ddagger}}{Q^{0}}\\,\\exp\\left(-\\frac{\\Delta E}{k_{B} T}\\right),\n$$\n其中 $Q^{0}$ 是势阱（极小值点）中的振动配分函数，$Q^{\\ddagger}$ 是鞍点处受限于分割面（不包括不稳定模式）的振动配分函数，$\\Delta E$ 是势垒。在简谐近似和经典（高温）极限下，每个稳定的简谐模式对配分函数的贡献因子为 $k_{B} T/(\\hbar \\omega)$，其中 $\\omega$ 是角频率。因此，\n$$\nQ^{0} = \\prod_{i=1}^{f} \\frac{k_{B} T}{\\hbar \\omega_{i}^{(0)}},\\qquad\nQ^{\\ddagger} = \\prod_{j=1}^{f-1} \\frac{k_{B} T}{\\hbar \\omega_{j}^{(\\ddagger)}},\n$$\n其中 $f$ 是极小值点处的内振动模式数（此处 $f=3$），鞍点有 $f-1$ 个稳定模式（此处为 $2$ 个）。因此，\n$$\n\\frac{Q^{\\ddagger}}{Q^{0}} = \\frac{\\hbar}{k_{B} T}\\,\\frac{\\prod_{i=1}^{f} \\omega_{i}^{(0)}}{\\prod_{j=1}^{f-1} \\omega_{j}^{(\\ddagger)}},\n$$\n速率变为\n$$\nk = \\frac{\\hbar}{h}\\,\\frac{\\prod_{i=1}^{f} \\omega_{i}^{(0)}}{\\prod_{j=1}^{f-1} \\omega_{j}^{(\\ddagger)}}\\,\\exp\\left(-\\frac{\\Delta E}{k_{B} T}\\right) = \\frac{1}{2\\pi}\\,\\frac{\\prod_{i=1}^{f} \\omega_{i}^{(0)}}{\\prod_{j=1}^{f-1} \\omega_{j}^{(\\ddagger)}}\\,\\exp\\left(-\\frac{\\Delta E}{k_{B} T}\\right),\n$$\n使用 $\\hbar/h = 1/(2\\pi)$。因此，HTST 尝试频率（指前因子）为\n$$\n\\nu^{*} = \\frac{1}{2\\pi}\\,\\frac{\\prod_{i=1}^{f} \\omega_{i}^{(0)}}{\\prod_{j=1}^{f-1} \\omega_{j}^{(\\ddagger)}}.\n$$\n\n接下来，我们将角频率 $\\omega$ 与 Hessian 特征值联系起来。对于一个具有相同质量 $m$ 且其笛卡尔坐标下的 Hessian 矩阵 $\\mathbf{H}$（单位为 $\\mathrm{eV}/\\mathrm{\\AA}^{2}$）已被投影到内振动子空间的系统，角频率可从质量加权的本征问题得出。由于这些模式是解耦的（给定的 Hessian 矩阵在该子空间中是对角的），每个模式的角频率平方为\n$$\n\\omega^{2} = \\frac{\\lambda\\,c}{m},\n$$\n其中 $\\lambda$ 是对应的 Hessian 对角元（曲率），$c$ 将 $\\mathrm{eV}/\\mathrm{\\AA}^{2}$ 转换为 $\\mathrm{N}/\\mathrm{m}$：\n$$\nc = \\frac{1\\,\\mathrm{eV}}{1\\,\\mathrm{\\AA}^{2}} = \\frac{1.602176634\\times 10^{-19}\\,\\mathrm{J}}{(1.0\\times 10^{-10}\\,\\mathrm{m})^{2}} = 1.602176634\\times 10^{1}\\,\\frac{\\mathrm{N}}{\\mathrm{m}} = 16.02176634\\,\\frac{\\mathrm{N}}{\\mathrm{m}}.\n$$\n原子质量为\n$$\nm = 28\\,\\mathrm{u} = 28\\times 1.66053906660\\times 10^{-27}\\,\\mathrm{kg} = 4.64950938648\\times 10^{-26}\\,\\mathrm{kg}.\n$$\n\n设极小值点的曲率为 $\\lambda^{(0)} = \\{5,\\,12,\\,20\\}$，鞍点的曲率为 $\\lambda^{(\\ddagger)} = \\{-2,\\,8,\\,30\\}$，单位为 $\\mathrm{eV}/\\mathrm{\\AA}^{2}$。只有稳定模式对 $\\nu^{*}$ 有贡献，所以在鞍点我们使用 $\\{8,\\,30\\}$。指前因子为\n$$\n\\nu^{*} = \\frac{1}{2\\pi}\\,\\frac{\\prod_{i=1}^{3} \\omega_{i}^{(0)}}{\\prod_{j=1}^{2} \\omega_{j}^{(\\ddagger)}} = \\frac{1}{2\\pi}\\,\\frac{\\prod_{i=1}^{3} \\sqrt{\\dfrac{\\lambda_{i}^{(0)} c}{m}}}{\\prod_{j=1}^{2} \\sqrt{\\dfrac{\\lambda_{j}^{(\\ddagger)} c}{m}}} = \\frac{1}{2\\pi}\\,\\sqrt{\\frac{c}{m}}\\,\\sqrt{\\frac{\\lambda_{1}^{(0)}\\lambda_{2}^{(0)}\\lambda_{3}^{(0)}}{\\lambda_{1}^{(\\ddagger)}\\lambda_{2}^{(\\ddagger)}}}.\n$$\n代入曲率的数值，\n$$\n\\sqrt{\\frac{\\lambda_{1}^{(0)}\\lambda_{2}^{(0)}\\lambda_{3}^{(0)}}{\\lambda_{1}^{(\\ddagger)}\\lambda_{2}^{(\\ddagger)}}} = \\sqrt{\\frac{5\\times 12\\times 20}{8\\times 30}} = \\sqrt{\\frac{1200}{240}} = \\sqrt{5}.\n$$\n此外，\n$$\n\\sqrt{\\frac{c}{m}} = \\sqrt{\\frac{16.02176634}{4.64950938648\\times 10^{-26}}}\\,\\mathrm{s}^{-1} = \\sqrt{3.4459\\times 10^{26}}\\,\\mathrm{s}^{-1} \\approx 1.856\\times 10^{13}\\,\\mathrm{s}^{-1}.\n$$\n因此，\n$$\n\\nu^{*} = \\frac{1}{2\\pi}\\,\\left(1.856\\times 10^{13}\\right)\\,\\sqrt{5}\\ \\mathrm{s}^{-1}.\n$$\n使用 $\\sqrt{5}\\approx 2.2360679$ 和 $2\\pi \\approx 6.2831853$，\n$$\n\\nu^{*} \\approx \\frac{1.856\\times 10^{13}\\times 2.2360679}{6.2831853}\\ \\mathrm{s}^{-1} \\approx \\frac{4.150\\times 10^{13}}{6.2831853}\\ \\mathrm{s}^{-1} \\approx 6.61\\times 10^{12}\\ \\mathrm{s}^{-1}.\n$$\n四舍五入到三位有效数字，HTST 指前因子为 $6.61\\times 10^{12}\\,\\mathrm{s}^{-1}$。\n\n最后，关于温度加速动力学 (TAD) 中不同事件的指前因子存在巨大差异的物理根源：指前因子通过正交模式频率的比值，编码了势阱和过渡态之间的振动熵差。在初始态中使许多模式显著软化或在鞍点处使模式硬化的事件，可以使频率的乘积改变数个数量级；因此，局部成键拓扑和参与模式子空间的有效质量的差异，导致了巨大的、与事件相关的指前因子变化。", "answer": "$$\\boxed{6.61\\times 10^{12}}$$", "id": "3492175"}, {"introduction": "在运行TAD模拟时，一个核心挑战是如何可靠地区分能量盆之间的真实、已提交的跃迁和短暂的热涨落。一种简单的方法可能会导致对事件速率的严重高估。这个实践问题 [@problem_id:3492213] 旨在挑战您从算法设计的角度思考如何构建一个稳健的事件探测方案，通过对比不同策略，您将理解为何在高温模拟中，结合几何、能量和持续性判据——特别是应用“淬火”操作获取固有结构——对于准确识别事件是必不可少的。", "problem": "一个由 $N$ 个原子组成的系统，作为温度加速动力学 (TAD) 工作流程的一部分，在高温 $T_h$ 下通过恒温分子动力学 (MD) 在一个光滑的势能面 $U(\\mathbf{r})$ 上演化。一个势盆 $A$ 被定义为这样一组构型：对其进行最速下降最小化（即固有结构映射）后，会得到相同的局域最小值 $\\mathbf{x}_A$，其最小化能量为 $E_A^{\\min}$。一个激活事件是指从势盆 $A$ 到另一个不同势盆 $B$ 的跃迁。根据过渡态理论 (TST)，一个真实事件对应于一次反应性穿越，其再穿越行为可忽略不计，且对势盆 $B$ 有很高的提交概率。\n\n你的任务是选择一个鲁棒的在线算法，用于在高温MD过程中检测势盆出口，该算法需要满足：(i) 遵循通过固有结构映射给出的势盆定义，(ii) 符合TST的无再穿越精神，(iii) 避免将由热振动引起的瞬态偏移计为真实的激活事件。请考虑检测算法可能使用的以下量和概念：\n- 质量加权均方根位移 $d_M(\\mathbf{r},\\mathbf{x}) = \\left(\\sum_{i=1}^N m_i \\lVert \\mathbf{r}_i - \\mathbf{x}_i\\rVert^2 / \\sum_{i=1}^N m_i\\right)^{1/2}$。\n- 一个几何滞后对 $(d_{\\mathrm{in}}, d_{\\mathrm{out}})$（其中 $d_{\\mathrm{in}}  d_{\\mathrm{out}}$），用于在势盆 $A$ 周围定义一个模糊边界。\n- 以 $\\Delta t_q$ 为间隔进行周期性淬火，通过能量最小化来获得当前的固有结构索引。\n- 一个能量滞后参数 $\\lambda > 0$，它在一个临时的离开时间 $t_x$ 强制满足条件 $U(\\mathbf{r}(t_x)) - \\min(E_A^{\\min}, E_B^{\\min}) \\ge \\lambda k_B T_h$。\n- 一个持续时间 $\\tau_p$，其大小与最快振动周期成比例，例如 $\\tau_p = c \\, 2\\pi/\\omega_{\\max}$，其中 $c > 1$ 且 $\\omega_{\\max}$ 是 $\\mathbf{x}_A$ 附近的最大简正模式频率。\n- 一个短时提交概率代理：从推定的分裂面构型出发，赋予随机的麦克斯韦-玻尔兹曼速度，并发起 $n$ 次持续时间为 $t_s$ 的短时微正则系综试验，估计其中首先最小化到势盆 $B$ 而非 $A$ 的试验所占比例 $p_B$；要求 $p_B \\ge p^\\*$，其中 $p^\\* \\in (0,1)$。\n\n在TAD的高温MD过程中，以下哪种算法在检测势盆出口方面最为鲁棒且最符合原理？\n\nA. 在 $d_M(\\mathbf{r}(t), \\mathbf{x}_A) \\ge d_{\\mathrm{out}}$ 首次成立时，声明发生了从 $A$ 到 $B$ 的离开。如果之后 $d_M(\\mathbf{r}(t), \\mathbf{x}_A) \\le d_{\\mathrm{in}}$，则视其为返回；否则，接受首次穿越的时间为事件时间。不执行淬火或任何基于能量或持续时间的过滤。\n\nB. 每当 $U(\\mathbf{r}(t)) \\ge E_A^{\\min} + \\Delta E_{\\mathrm{th}}$ 时，声明发生了从 $A$ 的离开，其中 $\\Delta E_{\\mathrm{th}}$ 被选为若干个 $k_B T_h$。通过寻找与 $\\mathbf{r}(t)$ 欧几里得距离最近的最小值来指定目标势盆 $B$。不执行滞后、淬火或持续时间检查。\n\nC. 每隔 $\\Delta t_q$ 执行一次淬火。如果在时间 $t_q$ 最小化后的结构从 $\\mathbf{x}_A$ 变为某个 $\\mathbf{x}_B$，则声明发生了 $A \\to B$ 的离开，并将事件时间 $t_x$ 设置为满足 $d_M(\\mathbf{r}(t_x), \\mathbf{x}_A) \\ge d_{\\mathrm{out}}$ 的最近一个MD帧。不强制执行任何持续时间或提交概率条件，也不在淬火之外施加能量判据。\n\nD. 结合几何、能量和提交概率检查：每隔 $\\Delta t_q$ 通过淬火来维持当前的固有结构。当一次淬火在时间 $t_q$ 首次返回 $\\mathbf{x}_B \\ne \\mathbf{x}_A$ 时，找到最早的时间 $t_x \\le t_q$ 使得 $d_M(\\mathbf{r}(t_x), \\mathbf{x}_A) \\ge d_{\\mathrm{out}}$ 且 $U(\\mathbf{r}(t_x)) - \\min(E_A^{\\min}, E_B^{\\min}) \\ge \\lambda k_B T_h$。然后要求MD轨迹在新势盆 $B$ 中保持至少一个持续时间 $\\tau_p$，期间不重新进入 $A$ 的 $d_{\\mathrm{in}}$ 区域（几何滞后），并可选择性地使用满足 $p_B \\ge p^\\*$ 的短时提交概率代理进行验证。只有这样才在时间 $t_x$ 接受 $A \\to B$ 的离开；否则，将该事件归类为再穿越并继续模拟。\n\n请选择唯一最佳选项。", "solution": "用户提供了一个来自计算材料科学领域的问题，具体涉及温度加速动力学（TAD）。任务是在高温分子动力学模拟过程中，识别出用于检测势盆出口的最鲁棒且最符合原理的算法。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n\n*   **系统：** $N$ 个原子在一个光滑的势能面 $U(\\mathbf{r})$ 上演化。\n*   **方法：** 作为温度加速动力学（TAD）工作流程的一部分，在高温 $T_h$ 下进行恒温分子动力学（MD）。\n*   **势盆定义：** 势盆 $A$ 是这样一组构型，其最速下降最小化（固有结构映射）产生能量为 $E_A^{\\min}$ 的局域最小值 $\\mathbf{x}_A$。\n*   **事件定义：** 一个激活事件是从势盆 $A$ 到另一个不同势盆 $B$ 的跃迁。\n*   **过渡态理论（TST）背景：** 一个真实事件是一次反应性穿越，其再穿越可忽略不计，并对 $B$ 有很高的提交概率。\n*   **目标：** 选择一个鲁棒的在线算法来检测势盆出口。\n*   **算法标准：**\n    1.  遵循通过固有结构映射给出的势盆定义。\n    2.  符合TST的无再穿越理念。\n    3.  避免将瞬态热振动计为真实事件。\n*   **可用工具：**\n    *   质量加权均方根位移：$d_M(\\mathbf{r},\\mathbf{x}) = \\left(\\sum_{i=1}^N m_i \\lVert \\mathbf{r}_i - \\mathbf{x}_i\\rVert^2 / \\sum_{i=1}^N m_i\\right)^{1/2}$。\n    *   几何滞后对：$(d_{\\mathrm{in}}, d_{\\mathrm{out}})$，其中 $d_{\\mathrm{in}}  d_{\\mathrm{out}}$。\n    *   周期性淬火：以 $\\Delta t_q$ 为间隔进行最小化。\n    *   能量滞后参数：$\\lambda > 0$，强制满足 $U(\\mathbf{r}(t_x)) - \\min(E_A^{\\min}, E_B^{\\min}) \\ge \\lambda k_B T_h$。\n    *   持续时间：$\\tau_p$，与最快振动周期成比例。\n    *   短时提交概率代理：$p_B \\ge p^\\*$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题牢固地植根于统计力学和计算物理的既定原理。温度加速动力学（TAD）、固有结构、过渡态理论（TST）和提交概率分析都是研究复杂系统中稀有事件的标准和明确定义的概​​念。定义是准确的。\n*   **良态性：** 这是一个良态问题。它要求基于一组清晰具体的标准（遵循势盆定义、符合TST、过滤噪声）找到“最鲁棒且最符合原理”的算法。这使得对所提选项的评估可以有明确的结论。\n*   **客观性：** 问题以精确、客观和技术性的语言陈述，没有主观或带偏见的措辞。\n*   **完整性：** 问题提供了评估选项所需的所有必要信息和背景。它定义了关键术语和算法的目标。\n*   **一致性：** 所提供的信息内部一致。定义或要求中没有矛盾。\n*   **现实性：** 所描述的场景和算法组件是现实的，反映了研究级别的加速动力学模拟中使用的实际挑战和技术。\n*   **结构：** 问题结构逻辑清晰，在提出评估选项之前设定了背景和标准。这个问题并非无足轻重，因为区分真实的激活事件和热涨落是该领域一个核心且非平凡的挑战。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。它在科学上是合理的，问题定义清晰且完整。现在我将通过分析基本原理并评估每个选项来推导解决方案。\n\n### 解决方案推导\n\n目标是找到一种在TAD中检测势盆出口的算法，该算法与所提供的定义和物理原理一致。一个成功的算法必须满足三个主要要求：\n1.  **正确识别势盆：** 问题根据固有结构来定义势盆，而固有结构是通过能量最小化（淬火）找到的。因此，任何不使用淬火来确定系统处于哪个势盆的算法，都存在根本性缺陷，因为它不遵循问题的核心定义。\n2.  **处理再穿越：** 最简单形式的TST假设任何穿过分隔两个势盆的分裂面的轨迹都是一次成功的跃迁。实际上，在有限温度下，轨迹可以穿过该表面后立即再穿回。一个鲁棒的算法必须过滤掉这些“不成功的尝试”，只计算“已提交”的跃迁。\n3.  **过滤热噪声：** 在TAD中使用的高温 $T_h$ 下，原子振动具有很大的振幅。系统可以探索远离最小几何构型 $\\mathbf{x}_A$ 的构型或达到很高的势能，而实际上并未离开 $A$ 的吸引盆。算法必须区分这些瞬态偏移和真实的越过能垒的事件。\n\n因此，一个符合原理的算法应包含：\n*   **淬火：** 以遵循基于固有结构的势盆定义。\n*   **再穿越过滤器：** 例如要求系统在新势盆中持续一段时间 $\\tau_p$（长于一个振动周期），或直接计算提交概率（committor）。\n*   **合理的事件定义：** 在一个物理上有意义的点确定跃迁，例如在靠近分裂面的轨迹上的一个高能构型。\n\n基于这些原则，我将评估每个选项。\n\n### 逐项分析选项\n\n**A. 在 $d_M(\\mathbf{r}(t), \\mathbf{x}_A) \\ge d_{\\mathrm{out}}$ 首次成立时，声明发生了从 $A$ 到 $B$ 的离开。如果之后 $d_M(\\mathbf{r}(t), \\mathbf{x}_A) \\le d_{\\mathrm{in}}$，则视其为返回；否则，接受首次穿越的时间为事件时间。不执行淬火或任何基于能量或持续时间的过滤。**\n\n该算法使用纯粹的几何判据。\n*   **不满足要求 (1)：** 它不执行淬火。一个大的几何位移 $d_M$ 并不能保证系统进入了一个新的吸引盆。系统可能经历一次大振幅的振动，但仍停留在原始势盆 $A$ 的分水岭区域内。这违反了问题的基本势盆定义。\n*   **不满足要求 (2) 和 (3)：** 如果没有淬火或持续时间检查，该方法极易将大的热涨落计为事件，并且无法可靠地区分已提交的跃迁和再穿越。几何滞后 $(d_{\\mathrm{in}}, d_{\\mathrm{out}})$ 是一个处理此问题的微弱尝试，但其本身并不足够，并且基于一个有缺陷的前提（即仅凭距离就可定义势盆）。\n\n**结论：错误**。\n\n**B. 每当 $U(\\mathbf{r}(t)) \\ge E_A^{\\min} + \\Delta E_{\\mathrm{th}}$ 时，声明发生了从 $A$ 的离开，其中 $\\Delta E_{\\mathrm{th}}$ 被选为若干个 $k_B T_h$。通过寻找与 $\\mathbf{r}(t)$ 欧几里得距离最近的最小值来指定目标势盆 $B$。不执行滞后、淬火或持续时间检查。**\n\n该算法使用纯粹的能量判据。\n*   **不满足要求 (1)：** 它不执行淬火。达到高势能并不能保证势盆跃迁。系统可以将高动能转化为势能，但仍处于势盆 $A$ 中。此外，基于欧几里得距离来指定新势盆并不可靠；势能面上的势盆边界（分水岭）是复杂的，并非基于最小值位置的简单泰森多边形。固有结构映射才是指定的“基准真相”。\n*   **不满足要求 (2) 和 (3)：** 通过在任何能量涨落超过阈值时触发，该方法将在高温下不断触发，将大量失败的尝试计为真实事件。它没有机制来检查提交情况。\n\n**结论：错误**。\n\n**C. 每隔 $\\Delta t_q$ 执行一次淬火。如果在时间 $t_q$ 最小化后的结构从 $\\mathbf{x}_A$ 变为某个 $\\mathbf{x}_B$，则声明发生了 $A \\to B$ 的离开，并将事件时间 $t_x$ 设置为满足 $d_M(\\mathbf{r}(t_x), \\mathbf{x}_A) \\ge d_{\\mathrm{out}}$ 的最近一个MD帧。不强制执行任何持续时间或提交概率条件，也不在淬火之外施加能量判据。**\n\n该算法包含淬火。\n*   **满足要求 (1)：** 它正确地使用固有结构映射（通过淬火）来确认系统的构型现在属于一个新最小值 $\\mathbf{x}_B$ 的吸引盆。这是对A和B的重大改进。\n*   **不满足要求 (2) 和 (3)：** 该算法在第一次淬火显示新势盆时立即声明一个事件。这是不够的。系统可能在淬火前只在新势盆中停留了极短的时间，正处于立即再穿越回 $A$ 的过程中。由于不检查持续时间或提交情况，该算法无法区分已提交的跃迁和穿越分裂面的瞬态偏移。它会通过计算再穿越而高估真实事件速率。\n\n**结论：错误**。\n\n**D. 结合几何、能量和提交概率检查：每隔 $\\Delta t_q$ 通过淬火来维持当前的固有结构。当一次淬火在时间 $t_q$ 首次返回 $\\mathbf{x}_B \\ne \\mathbf{x}_A$ 时，找到最早的时间 $t_x \\le t_q$ 使得 $d_M(\\mathbf{r}(t_x), \\mathbf{x}_A) \\ge d_{\\mathrm{out}}$ 且 $U(\\mathbf{r}(t_x)) - \\min(E_A^{\\min}, E_B^{\\min}) \\ge \\lambda k_B T_h$。然后要求MD轨迹在新势盆 $B$ 中保持至少一个持续时间 $\\tau_p$，期间不重新进入 $A$ 的 $d_{\\mathrm{in}}$ 区域（几何滞后），并可选择性地使用满足 $p_B \\ge p^\\*$ 的短时提交概率代理进行验证。只有这样才在时间 $t_x$ 接受 $A \\to B$ 的离开；否则，将该事件归类为再穿越并继续模拟。**\n\n该算法使用一个多阶段的综合方法。\n*   **满足要求 (1)：** 它使用周期性淬火作为势盆变化的主要和确定性测试，完全遵循了问题的定义。\n*   **满足要求 (2)：** 它以多种方式明确处理了再穿越问题。持续时间检查 ($\\tau_p$) 确保系统已在新势盆中稳定下来，其时间长于典型的振动周期，从而过滤掉振荡性的再穿越。可选的提交概率代理 ($p_B \\ge p^\\*$) 是对提交情况的直接而严格的测试，这是TST校正因子的核心。\n*   **满足要求 (3)：** 所有检查的组合使该算法对热噪声非常鲁棒。一个潜在事件仅由已确认的势盆变化（淬火）触发，跃迁时间 $t_x$ 被确定为一个物理上有意义的高能点，并且只有在通过持续时间/提交测试后才接受该跃迁。这种多层过滤可以鲁棒地将真实的激活事件与瞬态涨落区分开来。\n\n**结论：正确**。该算法系统地整合了鲁棒且符合原理的检测方案所需的所有必要组件。它严格遵守问题的定义，并解决了加速动力学中事件检测的关键物理挑战。", "answer": "$$\\boxed{D}$$", "id": "3492213"}, {"introduction": "基本的过渡态理论（TST）假设任何穿过分隔面的轨迹都会导致成功的反应。然而在现实中，轨迹可能立即重新穿越回到反应物盆，这种效应在高温下尤为显著。为了获得精确的低温速率，必须考虑这些动力学校正。本练习 [@problem_id:3492172] 将向您展示如何使用透射系数 $\\kappa$ 对TST速率进行关键校正，通过编写一个包含从“提交者分析”中获得的 $\\kappa$ 值的计算，您将学会如何修正理论预测，使其更符合系统的真实动力学行为。", "problem": "您的任务是实现一个计算程序，将再穿越修正纳入温度加速动力学 (TAD) 中的低温速率外推。\n\n物理情景如下。TAD 使用高温采样来加速稀有事件，然后外推至一个目标低温。过渡态理论 (TST) 提供了低温下的基准速率，但动力学再穿越使 TST 的无再穿越假设失效。一种标准的修正是使用透射系数，该系数通过在 TAD 退出后启动的短暂的、基于 committor 的轨迹来估计。您的任务是为一个给定的测试套件，以数值上稳健的方式编写此修正的程序。\n\n从以下基本基础开始：\n- 在温度 $T$ 下，态能量的玻尔兹曼分布（其中玻尔兹曼常数为 $k_{\\mathrm{B}}$）是活化过程的基础，给出了克服能垒 $\\Delta E$ 的因子 $\\mathrm{e}^{-\\Delta E/(k_{\\mathrm{B}} T)}$。\n- 过渡态理论 (TST) 预测的基准速率形式为 $k_{\\mathrm{TST}}(T) = \\nu \\,\\mathrm{e}^{-\\Delta E /(k_{\\mathrm{B}} T)}$，其中 $\\nu$ 是尝试频率（指前因子），$\\Delta E$ 是活化能垒。\n- 透射系数，记为 $\\kappa$，通过量化那些真正投入到产物而不返回到反应物的穿越事件所占的比例，来修正 TST 速率以计入再穿越效应。\n\n物理和统计建模假设：\n- 对于与过渡通道 $\\alpha$ 对应的某次 TAD 退出，您从该退出的微观态出发，通过正则速度采样，在低温 $T_\\mathrm{L}$ 下启动 $N_\\alpha$ 条短的、无偏的动力学轨迹。设 $M_\\alpha$ 为这些轨迹中在返回反应物盆之前投入到与 $\\alpha$ 关联的产物盆的轨迹数量。透射系数的基于 committor 的经验估计量为 $\\kappa_\\alpha = M_\\alpha/N_\\alpha$，该值应解释为小数（而非百分比）。\n- 通道 $\\alpha$ 经再穿越修正后的低温速率为\n$$\nk_\\alpha(T_\\mathrm{L}) = \\kappa_\\alpha \\,\\nu_\\alpha \\,\\exp\\left(-\\frac{E_\\alpha}{k_{\\mathrm{B}} T_\\mathrm{L}}\\right).\n$$\n- 使用以电子伏特每开尔文为单位的玻尔兹曼常数：$k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$。\n- 所有活化能垒 $E_\\alpha$ 以电子伏特为单位，所有温度以开尔文为单位，所有尝试频率 $\\nu_\\alpha$ 以 $\\mathrm{s}^{-1}$ 为单位，最终速率 $k_\\alpha(T_\\mathrm{L})$ 必须以 $\\mathrm{s}^{-1}$ 为单位表示。\n\n编程要求：\n- 实现一个程序，对于每个测试用例，计算 $\\kappa_\\alpha = M_\\alpha/N_\\alpha$，然后通过上述公式计算 $k_\\alpha(T_\\mathrm{L})$。\n- 如果出现 $N_\\alpha = 0$ 的情况，定义 $\\kappa_\\alpha = 0$ 以避免除以零的错误；但在提供的测试套件中，所有的 $N_\\alpha$ 都是严格为正的。\n- 在数值上，以科学记数法返回速率，并确保恰好有六位有效数字。\n- 最终的程序输出必须是单行，其中包含一个用方括号括起来的、以逗号分隔的速率列表（例如，$[1.234000\\mathrm{e}{-02},5.678900\\mathrm{e}{+03}]$）。不要在打印输出中包含单位，但所有值都必须理解为以 $\\mathrm{s}^{-1}$ 为单位。\n\n测试套件：\n对于每个案例，给定 $T_\\mathrm{L}$ (开尔文)、$E_\\alpha$ (电子伏特)、$\\nu_\\alpha$ ($\\mathrm{s}^{-1}$)、$N_\\alpha$ (整数) 和 $M_\\alpha$ (整数)。\n- 案例 1（理想路径，伴有轻微再穿越）：$T_\\mathrm{L}=300$, $E_\\alpha=0.700$, $\\nu_\\alpha=1.0\\times 10^{13}$, $N_\\alpha=1000$, $M_\\alpha=980$。\n- 案例 2（显著再穿越）：$T_\\mathrm{L}=300$, $E_\\alpha=0.900$, $\\nu_\\alpha=2.0\\times 10^{13}$, $N_\\alpha=200$, $M_\\alpha=120$。\n- 案例 3（低能垒，小样本 committor 且未观察到再穿越）：$T_\\mathrm{L}=500$, $E_\\alpha=0.300$, $\\nu_\\alpha=5.0\\times 10^{12}$, $N_\\alpha=10$, $M_\\alpha=10$。\n- 案例 4（边缘案例，完全再穿越）：$T_\\mathrm{L}=300$, $E_\\alpha=0.800$, $\\nu_\\alpha=1.0\\times 10^{13}$, $N_\\alpha=50$, $M_\\alpha=0$。\n- 案例 5（边界条件，单次试验）：$T_\\mathrm{L}=600$, $E_\\alpha=1.000$, $\\nu_\\alpha=1.0\\times 10^{13}$, $N_\\alpha=1$, $M_\\alpha=1$。\n\n您的程序应生成单行输出，其中包含按上述案例顺序排列的结果，格式为用方括号括起来的逗号分隔列表，每个值都采用科学记数法，并精确到六位有效数字（例如 $[1.234000\\mathrm{e}{-02},5.678900\\mathrm{e}{+03},\\dots]$）。数值代表以 $\\mathrm{s}^{-1}$ 为单位的 $k_\\alpha(T_\\mathrm{L})$。", "solution": "所述问题具有科学依据、内容自洽且定义明确。它展示了计算材料科学领域内的一个标准计算，具体涉及在温度加速动力学 (TAD) 背景下对过渡态理论 (TST) 速率的修正。所有必需的参数、常数以及关于计算和输出格式的清晰说明均已提供。因此，该问题被视为有效，并将在此给出解决方案。\n\n主要目标是为几个指定的过渡通道（记为 $\\alpha$）计算经再穿越修正的速率常数 $k_\\alpha(T_\\mathrm{L})$。该速率是在低温 $T_\\mathrm{L}$ 下，基于从高温模拟和随后的 committor 分析获得的数据计算得出的。其控制方程如下所示：\n$$\nk_\\alpha(T_\\mathrm{L}) = \\kappa_\\alpha \\,\\nu_\\alpha \\,\\exp\\left(-\\frac{E_\\alpha}{k_{\\mathrm{B}} T_\\mathrm{L}}\\right)\n$$\n该方程结合了三个主要组成部分：\n1. 尝试频率 $\\nu_\\alpha$，它代表了来自 TST 的指前因子，单位为 $\\mathrm{s}^{-1}$。\n2. 玻尔兹曼因子 $\\exp\\left(-\\frac{E_\\alpha}{k_{\\mathrm{B}} T_\\mathrm{L}}\\right)$，它描述了在温度 $T_\\mathrm{L}$ 下拥有足够热能以越过活化能垒 $E_\\alpha$ 的概率。能垒 $E_\\alpha$ 的单位为 $\\mathrm{eV}$，玻尔兹曼常数 $k_{\\mathrm{B}}$ 已提供为 $8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$。因此，乘积 $k_{\\mathrm{B}} T_\\mathrm{L}$ 的单位是 $\\mathrm{eV}$，这使得指数的参数成为无量纲量。\n3. 透射系数 $\\kappa_\\alpha$，它为动力学再穿越修正了 TST 速率。它通过经验方法估计，即成功过渡到产物态的轨迹所占的比例。具体来说，$\\kappa_\\alpha = M_\\alpha/N_\\alpha$，其中 $N_\\alpha$ 是从通道 $\\alpha$ 的过渡态分割面出发的总轨迹数，而 $M_\\alpha$ 是这些轨迹中投入到产物盆的数量。\n\n每个测试用例的计算过程如下：\n首先，根据给定的整数计数 $M_\\alpha$ 和 $N_\\alpha$ 计算透射系数 $\\kappa_\\alpha$。\n其次，计算热能项 $k_{\\mathrm{B}} T_\\mathrm{L}$ 的值。\n第三，计算指数项 $\\exp(-E_\\alpha / (k_{\\mathrm{B}} T_\\mathrm{L}))$。\n最后，将这些部分与尝试频率 $\\nu_\\alpha$ 相乘，得到以 $\\mathrm{s}^{-1}$ 为单位的最终速率 $k_\\alpha(T_\\mathrm{L})$。在 $M_\\alpha = 0$ 的特殊情况下，结果是 $\\kappa_\\alpha = 0$，因此 $k_\\alpha(T_\\mathrm{L}) = 0$。\n\n我们现在将此过程应用于所提供的每个测试用例。\n\n案例 1：\n参数：$T_\\mathrm{L}=300\\,\\mathrm{K}$, $E_\\alpha=0.700\\,\\mathrm{eV}$, $\\nu_\\alpha=1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $N_\\alpha=1000$, $M_\\alpha=980$。\n透射系数为 $\\kappa_1 = M_1/N_1 = 980/1000 = 0.98$。\n热能为 $k_{\\mathrm{B}} T_\\mathrm{L} = (8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}) \\times (300\\,\\mathrm{K}) \\approx 0.025852\\,\\mathrm{eV}$。\n速率为：\n$$\nk_1(300\\,\\mathrm{K}) = 0.98 \\times (1.0 \\times 10^{13}\\,\\mathrm{s}^{-1}) \\times \\exp\\left(-\\frac{0.700\\,\\mathrm{eV}}{0.025852\\,\\mathrm{eV}}\\right) \\approx 1.730990 \\times 10^{1}\\,\\mathrm{s}^{-1}\n$$\n\n案例 2：\n参数：$T_\\mathrm{L}=300\\,\\mathrm{K}$, $E_\\alpha=0.900\\,\\mathrm{eV}$, $\\nu_\\alpha=2.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $N_\\alpha=200$, $M_\\alpha=120$。\n透射系数为 $\\kappa_2 = M_2/N_2 = 120/200 = 0.6$。\n热能 $k_{\\mathrm{B}} T_\\mathrm{L}$ 与案例 1 相同，约为 $0.025852\\,\\mathrm{eV}$。\n速率为：\n$$\nk_2(300\\,\\mathrm{K}) = 0.6 \\times (2.0 \\times 10^{13}\\,\\mathrm{s}^{-1}) \\times \\exp\\left(-\\frac{0.900\\,\\mathrm{eV}}{0.025852\\,\\mathrm{eV}}\\right) \\approx 1.000440 \\times 10^{-2}\\,\\mathrm{s}^{-1}\n$$\n\n案例 3：\n参数：$T_\\mathrm{L}=500\\,\\mathrm{K}$, $E_\\alpha=0.300\\,\\mathrm{eV}$, $\\nu_\\alpha=5.0\\times 10^{12}\\,\\mathrm{s}^{-1}$, $N_\\alpha=10$, $M_\\alpha=10$。\n透射系数为 $\\kappa_3 = M_3/N_3 = 10/10 = 1.0$。\n热能为 $k_{\\mathrm{B}} T_\\mathrm{L} = (8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}) \\times (500\\,\\mathrm{K}) \\approx 0.043087\\,\\mathrm{eV}$。\n速率为：\n$$\nk_3(500\\,\\mathrm{K}) = 1.0 \\times (5.0 \\times 10^{12}\\,\\mathrm{s}^{-1}) \\times \\exp\\left(-\\frac{0.300\\,\\mathrm{eV}}{0.043087\\,\\mathrm{eV}}\\right) \\approx 4.745110 \\times 10^{9}\\,\\mathrm{s}^{-1}\n$$\n\n案例 4：\n参数：$T_\\mathrm{L}=300\\,\\mathrm{K}$, $E_\\alpha=0.800\\,\\mathrm{eV}$, $\\nu_\\alpha=1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $N_\\alpha=50$, $M_\\alpha=0$。\n透射系数为 $\\kappa_4 = M_4/N_4 = 0/50 = 0$。\n速率因此直接确定：\n$$\nk_4(300\\,\\mathrm{K}) = 0 \\times (1.0 \\times 10^{13}\\,\\mathrm{s}^{-1}) \\times \\exp\\left(-\\frac{0.800\\,\\mathrm{eV}}{k_{\\mathrm{B}} \\times 300\\,\\mathrm{K}}\\right) = 0\\,\\mathrm{s}^{-1}\n$$\n在要求的输出格式中，这表示为 $0.000000\\mathrm{e}{+00}\\,\\mathrm{s}^{-1}$。\n\n案例 5：\n参数：$T_\\mathrm{L}=600\\,\\mathrm{K}$, $E_\\alpha=1.000\\,\\mathrm{eV}$, $\\nu_\\alpha=1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $N_\\alpha=1$, $M_\\alpha=1$。\n透射系数为 $\\kappa_5 = M_5/N_5 = 1/1 = 1.0$。\n热能为 $k_{\\mathrm{B}} T_\\mathrm{L} = (8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}) \\times (600\\,\\mathrm{K}) \\approx 0.051704\\,\\mathrm{eV}$。\n速率为：\n$$\nk_5(600\\,\\mathrm{K}) = 1.0 \\times (1.0 \\times 10^{13}\\,\\mathrm{s}^{-1}) \\times \\exp\\left(-\\frac{1.000\\,\\mathrm{eV}}{0.051704\\,\\mathrm{eV}}\\right) \\approx 3.986500 \\times 10^{4}\\,\\mathrm{s}^{-1}\n$$\n\n最终的数值结果，按照示例所暗示的格式，格式化为小数点前有一位数字、小数点后有六位数字的科学记数法，并被汇编成一个单独的列表作为最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes recrossing-corrected low-temperature rates for a series of\n    test cases based on Temperature-Accelerated Dynamics (TAD) principles.\n    \"\"\"\n    \n    # Define the Boltzmann constant in eV/K\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (T_L, E_alpha, nu_alpha, N_alpha, M_alpha)\n    # Units: T_L (K), E_alpha (eV), nu_alpha (s^-1), N_alpha (int), M_alpha (int)\n    test_cases = [\n        (300, 0.700, 1.0e13, 1000, 980),  # Case 1\n        (300, 0.900, 2.0e13, 200, 120),   # Case 2\n        (500, 0.300, 5.0e12, 10, 10),    # Case 3\n        (300, 0.800, 1.0e13, 50, 0),     # Case 4\n        (600, 1.000, 1.0e13, 1, 1),      # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        T_L, E_alpha, nu_alpha, N_alpha, M_alpha = case\n\n        # The problem states that N_alpha is always strictly positive\n        # for the given test suite.\n        # The transmission coefficient kappa_alpha is M_alpha / N_alpha.\n        \n        # If M_alpha is 0, the rate is 0, since kappa_alpha is 0.\n        if M_alpha == 0:\n            rate = 0.0\n        else:\n            kappa_alpha = M_alpha / N_alpha\n            \n            # The rate equation is k_alpha = kappa_alpha * nu_alpha * exp(-E_alpha / (k_B * T_L))\n            # The argument of the exponential is dimensionless as required.\n            exponent_arg = -E_alpha / (k_B * T_L)\n            \n            rate = kappa_alpha * nu_alpha * np.exp(exponent_arg)\n\n        # Format the result to scientific notation with exactly six digits\n        # after the decimal point (seven significant digits total, as per the examples).\n        formatted_result = f\"{rate:.6e}\"\n        results.append(formatted_result)\n\n    # Final print statement in the exact required format.\n    # e.g., [1.234000e-02,5.678900e+03,...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3492172"}]}