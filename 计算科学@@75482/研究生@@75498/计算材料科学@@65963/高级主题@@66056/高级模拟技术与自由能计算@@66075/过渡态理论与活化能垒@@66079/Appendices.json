{"hands_on_practices": [{"introduction": "过渡态理论的核心是将化学反应或扩散事件想象为系统在势能面（Potential Energy Surface, PES）上的运动。这个高维度的“地形图”由系统的能量作为其原子坐标的函数构成。理解这个地形图的特征，即稳定存在的反应物和产物（对应于能量极小值点）以及连接它们的最低能量路径上的“山隘”（对应于鞍点），是计算反应速率的第一步。这个练习 [@problem_id:3499288] 提供了一个基础但至关重要的实践：通过分析一个简单的二维解析势能函数，您将亲手运用梯度和Hessian矩阵等数学工具来定位并区分势能面上的极小值点和鞍点。这不仅能加深您对过渡态几何定义的理解，还能让您掌握计算最基本形式的活化能垒——即鞍点与反应物极小值点之间的能量差——的核心方法。", "problem": "一个与晶体材料中结构序参量相关的二维势能面由函数 $$U(x,y)=a x^{2}-b y^{2}+c x^{4}+d y^{4},$$ 给出，其中 $x$ 和 $y$ 是以埃 ($\\mathrm{\\AA}$) 为单位的集体坐标，$U$ 是以电子伏特 (eV) 为单位的能量。考虑参数集 $$a=0.30\\ \\mathrm{eV}/\\mathrm{\\AA}^{2},\\quad b=0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2},\\quad c=0.20\\ \\mathrm{eV}/\\mathrm{\\AA}^{4},\\quad d=0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}.$$ 使用势能面上驻点（梯度为零）的第一性原理定义，并通过黑塞矩阵特征值进行分类，确定所有驻点的位置和类型。然后，在过渡态理论 (TST) 的假设下，找出控制两个简并盆地之间最小能量路径的指数为1的鞍点，并计算活化能垒，其定义为该鞍点与能量较低的最小值之间的能量差。将最终的能垒能量四舍五入至四位有效数字，并以电子伏特 (eV) 表示。", "solution": "### 解答\n\n势能面由以下函数给出：\n$$U(x,y) = a x^{2} - b y^{2} + c x^{4} + d y^{4}$$\n\n**1. 寻找驻点**\n\n驻点是势能梯度 $\\nabla U$ 为零的位置 $(x, y)$。我们必须求解方程组 $\\frac{\\partial U}{\\partial x} = 0$ 和 $\\frac{\\partial U}{\\partial y} = 0$。\n\n首先，我们计算 $U(x,y)$ 的偏导数：\n$$\\frac{\\partial U}{\\partial x} = 2ax + 4cx^3 = 2x(a + 2cx^2)$$\n$$\\frac{\\partial U}{\\partial y} = -2by + 4dy^3 = 2y(-b + 2dy^2)$$\n\n将这些导数设为零：\n1. $2x(a + 2cx^2) = 0$。当 $x=0$ 或 $a + 2cx^2 = 0$ 时，该方程成立。第二种情况意味着 $x^2 = -\\frac{a}{2c}$。由于给定参数 $a = 0.30  0$ 和 $c = 0.20  0$，它们的比值 $-\\frac{a}{2c}$ 是负数。在这种情况下，$x$ 没有实数解。因此，唯一的实数解是 $x=0$。\n\n2. $2y(-b + 2dy^2) = 0$。当 $y=0$ 或 $-b + 2dy^2 = 0$ 时，该方程成立。第二种情况意味着 $y^2 = \\frac{b}{2d}$，其有实数解 $y = \\pm\\sqrt{\\frac{b}{2d}}$。\n\n结合两个方程的解，我们得到以下驻点：\n*   点 $S_0$: $(x,y) = (0, 0)$\n*   点 $M_+$: $(x,y) = (0, \\sqrt{\\frac{b}{2d}})$\n*   点 $M_-$: $(x,y) = (0, -\\sqrt{\\frac{b}{2d}})$\n\n**2. 驻点分类**\n\n为了对这些点进行分类，我们计算黑塞矩阵 $H$，其元素是 $U(x,y)$ 的二阶偏导数：\n$$H = \\begin{pmatrix} \\frac{\\partial^2 U}{\\partial x^2}  \\frac{\\partial^2 U}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 U}{\\partial y \\partial x}  \\frac{\\partial^2 U}{\\partial y^2} \\end{pmatrix}$$\n所需的二阶导数是：\n$$\\frac{\\partial^2 U}{\\partial x^2} = 2a + 12cx^2$$\n$$\\frac{\\partial^2 U}{\\partial y^2} = -2b + 12dy^2$$\n$$\\frac{\\partial^2 U}{\\partial x \\partial y} = \\frac{\\partial^2 U}{\\partial y \\partial x} = 0$$\n\n由于非对角线元素为零，黑塞矩阵是一个对角矩阵。其特征值 $\\lambda_1$ 和 $\\lambda_2$ 就是其对角线元素：$\\lambda_1 = 2a + 12cx^2$ 和 $\\lambda_2 = -2b + 12dy^2$。\n\n现在我们计算每个驻点处的这些特征值：\n\n*   **点 $S_0 = (0, 0)$:**\n    $\\lambda_1 = 2a + 12c(0)^2 = 2a$\n    $\\lambda_2 = -2b + 12d(0)^2 = -2b$\n    给定 $a  0$ 和 $b  0$，我们有 $\\lambda_1  0$ 和 $\\lambda_2  0$。具有一个正特征值和一个负特征值的点是鞍点。鞍点的指数是负特征值的数量，所以这是一个**指数为1的鞍点**。\n\n*   **点 $M_{\\pm} = (0, \\pm\\sqrt{\\frac{b}{2d}})$:**\n    对这两个点，都有 $x=0$ 和 $y^2 = \\frac{b}{2d}$。\n    $\\lambda_1 = 2a + 12c(0)^2 = 2a$\n    $\\lambda_2 = -2b + 12d\\left(\\frac{b}{2d}\\right) = -2b + 6b = 4b$\n    给定 $a  0$ 和 $b  0$，我们有 $\\lambda_1  0$ 和 $\\lambda_2  0$。当两个特征值都为正时，该驻点是一个**局部极小值点**。\n\n**3. 计算活化能垒**\n\n问题描述了一个连接两个“简并盆地”的过程。两个局部极小值点 $M_+$ 和 $M_-$ 构成了这些盆地。我们可以通过计算它们的势能 $U_{min}$ 来验证它们是简并的。\n在 $M_{\\pm} = (0, \\pm\\sqrt{\\frac{b}{2d}})$ 处，我们有 $x=0$ 和 $y^2 = \\frac{b}{2d}$。\n$$U_{min} = a(0)^2 - b\\left(\\frac{b}{2d}\\right) + c(0)^4 + d\\left(\\frac{b}{2d}\\right)^2$$\n$$U_{min} = -\\frac{b^2}{2d} + d\\left(\\frac{b^2}{4d^2}\\right) = -\\frac{b^2}{2d} + \\frac{b^2}{4d} = -\\frac{2b^2}{4d} + \\frac{b^2}{4d} = -\\frac{b^2}{4d}$$\n由于 $M_+$ 和 $M_-$ 的能量相同，它们确实是简并极小值点。\n\n这两个极小值点之间的最小能量路径必须通过连接它们的鞍点。我们只找到了一个鞍点 $S_0 = (0,0)$，它位于沿 $y$ 轴连接 $M_-$ 和 $M_+$ 的路径上。这是该转变的过渡态。其能量 $U_{saddle}$ 为：\n$$U_{saddle} = U(0,0) = a(0)^2 - b(0)^2 + c(0)^4 + d(0)^4 = 0$$\n\n活化能垒 $\\Delta E_{act}$ 定义为鞍点（过渡态）与极小值点（反应物/产物态）能量之差。\n$$\\Delta E_{act} = U_{saddle} - U_{min}$$\n$$\\Delta E_{act} = 0 - \\left(-\\frac{b^2}{4d}\\right) = \\frac{b^2}{4d}$$\n\n现在，我们代入给定的数值：$b=0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2}$ 和 $d=0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}$。\n$$\\Delta E_{act} = \\frac{(0.90\\ \\mathrm{eV}/\\mathrm{\\AA}^{2})^2}{4 \\times (0.45\\ \\mathrm{eV}/\\mathrm{\\AA}^{4})} = \\frac{0.81\\ \\mathrm{eV}^2/\\mathrm{\\AA}^{4}}{1.80\\ \\mathrm{eV}/\\mathrm{\\AA}^{4}}$$\n$$\\Delta E_{act} = 0.45\\ \\mathrm{eV}$$\n\n问题要求答案四舍五入至四位有效数字。\n$$\\Delta E_{act} = 0.4500\\ \\mathrm{eV}$$", "answer": "$$\n\\boxed{0.4500}\n$$", "id": "3499288"}, {"introduction": "在识别出势能面上的鞍点是理解反应路径的关键之后，一个实际的计算挑战随之而来：对于真实材料中由数百个原子构成的高维系统，我们应如何高效且准确地定位这些鞍点？解析方法在此已不再适用，我们必须依赖于强大的数值算法。微动弹性带（Nudged Elastic Band, NEB）方法是寻找最小能量路径（Minimum Energy Path, MEP）的标准工具之一，但其基本形式只能得到鞍点的近似位置。这个练习 [@problem_id:3499280] 将引导您深入探索一种关键的改进算法——攀爬像微动弹性带（Climbing-Image NEB, CI-NEB）方法。通过分析其对最高能量“像”所施加的独特作用力，您将理解算法设计上的精妙之处，即如何驱动路径上的一个点精确地收敛到一阶鞍点，从而确保活化能垒计算的准确性。", "problem": "你的任务是使用过渡态理论 (TST) 计算势能面上一个原子扩散事件的活化能垒。在计算实践中，该能垒通过一个极小值点和相关的一阶鞍点之间的能量差得到。一种常见的方法是沿着两个极小值点之间的最小能量路径 (MEP) 定位鞍点，该方法使用微动弹性带 (NEB) 方法。该方法通过构型空间中的一组离散的“像” (images) $\\{\\mathbf{R}_i\\}$ 来表示路径，并通过弹性弹簧连接相邻的像，以维持沿路径大致均匀的参数化。在标准NEB方法中，来自势能面 $V(\\mathbf{R})$ 的物理力 $-\\nabla V(\\mathbf{R}_i)$ 被分解为平行于和垂直于局域路径切线 $\\hat{\\boldsymbol{\\tau}}_i$ 的分量，并且只保留垂直分量来弛豫路径形状，而弹簧力则沿着 $\\hat{\\boldsymbol{\\tau}}_i$ 作用。设 $m$ 表示当前沿着弹性带能量最高的像的索引。\n\n从第一性原理的角度来看，一阶鞍点 $\\mathbf{R}^\\ddagger$ 由驻点条件 $\\nabla V(\\mathbf{R}^\\ddagger)=\\mathbf{0}$ 和一个 Hessian 矩阵定义，该矩阵恰好有1个负特征值（不稳定模式）和所有其他正特征值（稳定模式）。考虑对能量最高的像进行修改，改变其等效力，使其沿局域切线被向上坡方向驱动至鞍点，同时仍在垂直于路径的方向上向下坡方向弛豫。假设使用类最速下降动力学 $\\dot{\\mathbf{R}}_i=\\mathbf{F}_i$ 来弛豫各个像。\n\n哪个选项正确地给出了能量最高的像上修正后的力，并正确解释了为什么这种改变会导致直接收敛到对应于MEP上能垒的一阶鞍点？\n\nA. 保留标准NEB力，即只使用物理力的垂直分量和弹簧力来维持间距：$\\mathbf{F}_m=-\\nabla V(\\mathbf{R}_m)_\\perp + k\\Delta s_m\\,\\hat{\\boldsymbol{\\tau}}_m$，其中 $k$ 是弹簧常数，$\\Delta s_m=\\left\\lVert \\mathbf{R}_{m+1}-\\mathbf{R}_m\\right\\rVert - \\left\\lVert \\mathbf{R}_m-\\mathbf{R}_{m-1}\\right\\rVert$。这确保了路径极值点与鞍点重合，因为垂直方向的弛豫消除了所有横向力。\n\nB. 移除能量最高的像的所有弹簧力贡献，并仅反转平行于切线的物理力分量，同时保留垂直物理力，得到 $\\mathbf{F}_m=-\\nabla V(\\mathbf{R}_m)+2\\left(\\nabla V(\\mathbf{R}_m)\\cdot \\hat{\\boldsymbol{\\tau}}_m\\right)\\hat{\\boldsymbol{\\tau}}_m$。这将能量最高的像沿 $\\hat{\\boldsymbol{\\tau}}_m$ 向上坡方向驱动，而在垂直于 $\\hat{\\boldsymbol{\\tau}}_m$ 的方向向下坡方向驱动，因此在收敛时 $\\nabla V(\\mathbf{R}_m)=\\mathbf{0}$，并且线性化动力学在一阶鞍点周围的所有方向上都是稳定的。\n\nC. 仅增加能量最高的像的纵向弹簧常数，以迫使其过冲并在能垒周围振荡，使用 $\\mathbf{F}_m=-\\nabla V(\\mathbf{R}_m)_\\perp + \\alpha k\\Delta s_m\\,\\hat{\\boldsymbol{\\tau}}_m$，其中 $\\alpha1$。围绕最大值的振荡保证了向鞍点的收敛，因为阻尼会将其置于极值点中心。\n\nD. 反转能量最高的像的物理力垂直分量，以加速其脱离初始势阱，同时保留沿切线的弹簧力：$\\mathbf{F}_m=+\\nabla V(\\mathbf{R}_m)_\\perp + k\\Delta s_m\\,\\hat{\\boldsymbol{\\tau}}_m$。这将像沿上坡方向送离路径，从而通过脱离MEP约束更快地找到附近的鞍点。\n\nE. 通过沿梯度方向添加一个拉格朗日乘子 $\\lambda$，将能量最高的像约束在一个恒定能量超曲面上，得到 $\\mathbf{F}_m=-\\nabla V(\\mathbf{R}_m)+\\lambda\\,\\nabla V(\\mathbf{R}_m)$，其中 $\\lambda$ 的选择是为了保持 $V(\\mathbf{R}_m)$ 固定。这确保了向鞍点的收敛，因为驻点位于恒能面上，而像会探索该曲面直到达到 $\\nabla V=\\mathbf{0}$。", "solution": "### 解题思路\n\n这个问题的目标是修改作用在微动弹性带（NEB）中能量最高的像（image）$\\mathbf{R}_m$ 上的力 $\\mathbf{F}_m$，以使其精确收敛到一阶鞍点 $\\mathbf{R}^\\ddagger$。这种修改后的方法被称为“攀爬像微动弹性带”（Climbing-Image NEB, CI-NEB）。\n\n**1. 一阶鞍点的特征：**\n一阶鞍点在势能面上是一个特殊的驻点，其梯度为零，即 $\\nabla V(\\mathbf{R}^\\ddagger) = \\mathbf{0}$。它在沿着最小能量路径（MEP）的方向上是能量的极大值，而在所有与该路径正交的方向上都是能量的极小值。\n\n**2. 攀爬像的目标：**\n为了让能量最高的像 $\\mathbf{R}_m$ 能够“攀爬”到并停留在鞍点上，作用在它上面的力 $\\mathbf{F}_m$ 必须实现两个目标：\n-   **沿路径方向最大化能量**：这意味着力在路径切线 $\\hat{\\boldsymbol{\\tau}}_m$ 方向上的分量必须指向能量“上坡”的方向，即与势能梯度 $\\nabla V$ 在该方向上的投影同向。\n-   **在垂直于路径的方向上最小化能量**：这意味着力在所有垂直于 $\\hat{\\boldsymbol{\\tau}}_m$ 的方向上的分量必须指向能量“下坡”的方向，即与物理力 $-\\nabla V$ 在这些方向上的投影同向。\n\n**3. 构建攀爬像的力：**\n我们将物理力 $\\mathbf{F}_{\\text{phys}} = -\\nabla V(\\mathbf{R}_m)$ 分解为平行于切线的分量 $\\mathbf{F}_{\\text{phys},\\parallel}$ 和垂直于切线的分量 $\\mathbf{F}_{\\text{phys},\\perp}$。\n$$ \\mathbf{F}_{\\text{phys},\\parallel} = (\\mathbf{F}_{\\text{phys}} \\cdot \\hat{\\boldsymbol{\\tau}}_m) \\hat{\\boldsymbol{\\tau}}_m = -(\\nabla V \\cdot \\hat{\\boldsymbol{\\tau}}_m) \\hat{\\boldsymbol{\\tau}}_m $$\n$$ \\mathbf{F}_{\\text{phys},\\perp} = \\mathbf{F}_{\\text{phys}} - \\mathbf{F}_{\\text{phys},\\parallel} = -\\nabla V_\\perp $$\n标准NEB方法中，为了防止像沿路径滑下，会移除物理力的平行分量。对于攀爬像，我们更进一步：\n-   为了实现能量最小化，我们保留垂直分量 $\\mathbf{F}_{\\text{phys},\\perp} = -\\nabla V_\\perp$。\n-   为了实现能量最大化，我们反转平行分量，即使用 $-\\mathbf{F}_{\\text{phys},\\parallel}$。这使得像被推向能量更高处。\n-   同时，我们移除连接相邻像的弹簧力，因为弹簧力会把攀爬像从能量最高点拉开。\n\n因此，攀爬像上的总力为：\n$$ \\mathbf{F}_m = \\mathbf{F}_{\\text{phys},\\perp} - \\mathbf{F}_{\\text{phys},\\parallel} $$\n代入梯度的表达式：\n$$ \\mathbf{F}_m = (-\\nabla V_\\perp) - (-(\\nabla V \\cdot \\hat{\\boldsymbol{\\tau}}_m) \\hat{\\boldsymbol{\\tau}}_m) = -\\nabla V + (\\nabla V \\cdot \\hat{\\boldsymbol{\\tau}}_m)\\hat{\\boldsymbol{\\tau}}_m + (\\nabla V \\cdot \\hat{\\boldsymbol{\\tau}}_m)\\hat{\\boldsymbol{\\tau}}_m $$\n$$ \\mathbf{F}_m = -\\nabla V(\\mathbf{R}_m) + 2(\\nabla V(\\mathbf{R}_m) \\cdot \\hat{\\boldsymbol{\\tau}}_m)\\hat{\\boldsymbol{\\tau}}_m $$\n\n当像收敛时，$\\mathbf{F}_m = \\mathbf{0}$。这意味着力的平行和垂直分量都必须为零。分析可知，这等价于势能的梯度 $\\nabla V(\\mathbf{R}_m)$ 为零。因此，该算法驱动像收敛到一个驻点。由于力的构造是沿一个方向最大化能量，而在其他所有方向最小化能量，这个驻点正是一阶鞍点。\n\n### 逐项分析\n\n**A.** 这是标准NEB方法的描述。标准方法中，能量最高的像并不精确位于鞍点，而是处在相邻像之间的一个插值位置。因为弹簧力的存在，它会被拉离真正的能量极大值点。因此，该选项错误。\n\n**B.** 这个选项给出的力的表达式 $\\mathbf{F}_m=-\\nabla V(\\mathbf{R}_m)+2\\left(\\nabla V(\\mathbf{R}_m)\\cdot \\hat{\\boldsymbol{\\tau}}_m\\right)\\hat{\\boldsymbol{\\tau}}_m$ 与我们推导出的CI-NEB力完全一致。其解释也是正确的：该力将像沿切线方向“向上推”，同时在垂直方向上使其“向下滑”到MEP上。这个过程最终将像驱动到梯度为零的一阶鞍点。因此，该选项正确。\n\n**C.** 增加弹簧常数只会使能量最高的像更紧地束缚在其邻居之间，从而更偏离真实的鞍点。这种方法与目标背道而驰。因此，该选项错误。\n\n**D.** 反转物理力的垂直分量（$+\\nabla V(\\mathbf{R}_m)_\\perp$）会使像主动偏离最小能量路径，导致计算发散，而不是收敛到路径上的鞍点。因此，该选项错误。\n\n**E.** 将像约束在恒定能量的超曲面上与“攀爬”到能量极大值的目标相矛盾。这种方法无法让像的能量增加，也就无法找到能垒的顶点。因此，该选项错误。", "answer": "$$\\boxed{B}$$", "id": "3499280"}, {"introduction": "我们从势能面计算出的能垒 $\\Delta E_0$ 实质上是一个在绝对零度（$0$ K）下的概念，它忽略了原子在有限温度下的振动。然而，真实的化学反应发生在有限温度下，系统的行为由自由能（Free Energy）而非仅仅是势能所决定。过渡态理论的完整框架通过引入配分函数（Partition Functions）来计入振动熵（vibrational entropy）的贡献，从而将势能能垒提升为温度依赖的活化自由能 $\\Delta G^\\ddagger(T)$。这个练习 [@problem_id:3499291] 将指导您从基本原理出发，对比标准的简谐近似（Harmonic Approximation）与包含非简谐效应的模型。通过动手计算并量化非简谐性对过渡态配分函数及活化自由能的影响，您将深刻体会到简谐模型的局限性，并理解振动熵在精确预测实际反应速率中的关键作用。", "problem": "要求您针对二维材料上吸附物表面扩散的模型，将过渡态理论 (TST) 的经典谐振近似与非谐校正进行基准比较。重点是量化在过渡态分割面上，由横向振动模式中的四次非谐性所导致的活化自由配分函数及其相关自由能垒的偏差。\n\n考虑一个用于描述在二维晶格上扩散的经典、可分离的模型势能面，其坐标为 $x$ (反应坐标) 和 $y$ (横向坐标)。反应物势阱被建模为一个谐振势阱，其势能为\n$$\nU_r(x,y) = \\tfrac{1}{2} k_x^{(r)} x^2 + \\tfrac{1}{2} k_y^{(r)} y^2,\n$$\n其最小能量设为 $0$。过渡态 (鞍点) 位于 $x=0, y=0$ 处，其能量比反应物能量最低点高 $E_s = \\Delta E_0$。在过渡态分割面 $x=0$ 处，横向恢复势被建模为\n$$\nU^\\ddagger(y) = \\tfrac{1}{2} k_y^{(\\ddagger)} y^2 + \\tfrac{1}{4} \\alpha y^4,\n$$\n其中 $\\alpha \\ge 0$ 表征了四次非谐性的强度。在整个问题中，将 $x$ 视为鞍点处的不稳定坐标 (从过渡态配分函数中排除)，并将 $y$ 视为稳定横向坐标。\n\n在温度为 $T$ 的经典正则系综中进行计算，逆热能为 $\\beta = 1/(k_B T)$，其中 $k_B$ 是玻尔兹曼常数。对于此问题，使用由构型空间积分定义的构型正则配分函数\n$$\nZ_{\\mathrm{conf}, r} = \\iint_{\\mathbb{R}^2} \\exp\\!\\left[-\\beta \\, U_r(x,y)\\right] \\, dx \\, dy,\n\\qquad\nZ_{\\mathrm{conf}, \\ddagger} = \\int_{\\mathbb{R}} \\exp\\!\\left[-\\beta \\, U^\\ddagger(y)\\right] \\, dy,\n$$\n并将活化自由配分函数解释为 $Z^\\ddagger \\equiv Z_{\\mathrm{conf}, \\ddagger}$，即分割面上的约束构型配分函数。谐振近似对应于在 $U^\\ddagger(y)$ 中设置 $\\alpha = 0$，而非谐模型使用给定的 $\\alpha \\ge 0$。\n\n从经典正则配分函数和经典自由能 $F_{\\mathrm{conf}} = -k_B T \\ln Z_{\\mathrm{conf}}$ 的基本定义出发，完成以下任务：\n\n1. 在谐振极限 $\\alpha = 0$ 下，推导 $Z_{\\mathrm{conf}, r}$ 和 $Z_{\\mathrm{conf}, \\ddagger}$ 的解析表达式。然后，当 $\\alpha  0$ 时，推导一个可以通过一维数值积分计算的、$Z_{\\mathrm{conf}, \\ddagger}$ 的数值上易于处理的表达式。\n\n2. 使用这些定义，定义构型活化自由能垒\n$$\nE_{a,\\mathrm{har}}(T) = \\Delta E_0 - k_B T \\ln\\!\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, r}}\\right),\n\\qquad\nE_{a,\\mathrm{anh}}(T) = \\Delta E_0 - k_B T \\ln\\!\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, r}}\\right),\n$$\n以及活化自由配分函数的相对偏差\n$$\n\\delta Z^\\ddagger = \\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} - Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}.\n$$\n注意 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T) = -k_B T \\ln\\!\\left(Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} / Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}\\right)$ 仅取决于过渡态积分。\n\n3. 实现一个程序，对于下面测试套件中的每个参数集，计算两个输出：标量 $\\delta Z^\\ddagger$ (无单位，以小数表示) 和标量 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$ (单位为电子伏特)。所有数值积分都必须以足够的精度执行，以产生稳定的结果。\n\n物理单位与常数：\n- 能量单位使用电子伏特 (eV)，长度单位使用埃 (Å)，温度单位使用开尔文 (K)。\n- 使用 $k_B = 8.617333262145 \\times 10^{-5}$ eV/K。\n- 弹性常数 $k$ 的单位为 eV/Å$^2$，四次项系数 $\\alpha$ 的单位为 eV/Å$^4$。\n\n测试套件 (每个案例是一个元组 $(T,\\; \\Delta E_0,\\; k_x^{(r)},\\; k_y^{(r)},\\; k_y^{(\\ddagger)},\\; \\alpha)$):\n- 案例 1 (谐振参考): $(300,\\; 0.45,\\; 0.7,\\; 0.9,\\; 0.8,\\; 0.0)$\n- 案例 2 (高温，中等非谐性): $(1200,\\; 0.45,\\; 0.7,\\; 0.9,\\; 0.8,\\; 0.5)$\n- 案例 3 (强非谐性，较软的横向模式): $(800,\\; 0.35,\\; 0.6,\\; 0.6,\\; 0.5,\\; 2.0)$\n- 案例 4 (低温，非零非谐性): $(50,\\; 0.20,\\; 1.0,\\; 1.0,\\; 1.0,\\; 1.0)$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 对于每个案例，按顺序输出两个数字：首先是 $\\delta Z^\\ddagger$ (无单位，小数形式)，然后是 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$ (单位为 eV)。按给定顺序连接所有案例的结果。\n- 将每个浮点结果四舍五入到恰好 $8$ 位小数。\n- 例如，输出格式必须为以下形式\n  $$\n  [\\delta Z^\\ddagger_1,\\; \\Delta E_{a,1},\\; \\delta Z^\\ddagger_2,\\; \\Delta E_{a,2},\\; \\delta Z^\\ddagger_3,\\; \\Delta E_{a,3},\\; \\delta Z^\\ddagger_4,\\; \\Delta E_{a,4}]\n  $$\n  其中 $\\Delta E_{a,i} = E_{a,\\mathrm{anh}}(T_i) - E_{a,\\mathrm{har}}(T_i)$，单位为 eV。\n\n科学真实性与约束条件：\n- 假设对于所提供的温度，经典极限是有效的。\n- 确保 $\\alpha \\ge 0$，以使非谐积分是可归一化的。\n- 程序必须是完全自包含的，并在无需用户输入的情况下执行所有计算。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表 (例如，\"[result1,result2,result3,...]\")。", "solution": "### 解题思路\n\n该问题要求基于经典过渡态理论（TST），量化表面扩散模型中非谐效应对活化自由能垒的影响。这需要推导经典构型配分函数的表达式，然后为给定的测试用例实现数值计算。问题的核心是比较过渡态处横向振动模式的谐振近似与包含四次项的非谐模型。\n\n需要计算的两个关键量是：\n1.  **活化自由配分函数的相对偏差** $\\delta Z^\\ddagger$：它量化了非谐性对过渡态配分函数的改变程度。\n2.  **活化自由能垒的变化** $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$：它量化了非谐性对最终计算出的活化能的影响。\n\n**1. 配分函数的推导**\n\n我们首先在逆温度为 $\\beta = 1/(k_B T)$ 的经典正则系综中推导所需的配分函数表达式。\n\n-   **反应物配分函数 $Z_{\\mathrm{conf}, r}$**：\n    反应物势能为 $U_r(x,y) = \\tfrac{1}{2} k_x^{(r)} x^2 + \\tfrac{1}{2} k_y^{(r)} y^2$。其构型配分函数是两个独立高斯积分的乘积：\n    $$\n    Z_{\\mathrm{conf}, r} = \\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta k_x^{(r)}}{2} x^2} dx \\cdot \\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta k_y^{(r)}}{2} y^2} dy\n    $$\n    使用标准高斯积分公式 $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$，我们得到：\n    $$\n    Z_{\\mathrm{conf}, r} = \\sqrt{\\frac{2\\pi}{\\beta k_x^{(r)}}} \\cdot \\sqrt{\\frac{2\\pi}{\\beta k_y^{(r)}}} = \\frac{2\\pi}{\\beta \\sqrt{k_x^{(r)} k_y^{(r)}}}\n    $$\n\n-   **谐振过渡态配分函数 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}$**：\n    在谐振近似下（$\\alpha=0$），过渡态分割面上的势能为 $U^\\ddagger(y)|_{\\alpha=0} = \\tfrac{1}{2} k_y^{(\\ddagger)} y^2$。配分函数是一个一维高斯积分：\n    $$\n    Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)} = \\int_{-\\infty}^{\\infty} e^{-\\frac{\\beta k_y^{(\\ddagger)}}{2} y^2} dy = \\sqrt{\\frac{2\\pi}{\\beta k_y^{(\\ddagger)}}}\n    $$\n\n-   **非谐过渡态配分函数 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}$**：\n    当包含非谐项时（$\\alpha > 0$），势能为 $U^\\ddagger(y) = \\tfrac{1}{2} k_y^{(\\ddagger)} y^2 + \\tfrac{1}{4} \\alpha y^4$。配分函数为：\n    $$\n    Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} = \\int_{-\\infty}^{\\infty} \\exp\\left[-\\beta \\left( \\tfrac{1}{2} k_y^{(\\ddagger)} y^2 + \\tfrac{1}{4} \\alpha y^4 \\right)\\right] dy\n    $$\n    这个积分没有简单的解析解，必须通过数值方法（如`scipy.integrate.quad`）进行计算。\n\n**2. 计算目标量**\n\n-   **相对偏差 $\\delta Z^\\ddagger$**：\n    根据定义，我们有：\n    $$\n    \\delta Z^\\ddagger = \\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)} - Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}} = \\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}} - 1\n    $$\n    这需要分别计算谐振（解析）和非谐（数值）配分函数，然后求比值。\n\n-   **活化自由能垒的变化**：\n    我们计算两个能垒之差：\n    $$\n    E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T) = \\left(\\Delta E_0 - k_B T \\ln\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, r}}\\right) - \\left(\\Delta E_0 - k_B T \\ln\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, r}}\\right)\n    $$\n    $$\n    = -k_B T \\left( \\ln\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, r}} - \\ln\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}{Z_{\\mathrm{conf}, r}} \\right) = -k_B T \\ln\\left(\\frac{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}}{Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}}\\right)\n    $$\n    这个差值可以方便地用 $\\delta Z^\\ddagger$ 表示：\n    $$\n    E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T) = -k_B T \\ln\\left(1 + \\delta Z^\\ddagger\\right)\n    $$\n    这个简化的表达式表明，我们只需要计算过渡态配分函数的比值即可，无需计算反应物配分函数 $Z_{\\mathrm{conf}, r}$。\n\n**物理直觉**：\n当 $\\alpha  0$ 时，非谐项 $\\frac{1}{4}\\alpha y^4$ 是一个“硬化”势，它使得势能比纯谐振势增长得更快。这限制了系统在横向上的振动范围，导致玻尔兹曼因子 $\\exp(-\\beta U^\\ddagger(y))$ 在积分中贡献更小。因此，我们预期 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}  Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}$，这意味着 $\\delta Z^\\ddagger$ 将为负值。相应地，能量差 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$ 将为正值，表明这种类型的非谐性增加了活化自由能垒，从而降低了反应速率。\n\n**计算步骤**：\n对于每个测试案例，程序将执行以下操作：\n1.  计算逆热能 $\\beta = 1/(k_B T)$。\n2.  如果 $\\alpha=0$（谐振情况），则 $\\delta Z^\\ddagger$ 和能量差均为0。\n3.  如果 $\\alpha > 0$（非谐情况）：\n    a. 解析计算谐振配分函数 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha=0)}$。\n    b. 数值计算非谐配分函数 $Z_{\\mathrm{conf}, \\ddagger}^{(\\alpha0)}$。\n    c. 根据上述公式计算 $\\delta Z^\\ddagger$。\n    d. 根据简化的公式计算能量差 $E_{a,\\mathrm{anh}}(T) - E_{a,\\mathrm{har}}(T)$。\n4.  将结果按要求的格式存储并输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the deviation in the activation partition function and free energy\n    barrier due to quartic anharmonicity for a model of surface diffusion.\n    \"\"\"\n    \n    # Physical constant\n    # k_B in eV/K\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (T, Delta_E0, kx_r, ky_r, ky_ts, alpha)\n    # Units: T(K), Delta_E0(eV), k(eV/A^2), alpha(eV/A^4)\n    test_cases = [\n        (300, 0.45, 0.7, 0.9, 0.8, 0.0),   # Case 1 (harmonic reference)\n        (1200, 0.45, 0.7, 0.9, 0.8, 0.5),  # Case 2 (high T, moderate anharmonicity)\n        (800, 0.35, 0.6, 0.6, 0.5, 2.0),   # Case 3 (strong anharmonicity, soft mode)\n        (50, 0.20, 1.0, 1.0, 1.0, 1.0),    # Case 4 (low T, nonzero anharmonicity)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T, _, _, _, ky_ts, alpha = case\n        \n        # If alpha is zero, the model is purely harmonic.\n        # The anharmonic partition function equals the harmonic one.\n        # Thus, the deviation delta_Z and the energy difference are zero.\n        if alpha == 0.0:\n            delta_Z_val = 0.0\n            energy_diff_val = 0.0\n            results.extend([f\"{delta_Z_val:.8f}\", f\"{energy_diff_val:.8f}\"])\n            continue\n\n        # For alpha > 0, proceed with the full calculation.\n        \n        # Calculate inverse thermal energy beta in 1/eV\n        beta = 1.0 / (k_B * T)\n        \n        # 1. Calculate the harmonic partition function at the transition state (Z_har)\n        # Z_har = sqrt(2*pi / (beta * k))\n        Z_har = np.sqrt(2 * np.pi / (beta * ky_ts))\n        \n        # 2. Define the integrand for the anharmonic partition function (Z_anh)\n        # The integrand is the Boltzmann factor for the anharmonic potential.\n        def anharmonic_integrand(y, b, k, a):\n            exponent = -b * (0.5 * k * y**2 + 0.25 * a * y**4)\n            return np.exp(exponent)\n            \n        # 3. Numerically integrate to get the anharmonic partition function\n        # The integration is from -infinity to +infinity.\n        Z_anh, integral_error = quad(\n            anharmonic_integrand, -np.inf, np.inf, args=(beta, ky_ts, alpha)\n        )\n\n        # 4. Compute the relative deviation in the partition function (delta_Z)\n        # delta_Z = (Z_anh - Z_har) / Z_har\n        delta_Z_val = (Z_anh / Z_har) - 1.0\n        \n        # 5. Compute the difference in activation free energy (in eV)\n        # delta_Ea = E_anh - E_har = -k_B*T * ln(Z_anh / Z_har)\n        # This is equivalent to -k_B*T * ln(1 + delta_Z)\n        energy_diff_val = -k_B * T * np.log(1.0 + delta_Z_val)\n        \n        # Append formatted results to the list\n        results.extend([f\"{delta_Z_val:.8f}\", f\"{energy_diff_val:.8f}\"])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3499291"}]}