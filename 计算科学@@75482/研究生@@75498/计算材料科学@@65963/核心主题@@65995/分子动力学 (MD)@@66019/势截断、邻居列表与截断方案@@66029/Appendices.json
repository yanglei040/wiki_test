{"hands_on_practices": [{"introduction": "为了在分子动力学模拟中实现计算效率，通常需要截断原子间的相互作用势。最直接的方法是在一个确定的截断半径 $r_c$ 处进行“硬”截断。本练习将引导你分析这种简单方法的后果，通过直接计算势能和力在截断点的不连续性，你将从根本上理解为何硬截断方案会导致能量不守恒和模拟的不稳定。[@problem_id:3479655]", "problem": "考虑一个由相同粒子组成的系统，这些粒子通过Lennard-Jones对势相互作用，其表达式为 $U(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$，其中 $r$ 是粒子间距，$\\epsilon$ 设定了能量标度，$\\sigma$ 设定了长度标度。在一个使用邻居列表和硬截断方案的分子动力学（MD）模拟中，截断势 $U_{\\text{tr}}(r)$ 的定义是：仅当间距 $r \\le r_c$ 时才计算相互作用。", "solution": "我们从Lennard-Jones对势开始，其表达式为\n$$\nU(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right].\n$$\n在 $r=r_c$ 处进行硬截断的截断势 $U_{\\text{tr}}(r)$ 由以下分段结构定义\n$$\nU_{\\text{tr}}(r)=\n\\begin{cases}\nU(r),  r \\le r_c \\\\\n0,  r > r_c\n\\end{cases}\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n4\\epsilon\\left[\\left(\\frac{\\sigma}{r_c}\\right)^{12}-\\left(\\frac{\\sigma}{r_c}\\right)^{6}\\right] \\\\ \\frac{24\\epsilon}{r_c}\\left[2\\left(\\frac{\\sigma}{r_c}\\right)^{12}-\\left(\\frac{\\sigma}{r_c}\\right)^{6}\\right]\n\\end{pmatrix}}$$", "id": "3479655"}, {"introduction": "简单的硬截断会导致力和能量的不连续，从而影响模拟的准确性。为了解决这个问题，我们可以引入一个切换函数，在截断区域内平滑地将相互作用势衰减至零。通过本练习，你将亲自推导出一个满足特定边界条件的多项式切换函数，以确保势能及其一阶和二阶导数的连续性，这是实现能量精确守恒和算法稳定性的关键一步。[@problem_id:3479715]", "problem": "在凝聚态物质的大尺度分子动力学（MD）模拟中，为了实现高效的邻居列表构建，通常会在一个有限的截断半径处截断对相互作用势。在一个有限的切换壳层上进行平滑截断，可以防止势能面的能量、力和Hessian矩阵出现非物理的不连续性。考虑一个二次连续可微的对势 $U(r)$，该势将在切换半径 $r_s$ 和截断半径 $r_c$ 之间被平滑地关闭，其中 $0  r_s  r_c$。", "solution": "在尝试任何解答之前，对问题陈述进行严格的验证过程。\n\n### 第一步：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n- 一个二次连续可微的对势：$U(r)$。\n- 一个切换半径 $r_s$ 和一个截断半径 $r_c$，满足条件 $0  r_s  r_c$。\n- 一个切换后的势定义为 $U_{\\text{sw}}(r) = S(r)U(r)$。\n- 一个切换函数 $S(r)$，具有以下性质：\n    - 当 $r \\le r_s$ 时，$S(r) = 1$。\n    - 当 $r \\ge r_c$ 时，$S(r) = 0$。\n    - $S(r)$ 在区间 $[r_s, r_c]$ 上是 $C^2$ 类函数。\n- 为确保 $U_{\\text{sw}}(r)$ 是 $C^2$ 类函数，对 $S(r)$ 的端点约束条件为：\n    - $S(r_s) = 1$\n    - $S'(r_s) = 0$\n    - $S''(r_s) = 0$\n    - $S(r_c) = 0$\n    - $S'(r_c) = 0$\n    - $S''(r_c) = 0$\n- 任务是找到在 $[r_s, r_c]$ 上满足这六个约束条件的最小次数多项式 $S(r)$。\n- 建议的方法是：使用归一化坐标 $x = (r - r_s) / (r_c - r_s)$。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学基础：** 该问题是计算材料科学和分子模拟中的一个标准且重要的课题。使用切换函数平滑截断势是确保分子动力学模拟中能量守恒和数值稳定性的关键技术。其表述是正确的，并基于既定原则。\n- **适定性：** 问题提供了六个约束条件，并要求找到满足这些条件的最小次数多项式。一个 $N$ 次多项式有 $N+1$ 个系数。要满足六个独立的约束条件，至少需要六个系数，这意味着最小次数为 $N=5$。该问题是适定的，并且对于最小次数多项式，预期会有一个唯一解。\n- **客观性：** 问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n- **缺陷清单：**\n    1. **科学上不健全：** 无。前提在科学和数学上都是健全的。\n    2. **无法形式化/不相关：** 无。问题与指定领域直接相关，并且形式化良好。\n    3. **不完整/矛盾：** 无。问题是自洽的。约束条件的数量与最小多项式的自由度数量相匹配。\n    4. **不切实际/不可行：** 无。这是一个实用且广泛使用的构造方法。\n    5. **不适定/结构不良：** 无。问题的结构旨在导出一个唯一、稳定且有意义的解。\n    6. **伪深刻/琐碎：** 无。该解法需要对微积分和线性代数进行不平凡的应用。\n    7. **超出科学可验证性：** 无。所得函数可以被严格验证。\n\n### 第三步：结论与行动\n此问题是**有效的**。将提供一个完整、合理的解答。\n\n### 解答\n目标是找到在区间 $[r_s, r_c]$ 上的最小次数多项式 $S(r)$，该多项式满足六个边界条件，从而确保切换后的势 $U_{\\text{sw}}(r) = S(r)U(r)$ 是二次连续可微的（$C^2$）。首先，我们确认给定的对 $S(r)$ 的约束是充分的。使用微分的乘积法则：\n$U'_{\\text{sw}}(r) = S'(r)U(r) + S(r)U'(r)$\n$U''_{\\text{sw}}(r) = S''(r)U(r) + 2S'(r)U'(r) + S(r)U''(r)$\n\n在 $r=r_s$ 处，为与 $r", "answer": "$$\\boxed{1 - 10 \\left(\\frac{r - r_s}{r_c - r_s}\\right)^3 + 15 \\left(\\frac{r - r_s}{r_c - r_s}\\right)^4 - 6 \\left(\\frac{r - r_s}{r_c - r_s}\\right)^5}$$", "id": "3479715"}, {"introduction": "在解决了势函数本身的平滑性问题后，我们转向如何高效地实现截断，即邻居列表算法。为了避免在每个时间步都重新构建邻居列表，通常会引入一个“蒙皮”区域（skin region）。本练习将运动学原理与统计力学相结合，让你推导确定最小蒙皮距离 $\\delta$ 的准则，从而保证在邻居列表更新周期内不会遗漏任何应当计算的相互作用，确保模拟算法的正确性和时间可逆性。[@problem_id:3479688]", "problem": "考虑一个单原子流体的三维分子动力学（MD）模拟，其对势在截断半径 $r_{c}$ 处被截断，并在区间 $[r_{s}, r_{c}]$ 上通过一个二阶连续可微的切换函数 $S(r)$ 平滑地切换至零，以确保力的连续性。模拟采用了一个带有表皮距离 $\\delta$ 的 Verlet 邻居列表，这意味着在列表构建时，所有间距 $r \\leq r_{c} + \\delta$ 的邻居都被包含在内。该邻居列表使用速度-Verlet 积分器，每 $N$ 个时间步（每个时间步大小为 $\\Delta t$）重建一次。假设以下基本条件：\n- 每个粒子的牛顿第二定律，以及对于确定性的连续力，速度-Verlet 算法是时间可逆的。\n- 质量为 $m$ 的粒子在平衡温度 $T$ 下的 Maxwell-Boltzmann (MB) 速率分布。\n- 粒子位移的运动学界限。\n\n在实践中，速度-Verlet 的时间可逆性只有在没有相互作用的粒子对在下一次列表重建之前，在未被包含于邻居列表中的情况下进入相互作用范围 $r \\leq r_{c}$ 时，才能得以保持。这要求表皮距离 $\\delta$ 足够大，以覆盖任何粒子对在重建间隔 $N \\Delta t$ 内可能的最大相对位移。通过要求在时间间隔内，没有任何粒子的速率以至少 $1 - \\alpha$ 的概率超过阈值 $v_{\\max}$ 来定义一个可逆性容差；在近似粒子间相互独立的情况下，这个选择限制了错过相互作用的几率，从而在容差 $\\alpha$ 内保持了实际的可逆性。\n\n从速率 $v$ 的 MB 分布出发，确定一个关联 $\\delta$、$\\Delta t$ 和 $v_{\\max}$ 的准则，该准则足以在容差 $\\alpha$ 内维持可逆性。然后，对于一个质量为 $m = 39.948$ 原子质量单位，温度 $T = 120$ 开尔文，时间步 $\\Delta t = 2.0$ 飞秒，邻居列表重建间隔为 $N = 100$ 步的单原子类 Argon 系统，计算满足该准则的最小表皮距离 $\\delta_{\\min}$，当：\n- 选择 $v_{\\max}$ 使得 MB 尾部概率满足 $\\mathbb{P}(v \\geq v_{\\max}) = \\alpha$，其中 $\\alpha = 10^{-6}$，\n- 但系统中也包含一个速率为 $v_{\\mathrm{out}} = 1500$ 米/秒的离群粒子。\n\n按需使用 Boltzmann 常数 $k_{B}$，并取 $1$ 原子质量单位 $= 1.66053906660 \\times 10^{-27}$ 千克。用纳米表示你的最终 $\\delta_{\\min}$，并将答案四舍五入至四位有效数字。不要在最终答案中呈现中间的四舍五入结果；只有最终的 $\\delta_{\\min}$ 应按规定进行四舍五入。", "solution": "该问题要求为 Verlet 邻居列表的表皮距离 $\\delta$ 建立一个准则，然后为一个特定系统计算其最小值 $\\delta_{\\min}$。第一步是验证问题陈述。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- **系统**：三维分子动力学（MD）模拟，单原子流体。\n- **势**：对势在 $r_{c}$ 处截断，在 $[r_{s}, r_{c}]$ 上有切换函数 $S(r)$。\n- **邻居列表**：带有表皮距离 $\\delta$ 的 Verlet 列表。\n- **列表构建**：所有间距 $r \\leq r_{c} + \\delta$ 的粒子对。\n- **列表重建**：每 $N$ 个时间步。\n- **时间步**：$\\Delta t$。\n- **积分器**：速度-Verlet。\n- **假设**：牛顿第二定律，对于连续力，速度-Verlet 算法具有时间可逆性，质量为 $m$ 的粒子在温度 $T$ 下服从 Maxwell-Boltzmann (MB) 速率分布。\n- **可逆性条件**：没有相互作用的粒子对（间距 $r \\leq r_{c}$）因不在邻居列表中而被错过。这要求表皮距离 $\\delta$ 足够大，以覆盖重建间隔 $N \\Delta t$ 内的最大相对位移。\n- **可逆性容差**：没有任何粒子的速率超过 $v_{\\max}$ 的概率 $\\geq 1 - \\alpha$。\n- **特定系统参数**：\n    - 质量：$m = 39.948$ 原子质量单位 (amu)。\n    - 温度：$T = 120$ 开尔文 (K)。\n    - 时间步：$\\Delta t = 2.0$ 飞秒 (fs)。\n    - 重建间隔：$N = 100$ 步。\n    - $v_{\\max}$ 的尾部概率：$\\mathbb{P}(v \\geq v_{\\max}) = \\alpha$，其中 $\\alpha = 10^{-6}$。\n    - 离群粒子速率：$v_{\\mathrm{out}} = 1500$ 米/秒 (m/s)。\n- **常数**：\n    - Boltzmann 常数：$k_{B}$。\n    - 原子质量单位：$1 \\text{ amu} = 1.66053906660 \\times 10^{-27}$ 千克 (kg)。\n- **输出要求**：$\\delta_{\\min}$ 以纳米 (nm) 为单位，四舍五入至四位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据、提法明确且客观。它描述了执行高效 MD 模拟的一个标准且关键的方面——即为 Verlet 邻居列表选择参数，以确保正确性（无遗漏的相互作用）同时最小化计算成本。势截断、切换函数、邻居列表、速度-Verlet 算法和 Maxwell-Boltzmann 分布等概念都是计算统计力学的基础。\n\n所提供的参数对于像 Argon 这样的惰性气体流体的模拟是物理上现实的。同时存在统计速率限制（来自 MB 分布的 $v_{\\max}$）和特定的高速粒子（$v_{\\mathrm{out}}$）并非矛盾，而是一个现实的复合条件；模拟可能包含“热”粒子，任何安全准则都必须考虑绝对的最坏情况。该问题是自洽的，为唯一解提供了所有必要的数据。\n\n**第三步：结论与行动**\n问题被判定为**有效**。将构建一个解决方案。\n\n### 解决方案构建\n\n**第一部分：表皮距离的一般准则**\n\n邻居列表表皮的目的是确保在邻居列表固定的时间间隔 $\\tau = N \\Delta t$ 内，没有任意两个粒子 $i$ 和 $j$ 能从间距 $r_{ij}(0)  r_{c} + \\delta$ 移动到间距 $r_{ij}(\\tau) \\leq r_{c}$。如果发生这种情况，就会漏掉一次力计算，从而违反能量守恒和时间可逆性。\n\n为防止这种情况发生，表皮距离 $\\delta$ 必须大于或等于最初不在彼此邻居列表中的任意两个粒子之间分离距离的最大可能减少量。分离距离的最大减少量 $\\Delta r_{\\text{max_decrease}}$ 受限于两个粒子沿其连线方向的最大各自位移之和。\n\n考虑两个粒子 $i$ 和 $j$。它们在时间间隔 $\\tau$ 内的最大位移可以通过运动学来界定。如果一个粒子在该时间间隔内的最大速率为 $v_{\\max}$，其位移 $|\\Delta\\mathbf{r}|$ 最多为 $v_{\\max}\\tau$。两个粒子的最保守“最坏情况”是它们以各自可能的最大速率（我们记为 $v_{\\mathrm{eff\\_max}}$）直接相向移动。它们缩短的距离是它们沿分离线的各自位移之和，其上限为 $(v_i + v_j)\\tau$。这个相对位移的上限是 $2 v_{\\mathrm{eff\\_max}} \\tau$。\n\n因此，为了保证最初在列表半径 $r_L = r_c + \\delta$ 之外的粒子对不会进入相互作用半径 $r_c$，表皮距离 $\\delta$ 必须满足：\n$$ \\delta \\ge 2 v_{\\mathrm{eff\\_max}} \\tau $$\n代入 $\\tau = N \\Delta t$，关联 $\\delta$、$\\Delta t$、$N$ 和 $v_{\\mathrm{eff\\_max}}$ 的准则是：\n$$ \\delta \\ge 2 v_{\\mathrm{eff\\_max}} N \\Delta t $$\n所需的最小表皮距离 $\\delta_{\\min}$ 在等号成立时达到：\n$$ \\delta_{\\min} = 2 v_{\\mathrm{eff\\_max}} N \\Delta t $$\n\n**第二部分：特定系统的计算**\n\n要计算 $\\delta_{\\min}$，我们必须首先确定有效最大粒子速率 $v_{\\mathrm{eff\\_max}}$。系统包含一个热分布的粒子群体和一个明确的离群粒子。安全准则必须对所有粒子都成立，所以我们必须取由 MB 分布的尾部确定的速率和离群粒子的速率中的较大者作为 $v_{\\mathrm{eff\\_max}}$。\n$$ v_{\\mathrm{eff\\_max}} = \\max(v_{\\max, \\text{MB}}, v_{\\mathrm{out}}) $$\n\n首先，我们根据条件 $\\mathbb{P}(v \\geq v_{\\max, \\text{MB}}) = \\alpha = 10^{-6}$ 计算 $v_{\\max, \\text{MB}}$。Maxwell-Boltzmann 速率分布由下式给出：\n$$ f(v) = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} v^2 \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) $$\n令 $a = \\sqrt{k_B T/m}$ 为特征速率标度。尾部概率积分为：\n$$ \\alpha = \\int_{v_{\\max, \\text{MB}}}^{\\infty} f(v) dv $$\n用约化速率 $x = v/a$ 表示，尾部概率的精确表达式为：\n$$ \\alpha = \\sqrt{\\frac{2}{\\pi}} x_{\\max} \\exp(-x_{\\max}^2/2) + \\text{erfc}(x_{\\max}/\\sqrt{2}) $$\n其中 $x_{\\max} = v_{\\max, \\text{MB}}/a$。对于小的 $\\alpha$（大的 $x_{\\max}$），该表达式可以通过相关渐近展开的第一项很好地近似，$\\alpha \\approx \\sqrt{\\frac{2}{\\pi}} x_{\\max} \\exp(-x_{\\max}^2/2)$。为了获得更高的精度，我们可以包含 erfc 展开的下一项，得到 $\\alpha \\approx \\sqrt{\\frac{2}{\\pi}} \\exp(-x_{\\max}^2/2)(x_{\\max} + 1/x_{\\max})$。一个更简单有效的方法是取主阶近似的自然对数：\n$$ \\ln(\\alpha) \\approx \\ln\\left(\\sqrt{\\frac{2}{\\pi}}\\right) + \\ln(x_{\\max}) - \\frac{x_{\\max}^2}{2} $$\n令 $y = x_{\\max}^2/2$。那么 $x_{\\max} = \\sqrt{2y}$，且 $\\ln(x_{\\max}) = \\frac{1}{2}\\ln(2y) = \\frac{1}{2}\\ln(2) + \\frac{1}{2}\\ln(y)$。\n$$ \\ln(\\alpha) \\approx \\ln\\left(\\sqrt{\\frac{2}{\\pi}}\\right) + \\frac{1}{2}\\ln(2) + \\frac{1}{2}\\ln(y) - y = \\ln\\left(\\sqrt{\\frac{4}{\\pi}}\\right) + \\frac{1}{2}\\ln(y) - y $$\n重新整理以求解 $y$：\n$$ y - \\frac{1}{2}\\ln(y) \\approx -\\ln(\\alpha) + \\ln\\left(\\sqrt{\\frac{4}{\\pi}}\\right) $$\n给定 $\\alpha = 10^{-6}$，所以 $-\\ln(\\alpha) = 6\\ln(10) \\approx 6 \\times 2.302585 = 13.81551$。\n$\\ln(\\sqrt{4/\\pi}) = \\frac{1}{2}\\ln(4/\\pi) \\approx \\frac{1}{2}\\ln(1.27324) \\approx 0.12076$。\n所以，$y - \\frac{1}{2}\\ln(y) \\approx 13.81551 + 0.12076 = 13.93627$。\n这个超越方程可以数值求解。我们测试一下 $y=15.3$：$15.3 - \\frac{1}{2}\\ln(15.3) \\approx 15.3 - \\frac{1}{2}(2.7278) = 15.3 - 1.3639 = 13.9361$。这是一个极好的匹配。\n因此，我们取 $y = x_{\\max}^2/2 = 15.3$，这意味着 $x_{\\max} = \\sqrt{2 \\times 15.3} = \\sqrt{30.6} \\approx 5.531726$。\n\n现在我们计算速率标度 $a = \\sqrt{k_B T / m}$：\n- $m = 39.948 \\text{ amu} \\times (1.66053906660 \\times 10^{-27} \\text{ kg/amu}) = 6.633519 \\times 10^{-26} \\text{ kg}$。\n- $T = 120 \\text{ K}$。\n- $k_B \\approx 1.380649 \\times 10^{-23} \\text{ J/K}$。\n- $k_B T = (1.380649 \\times 10^{-23}) \\times 120 = 1.6567788 \\times 10^{-21} \\text{ J}$。\n- $a = \\sqrt{\\frac{1.6567788 \\times 10^{-21} \\text{ J}}{6.633519 \\times 10^{-26} \\text{ kg}}} \\approx \\sqrt{2.49754 \\times 10^{4} \\text{ m}^2/\\text{s}^2} \\approx 158.036 \\text{ m/s}$。\n\n来自 MB 分布的速率极限是：\n$$ v_{\\max, \\text{MB}} = x_{\\max} a \\approx 5.531726 \\times 158.036 \\text{ m/s} \\approx 874.20 \\text{ m/s} $$\n\n现在，我们将其与离群粒子的速率进行比较：\n$$ v_{\\mathrm{out}} = 1500 \\text{ m/s} $$\n在我们的准则中使用的有效最大速率是两者中较大的一个：\n$$ v_{\\mathrm{eff\\_max}} = \\max(874.20 \\text{ m/s}, 1500 \\text{ m/s}) = 1500 \\text{ m/s} $$\n\n最后，我们计算最小表皮距离 $\\delta_{\\min}$：\n$$ \\delta_{\\min} = 2 v_{\\mathrm{eff\\_max}} N \\Delta t $$\n使用给定值：\n- $v_{\\mathrm{eff\\_max}} = 1500 \\text{ m/s}$。\n- $N = 100$。\n- $\\Delta t = 2.0 \\text{ fs} = 2.0 \\times 10^{-15} \\text{ s}$。\n\n$$ \\delta_{\\min} = 2 \\times (1500 \\text{ m/s}) \\times 100 \\times (2.0 \\times 10^{-15} \\text{ s}) = 600000 \\times 10^{-15} \\text{ m} = 6.0 \\times 10^{-10} \\text{ m} $$\n问题要求答案以纳米 ($1 \\text{ nm} = 10^{-9} \\text{ m}$) 为单位。\n$$ \\delta_{\\min} = 6.0 \\times 10^{-10} \\text{ m} = 0.60 \\text{ nm} $$\n按要求四舍五入到四位有效数字：\n$$ \\delta_{\\min} = 0.6000 \\text{ nm} $$\n这一结果表明，单个高速离群粒子的存在是所需表皮厚度的决定性因素，使得在该特定情况下，对热化体相流体的统计考虑成为次要因素。", "answer": "$$\\boxed{0.6000}$$", "id": "3479688"}]}