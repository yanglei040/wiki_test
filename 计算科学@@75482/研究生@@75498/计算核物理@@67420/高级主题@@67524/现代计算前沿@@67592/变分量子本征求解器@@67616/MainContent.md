## 引言
在探索[原子核](@entry_id:167902)与分子的微观[世界时](@entry_id:275204)，求解多体系统的薛定谔方程是计算物理与[量子化学](@entry_id:140193)的核心挑战。传统计算机在处理这类问题时，由于希尔伯特空间的维度随系统规模[指数增长](@entry_id:141869)而面临巨大的计算瓶颈。[变分量子本征求解器](@entry_id:150318)（Variational Quantum Eigensolver, VQE）作为一种为近期带噪声中等规模（NISQ）量子设备量身定制的[混合量子-经典算法](@entry_id:182137)，为解决这一难题带来了新的希望。它通过巧妙地结合[量子计算](@entry_id:142712)机的[状态制备](@entry_id:152204)与测量能力以及[经典计算](@entry_id:136968)机的优化能力，旨在以可控的资源找到复杂[哈密顿量](@entry_id:172864)的[基态](@entry_id:150928)，从而为理解强关联系统提供前所未有的计算工具。

本文旨在为研究生及以上水平的研究者提供一份关于VQE在[计算核物理](@entry_id:747629)领域应用的全面指南。我们将系统性地剖析VQE的内在机理，展示其解决实际科学问题的能力，并探讨其在当前量子硬件上面临的挑战与机遇。文章将分为三个主要部分，引领读者逐步深入这一前沿领域：

在第一章 **“原理与机制”** 中，我们将从量子力学的[变分原理](@entry_id:198028)出发，详细拆解VQE的每一步工作流程。这包括如何将物理[哈密顿量](@entry_id:172864)转化为[量子计算](@entry_id:142712)机可执行的指令，如何设计[表达能力](@entry_id:149863)强且可训练的变分[拟设](@entry_id:184384)（ansatz），如何高效地测量[能量期望值](@entry_id:174035)，以及如何利用经典优化器在复杂的能量景观中导航。此外，我们还将直面NISQ时代的关键难题——“[贫瘠高原](@entry_id:142779)”与硬件噪声，并介绍相应的缓解策略。

接下来，在第二章 **“应用与跨学科连接”** 中，我们将视野从理论转向实践，展示VQE如何被应用于解决真实的核物理问题，例如计算[原子核](@entry_id:167902)的[基态](@entry_id:150928)、[激发态](@entry_id:261453)以及[集体动力学](@entry_id:204455)。我们将探讨VQE如何与[相似性重整化群](@entry_id:754857)（SRG）、对称性投影等先进的经典理论框架无缝集成，以应对从“裸”核力出发的计算挑战。同时，我们还将跨越学科界限，审视VQE在[量子化学](@entry_id:140193)和[材料科学](@entry_id:152226)中的应用，揭示其作为一种通用工具的巨大潜力。

最后，在第三章 **“动手实践”** 中，我们将通过一系列精心设计的问题，引导读者将理论知识付诸实践。这些练习将涵盖从[哈密顿量](@entry_id:172864)转换到变分拟设编译，再到噪声环境下优化器选择等VQE工作流中的关键环节，旨在帮助读者建立对算法实现细节的直观理解和实践能力。

## 原理与机制

本章深入探讨[变分量子本征求解器](@entry_id:150318)（Variational Quantum Eigensolver, VQE）的核心科学原理与运行机制。VQE 是一种[混合量子-经典算法](@entry_id:182137)，旨在利用近期带噪声中等规模（Noisy Intermediate-Scale Quantum, NISQ）量子设备寻找[哈密顿量](@entry_id:172864)的基态能量。我们将从其理论基石——变分原理出发，系统地剖析 VQE 工作流程的各个环节，包括[哈密顿量](@entry_id:172864)的编码、变分拟设（ansatz）的设计、[能量期望值](@entry_id:174035)的测量、[参数优化](@entry_id:151785)策略，并最终讨论在实际应用中面临的关键挑战，如噪声和“[贫瘠高原](@entry_id:142779)”现象，以及相应的缓解技术。

### [变分原理](@entry_id:198028)：VQE 的理论基石

量子力学中的**变分原理**是 VQE 算法的理论支柱。该原理指出，对于一个给定的量子系统，其[哈密顿量](@entry_id:172864) $H$ 的任意归一化[试探波函数](@entry_id:142892) $|\psi\rangle$ 的[能量期望值](@entry_id:174035)，总是不小于该系统的基态能量 $E_0$。用数学语言表述为：

$$
E[\psi] = \frac{\langle\psi|H|\psi\rangle}{\langle\psi|\psi\rangle} \ge E_0
$$

对于归一化的[波函数](@entry_id:147440)（$\langle\psi|\psi\rangle = 1$），该表达式简化为 $E[\psi] = \langle\psi|H|\psi\rangle \ge E_0$。等号成立的充分必要条件是，试探波函数 $|\psi\rangle$ 本身就是[哈密顿量](@entry_id:172864)的一个[基态](@entry_id:150928)[本征函数](@entry_id:154705)。

VQE 巧妙地利用了这一原理 [@problem_id:2917666]。其核心思想是，构建一个由一组经典参数 $\boldsymbol{\theta}$ 控制的[参数化](@entry_id:272587)[量子态](@entry_id:146142)（或称**变分拟设**）$|\psi(\boldsymbol{\theta})\rangle$。通过在[量子计算](@entry_id:142712)机上制备此状态并测量其[能量期望值](@entry_id:174035) $E(\boldsymbol{\theta}) = \langle\psi(\boldsymbol{\theta})|H|\psi(\boldsymbol{\theta})\rangle$，VQE 将寻找基态能量的问题转化为一个经典[优化问题](@entry_id:266749)：通过[调整参数](@entry_id:756220) $\boldsymbol{\theta}$ 来最小化能量函数 $E(\boldsymbol{\theta})$。

$$
E_{\text{VQE}} = \min_{\boldsymbol{\theta}} E(\boldsymbol{\theta}) = \min_{\boldsymbol{\theta}} \langle\psi(\boldsymbol{\theta})|H|\psi(\boldsymbol{\theta})\rangle
$$

根据变分原理，对于任何参数 $\boldsymbol{\theta}$，计算出的能量 $E(\boldsymbol{\theta})$ 都是真实基态能量 $E_0$ 的一个[上界](@entry_id:274738)。因此，通过优化找到的最小值 $E_{\text{VQE}}$ 是对 $E_0$ 的一个近似。如果[拟设](@entry_id:184384) $|\psi(\boldsymbol{\theta})\rangle$ 的[表达能力](@entry_id:149863)足够强，能够精确地或以极高的保真度表示系统的[基态](@entry_id:150928)，那么 $E_{\text{VQE}}$ 将非常接近甚至等于 $E_0$。

值得注意的是，VQE 的实际应用涉及几个重要的理论和实践考量 [@problem_id:2917666]：
1.  **[非凸优化](@entry_id:634396)**：能量景观 $E(\boldsymbol{\theta})$ 通常是高维且非凸的，这意味着存在许多局部最小值。经典优化器可能会陷入其中一个能量高于 $E_0$ 的局部极小点，而无法找到全局最小值。
2.  **统计涨落**：在实际的量子设备上，[能量期望值](@entry_id:174035)是通过有限次数的测量（shots）来估计的。这个估计值是一个[随机变量](@entry_id:195330)，其单次测量结果可能因统计涨落而偶然低于 $E_0$，但这并不违背变分原理，该原理适用于[期望值](@entry_id:153208)的精确（无限次测量）极限。
3.  **[哈密顿量](@entry_id:172864)平移**：如果将[哈密顿量](@entry_id:172864)平移一个常数 $c$，即 $H' = H + cI$，那么能量景观也会相应地整体平移 $c$，即 $E'(\boldsymbol{\theta}) = E(\boldsymbol{\theta}) + c$。这不会改变能量最小点对应的参数 $\boldsymbol{\theta}^*$，因此 VQE 的优化过程对于能量参考点的选择是稳健的。

### VQE 工作流程：一个[混合量子-经典](@entry_id:750433)循环

VQE 的运行框架是一个紧密的[混合量子-经典](@entry_id:750433)循环，主要包含以下四个步骤：

1.  **[量子态制备](@entry_id:152204)**：在量子处理器上，根据当前经典优化器提供的参数 $\boldsymbol{\theta}$，执行一个[参数化](@entry_id:272587)的[量子线路](@entry_id:151866) $U(\boldsymbol{\theta})$ 作用于一个简单的初始态（如 $|0\cdots0\rangle$），以制备变分拟设态 $|\psi(\boldsymbol{\theta})\rangle = U(\boldsymbol{\theta})|0\cdots0\rangle$。

2.  **[期望值](@entry_id:153208)测量**：对制备出的[量子态](@entry_id:146142) $|\psi(\boldsymbol{\theta})\rangle$ 进行多次重复测量，以估计[哈密顿量](@entry_id:172864) $H$ 的[期望值](@entry_id:153208) $E(\boldsymbol{\theta})$。

3.  **经典[参数优化](@entry_id:151785)**：将估计得到的能量值 $E(\boldsymbol{\theta})$ 传递给一台经典计算机。经典[优化算法](@entry_id:147840)（如[梯度下降法](@entry_id:637322)或无梯度法）根据这个能量值（以及可能的梯度信息）来更新参数，生成一组新的、有望得到更低能量的参数 $\boldsymbol{\theta}'$。

4.  **迭代**：重复以上步骤，直到能量值收敛到一个最小值，或者达到预设的迭代次数。

为了使这个流程更加具体，我们考虑一个可精确求解的[原子核](@entry_id:167902)[配对模型](@entry_id:747676) [@problem_id:3611021]。该模型被简化并映射到一个[双量子比特系统](@entry_id:203437)，其[哈密顿量](@entry_id:172864)为：
$$
H = \frac{\Delta}{2}(Z_{1} - Z_{2}) - \frac{g}{2}(X_{1}X_{2} + Y_{1}Y_{2})
$$
其中 $Z_k, X_k, Y_k$ 是作用在第 $k$ 个[量子比特](@entry_id:137928)上的[泡利算符](@entry_id:144061)，$\Delta$ 是单粒子能级分裂，而 $g$ 是[配对相互作用](@entry_id:158014)强度。

我们可以选择一个保留粒子数（或资历数）的变分[拟设](@entry_id:184384)：
$$
|\psi(\theta)\rangle = \cos(\theta)|01\rangle - \sin(\theta)|10\rangle
$$
VQE 的目标函数（即[代价函数](@entry_id:138681)）是[能量期望值](@entry_id:174035) $C(\theta) = \langle\psi(\theta)|H|\psi(\theta)\rangle$。通过直接计算，我们可以得到这个模型的解析能量景观：
$$
C(\theta) = \Delta \cos(2\theta) + g \sin(2\theta)
$$
这个表达式清晰地展示了能量如何依赖于变分参数 $\theta$。经典优化器的任务就是找到使 $C(\theta)$ 最小的 $\theta$ 值。通过微积分可以求得，该模型的[基态能量](@entry_id:263704)（在此[拟设](@entry_id:184384)空间内）为 $C_{\min} = -\sqrt{\Delta^2 + g^2}$ [@problem_id:3611021]。这个简单的例子完美地诠释了 VQE 如何将一个量子物理问题转化为一个可以通过[经典计算](@entry_id:136968)解决的优化任务。

### 问题准备：[哈密顿量](@entry_id:172864)

在 VQE 应用于具体物理问题（如[原子核](@entry_id:167902)结构计算）之前，必须将描述物理系统的[哈密顿量](@entry_id:172864)转化为[量子计算](@entry_id:142712)机可以直接处理的形式，即一系列[泡利算符](@entry_id:144061)的[线性组合](@entry_id:154743) $H = \sum_j c_j P_j$。

#### 第[二次量子化](@entry_id:137766)与[正规排序](@entry_id:145434)

[多体系统](@entry_id:144006)的[哈密顿量](@entry_id:172864)通常在**第[二次量子化](@entry_id:137766)**的框架下表示，利用[费米子](@entry_id:146235)（或[玻色子](@entry_id:138266)）的产生 ($a_p^\dagger$) 和湮灭 ($a_p$) 算符。例如，一个包含[单体](@entry_id:136559)、两体和[三体](@entry_id:265960)相互作用的原子[核[哈密顿](@entry_id:752710)量](@entry_id:172864)可以写为：
$$
H = \sum_{pq} h_{pq} a_p^\dagger a_q + \frac{1}{4}\sum_{pqrs} v_{pqrs} a_p^\dagger a_q^\dagger a_s a_r + \frac{1}{36}\sum_{pqrstu} w_{pqrstu} a_p^\dagger a_q^\dagger a_r^\dagger a_u a_t a_s
$$
为了简化计算并更好地利用一个合适的[参考态](@entry_id:151465)（如 Hartree-Fock 斯莱特行列式 $|\Phi_0\rangle$），通常会对[哈密顿量](@entry_id:172864)进行**[正规排序](@entry_id:145434)** (Normal Ordering) [@problem_id:3611161]。[正规排序](@entry_id:145434)是基于广义 Wick 定理，将算符串重新[排列](@entry_id:136432)，使得所有[产生算符](@entry_id:191512)都在[湮灭算符](@entry_id:165390)的左边。这个过程会产生一系列由算符收缩（即在[参考态](@entry_id:151465)下的[期望值](@entry_id:153208)）形成的低阶项。

[正规排序](@entry_id:145434)的结果是将原始[哈密顿量](@entry_id:172864)分解为一个常数项（零体项 $E_0$）、一个有效[单体](@entry_id:136559)项、一个有效两体项以及剩余的[正规排序](@entry_id:145434)三体项等。例如，包含[三体力](@entry_id:159489) $w$ 的[哈密顿量](@entry_id:172864)在[正规排序](@entry_id:145434)后，其[单体](@entry_id:136559)和两体系数会包含来自[三体力](@entry_id:159489)的贡献：
$$
f_{pq} = h_{pq} + \sum_i v_{piqi} + \frac{1}{2}\sum_{ij} w_{pijqij}
$$
$$
\Gamma_{pqrs} = v_{pqrs} + \sum_i w_{pqi,rsi}
$$
其中求和指标 $i,j$ 遍历参考态 $|\Phi_0\rangle$ 中所有被占据的[轨道](@entry_id:137151)。[正规排序](@entry_id:145434)的优势在于：
1.  **[能量分解](@entry_id:193582)**：它将大部分能量贡献“折叠”到了常数项 $E_0$ 和低阶有效相互作用中。$E_0$ 可以[经典计算](@entry_id:136968)并直接加到 VQE 的最终结果上，从而减少了[量子计算](@entry_id:142712)机需要测量的部分。
2.  **减小关联**：一个好的参考态（如 Hartree-Fock [基态](@entry_id:150928)）可以使 $E_0$ 尽可能接近真实[基态能量](@entry_id:263704)，从而使得剩余的（[正规排序](@entry_id:145434)后的）[哈密顿量](@entry_id:172864)算符的“强度”变小，这通常意味着 VQE 拟设需要包含的关联更少，更容易优化。

#### [费米子](@entry_id:146235)到[量子比特](@entry_id:137928)的映射

得到[费米子](@entry_id:146235)[哈密顿量](@entry_id:172864)后，下一步是将其映射到[量子比特](@entry_id:137928)上。这需要建立[费米子算符](@entry_id:149120)与[泡利算符](@entry_id:144061)之间的代数关系。常用的映射方法包括：

*   **Jordan-Wigner (JW) 映射**：将第 $j$ 个[费米子](@entry_id:146235)模的占据数 $n_j$ 直接编码到第 $j$ 个[量子比特](@entry_id:137928)上。这种映射是局域的，但[费米子算符](@entry_id:149120)会映射为带有长泡利 $Z$ 链的非局域算符，例如 $a_j \rightarrow (\otimes_{k=0}^{j-1} Z_k) \otimes \frac{X_j + iY_j}{2}$。
*   **Bravyi-Kitaev (BK) 映射**：通过 Fenwick 树结构将[费米子](@entry_id:146235)占据数信息非局域地编码到[量子比特](@entry_id:137928)上，其优势在于能够将[费米子算符](@entry_id:149120)映射为权重（非单位[泡利算符](@entry_id:144061)个数）为 $O(\log n)$ 的泡利串，相比 JW 映射的 $O(n)$ 权重有所改进。
*   **Parity 映射**：将第 $j$ 个[量子比特](@entry_id:137928)编码为前 $j+1$ 个[费米子](@entry_id:146235)模的总粒子数宇称。

不同的映射方案会将同一个物理[哈密顿量](@entry_id:172864)转化为形式不同的泡利串和，这会影响 VQE 仿真的资源需求，例如所需量子门的总数以及测量方案的复杂性 [@problem_id:3611058]。

### [拟设](@entry_id:184384)设计：[试探波函数](@entry_id:142892)

变分[拟设](@entry_id:184384) $|\psi(\boldsymbol{\theta})\rangle$ 的设计是 VQE 的核心艺术。一个好的拟设应该在两个相互竞争的目标之间取得平衡：**表达能力**和**可训练性**。它需要足够强大以逼近真实的[基态](@entry_id:150928)，同时其参数数量和线路深度应保持在可控范围内，以避免优化困难和过度的噪声影响。

#### 问题启发的拟设：[UCCSD](@entry_id:198686)

对于化学和物理问题，**问题启发的[拟设](@entry_id:184384)** (problem-inspired ansatz) 是一种强大的选择，因为它将已知的物理结构直接编码到[量子线路](@entry_id:151866)中。其中最著名的是**酉[耦合簇](@entry_id:190682)** (Unitary Coupled Cluster, UCC) 拟设。UCC 态由一个酉算符作用于一个简单的参考态（通常是 [Hartree-Fock](@entry_id:142303) [基态](@entry_id:150928) $|\Phi_0\rangle$）得到：
$$
|\psi(\boldsymbol{\theta})\rangle = \exp(T(\boldsymbol{\theta}) - T^\dagger(\boldsymbol{\theta})) |\Phi_0\rangle
$$
其中 $T(\boldsymbol{\theta}) = T_1 + T_2 + \dots$ 是**簇算符**，由一系列激发算符组成。在 **[UCCSD](@entry_id:198686)** (UCC with Singles and Doubles) 近似中，我们只保留单激发 ($T_1$) 和双激发 ($T_2$)。

对于包含质子和中子两种[费米子](@entry_id:146235)的[原子核](@entry_id:167902)系统，激发算符需要分别考虑两种粒子以及它们之间的耦合 [@problem_id:3611027]。例如，双激发算符 $T_2$ 包含纯质子双激发 ($T_{2pp}$)、纯中子双激发 ($T_{2nn}$) 和质子-中子混合双激发 ($T_{2pn}$)。每个激发项都关联一个独立的变分参数。例如，将两个质子从占据[轨道](@entry_id:137151) $i,j$ 激发到[虚轨道](@entry_id:188499) $a,b$ 的算符为 $\theta_{ij}^{ab} a_a^\dagger a_b^\dagger a_j a_i$。

[UCCSD](@entry_id:198686) [拟设](@entry_id:184384)的参数数量随着系统规模（[轨道](@entry_id:137151)数 $M$ 和粒子数 $N$）[多项式增长](@entry_id:177086)，例如，同种粒子的双激发参数数量为 $\binom{N}{2}\binom{M-N}{2}$。这远优于[完全组态相互作用](@entry_id:172539)（FCI）方法中指数增长的复杂度，同时 [UCCSD](@entry_id:198686) 能够系统地描述多体关联效应，是[量子化学](@entry_id:140193)和核物理计算的黄金标准之一。

#### [参考态](@entry_id:151465)制备

UCC 拟设的性能很大程度上依赖于[参考态](@entry_id:151465) $|\Phi_0\rangle$ 的好坏。选择 [Hartree-Fock](@entry_id:142303) (HF) [基态](@entry_id:150928)作为[参考态](@entry_id:151465)是一种标准做法。在[量子计算](@entry_id:142712)机上，如果 HF 解的单粒子[轨道](@entry_id:137151)与我们选择的计算[基组](@entry_id:160309)（如[谐振子基](@entry_id:750178)）不同，就需要一个特定的[量子线路](@entry_id:151866)来制备 HF 斯莱特行列式。

这个制备过程可以通过一系列**Givens 旋转**来实现 [@problem_id:3611055]。从一个简单的计算基斯莱特行列式（例如占据前 $N$ 个[轨道](@entry_id:137151)）出发，可以应用一个单粒子[基变换](@entry_id:189626)酉算符 $\mathcal{U}$ 来得到 HF 态。这个酉算符 $\mathcal{U}$ 可以被分解为一系列二模旋转 $R_{pq}(\theta) = \exp(\theta(a_p^\dagger a_q - a_q^\dagger a_p))$ 的乘积。这在数学上等价于对 HF 系数矩阵进行 QR 分解。对于一个包含 $M$ 个[轨道](@entry_id:137151)和 $N$ 个[费米子](@entry_id:146235)的系统，通过 Givens 旋转系统地消去系数矩阵的次对角元来构造制备线路，所需的二[量子比特](@entry_id:137928)旋转门数量为 $MN - \frac{N(N+1)}{2}$。

### 测量步骤：估计能量

一旦制备了[拟设](@entry_id:184384)态 $|\psi(\boldsymbol{\theta})\rangle$，下一步就是测量其[能量期望值](@entry_id:174035)。由于[哈密顿量](@entry_id:172864)被分解为泡利串的[线性组合](@entry_id:154743) $H = \sum_j c_j P_j$，根据[量子力学的线性](@entry_id:146991)性质，其[期望值](@entry_id:153208)为：
$$
\langle H \rangle = \sum_j c_j \langle P_j \rangle
$$
因此，能量测量被分解为对一系列独立的泡利串 $P_j$ 测量其[期望值](@entry_id:153208) $\langle P_j \rangle$，然后将结果用经典系数 $c_j$ 加权求和。

#### 算符分组

量子力学的一个基本限制是，非对易的算符无法被同时精确测量。[哈密顿量](@entry_id:172864)中的泡利串通常不是全都相互对易的。为了提高测量效率，可以将相互对易的泡利串分到同一组，在一次测量设置中同时获得它们的[期望值](@entry_id:153208)。例如，在一个[双量子比特系统](@entry_id:203437)中，算符 $Z_0$ 和 $Z_1$ 是对易的（因为它们作用在不同的[量子比特](@entry_id:137928)上），所以 $\langle Z_0 \rangle$ 和 $\langle Z_1 \rangle$ 可以在同一次 Z 基测量中获得。而 $Z_0$ 和 $X_0$ 不对易，需要分开测量。

这种**算符分组**策略是 VQE 测量阶段的关键优化 [@problem_id:3611095] [@problem_id:3611021]。目标是找到一个最小的组划分，使得每个组内的所有算符都相互对易（或更宽松地，可以通过单[量子比特](@entry_id:137928)旋转[同时对角化](@entry_id:196036)），从而减少所需的总测量次数。

#### 测量成本与测量方案分配

由于量子测量具有统计性，每个 $\langle P_j \rangle$ 的估计都伴随着**[散粒噪声](@entry_id:140025)** (shot noise)。在总测量次数（总 shot 数 $S$）有限的情况下，如何将这些测量次数分配给不同的算符组，以最小化最终能量估计值的统计[方差](@entry_id:200758)，是一个重要问题。

对于一个由多个测量组 $G_k$ 构成的测量方案，总能量估计的[方差](@entry_id:200758)可以表示为 $V(s_1, s_2, \dots) = \sum_k \frac{\Delta_k}{s_k}$，其中 $s_k$ 是分配给第 $k$ 组的 shot 数，而 $\Delta_k$ 是该组内所有泡利项加权和的单次测量[方差](@entry_id:200758)。通过使用[拉格朗日乘子法](@entry_id:176596)可以证明，为使总[方差](@entry_id:200758) $V$ 最小，分配给第 $k$ 组的 shot 数 $s_k$ 应正比于 $\sqrt{\Delta_k}$ [@problem_id:3611095]。最优分配下的最小总[方差](@entry_id:200758)为：
$$
V_{\min} = \frac{1}{S} \left(\sum_k \sqrt{\Delta_k}\right)^2
$$
这个结果为在有限的量子资源下设计最优测量策略提供了理论指导。

### 优化步骤：导航能量景观

获得能量估计值后，经典优化器需要提出一组新的参数 $\boldsymbol{\theta}'$ 以进一步降低能量。[梯度下降](@entry_id:145942)及其变体是最高效的优化算法之一，但这需要计算[能量景观](@entry_id:147726)的梯度 $\nabla_{\boldsymbol{\theta}} E(\boldsymbol{\theta})$。

#### 梯度计算：参数平移规则

在[量子计算](@entry_id:142712)机上计算解析梯度的一种优雅而强大的方法是**参数平移规则** (parameter-shift rule) [@problem_id:3611141]。对于一个由[泡利算符](@entry_id:144061) $P$ 生成的参数化门 $U(\theta) = \exp(-i\theta P/2)$（其中 $P^2=I$），其[能量期望值](@entry_id:174035)对参数 $\theta$ 的导数可以表示为：
$$
\frac{dE}{d\theta} = \frac{1}{2} \left[ E\left(\theta + \frac{\pi}{2}\right) - E\left(\theta - \frac{\pi}{2}\right) \right]
$$
这个公式的绝妙之处在于，它将导数的计算转化为了两次[能量期望值](@entry_id:174035)的测量，只是参数被分别向前和向后平移了 $\pi/2$。这意味着我们可以在[量子计算](@entry_id:142712)机上精确地计算梯度，而无需知道[哈密顿量](@entry_id:172864)或[量子态](@entry_id:146142)的具体形式。

参数平移规则可以推广到更一般的门生成元 $G$。如果 $G$ 的[本征值](@entry_id:154894)谱包含多个不同的[本征值](@entry_id:154894)差，那么导数将是多个不同频率的正弦函数的组合。此时，需要一个推广的参数平移规则，通过在多个不同平移点进行测量来求解一个[线性方程组](@entry_id:148943)，从而得到梯度。例如，对于生成元 $G = \frac{1}{2}(Z_1 + Z_2)$，其[本征值](@entry_id:154894)差为 $\{1, 2\}$，对应的双平移参数平移规则为 [@problem_id:3611141]：
$$
\frac{dE}{d\theta} = \frac{1-\sqrt{2}}{2}\left[E\left(\theta+\frac{\pi}{2}\right) - E\left(\theta-\frac{\pi}{2}\right)\right] + \left[E\left(\theta+\frac{\pi}{4}\right) - E\left(\theta-\frac{\pi}{4}\right)\right]
$$
这种方法为在 VQE 中高效实施[基于梯度的优化](@entry_id:169228)铺平了道路。

### NISQ 时代的挑战与解决方案

尽管 VQE 原理上非常优美，但在实际的 NISQ 设备上运行时，会遇到两个主要障碍：**[贫瘠高原](@entry_id:142779)**和**硬件噪声**。

#### [贫瘠高原](@entry_id:142779)问题

**[贫瘠高原](@entry_id:142779)** (barren plateau) 是指在某些情况下，当系统规模（[量子比特](@entry_id:137928)数 $n$）增大时，能量景观的梯度会以指数速度趋近于零 [@problem_id:3611046]。这使得[基于梯度的优化](@entry_id:169228)方法失效，因为梯度小到无法为优化器提供有意义的搜索方向。

[贫瘠高原](@entry_id:142779)的出现与拟设的**[表达能力](@entry_id:149863)**和代价函数的**全局性**密切相关：
*   **全局[代价函数](@entry_id:138681)与深度线路**：当使用一个全局[代价函数](@entry_id:138681)（即[哈密顿量](@entry_id:172864)作用在整个系统上），并且拟设线路足够深，以至于它近似于一个“随机”酉算符（即所谓的酉 2-设计）时，梯度的[方差](@entry_id:200758)会随着[希尔伯特空间](@entry_id:261193)维度 $D=2^n$ 的增大而指数衰减，即 $\mathrm{Var}[\partial E/\partial\theta_j] \sim O(1/2^n)$。这是由高维空间中的[测度集中](@entry_id:265372)现象导致的。
*   **局部[代价函数](@entry_id:138681)的解决方案**：避免[贫瘠高原](@entry_id:142779)的一种有效策略是采用**局部[代价函数](@entry_id:138681)**。如果我们只测量[哈密顿量](@entry_id:172864)中作用于一个小的、固定大小子系统上的项，并使用一个浅深度线路（其因果[光锥](@entry_id:158105)不会覆盖整个系统），那么梯度的[方差](@entry_id:200758)将不会随系统总规模 $n$ 的增大而衰减。这为训练浅深度[拟设](@entry_id:184384)提供了可行的路径。

值得注意的是，即使是 [UCCSD](@entry_id:198686) 这样的物理启发拟设，如果线路深度过大，同样会面临[贫瘠高原](@entry_id:142779)问题。而层级化训练等策略虽然可以缓解问题，但并不能从根本上消除它。

#### 硬件噪声与错误缓解

NISQ 设备的另一个固有特性是噪声，它会导致量子门操作不完美和[量子比特退相干](@entry_id:142121)，从而使计算结果偏离理想值。幸运的是，一系列**错误缓解** (error mitigation) 技术可以在不要求完全错误校正的情况下提高计算精度。

一个典型的错误缓解工作流程可能包含以下步骤 [@problem_id:3611132]：
1.  **[零噪声外推](@entry_id:145402) (Zero-Noise Extrapolation, ZNE)**：该技术的核心思想是，人为地放大线路中的噪声，并测量不同噪声水平下的[期望值](@entry_id:153208)，然后将结果外推到噪声为零的理想情况。一种常见的噪声放大方法是“门折叠”，即用一个门及其逆操作 ($G G^\dagger = I$) 的序列来替换原来的门 $G$，从而在不改变理想逻辑的情况下增加噪声。
2.  **概率性错误消除 (Probabilistic Error Cancellation, PEC)**：如果存在一个精确的[噪声模型](@entry_id:752540)（例如，我们知道每个门后面都跟着一个特定强度的退极化信道），PEC 可以通过在测量结果上进行经典后处理来“反转”噪声的平均效应。这通常以增加测量次数为代价。
3.  **对称性验证 (Symmetry Verification)**：许多物理系统具有[守恒量](@entry_id:150267)，如粒子数或[总自旋](@entry_id:153335)。由于噪声，VQE 制备的末态可能会包含不属于正确对称性空间的成分。我们可以通过测量对称性算符（如粒子数[宇称算符](@entry_id:148434) $\Pi$）并将结果投影到正确的对称性[子空间](@entry_id:150286)来修正能量。例如，对于一个具有 $\Pi=+1$ [基态](@entry_id:150928)的系统，修正后的能量为 $E_{\text{verified}} = \frac{\langle H \rangle + \langle H\Pi \rangle}{1 + \langle \Pi \rangle}$。

#### 对称性与[量子比特](@entry_id:137928)约减

除了用于错误缓解，对称性本身也是一种宝贵的计算资源。如果一个[守恒量](@entry_id:150267)（如总粒子数宇称）在某种[费米子](@entry_id:146235)-[量子比特映射](@entry_id:753975)下，对应于一个简单的单[量子比特](@entry_id:137928)泡利算符（例如 $Z_k$），并且我们预先知道目标[本征态](@entry_id:149904)在该对称性下的[本征值](@entry_id:154894)，那么这个[量子比特](@entry_id:137928)就可以被“**约减**” (tapering) 掉 [@problem_id:3611058]。

例如，在某些问题中，使用 BK 映射或 Parity 映射可以将总粒子数[宇称算符](@entry_id:148434) $(-1)^N$ 映射到某个单[量子比特](@entry_id:137928)算符 $Z_k$ 上。如果我们知道目标态的粒子数是偶数，那么 $Z_k$ 的[本征值](@entry_id:154894)就固定为 $+1$。这意味着我们可以将这个[量子比特](@entry_id:137928)从仿真中移除，并用其固定的[本征值](@entry_id:154894)来替换[哈密顿量](@entry_id:172864)中所有相关的 $Z_k$ 算符。这个过程可以显著减少模拟所需的[量子比特](@entry_id:137928)数量，是 VQE 在实际应用中一项非常重要的[优化技术](@entry_id:635438)。

总之，VQE 作为一个强大的算法框架，其成功应用依赖于对物理原理、[量子计算](@entry_id:142712)机制以及 NISQ 设备限制的深刻理解。通过精心设计[哈密顿量](@entry_id:172864)处理、[拟设](@entry_id:184384)构造、测量方案和错误缓解策略，VQE 有望在近期为解决核物理、[量子化学](@entry_id:140193)等领域的挑战性问题提供宝贵的见解。