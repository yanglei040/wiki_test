{"hands_on_practices": [{"introduction": "在构建唯象光学模型势时，一个关键问题是为其能量和密度依赖性选择合适的函数形式。这些选择并非任意，而是植根于深刻的物理原理。本练习旨在挑战您将因果性、局域密度近似等基本概念与光学模型势参数化中常用的多项式或有理函数形式联系起来，从而更深入地理解这些模型背后的物理动机 [@problem_id:3567492]。", "problem": "一位研究人员旨在为核子-原子核散射构建一个全局的、局域的光学模型势 (OMP)，表示为 $U(\\mathbf{r},E)=V(\\mathbf{r},E)+i\\,W(\\mathbf{r},E)$。该模型势适用于质量数为 $A$ 的大范围稳定核，以及与当代反应模型相关的实验室能量 $E$ 范围。在计算核物理中，OMP可与多体介质中的核子单粒子自能相关联。自能通过以下方式进入推迟单粒子格林函数 $G^{R}(\\mathbf{k},E)$：\n$$\nG^{R}(\\mathbf{k},E)=\\frac{1}{E-\\varepsilon_{\\mathbf{k}}-\\Sigma^{R}(\\mathbf{k},E)}\\,,\\quad \\varepsilon_{\\mathbf{k}}=\\frac{\\mathbf{k}^{2}}{2m}\\,,\n$$\n且因果性要求 $\\Sigma^{R}(\\mathbf{k},E)$ 在复能量平面的上半平面是解析的。在有限核中，一种常见的计算策略是采用局域密度近似 (LDA)，将有限系统映射到均匀核物质，其局域费米动量 $k_{F}(\\mathbf{r})$ 由局域密度 $\\rho(\\mathbf{r})$ 确定。全局拟合必须强制执行源于这些基本原理的物理约束：自能的因果性和解析性、散射的幺正性、核相互作用的短程性，以及在亚饱和密度下对 $\\rho(\\mathbf{r})$ 的平滑依赖性。\n\n在不假设任何特定拟合公式的情况下，研究人员必须证明，为 $V(E)$ 和 $W(E)$ 选择低阶多项式或有理（类帕德）能量依赖关系，且其系数随 $\\rho(\\mathbf{r})$ 的简单函数变化，为何在科学上是一致的。\n\n下列哪些陈述为此类选择提供了正确且有原则的论证？选择所有适用项。\n\nA. 单粒子格林函数的因果性意味着推迟自能 $\\Sigma^{R}(E)$ 在实轴之外是解析的，并遵循连接其实部和虚部的色散关系。这约束了 $V(E)$ 和 $W(E)$ 在实轴上是 $E$ 的平滑函数，因此围绕参考能量的泰勒展开和有理近似是在有限能量窗口内的恰当表示。\n\nB. 因为 OMP 完全源于二体弹性过程，所以对于所有低于自由核子发射阈的能量 $E$，虚部 $W(E)$ 必须精确为零。这种不连续性促使人们使用关于 $E$ 的分段常数形式，而不是平滑的多项式或有理函数。\n\nC. 在局域密度近似中，有限核势 $U(\\mathbf{r},E)$ 通过在 $k_{F}(\\mathbf{r})=\\left[3\\pi^{2}\\rho(\\mathbf{r})/2\\right]^{1/3}$（对于同位旋对称物质）处计算的无限核物质自能来近似，并且对于亚饱和密度 $\\rho(\\mathbf{r})$，核物质自能随密度平滑变化。因此，随 $\\rho(\\mathbf{r})$ 的简单函数（例如，低阶幂）变化的参数系数能够捕捉密度依赖性，而不会引入非解析行为。\n\nD. 非相对论薛定谔方程的洛伦兹不变性强制要求 $V(E)$ 具有严格的线性能量依赖性，这禁止了有理能量参数化，并使多项式成为对称性下唯一允许的选择。\n\nE. 有限程相互作用和谱函数求和规则约束了自能在 $|E|$ 很大时的行为，导致 $V(E)$ 趋于一个常数或按 $1/E$ 衰减，而 $W(E)$ 在集体激发区之外减小。有理帕德形式能用更少的参数和更好的数值稳定性来编码这种渐近行为，优于无约束的高阶多项式，同时与解析性和色散关系保持一致。", "solution": "用户需要对问题陈述进行批判性验证，然后详细推导解决方案并评估所有提供的选项。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n*   **系统/模型**：一个全局的、局域的光学模型势 (OMP)，用于核子-原子核散射，记为 $U(\\mathbf{r},E)=V(\\mathbf{r},E)+i\\,W(\\mathbf{r},E)$。\n*   **适用范围**：质量数为 $A$ 的大范围稳定核，以及与当代反应模型相关的实验室能量 $E$ 范围。\n*   **理论联系**：OMP 与核子单粒子自能 $\\Sigma$ 相关。\n*   **格林函数**：推迟单粒子格林函数 $G^{R}(\\mathbf{k},E)$ 由下式给出：\n    $$\n    G^{R}(\\mathbf{k},E)=\\frac{1}{E-\\varepsilon_{\\mathbf{k}}-\\Sigma^{R}(\\mathbf{k},E)}\n    $$\n    其中 $\\varepsilon_{\\mathbf{k}}=\\frac{\\mathbf{k}^{2}}{2m}$。\n*   **基本原理1（因果性）**：因果性意味着推迟自能 $\\Sigma^{R}(\\mathbf{k},E)$ 在复能量平面的上半平面是解析的。\n*   **近似策略**：使用局域密度近似 (LDA)，将有限系统映射到均匀核物质，其局域费米动量 $k_{F}(\\mathbf{r})$ 由局域密度 $\\rho(\\mathbf{r})$ 确定。\n*   **物理约束**：全局拟合必须强制执行：\n    1.  自能的因果性和解析性。\n    2.  散射的幺正性。\n    3.  核相互作用的短程性。\n    4.  在亚饱和密度下对 $\\rho(\\mathbf{r})$ 的平滑依赖性。\n*   **问题**：论证为何为 $V(E)$ 和 $W(E)$ 选择低阶多项式或有理（类帕德）能量依赖关系，且其系数随 $\\rho(\\mathbf{r})$ 的简单函数变化，在科学上是一致的。\n\n**第二步：使用提取的已知条件进行验证**\n\n1.  **科学依据**：该问题深深植根于量子力学、核多体理论和散射理论的既定原理。OMP 与自能的联系、格林函数的戴森方程形式、因果性-解析性联系（导致色散关系）以及局域密度近似都是计算核物理中经过充分验证的标准概念。该问题在科学上是合理的。\n2.  **提法明确**：该问题要求为 OMP 的一种常见参数化选择提供物理和数学上的论证。这是一个概念性问题，基于所提供的理论框架，有一组确定的正确答案。该问题提法明确。\n3.  **客观性**：术语精确且为该领域的标准用法。问题陈述是对理论核物理中一个典型任务的清晰、无偏的描述。\n4.  **完整性与一致性**：问题提供了评估选项所需的所有必要背景原理（因果性、LDA、物理约束）。没有内部矛盾。\n5.  **现实性**：所描述的情景——构建一个全局 OMP——是核物理学中一个核心且持续进行的研究领域。所提及的约束和方法是现实且被广泛使用的。\n\n**第三步：结论与行动**\n\n问题陈述是有效的。它在科学上是合理的，提法明确，客观，并提供了足够的背景信息来继续解决。\n\n### 解答推导与选项分析\n\n问题的核心是论证为何对光学势 $U(\\mathbf{r},E) \\approx \\Sigma^{R}(\\mathbf{r},E)$ 的能量 $E$ 和密度 $\\rho(\\mathbf{r})$ 依赖性使用简单的函数形式——多项式和有理函数——是合理的。该论证必须源于所提供的基本原理。\n\n1.  **能量依赖性**：问题指出，因果性意味着推迟自能 $\\Sigma^{R}(E)$ 是复能量平面的上半平面中的一个解析函数。复变函数的一个基本定理指出，在一个区域内解析的函数可以在收敛半径内由一个收敛的泰勒级数（多项式近似）表示。对于不包含奇点的有限能量范围，低阶泰勒展开提供了一个良好的局域近似。有理函数（帕德近似）是多项式的比值，它们也是解析函数（除了在分母的极点处）。它们通常提供比多项式更强大的近似方案，能够表示更广泛的函数类别，并更有效地捕捉渐近行为。$\\Sigma^{R}(E)$ 的解析性也意味着其实部和虚部（$V(E)$ 和 $W(E)$）通过色散关系（克拉默斯-克勒尼希关系）相联系。这种关系确保了如果一部分是能量的平滑函数，那么另一部分也同样平滑（远离阈值）。因此，选择像多项式和有理函数这样的平滑、解析的近似函数，是直接由因果性这一基本原理所支持的。\n\n2.  **密度依赖性**：问题援引了局域密度近似 (LDA)。在此近似中，有限核内某一点 $\\mathbf{r}$ 的势被取为密度为 $\\rho = \\rho(\\mathbf{r})$ 的无限核物质中的势。问题陈述，拟合必须强制执行“在亚饱和密度下对 $\\rho(\\mathbf{r})$ 的平滑依赖性”。这是一个基于物理动机的约束，其依据是核物质的多体计算结果，这些结果显示在密度低于核饱和密度时没有相变或其他非解析行为。如果基础量 $\\Sigma_{\\text{NM}}(E, \\rho)$ 是 $\\rho$ 的一个平滑函数，那么用简单的、平滑的函数（如关于 $\\rho$ 或 $k_F \\propto \\rho^{1/3}$ 的低阶泰勒展开）来近似这种依赖性，在数学上是合理的。\n\n3.  **渐近（高能）行为**：“核相互作用的短程性”这一约束，与基本的求和规则相结合，决定了自能在 $|E| \\to \\infty$ 时的行为。具体来说，势的能量依赖部分必须消失。$V(E)$ 通常趋于一个常数（静态哈特里-福克势），而 $W(E)$ 必须衰减至零。一个次数 $N \\ge 1$ 的多项式在 $|E|\\to\\infty$ 时会发散，这对于一个全局势来说是不符合物理的。一个有理函数 $P(E)/Q(E)$ 可以很容易地被构造成具有正确的渐近行为（例如，如果 $\\deg(P) = \\deg(Q)$ 则趋于一个常数，如果 $\\deg(P)  \\deg(Q)$ 则衰减）。这使得有理函数成为需要覆盖宽能量范围的全局参数化的更优选择。\n\n基于这些原理，我们评估每个选项。\n\n---\n**选项 A. 单粒子格林函数的因果性意味着推迟自能 $\\Sigma^{R}(E)$ 在实轴之外是解析的，并遵循连接其实部和虚部的色散关系。这约束了 $V(E)$ 和 $W(E)$ 在实轴上是 $E$ 的平滑函数，因此围绕参考能量的泰勒展开和有理近似是在有限能量窗口内的恰当表示。**\n\n*   **分析**：这个陈述完全正确。它准确地将因果性与解析性和色散关系联系起来。$\\Sigma^{R}(E)$ 的解析性是为什么它可以在有限能量区间内被其他解析函数（如多项式（泰勒级数）和有理函数）近似的严格数学基础。在实轴上的平滑性（远离阈值和束缚态）是一个直接的推论。\n*   **结论**：正确。\n\n**选项 B. 因为 OMP 完全源于二体弹性过程，所以对于所有低于自由核子发射阈的能量 $E$，虚部 $W(E)$ 必须精确为零。这种不连续性促使人们使用关于 $E$ 的分段常数形式，而不是平滑的多项式或有理函数。**\n\n*   **分析**：这个陈述在多个方面都是错误的。首先，OMP 并非“完全”源于弹性过程；虚部 $W(E)$ 明确表示了所有非弹性衰变道的影响。其次，$W(E)$ 的行为不是一个简单的不连续。理论模型和实验数据表明，$W(E)$ 随能量平滑变化。例如，在费米液体中费米面附近，$W(E)$ 预期会按 $(E-E_F)^2$ 变化，这是一个平滑函数。为分段常数函数辩护的不连续性前提在物理上是不正确的。\n*   **结论**：错误。\n\n**选项 C. 在局域密度近似中，有限核势 $U(\\mathbf{r},E)$ 通过在 $k_{F}(\\mathbf{r})=\\left[3\\pi^{2}\\rho(\\mathbf{r})/2\\right]^{1/3}$（对于同位旋对称物质）处计算的无限核物质自能来近似，并且对于亚饱和密度 $\\rho(\\mathbf{r})$，核物质自能随密度平滑变化。因此，随 $\\rho(\\mathbf{r})$ 的简单函数（例如，低阶幂）变化的参数系数能够捕捉密度依赖性，而不会引入非解析行为。**\n\n*   **分析**：这个陈述正确地描述了 LDA 在 OMP 上的应用。费米动量 $k_F$ 的公式对于同位旋对称核物质是正确的。关键的物理输入——核物质中的自能在 $\\rho$ 低于饱和值时是密度的平滑函数——是公认的。因此，对 OMP 系数的密度依赖性使用简单的、平滑的函数（如关于 $\\rho(\\mathbf{r})$ 的低阶多项式）是一个有充分理由的近似。\n*   **结论**：正确。\n\n**选项 D. 非相对论薛定谔方程的洛伦兹不变性强制要求 $V(E)$ 具有严格的线性能量依赖性，这禁止了有理能量参数化，并使多项式成为对称性下唯一允许的选择。**\n\n*   **分析**：这个陈述在事实上是错误的。非相对论薛定谔方程是伽利略不变的，而不是洛伦兹不变的。更重要的是，这两种对称性原理都没有对像 OMP 这样的有效势强加严格的线性能量依赖性。能量依赖性源于复杂的多体动力学，通常是一个非线性但平滑的函数。关于严格线性依赖性的断言是错误的，因此禁止有理函数的结论也是没有根据的。\n*   **结论**：错误。\n\n**选项 E. 有限程相互作用和谱函数求和规则约束了自能在 $|E|$ 很大时的行为，导致 $V(E)$ 趋于一个常数或按 $1/E$ 衰减，而 $W(E)$ 在集体激发区之外减小。有理帕德形式能用更少的参数和更好的数值稳定性来编码这种渐近行为，优于无约束的高阶多项式，同时与解析性和色散关系保持一致。**\n\n*   **分析**：这个陈述正确地指出了另一个关键原理：高能下的渐近行为。所提到的约束（有限程相互作用，求和规则）确实导致了能量依赖的势在无穷远处必须消失的要求。多项式（次数 $\\ge 1$）不满足这个测试，因为它们会发散，这使它们不适合延伸到高能区的全局拟合。有理函数（帕德近似）非常适合模拟具有特定渐近极限（如趋于常数或按 $1/E$ 衰减）的函数，因此是全局、受物理约束的势的更优选择。这与因果性所要求的解析性是一致的。\n*   **结论**：正确。", "answer": "$$\\boxed{ACE}$$", "id": "3567492"}, {"introduction": "光学模型势的一个核心特征是其复数性质，其中虚部 $W$ 代表吸收，实部 $V$ 代表折射。这两个部分并非相互独立，而是通过因果性原理联系在一起，这种联系在数学上表现为Kramers-Kronig色散关系。本编码练习将指导您亲手实现这一物理约束，通过数值计算从给定的势虚部推导出实部的色散修正，从而加深对吸收与散射之间内在联系的理解 [@problem_id:3567524]。", "problem": "有限核中自旋平均的核子光学势可以通过 Kramers–Kronig 关系受到因果性的约束，该关系连接了其依赖于能量的实部和虚部。考虑相对于费米能 $E_F$（单位也为 $\\mathrm{MeV}$）测量的单粒子能量变量 $E$（单位为 $\\mathrm{MeV}$）。设虚部由一个围绕 $E_F$ 的光滑、可积的偶函数建模，该函数在 $E=E_F$ 处为零，并在 $|E-E_F|$ 较大时衰减，以保证数值收敛。具体定义为\n$$\nW(E) \\equiv W_0 \\left(1 - e^{-\\frac{(E-E_F)^2}{d^2}}\\right) e^{-\\frac{(E-E_F)^2}{s^2}},\n$$\n其中参数为 $W_0 = 50\\,\\mathrm{MeV}$，$d = 10\\,\\mathrm{MeV}$，$s = 80\\,\\mathrm{MeV}$，以及 $E_F = -8\\,\\mathrm{MeV}$。由于因果性，实部色散修正 $\\Delta V(E)$ 由减除的 Kramers–Kronig 关系给出，表示为一个减除的柯西核的柯西主值积分。您的任务是使用两种独立的数值策略，对 $\\Delta V(E)$ 的减除主值积分进行数值实现，并根据其中一种策略生成的综合参考数据，验证 Kramers–Kronig 的一致性属性。\n\n在完整、可运行的程序中实现以下内容：\n\n- 使用能量积分界限 $[E_{\\min}, E_{\\max}] = [E_F - 400\\,\\mathrm{MeV}, E_F + 400\\,\\mathrm{MeV}]$ 来近似无限域主值积分。将该积分视为在 $E$ 和 $E_F$ 两点处的主值。\n- 方法 A（分段主值）：通过将积分域分割成子区间，排除界限内 $E$ 和 $E_F$ 处任何奇点的小对称邻域，来实现对主值积分的直接数值积分。在每个子区间上使用一个小的排除半宽 $\\varepsilon = 10^{-6}\\,\\mathrm{MeV}$ 和高精度积分。这将为 $\\Delta V(E)$ 生成一个数值结果。\n- 方法 B（参考加权积分）：通过在相同的有限界限上使用柯西加权主值积分，分别计算以 $E$ 和 $E_F$ 为中心的两个带有柯西核的主值积分，然后相减得到 $\\Delta V(E)$，从而实现一个参考计算。这作为您验证方法 A 所用的综合“数据”。\n\n使用这两种方法，评估以下验证量，所有量均以 $\\mathrm{MeV}$ 表示：\n1. 由方法 A 计算的绝对值 $|\\Delta V(E_F)|$。\n2. 由方法 A 计算的、在 $E_F$ 两侧对称偏移 $\\Delta = 25\\,\\mathrm{MeV}$ 处的奇性残差，即 $|\\Delta V(E_F+\\Delta) + \\Delta V(E_F-\\Delta)|$。\n3. 在能量集合 $\\{E_F-60\\,\\mathrm{MeV},\\,E_F-20\\,\\mathrm{MeV},\\,E_F,\\,E_F+20\\,\\mathrm{MeV},\\,E_F+60\\,\\mathrm{MeV}\\}$ 上，方法 A 和方法 B 之间的最大绝对偏差。\n\n此问题不涉及角度单位。所有能量和输出必须以 $\\mathrm{MeV}$ 为单位。您的程序应生成单行输出，其中包含按上述顺序排列的三个结果，格式为逗号分隔的列表并用方括号括起（例如，“[x1,x2,x3]”）。\n\n测试套件：\n- 使用能量网格 $\\{E_F-60\\,\\mathrm{MeV},\\,E_F-20\\,\\mathrm{MeV},\\,E_F,\\,E_F+20\\,\\mathrm{MeV},\\,E_F+60\\,\\mathrm{MeV}\\}$ 计算第 $3$ 项中的偏差。\n- 对第 $1$ 项使用费米能 $E_F=-8\\,\\mathrm{MeV}$。\n- 对第 $2$ 项使用 $\\Delta=25\\,\\mathrm{MeV}$。\n三个测试用例的答案必须是三个以 $\\mathrm{MeV}$ 为单位的浮点数，按规定聚合为单行列表。", "solution": "该问题要求在核物理学中，对一个核子光学势的减除 Kramers–Kronig 关系进行数值实现和验证。问题的核心在于计算势的实部的色散修正 $\\Delta V(E)$，该修正是从其虚部 $W(E)$ 推导出来的。\n\n势的虚部由以下函数给出：\n$$\nW(E) = W_0 \\left(1 - e^{-\\frac{(E-E_F)^2}{d^2}}\\right) e^{-\\frac{(E-E_F)^2}{s^2}}\n$$\n参数为 $W_0 = 50\\,\\mathrm{MeV}$，$d = 10\\,\\mathrm{MeV}$，$s = 80\\,\\mathrm{MeV}$，费米能 $E_F = -8\\,\\mathrm{MeV}$。该函数关于变量 $(E-E_F)$ 是偶函数，即 $W(E_F + \\delta E) = W(E_F - \\delta E)$。此外，项 $\\left(1 - \\exp\\left(-\\frac{(E-E_F)^2}{d^2}\\right)\\right)$ 确保 $W(E)$ 在费米能处二次方趋于零，即当 $E \\to E_F$ 时，$W(E) \\propto (E-E_F)^2$。\n\n实部色散修正 $\\Delta V(E)$ 通过一次减除的 Kramers–Kronig 关系与 $W(E)$ 相连。减除在费米能 $E_F$ 处进行，以确保 $\\Delta V(E_F) = 0$。该关系可以表示为两个柯西主值积分的差：\n$$\n\\Delta V(E) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{W(E')}{E' - E} dE' - \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{W(E')}{E' - E_F} dE'\n$$\n此形式等价于更常见的单积分表达式：\n$$\n\\Delta V(E) = \\frac{E - E_F}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{W(E')}{(E' - E)(E' - E_F)} dE'\n$$\n问题指定通过在有限的对称域 $[E_{\\min}, E_{\\max}] = [E_F - 400\\,\\mathrm{MeV}, E_F + 400\\,\\mathrm{MeV}]$ 上积分来近似无限积分。\n\n因为 $W(E)$ 是关于 $E_F$ 的偶函数，并且积分域围绕 $E_F$ 对称，所以得到的色散修正 $\\Delta V(E)$ 必须是关于 $E_F$ 的奇函数。这意味着需要数值验证两个关键属性：\n1.  $\\Delta V(E_F) = 0$。\n2.  $\\Delta V(E_F + \\delta E) = - \\Delta V(E_F - \\delta E)$，或等价地，$\\Delta V(E_F + \\delta E) + \\Delta V(E_F - \\delta E) = 0$。\n\n为计算 $\\Delta V(E)$，实现了两种数值方法。\n\n**方法 A：分段主值积分**\n此方法直接实现主值积分的定义。被积函数为：\n$$\nf(E') = \\frac{W(E')}{\\pi} \\left( \\frac{1}{E' - E} - \\frac{1}{E' - E_F} \\right)\n$$\n该被积函数在 $E' = E$ 和 $E' = E_F$ 处有奇点。为计算主值，将积分域 $[E_{\\min}, E_{\\max}]$ 分割成子区间，明确排除奇点周围的小对称邻域 $(E - \\varepsilon, E + \\varepsilon)$ 和 $(E_F - \\varepsilon, E_F + \\varepsilon)$，其中 $\\varepsilon = 10^{-6}\\,\\mathrm{MeV}$。积分即为在剩余子区间上积分的总和。例如，如果 $E  E_F$，积分计算如下：\n$$\n\\int_{E_{\\min}}^{E_F-\\varepsilon} f(E') dE' + \\int_{E_F+\\varepsilon}^{E-\\varepsilon} f(E') dE' + \\int_{E+\\varepsilon}^{E_{\\max}} f(E') dE'\n$$\n在每个非奇异子区间上的积分都是使用高精度数值积分例程（`scipy.integrate.quad`）计算的。在 $E = E_F$ 的特殊情况下，减数中的两项相互抵消，对于 $E' \\ne E_F$，被积函数恒为零。因此，积分的计算结果为零。\n\n**方法 B：参考加权积分**\n此方法用作高精度参考。它使用专门针对柯西加权积分的数值算法，分别计算 $\\Delta V(E)$ 定义中的两个主值积分。\n$$\n\\Delta V(E) = \\frac{1}{\\pi} \\left( I(E) - I(E_F) \\right) \\quad \\text{其中} \\quad I(x) = \\mathcal{P} \\int_{E_{\\min}}^{E_{\\max}} \\frac{W(E')}{E' - x} dE'\n$$\n积分 $I(x)$ 使用 `scipy.integrate.quad` 及其 `weight='cauchy'` 和 `wvar=x` 选项进行计算，该方法专为此类积分设计，通常能提供非常精确的结果。\n\n**验证量**\n要计算的三个量用于根据理论预期和参考计算（方法 B）来验证方法 A 的实现。\n1.  **$|\\Delta V_A(E_F)|$**：这用于测试实现对减除点的处理。理论上，该值为 $0$。在方法 A 的实现中，如果 $E = E_F$，被积函数恒为零，得到结果 $0.0$。\n2.  **$|\\Delta V_A(E_F+\\Delta) + \\Delta V_A(E_F-\\Delta)|$**：这用于测试 $\\Delta V(E)$ 在 $E_F$ 附近的奇函数性质的数值保持情况。由于对称的积分限和 $W(E)$ 的偶函数性质，此和应为零。计算出的值代表数值残差，该值应非常小。\n3.  **最大绝对偏差**：这个量，$\\max_{E} |\\Delta V_A(E) - \\Delta V_B(E)|$，量化了在一组测试能量上，“暴力”主值计算（方法 A）与专用库例程（方法 B）之间的一致性。一个小的偏差证实了两种实现的正确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem as specified.\n    1. Defines the optical potential model and parameters.\n    2. Implements two numerical methods (A and B) for the Kramers-Kronig integral.\n    3. Computes the three specified validation quantities.\n    4. Prints the results in the required format.\n    \"\"\"\n    \n    # --- Define constants and parameters ---\n    W0 = 50.0  # MeV\n    d = 10.0   # MeV\n    s = 80.0   # MeV\n    EF = -8.0  # MeV\n    eps = 1e-6 # MeV, exclusion half-width for Method A\n\n    # Integration bounds\n    E_min = EF - 400.0  # MeV\n    E_max = EF + 400.0  # MeV\n\n    # --- Test case parameters ---\n    delta_oddness = 25.0  # MeV, for validation quantity 2\n    E_grid_relative = np.array([-60.0, -20.0, 0.0, 20.0, 60.0])\n    E_grid_test = EF + E_grid_relative  # MeV, for validation quantity 3\n\n    # --- Imaginary Potential W(E) ---\n    def W_func(E_prime, EF_val, W0_val, d_val, s_val):\n        \"\"\"\n        Calculates the imaginary part of the optical potential W(E').\n        \"\"\"\n        # Using a shifted energy variable to avoid large numbers\n        x = E_prime - EF_val\n        term1 = 1.0 - np.exp(-(x**2) / (d_val**2))\n        term2 = np.exp(-(x**2) / (s_val**2))\n        return W0_val * term1 * term2\n\n    # --- Method A: Piecewise Principal Value Quadrature ---\n    def delta_V_A(E, EF_val, W0_val, d_val, s_val):\n        \"\"\"\n        Computes the dispersive correction Delta_V(E) using Method A.\n        The integral is split to avoid singularities at E and EF.\n        \"\"\"\n        # The integrand for the subtracted dispersion relation\n        def integrand(E_prime, E_val):\n            w_val = W_func(E_prime, EF_val, W0_val, d_val, s_val)\n            # This form can be unstable if E is very close to EF.\n            # However, the problem specifies PV at both E and EF.\n            if abs(E_prime - E_val)  1e-15 or abs(E_prime - EF_val)  1e-15:\n                 return 0.0 # Should be handled by interval exclusion\n            term_E = 1.0 / (E_prime - E_val)\n            term_EF = 1.0 / (E_prime - EF_val)\n            return w_val * (term_E - term_EF)\n\n        # Handle singularities by splitting the integration domain\n        s1 = min(E, EF_val)\n        s2 = max(E, EF_val)\n\n        # If E and EF are identical, the integrand is zero everywhere (numerically).\n        # This correctly reflects Delta_V(EF) = 0.\n        if abs(E - EF_val)  1e-12:\n            return 0.0\n        \n        total_integral = 0.0\n        \n        # Integrate from E_min to the first singularity\n        res1, _ = quad(integrand, E_min, s1 - eps, args=(E,))\n        total_integral += res1\n        \n        # Integrate between the two singularities\n        if (s1 + eps)  (s2 - eps):\n            res2, _ = quad(integrand, s1 + eps, s2 - eps, args=(E,))\n            total_integral += res2\n        \n        # Integrate from the second singularity to E_max\n        res3, _ = quad(integrand, s2 + eps, E_max, args=(E,))\n        total_integral += res3\n        \n        return total_integral / np.pi\n\n    # --- Method B: Reference Weighted Quadrature ---\n    def delta_V_B(E, EF_val, W0_val, d_val, s_val):\n        \"\"\"\n        Computes Delta_V(E) using Method B (Cauchy-weighted quadrature).\n        This serves as the reference \"data\".\n        \"\"\"\n        \n        # Function to integrate is just W(E')\n        def w_integrand(E_prime):\n            return W_func(E_prime, EF_val, W0_val, d_val, s_val)\n\n        # If E and EF are identical, result is 0 by definition\n        if abs(E - EF_val)  1e-12:\n            return 0.0\n\n        # Calculate the two principal value integrals separately\n        # I(E) = P.V. integral of W(E')/(E' - E)\n        integral_E, _ = quad(w_integrand, E_min, E_max, weight='cauchy', wvar=E)\n        \n        # I(EF) = P.V. integral of W(E')/(E' - EF)\n        integral_EF, _ = quad(w_integrand, E_min, E_max, weight='cauchy', wvar=EF_val)\n        \n        return (integral_E - integral_EF) / np.pi\n\n    # --- Compute the three validation quantities ---\n    results = []\n\n    # 1. Absolute value |Delta V(EF)| computed by Method A.\n    # The definition of the subtracted dispersion relation ensures this is 0.\n    # Method A implementation also yields 0 when E=EF.\n    val1 = abs(delta_V_A(EF, EF, W0, d, s))\n    results.append(val1)\n\n    # 2. Oddness residual |Delta V(EF+d) + Delta V(EF-d)| by Method A.\n    # Theoretically, this is 0 due to symmetry. The result is a numerical residual.\n    v_plus_delta = delta_V_A(EF + delta_oddness, EF, W0, d, s)\n    v_minus_delta = delta_V_A(EF - delta_oddness, EF, W0, d, s)\n    val2 = abs(v_plus_delta + v_minus_delta)\n    results.append(val2)\n\n    # 3. Maximum absolute deviation between Method A and Method B.\n    max_deviation = 0.0\n    for E_test in E_grid_test:\n        v_a = delta_V_A(E_test, EF, W0, d, s)\n        v_b = delta_V_B(E_test, EF, W0, d, s)\n        deviation = abs(v_a - v_b)\n        if deviation  max_deviation:\n            max_deviation = deviation\n    val3 = max_deviation\n    results.append(val3)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3567524"}]}