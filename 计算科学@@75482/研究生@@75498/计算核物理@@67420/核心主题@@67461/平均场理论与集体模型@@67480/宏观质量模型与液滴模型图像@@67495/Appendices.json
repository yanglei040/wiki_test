{"hands_on_practices": [{"introduction": "半经验质量公式（SEMF）将原子核的总结合能分解为几个物理贡献项。要真正理解这个模型，关键在于把握各项的相对量级。本练习将通过一个直接的计算，帮助你感受不同能量项的尺度，特别是将源于量子效应的对能修正与经典的液滴项（如表面能和库仑能）进行定量比较。[@problem_id:3568545]", "problem": "基于液滴模型的宏观质量模型的一个核心要素是半经验质量公式，它将原子核结合能分解为体积项、表面项、库仑项、不对称项和对能项的贡献。对关联的一种表现是原子核结合能的奇偶交错效应。对于壳层中部的原子核，经验性的中子或质子对能隙通常由一个基准标度关系 $\\,\\Delta \\approx 12/\\sqrt{A}\\,$（单位为百万电子伏特）来表征，这与大量数据相符。在液滴模型参数化中，对能贡献通常写作 $\\,\\delta(A,Z)\\,$，它被加到总结合能上。其形式为 $\\,\\delta(A,Z) = \\pm a_p A^{-1/2}\\,$，其中 $\\,a_p\\,$ 是一个恒定的对能系数，对于偶偶核取正号，对于奇A核为0，对于奇奇核取负号。\n\n从上述基准和液滴模型出发，利用奇偶质量交错的概念来估算对能项 $\\,\\delta(A,Z)\\,$ 中的对能系数 $\\,a_p\\,$。然后，对于一个具有 $\\,A=120\\,$ 和 $\\,Z=50\\,$ 的代表性壳层中部原子核，通过计算以下无量纲比率来量化典型的偶偶核对能标度与表面能和库仑能贡献的比较：\n$$\nR \\equiv \\frac{|\\delta_{\\text{even-even}}|}{a_s A^{2/3} + a_c \\frac{Z(Z-1)}{A^{1/3}}}\\,,\n$$\n其中 $\\,a_s\\,$ 和 $\\,a_c\\,$ 分别是表面能系数和库仑能系数。在此估算中使用代表性数值 $\\,a_s = 17.23\\,\\text{MeV}\\,$ 和 $\\,a_c = 0.714\\,\\text{MeV}\\,$。\n\n假设 $\\,A^{\\pm 1/3}\\,$ 对质量数的依赖关系足够平滑，以至于在用于连接 $\\,\\Delta\\,$ 与 $\\,a_p\\,$ 的奇偶交错范围内，$\\,A\\,$ 可以被视为常数。将最终答案表示为 $\\,R\\,$ 的数值，四舍五入到四位有效数字。最终答案必须是无量纲的（没有单位）。", "solution": "在继续之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **模型：** 宏观质量模型，液滴模型，半经验质量公式。\n- **对能隙基准：** $\\Delta \\approx 12/\\sqrt{A}\\,$，单位为百万电子伏特 (MeV)。\n- **对能项公式：** $\\delta(A,Z)$，对于偶偶核为正，奇奇核为负，大小为 $a_p A^{-1/2}$。\n- **系数 `a_p`：** 一个待估算的恒定对能系数。\n- **目标核：** 一个质量数为 $A=120$、质子数为 $Z=50$ 的壳层中部原子核。\n- **待计算的比率：** $R \\equiv \\frac{|\\delta_{\\text{even-even}}|}{a_s A^{2/3} + a_c \\frac{Z(Z-1)}{A^{1/3}}}$。\n- **表面能系数：** $a_s = 17.23\\,\\text{MeV}$。\n- **库仑能系数：** $a_c = 0.714\\,\\text{MeV}$。\n- **假设：** 在用于连接 $\\Delta$ 与 $a_p$ 的奇偶交错范围内，质量数 $A$ 可以被视为常数。\n- **最终答案要求：** $R$ 的数值，四舍五入到四位有效数字，以无量纲量的形式呈现。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于核物理学的原理，特别是液滴模型和半经验质量公式 (SEMF)。所提供的公式和常数是该领域使用的标准表示方法。它不含伪科学。\n- **适定性：** 该问题是适定的。它要求基于一个给定的经验关系估算一个参数 $a_p$，然后使用该参数为一个特定的原子核计算一个明确定义的无量纲比率。所有必要的信息都已提供。\n- **客观性：** 该问题以客观、科学的语言表述。所提供的值是核物理文献中常见的代表性值。\n- **完整性和一致性：** 该问题是自洽的。提供的 $A$、$Z$、$a_s$ 和 $a_c$ 数据是一致的。将 $A$ 视为常数的假设是此类估算中的标准简化方法。\n- **真实性：** 系数的数值和对对能现象的描述在半经验质量公式的背景下是科学上合理的和标准的。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是一个标准的、适定的核物理问题，可以使用所提供的信息和既定原理来解决。将提供完整的解答。\n\n### 解\n解题过程分为两部分：首先，我们估算对能系数 $a_p$；其次，我们计算比率 $R$。\n\n**第一部分：估算对能系数 $a_p$**\n\n半经验质量公式包含一个对能项 $\\delta(A,Z)$，用以解释观测到的原子核结合能的奇偶交错现象。该项反映了具有偶数个质子和/或中子的原子核比具有奇数个的原子核束缚得更紧密这一事实。对能项 $\\delta(A,Z)$ 作为对结合能的贡献，由下式给出：\n$$\n\\delta(A,Z) =\n\\begin{cases}\n+a_p A^{-1/2}  \\text{对于偶偶核} \\\\\n0  \\text{对于奇}A\\text{核} \\\\\n-a_p A^{-1/2}  \\text{对于奇奇核}\n\\end{cases}\n$$\n经验对能隙 $\\Delta$ 量化了这种交错的幅度。它代表了拥有一对完整的核子（质子或中子）相对于拥有一个未配对的核子所获得的能量。问题指出，对于壳层中部的原子核，经验上发现该能隙为 $\\Delta \\approx 12 A^{-1/2}\\,\\text{MeV}$。\n\n偶偶核的对能项 $\\delta_{\\text{even-even}} = +a_p A^{-1/2}$，精确地表示了由于同时存在偶数个质子和偶数个中子而获得的额外结合能（相对于质量公式中其他项所描述的平滑平均值）。因此，我们可以将偶偶核系统的对能贡献大小与经验对能隙 $\\Delta$ 直接等同起来。\n$$\n|\\delta_{\\text{even-even}}| = \\Delta\n$$\n代入给定的表达式：\n$$\na_p A^{-1/2} \\approx 12 A^{-1/2}\\,\\text{MeV}\n$$\n通过这个比较，我们可以直接估算出对能系数 $a_p$：\n$$\na_p = 12\\,\\text{MeV}\n$$\n\n**第二部分：计算比率 $R$**\n\n我们需要为一个质量数为 $A=120$、质子数为 $Z=50$ 的原子核计算无量纲比率 $R$。\n$$\nR = \\frac{|\\delta_{\\text{even-even}}|}{a_s A^{2/3} + a_c \\frac{Z(Z-1)}{A^{1/3}}}\n$$\n该原子核的质子数 $Z=50$（偶数），中子数 $N = A - Z = 120 - 50 = 70$（偶数）。因此，它是一个偶偶核。\n\n首先，我们计算分子，即这个偶偶核的对能大小。\n$$\n|\\delta_{\\text{even-even}}| = |+a_p A^{-1/2}| = a_p A^{-1/2}\n$$\n使用我们估算的 $a_p = 12\\,\\text{MeV}$ 和给定的 $A=120$：\n$$\n|\\delta_{\\text{even-even}}| = 12 \\times (120)^{-1/2} = \\frac{12}{\\sqrt{120}}\\,\\text{MeV} \\approx 1.095445\\,\\text{MeV}\n$$\n\n接下来，我们计算分母，它是表面能 ($E_s$) 和库仑能 ($E_c$) 的大小之和。\n表面能项大小为：\n$$\na_s A^{2/3} = 17.23 \\times (120)^{2/3}\\,\\text{MeV}\n$$\n$$\na_s A^{2/3} \\approx 17.23 \\times 24.328703\\,\\text{MeV} \\approx 419.18453\\,\\text{MeV}\n$$\n库仑能项大小为：\n$$\na_c \\frac{Z(Z-1)}{A^{1/3}} = 0.714 \\times \\frac{50(50-1)}{(120)^{1/3}}\\,\\text{MeV}\n$$\n$$\na_c \\frac{Z(Z-1)}{A^{1/3}} = 0.714 \\times \\frac{50 \\times 49}{(120)^{1/3}}\\,\\text{MeV} = \\frac{0.714 \\times 2450}{(120)^{1/3}}\\,\\text{MeV}\n$$\n$$\na_c \\frac{Z(Z-1)}{A^{1/3}} \\approx \\frac{1749.3}{4.932424}\\,\\text{MeV} \\approx 354.65993\\,\\text{MeV}\n$$\n分母中的总能量为：\n$$\n\\text{分母} \\approx 419.18453 + 354.65993\\,\\text{MeV} \\approx 773.84446\\,\\text{MeV}\n$$\n\n最后，我们计算比率 $R$：\n$$\nR = \\frac{1.095445}{773.84446} \\approx 0.00141558\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nR \\approx 0.001416\n$$\n这个结果量化地说明，对于一个典型的壳层中部重核，与表面能和库仑能等占主导地位的宏观液滴项相比，对能是一个非常小的修正（约 $0.14\\%$）。", "answer": "$$\\boxed{0.001416}$$", "id": "3568545"}, {"introduction": "在理解了液滴模型的各个组成部分后，下一步是将其付诸实践：构建一个可计算的模型并检验其物理预测。本练习将指导你在标准的半经验质量公式中加入一个额外的维格纳项（Wigner term），该项对轻核区的 $N \\approx Z$ 核尤为重要。通过编写代码并计算均方根（RMS）偏差，你将科学地评估这个新项是否能在不牺牲全局精度的前提下，提升模型对轻核结合能的描述能力。[@problem_id:3568504]", "problem": "您的任务是构建并评估一个基于液滴图像的宏观核质量模型。对于一个由质子数 $Z$ 和中子数 $N$ 表征的原子核，其质量数设为 $A=Z+N$。宏观（类液滴）结合能 $E_{\\text{macro}}(Z,N)$ 被建模为一系列具有物理动机的贡献之和，其标度关系遵循经过充分检验的事实：一个与 $A$ 成正比的体积项，一个与 $A^{2/3}$ 成正比的表面项，一个与 $Z(Z-1)/A^{1/3}$ 成正比的库仑排斥项，一个与 $(N-Z)^2/A$ 成正比的不对称项，以及一个大小按 $A^{-1/2}$ 标度且符号取决于 $Z$ 和 $N$ 的奇偶性的对能项。您将使用一个 Wigner 项 $E_W=W|N-Z|$ 来扩展此宏观能量，其中 $W$ 是一个以兆电子伏特 (MeV) 为单位的实值系数。本问题中所有能量都必须以兆电子伏特 (MeV) 表示。\n\n从上述标度律和物理基本原理出发，使用以下科学标准值（单位 MeV）来实例化这些系数：\n- 体积系数 $a_v=15.75$\n- 表面系数 $a_s=17.80$\n- 库仑系数 $a_c=0.711$\n- 不对称系数 $a_a=23.00$\n- 对能系数 $a_p=11.00$\n\n使用常规对能规则：如果 $Z$ 和 $N$ 均为偶数，则定义 $\\delta$ 为 $\\delta=+a_p A^{-1/2}$；如果 $Z$ 和 $N$ 均为奇数，则为 $\\delta=-a_p A^{-1/2}$；否则 $\\delta=0$。待评估的宏观结合能为\n$$\nE_{\\text{macro}}(Z,N;W) = a_v A - a_s A^{2/3} - a_c \\frac{Z(Z-1)}{A^{1/3}} - a_a \\frac{(N-Z)^2}{A} + \\delta + W|N-Z|.\n$$\n\n您的任务是测试加入 Wigner 项是否能在不降低全局拟合质量的情况下，改善对轻核的描述。为此，请计算理论结合能与实验结合能之间的均方根 (RMS) 偏差，计算范围包括：\n- 由 $A \\le 40$ 定义的轻核子集。\n- 下文定义的完整数据集。\n\n将均方根 (RMS) 偏差定义为\n$$\n\\text{RMS} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M}\\left(E_{\\text{macro}}(Z_i,N_i;W)-E_{\\text{exp},i}\\right)^2},\n$$\n其中 $M$ 是子集中的原子核数量，$E_{\\text{exp},i}$ 是原子核 $i$ 的实验结合能。\n\n使用以下测试套件，其中包含原子核及其以 MeV 为单位的实验结合能 $E_{\\text{exp}}$。每一项是一个三元组 $(A,Z,E_{\\text{exp}})$；$N$ 应在内部通过 $A-Z$ 计算得出：\n- $(3,1,8.482)$\n- $(3,2,7.718)$\n- $(4,2,28.296)$\n- $(12,6,92.162)$\n- $(16,8,127.620)$\n- $(20,10,160.647)$\n- $(24,12,198.257)$\n- $(40,20,342.052)$\n- $(56,26,492.253)$\n- $(58,28,506.459)$\n- $(90,40,783.894)$\n- $(120,50,1021.800)$\n- $(208,82,1636.430)$\n\n针对以下四个 Wigner 项系数 $W$（单位 MeV）评估模型：\n- $W=0.0$\n- $W=1.0$\n- $W=2.0$\n- $W=3.0$\n\n对于每个 $W$ 值，计算：\n- 轻核子集的 RMS（单位 MeV），使用数据集中所有 $A \\le 40$ 的原子核。\n- 全局 RMS（单位 MeV），使用数据集中的所有原子核。\n\n将每个 $W$ 的决策定义为一个布尔值：当且仅当相对于基线情况 $W=0.0$，轻核子集的 RMS 严格减小，并且全局 RMS 不增加（即，当前 $W$ 下的全局 RMS 小于或等于 $W=0.0$ 时的全局 RMS）时，该布尔值为真。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的结果列表。将每个测试用例的结果表示为 $[W,\\text{RMS}_{\\text{light}},\\text{RMS}_{\\text{global}},\\text{decision}]$ 形式的列表，其中 $W$、$\\text{RMS}_{\\text{light}}$ 和 $\\text{RMS}_{\\text{global}}$ 是以 MeV 为单位、四舍五入到六位小数的浮点数，而 $\\text{decision}$ 是一个布尔值。例如，最终输出格式必须如下所示：\n$$\n[[0.0, r_l^{(0)}, r_g^{(0)}, \\text{False}],[1.0, r_l^{(1)}, r_g^{(1)}, \\text{True}],\\dots]\n$$\n其中 $r_l^{(k)}$ 和 $r_g^{(k)}$ 会被替换为测试套件中每个 $W$ 的实际数值。", "solution": "我们从液滴图像入手，该图像将原子核建模为由核子组成的均匀、不可压缩的流体。宏观结合能是通过将源于基本物理效应的各项贡献相加而构建的，每项贡献在质量数 $A=Z+N$ 和质子数 $Z$ 上都有其特征标度关系。\n\n体积项反映了核力的饱和性，产生的能量与核子数成正比。该项被建模为 $a_v A$，其中 $a_v$ 捕捉了在核物质内部每个核子的结合能。表面项的产生是由于处于表面的核子邻居较少，从而降低了结合能；表面积的标度关系类似 $A^{2/3}$，因此得到 $-a_s A^{2/3}$。库仑项解释了质子间的静电排斥作用，对于密度近似恒定的球形液滴，其标度关系为 $-a_c Z(Z-1)/A^{1/3}$。由于泡利原理和核力的同位旋依赖性，不对称项对偏离中子数和质子数相等的情况进行惩罚，建模为 $-a_a (N-Z)^2/A$。对能项 $\\delta$ 捕捉了经验上观察到的奇偶交错效应；对于偶偶核（$Z$ 和 $N$ 均为偶数），对能增强结合能；对于奇奇核（两者均为奇数），对能减弱结合能；其他情况则为零。其大小按 $A^{-1/2}$ 标度，因此我们采用：对于偶偶核，$\\delta = +a_p A^{-1/2}$；对于奇奇核，$\\delta = -a_p A^{-1/2}$；其他情况 $\\delta = 0$。\n\n这些标度律是半经验质量公式中被广泛接受的特征，该公式是宏观核模型的基石。为了探究依赖于同位旋的剩余效应，引入了 Wigner 项：$E_W = W|N-Z|$，其中 $W$ 的单位是 MeV。在物理上，该项偏好更接近 $N=Z$ 的原子核，并且对于同位旋对称性效应最强的轻核尤其重要。\n\n综合以上各项，宏观结合能为\n$$\nE_{\\text{macro}}(Z,N;W) = a_v A - a_s A^{2/3} - a_c \\frac{Z(Z-1)}{A^{1/3}} - a_a \\frac{(N-Z)^2}{A} + \\delta + W|N-Z|.\n$$\n我们将系数以 MeV 为单位进行实例化：$a_v=15.75$、$a_s=17.80$、$a_c=0.711$、$a_a=23.00$ 和 $a_p=11.00$。\n\n为了评估拟合质量，我们计算理论结合能与实验结合能之间的均方根 (RMS) 偏差：\n$$\n\\text{RMS}(W;\\mathcal{S}) = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M}\\left(E_{\\text{macro}}(Z_i,N_i;W)-E_{\\text{exp},i}\\right)^2},\n$$\n其中 $\\mathcal{S}$ 是轻核子集（$A \\le 40$）或完整数据集，而 $M$ 是该子集中的原子核数量。\n\n算法步骤：\n1. 解析数据集，为每个原子核 $i$ 计算 $N_i=A_i-Z_i$，并存储实验结合能 $E_{\\text{exp},i}$。\n2. 实现一个函数，用于根据给定的 $(Z,N)$ 计算 $\\delta$，使用对 $Z$ 和 $N$ 的奇偶性检查：\n   - 如果 $Z$ 和 $N$ 均为偶数，$\\delta=+a_p A^{-1/2}$。\n   - 如果 $Z$ 和 $N$ 均为奇数，$\\delta=-a_p A^{-1/2}$。\n   - 否则，$\\delta=0$。\n3. 使用上述公式实现 $E_{\\text{macro}}(Z,N;W)$。\n4. 对于测试套件 $\\{0.0,1.0,2.0,3.0\\}$ 中的每个 $W$，计算：\n   - $\\text{RMS}_{\\text{light}}(W)$，针对 $A\\le 40$ 的子集。\n   - $\\text{RMS}_{\\text{global}}(W)$，针对数据集中的所有原子核。\n5. 确定每个 $W$ 的决策布尔值：\n   - 计算 $W=0.0$ 时的基线 RMS 值，即 $\\text{RMS}_{\\text{light}}(0.0)$ 和 $\\text{RMS}_{\\text{global}}(0.0)$。\n   - 对于每个 $W$，如果 $\\text{RMS}_{\\text{light}}(W)  \\text{RMS}_{\\text{light}}(0.0)$ 并且 $\\text{RMS}_{\\text{global}}(W) \\le \\text{RMS}_{\\text{global}}(0.0)$，则将决策设置为真；否则设置为假。\n6. 将每个情况的结果格式化为 $[W,\\text{RMS}_{\\text{light}},\\text{RMS}_{\\text{global}},\\text{decision}]$，将 RMS 值四舍五入到六位小数，并汇总到一个单一列表中。按规定在单行上打印最终列表。\n\n该设计将宏观核结合的物理学与对 Wigner 项效用的定量测试相结合。RMS 的使用与模型评估中的标准统计量度相一致。所选数据集覆盖了极轻、中等和重核，从而为轻核中 $N\\approx Z$ 的情况提供了对 Wigner 项的敏感性，同时确保了对全局性能的监控。边界情况 $W=0.0$ 作为不含 Wigner 项的基线，而更大的 $W$ 值则用于探究该效应的强度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef pairing_delta(A: int, Z: int, N: int, a_p: float) -> float:\n    \"\"\"\n    Compute pairing term delta for given A, Z, N.\n    + a_p / sqrt(A) for even-even\n    - a_p / sqrt(A) for odd-odd\n    0 otherwise\n    \"\"\"\n    even_Z = (Z % 2 == 0)\n    even_N = (N % 2 == 0)\n    if even_Z and even_N:\n        return a_p / np.sqrt(A)\n    elif (not even_Z) and (not even_N):\n        return -a_p / np.sqrt(A)\n    else:\n        return 0.0\n\ndef macro_binding_energy(A: int, Z: int, W: float,\n                         a_v: float, a_s: float, a_c: float, a_a: float, a_p: float) -> float:\n    \"\"\"\n    Compute macroscopic binding energy E_macro(Z,N;W) in MeV.\n    \"\"\"\n    N = A - Z\n    delta = pairing_delta(A, Z, N, a_p)\n    # Terms per the semi-empirical mass formula scalings with Wigner term\n    volume = a_v * A\n    surface = -a_s * (A ** (2.0 / 3.0))\n    coulomb = -a_c * (Z * (Z - 1)) / (A ** (1.0 / 3.0)) if A > 0 else 0.0\n    asymmetry = -a_a * ((N - Z) ** 2) / A if A > 0 else 0.0\n    wigner = W * abs(N - Z)\n    return volume + surface + coulomb + asymmetry + delta + wigner\n\ndef rms_deviation(dataset, W: float,\n                  a_v: float, a_s: float, a_c: float, a_a: float, a_p: float,\n                  subset_filter=None) -> float:\n    \"\"\"\n    Compute RMS deviation for the given dataset and Wigner coefficient W.\n    subset_filter: callable that takes (A, Z, Eexp) and returns True if included.\n                   If None, include all.\n    \"\"\"\n    residuals = []\n    for (A, Z, Eexp) in dataset:\n        if subset_filter is None or subset_filter(A, Z, Eexp):\n            Emac = macro_binding_energy(A, Z, W, a_v, a_s, a_c, a_a, a_p)\n            resid = Emac - Eexp\n            residuals.append(resid)\n    if len(residuals) == 0:\n        return float('nan')\n    residuals = np.array(residuals, dtype=float)\n    return float(np.sqrt(np.mean(residuals ** 2)))\n\ndef solve():\n    # Coefficients (MeV)\n    a_v = 15.75\n    a_s = 17.80\n    a_c = 0.711\n    a_a = 23.00\n    a_p = 11.00\n\n    # Dataset: (A, Z, E_exp in MeV)\n    dataset = [\n        (3, 1, 8.482),\n        (3, 2, 7.718),\n        (4, 2, 28.296),\n        (12, 6, 92.162),\n        (16, 8, 127.620),\n        (20, 10, 160.647),\n        (24, 12, 198.257),\n        (40, 20, 342.052),\n        (56, 26, 492.253),\n        (58, 28, 506.459),\n        (90, 40, 783.894),\n        (120, 50, 1021.800),\n        (208, 82, 1636.430),\n    ]\n\n    # Define light subset: A = 40\n    light_filter = lambda A, Z, Eexp: A = 40\n\n    # Test suite for W\n    test_W = [0.0, 1.0, 2.0, 3.0]\n\n    # Baseline RMS at W=0.0\n    baseline_light_rms = rms_deviation(dataset, 0.0, a_v, a_s, a_c, a_a, a_p, subset_filter=light_filter)\n    baseline_global_rms = rms_deviation(dataset, 0.0, a_v, a_s, a_c, a_a, a_p, subset_filter=None)\n\n    results = []\n    for W in test_W:\n        rms_light = rms_deviation(dataset, W, a_v, a_s, a_c, a_a, a_p, subset_filter=light_filter)\n        rms_global = rms_deviation(dataset, W, a_v, a_s, a_c, a_a, a_p, subset_filter=None)\n        decision = (rms_light  baseline_light_rms) and (rms_global = baseline_global_rms)\n        # Round floats to six decimals in output\n        results.append([f\"{W:.1f}\", f\"{rms_light:.6f}\", f\"{rms_global:.6f}\", decision])\n\n    # Final print statement in the exact required format.\n    # Ensure proper list formatting with values as specified.\n    # We want floats printed as strings with fixed decimals, booleans as True/False.\n    formatted_items = []\n    for item in results:\n        W_str, rl_str, rg_str, dec = item\n        formatted_items.append(f\"[{W_str}, {rl_str}, {rg_str}, {dec}]\")\n    print(f\"[{','.join(formatted_items)}]\")\n\nsolve()\n```", "id": "3568504"}, {"introduction": "宏观质量模型的具体形式并非一成不变，例如，对称能项就存在不同的参数化方案。本练习将引导你进入一个更高级的主题：模型比较与选择。你将通过对合成数据进行最小二乘拟合，来比较两种不同的对称能模型（纯体积对称能与体积-表面混合对称能），并利用一个对模型细节更敏感的物理量——双中子分离能（$S_{2n}$）——来评估它们的表现。[@problem_id:3568528]", "problem": "您需要实现、拟合和评估两种基于液滴模型的宏观核质量模型。目标是通过拟合核结合能并测试双中子分离能（S2n）的残差，来比较纯体积对称参数化与混合体积加表面对称参数化。您必须编写一个完整、可运行的程序，执行指定的计算，并按下面描述的精确格式输出所需的指标。\n\n基本依据和定义：\n- 对于一个质量数为 $A$、质子数为 $Z$、中子数为 $N=A-Z$ 的原子核，其核结合能可以通过一个与液滴模型一致的宏观展开来建模。该展开式包括来自体积、表面、库仑、对称能和对能的主要贡献。有限尺寸效应引入了一个额外的表面对称贡献，该贡献修正了有限原子核中的中子-质子不对称能。\n- 宏观结合能模型可以表示为带有未知系数 $c_j$ 的基函数 $g_j(A,Z)$ 的线性组合，从而可以使用普通最小二乘法进行估计。\n\n待比较的模型：\n- 模型 $\\mathcal{M}_1$ （纯体积对称）：使用基组\n  $$\n  \\{\\, g_1(A,Z)=A,\\; g_2(A,Z)=A^{2/3},\\; g_3(A,Z)=\\frac{Z(Z-1)}{A^{1/3}},\\; g_4(A,Z)=\\frac{(N-Z)^2}{A},\\; g_5(A,Z)=\\frac{s(A,Z)}{A^{1/2}} \\,\\},\n  $$\n  其中 $s(A,Z)$ 是对能符号因子。\n- 模型 $\\mathcal{M}_2$ （混合体积加表面对称）：在 $\\mathcal{M}_1$ 的基础上增加一个额外的基函数\n  $$\n  g_6(A,Z)=\\frac{(N-Z)^2}{A^{4/3}},\n  $$\n  该函数代表对称能的表面对称贡献。\n\n数据集与合成的“实验”结合能：\n- 仅考虑偶偶核，因此所有条目的对能符号因子 $s(A,Z)=+1$。使用以下同位素集合：\n  - 钙同位素链： $(A,Z)\\in\\{(40,20),(42,20),(44,20),(46,20),(48,20)\\}$。\n  - 镍同位素链： $(A,Z)\\in\\{(56,28),(58,28),(60,28),(62,28),(64,28)\\}$。\n  - 锡同位素链： $(A,Z)\\in\\{(100,50),(102,50),(104,50),(106,50),(108,50)\\}$。\n  - 铅同位素链： $(A,Z)\\in\\{(204,82),(206,82),(208,82)\\}$。\n- 通过一个具有已知基准常数和在选定幻数中子数处的简单示意性壳修正的扩展宏观模型来定义“实验”结合能 $B_{\\mathrm{exp}}(A,Z)$：\n  $$\n  B_{\\mathrm{exp}}(A,Z) \\equiv a_v^{\\star} A \\;-\\; a_s^{\\star} A^{2/3} \\;-\\; a_c^{\\star} \\frac{Z(Z-1)}{A^{1/3}} \\;-\\; a_a^{\\star} \\frac{(N-Z)^2}{A} \\;-\\; a_{ss}^{\\star} \\frac{(N-Z)^2}{A^{4/3}} \\;+\\; a_p^{\\star} \\frac{s(A,Z)}{A^{1/2}} \\;+\\; S_{\\mathrm{magic}}(N),\n  $$\n  其中常数为\n  $$\n  a_v^{\\star}=15.75\\,\\mathrm{MeV},\\quad a_s^{\\star}=17.80\\,\\mathrm{MeV},\\quad a_c^{\\star}=0.711\\,\\mathrm{MeV},\\quad a_a^{\\star}=23.0\\,\\mathrm{MeV},\\quad a_{ss}^{\\star}=12.0\\,\\mathrm{MeV},\\quad a_p^{\\star}=12.0\\,\\mathrm{MeV},\n  $$\n  以及一个示意性壳修正\n  $$\n  S_{\\mathrm{magic}}(N)=\n  \\begin{cases}\n  2.0\\,\\mathrm{MeV},  \\text{if } N \\in \\{20,28,50,82,126\\},\\\\\n  0.0\\,\\mathrm{MeV},  \\text{otherwise}.\n  \\end{cases}\n  $$\n  所有能量单位均为兆电子伏特（MeV）。\n\n拟合任务：\n- 对于每个模型 $\\mathcal{M}_1$ 和 $\\mathcal{M}_2$，通过最小化残差平方和来估计系数 $c_j$\n  $$\n  \\sum_{i} \\left[ B_{\\mathrm{exp}}(A_i,Z_i) - \\sum_{j} c_j\\, g_j(A_i,Z_i) \\right]^2,\n  $$\n  使用普通最小二乘法对整个数据集进行拟合。\n\n双中子分离能 (S2n)：\n- 对于固定的质子数 $Z$，双中子分离能 (S2n) 定义为\n  $$\n  S_{2n}(A,Z) \\equiv B(A,Z) - B(A-2,Z),\n  $$\n  其中 $B$ 表示来自实验定义或模型预测的结合能。根据 $B_{\\mathrm{exp}}(A,Z)$ 计算 $S_{2n,\\mathrm{exp}}(A,Z)$，并根据每个拟合模型 $B_{\\mathrm{th}}(A,Z)=\\sum_j c_j g_j(A,Z)$ 计算 $S_{2n,\\mathrm{th}}(A,Z)$。\n\n测试集：\n- 为以下同位素链对计算 $S_{2n}$ 残差（每对都是一个有效的 $(A,Z)$，且其对应的 $(A-2,Z)$ 存在于数据集中）：\n  - 钙： $(A,Z)\\in\\{(42,20),(44,20),(46,20),(48,20)\\}$。\n  - 镍： $(A,Z)\\in\\{(58,28),(60,28),(62,28),(64,28)\\}$。\n  - 锡： $(A,Z)\\in\\{(102,50),(104,50),(106,50),(108,50)\\}$。\n  - 铅： $(A,Z)\\in\\{(206,82),(208,82)\\}$。\n- 对每个模型，计算所有对的 $S_{2n}$ 残差的均方根（RMS）：\n  $$\n  \\mathrm{RMS} \\equiv \\sqrt{\\frac{1}{M}\\sum_{k=1}^{M}\\left[S_{2n,\\mathrm{th}}(A_k,Z_k)-S_{2n,\\mathrm{exp}}(A_k,Z_k)\\right]^2},\n  $$\n  其中 $M$ 是测试集中的总对数。\n\n输出规范：\n- 您的程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表内有三个浮点数，每个数四舍五入到六位小数：\n  1. 模型 $\\mathcal{M}_1$ 的 $S_{2n}$ 残差的均方根（RMS），单位为 $\\mathrm{MeV}$。\n  2. 模型 $\\mathcal{M}_2$ 的 $S_{2n}$ 残差的均方根（RMS），单位为 $\\mathrm{MeV}$。\n  3. 由 $\\Delta=\\mathrm{RMS}_{\\mathcal{M}_1}-\\mathrm{RMS}_{\\mathcal{M}_2}$ 定义的差值 $\\Delta$，单位为 $\\mathrm{MeV}$。\n- 单位为兆电子伏特（MeV）。最终输出格式必须严格符合以下形式\n  $$\n  [\\mathrm{RMS}_{\\mathcal{M}_1},\\mathrm{RMS}_{\\mathcal{M}_2},\\Delta],\n  $$\n  例如，“[0.123456,0.078901,0.044555]”。\n\n实现约束：\n- 程序必须是自包含的，不需用户输入，不读取外部文件，并产生所述的精确单行输出。根据上述定义，使用确定性计算来得到 $B_{\\mathrm{exp}}(A,Z)$。使用双精度浮点数进行运算。", "solution": "该问题要求对两种宏观核质量模型 $\\mathcal{M}_1$ 和 $\\mathcal{M}_2$ 进行比较分析，这两种模型都源自液滴模型。评估过程包括将这些模型拟合到一个合成的核结合能数据集，然后评估它们对双中子分离能（$S_{2n}$）的预测准确性。这些模型在对称能的处理上有所不同：$\\mathcal{M}_1$ 使用纯体积对称项，而 $\\mathcal{M}_2$ 增加了一个表面对称修正项。\n\n解决方案分为四个主要阶段：\n1.  **生成合成实验数据**：我们首先为一组指定的18个偶偶核计算“实验”结合能 $B_{\\mathrm{exp}}(A,Z)$。\n2.  **通过普通最小二乘法（OLS）进行模型拟合**：对于每个模型 $\\mathcal{M}_1$ 和 $\\mathcal{M}_2$，我们通过将其理论结合能公式与合成数据进行拟合，来确定最优系数集。\n3.  **计算双中子分离能**：使用合成数据和拟合后的模型，我们为指定的原子核测试集计算 $S_{2n}$ 值。\n4.  **性能评估**：我们计算每个模型预测的 $S_{2n}$ 值的均方根（RMS）误差，并比较它们的性能。\n\n**1. 合成实验结合能, $B_{\\mathrm{exp}}(A,Z)$**\n\n问题为质量数为 $A$、质子数为 $Z$ 的原子核的合成“实验”结合能 $B_{\\mathrm{exp}}(A,Z)$ 提供了一个精确的公式。令 $N = A - Z$ 为中子数。该公式为：\n$$\nB_{\\mathrm{exp}}(A,Z) = a_v^{\\star} A - a_s^{\\star} A^{2/3} - a_c^{\\star} \\frac{Z(Z-1)}{A^{1/3}} - a_a^{\\star} \\frac{(N-Z)^2}{A} - a_{ss}^{\\star} \\frac{(N-Z)^2}{A^{4/3}} + a_p^{\\star} \\frac{s(A,Z)}{A^{1/2}} + S_{\\mathrm{magic}}(N)\n$$\n常数给定为 $a_v^{\\star}=15.75$, $a_s^{\\star}=17.80$, $a_c^{\\star}=0.711$, $a_a^{\\star}=23.0$, $a_{ss}^{\\star}=12.0$, 和 $a_p^{\\star}=12.0$，单位均为 $\\mathrm{MeV}$。由于数据集中的所有原子核都是偶偶核，对能符号因子 $s(A,Z)=+1$。示意性壳修正 $S_{\\mathrm{magic}}(N)$ 对于幻数中子数 $N \\in \\{20,28,50,82,126\\}$ 为 $2.0\\,\\mathrm{MeV}$，否则为 $0$。我们首先为数据集中的所有原子核计算这些 $B_{\\mathrm{exp}}$ 值，这些值将作为拟合过程的基准。\n\n**2. 模型构建与普通最小二乘法（OLS）拟合**\n\n两种模型的理论结合能 $B_{\\mathrm{th}}(A,Z)$ 都表示为基函数 $g_j(A,Z)$ 的线性组合：\n$$\nB_{\\mathrm{th}}(A,Z) = \\sum_{j} c_j g_j(A,Z)\n$$\n系数 $c_j$ 是待确定的未知参数。此问题结构适合使用普通最小二乘法（OLS）求解。对于一个包含 $n$ 个原子核的数据集，我们可以构建一个线性系统 $\\mathbf{y} \\approx \\mathbf{X}\\mathbf{c}$，其中：\n- $\\mathbf{y}$ 是一个大小为 $n$ 的列向量，包含实验结合能 $y_i = B_{\\mathrm{exp}}(A_i, Z_i)$。\n- $\\mathbf{X}$ 是一个 $n \\times k$ 的设计矩阵，其中 $k$ 是模型中基函数的数量。每个条目 $X_{ij}$ 是第 $j$ 个基函数对第 $i$ 个原子核的取值，即 $X_{ij} = g_j(A_i, Z_i)$。\n- $\\mathbf{c}$ 是包含 $k$ 个未知系数 $c_j$ 的列向量。\n\nOLS 方法找到使残差平方和 $\\|\\mathbf{y} - \\mathbf{X}\\mathbf{c}\\|^2$ 最小化的向量 $\\mathbf{c}$。其解由 $\\mathbf{c} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$ 给出。\n\n**模型 $\\mathcal{M}_1$ （体积对称）：**\n此模型使用 $k=5$ 个基函数：\n- 体积： $g_1(A,Z) = A$\n- 表面： $g_2(A,Z) = -A^{2/3}$\n- 库仑： $g_3(A,Z) = -\\frac{Z(Z-1)}{A^{1/3}}$\n- 对称（体积）： $g_4(A,Z) = -\\frac{(N-Z)^2}{A}$\n- 对能： $g_5(A,Z) = \\frac{s(A,Z)}{A^{1/2}} = A^{-1/2}$ （因为 $s(A,Z)=+1$）\n\n我们从包含18个原子核的数据集中构建 $18 \\times 5$ 的设计矩阵 $\\mathbf{X}_1$ 和目标向量 $\\mathbf{y}$。然后求解系数向量 $\\mathbf{c}_1$。\n\n**模型 $\\mathcal{M}_2$ （体积 + 表面对称）：**\n此模型在 $\\mathcal{M}_1$ 的基础上扩展了第六个基函数（$k=6$），代表对称能的表面贡献：\n- 对称（表面）： $g_6(A,Z) = -\\frac{(N-Z)^2}{A^{4/3}}$\n\n我们构建 $18 \\times 6$ 的设计矩阵 $\\mathbf{X}_2$，并使用相同的目标向量 $\\mathbf{y}$ 求解系数向量 $\\mathbf{c}_2$。\n\n一个用于求解这些线性系统的数值稳健实现是 `numpy.linalg.lstsq`，我们将使用它。\n\n**3. 双中子分离能（$S_{2n}$）的计算**\n\n双中子分离能定义为从一个原子核中移除两个中子所需的能量：\n$$\nS_{2n}(A,Z) = B(A,Z) - B(A-2,Z)\n$$\n我们为指定的包含 $M=14$ 个原子核对的测试集计算此量。\n- $S_{2n,\\mathrm{exp}}(A,Z)$ 是使用合成的 $B_{\\mathrm{exp}}$ 值计算的。\n- $S_{2n,\\mathrm{th},1}(A,Z)$ 是使用理论结合能 $B_{\\mathrm{th},1}(A,Z) = \\sum_{j=1}^{5} c_{1,j} g_j(A,Z)$ 和拟合出的系数 $\\mathbf{c}_1$ 计算的。\n- $S_{2n,\\mathrm{th},2}(A,Z)$ 是使用 $B_{\\mathrm{th},2}(A,Z) = \\sum_{j=1}^{6} c_{2,j} g_j(A,Z)$ 和系数 $\\mathbf{c}_2$ 计算的。\n\n**4. 通过均方根（RMS）误差进行性能评估**\n\n最后一步是量化每个模型对实验 $S_{2n}$ 值的再现程度。我们为此使用残差的均方根（RMS）。对于每个模型 $\\mathcal{M}_k$：\n$$\n\\mathrm{RMS}_{\\mathcal{M}_k} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M}\\left[S_{2n,\\mathrm{th},k}(A_i,Z_i) - S_{2n,\\mathrm{exp}}(A_i,Z_i)\\right]^2}\n$$\n求和遍历 $S_{2n}$ 测试集中的 $M=14$ 个对。我们计算 $\\mathrm{RMS}_{\\mathcal{M}_1}$ 和 $\\mathrm{RMS}_{\\mathcal{M}_2}$。差值 $\\Delta = \\mathrm{RMS}_{\\mathcal{M}_1} - \\mathrm{RMS}_{\\mathcal{M}_2}$ 直接衡量了包含表面对称项所带来的改进。正的 $\\Delta$ 值表明模型 $\\mathcal{M}_2$ 更准确。合成数据中的壳修正项 $S_{\\mathrm{magic}}(N)$ 不属于任何一个模型的基组，它充当了未建模物理的来源。每个模型处理这种缺失物理的能力，尤其是在像 $S_{2n}$ 这样的微分量中，是本次测试的核心。\n\n程序按顺序实现这些步骤，确保所有计算都使用双精度浮点运算，并按规定格式化最终结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements, fits, and assesses two macroscopic nuclear mass models.\n    \"\"\"\n    # Ground-truth constants for synthetic experimental data in MeV\n    A_V_STAR = 15.75\n    A_S_STAR = 17.80\n    A_C_STAR = 0.711\n    A_A_STAR = 23.0\n    A_SS_STAR = 12.0\n    A_P_STAR = 12.0\n\n    # Dataset of even-even nuclei for fitting (A, Z)\n    fit_dataset = [\n        (40, 20), (42, 20), (44, 20), (46, 20), (48, 20),  # Calcium\n        (56, 28), (58, 28), (60, 28), (62, 28), (64, 28),  # Nickel\n        (100, 50), (102, 50), (104, 50), (106, 50), (108, 50),  # Tin\n        (204, 82), (206, 82), (208, 82)  # Lead\n    ]\n\n    # Test suite for S2n residuals (A, Z)\n    s2n_test_suite = [\n        (42, 20), (44, 20), (46, 20), (48, 20),\n        (58, 28), (60, 28), (62, 28), (64, 28),\n        (102, 50), (104, 50), (106, 50), (108, 50),\n        (206, 82), (208, 82)\n    ]\n\n    magic_neutron_numbers = {20, 28, 50, 82, 126}\n\n    # Helper functions for basis functions g_j(A, Z)\n    # s(A,Z) is +1 for all nuclei in the dataset.\n    def g1(A, Z): return A  # Volume\n    def g2(A, Z): return -A**(2/3)  # Surface\n    def g3(A, Z): return -Z * (Z - 1) / A**(1/3)  # Coulomb\n    def g4(A, Z):  # Symmetry (volume)\n        N = A - Z\n        return -(N - Z)**2 / A\n    def g5(A, Z): return A**(-1/2)  # Pairing\n    def g6(A, Z):  # Symmetry (surface)\n        N = A - Z\n        return -(N - Z)**2 / A**(4/3)\n\n    # Function to calculate synthetic experimental binding energy\n    def calculate_b_exp(A, Z):\n        N = A - Z\n        s_magic = 2.0 if N in magic_neutron_numbers else 0.0\n        \n        # Note: problem defines B_exp with minus signs for coefficients,\n        # but the standard SEMF for B is B = a_v*g1 + a_s*g2 + a_c*g3 + ...\n        # where g2, g3 are negative. To match the problem's formula:\n        # B_exp = a_v*A - a_s*A^(2/3) ...\n        # The basis functions g_j are defined to absorb the signs.\n        b_exp = (A_V_STAR * A -\n                 A_S_STAR * A**(2/3) -\n                 A_C_STAR * Z*(Z-1) / A**(1/3) -\n                 A_A_STAR * (N-Z)**2 / A -\n                 A_SS_STAR * (N-Z)**2 / A**(4/3) +\n                 A_P_STAR * A**(-1/2) +\n                 s_magic)\n        return b_exp\n\n    # --- Generate synthetic \"experimental\" data ---\n    b_exp_map = { (A, Z): calculate_b_exp(A, Z) for A, Z in fit_dataset }\n    y_exp = np.array([b_exp_map[nuc] for nuc in fit_dataset])\n\n\n    rms_results = []\n    models_basis = {\n        'M1': [g1, g2, g3, g4, g5],\n        'M2': [lambda A,Z: g1(A,Z), lambda A,Z: g2(A,Z), lambda A,Z: g3(A,Z), lambda A,Z: g4(A,Z), lambda A,Z: g5(A,Z), lambda A,Z: g6(A,Z)]\n    }\n    # Redefine basis to match the problem text's linear combination\n    # c1*g1 + c2*g2 ... where g's are positive.\n    basis_M1_pos = [lambda A,Z: g1(A,Z), lambda A,Z: A**(2/3), lambda A,Z: Z*(Z-1)/A**(1/3), lambda A,Z: (A-2*Z)**2/A, lambda A,Z: A**(-1/2)]\n    basis_M2_pos = basis_M1_pos + [lambda A,Z: (A-2*Z)**2/A**(4/3)]\n    \n    models_to_run = {'M1': basis_M1_pos, 'M2': basis_M2_pos}\n\n    for model_name, basis_functions in models_to_run.items():\n        # --- Model Fitting via OLS ---\n        X = np.array([[func(A, Z) for func in basis_functions] for A, Z in fit_dataset])\n        coeffs, _, _, _ = np.linalg.lstsq(X, y_exp, rcond=None)\n        \n        # --- Calculate Theoretical Binding Energies ---\n        b_th_map = { (A, Z): np.dot(X[i, :], coeffs) for i, (A, Z) in enumerate(fit_dataset) }\n\n        # --- Calculate S2n and Residuals ---\n        s2n_residuals = []\n        for A, Z in s2n_test_suite:\n            s2n_exp = b_exp_map[(A, Z)] - b_exp_map[(A - 2, Z)]\n            \n            # Recalculate basis for A and A-2 to get theoretical B\n            vec_A = np.array([func(A,Z) for func in basis_functions])\n            vec_A_minus_2 = np.array([func(A-2,Z) for func in basis_functions])\n            \n            b_th_A = np.dot(vec_A, coeffs)\n            b_th_A_minus_2 = np.dot(vec_A_minus_2, coeffs)\n            \n            s2n_th = b_th_A - b_th_A_minus_2\n            s2n_residuals.append(s2n_th - s2n_exp)\n            \n        rms = np.sqrt(np.mean(np.square(s2n_residuals)))\n        rms_results.append(rms)\n\n    rms_m1 = rms_results[0]\n    rms_m2 = rms_results[1]\n    delta = rms_m1 - rms_m2\n\n    print(f\"[{rms_m1:.6f},{rms_m2:.6f},{delta:.6f}]\")\n\nsolve()\n```", "id": "3568528"}]}