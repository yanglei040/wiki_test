{"hands_on_practices": [{"introduction": "集体振动，或称声子，可以与单个核子的运动状态发生耦合。这种耦合是原子核内残余相互作用的重要体现，它会导致原本清晰的单粒子能级变得复杂。本练习通过一个简化的粒子-声子耦合模型，让您亲手计算并观察这种耦合如何导致原始的单粒子态“碎裂”成多个新的本征态，并使其能量发生移动 ([@problem_id:3550593])。这个实践将为您提供一个关于集体性微观效应的直观理解。", "problem": "实现一个独立程序，该程序在一个示意性粒子-声子耦合模型中，对一个与单个尖锐集体振动声子线性耦合的单核子单粒子态进行建模，并计算在几种不同耦合强度下，诱导的准粒子质量移动和谱碎裂。系统处于零温状态，所有能量必须以兆电子伏特 (MeV) 表示。该模型必须从第一性原理出发，以多体哈密顿量和推迟格林函数的定义为起点进行推导。\n\n使用以下基本基矢：\n- 一个费米子单粒子产生算符 $c^{\\dagger}$ 占据一个裸能量为 $\\epsilon_{0}$ 的单能级，一个玻色子声子产生算符 $b^{\\dagger}$ 激发一个能量为 $\\omega_{\\text{ph}}$ 的单振动模式。\n- 示意性粒子-声子哈密顿量为\n$$\n\\hat{H} = \\epsilon_{0}\\, c^{\\dagger} c + \\omega_{\\text{ph}}\\, b^{\\dagger} b + g\\, c^{\\dagger} c \\left(b + b^{\\dagger}\\right),\n$$\n其中 $g$ 是粒子-声子耦合强度。假设为单个核子，因此可以忽略超出该单能级的泡利阻塞效应。\n- 根据定义，将核子添加到空能级上的推迟单粒子格林函数（格林函数 (GF)）为\n$$\nG(\\omega) = \\frac{1}{\\omega - \\epsilon_{0} - \\Sigma(\\omega)},\n$$\n其中 $\\Sigma(\\omega)$ 是推迟自能。在零温和忽略内禀宽度的单声子截断下，自能来源于单个尖锐声子的虚发射和重吸收。\n- 谱函数定义为\n$$\nA(\\omega) = -\\frac{1}{\\pi}\\, \\operatorname{Im} G(\\omega + i\\eta),\n$$\n其中 $\\eta \\to 0^{+}$ 是一个无穷小正数。\n\n任务要求：\n1. 从哈密顿量、格林函数的定义以及戴森方程出发，将问题简化为能够捕捉单声子子空间内精确动力学的有限维形式。利用此形式求出 $G(\\omega)$ 的孤立极点 $\\{\\omega_{i}\\}$ 及其留数 $\\{Z_{i}\\}$，其中每个留数是原始单粒子态在第 $i$ 个精确本征态中的权重。留数必须满足 $\\sum_{i} Z_{i} = 1$。\n2. 将具有最大留数的极点定义为准粒子极点，并将准粒子质量移动定义为\n$$\n\\Delta E \\equiv \\omega_{\\text{qp}} - \\epsilon_{0}.\n$$\n以 $\\text{MeV}$ 为单位报告 $\\Delta E$。\n3. 使用离散极点权重的香农熵定义谱碎裂的标量量化度量，\n$$\nS \\equiv -\\sum_{i} Z_{i} \\ln Z_{i},\n$$\n其中对数为自然对数。按照惯例，当 $Z_{i}=0$ 时，该项对 $S$ 的贡献为 $0$。\n4. 实现一个程序，该程序针对每个指定的耦合强度计算：\n   - 以 $\\text{MeV}$ 为单位的准粒子质量移动 $\\Delta E$。\n   - 谱碎裂 $S$（无量纲）。\n5. 使用以下以 $\\text{MeV}$ 为单位的固定物理参数：\n   - $\\epsilon_{0} = -8.0$，\n   - $\\omega_{\\text{ph}} = 3.0$。\n6. 使用以下以 $\\text{MeV}$ 为单位的耦合强度测试组：\n   - $g \\in [0.0, 0.5, 1.5, 3.0, 5.0]$。\n   这些情况测试了：无耦合（基准）、弱耦合、中等耦合、强耦合和极强耦合极限。\n7. 你的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个耦合强度，输出一个双元素列表 $[\\Delta E, S]$，因此最终输出必须是与测试组耦合顺序相同的双元素列表的列表。例如，整体格式必须是\n$$\n\\big[\\,[\\Delta E_{1}, S_{1}],\\,[\\Delta E_{2}, S_{2}],\\,\\dots\\,\\big].\n$$\n8. 程序不得接受任何用户输入，也不得读取或写入任何文件。所有能量单位必须是 $\\text{MeV}$，所有对数必须是自然对数。不要对输出进行四舍五入；打印计算产生的完整双精度值。", "solution": "在对其规定进行严格审查后，用户的问题被评估为**有效**。该问题在科学上基于量子力学和多体理论的原理，特别是核物理中使用的粒子-振动耦合模型。问题是良定的，具有清晰的哈密顿量、明确的任务定义和所有必需的参数。其语言客观明确。问题是自包含的，并且在计算上是可行的。\n\n解决方案通过在指定的理论框架内对系统进行建模来展开。题目要求将问题简化为能够捕捉“单声子子空间”内动力学的有限维形式。这被解释为对粒子加声子系统的 Tamm-Dancoff 近似 (TDA)，其中基矢被截断为只包含零声子或单声子态。题中提到自能产生于“单个尖锐声子”的虚交换，这在格林函数形式论中对应于单圈图，该提法有力地支持了这一解释。\n\n系统的哈密顿量由下式给出：\n$$\n\\hat{H} = \\epsilon_{0}\\, c^{\\dagger} c + \\omega_{\\text{ph}}\\, b^{\\dagger} b + g\\, c^{\\dagger} c \\left(b + b^{\\dagger}\\right)\n$$\n我们关心的是单核子态，因此数算符 $c^{\\dagger}c$ 在相关希尔伯特空间上作为单位算符。与单粒子耦合的声子自由度的有效哈密顿量为：\n$$\n\\hat{H}_{\\text{eff}} = \\epsilon_{0} + \\omega_{\\text{ph}}\\, b^{\\dagger} b + g \\left(b + b^{\\dagger}\\right)\n$$\n单声子子空间的基矢由两个态组成：$|0\\rangle$ 代表零声子的单核子，而 $|1\\rangle$ 代表单声子的单核子。产生算符 ($b^{\\dagger}$) 和湮灭算符 ($b$) 在这些基矢上的作用是标准的：$b|0\\rangle=0$，$b^{\\dagger}|0\\rangle=|1\\rangle$，$b|1\\rangle=|0\\rangle$，以及 $b^{\\dagger}b|n\\rangle=n|n\\rangle$。\n\n在此基矢下，哈密顿矩阵 $\\mathbf{H}$ 是一个 $2 \\times 2$ 矩阵，其矩阵元为 $H_{ij} = \\langle i | \\hat{H}_{\\text{eff}} | j \\rangle$：\n$$\nH_{00} = \\langle 0 | \\epsilon_{0} + \\omega_{\\text{ph}}\\, b^{\\dagger} b + g (b + b^{\\dagger}) | 0 \\rangle = \\epsilon_{0}\n$$\n$$\nH_{11} = \\langle 1 | \\epsilon_{0} + \\omega_{\\text{ph}}\\, b^{\\dagger} b + g (b + b^{\\dagger}) | 1 \\rangle = \\epsilon_{0} + \\omega_{\\text{ph}}\n$$\n$$\nH_{01} = \\langle 0 | \\epsilon_{0} + \\omega_{\\text{ph}}\\, b^{\\dagger} b + g (b + b^{\\dagger}) | 1 \\rangle = g \\langle 0 | b | 1 \\rangle = g\n$$\n$$\nH_{10} = \\langle 1 | \\epsilon_{0} + \\omega_{\\text{ph}}\\, b^{\\dagger} b + g (b + b^{\\dagger}) | 0 \\rangle = g \\langle 1 | b^{\\dagger} | 0 \\rangle = g\n$$\n最终得到的哈密顿矩阵为：\n$$\n\\mathbf{H} = \\begin{pmatrix} \\epsilon_{0}  g \\\\ g  \\epsilon_{0} + \\omega_{\\text{ph}} \\end{pmatrix}\n$$\n格林函数的极点 $\\{\\omega_{i}\\}$ 是该矩阵的本征值。它们通过求解特征方程 $\\det(\\mathbf{H} - \\omega \\mathbf{I}) = 0$ 得到：\n$$\n(\\epsilon_{0} - \\omega)(\\epsilon_{0} + \\omega_{\\text{ph}} - \\omega) - g^2 = 0\n$$\n令 $x = \\omega - \\epsilon_{0}$。方程变为 $-x(\\omega_{\\text{ph}} - x) - g^2 = 0$，可简化为一个二次方程：\n$$\nx^2 - \\omega_{\\text{ph}} x - g^2 = 0\n$$\n$x$ 的解为 $x_{\\pm} = \\frac{\\omega_{\\text{ph}} \\pm \\sqrt{\\omega_{\\text{ph}}^2 + 4g^2}}{2}$。因此，两个极点为：\n$$\n\\omega_{\\pm} = \\epsilon_{0} + x_{\\pm} = \\epsilon_{0} + \\frac{\\omega_{\\text{ph}} \\pm \\sqrt{\\omega_{\\text{ph}}^2 + 4g^2}}{2}\n$$\n这个结果与使用单圈自能 $\\Sigma(\\omega) = g^2 / (\\omega - (\\epsilon_{0} + \\omega_{\\text{ph}}))$ 求解格林函数 $G(\\omega) = [\\omega - \\epsilon_{0} - \\Sigma(\\omega)]^{-1}$ 的极点所得结果相同。\n\n留数 $\\{Z_{i}\\}$ 是原始单粒子态在新的相互作用本征态中的权重。原始态是 $|0\\rangle$，即第一个基矢 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。对于每个本征值 $\\omega_{i}$，相应的归一化本征矢量为 $\\Psi_{i} = \\begin{pmatrix} c_{i,0} \\\\ c_{i,1} \\end{pmatrix}$。留数定义为 $Z_{i} = |c_{i,0}|^2$。\n本征矢量方程 $(\\mathbf{H} - \\omega \\mathbf{I})\\Psi = 0$ 给出 $(\\epsilon_{0}-\\omega)c_0 + gc_1 = 0$。使用归一化条件 $c_0^2 + c_1^2 = 1$，我们得到：\n$$\nc_0^2 \\left(1 + \\frac{(\\epsilon_{0}-\\omega)^2}{g^2}\\right) = 1 \\implies Z = c_0^2 = \\frac{g^2}{g^2 + (\\omega - \\epsilon_{0})^2} = \\frac{g^2}{g^2 + x^2}\n$$\n两个极点 $\\omega_{\\pm}$ 的留数为：\n$$\nZ_{\\pm} = \\frac{g^2}{g^2 + x_{\\pm}^2}\n$$\n可以证明 $Z_{+} + Z_{-} = 1$，满足求和规则。\n\n准粒子极点 $\\omega_{\\text{qp}}$ 是具有最大留数的极点。我们比较 $Z_{-}$ 和 $Z_{+}$。由于 $Z \\propto 1/(g^2+x^2)$，较大的留数对应较小的 $|x|$。对于 $g > 0$，我们有 $|x_{-}| = |(\\omega_{\\text{ph}} - \\sqrt{\\omega_{\\text{ph}}^2 + 4g^2})/2|  |(\\omega_{\\text{ph}} + \\sqrt{\\omega_{\\text{ph}}^2 + 4g^2})/2| = |x_{+}|$。因此，$Z_{-} > Z_{+}$。准粒子极点是 $\\omega_{\\text{qp}} = \\omega_{-}$。\n\n准粒子质量移动 $\\Delta E$ 定义为 $\\omega_{\\text{qp}} - \\epsilon_{0}$：\n$$\n\\Delta E = \\omega_{-} - \\epsilon_{0} = x_{-} = \\frac{\\omega_{\\text{ph}} - \\sqrt{\\omega_{\\text{ph}}^2 + 4g^2}}{2}\n$$\n对于 $g = 0$ 的特殊情况，哈密顿量是对角的。极点为 $\\epsilon_{0}$ 和 $\\epsilon_{0} + \\omega_{\\text{ph}}$。原始粒子态 $|0\\rangle$ 已经是能量为 $\\epsilon_{0}$ 的本征态。因此，准粒子极点是 $\\omega_{\\text{qp}} = \\epsilon_{0}$，留数为 $Z=1$，这使得 $\\Delta E=0$。\n\n谱碎裂 $S$ 使用香non熵公式以及两个留数 $Z_{-}$ 和 $Z_{+}$ 计算。令 $Z_{\\text{qp}} = Z_{-}$。则另一个留数为 $1 - Z_{\\text{qp}}$。\n$$\nS = - \\sum_{i} Z_{i} \\ln Z_{i} = - \\left( Z_{\\text{qp}} \\ln Z_{\\text{qp}} + (1-Z_{\\text{qp}}) \\ln(1-Z_{\\text{qp}}) \\right)\n$$\n当 $g=0$ 时，$Z_{\\text{qp}}=1$，所以 $S = -(1 \\ln 1 + 0 \\ln 0) = 0$。\n\n对于每个耦合强度 $g$ 的算法如下：\n1.  设置 $\\epsilon_{0} = -8.0$，$\\omega_{\\text{ph}} = 3.0$。\n2.  如果 $g = 0$，则 $\\Delta E = 0$ 且 $S = 0$。\n3.  如果 $g  0$：\n    a. 计算质量移动：$\\Delta E = (\\omega_{\\text{ph}} - \\sqrt{\\omega_{\\text{ph}}^2 + 4g^2}) / 2$。\n    b. 计算准粒子留数：$Z_{\\text{qp}} = g^2 / (g^2 + (\\Delta E)^2)$。\n    c. 计算熵：$S = -(Z_{\\text{qp}} \\ln(Z_{\\text{qp}}) + (1-Z_{\\text{qp}}) \\ln(1-Z_{\\text{qp}}))$。\n4.  存储并格式化结果 $[\\Delta E, S]$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the quasiparticle mass shift and spectral fragmentation for a\n    particle-phonon coupling model.\n    \"\"\"\n\n    # Fixed physical parameters in MeV\n    epsilon_0 = -8.0\n    omega_ph = 3.0\n\n    # Test suite of coupling strengths in MeV\n    g_values = [0.0, 0.5, 1.5, 3.0, 5.0]\n\n    results = []\n    for g in g_values:\n        if g == 0.0:\n            # No coupling case: The particle state is an eigenstate, no shift, no fragmentation.\n            delta_E = 0.0\n            entropy_S = 0.0\n        else:\n            # For g > 0, we apply the derived formulas.\n            \n            # 1. Calculate the quasiparticle mass shift (Delta E)\n            # This corresponds to the energy shift of the pole with the largest residue.\n            # Delta_E = x_ = (omega_ph - sqrt(omega_ph^2 + 4*g^2)) / 2\n            sqrt_term = np.sqrt(omega_ph**2 + 4 * g**2)\n            delta_E = (omega_ph - sqrt_term) / 2.0\n\n            # 2. Calculate the quasiparticle residue (Z_qp)\n            # This is the weight of the bare particle state in the quasiparticle eigenstate.\n            # Z_qp = g^2 / (g^2 + Delta_E^2)\n            residue_qp = g**2 / (g**2 + delta_E**2)\n            \n            # The residue of the other state. The sum of residues must be 1.\n            residue_other = 1.0 - residue_qp\n\n            # 3. Calculate the spectral fragmentation (S) using Shannon entropy\n            # S = - sum( Z_i * ln(Z_i) )\n            # We handle the terms to avoid log(0) issues, although for g > 0,\n            # both residues are strictly between 0 and 1.\n            term1 = -residue_qp * np.log(residue_qp) if residue_qp > 0 else 0.0\n            term2 = -residue_other * np.log(residue_other) if residue_other > 0 else 0.0\n            entropy_S = term1 + term2\n\n        results.append([delta_E, entropy_S])\n\n    # Format the final output according to the problem specification.\n    # e.g., [[-0.0, 0.0],[-0.08113883008418973, 0.16109337032338162],...]\n    # Using map(str, ...) on the list of lists correctly formats the inner lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3550593"}, {"introduction": "巨共振是原子核集体运动的宏观体现，它表现为在特定能量区域的激发强度集中。本练习将向您展示，如何利用能量加权求和规则 (sum rules) 来表征这些共振的整体属性，例如其质心能量，而通常无需解出完整的微观动力学方程。您将通过一个谐振子模型，实践约束平均场方法来计算逆能量加权求和规则 $m_{-1}$，并将其与能量加权求和规则 $m_1$ 联系起来，从而确定巨单极共振的能量 ([@problem_id:3550607])。", "problem": "考虑一个原子核的一维独立粒子平均场模型，其中每个核子在球谐振子势中运动。设单粒子哈密顿量为 $H = \\frac{p^{2}}{2m} + \\frac{1}{2} m \\omega^{2} x^{2}$，同位旋标量单极算符为 $F = \\sum_{i=1}^{A} x_{i}^{2}$，其中 $m$ 是核子质量，$\\omega$ 是振子角频率，$A$ 是粒子数。在约束的Hartree-Fock / Hartree-Fock-Bogoliubov (HF/HFB) 方法中，引入一个静态外场 $- \\lambda F$ 并计算基态期望值 $\\langle F \\rangle$ 的静态响应，以推断能量倒数加权求和规则 $m_{-1}$。使用线性响应理论和能量加权求和规则的定义，从第一性原理推导如何从静态约束响应中获得能量倒数加权求和规则 $m_{-1}$，以及巨单极共振的质心能量如何与能量加权和能量倒数加权求和规则相关联，而无需使用任何简化公式。\n\n您将为上述模型实现以下计算任务：\n- 在约束强度 $\\lambda$ 上使用中心有限差分来计算静态响应率 $\\chi(0) = \\left.\\frac{\\partial \\langle F \\rangle}{\\partial \\lambda}\\right|_{\\lambda=0}$，然后通过一个从第一性原理推导出的适当比例因子获得 $m_{-1}$。\n- 通过双对易子定义 $m_{1} = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle$ 计算谐振子平均场中多体基态的能量加权求和规则 $m_{1}$。\n- 根据推导出的关系，计算用 $m_{1}$ 和 $m_{-1}$ 表示的集体单极模质心能量的明确表达式。\n\n假设自旋简并度为 $g$，并遵循泡利原理填充最低的单粒子振子能级 $n = 0, 1, 2, \\dots$，直到容纳 $A$ 个粒子。对于每个能级 $n$，在未微扰基态中的单粒子期望值为 $\\langle n | x^{2} | n \\rangle = \\frac{\\hbar}{2 m \\omega} (2n + 1)$，在存在约束 $- \\lambda x^{2}$ 的情况下，它变为 $\\langle n | x^{2} | n \\rangle_{\\lambda} = \\frac{\\hbar}{2 m \\omega_{\\lambda}} (2n + 1)$，其中 $\\omega_{\\lambda} = \\sqrt{\\omega^{2} - \\frac{2 \\lambda}{m}}$。对于静态响应率，使用一个小的中心差分步长 $\\delta$，使得对于 $+\\delta$ 和 $-\\delta$，都有 $\\omega_{\\lambda}^{2} > 0$。\n\n必须使用的基本原理：\n- 正则对易关系 $[x, p] = i \\hbar$。\n- 静态响应率与能量倒数加权求和规则之间的线性响应理论联系。\n- 通过双对易子 $m_{1} = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle$ 定义的能量加权求和规则。\n- 具有自旋简并度的谐振子能级的非相对论性独立粒子填充。\n\n物理和数值单位：\n- 能量单位使用兆电子伏特 (MeV)，长度单位使用飞米 (fm)，且 $\\hbar = 197.3269804$ MeV·fm。\n- 质量 $m$ 以 MeV 为单位给出（设光速 $c = 1$），振子参数由 $\\hbar \\omega$ 指定（单位为 MeV），程序必须内部通过 $\\omega = (\\hbar \\omega)/\\hbar$ 将其转换为 $\\omega$。\n- 以 MeV 为单位表示集体单极模的质心能量，并四舍五入到六位小数。\n- 以 $\\text{fm}^{4}/\\text{MeV}$ 为单位表示 $m_{-1}$，并四舍五入到六位小数。\n\n测试套件：\n对于每个测试用例，输入参数为 $(m, \\hbar, \\hbar \\omega, A, g)$，其中 $m$ 是核子质量（单位 MeV），$\\hbar$ 固定为 $197.3269804$ MeV·fm，$\\hbar \\omega$ 是振子能量量子（单位 MeV），$A$ 是粒子数，$g$ 是自旋简并度。使用以下测试用例：\n- 用例 1：$(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 10.000, A = 8, g = 2)$。\n- 用例 2：$(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 7.000, A = 3, g = 2)$。\n- 用例 3：$(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 13.000, A = 1, g = 2)$。\n- 用例 4：$(m = 938.920, \\hbar = 197.3269804, \\hbar \\omega = 15.000, A = 20, g = 2)$。\n\n算法规范：\n- 计算每个振子能级 $n$ 的占据数，直至达到粒子数 $A$，并考虑简并度 $g$。对于一个能级 $n$，其占据数是介于 $0$ 和 $g$ 之间的整数。\n- 使用占据数计算求和因子 $S = \\sum_{\\text{能级 } n} \\text{occ}(n) (2n + 1)$。\n- 使用 $S$ 计算在 $\\lambda = +\\delta$ 和 $\\lambda = -\\delta$ 时的 $\\langle F \\rangle_{\\lambda} = \\frac{\\hbar}{2 m \\omega_{\\lambda}} S$，其中 $\\delta = 10^{-5} m \\omega^{2}$ 确保对于两个符号，$\\omega_{\\lambda}^{2} > 0$。\n- 估计 $\\chi(0) = \\frac{\\langle F \\rangle_{+\\delta} - \\langle F \\rangle_{-\\delta}}{2 \\delta}$，然后通过其与 $\\chi(0)$ 的第一性原理推导出的比例关系计算 $m_{-1}$。\n- 通过以基态期望值表示的双对易子表达式计算 $m_{1}$。\n- 使用您推导出的 $m_{1}$ 和 $m_{-1}$ 之间的关系计算质心能量。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含每个测试用例的两个浮点数：首先是 $m_{-1}$（单位 $\\text{fm}^{4}/\\text{MeV}$，四舍五入到六位小数），然后是质心能量（单位 MeV，四舍五入到六位小数）。例如，输出应如下所示：$[m_{-1}^{(1)},E_{\\text{centroid}}^{(1)},m_{-1}^{(2)},E_{\\text{centroid}}^{(2)},\\dots]$，其中上标表示测试用例索引。", "solution": "该问题要求推导一维谐振子模型中求和规则与静态响应之间的关系，然后进行计算实现。解决方案分为两部分：首先是从第一性原理进行的理论推导，其次是基于这些原理的算法设计。\n\n### 第1部分：第一性原理推导\n\n解决方案取决于必须推导的三个关键关系：静态响应率 $\\chi(0)$ 与能量倒数加权求和规则 $m_{-1}$ 之间的联系；使用双对易子形式主义计算能量加权求和规则 $m_1$；以及质心能量 $E_{\\text{centroid}}$、$m_1$ 和 $m_{-1}$ 之间的关系。\n\n**1. 静态响应率与能量倒数加权求和规则 ($m_{-1}$)**\n\n线性响应理论提供了一个框架，用以将系统对微扰的响应与其内在的激发谱联系起来。能量加权求和规则是该谱的矩。对于算符 $F$ 的第 $k$ 阶矩 $m_k$ 定义为：\n$$ m_k = \\sum_{j \\neq 0} (E_j - E_0)^k |\\langle j | F | 0 \\rangle|^2 $$\n其中 $|0\\rangle$ 是能量为 $E_0$ 的基态，而 $|j\\rangle$ 是能量为 $E_j$ 的激发态。我们关心的是能量倒数加权求和规则 $m_{-1}$：\n$$ m_{-1} = \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_j - E_0} $$\n系统对形式为 $H' = H - \\lambda F$ 的静态微扰的响应由静态响应率 $\\chi(0)$ 来表征，其定义为 $F$ 的期望值对约束参数 $\\lambda$ 的一阶导数，在 $\\lambda=0$ 处取值：\n$$ \\chi(0) = \\left.\\frac{\\partial \\langle F \\rangle_\\lambda}{\\partial \\lambda}\\right|_{\\lambda=0} $$\n根据非含时微扰理论，由于微扰 $-\\lambda F$ 引起的基态波函数 $|0\\rangle$ 的一阶变化由下式给出：\n$$ |0\\rangle_\\lambda \\approx |0\\rangle + \\lambda \\sum_{j \\neq 0} \\frac{\\langle j | F | 0 \\rangle}{E_0 - E_j} |j\\rangle $$\n在微扰后的基态中，$F$ 的期望值（精确到 $\\lambda$ 的一阶）是：\n$$ \\langle F \\rangle_\\lambda = \\langle 0 |_\\lambda F | 0 \\rangle_\\lambda \\approx \\langle 0 | F | 0 \\rangle + 2\\lambda \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_0 - E_j} = \\langle F \\rangle_0 - 2\\lambda \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_j - E_0} $$\n对 $\\lambda$ 求导并在 $\\lambda=0$ 处取值：\n$$ \\chi(0) = \\left.\\frac{\\partial \\langle F \\rangle_\\lambda}{\\partial \\lambda}\\right|_{\\lambda=0} = -2 \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{-(E_j - E_0)} = 2 \\sum_{j \\neq 0} \\frac{|\\langle j | F | 0 \\rangle|^2}{E_j - E_0} $$\n将其与 $m_{-1}$ 的定义进行比较，我们得到基本关系：\n$$ \\chi(0) = 2 m_{-1} \\implies m_{-1} = \\frac{1}{2} \\chi(0) = \\frac{1}{2} \\left.\\frac{\\partial \\langle F \\rangle}{\\partial \\lambda}\\right|_{\\lambda=0} $$\n这提供了从计算出的静态响应率获得 $m_{-1}$ 的“比例因子” $1/2$。\n\n**2. 通过双对易子计算能量加权求和规则 ($m_1$)**\n\n问题要求使用双对易子恒等式 $m_1 = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle$ 来计算 $m_1 = \\sum_{j \\neq 0} (E_j - E_0) |\\langle j | F | 0 \\rangle|^2$。多体哈密顿量为 $H = \\sum_{i=1}^A H_i$，算符为 $F = \\sum_{i=1}^A x_i^2$，其中 $H_i = p_i^2/(2m) + \\frac{1}{2}m\\omega^2 x_i^2$。由于不同粒子的算符相互对易，对易子简化为单粒子对易子的和：$[H, F] = \\sum_i [H_i, x_i^2]$。\n\n第一个对易子，$[H_i, x_i^2]$：\n$$ [H_i, x_i^2] = \\left[\\frac{p_i^2}{2m} + \\frac{1}{2}m\\omega^2 x_i^2, x_i^2\\right] = \\frac{1}{2m} [p_i^2, x_i^2] $$\n使用 $[A,B^2] = [A,B]B+B[A,B]$ 和正则对易关系 $[x_i, p_i] = i\\hbar$：\n$$ [p_i, x_i^2] = [p_i, x_i]x_i + x_i[p_i, x_i] = (-i\\hbar)x_i + x_i(-i\\hbar) = -2i\\hbar x_i $$\n$$ [p_i^2, x_i^2] = [p_i, x_i^2]p_i + p_i[p_i, x_i^2] = (-2i\\hbar x_i)p_i + p_i(-2i\\hbar x_i) = -2i\\hbar(x_i p_i + p_i x_i) $$\n因此，$[H,F] = \\sum_i \\frac{1}{2m} (-2i\\hbar(x_i p_i + p_i x_i)) = -\\frac{i\\hbar}{m} \\sum_i (x_i p_i + p_i x_i)$。\n\n第二个对易子，$[F, [H, F]]$：\n$$ [F, [H, F]] = \\left[\\sum_j x_j^2, -\\frac{i\\hbar}{m} \\sum_i (x_i p_i + p_i x_i)\\right] = -\\frac{i\\hbar}{m}\\sum_i [x_i^2, x_i p_i + p_i x_i] $$\n我们计算 $[x_i^2, x_i p_i + p_i x_i] = x_i[x_i, x_i p_i + p_i x_i] + [x_i, x_i p_i + p_i x_i]x_i$。一个更直接的方法是使用 $[AB, C] = A[B,C] + [A,C]B$：\n$$ [x_i^2, p_i] = x_i[x_i, p_i] + [x_i, p_i]x_i = x_i(i\\hbar) + (i\\hbar)x_i = 2i\\hbar x_i $$\n$$ [x_i^2, x_i p_i + p_i x_i] = [x_i^2, x_i p_i] + [x_i^2, p_i x_i] = x_i[x_i^2, p_i] + [x_i^2, p_i]x_i = x_i(2i\\hbar x_i) + (2i\\hbar x_i)x_i = 4i\\hbar x_i^2 $$\n将其代回双对易子：\n$$ [F, [H, F]] = -\\frac{i\\hbar}{m} \\sum_i (4i\\hbar x_i^2) = \\frac{4\\hbar^2}{m} \\sum_i x_i^2 = \\frac{4\\hbar^2}{m} F $$\n最后，我们得到 $m_1$ 的表达式：\n$$ m_1 = \\frac{1}{2} \\langle 0 | [F, [H, F]] | 0 \\rangle = \\frac{1}{2} \\left\\langle 0 \\left| \\frac{4\\hbar^2}{m} F \\right| 0 \\right\\rangle = \\frac{2\\hbar^2}{m} \\langle 0 | F | 0 \\rangle $$\n其中 $\\langle 0 | F | 0 \\rangle$ 是算符 $F$ 的基态期望值。\n\n**3. 质心能量**\n\n集体激发的质心能量是一个依赖于模型的概念。对于一个强度分布呈尖峰或由单个集体态主导的情况，一个稳健的定义是 $E_{\\text{centroid}} = \\sqrt{m_1/m_{-1}}$。在谐振子模型中，算符 $F=\\sum x_i^2$ 只能激发比基态高 $2\\hbar\\omega$ 能量的态。这是因为 $x^2$ 包含能够将主量子数 $n$ 改变 $\\pm 2$ 的升降算符。因此，“单态主导”近似在这里是精确的。\n$$ \\frac{m_1}{m_{-1}} = \\frac{\\sum_{j \\neq 0} E_{j0} |\\langle j | F | 0 \\rangle|^2}{\\sum_{j \\neq 0} E_{j0}^{-1} |\\langle j | F | 0 \\rangle|^2} $$\n由于对于任何具有非零跃迁强度的态 $|j\\rangle$，都有 $E_{j0} = 2\\hbar\\omega$：\n$$ \\frac{m_1}{m_{-1}} = \\frac{2\\hbar\\omega \\sum_{j \\neq 0} |\\langle j | F | 0 \\rangle|^2}{(2\\hbar\\omega)^{-1} \\sum_{j \\neq 0} |\\langle j | F | 0 \\rangle|^2} = (2\\hbar\\omega)^2 $$\n因此，质心能量由下式给出：\n$$ E_{\\text{centroid}} = \\sqrt{\\frac{m_1}{m_{-1}}} = 2\\hbar\\omega $$\n这个推导证实了表达式 $E_{\\text{centroid}} = \\sqrt{m_1/m_{-1}}$ 对于此问题是正确的，因为它正确地得出了集体单极模的精确激发能量。\n\n### 第2部分：算法设计与实现\n\n计算任务是为给定的测试用例实现推导出的关系。数值量 $m$（质量）和 $\\hbar$（普朗克常数）分别以 $mc^2$ 和 $\\hbar c$ 的形式提供，这是核物理中的常见约定。公式必须相应地进行调整。\n- $\\langle n|x^2|n\\rangle = \\frac{\\hbar}{2m\\omega}(2n+1) = \\frac{(\\hbar c)^2}{2(mc^2)(\\hbar\\omega)}(2n+1)$.\n- $m_1 = \\frac{2\\hbar^2}{m}\\langle F\\rangle_0 = \\frac{2(\\hbar c)^2}{mc^2}\\langle F\\rangle_0$.\n- 受约束的频率 $\\omega_\\lambda = \\sqrt{\\omega^2 - 2\\lambda/m}$ 意味着 $(\\hbar\\omega_\\lambda)^2 = (\\hbar\\omega)^2 - 2\\lambda\\hbar^2/m = (\\hbar\\omega)^2 - 2\\lambda(\\hbar c)^2/(mc^2)$。\n\n算法流程如下：\n1.  **解析输入：** 对于每个测试用例，获取参数 $(mc^2, \\hbar c, \\hbar \\omega, A, g)$。\n2.  **确定占据数：** 通过根据泡利原理顺序填充能级，直到所有 $A$ 个粒子都被放置，同时考虑简并度 $g$，计算每个谐振子能级 $n=0, 1, 2, \\ldots$ 的占据数 $\\text{occ}(n)$。\n3.  **计算求和因子 $S$：** 计算依赖于结构的因子 $S = \\sum_n \\text{occ}(n)(2n+1)$。该因子出现在 $F$ 的所有期望值中。\n4.  **计算 $m_{-1}$：**\n    a.  计算有限差分步长 $\\delta=10^{-5}m\\omega^2 = 10^{-5}(mc^2)(\\hbar\\omega/\\hbar c)^2$。\n    b.  使用上述公式计算受微扰的振子能量 $\\hbar\\omega_{+\\delta}$ 和 $\\hbar\\omega_{-\\delta}$。\n    c.  使用 $\\langle F \\rangle_\\lambda = \\frac{(\\hbar c)^2 S}{2(mc^2)(\\hbar\\omega_\\lambda)}$ 计算受约束的期望值 $\\langle F \\rangle_{+\\delta}$ 和 $\\langle F \\rangle_{-\\delta}$。\n    d.  使用中心差分公式估计静态响应率：$\\chi(0) \\approx \\frac{\\langle F \\rangle_{+\\delta} - \\langle F \\rangle_{-\\delta}}{2\\delta}$。\n    e.  使用推导出的关系获得 $m_{-1}$：$m_{-1} = \\frac{1}{2}\\chi(0)$。\n5.  **计算 $m_1$：**\n    a.  首先，计算未微扰的基态期望值 $\\langle F \\rangle_0 = \\frac{(\\hbar c)^2 S}{2(mc^2)(\\hbar\\omega)}$。\n    b.  然后，使用推导出的双对易子结果：$m_1 = \\frac{2(\\hbar c)^2}{mc^2} \\langle F \\rangle_0$。\n6.  **计算质心能量：** 使用推导出的公式 $E_{\\text{centroid}} = \\sqrt{m_1/m_{-1}}$ 计算质心能量。由于使用小 $\\delta$ 的有限差分法具有高精度，结果应非常接近 $2\\hbar\\omega$。\n7.  **格式化输出：** 对于每个测试用例，收集 $m_{-1}$ 和 $E_{\\text{centroid}}$ 的值，将它们四舍五入到六位小数，并格式化为所需的最终字符串。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a given set of test cases.\n    \n    The function calculates the inverse-energy-weighted sum rule (m_{-1}) and\n    the centroid energy of the giant monopole resonance for a 1D harmonic oscillator\n    model of a nucleus.\n    \"\"\"\n\n    test_cases = [\n        # (m [MeV], hbarc [MeV*fm], hbar_omega [MeV], A, g)\n        (938.920, 197.3269804, 10.000, 8, 2),\n        (938.920, 197.3269804, 7.000, 3, 2),\n        (938.920, 197.3269804, 13.000, 1, 2),\n        (938.920, 197.3269804, 15.000, 20, 2),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m_en, h_c, e_osc, A, g = case\n        \n        # Step 1: Determine occupancies and compute the sum factor S.\n        s_factor = 0\n        particles_placed = 0\n        n = 0\n        while particles_placed  A:\n            occupancy = min(g, A - particles_placed)\n            if occupancy  0:\n                s_factor += occupancy * (2 * n + 1)\n                particles_placed += occupancy\n            n += 1\n            \n        # Step 2: Compute m_{-1} via static susceptibility using finite differences.\n        delta = 1e-5 * m_en * (e_osc / h_c)**2\n        \n        lambda_plus = delta\n        lambda_minus = -delta\n        \n        common_term_lambda = 2 * h_c**2 / m_en\n        \n        e_osc_lambda_plus_sq = e_osc**2 - common_term_lambda * lambda_plus\n        e_osc_lambda_minus_sq = e_osc**2 - common_term_lambda * lambda_minus\n        \n        e_osc_lambda_plus = np.sqrt(e_osc_lambda_plus_sq)\n        e_osc_lambda_minus = np.sqrt(e_osc_lambda_minus_sq)\n        \n        f_exp_common = (h_c**2 * s_factor) / (2 * m_en)\n        f_exp_plus = f_exp_common / e_osc_lambda_plus\n        f_exp_minus = f_exp_common / e_osc_lambda_minus\n        \n        chi_0 = (f_exp_plus - f_exp_minus) / (2 * delta)\n        \n        m_minus_1 = 0.5 * chi_0\n\n        # Step 3: Compute m_1 via double commutator\n        f_exp_0 = f_exp_common / e_osc\n        m_1 = (2 * h_c**2 / m_en) * f_exp_0\n        \n        # Step 4: Compute centroid energy\n        if m_minus_1  0:\n            e_centroid = np.sqrt(m_1 / m_minus_1)\n        else:\n            e_centroid = 0.0\n        \n        results.append(round(m_minus_1, 6))\n        results.append(round(e_centroid, 6))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3550607"}, {"introduction": "在核结构计算中，尤其是对于同位旋矢量巨偶极共振的计算，一个常见且关键的问题是结果会受到原子核整体质心运动的非物理性（或称“赝”）模式的污染。本练习将介绍两种在物理上合理且在实践中广泛使用的技术，来精确地移除这种赝模式污染，确保计算出的激发强度只对应于真实的内部激发 ([@problem_id:3550546])。掌握这项技能对于进行可靠的、与实验可比的核结构计算至关重要。", "problem": "考虑在随机相位近似（RPA）框架内有限原子核中的同位旋矢量电偶极集体振动（Random Phase Approximation (RPA)）。在一个平移不变的哈密顿量中，质心（CM）运动会以一个激发能任意接近于零的赝模形式出现。在实践中，除非进行修正，否则一个朴素的偶极算符会与此赝模耦合，从而污染计算出的强度。物理上正确的观测量必须排除任何质心贡献。\n\n将RPA问题建模为线性代数形式。假设存在一个维度为 $M$ 的单粒子-单空穴空间，该空间可分解为质子和中子部分。在 $\\mathbb{R}^M$ 中构造一组包含赝质心本征矢量 $v_s$ 的 $K$ 个正交归一的激发矢量 $\\{v_k\\}_{k=0}^{K-1}$。假设 $v_s$ 是归一化的均匀矢量 $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$，它代表所有核子的等量平移。定义朴素的同位旋矢量偶极算符为一个矢量 $d_{\\text{naive}}$，它对质子分量赋予 $+1$，对中子分量赋予 $-1$。对于一个算符 $d$，由模式 $v_k$ 携带的偶极强度是振幅的平方 $S_k(d) = |\\langle v_k, d \\rangle|^2 = |v_k^\\top d|^2$，总强度为 $S_{\\text{tot}}(d) = \\sum_{k=0}^{K-1} S_k(d)$。\n\n存在两种科学上合理的方法可以从同位旋矢量偶极强度中移除赝质心污染：\n\n- 强制正交性：通过将算符投影到与 $v_s$ 正交的子空间上来修改算符，即 $d_{\\perp} = d_{\\text{naive}} - (v_s^\\top d_{\\text{naive}}) v_s$，从而使得 $v_s^\\top d_{\\perp} = 0$。\n- 平移不变算符：使用平移不变的同位旋矢量偶极算符 $d_{\\text{TI}}$，其单粒子形式会减去质心坐标。在质子-中子分解中，这会产生质子的有效电荷 $e_p = \\frac{N}{A}$ 和中子的有效电荷 $e_n = -\\frac{Z}{A}$，其中 $Z$ 是质子数，$N$ 是中子数，$A = Z + N$ 是质量数。在此模型中，$d_{\\text{TI}}$ 对质子分量赋予 $+\\frac{N}{A}$，对中子分量赋予 $-\\frac{Z}{A}$，从而确保 $v_s^\\top d_{\\text{TI}} = 0$。\n\n你的任务是设计并实现一个计算程序，对于给定的原子核 $(Z,N)$，该程序需要构造包含赝质心矢量 $v_s$ 的 $K$ 个正交归一的激发矢量，计算三种算符 $d_{\\text{naive}}$、$d_{\\perp}$ 和 $d_{\\text{TI}}$ 的偶极强度，并以下列分数形式量化残余的赝污染：\n$$\nf_{\\text{spur}}(d) = \\frac{S_s(d)}{S_{\\text{tot}}(d)},\n$$\n其中 $S_s(d) = S_{k=s}(d)$ 是由赝质心模式携带的强度。最终的数值输出必须是无量纲的浮点数和布尔值。\n\n在程序中实现以下精确、可复现的步骤：\n\n1. 构造赝质心矢量 $v_s \\in \\mathbb{R}^{M}$ 为归一化的均匀矢量 $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$。\n2. 从标准正态分布中生成 $\\mathbb{R}^{M}$ 内的 $K-1$ 个随机矢量，然后通过减去其在 $v_s$ 上的投影，使每个矢量与 $v_s$ 正交，并执行瘦 $\\mathsf{QR}$ 分解以获得一个张成与 $v_s$ 正交子空间的正交归一集 $\\{q_j\\}_{j=0}^{K-2}$。\n3. 通过取 $v_0 = v_s$ 以及对于 $k = 1,\\dots,K-1$ 取 $v_{k} = q_{k-1}$ 来构成激发集 $\\{v_k\\}$。\n4. 定义 $d_{\\text{naive}} \\in \\mathbb{R}^{M}$，将其前 $Z$ 个分量（质子）赋值为 $+1$，其余 $N$ 个分量（中子）赋值为 $-1$。\n5. 定义 $d_{\\perp} = d_{\\text{naive}} - (v_s^\\top d_{\\text{naive}}) v_s$。\n6. 定义 $d_{\\text{TI}}$，将其前 $Z$ 个分量赋值为 $+\\frac{N}{A}$，其余 $N$ 个分量赋值为 $-\\frac{Z}{A}$。\n7. 对于每个算符 $d \\in \\{d_{\\text{naive}}, d_{\\perp}, d_{\\text{TI}}\\}$，计算强度 $S_k(d) = |v_k^\\top d|^2$（其中 $k=0,\\dots,K-1$）、总强度 $S_{\\text{tot}}(d)$ 和赝模分数 $f_{\\text{spur}}(d)$。\n8. 定义容差 $\\varepsilon = 10^{-12}$ 和布尔值 $b_{\\perp} = (f_{\\text{spur}}(d_{\\perp})  \\varepsilon)$ 及 $b_{\\text{TI}} = (f_{\\text{spur}}(d_{\\text{TI}})  \\varepsilon)$。\n\n测试套件。使用以下三组必须在程序中硬编码的参数集：\n\n- 情况 1：$Z=82$, $N=126$, $A=208$, $K=21$, seed $= 12345$。\n- 情况 2：$Z=20$, $N=20$, $A=40$, $K=15$, seed $= 54321$。\n- 情况 3：$Z=8$, $N=40$, $A=48$, $K=18$, seed $= 2023$。\n\n对于每种情况，程序必须计算并返回一个包含五个条目的列表，其确切顺序为 $[f_{\\text{spur}}(d_{\\text{naive}}), f_{\\text{spur}}(d_{\\perp}), f_{\\text{spur}}(d_{\\text{TI}}), b_{\\perp}, b_{\\text{TI}}]$。\n\n最终输出格式。你的程序应生成单行输出，其中包含一个由方括号括起来的、包含三个情况结果的逗号分隔列表，每个情况的结果本身也是一个由方括号括起来的逗号分隔列表。例如，输出必须类似于 $[[x_1,x_2,x_3,x_4,x_5],[y_1,y_2,y_3,y_4,y_5],[z_1,z_2,z_3,z_4,z_5]]$，并插入数值和布尔值。不需要物理单位，因为所有返回值都是无量纲的。不使用角度。", "solution": "同位旋矢量电偶极振动反映了质子-中子的集体反相运动。平移不变的哈密顿量拥有一个与质心（CM）平移相关的、由对称性产生的赝态。在随机相位近似（RPA）中，此赝态表现为一个能量接近于零的本征矢量，并与平移生成元成正比。当使用一个朴素的偶极算符 $\\hat{D} = \\sum_{i \\in p} z_i - \\sum_{j \\in n} z_j$ 而不减去质心运动时，该算符会与赝模耦合，在零能量处产生人为的强度。纠正方法是强制实现平移不变性，可以通过从算符中显式地投影掉质心分量，或者使用一个能赋予有效电荷以确保无质心耦合的平移不变算符。\n\n原理。根本基础是哈密顿量的平移不变性以及 RPA 模式的线性响应构建。质心赝本征矢量是所有坐标的均匀平移。在离散化的单粒子-单空穴基中，我们将此赝本征矢量建模为 $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$。算符 $d$ 与归一化模式 $v_k$ 的耦合振幅是 $a_k(d) = v_k^\\top d$，偶极强度是 $S_k(d) = |a_k(d)|^2$。因为强度是算符的二次方，投影算符以消除其沿 $v_s$ 的分量会消除与赝模的任何耦合，而不会改变正交子空间内的物理耦合。另外，同位旋矢量偶极算符的平移不变性会产生众所周知的有效电荷 $e_p = \\frac{N}{A}$ 和 $e_n = -\\frac{Z}{A}$，对应于\n$$\n\\hat{D}_{\\text{TI}} = \\sum_{i \\in p} e_p (z_i - Z_{\\text{CM}}) + \\sum_{j \\in n} e_n (z_j - Z_{\\text{CM}}), \\quad Z_{\\text{CM}} = \\frac{1}{A} \\sum_{k=1}^{A} z_k,\n$$\n这以矢量形式为质子分量赋予 $+\\frac{N}{A}$ 的权重，为中子分量赋予 $-\\frac{Z}{A}$ 的权重。这种构造确保了 $v_s^\\top d_{\\text{TI}} = 0$，因为权重之和为零：$Z \\cdot \\frac{N}{A} + N \\cdot \\left(-\\frac{Z}{A}\\right) = 0$。\n\n算法设计。\n\n1. 构造 $v_s \\in \\mathbb{R}^{M}$ 为 $v_s = \\frac{1}{\\sqrt{M}}(1,1,\\dots,1)^\\top$，保证 $\\|v_s\\|_2 = 1$。\n2. 从标准正态分布中采样生成 $K-1$ 个随机列矢量 $w_j \\in \\mathbb{R}^{M}$。通过对所有 $j$ 设置 $\\tilde{w}_j = w_j - (v_s^\\top w_j) v_s$ 来强制与 $v_s$ 正交。这确保了 $v_s^\\top \\tilde{w}_j = 0$。\n3. 计算 $M \\times (K-1)$ 矩阵 $\\tilde{W} = [\\tilde{w}_0,\\dots,\\tilde{w}_{K-2}]$ 的瘦 $\\mathsf{QR}$ 分解，得到 $\\tilde{W} = Q R$ 且 $Q^\\top Q = I_{K-1}$。取 $Q$ 的列作为张成与 $v_s$ 正交子空间的正交归一集 $\\{q_j\\}_{j=0}^{K-2}$。\n4. 定义激发矢量 $v_0 = v_s$ 和 $v_k = q_{k-1}$（其中 $k=1,\\dots,K-1$）。集合 $\\{v_k\\}_{k=0}^{K-1}$ 根据构造是正交归一的。\n5. 定义朴素算符 $d_{\\text{naive}}$ 为一个 $M$ 维矢量，其前 $Z$ 个条目（质子）为 $+1$，其余 $N$ 个条目（中子）为 $-1$。如果 $Z \\neq N$，该算符通常与 $v_s$ 有非零重叠，因为 $v_s^\\top d_{\\text{naive}} \\propto \\sum_i d_{\\text{naive},i} = Z - N$。\n6. 将朴素算符投影到与 $v_s$ 正交的方向：$d_{\\perp} = d_{\\text{naive}} - (v_s^\\top d_{\\text{naive}}) v_s$。这保证了 $v_s^\\top d_{\\perp} = 0$，因此 $S_s(d_{\\perp}) = |v_s^\\top d_{\\perp}|^2 = 0$（在数值精度范围内）。\n7. 通过将其条目对质子分量设置为 $+\\frac{N}{A}$、对中子分量设置为 $-\\frac{Z}{A}$ 来构造平移不变算符 $d_{\\text{TI}}$。分量之和为零，因此 $v_s^\\top d_{\\text{TI}} = 0$ 且 $S_s(d_{\\text{TI}}) = 0$（在数值精度范围内）。\n8. 对于每个算符 $d \\in \\{d_{\\text{naive}}, d_{\\perp}, d_{\\text{TI}}\\}$，计算 $S_k(d) = |v_k^\\top d|^2$（其中 $k=0,\\dots,K-1$）和 $S_{\\text{tot}}(d) = \\sum_{k=0}^{K-1} S_k(d)$。将赝污染量化为\n$$\nf_{\\text{spur}}(d) = \\frac{S_s(d)}{S_{\\text{tot}}(d)}.\n$$\n因为 $d_{\\perp}$ 和 $d_{\\text{TI}}$ 与 $v_s$ 正交，所以 $f_{\\text{spur}}(d_{\\perp})$ 和 $f_{\\text{spur}}(d_{\\text{TI}})$ 在数值上应该非常小，理想情况下接近于 $0$。\n9. 定义一个数值容差 $\\varepsilon = 10^{-12}$ 并报告布尔值 $b_{\\perp} = (f_{\\text{spur}}(d_{\\perp})  \\varepsilon)$ 和 $b_{\\text{TI}} = (f_{\\text{spur}}(d_{\\text{TI}})  \\varepsilon)$，以表明成功移除了赝强度。\n\n测试套件原理说明。\n\n- 情况 1（$Z=82$, $N=126$, $A=208$）：一个代表重核体系（如铅）的非对称核，其中 $v_s^\\top d_{\\text{naive}} \\neq 0$；预计 $d_{\\text{naive}}$ 会有显著的赝污染。两种修正都应能抑制它。\n- 情况 2（$Z=20$, $N=20$, $A=40$）：一个对称核，其中 $Z = N$ 意味着 $\\sum_i d_{\\text{naive},i} = 0$，因此 $v_s^\\top d_{\\text{naive}} = 0$；朴素算符已经具有可忽略的赝污染，这提供了一个边界检查。\n- 情况 3（$Z=8$, $N=40$, $A=48$）：一个高度非对称的轻核体系，其中朴素污染很强；两种修正都应能移除它。\n\n实现说明。\n\n- 通过 $\\mathsf{QR}$ 进行的正交归一化确保了数值稳定性和在浮点运算中得到一个精确的正交归一集。\n- 根据构造，强度 $S_k(d)$ 是非负的。分数 $f_{\\text{spur}}(d)$ 是无量纲的，且位于 $[0,1]$ 区间内。\n- 由于将 $d$ 乘以一个常数会使 $S_s(d)$ 和 $S_{\\text{tot}}(d)$ 都乘以相同的因子，因此 $f_{\\text{spur}}(d)$ 在 $d$ 的均匀缩放下是不变的。\n\n最终程序必须硬编码这三种情况，并生成形式为 $[[f_{\\text{naive}},f_{\\perp},f_{\\text{TI}},b_{\\perp},b_{\\text{TI}}]_{\\text{情况 1}},[f_{\\text{naive}},f_{\\perp},f_{\\text{TI}},b_{\\perp},b_{\\text{TI}}]_{\\text{情况 2}},[f_{\\text{naive}},f_{\\perp},f_{\\text{TI}},b_{\\perp},b_{\\text{TI}}]_{\\text{情况 3}}]$ 的单行输出，包含数值和布尔值。不需要物理单位，因为所有返回值都是无量纲的。", "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\ndef build_spurious_vector(M: int) - np.ndarray:\n    \"\"\"Return normalized uniform spurious CM vector of length M.\"\"\"\n    v = np.ones(M, dtype=float)\n    return v / np.linalg.norm(v)\n\ndef orthonormal_modes(M: int, K: int, seed: int) - np.ndarray:\n    \"\"\"\n    Construct K orthonormal excitation vectors in R^M that include the spurious CM vector.\n    v0 is the spurious vector; the remaining K-1 vectors are orthonormal and orthogonal to it.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    v_s = build_spurious_vector(M)\n    # Generate K-1 random vectors\n    W = rng.normal(size=(M, K-1))\n    # Orthogonalize each to v_s\n    proj_coeffs = v_s @ W  # shape (K-1,)\n    W_tilde = W - np.outer(v_s, proj_coeffs)\n    # QR decomposition to obtain orthonormal columns\n    Q, _ = np.linalg.qr(W_tilde, mode='reduced')  # Q is M x (K-1)\n    # Compose modes: first column is v_s, then Q's columns\n    V = np.empty((M, K), dtype=float)\n    V[:, 0] = v_s\n    V[:, 1:] = Q\n    # Sanity: ensure orthonormality\n    # V^T V should be identity; minor numerical deviations are acceptable\n    return V\n\ndef build_naive_operator(Z: int, N: int) - np.ndarray:\n    \"\"\"Naive isovector dipole operator: +1 for protons, -1 for neutrons.\"\"\"\n    A = Z + N\n    d = np.empty(A, dtype=float)\n    d[:Z] = 1.0\n    d[Z:] = -1.0\n    return d\n\ndef build_ti_operator(Z: int, N: int) - np.ndarray:\n    \"\"\"Translationally invariant isovector dipole operator with effective charges.\"\"\"\n    A = Z + N\n    d = np.empty(A, dtype=float)\n    d[:Z] = N / A\n    d[Z:] = -Z / A\n    return d\n\ndef project_operator(d: np.ndarray, v_s: np.ndarray) - np.ndarray:\n    \"\"\"Project operator d onto subspace orthogonal to v_s.\"\"\"\n    coeff = float(v_s @ d)\n    return d - coeff * v_s\n\ndef strengths(V: np.ndarray, d: np.ndarray) - np.ndarray:\n    \"\"\"Compute strengths S_k(d) = |v_k^T d|^2 for all modes.\"\"\"\n    amps = V.T @ d  # shape (K,)\n    return np.square(np.abs(amps))\n\ndef spurious_fraction(V: np.ndarray, d: np.ndarray, spur_index: int = 0) - float:\n    \"\"\"Compute spurious fraction f_spur(d) = S_spur / S_tot.\"\"\"\n    S = strengths(V, d)\n    S_tot = float(np.sum(S))\n    S_spur = float(S[spur_index])\n    # Guard against round-off leading to zero total strength\n    if S_tot == 0.0:\n        return 0.0\n    return S_spur / S_tot\n\ndef case_result(Z: int, N: int, K: int, seed: int, tol: float = 1e-12):\n    \"\"\"Compute [f_naive, f_proj, f_ti, b_proj, b_ti] for one test case.\"\"\"\n    A = Z + N\n    V = orthonormal_modes(A, K, seed)\n    v_s = V[:, 0]\n    d_naive = build_naive_operator(Z, N)\n    d_proj = project_operator(d_naive, v_s)\n    d_ti = build_ti_operator(Z, N)\n\n    f_naive = spurious_fraction(V, d_naive, spur_index=0)\n    f_proj = spurious_fraction(V, d_proj, spur_index=0)\n    f_ti = spurious_fraction(V, d_ti, spur_index=0)\n\n    b_proj = f_proj  tol\n    b_ti = f_ti  tol\n    return [f_naive, f_proj, f_ti, b_proj, b_ti]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Z, N, K, seed)\n        (82, 126, 21, 12345),  # Case 1: A=208\n        (20, 20, 15, 54321),   # Case 2: A=40, symmetric\n        (8, 40, 18, 2023),     # Case 3: A=48, asymmetric\n    ]\n\n    results = []\n    for Z, N, K, seed in test_cases:\n        results.append(case_result(Z, N, K, seed, tol=1e-12))\n\n    # Final print statement in the exact required format.\n    # Booleans and floats will be printed as Python literals; this matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3550546"}]}