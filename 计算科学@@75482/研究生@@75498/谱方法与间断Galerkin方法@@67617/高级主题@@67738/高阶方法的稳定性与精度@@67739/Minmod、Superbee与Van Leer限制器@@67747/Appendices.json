{"hands_on_practices": [{"introduction": "通量限制器函数 $\\phi(r)$ 是分析和分类TVD（总变差递减）格式行为的强大工具。通过对解的连续梯度之比 $r$ 进行操作，$\\phi(r)$ 决定了格式在局部是倾向于耗散（平滑数值解）还是压缩（锐化数值解）。本练习 [@problem_id:3399885] 将通过计算著名的 van Leer 限制器在几个关键 $r$ 值下的 $\\phi(r)$ 值，帮助你深入理解其自适应行为的内在机制。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速为常数 $a>0$。该方程在均匀网格上使用一阶间断伽辽金(DG)方法进行离散。为抑制非物理振荡同时保持陡峭梯度，对每个单元中重构的线性解应用一个总变差递减(TVD)斜率限制器。设斜率更新由一个通量限制器函数 $\\phi(r)$ 定义，该函数作用于单元线性重构的连续差分之比 $r$，其中 $r$ 由 $r = \\Delta u_{i-1/2} / \\Delta u_{i+1/2}$ 给出，$\\Delta u_{i\\pm 1/2}$ 表示考虑了迎风方向的一致性界面差分。假设所用限制器是高分辨率有限体积和DG方法中标准的 van Leer TVD 限制器，并且 $r$ 是从三个不同的局部邻域数据计算得到的，分别为 $r=0.5$，$r=1$ 和 $r=2$。\n\n从通量限制器的TVD框架出发，不假设任何现成的简化公式，计算 van Leer 限制器 $\\phi_{\\mathrm{VL}}(r)$ 在 $r=0.5$、$r=1$ 和 $r=2$ 处的值。然后，深入解读这些值如何反映DG重构中扩散行为（平滑小梯度）和压缩行为（保持或锐化大梯度）之间的转换，并与 minmod 和 superbee 限制器的行为进行比较。\n\n将您的最终答案表示为一个行矩阵，按顺序包含 $\\phi_{\\mathrm{VL}}(0.5)$、$\\phi_{\\mathrm{VL}}(1)$ 和 $\\phi_{\\mathrm{VL}}(2)$ 这三个值。无需四舍五入，不涉及单位。", "solution": "用户想要解决一个关于间断伽辽金(DG)方法中斜率限制器的问题。\n\n**1. 问题验证**\n\n首先，我将验证所提供的问题陈述。\n\n**步骤1：提取已知条件**\n\n*   **控制方程：** 一维线性平流方程，$u_{t} + a\\,u_{x} = 0$，常数波速 $a>0$。\n*   **数值方法：** 在均匀网格上使用一阶间断伽辽金(DG)方法，并对“每个单元中重构的线性解”应用一个总变差递减(TVD)斜率限制器。这暗示了使用分片线性多项式($P^1$)，构成一个二阶格式。\n*   **限制器函数：** 斜率更新由一个通量限制器函数 $\\phi(r)$ 定义。\n*   **光滑度比率：** 该比率由 $r = \\Delta u_{i-1/2} / \\Delta u_{i+1/2}$ 给出，其中 $\\Delta u_{i\\pm 1/2}$ 是“考虑了迎风方向的一致性界面差分”。\n*   **特定限制器：** van Leer TVD 限制器，记为 $\\phi_{\\mathrm{VL}}(r)$。\n*   **输入数据：** 比率 $r$ 取三个值：$r=0.5$、$r=1$ 和 $r=2$。\n*   **任务：**\n    1.  针对给定的 $r$ 值，计算 van Leer 限制器 $\\phi_{\\mathrm{VL}}(r)$ 的值。计算应从TVD框架出发。\n    2.  在扩散行为与压缩行为的背景下，并与 minmod 和 superbee 限制器进行比较，解读这些值。\n*   **输出格式：** 一个包含 $\\phi_{\\mathrm{VL}}(0.5)$、$\\phi_{\\mathrm{VL}}(1)$ 和 $\\phi_{\\mathrm{VL}}(2)$ 这三个计算值的行矩阵。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题在双曲型偏微分方程的数值分析领域中是根深蒂固的。线性平流方程、间断伽辽金方法、TVD性质以及斜率/通量限制器（van Leer、minmod、superbee）都是高分辨率格式中的标准和基本概念。\n*   **适定性：** 该问题是适定的。van Leer 限制器是一个唯一定义的数学函数。任务是在特定点上评估此函数，并根据已建立的理论提供标准解释。存在一个唯一且有意义的解。\n*   **客观性：** 该问题以精确、客观、技术性的语言陈述，没有任何主观或偏颇的措辞。\n\n该问题没有表现出任何无效性缺陷：\n1.  它在科学上和事实上是合理的。\n2.  它与指定主题直接相关且可形式化。\n3.  设定是完整的。尽管没有给出 $\\phi_{\\mathrm{VL}}(r)$ 的显式公式，但问题指导求解者从TVD框架出发，这意味着该公式需要根据其性质来回忆或证明，这对于此级别的分析是标准做法。短语“一阶间断伽辽金(DG)方法”与“重构的线性解”相结合是一种常见（尽管略有不精确）的指代DG($P^1$)格式的方式，这在内部是一致的。\n4.  条件并非不切实际或不可行。\n5.  该问题不是不适定的。\n6.  该问题并非微不足道；它要求对守恒律数值格式理论有扎实的理解。\n7.  结果是数学上可验证的。\n\n**步骤3：结论与行动**\n\n该问题是**有效的**。我将继续进行解答。\n\n**2. 求解推导**\n\n该问题探讨了在高阶数值方法中应用斜率限制器来求解线性平流方程 $u_t + a u_x = 0$。这类限制器的目标是确保格式是总变差递减(TVD)的，即它不会引入新的伪振荡，同时在解的光滑区域保持高阶精度。\n\n在使用分片线性重构的DG或有限体积方法的背景下，计算单元 $I_i = [x_{i-1/2}, x_{i+1/2}]$ 中的解由其单元平均值 $\\bar{u}_i$ 和一个斜率表示。该格式能达到二阶精度，但在陡峭梯度附近会产生过冲和下冲。为防止这种情况，初始计算的斜率会被修正或“限制”。\n\n这个限制过程通常可以方便地用通量限制器函数 $\\phi(r)$ 来表示。函数 $\\phi$ 根据解的局部光滑度来调节高阶项的贡献，该光滑度由连续解梯度的比率 $r_i$ 来衡量。对于均匀网格和 $a>0$（迎风方向从左到右），该比率通常使用单元平均值定义如下：\n$$r_i = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{\\bar{u}_{i+1} - \\bar{u}_i}$$\n为使格式满足TVD性质，对于 $r>0$，限制器函数 $\\phi(r)$ 必须满足某些条件。这些条件定义了由 Sweby 首次描述的 $(\\phi, r)$ 平面中的“TVD区域”：\n$$0 \\le \\phi(r) \\le 2$$\n$$0 \\le \\frac{\\phi(r)}{r} \\le 2 \\quad \\implies \\quad \\phi(r) \\le 2r$$\n为了防止产生新的局部极值，还要求当 $r \\le 0$ 时 $\\phi(r) = 0$。\n\nvan Leer 限制器 $\\phi_{\\mathrm{VL}}(r)$ 是 $\\phi(r)$ 的一个经典选择，它提供了平滑的过渡，并在精度和鲁棒性之间取得了平衡。它的定义是推导出来的一个位于TVD区域内的对称光滑函数。van Leer 限制器的标准解析形式为：\n$$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1+|r|}$$\n对于问题中指定的情况，$r > 0$，所以 $|r|=r$。公式简化为：\n$$\\phi_{\\mathrm{VL}}(r) = \\frac{r + r}{1+r} = \\frac{2r}{1+r} \\quad \\text{for } r > 0$$\n该函数对 $r>0$ 满足TVD条件：\n1.  $r>0 \\implies 2r > 0$ 且 $1+r > 1$，所以 $\\phi_{\\mathrm{VL}}(r) > 0$。同时，$2r \\le 2(1+r) \\implies \\frac{2r}{1+r} \\le 2$。因此，$0 \\le \\phi_{\\mathrm{VL}}(r) \\le 2$。\n2.  $\\frac{\\phi_{\\mathrm{VL}}(r)}{r} = \\frac{2}{1+r}$。对于 $r>0$，我们有 $1+r > 1$，这意味着 $0  \\frac{2}{1+r}  2$。因此，$0 \\le \\frac{\\phi_{\\mathrm{VL}}(r)}{r} \\le 2$。\n\n现在，我们计算给定输入值下的 $\\phi_{\\mathrm{VL}}(r)$。\n\n对于 $r=0.5$：\n$$\\phi_{\\mathrm{VL}}(0.5) = \\frac{2 \\times 0.5}{1 + 0.5} = \\frac{1}{1.5} = \\frac{1}{3/2} = \\frac{2}{3}$$\n\n对于 $r=1$：\n$$\\phi_{\\mathrm{VL}}(1) = \\frac{2 \\times 1}{1 + 1} = \\frac{2}{2} = 1$$\n\n对于 $r=2$：\n$$\\phi_{\\mathrm{VL}}(2) = \\frac{2 \\times 2}{1 + 2} = \\frac{4}{3}$$\n\n**3. 解读与比较**\n\n$\\phi(r)$ 的值决定了数值格式在局部层面的特性。\n-   $\\phi(r)=0$ 将格式降为一阶（例如，迎风格式），这是高度耗散的。\n-   $\\phi(r)=1$ 对应于“线性”或无限制的二阶格式（例如，Lax-Wendroff 类型），在光滑区域能保持精度。\n-   $0  \\phi(r)  1$ 表明该格式比基准的二阶格式更具耗散性。\n-   $\\phi(r) > 1$ 意味着“压缩性”或“反耗散”行为，此时限制器试图使梯度变陡，这对于解析像接触间断这样的陡峭特征是理想的。\n\n让我们将计算出的值与另外两个著名的限制器进行比较分析：高耗散的 `minmod` 限制器和高压缩性的 `superbee` 限制器。\n-   **Minmod:** $\\phi_{\\mathrm{min}}(r) = \\max(0, \\min(1, r))$\n-   **Superbee:** $\\phi_{\\mathrm{sup}}(r) = \\max(0, \\min(2r, 1), \\min(r, 2))$\n\n**情况1：$r=0.5$**\n这个比率值表明上游梯度 $(\\bar{u}_i - \\bar{u}_{i-1})$ 的大小是下游梯度 $(\\bar{u}_{i+1} - \\bar{u}_i)$ 的一半。这种情况通常出现在光滑极值附近或波形展宽的地方。\n-   $\\phi_{\\mathrm{VL}}(0.5) = 2/3 \\approx 0.67$。这个值小于1，表明具有耗散行为。限制器减小斜率以防止过冲，但不如 `minmod` 那样激进。\n-   作为比较：$\\phi_{\\mathrm{min}}(0.5) = 0.5$（更具耗散性），而 $\\phi_{\\mathrm{sup}}(0.5) = \\max(0, \\min(1,1), \\min(0.5,2)) = 1$（相对于二阶格式没有增加耗散）。\n-   van Leer 限制器找到了一个折中方案，比 `minmod` 更平缓地光滑廓线。\n\n**情况2：$r=1$**\n这对应于一个常数梯度区域，即一个完全光滑的线性廓线。\n-   $\\phi_{\\mathrm{VL}}(1) = 1$。限制器不对斜率做任何修改。\n-   这是任何二阶TVD格式的一个关键属性：在完全线性的廓线上，格式必须是二阶精确的。`minmod` ($\\phi_{\\mathrm{min}}(1)=1$) 和 `superbee` ($\\phi_{\\mathrm{sup}}(1)=1$) 在 $r=1$ 时也得到1。\n\n**情况3：$r=2$**\n这个比率表明梯度在流动方向上正在变陡，这是激波或陡峭波前脚点区域的特征。\n-   $\\phi_{\\mathrm{VL}}(2) = 4/3 \\approx 1.33$。这个值大于1，展示了 van Leer 限制器的**压缩**性质。它主动地使波前变陡以抵消数值耗散，从而为间断提供更锐利的廓线。\n-   作为比较：$\\phi_{\\mathrm{min}}(2) = \\min(1, 2) = 1$（非压缩性的，在二阶贡献处进行剪切），而 $\\phi_{\\mathrm{sup}}(2) = \\max(0, \\min(4,1), \\min(2,2)) = 2$（最大压缩性的，位于TVD区域的上边界）。\n-   在这里，van Leer 限制器在保持锐度方面比 `minmod` 更激进，但不如 `superbee`，后者有时会导致廓线过于陡峭，呈现“箱形”。\n\n总而言之，这三个计算值说明了 van Leer 限制器如何巧妙地从耗散特性（$\\phi1$）过渡到压缩特性（$\\phi>1$），同时在光滑的线性区域保持二阶精度（$\\phi=1$）。这种平衡的方法是它成为一个被广泛使用且有效的限制器的原因。\n\n要求的最终答案是 $\\phi_{\\mathrm{VL}}(r)$ 的计算值集合。\n$\\phi_{\\mathrm{VL}}(0.5) = 2/3$\n$\\phi_{\\mathrm{VL}}(1) = 1$\n$\\phi_{\\mathrm{VL}}(2) = 4/3$\n\n这些值将以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3}  1  \\frac{4}{3}\n\\end{pmatrix}\n}\n$$", "id": "3399885"}, {"introduction": "虽然斜率限制器通常与一阶矩（即分片线性基的斜率）相关联，但在更高阶的间断伽辽金（DG）方法中，我们必须同样控制更高阶的矩以抑制伪振荡。本练习 [@problem_id:3399846] 将挑战你将 `minmod` 限制器的思想推广应用到二阶矩（即多项式解的曲率）上。通过这个过程，你将掌握如何将限制器原理扩展到更高阶的DG格式中，这是现代高精度数值方法的一个核心议题。", "problem": "考虑在一个单元尺寸为 $h = 1$ 的均匀网格上，对一个光滑标量场进行的一维间断 Galerkin (DG) 近似。在一个索引为 $i$ 的给定单元上，映射到参考坐标 $\\xi \\in [-1,1]$ 后的近似解，在使用 Legendre 多项式的分层模态基中表示为：\n$$\nu_i(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2 L_2(\\xi),\n$$\n其中 $L_0(\\xi) = 1$，$L_1(\\xi) = \\xi$，以及 $L_2(\\xi) = \\frac{3\\xi^2 - 1}{2}$。给定的模态系数为 $\\bar{u}_i = 1.2$，$a_1 = 0.3$，以及 $a_2 = -0.05$。相邻单元的平均值为 $\\bar{u}_{i-1} = 0.9$ 和 $\\bar{u}_{i+1} = 1.35$。\n\n您将仅对二阶模态 $a_2$ 应用一个基于 minmod 的限制器，该限制器使用由相邻单元平均值构造的曲率代理。具体来说：\n\n1. 从 minmod 函数对两个参数 $a$ 和 $b$ 的定义开始，\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),   \\text{if } ab  0,\\\\\n0,   \\text{otherwise},\n\\end{cases}\n$$\n以及物理坐标与参考坐标之间的仿射映射 $x = x_i + \\frac{h}{2}\\,\\xi$。\n\n2. 仅使用所选基的第一性原理，推导将二阶模态系数 $a_2$ 与单元上的物理二阶导数 $u_{xx}$ 相关联的比例常数 $\\kappa$，然后将 $a_2$ 与相邻单元平均值的离散二阶差分相关联\n$$\n\\Delta^2 \\bar{u}_i = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}.\n$$\n将此关系表示为 $a_2 \\approx \\kappa\\,\\Delta^2 \\bar{u}_i$ 的形式，并解析地确定 $\\kappa$。\n\n3. 计算受限的二阶模态系数\n$$\na_2^{\\mathrm{lim}} = \\operatorname{minmod}\\!\\big(a_2,\\;\\kappa\\,\\Delta^2 \\bar{u}_i\\big),\n$$\n并构建受限多项式\n$$\nu_i^{\\mathrm{lim}}(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2^{\\mathrm{lim}} L_2(\\xi).\n$$\n\n4. 在多项式次数为 $p=2$ 的 Gauss–Lobatto 点，即 $\\xi = -1$，$\\xi = 0$ 和 $\\xi = 1$ 处，计算 $u_i^{\\mathrm{lim}}(\\xi)$ 的值，并将这三个值以单个行矩阵的形式报告。\n\n以包含受限多项式在 Gauss–Lobatto 点的三个值的行矩阵形式提供您的最终答案。不要包含单位。如果您选择表达任何中间数值，请使用精确小数；无需四舍五入。", "solution": "首先通过提取所有给定信息并评估其科学合理性和形式结构来验证问题。\n\n### 步骤 1：提取给定信息\n- **方法：** 一维间断 Galerkin (DG) 近似。\n- **网格：** 均匀网格，单元尺寸 $h = 1$。\n- **单元：** 索引为 $i$。\n- **参考坐标：** $\\xi \\in [-1,1]$。\n- **基：** 使用 Legendre 多项式的分层模态基。\n- **解的表示：** $u_i(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2 L_2(\\xi)$。\n- **Legendre 多项式：** $L_0(\\xi) = 1$，$L_1(\\xi) = \\xi$，以及 $L_2(\\xi) = \\frac{3\\xi^2 - 1}{2}$。\n- **模态系数：** $\\bar{u}_i = 1.2$，$a_1 = 0.3$，$a_2 = -0.05$。\n- **相邻单元平均值：** $\\bar{u}_{i-1} = 0.9$，$\\bar{u}_{i+1} = 1.35$。\n- **Minmod 函数：** $\\operatorname{minmod}(a,b) = \\begin{cases} \\operatorname{sign}(a)\\,\\min(|a|,|b|),   \\text{if } ab  0,\\\\ 0,   \\text{otherwise}. \\end{cases}$\n- **坐标映射：** $x = x_i + \\frac{h}{2}\\,\\xi$，其中 $x_i$ 是单元 $i$ 的中心。\n- **离散二阶差分：** $\\Delta^2 \\bar{u}_i = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}$。\n- **限制器定义：** $a_2^{\\mathrm{lim}} = \\operatorname{minmod}\\!\\big(a_2,\\;\\kappa\\,\\Delta^2 \\bar{u}_i\\big)$。\n- **受限多项式：** $u_i^{\\mathrm{lim}}(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2^{\\mathrm{lim}} L_2(\\xi)$。\n- **求值点：** 多项式次数 $p=2$ 的 Gauss-Lobatto 点，即 $\\xi = -1, 0, 1$。\n\n### 步骤 2：使用提取的给定信息进行验证\n- **科学依据：** 该问题牢固地建立在偏微分方程数值方法的既定原则之上，特别是高阶间断 Galerkin 方法和斜率/曲率限制技术。使用 Legendre 多项式、minmod 限制器和导数的有限差分近似是该领域的标准做法。\n- **适定性：** 提供了所有必要的数据和定义。问题是自洽的，并导向一个唯一的、有意义的解。\n- **客观性：** 问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它是科学上合理、适定且客观的。将提供解答。\n\n---\n\n解题过程首先推导比例常数 $\\kappa$，然后对二阶模态系数 $a_2$ 应用限制器，最后在指定点处计算得到的受限多项式的值。\n\n**1. 比例常数 $\\kappa$ 的推导**\n\n目标是找到模态系数 $a_2$ 与单元平均值的离散二阶差分 $\\Delta^2 \\bar{u}_i$ 之间的关系。这可以通过将这两个量与解的物理二阶导数 $u_{xx}$ 相关联来实现。\n\n首先，我们将 $a_2$ 与 $u_{xx}$ 关联起来。从参考坐标 $\\xi$ 到物理坐标 $x$ 的映射由 $x = x_i + \\frac{h}{2}\\xi$ 给出。我们使用链式法则来关联关于 $x$ 和 $\\xi$ 的导数：\n$$\n\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi}\n$$\n根据该映射，我们有 $\\frac{dx}{d\\xi} = \\frac{h}{2}$，所以 $\\frac{d\\xi}{dx} = \\frac{2}{h}$。那么二阶导数是：\n$$\n\\frac{d^2}{dx^2} = \\frac{d}{dx}\\left(\\frac{2}{h}\\frac{d}{d\\xi}\\right) = \\frac{2}{h}\\frac{d\\xi}{dx}\\frac{d}{d\\xi}\\left(\\frac{d}{d\\xi}\\right) = \\left(\\frac{2}{h}\\right)^2 \\frac{d^2}{d\\xi^2} = \\frac{4}{h^2}\\frac{d^2}{d\\xi^2}\n$$\n单元内的解表示为 $u_i(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2 L_2(\\xi) = \\bar{u}_i + a_1 \\xi + a_2 \\frac{3\\xi^2 - 1}{2}$。我们计算它关于 $\\xi$ 的二阶导数：\n$$\n\\frac{du_i}{d\\xi} = a_1 + a_2 (3\\xi) = a_1 + 3a_2\\xi\n$$\n$$\n\\frac{d^2u_i}{d\\xi^2} = 3a_2\n$$\n将此代入物理二阶导数 $u_{xx}$ 的表达式中：\n$$\nu_{xx} = \\frac{4}{h^2}\\frac{d^2u_i}{d\\xi^2} = \\frac{4}{h^2}(3a_2) = \\frac{12a_2}{h^2}\n$$\n这给出了单元内多项式近似的精确二阶导数。解出 $a_2$：\n$$\na_2 = \\frac{h^2}{12}u_{xx}\n$$\n接下来，我们使用基于单元平均值的二阶中心有限差分来近似单元中心 $x_i$ 处的物理二阶导数 $u_{xx}$：\n$$\nu_{xx}(x_i) \\approx \\frac{\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1}}{h^2} = \\frac{\\Delta^2 \\bar{u}_i}{h^2}\n$$\n通过将单元内连续的二阶导数与其跨单元的离散近似相等，我们为 $a_2$ 建立了所需的关系：\n$$\na_2 \\approx \\frac{h^2}{12} \\left( \\frac{\\Delta^2 \\bar{u}_i}{h^2} \\right) = \\frac{1}{12}\\Delta^2 \\bar{u}_i\n$$\n根据问题陈述的形式 $a_2 \\approx \\kappa\\,\\Delta^2 \\bar{u}_i$，我们确定比例常数为：\n$$\n\\kappa = \\frac{1}{12}\n$$\n问题指定了 $h=1$，这在推导中被隐式使用。此结果与 $h$ 无关。\n\n**2. 受限系数 $a_2^{\\mathrm{lim}}$ 的计算**\n\n现在我们计算 minmod 函数的两个参数。第一个参数是原始系数 $a_2 = -0.05$。第二个参数是 $\\kappa\\,\\Delta^2 \\bar{u}_i$。首先，我们计算 $\\Delta^2 \\bar{u}_i$：\n$$\n\\Delta^2 \\bar{u}_i = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1} = 1.35 - 2(1.2) + 0.9 = 1.35 - 2.4 + 0.9 = -0.15\n$$\n现在我们计算第二个参数：\n$$\n\\kappa\\,\\Delta^2 \\bar{u}_i = \\frac{1}{12} (-0.15) = -\\frac{0.15}{12} = -0.0125\n$$\n现在，我们应用 minmod 函数来找到受限系数 $a_2^{\\mathrm{lim}}$：\n$$\na_2^{\\mathrm{lim}} = \\operatorname{minmod}(a_2, \\kappa\\,\\Delta^2 \\bar{u}_i) = \\operatorname{minmod}(-0.05, -0.0125)\n$$\n由于两个参数都是负数，它们的符号相同。因此，\n$$\na_2^{\\mathrm{lim}} = \\operatorname{sign}(-0.05) \\min(|-0.05|, |-0.0125|) = -1 \\min(0.05, 0.0125) = -0.0125\n$$\n\n**3. 受限多项式的求值**\n\n受限多项式由下式给出：\n$$\nu_i^{\\mathrm{lim}}(\\xi) = \\bar{u}_i + a_1 L_1(\\xi) + a_2^{\\mathrm{lim}} L_2(\\xi)\n$$\n代入已知值和 Legendre 多项式的表达式：\n$$\nu_i^{\\mathrm{lim}}(\\xi) = 1.2 + 0.3\\xi -0.0125\\left(\\frac{3\\xi^2 - 1}{2}\\right)\n$$\n我们在 $p=2$ 的 Gauss-Lobatto 点，即 $\\xi = -1, 0, 1$ 处计算该多项式的值。\n\n- 对于 $\\xi = -1$：\n$$\nu_i^{\\mathrm{lim}}(-1) = 1.2 + 0.3(-1) - 0.0125\\left(\\frac{3(-1)^2 - 1}{2}\\right) = 1.2 - 0.3 - 0.0125\\left(\\frac{3 - 1}{2}\\right) = 0.9 - 0.0125(1) = 0.8875\n$$\n\n- 对于 $\\xi = 0$：\n$$\nu_i^{\\mathrm{lim}}(0) = 1.2 + 0.3(0) - 0.0125\\left(\\frac{3(0)^2 - 1}{2}\\right) = 1.2 - 0.0125\\left(-\\frac{1}{2}\\right) = 1.2 + 0.00625 = 1.20625\n$$\n\n- 对于 $\\xi = 1$：\n$$\nu_i^{\\mathrm{lim}}(1) = 1.2 + 0.3(1) - 0.0125\\left(\\frac{3(1)^2 - 1}{2}\\right) = 1.2 + 0.3 - 0.0125\\left(\\frac{3 - 1}{2}\\right) = 1.5 - 0.0125(1) = 1.4875\n$$\n\n受限多项式在指定点处的三个值是 $0.8875$，$1.20625$ 和 $1.4875$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.8875  1.20625  1.4875 \\end{pmatrix}}\n$$", "id": "3399846"}, {"introduction": "限制器虽然对于保证数值解的稳定性至关重要，但其应用并非没有代价，尤其是在解的光滑区域。本练习 [@problem_id:3399887] 探讨了一个微妙但关键的问题：当限制器在光滑极值点附近被不必要地激活时，高阶格式的全局精度会如何退化。通过一个假设的概率模型，你将推导出一个解析表达式来量化这种精度损失，从而深刻理解在实际应用中高阶格式的精度与稳定性之间的权衡。", "problem": "考虑一个标量线性平流问题，该问题在一个网格尺寸为 $h  0$、域长度为 $L  0$ 的均匀网格上，通过一个多项式次数为 $p \\in \\mathbb{N}$ 的高阶间断 Galerkin (DG) 方法进行离散。假设使用单调数值通量。在没有限制器的情况下，对于光滑解，该格式能达到基准 $L^{\\infty}$ 收敛阶 $r = p + 1$。为了控制伪振荡，应用了总变差递减 (TVD) 斜率限制器，选自集合 $\\{\\text{minmod}, \\text{superbee}, \\text{van Leer}\\}$。对于光滑数据，这些 TVD 限制器中的每一个都可能在局部离散光滑度指标超过阈值的区域（尤其是在光滑极值点附近）间歇性地激活。当激活时，重构在被激活的单元上在空间上有效地变为一阶。设限制器 $\\ell$ 激活下的有效逐点阶为 $q_{\\ell}$，并假设 $q_{\\text{minmod}} = q_{\\text{superbee}} = q_{\\text{van Leer}} = 1$。\n\n将间歇性激活模型化如下。将域划分为 $N(h) = \\lfloor L / h \\rfloor$ 个单元。在每个单元中，并在固定的最终时刻，激活以概率独立发生\n$$\np_{\\mathrm{act}}(h) = C \\, h^{\\beta},\n$$\n其中 $C  0$ 和 $\\beta  0$ 表征了激活模式。设 $A(h)$ 为至少有一个单元被限制的事件。将网格尺寸为 $h$ 时的 $L^{\\infty}$ 误差定义为 $E(h)$，并假设 $E(h)$ 的主要贡献来自无激活时的基准高阶行为或至少有一次激活时的一阶行为，因此，期望误差的主阶渐近模型为\n$$\n\\mathbb{E}[E(h)] \\asymp \\mathbb{P}(A(h)) \\, h^{q_{\\ell}} + \\big(1 - \\mathbb{P}(A(h))\\big) \\, h^{r},\n$$\n其中对于所有三种 TVD 限制器，激活下有 $r = p + 1$ 和 $q_{\\ell} = 1$。\n\n从 DG 方法对光滑解的基准阶、TVD 在光滑极值点激活时的一阶退化以及独立伯努利试验的基本概率等基本定义出发，推导由下式定义的渐近期望 $L^{\\infty}$ 收敛阶 $s_{\\ell}$\n$$\n\\mathbb{E}[E(h)] = \\Theta\\big(h^{s_{\\ell}}\\big) \\quad \\text{as } h \\to 0,\n$$\n作为 $(p, \\beta, C, L)$ 和限制器选择 $\\ell \\in \\{\\text{minmod}, \\text{superbee}, \\text{van Leer}\\}$ 的函数。你的推导必须在给定的间歇性激活模型下，明确地得到 $s_{\\ell}$ 关于 $(p, \\beta)$ 的封闭形式表达式。\n\n然后，实现一个程序，对一组测试用例，计算每个用例推导出的 $s_{\\ell}$。使用以下测试套件，其中每个用例以元组 $(\\ell, p, \\beta, C, L)$ 的形式给出：\n\n- 用例 1：$(\\text{minmod}, 2, 0.5, 1.0, 1.0)$\n- 用例 2：$(\\text{superbee}, 3, 1.0, 0.1, 1.0)$\n- 用例 3：$(\\text{van\\ Leer}, 4, 1.5, 0.5, 1.0)$\n- 用例 4：$(\\text{minmod}, 2, 2.0, 1.0, 1.0)$\n- 用例 5：$(\\text{superbee}, 2, 3.0, 0.5, 1.0)$\n- 用例 6：$(\\text{van\\ Leer}, 1, 2.5, 2.0, 1.0)$\n- 用例 7：$(\\text{minmod}, 0, 2.0, 1.0, 1.0)$\n\n对于每个测试用例，将实数 $s_{\\ell}$ 作为浮点值输出。最终所需的输出格式是单行包含一个 Python 风格的列表，其中的条目由逗号分隔并用方括号括起来，例如 $[x_1, x_2, x_3]$。不应打印任何额外文本。\n\n此问题不需要物理单位。不涉及角度。不得使用百分比；概率参数 $\\beta$ 已表示为不带百分号的实数指数。", "solution": "我们从三个要素开始。首先，对于光滑解和稳定的单调数值通量，多项式次数为 $p$ 的间断 Galerkin (DG) 方法可达到基准 $L^{\\infty}$ 收敛阶 $r = p + 1$，这意味着在没有限制器的情况下，当 $h \\to 0$ 时，逐点误差按 $h^{r}$ 的比例缩放。其次，总变差递减 (TVD) 类斜率限制器，包括 minmod、superbee 和 van Leer，旨在强制执行单调性约束，以避免在不连续点和陡峭梯度附近的伪振荡。在光滑单调区域和非激活状态下，这些 TVD 限制器不会降低阶数，但当它们在光滑极值点等区域激活时，局部重构会退化为一阶行为，导致每个限制器 $\\ell \\in \\{\\text{minmod}, \\text{superbee}, \\text{van Leer}\\}$ 在激活下的逐点阶为 $q_{\\ell} = 1$。TVD 格式在光滑极值点处的一阶退化是 TVD 约束的一个众所周知的结果。第三，我们引入一个间歇性激活模型：在固定的最终时刻，每个单元以概率 $p_{\\mathrm{act}}(h) = C \\, h^{\\beta}$ 独立触发激活，其中常数 $C  0$ 和 $\\beta  0$，域被划分为 $N(h) = \\lfloor L / h \\rfloor$ 个单元。\n\n定义事件 $A(h)$ 为网格中至少有一个单元被限制。在独立性假设下，没有激活的概率是\n$$\n\\mathbb{P}\\big(A(h)^c\\big) \\;=\\; \\big(1 - p_{\\mathrm{act}}(h)\\big)^{N(h)} \\;=\\; \\Big(1 - C h^{\\beta}\\Big)^{\\lfloor L/h \\rfloor}.\n$$\n当 $h \\to 0$ 时，有 $N(h) \\sim L / h$，我们使用指数极限\n$$\n\\Big(1 - C h^{\\beta}\\Big)^{L/h} \\;=\\; \\exp\\!\\Big(\\tfrac{L}{h} \\ln(1 - C h^{\\beta})\\Big) \\;\\sim\\; \\exp\\!\\Big(- \\tfrac{L}{h} \\, C h^{\\beta}\\Big) \\;=\\; \\exp\\!\\big(- C L \\, h^{\\beta - 1}\\big),\n$$\n从而\n$$\n\\mathbb{P}(A(h)) \\;=\\; 1 - \\exp\\!\\big(- C L \\, h^{\\beta - 1}\\big) \\;\\sim\\;\n\\begin{cases}\n1,   \\text{当 } \\beta \\le 1 \\text{ 时},\\\\[4pt]\nC L \\, h^{\\beta - 1},   \\text{当 } \\beta  1 \\text{ 时},\n\\end{cases}\n$$\n其中最后一行来自于当 $x \\to 0$ 时的小参数展开 $1 - e^{-x} \\sim x$。\n\n设 $E(h)$ 表示 $L^{\\infty}$ 误差。当至少有一次激活发生时，逐点渐近行为由一阶行为 $h^{q_{\\ell}}$ 建模；当没有激活发生时，由基准行为 $h^{r}$ 建模。因此，\n$$\n\\mathbb{E}[E(h)] \\;\\asymp\\; \\mathbb{P}(A(h)) \\, h^{q_{\\ell}} + \\big(1 - \\mathbb{P}(A(h))\\big) \\, h^{r}.\n$$\n我们通过 $\\mathbb{E}[E(h)] = \\Theta(h^{s_{\\ell}})$（当 $h \\to 0$ 时）来定义期望渐近阶 $s_{\\ell}$。我们使用 $\\mathbb{P}(A(h))$ 的渐近形式来分情况分析：\n\n情况 $\\beta \\le 1$。此时 $\\mathbb{P}(A(h)) \\to 1$ 且 $1 - \\mathbb{P}(A(h)) \\to 0$。因此\n$$\n\\mathbb{E}[E(h)] \\;\\asymp\\; h^{q_{\\ell}},\n$$\n从而\n$$\ns_{\\ell} \\;=\\; q_{\\ell}.\n$$\n\n情况 $\\beta  1$。此时 $\\mathbb{P}(A(h)) \\sim C L \\, h^{\\beta - 1}$ 且 $1 - \\mathbb{P}(A(h)) \\sim 1$。因此，\n$$\n\\mathbb{E}[E(h)] \\;\\asymp\\; \\big(C L\\big) h^{\\beta - 1} h^{q_{\\ell}} + 1 \\cdot h^{r} \\;=\\; \\big(C L\\big) h^{q_{\\ell} + \\beta - 1} + h^{r}.\n$$\n指数为 $q_{\\ell} + \\beta - 1$ 和 $r$ 的两项之和在渐近意义上由较小的指数决定，所以\n$$\ns_{\\ell} \\;=\\; \\min\\big(r,\\; q_{\\ell} + \\beta - 1\\big).\n$$\n\n综合两种情况，并代入 $r = p + 1$ 和 $q_{\\ell} = 1$（对于 $\\ell \\in \\{\\text{minmod}, \\text{superbee}, \\text{van Leer}\\}$），我们得到\n$$\ns_{\\ell}(p,\\beta) \\;=\\;\n\\begin{cases}\n1,   \\text{当 } \\beta \\le 1 \\text{ 时},\\\\[4pt]\n\\min\\big(p + 1,\\; \\beta\\big),   \\text{当 } \\beta  1 \\text{ 时},\n\\end{cases}\n$$\n这也可以统一写成\n$$\ns_{\\ell}(p,\\beta) \\;=\\; \\min\\Big(p + 1,\\; 1 + \\max\\big(0,\\; \\beta - 1\\big)\\Big) \\;=\\;\n\\begin{cases}\n1,   \\beta \\le 1,\\\\\n\\min\\big(p + 1,\\; \\beta\\big),   \\beta  1.\n\\end{cases}\n$$\n由于在激活状态下三种 TVD 限制器的 $q_{\\ell}$ 均为 1，因此在这个间歇性激活模型下，minmod、superbee 和 van Leer 的期望 $L^{\\infty}$ 阶 $s_{\\ell}$ 是相同的。在此设定下，不同限制器之间的差异会影响常数，但不会影响渐近指数。\n\n我们现在将此应用于指定的测试用例。对每个用例，计算 $r = p + 1$，然后\n$$\ns_{\\ell} \\;=\\;\n\\begin{cases}\n1,   \\beta \\le 1,\\\\\n\\min(r,\\; \\beta),   \\beta  1.\n\\end{cases}\n$$\n计算：\n\n- 用例 1：$(\\text{minmod}, p = 2, \\beta = 0.5)$ 得到 $r = 3$，$\\beta \\le 1 \\Rightarrow s = 1$。\n- 用例 2：$(\\text{superbee}, p = 3, \\beta = 1.0)$ 得到 $r = 4$，$\\beta \\le 1 \\Rightarrow s = 1$。\n- 用例 3：$(\\text{van Leer}, p = 4, \\beta = 1.5)$ 得到 $r = 5$，$\\beta  1 \\Rightarrow s = \\min(5, 1.5) = 1.5$。\n- 用例 4：$(\\text{minmod}, p = 2, \\beta = 2.0)$ 得到 $r = 3$, $s = \\min(3, 2.0) = 2.0$。\n- 用例 5：$(\\text{superbee}, p = 2, \\beta = 3.0)$ 得到 $r = 3$, $s = \\min(3, 3.0) = 3.0$。\n- 用例 6：$(\\text{van Leer}, p = 1, \\beta = 2.5)$ 得到 $r = 2$, $s = \\min(2, 2.5) = 2.0$。\n- 用例 7：$(\\text{minmod}, p = 0, \\beta = 2.0)$ 得到 $r = 1$, $s = \\min(1, 2.0) = 1.0$。\n\n这些值是程序必须以指定的单行列表格式生成的输出。", "answer": "[1.0,1.0,1.5,2.0,3.0,2.0,1.0]", "id": "3399887"}]}