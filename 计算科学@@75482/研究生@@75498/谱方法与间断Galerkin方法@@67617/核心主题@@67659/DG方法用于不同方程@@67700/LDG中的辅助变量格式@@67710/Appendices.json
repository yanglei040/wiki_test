{"hands_on_practices": [{"introduction": "任何局部间断Galerkin (LDG) 方法的实现都始于在标准“参考单元”上计算局部矩阵。本练习的核心是处理辅助方程 $q = \\nabla u$，演示如何使用模态基（勒让德多项式）构建基本的质量矩阵和刚度矩阵。这是组装全局离散系统的基石。[@problem_id:3364989]", "problem": "考虑将局部间断 Galerkin (LDG) 方法应用于一维空间中参考区间 $[-1,1]$ 上的一阶辅助方程 $q = \\nabla u$。设试探空间和检验空间为同一个最高次数为 $p=3$ 的模态多项式空间，由标准正交 Legendre 基函数 $\\{\\varphi_{n}(x)\\}_{n=0}^{3}$ 张成，其中 $\\varphi_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$ 且 $P_{n}(x)$ 是 $[-1,1]$ 上的 n 次 Legendre 多项式。针对 $q$ 方程的单元质量子矩阵定义为\n$$\nM^{q}_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\varphi_{j}(x)\\,\\mathrm{d}x,\n$$\n而将 $u$ 与 $q$ 耦合的类刚度梯度子矩阵定义为\n$$\nG_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\varphi_{j}(x)\\,\\mathrm{d}x,\n$$\n采用仅内部耦合（即在此构造中忽略边界通量）。使用精确求积（选择一个足够高阶的 Gauss–Legendre 法则，以确保所有多项式乘积的积分都能被精确计算），在参考单元上为 $p=3$ 的情况构造 $M^{q}$ 和 $G$，并以符号形式列出它们的所有非零元。\n\n最后，计算 $G$ 的 Frobenius 范数的平方，\n$$\n\\|G\\|_{F}^{2} = \\sum_{i=0}^{3}\\sum_{j=0}^{3} G_{ij}^{2},\n$$\n并将此标量作为最终答案。如果您的计算得出精确值，请勿四舍五入。", "solution": "用户在偏微分方程数值分析领域内提供了一个定义明确的计算问题，具体涉及局部间断 Galerkin (LDG) 方法。所有定义、参数和目标都陈述清晰且在数学上是合理的。该问题是自洽的，没有科学缺陷、矛盾或歧义。因此，该问题被认为是有效的，有必要提供一个完整的解答。\n\n该问题要求为参考单元 $[-1,1]$ 上的 LDG 公式构造两个矩阵：质量子矩阵 $M^{q}$ 和类刚度梯度子矩阵 $G$。多项式逼近空间的最高次数为 $p=3$，由一个标准正交 Legendre 基张成。最后，必须计算 $G$ 的 Frobenius 范数的平方。\n\n基函数是 $[-1,1]$ 上的标准正交 Legendre 多项式，由 $\\varphi_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$ 给出，其中 $P_{n}(x)$ 是 n 次标准 Legendre 多项式。对于 $p=3$，基为 $\\{\\varphi_{0}, \\varphi_{1}, \\varphi_{2}, \\varphi_{3}\\}$。\n\n首先，我们构造质量子矩阵 $M^{q}$。其元定义为：\n$$\nM^{q}_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\varphi_{j}(x)\\,\\mathrm{d}x, \\quad i,j \\in \\{0, 1, 2, 3\\}\n$$\n根据定义，基 $\\{\\varphi_{n}(x)\\}$ 关于 $[-1,1]$ 上的 $L^2$ 内积是标准正交的。因此，该积分等于 Kronecker delta 符号 $\\delta_{ij}$。\n$$\nM^{q}_{ij} = \\delta_{ij}\n$$\n这意味着 $M^{q}$ 是 $4 \\times 4$ 的单位矩阵 $I_4$。非零元位于主对角线上：\n$$\nM^{q}_{00} = 1, \\quad M^{q}_{11} = 1, \\quad M^{q}_{22} = 1, \\quad M^{q}_{33} = 1\n$$\n\n接下来，我们构造类刚度梯度子矩阵 $G$。其元定义为：\n$$\nG_{ij} = \\int_{-1}^{1} \\varphi_{i}(x)\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\varphi_{j}(x)\\,\\mathrm{d}x, \\quad i,j \\in \\{0, 1, 2, 3\\}\n$$\n为了计算这些元，我们使用 Legendre 多项式导数的著名性质：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}P_{j}(x) = \\sum_{\\substack{k=0 \\\\ k  j \\\\ j-k \\text{ is odd}}}^{j-1} (2k+1)P_{k}(x)\n$$\n我们可以通过代入 $P_{n}(x) = \\sqrt{\\frac{2}{2n+1}}\\varphi_{n}(x)$，用标准正交基函数 $\\varphi_{n}(x)$ 来表示这个关系：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\sqrt{\\frac{2}{2j+1}}\\varphi_{j}(x)\\right) = \\sum_{\\substack{k=0 \\\\ k  j \\\\ j-k \\text{ is odd}}}^{j-1} (2k+1)\\sqrt{\\frac{2}{2k+1}}\\varphi_{k}(x)\n$$\n乘以 $\\sqrt{\\frac{2j+1}{2}}$ 得到导数 $\\varphi'_{j}(x)$ 的展开式：\n$$\n\\varphi'_{j}(x) = \\sqrt{\\frac{2j+1}{2}} \\sum_{\\substack{k=0 \\\\ k  j \\\\ j-k \\text{ is odd}}}^{j-1} \\sqrt{2(2k+1)}\\,\\varphi_{k}(x) = \\sum_{\\substack{k=0 \\\\ k  j \\\\ j-k \\text{ is odd}}}^{j-1} \\sqrt{(2j+1)(2k+1)}\\,\\varphi_{k}(x)\n$$\n元 $G_{ij}$ 是 $L^2$ 内积 $(\\varphi_{i}, \\varphi'_{j})$。代入 $\\varphi'_{j}(x)$ 的展开式可得：\n$$\nG_{ij} = \\int_{-1}^{1} \\varphi_{i}(x) \\left( \\sum_{\\substack{k=0 \\\\ k  j \\\\ j-k \\text{ is odd}}}^{j-1} \\sqrt{(2j+1)(2k+1)}\\,\\varphi_{k}(x) \\right) \\mathrm{d}x\n$$\n由于基是标准正交的，$\\int_{-1}^{1} \\varphi_{i}(x)\\varphi_{k}(x)\\,\\mathrm{d}x = \\delta_{ik}$，该积分的作用是从和式中选出 $\\varphi_{i}(x)$ 的系数。因此，只有当 $i$ 满足求和索引 $k$ 的条件，即 $i  j$ 且 $j-i$ 为奇数时，$G_{ij}$ 才非零。\n$$\nG_{ij} = \\begin{cases} \\sqrt{(2j+1)(2i+1)}  \\text{if } i  j \\text{ and } j-i \\text{ is odd} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n我们现在计算 $i,j \\in \\{0, 1, 2, 3\\}$ 的具体非零元：\n\\begin{itemize}\n    \\item 对于 $j=0$：$\\varphi'_{0}(x) = 0$，所以对所有 $i$ 都有 $G_{i0}=0$。\n    \\item 对于 $j=1$：唯一有效的 $i$ 是 $i=0$（因为 $01$ 且 $1-0=1$ 是奇数）。\n    $$ G_{01} = \\sqrt{(2(1)+1)(2(0)+1)} = \\sqrt{3 \\cdot 1} = \\sqrt{3} $$\n    \\item 对于 $j=2$：唯一有效的 $i$ 是 $i=1$（因为 $12$ 且 $2-1=1$ 是奇数）。\n    $$ G_{12} = \\sqrt{(2(2)+1)(2(1)+1)} = \\sqrt{5 \\cdot 3} = \\sqrt{15} $$\n    \\item 对于 $j=3$：有效的 $i$ 值为 $i=0$（$03, 3-0=3$ 是奇数）和 $i=2$（$23, 3-2=1$ 是奇数）。\n    $$ G_{03} = \\sqrt{(2(3)+1)(2(0)+1)} = \\sqrt{7 \\cdot 1} = \\sqrt{7} $$\n    $$ G_{23} = \\sqrt{(2(3)+1)(2(2)+1)} = \\sqrt{7 \\cdot 5} = \\sqrt{35} $$\n\\end{itemize}\n$G$ 的所有其他元都为零。$G$ 的非零元为：$G_{01} = \\sqrt{3}$，$G_{12} = \\sqrt{15}$，$G_{03} = \\sqrt{7}$ 和 $G_{23} = \\sqrt{35}$。\n\n最后，我们计算 $G$ 的 Frobenius 范数的平方：\n$$\n\\|G\\|_{F}^{2} = \\sum_{i=0}^{3}\\sum_{j=0}^{3} G_{ij}^{2}\n$$\n这是矩阵所有元的平方和。我们只需要考虑非零元：\n$$\n\\|G\\|_{F}^{2} = G_{01}^{2} + G_{12}^{2} + G_{03}^{2} + G_{23}^{2}\n$$\n代入计算出的值：\n$$\n\\|G\\|_{F}^{2} = (\\sqrt{3})^{2} + (\\sqrt{15})^{2} + (\\sqrt{7})^{2} + (\\sqrt{35})^{2}\n$$\n$$\n\\|G\\|_{F}^{2} = 3 + 15 + 7 + 35\n$$\n$$\n\\|G\\|_{F}^{2} = 18 + 42 = 60\n$$\n矩阵 $G$ 的 Frobenius 范数的平方是 $60$。", "answer": "$$\\boxed{60}$$", "id": "3364989"}, {"introduction": "间断Galerkin方法的一个关键特征是通过数值通量来处理边界条件。本练习从孤立的单元计算转向一个完整的、包含边界条件的问题设置。它展示了如何通过为数值通量 $\\widehat{u}$ 和 $\\widehat{r}$ 做出特定选择来施加狄利克雷（Dirichlet）和诺伊曼（Neumann）边界数据，以及这如何转化为代数系统中的具体项。[@problem_id:3365011]", "problem": "考虑在区间 $[0,1]$ 上的一维、稳态、二阶扩散模型，其扩散系数为正常数 $\\kappa0$，\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) \\;=\\; f(x),\n$$\n服从边界条件 $u(0)=0$ 和 $\\kappa\\, u'(1)=1$，源项为零 $f(x)\\equiv 0$。引入辅助变量 $r(x)=\\kappa\\, u'(x)$，使方程组变为\n$$\nr - \\kappa\\, u' \\;=\\; 0, \\qquad -r' \\;=\\; 0.\n$$\n使用局部间断伽辽金 (LDG) 方法，在单个单元 $E=[0,1]$ 上用 $p=1$ 次的分段多项式来近似 $u$ 和 $r$：\n$$\nu_h(x) \\;=\\; a_0\\,\\phi_0(x) + a_1\\,\\phi_1(x), \\qquad r_h(x) \\;=\\; b_0\\,\\phi_0(x) + b_1\\,\\phi_1(x),\n$$\n其中，局部基函数在 $E$ 上选为 $\\phi_0(x)=1$ 和 $\\phi_1(x)=x$。令 $v,w\\in\\mathrm{span}\\{\\phi_0,\\phi_1\\}$ 分别为第一个和第二个方程的检验函数。从一阶系统出发，通过适当使用分部积分法，并将边界上的迹替换为数值通量，来推导单元上的 LDG 弱形式。对于数值通量，在单个单元的边界上采用标准的 LDG 交替选择：\n- 在 $x=0$ (狄利克雷边界)，设置 $\\widehat{u}(0)=u_D=0$，并对 $\\widehat{r}(0)$ 使用内部值 $\\widehat{r}(0)=r_h(0)$。\n- 在 $x=1$ (诺伊曼边界)，设置 $\\widehat{r}(1)=g_N=1$，并对 $\\widehat{u}(1)$ 使用内部值 $\\widehat{u}(1)=u_h(1)$。\n\n写出由此产生的单元 LDG 系统，然后显式地计算 $p=1$ 次多项式的边界贡献。具体来说，提取仅由给定边界数据 $(u_D,g_N)=(0,1)$ 产生的局部残差的纯边界贡献，并用每个方程中的两个检验函数 $\\phi_0$ 和 $\\phi_1$ 进行计算。将四个边界贡献按行向量排列\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big],\n$$\n其中，$B^{(r-\\kappa u')}_{\\phi_j}$ 和 $B^{(-r')}_{\\phi_j}$ 分别表示第一个和第二个方程的弱形式中仅来自给定边界数据的边界项。将此行向量作为你的最终答案。无需四舍五入。以闭合形式的解析表达式给出最终答案。", "solution": "用户要求我基于局部间断伽辽金 (LDG) 方法求解一个关于一维扩散方程的问题。\n\n### 第一步：问题验证\n\n**1.1. 提取已知条件**\n\n- **控制方程**：在区间 $[0,1]$ 上为 $- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(\\kappa\\, u'(x)\\big) = f(x)$。\n- **参数**：扩散系数 $\\kappa  0$ 是一个常数。源项 $f(x) \\equiv 0$。\n- **边界条件**：$u(0)=u_D=0$ 和 $\\kappa\\, u'(1)=g_N=1$。\n- **一阶系统**：辅助变量为 $r(x)=\\kappa\\, u'(x)$。该系统为：\n    $$\n    r - \\kappa\\, u' = 0\n    $$\n    $$\n    -r' = 0\n    $$\n- **离散化**：定义域为单个单元 $E=[0,1]$。近似空间由 $p=1$ 次的多项式组成。\n- **试探函数和检验函数**：\n    - 基函数：$\\phi_0(x)=1$, $\\phi_1(x)=x$。\n    - 试探函数：$u_h(x) = a_0\\phi_0(x) + a_1\\phi_1(x)$ 和 $r_h(x) = b_0\\phi_0(x) + b_1\\phi_1(x)$。\n    - 检验函数：$v,w \\in \\mathrm{span}\\{\\phi_0,\\phi_1\\}$。\n- **数值通量**：指定了交替通量选择：\n    - 在 $x=0$ 处：$\\widehat{u}(0)=u_D=0$；$\\widehat{r}(0)=r_h(0)$。\n    - 在 $x=1$ 处：$\\widehat{r}(1)=g_N=1$；$\\widehat{u}(1)=u_h(1)$。\n- **任务**：计算仅由给定边界数据 $(u_D,g_N)=(0,1)$ 产生的局部残差的四个边界贡献，并按行向量 $\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]$ 的顺序排列。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据**：该问题是成熟的局部间断伽辽金 (LDG) 方法在基本的二阶椭圆偏微分方程（扩散方程）上的标准应用。所有概念在数值分析和计算科学中都是标准的。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了一套完整的指令，包括控制方程、边界条件、离散化细节（单元、基函数）以及数值通量的具体选择。任务是基于这些输入的一个具体、明确的计算。\n- **客观性**：问题陈述是用精确的数学术语表述的，没有任何主观或模糊的语言。\n\n**1.3. 结论和行动**\n\n问题有效。我将继续解答。\n\n### 第二步：求解推导\n\n该过程首先在单元 $E=[0,1]$ 上推导一阶系统的弱形式。\n\n**第一个方程的弱形式推导**\n第一个方程是 $r - \\kappa u' = 0$。我们将其乘以一个检验函数 $v$ 并在单元 $E$ 上积分：\n$$\n\\int_{E} (r_h - \\kappa u'_h) v \\, dx = 0\n$$\n$$\n\\int_{0}^{1} r_h v \\, dx - \\kappa \\int_{0}^{1} u'_h v \\, dx = 0\n$$\n我们对第二项应用分部积分法：\n$$\n\\int_{0}^{1} u'_h v \\, dx = [u_h v]_{x=0}^{x=1} - \\int_{0}^{1} u_h v' \\, dx = u_h(1)v(1) - u_h(0)v(0) - \\int_{0}^{1} u_h v' \\, dx\n$$\n将其代回方程中，得到：\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa(u_h(1)v(1) - u_h(0)v(0)) = 0\n$$\n在间断伽辽金框架中，解在单元边界上的迹被数值通量替换，用帽子符号表示。弱形式变为：\n$$\n\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa \\widehat{u}(1)v(1) + \\kappa \\widehat{u}(0)v(0) = 0\n$$\n\n**第二个方程的弱形式推导**\n第二个方程是 $-r' = 0$。我们将其乘以一个检验函数 $w$ 并在 $E$ 上积分：\n$$\n-\\int_{E} r'_h w \\, dx = 0\n$$\n应用分部积分法：\n$$\n-[r_h w]_{x=0}^{x=1} + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n$$\n-(r_h(1)w(1) - r_h(0)w(0)) + \\int_{0}^{1} r_h w' \\, dx = 0\n$$\n用数值通量 $\\widehat{r}(1)$ 和 $\\widehat{r}(0)$ 替换边界上的迹：\n$$\n\\int_{0}^{1} r_h w' \\, dx - \\widehat{r}(1)w(1) + \\widehat{r}(0)w(0) = 0\n$$\n\n**定义局部残差并识别边界贡献**\n问题要求的是仅由给定边界数据产生的局部残差的贡献。每个方程的局部残差是必须等于零的表达式。我们代入问题中给定的特定数值通量：\n- 在 $x=0$ 处：$\\widehat{u}(0)=u_D=0$, $\\widehat{r}(0)=r_h(0)$ (内部值)。\n- 在 $x=1$ 处：$\\widehat{r}(1)=g_N=1$, $\\widehat{u}(1)=u_h(1)$ (内部值)。\n\n将这些代入弱形式得到残差方程：\n第一个方程的残差：\n$$\n\\underbrace{\\int_{0}^{1} r_h v \\, dx + \\kappa \\int_{0}^{1} u_h v' \\, dx - \\kappa u_h(1)v(1)}_{\\text{依赖于未知解的项}} + \\underbrace{\\kappa u_D v(0)}_{\\text{来自给定数据的项}} = 0\n$$\n第二个方程的残差：\n$$\n\\underbrace{\\int_{0}^{1} r_h w' \\, dx + r_h(0)w(0)}_{\\text{依赖于未知解的项}} \\underbrace{- g_N w(1)}_{\\text{来自给定数据的项}} = 0\n$$\n来自给定边界数据的局部残差贡献是不依赖于未知解系数 $(a_0, a_1, b_0, b_1)$ 的那部分表达式。\n对于第一个方程，这个贡献是 $B^{(r-\\kappa u')}_{v} = \\kappa u_D v(0)$。\n对于第二个方程，这个贡献是 $B^{(-r')}_{w} = -g_N w(1)$。\n\n**计算特定检验函数的贡献**\n给定 $u_D=0$ 和 $g_N=1$。检验函数是 $\\phi_0(x)=1$ 和 $\\phi_1(x)=x$。\n\n1.  **项 $B^{(r-\\kappa u')}_{\\phi_0}$**：此处 $v = \\phi_0(x)=1$。\n    $B^{(r-\\kappa u')}_{\\phi_0} = \\kappa u_D \\phi_0(0) = \\kappa \\cdot 0 \\cdot 1 = 0$。\n\n2.  **项 $B^{(r-\\kappa u')}_{\\phi_1}$**：此处 $v = \\phi_1(x)=x$。\n    $B^{(r-\\kappa u')}_{\\phi_1} = \\kappa u_D \\phi_1(0) = \\kappa \\cdot 0 \\cdot 0 = 0$。\n\n3.  **项 $B^{(-r')}_{\\phi_0}$**：此处 $w = \\phi_0(x)=1$。\n    $B^{(-r')}_{\\phi_0} = -g_N \\phi_0(1) = -1 \\cdot 1 = -1$。\n\n4.  **项 $B^{(-r')}_{\\phi_1}$**：此处 $w = \\phi_1(x)=x$。\n    $B^{(-r')}_{\\phi_1} = -g_N \\phi_1(1) = -1 \\cdot 1 = -1$。\n\n**向量的最终组装**\n问题要求按指定顺序给出这四个贡献的行向量：\n$$\n\\big[\\;B^{(r-\\kappa u')}_{\\phi_0}\\;\\; B^{(r-\\kappa u')}_{\\phi_1}\\;\\; B^{(-r')}_{\\phi_0}\\;\\; B^{(-r')}_{\\phi_1}\\;\\big]\n$$\n代入计算出的值，我们得到最终答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  -1  -1\n\\end{pmatrix}\n}\n$$", "id": "3365011"}, {"introduction": "LDG框架的强大之处远不止于解决线性问题。本练习将演示如何将该方法应用于一个典型的非线性方程——p-拉普拉斯方程。它将引导您完成将非线性弱形式线性化的过程以推导雅可比矩阵，这是使用牛顿法求解最终非线性代数系统的关键一步。[@problem_id:3365012]", "problem": "考虑在单个单元上由 $p$-拉普拉斯算子控制的非线性扩散问题，该问题为构建一个带有辅助变量的局部间断伽辽金（LDG）方法而建立。在物理单元 $K = (0,h) \\subset \\mathbb{R}$（其中 $h  0$）上，引入辅助变量 $q = \\nabla u$，并将 $p$-拉普拉斯方程 $- \\nabla \\cdot \\left(|\\nabla u|^{p-2} \\nabla u \\right) = f$（其中 $p  1$）重写为以下一阶系统：\n$q - \\nabla u = 0$ 和 $- \\nabla \\cdot \\left( a(q) \\right) = f$，\n其中 $a(q) = |q|^{p-2} q$。设 $V_h$ 和 $W_h$ 分别为 $K$ 上用于标量场和矢量场的1次间断有限元空间。在 $K$ 上，对 $V_h$ 使用以下局部多项式基：\n$\\{\\phi_1(x), \\phi_2(x)\\}$，其中 $\\phi_1(x) = 1 - x/h$ 和 $\\phi_2(x) = x/h$；对 $W_h$ 使用基 $\\{\\psi_1(x), \\psi_2(x)\\}$，其选择方式为在 $K$ 上 $\\psi_i = \\phi_i$。假设 LDG 弱形式是通过对每个一阶方程进行分部积分的标准方法构建的，并在界面上使用相容的数值通量。对于此问题，您必须推导 LDG 残差的牛顿线性化，并确定与非线性通量 $a(q)$ 线性化相关的单元矩阵，仅关注体积贡献，并忽略所有涉及数值通量的边界面项。\n\n从一阶系统和 $K$ 上的 LDG 弱形式定义出发，对当前迭代值 $(u^k, q^k)$ 周围的残差进行牛顿线性化，并推导关于 $(\\delta u, \\delta q)$ 的雅可比矩阵，重点关注非线性通量 $a(q)$ 的线性化。具体来说：\n\n- 在任意空间维度 $d$ 中，推导 $a(q) = |q|^{p-2} q$ 的 Fréchet 导数 $D a(q)$，并用 $q$、$p$ 和单位张量表示。\n\n- 使用牛顿线性化，写出能产生与进入第二个方程 $- \\nabla \\cdot (a(q)) = f$ 的变量 $\\delta q$ 相关的雅可比块的一般单元体积双线性形式，并用 $V_h$ 中的标量测试函数进行检验。\n\n- 将问题特化到使用给定基的一维单元 $K = (0,h)$，并假设在当前牛顿迭代中 $q^k(x) \\equiv q_0$ 在 $K$ 上为常数且 $q_0  0$。在这些假设下，计算单元矩阵 $B^{(K)}$ 的 $(1,1)$ 项，该项对应于雅可比块 $\\partial R_2 / \\partial q$（第二个方程的残差关于 $q$ 的导数）的体积贡献，其中行索引对应标量测试基函数 $\\phi_1$，列索引对应 $q$ 的试探基函数 $\\psi_1$。\n\n您的最终答案必须是关于 $p$ 和 $q_0$ 的单一闭式解析表达式。不需要数值近似。最终答案请勿包含单位。", "solution": "该问题要求推导在单个单元上对 $p$-拉普拉斯方程的局部间断伽辽金（LDG）公式进行牛顿线性化所产生的雅可比矩阵的一个特定项。我们将首先建立弱形式及其线性化，然后推导非线性通量的一般 Fréchet 导数，最后在给定假设下计算该特定矩阵项。\n\n通过引入辅助变量 $q = \\nabla u$，控制方程 $- \\nabla \\cdot (|\\nabla u|^{p-2} \\nabla u) = f$ 被重写为以下一阶系统：\n$$q - \\nabla u = 0$$\n$$-\\nabla \\cdot a(q) = f$$\n其中 $a(q) = |q|^{p-2} q$ 且 $p  1$。\n\n单个单元 $K$ 上的 LDG 弱形式是通过将每个方程乘以一个合适的测试函数并在 $K$ 上积分来构建的。题目要求忽略所有由分部积分产生的边界面项。\n设 $u_h \\in V_h$ 和 $q_h \\in W_h$ 分别是 $u$ 和 $q$ 的有限元近似。对于测试函数 $v_h \\in V_h$ 和 $w_h \\in W_h$，弱形式的体积分部分为：\n1. $\\int_K (q_h - \\nabla u_h) \\cdot w_h \\, dx = 0$\n2. $\\int_K a(q_h) \\cdot \\nabla v_h \\, dx = \\int_K f v_h \\, dx$\n\n牛顿法通过对当前近似 $(u^k, q^k)$ 迭代地寻找修正量 $(\\delta u, \\delta q)$ 来求解非线性系统。我们围绕 $(u^k, q^k)$ 对残差方程组进行线性化。第二个方程的残差为：\n$$R_2(q_h; v_h) = \\int_K a(q_h) \\cdot \\nabla v_h \\, dx - \\int_K f v_h \\, dx = 0$$\n$R_2$ 关于 $q_h$ 沿着增量 $\\delta q_h$ 方向的线性化由其 Gâteaux 导数给出：\n$$\\langle D_{q_h} R_2(q_h; v_h), \\delta q_h \\rangle = \\lim_{\\epsilon \\to 0} \\frac{R_2(q_h + \\epsilon \\delta q_h; v_h) - R_2(q_h; v_h)}{\\epsilon}$$\n代入 $R_2$ 的定义并将极限移入积分内部，得到：\n$$\\langle D_{q_h} R_2(q_h; v_h), \\delta q_h \\rangle = \\int_K \\left( \\lim_{\\epsilon \\to 0} \\frac{a(q_h + \\epsilon \\delta q_h) - a(q_h)}{\\epsilon} \\right) \\cdot \\nabla v_h \\, dx = \\int_K Da(q_h)[\\delta q_h] \\cdot \\nabla v_h \\, dx$$\n此处，$Da(q_h)[\\delta q_h]$ 是 $a$ 在 $q_h$ 处作用于增量 $\\delta q_h$ 的 Fréchet 导数。\n\n首先，我们在任意空间维度 $d$ 中推导 $a(q) = |q|^{p-2} q$ 的 Fréchet 导数 $Da(q)$。设 $q \\in \\mathbb{R}^d$。$a(q)$ 的第 $i$ 个分量是 $a_i(q) = |q|^{p-2} q_i$。我们计算雅可比矩阵，其分量为 $(Da(q))_{ij} = \\frac{\\partial a_i}{\\partial q_j}$。使用乘法法则和链式法则：\n$$\\frac{\\partial a_i}{\\partial q_j} = \\frac{\\partial}{\\partial q_j} \\left( |q|^{p-2} \\right) q_i + |q|^{p-2} \\frac{\\partial q_i}{\\partial q_j}$$\n$|q|=\\sqrt{q \\cdot q}$ 的导数是 $\\frac{\\partial |q|}{\\partial q_j} = \\frac{q_j}{|q|}$。因此，$\\frac{\\partial}{\\partial q_j}(|q|^{p-2}) = (p-2)|q|^{p-3} \\frac{q_j}{|q|} = (p-2)|q|^{p-4} q_j$。另外，$\\frac{\\partial q_i}{\\partial q_j} = \\delta_{ij}$（克罗内克符号）。综合这些结果：\n$$\\frac{\\partial a_i}{\\partial q_j} = (p-2)|q|^{p-4} q_j q_i + |q|^{p-2} \\delta_{ij}$$\n在无坐标的张量表示法中，结果为：\n$$Da(q) = (p-2)|q|^{p-4} (q \\otimes q) + |q|^{p-2} I$$\n其中 $I$ 是单位张量，$(q \\otimes q)$ 是 $q$ 与自身的外积。\n\n雅可比块 $\\partial R_2 / \\partial q$ 的一般单元体积双线性形式是通过将此导数代入线性化的弱形式得到的。设 $q^k$ 为当前牛顿迭代值。作用于增量 $\\delta q$ 和测试函数 $v$ 的双线性形式为：\n$$B(q^k; \\delta q, v) = \\int_K Da(q^k)[\\delta q] \\cdot \\nabla v \\, dx = \\int_K \\left( (p-2)|q^k|^{p-4} (q^k \\cdot \\delta q) q^k + |q^k|^{p-2} \\delta q \\right) \\cdot \\nabla v \\, dx$$\n\n现在，我们特化到一维单元 $K = (0,h)$。在一维情况下，$q$ 是一个标量，矢量变为标量，点积变为标准乘法，张量 $Da(q)$ 变为标量导数 $a'(q)$。对于标量 $q \\neq 0$，$a(q) = |q|^{p-2} q$。题目要求假设当前迭代值是一个常数 $q^k(x) = q_0  0$。对于 $q  0$，我们有 $|q|=q$，所以 $a(q) = q^{p-1}$。其导数为：\n$$a'(q) = (p-1)q^{p-2}$$\n这与 $q0$ 时特化到 $d=1$ 的一般 $d$ 维公式是一致的，因为 $Da(q)[\\delta q] = ((p-2)q^{p-4}q^2 + q^{p-2})\\delta q = (p-1)q^{p-2}\\delta q$。\n因此，来自体积积分的雅可比贡献由矩阵 $B^{(K)}$ 给出，其各项为：\n$$B^{(K)}_{ij} = \\int_K a'(q^k(x)) \\psi_j(x) \\nabla\\phi_i(x) \\, dx$$\n其中 $\\phi_i$ 是来自 $V_h$ 的测试基函数，$\\psi_j$ 是来自 $W_h$ 的增量 $\\delta q$ 的试探基函数。\n\n我们需要计算 $B^{(K)}_{11}$ 项。这对应于测试函数 $\\phi_1$ 和试探函数 $\\psi_1$。\n给定的基是 $\\phi_1(x) = 1 - x/h$ 和 $\\psi_1(x) = \\phi_1(x) = 1 - x/h$。测试函数的导数是 $\\nabla\\phi_1(x) = \\frac{d}{dx}(1 - x/h) = -1/h$。在 $q^k(x) = q_0  0$ 的假设下，非线性通量的导数是常数 $a'(q_0) = (p-1)q_0^{p-2}$。\n\n我们现在计算 $B^{(K)}_{11}$ 的积分：\n$$B^{(K)}_{11} = \\int_0^h a'(q_0) \\psi_1(x) \\nabla\\phi_1(x) \\, dx$$\n$$B^{(K)}_{11} = \\int_0^h (p-1)q_0^{p-2} \\left(1 - \\frac{x}{h}\\right) \\left(-\\frac{1}{h}\\right) \\, dx$$\n由于 $(p-1)q_0^{p-2}$ 和 $-1/h$ 是常数，我们可以将它们提取出来：\n$$B^{(K)}_{11} = -(p-1)q_0^{p-2} \\frac{1}{h} \\int_0^h \\left(1 - \\frac{x}{h}\\right) \\, dx$$\n剩余的积分计算结果为：\n$$\\int_0^h \\left(1 - \\frac{x}{h}\\right) \\, dx = \\left[x - \\frac{x^2}{2h}\\right]_0^h = \\left(h - \\frac{h^2}{2h}\\right) - (0) = h - \\frac{h}{2} = \\frac{h}{2}$$\n将此结果代回 $B^{(K)}_{11}$ 的表达式中：\n$$B^{(K)}_{11} = -(p-1)q_0^{p-2} \\frac{1}{h} \\left(\\frac{h}{2}\\right) = -\\frac{1}{2}(p-1)q_0^{p-2}$$\n这就是来自非线性体积项的单元雅可比矩阵贡献的 $(1,1)$ 项的最终表达式。", "answer": "$$\\boxed{-\\frac{p-1}{2} q_0^{p-2}}$$", "id": "3365012"}]}