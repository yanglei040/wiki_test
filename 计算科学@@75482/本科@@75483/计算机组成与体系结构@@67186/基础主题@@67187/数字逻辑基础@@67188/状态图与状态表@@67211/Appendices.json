{"hands_on_practices": [{"introduction": "计数器是时序电路最基本的应用之一。本练习将指导你设计一个同步模5计数器，这是数字系统中的一个常见构件。你将练习如何将一个简单的计数序列转化为状态转换表，并由此推导出JK触发器所需的逻辑表达式，同时重点学习如何利用无关项来简化逻辑。", "problem": "一位数字系统工程师的任务是设计一个同步模5计数器。该计数器需要按照一个标准二进制序列进行循环计数（0, 1, 2, 3, 4，然后从0开始重复）。该设计将使用三个JK触发器来实现，其输出指定为状态变量 $Q_2, Q_1, Q_0$，其中 $Q_2$ 是最高有效位 (MSB)。为了逻辑化简，3位空间中的任何未使用状态都可以被视为无关项。\n\n您的任务是确定每个触发器的J和K输入的化简布尔逻辑表达式集。请从以下选项中选择正确的一组表达式。\n\nA. $J_2 = Q_1, K_2 = Q_1; \\quad J_1 = Q_0, K_1 = Q_0; \\quad J_0 = 1, K_0 = 1$\n\nB. $J_2 = Q_1 Q_0, K_2 = Q_2; \\quad J_1 = Q_0, K_1 = Q_0; \\quad J_0 = \\overline{Q_2}, K_0 = 1$\n\nC. $J_2 = Q_1 Q_0, K_2 = 1; \\quad J_1 = Q_0, K_1 = Q_0; \\quad J_0 = \\overline{Q_2}, K_0 = 1$\n\nD. $J_2 = 1, K_2 = Q_1 Q_0; \\quad J_1 = Q_0, K_1 = Q_0; \\quad J_0 = 1, K_0 = \\overline{Q_2}$\n\nE. $J_2 = \\overline{Q_2}Q_1Q_0, K_2 = Q_2; \\quad J_1 = \\overline{Q_1}Q_0, K_1 = \\overline{Q_2}Q_0; \\quad J_0 = \\overline{Q_2}\\overline{Q_0}, K_0 = 1$", "solution": "我们正在设计一个使用三个JK触发器的同步模5计数器，其状态变量为 $Q_2$ (MSB)、$Q_1$ 和 $Q_0$。期望的标准二进制计数序列是 $000 \\to 001 \\to 010 \\to 011 \\to 100 \\to 000$。未使用状态 $101,110,111$被视为无关项以简化逻辑。\n\n对于一个JK触发器，从现态 $Q$ 到次态 $Q^{+}$ 的激励要求如下：\n- $0 \\to 0$：$J=0$，$K=$ 无关项。\n- $0 \\to 1$：$J=1$，$K=$ 无关项。\n- $1 \\to 0$：$J=$ 无关项，$K=1$。\n- $1 \\to 1$：$J=$ 无关项，$K=0$。\n\n等效地，在化简中允许使用无关项进行赋值，\n$$\nJ = \\overline{Q}Q^{+}, \\qquad K = Q\\overline{Q^{+}},\n$$\n需要理解的是，对于表中不要求 $J$ 或 $K$ 的转换，这些输入在化简中可以被视为无关项。\n\n我们推导每个触发器的输入方程。\n\n1) 对于 $Q_0$：\n根据序列，在使用的现态下，$Q_0$ 的转换如下：\n- $000: 0 \\to 1$，\n- $001: 1 \\to 0$，\n- $010: 0 \\to 1$，\n- $011: 1 \\to 0$，\n- $100: 0 \\to 0$。\n因此，在状态 $000$ 和 $010$ 时需要 $J_0=1$；在状态 $001$ 和 $011$ 时需要 $K_0=1$；在状态 $100$ 时，$J_0=0$ 且 $K_0$ 是无关项。对于所有其他单元（未使用状态），输入均为无关项。\n\n对 $J_0$ 使用无关项进行化简，在 $000$ 和 $010$ 处所需的两个1可以与无关项单元组合，得到化简表达式\n$$\nJ_0 = \\overline{Q}_2.\n$$\n对于 $K_0$，由于在已使用状态中没有 $Q_0:1 \\to 1$ 的转换，我们可以为所有已使用状态选择 $K_0$ 为 $1$（并在无关项状态上也设为 $1$），从而得到最简单的有效选择\n$$\nK_0 = 1.\n$$\n\n2) 对于 $Q_1$：\n根据序列，在已使用状态下，$Q_1$ 的转换如下：\n- $000: 0 \\to 0$，\n- $001: 0 \\to 1$，\n- $010: 1 \\to 1$，\n- $011: 1 \\to 0$，\n- $100: 0 \\to 0$。\n因此，仅在 $001$ 时 $J_1=1$；仅在 $011$ 时 $K_1=1$；在其他地方，根据激励规则，相应的输入为 $0$ 或无关项。观察到现态 $001$ 和 $011$ 正好是 $Q_0=1$ 的情况，我们可以用同一个信号实现这两个激励：\n$$\nJ_1 = Q_0, \\qquad K_1 = Q_0.\n$$\n\n3) 对于 $Q_2$：\n根据序列，在已使用状态下，$Q_2$ 的转换如下：\n- $000: 0 \\to 0$，\n- $001: 0 \\to 0$，\n- $010: 0 \\to 0$，\n- $011: 0 \\to 1$，\n- $100: 1 \\to 0$。\n因此，仅在 $011$ 时 $J_2=1$，这正好是条件 $Q_1Q_0=1$，所以\n$$\nJ_2 = Q_1Q_0.\n$$\n对于 $K_2$，唯一需要的1是在状态 $100$（$1 \\to 0$ 转换）。所有其他已使用状态都允许将 $K_2$ 视为无关项。因此，我们可以选择最简单的有效赋值\n$$\nK_2 = 1,\n$$\n因为这满足了在 $100$ 处所需的复位，并且不违反任何已使用的转换（没有 $Q_2:1 \\to 1$ 的已使用情况会强制 $K_2=0$）。\n\n汇总这些结果，化简后的输入方程为\n$$\nJ_2 = Q_1Q_0, \\quad K_2 = 1; \\qquad J_1 = Q_0, \\quad K_1 = Q_0; \\qquad J_0 = \\overline{Q_2}, \\quad K_0 = 1,\n$$\n这与选项C相匹配。", "answer": "$$\\boxed{C}$$", "id": "1947756"}, {"introduction": "除了简单的计数，有限状态机还擅长识别输入数据流中的模式。本实践将挑战你设计一个Mealy型有限状态机，用于检测一个特定的重叠二进制序列“0110”。这个任务要求你仔细定义状态来“记忆”已经接收到的序列片段，并推导出基于当前状态和输入来控制状态转换和输出生成的逻辑。[@problem_id:1938578]", "problem": "需要设计一个时序数字电路，作为一个米利型有限状态机（FSM），用于从一个记为 $X$ 的串行数据输入中检测一个特定的4位序列。每当检测到重叠序列 `0110` 时，FSM应输出 '1'；否则，输出（记为 $Y$）应为 '0'。\n\n该状态机将使用两个JK触发器实现，其输出代表状态变量 $Q_1$ 和 $Q_0$。FSM的四个状态定义如下：\n- 状态A（`initial`）：未检测到目标序列的任何前缀。\n- 状态B（看到`0`）：最后一个输入是 `0`。\n- 状态C（看到`01`）：最后两个输入是 `01`。\n- 状态D（看到`011`）：最后三个输入是 `011`。\n\n状态分配如下：状态A = `00`，状态B = `01`，状态C = `10`，状态D = `11`，其中状态由二进制值 $Q_1Q_0$ 表示。\n\n您的任务是确定对应于状态变量 $Q_1$ 的触发器的输入 $J_1$ 和 $K_1$ 的化简“积之和”(SOP)表达式。从以下选项中选择正确的表达式对。\n\nA. $J_1 = Q_0 X; K_1 = Q_1(Q_0 + \\overline{X})$\n\nB. $J_1 = \\overline{Q_1}Q_0 X; K_1 = Q_1(Q_0 + \\overline{X})$\n\nC. $J_1 = Q_0 X; K_1 = Q_1(\\overline{Q_0} + \\overline{X})$\n\nD. $J_1 = Q_0 + X; K_1 = Q_1 \\overline{X}$\n\nE. $J_1 = Q_1; K_1 = Q_0 X + \\overline{Q_0} X$", "solution": "FSM跟踪与目标序列0110的前缀相匹配的输入的最长后缀。在状态分配 A=00, B=01, C=10, D=11 和输入 $X$ 的情况下，状态转换如下：\n- 从A (00)：$X=0 \\rightarrow$ B (01)，$X=1 \\rightarrow$ A (00)。\n- 从B (01)：$X=0 \\rightarrow$ B (01)，$X=1 \\rightarrow$ C (10)。\n- 从C (10)：$X=0 \\rightarrow$ B (01)，$X=1 \\rightarrow$ D (11)。\n- 从D (11)：$X=0 \\rightarrow$ B (01) 且 $Y=1$，$X=1 \\rightarrow$ A (00)。\n\n从这些转换中提取 $Q_1^{+}$：\n- A (00)：$X=0 \\Rightarrow Q_1^{+}=0$，$X=1 \\Rightarrow Q_1^{+}=0$。\n- B (01)：$X=0 \\Rightarrow Q_1^{+}=0$，$X=1 \\Rightarrow Q_1^{+}=1$。\n- C (10)：$X=0 \\Rightarrow Q_1^{+}=0$，$X=1 \\Rightarrow Q_1^{+}=1$。\n- D (11)：$X=0 \\Rightarrow Q_1^{+}=0$，$X=1 \\Rightarrow Q_1^{+}=0$。\n\n因此，下一状态位的布尔表达式为\n$$\nQ_1^{+} = X(\\overline{Q_1}Q_0 + Q_1\\overline{Q_0}) = X(Q_1 \\oplus Q_0).\n$$\n\n对于JK触发器，下一状态关系为 $Q^{+} = J\\overline{Q} + \\overline{K}Q$，其激励要求如下：\n- $0\\rightarrow 0$：$J=0$，$K=\\text{d}$，\n- $0\\rightarrow 1$：$J=1$，$K=\\text{d}$，\n- $1\\rightarrow 0$：$J=\\text{d}$，$K=1$，\n- $1\\rightarrow 1$：$J=\\text{d}$，$K=0$。\n\n根据 $Q_1$ 的转换表：\n- 唯一的 $Q_1: 0\\rightarrow 1$ 转换发生在 $(Q_1,Q_0,X)=(0,1,1)$ 时，因此 $J_1$ 的一个主蕴含项是 $\\overline{Q_1}Q_0X$。利用对于所有 $Q_1=1$ 的行，输入 $J_1$ 都是无关项这一事实，我们可以去掉 $\\overline{Q_1}$ 以得到化简的SOP表达式\n$$\nJ_1=Q_0X.\n$$\n- $Q_1: 1\\rightarrow 0$ 的情况发生在 $(Q_1,Q_0,X)=(1,0,0),(1,1,0),(1,1,1)$。这等价于“$Q_1=1$ 并且 ($X=0$ 或 $Q_0=1$)”，从而得到化简的SOP表达式\n$$\nK_1=Q_1(Q_0+\\overline{X}).\n$$\n\n这些输入也满足 $Q_1^{+}=J_1\\overline{Q_1}+\\overline{K_1}Q_1 = X(Q_1\\oplus Q_0)$：\n$$\nQ_1^{+} = (Q_0X)\\overline{Q_1} + \\overline{(Q_1(Q_0+\\overline{X}))}Q_1 = (Q_0X)\\overline{Q_1} + (\\overline{Q_1} + \\overline{Q_0}X)Q_1 = X(Q_0\\overline{Q_1} + \\overline{Q_0}Q_1),\n$$\n这与推导出的 $Q_1^{+}$ 相匹配。因此，正确的选项是\n$$\nJ_1=Q_0X,\\quad K_1=Q_1(Q_0+\\overline{X}).\n$$", "answer": "$$\\boxed{A}$$", "id": "1938578"}, {"introduction": "状态机是现代处理器中控制单元的核心，负责管理复杂的操作和资源共享。这个高级练习将让你扮演一名计算机架构师，设计一个FSM来仲裁两个流水线对共享内存端口的访问。你不仅要设计控制逻辑以执行公平的交替策略，还要通过计算稳态吞吐量来分析其对系统性能的直接影响。[@problem_id:3680680]", "problem": "一个计算机系统包含$2$个独立的执行流水线，标记为$P_{A}$和$P_{B}$，它们共享一个内存端口。每个流水线一旦被授予对端口的访问权限，就可以发出内存请求。在重度内存密集型工作负载下，两个流水线都持续有待处理的请求。该内存端口是非流水线式的，一次处理一个请求，每个请求需要$t_{s}$个周期。当在连续服务的请求之间，被授权的流水线从一个切换到另一个时，上下文重构会产生$t_{o}$个空闲周期的额外开销，在此期间端口无法处理任何请求。\n\n你需要设计一个确定性有限状态机 (FSM)，该状态机在两个流水线都有待处理请求时，通过严格交替来保证公平性：如果两个流水线队列中都有请求，FSM 将交替授权$P_{A}, P_{B}, P_{A}, P_{B}, \\dots$；如果只有一个流水线有待处理请求，FSM 将继续授权该流水线，而不会产生切换开销。定义二进制输入$r_{A}$和$r_{B}$来表示$P_{A}$或$P_{B}$是否有待处理请求（$1$表示有，$0$表示空），以及二进制输出$g_{A}$和$g_{B}$来表示对$P_{A}$或$P_{B}$的授权（$1$表示授权，$0$表示未授权）。让 FSM 使用最小数量的状态，并包含任何必要的瞬时状态来模拟流水线切换时的重构开销。\n\n给定具体参数$t_{s} = 2$和$t_{o} = 1$，并假设在$r_{A} = 1$和$r_{B} = 1$始终成立的重度竞争情况下，根据第一性原理推导出最小 FSM 状态集、其在上述规则下的状态转换行为和输出行为，并计算在此竞争和交替策略下内存端口的稳态吞吐量（以每周期请求数为单位）。将最终吞吐量表示为每周期请求数的精确有理数（不要求四舍五入）。", "solution": "任务是设计一个有限状态机 (FSM) 来仲裁对共享内存端口的访问，然后计算其在重度竞争下的稳态吞吐量。系统有两个流水线$P_{A}$和$P_{B}$，请求信号为$r_{A}$和$r_{B}$，授权信号为$g_{A}$和$g_{B}$。一个内存请求需要$t_{s} = 2$个周期来服务。流水线之间的切换会产生$t_{o} = 1$个空闲周期的开销。\n\n为了设计 FSM，我们必须创建一组状态，以捕捉服务周期和开销周期的时间特性。在这里，摩尔机 (Moore machine) 模型是合适的，其输出是当前状态的函数。状态不仅必须表示哪个流水线正在被服务，还必须表示在多周期服务或开销周期内的进度。要求使用最小数量的状态集。\n\n让我们定义状态如下：\n- $S_{IDLE}$：端口空闲，没有请求在被服务。输出：$(g_{A}, g_{B}) = (0, 0)$。\n- $S_{A1}$：为流水线$P_{A}$提供服务的$2$周期中的第一个周期。输出：$(g_{A}, g_{B}) = (1, 0)$。\n- $S_{A2}$：为流水线$P_{A}$提供服务的$2$周期中的第二个周期。输出：$(g_{A}, g_{B}) = (1, 0)$。\n- $S_{B1}$：为流水线$P_{B}$提供服务的$2$周期中的第一个周期。输出：$(g_{A}, g_{B}) = (0, 1)$。\n- $S_{B2}$：为流水线$P_{B}$提供服务的$2$周期中的第二个周期。输出：$(g_{A}, g_{B}) = (0, 1)$。\n- $S_{O \\to A}$：从$P_{B}$切换到$P_{A}$时的$1$周期开销期。输出：$(g_{A}, g_{B}) = (0, 0)$。\n- $S_{O \\to B}$：从$P_{A}$切换到$P_{B}$时的$1$周期开销期。输出：$(g_{A}, g_{B}) = (0, 0)$。\n\n对于一个摩尔机来说，这组$7$个状态是最小的，因为服务状态和开销状态代表了序列中不同的时间点，不能合并。两个开销状态$S_{O \\to A}$和$S_{O \\to B}$是必要的，因为尽管它们的输出相同，但它们的无条件下一状态是不同的（分别为$S_{A1}$和$S_{B1}$）。同样地，$S_{IDLE}$与开销状态不同，因为它基于新请求的条件转移逻辑。\n\n状态转移逻辑如下：\n- 从$S_{IDLE}$开始：如果没有请求 ($(r_{A}, r_{B})=(0,0)$)，则保持在$S_{IDLE}$状态。如果只有一个流水线有请求，则开始为其服务（对于$(1,0)$转移到$S_{A1}$，对于$(0,1)$转移到$S_{B1}$）。如果两者都有请求 ($(1,1)$)，我们必须开始交替序列。按照惯例，我们从$P_{A}$开始，转移到$S_{A1}$。\n- 在为$P_{A}$（$S_{A1}$，$S_{A2}$）或$P_{B}$（$S_{B1}$，$S_{B2}$）服务期间，FSM 无条件地推进服务周期。$S_{A1} \\to S_{A2}$ 和 $S_{B1} \\to S_{B2}$。这些转移与输入$r_A, r_B$无关，因为服务一旦开始，就不能被抢占。\n- 服务完成后（从$S_{A2}$或$S_{B2}$），FSM 检查请求输入。\n- 从$S_{A2}$开始：如果只有$P_{A}$有请求 ($(r_{A}, r_{B})=(1,0)$)，我们可以通过转移到$S_{A1}$立即为$P_{A}$开始新的服务，从而避免开销。如果$P_{B}$有请求 ($(r_{A}, r_{B})=(0,1)$ 或 $(1,1)$)，则需要切换，因此我们转移到开销状态$S_{O \\to B}$。在竞争 ($(1,1)$) 下的严格交替策略强制要求进行此切换。如果没有请求 ($(0,0)$)，我们转移到$S_{IDLE}$。\n- 从$S_{B2}$开始：对称地，如果只有$P_{B}$有请求 ($(0,1)$)，我们循环回到$S_{B1}$。如果$P_{A}$有请求 ($(1,0)$ 或 $(1,1)$)，我们必须切换，因此转移到$S_{O \\to A}$。如果没有剩余请求 ($(0,0)$)，我们转到$S_{IDLE}$。\n- 从开销状态（$S_{O \\to A}$或$S_{O \\to B}$）开始，无条件地转移到目标流水线服务的开始状态。$S_{O \\to A} \\to S_{A1}$ 和 $S_{O \\to B} \\to S_{B1}$。\n\n现在我们分析重度竞争的特定情况，即$r_{A} = 1$和$r_{B} = 1$始终成立。FSM 将在一个闭环中运行，强制执行严格交替。让我们追踪状态序列。假设循环在对$P_{B}$的服务刚结束后开始。\n1.  当前状态：$S_{B2}$。输入为$(r_{A}, r_{B})=(1,1)$。由于$P_{A}$有待处理请求并且强制执行交替，因此必须进行切换。FSM 转移到开销状态$S_{O \\to A}$。\n2.  状态$S_{O \\to A}$：此状态持续$t_{o} = 1$个周期。授权输出为$(g_{A}, g_{B}) = (0, 0)$。FSM 无条件转移到$S_{A1}$。\n3.  状态$S_{A1}$：这是为$P_{A}$服务的第一个周期。它持续$1$个周期。输出为$(1, 0)$。FSM 无条件转移到$S_{A2}$。\n4.  状态$S_{A2}$：这是为$P_{A}$服务的第二个也是最后一个周期。它持续$1$个周期。输出为$(1, 0)$。为$P_{A}$的服务总共需要$t_{s} = 2$个周期。在此状态结束时，FSM 检查输入。由于$(r_{A}, r_{B})=(1,1)$，它必须切换到$P_{B}$，转移到$S_{O \\to B}$。\n5.  状态$S_{O \\to B}$：此开销状态持续$t_{o} = 1$个周期。输出为$(0, 0)$。FSM 无条件转移到$S_{B1}$。\n6.  状态$S_{B1}$：为$P_{B}$服务的第一个周期。它持续$1$个周期。输出为$(0, 1)$。FSM 无条件转移到$S_{B2}$。\n7.  状态$S_{B2}$：为$P_{B}$服务的第二个周期。它持续$1$个周期。输出为$(0, 1)$。为$P_{B}$的服务现已完成（总共$t_s = 2$个周期）。FSM 检查输入$(1,1)$并转移回$S_{O \\to A}$，完成整个交替循环。\n\n稳态下的状态循环是 $S_{O \\to A} \\to S_{A1} \\to S_{A2} \\to S_{O \\to B} \\to S_{B1} \\to S_{B2} \\to S_{O \\to A}$。\n一个完整循环的总周期数是这些状态持续时间的总和：\n总周期数 = $1$ (用于 $S_{O \\to A}$) + $1$ (用于 $S_{A1}$) + $1$ (用于 $S_{A2}$) + $1$ (用于 $S_{O \\to B}$) + $1$ (用于 $S_{B1}$) + $1$ (用于 $S_{B2}$) = $6$ 个周期。\n\n在这个$6$周期的循环中，有两个请求被完全服务：一个用于$P_{A}$（在$S_{A1}, S_{A2}$期间）和一个用于$P_{B}$（在$S_{B1}, S_{B2}$期间）。\n\n吞吐量定义为每周期服务的请求数。\n吞吐量 = $\\frac{\\text{Total Requests Serviced}}{\\text{Total Cycles}}$\n吞吐量 = $\\frac{2}{6} = \\frac{1}{3}$ 请求/周期。\n\n这可以被推广。服务$2$个请求的总时间 $= t_{s} + t_{o} + t_{s} + t_{o} = 2(t_{s} + t_{o})$。\n吞吐量 = $\\frac{2}{2(t_s+t_o)} = \\frac{1}{t_s+t_o}$。\n使用给定值$t_s=2$和$t_o=1$：\n吞吐量 = $\\frac{1}{2+1} = \\frac{1}{3}$ 请求/周期。\n结果是一致的。", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "3680680"}]}