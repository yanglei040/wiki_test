{"hands_on_practices": [{"introduction": "RAID 的核心承诺是数据保护，但不同级别提供的保护程度差异巨大。本练习通过一个具体的灾难场景——两块磁盘同时发生故障——来帮助你超越简单的定义。通过系统地分析 RAID 1、RAID 5、RAID 6 和 RAID 10 在此情景下的结果 ([@problem_id:3675057])，你将对“单容错”与“双容错”在实践中的真正含义有更深刻的理解，并巩固对每种 RAID 级别核心价值与局限性的认识。", "problem": "一位管理员必须为不同的服务在四种独立磁盘冗余阵列 (RAID) 配置中做出选择。假设磁盘故障是独立的，且控制器是理想的，能够实现每个级别的标准奇偶校验和镜像语义，没有潜在的扇区错误，并且在重建过程中没有进一步的故障。对于下面的每种配置，假设恰好有 $f=2$ 个物理磁盘同时发生故障。将一种配置的故障矩阵定义为：从未排序的故障磁盘对到两种结果之一的映射：可恢复（所有逻辑数据块都可以被重建）或不可恢复（某些逻辑数据块无法被重建）。仅使用关于镜像和奇偶校验的基本原理，确定每种配置下不可恢复的双磁盘故障对的数量 $N_{\\mathrm{I}}$，以及在可恢复的情况下重建是否可行。\n\n- 配置 $\\mathcal{R}_1$：在2个磁盘上的RAID $1$（纯镜像）。\n- 配置 $\\mathcal{R}_5$：在7个磁盘上的RAID $5$，每个条带具有分布式单奇偶校验。\n- 配置 $\\mathcal{R}_6$：在8个磁盘上的RAID $6$，每个条带具有双独立奇偶校验。\n- 配置 $\\mathcal{R}_{10}$：在8个磁盘上的RAID $10$，组织为4个镜像对，并在这些镜像对之间进行条带化。\n\n哪个选项正确地描述了计数 $N_{\\mathrm{I}}(\\mathcal{R}_1)$、$N_{\\mathrm{I}}(\\mathcal{R}_5)$、$N_{\\mathrm{I}}(\\mathcal{R}_6)$、$N_{\\mathrm{I}}(\\mathcal{R}_{10})$ 以及关于重建可行性的陈述？\n\nA. $N_{\\mathrm{I}}(\\mathcal{R}_1)=1$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=21$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=4$。在所有可恢复的情况下，通过从幸存的镜像复制或求解奇偶校验方程，重建是可行的，且不会丢失数据。\n\nB. $N_{\\mathrm{I}}(\\mathcal{R}_1)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=15$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=6$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=28$。即使奇偶校验可用，在 RAID 6 中重建也是不可行的。\n\nC. $N_{\\mathrm{I}}(\\mathcal{R}_1)=1$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=4$。RAID 5 可以使用分布式奇偶校验恢复两个同时发生的故障。\n\nD. $N_{\\mathrm{I}}(\\mathcal{R}_1)=1$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=21$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=12$。只要两个故障磁盘位于同一个条带集中，即使它们来自不同的镜像对，RAID 10 也会遭受不可恢复的损失。", "solution": "在尝试任何解决方案之前，用户提供的问题都经过了严格的验证。\n\n### 步骤 1：提取已知条件\n- **任务**：对于四种指定的 RAID 配置，确定不可恢复的双磁盘故障对的数量，记为 $N_{\\mathrm{I}}$。\n- **假设**：\n    - 恰好有 $f=2$ 个物理磁盘同时发生故障。\n    - 磁盘故障是独立的。\n    - 控制器是理想的，并实现标准的 RAID 语义。\n    - 没有潜在的扇区错误。\n    - 在重建过程中没有进一步的故障。\n- **定义**：\n    - **可恢复**：所有逻辑数据块都可以被重建。\n    - **不可恢复**：某些逻辑数据块无法被重建。\n- **配置**：\n    - $\\mathcal{R}_1$：在2个磁盘上的RAID $1$（纯镜像）。\n    - $\\mathcal{R}_5$：在7个磁盘上的RAID $5$（分布式单奇偶校验）。\n    - $\\mathcal{R}_6$：在8个磁盘上的RAID $6$（双独立奇偶校验）。\n    - $\\mathcal{R}_{10}$：在8个磁盘上的RAID $10$，组织为4个镜像对，并在这些对之间进行条带化。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题陈述的有效性进行评估。\n- **科学依据**：该问题基于定义明确、标准的 RAID 技术原理，这是计算机系统和操作系统中的一个核心主题。镜像、奇偶校验、条带化和容错等概念是基础且符合事实的。\n- **适定性**：问题定义清晰。它要求在固定的故障条件（$f=2$）下，为四个精确描述的系统配置计算一个特定的、可量化的指标（$N_{\\mathrm{I}}$）。“可恢复”和“不可恢复”这两个术语有明确的定义。可以从基本原理推导出唯一的解。\n- **客观性**：问题以精确的技术语言陈述，没有主观性或模糊性。\n- **结论**：该问题没有违反任何指定的无效性标准。在标准的计算机科学背景下，它是科学合理的、适定的、客观的和自洽的。\n\n### 步骤 3：结论和行动\n该问题是**有效的**。将推导解决方案。\n\n### 推导过程\n不可恢复的双磁盘故障对的数量 $N_{\\mathrm{I}}$，是通过对每种配置应用该 RAID 级别数据冗余的基本原理来确定的。从 $n$ 个磁盘中选择 $2$ 个发生故障的总方式数由二项式系数 $\\binom{n}{2} = \\frac{n(n-1)}{2}$ 给出。\n\n**配置 $\\mathcal{R}_1$：在 $n=2$ 个磁盘上的 RAID $1$**\n- 具有2个磁盘的 RAID $1$ 包括一个磁盘是另一个磁盘的精确镜像。磁盘1上的所有数据都复制到磁盘2上。\n- 磁盘总数为 $n=2$。\n- 不同的双磁盘故障组合总数为 $\\binom{2}{2} = 1$。\n- 这唯一的组合涉及阵列中两个磁盘都发生故障。由于数据的两个副本都丢失了，因此无法重建。该故障是不可恢复的。\n- 因此，不可恢复的磁盘对数量为 $N_{\\mathrm{I}}(\\mathcal{R}_1) = 1$。\n\n**配置 $\\mathcal{R}_5$：在 $n=7$ 个磁盘上的 RAID $5$**\n- RAID 5 将数据条带化到 $n-1=6$ 个磁盘上，并为每个条带在剩余的磁盘上存储一个奇偶校验块。该奇偶校验块是该条带中数据块的异或和。\n- 这个单一的奇偶校验信息允许从一个条带中恰好一个发生故障的磁盘重建数据。对于一个包含数据块 $D_1, \\dots, D_6$ 和奇偶校验 $P = D_1 \\oplus \\dots \\oplus D_6$ 的条带，任何单个块（例如 $D_i$）的丢失都可以通过对其余块进行异或运算来恢复。\n- 如果两个磁盘发生故障，则在给定的条带中会丢失两个块（例如 $D_i$ 和 $D_j$）。这会留下一个包含两个未知数的方程（$D_i \\oplus D_j = \\text{已知值}$），该方程无法唯一求解。\n- 在 RAID 5 阵列中，数据被条带化，使得任何一对磁盘都会包含属于同一条带的块。因此，任何两个磁盘的故障都会导致至少一个条带无法恢复，从而导致数据丢失。\n- 磁盘总数为 $n=7$。\n- 双磁盘故障组合的总数为 $\\binom{7}{2} = \\frac{7 \\times 6}{2} = 21$。\n- 由于在 RAID 5 中任何双磁盘故障都是不可恢复的，因此所有 21 种组合都会导致数据丢失。\n- 因此，不可恢复的磁盘对数量为 $N_{\\mathrm{I}}(\\mathcal{R}_5) = 21$。\n\n**配置 $\\mathcal{R}_6$：在 $n=8$ 个磁盘上的 RAID $6$**\n- RAID 6 是 RAID 5 的扩展，通过为每个条带添加第二个独立的奇偶校验块，专门用于防止双磁盘故障。一个条带由 $n-2=6$ 个数据块和 $2$ 个奇偶校验块组成。\n- 两种奇偶校验方案（例如 $P$ 和 $Q$）为条带中的块提供了一个由两个独立线性方程组成的系统。例如，$P = \\bigoplus D_i$ 和 $Q = \\bigoplus g^i D_i$（使用伽罗瓦域中的运算，这是一种标准实现）。\n- 如果任意两个磁盘发生故障，每个受影响的条带中会丢失两个块。剩余的块和两个奇偶校验方程构成一个包含两个未知数的两个方程的可解系统。这允许唯一地重建两个丢失的块。\n- 无论发生故障的磁盘是存储数据还是奇偶校验，这种保护对任何一对故障磁盘都有效。\n- 磁盘总数为 $n=8$。\n- 双磁盘故障组合的总数为 $\\binom{8}{2} = \\frac{8 \\times 7}{2} = 28$。\n- 由于 RAID 6 设计用于承受任何双磁盘故障，因此所有 28 种组合都是可恢复的。\n- 因此，不可恢复的磁盘对数量为 $N_{\\mathrm{I}}(\\mathcal{R}_6) = 0$。\n\n**配置 $\\mathcal{R}_{10}$：在 $n=8$ 个磁盘上的 RAID $10$**\n- 此配置是镜像条带（RAID 1+0）。有 4 个镜像对，数据在这些镜像对之间进行条带化。设这些对为 $(D_{1A}, D_{1B})$、$(D_{2A}, D_{2B})$、$(D_{3A}, D_{3B})$ 和 $(D_{4A}, D_{4B})$。\n- 只要每个镜像对中至少有一个磁盘保持运行，数据就是可恢复的。\n- 当且仅当单个镜像对中的两个磁盘同时发生故障时，才会发生不可恢复的故障。这是因为存储在该对上的所有数据都将丢失，并且由于数据在所有对之间进行条带化，整个逻辑卷都会受损。\n- 导致不可恢复数据丢失的同时故障对恰好是这 4 个镜像对：$(D_{1A}, D_{1B})$、$(D_{2A}, D_{2B})$、$(D_{3A}, D_{3B})$ 和 $(D_{4A}, D_{4B})$。\n- 磁盘总数为 $n=8$。双磁盘故障组合的总数为 $\\binom{8}{2} = 28$。\n- 不可恢复的组合数量就是镜像对的数量，即 4。\n- 因此，不可恢复的磁盘对数量为 $N_{\\mathrm{I}}(\\mathcal{R}_{10}) = 4$。\n\n**重建可行性**\n问题询问在可恢复的情况下重建是否可行。\n- 对于 $\\mathcal{R}_1$ 和 $\\mathcal{R}_5$，双磁盘故障没有可恢复的情况，因此关于它们的任何陈述都是空真命题。\n- 对于 $\\mathcal{R}_6$，所有 28 种双磁盘故障情况都是可恢复的。通过为每个条带求解两个奇偶校验方程，重建是可行的。\n- 对于 $\\mathcal{R}_{10}$，有 $28 - 4 = 24$ 种可恢复的双磁盘故障情况。在这些情况下，发生故障的磁盘属于不同的镜像对。通过简单地从每个受影响的对的幸存成员复制数据，重建是可行的。\n- 因此，“在所有可恢复的情况下，重建是可行的……”这一一般性断言是正确的。\n\n### 结果摘要\n- $N_{\\mathrm{I}}(\\mathcal{R}_1) = 1$\n- $N_{\\mathrm{I}}(\\mathcal{R}_5) = 21$\n- $N_{\\mathrm{I}}(\\mathcal{R}_6) = 0$\n- $N_{\\mathrm{I}}(\\mathcal{R}_{10}) = 4$\n- 在所有可恢复的情况下，重建都是可行的，可以通过奇偶校验计算或镜像来实现。\n\n### 逐项分析\n\n**A. $N_{\\mathrm{I}}(\\mathcal{R}_1)=1$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=21$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=4$。在所有可恢复的情况下，通过从幸存的镜像复制或求解奇偶校验方程，重建是可行的，且不会丢失数据。**\n- 计算出的值 $N_{\\mathrm{I}}(\\mathcal{R}_1)=1$、$N_{\\mathrm{I}}(\\mathcal{R}_5)=21$、$N_{\\mathrm{I}}(\\mathcal{R}_6)=0$ 和 $N_{\\mathrm{I}}(\\mathcal{R}_{10})=4$ 都与我们推导的结果相符。\n- 关于重建可行性的陈述也与我们的分析一致。\n- **结论：正确。**\n\n**B. $N_{\\mathrm{I}}(\\mathcal{R}_1)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=15$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=6$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=28$。即使奇偶校验可用，在 RAID 6 中重建也是不可行的。**\n- $N_{\\mathrm{I}}(\\mathcal{R}_1)=0$ 是错误的。我们的结果是 $1$。\n- $N_{\\mathrm{I}}(\\mathcal{R}_5)=15$ 是错误的。我们的结果是 $21$。\n- $N_{\\mathrm{I}}(\\mathcal{R}_6)=6$ 是错误的。我们的结果是 $0$。\n- $N_{\\mathrm{I}}(\\mathcal{R}_{10})=28$ 是错误的。我们的结果是 $4$。（$28$ 是总的磁盘对数）。\n- 陈述“在 RAID 6 中重建是不可行的”是根本错误的；这正是 RAID 6 双奇偶校验的主要目的。\n- **结论：错误。**\n\n**C. $N_{\\mathrm{I}}(\\mathcal{R}_1)=1$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=4$。RAID 5 可以使用分布式奇偶校验恢复两个同时发生的故障。**\n- $N_{\\mathrm{I}}(\\mathcal{R}_5)=0$ 是错误的。我们的结果是 $21$。\n- 附带的陈述“RAID 5 可以恢复两个同时发生的故障”直接违背了单奇偶校验 RAID 的原理。\n- **结论：错误。**\n\n**D. $N_{\\mathrm{I}}(\\mathcal{R}_1)=1$，$N_{\\mathrm{I}}(\\mathcal{R}_5)=21$，$N_{\\mathrm{I}}(\\mathcal{R}_6)=0$，$N_{\\mathrm{I}}(\\mathcal{R}_{10})=12$。只要两个故障磁盘位于同一个条带集中，即使它们来自不同的镜像对，RAID 10 也会遭受不可恢复的损失。**\n- $N_{\\mathrm{I}}(\\mathcal{R}_{10})=12$ 是错误的。我们的结果是 $4$。\n- 关于 RAID 10 故障的陈述是错误的。来自不同镜像对的两个磁盘的故障是*可恢复的*，因为每个故障磁盘的镜像仍然可用。该陈述描述了相反的情况。\n- **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "3675057"}, {"introduction": "RAID 6 提供了出色的数据保护，但其配置如何影响其他系统属性呢？本练习探讨了 RAID 6 阵列中磁盘数量、其空间效率以及相关操作风险之间的关系。这个练习将向你展示工程决策的本质是权衡取舍：虽然在 RAID 6 阵列中增加更多磁盘可以提高空间效率，但它也会延长系统处于脆弱状态的重建时间，并增加在重建过程中遇到不可纠正读取错误 (URE) 的风险 ([@problem_id:3671506])。这个计算练习将理论上的效率与现实世界的系统可靠性联系了起来。", "problem": "一个存储子系统将构建为一个由 $n$ 个相同磁盘组成的单一冗余磁盘阵列（RAID）级别 $6$ 组，每个磁盘的原始容量为 $C$。容量效率定义为最大可寻址数据容量（扣除冗余开销后）与总原始容量的比率 $\\eta$。对于 RAID 级别 $6$，在整个阵列中维护双重奇偶校验，其消耗的冗余开销等于分布在各个条带上的两个磁盘的容量。\n\n仅从这些核心定义出发，推导出 $\\eta$ 作为 $n$ 的函数，并确定使 $\\eta \\geq 0.8$ 成立的最小整数 $n$。最终答案应为 $n$ 的最小整数值。无需四舍五入。\n\n然后，利用经过充分测试的系统级事实——即单盘故障后的重建必须从所有幸存磁盘中读取数据并写入一个替换磁盘，以及不可纠正读取错误（URE）是一个低概率的按比特独立发生的事件，其发生率为每比特 $r$——简要定性地解释，在假设单个磁盘容量 $C$ 和单个磁盘带宽相似的情况下，增加 $n$ 如何影响 (i) 预期的重建时间以及 (ii) 在重建过程中遇到至少一个 URE 的概率。您的定性讨论不影响您报告的数值答案。", "solution": "所述问题是有效的。它在科学上基于计算机存储架构的原理，特别是冗余磁盘阵列（RAID）。所提供的定义和参数是一致、完整且适定的，可以得出一个唯一且有意义的解。该问题是客观且可形式化的。\n\n我们首先推导 RAID 级别 $6$ 阵列的容量效率 $\\eta$ 的表达式。\n\n存储子系统的总原始容量是所有单个磁盘容量的总和。给定 $n$ 个相同的磁盘，每个磁盘的原始容量为 $C$，则总原始容量 $C_{total}$ 为：\n$$C_{total} = nC$$\n\n问题指出，对于 RAID 级别 $6$，维护双重奇偶校验，其冗余开销等于两个磁盘的容量。此开销 $C_{overhead}$ 从总原始容量中减去，以确定最大可寻址数据容量 $C_{data}$。\n$$C_{overhead} = 2C$$\n\n因此，可寻址数据容量为：\n$$C_{data} = C_{total} - C_{overhead} = nC - 2C = (n-2)C$$\n为了使这表示一个具有可用数据容量的系统，隐含条件是 $n > 2$。RAID $6$ 阵列通常所需的最小磁盘数量为 $4$。\n\n容量效率 $\\eta$ 定义为最大可寻址数据容量与总原始容量的比率。\n$$\\eta = \\frac{C_{data}}{C_{total}}$$\n代入 $C_{data}$ 和 $C_{total}$ 的表达式：\n$$\\eta(n) = \\frac{(n-2)C}{nC}$$\n项 $C$ 被消去，得到效率仅作为 $n$ 的函数：\n$$\\eta(n) = \\frac{n-2}{n} = 1 - \\frac{2}{n}$$\n\n接下来，我们必须找到使容量效率 $\\eta$ 大于或等于 $0.8$ 的最小整数 $n$。我们建立不等式：\n$$\\eta(n) \\geq 0.8$$\n$$1 - \\frac{2}{n} \\geq 0.8$$\n两边同时减去 $1$：\n$$-\\frac{2}{n} \\geq 0.8 - 1$$\n$$-\\frac{2}{n} \\geq -0.2$$\n两边同时乘以 $-1$，不等号方向反转：\n$$\\frac{2}{n} \\leq 0.2$$\n由于 $n$ 代表磁盘数量，$n$ 必须是一个正整数。我们可以在不等式两边同时乘以 $n$ 而不改变不等号方向：\n$$2 \\leq 0.2n$$\n除以 $0.2$：\n$$n \\geq \\frac{2}{0.2}$$\n$$n \\geq 10$$\n由于 $n$ 必须是整数，满足此条件的最小整数值 $n$ 是 $10$。\n\n对于定性分析：\n问题规定，单盘故障后的重建需要从所有 $n-1$ 个幸存磁盘中读取数据，以重建故障磁盘的数据（容量为 $C$），并将其写入替换磁盘。\n\n(i) 增加 $n$ 对预期重建时间的影响：\n为了重建单个故障磁盘的数据，RAID 控制器必须从所有 $n-1$ 个幸存磁盘中读取相应的数据/奇偶校验块。因此，必须从磁盘子系统读取的总数据量与 $(n-1)C$ 成正比。随着 $n$ 的增加，重建操作期间必须读取的总数据量也增加。假设系统的整体 I/O 处理能力不随 $n$ 完美扩展，这个更大的数据读取任务会导致完成重建的总时间更长。因此，增加 $n$ 会增加预期的重建时间。\n\n(ii) 增加 $n$ 对重建期间发生不可纠正读取错误（URE）概率的影响：\n不可纠正读取错误（URE）是一个概率性事件，其发生率为每读取一位 $r$。在重建过程中遇到至少一个 URE 的概率 $P(\\text{URE} \\ge 1)$ 是读取的总比特数的函数。如 (i) 中所述，读取的总数据量与 $(n-1)C$ 成正比。设 $N_{bits}$ 为读取的总比特数，因此 $N_{bits} \\propto (n-1)$。发生至少一个错误的概率是 $P(\\text{URE} \\ge 1) = 1 - (1-r)^{N_{bits}}$。对于非常小的 $r$，这可以很好地近似为 $P(\\text{URE} \\ge 1) \\approx N_{bits} \\cdot r$。由于 $N_{bits}$ 随 $n$ 增加而增加，因此在重建期间遇到 URE 的概率也随之增加。在重建期间幸存磁盘上发生 URE，等同于该条带内的第二次故障，这显著增加了数据丢失的风险。因此，增加 $n$ 会增加重建期间发生 URE 的概率。", "answer": "$$\\boxed{10}$$", "id": "3671506"}, {"introduction": "对系统架构师而言，选择合适的 RAID 配置是一项常见任务，需要在容量、性能、可靠性和成本之间取得平衡。这最后一个练习模拟了一个真实的设计挑战。你需要选择一个 RAID 级别并确定阵列大小，以满足特定的容量和耐久性目标 ([@problem_id:3671415])。这个问题要求你综合运用关于不同 RAID 级别特性的知识，包括它们的容量开销以及基于故障率和重建率建模的故障恢复能力，它是一个模拟真实世界基础设施规划中定量分析的综合性练习。", "problem": "一个数据中心必须为一个逻辑卷配置一个基于奇偶校验的独立磁盘冗余阵列 (RAID)，该阵列需提供至少相当于 $m = 10$ 个数据磁盘的可用容量。您可以选择 RAID 级别 $5$ (单奇偶校验) 或 RAID 级别 $6$ (双奇偶校验)。每个磁盘的年化故障率 (AFR) 为 $a = 0.012$ (以每 $1$ 年的小数表示)，阵列重建过程被建模为一个无记忆服务，重建速率为每天 $\\mu = 0.5$。在 $t = 1$ 年内的目标持久性为 $D = 0.99999$ (以小数表示)。您必须确定 RAID 级别以及满足可用容量约束和持久性约束的最小总磁盘数 $n$，假设磁盘故障是独立的且不存在潜在扇区错误。仅报告满足所有约束的最小 $n$ 值。\n\n从以下基本定义和事实开始：\n\n- 对于一个故障呈指数分布、故障率为 $\\lambda$ (每单位时间) 的组件，其在时间 $t$ 内的生存概率为 $R(t) = \\exp(-\\lambda t)$。\n- 年化故障率与故障率的关系为 $a = 1 - \\exp(-\\lambda \\cdot 1~\\text{year})$，因此每年 $\\lambda = -\\ln(1 - a)$。\n- 重建时间是指数服务时间的平均值，$T_{r} = \\frac{1}{\\mu}$，并且必须统一用年表示。\n- 对于 RAID 级别 $5$，如果在第一个故障磁盘的重建完成前第二个磁盘发生故障，则会发生灾难性数据丢失。在小概率、独立指数近似下，将灾难性损失的阵列级风险率建模为第一次故障的发生率与在重建暴露窗口期间发生第二次故障的条件概率的乘积。\n- 对于 RAID 级别 $6$，如果在前两个重建完成前第三个磁盘发生故障，则会发生灾难性数据丢失。在相同的近似下，将灾难性损失的阵列级风险率建模为第一次故障的发生率乘以在第一个暴露窗口期间发生第二次故障的条件概率，再乘以在第二个暴露窗口期间发生第三次故障的条件概率。\n- 平均数据丢失时间 (MTTDL) 定义为阵列级风险率为常数时该风险率的倒数：$\\text{MTTDL} = \\frac{1}{\\alpha}$。\n\n容量约束：\n- RAID 级别 $5$ 的可用容量为 $(n - 1)$ 个磁盘，因此约束为 $(n - 1) \\ge m$。\n- RAID 级别 $6$ 的可用容量为 $(n - 2)$ 个磁盘，因此约束为 $(n - 2) \\ge m$。\n\n持久性约束：\n- 对于一个恒定的阵列级风险率 $\\alpha$，为期一年的持久性要求 $R(t) \\ge D$ 等价于 $\\text{MTTDL} \\ge \\frac{t}{-\\ln(D)}$。\n\n仅使用这些基础，推导出 RAID 级别 $5$ 和 RAID 级别 $6$ 的阵列级风险率表达式（用 $n$、$a$ 和 $\\mu$ 表示），将 $\\mu$ 转换为年单位，求解持久性不等式以确定在满足容量约束的同时能满足 $D$ 的 RAID 级别，然后选择满足条件的最小 $n$。将您的最终答案表示为单个整数 $n$。由于 $n$ 是整数，因此不需要取整说明。", "solution": "问题要求计算配置一个满足指定容量和持久性约束的 RAID 阵列所需的最小总磁盘数 $n$。我们可以选择 RAID 级别 $5$ 或 RAID 级别 $6$。解决过程首先需要验证问题陈述的有效性，如果有效，则对每个 RAID 级别进行详细的逐步分析。\n\n该问题被认为是有效的。它在科学上基于存储系统的可靠性工程原理，问题提法良好，提供了足够的信息以获得唯一解，并且陈述客观。所提供的阵列风险率模型是标准的一阶近似。\n\n分析过程如下：\n首先，我们确定所有参数和约束的量化值，确保单位一致。其次，我们分析 RAID 级别 $5$，以确定它是否能同时满足容量和持久性要求。第三，我们对 RAID 级别 $6$ 进行相同的分析。最后，我们比较结果以确定 $n$ 的最小可能值。\n\n**1. 参数和约束**\n给定的参数如下：\n- 所需的数据磁盘等效可用容量：$m = 10$。\n- 磁盘年化故障率 (AFR)：$a = 0.012$。\n- 重建速率：$\\mu_{\\text{day}} = 0.5$ 每天。\n- 持久性时间周期：$t = 1$ 年。\n- 目标持久性 (生存概率)：$D = 0.99999$。\n\n我们将所有速率转换为统一的年单位。设 $d_y$ 为一年中的天数。我们使用标准值 $d_y = 365.25$ 天/年。\n每年的磁盘故障率 $\\lambda$ 从 AFR 推导得出：\n$$a = 1 - \\exp(-\\lambda t)$$\n对于 $t = 1$ 年，这给出 $\\lambda = -\\ln(1 - a)$。\n$$\\lambda = -\\ln(1 - 0.012) = -\\ln(0.988) \\text{ year}^{-1}$$\n\n重建速率 $\\mu$，以 年$^{-1}$ 为单位，是：\n$$\\mu = \\mu_{\\text{day}} \\times d_y = 0.5 \\times 365.25 = 182.625 \\text{ year}^{-1}$$\n平均重建时间 $T_r$，以年为单位，是重建速率的倒数：\n$$T_r = \\frac{1}{\\mu} = \\frac{1}{182.625} \\text{ years}$$\n\n持久性约束为 $R(t) \\ge D$。对于一个恒定的阵列级风险率 $\\alpha$，可靠性为 $R(t) = \\exp(-\\alpha t)$。\n$$\\exp(-\\alpha t) \\ge D$$\n对两边取自然对数：\n$$-\\alpha t \\ge \\ln(D)$$\n$$\\alpha \\le \\frac{-\\ln(D)}{t}$$\n给定 $t = 1$ 年和 $D = 0.99999$：\n$$\\alpha \\le \\frac{-\\ln(0.99999)}{1} = -\\ln(1 - 10^{-5})$$\n我们把这个最大允许风险率记为 $\\alpha_{\\text{max}}$。\n$$\\alpha_{\\text{max}} = -\\ln(0.99999)$$\n\n**2. RAID 级别 5 分析**\n对于 RAID 级别 $5$，可用容量为 $(n - 1)$ 个数据磁盘。\n容量约束：\n$$n - 1 \\ge m \\implies n - 1 \\ge 10 \\implies n \\ge 11$$\n\nRAID 级别 $5$ 的阵列风险率 $\\alpha_5$ 被建模为第一次磁盘故障的发生率乘以在第一次重建期间发生第二次磁盘故障的概率。\n在一个包含 $n$ 个独立磁盘的阵列中，第一次故障的发生率为 $n\\lambda$。\n在重建窗口 $T_r$ 期间，剩余 $n-1$ 个磁盘中有一个发生故障的概率近似为 $(n-1)\\lambda T_r$，假设这个概率很小。\n因此，RAID $5$ 的风险率为：\n$$\\alpha_5(n) = (n\\lambda) \\times ((n-1)\\lambda T_r) = n(n-1)\\lambda^2 T_r$$\n\n持久性约束：\n$$\\alpha_5(n) \\le \\alpha_{\\text{max}}$$\n$$n(n-1)\\lambda^2 T_r \\le -\\ln(D)$$\n$$n(n-1) \\le \\frac{-\\ln(D)}{\\lambda^2 T_r}$$\n\n我们来计算右侧的值：\n$$ \\frac{-\\ln(D)}{\\lambda^2 T_r} = \\frac{-\\ln(0.99999)}{(-\\ln(0.988))^2 \\left(\\frac{1}{182.625}\\right)} = \\frac{-182.625 \\ln(0.99999)}{(\\ln(0.988))^2} $$\n使用数值：$\\ln(0.99999) \\approx -1.000005 \\times 10^{-5}$ 且 $\\ln(0.988) \\approx -0.0120725$。\n$$ n(n-1) \\le \\frac{-182.625 \\times (-1.000005 \\times 10^{-5})}{(-0.0120725)^2} \\approx \\frac{1.82626 \\times 10^{-3}}{1.45745 \\times 10^{-4}} \\approx 12.530 $$\n所以，对于 RAID $5$，我们必须满足两个条件：\n1. $n \\ge 11$ (容量)\n2. $n(n-1) \\le 12.530$ (持久性)\n\n我们来检查容量约束给出的 $n$ 的最小值，即 $n=11$。\n对于 $n=11$，$n(n-1) = 11 \\times 10 = 110$。\n显然，$110$ 不小于或等于 $12.530$。由于函数 $f(n) = n(n-1)$ 在 $n \\ge 1$ 时是严格递增的，所以没有整数 $n \\ge 11$ 能满足持久性约束。\n因此，RAID 级别 $5$ 无法同时满足这两个约束。\n\n**3. RAID 级别 6 分析**\n对于 RAID 级别 $6$，可用容量为 $(n - 2)$ 个数据磁盘。\n容量约束：\n$$n - 2 \\ge m \\implies n - 2 \\ge 10 \\implies n \\ge 12$$\n\nRAID 级别 $6$ 的阵列风险率 $\\alpha_6$ 被建模为第一次故障的发生率，乘以在第一个重建窗口期间发生第二次故障的条件概率，再乘以在第二个重建窗口期间发生第三次故障的条件概率。我们假设两个重建窗口的持续时间均为 $T_r$。\n$$\\alpha_6(n) = (n\\lambda) \\times ((n-1)\\lambda T_r) \\times ((n-2)\\lambda T_r) = n(n-1)(n-2)\\lambda^3 T_r^2$$\n\n持久性约束：\n$$\\alpha_6(n) \\le \\alpha_{\\text{max}}$$\n$$n(n-1)(n-2)\\lambda^3 T_r^2 \\le -\\ln(D)$$\n$$n(n-1)(n-2) \\le \\frac{-\\ln(D)}{\\lambda^3 T_r^2}$$\n\n我们来计算右侧的值：\n$$ \\frac{-\\ln(D)}{\\lambda^3 T_r^2} = \\frac{-\\ln(0.99999)}{(-\\ln(0.988))^3 \\left(\\frac{1}{182.625}\\right)^2} = \\frac{-(182.625)^2 \\ln(0.99999)}{(-\\ln(0.988))^3} $$\n使用数值：\n$$ n(n-1)(n-2) \\le \\frac{-(182.625)^2 \\times (-1.000005 \\times 10^{-5})}{(-(-0.0120725))^3} \\approx \\frac{33351.5 \\times (1.000005 \\times 10^{-5})}{(0.0120725)^3} \\approx \\frac{0.333517}{1.7589 \\times 10^{-6}} \\approx 189616 $$\n所以，对于 RAID $6$，我们必须满足两个条件：\n1. $n \\ge 12$ (容量)\n2. $n(n-1)(n-2) \\le 189616$ (持久性)\n\n我们需要找到满足这两个条件的最小整数 $n$。我们从容量约束允许的最低 $n$ 值开始检查，即 $n=12$。\n对于 $n=12$：\n$$n(n-1)(n-2) = 12 \\times (12-1) \\times (12-2) = 12 \\times 11 \\times 10 = 1320$$\n我们检查这是否满足持久性约束：\n$$1320 \\le 189616$$\n这个不等式成立。\n由于 $n=12$ 是满足 RAID $6$ 容量约束的最小 $n$ 值，并且它也满足持久性约束，因此 $n=12$ 是有效 RAID $6$ 配置所需的最小磁盘数。\n\n**4. 结论**\nRAID 级别 $5$ 不是一个可行的解决方案，因为它对于任何数量的磁盘都无法同时满足容量和持久性要求。\nRAID 级别 $6$ 是一个可行的解决方案。满足容量约束所需的最小磁盘数为 $n=12$，并且此配置也满足了严格的持久性要求。\n因此，满足所有约束的最小总磁盘数 $n$ 是 $12$。", "answer": "$$\\boxed{12}$$", "id": "3671415"}]}