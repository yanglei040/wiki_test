{
        "hands_on_practices": [
            {
                "introduction": "这个练习旨在具体展示前向误差、后向误差和条件数之间的核心关系。你将通过构造一个简单的病态线性系统，亲手计算并验证一个数值稳定的算法（后向误差极小）如何因为系统本身的病态性（条件数巨大）而产生一个与真实解相差甚远的计算解（前向误差巨大）[@problem_id:3546754]。这个实践将帮助你直观地理解条件数作为误差放大因子的关键作用。",
                "problem": "设 $\\|\\cdot\\|$ 表示谱范数（对向量是欧几里得 $2$-范数，对矩阵是诱导算子 $2$-范数）。考虑 $2 \\times 2$ 的对角矩阵\n$$\nA \\;=\\; \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix},\n\\quad \\text{其中 } \\varepsilon \\;=\\; 10^{-14},\n$$\n精确解\n$$\nx \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n以及对应的右端项\n$$\nb \\;=\\; A x \\;=\\; \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}.\n$$\n假设计算出的解为\n$$\n\\hat{x} \\;=\\; \\begin{pmatrix} 1 \\\\ 1 - \\alpha \\end{pmatrix},\n\\quad \\text{其中 } \\alpha \\;=\\; 10^{-2}.\n$$\n您需要验证范数形式的后向误差不大于 $10^{-16}$，而范数形式的前向误差约为 $10^{-2}$，然后使用矩阵 $A$ 的条件数来解释这种差异。\n\n任务：\n1. 使用范数形式的后向误差定义（即存在扰动 $\\Delta A$ 和 $\\Delta b$ 满足 $(A + \\Delta A)\\hat{x} = b + \\Delta b$，且 $\\|\\Delta A\\| \\le \\eta \\|A\\|$ 和 $\\|\\Delta b\\| \\le \\eta \\|b\\|$ 的最小 $\\eta$），给出具体的 $\\Delta A$ 和 $\\Delta b$ 来证明 $\\hat{x}$ 的后向误差不超过 $10^{-16}$。\n2. 计算范数形式的前向误差比 $\\|x - \\hat{x}\\| / \\|x\\|$。\n3. 从条件数 $\\kappa_{2}(A) = \\|A\\| \\,\\|A^{-1}\\|$、后向误差和前向误差的定义出发，推导出一个界，用以解释为什么对于病态矩阵 $A$，前向误差会远大于后向误差，并对给定的数据评估此界以解释您的结果。\n\n作为最终答案，报告前向误差比 $\\|x - \\hat{x}\\| / \\|x\\|$ 的数值，四舍五入到四位有效数字。",
                "solution": "该问题要求对一个线性系统的计算解进行三部分分析，重点关注后向误差、前向误差和条件数的概念。\n\n给定的量如下：\n- 矩阵 $A = \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix}$，其中 $\\varepsilon = 10^{-14}$。\n- 精确解 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n- 右端项 $b = Ax = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}$。\n- 计算解 $\\hat{x} = \\begin{pmatrix} 1 \\\\ 1 - \\alpha \\end{pmatrix}$，其中 $\\alpha = 10^{-2}$。\n- 范数 $\\|\\cdot\\|$ 是谱范数（对向量是 $2$-范数，对矩阵是诱导 $2$-范数）。\n\n### 任务1：后向误差验证\n\n范数形式的后向误差 $\\eta$ 是满足存在扰动 $\\Delta A$ 和 $\\Delta b$ 使得 $(A + \\Delta A)\\hat{x} = b + \\Delta b$ 成立，且 $\\|\\Delta A\\| \\le \\eta \\|A\\|$ 和 $\\|\\Delta b\\| \\le \\eta \\|b\\|$ 的最小非负数。这个条件可以通过定义残差向量 $r = b - A\\hat{x}$ 来重写。方程变为：\n$$\n\\Delta b - \\Delta A \\hat{x} = A\\hat{x} - b = -r\n$$\n首先，我们计算残差 $r$：\n$$\nA\\hat{x} = \\begin{pmatrix} 1  0 \\\\ 0  \\varepsilon \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1-\\alpha \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\varepsilon(1-\\alpha) \\end{pmatrix}\n$$\n$$\nr = b - A\\hat{x} = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ \\varepsilon(1-\\alpha) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\varepsilon\\alpha \\end{pmatrix}\n$$\n为了证明后向误差不超过 $10^{-16}$，我们需要给出满足误差方程和范数界（对于某个 $\\eta \\le 10^{-16}$）的具体扰动 $\\Delta A$ 和 $\\Delta b$。一个简单的选择是将整个残差归因于 $b$ 的扰动，即设 $\\Delta A = 0$。\n设 $\\Delta A$ 为 $2 \\times 2$ 的零矩阵，$\\Delta A = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$。误差方程简化为 $\\Delta b = -r$。\n$$\n\\Delta b = -r = \\begin{pmatrix} 0 \\\\ -\\varepsilon\\alpha \\end{pmatrix}\n$$\n现在我们必须验证对于某个 $\\eta \\le 10^{-16}$，范数条件成立。第一个条件 $\\|\\Delta A\\| \\le \\eta \\|A\\|$ 变为 $0 \\le \\eta \\|A\\|$，这对任何 $\\eta \\ge 0$ 都成立。\n对于第二个条件，我们需要找到满足 $\\|\\Delta b\\| \\le \\eta \\|b\\|$ 的最小 $\\eta$。这给出 $\\eta \\ge \\frac{\\|\\Delta b\\|}{\\|b\\|}$。我们来计算范数：\n$$\n\\|\\Delta b\\| = \\left\\| \\begin{pmatrix} 0 \\\\ -\\varepsilon\\alpha \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + (-\\varepsilon\\alpha)^2} = \\varepsilon\\alpha = (10^{-14})(10^{-2}) = 10^{-16}\n$$\n$$\n\\|b\\| = \\left\\| \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix} \\right\\|_2 = \\sqrt{1^2 + \\varepsilon^2} = \\sqrt{1 + (10^{-14})^2} = \\sqrt{1 + 10^{-28}}\n$$\n对于我们选择的 $\\Delta A$ 和 $\\Delta b$，后向误差度量为 $\\eta = \\frac{\\|\\Delta b\\|}{\\|b\\|} = \\frac{10^{-16}}{\\sqrt{1 + 10^{-28}}}$。\n由于 $\\sqrt{1 + 10^{-28}} > 1$，我们有 $\\eta  10^{-16}$。真正的范数形式的后向误差是所有可能扰动的最小值，因此它必须小于或等于这个值。因此，我们证明了 $\\hat{x}$ 的后向误差不超过 $10^{-16}$。\n\n### 任务2：前向误差计算\n\n范数形式的前向误差比由 $\\frac{\\|x - \\hat{x}\\|}{\\|x\\|}$ 给出。\n首先，我们计算误差向量 $x - \\hat{x}$：\n$$\nx - \\hat{x} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1-\\alpha \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\alpha \\end{pmatrix}\n$$\n接下来，我们计算所需的范数：\n$$\n\\|x - \\hat{x}\\| = \\left\\| \\begin{pmatrix} 0 \\\\ \\alpha \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + \\alpha^2} = \\alpha = 10^{-2}\n$$\n$$\n\\|x\\| = \\left\\| \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right\\|_2 = \\sqrt{1^2 + 1^2} = \\sqrt{2}\n$$\n前向误差比为：\n$$\n\\frac{\\|x - \\hat{x}\\|}{\\|x\\|} = \\frac{10^{-2}}{\\sqrt{2}}\n$$\n为了提供四舍五入到四位有效数字的数值：\n$$\n\\frac{10^{-2}}{\\sqrt{2}} \\approx \\frac{10^{-2}}{1.41421356} \\approx 0.0070710678 \\approx 7.071 \\times 10^{-3}\n$$\n该值约为 $0.007071$。\n\n### 任务3：使用条件数进行解释\n\n小的后向误差（约 $10^{-16}$）与大得多的前向误差（约 $10^{-2}$）之间的差异可以通过矩阵 $A$ 的条件数来解释。\n\n首先，我们推导一个关联前向误差和后向误差的一般界。由 $(A + \\Delta A)\\hat{x} = b + \\Delta b$ 和 $Ax = b$，我们可以写出：\n$$\n(A+\\Delta A)\\hat{x} = Ax + \\Delta b \\implies \\hat{x} = (A+\\Delta A)^{-1}(Ax + \\Delta b)\n$$\n误差为 $\\hat{x}-x = (A+\\Delta A)^{-1}(Ax+\\Delta b) - x = (A+\\Delta A)^{-1}[Ax+\\Delta b - (A+\\Delta A)x] = (A+\\Delta A)^{-1}(\\Delta b - \\Delta A x)$。\n取范数，我们得到 $\\|\\hat{x}-x\\| \\le \\|(A+\\Delta A)^{-1}\\| (\\|\\Delta b\\| + \\|\\Delta A\\|\\|x\\|)$。\n使用 Banach 引理，如果 $\\|\\Delta A\\|\\|A^{-1}\\|  1$，则 $\\|(A+\\Delta A)^{-1}\\| \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|}$。\n将其代入，我们得到：\n$$\n\\|\\hat{x}-x\\| \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|} (\\|\\Delta b\\| + \\|\\Delta A\\|\\|x\\|)\n$$\n除以 $\\|x\\|$ 以获得相对误差：\n$$\n\\frac{\\|\\hat{x}-x\\|}{\\|x\\|} \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|} \\left(\\frac{\\|\\Delta b\\|}{\\|x\\|} + \\|\\Delta A\\|\\right)\n$$\n使用不等式 $\\|b\\|=\\|Ax\\| \\le \\|A\\|\\|x\\| \\implies \\frac{1}{\\|x\\|} \\le \\frac{\\|A\\|}{\\|b\\|}$：\n$$\n\\frac{\\|\\hat{x}-x\\|}{\\|x\\|} \\le \\frac{\\|A^{-1}\\|}{1-\\|A^{-1}\\|\\|\\Delta A\\|} \\left(\\frac{\\|\\Delta b\\|\\|A\\|}{\\|b\\|} + \\|\\Delta A\\|\\right) = \\frac{\\|A\\|\\|A^{-1}\\|}{1-\\|A\\|\\|A^{-1}\\|\\frac{\\|\\Delta A\\|}{\\|A\\|}} \\left(\\frac{\\|\\Delta b\\|}{\\|b\\|} + \\frac{\\|\\Delta A\\|}{\\|A\\|}\\right)\n$$\n令 $\\kappa_2(A) = \\|A\\|\\|A^{-1}\\|$ 为条件数，并使用后向误差 $\\eta$ 的定义（它界定了 $\\frac{\\|\\Delta A\\|}{\\|A\\|}$ 和 $\\frac{\\|\\Delta b\\|}{\\|b\\|}$），我们得到标准界：\n$$\n\\frac{\\|\\hat{x}-x\\|}{\\|x\\|} \\le \\frac{\\kappa_2(A)}{1-\\kappa_2(A)\\frac{\\|\\Delta A\\|}{\\|A\\|}} \\left(\\frac{\\|\\Delta A\\|}{\\|A\\|} + \\frac{\\|\\Delta b\\|}{\\|b\\|}\\right)\n$$\n对于小的后向误差，项 $1-\\kappa_2(A)\\frac{\\|\\Delta A\\|}{\\|A\\|}$ 接近于 $1$。这个界说明，相对于后向误差，前向误差可以被条件数 $\\kappa_2(A)$ 的一个因子放大。\n\n现在，我们对给定的数据进行评估。首先，我们计算条件数 $\\kappa_2(A)$。对角矩阵的谱范数是其对角线元素绝对值的最大值。\n$$\n\\|A\\|_2 = \\max(1, |\\varepsilon|) = \\max(1, 10^{-14}) = 1\n$$\n$A$ 的逆矩阵是 $A^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1/\\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  10^{14} \\end{pmatrix}$。\n$$\n\\|A^{-1}\\|_2 = \\max(1, |1/\\varepsilon|) = \\max(1, 10^{14}) = 10^{14}\n$$\n条件数是：\n$$\n\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 = 1 \\cdot 10^{14} = 10^{14}\n$$\n这是一个极大的条件数，表明矩阵 $A$ 是非常病态的。\n\n推导出的不等式表明，前向误差由一个与条件数和后向误差之积成正比的量所界定：\n$$\n\\text{前向误差} \\lesssim \\kappa_2(A) \\times (\\text{后向误差})\n$$\n在我们的例子中，后向误差 $\\eta$ 的量级为 $10^{-16}$，而条件数 $\\kappa_2(A)$ 为 $10^{14}$。它们的乘积约为 $10^{14} \\times 10^{-16} = 10^{-2}$。这个理论估计与我们计算出的前向误差比 $\\frac{10^{-2}}{\\sqrt{2}} \\approx 7.071 \\times 10^{-3}$ 完全一致。大的条件数起到了放大因子的作用，将一个非常小的后向误差（意味着 $\\hat{x}$ 是一个邻近问题的精确解）转换成一个大的前向误差（意味着 $\\hat{x}$ 远离真实解 $x$）。",
                "answer": "$$\\boxed{0.007071}$$",
                "id": "3546754"
            },
            {
                "introduction": "在理解了矩阵条件数的影响后，这个练习将引导你关注误差分析的另一个重要维度：范数误差与分量误差之间的差异。即使对于一个条件数为$1$的理想系统，由于浮点运算中的灾难性抵消，解的特定分量也可能出现巨大的相对误差[@problem_id:3546786]。通过这个案例，你将学会审视全局范数误差可能掩盖的局部精度问题，这对于评估计算结果的可靠性至关重要。",
                "problem": "考虑一个线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 且 $b \\in \\mathbb{R}^{3}$。在精确算术中，设 $A = I_{3}$，并定义右侧向量为\n$$\nb^{\\ast} = \\begin{pmatrix}\n\\left(10^{8} + 1\\right) - 10^{8} \\\\\n10^{8} \\\\\n-10^{8}\n\\end{pmatrix}.\n$$\n假设 $b^{\\ast}$ 是通过首先使用精度为 $t=8$ 个有效数字的十进制浮点算术计算 $\\left(10^{8} + 1\\right)$（每次运算都就近舍入），然后再减去 $10^{8}$（同样使用该算术）来形成的。令 $\\widehat{b}$ 表示第一个分量上这两个运算的浮点结果，以及第二和第三个分量上的精确赋值，并令 $\\widehat{x}$ 表示在相同算术下 $A x = \\widehat{b}$ 的计算解。由于 $A = I_{3}$，我们有 $x^{\\ast} = b^{\\ast}$ 和 $\\widehat{x} = \\widehat{b}$。\n\n使用数值线性代数中前向误差的标准定义，其中范数相对前向误差为 $\\left\\|\\widehat{x} - x^{\\ast}\\right\\|_{2} / \\left\\|x^{\\ast}\\right\\|_{2}$，分量相对前向误差为 $\\max_{i} \\left|\\widehat{x}_{i} - x^{\\ast}_{i}\\right| / \\left|x^{\\ast}_{i}\\right|$，构造由上述算术和相消引起的显式向量 $x^{\\ast}$ 和 $\\widehat{x}$，并解释为什么分量前向误差大而范数前向误差小。然后计算比率\n$$\n\\rho = \\frac{\\displaystyle \\max_{i} \\frac{\\left|\\widehat{x}_{i} - x^{\\ast}_{i}\\right|}{\\left|x^{\\ast}_{i}\\right|}}{\\displaystyle \\frac{\\left\\|\\widehat{x} - x^{\\ast}\\right\\|_{2}}{\\left\\|x^{\\ast}\\right\\|_{2}}}.\n$$\n将您对 $\\rho$ 的最终答案表示为单个封闭形式的解析表达式。无需进行舍入。",
                "solution": "这个问题的目标是解决一个关于数值线性代数中前向误差分析的题目。\n\n**解题步骤：**\n\n**1. 理解和验证问题**\n\n首先，我们明确题目给出的所有信息和要求。\n- **系统**: $A x = b$，其中 $A \\in \\mathbb{R}^{3 \\times 3}$，$b \\in \\mathbb{R}^{3}$。\n- **精确矩阵**: $A = I_3$。\n- **精确右端向量**:\n$$\nb^{\\ast} = \\begin{pmatrix}\n(10^{8} + 1) - 10^{8} \\\\\n10^{8} \\\\\n-10^{8}\n\\end{pmatrix}\n$$\n- **浮点运算**: 十进制，精度 $t = 8$ 位有效数字，就近舍入。\n- **计算的右端向量 $\\widehat{b}$**: 其第一个分量通过浮点运算 $\\text{fl}(\\text{fl}(10^8 + 1) - 10^8)$ 得到。第二和第三个分量是精确赋值。\n- **计算解 $\\widehat{x}$**: 在相同浮点运算下 $A x = \\widehat{b}$ 的解。\n- 因为 $A=I_3$，所以精确解 $x^{\\ast} = b^{\\ast}$，计算解 $\\widehat{x} = \\widehat{b}$。\n- **误差定义**:\n    - 范数相对前向误差: $\\frac{\\|\\widehat{x} - x^{\\ast}\\|_2}{\\|x^{\\ast}\\|_2}$。\n    - 分量相对前向误差: $\\max_{i} \\frac{|\\widehat{x}_i - x^{\\ast}_i|}{|x^{\\ast}_i|}$。\n- **任务**:\n    1. 构造显式向量 $x^{\\ast}$ 和 $\\widehat{x}$。\n    2. 解释为何分量前向误差大而范数前向误差小。\n    3. 计算比率 $\\rho = \\frac{\\max_{i} |\\widehat{x}_i - x^{\\ast}_i| / |x^{\\ast}_i|}{\\|\\widehat{x} - x^{\\ast}\\|_2 / \\|x^{\\ast}\\|_2}$。\n    4. 以封闭形式的解析表达式给出 $\\rho$。\n\n该问题是一个经典的数值分析问题，用于展示灾难性相消及其对不同误差度量的影响。问题陈述清晰、适定，所有计算都是可行的。\n\n**2. 构造精确解 $x^{\\ast}$ 和计算解 $\\widehat{x}$**\n\n*   **计算精确解 $x^{\\ast}$**\n    由于 $A = I_3$，我们有 $x^{\\ast} = b^{\\ast}$。我们直接计算 $b^{\\ast}$ 的分量：\n    - $x^{\\ast}_1 = (10^8 + 1) - 10^8 = 1$。\n    - $x^{\\ast}_2 = 10^8$。\n    - $x^{\\ast}_3 = -10^8$。\n    因此，精确解向量为：\n    $$\n    x^{\\ast} = \\begin{pmatrix} 1 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix}\n    $$\n\n*   **计算计算解 $\\widehat{x}$**\n    由于 $\\widehat{x} = \\widehat{b}$，我们需要使用精度 $t=8$ 的十进制浮点运算来计算 $\\widehat{b}$ 的分量。\n    - **分量 1 ($\\widehat{x}_1$)**: 我们计算 $\\text{fl}(\\text{fl}(10^8 + 1) - 10^8)$。\n        - 第一次运算：$10^8 + 1$。在十进制科学记数法中，$10^8 = 1.0000000 \\times 10^8$，$1 = 0.00000001 \\times 10^8$。它们的和是 $1.00000001 \\times 10^8$，这有9位有效数字。\n        - 舍入：根据就近舍入规则，我们将 $1.00000001 \\times 10^8$ 舍入到8位有效数字。第9位是'1'，因此向下舍入（截断），得到 $1.0000000 \\times 10^8 = 10^8$。所以，$\\text{fl}(10^8 + 1) = 10^8$。\n        - 第二次运算：$\\text{fl}(10^8 + 1) - 10^8$ 变为 $10^8 - 10^8 = 0$。\n        - 因此，$\\widehat{x}_1 = 0$。这是灾难性相消的典型例子，加法操作导致了信息的丢失。\n    - **分量 2 和 3**: 这两个分量是精确赋值，所以 $\\widehat{x}_2 = 10^8$ 和 $\\widehat{x}_3 = -10^8$。\n    因此，计算解向量为：\n    $$\n    \\widehat{x} = \\begin{pmatrix} 0 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix}\n    $$\n\n**3. 分析误差大小并解释**\n\n*   **计算误差**:\n    - 绝对误差向量：$\\widehat{x} - x^{\\ast} = \\begin{pmatrix} 0 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n    - 分量相对误差：\n        - 第1分量：$\\frac{|\\widehat{x}_1 - x^{\\ast}_1|}{|x^{\\ast}_1|} = \\frac{|0 - 1|}{|1|} = 1$。\n        - 第2分量：$\\frac{|\\widehat{x}_2 - x^{\\ast}_2|}{|x^{\\ast}_2|} = \\frac{|10^8 - 10^8|}{|10^8|} = 0$。\n        - 第3分量：$\\frac{|\\widehat{x}_3 - x^{\\ast}_3|}{|x^{\\ast}_3|} = \\frac{|-10^8 - (-10^8)|}{|-10^8|} = 0$。\n    - **分量相对前向误差**是这些值的最大值，即 $\\max(1, 0, 0) = 1$。这是一个非常大的相对误差（100%）。\n\n*   **计算范数相对前向误差**:\n    - $\\|\\widehat{x} - x^{\\ast}\\|_2 = \\left\\| \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\sqrt{(-1)^2 + 0^2 + 0^2} = 1$。\n    - $\\|x^{\\ast}\\|_2 = \\left\\| \\begin{pmatrix} 1 \\\\ 10^8 \\\\ -10^8 \\end{pmatrix} \\right\\|_2 = \\sqrt{1^2 + (10^8)^2 + (-10^8)^2} = \\sqrt{1 + 2 \\times 10^{16}}$。\n    - **范数相对前向误差**为 $\\frac{\\|\\widehat{x} - x^{\\ast}\\|_2}{\\|x^{\\ast}\\|_2} = \\frac{1}{\\sqrt{1 + 2 \\times 10^{16}}}$。这个值非常小，约等于 $\\frac{1}{\\sqrt{2} \\times 10^8}$。\n\n*   **解释**:\n    分量误差之所以大，是因为在计算第一个分量时发生了灾难性相消，导致其真实值 $x^{\\ast}_1 = 1$ 完全丢失，计算值为 $\\widehat{x}_1=0$，相对误差为100%。\n    而范数误差之所以小，是因为欧几里得范数由向量中数值最大的分量主导。在这里，$\\|x^{\\ast}\\|_2$ 的值主要由 $10^8$ 和 $-10^8$ 决定，其值非常大。虽然绝对误差向量的范数是1，但与整个向量的巨大范数相比，这个误差就显得微不足道了。这说明范数误差可能会掩盖解的某些分量上存在的严重精度问题。\n\n**4. 计算比率 $\\rho$**\n\n我们计算比率 $\\rho = \\frac{\\text{分量相对前向误差}}{\\text{范数相对前向误差}}$。\n$$\n\\rho = \\frac{\\displaystyle \\max_{i} \\frac{\\left|\\widehat{x}_{i} - x^{\\ast}_{i}\\right|}{\\left|x^{\\ast}_{i}\\right|}}{\\displaystyle \\frac{\\left\\|\\widehat{x} - x^{\\ast}\\right\\|_{2}}{\\left\\|x^{\\ast}\\right\\|_{2}}} = \\frac{1}{\\frac{1}{\\sqrt{1 + 2 \\times 10^{16}}}}\n$$\n因此，\n$$\n\\rho = \\sqrt{1 + 2 \\times 10^{16}}\n$$\n这就是所求的封闭形式解析表达式。",
                "answer": "$$ \\boxed{\\sqrt{1 + 2 \\times 10^{16}}} $$",
                "id": "3546786"
            },
            {
                "introduction": "从误差诊断转向问题解决，这个练习介绍了一种改善矩阵条件的实用技术——平衡。你将处理一个尺度严重不平衡的系统，并应用行和列缩放来降低其条件数，最终显著改善前向误差的界[@problem_id:3546820]。这个实践不仅巩固了你对条件数重要性的认识，还为你提供了处理实际计算问题时提高解精度的有效工具。",
                "problem": "考虑线性系统 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix} 10^{-3}  0 \\\\ 0  1 \\end{pmatrix}, \n\\qquad \nx_{\\star} \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n\\qquad \nb \\;=\\; A x_{\\star} \\;=\\; \\begin{pmatrix} 10^{-3} \\\\ 1 \\end{pmatrix}.\n$$\n我们使用一个简单的直接求解器，在基数为10、保留$t=3$位有效数字并舍入到最近的浮点运算中求解 $x$。假设该求解器在以下意义上是范数向后稳定的：计算出的解 $\\widehat{x}$ 是一个扰动系统 $(A + \\Delta A)\\widehat{x} = b + \\Delta b$ 的精确解，其中\n$$\n\\max\\!\\left\\{\\frac{\\|\\Delta A\\|_{2}}{\\|A\\|_{2}},\\,\\frac{\\|\\Delta b\\|_{2}}{\\|b\\|_{2}}\\right\\} \\;\\le\\; u,\n\\qquad\nu \\;=\\; 5\\times 10^{-4}.\n$$\n你将研究在使用行和列缩放的平衡化步骤之前和之后的前向误差。定义对角缩放\n$$\nD_{r} \\;=\\; \\operatorname{diag}\\!\\big(10^{3/2},\\,1\\big),\n\\qquad\nD_{c} \\;=\\; \\operatorname{diag}\\!\\big(10^{3/2},\\,1\\big),\n$$\n并考虑平衡化后的系统\n$$\n\\big(D_{r} A D_{c}\\big)\\,y \\;=\\; D_{r} b,\n\\qquad\nx \\;=\\; D_{c}\\,y.\n$$\n\n使用谱范数（也称为 $2$-范数）进行范数前向误差分析，按以下步骤进行：\n\n1. 从后向稳定性的定义关系和基本扰动恒等式出发，推导出标准界，即在 $\\kappa_{2}(M)\\,\\eta  1$ 的条件下，\n$$\n\\frac{\\|\\widehat{z}-z\\|_{2}}{\\|z\\|_{2}} \\;\\le\\; \\frac{\\kappa_{2}(M)\\,\\eta}{\\,1 - \\kappa_{2}(M)\\,\\eta\\,},\n$$\n其中 $M$ 是一个非奇异系数矩阵，$z$ 是 $M z = f$ 的精确解，$\\widehat{z}$ 是计算解，而 $\\eta$ 是范数相对后向误差。\n2. 计算 $2$-范数条件数 $\\kappa_{2}(A)$ 和 $\\kappa_{2}(D_{r} A D_{c})$。\n3. 根据后向稳定性假设，用 $u$ 代替 $\\eta$，为原始系统和平衡化系统构建最坏情况下的相对前向误差界，然后计算比率\n$$\nR \\;=\\; \\frac{\\text{平衡化前的界}}{\\text{平衡化后的界}}。\n$$\n\n$R$ 的数值是多少？将你的答案四舍五入到四位有效数字。最终答案必须以纯数字形式报告，不带单位。",
                "solution": "该问题要求对一个线性系统，在平衡化步骤之前和之后，进行一个包含三部分的前向误差分析。我们必须首先验证问题的有效性，然后按照指示进行推导和计算。\n\n### 问题验证\n该问题定义明确，在数值线性代数中有科学依据，并提供了进行下去所需的所有信息。\n- **已知条件**：给定了矩阵 $A$、$D_r$、$D_c$、向量 $x_{\\star}$、常数 $u$，以及原始系统和平衡化系统的定义。\n- **任务**：任务很明确：1. 推导一个标准的前向误差界。2. 计算两个条件数。3. 计算误差界的比率。\n- **一致性**：问题要求推导前向误差界 $\\frac{\\kappa_{2}(M)\\,\\eta}{\\,1 - \\kappa_{2}(M)\\,\\eta\\,}$，这对于形式为 $(M+\\Delta M)\\widehat{z}=f$ 的后向误差模型（即右侧向量没有扰动）是标准的。问题中陈述的后向稳定性模型是 $(A + \\Delta A)\\widehat{x} = b + \\Delta b$，它包含一个扰动 $\\Delta b$。这个模型严格来说会导出一个略有不同的界，其简化形式通常为 $\\frac{2\\kappa_{2}(M)\\,\\eta}{\\,1 - \\kappa_{2}(M)\\,\\eta\\,}$。然而，问题明确指示我们首先推导前一个表达式，然后在后续分析中使用它。这表明我们应该严格按照说明进行。事实证明，最终的比率 $R$ 与使用这两个界中的哪一个无关，因此这个细微的不一致性不会影响最终结果。因此，该问题被认为是有效且可解的。\n\n我们现在按照指定的三个步骤进行求解。\n\n### 第一部分：前向误差界的推导\n\n我们被要求推导线性系统 $Mz=f$ 的标准前向误差界。设 $M$ 是一个非奇异矩阵。精确解是 $z = M^{-1}f$。设 $\\widehat{z}$ 是计算解，它被假设为一个扰动系统的精确解。为了推导目标公式，我们只考虑矩阵中的扰动，即：\n$$(M + \\Delta M) \\widehat{z} = f$$\n其中后向误差由某个后向误差度量 $\\eta$ 界定为 $\\|\\Delta M\\|_2 \\le \\eta \\|M\\|_2$。\n\n从扰动方程中减去原方程 $Mz=f$ 得到：\n$$(M + \\Delta M) \\widehat{z} - Mz = 0$$\n$$M\\widehat{z} + \\Delta M \\widehat{z} - Mz = 0$$\n整理各项以得到误差向量 $\\widehat{z}-z$ 的表达式：\n$$M(\\widehat{z} - z) = -\\Delta M \\widehat{z}$$\n如果 $M$ 是非奇异的，我们可以乘以 $M^{-1}$：\n$$\\widehat{z} - z = -M^{-1} \\Delta M \\widehat{z}$$\n对两边取 $2$-范数，并应用矩阵范数的次可乘性：\n$$\\|\\widehat{z} - z\\|_{2} = \\|-M^{-1} \\Delta M \\widehat{z}\\|_{2} \\le \\|M^{-1}\\|_{2} \\|\\Delta M\\|_{2} \\|\\widehat{z}\\|_{2}$$\n为了获得相对前向误差，我们除以 $\\|z\\|_2$（假设 $z \\ne 0$）：\n$$\\frac{\\|\\widehat{z} - z\\|_{2}}{\\|z\\|_{2}} \\le \\|M^{-1}\\|_{2} \\|\\Delta M\\|_{2} \\frac{\\|\\widehat{z}\\|_{2}}{\\|z\\|_{2}}$$\n现在，我们使用后向误差界 $\\|\\Delta M\\|_2 \\le \\eta \\|M\\|_2$：\n$$\\frac{\\|\\widehat{z} - z\\|_{2}}{\\|z\\|_{2}} \\le \\eta \\|M\\|_2 \\|M^{-1}\\|_{2} \\frac{\\|\\widehat{z}\\|_{2}}{\\|z\\|_{2}}$$\n注意到 $2$-范数条件数 $\\kappa_2(M) = \\|M\\|_2 \\|M^{-1}\\|_2$：\n$$\\frac{\\|\\widehat{z} - z\\|_{2}}{\\|z\\|_{2}} \\le \\kappa_2(M) \\eta \\frac{\\|\\widehat{z}\\|_{2}}{\\|z\\|_{2}}$$\n这个界依赖于未知的计算解 $\\widehat{z}$。我们可以通过注意到 $\\widehat{z} = z + (\\widehat{z}-z)$ 来消除这种依赖性。使用三角不等式：\n$$\\|\\widehat{z}\\|_2 = \\|z + (\\widehat{z}-z)\\|_2 \\le \\|z\\|_2 + \\|\\widehat{z}-z\\|_2$$\n除以 $\\|z\\|_2$ 得到：\n$$\\frac{\\|\\widehat{z}\\|_2}{\\|z\\|_2} \\le 1 + \\frac{\\|\\widehat{z}-z\\|_2}{\\|z\\|_2}$$\n设 $e_{rel} = \\frac{\\|\\widehat{z} - z\\|_{2}}{\\|z\\|_{2}}$。该不等式变为 $e_{rel} \\le \\kappa_2(M) \\eta (1 + e_{rel})$。\n$$e_{rel} \\le \\kappa_2(M)\\eta + \\kappa_2(M)\\eta\\,e_{rel}$$\n$$e_{rel}(1 - \\kappa_2(M)\\eta) \\le \\kappa_2(M)\\eta$$\n只要 $\\kappa_2(M)\\eta  1$，项 $(1 - \\kappa_2(M)\\eta)$ 就是正的，我们可以用它来除，而不用改变不等式的方向：\n$$\\frac{\\|\\widehat{z}-z\\|_{2}}{\\|z\\|_{2}} \\le \\frac{\\kappa_{2}(M)\\,\\eta}{\\,1 - \\kappa_{2}(M)\\,\\eta\\,}$$\n这样就完成了指定界的推导。\n\n### 第二部分：条件数的计算\n\n首先，我们计算原始矩阵 $A$ 的条件数。\n$$A = \\begin{pmatrix} 10^{-3}  0 \\\\ 0  1 \\end{pmatrix}$$\n由于 $A$ 是一个对角矩阵，其奇异值为对角线元素的绝对值：$\\sigma_1 = 1$ 和 $\\sigma_2 = 10^{-3}$。\n$A$ 的 $2$-范数是其最大的奇异值，$\\|A\\|_2 = \\sigma_{max}(A) = 1$。\n$A$ 的逆矩阵是 $A^{-1} = \\begin{pmatrix} 10^{3}  0 \\\\ 0  1 \\end{pmatrix}$。\n$A^{-1}$ 的 $2$-范数是其最大的奇异值，$\\|A^{-1}\\|_2 = 10^3$。\n$2$-范数条件数是 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。\n$$\\kappa_2(A) = 1 \\times 10^3 = 1000$$\n或者，对于对角矩阵，$\\kappa_2(A) = \\frac{\\sigma_{max}}{\\sigma_{min}} = \\frac{1}{10^{-3}} = 1000$。\n\n接下来，我们计算平衡化矩阵 $\\tilde{A} = D_r A D_c$ 的条件数。\n缩放矩阵为 $D_r = \\operatorname{diag}(10^{3/2}, 1)$ 和 $D_c = \\operatorname{diag}(10^{3/2}, 1)$。\n$$\\tilde{A} = D_r A D_c = \\begin{pmatrix} 10^{3/2}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10^{-3}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10^{3/2}  0 \\\\ 0  1 \\end{pmatrix}$$\n$$\\tilde{A} = \\begin{pmatrix} 10^{3/2} \\cdot 10^{-3} \\cdot 10^{3/2}  0 \\\\ 0  1 \\cdot 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 10^{3/2 - 3 + 3/2}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 10^{0}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$$\n平衡化后的矩阵是 $2 \\times 2$ 的单位矩阵，$\\tilde{A}=I$。\n单位矩阵的条件数是：\n$$\\kappa_2(D_r A D_c) = \\kappa_2(I) = 1$$\n\n### 第三部分：前向误差界的比率\n\n根据指示，我们使用第一部分推导出的公式来构建最坏情况下的相对前向误差界。我们使用 $\\eta = u = 5 \\times 10^{-4}$。\n\n原始系统 $Ax=b$ 的界是：\n$$\\text{Bound}_{before} = \\frac{\\kappa_2(A) u}{1 - \\kappa_2(A) u}$$\n我们有 $\\kappa_2(A) = 1000$ 和 $u = 5 \\times 10^{-4}$。乘积为 $\\kappa_2(A)u = 1000 \\times 5 \\times 10^{-4} = 0.5$。因为 $0.5  1$，所以该界是良定义的。\n$$\\text{Bound}_{before} = \\frac{0.5}{1 - 0.5} = \\frac{0.5}{0.5} = 1$$\n\n平衡化系统 $\\tilde{A}y=\\tilde{b}$ 的界是：\n$$\\text{Bound}_{after} = \\frac{\\kappa_2(\\tilde{A}) u}{1 - \\kappa_2(\\tilde{A}) u}$$\n我们有 $\\kappa_2(\\tilde{A}) = 1$。乘积为 $\\kappa_2(\\tilde{A})u = 1 \\times 5 \\times 10^{-4} = 0.0005$。因为 $0.0005  1$，所以该界是良定义的。\n$$\\text{Bound}_{after} = \\frac{5 \\times 10^{-4}}{1 - 5 \\times 10^{-4}} = \\frac{5 \\times 10^{-4}}{0.9995}$$\n这个界适用于平衡化系统解 $y$ 的相对误差。问题要求的是“原始系统和平衡化系统”的误差界之比，这比较了两种情况下直接法求解问题的条件。\n\n比率 $R$ 为：\n$$R = \\frac{\\text{Bound}_{before}}{\\text{Bound}_{after}} = \\frac{1}{\\frac{5 \\times 10^{-4}}{0.9995}} = \\frac{0.9995}{5 \\times 10^{-4}}$$\n$$R = \\frac{9995 \\times 10^{-4}}{5 \\times 10^{-4}} = \\frac{9995}{5} = 1999$$\n结果 $R=1999$ 是一个精确的整数。问题要求答案四舍五入到四位有效数字。由于 $1999$ 已经有四位有效数字，因此无需舍入。",
                "answer": "$$\\boxed{1999}$$",
                "id": "3546820"
            }
        ]
    }