{
        "hands_on_practices": [
            {
                "introduction": "MINRES 和 SYMMLQ 这两种强大的迭代方法，其核心都基于对称兰索斯过程。该过程为克里洛夫子空间（Krylov subspace）构建了一组标准正交基，并将原对称矩阵投影为一个更小、更易于处理的三对角矩阵。这个基础练习将带你亲手计算兰索斯过程的最初几个步骤，让你对这些算法的基石——兰索斯系数 $\\alpha_j$ 和 $\\beta_j$ ——有一个具体而深刻的认识。[@problem_id:3560312]",
                "problem": "考虑线性系统 $A x = b$，其中矩阵 $A$ 是对称不定矩阵\n$$A=\\begin{bmatrix} 2 & 1 & 0 \\\\ 1 & -1 & 1 \\\\ 0 & 1 & 0 \\end{bmatrix}$$\n右端项为\n$$b=\\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}。$$\n对于对称不定系统，最小残差法 (MINRES) 和 SYMMLQ 都建立在对称兰索斯 (Lanczos) 过程之上。该过程通过三项递推关系为克里洛夫 (Krylov) 子空间 $\\mathcal{K}_k(A,r_0)$（其中 $r_0=b-Ax_0$）生成一组标准正交基 $\\{v_j\\}$，并将矩阵 $A$ 三对角化。从零初始猜测 $x_0=\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}$ 开始，不使用预处理，使用欧几里得范数，并采用传统的兰索斯初始化 $v_1=r_0/\\|r_0\\|$，执行前两个兰索斯步骤，并显式计算前三个兰索斯系数 $\\alpha_1$、$\\beta_2$ 和 $\\alpha_2$。请提供精确值（不要四舍五入）。您的最终答案必须按顺序依次列出 $\\alpha_1$、$\\beta_2$ 和 $\\alpha_2$。",
                "solution": "该问题是有效的。这是一个数值线性代数中适定（well-posed）的问题，要求计算对于给定的对称不定矩阵和右端项，由对称兰索斯过程生成的前三个系数。所有必要的信息都已提供，且前提条件在事实上是正确的。\n\n对称兰索斯过程生成一个标准正交向量序列 $\\{v_j\\}$ 和一个对称三对角矩阵 $T_k$，其元素是兰索斯系数 $\\alpha_j$ 和 $\\beta_j$。矩阵 $A$ 与这些量之间的关系由矩阵方程 $A V_k = V_k T_k + \\beta_{k+1} v_{k+1} e_k^T$ 给出，其中 $V_k = [v_1, v_2, \\dots, v_k]$，$T_k$ 是一个 $k \\times k$ 的对称三对角矩阵。\n$$T_k = \\begin{pmatrix} \\alpha_1  & \\beta_2    \\\\ \\beta_2  & \\alpha_2  & \\beta_3   \\\\  & \\beta_3  & \\ddots  & \\ddots  \\\\   & & \\ddots  & \\alpha_{k-1}  & \\beta_{k} \\\\    & & & \\beta_{k}  & \\alpha_k \\end{pmatrix}$$\n算法流程如下：\n1. 初始化：从初始猜测 $x_0$ 开始。计算初始残差 $r_0 = b - A x_0$。设 $\\beta_1 = \\|r_0\\|_2$。若 $\\beta_1 = 0$，则停止。否则，令 $v_1 = r_0 / \\beta_1$。\n2. 迭代：对于 $j = 1, 2, \\dots, k$：\n    a. 计算矩阵向量乘积 $w_j = A v_j$。\n    b. 对角系数为 $\\alpha_j = v_j^T w_j$。\n    c. 计算下一个未归一化的向量 $\\hat{v}_{j+1} = w_j - \\alpha_j v_j - \\beta_j v_{j-1}$ （其中 $\\beta_1 v_0 \\equiv 0$）。\n    d. 非对角系数是该向量的范数：$\\beta_{j+1} = \\|\\hat{v}_{j+1}\\|_2$。\n    e. 如果 $\\beta_{j+1} = 0$，算法终止。否则，进行归一化以得到下一个兰索斯向量：$v_{j+1} = \\hat{v}_{j+1} / \\beta_{j+1}$。\n\n题目要求我们执行前两个步骤来找到 $\\alpha_1$、$\\beta_2$ 和 $\\alpha_2$。\n\n**初始化**\n\n给定的矩阵是 $A=\\begin{bmatrix} 2 & 1 & 0 \\\\ 1 & -1 & 1 \\\\ 0 & 1 & 0 \\end{bmatrix}$，右端项是 $b=\\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$。\n初始猜测是零向量，$x_0=\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}$。\n\n初始残差 $r_0$ 是：\n$$r_0 = b - A x_0 = b = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$$\n$r_0$ 的欧几里得范数是：\n$$\\beta_1 = \\|r_0\\|_2 = \\sqrt{1^2 + 0^2 + 1^2} = \\sqrt{2}$$\n第一个兰索斯向量 $v_1$ 是：\n$$v_1 = \\frac{r_0}{\\beta_1} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$$\n\n**第一个兰索斯步骤（求 $\\alpha_1$ 和 $\\beta_2$）**\n\n首先，我们计算矩阵向量乘积 $w_1 = A v_1$：\n$$w_1 = A v_1 = \\begin{bmatrix} 2 & 1 & 0 \\\\ 1 & -1 & 1 \\\\ 0 & 1 & 0 \\end{bmatrix} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 2(1)+1(0)+0(1) \\\\ 1(1)-1(0)+1(1) \\\\ 0(1)+1(0)+0(1) \\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 2 \\\\ 2 \\\\ 0 \\end{bmatrix} = \\sqrt{2} \\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix}$$\n接下来，我们计算系数 $\\alpha_1$：\n$$\\alpha_1 = v_1^T w_1 = \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 & 0 & 1 \\end{bmatrix} \\right) \\left( \\sqrt{2} \\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix} \\right) = (1)(1) + (0)(1) + (1)(0) = 1$$\n现在，我们计算下一步的未归一化向量 $\\hat{v}_2$：\n$$\\hat{v}_2 = w_1 - \\alpha_1 v_1 = \\sqrt{2} \\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix} - (1) \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\left( 2 \\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 2-1 \\\\ 2-0 \\\\ 0-1 \\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 2 \\\\ -1 \\end{bmatrix}$$\n系数 $\\beta_2$ 是 $\\hat{v}_2$ 的范数：\n$$\\beta_2 = \\|\\hat{v}_2\\|_2 = \\left\\| \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 2 \\\\ -1 \\end{bmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{2}} \\sqrt{1^2 + 2^2 + (-1)^2} = \\frac{1}{\\sqrt{2}} \\sqrt{1+4+1} = \\frac{\\sqrt{6}}{\\sqrt{2}} = \\sqrt{3}$$\n我们通过归一化 $\\hat{v}_2$ 来找到第二个兰索斯向量 $v_2$：\n$$v_2 = \\frac{\\hat{v}_2}{\\beta_2} = \\frac{1}{\\sqrt{3}} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 2 \\\\ -1 \\end{bmatrix} \\right) = \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 1 \\\\ 2 \\\\ -1 \\end{bmatrix}$$\n\n**第二个兰索斯步骤（求 $\\alpha_2$）**\n\n我们进行第二步来求 $\\alpha_2$。首先，我们计算 $w_2 = A v_2$：\n$$w_2 = A v_2 = \\begin{bmatrix} 2 & 1 & 0 \\\\ 1 & -1 & 1 \\\\ 0 & 1 & 0 \\end{bmatrix} \\left( \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 1 \\\\ 2 \\\\ -1 \\end{bmatrix} \\right) = \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 2(1)+1(2)+0(-1) \\\\ 1(1)-1(2)+1(-1) \\\\ 0(1)+1(2)+0(-1) \\end{bmatrix} = \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 4 \\\\ -2 \\\\ 2 \\end{bmatrix}$$\n系数 $\\alpha_2$ 由内积 $\\alpha_2 = v_2^T w_2$ 给出：\n$$\\alpha_2 = v_2^T w_2 = \\left( \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 1 & 2 & -1 \\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 4 \\\\ -2 \\\\ 2 \\end{bmatrix} \\right) = \\frac{1}{6} \\left( (1)(4) + (2)(-2) + (-1)(2) \\right) = \\frac{1}{6} (4 - 4 - 2) = -\\frac{2}{6} = -\\frac{1}{3}$$\n问题只要求计算 $\\alpha_1$、$\\beta_2$ 和 $\\alpha_2$。我们现在已经计算出所有需要的系数。\n\n结果摘要：\n第一个对角系数是 $\\alpha_1 = 1$。\n第一个非对角系数是 $\\beta_2 = \\sqrt{3}$。\n第二个对角系数是 $\\alpha_2 = -1/3$。\n问题要求提供精确值，我们已经提供了。\n得到的 $2 \\times 2$ 三对角矩阵是 $T_2 = \\begin{pmatrix} 1  & \\sqrt{3} \\\\ \\sqrt{3} & -1/3 \\end{pmatrix}$。\n\n所求的兰索斯系数为：\n$\\alpha_1 = 1$\n$\\beta_2 = \\sqrt{3}$\n$\\alpha_2 = -\\frac{1}{3}$",
                "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\sqrt{3} & -\\frac{1}{3}\n\\end{pmatrix}\n}\n$$",
                "id": "3560312"
            },
            {
                "introduction": "掌握了兰索斯过程之后，下一步便是理解 MINRES 如何利用其生成的投影三对角矩阵来最小化残差。这个练习将引导你详细地完成一个完整的 MINRES 迭代周期，包括通过 Givens 旋转求解最小二乘子问题。通过这个具体的计算，你将清晰地看到 MINRES 方法“最小残差”这一核心思想是如何在每一步中精确实现的。[@problem_id:3560282]",
                "problem": "设 $A \\in \\mathbb{R}^{2 \\times 2}$ 为对称不定矩阵，$A=\\begin{bmatrix}0  & 1 \\\\ 1  & 0\\end{bmatrix}$，且设 $b=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$。考虑在精确算术下，从 $x_0=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$ 开始，将对称系统的最小残差法（MINRES）应用于线性系统 $A x = b$。\n\n从下面的基本定义出发，精确执行两次 MINRES 迭代，并确定迭代解 $x_2$ 和残差的 2-范数 $\\|r_2\\|_2$，其中 $r_k=b-Ax_k$。\n\n使用的基本定义：\n1. 初始残差为 $r_0=b-Ax_0$，其中 $\\beta_1=\\|r_0\\|_2$ 且 $v_1=r_0/\\beta_1$。\n2. 对称兰索斯过程通过以下方式构造标准正交向量 $v_j$ 和标量 $\\alpha_j, \\beta_{j+1}$\n   $$\\beta_{j+1} v_{j+1} = A v_j - \\alpha_j v_j - \\beta_j v_{j-1}, \\quad \\alpha_j = v_j^{\\mathsf{T}} A v_j, \\quad v_0=0,$$\n   生成对角线元素为 $\\alpha_j$、次/超对角线元素为 $\\beta_{j+1}$ 的三对角矩阵 $T_k$。\n3. MINRES 迭代解 $x_k$ 位于克里洛夫子空间 $\\mathcal{K}_k(A,r_0)=\\operatorname{span}\\{r_0, A r_0, \\dots, A^{k-1} r_0\\}$ 中，并最小化残差范数。记 $x_k = V_k y_k$，$V_k=[v_1,\\dots,v_k]$，使残差最小化的系数 $y_k$ 解以下最小二乘问题\n   $$\\min_{y \\in \\mathbb{R}^k} \\left\\| \\beta_1 e_1 - \\bar{T}_k y \\right\\|_2,$$\n   其中 $\\bar{T}_k \\in \\mathbb{R}^{(k+1)\\times k}$ 是在 $T_k$ 下方添上一行，该行最后一个元素为 $\\beta_{k+1}$ 而其他元素为零，从而得到的矩阵。\n4. 一个 Givens 变换 $G(c,s)$ 作用于两个分量，通过以下方式消去一个元素\n   $$\\begin{bmatrix} c  & s \\\\ s  & -c \\end{bmatrix} \\begin{bmatrix} a \\\\ b \\end{bmatrix} = \\begin{bmatrix} \\sqrt{a^2+b^2} \\\\ 0 \\end{bmatrix}, \\quad c=\\frac{a}{\\sqrt{a^2+b^2}}, \\quad s=\\frac{b}{\\sqrt{a^2+b^2}},$$\n   并应用于 $\\bar{T}_k$ 的行和右端向量，以维持一个等价的上三角最小二乘问题。$k$ 次迭代后的残差范数等于变换后右端向量最后一个分量的绝对值。\n\n请显式地进行推导：构造 $k=1,2$ 时的兰索斯标量和向量，构建 $k=1$ 和 $k=2$ 时的最小二乘问题，构造并应用必要的 Givens 变换（使用精确的余弦和正弦值），求解系数 $y_k$，并恢复出 $x_k=V_k y_k$ 以及 $k=2$ 时的 $\\|r_k\\|_2$。报告精确的 $x_2$ 和 $\\|r_2\\|_2$。不需要进行四舍五入。你的最终答案必须是三元组 $(x_{2,1}, x_{2,2}, \\|r_2\\|_2)$，并表示为单行矩阵的形式。",
                "solution": "我们从初始数据开始。初始迭代解为 $x_0=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$，因此初始残差为\n$$\nr_0=b-Ax_0=b=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}.\n$$\n其范数为 $\\beta_1=\\|r_0\\|_2=1$，因此\n$$\nv_1=\\frac{r_0}{\\beta_1}=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}.\n$$\n\n我们继续进行对称兰索斯过程。如上初始化 $v_0=0$ 和 $\\beta_1$。\n\n对于 $j=1$，计算\n$$\nw = A v_1 - \\beta_1 v_0 = \\begin{bmatrix}0  & 1 \\\\ 1  & 0\\end{bmatrix} \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} - 1 \\cdot \\begin{bmatrix}0 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\n然后\n$$\n\\alpha_1 = v_1^{\\mathsf{T}} A v_1 = \\begin{bmatrix}1 & 0\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = 0,\n$$\n正交化后的向量是 $w - \\alpha_1 v_1 = \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}$。其范数给出\n$$\n\\beta_2 = \\left\\| \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} \\right\\|_2 = 1, \\quad v_2 = \\frac{1}{\\beta_2} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\n\n对于 $j=2$，计算\n$$\nw = A v_2 - \\beta_2 v_1 = \\begin{bmatrix}0  & 1 \\\\ 1  & 0\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} - 1 \\cdot \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} - \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}.\n$$\n因此\n$$\n\\alpha_2 = v_2^{\\mathsf{T}} A v_2 = \\begin{bmatrix}0 & 1\\end{bmatrix} \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} = 0, \\quad \\beta_3 = \\| w - \\alpha_2 v_2 \\|_2 = \\| 0 \\|_2 = 0.\n$$\n\n因此，$2 \\times 2$ 的三对角矩阵为\n$$\nT_2 = \\begin{bmatrix} \\alpha_1  & \\beta_2 \\\\ \\beta_2  & \\alpha_2 \\end{bmatrix} = \\begin{bmatrix} 0  & 1 \\\\ 1  & 0 \\end{bmatrix},\n$$\n用于最小二乘问题的增广矩阵为\n$$\n\\bar{T}_2 = \\begin{bmatrix} \\alpha_1  & \\beta_2 \\\\ \\beta_2  & \\alpha_2 \\\\ 0  & \\beta_3 \\end{bmatrix} = \\begin{bmatrix} 0  & 1 \\\\ 1  & 0 \\\\ 0  & 0 \\end{bmatrix}.\n$$\n我们还有 $V_2 = [v_1, v_2] = \\begin{bmatrix}1  & 0 \\\\ 0  & 1\\end{bmatrix}$ 和 $\\beta_1 = 1$。\n\nMINRES 迭代解 $x_k$ 由 $x_k = V_k y_k$ 给出，其中 $y_k$ 最小化残差范数\n$$\n\\left\\| \\beta_1 e_1 - \\bar{T}_k y \\right\\|_2.\n$$\n我们逐次迭代，构造并应用 Givens 变换将最小二乘系统三角化。\n\n迭代 $k=1$。矩阵 $\\bar{T}_1$ 是 $\\bar{T}_2$ 的第一列，\n$$\n\\bar{T}_1 = \\begin{bmatrix} \\alpha_1 \\\\ \\beta_2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\n$$\n最小二乘问题是\n$$\n\\min_{y_1 \\in \\mathbb{R}} \\left\\| \\beta_1 e_1 - \\bar{T}_1 y_1 \\right\\|_2 = \\min_{y_1 \\in \\mathbb{R}} \\left\\| \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} - \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} y_1 \\right\\|_2 = \\min_{y_1} \\sqrt{ (1 - 0 \\cdot y_1)^2 + (0 - y_1)^2 } = \\min_{y_1} \\sqrt{1 + y_1^2}.\n$$\n显然，最小化问题的解是 $y_1=0$，得到 $x_1 = V_1 y_1 = v_1 \\cdot 0 = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$ 和 $\\|r_1\\|_2 = 1$。\n\n等价地，通过 Givens 变换，我们使用作用于第 1 行和第 2 行的 $G_1$ 来消去 $\\bar{T}_1$ 中的次对角线元素。取 $a=\\alpha_1=0$ 和 $b=\\beta_2=1$，我们有\n$$\n\\rho_1 = \\sqrt{a^2 + b^2} = 1, \\quad c_1 = \\frac{a}{\\rho_1} = 0, \\quad s_1 = \\frac{b}{\\rho_1} = 1,\n$$\n和\n$$\nG_1 = \\begin{bmatrix} c_1  & s_1  & 0 \\\\ s_1  & -c_1 & 0 \\\\ 0  & 0  & 1 \\end{bmatrix} = \\begin{bmatrix} 0  & 1  & 0 \\\\ 1  & 0  & 0 \\\\ 0  & 0  & 1 \\end{bmatrix}.\n$$\n将 $G_1$ 应用于 $\\bar{T}_1$ 得到 $\\begin{bmatrix} \\rho_1 \\\\ 0 \\\\ 0 \\end{bmatrix}$，将 $G_1$ 应用于右端向量 $g=\\begin{bmatrix}\\beta_1 \\\\ 0 \\\\ 0\\end{bmatrix}=\\begin{bmatrix}1 \\\\ 0 \\\\ 0\\end{bmatrix}$ 得到变换后的向量\n$$\n\\begin{bmatrix} \\phi_1 \\\\ \\phi_2 \\\\ \\phi_3 \\end{bmatrix} = G_1 g = \\begin{bmatrix} c_1 \\beta_1 \\\\ s_1 \\beta_1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}.\n$$\n一次迭代后的残差范数是 $|\\phi_2|=1$，这证实了最小二乘的结果以及 $x_1=0$。\n\n迭代 $k=2$。我们现在考虑 $\\bar{T}_2$ 并将 $G_1$ 应用于它：\n$$\nG_1 \\bar{T}_2 = \\begin{bmatrix} 0  & 1  & 0 \\\\ 1  & 0  & 0 \\\\ 0  & 0  & 1 \\end{bmatrix} \\begin{bmatrix} 0  & 1 \\\\ 1  & 0 \\\\ 0  & 0 \\end{bmatrix} = \\begin{bmatrix} 1  & 0 \\\\ 0  & 1 \\\\ 0  & 0 \\end{bmatrix}.\n$$\n第一列已经是上三角形式，首元为 $\\rho_1=1$。对于第二列，为消去第 3 行的次对角线元素，我们使用数对 $(a,b)=(1,0)$（变换后矩阵的第2行第2列和第3行第2列的元素）来构造作用于第 2 行和第 3 行的 $G_2$。因此\n$$\n\\rho_2 = \\sqrt{a^2 + b^2} = 1, \\quad c_2 = \\frac{a}{\\rho_2} = 1, \\quad s_2 = \\frac{b}{\\rho_2} = 0,\n$$\n和\n$$\nG_2 = \\begin{bmatrix} 1  & 0  & 0 \\\\ 0  & c_2  & s_2 \\\\ 0  & s_2  & -c_2 \\end{bmatrix} = \\begin{bmatrix} 1  & 0  & 0 \\\\ 0  & 1  & 0 \\\\ 0  & 0  & -1 \\end{bmatrix}.\n$$\n应用 $G_2$ 不改变 $G_1 \\bar{T}_2$：\n$$\nG_2 (G_1 \\bar{T}_2) = \\begin{bmatrix} 1  & 0 \\\\ 0  & 1 \\\\ 0  & 0 \\end{bmatrix}.\n$$\n将 $G_2$ 应用于先前变换过的右端向量，得到\n$$\nG_2 \\begin{bmatrix} \\phi_1 \\\\ \\phi_2 \\\\ \\phi_3 \\end{bmatrix} = \\begin{bmatrix} 1  & 0  & 0 \\\\ 0  & 1  & 0 \\\\ 0  & 0  & -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} \\phi_1' \\\\ \\phi_2' \\\\ \\phi_3' \\end{bmatrix}.\n$$\n因此，完全变换后的最小二乘系统为\n$$\n\\min_{y \\in \\mathbb{R}^2} \\left\\| \\begin{bmatrix} \\phi_1' \\\\ \\phi_2' \\\\ \\phi_3' \\end{bmatrix} - \\begin{bmatrix} 1  & 0 \\\\ 0  & 1 \\\\ 0  & 0 \\end{bmatrix} y \\right\\|_2 = \\min_{y \\in \\mathbb{R}^2} \\left\\| \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} y_1 \\\\ y_2 \\\\ 0 \\end{bmatrix} \\right\\|_2 = \\min_{y} \\sqrt{ (0 - y_1)^2 + (1 - y_2)^2 }.\n$$\n唯一的最小化解是 $y_1=0$, $y_2=1$。因此，\n$$\nx_2 = V_2 y = [v_1, v_2] \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = v_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n两次迭代后的残差范数等于 $|\\phi_3'|=0$，即，\n$$\n\\| r_2 \\|_2 = 0.\n$$\n\n我们得出结论，对于这个 $2 \\times 2$ 的问题，第二次 MINRES 迭代解是精确解，其中 $x_2=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}$ 且 $\\|r_2\\|_2=0$。",
                "answer": "$$\\boxed{\\begin{pmatrix}0 & 1 & 0\\end{pmatrix}}$$",
                "id": "3560282"
            },
            {
                "introduction": "尽管 MINRES 和 SYMMLQ 共享相同的兰索斯基础，但它们在迭代过程中追求的目标不同，这导致了它们在求解某些问题时表现出截然不同的行为。此练习精心设计了一个场景，旨在对比两种方法所生成解向量的范数，即 $\\|x_k\\|$。通过推导和比较，你将揭示它们在稳定性上的一个关键差异，尤其是在处理对称不定系统时，这将帮助你理解为何在某些情况下一个方法可能比另一个更受青睐。[@problem_id:3560323]",
                "problem": "考虑一个对称不定线性系统，其中一个 $2 \\times 2$ 对称矩阵 $A$ 作用于一个由标准正交基 $\\{u, q\\}$ 张成的实二维空间，其中 $u^{\\top} u = 1$，$q^{\\top} q = 1$ 且 $u^{\\top} q = 0$。矩阵 $A$ 对该基的作用定义如下：\n$$\nA u = \\alpha u + \\gamma q, \\quad A q = \\gamma u - \\alpha q,\n$$\n其中参数 $\\alpha \\in \\mathbb{R}$ 和 $\\gamma \\in \\mathbb{R}$ 使得 $A$ 是不定且可逆的。设右端项为 $b = \\sqrt{2}\\, u$，因此 $\\|b\\|_{2} = \\sqrt{2}$。\n\n您应用两种克里洛夫子空间方法，均从 $x_{0} = 0$ 和相同的初始残差 $r_{0} = b$ 开始：\n\n- MINRES（最小残差法）：一种用于对称系统的克里洛夫方法，在第 $k$ 次迭代时，生成 $x_{k} \\in \\mathcal{K}_{k}(A, b)$ 以最小化残差范数 $\\|b - A x_{k}\\|_{2}$。\n- SYMMLQ（对称最小二乘法）：一种用于对称系统的克里洛夫方法，在第 $k$ 次迭代时，使用兰索斯过程形成一个 $k \\times k$ 的三对角投影，并计算 $x_{k} = V_{k} y_{k}$ 作为投影系统的最小 2-范数解，其中 $V_{k}$ 包含兰索斯基向量。\n\n假设您对每种方法都只执行一次迭代（$k = 1$），两者都从相同的归一化兰索斯向量 $v_{1} = b / \\|b\\|_{2} = u$ 开始。在此设定下，构造一个案例，其中 $\\gamma / \\alpha$ 足够小，以至于 SYMMLQ 的残差 $\\|b - A x_{1}^{\\mathrm{SYMMLQ}}\\|_{2}$ 很小，而 $\\|x_{1}^{\\mathrm{SYMMLQ}}\\|_{2}$ 很大，并且 MINRES 产生了一个更稳定的迭代解 $\\|x_{1}^{\\mathrm{MINRES}}\\|_{2}$。\n\n仅从上述定义和给定的矩阵结构出发，推导 $\\|x_{1}^{\\mathrm{MINRES}}\\|_{2}$ 和 $\\|x_{1}^{\\mathrm{SYMMLQ}}\\|_{2}$ 关于 $\\alpha$ 和 $\\gamma$ 的闭式表达式。然后，通过计算比率来量化解范数的差异\n$$\n\\rho \\;=\\; \\frac{\\|x_{1}^{\\mathrm{SYMMLQ}}\\|_{2}}{\\|x_{1}^{\\mathrm{MINRES}}\\|_{2}}.\n$$\n将您的最终答案表示为关于 $\\alpha$ 和 $\\gamma$ 的单个简化解析表达式。无需四舍五入。",
                "solution": "本题要求在对一个特定的 $2 \\times 2$ 对称不定系统应用 MINRES 和 SYMMLQ 方法一次迭代后，推导解范数的比率 $\\rho = \\|x_{1}^{\\mathrm{SYMMLQ}}\\|_{2} / \\|x_{1}^{\\mathrm{MINRES}}\\|_{2}$。\n\n首先，我们建立线性算子 $A$ 的矩阵表示。该空间由标准正交基 $\\{u, q\\}$ 张成，我们可以将其表示为标准基向量 $u = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $q = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。$A$ 在此基上的作用如下：\n$A u = \\alpha u + \\gamma q$\n$A q = \\gamma u - \\alpha q$\n在此基中，矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix} \\alpha  & \\gamma \\\\ \\gamma  & -\\alpha \\end{pmatrix}\n$$\n$A$ 的特征值 $\\lambda$ 满足特征方程 $\\det(A - \\lambda I) = 0$，即 $(\\alpha - \\lambda)(-\\alpha - \\lambda) - \\gamma^2 = 0$，可得 $\\lambda^2 - \\alpha^2 - \\gamma^2 = 0$。特征值为 $\\lambda_{1,2} = \\pm \\sqrt{\\alpha^2 + \\gamma^2}$。由于 $A$ 是可逆的，$\\alpha$ 和 $\\gamma$ 不能同时为零，因此特征值为实数、非零且符号相反，这证实了 $A$ 是不定的。\n\nMINRES 和 SYMMLQ 都是依赖于兰索斯过程的克里洛夫子空间方法。我们从 $x_0 = 0$ 开始，因此初始残差为 $r_0 = b - Ax_0 = b$。\n给定的右端项是 $b = \\sqrt{2}\\,u$。其范数为 $\\|b\\|_{2} = \\sqrt{2}\\|u\\|_{2} = \\sqrt{2}$。\n兰索斯过程的第一步是对初始残差进行归一化，以得到第一个兰索斯向量 $v_1$：\n$$\nv_1 = \\frac{b}{\\|b\\|_{2}} = \\frac{\\sqrt{2}\\,u}{\\sqrt{2}} = u\n$$\n接下来，我们计算单步兰索斯迭代的系数，这将生成 $1 \\times 1$ 的三对角矩阵 $T_1 = (\\alpha_1)$。\n对角元素 $\\alpha_1$ 由下式给出：\n$$\n\\alpha_1 = v_1^{\\top} A v_1 = u^{\\top} A u = u^{\\top}(\\alpha u + \\gamma q) = \\alpha (u^{\\top}u) + \\gamma (u^{\\top}q) = \\alpha(1) + \\gamma(0) = \\alpha\n$$\n因此，$T_1 = (\\alpha)$。\n非对角元素 $\\beta_2$ 从过程中的下一个向量求得。未归一化的下一个向量是 $w' = A v_1 - \\alpha_1 v_1$：\n$$\nw' = A u - \\alpha u = (\\alpha u + \\gamma q) - \\alpha u = \\gamma q\n$$\n该向量的范数是 $\\beta_2$：\n$$\n\\beta_2 = \\|w'\\|_{2} = \\|\\gamma q\\|_{2} = |\\gamma|\\|q\\|_{2} = |\\gamma|\n$$\n兰索斯过程构建了关系式 $A V_k = V_k T_k + \\beta_{k+1} v_{k+1} e_k^{\\top}$。对于 $k=1$，我们有 $AV_1 = V_1T_1 + \\beta_2 v_2 e_1^\\top$，其中 $V_1 = [v_1] = [u]$。\n\n现在我们为每种方法推导第一次迭代的解 $x_1$。第一次迭代的克里洛夫子空间是 $\\mathcal{K}_1(A, b) = \\mathrm{span}\\{b\\} = \\mathrm{span}\\{v_1\\}$。因此，两次迭代的解都将具有 $x_1 = c\\,v_1 = c\\,u$ 的形式，其中 $c$ 是某个标量。\n\n**MINRES 迭代解**\nMINRES 寻找迭代解 $x_1^{\\mathrm{MINRES}} \\in \\mathcal{K}_1(A, b)$，该解最小化残差的欧几里得范数，$\\|r_1\\|_{2} = \\|b - A x_1\\|_{2}$。\n设 $x_1 = c\\,u$。我们最小化函数 $f(c) = \\|b - A(c\\,u)\\|_{2}^2$：\n$$\nf(c) = \\|\\sqrt{2}\\,u - c A u\\|_{2}^{2} = \\|\\sqrt{2}\\,u - c(\\alpha u + \\gamma q)\\|_{2}^{2} = \\|(\\sqrt{2} - c\\alpha)u - c\\gamma q\\|_{2}^{2}\n$$\n由于 $u$ 和 $q$ 是标准正交的，上式可简化为：\n$$\nf(c) = (\\sqrt{2} - c\\alpha)^{2} + (-c\\gamma)^{2} = (\\sqrt{2} - c\\alpha)^{2} + c^2\\gamma^2\n$$\n为求最小值，我们将关于 $c$ 的导数设为零：\n$$\n\\frac{df}{dc} = 2(\\sqrt{2} - c\\alpha)(-\\alpha) + 2c\\gamma^2 = -2\\sqrt{2}\\alpha + 2c\\alpha^2 + 2c\\gamma^2 = 0\n$$\n$$\nc(\\alpha^2 + \\gamma^2) = \\sqrt{2}\\alpha \\implies c_{\\mathrm{MINRES}} = \\frac{\\sqrt{2}\\alpha}{\\alpha^2 + \\gamma^2}\n$$\nMINRES 的迭代解是 $x_1^{\\mathrm{MINRES}} = c_{\\mathrm{MINRES}}\\,u = \\frac{\\sqrt{2}\\alpha}{\\alpha^2 + \\gamma^2} u$。\n该迭代解的范数是：\n$$\n\\|x_1^{\\mathrm{MINRES}}\\|_{2} = \\left\\| \\frac{\\sqrt{2}\\alpha}{\\alpha^2 + \\gamma^2} u \\right\\|_{2} = \\left| \\frac{\\sqrt{2}\\alpha}{\\alpha^2 + \\gamma^2} \\right| \\|u\\|_{2} = \\frac{\\sqrt{2}|\\alpha|}{\\alpha^2 + \\gamma^2}\n$$\n\n**SYMMLQ 迭代解**\nSYMMLQ 寻找迭代解 $x_1^{\\mathrm{SYMMLQ}} = V_1 y_1$，其中 $y_1$ 是投影系统 $T_1 y_1 = \\|b\\|_{2} e_1$ 的解。这里，$V_1=[v_1]$，$y_1$ 是一个标量，而 $e_1$ 是 $\\mathbb{R}^1$ 中的第一个标准基向量，即标量 $1$。\n投影系统为：\n$$\n\\alpha \\cdot y_1 = \\sqrt{2}\n$$\n问题陈述中提到了 $\\gamma/\\alpha$，这意味着 $\\alpha \\neq 0$。因此，我们可以解出 $y_1$：\n$$\ny_1 = \\frac{\\sqrt{2}}{\\alpha}\n$$\nSYMMLQ 的迭代解是 $x_1^{\\mathrm{SYMMLQ}} = y_1 v_1 = \\frac{\\sqrt{2}}{\\alpha} u$。\n该迭代解的范数是：\n$$\n\\|x_1^{\\mathrm{SYMMLQ}}\\|_{2} = \\left\\| \\frac{\\sqrt{2}}{\\alpha} u \\right\\|_{2} = \\left| \\frac{\\sqrt{2}}{\\alpha} \\right| \\|u\\|_{2} = \\frac{\\sqrt{2}}{|\\alpha|}\n$$\n\n**范数之比**\n最后，我们计算比率 $\\rho$：\n$$\n\\rho = \\frac{\\|x_{1}^{\\mathrm{SYMMLQ}}\\|_{2}}{\\|x_{1}^{\\mathrm{MINRES}}\\|_{2}} = \\frac{\\frac{\\sqrt{2}}{|\\alpha|}}{\\frac{\\sqrt{2}|\\alpha|}{\\alpha^2 + \\gamma^2}}\n$$\n$$\n\\rho = \\frac{\\sqrt{2}}{|\\alpha|} \\cdot \\frac{\\alpha^2 + \\gamma^2}{\\sqrt{2}|\\alpha|} = \\frac{\\alpha^2 + \\gamma^2}{|\\alpha|^2} = \\frac{\\alpha^2 + \\gamma^2}{\\alpha^2}\n$$\n该表达式量化了 SYMMLQ 和 MINRES 一次迭代所产生的解向量在大小上的差异。当 $\\gamma/\\alpha \\to 0$ 时，$\\rho \\to 1$，两种方法产生相似的迭代解。对于小的 $\\alpha$ 和不小的 $\\gamma$，该比率可能变得非常大，这反映了对于不定系统，标准的 Galerkin 方法（SYMMLQ）相比于残差最小化方法（MINRES）可能存在的不稳定性。",
                "answer": "$$\\boxed{\\frac{\\alpha^2 + \\gamma^2}{\\alpha^2}}$$",
                "id": "3560323"
            }
        ]
    }