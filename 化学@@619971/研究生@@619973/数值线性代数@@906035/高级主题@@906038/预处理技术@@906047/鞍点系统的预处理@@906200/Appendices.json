{
        "hands_on_practices": [
            {
                "introduction": "理论的探索始于理想化的情形。本练习将通过一个简洁的解析计算，对比两种基于精确舒尔补的理想预条件子——块对角预条件子和块三角预条件子。通过计算预条件化后算子的谱（特征值集合），你将从结构上深刻理解为何块三角形式能实现完美的谱聚类，从而为预条件子的设计提供一个重要的理论基准。",
                "problem": "考虑鞍点系统，其包含对称正定 (SPD) 块 $A \\in \\mathbb{R}^{2 \\times 2}$ 和满行秩约束块 $B \\in \\mathbb{R}^{1 \\times 2}$，具体如下\n$$\nA = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1  -2 \\end{pmatrix},\n$$\n以及 $3 \\times 3$ 的 KKT (Karush–Kuhn–Tucker) 矩阵\n$$\nK = \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix}.\n$$\n定义理想舒尔补 $S_{\\star} = B A^{-1} B^{\\top}$ 和两个预条件子：\n- 块对角预条件子\n$$\nM_{D} = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix},\n$$\n- 块三角预条件子\n$$\nM_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix}.\n$$\n从舒尔补、预处理和块矩阵运算的核心定义出发，首先计算给定 $A$ 和 $B$ 时预处理算子 $M_{D}^{-1} K$ 的谱（特征值的多重集）。然后，对块三角预条件子重复此计算，即计算使用相同 $A$ 和 $B$ 的 $M_{T}^{-1} K$ 的谱。通过解释聚类方面任何差异的结构性原因，包括使用精确舒尔补的影响和块分解性质，来比较这两个谱。\n\n将你的最终答案表示为 $M_{T}^{-1} K$ 的特征值，在单行中列出（包括重数），并以精确形式给出。无需四舍五入。",
                "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 对称正定 (SPD) 块 $A \\in \\mathbb{R}^{2 \\times 2}$ 为 $A = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$。\n- 满行秩约束块 $B \\in \\mathbb{R}^{1 \\times 2}$ 为 $B = \\begin{pmatrix} 1  -2 \\end{pmatrix}$。\n- Karush–Kuhn–Tucker (KKT) 矩阵为 $K = \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix}$。\n- 理想舒尔补定义为 $S_{\\star} = B A^{-1} B^{\\top}$。\n- 块对角预条件子为 $M_{D} = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix}$。\n- 块三角预条件子为 $M_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix}$。\n- 任务是计算 $M_{D}^{-1} K$ 的谱，计算 $M_{T}^{-1} K$ 的谱，并通过结构性解释对它们进行比较。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题植根于数值线性代数，特别是鞍点系统的预处理。所有定义和矩阵在该领域都是标准的。\n2.  **适定性**：矩阵 $A$ 是对称的。其行列式为 $\\det(A) = (4)(3) - (1)(1) = 11 > 0$，且主子式为 $4 > 0$，因此如题所述，$A$ 是正定的。矩阵 $B$ 是一个非零行向量，因此具有满行秩。这些条件确保了 KKT 矩阵 $K$ 是非奇异的，且舒尔补 $S_{\\star}$ 是良定义且可逆的。该问题是自洽的，并指定了明确的计算任务。\n3.  **客观性**：该问题以精确的数学语言陈述，没有歧义或主观论断。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是适定的、有科学依据的且客观的。将提供完整的解答。\n\n### 解答\n\n解答过程首先计算必要的组成部分，然后分析每个预处理系统，最后提供结构性比较。\n\n**1. 初步计算**\n\n首先，我们计算矩阵 $A$ 的逆：\n$$\nA^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}\n$$\n接下来，我们计算 $B$ 的转置：\n$$\nB^{\\top} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n$$\n现在，我们可以计算理想舒尔补 $S_{\\star} = B A^{-1} B^{\\top}$。由于 $B$ 是一个 $1 \\times 2$ 矩阵，$S_{\\star}$ 将是一个 $1 \\times 1$ 矩阵（一个标量）。\n$$\nS_{\\star} = \\begin{pmatrix} 1  -2 \\end{pmatrix} \\left( \\frac{1}{11} \\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n$$\n$$\nS_{\\star} = \\frac{1}{11} \\begin{pmatrix} 1  -2 \\end{pmatrix} \\begin{pmatrix} 3(1) + (-1)(-2) \\\\ -1(1) + 4(-2) \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 1  -2 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ -9 \\end{pmatrix}\n$$\n$$\nS_{\\star} = \\frac{1}{11} \\left( 1(5) + (-2)(-9) \\right) = \\frac{1}{11} (5 + 18) = \\frac{23}{11}\n$$\n\n**2. 块对角预处理系统 $M_{D}^{-1} K$ 的谱**\n\n块对角预条件子为 $M_{D} = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix}$。其逆为 $M_{D}^{-1} = \\begin{pmatrix} A^{-1}  0 \\\\ 0  S_{\\star}^{-1} \\end{pmatrix}$。\n预处理矩阵为：\n$$\nM_{D}^{-1} K = \\begin{pmatrix} A^{-1}  0 \\\\ 0  S_{\\star}^{-1} \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix} = \\begin{pmatrix} A^{-1}A  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B  0 \\end{pmatrix} = \\begin{pmatrix} I  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B  0 \\end{pmatrix}\n$$\n为了找到特征值 $\\lambda$，我们求解特征方程 $\\det(M_{D}^{-1} K - \\lambda I) = 0$。\n特征多项式由 $\\det \\begin{pmatrix} (1-\\lambda)I  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B  -\\lambda I_p \\end{pmatrix} = 0$ 给出，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$I_p$ 是 $1 \\times 1$ 单位矩阵。\n使用块矩阵行列式公式，对于 $\\lambda \\neq 1$：\n$$\n\\det((1-\\lambda)I) \\det(-\\lambda I_p - (S_{\\star}^{-1}B) ((1-\\lambda)I)^{-1} (A^{-1}B^{\\top})) = 0\n$$\n$$\n(1-\\lambda)^{2} \\det(-\\lambda - \\frac{1}{1-\\lambda} S_{\\star}^{-1} (B A^{-1} B^{\\top})) = 0\n$$\n$$\n(1-\\lambda)^{2} (-\\lambda - \\frac{1}{1-\\lambda} S_{\\star}^{-1} S_{\\star}) = 0\n$$\n$$\n(1-\\lambda)^{2} (-\\lambda - \\frac{1}{1-\\lambda}) = 0\n$$\n乘以 $(1-\\lambda)$，我们得到 $(1-\\lambda) [-\\lambda(1-\\lambda) - 1] = 0$。这在 $\\lambda \\neq 1$ 时有效。如果 $\\lambda=1$ 是一个根，我们必须单独检查。在此公式中，我们发现我们有：\n$$\n(1-\\lambda) (\\lambda^2 - \\lambda - 1) = 0\n$$\n这个方程给出了三个不同的特征值：\n- $\\lambda_1 = 1$\n- $\\lambda^2 - \\lambda - 1 = 0$ 的根，根据二次公式为 $\\lambda = \\frac{1 \\pm \\sqrt{1 - 4(1)(-1)}}{2} = \\frac{1 \\pm \\sqrt{5}}{2}$。\n所以，$\\lambda_2 = \\frac{1+\\sqrt{5}}{2}$ 且 $\\lambda_3 = \\frac{1-\\sqrt{5}}{2}$。\n$M_{D}^{-1} K$ 的谱为 $\\left\\{ 1, \\frac{1+\\sqrt{5}}{2}, \\frac{1-\\sqrt{5}}{2} \\right\\}$。\n\n**3. 块三角预处理系统 $M_{T}^{-1} K$ 的谱**\n\n块三角预条件子为 $M_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix}$。为了求其逆 $M_{T}^{-1} = \\begin{pmatrix} X  Y \\\\ Z  W \\end{pmatrix}$，我们求解 $M_{T} M_{T}^{-1} = I$：\n$$\n\\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix} \\begin{pmatrix} X  Y \\\\ Z  W \\end{pmatrix} = \\begin{pmatrix} AX  AY \\\\ BX-S_{\\star}Z  BY-S_{\\star}W \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ 0  I \\end{pmatrix}\n$$\n这得到 $AX=I \\implies X=A^{-1}$；$AY=0 \\implies Y=0$；$-S_{\\star}W=I \\implies W=-S_{\\star}^{-1}$；以及 $BX-S_{\\star}Z=0 \\implies Z=S_{\\star}^{-1}BX=S_{\\star}^{-1}BA^{-1}$。\n所以，$M_{T}^{-1} = \\begin{pmatrix} A^{-1}  0 \\\\ S_{\\star}^{-1}BA^{-1}  -S_{\\star}^{-1} \\end{pmatrix}$。\n预处理矩阵为：\n$$\nM_{T}^{-1} K = \\begin{pmatrix} A^{-1}  0 \\\\ S_{\\star}^{-1}BA^{-1}  -S_{\\star}^{-1} \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix}\n$$\n$$\nM_{T}^{-1} K = \\begin{pmatrix} A^{-1}A  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}BA^{-1}A - S_{\\star}^{-1}B  S_{\\star}^{-1}BA^{-1}B^{\\top} \\end{pmatrix} = \\begin{pmatrix} I  A^{-1}B^{\\top} \\\\ S_{\\star}^{-1}B - S_{\\star}^{-1}B  S_{\\star}^{-1}S_{\\star} \\end{pmatrix}\n$$\n$$\nM_{T}^{-1} K = \\begin{pmatrix} I  A^{-1}B^{\\top} \\\\ 0  1 \\end{pmatrix}\n$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵，$1$ 是标量 $1$。这是一个块上三角矩阵。块三角矩阵的特征值是其对角块的特征值。\n- 左上角块 $I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$ 的特征值为 $1$ 和 $1$。\n- 右下角块，即标量 $1$ 的特征值为 $1$。\n因此，$M_{T}^{-1} K$ 的谱为 $\\{1, 1, 1\\}$。\n\n**4. 比较与结构性解释**\n\n$M_{D}^{-1} K$ 的谱为 $\\left\\{ 1, \\frac{1+\\sqrt{5}}{2}, \\frac{1-\\sqrt{5}}{2} \\right\\}$，而 $M_{T}^{-1} K$ 的谱为 $\\{1, 1, 1\\}$。差异是显著的，源于预条件子的结构特性。\n\nKKT 矩阵 $K$ 允许一个类块 LU 分解：\n$$\nK = \\begin{pmatrix} A  B^{\\top} \\\\ B  0 \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix} \\begin{pmatrix} I  A^{-1} B^{\\top} \\\\ 0  I \\end{pmatrix}\n$$\n块三角预条件子 $M_T$ 定义为：\n$$\nM_{T} = \\begin{pmatrix} A  0 \\\\ B  -S_{\\star} \\end{pmatrix} = \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix}\n$$\n$M_T$ 被构造成恰好是 $K$ 分解中前两个矩阵的乘积。因此，当我们构成预处理算子 $M_T^{-1} K$ 时，这两个因子完全抵消：\n$$\nM_{T}^{-1} K = \\left( \\left( \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix} \\right)^{-1} \\right) \\left( \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  0 \\\\ 0  -S_{\\star} \\end{pmatrix} \\begin{pmatrix} I  A^{-1} B^{\\top} \\\\ 0  I \\end{pmatrix} \\right) = \\begin{pmatrix} I  A^{-1} B^{\\top} \\\\ 0  I \\end{pmatrix}\n$$\n结果是一个主对角线上为 1、左下角为零块的矩阵。这样的矩阵是幺幂矩阵，其所有特征值都为 $1$。这就是为什么 $M_{T}^{-1} K$ 的谱完全聚集在 $1$ 处。在实践中，使用精确舒尔补使 $M_T$ 成为一个理想的预条件子，从而导致像 GMRES 这样的迭代方法在可预测的少量迭代中收敛。\n\n块对角预条件子 $M_D = \\begin{pmatrix} A  0 \\\\ 0  S_{\\star} \\end{pmatrix}$ 并未完全捕捉 $K$ 的分解结构。它正确地预处理了对角块 $A$，但其对 $(2,2)$ 块 $S_{\\star}$ 的处理与分解项 $-S_{\\star}$ 的符号不同，更重要的是，它忽略了 L 和 U 因子（由 $B$ 和 $B^{\\top}$ 表示）中固有的非对角耦合。由此产生的预处理算子 $M_{D}^{-1} K$ 不是三角矩阵，其特征值通常不为 $1$。在使用精确 $A$ 和精确 $S_{\\star}$ 的情况下，一个已知的理论结果是，特征值总是 $1$（重数等于 $A$ 的大小减去 $B$ 的秩）和 $\\lambda^2 - \\lambda - 1 = 0$ 的根（每个根的重数等于 $B$ 的秩）。我们的计算证实了这一通用理论对于具有秩为 1 约束的特定 $2 \\times 2$ 情况成立。\n\n总而言之，$M_T$ 是一个结构上更优的预条件子，因为它基于 $K$ 的块分解，从而得到理想的谱。$M_D$ 的构造更简单，但效果较差，因为它忽略了非对角块结构，导致谱的聚集性较差。",
                "answer": "$$\n\\boxed{1, 1, 1}\n$$",
                "id": "3566697"
            },
            {
                "introduction": "在掌握了理想预条件子的理论之后，我们转向更贴近现实的挑战：在实践中，精确的舒尔补通常难以计算。这个动手编程练习将引导你为一个经典的混合泊松问题构建鞍点系统，并实现几种实用的舒尔补近似，例如雅可比近似和质量矩阵近似。通过数值计算预条件化后算子的特征值，你将亲眼观察到不同预条件子对系统谱分布的真实影响，从而将理论与代码实践紧密结合。",
                "problem": "设计并实现一个完整的、可运行的程序，该程序在一个均匀的 $2\\times 2$ 笛卡尔网格上，使用最低阶混合方法构建泊松方程的离散混合形式。其中，通量未知量位于内部边上，压力未知量位于单元中心。您的目标是组装一个对称的鞍点矩阵，定义三个块对角预条件子，并计算对称预处理后算子的特征值，以说明谱聚类现象。\n\n从以下基本原理开始：\n- 泊松方程的混合形式引入了通量变量 $\\boldsymbol{q}$ 和标量压力 $u$，满足 $ \\boldsymbol{q} + \\nabla u = \\boldsymbol{0}$ 和 $ \\nabla \\cdot \\boldsymbol{q} = g$。离散化后，得到如下形式的对称鞍点系统\n$$\n\\begin{bmatrix}\n\\boldsymbol{M}  \\boldsymbol{B}^{\\top} \\\\\n\\boldsymbol{B}  \\boldsymbol{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\boldsymbol{q} \\\\\n\\boldsymbol{u}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\boldsymbol{f} \\\\\n\\boldsymbol{g}\n\\end{bmatrix},\n$$\n其中 $\\boldsymbol{M}$ 是一个对称正定（SPD）的通量质量矩阵，$\\boldsymbol{B}$ 是一个离散散度算子。\n- 预处理使用一个块对角 SPD 矩阵 $\\boldsymbol{P} = \\operatorname{diag}(\\boldsymbol{M}, \\boldsymbol{S}_{\\text{approx}})$，其中 $\\boldsymbol{S}_{\\text{approx}}$ 是对舒尔补 $\\boldsymbol{S} = \\boldsymbol{B}\\,\\boldsymbol{M}^{-1}\\boldsymbol{B}^{\\top}$ 的一个 SPD 近似。\n\n在单位正方形上使用一个包含 $2\\times 2$ 个单元的均匀网格。只将内部边的通量视为未知量（边界边上的法向通量为零），并通过移除一个单元压力自由度来施加零均值压力约束，以消除零空间。将四个单元索引为 $c_0$（左下）、$c_1$（右下）、$c_2$（左上）和 $c_3$（右上）。将四个内部边索引如下：\n- $e_0$：$c_0$ 和 $c_1$ 之间的垂直边，正方向从 $c_0$ 指向 $c_1$，\n- $e_1$：$c_2$ 和 $c_3$ 之间的垂直边，正方向从 $c_2$ 指向 $c_3$，\n- $e_2$：$c_0$ 和 $c_2$ 之间的水平边，正方向从 $c_0$ 指向 $c_2$，\n- $e_3$：$c_1$ 和 $c_3$ 之间的水平边，正方向从 $c_1$ 指向 $c_3$。\n\n令通量质量矩阵为 $\\boldsymbol{M}=\\boldsymbol{I}_{4}$（4条内部边上的单位矩阵）。通过移除对应于 $c_3$ 的方程来施加零均值约束，构建离散散度矩阵 $\\boldsymbol{B}\\in\\mathbb{R}^{3\\times 4}$。其列对应于边 $(e_0,e_1,e_2,e_3)$，行对应于单元 $(c_0,c_1,c_2)$：\n- 对于 $e_0$（在 $c_0$ 和 $c_1$ 之间）：在 $c_0$ 对应的行中置 $+1$，在 $c_1$ 对应的行中置 $-1$，\n- 对于 $e_1$（在 $c_2$ 和 $c_3$ 之间）：在 $c_2$ 对应的行中置 $+1$，\n- 对于 $e_2$（在 $c_0$ 和 $c_2$ 之间）：在 $c_0$ 对应的行中置 $+1$，在 $c_2$ 对应的行中置 $-1$，\n- 对于 $e_3$（在 $c_1$ 和 $c_3$ 之间）：在 $c_1$ 对应的行中置 $+1$。\n\n组装鞍点矩阵\n$$\n\\boldsymbol{K}=\n\\begin{bmatrix}\n\\boldsymbol{M}  \\boldsymbol{B}^{\\top} \\\\\n\\boldsymbol{B}  \\boldsymbol{0}\n\\end{bmatrix}\n\\in \\mathbb{R}^{7\\times 7}.\n$$\n\n定义三个块对角 SPD 预条件子\n$$\n\\boldsymbol{P}=\\operatorname{diag}(\\boldsymbol{M},\\boldsymbol{S}_{\\text{approx}}),\n$$\n对应于以下舒尔补近似 $\\boldsymbol{S}_{\\text{approx}}$ 的测试套件：\n- 测试 1：精确舒尔补 $\\boldsymbol{S}=\\boldsymbol{B}\\,\\boldsymbol{M}^{-1}\\boldsymbol{B}^{\\top}$，\n- 测试 2：Jacobi 近似 $\\boldsymbol{S}_{\\text{diag}}=\\operatorname{diag}(\\boldsymbol{S})$，\n- 测试 3：压力质量近似 $\\boldsymbol{S}_{\\text{mass}}=(h^2)\\,\\boldsymbol{I}_{3}$，其中单元宽度 $h=1/2$，因此 $\\boldsymbol{S}_{\\text{mass}}=\\frac{1}{4}\\,\\boldsymbol{I}_{3}$。\n\n对每个测试，计算对称预处理后算子的实特征值\n$$\n\\boldsymbol{C} = \\boldsymbol{P}^{-1/2}\\,\\boldsymbol{K}\\,\\boldsymbol{P}^{-1/2},\n$$\n其中 $\\boldsymbol{P}$ 的对称平方根和逆平方根是分块计算的，对压力块使用谱分解。将特征值按升序排序。\n\n您的程序必须实现上述构造，执行三个测试，并输出特征值列表（作为浮点数）。无需报告物理单位。不使用角度。不使用百分比。\n\n测试套件：\n- 输入是隐式的；根据上面定义的测试标识符 $1,2,3$ 构造并评估这三种情况。\n\n预期输出类型和格式：\n- 对于每个测试用例，生成一个排序后的特征值列表，列表元素为浮点数。\n- 将三个列表聚合到单行输出中，形式为类似 JSON 的无空格嵌套列表，例如 $[ [\\cdot],[\\cdot],[\\cdot] ]$，但逗号后没有空格。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个特征值格式化为浮点数（例如，$-1.00000000$）。确切地说：程序必须打印形如 $[[\\text{vals\\_for\\_test\\_1}],[\\text{vals\\_for\\_test\\_2}],[\\text{vals\\_for\\_test\\_3}]]$ 的单行，且无额外文本。",
                "solution": "该问题是有效的。它提出了一个定义明确的数值线性代数任务，该任务基于混合有限元法产生的鞍点系统预处理的既定理论。所有必要的数据和定义都已提供，问题是自洽、一致且科学合理的。\n\n目标是分析从 $2 \\times 2$ 网格上泊松方程的混合离散化派生出的鞍点系统的谱特性。通过在应用三种不同的对称块对角预条件子后计算系统特征值来进行此分析。\n\n首先，我们构造离散鞍点系统的矩阵：\n$$\n\\boldsymbol{K}\\begin{bmatrix} \\boldsymbol{q} \\\\ \\boldsymbol{u} \\end{bmatrix} = \\begin{bmatrix} \\boldsymbol{M}  \\boldsymbol{B}^{\\top} \\\\ \\boldsymbol{B}  \\boldsymbol{0} \\end{bmatrix} \\begin{bmatrix} \\boldsymbol{q} \\\\ \\boldsymbol{u} \\end{bmatrix} = \\begin{bmatrix} \\boldsymbol{f} \\\\ \\boldsymbol{g} \\end{bmatrix}\n$$\n通量自由度 $\\boldsymbol{q} \\in \\mathbb{R}^4$ 对应于 4 个内部边，压力自由度 $\\boldsymbol{u} \\in \\mathbb{R}^3$ 对应于单元 $c_0, c_1, c_2$ 中的压力，其中单元 $c_3$ 中的压力已被消除以施加零均值约束。\n\n通量质量矩阵 $\\boldsymbol{M}$ 被指定为 $4 \\times 4$ 的单位矩阵，即 $\\boldsymbol{M} = \\boldsymbol{I}_4$。\n\n离散散度算子 $\\boldsymbol{B} \\in \\mathbb{R}^{3 \\times 4}$ 将边 $(e_0, e_1, e_2, e_3)$ 上的通量映射到单元 $(c_0, c_1, c_2)$ 的中心散度。根据指定的方向和连通性：\n- 边 $e_0$（从 $c_0$到 $c_1$）：对单元 $c_0$ 贡献 $+1$，对单元 $c_1$ 贡献 $-1$。\n- 边 $e_1$（从 $c_2$ 到 $c_3$）：对单元 $c_2$ 贡献 $+1$（对 $c_3$ 的贡献被省略）。\n- 边 $e_2$（从 $c_0$到 $c_2$）：对单元 $c_0$ 贡献 $+1$，对单元 $c_2$ 贡献 $-1$。\n- 边 $e_3$（从 $c_1$ 到 $c_3$）：对单元 $c_1$ 贡献 $+1$（对 $c_3$ 的贡献被省略）。\n这就得到了矩阵：\n$$\n\\boldsymbol{B} = \\begin{bmatrix}\n1  0  1  0 \\\\\n-1  0  0  1 \\\\\n0  1  -1  0\n\\end{bmatrix}\n$$\n完整的 $7 \\times 7$ 鞍点矩阵 $\\boldsymbol{K}$ 则是：\n$$\n\\boldsymbol{K} =\n\\begin{bmatrix}\n\\boldsymbol{I}_4  \\boldsymbol{B}^{\\top} \\\\\n\\boldsymbol{B}  \\boldsymbol{0}_{3\\times3}\n\\end{bmatrix}\n=\n\\left[\n\\begin{array}{cccc|ccc}\n1  0  0  0  1  -1  0 \\\\\n0  1  0  0  0  0  1 \\\\\n0  0  1  0  1  0  -1 \\\\\n0  0  0  1  0  1  0 \\\\\n\\hline\n1  0  1  0  0  0  0 \\\\\n-1  0  0  1  0  0  0 \\\\\n0  1  -1  0  0  0  0\n\\end{array}\n\\right]\n$$\n我们分析对称预处理算子 $\\boldsymbol{C} = \\boldsymbol{P}^{-1/2} \\boldsymbol{K} \\boldsymbol{P}^{-1/2}$ 的特征值，其中 $\\boldsymbol{P} = \\operatorname{diag}(\\boldsymbol{M}, \\boldsymbol{S}_{\\text{approx}})$ 是块对角预条件子。给定 $\\boldsymbol{M} = \\boldsymbol{I}_4$，预条件子为 $\\boldsymbol{P} = \\operatorname{diag}(\\boldsymbol{I}_4, \\boldsymbol{S}_{\\text{approx}})$，其逆平方根为 $\\boldsymbol{P}^{-1/2} = \\operatorname{diag}(\\boldsymbol{I}_4, \\boldsymbol{S}_{\\text{approx}}^{-1/2})$。预处理后的矩阵简化为：\n$$\n\\boldsymbol{C} = \\begin{bmatrix} \\boldsymbol{I}_4  \\boldsymbol{B}^{\\top} \\boldsymbol{S}_{\\text{approx}}^{-1/2} \\\\ \\boldsymbol{S}_{\\text{approx}}^{-1/2} \\boldsymbol{B}  \\boldsymbol{0}_{3\\times3} \\end{bmatrix}\n$$\n这是一个对称矩阵，所以它的特征值是实数。我们针对 $\\boldsymbol{S}_{\\text{approx}}$ 的三种选择计算它们。\n\n测试 1：精确舒尔补预条件子。\n此处，$\\boldsymbol{S}_{\\text{approx}} = \\boldsymbol{S} = \\boldsymbol{B}\\boldsymbol{M}^{-1}\\boldsymbol{B}^{\\top} = \\boldsymbol{B}\\boldsymbol{B}^{\\top}$。\n$$\n\\boldsymbol{S} = \\begin{bmatrix}\n1  0  1  0 \\\\\n-1  0  0  1 \\\\\n0  1  -1  0\n\\end{bmatrix}\n\\begin{bmatrix}\n1  -1  0 \\\\\n0  0  1 \\\\\n1  0  -1 \\\\\n0  1  0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2  -1  -1 \\\\\n-1  2  0 \\\\\n-1  0  2\n\\end{bmatrix}\n$$\n逆平方根 $\\boldsymbol{S}^{-1/2}$ 通过谱分解计算：$\\boldsymbol{S} = \\boldsymbol{V}\\boldsymbol{\\Lambda}\\boldsymbol{V}^{\\top}$，因此 $\\boldsymbol{S}^{-1/2} = \\boldsymbol{V}\\boldsymbol{\\Lambda}^{-1/2}\\boldsymbol{V}^{\\top}$。理论上已知所得矩阵 $\\boldsymbol{C}_1$ 的特征值为 $1$（重数为 $4-3=1$）和 $\\frac{1 \\pm \\sqrt{5}}{2}$（每个重数为 $3$）。\n\n测试 2：Jacobi 预条件子。\n近似是精确舒尔补的对角线部分：$\\boldsymbol{S}_{\\text{approx}} = \\boldsymbol{S}_{\\text{diag}} = \\operatorname{diag}(\\boldsymbol{S})$。\n$$\n\\boldsymbol{S}_{\\text{diag}} = \\operatorname{diag}(2, 2, 2) = 2\\boldsymbol{I}_3\n$$\n其逆平方根为 $\\boldsymbol{S}_{\\text{diag}}^{-1/2} = (2\\boldsymbol{I}_3)^{-1/2} = \\frac{1}{\\sqrt{2}}\\boldsymbol{I}_3$。然后构建矩阵 $\\boldsymbol{C}_2$，并数值计算其特征值。\n\n测试 3：压力质量矩阵预条件子。\n近似为 $\\boldsymbol{S}_{\\text{approx}} = \\boldsymbol{S}_{\\text{mass}} = h^2 \\boldsymbol{I}_3$。当单元宽度 $h = 1/2$ 时，这变为 $\\boldsymbol{S}_{\\text{mass}} = \\frac{1}{4}\\boldsymbol{I}_3$。\n其逆平方根为 $\\boldsymbol{S}_{\\text{mass}}^{-1/2} = (\\frac{1}{4}\\boldsymbol{I}_3)^{-1/2} = 2\\boldsymbol{I}_3$。然后构建矩阵 $\\boldsymbol{C}_3$，并计算其特征值。\n\n对于这三种情况中的每一种，计算相应矩阵 $\\boldsymbol{C}$ 的七个实特征值，并按升序排序。然后将这些特征值列表作为最终结果报告。",
                "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Constructs a saddle-point system for a mixed-FEM discretization of the\n    Poisson equation on a 2x2 grid, applies three different block-diagonal\n    preconditioners, and computes the eigenvalues of the preconditioned systems.\n    \"\"\"\n    \n    # Define the flux mass matrix M (4x4 identity) and the discrete divergence B (3x4).\n    # M is for 4 interior edge fluxes.\n    # B maps fluxes to divergences in cells c0, c1, c2.\n    M = np.eye(4)\n    B = np.array([\n        [1.0, 0.0, 1.0, 0.0],   # Divergence in cell c0\n        [-1.0, 0.0, 0.0, 1.0],  # Divergence in cell c1\n        [0.0, 1.0, -1.0, 0.0]   # Divergence in cell c2\n    ])\n\n    test_cases_defs = []\n\n    # Test 1: Exact Schur complement preconditioner\n    # S_approx = S = B * M^-1 * B.T. Since M=I, S = B * B.T\n    S = B @ B.T\n    # Calculate S_approx^{-1/2} using spectral decomposition (eigh)\n    w_s, v_s = linalg.eigh(S)\n    if np.any(w_s == 0):\n        # This should not happen for a valid problem setup\n        raise ValueError(\"Schur complement S is not positive definite.\")\n    S_inv_sqrt_1 = v_s @ np.diag(1.0 / np.sqrt(w_s)) @ v_s.T\n    test_cases_defs.append(S_inv_sqrt_1)\n\n    # Test 2: Jacobi preconditioner\n    # S_approx = diag(S)\n    S_diag = np.diag(np.diag(S))\n    # S_diag is diagonal, so its inverse square root is easy to compute\n    S_inv_sqrt_2 = np.diag(1.0 / np.sqrt(np.diag(S_diag)))\n    test_cases_defs.append(S_inv_sqrt_2)\n\n    # Test 3: Pressure mass matrix preconditioner\n    # S_approx = h^2 * I, with h=1/2.\n    h = 0.5\n    S_mass = (h**2) * np.eye(3)\n    # S_mass is a multiple of identity, inverse square root is scalar operation.\n    S_inv_sqrt_3 = (1.0 / h) * np.eye(3)\n    test_cases_defs.append(S_inv_sqrt_3)\n\n    results = []\n    num_flux_dofs = M.shape[0]\n    num_pressure_dofs = B.shape[0]\n    total_dofs = num_flux_dofs + num_pressure_dofs\n\n    for S_approx_inv_sqrt in test_cases_defs:\n        # Construct the symmetrically preconditioned matrix C\n        # C = [ I,            B.T @ S_approx^{-1/2} ]\n        #     [ S_approx^{-1/2} @ B,  0          ]\n        # Since M=I, the (1,1) block is M^{-1/2} @ M @ M^{-1/2} = I\n        C = np.zeros((total_dofs, total_dofs))\n        \n        # Top-left block (flux-flux)\n        C[0:num_flux_dofs, 0:num_flux_dofs] = np.eye(num_flux_dofs)\n        \n        # Top-right block (flux-pressure)\n        C[0:num_flux_dofs, num_flux_dofs:total_dofs] = B.T @ S_approx_inv_sqrt\n        \n        # Bottom-left block (pressure-flux)\n        C[num_flux_dofs:total_dofs, 0:num_flux_dofs] = S_approx_inv_sqrt @ B\n        \n        # Bottom-right block is zero.\n\n        # C is symmetric, so use eigh for efficiency and guaranteed real eigenvalues.\n        # linalg.eigh returns eigenvalues in ascending order.\n        eigenvalues = linalg.eigvalsh(C)\n        results.append(eigenvalues.tolist())\n\n    # Format the final output string as a JSON-like nested list with no spaces.\n    results_str = []\n    for eig_list in results:\n        formatted_eigs = [f\"{eig:.8f}\" for eig in eig_list]\n        results_str.append(\"[\" + \",\".join(formatted_eigs) + \"]\")\n    final_output = \"[\" + \",\".join(results_str) + \"]\"\n    \n    print(final_output)\n\nsolve()\n```",
                "id": "3566630"
            },
            {
                "introduction": "最后，我们将目光投向更复杂的情形——由奥西（Oseen）方程等对流主导问题产生的非对称鞍点系统。在这种情况下，仅仅依赖特征值分析可能会产生误导，因为系统的非正规性（non-normality）会导致迭代过程出现瞬态增长（transient growth）。本练习将指导你使用伪谱（pseudospectra）这一现代数值分析工具来量化和理解非正规性，并探索如何通过在预条件子中引入阻尼项来抑制这种不良行为，这对于解决现实世界中的流体力学等问题至关重要。",
                "problem": "考虑由线性化 Oseen 方程产生的一个鞍点系统，该系统在一维均匀网格上离散化，该网格具有 $n$ 个内部速度节点和网格间距 $h$，从而产生分块矩阵\n$$\n\\mathbf{K} \\;=\\; \\begin{bmatrix}\n\\mathbf{A}  \\mathbf{B}^\\top \\\\\n\\mathbf{B}  \\mathbf{0}\n\\end{bmatrix},\n$$\n其中 $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ 是一个离散 Oseen 算子，由一个对称正定扩散部分和一个斜对称对流部分组成，而 $\\mathbf{B} \\in \\mathbb{R}^{m \\times n}$（其中 $m=n-1$）是一个离散散度算子。扩散算子由带 Dirichlet 边界的二阶中心差分拉普拉斯算子建模，对流算子由 $c\\,\\partial_x$（其中 $c \\in \\mathbb{R}$）的中心差分离散建模，得到一个斜对称三对角矩阵。设粘度为 $\\nu > 0$，对流强度为 $c \\ge 0$。离散算子如下：\n- 扩散：$\\mathbf{L} \\in \\mathbb{R}^{n \\times n}$，为三对角矩阵，主对角线元素为 $2/h^2$，第一亚对角线和第一超对角线元素为 $-1/h^2$。\n- 对流：$\\mathbf{C} \\in \\mathbb{R}^{n \\times n}$，为三对角矩阵，其中 $\\mathbf{C}_{i,i+1} = c/(2h)$ 且 $\\mathbf{C}_{i+1,i} = -c/(2h)$，得到一个斜对称矩阵。\n- 速度块：$\\mathbf{A} = \\nu \\mathbf{L} + \\mathbf{C}$。\n- 散度：$\\mathbf{B} \\in \\mathbb{R}^{m \\times n}$，其行 $i=1,\\dots,m$ 的作用是 $(\\mathbf{B} \\mathbf{u})_i = \\frac{-u_i + u_{i+1}}{h}$。\n\n考虑分块对角预条件子\n$$\n\\mathbf{P} \\;=\\; \\begin{bmatrix}\n\\mathbf{A}  \\mathbf{0} \\\\\n\\mathbf{0}  \\widehat{\\mathbf{S}}\n\\end{bmatrix},\n$$\n其中 $\\widehat{\\mathbf{S}} \\in \\mathbb{R}^{m \\times m}$ 近似 Schur 补 $\\mathbf{S} = -\\mathbf{B} \\mathbf{A}^{-1} \\mathbf{B}^\\top$。我们研究左预处理算子\n$$\n\\mathbf{M} \\;=\\; \\mathbf{P}^{-1} \\mathbf{K} \\;=\\; \\begin{bmatrix}\n\\mathbf{I}  \\mathbf{A}^{-1}\\mathbf{B}^\\top \\\\\n\\widehat{\\mathbf{S}}^{-1}\\mathbf{B}  \\mathbf{0}\n\\end{bmatrix}.\n$$\n\n目的是通过 $\\widehat{\\mathbf{S}}$ 中的阻尼来量化和减轻由 $\\mathbf{A}$ 中斜对称对流部分引起的非正规性。我们使用一个代数近似\n$$\n\\widehat{\\mathbf{S}} \\;=\\; \\mathbf{B}\\,\\mathrm{diag}(\\mathbf{A})^{-1}\\mathbf{B}^\\top + \\tau\\,\\mathbf{I},\n$$\n其中 $\\tau \\ge 0$ 是一个阻尼参数。\n\n从数值线性代数的核心定义开始：\n- $\\mathbf{M}$ 的 $\\varepsilon$-伪谱由所有满足 $\\|(z\\mathbf{I} - \\mathbf{M})^{-1}\\|_2 > 1/\\varepsilon$ 的 $z \\in \\mathbb{C}$ 组成，等价于最小奇异值 $\\sigma_{\\min}(z\\mathbf{I} - \\mathbf{M})  \\varepsilon$。\n- 瞬态增长通过算子范数 $\\|\\exp(t\\mathbf{M})\\|_2$ 来评估，其中 $t0$ 为一固定值。\n- 值域（数值范围）为 $W(\\mathbf{M}) = \\{ \\mathbf{x}^* \\mathbf{M} \\mathbf{x}/(\\mathbf{x}^*\\mathbf{x}) : \\mathbf{x} \\in \\mathbb{C}^{n+m}\\setminus\\{\\mathbf{0}\\} \\}$，预解式范数满足不等式 $\\|(z\\mathbf{I} - \\mathbf{M})^{-1}\\|_2 \\leq 1/\\mathrm{dist}(z, W(\\mathbf{M}))$，对所有 $z \\not\\in W(\\mathbf{M})$ 成立。\n\n你的任务：\n1. 对于给定的参数 $(n,\\nu,c,\\tau)$ 和 $h = 1/(n+1)$，按照规定构造 $\\mathbf{A}$、$\\mathbf{B}$、$\\widehat{\\mathbf{S}}$、$\\mathbf{P}$ 和 $\\mathbf{M}$。\n2. 在一个矩形复数网格 $\\mathcal{G}$ 上计算伪谱峰值，该网格由 $[-1.5, 1.5]$ 区间内均匀分布的 21 个点的实部和 $[-0.75, 0.75]$ 区间内均匀分布的 11 个点的虚部定义。\n$$\np_{\\max} \\;=\\; \\max_{z \\in \\mathcal{G}} \\left\\| (z\\mathbf{I} - \\mathbf{M})^{-1} \\right\\|_2 \\;=\\; \\max_{z \\in \\mathcal{G}} \\frac{1}{\\sigma_{\\min}(z\\mathbf{I} - \\mathbf{M})}.\n$$\n3. 在时间 $t_0 = 0.5$ 时计算瞬态增长指标，\n$$\ng \\;=\\; \\left\\|\\exp(t_0 \\mathbf{M})\\right\\|_2.\n$$\n4. 通过采样 $S=200$ 个随机单位向量 $\\mathbf{x}_j \\in \\mathbb{C}^{n+m}$ 来计算点 $w_j = \\mathbf{x}_j^* \\mathbf{M} \\mathbf{x}_j$，从而验证值域（数值范围）界。对于每个 $z \\in \\mathcal{G}$，定义采样界\n$$\nb(z) \\;=\\; \\left( \\min_{1 \\le j \\le S} |z - w_j| \\right)^{-1},\n$$\n并检查不等式 $\\|(z\\mathbf{I} - \\mathbf{M})^{-1}\\|_2 \\le b(z)$ 在整个网格上是否成立。报告一个布尔值 $q$，指示该不等式是否对 $\\mathcal{G}$ 中至少 $90\\%$ 的点成立。\n\n实现一个程序，对以下参数值测试套件执行上述计算：\n- 情况 1（基线对称扩散）：$n=30$，$\\nu=1.0$，$c=0.0$，$\\tau=0.0$。\n- 情况 2（中等对流，无阻尼）：$n=30$，$\\nu=1.0$，$c=10.0$，$\\tau=0.0$。\n- 情况 3（中等对流，$\\widehat{\\mathbf{S}}$ 中有阻尼）：$n=30$，$\\nu=1.0$，$c=10.0$，$\\tau=5.0$。\n- 情况 4（强对流，增加阻尼）：$n=30$，$\\nu=1.0$，$c=25.0$，$\\tau=12.5$。\n\n对于每种情况，计算并返回一个列表 $[p_{\\max}, g, q]$。\n\n最终输出格式：你的程序应生成单行输出，其中包含四个情况的结果，格式为方括号括起来的逗号分隔的列表的列表（例如：\"[[p1,g1,q1],[p2,g2,q2],[p3,g3,q3],[p4,g4,q4]]\"）。不应打印任何额外文本。此问题不涉及物理单位。",
                "solution": "用户提供的问题经过评估并被认为是有效的。它在科学上基于数值线性代数，是适定的、客观的，并为可解的数值实验包含了一套完整且一致的定义和参数。\n\n### 方法与实现\n\n该问题要求针对四个不同的参数集分析一个预处理鞍点系统。任务的核心是构造指定的矩阵，然后计算三个量：伪谱峰值 $p_{\\max}$、瞬态增长指标 $g$ 和一个评估基于值域的预解式范数界的布尔值 $q$。\n\n总体方法是实现一个过程，该过程对每个参数集 $(n, \\nu, c, \\tau)$：\n1.  构造必要的矩阵 $\\mathbf{A}$、$\\mathbf{B}$、$\\widehat{\\mathbf{S}}$ 和最终的预处理算子 $\\mathbf{M}$。\n2.  基于 $\\mathbf{M}$ 计算指标 $p_{\\max}$、$g$ 和 $q$。\n\n所有计算均使用标准数值库执行，并遵循所提供的定义。\n\n#### 1. 矩阵构造\n\n对于给定的内部节点数 $n$，网格间距为 $h = 1/(n+1)$，压力相关空间的维度为 $m = n-1$。系统的总维度为 $N = n+m$。\n\n-   **扩散算子 ($\\mathbf{L}$):** 离散拉普拉斯算子 $\\mathbf{L} \\in \\mathbb{R}^{n \\times n}$ 是一个对称三对角矩阵。对于从 1 开始的索引，其元素为：\n    $$\n    \\mathbf{L}_{ij} = \\frac{1}{h^2} \\begin{cases}\n    2,   i=j \\\\\n    -1,  |i-j|=1 \\\\\n    0,   \\text{otherwise}\n    \\end{cases}\n    $$\n\n-   **对流算子 ($\\mathbf{C}$):** 离散对流算子 $\\mathbf{C} \\in \\mathbb{R}^{n \\times n}$ 是一个斜对称三对角矩阵：\n    $$\n    \\mathbf{C}_{ij} = \\frac{c}{2h} \\begin{cases}\n    1,   j=i+1 \\\\\n    -1,  j=i-1 \\\\\n    0,   \\text{otherwise}\n    \\end{cases}\n    $$\n\n-   **速度块 ($\\mathbf{A}$):** 鞍点矩阵的 $(1,1)$ 分块是 $\\mathbf{A} = \\nu \\mathbf{L} + \\mathbf{C}$。鉴于 $\\mathbf{L}$ 是对称正定的且 $\\nu  0$，$\\mathbf{A}$ 的对称部分 $\\nu\\mathbf{L}$ 是正定的。这确保了 $\\mathbf{A}$ 是可逆的。\n\n-   **散度算子 ($\\mathbf{B}$):** 离散散度算子 $\\mathbf{B} \\in \\mathbb{R}^{m \\times n}$ 是一个表示向前有限差分的双对角矩阵。对于行 $i \\in \\{1, \\dots, m\\}$：\n    $$\n    \\mathbf{B}_{ij} = \\frac{1}{h} \\begin{cases}\n    -1,  j=i \\\\\n    1,   j=i+1 \\\\\n    0,   \\text{otherwise}\n    \\end{cases}\n    $$\n\n-   **近似 Schur 补 ($\\widehat{\\mathbf{S}}$):** Schur 补 $\\mathbf{S} = -\\mathbf{B} \\mathbf{A}^{-1} \\mathbf{B}^\\top$ 的近似由下式给出：\n    $$\n    \\widehat{\\mathbf{S}} = \\mathbf{B}\\,\\mathrm{diag}(\\mathbf{A})^{-1}\\mathbf{B}^\\top + \\tau\\,\\mathbf{I}_m\n    $$\n    其中 $\\mathbf{I}_m$ 是 $m \\times m$ 单位矩阵，$\\tau \\ge 0$ 是一个阻尼参数。对角矩阵 $\\mathrm{diag}(\\mathbf{A})$ 具有正的对角元素（来自扩散项），因此其逆是良定义的。项 $\\mathbf{B}\\,\\mathrm{diag}(\\mathbf{A})^{-1}\\mathbf{B}^\\top$ 是对称半正定的，对于 $\\tau  0$，$\\widehat{\\mathbf{S}}$ 是对称正定的，因此可逆。即使对于 $\\tau=0$，第一项的秩为 $m=n-1$，也使其可逆。\n\n-   **预处理算子 ($\\mathbf{M}$):** 左预处理算子 $\\mathbf{M} \\in \\mathbb{R}^{(n+m) \\times (n+m)}$ 构造成一个分块矩阵：\n    $$\n    \\mathbf{M} = \\mathbf{P}^{-1} \\mathbf{K} = \\begin{bmatrix} \\mathbf{A}  \\mathbf{0} \\\\ \\mathbf{0}  \\widehat{\\mathbf{S}} \\end{bmatrix}^{-1} \\begin{bmatrix} \\mathbf{A}  \\mathbf{B}^\\top \\\\ \\mathbf{B}  \\mathbf{0} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{I}_n  \\mathbf{A}^{-1}\\mathbf{B}^\\top \\\\ \\widehat{\\mathbf{S}}^{-1}\\mathbf{B}  \\mathbf{0}_{m \\times m} \\end{bmatrix}\n    $$\n    这个构造需要计算 $\\mathbf{A}^{-1}$ 和 $\\widehat{\\mathbf{S}}^{-1}$。\n\n#### 2. 伪谱峰值 ($p_{\\max}$)\n\n伪谱峰值在一个指定的复数网格 $\\mathcal{G}$ 上计算。该网格由 $21 \\times 11 = 231$ 个点 $z = x+iy$ 组成，其中 $x \\in [-1.5, 1.5]$（21 个点），$y \\in [-0.75, 0.75]$（11 个点）。对于每个 $z \\in \\mathcal{G}$，我们计算预解式范数 $\\|(z\\mathbf{I} - \\mathbf{M})^{-1}\\|_2$，它等价于矩阵 $(z\\mathbf{I} - \\mathbf{M})$ 的最小奇异值的倒数：\n$$\n\\left\\| (z\\mathbf{I} - \\mathbf{M})^{-1} \\right\\|_2 = \\frac{1}{\\sigma_{\\min}(z\\mathbf{I} - \\mathbf{M})}\n$$\n峰值 $p_{\\max}$ 是在所有 $z \\in \\mathcal{G}$ 上这些范数的最大值。奇异值使用标准的奇异值分解（SVD）算法计算。\n\n#### 3. 瞬态增长指标 ($g$)\n\n瞬态增长是非正规算子的一个标志。它通过矩阵指数的范数 $\\|\\exp(t\\mathbf{M})\\|_2$ 来衡量。对于此问题，我们在一个固定时间 $t_0 = 0.5$ 评估此量。矩阵指数 $\\exp(t_0 \\mathbf{M})$ 使用基于 Padé 近似的算法计算，其 2-范数通过计算结果矩阵的最大奇异值得到。因此，增长指标为 $g = \\|\\exp(t_0 \\mathbf{M})\\|_2$。\n\n#### 4. 值域界验证 ($q$)\n\n值域（或数值范围）$W(\\mathbf{M})$ 为预解式范数提供了一个界。该问题要求验证此界的采样版本。过程如下：\n1.  生成 $S=200$ 个随机单位向量 $\\mathbf{x}_j \\in \\mathbb{C}^{n+m}$。为了可复现性，使用一个固定的随机种子。\n2.  计算 $S$ 个点 $w_j = \\mathbf{x}_j^* \\mathbf{M} \\mathbf{x}_j$ 来形成一个样本集 $\\{w_j\\}_{j=1}^S \\subset W(\\mathbf{M})$。\n3.  对于每个点 $z \\in \\mathcal{G}$，计算其到样本集的距离 $\\mathrm{dist}(z, \\{w_j\\}) = \\min_j |z - w_j|$。\n4.  形成采样界 $b(z) = (\\mathrm{dist}(z, \\{w_j\\}))^{-1}$。\n5.  检查不等式 $\\|(z\\mathbf{I} - \\mathbf{M})^{-1}\\|_2 \\le b(z)$ 是否成立。\n6.  如果此不等式对于网格 $\\mathcal{G}$ 中至少 $90\\%$ 的点成立，则布尔值 $q$ 设为真，否则为假。这考虑到了有限样本 $\\{w_j\\}$ 可能无法完美表示 $W(\\mathbf{M})$ 边界的可能性。\n\n整个过程对问题陈述中提供的四个测试用例中的每一个重复进行，并收集每种情况的结果 $[p_{\\max}, g, q]$。",
                "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef compute_matrices(n, nu, c, h):\n    \"\"\"Constructs and returns the matrices A and B.\"\"\"\n    m = n - 1\n\n    # Diffusion operator L\n    diag_L = np.full(n, 2.0 / h**2)\n    off_diag_L = np.full(n - 1, -1.0 / h**2)\n    L = np.diag(off_diag_L, k=-1) + np.diag(diag_L, k=0) + np.diag(off_diag_L, k=1)\n\n    # Convection operator C\n    off_diag_C = np.full(n - 1, c / (2.0 * h))\n    C = np.diag(off_diag_C, k=1) - np.diag(off_diag_C, k=-1)\n\n    # Velocity block A\n    A = nu * L + C\n\n    # Divergence operator B\n    # B has shape (m, n) = (n-1, n)\n    B = np.zeros((m, n))\n    for i in range(m):\n        B[i, i] = -1.0 / h\n        B[i, i+1] = 1.0 / h\n        \n    return A, B\n\ndef compute_for_case(n, nu, c, tau):\n    \"\"\"\n    Performs all computations for a single parameter set (n, nu, c, tau).\n    Returns a list [p_max, g, q].\n    \"\"\"\n    h = 1.0 / (n + 1)\n    m = n - 1\n    N_total = n + m\n\n    # 1. Construct matrices\n    A, B = compute_matrices(n, nu, c, h)\n\n    # Approximate Schur complement S_hat\n    diag_A_inv = np.diag(1.0 / np.diag(A))\n    S_hat = B @ diag_A_inv @ B.T + tau * np.eye(m)\n\n    # Preconditioned operator M\n    A_inv = np.linalg.inv(A)\n    S_hat_inv = np.linalg.inv(S_hat)\n\n    M = np.block([\n        [np.eye(n), A_inv @ B.T],\n        [S_hat_inv @ B, np.zeros((m, m))]\n    ])\n\n    # 2. Compute pseudospectral peak p_max\n    real_parts = np.linspace(-1.5, 1.5, 21)\n    imag_parts = np.linspace(-0.75, 0.75, 11)\n    grid_G = [r + 1j * i for r in real_parts for i in imag_parts]\n    \n    p_max = 0.0\n    resolvent_norms = {}\n    for z in grid_G:\n        zI_minus_M = z * np.eye(N_total) - M\n        # Smallest singular value\n        sigma_min = np.linalg.svd(zI_minus_M, compute_uv=False).min()\n        norm_val = 1.0 / sigma_min if sigma_min > 1e-16 else 1e16\n        resolvent_norms[z] = norm_val\n        if norm_val > p_max:\n            p_max = norm_val\n\n    # 3. Compute transient growth indicator g\n    t0 = 0.5\n    exp_tM = linalg.expm(t0 * M)\n    g = np.linalg.norm(exp_tM, ord=2)\n\n    # 4. Validate field-of-values bound and compute q\n    S = 200\n    # Use a fixed seed for reproducibility\n    np.random.seed(0)\n    \n    # Generate random unit vectors\n    rand_vecs = np.random.randn(S, N_total) + 1j * np.random.randn(S, N_total)\n    rand_vecs /= np.linalg.norm(rand_vecs, axis=1)[:, np.newaxis]\n\n    # Sample field of values\n    w_samples = np.array([x.conj().T @ M @ x for x in rand_vecs])\n\n    valid_count = 0\n    for z in grid_G:\n        dist_z = np.min(np.abs(z - w_samples))\n        \n        # If dist_z is very small, the bound is effectively infinite and holds.\n        if dist_z  1e-15:\n            bound_z = np.inf\n        else:\n            bound_z = 1.0 / dist_z\n            \n        if resolvent_norms[z] = bound_z:\n            valid_count += 1\n            \n    q = (valid_count / len(grid_G)) >= 0.9\n    \n    return [p_max, g, q]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    test_cases = [\n        # (n, nu, c, tau)\n        (30, 1.0, 0.0, 0.0),    # baseline symmetric diffusion\n        (30, 1.0, 10.0, 0.0),   # moderate convection, no damping\n        (30, 1.0, 10.0, 5.0),   # moderate convection, damping\n        (30, 1.0, 25.0, 12.5),  # strong convection, increased damping\n    ]\n\n    results = []\n    for case in test_cases:\n        res = compute_for_case(*case)\n        results.append(res)\n    \n    # Format the output string precisely as required.\n    output_parts = []\n    for res in results:\n        # res is [p_max, g, q]\n        # Format boolean as 'True' or 'False'. Python default is used.\n        part = f\"[{res[0]},{res[1]},{str(res[2])}]\"\n        output_parts.append(part)\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    # Correct the boolean string to be lowercase as is conventional in JSON\n    final_output = final_output.replace(\"True\", \"true\").replace(\"False\", \"false\")\n    print(final_output)\n\nsolve()\n```",
                "id": "3566655"
            }
        ]
    }