{
        "hands_on_practices": [
            {
                "introduction": "这个练习提供了一个具体的实践，旨在巩固实矩阵的特征值与其对应的实舒尔分解形式的结构之间的基本联系。通过处理一个具有共轭复数特征值对的矩阵，您将确定相应的 $2 \\times 2$ 对角块的元素，从而加深理解该对角块的结构如何直接编码特征值的实部和虚部 [@problem_id:3595443]。",
                "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是首一多项式 $p(\\lambda) = \\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15$ 的实伴随矩阵，即，\n$$\nA = \\begin{pmatrix}\n0  0  15 \\\\\n1  0  -11 \\\\\n0  1  5\n\\end{pmatrix}.\n$$\n从不变子空间和正交相似的定义出发，通过识别与非实数谱相关的实二维不变子空间，并为该子空间建立一个标准正交基，然后将其扩充为 $\\mathbb{R}^{3}$ 的一个标准正交基，来构造 $A$ 的实 Schur 型。在你构造的基中，实 Schur 型 $R = Q^{\\top} A Q$ 是准上三角矩阵，并包含一个与 $A$ 的共轭复特征值对相对应的 $2 \\times 2$ 实数块。通过从第一性原理充分论证不变子空间的选择和标准正交化过程，确定出现在该 $2 \\times 2$ 块中的参数 $\\beta$ 的精确值，该块具有标准形式\n$$\n\\begin{pmatrix}\n\\alpha  \\beta \\\\\n-\\beta  \\alpha\n\\end{pmatrix}.\n$$\n请以单个实数形式提供你的最终答案。无需四舍五入。",
                "solution": "用户要求我确定给定矩阵 $A$ 的实 Schur 型中参数 $\\beta$ 的值。\n\n### 步骤 1：问题验证\n\n**1. 提取已知条件：**\n- 矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 是首一多项式 $p(\\lambda) = \\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15$ 的实伴随矩阵。\n- 矩阵的显式形式为 $$A = \\begin{pmatrix} 0  0  15 \\\\ 1  0  -11 \\\\ 0  1  5 \\end{pmatrix}$$。\n- 需要构造实 Schur 型 $R = Q^{\\top} A Q$，其中 $Q$ 是一个正交矩阵。\n- Schur 型 $R$ 包含一个与 $A$ 的共轭复特征值对相对应的 $2 \\times 2$ 实数块。\n- 这个 $2 \\times 2$ 块具有标准形式 $$\\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix}$$。\n- 任务是找到 $\\beta$ 的精确值。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：**该问题是数值线性代数中的一个标准练习，具体涉及实矩阵的实 Schur 分解。这些概念是公认的。它在科学上是合理的。\n- **良态性：**对于任何实矩阵 $A$，都存在实 Schur 分解。Schur 型中任何块的特征值都必须是原矩阵 $A$ 的特征值。这个约束条件，结合指定的块的规范结构，确定了 $\\alpha$ 和 $|\\beta|$ 的值。问题要求的是 $\\beta$ 的“那个”值，这意味着唯一性。这种唯一性通常通过选择 $\\beta$ 为正来确立。因此，在这个标准约定下，问题是良态的。\n- **客观性：**问题以精确的数学语言陈述，没有主观性。\n\n**3. 结论和行动：**\n问题有效。我将继续进行解答。\n\n### 步骤 2：解题\n\n问题要求在矩阵 $A$ 的实 Schur 型的一个 $2 \\times 2$ 块中找到参数 $\\beta$。解题过程如下：\n\n首先，我们必须确定矩阵 $A$ 的特征值。伴随矩阵的特征多项式是直接给出的。在本例中，特征多项式 $p(\\lambda)$ 已给出：\n$$p(\\lambda) = \\det(A - \\lambda I) = \\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15 = 0$$\n我们寻找这个多项式的根。根据有理根定理，任何整数根都必须是常数项 $-15$ 的因数。这些因数是 $\\pm 1, \\pm 3, \\pm 5, \\pm 15$。我们测试这些值：\n对于 $\\lambda=3$：\n$$p(3) = (3)^{3} - 5(3)^{2} + 11(3) - 15 = 27 - 5(9) + 33 - 15 = 27 - 45 + 33 - 15 = 60 - 60 = 0$$\n所以，$\\lambda_1 = 3$ 是一个实特征值。\n为了找到其他特征值，我们将 $p(\\lambda)$ 除以 $(\\lambda - 3)$：\n$$ \\frac{\\lambda^{3} - 5 \\lambda^{2} + 11 \\lambda - 15}{\\lambda - 3} = \\lambda^2 - 2\\lambda + 5 $$\n剩余的特征值是二次方程 $\\lambda^2 - 2\\lambda + 5 = 0$ 的根。使用二次公式：\n$$ \\lambda = \\frac{-(-2) \\pm \\sqrt{(-2)^2 - 4(1)(5)}}{2(1)} = \\frac{2 \\pm \\sqrt{4 - 20}}{2} = \\frac{2 \\pm \\sqrt{-16}}{2} = \\frac{2 \\pm 4i}{2} = 1 \\pm 2i $$\n因此，$A$ 的特征值为 $\\lambda_1 = 3$，$\\lambda_2 = 1+2i$ 和 $\\lambda_3 = 1-2i$。\n\n根据实 Schur 分解定理，对于任何实矩阵 $A$，存在一个正交矩阵 $Q$，使得 $R = Q^{\\top} A Q$ 是一个实的准上三角矩阵。$R$ 的对角线元素由与 $A$ 的实特征值相对应的 $1 \\times 1$ 块和与共轭复特征值对相对应的 $2 \\times 2$ 块组成。\n\n在我们的例子中，特征值为 $\\{3, 1+2i, 1-2i\\}$。实 Schur 型 $R$ 将有一个 $1 \\times 1$ 的块 $[3]$ 和一个 $2 \\times 2$ 的块，后者的特征值是共轭复数对 $\\{1+2i, 1-2i\\}$。\n\n问题指明这个 $2 \\times 2$ 块具有标准形式：\n$$ R_{11} = \\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix} $$\n这个块的特征值是其特征多项式的根：\n$$ \\det(R_{11} - \\lambda I) = \\det \\begin{pmatrix} \\alpha - \\lambda  \\beta \\\\ -\\beta  \\alpha - \\lambda \\end{pmatrix} = (\\alpha - \\lambda)^2 + \\beta^2 = 0 $$\n求解 $\\lambda$：\n$$ (\\lambda - \\alpha)^2 = -\\beta^2 \\implies \\lambda - \\alpha = \\pm i\\sqrt{\\beta^2} \\implies \\lambda = \\alpha \\pm i|\\beta| $$\n所以，这个标准块的特征值为 $\\{\\alpha + i|\\beta|, \\alpha - i|\\beta|\\}$。\n\n这些特征值必须等于 $A$ 的共轭复特征值对，即 $\\{1+2i, 1-2i\\}$。通过比较这两组特征值的实部和虚部，我们可以确定 $\\alpha$ 和 $|\\beta|$：\n$$ \\alpha = \\text{Re}(1 \\pm 2i) = 1 $$\n$$ |\\beta| = |\\text{Im}(1 \\pm 2i)| = | \\pm 2 | = 2 $$\n这意味着 $\\alpha = 1$ 且 $\\beta = \\pm 2$。\n\n问题要求的是“参数 $\\beta$ 的精确值”，这意味着一个唯一的解。在 $\\beta = 2$ 和 $\\beta = -2$ 之间的选择取决于为不变子空间选择的基向量的方向。然而，在数值线性代数中，一个标准的约定是选择非对角线元素的符号为正（或基于上半平面中特征值虚部的符号）。具体来说，对于一对共轭复特征值 $a \\pm ib$ 且 $b>0$，标准块通常被定义为与虚部相对应的参数就是 $b$ 本身，它是正的。\n\n遵循这个约定，我们将参数 $\\beta$ 与特征值对的正虚部相关联，即 $2$。\n因此，我们有 $\\alpha=1$ 并且我们选择 $\\beta=2$。\n得到的块将是 $$\\begin{pmatrix} 1  2 \\\\ -2  1 \\end{pmatrix}$$，其特征值为 $1\\pm 2i$。\n\n论证的核心是，Schur 块的特征值由矩阵 A 的特征值决定。Schur 块的指定结构随后强制了 $\\alpha$ 和 $|\\beta|$ 的值。$\\beta$ 的唯一性通过标准约定来解决。",
                "answer": "$$\\boxed{2}$$",
                "id": "3595443"
            },
            {
                "introduction": "舒尔分解的一个关键优势在于其对任何方阵的普适性，这与需要完备特征向量集的特征分解不同。本练习 [@problem_id:3595396] 通过处理一个亏损矩阵来展示这种稳健性。您将验证，即使该矩阵缺少一个完整的特征基，它的实舒尔形式依然是良定义的，并且可以轻松构建。",
                "problem": "考虑实数矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0\\\\\n0  0  1\\\\\n0  0  0\n\\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3}.\n$$\n已知该矩阵是亏损的（defective），因为它不具有完备的特征向量基。在实舒尔分解 (real Schur decomposition) 的背景下，从第一性原理出发解决以下问题。\n\n- 仅使用“当一个矩阵的几何重数严格小于其代数重数时，该矩阵是亏损的”这一定义，验证 $A$ 是亏损的。\n- 从“对于任意实数矩阵 $A$，存在一个正交矩阵 $Q \\in \\mathbb{R}^{3 \\times 3}$ 使得 $Q^{\\mathsf{T}} A Q$ 是实上拟三角矩阵（实舒尔形式）”这一基本论断出发，显式地构造一个 $A$ 的有效实舒尔分解，并解释为什么即使 $A$ 是亏损的，该分解仍然是良定义的。\n- 为了量化在正交相似变换下的数值稳定性方面的非正规性，定义交换子\n$$\n\\Delta \\;=\\; T^{\\mathsf{T}} T \\;-\\; T T^{\\mathsf{T}},\n$$\n其中 $T$ 是 $A$ 的一个实舒尔形式，并精确计算弗罗贝尼乌斯范数 (Frobenius norm) $\\lVert \\Delta \\rVert_{F}$。\n\n请给出 $\\lVert \\Delta \\rVert_{F}$ 的精确值，无需四舍五入。最终答案必须是单个实数或单个闭式解析表达式。",
                "solution": "该问题要求对矩阵 $A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix}$ 进行三部分分析。我们首先验证问题陈述。\n\n### 问题验证\n**1. 提取已知条件：**\n- 矩阵 $$A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3}$$。\n- 亏损矩阵的定义：至少一个特征值的几何重数严格小于其代数重数。\n- 实舒尔分解：对于一个实数矩阵 $A$，存在一个正交矩阵 $Q \\in \\mathbb{R}^{3 \\times 3}$，使得 $T = Q^{\\mathsf{T}} A Q$ 是一个实上拟三角矩阵。\n- 交换子定义：$\\Delta = T^{\\mathsf{T}} T - T T^{\\mathsf{T}}$，其中 $T$ 是 $A$ 的一个实舒尔形式。\n- 任务：验证 $A$ 是亏损的，为 $A$ 构造一个实舒尔分解，并计算弗罗贝尼乌斯范数 $\\lVert \\Delta \\rVert_{F}$。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题牢固地植根于数值线性代数的标准、成熟概念，包括特征值、特征向量、矩阵分解（舒尔分解）和矩阵范数。矩阵 $A$ 是一个经典的幂零若尔当块 (nilpotent Jordan block) 的例子，常用于阐释亏损性和非正规性等概念。\n- **良定性：** 该问题是良定的。任务定义清晰，并能导出一个唯一且有意义的解。实舒尔分解的存在性是一个基本定理。待计算的量 $\\lVert \\Delta \\rVert_{F}$ 在舒尔分解中对于正交矩阵 $Q$ 的选择是不变的，因为弗罗贝尼乌斯范数是酉不变的。即，$\\lVert \\Delta \\rVert_{F} = \\lVert T^{\\mathsf{T}} T - T T^{\\mathsf{T}} \\rVert_F = \\lVert (Q^{\\mathsf{T}}AQ)^{\\mathsf{T}}(Q^{\\mathsf{T}}AQ) - (Q^{\\mathsf{T}}AQ)(Q^{\\mathsf{T}}AQ)^{\\mathsf{T}} \\rVert_F = \\lVert Q^{\\mathsf{T}}(A^{\\mathsf{T}}A - AA^{\\mathsf{T}})Q \\rVert_F = \\lVert A^{\\mathsf{T}}A - AA^{\\mathsf{T}} \\rVert_F$。这确保了最终答案的唯一性。\n- **客观性：** 问题使用精确、客观的数学语言陈述。\n- **完备性：** 提供了所有必要的信息和定义。\n\n**3. 结论与行动：**\n该问题是有效的，因为它科学上合理、良定且无歧义。我们着手求解。\n\n### 第一部分：亏损性验证\n\n如果一个矩阵至少有一个特征值的几何重数严格小于其代数重数，则该矩阵是亏损的。\n\n首先，我们通过求解特征多项式 $p(\\lambda) = \\det(A - \\lambda I)$ 的根来确定特征值及其代数重数。\n$$\np(\\lambda) = \\det \\begin{pmatrix} -\\lambda  1  0\\\\ 0  -\\lambda  1\\\\ 0  0  -\\lambda \\end{pmatrix} = (-\\lambda)^3\n$$\n令 $p(\\lambda) = 0$ 得 $-\\lambda^3 = 0$，这给出了一个代数重数为 $m_a(0) = 3$ 的单一特征值 $\\lambda = 0$。\n\n接下来，我们确定 $\\lambda = 0$ 的几何重数。几何重数 $m_g(\\lambda)$ 是对应于 $\\lambda$ 的特征空间的维度，也就是矩阵 $(A - \\lambda I)$ 的零空间。对于 $\\lambda = 0$，我们需要找到 $A$ 的零空间的维度。\n$$\n\\text{Nul}(A) = \\{ \\mathbf{x} \\in \\mathbb{R}^3 \\mid A\\mathbf{x} = \\mathbf{0} \\}\n$$\n我们求解方程组 $A\\mathbf{x} = \\mathbf{0}$：\n$$\n\\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n该矩阵方程对应于以下线性方程组：\n$x_2 = 0$\n$x_3 = 0$\n$0 = 0$\n变量 $x_1$ 是自由变量。任何特征向量都必须具有 $$\\begin{pmatrix} x_1 \\\\ 0 \\\\ 0 \\end{pmatrix} = x_1 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$ 的形式。特征空间是由向量 $$\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$ 张成的。该空间的维度是 $1$。\n因此，特征值 $\\lambda=0$ 的几何重数是 $m_g(0) = 1$。\n\n比较重数，我们有 $m_g(0) = 1  m_a(0) = 3$。根据定义，矩阵 $A$ 是亏损的。\n\n### 第二部分：实舒尔分解\n\n实舒尔分解定理保证，对于任意实数矩阵 $A \\in \\mathbb{R}^{n \\times n}$，存在一个正交矩阵 $Q \\in \\mathbb{R}^{n \\times n}$ 和一个实上拟三角矩阵 $T \\in \\mathbb{R}^{n \\times n}$，使得 $A = Q T Q^{\\mathsf{T}}$，或等价地 $T = Q^{\\mathsf{T}} A Q$。矩阵 $T$ 被称为 $A$ 的一个实舒尔形式。其对角线上的元素由对应于实特征值的 $1 \\times 1$ 块和对应于复共轭特征值对的 $2 \\times 2$ 块组成。\n\n该分解的存在性由一个构造性证明所确立，该证明不要求矩阵是可对角化的（即非亏损的）。证明通过归纳法进行，并且仅要求任何矩阵至少有一个特征值和相应的特征向量（这在 $\\mathbb{C}$ 上由代数基本定理保证，而对于实矩阵，如果存在一个复特征值，那么它的共轭对也存在，从而产生一个实不变子空间）。该过程找到一个实特征向量（或一个对应于复数对的二维不变子空间），用它来构成 $Q$ 的第一列（或前两列），执行一个将矩阵分块三角化的相似变换，然后对右下角的子矩阵递归地进行处理。无论矩阵是否亏损，这个过程总是成功的。\n\n由于我们的矩阵 $A$ 的所有特征值都是实数（$\\lambda=0$），其舒尔形式 $T$ 将是严格上三角矩阵。\n\n为了构造这个分解，我们遵循构造性证明的步骤。\n1. 找到 $A$ 的一个特征向量。我们已经发现 $\\mathbf{v}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 是对应于 $\\lambda=0$ 的一个特征向量。我们将其单位化以得到 $Q$ 的第一列：$\\mathbf{q}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n2. 将 $\\{\\mathbf{q}_1\\}$ 扩展为 $\\mathbb{R}^3$ 的一个标准正交基。最简单的方法是选择标准基向量。令 $\\mathbf{q}_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 且 $\\mathbf{q}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。集合 $\\{\\mathbf{q}_1, \\mathbf{q}_2, \\mathbf{q}_3\\}$ 构成一个标准正交基。\n3. 用这些向量作为列来构成正交矩阵 $Q$：\n$$\nQ = \\begin{pmatrix} \\mathbf{q}_1  \\mathbf{q}_2  \\mathbf{q}_3 \\end{pmatrix} = \\begin{pmatrix} 1  0  0\\\\ 0  1  0\\\\ 0  0  1 \\end{pmatrix} = I\n$$\n4. 计算舒尔形式 $T$：\n$$\nT = Q^{\\mathsf{T}} A Q = I^{\\mathsf{T}} A I = A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix}\n$$\n得到的矩阵 $T=A$ 是上三角矩阵，因此它是 $A$ 的一个有效的实舒尔形式。相关的正交矩阵是单位矩阵 $Q=I$。这个分解 $A = I A I^{\\mathsf{T}}$ 是良定义的，并且表明即使是亏损矩阵也存在实舒尔分解。\n\n### 第三部分：$\\lVert \\Delta \\rVert_{F}$ 的计算\n\n题目要求我们计算交换子 $\\Delta = T^{\\mathsf{T}} T - T T^{\\mathsf{T}}$ 的弗罗贝尼乌斯范数，其中 $T$ 是 $A$ 的一个实舒尔形式。我们使用在第二部分中找到的舒尔形式，即 $T=A$。\n\n首先，我们计算两个乘积 $T^{\\mathsf{T}} T$ 和 $T T^{\\mathsf{T}}$。\n$$\nT = A = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\quad \\implies \\quad T^{\\mathsf{T}} = A^{\\mathsf{T}} = \\begin{pmatrix} 0  0  0\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix}\n$$\n现在，我们计算矩阵乘积：\n$$\nT^{\\mathsf{T}} T = \\begin{pmatrix} 0  0  0\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0\\\\ 0  1  0\\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\nT T^{\\mathsf{T}} = \\begin{pmatrix} 0  1  0\\\\ 0  0  1\\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  0  0\\\\ 1  0  0\\\\ 0  1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0\\\\ 0  1  0\\\\ 0  0  0 \\end{pmatrix}\n$$\n接下来，我们计算交换子 $\\Delta$：\n$$\n\\Delta = T^{\\mathsf{T}} T - T T^{\\mathsf{T}} = \\begin{pmatrix} 0  0  0\\\\ 0  1  0\\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0\\\\ 0  1  0\\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} -1  0  0\\\\ 0  0  0\\\\ 0  0  1 \\end{pmatrix}\n$$\n最后，我们计算 $\\Delta$ 的弗罗贝尼乌斯范数。矩阵 $M$ 的弗罗贝尼乌斯范数定义为 $\\lVert M \\rVert_{F} = \\sqrt{\\sum_{i,j} |m_{ij}|^2}$。\n$$\n\\lVert \\Delta \\rVert_{F} = \\sqrt{(-1)^2 + 0^2 + 0^2 + 0^2 + 0^2 + 0^2 + 0^2 + 0^2 + 1^2} = \\sqrt{1 + 1} = \\sqrt{2}\n$$\n值 $\\lVert \\Delta \\rVert_{F}$ 量化了 $T$ 偏离正规性的程度。如在验证部分所述，这个量与所选的具体舒尔形式无关，因为它等于 $\\lVert A^{\\mathsf{T}}A - AA^{\\mathsf{T}} \\rVert_{F}$。我们的计算在 $T=A$ 这个具体情况下证实了这一通用性质。",
                "answer": "$$\\boxed{\\sqrt{2}}$$",
                "id": "3595396"
            },
            {
                "introduction": "线性代数的理论概念在有限精度计算机运算的现实世界中常常会遇到实际挑战。这个计算练习 [@problem_id:3595428] 旨在探索理论与实践之间的界限，它通过考察数值算法如何判断一对特征值是真正的复数，还是仅仅是两个非常接近的实数。您将编写代码来观察“放缩”（deflation）现象的影响，这是数值线性代数中一个关键过程，通过处理数值上可忽略的值来确保计算的稳定性。",
                "problem": "你的任务是研究浮点运算的有限精度如何影响由实舒尔分解所识别的块结构。这适用于一族实数 $2\\times 2$ 矩阵，在精确算术中，这些矩阵编码了一对虚部极小的共轭复数特征值。在精确实舒尔形式中，一个 $2\\times 2$ 的块对应一对共轭复数特征值，而两个 $1\\times 1$ 的块对应两个实数特征值。在有限精度下，计算实舒尔形式的QR迭代（正交-三角迭代）过程中的隐式正交变换期间，一个相对于局部尺度足够小的次对角线元素会被置为零（这个过程称为紧缩），这可能将分类从一个 $2\\times 2$ 块翻转为两个 $1\\times 1$ 的块。\n\n对于参数 $a\\in\\mathbb{R}$ 和 $\\epsilon\\in\\mathbb{R}$，考虑实数 $2\\times 2$ 矩阵\n$$\nA(a,\\epsilon) \\;=\\;\n\\begin{bmatrix}\na  \\epsilon\\\\\n-\\epsilon  a\n\\end{bmatrix}.\n$$\n在精确算术中，$A(a,\\epsilon)$ 的特征值是 $a\\pm i\\,\\epsilon$，因此 $A(a,\\epsilon)$ 本身已经是具有单个 $2\\times 2$ 块的实舒尔形式。在有限精度浮点运算中，根据 $\\epsilon$ 相对于机器单位舍入误差和局部矩阵范数的尺度，次对角线元素可能被QR算法视为可忽略不计而被置零，从而产生两个具有重复实特征值 $a$ 的 $1\\times 1$ 块。\n\n你的任务是编写一个程序，对于每个指定的 $(a,\\epsilon)$ 对，使用正交相似变换计算 $A(a,\\epsilon)$ 的实舒尔形式 $T$（你可以调用一个可靠的数值库例程来计算实舒尔分解），然后通过将次对角线元素 $T_{21}$ 与一个考虑机器精度的容差进行比较，来分类是 $2\\times 2$ 块还是两个 $1\\times 1$ 块。使用以下判定规则：定义容差\n$$\n\\tau \\;=\\; 10\\,u\\,\\|T\\|_{1},\n$$\n其中 $u$ 是 IEEE 754 双精度的单位舍入误差，$\\|\\cdot\\|_{1}$ 表示矩阵 $1$-范数。如果 $|T_{21}| > \\tau$，则将情况分类为一个 $2\\times 2$ 的共轭复数对；否则，分类为两个 $1\\times 1$ 的实数块。对于每个测试用例，如果检测到 $2\\times 2$ 块，则输出整数 $2$；如果检测到两个 $1\\times 1$ 块，则输出整数 $1$。\n\n测试组：\n- 用例1（一般情况，清晰的复数对）：$a=1$, $\\epsilon=10^{-2}$。\n- 用例2（一般情况，在典型精度下仍为复数对）：$a=1$, $\\epsilon=10^{-12}$。\n- 用例3（接近单位舍入误差的边界区域）：$a=1$, $\\epsilon=10^{-16}$。\n- 用例4（紧缩区域，虚部远低于舍入误差）：$a=1$, $\\epsilon=10^{-20}$。\n- 用例5（大尺度，非对角线元素相对于数值大小可忽略不计）：$a=10^{16}$, $\\epsilon=1$。\n- 用例6（小尺度，非对角线元素主导紧缩阈值）：$a=10^{-16}$, $\\epsilon=10^{-16}$。\n\n你的程序应生成单行输出，其中包含六个测试用例的结果，按顺序排列，形式为用方括号括起来的逗号分隔列表。例如，一个有效的输出格式是\n`[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5,\\text{result}_6]`\n每个 $\\text{result}_k$ 必须是整数 $2$（检测到 $2\\times 2$ 块）或 $1$（检测到两个 $1\\times 1$ 块）。本问题不涉及任何物理单位或角度单位，所有输出都是无单位整数。",
                "solution": "用户提供的问题被评估为有效。它在科学上基于数值线性代数的原理，特别是关于实舒尔分解的计算以及有限精度算法的影响。该问题是适定的，提供了所有必要的数据、定义和一个清晰、客观的分类规则。这是一个可形式化且可验证的计算任务。\n\n分析和解决方案基于以下原则。对于任何实数 $n \\times n$ 矩阵 $A$，其实舒尔分解由 $A = Q T Q^T$ 给出，其中 $Q$ 是一个正交矩阵（$Q^T Q = I$），$T$ 是一个实准上三角矩阵。准上三角矩阵是一个上三角矩阵，但其对角线上可能存在 $2 \\times 2$ 的块。每个 $1 \\times 1$ 的对角块 $T_{ii}$ 对应于 $A$ 的一个实特征值。每个形如 $\\begin{pmatrix} \\alpha  \\beta \\\\ \\gamma  \\delta \\end{pmatrix}$ 的 $2 \\times 2$ 对角块对应一对共轭复数特征值。\n\n问题指定了定义为以下形式的一族矩阵 $A(a,\\epsilon)$：\n$$\nA(a,\\epsilon) \\;=\\;\n\\begin{bmatrix}\na  \\epsilon\\\\\n-\\epsilon  a\n\\end{bmatrix}\n$$\n其中 $a, \\epsilon \\in \\mathbb{R}$。其特征多项式为 $(\\lambda-a)^2 + \\epsilon^2 = 0$，解得特征值为 $\\lambda = a \\pm i\\,\\epsilon$。对于任何 $\\epsilon \\neq 0$，该矩阵都有一对共轭复数特征值。在精确算术中，$A(a,\\epsilon)$ 本身已经是实舒尔形式，表示一个单独的 $2 \\times 2$ 块。\n\n然而，用于计算舒尔形式的数值算法，如QR算法，是在有限精度浮点运算中执行的。此类算法中的一个关键步骤是紧缩，即如果次对角线元素 $T_{i+1, i}$ 的量级相对于相邻对角线元素或整个矩阵范数的尺度被认为是可忽略的，则将其置为零。此操作可以在数值上将一个 $2 \\times 2$ 的块变为两个 $1 \\times 1$ 的块，从而将特征值分类为实数而非复数。\n\n问题提供了一个特定的规则来模拟这种行为。分类取决于计算出的 $A(a,\\epsilon)$ 的实舒尔形式 $T$。容差 $\\tau$ 定义为：\n$$\n\\tau \\;=\\; 10\\,u\\,\\|T\\|_{1}\n$$\n- 常数 $u$ 代表 IEEE 754 双精度算术的单位舍入误差。这是对一个数进行舍入时产生的最大相对误差，定义为 $u = 2^{-53}$，它是机器ε $\\epsilon_{mach} = 2^{-52}$ 的一半。\n- 项 $\\|T\\|_{1}$ 是计算出的舒尔形式 $T$ 的矩阵 $1$-范数，计算方式为最大绝对列和：$\\|T\\|_{1} = \\max_{j} \\sum_{i} |T_{ij}|$。此范数提供了矩阵局部尺度的一个度量。\n\n判定规则是：\n- 如果 $|T_{21}| > \\tau$，则次对角线元素是显著的。该矩阵被分类为具有一个 $2 \\times 2$ 的块结构，对应一对共轭复数特征值。输出为整数 $2$。\n- 如果 $|T_{21}| \\le \\tau$，则次对角线元素在数值上是可忽略的。该矩阵被分类为具有两个 $1 \\times 1$ 的块，对应两个实数特征值。输出为整数 $1$。\n\n我们现在将此过程应用于每个测试用例。首先，单位舍入误差为 $u = 2^{-53} \\approx 1.11022 \\times 10^{-16}$。\n\n**用例1：** $a=1, \\epsilon=10^{-2}$。\n矩阵为 $A = \\begin{bmatrix} 1  0.01 \\\\ -0.01  1 \\end{bmatrix}$。非对角项 $\\epsilon$ 与机器精度相比很大。舒尔分解将产生一个与 $A$ 非常接近的矩阵 $T$。因此， $|T_{21}| \\approx 0.01$。$1$-范数 $\\|T\\|_1 \\approx \\|A\\|_1 = 1.01$。容差为 $\\tau \\approx 10 \\cdot (1.11 \\times 10^{-16}) \\cdot 1.01 \\approx 1.12 \\times 10^{-15}$。由于 $|T_{21}| \\approx 10^{-2} \\gg 1.12 \\times 10^{-15}$，我们将其分类为一个 $2 \\times 2$ 块。结果：$2$。\n\n**用例2：** $a=1, \\epsilon=10^{-12}$。\n矩阵为 $A = \\begin{bmatrix} 1  10^{-12} \\\\ -10^{-12}  1 \\end{bmatrix}$。非对角项很小，但相对于对角元素，仍明显大于机器精度。$|T_{21}| \\approx 10^{-12}$。$1$-范数为 $\\|T\\|_1 \\approx \\|A\\|_1 = 1 + 10^{-12} \\approx 1$。容差为 $\\tau \\approx 10 \\cdot (1.11 \\times 10^{-16}) \\cdot 1 \\approx 1.11 \\times 10^{-15}$。由于 $|T_{21}| \\approx 10^{-12} \\gg 1.11 \\times 10^{-15}$，我们将其分类为一个 $2 \\times 2$ 块。结果：$2$。\n\n**用例3：** $a=1, \\epsilon=10^{-16}$。\n矩阵为 $A = \\begin{bmatrix} 1  10^{-16} \\\\ -10^{-16}  1 \\end{bmatrix}$。这里，相对于 $a=1$，$\\epsilon$ 非常接近单位舍入误差 $u$。QR算法的内部紧缩逻辑可能会测试 $|-\\epsilon|$ 是否小于 $u \\cdot (|a|+|a|)$。这个条件 $|-10^{-16}| \\le (1.11 \\times 10^{-16}) \\cdot 2$ 是成立的。因此，算法可能会将次对角线元素置为零，导致计算出的 $T$ 中 $|T_{21}|$ 为零或处于机器精度浮渣的量级，远小于 $10^{-16}$。我们的显式测试证实了这一点：$\\|T\\|_1 \\approx 1$，所以 $\\tau \\approx 1.11 \\times 10^{-15}$。初始次对角线元素是 $10^{-16}$，已经小于 $\\tau$。求解器内部的紧缩使得最终的 $|T_{21}|$ 值更小。我们将其分类为两个 $1 \\times 1$ 块。结果：$1$。\n\n**用例4：** $a=1, \\epsilon=10^{-20}$。\n矩阵为 $A = \\begin{bmatrix} 1  10^{-20} \\\\ -10^{-20}  1 \\end{bmatrix}$。非对角线元素相对于对角线元素远低于机器精度。由于舍入，$1.0 + 10^{-20}$ 可能会被计算为 $1.0$。即使输入矩阵被正确存储，次对角线元素也是可忽略的。$\\|T\\|_1 \\approx 1$，$\\tau \\approx 1.11 \\times 10^{-15}$。由于 $|T_{21}|$ 最多在 $10^{-20}$ 的量级，它远小于 $\\tau$。我们将其分类为两个 $1 \\times 1$ 块。结果：$1$。\n\n**用例5：** $a=10^{16}, \\epsilon=1$。\n矩阵为 $A = \\begin{bmatrix} 10^{16}  1 \\\\ -1  10^{16} \\end{bmatrix}$。这个案例突出了相对尺度的重要性。特征值的名义虚部 $\\epsilon=1$ 在绝对意义上并不小。然而，相对于对角元素的量级，它非常小。计算出的舒尔形式 $T$ 的 $1$-范数将是 $\\|T\\|_1 \\approx \\|A\\|_1 = 10^{16}+1$。容差为 $\\tau \\approx 10 \\cdot u \\cdot \\|T\\|_1 \\approx 10 \\cdot (1.11 \\times 10^{-16}) \\cdot (10^{16}+1) \\approx 11.1$。计算出的舒尔形式的次对角线元素 $|T_{21}|$ 将接近 $|-\\epsilon|=1$。由于 $|T_{21}| \\approx 1 \\le 11.1$，条件 $|T_{21}| > \\tau$ 为假。相对于矩阵的大尺度，非对角线元素被认为是可忽略的。我们将其分类为两个 $1 \\times 1$ 块。结果：$1$。\n\n**用例6：** $a=10^{-16}, \\epsilon=10^{-16}$。\n矩阵为 $A = \\begin{bmatrix} 10^{-16}  10^{-16} \\\\ -10^{-16}  10^{-16} \\end{bmatrix}$。这里，所有元素都具有相同的小量级。非对角线元素 $\\epsilon$ 相对于对角线元素 $a$ 并不小。$1$-范数将是 $\\|T\\|_1 \\approx 2 \\times 10^{-16}$。容差为 $\\tau \\approx 10 \\cdot u \\cdot \\|T\\|_1 \\approx 10 \\cdot (1.11 \\times 10^{-16}) \\cdot (2 \\times 10^{-16}) \\approx 2.22 \\times 10^{-31}$。次对角线元素 $|T_{21}|$ 将约等于 $|\\epsilon|=10^{-16}$。由于 $|T_{21}| \\approx 10^{-16} \\gg 2.22 \\times 10^{-31}$，次对角线元素是显著的。我们将其分类为一个 $2 \\times 2$ 块。结果：$2$。",
                "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import schur\n\ndef solve():\n    \"\"\"\n    Computes the real Schur form for a family of 2x2 matrices and classifies\n    the block structure based on a machine-precision-aware tolerance.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (a, epsilon).\n    test_cases = [\n        (1.0, 1e-2),     # Case 1\n        (1.0, 1e-12),    # Case 2\n        (1.0, 1e-16),    # Case 3\n        (1.0, 1e-20),    # Case 4\n        (1e16, 1.0),     # Case 5\n        (1e-16, 1e-16),  # Case 6\n    ]\n\n    results = []\n    \n    # Unit roundoff for IEEE 754 double precision.\n    # np.finfo(float).eps is machine epsilon (2^-52), unit roundoff is half of that.\n    u = np.finfo(float).eps / 2.0\n\n    for a, epsilon in test_cases:\n        # Construct the matrix A(a, epsilon).\n        A = np.array([[a, epsilon], \n                      [-epsilon, a]], dtype=float)\n\n        # Compute the real Schur form T.\n        # The orthogonal matrix Q is also returned but not needed.\n        T, Q = schur(A, output='real')\n\n        # Calculate the 1-norm of the computed Schur form T.\n        norm_T_1 = np.linalg.norm(T, ord=1)\n        \n        # Define the tolerance tau based on the problem specification.\n        tau = 10 * u * norm_T_1\n\n        # Extract the subdiagonal element T_21.\n        T_21 = T[1, 0]\n\n        # Classify the block structure based on the tolerance.\n        # Output 2 for a 2x2 block (complex conjugate pair).\n        # Output 1 for two 1x1 blocks (real eigenvalues).\n        if np.abs(T_21)  tau:\n            results.append(2)\n        else:\n            results.append(1)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```",
                "id": "3595428"
            }
        ]
    }