{
        "hands_on_practices": [
            {
                "introduction": "Eckart-Young-Mirsky 定理为寻找矩阵的最佳低秩近似提供了强大的工具。第一个练习将让你直接应用该定理的核心结论，计算给定秩 $k$ 下谱范数和 Frobenius 范数中的最小近似误差。通过完成这个计算 [@problem_id:3587148]，你将具体理解奇异值谱的“尾部”如何量化最优近似误差。",
                "problem": "考虑一个秩为 $r$ 的实矩阵 $A \\in \\mathbb{R}^{m \\times n}$，并回顾其奇异值分解 (SVD) 定义为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角矩阵，其非负对角线元素为 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\dots \\geq \\sigma_{r} > 0$，其余元素为零。Frobenius 范数 $\\| \\cdot \\|_{F}$ 定义为 $\\|X\\|_{F}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} x_{ij}^{2}$，谱范数 $\\| \\cdot \\|_{2}$ 定义为 $\\|X\\|_{2} = \\max_{\\|y\\|_{2} = 1} \\|X y\\|_{2}$，它等于 $X$ 的最大奇异值。如果对于所有正交矩阵 $Q_{1}, Q_{2}$ 和所有 $X$ 都满足 $\\|Q_{1} X Q_{2}\\| = \\|X\\|$，则范数 $\\|\\cdot\\|$ 称为酉不变范数。\n\n您将使用 SVD、上述定义以及 $\\|\\cdot\\|_{F}$ 和 $\\|\\cdot\\|_{2}$ 都是酉不变范数这一事实，从第一性原理出发分析 $A$ 的最佳秩-$k$ 近似。设 $A$ 的秩 $r = 8$，奇异值为\n$$\n\\sigma_{1} = 14,\\ \\sigma_{2} = 10,\\ \\sigma_{3} = 7,\\ \\sigma_{4} = 5,\\ \\sigma_{5} = 3,\\ \\sigma_{6} = 2,\\ \\sigma_{7} = 1,\\ \\sigma_{8} = 0.5.\n$$\n对于目标秩 $k = 4$，计算任何秩为 4 的 $A$ 的近似矩阵可实现的最小 Frobenius 误差和最小谱误差。然后，对于统一容差 $\\varepsilon = 3.5$，确定满足存在一个秩为 $k$ 的矩阵 $\\tilde{A}_{k}$ 使得 $\\|A - \\tilde{A}_{k}\\|_{F} \\leq \\varepsilon$ 的最小整数 $k$，并独立地确定满足存在一个秩为 $k$ 的矩阵 $A_{k}$ 使得 $\\|A - A_{k}\\|_{2} \\leq \\varepsilon$ 的最小整数 $k$。\n\n请精确表示 $k = 4$ 时的两个最小误差（不要四舍五入），并以整数形式报告两个最小秩。您的最终答案必须是一个单行矩阵，包含四个条目，顺序为：$k=4$ 时的最小 Frobenius 误差、$k=4$ 时的最小谱误差、满足 Frobenius 容差 $\\varepsilon$ 的最小 $k$、满足谱容差 $\\varepsilon$ 的最小 $k$。",
                "solution": "我们从奇异值分解 $A = U \\Sigma V^{\\top}$ 以及 Frobenius 范数和谱范数的定义开始。$\\|\\cdot\\|_{F}$ 和 $\\|\\cdot\\|_{2}$ 都是酉不变范数，因此对于任何候选的秩-$k$ 近似矩阵 $X$，误差 $\\|A - X\\|$ 仅取决于 $A - X$ 的奇异值，并可以在对角的 SVD 坐标系中进行分析。\n\n一个秩为 $k$ 的矩阵 $X$ 可以写成 $X = U Y V^{\\top}$ 的形式，其中 $Y$ 的秩最多为 $k$。因为 $U$ 和 $V$ 是正交的，且范数是酉不变的，所以对于 $\\|\\cdot\\|_{F}$ 和 $\\|\\cdot\\|_{2}$ 两种范数，都有 $\\|A - X\\| = \\|\\Sigma - Y\\|$。因此，问题简化为用一个秩为 $k$ 的矩阵 $Y$ 来近似对角矩阵 $\\Sigma$，从而最小化所选范数下的 $\\|\\Sigma - Y\\|$。\n\n对于 Frobenius 范数，其平方范数在正交方向上可加性分解：如果 $\\Sigma = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{r},0,\\dots)$ 并且 $Y$ 的奇异值 $\\tau_{1},\\dots,\\tau_{k}$ 排列在对角线上（所有其他对角线元素为零），则\n$$\n\\|\\Sigma - Y\\|_{F}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} (\\Sigma - Y)_{ij}^{2} = \\sum_{j=1}^{r} (\\sigma_{j} - \\tau_{j})^{2} + \\sum_{j>r} 0,\n$$\n当 $Y$ 在相同基底下被选为对角矩阵时。在 $\\tau_{j} \\geq 0$ 且最多有 $k$ 个非零元素的约束下，对秩最多为 $k$ 的对角矩阵 $Y$ 进行最小化，可以通过匹配 $k$ 个最大的对角线元素并将剩余元素设为零来实现，因为 Frobenius 范数在对角坐标系下简化为欧几里得距离，并且任何对 $j \\leq k$ 的 $\\sigma_{j}$ 的偏离都会增加平方和。因此，最优选择是 $Y = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{k},0,\\dots)$，最小 Frobenius 误差为\n$$\n\\min_{\\operatorname{rank}(X) \\leq k} \\|A - X\\|_{F} = \\|\\Sigma - \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{k},0,\\dots)\\|_{F} = \\left(\\sum_{j=k+1}^{r} \\sigma_{j}^{2}\\right)^{1/2}.\n$$\n这个结论是正交不变性以及 Frobenius 范数在 SVD 基底下进行勾股分解的直接推论。\n\n对于谱范数，$\\|A - X\\|_{2}$ 等于 $A - X$ 的最大奇异值。在 SVD 坐标系中，选择对角的 $Y$ 并保留 $\\Sigma$ 的前 $k$ 个奇异值，得到 $A - X = U(\\Sigma - \\Sigma_{k})V^{\\top}$，其中 $\\Sigma_{k} = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{k},0,\\dots)$。矩阵 $\\Sigma - \\Sigma_{k}$ 是对角矩阵，其对角线元素为 $\\sigma_{k+1},\\dots,\\sigma_{r}$（其余为零），所以其最大奇异值为 $\\sigma_{k+1}$。一个针对酉不变范数（可视为奇异值的对称规范函数）的标准优超理论证明表明，任何其他秩为 $k$ 的 $Y$ 的选择都无法在不将秩增加到 $k$ 以上的情况下，将最大奇异值减小到 $\\sigma_{k+1}$ 以下，因为移除或削弱前 $k$ 个奇异方向中的任何一个，都会在残差中留下一个至少与 $\\sigma_{k+1}$ 一样大的奇异值。因此，\n$$\n\\min_{\\operatorname{rank}(X) \\leq k} \\|A - X\\|_{2} = \\sigma_{k+1}.\n$$\n我们现在将这些一般性结论应用于给定的数据。奇异值为\n$$\n\\sigma_{1} = 14,\\ \\sigma_{2} = 10,\\ \\sigma_{3} = 7,\\ \\sigma_{4} = 5,\\ \\sigma_{5} = 3,\\ \\sigma_{6} = 2,\\ \\sigma_{7} = 1,\\ \\sigma_{8} = 0.5,\n$$\n且 $k = 4$。\n\n1. $k = 4$ 时的最小 Frobenius 误差：\n$$\n\\left(\\sum_{j=5}^{8} \\sigma_{j}^{2}\\right)^{1/2} = \\left(3^{2} + 2^{2} + 1^{2} + 0.5^{2}\\right)^{1/2} = \\left(9 + 4 + 1 + 0.25\\right)^{1/2} = \\left(\\frac{57}{4}\\right)^{1/2} = \\frac{\\sqrt{57}}{2}.\n$$\n\n2. $k = 4$ 时的最小谱误差：\n$$\n\\sigma_{5} = 3.\n$$\n\n3. 达到 Frobenius 容差 $\\varepsilon = 3.5$ 的最小 $k$：\n我们需要\n$$\n\\left(\\sum_{j=k+1}^{8} \\sigma_{j}^{2}\\right)^{1/2} \\leq 3.5 \\quad \\Longleftrightarrow \\quad \\sum_{j=k+1}^{8} \\sigma_{j}^{2} \\leq 12.25.\n$$\n计算尾部和：\n- 对于 $k = 4$，$\\sum_{j=5}^{8} \\sigma_{j}^{2} = 9 + 4 + 1 + 0.25 = 14.25 > 12.25$。\n- 对于 $k = 5$，$\\sum_{j=6}^{8} \\sigma_{j}^{2} = 4 + 1 + 0.25 = 5.25 \\leq 12.25$。\n因此最小的 $k$ 是 $k = 5$。\n\n4. 达到谱容差 $\\varepsilon = 3.5$ 的最小 $k$：\n我们需要\n$$\n\\sigma_{k+1} \\leq 3.5.\n$$\n检查该序列，$\\sigma_{4} = 5 > 3.5$ 而 $\\sigma_{5} = 3 \\leq 3.5$，所以最小的 $k$ 是 $k = 4$。\n\n按指定顺序收集所要求的四个量，得到最终的行矩阵\n$$\n\\left( \\frac{\\sqrt{57}}{2},\\ 3,\\ 5,\\ 4 \\right).\n$$",
                "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\sqrt{57}}{2}  3  5  4\\end{pmatrix}}$$",
                "id": "3587148"
            },
            {
                "introduction": "深刻理解任何数学定理，不仅需要知道它何时适用，也要了解它何时不适用。Eckart-Young-Mirsky 定理的威力在于它适用于酉不变范数。本练习 [@problem_id:3587141] 将挑战你探索当这一关键条件被移除时会发生什么，通过检验逐元 $\\ell_{\\infty}$ 范数，并用一个具体的反例说明，截断 SVD 不再保证是最优的。",
                "problem": "考虑 $\\mathbb{R}^{m \\times n}$ 上的逐元素 $\\ell_{\\infty}$ 范数，其定义为 $\\|E\\|_{\\infty} = \\max_{i,j} |E_{i j}|$。回顾一个矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 的奇异值分解 (SVD) 是 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交的（在复数情况下是酉的），$\\Sigma$ 是具有非负项（奇异值）的对角矩阵。如果对于所有正交（酉）矩阵 $U$ 和 $V$ 都有 $\\|U A V^{\\top}\\| = \\|A\\|$ 成立，则矩阵上的范数 $\\|\\cdot\\|$ 称为酉不变范数。Eckart-Young-Mirsky 定理断言，对于任何酉不变范数，将矩阵 $A$ 的奇异值分解截断到秩 $k$ 会产生 $A$ 的一个最佳秩 $k$ 近似。\n\n您的任务是：\n\n- 构建一个具体反例，说明在逐元素 $\\ell_{\\infty}$ 范数下，截断可能是次优的。具体来说，令 $A \\in \\mathbb{R}^{2 \\times 2}$ 为单位矩阵 $A = I_{2}$，并固定其 SVD 为 $A = U \\Sigma V^{\\top}$，其中 $U = I_{2}$，$V = I_{2}$，且 $\\Sigma = I_{2}$。令 $A_{1}$ 表示在此固定 SVD 下仅保留主奇异分量的秩-1 截断。\n\n- 计算 $\\|A - A_{1}\\|_{\\infty}$ 的值。\n\n- 确定在所有秩-1 矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$ 上 $\\|A - X\\|_{\\infty}$ 的最小可能值，并给出一个达到该最小值的秩-1 矩阵。\n\n- 报告数值差距\n$$\n\\Delta \\;=\\; \\|A - A_{1}\\|_{\\infty} \\;-\\; \\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}.\n$$\n\n- 最后，从上述定义出发，不引用任何已有的定理，解释为什么酉不变性在 Eckart-Young-Mirsky 定理的结论中是必不可少的，以及为什么该结论不适用于逐元素 $\\ell_{\\infty}$ 范数。您的解释应从第一性原理出发，论述正交基变换如何影响逐元素范数与酉不变范数。\n\n将 $\\Delta$ 的值作为您的最终答案。无需四舍五入。",
                "solution": "首先验证问题，以确保其科学基础扎实、良定且客观。\n\n### 第 1 步：提取已知条件\n- 范数是 $\\mathbb{R}^{m \\times n}$ 上的逐元素 $\\ell_{\\infty}$ 范数：$\\|E\\|_{\\infty} = \\max_{i,j} |E_{i j}|$.\n- 如果对于所有正交矩阵 $U, V$ 都有 $\\|U A V^{\\top}\\| = \\|A\\|$，则范数 $\\|\\cdot\\|$ 是酉不变的。\n- Eckart-Young-Mirsky (EYM) 定理指出，对于酉不变范数，将矩阵 $A$ 的奇异值分解 (SVD) 截断到秩 $k$ 会得到一个最佳秩 $k$ 近似。\n- 具体矩阵是 $A = I_{2} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n- $A$ 的固定 SVD 是 $A = U \\Sigma V^{\\top}$，其中 $U = I_{2}$，$\\Sigma = I_{2}$，且 $V = I_{2}$。\n- $A_{1}$ 是此 SVD 的秩-1 截断。\n- 任务是计算 $\\|A - A_{1}\\|_{\\infty}$，找到 $\\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}$，计算差距 $\\Delta = \\|A - A_{1}\\|_{\\infty} - \\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}$，并解释酉不变性的作用。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题是有效的。\n- **科学基础扎实**：该问题是数值线性代数中的一个标准练习，基于公认的 Eckart-Young-Mirsky 定理和标准矩阵范数。所有定义都是正确的。\n- **良定性**：问题陈述清晰，要求具体的、可计算的量和一个概念性解释。它有一个唯一且稳定的解。\n- **客观性**：语言精确且数学化，没有歧义或主观看法。\n所有其他验证标准均已满足。该问题是一个精心构建的反例，用以说明一个重要定理的关键条件。\n\n### 第 3 步：结论和行动\n问题是有效的。我们继续进行解答。\n\n### 第 1 部分：计算 $\\|A - A_{1}\\|_{\\infty}$\n矩阵是 $A = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。给定的 SVD 是 $A = U \\Sigma V^{\\top}$，其中 $U=I_2$, $V=I_2$, 且 $\\Sigma=I_2$。奇异值为 $\\sigma_1=1$ 和 $\\sigma_2=1$。奇异向量是 $u_1 = v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $u_2 = v_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n完整的 SVD 展开是 $A = \\sigma_1 u_1 v_1^{\\top} + \\sigma_2 u_2 v_2^{\\top}$。秩-1 SVD 截断 $A_1$ 是通过仅保留第一项得到的：\n$$\nA_1 = \\sigma_1 u_1 v_1^{\\top} = 1 \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n近似误差是矩阵 $A - A_1$：\n$$\nA - A_1 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n该误差的逐元素 $\\ell_{\\infty}$ 范数是其元素绝对值的最大值：\n$$\n\\|A - A_1\\|_{\\infty} = \\max \\{|0|, |0|, |0|, |1|\\} = 1\n$$\n\n### 第 2 部分：确定 $\\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}$\n我们试图找到在所有秩-1 矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$ 上 $\\|I_2 - X\\|_{\\infty}$ 的最小值。\n一个秩-1 矩阵 $X$ 的行列式必须为零。令 $E = I_2 - X$ 为误差矩阵。则 $X = I_2 - E$。$X$ 的秩为 1（或 0）的条件是 $\\det(X) = 0$。\n$$\n\\det(I_2 - E) = 0\n$$\n令 $E = \\begin{pmatrix} e_{11}  e_{12} \\\\ e_{21}  e_{22} \\end{pmatrix}$。条件变为：\n$$\n\\det \\begin{pmatrix} 1-e_{11}  -e_{12} \\\\ -e_{21}  1-e_{22} \\end{pmatrix} = (1-e_{11})(1-e_{22}) - (-e_{12})(-e_{21}) = 0\n$$\n$$\n1 - e_{11} - e_{22} + e_{11}e_{22} - e_{12}e_{21} = 0\n$$\n我们要在此约束条件下最小化 $\\epsilon = \\|E\\|_{\\infty} = \\max_{i,j} |e_{ij}|$。\n这意味着对于所有 $i,j \\in \\{1,2\\}$，都有 $|e_{ij}| \\le \\epsilon$。\n条件 $\\det(X) = 0$ 可以重写为 $x_{11}x_{22} - x_{12}x_{21} = 0$，对于 $X = \\begin{pmatrix} x_{11}  x_{12} \\\\ x_{21}  x_{22} \\end{pmatrix}$。\n$X$ 的元素与误差元素的关系为 $x_{ij} = (\\delta_{ij} - e_{ij})$，其中 $\\delta_{ij}$ 是克罗内克 δ。\n所以 $x_{11} = 1-e_{11}$, $x_{22} = 1-e_{22}$, $x_{12} = -e_{12}$, $x_{21} = -e_{21}$。\n条件是 $(1-e_{11})(1-e_{22}) - (-e_{12})(-e_{21}) = 0$。这与之前的方程相同。现在我们来使用边界。\n$|e_{12}| \\le \\epsilon$ 且 $|e_{21}| \\le \\epsilon$，所以 $|e_{12}e_{21}| \\le \\epsilon^2$。\n$|1-e_{11}| \\le \\epsilon \\implies 1-\\epsilon \\le e_{11} \\le 1+\\epsilon$。$|1-e_{22}| \\le \\epsilon \\implies 1-\\epsilon \\le e_{22} \\le 1+\\epsilon$。\n如果 $\\epsilon  1$，那么 $1-\\epsilon > 0$，所以 $e_{11}$ 和 $e_{22}$ 必须为正。\n从行列式条件：\n$$\n(1-e_{11})(1-e_{22}) = e_{12}e_{21}\n$$\n取绝对值：\n$$\n|(1-e_{11})(1-e_{22})| = |e_{12}e_{21}| \\le \\epsilon^2\n$$\n左侧可以从下方界定。由于 $|1-e_{11}| \\le \\epsilon$，我们有 $|1-e_{11}| \\ge 0$。啊，这不是正确的方法。让我们直接使用 $X$。\n令 $\\epsilon = \\min_{\\operatorname{rank}(X)=1} \\|I_2 - X\\|_{\\infty}$。那么对于一个最优的 $X$，我们有：\n$|1-x_{11}| \\le \\epsilon$, $|-x_{12}| \\le \\epsilon$, $|-x_{21}| \\le \\epsilon$, $|1-x_{22}| \\le \\epsilon$。\n这意味着 $|x_{12}| \\le \\epsilon$ 和 $|x_{21}| \\le \\epsilon$。并且，$1-\\epsilon \\le x_{11} \\le 1+\\epsilon$ 和 $1-\\epsilon \\le x_{22} \\le 1+\\epsilon$。\n最小的 $\\epsilon$ 必须小于 1（从我们的 SVD 结果可知），所以我们可以假设 $\\epsilon  1$。这意味着 $1-\\epsilon>0$，所以 $x_{11}$ 和 $x_{22}$ 必须为正。\n秩-1 条件是 $x_{11}x_{22} = x_{12}x_{21}$。\n取模并使用边界，我们得到：\n$$\nx_{11}x_{22} = |x_{12}x_{21}| = |x_{12}| |x_{21}| \\le \\epsilon \\cdot \\epsilon = \\epsilon^2\n$$\n使用 $x_{11}$ 和 $x_{22}$ 的下界：\n$$\nx_{11}x_{22} \\ge (1-\\epsilon)(1-\\epsilon) = (1-\\epsilon)^2\n$$\n结合这两个不等式：\n$$\n(1-\\epsilon)^2 \\le x_{11}x_{22} \\le \\epsilon^2\n$$\n这要求 $(1-\\epsilon)^2 \\le \\epsilon^2$。由于 $1-\\epsilon > 0$ 且 $\\epsilon \\ge 0$，我们可以开平方：\n$$\n1 - \\epsilon \\le \\epsilon \\implies 1 \\le 2\\epsilon \\implies \\epsilon \\ge \\frac{1}{2}\n$$\n所以最小可能误差至少为 $1/2$。我们可以证明这个最小值是可以达到的。让我们构建一个秩-1 矩阵 $X$ 使得 $\\|I_2 - X\\|_{\\infty} = 1/2$。\n考虑 $X = \\begin{pmatrix} 1/2  1/2 \\\\ 1/2  1/2 \\end{pmatrix}$。这个矩阵的秩为 1，因为它的行是相同的。\n误差矩阵是：\n$$\nI_2 - X = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1/2  1/2 \\\\ 1/2  1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2  -1/2 \\\\ -1/2  1/2 \\end{pmatrix}\n$$\n这个误差的 $\\ell_{\\infty}$ 范数是 $\\|I_2 - X\\|_{\\infty} = \\max\\{|1/2|, |-1/2|\\} = 1/2$。\n因为我们证明了一个 $1/2$ 的下界，并找到了一个达到该下界的矩阵，所以最小值恰好是 $1/2$。\n$$\n\\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty} = \\frac{1}{2}\n$$\n\n### 第 3 部分：计算差距 $\\Delta$\n差距是 SVD 截断的误差与真实最小误差之间的差值。\n$$\n\\Delta = \\|A - A_{1}\\|_{\\infty} - \\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty} = 1 - \\frac{1}{2} = \\frac{1}{2}\n$$\n\n### 第 4 部分：酉不变性的解释\nEckart-Young-Mirsky 定理的结论根本上依赖于范数的酉不变性。一个范数 $\\|\\cdot\\|$ 是酉不变的，如果它在正交基变换下保持不变，即对于所有正交矩阵 $U$ 和 $V$ 都有 $\\|UAV^\\top\\| = \\|A\\|$。这类范数，如 Frobenius 范数 $\\|\\cdot\\|_F$ 和谱范数 $\\|\\cdot\\|_2$，仅依赖于矩阵的奇异值，而不依赖于奇异向量。\n\nEYM 定理的证明利用了这一性质。对于一个矩阵 $A = U\\Sigma V^\\top$，通过酉不变性，在秩-k 矩阵 $X$ 上最小化 $\\|A-X\\|$ 的问题被转换为：\n$$\n\\|A-X\\| = \\|U\\Sigma V^\\top - X\\| = \\|U^\\top(U\\Sigma V^\\top - X)V\\| = \\|\\Sigma - U^\\top XV\\|\n$$\n由于 $X$ 是任意秩-k 矩阵，$Y = U^\\top XV$ 也是任意秩-k 矩阵。问题简化为寻找对角矩阵 $\\Sigma$ 的最佳秩-k 近似。对于一个对角矩阵，直观上最佳近似是保留 $k$ 个最大的元素并将其他元素置零。这对应于 $Y$ 是一个包含前 $k$ 个奇异值的对角矩阵，这反过来意味着 $X=A_k$，即 $A$ 的截断 SVD。\n\n逐元素 $\\ell_{\\infty}$ 范数不是酉不变的。它测量矩阵中的最大元素 $|A_{ij}| = |e_i^\\top A e_j|$，这明确地依赖于标准基 $\\{e_i\\}$。正交变换会混合这些元素，并可能改变它们的最大值。例如，令 $A = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$，所以 $\\|A\\|_\\infty = 1$。令 $U=V=\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix}$（一个旋转矩阵）。那么 $B = UAV^\\top = \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$，且 $\\|B\\|_\\infty = 1/2$。由于 $\\|A\\|_\\infty \\neq \\|B\\|_\\infty$，该范数不是酉不变的。\n\n这种不变性的缺失意味着我们不能通过将其变换到奇异向量基来简化最小化问题。最小化 $\\|A-X\\|_\\infty$ 的问题必须在原始的标准基中解决。\n\n我们用 $A = I_2$ 的反例完美地说明了这一点。\n- SVD 截断 $A_1 = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$ 产生的误差矩阵为 $A-A_1 = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$。误差完全集中在单个元素上，导致最大误差为 $\\|A-A_1\\|_\\infty = 1$。\n- 最优的秩-1 近似是 $X = \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$，这导致的误差矩阵为 $A-X = \\begin{pmatrix} 1/2  -1/2 \\\\ -1/2  1/2 \\end{pmatrix}$。在这里，总误差被“分散”到所有元素中。因为 $\\ell_\\infty$ 范数只记录最大的单个元素，所以这种分散策略是有效的，将误差的范数减小到 $1/2$。\n\n本质上，SVD 在一种与基无关的意义上提供了最优的低秩近似。那些不具有基无关性（酉不变性）的范数无法“看到”这种最优性。对于 $\\ell_\\infty$ 范数，找到一个用小误差污染所有元素的近似，比一个完美地将某些分量置零但留下一个大的、集中的误差在另一个分量上的近似要更好。",
                "answer": "$$\\boxed{\\frac{1}{2}}$$",
                "id": "3587141"
            },
            {
                "introduction": "现在我们已经了解了如何计算误差和理解定理的边界，我们可以更深入地探究近似误差本身的性质。本练习探讨了用谱范数和 Frobenius 范数衡量的最小误差之间的关系。通过分析它们的比率 [@problem_id:3587164]，你将揭示奇异值的分布如何决定误差的结构，从而发现哪类矩阵在“总误差”意义上比在“最坏情况误差”意义上更容易近似。",
                "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 的奇异值为 $\\sigma_{1}(A) \\geq \\sigma_{2}(A) \\geq \\cdots \\geq \\sigma_{p}(A) \\geq 0$，其中 $p = \\min\\{m,n\\}$。对于满足 $0 \\leq k  p$ 的固定整数 $k$，定义差异泛函\n$$\nD(A,k) \\;=\\; \\frac{\\|A - A_{k}\\|_{F}}{\\|A - A_{k}\\|_{2}},\n$$\n其中 $A_{k}$ 是 $A$ 关于谱范数 $\\|\\cdot\\|_{2}$ 和弗罗贝尼乌斯范数 $\\|\\cdot\\|_{F}$ 的任意最佳秩-$k$ 近似。仅从奇异值分解、谱范数和弗罗贝尼乌斯范数的正交不变性以及奇异值的基本不等式出发，完成以下任务。\n\n(1) 证明 $A_{k}$ 是通过将 $A$ 的奇异值分解截断为其前 $k$ 个奇异方向得到的，并且残差 $A - A_{k}$ 的奇异值为 $\\sigma_{k+1}(A), \\ldots, \\sigma_{p}(A)$。由此推导出\n$$\nD(A,k) \\;=\\; \\frac{\\left(\\sum_{i=k+1}^{p} \\sigma_{i}(A)^{2}\\right)^{1/2}}{\\sigma_{k+1}(A)}.\n$$\n\n(2) 固定 $m$、$n$ 和 $k$，并固定一个正的尾部锚点 $s > 0$。考虑所有满足 $\\sigma_{1} \\geq \\cdots \\geq \\sigma_{p} \\geq 0$ 且 $\\sigma_{k+1} = s$ 的谱 $(\\sigma_{1},\\ldots,\\sigma_{p})$ 的集合。在所有这些谱中，确定 $D(A,k)$ 的上确界，并构造一个达到该上确界的非增谱。将您的最终答案表示为一个仅依赖于 $p$ 和 $k$（而不依赖于 $s$、$m$、$n$ 或前导奇异值）的单一闭式表达式。\n\n仅提供该最终表达式作为您的答案；无需单位。",
                "solution": "该问题是有效的，因为它是数值线性代数中一个适定问题，基于奇异值分解和矩阵范数的既定理论。它是客观、自洽的，并且需要严格的数学推导。\n\n根据要求，解答分为两部分。\n\n(1) $D(A,k)$ 表达式的证明\n\n设矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 的奇异值分解（SVD）为\n$$A = U \\Sigma V^T = \\sum_{i=1}^{p} \\sigma_{i} u_{i} v_{i}^T,$$\n其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$p = \\min\\{m, n\\}$，且 $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是包含奇异值 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots \\geq \\sigma_{p} \\geq 0$ 的对角矩阵。向量 $u_i$ 和 $v_i$ 分别是对应于奇异值 $\\sigma_i$ 的左奇异向量和右奇异向量。\n\n问题将 $A_k$ 定义为 $A$ 关于谱范数（$\\|\\cdot\\|_2$）和弗罗贝尼乌斯范数（$\\|\\cdot\\|_F$）的最佳秩-$k$ 近似。Eckart-Young-Mirsky 定理指出，这种近似是由截断的SVD给出的。我们将按要求证明这个结果。\n\n设 $A_k$ 是通过在第 $k$ 项后截断 $A$ 的SVD所得到的秩-$k$ 矩阵：\n$$A_k = \\sum_{i=1}^{k} \\sigma_{i} u_{i} v_{i}^T.$$\n\n首先，我们证明 $A_k$ 在所有秩-$k$ 矩阵 $B$ 中最小化 $\\|A-B\\|_2$。\n残差矩阵为 $A - A_k = \\sum_{i=k+1}^{p} \\sigma_{i} u_{i} v_{i}^T$。这是 $A-A_k$ 的SVD，表明其奇异值为 $\\sigma_{k+1}, \\sigma_{k+2}, \\ldots, \\sigma_p$。矩阵的谱范数是其最大的奇异值。因此，\n$$\\|A - A_k\\|_2 = \\sigma_{k+1}(A).$$\n现在，考虑任意秩为 $k$ 的矩阵 $B \\in \\mathbb{R}^{m \\times n}$。其零空间 $\\mathcal{N}(B)$ 的维数为 $n-k$。令 $\\mathcal{S}_{k+1} = \\text{span}\\{v_1, v_2, \\ldots, v_{k+1}\\}$，这是一个 $\\mathbb{R}^n$ 中维数为 $k+1$ 的子空间。这两个子空间的维数之和为 $(n-k) + (k+1) = n+1 > n$。因此，它们的交集 $\\mathcal{N}(B) \\cap \\mathcal{S}_{k+1}$ 必定非平凡。设 $x$ 是此交集中的一个单位向量。\n由于 $x \\in \\mathcal{N}(B)$，我们有 $Bx=0$。\n由于 $x \\in \\mathcal{S}_{k+1}$，我们可以写出 $x = \\sum_{i=1}^{k+1} c_i v_i$，其中 $\\sum_{i=1}^{k+1} c_i^2 = \\|x\\|_2^2 = 1$。\n现在我们计算 $\\|(A-B)x\\|_2$：\n$$\\|(A-B)x\\|_2^2 = \\|Ax\\|_2^2 = \\left\\| \\left(\\sum_{j=1}^{p} \\sigma_j u_j v_j^T\\right) \\left(\\sum_{i=1}^{k+1} c_i v_i\\right) \\right\\|_2^2 = \\left\\| \\sum_{i=1}^{k+1} c_i \\sigma_i u_i \\right\\|_2^2.$$\n由于向量 $u_i$ 是标准正交的，这可以简化为：\n$$\\|Ax\\|_2^2 = \\sum_{i=1}^{k+1} (c_i \\sigma_i)^2 \\geq \\sigma_{k+1}^2 \\sum_{i=1}^{k+1} c_i^2 = \\sigma_{k+1}^2.$$\n该不等式成立，因为对于所有 $i \\leq k+1$ 都有 $\\sigma_i \\geq \\sigma_{k+1}$。\n取平方根，我们得到 $\\|(A-B)x\\|_2 \\geq \\sigma_{k+1}$。\n谱范数的定义为 $\\|A-B\\|_2 = \\sup_{\\|y\\|_2=1} \\|(A-B)y\\|_2$。因此，\n$$\\|A-B\\|_2 \\geq \\|(A-B)x\\|_2 \\geq \\sigma_{k+1} = \\|A-A_k\\|_2.$$\n这表明 $A_k$ 是谱范数意义下的最佳秩-$k$ 近似。\n\n接下来，我们证明 $A_k$ 在所有秩-$k$ 矩阵 $B$ 中最小化 $\\|A-B\\|_F$。\n弗罗贝尼乌斯范数在正交变换下是不变的，因此对于任何秩-$k$ 矩阵 $B$：\n$$\\|A-B\\|_F^2 = \\|U^T(A-B)V\\|_F^2 = \\|U^TAV - U^TBV\\|_F^2 = \\|\\Sigma - C\\|_F^2,$$\n其中 $C = U^TBV$。由于 $U$ 和 $V$ 是正交的，$\\text{rank}(C)=\\text{rank}(B)=k$。\n弗罗贝尼乌斯范数的平方是矩阵元素平方的总和。\n$$\\|\\Sigma - C\\|_F^2 = \\sum_{i=1}^{m}\\sum_{j=1}^{n} (\\Sigma_{ij} - C_{ij})^2 = \\sum_{i=1}^{p} (\\sigma_i - C_{ii})^2 + \\sum_{i \\neq j} C_{ij}^2.$$\n为了最小化这个量，我们应该选择 $C$ 为对角矩阵，因此当 $i \\neq j$ 时 $C_{ij}=0$。问题随之简化为在 $C$ 是一个秩为 $k$ 的对角矩阵的约束下，最小化 $\\sum_{i=1}^{p} (\\sigma_i - C_{ii})^2$。这意味着对角线元素 $C_{ii}$ 中最多有 $k$ 个可以是非零的。为了最小化平方和，我们必须为对应于 $\\sigma_i$ 最大值的 $k$ 个索引 $i$ 设置 $C_{ii} = \\sigma_i$，而对于所有其他 $i$ 设置 $C_{ii}=0$。由于奇异值是有序的，最优选择是：\n$$C_{ii} = \\sigma_i \\quad \\text{for } i=1, \\ldots, k,$$\n$$C_{ii} = 0 \\quad \\text{for } i=k+1, \\ldots, p.$$\n这个 $C$ 的选择恰好对应于 $C=U^T A_k V$。通过这种选择，最小值为：\n$$\\|A-A_k\\|_F^2 = \\sum_{i=k+1}^{p} (\\sigma_i - 0)^2 = \\sum_{i=k+1}^{p} \\sigma_i^2.$$\n因此，对于任何秩-$k$ 矩阵 $B$，都有 $\\|A-B\\|_F^2 \\geq \\|A-A_k\\|_F^2 = \\sum_{i=k+1}^{p} \\sigma_i^2$。这表明 $A_k$ 是弗罗贝尼乌斯范数意义下的最佳秩-$k$ 近似。\n\n问题指出 $A-A_k$ 的奇异值为 $\\sigma_{k+1}(A), \\ldots, \\sigma_p(A)$。如前所示，残差为 $A - A_k = \\sum_{i=k+1}^p \\sigma_i u_i v_i^T$。这是矩阵 $A-A_k$ 的一个有效SVD（如有必要，可重新索引），因此其奇异值确实是 $\\{\\sigma_{k+1}(A), \\ldots, \\sigma_p(A)\\}$。\n\n现在我们可以计算差异泛函 $D(A,k)$。根据以上结果：\n$$\\|A - A_k\\|_{F} = \\left(\\sum_{i=k+1}^{p} \\sigma_{i}(A)^{2}\\right)^{1/2}$$\n$$\\|A - A_k\\|_{2} = \\sigma_{k+1}(A)$$\n将这些代入 $D(A,k)$ 的定义中：\n$$D(A,k) = \\frac{\\|A - A_{k}\\|_{F}}{\\|A - A_{k}\\|_{2}} = \\frac{\\left(\\sum_{i=k+1}^{p} \\sigma_{i}(A)^{2}\\right)^{1/2}}{\\sigma_{k+1}(A)}.$$\n这就完成了问题的第一部分。\n\n(2) $D(A,k)$ 的上确界\n\n我们被要求在所有满足 $\\sigma_1 \\geq \\cdots \\geq \\sigma_p \\geq 0$ 且第 $(k+1)$ 个奇异值固定为常数 $s > 0$（即 $\\sigma_{k+1} = s$）的谱 $(\\sigma_1, \\ldots, \\sigma_p)$ 集合中，找到 $D(A,k)$ 的上确界。\n\n$D(A,k)$ 的表达式可以用奇异值 $\\{\\sigma_i\\}$ 来表示：\n$$D(A,k) = \\frac{\\left(\\sigma_{k+1}^2 + \\sum_{i=k+2}^{p} \\sigma_{i}^{2}\\right)^{1/2}}{\\sigma_{k+1}}.$$\n代入约束条件 $\\sigma_{k+1} = s$：\n$$D(A,k) = \\frac{\\left(s^2 + \\sum_{i=k+2}^{p} \\sigma_{i}^{2}\\right)^{1/2}}{s} = \\sqrt{1 + \\frac{1}{s^2}\\sum_{i=k+2}^{p} \\sigma_{i}^{2}}.$$\n为了最大化 $D(A,k)$，我们必须最大化和 $\\sum_{i=k+2}^{p} \\sigma_{i}^{2}$。这个和中的变量 $\\sigma_{k+2}, \\ldots, \\sigma_p$ 受非增次序约束：\n$$s = \\sigma_{k+1} \\geq \\sigma_{k+2} \\geq \\cdots \\geq \\sigma_p \\geq 0.$$\n为了使平方和 $\\sum_{i=k+2}^{p} \\sigma_{i}^{2}$ 尽可能大，我们应该使每个单独的项 $\\sigma_i$ 尽可能大。\n$\\sigma_{k+2}$ 的上界是 $\\sigma_{k+1} = s$。\n$\\sigma_{k+3}$ 的上界是 $\\sigma_{k+2}$。\n...\n$\\sigma_p$ 的上界是 $\\sigma_{p-1}$。\n\n通过设置 $\\sigma_{k+2} = s$，我们满足 $\\sigma_{k+1} \\geq \\sigma_{k+2}$ 并最大化 $\\sigma_{k+2}^2$。给定此选择，我们可以接着设置 $\\sigma_{k+3} = s$ 来满足 $\\sigma_{k+2} \\geq \\sigma_{k+3}$ 并最大化 $\\sigma_{k+3}^2$。我们可以对所有剩余的奇异值进行迭代。因此，当选择以下值时，和达到最大值：\n$$\\sigma_{k+2} = \\sigma_{k+3} = \\cdots = \\sigma_p = s.$$\n约束条件 $\\sigma_1 \\geq \\cdots \\geq \\sigma_k \\geq \\sigma_{k+1}=s$ 不影响 $D(A,k)$ 的值。一个达到上确界的有效谱可以通过将所有奇异值都设置为 $s$ 来构造：\n$$\\sigma_1 = \\sigma_2 = \\cdots = \\sigma_p = s.$$\n这是一个满足所有条件的非增谱。\n\n通过这个最大化选择，平方和变为：\n$$\\sum_{i=k+1}^{p} \\sigma_i^2 = \\sum_{i=k+1}^{p} s^2 = (p-k) s^2.$$\n和中的项数为 $p - (k+1) + 1 = p-k$。\n将此代回 $D(A,k)$ 的表达式，我们找到上确界值：\n$$\\sup D(A,k) = \\frac{\\left((p-k)s^2\\right)^{1/2}}{s} = \\frac{s\\sqrt{p-k}}{s} = \\sqrt{p-k}.$$\n此表达式仅依赖于 $p$ 和 $k$，符合要求。",
                "answer": "$$\\boxed{\\sqrt{p-k}}$$",
                "id": "3587164"
            }
        ]
    }