{
        "hands_on_practices": [
            {
                "introduction": "Bartels-Stewart 算法的核心在于将一个稠密的西尔维斯特方程（Sylvester equation）转化为一个具有准上三角矩阵的等价形式。这个转化的方程可以通过一种结构化的回代方法来求解。这个练习将引导你推导这一回代过程的基础，即针对严格上三角矩阵的标量递归关系，并确定一个有效的计算顺序，从而为理解更复杂的块回代方法奠定基础。",
                "problem": "考虑 Bartels–Stewart 算法 (BSA) 核心步骤中的西尔维斯特方程。该算法将一对通用矩阵约化为实舒尔形式 (RSF)：给定上三角矩阵 $T \\in \\mathbb{R}^{n \\times n}$ 和 $S \\in \\mathbb{R}^{m \\times m}$ 以及右端项 $F \\in \\mathbb{R}^{n \\times m}$，求解\n$$\nT Y + Y S = F,\n$$\n以求未知矩阵 $Y \\in \\mathbb{R}^{n \\times m}$。\n\n1. 仅从矩阵乘法的定义以及 $T$ 和 $S$ 是上三角矩阵的性质出发，推导出一个关于 $Y$ 的元素 $y_{ij}$ 的显式标量递推公式，该公式用 $T$、$S$、$F$ 的元素以及已计算出的 $Y$ 的元素表示。您的推导必须分离出对角线项，并系统地化简由上三角结构所产生的双重求和；不要引用任何现成的公式。\n\n2. 使用您的递推公式，为索引对 $(i,j)$ 提出一个计算顺序，以保证在计算 $y_{ij}$ 时，其所依赖的所有量都已被计算。从您的推导所揭示的依赖结构出发，对您提出的顺序进行逻辑论证。\n\n3. 将您的计算顺序应用于以下具体的 $3 \\times 3$ 实例：\n$$\nT=\\begin{pmatrix}\n2  1  -1\\\\\n0  3  2\\\\\n0  0  5\n\\end{pmatrix},\\quad\nS=\\begin{pmatrix}\n-1  2  0\\\\\n0  4  1\\\\\n0  0  6\n\\end{pmatrix},\\quad\nF=\\begin{pmatrix}\n1  0  2\\\\\n3  -1  1\\\\\n4  2  0\n\\end{pmatrix}.\n$$\n精确计算单个元素 $y_{23}$。将您的最终答案表示为精确的有理数；不要四舍五入。",
                "solution": "这个问题是有效的，因为它代表了数值线性代数中的一个标准任务——求解上三角矩阵的西尔维斯特方程，这是 Bartels-Stewart 算法的核心。给定的矩阵和方程是良定义的，并且唯一解的存在性得到了保证，因为 $T$ 和 $-S$ 的谱是不相交的。具体来说，$T$ 的特征值为 $\\{2, 3, 5\\}$，$S$ 的特征值为 $\\{-1, 4, 6\\}$，所以 $-S$ 的特征值为 $\\{1, -4, -6\\}$。这些集合是不相交的，确保了对于所有的 $i, j$都有 $t_{ii} + s_{jj} \\neq 0$，这是我们即将推导的递推公式的可解性条件。\n\n### 第1部分：标量递推公式的推导\n\n西尔维斯特方程为\n$$\nTY + YS = F\n$$\n其中 $T \\in \\mathbb{R}^{n \\times n}$ 和 $S \\in \\mathbb{R}^{m \\times m}$ 是上三角矩阵，且 $F \\in \\mathbb{R}^{n \\times m}$，$Y \\in \\mathbb{R}^{n \\times m}$。我们寻求矩阵 $Y$ 的元素 $y_{ij}$ 的标量公式。\n\n该矩阵方程的第 $(i,j)$ 个元素由下式给出：\n$$\n(TY)_{ij} + (YS)_{ij} = f_{ij}\n$$\n对于 $i \\in \\{1, \\dots, n\\}$ 和 $j \\in \\{1, \\dots, m\\}$。\n\n使用矩阵乘法的定义，我们展开左侧的两项：\n$$\n(TY)_{ij} = \\sum_{k=1}^{n} t_{ik} y_{kj}\n$$\n$$\n(YS)_{ij} = \\sum_{l=1}^{m} y_{il} s_{lj}\n$$\n\n现在，我们引入 $T$ 和 $S$ 的上三角结构。\n对于矩阵 $T$，$i > k$ 时有 $t_{ik} = 0$。因此，$(TY)_{ij}$ 的求和可以简化为从索引 $k=i$ 开始：\n$$\n(TY)_{ij} = \\sum_{k=i}^{n} t_{ik} y_{kj}\n$$\n对于矩阵 $S$，$l > j$ 时有 $s_{lj} = 0$。因此，$(YS)_{ij}$ 的求和可以简化为在索引 $l=j$ 处结束：\n$$\n(YS)_{ij} = \\sum_{l=1}^{j} y_{il} s_{lj}\n$$\n\n将这些代回分量方程中，得到：\n$$\n\\sum_{k=i}^{n} t_{ik} y_{kj} + \\sum_{l=1}^{j} y_{il} s_{lj} = f_{ij}\n$$\n\n我们的目标是解出 $y_{ij}$。为此，我们必须从两个求和中分离出包含 $y_{ij}$ 的项。\n在第一个和 $\\sum_{k=i}^{n} t_{ik} y_{kj}$ 中，包含 $y_{ij}$ 的项在 $k=i$ 时出现。\n在第二个和 $\\sum_{l=1}^{j} y_{il} s_{lj}$ 中，包含 $y_{ij}$ 的项在 $l=j$ 时出现。\n\n让我们将这些项从各自的和中分离出来：\n$$\n\\left( t_{ii} y_{ij} + \\sum_{k=i+1}^{n} t_{ik} y_{kj} \\right) + \\left( \\sum_{l=1}^{j-1} y_{il} s_{lj} + y_{ij} s_{jj} \\right) = f_{ij}\n$$\n注意，当 $i=n$ 时，第一个和 $\\sum_{k=i+1}^{n}$ 为空；当 $j=1$ 时，第二个和 $\\sum_{l=1}^{j-1}$ 为空。\n\n现在，我们将含有 $y_{ij}$ 的项组合在左侧，并将所有其他项移到右侧：\n$$\nt_{ii} y_{ij} + y_{ij} s_{jj} = f_{ij} - \\sum_{k=i+1}^{n} t_{ik} y_{kj} - \\sum_{l=1}^{j-1} y_{il} s_{lj}\n$$\n提取公因子 $y_{ij}$：\n$$\n(t_{ii} + s_{jj}) y_{ij} = f_{ij} - \\sum_{k=i+1}^{n} t_{ik} y_{kj} - \\sum_{l=1}^{j-1} y_{il} s_{lj}\n$$\n如前所述，唯一解的条件确保了对所有有效的索引对 $(i,j)$ 都有 $t_{ii} + s_{jj} \\neq 0$。因此，我们可以除以这个因子，得到 $y_{ij}$ 的显式标量递推公式：\n$$\ny_{ij} = \\frac{1}{t_{ii} + s_{jj}} \\left( f_{ij} - \\sum_{k=i+1}^{n} t_{ik} y_{kj} - \\sum_{l=1}^{j-1} y_{il} s_{lj} \\right)\n$$\n\n### 第2部分：计算顺序\n\n第1部分推导出的递推公式显示了计算 $y_{ij}$ 的依赖关系：\n$y_{ij}$ 依赖于：\n1.  $T$、$S$ 和 $F$ 的元素。这些是已知的。\n2.  $k > i$ 时的元素 $y_{kj}$。这些是 $Y$ 中与 $y_{ij}$ 同列（第 $j$ 列）但在其下方（第 $i$ 行以下）的元素。\n3.  $l  j$ 时的元素 $y_{il}$。这些是 $Y$ 中与 $y_{ij}$ 同行（第 $i$ 行）但在其左侧（第 $j$ 列以左）的元素。\n\n为了确保一个有效的计算顺序，我们必须在计算完 $y_{ij}$ 所依赖的所有元素之后才能计算它。让我们分析一下依赖结构。要计算位置 $(i,j)$ 处的元素，我们需要同一列中其下方的所有元素，以及同一行中其左侧的所有元素。\n\n这表明需要一个能够满足这些依赖关系的顺序来遍历矩阵 $Y$。一个有效的顺序是逐列计算 $Y$ 的元素，从左到右，在每一列内，从下到上。\n\n提议的顺序如下：\n遍历列 $j$ 从 $1$ 到 $m$。对于每一列 $j$，遍历行 $i$ 从 $n$ 到 $1$。计算的索引 $(i,j)$ 序列将是 $(n,1), (n-1,1), \\dots, (1,1)$，然后是 $(n,2), (n-1,2), \\dots, (1,2)$，依此类推，直到 $(n,m), \\dots, (1,m)$。\n\n论证：当我们使用这个顺序计算 $y_{ij}$ 时：\n- 项 $\\sum_{k=i+1}^{n} t_{ik} y_{kj}$ 依赖于元素 $y_{(i+1)j}, \\dots, y_{nj}$。这些元素在同一列 $j$ 但在第 $i$ 行下方。由于我们是从 $n$ 向下迭代到 $1$ 来遍历行，这些元素在当前列的遍历中已经被计算出来了。\n- 项 $\\sum_{l=1}^{j-1} y_{il} s_{lj}$ 依赖于元素 $y_{i1}, \\dots, y_{i(j-1)}$。这些元素在同一行 $i$ 但在第 $j$ 列的左边。由于我们是从 $1$ 到 $m$ 遍历列，第 $1, \\dots, j-1$ 列中的所有元素都已经被完全计算出来了。\n\n因此，这个顺序保证了在计算 $y_{ij}$ 时，递推公式右侧所有需要的值都是已知的。另一种有效的顺序是遍历行 $i$ 从 $n$ 到 $1$，对于每一行，再遍历列 $j$ 从 $1$ 到 $m$。\n\n### 第3部分：计算 $y_{23}$\n\n给定矩阵：\n$$\nT=\\begin{pmatrix}\n2  1  -1\\\\\n0  3  2\\\\\n0  0  5\n\\end{pmatrix},\\quad\nS=\\begin{pmatrix}\n-1  2  0\\\\\n0  4  1\\\\\n0  0  6\n\\end{pmatrix},\\quad\nF=\\begin{pmatrix}\n1  0  2\\\\\n3  -1  1\\\\\n4  2  0\n\\end{pmatrix}\n$$\n我们需要求解 $y_{23}$。使用 $(i,j) = (2,3)$ 以及 $n=3, m=3$ 的公式：\n$$\ny_{23} = \\frac{1}{t_{22} + s_{33}} \\left( f_{23} - \\sum_{k=3}^{3} t_{2k} y_{k3} - \\sum_{l=1}^{2} y_{2l} s_{l3} \\right)\n$$\n$$\ny_{23} = \\frac{1}{t_{22} + s_{33}} \\left( f_{23} - t_{23}y_{33} - (y_{21}s_{13} + y_{22}s_{23}) \\right)\n$$\n这表明要计算 $y_{23}$，我们首先需要计算 $y_{33}$、$y_{21}$ 和 $y_{22}$。我们将遵循第2部分中的顺序来计算这些依赖项。\n\n1.  **计算 $y_{31}$：** 从列 $j=1$，行 $i=3$ 开始。\n    $y_{31} = \\frac{1}{t_{33}+s_{11}}(f_{31}) = \\frac{1}{5+(-1)}(4) = \\frac{4}{4} = 1$。\n\n2.  **计算 $y_{21}$：** 列 $j=1$，行 $i=2$。\n    $y_{21} = \\frac{1}{t_{22}+s_{11}}(f_{21} - t_{23}y_{31}) = \\frac{1}{3+(-1)}(3 - (2)(1)) = \\frac{1}{2}(1) = \\frac{1}{2}$。\n\n3.  **计算 $y_{32}$：** 列 $j=2$，行 $i=3$。\n    $y_{32} = \\frac{1}{t_{33}+s_{22}}(f_{32} - y_{31}s_{12}) = \\frac{1}{5+4}(2 - (1)(2)) = \\frac{1}{9}(0) = 0$。\n\n4.  **计算 $y_{22}$：** 列 $j=2$，行 $i=2$。\n    $y_{22} = \\frac{1}{t_{22}+s_{22}}(f_{22} - t_{23}y_{32} - y_{21}s_{12}) = \\frac{1}{3+4}(-1 - (2)(0) - (\\frac{1}{2})(2)) = \\frac{1}{7}(-1 - 1) = -\\frac{2}{7}$。\n\n5.  **计算 $y_{33}$：** 列 $j=3$，行 $i=3$。\n    $y_{33} = \\frac{1}{t_{33}+s_{33}}(f_{33} - (y_{31}s_{13} + y_{32}s_{23})) = \\frac{1}{5+6}(0 - ((1)(0) + (0)(1))) = \\frac{1}{11}(0) = 0$。\n\n6.  **最后，计算 $y_{23}$：** 列 $j=3$，行 $i=2$。\n    现在我们有了所有必要的值：\n    - $t_{22}=3, s_{33}=6$\n    - $f_{23}=1$\n    - $t_{23}=2$\n    - $s_{13}=0, s_{23}=1$\n    - $y_{33}=0$\n    - $y_{21}=1/2$\n    - $y_{22}=-2/7$\n\n    将这些值代入 $y_{23}$ 的公式中：\n    $$\n    y_{23} = \\frac{1}{3+6} \\left( 1 - (2)(0) - \\left( \\left(\\frac{1}{2}\\right)(0) + \\left(-\\frac{2}{7}\\right)(1) \\right) \\right)\n    $$\n    $$\n    y_{23} = \\frac{1}{9} \\left( 1 - 0 - \\left( 0 - \\frac{2}{7} \\right) \\right)\n    $$\n    $$\n    y_{23} = \\frac{1}{9} \\left( 1 + \\frac{2}{7} \\right)\n    $$\n    $$\n    y_{23} = \\frac{1}{9} \\left( \\frac{7}{7} + \\frac{2}{7} \\right)\n    $$\n    $$\n    y_{23} = \\frac{1}{9} \\left( \\frac{9}{7} \\right)\n    $$\n    $$\n    y_{23} = \\frac{1}{7}\n    $$\n元素 $y_{23}$ 的值为 $\\frac{1}{7}$。",
                "answer": "$$\\boxed{\\frac{1}{7}}$$",
                "id": "3584637"
            },
            {
                "introduction": "在理解了采用块回代的必要性之后，下一步是深入探究其具体实现。此练习通过一个精心设计的反例，有力地揭示了忽略块结构的朴素方法可能导致的数值灾难，从而凸显了 Bartels-Stewart 算法中块感知策略（block-aware strategy）对于维持数值稳定性的重要性。",
                "problem": "考虑西尔维斯特方程 $A X + X B = C$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是一个上三角矩阵，$B \\in \\mathbb{R}^{2 \\times 2}$ 是一个对应于复共轭特征对的实 $2 \\times 2$ 舒尔块。在 Bartels–Stewart 算法中，首先将矩阵化为实舒尔形式，然后通过块回代法求解得到的三角西尔维斯特方程，将 $2 \\times 2$ 的对角块视为原子主元。在本题中，您将构建一个反例，说明如果天真地将 $B$ 中的 $2 \\times 2$ 舒尔块视为两个独立的 $1 \\times 1$ 标量（即，忽略非对角耦合），会产生灾难性的放大效应，然后量化通过块感知主元法获得的改进。\n\n设\n$$\nA = \\begin{pmatrix}\n-1  1 \\\\\n0  -1\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n1 + \\delta  M \\\\\n- M  1 + \\delta\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n0  0 \\\\\n1  0\n\\end{pmatrix},\n$$\n其中参数 $M > 0$ 和 $0  \\delta \\ll 1$ 是固定的。注意，$B$ 是复数对 $1 + \\delta \\pm i M$ 的实舒尔形式。\n\n1. 仅使用关于西尔维斯特方程和谱的基本事实（即，$A X + X B = C$ 有唯一解当且仅当 $A$ 和 $-B$ 的谱不相交），证明对于所有 $M > 0$ 和 $\\delta > 0$，上述真实的西尔维斯特方程是唯一可解的。\n\n2. 定义一个忽略块的天真方案，用对角矩阵 $\\widetilde{B} = \\operatorname{diag}(1 + \\delta, 1 + \\delta)$ 替换 $B$，从而忽略 $2 \\times 2$ 舒尔块中的非对角耦合。在这个天真方案中，$X$ 的第二行解耦，并通过标量三角系统 $(A + (1 + \\delta) I) X_{:,j} = C_{:,j}$（对于 $j \\in \\{1,2\\}$）计算得出。计算得到的数对 $(x_{21}^{\\mathrm{naive}}, x_{22}^{\\mathrm{naive}})$ 及其欧几里得范数（用 $\\delta$ 和 $M$ 表示）。\n\n3. 在 Bartels–Stewart 算法所要求的正确的块感知主元法中，变量 $(x_{21}, x_{22})$ 是通过一个 $2 \\times 2$ 线性系统同时求解的，该系统是通过将方程 $A X + X B = C$ 限制在 $X$ 的第二行和 $B$ 的 $2 \\times 2$ 舒尔块上得到的。推导关于 $(x_{21}, x_{22})$ 的 $2 \\times 2$ 系统，显式求解它，并计算欧几里得范数 $\\| (x_{21}, x_{22}) \\|_{2}$（用 $\\delta$ 和 $M$ 表示）。\n\n4. 将改进因子定义为数对 $(x_{21}, x_{22})$ 的天真范数与块感知范数之比。用 $\\delta$ 和 $M$ 解析地表示这个比率，然后对具体数值 $\\delta = 10^{-6}$ 和 $M = 1$ 进行计算。将最终答案四舍五入到三位有效数字。将最终答案表示为一个无单位的实数。",
                "solution": "该问题要求分析一个特定的西尔维斯特方程 $A X + X B = C$，以说明 Bartels-Stewart 算法的一个关键稳定性特征。该分析涉及将一种天真的求解方法与正确的块感知方法进行比较。\n\n给定的矩阵和参数如下：\n$$\nA = \\begin{pmatrix}\n-1  1 \\\\\n0  -1\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n1 + \\delta  M \\\\\n- M  1 + \\delta\n\\end{pmatrix}, \\quad\nC = \\begin{pmatrix}\n0  0 \\\\\n1  0\n\\end{pmatrix},\n$$\n其中 $M > 0$ 且 $0  \\delta \\ll 1$。\n\n1. 唯一解的证明：\n西尔维斯特方程 $A X + X B = C$ 存在唯一解的充要条件是 $A$ 和 $-B$ 的谱（分别记为 $\\lambda(A)$ 和 $\\lambda(-B)$）不相交，即 $\\lambda(A) \\cap \\lambda(-B) = \\emptyset$。\n\n首先，我们确定 $A$ 的谱。由于 $A$ 是一个上三角矩阵，其特征值即为其对角线元素。\n$$ \\lambda(A) = \\{-1\\} $$\n接下来，我们求 $B$ 的谱。$B$ 的特征值是特征方程 $\\det(B - \\lambda I) = 0$ 的根。\n$$ \\det \\begin{pmatrix} 1 + \\delta - \\lambda  M \\\\ -M  1 + \\delta - \\lambda \\end{pmatrix} = (1 + \\delta - \\lambda)^2 + M^2 = 0 $$\n$$ (1 + \\delta - \\lambda)^2 = -M^2 $$\n$$ 1 + \\delta - \\lambda = \\pm i M $$\n$$ \\lambda = 1 + \\delta \\mp i M $$\n所以，$B$ 的谱是 $\\lambda(B) = \\{1 + \\delta + i M, 1 + \\delta - i M\\}$。\n\n$-B$ 的谱由 $B$ 的特征值的相反数组成。\n$$ \\lambda(-B) = \\{-(1 + \\delta + i M), -(1 + \\delta - i M)\\} = \\{-1 - \\delta - i M, -1 - \\delta + i M\\} $$\n为了检查谱 $\\lambda(A)$ 和 $\\lambda(-B)$ 是否不相交，我们将 $\\lambda(A)$ 中的唯一元素 $-1$ 与 $\\lambda(-B)$ 中的元素进行比较。如果 $-1$ 是 $\\lambda(-B)$ 的一个元素，那么我们会有 $-1 = -1 - \\delta \\pm i M$，化简后得到 $\\delta = \\pm i M$。这是一个矛盾，因为题目指定 $\\delta$ 和 $M$ 是正实数。因此，$-1 \\notin \\lambda(-B)$，谱是不相交的。这证实了西尔维斯特方程 $A X + X B = C$ 有唯一解。\n\n2. 忽略块的天真方案：\n在这个方案中，$B$ 被其对角部分 $\\widetilde{B} = \\operatorname{diag}(1 + \\delta, 1 + \\delta) = (1 + \\delta)I_{2}$ 近似，其中 $I_{2}$ 是 $2 \\times 2$ 的单位矩阵。西尔维斯特方程变为 $A X_{\\mathrm{naive}} + X_{\\mathrm{naive}}((1 + \\delta)I_{2}) = C$。提出 $X_{\\mathrm{naive}}$ 因子得到 $(A + (1 + \\delta)I_{2}) X_{\\mathrm{naive}} = C$。\n\n我们来计算矩阵 $A + (1+\\delta)I_{2}$：\n$$ A + (1+\\delta)I_{2} = \\begin{pmatrix} -1  1 \\\\ 0  -1 \\end{pmatrix} + \\begin{pmatrix} 1+\\delta  0 \\\\ 0  1+\\delta \\end{pmatrix} = \\begin{pmatrix} \\delta  1 \\\\ 0  \\delta \\end{pmatrix} $$\n需要求解的系统是：\n$$ \\begin{pmatrix} \\delta  1 \\\\ 0  \\delta \\end{pmatrix} \\begin{pmatrix} x_{11}  x_{12} \\\\ x_{21}  x_{22} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} $$\n题目要求我们求 $X_{\\mathrm{naive}}$ 的第二行，我们称之为 $(x_{21}^{\\mathrm{naive}}, x_{22}^{\\mathrm{naive}})$。该行由矩阵方程的第二行确定，该行与第一行解耦。对于第一列 $(j=1)$，方程为 $0 \\cdot x_{11} + \\delta \\cdot x_{21} = 1$，得到 $x_{21}^{\\mathrm{naive}} = \\frac{1}{\\delta}$。对于第二列 $(j=2)$，方程为 $0 \\cdot x_{12} + \\delta \\cdot x_{22} = 0$，得到 $x_{22}^{\\mathrm{naive}} = 0$。\n所以，第二行的天真解是 $(x_{21}^{\\mathrm{naive}}, x_{22}^{\\mathrm{naive}}) = (\\frac{1}{\\delta}, 0)$。\n\n该向量的欧几里得范数是：\n$$ \\|(x_{21}^{\\mathrm{naive}}, x_{22}^{\\mathrm{naive}})\\|_2 = \\sqrt{\\left(\\frac{1}{\\delta}\\right)^2 + 0^2} = \\frac{1}{\\delta} \\quad (\\text{因为 } \\delta > 0) $$\n\n3. 正确的块感知主元法：\nBartels-Stewart 算法使用基于 $A$ 的舒尔形式的块回代法来求解 $X$。在这里，我们可以按行对 $A$ 和 $X$ 进行分块。设 $X_1 = (x_{11}, x_{12})$ 和 $X_2 = (x_{21}, x_{22})$ 分别为 $X$ 的第一行和第二行。西尔维斯特方程 $AX+XB=C$ 可以写成关于 $X$ 的行的分块形式：\n$$ \\begin{pmatrix} -1  1 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix} + \\begin{pmatrix} X_1 \\\\ X_2 \\end{pmatrix} B = \\begin{pmatrix} C_1 \\\\ C_2 \\end{pmatrix} $$\n这展开为两个矩阵方程组：\n$$ -X_1 + X_2 + X_1 B = C_1 $$\n$$ -X_2 + X_2 B = C_2 $$\n第二个方程 $-X_2 + X_2 B = C_2$ 可以首先求解 $X_2$。其中 $X_2 = (x_{21}, x_{22})$，$C_2 = (1, 0)$（$C$ 的第二行），我们得到：\n$$ (x_{21}, x_{22})(B - I_2) = (1, 0) $$\n矩阵 $(B - I_2)$ 是：\n$$ B - I_2 = \\begin{pmatrix} 1 + \\delta  M \\\\ -M  1 + \\delta \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\delta  M \\\\ -M  \\delta \\end{pmatrix} $$\n关于 $(x_{21}, x_{22})$ 的方程是 $(x_{21}, x_{22}) \\begin{pmatrix} \\delta  M \\\\ -M  \\delta \\end{pmatrix} = (1, 0)$。这对应于 $2 \\times 2$ 的线性系统：\n$$ \\delta x_{21} - M x_{22} = 1 $$\n$$ M x_{21} + \\delta x_{22} = 0 $$\n从第二个方程，我们得到 $x_{21} = -\\frac{\\delta}{M} x_{22}$。将其代入第一个方程：\n$$ \\delta \\left(-\\frac{\\delta}{M} x_{22}\\right) - M x_{22} = 1 \\implies \\left(-\\frac{\\delta^2}{M} - M\\right) x_{22} = 1 $$\n$$ -\\frac{\\delta^2 + M^2}{M} x_{22} = 1 \\implies x_{22} = -\\frac{M}{\\delta^2 + M^2} $$\n代回以求得 $x_{21}$：\n$$ x_{21} = -\\frac{\\delta}{M} \\left(-\\frac{M}{\\delta^2 + M^2}\\right) = \\frac{\\delta}{\\delta^2 + M^2} $$\n第二行的正确解是 $(x_{21}, x_{22}) = \\left(\\frac{\\delta}{\\delta^2 + M^2}, -\\frac{M}{\\delta^2 + M^2}\\right)$。\n\n该向量的欧几里得范数是：\n$$ \\|(x_{21}, x_{22})\\|_2 = \\sqrt{\\left(\\frac{\\delta}{\\delta^2 + M^2}\\right)^2 + \\left(-\\frac{M}{\\delta^2 + M^2}\\right)^2} = \\sqrt{\\frac{\\delta^2 + M^2}{(\\delta^2 + M^2)^2}} = \\frac{1}{\\sqrt{\\delta^2 + M^2}} $$\n\n4. 改进因子：\n改进因子定义为天真范数与块感知范数之比。\n$$ \\text{比率} = \\frac{\\|(x_{21}^{\\mathrm{naive}}, x_{22}^{\\mathrm{naive}})\\|_2}{\\|(x_{21}, x_{22})\\|_2} = \\frac{1/\\delta}{1/\\sqrt{\\delta^2 + M^2}} = \\frac{\\sqrt{\\delta^2 + M^2}}{\\delta} $$\n对于具体数值 $\\delta = 10^{-6}$ 和 $M = 1$：\n$$ \\text{比率} = \\frac{\\sqrt{(10^{-6})^2 + 1^2}}{10^{-6}} = \\frac{\\sqrt{10^{-12} + 1}}{10^{-6}} $$\n$\\sqrt{1 + 10^{-12}}$ 的值非常接近 1。计算得出：\n$$ \\text{比率} \\approx \\frac{1.0000000000005}{10^{-6}} = 1000000.0000005 $$\n将此结果四舍五入到三位有效数字，得到 $1.00 \\times 10^6$。",
                "answer": "$$\\boxed{1.00 \\times 10^{6}}$$",
                "id": "3584620"
            },
            {
                "introduction": "在理解了采用块回代的必要性之后，下一步是深入探究其具体实现。此练习将指导你推导在块回代过程中出现的各种小型局部西尔维斯特方程的显式解。通过分析 $1 \\times 1$ 和 $2 \\times 2$ 块之间的相互作用，你将推导出相应的局部线性系统，并利用克罗内克积（Kronecker product）来分析 $2 \\times 2$ 块情形下的奇异性条件，从而将算法的稳定性与矩阵的谱特性直接联系起来。",
                "problem": "考虑 Sylvester 方程 $A X + X B = C$，其中 $A, B \\in \\mathbb{R}^{n \\times n}$ 且 $C \\in \\mathbb{R}^{n \\times n}$。Bartels–Stewart 算法 (BSA) 将 $A$ 和 $B$ 化为实 Schur 形式，$T_A = Q_A^{\\mathsf{T}} A Q_A$ 和 $T_B = Q_B^{\\mathsf{T}} B Q_B$，其中 $Q_A, Q_B$ 是正交矩阵，$T_A, T_B$ 是准上三角矩阵，即对角块大小为 $1\\times 1$ 或 $2\\times 2$ 的分块上三角矩阵。然后，该算法通过对这些 $1\\times 1$ 和 $2\\times 2$ 的对角块进行分块回代来求解 $T_A Y + Y T_B = \\widehat{C}$，其中 $\\widehat{C} = Q_A^{\\mathsf{T}} C Q_B$。\n\n从以上定义以及关于向量化和克罗内克积的基本事实出发，推导当 $T_A$ 和 $T_B$ 具有 $1\\times 1$ 和 $2\\times 2$ 对角块时出现的显式局部三角 Sylvester 求解问题，并描述 $2\\times 2$ 块产生近奇异局部子问题的条件。\n\n具体来说：\n\n首先，推导当 $T_A$ 的一个 $1\\times 1$ 块 $[a]$ 与 $T_B$ 的一个 $1\\times 1$ 块 $[b]$ 相互作用时的标量局部求解，并用 $a$、$b$ 和 $c$ 表示解 $x$。\n\n其次，推导当 $T_A$ 的一个 $2\\times 2$ 块 $A_2$ 与 $T_B$ 的一个 $1\\times 1$ 块 $[b]$ 相互作用时的显式 $2\\times 1$ 局部求解，即对于 $A_2 X + X b = C$ (其中 $X, C \\in \\mathbb{R}^{2\\times 1}$)，并类似地推导当 $T_A$ 的一个 $1\\times 1$ 块 $[a]$ 与 $T_B$ 的一个 $2\\times 2$ 块 $B_2$ 相互作用时的显式 $1\\times 2$ 局部求解，即对于 $a X + X B_2 = C$ (其中 $X, C \\in \\mathbb{R}^{1\\times 2}$)。\n\n然后，考虑两个相互作用的对角块都是 $2\\times 2$ 的实 Schur 块 $A_2$ 和 $B_2$ 的情况，它们分别代表复共轭特征对 $\\alpha \\pm i \\beta$ 和 $\\gamma \\pm i \\delta$，其中 $\\beta > 0$ 且 $\\delta > 0$。使用向量化恒等式和克罗内克和的性质，写出向量化的局部 Sylvester 子问题 $A_2 X + X B_2 = C$ 的 $4\\times 4$ 系数矩阵，并计算其行列式的封闭形式表达式，作为 $\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 的函数。基于此表达式，陈述使该 $4\\times 4$ 局部系统近奇异的精确谱条件。\n\n最后，当 $\\alpha = 1.13$, $\\beta = 0.92$, $\\gamma = -1.08$, $\\delta = 0.89$ 时，计算你得到的行列式封闭形式表达式的值。将最终数值答案四舍五入至 4 位有效数字。仅报告行列式的值，不要包含单位。",
                "solution": "该问题要求推导在求解 Sylvester 方程 $A X + X B = C$ 的 Bartels-Stewart 算法中出现的局部子问题，分析它们的奇异性，并进行一次特定的数值计算。该问题定义明确，在数值线性代数领域有坚实的科学基础，并且提供了所有必要的信息。我们开始求解。\n\nBartels-Stewart 算法的核心是将原始的 Sylvester 方程转换为一个结构上更简单的方程。给定 $A X + X B = C$，我们计算实 Schur 分解 $A = Q_A T_A Q_A^{\\mathsf{T}}$ 和 $B = Q_B T_B Q_B^{\\mathsf{T}}$，其中 $Q_A$ 和 $Q_B$ 是正交矩阵，$T_A$ 和 $T_B$ 是准上三角矩阵（实 Schur 形式）。将这些代入 Sylvester 方程得到：\n$$(Q_A T_A Q_A^{\\mathsf{T}}) X + X (Q_B T_B Q_B^{\\mathsf{T}}) = C$$\n在左侧乘以 $Q_A^{\\mathsf{T}}$，右侧乘以 $Q_B$ 得到：\n$$Q_A^{\\mathsf{T}} (Q_A T_A Q_A^{\\mathsf{T}}) X Q_B + Q_A^{\\mathsf{T}} X (Q_B T_B Q_B^{\\mathsf{T}}) Q_B = Q_A^{\\mathsf{T}} C Q_B$$\n使用 $Q_A^{\\mathsf{T}} Q_A = I$ 和 $Q_B^{\\mathsf{T}} Q_B = I$，并定义 $Y = Q_A^{\\mathsf{T}} X Q_B$ 和 $\\widehat{C} = Q_A^{\\mathsf{T}} C Q_B$，我们得到变换后的 Sylvester 方程：\n$$T_A Y + Y T_B = \\widehat{C}$$\n由于 $T_A$ 和 $T_B$ 是准上三角矩阵，该系统可以通过分块回代过程求解 $Y$ 的各个块。我们现在分析在此回代过程的每一步中必须求解的局部线性系统。\n\n设 $T_A = (T_{A,ij})$ 和 $T_B = (T_{B,ij})$ 与 $Y=(Y_{ij})$ 和 $\\widehat{C}=(\\widehat{C}_{ij})$ 进行共形分块，其中对角块 $T_{A,ii}$ 和 $T_{B,jj}$ 的大小为 $1 \\times 1$ 或 $2 \\times 2$。第 $(i,j)$ 个块方程是：\n$$T_{A,ii} Y_{ij} + Y_{ij} T_{B,jj} = \\widehat{C}_{ij} - \\sum_{k=i+1}^{p} T_{A,ik} Y_{kj} - \\sum_{l=1}^{j-1} Y_{il} T_{B,lj}$$\nBartels-Stewart 算法按照 $i=p, \\dots, 1$ 和 $j=1, \\dots, q$（或其他顺序）求解 $Y_{ij}$。在每一步中，右侧是已知的，我们必须为 $Y_{ij}$ 求解一个小的 Sylvester 方程。我们现在推导这些局部求解的显式形式。\n\n首先，考虑 $T_A$ 的一个 $1 \\times 1$ 对角块 $T_{A,ii} = [a]$ 与 $T_B$ 的一个 $1 \\times 1$ 对角块 $T_{B,jj} = [b]$ 相互作用的情况。未知数 $Y_{ij}$ 是一个标量 $x$，右侧是一个标量 $c$。局部方程为：\n$$[a] [x] + [x] [b] = [c]$$\n这是一个标量方程 $a x + x b = c$，即 $(a+b)x = c$。解为：\n$$x = \\frac{c}{a+b}$$\n只要 $a+b \\neq 0$，此解就是唯一的。这个条件对应于 $\\lambda_i(A) + \\lambda_j(B) \\neq 0$，其中 $\\lambda_i(A)=a$ 和 $\\lambda_j(B)=b$ 分别是 $A$ 和 $B$ 的实特征值。\n\n接下来，我们推导当 $T_A$ 的一个 $2 \\times 2$ 块 $T_{A,ii} = A_2$ 与 $T_B$ 的一个 $1 \\times 1$ 块 $T_{B,jj} = [b]$ 相互作用时的 $2 \\times 1$ 局部求解。这里，未知数 $Y_{ij} = X$ 是一个 $2 \\times 1$ 列向量，右侧 $\\widehat{C}_{ij}' = C$ 也是一个 $2 \\times 1$ 向量。局部方程为：\n$$A_2 X + X b = C$$\n由于 $b$ 是一个标量，$Xb = bX$。方程可以重写为：\n$$A_2 X + b X = C \\implies (A_2 + b I) X = C$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。这是一个关于未知向量 $X$ 的 $2 \\times 2$ 线性系统。设 $A_2 = \\begin{pmatrix} a_{11}  a_{12} \\\\ a_{21}  a_{22} \\end{pmatrix}$，$X = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 和 $C = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。该系统显式地写为：\n$$\\begin{pmatrix} a_{11}+b  a_{12} \\\\ a_{21}  a_{22}+b \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$$\n如果矩阵 $A_2+bI$ 是非奇异的，这个系统就有唯一解，而这当 $-b$ 不是 $A_2$ 的特征值时成立。\n\n类似地，我们推导当 $T_A$ 的一个 $1 \\times 1$ 块 $[a]$ 与 $T_B$ 的一个 $2 \\times 2$ 块 $B_2$ 相互作用时的 $1 \\times 2$ 局部求解。设 $Y_{ij}=X \\in \\mathbb{R}^{1 \\times 2}$ 和 $\\widehat{C}_{ij}'=C \\in \\mathbb{R}^{1 \\times 2}$。方程为：\n$$a X + X B_2 = C$$\n设 $X = \\begin{pmatrix} x_1  x_2 \\end{pmatrix}$，$B_2 = \\begin{pmatrix} b_{11}  b_{12} \\\\ b_{21}  b_{22} \\end{pmatrix}$ 和 $C = \\begin{pmatrix} c_1  c_2 \\end{pmatrix}$。方程展开为：\n$$a \\begin{pmatrix} x_1  x_2 \\end{pmatrix} + \\begin{pmatrix} x_1  x_2 \\end{pmatrix} \\begin{pmatrix} b_{11}  b_{12} \\\\ b_{21}  b_{22} \\end{pmatrix} = \\begin{pmatrix} c_1  c_2 \\end{pmatrix}$$\n$$\\begin{pmatrix} ax_1 + x_1 b_{11} + x_2 b_{21}  ax_2 + x_1 b_{12} + x_2 b_{22} \\end{pmatrix} = \\begin{pmatrix} c_1  c_2 \\end{pmatrix}$$\n这产生了一个关于两个变量 $x_1, x_2$ 的线性方程组：\n$$\\begin{cases} (a+b_{11}) x_1 + b_{21} x_2 = c_1 \\\\ b_{12} x_1 + (a+b_{22}) x_2 = c_2 \\end{cases}$$\n这可以写成矩阵形式：\n$$\\begin{pmatrix} a+b_{11}  b_{21} \\\\ b_{12}  a+b_{22} \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$$\n系数矩阵是 $aI + B_2^{\\mathsf{T}}$。如果 $aI+B_2^{\\mathsf{T}}$ 是非奇异的，即如果 $-a$ 不是 $B_2^{\\mathsf{T}}$（也就是 $B_2$）的特征值，则该系统有唯一解。\n\n现在，我们考虑两个相互作用的块都是 $2 \\times 2$ 的情况。设局部方程为 $A_2 X + X B_2 = C$，其中 $A_2, B_2, X, C \\in \\mathbb{R}^{2 \\times 2}$。块 $A_2$ 代表一对复共轭特征值 $\\alpha \\pm i \\beta$（$\\beta > 0$），而 $B_2$ 代表一对特征值 $\\gamma \\pm i \\delta$（$\\delta > 0$）。我们使用向量化算子 $\\text{vec}(\\cdot)$ 和克罗内克积 $\\otimes$。方程可以向量化为：\n$$\\text{vec}(A_2 X) + \\text{vec}(X B_2) = \\text{vec}(C)$$\n使用恒等式 $\\text{vec}(PQR) = (R^{\\mathsf{T}} \\otimes P) \\text{vec}(Q)$，我们有：\n$$(I \\otimes A_2) \\text{vec}(X) + (B_2^{\\mathsf{T}} \\otimes I) \\text{vec}(X) = \\text{vec}(C)$$\n这是一个关于 $\\text{vec}(X)$ 的 $4 \\times 4$ 线性系统：\n$$(I \\otimes A_2 + B_2^{\\mathsf{T}} \\otimes I) \\text{vec}(X) = \\text{vec}(C)$$\n$4 \\times 4$ 的系数矩阵是克罗内克和 $K = A_2 \\oplus B_2^{\\mathsf{T}}$。对于一个具有特征值 $\\lambda \\pm i\\mu$ ($\\mu \\neq 0$) 的矩阵，其标准实 Schur 形式是 $\\begin{pmatrix} \\lambda  \\mu \\\\ -\\mu  \\lambda \\end{pmatrix}$。不失一般性，我们设 $A_2 = \\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix}$ 和 $B_2 = \\begin{pmatrix} \\gamma  \\delta \\\\ -\\delta  \\gamma \\end{pmatrix}$。那么 $B_2^{\\mathsf{T}} = \\begin{pmatrix} \\gamma  -\\delta \\\\ \\delta  \\gamma \\end{pmatrix}$。系数矩阵显式地为：\n$$K = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\otimes \\begin{pmatrix} \\alpha  \\beta \\\\ -\\beta  \\alpha \\end{pmatrix} + \\begin{pmatrix} \\gamma  -\\delta \\\\ \\delta  \\gamma \\end{pmatrix} \\otimes \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\alpha+\\gamma  \\beta  -\\delta  0 \\\\ -\\beta  \\alpha+\\gamma  0  -\\delta \\\\ \\delta  0  \\alpha+\\gamma  \\beta \\\\ 0  \\delta  -\\beta  \\alpha+\\gamma \\end{pmatrix}$$\n克罗内克和的行列式是其所有特征值的乘积。$K = A_2 \\oplus B_2^{\\mathsf{T}}$ 的特征值是 $A_2$ 的特征值与 $B_2^{\\mathsf{T}}$ 的特征值的所有可能组合的和。$A_2$ 的特征值是 $\\lambda(A_2) = \\{\\alpha+i\\beta, \\alpha-i\\beta\\}$。$B_2^{\\mathsf{T}}$ 的特征值与 $B_2$ 相同，所以 $\\lambda(B_2^{\\mathsf{T}}) = \\{\\gamma+i\\delta, \\gamma-i\\delta\\}$。\n$K$ 的四个特征值是：\n$k_1 = (\\alpha+i\\beta) + (\\gamma+i\\delta) = (\\alpha+\\gamma) + i(\\beta+\\delta)$\n$k_2 = (\\alpha+i\\beta) + (\\gamma-i\\delta) = (\\alpha+\\gamma) + i(\\beta-\\delta)$\n$k_3 = (\\alpha-i\\beta) + (\\gamma+i\\delta) = (\\alpha+\\gamma) - i(\\beta-\\delta)$\n$k_4 = (\\alpha-i\\beta) + (\\gamma-i\\delta) = (\\alpha+\\gamma) - i(\\beta+\\delta)$\n行列式是这些特征值的乘积。将复共轭对配对（$k_1$ 与 $k_4$，$k_2$ 与 $k_3$）：\n$\\det(K) = k_1 k_4 \\cdot k_2 k_3 = (k_1 \\bar{k_1}) \\cdot (k_2 \\bar{k_2})$\n$\\det(K) = (|(\\alpha+\\gamma) + i(\\beta+\\delta)|^2) \\cdot (|(\\alpha+\\gamma) + i(\\beta-\\delta)|^2)$\n$\\det(K) = ((\\alpha+\\gamma)^2 + (\\beta+\\delta)^2) ((\\alpha+\\gamma)^2 + (\\beta-\\delta)^2)$\n这就是行列式的封闭形式表达式。\n\n如果 $\\det(K) = 0$，则局部系统是奇异的。由于 $\\alpha, \\beta, \\gamma, \\delta$ 是实数且 $\\beta>0, \\delta>0$，第一个因子 $(\\alpha+\\gamma)^2 + (\\beta+\\delta)^2$ 总是正的（因为 $\\beta+\\delta > 0$）。因此，奇异性当且仅当第二个因子为零时发生：\n$$(\\alpha+\\gamma)^2 + (\\beta-\\delta)^2 = 0$$\n这当且仅当 $\\alpha+\\gamma = 0$ 且 $\\beta-\\delta = 0$ 时成立。因此，奇异性的谱条件是 $\\alpha = -\\gamma$ 且 $\\beta = \\delta$。这意味着 $A_2$ 的一个特征值对 $\\alpha \\pm i\\beta$ 是 $B_2$ 的一个特征值对的负数，即 $-(\\gamma \\pm i\\delta) = \\alpha \\mp i\\beta$。\n当行列式接近于零时，系统是近奇异的。这在 $(\\alpha+\\gamma)^2 + (\\beta-\\delta)^2 \\approx 0$ 时发生，这意味着谱条件近似满足：$\\alpha \\approx -\\gamma$ 且 $\\beta \\approx \\delta$。\n\n最后，我们用给定的值计算行列式：$\\alpha = 1.13$，$\\beta = 0.92$，$\\gamma = -1.08$，$\\delta = 0.89$。\n我们计算中间项：\n$\\alpha+\\gamma = 1.13 + (-1.08) = 0.05$\n$\\beta+\\delta = 0.92 + 0.89 = 1.81$\n$\\beta-\\delta = 0.92 - 0.89 = 0.03$\n将这些代入行列式公式：\n$\\det(K) = ((0.05)^2 + (1.81)^2) ((0.05)^2 + (0.03)^2)$\n$\\det(K) = (0.0025 + 3.2761) (0.0025 + 0.0009)$\n$\\det(K) = (3.2786) (0.0034)$\n$\\det(K) = 0.01114724$\n按要求四舍五入到 4 位有效数字：\n$\\det(K) \\approx 0.01115$。",
                "answer": "$$\n\\boxed{0.01115}\n$$",
                "id": "3584711"
            }
        ]
    }