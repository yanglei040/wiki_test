{
        "hands_on_practices": [
            {
                "introduction": "此练习将探讨计算矩阵符号函数最广泛使用的一种算法：牛顿迭代法。您不仅将从第一性原理出发推导出这个优雅的公式，还将分析其强大的二次收敛性，从而深入理解其高效工作的原因。此外，您将解决一个实际的优化问题，以找到最佳的初始缩放参数，这是在实际应用中加速收敛的关键技术。[@problem_id:3591965]",
                "problem": "设 $A \\in \\mathbb{C}^{n \\times n}$ 是一个可对角化的矩阵，其谱 $\\sigma(A)$ 与虚轴 $i \\mathbb{R}$不相交。考虑用于矩阵符号函数的牛顿迭代\n$$\nX_{k+1} \\;=\\; \\frac{1}{2}\\big(X_k + X_k^{-1}\\big), \\qquad X_0 \\;=\\; \\alpha^{-1} A,\n$$\n其中 $\\alpha \\in \\mathbb{R}_{>0}$ 是一个待选的缩放参数。矩阵 $A$ 的矩阵符号函数定义为 $\\,\\mathrm{sign}(A) = A\\,(A^2)^{-1/2}$，其中 $(A^2)^{-1/2}$ 表示主逆平方根。\n\n1) 从“矩阵方程的牛顿法是通过在每一步中线性化残差并求解线性化校正量得到的”这一事实出发，推导上述迭代作为应用于方程 $X^2 = I$ 的牛顿法。使用可对角化矩阵的谱映射定理和全纯函数演算，证明当 $X_0$ 是 $A$ 的有理函数时，每个迭代项 $X_k$ 仍然是 $A$ 的有理函数，因此与 $A$ 交换。\n\n2) 使用标量牛顿迭代 $z \\mapsto \\phi(z) = \\tfrac{1}{2}(z + z^{-1})$作为在特征值上诱导的迭代，分析 $X_k$ 到 $\\mathrm{sign}(A)$ 的收敛性。特别地，从第一性原理出发，论证如果 $A = V \\Lambda V^{-1}$ 且 $\\Lambda = \\mathrm{diag}(\\lambda_1,\\dots,\\lambda_n)$，并且 $z_{0,i} = \\alpha^{-1}\\lambda_i$ 对所有 $i$ 满足 $z_{0,i} \\notin i\\mathbb{R}$，则 $z_{k,i}$ 以二次收敛率收敛到 $s_i \\in \\{+1,-1\\}$，其中 $s_i = \\mathrm{sign}(\\lambda_i)$ 的意义是 $s_i = \\lambda_i/\\sqrt{\\lambda_i^2}$ (使用主平方根)。\n\n3) 为加速收敛，通常选择 $\\alpha$ 使得初始残差 $X_0^2 - I$ 尽可能小。考虑特殊情况，即 $A$ 是埃尔米特矩阵和非奇异矩阵，其特征值包含在 $[-M,-m] \\cup [m,M]$ 中，其中 $0  m \\le M$ 为实数。仅使用正规矩阵的矩阵 2-范数的性质以及紧区间上极值的性质，确定在 $\\alpha  0$ 的范围内使谱范数 $\\|X_0^2 - I\\|_2$ 最小化的 $\\alpha$ 值。将你的最终答案表示为仅含 $m$ 和 $M$ 的闭式解析表达式。\n\n你的最终答案必须是这个最小化的 $\\alpha$，写成单一的解析表达式。最终答案中不要包含任何不等式或方程。",
                "solution": "所述问题是有效的。它在数值线性代数方面有科学依据，问题提法得当，目标明确，并为得到唯一解提供了所有必要信息。我们可以进行推导和分析。\n\n问题分为三个部分。我们将依次解决每个部分。\n\n**第 1 部分：牛顿迭代的推导和交换性**\n\n我们被要求将迭代 $X_{k+1} = \\frac{1}{2}(X_k + X_k^{-1})$ 推导为应用于矩阵方程 $X^2 = I$ 的牛顿法。设函数为 $F(X) = X^2 - I$。我们寻求 $F(X) = 0$ 的一个根。\n\n矩阵函数 $F(X)$ 的牛顿法通过更新规则 $X_{k+1} = X_k + E_k$ 生成一个近似序列 $X_k$，其中校正项 $E_k$ 是线性化方程 $F(X_k) + DF_{X_k}(E_k) = 0$ 的解。这里，$DF_{X_k}(E_k)$ 是 $F$ 在 $X_k$ 处作用于增量 $E_k$ 的 Fréchet 导数。\n\n我们来计算 $F(X) = X^2-I$ 的 Fréchet 导数。根据定义，\n$$\nF(X+E) = (X+E)^2 - I = X^2 + XE + EX + E^2 - I\n$$\nFréchet 导数是 $F(X+E) - F(X)$ 关于 $E$ 的线性部分。\n$$\nF(X+E) - F(X) = (X^2 + XE + EX + E^2 - I) - (X^2 - I) = XE + EX + E^2\n$$\n关于 $E$ 的线性项是 $DF_X(E) = XE + EX$。因此，牛顿更新步骤需要求解以下方程中的 $E_k$：\n$$\nF(X_k) + DF_{X_k}(E_k) = 0 \\implies (X_k^2 - I) + (X_k E_k + E_k X_k) = 0\n$$\n这是关于校正项 $E_k$ 的一个 Sylvester 方程：\n$$\nX_k E_k + E_k X_k = I - X_k^2\n$$\n求解这个一般的 Sylvester 方程在计算上可能很耗时。然而，问题中给出的迭代 $X_{k+1} = \\frac{1}{2}(X_k + X_k^{-1})$ 对应于 $X_{k+1}$ 的一个特定选择。让我们根据这个给定的迭代来定义校正项 $E_k$：\n$$\nE_k = X_{k+1} - X_k = \\frac{1}{2}(X_k + X_k^{-1}) - X_k = \\frac{1}{2}(X_k^{-1} - X_k)\n$$\n我们现在验证这个 $E_k$ 是否满足 Sylvester 方程：\n$$\nX_k E_k + E_k X_k = X_k \\left(\\frac{1}{2}(X_k^{-1} - X_k)\\right) + \\left(\\frac{1}{2}(X_k^{-1} - X_k)\\right) X_k\n$$\n$$\n= \\frac{1}{2}(X_k X_k^{-1} - X_k^2) + \\frac{1}{2}(X_k^{-1}X_k - X_k^2) = \\frac{1}{2}(I - X_k^2) + \\frac{1}{2}(I - X_k^2) = I - X_k^2\n$$\n这正是 Sylvester 方程的右边。因此，迭代 $X_{k+1} = \\frac{1}{2}(X_k + X_k^{-1})$ 确实是求解 $X^2=I$ 的牛顿法的一个实例。这种简化的校正项 $E_k$ 和更新形式是可能的，因为所有的迭代项 $X_k$ 彼此交换，我们现在将证明这一点。\n\n接下来，我们证明如果 $X_0$ 是 $A$ 的一个有理函数，那么每个迭代项 $X_k$ 也都是 $A$ 的有理函数，并与 $A$ 交换。我们用归纳法来证明。\n基础情况是 $k=0$。给定 $X_0 = \\alpha^{-1} A$。这是 $A$ 的一个多项式（因此也是一个有理函数），我们设 $X_0 = r_0(A)$，其中 $r_0(z) = \\alpha^{-1}z$。\n归纳假设是 $X_k = r_k(A)$，其中 $r_k(z)$ 是某个有理函数。\n下一个迭代项是 $X_{k+1} = \\frac{1}{2}(X_k + X_k^{-1})$。代入假设，我们得到：\n$$\nX_{k+1} = \\frac{1}{2}\\big(r_k(A) + (r_k(A))^{-1}\\big)\n$$\n由于 $A$ 是可对角化的，其最小多项式有不同的根，并且全纯函数演算（或其对可对角化矩阵的简化版本）适用。这意味着如果 $f$ 是在 $A$ 的谱的邻域上全纯的函数，那么 $f(A)$ 是良定义的。在这里，函数是求逆，即 $f(z)=z^{-1}$。为了使 $(r_k(A))^{-1}$ 是 $A$ 的一个有理函数，矩阵 $r_k(A)$ 必须是可逆的。我们将在第 2 部分中看到，在给定条件下，$X_k$ 的特征值永远不为零，因此 $X_k$ 总是可逆的。函数演算告诉我们 $(r_k(A))^{-1}$ 由 $q_k(A)$ 给出，其中 $q_k(z) = 1/r_k(z)$。由于 $r_k(z)$ 是一个有理函数，所以 $q_k(z)$ 也是。\n因此，$X_{k+1} = r_{k+1}(A)$，其中 $r_{k+1}(z) = \\frac{1}{2}(r_k(z) + 1/r_k(z))$ 也是一个有理函数。\n根据归纳法，每个迭代项 $X_k$ 都是 $A$ 的一个有理函数。\n任何作为 $A$ 的有理函数的矩阵都可以表示为 $p(A)q(A)^{-1}$，其中 $p, q$ 是多项式。由于 $A$ 的多项式与 $A$ 交换，因此 $A$ 的任何有理函数都与 $A$ 交换。因此，对所有 $k \\geq 0$ 都有 $A X_k = X_k A$。\n\n**第 2 部分：收敛性分析**\n\n给定 $A$ 是可对角化的，$A = V\\Lambda V^{-1}$，其中 $\\Lambda = \\mathrm{diag}(\\lambda_1, \\dots, \\lambda_n)$。其谱 $\\sigma(A) = \\{\\lambda_1, \\dots, \\lambda_n\\}$ 与虚轴 $i\\mathbb{R}$ 不相交，这意味着对所有 $i$ 都有 $\\mathrm{Re}(\\lambda_i) \\neq 0$。\n初始矩阵是 $X_0 = \\alpha^{-1}A = V(\\alpha^{-1}\\Lambda)V^{-1}$。\n由于每个 $X_k$ 都是 $A$ 的有理函数，它与 $A$ 共同可对角化。我们可以写出 $X_k = V \\Lambda_k V^{-1}$，其中 $\\Lambda_k = \\mathrm{diag}(z_{k,1}, \\dots, z_{k,n})$ 包含 $X_k$ 的特征值。\n矩阵迭代 $X_{k+1} = \\frac{1}{2}(X_k + X_k^{-1})$ 转变为对角特征值矩阵上的迭代：\n$$\nV\\Lambda_{k+1}V^{-1} = \\frac{1}{2}\\left(V\\Lambda_k V^{-1} + (V\\Lambda_k V^{-1})^{-1}\\right) = V \\left(\\frac{1}{2}(\\Lambda_k + \\Lambda_k^{-1})\\right) V^{-1}\n$$\n这意味着 $\\Lambda_{k+1} = \\frac{1}{2}(\\Lambda_k + \\Lambda_k^{-1})$，它解耦为 $n$ 个独立的关于特征值的标量迭代：\n$$\nz_{k+1,i} = \\frac{1}{2}(z_{k,i} + z_{k,i}^{-1}) = \\phi(z_{k,i})\n$$\n初始值为 $z_{0,i} = \\alpha^{-1}\\lambda_i$。由于 $\\alpha \\in \\mathbb{R}_{0}$ 且 $\\lambda_i \\notin i\\mathbb{R}$，我们有 $z_{0,i} \\notin i\\mathbb{R}$，所以 $\\mathrm{Re}(z_{0,i}) \\neq 0$。\n\n我们来分析标量映射 $\\phi(z) = \\frac{1}{2}(z+z^{-1})$。不动点由 $z = \\phi(z)$ 给出，这导致 $z = \\frac{1}{2}(z+z^{-1}) \\implies 2z=z+z^{-1} \\implies z=z^{-1} \\implies z^2 = 1$。不动点是 $z=+1$ 和 $z=-1$。\n\n考虑迭代项的实部。如果 $z_k = x+iy$，那么 $\\mathrm{Re}(\\phi(z_k)) = \\frac{1}{2}(x + \\frac{x}{x^2+y^2})$。如果 $x  0$，则 $\\mathrm{Re}(\\phi(z_k))  0$。如果 $x  0$，则 $\\mathrm{Re}(\\phi(z_k))  0$。这意味着如果一个迭代项 $z_{k,i}$ 位于开放右半平面，所有后续迭代项都将保留在那里。左半平面同理。由于 $\\mathrm{Re}(z_{0,i}) \\neq 0$，序列 $\\{z_{k,i}\\}_{k=0}^\\infty$ 被限制在右半平面或左半平面。\n\n如果 $\\mathrm{Re}(z_{0,i})  0$，序列 $\\{z_{k,i}\\}$ 收敛到右半平面中唯一的不动点，即 $+1$。\n如果 $\\mathrm{Re}(z_{0,i})  0$，序列 $\\{z_{k,i}\\}$ 收敛到左半平面中唯一的不动点，即 $-1$。\n\n$\\mathrm{Re}(z_{0,i})=\\alpha^{-1}\\mathrm{Re}(\\lambda_i)$ 的符号与 $\\mathrm{Re}(\\lambda_i)$ 的符号相同。所以，如果 $\\mathrm{Re}(\\lambda_i)  0$，则 $z_{k,i} \\to +1$；如果 $\\mathrm{Re}(\\lambda_i)  0$，则 $z_{k,i} \\to -1$。这个极限正是 $\\mathrm{sign}(\\lambda_i) = \\lambda_i/\\sqrt{\\lambda_i^2}$（使用平方根的主支）。我们称这个极限为 $s_i$。\n当 $k \\to \\infty$ 时，$\\Lambda_k \\to \\mathrm{diag}(s_1, \\dots, s_n) = \\mathrm{sign}(\\Lambda)$。因此，$X_k = V\\Lambda_k V^{-1} \\to V\\,\\mathrm{sign}(\\Lambda)V^{-1} = \\mathrm{sign}(A)$。\n\n为了分析收敛率，我们来考察误差。对于收敛到 $+1$ 的情况，考虑误差 $e_{k,i} = z_{k,i} - 1$。\n$$\ne_{k+1,i} = z_{k+1,i} - 1 = \\frac{1}{2}(z_{k,i} + z_{k,i}^{-1}) - 1 = \\frac{z_{k,i}^2 - 2z_{k,i} + 1}{2z_{k,i}} = \\frac{(z_{k,i}-1)^2}{2z_{k,i}} = \\frac{e_{k,i}^2}{2(1+e_{k,i})}\n$$\n当 $k \\to \\infty$ 时，$z_{k,i} \\to 1$ 且 $e_{k,i} \\to 0$。误差传播为 $|e_{k+1,i}| \\approx \\frac{1}{2}|e_{k,i}|^2$，这表明是二次收敛。对收敛到 $-1$ 的情况进行类似分析，误差为 $e_{k,i} = z_{k,i} - (-1)$，得到 $e_{k+1,i}=\\frac{e_{k,i}^2}{2(e_{k,i}-1)}$，所以 $|e_{k+1,i}| \\approx \\frac{1}{2}|e_{k,i}|^2$，也是二次收敛。\n\n**第 3 部分：最优缩放参数**\n\n我们想要找到 $\\alpha \\in \\mathbb{R}_{0}$ 来最小化 $\\|X_0^2 - I\\|_2$。我们有 $X_0 = \\alpha^{-1}A$。要最小化的量是 $\\|\\alpha^{-2}A^2 - I\\|_2$。\n矩阵 $A$ 是埃尔米特矩阵，所以它的特征值是实数，并且 $A$ 是一个正规矩阵。矩阵 $B = \\alpha^{-2}A^2 - I$ 也是正规的（实际上是埃尔米特矩阵，因为 $A^2$ 是埃尔米特矩阵且 $\\alpha$ 是实数）。对于一个正规矩阵 $B$，其 2-范数等于其谱半径：$\\|B\\|_2 = \\rho(B) = \\max_{\\mu \\in \\sigma(B)} |\\mu|$。\n\n$A$ 的特征值是 $\\lambda_i$，它们包含在集合 $[-M, -m] \\cup [m, M]$ 中，其中 $0  m \\le M$。\n$A^2$ 的特征值是 $\\lambda_i^2$。将 $A$ 的特征值平方，我们发现 $\\sigma(A^2) \\subseteq [m^2, M^2]$。\n$B = \\alpha^{-2}A^2 - I$ 的特征值由 $\\mu_i = \\alpha^{-2}\\lambda_i^2 - 1$ 给出。\n现在问题是要最小化这些特征值的最大绝对值：\n$$\n\\min_{\\alpha  0} \\max_{\\lambda_i \\in \\sigma(A)} |\\alpha^{-2}\\lambda_i^2 - 1|\n$$\n设 $x = \\lambda^2$。变量 $x$ 位于区间 $[m^2, M^2]$ 内。我们需要解决这个极小化极大问题：\n$$\n\\min_{\\alpha  0} \\max_{x \\in [m^2, M^2]} |\\alpha^{-2}x - 1|\n$$\n设 $\\beta = \\alpha^{-2}$。由于 $\\alpha  0$，我们有 $\\beta  0$。问题变成找到 $\\beta0$ 来最小化\n$$\ng(\\beta) = \\max_{x \\in [m^2, M^2]} |\\beta x - 1|\n$$\n函数 $h(x) = \\beta x - 1$ 是关于 $x$ 的线性函数。它在区间 $[m^2, M^2]$ 上的绝对值的最大值必定在其中一个端点处取得。所以，\n$$\ng(\\beta) = \\max\\left( |\\beta m^2 - 1|, |\\beta M^2 - 1| \\right)\n$$\n为了最小化 $\\max(|a|,|b|)$，一个常见的策略是选择参数使得 $|a|=|b|$。为了出现最小值，我们通常希望函数在边界处具有大小相等、符号相反的极值。这建议设置 $\\beta m^2 - 1 = -(\\beta M^2 - 1)$。\n$$\n\\beta m^2 - 1 = 1 - \\beta M^2\n$$\n$$\n\\beta m^2 + \\beta M^2 = 2\n$$\n$$\n\\beta (m^2 + M^2) = 2\n$$\n$$\n\\beta = \\frac{2}{m^2 + M^2}\n$$\n这个 $\\beta$ 的选择确保了在端点处的值是 $\\frac{2m^2}{m^2+M^2}-1 = \\frac{m^2-M^2}{m^2+M^2}$ 和 $\\frac{2M^2}{m^2+M^2}-1 = \\frac{M^2-m^2}{m^2+M^2}$。它们的绝对值相等。\n由于 $\\beta = \\alpha^{-2}$，我们有：\n$$\n\\alpha^{-2} = \\frac{2}{m^2 + M^2} \\implies \\alpha^2 = \\frac{m^2 + M^2}{2}\n$$\n鉴于 $\\alpha  0$，我们取正平方根：\n$$\n\\alpha = \\sqrt{\\frac{m^2 + M^2}{2}}\n$$\n这个 $\\alpha$ 值最小化了初始残差 $X_0^2-I$ 的谱范数。",
                "answer": "$$\\boxed{\\sqrt{\\frac{m^{2}+M^{2}}{2}}}$$",
                "id": "3591965"
            },
            {
                "introduction": "尽管数值算法功能强大，但它们也有其局限性，理解这些局限是成为专家的标志。本练习深入探讨矩阵符号函数在其定义域边界（虚轴）附近的行为，特别是对于不可对角化（亏损）矩阵。通过分析一个亏损的若尔当块，您将亲眼见证该函数固有的不连续性，并量化其敏感度的急剧放大，从而揭示为何“特征值必须避开虚轴”这一条件对数值稳定性如此关键。[@problem_id:3591967]",
                "problem": "设 $\\lambda \\in \\mathbb{C}$，考虑 $2 \\times 2$ 的亏损若尔当块 $J(\\lambda) = \\begin{pmatrix} \\lambda  1 \\\\ 0  \\lambda \\end{pmatrix}$。矩阵符号函数 $\\mathrm{sign}(A)$ 是一个主矩阵函数，定义在谱不与虚轴相交的矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 上。它通过解析函数演算，使用标量函数 $z \\mapsto \\mathrm{sign}(z)$ 定义，该函数将实部为正的复数映射到 $+1$，将实部为负的复数映射到 $-1$。\n\na) 从通过主矩阵函数定义的 $\\mathrm{sign}(A)$ 出发，并利用若尔当块上使用标量函数导数的刻画，证明当 $\\Re(\\lambda)$ 穿过 $0$ 时，$\\mathrm{sign}(J(\\lambda))$ 是不连续的。请基于 $J(\\lambda)$ 的结构以及 $z \\mapsto \\mathrm{sign}(z)$ 的解析域，给出一个有理有据的论证。\n\nb) 为了量化其敏感性，构建分块对角矩阵 $A(\\varepsilon) = \\mathrm{diag}\\big(J(\\varepsilon), J(-\\varepsilon)\\big) \\in \\mathbb{C}^{4 \\times 4}$，其中 $\\varepsilon \\in \\mathbb{R} \\setminus \\{0\\}$。设 $E \\in \\mathbb{C}^{4 \\times 4}$ 是一个扰动，其唯一的非零 $2 \\times 2$ 块是 $(1,2)$ 块 $E_{12} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$，所有其他块均为零矩阵。使用解析函数演算的第一性原理（柯西积分表示），推导弗雷歇导数 $L_{\\mathrm{sign}}(A(\\varepsilon); E)$ 的显式表达式，并计算其弗罗贝尼乌斯范数 $\\|L_{\\mathrm{sign}}(A(\\varepsilon); E)\\|_{F}$。\n\n最后，计算极限\n$$\\lim_{\\varepsilon \\to 0^{+}} \\varepsilon^{3} \\, \\|L_{\\mathrm{sign}}(A(\\varepsilon); E)\\|_{F},$$\n并将您的答案表示为一个精确值（无需四舍五入）。您的最终答案必须是一个单独的数字。",
                "solution": "该问题分两部分进行评估。a) 部分要求证明矩阵符号函数应用于亏损若尔当块时的不连续性。b) 部分要求计算一个弗雷歇导数和随后的一个极限，以量化函数在该不连续点附近的敏感性。\n\na) $\\mathrm{sign}(J(\\lambda))$ 的不连续性\n\n矩阵符号函数 $\\mathrm{sign}(A)$ 是与标量函数 $s(z) = \\mathrm{sign}(z)$ 相关联的主矩阵函数。该标量函数定义为：如果 $\\Re(z)  0$，则 $s(z) = 1$；如果 $\\Re(z)  0$，则 $s(z) = -1$。对于任何在虚轴上没有特征值的矩阵 $A \\in \\mathbb{C}^{n \\times n}$，矩阵函数 $\\mathrm{sign}(A)$ 都是良定义的。对于这样的矩阵，标量函数 $s(z)$ 在 $A$ 的谱上是解析的。\n\n在一个若尔当块 $J$ 上计算主矩阵函数 $f(J)$ 的值，是由一个涉及标量函数 $f$ 的导数的特定公式给出的。对于给定的 $2 \\times 2$ 亏损若尔当块 $J(\\lambda) = \\begin{pmatrix} \\lambda  1 \\\\ 0  \\lambda \\end{pmatrix}$，矩阵符号函数由下式给出：\n$$ \\mathrm{sign}(J(\\lambda)) = \\begin{pmatrix} s(\\lambda)  s'(\\lambda) \\\\ 0  s(\\lambda) \\end{pmatrix} $$\n其中 $s'(\\lambda)$ 是 $s(z)$ 的导数在 $z=\\lambda$ 处的值。该公式在 $s(z)$ 在 $\\lambda$ 的一个邻域内是解析的情况下有效。\n\n我们根据 $\\lambda$ 的实部分析 $\\mathrm{sign}(J(\\lambda))$ 的值。\n\n情况1：$\\Re(\\lambda)  0$。\n在这种情况下，$\\lambda$ 位于开放的右半平面。标量函数 $s(z)$ 在 $\\lambda$ 的一个邻域内是常数，等于 $1$。因此，其导数 $s'(\\lambda)$ 为 $0$。\n矩阵函数为：\n$$ \\mathrm{sign}(J(\\lambda)) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_2 $$\n其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵。\n\n情况2：$\\Re(\\lambda)  0$。\n在这种情况下，$\\lambda$ 位于开放的左半平面。标量函数 $s(z)$ 在 $\\lambda$ 的一个邻域内是常数，等于 $-1$。因此，其导数 $s'(\\lambda)$ 也为 $0$。\n矩阵函数为：\n$$ \\mathrm{sign}(J(\\lambda)) = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix} = -I_2 $$\n\n当 $\\Re(\\lambda)$ 穿过 $0$ 时，出现不连续性。设 $\\lambda = x+iy$。当 $x \\to 0^{+}$ 时，$\\mathrm{sign}(J(x+iy))$ 的极限是 $I_2$。当 $x \\to 0^{-}$ 时，极限是 $-I_2$。由于左极限和右极限不相等，函数 $\\mathrm{sign}(J(\\lambda))$ 在虚轴上的任何点（即 $\\Re(\\lambda)=0$ 的点）都是不连续的。这种不连续性的根本原因在于标量函数 $s(z)$ 的定义以及解析函数演算的要求。函数 $s(z)$ 本身在虚轴上不是解析的，而虚轴是其定义域的边界。当矩阵 $A$ 的一个特征值 $\\lambda$ 位于这个解析性边界上时，矩阵函数 $\\mathrm{sign}(A)$ 就没有定义。从两侧趋近这个边界的极限揭示了函数的不连续性。\n\nb) 弗雷歇导数和极限计算\n\n矩阵函数 $f(A)$ 在矩阵 $E$ 方向上的弗雷歇导数，记为 $L_f(A; E)$，可以使用柯西积分表示来计算：\n$$ L_f(A; E) = \\frac{1}{2\\pi i} \\oint_{\\Gamma} f(z) (zI-A)^{-1} E (zI-A)^{-1} dz $$\n此处，$f(z) = \\mathrm{sign}(z)$，积分围道 $\\Gamma$ 必须包围 $A$ 的谱。\n\n矩阵为 $A(\\varepsilon) = \\mathrm{diag}\\big(J(\\varepsilon), J(-\\varepsilon)\\big)$，其中 $J(\\varepsilon) = \\begin{pmatrix} \\varepsilon  1 \\\\ 0  \\varepsilon \\end{pmatrix}$ 且 $J(-\\varepsilon) = \\begin{pmatrix} -\\varepsilon  1 \\\\ 0  -\\varepsilon \\end{pmatrix}$。对于 $\\varepsilon \\in \\mathbb{R} \\setminus \\{0\\}$，$A(\\varepsilon)$ 的谱为 $\\{\\varepsilon, -\\varepsilon\\}$，每个特征值的代数重数为 $2$。我们可以选择围道 $\\Gamma$ 为两个不相交的简单闭合围道之并集：$\\Gamma_+$ 包围 $\\varepsilon$ 且完全位于右半平面，$\\Gamma_-$ 包围 $-\\varepsilon$ 且完全位于左半平面。在 $\\Gamma_+$ 上，$\\mathrm{sign}(z)=1$；在 $\\Gamma_-$ 上，$\\mathrm{sign}(z)=-1$。\n\n预解式 $(zI - A(\\varepsilon))^{-1}$ 是分块对角矩阵：\n$$ (zI - A(\\varepsilon))^{-1} = \\mathrm{diag}\\left((zI-J(\\varepsilon))^{-1}, (zI-J(-\\varepsilon))^{-1}\\right) $$\n设 $R_+(z) = (zI-J(\\varepsilon))^{-1} = \\begin{pmatrix} \\frac{1}{z-\\varepsilon}  \\frac{1}{(z-\\varepsilon)^2} \\\\ 0  \\frac{1}{z-\\varepsilon} \\end{pmatrix}$ 和 $R_-(z) = (zI-J(-\\varepsilon))^{-1} = \\begin{pmatrix} \\frac{1}{z+\\varepsilon}  \\frac{1}{(z+\\varepsilon)^2} \\\\ 0  \\frac{1}{z+\\varepsilon} \\end{pmatrix}$。\n\n扰动为 $E = \\begin{pmatrix} 0  E_{12} \\\\ 0  0 \\end{pmatrix}$，其中 $E_{12} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$。积分内的乘积变为：\n$$ (zI-A)^{-1} E (zI-A)^{-1} = \\begin{pmatrix} R_+(z)  0 \\\\ 0  R_-(z) \\end{pmatrix} \\begin{pmatrix} 0  E_{12} \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} R_+(z)  0 \\\\ 0  R_-(z) \\end{pmatrix} = \\begin{pmatrix} 0  R_+(z) E_{12} R_-(z) \\\\ 0  0 \\end{pmatrix} $$\n设 $L_{12}$ 为 $L_{\\mathrm{sign}}(A(\\varepsilon); E)$ 的 $(1,2)$ 块，这是唯一的非零块。\n$$ L_{12} = \\frac{1}{2\\pi i} \\oint_{\\Gamma} \\mathrm{sign}(z) R_+(z) E_{12} R_-(z) dz $$\n将积分分解到 $\\Gamma_+$ 和 $\\Gamma_-$ 上：\n$$ L_{12} = \\frac{1}{2\\pi i} \\oint_{\\Gamma_+} (1) R_+(z) E_{12} R_-(z) dz - \\frac{1}{2\\pi i} \\oint_{\\Gamma_-} (1) R_+(z) E_{12} R_-(z) dz $$\n设 $g(z) = R_+(z) E_{12} R_-(z)$。根据留数定理，这等于：\n$$ L_{12} = \\mathrm{Res}(g(z), \\varepsilon) - \\mathrm{Res}(g(z), -\\varepsilon) $$\n我们首先计算矩阵 $g(z)$：\n$$ g(z) = \\begin{pmatrix} \\frac{1}{z-\\varepsilon}  \\frac{1}{(z-\\varepsilon)^2} \\\\ 0  \\frac{1}{z-\\varepsilon} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{z+\\varepsilon}  \\frac{1}{(z+\\varepsilon)^2} \\\\ 0  \\frac{1}{z+\\varepsilon} \\end{pmatrix} $$\n$$ g(z) = \\begin{pmatrix} \\frac{1}{(z-\\varepsilon)^2}  0 \\\\ \\frac{1}{z-\\varepsilon}  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{z+\\varepsilon}  \\frac{1}{(z+\\varepsilon)^2} \\\\ 0  \\frac{1}{z+\\varepsilon} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{(z-\\varepsilon)^2(z+\\varepsilon)}  \\frac{1}{(z-\\varepsilon)^2(z+\\varepsilon)^2} \\\\ \\frac{1}{(z-\\varepsilon)(z+\\varepsilon)}  \\frac{1}{(z-\\varepsilon)(z+\\varepsilon)^2} \\end{pmatrix} $$\n现在我们计算每个元素的留数。设 $L_{12} = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$。\n- 对于 $a$：$g_{11}(z) = \\frac{1}{(z-\\varepsilon)^2(z+\\varepsilon)}$。\n  $\\mathrm{Res}(g_{11}, \\varepsilon) = \\frac{d}{dz}\\left(\\frac{1}{z+\\varepsilon}\\right)\\Big|_{z=\\varepsilon} = \\frac{-1}{(z+\\varepsilon)^2}\\Big|_{z=\\varepsilon} = \\frac{-1}{4\\varepsilon^2}$。\n  $\\mathrm{Res}(g_{11}, -\\varepsilon) = \\frac{1}{(z-\\varepsilon)^2}\\Big|_{z=-\\varepsilon} = \\frac{1}{4\\varepsilon^2}$。\n  $a = \\frac{-1}{4\\varepsilon^2} - \\frac{1}{4\\varepsilon^2} = -\\frac{1}{2\\varepsilon^2}$。\n- 对于 $b$：$g_{12}(z) = \\frac{1}{(z-\\varepsilon)^2(z+\\varepsilon)^2}$。\n  $\\mathrm{Res}(g_{12}, \\varepsilon) = \\frac{d}{dz}\\left(\\frac{1}{(z+\\varepsilon)^2}\\right)\\Big|_{z=\\varepsilon} = \\frac{-2}{(z+\\varepsilon)^3}\\Big|_{z=\\varepsilon} = \\frac{-2}{8\\varepsilon^3} = -\\frac{1}{4\\varepsilon^3}$。\n  $\\mathrm{Res}(g_{12}, -\\varepsilon) = \\frac{d}{dz}\\left(\\frac{1}{(z-\\varepsilon)^2}\\right)\\Big|_{z=-\\varepsilon} = \\frac{-2}{(z-\\varepsilon)^3}\\Big|_{z=-\\varepsilon} = \\frac{-2}{-8\\varepsilon^3} = \\frac{1}{4\\varepsilon^3}$。\n  $b = -\\frac{1}{4\\varepsilon^3} - \\frac{1}{4\\varepsilon^3} = -\\frac{1}{2\\varepsilon^3}$。\n- 对于 $c$：$g_{21}(z) = \\frac{1}{(z-\\varepsilon)(z+\\varepsilon)}$。\n  $\\mathrm{Res}(g_{21}, \\varepsilon) = \\frac{1}{z+\\varepsilon}\\Big|_{z=\\varepsilon} = \\frac{1}{2\\varepsilon}$。\n  $\\mathrm{Res}(g_{21}, -\\varepsilon) = \\frac{1}{z-\\varepsilon}\\Big|_{z=-\\varepsilon} = -\\frac{1}{2\\varepsilon}$。\n  $c = \\frac{1}{2\\varepsilon} - (-\\frac{1}{2\\varepsilon}) = \\frac{1}{\\varepsilon}$。\n- 对于 $d$：$g_{22}(z) = \\frac{1}{(z-\\varepsilon)(z+\\varepsilon)^2}$。\n  $\\mathrm{Res}(g_{22}, \\varepsilon) = \\frac{1}{(z+\\varepsilon)^2}\\Big|_{z=\\varepsilon} = \\frac{1}{4\\varepsilon^2}$。\n  $\\mathrm{Res}(g_{22}, -\\varepsilon) = \\frac{d}{dz}\\left(\\frac{1}{z-\\varepsilon}\\right)\\Big|_{z=-\\varepsilon} = \\frac{-1}{(z-\\varepsilon)^2}\\Big|_{z=-\\varepsilon} = -\\frac{1}{4\\varepsilon^2}$。\n  $d = \\frac{1}{4\\varepsilon^2} - (-\\frac{1}{4\\varepsilon^2}) = \\frac{1}{2\\varepsilon^2}$。\n\n因此，弗雷歇导数为 $L_{\\mathrm{sign}}(A(\\varepsilon); E) = \\begin{pmatrix} 0  L_{12} \\\\ 0  0 \\end{pmatrix}$，其中\n$$ L_{12} = \\begin{pmatrix} -\\frac{1}{2\\varepsilon^2}  -\\frac{1}{2\\varepsilon^3} \\\\ \\frac{1}{\\varepsilon}  \\frac{1}{2\\varepsilon^2} \\end{pmatrix} $$\n完整的矩阵是：\n$$ L_{\\mathrm{sign}}(A(\\varepsilon); E) = \\begin{pmatrix} 0  0  -\\frac{1}{2\\varepsilon^2}  -\\frac{1}{2\\varepsilon^3} \\\\ 0  0  \\frac{1}{\\varepsilon}  \\frac{1}{2\\varepsilon^2} \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\n接下来，我们计算其弗罗贝尼乌斯范数：\n$$ \\|L_{\\mathrm{sign}}(A(\\varepsilon); E)\\|_{F}^2 = \\sum_{i,j} |(L_{\\mathrm{sign}})_{ij}|^2 = \\left(-\\frac{1}{2\\varepsilon^2}\\right)^2 + \\left(-\\frac{1}{2\\varepsilon^3}\\right)^2 + \\left(\\frac{1}{\\varepsilon}\\right)^2 + \\left(\\frac{1}{2\\varepsilon^2}\\right)^2 $$\n$$ = \\frac{1}{4\\varepsilon^4} + \\frac{1}{4\\varepsilon^6} + \\frac{1}{\\varepsilon^2} + \\frac{1}{4\\varepsilon^4} = \\frac{1}{4\\varepsilon^6} + \\frac{1}{2\\varepsilon^4} + \\frac{1}{\\varepsilon^2} $$\n因此，$\\|L_{\\mathrm{sign}}(A(\\varepsilon); E)\\|_{F} = \\sqrt{\\frac{1}{4\\varepsilon^6} + \\frac{1}{2\\varepsilon^4} + \\frac{1}{\\varepsilon^2}}$。\n\n最后，我们计算 $\\varepsilon \\to 0^{+}$ 时所需的极限：\n$$ \\lim_{\\varepsilon \\to 0^{+}} \\varepsilon^{3} \\, \\|L_{\\mathrm{sign}}(A(\\varepsilon); E)\\|_{F} = \\lim_{\\varepsilon \\to 0^{+}} \\varepsilon^{3} \\sqrt{\\frac{1}{4\\varepsilon^6} + \\frac{1}{2\\varepsilon^4} + \\frac{1}{\\varepsilon^2}} $$\n由于 $\\varepsilon  0$，我们可以将 $\\varepsilon^3$ 移入平方根内，变为 $\\varepsilon^6$：\n$$ = \\lim_{\\varepsilon \\to 0^{+}} \\sqrt{\\varepsilon^{6} \\left(\\frac{1}{4\\varepsilon^6} + \\frac{1}{2\\varepsilon^4} + \\frac{1}{\\varepsilon^2}\\right)} $$\n$$ = \\lim_{\\varepsilon \\to 0^{+}} \\sqrt{\\frac{\\varepsilon^6}{4\\varepsilon^6} + \\frac{\\varepsilon^6}{2\\varepsilon^4} + \\frac{\\varepsilon^6}{\\varepsilon^2}} $$\n$$ = \\lim_{\\varepsilon \\to 0^{+}} \\sqrt{\\frac{1}{4} + \\frac{\\varepsilon^2}{2} + \\varepsilon^4} $$\n当 $\\varepsilon \\to 0^{+}$ 时，项 $\\frac{\\varepsilon^2}{2}$ 和 $\\varepsilon^4$ 都趋近于 $0$。\n$$ = \\sqrt{\\frac{1}{4} + 0 + 0} = \\sqrt{\\frac{1}{4}} = \\frac{1}{2} $$\n极限的值是 $\\frac{1}{2}$。",
                "answer": "$$\\boxed{\\frac{1}{2}}$$",
                "id": "3591967"
            },
            {
                "introduction": "数值分析师的最终目标不仅是计算出一个答案，而是计算出一个能保证其准确性的答案。这项综合性实践将指导您设计并实现一个完整的、用于验证从符号函数导出的谱投影算子的后验认证框架。您将基于可计算的残差推导出一个严格的误差界，并利用它为一个迭代算法创建智能停止准则，从而将一个基本的计算过程转变为一个可靠且可验证的数值工具。[@problem_id:3591959]",
                "problem": "考虑一个复方阵 $A \\in \\mathbb{C}^{n \\times n}$，其特征值均不位于虚轴上。矩阵符号函数 $\\mathrm{sign}(A)$ 通过全纯函数演算（例如通过柯西积分）定义，并产生一个与 $A$ 可交换的对合矩阵。对应于特征值实部为正的特征向量所张成的 $A$-不变子空间上的谱投影算子为 $P_{\\star} = \\tfrac{1}{2}(I + \\mathrm{sign}(A))$。精确的投影算子满足 $P_{\\star}^2 = P_{\\star}$ 和 $A P_{\\star} = P_{\\star} A$。在许多应用中（例如，连续时间线性系统的稳定-不稳定分解、特征值问题中的紧缩子空间以及基于符号函数的极分解计算），需要求得 $P_{\\star}$ 或其高质量的近似。\n\n您的任务如下。\n\n1) 从上述核心定义以及不变投影算子和交换子的基本性质出发，推导一个可计算的后验证界 $B(P, A)$。该界只依赖于矩阵 $A$、一个近似投影算子 $P$、残差 $\\|P^2 - P\\|$ 和 $\\|A P - P A\\|$（需明确说明所用的矩阵范数），以及一个用于衡量谱与虚轴分离程度的、数值上可访问的 $A$ 的谱分离量。该界必须具有以下性质：对于选定的容差 $\\tau  0$，如果 $B(P, A) \\le \\tau$ 且一个简单的、可验证的秩一致性条件成立，则存在一个 $A$-不变投影算子 $P_{\\star}$，使得 $\\|P - P_{\\star}\\|$ 被一个常数乘以 $\\tau$ 所界定，并且 $P_{\\star}$ 是对应于 $A$ 的正实部特征值的谱投影算子。请明确陈述您所做的任何假设，并确保所有步骤都由经过充分检验的事实（例如，三角分解、通过谱分离的Sylvester方程条件数，以及幂等矩阵和交换子的性质）来证明。不要在问题中提供简化的公式；您必须在解答中推导它们。\n\n2) 为一个迭代过程提出停止准则。该过程从 $A$ 计算序列 $P_k$ 而不精确计算 $\\mathrm{sign}(A)$，并且仅使用：\n- 残差范数 $\\|P_k^2 - P_k\\|$ 和 $\\|A P_k - P_k A\\|$，\n- 一个关于虚轴的 $A$ 的谱分离代理量，\n- 以及一个将 $\\mathrm{trace}(P_k)$ 与 $A$ 的正实部特征值个数 $n_+(A)$（计入代数重数）进行比较的秩一致性检查。\n您的停止准則必须避免使用精确的 $\\mathrm{sign}(A)$，并且必须足以在您推导的界下保证 $P_k$ 被验证为在用户指定的容差范围内近似 $P_{\\star}$。\n\n3) 实现一个完整的、可运行的程序，该程序仅基于 $A$ 和线性求解（例如，仅使用矩阵求解和乘法的矩阵符号函数牛顿迭代法）通过迭代构造 $P_k$，并使用您的验证框架在验证成功后立即提前终止。您必须对所有残差和误差代理量使用Frobenius范数 $\\|\\cdot\\|_F$。如果 $A$ 的任何特征值位于虚轴上（数值检测到），您的验证必须在该情况下失败。您的程序应返回一个布尔值，指示验证是否在迭代次数上限内成功，对于下面测试套件中的每个测试矩阵。\n\n4) 测试套件。使用以下四个矩阵来全面测试该框架。在所有情况下，根据描述，从一个具有指定特征值的对角矩阵 $D$ 和一个条件良好或病态的可逆相似变换矩阵 $S$ 来构造一个相似矩阵 $A = S D S^{-1}$。所有随机量必须按照规定确定性地生成，以确保可复现性。\n\n- 情况1（理想情况，非正规但谱分离良好）：令 $n = 6$ 且\n  $$\n  D_1 = \\mathrm{diag}\\left(3 + i,\\; 2 + 0.5 i,\\; 1 + 2 i,\\; -1 + 2 i,\\; -2 - i,\\; -3 + 0.1 i\\right).\n  $$\n  构造 $S_1 = I + 0.2 R_1$，其中 $R_1$ 的实部和虚部是使用伪随机种子 $1$ 生成的独立标准正态分布。设 $A_1 = S_1 D_1 S_1^{-1}$。\n\n- 情况2（靠近虚轴的谱间隙小）：令 $n = 6$ 且\n  $$\n  D_2 = \\mathrm{diag}\\left(0.02 + 1.3 i,\\; 0.03 + 0.4 i,\\; -0.02 + 2.1 i,\\; -0.03 - 1.2 i,\\; 0.05 - 1.5 i,\\; -0.04 + 0.7 i\\right).\n  $$\n  构造 $S_2 = I + 0.2 R_2$，其中 $R_2$ 按上述方式生成，但使用种子 $2$。设 $A_2 = S_2 D_2 S_2^{-1}$。\n\n- 情况3（病态相似变换，非正规）：令 $n = 6$ 且\n  $$\n  D_3 = \\mathrm{diag}\\left(3 + 2 i,\\; 2 + i,\\; 1 + 0.5 i,\\; -1 - 0.5 i,\\; -2 - i,\\; -3 - 2 i\\right).\n  $$\n  使用种子 $3$ 生成一个实部和虚部为标准正态分布的复矩阵 $M$，计算其瘦 $QR$ 分解得到一个酉矩阵 $Q$，并设\n  $$\n  S_3 = Q \\, \\mathrm{diag}\\left(1,\\; 10^{-6},\\; 10^{-3},\\; 1,\\; 10^{2},\\; 10^{3}\\right).\n  $$\n  设 $A_3 = S_3 D_3 S_3^{-1}$。\n\n- 情况4（边界条件：特征值在虚轴上，因此验证必须失败）：令 $n = 4$ 且\n  $$\n  D_4 = \\mathrm{diag}\\left(2 i,\\; 1 + i,\\; -1 - 2 i,\\; -2 + i\\right).\n  $$\n  构造 $S_4 = I + 0.2 R_4$，其中 $R_4$ 按上述方式生成，但使用种子 $4$。设 $A_4 = S_4 D_4 S_4^{-1}$。\n\n5) 程序输出规范。全程使用Frobenius范数 $\\|\\cdot\\|_F$。设验证容差为 $\\tau = 10^{-8}$，最大牛顿迭代次数为 $N_{\\max} = 60$。对于测试套件中的每个 $A_j$，您的程序必须产生一个布尔值，指示验证是否在您的停止准则下成功。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按四个情况的顺序显示结果，例如，“[True,False,True,False]”。\n\n在您的推导和推理中，所有数学量都必须用LaTeX表示。不涉及物理单位。不使用角度。不得出现百分比。最终程序不得要求任何用户输入。它必须是确定性的、自包含的，并在指定环境下可运行。",
                "solution": "该问题要求为近似谱投影算子推导一个验证框架，为迭代算法制定停止准則，并实现和测试此框架。解答分为两个主要部分：首先是理论推导，其次是作为最终代码前奏的算法描述及其实现细节。\n\n### 第一部分：后验证界的推导\n\n目标是根据残差 $R_P = P^2 - P$ 和 $R_C = AP - PA$ 的Frobenius范数，推导近似投影算子 $P$ 与精确谱投影算子 $P_{\\star}$ 之间误差 $\\|P - P_{\\star}\\|_F$ 的一个界 $B(P, A)$。\n\n**假设与定义**\n设 $A \\in \\mathbb{C}^{n \\times n}$ 是一个特征值均不位于虚轴上的矩阵。令 $\\sigma(A)$ 为 $A$ 的特征值集合。我们可以将谱划分为 $\\sigma(A) = \\sigma_+(A) \\cup \\sigma_-(A)$，其中 $\\sigma_+(A) = \\{\\lambda \\in \\sigma(A) \\mid \\mathrm{Re}(\\lambda)  0\\}$ 且 $\\sigma_-(A) = \\{\\lambda \\in \\sigma(A) \\mid \\mathrm{Re}(\\lambda)  0\\}$。\n与 $\\sigma_+(A)$ 相关联的 $A$-不变子空间上的精确谱投影算子 $P_{\\star}$ 是一个幂等矩阵（$P_{\\star}^2=P_{\\star}$），且与 $A$ 可交换（$AP_{\\star}=P_{\\star}A$）。空间 $\\mathbb{C}^n$ 分解为两个 $A$-不变子空间的直和，$\\mathcal{L}_+ = \\mathrm{range}(P_\\star)$ 和 $\\mathcal{L}_- = \\mathrm{range}(I-P_\\star)$。令 $A_+$ 为 $A$ 在 $\\mathcal{L}_+$ 上的限制，$A_-$ 为 $A$ 在 $\\mathcal{L}_-$ 上的限制。根据定义，$\\sigma(A_+) = \\sigma_+(A)$ 且 $\\sigma(A_-) = \\sigma_-(A)$。\n\n**Sylvester方程与残差**\n分析的关键在于Sylvester算子的性质。对于矩阵 $M_1, M_2$，算子 $\\mathcal{T}(X) = M_1 X - X M_2$ 可逆当且仅当 $\\sigma(M_1) \\cap \\sigma(M_2) = \\emptyset$。若其可逆，则 $M_1 X - X M_2 = B$ 的解满足 $\\|X\\|_F \\le \\|\\mathcal{T}^{-1}\\| \\|B\\|_F = \\|B\\|_F / \\mathrm{sep}_F(M_1, M_2)$，其中 $\\mathrm{sep}_F(M_1, M_2) = \\min_{\\|Z\\|_F=1} \\|M_1 Z - Z M_2\\|_F$。\n由于 $\\sigma(A_+) \\cap \\sigma(A_-) = \\emptyset$，算子 $\\mathcal{T}_+(X) = A_+ X - X A_-$ 和 $\\mathcal{T}_-(Y) = A_- Y - Y A_+$ 均可逆。\n\n设 $P$ 是一个近似投影算子，$R_C = AP - PA$。我们将此方程投影到子空间 $\\mathcal{L}_+$ 和 $\\mathcal{L}_-$ 上。用 $P_{\\star}$ 左乘 $R_C$，用 $(I-P_{\\star})$ 右乘，得到：\n$$P_{\\star}R_C(I-P_{\\star}) = P_{\\star}(AP-PA)(I-P_{\\star})$$\n利用可交换性 $AP_{\\star}=P_{\\star}A$ 和幂等性 $P_{\\star}^2=P_{\\star}$，上式可简化为：\n$$P_{\\star}R_C(I-P_{\\star}) = A(P_{\\star}P(I-P_{\\star})) - (P_{\\star}P(I-P_{\\star}))A$$\n令 $F_{12} = P_{\\star}P(I-P_{\\star})$。此算子从 $\\mathcal{L}_-$ 映射到 $\\mathcal{L}_+$。该方程是关于 $F_{12}$ 的一个Sylvester方程：$A_+ F_{12} - F_{12} A_- = P_{\\star}R_C(I-P_{\\star})$。\n$F_{12}$ 的范数因此有界：\n$$\\|F_{12}\\|_F = \\|P_{\\star}P(I-P_{\\star})\\|_F \\le \\frac{\\|P_{\\star}R_C(I-P_{\\star})\\|_F}{\\mathrm{sep}_F(A_+, A_-)} \\le \\frac{\\|R_C\\|_F}{\\delta}$$\n其中 $\\delta = \\mathrm{sep}_F(A_+, A_-)$。一个直接的界是 $\\|P_{\\star}R_C(I-P_{\\star})\\|_F \\le \\|R_C\\|_F$，因为投影不会增加Frobenius范数。\n类似地，对于 $F_{21} = (I-P_{\\star})P P_{\\star}$：\n$$\\|F_{21}\\|_F = \\|(I-P_{\\star})P P_{\\star}\\|_F \\le \\frac{\\|R_C\\|_F}{\\mathrm{sep}_F(A_-, A_+)} = \\frac{\\|R_C\\|_F}{\\delta}$$\n\n**投影算子误差分析**\n令误差为 $E = P - P_{\\star}$。我们根据投影算子 $P_{\\star}$ 和 $I-P_{\\star}$ 将 $E$ 分解为四个分块：\n$E = P_{\\star}EP_{\\star} + P_{\\star}E(I-P_{\\star}) + (I-P_{\\star})EP_{\\star} + (I-P_{\\star})E(I-P_{\\star})$。\n非对角误差分块正是上面已给出界的项：\n$P_{\\star}E(I-P_{\\star}) = P_{\\star}(P-P_{\\star})(I-P_{\\star}) = P_{\\star}P(I-P_{\\star}) = F_{12}$。\n$(I-P_{\\star})EP_{\\star} = (I-P_{\\star})(P-P_{\\star})P_{\\star} = (I-P_{\\star})P P_{\\star} = F_{21}$。\n\n为了界定对角誤差分塊，我們使用殘差 $R_P = P^2 - P$。用 $P_{\\star}$ 對該方程進行左右投影：\n$$P_{\\star}R_P P_{\\star} = P_{\\star}(P^2-P)P_{\\star} = P_{\\star}P(P_{\\star}+I-P_{\\star})P P_{\\star} - P_{\\star}P P_{\\star}$$\n$$P_{\\star}R_P P_{\\star} = (P_{\\star}P P_{\\star})^2 + (P_{\\star}P(I-P_{\\star}))((I-P_{\\star})P P_{\\star}) - P_{\\star}P P_{\\star}$$\n令 $E_{11} = P_{\\star}EP_{\\star} = P_{\\star}PP_{\\star} - P_{\\star}$。方程变为：\n$$(E_{11}+P_{\\star})^2 + F_{12}F_{21} - (E_{11}+P_{\\star}) = P_{\\star}R_P P_{\\star}$$\n由于 $P_{\\star}$ 在 $\\mathcal{L}_+$ 上是单位算子，这简化为 $\\mathcal{L}_+$ 上的一个算子方程：$E_{11}^2 + E_{11} = P_{\\star}R_P P_{\\star} - F_{12}F_{21}$。\n如果右侧项很小，$E_{11}$ 也必定很小。令 $C = P_{\\star}R_P P_{\\star} - F_{12}F_{21}$。若 $\\|E_{11}\\|_F \\le 1/2$，则 $\\|E_{11}\\|_F \\le 2\\|C\\|_F$。假设此条件成立，我们有：\n$$\\|E_{11}\\|_F \\le 2(\\|P_{\\star}R_P P_{\\star}\\|_F + \\|F_{12}F_{21}\\|_F) \\le 2\\left(\\|R_P\\|_F + \\|F_{12}\\|_F \\|F_{21}\\|_F\\right)$$\n$$\\|E_{11}\\|_F \\le 2\\left(\\|R_P\\|_F + \\left(\\frac{\\|R_C\\|_F}{\\delta}\\right)^2\\right)$$\n对 $E_{22} = (I-P_{\\star})E(I-P_{\\star}) = (I-P_{\\star})P(I-P_{\\star})$ 进行类似分析，得到一个二次方程 $E_{22}^2 - E_{22} = (I-P_{\\star})R_P(I-P_{\\star})-F_{21}F_{12}$，从而导出同样形式的界：\n$$\\|E_{22}\\|_F \\le 2\\left(\\|R_P\\|_F + \\left(\\frac{\\|R_C\\|_F}{\\delta}\\right)^2\\right)$$\n\n**验证界**\n总误差由 $\\|P-P_{\\star}\\|_F^2 = \\|E\\|_F^2 = \\|E_{11}\\|_F^2 + \\|F_{12}\\|_F^2 + \\|F_{21}\\|_F^2 + \\|E_{22}\\|_F^2$ 给出。\n代入上面推导出的界：\n$$\\|P-P_{\\star}\\|_F^2 \\le \\left(\\frac{\\|R_C\\|_F}{\\delta}\\right)^2 + \\left(\\frac{\\|R_C\\|_F}{\\delta}\\right)^2 + 2 \\left[2\\left(\\|R_P\\|_F + \\left(\\frac{\\|R_C\\|_F}{\\delta}\\right)^2\\right)\\right]^2$$\n$$\\|P-P_{\\star}\\|_F^2 \\le 2\\left(\\frac{\\|R_C\\|_F}{\\delta}\\right)^2 + 8\\left(\\|R_P\\|_F + \\left(\\frac{\\|R_C\\|_F}{\\delta}\\right)^2\\right)^2$$\n问题要求一个可计算的界。谱分离量 $\\delta = \\mathrm{sep}_F(A_+, A_-)$ 无法直接得知。我们通过计算 $A$ 的特征值（记为 $\\lambda_i$）来定义一个数值上可访问的代理量。令 $\\sigma_+ = \\{\\lambda_i \\mid \\mathrm{Re}(\\lambda_i)0\\}$ 和 $\\sigma_- = \\{\\lambda_i \\mid \\mathrm{Re}(\\lambda_i)0\\}$。我们将我们的分离度量定义为：\n$$\\delta_A = \\min_{\\lambda \\in \\sigma_+, \\mu \\in \\sigma_-} |\\lambda - \\mu|$$\n虽然对于高度非正规矩阵，$\\delta_A$ 可能是 $\\delta$ 的一个很差的下界，但它满足了问题对一个可计算的、衡量谱分离程度的量的要求。\n令 $\\eta_P = \\|P^2-P\\|_F$ 和 $\\eta_C = \\|AP-PA\\|_F$。最终的可计算后验证界为：\n$$B(P, A) = \\sqrt{2 \\left(\\frac{\\eta_C}{\\delta_A}\\right)^2 + 8\\left(\\eta_P + \\left(\\frac{\\eta_C}{\\delta_A}\\right)^2\\right)^2}$$\n如果 $B(P, A) \\le \\tau$，那么 $\\|P - P_{\\star}\\|_F \\le \\tau$，这满足了问题的标准，常数为 $1$。\n\n### 第二部分：停止准则与算法设计\n\n**停止准则**\n一个迭代方法产生一系列近似值 $P_k$。当满足以下准则时，我们可以验证 $P_k$ 是 $P_{\\star}$ 的一个良好近似，并终止迭代：\n1.  **预计算与合理性检查**：\n    a. 计算 $A$ 的特征值。如果对于一个很小的容差（例如，机器精度），有 $\\min_{\\lambda \\in \\sigma(A)} |\\mathrm{Re}(\\lambda)|  \\epsilon_{mach}\\|A\\|_F$，则矩阵有特征值位于虚轴上或非常靠近虚轴。理论不适用；验证失败。\n    b. 如果谱与虚轴分离，计算右半平面中的特征值数量 $n_+(A)$ 和分离代理量 $\\delta_A$。\n2.  **迭代验证检查（在每一步 $k$）**：\n    a. **残差计算**：计算 $\\eta_P^{(k)} = \\|P_k^2 - P_k\\|_F$ 和 $\\eta_C^{(k)} = \\|AP_k - P_kA\\|_F$。\n    b. **秩一致性**：幂等矩阵的迹等于其秩。对于近似投影算子 $P_k$，我们检查其迹是否近似于 $P_{\\star}$ 的已知秩 $n_+(A)$。条件是：$|\\mathrm{round}(\\mathrm{Re}(\\mathrm{trace}(P_k))) - n_+(A)| = 0$。\n    c. **验证**：计算界 $B(P_k, A)$。如果 $B(P_k, A) \\le \\tau$（用户容差）且秩一致性检查通过，则迭代成功终止。\n3.  **迭代限制**：如果在最大迭代次数 $N_{\\max}$ 内未满足验证条件，则过程以失败告终。\n\n**迭代方法的选择**\n问题建议使用基于线性求解的迭代。矩阵符号函数 $S = \\mathrm{sign}(A)$ 的牛顿法是一个合适的选择。方程为 $X^2-I=0$。迭代格式为：\n$$X_{k+1} = \\frac{1}{2}(X_k + X_k^{-1}), \\quad X_0 = A$$\n只要 $A$ 没有特征值在虚轴上，该迭代就会二次收敛到 $S$。每一步都涉及一次矩阵求逆，这等价于求解一个线性系统 $X_k Y = I$。从迭代值 $X_k$，我们构造近似投影算子：\n$$P_k = \\frac{1}{2}(I+X_k)$$\n然后将这些 $P_k$ 用于上述的验证和停止准则。",
                "answer": "```python\nimport numpy as np\nimport scipy.linalg\n\ndef certify_projector(A, tau, N_max):\n    \"\"\"\n    Computes an approximate spectral projector for A and certifies its accuracy.\n\n    Args:\n        A (np.ndarray): The input complex square matrix.\n        tau (float): The certification tolerance for the error bound.\n        N_max (int): The maximum number of iterations.\n\n    Returns:\n        bool: True if certification succeeds, False otherwise.\n    \"\"\"\n    n = A.shape[0]\n    \n    # --- Step 1: Pre-computation and Sanity Check ---\n    try:\n        eigs = np.linalg.eigvals(A)\n    except np.linalg.LinAlgError:\n        return False # Eigenvalue computation failed\n\n    # Check for eigenvalues on or near the imaginary axis\n    min_real_part = np.min(np.abs(np.real(eigs)))\n    # A robust tolerance depends on the matrix norm\n    norm_A_fro = np.linalg.norm(A, 'fro')\n    if min_real_part  1e-14 * norm_A_fro:\n        return False # Eigenvalues on imaginary axis, certification fails\n\n    # Compute n_+(A) and the spectral separation surrogate delta_A\n    eigs_pos = eigs[np.real(eigs)  0]\n    eigs_neg = eigs[np.real(eigs)  0]\n    \n    n_plus = len(eigs_pos)\n    if n_plus == 0 or n_plus == n: # All eigenvalues on one side\n        # The problem becomes trivial; projector is 0 or I. Let's handle this.\n        # If n_plus=0, P_star=0. P=0 gives residuals 0 and bound 0.\n        # If n_plus=n, P_star=I. P=I gives residuals 0 and bound 0.\n        # We can consider this an immediate success.\n        return True\n\n    delta_A = np.min([np.abs(lp - lm) for lp in eigs_pos for lm in eigs_neg])\n    \n    if delta_A  1e-14 * norm_A_fro: # Poor separation\n        return False\n\n    # --- Step 2: Iterative Refinement and Certification ---\n    X_k = A.copy()\n    I = np.eye(n, dtype=A.dtype)\n\n    for _ in range(N_max):\n        try:\n            X_k_inv = np.linalg.inv(X_k)\n            X_k = 0.5 * (X_k + X_k_inv)\n        except np.linalg.LinAlgError:\n            return False # Iteration failed (likely singular iterate)\n\n        P_k = 0.5 * (I + X_k)\n        \n        # --- Step 2a: Rank Consistency Check ---\n        # The trace of a projector is its rank.\n        # For an approximate projector, its trace should be close to an integer.\n        rank_P_k = np.round(np.real(np.trace(P_k)))\n        if np.abs(rank_P_k - n_plus)  0.5:\n            # Rank is not yet consistent, continue iteration\n            continue\n\n        # --- Step 2b: Residual Calculation ---\n        R_P = P_k @ P_k - P_k\n        eta_P = np.linalg.norm(R_P, 'fro')\n        \n        R_C = A @ P_k - P_k @ A\n        eta_C = np.linalg.norm(R_C, 'fro')\n        \n        # --- Step 2c: Certification Bound ---\n        gamma = eta_C / delta_A\n        B_k_sq = 2 * (gamma**2) + 8 * (eta_P + gamma**2)**2\n        B_k = np.sqrt(B_k_sq)\n        \n        # --- Step 2d: Certification Check ---\n        if B_k = tau:\n            return True # Certification succeeded\n\n    return False # Failed to certify within N_max iterations\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Problem specifications\n    tau = 1e-8\n    N_max = 60\n    \n    test_cases_configs = [\n        # (Case ID, n, seed, D_values)\n        (1, 6, 1, [3 + 1j, 2 + 0.5j, 1 + 2j, -1 + 2j, -2 - 1j, -3 + 0.1j]),\n        (2, 6, 2, [0.02 + 1.3j, 0.03 + 0.4j, -0.02 + 2.1j, -0.03 - 1.2j, 0.05 - 1.5j, -0.04 + 0.7j]),\n        (3, 6, 3, [3 + 2j, 2 + 1j, 1 + 0.5j, -1 - 0.5j, -2 - 1j, -3 - 2j]),\n        (4, 4, 4, [2j, 1 + 1j, -1 - 2j, -2 + 1j]),\n    ]\n\n    results = []\n    for case_id, n, seed, D_vals in test_cases_configs:\n        D = np.diag(D_vals)\n        rng = np.random.default_rng(seed)\n        \n        if case_id == 3:\n            M = rng.standard_normal((n, n)) + 1j * rng.standard_normal((n, n))\n            Q, _ = np.linalg.qr(M, mode='reduced')\n            Sigma = np.diag([1, 1e-6, 1e-3, 1, 1e2, 1e3])\n            S = Q @ Sigma\n        else:\n            R = rng.standard_normal((n, n)) + 1j * rng.standard_normal((n, n))\n            S = np.eye(n) + 0.2 * R\n        \n        A = S @ D @ np.linalg.inv(S)\n        \n        is_certified = certify_projector(A, tau, N_max)\n        results.append(is_certified)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```",
                "id": "3591959"
            }
        ]
    }