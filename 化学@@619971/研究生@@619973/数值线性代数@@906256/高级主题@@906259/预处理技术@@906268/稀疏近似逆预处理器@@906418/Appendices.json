{
        "hands_on_practices": [
            {
                "introduction": "第一个练习将我们对稀疏近似逆 (SPAI) 预处理器的理解建立在其基本定义之上。通过为一个小的、预定义的稀疏模式直接计算最优矩阵项，您将看到最小化弗罗贝尼乌斯范数 $\\|I - AM\\|_F$ 的全局问题如何解耦为针对每一列的、独立的、可管理的最小二乘问题 [@problem_id:1029919]。这种动手计算揭示了从第一性原理构建 SPAI 预处理器的核心机制。",
                "problem": "在求解形如 $Ax=b$ 的大型稀疏线性方程组的迭代过程中，通常使用一个预条件矩阵 $M$ 将原系统转换为一个条件数更优的系统，例如 $MAx=Mb$。一个有效的预条件子 $M$ 应该近似于 $A$ 的逆，即 $MA \\approx I$，同时其计算和应用的成本要低。\n\n此类预条件子中的一类，称为稀疏近似逆（SAI），其构造方法是：首先定义一个具有预设非零元模式的稀疏矩阵 $M$，然后通过最小化残差矩阵的弗罗贝尼乌斯范数 $\\|I - AM\\|_F$ 来确定这些非零元的值。\n\n考虑一个一般的 $3 \\times 3$ 可逆实矩阵 $A = (a_{ij})$。我们寻求一个具有以下预设稀疏模式的SAI预条件子 $M$：\n$$\nM = \\begin{pmatrix} m_{11} & 0 & m_{13} \\\\ 0 & m_{22} & 0 \\\\ m_{31} & 0 & m_{33} \\end{pmatrix}\n$$\n$M$ 的非零元通过最小化弗罗贝尼乌斯范数的平方 $\\|I - AM\\|_F^2$ 来选择。\n\n你的任务是找到最优预条件子 $M$ 的元素 $m_{11}$ 关于矩阵 $A$ 的元素 $a_{ij}$ 的显式表达式。",
                "solution": "问题在于找到矩阵 $M$ 的非零元，以最小化目标函数 $F(M) = \\|I - AM\\|_F^2$。矩阵 $B$ 的弗罗贝尼乌斯范数由 $\\|B\\|_F = \\sqrt{\\sum_{i,j} |B_{ij}|^2}$ 给出。最小化 $\\|I - AM\\|_F$ 等价于最小化 $F(M) = \\|I - AM\\|_F^2$。\n\n弗罗贝尼乌斯范数的平方是其各列的欧几里得范数平方之和。设 $M_j$ 是 $M$ 的第 $j$ 列，$e_j$ 是第 $j$ 个标准基向量（即单位矩阵 $I$ 的第 $j$ 列）。矩阵 $I - AM$ 的第 $j$ 列是 $e_j - AM_j$。\n\n目标函数可以写成：\n$$\nF(M) = \\sum_{j=1}^3 \\|e_j - AM_j\\|_2^2\n$$\n这个公式的一个关键性质是，优化问题对 $M$ 的每一列是解耦的。我们可以通过求解独立的最小二乘问题来独立地找到每一列 $M_j$ 的最优元素：\n$$\n\\min_{M_j} \\|e_j - AM_j\\|_2^2 \\quad \\text{for } j=1, 2, 3\n$$\n我们需要求解元素 $m_{11}$，它是 $M$ 的第一列（即 $M_1$）的一部分。$M$ 的第一列形式为 $M_1 = (m_{11}, 0, m_{31})^T$。该列的优化变量是 $m_{11}$ 和 $m_{31}$。\n\n让我们展开 $AM_1$ 这一项：\n$$\nAM_1 = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{21} & a_{22} & a_{23} \\\\ a_{31} & a_{32} & a_{33} \\end{pmatrix} \\begin{pmatrix} m_{11} \\\\ 0 \\\\ m_{31} \\end{pmatrix} = \\begin{pmatrix} a_{11}m_{11} + a_{13}m_{31} \\\\ a_{21}m_{11} + a_{23}m_{31} \\\\ a_{31}m_{11} + a_{33}m_{31} \\end{pmatrix}\n$$\n这可以写成 $A$ 的一个子矩阵与 $M_1$ 的非零元向量的乘积。令 $\\tilde{m}_1 = \\begin{pmatrix} m_{11} \\\\ m_{31} \\end{pmatrix}$。令 $\\tilde{A}_1$ 是由 $A$ 中对应于 $M_1$ 非零元位置的列所构成的矩阵。这些是 $A$ 的第1列和第3列。\n$$\n\\tilde{A}_1 = \\begin{pmatrix} a_{11} & a_{13} \\\\ a_{21} & a_{23} \\\\ a_{31} & a_{33} \\end{pmatrix}\n$$\n所以，$AM_1 = \\tilde{A}_1 \\tilde{m}_1$。第一列的最小二乘问题是：\n$$\n\\min_{\\tilde{m}_1} \\|e_1 - \\tilde{A}_1 \\tilde{m}_1\\|_2^2\n$$\n这是一个标准的线性最小二乘问题。解 $\\tilde{m}_1$ 可以通过求解正规方程得到：\n$$\n(\\tilde{A}_1^T \\tilde{A}_1) \\tilde{m}_1 = \\tilde{A}_1^T e_1\n$$\n让我们计算这个方程中的各项。\n$$\n\\tilde{A}_1^T e_1 = \\begin{pmatrix} a_{11} & a_{21} & a_{31} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} a_{11} \\\\ a_{13} \\end{pmatrix}\n$$\n$$\nG = \\tilde{A}_1^T \\tilde{A}_1 = \\begin{pmatrix} a_{11} & a_{21} & a_{31} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} \\begin{pmatrix} a_{11} & a_{13} \\\\ a_{21} & a_{23} \\\\ a_{31} & a_{33} \\end{pmatrix} = \\begin{pmatrix} a_{11}^2+a_{21}^2+a_{31}^2 & a_{11}a_{13}+a_{21}a_{23}+a_{31}a_{33} \\\\ a_{11}a_{13}+a_{21}a_{23}+a_{31}a_{33} & a_{13}^2+a_{23}^2+a_{33}^2 \\end{pmatrix}\n$$\n我们将这个 $2 \\times 2$ 的格拉姆矩阵 $G$ 的分量记为：\n$g_{11} = a_{11}^2+a_{21}^2+a_{31}^2$\n$g_{22} = a_{13}^2+a_{23}^2+a_{33}^2$\n$g_{12} = g_{21} = a_{11}a_{13}+a_{21}a_{23}+a_{31}a_{33}$\n\n正规方程变为：\n$$\n\\begin{pmatrix} g_{11} & g_{12} \\\\ g_{12} & g_{22} \\end{pmatrix} \\begin{pmatrix} m_{11} \\\\ m_{31} \\end{pmatrix} = \\begin{pmatrix} a_{11} \\\\ a_{13} \\end{pmatrix}\n$$\n$\\tilde{m}_1$ 的解可以通过对 $G$ 求逆得到：\n$$\n\\begin{pmatrix} m_{11} \\\\ m_{31} \\end{pmatrix} = G^{-1} \\begin{pmatrix} a_{11} \\\\ a_{13} \\end{pmatrix}\n$$\n$2 \\times 2$ 矩阵 $G$ 的逆是：\n$$\nG^{-1} = \\frac{1}{\\det(G)} \\begin{pmatrix} g_{22} & -g_{12} \\\\ -g_{12} & g_{11} \\end{pmatrix} = \\frac{1}{g_{11}g_{22}-g_{12}^2} \\begin{pmatrix} g_{22} & -g_{12} \\\\ -g_{12} & g_{11} \\end{pmatrix}\n$$\n由于 $A$ 是可逆的，它的列是线性无关的。因此，列 $A_1$ 和 $A_3$ 是线性无关的，这保证了 $G = \\tilde{A}_1^T \\tilde{A}_1$ 是可逆的，并且 $\\det(G) > 0$。\n\n我们需要求 $m_{11}$，它是解向量的第一个分量：\n$$\nm_{11} = \\frac{g_{22}a_{11} - g_{12}a_{13}}{g_{11}g_{22} - g_{12}^2}\n$$\n让我们代入 $g_{ij}$ 的表达式：\n分子是：\n$N = (a_{13}^2+a_{23}^2+a_{33}^2)a_{11} - (a_{11}a_{13}+a_{21}a_{23}+a_{31}a_{33})a_{13}$\n$N = a_{11}a_{13}^2 + a_{11}a_{23}^2 + a_{11}a_{33}^2 - a_{11}a_{13}^2 - a_{13}a_{21}a_{23} - a_{13}a_{31}a_{33}$\n$N = a_{11}a_{23}^2 + a_{11}a_{33}^2 - a_{21}a_{13}a_{23} - a_{31}a_{13}a_{33}$\n$N = a_{23}(a_{11}a_{23} - a_{21}a_{13}) + a_{33}(a_{11}a_{33} - a_{31}a_{13})$\n\n分母是 $\\det(G) = (a_{11}^2+a_{21}^2+a_{31}^2)(a_{13}^2+a_{23}^2+a_{33}^2) - (a_{11}a_{13}+a_{21}a_{23}+a_{31}a_{33})^2$。根据拉格朗日恒等式 $(\\sum x_i^2)(\\sum y_i^2) - (\\sum x_i y_i)^2 = \\sum_{1 \\le i  j \\le n} (x_i y_j - x_j y_i)^2$，这个分母可以展开为 $(a_{11}a_{23}-a_{21}a_{13})^2 + (a_{11}a_{33}-a_{31}a_{13})^2 + (a_{21}a_{33}-a_{31}a_{23})^2$。",
                "answer": "$$ \\boxed{\\frac{a_{23}(a_{11}a_{23} - a_{21}a_{13}) + a_{33}(a_{11}a_{33} - a_{31}a_{13})}{(a_{21}a_{33} - a_{31}a_{23})^2 + (a_{31}a_{13} - a_{11}a_{33})^2 + (a_{11}a_{23} - a_{21}a_{13})^2}} $$",
                "id": "1029919"
            },
            {
                "introduction": "现在我们知道了*如何*构建 SPAI 预处理器，这个练习将探讨*为什么*它通常是一种有效的策略。通过分析块三对角矩阵的逆，这是科学计算中一种常见的结构，您将推导出逆矩阵的非对角元素的大小通常会衰减的性质 [@problem_id:3263474]。这种衰减特性是使用稀疏矩阵来近似一个通常是稠密的逆矩阵的关键理由，为 SPAI 方法提供了强有力的理论动机。",
                "problem": "考虑一个由块大小为 $m$ 的一维最近邻耦合产生的块三对角线性系统，其系数矩阵 $T \\in \\mathbb{R}^{(nm)\\times(nm)}$ 具有以下形式\n$$\nT \\;=\\; \n\\begin{pmatrix}\nA_{1}  B_{1}  0  \\cdots  0 \\\\\nC_{1}  A_{2}  B_{2}  \\ddots  \\vdots \\\\\n0  C_{2}  A_{3}  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  B_{n-1} \\\\\n0  \\cdots  0  C_{n-1}  A_{n}\n\\end{pmatrix},\n$$\n其中每个 $A_{i} \\in \\mathbb{R}^{m\\times m}$ 都是非奇异的，并且 $B_{i}, C_{i} \\in \\mathbb{R}^{m\\times m}$。假设 $T$ 是对称正定（SPD）的，因此 $C_{i} = B_{i}^{\\mathsf{T}}$ 且每个 $A_{i}$ 都是对称正定的。\n\n- 仅从舒尔补和块高斯消元法的定义出发，推导出一个块下-对角-上 (LDU) 分解 $T = L D U$，其中 $L$ 是单位下块双对角矩阵，$U$ 是单位上块双对角矩阵，$D$ 是块对角矩阵。写出定义 $D$ 中对角舒尔补以及 $L$ 和 $U$ 中次对角和超对角因子的块递推关系。\n\n- 使用 $T^{-1} = U^{-1} D^{-1} L^{-1}$ 和严格块双对角矩阵的幂零性，写出 $T^{-1}$ 的 $(i,j)$ 块关于双对角因子和 $D^{-1}$ 的对角块乘积的通用公式。解释为什么对于具有最近邻耦合的 SPD 问题，非对角块 $|(T^{-1})_{ij}|$ 的大小通常随着 $|i-j|$ 的增加而衰减，从而为只保留 $T^{-1}$ 的固定块带宽的稀疏近似逆 (SAI) 预条件子提供理据。\n\n- 现在，特化到标量情况 $m=1$ 和 $n=3$，矩阵为\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n通过仅保留精确逆 $A^{-1}$ 的三对角模板（即满足 $|i-j|\\leq 1$ 的元素）来定义稀疏近似逆 (SAI) 预条件子 $M$。计算弗罗贝尼乌斯范数 $\\|A^{-1} - M\\|_{F}$，并以精确表达式给出最终答案。不要四舍五入。",
                "solution": "该问题由三部分组成。我们将依次处理每个部分。\n\n### 第一部分：块 LDU 分解\n\n我们寻求一个块 LDU 分解 $T = LDU$，其中 $L, D, U$ 分别是单位下块双对角矩阵、块对角矩阵和单位上块双对角矩阵。它们的形式如下：\n$$\nL = \n\\begin{pmatrix}\nI  0  \\cdots  0 \\\\\n\\mathcal{L}_{1}  I  \\ddots  \\vdots \\\\\n\\vdots  \\ddots  \\ddots  0 \\\\\n0  \\cdots  \\mathcal{L}_{n-1}  I\n\\end{pmatrix}, \\quad\nD = \n\\begin{pmatrix}\nD_{1}  0  \\cdots  0 \\\\\n0  D_{2}  \\ddots  \\vdots \\\\\n\\vdots  \\ddots  \\ddots  0 \\\\\n0  \\cdots  0  D_{n}\n\\end{pmatrix}, \\quad\nU = \n\\begin{pmatrix}\nI  \\mathcal{U}_{1}  \\cdots  0 \\\\\n0  I  \\ddots  \\vdots \\\\\n\\vdots  \\ddots  \\ddots  \\mathcal{U}_{n-1} \\\\\n0  \\cdots  0  I\n\\end{pmatrix}\n$$\n通过将 $T$ 的块与乘积 $LDU$ 的块进行比较，我们得到以下递推关系：\n\\begin{itemize}\n    \\item $D_1 = A_1$\n    \\item 对于 $i = 1, \\ldots, n-1$： $\\mathcal{U}_i = D_i^{-1} B_i$ 且 $\\mathcal{L}_i = C_i D_i^{-1}$\n    \\item 对于 $i = 2, \\ldots, n$： $D_i = A_i - \\mathcal{L}_{i-1}D_{i-1}\\mathcal{U}_{i-1} = A_i - C_{i-1}D_{i-1}^{-1}B_{i-1}$\n\\end{itemize}\n由于 $T$ 是 SPD，所有主子矩阵都是非奇异的，这确保了每个 $D_i$ 都是可逆的，因此这个过程是适定的。\n\n### 第二部分：逆的结构与 SAI 的动机\n\n逆矩阵可以表示为 $T^{-1} = U^{-1}D^{-1}L^{-1}$。$L$ 和 $U$ 可以写成 $L = I + \\mathbb{L}$ 和 $U = I + \\mathbb{U}$，其中 $\\mathbb{L}$ 和 $\\mathbb{U}$ 是严格块双对角矩阵。它们的逆可以通过诺伊曼级数得到：\n$$ L^{-1} = (I+\\mathbb{L})^{-1} = \\sum_{k=0}^{n-1} (-\\mathbb{L})^k \\quad \\text{和} \\quad U^{-1} = (I+\\mathbb{U})^{-1} = \\sum_{k=0}^{n-1} (-\\mathbb{U})^k $$\n$\\mathbb{L}^k$ 的 $(i,j)$ 块仅当 $i-j=k$ 时非零，$\\mathbb{U}^k$ 的 $(i,j)$ 块仅当 $j-i=k$ 时非零。$T^{-1}$ 的 $(i,j)$ 块是多个项的和，但对于上三角部分（$j>i$），其表达式可以简化为：\n$$ (T^{-1})_{ij} = (-1)^{j-i} (U^{-1})_{i,i+1} \\cdots (U^{-1})_{j-1,j} D_j^{-1} = (-1)^{j-i} (\\mathcal{U}_i \\mathcal{U}_{i+1} \\cdots \\mathcal{U}_{j-1}) D_j^{-1} $$\n类似地，对于下三角部分（$i>j$）：\n$$ (T^{-1})_{ij} = D_i^{-1} (-1)^{i-j} (\\mathcal{L}_{i-1} \\mathcal{L}_{i-2} \\cdots \\mathcal{L}_{j}) $$\n对于许多源自局部相互作用（如 PDE 离散化）的问题，对角块 $A_i$ 是“占优”的，这意味着 $\\|B_k\\|$ 和 $\\|C_k\\|$ 相对于 $\\|A_k\\|$ 较小。这导致 $\\|\\mathcal{U}_k\\| = \\|D_k^{-1}B_k\\|$ 和 $\\|\\mathcal{L}_k\\| = \\|C_kD_k^{-1}\\|$ 的范数通常小于 1。因此，随着距离 $|i-j|$ 的增加，上述乘积的范数会呈指数级衰减。这表明 $T^{-1}$ 的远非对角块很小，为使用稀疏矩阵（如带状矩阵）来近似它提供了理论依据。\n\n### 第三部分：具体计算\n\n对于矩阵\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}\n$$\n我们首先计算其精确逆。行列式 $\\det(A) = 2(4-1) - (-1)(-2) = 4$。\n$$\nA^{-1} = \\frac{1}{4} \\begin{pmatrix}\n3  2  1 \\\\\n2  4  2 \\\\\n1  2  3\n\\end{pmatrix}\n$$\n根据问题描述，稀疏近似逆预条件子 $M$ 是通过保留 $A^{-1}$ 的三对角部分来定义的：\n$$\nM = \\text{tridiag}(A^{-1}) = \\frac{1}{4} \\begin{pmatrix}\n3  2  0 \\\\\n2  4  2 \\\\\n0  2  3\n\\end{pmatrix}\n$$\n我们需要计算 $\\|A^{-1} - M\\|_{F}$。\n$$\nA^{-1} - M = \\frac{1}{4} \\begin{pmatrix}\n3  2  1 \\\\\n2  4  2 \\\\\n1  2  3\n\\end{pmatrix} - \\frac{1}{4} \\begin{pmatrix}\n3  2  0 \\\\\n2  4  2 \\\\\n0  2  3\n\\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix}\n0  0  1 \\\\\n0  0  0 \\\\\n1  0  0\n\\end{pmatrix}\n$$\n弗罗贝尼乌斯范数的平方为：\n$$\n\\|A^{-1} - M\\|_{F}^2 = \\left(\\frac{1}{4}\\right)^2 + \\left(\\frac{1}{4}\\right)^2 = \\frac{1}{16} + \\frac{1}{16} = \\frac{2}{16} = \\frac{1}{8}\n$$\n因此，弗罗贝尼乌斯范数为：\n$$\n\\|A^{-1} - M\\|_{F} = \\sqrt{\\frac{1}{8}} = \\frac{1}{2\\sqrt{2}} = \\frac{\\sqrt{2}}{4}\n$$",
                "answer": "$$\n\\boxed{\\frac{\\sqrt{2}}{4}}\n$$",
                "id": "3263474"
            },
            {
                "introduction": "最后一个练习处理一个在将 SPAI 预处理器应用于对称正定 (SPD) 系统时遇到的关键而微妙的问题，这类系统通常使用共轭梯度 (CG) 方法求解。您将发现，即使原始矩阵 $A$ 和构造的预处理器 $\\widehat{M}$ 都是对称的，预处理后的算子 $\\widehat{M}A$ 也可能不是对称的，从而违反了 CG 方法的一个基本要求 [@problem_id:3579956]。这个练习强调了确保预处理系统保持所选迭代求解器所需代数性质的重要性。",
                "problem": "令 $A \\in \\mathbb{R}^{n \\times n}$ 为对称正定 (SPD) 矩阵，并假设我们通过最小化 Frobenius 范数目标 $\\| I - M A \\|_{F}$ 来寻求一个右稀疏近似逆 (SPAI) 预条件子 $M \\in \\mathbb{R}^{n \\times n}$，其中 $M$ 受限于预设的稀疏模式。回顾以下基本事实。\n- 在标准欧几里得内积中，共轭梯度 (CG) 法要求系数矩阵是对称正定的。对于左预处理，数学上正确的预条件共轭梯度 (PCG) 公式通过在 $M$-内积中处理 SPD 预条件子 $M$ 来保持对称性，从而使得 $M^{-1}A$ 在该内积中是自伴的。\n- 如果尝试在欧几里得内积中对左预处理算子 $M A$ 运行 CG，那么 $M A$ 必须在欧几里得意义下是对称正定的。如果 $M$ 和 $A$ 都是对称的，这要求它们交换；否则 $M A$ 通常是非对称的，因此不是 SPD。\n- 在使用 Frobenius 范数的 SPAI 构造中，右近似逆问题 $\\min_{M} \\| I - M A \\|_{F}$ 按行解耦，因为 $\\| I - M A \\|_{F}^{2} = \\sum_{i=1}^{n} \\| e_{i}^{\\top} - r_{i}^{\\top} A \\|_{2}^{2}$，其中 $r_{i}^{\\top}$ 是 $M$ 的第 $i$ 行，每一行都可以在其自身的稀疏性约束下独立优化。\n\n考虑 SPD 三对角矩阵\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n按如下方式构造一个 SPAI $M$。使用右近似逆 Frobenius 目标 $\\min_{M} \\| I - M A \\|_{F}$，并采用以下逐行稀疏模式逐行求解：\n- $M$ 的第 $1$ 行支撑集为 $\\{1,2\\}$。\n- $M$ 的第 $2$ 行支撑集为 $\\{2\\}$。\n- $M$ 的第 $3$ 行支撑集为 $\\{2,3\\}$。\n将最小化得到的（通常非对称的）$M$ 进行后对称化处理，通过定义对称 SPAI $\\widehat{M} := \\tfrac{1}{2}(M + M^{\\top})$ 来强制对称性。\n\n任务：\n1. 从基本原理出发，推导在给定稀疏模式下由 $\\min_{M} \\| I - M A \\|_{F}$ 隐含的逐行最小二乘问题，并精确求解它们以获得 $M$ 的元素。\n2. 构造对称矩阵 $\\widehat{M} := \\tfrac{1}{2}(M + M^{\\top})$ 并计算乘积 $\\widehat{M} A$。\n3. 使用 CG 在欧几里得内积中要求对称性和正定性的基本要求，解释为什么即使 $A$ 和 $\\widehat{M}$ 都是对称的，将经典 CG 直接应用于 $\\widehat{M} A$ 也是不合理的。你的解释必须指明后对称化处理可能无法保持 $\\widehat{M} A$ 的对称性，从而无法满足 CG 所需的有效 SPD 属性的机制。\n4. 作为有效对称性损失的定量证据，计算 $\\widehat{M} A$ 的反对称部分的 Frobenius 范数，即\n$$\n\\left\\| \\widehat{M} A - (\\widehat{M} A)^{\\top} \\right\\|_{F}.\n$$\n\n将你的最终答案表示为单个精确的最简分数（不要四舍五入）。",
                "solution": "该问题分为四个部分，我们将按顺序解决。\n\n### 任务 1：推导并求解逐行最小二乘问题\n\nSPAI 预条件子 $M$ 的构造旨在最小化 Frobenius 范数目标 $\\| I - M A \\|_{F}$。该目标函数可以按行解耦：\n$$\n\\min_{M} \\| I - M A \\|_{F}^{2} = \\min_{M} \\sum_{i=1}^{n} \\| e_{i}^{\\top} - r_{i}^{\\top} A \\|_{2}^{2}\n$$\n其中 $r_{i}^{\\top}$ 是 $M$ 的第 $i$ 行，$e_i^\\top$ 是单位矩阵 $I$ 的第 $i$ 行。对每行 $r_i^\\top$ 的最小化是一个独立的线性最小二乘问题。对于第 $i$ 行，设其非零元的列索引集为 $J_i$，非零值向量为 $x_i$。该问题等价于求解 $\\min_{x_i} \\| e_i - C_i x_i \\|_2^2$，其中 $C_i$ 的列是 $A^T$ 中由 $J_i$ 索引的列。解由正规方程 $(C_i^T C_i) x_i = C_i^T e_i$ 给出。\n\n矩阵 $A$ 如下：\n$$\nA = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}\n$$\n\n**第 1 行：** 稀疏模式为 $J_1 = \\{1, 2\\}$，待求变量为 $x_1 = \\begin{pmatrix} m_{11} \\\\ m_{12} \\end{pmatrix}$。\n我们求解 $\\min \\| e_1 - C_1 x_1 \\|_2^2$，其中 $C_1$ 由 $A$ 的第1和第2列构成：$C_1 = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\\\ 0  -1 \\end{pmatrix}$。\n正规方程系统为：\n$C_1^T C_1 = \\begin{pmatrix} 5  -4 \\\\ -4  6 \\end{pmatrix}$， $C_1^T e_1 = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$。\n求解 $\\begin{pmatrix} 5  -4 \\\\ -4  6 \\end{pmatrix} \\begin{pmatrix} m_{11} \\\\ m_{12} \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$，得到 $m_{11} = \\frac{4}{7}$，$m_{12} = \\frac{3}{14}$。\n\n**第 2 行：** 稀疏模式为 $J_2 = \\{2\\}$，待求变量为 $x_2 = (m_{22})$。\n$C_2$ 是 $A$ 的第2列：$C_2 = \\begin{pmatrix} -1 \\\\ 2 \\\\ -1 \\end{pmatrix}$。\n正规方程为 $(C_2^T C_2) m_{22} = C_2^T e_2$，即 $6 m_{22} = 2$，得到 $m_{22} = \\frac{1}{3}$。\n\n**第 3 行：** 稀疏模式为 $J_3 = \\{2, 3\\}$，待求变量为 $x_3 = \\begin{pmatrix} m_{32} \\\\ m_{33} \\end{pmatrix}$。\n$C_3$ 由 $A$ 的第2和第3列构成：$C_3 = \\begin{pmatrix} -1  0 \\\\ 2  -1 \\\\ -1  2 \\end{pmatrix}$。\n正规方程系统为：\n$C_3^T C_3 = \\begin{pmatrix} 6  -4 \\\\ -4  5 \\end{pmatrix}$， $C_3^T e_3 = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$。\n求解 $\\begin{pmatrix} 6  -4 \\\\ -4  5 \\end{pmatrix} \\begin{pmatrix} m_{32} \\\\ m_{33} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}$，得到 $m_{32} = \\frac{3}{14}$，$m_{33} = \\frac{4}{7}$。\n\n综上，矩阵 $M$ 是：\n$$\nM = \\begin{pmatrix}\n\\frac{4}{7}  \\frac{3}{14}  0 \\\\\n0  \\frac{1}{3}  0 \\\\\n0  \\frac{3}{14}  \\frac{4}{7}\n\\end{pmatrix}\n$$\n\n### 任务 2：构造 $\\widehat{M}$ 并计算 $\\widehat{M}A$\n\n对称预条件子 $\\widehat{M}$ 定义为 $\\widehat{M} = \\frac{1}{2}(M + M^{\\top})$。\n$$\n\\widehat{M} = \\frac{1}{2} \\left( \\begin{pmatrix}\n\\frac{4}{7}  \\frac{3}{14}  0 \\\\\n0  \\frac{1}{3}  0 \\\\\n0  \\frac{3}{14}  \\frac{4}{7}\n\\end{pmatrix} + \\begin{pmatrix}\n\\frac{4}{7}  0  0 \\\\\n\\frac{3}{14}  \\frac{1}{3}  \\frac{3}{14} \\\\\n0  0  \\frac{4}{7}\n\\end{pmatrix} \\right) = \\begin{pmatrix}\n\\frac{4}{7}  \\frac{3}{28}  0 \\\\\n\\frac{3}{28}  \\frac{1}{3}  \\frac{3}{28} \\\\\n0  \\frac{3}{28}  \\frac{4}{7}\n\\end{pmatrix}\n$$\n现在，我们计算乘积 $\\widehat{M} A$：\n$$\n\\widehat{M} A = \\begin{pmatrix}\n\\frac{4}{7}  \\frac{3}{28}  0 \\\\\n\\frac{3}{28}  \\frac{1}{3}  \\frac{3}{28} \\\\\n0  \\frac{3}{28}  \\frac{4}{7}\n\\end{pmatrix}\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{29}{28}  -\\frac{5}{14}  -\\frac{3}{28} \\\\\n-\\frac{5}{42}  \\frac{19}{42}  -\\frac{5}{42} \\\\\n-\\frac{3}{28}  -\\frac{5}{14}  \\frac{29}{28}\n\\end{pmatrix}\n$$\n\n### 任务 3：关于不对 $\\widehat{M}A$ 使用 CG 的理由\n\n经典的共轭梯度 (CG) 法旨在求解线性系统 $B x = b$，其中算子 $B$ 在欧几里得内积中是对称正定 (SPD) 的。因此，将 CG 应用于带有算子 $\\widehat{M} A$ 的左预处理系统，要求 $\\widehat{M}A$ 是 SPD 的。\n\n一个矩阵成为 SPD 的一个必要条件是它必须是对称的。我们来检查 $\\widehat{M} A$ 是否对称。乘积的转置是 $(\\widehat{M} A)^\\top = A^\\top \\widehat{M}^\\top$。根据构造，$A$ 是对称的 ($A^\\top = A$) 且 $\\widehat{M}$ 是对称的 ($\\widehat{M}^\\top = \\widehat{M}$)。因此，$(\\widehat{M} A)^\\top = A \\widehat{M}$。为了使 $\\widehat{M} A$ 对称，我们必须有 $\\widehat{M} A = A \\widehat{M}$，这意味着矩阵 $\\widehat{M}$ 和 $A$ 必须交换。\n\nSPAI 构造过程并没有对得到的预条件子强制施加任何能保证其与 $A$ 交换的代数性质。后对称化步骤 $\\widehat{M} = \\frac{1}{2}(M+M^\\top)$ 强制了预条件子本身的对称性，但通常两个对称矩阵的乘积并不对称，除非它们交换。从任务 2 的结果可以看出，$\\widehat{M} A$ 不是对称的。例如，$(\\widehat{M} A)_{12} = -\\frac{5}{14}$ 而 $(\\widehat{M} A)_{21} = -\\frac{5}{42}$。由于 $(\\widehat{M} A)_{12} \\neq (\\widehat{M} A)_{21}$，矩阵 $\\widehat{M}A$ 不是对称的，因此不可能是 SPD。所以，应用经典 CG 方法是不合理的。\n\n### 任务 4：不对称性的定量证据\n\n我们计算反对称部分 $S = \\widehat{M} A - (\\widehat{M} A)^{\\top}$ 的 Frobenius 范数。\n$$\n(\\widehat{M} A)^{\\top} = (A^\\top \\widehat{M}^\\top) = A\\widehat{M} = \\begin{pmatrix}\n\\frac{29}{28}  -\\frac{5}{42}  -\\frac{3}{28} \\\\\n-\\frac{5}{14}  \\frac{19}{42}  -\\frac{5}{14} \\\\\n-\\frac{3}{28}  -\\frac{5}{42}  \\frac{29}{28}\n\\end{pmatrix}\n$$\n差分矩阵 $S$ 是：\n$$\nS = \\widehat{M} A - (\\widehat{M} A)^{\\top} = \\begin{pmatrix}\n0  -\\frac{5}{14} - (-\\frac{5}{42})  0 \\\\\n-\\frac{5}{42} - (-\\frac{5}{14})  0  -\\frac{5}{42} - (-\\frac{5}{14}) \\\\\n0  -\\frac{5}{14} - (-\\frac{5}{42})  0\n\\end{pmatrix}\n$$\n计算非零元素：\n$S_{12} = -\\frac{15}{42} + \\frac{5}{42} = -\\frac{10}{42} = -\\frac{5}{21}$。\n$S_{21} = -S_{12} = \\frac{5}{21}$。\n$S_{23} = -\\frac{5}{42} + \\frac{15}{42} = \\frac{10}{42} = \\frac{5}{21}$。\n$S_{32} = -S_{23} = -\\frac{5}{21}$。\n斜对称矩阵为：\n$$\nS = \\begin{pmatrix}\n0  -\\frac{5}{21}  0 \\\\\n\\frac{5}{21}  0  \\frac{5}{21} \\\\\n0  -\\frac{5}{21}  0\n\\end{pmatrix}\n$$\nFrobenius 范数 $\\|S\\|_{F}$ 是其元素平方和的平方根：\n$$\n\\|S\\|_{F}^2 = \\sum_{i,j} S_{ij}^2 = \\left(-\\frac{5}{21}\\right)^2 + \\left(\\frac{5}{21}\\right)^2 + \\left(\\frac{5}{21}\\right)^2 + \\left(-\\frac{5}{21}\\right)^2 = 4 \\left( \\frac{5}{21} \\right)^2 = \\frac{100}{441}\n$$\n取平方根得到 Frobenius 范数：\n$$\n\\|S\\|_{F} = \\sqrt{\\frac{100}{441}} = \\frac{10}{21}\n$$\n这个非零值提供了 $\\widehat{M} A$ 不对称的定量证据。",
                "answer": "$$\n\\boxed{\\frac{10}{21}}\n$$",
                "id": "3579956"
            }
        ]
    }