## 一个简单想法的超常效用：QUBO 的实际应用

在上一章中，我们解析了一个名为 QUBO（二次无约束二元优化）的奇特数学构造。表面上看，它不过是一个变量只能取 $0$ 或 $1$ 的多项式。您可能会忍不住问：“那又怎样？最小化这样的东西有什么用？” 事实证明，答案惊人地广阔：从瞬息万变的金融世界到细胞内错综复杂的生命之舞，这个简单的公式一次又一次地出现。这仿佛我们偶然发现了一把万能钥匙，一块奇妙的罗塞塔石碑，它能将科学殿堂中不同房间里的问题翻译成一种单一的通用语言。

本章将是对这些房间的一次盛大巡礼。我们将看到这同一个想法如何为[投资组合管理](@article_id:308149)中的挑战提供了统一的框架，为观察我们自身 DNA 的秘密提供了新的视角，为设计未来的材料提供了工具，甚至为通往深奥的量子力学世界本身架起了一座桥梁。准备好被隐藏在这个简单二次表达式中的深刻统一性所震撼吧。

### 选择的艺术：从金融投资组合到贝叶斯采样

让我们从一个我们都能感同身受的世界开始：金钱。想象一下，您是一位基金经理，面对着一个由潜在资产——股票、债券、大宗商品——构成的宇宙。您的目标在原则上简单，但在实践中却异常复杂：从中挑选一部分来构建一个投资组合，以最大化您的预期回报，同时最小化您的风险。

对于每项资产，“买入或不买入”的决策是一个天然的二元选择，非常适合用 QUBO 变量 $x_i \in \{0, 1\}$ 来表示。您所选资产的预期回报可以表示为一个简单的线性求和——每项被选中的资产都将其潜在回报加到总和中。这构成了我们 QUBO 的线性部分。但资产并非孤立存在。它们的价格以相互关联的方式变动；一家航空公司股票的成功可能与石油价格挂钩。这种相互关联的风险，即资产之间的“成对协同或冲突”，由[协方差矩阵](@article_id:299603)捕捉。当我们将此转化为我们的能量函数时，这些[协方差](@article_id:312296)项自然就成为了 QUBO 的二次部分，即与 $x_i x_j$ 成比例的项 ()。我们的目标由此诞生：最小化一个代表风险减去回报的函数。

那么现实世界的规则呢？也许您被要求*恰好*选择十项资产。我们如何教会我们抽象的数学函数这样一个具体的规则？答案是一个非常优雅的技巧：我们添加一个“惩罚函数”。考虑表达式 $(\sum_{i} x_i - 10)^2$。如果我们恰好选择十项资产，这整个项就变为零。如果我们选择任何其他数量，该项就会成为一个大的正数——一个惩罚。通过将这个二次惩罚项添加到我们的能量函数中，我们确保优化器找到的任何低能量解都将*自动*满足我们的约束，而无需我们明确地强制执行它 ()。

这个想法惊人地强大。但优化——寻找唯一的“最佳”答案——并非故事的全部。有时，不存在一个完美的投资组合，而是一整个由非常好的投资组合构成的景观。我们可能想要了解可能性的*范围*。我们可以不要求[能量景观](@article_id:308140)中的唯一最低点，而是要求一张低洼地带的统计地图。这就是从优化到**采样**的转变。

在这里，QUBO 与物理学的一个基石：[统计力](@article_id:373880)学联系起来。通过将 QUBO 能量函数 $E(z)$ 视为一个物理系统的“势能”，我们可以为每种可能的[投资组合选择](@article_id:641456) $z$ 定义一个概率：著名的玻尔兹曼分布，$p(z) \propto \exp(-E(z)/T)$。能量较低的状态呈指数级地更可能出现，但能量较高的“山谷”中的状态并非不可能，只是概率较低。像[量子退火](@article_id:302047)器这样的设备，在有限的“有效温度” $T_{\text{eff}}$ 下运行时，正是这样做的。它不只是落到绝对的最低能量；它探索景观并返回反映这种[概率分布](@article_id:306824)的样本 ()。

这揭示了一个深刻的原理：QUBO 公式不仅能让我们捕捉到唯一的最佳选择，还能捕捉到所有可能的合理解，并根据其优劣程度进行加权。而且因为[概率分布](@article_id:306824)只关心能量的*差异*，所以给整个景观增加一个常数偏移量对结果完全没有影响，这对任何由[统计力](@article_id:373880)学描述的系统来说都是一个基本真理 。

### 生命的蓝图：QUBO 在生物学和医学中的应用

离开交易大厅，我们现在进入细胞核，在那里，大自然已经解决了数十亿年的优化问题。值得注意的是，同样的数学语言在这里同样有效。

考虑比较两个[基因序列](@article_id:370112)的任务，比如来自人类和黑猩猩的序列。在这些由 A、C、G 和 T 组成的长字符串之间找到最佳比对，可以揭示进化历史，识别功能区域，并帮助我们理解疾病。这种比对可以在一个二维网格上可视化为一条路径，其中对角线步骤表示两个字母匹配（或不匹配），而水平或垂直步骤表示在其中一个序列中引入了[空位](@article_id:308249)。 “最佳”路径是得分最高的路径，得分根据匹配的奖励以及不匹配和[空位](@article_id:308249)的惩罚计算得出。这个路径寻找问题可以直接转化为 QUBO。网格上的每个可能步骤都成为一个[二元变量](@article_id:342193)，能量函数由分数和一系列确保所选步骤形成从起点到终点的单一连续路径的二次惩罚构成 ()。这个 QUBO 的最低能量构型对应于两个序列的最优比对。

细胞本身执行着一个更复杂的优化。我们 DNA 中的单个基因通常是一个模块化的配方，由必需的片段（[外显子](@article_id:304908)）和可选的片段组成。通过一个称为**可变剪接**的过程，细胞可以混合和匹配这些片段，从单个基因产生出惊人多样的不同蛋白质（异构体）。这是生物体复杂性的主要来源。我们可以通过提问来模拟这个过程：在所有可能的组合中，哪种异构体是“生物学上最可能”产生的？这变成了一个关于选择的优化问题。我们可以为每个可选片段分配一个[二元变量](@article_id:342193)，并构建一个 QUBO，其中线性项反映每个片段的内在“合意性”，二次项则惩罚不相容的配对 ()。这个 QUBO 的[基态](@article_id:312876)代表了最可能的 mRNA 异构体——获胜的配方。

也许[计算生物学](@article_id:307404)中最宏大的挑战是蛋白质折叠。蛋白质是一长串氨基酸，必须折叠成精确的三维形状才能发挥功能。根据序列预测这种形状是一个圣杯。一个相关的问题，**[蛋白质穿线](@article_id:347588)**，是问一个给定的氨基酸序列如何适应一个已知的 3D 结构模板。这是一个极其困难的[双射](@article_id:298541)[分配问题](@article_id:323355)——每个氨基酸必须被放置在唯一的一个位置，每个位置也必须被唯一的一个氨基酸占据。再一次，这可以被构建成一个 QUBO ()。能量函数包含用于衡量将特定氨基酸放置在特定位置的适应性的线性项，以及捕捉在折叠结构中最终彼此靠近的氨基酸对之间关键相互作用的二次项。解决这个 QUBO 等同于解决臭名昭著的二次[分配问题](@article_id:323355)（Quadratic Assignment Problem）的一个实例，这是整个计算机科学中最难啃的硬骨头之一。

### 铸就未来：材料、物理与混合计算

QUBO 的影响范围延伸到物理科学领域，在那里它帮助我们理解和设计构成我们世界的材料。在[材料科学](@article_id:312640)中，我们经常分析合金或陶瓷的显微镜图像以了解其特性。这些图像显示出晶粒的拼凑图，一项关键任务是对图像进行分割，为每个像素分配一个标签（代表晶体的取向）。

这个分割问题是**Potts 模型**的一个经典应用，这是[统计物理学](@article_id:303380)中[伊辛模型](@article_id:299514)的著名推广。而 Potts 模型有一个自然的 QUBO 表示 ()。我们用一组[二元变量](@article_id:342193)来表示每个像素的可能标签。需要最小化的总能量有两个组成部分：一个“邻里”项，其中两个像素之间边界的能量成本取决于它们的标签；以及一个“自我认同”惩罚项，确保每个像素只确定一个标签。找到 QUBO 的[基态](@article_id:312876)揭示了[微观结构](@article_id:309020)的最优分割，将一幅杂乱的图像变成一张清晰、定量的地图。

然而，与物理学的联系更为深刻，一直延伸到 Richard Feynman 自己的量子力学路径积分形式。量子理论的一个核心思想是，一个粒子从 A 点移动到 B 点，并不仅仅走一条路径；在某种意义上，它同时探索所有可能的路径。在有限温度下，通过一个优美的数学同构，这种量子行为可以映射到一个经典对象上：一个“[环状聚合物](@article_id:308176)”。单个量子粒子的行为就像一条由 $P$ 个经典珠子 $\{q_i\}$ 组成的项链，这些珠子由谐振弹簧连接。项链呈现特定形状的概率由一个势能决定，该势能包括每个珠子上的外力加上所有弹簧的拉伸能，其形式为二次的 $\sum (q_i - q_{i+1})^2$。

这个势能景观可以映射到一个伊辛或 QUBO 模型 。每个珠子的位置使用[二元变量](@article_id:342193)编码。二次弹簧项完美地映射到代表相邻珠子的[量子比特](@article_id:298377)之间的成对相互作用。如果外部势 $V(q)$ 比二次函数更复杂，其 QUBO 表示将涉及更高阶的相互作用，而这又可以通过巧妙地引入辅助“ancilla”[量子比特](@article_id:298377)来简化为二次形式。这提供了一个惊人的洞见：像[量子退火](@article_id:302047)器这样的 QUBO 求解器原则上可以通过采样其经典项链表示的形状来采样量子粒子的平衡构型。这也阐明了该工具的局限性：退火器可以告诉我们可能的*静态形状*（平衡采样），但无法模拟项链随时间推移的*摆动和[振动](@article_id:331484)*（动力学）。

最后，QUBO 并不总是需要解决整个问题。它也可以在混合计算方案中充当一个专门的协处理器。考虑 GMRES 方法，这是一种用于求解大型[线性方程组](@article_id:309362)的主力经典[算法](@article_id:331821)。在其迭代过程的深处，埋藏着一个虽小但密集的最小二乘优化子问题。尽管尚属推测，但可以想象未来，这个特定的子问题被翻译成一个 QUBO——通过将连续变量[离散化](@article_id:305437)为二元表示——然后交给量子设备快速求解 ()。这指向了一个[混合量子-经典算法](@article_id:361490)的未来，我们为工作的每个部分使用最佳工具。

### 一条统一的线索

我们的巡礼至此结束。从股票到蛋白质，从晶粒到量子路径，我们看到了同一个简单的思想作为一种强大、统一的语言出现。这个由[二元变量](@article_id:342193)组成的简单二次函数 $E = \mathbf{x}^\top Q \mathbf{x}$，结果证明是一个能够承载巨大复杂性的容器。它证明了科学深层且常常令人惊讶的统一性。为大型、现实世界问题实际构建能够解决这些 QUBO 的硬件，是我们这个时代的巨大工程挑战。但正如我们所见，蓝图已经存在，用一种连大自然本身似乎都理解的数学语言写就。旅程才刚刚开始。