{"hands_on_practices": [{"introduction": "我们从龙贝格积分的基本机理开始。第一个练习将指导你手动计算龙贝格表中的初始条目。通过亲手应用梯形法则和理查森外推的第一步，你将对如何生成和改进近似值有一个具体的理解。[@problem_id:2198730]", "problem": "龙贝格积分是一种数值方法，它通过对梯形法则的结果应用理查森外推法来估计函数的定积分。这些估计值被组织在一个称为龙贝格表的三角形数组中，记为 $R_{k,j}$。第一列 $R_{k,1}$ (对于 $k \\geq 1$) 是使用具有 $n = 2^{k-1}$ 个子区间的复化梯形法则生成的。后续各项使用以下递推公式计算：\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\n考虑多项式函数 $f(x) = 4x^3 - 3x^2 + 5$ 在区间 $[0, 2]$ 上的定积分。您的任务是手动计算此积分的龙贝格表的前三项。\n\n计算 $R_{1,1}$、$R_{2,1}$ 和 $R_{2,2}$ 的值。请将您的答案以这三个数值 $(R_{1,1}, R_{2,1}, R_{2,2})$ 组成的行向量形式给出，并表示为精确整数。", "solution": "我们对函数 $f(x)=4x^{3}-3x^{2}+5$ 在区间 $[a,b]=[0,2]$ 上进行积分。具有 $n$ 个子区间且宽度为 $h=\\frac{b-a}{n}$ 的复化梯形法则是\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\n根据定义，$R_{k,1}=T_{2^{k-1}}$。\n\n对于 $R_{1,1}$，取 $n=1$，因此步长 $h=2$。计算 $f(0)=5$ 和 $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$。于是\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\n对于 $R_{2,1}$，取 $n=2$，因此步长 $h=1$，节点为 $0,1,2$。计算 $f(1)=4-3+5=6$。于是\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\n龙贝格外推法使用以下公式\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\n因此，\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\n作为一致性检验，该积分的精确值为\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left[x^{4}-x^{3}+5x\\right]\\bigg|_{0}^{2}=16-8+10=18,\n$$\n该结果与 $R_{2,2}$ 一致，这对于三次多项式是符合预期的。", "answer": "$$\\boxed{\\begin{pmatrix}30 & 21 & 18\\end{pmatrix}}$$", "id": "2198730"}, {"introduction": "掌握了计算过程后，一个自然的问题是：为什么要使用龙贝格积分而不是更简单的方法？这个实践将展示该方法的卓越效率，这也是它在科学计算中被广泛应用的关键原因。你将比较龙贝格积分达到特定精度所需的函数求值次数与基本梯形法则所需的次数，从而凸显其显著的计算优势。[@problem_id:2198711]", "problem": "一个用于分析高斯脉冲的信号处理算法需要精确计算积分 $I = \\int_0^1 \\exp(-x^2) dx$。已知该积分的精确值约为 $I_{true} = 0.746824133$。\n\n为完成此任务，正在考虑两种数值方法：龙贝格积分法和复化梯形法则。\n\n首先，使用龙贝格积分法计算近似值，记为 $R_{3,3}$。\n    \n接着，计算 $R_{3,3}$ 近似值相对于 $I_{true}$ 的绝对误差。然后，确定复化梯形法则需要的最少子区间数（我们称之为 $n_{trap}$），以保证其绝对误差小于或等于您为 $R_{3,3}$ 计算出的误差。\n\n计算 $R_{3,3}$ 需要对 $\\exp(-x^2)$ 进行多少次独立的函数求值？复化梯形法则又需要多少次函数求值（$n_{trap}+1$）？\n\n请以两个整数形式给出您的答案：龙贝格方法的求值次数，后跟复化梯形法则的求值次数。", "solution": "问题要求两个值：计算 $I = \\int_0^1 \\exp(-x^2) dx$ 的龙贝格积分近似值 $R_{3,3}$ 所需的函数求值次数，以及复化梯形法则要达到相当精度所需的函数求值次数。\n\n首先，我们处理龙贝格积分部分。计算 $R_{3,3}$ 需要构建一个 3x3 的龙贝格表。该表的第一列 $R_{1,1}, R_{2,1}, R_{3,1}$ 分别是使用 $n=2^{1-1}=1$、$n=2^{2-1}=2$ 和 $n=2^{3-1}=4$ 个子区间的复化梯形法则得到的近似值。使用的最多子区间数为 $n=4$。在区间 $[0,1]$ 上使用 $n=4$ 的复化梯形法则，需要计算函数 $f(x) = \\exp(-x^2)$ 在点 $x_i = 0 + i \\cdot \\frac{1-0}{4}$（其中 $i=0, 1, 2, 3, 4$）处的值。这些点是 $0, 0.25, 0.5, 0.75, 1$。这总共构成了 5 次独立的函数求值。由于 $n=1$ 和 $n=2$ 时的求值点是这些点的子集，因此计算 $R_{3,3}$ 所需的函数求值总次数为 5。\n\n现在，我们计算龙贝格表中的值。令 $f(x) = \\exp(-x^2)$。\n所需的函数值为：\n$f(0) = \\exp(0) = 1$\n$f(0.25) = \\exp(-0.0625) \\approx 0.939413115$\n$f(0.5) = \\exp(-0.25) \\approx 0.778800783$\n$f(0.75) = \\exp(-0.5625) \\approx 0.569782825$\n$f(1) = \\exp(-1) \\approx 0.367879441$\n\n龙贝格表的第一列 ($R_{i,1}$) 使用复化梯形法则计算：\n$R_{1,1}$ (n=1, h=1): $\\frac{1}{2}(f(0) + f(1)) = \\frac{1}{2}(1 + 0.367879441) = 0.683939721$\n$R_{2,1}$ (n=2, h=0.5): $\\frac{0.5}{2}(f(0) + 2f(0.5) + f(1)) = 0.25(1 + 2(0.778800783) + 0.367879441) = 0.731370252$\n$R_{3,1}$ (n=4, h=0.25): $\\frac{0.25}{2}(f(0) + 2(f(0.25)+f(0.5)+f(0.75)) + f(1)) = 0.125(1 + 2(0.939413115+0.778800783+0.569782825) + 0.367879441) = 0.742984111$\n\n接下来，我们使用理查森外推公式 $R_{i,j} = R_{i, j-1} + \\frac{R_{i, j-1} - R_{i-1, j-1}}{4^{j-1}-1}$ 来计算其他项。\n对于 $j=2$：\n$R_{2,2} = R_{2,1} + \\frac{R_{2,1} - R_{1,1}}{4^{1}-1} = 0.731370252 + \\frac{0.731370252 - 0.683939721}{3} = 0.747180432$\n$R_{3,2} = R_{3,1} + \\frac{R_{3,1} - R_{2,1}}{4^{1}-1} = 0.742984111 + \\frac{0.742984111 - 0.731370252}{3} = 0.746855397$\n\n对于 $j=3$：\n$R_{3,3} = R_{3,2} + \\frac{R_{3,2} - R_{2,2}}{4^{2}-1} = 0.746855397 + \\frac{0.746855397 - 0.747180432}{15} = 0.746833765$\n\n$R_{3,3}$ 近似值的绝对误差为：\n$\\epsilon_{R_{3,3}} = |R_{3,3} - I_{true}| = |0.746833765 - 0.746824133| = 9.632 \\times 10^{-6}$。\n\n接下来，我们求复化梯形法则的误差不大于 $\\epsilon_{R_{3,3}}$ 时所需的子区间数 $n_{trap}$。复化梯形法则的误差界为 $|E_T| \\le \\frac{(b-a)^3}{12n^2} \\max_{x \\in [a,b]} |f''(x)|$。\n此处，$a=0$，$b=1$，且 $f(x) = \\exp(-x^2)$。\n我们需要求二阶导数 $f''(x)$：\n$f'(x) = -2x \\exp(-x^2)$\n$f''(x) = -2 \\exp(-x^2) + (-2x)(-2x \\exp(-x^2)) = (4x^2 - 2) \\exp(-x^2)$\n\n我们需要找到 $|f''(x)|$ 在区间 $[0,1]$ 上的最大值。我们来分析 $g(x) = f''(x)$。我们检查临界点和端点。\n为求临界点，我们对 $f''(x)$ 求导：\n$f'''(x) = 8x \\exp(-x^2) + (4x^2 - 2)(-2x \\exp(-x^2)) = (8x - 8x^3 + 4x)\\exp(-x^2) = (12x - 8x^3)\\exp(-x^2)$。\n令 $f'''(x)=0$ 得 $x=0$ 或 $12 - 8x^2 = 0 \\implies x^2 = 3/2 \\implies x = \\sqrt{3/2} \\approx 1.225$，该点在 $[0,1]$ 区间之外。\n所以我们只需要检查端点 $x=0$ 和 $x=1$ 处的 $|f''(x)|$ 值：\n$|f''(0)| = |(4(0)^2 - 2)\\exp(0)| = |-2| = 2$。\n$|f''(1)| = |(4(1)^2 - 2)\\exp(-1)| = |2e^{-1}| \\approx 0.7357$。\n$|f''(x)|$ 在 $[0,1]$ 上的最大值为 2。\n\n现在我们可以建立关于误差的不等式：\n$\\frac{(1-0)^3}{12n_{trap}^2} \\times 2 \\le \\epsilon_{R_{3,3}}$\n$\\frac{1}{6n_{trap}^2} \\le 9.632 \\times 10^{-6}$\n$n_{trap}^2 \\ge \\frac{1}{6 \\times 9.632 \\times 10^{-6}} \\approx 17303.4$\n$n_{trap} \\ge \\sqrt{17303.4} \\approx 131.54$\n由于 $n_{trap}$ 必须是整数，所需的最少子区间数为 $n_{trap}=132$。\n\n对于具有 $n_{trap}$ 个子区间的复化梯形法则，其函数求值次数为 $n_{trap}+1$。\n因此，求值次数为 $132 + 1 = 133$。\n\n总之，龙贝格方法 ($R_{3,3}$) 的函数求值次数为 5，而复化梯形法则要达到类似的误差保证所需的求值次数为 133。\n答案的两个整数是 5 和 133。", "answer": "$$\\boxed{\\begin{pmatrix} 5 & 133 \\end{pmatrix}}$$", "id": "2198711"}, {"introduction": "在实际应用中，我们不会无限地计算整个龙贝格表；我们需要一个规则来判断近似值何时“足够好”。最后一个练习引入了停止准则的概念，它将评估收敛性的过程自动化。通过监控龙贝格表对角线上连续高阶近似值之间的差异，你将学习如何在期望的容差 $ \\epsilon $ 范围内确定最佳结果，这模仿了该算法在软件库中的实现方式。[@problem_id:2198735]", "problem": "龙贝格积分是一种数值方法，它通过将理查森外推（Richardson extrapolation）应用于复合梯形法则的结果来提高积分近似的精度。该方法生成一个近似值的三角表，记为 $R_{k,j}$，其中 $k$ 是行索引（增加子区间数量），$j$ 是列索引（增加外推阶数）。\n\n表中的条目按如下方式生成：\n第一列 $R_{k,1}$ 由使用 $n = 2^{k-1}$ 个子区间的复合梯形法则得到的近似值组成。\n后续条目使用以下递归公式计算：\n$$R_{k,j} = R_{k,j-1} + \\frac{R_{k,j-1} - R_{k-1,j-1}}{4^{j-1}-1} \\quad \\text{for } k \\ge 2 \\text{ and } j \\ge 2$$\n对角线上的条目 $R_{k,k}$ 通常为给定数量的函数求值提供最准确的近似值。一种终止算法的常用策略是监控这些对角线条目的收敛性。\n\n考虑近似计算定积分 $I = \\int_{0}^{1} \\exp(x^2) dx$ 的任务。复合梯形法则的前四个近似值（$R_{k,1}$）已为您预先计算好：\n- $R_{1,1} = 1.859141$\n- $R_{2,1} = 1.571583$\n- $R_{3,1} = 1.490679$\n- $R_{4,1} = 1.469730$\n\n您的任务是构建龙贝格表，并根据一个特定的停止准则找到积分的最精确近似值。当两个连续对角线近似值之间的绝对差 $|R_{k,k} - R_{k-1,k-1}|$ 首次小于容差 $\\epsilon = 3 \\times 10^{-4}$ 时，应终止该过程。\n\n确定首次满足此条件的最终近似值 $R_{k,k}$ 的值。将您的最终答案四舍五入到六位有效数字。", "solution": "我们已知龙贝格递归公式\n$$\nR_{k,j} = R_{k,j-1} + \\frac{R_{k,j-1} - R_{k-1,j-1}}{4^{j-1}-1}, \\quad k \\ge 2,\\ j \\ge 2,\n$$\n其第一列条目来自复合梯形法则：\n$$\nR_{1,1}=1.859141,\\quad R_{2,1}=1.571583,\\quad R_{3,1}=1.490679,\\quad R_{4,1}=1.469730.\n$$\n我们逐列构建龙贝格表，并监控对角线条目 $R_{k,k}$，直到首次满足停止准则 $|R_{k,k}-R_{k-1,k-1}|<\\epsilon$（其中 $\\epsilon=3 \\times 10^{-4}$）。\n\n计算第二列（$j=2$，分母 $4^{1}-1=3$）：\n$$\nR_{2,2}=R_{2,1}+\\frac{R_{2,1}-R_{1,1}}{3}\n=1.571583+\\frac{1.571583-1.859141}{3}\n=1.4757303333333333,\n$$\n$$\nR_{3,2}=R_{3,1}+\\frac{R_{3,1}-R_{2,1}}{3}\n=1.490679+\\frac{1.490679-1.571583}{3}\n=1.463711,\n$$\n$$\nR_{4,2}=R_{4,1}+\\frac{R_{4,1}-R_{3,1}}{3}\n=1.469730+\\frac{1.469730-1.490679}{3}\n=1.462747.\n$$\n\n计算第三列（$j=3$，分母 $4^{2}-1=15$）：\n$$\nR_{3,3}=R_{3,2}+\\frac{R_{3,2}-R_{2,2}}{15}\n=1.463711+\\frac{1.463711-1.4757303333333333}{15}\n=1.4629097111111111,\n$$\n$$\nR_{4,3}=R_{4,2}+\\frac{R_{4,2}-R_{3,2}}{15}\n=1.462747+\\frac{1.462747-1.463711}{15}\n=1.4626827333333334.\n$$\n\n计算第四列（$j=4$，分母 $4^{3}-1=63$）：\n$$\nR_{4,4}=R_{4,3}+\\frac{R_{4,3}-R_{3,3}}{63}\n=1.4626827333333334+\\frac{1.4626827333333334-1.4629097111111111}{63}\n\\approx 1.4626791305114639.\n$$\n\n现在检查对角线的收敛性：\n$$\n|R_{2,2}-R_{1,1}|=|1.4757303333333333-1.859141|=0.3834106666666667>\\epsilon,\n$$\n$$\n|R_{3,3}-R_{2,2}|=|1.4629097111111111-1.4757303333333333|=0.0128206222222222>\\epsilon,\n$$\n$$\n|R_{4,4}-R_{3,3}|=|1.4626791305114639-1.4629097111111111|\n\\approx 2.30580599647\\times 10^{-4}<3\\times 10^{-4}.\n$$\n因此，第一个满足停止准则的对角线条目是 $R_{4,4}$。将 $R_{4,4}$ 四舍五入到六位有效数字，得到 $1.46268$。", "answer": "$$\\boxed{1.46268}$$", "id": "2198735"}]}