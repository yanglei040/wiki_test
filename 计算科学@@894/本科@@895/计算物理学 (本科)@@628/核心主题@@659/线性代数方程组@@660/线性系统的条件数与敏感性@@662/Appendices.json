{"hands_on_practices": [{"introduction": "理论最好的消化方式是实践。本节的第一个练习将通过一个具体的计算任务，让你亲手感受线性系统的敏感性。你将为一个简单的 $2 \\times 2$ 系统 $A x = b$ 构建一个微小的扰动，并观察这个扰动如何导致解向量 $x$ 发生巨大的、性质上的改变。这个练习旨在将条件数的抽象概念与一个具体、可观察的几何后果联系起来，从而为你建立坚实的直观理解。[@problem_id:2428587]", "problem": "在计算工程中，一个线性系统的条件状况是通过其解对数据中微小扰动的响应敏感度来评估的。考虑在 $\\mathbb{R}^{2}$ 中的线性系统 $A x = b$，其中\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 1.015 \\end{pmatrix}.\n$$\n在整个问题中，使用欧几里得向量范数和诱导矩阵范数（矩阵 $2$-范数）。\n\n1) 从解的敏感性和诱导范数的定义出发，通过显式构造来验证：存在一个相对大小为 $\\|\\Delta b\\|_{2}/\\|b\\|_{2} = 0.01$ 的扰动 $\\Delta b$，使得方程 $A \\tilde{x} = b + \\Delta b$ 的解 $\\tilde{x}$ 与方程 $A x = b$ 的解 $x$ 位于 $\\mathbb{R}^{2}$ 的不同开象限。您必须显式地构造出 $\\Delta b$，并从基本原理出发对每一步进行论证。\n\n2) 使用矩阵 $2$-范数下条件数的定义，并且不使用任何未经证明的简化公式，计算给定矩阵 $A$ 的条件数 $\\kappa_{2}(A)$。\n\n最终答案只需提供 $\\kappa_{2}(A)$ 的数值，四舍五入到四位有效数字。无需单位。", "solution": "对问题陈述进行验证。\n\n逐字提取的已知条件如下：\n- 线性系统：$A x = b$ in $\\mathbb{R}^{2}$。\n- 矩阵：$A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix}$。\n- 向量：$b = \\begin{pmatrix} 1 \\\\ 1.015 \\end{pmatrix}$。\n- 范数：欧几里得向量范数 ($\\|\\cdot\\|_{2}$) 和诱导矩阵范数 ($2$-范数)。\n- 扰动系统：$A \\tilde{x} = b + \\Delta b$。\n- 扰动约束：$\\|\\Delta b\\|_{2}/\\|b\\|_{2} = 0.01$。\n- 任务1：构造 $\\Delta b$，使得 $\\tilde{x}$ 和 $x$ 位于不同的开象限。\n- 任务2：根据定义计算条件数 $\\kappa_{2}(A)$。\n\n验证结论：\n该问题具有科学依据、是适定且客观的。这是一个关于线性系统敏感性的数值线性代数标准练习，也是计算工程的核心课题。矩阵 $A$ 是可逆的，因为其行列式 $\\det(A) = (1)(1.05) - (1)(1) = 0.05 \\neq 0$，这保证了唯一解的存在。所有数据和约束都已给出，且没有矛盾或模糊之处。该问题有效。\n\n解题过程如下。\n\n第1部分：构造一个合适的扰动 $\\Delta b$。\n\n首先，我们求解未扰动系统 $A x = b$ 以求得原始解 $x$。\n$$\n\\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1.015 \\end{pmatrix}\n$$\n这对应于以下方程组：\n$x_1 + x_2 = 1$\n$x_1 + 1.05 x_2 = 1.015$\n\n用第二个方程减去第一个方程，得到：\n$(x_1 + 1.05 x_2) - (x_1 + x_2) = 1.015 - 1$\n$0.05 x_2 = 0.015$\n$x_2 = \\frac{0.015}{0.05} = \\frac{15}{50} = \\frac{3}{10} = 0.3$。\n\n将 $x_2 = 0.3$ 代入第一个方程：\n$x_1 + 0.3 = 1 \\implies x_1 = 0.7$。\n\n解为 $x = \\begin{pmatrix} 0.7 \\\\ 0.3 \\end{pmatrix}$。由于 $x_1 > 0$ 且 $x_2 > 0$，该向量位于 $\\mathbb{R}^{2}$ 的第一开象限。\n\n接下来，我们分析扰动系统 $A \\tilde{x} = b + \\Delta b$。其解为 $\\tilde{x} = A^{-1}(b + \\Delta b) = A^{-1}b + A^{-1}\\Delta b = x + \\Delta x$，其中 $\\Delta x = A^{-1}\\Delta b$。我们必须构造一个扰动 $\\Delta b$，使得 $\\tilde{x}$ 位于一个不同的开象限。例如，我们可以目标定在第四象限，这要求 $\\tilde{x}_1 > 0$ 和 $\\tilde{x}_2 < 0$。\n\n新解的分量为 $\\tilde{x}_1 = x_1 + \\Delta x_1 = 0.7 + \\Delta x_1$ 和 $\\tilde{x}_2 = x_2 + \\Delta x_2 = 0.3 + \\Delta x_2$。为了移至第四象限，我们需要 $\\tilde{x}_2 < 0$，这意味着 $0.3 + \\Delta x_2 < 0$，即 $\\Delta x_2 < -0.3$。\n\n为了找到 $\\Delta x$ 和 $\\Delta b$ 之间的关系，我们必须计算 $A$ 的逆矩阵。\n$$\nA^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix} 1.05 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{1}{0.05} \\begin{pmatrix} 1.05 & -1 \\\\ -1 & 1 \\end{pmatrix} = 20 \\begin{pmatrix} 1.05 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 21 & -20 \\\\ -20 & 20 \\end{pmatrix}.\n$$\n解的变化量为 $\\Delta x = \\begin{pmatrix} \\Delta x_1 \\\\ \\Delta x_2 \\end{pmatrix} = A^{-1} \\Delta b = \\begin{pmatrix} 21 & -20 \\\\ -20 & 20 \\end{pmatrix} \\begin{pmatrix} \\Delta b_1 \\\\ \\Delta b_2 \\end{pmatrix}$。\n第二个分量是 $\\Delta x_2 = -20 \\Delta b_1 + 20 \\Delta b_2 = 20(\\Delta b_2 - \\Delta b_1)$。\n我们的条件 $\\Delta x_2 < -0.3$ 变为 $20(\\Delta b_2 - \\Delta b_1) < -0.3$，简化后为 $\\Delta b_2 - \\Delta b_1 < -0.015$。\n\n扰动 $\\Delta b$ 还必须满足相对大小约束 $\\|\\Delta b\\|_{2} / \\|b\\|_{2} = 0.01$。首先，我们计算 $b$ 的范数。\n$$\n\\|b\\|_{2}^{2} = 1^{2} + 1.015^{2} = 1 + 1.030225 = 2.030225.\n$$\n所以，$\\|b\\|_{2} = \\sqrt{2.030225}$。\n对 $\\Delta b$ 的约束是 $\\|\\Delta b\\|_{2} = 0.01 \\|b\\|_{2} = 0.01 \\sqrt{2.030225}$。\n这意味着 $\\|\\Delta b\\|_{2}^{2} = (0.01)^{2} (2.030225) = 0.0002030225$。\n\n我们需要找到一个向量 $\\Delta b = \\begin{pmatrix} \\Delta b_1 \\\\ \\Delta b_2 \\end{pmatrix}$，它同时满足 $\\Delta b_2 - \\Delta b_1 < -0.015$ 和 $\\Delta b_1^2 + \\Delta b_2^2 = 0.0002030225$。为在固定范数下尽可能强地满足第一个条件，我们应选择 $\\Delta b$ 以使量 $\\Delta b_2 - \\Delta b_1$ 最小化。当 $\\Delta b$ 的方向与向量 $\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$ 一致时，即可达到此目的。因此，我们选择 $\\Delta b$ 的方向为向量 $\\begin{pmatrix} -1/\\sqrt{2} \\\\ 1/\\sqrt{2} \\end{pmatrix}$ 的反方向，即与 $\\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix}$ 方向一致。\n\n令 $\\Delta b = R \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix}$，其中 $R = \\|\\Delta b\\|_{2} = 0.01 \\sqrt{2.030225}$。\n所以，$\\Delta b_1 = \\frac{R}{\\sqrt{2}}$ 且 $\\Delta b_2 = -\\frac{R}{\\sqrt{2}}$。\n该向量具体为：\n$$\n\\Delta b = \\frac{0.01 \\sqrt{2.030225}}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\n让我们验证这个构造。其范数为 $\\|\\Delta b\\|_{2} = \\sqrt{(\\frac{R}{\\sqrt{2}})^2 + (-\\frac{R}{\\sqrt{2}})^2} = \\sqrt{\\frac{R^2}{2} + \\frac{R^2}{2}} = R$，根据构造，这是正确的。\n现在检查关于分量的条件：\n$\\Delta b_2 - \\Delta b_1 = -\\frac{R}{\\sqrt{2}} - \\frac{R}{\\sqrt{2}} = -\\frac{2R}{\\sqrt{2}} = -R\\sqrt{2}$。\n代入 $R = 0.01 \\sqrt{2.030225}$：\n$$\n\\Delta b_2 - \\Delta b_1 = -(0.01 \\sqrt{2.030225})\\sqrt{2} = -0.01 \\sqrt{4.06045}.\n$$\n由于 $2^2=4$，我们有 $\\sqrt{4.06045} > 2$。因此 $\\Delta b_2 - \\Delta b_1 < -0.01 \\times 2 = -0.02$。\n因为 $-0.02 < -0.015$，我们的条件得到满足。\n让我们计算解向量 $x$ 的变化。\n$\\Delta x_2 = 20(\\Delta b_2 - \\Delta b_1) = 20(-0.01\\sqrt{4.06045}) = -0.2\\sqrt{4.06045}$。\n数值上，$\\Delta x_2 \\approx -0.2 \\times 2.01505... \\approx -0.403$。\n新的分量 $\\tilde{x}_2 = x_2 + \\Delta x_2 = 0.3 + \\Delta x_2 \\approx 0.3 - 0.403 = -0.103 < 0$。\n\n为了完整起见，我们检查 $\\tilde{x}_1$。\n$\\Delta x_1 = 21 \\Delta b_1 - 20 \\Delta b_2 = 21(\\frac{R}{\\sqrt{2}}) - 20(-\\frac{R}{\\sqrt{2}}) = \\frac{41R}{\\sqrt{2}} = \\frac{41(0.01\\sqrt{2.030225})}{\\sqrt{2}} > 0$。\n所以 $\\tilde{x}_1 = x_1 + \\Delta x_1 > 0.7 > 0$。\n新解 $\\tilde{x}$ 的分量满足 $\\tilde{x}_1 > 0$ 和 $\\tilde{x}_2 < 0$，使其位于第四象限。该构造是有效的。\n\n第2部分：计算条件数 $\\kappa_{2}(A)$。\n\n矩阵 $2$-范数下的条件数定义为 $\\kappa_{2}(A) = \\|A\\|_{2}\\|A^{-1}\\|_{2}$。\n问题要求从基本原理出发进行计算，而不是使用未经证明的简化公式。矩阵 $M$ 的 $2$-范数（或谱范数）定义为其最大奇异值，即 $\\|M\\|_{2} = \\sigma_{\\max}(M) = \\sqrt{\\lambda_{\\max}(M^{T}M)}$，其中 $\\lambda_{\\max}(M^{T}M)$ 是 $M^{T}M$ 的最大特征值。\n\n给定矩阵 $A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix}$ 是一个对称矩阵，即 $A = A^{T}$。\n对于对称矩阵 $A$，乘积 $A^{T}A$ 变为 $A^{2}$。\n$A^{2}$ 的特征值是 $A$ 的特征值的平方。如果 $\\lambda$ 是 $A$ 的一个特征值，其对应的特征向量为 $v$，那么 $A^{2}v = A(Av) = A(\\lambda v) = \\lambda(Av) = \\lambda^2 v$。\n因此，$\\lambda_{\\max}(A^{T}A) = \\lambda_{\\max}(A^{2}) = (\\max_i |\\lambda_i(A)|)^{2}$，其中 $\\lambda_i(A)$ 是 $A$ 的特征值。\n因此，对于对称矩阵 $A$，其 $2$-范数是其最大绝对值特征值：\n$$\n\\|A\\|_{2} = \\sqrt{(\\max_i |\\lambda_i(A)|)^{2}} = \\max_i |\\lambda_i(A)|.\n$$\n其逆矩阵 $A^{-1}$ 也是对称的。它的特征值是 $A$ 的特征值的倒数。\n所以，$\\|A^{-1}\\|_{2} = \\max_i |1/\\lambda_i(A)| = 1 / \\min_i |\\lambda_i(A)|$。\n这个结论在 $A$ 可逆的条件下成立，而它确实是可逆的。\n综合这些结果，对称矩阵 $A$ 的条件数是其最大绝对值特征值与最小绝对值特征值的比率：\n$$\n\\kappa_{2}(A) = \\frac{\\max_i |\\lambda_i(A)|}{\\min_i |\\lambda_i(A)|}.\n$$\n我们现在通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来求 $A$ 的特征值。\n$$\n\\det\\begin{pmatrix} 1-\\lambda & 1 \\\\ 1 & 1.05-\\lambda \\end{pmatrix} = (1-\\lambda)(1.05-\\lambda) - 1 = 0.\n$$\n$$\n\\lambda^{2} - 1.05\\lambda - \\lambda + 1.05 - 1 = 0\n$$\n$$\n\\lambda^{2} - 2.05\\lambda + 0.05 = 0.\n$$\n使用求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\lambda = \\frac{2.05 \\pm \\sqrt{(-2.05)^{2} - 4(1)(0.05)}}{2} = \\frac{2.05 \\pm \\sqrt{4.2025 - 0.2}}{2} = \\frac{2.05 \\pm \\sqrt{4.0025}}{2}.\n$$\n由于 $A$ 的迹（$2.05 > 0$）和行列式（$0.05 > 0$）都是正数，所以 $A$ 是正定的，其特征值也都是正数。\n最大和最小特征值是：\n$$\n\\lambda_{\\max} = \\frac{2.05 + \\sqrt{4.0025}}{2}\n$$\n$$\n\\lambda_{\\min} = \\frac{2.05 - \\sqrt{4.0025}}{2}\n$$\n条件数是它们的比值：\n$$\n\\kappa_{2}(A) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(2.05 + \\sqrt{4.0025})/2}{(2.05 - \\sqrt{4.0025})/2} = \\frac{2.05 + \\sqrt{4.0025}}{2.05 - \\sqrt{4.0025}}.\n$$\n计算其数值：\n$\\sqrt{4.0025} \\approx 2.0006249377...$\n$$\n\\kappa_{2}(A) \\approx \\frac{2.05 + 2.0006249377}{2.05 - 2.0006249377} = \\frac{4.0506249377}{0.0493750623} \\approx 82.038160...\n$$\n四舍五入到四位有效数字，我们得到 $82.04$。", "answer": "$$\\boxed{82.04}$$", "id": "2428587"}, {"introduction": "下一个练习将抽象的数值代数与实际的科学建模联系起来，揭示一个常见的隐藏陷阱。你将研究一个看似无害的选择——物理量的测量单位（例如，米 vs. 毫米）——如何极大地改变系统矩阵的条件数，从而影响其数值稳定性。这个例子阐明了病态条件并非纯粹的数学现象，它也可能在问题建模阶段被无意中引入，这对于所有进行计算工作的科学家和工程师来说都是一个至关重要的警示。[@problem_id:2381774]", "problem": "一根长度为 $L$ 的直细长梁在 $x=0$ 处被夹紧，在缓和载荷下产生微小的横向挠度 $y(x)$。在 $x=0$ 和 $x=L$ 这两个位置之间的短区间上，一位工程师用线性关系 $y(x) = a\\,x + b$ 来模拟挠度，其中 $a$ 和 $b$ 是未知常数。在位置 $x=0$ 和 $x=L$ 处对挠度进行了两次测量，得到了一个关于参数矢量 $(a,b)^{\\mathsf{T}}$ 的 $2\\times 2$ 线性系统，其系统矩阵为\n$$\nA = \\begin{pmatrix}\nx_1 & 1 \\\\\nx_2 & 1\n\\end{pmatrix},\n$$\n其中 $x_1 = 0$ 且 $x_2 = L$。考虑 $L = 1$ 米的情况。现在，假设同样地物理位置用毫米记录，因此当 $L$ 表示为 $1000$ 毫米时，位置的数值变为 $x_1' = 0$ 和 $x_2' = 1000$。这只改变了系统矩阵的数值项（而不改变其物理性质）。设 $A_{\\mathrm{m}}$ 表示使用米为单位的位置构建的矩阵，而 $A_{\\mathrm{mm}}$ 表示使用毫米为单位的位置构建的矩阵。\n\n计算矩阵 $2$-范数下条件数的比值 $\\kappa_{2}(A_{\\mathrm{mm}})/\\kappa_{2}(A_{\\mathrm{m}})$。将你的最终答案四舍五入到四位有效数字。最终答案是一个无量纲实数。", "solution": "首先必须验证问题陈述的科学和逻辑完整性。\n\n步骤 1：提取已知条件\n- 一根长度为 $L$ 的直细长梁。\n- 在 $x=0$ 处被夹紧。\n- 微小的横向挠度由线性关系 $y(x) = a\\,x + b$ 模拟。\n- 待定参数：$(a,b)^{\\mathsf{T}}$。\n- 在位置 $x=0$ 和 $x=L$ 处进行两次测量。\n- 关于参数的线性系统的系统矩阵为 $A = \\begin{pmatrix} x_1 & 1 \\\\ x_2 & 1 \\end{pmatrix}$，其中 $x_1=0$ 且 $x_2=L$。\n- 情况 1（米）：$L=1$ 米，得到 $x_1=0$，$x_2=1$。矩阵记为 $A_{\\mathrm{m}}$。\n- 情况 2（毫米）：相同的物理长度 $L$ 表示为 $1000$ 毫米。位置的数值为 $x_1' = 0$，$x_2' = 1000$。矩阵记为 $A_{\\mathrm{mm}}$。\n- 任务是计算矩阵 $2$-范数下的条件数比值：$\\kappa_{2}(A_{\\mathrm{mm}})/\\kappa_{2}(A_{\\mathrm{m}})$。\n- 最终答案必须是四舍五入到四位有效数字的无量纲实数。\n\n步骤 2：使用提取的已知条件进行验证\n将夹紧梁的挠度建模为 $y(x) = ax+b$ 的物理前提是一个粗略的简化。一个物理上精确的夹紧梁模型会要求 $y(0)=0$ 和斜率 $y'(0)=0$。如果 $b=0$，线性模型可以满足 $y(0)=0$，但除非 $a=0$（这意味着零挠度），否则它不能满足 $y'(0)=0$。然而，这个问题不是一个固体力学问题，而是一个数值线性代数问题。它提出了一个关于一位“工程师”所建模的特定线性系统的数值稳定性问题，而与该模型对底层物理学的保真度无关。关于条件数对坐标缩放的依赖性的核心数学问题在计算科学领域内是适定的、客观的且有科学依据的。该问题是自洽的，提供了所有必要信息，并且其解是唯一的且可验证的。因此，该问题被视为有效。\n\n步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n该问题要求计算两个矩阵的 $2$-范数条件数的比值。$2$-范数下的条件数定义为 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。对于一个可逆矩阵 $A$，这等价于其最大奇异值与最小奇异值的比值，即 $\\kappa_2(A) = \\sigma_{\\max}(A) / \\sigma_{\\min}(A)$。$A$ 的奇异值是矩阵 $A^{\\mathsf{T}}A$ 的特征值的平方根。\n\n让我们考虑问题中给定形式的一般矩阵，其中 $x_1=0$ 且 $x_2=L$：\n$$\nA_L = \\begin{pmatrix} 0 & 1 \\\\ L & 1 \\end{pmatrix}\n$$\n我们首先计算 $A_L^{\\mathsf{T}}A_L$：\n$$\nA_L^{\\mathsf{T}}A_L = \\begin{pmatrix} 0 & L \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ L & 1 \\end{pmatrix} = \\begin{pmatrix} L^2 & L \\\\ L & 2 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(A_L^{\\mathsf{T}}A_L - \\lambda I) = 0$ 来求这个对称矩阵的特征值：\n$$\n\\det \\begin{pmatrix} L^2 - \\lambda & L \\\\ L & 2 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(L^2 - \\lambda)(2 - \\lambda) - L^2 = 0\n$$\n$$\n2L^2 - L^2\\lambda - 2\\lambda + \\lambda^2 - L^2 = 0\n$$\n$$\n\\lambda^2 - (L^2 + 2)\\lambda + L^2 = 0\n$$\n$A_L^{\\mathsf{T}}A_L$ 的特征值，记为 $\\lambda_{\\pm}$，由二次方程求根公式给出：\n$$\n\\lambda_{\\pm} = \\frac{(L^2 + 2) \\pm \\sqrt{(L^2 + 2)^2 - 4L^2}}{2} = \\frac{(L^2 + 2) \\pm \\sqrt{L^4 + 4L^2 + 4 - 4L^2}}{2} = \\frac{L^2 + 2 \\pm \\sqrt{L^4 + 4}}{2}\n$$\n$A_L$ 的奇异值是 $\\sigma_{\\pm} = \\sqrt{\\lambda_{\\pm}}$。条件数 $\\kappa_2(A_L)$ 是最大奇异值与最小奇异值的比值：\n$$\n\\kappa_2(A_L) = \\frac{\\sigma_+}{\\sigma_-} = \\sqrt{\\frac{\\lambda_+}{\\lambda_-}} = \\sqrt{\\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{L^2 + 2 - \\sqrt{L^4 + 4}}}\n$$\n为了简化这个表达式，我们将平方根内的分子和分母同乘以分母的共轭项：\n$$\n\\kappa_2(A_L)^2 = \\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{L^2 + 2 - \\sqrt{L^4 + 4}} \\cdot \\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{L^2 + 2 + \\sqrt{L^4 + 4}} = \\frac{(L^2 + 2 + \\sqrt{L^4 + 4})^2}{(L^2 + 2)^2 - (L^4 + 4)}\n$$\n$$\n\\kappa_2(A_L)^2 = \\frac{(L^2 + 2 + \\sqrt{L^4 + 4})^2}{L^4 + 4L^2 + 4 - L^4 - 4} = \\frac{(L^2 + 2 + \\sqrt{L^4 + 4})^2}{4L^2}\n$$\n取平方根得到条件数的简化通用公式：\n$$\n\\kappa_2(A_L) = \\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{2L}\n$$\n我们现在将此公式应用于两种情况。\n\n情况 1：矩阵 $A_{\\mathrm{m}}$，使用以米为单位的位置构建。此处，$L=1$：\n$$\n\\kappa_2(A_{\\mathrm{m}}) = \\kappa_2(A_{L=1}) = \\frac{1^2 + 2 + \\sqrt{1^4 + 4}}{2(1)} = \\frac{3 + \\sqrt{5}}{2}\n$$\n\n情况 2：矩阵 $A_{\\mathrm{mm}}$，使用以毫米为单位的位置构建。此处，$L=1000$：\n$$\n\\kappa_2(A_{\\mathrm{mm}}) = \\kappa_2(A_{L=1000}) = \\frac{1000^2 + 2 + \\sqrt{1000^4 + 4}}{2(1000)} = \\frac{1000002 + \\sqrt{10^{12} + 4}}{2000}\n$$\n所求的比值为 $\\kappa_{2}(A_{\\mathrm{mm}})/\\kappa_{2}(A_{\\mathrm{m}})$：\n$$\n\\frac{\\kappa_{2}(A_{\\mathrm{mm}})}{\\kappa_{2}(A_{\\mathrm{m}})} = \\frac{\\left( \\frac{1000002 + \\sqrt{10^{12} + 4}}{2000} \\right)}{\\left( \\frac{3 + \\sqrt{5}}{2} \\right)} = \\frac{1000002 + \\sqrt{10^{12} + 4}}{1000(3 + \\sqrt{5})}\n$$\n我们现在对这个表达式进行数值计算。\n首先，分母：\n$3 + \\sqrt{5} \\approx 3 + 2.236067977 = 5.236067977$\n$1000(3 + \\sqrt{5}) \\approx 5236.067977$\n接下来，分子：\n$\\sqrt{10^{12} + 4} = 10^6 \\sqrt{1 + 4 \\times 10^{-12}} \\approx 10^6 (1 + \\frac{1}{2} \\cdot 4 \\times 10^{-12}) = 10^6 + 2 \\times 10^{-6} = 1000000.000002$\n$1000002 + \\sqrt{10^{12} + 4} \\approx 1000002 + 1000000.000002 = 2000002.000002$\n该比值约为：\n$$\n\\frac{2000002.000002}{5236.067977} \\approx 381.96699933\n$$\n将此结果四舍五入到四位有效数字得到 $382.0$。", "answer": "$$\n\\boxed{382.0}\n$$", "id": "2381774"}, {"introduction": "在理解了病态问题的表现和成因之后，我们将学习一种强大的应对策略。这个实践任务将引导你使用一种称为“截断奇异值分解”(Truncated Singular Value Decomposition, TSVD) 的正则化技术来处理带噪声的病态系统。你将学会利用奇异值分解（SVD）来诊断系统，并像外科手术般精确地“滤除”那些与小奇异值相关联、放大噪声的不稳定模式，从而在直接求解会失败的情况下，获得一个稳定且有意义的解。[@problem_id:2381778]", "problem": "给定一个由希尔伯特矩阵构成的已知是病态的方形线性系统族。对于一个正整数 $n$，考虑矩阵 $A \\in \\mathbb{R}^{n \\times n}$，其元素为 $A_{ij} = \\dfrac{1}{i + j - 1}$，其中 $i,j \\in \\{1,2,\\ldots,n\\}$。设未知向量为 $x^\\star \\in \\mathbb{R}^n$，其分量为 $x^\\star_j = \\dfrac{(-1)^{j+1}}{j}$，其中 $j \\in \\{1,2,\\ldots,n\\}$。干净数据向量为 $b_{\\mathrm{clean}} = A x^\\star$。为了以确定性和可复现的方式模拟实验噪声，定义 $w \\in \\mathbb{R}^n$ 为 $w_i = \\cos(i)$，其中 $i \\in \\{1,2,\\ldots,n\\}$，然后对于给定的相对噪声水平 $\\eta > 0$，定义噪声向量 $e = \\eta \\, \\lVert b_{\\mathrm{clean}} \\rVert_2 \\, \\dfrac{w}{\\lVert w \\rVert_2}$。测量数据为 $b = b_{\\mathrm{clean}} + e$。\n\n设 $A$ 的奇异值分解 (SVD) 为 $A = U \\Sigma V^\\top$，其中 $\\Sigma = \\operatorname{diag}(\\sigma_1,\\sigma_2,\\ldots,\\sigma_n)$，奇异值按 $\\sigma_1 \\ge \\sigma_2 \\ge \\cdots \\ge \\sigma_n > 0$ 排序，并且 $U,V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵。对于给定的相对阈值 $\\tau \\in (0,1)$，定义保留模态的索引集 $K_\\tau = \\{ i \\in \\{1,2,\\ldots,n\\} \\mid \\sigma_i / \\sigma_1 \\ge \\tau \\}$。将 $x^\\star$ 的截断 SVD 估计定义为\n$$\n\\hat{x}_\\tau \\;=\\; \\sum_{i \\in K_\\tau} \\frac{u_i^\\top b}{\\sigma_i} \\, v_i,\n$$\n其中 $u_i$ 和 $v_i$ 分别表示 $U$ 和 $V$ 的第 $i$ 列。将有效数值秩定义为 $r_\\tau = |K_\\tau|$。定义滤波条件数\n$$\n\\kappa_\\tau(A) \\;=\\; \\frac{\\max_{i \\in K_\\tau} \\sigma_i}{\\min_{i \\in K_\\tau} \\sigma_i},\n$$\n并约定如果 $K_\\tau = \\varnothing$，则 $\\kappa_\\tau(A) = +\\infty$。最后，定义相对重构误差\n$$\nE_\\tau \\;=\\; \\frac{\\lVert \\hat{x}_\\tau - x^\\star \\rVert_2}{\\lVert x^\\star \\rVert_2}.\n$$\n\n您的任务是为下面的每个测试用例计算由 $(E_\\tau, r_\\tau, \\kappa_\\tau(A))$ 组成的三元组。所有向量和矩阵范数均为欧几里得范数（2-范数）。所有计算都是无量纲的。\n\n测试套件（每个测试用例是一个元组 $(n,\\eta,\\tau)$）：\n- 测试 1：$(n,\\eta,\\tau) = (10, 10^{-6}, 10^{-12})$。\n- 测试 2：$(n,\\eta,\\tau) = (10, 10^{-4}, 10^{-8})$。\n- 测试 3：$(n,\\eta,\\tau) = (12, 10^{-4}, 10^{-4})$。\n- 测试 4：$(n,\\eta,\\tau) = (12, 10^{-2}, 10^{-4})$。\n- 测试 5：$(n,\\eta,\\tau) = (12, 10^{-2}, 10^{-2})$。\n\n最终输出格式要求：\n- 对于每个测试用例，输出一个列表 $[E_\\tau, r_\\tau, \\kappa_\\tau(A)]$，其中 $E_\\tau$ 和 $\\kappa_\\tau(A)$ 是四舍五入到 8 位小数的浮点数，$r_\\tau$ 是一个整数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，该列表中的每个元素都是一个测试用例的列表，顺序与上述指定顺序相同。例如：$[[E_1,r_1,\\kappa_1],[E_2,r_2,\\kappa_2],\\ldots]$。", "solution": "该问题要求分析线性系统 $A x = b$，其中矩阵 $A$ 是希尔伯特矩阵，已知其是严重病态的。病态性意味着数据向量 $b$ 中的小扰动会导致解向量 $x$ 发生巨大变化。为了解决这个问题，采用了一种称为截断奇异值分解 (TSVD) 的正则化技术。我们的任务是计算几个表征该方法在给定系统参数下性能的量。将对几个测试用例进行分析，每个测试用例由一个三元组 $(n, \\eta, \\tau)$ 定义，其中 $n$ 是系统维度，$\\eta$ 是相对噪声水平，$\\tau$ 是正则化阈值。\n\n每个测试用例 $(n, \\eta, \\tau)$ 的步骤如下：\n\n步骤 1：构建线性系统组件。\n希尔伯特矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 由其元素定义\n$$A_{ij} = \\frac{1}{i + j - 1}$$\n其中 $i, j \\in \\{1, 2, \\ldots, n\\}$。真实的未知解向量 $x^\\star \\in \\mathbb{R}^n$ 由下式给出\n$$x^\\star_j = \\frac{(-1)^{j+1}}{j}$$\n其中 $j \\in \\{1, 2, \\ldots, n\\}$。“干净”数据向量 $b_{\\mathrm{clean}} \\in \\mathbb{R}^n$ 是将矩阵 $A$ 应用于真实解 $x^\\star$ 的结果：\n$$b_{\\mathrm{clean}} = A x^\\star$$\n为模拟测量噪声，构建一个确定性噪声向量 $e \\in \\mathbb{R}^n$。首先，定义一个辅助向量 $w \\in \\mathbb{R}^n$，其分量为 $w_i = \\cos(i)$，其中 $i \\in \\{1, 2, \\ldots, n\\}$。然后，相对于干净数据的范数来缩放噪声向量 $e$：\n$$e = \\eta \\, \\lVert b_{\\mathrm{clean}} \\rVert_2 \\, \\frac{w}{\\lVert w \\rVert_2}$$\n其中 $\\eta > 0$ 是相对噪声水平，$\\lVert \\cdot \\rVert_2$表示欧几里得范数（或2-范数）。测量的或含噪的数据向量 $b \\in \\mathbb{R}^n$ 是干净数据与噪声之和：\n$$b = b_{\\mathrm{clean}} + e$$\n\n步骤 2：执行奇异值分解 (SVD)。\n计算矩阵 $A$ 的 SVD，得到分解 $A = U \\Sigma V^\\top$。这里，$U, V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，其列分别是左奇异向量和右奇异向量。$\\Sigma \\in \\mathbb{R}^{n \\times n}$ 是一个对角矩阵，包含 $A$ 的奇异值 $\\sigma_i$，按非递增顺序排列：$\\sigma_1 \\ge \\sigma_2 \\ge \\cdots \\ge \\sigma_n > 0$。由于希尔伯特矩阵是非奇异的，所有奇异值的正性都得到保证。\n\n步骤 3：应用 TSVD 正则化。\nTSVD 的核心是滤除对噪声最敏感的奇异模态。这些模态对应于最小的奇异值。使用一个相对阈值 $\\tau \\in (0,1)$ 来定义保留模态的集合：\n$$K_\\tau = \\{ i \\in \\{1, 2, \\ldots, n\\} \\mid \\sigma_i / \\sigma_1 \\ge \\tau \\}$$\n该集合包含那些相对于最大奇异值 $\\sigma_1$ 而言不“太小”的奇异值的索引。该集合的基数 $r_\\tau = |K_\\tau|$ 是矩阵 $A$ 在给定阈值 $\\tau$ 下的有效数值秩。\n\n步骤 4：计算 TSVD 解及相关量。\nTSVD 正则化解 $\\hat{x}_\\tau$ 是通过仅对保留的模态求和来构造的：\n$$\\hat{x}_\\tau = \\sum_{i \\in K_\\tau} \\frac{u_i^\\top b}{\\sigma_i} v_i$$\n其中 $u_i$ 和 $v_i$ 是 $U$ 和 $V$ 的第 $i$ 列。该公式有效地对系统的良态部分求逆，同时丢弃病态部分。\n\n在确定集合 $K_\\tau$ 后，滤波条件数 $\\kappa_\\tau(A)$ 被计算为最大保留奇异值与最小保留奇异值之比：\n$$\\kappa_\\tau(A) = \\frac{\\max_{i \\in K_\\tau} \\sigma_i}{\\min_{i \\in K_\\tau} \\sigma_i} = \\frac{\\sigma_1}{\\min_{i \\in K_\\tau} \\sigma_i}$$\n等式成立是因为 $\\sigma_1$ 是最大奇异值，并且对于 $\\tau \\le 1$，其索引 $i=1$ 始终在 $K_\\tau$ 中。\n\n最后，通过计算相对重构误差 $E_\\tau$ 来评估重构质量：\n$$E_\\tau = \\frac{\\lVert \\hat{x}_\\tau - x^\\star \\rVert_2}{\\lVert x^\\star \\rVert_2}$$\n该度量比较了估计解与真实解之间的距离，该距离相对于真实解的幅度。\n\n对于每个测试用例，我们将使用标准的双精度浮点运算来数值化实现这些步骤，以获得三元组 $(E_\\tau, r_\\tau, \\kappa_\\tau(A))$。", "answer": "[[0.06325916, 7, 33872274.68650631], [0.1557342, 5, 232043.95540706], [0.38076632, 5, 11462002.32439129], [0.3958988, 5, 11462002.32439129], [0.81977799, 3, 2197.80164843]]", "id": "2381778"}]}