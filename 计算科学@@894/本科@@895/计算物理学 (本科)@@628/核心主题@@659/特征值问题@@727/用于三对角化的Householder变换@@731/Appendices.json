{"hands_on_practices": [{"introduction": "在深入研究豪斯霍尔德变换的复杂计算之前，让我们通过一个思想实验来检验我们对该算法核心目的的理解。这个练习将探讨当输入矩阵已经处于我们期望的最终形式（即三对角形式）时，算法会如何表现。通过思考这个特殊情况，您可以巩固对算法每一步操作的逻辑和条件的认识，确保您不仅知道如何计算，更理解为什么这么计算。[@problem_id:2401945]", "problem": "给定一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，它已经是三对角的，意味着当 $\\lvert i - j \\rvert > 1$ 时，$A_{ij} = 0$。考虑对 $A$ 应用标准的 Householder 三对角化过程，该过程构造一系列正交的 Householder 反射变换，以消除逐个列中第一条次对角线下方的元素，从而得到一个正交矩阵 $Q \\in \\mathbb{R}^{n \\times n}$ 和一个三对角矩阵 $T \\in \\mathbb{R}^{n \\times n}$，使得 $Q^{\\top} A Q = T$。假设使用精确算术，并遵循常规约定：如果在某一步中不需要进行消元（即目标子向量是零向量），则相应的 Householder 反射变换取为单位矩阵。\n\n哪个选项最能描述输出的 $T$ 和累积的正交矩阵 $Q$？\n\nA. $T = A$ 且 $Q = I_{n}$；在精确算术下，输入保持不变，因为在任何步骤中都没有形成非平凡的反射变换。\n\nB. $T$ 是对角矩阵而 $Q$ 是正交矩阵，因为该算法会继续消除非对角线元素，直到只剩下对角线。\n\nC. $T$ 是三对角的但通常与 $A$ 不同，且 $Q \\neq I_{n}$，因为 Householder 向量中的任意符号选择即使在输入是三对角的情况下也会引发非平凡的相似变换。\n\nD. $T = P^{\\top} A P$，其中 $P$ 是某个置换矩阵，因为 Householder 反射变换在三对角矩阵上起到置换的作用，所以 $Q$ 是一个置换矩阵。", "solution": "问题要求我们确定将标准的 Householder 三对角化算法应用于一个已经是三对角的矩阵会得到什么结果。让我们根据问题中提供的过程定义进行严格的分析。\n\n问题陈述了给定一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，它是三对角的。这意味着其元素 $A_{ij}$ 在 $\\lvert i - j \\rvert > 1$ 时满足 $A_{ij} = 0$。\n\nHouseholder 三对角化算法构造一个正交矩阵 $Q$，使得 $T = Q^{\\top} A Q$ 是三对角的。这个过程在 $n-2$ 步内完成。在第 $k$ 步（$k=1, 2, \\dots, n-2$），一个正交相似变换被应用于当前矩阵，以在第 $k$ 列和第 $k$ 行引入零。设 $A^{(0)} = A$。矩阵序列通过 $A^{(k)} = P_k^{\\top} A^{(k-1)} P_k$ 生成，其中 $P_k$ 是一个 Householder 反射变换。注意由于 Householder 反射变换是对称的（$P_k^{\\top} = P_k$），这等价于 $A^{(k)} = P_k A^{(k-1)} P_k$。最终的三对角矩阵是 $T = A^{(n-2)}$。累积的正交变换是 $Q = P_1 P_2 \\dots P_{n-2}$。\n\n让我们分析第 $k$ 步的过程。如问题所述，反射变换 $P_k$ 的目的是“消除逐个列中第一条次对角线下方的元素”。对于第 $k$ 列，对角线元素是 $A_{kk}$，第一条次对角线上的元素是 $A_{k+1, k}$。因此，“第一条次对角线下方的”元素是 $A_{k+2, k}, A_{k+3, k}, \\dots, A_{n,k}$。\n\n在第 $k$ 步要消去的目标子向量是由这些元素组成的向量：\n$$ x_k = \\begin{pmatrix} A^{(k-1)}_{k+2, k} \\\\ A^{(k-1)}_{k+3, k} \\\\ \\vdots \\\\ A^{(k-1)}_{n, k} \\end{pmatrix} $$\n该算法构造一个 Householder 反射变换，将这个向量 $x_k$ 变换为零向量。\n\n现在，我们将此应用于给定的问题。在第一步，$k=1$，我们有矩阵 $A^{(0)} = A$。\n目标子向量由第一列中次对角线元素 $A_{21}$ 下方的元素组成。这些元素是 $A_{31}, A_{41}, \\dots, A_{n1}$。目标子向量是：\n$$ x_1 = \\begin{pmatrix} A_{31} \\\\ A_{41} \\\\ \\vdots \\\\ A_{n1} \\end{pmatrix} $$\n由于输入矩阵 $A$ 是三对角的，所有这些元素都为零。对于 $j=1$，条件 $\\lvert i-j \\rvert > 1$ 等价于 $i-1 > 1$，即 $i > 2$。因此，对于所有 $i>2$，$A_{i1}=0$。\n所以，目标子向量 $x_1$ 是零向量。\n\n对于这种特定情况，问题提供了一个关键指令：“如果在某一步中不需要进行消元（即目标子向量是零向量），则相应的 Householder 反射变换取为单位矩阵”。\n因此，对于第 $k=1$ 步，Householder 反射变换是 $P_1 = I_n$，即 $n \\times n$ 的单位矩阵。\n矩阵更新如下：\n$$ A^{(1)} = P_1^{\\top} A^{(0)} P_1 = I_n^{\\top} A I_n = A $$\n第一步之后，矩阵保持不变。\n\n我们进行第二步，$k=2$。我们对矩阵 $A^{(1)} = A$ 进行操作。\n第二列中要消去的目标子向量由次对角线元素 $A_{32}$ 下方的元素组成。这些元素是 $A_{42}, A_{52}, \\dots, A_{n2}$。目标子向量是：\n$$ x_2 = \\begin{pmatrix} A_{42} \\\\ A_{52} \\\\ \\vdots \\\\ A_{n2} \\end{pmatrix} $$\n由于 $A$ 是三对角的, 对于 $j=2$，条件 $\\lvert i-j \\rvert > 1$ 等价于 $i-2 > 1$，即 $i > 3$。因此，对于所有 $i>3$，$A_{i2}=0$。\n目标子向量 $x_2$ 同样是零向量。\n应用给定的约定，这一步的反射变换是单位矩阵，$P_2 = I_n$。\n矩阵更新如下：\n$$ A^{(2)} = P_2^{\\top} A^{(1)} P_2 = I_n^{\\top} A I_n = A $$\n矩阵仍然保持不变。\n\n这个逻辑适用于算法的每一步。对于任何步骤 $k \\in \\{1, 2, \\dots, n-2\\}$，我们操作的矩阵都是 $A^{(k-1)} = A$。要消去的目标子向量由元素 $A_{k+2,k}, \\dots, A_{n,k}$ 组成。对于一个三对角矩阵，所有这些元素都为零，因为对于任何 $i \\ge k+2$，我们有 $i-k \\ge 2$，所以 $\\lvert i-k \\rvert > 1$。\n因此，在每一步中，目标子向量都是零向量。根据问题的明确规则，反射变换总是单位矩阵：$P_k = I_n$ 对于所有 $k=1, \\dots, n-2$。\n\n最终的三对角矩阵 $T$ 是经过 $n-2$ 步后的结果：\n$$ T = A^{(n-2)} = A $$\n总的正交变换矩阵 $Q$ 是所有单个反射变换的乘积：\n$$ Q = P_1 P_2 \\dots P_{n-2} = I_n I_n \\dots I_n = I_n $$\n因此，在指定条件下，当该过程应用于一个已经是三对角的矩阵时，结果是 $T = A$ 和 $Q = I_n$。\n\n现在，我们来评估每个选项。\n\nA. $T = A$ 且 $Q = I_{n}$；在精确算术下，输入保持不变，因为在任何步骤中都没有形成非平凡的反射变换。\n我们的推导表明 $T = A$ 且 $Q = I_n$。原因确实是，在每一步中，要消去的元素向量已经是零向量，根据问题中陈述的约定，这导致一个单位变换。因此，从未形成任何非平凡的反射变换。此选项 **正确**。\n\nB. $T$ 是对角矩阵而 $Q$ 是正交矩阵，因为该算法会继续消除非对角线元素，直到只剩下对角线。\n这个说法是不正确的。Householder 三对角化算法的目标是生成一个三对角矩阵，而不是对角矩阵。该过程被设计为在 $n-2$ 步后停止，此时矩阵是三对角的。它不会“继续”消去第一条次对角线和超对角线上的元素。需要使用不同的算法（例如 QR 算法）来将三对角矩阵进一步简化为对角或准三角形式。此选项歪曲了所指定算法的目的。此选项 **不正确**。\n\nC. $T$ 是三对角的但通常与 $A$ 不同，且 $Q \\neq I_{n}$，因为 Householder 向量中的任意符号选择即使在输入是三对角的情况下也会引发非平凡的相似变换。\n此选项推测了在构造 Householder 向量时符号选择的影响。尽管某些标准实现（例如，为了最大化数值稳定性）即使只需要将次-次对角线元素清零也可能构造一个非平凡的反射变换，但这被问题陈述中提供的明确规则所取代。问题规定，如果待消元的子向量为零，则反射变换为单位矩阵。正如我们所展示的，对于三对角输入，此条件在每一步都得到满足。因此，不存在导致非平凡变换的“任意符号选择”。该过程是确定性的，并且只产生单位变换。此选项与问题的前提相矛盾。此选项 **不正确**。\n\nD. $T = P^{\\top} A P$ for some permutation matrix $P$, because Householder reflectors act as permutations on tridiagonal matrices, so $Q$ is a permutation matrix.\n这个说法基于一个错误的前提。一个 Householder 反射变换，$H = I - 2 \\frac{v v^{\\top}}{v^{\\top} v}$，通常是一个反射，而不是一个置换。虽然置换矩阵是正交矩阵的一个子集，但 Householder 反射变换是另一个不同的子集。在此问题的特定背景下，反射变换 $P_k$ 都是单位矩阵。单位矩阵技术上也是一个置换矩阵，但选项中提供的理由（“Householder 反射变换起到置换的作用”）在根本上是有缺陷的。因此，此选项 **不正确**。\n\n基于严格的逐步分析，只有选项 A 与问题陈述和 Householder 三对角化算法的原理一致。", "answer": "$$\\boxed{A}$$", "id": "2401945"}, {"introduction": "理论上正确的数学公式在计算机上实现时，可能会因浮点运算的限制而表现不佳。这个练习聚焦于豪斯霍尔德变换构造过程中的一个关键细节：符号的选择，它直接关系到数值稳定性。您将通过一个具体的例子，分析“正确”与“错误”的符号选择如何导致截然不同的数值结果，从而深刻理解为何避免“灾难性抵消”是数值算法设计中的重中之重。[@problem_id:2402000]", "problem": "考虑实对称矩阵\n$$\nA(\\delta)=\n\\begin{pmatrix}\n2 & 1 & \\delta & 0\\\\\n1 & 3 & 0 & 0\\\\\n\\delta & 0 & 4 & 0\\\\\n0 & 0 & 0 & 5\n\\end{pmatrix},\n$$\n其中 $\\delta>0$ 是一个实参数，且满足 $\\delta \\ll 1$。在豪斯霍尔德三对角化的第一步中，我们构造一个豪斯霍尔德反射 $H=I-2uu^{\\mathsf{T}}$，作用于后续的 $(n-1)$ 维子空间，以将第一列对角线以下的元素消去。令 $x\\in\\mathbb{R}^{3}$ 表示由矩阵 $A(\\delta)$ 第一列中位于 $(1,1)$ 位置下方的元素构成的子向量，即 $x=A(\\delta)_{2:4,1}$。构造豪斯霍尔德向量的一种标准方法是使用 $v=x\\pm \\alpha e_1$，其中 $\\alpha=\\|x\\|_2$ 且 $e_1=(1,0,0)^{\\mathsf{T}}$，然后进行归一化 $u=v/\\|v\\|_2$。在这里，两种符号的选择对应于两个代数上等价但在数值上不同的反射。\n\n定义 $v_{\\text{right}}=x+\\alpha e_1$ 和 $v_{\\text{wrong}}=x-\\alpha e_1$。计算下式的精确、闭式解析表达式：\n$$\n\\kappa(\\delta)=\\frac{\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right|}{\\left| \\left(v_{\\text{right}}\\right)_1 \\right|},\n$$\n其中 $\\left(v\\right)_1$ 表示向量 $v$ 的第一个分量。你的最终答案必须是只含 $\\delta$ 的单个简化解析表达式，不得进行任何数值近似。", "solution": "该问题陈述科学严谨、定义明确、客观且自洽。这是一个关于构造豪斯霍尔德反射的数值稳定性的数值线性代数标准练习题。我们开始求解。\n\n给定矩阵为\n$$\nA(\\delta)=\n\\begin{pmatrix}\n2 & 1 & \\delta & 0\\\\\n1 & 3 & 0 & 0\\\\\n\\delta & 0 & 4 & 0\\\\\n0 & 0 & 0 & 5\n\\end{pmatrix}\n$$\n其中 $\\delta > 0$ 是一个实参数。\n\n豪斯霍尔德三对角化的第一步是针对矩阵的第一列。构造反射所需的向量 $x$ 是 $A(\\delta)$ 第一列中位于主对角线元素 $A(\\delta)_{1,1}$ 下方的子向量。$A(\\delta)$ 的第一列为 $(2, 1, \\delta, 0)^{\\mathsf{T}}$。因此，子向量 $x \\in \\mathbb{R}^3$ 由下式给出\n$$\nx = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix}.\n$$\n豪斯霍尔德向量 $v$ 的构造基于 $v = x \\pm \\alpha e_1$，其中 $\\alpha = \\|x\\|_2$ 且 $e_1$ 是 $\\mathbb{R}^3$ 中的第一个标准基向量，即 $e_1 = (1, 0, 0)^{\\mathsf{T}}$。首先，我们计算向量 $x$ 的欧几里得范数 $\\alpha$：\n$$\n\\alpha = \\|x\\|_2 = \\sqrt{1^2 + \\delta^2 + 0^2} = \\sqrt{1 + \\delta^2}.\n$$\n问题定义了两种可能的未归一化豪斯霍尔德向量：\n$$\nv_{\\text{right}} = x + \\alpha e_1\n$$\n$$\nv_{\\text{wrong}} = x - \\alpha e_1\n$$\n在数值算法中，标准的“正确”选择是使 $x \\pm \\alpha e_1$ 中的符号与 $x$ 的第一个分量的符号相匹配，以避免相消误差。由于 $(x)_1 = 1 > 0$，因此数值上稳定的选择是 $v_{\\text{right}}$。问题要求计算一个涉及两种选择的比率。\n\n我们来显式地构造这些向量：\n$$\nv_{\\text{right}} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix} + \\sqrt{1 + \\delta^2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 + \\sqrt{1 + \\delta^2} \\\\ \\delta \\\\ 0 \\end{pmatrix}\n$$\n$$\nv_{\\text{wrong}} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix} - \\sqrt{1 + \\delta^2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - \\sqrt{1 + \\delta^2} \\\\ \\delta \\\\ 0 \\end{pmatrix}\n$$\n我们需要计算比率 $\\kappa(\\delta)$，其定义为\n$$\n\\kappa(\\delta)=\\frac{\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right|}{\\left| \\left(v_{\\text{right}}\\right)_1 \\right|}.\n$$\n第一个分量分别是 $(v_{\\text{right}})_1 = 1 + \\sqrt{1 + \\delta^2}$ 和 $(v_{\\text{wrong}})_1 = 1 - \\sqrt{1 + \\delta^2}$。\n\n我们计算这些分量的绝对值。由于 $\\delta > 0$，我们有 $\\delta^2 > 0$，这意味着 $1 + \\delta^2 > 1$，因此 $\\sqrt{1 + \\delta^2} > 1$。\n项 $(v_{\\text{right}})_1 = 1 + \\sqrt{1 + \\delta^2}$ 是严格为正的，所以其绝对值就是它本身：\n$$\n\\left| \\left(v_{\\text{right}}\\right)_1 \\right| = 1 + \\sqrt{1 + \\delta^2}.\n$$\n项 $(v_{\\text{wrong}})_1 = 1 - \\sqrt{1 + \\delta^2}$ 是严格为负的。其绝对值是该项的相反数：\n$$\n\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right| = - (1 - \\sqrt{1 + \\delta^2}) = \\sqrt{1 + \\delta^2} - 1.\n$$\n现在，我们可以写出 $\\kappa(\\delta)$ 的表达式：\n$$\n\\kappa(\\delta) = \\frac{\\sqrt{1 + \\delta^2} - 1}{\\sqrt{1 + \\delta^2} + 1}.\n$$\n这个表达式是正确的，但可以进一步简化，特别是为了获得一个当 $\\delta$ 很小（如 $\\delta \\ll 1$ 所示）时数值计算上更稳健的形式。这可以通过分子有理化来实现。我们将分子和分母同乘以分子的共轭项，即 $(\\sqrt{1 + \\delta^2} + 1)$：\n$$\n\\kappa(\\delta) = \\left( \\frac{\\sqrt{1 + \\delta^2} - 1}{\\sqrt{1 + \\delta^2} + 1} \\right) \\times \\left( \\frac{\\sqrt{1 + \\delta^2} + 1}{\\sqrt{1 + \\delta^2} + 1} \\right).\n$$\n分子简化为平方差：\n$$\n(\\sqrt{1 + \\delta^2} - 1)(\\sqrt{1 + \\delta^2} + 1) = (\\sqrt{1 + \\delta^2})^2 - 1^2 = (1 + \\delta^2) - 1 = \\delta^2.\n$$\n分母变为一个平方：\n$$\n(\\sqrt{1 + \\delta^2} + 1)(\\sqrt{1 + \\delta^2} + 1) = (\\sqrt{1 + \\delta^2} + 1)^2.\n$$\n将这些结果合并，得到 $\\kappa(\\delta)$ 的最终、简化的闭式表达式：\n$$\n\\kappa(\\delta) = \\frac{\\delta^2}{(\\sqrt{1 + \\delta^2} + 1)^2}.\n$$\n这种形式避免了中间表达式分子中存在的相消误差，这也是区分 $v_{\\text{right}}$ 和 $v_{\\text{wrong}}$ 的全部意义所在。", "answer": "$$\\boxed{\\frac{\\delta^2}{\\left(\\sqrt{1 + \\delta^2} + 1\\right)^2}}$$", "id": "2402000"}, {"introduction": "这是将理论知识转化为实际代码的终极练习。许多数值库（如LAPACK）为了效率，正是以紧凑形式存储变换矩阵的。通过完成这个练习，您不仅能掌握豪斯霍尔德反射的施加方法，还能学会如何高效地从其基本构件中重建完整的正交矩阵 $Q$，这是许多高级算法（如求解特征值问题）中的一个必要步骤。[@problem_id:2401995]", "problem": "给定一个在大小为 $n \\times n$ 的实对称矩阵三对角化过程中产生的豪斯霍尔德(Householder)反射序列的紧凑表示。对于每个满足 $0 \\le k \\le n-3$ 的整数 $k$（使用从零开始的索引），给定一个向量 $v_k \\in \\mathbb{R}^{n-k-1}$，它编码了在尾随子空间上的豪斯霍尔德方向。定义零填充向量 $w_k \\in \\mathbb{R}^n$ 为\n$$\n(w_k)_i =\n\\begin{cases}\n0, & \\text{若 } 0 \\le i \\le k,\\\\\n(v_k)_{i-(k+1)}, & \\text{若 } k+1 \\le i \\le n-1,\n\\end{cases}\n$$\n及标量\n$$\n\\tau_k = \\frac{2}{w_k^\\mathsf{T} w_k}.\n$$\n于是，第 $k$ 个豪斯霍尔德反射为\n$$\nH_k = I - \\tau_k \\, w_k w_k^\\mathsf{T},\n$$\n完整的正交矩阵由以下乘积定义\n$$\nQ = H_0 H_1 \\cdots H_{n-3}.\n$$\n当大小 $n \\le 2$ 时，该乘积为空，您必须取 $Q=I$。\n\n您的任务是根据上述定义的紧凑数据 $(v_k)$ 精确地重构 $Q$。对矩阵元素使用从零开始的索引。\n\n对于下面的每个测试用例，在形成 $Q$ 之后，计算两个量：\n- 元素 $Q_{1,1}$（第1行、第1列的元素），以四舍五入到10位小数的实数形式返回。\n- 行列式 $\\det(Q)$，以等于 $\\det(Q)$ 的最接近整数的形式返回，对于正交矩阵，该值为-1或1。\n\n提供以下测试套件，它包含三个用例：\n\n- 用例 A：$n = 5$，其中 $v_0 = \\left[1.0,\\, 0.3,\\, -0.4,\\, 0.5\\right]$，$v_1 = \\left[1.0,\\, -0.2,\\, 0.7\\right]$，$v_2 = \\left[1.0,\\, 0.6\\right]$。\n\n- 用例 B：$n = 3$，其中 $v_0 = \\left[1.0,\\, -0.4\\right]$。\n\n- 用例 C：$n = 2$，没有反射（集合 $\\{v_k\\}$ 为空），所以 $Q=I$。\n\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序如下：\n$$\n\\left[\\; \\text{用例 A 的 } Q_{1,1},\\; \\text{用例 A 的 } \\det(Q),\\; \\text{用例 B 的 } Q_{1,1},\\; \\text{用例 B 的 } \\det(Q),\\; \\text{用例 C 的 } Q_{1,1},\\; \\text{用例 C 的 } \\det(Q) \\;\\right].\n$$\n三个 $Q_{1,1}$ 值必须四舍五入到10位小数，三个行列式必须是整数。输出行中不允许有空格。此问题不涉及角度。任何量都不涉及物理单位。", "solution": "对问题陈述进行了审慎分析，认定其有效。它提出了一个数值线性代数中的适定问题，所有术语都定义明确无歧义，所有数据都自洽。任务是从其紧凑的豪斯霍尔德表示中重构一个正交矩阵，这是一个标准的、可通过算法指定的过程。\n我们的目标是计算正交矩阵 $Q$，它被定义为一系列豪斯霍尔德反射的乘积：对于给定的矩阵大小 $n$，$Q = H_0 H_1 \\cdots H_{n-3}$。对于 $n \\le 2$ 的情况，$Q$ 定义为单位矩阵 $I$。每个豪斯霍尔德反射 $H_k$ 由 $H_k = I - \\tau_k w_k w_k^\\mathsf{T}$ 给出，其中 $I$ 是 $n \\times n$ 的单位矩阵。向量 $w_k \\in \\mathbb{R}^n$ 是通过在给定向量 $v_k \\in \\mathbb{R}^{n-k-1}$ 的前面填充 $k+1$ 个零来构造的，标量 $\\tau_k$ 定义为 $\\tau_k = 2 / (w_k^\\mathsf{T} w_k)$。\n为了重构 $Q$，我们应避免显式地构造和乘以矩阵 $H_k$，因为这样做的计算成本很高。一个更高效的方法是通过将变换应用于单位矩阵来计算乘积。乘积 $Q = H_0 H_1 \\cdots H_{n-3} I$ 可以通过顺序应用反射来计算。正确的运算顺序至关重要。我们可以将乘积写为：\n$$\nQ = H_0 \\left( H_1 \\left( \\cdots \\left( H_{n-3} I \\right) \\cdots \\right) \\right)\n$$\n这种结构提示了一种算法，我们从一个初始矩阵（比如 $Q_{n-2} = I$）开始，然后按照索引的降序迭代地应用反射。也就是说，对于 $k = n-3, n-4, \\ldots, 0$，我们计算：\n$$\nQ_{k} = H_k Q_{k+1}\n$$\n最终结果将是 $Q = Q_{0}$。\n此次迭代的每一步，即乘以一个豪斯霍尔德矩阵，也可以高效地执行。我们不构造稠密矩阵 $H_k$，而是使用其定义来更新当前累积的矩阵 $Q$：\n$$\nQ_{new} = H_k Q = (I - \\tau_k w_k w_k^\\mathsf{T}) Q = Q - \\tau_k w_k (w_k^\\mathsf{T} Q)\n$$\n此操作是对 $Q$ 的一次秩-1更新，在计算上远比完整的矩阵-矩阵乘法高效。我们首先计算行向量 $w_k^\\mathsf{T} Q$，然后该行向量与 $w_k$ 进行外积运算。\n总体算法如下：\n1.  处理基本情况。若 $n \\le 2$，$Q$ 为 $n \\times n$ 的单位矩阵。\n2.  对于 $n > 2$，将 $Q$ 初始化为 $n \\times n$ 的单位矩阵。\n3.  用索引 $k$ 从 $n-3$ 递减至 $0$ 进行迭代。在每一步中：\n    a.  取所给向量 $v_k$ 并在其前面添加 $k+1$ 个零，以构造向量 $w_k \\in \\mathbb{R}^n$。\n    b.  计算标量 $\\tau_k = 2 / (w_k^\\mathsf{T} w_k)$。分母是 $w_k$ 的欧几里得范数的平方。由于问题给出的向量 $v_k$ 是非零的，因此 $w_k$ 也是非零的，该除法是良定义的。\n    c.  使用秩-1更新来更新矩阵 $Q$：\n        i.  计算行向量 $z^\\mathsf{T} = w_k^\\mathsf{T} Q$。\n        ii. 更新 $Q \\leftarrow Q - \\tau_k w_k z^\\mathsf{T}$。\n4.  循环完成后，矩阵 $Q$ 即为最终的乘积 $H_0 H_1 \\cdots H_{n-3}$。\n5.  从最终的矩阵 $Q$ 中，提取元素 $Q_{1,1}$（基于零的索引，即第二行第二列的元素）并计算行列式 $\\det(Q)$。行列式可作为一致性检验；对于由 $m$ 个反射的乘积形成的正交矩阵，其行列式必须为 $(-1)^m$。此处，对于 $n \\ge 3$，$m = n-2$，所以 $\\det(Q) = (-1)^{n-2}$。\n此过程将应用于每个测试用例，以获得所需的数值结果。", "answer": "[-0.6263599980,-1,0.8620689655,-1,1.0000000000,1]", "id": "2401995"}]}