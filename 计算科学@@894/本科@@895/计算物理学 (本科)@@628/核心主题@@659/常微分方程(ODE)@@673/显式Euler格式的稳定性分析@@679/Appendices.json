{"hands_on_practices": [{"introduction": "理论的理解最好通过实践来巩固。本次动手实践旨在将显式欧拉方法的稳定性理论付诸实践。第一个练习将通过一个具体的计算，让你直观地感受数值不稳定性。我们将使用显式欧拉方法求解一个简单的一阶化学反应模型，并特意选用一个略大于稳定边界的时间步长。通过计算几个时间步后的反应物浓度，你将亲眼见证违反稳定性条件是如何导致数值解出现非物理的振荡和发散行为的。", "problem": "一位科学家正在为一个简单的一级反应中的化学反应物浓度 $C(t)$ 建模。该反应物浓度的变化率与浓度本身成正比，遵循以下微分方程：\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\n速率常数给定为 $k = 50.0 \\text{ s}^{-1}$，时间 $t=0$ 时的初始浓度为 $C(0) = 100.0 \\text{ mol/L}$。\n\n为了预测未来时间的浓度，该科学家采用了一种使用固定时间步长 $h$ 的数值格式。该方法根据显式欧拉更新规则，使用前一个时间步长 $t_n = nh$ 的值来近似时间 $t_{n+1} = (n+1)h$ 时的浓度：\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)_{t=t_n}\n$$\n科学家决定使用 $h = 0.0410 \\text{ s}$ 的时间步长。计算该方法在三个时间步长后预测的浓度数值 $C_3$。答案以 mol/L 为单位，并四舍五入到三位有效数字。", "solution": "我们已知一阶线性常微分方程 $\\frac{dC}{dt}=-kC(t)$ 和显式欧拉更新公式\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)_{t=t_{n}}=C_{n}+h(-kC_{n})=(1-kh)C_{n}.\n$$\n通过递推，可得\n$$\nC_{n}=C_{0}(1-kh)^{n}.\n$$\n当 $C_{0}=100.0$， $k=50.0\\,\\text{s}^{-1}$ 且 $h=0.0410\\,\\text{s}$ 时，无量纲积为\n$$\nkh=(50.0)(0.0410)=2.05,\\quad 1-kh=1-2.05=-1.05.\n$$\n因此，经过三个步长后，\n$$\nC_{3}=100.0\\,(-1.05)^{3}.\n$$\n计算该幂：\n$$\n(-1.05)^{2}=1.1025,\\quad (-1.05)^{3}=1.1025\\times(-1.05)=-1.157625,\n$$\n所以\n$$\nC_{3}=100.0\\times(-1.157625)=-115.7625.\n$$\n四舍五入到三位有效数字得到 $-1.16\\times 10^{2}$，即 $-116$。注意，显式欧拉因子满足 $|1-kh|=1.05>1$，表明对于此步长，该方法是不稳定的，这也解释了非物理的符号变化。", "answer": "$$\\boxed{-116}$$", "id": "2205446"}, {"introduction": "在理解了基本稳定性阈值的概念后，我们进一步探讨“刚性”（stiffness）问题，这是数值分析中的一个核心挑战。本练习将对比一个刚性系统和一个非刚性系统，并要求你为两者分别确定保证稳定性的最大允许步长。通过计算在给定时间区间内完成模拟所需的总步数，你将能够量化刚性问题给显式方法带来的巨大计算成本，从而深刻理解为何稳定性分析不仅是理论上的推导，更是工程计算中必须严肃对待的现实问题。", "problem": "一个显式单步法被用于在时间区间 $[0, T]$（其中 $T=10$）上模拟形如 $\\dot{\\mathbf{y}} = A \\mathbf{y}$ 的线性时不变常微分方程 (ODE)。该方法为显式欧拉格式，使用恒定时间步长 $h$，并且每一步都恰好对右端函数 $f(\\mathbf{y}) = A \\mathbf{y}$ 进行一次求值。\n\n考虑两个系统：\n- 一个刚性系统 $\\dot{\\mathbf{y}} = A_{s}\\mathbf{y}$，其中 $A_{s} = \\mathrm{diag}(-1200, -3)$。\n- 一个非刚性系统 $\\dot{\\mathbf{y}} = A_{n}\\mathbf{y}$，其中 $A_{n} = \\mathrm{diag}(-1, -0.2)$。\n\n你需要为每个系统选择一个最大的恒定步长 $h$，以保证系统的所有本征模态都是线性绝对稳定的。这里的稳定性是指，当显式欧拉方法应用于沿特征向量分解得到的每个标量本征模态时，若精确解是衰减的，则数值解的模不增长。\n\n请仅从以下几点出发：\n- 显式欧拉更新的定义，\n- 线性测试方程 $\\dot{y} = \\lambda y$ 作为沿 $A$ 的一个特征向量的局部模型，\n- 以及对于衰减模态，每步的数值放大率的模不超过1的要求，\n\n推导出每个系统的最大稳定步长，确定从 $t=0$ 推进到 $t=T$ 所需的相应步数 $N$（每步计为一次函数求值），然后计算比率 $R = N_{\\text{stiff}}/N_{\\text{nonstiff}}$。\n\n请以一个未经四舍五入的精确数字给出 $R$。", "solution": "求解过程首先按照要求，从基本原理出发，推导显式欧拉方法的稳定性条件。\n\n将显式欧拉方法应用于标量测试方程 $\\dot{y} = \\lambda y$（其中 $\\lambda \\in \\mathbb{C}$）得到：\n$$ y_{k+1} = y_k + h (\\lambda y_k) = (1 + h\\lambda) y_k $$\n项 $G(z) = 1 + z$ (其中 $z = h\\lambda$) 是放大因子。为使数值解保持稳定（模不增长），该放大因子的模必须不大于1：\n$$ |1 + h\\lambda| \\leq 1 $$\n对于本问题中具有负实数特征值 $\\lambda < 0$ 的系统，稳定性条件变为：\n$$ -1 \\leq 1 + h\\lambda \\leq 1 \\quad \\implies \\quad -2 \\leq h\\lambda \\leq 0 $$\n由于 $h>0$ 且 $\\lambda<0$，起控制作用的条件是 $-2 \\leq h\\lambda$，这等价于 $h \\leq \\frac{2}{|\\lambda|}$。\n\n对于一个方程组，此条件必须对矩阵 $A$ 的所有特征值 $\\lambda_i$ 都成立。为确保所有模态的稳定性，时间步长 $h$ 必须受到模最大特征值的约束：\n$$ h \\leq \\frac{2}{\\max_{i} |\\lambda_i|} $$\n因此，保证稳定性的最大恒定步长 $h_{\\text{max}}$ 为 $h_{\\text{max}} = \\frac{2}{\\max_{i} |\\lambda_i|}$。\n\n现在我们将此结果应用于两个指定的系统。\n\n**对于刚性系统：**\n矩阵为 $A_{s} = \\mathrm{diag}(-1200, -3)$。特征值为 $\\lambda_1 = -1200$ 和 $\\lambda_2 = -3$。\n特征值的最大模为 $\\max(1200, 3) = 1200$。\n刚性系统的最大稳定步长 $h_s$ 为：\n$$ h_s = \\frac{2}{1200} = \\frac{1}{600} $$\n\n**对于非刚性系统：**\n矩阵为 $A_{n} = \\mathrm{diag}(-1, -0.2)$。特征值为 $\\lambda_1 = -1$ 和 $\\lambda_2 = -0.2$。\n特征值的最大模为 $\\max(1, 0.2) = 1$。\n非刚性系统的最大稳定步长 $h_n$ 为：\n$$ h_n = \\frac{2}{1} = 2 $$\n\n接下来，我们确定在长度为 $T=10$ 的时间区间上模拟所需的步数 $N$。步数由 $N = T/h$ 给出。\n\n对于刚性系统，步数 $N_{\\text{stiff}}$ 为：\n$$ N_{\\text{stiff}} = \\frac{T}{h_s} = \\frac{10}{1/600} = 10 \\times 600 = 6000 $$\n\n对于非刚性系统，步数 $N_{\\text{nonstiff}}$ 为：\n$$ N_{\\text{nonstiff}} = \\frac{T}{h_n} = \\frac{10}{2} = 5 $$\n\n最后，我们计算比率 $R = N_{\\text{stiff}}/N_{\\text{nonstiff}}$。\n$$ R = \\frac{N_{\\text{stiff}}}{N_{\\text{nonstiff}}} = \\frac{6000}{5} = 1200 $$\n这个比率代表了当使用具有稳定性约束时间步长的显式方法时，因刚性问题而产生的计算成本代价。", "answer": "$$\n\\boxed{1200}\n$$", "id": "2438035"}, {"introduction": "我们的最后一个练习将稳定性分析的视角拓展到非线性动力学领域，以著名的逻辑斯谛方程（logistic equation）为例。对于非线性系统，稳定性不再是一个全局属性，而是依赖于系统所处的具体状态。通过在方程的平衡点（不动点）附近进行线性化分析，你将发现同一个系统的稳定性要求会随位置的不同而发生剧烈变化，从而掌握强大的局部稳定性分析思想。", "problem": "考虑逻辑斯谛常微分方程 (ODE) $ \\dot{y} = r\\,y\\left(1 - \\frac{y}{K}\\right) $，其中常数 $ r > 0 $ 且 $ K > 0 $。令 $ h > 0 $ 为一个固定的时间步长，并应用显式欧拉方法得到离散更新式 $ y_{n+1} = y_n + h\\,r\\,y_n\\left(1 - \\frac{y_n}{K}\\right) $。对于每个连续不动点 $ y^{*} \\in \\{0, K\\} $，确定使显式欧拉离散化在 $ y^{*} $ 的邻域内线性稳定的最大步长 $ h $。请将您的最终答案以有序对 $ \\left(h_{0,\\max},\\,h_{K,\\max}\\right) $ 的形式，作为 $ r $ 的函数的闭合形式报告。给出精确表达式。", "solution": "逻辑斯谛常微分方程 $ \\dot{y} = r\\,y\\left(1 - \\frac{y}{K}\\right) $ 在 $ y = 0 $ 和 $ y = K $ 处有不动点。步长为 $ h > 0 $ 的显式欧拉方法产生离散映射\n$$\ny_{n+1} \\;=\\; y_n + h\\,f(y_n)\n\\quad\\text{其中}\\quad\nf(y) \\;=\\; r\\,y\\left(1 - \\frac{y}{K}\\right).\n$$\n为评估不动点 $ y^{*} $ 附近离散动力学的线性稳定性，考虑一个由 $ y_n = y^{*} + \\varepsilon_n $ 定义的微扰 $ \\varepsilon_n $。微扰的演化近似为\n$$\n\\varepsilon_{n+1} \\;\\approx\\; \\left(1 + h\\,f'(y^{*})\\right)\\varepsilon_n.\n$$\n线性放大因子为 $ g(y^{*},h) = 1 + h\\,f'(y^{*}) $。离散动力学在 $ y^{*} $ 附近是线性稳定的，当且仅当 $ |g(y^{*},h)| < 1 $。\n\n计算导数\n$$\nf'(y) \\;=\\; r\\left(1 - \\frac{2y}{K}\\right).\n$$\n在每个不动点处求值：\n- 在 $ y^{*} = 0 $ 处，$ f'(0) = r $。\n- 在 $ y^{*} = K $ 处，$ f'(K) = -r $。\n\n因此，放大因子为\n$$\ng(0,h) = 1 + h r,\n\\qquad\ng(K,h) = 1 - h r.\n$$\n对每种情况施加线性稳定性条件 $ |g(y^{*},h)| < 1 $：\n\n1. 在 $ y^{*} = 0 $ 附近：\n$$\n|1 + h r| < 1.\n$$\n对于 $ r > 0 $ 和 $ h > 0 $，有 $ 1 + h r > 1 $，所以该不等式无法满足。因此，不存在能够产生线性稳定性的正步长。最大允许值 $ h_{0,\\max} = 0 $。\n\n2. 在 $ y^{*} = K $ 附近：\n$$\n|1 - h r| < 1\n\\;\\;\\Longleftrightarrow\\;\\;\n-1 < 1 - h r < 1\n\\;\\;\\Longleftrightarrow\\;\\;\n0 < h r < 2.\n$$\n由于 $ r > 0 $，这给出 $ 0 < h < \\frac{2}{r} $。最大稳定步长为 $ h_{K,\\max} = \\frac{2}{r} $。\n\n综合两个结果，最大线性稳定步长的有序对是\n$$\n\\left(h_{0,\\max},\\,h_{K,\\max}\\right) \\;=\\; \\left(0,\\,\\frac{2}{r}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0 & \\frac{2}{r}\\end{pmatrix}}$$", "id": "2441585"}]}