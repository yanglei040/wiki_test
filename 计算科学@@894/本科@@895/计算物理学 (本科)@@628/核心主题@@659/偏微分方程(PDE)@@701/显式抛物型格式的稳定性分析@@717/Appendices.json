{"hands_on_practices": [{"introduction": "让我们从一个基本但具有启发性的场景开始：模拟一根细杆在与环境进行热交换时的温度变化。[@problem_id:2441840] 此练习在标准热传导方程的基础上增加了一个线性“反应”项（代表横向热损失），这是对基础冯·诺依曼分析方法的一个直接扩展。通过这个练习，你将亲手推导出一个包含物理扩散和热损失效应的综合稳定性判据，从而理解阻尼项如何影响显式格式的时间步长限制。", "problem": "一根长度为 $L$ 的细长均匀杆与温度恒定为 $u_{\\mathrm{env}}$ 的周围环境进行侧向热交换。杆内的温度场 $u(x,t)$ 根据以下线性抛物线模型演化\n$$\nu_{t} = D\\,u_{xx} - h\\big(u - u_{\\mathrm{env}}\\big),\n$$\n其中 $0  x  L$ 且 $t  0$，$D  0$ 是热扩散系数，$h \\ge 0$ 是侧向热损失系数。\n\n在均匀空间网格 $x_{j} = j\\,\\Delta x$（其中 $j \\in \\{0,1,\\dots,N\\}$）和时间层 $t^{n} = n\\,\\Delta t$（其中 $n \\in \\mathbb{N}$）上，令 $u_{j}^{n}$ 表示 $u(x_{j},t^{n})$ 的近似值。考虑一个完全显式的有限差分格式，该格式在时间上使用前向差分，在空间上使用中心二阶差分，并在时间层 $t^{n}$ 上显式地计算侧向损失项：\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\Delta t\\left[ D\\,\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}} - h\\left(u_{j}^{n} - u_{\\mathrm{env}}\\right) \\right].\n$$\n\n请求以 $D$、$h$ 和 $\\Delta x$ 的闭式解析表达式，确定最大时间步长 $\\Delta t_{\\max}$，使得该显式格式是稳定的，即没有离散傅里叶误差模态的幅值会从时间层 $t^{n}$ 增加到 $t^{n+1}$。\n\n请以 $\\Delta t_{\\max}$ 的单个解析表达式形式提供您的最终答案。不要提供不等式或方程。无需进行数值舍入。时间步长以秒为单位表示。", "solution": "该问题要求确定给定显式有限差分格式保持稳定性的最大允许时间步长 $\\Delta t_{\\max}$。稳定性将使用 von Neumann 稳定性分析方法进行评估，该方法检查离散傅里叶误差模态的放大情况。\n\n首先，我们来验证问题陈述的有效性。\n给定的已知条件如下：\n- 偏微分方程 (PDE)：$u_{t} = D\\,u_{xx} - h\\big(u - u_{\\mathrm{env}}\\big)$，其中 $0  x  L$ 且 $t  0$。\n- 物理常数：热扩散系数 $D  0$，侧向热损失系数 $h \\ge 0$，以及恒定的环境温度 $u_{\\mathrm{env}}$。\n- 均匀数值网格：$x_{j} = j\\,\\Delta x$，其中 $j \\in \\{0,1,\\dots,N\\}$；以及 $t^{n} = n\\,\\Delta t$，其中 $n \\in \\mathbb{N}$。\n- 有限差分格式：$u_{j}^{n+1} = u_{j}^{n} + \\Delta t\\left[ D\\,\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}} - h\\left(u_{j}^{n} - u_{\\mathrm{env}}\\right) \\right]$。\n- 稳定性判据：“没有离散傅里叶误差模态的幅值会从时间层 $t^{n}$ 增加到 $t^{n+1}$”。\n\n该问题具有科学依据，因为它描述了一个标准的热传导模型和一种常见的数值近似方法（时间前向中心差分，或 FTCS）。该问题提法明确且客观，要求基于一种标准的分析技术得出一个特定量。所提供的信息是自洽且充分的，足以应用 von Neumann 分析法，该方法本质上考虑无限空间域，因此不需要显式的边界条件来分析内部格式的稳定性。因此，该问题被认为是有效的。\n\n为了进行 von Neumann 分析，我们研究一个通用误差分量 $\\epsilon_{j}^{n}$ 的传播，它是网格点 $(x_j, t^n)$ 上数值解与精确解之间的差。由于有限差分格式是线性的，误差必须满足该差分方程的齐次形式。常数项 $h u_{\\mathrm{env}}$ 不影响误差的传播动力学。误差演化方程为：\n$$\n\\epsilon_{j}^{n+1} = \\epsilon_{j}^{n} + \\Delta t\\left[ D\\,\\frac{\\epsilon_{j+1}^{n} - 2\\epsilon_{j}^{n} + \\epsilon_{j-1}^{n}}{(\\Delta x)^{2}} - h\\epsilon_{j}^{n} \\right]\n$$\n可将其重排为：\n$$\n\\epsilon_{j}^{n+1} = \\epsilon_{j}^{n} \\left(1 - \\frac{2 D \\Delta t}{(\\Delta x)^2} - h \\Delta t \\right) + \\frac{D \\Delta t}{(\\Delta x)^2} \\left( \\epsilon_{j+1}^{n} + \\epsilon_{j-1}^{n} \\right)\n$$\n我们考虑误差的单个傅里叶模态，其复数形式表示为：\n$$\n\\epsilon_{j}^{n} = G^{n} \\exp(i k x_{j}) = G^{n} \\exp(i k j \\Delta x)\n$$\n其中 $k$ 是波数，$i = \\sqrt{-1}$，$G$ 是从一个时间步到下一个时间步的放大因子。稳定性要求对于所有可能的波数 $k$，放大因子的模 $|G| \\le 1$。\n\n将傅里叶模态代入误差方程，得到：\n$$\nG^{n+1} \\exp(i k j \\Delta x) = G^{n} \\exp(i k j \\Delta x) + \\Delta t\\left[ D\\,\\frac{G^{n} \\exp(i k (j+1) \\Delta x) - 2G^{n} \\exp(i k j \\Delta x) + G^{n} \\exp(i k (j-1) \\Delta x)}{(\\Delta x)^{2}} - h G^{n} \\exp(i k j \\Delta x) \\right]\n$$\n等式两边同除以 $G^{n} \\exp(i k j \\Delta x)$，我们得到放大因子 $G = G^{n+1}/G^n$ 的表达式：\n$$\nG = 1 + \\Delta t\\left[ D\\,\\frac{\\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x)}{(\\Delta x)^{2}} - h \\right]\n$$\n使用恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，分子中的项变为 $2\\cos(k\\Delta x) - 2$。这可以使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$ 进一步简化，得到 $2\\cos(k\\Delta x) - 2 = -2(1-\\cos(k\\Delta x)) = -4\\sin^2(k\\Delta x/2)$。\n将其代回 $G$ 的表达式中：\n$$\nG = 1 + \\frac{D \\Delta t}{(\\Delta x)^{2}} \\left( -4\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\right) - h \\Delta t\n$$\n$$\nG = 1 - \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) - h \\Delta t\n$$\n放大因子 $G$ 是一个实数。稳定性条件 $|G| \\le 1$ 等价于 $-1 \\le G \\le 1$。\n\n我们分别分析这两个不等式。\n1. $G \\le 1$:\n$$\n1 - \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) - h \\Delta t \\le 1\n$$\n$$\n- \\left( \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) + h \\Delta t \\right) \\le 0\n$$\n由于 $D  0$，$h \\ge 0$，$\\Delta t  0$，且 $\\sin^2(\\cdot) \\ge 0$，该不等式恒成立。它没有对 $\\Delta t$ 施加任何上限。\n\n2. $G \\ge -1$:\n$$\n1 - \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) - h \\Delta t \\ge -1\n$$\n$$\n2 \\ge \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) + h \\Delta t\n$$\n$$\n2 \\ge \\Delta t \\left( \\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) + h \\right)\n$$\n这必须对所有波数 $k$ 都成立。对 $\\Delta t$ 最严格的约束发生在与其相乘的项达到最大值时。项 $\\sin^2(k \\Delta x / 2)$ 的最大值为 $1$，这对应于网格上可表示的最高频率模态（例如，当 $k\\Delta x = \\pi$ 时）。\n为确保对所有模态都稳定，我们必须使用这个最大值：\n$$\n2 \\ge \\Delta t \\left( \\frac{4D}{(\\Delta x)^2} (1) + h \\right)\n$$\n求解 $\\Delta t$：\n$$\n\\Delta t \\le \\frac{2}{\\frac{4D}{(\\Delta x)^2} + h}\n$$\n使该格式稳定的最大时间步长 $\\Delta t_{\\max}$ 是此不等式的上界：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\frac{4D}{(\\Delta x)^2} + h}\n$$\n通过给分子和分母同乘以 $(\\Delta x)^2$，可以对该表达式进行代数重排：\n$$\n\\Delta t_{\\max} = \\frac{2(\\Delta x)^2}{4D + h(\\Delta x)^2}\n$$\n这就是最大稳定时间步长的最终表达式。如果参数 $D$、$h$ 和 $\\Delta x$ 以国际单位制（分别为 m$^2$/s、1/s 和 m）给出，则所得的 $\\Delta t_{\\max}$ 的单位将是秒。", "answer": "$$\n\\boxed{\\frac{2(\\Delta x)^{2}}{4D + h(\\Delta x)^{2}}}\n$$", "id": "2441840"}, {"introduction": "在掌握了标准网格上的分析后，我们来挑战一个更复杂的几何结构：六边形晶格上的扩散过程。[@problem_id:2441880] 这类晶格在材料科学、晶体学和细胞自动机等领域中至关重要。本练习要求你完成两个核心任务：首先，通过泰勒展开确定离散拉普拉斯算子的正确形式以保证其与连续方程的一致性；然后，对这个非标准的差分格式进行稳定性分析。这个过程将加深你对离散化、一致性和稳定性之间内在联系的理解。", "problem": "在间距为 $a$ 的正六边形晶格（等效于三角 Bravais 晶格）上，考虑一个具有恒定扩散系数 $D$ 的二维扩散过程。设晶格点位于位置 $\\mathbf{r}_{i}$，六个最近邻向量由下式给出\n$\\mathbf{e}_{1} = a (1, 0)$, $\\mathbf{e}_{2} = a \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$, $\\mathbf{e}_{3} = a \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$, $\\mathbf{e}_{4} = -\\mathbf{e}_{1}$, $\\mathbf{e}_{5} = -\\mathbf{e}_{2}$, $\\mathbf{e}_{6} = -\\mathbf{e}_{3}$。连续介质方程为 $u_{t} = D \\nabla^{2} u$。在该晶格上考虑前向 Euler 显式时间步进法，\n$$\nu^{n+1}(\\mathbf{r}_{i}) \\;=\\; u^{n}(\\mathbf{r}_{i}) \\;+\\; D \\,\\Delta t\\, \\mathcal{L}_{h} u^{n}(\\mathbf{r}_{i}),\n$$\n其中离散拉普拉斯算子定义为\n$$\n\\mathcal{L}_{h} u(\\mathbf{r}_{i}) \\;=\\; \\alpha \\sum_{m=1}^{6} \\big(u(\\mathbf{r}_{i} + \\mathbf{e}_{m}) - u(\\mathbf{r}_{i})\\big),\n$$\n其中 $\\alpha$ 是一个与晶格相关的常数，其选择应使 $\\mathcal{L}_{h}$ 成为 $\\nabla^{2}$ 的一个相容的二阶近似。\n\n假设晶格是无限的或周期性的，以便可以应用傅里叶（von Neumann）分析。定义无量纲时间步长参数 $\\sigma = \\dfrac{D\\,\\Delta t}{a^{2}}$。从连续介质模型和给定的差分格式出发，通过匹配泰勒展开中的主阶项来确定 $\\alpha$，然后对显式格式进行傅里叶模态稳定性分析。对于所有波向量，能确保线性稳定性的 $\\sigma$ 的最大值是多少？请将答案表示为一个无单位的精确数值。", "solution": "在继续之前，对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 系统是一个具有恒定扩散系数 $D$ 的二维扩散过程。\n- 空间域是一个间距为 $a$ 的正六边形晶格。\n- 晶格点位于位置 $\\mathbf{r}_{i}$。\n- 六个最近邻向量是 $\\mathbf{e}_{1} = a (1, 0)$，$\\mathbf{e}_{2} = a \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$，$\\mathbf{e}_{3} = a \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$，$\\mathbf{e}_{4} = -\\mathbf{e}_{1}$，$\\mathbf{e}_{5} = -\\mathbf{e}_{2}$，$\\mathbf{e}_{6} = -\\mathbf{e}_{3}$。\n- 控制连续介质方程是 $u_{t} = D \\nabla^{2} u$。\n- 数值格式是前向 Euler 方法：$u^{n+1}(\\mathbf{r}_{i}) = u^{n}(\\mathbf{r}_{i}) + D \\Delta t \\mathcal{L}_{h} u^{n}(\\mathbf{r}_{i})$。\n- 离散拉普拉斯算子定义为 $\\mathcal{L}_{h} u(\\mathbf{r}_{i}) = \\alpha \\sum_{m=1}^{6} \\big(u(\\mathbf{r}_{i} + \\mathbf{e}_{m}) - u(\\mathbf{r}_{i})\\big)$。\n- 必须选择常数 $\\alpha$ 以满足相容性，使得 $\\mathcal{L}_{h}$ 是 $\\nabla^{2}$ 的一个二阶近似。\n- 假设晶格是无限的或周期性的，允许进行傅里叶（von Neumann）分析。\n- 无量纲时间步长参数定义为 $\\sigma = \\frac{D \\Delta t}{a^{2}}$。\n- 目标是求出 $\\alpha$ 的值，然后求出保证线性稳定性的 $\\sigma$ 的最大值。\n\n步骤2：使用提取的已知条件进行验证。\n问题是适定的且有科学依据。它提出了计算物理学中的一个标准任务：推导非笛卡尔晶格上有限差分格式的相容性条件，并随后进行 von Neumann 稳定性分析。已知条件是完整的、自洽的，并且没有任何科学或逻辑上的缺陷。该问题是可形式化的，并且与指定主题相关。\n\n步骤3：结论与行动。\n问题有效。将提供解答。\n\n第一个任务是通过要求离散算子 $\\mathcal{L}_{h}$ 是连续拉普拉斯算子 $\\nabla^{2}$ 的一个相容近似来确定常数 $\\alpha$。这可以通过对 $u(\\mathbf{r} + \\mathbf{e}_{m})$ 在点 $\\mathbf{r}$ 周围进行泰勒级数展开来实现。对于一个小的位移向量 $\\mathbf{h}$，其展开式为：\n$$\nu(\\mathbf{r} + \\mathbf{h}) = u(\\mathbf{r}) + (\\mathbf{h} \\cdot \\nabla) u(\\mathbf{r}) + \\frac{1}{2!} (\\mathbf{h} \\cdot \\nabla)^{2} u(\\mathbf{r}) + \\mathcal{O}(|\\mathbf{h}|^{3})\n$$\n将此应用于 $\\mathcal{L}_{h} u(\\mathbf{r}_{i})$ 定义中的求和项：\n$$\n\\sum_{m=1}^{6} \\big(u(\\mathbf{r}_{i} + \\mathbf{e}_{m}) - u(\\mathbf{r}_{i})\\big) = \\sum_{m=1}^{6} \\left[ (\\mathbf{e}_{m} \\cdot \\nabla) u + \\frac{1}{2} (\\mathbf{e}_{m} \\cdot \\nabla)^{2} u \\right]_{\\mathbf{r}_{i}} + \\mathcal{O}(a^{3})\n$$\n一阶项是 $(\\sum_{m=1}^{6} \\mathbf{e}_{m}) \\cdot \\nabla u$。因为邻居向量的集合是对称的（$\\mathbf{e}_{4} = -\\mathbf{e}_{1}$ 等），所以这个和是零向量，即 $\\sum_{m=1}^{6} \\mathbf{e}_{m} = \\mathbf{0}$，因此一阶项消失，这对于中心差分格式是必须的。\n\n二阶项是 $\\frac{1}{2} \\sum_{m=1}^{6} (\\mathbf{e}_{m} \\cdot \\nabla)^{2} u$。令 $\\mathbf{e}_{m} = (e_{mx}, e_{my})$，这个算子展开为：\n$$\n\\frac{1}{2} \\sum_{m=1}^{6} \\left( e_{mx}^{2} \\frac{\\partial^{2} u}{\\partial x^{2}} + e_{my}^{2} \\frac{\\partial^{2} u}{\\partial y^{2}} + 2 e_{mx} e_{my} \\frac{\\partial^{2} u}{\\partial x \\partial y} \\right) = \\frac{1}{2} \\left( \\left(\\sum_{m=1}^{6} e_{mx}^{2}\\right) u_{xx} + \\left(\\sum_{m=1}^{6} e_{my}^{2}\\right) u_{yy} + 2 \\left(\\sum_{m=1}^{6} e_{mx} e_{my}\\right) u_{xy} \\right)\n$$\n我们计算邻居向量分量的和：\n$$\n\\sum_{m=1}^{6} e_{mx}^{2} = a^{2} \\left[ 1^{2} + \\left(\\frac{1}{2}\\right)^{2} + \\left(-\\frac{1}{2}\\right)^{2} + (-1)^{2} + \\left(-\\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2} \\right] = a^{2} \\left( 1 + \\frac{1}{4} + \\frac{1}{4} + 1 + \\frac{1}{4} + \\frac{1}{4} \\right) = 3a^{2}\n$$\n$$\n\\sum_{m=1}^{6} e_{my}^{2} = a^{2} \\left[ 0^{2} + \\left(\\frac{\\sqrt{3}}{2}\\right)^{2} + \\left(\\frac{\\sqrt{3}}{2}\\right)^{2} + 0^{2} + \\left(-\\frac{\\sqrt{3}}{2}\\right)^{2} + \\left(-\\frac{\\sqrt{3}}{2}\\right)^{2} \\right] = a^{2} \\left( 0 + \\frac{3}{4} + \\frac{3}{4} + 0 + \\frac{3}{4} + \\frac{3}{4} \\right) = 3a^{2}\n$$\n交叉项的和由于对称性而消失：\n$$\n\\sum_{m=1}^{6} e_{mx} e_{my} = a^{2} \\left( 0 + \\frac{\\sqrt{3}}{4} - \\frac{\\sqrt{3}}{4} + 0 + \\frac{\\sqrt{3}}{4} - \\frac{\\sqrt{3}}{4} \\right) = 0\n$$\n将这些和代回，二阶项变为：\n$$\n\\frac{1}{2} \\left( 3a^{2} u_{xx} + 3a^{2} u_{yy} \\right) = \\frac{3a^{2}}{2} (u_{xx} + u_{yy}) = \\frac{3a^{2}}{2} \\nabla^{2} u\n$$\n因此，离散拉普拉斯算子是：\n$$\n\\mathcal{L}_{h} u = \\alpha \\left( \\frac{3a^{2}}{2} \\nabla^{2} u + \\mathcal{O}(a^{4}) \\right)\n$$\n为了满足相容性，我们要求 $\\alpha \\frac{3a^{2}}{2} = 1$，这给出 $\\alpha = \\frac{2}{3a^{2}}$。\n\n现在，我们进行 von Neumann 稳定性分析。数值格式为：\n$$\nu^{n+1}(\\mathbf{r}_{i}) = u^{n}(\\mathbf{r}_{i}) + D \\Delta t \\left( \\frac{2}{3a^{2}} \\right) \\sum_{m=1}^{6} \\big(u^{n}(\\mathbf{r}_{i} + \\mathbf{e}_{m}) - u^{n}(\\mathbf{r}_{i})\\big)\n$$\n使用定义 $\\sigma = \\frac{D \\Delta t}{a^{2}}$，上式简化为：\n$$\nu^{n+1}(\\mathbf{r}_{i}) = u^{n}(\\mathbf{r}_{i}) + \\frac{2\\sigma}{3} \\left( \\sum_{m=1}^{6} u^{n}(\\mathbf{r}_{i} + \\mathbf{e}_{m}) - 6 u^{n}(\\mathbf{r}_{i}) \\right)\n$$\n我们代入一个单一的傅里叶模态 $u^{n}(\\mathbf{r}) = G^{n} \\exp(i\\mathbf{k} \\cdot \\mathbf{r})$，其中 $G$ 是放大因子，$\\mathbf{k}$ 是波向量。\n$$\nG^{n+1} e^{i\\mathbf{k} \\cdot \\mathbf{r}_{i}} = G^{n} e^{i\\mathbf{k} \\cdot \\mathbf{r}_{i}} + \\frac{2\\sigma}{3} \\left( \\sum_{m=1}^{6} G^{n} e^{i\\mathbf{k} \\cdot (\\mathbf{r}_{i} + \\mathbf{e}_{m})} - 6 G^{n} e^{i\\mathbf{k} \\cdot \\mathbf{r}_{i}} \\right)\n$$\n两边同除以 $G^{n} \\exp(i\\mathbf{k} \\cdot \\mathbf{r}_{i})$ 得到放大因子：\n$$\nG = 1 + \\frac{2\\sigma}{3} \\left( \\sum_{m=1}^{6} e^{i\\mathbf{k} \\cdot \\mathbf{e}_{m}} - 6 \\right)\n$$\n通过将方向相反的向量配对，可以简化求和：\n$$\n\\sum_{m=1}^{6} e^{i\\mathbf{k} \\cdot \\mathbf{e}_{m}} = \\sum_{m=1}^{3} (e^{i\\mathbf{k} \\cdot \\mathbf{e}_{m}} + e^{-i\\mathbf{k} \\cdot \\mathbf{e}_{m}}) = 2 \\sum_{m=1}^{3} \\cos(\\mathbf{k} \\cdot \\mathbf{e}_{m})\n$$\n所以，放大因子为：\n$$\nG = 1 + \\frac{2\\sigma}{3} \\left( 2 \\sum_{m=1}^{3} \\cos(\\mathbf{k} \\cdot \\mathbf{e}_{m}) - 6 \\right) = 1 + \\frac{4\\sigma}{3} \\left( \\sum_{m=1}^{3} \\cos(\\mathbf{k} \\cdot \\mathbf{e}_{m}) - 3 \\right)\n$$\n为了保证稳定性，我们要求 $|G| \\le 1$。由于 $\\sigma > 0$ 且 $\\sum \\cos(\\cdot) \\le 3$，加到 $1$ 上的项总是非正的，所以 $G \\le 1$ 总是满足的。临界条件是 $G \\ge -1$：\n$$\n1 + \\frac{4\\sigma}{3} \\left( \\sum_{m=1}^{3} \\cos(\\mathbf{k} \\cdot \\mathbf{e}_{m}) - 3 \\right) \\ge -1\n$$\n$$\n\\frac{4\\sigma}{3} \\left( \\sum_{m=1}^{3} \\cos(\\mathbf{k} \\cdot \\mathbf{e}_{m}) - 3 \\right) \\ge -2\n$$\n$$\n\\sigma \\left( 3 - \\sum_{m=1}^{3} \\cos(\\mathbf{k} \\cdot \\mathbf{e}_{m}) \\right) \\le \\frac{3}{2}\n$$\n该不等式必须对所有波向量 $\\mathbf{k}$ 成立。对 $\\sigma$ 的最严格条件来自于最大化括号中的项，这意味着我们必须找到 $S(\\mathbf{k}) = \\sum_{m=1}^{3} \\cos(\\mathbf{k} \\cdot \\mathbf{e}_{m})$ 的最小值。令 $\\boldsymbol{\\xi} = a\\mathbf{k} = (\\xi_x, \\xi_y)$。\n$$\nS(\\boldsymbol{\\xi}) = \\cos(\\xi_x) + \\cos\\left(\\frac{1}{2}\\xi_x + \\frac{\\sqrt{3}}{2}\\xi_y\\right) + \\cos\\left(-\\frac{1}{2}\\xi_x + \\frac{\\sqrt{3}}{2}\\xi_y\\right)\n$$\n使用恒等式 $\\cos(A+B) + \\cos(A-B) = 2\\cos A \\cos B$：\n$$\nS(\\boldsymbol{\\xi}) = \\cos(\\xi_x) + 2\\cos\\left(\\frac{\\sqrt{3}}{2}\\xi_y\\right) \\cos\\left(\\frac{1}{2}\\xi_x\\right)\n$$\n使用恒等式 $\\cos(\\xi_x) = 2\\cos^{2}(\\frac{1}{2}\\xi_x) - 1$：\n$$\nS(\\boldsymbol{\\xi}) = 2\\cos^{2}\\left(\\frac{\\xi_x}{2}\\right) - 1 + 2\\cos\\left(\\frac{\\sqrt{3}}{2}\\xi_y\\right) \\cos\\left(\\frac{\\xi_x}{2}\\right)\n$$\n令 $c_x = \\cos(\\frac{\\xi_x}{2})$ 和 $c_y = \\cos(\\frac{\\sqrt{3}}{2}\\xi_y)$。该表达式是关于 $c_x$ 的二次函数：$f(c_x) = 2c_x^{2} + 2c_y c_x - 1$。对于固定的 $c_y$，此二次函数的最小值在 $c_x = - (2c_y) / (2 \\cdot 2) = -c_y/2$ 处取得。最小值为：\n$$\nf(-c_y/2) = 2(-c_y/2)^{2} + 2c_y(-c_y/2) - 1 = \\frac{c_y^{2}}{2} - c_y^{2} - 1 = -\\frac{1}{2}c_y^{2} - 1\n$$\n为了找到 $S(\\boldsymbol{\\xi})$ 的全局最小值，我们必须关于 $c_y$ 最小化此表达式。由于 $c_y = \\cos(\\cdot)$，其取值范围是 $[-1, 1]$，因此 $c_y^2 \\in [0, 1]$。$-\\frac{1}{2}c_y^{2} - 1$ 的最小值在 $c_y^2$ 取最大值时出现，即 $c_y^2 = 1$。\n$$\n\\min S(\\boldsymbol{\\xi}) = -\\frac{1}{2}(1) - 1 = -\\frac{3}{2}\n$$\n这个最小值在波向量满足例如 $\\cos(\\frac{\\sqrt{3}}{2}\\xi_y)=\\pm 1$ 和 $\\cos(\\frac{\\xi_x}{2}) = \\mp 1/2$ 时出现。这些模态对应于晶格所支持的最高频率。\n\n将这个最小值代入稳定性不等式中：\n$$\n\\sigma \\left( 3 - \\left(-\\frac{3}{2}\\right) \\right) \\le \\frac{3}{2}\n$$\n$$\n\\sigma \\left( \\frac{9}{2} \\right) \\le \\frac{3}{2}\n$$\n$$\n\\sigma \\le \\frac{3/2}{9/2} = \\frac{3}{9} = \\frac{1}{3}\n$$\n确保对所有波向量都稳定的 $\\sigma$ 的最大值是 $\\frac{1}{3}$。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2441880"}, {"introduction": "最后，让我们将技能应用于一个生动且真实的物理化学现象：模拟烤面包片的美拉德反应，这被建模为一个非线性的反应-扩散过程。[@problem_id:2441809] 在这个练习中，你需要在进行稳定性分析之前，首先对控制方程在一个非零的稳态解附近进行线性化。这个综合性实践融合了二维扩散、非线性反应动力学和线性化等关键技术，让你体验如何分析复杂应用模型的数值格式稳定性，从而将在前面练习中学到的技能融会贯通。", "problem": "一片薄的长方形面包片被理想化为一个二维薄片。令 $b(x,y,t)$ 表示一个无量纲的焦化指数，其中 $b \\in [0,1]$。一个用于描述 $b$ 演化的最小模型，耦合了反应前驱物的面内扩散和自催化的 Maillard 反应。其控制偏微分方程 (PDE) 为\n$$\n\\frac{\\partial b}{\\partial t} = D \\nabla^2 b + k\\, b\\,(1-b),\n$$\n其中 $D$ 是有效扩散系数，单位为 $\\mathrm{m^2/s}$；$k$ 是动力学速率，单位为 $\\mathrm{s^{-1}}$。考虑一个间距为 $h$（单位为 $\\mathrm{m}$）的均匀方形网格，一个时间步长为 $\\Delta t$（单位为 $\\mathrm{s}$），以及使用标准五点差分格式计算拉普拉斯算子的显式前向欧拉有限差分格式：\n$$\nb_{i,j}^{n+1} = b_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(b_{i+1,j}^{n} + b_{i-1,j}^{n} + b_{i,j+1}^{n} + b_{i,j-1}^{n} - 4 b_{i,j}^{n}\\right) + k\\, b_{i,j}^{n}\\left(1 - b_{i,j}^{n}\\right)\\right].\n$$\n请分析此显式格式在空间均匀稳态 $b^\\star = 1$ 附近的线性稳定性，并对于给定的 $D$、$k$ 和 $h$，确定能保证线性化格式稳定性的最大允许时间步长 $\\Delta t_{\\max}$（单位为 $\\mathrm{s}$）。您的程序必须为下面的测试集中的每一组参数计算 $\\Delta t_{\\max}$，并以秒为单位，将结果输出为十进制数。\n\n测试集（每个案例为一个三元组 $(D,k,h)$，其中 $D$ 的单位为 $\\mathrm{m^2/s}$，$k$ 的单位为 $\\mathrm{s^{-1}}$，$h$ 的单位为 $\\mathrm{m}$）：\n- 案例 1：$(D,k,h) = \\left(1.0\\times 10^{-6},\\, 5.0\\times 10^{-1},\\, 1.0\\times 10^{-3}\\right)$。\n- 案例 2：$(D,k,h) = \\left(1.0\\times 10^{-6},\\, 0.0,\\, 1.0\\times 10^{-3}\\right)$。\n- 案例 3：$(D,k,h) = \\left(0.0,\\, 2.0,\\, 1.0\\times 10^{-3}\\right)$。\n- 案例 4：$(D,k,h) = \\left(1.0\\times 10^{-6},\\, 5.0\\times 10^{-1},\\, 5.0\\times 10^{-4}\\right)$。\n- 案例 5：$(D,k,h) = \\left(5.0\\times 10^{-7},\\, 2.0\\times 10^{-1},\\, 2.0\\times 10^{-3}\\right)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表，列表内无空格，并按上述案例的顺序排列，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是以秒为单位的 $\\Delta t_{\\max}$ 的十进制数值。", "solution": "所述问题已提交以供验证。根据既定协议提取和分析给定信息。该问题描述了一个标准的反应扩散系统，具体为 Fisher-KPP 方程，及其使用显式有限差分法的数值解。任务是进行线性稳定性分析，这是计算物理学中的一个典型步骤。我们发现该问题具有科学依据、适定且完整，因此被认定为有效。我们开始进行求解。\n\n目标是通过在空间均匀稳态 $b^\\star = 1$ 附近进行线性稳定性分析，来确定所给显式有限差分格式的最大允许时间步长 $\\Delta t_{\\max}$。\n\n控制偏微分方程为：\n$$\n\\frac{\\partial b}{\\partial t} = D \\nabla^2 b + k\\, b\\,(1-b)\n$$\n显式前向欧拉格式由下式给出：\n$$\nb_{i,j}^{n+1} = b_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(b_{i+1,j}^{n} + b_{i-1,j}^{n} + b_{i,j+1}^{n} + b_{i,j-1}^{n} - 4 b_{i,j}^{n}\\right) + k\\, b_{i,j}^{n}\\left(1 - b_{i,j}^{n}\\right)\\right]\n$$\n为分析线性稳定性，我们在稳态 $b^\\star = 1$ 附近引入一个微小扰动 $\\epsilon_{i,j}^n$，使得 $b_{i,j}^n = b^\\star + \\epsilon_{i,j}^n = 1 + \\epsilon_{i,j}^n$。\n\n非线性反应项 $f(b) = k\\, b\\,(1-b)$ 必须在 $b^\\star=1$ 附近进行线性化。其一阶导数为 $f'(b) = k(1 - 2b)$。在稳态处，$f'(1) = k(1 - 2(1)) = -k$。$f(b)$ 在 $b^\\star=1$ 附近的 Taylor 展开为 $f(1+\\epsilon) = f(1) + f'(1)\\epsilon + \\mathcal{O}(\\epsilon^2)$。由于 $f(1)=0$，对于微小的 $\\epsilon$，我们有 $k(1+\\epsilon)(1-(1+\\epsilon)) = k(1+\\epsilon)(-\\epsilon) = -k\\epsilon - k\\epsilon^2 \\approx -k\\epsilon$。\n\n将 $b_{i,j}^n = 1 + \\epsilon_{i,j}^n$ 代入数值格式，并仅保留 $\\epsilon$ 的线性项，可得到扰动的演化方程：\n$$\n1 + \\epsilon_{i,j}^{n+1} = 1 + \\epsilon_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(\\epsilon_{i+1,j}^{n} + \\epsilon_{i-1,j}^{n} + \\epsilon_{i,j+1}^{n} + \\epsilon_{i,j-1}^{n} - 4\\epsilon_{i,j}^{n}\\right) - k\\epsilon_{i,j}^{n}\\right]\n$$\n两边同时减去 $1$，我们得到线性化的差分方程：\n$$\n\\epsilon_{i,j}^{n+1} = \\epsilon_{i,j}^{n} + \\frac{D\\Delta t}{h^2}\\left(\\epsilon_{i+1,j}^{n} + \\epsilon_{i-1,j}^{n} + \\epsilon_{i,j+1}^{n} + \\epsilon_{i,j-1}^{n} - 4\\epsilon_{i,j}^{n}\\right) - k\\Delta t\\epsilon_{i,j}^{n}\n$$\n现在我们应用 von Neumann 稳定性分析。我们考虑扰动的单个 Fourier 模式：\n$$\n\\epsilon_{i,j}^n = A^n e^{\\mathrm{i}(k_x i h + k_y j h)}\n$$\n其中 $A^n$ 是时间步 $n$ 的振幅，$\\mathrm{i}$ 是虚数单位，$k_x, k_y$ 是波数。将其代入线性化方程，并除以 $e^{\\mathrm{i}(k_x i h + k_y j h)}$，得到放大因子 $G = A^{n+1}/A^n$：\n$$\nG = 1 + \\frac{D\\Delta t}{h^2}\\left(e^{\\mathrm{i}k_x h} + e^{-\\mathrm{i}k_x h} + e^{\\mathrm{i}k_y h} + e^{-\\mathrm{i}k_y h} - 4\\right) - k\\Delta t\n$$\n使用恒等式 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$，我们简化表达式：\n$$\nG = 1 + \\frac{2D\\Delta t}{h^2}\\left(\\cos(k_x h) + \\cos(k_y h) - 2\\right) - k\\Delta t\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们可以将其重写为：\n$$\nG = 1 - \\frac{4D\\Delta t}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) - k\\Delta t\n$$\n为使格式稳定，对于所有可能的波数，放大因子的模都不能超过1，即 $|G| \\le 1$。由于 $G$ 是纯实数，该条件等价于 $-1 \\le G \\le 1$。\n\n第一个条件：$G \\le 1$。\n$$\n1 - \\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\le 1\n$$\n$$\n-\\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\le 0\n$$\n鉴于 $D \\ge 0$，$k \\ge 0$，$\\Delta t  0$，且包含正弦的项为非负，此不等式恒成立。该条件对 $\\Delta t$ 没有施加任何限制。\n\n第二个条件：$G \\ge -1$。\n$$\n1 - \\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\ge -1\n$$\n$$\n2 \\ge \\Delta t \\left[ k + \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) \\right]\n$$\n$$\n\\Delta t \\le \\frac{2}{k + \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right)}\n$$\n此不等式必须对所有波数 $(k_x, k_y)$ 成立。为了找到对 $\\Delta t$ 最严格的限制条件，我们必须找到右侧表达式的最小值。这发生在分母最大化时。项 $S = \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)$ 在 $k_x h = \\pi$ 和 $k_y h = \\pi$ 时取得最大值，这对应于最高频率（棋盘格）模式。在这种情况下，$S = \\sin^2(\\pi/2) + \\sin^2(\\pi/2) = 1 + 1 = 2$。\n\n将 $S=2$ 代入不等式，得到适用于所有模式的稳定性约束：\n$$\n\\Delta t \\le \\frac{2}{k + \\frac{4D}{h^2}(2)}\n$$\n因此，为保证线性化格式稳定的最大允许时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{k + \\frac{8D}{h^2}}\n$$\n当 $k=0$ 时，此公式正确地恢复了二维热方程的已知稳定性极限 $\\Delta t \\le h^2/(4D)$；当 $D=0$ 时，此公式也正确地恢复了逻辑斯谛方程的极限 $\\Delta t \\le 2/k$。使用此公式，我们可以计算给定测试案例所需的值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable time step for a 2D reaction-diffusion\n    equation discretized with an explicit finite-difference scheme.\n    \"\"\"\n    # Test suite: each case is a tuple (D, k, h)\n    # D: diffusion coefficient in m^2/s\n    # k: kinetic rate in s^-1\n    # h: grid spacing in m\n    test_cases = [\n        (1.0e-6, 5.0e-1, 1.0e-3),\n        (1.0e-6, 0.0, 1.0e-3),\n        (0.0, 2.0, 1.0e-3),\n        (1.0e-6, 5.0e-1, 5.0e-4),\n        (5.0e-7, 2.0e-1, 2.0e-3),\n    ]\n\n    results = []\n    for D, k, h in test_cases:\n        # The stability condition for the linearized scheme is derived as:\n        # delta_t_max = 2 / (k + 8*D / h^2)\n        \n        # Check for division by zero, although not expected with given test cases.\n        # The denominator is zero only if both D and k are zero.\n        denominator = k + (8.0 * D) / (h**2)\n        \n        if denominator == 0:\n            # For D=0 and k=0, the equation is db/dt = 0, which is stable\n            # for any dt. The result is effectively infinite.\n            # However, this case is not in the test suite and the problem\n            # context implies a finite, positive denominator.\n            # We would need a problem-specific rule for this edge case.\n            # For now, we assume denominator  0.\n            pass\n\n        delta_t_max = 2.0 / denominator\n        results.append(delta_t_max)\n\n    # Format the output as a comma-separated list in brackets, with no spaces.\n    print(f\"[{','.join(f'{r:.17g}' for r in results)}]\")\n\nsolve()\n```", "id": "2441809"}]}