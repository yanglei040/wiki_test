{"hands_on_practices": [{"introduction": "虽然最简单的偏微分方程在整个求解域内都具有单一的类型（例如，椭圆型或双曲型），但许多重要的物理方程的系数会随位置 $ (x, y) $ 变化。这个练习 [@problem_id:2380287] 探讨了这样一个案例，揭示了同一个方程如何在空间的不同区域表现出不同的物理行为。这项技能对于理解复杂系统至关重要，例如，流体的流动可能在一个区域是亚音速的（椭圆型），而在另一个区域是超音速的（双曲型）。", "problem": "考虑二阶线性偏微分方程（PDE）\n$$(x^{2}-1)\\,u_{xx} + 2\\,x y\\,u_{xy} + (y^{2}-1)\\,u_{yy} = 0,$$\n该方程定义在整个 $\\mathbb{R}^{2}$ 平面上，其中 $u=u(x,y)$ 是二次连续可微函数。请通过从第一性原理分析其主部，将此偏微分方程在 $x y$-平面的不同区域内分类为椭圆型、抛物型或双曲型。找出分隔不同类型区域的精确边界曲线，并指明该边界的哪一侧对应于每种类型。\n\n你最终报告的答案必须是关于变量 $x$ 和 $y$ 的单个简化解析表达式，其零水平集恰好是你确定的分类边界。不涉及单位。最终报告的答案中请勿提供不等式或分段描述。", "solution": "问题陈述需经过验证。\n\n**步骤 1：提取已知条件**\n-   给定的偏微分方程为 $(x^{2}-1)\\,u_{xx} + 2\\,x y\\,u_{xy} + (y^{2}-1)\\,u_{yy} = 0$。\n-   定义域为整个平面 $\\mathbb{R}^{2}$。\n-   函数 $u(x,y)$ 被声明为二次连续可微。\n-   任务是在 $xy$-平面的不同区域内将该方程分类为椭圆型、抛物型或双曲型。\n-   任务要求确定分隔这些区域的边界曲线，并指明边界的哪一侧对应于每种类型。\n-   最终答案必须是一个零水平集即为分类边界的单个解析表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题是偏微分方程数学理论中的一个标准练习。基于主部判别式对二阶线性偏微分方程进行分类是一个基本且成熟的概念。该问题在科学上是合理的。\n-   **适定性**：该问题被完全指定。方程已给出，分类过程是唯一且确定性的。该分类问题存在唯一解。\n-   **客观性**：该问题使用精确的数学语言陈述，没有歧义或主观解释的余地。\n\n**步骤 3：结论与行动**\n该问题有效。它是一个在偏微分方程领域内适定的、有科学依据的问题。我将继续进行解答。\n\n对于一个一般的二元二阶线性偏微分方程，\n$$A(x,y) u_{xx} + B(x,y) u_{xy} + C(x,y) u_{yy} + D(x,y) u_x + E(x,y) u_y + F(x,y) u = G(x,y),$$\n其分类取决于其主部的判别式的符号，该判别式定义为 $\\Delta(x,y) = B(x,y)^{2} - 4A(x,y)C(x,y)$。在点 $(x,y)$ 处的方程类型由以下方式确定：\n-   若 $\\Delta  0$，方程为双曲型。\n-   若 $\\Delta = 0$，方程为抛物型。\n-   若 $\\Delta  0$，方程为椭圆型。\n\n给定的方程是\n$$(x^{2}-1)\\,u_{xx} + 2\\,x y\\,u_{xy} + (y^{2}-1)\\,u_{yy} = 0.$$\n通过与一般形式进行比较，我们确定主部的系数：\n-   $A(x,y) = x^{2}-1$\n-   $B(x,y) = 2xy$\n-   $C(x,y) = y^{2}-1$\n\n现在，我们计算判别式 $\\Delta(x,y)$:\n$$\n\\Delta = B^{2} - 4AC = (2xy)^{2} - 4(x^{2}-1)(y^{2}-1)\n$$\n展开各项，我们得到：\n$$\n\\Delta = 4x^{2}y^{2} - 4(x^{2}y^{2} - x^{2} - y^{2} + 1)\n$$\n$$\n\\Delta = 4x^{2}y^{2} - 4x^{2}y^{2} + 4x^{2} + 4y^{2} - 4\n$$\n$$\n\\Delta = 4(x^{2} + y^{2} - 1)\n$$\n$\\Delta$ 的符号由表达式 $x^{2} + y^{2} - 1$ 的符号确定。我们分析以下三种情况。\n\n情况 1：双曲型区域 ($\\Delta  0$)\n方程在 $4(x^{2} + y^{2} - 1)  0$ 的区域是双曲型的。这可以简化为：\n$$x^{2} + y^{2}  1$$\n这个不等式描述了平面上所有在以原点为中心的单位圆外的点 $(x,y)$ 的集合。\n\n情况 2：抛物型边界 ($\\Delta = 0$)\n方程在 $4(x^{2} + y^{2} - 1) = 0$ 的边界上是抛物型的。这可以简化为：\n$$x^{2} + y^{2} = 1$$\n这是以原点为中心的单位圆的方程。这条曲线是分隔不同类型区域的边界。\n\n情况 3：椭圆型区域 ($\\Delta  0$)\n方程在 $4(x^{2} + y^{2} - 1)  0$ 的区域是椭圆型的。这可以简化为：\n$$x^{2} + y^{2}  1$$\n这个不等式描述了所有在以原点为中心的半径为 1 的开圆盘内的点 $(x,y)$ 的集合，也就是单位圆内部的区域。\n\n总结如下：\n-   当 $x^{2} + y^{2}  1$ 时，对于单位圆外部区域的所有点 $(x,y)$，该偏微分方程是**双曲型**的。\n-   当 $x^{2} + y^{2} = 1$ 时，在单位圆上，该偏微分方程是**抛物型**的。\n-   当 $x^{2} + y^{2}  1$ 时，对于单位圆内部区域的所有点 $(x,y)$，该偏微分方程是**椭圆型**的。\n\n问题要求一个零水平集即为分类边界的单个解析表达式。该边界由条件 $\\Delta = 0$ 定义，这等价于 $x^{2} + y^{2} - 1 = 0$。因此，所求的表达式是 $x^{2} + y^{2} - 1$。", "answer": "$$\n\\boxed{x^{2} + y^{2} - 1}\n$$", "id": "2380287"}, {"introduction": "在变量系数的基础上，我们更进一步，考虑非线性偏微分方程，其分类可能不直接依赖于空间坐标，而是依赖于解 $u$ 本身。这个练习 [@problem_id:2380248] 演示了这一深刻的概念，即方程的性质会根据场值的变化而改变。这对于理解诸如激波形成或相变等现象至关重要，在这些现象中，系统的基本物理定律会发生动态变化。", "problem": "在计算物理学中，为二阶偏微分方程（PDE）选择一个稳定且精确的数值方法，取决于该方程的类型（椭圆型、抛物型或双曲型）。考虑以下包含两个自变量 $x$ 和 $y$ 的非线性偏微分方程：\n$$\nu(x,y)^{2}\\,u_{xx}(x,y) + u_{yy}(x,y) = 0,\n$$\n其中 $u$ 是未知场。对于两个变量的二阶偏微分方程，其常规分类方法基于分别乘以 $u_{xx}$、$u_{xy}$ 和 $u_{yy}$ 的系数 $A$、$B$ 和 $C$，并使用逐点计算的判别式 $D = B^{2} - 4AC$。对于非线性方程，$A$、$B$ 和 $C$ 可能依赖于解 $u$ 及其导数，因此方程的类型可能取决于解本身。\n\n从判别式的通用定义出发，且不使用任何针对该方程预先推导的捷径，通过识别 $A$、$B$ 和 $C$ 并构建作为 $u$ 的函数的判别式，来确定给定偏微分方程的类型如何依赖于 $u(x,y)$。说明在 $u \\neq 0$ 和 $u = 0$ 的区域中，这对偏微分方程的类型有何影响。\n\n作为最终答案，请以其最简闭合形式表达式报告判别式 $D(u)$。不需要进行数值近似，也不涉及任何单位。请将您的最终答案表示为单个解析表达式。", "solution": "所陈述的问题是有效的。这是一个关于拟线性偏微分方程分类的适定数学问题，该分类是研究偏微分方程及其数值解法的一个基本概念。我们继续进行分析。\n\n对于两个自变量 $x$ 和 $y$ 的一般二阶拟线性偏微分方程\n$$\nA u_{xx} + B u_{xy} + C u_{yy} + F(x, y, u, u_x, u_y) = 0,\n$$\n其分类由判别式 $D$ 的符号决定，该判别式定义为 $D = B^{2} - 4AC$。在一般情况下，系数 $A$、$B$ 和 $C$ 是 $x$、$y$、$u$、$u_x$ 和 $u_y$ 的函数。方程的类型逐点确定如下：\n- 如果 $D  0$，方程为双曲型。\n- 如果 $D = 0$，方程为抛物型。\n- 如果 $D  0$，方程为椭圆型。\n\n给定的偏微分方程为：\n$$\nu(x,y)^{2}\\,u_{xx}(x,y) + u_{yy}(x,y) = 0.\n$$\n为确定其类型，我们必须首先将给定方程与一般形式进行比较，以识别系数 $A$、$B$ 和 $C$。我们可以将所提供的方程重写，明确显示所有二阶导数项：\n$$\nu(x,y)^{2}\\,u_{xx}(x,y) + (0) u_{xy}(x,y) + (1) u_{yy}(x,y) = 0.\n$$\n通过此比较，我们识别出系数：\n- $u_{xx}$ 的系数是 $A = u(x,y)^{2}$。\n- $u_{xy}$ 的系数是 $B = 0$。\n- $u_{yy}$ 的系数是 $C = 1$。\n\n请注意，系数 $A$ 依赖于解 $u(x,y)$ 本身，这是拟线性或非线性偏微分方程的特征。因此，方程的分类可能在 $(x,y)$ 平面的不同区域有所不同，具体取决于解 $u$ 的值。\n\n接下来，我们使用已识别的系数计算判别式 $D$：\n$$\nD = B^{2} - 4AC = (0)^{2} - 4(u(x,y)^{2})(1) = -4u(x,y)^{2}.\n$$\n我们将判别式表示为 $u$ 的函数，即 $D(u) = -4u^{2}$。由于 $u(x,y)$ 是一个实值场，项 $u^{2}$ 总是非负的，即 $u^{2} \\ge 0$。因此，判别式 $D = -4u^{2}$ 总是非正的，即 $D \\le 0$。这立即意味着给定的方程永远不可能是双曲型，因为这需要 $D  0$。\n\n我们现在根据 $u(x,y)$ 的值分析方程的类型：\n\n1. 在 $u(x,y) \\neq 0$ 的任何区域：\n在这种情况下，$u(x,y)^{2}  0$。因此判别式严格为负：\n$$\nD = -4u(x,y)^{2}  0.\n$$\n因此，在解不为零的任何区域，该偏微分方程是**椭圆型**的。这类问题通常是边值问题，例如求解稳态温度分布。\n\n2. 在 $u(x,y) = 0$ 的任何点或沿任何曲线：\n在这种情况下，$u(x,y)^{2} = 0$。判别式为零：\n$$\nD = -4u(x,y)^{2} = 0.\n$$\n因此，在解为零的位置，该偏微分方程变为**抛物型**。这是一种退化情况。方程类型在某些线上或某些点的变化表明解的性质可能会发生巨大改变。求解此类“混合型”方程的数值方法必须非常谨慎地选择，以处理椭圆型和抛物型行为之间的转换。\n\n总而言之，该偏微分方程是混合型的；在 $u \\neq 0$ 的地方是椭圆型，在 $u = 0$ 的地方变为抛物型。最终答案是判别式的表达式。", "answer": "$$\n\\boxed{-4u^{2}}\n$$", "id": "2380248"}, {"introduction": "作为计算科学的核心任务，我们需要在理论模型和真实世界的数据之间架起一座桥梁。这最后一个练习 [@problem_id:2380244] 将挑战你逆向思考：你不再是分析一个给定的方程，而是要从一个数值解中推断出其潜在的方程类型。这种“系统辨识”的方法展示了偏微分方程的数学特性如何在其解上留下可以被我们通过计算方式检测到的“指纹”。", "problem": "给定一个标量场 $u(x,y)$ 在均匀笛卡尔网格上的采样值，但无法直接获知其底层的偏微分方程 (PDE)。任务是仅利用采样数据的局部相关性，通过计算来估计 $u$ 在该区域内可能满足的未知线性二阶偏微分方程是椭圆型还是双曲型。该分类取决于主部 $A u_{xx} + B u_{xy} + C u_{yy}$ 的判别式 $D = B^2 - 4AC$ 的符号：如果 $D  0$，则该偏微分方程为椭圆型；如果 $D  0$，则为双曲型。所有计算都是无量纲的，任何三角函数都必须使用弧度制角度。\n\n请构建一个程序，针对下述每个测试用例，接收在均匀网格上给定的 $u(x,y)$，并输出一个整数标签：如果你估计其底层偏微分方程为椭圆型，则输出 $+1$；如果为双曲型，则输出 $-1$。你的方法必须仅依赖于采样场值的局部数据相关性。不允许任何外部输入；所有数据均在下方完整指定。\n\n所有测试用例通用的网格规格：\n- 定义域：$x \\in [-1,1]$, $y \\in [-1,1]$。\n- 网格大小：$N \\times N$，其中 $N = 61$，每个方向上有 $61$ 个均匀间隔的节点。\n- 网格间距：$h = \\dfrac{2}{N-1}$。\n- 坐标：$(x_i,y_j)$，其中 $x_i = -1 + (i-1)h$，$y_j = -1 + (j-1)h$，整数索引 $i,j \\in \\{1,2,\\dots,N\\}$。\n\n四个标量场 $u(x,y)$ 的测试套件：\n- 用例 $\\#1$ (椭圆型原型): $u_1(x,y) = x^2 - y^2$。\n- 用例 $\\#2$ (双曲型原型): $u_2(x,y) = \\cos\\!\\big(3 \\pi (x - y)\\big)$。\n- 用例 $\\#3$ (椭圆型，高阶调和函数): $u_3(x,y) = x^3 - 3 x y^2$。\n- 用例 $\\#4$ (带平滑扰动的双曲型): $u_4(x,y) = \\cos\\!\\big(2 \\pi (x - y)\\big) + 0.05 \\cos(4 \\pi x)\\cos(4 \\pi y)$。\n\n要求输出：\n- 生成单行输出，其中包含按测试用例 $(\\#1,\\#2,\\#3,\\#4)$ 顺序排列的四个整数标签，格式为方括号括起来的逗号分隔列表，例如 $[1,-1,1,-1]$。\n\n你的程序必须是自包含的，并且在没有用户输入或外部文件的情况下运行。最终答案没有物理单位，角度必须以弧度为单位。最终输出必须是严格符合指定列表格式的单行文本。每个测试用例的答案必须是集合 $\\{+1,-1\\}$ 中的一个整数。", "solution": "所述问题是有效的。这是一个计算物理学中的适定问题，特别是在偏微分方程 (PDE) 的系统辨识领域。该问题具有科学依据且客观，并提供了构建计算解所需的所有必要信息。其中没有矛盾之处，指定的测试用例是目标偏微分方程类别的标准示例。\n\n问题的核心是，在仅给定其解 $u(x,y)$ 在均匀笛卡尔网格上的离散采样的情况下，估计一个形如\n$$\nA u_{xx} + B u_{xy} + C u_{yy} + \\dots = 0\n$$\n的未知线性二阶偏微分方程的类型（椭圆型或双曲型）。分类依据判别式 $D = B^2 - 4AC$ 的符号。该方法必须基于“局部数据相关性”。\n\n我们将通过使用有限差分模板来近似偏导数，然后辨识这些近似值之间存在的线性代数关系，从而将此要求形式化。这是一个针对未知常系数 $A$、$B$ 和 $C$ 的回归问题。\n\n设网格数据为 $u_{i,j} = u(x_j, y_i)$，其中 $i,j \\in \\{0, 1, \\dots, N-1\\}$ 是从零开始的索引，$N=61$，网格间距为 $h = 2/(N-1)$。我们使用二阶精度的中心差分来近似内部网格点的二阶导数。底层的偏微分方程表明，这些导数的某个线性组合等于零（在发现方程主部时，通常会忽略低阶项和源项）。\n\n与导数相对应的离散算子是通过将模板应用于网格数据得到的。对于内部点 $(i,j)$，其中 $i,j \\in \\{1, \\dots, N-2\\}$，我们定义：\n\\begin{align*}\ns_{xx}[u]_{i,j} = u_{i,j+1} - 2u_{i,j} + u_{i,j-1} \\\\\ns_{yy}[u]_{i,j} = u_{i+1,j} - 2u_{i,j} + u_{i,j-1} \\\\\ns_{xy}[u]_{i,j} = u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}\n\\end{align*}\n注意，这些模板与导数的有限差分近似值成比例：\n$$\nu_{xx} \\approx \\frac{s_{xx}[u]}{h^2}, \\quad u_{yy} \\approx \\frac{s_{yy}[u]}{h^2}, \\quad u_{xy} \\approx \\frac{s_{xy}[u]}{4h^2}\n$$\n将这些代入偏微分方程的主部，得到：\n$$\nA \\frac{s_{xx}[u]}{h^2} + B \\frac{s_{xy}[u]}{4h^2} + C \\frac{s_{yy}[u]}{h^2} \\approx 0\n$$\n两边乘以 $h^2$ 即可得到模板响应自身之间的一个关系：\n$$\nA s_{xx}[u] + \\frac{B}{4} s_{xy}[u] + C s_{yy}[u] \\approx 0\n$$\n我们寻求系数 $(k_1, k_2, k_3)$，使得 $k_1 s_{xx}[u] + k_2 s_{xy}[u] + k_3 s_{yy}[u] \\approx 0$ 在整个网格上近似成立。通过与上述方程比较，我们可以确定 $A=k_1$，$B=4k_2$ 以及 $C=k_3$（在任意缩放因子内成立）。判别式便可估计为：\n$$\nD_{est} = B^2 - 4AC = (4k_2)^2 - 4k_1 k_3 = 16k_2^2 - 4k_1k_3 = 4(4k_2^2 - k_1k_3)\n$$\n因此，判别式的符号由 $4k_2^2 - k_1k_3$ 的符号决定。\n\n为求得系数 $(k_1, k_2, k_3)$，我们将所有 $(N-2)^2$ 个内部点上的模板响应视为向量。设 $\\mathbf{v}_{xx}$、$\\mathbf{v}_{xy}$ 和 $\\mathbf{v}_{yy}$ 分别是模板网格 $s_{xx}[u]$、$s_{xy}[u]$ 和 $s_{yy}[u]$ 展平后的向量。问题就变成了找到一个系数向量 $\\mathbf{k} = [k_1, k_2, k_3]^T$ 来最小化 $\\|\\mathbf{v}_{xx} k_1 + \\mathbf{v}_{xy} k_2 + \\mathbf{v}_{yy} k_3 \\|_2^2$，并满足约束条件 $\\|\\mathbf{k}\\|_2=1$ 以避免平凡解 $\\mathbf{k}=0$。\n\n这是一个标准的总体最小二乘问题。如果我们构建一个数据矩阵 $M = [\\mathbf{v}_{xx} | \\mathbf{v}_{xy} | \\mathbf{v}_{yy}]$，该问题就等价于最小化 $\\|M \\mathbf{k}\\|_2^2 = \\mathbf{k}^T (M^T M) \\mathbf{k}$。解 $\\mathbf{k}$ 是 $3 \\times 3$ 对称矩阵 $M^T M$ 最小特征值对应的特征向量。矩阵 $M^T M$ 正是导数场的协方差矩阵，因此该方法直接实现了寻找“局部数据相关性”的思想。\n\n如果某个导数场恒等于零（或在数值上可忽略不计），例如，对于给定的函数 $u(x,y)$ 有 $u_{xy}=0$，就会出现一种特殊情况。在这种情况下，$M$ 中对应的列向量将为零向量。遵循简约原则（奥卡姆剃刀），我们应该寻求最简单的偏微分方程。这意味着将该零导数的系数设为零，并求解降维后的回归问题。例如，如果 $\\mathbf{v}_{xy} \\approx \\mathbf{0}$，我们便设置 $k_2=0$，并为剩下的两个向量找到最佳拟合的 $[k_1, k_3]$。\n\n完整算法如下：\n1. 对每个测试用例，通过对给定函数 $u(x,y)$ 采样来生成 $N \\times N$ 的数据网格 $U$。\n2. 计算 $(N-2) \\times (N-2)$ 的模板响应网格 $S_{xx}$、$S_{xy}$ 和 $S_{yy}$。\n3. 将这些网格展平为向量 $\\mathbf{v}_{xx}$、$\\mathbf{v}_{xy}$ 和 $\\mathbf{v}_{yy}$。\n4. 预先处理平凡导数。计算这些向量的范数。如果某个范数与最大范数相比可以忽略不计（例如，小于最大范数的 $10^{-9}$ 倍），则将其对应的系数设为零，并将该向量从回归分析中排除。\n5. 由非平凡向量构成数据矩阵 $M$。\n6. 计算协方差矩阵 $C_M = M^T M$。\n7. 求解 $C_M$ 的特征值和特征向量。最小特征值对应的特征向量即为非平凡导数的系数。\n8. 重构完整的系数向量 $\\mathbf{k}=[k_1, k_2, k_3]^T$。\n9. 计算判别式符号的决定项 $D_{sign} = 4k_2^2 - k_1 k_3$。\n10. 对 PDE 进行分类：如果 $D_{sign}  0$，标签为 $+1$（椭圆型）；否则，标签为 $-1$（双曲型）。\n\n此流程提供了一种从采样数据估计偏微分方程类型的鲁棒且客观的方法。", "answer": "[1,-1,1,-1]", "id": "2380244"}]}