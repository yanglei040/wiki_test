{"hands_on_practices": [{"introduction": "我们从一个经典物理问题开始，以奠定坚实的基础。这个练习将带你分析一维杆中的稳态热分布，这是一个直观且基础的场景。通过从热方程出发，推导出在两端温度固定的狄利克雷边界条件下，杆内温度的线性分布，你将亲身体验边界条件如何唯一地确定物理系统的最终状态。[@problem_id:946]", "problem": "考虑一根长度为 $L$ 的一维均匀杆。杆内的温度分布，记为 $u(x, t)$，其中 $x$ 是沿杆的位置（$0 \\le x \\le L$），$t$ 是时间，由一维热方程控制：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n这里，$\\alpha$ 是材料的热扩散率，一个正常数。\n\n我们关心的是稳态温度分布，即经过足够长的时间后，温度不再随时间变化的温度剖面 $u(x)$。这意味着 $\\frac{\\partial u}{\\partial t} = 0$。\n\n杆的两端保持在固定的恒定温度下。这被称为狄利克雷边界条件：\n1. 在 $x=0$ 处，温度为 $u(0) = T_0$。\n2. 在 $x=L$ 处，温度为 $u(L) = T_1$。\n\n从热方程出发，推导沿杆的稳态温度分布 $u(x)$ 作为位置 $x$、长度 $L$ 以及边界温度 $T_0$ 和 $T_1$ 的函数表达式。", "solution": "从热方程中的稳态条件 $\\frac{\\partial u}{\\partial t}=0$ 出发，得到\n$$0=\\alpha\\,\\frac{d^2u}{dx^2}\\,. $$  \n因为 $\\alpha \\ne 0$，\n$$\\frac{d^2u}{dx^2}=0\\,. $$  \n积分一次：\n$$\\frac{du}{dx}=A$$  \n再积分一次：\n$$u(x)=A\\,x+B\\,, $$  \n其中 A 和 B 是常数。\n应用狄利克雷条件：在 $x=0$ 处，$u(0)=B=T_0$；在 $x=L$ 处，$u(L)=AL+B=T_1$。求解 A：\n$$A=\\frac{T_1-T_0}{L}\\,. $$  \n因此，稳态解为\n$$u(x)=T_0+\\frac{T_1-T_0}{L}\\,x\\,. $$", "answer": "$$\\boxed{u(x) = T_0 + \\frac{(T_1 - T_0)x}{L}}$$", "id": "946"}, {"introduction": "掌握了基本求解方法后，我们来深入探讨边界条件背后的物理和数学意义。这个练习是一个思想实验，挑战你预测错误应用边界条件（例如，将狄利克雷与诺伊曼条件调换）会带来何种后果。通过分析这种互换对质量守恒、解的对称性和瞬态行为等方面的具体影响，你将更加深刻地理解为何正确设置边界条件对模拟的有效性至关重要。[@problem_id:2386501]", "problem": "一个在区间 $x \\in [0,L]$ 上，标量场 $u(x,t)$ 的一维 (1D) 扩散过程由以下偏微分方程 (PDE) 控制，其中扩散系数 $D>0$ 为常数：\n$$\n\\frac{\\partial u}{\\partial t} = D\\,\\frac{\\partial^2 u}{\\partial x^2}, \\quad x \\in (0,L), \\; t>0,\n$$\n初始条件为 $u(x,0)=u_0(x)$。预期的边界条件是左边界为狄利克雷条件（固定值），右边界为诺伊曼条件（无通量）：\n$$\nu(0,t)=u_L \\;\\; \\text{对所有 } t\\ge 0, \\qquad \\frac{\\partial u}{\\partial x}(L,t)=0 \\;\\; \\text{对所有 } t\\ge 0,\n$$\n其中 $u_L$ 是一个常数。由于一个错误，某个实现交换了这些边界条件，转而施加了：\n$$\n\\frac{\\partial u}{\\partial x}(0,t)=0 \\;\\; \\text{对所有 } t\\ge 0, \\qquad u(L,t)=u_L \\;\\; \\text{对所有 } t\\ge 0.\n$$\n假设 $u_0(x)$ 和 $u_L$ 是有界的实数值，并将 $u$ 解释为浓度，因此其非负性具有物理意义。\n\n关于这次交换所产生后果的以下陈述中，哪些是正确的？请选择所有适用的选项。\n\nA. 如果 $u_L$ 不随时间变化，那么在预期问题和交换后的问题中，唯一的稳态都是 $u(x)\\equiv u_L$。因此，一个只检查最终稳态 $u(x)$ 的测试无法检测到这个交换。\n\nB. 定义总质量为 $M(t)=\\int_0^L u(x,t)\\,dx$。在预期问题中，有 $M'(t) = -D\\,\\frac{\\partial u}{\\partial x}(0,t)$；而在交换后的问题中，有 $M'(t) = D\\,\\frac{\\partial u}{\\partial x}(L,t)$。因此，在交换后的实现中，任何与环境的质量交换都发生在错误的边界上。\n\nC. 交换狄利克雷和诺伊曼边界条件必然会违反极值原理，因此即使对于所有 $x$ 都有 $u_0(x)\\ge 0$ 且 $u_L\\ge 0$，交换后的模拟通常也会在中间时刻产生负的 $u$ 值。\n\nD. 如果在两次运行中都使用相同的非对称初始条件 $u_0(x)$（关于 $x=L/2$ 不对称），那么预期边界条件运行和交换边界条件运行所产生的时间依赖解通常会有所不同，且这种差异无法通过简单的空间反射 $x\\mapsto L-x$ 得到。\n\nE. 带有混合狄利克雷-诺伊曼边界条件的空间算子 $-D\\,\\frac{d^2}{dx^2}$ 的谱在交换狄利克雷端和诺伊曼端后保持不变；因此，在预期问题和交换后的问题中，瞬态衰减率是相同的，尽管空间模态形状是镜像的。", "solution": "在进行求解之前，对问题陈述进行验证。\n\n**第一步：提取已知条件**\n-   控制 PDE：$\\frac{\\partial u}{\\partial t} = D\\,\\frac{\\partial^2 u}{\\partial x^2}$，对于 $x \\in (0,L)$，$t > 0$，扩散系数 $D > 0$。\n-   定义域：$x \\in [0,L]$。\n-   初始条件：$u(x,0) = u_0(x)$。\n-   预期边界条件 (BCs)：对所有 $t \\ge 0$，有 $u(0,t) = u_L$ 和 $\\frac{\\partial u}{\\partial x}(L,t) = 0$。\n-   交换后的边界条件 (BCs)：对所有 $t \\ge 0$，有 $\\frac{\\partial u}{\\partial x}(0,t) = 0$ 和 $u(L,t) = u_L$。\n-   值 $u_L$ 是一个常数。\n-   初始条件 $u_0(x)$ 和边界值 $u_L$ 是有界的实数值。\n-   场 $u$ 被解释为浓度。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学基础**：该问题描述了一维扩散方程，这是多个科学和工程领域中的一个基本抛物型偏微分方程。边界条件，即狄利克雷（指定 $u$）和诺伊曼（指定 $\\partial u/\\partial n$），是标准的且具有物理意义（例如，固定浓度和无通量边界）。该设置在科学上是无可挑剔的。\n-   **适定性**：带有指定混合边界条件的热/扩散方程的初边值问题是适定问题的经典例子。对于合理的初始数据（例如 $u_0(x) \\in L^2([0,L])$），存在唯一解，该解连续依赖于初始和边界数据。\n-   **客观性**：问题以精确的数学语言陈述，没有任何歧义、主观性或非科学性主张。\n-   **其他标准**：问题是自洽的、一致的，并且描述了一个物理上现实的场景。未检测到任何缺陷。\n\n**第三步：结论与行动**\n该问题是有效的。有必要对每个选项进行全面分析。\n\n**选项分析**\n\n**选项 A 评估**\n稳态解 $u(x)$ 是指 $\\frac{\\partial u}{\\partial t} = 0$ 的解。该 PDE 简化为常微分方程 $D\\,\\frac{d^2 u}{dx^2} = 0$，由于 $D > 0$，这意味着 $\\frac{d^2 u}{dx^2} = 0$。通解是一个线性函数 $u(x) = C_1 x + C_2$，其中 $C_1$ 和 $C_2$ 是由边界条件决定的常数。\n\n1.  **预期问题**：边界条件为 $u(0) = u_L$ 和 $\\frac{du}{dx}(L) = 0$。\n    -   $u(0) = u_L \\implies C_1 \\cdot 0 + C_2 = u_L \\implies C_2 = u_L$。\n    -   $\\frac{du}{dx}(x) = C_1$，所以 $\\frac{du}{dx}(L) = 0 \\implies C_1 = 0$。\n    -   唯一的稳态是 $u(x) = u_L$。\n\n2.  **交换后的问题**：边界条件为 $\\frac{du}{dx}(0) = 0$ 和 $u(L) = u_L$。\n    -   $\\frac{du}{dx}(0) = 0 \\implies C_1 = 0$。\n    -   $u(L) = u_L \\implies C_1 \\cdot L + C_2 = u_L \\implies 0 \\cdot L + C_2 = u_L \\implies C_2 = u_L$。\n    -   唯一的稳态也是 $u(x) = u_L$。\n\n由于两个问题都收敛到相同的稳态解 $u(x) \\equiv u_L$，一个只测量这个最终状态的实验或数值测试将无法区分正确和交换后的实现。\n**结论**：选项 A 的陈述是**正确的**。\n\n**选项 B 评估**\n总质量由 $M(t) = \\int_0^L u(x,t)\\,dx$ 给出。其变化率通过在积分号下求导（莱布尼茨法则）并使用 PDE 得到：\n$$\n\\frac{dM}{dt} = \\int_0^L \\frac{\\partial u}{\\partial t}(x,t)\\,dx = \\int_0^L D\\,\\frac{\\partial^2 u}{\\partial x^2}(x,t)\\,dx\n$$\n根据微积分基本定理，该积分的计算结果为：\n$$\n\\frac{dM}{dt} = D \\left[ \\frac{\\partial u}{\\partial x}(x,t) \\right]_0^L = D \\left( \\frac{\\partial u}{\\partial x}(L,t) - \\frac{\\partial u}{\\partial x}(0,t) \\right)\n$$\n这个方程表示量 $u$ 进入区域的净通量。\n\n1.  **预期问题**：边界条件为 $u(0,t) = u_L$ 和 $\\frac{\\partial u}{\\partial x}(L,t) = 0$。代入 $x=L$ 处的无通量条件：\n    $$\n    \\frac{dM}{dt} = D \\left( 0 - \\frac{\\partial u}{\\partial x}(0,t) \\right) = -D\\,\\frac{\\partial u}{\\partial x}(0,t)\n    $$\n    这表明质量交换仅通过 $x=0$ 处的边界发生。\n\n2.  **交换后的问题**：边界条件为 $\\frac{\\partial u}{\\partial x}(0,t) = 0$ 和 $u(L,t) = u_L$。代入 $x=0$ 处的无通量条件：\n    $$\n    \\frac{dM}{dt} = D \\left( \\frac{\\partial u}{\\partial x}(L,t) - 0 \\right) = D\\,\\frac{\\partial u}{\\partial x}(L,t)\n    $$\n    这表明质量交换仅通过 $x=L$ 处的边界发生。\n\n该陈述正确地给出了 $M'(t)$ 的这些表达式，并正确地得出结论：与环境进行质量交换的位置被交换了。\n**结论**：选项 B 的陈述是**正确的**。\n\n**选项 C 评估**\n该陈述声称交换边界条件违反了极值原理，导致即使在初始和边界数据非负的情况下，$u$ 也会出现负值。这从根本上是错误的。热方程对于包括此处提出的混合狄利克雷-诺伊曼条件在内的多种边界条件都遵循极值（和最小值）原理。\n\n该问题的弱极值原理指出，解 $u(x,t)$ 在区域 $[0,L] \\times [0, T]$ 上的最大值和最小值或者在初始时刻（$t=0$）达到，或者在具有狄利克雷条件的边界部分达到。\n对于交换后的问题，边界数据由 $t=0$ 时的 $u_0(x)$ 和 $u(L,t) = u_L$ 指定。设 $m = \\min\\left( \\inf_{x\\in[0,L]} u_0(x), u_L \\right)$。最小值原理保证对于所有的 $x \\in [0,L]$ 和 $t \\ge 0$，有 $u(x,t) \\ge m$。\n如果给定对于所有 $x$ 都有 $u_0(x) \\ge 0$ 且 $u_L \\ge 0$，那么 $m \\ge 0$。因此，在所有时间内都有 $u(x,t) \\ge 0$。解将保持非负。交换边界条件并不会否定扩散方程的这一基本性质。\n**结论**：选项 C 的陈述是**不正确的**。\n\n**选项 D 评估**\n令 $u_I(x,t)$ 为预期问题的解， $u_S(x,t)$ 为交换后问题的解。\n我们定义一个新函数 $v(x,t) = u_I(L-x, t)$。我们研究 $v(x,t)$ 满足的 PDE 和边界条件。令 $y=L-x$。\n-   $\\frac{\\partial v}{\\partial t} = \\frac{\\partial u_I}{\\partial t}(L-x, t)$。\n-   $\\frac{\\partial v}{\\partial x} = \\frac{\\partial u_I}{\\partial y}(y,t) \\frac{dy}{dx} = -\\frac{\\partial u_I}{\\partial y}(y,t)$。\n-   $\\frac{\\partial^2 v}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(-\\frac{\\partial u_I}{\\partial y}\\right) = -\\frac{\\partial}{\\partial y}\\left(-\\frac{\\partial u_I}{\\partial y}\\right)\\frac{dy}{dx} = \\frac{\\partial^2 u_I}{\\partial y^2}$。\n由于 $\\frac{\\partial u_I}{\\partial t} = D \\frac{\\partial^2 u_I}{\\partial y^2}$，我们有 $\\frac{\\partial v}{\\partial t} = D \\frac{\\partial^2 v}{\\partial x^2}$。所以 $v(x,t)$ 解的是相同的 PDE。\n\n现在，检查 $v(x,t)$ 的边界条件：\n-   在 $x=0$ 处，对应于 $y=L$：$\\frac{\\partial v}{\\partial x}(0,t) = -\\frac{\\partial u_I}{\\partial y}(L,t) = 0$，这是 $x=L$ 处的预期边界条件。\n-   在 $x=L$ 处，对应于 $y=0$：$v(L,t) = u_I(0,t) = u_L$，这是 $x=0$ 处的预期边界条件。\n所以，$v(x,t) = u_I(L-x,t)$ 满足交换后的边界条件。\n\n现在，检查 $v(x,t)$ 的初始条件：\n-   $v(x,0) = u_I(L-x,0) = u_0(L-x)$。\n交换后问题的解 $u_S(x,t)$ 是用初始条件 $u_S(x,0)=u_0(x)$ 定义的。\n因此，$u_I(L-x, t)$ 是*反射后*的初始条件 $u_0(L-x)$ 下交换后问题的解。由于问题陈述 $u_0(x)$ 是非对称的 ($u_0(x) \\not\\equiv u_0(L-x)$)，所以 $u_S(x,t)$ 和 $v(x,t)$ 的初始条件是不同的。根据解的唯一性，通常有 $u_S(x,t) \\neq v(x,t)$。也就是说，$u_S(x,t) \\neq u_I(L-x,t)$。\n这证实了当初始条件非对称时，交换后问题的解并不仅仅是预期问题解的一个空间反射。\n**结论**：选项 D 的陈述是**正确的**。\n\n**选项 E 评估**\n瞬态行为由空间算子 $\\mathcal{L} = -D \\frac{d^2}{dx^2}$ 在相应齐次边界条件下的特征值决定。解是形如 $e^{-\\lambda t}\\phi(x)$ 的模态的叠加，其中 $(\\lambda, \\phi)$ 是 $\\mathcal{L}\\phi = \\lambda\\phi$ 的特征对。特征值 $\\lambda$ 是衰减率。\n\n1.  **预期问题**：特征值问题是 $-D \\phi''(x) = \\lambda \\phi(x)$，边界条件为 $\\phi(0) = 0$, $\\phi'(L) = 0$。令 $k^2 = \\lambda/D$。则 $\\phi''(x) + k^2\\phi(x) = 0$。\n    -   通解：$\\phi(x) = A\\cos(kx) + B\\sin(kx)$。\n    -   $\\phi(0)=0 \\implies A=0$。解为 $\\phi(x) = B\\sin(kx)$。\n    -   $\\phi'(x) = Bk\\cos(kx)$。$\\phi'(L)=0 \\implies \\cos(kL)=0$。\n    -   这要求 $kL = \\frac{(2n-1)\\pi}{2}$，其中 $n=1,2,3,\\dots$。\n    -   $k_n = \\frac{(2n-1)\\pi}{2L}$。\n    -   特征值为 $\\lambda_n = Dk_n^2 = D \\left(\\frac{(2n-1)\\pi}{2L}\\right)^2$。\n    -   特征函数为 $\\phi_n^I(x) = \\sin\\left(\\frac{(2n-1)\\pi x}{2L}\\right)$。\n\n2.  **交换后的问题**：特征值问题是 $-D \\phi''(x) = \\lambda \\phi(x)$，边界条件为 $\\phi'(0) = 0$, $\\phi(L) = 0$。\n    -   通解：$\\phi(x) = A\\cos(kx) + B\\sin(kx)$。\n    -   $\\phi'(x) = -Ak\\sin(kx) + Bk\\cos(kx)$。$\\phi'(0)=0 \\implies B=0$。解为 $\\phi(x) = A\\cos(kx)$。\n    -   $\\phi(L)=0 \\implies \\cos(kL)=0$。\n    -   这得到与 $k$ 相同的条件：$kL = \\frac{(2n-1)\\pi}{2}$，其中 $n=1,2,3,\\dots$。\n    -   特征值 $\\lambda_n = Dk_n^2 = D \\left(\\frac{(2n-1)\\pi}{2L}\\right)^2$ 与预期情况相同。\n    -   特征函数为 $\\phi_n^S(x) = \\cos\\left(\\frac{(2n-1)\\pi x}{2L}\\right)$。\n\n两个问题的特征值集合（谱）是相同的。因此，瞬态衰减率是相同的。\n空间模态形状（特征函数）是不同的。我们来检查它们是否是镜像的：\n$$\n\\phi_n^I(L-x) = \\sin\\left(\\frac{(2n-1)\\pi (L-x)}{2L}\\right) = \\sin\\left(\\frac{(2n-1)\\pi}{2} - \\frac{(2n-1)\\pi x}{2L}\\right)\n$$\n使用三角恒等式 $\\sin(\\alpha - \\beta) = \\sin\\alpha\\cos\\beta - \\cos\\alpha\\sin\\beta$，其中 $\\alpha = (2n-1)\\pi/2$，我们注意到 $\\cos\\alpha=0$ 且 $\\sin\\alpha=(-1)^{n-1}$。\n$$\n\\phi_n^I(L-x) = (-1)^{n-1} \\cos\\left(\\frac{(2n-1)\\pi x}{2L}\\right) \\propto \\phi_n^S(x)\n$$\n一个问题的特征函数（在差一个符号的意义上）是另一个问题特征函数的空间反射。该陈述完全正确。\n**结论**：选项 E 的陈述是**正确的**。", "answer": "$$\\boxed{ABDE}$$", "id": "2386501"}, {"introduction": "现在，让我们将所学知识应用于一个更真实、更复杂的计算物理问题中。本实践要求你使用有限元方法为T形管中的声波建立一个计算模型。你将需要同时实现狄利克雷边界条件（代表开放端）和诺伊曼边界条件（代表封闭端），并处理不同管道交界处的連接条件，这充分展示了边界条件在模拟工程和物理学中波动现象时的强大作用。[@problem_id:2386432]", "problem": "考虑一个由三段直管在单一连接点汇合而成的T型管，其中空气进行小振幅一维线性声学传播。设声压为 $p(x,t)$，沿管道分支的空间坐标为 $x$，声速为 $c$。忽略粘性与热损失，并假设平面波近似成立（即管径远小于所关心的波长）。在每个分支上，控制方程为一维波动方程 $p_{tt} = c^2 p_{xx}$。在主管的开口端，施加狄利克雷（Dirichlet）边界条件 $p = 0$。在两个臂管的闭口端，施加诺伊曼（Neumann）边界条件 $p_x = 0$。在连接点处，施加所有汇入分支的压力连续性条件和体积速度守恒条件。在一维情况下，后者简化为基尔霍夫（Kirchhoff）条件，即向外的体积速度通量之和为零：$\\sum_{i=1}^3 A_i \\, p_x^{(i)}(0,t) = 0$，其中 $A_i$ 是第 $i$ 个分支的横截面积，$x=0$ 是每个分支的连接点坐标，且 $x$ 沿该分支向外增加。\n\n通过寻找分离变量解 $p(x,t) = \\Re\\{ \\phi(x) e^{\\mathrm{i}\\omega t} \\}$ 来建立时谐特征值问题，其中 $\\omega$ 是角频率，$\\phi(x)$ 是复值空间模态振型。证明在每个分支上，空间分量满足亥姆霍兹（Helmholtz）方程 $-\\phi''(x) = k^2 \\phi(x)$（其中 $k = \\omega/c$），以及上述边界条件和连接点条件：$\\phi$ 连续且 $\\sum_{i=1}^3 A_i \\, \\phi_x^{(i)}(0) = 0$。\n\n从一维波动方程的基本形式出发，通过分部积分推导该网络上的有限元弱形式。在每个分支上使用连续的分片线性形函数，组装全局刚度矩阵 $K$ 和质量矩阵 $M$，从而得到离散的广义特征问题 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，其中 $\\lambda = \\omega^2/c^2$。将主管开口端的狄利克雷边界条件作为本质约束施加。闭口端的诺伊曼边界条件是自然边界条件，无需显式修改。连接点的连续性通过让所有汇入分支共享连接点节点来强制执行；基尔霍夫通量条件则通过组装按横截面积加权的单元贡献来隐式执行。\n\n实现一个程序，该程序：\n- 为一个由三个分支在单一连接点汇合的T型管构建全局有限元矩阵 $K$ 和 $M$。每个分支具有特定的长度和横截面积，并在每个分支上使用 $n$ 个均匀的线性单元。\n- 求解广义对称特征问题 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，并计算最小正特征频率 $f_1 = \\omega_1/(2\\pi)$，单位为赫兹（Hertz），其中 $\\omega_1 = c \\sqrt{\\lambda_1}$。\n- 使用给定的声速 $c$，单位为米/秒。\n- 报告频率，单位为赫兹，并四舍五入到两位小数。\n\n使用以下测试套件。在所有案例中，主管是在其自由端（开口端）具有狄利克雷边界条件的分支，两个臂管则具有诺伊曼边界条件（闭口端）。所有长度单位为米，所有面积单位为平方米，$c$ 的单位为米/秒。对于每个案例，还需指定每个分支的均匀线性单元数量。\n\n- 案例A（对称臂管，等截面积；常规路径）：\n  - $c = 343$\n  - 主管长度 $L_s = 0.60$，臂管1长度 $L_1 = 0.40$，臂管2长度 $L_2 = 0.40$\n  - 主管面积 $A_s = 2.0\\times 10^{-4}$，臂管1面积 $A_1 = 2.0\\times 10^{-4}$，臂管2面积 $A_2 = 2.0\\times 10^{-4}$\n  - 单元数：主管 $n_s = 120$，臂管1 $n_1 = 80$，臂管2 $n_2 = 80$\n\n- 案例B（非对称臂管长度；几何极端情况）：\n  - $c = 343$\n  - $L_s = 0.60$, $L_1 = 0.20$, $L_2 = 0.80$\n  - $A_s = 2.0\\times 10^{-4}$, $A_1 = 2.0\\times 10^{-4}$, $A_2 = 2.0\\times 10^{-4}$\n  - $n_s = 120$, $n_1 = 40$, $n_2 = 160$\n\n- 案例C（对称臂管长度；不等截面积；连接点加权极端情况）：\n  - $c = 343$\n  - $L_s = 0.60$, $L_1 = 0.40$, $L_2 = 0.40$\n  - $A_s = 2.0\\times 10^{-4}$, $A_1 = 1.0\\times 10^{-4}$, $A_2 = 4.0\\times 10^{-4}$\n  - $n_s = 120$, $n_1 = 80$, $n_2 = 80$\n\n你的程序必须为每个案例计算基频 $f_1$（单位为赫兹），结果为浮点数并四舍五入到两位小数。最终输出格式必须是单行，包含一个用方括号括起来的逗号分隔列表，顺序为 [案例A结果, 案例B结果, 案例C结果]，例如 \"[$f_A$,$f_B$,$f_C$]\"。不应打印任何额外文本。所有输出单位都必须是赫兹。", "solution": "所给出的问题是计算声学中的一个标准特征值问题，需要通过有限元方法进行公式化和求解。在着手求解之前，有必要进行严格的验证。\n\n**问题验证**\n\n1.  **已知条件提取**：\n    *   控制方程：一维波动方程，$p_{tt} = c^2 p_{xx}$。\n    *   求解域：一个由三个分支在连接点汇合的T型管网络。\n    *   边界条件 (BCs)：主管开口端为狄利克雷边界条件 $p=0$；两个臂管闭口端为诺伊曼边界条件 $p_x=0$。\n    *   连接点条件：压力连续性，$\\phi$ 在连接点处连续；体积速度通量的基尔霍夫定律，$\\sum_{i=1}^3 A_i \\, p_x^{(i)}(0,t) = 0$，其中 $x=0$ 位于连接点。\n    *   假定解的形式：$p(x,t) = \\Re\\{ \\phi(x) e^{\\mathrm{i}\\omega t} \\}$。\n    *   推导出的空间问题：亥姆霍兹方程 $-\\phi''(x) = k^2 \\phi(x)$，其中 $k = \\omega/c$，并服从给定的关于 $\\phi(x)$ 的边界条件和连接点条件。\n    *   数值方法：使用连续分片线性形函数的有限元方法 (FEM)，以建立离散广义特征问题 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，其中 $\\lambda = \\omega^2/c^2$。\n    *   任务：为三个具体测试案例计算最小正特征频率 $f_1 = \\omega_1/(2\\pi) = c\\sqrt{\\lambda_1}/(2\\pi)$。\n    *   测试案例：提供了声速 $c$、分支长度 $L_i$、横截面积 $A_i$ 以及每个分支的单元数 $n_i$ 的具体值。\n\n2.  **有效性检查**：\n    *   **科学依据**：该问题根本上基于线性波动方程，这是小振幅声学的标准模型。边界条件和连接点原理（基尔霍夫定律）在声学中是公认的。使用有限元方法求解得到的亥姆霍兹特征值问题是计算物理学中一种标准且稳健的技术。该问题在科学上是合理的。\n    *   **适定性**：该问题旨在求解一个带有指定边界条件的二阶微分算子的特征值。这构成了一个定义在网络图上的 Sturm-Liouville 类型问题，已知这类问题是适定的，并拥有离散的实数特征值谱。求解最小正特征频率的要求是明确的。\n    *   **客观性**：问题陈述使用了精确、客观和定量的语言。所有必需的物理参数和离散化参数均已提供。\n    *   **完整性与一致性**：问题是自洽的。它提供了进行数值求解所需的所有数据。设置中没有矛盾之处。\n    *   **其他缺陷**：该问题并非不切实际、不适定、不可验证或不可形式化。其设置是将有限元法应用于网络域的一个经典教科书级示例。\n\n3.  **结论**：该问题是有效的。可以构建一个合理的解决方案。\n\n**有限元公式推导**\n\n分析始于时谐波动方程，即亥姆霍兹方程，它定义在T型管网络的每个分支 $i$ 上。为了正确处理连接点处的物理守恒定律，我们考虑该方程的面积加权形式：\n$$\n-A_i \\phi_i''(x) = k^2 A_i \\phi_i(x) \\quad \\text{for } x \\in (0, L_i)\n$$\n其中 $\\phi_i(x)$ 是分支 $i$ 上的空间压力模态，$A_i$ 是其横截面积，$L_i$ 是其长度，$k^2 = \\lambda = \\omega^2/c^2$ 是待求的特征值。\n\n为推导弱形式，我们将方程乘以一个任意的检验函数 $v(x)$（该函数遵守与 $\\phi$ 相同的连续性和本质边界条件），并在整个求解域 $\\Omega = \\bigcup_i [0, L_i]$ 上积分：\n$$\n\\sum_{i=1}^3 \\int_{0}^{L_i} -A_i \\phi_i''(x) v(x) \\, dx = \\lambda \\sum_{i=1}^3 \\int_{0}^{L_i} A_i \\phi_i(x) v(x) \\, dx\n$$\n对每个分支的左侧项应用分部积分，得到：\n$$\n\\int_{0}^{L_i} -A_i \\phi_i'' v \\, dx = \\left[-A_i \\phi_i' v\\right]_0^{L_i} + \\int_{0}^{L_i} A_i \\phi_i' v' \\, dx\n$$\n对所有三个分支（主管 $s$、臂管1、臂管2）求和，完整的方程变为：\n$$\n\\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi_i' v' \\, dx + \\sum_{i=s,1,2} \\left[-A_i \\phi_i' v\\right]_0^{L_i} = \\lambda \\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi_i v \\, dx\n$$\n在外端 ($x=L_i$) 和内部连接点 ($x=0$) 处分析边界项：\n*   在主管的开口端 ($x=L_s$)，我们有狄利克雷条件 $\\phi_s(L_s)=0$。这是一个本质边界条件，意味着它必须施加在解空间上。我们通过要求检验函数在这一点也为零，即 $v(L_s)=0$，来强制执行该条件。因此，在 $x=L_s$ 处的边界项消失。\n*   在臂管的闭口端 ($x=L_1, x=L_2$)，我们有诺伊曼条件 $\\phi_1'(L_1)=0$ 和 $\\phi_2'(L_2)=0$。这些是自然边界条件。由于这些条件，边界项 $-A_1 \\phi_1'(L_1) v(L_1)$ 和 $-A_2 \\phi_2'(L_2) v(L_2)$ 自动消失，而无需对检验函数 $v$ 施加任何约束。\n*   在连接点 ($x=0$) 处，边界项之和为 $\\sum_{i=s,1,2} A_i \\phi_i'(0) v_i(0)$。根据压力连续性，有 $\\phi_s(0)=\\phi_1(0)=\\phi_2(0)$，这一性质也施加于检验函数 $v$ 上，因此 $v_s(0)=v_1(0)=v_2(0) \\equiv v(0)$。该和式变为 $v(0) \\sum_{i} A_i \\phi_i'(0)$。基尔霍夫条件要求净体积速度通量为零，这等价于 $\\sum_{i} A_i \\phi_i'(0) = 0$。这也是一个自然边界条件，它迫使连接点处的边界项之和为零。\n\n在所有边界项都消除后，弱形式为：寻找 $\\phi$（满足 $\\phi_s(L_s)=0$），使得对于所有容许的检验函数 $v$（满足 $v(L_s)=0$）：\n$$\n\\underbrace{\\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi' v' \\, dx}_{a(\\phi, v)} = \\lambda \\underbrace{\\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi v \\, dx}_{b(\\phi, v)}\n$$\n这是一个变分形式 $a(\\phi,v) = \\lambda b(\\phi,v)$，它引出了广义矩阵特征值问题。\n\n为了离散化，我们在每个分支 $i$ 的 $n_i$ 个单元组成的网格上使用连续的分片线性基函数（帽函数）$N_j(x)$。我们将解近似为 $\\phi_h(x) = \\sum_{j} u_j N_j(x)$，其中 $u_j$ 是节点上未知的压力值。使用伽辽金（Galerkin）方法，其中检验函数选自与基函数相同的函数空间，即 $v_h(x) = N_i(x)$，我们得到矩阵系统 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，其矩阵元素为：\n$$\nK_{ij} = a(N_j, N_i) \\quad \\text{and} \\quad M_{ij} = b(N_j, N_i)\n$$\n对于一个长度为 $h$、面积为 $A$ 的单个线性单元，其局部单元刚度矩阵 $k^e$ 和质量矩阵 $m^e$ 计算如下：\n$$\nk^e = \\frac{A}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad m^e = \\frac{Ah}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n全局矩阵 $K$ 和 $M$ 通过对所有单元的贡献求和来组装，并正确映射到全局自由度。连接点的连续性通过为连接点分配一个单一的全局节点索引来物理上强制执行，三个分支的第一个单元都连接到该节点。基尔霍夫条件所要求的面积加权 $A_i$ 由于其存在于单元矩阵公式中而被自然地包含进来。\n\n最后，通过从全局矩阵 $K$ 和 $M$ 中移除与主管末端节点对应的行和列，来施加本质狄利克雷条件 $\\phi_s(L_s)=0$。求解得到的简化系统，以获得最小特征值 $\\lambda_1$。然后，基频（固有频率）计算为 $f_1 = \\frac{c}{2\\pi}\\sqrt{\\lambda_1}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Symmetric arms, equal areas\n        {\n            \"c\": 343, \"Ls\": 0.60, \"L1\": 0.40, \"L2\": 0.40,\n            \"As\": 2.0e-4, \"A1\": 2.0e-4, \"A2\": 2.0e-4,\n            \"ns\": 120, \"n1\": 80, \"n2\": 80\n        },\n        # Case B: Asymmetric arm lengths\n        {\n            \"c\": 343, \"Ls\": 0.60, \"L1\": 0.20, \"L2\": 0.80,\n            \"As\": 2.0e-4, \"A1\": 2.0e-4, \"A2\": 2.0e-4,\n            \"ns\": 120, \"n1\": 40, \"n2\": 160\n        },\n        # Case C: Symmetric arm lengths, unequal areas\n        {\n            \"c\": 343, \"Ls\": 0.60, \"L1\": 0.40, \"L2\": 0.40,\n            \"As\": 2.0e-4, \"A1\": 1.0e-4, \"A2\": 4.0e-4,\n            \"ns\": 120, \"n1\": 80, \"n2\": 80\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        f1 = solve_fem_acoustics(**case)\n        results.append(f\"{f1:.2f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef assemble(K, M, i, j, A, h):\n    \"\"\"\n    Assembles a 1D linear element's stiffness and mass matrices into global matrices.\n    \n    Args:\n        K (np.ndarray): Global stiffness matrix.\n        M (np.ndarray): Global mass matrix.\n        i (int): Global index of the first node.\n        j (int): Global index of the second node.\n        A (float): Cross-sectional area of the element's branch.\n        h (float): Length of the element.\n    \"\"\"\n    ke = (A / h) * np.array([[1, -1], [-1, 1]])\n    me = (A * h / 6) * np.array([[2, 1], [1, 2]])\n    \n    indices = np.ix_([i, j], [i, j])\n    K[indices] += ke\n    M[indices] += me\n\ndef solve_fem_acoustics(c, Ls, L1, L2, As, A1, A2, ns, n1, n2):\n    \"\"\"\n    Constructs and solves the FEM eigenproblem for a T-tube.\n\n    Returns:\n        float: The fundamental frequency f1 in Hertz.\n    \"\"\"\n    # Total number of nodes = junction (1) + stem nodes + arm1 nodes + arm2 nodes\n    num_nodes = 1 + ns + n1 + n2\n    \n    # Initialize global stiffness (K) and mass (M) matrices\n    K = np.zeros((num_nodes, num_nodes))\n    M = np.zeros((num_nodes, num_nodes))\n\n    # Node indexing\n    # Node 0: Junction\n    # Nodes 1 to ns: Stem\n    # Nodes ns+1 to ns+n1: Arm 1\n    # Nodes ns+n1+1 to ns+n1+n2: Arm 2\n    \n    # Assemble Stem Branch\n    hs = Ls / ns\n    # First element: junction to first stem node\n    assemble(K, M, 0, 1, As, hs)\n    # Remaining elements along the stem\n    for i in range(1, ns):\n        assemble(K, M, i, i + 1, As, hs)\n\n    # Assemble Arm 1 Branch\n    h1 = L1 / n1\n    # First element: junction to first arm1 node\n    assemble(K, M, 0, ns + 1, A1, h1)\n    # Remaining elements along arm 1\n    for i in range(1, n1):\n        assemble(K, M, ns + i, ns + i + 1, A1, h1)\n        \n    # Assemble Arm 2 Branch\n    h2 = L2 / n2\n    # First element: junction to first arm2 node\n    assemble(K, M, 0, ns + n1 + 1, A2, h2)\n    # Remaining elements along arm 2\n    for i in range(1, n2):\n        assemble(K, M, ns + n1 + i, ns + n1 + i + 1, A2, h2)\n\n    # Impose Dirichlet boundary condition at the end of the stem (node ns)\n    # This is done by removing the corresponding row and column.\n    dirichlet_node_idx = ns\n    \n    free_dofs = np.delete(np.arange(num_nodes), dirichlet_node_idx)\n    \n    K_red = K[np.ix_(free_dofs, free_dofs)]\n    M_red = M[np.ix_(free_dofs, free_dofs)]\n    \n    # Solve the generalized eigenvalue problem K*u = lambda*M*u\n    # scipy.linalg.eigh returns eigenvalues in ascending order.\n    eigenvalues, _ = linalg.eigh(K_red, M_red)\n    \n    # The smallest eigenvalue lambda_1 (k^2). It must be positive.\n    # The solver might return very small negative values due to numerical precision.\n    lambda_1 = eigenvalues[0]\n    if lambda_1 < 0:\n        lambda_1 = 0 # Or handle error, but for this problem it should be positive.\n\n    # Calculate the fundamental frequency f1\n    # lambda = (omega/c)^2 => omega = c * sqrt(lambda)\n    # f = omega / (2*pi)\n    omega_1 = c * np.sqrt(lambda_1)\n    f1 = omega_1 / (2 * np.pi)\n    \n    return f1\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2386432"}]}