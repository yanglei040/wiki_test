{"hands_on_practices": [{"introduction": "密度泛函理论的核心在于精确的交换关联泛函，而科恩-沈（Kohn-Sham）势是其关键组成部分，但它通常以一种抽象的方式被引入。这个实践练习通过一个精确可解的模型揭开了它的神秘面纱。你将通过第一性原理，为一个简单的一维相互作用体系构建精确的科恩-沈势，从而亲身体验如何从精确的电子密度反演出与之对应的势场。这项练习将为你提供对科恩-沈理论基础的深刻而具体理解 [@problem_id:2384975]。", "problem": "在原子单位制下，考虑一个一维系统，其中包含两个处于自旋单重态的自旋-$\\tfrac{1}{2}$全同费米子，其相互作用哈密顿量为\n$$\n\\hat{H}(\\omega,k) \\;=\\; -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} \\;-\\;\\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} \\;+\\; \\frac{1}{2}\\,\\omega^2\\,(x_1^2+x_2^2) \\;+\\; \\frac{1}{2}\\,k\\,(x_1-x_2)^2,\n$$\n其中 $\\omega>0$ 和 $k\\ge 0$ 是实常数，$x_1$ 和 $x_2$ 是粒子沿直线的坐标，所有量均以原子单位制表示（能量单位为哈特里，长度单位为玻尔）。引入质心坐标和相对坐标\n$$\nX=\\frac{x_1+x_2}{2},\\qquad u=x_1-x_2.\n$$\n假设空间基态是归一化且非简并的。精确的单体密度为\n$$\nn(x)\\;=\\;2\\int_{-\\infty}^{+\\infty}\\left|\\Psi(x,x_2)\\right|^2\\,dx_2,\n$$\n其中 $\\Psi(x_1,x_2)$ 是精确的相互作用基态空间波函数。\n\n在Kohn-Sham密度泛函理论 (DFT) 中，这个自旋补偿的双电子系统被映射到一个单一的双占据Kohn-Sham (KS) 轨道 $\\varphi(x)$，该轨道遵循不含时的Kohn-Sham方程\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2}+v_{KS}(x)\\right]\\varphi(x)=\\varepsilon\\,\\varphi(x),\\qquad n(x)=2|\\varphi(x)|^2,\n$$\n其中 $v_{KS}(x)$ 是Kohn-Sham有效势，$\\varepsilon$ 是对应的轨道能量。势 $v_{KS}(x)$ 的定义允许相差一个附加常数。通过以下约定固定其规范\n$$\nv_{KS}(0)=0.\n$$\n\n任务：对于上面定义的系统 $\\hat{H}(\\omega,k)$，使用第一性原理构建一个精确可解的相互作用基态，获得精确密度 $n(x)$，然后数值确定能够复现此密度的精确Kohn-Sham势 $v_{KS}(x)$（对于一个单一的双占据轨道）。您必须使用规范条件 $v_{KS}(0)=0$，并为每对参数 $(\\omega,k)$ 返回以下三个标量值：\n- $v_{KS}(0)$ 的值，单位为哈特里，\n- $v_{KS}(x)$ 在 $x=1$ 玻尔处的值（即 $v_{KS}(1)$），单位为哈特里，\n- 曲率 $\\kappa=\\left.\\dfrac{d^2 v_{KS}}{dx^2}\\right|_{x=0}$，单位为哈特里/玻尔平方。\n\n使用以下参数值测试套件：\n- 情况 A: $(\\omega,k)=(1.0,0.5)$\n- 情况 B: $(\\omega,k)=(1.2,0.0)$\n- 情况 C: $(\\omega,k)=(0.8,4.0)$\n\n您的程序必须输出一行，其中包含九个结果，按案例顺序排列为\n$$\n\\big[v_{KS}^{(A)}(0),\\; v_{KS}^{(A)}(1),\\; \\kappa^{(A)},\\; v_{KS}^{(B)}(0),\\; v_{KS}^{(B)}(1),\\; \\kappa^{(B)},\\; v_{KS}^{(C)}(0),\\; v_{KS}^{(C)}(1),\\; \\kappa^{(C)}\\big],\n$$\n以逗号分隔的列表形式打印在方括号内，占单行，无附加文本。所有能量必须以哈特里为单位，曲率以哈特里/玻尔平方为单位。此问题不涉及角度。不出现百分比；任何比率必须表示为小数或分数，不带百分号。", "solution": "所述问题具有科学依据，论述严谨，客观且自洽。它描述了一个可解的模型系统，即一维谐振子原子 (harmonium atom)，并提出了密度泛函理论中的一个标准任务：反演Kohn-Sham方程以找到能复现精确基态密度的精确有效势。该问题是有效的，并将提供解答。\n\n步骤如下：首先，我们通过将哈密顿量分离为质心坐标和相对坐标来求解精确的双粒子薛定谔方程。其次，我们从得到的基态波函数中推导出精确的单体密度。第三，我们利用Kohn-Sham系统的定义来确定唯一的Kohn-Sham轨道，并通过反演Kohn-Sham方程得到精确的Kohn-Sham势 $v_{KS}(x)$。最后，我们为指定的参数计算所需的量。\n\n### 步骤1：求解精确的相互作用系统\n\n双粒子哈密顿量由下式给出\n$$\n\\hat{H}(\\omega,k) \\;=\\; -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} \\;-\\;\\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} \\;+\\; \\frac{1}{2}\\,\\omega^2\\,(x_1^2+x_2^2) \\;+\\; \\frac{1}{2}\\,k\\,(x_1-x_2)^2.\n$$\n我们引入质心坐标 $X=\\frac{x_1+x_2}{2}$ 和相对坐标 $u=x_1-x_2$。逆变换为 $x_1=X+\\frac{u}{2}$ 和 $x_2=X-\\frac{u}{2}$。\n\n在这些新坐标中，动能算符变为\n$$\n-\\frac{1}{2}\\left(\\frac{\\partial^2}{\\partial x_1^2} + \\frac{\\partial^2}{\\partial x_2^2}\\right) = -\\frac{1}{4}\\frac{\\partial^2}{\\partial X^2} - \\frac{\\partial^2}{\\partial u^2}.\n$$\n这对应于一个质量为 $M=2$ 的质心粒子和一个约化质量为 $\\mu=1/2$ 的相对粒子的动能。\n\n势能变为\n$$\nV(x_1, x_2) = \\frac{1}{2}\\omega^2(x_1^2+x_2^2) + \\frac{1}{2}k(x_1-x_2)^2 = \\frac{1}{2}\\omega^2\\left(2X^2 + \\frac{u^2}{2}\\right) + \\frac{1}{2}ku^2 = \\omega^2 X^2 + \\left(\\frac{\\omega^2}{4} + \\frac{k}{2}\\right)u^2.\n$$\n哈密顿量是可分离的：$\\hat{H} = \\hat{H}_X + \\hat{H}_u$，其中\n$$\n\\hat{H}_X = -\\frac{1}{4}\\frac{\\partial^2}{\\partial X^2} + \\omega^2 X^2 = -\\frac{1}{2M}\\frac{\\partial^2}{\\partial X^2} + \\frac{1}{2}M\\Omega_X^2 X^2\n$$\n$$\n\\hat{H}_u = -\\frac{\\partial^2}{\\partial u^2} + \\left(\\frac{\\omega^2}{4} + \\frac{k}{2}\\right)u^2 = -\\frac{1}{2\\mu}\\frac{\\partial^2}{\\partial u^2} + \\frac{1}{2}\\mu\\Omega_u^2 u^2.\n$$\n通过比较系数，我们找到这两个非耦合谐振子的频率：\n对于质心运动：$M=2$，$\\frac{1}{2}M\\Omega_X^2 = \\omega^2 \\implies \\Omega_X^2 = \\omega^2 \\implies \\Omega_X = \\omega$。\n对于相对运动：$\\mu=1/2$，$\\frac{1}{2}\\mu\\Omega_u^2 = \\frac{\\omega^2}{4} + \\frac{k}{2} \\implies \\frac{1}{4}\\Omega_u^2 = \\frac{\\omega^2}{4} + \\frac{k}{2} \\implies \\Omega_u = \\sqrt{\\omega^2+2k}$。\n\n系统的基态波函数是这两个振子基态波函数的乘积，$\\Psi(X,u) = \\Psi_X(X) \\Psi_u(u)$。对于自旋单重态，空间波函数在粒子交换（$x_1 \\leftrightarrow x_2$）下必须是对称的，这对应于 $(X, u) \\leftrightarrow (X, -u)$。相对振子的基态是 $u$ 的一个偶函数，因此该条件得到满足。\n基态波函数是一个高斯函数：\n$$\n\\Psi(x_1, x_2) = C \\exp\\left(-\\frac{M\\Omega_X}{2}X^2 - \\frac{\\mu\\Omega_u}{2}u^2\\right) = C \\exp\\left(-\\omega X^2 - \\frac{\\sqrt{\\omega^2+2k}}{4}u^2\\right),\n$$\n其中 $C$ 是归一化常数。\n\n### 步骤2：推导精确的单体密度\n\n单体密度定义为 $n(x) = 2 \\int_{-\\infty}^{\\infty} |\\Psi(x, x_2)|^2 dx_2$。令 $x_1=x$。\n波函数的平方为 $|\\Psi(x,x_2)|^2 = |C|^2 \\exp\\left(-2\\omega (\\frac{x+x_2}{2})^2 - \\frac{\\sqrt{\\omega^2+2k}}{2} (x-x_2)^2\\right)$。\n对 $x_2$ 的积分是一个标准的高斯积分。指数是 $x_2$ 的一个二次型：$A x_2^2 + B x_2 + D$。在进行积分后，发现密度是 $x$ 的一个高斯函数：\n$$\nn(x) = N_0 \\exp(-\\gamma x^2),\n$$\n其中衰减常数 $\\gamma$ 由下式给出\n$$\n\\gamma = \\frac{2\\omega\\Omega_u}{\\omega+\\Omega_u} = \\frac{2\\omega\\sqrt{\\omega^2+2k}}{\\omega+\\sqrt{\\omega^2+2k}}.\n$$\n归一化常数 $N_0$ 满足 $\\int_{-\\infty}^\\infty n(x)dx=2$。\n\n### 步骤3：Kohn-Sham方程的反演\n\n在这个自旋补偿系统的Kohn-Sham框架中，密度由 $n(x) = 2|\\varphi(x)|^2$ 给出，其中 $\\varphi(x)$ 是单一的双占据Kohn-Sham轨道。\n从精确密度中，我们找到KS轨道（忽略一个无关的相位因子，我们选择它为实数且为正）：\n$$\n\\varphi(x) = \\sqrt{\\frac{n(x)}{2}} = \\sqrt{\\frac{N_0}{2}} \\exp\\left(-\\frac{\\gamma}{2}x^2\\right).\n$$\n这是一个高斯函数，它是一维简谐振子的基态。因此，Kohn-Sham势 $v_{KS}(x)$ 必须是形如 $v_{KS}(x) = \\frac{1}{2}m_{KS}\\omega_{KS}^2 x^2 + \\text{常数}$ 的二次势。\n\n我们可以通过反演KS方程来确定 $v_{KS}(x)$：\n$$\nv_{KS}(x) = \\varepsilon + \\frac{1}{2}\\frac{1}{\\varphi(x)}\\frac{d^2\\varphi(x)}{dx^2}.\n$$\n令 $\\varphi(x) = A \\exp(-\\frac{\\gamma}{2}x^2)$。其二阶导数为 $\\frac{d^2\\varphi}{dx^2} = (-\\gamma+\\gamma^2 x^2)\\varphi(x)$。\n将此代入 $v_{KS}(x)$ 的表达式中：\n$$\nv_{KS}(x) = \\varepsilon + \\frac{1}{2}(-\\gamma+\\gamma^2 x^2) = \\left(\\varepsilon - \\frac{\\gamma}{2}\\right) + \\frac{1}{2}\\gamma^2 x^2.\n$$\n势的定义允许相差一个常数。我们使用指定的规范条件 $v_{KS}(0)=0$ 来固定这个常数。\n$$\nv_{KS}(0) = \\varepsilon - \\frac{\\gamma}{2} = 0 \\implies \\varepsilon = \\frac{\\gamma}{2}.\n$$\n因此，精确的Kohn-Sham势为\n$$\nv_{KS}(x) = \\frac{1}{2}\\gamma^2 x^2.\n$$\n\n### 步骤4：计算可观测量\n\n现在我们可以使用推导出的 $v_{KS}(x)$ 和 $\\gamma$ 的表达式来计算所需的量。\n1.  势在原点的值：根据规范条件，这恰好为零。\n    $$\n    v_{KS}(0) = 0.\n    $$\n2.  势在 $x=1$ 玻尔处的值：\n    $$\n    v_{KS}(1) = \\frac{1}{2}\\gamma^2.\n    $$\n3.  势在原点的曲率：\n    $$\n    \\kappa = \\left.\\frac{d^2 v_{KS}}{dx^2}\\right|_{x=0} = \\left.\\frac{d^2}{dx^2}\\left(\\frac{1}{2}\\gamma^2 x^2\\right)\\right|_{x=0} = \\gamma^2.\n    $$\n注意 $v_{KS}(1) = \\kappa/2$。\n\n最终的步骤是，将每个案例给定的 $\\omega$ 和 $k$ 值代入 $\\gamma$ 的表达式中，然后计算 $\\kappa = \\gamma^2$ 和 $v_{KS}(1) = \\kappa/2$。\n\n以情况 A，$(\\omega,k)=(1.0,0.5)$ 为例进行计算：\n$\\Omega_u = \\sqrt{1.0^2 + 2(0.5)} = \\sqrt{2}$。\n$\\gamma = \\frac{2(1.0)\\sqrt{2}}{1.0+\\sqrt{2}} = \\frac{2\\sqrt{2}( \\sqrt{2}-1)}{(1+\\sqrt{2})(\\sqrt{2}-1)} = 4 - 2\\sqrt{2}$。\n$\\kappa = (4 - 2\\sqrt{2})^2 = 16 - 16\\sqrt{2} + 8 = 24 - 16\\sqrt{2}$。\n$v_{KS}(1) = \\frac{1}{2}\\kappa = 12 - 8\\sqrt{2}$。\n$v_{KS}(0) = 0$。\n\n对所有测试案例应用相同的步骤以生成最终的数值结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Kohn-Sham potential properties for a 1D two-electron system.\n\n    The problem provides an exactly solvable interacting two-electron system in a \n    harmonic trap with harmonic inter-particle interaction. The task is to find \n    the exact Kohn-Sham (KS) potential that reproduces the exact ground-state density.\n\n    The analytic solution shows that the KS potential is also harmonic, of the form\n    v_KS(x) = 0.5 * gamma**2 * x**2, where gamma is a function of the system\n    parameters omega and k.\n    \"\"\"\n    \n    # Test cases are given as tuples (omega, k).\n    test_cases = [\n        (1.0, 0.5),  # Case A\n        (1.2, 0.0),  # Case B\n        (0.8, 4.0),  # Case C\n    ]\n\n    results = []\n    \n    for omega, k in test_cases:\n        # Step 1: Calculate the frequency of the relative-coordinate oscillator.\n        # Omega_u = sqrt(omega^2 + 2*k)\n        omega_u = np.sqrt(omega**2 + 2 * k)\n\n        # Step 2: Calculate the density decay parameter gamma.\n        # gamma = (2 * omega * Omega_u) / (omega + Omega_u)\n        gamma = (2 * omega * omega_u) / (omega + omega_u)\n\n        # Step 3: Calculate the requested quantities.\n        # The KS potential is v_KS(x) = 0.5 * gamma^2 * x^2.\n        \n        # v_KS(0) is 0 by the specified gauge condition.\n        vks_at_0 = 0.0\n        \n        # The curvature kappa is the second derivative at x=0, which is gamma^2.\n        kappa = gamma**2\n        \n        # v_KS(1) is simply 0.5 * gamma^2 * 1^2 = 0.5 * kappa.\n        vks_at_1 = kappa / 2.0\n        \n        results.extend([vks_at_0, vks_at_1, kappa])\n\n    # Format the results into the required string format.\n    # e.g., \"[0.0,0.6862915062890378,1.3725830125780757,...]\"\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2384975"}, {"introduction": "在了解了理想模型中的精确科恩-沈势之后，我们现在转向真实世界，在真实体系中我们必须使用近似方法。这项练习将定域密度近似（Local Density Approximation, LDA），一个基础性的密度泛函，应用于氦原子，并将其结果与传统的哈特里-福克（Hartree-Fock）方法进行直接比较。通过亲自计算和对比这两种方法的轨道能量，你将清晰地理解密度泛函理论在处理电子相互作用方面与传统波函数方法的根本区别 [@problem_id:2384971]。", "problem": "实现氦原子的最小基组计算，分别使用 Hartree–Fock 方法和仅含交换项的局域密度近似 (LDA) Kohn–Sham 方法，并报告所得的轨道能。全过程使用原子单位，能量单位为 Hartree。电荷为 $Z=2$ 的氦原子核固定在原点。使用单个归一化的、以原点为中心的 $s$ 型高斯基函数，其指数 $\\alpha&gt;0$ 由下式给出\n$$\n\\phi_{\\alpha}(\\mathbf{r})=\\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4} e^{-\\alpha r^2}.\n$$\n假设为闭壳层构型，两个电子占据相同的空间轨道，因此电子密度为\n$$\n\\rho(\\mathbf{r}) = 2 \\lvert \\phi_{\\alpha}(\\mathbf{r}) \\rvert^2.\n$$\n定义单电子核心哈密顿算符\n$$\n\\hat{h} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r}.\n$$\n将 Hartree 势定义为由电子密度产生的库仑势，\n$$\nv_{\\mathrm{H}}(\\mathbf{r}) = \\int \\frac{\\rho(\\mathbf{r'})}{\\lvert \\mathbf{r}-\\mathbf{r'} \\rvert} \\, d^3 r'.\n$$\n对于局域密度近似（仅交换项），使用对于自旋非极化的均匀电子气的 Dirac 交换势，\n$$\nv_{\\mathrm{x}}(\\rho) = - \\left(\\frac{3}{\\pi}\\right)^{1/3} \\rho^{1/3}.\n$$\n对于 Hartree–Fock 计算，将双占空间轨道的轨道能定义为在最小基组表示下 Fock 算符的期望值，该期望值从第一性原理导出，使用适用于具有单个空间轨道的闭壳层体系的动能、核吸引、库仑（Hartree）和交换项的精确积分定义。对于 LDA 计算，将 Kohn–Sham 轨道能定义为 Kohn–Sham 算符的期望值\n$$\n\\hat{h}_{\\mathrm{KS}} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r} + v_{\\mathrm{H}}[\\rho](\\mathbf{r}) + v_{\\mathrm{x}}[\\rho](\\mathbf{r}),\n$$\n使用由相同单个基函数和闭壳层占据所构建的给定密度进行评估。\n\n对于每个指定的高斯指数 $\\alpha$，你的程序必须计算：\n- Hartree–Fock 轨道能，以 Hartree 为单位，\n- LDA（仅交换项）Kohn–Sham 轨道能，以 Hartree 为单位，\n\n两者均根据上述定义，使用给定的基函数和密度从第一性原理获得，不调用任何外部数据。对于此问题，忽略相关作用，即只包含局域密度近似的交换部分。\n\n所有最终能量以 Hartree 表示，并四舍五入到八位小数。\n\n测试集：\n使用以下高斯指数集作为输入案例，以全面评估一般行为、弥散和紧凑基组极限以及中间值：\n- $\\alpha = 0.05$,\n- $\\alpha = 0.5$,\n- $\\alpha = 1.0$,\n- $\\alpha = 2.0$,\n- $\\alpha = 6.0$,\n- $\\alpha = 20.0$.\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于上面按序列出的每个指数 $\\alpha$，首先输出 Hartree–Fock 轨道能，然后输出 LDA 轨道能，两者都四舍五入到八位小数。因此，最终列表包含 $12$ 个浮点数，并且必须遵循以下确切格式\n$$\n[\\varepsilon_{\\mathrm{HF}}(\\alpha_1),\\varepsilon_{\\mathrm{LDA}}(\\alpha_1),\\varepsilon_{\\mathrm{HF}}(\\alpha_2),\\varepsilon_{\\mathrm{LDA}}(\\alpha_2),\\dots].\n$$", "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据，问题定义明确且客观，是计算量子物理学中的一个标准问题。\n\n我们的任务是使用由单个归一化 $s$ 型高斯函数 $\\phi_{\\alpha}(\\mathbf{r})$ 组成的最小基组，为氦原子（$Z=2$）计算两种不同理论模型下的轨道能：Hartree-Fock (HF) 和仅交换项的局域密度近似 (LDA) Kohn-Sham (KS) 密度泛函理论 (DFT)。基函数由下式给出：\n$$\n\\phi_{\\alpha}(\\mathbf{r}) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4} e^{-\\alpha r^2}\n$$\n双电子闭壳层体系的电子密度为：\n$$\n\\rho(\\mathbf{r}) = 2 |\\phi_{\\alpha}(\\mathbf{r})|^2 = 2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} e^{-2\\alpha r^2}\n$$\n所有计算均在原子单位下进行。\n\n**1. Hartree-Fock (HF) 轨道能计算**\n\n对于一个具有单个双占空间轨道 $\\phi_{\\alpha}$ 的闭壳层系统，Hartree-Fock 轨道能 $\\varepsilon_{\\mathrm{HF}}$ 是 Fock 算符 $\\hat{F}$ 的期望值。由于基组仅包含一个归一化函数，轨道与该函数相同，轨道能由 Fock 矩阵的单个元素 $F_{11}$ 给出。\n$$\n\\varepsilon_{\\mathrm{HF}} = F_{11} = \\langle \\phi_{\\alpha} | \\hat{F} | \\phi_{\\alpha} \\rangle\n$$\n对于闭壳层体系，Fock 算符为 $\\hat{F} = \\hat{h} + 2\\hat{J} - \\hat{K}$，其中 $\\hat{h}$ 是核心哈密顿算符，$\\hat{J}$ 和 $\\hat{K}$ 分别是库仑算符和交换算符。由于轨道是实函数且基组中只有一个函数，库仑和交换矩阵元相等，即 $\\langle \\phi_{\\alpha} | \\hat{J} | \\phi_{\\alpha} \\rangle = \\langle \\phi_{\\alpha} | \\hat{K} | \\phi_{\\alpha} \\rangle = J_{11}$，其中 $J_{11}$ 是双电子互斥积分。因此，HF 轨道能简化为：\n$$\n\\varepsilon_{\\mathrm{HF}} = \\langle \\phi_{\\alpha} | \\hat{h} | \\phi_{\\alpha} \\rangle + \\langle \\phi_{\\alpha} | 2\\hat{J} - \\hat{K} | \\phi_{\\alpha} \\rangle = h_{11} + 2J_{11} - J_{11} = h_{11} + J_{11}\n$$\n我们继续计算必要的积分。\n\n**a) 核心哈密顿积分 ($h_{11}$)**\n核心哈密顿量为 $\\hat{h} = -\\frac{1}{2}\\nabla^2 - \\frac{Z}{r}$。积分 $h_{11}$ 是动能 ($T$) 和核-电子吸引能 ($V_{ne}$) 期望值的和。\n对于一个归一化的高斯轨道，动能积分是一个标准结果：\n$$\nT = \\langle \\phi_{\\alpha} | -\\frac{1}{2}\\nabla^2 | \\phi_{\\alpha} \\rangle = \\frac{3\\alpha}{2}\n$$\n核-电子吸引积分对于氦原子 ($Z=2$) 是：\n$$\nV_{ne} = \\langle \\phi_{\\alpha} | -\\frac{Z}{r} | \\phi_{\\alpha} \\rangle = -Z \\sqrt{\\frac{8\\alpha}{\\pi}} = -2\\sqrt{\\frac{8\\alpha}{\\pi}} = -4\\sqrt{\\frac{2\\alpha}{\\pi}}\n$$\n结合这两项，核心积分为：\n$$\nh_{11} = T + V_{ne} = \\frac{3\\alpha}{2} - 4\\sqrt{\\frac{2\\alpha}{\\pi}}\n$$\n\n**b) 双电子库仑积分 ($J_{11}$)**\n积分 $J_{11}$ 是标准的两电子互斥积分 $(\\phi_\\alpha \\phi_\\alpha | \\phi_\\alpha \\phi_\\alpha)$，它表示分布在同一轨道 $\\phi_\\alpha$ 上的两个电子之间的库仑排斥能。对于以原点为中心的归一化1s高斯函数，该积分的解析表达式是：\n$$\nJ_{11} = 2\\sqrt{\\frac{\\alpha}{\\pi}}\n$$\n\n**c) 最终 HF 轨道能**\n将以上各项相加，得到 Hartree-Fock 轨道能：\n$$\n\\varepsilon_{\\mathrm{HF}}(\\alpha) = h_{11} + J_{11} = \\left(\\frac{3\\alpha}{2} - 4\\sqrt{\\frac{2\\alpha}{\\pi}}\\right) + 2\\sqrt{\\frac{\\alpha}{\\pi}} = \\frac{3\\alpha}{2} - 2\\sqrt{\\frac{2\\alpha}{\\pi}}\n$$\n整理后得到：\n$$\n\\varepsilon_{\\mathrm{HF}}(\\alpha) = \\frac{3\\alpha}{2} + \\left(\\frac{2 - 4\\sqrt{2}}{\\sqrt{\\pi}}\\right)\\sqrt{\\alpha}\n$$\n\n**2. Kohn-Sham (KS) 轨道能计算 (LDA)**\n\n单个占据轨道 $\\phi_{\\alpha}$ 的 Kohn-Sham 轨道能是 KS 哈密顿量 $\\hat{h}_{\\mathrm{KS}}$ 的期望值：\n$$\n\\varepsilon_{\\mathrm{LDA}} = \\langle \\phi_{\\alpha} | \\hat{h}_{\\mathrm{KS}} | \\phi_{\\alpha} \\rangle = \\langle \\phi_{\\alpha} | \\hat{h} + v_{\\mathrm{H}}[\\rho] + v_{\\mathrm{x}}[\\rho] | \\phi_{\\alpha} \\rangle\n$$\n这可以展开为：\n$$\n\\varepsilon_{\\mathrm{LDA}} = h_{11} + \\langle \\phi_{\\alpha} | v_{\\mathrm{H}}[\\rho] | \\phi_{\\alpha} \\rangle + \\langle \\phi_{\\alpha} | v_{\\mathrm{x}}[\\rho] | \\phi_{\\alpha} \\rangle\n$$\n核心项 $h_{11}$ 与 HF 计算中的相同。\n\n**a) Hartree 势期望值**\nHartree 势是由总密度 $\\rho(\\mathbf{r}) = 2|\\phi_{\\alpha}(\\mathbf{r})|^2$ 产生的。其期望值为：\n$$\n\\langle \\phi_{\\alpha} | v_{\\mathrm{H}}[\\rho] | \\phi_{\\alpha} \\rangle = \\int |\\phi_{\\alpha}(\\mathbf{r})|^2 \\left( \\int \\frac{2|\\phi_{\\alpha}(\\mathbf{r'})|^2}{|\\mathbf{r}-\\mathbf{r'}|} d^3r' \\right) d^3r = 2 J_{11} = 2 \\left( 2\\sqrt{\\frac{\\alpha}{\\pi}} \\right) = 4\\sqrt{\\frac{\\alpha}{\\pi}}\n$$\n\n**b) 交换势期望值 ($V_x$)**\nLDA 交换势为 $v_{\\mathrm{x}}(\\rho) = -C_x \\rho^{1/3}$，其中 $C_x = (3/\\pi)^{1/3}$。其期望值为：\n$$\nV_x = \\langle \\phi_{\\alpha} | v_{\\mathrm{x}}[\\rho] | \\phi_{\\alpha} \\rangle = \\int |\\phi_{\\alpha}(\\mathbf{r})|^2 v_{\\mathrm{x}}(\\rho(\\mathbf{r})) d^3r\n$$\n代入 $\\rho(\\mathbf{r}) = 2|\\phi_{\\alpha}(\\mathbf{r})|^2$，我们得到：\n$$\nV_x = \\int |\\phi_{\\alpha}|^2 \\left( -C_x (2|\\phi_{\\alpha}|^2)^{1/3} \\right) d^3r = -C_x 2^{1/3} \\int |\\phi_{\\alpha}(\\mathbf{r})|^{8/3} d^3r\n$$\n我们需要计算积分 $\\int |\\phi_{\\alpha}(\\mathbf{r})|^{8/3} d^3r$。\n$$\n|\\phi_{\\alpha}(\\mathbf{r})|^{8/3} = \\left[ \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4} e^{-\\alpha r^2} \\right]^{8/3} = \\left(\\frac{2\\alpha}{\\pi}\\right)^2 e^{-8\\alpha r^2/3}\n$$\n因此，积分部分为：\n$$\n\\int |\\phi_{\\alpha}|^{8/3} d^3r = \\left(\\frac{2\\alpha}{\\pi}\\right)^2 \\int e^{-8\\alpha r^2/3} d^3r = \\left(\\frac{2\\alpha}{\\pi}\\right)^2 \\left(\\frac{3\\pi}{8\\alpha}\\right)^{3/2} = \\frac{3\\sqrt{3}}{4\\sqrt{2}\\sqrt{\\pi}}\\sqrt{\\alpha}\n$$\n将所有部分组合起来，得到 $V_x$：\n$$\nV_x = - \\left(\\frac{3}{\\pi}\\right)^{1/3} 2^{1/3} \\left( \\frac{3^{3/2}}{2^{5/2}\\pi^{1/2}}\\sqrt{\\alpha} \\right) = - \\frac{3^{1/3+3/2}}{2^{5/2-1/3}\\pi^{1/3+1/2}}\\sqrt{\\alpha} = - \\frac{3^{11/6}}{2^{13/6}\\pi^{5/6}}\\sqrt{\\alpha}\n$$\n\n**c) 最终 LDA 轨道能**\n结合所有项，得到 LDA 轨道能：\n$$\n\\varepsilon_{\\mathrm{LDA}}(\\alpha) = h_{11} + \\langle \\phi_{\\alpha} | v_{\\mathrm{H}}[\\rho] | \\phi_{\\alpha} \\rangle + V_x = h_{11} + 2J_{11} + V_x\n$$\n$$\n\\varepsilon_{\\mathrm{LDA}}(\\alpha) = \\left(\\frac{3\\alpha}{2} - 4\\sqrt{\\frac{2\\alpha}{\\pi}}\\right) + 4\\sqrt{\\frac{\\alpha}{\\pi}} + \\left(- \\frac{3^{11/6}}{2^{13/6}\\pi^{5/6}}\\sqrt{\\alpha}\\right)\n$$\n整理后得到：\n$$\n\\varepsilon_{\\mathrm{LDA}}(\\alpha) = \\frac{3\\alpha}{2} + \\left(\\frac{4-4\\sqrt{2}}{\\sqrt{\\pi}} - \\frac{3^{11/6}}{2^{13/6}\\pi^{5/6}}\\right)\\sqrt{\\alpha}\n$$\n\n**用于实现的公式总结**\n需要实现的公式如下：\n$$\n\\varepsilon_{\\mathrm{HF}}(\\alpha) = \\frac{3}{2}\\alpha + \\left(\\frac{2 - 4\\sqrt{2}}{\\sqrt{\\pi}}\\right) \\sqrt{\\alpha}\n$$\n$$\n\\varepsilon_{\\mathrm{LDA}}(\\alpha) = \\frac{3}{2}\\alpha + \\left(\\frac{4 - 4\\sqrt{2}}{\\sqrt{\\pi}} - \\frac{3^{11/6}}{2^{13/6}\\pi^{5/6}}\\right) \\sqrt{\\alpha}\n$$\n将对给定的一组 $\\alpha$ 值计算这些表达式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates Hartree-Fock and LDA orbital energies for a minimal-basis Helium atom.\n\n    The problem specifies a single normalized s-type Gaussian basis function\n    phi_alpha(r) = (2*alpha/pi)^(3/4) * exp(-alpha*r^2)\n    for the Helium atom (Z=2). The electron density is rho = 2 * |phi_alpha|^2.\n\n    The orbital energies are derived from first principles as functions of alpha:\n\n    1. Hartree-Fock Orbital Energy (e_HF):\n       e_HF = h_11 + J_11\n       h_11 = <phi| -0.5*nabla^2 - Z/r |phi> = (3/2)*alpha - Z*sqrt(8*alpha/pi)\n       J_11 = <phi phi | 1/r_12 | phi phi> = 2*sqrt(alpha/pi)\n       For He (Z=2), h_11 = (3/2)*alpha - 4*sqrt(2*alpha/pi).\n       e_HF = (3/2)*alpha - 4*sqrt(2*alpha/pi) + 2*sqrt(alpha/pi)\n            = 1.5*alpha + (2 - 4*sqrt(2))/sqrt(pi) * sqrt(alpha)\n\n    2. LDA Kohn-Sham Orbital Energy (e_LDA):\n       e_LDA = h_11 + <v_H> + <v_x>\n       <v_H> = <phi| v_H[rho] |phi> = 2*J_11 = 4*sqrt(alpha/pi)\n       <v_x> = <phi| v_x[rho] |phi> = - (3^(11/6) * 2^(-13/6) * pi^(-5/6)) * sqrt(alpha)\n       e_LDA = (3/2)*alpha - 4*sqrt(2*alpha/pi) + 4*sqrt(alpha/pi) + <v_x>\n             = 1.5*alpha + [ (4 - 4*sqrt(2))/sqrt(pi) - (3^(11/6) * 2^(-13/6) * pi^(-5/6)) ] * sqrt(alpha)\n\n    These final formulas are implemented below.\n    \"\"\"\n    \n    # Test cases for the Gaussian exponent alpha as specified in the problem statement.\n    test_cases = [0.05, 0.5, 1.0, 2.0, 6.0, 20.0]\n\n    # Pre-calculate constants for efficiency and readability\n    PI = np.pi\n    SQRT_2 = np.sqrt(2.0)\n    SQRT_PI = np.sqrt(PI)\n\n    # Coefficient for the sqrt(alpha) term in the Hartree-Fock orbital energy\n    # C_HF = (2 - 4*sqrt(2))/sqrt(pi)\n    C_HF = (2.0 - 4.0 * SQRT_2) / SQRT_PI\n\n    # Coefficients for the sqrt(alpha) term in the LDA Kohn-Sham orbital energy\n    # C_LDA = C_LDA_H + C_LDA_x\n    # C_LDA_H is the contribution from the core Hamiltonian and Hartree potential.\n    C_LDA_H = (4.0 * (1.0 - SQRT_2)) / SQRT_PI\n    # C_LDA_x is the contribution from the LDA exchange potential.\n    C_LDA_x = - (3.0**(11.0/6.0)) * (2.0**(-13.0/6.0)) * (PI**(-5.0/6.0))\n    C_LDA = C_LDA_H + C_LDA_x\n\n    results = []\n    for alpha in test_cases:\n        sqrt_alpha = np.sqrt(alpha)\n\n        # Calculate Hartree-Fock orbital energy using the derived formula.\n        e_hf = 1.5 * alpha + C_HF * sqrt_alpha\n        results.append(round(e_hf, 8))\n\n        # Calculate LDA orbital energy using the derived formula.\n        e_lda = 1.5 * alpha + C_LDA * sqrt_alpha\n        results.append(round(e_lda, 8))\n\n    # The final print statement must produce only the specified single-line format.\n    print(f\"[{','.join(f'{x:.8f}' for x in results)}]\")\n\nsolve()\n```", "id": "2384971"}, {"introduction": "将理论知识从孤立原子扩展到周期性延展的固体，是计算物理学训练中的关键一步。这项练习将指导你求解周期性体系中的科恩-沈方程，这是现代材料科学计算的基石。你将实现并比较两种基本的数值方法——平面波基组和实空间网格——从而获得关于如何对材料进行密度泛函理论计算的宝贵实践经验 [@problem_id:2384990]。", "problem": "要求您在密度泛函理论 (DFT) 框架下，使用原子单位对一个长度为 $a$ 的周期性晶胞中的一维无相互作用 Kohn–Sham (KS) 系统进行建模。其中，作用于单电子波函数 $\\psi(x)$ 的哈密顿算符为\n$$\n\\hat{H} = -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x),\n$$\n其中 $V(x)$ 是一个晶格周期为 $a$ 的实值周期性外势。考虑如下势：\n$$\nV(x) = V_0 \\cos\\!\\left(\\frac{2\\pi}{a} x\\right),\n$$\n并施加由第一布里渊区中的晶体动量 $k$ 所表征的 Bloch 周期性边界条件，即本征函数须满足\n$$\n\\psi(x + a) = e^{i k a}\\,\\psi(x).\n$$\n在 Hartree 原子单位制下进行计算，因此能量单位为 Hartree，长度单位为 Bohr。\n\n对于固定的 $a$、$V_0$ 和 $k$，定义同一个本征值问题的两种有限维表示：\n\n1. 一个在有限子空间上的表示，该子空间由傅里叶模式张成，其倒格矢为 $G = m G_0$，其中 $m \\in \\{-M,\\ldots,-1,0,1,\\ldots,M\\}$，$G_0 = 2\\pi/a$，且 $M$ 是一个给定的非负整数。在此表示中，矩阵元为\n$$\nH_{G,G'}(k) = \\frac{1}{2}\\left|k+G\\right|^2\\,\\delta_{G,G'} + V_{G-G'},\n$$\n其中 $V_q$ 是 $V(x)$ 的傅里叶系数，使得当 $q = \\pm G_0$ 时，$V_q = \\frac{V_0}{2}$，否则 $V_q = 0$。\n\n2. 一个在均匀坐标基上的表示，该基包含 $N$ 个格点 $x_j = j\\,a/N$（其中 $j \\in \\{0,1,\\ldots,N-1\\}$），并采用 Bloch 边界条件。在此表示中，使用标准的二阶中心有限差分来近似二阶导数，并在晶胞边界上实施 Bloch 相位 $e^{i k a}$。由此得到的 $N \\times N$ 厄米矩阵 $H(k)$ 的矩阵元为\n$$\nH_{j,j}(k) = -\\frac{1}{2}\\frac{-2}{h^2} + V(x_j), \\quad h = \\frac{a}{N},\n$$\n$$\nH_{j,j+1}(k) = -\\frac{1}{2}\\frac{1}{h^2}, \\quad H_{j+1,j}(k) = -\\frac{1}{2}\\frac{1}{h^2} \\quad \\text{for } j = 0,\\ldots,N-2,\n$$\n以及回卷耦合项\n$$\nH_{0,N-1}(k) = -\\frac{1}{2}\\frac{1}{h^2}\\,e^{-i k a}, \\quad H_{N-1,0}(k) = -\\frac{1}{2}\\frac{1}{h^2}\\,e^{i k a}.\n$$\n\n对于每组参数，定义以下量：\n- 令 $E^{\\mathrm{PW}}_1(k)$ 和 $E^{\\mathrm{PW}}_2(k)$ 为傅里叶表示矩阵的两个最低本征值（按升序排列）。\n- 令 $E^{\\mathrm{RS}}_1(k)$ 和 $E^{\\mathrm{RS}}_2(k)$ 为坐标表示矩阵的两个最低本征值（按升序排列）。\n\n对于每个测试用例，计算单个标量\n$$\n\\Delta = \\max\\left(\\left|E^{\\mathrm{PW}}_1(k) - E^{\\mathrm{RS}}_1(k)\\right|,\\; \\left|E^{\\mathrm{PW}}_2(k) - E^{\\mathrm{RS}}_2(k)\\right|\\right),\n$$\n以 Hartree 为单位表示，并四舍五入到六位小数。\n\n使用以下参数集测试套件，其中每个元组为 $(a, V_0, k\\ \\text{作为 } \\pi/a \\text{ 的分数}, M, N)$，并且除非另有说明，所有量均以原子单位表示：\n\n- 测试 $1$：$(a = 10.0, V_0 = 0.5, k = 0.0 \\times \\pi/a, M = 3, N = 256)$。\n- 测试 $2$：$(a = 10.0, V_0 = 0.5, k = 1.0 \\times \\pi/a, M = 3, N = 256)$。\n- 测试 $3$：$(a = 10.0, V_0 = 0.0, k = 0.3 \\times \\pi/a, M = 3, N = 256)$。\n- 测试 $4$：$(a = 10.0, V_0 = 5.0, k = 0.5 \\times \\pi/a, M = 3, N = 256)$。\n\n您的程序必须按上述顺序列出为每个测试计算 $\\Delta$，并生成单行输出，其中包含四个结果，以逗号分隔，并用方括号括起来，例如，“[$d_1$,$d_2$,$d_3$,$d_4$]”。每个 $d_i$ 必须是一个十进制数，表示测试 $i$ 的 $\\Delta$ 值，单位为 Hartree，并四舍五入到六位小数。不允许有其他输出。", "solution": "对所述问题进行了严格的验证。\n\n**步骤 1：提取的已知条件**\n- 系统：长度为 $a$ 的周期性晶胞中的一维无相互作用 Kohn–Sham 系统。\n- 哈密顿量：$\\hat{H} = -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)$。\n- 势：$V(x) = V_0 \\cos\\!\\left(\\frac{2\\pi}{a} x\\right)$。\n- 边界条件：Bloch 周期性，$\\psi(x + a) = e^{i k a}\\,\\psi(x)$，晶体动量为 $k$。\n- 表示 1 (平面波)：\n    - 基：傅里叶模式，其倒格矢为 $G = m G_0$，其中 $G_0 = 2\\pi/a$ 且 $m \\in \\{-M, \\ldots, M\\}$。基的大小为 $2M+1$。\n    - 矩阵元：$H_{G,G'}(k) = \\frac{1}{2}\\left|k+G\\right|^2\\,\\delta_{G,G'} + V_{G-G'}$。\n    - 势的傅里叶系数：当 $q = \\pm G_0$ 时，$V_q = \\frac{V_0}{2}$，否则 $V_q = 0$。\n- 表示 2 (实空间)：\n    - 基：由 $N$ 个格点 $x_j = j\\,a/N$（其中 $j \\in \\{0, \\ldots, N-1\\}$）组成的网格。网格间距为 $h=a/N$。\n    - 动能：$-\\frac{1}{2}\\frac{d^2}{dx^2}$ 的二阶中心有限差分近似。\n    - 矩阵元：\n        - 对角元：$H_{j,j}(k) = \\frac{1}{h^2} + V(x_j)$。\n        - 非对角元：当 $j=0,\\ldots,N-2$ 时，$H_{j,j+1}(k) = H_{j+1,j}(k) = -\\frac{1}{2h^2}$。\n        - 边界：$H_{0,N-1}(k) = -\\frac{1}{2h^2}\\,e^{-i k a}$，$H_{N-1,0}(k) = -\\frac{1}{2h^2}\\,e^{i k a}$。\n- 任务：比较来自两种表示的两个最低本征值 $E_1$ 和 $E_2$。\n    - $E^{\\mathrm{PW}}_1, E^{\\mathrm{PW}}_2$：上述平面波矩阵的本征值。\n    - $E^{\\mathrm{RS}}_1, E^{\\mathrm{RS}}_2$：上述实空间矩阵的本征值。\n    - 计算 $\\Delta = \\max\\left(\\left|E^{\\mathrm{PW}}_1(k) - E^{\\mathrm{RS}}_1(k)\\right|,\\; \\left|E^{\\mathrm{PW}}_2(k) - E^{\\mathrm{RS}}_2(k)\\right|\\right)$。\n- 测试用例：提供了四组参数 $(a, V_0, k, M, N)$。\n\n**步骤 2：验证**\n该问题具有科学依据，描述了计算固态物理中的一个标准教科书练习。平面波法和有限差分法是在周期势中求解类薛定谔的 Kohn-Sham 方程的基本技术。两种表示中哈密顿矩阵的数学定义是正确的，并且与 Bloch 定理和量子力学原理一致。该问题是适定的，因为它要求找到明确定义的有限维厄米矩阵的本征值。每个测试用例都提供了所有必要的参数，使得问题自洽且无歧义。不存在科学缺陷、矛盾或不切实际的条件。\n\n**步骤 3：结论**\n问题有效。将构建一个解决方案。\n\n**基于原理的解决方案设计**\n\n任务是求解给定周期势下的单粒子定态薛定谔方程，这是在无相互作用极限下 Kohn-Sham 形式理论的核心。解决方案基于周期系统中的量子力学原理及其数值实现。\n\n**1. Bloch 定理和基组**\n对于周期势 $V(x) = V(x+a)$，Bloch 定理指出，本征函数可以写成 Bloch 函数的形式，$\\psi_k(x) = u_k(x)e^{ikx}$，其中 $u_k(x)$ 是一个晶胞周期函数，$k$ 是晶体动量。该定理是两种表示法的基础。\n\n**1.1. 平面波 (PW) 表示**\n晶胞周期函数 $u_k(x)$ 可以展开为傅里叶级数，其展开基底是倒格矢 $G = m G_0 = m \\frac{2\\pi}{a}$，其中 $m$ 为整数。\n$$\nu_k(x) = \\sum_G c_{k,G} e^{iGx}\n$$\n因此，Bloch 函数 $\\psi_k(x)$ 自然地在一个平面波基组中展开：\n$$\n\\psi_k(x) = \\sum_G c_{k,G} e^{i(k+G)x}\n$$\n问题将这个无限基组截断为一个有限集合，其中 $m \\in \\{-M, \\ldots, M\\}$，从而得到一个大小为 $2M+1$ 的基组。薛定谔方程 $\\hat{H}\\psi_k = E_k \\psi_k$ 变为一个矩阵本征值问题 $H(k) \\mathbf{c}_k = E_k \\mathbf{c}_k$。矩阵元 $H_{G,G'}(k) = \\langle k+G | \\hat{H} | k+G' \\rangle$ 由下式给出：\n$$\nH_{G,G'}(k) = \\int_0^a \\frac{dx}{a} \\left(e^{i(k+G)x}\\right)^* \\left(-\\frac{1}{2}\\frac{d^2}{dx^2} + V(x)\\right) \\left(e^{i(k+G')x}\\right)\n$$\n动能算符在此基组中是对角的：\n$$\n\\left\\langle k+G \\left| -\\frac{1}{2}\\frac{d^2}{dx^2} \\right| k+G' \\right\\rangle = \\frac{1}{2}|k+G|^2 \\delta_{G,G'}\n$$\n势能算符给出的矩阵元是势的傅里叶分量：\n$$\n\\langle k+G | V(x) | k+G' \\rangle = V_{G-G'} = \\frac{1}{a}\\int_0^a V(x) e^{-i(G-G')x} dx\n$$\n对于势 $V(x) = V_0 \\cos(G_0 x) = \\frac{V_0}{2}(e^{iG_0x} + e^{-iG_0x})$，唯一非零的傅里叶分量是 $V_{G_0} = V_{-G_0} = \\frac{V_0}{2}$。这意味着势仅耦合倒格矢相差 $\\pm G_0$ 的态。\n最终得到的 $(2M+1) \\times (2M+1)$ 矩阵 $H^{\\mathrm{PW}}(k)$ 是一个实对称三对角矩阵，其矩阵元为：\n$$\nH^{\\mathrm{PW}}_{m,n}(k) =\n\\begin{cases}\n\\frac{1}{2}(k+mG_0)^2 & \\text{若 } m=n \\\\\n\\frac{V_0}{2} & \\text{若 } |m-n|=1 \\\\\n0 & \\text{其他情况}\n\\end{cases}\n$$\n其中矩阵索引对应于从 $-M$ 到 $M$ 的整数 $m$。\n\n**1.2. 实空间 (RS) 表示**\n另外，问题也可以在一个包含 $N$ 个点的均匀网格 $\\{x_j = j h\\}$ 上求解，其中 $h=a/N$，$j=0, \\ldots, N-1$。波函数由其在这些点上的值的向量表示，$\\psi_j = \\psi(x_j)$。微分动能算符使用二阶中心有限差分公式近似：\n$$\n\\left(-\\frac{1}{2}\\frac{d^2}{dx^2}\\psi\\right)(x_j) \\approx -\\frac{1}{2} \\frac{\\psi_{j+1} - 2\\psi_j + \\psi_{j-1}}{h^2}\n$$\n势算符在此基中是对角的，其值为 $V(x_j)$。Bloch 边界条件 $\\psi(x+a)=e^{ika}\\psi(x)$ 转化为对网格点的条件。具体来说，点 $x_0$ “之前”的值是 $\\psi_{-1} = \\psi(x_{N-1}-a) = e^{-ika}\\psi(x_{N-1}) = e^{-ika}\\psi_{N-1}$。类似地，点 $x_{N-1}$ “之后”的值是 $\\psi_N = \\psi(x_0+a) = e^{ika}\\psi(x_0) = e^{ika}\\psi_0$。\n这导出一个具有以下结构的 $N \\times N$ 厄米矩阵 $H^{\\mathrm{RS}}(k)$：\n- 对角元：$H_{j,j} = \\frac{1}{h^2} + V(x_j)$\n- 次对角元：$H_{j,j+1} = H_{j+1,j}^* = -\\frac{1}{2h^2}$\n- 来自 Bloch 条件的回卷（角）元素：$H_{N-1,0} = -\\frac{1}{2h^2}e^{ika}$ 和 $H_{0,N-1} = -\\frac{1}{2h^2}e^{-ika}$。\n\n**2. 数值解法**\n对于每个测试用例，使用参数 $(a, V_0, k, M, N)$ 来构建两个矩阵 $H^{\\mathrm{PW}}(k)$ 和 $H^{\\mathrm{RS}}(k)$。两个矩阵都是厄米矩阵。因此，我们可以使用一个稳健的数值本征求解器，例如 `numpy.linalg.eigh`，它专为厄米矩阵设计，并能高效地计算实值本征值。\n算法如下：\n1.  对于每个测试用例，定义参数 $a, V_0, k, M, N$。\n2.  构建 $(2M+1) \\times (2M+1)$ 的实对称矩阵 $H^{\\mathrm{PW}}(k)$。\n3.  计算其本征值并选择两个最低的本征值 $E^{\\mathrm{PW}}_1$ 和 $E^{\\mathrm{PW}}_2$。\n4.  构建 $N \\times N$ 的复厄米矩阵 $H^{\\mathrm{RS}}(k)$。\n5.  计算其本征值并选择两个最低的本征值 $E^{\\mathrm{RS}}_1$ 和 $E^{\\mathrm{RS}}_2$。\n6.  计算差异 $\\Delta = \\max(|E^{\\mathrm{PW}}_1 - E^{\\mathrm{RS}}_1|, |E^{\\mathrm{PW}}_2 - E^{\\mathrm{RS}}_2|)$。\n7.  收集所有测试用例的结果，并按要求格式化。\n\n这个过程比较了同一根本物理问题的两种不同的标准数值近似。差异 $\\Delta$ 量化了具有截断值 $M$ 的谱方法（平面波）与具有网格间距 $h=a/N$ 的基于网格的方法（实空间）之间的差异。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D Kohn-Sham problem for the given test cases using\n    both Plane-Wave and Real-Space representations and computes the\n    discrepancy between their lowest two eigenvalues.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (a, V0, k as a fraction of pi/a, M, N)\n    test_cases = [\n        (10.0, 0.5, 0.0, 3, 256),\n        (10.0, 0.5, 1.0, 3, 256),\n        (10.0, 0.0, 0.3, 3, 256),\n        (10.0, 5.0, 0.5, 3, 256),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a, V0, k_frac, M, N = case\n        \n        # --- Main logic to calculate the result for one case ---\n\n        # Universal constants and parameters\n        PI = np.pi\n        k = k_frac * PI / a\n\n        # 1. Plane-Wave (PW) Representation\n        dim_pw = 2 * M + 1\n        m_vals = np.arange(-M, M + 1)\n        G0 = 2 * PI / a\n\n        # Initialize the PW Hamiltonian matrix\n        H_pw = np.zeros((dim_pw, dim_pw), dtype=np.float64)\n\n        # Kinetic energy (diagonal part)\n        k_plus_G = k + m_vals * G0\n        kinetic_diag = 0.5 * k_plus_G**2\n        np.fill_diagonal(H_pw, kinetic_diag)\n\n        # Potential energy (off-diagonal part)\n        if V0 != 0:\n            potential_offdiag = V0 / 2.0\n            np.fill_diagonal(H_pw[1:], potential_offdiag)\n            np.fill_diagonal(H_pw[:, 1:], potential_offdiag)\n        \n        # Eigen-decomposition of the PW matrix\n        # eigh returns sorted eigenvalues for Hermitian matrices\n        eigvals_pw = np.linalg.eigh(H_pw)[0]\n        E_pw1, E_pw2 = eigvals_pw[0], eigvals_pw[1]\n\n        # 2. Real-Space (RS) Representation\n        dim_rs = N\n        h = a / N\n        \n        # Initialize the RS Hamiltonian matrix\n        H_rs = np.zeros((dim_rs, dim_rs), dtype=np.complex128)\n\n        # Kinetic energy constant term\n        T_const = -0.5 / h**2\n        \n        # Potential energy on the grid\n        x_grid = np.arange(dim_rs) * h\n        potential_V_grid = V0 * np.cos(2 * PI / a * x_grid)\n\n        # Fill the RS matrix\n        # Diagonal elements: Kinetic + Potential\n        diag_elements = -2.0 * T_const + potential_V_grid\n        np.fill_diagonal(H_rs, diag_elements)\n\n        # Off-diagonal elements (nearest neighbors)\n        offdiag_elements = np.full(dim_rs - 1, T_const)\n        np.fill_diagonal(H_rs[1:], offdiag_elements)\n        np.fill_diagonal(H_rs[:, 1:], offdiag_elements)\n\n        # Wrap-around elements due to Bloch boundary conditions\n        if dim_rs > 1:\n            bloch_phase = np.exp(1j * k * a)\n            # H_{N-1, 0}\n            H_rs[dim_rs - 1, 0] = T_const * bloch_phase\n            # H_{0, N-1}\n            H_rs[0, dim_rs - 1] = T_const * np.conj(bloch_phase)\n\n        # Eigen-decomposition of the RS matrix\n        eigvals_rs = np.linalg.eigh(H_rs)[0]\n        E_rs1, E_rs2 = eigvals_rs[0], eigvals_rs[1]\n\n        # 3. Compute the discrepancy Delta\n        delta = max(abs(E_pw1 - E_rs1), abs(E_pw2 - E_rs2))\n        results.append(delta)\n\n    # Format the final output\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2384990"}]}