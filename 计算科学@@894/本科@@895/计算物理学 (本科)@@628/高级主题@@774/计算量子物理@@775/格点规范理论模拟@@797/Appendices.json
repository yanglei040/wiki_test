{"hands_on_practices": [{"introduction": "格点模拟总是在有限大小的盒子中进行，这引入了系统误差，其中最主要的一种就是有限体积效应。在具有周期性边界条件的有限空间中，粒子的动量是量子化的，这导致了依赖于盒子大小 $L$ 的离散能谱。理解和量化这些体积效应对将格点计算结果外推到无限体积的物理世界至关重要。本练习将通过一个简单的相对论粒子模型，让你亲手计算这种动量量子化如何影响能量，从而掌握分析有限体积效应的基本方法。[@problem_id:2407383]", "problem": "考虑一个静止质量为 $m$ 的、稳定的、无相互作用的相对论性强子，它被限制在一个边长为 $L$ 的、具有周期性边界条件 (PBC) 的立方体空间盒子中。空间方向是周期性的，而时间方向的尺度取得足够大，以至于时间方向的有限体积效应可以被忽略。在周期性边界条件下，单粒子的空间动量被量子化为 $p_i = \\frac{2\\pi \\hbar}{L} n_i$，其中对于每个笛卡尔分量 $i \\in \\{x,y,z\\}$，$n_i \\in \\mathbb{Z}$。在一个使用自然单位制（其中光速 $c$ 设为 $c=1$）的相对论性理论中，动量为 $\\mathbf{p}$ 的单粒子能量为 $E = \\sqrt{m^2 + \\mathbf{p}^2}$。当能量以吉电子伏特 (gigaelectronvolt)、长度以飞米 (femtometer) 为单位报告时，请精确使用给定的转换常数 $\\hbar c = 0.1973269804\\,\\mathrm{GeV}\\,\\mathrm{fm}$。因此，如果 $L$ 以飞米为单位指定，且 $\\mathbf{n}=(n_x,n_y,n_z)$，则空间动量的大小（以吉电子伏特为单位）是 $|\\mathbf{p}| = \\frac{2\\pi\\,(\\hbar c)}{L}\\,|\\mathbf{n}|$，其中 $|\\mathbf{n}|=\\sqrt{n_x^2+n_y^2+n_z^2}$。\n\n你的任务是量化仅由空间动量量子化引起的对能级的有限体积效应。对于每个测试用例，计算有限体积能量差\n$$\n\\Delta E = E(\\mathbf{n}, L_1) - E(\\mathbf{n}, L_2),\n$$\n其中\n$$\nE(\\mathbf{n}, L) = \\sqrt{m^2 + \\left(\\frac{2\\pi\\,(\\hbar c)}{L}\\,|\\mathbf{n}|\\right)^2}.\n$$\n所有能量必须以吉电子伏特表示，所有长度必须以飞米表示。对于每个测试用例，输入是一个元组 $(m, L_1, L_2, n_x, n_y, n_z)$，其中 $m$ 的单位是吉电子伏特，$L_1$ 和 $L_2$ 的单位是飞米，$n_x, n_y, n_z$ 是整数。每个测试用例的输出是 $\\Delta E$ 的浮点值，单位为吉电子伏特。注意，对于 $|\\mathbf{n}|=0$ 的情况，$\\Delta E$ 必须为 $0$。\n\n使用以下精确的参数集测试套件：\n- 测试用例 1: $(m, L_1, L_2, n_x, n_y, n_z) = (0.140, 2.0, 4.0, 1, 0, 0)$。\n- 测试用例 2: $(m, L_1, L_2, n_x, n_y, n_z) = (0.938, 3.0, 5.0, 0, 0, 0)$。\n- 测试用例 3: $(m, L_1, L_2, n_x, n_y, n_z) = (0.140, 1.5, 100.0, 1, 1, 0)$。\n- 测试用例 4: $(m, L_1, L_2, n_x, n_y, n_z) = (1.320, 2.5, 3.0, 1, 1, 1)$。\n- 测试用例 5: $(m, L_1, L_2, n_x, n_y, n_z) = (0.500, 0.8, 1.6, 2, 0, 0)$。\n\n你的程序必须：\n- 精确使用 $\\hbar c = 0.1973269804\\,\\mathrm{GeV}\\,\\mathrm{fm}$。\n- 对于每个测试用例，生成 $\\Delta E$ 的值（以吉电子伏特为单位），并四舍五入到小数点后六位。\n- 输出单行，其中包含按顺序汇总的结果，格式为方括号内的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 是测试用例 $i$ 的四舍五入值。\n\n不应读取任何外部输入。程序必须确定性地执行，并仅生成所需的单行输出。", "solution": "所述问题具有科学依据、提法恰当且客观。它展示了计算粒子物理学领域中的一个标准计算，具体而言，是在格点量子色动力学 (QCD) 中研究有限体积效应对强子性质的影响。该问题提供了所有必要的定义、常数和数据，并且没有矛盾或歧义。因此，该问题是有效的，可以直接求解。\n\n任务是计算当一个相对论性粒子的限制体积发生变化时的能量差。这种能移是在具有周期性边界条件的有限空间体积中动量量子化的直接结果。其基本原理是相对论量子力学的基础。\n\n首先，一个静止质量为 $m$、动量为 $\\mathbf{p}$ 的相对论性粒子的能量 $E$ 由以下色散关系给出：\n$$\nE^2 = m^2 + \\mathbf{p}^2\n$$\n此处我们使用自然单位制，其中光速 $c=1$。\n\n其次，在量子力学中，粒子的动量通过德布罗意关系 $\\mathbf{p} = \\hbar \\mathbf{k}$ 与其波矢 $\\mathbf{k}$ 相关联，其中 $\\hbar$ 是约化普朗克常数。\n\n第三，将粒子限制在边长为 $L$ 且具有周期性边界条件的立方体盒子中，会对粒子的波函数 $\\psi(\\mathbf{x})$ 施加一个约束。周期性要求 $\\psi(x, y, z) = \\psi(x+L, y, z) = \\psi(x, y+L, z) = \\psi(x, y, z+L)$，将波矢 $\\mathbf{k}$ 的允许分量限制为离散值：\n$$\nk_i = \\frac{2\\pi}{L} n_i, \\quad \\text{for } i \\in \\{x, y, z\\}\n$$\n其中 $n_x, n_y, n_z$ 是整数，我们可以将其组合成一个向量 $\\mathbf{n} = (n_x, n_y, n_z)$。\n\n结合这些原理，允许的动量分量是量子化的：\n$$\np_i = \\hbar k_i = \\frac{2\\pi\\hbar}{L} n_i\n$$\n动量矢量 $\\mathbf{p}$ 的模的平方则为\n$$\n|\\mathbf{p}|^2 = p_x^2 + p_y^2 + p_z^2 = \\left(\\frac{2\\pi\\hbar}{L}\\right)^2 (n_x^2 + n_y^2 + n_z^2) = \\left(\\frac{2\\pi\\hbar}{L}\\right)^2 |\\mathbf{n}|^2\n$$\n，其中 $|\\mathbf{n}| = \\sqrt{n_x^2 + n_y^2 + n_z^2}$。\n\n将此量子化动量代入相对论的质能关系式，并明确使用转换常数 $\\hbar c$（当质量和能量以吉电子伏特 ($\\mathrm{GeV}$) 为单位、长度以飞米 ($\\mathrm{fm}$) 为单位时，这是必需的），我们得到量子化能级 $E(\\mathbf{n}, L)$ 的表达式：\n$$\nE(\\mathbf{n}, L) = \\sqrt{m^2 + |\\mathbf{p}|^2} = \\sqrt{m^2 + \\left(\\frac{2\\pi(\\hbar c)}{L}\\right)^2 |\\mathbf{n}|^2}\n$$\n这与问题陈述中提供的公式完全匹配。问题要求计算一个具有固定量子数 $\\mathbf{n}$ 但被限制在边长分别为 $L_1$ 和 $L_2$ 的两个不同体积中的粒子的有限体积能量差 $\\Delta E$：\n$$\n\\Delta E = E(\\mathbf{n}, L_1) - E(\\mathbf{n}, L_2)\n$$\n\n计算过程就是针对每个指定的测试用例直接应用此公式。对于一个由元组 $(m, L_1, L_2, n_x, n_y, n_z)$ 定义的给定测试用例：\n1. 我们确定各项常数：静止质量 $m$、盒子边长 $L_1$ 和 $L_2$，以及动量量子数 $(n_x, n_y, n_z)$。转换常数的值固定为 $\\hbar c = 0.1973269804\\,\\mathrm{GeV}\\,\\mathrm{fm}$。\n2. 我们计算整数向量 $\\mathbf{n}$ 的模：$|\\mathbf{n}| = \\sqrt{n_x^2 + n_y^2 + n_z^2}$。\n3. 必须考虑一种特殊情况：如果 $\\mathbf{n} = \\mathbf{0}$，则 $|\\mathbf{n}|=0$。在这种情况下，动量 $|\\mathbf{p}|$ 为零，能量就是静止能量 $E(\\mathbf{0}, L) = \\sqrt{m^2+0} = m$，这与体积大小 $L$ 无关。因此，$\\Delta E = E(\\mathbf{0}, L_1) - E(\\mathbf{0}, L_2) = m - m = 0$。\n4. 对于非零的 $\\mathbf{n}$，我们首先使用以下公式计算能量 $E(\\mathbf{n}, L_1)$：\n$$\nE(\\mathbf{n}, L_1) = \\sqrt{m^2 + \\left(\\frac{2\\pi(\\hbar c)}{L_1} |\\mathbf{n}|\\right)^2}\n$$\n5. 接下来，我们计算能量 $E(\\mathbf{n}, L_2)$：\n$$\nE(\\mathbf{n}, L_2) = \\sqrt{m^2 + \\left(\\frac{2\\pi(\\hbar c)}{L_2} |\\mathbf{n}|\\right)^2}\n$$\n6. 最后，通过将两者相减来计算能量差 $\\Delta E$。\n7. 每个测试用例得到的 $\\Delta E$ 值被四舍五入到小数点后六位，并汇总成最终的输出格式。\n\n对五个测试用例中的每一个执行此过程，以生成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the finite-volume energy differences for a series of test cases.\n    \"\"\"\n    \n    # The problem specifies using this exact value for the hbar*c conversion constant.\n    # Unit: GeV*fm\n    hbar_c = 0.1973269804\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (m [GeV], L1 [fm], L2 [fm], nx, ny, nz)\n    test_cases = [\n        (0.140, 2.0, 4.0, 1, 0, 0),\n        (0.938, 3.0, 5.0, 0, 0, 0),\n        (0.140, 1.5, 100.0, 1, 1, 0),\n        (1.320, 2.5, 3.0, 1, 1, 1),\n        (0.500, 0.8, 1.6, 2, 0, 0),\n    ]\n\n    results = []\n\n    def calculate_energy(m, L, n_mag):\n        \"\"\"\n        Calculates the single-particle energy E(n, L).\n        \"\"\"\n        # For the ground state (zero momentum), energy is just the rest mass.\n        if n_mag == 0:\n            return m\n        \n        # Momentum is quantized in a periodic box.\n        p_mag_squared = ((2 * np.pi * hbar_c / L) * n_mag)**2\n        \n        # Relativistic energy-momentum relation E^2 = m^2 + p^2.\n        energy = np.sqrt(m**2 + p_mag_squared)\n        return energy\n\n    for case in test_cases:\n        m, L1, L2, nx, ny, nz = case\n        \n        # Calculate the magnitude of the integer momentum vector n.\n        n_mag = np.sqrt(nx**2 + ny**2 + nz**2)\n        \n        # Calculate the energy in each of the two volumes.\n        E1 = calculate_energy(m, L1, n_mag)\n        E2 = calculate_energy(m, L2, n_mag)\n        \n        # Compute the energy difference.\n        delta_E = E1 - E2\n        \n        # Format the result to six decimal places, as required.\n        results.append(f\"{delta_E:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2407383"}, {"introduction": "为了提高计算效率，格点模拟常常采用各向异性格点，即时间方向的格距 $a_t$ 小于空间方向的格距 $a_s$。这个比值，即各向异性参数 $\\xi = a_s / a_t$，是一个必须被精确“调节”或标定的关键参数。通过测量格点上粒子的能量-动量色散关系，并将其与考虑了 $\\xi$ 修正的连续谱理论形式进行拟合，我们就可以确定它的值。这个练习将为你提供标定现代格点模拟中一个基本参数的实践经验。[@problem_id:2407396]", "problem": "考虑在规范理论的欧几里得格点模拟中测量到的一个相对论性单粒子激发。该模拟在一个各向异性的超立方格点上进行，其空间格点间距为 $a_s$，时间格点间距为 $a_t$。定义各向异性参数 $\\xi$ 为 $\\xi = a_s / a_t$。在自然单位制（$c = \\hbar = 1$）中，连续谱色散关系为 $E_{\\text{phys}}^2 = m_{\\text{phys}}^2 + \\mathbf{p}_{\\text{phys}}^2$。用格点单位表示，能量和质量乘以 $a_t$，动量乘以 $a_s$，则长波色散关系变为\n$$\nE^2 = m^2 + \\frac{1}{\\xi^2}\\,p^2,\n$$\n其中 $E$ 和 $m$ 是以时间格点单位（$a_t$ 单位）计，而 $p = \\lVert \\mathbf{p} \\rVert$ 是以空间格点单位（$a_s$ 单位）计的动量大小。对于一组测量数据 $\\{(p_i, E_i)\\}_{i=1}^N$ 和一个已知的 $m$，定义测量的各向异性 $\\widehat{\\xi}$ 为一个非负实数，它使得与此单位制下色散关系的偏差平方和最小化：\n$$\n\\widehat{\\xi} = \\operatorname*{arg\\,min}_{\\xi \\ge 0} \\sum_{i=1}^N \\left(E_i^2 - m^2 - \\frac{1}{\\xi^2} p_i^2\\right)^2.\n$$\n你的任务是编写一个完整的程序，针对以下每一个独立的测试用例，根据给定的 $(p_i, E_i)$ 数据和 $m$ 计算 $\\widehat{\\xi}$，并以要求的最终输出格式报告所有结果。\n\n所有能量 $E_i$ 和质量 $m$ 均以时间格点单位（$a_t$ 单位）给出，所有动量 $p_i$ 均以空间格点单位（$a_s$ 单位）给出。不涉及其他物理单位。\n\n测试套件（每个用例指定了 $m$、列表 $\\{p_i\\}$ 以及对应的列表 $\\{E_i\\}$）：\n\n- 用例 1：\n  - $m = 0.5$\n  - $\\{p_i\\} = [\\,0.0,\\,0.2,\\,0.4,\\,0.6\\,]$\n  - $\\{E_i\\} = [\\,0.5,\\,0.5099019513592785,\\,0.5385164807134505,\\,0.58309518948453\\,]$\n\n- 用例 2：\n  - $m = 0.3$\n  - $\\{p_i\\} = [\\,0.0,\\,0.3,\\,0.6,\\,0.9\\,]$\n  - $\\{E_i\\} = [\\,0.3,\\,0.4242640687119285,\\,0.6708203932499369,\\,0.9486832980505138\\,]$\n\n- 用例 3：\n  - $m = 0.0$\n  - $\\{p_i\\} = [\\,0.0,\\,0.1,\\,0.3,\\,0.7\\,]$\n  - $\\{E_i\\} = [\\,0.0,\\,0.06666666666666667,\\,0.2,\\,0.4666666666666667\\,]$\n\n最终输出格式：你的程序应该生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，顺序与上述用例相同，每个 $\\widehat{\\xi}$ 值四舍五入到恰好 $6$ 位小数（例如，$[2.000000,1.000000,1.500000]$）。不应打印任何其他文本。", "solution": "所提出的问题是在格点规范理论背景下，一个通过最小二乘法进行参数估计的直接练习。我们的任务是从一组模拟的能量-动量数据点中，确定格点各向异性参数，记为 $\\widehat{\\xi}$。该问题定义明确，需要采用标准的解析方法。\n\n提供的基本关系是各向异性格点上粒子的长波色散关系：\n$$\nE^2 = m^2 + \\frac{1}{\\xi^2} p^2\n$$\n此处，$E$ 是以时间格点单位（$a_t$ 单位）计的能量，$m$ 是以相同单位计的质量，$p$ 是以空间格点单位（$a_s$ 单位）计的动量大小。参数 $\\xi = a_s/a_t$ 量化了空间和时间格点间距之间的各向异性。\n\n给定一组 $N$ 个测量值 $\\{(p_i, E_i)\\}_{i=1}^N$ 和一个已知的质量 $m$。任务是找到 $\\xi$ 的值（我们记为 $\\widehat{\\xi}$），使其能够最小化测量能量与理论模型之间的平方差之和。这可以正式地表示为一个优化问题：\n$$\n\\widehat{\\xi} = \\operatorname*{arg\\,min}_{\\xi \\ge 0} S(\\xi) = \\operatorname*{arg\\,min}_{\\xi \\ge 0} \\sum_{i=1}^N \\left(E_i^2 - m^2 - \\frac{1}{\\xi^2} p_i^2\\right)^2\n$$\n为解决此问题，我们简化表达式。被最小化的项是关于 $1/\\xi^2$ 的二次式。因此，引入一个新参数 $\\alpha = 1/\\xi^2$ 是明智的。由于问题陈述要求 $\\xi \\ge 0$，我们必须有 $\\alpha \\ge 0$。代价函数 $S$ 可以重写为 $\\alpha$ 的函数：\n$$\nS(\\alpha) = \\sum_{i=1}^N \\left( (E_i^2 - m^2) - \\alpha p_i^2 \\right)^2\n$$\n这是一个标准的线性最小二乘问题。为了找到使 $S(\\alpha)$ 最小化的 $\\alpha$ 值（我们称之为 $\\widehat{\\alpha}$），我们必须求其关于 $\\alpha$ 的一阶导数的根。\n$$\n\\frac{dS}{d\\alpha} = \\sum_{i=1}^N \\frac{d}{d\\alpha} \\left( (E_i^2 - m^2) - \\alpha p_i^2 \\right)^2 = \\sum_{i=1}^N 2 \\left( (E_i^2 - m^2) - \\alpha p_i^2 \\right) (-p_i^2) = 0\n$$\n简化此表达式，我们得到：\n$$\n-2 \\sum_{i=1}^N \\left( p_i^2(E_i^2 - m^2) - \\alpha p_i^4 \\right) = 0\n$$\n$$\n\\sum_{i=1}^N p_i^2(E_i^2 - m^2) = \\widehat{\\alpha} \\sum_{i=1}^N p_i^4\n$$\n解出 $\\widehat{\\alpha}$ 可得：\n$$\n\\widehat{\\alpha} = \\frac{\\sum_{i=1}^N p_i^2 (E_i^2 - m^2)}{\\sum_{i=1}^N p_i^4}\n$$\n此解有效的条件是分母 $\\sum_{i=1}^N p_i^4$ 非零。只要至少有一个动量测量值 $p_i$ 非零，这个条件就能得到保证，而所有给定的测试用例都满足这一条件。\n\n为确认该值对应于一个最小值，我们计算二阶导数：\n$$\n\\frac{d^2S}{d\\alpha^2} = \\frac{d}{d\\alpha} \\left( -2\\sum_{i=1}^N p_i^2(E_i^2 - m^2) + 2\\alpha\\sum_{i=1}^N p_i^4 \\right) = 2\\sum_{i=1}^N p_i^4\n$$\n由于 $p_i$ 是实数，所以 $p_i^4 \\ge 0$。因为至少有一个 $p_i \\neq 0$，所以总和 $\\sum_{i=1}^N p_i^4$ 严格为正。正的二阶导数证实了 $\\widehat{\\alpha}$ 确实是一个最小值。\n\n从问题的物理背景来看，我们预期 $E_i \\ge m$，并且对于任何非零动量 $p_i > 0$，有 $E_i > m$。因此，项 $E_i^2 - m^2$ 是非负的。这确保了 $\\widehat{\\alpha}$ 的分子 $\\sum_{i=1}^N p_i^2 (E_i^2 - m^2)$ 也是非负的。对于给定的数据，它将严格为正，从而得出 $\\widehat{\\alpha} > 0$。这与约束条件 $\\alpha \\ge 0$ 一致。\n\n找到最优参数 $\\widehat{\\alpha}$ 后，我们可以从原始代换 $\\widehat{\\alpha} = 1/\\widehat{\\xi}^2$ 中恢复各向异性 $\\widehat{\\xi}$：\n$$\n\\widehat{\\xi}^2 = \\frac{1}{\\widehat{\\alpha}} \\implies \\widehat{\\xi} = \\sqrt{\\frac{1}{\\widehat{\\alpha}}} = \\left( \\frac{\\sum_{i=1}^N p_i^4}{\\sum_{i=1}^N p_i^2(E_i^2 - m^2)} \\right)^{1/2}\n$$\n根据 $\\widehat{\\xi}$ 作为正格点间距之比的物理定义，我们取其正平方根。\n\n这个解析公式为计算每个测试用例的 $\\widehat{\\xi}$ 提供了一个直接而精确的方法。实现过程将涉及对所提供的数据集直接应用此公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the measured lattice anisotropy parameter xi for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"m\": 0.5,\n            \"p\": [0.0, 0.2, 0.4, 0.6],\n            \"E\": [0.5, 0.5099019513592785, 0.5385164807134505, 0.58309518948453]\n        },\n        {\n            \"m\": 0.3,\n            \"p\": [0.0, 0.3, 0.6, 0.9],\n            \"E\": [0.3, 0.4242640687119285, 0.6708203932499369, 0.9486832980505138]\n        },\n        {\n            \"m\": 0.0,\n            \"p\": [0.0, 0.1, 0.3, 0.7],\n            \"E\": [0.0, 0.06666666666666667, 0.2, 0.4666666666666667]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        m = case[\"m\"]\n        p = np.array(case[\"p\"])\n        E = np.array(case[\"E\"])\n        \n        # We need to find xi that minimizes Sum( (E_i^2 - m^2 - p_i^2/xi^2)^2 ).\n        # Let alpha = 1/xi^2. The problem becomes a linear least squares fit\n        # for alpha, fitting y_i = alpha * x_i where y_i = E_i^2 - m^2 and x_i = p_i^2.\n        # The analytical solution for alpha is Sum(x_i * y_i) / Sum(x_i^2).\n        \n        p_sq = p**2\n        p_quad = p**4\n        E_sq_minus_m_sq = E**2 - m**2\n        \n        numerator = np.sum(p_sq * E_sq_minus_m_sq)\n        denominator = np.sum(p_quad)\n        \n        # Handle the case where all momenta are zero to avoid division by zero.\n        # Although not the case for the given test problems.\n        if denominator == 0:\n            # If all p_i are 0, xi is undefined. This can be represented\n            # as infinity or NaN depending on context. Here, we assume it valid.\n            # In physics, if all p_i are 0, anisotropy cannot be determined.\n            # We follow the calculation which will lead to a valid result for the given cases.\n            pass\n\n        alpha = numerator / denominator\n        \n        # Since xi = 1/sqrt(alpha)\n        xi_hat = np.sqrt(1 / alpha)\n        \n        results.append(f\"{xi_hat:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2407396"}]}