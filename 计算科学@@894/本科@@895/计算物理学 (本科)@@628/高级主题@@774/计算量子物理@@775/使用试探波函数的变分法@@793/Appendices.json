{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方法莫过于亲手实践。我们从一个最经典的一维无限深势阱问题开始。尽管该问题是精确可解的，但通过使用一个包含可变参数$n$的多项式试探函数$\\psi_n(x) = x^n(L-x)^n$，我们可以直观地看到变分法如何逼近基态能量。这个练习旨在磨练你构建并最小化瑞利-里兹商$E[\\psi]$的核心数学技巧，让你熟悉通过优化参数来寻找最佳近似解的过程。[@problem_id:2448904]", "problem": "考虑一个质量为$m$的非相对论性量子粒子，被限制在宽度为$L$的一维无限深势阱中，势阱壁位于$x=0$和$x=L$。阱内哈密顿量为$H=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$，且允许的波函数在$x=0$和$x=L$处为零。Rayleigh-Ritz变分原理指出，对于任何允许的、平方可积的试探波函数$\\psi(x)$（满足$\\psi(0)=\\psi(L)=0$），商$E[\\psi]=\\frac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi\\rangle}$是基态能量的一个上界。\n\n取一个未归一化的单参数试探波函数族$\\psi_{n}(x)=x^{n}(L-x)^{n}$，其中$n$为实数且$n>\\frac{1}{2}$以确保动能的平方可积性。从上述定义出发，不假设除标准微积分以及伽马函数$\\Gamma(z)$和贝塔函数$B(a,b)$的性质（如果你选择使用它们）之外的任何特殊结果，完成以下任务：\n\n1. 推导$E(n)=\\frac{\\langle \\psi_{n}|H|\\psi_{n}\\rangle}{\\langle \\psi_{n}|\\psi_{n}\\rangle}$作为$n$、$m$、$\\hbar$和$L$的函数的精确解析表达式。\n2. 确定在$n>\\frac{1}{2}$范围内使$E(n)$最小化的值$n^{\\star}$，并求出相应的最小化能量$E_{\\min}=E(n^{\\star})$的闭合形式。\n\n将你的最终答案以单行矩阵的形式给出，包含$n^{\\star}$和$E_{\\min}$，以$\\hbar$、$m$和$L$的精确解析形式表示。不要提供任何数值近似，也不要在方框答案中包含单位。", "solution": "这个问题是有效的，因为它在科学上基于量子力学原理，特别是Rayleigh-Ritz变分法，并且是一个提供了所有必要信息的适定数学优化问题。我们将开始推导。\n\n任务是对于试探波函数$\\psi_{n}(x)=x^{n}(L-x)^{n}$求能量的期望值$E(n) = \\frac{\\langle \\psi_{n}|H|\\psi_{n}\\rangle}{\\langle \\psi_{n}|\\psi_{n}\\rangle}$，然后相对于参数$n$最小化这个表达式。\n\n对于$x \\in (0, L)$，一维无限深势阱中粒子的哈密顿量由$H=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$给出。对于$n>0$，试探函数$\\psi_n(x)$满足边界条件$\\psi_n(0) = \\psi_n(L) = 0$。\n\n首先，我们计算归一化积分，也就是Rayleigh-Ritz商的分母。\n$$\n\\langle \\psi_{n}|\\psi_{n}\\rangle = \\int_{0}^{L} [\\psi_{n}(x)]^2 dx = \\int_{0}^{L} [x^{n}(L-x)^{n}]^2 dx = \\int_{0}^{L} x^{2n}(L-x)^{2n} dx\n$$\n为了计算这个积分，我们使用换元法$x = Lu$，这意味着$dx = L du$。积分限从$[0, L]$变为$[0, 1]$。\n$$\n\\langle \\psi_{n}|\\psi_{n}\\rangle = \\int_{0}^{1} (Lu)^{2n}(L-Lu)^{2n} (L du) = L^{4n+1} \\int_{0}^{1} u^{2n}(1-u)^{2n} du\n$$\n该积分是贝塔函数$B(a,b) = \\int_{0}^{1} t^{a-1}(1-t)^{b-1} dt$。这里，$a-1=2n$且$b-1=2n$，所以$a=b=2n+1$。\n$$\n\\langle \\psi_{n}|\\psi_{n}\\rangle = L^{4n+1} B(2n+1, 2n+1)\n$$\n使用贝塔函数和伽马函数之间的关系$B(a,b) = \\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}$，我们有：\n$$\n\\langle \\psi_{n}|\\psi_{n}\\rangle = L^{4n+1} \\frac{\\Gamma(2n+1)\\Gamma(2n+1)}{\\Gamma(4n+2)}\n$$\n\n接下来，我们计算哈密顿量的期望值，也就是该商的分子。\n$$\n\\langle \\psi_{n}|H|\\psi_{n}\\rangle = \\int_{0}^{L} \\psi_{n}(x) \\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\right) \\psi_{n}(x) dx\n$$\n使用分部积分法以及$\\psi_n(0)=\\psi_n(L)=0$的事实（对于$n>0$成立），我们可以将导数作用于第一个$\\psi_n(x)$。由于算符是厄米的，这等效于：\n$$\n\\langle \\psi_{n}|H|\\psi_{n}\\rangle = \\frac{\\hbar^{2}}{2m} \\int_{0}^{L} \\left(\\frac{d\\psi_{n}}{dx}\\right)^{2} dx\n$$\n条件$n > 1/2$确保了这个动能积分是有限的。首先，我们求$\\psi_{n}(x) = (Lx - x^2)^{n}$的导数。\n$$\n\\frac{d\\psi_{n}}{dx} = n(Lx-x^2)^{n-1}(L-2x) = n x^{n-1}(L-x)^{n-1}(L-2x)\n$$\n将导数平方得到：\n$$\n\\left(\\frac{d\\psi_{n}}{dx}\\right)^{2} = n^{2} x^{2n-2}(L-x)^{2n-2}(L-2x)^{2}\n$$\n我们将$(L-2x)^2$表示为$((L-x)-x)^2 = (L-x)^2 - 2x(L-x) + x^2$。动能的积分变为：\n$$\n\\int_{0}^{L} \\left(\\frac{d\\psi_{n}}{dx}\\right)^{2} dx = n^2 \\int_{0}^{L} x^{2n-2}(L-x)^{2n-2} \\left( (L-x)^2 - 2x(L-x) + x^2 \\right) dx\n$$\n$$\n= n^{2} \\left[ \\int_{0}^{L} x^{2n-2}(L-x)^{2n} dx - 2\\int_{0}^{L} x^{2n-1}(L-x)^{2n-1} dx + \\int_{0}^{L} x^{2n}(L-x)^{2n-2} dx \\right]\n$$\n我们像之前一样使用贝塔函数来计算这些积分：\n$$\n= n^{2} \\left[ L^{4n-1}B(2n-1, 2n+1) - 2L^{4n-1}B(2n, 2n) + L^{4n-1}B(2n+1, 2n-1) \\right]\n$$\n使用对称性质$B(a,b)=B(b,a)$，这可以简化为：\n$$\n= 2n^{2}L^{4n-1} \\left[ B(2n+1, 2n-1) - B(2n, 2n) \\right]\n$$\n现在，我们用伽马函数来表示它：\n$$\nB(2n+1, 2n-1) - B(2n, 2n) = \\frac{\\Gamma(2n+1)\\Gamma(2n-1)}{\\Gamma(4n)} - \\frac{\\Gamma(2n)\\Gamma(2n)}{\\Gamma(4n)}\n$$\n使用性质$\\Gamma(z+1)=z\\Gamma(z)$，我们有$\\Gamma(2n+1) = 2n\\Gamma(2n)$。\n$$\n= \\frac{2n\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(4n)} - \\frac{\\Gamma(2n)\\Gamma(2n)}{\\Gamma(4n)} = \\frac{\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(4n)} [2n - (2n-1)] = \\frac{\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(4n)}\n$$\n因此，该积分为：\n$$\n\\int_{0}^{L} \\left(\\frac{d\\psi_{n}}{dx}\\right)^{2} dx = 2n^{2}L^{4n-1} \\frac{\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(4n)}\n$$\n分子是：\n$$\n\\langle \\psi_{n}|H|\\psi_{n}\\rangle = \\frac{\\hbar^{2}}{2m} \\left( 2n^{2}L^{4n-1} \\frac{\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(4n)} \\right) = \\frac{\\hbar^{2}n^{2}}{m}L^{4n-1} \\frac{\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(4n)}\n$$\n\n现在我们计算能量期望值$E(n)$：\n$$\nE(n) = \\frac{\\langle \\psi_{n}|H|\\psi_{n}\\rangle}{\\langle \\psi_{n}|\\psi_{n}\\rangle} = \\frac{\\frac{\\hbar^{2}n^{2}}{m}L^{4n-1} \\frac{\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(4n)}}{L^{4n+1} \\frac{\\Gamma(2n+1)^2}{\\Gamma(4n+2)}} = \\frac{\\hbar^{2}n^{2}}{mL^2} \\frac{\\Gamma(2n)\\Gamma(2n-1)}{\\Gamma(2n+1)^2} \\frac{\\Gamma(4n+2)}{\\Gamma(4n)}\n$$\n重复使用伽马函数性质$\\Gamma(z+1)=z\\Gamma(z)$：\n$\\Gamma(2n+1) = 2n\\Gamma(2n)$，所以$\\Gamma(2n+1)^2 = 4n^2\\Gamma(2n)^2$。\n$\\Gamma(4n+2) = (4n+1)(4n)\\Gamma(4n)$。\n$\\Gamma(2n) = (2n-1)\\Gamma(2n-1)$。\n将这些代入$E(n)$的表达式中：\n$$\nE(n) = \\frac{\\hbar^{2}n^{2}}{mL^2} \\frac{\\Gamma(2n)\\Gamma(2n-1)}{4n^2\\Gamma(2n)^2} \\frac{(4n+1)(4n)\\Gamma(4n)}{\\Gamma(4n)} = \\frac{\\hbar^{2}}{mL^2} \\frac{\\Gamma(2n-1)}{4\\Gamma(2n)} (4n)(4n+1)\n$$\n$$\nE(n) = \\frac{\\hbar^{2}}{mL^2} \\frac{\\Gamma(2n-1)}{4(2n-1)\\Gamma(2n-1)} (4n)(4n+1) = \\frac{\\hbar^{2}}{mL^2} \\frac{n(4n+1)}{2n-1}\n$$\n\n为了找到使$E(n)$最小化的值$n^{\\star}$，我们必须找到函数$f(n) = \\frac{n(4n+1)}{2n-1} = \\frac{4n^2+n}{2n-1}$在$n > 1/2$上的最小值。我们计算关于$n$的导数并令其为零。\n$$\n\\frac{dE}{dn} = \\frac{\\hbar^{2}}{mL^2} \\frac{d}{dn}\\left(\\frac{4n^2+n}{2n-1}\\right) = 0\n$$\n对$f(n)$的导数使用商法则：\n$$\n\\frac{df}{dn} = \\frac{(8n+1)(2n-1) - (4n^2+n)(2)}{(2n-1)^2} = \\frac{(16n^2-6n-1) - (8n^2+2n)}{(2n-1)^2} = \\frac{8n^2-8n-1}{(2n-1)^2}\n$$\n令导数为零意味着分子必须为零：\n$$\n8n^2 - 8n - 1 = 0\n$$\n我们使用二次方程求根公式求解关于$n$的这个二次方程：\n$$\nn = \\frac{-(-8) \\pm \\sqrt{(-8)^2 - 4(8)(-1)}}{2(8)} = \\frac{8 \\pm \\sqrt{64+32}}{16} = \\frac{8 \\pm \\sqrt{96}}{16} = \\frac{8 \\pm 4\\sqrt{6}}{16} = \\frac{2 \\pm \\sqrt{6}}{4}\n$$\n我们得到两个解：$n_1 = \\frac{2+\\sqrt{6}}{4}$和$n_2 = \\frac{2-\\sqrt{6}}{4}$。参数的条件是$n > 1/2$。\n因为$\\sqrt{6} \\approx 2.449$，所以$n_1 \\approx \\frac{2+2.449}{4} \\approx 1.112$且$n_2 \\approx \\frac{2-2.449}{4} \\approx -0.112$。\n条件$n > 1/2 = 0.5$只被$n_1$满足。因此，最优参数是$n^{\\star} = \\frac{2+\\sqrt{6}}{4}$。$f(n)$在$n=n^{\\star}$处的二阶导数为正，证实了这是一个最小值。\n\n最后，我们将$n^{\\star}$代回到$E(n)$的表达式中，求得最小能量$E_{\\min} = E(n^{\\star})$。\n$$\nE_{\\min} = \\frac{\\hbar^{2}}{mL^2} \\frac{n^{\\star}(4n^{\\star}+1)}{2n^{\\star}-1}\n$$\n因为$n^{\\star}$是$8n^2 - 8n - 1 = 0$的一个根，我们有$8(n^{\\star})^2 = 8n^{\\star}+1$，这意味着$4(n^{\\star})^2 = 4n^{\\star} + 1/2$。我们可以简化$f(n^{\\star})$的分子：\n$$\n4(n^{\\star})^2 + n^{\\star} = (4n^{\\star} + 1/2) + n^{\\star} = 5n^{\\star} + 1/2\n$$\n所以，$f(n^{\\star}) = \\frac{5n^{\\star} + 1/2}{2n^{\\star}-1}$。代入$n^{\\star} = \\frac{2+\\sqrt{6}}{4}$：\n分子：$5\\left(\\frac{2+\\sqrt{6}}{4}\\right) + \\frac{1}{2} = \\frac{10+5\\sqrt{6}}{4} + \\frac{2}{4} = \\frac{12+5\\sqrt{6}}{4}$。\n分母：$2\\left(\\frac{2+\\sqrt{6}}{4}\\right) - 1 = \\frac{2+\\sqrt{6}}{2} - \\frac{2}{2} = \\frac{\\sqrt{6}}{2}$。\n$$\nf(n^{\\star}) = \\frac{(12+5\\sqrt{6})/4}{\\sqrt{6}/2} = \\frac{12+5\\sqrt{6}}{4} \\cdot \\frac{2}{\\sqrt{6}} = \\frac{12+5\\sqrt{6}}{2\\sqrt{6}} = \\frac{12}{2\\sqrt{6}} + \\frac{5\\sqrt{6}}{2\\sqrt{6}} = \\frac{6}{\\sqrt{6}} + \\frac{5}{2} = \\sqrt{6} + \\frac{5}{2}\n$$\n因此，最小化的能量是：\n$$\nE_{\\min} = \\left(\\frac{5}{2} + \\sqrt{6}\\right) \\frac{\\hbar^2}{mL^2}\n$$\n\n最终答案包括最优参数$n^{\\star}$和相应的最小能量$E_{\\min}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2+\\sqrt{6}}{4} & \\left(\\frac{5}{2} + \\sqrt{6}\\right)\\frac{\\hbar^2}{mL^2} \\end{pmatrix}}\n$$", "id": "2448904"}, {"introduction": "掌握了基本参数优化后，我们来挑战一个更复杂的二维体系：三角形无限深势阱。这个问题的核心教学价值不仅在于计算，更在于如何从第一性原理——即边界条件、对称性和基态无节点特性——出发，*构建*一个合适的试探波函数。这个练习将极大地锻炼你的物理直觉以及选择优秀试探函数的“艺术感”，这在研究无法精确求解的复杂系统时至关重要。[@problem_id:2448862]", "problem": "一个质量为$m$的无自旋非相对论性粒子被限制在一个三角形无限深势阱构成的二维域中。势$V(x,y)$定义为：当$(x,y)$在域$\\mathcal{D}=\\{(x,y)\\,|\\,x\\ge 0,\\;y\\ge 0,\\;x+y\\le L\\}$内时，$V(x,y)=0$；在其他地方，$V(x,y)=+\\infty$。在$\\mathcal{D}$内部，不含时薛定谔方程为$-\\frac{\\hbar^{2}}{2m}\\nabla^{2}\\psi(x,y)=E\\,\\psi(x,y)$，边界条件为在三角形的三个边上满足狄利克雷边界条件$\\psi=0$。\n\n使用变分原理，构造一个实试探波函数$\\psi_{\\text{trial}}(x,y)$，使其满足：\n- 在$\\mathcal{D}$上可归一化，\n- 在$\\mathcal{D}$内部为正（无节），\n- 在三角形的三个边上均为零，\n- 在交换$x\\leftrightarrow y$下对称，\n- 且在这些约束条件下具有最小的总多项式次数。\n\n然后，仅使用基本原理（不含时薛定谔方程和变分原理），推导基态能量对应的变分上界的显式解析表达式，\n$$E_{\\text{var}}=\\frac{\\langle \\psi_{\\text{trial}}|H|\\psi_{\\text{trial}}\\rangle}{\\langle \\psi_{\\text{trial}}|\\psi_{\\text{trial}}\\rangle},$$\n其中$H=-\\frac{\\hbar^{2}}{2m}\\nabla^{2}+V(x,y)$。你的推导应论证所有分部积分和边界项的处理。\n\n将最终答案表示为以$\\hbar$、$m$和$L$表示的闭式解析表达式（不需要数值近似或单位）。", "solution": "首先对问题陈述进行严格的验证过程。\n\n第1步：提取已知条件。\n- 一个质量为$m$的无自旋非相对论性粒子。\n- 一个由三角形无限深势阱定义的二维限制域。\n- 势为$V(x,y)=0$（当$(x,y)$在域$\\mathcal{D}=\\{(x,y)\\,|\\,x\\ge 0,\\;y\\ge 0,\\,x+y\\le L\\}$内时）以及$V(x,y)=+\\infty$（在其他地方）。\n- 在$\\mathcal{D}$内部的不含时薛定谔方程为$-\\frac{\\hbar^{2}}{2m}\\nabla^{2}\\psi(x,y)=E\\,\\psi(x,y)$。\n- 边界条件为在三角形的三个边上$\\psi=0$。\n- 必须构造一个实试探波函数$\\psi_{\\text{trial}}(x,y)$，具有以下性质：\n    1. 在$\\mathcal{D}$上可归一化。\n    2. 在$\\mathcal{D}$内部为正（无节）。\n    3. 在三角形的三个边上均为零。\n    4. 在交换$x\\leftrightarrow y$下对称。\n    5. 在这些约束条件下具有最小的总多项式次数。\n- 任务是推导基态能量的变分上界$E_{\\text{var}}=\\frac{\\langle \\psi_{\\text{trial}}|H|\\psi_{\\text{trial}}\\rangle}{\\langle \\psi_{\\text{trial}}|\\psi_{\\text{trial}}\\rangle}$，其中$H=-\\frac{\\hbar^{2}}{2m}\\nabla^{2}+V(x,y)$。\n- 推导过程必须论证任何分部积分和边界项的处理。\n\n第2步：使用提取的已知条件进行验证。\n根据所需标准对问题进行评估。\n- **科学依据：** 该问题描述了一个经典的“箱中粒子”情景，尽管其几何形状是不可分离的三角形。它使用了不含时薛定谔方程和变分原理，这两者都是量子力学的基石。该问题在科学上是合理的。\n- **适定性：** 域、势和边界条件都已明确定义。对试探波函数的约束是清晰的，足以确定其形式（最多差一个归一化常数）。目标是找到一个变分上界，这是一个明确定义的任务。该问题是适定的。\n- **客观性：** 该问题以精确的数学语言陈述，没有任何主观或模棱两可的术语。\n\n第3步：结论与行动。\n该问题是有效的。这是一个在量子力学中应用变分法的标准且定义明确的练习。现在将推导完整的解。\n\n首先，我们构造满足给定约束的试探波函数$\\psi_{\\text{trial}}(x,y)$。域$\\mathcal{D}$由直线$x=0$、$y=0$和$x+y=L$界定。要使$\\psi_{\\text{trial}}$在这些边界上为零，它必须包含因子$x$、$y$和$(L-x-y)$。满足此条件的最简单多项式形式是它们的乘积。我们提议：\n$$ \\psi(x,y) = N x y (L-x-y) $$\n其中$N$是一个归一化常数。我们根据给定的约束来检查这个函数：\n1.  **可归一化：** 作为一个多项式，$\\psi$在紧致域$\\mathcal{D}$上是连续且有界的，因此其平方是可积的。它是可归一化的。\n2.  **内部为正：** 对于$\\mathcal{D}$内部的任何点$(x,y)$，我们有$x>0$，$y>0$和$x+y<L$，这意味着$(L-x-y)>0$。三个正项的乘积是正的。\n3.  **边界为零：** 根据构造，如果$x=0$、$y=0$或$x+y=L$，则$\\psi(x,y)=0$。\n4.  **对称性：** 交换$x$和$y$得到$N y x (L-y-x) = N x y (L-x-y)$，所以该函数是对称的。\n5.  **最小次数：** 这个多项式的总次数为$3$。次数为$1$或$2$的多项式不能满足在三条不共点的直线上为零的条件。因此，次数$3$是最小的。\n\n$\\psi_{\\text{trial}}(x,y)$的这种形式是正确的。在计算变分能量时，归一化常数$N$会被消掉，所以我们可以使用未归一化的函数$\\psi(x,y) = xy(L-x-y)$。\n\n变分能量由下式给出：\n$$ E_{\\text{var}} = \\frac{\\iint_{\\mathcal{D}} \\psi H \\psi \\,dx\\,dy}{\\iint_{\\mathcal{D}} \\psi^2 \\,dx\\,dy} $$\n在域$\\mathcal{D}$内部，势$V(x,y)=0$，所以哈密顿算符纯粹是动能项：$H = -\\frac{\\hbar^2}{2m}\\nabla^2$。$E_{\\text{var}}$的表达式变为：\n$$ E_{\\text{var}} = \\frac{-\\frac{\\hbar^2}{2m} \\iint_{\\mathcal{D}} \\psi(x,y) \\nabla^2 \\psi(x,y) \\,dx\\,dy}{\\iint_{\\mathcal{D}} \\psi(x,y)^2 \\,dx\\,dy} $$\n我们使用格林第一恒等式$\\iint_{\\mathcal{D}} (f \\nabla^2 g) \\,dA = \\oint_{\\partial \\mathcal{D}} f (\\nabla g \\cdot \\mathbf{n}) \\,ds - \\iint_{\\mathcal{D}} (\\nabla f \\cdot \\nabla g) \\,dA$来计算分子积分。\n令$f=g=\\psi$，可得：\n$$ \\iint_{\\mathcal{D}} \\psi \\nabla^2 \\psi \\,dx\\,dy = \\oint_{\\partial \\mathcal{D}} \\psi (\\nabla \\psi \\cdot \\mathbf{n}) \\,ds - \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy $$\n正如问题陈述中所要求的，必须处理边界项$\\oint_{\\partial \\mathcal{D}} \\psi (\\nabla \\psi \\cdot \\mathbf{n}) \\,ds$。由于我们的试探波函数$\\psi$被构造成在边界$\\partial \\mathcal{D}$上处处为零，因此线积分的被积函数恒为零。因此，边界项为零。\n分子简化为：\n$$ \\langle \\psi | H | \\psi \\rangle = -\\frac{\\hbar^2}{2m} \\left( - \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy \\right) = \\frac{\\hbar^2}{2m} \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy $$\n所以变分能量是：\n$$ E_{\\text{var}} = \\frac{\\frac{\\hbar^2}{2m} \\iint_{\\mathcal{D}} |\\nabla \\psi(x,y)|^2 \\,dx\\,dy}{\\iint_{\\mathcal{D}} \\psi(x,y)^2 \\,dx\\,dy} $$\n现在我们必须计算这两个积分。在这个三角形域上对单项式进行积分有一个标准结果：\n$$ I(a,b) = \\iint_{\\mathcal{D}} x^a y^b \\,dx\\,dy = \\int_0^L dx \\int_0^{L-x} dy \\, x^a y^b = L^{a+b+2} \\frac{a!b!}{(a+b+2)!} $$\n首先，我们计算分母，即归一化积分$\\langle \\psi | \\psi \\rangle$：\n$$ \\psi^2 = (xy(L-x-y))^2 = (Lxy - x^2y - xy^2)^2 = L^2x^2y^2 + x^4y^2 + x^2y^4 - 2Lx^3y^2 - 2Lx^2y^3 + 2x^3y^3 $$\n$$ \\langle \\psi | \\psi \\rangle = \\iint_{\\mathcal{D}} \\psi^2 \\,dx\\,dy = L^2 I(2,2) + I(4,2) + I(2,4) - 2L I(3,2) - 2L I(2,3) + 2 I(3,3) $$\n使用$I(a,b)$的公式：\n$I(2,2) = \\frac{L^6}{180}$, $I(4,2) = I(2,4) = \\frac{L^8}{840}$, $I(3,2) = I(2,3) = \\frac{L^7}{420}$, $I(3,3) = \\frac{L^8}{1120}$。\n$$ \\langle \\psi | \\psi \\rangle = L^2\\left(\\frac{L^6}{180}\\right) + 2\\left(\\frac{L^8}{840}\\right) - 4L\\left(\\frac{L^7}{420}\\right) + 2\\left(\\frac{L^8}{1120}\\right) \\\\ = L^8 \\left(\\frac{1}{180} + \\frac{1}{420} - \\frac{1}{105} + \\frac{1}{560}\\right) = L^8 \\left(\\frac{1}{180} - \\frac{3}{420} + \\frac{1}{560}\\right) = L^8 \\left(\\frac{1}{180} - \\frac{1}{140} + \\frac{1}{560}\\right) $$\n$180$、$140$和$560$的最小公倍数是$5040$。\n$$ \\langle \\psi | \\psi \\rangle = L^8 \\left(\\frac{28}{5040} - \\frac{36}{5040} + \\frac{9}{5040}\\right) = L^8 \\frac{28 - 36 + 9}{5040} = \\frac{L^8}{5040} $$\n接下来，我们计算分子积分。我们需要$\\psi = Lxy - x^2y - xy^2$的梯度：\n$$ \\frac{\\partial \\psi}{\\partial x} = Ly - 2xy - y^2 = y(L-2x-y) $$\n$$ \\frac{\\partial \\psi}{\\partial y} = Lx - x^2 - 2xy = x(L-x-2y) $$\n所以，$|\\nabla \\psi|^2 = (\\frac{\\partial \\psi}{\\partial x})^2 + (\\frac{\\partial \\psi}{\\partial y})^2 = y^2(L-2x-y)^2 + x^2(L-x-2y)^2$。\n积分为$\\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy$。由于积分域的对称性和被积函数$f(x,y)+f(y,x)$的形式，这两项的积分是相等的。\n$$ \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy = 2 \\iint_{\\mathcal{D}} y^2(L-2x-y)^2 \\,dx\\,dy $$\n展开被积函数：\n$$ y^2(L-2x-y)^2 = y^2(L^2 + 4x^2 + y^2 - 4Lx - 2Ly + 4xy) = L^2y^2 - 4Lxy^2 + 4x^2y^2 - 2Ly^3 + 4xy^3 + y^4 $$\n使用$I(a,b)$逐项积分：\n$$ \\iint_{\\mathcal{D}} y^2(L-2x-y)^2 \\,dx\\,dy = L^2 I(0,2) - 4L I(1,2) + 4 I(2,2) - 2L I(0,3) + 4 I(1,3) + I(0,4) $$\n使用以下值：$I(0,2) = \\frac{L^4}{12}$, $I(1,2) = \\frac{L^5}{60}$, $I(2,2) = \\frac{L^6}{180}$, $I(0,3) = \\frac{L^5}{20}$, $I(1,3) = \\frac{L^6}{120}$, $I(0,4) = \\frac{L^6}{30}$。\n$$ \\iint y^2(L-2x-y)^2d A = L^6\\left(\\frac{1}{12} - \\frac{4}{60} + \\frac{4}{180} - \\frac{2}{20} + \\frac{4}{120} + \\frac{1}{30}\\right) = L^6\\left(\\frac{1}{12} - \\frac{1}{15} + \\frac{1}{45} - \\frac{1}{10} + \\frac{1}{30} + \\frac{1}{30}\\right) $$\n$$ = L^6\\left(\\frac{1}{12} - \\frac{1}{15} - \\frac{1}{10} + \\frac{1}{45} + \\frac{1}{15}\\right) = L^6\\left(\\frac{1}{12} - \\frac{1}{10} + \\frac{1}{45}\\right) $$\n$12$、$10$、$45$的公分母是$180$。\n$$ = L^6\\left(\\frac{15}{180} - \\frac{18}{180} + \\frac{4}{180}\\right) = L^6 \\frac{15-18+4}{180} = \\frac{L^6}{180} $$\n因此，完整的分子积分为$\\iint |\\nabla \\psi|^2 \\,dx\\,dy = 2 \\times \\frac{L^6}{180} = \\frac{L^6}{90}$。\n最后，我们组合变分能量：\n$$ E_{\\text{var}} = \\frac{\\frac{\\hbar^2}{2m} \\left(\\frac{L^6}{90}\\right)}{\\frac{L^8}{5040}} = \\frac{\\hbar^2}{2m L^2} \\frac{5040}{90} = \\frac{\\hbar^2}{2m L^2} \\times 56 = \\frac{28\\hbar^2}{mL^2} $$\n这就是基态能量的变分上界。", "answer": "$$\n\\boxed{\\frac{28\\hbar^{2}}{mL^{2}}}\n$$", "id": "2448862"}, {"introduction": "最后，我们将接触变分法中最强大和最广泛应用的工具——线性变分法（或称瑞利-里兹方法）。在这种方法中，我们不再局限于优化单个非线性参数，而是将试探函数表示为一组基函数$\\psi(x) = \\sum_{n=1}^{N} c_n \\sin(n\\pi x/L)$的线性组合，通过优化组合系数$\\{c_n\\}$来逼近真实解。这个过程巧妙地将量子力学问题转化为了一个矩阵本征值问题，这是计算物理学的基石。通过解决一个带线性倾斜势$V(x) = \\epsilon x/L$的势阱问题，你将学会如何将变分原理系统化地应用于数值计算。[@problem_id:2448914]", "problem": "考虑一个质量为$m$的非相对论量子粒子，被限制在$x \\in [0,L]$的一维无限深势阱中，其哈密顿算符为$H = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2} + V(x)$，并满足狄利克雷边界条件$\\psi(0)=\\psi(L)=0$。在势阱内部，势函数是线性倾斜的：$V(x) = \\epsilon\\, x/L$，其中$\\epsilon \\ge 0$是一个设定斜率尺度的常数。使用Rayleigh–Ritz变分法，并采用截断的傅里叶正弦级数作为试探函数\n$$\\psi(x) = \\sum_{n=1}^{N} c_n \\sin\\!\\left(\\dfrac{n\\pi x}{L}\\right),$$\n在归一化约束$\\int_0^L |\\psi(x)|^2\\,dx = 1$下，确定能最小化能量期望值的系数$\\{c_n\\}_{n=1}^N$。\n\n从基本原理出发：不含时薛定谔方程和变分原理，即对于任意归一化的$\\psi$，能量泛函$E[\\psi] = \\dfrac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi \\rangle}$给出了基态能量的一个上界。利用基函数$b_n(x) = \\sin(n\\pi x/L)$，将关于系数$c_n$的最小化问题转化为一个有限维广义本征值问题。构建重叠矩阵$S_{mn} = \\int_0^L b_m(x)\\,b_n(x)\\,dx$和哈密顿矩阵$H_{mn} = \\int_0^L b_m(x)\\,H\\,b_n(x)\\,dx$。从第一性原理出发，为所有需要的积分推导闭合形式表达式，包括：\n- 基于对$b_n(x)$的微分，计算对$H_{mn}$的动能贡献，\n- 通过精确计算$\\int_0^L x\\,\\sin(\\cdot)\\sin(\\cdot)\\,dx$，计算对$H_{mn}$的势能贡献，\n- 以及用矩阵$S$表示的归一化条件。\n\n你的程序必须：\n- 使用你推导的闭合形式积分精确构建$S$和$H$，\n- 求解广义对称本征值问题以获得最低本征值$E_0$及其对应的本征向量$c$，\n- 归一化本征向量，使得$\\int_0^L \\psi^2(x)\\,dx = 1$，等价于$c^\\top S c = 1$，\n- 通过强制要求第一个其绝对值大于一个微小阈值的系数为非负来修正全局相位/符号的不确定性，\n- 并报告基态能量和前三个系数。\n\n使用以下单位约定：设$\\hbar = 1$和$m = 1$。在此约定下，能量以这些选择所引申的无量纲单位表示。长度$L$在每个测试中指定，并以相同的一致单位制测量，因此能量按$1/L^2$的比例缩放。将所有能量和系数表示为四舍五入到6位小数的十进制数。\n\n测试套件。你的程序必须运行以下几种情况：\n- 情况 A（理想情况）：$N=6$, $L=1.0$, $\\epsilon=0.0$。\n- 情况 B（弱斜率）：$N=6$, $L=1.0$, $\\epsilon=0.1$。\n- 情况 C（强斜率和更大的基）：$N=12$, $L=1.0$, $\\epsilon=5.0$。\n- 情况 D（边界情况，最小基）：$N=1$, $L=1.0$, $\\epsilon=1.0$。\n\n对于每种情况，在应用上述归一化和符号约定后，输出一个包含基态能量和前三个系数的列表$[E_0, c_1, c_2, c_3]$。如果$N < 3$，则用零填充缺失的前几个系数，以确保每种情况都报告三个系数。你的程序应产生单行输出，其中包含情况 A–D 的结果，形式为一个由这四个四元素列表组成的逗号分隔列表，并用方括号括起来，例如：[[x11,x12,x13,x14],[x21,x22,x23,x24],[x31,x32,x33,x34],[x41,x42,x43,x44]]，其中每个$xij$都是四舍五入到6位小数的十进制数。", "solution": "所述问题是有效的。这是Rayleigh-Ritz变分法（计算量子力学中的一种基本技术）在一个带有线性微扰的一维无限深势阱中的粒子问题上的一个适定应用。该问题具有科学依据、客观，并包含在指定的有限基内获得唯一解所需的所有信息。我们继续进行推导和求解。\n\n问题的核心是为给定的哈密顿量：\n$$H = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + \\frac{\\epsilon x}{L}$$\n在区域$x \\in [0, L]$上，边界条件为$\\psi(0) = \\psi(L) = 0$的情况下，找到不含时薛定谔方程$H\\psi = E\\psi$的一个近似基态解。\n\n变分原理指出，对于任何归一化的试探波函数$\\psi$，能量的期望值$E[\\psi] = \\langle\\psi|H|\\psi\\rangle = \\int_0^L \\psi^*(x) H \\psi(x) dx$为真实的基态能量$E_0$提供了一个上界。我们给定一个试探波函数，它是基函数$b_n(x)$的有限线性组合：\n$$\\psi(x) = \\sum_{n=1}^{N} c_n b_n(x), \\quad \\text{其中} \\quad b_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n这种基函数的选择正确地满足了边界条件。系数$\\{c_n\\}$是实数，因此$\\psi^*(x) = \\psi(x)$。\n\n用系数$c_n$表示的能量泛函为：\n$$E(c_1, \\dots, c_N) = \\frac{\\langle \\sum_m c_m b_m | H | \\sum_n c_n b_n \\rangle}{\\langle \\sum_m c_m b_m | \\sum_n c_n b_n \\rangle} = \\frac{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) H b_n(x) dx}{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) b_n(x) dx}$$\n我们定义哈密顿矩阵元$H_{mn} = \\int_0^L b_m(x) H b_n(x) dx$和重叠矩阵元$S_{mn} = \\int_0^L b_m(x) b_n(x) dx$。能量泛函变为：\n$$E = \\frac{\\mathbf{c}^T H \\mathbf{c}}{\\mathbf{c}^T S \\mathbf{c}}$$\n为了找到最小化此能量的系数，我们需要对所有$k = 1, \\dots, N$满足$\\frac{\\partial E}{\\partial c_k} = 0$。此过程将引出广义本征值问题：\n$$H \\mathbf{c} = E S \\mathbf{c}$$\n该系统的最低本征值$E$是基态能量的变分估计，而相应的本征向量$\\mathbf{c}$给出了近似基态波函数的系数。我们现在从第一性原理推导矩阵元$S_{mn}$和$H_{mn}$。\n\n**重叠矩阵 $S_{mn}$**\n重叠矩阵的元素由以下积分给出：\n$$S_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n基函数在区间$[0, L]$上是正交的。这个标准积分的计算结果为：\n$$S_{mn} = \\frac{L}{2} \\delta_{mn}$$\n其中$\\delta_{mn}$是克罗内克δ函数。因此，重叠矩阵$S$是一个对角矩阵。\n\n**哈密顿矩阵 $H_{mn}$**\n哈密顿矩阵元可以分解为动能和势能的贡献：$H_{mn} = T_{mn} + V_{mn}$。\n\n**动能项 $T_{mn}$**\n动能算符是$T = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$。其矩阵元为：\n$$T_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n基函数是二阶导数算符的本征函数：\n$$\\frac{d^2}{dx^2} \\sin\\left(\\frac{n\\pi x}{L}\\right) = -\\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n将此代入$T_{mn}$的积分中：\n$$T_{mn} = \\frac{\\hbar^2}{2m} \\left(\\frac{n\\pi}{L}\\right)^2 \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\hbar^2 \\pi^2 n^2}{2mL^2} S_{mn}$$\n使用$S_{mn}=\\frac{L}{2}\\delta_{mn}$和指定的单位$\\hbar=1, m=1$：\n$$T_{mn} = \\frac{\\pi^2 n^2}{2L^2} \\left(\\frac{L}{2}\\delta_{mn}\\right) = \\frac{\\pi^2 n^2}{4L} \\delta_{mn}$$\n动能矩阵$T$也是对角的。\n\n**势能项 $V_{mn}$**\n势函数为$V(x) = \\epsilon x / L$。其矩阵元为：\n$$V_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(\\frac{\\epsilon x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n为计算此积分，我们首先考虑对角元，$m=n$：\n$$V_{nn} = \\frac{\\epsilon}{L} \\int_0^L x \\sin^2\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx$$\n当$a = 2n\\pi/L$时，积分$\\int_0^L x \\cos(ax) dx$的值为零。因此，只有第一项有贡献：\n$$V_{nn} = \\frac{\\epsilon}{2L} \\int_0^L x dx = \\frac{\\epsilon}{2L} \\left[\\frac{x^2}{2}\\right]_0^L = \\frac{\\epsilon}{2L} \\frac{L^2}{2} = \\frac{\\epsilon L}{4}$$\n对于非对角元，$m \\neq n$，我们使用恒等式$\\sin A \\sin B = \\frac{1}{2}[\\cos(A-B) - \\cos(A+B)]$：\n$$V_{mn} = \\frac{\\epsilon}{2L} \\int_0^L x \\left[ \\cos\\left(\\frac{(m-n)\\pi x}{L}\\right) - \\cos\\left(\\frac{(m+n)\\pi x}{L}\\right) \\right] dx$$\n我们使用通过分部积分法计算的标准积分：\n$$\\int_0^L x \\cos\\left(\\frac{k\\pi x}{L}\\right) dx = \\frac{L^2}{(k\\pi)^2}(\\cos(k\\pi)-1) = \\frac{L^2}{(k\\pi)^2}((-1)^k-1)$$\n如果$k$是偶数，此积分为零；如果$k$是奇数，则为$-2L^2/(k\\pi)^2$。\n对于$m \\ne n$的$V_{mn}$，整数$k$为$(m-n)$和$(m+n)$。两者具有相同的奇偶性。\n如果$(m-n)$是偶数，两个积分都为零，因此$V_{mn}=0$。\n如果$(m-n)$是奇数，两个积分都非零：\n\\begin{align*} V_{mn} &= \\frac{\\epsilon}{2L} \\left[ \\frac{-2L^2}{((m-n)\\pi)^2} - \\frac{-2L^2}{((m+n)\\pi)^2} \\right] \\\\ &= -\\frac{\\epsilon L}{\\pi^2} \\left[ \\frac{1}{(m-n)^2} - \\frac{1}{(m+n)^2} \\right] \\\\ &= -\\frac{\\epsilon L}{\\pi^2} \\frac{(m+n)^2 - (m-n)^2}{(m^2-n^2)^2} \\\\ &= -\\frac{\\epsilon L}{\\pi^2} \\frac{4mn}{(m^2-n^2)^2}\\end{align*}\n\n**矩阵元总结**\n在单位$\\hbar=1, m=1$下：\n$$S_{mn} = \\frac{L}{2}\\delta_{mn}$$\n$$H_{mn} = T_{mn} + V_{mn}$$\n当$m=n$时：\n$$H_{nn} = \\frac{\\pi^2 n^2}{4L} + \\frac{\\epsilon L}{4}$$\n当$m \\ne n$时：\n$$H_{mn} = \\begin{cases} 0 & \\text{若 } (m-n) \\text{ 为偶数} \\\\ -\\dfrac{4\\epsilon L}{\\pi^2} \\dfrac{mn}{(m^2-n^2)^2} & \\text{若 } (m-n) \\text{ 为奇数} \\end{cases}$$\n\n构建这些矩阵并用它们来求解广义本征值问题$H\\mathbf{c} = E S\\mathbf{c}$。最低本征值$E_0$是基态能量的估计值。相应的本征向量$\\mathbf{c}$经过归一化，使得$\\mathbf{c}^T S \\mathbf{c} = 1$，这等价于$\\int_0^L \\psi^2(x)dx=1$。通过要求第一个不可忽略的系数$c_n$为正来固定全局相位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the variational problem for a particle in a 1D box with a linear potential.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L, epsilon)\n        (6, 1.0, 0.0),   # Case A\n        (6, 1.0, 0.1),   # Case B\n        (12, 1.0, 5.0),  # Case C\n        (1, 1.0, 1.0),   # Case D\n    ]\n\n    results = []\n    for N, L, epsilon in test_cases:\n        # Assemble the overlap matrix S and Hamiltonian matrix H.\n        S = np.zeros((N, N))\n        H = np.zeros((N, N))\n\n        # Populate the matrices using 1-based indexing for n and m for clarity\n        # with the derived formulas.\n        for i in range(N):\n            for j in range(N):\n                n = i + 1\n                m = j + 1\n                \n                if i == j:\n                    S[i, j] = L / 2.0\n                    T_nn = (np.pi**2 * n**2) / (4.0 * L)\n                    V_nn = epsilon * L / 4.0\n                    H[i, j] = T_nn + V_nn\n                else:\n                    S[i, j] = 0.0\n                    # T_mn is zero for m != n\n                    # V_mn is non-zero only if (m-n) is odd\n                    if (m - n) % 2 != 0:\n                        V_mn = (-4.0 * epsilon * L / np.pi**2) * \\\n                               (m * n) / (m**2 - n**2)**2\n                        H[i, j] = V_mn\n                    else:\n                        H[i, j] = 0.0\n\n        # Solve the generalized eigenvalue problem Hc = ESc\n        # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n        # that are S-orthonormal (c.T @ S @ c = 1).\n        eigenvalues, eigenvectors = eigh(H, S)\n\n        # The ground state energy is the lowest eigenvalue\n        E0 = eigenvalues[0]\n\n        # The coefficients are the first eigenvector\n        c = eigenvectors[:, 0]\n\n        # Fix the global sign ambiguity.\n        # Enforce that the first coefficient with magnitude greater than a small\n        # threshold is non-negative.\n        threshold = 1e-9\n        for k in range(N):\n            if abs(c[k]) > threshold:\n                if c[k] < 0:\n                    c = -c\n                break\n        \n        # Extract the first three coefficients, padding with zeros if N < 3.\n        c1 = c[0] if N >= 1 else 0.0\n        c2 = c[1] if N >= 2 else 0.0\n        c3 = c[2] if N >= 3 else 0.0\n\n        # Append the formatted result for this case.\n        results.append([E0, c1, c2, c3])\n\n    # Format the final output string exactly as specified.\n    # Each sublist is formatted, then joined by commas, and enclosed in brackets.\n    formatted_results = []\n    for res in results:\n        formatted_res = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f}]\"\n        formatted_results.append(formatted_res)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2448914"}]}