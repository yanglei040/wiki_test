{"hands_on_practices": [{"introduction": "在设计副本交换蒙特卡洛模拟时，一个核心的实际问题是如何选择最佳的副本数量 $M$。增加副本数量可以提高在温度空间中的扩散效率，从而改善采样，但这也会直接增加每个周期的计算成本。本练习将指导您从基本物理原理出发，建立一个描述总计算功耗与 $M$ 关系的成本函数，从而找到平衡效率与成本的最佳副本数量[@problem_id:2434293]。", "problem": "考虑一个一维并行退火（也称为副本交换蒙特卡洛）设置，其中包含 $M$ 个副本，其逆温度分别为 $\\beta_0, \\beta_1, \\dots, \\beta_{M-1}$，分布在一个固定区间 $[\\beta_{\\min}, \\beta_{\\max}]$ 内，其中 $\\beta_{\\max} > \\beta_{\\min}$。假设逆温度在 $\\beta$ 上均匀分布，因此相邻间距为 $\\Delta \\beta = (\\beta_{\\max} - \\beta_{\\min})/(M-1)$。在每次尝试最近邻交换之间，假设每个副本进行一次局部马尔可夫链蒙特卡洛扫描，因此一个“周期”包括对 $M$ 个副本中的每一个进行一次局部扫描，然后进行一整套最近邻交换尝试。一个周期的计算成本与 $M$ 成正比。\n\n您将研究在最冷副本上达到固定绝对统计误差所需的总计算时间如何随 $M$ 变化，并确定是否存在一个最优的 $M$。仅使用第一性原理论证和标准的、广泛使用的近似方法。您的推导必须从以下基础出发：\n\n- 正则系综和满足细致平衡的 Metropolis 接受准则：对于在逆温度为 $\\beta_i$ 和 $\\beta_j$ 的副本之间交换构型 $x_i$ 和 $x_j$ 的提议，Metropolis 接受率为 $\\exp\\left((\\beta_i - \\beta_j)(E(x_i) - E(x_j))\\right)$。\n- 正则系综的涨落-耗散关系：$\\dfrac{d \\langle E \\rangle}{d \\beta} = -\\mathrm{Var}(E)$。\n- 中心极限定理和有效样本量概念：对于一个积分自相关时间为 $\\tau_{\\mathrm{int}}$ 的平稳时间序列，在长时间 $t$ 后样本均值的方差尺度为 $\\sigma_A^2 \\, (2 \\tau_{\\mathrm{int}}/t)$，这等效于拥有 $N_{\\mathrm{eff}} \\approx t/(2 \\tau_{\\mathrm{int}})$ 个独立样本。\n- 随机游走的首次穿越标度：对于无偏一维随机游走，穿越长度为 $L$ 的区间的平均首次穿越时间尺度为 $L^2/D$，其中 $D$ 是扩散系数。\n\n在以下建模假设下进行推导，您必须在推导中明确引用并论证每一个假设：\n\n- 在温度阶梯上，相邻副本的能量涨落近似为高斯分布，并且在 $\\Delta \\beta$ 范围内对温度的依赖性很弱，其共同的能量标准差 $\\sigma_E$ 代表了阶梯中间部分的情况。\n- 为了估计单个副本温度指标的长时间扩散，相邻交换尝试在不同周期之间是统计独立的。\n- 为了将最冷副本的误差与挂钟时间工作量进行标度分析，主导的相关尺度是一个标记副本的温度往返时间（从最冷端到最热端再返回），并且一次往返在最冷温度下产生一个有效独立样本。\n\n任务：\n\n1) 仅使用所述基础，推导相隔 $\\Delta \\beta$ 的副本之间的平均最近邻交换接受概率 $p_{\\mathrm{acc}}(\\Delta \\beta, \\sigma_E)$ 的近似表达式。您的推导必须从 Metropolis 接受准则开始，对相邻副本的联合高斯能量涨落进行平均，并使用涨落-耗散关系将平均能量差在 $\\Delta \\beta$ 上线性化。\n\n2) 将单个副本的温度指标的运动建模为在整数段 $\\{0,1,\\dots,M-1\\}$ 上的带反射边界的无偏一维随机游走，每个交换周期以与接受概率 $p_{\\mathrm{acc}}$ 成正比的概率走一个单位步长。根据随机游走的首次穿越标度，推导平均往返时间 $\\tau_{\\mathrm{rt}}(M)$ 的标度关系，该关系以 $M$ 和 $p_{\\mathrm{acc}}$ 表示，并忽略一个与 $M$ 无关的乘法常数。\n\n3) 设在最冷副本上达到固定目标绝对误差的总计算功与每个周期的成本和获得固定数量的有效独立样本所需的周期数的乘积成正比。使用第 1 部分和第 2 部分的结论，论证形式为\n$$\nW(M) = \\frac{M\\,(M-1)^2}{p_{\\mathrm{acc}}(M)}\n$$\n的成本函数（忽略一个与 $M$ 无关的总体乘法常数）捕捉了所需计算功对 $M$ 的依赖关系，其中 $p_{\\mathrm{acc}}(M)$ 是在均匀间距 $\\Delta \\beta = (\\beta_{\\max} - \\beta_{\\min})/(M-1)$ 处计算的 $p_{\\mathrm{acc}}$。\n\n4) 实现一个完整的、可运行的程序，对于以下每个测试用例，计算在范围 $2 \\le M \\le M_{\\max}$ 内使成本函数 $W(M)$ 最小化的整数 $M$，并返回最小化 $M$ 和最小化成本值 $W_{\\min}$。您的实现必须使用您在第 1 部分中推导的接受概率表达式，并采用上述指定的 $\\beta$ 均匀间距。如果为了数值稳健性需要，您可以将零接受概率视为无限成本。\n\n测试套件（每个用例为 $(\\beta_{\\min}, \\beta_{\\max}, \\sigma_E, M_{\\max})$）：\n\n- 用例 A: $(\\beta_{\\min}, \\beta_{\\max}, \\sigma_E, M_{\\max}) = (\\,0.5,\\,1.0,\\,10.0,\\,100\\,)$.\n- 用例 B: $(\\beta_{\\min}, \\beta_{\\max}, \\sigma_E, M_{\\max}) = (\\,0.9,\\,1.0,\\,20.0,\\,100\\,)$.\n- 用例 C: $(\\beta_{\\min}, \\beta_{\\max}, \\sigma_E, M_{\\max}) = (\\,0.1,\\,2.1,\\,30.0,\\,150\\,)$.\n- 用例 D: $(\\beta_{\\min}, \\beta_{\\max}, \\sigma_E, M_{\\max}) = (\\,0.95,\\,0.96,\\,5.0,\\,50\\,)$.\n\n单位：在本问题的建模假设下，所有量都是无量纲的，因此不需要单位转换。\n\n最终输出规范：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例贡献一个双元素列表 $[M_{\\mathrm{opt}}, W_{\\min}]$，其中 $M_{\\mathrm{opt}}$ 是整数，$W_{\\min}$ 是浮点数。例如，整体格式必须类似于 $[[M_1,W_1],[M_2,W_2],[M_3,W_3],[M_4,W_4]]$，不含多余文本或空格。", "solution": "此问题已经过验证，被认为是科学上合理的、问题明确的、客观的。它代表了计算统计物理领域中关于优化副本交换蒙特卡洛（REMC）算法的一个标准理论练习。所有提供的原理和假设都是该领域的标准做法，并为所要求的推导构成了连贯的基础。问题有效，解决方案如下。\n\n推导按要求分三部分进行，最终得到成本函数 $W(M)$，该函数将在最后的程序中实现并最小化。\n\n**1. 交换接受概率 $p_{\\mathrm{acc}}$ 的推导**\n\n我们首先考虑在逆温度分别为 $\\beta_i$ 和 $\\beta_{i+1}$ 的两个相邻副本（索引为 $i$ 和 $i+1$）之间进行构型交换。设它们当前构型的能量为 $E_i$ 和 $E_{i+1}$。温度间距是均匀的，$\\Delta\\beta = \\beta_{i+1} - \\beta_i$。交换构型的 Metropolis 接受准则由下式给出：\n$$\nA(E_i, E_{i+1}) = \\min\\left(1, \\exp\\left((\\beta_i - \\beta_{i+1})(E_i - E_{i+1})\\right)\\right) = \\min\\left(1, \\exp\\left(-\\Delta\\beta(E_i - E_{i+1})\\right)\\right)\n$$\n平均接受概率 $p_{\\mathrm{acc}}$ 是 $A(E_i, E_{i+1})$ 在两个副本的平衡能量分布上的期望值。我们定义能量差 $\\delta E = E_i - E_{i+1}$。构型是从独立的正则系综中采样的，因此 $E_i$ 和 $E_{i+1}$ 是独立的随机变量。\n\n我们引用第一个建模假设：能量分布近似为高斯分布，并且对于相邻副本，它们共享一个共同的方差 $\\sigma_E^2$。因此，$E_i \\sim \\mathcal{N}(\\langle E \\rangle_i, \\sigma_E^2)$ 且 $E_{i+1} \\sim \\mathcal{N}(\\langle E \\rangle_{i+1}, \\sigma_E^2)$。差值 $\\delta E$ 也是一个高斯随机变量，其均值为 $\\mu_{\\delta E}$，方差为 $\\sigma_{\\delta E}^2$：\n$$\n\\mu_{\\delta E} = \\langle E_i \\rangle - \\langle E_{i+1} \\rangle = \\langle E \\rangle(\\beta_i) - \\langle E \\rangle(\\beta_{i+1})\n$$\n$$\n\\sigma_{\\delta E}^2 = \\mathrm{Var}(E_i) + \\mathrm{Var}(E_{i+1}) = \\sigma_E^2 + \\sigma_E^2 = 2\\sigma_E^2\n$$\n为了计算 $\\mu_{\\delta E}$，我们使用涨落-耗散关系 $\\frac{d\\langle E \\rangle}{d\\beta} = -\\mathrm{Var}(E) = -\\sigma_E^2$。对于小的间距 $\\Delta\\beta$，我们可以在 $\\beta_i$ 附近对 $\\langle E \\rangle(\\beta_{i+1})$ 进行线性化：\n$$\n\\langle E \\rangle(\\beta_{i+1}) = \\langle E \\rangle(\\beta_i + \\Delta\\beta) \\approx \\langle E \\rangle(\\beta_i) + \\frac{d\\langle E \\rangle}{d\\beta}\\bigg|_{\\beta_i} \\Delta\\beta = \\langle E \\rangle(\\beta_i) - \\sigma_E^2 \\Delta\\beta\n$$\n将此代入 $\\mu_{\\delta E}$ 的表达式中：\n$$\n\\mu_{\\delta E} \\approx \\langle E \\rangle(\\beta_i) - (\\langle E \\rangle(\\beta_i) - \\sigma_E^2 \\Delta\\beta) = \\sigma_E^2 \\Delta\\beta\n$$\n所以，$\\delta E \\sim \\mathcal{N}(\\sigma_E^2 \\Delta\\beta, 2\\sigma_E^2)$。让我们将接受准则中的指数定义为一个随机变量 $X = -\\Delta\\beta \\cdot \\delta E$。作为高斯变量的线性变换， $X$ 也是高斯分布的。其均值 $\\mu_X$ 和方差 $\\sigma_X^2$ 为：\n$$\n\\mu_X = \\mathbb{E}[X] = -\\Delta\\beta \\cdot \\mathbb{E}[\\delta E] = -\\Delta\\beta (\\sigma_E^2 \\Delta\\beta) = -(\\sigma_E \\Delta\\beta)^2\n$$\n$$\n\\sigma_X^2 = \\mathrm{Var}(X) = (-\\Delta\\beta)^2 \\cdot \\mathrm{Var}(\\delta E) = (\\Delta\\beta)^2 (2\\sigma_E^2) = 2(\\sigma_E \\Delta\\beta)^2\n$$\n平均接受概率为 $p_{\\mathrm{acc}} = \\mathbb{E}[\\min(1, e^X)]$，其中 $X \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$。这个期望可以计算为：\n$$\np_{\\mathrm{acc}} = \\int_{-\\infty}^{\\infty} \\min(1, e^x) f_X(x) dx = \\int_{-\\infty}^{0} e^x f_X(x) dx + \\int_{0}^{\\infty} f_X(x) dx\n$$\n其中 $f_X(x)$ 是 $X$ 的概率密度函数。该积分有一个已知的解析结果（可以通过在第一项的指数中配方法推导得出）：\n$$\np_{\\mathrm{acc}} = \\exp\\left(\\mu_X + \\frac{\\sigma_X^2}{2}\\right) \\Phi\\left(\\frac{-\\mu_X - \\sigma_X^2}{\\sigma_X}\\right) + 1 - \\Phi\\left(\\frac{-\\mu_X}{\\sigma_X}\\right)\n$$\n其中 $\\Phi(z)$ 是标准正态分布的累积分布函数。代入我们关于 $\\mu_X$ 和 $\\sigma_X^2$ 的表达式：\n$$\n\\mu_X + \\frac{\\sigma_X^2}{2} = -(\\sigma_E \\Delta\\beta)^2 + \\frac{2(\\sigma_E \\Delta\\beta)^2}{2} = 0\n$$\n第一项的前置因子是 $\\exp(0)=1$。 $\\Phi$ 的参数变为：\n$$\n\\frac{-\\mu_X - \\sigma_X^2}{\\sigma_X} = \\frac{(\\sigma_E \\Delta\\beta)^2 - 2(\\sigma_E \\Delta\\beta)^2}{\\sqrt{2} \\sigma_E \\Delta\\beta} = \\frac{-(\\sigma_E \\Delta\\beta)^2}{\\sqrt{2} \\sigma_E \\Delta\\beta} = -\\frac{\\sigma_E \\Delta\\beta}{\\sqrt{2}}\n$$\n$$\n\\frac{-\\mu_X}{\\sigma_X} = \\frac{(\\sigma_E \\Delta\\beta)^2}{\\sqrt{2} \\sigma_E \\Delta\\beta} = \\frac{\\sigma_E \\Delta\\beta}{\\sqrt{2}}\n$$\n利用对称性 $\\Phi(-z) = 1 - \\Phi(z)$，第二项变为 $1 - \\Phi(\\frac{\\sigma_E \\Delta\\beta}{\\sqrt{2}}) = \\Phi(-\\frac{\\sigma_E \\Delta\\beta}{\\sqrt{2}})$。因此，\n$$\np_{\\mathrm{acc}} = \\Phi\\left(-\\frac{\\sigma_E \\Delta\\beta}{\\sqrt{2}}\\right) + \\Phi\\left(-\\frac{\\sigma_E \\Delta\\beta}{\\sqrt{2}}\\right) = 2 \\Phi\\left(-\\frac{\\sigma_E \\Delta\\beta}{\\sqrt{2}}\\right)\n$$\n使用 $\\Phi(z)$ 和互补误差函数 $\\mathrm{erfc}(z) = 2 \\Phi(-z\\sqrt{2})$ 之间的关系，我们设 $z = \\sigma_E \\Delta\\beta / 2$：\n$$\np_{\\mathrm{acc}}(\\Delta\\beta, \\sigma_E) = \\mathrm{erfc}\\left(\\frac{\\sigma_E \\Delta\\beta}{2}\\right)\n$$\n这就是平均最近邻交换接受概率的最终表达式。\n\n**2. 往返时间 $\\tau_{\\mathrm{rt}}(M)$ 的标度分析**\n\n一个标记副本的温度指标 $i \\in \\{0, 1, \\dots, M-1\\}$ 在长度为 $L = M-1$ 的一维格子上进行随机游走。根据问题假设，此游走是无偏的，在两端（$i=0$ 和 $i=M-1$）有反射边界。REMC 模拟的一个周期对应于此随机游走的一个时间步。一次移动（一次成功的交换）以与 $p_{\\mathrm{acc}}$ 相关的概率发生。随机游走的扩散系数 $D$ 与单位时间的均方位移成正比。在一个周期中，位于指标 $i$ 的副本尝试与邻居交换，成功一步的概率是 $p_{\\mathrm{acc}}$。因此，在温度指标空间中的扩散系数标度为 $D \\propto p_{\\mathrm{acc}}$。\n\n问题给出了穿越长度为 $L$ 的区间的平均首次穿越时间的标度关系为 $\\tau_{\\mathrm{passage}} \\propto L^2/D$。一个副本的一次往返包括从最冷端（$i=0$）移动到最热端（$i=M-1$）再返回。其平均时间是两次平均首次穿越时间之和。\n$$\n\\tau_{\\mathrm{rt}} = \\tau_{0 \\to M-1} + \\tau_{M-1 \\to 0}\n$$\n当 $L=M-1$ 时，每次单程所需的时间与 $(M-1)^2/D$ 成正比。\n$$\n\\tau_{\\mathrm{rt}}(M) \\propto \\frac{(M-1)^2}{D} + \\frac{(M-1)^2}{D} \\propto \\frac{(M-1)^2}{D}\n$$\n代入扩散系数的标度关系 $D \\propto p_{\\mathrm{acc}}$，我们得到以模拟周期为单位的平均往返时间的标度关系：\n$$\n\\tau_{\\mathrm{rt}}(M) \\propto \\frac{(M-1)^2}{p_{\\mathrm{acc}}}\n$$\n\n**3. 计算成本函数 $W(M)$ 的推导**\n\n目标是在最冷副本上对一个可观测量达到固定的绝对统计误差。根据相关时间序列的中心极限定理，经过 $N_{\\mathrm{cycles}}$ 个周期的模拟后，样本均值的方差 $\\mathrm{Var}(\\bar{A})$ 与有效独立样本数 $N_{\\mathrm{eff}}$ 成反比：\n$$\n\\mathrm{Var}(\\bar{A}) \\propto \\frac{1}{N_{\\mathrm{eff}}}\n$$\n问题指出 $N_{\\mathrm{eff}} \\approx N_{\\mathrm{cycles}} / (2 \\tau_{\\mathrm{int}})$，其中 $\\tau_{\\mathrm{int}}$ 是以周期为单位的积分自相关时间。为了达到固定误差（即固定的 $\\mathrm{Var}(\\bar{A})$），我们需要固定数量的有效样本，即 $N_{\\mathrm{eff}} = \\mathrm{const}$。这意味着：\n$$\nN_{\\mathrm{cycles}} \\propto \\tau_{\\mathrm{int}}\n$$\n第三个建模假设指出，主导的相关尺度是温度往返时间，因此一次往返产生一个有效独立样本。这意味着 $\\tau_{\\mathrm{int}}$ 与 $\\tau_{\\mathrm{rt}}$ 成正比。\n$$\n\\tau_{\\mathrm{int}} \\propto \\tau_{\\mathrm{rt}}(M) \\propto \\frac{(M-1)^2}{p_{\\mathrm{acc}}(M)}\n$$\n因此，达到目标精度所需的周期数标度如下：\n$$\nN_{\\mathrm{cycles}} \\propto \\frac{(M-1)^2}{p_{\\mathrm{acc}}(M)}\n$$\n总计算功 $W(M)$ 是每个周期的功与总周期数的乘积。问题指明每个周期的成本与副本数 $M$ 成正比。\n$$\nW(M) = (\\text{每个周期的成本}) \\times N_{\\mathrm{cycles}} \\propto M \\cdot N_{\\mathrm{cycles}}\n$$\n结合这些结果，我们得到总功的最终标度关系：\n$$\nW(M) \\propto M \\cdot \\frac{(M-1)^2}{p_{\\mathrm{acc}}(M)}\n$$\n这证明了使用成本函数 $W(M) = k \\frac{M(M-1)^2}{p_{\\mathrm{acc}}(M)}$ 的合理性，其中 $k$ 是一个与 $M$ 无关的常数。为了最小化，这个常数可以忽略。接受概率 $p_{\\mathrm{acc}}(M)$ 通过温度间距 $\\Delta\\beta = \\frac{\\beta_{\\max} - \\beta_{\\min}}{M-1}$ 依赖于 $M$。\n$$\np_{\\mathrm{acc}}(M) = \\mathrm{erfc}\\left( \\frac{\\sigma_E (\\beta_{\\max} - \\beta_{\\min})}{2(M-1)} \\right)\n$$\n任务是找到在范围 $2 \\le M \\le M_{\\max}$ 内使此成本函数 $W(M)$ 最小化的整数 $M$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Solves the replica exchange optimization problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is (beta_min, beta_max, sigma_E, M_max)\n    test_cases = [\n        (0.5, 1.0, 10.0, 100),\n        (0.9, 1.0, 20.0, 100),\n        (0.1, 2.1, 30.0, 150),\n        (0.95, 0.96, 5.0, 50),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        beta_min, beta_max, sigma_E, M_max = case\n        \n        # We need to find the integer M in [2, M_max] that minimizes W(M).\n        min_cost = np.inf\n        opt_M = -1\n        \n        # M is the number of replicas, M >= 2.\n        M_range = range(2, M_max + 1)\n\n        for M in M_range:\n            M = float(M) # Use floats for calculation precision\n            \n            # 1. Calculate the acceptance probability p_acc(M)\n            # Delta beta = (beta_max - beta_min) / (M - 1)\n            delta_beta_range = beta_max - beta_min\n            m_minus_1 = M - 1.0\n            \n            # Argument for the complementary error function\n            # arg = (sigma_E * delta_beta) / 2\n            arg = (sigma_E * delta_beta_range) / (2.0 * m_minus_1)\n            \n            p_acc = erfc(arg)\n            \n            # 2. Calculate the cost function W(M)\n            # W(M) = M * (M - 1)^2 / p_acc\n            \n            # Handle the case where p_acc is zero to avoid division by zero.\n            # This corresponds to infinite cost as per the problem description.\n            if p_acc == 0.0:\n                cost = np.inf\n            else:\n                cost = M * (m_minus_1)**2 / p_acc\n\n            # 3. Check if this is the minimum cost found so far\n            if cost  min_cost:\n                min_cost = cost\n                opt_M = int(M)\n                \n        results.append([opt_M, min_cost])\n\n    # Format the final output string exactly as specified.\n    # e.g., [[M1,W1],[M2,W2],[M3,W3],[M4,W4]]\n    # No extra spaces.\n    string_results = [f\"[{m},{w}]\" for m, w in results]\n    final_output = f\"[{','.join(string_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2434293"}, {"introduction": "一旦副本交换模拟开始运行，我们需要一种方法来诊断其性能，即副本在不同温度之间混合的效率如何。一个直观且强大的度量标准是“平均往返时间” $\\tau_{\\mathrm{RT}}$，即一个标记的副本从最低温穿越到最高温再返回所需的平均步数。本练习通过将副本在温度阶梯上的运动抽象为生灭马尔可夫链，为您提供了一个计算此关键性能指标的严谨框架[@problem_id:2434329]。", "problem": "您的任务是形式化并实现一个用于副本交换蒙特卡洛 (Replica Exchange Monte Carlo, REMC) 的收敛判据。该判据基于一个标记副本从最低温度移动到最高温度再返回的平均往返时间。目标是利用温度阶梯上标记动力学的生灭马尔可夫链抽象模型，推导出一个有理论依据的估计量。\n\n考虑一个具有 $K$ 个离散温度 $\\{T_0, T_1, \\dots, T_{K-1}\\}$ 的温度阶梯，其排序方式为 $T_0 = T_{\\min}$ 和 $T_{K-1} = T_{\\max}$。对于 $i \\in \\{0,1,\\dots,K-2\\}$ 的相邻对 $\\left(T_i, T_{i+1}\\right)$ 允许进行副本交换，其 Metropolis–Hastings 接受概率在稳态条件下（为本问题之目的）被给定为一组常数 $\\{a_i\\}_{i=0}^{K-2}$，其中 $a_i \\in (0,1]$。您必须采用以下基本且可检验的建模假设：\n\n- 在每个离散时间步（时间单位是为被追踪的副本进行一次提议；所有时间答案必须表示为这些步骤的期望数量），位于索引 $i$ 的被追踪标记副本会从其有效邻居中均匀随机选择一个，提议与之交换。在内部索引 $i \\in \\{1,2,\\dots,K-2\\}$，以 1/2 的概率向上提议到 $i+1$，以 1/2 的概率向下提议到 $i-1$。在边界处，以概率 1 选择唯一的有效邻居。\n- 跨越连接 $i \\leftrightarrow i+1$ 的交换提议以概率 $a_i$ 被接受，否则被拒绝。如果交换被拒绝，标记将停留在其当前索引。这为标记在状态空间 $\\{0,1,\\dots,K-1\\}$ 上的运动定义了一个时间齐次的生灭马尔可夫链。\n\n定义标记索引过程的一步转移概率如下：\n- 对于内部索引 $i \\in \\{1,2,\\dots,K-2\\}$，令向上转移到 $i+1$ 的概率为 $p_i = \\frac{1}{2} a_i$，向下转移到 $i-1$ 的概率为 $q_i = \\frac{1}{2} a_{i-1}$。停留概率为 $r_i = 1 - p_i - q_i$。\n- 在下边界 $i = 0$，令 $p_0 = a_0$ 且 $q_0 = 0$。\n- 在上边界 $i = K-1$，令 $p_{K-1} = 0$ 且 $q_{K-1} = a_{K-2}$。\n\n对于此生灭马尔可夫链，将平均首达时间 $H(i \\to b)$ 定义为从索引 $i$ 出发到达目标索引 $b$ 所需的期望步数。平均往返时间为\n$$\n\\tau_{\\mathrm{RT}} = H\\!\\left(0 \\to K-1\\right) + H\\!\\left(K-1 \\to 0\\right),\n$$\n单位为步，其中一步等于为被追踪副本进行一次邻居提议。\n\n您的任务是：\n\n- 从马尔可夫链的定义和全期望定律出发，针对一个通用目标索引 $b \\in \\{0,1,\\dots,K-1\\}$，推导刻画 $H(i \\to b)$ 的线性系统，该系统以 $\\{p_i,q_i\\}$ 表示。\n- 对于给定的接受概率分布 $\\{a_i\\}$，使用此系统计算 $\\tau_{\\mathrm{RT}}$。\n- 基于 $\\tau_{\\mathrm{RT}}$ 提出一个收敛判据：给定用户指定的阈值 $\\theta  0$，当且仅当 $\\tau_{\\mathrm{RT}} \\le \\theta$ 时，宣布温度阶梯“已收敛”。从标记在阶梯上充分扩散的角度，定性地论证该判据的合理性。\n\n您必须实现一个完整的程序，该程序：\n- 不接受任何输入，并使用下面定义的固定测试套件。\n- 对每个测试用例，根据上述模型计算 $\\tau_{\\mathrm{RT}}$ 并评估收敛判据 $\\tau_{\\mathrm{RT}} \\le \\theta$，生成一个布尔结果。\n- 打印单行输出，其中包含按下列顺序列出的测试用例的布尔结果列表，格式为逗号分隔并用方括号括起。\n\n所有时间量都必须以步为单位表示，其中一步等于为被追踪副本进行一次邻居提议，如上文所定义。\n\n测试套件（每个用例是一个对 $(\\{a_i\\}_{i=0}^{K-2}, \\theta)$）：\n- 用例 1：$K = 8$，均匀接受概率 $a_i = 0.5$ (对于 $i \\in \\{0,1,\\dots,6\\}$)，且 $\\theta = 80.0$。\n- 用例 2：$K = 2$，$a_0 = 0.3$，且 $\\theta = 7.0$。\n- 用例 3：$K = 10$，除瓶颈 $a_4 = 0.05$ 外，所有 $i$ 的 $a_i = 0.5$，且 $\\theta = 500.0$。\n- 用例 4：$K = 5$，均匀接受概率 $a_i = 1.0$ (对于 $i \\in \\{0,1,2,3\\}$)，且 $\\theta = 10.0$。\n- 用例 5：$K = 6$，$a_0 = 0.01$, $a_1 = 0.8$, $a_2 = 0.8$, $a_3 = 0.8$, $a_4 = 0.8$，且 $\\theta = 200.0$。\n\n您的程序应生成单行输出，其中包含以逗号分隔并用方括号括起的列表形式的结果（例如，“[True,False,True,True,False]”）。", "solution": "该问题要求推导副本交换蒙特卡洛（REMC）模拟中副本平均往返时间的估计量，并将其用作收敛判据。副本在温度阶梯上的移动被建模为一个时间齐次的生灭马尔可夫链。\n\n**1. 平均首达时间方程的推导**\n\n设副本温度索引的状态空间为 $\\mathcal{S} = \\{0, 1, \\dots, K-1\\}$。该过程是一个离散时间马尔可夫链，具有给定的一步转移概率 $p_i$（向上到 $i+1$），$q_i$（向下到 $i-1$），以及 $r_i = 1 - p_i - q_i$（停留在 $i$）。\n\n设 $H(i \\to b)$ 为从状态 $i \\in \\mathcal{S}$ 出发，到达目标状态 $b \\in \\mathcal{S}$ 的平均首达时间（MFPT）。为简洁起见，我们记 $H_i = H(i \\to b)$。平均首达时间定义为首次到达状态 $b$ 所需的期望步数。根据定义，如果我们从目标状态出发，所需时间为零：\n$$\nH_b = 0\n$$\n对于任何起始状态 $i \\ne b$，我们可以通过以第一步的结果为条件，并使用全期望定律，建立关于 $H_i$ 的关系。经过一步（耗时 1 个单位时间），系统分别以概率 $p_i$、$q_i$ 和 $r_i$ 转移到状态 $i+1$、$i-1$ 或 $i$。从这些新状态到达 $b$ 的期望剩余时间分别为 $H_{i+1}$、$H_{i-1}$ 和 $H_i$。因此，对于 $i \\ne b$：\n$$\nH_i = 1 + p_i H_{i+1} + q_i H_{i-1} + r_i H_i\n$$\n代入 $r_i = 1 - p_i - q_i$ 并整理各项，我们得到：\n$$\nH_i = 1 + p_i H_{i+1} + q_i H_{i-1} + (1 - p_i - q_i) H_i\n$$\n$$\nH_i - (1 - p_i - q_i) H_i = 1 + p_i H_{i+1} + q_i H_{i-1}\n$$\n$$\n(p_i + q_i) H_i = 1 + p_i H_{i+1} + q_i H_{i-1}\n$$\n这可以写成一个刻画平均首达时间的线性方程组：\n$$\np_i (H_i - H_{i+1}) + q_i (H_i - H_{i-1}) = 1, \\quad \\text{for } i \\in \\mathcal{S} \\setminus \\{b\\}\n$$\n这个包含 $K-1$ 个线性方程的系统，连同边界条件 $H_b = 0$，唯一确定了 $\\{H_i\\}_{i \\in \\mathcal{S}}$ 的值。转移概率 $\\{p_i, q_i\\}$ 由问题中基于接受概率 $\\{a_i\\}$ 指定。\n\n**2. 平均往返时间 $\\tau_{\\mathrm{RT}}$ 的算法**\n\n平均往返时间定义为 $\\tau_{\\mathrm{RT}} = H(0 \\to K-1) + H(K-1 \\to 0)$。我们将分别求解每一项。\n\n**2.1. 平均上行时间：$H(0 \\to K-1)$**\n令 $H_i^{(up)} = H(i \\to K-1)$。目标状态为 $b=K-1$，所以 $H_{K-1}^{(up)}=0$。这些方程对 $i \\in \\{0, 1, \\dots, K-2\\}$ 成立。我们定义差值 $\\Delta_i^{(up)} = H_i^{(up)} - H_{i+1}^{(up)}$，对于 $i \\in \\{0, \\dots, K-2\\}$。\n通用方程是 $p_i(H_i^{(up)} - H_{i+1}^{(up)}) + q_i(H_i^{(up)} - H_{i-1}^{(up)}) = 1$。\n我们写 $H_{i-1}^{(up)} = H_i^{(up)} + \\Delta_{i-1}^{(up)}$。这样可以得到 $p_i \\Delta_i^{(up)} - q_i \\Delta_{i-1}^{(up)} = 1$。这导出了递推关系：\n$$\n\\Delta_i^{(up)} = \\frac{1 + q_i \\Delta_{i-1}^{(up)}}{p_i}, \\quad i \\in \\{1, \\dots, K-2\\}\n$$\n对于边界 $i=0$，方程 $p_0(H_0^{(up)} - H_1^{(up)}) = 1$ 给出 $\\Delta_0^{(up)} = 1/p_0$。\n总时间 $H(0 \\to K-1)$ 通过求和得到：\n$$\nH(0 \\to K-1) = H_0^{(up)} = H_0^{(up)} - H_{K-1}^{(up)} = \\sum_{j=0}^{K-2} (H_j^{(up)} - H_{j+1}^{(up)}) = \\sum_{j=0}^{K-2} \\Delta_j^{(up)}\n$$\n\n**2.2. 平均下行时间：$H(K-1 \\to 0)$**\n令 $H_i^{(down)} = H(i \\to 0)$。目标是 $b=0$，所以 $H_0^{(down)}=0$。这些方程对 $i \\in \\{1, \\dots, K-1\\}$ 成立。令 $\\nabla_i^{(down)} = H_{i+1}^{(down)} - H_i^{(down)}$。\n通用方程是 $p_i(H_i^{(down)} - H_{i+1}^{(down)}) + q_i(H_i^{(down)} - H_{i-1}^{(down)}) = 1$。\n这可以写成 $-p_i \\nabla_i^{(down)} + q_i \\nabla_{i-1}^{(down)} = 1$。这产生一个在索引上反向的递推关系：\n$$\n\\nabla_{i-1}^{(down)} = \\frac{1 + p_i \\nabla_i^{(down)}}{q_i}, \\quad i \\in \\{1, \\dots, K-2\\}\n$$\n对于边界 $i=K-1$，方程 $q_{K-1}(H_{K-1}^{(down)} - H_{K-2}^{(down)}) = 1$ 给出 $\\nabla_{K-2}^{(down)} = 1/q_{K-1}$。\n总时间 $H(K-1 \\to 0)$ 通过求和得到：\n$$\nH(K-1 \\to 0) = H_{K-1}^{(down)} = H_{K-1}^{(down)} - H_0^{(down)} = \\sum_{j=0}^{K-2} (H_{j+1}^{(down)} - H_j^{(down)}) = \\sum_{j=0}^{K-2} \\nabla_j^{(down)}\n$$\n\n**3. 收敛判据的合理性论证**\n\n声明 REMC 温度阶梯“已收敛”的判据是 $\\tau_{\\mathrm{RT}} \\le \\theta$，其中 $\\theta$ 是用户定义的阈值。这是关于温度阶梯*效率*的判据，而阶梯效率是模拟本身要收敛到稳态分布的一个必要条件。\n\nREMC 的有效性依赖于副本在整个温度阶梯上的快速扩散。一个在低温（$T_{low}$）下探索崎岖能量景观的副本可能会陷入局部能量极小值。通过与高温（$T_{high}$）下的副本交换构型，它可以克服能量壁垒，从而更广泛地探索构型空间。随后，它可能扩散回低温状态，并有可能稳定在一个更优（能量更低）的极小值中。\n\n平均往返时间 $\\tau_{\\mathrm{RT}}$ 是这一扩散过程的特征时间尺度。它衡量了一个副本从最低温移动到最高温再返回所需的期望交换提议次数。\n- **小的 $\\tau_{\\mathrm{RT}}$** 表示副本在所有温度之间自由移动。这意味着温度间距是合适的，接受概率 $\\{a_i\\}$ 足够高，并且没有明显的瓶颈。在阶梯上的良好扩散确保系统在所有相关温度下都能有效地对构型空间进行采样，这是 REMC 的主要目标。\n- **大的 $\\tau_{\\mathrm{RT}}$** 表明混合不佳。一个或多个低的接受概率充当了瓶颈，将副本困在特定的温度区域。这严重阻碍了采样效率，并减慢了热力学可观测量估计值的收敛速度。\n\n因此，要求 $\\tau_{\\mathrm{RT}}$ 低于一个阈值 $\\theta$ 是一个有理论依据的方法，用以确保温度阶梯被良好地设计以实现高效采样。如果一个模拟的总运行时间是可接受的小 $\\tau_{\\mathrm{RT}}$ 值的大倍数，那么我们可以相信副本已经完成了许多次往返，从而对状态空间进行了彻底的探索，并得到了可靠的统计平均值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the mean round-trip time in a replica exchange simulation\n    and evaluates a convergence criterion for a series of test cases.\n    \"\"\"\n\n    def calculate_tau_rt(K, a_vec):\n        \"\"\"\n        Calculates the mean round-trip time (tau_RT) for a replica.\n\n        Args:\n            K (int): The number of temperature levels.\n            a_vec (list or np.ndarray): A list of acceptance probabilities \n                                        {a_i} for i = 0 to K-2.\n\n        Returns:\n            float: The mean round-trip time tau_RT.\n        \"\"\"\n        if K  2:\n            return 0.0\n\n        # For K=2, the system is simple. tau_RT = 1/a_0 + 1/a_0 = 2/a_0.\n        # The general algorithm below also correctly handles this case.\n        if K == 2:\n            return 2.0 / a_vec[0]\n\n        # Define transition probabilities p_i (up) and q_i (down)\n        # p[i] = P(i -> i+1), q[i] = P(i -> i-1)\n        p = np.zeros(K)\n        q = np.zeros(K)\n\n        # Boundary at i=0\n        p[0] = a_vec[0]\n        \n        # Boundary at i=K-1\n        q[K - 1] = a_vec[K - 2]\n        \n        # Interior indices\n        for i in range(1, K - 1):\n            p[i] = a_vec[i] / 2.0\n            q[i] = a_vec[i - 1] / 2.0\n\n        # 1. Calculate Mean Up-Trip Time: H(0 -> K-1)\n        # delta_up[i] = H_i^(up) - H_{i+1}^(up)\n        delta_up = np.zeros(K - 1)\n        \n        # Recurrence relation: delta_up[i] = (1 + q[i]*delta_up[i-1]) / p[i]\n        delta_up[0] = 1.0 / p[0]\n        for i in range(1, K - 1):\n            delta_up[i] = (1.0 + q[i] * delta_up[i - 1]) / p[i]\n        \n        h_up = np.sum(delta_up)\n\n        # 2. Calculate Mean Down-Trip Time: H(K-1 -> 0)\n        # nabla_down[i] = H_{i+1}^(down) - H_i^(down)\n        nabla_down = np.zeros(K - 1)\n\n        # Recurrence relation: nabla_down[i-1] = (1 + p[i]*nabla_down[i]) / q[i]\n        nabla_down[K - 2] = 1.0 / q[K - 1]\n        for i in range(K - 2, 0, -1):\n            nabla_down[i - 1] = (1.0 + p[i] * nabla_down[i]) / q[i]\n        \n        h_down = np.sum(nabla_down)\n        \n        tau_rt = h_up + h_down\n        return tau_rt\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: K=8, uniform a_i=0.5, theta=80.0\n        ({'a_vec': [0.5] * 7, 'K': 8}, 80.0),\n        \n        # Case 2: K=2, a_0=0.3, theta=7.0\n        ({'a_vec': [0.3], 'K': 2}, 7.0),\n        \n        # Case 3: K=10, a_i=0.5 except a_4=0.05, theta=500.0\n        ({'a_vec': [0.5, 0.5, 0.5, 0.5, 0.05, 0.5, 0.5, 0.5, 0.5], 'K': 10}, 500.0),\n        \n        # Case 4: K=5, uniform a_i=1.0, theta=10.0\n        ({'a_vec': [1.0] * 4, 'K': 5}, 10.0),\n        \n        # Case 5: K=6, a_0=0.01, others 0.8, theta=200.0\n        ({'a_vec': [0.01, 0.8, 0.8, 0.8, 0.8], 'K': 6}, 200.0),\n    ]\n\n    results = []\n    for case_params, theta in test_cases:\n        tau_rt = calculate_tau_rt(case_params['K'], case_params['a_vec'])\n        converged = tau_rt = theta\n        results.append(converged)\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2434329"}, {"introduction": "掌握一种方法的局限性与学会如何使用它同等重要。本练习设计了一个思想实验，探讨一种假设的、能量势垒高度 $U_B(T)$ 依赖于温度的系统，在这种系统中副本交换方法的效率会显著降低。通过分析这个特定的失败案例，我们将更深刻地理解副本交换方法有效性的物理前提，即为何在通常情况下高温能帮助系统逾越能垒[@problem_id:2434355]。", "problem": "一个一维系统由一个显式依赖于温度的有效势能建模，该模型旨在用于哈密顿量副本交换蒙特卡洛（REMC）方法。请您研究这种特殊的温度依赖性如何削弱副本交换的效率。考虑以下势函数族\n$$\nU(x;T) \\equiv \\frac{U_{0}}{T}\\left(1-\\frac{x^{2}}{L^{2}}\\right)^{2},\n$$\n其中 $U_{0}0$ 和 $L0$ 为常数，$T$ 表示热力学温度。\n\n任务：\n- 验证在 $x=0$ 处的势垒高度等于 $U_{B}(T)=U_{0}/T$，而在 $x=\\pm L$ 处的两个极小值点能量为零。\n- 考虑两个分别处于温度 $T_{1}$ 和 $T_{2}$（其中 $T_{1}T_{2}$）的副本。一对构型 $(x_{1},x_{2})$ 的联合目标分布是正则的，$\\pi(x_{1},x_{2})\\propto \\exp\\!\\big(-\\beta_{1}U(x_{1};T_{1})\\big)\\exp\\!\\big(-\\beta_{2}U(x_{2};T_{2})\\big)$，其中 $\\beta_{i}\\equiv 1/(k_{B}T_{i})$，$k_{B}$ 为 Boltzmann 常数。一个副本交换移动提议交换构型，即 $(x_{1},x_{2})\\mapsto (x_{2},x_{1})$，并以根据对此联合目标的细致平衡条件推导出的常规 Metropolis–Hastings 概率被接受。\n- 计算当处于较低温度 $T_{1}$ 的副本位于势阱底部（$x_{1}=L$）且处于较高温度 $T_{2}$ 的副本位于势垒顶部（$x_{2}=0$）时，交换接受概率的精确符号表达式。您的答案仅需用 $U_{0}$、$k_{B}$、$T_{1}$ 和 $T_{2}$ 表示。\n\n最后，请使用 Boltzmann 因子和您所推导的接受率的第一性原理，简要解释为何副本交换方法对此系统效率低下，重点关注约化势垒 $U_{B}(T)/(k_{B}T)$ 是如何随温度 $T$ 变化的。您的最终答案必须是所述接受概率的单一闭式解析表达式。最终答案中请勿包含任何单位。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 势能函数：$U(x;T) \\equiv \\frac{U_{0}}{T}\\left(1-\\frac{x^{2}}{L^{2}}\\right)^{2}$。\n- 常数：$U_{0}0$ 且 $L0$。\n- 温度：$T_{1}$ 和 $T_{2}$，其中 $T_{1}T_{2}$。\n- 逆温度定义：$\\beta_{i}\\equiv 1/(k_{B}T_{i})$。\n- 联合概率分布：$\\pi(x_{1},x_{2})\\propto \\exp\\!\\big(-\\beta_{1}U(x_{1};T_{1})\\big)\\exp\\!\\big(-\\beta_{2}U(x_{2};T_{2})\\big)$。\n- 提议移动：构型交换，$(x_{1},x_{2})\\mapsto (x_{2},x_{1})$。\n- 用于交换的特定构型：处于温度为 $T_{1}$ 的副本位于 $x_{1}=L$，处于温度为 $T_{2}$ 的副本位于 $x_{2}=0$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题作为一个计算统计力学中的理论练习，具有科学依据。它研究了副本交换蒙特卡洛（REMC）算法在一个定义明确但非常规的模型势上的行为。该势能对温度的显式依赖性是一个旨在探究算法局限性的特征，而非一个物理错误。该问题是自洽的，提供了所有必要的数学定义。任务设定合理，可导出一个唯一的解。语言客观而精确。因此，该问题被认为是有效的。\n\n步骤3：结论与行动。\n问题有效。将提供完整解答。\n\n首先，我们验证势 $U(x;T)$ 的性质。势的极值点可以通过将其对 $x$ 的导数设为零来找到。\n$$\n\\frac{d U(x;T)}{dx} = \\frac{d}{dx}\\left[\\frac{U_{0}}{T}\\left(1-\\frac{x^{2}}{L^{2}}\\right)^{2}\\right] = \\frac{U_{0}}{T} \\cdot 2\\left(1-\\frac{x^{2}}{L^{2}}\\right) \\cdot \\left(-\\frac{2x}{L^{2}}\\right) = -\\frac{4U_{0}x}{TL^{2}}\\left(1-\\frac{x^{2}}{L^{2}}\\right)\n$$\n令 $\\frac{dU}{dx}=0$ 可得解 $x=0$ 和 $1-\\frac{x^{2}}{L^{2}}=0$，即 $x=\\pm L$。\n我们计算在这些极值点上的势能：\n- 在 $x=0$ 处，势能为 $U(0;T) = \\frac{U_{0}}{T}\\left(1-\\frac{0^{2}}{L^{2}}\\right)^{2} = \\frac{U_{0}}{T}$。这对应于一个局部极大值，即能量势垒，因此势垒高度为 $U_{B}(T) = U_{0}/T$。\n- 在 $x=\\pm L$ 处，势能为 $U(\\pm L;T) = \\frac{U_{0}}{T}\\left(1-\\frac{(\\pm L)^{2}}{L^{2}}\\right)^{2} = \\frac{U_{0}}{T}\\left(1-1\\right)^{2} = 0$。这两个是能量为零的极小值点。\n由此，初步验证得到证实。\n\n接下来，我们计算交换接受概率。副本交换方法提议在副本1（温度为 $T_{1}$）和副本2（温度为 $T_{2}$）之间交换构型 $x_{1}$ 和 $x_{2}$。接受概率由 Metropolis-Hastings 判据给出。\n组合系统的初始状态是 $A = (x_{1}, x_{2})$。Boltzmann 因子指数中相关的项是 $H_{A} = \\beta_{1}U(x_{1};T_{1}) + \\beta_{2}U(x_{2};T_{2})$。\n交换构型后的提议状态是 $B = (x_{2}, x_{1})$。相应的指数项是 $H_{B} = \\beta_{1}U(x_{2};T_{1}) + \\beta_{2}U(x_{1};T_{2})$。关键要注意，势函数 $U$ 在新构型下进行计算，但使用的是各自副本的温度。\n接受概率为 $P_{\\text{acc}} = \\min(1, \\exp(-\\Delta H))$，其中 $\\Delta H = H_{B} - H_{A}$。\n$$\n\\Delta H = \\left[ \\beta_{1}U(x_{2};T_{1}) + \\beta_{2}U(x_{1};T_{2}) \\right] - \\left[ \\beta_{1}U(x_{1};T_{1}) + \\beta_{2}U(x_{2};T_{2}) \\right]\n$$\n给定特定构型：对于温度为 $T_{1}$ 的副本，$x_{1}=L$；对于温度为 $T_{2}$ 的副本，$x_{2}=0$。我们计算四个必要的势能项：\n1. $U(x_{1};T_{1}) = U(L;T_{1}) = 0$。\n2. $U(x_{2};T_{2}) = U(0;T_{2}) = \\frac{U_{0}}{T_{2}}$。\n3. $U(x_{2};T_{1}) = U(0;T_{1}) = \\frac{U_{0}}{T_{1}}$。\n4. $U(x_{1};T_{2}) = U(L;T_{2}) = 0$。\n\n将这些值代入 $\\Delta H$ 的表达式中：\n$$\n\\Delta H = \\left[ \\beta_{1}\\left(\\frac{U_{0}}{T_{1}}\\right) + \\beta_{2}(0) \\right] - \\left[ \\beta_{1}(0) + \\beta_{2}\\left(\\frac{U_{0}}{T_{2}}\\right) \\right]\n$$\n使用定义 $\\beta_{i}=1/(k_{B}T_{i})$：\n$$\n\\Delta H = \\frac{1}{k_{B}T_{1}}\\frac{U_{0}}{T_{1}} - \\frac{1}{k_{B}T_{2}}\\frac{U_{0}}{T_{2}} = \\frac{U_{0}}{k_{B}T_{1}^{2}} - \\frac{U_{0}}{k_{B}T_{2}^{2}} = \\frac{U_{0}}{k_{B}}\\left(\\frac{1}{T_{1}^{2}} - \\frac{1}{T_{2}^{2}}\\right)\n$$\n因为 $T_{1}T_{2}$，所以有 $T_{1}^{2}T_{2}^{2}$ 且 $\\frac{1}{T_{1}^{2}}  \\frac{1}{T_{2}^{2}}$。又因为 $U_{0}0$ 和 $k_{B}0$，所以 $\\Delta H  0$。\n因此，$\\exp(-\\Delta H)  1$，接受概率为：\n$$\nP_{\\text{acc}} = \\exp(-\\Delta H) = \\exp\\left[-\\frac{U_{0}}{k_{B}}\\left(\\frac{1}{T_{1}^{2}} - \\frac{1}{T_{2}^{2}}\\right)\\right]\n$$\n这即是所要求的符号表达式。\n\n最后，我们解释副本交换对此系统效率低下的原因。REMC的效率取决于两个因素：高温副本跨越能垒的能力，以及相邻副本的能量分布之间存在足够的重叠以允许交换。\n\n在温度 $T$ 下，控制越过势垒的关键物理量是约化势垒高度，即以热能 $k_{B}T$ 为单位的势垒高度 $U_{B}(T)$。对于本系统，势垒高度为 $U_{B}(T) = U_{0}/T$。那么约化势垒为：\n$$\n\\frac{U_{B}(T)}{k_{B}T} = \\frac{U_{0}/T}{k_{B}T} = \\frac{U_{0}}{k_{B}T^{2}}\n$$\n随着温度 $T$ 的降低，这个约化势垒高度以 $1/T^{2}$ 的方式增加。这是一个灾难性的标度关系。在一个具有与温度无关的势垒 $U_{B}$ 的典型系统中，约化势垒高度以 $1/T$ 的方式变化，这已经导致了低温下非常缓慢的动力学（Arrhenius 定律）。在这里，动力学的冻结要严重得多。随着温度的降低，势阱相对于热能变得异常深，从而比在标准系统中更有效地捕获低温副本。\n\n第二个问题是交换接受概率。如前所导，接受概率中的指数项正比于 $\\frac{1}{T_{1}^{2}} - \\frac{1}{T_{2}^{2}}$。为了在相邻温度 $T_{1}$ 和 $T_{2} = T_{1} + \\Delta T$ 之间保持合理的接受率，该指数的量级必须为1。对于微小的 $\\Delta T$，我们可以近似：\n$$\n\\frac{1}{T_{1}^{2}} - \\frac{1}{(T_{1}+\\Delta T)^{2}} = T_{1}^{-2}\\left(1 - \\left(1+\\frac{\\Delta T}{T_{1}}\\right)^{-2}\\right) \\approx T_{1}^{-2}\\left(1 - \\left(1-2\\frac{\\Delta T}{T_{1}}\\right)\\right) = \\frac{2\\Delta T}{T_{1}^{3}}\n$$\n因此，指数项的参数变为 $-\\frac{2U_{0}\\Delta T}{k_{B}T_{1}^{3}}$。为了使该值量级为1，温度间隔必须满足 $\\Delta T \\propto T_{1}^{3}$。这意味着当接近低温时，副本必须排列得越来越密集。跨越从低温 $T_{\\text{min}}$ 到高温 $T_{\\text{max}}$ 的范围所需的副本数量 $N_{R}$ 的标度关系为 $\\int_{T_{\\text{min}}}^{T_{\\text{max}}} \\frac{dT}{\\Delta T(T)} \\propto \\int_{T_{\\text{min}}}^{T_{\\text{max}}} \\frac{dT}{T^{3}} \\propto \\left[\\frac{-1}{2T^{2}}\\right]_{T_{\\text{min}}}^{T_{\\text{max}}} \\propto \\frac{1}{T_{\\text{min}}^{2}}$。当 $T_{\\text{min}} \\to 0$ 时，所需副本数量的这种二次发散使得该算法在探索低温状态时效率极低，在计算上是不可行的。\n总而言之，势能对温度的显式依赖性导致约化势垒能量以 $1/T^{2}$ 的形式发散，这既导致了低温下的严重捕获，也导致需要不可行的大量副本以确保交换，从而使得该方法效率低下。", "answer": "$$\\boxed{\\exp\\left(-\\frac{U_{0}}{k_{B}}\\left(\\frac{1}{T_{1}^{2}} - \\frac{1}{T_{2}^{2}}\\right)\\right)}$$", "id": "2434355"}]}