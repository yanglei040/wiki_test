{"hands_on_practices": [{"introduction": "有限元方法的核心是将连续的物理问题（如由积分描述的系统）转化为离散的代数方程组（即矩阵）。这个练习将引导你完成一个基本但至关重要的任务：利用形函数从其积分定义中推导出一维线性单元的质量矩阵 [@problem_id:2172585]。掌握这一过程是理解有限元如何将物理定律（例如惯性效应）转化为可计算矩阵形式的基础，为求解动态问题铺平了道路。", "problem": "在进行振动结构的有限元分析时，单元的惯性由一个质量矩阵表示。考虑一个用于模拟一段均匀杆的一维双节点线性单元。该单元的长度为 $h_e$，具有恒定的质量密度 $\\rho$ 和均匀的横截面积 $A$。\n\n定义一个局部坐标系，使得该单元占据区域 $x \\in [0, h_e]$，其中节点1位于 $x=0$，节点2位于 $x=h_e$。单元内的轴向位移场由节点位移通过线性函数 $N_1(x) = 1 - \\frac{x}{h_e}$ 和 $N_2(x) = \\frac{x}{h_e}$ 插值得到。\n\n$2 \\times 2$ 单元质量矩阵 $\\mathbf{M}$ 的元素 $M_{ij}$ (其中 $i, j \\in \\{1, 2\\}$) 由以下沿单元长度的积分确定：\n$$\nM_{ij} = \\int_{0}^{h_e} \\rho A N_i(x) N_j(x) dx\n$$\n计算单元质量矩阵 $\\mathbf{M}$。你的答案应该是一个用 $\\rho$、$A$ 和 $h_e$ 表示的 $2 \\times 2$ 矩阵。", "solution": "我们使用一维单元的一致质量矩阵定义：\n$$\nM_{ij}=\\int_{0}^{h_{e}}\\rho A\\,N_{i}(x)N_{j}(x)\\,dx,\\quad i,j\\in\\{1,2\\},\n$$\n其中在 $x\\in[0,h_{e}]$ 上的线性形函数为 $N_{1}(x)=1-\\frac{x}{h_{e}}$ 和 $N_{2}(x)=\\frac{x}{h_{e}}$。\n\n计算每个元素：\n对于 $M_{11}$，\n$$\nM_{11}=\\int_{0}^{h_{e}}\\rho A\\left(1-\\frac{x}{h_{e}}\\right)^{2}dx\n=\\rho A\\int_{0}^{h_{e}}\\left(1-\\frac{2x}{h_{e}}+\\frac{x^{2}}{h_{e}^{2}}\\right)dx.\n$$\n逐项积分，\n$$\nM_{11}=\\rho A\\left[x-\\frac{x^{2}}{h_{e}}+\\frac{x^{3}}{3h_{e}^{2}}\\right]_{0}^{h_{e}}\n=\\rho A\\left(h_{e}-h_{e}+\\frac{h_{e}}{3}\\right)\n=\\rho A\\frac{h_{e}}{3}.\n$$\n\n对于 $M_{12}$，\n$$\nM_{12}=\\int_{0}^{h_{e}}\\rho A\\left(1-\\frac{x}{h_{e}}\\right)\\left(\\frac{x}{h_{e}}\\right)dx\n=\\rho A\\int_{0}^{h_{e}}\\left(\\frac{x}{h_{e}}-\\frac{x^{2}}{h_{e}^{2}}\\right)dx.\n$$\n积分得，\n$$\nM_{12}=\\rho A\\left[\\frac{x^{2}}{2h_{e}}-\\frac{x^{3}}{3h_{e}^{2}}\\right]_{0}^{h_{e}}\n=\\rho A\\left(\\frac{h_{e}}{2}-\\frac{h_{e}}{3}\\right)\n=\\rho A\\frac{h_{e}}{6}.\n$$\n\n根据对称性，$M_{21}=M_{12}=\\rho A\\frac{h_{e}}{6}$，类似地\n$$\nM_{22}=\\int_{0}^{h_{e}}\\rho A\\left(\\frac{x}{h_{e}}\\right)^{2}dx\n=\\rho A\\int_{0}^{h_{e}}\\frac{x^{2}}{h_{e}^{2}}dx\n=\\rho A\\frac{1}{h_{e}^{2}}\\left[\\frac{x^{3}}{3}\\right]_{0}^{h_{e}}\n=\\rho A\\frac{h_{e}}{3}.\n$$\n\n将各元素组合起来得到\n$$\n\\mathbf{M}=\n\\begin{pmatrix}\n\\rho A\\frac{h_{e}}{3} & \\rho A\\frac{h_{e}}{6} \\\\\n\\rho A\\frac{h_{e}}{6} & \\rho A\\frac{h_{e}}{3}\n\\end{pmatrix}\n=\\frac{\\rho A h_{e}}{6}\n\\begin{pmatrix}\n2 & 1 \\\\\n1 & 2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\frac{\\rho A h_{e}}{6}\\begin{pmatrix}2 & 1 \\\\ 1 & 2\\end{pmatrix}}$$", "id": "2172585"}, {"introduction": "在计算出各个单元的局部矩阵之后，下一步关键步骤便是将它们“组装”成一个能代表整个问题域的全局系统。本练习通过一个节点和单元编号被故意打乱的场景，考验你对组装过程核心逻辑的理解 [@problem_id:2393853]。这种将局部贡献精确映射到全局系统正确位置的能力，不仅是有限元编程的基石，也是深刻理解有限元方法如何从局部构建整体的关键。", "problem": "考虑一个导热系数 $k$ 和横截面积 $A$ 均为常数的直棱柱形杆上的稳态一维热传导问题。杆内无内部热源。使用带有线性拉格朗日形函数的标准伽辽金有限元法将该杆离散为4个单元和5个全局节点。全局节点标识符及其沿杆的位置如下：\n- 节点 $42$：$x=0.00 \\ \\mathrm{m}$\n- 节点 $7$：$x=0.35 \\ \\mathrm{m}$\n- 节点 $13$：$x=0.50 \\ \\mathrm{m}$\n- 节点 $5$：$x=0.90 \\ \\mathrm{m}$\n- 节点 $21$：$x=1.20 \\ \\mathrm{m}$\n\n单元连接关系被故意打乱，并由以下双节点单元列表（第一个节点，第二个节点）给出：\n- 单元 $17$：$(42,7)$\n- 单元 $100$：$(13,7)$\n- 单元 $9$：$(13,5)$\n- 单元 $23$：$(21,5)$\n\n组装无约束系统（即施加任何边界条件之前）的全局刚度矩阵。全局刚度矩阵的行和列需按照节点标识符序列 $(5, \\ 42, \\ 13, \\ 21, \\ 7)$ 进行排序。\n\n材料和几何属性如下：\n- 导热系数 $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$\n- 横截面积 $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$\n\n组装后的全局刚度矩阵中，与全局节点标识符 $13$ 相关联的对角线元素的值是多少？以 $\\mathrm{W \\, K^{-1}}$ 为单位表示您的答案，并将其四舍五入至4位有效数字。", "solution": "对于一个导热系数 $k$ 和横截面积 $A$ 为常数、无内部热源的棱柱形杆，其稳态一维热传导的控制微分方程为\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k A \\, \\frac{\\mathrm{d}T}{\\mathrm{d}x}\\right) \\,=\\, 0.\n$$\n对于长度为 $L_{e}$ 的双节点单元，使用带有线性拉格朗日形函数的标准伽辽金有限元法可得到单元刚度矩阵\n$$\n\\mathbf{K}^{(e)} \\,=\\, \\int_{0}^{L_{e}} k A \\, \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right)^{\\!\\top} \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right) \\, \\mathrm{d}x,\n$$\n其中 $\\mathbf{N} = \\begin{bmatrix} N_{1} & N_{2} \\end{bmatrix}$ 是线性形函数。对于一个线性双节点单元，其导数在单元上是常数，$\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}x} = -\\frac{1}{L_{e}}$ 且 $\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}x} = \\frac{1}{L_{e}}$，因此\n$$\n\\mathbf{K}^{(e)} \\,=\\, k A \\int_{0}^{L_{e}} \n\\begin{bmatrix}\n\\frac{1}{L_{e}^{2}} & -\\frac{1}{L_{e}^{2}} \\\\\n-\\frac{1}{L_{e}^{2}} & \\frac{1}{L_{e}^{2}}\n\\end{bmatrix}\n\\mathrm{d}x\n\\,=\\, \\frac{k A}{L_{e}} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}.\n$$\n\n因此，每个单元对其两个节点关联的对角线元素贡献 $\\frac{k A}{L_{e}}$，并对相应的非对角线耦合项贡献 $-\\frac{k A}{L_{e}}$。全局刚度矩阵中与某一特定全局节点相关联的对角线元素，是所有连接到该节点的单元的对角线贡献之和。\n\n我们首先根据给定的节点坐标计算单元长度：\n- 单元 $17$ 连接 $x=0.00 \\ \\mathrm{m}$ 处的节点 $42$ 和 $x=0.35 \\ \\mathrm{m}$ 处的节点 $7$，所以 $L_{17} = |0.35 - 0.00| = 0.35 \\ \\mathrm{m}$。\n- 单元 $100$ 连接 $x=0.50 \\ \\mathrm{m}$ 处的节点 $13$ 和 $x=0.35 \\ \\mathrm{m}$ 处的节点 $7$，所以 $L_{100} = |0.50 - 0.35| = 0.15 \\ \\mathrm{m}$。\n- 单元 $9$ 连接 $x=0.50 \\ \\mathrm{m}$ 处的节点 $13$ 和 $x=0.90 \\ \\mathrm{m}$ 处的节点 $5$，所以 $L_{9} = |0.90 - 0.50| = 0.40 \\ \\mathrm{m}$。\n- 单元 $23$ 连接 $x=1.20 \\ \\mathrm{m}$ 处的节点 $21$ 和 $x=0.90 \\ \\mathrm{m}$ 处的节点 $5$，所以 $L_{23} = |1.20 - 0.90| = 0.30 \\ \\mathrm{m}$。\n\n全局节点 $13$ 连接到单元 $100$ 和 $9$。因此，与节点 $13$ 相关联的全局刚度矩阵的对角线元素为\n$$\nK_{(13,13)} \\,=\\, \\frac{k A}{L_{100}} \\,+\\, \\frac{k A}{L_{9}}.\n$$\n\n代入给定的材料和几何属性 $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$ 和 $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$：\n$$\nk A \\,=\\, 180 \\times \\left(2.0 \\times 10^{-3}\\right) \\,=\\, 0.36 \\ \\mathrm{W \\cdot m \\cdot K^{-1}}.\n$$\n因此，\n$$\nK_{(13,13)} \\,=\\, 0.36\\left(\\frac{1}{0.15} + \\frac{1}{0.40}\\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\n计算长度的倒数：\n$$\n\\frac{1}{0.15} \\,=\\, \\frac{100}{15} \\,=\\, \\frac{20}{3} \\,=\\, 6.\\overline{6}, \n\\qquad\n\\frac{1}{0.40} \\,=\\, \\frac{10}{4} \\,=\\, \\frac{5}{2} \\,=\\, 2.5.\n$$\n因此，\n$$\nK_{(13,13)} \\,=\\, 0.36\\left( \\frac{20}{3} + \\frac{5}{2} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36\\left( \\frac{40}{6} + \\frac{15}{6} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36\\left( \\frac{55}{6} \\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\n进行乘法运算：\n$$\n0.36\\left( \\frac{55}{6} \\right)\n\\,=\\, 0.06 \\times 55\n\\,=\\, 3.3.\n$$\n\n因此，与全局节点 $13$ 相关联的对角线元素为\n$$\nK_{(13,13)} \\,=\\, 3.3 \\ \\mathrm{W \\, K^{-1}}.\n$$\n按要求四舍五入至4位有效数字，得到 $3.300 \\ \\mathrm{W \\, K^{-1}}$。", "answer": "$$\\boxed{3.300}$$", "id": "2393853"}, {"introduction": "在处理复杂几何时，有限元法使用“等参数映射”将规则的参考单元（如正方形）映射到物理空间中的任意形状（如扭曲的四边形）。然而，这种映射必须保持有效性，否则计算结果将毫无意义。本练习通过分析节点位置如何影响映射的雅可比行列式，让你亲手探究单元从有效（凸）变为无效（凹）的临界条件 [@problem_id:2172610]。这有助于你从根本上理解网格质量的重要性以及它背后的数学原理。", "problem": "一个四节点等参四边形单元被用于将一个由 $-1 \\le \\xi \\le 1$ 和 $-1 \\le \\eta \\le 1$ 定义的方形母域映射到 $xy$ 平面内的一个物理域。物理单元的节点按逆时针方向编号，其坐标如下：\n*   节点1：$(x_1, y_1) = (0, 0)$，对应 $(\\xi, \\eta) = (-1, -1)$\n*   节点2：$(x_2, y_2) = (4, 0)$，对应 $(\\xi, \\eta) = (1, -1)$\n*   节点3：$(x_3, y_3) = (4, 4)$，对应 $(\\xi, \\eta) = (1, 1)$\n*   节点4：$(x_4, y_4)$，对应 $(\\xi, \\eta) = (-1, 1)$\n\n节点4的位置是可变的。一个有效的映射要求四边形是凸的，这是一个条件，即变换的雅可比行列式在整个单元内保持为正。随着节点4位置的改变，该四边形可以从凸形过渡到非凸（凹）形。这个过渡发生在节点4位于由其他三个节点决定的某条特定直线上时。\n\n确定这条边界线的方程，其形式为 $A x_4 + B y_4 + C = 0$。请以整数系数的行矩阵 $[A, B, C]$ 的形式给出你的答案，其中整数 $A, B, C$ 互质（它们的最大公约数为1），且第一个非零系数为正。", "solution": "对于一个四节点双线性等参四边形，从 $(\\xi,\\eta)$ 到 $(x,y)$ 的映射由下式给出：\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\quad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\n其中形函数为\n$$\nN_{1}=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}=\\frac{(1-\\xi)(1+\\eta)}{4}.\n$$\n雅可比行列式为\n$$\nJ(\\xi,\\eta)=\\det\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta}\\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\n且对于给定的逆时针节点编号，凸性要求 $J(\\xi,\\eta)>0$ 在整个 $[-1,1]^{2}$ 区域内成立。从凸到非凸的过渡发生在 $J$ 在域中某处首次变为零时；对于双线性映射，一个必要的边界条件是 $J$ 在某个角点处为零。\n\n使用 $x_{1}=0$, $y_{1}=0$, $x_{2}=4$, $y_{2}=0$, $x_{3}=4$, $y_{3}=4$ 以及未知的 $(x_{4},y_{4})$ 来计算导数：\n$$\n\\frac{\\partial x}{\\partial \\xi}=x_{2}\\frac{\\partial N_{2}}{\\partial \\xi}+x_{3}\\frac{\\partial N_{3}}{\\partial \\xi}+x_{4}\\frac{\\partial N_{4}}{\\partial \\xi}\n=2-\\frac{x_{4}}{4}(1+\\eta),\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}=y_{3}\\frac{\\partial N_{3}}{\\partial \\xi}+y_{4}\\frac{\\partial N_{4}}{\\partial \\xi}\n=(1+\\eta)\\left(1-\\frac{y_{4}}{4}\\right),\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}=x_{2}\\frac{\\partial N_{2}}{\\partial \\eta}+x_{3}\\frac{\\partial N_{3}}{\\partial \\eta}+x_{4}\\frac{\\partial N_{4}}{\\partial \\eta}\n=\\frac{x_{4}}{4}(1-\\xi),\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}=y_{3}\\frac{\\partial N_{3}}{\\partial \\eta}+y_{4}\\frac{\\partial N_{4}}{\\partial \\eta}\n=(1+\\xi)+\\frac{y_{4}}{4}(1-\\xi).\n$$\n计算 $J$ 在四个角点处的值：\n- 在 $(\\xi,\\eta)=(-1,-1)$ 处：\n$$\n\\frac{\\partial x}{\\partial \\xi}=2,\\quad \\frac{\\partial y}{\\partial \\xi}=0,\\quad \\frac{\\partial x}{\\partial \\eta}=\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\eta}=\\frac{y_{4}}{2},\n$$\n所以\n$$\nJ(-1,-1)=2\\cdot \\frac{y_{4}}{2}-\\frac{x_{4}}{2}\\cdot 0=y_{4}.\n$$\n- 在 $(\\xi,\\eta)=(1,-1)$ 处：\n$$\n\\frac{\\partial x}{\\partial \\xi}=2,\\quad \\frac{\\partial y}{\\partial \\xi}=0,\\quad \\frac{\\partial x}{\\partial \\eta}=0,\\quad \\frac{\\partial y}{\\partial \\eta}=2,\n$$\n所以\n$$\nJ(1,-1)=2\\cdot 2-0\\cdot 0=4>0.\n$$\n- 在 $(\\xi,\\eta)=(1,1)$ 处：\n$$\n\\frac{\\partial x}{\\partial \\xi}=2-\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\xi}=2\\left(1-\\frac{y_{4}}{4}\\right),\\quad \\frac{\\partial x}{\\partial \\eta}=0,\\quad \\frac{\\partial y}{\\partial \\eta}=2,\n$$\n所以\n$$\nJ(1,1)=\\left(2-\\frac{x_{4}}{2}\\right)\\cdot 2-0=4-x_{4}.\n$$\n- 在 $(\\xi,\\eta)=(-1,1)$ 处：\n$$\n\\frac{\\partial x}{\\partial \\xi}=2-\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\xi}=2-\\frac{y_{4}}{2},\\quad \\frac{\\partial x}{\\partial \\eta}=\\frac{x_{4}}{2},\\quad \\frac{\\partial y}{\\partial \\eta}=\\frac{y_{4}}{2},\n$$\n所以\n$$\nJ(-1,1)=\\left(2-\\frac{x_{4}}{2}\\right)\\frac{y_{4}}{2}-\\frac{x_{4}}{2}\\left(2-\\frac{y_{4}}{2}\\right)=y_{4}-x_{4}.\n$$\n\n因此，$J$ 可能为零的必要边界线是\n$$\ny_{4}=0,\\quad x_{4}=4,\\quad y_{4}=x_{4}.\n$$\n当节点 1、2、3 按给定值固定且为逆时针顺序时，与标准网格相关的凸区域的特征为 $y_{4}>0$, $x_{4}<4$, 和 $y_{4}>x_{4}$。在远离退化边 $y_{4}=0$ 和 $x_{4}=4$ 的情况下，从凸到凹的过渡恰好发生在节点4位于通过节点1和3的直线上时，即 $y_{4}=x_{4}$。\n\n将此写成 $A x_{4}+B y_{4}+C=0$ 的形式，其中整数系数互质且第一个非零系数为正，可得\n$$\nx_{4}-y_{4}=0\\quad\\Rightarrow\\quad [A,B,C]=[1,-1,0].\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1 & -1 & 0\\end{pmatrix}}$$", "id": "2172610"}]}