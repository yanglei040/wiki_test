{"hands_on_practices": [{"introduction": "首个练习是弱公式转换的基础实践，旨在将一个标准的微分方程（“强形式”）转化为其“弱形式”。通过该过程，你将掌握核心技巧——乘以测试函数并进行分部积分，这是有限元法等众多高级数值方法的基石。这个练习将巩固你对如何处理边界条件和降低方程微分阶数的理解。[@problem_id:2156992]", "problem": "考虑由以下微分方程定义的一维边值问题 (BVP)：\n$$\n-(e^x u'(x))' = \\sin(x)\n$$\n该方程定义在开区间 $x \\in (a, b)$ 上，并服从齐次狄利克雷边界条件 $u(a) = 0$ 和 $u(b) = 0$。\n\n此边值问题的弱（或变分）形式要求从一个合适的函数空间 $V$ 中找到一个解函数 $u$，使得对于来自同一空间 $V$ 的所有“检验函数”$v$，某个积分方程都成立。对于本问题，空间 $V$ 定义为在区间 $(a, b)$ 上连续、一阶导数平方可积，且满足边界条件 $f(a) = 0$ 和 $f(b) = 0$ 的函数集合。\n\n以下哪个积分方程正确地表示了给定边值问题的弱形式？任务是找到 $u \\in V$，使得所选方程对所有 $v \\in V$ 均成立。\n\nA. $\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nB. $\\int_{a}^{b} u'(x) v'(x) \\,dx = \\int_{a}^{b} e^{-x}\\sin(x) v(x) \\,dx$\n\nC. $-\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nD. $\\int_{a}^{b} e^x u(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nE. $\\int_{a}^{b} e^x u'(x) v(x) \\,dx = -\\int_{a}^{b} \\cos(x) v'(x) \\,dx$\n\nF. $-\\int_{a}^{b} e^x u'(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$", "solution": "我们从该边值问题的强形式开始：\n$$\n-(\\exp(x)\\,u'(x))'=\\sin(x)\\quad\\text{for }x\\in(a,b),\\qquad u(a)=0,\\;u(b)=0.\n$$\n令 $V=\\{v\\in H^{1}(a,b):v(a)=v(b)=0\\}$。为了推导弱形式，我们将微分方程两边乘以一个任意的检验函数 $v\\in V$，然后在区间 $(a,b)$ 上积分：\n$$\n\\int_{a}^{b}-(\\exp(x)\\,u'(x))'\\,v(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\n对左侧应用分部积分法，使用恒等式\n$$\n\\int_{a}^{b}-\\left(p(x)w'(x)\\right)'\\,v(x)\\,dx=\\int_{a}^{b}p(x)\\,w'(x)\\,v'(x)\\,dx-\\left[p(x)\\,w'(x)\\,v(x)\\right]_{x=a}^{x=b},\n$$\n其中 $p(x)=\\exp(x)$ 且 $w(x)=u(x)$。这得到\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx-\\left[\\exp(x)\\,u'(x)\\,v(x)\\right]_{x=a}^{x=b}=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\n由于对所有 $v\\in V$ 都有 $v(a)=v(b)=0$，边界项为零，从而得到弱（变分）形式：\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx\\quad\\text{for all }v\\in V.\n$$\n与选项比较，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2156992"}, {"introduction": "现实世界的问题常常涉及由不同物理特性的复合材料构成。本练习旨在探索弱公式的一个主要优势：它能自然地处理材料界面问题，在这些界面上，热导率等物理属性是不连续的。你将研究弱公式如何隐式地施加物理上必需的温度 $u$ 和热通量 $k u'$ 的连续性条件，而这些条件在强形式中处理起来相当繁琐。[@problem_id:2146778]", "problem": "考虑一个长度为 $L=2$ 的一维复合杆中的稳态热传导问题，该杆占据区间 $x \\in [-1, 1]$。杆中的温度分布 $u(x)$ 由以下微分方程决定：\n$$-\\frac{d}{dx}\\left(k(x) \\frac{du}{dx}\\right) = f(x) \\quad \\text{for } x \\in (-1, 1)$$\n其中 $f(x)$ 是一个连续热源项。杆的两端保持在零温度，因此 $u(-1) = 0$ 且 $u(1) = 0$。\n\n该杆由在 $x=0$ 处连接的两种不同材料制成。因此，热导率 $k(x)$ 是一个不连续的阶跃函数，定义为：\n$$ k(x) = \\begin{cases} k_1 & \\text{if } -1 < x < 0 \\\\ k_2 & \\text{if } 0 < x < 1 \\end{cases} $$\n其中 $k_1$ 和 $k_2$ 是不同的正常数。\n\n该问题的经典形式要求在界面 $x=0$ 处指定“传输条件”，以确保解具有物理意义。当此问题以其弱（或变分）形式重新表述时，这些条件会由该形式本身隐式地施加。\n\n任务是确定在界面 $x=0$ 处这组被隐式施加的传输条件。在下面的选项中，$u(0^-)$ 和 $u'(0^-)$ 分别表示函数及其导数在 $x$ 从左侧趋近于 $0$ 时的极限，而 $u(0^+)$ 和 $u'(0^+)$ 表示从右侧趋近时的极限。\n\n下列哪对条件是由该边值问题的弱形式隐式施加的？\n\nA. $u(0^-) = u(0^+)$ 和 $k_1 u'(0^-) = k_2 u'(0^+)$\n\nB. $u'(0^-) = u'(0^+)$ 和 $k_1 u(0^-) = k_2 u(0^+)$\n\nC. $u(0^-) = u(0^+)$ 和 $u'(0^-) = u'(0^+)$\n\nD. 弱形式在 $x=0$ 处不施加任何条件，因为 $k(x)$ 的导数在该点没有定义。\n\nE. $k_1 u(0^-) = k_2 u(0^+)$ 和 $k_1 u'(0^-) = k_2 u'(0^+)$", "solution": "我们从弱（变分）形式出发：寻找 $u \\in H_{0}^{1}(-1,1)$，使得对于任意 $v \\in H_{0}^{1}(-1,1)$，\n$$\n\\int_{-1}^{1} k(x)\\, u'(x)\\, v'(x)\\, dx \\;=\\; \\int_{-1}^{1} f(x)\\, v(x)\\, dx,\n$$\n其中在 $(-1,0)$ 上 $k(x)=k_{1}$，在 $(0,1)$ 上 $k(x)=k_{2}$，且 $k_{1},k_{2}>0$。$u(-1)=u(1)=0$ 是通过 $H_{0}^{1}(-1,1)$ 的迹来施加的。\n\n首先，$u$ 在 $x=0$ 处的连续性由函数空间决定。在一维情况下，每个 $u \\in H^{1}(-1,1)$ 在 $[-1,1]$ 上都有一个绝对连续的表示，因此在 $[-1,1]$ 上是连续的。因此，在 $0$ 处的左极限和右极限相等：\n$$\nu(0^{-}) \\;=\\; u(0^{+}).\n$$\n\n其次，我们推导通量连续性条件。由于 $C_{c}^{\\infty}(-1,1)$ 在 $H_{0}^{1}(-1,1)$ 中是稠密的，所以弱形式对所有 $v \\in C_{c}^{\\infty}(-1,1)$ 都成立。在界面处将积分分开，并在每个子区间上进行分部积分：\n$$\n\\int_{-1}^{0} k_{1}\\, u' v' \\, dx \\;+\\; \\int_{0}^{1} k_{2}\\, u' v' \\, dx\n\\;=\\; \\int_{-1}^{1} f\\, v \\, dx.\n$$\n在 $(-1,0)$上，\n$$\n\\int_{-1}^{0} k_{1}\\, u' v' \\, dx\n= \\big[ k_{1}\\, u' v \\big]_{x=-1}^{x=0^{-}} \\;-\\; \\int_{-1}^{0} (k_{1}\\, u')' v \\, dx,\n$$\n并在 $(0,1)$上，\n$$\n\\int_{0}^{1} k_{2}\\, u' v' \\, dx\n= \\big[ k_{2}\\, u' v \\big]_{x=0^{+}}^{x=1} \\;-\\; \\int_{0}^{1} (k_{2}\\, u')' v \\, dx.\n$$\n将这两项相加，并利用 $v(-1)=v(1)=0$ (因为 $v \\in C_{c}^{\\infty}(-1,1)$)，得到\n$$\n\\big(k_{1}\\, u'(0^{-}) - k_{2}\\, u'(0^{+})\\big)\\, v(0)\n\\;-\\; \\int_{-1}^{0} (k_{1}\\, u')' v \\, dx \\;-\\; \\int_{0}^{1} (k_{2}\\, u')' v \\, dx\n\\;=\\; \\int_{-1}^{1} f\\, v \\, dx.\n$$\n在每个子区间内，强形式在分布意义上成立：\n$$\n-(k_{1}\\, u')' = f \\quad \\text{on } (-1,0), \\qquad -(k_{2}\\, u')' = f \\quad \\text{on } (0,1).\n$$\n将这些代入前面的恒等式中，会使积分项与 $\\int f v\\, dx$ 相消，剩下\n$$\n\\big(k_{1}\\, u'(0^{-}) - k_{2}\\, u'(0^{+})\\big)\\, v(0) \\;=\\; 0 \\quad \\text{for all } v \\in C_{c}^{\\infty}(-1,1).\n$$\n因为可以选择在 $x=0$ 处具有任意值的 $v$，所以可得\n$$\nk_{1}\\, u'(0^{-}) \\;=\\; k_{2}\\, u'(0^{+}).\n$$\n\n结合这两个结论，弱形式施加了跨界面处温度的连续性和热通量的连续性：\n$$\nu(0^{-}) = u(0^{+}), \\qquad k_{1}\\, u'(0^{-}) = k_{2}\\, u'(0^{+}).\n$$\n这些恰好是选项A中的条件。", "answer": "$$\\boxed{A}$$", "id": "2146778"}, {"introduction": "在掌握了基础知识之后，本练习将通过处理两个常见的复杂情况来展示弱公式的通用性：非线性材料属性和混合边界条件。你将为一个热导率 $k(u)$ 本身依赖于温度 $u$ 的非线性问题建立弱形式，并处理在边界的不同部分施加不同类型条件（指定的温度和指定的热通量）的情况。这个练习突出了弱公式如何为各种真实的物理和工程问题提供一个统一的框架。[@problem_id:2157029]", "problem": "考虑一个占据二维域 $\\Omega$ 且边界为 $\\partial\\Omega$ 的非均匀、各向异性材料板的稳态热分析。材料的热导率不是常数，而是根据非线性关系 $k(u) = 1 + \\alpha u^2$ 取决于局部温度 $u(x,y)$，其中 $\\alpha$ 是一个正常数。板内的温度分布由以下非线性偏微分方程控制：\n\n$$-\\nabla \\cdot (k(u)\\nabla u) = f(x,y) \\quad \\text{in } \\Omega$$\n\n其中 $f(x,y)$ 表示内热源分布。\n\n边界 $\\partial\\Omega$ 被划分为两个不相交的部分 $\\Gamma_D$ 和 $\\Gamma_N$，使得 $\\partial\\Omega = \\Gamma_D \\cup \\Gamma_N$。边界条件为混合类型：\n1.  在 $\\Gamma_D$ 上施加给定温度：$u = g_D$，其中 $g_D$ 是一个已知函数。\n2.  在 $\\Gamma_N$ 上施加给定热流密度：$-k(u) \\frac{\\partial u}{\\partial \\mathbf{n}} = g_N$，其中 $g_N$ 是一个已知函数，$\\frac{\\partial u}{\\partial \\mathbf{n}} = \\nabla u \\cdot \\mathbf{n}$ 是法向导数，$\\mathbf{n}$ 是边界的外向单位法向量。\n\n为数值求解此问题，首先需要推导其弱形式。这涉及从一个合适的函数空间 $V$ (试探空间) 中找到一个满足Dirichlet边界条件 ($u=g_D$ on $\\Gamma_D$) 的函数 $u$，使得对于来自另一个函数空间 $V_0$ (检验空间) 的所有函数 $v$ (其中 $V_0$ 中的函数在Dirichlet边界上为零，$v=0$ on $\\Gamma_D$)，一个积分方程成立。\n\n令 $dA$ 表示 $\\Omega$ 上的面积微元，$ds$ 表示沿边界的线微元。以下哪个积分方程正确地表示了该边值问题的弱形式？\n\nA. $\\int_\\Omega (1+\\alpha u^2) \\nabla u \\cdot \\nabla v \\, dA = \\int_\\Omega f v \\, dA - \\int_{\\Gamma_N} g_N v \\, ds$\n\nB. $\\int_\\Omega (1+\\alpha u^2) \\nabla u \\cdot \\nabla v \\, dA = \\int_\\Omega f v \\, dA + \\int_{\\Gamma_N} g_N v \\, ds$\n\nC. $-\\int_\\Omega (1+\\alpha u^2) \\nabla u \\cdot \\nabla v \\, dA = \\int_\\Omega f v \\, dA - \\int_{\\Gamma_N} g_N v \\, ds$\n\nD. $\\int_\\Omega (1+\\alpha u^2) \\nabla u \\cdot \\nabla v \\, dA = \\int_\\Omega f v \\, dA - \\int_{\\Gamma_N} (1+\\alpha u^2) g_N v \\, ds$\n\nE. $\\int_\\Omega (1+\\alpha u^2) \\nabla u \\cdot \\nabla v \\, dA = \\int_\\Omega f v \\, dA$", "solution": "令 $k(u) = 1 + \\alpha u^{2}$。强形式为 $-\\nabla \\cdot (k(u)\\nabla u) = f$ in $\\Omega$，带有在 $\\Gamma_{D}$ 上的Dirichlet条件 $u=g_{D}$ 和在 $\\Gamma_{N}$ 上的Neumann条件 $-k(u)\\,\\frac{\\partial u}{\\partial \\mathbf{n}}=g_{N}$。令 $V$ 为在 $\\Gamma_{D}$ 上满足 $u=g_{D}$ 的函数的试探空间，$V_{0}$ 为在 $\\Gamma_{D}$ 上满足 $v=0$ 的检验空间。\n\n将偏微分方程乘以一个任意的 $v \\in V_{0}$，并在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega}\\big(-\\nabla \\cdot (k(u)\\nabla u)\\big)\\,v\\,dA \\;=\\; \\int_{\\Omega} f\\,v\\,dA.\n$$\n设 $\\mathbf{q}=k(u)\\nabla u$ 并使用格林恒等式 (Green's identity)：\n$$\n\\int_{\\Omega}\\big(-\\nabla \\cdot \\mathbf{q}\\big)\\,v\\,dA \\;=\\; \\int_{\\Omega} \\mathbf{q}\\cdot \\nabla v\\,dA \\;-\\; \\int_{\\partial \\Omega} (\\mathbf{q}\\cdot \\mathbf{n})\\,v\\,ds.\n$$\n因此，\n$$\n\\int_{\\Omega} k(u)\\nabla u \\cdot \\nabla v\\,dA \\;-\\; \\int_{\\partial \\Omega} \\big(k(u)\\nabla u \\cdot \\mathbf{n}\\big)\\,v\\,ds \\;=\\; \\int_{\\Omega} f\\,v\\,dA.\n$$\n由于在 $\\Gamma_{D}$ 上 $v=0$，边界积分简化为在 $\\Gamma_{N}$ 上的积分：\n$$\n\\int_{\\Omega} k(u)\\nabla u \\cdot \\nabla v\\,dA \\;-\\; \\int_{\\Gamma_{N}} \\big(k(u)\\nabla u \\cdot \\mathbf{n}\\big)\\,v\\,ds \\;=\\; \\int_{\\Omega} f\\,v\\,dA.\n$$\n使用Neumann条件 $-k(u)\\,\\frac{\\partial u}{\\partial \\mathbf{n}}=g_{N}$，即在 $\\Gamma_{N}$ 上 $k(u)\\nabla u \\cdot \\mathbf{n}=-g_{N}$，可得\n$$\n\\int_{\\Omega} k(u)\\nabla u \\cdot \\nabla v\\,dA \\;+\\; \\int_{\\Gamma_{N}} g_{N}\\,v\\,ds \\;=\\; \\int_{\\Omega} f\\,v\\,dA,\n$$\n这可以等价地写作\n$$\n\\int_{\\Omega} k(u)\\nabla u \\cdot \\nabla v\\,dA \\;=\\; \\int_{\\Omega} f\\,v\\,dA \\;-\\; \\int_{\\Gamma_{N}} g_{N}\\,v\\,ds.\n$$\n代入 $k(u)=1+\\alpha u^{2}$ 可得\n$$\n\\int_{\\Omega} (1+\\alpha u^{2})\\,\\nabla u \\cdot \\nabla v\\,dA \\;=\\; \\int_{\\Omega} f\\,v\\,dA \\;-\\; \\int_{\\Gamma_{N}} g_{N}\\,v\\,ds,\n$$\n这与选项A相符。其他选项的边界项存在符号或因子错误，或者完全省略了Neumann项。", "answer": "$$\\boxed{A}$$", "id": "2157029"}]}