{"hands_on_practices": [{"introduction": "有限元方法的核心在于将复杂问题分解为简单的局部问题。这第一个练习将带您领略这一思想的精髓：为最基础的一维线性单元构建近似解。通过推导连接两个节点的线性插值函数，您将掌握形函数必须满足的基本性质——克罗内克-德尔塔（Kronecker-delta）特性，并为后续更复杂的单元学习打下坚实的基础。[@problem_id:2172650]", "problem": "在有限元法 (FEM) 中，一个连续域被离散化为更小、更简单的子域，这些子域被称为有限元。考虑一个一维物理问题，例如沿细长均匀杆的热传递。该杆被建模为一个线段，并被划分为若干个线性有限元。\n\n我们关注连接两个节点（节点 $i$ 和节点 $i+1$）的单个通用线性单元。这些节点分别位于空间坐标 $x_i$ 和 $x_{i+1}$ 处。在这些节点上，未知场变量（例如温度）的值用 $u_i$ 和 $u_{i+1}$ 表示。\n\n在该单元内，对于满足 $x_i \\leq x \\leq x_{i+1}$ 的任意坐标 $x$，场变量通过一个线性插值函数 $u_h(x)$ 来近似。该函数由基函数（也称为形函数）和节点值的线性组合构成。\n\n请确定该单元内近似解 $u_h(x)$ 的表达式。你的最终答案应使用变量 $x$、节点坐标 $x_i$ 和 $x_{i+1}$ 以及节点值 $u_i$ 和 $u_{i+1}$ 来表示。", "solution": "我们考虑区间 $[x_{i},x_{i+1}]$ 上的单个线性有限元，其在 $x_{i}$ 处的节点值为 $u_{i}$，在 $x_{i+1}$ 处的节点值为 $u_{i+1}$。在线性单元的标准伽辽金 (Galerkin) 有限元近似中，单元内的场表示为节点值与相应线性形函数的线性组合：\n$$\nu_{h}(x)=N_{i}(x)\\,u_{i}+N_{i+1}(x)\\,u_{i+1}.\n$$\n对于两节点线性单元，其形函数是区间 $[x_{i},x_{i+1}]$ 上的一阶拉格朗日 (Lagrange) 多项式，由插值（克罗内克-德尔塔，Kronecker-delta）条件唯一确定：\n$$\nN_{i}(x_{i})=1,\\quad N_{i}(x_{i+1})=0,\\quad N_{i+1}(x_{i})=0,\\quad N_{i+1}(x_{i+1})=1.\n$$\n满足这些条件的线性多项式为\n$$\nN_{i}(x)=\\frac{x_{i+1}-x}{x_{i+1}-x_{i}},\\qquad N_{i+1}(x)=\\frac{x-x_{i}}{x_{i+1}-x_{i}}.\n$$\n将这些形函数代入近似式，得到单元内的显式插值公式：\n$$\nu_{h}(x)=\\frac{x_{i+1}-x}{x_{i+1}-x_{i}}\\,u_{i}+\\frac{x-x_{i}}{x_{i+1}-x_{i}}\\,u_{i+1},\n$$\n该公式满足所要求的条件 $u_{h}(x_{i})=u_{i}$ 和 $u_{h}(x_{i+1})=u_{i+1}$。", "answer": "$$\\boxed{\\frac{x_{i+1}-x}{x_{i+1}-x_{i}}\\,u_{i}+\\frac{x-x_{i}}{x_{i+1}-x_{i}}\\,u_{i+1}}$$", "id": "2172650"}, {"introduction": "在实际工程应用中，网格通常不是均匀的，常需要在粗网格和细网格之间进行过渡。这个练习将引导您解决一个在网格自适应加密中遇到的经典问题：处理“悬挂节点”（hanging node）。您需要为连接粗细网格的“过渡单元”设计一套特殊的基函数，这不仅能加深您对基函数基本原理的理解，还能让您体会到如何巧妙地构造函数以满足特定的工程需求。[@problem_id:2375624]", "problem": "考虑一个用于有限元法 (FEM) 的一维界面，该界面位于粗网格区域和细网格区域之间。该界面为参考区间 $[-1,1] \\subset \\mathbb{R}$，其中粗糙侧由一个跨越 $[-1,1]$ 的单个单元表示，精细侧由两个分别跨越 $[-1,0]$ 和 $[0,1]$ 的单元表示。为确保在 $x=0$ 处存在悬挂节点的情况下实现协调离散化，在 $[-1,1]$ 上引入一个三节点过渡单元，其节点位置为 $x=-1$、$x=0$ 和 $x=1$。\n\n设基函数（形函数）$N_{-1}(x)$、$N_{0}(x)$ 和 $N_{1}(x)$ 分别与位于 $x=-1$、$x=0$ 和 $x=1$ 的节点相关联。这些基函数必须满足以下所有要求：\n1. 节点插值（克罗内克-德尔塔性质）：对于 $i,j \\in \\{-1,0,1\\}$，$N_{i}(x_{j})=\\delta_{ij}$。\n2. 单位分解：对于所有 $x \\in [-1,1]$，$N_{-1}(x)+N_{0}(x)+N_{1}(x)=1$。\n3. 在子区间上与细网格的协调性：在 $[-1,0]$ 上，过渡基的限制必须与节点 $x=-1$ 和 $x=0$ 上的标准线性双节点基一致；在 $[0,1]$ 上，其限制必须与节点 $x=0$ 和 $x=1$ 上的标准线性双节点基一致。特别地，这意味着在 $[-1,0]$ 上 $N_{1}(x)=0$，在 $[0,1]$ 上 $N_{-1}(x)=0$，并且每个活跃的基函数在相应的子区间内是线性的。\n\n推导在整个区间 $[-1,1]$ 上满足上述所有性质的 $N_{-1}(x)$、$N_{0}(x)$ 和 $N_{1}(x)$ 的显式表达式，并将最终答案表示为不分情况讨论的单一闭式解析表达式。您的最终答案应为行向量 $[\\,N_{-1}(x)\\;N_{0}(x)\\;N_{1}(x)\\,]$。\n\n无需进行数值近似或四舍五入。答案中请勿包含物理单位。", "solution": "问题陈述已经过有效性分析，被认为是具有科学依据、良定且客观的。它代表了有限元法中为确保在带有悬挂节点的网格加密界面上实现协调性的标准流程。陈述中没有矛盾、歧义或事实性错误。我们可以开始推导。\n\n目标是为节点位于 $x_{-1}=-1$、$x_{0}=0$ 和 $x_{1}=1$ 的三节点过渡单元，在参考区间 $[-1,1]$ 上找到三个基函数 $N_{-1}(x)$、$N_{0}(x)$ 和 $N_{1}(x)$ 的显式表达式。\n\n推导从要求 3 开始，该要求规定了基函数在子区间 $[-1,0]$ 和 $[0,1]$ 上的形式。\n\n首先，考虑子区间 $[-1,0]$。问题陈述表明，此处的基必须与节点 $x=-1$ 和 $x=0$ 上的标准线性双节点基一致。\n在区间 $[x_a, x_b]$ 上的标准线性拉格朗日基函数由下式给出：\n$$L_a(x) = \\frac{x_b - x}{x_b - x_a}, \\quad L_b(x) = \\frac{x - x_a}{x_b - x_a}$$\n对于区间 $[-1,0]$，我们有 $x_a = -1$ 和 $x_b = 0$。与这些节点相关联的基函数是：\n$$L_{-1}(x) = \\frac{0 - x}{0 - (-1)} = -x$$\n$$L_{0}(x) = \\frac{x - (-1)}{0 - (-1)} = x+1$$\n根据要求 3，在区间 $[-1,0]$ 上，基函数 $N_i(x)$ 为：\n$N_{-1}(x) = L_{-1}(x) = -x$\n$N_{0}(x) = L_{0}(x) = x+1$\n节点 $x=1$ 不属于该子单元，因此其对应的基函数必须为零。这一点在要求 3 中也作为一个推论被明确指出。\n$N_{1}(x) = 0$\n\n接下来，考虑子区间 $[0,1]$。基必须与节点 $x=0$ 和 $x=1$ 上的标准线性双节点基一致。\n对于区间 $[0,1]$，我们有 $x_a = 0$ 和 $x_b = 1$。与这些节点相关联的基函数是：\n$$L_0(x) = \\frac{1 - x}{1 - 0} = 1-x$$\n$$L_1(x) = \\frac{x - 0}{1 - 0} = x$$\n根据要求 3，在区间 $[0,1]$ 上，基函数 $N_i(x)$ 为：\n$N_{0}(x) = L_{0}(x) = 1-x$\n$N_{1}(x) = L_{1}(x) = x$\n节点 $x=-1$ 不属于该子单元，因此其对应的基函数必须为零。\n$N_{-1}(x) = 0$\n\n综合这些结果，我们得到在整个区间 $[-1,1]$ 上基函数的分段定义：\n$$N_{-1}(x) = \\begin{cases} -x & \\text{for } x \\in [-1, 0] \\\\ 0 & \\text{for } x \\in [0, 1] \\end{cases}$$\n$$N_{0}(x) = \\begin{cases} x+1 & \\text{for } x \\in [-1, 0] \\\\ 1-x & \\text{for } x \\in [0, 1] \\end{cases}$$\n$$N_{1}(x) = \\begin{cases} 0 & \\text{for } x \\in [-1, 0] \\\\ x & \\text{for } x \\in [0, 1] \\end{cases}$$\n\n问题要求为每个函数提供一个单一的闭式解析表达式。我们可以使用绝对值函数 $|x|$ 来实现这一点，其定义为：\n$$|x| = \\begin{cases} -x & \\text{for } x < 0 \\\\ x & \\text{for } x \\ge 0 \\end{cases}$$\n\n对于 $N_{0}(x)$：\n在 $[-1,0]$ 上，我们有 $|x|=-x$，所以 $1-|x| = 1-(-x) = 1+x$。这与之前的结果相符。\n在 $[0,1]$ 上，我们有 $|x|=x$，所以 $1-|x| = 1-x$。这与之前的结果相符。\n因此，$N_{0}(x)$ 的闭式表达式为：\n$$N_{0}(x) = 1 - |x|$$\n\n对于 $N_{-1}(x)$：\n考虑表达式 $\\frac{1}{2}(-x+|x|)$。\n在 $[-1,0]$ 上， $|x|=-x$，所以该表达式变为 $\\frac{1}{2}(-x-x) = -x$。这与之前的结果相符。\n在 $[0,1]$ 上， $|x|=x$，所以该表达式变为 $\\frac{1}{2}(-x+x) = 0$。这与之前的结果相符。\n因此，$N_{-1}(x)$ 的闭式表达式为：\n$$N_{-1}(x) = \\frac{1}{2}(-x+|x|)$$\n\n对于 $N_{1}(x)$：\n考虑表达式 $\\frac{1}{2}(x+|x|)$。\n在 $[-1,0]$ 上， $|x|=-x$，所以该表达式变为 $\\frac{1}{2}(x-x) = 0$。这与之前的结果相符。\n在 $[0,1]$ 上， $|x|=x$，所以该表达式变为 $\\frac{1}{2}(x+x) = x$。这与之前的结果相符。\n因此，$N_{1}(x)$ 的闭式表达式为：\n$$N_{1}(x) = \\frac{1}{2}(x+|x|)$$\n\n我们必须验证这些闭式表达式是否满足所有三个原始要求。\n\n1. 节点插值 ($N_{i}(x_{j})=\\delta_{ij}$):\n在 $x=-1$ 处：\n$N_{-1}(-1) = \\frac{1}{2}(-(-1)+|-1|) = \\frac{1}{2}(1+1) = 1$\n$N_{0}(-1) = 1 - |-1| = 1 - 1 = 0$\n$N_{1}(-1) = \\frac{1}{2}(-1+|-1|) = \\frac{1}{2}(-1+1) = 0$\n在 $x=0$ 处：\n$N_{-1}(0) = \\frac{1}{2}(-0+|0|) = 0$\n$N_{0}(0) = 1 - |0| = 1$\n$N_{1}(0) = \\frac{1}{2}(0+|0|) = 0$\n在 $x=1$ 处：\n$N_{-1}(1) = \\frac{1}{2}(-1+|1|) = \\frac{1}{2}(-1+1) = 0$\n$N_{0}(1) = 1 - |1| = 1 - 1 = 0$\n$N_{1}(1) = \\frac{1}{2}(1+|1|) = \\frac{1}{2}(1+1) = 1$\n节点插值性质得到满足。\n\n2. 单位分解 ($\\sum_{i} N_{i}(x) = 1$):\n$$N_{-1}(x)+N_{0}(x)+N_{1}(x) = \\frac{1}{2}(-x+|x|) + (1-|x|) + \\frac{1}{2}(x+|x|)$$\n$$= \\left(\\frac{-x}{2} + \\frac{x}{2}\\right) + \\left(\\frac{|x|}{2} - |x| + \\frac{|x|}{2}\\right) + 1$$\n$$= 0 + \\left(|x| - |x|\\right) + 1 = 1$$\n对于所有 $x \\in [-1,1]$，单位分解性质得到满足。\n\n3. 协调性：这些闭式表达式是精确地构造以匹配从协调性要求推导出的分段线性函数。因此，该性质因构造而满足。\n\n推导出的基函数满足所有指定标准。最终答案是包含这三个函数的行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}(-x+|x|) & 1-|x| & \\frac{1}{2}(x+|x|)\n\\end{pmatrix}\n}\n$$", "id": "2375624"}, {"introduction": "等参元法通过将一个完美的“参考单元”映射到物理空间中的任意形状单元，极大地增强了有限元方法的几何适应性。然而，这种映射并非万无一失。此练习通过一个精心设计的思想实验，让您亲手计算一个严重扭曲的单元在其几何中心处的雅可比行列式（Jacobian determinant）的值。您将通过计算结果，直观地理解为何保持单元的良好“形状”至关重要，以及当几何映射失效时会发生什么。[@problem_id:2375611]", "problem": "考虑有限元法 (FEM) 中使用的等参二次三角形单元。设参考（母）三角形在自然坐标 $(\\xi,\\eta)$ 中由 $\\xi \\ge 0$、$\\eta \\ge 0$ 和 $\\xi + \\eta \\le 1$ 定义。设相关的面积（重心）坐标为 $L_{1} = 1 - \\xi - \\eta$、$L_{2} = \\xi$ 和 $L_{3} = \\eta$。该物理单元的顶点节点位于 $(x_{1},y_{1}) = (0,0)$、$(x_{2},y_{2}) = (1,0)$ 和 $(x_{3},y_{3}) = (0,1)$。边中节点为：边 $1$–$2$ 上的 $(x_{4},y_{4}) = \\left(\\frac{1}{2},0\\right)$，边 $3$–$1$ 上的 $(x_{6},y_{6}) = \\left(0,\\frac{1}{2}\\right)$，而节点 $5$（名义上在边 $2$–$3$ 上）被有意移动到 $(x_{5},y_{5}) = \\left(0,\\frac{1}{5}\\right)$。使用由 $6$ 节点二次三角形的面积坐标构建的标准二次形函数，构建等参映射 $(x(\\xi,\\eta),y(\\xi,\\eta)) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) (x_{i},y_{i})$，计算在形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵 $\\partial(x,y)/\\partial(\\xi,\\eta)$，并评估其在该点的行列式 $J$。报告 $J$ 的精确值（不要四舍五入）。然后，用一句话说明对于此单元构型，$J$ 的符号的物理意义。你的最终数值答案应为 $J$ 的值。", "solution": "对问题陈述进行了严格审查，认定其有效。该问题在科学上有计算物理学原理作为基础，特别是有限元法。问题是适定的、客观的、自洽的，且所有提供的数据都是一致的。未检测到任何瑕疵。我们开始求解。\n\n该问题要求计算一个 $6$ 节点二次三角形单元在特定点上的等参映射的雅可比行列式。物理坐标 $(x,y)$ 通过以下关系从参考坐标 $(\\xi,\\eta)$ 映射而来：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) x_{i}\n$$\n$$\ny(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) y_{i}\n$$\n其中 $(x_i, y_i)$ 是物理域中的节点坐标，$N_i$ 是在参考域中定义的二次形函数。\n\n$6$ 节点三角形的形函数用面积坐标 $L_1$、$L_2$ 和 $L_3$ 表示。对于顶点节点 ($i=1,2,3$)，形函数为：\n$$\nN_1 = L_1(2L_1 - 1)\n$$\n$$\nN_2 = L_2(2L_2 - 1)\n$$\n$$\nN_3 = L_3(2L_3 - 1)\n$$\n对于分别位于边 $1$-$2$、$2$-$3$ 和 $3$-$1$ 上的边中节点 ($i=4,5,6$)，形函数为：\n$$\nN_4 = 4L_1L_2\n$$\n$$\nN_5 = 4L_2L_3\n$$\n$$\nN_6 = 4L_3L_1\n$$\n面积坐标与自然坐标 $(\\xi, \\eta)$ 的关系如下：\n$L_1 = 1 - \\xi - \\eta$，$L_2 = \\xi$，以及 $L_3 = \\eta$。\n将这些代入形函数的表达式中，得到：\n$N_1 = (1 - \\xi - \\eta)(1 - 2\\xi - 2\\eta)$\n$N_2 = \\xi(2\\xi - 1)$\n$N_3 = \\eta(2\\eta - 1)$\n$N_4 = 4\\xi(1 - \\xi - \\eta)$\n$N_5 = 4\\xi\\eta$\n$N_6 = 4\\eta(1 - \\xi - \\eta)$\n\n物理域中给定的节点坐标为：\n$(x_{1},y_{1}) = (0,0)$\n$(x_{2},y_{2}) = (1,0)$\n$(x_{3},y_{3}) = (0,1)$\n$(x_{4},y_{4}) = (\\frac{1}{2},0)$\n$(x_{5},y_{5}) = (0,\\frac{1}{5})$\n$(x_{6},y_{6}) = (0,\\frac{1}{2})$\n\n我们通过将形函数与对应的 $x$ 坐标的乘积求和来构建 $x(\\xi,\\eta)$ 的映射：\n$$\nx(\\xi,\\eta) = N_1(0) + N_2(1) + N_3(0) + N_4\\left(\\frac{1}{2}\\right) + N_5(0) + N_6(0)\n$$\n$$\nx(\\xi,\\eta) = N_2 + \\frac{1}{2}N_4 = \\xi(2\\xi - 1) + \\frac{1}{2} \\cdot 4\\xi(1 - \\xi - \\eta) = 2\\xi^2 - \\xi + 2\\xi(1 - \\xi - \\eta)\n$$\n$$\nx(\\xi,\\eta) = 2\\xi^2 - \\xi + 2\\xi - 2\\xi^2 - 2\\xi\\eta = \\xi - 2\\xi\\eta\n$$\n类似地，对于 $y(\\xi,\\eta)$：\n$$\ny(\\xi,\\eta) = N_1(0) + N_2(0) + N_3(1) + N_4(0) + N_5\\left(\\frac{1}{5}\\right) + N_6\\left(\\frac{1}{2}\\right)\n$$\n$$\ny(\\xi,\\eta) = N_3 + \\frac{1}{5}N_5 + \\frac{1}{2}N_6 = \\eta(2\\eta - 1) + \\frac{1}{5}(4\\xi\\eta) + \\frac{1}{2}(4\\eta(1 - \\xi - \\eta))\n$$\n$$\ny(\\xi,\\eta) = 2\\eta^2 - \\eta + \\frac{4}{5}\\xi\\eta + 2\\eta(1 - \\xi - \\eta) = 2\\eta^2 - \\eta + \\frac{4}{5}\\xi\\eta + 2\\eta - 2\\xi\\eta - 2\\eta^2\n$$\n$$\ny(\\xi,\\eta) = \\eta + \\left(\\frac{4}{5} - 2\\right)\\xi\\eta = \\eta - \\frac{6}{5}\\xi\\eta\n$$\n因此，等参映射为：\n$x(\\xi,\\eta) = \\xi(1 - 2\\eta)$\n$y(\\xi,\\eta) = \\eta\\left(1 - \\frac{6}{5}\\xi\\right)$\n\n该变换的雅可比矩阵 $\\mathbf{J}$ 定义为：\n$$\n\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们计算偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi - 2\\xi\\eta) = 1 - 2\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi - 2\\xi\\eta) = -2\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\eta - \\frac{6}{5}\\xi\\eta) = -\\frac{6}{5}\\eta$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\eta - \\frac{6}{5}\\xi\\eta) = 1 - \\frac{6}{5}\\xi$\n雅可比矩阵为：\n$$\n\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 - 2\\eta & -2\\xi \\\\ -\\frac{6}{5}\\eta & 1 - \\frac{6}{5}\\xi \\end{pmatrix}\n$$\n我们必须在参考三角形的形心处，即 $(\\xi, \\eta) = (\\frac{1}{3}, \\frac{1}{3})$ 处，评估该矩阵。\n代入这些值：\n$\\frac{\\partial x}{\\partial \\xi} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = 1 - 2\\left(\\frac{1}{3}\\right) = \\frac{1}{3}$\n$\\frac{\\partial x}{\\partial \\eta} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = -2\\left(\\frac{1}{3}\\right) = -\\frac{2}{3}$\n$\\frac{\\partial y}{\\partial \\xi} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = -\\frac{6}{5}\\left(\\frac{1}{3}\\right) = -\\frac{2}{5}$\n$\\frac{\\partial y}{\\partial \\eta} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = 1 - \\frac{6}{5}\\left(\\frac{1}{3}\\right) = 1 - \\frac{2}{5} = \\frac{3}{5}$\n在形心处的雅可比矩阵为：\n$$\n\\mathbf{J}\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\begin{pmatrix} \\frac{1}{3} & -\\frac{2}{3} \\\\ -\\frac{2}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n该矩阵的行列式 $J$ 为：\n$$\nJ = \\det(\\mathbf{J}) = \\left(\\frac{1}{3}\\right)\\left(\\frac{3}{5}\\right) - \\left(-\\frac{2}{3}\\right)\\left(-\\frac{2}{5}\\right) = \\frac{3}{15} - \\frac{4}{15} = -\\frac{1}{15}\n$$\n在形心处的雅可比行列式的值为 $-\\frac{1}{15}$。\n\n雅可比行列式 $J$ 符号的物理意义关系到映射的局部有效性；$J$ 的负号表示从参考坐标到物理坐标的等参映射不是一一对应的，并且在该点局部地翻转了单元的几何形状。", "answer": "$$ \\boxed{-\\frac{1}{15}} $$", "id": "2375611"}]}