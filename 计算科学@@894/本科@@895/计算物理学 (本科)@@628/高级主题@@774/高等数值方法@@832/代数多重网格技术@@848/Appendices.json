{"hands_on_practices": [{"introduction": "代数多重网格（AMG）的力量在于其直接从系统矩阵 $A$ 构建粗网格问题的能力。此过程中的关键一步是定义连接粗细网格的插值算子 $P$。本练习 [@problem_id:22396] 将引导你亲手计算插值权重，将抽象概念植根于从矩阵模板本身推导出的具体公式，从而让你初步掌握AMG的核心构造思想。", "problem": "在计算静电学中，在网格上求解泊松方程通常会产生一个大型稀疏线性方程组 $A\\mathbf{x} = \\mathbf{b}$。代数多重网格（AMG）方法是求解此类方程组的强大迭代求解器。AMG 的一个关键组成部分是构建一个插值算子 $P$，它将粗网格上的值与细网格上的值关联起来。\n\n网格点（节点）被划分为一组粗（C）点和细（F）点。细点 $i$ 处的误差值 $e_i$ 通过其相邻粗点 $j \\in N_i^C$ 处的误差值的加权和来近似：\n$$ e_i = \\sum_{j \\in N_i^C} w_{ij} e_j $$\n权重 $w_{ij}$ 构成了插值算子 $P$ 的元素。\n\n为细点 $i$ 推导这些权重的一种标准方法是基于其在系统矩阵 $A$ 中对应的行。对于一个光滑误差向量 $e$，其差分格式方程为 $(Ae)_i \\approx 0$。通过近似来自相邻细点的贡献，可以得到以下插值权重的公式：\n$$ w_{ij} = \\frac{-A_{ij}}{A_{ii} + \\sum_{k \\in N_i^F} A_{ik}} \\quad \\text{for } j \\in N_i^C $$\n其中 $N_i^C$ 是 $i$ 的粗邻点集合，而 $N_i^F$ 是 $i$ 的细邻点集合。\n\n考虑具有常数 $\\alpha > 0$ 和 $\\beta > 0$ 的二维各向异性泊松方程：\n$$ \\alpha \\frac{\\partial^2 \\phi}{\\partial x^2} + \\beta \\frac{\\partial^2 \\phi}{\\partial y^2} = -\\rho(x,y) $$\n该方程使用标准的 5 点有限差分格式在间距为 $h=1$ 的均匀方形网格上进行离散化。这会产生一个系统矩阵 $A$。\n\n设点 $P_0$ 为一个细点。其四个邻点分别表示为 $P_N$（北）、$P_S$（南）、$P_E$（东）和 $P_W$（西）。邻点的粗/细划分如下：\n-   $P_N$ 和 $P_E$ 是粗（C）点。\n-   $P_S$ 和 $P_W$ 是细（F）点。\n\n您的任务是计算插值权重 $w_{0N}$，该权重连接了细点 $P_0$ 与其北边的粗邻点 $P_N$。请用 $\\alpha$ 和 $\\beta$ 来表示您的答案。", "solution": "1. 细点 $i$ 和粗邻点 $j$ 的插值权重公式：\n   $$w_{ij}=\\frac{-A_{ij}}{A_{ii}+\\sum_{k\\in N_i^F}A_{ik}}.$$\n\n2. 各向异性 5 点差分格式的矩阵元素：\n   $$A_{ii}=2\\alpha+2\\beta,\\quad\n     A_{i,E}=A_{i,W}=-\\alpha,\\quad\n     A_{i,N}=A_{i,S}=-\\beta.$$\n\n3. 对于点 $P_0$，粗邻点为 $N, E$；细邻点为 $S, W$：\n   $$\\sum_{k\\in N_0^F}A_{0k}=A_{0,S}+A_{0,W}=(-\\beta)+(-\\alpha)=-(\\alpha+\\beta).$$\n\n4. $w_{0N}$ 的分子：\n   $$-A_{0,N}=-(-\\beta)=\\beta.$$\n\n5. 分母：\n   $$A_{00}+\\sum_{F}A_{0k}=2(\\alpha+\\beta)-(\\alpha+\\beta)=\\alpha+\\beta.$$\n\n6. 因此，\n   $$w_{0N}=\\frac{\\beta}{\\alpha+\\beta}.$$", "answer": "$$\\boxed{\\frac{\\beta}{\\alpha+\\beta}}$$", "id": "22396"}, {"introduction": "一个精心设计的插值算子是快速收敛的保证，但如果算子选择不当会发生什么呢？本练习通过分析一个特意设计的、有缺陷的双网格方法来探讨这个问题。通过计算误差传播矩阵的光谱半径 [@problem_id:2372552]，你将定量地理解为何一个“坏”的、无法有效捕捉光滑误差分量的插值算子，会导致求解器收敛缓慢甚至不收敛。", "problem": "考虑一个线性系统，该系统由对单位区间上具有齐次Dirichlet边界条件的一维Poisson方程 $-u'' = f$ 进行标准二阶有限差分离散得到，其中使用 $N=3$ 个内部节点。所得到的刚度矩阵为\n$$\nA \\in \\mathbb{R}^{3 \\times 3}, \\quad\nA = \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}.\n$$\n在代数多重网格（AMG）的框架内定义一个双网格方法。选择一个刻意设置的较差的粗空间，该空间由中间节点上的单个粗变量构成，并定义插值算子\n$$\nP \\in \\mathbb{R}^{3 \\times 1}, \\quad P = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n使用转置作为限制算子，$R = P^{\\top}$，以及Galerkin粗算子 $A_{c} = R A P \\in \\mathbb{R}^{1 \\times 1}$。使用一步加权Jacobi后平滑，松弛权重为 $\\omega = \\frac{2}{3}$，因此平滑算子为\n$$\nS = I - \\omega D^{-1} A, \\quad D = \\operatorname{diag}(A).\n$$\n设双网格误差传播矩阵为\n$$\nE = \\bigl(I - P A_{c}^{-1} R A\\bigr)\\, S.\n$$\n精确计算谱半径 $\\rho(E)$，并以精确数（无四舍五入）的形式给出最终答案。答案无单位，且必须是单个实数。", "solution": "所述问题是数学上适定的，并为求得唯一解提供了所有必要信息。我们需要计算一个特定定义的矩阵的谱半径。题目给出的已知条件是：\n细网格系统矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$：\n$$\nA = \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}\n$$\n插值算子 $P \\in \\mathbb{R}^{3 \\times 1}$：\n$$\nP = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n限制算子是插值算子的转置，$R = P^{\\top}$。粗网格算子由Galerkin投影定义，$A_{c} = R A P$。平滑算子是权重为 $\\omega = \\frac{2}{3}$ 的加权Jacobi迭代，得到平滑算子 $S = I - \\omega D^{-1} A$，其中 $D = \\operatorname{diag}(A)$。双网格误差传播矩阵被明确定义为 $E = \\bigl(I - P A_{c}^{-1} R A\\bigr)\\, S$。\n\n必须指出的是，题目文本指定了“一步后平滑”，其误差传播矩阵通常写作 $S \\bigl(I - P A_{c}^{-1} R A\\bigr)$。所给出的公式 $E = \\bigl(I - P A_{c}^{-1} R A\\bigr)S$ 对应于一步前平滑。然而，$E$ 的定义是明确且无歧义的，因此我们将按照给定的定义进行计算。对于方阵而言，$XY$ 和 $YX$ 的谱半径相同，所以这个术语上的不准确之处不会影响最终结果。\n\n计算过程分几步进行。\n\n首先，我们计算平滑算子 $S$。对角矩阵 $D$ 是：\n$$\nD = \\operatorname{diag}(A) = \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & 2 & 0 \\\\\n0 & 0 & 2\n\\end{pmatrix} = 2I\n$$\n其逆矩阵为 $D^{-1} = \\frac{1}{2}I$。\n使用松弛权重 $\\omega = \\frac{2}{3}$，平滑算子 $S$ 是：\n$$\nS = I - \\omega D^{-1} A = I - \\frac{2}{3} \\left(\\frac{1}{2}I\\right) A = I - \\frac{1}{3} A\n$$\n$$\nS = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} = \\begin{pmatrix} 1-\\frac{2}{3} & \\frac{1}{3} & 0 \\\\ \\frac{1}{3} & 1-\\frac{2}{3} & \\frac{1}{3} \\\\ 0 & \\frac{1}{3} & 1-\\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & 0 \\\\ \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{3} \\\\ 0 & \\frac{1}{3} & \\frac{1}{3} \\end{pmatrix}\n$$\n\n接下来，我们构造粗网格校正算子，记为 $C = I - P A_{c}^{-1} R A$。\n限制算子 $R$ 是：\n$$\nR = P^{\\top} = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix}\n$$\n粗网格算子 $A_c$ 是一个 $1 \\times 1$ 矩阵：\n$$\nA_{c} = R A P = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 2 & -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = [2]\n$$\n其逆为 $A_c^{-1} = [\\frac{1}{2}]$。\n现在我们计算项 $P A_c^{-1} R A$：\n$$\nP A_c^{-1} R = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} [\\frac{1}{2}] \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n$$\nP A_c^{-1} R A = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ -\\frac{1}{2} & 1 & -\\frac{1}{2} \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n因此，粗网格校正算子 $C$ 是：\n$$\nC = I - P A_c^{-1} R A = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 & 0 \\\\ -\\frac{1}{2} & 1 & -\\frac{1}{2} \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\frac{1}{2} & 0 & \\frac{1}{2} \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\n现在我们计算双网格误差传播矩阵 $E = C S$：\n$$\nE = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\frac{1}{2} & 0 & \\frac{1}{2} \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & 0 \\\\ \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{3} \\\\ 0 & \\frac{1}{3} & \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix}\n1 \\cdot \\frac{1}{3} & 1 \\cdot \\frac{1}{3} & 0 \\\\\n\\frac{1}{2} \\cdot \\frac{1}{3} & \\frac{1}{2} \\cdot \\frac{1}{3} + \\frac{1}{2} \\cdot \\frac{1}{3} & \\frac{1}{2} \\cdot \\frac{1}{3} \\\\\n0 & 1 \\cdot \\frac{1}{3} & 1 \\cdot \\frac{1}{3}\n\\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{3} & 0 \\\\ \\frac{1}{6} & \\frac{1}{3} & \\frac{1}{6} \\\\ 0 & \\frac{1}{3} & \\frac{1}{3} \\end{pmatrix}\n$$\n\n最后，我们通过求解 $E$ 的特征值来计算其谱半径 $\\rho(E)$。特征方程为 $\\det(E - \\lambda I) = 0$。\n$$\n\\det\\begin{pmatrix} \\frac{1}{3}-\\lambda & \\frac{1}{3} & 0 \\\\ \\frac{1}{6} & \\frac{1}{3}-\\lambda & \\frac{1}{6} \\\\ 0 & \\frac{1}{3} & \\frac{1}{3}-\\lambda \\end{pmatrix} = 0\n$$\n为了简化计算，我们先求解 $3E$ 的特征值 $\\mu$，其中 $\\lambda = \\mu/3$。\n$$\n3E = \\begin{pmatrix} 1 & 1 & 0 \\\\ \\frac{1}{2} & 1 & \\frac{1}{2} \\\\ 0 & 1 & 1 \\end{pmatrix}\n$$\n特征方程为 $\\det(3E - \\mu I) = 0$：\n$$\n\\det\\begin{pmatrix} 1-\\mu & 1 & 0 \\\\ \\frac{1}{2} & 1-\\mu & \\frac{1}{2} \\\\ 0 & 1 & 1-\\mu \\end{pmatrix} = 0\n$$\n$$\n(1-\\mu) \\left| \\begin{matrix} 1-\\mu & \\frac{1}{2} \\\\ 1 & 1-\\mu \\end{matrix} \\right| - 1 \\left| \\begin{matrix} \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1-\\mu \\end{matrix} \\right| = 0\n$$\n$$\n(1-\\mu)\\left( (1-\\mu)^2 - \\frac{1}{2} \\right) - \\left( \\frac{1}{2}(1-\\mu) \\right) = 0\n$$\n$$\n(1-\\mu)\\left( (1-\\mu)^2 - \\frac{1}{2} - \\frac{1}{2} \\right) = 0\n$$\n$$\n(1-\\mu)\\left( (1-\\mu)^2 - 1 \\right) = 0\n$$\n该方程得出 $\\mu$ 的三个解：\n1. $1-\\mu = 0 \\implies \\mu_1 = 1$.\n2. $(1-\\mu)^2 - 1 = 0 \\implies (1-\\mu)^2 = 1 \\implies 1-\\mu = \\pm 1$.\n   - $1-\\mu = 1 \\implies \\mu_2 = 0$.\n   - $1-\\mu = -1 \\implies \\mu_3 = 2$.\n\n$3E$ 的特征值为 $\\{0, 1, 2\\}$。$E$ 的特征值为 $\\lambda_i = \\mu_i/3$，所以它们是 $\\{\\frac{0}{3}, \\frac{1}{3}, \\frac{2}{3}\\} = \\{0, \\frac{1}{3}, \\frac{2}{3}\\}$。\n\n谱半径 $\\rho(E)$ 是特征值绝对值的最大值：\n$$\n\\rho(E) = \\max\\left(|0|, \\left|\\frac{1}{3}\\right|, \\left|\\frac{2}{3}\\right|\\right) = \\frac{2}{3}\n$$", "answer": "$$\n\\boxed{\\frac{2}{3}}\n$$", "id": "2372552"}, {"introduction": "在精确算术的世界里，伽辽金（Galerkin）粗网格算子 $A_c = R A P$ 会继承 $A$ 的优良性质，例如对称正定性。然而，现实中的计算机使用浮点运算，这会引入微妙的误差。这个高级练习 [@problem_id:2372482] 深入探讨了粗化过程的数值稳定性，挑战你确定在何种条件下舍入误差会导致灾难性失败，从而让你深刻体会到数值理论与稳健实施之间的差距。", "problem": "考虑将带有V循环的代数多重网格 (AMG) 应用于一个对称正定线性系统。粗网格算子通过 Galerkin 三重积 $A_{c} = R A P$ 构建，其中 $R = P^{\\top}$。设细网格系统矩阵为参数化族\n$$\nA(\\varepsilon) = v v^{\\top} + \\varepsilon I_{3},\n$$\n其中 $v = (\\,1,\\,1,\\,0\\,)^{\\top}$，$\\varepsilon > 0$，$I_{3}$ 是 $3 \\times 3$ 的单位矩阵。设延拓算子为 $3 \\times 2$ 矩阵\n$$\nP = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 0\n\\end{pmatrix},\n$$\n并取限制算子为 $R = P^{\\top}$。代码通过标准的三重嵌套循环矩阵乘法公式仅构造 $A_{c}$ 的上三角元，\n$$\n(A_{c})_{ij} = \\sum_{p=1}^{3} \\sum_{q=1}^{3} R_{i p}\\, A_{p q}\\, P_{q j} \\quad \\text{for } i \\leq j,\n$$\n然后将 $(A_{c})_{ij}$ 精确地复制到 $(A_{c})_{ji}$。假设每次浮点乘法都进行就近舍入，并遵循标准相对误差模型 $\\operatorname{fl}(x y) = (x y)(1+\\delta)$，其中 $|\\delta| \\leq u$，$u$ 是单位舍入误差。与零的加法和最终的对称复制是精确的。不发生其他舍入误差。\n\n将“V-循环的灾难性失效”定义为计算出的粗网格算子在粗网格上失去对称正定性，等价于其行列式为非正值。\n\n确定作为 $u$ 的函数的最小 $\\varepsilon > 0$，使得存在可接受的舍入误差（在用于构建 $A_{c}$ 的乘法中，满足 $|\\delta| \\leq u$），从而导致计算出的 $A_{c}$ 非正定。为这个临界 $\\varepsilon$ 提供一个关于 $u$ 的闭式解析表达式，并且不要对你的答案进行舍入。", "solution": "问题陈述已经过验证，并被认为是科学上合理的、适定的和客观的。它代表了数值分析中一个关于代数多重网格方法在浮点运算下的稳定性的可解问题。我现在开始解答。\n\n细网格系统矩阵由 $\\varepsilon > 0$ 的族 $A(\\varepsilon)$ 给出：\n$$\nA(\\varepsilon) = v v^{\\top} + \\varepsilon I_{3}\n$$\n其中 $v = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 且 $I_3$ 是 $3 \\times 3$ 的单位矩阵。\n首先，我们构建矩阵 $v v^{\\top}$：\n$$\nv v^{\\top} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 0 \\\\ 1 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n因此，细网格矩阵 $A(\\varepsilon)$ 是：\n$$\nA(\\varepsilon) = \\begin{pmatrix} 1 & 1 & 0 \\\\ 1 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\varepsilon \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1+\\varepsilon & 1 & 0 \\\\ 1 & 1+\\varepsilon & 0 \\\\ 0 & 0 & \\varepsilon \\end{pmatrix}\n$$\n对于 $\\varepsilon > 0$，该矩阵是对称正定的 (SPD)。它的特征值是 $\\varepsilon$、$2+\\varepsilon$ 和 $0+\\varepsilon=\\varepsilon$。由于所有特征值均为正值，所以 $A(\\varepsilon)$ 是对称正定的。\n\n粗网格算子 $A_c$ 通过 Galerkin 乘积 $A_c = R A(\\varepsilon) P$ 构建。延拓算子 $P$ 和限制算子 $R$ 由下式给出：\n$$\nP = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad R = P^{\\top} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\n在精确算术中，粗网格算子为：\n$$\nA_c = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1+\\varepsilon & 1 & 0 \\\\ 1 & 1+\\varepsilon & 0 \\\\ 0 & 0 & \\varepsilon \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1+\\varepsilon & 1 \\\\ 1 & 1+\\varepsilon \\end{pmatrix}\n$$\n精确 $A_c$ 的行列式为 $\\det(A_c) = (1+\\varepsilon)^2 - 1 = \\varepsilon^2 + 2\\varepsilon$。对于 $\\varepsilon > 0$，$\\det(A_c) > 0$。其迹为 $2(1+\\varepsilon) > 0$。因此，精确的 $A_c$ 也如预期一样是对称正定的。\n\n我们现在分析在浮点运算中 $A_c$ 的计算。设 $\\tilde{A}_c$ 为计算出的矩阵。问题陈述，对于 $i \\leq j$，上三角元 $(\\tilde{A}_c)_{ij}$ 使用以下公式计算：\n$$\n(\\tilde{A}_c)_{ij} = \\sum_{p=1}^{3} \\sum_{q=1}^{3} \\operatorname{fl}(R_{ip} A_{pq} P_{qj})\n$$\n其中求和本身是精确的，因为与零的加法是精确的，并且对于这个特定问题，每个和中最多只有一个非零项。乘积 $R_{ip} A_{pq} P_{qj}$ 涉及两次乘法。遵循指定的误差模型 $\\operatorname{fl}(xy) = xy(1+\\delta)$ 且 $|\\delta| \\leq u$，将三重积 $xyz$ 计算为 $\\operatorname{fl}(\\operatorname{fl}(xy)z)$ 的结果是：\n$$\n\\operatorname{fl}(xyz) = ((xy)(1+\\delta_1)z)(1+\\delta_2) = xyz(1+\\delta_1)(1+\\delta_2)\n$$\n其中 $|\\delta_1|, |\\delta_2| \\leq u$。误差因子 $(1+\\delta_1)(1+\\delta_2)$ 位于区间 $[(1-u)^2, (1+u)^2]$ 内。\n\n让我们计算 $\\tilde{A}_c$ 的元素：\n对于 $(\\tilde{A}_c)_{11}$ ($i=1, j=1$)：和中唯一的非零项是当 $p=1, q=1$ 时。该项是 $R_{11}A_{11}P_{11} = 1 \\cdot (1+\\varepsilon) \\cdot 1 = 1+\\varepsilon$。其计算值为：\n$$\n(\\tilde{A}_c)_{11} = (1+\\varepsilon)(1+\\delta_a)(1+\\delta_b)\n$$\n我们可以选择 $\\delta_a, \\delta_b \\in [-u, u]$ 以产生在 $[(1+\\varepsilon)(1-u)^2, (1+\\varepsilon)(1+u)^2]$ 范围内的任何值。\n\n对于 $(\\tilde{A}_c)_{22}$ ($i=2, j=2$)：唯一的非零项是当 $p=2, q=2$ 时。该项是 $R_{22}A_{22}P_{22} = 1 \\cdot (1+\\varepsilon) \\cdot 1 = 1+\\varepsilon$。其计算值为：\n$$\n(\\tilde{A}_c)_{22} = (1+\\varepsilon)(1+\\delta_c)(1+\\delta_d)\n$$\n其值在 $[(1+\\varepsilon)(1-u)^2, (1+\\varepsilon)(1+u)^2]$ 范围内。\n\n对于 $(\\tilde{A}_c)_{12}$ ($i=1, j=2$)：唯一的非零项是当 $p=1, q=2$ 时。该项是 $R_{11}A_{12}P_{22} = 1 \\cdot 1 \\cdot 1 = 1$。其计算值为：\n$$\n(\\tilde{A}_c)_{12} = 1 \\cdot (1+\\delta_e)(1+\\delta_f)\n$$\n其值在 $[(1-u)^2, (1+u)^2]$ 范围内。\n\n下三角元 $(\\tilde{A}_c)_{21}$ 是 $(\\tilde{A}_c)_{12}$ 的精确复制。因此，计算出的矩阵 $\\tilde{A}_c$ 是对称的：\n$$\n\\tilde{A}_c = \\begin{pmatrix} (1+\\varepsilon)(1+\\delta_{11}) & 1 \\cdot (1+\\delta_{12}) \\\\ 1 \\cdot (1+\\delta_{12}) & (1+\\varepsilon)(1+\\delta_{22}) \\end{pmatrix}\n$$\n其中每个因子 $(1+\\delta_{ij})$ 代表一个形如 $(1+\\delta_1)(1+\\delta_2)$ 的项，并且位于 $[(1-u)^2, (1+u)^2]$ 区间内。\n\n如果 $\\tilde{A}_c$ 非正定，则发生“灾难性失效”。由于 $\\tilde{A}_c$ 是对称的，我们检查它的迹和行列式。\n其迹为 $\\operatorname{Tr}(\\tilde{A}_c) = (1+\\varepsilon)((1+\\delta_{11}) + (1+\\delta_{22}))$。由于 $\\varepsilon > 0$，所以 $(1+\\varepsilon) > 1$。对于典型的、小的单位舍入误差 $u$，误差因子 $(1+\\delta_{ii}) \\geq (1-u)^2 > 0$。因此，迹是正的。\n因此，失效必定源于一个非正的行列式：$\\det(\\tilde{A}_c) \\leq 0$。\n$$\n\\det(\\tilde{A}_c) = (1+\\varepsilon)^2 (1+\\delta_{11})(1+\\delta_{22}) - (1 \\cdot (1+\\delta_{12}))^2 \\leq 0\n$$\n这个不等式可以改写为：\n$$\n(1+\\varepsilon)^2 \\leq \\frac{(1+\\delta_{12})^2}{(1+\\delta_{11})(1+\\delta_{22})}\n$$\n对于给定的 $\\varepsilon > 0$，如果存在满足此条件的允许舍入误差，则可能发生失效。为了找到使之成为可能的最小 $\\varepsilon$，我们必须找到不等式右侧的最大可能值。这对应于“最坏情况”的舍入场景。\n\n当分子 $(1+\\delta_{12})^2$ 被最大化且分母 $(1+\\delta_{11})(1+\\delta_{22})$ 被最小时，右侧达到最大值。舍入误差因子 $(1+\\delta_{ij})$ 是独立的，且位于 $[(1-u)^2, (1+u)^2]$ 区间内。\n- 最大化分子：选择 $(1+\\delta_{12}) = (1+u)^2$。\n- 最小化分母：选择 $(1+\\delta_{11}) = (1-u)^2$ 和 $(1+\\delta_{22}) = (1-u)^2$。\n\n代入这些最坏情况的值，得到可能发生失效的条件：\n$$\n(1+\\varepsilon)^2 \\leq \\frac{((1+u)^2)^2}{((1-u)^2)((1-u)^2)} = \\frac{(1+u)^4}{(1-u)^4} = \\left(\\frac{1+u}{1-u}\\right)^4\n$$\n对两边取平方根（所有项都为正）：\n$$\n1+\\varepsilon \\leq \\left(\\frac{1+u}{1-u}\\right)^2\n$$\n解出 $\\varepsilon$：\n$$\n\\varepsilon \\leq \\left(\\frac{1+u}{1-u}\\right)^2 - 1 = \\frac{(1+u)^2 - (1-u)^2}{(1-u)^2} = \\frac{(1+2u+u^2) - (1-2u+u^2)}{(1-u)^2} = \\frac{4u}{(1-u)^2}\n$$\n这意味着灾难性失效是可能的，当且仅当 $0 < \\varepsilon \\leq \\frac{4u}{(1-u)^2}$。对于任何大于此值的 $\\varepsilon$，无论具体的舍入误差如何，$\\det(\\tilde{A}_c)$ 都保证为正。\n\n问题要求的是可能发生失效的“最小 $\\varepsilon > 0$”。此类 $\\varepsilon$ 的集合是区间 $(0, \\frac{4u}{(1-u)^2}]$。这个集合不包含最小元；其下确界是 0。然而，答案为 0 将与 $u$ 无关且在物理上是无意义的，这表明它不是预期的答案。在科学背景下，对这类问题的标准解释是要求确定定义失效区域边界的临界阈值。这个临界值是该集合的上确界，即 $\\varepsilon_{crit} = \\frac{4u}{(1-u)^2}$。这个值代表了灾难性失效在计算上成为可能的 $\\varepsilon$ 的最大值。这正是问题所寻求的关于 $u$ 的合适的、非平凡的函数。", "answer": "$$\n\\boxed{\\frac{4u}{(1-u)^{2}}}\n$$", "id": "2372482"}]}