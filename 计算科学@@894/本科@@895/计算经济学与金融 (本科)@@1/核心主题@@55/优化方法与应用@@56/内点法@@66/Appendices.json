{"hands_on_practices": [{"introduction": "在内点法的每一次迭代中，一个至关重要的步骤是选择一个合适的步长 $\\alpha$，以确保下一个迭代点仍然严格位于可行域的内部。这个练习将带你亲手计算最大允许步长，这是一个被称为“比率测试”的基本操作。通过这个练习 [@problem_id:2402737]，你将理解算法如何通过仔细的步长选择来避免违反非负性约束，从而保证其稳定性。", "id": "2402737", "problem": "考虑一个包含非负性、预算和最低期望收益约束的双资产凸投资组合选择问题：\n在 $x \\in \\mathbb{R}^2$ 上最小化目标函数 $ \\tfrac{1}{2} x^{\\top} Q x $，约束条件为 $ \\mathbf{1}^{\\top} x = 1 $，$ r^{\\top} x \\ge r_{\\min} $ 和 $ x \\ge 0 $，其中 $Q \\in \\mathbb{R}^{2 \\times 2}$ 是正定矩阵，$r \\in \\mathbb{R}^2$，$r_{\\min} \\in \\mathbb{R}$，且 $x \\ge 0$ 是逐分量的不等式。考虑一种使用对数障碍表示不等式的原始-对偶内点法，其中收益约束通过松弛变量 $ y = r^{\\top} x - r_{\\min} > 0 $ 实现，非负性通过 $ x > 0 $ 实现，且与这些不等式相关的对偶变量满足 $ s > 0 $ (与 $ x \\ge 0 $ 相关) 和 $ z > 0 $ (与 $ y \\ge 0 $ 相关)。在某次迭代中，该方法具有以下严格可行值\n$ x = \\begin{bmatrix} 0.05 \\\\ 0.95 \\end{bmatrix},\\quad y = 0.04,\\quad s = \\begin{bmatrix} 5.0 \\\\ 0.2 \\end{bmatrix},\\quad z = 0.5, $\n以及计算出的原始-对偶牛顿方向\n$ \\Delta x = \\begin{bmatrix} -0.12 \\\\ 0.06 \\end{bmatrix},\\quad \\Delta y = -0.03,\\quad \\Delta s = \\begin{bmatrix} -1.0 \\\\ 0.5 \\end{bmatrix},\\quad \\Delta z = 0.2. $\n假设一个长步路径跟踪策略提出了一个试探步长 $ \\alpha_{\\text{pred}} = 0.9 $。为了在下一次迭代中保持严格内部可行性，所有更新后的量必须保持为正：\n$ x + \\alpha \\Delta x > 0,\\quad y + \\alpha \\Delta y > 0,\\quad s + \\alpha \\Delta s > 0,\\quad z + \\alpha \\Delta z > 0. $\n关于保持正性的最大容许步长 $ \\alpha $ 以及其对所提出的长步 $ \\alpha_{\\text{pred}} $ 的影响，以下哪个陈述是正确的？\n\nA. 最大容许 $ \\alpha $ 等于 $ 1 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 是可行的。\n\nB. 最大容许 $ \\alpha $ 约为 $ 0.42 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 会违反可行性。\n\nC. 最大容许 $ \\alpha $ 约为 $ 0.67 $，因此 $ \\alpha_{\\text{pred}} = 0.9 $ 会违反可行性。\n\nD. 任何 $ \\alpha \\in (0,1] $ 都能保持正性，因为方向向量的所有分量都使其对应的变量增加。", "solution": "首先对问题陈述进行验证。\n\n步骤 1：提取已知条件\n问题描述了用于求解凸投资组合选择问题的原始-对偶内点法。\n优化问题为：\n$$ \\text{minimize} \\quad \\frac{1}{2} x^{\\top} Q x $$\n$$ \\text{subject to} \\quad \\mathbf{1}^{\\top} x = 1, \\quad r^{\\top} x \\ge r_{\\min}, \\quad x \\ge 0 $$\n其中 $x \\in \\mathbb{R}^2$，$Q \\in \\mathbb{R}^{2 \\times 2}$ 是正定矩阵，$r \\in \\mathbb{R}^2$，$r_{\\min} \\in \\mathbb{R}$。\n不等式约束通过引入松弛变量的对数障碍法来处理。\n非负性约束 $x \\ge 0$ 被强制为 $x > 0$。\n最低收益约束 $r^{\\top} x \\ge r_{\\min}$ 通过松弛变量 $y$ 被强制为 $y = r^{\\top} x - r_{\\min} > 0$。\n与这些不等式相关的对偶变量为 $s > 0$ (对应 $x > 0$) 和 $z > 0$ (对应 $y > 0$)。\n\n在某次迭代中，严格可行值为：\n$$ x = \\begin{bmatrix} 0.05 \\\\ 0.95 \\end{bmatrix}, \\quad y = 0.04, \\quad s = \\begin{bmatrix} 5.0 \\\\ 0.2 \\end{bmatrix}, \\quad z = 0.5 $$\n计算出的原始-对偶牛顿方向为：\n$$ \\Delta x = \\begin{bmatrix} -0.12 \\\\ 0.06 \\end{bmatrix}, \\quad \\Delta y = -0.03, \\quad \\Delta s = \\begin{bmatrix} -1.0 \\\\ 0.5 \\end{bmatrix}, \\quad \\Delta z = 0.2 $$\n提出的试探步长为：$\\alpha_{\\text{pred}} = 0.9$。\n对于步长 $\\alpha > 0$，保持严格内部可行性的条件是：\n$$ x + \\alpha \\Delta x > 0 $$\n$$ y + \\alpha \\Delta y > 0 $$\n$$ s + \\alpha \\Delta s > 0 $$\n$$ z + \\alpha \\Delta z > 0 $$\n问题是确定最大容许步长 $\\alpha$ 并评估 $\\alpha_{\\text{pred}}$ 的可行性。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。它展示了内点法在二次规划中的一个标准应用场景，这是计算金融和优化理论的基石。\n该问题是适定的。它要求计算最大步长，这是一个在给定迭代点和搜索方向下的明确定义的程序。所有必要的数据都已提供。\n该问题是客观的。其语言精确且数学化，没有歧义或主观陈述。\n问题设置是自成体系且一致的。未检测到任何缺陷。\n\n步骤 3：结论与行动\n该问题有效。将推导解答。\n\n目标是找到最大步长 $\\alpha > 0$，使得所有变量在步进后保持严格为正。对于一个通用的变量-方向对 $(v, \\Delta v)$，条件是 $v + \\alpha \\Delta v > 0$。这个不等式必须对 $x, y, s, z$ 的所有分量都成立。\n\n如果搜索方向的某个分量（例如 $\\Delta v_i$）是非负的（$\\Delta v_i \\ge 0$），且对应的变量 $v_i$ 严格为正（$v_i > 0$），那么对于任何 $\\alpha > 0$，更新后的变量 $v_i + \\alpha \\Delta v_i$ 将保持为正。这样的分量对 $\\alpha$ 不施加任何上限。\n\n如果搜索方向的某个分量是负的（$\\Delta v_i < 0$），不等式 $v_i + \\alpha \\Delta v_i > 0$ 意味着 $v_i > -\\alpha \\Delta v_i$，整理后得到 $\\alpha < v_i / (-\\Delta v_i)$。这对 $\\alpha$ 施加了一个上限。\n\n我们记最大容许步长为 $\\alpha_{\\max}$，它是从所有具有负方向分量计算出的此类上限中的最小值。\n\n让我们分析每个约束：\n\n1.  对 $x$ 的约束：$x + \\alpha \\Delta x > 0$。\n    分量为 $x_1 = 0.05$ 对应 $\\Delta x_1 = -0.12$，以及 $x_2 = 0.95$ 对应 $\\Delta x_2 = 0.06$。\n    对于第一个分量，由于 $\\Delta x_1 < 0$：\n    $$ 0.05 + \\alpha(-0.12) > 0 \\implies 0.05 > 0.12\\alpha \\implies \\alpha < \\frac{0.05}{0.12} = \\frac{5}{12} $$\n    数值上，$\\alpha < 0.4166...$。\n    对于第二个分量，由于 $\\Delta x_2 > 0$，条件 $0.95 + \\alpha(0.06) > 0$ 对所有 $\\alpha > 0$ 均成立。\n\n2.  对 $y$ 的约束：$y + \\alpha \\Delta y > 0$。\n    值为 $y = 0.04$，方向为 $\\Delta y = -0.03$。由于 $\\Delta y < 0$：\n    $$ 0.04 + \\alpha(-0.03) > 0 \\implies 0.04 > 0.03\\alpha \\implies \\alpha < \\frac{0.04}{0.03} = \\frac{4}{3} $$\n    数值上，$\\alpha < 1.333...$。\n\n3.  对 $s$ 的约束：$s + \\alpha \\Delta s > 0$。\n    分量为 $s_1 = 5.0$ 对应 $\\Delta s_1 = -1.0$，以及 $s_2 = 0.2$ 对应 $\\Delta s_2 = 0.5$。\n    对于第一个分量，由于 $\\Delta s_1 < 0$：\n    $$ 5.0 + \\alpha(-1.0) > 0 \\implies 5.0 > \\alpha \\implies \\alpha < 5.0 $$\n    对于第二个分量，由于 $\\Delta s_2 > 0$，条件 $0.2 + \\alpha(0.5) > 0$ 对所有 $\\alpha > 0$ 均成立。\n\n4.  对 $z$ 的约束：$z + \\alpha \\Delta z > 0$。\n    值为 $z = 0.5$，方向为 $\\Delta z = 0.2$。由于 $\\Delta z > 0$，条件 $0.5 + \\alpha(0.2) > 0$ 对所有 $\\alpha > 0$ 均成立。\n\n为确保所有正性约束都得到满足，$\\alpha$ 必须小于所有推导出的上限的最小值：\n$$ \\alpha_{\\max} = \\min\\left(\\frac{5}{12}, \\frac{4}{3}, 5.0\\right) $$\n$$ \\alpha_{\\max} = \\min(0.4166..., 1.333..., 5.0) $$\n$$ \\alpha_{\\max} = \\frac{5}{12} \\approx 0.4167 $$\n保持严格正性的最大容许步长是任何 $\\alpha \\in (0, \\alpha_{\\max})$。$\\alpha_{\\max}$ 本身会导致一个变量 ($x_1$) 变为恰好为零，这违反了内点法所要求的*严格*正性。问题要求“最大容许步长”，这被解释为上确界 $\\alpha_{\\max}$。四舍五入到两位小数得到 $0.42$。\n\n提出的试探步长是 $\\alpha_{\\text{pred}} = 0.9$。我们将其与计算出的最大值进行比较：\n$$ 0.9 > \\frac{5}{12} \\approx 0.4167 $$\n由于 $\\alpha_{\\text{pred}}$ 大于最大容许步长 $\\alpha_{\\max}$，采用这样的步长会违反下一次迭代的可行性。具体来说，$x$ 的第一个分量会变为负数：\n$$ x_1 + \\alpha_{\\text{pred}} \\Delta x_1 = 0.05 + (0.9)(-0.12) = 0.05 - 0.108 = -0.058 < 0 $$\n\n现在，我们评估给定的选项。\n\nA. 最大容许 $\\alpha$ 等于 $1$，因此 $\\alpha_{\\text{pred}} = 0.9$ 是可行的。\n这是不正确的。最大容许 $\\alpha$ 约为 $0.42$，而不是 $1$。因此，$\\alpha_{\\text{pred}} = 0.9$ 是不可行的。\n\nB. 最大容许 $\\alpha$ 约为 $0.42$，因此 $\\alpha_{\\text{pred}} = 0.9$ 会违反可行性。\n这是正确的。我们的计算表明 $\\alpha_{\\max} = 5/12 \\approx 0.4167$，约等于 $0.42$。并且由于 $0.9 > 0.42$，所提出的步长违反了正性条件。\n\nC. 最大容许 $\\alpha$ 约为 $0.67$，因此 $\\alpha_{\\text{pred}} = 0.9$ 会违反可行性。\n这是不正确的。最大容许 $\\alpha$ 的值约为 $0.42$，而不是 $0.67$。数字 $0.67$ 约等于 $2/3$，它并未出现在我们的计算中。\n\nD. 任何 $\\alpha \\in (0,1]$ 都能保持正性，因为方向向量的所有分量都使其对应的变量增加。\n这是不正确的。简单检查方向向量就会发现，有几个分量是负的（$\\Delta x_1 = -0.12, \\Delta y = -0.03, \\Delta s_1 = -1.0$），这意味着它们会减小相应的变量。这个陈述在事实上是错误的。\n\n因此，唯一正确的陈述是 B。", "answer": "$$\\boxed{B}$$"}, {"introduction": "牛顿步是驱动内点法向最优解收敛的核心引擎。本练习将深入探讨这一核心机制，要求你计算牛顿递减量（Newton decrement），它衡量了在给定势垒参数下，当前点与中心路径上“目标点”的接近程度。完成这个计算 [@problem_id:2402656]，你将能更好地理解内点法如何量化迭代的进展，并将其作为判断收敛与否的关键指标。", "id": "2402656", "problem": "考虑一个由 $n=3$ 种资产构成的投资组合，其分配向量为 $w \\in \\mathbb{R}^3_{++}$，期望收益向量为 $r \\in \\mathbb{R}^3$。目标是最大化投资组合的香农熵 $-\\sum_{i=1}^3 w_i \\ln(w_i)$，同时满足预算约束和目标期望收益率约束。等价地，这可以表述为最小化问题\n$\\min_{w \\in \\mathbb{R}^3_{++}} \\sum_{i=1}^3 w_i \\ln(w_i)$\n其线性等式约束为 $1^{\\top}w = 1$ 和 $r^{\\top}w = \\mu$，其中 $\\ln(\\cdot)$ 表示自然对数。考虑将带有障碍尺度参数 $t>0$ 的内点法 (IPM) 应用于 $t \\sum_{i=1}^3 w_i \\ln(w_i)$ 的等式约束最小化问题。\n\n在当前迭代点，给定：\n- $r = \\begin{pmatrix}0.02 \\\\ 0.01 \\\\ 0.03\\end{pmatrix}$，\n- $\\mu = 0.02$，\n- $w^{(0)} = \\begin{pmatrix}0.4 \\\\ 0.4 \\\\ 0.2\\end{pmatrix}$，\n- $t = 10$，\n- 约束条件的当前对偶乘子为 $\\nu^{(0)} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n根据约束优化的基本原理和 $t$ 尺度问题的等式约束牛顿步长的定义（即，通过构造带有线性约束的拉格朗日函数，写出一阶最优性条件，并在给定迭代点对其进行线性化），计算牛顿减量平方\n$\\lambda^2 = \\Delta w^{\\top} \\nabla^2\\!\\big(t \\sum_{i=1}^3 w_i \\ln(w_i)\\big)\\, \\Delta w$\n在给定迭代点 $(w^{(0)}, \\nu^{(0)})$ 处的值，其中 $\\Delta w$ 是 $t$ 尺度问题在 $(w^{(0)}, \\nu^{(0)})$ 处的等式约束牛顿步长方向。将您的答案四舍五入到四位有效数字。", "solution": "所述问题是将内点法应用于凸优化问题的标准练习，具体是在线性约束下的熵最大化，这在投资组合理论中很常见。该问题是良态的、有科学依据的，并包含了所有必要信息。因此，它是有效的。\n\n我们的任务是为一个等式约束优化问题计算牛顿减量平方 $\\lambda^2$。目标函数为 $f_t(w) = t \\sum_{i=1}^3 w_i \\ln(w_i)$，其中 $t=10$。约束是线性的，可以写成矩阵形式 $Aw = b$。\n\n首先，我们将问题的各个组成部分形式化。\n目标函数为：\n$$ f_t(w) = 10 \\sum_{i=1}^3 w_i \\ln(w_i) $$\n约束条件为 $\\boldsymbol{1}^{\\top}w = 1$ 和 $r^{\\top}w = \\mu$。我们定义约束矩阵 $A$ 和向量 $b$ 如下：\n$$ A = \\begin{pmatrix} 1 & 1 & 1 \\\\ r_1 & r_2 & r_3 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 1 \\\\ 0.02 & 0.01 & 0.03 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ \\mu \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0.02 \\end{pmatrix} $$\n在给定的原始-对偶点 $(w, \\nu)$ 处的牛顿步长 $(\\Delta w, \\nu^{+})$ 是通过求解线性化的一阶最优性 (KKT) 条件得到的。KKT 系统是：\n$$ \\begin{pmatrix} \\nabla^2 f_t(w) & A^\\top \\\\ A & 0 \\end{pmatrix} \\begin{pmatrix} \\Delta w \\\\ \\nu^{+} \\end{pmatrix} = \\begin{pmatrix} -\\nabla f_t(w) \\\\ b \\end{pmatrix} $$\n该系统适用于可行起始点。由于我们给定的点 $w^{(0)}$ 不是可行的（即 $A w^{(0)} \\neq b$），我们求解同时走向可行性和最优性的步长：\n$$ \\begin{pmatrix} \\nabla^2 f_t(w^{(0)}) & A^\\top \\\\ A & 0 \\end{pmatrix} \\begin{pmatrix} \\Delta w \\\\ \\nu^{+} \\end{pmatrix} = \\begin{pmatrix} -\\nabla f_t(w^{(0)}) \\\\ b - A w^{(0)} \\end{pmatrix} $$\n这里，$\\nu^{+}$ 是对偶变量的下一个迭代值，我们直接计算它。问题陈述了 $\\nu^{(0)}=\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，但在标准的牛顿步长公式中并不直接需要这个值，除非也要计算 $\\nu$ 的步长。\n\n我们接下来计算在迭代点 $w^{(0)} = \\begin{pmatrix} 0.4 \\\\ 0.4 \\\\ 0.2 \\end{pmatrix}$ 处的必要分量。\n\n$f_t(w)$ 的梯度是 $\\nabla f_t(w) = t (\\boldsymbol{1} + \\ln(w))$，其中 $\\ln(w)$ 是逐元素应用的。\n$$ g = \\nabla f_t(w^{(0)}) = 10 \\begin{pmatrix} 1 + \\ln(0.4) \\\\ 1 + \\ln(0.4) \\\\ 1 + \\ln(0.2) \\end{pmatrix} \\approx \\begin{pmatrix} 10 \\times (1 - 0.91629) \\\\ 10 \\times (1 - 0.91629) \\\\ 10 \\times (1 - 1.60944) \\end{pmatrix} = \\begin{pmatrix} 0.8371 \\\\ 0.8371 \\\\ -6.0944 \\end{pmatrix} $$\n$f_t(w)$ 的 Hessian 矩阵是一个对角矩阵 $\\nabla^2 f_t(w) = t \\cdot \\text{diag}(1/w_1, \\dots, 1/w_n)$。\n$$ H = \\nabla^2 f_t(w^{(0)}) = 10 \\cdot \\text{diag}\\left(\\frac{1}{0.4}, \\frac{1}{0.4}, \\frac{1}{0.2}\\right) = \\text{diag}(25, 25, 50) $$\n逆 Hessian 矩阵是 $H^{-1} = \\text{diag}(1/25, 1/25, 1/50) = \\text{diag}(0.04, 0.04, 0.02)$。\n\n约束残差为：\n$$ r_{\\text{prim}} = b - A w^{(0)} = \\begin{pmatrix} 1 \\\\ 0.02 \\end{pmatrix} - \\begin{pmatrix} 1 & 1 & 1 \\\\ 0.02 & 0.01 & 0.03 \\end{pmatrix} \\begin{pmatrix} 0.4 \\\\ 0.4 \\\\ 0.2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0.02 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0.018 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0.002 \\end{pmatrix} $$\n从 KKT 系统中，我们首先可以解出 $\\nu^{+}$。\n$$ A \\Delta w = r_{\\text{prim}} $$\n$$ H \\Delta w + A^\\top \\nu^{+} = -g \\implies \\Delta w = -H^{-1}(g + A^\\top \\nu^{+}) $$\n将 $\\Delta w$ 代入第一个方程得到：\n$$ A(-H^{-1}(g + A^\\top \\nu^{+})) = r_{\\text{prim}} \\implies (A H^{-1} A^\\top) \\nu^{+} = -A H^{-1} g - r_{\\text{prim}} $$\n我们计算矩阵 $A H^{-1} A^\\top$：\n$$ A H^{-1} A^\\top = \\begin{pmatrix} 1 & 1 & 1 \\\\ 0.02 & 0.01 & 0.03 \\end{pmatrix} \\begin{pmatrix} 0.04 & 0 & 0 \\\\ 0 & 0.04 & 0 \\\\ 0 & 0 & 0.02 \\end{pmatrix} \\begin{pmatrix} 1 & 0.02 \\\\ 1 & 0.01 \\\\ 1 & 0.03 \\end{pmatrix} = \\begin{pmatrix} 0.1 & 0.0018 \\\\ 0.0018 & 0.000038 \\end{pmatrix} $$\n以及向量 $A H^{-1} g$：\n$$ A H^{-1} g = \\begin{pmatrix} 0.04 & 0.04 & 0.02 \\\\ 0.0008 & 0.0004 & 0.0006 \\end{pmatrix} \\begin{pmatrix} 0.8371 \\\\ 0.8371 \\\\ -6.0944 \\end{pmatrix} \\approx \\begin{pmatrix} -0.05492 \\\\ -0.002652 \\end{pmatrix} $$\n关于 $\\nu^{+}$ 的方程组为：\n$$ \\begin{pmatrix} 0.1 & 0.0018 \\\\ 0.0018 & 0.000038 \\end{pmatrix} \\nu^{+} = -\\begin{pmatrix} -0.05492 \\\\ -0.002652 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0.002 \\end{pmatrix} = \\begin{pmatrix} 0.05492 \\\\ 0.000652 \\end{pmatrix} $$\n解这个 $2 \\times 2$ 方程组得到 $\\nu^{+} \\approx \\begin{pmatrix} 1.6304 \\\\ -60.066 \\end{pmatrix}$。\n\n现在，我们计算牛顿步长 $\\Delta w$：\n$$ \\Delta w = -H^{-1}(g + A^\\top \\nu^{+}) $$\n$$ A^\\top \\nu^{+} \\approx \\begin{pmatrix} 1 & 0.02 \\\\ 1 & 0.01 \\\\ 1 & 0.03 \\end{pmatrix} \\begin{pmatrix} 1.6304 \\\\ -60.066 \\end{pmatrix} = \\begin{pmatrix} 1.6304 - 1.20132 \\\\ 1.6304 - 0.60066 \\\\ 1.6304 - 1.80198 \\end{pmatrix} = \\begin{pmatrix} 0.42908 \\\\ 1.02974 \\\\ -0.17158 \\end{pmatrix} $$\n$$ g + A^\\top \\nu^{+} \\approx \\begin{pmatrix} 0.8371 \\\\ 0.8371 \\\\ -6.0944 \\end{pmatrix} + \\begin{pmatrix} 0.42908 \\\\ 1.02974 \\\\ -0.17158 \\end{pmatrix} = \\begin{pmatrix} 1.26618 \\\\ 1.86684 \\\\ -6.26598 \\end{pmatrix} $$\n$$ \\Delta w = -\\begin{pmatrix} 0.04 \\\\ 0.04 \\\\ 0.02 \\end{pmatrix} \\odot \\begin{pmatrix} 1.26618 \\\\ 1.86684 \\\\ -6.26598 \\end{pmatrix} = \\begin{pmatrix} -0.0506472 \\\\ -0.0746736 \\\\ 0.1253196 \\end{pmatrix} $$\n最后，我们根据其定义计算牛顿减量平方 $\\lambda^2$：\n$$ \\lambda^2 = \\Delta w^{\\top} H \\Delta w $$\n$$ \\lambda^2 \\approx \\begin{pmatrix} -0.0506472 & -0.0746736 & 0.1253196 \\end{pmatrix} \\begin{pmatrix} 25 & 0 & 0 \\\\ 0 & 25 & 0 \\\\ 0 & 0 & 50 \\end{pmatrix} \\begin{pmatrix} -0.0506472 \\\\ -0.0746736 \\\\ 0.1253196 \\end{pmatrix} $$\n$$ \\lambda^2 \\approx 25(-0.0506472)^2 + 25(-0.0746736)^2 + 50(0.1253196)^2 $$\n$$ \\lambda^2 \\approx 25(0.00256514) + 25(0.00557615) + 50(0.0157050) $$\n$$ \\lambda^2 \\approx 0.0641285 + 0.13940375 + 0.78525 $$\n$$ \\lambda^2 \\approx 0.98878225 $$\n将结果四舍五入到四位有效数字，得到 $0.9888$。", "answer": "$$\\boxed{0.9888}$$"}, {"introduction": "并非所有的优化问题都存在可行解，一个稳健的算法必须能够检测并证明问题的不可行性。这个练习将向你展示，当内点法判定一个问题无解时，其输出的对偶变量并非无用，而是可以用来构造一个Farkas证书。通过构建这个证书 [@problem_id:2402685]，你将把算法的实际输出与优化理论中的一个基本定理——择一定理——联系起来，从而为不可行性提供一个严格的数学证明。", "id": "2402685", "problem": "考虑以线性规划形式表达的只做多投资组合可行性问题：寻找 $x \\in \\mathbb{R}^{3}$ 使得 $x \\geq \\mathbf{0}$ 且 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n1 & 1 & 1 \\\\\n0.10 & 0.20 & 0.15\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\\n0.22\n\\end{pmatrix}.\n$$\n第一行 $1 \\cdot x_{1} + 1 \\cdot x_{2} + 1 \\cdot x_{3} = 1$ 是预算约束，第二行 $0.10 x_{1} + 0.20 x_{2} + 0.15 x_{3} = 0.22$ 是目标预期收益率要求。将内点法应用于此可行性问题的齐次自对偶嵌入，算法终止并宣告问题不可行，同时返回一个近似的最终对偶迭代值\n$$\n\\tilde{y} \\;=\\; \\begin{pmatrix} 0.1997 \\\\ -1.0030 \\end{pmatrix}.\n$$\n利用 $\\tilde{y}$ 中的符号信息来固定一个归一化，构建一个满足 $A^{\\top} y \\geq \\mathbf{0}$ 和 $b^{\\top} y < 0$ 的 Farkas 不可行性证书 $y \\in \\mathbb{R}^{2}$，其归一化条件为 $y_{2} = -1$，并在这些不等式约束下选择尽可能小的 $y_{1}$。计算标量 $b^{\\top} y$。无需四舍五入；请提供精确值。", "solution": "该问题要求为给定的线性系统构建一个 Farkas 不可行性证书。可行性问题是寻找一个向量 $x \\in \\mathbb{R}^{3}$ 使得 $A x = b$ 且 $x \\geq \\mathbf{0}$。给定的矩阵为\n$$\nA \\;=\\; \\begin{pmatrix}\n1 & 1 & 1 \\\\\n0.10 & 0.20 & 0.15\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\\n0.22\n\\end{pmatrix}.\n$$\n根据 Farkas 引理（一个择一定理），系统 $A x = b, x \\geq \\mathbf{0}$ 不可行，当且仅当存在一个向量 $y \\in \\mathbb{R}^{2}$ 满足以下两个条件：\n1. $A^{\\top} y \\geq \\mathbf{0}$\n2. $b^{\\top} y < 0$\n这样的向量 $y$ 被称为 Farkas 不可行性证书。问题要求我们找到这样一个证书。\n\n首先，我们写出矩阵 $A$ 的转置：\n$$\nA^{\\top} \\;=\\; \\begin{pmatrix}\n1 & 0.10 \\\\\n1 & 0.20 \\\\\n1 & 0.15\n\\end{pmatrix}\n$$\n设证书向量为 $y = \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix}$。条件 $A^{\\top} y \\geq \\mathbf{0}$ 展开为一个包含三个线性不等式的系统：\n$$\n\\begin{pmatrix}\n1 & 0.10 \\\\\n1 & 0.20 \\\\\n1 & 0.15\n\\end{pmatrix}\n\\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\ny_{1} + 0.10 y_{2} \\\\\ny_{1} + 0.20 y_{2} \\\\\ny_{1} + 0.15 y_{2}\n\\end{pmatrix}\n\\;\\geq\\;\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给了我们：\n(i) $y_{1} + 0.10 y_{2} \\geq 0$\n(ii) $y_{1} + 0.20 y_{2} \\geq 0$\n(iii) $y_{1} + 0.15 y_{2} \\geq 0$\n\n第二个条件，$b^{\\top} y < 0$，变为：\n$$\nb^{\\top} y \\;=\\; \\begin{pmatrix} 1 & 0.22 \\end{pmatrix} \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix} \\;=\\; y_{1} + 0.22 y_{2} < 0\n$$\n\n问题为证书指定了一个归一化条件，$y_{2} = -1$。这个归一化与所提供的近似对偶迭代值 $\\tilde{y}$ 的符号结构是一致的。将 $y_{2} = -1$ 代入我们的不等式系统：\n(i) $y_{1} + 0.10(-1) \\geq 0 \\implies y_{1} \\geq 0.10$\n(ii) $y_{1} + 0.20(-1) \\geq 0 \\implies y_{1} \\geq 0.20$\n(iii) $y_{1} + 0.15(-1) \\geq 0 \\implies y_{1} \\geq 0.15$\n(iv) $y_{1} + 0.22(-1) < 0 \\implies y_{1} < 0.22$\n\n为了同时满足不等式 (i)、(ii) 和 (iii)，$y_{1}$ 必须大于或等于这些下界中的最大值：\n$$\ny_{1} \\geq \\max(0.10, 0.20, 0.15) = 0.20\n$$\n将此与不等式 (iv) 结合，我们得到关于 $y_{1}$ 的完整条件：\n$$\n0.20 \\leq y_{1} < 0.22\n$$\n问题要求我们选择尽可能小的 $y_{1}$。$y_{1}$ 的有效值集合是区间 $[0.20, 0.22)$。该集合中的最小值是其下界，$y_{1} = 0.20$。\n\n通过这个选择，我们的 Farkas 证书是：\n$$\ny = \\begin{pmatrix} y_{1} \\\\ y_{2} \\end{pmatrix} = \\begin{pmatrix} 0.20 \\\\ -1 \\end{pmatrix}\n$$\n我们必须验证这个向量满足所有条件。\n$A^{\\top}y = \\begin{pmatrix} 0.20 + 0.10(-1) \\\\ 0.20 + 0.20(-1) \\\\ 0.20 + 0.15(-1) \\end{pmatrix} = \\begin{pmatrix} 0.10 \\\\ 0 \\\\ 0.05 \\end{pmatrix}$，其每个分量都大于或等于 $\\mathbf{0}$。\n$b^{\\top}y = 0.20 + 0.22(-1) = 0.20 - 0.22 = -0.02$，这严格小于 $0$。\n两个条件都满足。\n\n最后的任务是计算标量 $b^{\\top} y$。我们已经计算出这个值。\n$$\nb^{\\top} y = 0.20 - 0.22 = -0.02\n$$\n或者，使用分数计算：\n$y_{1} \\geq \\max(\\frac{1}{10}, \\frac{1}{5}, \\frac{3}{20}) = \\frac{1}{5}$。\n$y_{1} < \\frac{22}{100} = \\frac{11}{50}$。\n最小值为 $y_{1} = \\frac{1}{5}$。\n$b^{\\top} y = y_{1} + \\frac{11}{50}y_{2} = \\frac{1}{5} + \\frac{11}{50}(-1) = \\frac{10}{50} - \\frac{11}{50} = -\\frac{1}{50}$。\n值 $-0.02$ 和 $-\\frac{1}{50}$ 是相同的。", "answer": "$$\\boxed{-0.02}$$"}]}