{"hands_on_practices": [{"introduction": "单纯形法的核心在于迭代改进。每一次迭代，即一次“主元变换”（pivot operation），都将我们从可行域的一个顶点移动到另一个相邻且更优的顶点。这个练习将带你亲手操作主元变换这一基本步骤，让你掌握驱动单纯形算法前进的引擎。[@problem_id:2221017]", "id": "2221017", "problem": "一家营销分析公司正在使用线性规划来确定客户广告预算的最优分配。目标是最大化客户覆盖率。决策变量是 $x_1$（在社交媒体上购买的广告单元数）和 $x_2$（在搜索引擎上购买的广告单元数）。该问题已被构建为一个标准的最大化问题，其初始单纯形表如下所示。变量 $s_1$ 和 $s_2$ 是松弛变量，分别代表未使用的预算和员工工时。变量 $Z$ 代表需要最大化的总客户覆盖率。\n\n单纯形表的各行对应目标函数 $Z$ 以及以 $s_1$ 和 $s_2$ 为基变量的两个约束条件。各列对应变量 $Z, x_1, x_2, s_1, s_2$ 和右端项 (RHS) 的值。\n\n初始单纯形表为：\n$$\n\\begin{array}{c|cccccc}\n\\text{基变量} & Z & x_1 & x_2 & s_1 & s_2 & \\text{右端项} \\\\\n\\hline\nZ & 1 & -5 & -4 & 0 & 0 & 0 \\\\\ns_1 & 0 & 10 & 8 & 1 & 0 & 80 \\\\\ns_2 & 0 & 2 & 3 & 0 & 1 & 24 \\\\\n\\end{array}\n$$\n\n根据标准最大化问题的单纯形算法，执行且仅执行一次完整的枢轴运算。确定经过更新后，Z行中 $x_2$ 的系数、Z行中 $s_1$ 的系数，以及目标函数 $Z$ 的新值（Z行的右端项值）。\n\n你的答案应为一组按指定顺序排列在行矩阵中的三个数值：（$x_2$ 的系数，$s_1$ 的系数，$Z$ 的值）。", "solution": "我们应用最大化问题的标准单纯形枢轴规则。\n\n1) 确定入基变量：在Z行中，决策变量中最小的负系数是 $x_{1}$ 对应的 $-5$，因此 $x_{1}$ 入基。\n\n2) 对 $x_{1}$ 列执行最小比值检验以选择出基变量：\n$$\n\\frac{80}{10}=8 \\quad \\text{对于 } s_{1}, \\qquad \\frac{24}{2}=12 \\quad \\text{对于 } s_{2}.\n$$\n最小比值为 $8$，因此 $s_{1}$ 出基。枢轴元素是 $s_{1}$ 行和 $x_{1}$ 列中的 $10$。\n\n3) 进行枢轴运算，使枢轴元素变为1，并从其他行中消去 $x_{1}$。\n\n将枢轴行（$s_{1}$ 行）除以 $10$ 进行归一化：\n$$\ns_{1}\\text{-行}: \\quad [0,\\;10,\\;8,\\;1,\\;0\\;|\\;80] \\;\\to\\; [0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8].\n$$\n\n将Z行加上 $5$ 倍的新 $s_{1}$ 行，以从Z行中消去 $x_{1}$：\n$$\nZ\\text{-行}: \\quad [1,\\;-5,\\;-4,\\;0,\\;0\\;|\\;0] + 5\\cdot[0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8]\n= [1,\\;0,\\;0,\\;\\tfrac{1}{2},\\;0\\;|\\;40].\n$$\n\n（从 $s_{2}$ 行中消去 $x_{1}$ 是完整枢轴运算的一部分，但对于本题所求的Z行系数而言，此步并非必要。）\n\n因此，在这次单次枢轴运算后，Z行中 $x_{2}$ 的系数是 $0$，$s_{1}$ 的系数是 $\\tfrac{1}{2}$，新的目标函数值 $Z$（Z行的右端项）是 $40$。", "answer": "$$\\boxed{\\begin{pmatrix}0 & \\frac{1}{2} & 40\\end{pmatrix}}$$"}, {"introduction": "在求得最优解之后，一个自然而然的问题是：“如果……会怎样？”。这个练习探讨了当一个资源约束（例如预算）发生变化时，最优解会如何响应。通过这个问题，你将接触到“影子价格”（shadow prices）这一强大概念，它量化了资源的边际价值，是单纯形法提供的关键经济洞见之一。[@problem_id:2443904]", "id": "2443904", "problem": "一位投资组合经理将资本分配到两种金融工具中，以最大化预期年净回报。决策变量为 $x_{1}$ 和 $x_{2}$，分别表示分配给工具1和工具2的资本，以统一的货币单位计量。该经理求解以下线性规划（LP）问题：\n\n最大化 $z = 5 x_{1} + 4 x_{2}$\n\n约束条件为\n$x_{1} + x_{2} \\leq 7$,\n$2 x_{1} + x_{2} \\leq 11$,\n$x_{1} \\geq 0$, $x_{2} \\geq 0$.\n\n该LP问题已被求解。最优基变量为 $x_{1}$ 和 $x_{2}$，其最优解为 $x_{1}^{\\star} = 4$，$x_{2}^{\\star} = 3$，最优目标值为 $z^{\\star} = 32$。与第一个和第二个约束相关的对偶变量（影子价格）分别为 $y_{1}^{\\star} = 3$ 和 $y_{2}^{\\star} = 1$。紧约束的基矩阵为 $B = \\begin{pmatrix} 1 & 1 \\\\ 2 & 1 \\end{pmatrix}$，其逆矩阵为 $B^{-1} = \\begin{pmatrix} -1 & 1 \\\\ 2 & -1 \\end{pmatrix}$。\n\n现在，假设预算约束的右端项（RHS）从 $7$ 增加到 $8$，而所有其他数据保持不变。\n\n使用灵敏度分析和所提供的解信息，确定目标函数的新最优值。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求在线性规划（LP）的一个约束的右端项（RHS）发生变化后，计算目标函数的新最优值。这是一个灵敏度分析中的标准问题。\n\n首先，我们将给定信息形式化。原LP问题是：\n最大化 $z = c^T x$\n约束条件为 $Ax \\leq b$ 和 $x \\geq 0$，\n其中 $c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$，$x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，$A = \\begin{pmatrix} 1 & 1 \\\\ 2 & 1 \\end{pmatrix}$，且 $b = \\begin{pmatrix} 7 \\\\ 11 \\end{pmatrix}$。\n\n初始最优解给定为 $x^{\\star} = \\begin{pmatrix} 4 \\\\ 3 \\end{pmatrix}$，其最优目标值为 $z^{\\star} = 32$。基变量是 $x_1$ 和 $x_2$。这意味着两个不等式约束在最优点处都为紧约束。基矩阵 $B$ 由与基变量对应的 $A$ 的列组成。在这种情况下，$B = A = \\begin{pmatrix} 1 & 1 \\\\ 2 & 1 \\end{pmatrix}$。给定的逆矩阵是 $B^{-1} = \\begin{pmatrix} -1 & 1 \\\\ 2 & -1 \\end{pmatrix}$。\n\n对偶变量（影子价格）给定为 $y^{\\star} = \\begin{pmatrix} y_1^{\\star} \\\\ y_2^{\\star} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$。\n\n题目说明第一个约束的RHS从 $7$ 增加到 $8$。这对应于RHS向量 $b$ 的变化。原始RHS向量是 $b = \\begin{pmatrix} 7 \\\\ 11 \\end{pmatrix}$。新的RHS向量是 $b_{new} = \\begin{pmatrix} 8 \\\\ 11 \\end{pmatrix}$。RHS向量的变化量是 $\\Delta b = b_{new} - b = \\begin{pmatrix} 8 - 7 \\\\ 11 - 11 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n针对RHS变化的灵敏度分析基本原理指出，对于RHS向量中的变化 $\\Delta b$，新的最优目标值 $z_{new}^{\\star}$ 由 $z_{new}^{\\star} = z^{\\star} + (y^{\\star})^T \\Delta b$ 给出，前提是变化 $\\Delta b$ 足够小，使得当前基保持最优。\n\n基保持最优的条件是新的基解 $x_{B, new}$ 必须保持可行（即非负）。新的基解计算如下：\n$$x_{B, new} = B^{-1} b_{new}$$\n我们必须验证 $x_{B, new} \\geq 0$。让我们进行此计算。\n$$x_{B, new} = \\begin{pmatrix} x_{1, new} \\\\ x_{2, new} \\end{pmatrix} = \\begin{pmatrix} -1 & 1 \\\\ 2 & -1 \\end{pmatrix} \\begin{pmatrix} 8 \\\\ 11 \\end{pmatrix}$$\n$$= \\begin{pmatrix} (-1)(8) + (1)(11) \\\\ (2)(8) + (-1)(11) \\end{pmatrix} = \\begin{pmatrix} -8 + 11 \\\\ 16 - 11 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix}$$\n由于 $x_{1, new} = 3 \\geq 0$ 和 $x_{2, new} = 5 \\geq 0$，新的基解是可行的。因此，当前基保持最优，并且紧约束集合不改变。\n\n现在我们可以放心地使用影子价格来确定新的目标值。目标值的变化量是 $\\Delta z^{\\star} = (y^{\\star})^T \\Delta b$。\n$$\\Delta z^{\\star} = \\begin{pmatrix} 3 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = (3)(1) + (1)(0) = 3$$\n新的最优目标值为：\n$$z_{new}^{\\star} = z^{\\star} + \\Delta z^{\\star} = 32 + 3 = 35$$\n\n作为验证，我们可以使用新的最优解 $x_{new}^{\\star} = \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix}$ 来计算目标值：\n$$z_{new}^{\\star} = c^T x_{new}^{\\star} = \\begin{pmatrix} 5 & 4 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix} = (5)(3) + (4)(5) = 15 + 20 = 35$$\n结果是一致的。新的最优值恰好是 $35$。\n\n题目要求答案四舍五入到四位有效数字。数字 $35$ 可以写成 $3.500 \\times 10^1$。为了用四位有效数字表示，我们写作 $35.00$。", "answer": "$$\\boxed{35.00}$$"}, {"introduction": "本练习延续了对“如果……”情景的探索，但焦点转向了目标函数。它旨在回答一个关键问题：在当前最优生产组合失效前，一个产品或活动的利润（或成本）系数 $c_j$ 可以变化多大？通过解决这个问题，你将学会如何分析最优解的稳健性，并理解非基本变量的检验数（reduced cost）所蕴含的经济意义。[@problem_id:2443936]", "id": "2443936", "problem": "一家公司选择 $x_1$、$x_2$ 和 $x_3$ 的生产组合，以在资源约束下最大化总贡献。考虑以下线性规划问题：\n$\n\\text{最大化 } z \\;=\\; 40\\,x_1 \\;+\\; 30\\,x_2 \\;+\\; c_3\\,x_3\n$\n约束条件为\n$\n\\begin{aligned}\n2\\,x_1 \\;+\\; 1\\,x_2 \\;+\\; 1\\,x_3 &\\le 40,\\\\\n1\\,x_1 \\;+\\; 2\\,x_2 \\;+\\; 3\\,x_3 &\\le 60,\\\\\nx_1,\\;x_2,\\;x_3 &\\ge 0.\n\\end{aligned}\n$\n引入松弛变量 $s_1$ 和 $s_2$ 将约束条件写成标准形式，并令 $a_1$、$a_2$ 和 $a_3$ 分别表示与 $x_1$、$x_2$ 和 $x_3$ 相关联的约束矩阵的列。假设单纯形法已经产生了一个最优基本可行解，其基由决策变量 $x_1$ 和 $x_2$ 组成，基矩阵为 $B=[a_1\\;a_2]$，其逆矩阵为\n$\nB^{-1}\n=\\frac{1}{3}\\begin{pmatrix}2 & -1\\\\ -1 & 2\\end{pmatrix}.\n$\n右端向量为 $b=(40,\\,60)^{\\top}$，基成本向量为 $c_B=(40,\\,30)^{\\top}$，与 $x_3$ 相关的非基列为 $a_3=(1,\\,3)^{\\top}$。系数 $c_1=40$ 和 $c_2=30$ 是固定的，而 $c_3$ 允许变化。\n\n当只有 $c_3$ 变化而所有其他数据保持不变时，确定使当前基保持最优的 $c_3$ 的上确界。请以精确值的形式给出答案，不要进行四舍五入。", "solution": "该问题要求确定成本系数 $c_3$ 的上确界，使得一个给定的线性规划问题的基本可行解保持最优。这是灵敏度分析中的一个标准问题，特别是关于目标函数系数变化的分析。\n\n给定的线性规划问题是：\n$$\n\\text{最大化 } z \\;=\\; 40\\,x_1 \\;+\\; 30\\,x_2 \\;+\\; c_3\\,x_3\n$$\n约束条件为：\n$$\n\\begin{aligned}\n2\\,x_1 \\;+\\; 1\\,x_2 \\;+\\; 1\\,x_3 &\\le 40 \\\\\n1\\,x_1 \\;+\\; 2\\,x_2 \\;+\\; 3\\,x_3 &\\le 60 \\\\\nx_1,\\;x_2,\\;x_3 &\\ge 0.\n\\end{aligned}\n$$\n引入松弛变量 $s_1 \\ge 0$ 和 $s_2 \\ge 0$，我们将不等式约束转换为标准形式的等式：\n$$\n\\begin{aligned}\n2\\,x_1 \\;+\\; 1\\,x_2 \\;+\\; 1\\,x_3 \\;+\\; s_1 &= 40 \\\\\n1\\,x_1 \\;+\\; 2\\,x_2 \\;+\\; 3\\,x_3 \\;+\\; s_2 &= 60\n\\end{aligned}\n$$\n松弛变量的目标函数系数为零，因此 $z = 40\\,x_1 + 30\\,x_2 + c_3\\,x_3 + 0\\,s_1 + 0\\,s_2$。\n\n我们已知找到了一个最优基本可行解，其基变量为 $x_B = (x_1, x_2)^{\\top}$，非基变量为 $x_N = (x_3, s_1, s_2)^{\\top}$。\n对于一个最大化问题，一个基是最优的当且仅当每个非基变量 $x_j$ 的判别数 $\\bar{c}_j$ 小于或等于零（$\\bar{c}_j \\le 0$）。判别数定义为 $\\bar{c}_j = c_j - z_j$，其中 $z_j = c_B^{\\top} B^{-1} a_j$。因此，最优性条件是 $c_j - c_B^{\\top} B^{-1} a_j \\le 0$。\n\n给定的数据如下：\n基成本向量： $c_B = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 40 \\\\ 30 \\end{pmatrix}$。\n基矩阵由与 $x_1$ 和 $x_2$ 对应的列构成：$B = \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$。\n基矩阵的逆矩阵：$B^{-1} = \\frac{1}{3}\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$。\n与非基变量对应的列为：$a_3 = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$，$a_{s_1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，以及 $a_{s_2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n非基变量的成本为 $c_3$（可变），$c_{s_1}=0$ 和 $c_{s_2}=0$。\n\n首先，我们计算单纯形乘子向量（或对偶变量）$y^{\\top} = c_B^{\\top} B^{-1}$：\n$$\ny^{\\top} = \\begin{pmatrix} 40 & 30 \\end{pmatrix} \\frac{1}{3}\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n$$\ny^{\\top} = \\frac{1}{3} \\begin{pmatrix} 40(2) + 30(-1) & 40(-1) + 30(2) \\end{pmatrix}\n$$\n$$\ny^{\\top} = \\frac{1}{3} \\begin{pmatrix} 80 - 30 & -40 + 60 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 50 & 20 \\end{pmatrix} = \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix}\n$$\n现在我们将最优性条件 $\\bar{c}_j = c_j - y^{\\top}a_j \\le 0$ 应用于每个非基变量。\n\n对于非基变量 $s_1$：\n成本为 $c_{s_1} = 0$。对应的列为 $a_{s_1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n$$\n\\bar{c}_{s_1} = c_{s_1} - y^{\\top}a_{s_1} = 0 - \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -\\frac{50}{3}\n$$\n由于 $-\\frac{50}{3} \\le 0$，所以对于 $s_1$ 的最优性条件得到满足。该条件与 $c_3$ 无关。\n\n对于非基变量 $s_2$：\n成本为 $c_{s_2} = 0$。对应的列为 $a_{s_2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n$$\n\\bar{c}_{s_2} = c_{s_2} - y^{\\top}a_{s_2} = 0 - \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = -\\frac{20}{3}\n$$\n由于 $-\\frac{20}{3} \\le 0$，所以对于 $s_2$ 的最优性条件得到满足。该条件也与 $c_3$ 无关。\n\n对于非基变量 $x_3$：\n成本为 $c_3$。对应的列为 $a_3 = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$。\n最优性条件为 $\\bar{c}_3 = c_3 - y^{\\top}a_3 \\le 0$。\n我们必须计算 $y^{\\top}a_3$：\n$$\ny^{\\top}a_3 = \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\frac{50}{3}(1) + \\frac{20}{3}(3) = \\frac{50}{3} + \\frac{60}{3} = \\frac{110}{3}\n$$\n将此值代入最优性条件，我们得到：\n$$\nc_3 - \\frac{110}{3} \\le 0\n$$\n化简为：\n$$\nc_3 \\le \\frac{110}{3}\n$$\n这个不等式定义了使当前基保持最优的 $c_3$ 的取值范围。所有这些值的集合是区间 $(-\\infty, \\frac{110}{3}]$。问题要求的是这个集合的上确界。这个区间的上确界，或最小上界，是闭合端点处的值。\n\n因此，使当前基保持最优的 $c_3$ 的上确界是 $\\frac{110}{3}$。如果 $c_3$ 超过这个值，判别数 $\\bar{c}_3$ 将变为正值，表明当前解不再是最优的，并且可以通过将 $x_3$ 引入基中来改进目标函数值。", "answer": "$$\\boxed{\\frac{110}{3}}$$"}]}