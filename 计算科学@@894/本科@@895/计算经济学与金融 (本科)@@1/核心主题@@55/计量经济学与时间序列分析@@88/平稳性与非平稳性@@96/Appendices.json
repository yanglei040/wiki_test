{"hands_on_practices": [{"introduction": "平稳性的概念可能听起来很抽象，但它在现实世界中无处不在。此练习将平稳性与一个具体的排队系统联系起来，帮助我们理解一个动态过程在何种条件下会达到长期稳定的平衡状态。通过分析客户到达和服务速率，你将从第一性原理推导出系统保持稳定的临界条件，这是理解随机过程稳定性的核心。[@problem_id:2433729]", "id": "2433729", "problem": "一家金融服务公司运营一个单一的客户支持服务台，处理来自在线经纪平台客户的传入请求。公司将系统中的请求数量（包括任何正在服务中的请求）建模为非负整数上的连续时间马尔可夫链。具体来说，令$Q(t)$表示在时间$t \\ge 0$时的队列长度。请求根据速率为$\\lambda > 0$的泊松过程到达，服务时间是独立的，且服从速率为$\\mu > 0$的指数分布。系统只有一个服务台。当$Q(t)=n \\ge 1$时，转移$n \\to n-1$以速率$\\mu$发生；当$Q(t)=n \\ge 0$时，转移$n \\to n+1$以速率$\\lambda$发生。当$Q(t)=0$时，没有离去发生。\n\n仅使用连续时间马尔可夫链的第一性原理、平稳分布的定义以及泊松到达和指数服务的性质，确定到达速率$\\lambda$的上确界（表示为$\\mu$的函数），在该上确界下，队列长度过程$Q(t)$是严格平稳的，即其分布是时不变的，并且等于一个正常的平稳分布。\n\n以$\\mu$的单个闭式解析表达式作答。答案中不要包含单位。", "solution": "该问题要求确定所描述的排队系统拥有一个正常平稳分布的到达速率$\\lambda$的上确界。该系统被描述为在非负整数状态空间$S = \\{0, 1, 2, \\dots\\}$上的一个连续时间马尔可夫链(CTMC)，其中状态$n$表示系统中的请求数量。这是一个经典的生灭过程。\n\n让我们为每个状态$n \\in S$定义出生率和死亡率。\n出生对应于一个到达，导致从状态$n$到$n+1$的转移。根据问题陈述，到达遵循速率为$\\lambda$的泊松过程。因此，在任何状态$n \\ge 0$下的出生率是恒定的：\n$$ \\lambda_n = \\lambda \\quad \\text{for } n = 0, 1, 2, \\dots $$\n死亡对应于一次服务完成，导致从状态$n$到$n-1$的转移。系统有一个服务台，其指数服务速率为$\\mu$。因此，只有当系统不为空时（即$n \\ge 1$），才可能发生离去。死亡率是：\n$$ \\mu_n = \\begin{cases} \\mu & \\text{if } n \\ge 1 \\\\ 0 & \\text{if } n = 0 \\end{cases} $$\n\n为了使过程$Q(t)$是严格平稳的且具有一个正常的平稳分布，必须存在一个概率分布$\\pi = (\\pi_0, \\pi_1, \\pi_2, \\dots)$，使得对所有$n$都有$\\pi_n \\ge 0$，$\\sum_{n=0}^{\\infty} \\pi_n = 1$，并且该分布是时不变的。对于生灭过程，如果平稳分布$\\pi$满足细致平衡方程，则可以保证时不变性：\n$$ \\pi_n \\lambda_n = \\pi_{n+1} \\mu_{n+1} \\quad \\text{for } n = 0, 1, 2, \\dots $$\n\n我们可以递归地求解这些方程，以$\\pi_0$来表示$\\pi_n$。\n对于$n=0$:\n$$ \\pi_0 \\lambda_0 = \\pi_1 \\mu_1 \\implies \\pi_0 \\lambda = \\pi_1 \\mu \\implies \\pi_1 = \\pi_0 \\left(\\frac{\\lambda}{\\mu}\\right) $$\n对于$n=1$:\n$$ \\pi_1 \\lambda_1 = \\pi_2 \\mu_2 \\implies \\pi_1 \\lambda = \\pi_2 \\mu \\implies \\pi_2 = \\pi_1 \\left(\\frac{\\lambda}{\\mu}\\right) = \\pi_0 \\left(\\frac{\\lambda}{\\mu}\\right)^2 $$\n通过归纳法，我们可以建立对任何$n \\ge 0$的通用关系：\n$$ \\pi_n = \\pi_0 \\left(\\frac{\\lambda}{\\mu}\\right)^n $$\n\n为了使$\\pi$成为一个正常的概率分布，所有概率的总和必须等于$1$。这是归一化条件：\n$$ \\sum_{n=0}^{\\infty} \\pi_n = 1 $$\n将$\\pi_n$的表达式代入此方程得到：\n$$ \\sum_{n=0}^{\\infty} \\pi_0 \\left(\\frac{\\lambda}{\\mu}\\right)^n = 1 $$\n$$ \\pi_0 \\sum_{n=0}^{\\infty} \\left(\\frac{\\lambda}{\\mu}\\right)^n = 1 $$\n该求和是一个公比为$r = \\frac{\\lambda}{\\mu}$的几何级数。为了使该级数收敛到一个有限值，公比的绝对值必须小于$1$。由于$\\lambda > 0$且$\\mu > 0$，公比为正，所以收敛的条件是：\n$$ \\frac{\\lambda}{\\mu} < 1 \\implies \\lambda < \\mu $$\n如果不满足此条件（即，如果$\\lambda \\ge \\mu$），则级数发散，概率总和无法归一化为$1$。在这种情况下，不存在正常的平稳分布；队列是不稳定的，请求数量会无限增长。\n\n当条件$\\lambda < \\mu$满足时，几何级数的和为：\n$$ \\sum_{n=0}^{\\infty} \\left(\\frac{\\lambda}{\\mu}\\right)^n = \\frac{1}{1 - \\frac{\\lambda}{\\mu}} $$\n将此结果代回归一化方程，可以解出$\\pi_0$：\n$$ \\pi_0 \\left(\\frac{1}{1 - \\frac{\\lambda}{\\mu}}\\right) = 1 \\implies \\pi_0 = 1 - \\frac{\\lambda}{\\mu} $$\n由于概率必须是非负的，$\\pi_0 > 0$（因为$\\pi_0 = 0$将意味着所有$\\pi_n = 0$），这再次要求$1 - \\frac{\\lambda}{\\mu} > 0$，即$\\lambda < \\mu$。\n\n因此，存在一个正常平稳分布的充要条件是$\\lambda < \\mu$。问题要求的是满足此条件的到达速率$\\lambda$的上确界。给定一个固定的服务速率$\\mu > 0$，所有允许存在平稳分布的可能到达速率$\\lambda > 0$的集合由区间$(0, \\mu)$给出。\n一个集合的上确界是其最小上界。对于到达速率集合$\\lambda \\in (0, \\mu)$，其上确界是：\n$$ \\sup\\{\\lambda \\mid 0 < \\lambda < \\mu\\} = \\mu $$\n这是阈值到达速率；对于任何严格低于此值的速率，系统是稳定的，而在此值或更高值时，系统变得不稳定。", "answer": "$$\\boxed{\\mu}$$"}, {"introduction": "经济和金融时间序列常常表现出非平稳性，其中一个常见来源是随机趋势的存在。本练习构建了一个包含随机游走截距项的自回归模型，以揭示这种非平稳性的内在结构。通过分析并对该过程进行差分，你将掌握识别和处理单位根过程的关键技能，这是将非平稳数据转换为平稳数据以进行有效建模的基础步骤。[@problem_id:2433747]", "id": "2433747", "problem": "考虑一个由下式定义的离散时间随机过程 $\\{y_t\\}_{t \\in \\mathbb{Z}}$\n$$\ny_t \\;=\\; \\alpha_t \\;+\\; 0.5\\, y_{t-1} \\;+\\; \\epsilon_t,\n$$\n其中时变截距 $\\{\\alpha_t\\}$ 服从随机游走\n$$\n\\alpha_t \\;=\\; \\alpha_{t-1} \\;+\\; u_t.\n$$\n假设 $\\{\\epsilon_t\\}$ 和 $\\{u_t\\}$ 是相互独立的独立同分布 (i.i.d.) 随机变量序列，且满足 $\\mathbb{E}[\\epsilon_t]=0$, $\\mathbb{E}[u_t]=0$, $\\operatorname{Var}(\\epsilon_t)=\\sigma_{\\epsilon}^{2}\\in (0,\\infty)$, 以及 $\\operatorname{Var}(u_t)=\\sigma_{u}^{2}\\in (0,\\infty)$。假设 $\\alpha_0$ 和 $y_{-1}$是方差有限的常数，且独立于 $\\{\\epsilon_t\\}$ 和 $\\{u_t\\}$。设一阶差分算子定义为 $\\Delta y_t \\equiv y_t - y_{t-1}$，对于整数 $d \\ge 0$，递归定义 $\\Delta^{d}$ 为 $\\Delta^{0} y_t \\equiv y_t$ 且当 $d \\ge 1$ 时 $\\Delta^{d} y_t \\equiv \\Delta(\\Delta^{d-1} y_t)$。\n\n确定最小的整数 $d \\ge 0$，使得 $\\{\\Delta^{d} y_t\\}$ 是弱平稳的（协方差平稳的）。请以 $d$ 的值作为答案。无需单位。您的答案必须是一个无需四舍五入的整数。", "solution": "问题在于确定最小的非负整数 $d$，使得过程 $\\{\\Delta^d y_t\\}$ 是弱平稳的。一个过程 $\\{z_t\\}$ 是弱平稳的，如果其均值 $\\mathbb{E}[z_t]$ 和方差 $\\operatorname{Var}(z_t)$ 不随时间变化，且其自协方差 $\\operatorname{Cov}(z_t, z_{t-h})$ 仅依赖于滞后阶数 $h$。\n\n过程 $\\{y_t\\}$ 由以下方程组定义：\n$$\n(1) \\quad y_t = \\alpha_t + 0.5 y_{t-1} + \\epsilon_t\n$$\n$$\n(2) \\quad \\alpha_t = \\alpha_{t-1} + u_t\n$$\n其中 $\\{\\epsilon_t\\}$ 和 $\\{u_t\\}$ 是相互独立的独立同分布序列，均值为零，有限正常数方差分别为 $\\sigma_{\\epsilon}^{2}$ 和 $\\sigma_{u}^{2}$。\n\n我们首先分析 $\\{y_t\\}$ 本身的平稳性，这对应于 $d=0$ 的情况。\n我们可以将该系统仅用 $\\{y_t\\}$ 来表示。从方程 (1) 可得：\n$$\n\\alpha_t = y_t - 0.5 y_{t-1} - \\epsilon_t\n$$\n将此方程滞后一期，得到：\n$$\n\\alpha_{t-1} = y_{t-1} - 0.5 y_{t-2} - \\epsilon_{t-1}\n$$\n将 $\\alpha_t$ 和 $\\alpha_{t-1}$ 的这些表达式代入方程 (2) 得到：\n$$\n(y_t - 0.5 y_{t-1} - \\epsilon_t) = (y_{t-1} - 0.5 y_{t-2} - \\epsilon_{t-1}) + u_t\n$$\n整理各项，我们得到一个关于 $\\{y_t\\}$ 的单一方程：\n$$\ny_t - 1.5 y_{t-1} + 0.5 y_{t-2} = u_t + \\epsilon_t - \\epsilon_{t-1}\n$$\n这是一个关于 $\\{y_t\\}$ 的自回归移动平均 (ARMA) 模型。我们可以使用滞后算子 $L$ 来写出它，其中 $L x_t = x_{t-1}$：\n$$\n(1 - 1.5 L + 0.5 L^2) y_t = u_t + (1 - L) \\epsilon_t\n$$\n要使一个自回归过程是平稳的，其特征多项式的根必须全部位于单位圆之外。自回归特征多项式为 $\\phi(z) = 1 - 1.5 z + 0.5 z^2$。我们通过解 $\\phi(z)=0$ 来求其根：\n$$\n0.5 z^2 - 1.5 z + 1 = 0\n$$\n$$\nz^2 - 3 z + 2 = 0\n$$\n$$\n(z-1)(z-2) = 0\n$$\n根为 $z_1=1$ 和 $z_2=2$。其中一个根 $z_1=1$ 位于单位圆上。这是一个“单位根”，它是非平稳性的明确指标。单位根的存在意味着对系统的冲击具有永久性影响，且过程的方差不随时间恒定。具体来说，随机游走部分 $\\{\\alpha_t\\}$ 的方差为 $\\operatorname{Var}(\\alpha_t) = t \\sigma_u^2$ (假设 $\\alpha_0$ 是一个常数)，它随时间增长。这种非平稳性被 $\\{y_t\\}$ 所继承。因此，对于 $d=0$，过程 $\\{\\Delta^0 y_t\\} = \\{y_t\\}$ 是非平稳的。\n\n接下来，我们研究 $d=1$ 的情况。我们分析一阶差分过程 $w_t = \\Delta y_t = y_t - y_{t-1} = (1-L)y_t$。\n$\\{y_t\\}$ 的自回归多项式可以分解为 $\\phi(L) = (1-L)(1-0.5L)$。将其代入 $\\{y_t\\}$ 的方程中：\n$$\n(1-L)(1-0.5L) y_t = u_t + \\epsilon_t - \\epsilon_{t-1}\n$$\n代入 $w_t = (1-L)y_t$，我们得到一个关于 $\\{w_t\\}$ 的方程：\n$$\n(1-0.5L) w_t = u_t + \\epsilon_t - \\epsilon_{t-1}\n$$\n这可以写成：\n$$\nw_t = 0.5 w_{t-1} + v_t\n$$\n其中 $v_t = u_t + \\epsilon_t - \\epsilon_{t-1}$。这表明 $\\{w_t\\}$ 是一个由误差项 $\\{v_t\\}$ 驱动的 AR(1) 过程。要使 $\\{w_t\\}$ 弱平稳，必须满足两个条件：\n1. 自回归系数的绝对值必须小于1。这里，系数是 $0.5$，且 $|0.5| < 1$，所以此条件满足。\n2. 驱动噪声过程 $\\{v_t\\}$ 必须是弱平稳的。\n\n我们来检查 $\\{v_t\\}$ 的性质：\n- 均值：$\\mathbb{E}[v_t] = \\mathbb{E}[u_t] + \\mathbb{E}[\\epsilon_t] - \\mathbb{E}[\\epsilon_{t-1}] = 0 + 0 - 0 = 0$。均值是常数。\n- 方差：由于 $\\{u_t\\}$ 和 $\\{\\epsilon_t\\}$ 是相互独立的独立同分布序列，$u_t$，$\\epsilon_t$ 和 $\\epsilon_{t-1}$ 相互不相关。\n$$\n\\operatorname{Var}(v_t) = \\operatorname{Var}(u_t + \\epsilon_t - \\epsilon_{t-1}) = \\operatorname{Var}(u_t) + \\operatorname{Var}(\\epsilon_t) + \\operatorname{Var}(-\\epsilon_{t-1}) = \\sigma_u^2 + \\sigma_\\epsilon^2 + (-1)^2 \\sigma_\\epsilon^2 = \\sigma_u^2 + 2\\sigma_\\epsilon^2\n$$\n方差是常数且有限，因为 $\\sigma_u^2, \\sigma_\\epsilon^2 \\in (0, \\infty)$。\n- 自协方差：对于滞后阶数 $h=1$：\n$$\n\\operatorname{Cov}(v_t, v_{t-1}) = \\mathbb{E}[v_t v_{t-1}] = \\mathbb{E}[(u_t + \\epsilon_t - \\epsilon_{t-1})(u_{t-1} + \\epsilon_{t-1} - \\epsilon_{t-2})]\n$$\n展开此式并利用独立性和独立同分布性质，唯一非零的期望是 $\\mathbb{E}[(-\\epsilon_{t-1})(\\epsilon_{t-1})] = -\\mathbb{E}[\\epsilon_{t-1}^2] = -\\sigma_\\epsilon^2$。所以，$\\operatorname{Cov}(v_t, v_{t-1}) = -\\sigma_\\epsilon^2$。\n对于滞后阶数 $h \\ge 2$：\n$$\n\\operatorname{Cov}(v_t, v_{t-h}) = \\mathbb{E}[(u_t + \\epsilon_t - \\epsilon_{t-1})(u_{t-h} + \\epsilon_{t-h} - \\epsilon_{t-h-1})] = 0\n$$\n因为所有交叉项都涉及不同时间段的变量。\n由于 $\\{v_t\\}$ 的均值、方差和自协方差不依赖于时间 $t$，所以 $\\{v_t\\}$ 是一个弱平稳过程（具体来说，是一个 MA(1) 过程）。\n\n因为 $\\{w_t\\} = \\{\\Delta y_t\\}$ 是一个由平稳噪声过程 $\\{v_t\\}$ 驱动的稳定 AR(1) 过程，所以 $\\{w_t\\}$ 本身是弱平稳的。其无条件均值为 $\\mathbb{E}[w_t] = 0$，其方差是常数且有限。自协方差函数 $\\operatorname{Cov}(w_t, w_{t-h})$ 可以证明仅依赖于滞后阶数 $h$。\n因此，对于 $d=1$，过程 $\\{\\Delta^1 y_t\\}$ 是弱平稳的。\n\n由于 $\\{y_t\\}$ (对于 $d=0$) 是非平稳的，而 $\\{\\Delta y_t\\}$ (对于 $d=1$) 是平稳的，因此使 $\\{\\Delta^d y_t\\}$ 弱平稳的最小非负整数 $d$ 是 $1$。任何进一步的差分（例如, $d=2$）也会得到一个平稳过程，因为对一个平稳过程进行差分会产生另一个平稳过程，但 $d=1$ 是所需的最小差分阶数。", "answer": "$$\\boxed{1}$$"}, {"introduction": "在理论上区分平稳和非平稳过程似乎很简单，但在实践中，这却是一个巨大的挑战。一个高度持续的平稳过程（例如自回归系数 $\\rho=0.999$）在有限样本中可能与一个单位根过程（$\\rho=1$）在统计上难以区分。这个计算练习将引导你量化这种模糊性，通过推导和编程找出需要多大的样本量才能有把握地将二者区分开，从而深刻理解有限样本给时间序列分析带来的挑战。[@problem_id:2433670]", "id": "2433670", "problem": "考虑由递归式 $y_t = \\rho\\,y_{t-1} + \\varepsilon_t$ 定义的一阶自回归过程 (AR(1))，其中 $\\{\\varepsilon_t\\}$ 是一个均值为 $0$、方差为 $1$ 的独立同分布高斯新息序列。在计算经济学和计算金融学中，一项核心任务是确定一个时间序列是平稳的 (即 $|\\rho|<1$) 还是含有单位根 (即 $\\rho=1$)。平稳 AR(1) 过程与单位根过程之间的统计不可区分性概念，取决于对 $\\rho$ 的估计所产生的不确定性如何随样本量的变化而变化。\n\n定义在置信水平 $100(1-\\alpha)\\%$ 下的不可区分性决策规则如下：对于一个给定的真实参数 $\\rho$ (其中 $|\\rho|<1$)，如果在样本量为 $N$、置信水平为 $100(1-\\alpha)\\%$ 的条件下，$\\rho$ 的双侧 $100(1-\\alpha)\\%$ 置信区间包含单位根值 $1$，则该过程被认为与单位根过程在统计上不可区分。假设 $\\rho$ 的最小二乘估计量是渐近正态分布的，并基于线性回归估计量的基本性质以及 AR(1) 过程的大样本近似来进行推导。\n\n你的任务是：\n- 从第一性原理和经过充分检验的公式出发，推导出一个可计算的准则，该准则能够得出最大整数 $N$（记为 $N^\\star$），使得参数为 $\\rho$ 的 AR(1) 过程根据上述决策规则，在置信水平 $100(1-\\alpha)\\%$ 下与单位根过程在统计上不可区分。\n- 实现一个程序，对下面列出的每个测试用例，计算出满足不可区分性条件的最大整数样本量 $N^\\star$。如果不可区分性条件对所有 $N$ 都成立，则返回一个较大的有限代理上限（$10^9$）。如果在极小的 $N$ 值下该条件都不成立，则返回 $0$。\n- 假设不涉及物理单位。所有百分比必须解释为小数（例如，95% 的置信水平对应于 0.95）。\n\n测试套件（每个测试用例是一个数对 $(\\rho, \\text{conf})$）：\n- 用例 1: $(\\rho, \\text{conf}) = (0.999, 0.95)$\n- 用例 2: $(\\rho, \\text{conf}) = (0.995, 0.95)$\n- 用例 3: $(\\rho, \\text{conf}) = (0.950, 0.95)$\n- 用例 4: $(\\rho, \\text{conf}) = (0.999, 0.99)$\n- 用例 5: $(\\rho, \\text{conf}) = (0.900, 0.95)$\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的、用逗号分隔的结果列表（例如 $[n_1,n_2,n_3,n_4,n_5]$），其中 $n_i$ 是为第 $i$ 个测试用例按上述顺序计算出的 $N^\\star$。因此，所需的最终输出是单行中包含的五个整数列表。", "solution": "该问题要求推导一个准则，用以寻找最大整数样本量 $N^\\star$，在该样本量下，一个平稳的一阶自回归过程 AR($1$) 与一个单位根过程在统计上是不可区分的。分析将按要求从第一性原理出发。\n\nAR($1$) 过程由以下随机差分方程定义：\n$$ y_t = \\rho \\, y_{t-1} + \\varepsilon_t $$\n其中 $\\{\\varepsilon_t\\}$ 是一个独立同分布 (i.i.d.) 的高斯随机变量序列，其均值为 $0$，方差为 $\\sigma^2 = 1$。当且仅当 $|\\rho| < 1$ 时，该过程是平稳的。如果 $\\rho=1$，则存在单位根。\n\n对于一个大小为 $N$ 的样本，$\\rho$ 的最小二乘估计量 $\\hat{\\rho}$ 由下式给出：\n$$ \\hat{\\rho} = \\frac{\\sum_{t=1}^{N} y_{t-1} y_t}{\\sum_{t=1}^{N} y_{t-1}^2} $$\n\n问题陈述要求我们假设估计量 $\\hat{\\rho}$ 是渐近正态的。对于一个平稳的 AR($1$) 过程（其中 $|\\rho| < 1$），标准大样本理论表明：\n$$ \\sqrt{N}(\\hat{\\rho} - \\rho) \\xrightarrow{d} \\mathcal{N}(0, 1-\\rho^2) $$\n这意味着，对于足够大的样本量 $N$，$\\hat{\\rho}$ 的分布可以近似为一个正态分布：\n$$ \\hat{\\rho} \\sim \\mathcal{N}\\left(\\rho, \\frac{1-\\rho^2}{N}\\right) $$\n因此，估计量 $\\hat{\\rho}$ 的渐近标准误为：\n$$ \\text{SE}(\\hat{\\rho}) \\approx \\sqrt{\\frac{1-\\rho^2}{N}} $$\n必须强调，该近似仅对平稳过程 ($|\\rho|<1$) 有效，并且随着 $\\rho$ 趋近于 $1$ 其精确度会下降。然而，问题明确指示我们使用此框架进行分析。\n\n参数 $\\rho$ 的一个双侧 $100(1-\\alpha)\\%$ 置信区间的构造如下：\n$$ \\text{CI} = \\left[ \\hat{\\rho} - z_{\\alpha/2} \\cdot \\text{SE}(\\hat{\\rho}), \\quad \\hat{\\rho} + z_{\\alpha/2} \\cdot \\text{SE}(\\hat{\\rho}) \\right] $$\n其中 $z_{\\alpha/2}$ 是来自标准正态分布的临界值，对应于 $1 - \\alpha/2$ 的累积概率。\n\n问题的核心在于“统计不可区分性”的定义。所提供的规则是：如果 $\\rho$ 的置信区间包含值 $1$，则该过程与单位根过程不可区分。这个置信区间是一个随机区间，因为它依赖于特定样本的估计值 $\\hat{\\rho}$。然而，用于计算 $N^\\star$ 的准则必须是确定性的，仅取决于真实的过程参数 $\\rho$ 和所选的置信水平 $1-\\alpha$。\n\n为了建立一个确定性的准则，我们必须将此条件可操作化。一个合乎逻辑的方法是在估计量抽样分布的中心，即真实参数 $\\rho$ 处，来评估该条件（因为 $\\hat{\\rho}$ 是渐近无偏的，$\\mathbb{E}[\\hat{\\rho}] \\approx \\rho$）。这等同于询问以中位数为中心的置信区间是否包含值 $1$。如果随机置信区间包含 $1$ 的概率至少为 $50\\%$，这种情况就会发生。因此，条件就变为：从真实参数 $\\rho$ 到单位根值 $1$ 的距离是否小于或等于统计误差范围。\n\n由于 $\\rho < 1$，要使此代表性区间包含 $1$，其右边界必须大于或等于 $1$。这便给出了以下不等式：\n$$ \\rho + z_{\\alpha/2} \\cdot \\text{SE}(\\hat{\\rho}) \\ge 1 $$\n代入标准误的表达式，我们得到：\n$$ \\rho + z_{\\alpha/2} \\sqrt{\\frac{1-\\rho^2}{N}} \\ge 1 $$\n我们现在必须针对样本量 $N$ 求解这个不等式。\n$$ z_{\\alpha/2} \\sqrt{\\frac{1-\\rho^2}{N}} \\ge 1 - \\rho $$\n由于 $|\\rho|<1$ 且 $\\alpha \\in (0,1)$，不等式两边均为正值。我们可以对两边进行平方，而不会改变不等式的方向：\n$$ z_{\\alpha/2}^2 \\left(\\frac{1-\\rho^2}{N}\\right) \\ge (1 - \\rho)^2 $$\n我们可以将项 $1-\\rho^2$ 分解为 $(1-\\rho)(1+\\rho)$：\n$$ \\frac{z_{\\alpha/2}^2 (1-\\rho)(1+\\rho)}{N} \\ge (1 - \\rho)^2 $$\n由于 $\\rho < 1$，项 $1-\\rho$ 恒为正。我们可以将不等式两边同除以 $1-\\rho$：\n$$ \\frac{z_{\\alpha/2}^2 (1+\\rho)}{N} \\ge 1 - \\rho $$\n现在，我们整理以分离出 $N$：\n$$ z_{\\alpha/2}^2 (1+\\rho) \\ge N (1 - \\rho) $$\n$$ N \\le \\frac{z_{\\alpha/2}^2 (1+\\rho)}{1 - \\rho} $$\n这个不等式定义了在该范围内，过程被视为与单位根不可区分的样本量 $N$。问题要求的是满足此条件的最大整数 $N$。该值我们记为 $N^\\star$，即右侧表达式的下取整：\n$$ N^\\star = \\left\\lfloor \\frac{z_{\\alpha/2}^2 (1+\\rho)}{1 - \\rho} \\right\\rfloor $$\n这就是最终的可计算准则。如果右侧表达式的值小于 $1$，则最大整数 $N$ 为 $0$。所给的测试用例中 $\\rho$ 的值都接近 $1$，这将导致分数的值很大，因此 $N^\\star$ 将为正数。条件对所有 $N$ 都成立的情况不会发生，因为对于任何 $\\rho<1$，当 $N$ 足够大时，$N \\le C$ 这一条件都将被违反。\n实现时需要根据给定的置信水平 `conf`（其中 `conf` $= 1-\\alpha$）计算 $z_{\\alpha/2}$。$z_{\\alpha/2}$ 的值是标准正态分布的 $(1-\\alpha/2)$ 分位数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the largest integer sample size N* for which an AR(1) process\n    is statistically indistinguishable from a unit root process.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (rho, confidence_level).\n    test_cases = [\n        (0.999, 0.95),  # Case 1\n        (0.995, 0.95),  # Case 2\n        (0.950, 0.95),  # Case 3\n        (0.999, 0.99),  # Case 4\n        (0.900, 0.95),  # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        rho, conf = case\n\n        # The problem states that for rho >= 1, the premise of stationarity is violated.\n        # It also states we must consider rho < 1.\n        # If rho is very close to 1, N* could be very large, but not infinite.\n        if rho >= 1:\n            # This case is outside the problem's explicit scope but we handle it robustly.\n            # If rho is 1 or greater, the denominator (1 - rho) is zero or negative.\n            # The stationarity variance formula 1 - rho^2 is also invalid.\n            # Following the spirit of the problem (holds for all N), return the surrogate.\n            results.append(int(1e9))\n            continue\n        \n        # Calculate alpha from the confidence level\n        alpha = 1 - conf\n\n        # Calculate the z-score (critical value) for a two-sided test.\n        # This corresponds to the (1 - alpha/2) quantile of the standard normal distribution.\n        z_alpha_over_2 = norm.ppf(1 - alpha / 2)\n        \n        # The derived formula for the maximum sample size N* is:\n        # N* = floor( (z_{alpha/2}^2 * (1 + rho)) / (1 - rho) )\n        # This formula gives the largest integer N for which the condition holds.\n        \n        numerator = (z_alpha_over_2**2) * (1 + rho)\n        denominator = 1 - rho\n        \n        # Calculate N*.\n        # The condition N <= value implies the largest integer is floor(value).\n        # We ensure the result is treated as an integer.\n        n_star = np.floor(numerator / denominator)\n        \n        # Per problem, if condition fails even for small N, return 0.\n        # Our formula naturally handles this: if n_star < 1, floor will be 0 or less.\n        # We ensure non-negative output.\n        results.append(max(0, int(n_star)))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"}]}