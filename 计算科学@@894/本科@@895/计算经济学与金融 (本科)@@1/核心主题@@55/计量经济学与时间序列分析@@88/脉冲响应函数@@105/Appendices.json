{"hands_on_practices": [{"introduction": "理解脉冲响应函数的第一步是掌握其解析形式。这个练习将引导你推导一个经典的二阶自回归（$\\\\text{AR}(2)$）模型的脉冲响应函数，并将其与模型的特征多项式根直接联系起来。通过这个过程，你将深刻体会到系统的内在动态（如衰减速度或振荡行为）是如何由其数学结构决定的，为理解更复杂的模型打下坚实的理论基础。[@problem_id:2400804]", "id": "2400804", "problem": "考虑一个在计算经济学和金融学中用于概括对冲击的动态响应的单变量、协方差平稳的二阶自回归过程（简记为AR($2$)）：\n$$\ny_{t} = \\phi_{1} y_{t-1} + \\phi_{2} y_{t-2} + \\epsilon_{t},\n$$\n其中 $\\{\\epsilon_{t}\\}$ 是一个均值为零、方差有限的序列不相关的创新序列，$\\phi_{1}$和$\\phi_{2}$是保证该过程协方差平稳的实数参数。将脉冲响应函数 (IRF) $\\{\\psi_{h}\\}_{h \\ge 0}$ 定义为当系统在冲击前处于静止状态（即 $y_{-1}=y_{-2}=0$）时，对在时间 $t=0$ 发生的一次性单位创新（即 $\\epsilon_{0}=1$，对所有 $t \\ne 0$ 有 $\\epsilon_{t}=0$）的响应序列 $y_h$。设 $r_{1}$ 和 $r_{2}$ 表示特征方程\n$$\nr^{2} - \\phi_{1} r - \\phi_{2} = 0.\n$$\n的两个不相等的实数根。\n推导 IRF 系数 $\\psi_{h}$ （对于任何整数时期 $h \\ge 0$）的一个闭式表达式，该表达式用 $r_{1}$、$r_{2}$ 和 $h$ 表示。简要地用文字说明 IRF 的定性形状如何取决于 $r_{1}$ 和 $r_{2}$ 的符号和大小。你的最终答案必须是 $\\psi_{h}$ 的一个以 $r_{1}$、$r_{2}$ 和 $h$ 表示的解析表达式。不需要进行数值近似。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 模型是一个单变量、协方差平稳的二阶自回归过程，AR($2$)：$y_{t} = \\phi_{1} y_{t-1} + \\phi_{2} y_{t-2} + \\epsilon_{t}$。\n- 创新 $\\{\\epsilon_{t}\\}$ 是一个均值为零、方差有限的序列不相关的随机变量序列。\n- 参数 $\\phi_{1}$ 和 $\\phi_{2}$ 是确保协方差平稳性的实数常数。\n- 脉冲响应函数 (IRF)，$\\{\\psi_{h}\\}_{h \\ge 0}$，被定义为对 $t=0$ 时的一次性单位冲击的响应序列 $y_h$。\n- IRF 的初始条件是 $y_{-1}=0$ 和 $y_{-2}=0$。\n- 冲击被指定为 $\\epsilon_{0}=1$ 且对所有整数 $t \\ne 0$ 有 $\\epsilon_{t}=0$。\n- 特征方程为 $r^{2} - \\phi_{1} r - \\phi_{2} = 0$。\n- 特征方程的根 $r_1$ 和 $r_2$ 被指定为实数且不相等。\n\n步骤2：使用提取的已知条件进行验证。\n- 问题是 **有科学依据的**。它涉及时间序列分析和计量经济学中的一个基本概念——AR($2$)过程的脉冲响应函数。这是该领域的标准课题。\n- 问题是 **适定的**。它提供了推导唯一且有意义的解所需的所有必要信息（模型、初始条件、冲击设定以及特征根的性质）。\n- 问题是 **客观的**。其语言精确，没有主观或模糊的术语。\n- 问题是内部一致且完整的。协方差平稳性的假设意味着根 $r_1, r_2$ 必须位于单位圆内，即 $|r_1|<1$ 和 $|r_2|<1$，这确保了 IRF 收敛到零。这是一个非爆炸性系统的标准且必要的条件。\n\n步骤3：结论与行动。\n问题是有效的。下面将给出一个严谨的解法推导。\n\n脉冲响应函数系数，记为 $\\psi_{h}$，被定义为系统变量 $y_t$ 在时间 $t=h$ 时对 $t=0$ 时的单位冲击的响应，其中系统在冲击前处于静止状态。形式上，给定 $t<0$ 时 $y_{t}=0$、$\\epsilon_0=1$ 且 $t \\ne 0$ 时 $\\epsilon_t=0$ 的条件下，有 $\\psi_{h} \\equiv y_{h}$。\n\n将这些条件代入 AR($2$) 方程，可得到 IRF 系数的动态路径：\n$$\n\\psi_{h} = \\phi_{1} \\psi_{h-1} + \\phi_{2} \\psi_{h-2} \\quad \\text{for } h \\ge 2\n$$\n这是一个齐次二阶线性差分方程。与此差分方程相关的特征方程在问题陈述中已给出：\n$$\nr^{2} - \\phi_{1} r - \\phi_{2} = 0\n$$\n问题指明该方程的根 $r_1$ 和 $r_2$ 是实数且不相等。因此，$\\psi_h$ 的通解形式为：\n$$\n\\psi_{h} = c_{1} r_{1}^{h} + c_{2} r_{2}^{h}\n$$\n其中 $c_1$ 和 $c_2$ 是待定常数，需要根据脉冲响应序列的初始条件来确定。\n\n我们必须求出 IRF 的前两个值，$\\psi_0$ 和 $\\psi_1$。\n对于 $h=0$：\n$$\n\\psi_{0} = y_{0} = \\phi_{1} y_{-1} + \\phi_{2} y_{-2} + \\epsilon_{0} = \\phi_{1}(0) + \\phi_{2}(0) + 1 = 1\n$$\n对于 $h=1$：\n$$\n\\psi_{1} = y_{1} = \\phi_{1} y_{0} + \\phi_{2} y_{-1} + \\epsilon_{1} = \\phi_{1} \\psi_{0} + \\phi_{2}(0) + 0 = \\phi_{1}(1) = \\phi_{1}\n$$\n因此，该差分方程的初始条件是 $\\psi_0 = 1$ 和 $\\psi_1 = \\phi_1$。\n\n我们现在用这些初始条件来求解 $c_1$ 和 $c_2$：\n对于 $h=0$：$\\psi_{0} = c_{1} r_{1}^{0} + c_{2} r_{2}^{0} \\implies c_{1} + c_{2} = 1$。\n对于 $h=1$：$\\psi_{1} = c_{1} r_{1}^{1} + c_{2} r_{2}^{1} \\implies c_{1} r_{1} + c_{2} r_{2} = \\phi_{1}$。\n\n这是一个关于 $c_1$ 和 $c_2$ 的二元一次方程组。从第一个方程，我们得到 $c_2 = 1 - c_1$。将其代入第二个方程：\n$$\nc_{1} r_{1} + (1 - c_{1}) r_{2} = \\phi_{1}\n$$\n$$\nc_{1} (r_{1} - r_{2}) = \\phi_{1} - r_{2}\n$$\n$$\nc_{1} = \\frac{\\phi_{1} - r_{2}}{r_{1} - r_{2}}\n$$\n对于 $c_2$：\n$$\nc_{2} = 1 - c_{1} = 1 - \\frac{\\phi_{1} - r_{2}}{r_{1} - r_{2}} = \\frac{(r_{1} - r_{2}) - (\\phi_{1} - r_{2})}{r_{1} - r_{2}} = \\frac{r_{1} - \\phi_{1}}{r_{1} - r_{2}}\n$$\n为了简化这些表达式，我们使用二次特征方程 $r^2 - \\phi_1 r - \\phi_2 = 0$ 的根的韦达定理。根的和为 $r_1 + r_2 = \\phi_1$。将 $\\phi_1 = r_1 + r_2$ 代入 $c_1$ 和 $c_2$ 的表达式中：\n$$\nc_{1} = \\frac{(r_{1} + r_{2}) - r_{2}}{r_{1} - r_{2}} = \\frac{r_{1}}{r_{1} - r_{2}}\n$$\n$$\nc_{2} = \\frac{r_{1} - (r_{1} + r_{2})}{r_{1} - r_{2}} = \\frac{-r_{2}}{r_{1} - r_{2}}\n$$\n现在，将这些系数代回答 $\\psi_h$ 的通解中：\n$$\n\\psi_{h} = \\left( \\frac{r_{1}}{r_{1} - r_{2}} \\right) r_{1}^{h} + \\left( \\frac{-r_{2}}{r_{1} - r_{2}} \\right) r_{2}^{h}\n$$\n合并各项，得到对于任何整数时期 $h \\ge 0$，IRF 系数 $\\psi_h$ 的最终闭式表达式：\n$$\n\\psi_{h} = \\frac{r_{1}^{h+1} - r_{2}^{h+1}}{r_{1} - r_{2}}\n$$\n这个表达式可以看作是比内公式的一个变体，比内公式是斐波那契数列的一个特例。\n\n关于 IRF 的定性形状：过程的协方差平稳性要求特征多项式的根位于单位圆内。由于根 $r_1, r_2$ 是实数，这意味着 $-1 < r_{1,2} < 1$。此条件确保 $\\lim_{h \\to \\infty} \\psi_h = 0$，即冲击的影响是暂时的。衰减的形状取决于根的符号。\n1.  如果两个根都是正数 ($0 < r_2 < r_1 < 1$)，IRF 系数 $\\psi_h$ 总是正的，并单调衰减至零。冲击会产生一个持续但递减的正向影响。\n2.  如果两个根符号相反（例如，$-1 < r_2 < 0 < r_1 < 1$），则 $r_2^h$ 项的符号会交替变化。因此，IRF 在衰减至零的过程中会表现出振荡。响应最初可能会增加或减少，并可能多次穿越零轴。\n3.  如果两个根都是负数（$-1 < r_2 < r_1 < 0$），则 $r_1^h$ 和 $r_2^h$ 的符号都会交替变化。IRF 将从 $\\psi_0=1$ 开始，在 $\\psi_1 = r_1+r_2 < 0$ 时变为负数，在 $\\psi_2 = r_1^2 + r_1 r_2 + r_2^2 > 0$ 时变为正数，依此类推。这会产生一种向零的显著的振荡性衰减。", "answer": "$$\n\\boxed{\\frac{r_{1}^{h+1} - r_{2}^{h+1}}{r_{1} - r_{2}}}\n$$"}, {"introduction": "在现实世界中，许多经济冲击（如技术革新或政策调整）并非一次性的，而是具有持续性。本练习在前一个练习的基础上，引入了一个自身遵循一阶自回归（$\\\\text{AR}(1)$）过程的持续性结构冲击，并要求你推导最终的脉冲响应。这能帮助你理解冲击自身的动态如何与系统动态相互作用，共同塑造变量的响应路径，这是向更高级的结构化模型分析迈出的关键一步。[@problem_id:2400800]", "id": "2400800", "problem": "考虑一个在计算经济学和金融学中常用的线性动态系统，该系统用于研究结构性冲击对宏观经济变量的影响。设内生变量 $y_t$ 的演化过程如下\n$$\ny_t = a\\,y_{t-1} + b\\,u_t,\n$$\n其中 $a$ 和 $b$ 为实常数，$u_t$ 是一个遵循一阶自回归过程的结构性冲击\n$$\nu_t = \\rho\\,u_{t-1} + \\varepsilon_t,\n$$\n其中 $|\\rho|<1$。序列 $\\{\\varepsilon_t\\}$ 代表结构性创新，对于所有 $t\\neq 0$ 都有 $\\varepsilon_t=0$，且在 $t=0$ 时刻有一次单位创新，即 $\\varepsilon_0=1$。假设系统从其确定性稳态开始，因此 $y_{-1}=0$ 且 $u_{-1}=0$。同时假设 $|a|<1$ 且 $a\\neq \\rho$。\n\n将脉冲响应函数（IRF）定义为在给定初始条件且所有其他创新为零的情况下，$y_t$ 对单位结构性创新 $\\varepsilon_0$ 的响应序列。请仅使用模型方程、IRF 的定义以及诸如几何级数求和闭式解等公认事实，从第一性原理出发，推导出 $y_t$ 在整数时期 $h\\ge 0$ 的 IRF，并将其表示为关于 $a$、$b$、$\\rho$ 和 $h$ 的闭式解析函数。\n\n您的最终答案必须是时期 $h$ 的 IRF 的单一闭式解析表达式。不需要进行数值近似。如果在中间步骤中使用了求和，您的最终答案必须将其简化为单一的闭式表达式。", "solution": "在尝试求解之前，将首先对问题进行严格的验证。\n\n### 步骤 1：提取已知条件\n问题陈述中明确给出的已知条件如下：\n- 内生变量 $y_t$ 的演化过程：\n$$y_t = a\\,y_{t-1} + b\\,u_t$$\n- 结构性冲击 $u_t$ 的过程：\n$$u_t = \\rho\\,u_{t-1} + \\varepsilon_t$$\n- 常数及其性质：$a$、$b$ 和 $\\rho$ 是实常数。给定了以下约束：$|\\rho|<1$，$|a|<1$，以及 $a \\neq \\rho$。\n- 结构性创新序列 $\\{\\varepsilon_t\\}$ 定义为，对于所有 $t\\neq 0$ 都有 $\\varepsilon_t=0$，且 $\\varepsilon_0=1$。\n- 初始条件：系统处于其确定性稳态，意味着 $y_{-1}=0$ 和 $u_{-1}=0$。\n- 脉冲响应函数（IRF）的定义：IRF 是 $y_t$ 对单一单位创新 $\\varepsilon_0=1$ 的响应序列，此处记为 $y_h$，其中时期 $h \\ge 0$。\n- 任务是推导出时期 $h$ 的 IRF（即 $y_h$）的闭式解析表达式，该表达式是关于 $a$、$b$、$\\rho$ 和 $h$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n\n- **科学依据**：该问题描述了一个线性时不变（LTI）系统，这是时间序列分析、计量经济学和控制理论的基石。该模型是向量自回归（VAR）或动态随机一般均衡（DSGE）模型的简化表示，这些都是计算经济学和金融学中的标准工具。脉冲响应函数的概念对于分析此类系统至关重要。该问题在科学上是合理的。\n\n- **适定性**：该问题是适定的。初始条件（$y_{-1}=0, u_{-1}=0$）和冲击的特定性质（在 $t=0$ 时刻的单次脉冲）提供了一个完整的设定。约束条件 $|a|<1$ 和 $|\\rho|<1$ 确保了系统的稳定性，保证了脉冲响应收敛且不表现出爆炸性行为。条件 $a \\neq \\rho$ 对于避免解中出现除以零的奇点至关重要，从而防止问题退化。存在一个唯一的、稳定的、有意义的解。\n\n- **客观性**：该问题以精确的数学语言陈述，没有任何主观或模棱两可的术语。\n\n该问题不违反任何无效标准。它是动态系统分析中一个标准的、定义明确的练习。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将从第一性原理推导求解。\n\n### 脉冲响应函数的推导\n\n目标是在给定系统动态和单次冲击 $\\varepsilon_0=1$ 的情况下，求出任意整数时期 $h \\ge 0$ 的 $y_h$ 的表达式。\n\n首先，我们确定在 $t=0$ 时刻发生创新后，冲击过程 $u_t$ 的路径。该过程由 $u_t = \\rho u_{t-1} + \\varepsilon_t$ 给出。初始条件为 $u_{-1}=0$。\n\n当 $t=0$ 时：\n$$u_0 = \\rho u_{-1} + \\varepsilon_0 = \\rho(0) + 1 = 1$$\n当 $t=1$ 时：\n$$u_1 = \\rho u_0 + \\varepsilon_1 = \\rho(1) + 0 = \\rho$$\n当 $t=2$ 时：\n$$u_2 = \\rho u_1 + \\varepsilon_2 = \\rho(\\rho) + 0 = \\rho^2$$\n通过简单的归纳法，对于任何 $t \\ge 0$，冲击过程的路径由下式给出：\n$$u_t = \\rho^t$$\n\n接下来，我们将 $u_t$ 的这个表达式代入 $y_t$ 的方程中：\n$$y_t = a y_{t-1} + b \\rho^t$$\n这是一个一阶线性差分方程。我们可以从初始条件 $y_{-1}=0$ 开始，通过递归向前代入法求解 $y_t$。对于 $t \\ge 0$ 的响应 $y_t$ 代表了 IRF。\n\n当 $t=0$ 时：\n$$y_0 = a y_{-1} + b \\rho^0 = a(0) + b(1) = b$$\n当 $t=1$ 时：\n$$y_1 = a y_0 + b \\rho^1 = a(b) + b \\rho = b(a+\\rho)$$\n当 $t=2$ 时：\n$$y_2 = a y_1 + b \\rho^2 = a(b(a+\\rho)) + b \\rho^2 = b(a^2 + a\\rho + \\rho^2)$$\n这揭示了一个模式。为了推导一般形式，我们可以从一个通用时间 $t$ 开始，通过向后迭代来解这个差分方程。\n$$y_t = a y_{t-1} + b \\rho^t$$\n代入 $y_{t-1}$：\n$$y_t = a(a y_{t-2} + b \\rho^{t-1}) + b \\rho^t = a^2 y_{t-2} + ab\\rho^{t-1} + b\\rho^t$$\n持续这个代换过程，直到我们达到初始条件 $y_{-1}$：\n$$y_t = a^{t+1} y_{-1} + \\sum_{k=0}^{t} a^k (b \\rho^{t-k})$$\n由于初始条件 $y_{-1}=0$，第一项消失：\n$$y_t = b \\sum_{k=0}^{t} a^k \\rho^{t-k}$$\n为了得到闭式解，我们必须计算这个求和。我们可以通过提出因子 $\\rho^t$ 来重写这个和：\n$$y_t = b \\rho^t \\sum_{k=0}^{t} a^k \\rho^{-k} = b \\rho^t \\sum_{k=0}^{t} \\left(\\frac{a}{\\rho}\\right)^k$$\n该求和是一个形式为 $\\sum_{k=0}^{n} r^k$ 的有限几何级数，其中 $n=t$，公比为 $r = \\frac{a}{\\rho}$。由于问题陈述 $a \\neq \\rho$，我们有 $r \\neq 1$。有限几何级数的求和公式为：\n$$\\sum_{k=0}^{n} r^k = \\frac{1-r^{n+1}}{1-r}$$\n将此公式应用于我们关于 $y_t$ 的表达式：\n$$\\sum_{k=0}^{t} \\left(\\frac{a}{\\rho}\\right)^k = \\frac{1 - \\left(\\frac{a}{\\rho}\\right)^{t+1}}{1 - \\frac{a}{\\rho}}$$\n现在，将此结果代回 $y_t$ 的方程中：\n$$y_t = b \\rho^t \\left( \\frac{1 - \\frac{a^{t+1}}{\\rho^{t+1}}}{1 - \\frac{a}{\\rho}} \\right)$$\n我们将这个表达式简化为其最终形式：\n$$y_t = b \\rho^t \\left( \\frac{\\frac{\\rho^{t+1} - a^{t+1}}{\\rho^{t+1}}}{\\frac{\\rho - a}{\\rho}} \\right) = b \\rho^t \\left( \\frac{\\rho^{t+1} - a^{t+1}}{\\rho^{t+1}} \\cdot \\frac{\\rho}{\\rho - a} \\right)$$\n$$y_t = b \\rho^t \\left( \\frac{\\rho^{t+1} - a^{t+1}}{\\rho^t (\\rho - a)} \\right)$$\n消去 $\\rho^t$ 项后得到：\n$$y_t = b \\frac{\\rho^{t+1} - a^{t+1}}{\\rho - a}$$\n问题要求的是整数时期 $h \\ge 0$ 的 IRF。我们只需将 $t$ 替换为 $h$。$y$ 在时期 $h$ 的脉冲响应是：\n$$y_h = b \\frac{\\rho^{h+1} - a^{h+1}}{\\rho - a}$$\n这就是 IRF 的最终闭式解析表达式。稳定性条件 $|a|<1$ 和 $|\\rho|<1$ 确保了当 $h \\to \\infty$ 时，$y_h \\to 0$，这对于一个稳定系统对暂时性冲击的响应是符合预期的。", "answer": "$$\\boxed{b \\frac{\\rho^{h+1} - a^{h+1}}{\\rho - a}}$$"}, {"introduction": "理论学习的最终目的是应用于实践。这个练习将你带入应用宏观经济学家的角色，处理一个简化的双变量结构向量自回归（$\\\\text{SVAR}$）模型。你将学习如何区分不同类型的经济冲击（供给与需求），并计算它们对关键变量（如通货膨胀）的累积影响，从而将抽象的理论知识与具体的经验分析任务联系起来。[@problem_id:2400780]", "id": "2400780", "problem": "考虑一个用于计算经济学和金融学中研究脉冲响应函数（IRF）的双变量线性时不变离散时间结构系统：\n$$\n\\mathbf{x}_t = A \\mathbf{x}_{t-1} + B \\mathbf{e}_t,\n$$\n其中 $\\mathbf{x}_t \\in \\mathbb{R}^2$ 叠加了变量 $\\mathbf{x}_t = \\begin{bmatrix} p^c_t \\\\ \\pi_t \\end{bmatrix}$，$p^c_t$ 表示商品价格通胀，$\\pi_t$ 表示总体通胀。结构性冲击 $\\mathbf{e}_t \\in \\mathbb{R}^2$ 满足 $\\mathbb{E}[\\mathbf{e}_t] = \\mathbf{0}$ 和 $\\mathbb{E}[\\mathbf{e}_t \\mathbf{e}_t'] = I_2$。$2 \\times 2$ 矩阵 $A$ 和 $B$ 不随时间变化。结构性识别如下：第一个冲击是供给侧冲击，第二个冲击是需求侧冲击，通过对商品价格的影响来识别，并带有符号约束，即 $B$ 矩阵第一列的第一个元素为负（供给侧冲击在冲击发生时使 $p^c_t$ 下降），$B$ 矩阵第二列的第一个元素为正（需求侧冲击在冲击发生时使 $p^c_t$ 上升）。\n\n对于在时间 $t=0$ 时发生的一次性单位结构性冲击 $j \\in \\{1,2\\}$，$\\mathbf{x}_{h}$ 在期 H $h \\in \\{0,1,2,\\ldots\\}$ 的脉冲响应函数（IRF）定义为\n$$\n\\mathrm{IRF}_j(h) = A^h \\mathbf{b}_j,\n$$\n其中 $\\mathbf{b}_j$ 是 $B$ 的第 $j$ 列。在期 H $h$ 时，通胀对冲击 $j$ 的脉冲响应函数是 $\\mathrm{IRF}_j(h)$ 的第二个分量，即 $\\left[\\mathrm{IRF}_j(h)\\right]_2$。\n\n对于下面的每个参数集，将需求侧冲击在期 H $h = 0,1,\\ldots,H$ 上的累积通胀响应定义为\n$$\nC^{\\text{dem}} = \\sum_{h=0}^{H} \\left[\\mathrm{IRF}_2(h)\\right]_2,\n$$\n并将供给侧冲击的累积通胀响应定义为\n$$\nC^{\\text{sup}} = \\sum_{h=0}^{H} \\left[\\mathrm{IRF}_1(h)\\right]_2.\n$$\n计算比较标量\n$$\n\\Delta = C^{\\text{dem}} - C^{\\text{sup}}.\n$$\n\n您的任务是编写一个完整的程序，为以下每个参数集计算作为实数的 $\\Delta$。不涉及物理单位。\n\n测试套件（每个案例指定 $A$、$B$ 和 $H$）：\n1. 案例 1:\n   $$\n   A = \\begin{bmatrix} 0.6 & 0.0 \\\\ 0.2 & 0.5 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.5 & 0.6 \\\\ 0.1 & 0.3 \\end{bmatrix}, \\quad\n   H = 20.\n   $$\n2. 案例 2:\n   $$\n   A = \\begin{bmatrix} 0.9 & 0.0 \\\\ 0.1 & 0.95 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.2 & 0.2 \\\\ 0.05 & 0.25 \\end{bmatrix}, \\quad\n   H = 40.\n   $$\n3. 案例 3（$A$ 中有重复特征值的边界条件）：\n   $$\n   A = \\begin{bmatrix} 0.8 & 0.0 \\\\ 0.3 & 0.8 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.3 & 0.3 \\\\ 0.02 & 0.15 \\end{bmatrix}, \\quad\n   H = 30.\n   $$\n4. 案例 4:\n   $$\n   A = \\begin{bmatrix} 0.2 & 0.0 \\\\ 0.5 & 0.3 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.1 & 0.1 \\\\ 0.0 & 0.1 \\end{bmatrix}, \\quad\n   H = 10.\n   $$\n\n您的程序必须为每个案例计算 $\\Delta$，并生成单行输出，其中包含四个结果，按案例顺序列出，形式为方括号内以逗号分隔的浮点数列表。每个浮点数表示为小数点后六位。例如，包含四个结果的输出应如下所示\n$$\n[\\delta_1,\\delta_2,\\delta_3,\\delta_4],\n$$\n其中每个 $\\delta_i$ 表示为案例 $i$ 计算出的 $\\Delta$ 值，保留六位小数。", "solution": "所述问题定义严谨、内容完整，并与应用于计算计量经济学的线性系统理论原理一致。未检测到不一致或谬误之处。因此，我们可以进行形式化求解。\n\n该问题要求计算一个标量 $\\Delta$，它表示总体通胀（$\\pi_t$）对需求侧冲击和供给侧冲击的累积脉冲响应之差。系统动态由以下线性模型决定：\n$$\n\\mathbf{x}_t = A \\mathbf{x}_{t-1} + B \\mathbf{e}_t\n$$\n其中 $\\mathbf{x}_t = \\begin{bmatrix} p^c_t \\\\ \\pi_t \\end{bmatrix}$。\n\n脉冲响应函数 $\\mathrm{IRF}_j(h)$ 衡量在时间 $t=0$ 时，类型为 $j \\in \\{1, 2\\}$ 的单位结构性冲击对期 H $h$ 的状态向量 $\\mathbf{x}_h$ 的影响。它由以下公式给出：\n$$\n\\mathrm{IRF}_j(h) = A^h \\mathbf{b}_j\n$$\n其中 $\\mathbf{b}_j$ 是矩阵 $B$ 的第 $j$ 列。冲击 $j=1$ 对应供给侧冲击，冲击 $j=2$ 对应需求侧冲击。\n\n我们关心的是第二个变量，即总体通胀 $\\pi_t$ 的响应。为了从向量 $\\mathrm{IRF}_j(h)$ 中提取这个分量，我们使用标准基向量 $\\mathbf{e}_2' = \\begin{bmatrix} 0 & 1 \\end{bmatrix}$。在期 H $h$ 时，通胀对冲击 $j$ 的响应是：\n$$\n[\\mathrm{IRF}_j(h)]_2 = \\mathbf{e}_2' \\mathrm{IRF}_j(h) = \\mathbf{e}_2' A^h \\mathbf{b}_j\n$$\n\n该问题定义了在期 H $h=0, 1, \\ldots, H$ 上的累积通胀响应。对需求侧冲击 ($j=2$) 的累积响应是：\n$$\nC^{\\text{dem}} = \\sum_{h=0}^{H} [\\mathrm{IRF}_2(h)]_2 = \\sum_{h=0}^{H} \\mathbf{e}_2' A^h \\mathbf{b}_2\n$$\n对供给侧冲击 ($j=1$) 的累积响应是：\n$$\nC^{\\text{sup}} = \\sum_{h=0}^{H} [\\mathrm{IRF}_1(h)]_2 = \\sum_{h=0}^{H} \\mathbf{e}_2' A^h \\mathbf{b}_1\n$$\n\n根据矩阵运算的线性性质，我们可以从求和中提取出常数项：\n$$\nC^{\\text{dem}} = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_2\n$$\n$$\nC^{\\text{sup}} = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_1\n$$\n\n目标量是 $\\Delta = C^{\\text{dem}} - C^{\\text{sup}}$。代入上述表达式：\n$$\n\\Delta = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_2 - \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_1\n$$\n再次进行因式分解，得到一个更紧凑的表达式：\n$$\n\\Delta = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) (\\mathbf{b}_2 - \\mathbf{b}_1)\n$$\n这是我们计算的基本方程。\n\n项 $\\sum_{h=0}^{H} A^h$ 是一个有限矩阵几何级数。直接的迭代求和在计算上是有效的，但效率不高。一种更优美且数值上更优越的方法是使用几何和的封闭形式解。设 $S_H = \\sum_{h=0}^{H} A^h = I + A + A^2 + \\dots + A^H$。那么我们有 $(I - A)S_H = (I - A)(I + A + \\dots + A^H) = I - A^{H+1}$。\n如果矩阵 $(I - A)$ 是可逆的，我们可以写成：\n$$\nS_H = (I - A^{H+1}) (I - A)^{-1}\n$$\n如果 1 不是 $A$ 的特征值，则 $(I - A)$ 的可逆性得到保证。对于给定的经济系统，稳定性要求 $A$ 的所有特征值都位于单位圆内，这意味着它们的模严格小于 1。对所提供的矩阵 $A$ 的检查证实，所有测试案例都满足此条件。因此，使用此封闭形式表达式是合理且正确的。\n\n因此，$\\Delta$ 的最终计算公式为：\n$$\n\\Delta = \\mathbf{e}_2' \\left[ (I - A^{H+1}) (I - A)^{-1} \\right] (\\mathbf{b}_2 - \\mathbf{b}_1)\n$$\n\n每个测试案例的算法如下：\n1. 给定矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$、$B \\in \\mathbb{R}^{2 \\times 2}$ 和整数期 H $H$。\n2. 从 $B$ 中提取列向量 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$。\n3. 计算差分向量 $\\mathbf{b}_{\\text{diff}} = \\mathbf{b}_2 - \\mathbf{b}_1$。\n4. 计算矩阵的幂 $A^{H+1}$。\n5. 计算矩阵的逆 $(I - A)^{-1}$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n6. 计算矩阵和 $S_H = (I - A^{H+1}) (I - A)^{-1}$。\n7. 计算结果向量 $\\mathbf{v} = S_H \\mathbf{b}_{\\text{diff}}$。\n8. 标量 $\\Delta$ 是向量 $\\mathbf{v}$ 的第二个元素，即 $\\Delta = [\\mathbf{v}]_2$。\n\n此过程是稳健的，并将为所有指定的测试案例实施。数值精度将通过标准浮点运算处理，最终输出将按要求格式化为六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the comparison scalar Delta for each test case according to the problem definition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": np.array([[0.6, 0.0], [0.2, 0.5]]),\n            \"B\": np.array([[-0.5, 0.6], [0.1, 0.3]]),\n            \"H\": 20,\n        },\n        {\n            \"A\": np.array([[0.9, 0.0], [0.1, 0.95]]),\n            \"B\": np.array([[-0.2, 0.2], [0.05, 0.25]]),\n            \"H\": 40,\n        },\n        {\n            \"A\": np.array([[0.8, 0.0], [0.3, 0.8]]),\n            \"B\": np.array([[-0.3, 0.3], [0.02, 0.15]]),\n            \"H\": 30,\n        },\n        {\n            \"A\": np.array([[0.2, 0.0], [0.5, 0.3]]),\n            \"B\": np.array([[-0.1, 0.1], [0.0, 0.1]]),\n            \"H\": 10,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        A = case[\"A\"]\n        B = case[\"B\"]\n        H = case[\"H\"]\n\n        # The dimension of the system, n=2.\n        n = A.shape[0]\n        I = np.identity(n)\n\n        # Extract columns of B, corresponding to supply (b1) and demand (b2) shocks.\n        b1 = B[:, 0]\n        b2 = B[:, 1]\n        \n        # Compute the difference vector b_diff = b2 - b1.\n        b_diff = b2 - b1\n\n        # The core calculation is based on the formula:\n        # Delta = e2' * [sum_{h=0 to H} A^h] * (b2 - b1)\n        # where the sum is a finite geometric series of matrices.\n        # sum_{h=0 to H} A^h = (I - A^(H+1)) * (I - A)^(-1)\n\n        # Compute A^(H+1)\n        A_pow_H1 = np.linalg.matrix_power(A, H + 1)\n\n        # Compute (I - A)^(-1)\n        I_minus_A_inv = np.linalg.inv(I - A)\n\n        # Compute the matrix sum S_H\n        S_H = (I - A_pow_H1) @ I_minus_A_inv\n\n        # Compute the cumulative response vector\n        cumulative_response_vector = S_H @ b_diff\n\n        # The scalar Delta is the second component of the response vector (inflation response).\n        delta = cumulative_response_vector[1]\n\n        results.append(delta)\n\n    # Format the final output as a comma-separated list of floats with six decimal places, enclosed in brackets.\n    output_str = f\"[{','.join(f'{r:.6f}' for r in results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"}]}