{"hands_on_practices": [{"introduction": "自回归模型的一个关键特性是平稳性，这意味着序列的统计特性不随时间改变。对于一个平稳的 AR(1) 过程，它会围绕一个恒定的长期均值波动。这个练习将通过一个具体的经济学场景，帮助你计算这个长期均值，从而让你亲身体验模型参数如何决定时间序列的中心趋势。[@problem_id:1897485]", "id": "1897485", "problem": "一个经济研究小组正在对某个国家的季度通胀异常（记为 $I_t$）进行建模。该异常被定义为观测到的通货膨胀率与中央银行目标通胀率之间的偏差。该小组的分析表明，这个时间序列可以用以下形式的一阶自回归 (AR(1)) 模型来有效描述：\n\n$I_t = \\alpha + \\beta I_{t-1} + \\epsilon_t$\n\n此处，$I_t$ 表示第 $t$ 季度的通胀异常，单位为百分点。该模型包含一个常数截距 $\\alpha = 0.4$ 和一个自回归系数 $\\beta = 0.75$，该系数捕捉了上一季度异常的持续性。项 $\\epsilon_t$ 是一个白噪声过程，其特征为均值为零和方差恒定，代表了对通货膨胀的不可预测的冲击。\n\n假设通胀异常的时间序列过程是平稳的，计算其长期期望值。答案以百分点表示。", "solution": "给定通胀异常的 AR(1) 过程：\n$$\nI_{t} = \\alpha + \\beta I_{t-1} + \\epsilon_{t},\n$$\n其中 $\\alpha = 0.4$，$\\beta = 0.75$，且 $\\epsilon_{t}$ 是一个白噪声过程，其期望 $\\mathbb{E}[\\epsilon_{t}] = 0$。在平稳性假设下（这要求 $|\\beta| &lt; 1$），长期期望值（或无条件均值）是一个常数，等于 $\\mu = \\mathbb{E}[I_{t}]$。\n\n对模型两边取期望：\n$$\n\\mathbb{E}[I_{t}] = \\mathbb{E}[\\alpha + \\beta I_{t-1} + \\epsilon_{t}] = \\alpha + \\beta \\mathbb{E}[I_{t-1}] + \\mathbb{E}[\\epsilon_{t}].\n$$\n使用 $\\mathbb{E}[\\epsilon_{t}] = 0$ 和平稳性条件 $\\mathbb{E}[I_{t}] = \\mathbb{E}[I_{t-1}] = \\mu$，我们得到：\n$$\n\\mu = \\alpha + \\beta \\mu.\n$$\n整理得，\n$$\n\\mu - \\beta \\mu = \\alpha \\quad \\Rightarrow \\quad \\mu (1 - \\beta) = \\alpha \\quad \\Rightarrow \\quad \\mu = \\frac{\\alpha}{1 - \\beta}.\n$$\n代入 $\\alpha = 0.4$ 和 $\\beta = 0.75$，\n$$\n\\mu = \\frac{0.4}{1 - 0.75} = \\frac{0.4}{0.25} = 1.6.\n$$\n因此，通胀异常的長期期望值为 $1.6$ 个百分点。", "answer": "$$\\boxed{1.6}$$"}, {"introduction": "在理解了自回归模型的基本属性之后，下一步是学习如何从数据中估计其参数。Yule-Walker 方程提供了一种经典而有力的方法，它通过建立模型的自相关函数与自回归系数之间的联系来实现参数估计。通过解决这个练习，你将手动推导并计算一个 AR(2) 模型的系数，从而深刻理解模型拟合的内在机制。[@problem_id:2373810]", "id": "2373810", "problem": "一个去均值的、弱平稳的月度超额收益序列 $\\{r_{t}\\}$ 被建模为一个2阶自回归(AR)模型，即\n$r_{t} = \\phi_{1} r_{t-1} + \\phi_{2} r_{t-2} + \\varepsilon_{t}$，\n其中 $\\{\\varepsilon_{t}\\}$ 是一个均值为零、方差为 $\\sigma_{\\varepsilon}^{2}$ 的白噪声新息过程，并且对于所有 $s < t$，$\\varepsilon_{t}$ 与 $\\{r_{s}\\}$ 不相关。从一个长样本中，计算出滞后阶数为 $0$、$1$ 和 $2$ 时的样本自协方差如下，并将它们视为用于估计的总体值：\n$\\hat{\\gamma}(0) = 0.010$，$\\hat{\\gamma}(1) = 0.006$，$\\hat{\\gamma}(2) = 0.002$。\n使用与该自回归结构相关的 Yule–Walker 方程和给定的自协方差，确定参数 $\\phi_{1}$、$\\phi_{2}$ 和新息方差 $\\sigma_{\\varepsilon}^{2}$ 的 Yule–Walker 估计量。将您的最终答案表示为单行矩阵 $\\left(\\phi_{1} \\ \\phi_{2} \\ \\sigma_{\\varepsilon}^{2}\\right)$。无需四舍五入；请提供精确值。", "solution": "该问题要求使用 Yule-Walker 方程确定一个2阶弱平稳自回归模型（AR($2$)）的参数。这构成了时间序列分析中矩估计法的标准应用。\n\n首先，我们必须验证题干的陈述。\n给定信息如下：\n- 过程 $\\{r_{t}\\}$ 是一个去均值的、弱平稳的 AR($2$) 过程：$r_{t} = \\phi_{1} r_{t-1} + \\phi_{2} r_{t-2} + \\varepsilon_{t}$。\n- 新息过程 $\\{\\varepsilon_{t}\\}$ 是均值为零、方差为 $\\sigma_{\\varepsilon}^{2}$ 的白噪声。\n- 总体自协方差被假定为给定的样本值：$\\gamma(0) = 0.010$，$\\gamma(1) = 0.006$ 和 $\\gamma(2) = 0.002$。\n\n该问题有科学依据、是适定且客观的。它提供了一套完整且一致的数据，足以得到唯一解。对于一个平稳过程，这些自协方差值是合理的；方差 $\\gamma(0)$ 是正的，且相应的自相关系数 $\\rho(1) = \\frac{\\gamma(1)}{\\gamma(0)} = 0.6$ 和 $\\rho(2) = \\frac{\\gamma(2)}{\\gamma(0)} = 0.2$ 均在有效范围 $[-1, 1]$ 内。因此，该问题被认为是有效的。\n\n我们继续求解。对于一个一般的 AR($p$) 过程，Yule-Walker 方程是通过将定义方程乘以 $r_{t-k}$ (对于 $k > 0$) 并取期望来推导的。这得到：\n$$E[r_{t}r_{t-k}] = \\sum_{i=1}^{p} \\phi_{i} E[r_{t-i}r_{t-k}] + E[\\varepsilon_{t}r_{t-k}]$$\n考虑到弱平稳性以及 $\\varepsilon_{t}$ 与过去的 $r_s$ 值不相关（即，对于$k>0$，$E[\\varepsilon_{t}r_{t-k}]=0$），该式可简化为：\n$$\\gamma(k) = \\sum_{i=1}^{p} \\phi_{i} \\gamma(k-i)$$\n对于给定的 AR($2$) 过程，我们设 $p=2$，并使用 $k=1$ 和 $k=2$：\n对于 $k=1$：$\\gamma(1) = \\phi_{1} \\gamma(0) + \\phi_{2} \\gamma(-1)$。因为 $\\gamma(k) = \\gamma(-k)$，所以该式为 $\\gamma(1) = \\phi_{1} \\gamma(0) + \\phi_{2} \\gamma(1)$。\n对于 $k=2$：$\\gamma(2) = \\phi_{1} \\gamma(1) + \\phi_{2} \\gamma(0)$。\n\n这给出了一个关于两个未知参数 $\\phi_{1}$ 和 $\\phi_{2}$ 的二元线性方程组：\n$$\n\\begin{cases}\n\\gamma(1) = \\phi_{1} \\gamma(0) + \\phi_{2} \\gamma(1) \\\\\n\\gamma(2) = \\phi_{1} \\gamma(1) + \\phi_{2} \\gamma(0)\n\\end{cases}\n$$\n写成矩阵形式为：\n$$\n\\begin{pmatrix} \\gamma(1) \\\\ \\gamma(2) \\end{pmatrix} =\n\\begin{pmatrix} \\gamma(0) & \\gamma(1) \\\\ \\gamma(1) & \\gamma(0) \\end{pmatrix}\n\\begin{pmatrix} \\phi_{1} \\\\ \\phi_{2} \\end{pmatrix}\n$$\n题目要求使用提供的样本自协方差作为总体值。为保持精度，我们将小数值转换为分数：\n$\\gamma(0) = 0.010 = \\frac{10}{1000} = \\frac{1}{100}$\n$\\gamma(1) = 0.006 = \\frac{6}{1000} = \\frac{3}{500}$\n$\\gamma(2) = 0.002 = \\frac{2}{1000} = \\frac{1}{500}$\n\n将这些值代入方程组中：\n$$\n\\begin{cases}\n\\frac{3}{500} = \\phi_{1} \\frac{1}{100} + \\phi_{2} \\frac{3}{500} \\\\\n\\frac{1}{500} = \\phi_{1} \\frac{3}{500} + \\phi_{2} \\frac{1}{100}\n\\end{cases}\n$$\n为简化计算，我们将两个方程都乘以 $500$：\n$$\n\\begin{cases}\n3 = 5\\phi_{1} + 3\\phi_{2} \\\\\n1 = 3\\phi_{1} + 5\\phi_{2}\n\\end{cases}\n$$\n我们可以解这个方程组。从第二个方程可知，$3\\phi_{1} = 1 - 5\\phi_{2}$，因此 $\\phi_{1} = \\frac{1 - 5\\phi_{2}}{3}$。将其代入第一个方程：\n$$3 = 5\\left(\\frac{1 - 5\\phi_{2}}{3}\\right) + 3\\phi_{2}$$\n乘以 $3$ 得到：\n$$9 = 5(1 - 5\\phi_{2}) + 9\\phi_{2}$$\n$$9 = 5 - 25\\phi_{2} + 9\\phi_{2}$$\n$$4 = -16\\phi_{2}$$\n$$\\phi_{2} = -\\frac{4}{16} = -\\frac{1}{4}$$\n现在，我们求 $\\phi_{1}$：\n$$\\phi_{1} = \\frac{1 - 5(-\\frac{1}{4})}{3} = \\frac{1 + \\frac{5}{4}}{3} = \\frac{\\frac{9}{4}}{3} = \\frac{9}{12} = \\frac{3}{4}$$\n自回归系数的 Yule-Walker 估计量为 $\\phi_{1} = \\frac{3}{4}$ 和 $\\phi_{2} = -\\frac{1}{4}$。\n\n接下来，我们必须求出新息方差 $\\sigma_{\\varepsilon}^{2}$。这可以从 $k=0$ 时的 Yule-Walker 方程得到，该方程涉及到过程的方差 $\\gamma(0)$。我们将 AR($2$) 方程乘以 $r_t$ 并取期望：\n$$E[r_{t}^2] = \\phi_{1} E[r_{t}r_{t-1}] + \\phi_{2} E[r_{t}r_{t-2}] + E[r_{t}\\varepsilon_{t}]$$\n$$\\gamma(0) = \\phi_{1} \\gamma(1) + \\phi_{2} \\gamma(2) + E[(\\phi_{1}r_{t-1} + \\phi_{2}r_{t-2} + \\varepsilon_{t})\\varepsilon_{t}]$$\n因为 $\\varepsilon_{t}$ 与过去的 $r$ 值不相关，所以 $E[r_{t-1}\\varepsilon_{t}]=0$ 且 $E[r_{t-2}\\varepsilon_{t}]=0$。这得到：\n$$\\gamma(0) = \\phi_{1}\\gamma(1) + \\phi_{2}\\gamma(2) + E[\\varepsilon_{t}^2]$$\n$$\\gamma(0) = \\phi_{1}\\gamma(1) + \\phi_{2}\\gamma(2) + \\sigma_{\\varepsilon}^{2}$$\n解出 $\\sigma_{\\varepsilon}^{2}$：\n$$\\sigma_{\\varepsilon}^{2} = \\gamma(0) - \\phi_{1}\\gamma(1) - \\phi_{2}\\gamma(2)$$\n代入已知值：\n$$\\sigma_{\\varepsilon}^{2} = \\frac{1}{100} - \\left(\\frac{3}{4}\\right)\\left(\\frac{3}{500}\\right) - \\left(-\\frac{1}{4}\\right)\\left(\\frac{1}{500}\\right)$$\n$$\\sigma_{\\varepsilon}^{2} = \\frac{1}{100} - \\frac{9}{2000} + \\frac{1}{2000}$$\n$$\\sigma_{\\varepsilon}^{2} = \\frac{1}{100} - \\frac{8}{2000} = \\frac{1}{100} - \\frac{1}{250}$$\n使用公分母 $500$：\n$$\\sigma_{\\varepsilon}^{2} = \\frac{5}{500} - \\frac{2}{500} = \\frac{3}{500}$$\n因此，新息方差为 $\\sigma_{\\varepsilon}^{2} = \\frac{3}{500}$。\n\n所求参数为 $\\phi_{1} = \\frac{3}{4}$、$\\phi_{2} = -\\frac{1}{4}$ 和 $\\sigma_{\\varepsilon}^{2} = \\frac{3}{500}$。我们以要求的单行矩阵格式呈现这些参数。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{4} & -\\frac{1}{4} & \\frac{3}{500}\n\\end{pmatrix}\n}\n$$"}, {"introduction": "在实际应用中，选择正确的模型阶数（AR($p$) 中的 $p$）至关重要，但我们通常无法预先知道真实的阶数。这个高级练习旨在探讨模型设定不当的后果，特别是当使用一个过于简单的模型（如 AR(1)）去拟合一个更复杂过程（如 AR(3)）时会发生什么。通过从第一性原理出发推导和计算由此产生的估计偏差和预测效率损失，你将培养对模型选择的批判性思维，并理解其对参数估计和预测准确性的深远影响。[@problem_id:2373867]", "id": "2373867", "problem": "考虑一个定义在零均值概率空间上的有限阶严格平稳自回归 (AR) 过程。设数据生成过程为一个三阶自回归过程，记为 AR($3$)，由下式给出\n$$\ny_t = \\phi_1 y_{t-1} + \\phi_2 y_{t-2} + \\phi_3 y_{t-3} + \\varepsilon_t,\n$$\n其中 $\\{\\varepsilon_t\\}$ 是一个独立同分布序列，满足 $\\mathbb{E}[\\varepsilon_t] = 0$ 和 $\\mathrm{Var}(\\varepsilon_t) = \\sigma^2$，并且自回归多项式的所有根都在单位圆外，因此该过程是平稳的。令 $\\gamma(k) = \\mathbb{E}[y_t y_{t-k}]$ 表示滞后 $k$ 阶的总体自协方差。在计算经济学和金融学的许多实证应用中，为了模型简约或由于数据有限，会估计一个低阶自回归模型。本问题要求您从第一性原理出发，量化在真实模型为 AR($3$) 时，因估计 AR($1$) 模型而省略相关滞后项所带来的后果。\n\n从以下基本依据出发：\n- 平稳自回归的定义及其连接 $\\gamma(k)$ 和自回归系数的总体矩条件。\n- 作为均方误差最小化子的线性最小二乘投影的定义。\n- 在线性最小二乘投影中包含额外的有效回归量不会增加可达到的最小均方误差这一事实。\n\n任务：\n1. 仅使用这些基本依据，推导由 AR($3$) 模型蕴含的、关联 $\\gamma(0)$、$\\gamma(1)$、$\\gamma(2)$、$\\gamma(3)$ 与 $\\phi_1$、$\\phi_2$、$\\phi_3$、$\\sigma^2$ 的总体正规方程。然后，推导出一个可用于求解 $\\gamma(0)$、$\\gamma(1)$、$\\gamma(2)$ 和 $\\gamma(3)$ 的线性系统。\n2. 使用线性最小二乘投影的定义，推导在 AR($1$) 约束下最小化 $\\mathbb{E}[(y_t - \\theta y_{t-1})^2]$ 的伪真 AR($1$) 系数 $\\theta^\\star$，并用总体自协方差表示。\n3. 推导在使用错误设定的AR($1$)预测器预测$y_{t+1}$时的单步向前预测均方误差，并用 $\\gamma(0)$ 和 $\\gamma(1)$ 表示。将其与正确设定的AR($3$)模型下可达到的最小单步向前预测均方误差（用 $\\sigma^2$ 表示）进行比较。将这两个均方误差的比率定义为预测效率损失。\n\n实现要求：\n- 实现一个程序，对于下面测试套件中的每个参数集，计算：\n  - 伪真 AR($1$) 系数 $\\theta^\\star$；\n  - 因省略 $y_{t-2}$ 和 $y_{t-3}$ 而引起的渐近偏差 $\\theta^\\star - \\phi_1$；\n  - 单步向前预测均方误差比率\n  $$\n  R \\equiv \\frac{\\text{MSE under AR($1$) restriction}}{\\text{MSE under correctly specified AR($3$)}}.\n  $$\n- 您的程序必须构建并求解从 AR($3$) 矩方程得出的关于 $\\gamma(0)$、$\\gamma(1)$、$\\gamma(2)$ 和 $\\gamma(3)$ 的线性系统；不得依赖模拟或数值积分。\n\n测试套件 (每种情况为 $(\\phi_1,\\phi_2,\\phi_3,\\sigma^2)$)：\n- 情况 A (一般“理想路径”)：$(0.5, 0.3, -0.2, 1.0)$。\n- 情况 B (无省略滞后项，边界检查)：$(0.6, 0.0, 0.0, 1.0)$。\n- 情况 C (仅第三滞后项有影响，省略滞后项的边缘情况)：$(0.0, 0.0, 0.7, 1.0)$。\n- 情况 D (较小的正系数)：$(0.3, 0.2, 0.1, 1.0)$。\n\n最终输出格式：\n- 对于每种情况，按此顺序输出三个数字：$\\theta^\\star$、$\\theta^\\star - \\phi_1$ 和 $R$。\n- 将所有情况的结果按 A、B、C、D 的顺序汇总到一个扁平列表中，因此输出包含 12 个数字。\n- 所有数字表示为四舍五入到 6 位小数且不使用科学记数法。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果 (例如, $[x_1,x_2,\\dots,x_{12}]$)。", "solution": "问题陈述已被评估并被确定为有效。它基于平稳随机过程理论，特别是自回归模型，这一理论是计算经济学和金融学的核心。该问题是良定的，提供了一个清晰的数据生成过程和一套完整的定义与客观任务，从而导向一个唯一的、可推导的解。所有术语都以足够的数学精度进行了定义，且前提条件在事实上是可靠的并且内部一致。\n\n我们将按要求，遵循第一性原理进行推导和求解。\n\n该严格平稳的数据生成过程是一个三阶自回归过程 AR($3$)：\n$$\ny_t = \\phi_1 y_{t-1} + \\phi_2 y_{t-2} + \\phi_3 y_{t-3} + \\varepsilon_t\n$$\n其中 $\\{\\varepsilon_t\\}$ 是一个白噪声过程，满足 $\\mathbb{E}[\\varepsilon_t] = 0$ 和 $\\mathrm{Var}(\\varepsilon_t) = \\sigma^2$。该过程是零均值的，$\\mathbb{E}[y_t] = 0$。滞后 $k$ 阶的总体自协方差为 $\\gamma(k) = \\mathbb{E}[y_t y_{t-k}]$。由于平稳性，$\\gamma(k)$ 与时间 $t$ 无关，且 $\\gamma(k) = \\gamma(-k)$。\n\n**任务1：自协方差线性系统的推导**\n\nYule-Walker 方程给出了自回归系数和自协方差之间的关系。通过将 AR($p$) 方程两边乘以 $y_{t-k}$ (对于 $k \\ge 0$) 并取期望，可以推导出这些方程。对于我们的 AR($3$) 过程，我们考虑 $k \\in \\{0, 1, 2, 3\\}$。\n\n一个关键性质是创新项 $\\varepsilon_t$ 与过程的所有过去值都不相关，这是因为它是 $y_t$ 在过去值上投影的误差。因此，对于 $k > 0$，$\\mathbb{E}[\\varepsilon_t y_{t-k}] = 0$。对于 $k=0$，我们有 $\\mathbb{E}[\\varepsilon_t y_t] = \\mathbb{E}[\\varepsilon_t(\\phi_1 y_{t-1} + \\phi_2 y_{t-2} + \\phi_3 y_{t-3} + \\varepsilon_t)] = \\mathbb{E}[\\varepsilon_t^2] = \\sigma^2$。\n\n对于 $k=1$：\n$$\n\\mathbb{E}[y_t y_{t-1}] = \\phi_1 \\mathbb{E}[y_{t-1} y_{t-1}] + \\phi_2 \\mathbb{E}[y_{t-2} y_{t-1}] + \\phi_3 \\mathbb{E}[y_{t-3} y_{t-1}] + \\mathbb{E}[\\varepsilon_t y_{t-1}]\n$$\n$$\n\\gamma(1) = \\phi_1 \\gamma(0) + \\phi_2 \\gamma(1) + \\phi_3 \\gamma(2)\n$$\n\n对于 $k=2$：\n$$\n\\mathbb{E}[y_t y_{t-2}] = \\phi_1 \\mathbb{E}[y_{t-1} y_{t-2}] + \\phi_2 \\mathbb{E}[y_{t-2} y_{t-2}] + \\phi_3 \\mathbb{E}[y_{t-3} y_{t-2}] + \\mathbb{E}[\\varepsilon_t y_{t-2}]\n$$\n$$\n\\gamma(2) = \\phi_1 \\gamma(1) + \\phi_2 \\gamma(0) + \\phi_3 \\gamma(1)\n$$\n\n对于 $k=3$：\n$$\n\\mathbb{E}[y_t y_{t-3}] = \\phi_1 \\mathbb{E}[y_{t-1} y_{t-3}] + \\phi_2 \\mathbb{E}[y_{t-2} y_{t-3}] + \\phi_3 \\mathbb{E}[y_{t-3} y_{t-3}] + \\mathbb{E}[\\varepsilon_t y_{t-3}]\n$$\n$$\n\\gamma(3) = \\phi_1 \\gamma(2) + \\phi_2 \\gamma(1) + \\phi_3 \\gamma(0)\n$$\n\n对于 $k=0$ (过程的方差)：\n$$\n\\mathbb{E}[y_t y_t] = \\phi_1 \\mathbb{E}[y_{t-1} y_t] + \\phi_2 \\mathbb{E}[y_{t-2} y_t] + \\phi_3 \\mathbb{E}[y_{t-3} y_t] + \\mathbb{E}[\\varepsilon_t y_t]\n$$\n$$\n\\gamma(0) = \\phi_1 \\gamma(1) + \\phi_2 \\gamma(2) + \\phi_3 \\gamma(3) + \\sigma^2\n$$\n\n为了求解 $\\gamma(0), \\gamma(1), \\gamma(2), \\gamma(3)$，我们将这四个方程重排成一个以自协方差为未知数的线性系统。\n1.  $-\\phi_1 \\gamma(0) + (1-\\phi_2) \\gamma(1) - \\phi_3 \\gamma(2) + 0 \\cdot \\gamma(3) = 0$\n2.  $-\\phi_2 \\gamma(0) - (\\phi_1+\\phi_3) \\gamma(1) + \\gamma(2) + 0 \\cdot \\gamma(3) = 0$\n3.  $-\\phi_3 \\gamma(0) - \\phi_2 \\gamma(1) - \\phi_1 \\gamma(2) + \\gamma(3) = 0$\n4.  $\\gamma(0) - \\phi_1 \\gamma(1) - \\phi_2 \\gamma(2) - \\phi_3 \\gamma(3) = \\sigma^2$\n\n这构成了一个 $4 \\times 4$ 的线性系统 $M \\boldsymbol{\\gamma} = \\boldsymbol{b}$，其中 $\\boldsymbol{\\gamma} = [\\gamma(0), \\gamma(1), \\gamma(2), \\gamma(3)]^T$：\n$$\n\\begin{pmatrix}\n-\\phi_1 & 1-\\phi_2 & -\\phi_3 & 0 \\\\\n-\\phi_2 & -(\\phi_1+\\phi_3) & 1 & 0 \\\\\n-\\phi_3 & -\\phi_2 & -\\phi_1 & 1 \\\\\n1 & -\\phi_1 & -\\phi_2 & -\\phi_3\n\\end{pmatrix}\n\\begin{pmatrix}\n\\gamma(0) \\\\\n\\gamma(1) \\\\\n\\gamma(2) \\\\\n\\gamma(3)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n\\sigma^2\n\\end{pmatrix}\n$$\n求解该系统即可得到所需的自协方差。\n\n**任务2：伪真 AR(1) 系数 $\\theta^\\star$ 的推导**\n\n当用 AR($1$) 模型 $y_t = \\theta y_{t-1} + u_t$ 拟合数据时，参数 $\\theta$ 的估计是通过最小化均方误差得到的。该估计的总体模拟是 $y_t$ 在 $y_{t-1}$ 上的线性最小二乘投影。我们旨在找到最小化目标函数 $S(\\theta) = \\mathbb{E}[(y_t - \\theta y_{t-1})^2]$ 的系数 $\\theta^\\star$。\n\n为了找到最小值，我们将关于 $\\theta$ 的一阶导数设为零：\n$$\n\\frac{d S(\\theta)}{d\\theta} = \\mathbb{E}\\left[ \\frac{d}{d\\theta} (y_t - \\theta y_{t-1})^2 \\right] = \\mathbb{E}[-2(y_t - \\theta y_{t-1})y_{t-1}] = 0\n$$\n$$\n\\mathbb{E}[-y_t y_{t-1} + \\theta y_{t-1}^2] = 0\n$$\n这是 AR($1$) 投影的总体正规方程。用自协方差表示为：\n$$\n-\\mathbb{E}[y_t y_{t-1}] + \\theta \\mathbb{E}[y_{t-1}^2] = 0\n$$\n$$\n-\\gamma(1) + \\theta \\gamma(0) = 0\n$$\n求解 $\\theta$ 可得到伪真系数 $\\theta^\\star$：\n$$\n\\theta^\\star = \\frac{\\gamma(1)}{\\gamma(0)}\n$$\n这恰好是过程的一阶自相关系数 $\\rho(1)$。因省略 $y_{t-2}$ 和 $y_{t-3}$ 造成的渐近偏差是这个伪真值与 $y_{t-1}$ 的真实系数之差，即 $\\theta^\\star - \\phi_1$。\n\n**任务3：预测均方误差及其比率的推导**\n\n首先，我们确定错误设定的 AR($1$) 模型的单步向前预测的均方误差 (MSE)。预测值为 $\\hat{y}_t = \\theta^\\star y_{t-1}$。MSE 是最小化后的目标函数 $S(\\theta^\\star)$ 的值：\n$$\n\\mathrm{MSE}_{\\text{AR(1)}} = \\mathbb{E}[(y_t - \\theta^\\star y_{t-1})^2] = \\mathbb{E}[y_t^2 - 2\\theta^\\star y_t y_{t-1} + (\\theta^\\star)^2 y_{t-1}^2]\n$$\n$$\n\\mathrm{MSE}_{\\text{AR(1)}} = \\gamma(0) - 2\\theta^\\star \\gamma(1) + (\\theta^\\star)^2 \\gamma(0)\n$$\n代入 $\\theta^\\star = \\gamma(1)/\\gamma(0)$：\n$$\n\\mathrm{MSE}_{\\text{AR(1)}} = \\gamma(0) - 2\\frac{\\gamma(1)}{\\gamma(0)}\\gamma(1) + \\left(\\frac{\\gamma(1)}{\\gamma(0)}\\right)^2 \\gamma(0) = \\gamma(0) - \\frac{2\\gamma(1)^2}{\\gamma(0)} + \\frac{\\gamma(1)^2}{\\gamma(0)}\n$$\n$$\n\\mathrm{MSE}_{\\text{AR(1)}} = \\gamma(0) - \\frac{\\gamma(1)^2}{\\gamma(0)}\n$$\n接下来，我们确定正确设定的 AR($3$) 模型的预测 MSE。给定过去值，$y_t$ 的最优线性预测器是 $\\hat{y}_t = \\mathbb{E}[y_t | y_{t-1}, y_{t-2}, y_{t-3}] = \\phi_1 y_{t-1} + \\phi_2 y_{t-2} + \\phi_3 y_{t-3}$。预测误差为：\n$$\ny_t - \\hat{y}_t = ( \\phi_1 y_{t-1} + \\phi_2 y_{t-2} + \\phi_3 y_{t-3} + \\varepsilon_t ) - (\\phi_1 y_{t-1} + \\phi_2 y_{t-2} + \\phi_3 y_{t-3}) = \\varepsilon_t\n$$\nMSE 是该误差的方差：\n$$\n\\mathrm{MSE}_{\\text{AR(3)}} = \\mathbb{E}[(y_t - \\hat{y}_t)^2] = \\mathbb{E}[\\varepsilon_t^2] = \\sigma^2\n$$\n正如问题前提中所述，这是可达到的最小 MSE。预测效率损失是这两个 MSE 的比率：\n$$\nR \\equiv \\frac{\\mathrm{MSE}_{\\text{AR(1)}}}{\\mathrm{MSE}_{\\text{AR(3)}}} = \\frac{\\gamma(0) - \\gamma(1)^2/\\gamma(0)}{\\sigma^2}\n$$\n计算过程将涉及为每个参数集求解关于自协方差的 $4 \\times 4$ 线性系统，然后将得到的 $\\gamma(0)$ 和 $\\gamma(1)$ 的值代入推导出的 $\\theta^\\star$ 和 $R$ 的公式中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a suite of test cases, calculating metrics\n    related to AR(1) misspecification of a true AR(3) process.\n    \"\"\"\n\n    # Test suite: each case is a tuple (phi1, phi2, phi3, sigma2)\n    test_cases = [\n        (0.5, 0.3, -0.2, 1.0),    # Case A\n        (0.6, 0.0, 0.0, 1.0),    # Case B\n        (0.0, 0.0, 0.7, 1.0),    # Case C\n        (0.3, 0.2, 0.1, 1.0),    # Case D\n    ]\n\n    all_results = []\n    for params in test_cases:\n        phi1, phi2, phi3, sigma2 = params\n        \n        # Task 1: Construct and solve the linear system for autocovariances.\n        # The system is M * gamma_vec = b, where gamma_vec = [gamma(0), gamma(1), gamma(2), gamma(3)]'.\n        \n        M = np.array([\n            [-phi1, 1 - phi2, -phi3, 0],\n            [-phi2, -(phi1 + phi3), 1, 0],\n            [-phi3, -phi2, -phi1, 1],\n            [1, -phi1, -phi2, -phi3]\n        ])\n        \n        b = np.array([0, 0, 0, sigma2])\n        \n        try:\n            # Solve for gamma_vec = [gamma(0), gamma(1), gamma(2), gamma(3)]\n            gamma_vec = np.linalg.solve(M, b)\n            gamma0 = gamma_vec[0]\n            gamma1 = gamma_vec[1]\n        except np.linalg.LinAlgError:\n            # This should not happen for stationary processes, but is included for robustness.\n            # Assign NaN to indicate failure to solve.\n            theta_star, bias, R = np.nan, np.nan, np.nan\n            all_results.extend([theta_star, bias, R])\n            continue\n            \n        # Ensure gamma0 is not zero to avoid division by zero.\n        # For a stationary process with non-zero innovation variance, gamma(0) > 0.\n        if gamma0 == 0:\n            theta_star, bias, R = np.nan, np.nan, np.nan\n            all_results.extend([theta_star, bias, R])\n            continue\n\n        # Task 2: Calculate the pseudo-true AR(1) coefficient and the bias.\n        # theta_star = gamma(1) / gamma(0)\n        theta_star = gamma1 / gamma0\n        \n        # bias = theta_star - phi1\n        bias = theta_star - phi1\n        \n        # Task 3: Calculate the forecast efficiency loss ratio R.\n        # R = MSE_AR1 / MSE_AR3 = (gamma(0) - gamma(1)^2 / gamma(0)) / sigma^2\n        mse_ar1 = gamma0 - (gamma1**2 / gamma0)\n        # MSE for AR(3) is sigma2\n        R = mse_ar1 / sigma2\n        \n        all_results.extend([theta_star, bias, R])\n\n    # Final print statement in the exact required format.\n    # The format string ensures 6 decimal places and no scientific notation.\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n\n```"}]}