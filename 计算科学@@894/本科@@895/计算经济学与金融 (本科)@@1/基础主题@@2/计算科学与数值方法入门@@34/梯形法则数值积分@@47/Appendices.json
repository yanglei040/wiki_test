{"hands_on_practices": [{"introduction": "数值积分的一个常见应用是根据变化率计算累积总量，例如从瞬时提取率计算总提取量。本练习将梯形法则应用于一个经典的经济学模型——霍特林模型，来估算在一定时期内的石油总开采量。通过这个实践，你将直接练习如何针对一个给定的函数，构建并计算梯形法则的近似值，从而将抽象的数学工具与资源经济学中的具体问题联系起来。[@problem_id:2444238]", "id": "2444238", "problem": "一家资源开采公司根据符合霍特林法则（Hotelling’s rule）的跨期模型来运营一个石油储备。在时间 $t$（单位：年）的瞬时开采速率为 $E(t) = E_{0}\\exp(r t)$，其中 $E_{0}$ 是初始开采速率（单位：桶/年），$r$ 是一个恒定的增长率（单位：年$^{-1}$）。在时间区间 $[0,T]$ 内的总开采量是时间积分 $\\int_{0}^{T} E(t)\\,dt$。该公司在时间点 $t_{k} = k$（$k=0,1,2,\\dots,20$）每年记录一次开采速率。\n\n使用复合梯形法则（composite trapezoidal rule）在此年度网格上估计该积分，计算当 $E_{0} = 5.0 \\times 10^{7}$ 且 $r = 0.03$ 时，在 $T=20$ 年内开采的石油总量。以十亿桶为单位表示您的最终答案，并四舍五入到四位有效数字。", "solution": "该问题要求计算在 $T=20$ 年期间开采的石油总量，该总量由开采速率 $E(t)$ 的定积分给出。开采速率由函数 $E(t) = E_{0}\\exp(r t)$ 建模。我们被要求使用复合梯形法则，并利用特定的网格和参数来估计这个积分。\n\n首先，我们必须验证问题陈述。\n\n**步骤1：提取已知条件**\n- 瞬时开采速率：$E(t) = E_{0}\\exp(r t)$\n- 时间 $t$ 的单位是年。\n- $E_{0}$ 是初始开采速率，单位是桶/年。\n- $r$ 是恒定增长率，单位是年$^{-1}$。\n- 在 $[0,T]$ 上的累计开采量：$\\int_{0}^{T} E(t)\\,dt$。\n- 数据记录时间：$t_{k} = k$，$k=0,1,2,\\dots,20$。\n- 数值方法：复合梯形法则。\n- 时间范围：$T=20$ 年。\n- 初始开采速率：$E_{0} = 5.0 \\times 10^{7}$ 桶/年。\n- 增长率：$r = 0.03$ 年$^{-1}$。\n- 最终答案要求：以十亿桶为单位表示，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它采用了标准的指数增长模型和一种基本的数值积分技术（梯形法则）。这是一个适定问题（well-posed），提供了计算唯一数值结果所需的所有参数（$E_0$，$r$，$T$）以及离散化（$t_k=k$）的明确定义。语言客观而精确。该问题没有违反任何无效标准。例如，它在科学上并非不合理，因为指数模型在经济学中很常见。它也不是不完整的，因为计算所需的所有数据都已提供。\n\n**步骤3：结论和行动**\n问题有效。我将继续进行解答。\n\n问题要求对代表累计开采量的积分进行数值近似，我们将其表示为 $Q$：\n$$ Q = \\int_{0}^{20} E(t) \\, dt = \\int_{0}^{20} E_{0}\\exp(r t) \\, dt $$\n我们将使用复合梯形法则。时间点为 $t_k = k$，$k=0, 1, \\dots, 20$。这定义了区间 $[0, 20]$ 的一个划分，分为 $n=20$ 个子区间，每个子区间的宽度为 $h = t_{k+1} - t_k = 1$ 年。\n\n复合梯形法则将积分近似为在每个子区间上构建的梯形面积之和：\n$$ Q_{T} = \\sum_{k=0}^{n-1} \\frac{h}{2} \\left[ E(t_k) + E(t_{k+1}) \\right] $$\n代入给定的参数和函数：$n=20$，$h=1$，$t_k=k$ 以及 $E(t_k) = E_0 \\exp(r t_k) = E_0 \\exp(rk)$。\n$$ Q_{T} = \\sum_{k=0}^{19} \\frac{1}{2} \\left[ E_{0} \\exp(rk) + E_{0} \\exp(r(k+1)) \\right] $$\n我们可以提出常数项：\n$$ Q_{T} = \\frac{E_{0}}{2} \\sum_{k=0}^{19} \\left[ \\exp(rk) + \\exp(rk+r) \\right] $$\n$$ Q_{T} = \\frac{E_{0}}{2} \\sum_{k=0}^{19} \\exp(rk) \\left[ 1 + \\exp(r) \\right] $$\n项 $(1 + \\exp(r))$ 相对于求和指数 $k$ 是一个常数，因此可以移到求和符号外面：\n$$ Q_{T} = \\frac{E_{0}}{2} (1 + \\exp(r)) \\sum_{k=0}^{19} \\exp(rk) $$\n剩余的求和是一个形式为 $\\sum_{k=0}^{m} x^k$ 的有限几何级数，其中 $m=19$，公比为 $x = \\exp(r)$。该级数的和由公式 $\\frac{x^{m+1}-1}{x-1}$ 给出。\n$$ \\sum_{k=0}^{19} (\\exp(r))^k = \\frac{(\\exp(r))^{19+1} - 1}{\\exp(r) - 1} = \\frac{\\exp(20r) - 1}{\\exp(r) - 1} $$\n将此结果代回 $Q_T$ 的表达式中：\n$$ Q_{T} = \\frac{E_{0}}{2} (1 + \\exp(r)) \\frac{\\exp(20r) - 1}{\\exp(r) - 1} $$\n这是梯形近似的解析表达式。现在，我们代入给定的数值：$E_{0} = 5.0 \\times 10^{7}$ 和 $r = 0.03$。积分范围给出 $20r = 20 \\times 0.03 = 0.6$。\n$$ Q_{T} = \\frac{5.0 \\times 10^{7}}{2} (1 + \\exp(0.03)) \\frac{\\exp(0.6) - 1}{\\exp(0.03) - 1} $$\n我们计算指数项的值：\n$\\exp(0.03) \\approx 1.03045453$\n$\\exp(0.6) \\approx 1.82211880$\n\n将这些值代入表达式中：\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (1 + 1.03045453) \\frac{1.82211880 - 1}{1.03045453 - 1} $$\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (2.03045453) \\frac{0.82211880}{0.03045453} $$\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (2.03045453) \\cdot (26.99420028) $$\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (54.81434191) $$\n$$ Q_{T} \\approx 1370358547.65 \\text{ 桶} $$\n问题要求答案以十亿桶（$1 \\text{ billion} = 10^9$）为单位表示。\n$$ Q_{T} \\approx \\frac{1370358547.65}{10^9} \\text{ 十亿桶} $$\n$$ Q_{T} \\approx 1.37035854765 \\text{ 十亿桶} $$\n最后，我们必须将结果四舍五入到四位有效数字。\n$$ Q_{T} \\approx 1.370 \\text{ 十亿桶} $$", "answer": "$$\n\\boxed{1.370}\n$$"}, {"introduction": "一个数值近似方法只有当其精度已知或可控时才真正有用。本练习探讨了梯形法则中一个至关重要的概念：误差界限。你将学习如何利用函数的二阶导数来估算误差，并反过来确定为达到特定精度要求所需的最小子区间数量，这是所有可靠的工程和金融计算中的一项基本技能。[@problem_id:2170478]", "id": "2170478", "problem": "一个工程团队正在为一座现代建筑的立面设计一个装饰性建筑构件。该构件跨越两根柱子之间的水平距离，其弧形顶部轮廓由函数 $f(x) = h_0 \\cos\\left(\\frac{\\pi x}{2L}\\right)$ 描述。此处，$x$ 是以米为单位的水平位置，取 $x=0$ 为两根柱子之间的中点。柱子位于 $x=-L$ 和 $x=L$ 处。参数 $h_0$ 是拱形的最高高度，$2L$ 是总跨度。\n\n为了估算材料成本，团队需要计算该曲线下的横截面积，由积分 $\\int_{-L}^{L} f(x) \\,dx$ 给出。他们决定使用复化梯形法则进行数值近似。设计规格为 $h_0 = 10 \\text{ m}$ 和 $L = 20 \\text{ m}$。\n\n为保证成本估算的准确性，面积计算的绝对误差必须小于 $E_{max} = 0.1 \\text{ m}^2$。为保证达到此精度水平，在梯形法则中必须使用的最小整数子区间数 $n$ 是多少？", "solution": "我们希望使用复化梯形法则，在区间 $[a,b]=[-L,L]$ 上用 $n$ 个子区间来近似计算函数 $f(x)=h_{0}\\cos\\left(\\frac{\\pi x}{2L}\\right)$ 的积分 $\\int_{-L}^{L} f(x)\\,dx$。对于在 $[a,b]$ 上具有连续二阶导数的函数，复化梯形法则的误差界为\n$$\n|E_{T}| \\leq \\frac{(b-a)^{3}}{12 n^{2}} \\max_{x \\in [a,b]} |f''(x)|.\n$$\n\n首先，计算 $f''(x)$。令 $k=\\frac{\\pi}{2L}$。则\n$$\nf(x)=h_{0}\\cos(kx),\\quad f'(x)=-h_{0}k\\sin(kx),\\quad f''(x)=-h_{0}k^{2}\\cos(kx).\n$$\n因此\n$$\n|f''(x)|=h_{0}k^{2}|\\cos(kx)| \\leq h_{0}k^{2}=h_{0}\\left(\\frac{\\pi}{2L}\\right)^{2}.\n$$\n当 $a=-L, b=L$ 时，我们有 $b-a=2L$。代入误差界公式，\n$$\n|E_{T}| \\leq \\frac{(2L)^{3}}{12 n^{2}} \\cdot h_{0}\\left(\\frac{\\pi}{2L}\\right)^{2}\n= \\frac{8L^{3}}{12 n^{2}} \\cdot h_{0}\\frac{\\pi^{2}}{4L^{2}}\n= \\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{n^{2}}.\n$$\n\n为保证 $|E_{T}| \\leq E_{\\max}$，只需满足\n$$\n\\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{n^{2}} \\leq E_{\\max}\n\\quad\\Longrightarrow\\quad\nn^{2} \\geq \\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{E_{\\max}}\n\\quad\\Longrightarrow\\quad\nn \\geq \\sqrt{\\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{E_{\\max}}}.\n$$\n\n代入 $h_{0}=10$, $L=20$ 和 $E_{\\max}=0.1$，可得\n$$\nn \\geq \\sqrt{\\frac{\\pi^{2}}{6}\\cdot \\frac{10\\cdot 20}{0.1}}\n= \\sqrt{\\frac{\\pi^{2}}{6}\\cdot 2000}\n= \\sqrt{\\frac{1000}{3}\\,\\pi^{2}}.\n$$\n数值上，$\\frac{1000}{3}\\pi^{2} \\approx 3289.9$，因此 $n \\geq \\sqrt{3289.9} \\approx 57.35$。所以，保证所需精度的最小整数 $n$ 是 $n=58$。", "answer": "$$\\boxed{58}$$"}, {"introduction": "我们通常使用离散数据点来估算积分值，但反过来是否可行？本练习提出了一个巧妙的“反向问题”，它源于经济学中衡量收入不平等的洛伦兹曲线和基尼系数。在已知积分结果（由基尼系数推算）和大部分数据点的情况下，你将需要推断出缺失的数据点。这个挑战促使我们将梯形法则公式视为一个代数方程进行求解，从而培养更深刻、更灵活地运用数值工具解决实际问题的能力。[@problem_id:2444241]", "id": "2444241", "problem": "在收入分配分析中，基尼系数 $G$ 由洛伦兹曲线 $L(p)$ 通过关系式 $G = 1 - 2 \\int_{0}^{1} L(p) \\, dp$ 定义，其中 $p \\in [0,1]$ 表示累计人口份额，$L(p)$ 表示相应的累计收入份额。一个国家统计局报告某一年的基尼系数为 $G = 0.336$。通过微观数据汇总，洛伦兹曲线已在均匀网格 $p \\in \\{0, 0.2, 0.4, 0.6, 0.8, 1\\}$ 上制成表格，除了一个点外，其他所有点的值均已知：\n- $L(0) = 0$，\n- $L(0.2) = 0.05$，\n- $L(0.4) = 0.15$，\n- $L(0.6) = \\text{未知}$，\n- $L(0.8) = 0.60$，\n- $L(1) = 1$。\n\n在此网格上，积分 $\\int_{0}^{1} L(p) \\, dp$ 将使用复合梯形法则进行近似计算。\n\n仅使用以上信息，确定缺失值 $L(0.6)$。将您的最终答案表示为一个小数。", "solution": "根据定义，基尼系数 $G$ 和洛伦兹曲线 $L(p)$ 满足\n$$\nG \\;=\\; 1 \\;-\\; 2 \\int_{0}^{1} L(p) \\, dp.\n$$\n因此，洛伦兹曲线的积分为\n$$\n\\int_{0}^{1} L(p) \\, dp \\;=\\; \\frac{1 - G}{2}.\n$$\n当 $G = 0.336$ 时，可得\n$$\n\\int_{0}^{1} L(p) \\, dp \\;=\\; \\frac{1 - 0.336}{2} \\;=\\; \\frac{0.664}{2} \\;=\\; 0.332.\n$$\n\n我们使用复合梯形法则在步长 $h = 0.2$ 的均匀网格 $p_i = 0, 0.2, 0.4, 0.6, 0.8, 1$ 上近似计算 $\\int_{0}^{1} L(p) \\, dp$。将未知值 $L(0.6)$ 记为 $x$。复合梯形法则给出\n$$\n\\int_{0}^{1} L(p) \\, dp \\;\\approx\\; h \\left( \\frac{L(0)+L(1)}{2} + L(0.2) + L(0.4) + L(0.6) + L(0.8) \\right).\n$$\n代入已知值和 $h = 0.2$，\n$$\n\\int_{0}^{1} L(p) \\, dp \\;\\approx\\; 0.2 \\left( \\frac{0 + 1}{2} + 0.05 + 0.15 + x + 0.60 \\right)\n\\;=\\; 0.2 \\left( 0.5 + 0.05 + 0.15 + 0.60 + x \\right)\n\\;=\\; 0.2 \\left( 1.30 + x \\right)\n\\;=\\; 0.26 + 0.2 x.\n$$\n将此近似值与由 $G$ 推导出的值相等，\n$$\n0.26 + 0.2 x \\;=\\; 0.332.\n$$\n解出 $x$，\n$$\n0.2 x \\;=\\; 0.332 - 0.26 \\;=\\; 0.072,\n\\qquad\nx \\;=\\; \\frac{0.072}{0.2} \\;=\\; 0.36.\n$$\n因此，缺失的洛伦兹曲线值为 $L(0.6) = 0.36$。", "answer": "$$\\boxed{0.36}$$"}]}