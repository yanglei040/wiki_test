{"hands_on_practices": [{"introduction": "要真正掌握LU分解，最好的方法就是亲自动手计算。这个练习将带你逐步完成一个$3 \\times 3$矩阵的Doolittle分解，其中$L$是一个单位下三角矩阵。通过这个基础练习 [@problem_id:2186375]，你将熟悉分解过程的机械步骤，为后续更复杂的应用打下坚实的基础。", "id": "2186375", "problem": "在数值线性代数中，将一个矩阵分解为一个下三角矩阵和一个上三角矩阵的乘积是一项基本运算。这种分解被称为LU分解，并用于各种算法，例如求解线性方程组。\n\n考虑如下给定的矩阵 $A$：\n$$\nA = \\begin{pmatrix} 3 & -1 & 2 \\\\ 6 & 1 & 9 \\\\ -9 & 5 & -5 \\end{pmatrix}\n$$\n该矩阵可以唯一地分解为乘积 $A = LU$，其中 $L$ 是一个单位下三角矩阵（即对角线上的元素为1），而 $U$ 是一个上三角矩阵。这两个 $3 \\times 3$ 矩阵的一般形式为：\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ l_{21} & 1 & 0 \\\\ l_{31} & l_{32} & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} u_{11} & u_{12} & u_{13} \\\\ 0 & u_{22} & u_{23} \\\\ 0 & 0 & u_{33} \\end{pmatrix}\n$$\n对于给定的矩阵 $A$，确定矩阵 $L$ 的非对角元素和矩阵 $U$ 的所有元素的数值。将你的最终答案表示为一个单行矩阵，其中包含按特定顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$ 排列的这九个值。将所有分数值表示为其最简形式。", "solution": "我们使用 Doolittle LU 分解，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，满足 $A=LU$。对于\n$$\nL=\\begin{pmatrix}1&0&0\\\\ l_{21}&1&0\\\\ l_{31}&l_{32}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}&u_{13}\\\\ 0&u_{22}&u_{23}\\\\ 0&0&u_{33}\\end{pmatrix},\n$$\n乘积 $LU$ 逐行给出：\n- 第1行：$[u_{11},u_{12},u_{13}]=[3,-1,2]$，因此 $u_{11}=3$， $u_{12}=-1$， $u_{13}=2$。\n- 第2行第1列：$l_{21}u_{11}=a_{21}=6$，所以 $l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{6}{3}=2$。\n- 第3行第1列：$l_{31}u_{11}=a_{31}=-9$，所以 $l_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-9}{3}=-3$。\n- 第2行第2列：$l_{21}u_{12}+u_{22}=a_{22}=1$，所以 $u_{22}=a_{22}-l_{21}u_{12}=1-2(-1)=3$。\n- 第2行第3列：$l_{21}u_{13}+u_{23}=a_{23}=9$，所以 $u_{23}=a_{23}-l_{21}u_{13}=9-2\\cdot 2=5$。\n- 第3行第2列：$l_{31}u_{12}+l_{32}u_{22}=a_{32}=5$，所以 $l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{5-(-3)(-1)}{3}=\\frac{5-3}{3}=\\frac{2}{3}$。\n- 第3行第3列：$l_{31}u_{13}+l_{32}u_{23}+u_{33}=a_{33}=-5$，所以\n$$\nu_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}=-5-(-3\\cdot 2)-\\left(\\frac{2}{3}\\cdot 5\\right)=-5+6-\\frac{10}{3}=1-\\frac{10}{3}=-\\frac{7}{3}.\n$$\n\n因此，按所要求的顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$，这些值为\n$$\n\\begin{pmatrix}\n2 & -3 & \\frac{2}{3} & 3 & -1 & 2 & 3 & 5 & -\\frac{7}{3}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2 & -3 & \\frac{2}{3} & 3 & -1 & 2 & 3 & 5 & -\\frac{7}{3}\\end{pmatrix}}$$"}, {"introduction": "矩阵分解本身并不是目的，其真正的威力在于应用。这个练习展示了LU分解最核心的应用之一：高效求解线性方程组 $A\\mathbf{x} = \\mathbf{b}$。通过先将$A$分解为$LU$，然后利用前向和后向替换法求解 [@problem_id:12944]，你将体会到这种方法在计算上的优势，尤其是在需要对同一个矩阵$A$求解不同向量$\\mathbf{b}$时。", "id": "12944", "problem": "一个线性方程组可以表示为矩阵形式 $A\\mathbf{x} = \\mathbf{b}$。求解此类系统的一个有效方法是LU分解，即将矩阵 $A$ 分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A = LU$。\n\n原始方程组 $A\\mathbf{x} = \\mathbf{b}$ 于是可以改写为 $LU\\mathbf{x} = \\mathbf{b}$。该方程可以通过两个步骤求解：\n1.  定义一个中间向量 $\\mathbf{y} = U\\mathbf{x}$。\n2.  首先，使用前向替换法求解方程组 $L\\mathbf{y} = \\mathbf{b}$ 得到 $\\mathbf{y}$。\n3.  然后，使用后向替换法求解方程组 $U\\mathbf{x} = \\mathbf{y}$ 得到 $\\mathbf{x}$。\n\n考虑以下线性方程组：\n$$\n\\begin{align*}\n2x_1 + x_2 + x_3 &= 5 \\\\\n4x_1 - 6x_2 &= -2 \\\\\n-2x_1 + 7x_2 + 2x_3 &= 9\n\\end{align*}\n$$\n该方程组可以写成 $A\\mathbf{x} = \\mathbf{b}$ 的形式，其中：\n$$\nA = \\begin{pmatrix} 2 & 1 & 1 \\\\ 4 & -6 & 0 \\\\ -2 & 7 & 2 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ -2 \\\\ 9 \\end{pmatrix}\n$$\n首先，求出矩阵 $A$ 的LU分解，其中 $L$ 是一个对角线上元素为1的下三角矩阵（Doolittle分解），$U$ 是一个上三角矩阵。然后，使用此分解求解向量 $\\mathbf{x}$。\n\n你的任务是求出表达式 $x_1 + 2x_2 + 3x_3$ 的值。", "solution": "我们寻求满足 $A=LU$ 的 $L,U$，其中 \n$$L=\\begin{pmatrix}1&0&0\\\\l_{21}&1&0\\\\l_{31}&l_{32}&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}&u_{12}&u_{13}\\\\0&u_{22}&u_{23}\\\\0&0&u_{33}\\end{pmatrix}.$$\n\n匹配 $A=\\begin{pmatrix}2&1&1\\\\4&-6&0\\\\-2&7&2\\end{pmatrix}$：\n\n1. $U$ 的第一行：\n$$u_{11}=2,\\quad u_{12}=1,\\quad u_{13}=1.$$\n\n2. $L$ 的第一列：\n$$l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{2}=2,\\quad\nl_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-2}{2}=-1.$$\n\n3. 第二行/列：\n$$u_{22}=a_{22}-l_{21}u_{12}=-6-2\\cdot1=-8,\\quad\nu_{23}=a_{23}-l_{21}u_{13}=0-2\\cdot1=-2.$$\n$$l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{7-(-1)\\cdot1}{-8}=\\frac{8}{-8}=-1.$$\n\n4. 最后一个对角线元素：\n$$u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}\n=2-(-1)\\cdot1-(-1)\\cdot(-2)=2+1-2=1.$$\n\n因此\n$$L=\\begin{pmatrix}1&0&0\\\\2&1&0\\\\-1&-1&1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}2&1&1\\\\0&-8&-2\\\\0&0&1\\end{pmatrix}.$$\n\n接下来，通过前向替换法求解 $L\\mathbf y=\\mathbf b$，其中 $\\mathbf b=(5,-2,9)^T$：\n$$y_1=5,\\quad\ny_2=-2-2\\,y_1=-2-10=-12,\\quad\ny_3=9-(-1)\\,y_1-(-1)\\,y_2=9+5-12=2.$$\n\n然后，通过后向替换法求解 $U\\mathbf x=\\mathbf y$：\n$$x_3=2,\\quad\n-8x_2-2x_3=-12\\implies-8x_2-4=-12\\implies x_2=1,$$\n$$2x_1+x_2+x_3=5\\implies2x_1+1+2=5\\implies x_1=1.$$\n\n最后，\n$$x_1+2x_2+3x_3=1+2\\cdot1+3\\cdot2=9.$$", "answer": "$$\\boxed{9}$$"}, {"introduction": "在实际计算中，我们可能会遇到朴素LU分解算法无法处理的情况，例如当主元（pivot）为零时。这个练习 [@problem_id:2186343] 引入了一个关键的改进：部分选主元（partial pivoting）。你将学习如何通过行交换来克服主元为零的问题，并构建$PA=LU$形式的分解，其中$P$是置换矩阵。这是确保LU分解算法在实践中稳健可靠的重要一步。", "id": "2186343", "problem": "考虑矩阵 $A$ 如下：\n$$A = \\begin{pmatrix} 0 & -3 \\\\ 2 & 6 \\end{pmatrix}$$\n一种基本的矩阵分解是带部分主元法的LU分解（Lower-Upper decomposition）。该过程寻找一个置换矩阵 $P$、一个单位下三角矩阵 $L$（对角线元素为1）和一个上三角矩阵 $U$，使得它们满足方程 $PA = LU$。\n\n對於给定的矩阵 $A$，以下哪个选项正确地给出了矩阵三元组 $(P, L, U)$？\n\nA. $P = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nB. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nC. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 3 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & -3 \\end{pmatrix}$\n\nD. $P = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2 & 6 \\\\ 0 & 3 \\end{pmatrix}$", "solution": "我们对矩阵进行带部分主元法的LU分解\n$$\nA=\\begin{pmatrix}0 & -3 \\\\ 2 & 6\\end{pmatrix}.\n$$\n部分主元法在第一列中选择绝对值最大的元素所在行作为主元。这些元素是 $|0|$ 和 $|2|$，因此主元在第2行。所以，我们交换第1行和第2行，得到 $PA$，其中置换矩阵为\n$$\nP=\\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}, \\quad PA = P A = \\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\n现在我们将 $PA$ 分解为 $LU$，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，不再进行主元交换。对于一个 $2\\times 2$ 矩阵，乘数为\n$$\n\\ell_{21}=\\frac{(PA)_{21}}{(PA)_{11}}=\\frac{0}{2}=0.\n$$\n因此\n$$\nL=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}, \\quad U=\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\n它们满足 $PA=LU$：\n$$\n\\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}\\begin{pmatrix}0 & -3 \\\\ 2 & 6\\end{pmatrix}\n=\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}\n=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}\\begin{pmatrix}2 & 6 \\\\ 0 & -3\\end{pmatrix}.\n$$\n与选项比较，这对应于选项B。选项A和C中列出的 $P$、$L$、$U$ 不满足 $PA=LU$，而选项D中 $U$ 的 $(2,2)$ 位置元素的符号不正确。", "answer": "$$\\boxed{B}$$"}]}