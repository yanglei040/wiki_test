{"hands_on_practices": [{"introduction": "掌握任何计算方法都始于对其基本步骤的熟练运用。第一个练习 [@problem_id:23125] 为你提供了一个直接的动手实践机会，将高斯消元法的分步过程应用于一个标准线性方程组。通过系统地在主对角线下方制造零，将矩阵变换为行阶梯形，你将练习该强大算法的核心操作机制。", "id": "23125", "problem": "考虑以下包含三个变量 $x, y,$ 和 $z$ 的线性方程组：\n$$\n\\begin{cases}\nx + y + z = 4 \\\\\n2x - y + z = 8 \\\\\nx - 2y - z = 1\n\\end{cases}\n$$\n使用高斯消元法，将该方程组变换为行阶梯形，并求出变量 $z$ 的值。", "solution": "我们写出该方程组的增广矩阵：\n$$\n\\begin{pmatrix}\n1 & 1 & 1 & \\big| & 4 \\\n$$6pt]\n2 & -1 & 1 & \\big| & 8 \\\n$$6pt]\n1 & -2 & -1 & \\big| & 1\n\\end{pmatrix}.\n$$\n第一步：通过行变换 $R_2\\leftarrow R_2-2R_1$ 从第二行消去 $x$，并通过行变换 $R_3\\leftarrow R_3-R_1$ 从第三行消去 $x$：\n$$\nR_2: (2-2\\cdot1,\\;-1-2\\cdot1,\\;1-2\\cdot1\\;|\\;8-2\\cdot4)\n=(0,\\,-3,\\,-1\\;|\\;0),\n$$\n$$\nR_3: (1-1,\\;-2-1,\\;-1-1\\;|\\;1-4)\n=(0,\\,-3,\\,-2\\;|\\;-3).\n$$\n矩阵变为\n$$\n\\begin{pmatrix}\n1 & 1 & 1 & \\big| & 4 \\\n$$6pt]\n0 & -3 & -1 & \\big| & 0 \\\n$$6pt]\n0 & -3 & -2 & \\big| & -3\n\\end{pmatrix}.\n$$\n第二步：通过行变换 $R_3\\leftarrow R_3-R_2$ 从第三行消去 $y$：\n$$\nR_3: (0-0,\\;-3-(-3),\\;-2-(-1)\\;|\\;-3-0)\n=(0,\\;0,\\;-1\\;|\\;-3).\n$$\n现在该矩阵为行阶梯形：\n$$\n\\begin{pmatrix}\n1 & 1 & 1 & \\big| & 4 \\\n$$6pt]\n0 & -3 & -1 & \\big| & 0 \\\n$$6pt]\n0 & 0 & -1 & \\big| & -3\n\\end{pmatrix}.\n$$\n根据第三行，我们得到\n$$\n-1\\cdot z=-3,\n$$\n因此\n$$\nz=3.\n$$", "answer": "$$\\boxed{3}$$"}, {"introduction": "在现实世界的模型中，并非每个方程组都有一个完美的唯一解。这个练习 [@problem_id:2175259] 探讨了无解的矛盾方程组这一重要情况。在此问题中应用高斯消元法将导出一个逻辑上的矛盾，这会教会你如何识别此类结果，并理解其在经济或金融建模中的重要意义。", "id": "2175259", "problem": "分析下列关于变量 $x$、$y$、$z$ 的线性方程组，并判断其解集的性质。\n\n$$\n\\begin{cases}\n\\phantom{1}x + \\phantom{1}y + z = 3 \\\\\n2x - \\phantom{1}y + 3z = 4 \\\\\n3x \\phantom{{}+0y} + 4z = 8\n\\end{cases}\n$$\n\n从以下选项中选择正确的表述。\n\nA. 该方程组有唯一解。\nB. 该方程组有无穷多解，含一个自由参数。\nC. 该方程组有无穷多解，含两个自由参数。\nD. 该方程组不相容（无解）。", "solution": "设该方程组为\n$$\n\\begin{cases}\nx + y + z = 3, \\\\\n2x - y + 3z = 4, \\\\\n3x + 4z = 8.\n\\end{cases}\n$$\n首先，通过计算其系数矩阵的行列式来判断是否存在唯一解。系数矩阵为\n$$\nA=\\begin{pmatrix}\n1 & 1 & 1 \\\\\n2 & -1 & 3 \\\\\n3 & 0 & 4\n\\end{pmatrix}.\n$$\n计算\n$$\n\\det(A)=1\\cdot\\det\\begin{pmatrix}-1 & 3 \\\\ 0 & 4\\end{pmatrix}\n-1\\cdot\\det\\begin{pmatrix}2 & 3 \\\\ 3 & 4\\end{pmatrix}\n+1\\cdot\\det\\begin{pmatrix}2 & -1 \\\\ 3 & 0\\end{pmatrix}.\n$$\n计算每个子式：\n$$\n\\det\\begin{pmatrix}-1 & 3 \\\\ 0 & 4\\end{pmatrix}=-4,\\quad\n\\det\\begin{pmatrix}2 & 3 \\\\ 3 & 4\\end{pmatrix}=8-9=-1,\\quad\n\\det\\begin{pmatrix}2 & -1 \\\\ 3 & 0\\end{pmatrix}=0-(-3)=3.\n$$\n因此\n$$\n\\det(A)=-4-(-1)+3=0.\n$$\n因为 $\\det(A)=0$，该方程组没有唯一解；它或者有无穷多解，或者不相容。为了确定是哪种情况，我们使用消元法来检验其相容性。\n\n从第一个方程出发，用它来对第二个和第三个方程进行消元：\n- 计算 $(2)-(2)\\times(1)$:\n$$\n(2x - y + 3z) - 2(x + y + z) = 4 - 6 \\;\\Rightarrow\\; -3y + z = -2.\n$$\n- 计算 $(3)-(3)\\times(1)$:\n$$\n(3x + 4z) - 3(x + y + z) = 8 - 9 \\;\\Rightarrow\\; -3y + z = -1.\n$$\n这两个推导出的方程，\n$$\n-3y + z = -2 \\quad \\text{和} \\quad -3y + z = -1,\n$$\n其左侧相同但右侧不同，这是不可能同时满足的。因此，该方程组不相容，无解。\n\n因此，正确选项是 D。", "answer": "$$\\boxed{D}$$"}, {"introduction": "算法的理论优雅性有时会受到计算机算术实际限制的挑战。这个练习 [@problem_id:2396422] 演示了计算金融中的一个关键问题：数值不稳定性。通过求解一个源自无套利市场模型的方程组，你将看到直接应用高斯消元法如何产生错误结果（即“伪套利”），并理解为何一个简单的策略——主元选择（pivoting）——对于获得可靠且有意义的金融见解至关重要。", "id": "2396422", "problem": "考虑一个具有完全市场的两状态、单期经济。令 $q_1$ 和 $q_2$ 表示 Arrow-Debreu 状态价格（即今天购买的、分别在状态1或状态2交付的一单位消费品的价格）。根据无套利原理，任何交易资产 $j$ 的价格 $p_j$ 与其在两种状态下的支付 $x_{1j}$ 和 $x_{2j}$ 满足以下方程组\n$$\np_j \\;=\\; q_1 x_{1j} \\;+\\; q_2 x_{2j}, \\quad j \\in \\{1,2\\}.\n$$\n您观察到两种交易资产，其支付和价格如下（所有金额单位均为美元）：\n- 资产 $1$：支付向量 $(x_{11}, x_{21}) = (0.001234,\\, 1.000000)$，价格 $p_1 = 1.001234$。\n- 资产 $2$：支付向量 $(x_{12}, x_{22}) = (1.000000,\\, 1.000000)$，价格 $p_2 = 2.000000$。\n\n假设市场是无套利且完全的。一位分析师试图通过使用高斯消元法求解关于 $(q_1, q_2)$ 的 $2\\times 2$ 线性方程组来恢复 $(q_1, q_2)$。然而，在算法的每个中间步骤中，该分析师都使用四舍五入到三位有效数字的算术运算。\n\n任务：\n1) 建立形式为 $A \\boldsymbol{q} = \\boldsymbol{p}$ 的线性系统，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n0.001234 & 1.000000 \\\\\n1.000000 & 1.000000\n\\end{pmatrix}, \n\\quad \n\\boldsymbol{q} \\;=\\; \\begin{pmatrix} q_1 \\\\ q_2 \\end{pmatrix}, \n\\quad \n\\boldsymbol{p} \\;=\\; \\begin{pmatrix} 1.001234 \\\\ 2.000000 \\end{pmatrix}.\n$$\n2) 对增广矩阵执行不带主元法的高斯消元，所有算术运算（包括每个中间结果）都通过四舍五入保留三位有效数字。将得到的估计值记为 $(\\tilde{q}_1, \\tilde{q}_2)$。\n3) 使用 $(\\tilde{q}_1, \\tilde{q}_2)$，计算在两种状态下支付为 $(1, 0)$ 的 Arrow–Debreu 证券的模型隐含无套利价值 $\\tilde{v}$。\n4) 在同一无套利市场中，该 Arrow–Debreu 证券的观测市场价值 $v$ 与精确解出上述方程组的真实状态价格一致（因此 $v = q_1$）。根据给定数据，观测到的 $v$ 等于 $1.000000$。因此，使用不带主元法的高斯消元的分析师会声称存在伪套利，即通过做空观测到的证券，并以其模型隐含价值买入其复制投资组合，单位利润为 $\\pi = v - \\tilde{v}$。\n5) 现在使用部分主元法重复消元过程（在消元前，总是通过交换将可用的绝对值最大的主元置于对角线上），每一步仍使用三位有效数字的算术运算，以获得 $(\\hat{q}_1, \\hat{q}_2)$ 及相应的 $\\hat{v}$。解释为什么这种方法消除了伪套利。\n\n作为最终答案，报告在步骤4中计算出的单位伪套利利润 $\\pi$，四舍五入到三位有效数字。最终利润以美元表示。", "solution": "对问题陈述的有效性进行评估。\n\n**步骤1：提取已知条件**\n- 资产价格的方程组为 $p_j = q_1 x_{1j} + q_2 x_{2j}$，其中 $j \\in \\{1, 2\\}$。\n- 资产 $1$：支付向量 $(x_{11}, x_{21}) = (0.001234, 1.000000)$，价格 $p_1 = 1.001234$。\n- 资产 $2$：支付向量 $(x_{12}, x_{22}) = (1.000000, 1.000000)$，价格 $p_2 = 2.000000$。\n- 线性方程组以矩阵形式 $A \\boldsymbol{q} = \\boldsymbol{p}$ 给出：\n$$\nA = \\begin{pmatrix} 0.001234 & 1.000000 \\\\ 1.000000 & 1.000000 \\end{pmatrix}, \\quad \\boldsymbol{q} = \\begin{pmatrix} q_1 \\\\ q_2 \\end{pmatrix}, \\quad \\boldsymbol{p} = \\begin{pmatrix} 1.001234 \\\\ 2.000000 \\end{pmatrix}\n$$\n- 所有算术运算都需在每个中间步骤中四舍五入到3位有效数字。\n- 支付为 $(1, 0)$ 的 Arrow-Debreu 证券的真实价值为 $v = q_1 = 1.000000$。\n- 伪套利利润定义为 $\\pi = v - \\tilde{v}$，其中 $\\tilde{v}$ 是使用不带主元法的高斯消元计算出的价值。\n\n**步骤2：使用提取的条件进行验证**\n该问题具有科学依据，植根于资产定价基本定理和标准的数值线性代数。这是一个适定问题；矩阵 $A$ 是非奇异的，因为其行列式为 $0.001234 \\times 1.000000 - 1.000000 \\times 1.000000 = -0.998766 \\neq 0$，这保证了 $(q_1, q_2)$ 存在唯一解。该问题是客观、完整的，并且不包含任何矛盾。数据值的选择是为了说明一个众所周知的数值不稳定性问题，这是计算科学中一种标准的教学手段。该问题是可形式化的，并且与指定主题相关。\n\n**步骤3：结论和行动**\n问题有效。将提供完整解答。\n\n方程组的精确解可通过直接代数运算找到。从第二个方程减去第一个方程得到 $(1 - 0.001234)q_1 = 2 - 1.001234$，化简为 $0.998766 q_1 = 0.998766$，这意味着 $q_1 = 1$。代回可得 $q_2 = 1$。真实的状态价格向量为 $(q_1, q_2) = (1, 1)$。\n\n我们现在使用有限精度算术来分析解。\n\n**第1部分：不带主元法的高斯消元**\n\n首先，我们建立增广矩阵 $[A|\\boldsymbol{p}]$ 并将所有元素四舍五入到3位有效数字。\n$$\n[A|\\boldsymbol{p}] = \\left[ \\begin{array}{cc|c}\n0.001234 & 1.000000 & 1.001234 \\\\\n1.000000 & 1.000000 & 2.000000\n\\end{array} \\right] \\quad \\rightarrow \\quad \\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n1.00 & 1.00 & 2.00\n\\end{array} \\right]\n$$\n主元是 $a_{11} = 0.00123$。第二行的乘数为 $m_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1.00}{0.00123}$。\n计算：$1.00 \\div 0.00123 \\approx 813.008...$。四舍五入到3位有效数字得到 $m_{21} = 813$。\n我们执行行运算 $R_2 \\leftarrow R_2 - m_{21} R_1$。\n第二行的新元素计算如下：\n$a'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - 813 \\times 1.00 = 1.00 - 813 = -812$。\n$p'_{2} = p_{2} - m_{21} \\times p_{1} = 2.00 - 813 \\times 1.00 = 2.00 - 813 = -811$。\n方程组变为上三角形式：\n$$\n\\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n0 & -812 & -811\n\\end{array} \\right]\n$$\n现在我们执行回代以找到近似解 $(\\tilde{q}_1, \\tilde{q}_2)$。\n根据第二行：$-812 \\tilde{q}_2 = -811$。\n$\\tilde{q}_2 = \\frac{-811}{-812} \\approx 0.99876...$。四舍五入到3位有效数字：$\\tilde{q}_2 = 0.999$。\n根据第一行：$0.00123 \\tilde{q}_1 + 1.00 \\tilde{q}_2 = 1.00$。\n代入 $\\tilde{q}_2$： $0.00123 \\tilde{q}_1 + 1.00 \\times 0.999 = 1.00$。\n乘积 $1.00 \\times 0.999 = 0.999$。\n$0.00123 \\tilde{q}_1 + 0.999 = 1.00$。\n$0.00123 \\tilde{q}_1 = 1.00 - 0.999 = 0.001$。这个中间结果只有1位有效数字。\n$\\tilde{q}_1 = \\frac{0.001}{0.00123} \\approx 0.81300...$。四舍五入到3位有效数字：$\\tilde{q}_1 = 0.813$。\n因此，不带主元法的解为 $(\\tilde{q}_1, \\tilde{q}_2) = (0.813, 0.999)$。\n\n支付为 $(1, 0)$ 的 Arrow-Debreu 证券的模型隐含价值为 $\\tilde{v} = 1 \\cdot \\tilde{q}_1 + 0 \\cdot \\tilde{q}_2 = \\tilde{q}_1 = 0.813$。\n真实的市场价值为 $v = 1.000000$。\n伪套利利润为 $\\pi = v - \\tilde{v} = 1.000 - 0.813 = 0.187$。\n\n**第2部分：带部分主元法的高斯消元**\n\n我们从相同的圆整后增广矩阵开始：\n$$\n\\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n1.00 & 1.00 & 2.00\n\\end{array} \\right]\n$$\n在第一列中， $|a_{21}| = 1.00 > |a_{11}| = 0.00123$。因此，我们交换第1行和第2行。\n$$\n\\left[ \\begin{array}{cc|c}\n1.00 & 1.00 & 2.00 \\\\\n0.00123 & 1.00 & 1.00\n\\end{array} \\right]\n$$\n现在的主元是 $a_{11} = 1.00$。乘数为 $m_{21} = \\frac{a_{21}}{a_{11}} = \\frac{0.00123}{1.00} = 0.00123$。\n我们执行行运算 $R_2 \\leftarrow R_2 - m_{21} R_1$。\n第二行的新元素计算如下：\n$a'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - 0.00123 \\times 1.00 = 1.00 - 0.00123 = 0.99877$。四舍五入到3位有效数字得到 $0.999$。\n$p'_{2} = p_{2} - m_{21} \\times p_{1} = 1.00 - 0.00123 \\times 2.00 = 1.00 - 0.00246 = 0.99754$。四舍五入到3位有效数字得到 $0.998$。\n方程组变为：\n$$\n\\left[ \\begin{array}{cc|c}\n1.00 & 1.00 & 2.00 \\\\\n0 & 0.999 & 0.998\n\\end{array} \\right]\n$$\n我们对解 $(\\hat{q}_1, \\hat{q}_2)$ 执行回代。\n根据第二行：$0.999 \\hat{q}_2 = 0.998$。\n$\\hat{q}_2 = \\frac{0.998}{0.999} \\approx 0.99899...$。四舍五入到3位有效数字：$\\hat{q}_2 = 0.999$。\n根据第一行：$1.00 \\hat{q}_1 + 1.00 \\hat{q}_2 = 2.00$。\n$1.00 \\hat{q}_1 + 1.00 \\times 0.999 = 2.00$。\n$1.00 \\hat{q}_1 + 0.999 = 2.00$。\n$1.00 \\hat{q}_1 = 2.00 - 0.999 = 1.001$。四舍五入到3位有效数字得到 $1.00$。\n$1.00 \\hat{q}_1 = 1.00$，所以 $\\hat{q}_1 = 1.00$。\n带部分主元法的解为 $(\\hat{q}_1, \\hat{q}_2) = (1.00, 0.999)$。\n\n新的模型隐含价值为 $\\hat{v} = \\hat{q}_1 = 1.00$。\n现在的套利利润为 $\\hat{\\pi} = v - \\hat{v} = 1.00 - 1.00 = 0$。\n\n**解释**\n\n伪套利是不带主元法的高斯消元算法中数值不稳定性的直接后果。矩阵 $A$ 的元素数量级差异巨大。\n\n当不使用主元法时，小元素 $a_{11} = 0.00123$ 被选为主元。这导致了一个非常大的乘数，$m_{21} = 813$。在消元步骤 $R_2 \\leftarrow R_2 - m_{21} R_1$ 中，通过减去一个大数，第2行中的原始信息被有效摧毁。项 $m_{21} \\times a_{12} = 813$ 淹没了 $a_{22}=1.00$ 的原始值。这导致在随后的回代步骤中发生灾难性抵消 ($1.00 - 0.999 = 0.001$)，其中两个几乎相等的数相减，导致有效数字从3位减少到1位。与真实值 $q_1 = 1$ 相比，最终结果 $\\tilde{q}_1 = 0.813$ 严重不准确。\n\n部分主元法纠正了这种不稳定性。通过交换行，它确保主元是该列中可用的绝对值最大的元素。在本例中，1.00 成为主元。这保证了乘数 $m_{21} = 0.00123$ 很小（具体来说，就是 $|m_{ij}| \\le 1$）。在执行消元步骤时，我们减去一个小的量，这保留了原始矩阵元素的有效数字。最终的计算是数值稳定的，得到 $\\hat{q}_1 = 1.00$，在3位有效数字的工作精度下是准确的。这个准确的状态价格导出的模型价值 $\\hat{v}$ 与观测到的市场价值 $v$ 相匹配，正确地表明不存在套利机会。", "answer": "$$\n\\boxed{0.187}\n$$"}]}