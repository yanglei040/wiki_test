{"hands_on_practices": [{"introduction": "虽然Vasicek模型在金融领域广为人知，但它本质上描述的是一个均值回归随机过程。本练习通过一个非金融领域的假设场景，旨在帮助学生掌握该过程的核心数学性质，例如其在未来时刻的分布以及不同时刻取值的相关性 [@problem_id:2429522]。这种练习将为理解更复杂的金融定价问题打下坚实的数学基础。", "id": "2429522", "problem": "一位政治领导人的支持率被建模为一个连续时间的 Vasicek 过程，即一个在单位区间上、为建模目的而视为实值的 Ornstein–Uhlenbeck 扩散。设支持率过程表示为 $A_t$，满足随机微分方程\n$$\n\\mathrm{d}A_t \\;=\\; \\kappa \\left(\\theta - A_t\\right)\\mathrm{d}t \\;+\\; \\sigma \\,\\mathrm{d}W_t,\n$$\n其中 $\\kappa>0$ 是均值回归速度，$\\theta \\in \\mathbb{R}$ 是长期水平，$\\sigma>0$ 是波动率参数，而 $(W_t)_{t\\ge 0}$ 是一个标准布朗运动。假设初始支持率恰好处于长期水平，即 $A_0=\\theta$。在选举前仅进行两次民意调查：一次在时间 $t=\\tau$，另一次在选举日 $t=T$。民意调查的时间表由 $\\kappa \\tau = \\tfrac{1}{2}\\ln 3$ 和 $T=2\\tau$ 固定。一位政策分析师定义了一个等于长期水平的临界支持率阈值 $L=\\theta$，并对在选举日或之前的两个民调日期中，支持率至少有一次低于 $L$ 的概率感兴趣。\n\n在此模型和民调时间表下，计算在 $t=\\tau$ 或 $t=T$ 中至少有一次 $A_t<L$ 的概率。将最终答案表示为最简的精确分数。不要对答案进行四舍五入。答案必须是单个实数。", "solution": "问题陈述具有科学依据、提法恰当、客观，并包含得出唯一解所需的所有信息。因此，该问题是有效的。我们开始求解。\n\n问题要求计算在两个民调日期 $t=\\tau$ 和 $t=T$ 中，支持率 $A_t$ 至少有一次低于临界阈值 $L=\\theta$ 的概率。这个概率可以正式地写为 $P(A_\\tau < \\theta \\text{ or } A_T < \\theta)$。\n\n使用概率的容斥原理，我们有：\n$$\nP(A_\\tau < \\theta \\text{ or } A_T < \\theta) = P(A_\\tau < \\theta) + P(A_T < \\theta) - P(A_\\tau < \\theta \\text{ and } A_T < \\theta)\n$$\n\n支持率过程 $A_t$ 遵循 Vasicek 模型，这是一个由以下随机微分方程描述的 Ornstein-Uhlenbeck 过程：\n$$\n\\mathrm{d}A_t = \\kappa (\\theta - A_t)\\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\n初始条件为 $A_0 = \\theta$。对于 $t > s$，给定 $A_s$，此随机微分方程的解为：\n$$\nA_t = A_s e^{-\\kappa(t-s)} + \\theta(1 - e^{-\\kappa(t-s)}) + \\sigma \\int_s^t e^{-\\kappa(t-u)} \\mathrm{d}W_u\n$$\n对于固定的时间 $t$，以 $A_s$ 为条件的随机变量 $A_t$ 服从正态分布。其条件均值为：\n$$\nE[A_t | A_s] = A_s e^{-\\kappa(t-s)} + \\theta(1 - e^{-\\kappa(t-s)})\n$$\n其条件方差，使用 Itô 等距定理，为：\n$$\nVar(A_t | A_s) = \\sigma^2 \\int_s^t e^{-2\\kappa(t-u)} \\mathrm{d}u = \\frac{\\sigma^2}{2\\kappa}(1 - e^{-2\\kappa(t-s)})\n$$\n\n在初始条件 $A_0 = \\theta$ 下，任意时间 $t > 0$ 时 $A_t$ 的分布是正态的。\n均值为 $E[A_t] = E[A_t | A_0 = \\theta] = \\theta e^{-\\kappa t} + \\theta(1 - e^{-\\kappa t}) = \\theta$。\n方差为 $Var(A_t) = Var(A_t | A_0 = \\theta) = \\frac{\\sigma^2}{2\\kappa}(1 - e^{-2\\kappa t})$。\n\n首先，我们计算单个概率 $P(A_\\tau < \\theta)$ 和 $P(A_T < \\theta)$。\n对于 $t=\\tau$，$A_\\tau$ 服从正态分布，其均值为 $E[A_\\tau] = \\theta$，方差为 $Var(A_\\tau) = \\frac{\\sigma^2}{2\\kappa}(1 - e^{-2\\kappa\\tau}) > 0$。由于正态分布关于其均值对称，因此小于均值的概率恰好是 $\\frac{1}{2}$。\n$$\nP(A_\\tau < \\theta) = \\frac{1}{2}\n$$\n类似地，对于 $t=T$，$A_T$ 服从正态分布，均值为 $E[A_T] = \\theta$。因此，\n$$\nP(A_T < \\theta) = \\frac{1}{2}\n$$\n\n接下来，我们必须计算联合概率 $P(A_\\tau < \\theta \\text{ and } A_T < \\theta)$。这需要 $(A_\\tau, A_T)$ 的联合分布。由于该过程是高斯过程，向量 $(A_\\tau, A_T)$ 服从二元正态分布，其均值向量为 $(\\theta, \\theta)$，协方差矩阵需要我们来确定。\n方差为：\n$$\nVar(A_\\tau) = \\frac{\\sigma^2}{2\\kappa}(1 - e^{-2\\kappa\\tau}) \\quad \\text{和} \\quad Var(A_T) = \\frac{\\sigma^2}{2\\kappa}(1 - e^{-2\\kappa T})\n$$\n对于 $\\tau < T$ 的协方差 $Cov(A_\\tau, A_T)$ 可以利用过程的马尔可夫性质求得：\n$$\nCov(A_\\tau, A_T) = Cov(A_\\tau, E[A_T | A_\\tau]) = Cov(A_\\tau, A_\\tau e^{-\\kappa(T-\\tau)} + \\theta(1 - e^{-\\kappa(T-\\tau)}))\n$$\n$$\nCov(A_\\tau, A_T) = e^{-\\kappa(T-\\tau)} Var(A_\\tau)\n$$\n$A_\\tau$ 和 $A_T$ 之间的相关系数 $\\rho$ 是：\n$$\n\\rho = \\frac{Cov(A_\\tau, A_T)}{\\sqrt{Var(A_\\tau)Var(A_T)}} = \\frac{e^{-\\kappa(T-\\tau)} Var(A_\\tau)}{\\sqrt{Var(A_\\tau)Var(A_T)}} = e^{-\\kappa(T-\\tau)} \\sqrt{\\frac{Var(A_\\tau)}{Var(A_T)}}\n$$\n代入方差的表达式（项 $\\frac{\\sigma^2}{2\\kappa}$ 被消去）：\n$$\n\\rho = e^{-\\kappa(T-\\tau)} \\sqrt{\\frac{1 - e^{-2\\kappa\\tau}}{1 - e^{-2\\kappa T}}}\n$$\n给定的民调时间表为：$\\kappa \\tau = \\frac{1}{2}\\ln 3$ 和 $T=2\\tau$。\n从 $\\kappa \\tau = \\frac{1}{2}\\ln 3 = \\ln \\sqrt{3}$，我们得到 $e^{\\kappa\\tau} = \\sqrt{3}$，因此 $e^{-\\kappa\\tau} = \\frac{1}{\\sqrt{3}}$。\n这意味着 $e^{-2\\kappa\\tau} = (e^{-\\kappa\\tau})^2 = \\frac{1}{3}$。\n由于 $T=2\\tau$，我们有 $\\kappa T = 2\\kappa\\tau = \\ln 3$，因此 $e^{-\\kappa T} = \\frac{1}{3}$。\n这意味着 $e^{-2\\kappa T} = (e^{-\\kappa T})^2 = \\frac{1}{9}$。\n另外，$T-\\tau = \\tau$，所以 $e^{-\\kappa(T-\\tau)} = e^{-\\kappa\\tau} = \\frac{1}{\\sqrt{3}}$。\n将这些值代入 $\\rho$ 的表达式中：\n$$\n\\rho = \\frac{1}{\\sqrt{3}} \\sqrt{\\frac{1 - \\frac{1}{3}}{1 - \\frac{1}{9}}} = \\frac{1}{\\sqrt{3}} \\sqrt{\\frac{\\frac{2}{3}}{\\frac{8}{9}}} = \\frac{1}{\\sqrt{3}} \\sqrt{\\frac{2}{3} \\cdot \\frac{9}{8}} = \\frac{1}{\\sqrt{3}} \\sqrt{\\frac{18}{24}} = \\frac{1}{\\sqrt{3}} \\sqrt{\\frac{3}{4}} = \\frac{1}{\\sqrt{3}} \\frac{\\sqrt{3}}{2} = \\frac{1}{2}\n$$\n现在我们计算 $P(A_\\tau < \\theta \\text{ and } A_T < \\theta)$。令 $Z_\\tau = \\frac{A_\\tau-\\theta}{\\sqrt{Var(A_\\tau)}}$ 和 $Z_T = \\frac{A_T-\\theta}{\\sqrt{Var(A_T)}}$。向量 $(Z_\\tau, Z_T)$ 服从相关系数为 $\\rho = \\frac{1}{2}$ 的标准二元正态分布。所求概率为 $P(Z_\\tau < 0 \\text{ and } Z_T < 0)$。对于标准二元正态分布，此概率由 Sheppard 公式给出：\n$$\nP(Z_\\tau < 0, Z_T < 0) = \\frac{1}{4} + \\frac{\\arcsin(\\rho)}{2\\pi}\n$$\n代入 $\\rho = \\frac{1}{2}$ 并使用 $\\arcsin(\\frac{1}{2}) = \\frac{\\pi}{6}$ 弧度：\n$$\nP(A_\\tau < \\theta, A_T < \\theta) = \\frac{1}{4} + \\frac{\\frac{\\pi}{6}}{2\\pi} = \\frac{1}{4} + \\frac{1}{12} = \\frac{3}{12} + \\frac{1}{12} = \\frac{4}{12} = \\frac{1}{3}\n$$\n最后，我们将所有分量概率代回到容斥原理公式中：\n$$\nP(A_\\tau < \\theta \\text{ or } A_T < \\theta) = P(A_\\tau < \\theta) + P(A_T < \\theta) - P(A_\\tau < \\theta, A_T < \\theta)\n$$\n$$\nP(A_\\tau < \\theta \\text{ or } A_T < \\theta) = \\frac{1}{2} + \\frac{1}{2} - \\frac{1}{3} = 1 - \\frac{1}{3} = \\frac{2}{3}\n$$\n在两个民调日期中，支持率至少有一次低于长期水平的概率是 $\\frac{2}{3}$。", "answer": "$$\n\\boxed{\\frac{2}{3}}\n$$"}, {"introduction": "掌握了随机过程本身的基本性质后，我们现在转向其核心应用：为利率衍生品定价。本练习要求对一个“幂期权”（power option）进行定价，这超出了简单套用Black-Scholes类型公式的范畴。它提供了一个绝佳的机会来实践高级定价技巧，例如将计价物（numeraire）转换为远期测度（forward measure），从而极大地简化期望值的计算 [@problem_id:2429541]。", "id": "2429541", "problem": "考虑一个无摩擦市场，其中包含连续的无违约零息债券。令 $r_t$ 表示在风险中性测度 $\\mathbb{Q}$ 下的瞬时短期利率，其由 Vasicek 过程建模\n$$\n\\mathrm{d}r_t = a \\left(\\theta - r_t\\right)\\mathrm{d}t + \\sigma \\mathrm{d}W_t,\n$$\n其中 $a>0$, $\\theta \\in \\mathbb{R}$, $\\sigma>0$，且 $W_t$ 是在 $\\mathbb{Q}$ 下的标准布朗运动。对于 $0 \\leq t \\leq T$，令 $P(t,T)$ 表示在时间 $t$ 时，一个于时间 $T$ 到期的零息债券的价格。固定时间 $0<\\tau<T$ 和一个常数 $K>0$。考虑一个欧式幂期权，其在时间 $\\tau$ 的支付额为\n$$\n\\left(P(\\tau,T) - K\\right)^{2}.\n$$\n请确定该期权在时间 $0$ 的无套利价格的封闭形式解，该解仅用 $P(0,\\tau)$，$P(0,T)$，$a$，$\\sigma$，$K$，$\\tau$ 和 $T$ 表示。您的最终答案必须是单一的解析表达式。不需要数值近似，也不允许四舍五入。", "solution": "问题要求解一个欧式幂期权在时间 $t=0$ 的无套利价格。该期权的到期时间为 $\\tau$，支付函数为 $(P(\\tau,T) - K)^2$，其中 $P(\\tau,T)$ 是一个在 $T$ 时刻到期的零息债券的价格。短期利率 $r_t$ 在风险中性测度 $\\mathbb{Q}$ 下遵循 Vasicek 模型：\n$$\n\\mathrm{d}r_t = a(\\theta - r_t)\\mathrm{d}t + \\sigma \\mathrm{d}W_t\n$$\n令 $V_0$ 为该期权在时间 $t=0$ 的价格。根据风险中性定价原理，价格是支付额的贴现期望值：\n$$\nV_0 = \\mathbb{E}^{\\mathbb{Q}}\\left[ \\exp\\left(-\\int_0^\\tau r_s \\mathrm{d}s\\right) (P(\\tau,T) - K)^2 \\right]\n$$\n为简化计算，我们进行一次测度变换，从风险中性测度 $\\mathbb{Q}$（以货币市场账户为计价单位）变换到 $\\tau$-远期测度 $\\mathbb{Q}^\\tau$，在后一测度下，计价单位是零息债券 $P(t,\\tau)$。其 Radon-Nikodym 导数由下式给出：\n$$\n\\frac{\\mathrm{d}\\mathbb{Q}^\\tau}{\\mathrm{d}\\mathbb{Q}}\\bigg|_{\\mathcal{F}_\\tau} = \\frac{\\exp\\left(-\\int_0^\\tau r_s \\mathrm{d}s\\right)}{P(0,\\tau)}\n$$\n价格 $V_0$ 可以改写为：\n$$\nV_0 = P(0,\\tau) \\mathbb{E}^{\\mathbb{Q}^\\tau}\\left[ (P(\\tau,T) - K)^2 \\right]\n$$\n通过展开平方项并利用期望的线性性质，我们得到：\n$$\nV_0 = P(0,\\tau) \\left( \\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)^2] - 2K \\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)] + K^2 \\mathbb{E}^{\\mathbb{Q}^\\tau}[1] \\right)\n$$\n我们将在 $\\tau$-远期测度 $\\mathbb{Q}^\\tau$ 下计算每个期望项：\n1.  常数的期望是其本身：$\\mathbb{E}^{\\mathbb{Q}^\\tau}[1] = 1$。因此第三项为 $K^2$。\n2.  $\\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)]$ 是债券 $P(\\tau,T)$ 在时间 $0$ 的远期价格。一个标准结果是，一个在 $T_2$ 到期、在 $T_1$ 交割的债券的远期价格 $F(t; T_1, T_2)$ 由 $P(t,T_2)/P(t,T_1)$ 给出。因此：\n    $$\n    \\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)] = F(0; \\tau, T) = \\frac{P(0,T)}{P(0,\\tau)}\n    $$\n3.  最复杂的一项是 $\\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)^2]$。在 Vasicek 模型下，债券价格 $P(t,T)$ 是短期利率 $r_t$ 的一个指数仿射函数。远期债券价格 $F(t;\\tau,T) = P(t,T)/P(t,\\tau)$ 也服从对数正态分布。在到期时 $t=\\tau$，$P(\\tau,T) = F(\\tau;\\tau,T)$，所以在测度 $\\mathbb{Q}^\\tau$ 下，$P(\\tau,T)$ 服从对数正态分布。\n\n令 $\\ln P(\\tau,T)$ 为在 $\\mathbb{Q}^\\tau$ 下的一个正态分布随机变量，其均值为 $\\mu$，方差为 $\\Sigma^2$。其对数的均值与变量本身的均值相关联：\n$$\n\\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)] = \\exp\\left(\\mu + \\frac{1}{2}\\Sigma^2\\right) = \\frac{P(0,T)}{P(0,\\tau)}\n$$\n这表明 $\\mu = \\ln\\left(\\frac{P(0,T)}{P(0,\\tau)}\\right) - \\frac{1}{2}\\Sigma^2$。\n\n我们需要计算二阶矩 $\\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)^2]$。对于一个对数正态变量，该值由下式给出：\n$$\n\\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)^2] = \\exp\\left(2\\mu + \\frac{1}{2}(2\\Sigma)^2\\right) = \\exp(2\\mu + 2\\Sigma^2)\n$$\n代入 $\\mu$ 的表达式：\n$$\n\\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)^2] = \\exp\\left(2\\left(\\ln\\left(\\frac{P(0,T)}{P(0,\\tau)}\\right) - \\frac{1}{2}\\Sigma^2\\right) + 2\\Sigma^2\\right) = \\exp\\left(2\\ln\\left(\\frac{P(0,T)}{P(0,\\tau)}\\right) + \\Sigma^2\\right)\n$$\n$$\n\\mathbb{E}^{\\mathbb{Q}^\\tau}[P(\\tau,T)^2] = \\left(\\frac{P(0,T)}{P(0,\\tau)}\\right)^2 \\exp(\\Sigma^2)\n$$\n必须计算方差 $\\Sigma^2 = \\mathrm{Var}^{\\mathbb{Q}^\\tau}[\\ln P(\\tau,T)]$。对于 Vasicek 模型，远期价格 $F(t;\\tau,T)$ 的波动率为 $\\sigma_F(t) = \\sigma(B(t,T) - B(t,\\tau))$，其中 $B(t,T) = \\frac{1}{a}(1 - \\exp(-a(T-t)))$。方差是瞬时方差平方的积分：\n$$\n\\Sigma^2 = \\int_0^\\tau \\sigma_F(s)^2 \\mathrm{d}s = \\sigma^2 \\int_0^\\tau (B(s,T) - B(s,\\tau))^2 \\mathrm{d}s\n$$\n我们有 $B(s,T) - B(s,\\tau) = \\frac{1}{a}(\\exp(-a(\\tau-s)) - \\exp(-a(T-s))) = \\frac{e^{as}}{a}(e^{-a\\tau} - e^{-aT})$。\n该积分变为：\n$$\n \\int_0^\\tau \\frac{e^{2as}}{a^2}(e^{-a\\tau} - e^{-aT})^2 \\mathrm{d}s = \\frac{(e^{-a\\tau} - e^{-aT})^2}{a^2} \\int_0^\\tau e^{2as} \\mathrm{d}s\n$$\n$$\n= \\frac{(e^{-a\\tau} - e^{-aT})^2}{a^2} \\left[\\frac{e^{2as}}{2a}\\right]_0^\\tau = \\frac{(e^{-a\\tau} - e^{-aT})^2}{2a^3} (e^{2a\\tau} - 1)\n$$\n这可以简化为：\n$$\n\\Sigma^2 = \\frac{ \\sigma^2 }{2a^3} (e^{-a\\tau} - e^{-aT})^2 (e^{2a\\tau} - 1) = \\frac{ \\sigma^2 }{2a^3} e^{-2a\\tau}(1 - e^{-a(T-\\tau)})^2 (e^{2a\\tau} - 1) = \\frac{ \\sigma^2 }{2a^3} (1 - e^{-a(T-\\tau)})^2 (1 - e^{-2a\\tau})\n$$\n方差为 $\\Sigma^2 = \\frac{\\sigma^2}{2a^3}(1-\\exp(-a(T-\\tau)))^2(1-\\exp(-2a\\tau))$。\n\n现在我们组装最终的价格 $V_0$：\n$$\nV_0 = P(0,\\tau) \\left( \\left(\\frac{P(0,T)}{P(0,\\tau)}\\right)^2 \\exp(\\Sigma^2) - 2K\\frac{P(0,T)}{P(0,\\tau)} + K^2 \\right)\n$$\n$$\nV_0 = \\frac{P(0,T)^2}{P(0,\\tau)} \\exp(\\Sigma^2) - 2KP(0,T) + K^2 P(0,\\tau)\n$$\n代入 $\\Sigma^2$ 的表达式，我们得到最终的封闭形式解。", "answer": "$$\n\\boxed{\\frac{P(0,T)^2}{P(0,\\tau)} \\exp\\left(\\frac{\\sigma^2}{2a^3}(1 - \\exp(-a(T-\\tau)))^2(1 - \\exp(-2a\\tau))\\right) - 2KP(0,T) + K^2P(0,\\tau)}\n$$"}, {"introduction": "我们最后的练习将从Vasicek模型过渡到更复杂的Cox-Ingersoll-Ross (CIR)模型，该模型的关键优势在于能确保利率始终为正。本练习挑战我们为附息债券的看涨期权定价，这本质上是为一组零息债券的投资组合定价。这个问题为介绍Jamshidian分解法创造了完美的舞台，该方法巧妙地将这个看似复杂的问题简化为对一系列更简单期权的定价 [@problem_id:2429604]，从而巩固了对CIR模型和单因素模型下高级定价方法的理解。", "id": "2429604", "problem": "考虑一个风险中性测度下的单因子短利率模型，其中短利率 $r_s$ 服从 Cox–Ingersoll–Ross (CIR) 随机微分方程 (SDE)\n$$\n\\mathrm{d}r_s \\;=\\; \\kappa\\big(\\theta - r_s\\big)\\,\\mathrm{d}s \\;+\\; \\sigma \\sqrt{r_s}\\,\\mathrm{d}W_s,\n$$\n其中参数 $\\kappa$、$\\theta$ 和 $\\sigma$ 均为严格正值，$W_s$ 是布朗运动。设当前时间为 $t=0$，当前短利率为 $r_0>0$。到期日为 $T$ 的无违约零息债券价格记为 $P(0,T)$，在 CIR 模型中，它具有指数仿射形式\n$$\nP(0,T) \\;=\\; A(0,T)\\,\\exp\\big(-B(0,T)\\,r_0\\big),\n$$\n其中 $A(0,T)$ 和 $B(0,T)$ 是标准的 CIR 仿射系数。同样地，对于 $T \\leq U$，在 $T$ 时刻的价格 $P(T,U)$ 为 $A(T,U)\\exp(-B(T,U) r_T)$。假设所有确保无套利和可积性的标准技术条件均成立。\n\n给定一个以无违约附息债券为标的的欧式看涨期权，该债券在时间点 $\\{T_i\\}_{i=1}^{N}$ 支付确定性现金流 $\\{c_i\\}_{i=1}^{N}$，其中 $0<T<T_1<\\cdots<T_N$。该期权的到期时间为 $T$，行权价为 $K>0$。其在 $T$ 时刻的收益为\n$$\n\\Bigg(\\sum_{i=1}^{N} c_i\\,P(T,T_i) \\;-\\; K\\Bigg)^{+}.\n$$\n从风险中性定价原理和 CIR 模型的单因子结构出发，在不预先假设任何给定的期权定价公式的情况下，通过将附息债券分解为一个零息债券的投资组合，推导该期权在 $0$ 时刻价格的解析表达式。您的推导应基于：\n\n- 将 $0$ 时刻价格定义为风险中性测度下贴现期望的风险中性定价定义。\n- 单因子短利率设定下的单调性，该单调性为 Jamshidian 分解提供了依据。\n- CIR 模型中零息债券价格已知的指数仿射形式，以及 $r_T$ 的条件分布为非中心卡方分布这一事实，从而使得 $r_T$ 函数的期望可以通过非中心卡方随机变量的累积分布函数 (CDF) 来表示。\n\n请将您的最终答案表示为由 $A(\\cdot,\\cdot)$、$B(\\cdot,\\cdot)$、$\\kappa$、$\\theta$、$\\sigma$、$r_0$、$\\{c_i,T_i\\}_{i=1}^{N}$、$T$、$K$ 以及非中心卡方 CDF 构成的单一闭式解析表达式。不要对任何特殊函数进行数值计算。不需要四舍五入。请明确说明您引入的任何中间量，但最终答案必须是单一的解析表达式。", "solution": "问题陈述经过验证。\n\n第1步：提取已知条件\n-   模型：风险中性测度 $Q$ 下的 Cox–Ingersoll–Ross (CIR) 单因子短利率模型。\n-   随机微分方程 (SDE)：$\\mathrm{d}r_s = \\kappa(\\theta - r_s)\\,\\mathrm{d}s + \\sigma \\sqrt{r_s}\\,\\mathrm{d}W_s$。\n-   参数：$\\kappa > 0$, $\\theta > 0$, $\\sigma > 0$。\n-   布朗运动：$W_s$。\n-   初始条件：当前时间 $t=0$，当前短利率 $r_0 > 0$。\n-   零息债券 (ZCB) 价格：$P(t,T) = A(t,T)\\,\\exp(-B(t,T)\\,r_t)$。对于 $T \\leq U$，$P(T,U) = A(T,U)\\exp(-B(T,U) r_T)$。\n-   标的资产：无违约附息债券。\n-   现金流：在时间点 $\\{T_i\\}_{i=1}^{N}$ 发生的一组确定性现金流 $\\{c_i\\}_{i=1}^{N}$。\n-   时间顺序：$0 < T < T_1 < T_2 < \\dots < T_N$。\n-   期权规格：以附息债券为标的的欧式看涨期权。\n-   期权到期日：时间 $T$。\n-   期权行权价：$K > 0$。\n-   $T$ 时刻的期权收益：$\\left(\\sum_{i=1}^{N} c_i\\,P(T,T_i) - K\\right)^{+}$。\n-   定价框架：风险中性定价，它将 $0$ 时刻价格定义为风险中性测度下的贴现期望收益。\n-   要求的推导方法：\n    1.  将附息债券分解为零息债券的投资组合。\n    2.  利用单因子模型中债券价格的单调性来应用 Jamshidian 分解。\n    3.  依赖于 $r_T$ 的条件分布为非中心卡方分布这一事实。\n-   要求的输出格式：一个由给定参数、CIR 函数 $A(\\cdot,\\cdot)$ 和 $B(\\cdot,\\cdot)$ 以及非中心卡方累积分布函数 (CDF) 表示的单一闭式解析表达式。\n\n第2步：使用提取的已知条件进行验证\n-   **科学性与客观性（关键）**：该问题设置在 CIR 模型的标准框架内，这是数理金融中利率理论的基石。所有概念（风险中性定价、零息债券、欧式期权、Jamshidian 分解）都已得到充分确立且在数学上是严谨的。语言精确、客观。该问题不含伪科学或主观论断。\n-   **适定性**：该问题是适定的。它要求在明确指定的模型下，计算一个标准金融衍生品的价格。所提供的信息和约束足以确定唯一解。关于方法论的提示（Jamshidian 技巧，使用卡方分布）引导推导过程朝向一个已知结果，避免了模糊性。\n-   **完备性与一致性**：问题陈述是自洽的。它提供了SDE、债券定价公式、期权收益以及推导所需的要素。没有缺失的数据或矛盾的约束。\n-   **相关性**：该问题直接关系到短利率模型（特别是 CIR）及其在衍生品定价中的应用，这是计算经济学和金融学的核心主题。\n\n第3步：结论与行动\n问题有效。将提供完整的解答推导过程。\n\n**推导**\n\n欧式看涨期权的 $0$ 时刻价格 $C(0)$ 由风险中性定价原理给出。该原理指出，价格是风险中性测度 $Q$ 下收益的贴现期望。\n$$\nC(0) = E^Q_0 \\left[ \\exp\\left(-\\int_0^T r_s ds\\right) \\left( \\sum_{i=1}^{N} c_i\\,P(T,T_i) - K \\right)^{+} \\right]\n$$\n其中 $E^Q_0[\\cdot]$ 表示在 $t=0$ 时刻信息下的条件期望。\n\n在期权到期时间 $T$，标的附息债券的价格是对应于每笔未来现金流的零息债券价格之和：\n$$\nV_B(T) = \\sum_{i=1}^{N} c_i P(T, T_i)\n$$\n在 CIR 模型中，零息债券 $P(T, T_i)$ 的价格是短利率 $r_T$ 的指数仿射函数：\n$$\nP(T, T_i) = A(T, T_i) \\exp(-B(T, T_i) r_T)\n$$\nCIR 模型的参数 $\\kappa, \\theta, \\sigma$ 均为正数。标准的 CIR 债券定价函数 $A(t,T)$ 和 $B(t,T)$ 在 $t < T$ 时严格为正。我们假设现金流 $c_i$ 也为正，这对于付息是标准的。\n\n要应用 Jamshidian 分解，我们必须证明在时间 $T$ 的附息债券价格 $V_B(T)$ 是单一状态变量 $r_T$ 的单调函数。求 $V_B(T)$ 关于 $r_T$ 的导数：\n$$\n\\frac{\\partial V_B(T)}{\\partial r_T} = \\sum_{i=1}^{N} c_i \\frac{\\partial}{\\partial r_T} \\left[ A(T, T_i) \\exp(-B(T, T_i) r_T) \\right] = \\sum_{i=1}^{N} c_i A(T, T_i) \\exp(-B(T, T_i) r_T) \\left( -B(T, T_i) \\right)\n$$\n由于 $c_i > 0$、$A(T,T_i) > 0$ 和 $B(T,T_i) > 0$，求和中的每一项都是负数。因此，$\\frac{\\partial V_B(T)}{\\partial r_T} < 0$，这意味着 $V_B(T)$ 是 $r_T$ 的严格递减函数。\n\n由于这种严格单调性，存在一个唯一的短利率临界值，我们记为 $r_T^*$，使得债券价格等于行权价：\n$$\nV_B(r_T^*) = \\sum_{i=1}^{N} c_i A(T, T_i) \\exp(-B(T, T_i) r_T^*) = K\n$$\n该方程定义了 $r_T^*$。虽然通常无法得到 $r_T^*$ 的解析解，但其存在性是有保证的。如果 $V_B(T) > K$，期权为价内，这等价于 $r_T < r_T^*$。因此，收益可以使用示性函数 $\\mathbb{I}(\\cdot)$ 来表示：\n$$\n\\left( V_B(T) - K \\right)^{+} = \\left( \\sum_{i=1}^{N} c_i\\,P(T,T_i) - K \\right) \\mathbb{I}(r_T < r_T^*)\n$$\n将其代入定价公式并利用期望的线性性质：\n$$\nC(0) = E^Q_0 \\left[ \\exp\\left(-\\int_0^T r_s ds\\right) \\left( \\sum_{i=1}^{N} c_i\\,P(T,T_i) - K \\right) \\mathbb{I}(r_T < r_T^*) \\right]\n$$\n$$\nC(0) = \\sum_{i=1}^{N} c_i E^Q_0 \\left[ \\exp\\left(-\\int_0^T r_s ds\\right) P(T,T_i) \\mathbb{I}(r_T < r_T^*) \\right] - K E^Q_0 \\left[ \\exp\\left(-\\int_0^T r_s ds\\right) \\mathbb{I}(r_T < r_T^*) \\right]\n$$\n这将一个关于投资组合的期权分解为一个数字式期权的投资组合。我们现在使用计价单位变换技术来分析每一项。\n\n对于求和中的第 $i$ 项，我们使用零息债券 $P(t, T_i)$ 作为计价单位。相应的远期测度记为 $Q^{T_i}$。Radon-Nikodym 导数为 $\\frac{dQ^{T_i}}{dQ} |_{\\mathcal{F}_t} = \\frac{\\exp(-\\int_0^t r_s ds) P(t, T_i)}{P(0, T_i)}$。该项变为：\n$$\nc_i E^Q_0 [ \\exp(-\\int_0^T r_s ds) P(T,T_i) \\mathbb{I}(r_T < r_T^*) ] = c_i P(0, T_i) E^{Q^{T_i}}_0 [ \\mathbb{I}(r_T < r_T^*) ] = c_i P(0, T_i) Q^{T_i}(r_T < r_T^*)\n$$\n对于表达式中涉及行权价 $K$ 的第二部分，我们使用零息债券 $P(t, T)$ 作为计价单位。相应的远期测度是 $Q^T$。该项变为：\n$$\nK E^Q_0 [ \\exp(-\\int_0^T r_s ds) \\mathbb{I}(r_T < r_T^*) ] = K P(0, T) E^{Q^T}_0 [ \\mathbb{I}(r_T < r_T^*) ] = K P(0, T) Q^T(r_T < r_T^*)\n$$\n合并这些结果，期权价格为：\n$$\nC(0) = \\sum_{i=1}^{N} c_i P(0, T_i) Q^{T_i}(r_T < r_T^*) - K P(0, T) Q^T(r_T < r_T^*)\n$$\n现在问题简化为计算 $S \\in \\{T_1, \\dots, T_N, T\\}$ 的概率 $Q^S(r_T < r_T^*)$。对于 CIR 模型而言，一个已知的结果是，任何远期测度下的这类概率都可以用非中心卡方 CDF 来表示。\n\n我们定义一个通用函数 $\\mathbb{P}(t, T, S, z)$ 来表示在 $S$-远期测度 $Q^S$ 下，$r_T < z$ 的 $t$ 时刻条件概率：\n$$\n\\mathbb{P}(t, T, S, z) := Q^S(r_T < z | \\mathcal{F}_t)\n$$\n该概率由非中心卡方分布的 CDF 给出。令 $\\chi^2_{\\text{cdf}}(x; d, \\lambda)$ 表示该 CDF，其中 $x$ 是变量，$d$ 是自由度，$\\lambda$ 是非中心参数。我们定义以下量：\n-   $\\gamma = \\sqrt{\\kappa^2 + 2\\sigma^2}$\n-   $d = \\frac{4\\kappa\\theta}{\\sigma^2}$ (自由度)\n-   $\\phi(t,T) = \\frac{2\\gamma}{\\sigma^2(\\exp(\\gamma(T-t))-1)}$\n-   $\\psi = \\frac{\\kappa+\\gamma}{\\sigma^2}$\n\n根据这些定义，概率函数由以下公式给出：\n$$\n\\mathbb{P}(t, T, S, z) = \\chi^2_{\\text{cdf}}\\left( 2z \\left(\\phi(t,T)+\\psi+B(T,S)\\right); d; \\frac{2(\\phi(t,T))^2 r_t \\exp(\\gamma(T-t))}{\\phi(t,T)+\\psi+B(T,S)} \\right)\n$$\n对于我们的问题，$t=0$。期权价格可以写成：\n$$\nC(0) = \\sum_{i=1}^{N} c_i P(0, T_i) \\mathbb{P}(0, T, T_i, r_T^*) - K P(0, T) \\mathbb{P}(0, T, T, r_T^*)\n$$\n注意，对于最后一项，计价单位的到期日 $S$ 等于期权到期日 $T$。在这种情况下，$B(T,T)=0$。该公式仍然有效。\n\n通过将 $\\mathbb{P}$ 的显式形式代入价格公式，可以得到最终表达式。临界利率 $r_T^*$ 被隐式地定义为 $\\sum_{i=1}^{N} c_i A(T,T_i) \\exp(-B(T,T_i) r_T^*) = K$ 的唯一正解。\n\n最终表达式通过令以下各项构成：\n-   $\\phi_T = \\frac{2\\gamma}{\\sigma^2(\\exp(\\gamma T)-1)}$\n-   $\\mathbb{P}_i = \\chi^2_{\\text{cdf}}\\left( 2r_T^*(\\phi_T+\\psi+B(T,T_i)); d; \\frac{2\\phi_T^2 r_0 \\exp(\\gamma T)}{\\phi_T+\\psi+B(T,T_i)} \\right)$ (对于 $i=1, \\dots, N$)\n-   $\\mathbb{P}_K = \\chi^2_{\\text{cdf}}\\left( 2r_T^*(\\phi_T+\\psi); d; \\frac{2\\phi_T^2 r_0 \\exp(\\gamma T)}{\\phi_T+\\psi} \\right)$ (因为 $B(T,T)=0$)\n\n期权价格为 $C(0) = \\sum_{i=1}^{N} c_i P(0, T_i) \\mathbb{P}_i - K P(0, T) \\mathbb{P}_K$。", "answer": "$$\n\\boxed{\\sum_{i=1}^{N} c_i P(0, T_i) \\chi^2_{\\text{cdf}}\\left( 2r_T^*\\left(\\phi_T+\\psi+B(T,T_i)\\right); d; \\frac{2\\phi_T^2 r_0 \\exp(\\gamma T)}{\\phi_T+\\psi+B(T,T_i)} \\right) - K P(0, T) \\chi^2_{\\text{cdf}}\\left( 2r_T^*\\left(\\phi_T+\\psi\\right); d; \\frac{2\\phi_T^2 r_0 \\exp(\\gamma T)}{\\phi_T+\\psi} \\right)}\n$$"}]}