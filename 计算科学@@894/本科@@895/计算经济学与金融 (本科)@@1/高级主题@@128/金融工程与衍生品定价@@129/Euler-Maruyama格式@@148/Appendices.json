{"hands_on_practices": [{"introduction": "动手实践是掌握欧拉-丸山法等数值方案精髓的关键。我们将从构建模拟最基本的模块——单步近似——开始。这个练习将帮助您剖析该方案的确定性（漂移）和随机性（扩散）部分在一个时间步长 $\\Delta t$ 内如何相互作用，从而为更复杂的分析奠定坚实的基础。通过计算单步近似的期望值和方差，您将具体理解随机过程的预期走向及其内在的不确定性 [@problem_id:1311634]。", "id": "1311634", "problem": "考虑奥恩斯坦-乌伦贝克过程，这是一个在金融学和物理学中常用于描述均值回归系统的模型。该过程的演化由以下随机微分方程（SDE）决定：\n$$dX_t = -\\lambda X_t dt + \\sigma dW_t$$\n其中 $X_t$ 是过程在时间 $t$ 的值，$\\lambda > 0$ 是均值回归速率，$\\sigma$ 是波动率参数，而 $W_t$ 是一个标准维纳过程（布朗运动）。\n\n为了对解进行数值近似，一种常用的方法是欧拉-丸山格式。对于一个形如 $dX_t = a(X_t, t)dt + b(X_t, t)dW_t$ 的一般SDE，从时间 $t_i$ 到 $t_{i+1} = t_i + \\Delta t$ 的一步欧拉-丸山近似由下式给出：\n$$\\hat{X}_{t_{i+1}} = \\hat{X}_{t_i} + a(\\hat{X}_{t_i}, t_i)\\Delta t + b(\\hat{X}_{t_i}, t_i)\\Delta W_i$$\n其中 $\\Delta W_i = W_{t_{i+1}} - W_{t_i}$ 是维纳过程的一个增量。这些增量是独立的随机变量，每个都从均值为零、方差等于时间步长的正态分布中抽取，即 $\\Delta W_i \\sim N(0, \\Delta t)$。\n\n假设我们有一个特定的奥恩斯坦-乌伦贝克过程，其参数为 $\\lambda = 1$ 和 $\\sigma = 1$，从一个已知的初始值 $X_0 = 3$ 开始。我们希望分析第一个数值步骤的统计特性。\n\n计算经过持续时间为 $\\Delta t$ 的单个时间步长后，近似值 $\\hat{X}_{\\Delta t}$ 的理论期望值和方差。请按顺序将期望值和方差的答案表示为关于时间步长 $\\Delta t$ 的符号表达式对。", "solution": "该问题要求计算给定随机微分方程（SDE）的一步欧拉-丸山近似的期望值 $E[\\hat{X}_{\\Delta t}]$ 和方差 $Var(\\hat{X}_{\\Delta t})$。\n\n该SDE是奥恩斯坦-乌伦贝克过程的一个特例：\n$$dX_t = -\\lambda X_t dt + \\sigma dW_t$$\n参数为 $\\lambda = 1$ 和 $\\sigma = 1$。因此，该SDE为：\n$$dX_t = -X_t dt + dW_t$$\n将其与一般形式 $dX_t = a(X_t, t)dt + b(X_t, t)dW_t$ 进行比较，我们可以确定漂移系数为 $a(X_t, t) = -X_t$，扩散系数为 $b(X_t, t) = 1$。初始条件给定为 $X_0 = 3$。\n\n从 $t_0=0$ 到 $t_1=\\Delta t$ 的单步欧拉-丸山格式为：\n$$\\hat{X}_{\\Delta t} = X_0 + a(X_0, 0)\\Delta t + b(X_0, 0)\\Delta W_0$$\n其中 $\\Delta W_0 = W_{\\Delta t} - W_0$ 是维纳过程的第一个增量。\n\n代入 $a$ 和 $b$ 的具体形式以及初始条件 $X_0 = 3$：\n$$a(X_0, 0) = -X_0 = -3$$\n$$b(X_0, 0) = 1$$\n将这些值代入欧拉-丸山公式，得到近似值 $\\hat{X}_{\\Delta t}$ 的表达式：\n$$\\hat{X}_{\\Delta t} = 3 + (-3)\\Delta t + (1)\\Delta W_0$$\n$$\\hat{X}_{\\Delta t} = 3 - 3\\Delta t + \\Delta W_0$$\n\n现在，我们需要求 $\\hat{X}_{\\Delta t}$ 的期望值。我们使用期望算子 $E[\\cdot]$ 的线性性质。\n$$E[\\hat{X}_{\\Delta t}] = E[3 - 3\\Delta t + \\Delta W_0]$$\n因为 $3$ 和 $3\\Delta t$ 是常数（非随机的），期望算子将它们视为常数：\n$$E[\\hat{X}_{\\Delta t}] = E[3] - E[3\\Delta t] + E[\\Delta W_0]$$\n$$E[\\hat{X}_{\\Delta t}] = 3 - 3\\Delta t + E[\\Delta W_0]$$\n题目中指出，维纳过程增量 $\\Delta W_0$ 来自一个均值为0、方差为 $\\Delta t$ 的正态分布。因此，$E[\\Delta W_0] = 0$。\n将此代入期望值的方程中：\n$$E[\\hat{X}_{\\Delta t}] = 3 - 3\\Delta t + 0 = 3 - 3\\Delta t$$\n\n接下来，我们计算 $\\hat{X}_{\\Delta t}$ 的方差。方差算子 $Var(\\cdot)$ 具有这样的性质：对于任意随机变量 $Z$ 和常数 $c$，$Var(Z+c) = Var(Z)$。\n$$Var(\\hat{X}_{\\Delta t}) = Var(3 - 3\\Delta t + \\Delta W_0)$$\n在此表达式中，项 $3 - 3\\Delta t$ 是一个常数。因此，它对方差没有贡献。\n$$Var(\\hat{X}_{\\Delta t}) = Var(\\Delta W_0)$$\n如题目所述，维纳过程增量的方差等于时间步长，即 $Var(\\Delta W_0) = \\Delta t$。\n所以，一步近似的方差为：\n$$Var(\\hat{X}_{\\Delta t}) = \\Delta t$$\n\n问题要求将期望值和方差表示为一对符号表达式。期望值为 $3 - 3\\Delta t$，方差为 $\\Delta t$。", "answer": "$$\\boxed{\\begin{pmatrix} 3 - 3\\Delta t & \\Delta t \\end{pmatrix}}$$"}, {"introduction": "在理解了单步模拟之后，一个自然的问题是：当我们将成千上万个这样的步骤串联起来时会发生什么？这引出了数值稳定性这一至关重要的概念，即确保我们的模拟不会因为误差累积而“爆炸”。本练习将探讨均方稳定性，并比较显式欧拉-丸山法与更稳健的隐式方法在处理“刚性”随机微分方程时的表现 [@problem_id:2440441]。掌握这种诊断和解决稳定性问题的能力，对于在金融等领域应用这些模型至关重要。", "id": "2440441", "problem": "考虑由 $dX_t = a X_t \\, dt + b X_t \\, dW_t$ 定义的线性标量随机微分方程 (SDE)，其初值为 $X_0 = x_0$，漂移系数为 $a \\in \\mathbb{R}$，波动率系数为 $b \\ge 0$，且其中 $W_t$ 是一个标准维纳过程。令 $\\Delta t > 0$ 表示一个均匀的时间步长，并令 $\\Delta W_n := W_{t_{n+1}} - W_{t_n}$ 为维纳增量，该增量满足 $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ 且对于不同的 $n$ 是独立的。在网格 $t_n = n \\Delta t$ 上定义了两种时间离散格式如下：\n- 显式 Euler-Maruyama (EM) 格式：$X_{n+1}^{\\mathrm{exp}} = X_n^{\\mathrm{exp}} + a X_n^{\\mathrm{exp}} \\, \\Delta t + b X_n^{\\mathrm{exp}} \\, \\Delta W_n$。\n- 漂移项隐式 Euler-Maruyama (EM) 格式：$X_{n+1}^{\\mathrm{imp}} = X_n^{\\mathrm{imp}} + a X_{n+1}^{\\mathrm{imp}} \\, \\Delta t + b X_n^{\\mathrm{imp}} \\, \\Delta W_n$。\n\n对于此线性 SDE，一个单步格式的均方稳定性是由其每步均方放大因子来定义的。将单步更新写成 $X_{n+1} = G X_n$ 的形式，其中 $G$ 是一个依赖于 $a$、$b$、$\\Delta t$ 和 $\\Delta W_n$ 的随机标量，那么该格式是均方稳定的当且仅当 $\\mathbb{E}[|G|^2] < 1$。此处的期望是关于维纳增量 $\\Delta W_n$ 的分布来计算的。\n\n你的任务是，对于下面测试套件中的每一组参数，判断这两种格式中的每一种是否在上述意义下是均方稳定的。对于每一组参数，输出两个布尔值：第一个代表漂移项隐式 Euler-Maruyama 格式的稳定性，第二个代表显式 Euler-Maruyama 格式的稳定性。\n\n测试套件（每个案例是一个三元组 $(a,b,\\Delta t)$）：\n- 案例 1：$(a,b,\\Delta t) = (-50.0, 1.0, 0.05)$。\n- 案例 2：$(a,b,\\Delta t) = (-50.0, 1.0, 0.005)$。\n- 案例 3：$(a,b,\\Delta t) = (0.0, 1.0, 0.1)$。\n\n最终输出格式：你的程序应该生成单行输出，其中包含一个按 $[\\text{imp}_{1}, \\text{exp}_{1}, \\text{imp}_{2}, \\text{exp}_{2}, \\text{imp}_{3}, \\text{exp}_{3}]$ 顺序排列的六个布尔值列表，其中 $\\text{imp}_{k}$ 和 $\\text{exp}_{k}$ 分别是案例 $k$ 中漂移项隐式格式和显式格式的均方稳定性布尔值。该列表必须以方括号括起、逗号分隔的形式打印，例如 $[\\text{True},\\text{False},\\ldots]$。", "solution": "所述问题是有效的。这是一个在随机微分方程数值方法标准理论框架内定义明确的问题。所有必要的定义、参数和条件都已提供，且问题没有科学上的不准确或模糊之处。我们将着手对稳定性条件进行形式化推导。\n\n线性标量随机微分方程 (SDE) 为：\n$$dX_t = a X_t \\, dt + b X_t \\, dW_t, \\quad X_0 = x_0$$\n其中 $a \\in \\mathbb{R}$，$b \\ge 0$，且 $W_t$ 是一个标准维纳过程。单步数值格式 $X_{n+1} = G X_n$ 的均方稳定性由条件 $\\mathbb{E}[|G|^2] < 1$ 确定，其中期望是关于维纳增量 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$ 的分布计算的。我们将使用的维纳增量的关键性质是它的一阶矩和二阶矩：$\\mathbb{E}[\\Delta W_n] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。\n\n首先，我们分析显式 Euler-Maruyama (EM) 格式：\n$$X_{n+1}^{\\mathrm{exp}} = X_n^{\\mathrm{exp}} + a X_n^{\\mathrm{exp}} \\, \\Delta t + b X_n^{\\mathrm{exp}} \\, \\Delta W_n$$\n通过提出因子 $X_n^{\\mathrm{exp}}$，我们可以将其表示为 $X_{n+1}^{\\mathrm{exp}} = G_{\\mathrm{exp}} X_n^{\\mathrm{exp}}$ 的形式：\n$$X_{n+1}^{\\mathrm{exp}} = (1 + a \\Delta t + b \\Delta W_n) X_n^{\\mathrm{exp}}$$\n放大因子为 $G_{\\mathrm{exp}} = 1 + a \\Delta t + b \\Delta W_n$。为检验稳定性，我们计算其平方的期望：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = \\mathbb{E}[(1 + a \\Delta t + b \\Delta W_n)^2]$$\n展开期望内的项可得：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = \\mathbb{E}[(1 + a \\Delta t)^2 + 2(1 + a \\Delta t) b \\Delta W_n + b^2 (\\Delta W_n)^2]$$\n利用期望的线性性质，我们有：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = (1 + a \\Delta t)^2 + 2(1 + a \\Delta t) b \\, \\mathbb{E}[\\Delta W_n] + b^2 \\, \\mathbb{E}[(\\Delta W_n)^2]$$\n代入矩 $\\mathbb{E}[\\Delta W_n] = 0$ 和 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$：\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = (1 + a \\Delta t)^2 + b^2 \\Delta t$$\n因此，显式格式的均方稳定性条件是：\n$$(1 + a \\Delta t)^2 + b^2 \\Delta t < 1$$\n\n接下来，我们分析漂移项隐式 Euler-Maruyama 格式：\n$$X_{n+1}^{\\mathrm{imp}} = X_n^{\\mathrm{imp}} + a X_{n+1}^{\\mathrm{imp}} \\, \\Delta t + b X_n^{\\mathrm{imp}} \\, \\Delta W_n$$\n为了找到放大因子，我们必须首先分离出 $X_{n+1}^{\\mathrm{imp}}$：\n$$X_{n+1}^{\\mathrm{imp}} (1 - a \\Delta t) = X_n^{\\mathrm{imp}} (1 + b \\Delta W_n)$$\n假设 $1 - a \\Delta t \\neq 0$，我们解出 $X_{n+1}^{\\mathrm{imp}}$：\n$$X_{n+1}^{\\mathrm{imp}} = \\left(\\frac{1 + b \\Delta W_n}{1 - a \\Delta t}\\right) X_n^{\\mathrm{imp}}$$\n放大因子为 $G_{\\mathrm{imp}} = \\frac{1 + b \\Delta W_n}{1 - a \\Delta t}$。分母是一个确定性常数。我们计算其平方的期望：\n$$\\mathbb{E}[|G_{\\mathrm{imp}}|^2] = \\mathbb{E}\\left[\\left|\\frac{1 + b \\Delta W_n}{1 - a \\Delta t}\\right|^2\\right] = \\frac{1}{(1 - a \\Delta t)^2} \\mathbb{E}[(1 + b \\Delta W_n)^2]$$\n分子中的期望是 $\\mathbb{E}[1 + 2b \\Delta W_n + b^2 (\\Delta W_n)^2] = 1 + 2b\\mathbb{E}[\\Delta W_n] + b^2\\mathbb{E}[(\\Delta W_n)^2] = 1 + b^2 \\Delta t$。\n因此，我们得到：\n$$\\mathbb{E}[|G_{\\mathrm{imp}}|^2] = \\frac{1 + b^2 \\Delta t}{(1 - a \\Delta t)^2}$$\n漂移项隐式格式的均方稳定性条件是：\n$$\\frac{1 + b^2 \\Delta t}{(1 - a \\Delta t)^2} < 1$$\n\n现在我们将这两个条件应用于测试案例。\n\n案例 1：$(a,b,\\Delta t) = (-50.0, 1.0, 0.05)$\n- **漂移项隐式格式：** 稳定性值为 $\\frac{1 + (1.0)^2(0.05)}{(1 - (-50.0)(0.05))^2} = \\frac{1.05}{(1+2.5)^2} = \\frac{1.05}{12.25} \\approx 0.0857$。由于 $0.0857 < 1$，该格式是稳定的 (True)。\n- **显式格式：** 稳定性值为 $(1 + (-50.0)(0.05))^2 + (1.0)^2(0.05) = (1 - 2.5)^2 + 0.05 = (-1.5)^2 + 0.05 = 2.25 + 0.05 = 2.3$。由于 $2.3 \\ge 1$，该格式是不稳定的 (False)。\n\n案例 2：$(a,b,\\Delta t) = (-50.0, 1.0, 0.005)$\n- **漂移项隐式格式：** 稳定性值为 $\\frac{1 + (1.0)^2(0.005)}{(1 - (-50.0)(0.005))^2} = \\frac{1.005}{(1+0.25)^2} = \\frac{1.005}{1.5625} = 0.6432$。由于 $0.6432 < 1$，该格式是稳定的 (True)。\n- **显式格式：** 稳定性值为 $(1 + (-50.0)(0.005))^2 + (1.0)^2(0.005) = (1 - 0.25)^2 + 0.005 = (0.75)^2 + 0.005 = 0.5625 + 0.005 = 0.5675$。由于 $0.5675 < 1$，该格式是稳定的 (True)。\n\n案例 3：$(a,b,\\Delta t) = (0.0, 1.0, 0.1)$\n当 $a=0.0$ 时，两种格式相同，我们预期稳定性结果也相同。\n- **漂移项隐式格式：** 稳定性值为 $\\frac{1 + (1.0)^2(0.1)}{(1 - (0.0)(0.1))^2} = \\frac{1.1}{1^2} = 1.1$。由于 $1.1 \\ge 1$，该格式是不稳定的 (False)。\n- **显式格式：** 稳定性值为 $(1 + (0.0)(0.1))^2 + (1.0)^2(0.1) = 1^2 + 0.1 = 1.1$。由于 $1.1 \\ge 1$，该格式是不稳定的 (False)。\n\n按指定顺序组合这些结果，得到最终的布尔值列表：$[\\text{True}, \\text{False}, \\text{True}, \\text{True}, \\text{False}, \\text{False}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Determines the mean-square stability of two Euler-Maruyama schemes for a\n    linear scalar SDE for a given set of test cases.\n    \"\"\"\n    # Test suite: each case is a tuple (a, b, dt)\n    test_cases = [\n        (-50.0, 1.0, 0.05),\n        (-50.0, 1.0, 0.005),\n        (0.0, 1.0, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, dt = case\n\n        # --- Drift-implicit Euler-Maruyama stability analysis ---\n        # The stability condition is derived from E[|G_imp|^2] < 1, where\n        # G_imp = (1 + b*dW_n) / (1 - a*dt).\n        # This leads to the condition: (1 + b**2 * dt) / (1 - a * dt)**2 < 1.\n        \n        # Note: The denominator (1 - a*dt) is non-zero for all test cases.\n        imp_stability_value = (1 + b**2 * dt) / (1 - a * dt)**2\n        is_stable_imp = imp_stability_value < 1.0\n        results.append(is_stable_imp)\n\n        # --- Explicit Euler-Maruyama stability analysis ---\n        # The stability condition is derived from E[|G_exp|^2] < 1, where\n        # G_exp = 1 + a*dt + b*dW_n.\n        # This leads to the condition: (1 + a * dt)**2 + b**2 * dt < 1.\n        \n        exp_stability_value = (1 + a * dt)**2 + b**2 * dt\n        is_stable_exp = exp_stability_value < 1.0\n        results.append(is_stable_exp)\n\n    # The final output must be a single line containing a list of boolean values\n    # ordered as [imp_1, exp_1, imp_2, exp_2, imp_3, exp_3].\n    # map(str, results) converts [True, False, ...] to ['True', 'False', ...].\n    # ','.join(...) creates the comma-separated string 'True,False,...'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"}, {"introduction": "既然我们已经知道如何构建一个稳定的模拟，我们如何才能让它在有限的计算资源下尽可能精确？这个高级练习将引导您思考计算效率的核心问题：如何在统计误差（源于有限的模拟路径 $N$）和离散化误差（源于有限的时间步长 $\\Delta t$）之间找到最佳平衡。通过应用弱收敛理论，您将学习如何在一个固定的计算“预算”下，优化参数选择以最小化整体误差 [@problem_id:2440399]。这代表了从理解算法到设计高效数值实验的关键一步。", "id": "2440399", "problem": "在计算经济学和金融学中，考虑使用蒙特卡洛 (MC) 模拟和 Euler-Maruyama (EM) 时间离散化方法，估计一个随机微分方程 (SDE) 的终端状态 $X_T$ 的光滑回报 $f$ 的期望。具体来说，令 $X_t$ 求解\n$$\n\\mathrm{d}X_t = a(X_t)\\,\\mathrm{d}t + b(X_t)\\,\\mathrm{d}W_t,\\quad t\\in[0,T],\\quad X_0=x_0,\n$$\n其中 $a(\\cdot)$ 和 $b(\\cdot)$ 是全局利普希茨的，$T>0$，并假设 $f$ 足够光滑，使得 EM 格式对于 $\\mathbb{E}[f(X_T)]$ 具有 $p=1$ 的弱收敛阶。你使用均匀时间步长 $\\Delta t$ 模拟了 $N$ 条独立路径，因此每条路径的时间步数为 $M=T\\,\\Delta t^{-1}$。\n\n假设使用以下成本和误差模型：\n- 总计算成本与计算的总时间步数成正比，因此固定预算约束可以写为 $N\\,M=K$，其中 $K>0$ 是一个给定的常数，且必须完全使用。\n- MC 估计量 $\\hat{\\mu}_{N,\\Delta t}=\\frac{1}{N}\\sum_{i=1}^{N} f(\\hat{X}_T^{(i)})$ 对 $\\mu=\\mathbb{E}[f(X_T)]$ 的均方误差 (MSE) 可以进行标准分解，即方差加上偏差的平方。在所述的光滑性条件下，方差的量级为 $C_1 N^{-1}$（其中某个 $C_1>0$ 独立于 $N$ 和 $\\Delta t$），偏差平方的量级为 $C_2 \\Delta t^{2p}=C_2 \\Delta t^{2}$（其中某个 $C_2>0$ 独立于 $N$ 和 $\\Delta t$）。可以忽略高阶项。\n\n在这些假设和预算约束 $N\\,T\\,\\Delta t^{-1}=K$ 下，关于使用更多路径 $N$ 与使用更小时间步长 $\\Delta t$ 之间的权衡，以下哪些陈述是正确的？\n\nA. 存在一个最小化 MSE 的内部最优配置，其特征为（在不考虑独立于 $K$ 的正常数乘子的情况下）$\\Delta t^\\star \\propto K^{-1/3}$ 和 $N^\\star \\propto K^{2/3}$。\n\nB. 对于任何固定的预算 $K$，最大化 $N$（并因此使用满足预算所需的尽可能大的 $\\Delta t$）总是能最小化 MSE。\n\nC. 当 EM 格式的弱收敛阶为 $p=1$ 时，在固定预算下的最优配置会使方差和偏差平方对 MSE 的贡献相等。\n\nD. 如果方差的量级为 $\\mathcal{O}(N^{-1})$ 且弱离散化误差的量级为 $\\mathcal{O}(\\Delta t)$，则在固定预算 $K$ 下，可达到的最小 MSE 的量级为 $\\mathcal{O}(K^{-2/3})$。\n\nE. 在为光滑的 $f$ 估计 $\\mathbb{E}[f(X_T)]$ 时，EM 的强收敛阶决定了 MSE 中的离散化偏差；弱收敛阶在这一目的上是无关紧要的。\n\n选择所有适用的选项。", "solution": "该问题要求分析随机微分方程的蒙特卡洛模拟中的权衡问题，具体是如何分配固定的计算预算以最小化均方误差。我将首先验证问题的陈述，并在确认其有效性后，对每个选项进行完整的数学推导和评估。\n\n问题是有效的。它提出了计算金融领域中一个标准的、适定的优化问题。关于 SDE、Euler-Maruyama 格式、误差分量和计算成本的假设都是标准的且科学上合理的。问题是自洽的，并且陈述得足够精确，可以得出一个唯一的、可验证的解。\n\n让我们开始推导。目标是估计 $\\mu = \\mathbb{E}[f(X_T)]$。估计量 $\\hat{\\mu}_{N,\\Delta t}$ 的均方误差 (MSE) 由方差和偏差的平方之和给出。根据问题陈述，我们有：\n$$\n\\text{MSE} \\approx C_1 N^{-1} + C_2 \\Delta t^{2p}\n$$\n其中 $p=1$ 是弱收敛阶。因此，需要最小化的函数是：\n$$\nE(N, \\Delta t) = C_1 N^{-1} + C_2 \\Delta t^2\n$$\n最小化受制于一个固定的计算预算约束：\n$$\nN \\cdot M = K\n$$\n其中 $M = T \\Delta t^{-1}$ 是时间步数。将 $M$ 代入约束条件，得到：\n$$\nN T \\Delta t^{-1} = K\n$$\n其中 $K > 0$ 是一个代表总预算的常数。这个约束关联了路径数 $N$ 和时间步长 $\\Delta t$。我们可以用一个变量表示另一个变量。让我们把 $N$ 表示为 $\\Delta t$ 的函数：\n$$\nN = K T^{-1} \\Delta t\n$$\n现在，我们将这个 $N$ 的表达式代入 MSE 方程，以获得作为单个变量 $\\Delta t$ 的函数的 MSE：\n$$\nE(\\Delta t) = C_1 (K T^{-1} \\Delta t)^{-1} + C_2 \\Delta t^2 = C_1 T K^{-1} \\Delta t^{-1} + C_2 \\Delta t^2\n$$\n为了找到最小化此误差的最优时间步长 $\\Delta t^\\star$，我们必须计算 $E(\\Delta t)$ 关于 $\\Delta t$ 的一阶导数并令其为零。\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}\\Delta t} = -C_1 T K^{-1} \\Delta t^{-2} + 2 C_2 \\Delta t\n$$\n令导数为零，得到极值的一阶条件：\n$$\n2 C_2 \\Delta t = C_1 T K^{-1} \\Delta t^{-2}\n$$\n求解 $\\Delta t$:\n$$\n\\Delta t^3 = \\frac{C_1 T}{2 C_2 K}\n$$\n$$\n\\Delta t^\\star = \\left(\\frac{C_1 T}{2 C_2}\\right)^{1/3} K^{-1/3}\n$$\n二阶导数为 $\\frac{\\mathrm{d}^2E}{\\mathrm{d}(\\Delta t)^2} = 2 C_1 T K^{-1} \\Delta t^{-3} + 2 C_2$，对于 $\\Delta t > 0$ 严格为正，这证实了这确实是一个最小值。\n\n使用关系式 $N = K T^{-1} \\Delta t$，我们找到最优路径数 $N^\\star$：\n$$\nN^\\star = K T^{-1} \\Delta t^\\star = K T^{-1} \\left(\\frac{C_1 T}{2 C_2}\\right)^{1/3} K^{-1/3} = \\left(\\frac{C_1 K^3 T^{-3} T}{2 C_2}\\right)^{1/3} = \\left(\\frac{C_1 K^2}{2 C_2 T^2}\\right)^{1/3}\n$$\n从这些表达式中，我们可以确定相对于预算 $K$ 的缩放关系：\n$$\n\\Delta t^\\star \\propto K^{-1/3} \\quad \\text{和} \\quad N^\\star \\propto K^{2/3}\n$$\n现在我们来评估每个陈述。\n\nA. 存在一个最小化 MSE 的内部最优配置，其特征为（在不考虑独立于 $K$ 的正常数乘子的情况下）$\\Delta t^\\star \\propto K^{-1/3}$ 和 $N^\\star \\propto K^{2/3}$。\n我们的推导表明，存在一个唯一的正值 $\\Delta t^\\star$ 可以最小化 MSE。这代表一个内部最优解，而不是 $\\Delta t \\to 0$ 或 $\\Delta t$ 取最大值的边界解。推导出的缩放关系是 $\\Delta t^\\star \\propto K^{-1/3}$ 和 $N^\\star \\propto (K^2)^{1/3} = K^{2/3}$。这正是该陈述所声称的。\n结论：**正确**。\n\nB. 对于任何固定的预算 $K$，最大化 $N$（并因此使用满足预算所需的尽可能大的 $\\Delta t$）总是能最小化 MSE。\n根据预算约束 $N = K T^{-1} \\Delta t$，最大化路径数 $N$ 需要最大化时间步长 $\\Delta t$。这会最小化方差项 $C_1 N^{-1}$，但会最大化偏差平方项 $C_2 \\Delta t^2$。由于我们已经找到了一个内部最优解，这种处于权衡一端的角点解不可能是全局最小值。最优平衡取决于常数 $C_1$ 和 $C_2$ 的相对大小。\n结论：**不正确**。\n\nC. 当 EM 格式的弱收敛阶为 $p=1$ 时，在固定预算下的最优配置会使方差和偏差平方对 MSE 的贡献相等。\n让我们检查最优配置下的两个误差分量。\n方差项是 $V^\\star = C_1 (N^\\star)^{-1} = C_1 (K T^{-1} \\Delta t^\\star)^{-1} = C_1 T K^{-1} (\\Delta t^\\star)^{-1}$。\n偏差平方项是 $(B^\\star)^2 = C_2 (\\Delta t^\\star)^2$。\n根据我们的一阶最优性条件，$2 C_2 \\Delta t^\\star = C_1 T K^{-1} (\\Delta t^\\star)^{-2}$。两边乘以 $\\Delta t^\\star$，我们得到：\n$$\n2 C_2 (\\Delta t^\\star)^2 = C_1 T K^{-1} (\\Delta t^\\star)^{-1}\n$$\n这等价于：\n$$\n2 (B^\\star)^2 = V^\\star\n$$\n在最优解处，方差的贡献是偏差平方贡献的两倍。它们不相等。\n结论：**不正确**。\n\nD. 如果方差的量级为 $\\mathcal{O}(N^{-1})$ 且弱离散化误差的量级为 $\\mathcal{O}(\\Delta t)$，则在固定预算 $K$ 下，可达到的最小 MSE 的量级为 $\\mathcal{O}(K^{-2/3})$。\n该陈述的前提与问题设定一致，其中“弱离散化误差”的量级为 $\\mathcal{O}(\\Delta t)$ 对应于弱收敛阶 $p=1$，因此偏差平方的量级为 $\\mathcal{O}(\\Delta t^2)$。让我们计算最小 MSE， $E^\\star = E(\\Delta t^\\star)$:\n$$\nE^\\star = V^\\star + (B^\\star)^2\n$$\n使用关系式 $V^\\star = 2(B^\\star)^2$，我们有 $E^\\star = 3(B^\\star)^2 = 3 C_2 (\\Delta t^\\star)^2$。\n因为我们发现 $\\Delta t^\\star \\propto K^{-1/3}$，所以最小 MSE 的量级为：\n$$\nE^\\star \\propto (\\Delta t^\\star)^2 \\propto (K^{-1/3})^2 = K^{-2/3}\n$$\n可达到的最小 MSE 的量级为 $\\mathcal{O}(K^{-2/3})$。\n结论：**正确**。\n\nE. 在为光滑的 $f$ 估计 $\\mathbb{E}[f(X_T)]$ 时，EM 的强收敛阶决定了 MSE 中的离散化偏差；弱收敛阶在这一目的上是无关紧要的。\n对于量 $\\mathbb{E}[f(X_T)]$，MSE 中的离散化偏差正是差值 $\\mathbb{E}[f(\\hat{X}_T)] - \\mathbb{E}[f(X_T)]$，其中 $\\hat{X}_T$ 是在时间 $T$ 的数值近似。随着 $\\Delta t \\to 0$，这个差值收敛到零的速率正是弱收敛阶的定义。另一方面，强收敛阶关注的是路径误差，由诸如 $\\mathbb{E}[|X_T - \\hat{X}_T|]$ 之类的量来表征。虽然强收敛可以为弱误差提供一个上界，但弱收敛阶给出了我们所关心的偏差的精确速率。对于 Euler-Maruyama 格式，弱收敛阶（$p=1$）通常高于强收敛阶（$\\gamma=0.5$），这使其成为在此背景下衡量偏差的更相关和更准确的度量。该陈述从根本上与这些定义相悖。\n结论：**不正确**。", "answer": "$$\\boxed{AD}$$"}]}