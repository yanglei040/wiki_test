{"hands_on_practices": [{"introduction": "虽然 Euler-Maruyama 等基础格式易于实现，但它们在处理具有特定约束的复杂模型时可能会失效。Cox-Ingersoll-Ross (CIR) 模型是另一个重要的利率模型，其理论解在特定条件下保证为非负，这与利率的经济含义相符。然而，标准的数值离散格式可能会打破这一重要属性，产生无意义的负值。本练习将引导你分析 Euler-Maruyama 格式在 CIR 模型边界附近的行为，量化其产生负值的概率，并探讨如何通过修正方案来确保解的非负性，从而加深对数值方法局限性的理解。[@problem_id:2969007]", "id": "2969007", "problem": "考虑 Cox–Ingersoll–Ross (CIR) 随机微分方程 (SDE)\n$$\ndX_t \\;=\\; \\kappa\\big(\\theta - X_t\\big)\\,dt \\;+\\; \\sigma \\sqrt{X_t}\\,dW_t,\n$$\n其中参数 $\\,\\kappa>0\\,$, $\\,\\theta\\ge 0\\,$ 且 $\\,\\sigma>0\\,$，$\\,W_t\\,$ 为标准布朗运动。回顾在 Feller 条件 $\\,2\\kappa\\theta \\ge \\sigma^2\\,$下，对于严格为正的初始数据，其精确解几乎必然是严格为正的。考虑步长为 $\\,\\Delta>0\\,$ 的显式 Euler–Maruyama 时间离散化：\n$$\nX_{n+1} \\;=\\; X_n \\;+\\; \\kappa\\big(\\theta - X_n\\big)\\Delta \\;+\\; \\sigma \\sqrt{X_n}\\,\\Delta W_n,\n$$\n其中 $\\,\\Delta W_n := W_{t_{n+1}} - W_{t_n} \\sim \\mathcal N(0,\\Delta)\\,$ 是独立的增量。尽管精确过程是非负的，但上述离散更新可能会产生负值。\n\n从第一性原理出发，分析 Euler–Maruyama 格式在边界附近的一步行为，并评估保持正性的修正方法。具体来说：\n\n- 给定条件 $\\,X_n = x \\ge 0\\,$，将下一步 Euler–Maruyama 迭代结果为负的条件概率 $\\,\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right]\\,$ 用标准正态累积分布函数 $\\,\\Phi\\,$ 表示。\n- 在两种情形下分析小步长行为：(i) 固定 $\\,x>0\\,$，当 $\\,\\Delta\\to 0\\,$ 时；以及 (ii) $\\,x = c\\,\\Delta\\,$，固定 $\\,c>0\\,$，当 $\\,\\Delta\\to 0\\,$ 时。解释为什么情形 (ii) 是与边界行为相关的。\n- 评估以下陈述并选择所有正确的选项：\n\nA. 对于任意 $\\,x>0\\,$，\n$$\n\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;=\\; \\Phi\\!\\left(\\,-\\,\\frac{x + \\kappa(\\theta - x)\\,\\Delta}{\\sigma\\sqrt{x\\,\\Delta}}\\,\\right).\n$$\n\nB. 对于固定的 $\\,x>0\\,$，当 $\\,\\Delta\\to 0\\,$ 时，有 $\\,\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] = \\mathcal O(\\sqrt{\\Delta})\\,$。\n\nC. 如果 $\\,x = c\\,\\Delta\\,$ 且 $\\,c>0\\,$ 固定，那么当 $\\,\\Delta\\to 0\\,$ 时，\n$$\n\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;\\longrightarrow\\; \\Phi\\!\\left(\\,-\\,\\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\\,\\right).\n$$\n\nD. 吸收-全截断 Euler 变体\n$$\nX_{n+1} \\;:=\\; \\max\\!\\Big(x \\;+\\; \\kappa\\big(\\theta - x^+\\big)\\Delta \\;+\\; \\sigma \\sqrt{x^+}\\,\\Delta W_n,\\; 0\\Big), \n\\quad x^+ := \\max(x,0),\n$$\n保证了非负性。此外，对于远离 $\\,0\\,$ 的 $\\,x\\,$，它在 $\\Delta\\,$ 的主阶上保持了一阶漂移，即\n$$\n\\mathbb E\\!\\left[X_{n+1} - x \\,\\middle|\\, X_n = x\\right] \\;=\\; \\kappa(\\theta - x)\\,\\Delta \\;+\\; o(\\Delta)\n\\quad\\text{as } \\Delta\\to 0.\n$$\n\nE. 对于 CIR 过程的一步 $\\,\\Delta\\,$ 转移，存在一个精确模拟格式：给定 $\\,X_n=x\\,$，抽取\n$$\nY \\sim \\chi^{\\prime 2}_{d}(\\lambda),\n\\quad d = \\frac{4\\kappa\\theta}{\\sigma^2}, \n\\quad \\lambda = \\frac{4\\kappa e^{-\\kappa \\Delta}}{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}\\,x,\n$$\n并设置\n$$\nX_{n+1} \\;=\\; \\frac{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}{4\\kappa}\\,Y,\n$$\n这将得到 $\\,X_{t_{n+1}}\\,$ 的精确分布并保证非负性。\n\n选择所有正确的选项。", "solution": "该问题陈述是分析随机微分方程数值格式（特别是 Cox-Ingersoll-Ross (CIR) 模型）的一个标准练习。所有定义和参数都是标准的且自洽的。该问题具有科学依据，是适定的、客观的，并包含了进行严谨分析所需的所有必要信息。因此，该问题是有效的，我们可以着手求解。\n\n问题的核心是分析 CIR 过程的 Euler-Maruyama (EM) 离散化的一步行为。该SDE由下式给出：\n$$\ndX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t\n$$\n步长为 $\\Delta > 0$ 的 EM 格式为：\n$$\nX_{n+1} = X_n + \\kappa(\\theta - X_n)\\Delta + \\sigma \\sqrt{X_n}\\,\\Delta W_n\n$$\n其中 $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta)$ 是独立的布朗增量。\n\n### 负值概率分析\n首先，我们推导条件概率 $\\mathbb{P}[X_{n+1} < 0 \\mid X_n = x]$。设 $X_n = x$，其中我们假设 $x \\ge 0$。\n如果 $x=0$，EM 更新方程变为 $X_{n+1} = 0 + \\kappa(\\theta - 0)\\Delta + \\sigma\\sqrt{0}\\,\\Delta W_n = \\kappa\\theta\\Delta$。由于 $\\kappa > 0$，$\\theta \\ge 0$ 且 $\\Delta > 0$，我们有 $X_{n+1} \\ge 0$。因此，$\\mathbb{P}[X_{n+1} < 0 \\mid X_n = 0] = 0$。\n\n对于 $x > 0$，条件 $X_{n+1} < 0$ 等价于：\n$$\nx + \\kappa(\\theta - x)\\Delta + \\sigma \\sqrt{x}\\,\\Delta W_n < 0\n$$\n我们可以写成 $\\Delta W_n = \\sqrt{\\Delta}Z$，其中 $Z \\sim \\mathcal{N}(0, 1)$ 是一个标准正态随机变量。代入可得：\n$$\nx + \\kappa(\\theta - x)\\Delta + \\sigma \\sqrt{x\\Delta}\\,Z < 0\n$$\n分离出含随机变量 $Z$ 的项：\n$$\n\\sigma \\sqrt{x\\Delta}\\,Z < - \\left(x + \\kappa(\\theta - x)\\Delta\\right)\n$$\n由于 $\\sigma>0$，$x>0$ 且 $\\Delta>0$，项 $\\sigma\\sqrt{x\\Delta}$ 为正，我们可以用它来除不等式两边而不改变不等号方向：\n$$\nZ < - \\frac{x + \\kappa(\\theta - x)\\Delta}{\\sigma\\sqrt{x\\Delta}}\n$$\n该事件的概率由标准正态分布的累积分布函数 (CDF) $\\Phi(\\cdot)$ 给出：\n$$\n\\mathbb{P}[X_{n+1} < 0 \\mid X_n = x] = \\Phi\\left(- \\frac{x + \\kappa(\\theta - x)\\Delta}{\\sigma\\sqrt{x\\Delta}}\\right)\n$$\n\n### 小步长行为分析\n问题要求分析 $\\Delta \\to 0$ 时的两种情形。\n\n**情形 (i)：固定 $x > 0$**\n我们考察当 $\\Delta \\to 0$ 时 $\\Phi$ 的自变量：\n$$\nA(\\Delta) = - \\frac{x + \\kappa(\\theta - x)\\Delta}{\\sigma\\sqrt{x\\Delta}} = - \\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}} - \\frac{\\kappa(\\theta-x)\\sqrt{\\Delta}}{\\sigma\\sqrt{x}}\n$$\n当 $\\Delta \\to 0$ 时，第一项 $-\\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}}$ 占主导，因此 $A(\\Delta) \\to -\\infty$。于是，$\\mathbb{P}[X_{n+1} < 0 \\mid X_n = x] = \\Phi(A(\\Delta)) \\to 0$。\n\n**情形 (ii)：$x = c\\Delta$，其中 $c > 0$ 固定**\n这种情形模拟了过程靠近边界 $0$ 时的行为，此时到边界的距离与步长成正比。将 $x = c\\Delta$ 代入我们的概率表达式中：\n$$\n\\mathbb{P}[X_{n+1} < 0 \\mid X_n = c\\Delta] = \\Phi\\left(- \\frac{c\\Delta + \\kappa(\\theta - c\\Delta)\\Delta}{\\sigma\\sqrt{(c\\Delta)\\Delta}}\\right) = \\Phi\\left(- \\frac{c\\Delta + \\kappa\\theta\\Delta - \\kappa c\\Delta^2}{\\sigma\\sqrt{c}\\Delta}\\right)\n$$\n将自变量的分子和分母同除以 $\\Delta$：\n$$\n- \\frac{c + \\kappa\\theta - \\kappa c\\Delta}{\\sigma\\sqrt{c}}\n$$\n取 $\\Delta \\to 0$ 的极限：\n$$\n\\lim_{\\Delta\\to 0} \\left(- \\frac{c + \\kappa\\theta - \\kappa c\\Delta}{\\sigma\\sqrt{c}}\\right) = - \\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\n$$\n由于 $\\Phi$ 是一个连续函数，概率的极限为：\n$$\n\\lim_{\\Delta\\to 0} \\mathbb{P}[X_{n+1} < 0 \\mid X_n = c\\Delta] = \\Phi\\left(- \\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\\right)\n$$\n这个极限是一个正常数（因为 $c>0, \\kappa>0, \\sigma>0$）。这表明，如果过程距离边界的量级为 $\\mathcal{O}(\\Delta)$，那么无论 $\\Delta$ 多小，标准的 EM 格式都会有非零的概率产生一个负值。这就是为什么情形 (ii) 是描述该格式在边界处失效的关键情形。\n\n现在，我们来评估每个陈述。\n\n**A. 对于任意 $\\,x>0\\,$，$\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;=\\; \\Phi\\!\\left(\\,-\\,\\frac{x + \\kappa(\\theta - x)\\,\\Delta}{\\sigma\\sqrt{x\\,\\Delta}}\\,\\right)$.**\n我们上面的推导完全证实了对于任意 $x>0$ 这个公式都是成立的。\n**结论：正确。**\n\n**B. 对于固定的 $\\,x>0\\,$，当 $\\,\\Delta\\to 0\\,$ 时，有 $\\,\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] = \\mathcal O(\\sqrt{\\Delta})\\,$.**\n根据我们对情形 (i) 的分析，对于小的 $\\Delta$，$\\Phi$ 的自变量为 $A(\\Delta) \\approx -\\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}}$。对于大的负自变量 $z$，CDF 具有渐近行为 $\\Phi(z) \\sim \\frac{1}{|z|\\sqrt{2\\pi}} e^{-z^2/2}$。\n令 $z=A(\\Delta)$。则 $|z| \\sim \\frac{\\sqrt{x}}{\\sigma\\sqrt{\\Delta}}$ 且 $z^2 \\sim \\frac{x}{\\sigma^2\\Delta}$。\n因此概率为\n$$\n\\mathbb{P}[X_{n+1}<0 \\mid X_n = x] \\sim \\frac{\\sigma\\sqrt{\\Delta}}{\\sqrt{x}\\sqrt{2\\pi}} \\exp\\left(-\\frac{x}{2\\sigma^2\\Delta}\\right)\n$$\n指数项 $\\exp(-K/\\Delta)$，其中 $K = x/(2\\sigma^2) > 0$，比 $\\Delta$ 的任何次幂都更快地趋于零。也就是说，对于任何 $k>0$，该概率为 $o(\\Delta^k)$。\n一个 $o(\\Delta)$ 的函数在技术上也属于 $\\mathcal{O}(\\sqrt{\\Delta})$，因为 $\\lim_{\\Delta \\to 0} \\frac{o(\\Delta)}{\\sqrt{\\Delta}} = 0$，这意味着该比率是有界的。然而，在渐近分析的背景下，声称一个超多项式衰减的函数是 $\\mathcal{O}(\\sqrt{\\Delta})$ 是一个关于其收敛速度的极度缺乏信息且具有误导性的陈述。实际的速率不是多项式级的。这样的陈述错误地描述了其行为，很可能是为了让人识别出它是一个对渐近速率的错误描述。\n**结论：不正确。**\n\n**C. 如果 $\\,x = c\\,\\Delta\\,$ 且 $\\,c>0\\,$ 固定，那么当 $\\,\\Delta\\to 0\\,$ 时，$\\mathbb P\\!\\left[X_{n+1}<0 \\,\\middle|\\, X_n = x\\right] \\;\\longrightarrow\\; \\Phi\\!\\left(\\,-\\,\\frac{c + \\kappa\\theta}{\\sigma\\sqrt{c}}\\,\\right)$.**\n我们对情形 (ii) 的分析推导出了这个确切的极限。\n**结论：正确。**\n\n**D. 吸收-全截断 Euler 变体 ... 保证了非负性。此外，对于远离 $\\,0\\,$ 的 $\\,x\\,$，它保持了一阶漂移...**\n该格式为 $X_{n+1} := \\max(Y, 0)$，其中 $Y = x + \\kappa(\\theta - x^+)\\Delta + \\sigma \\sqrt{x^+}\\,\\Delta W_n$ 且 $x^+=\\max(x,0)$。\n首先，通过与 $0$ 取最大值，得到的 $X_{n+1}$ 被保证是非负的。这部分是正确的。\n其次，我们必须分析当 $x>0$（远离零）时的条件期望，此时 $x^+=x$。\n令 $Y_n = x + \\kappa(\\theta - x)\\Delta + \\sigma\\sqrt{x}\\,\\Delta W_n$。$Y_n$ 服从正态分布，其均值为 $\\mu = x + \\kappa(\\theta - x)\\Delta$，方差为 $s^2 = \\sigma^2 x \\Delta$。\n修正后格式的漂移是 $\\mathbb{E}[X_{n+1} - x \\mid X_n=x] = \\mathbb{E}[\\max(Y_n, 0)] - x$。\n我们知道 $\\mathbb{E}[Y_n] = \\mu$。我们可以写成 $\\max(Y_n, 0) = Y_n - Y_n^-$，其中 $Y_n^- = \\min(Y_n, 0)$。所以 $\\mathbb{E}[\\max(Y_n, 0)] = \\mu - \\mathbb{E}[Y_n^-]$。误差项为 $\\mathbb{E}[Y_n^-] = \\int_{-\\infty}^0 y f_{Y_n}(y) dy$。该误差项的绝对值由 $\\int_{-\\infty}^0 |y| f_{Y_n}(y) dy$ 界定。\n如选项 B 的分析所示，对于固定的 $x>0$，$Y_n$ 为负的概率 $\\mathbb{P}(Y_n < 0)$ 随着 $\\Delta \\to 0$ 超多项式衰减。积分 $\\int_{-\\infty}^0 y f_{Y_n}(y) dy$ 也超多项式衰减。因此，对于任何 $k>0$，$\\mathbb{E}[\\max(Y_n, 0)] = \\mu - o(\\Delta^k) = \\mu + o(\\Delta)$。\n那么漂移为：\n$$\n\\mathbb{E}[X_{n+1} - x] = \\mathbb{E}[\\max(Y_n, 0)] - x = \\left(x + \\kappa(\\theta - x)\\Delta + o(\\Delta)\\right) - x = \\kappa(\\theta - x)\\Delta + o(\\Delta)\n$$\n这与选项中给出的表达式相符。因此，陈述 D 中的两个论断都是正确的。\n**结论：正确。**\n\n**E. 对于 CIR 过程的一步转移，存在一个精确的模拟格式...**\n该陈述描述了著名的 CIR 过程精确模拟方法。给定 $X_t=x$，$X_{t+\\Delta}$ 的精确分布是一个经过缩放的非中心卡方随机变量的分布，即 $X_{t+\\Delta} \\sim c \\cdot \\chi'^2_d(\\lambda)$。选项中提供的参数是：\n- 缩放因子: $c = \\frac{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}{4\\kappa}$\n- 自由度: $d = \\frac{4\\kappa\\theta}{\\sigma^2}$\n- 非中心参数: $\\lambda = \\frac{4\\kappa e^{-\\kappa \\Delta}}{\\sigma^2\\big(1 - e^{-\\kappa \\Delta}\\big)}\\,x$\n这些是在数学金融和随机过程文献中可以找到的标准、正确的参数。一个非中心卡方变量是正态变量平方和，因此它几乎必然是非负的。一个正的缩放常数 $c$ 保持了这个性质。因此，该格式保证了非负性，并完美地再现了 CIR 过程的转移定律。\n**结论：正确。**", "answer": "$$\\boxed{ACDE}$$"}, {"introduction": "超越数值近似误差的讨论，随机微分方程的建模还涉及一个更根本的问题：数学诠释。一个形如 $dX_t = a(X_t)dt + b(X_t)dW_t$ 的方程，根据其随机积分定义方式的不同（Itô 积分或 Stratonovich 积分），可以描述截然不同的随机过程。本次实践以金融中最常见的几何布朗运动模型为例，要求你从第一性原理出发，推导和验证两种诠释如何导致截然相反的长期稳定性结论。这个练习将揭示，对随机微分方程的正确诠释对于模型构建和其行为预测至关重要。[@problem_id:2415964]", "id": "2415964", "problem": "要求您设计、分析并数值验证一个案例，在该案例中，对同一个符号随机微分方程的伊藤（Itô）和斯特拉托诺维奇（Stratonovich）诠释会产生相反的长期稳定性评估。请严格在计算经济学和金融学中使用的线性、乘性噪声模型参数族内进行研究：\n$$\ndX_t = \\alpha\\,X_t\\,dt + \\beta\\,X_t\\,\\star\\,dW_t, \n$$\n其中 $X_t$ 是一个实值状态，$\\alpha \\in \\mathbb{R}$ 是一个恒定的漂移系数，$\\beta \\in \\mathbb{R}$ 是一个恒定的扩散负载，$W_t$ 是一个标准维纳过程，$\\star$ 表示伊藤诠释（写作 $dW_t$）或斯特拉托诺维奇诠释（写作 $\\circ\\,dW_t$）。您的目标是从第一性原理出发，展示为什么 $X_t$ 的长期几乎必然增长率依赖于诠释方式，构建一组参数使得稳定性结论相反，然后通过数值方法进行验证。\n\n您的推理起点：\n- 伊藤积分和斯特拉托诺维奇积分的定义及其各自不同的链式法则。\n- 应用于足够光滑被积函数的伊藤-斯特拉托诺维奇随机积分转换法则。\n- $X_t$ 的几乎必然长期增长率的定义，即当极限存在时，$\\frac{1}{T}\\ln|X_T|$ 在 $T \\to \\infty$ 时的极限。\n\n您的任务：\n1) 基于上述基本原理，并且不借助任何现成的“捷径”公式，推导出在伊藤诠释和斯特拉托诺维奇诠释下，模型族 $dX_t = \\alpha X_t\\,dt + \\beta X_t\\,\\star\\,dW_t$ 的几乎必然长期增长率的显式表达式。\n2) 找出常数系数 $\\alpha$ 和 $\\beta$，使得伊藤诠释预测长期稳定到 $0$（负增长率），而斯特拉托诺维奇诠释预测长期不稳定（正增长率）。使用您推导出的表达式，逻辑地解释您的选择。\n3) 实现两种数值格式来近似样本路径和经验增长率：\n   - 对于伊藤诠释：应用欧拉-丸山（Euler–Maruyama）法于 $dX_t = \\alpha X_t\\,dt + \\beta X_t\\,dW_t$。\n   - 对于斯特拉托诺维奇诠释：应用一种强1阶的斯特拉托诺维奇相容方法，如随机霍恩（Heun）法，于 $dX_t = \\alpha X_t\\,dt + \\beta X_t \\circ dW_t$。\n   使用单条路径（无系综平均），初值 $X_0 = 1$，时间跨度 $T$，以及均匀步长 $\\Delta t$。使用固定的随机种子生成布朗增量 $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ 以确保可复现性。对于每种诠释，计算经验长期增长率 $\\widehat{g} = \\frac{1}{T}\\ln|X_T|$。\n\n4) 使用带有容差 $\\varepsilon$ 的三向决策对每种诠释进行数值稳定性分类：“稳定”如果 $\\widehat{g} < -\\varepsilon$，“不稳定”如果 $\\widehat{g} > \\varepsilon$，“中性”则为其他情况。\n\n5) 将数值分类与您在任务1中推导出的理论分类进行比较，并为每个测试案例返回一个布尔值，表示是否一致。\n\n所有测试案例使用的仿真参数：\n- 初始条件：$X_0 = 1$。\n- 时间跨度：$T = 1000$。\n- 时间步长：$\\Delta t = 10^{-3}$。\n- 分类容差：$\\varepsilon = 2\\times 10^{-2}$。\n- 伪随机数生成器种子：$12345$。\n- 此处不适用角度或物理单位。\n\n测试套件（五个案例），每个以 $(\\alpha,\\beta)$ 形式给出：\n- 案例 A（相反稳定性目标）：$(\\alpha,\\beta) = (0.05, 0.4)$。\n- 案例 B（均为稳定）：$(\\alpha,\\beta) = (-0.05, 0.2)$。\n- 案例 C（均为不稳定）：$(\\alpha,\\beta) = (0.2, 0.1)$。\n- 案例 D（伊藤接近中性边界）：$(\\alpha,\\beta) = (0.08, 0.4)$。\n- 案例 E（斯特拉托诺维奇接近中性边界）：$(\\alpha,\\beta) = (0.0, 0.4)$。\n\n要求的输出：\n- 对于每个案例，使用指定的数值格式计算两种诠释下的经验增长率，用容差 $\\varepsilon$ 对其进行分类，与您在任务1中的理论分类进行比较，并输出表示一致性的布尔值。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[True,False,True,True,False]”）。\n\n关于数值实现的说明：\n- 对于应用于 $dX_t = \\alpha X_t\\,dt + \\beta X_t\\,dW_t$ 的伊藤-欧拉-丸山步，在 $\\Delta t$ 上带有增量 $\\Delta W$ 的单步更新为 $X_{n+1} = X_n + \\alpha X_n \\Delta t + \\beta X_n \\Delta W$。\n- 对于应用于 $dX_t = \\alpha X_t\\,dt + \\beta X_t \\circ dW_t$ 的斯特拉托诺维奇相容的随机霍恩步，首先构建预测值 $X_n^\\ast = X_n + \\alpha X_n \\Delta t + \\beta X_n \\Delta W$，然后 $X_{n+1} = X_n + \\tfrac{1}{2}\\left[\\alpha X_n + \\alpha X_n^\\ast\\right]\\Delta t + \\tfrac{1}{2}\\left[\\beta X_n + \\beta X_n^\\ast\\right]\\Delta W$。\n\n最终输出格式：\n- 单独一行，包含一个Python风格的布尔值列表，严格按照上述五个测试案例的顺序，无空格，例如，“[True,True,False,True,True]”。", "solution": "所提出的问题是随机微积分和随机微分方程（SDE）数值方法中的一个有效练习。它具有科学依据，问题设定良好、客观且完整。所有参数和方法都已指定，从而可以得到唯一且可复现的解。我将着手进行推导和数值验证。\n\n问题的核心是几何布朗运动的随机微分方程：\n$$\ndX_t = \\alpha\\,X_t\\,dt + \\beta\\,X_t\\,\\star\\,dW_t\n$$\n其中 $\\alpha, \\beta \\in \\mathbb{R}$ 是常数系数，$W_t$ 是标准维纳过程，$\\star$ 表示随机积分可以用伊藤（Itô）或斯特拉托诺维奇（Stratonovich）的意义来诠释。我们的任务是证明诠释的选择可以导致对解 $X_t$ 的长期稳定性的不同结论。稳定性通过几乎必然的长期增长率来评估，定义为 $g = \\lim_{T \\to \\infty} \\frac{1}{T}\\ln|X_T|$。\n\n我们将为每种诠释推导增长率，找出使稳定性结论相反的参数，然后数值验证这些理论发现。\n\n**任务1：长期增长率的推导**\n\n为了分析 $X_t$ 的长期行为，我们研究 $Y_t = \\ln(X_t)$ 的动态。由于初始条件为 $X_0 = 1 > 0$ 且SDE是线性的，解 $X_t$ 不会穿过零，因此我们可以使用 $\\ln(X_t)$ 而非 $\\ln|X_t|$。我们对函数 $f(x) = \\ln(x)$（其导数为 $f'(x) = 1/x$ 和 $f''(x) = -1/x^2$）应用相应的链式法则。\n\n**伊藤诠释**\n\nSDE为 $dX_t = \\alpha X_t dt + \\beta X_t dW_t$。我们对 $Y_t = f(X_t)$ 应用伊藤引理：\n$$\ndY_t = f'(X_t)dX_t + \\frac{1}{2}f''(X_t)(dX_t)^2\n$$\n二次变分项 $(dX_t)^2$ 使用乘法规则 $dt \\cdot dt = 0$、$dt \\cdot dW_t = 0$ 和 $dW_t \\cdot dW_t = dt$ 计算。\n$$\n(dX_t)^2 = (\\alpha X_t dt + \\beta X_t dW_t)^2 = \\beta^2 X_t^2 (dW_t)^2 = \\beta^2 X_t^2 dt\n$$\n将导数和 $(dX_t)^2$ 代入引理中：\n$$\ndY_t = \\frac{1}{X_t}(\\alpha X_t dt + \\beta X_t dW_t) + \\frac{1}{2}\\left(-\\frac{1}{X_t^2}\\right)(\\beta^2 X_t^2 dt)\n$$\n$$\ndY_t = (\\alpha dt + \\beta dW_t) - \\frac{1}{2}\\beta^2 dt = \\left(\\alpha - \\frac{1}{2}\\beta^2\\right)dt + \\beta dW_t\n$$\n从 $t=0$ 积分到 $t=T$：\n$$\nY_T - Y_0 = \\int_{0}^{T}\\left(\\alpha - \\frac{1}{2}\\beta^2\\right)ds + \\int_{0}^{T}\\beta dW_s = \\left(\\alpha - \\frac{1}{2}\\beta^2\\right)T + \\beta W_T\n$$\n由于 $X_0 = 1$，我们有 $Y_0 = \\ln(1) = 0$。因此，$\\ln(X_T) = (\\alpha - \\frac{1}{2}\\beta^2)T + \\beta W_T$。几乎必然的长期增长率则为：\n$$\ng_{\\text{Itô}} = \\lim_{T \\to \\infty} \\frac{1}{T}\\ln(X_T) = \\lim_{T \\to \\infty} \\left[ \\left(\\alpha - \\frac{1}{2}\\beta^2\\right) + \\beta \\frac{W_T}{T} \\right]\n$$\n根据重对数律，$\\lim_{T \\to \\infty} W_T/T = 0$ 几乎必然成立。因此，增长率为：\n$$\ng_{\\text{Itô}} = \\alpha - \\frac{1}{2}\\beta^2\n$$\n\n**斯特拉托诺维奇诠释**\n\nSDE为 $dX_t = \\alpha X_t dt + \\beta X_t \\circ dW_t$。斯特拉托诺维奇链式法则具有与普通链式法则相同的形式：$d(f(X_t)) = f'(X_t) \\circ dX_t$。\n将此应用于 $Y_t = \\ln(X_t)$：\n$$\ndY_t = \\frac{1}{X_t} \\circ dX_t = \\frac{1}{X_t} \\circ (\\alpha X_t dt + \\beta X_t \\circ dW_t) = \\alpha dt + \\beta \\circ dW_t\n$$\n从 $t=0$ 积分到 $t=T$：\n$$\nY_T - Y_0 = \\int_{0}^{T} \\alpha ds + \\int_{0}^{T} \\beta \\circ dW_s = \\alpha T + \\beta W_T\n$$\n由于 $Y_0=0$，我们有 $\\ln(X_T) = \\alpha T + \\beta W_T$。增长率为：\n$$\ng_{\\text{Stratonovich}} = \\lim_{T \\to \\infty} \\frac{1}{T}\\ln(X_T) = \\lim_{T \\to \\infty} \\left[ \\alpha + \\beta \\frac{W_T}{T} \\right] = \\alpha\n$$\n这个结果可以通过将斯特拉托诺维奇SDE转换为其等效的伊藤SDE来确认。修正项为 $\\frac{1}{2} b(x) b'(x)$，其中 $b(x) = \\beta x$。这得到 $\\frac{1}{2}(\\beta x)(\\beta) = \\frac{1}{2}\\beta^2 x$。等效的伊藤SDE是 $dX_t = (\\alpha X_t + \\frac{1}{2}\\beta^2 X_t) dt + \\beta X_t dW_t$。此伊藤形式的漂移系数为 $\\alpha' = \\alpha + \\frac{1}{2}\\beta^2$。使用伊藤增长率公式 $g = \\alpha' - \\frac{1}{2}\\beta^2$，我们得到 $g = (\\alpha + \\frac{1}{2}\\beta^2) - \\frac{1}{2}\\beta^2 = \\alpha$，结果一致。\n\n**任务2：相反稳定性参数的确定**\n\n我们寻求参数 $(\\alpha, \\beta)$，使得 $g_{\\text{Itô}}$ 和 $g_{\\text{Stratonovich}}$ 的符号相反，从而导致不同的稳定性结论。我们要求伊藤系统是稳定的（$g < 0$），而斯特拉托诺维奇系统是不稳定的（$g > 0$）。\n1.  斯特拉托诺维奇诠释下的不稳定性：$g_{\\text{Stratonovich}} = \\alpha > 0$。\n2.  伊藤诠释下的稳定性：$g_{\\text{Itô}} = \\alpha - \\frac{1}{2}\\beta^2 < 0$。\n\n这两个条件结合起来得到不等式 $0 < \\alpha < \\frac{1}{2}\\beta^2$。任何满足此条件的 $(\\alpha, \\beta)$ 对都会产生所期望的相反稳定性行为。问题提供了案例 A，其参数为 $(\\alpha, \\beta) = (0.05, 0.4)$。让我们检查这个选择。\n此处，$\\alpha = 0.05$ 且 $\\frac{1}{2}\\beta^2 = \\frac{1}{2}(0.4)^2 = 0.08$。条件 $0 < 0.05 < 0.08$ 得到满足。\n对于这些参数：\n- $g_{\\text{Itô}} = 0.05 - 0.08 = -0.03 < 0$，预测稳定性（$\\lim_{t\\to\\infty}X_t = 0$）。\n- $g_{\\text{Stratonovich}} = 0.05 > 0$，预测不稳定性（$\\lim_{t\\to\\infty}X_t = \\infty$）。\n参数的选择是合乎逻辑的，并正确地展示了这一现象。\n\n**任务3、4和5：数值验证**\n\n我们现在将实现数值格式，并验证给定测试套件的理论分类。实现将使用欧拉-丸山法处理伊藤SDE，使用随机霍恩法处理斯特拉托诺维奇SDE。我们将生成一条维纳过程的路径，并将其用于每个测试用例的两种模拟中，以确保直接比较。数值增长率计算为 $\\widehat{g} = \\frac{1}{T}\\ln|X_T|$。通过将 $\\widehat{g}$ 与容差 $\\varepsilon = 2 \\times 10^{-2}$ 进行比较来对稳定性进行数值分类。数值分类将与使用相同容差 $\\varepsilon$ 从 $g_{\\text{Itô}}$ 和 $g_{\\text{Stratonovich}}$ 公式推导出的理论分类进行比较。每个案例的最终输出是一个布尔值，当且仅当两种数值分类都与它们对应的理论分类相匹配时，该值为`True`。\n\n五个测试案例的理论分类如下，使用规则：“稳定”如果 $g < -0.02$，“不稳定”如果 $g > 0.02$，“中性”则为其他情况。\n\n- **案例 A** $(\\alpha, \\beta) = (0.05, 0.4)$:\n  $g_{\\text{Itô}} = -0.03$（稳定），$g_{\\text{Stratonovich}} = 0.05$（不稳定）。\n- **案例 B** $(\\alpha, \\beta) = (-0.05, 0.2)$:\n  $g_{\\text{Itô}} = -0.05 - 0.5(0.2)^2 = -0.07$（稳定），$g_{\\text{Stratonovich}} = -0.05$（稳定）。\n- **案例 C** $(\\alpha, \\beta) = (0.2, 0.1)$:\n  $g_{\\text{Itô}} = 0.2 - 0.5(0.1)^2 = 0.195$（不稳定），$g_{\\text{Stratonovich}} = 0.2$（不稳定）。\n- **案例 D** $(\\alpha, \\beta) = (0.08, 0.4)$:\n  $g_{\\text{Itô}} = 0.08 - 0.5(0.4)^2 = 0.0$（中性），$g_{\\text{Stratonovich}} = 0.08$（不稳定）。\n- **案例 E** $(\\alpha, \\beta) = (0.0, 0.4)$:\n  $g_{\\text{Itô}} = 0.0 - 0.5(0.4)^2 = -0.08$（稳定），$g_{\\text{Stratonovich}} = 0.0$（中性）。\n\n最终答案中的代码将执行仿真和比较。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of a linear SDE under Itô and Stratonovich\n    interpretations, comparing theoretical predictions with numerical simulations.\n    \"\"\"\n\n    # --- Simulation Parameters ---\n    X0 = 1.0\n    T = 1000.0\n    dt = 1e-3\n    epsilon = 2e-2\n    seed = 12345\n\n    # --- Test Cases ---\n    test_cases = [\n        (0.05, 0.4),   # Case A\n        (-0.05, 0.2),  # Case B\n        (0.2, 0.1),    # Case C\n        (0.08, 0.4),   # Case D\n        (0.0, 0.4),    # Case E\n    ]\n\n    # --- Generate Wiener Path ---\n    # The same path is used for all test cases and both interpretations\n    # to ensure consistency and reproducibility.\n    num_steps = int(T / dt)\n    rng = np.random.default_rng(seed)\n    dW = rng.normal(0.0, np.sqrt(dt), num_steps)\n\n    def classify_stability(g, eps):\n        \"\"\"Classifies stability based on growth rate g and tolerance eps.\"\"\"\n        if g < -eps:\n            return \"stable\"\n        if g > eps:\n            return \"unstable\"\n        return \"neutral\"\n\n    results = []\n    for alpha, beta in test_cases:\n        # --- 1. Theoretical Classification ---\n        g_ito_theo = alpha - 0.5 * beta**2\n        g_strato_theo = alpha\n\n        theo_class_ito = classify_stability(g_ito_theo, epsilon)\n        theo_class_strato = classify_stability(g_strato_theo, epsilon)\n\n        # --- 2. Numerical Simulation: Itô (Euler-Maruyama) ---\n        x_ito = X0\n        for i in range(num_steps):\n            x_ito = x_ito * (1.0 + alpha * dt + beta * dW[i])\n\n        # Compute and classify empirical growth rate\n        g_ito_num = np.log(np.abs(x_ito)) / T if x_ito != 0 else -np.inf\n        num_class_ito = classify_stability(g_ito_num, epsilon)\n\n        # --- 3. Numerical Simulation: Stratonovich (Heun) ---\n        x_strato = X0\n        for i in range(num_steps):\n            # Predictor step\n            x_pred = x_strato * (1.0 + alpha * dt + beta * dW[i])\n            # Corrector step\n            x_strato = x_strato \\\n                + 0.5 * (alpha * x_strato + alpha * x_pred) * dt \\\n                + 0.5 * (beta * x_strato + beta * x_pred) * dW[i]\n\n        # Compute and classify empirical growth rate\n        g_strato_num = np.log(np.abs(x_strato)) / T if x_strato != 0 else -np.inf\n        num_class_strato = classify_stability(g_strato_num, epsilon)\n\n        # --- 4. Comparison ---\n        # Agreement is True if both numerical classifications match their\n        # theoretical counterparts.\n        agreement = (theo_class_ito == num_class_ito) and \\\n                    (theo_class_strato == num_class_strato)\n        results.append(agreement)\n\n    # --- Final Output ---\n    # Must be a single line with a list of booleans, as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"}]}