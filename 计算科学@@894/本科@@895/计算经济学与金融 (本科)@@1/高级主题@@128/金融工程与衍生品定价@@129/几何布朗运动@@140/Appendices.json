{"hands_on_practices": [{"introduction": "实践几何布朗运动 (GBM) 的第一步是掌握其基本解。这个练习将引导你推导出用于蒙特卡洛模拟的核心公式，该公式能让你从初始价格 $S_0$ 直接计算出未来某一时刻的价格 $S_T$，而无需模拟整个中间路径。这个技巧是提高计算效率和进行金融分析的基石。[@problem_id:1304946]", "id": "1304946", "problem": "一位量化分析师正在为一只不支付股息的股票建立一个蒙特卡洛模拟模型。该股票的价格 $S_t$ 假设遵循几何布朗运动 (GBM)，这是一个由以下随机微分方程所描述的随机过程：\n$$dS_t = \\mu S_t dt + \\sigma S_t dW_t$$\n其中 $S_t$ 是 $t$ 时刻的股票价格，$\\mu$ 是恒定漂移率（预期收益率），$\\sigma$ 是恒定波动率，而 $W_t$ 是一个标准维纳过程。\n\n为了提高计算效率，该分析师希望直接从初始价格 $S_0$ 模拟未来某个时间 $T > 0$ 的股票价格 $S_T$，而不是模拟从 $t=0$ 到 $t=T$ 的整个价格路径。该方法包括从一个标准正态分布 $N(0,1)$ 中生成一个随机数 $Z$，并将其用于 $S_T$ 的一个闭式表达式中。\n\n给定初始股价 $S_0$、漂移率 $\\mu$、波动率 $\\sigma$、时间范围 $T$ 以及一个标准正态随机变量 $Z$，请确定最终股价 $S_T$ 的正确表达式。", "solution": "我们从股票价格 $S_t$ 的几何布朗运动随机微分方程开始：\n$$\ndS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t.\n$$\n对 $X_t=\\ln S_t$ 应用 It\\^{o} 引理。对于 $f(x)=\\ln x$，我们有 $f'(x)=\\frac{1}{x}$ 和 $f''(x)=-\\frac{1}{x^{2}}$。It\\^{o} 引理给出\n$$\nd\\ln S_t=\\frac{1}{S_t}\\,dS_t+\\frac{1}{2}\\left(-\\frac{1}{S_t^{2}}\\right)(dS_t)^{2}.\n$$\n代入 $dS_t=\\mu S_t\\,dt+\\sigma S_t\\,dW_t$ 并利用 $(dW_t)^{2}=dt$ 可得\n$$\n(dS_t)^{2}=\\sigma^{2}S_t^{2}(dW_t)^{2}=\\sigma^{2}S_t^{2}\\,dt,\n$$\n所以\n$$\nd\\ln S_t=\\frac{1}{S_t}(\\mu S_t\\,dt+\\sigma S_t\\,dW_t)-\\frac{1}{2}\\frac{1}{S_t^{2}}(\\sigma^{2}S_t^{2}\\,dt)\n=(\\mu-\\tfrac{1}{2}\\sigma^{2})\\,dt+\\sigma\\,dW_t.\n$$\n从 $0$ 到 $T$ 积分得到\n$$\n\\ln S_T-\\ln S_0=(\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma(W_T-W_0).\n$$\n由于 $W_0=0$ 且 $W_T\\sim \\sqrt{T}\\,Z$ 其中 $Z\\sim \\mathcal{N}(0,1)$，上式变为\n$$\n\\ln S_T=\\ln S_0+(\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma\\sqrt{T}\\,Z.\n$$\n取指数可得终端价格的直接模拟公式：\n$$\nS_T=S_0\\,\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma\\sqrt{T}\\,Z\\right).\n$$", "answer": "$$\\boxed{S_0\\,\\exp\\!\\left((\\mu-\\tfrac{1}{2}\\sigma^{2})T+\\sigma\\sqrt{T}\\,Z\\right)}$$"}, {"introduction": "掌握了资产价格的显式解之后，我们就可以开始回答关于其未来行为的概率性问题。在这个实践中，你将计算一项资产在给定时间段内价格低于其初始值的概率。这个练习将抽象的GBM模型与具体的风险评估联系起来，让你体会到该模型在实际金融分析中的应用价值。[@problem_id:1304937]", "id": "1304937", "problem": "一位金融分析师使用几何布朗运动（GBM）模型来模拟一种波动性数字资产的价格 $S_t$。在时间 $t$（以年为单位）的价格由以下公式给出：\n$$S_t = S_0 \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2\\right)t + \\sigma W_t \\right)$$\n其中 $S_0$ 是初始价格，$\\mu$ 是恒定的预期年回报率（漂移项），$\\sigma$ 是恒定的年波动率，而 $W_t$ 是一个标准维纳过程。对于一个标准维纳过程，其在时间 $t$ 的值 $W_t$ 服从均值为 0、方差为 $t$ 的正态分布。\n\n该资产的特征是预期年回报率 $\\mu = 0.20$，年波动率 $\\sigma = 0.40$。\n\n在 $T = 1.5$ 年后，该资产的价格 $S_T$ 低于其初始价格 $S_0$ 的概率是多少？请以小数形式计算此概率。将最终答案四舍五入到四位有效数字。", "solution": "我们想要求在GBM模型下 $S_{T}<S_{0}$ 的概率\n$$\nS_{t}=S_{0}\\exp\\left(\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)t+\\sigma W_{t}\\right).\n$$\n取自然对数并减去 $\\ln S_{0}$，得到对数回报率\n$$\nY:=\\ln\\left(\\frac{S_{T}}{S_{0}}\\right)=\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)T+\\sigma W_{T}.\n$$\n由于 $W_{T}\\sim \\mathcal{N}(0,T)$，因此 $Y\\sim \\mathcal{N}(m,s^{2})$，其中\n$$\nm=\\left(\\mu-\\frac{1}{2}\\sigma^{2}\\right)T,\\qquad s=\\sigma\\sqrt{T}.\n$$\n因此，\n$$\n\\mathbb{P}(S_{T}<S_{0})=\\mathbb{P}\\!\\left(\\ln\\!\\left(\\frac{S_{T}}{S_{0}}\\right)<0\\right)=\\mathbb{P}(Y<0)=\\mathbb{P}\\!\\left(\\frac{Y-m}{s}<-\\frac{m}{s}\\right)=\\Phi\\!\\left(-\\frac{m}{s}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。\n\n代入 $\\mu=\\frac{1}{5}$，$\\sigma=\\frac{2}{5}$ 以及 $T=\\frac{3}{2}$，我们计算\n$$\nm=\\left(\\frac{1}{5}-\\frac{1}{2}\\cdot\\frac{4}{25}\\right)\\cdot\\frac{3}{2}=\\left(\\frac{1}{5}-\\frac{2}{25}\\right)\\cdot\\frac{3}{2}=\\frac{3}{25}\\cdot\\frac{3}{2}=\\frac{9}{50},\n$$\n$$\ns=\\sigma\\sqrt{T}=\\frac{2}{5}\\sqrt{\\frac{3}{2}}=\\frac{2\\sqrt{3}}{5\\sqrt{2}}.\n$$\n因此\n$$\n-\\frac{m}{s}=-\\frac{\\frac{9}{50}}{\\frac{2\\sqrt{3}}{5\\sqrt{2}}}=-\\frac{9\\sqrt{2}}{20\\sqrt{3}}=-\\frac{3\\sqrt{6}}{20},\n$$\n所以\n$$\n\\mathbb{P}(S_{T}<S_{0})=\\Phi\\!\\left(-\\frac{3\\sqrt{6}}{20}\\right)=\\frac{1}{2}\\left[1-\\operatorname{erf}\\!\\left(\\frac{3\\sqrt{3}}{20}\\right)\\right].\n$$\n数值上，这约等于 $0.3566515868$，保留四位有效数字为 $0.3567$。", "answer": "$$\\boxed{0.3567}$$"}, {"introduction": "在金融建模中，一个至关重要的概念是区分“真实世界”概率测度 (real-world measure) $\\mathbb{P}$ 和“风险中性”概率测度 (risk-neutral measure) $\\mathbb{Q}$。这项高阶练习旨在挑战你辨析这两种框架在资产价格预测与衍生品无套利定价中的不同应用。正确地运用漂移率——是真实世界期望收益率 $\\mu$ 还是无风险利率 $r$——是量化金融和计算经济学的核心技能。[@problem_id:2397890]", "id": "2397890", "problem": "考虑一个无套利、无摩擦的市场，其无风险利率 $r$ 为常数。假设标的资产价格 $(S_t)_{t \\in [0,T]}$ 在物理（真实世界）概率测度 $\\mathbb{P}$ 下遵循几何布朗运动（GBM），其动态过程为\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}},\n$$\n其中 $\\mu$ 是真实世界漂移率，$\\sigma > 0$ 是波动率，$(W_t^{\\mathbb{P}})_{t \\ge 0}$ 是在 $\\mathbb{P}$ 下的标准布朗运动。在与 $r$ 关联的风险中性测度 $\\mathbb{Q}$ 下，其动态过程为\n$$\n\\mathrm{d}S_t = r S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{Q}},\n$$\n其中 $\\sigma$ 相同，且 $(W_t^{\\mathbb{Q}})_{t \\ge 0}$ 是在 $\\mathbb{Q}$ 下的标准布朗运动。设给定的 $S_0 > 0$。\n\n考虑两个不同的计算任务：\n(i) 计算一个到期日为 $T$、执行价格为 $K > 0$ 的欧式看涨期权在时间 $0$ 的无套利价格，其支付为 $h(S_T) = \\max(S_T - K, 0)$，以及\n(ii) 预测作为真实世界统计目标的预期未来价格 $\\mathbb{E}^{\\mathbb{P}}[S_T]$。\n\n假设可以从 $\\mathbb{P}$-动态过程或 $\\mathbb{Q}$-动态过程模拟出 $S_T$ 在时间 $T$ 的精确样本，并且可以按利率 $r$ 进行数值贴现。\n\n选择所有正确的陈述。\n\nA. 对于任务 (i)，在风险中性漂移率 $r$ 下模拟 $S_T$ 并使用 $h(S_T)$ 的贴现后样本均值，当蒙特卡洛（MC）路径数增加时，该值会收敛到正确的无套利价格。\n\nB. 对于任务 (ii)，使用漂移率 $r$ 进行模拟适用于预测 $\\mathbb{E}^{\\mathbb{P}}[S_T]$，因为市场价格隐含了风险中性。\n\nC. 如果简单地在真实世界漂移率 $\\mu$ 下进行模拟，并以利率 $r$ 进行贴现来为欧式看涨期权定价，除非 $\\mu = r$，否则结果通常与正确的无套利价格不同。\n\nD. 在风险中性测度 $\\mathbb{Q}$ 下，贴现后的资产 $e^{-rt} S_t$ 是一个鞅；在真实世界测度 $\\mathbb{P}$ 下，当 $\\mu \\neq r$ 时，$e^{-rt} S_t$ 通常不是一个鞅。\n\nE. 在 $\\mathbb{Q}$ 下用于定价的波动率参数必须是一个独特的“风险中性波动率”，即使当 $\\sigma$ 为常数时，它也不同于真实世界的 $\\sigma$。", "solution": "我们从几何布朗运动（GBM）模型的基本原理和资产定价基本定理出发。\n\n在 $\\mathbb{P}$ 下，GBM 满足\n$$\n\\mathrm{d}S_t = \\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}},\n$$\n其精确解为\n$$\nS_T = S_0 \\exp\\!\\Big( \\big(\\mu - \\tfrac{1}{2}\\sigma^2\\big) T + \\sigma W_T^{\\mathbb{P}} \\Big).\n$$\n因此，\n$$\n\\mathbb{E}^{\\mathbb{P}}[S_T] = S_0 e^{\\mu T}.\n$$\n在 $\\mathbb{Q}$ 下，GBM 满足\n$$\n\\mathrm{d}S_t = r S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{Q}},\n$$\n其解为\n$$\nS_T = S_0 \\exp\\!\\Big( \\big(r - \\tfrac{1}{2}\\sigma^2\\big) T + \\sigma W_T^{\\mathbb{Q}} \\Big),\n$$\n所以\n$$\n\\mathbb{E}^{\\mathbb{Q}}[S_T] = S_0 e^{r T}.\n$$\n\n根据在这个具有恒定利率 $r$ 的完备、无套利环境中的资产定价基本定理，一个支付为 $h(S_T)$ 的或有债权在时间 $0$ 的无套利价格 $V_0$ 等于\n$$\nV_0 = \\mathbb{E}^{\\mathbb{Q}}\\!\\big[ e^{-rT} h(S_T) \\big].\n$$\n\n我们现在评估每个陈述。\n\nA. 对于任务 (i)，风险中性定价需要计算 $\\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} h(S_T) ]$。如果我们在 $\\mathbb{Q}$-动态过程下模拟 $S_T$ 并计算 $e^{-rT} h(S_T)$ 的样本均值，根据大数定律，随着路径数量的增加，MC 估计量会收敛到 $\\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} h(S_T) ]$（假设在 GBM 下可以对 $S_T$ 进行精确抽样）。因此，该估计量收敛到正确的无套利价格。结论：正确。\n\nB. 对于任务 (ii)，目标是真实世界期望 $\\mathbb{E}^{\\mathbb{P}}[S_T] = S_0 e^{\\mu T}$。使用漂移率 $r$ 进行模拟会得到 $\\mathbb{E}^{\\mathbb{Q}}[S_T] = S_0 e^{rT}$，除非 $\\mu = r$，否则这通常与真实世界期望不同。市场价格隐含风险中性这一点适用于定价，而不适用于真实世界的统计预测。结论：不正确。\n\nC. 如果在 $\\mathbb{P}$ 下使用漂移率 $\\mu$ 进行模拟，并简单地以 $r$ 进行贴现，估计值会收敛到 $\\mathbb{E}^{\\mathbb{P}}[ e^{-rT} h(S_T) ]$，而不是 $\\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} h(S_T) ]$。通常这两者是不同的，因为当 $\\mu \\neq r$ 时，$S_T$ 在 $\\mathbb{P}$ 和 $\\mathbb{Q}$ 下的分布是不同的。例如，即使对于线性支付 $h(S_T) = S_T$，我们有\n$$\n\\mathbb{E}^{\\mathbb{P}}[ e^{-rT} S_T ] = e^{-rT} S_0 e^{\\mu T} \\neq S_0 = \\mathbb{E}^{\\mathbb{Q}}[ e^{-rT} S_T ]\n$$\n除非 $\\mu = r$。因此，没有明确的测度转换调整，简单的 $\\mathbb{P}$-模拟加贴现通常是不正确的。结论：正确。\n\nD. 考虑贴现过程 $X_t := e^{-rt} S_t$。在 $\\mathbb{Q}$ 下，应用 Itô 引理可得\n$$\n\\mathrm{d}X_t = \\mathrm{d}(e^{-rt} S_t) = e^{-rt}(-r S_t \\,\\mathrm{d}t) + e^{-rt} \\,\\mathrm{d}S_t = e^{-rt}\\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{Q}},\n$$\n其漂移项为零，因此 $(X_t)_{t \\ge 0}$ 是一个 $\\mathbb{Q}$-鞅。在 $\\mathbb{P}$ 下，\n$$\n\\mathrm{d}X_t = e^{-rt}(-r S_t \\,\\mathrm{d}t) + e^{-rt}(\\mu S_t \\,\\mathrm{d}t + \\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}}) = e^{-rt}(\\mu - r) S_t \\,\\mathrm{d}t + e^{-rt}\\sigma S_t \\,\\mathrm{d}W_t^{\\mathbb{P}},\n$$\n当 $\\mu \\neq r$ 时，其漂移项非零，所以它通常不是一个 $\\mathbb{P}$-鞅。结论：正确。\n\nE. 在 GBM 模型中，Girsanov 定理改变了漂移率，但保留了扩散系数；波动率参数 $\\sigma$ 在 $\\mathbb{P}$ 和 $\\mathbb{Q}$ 下是相同的。尽管从期权价格中推断出的市场隐含波动率可能与历史估计值不同，但在该模型内部，进入 $\\mathbb{P}$- 和 $\\mathbb{Q}$-动态过程的瞬时波动率是同一个常数 $\\sigma$。结论：不正确。\n\n因此，正确的陈述是 A、C 和 D。", "answer": "$$\\boxed{ACD}$$"}]}