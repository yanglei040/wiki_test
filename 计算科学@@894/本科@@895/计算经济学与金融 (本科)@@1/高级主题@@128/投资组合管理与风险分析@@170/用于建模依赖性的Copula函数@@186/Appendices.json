{"hands_on_practices": [{"introduction": "在金融和经济学中，皮尔逊相关系数是衡量两个变量之间线性关系的常用工具。然而，当依赖关系不是线性时，它可能会产生误导。本练习将通过一个经典的例子，展示两个完全依赖的变量如何可能具有零相关性，从而强调了使用 Copula 来捕捉更复杂、非单调依赖结构的必要性。[@problem_id:1353856]", "id": "1353856", "problem": "一个随机变量 $X$ 服从区间 $[-1, 1]$ 上的连续均匀分布。第二个随机变量 $Y$ 由关系式 $Y = X^2$ 定义。您的任务是分析 $X$ 和 $Y$ 之间的依赖关系。\n\n1. 计算皮尔逊相关系数 $\\rho(X, Y)$。\n2. 变量 $X$ 和 $Y$ 是完全相关的，但它们的皮尔逊相关系数可能无法完全捕捉这种关系。其完整的依赖结构由它们的 copula 描述。请确定以下哪个描述最能刻画连接 $X$ 和 $Y$ 的 copula。\n\nA. 该 copula 代表完全正单调依赖，其支撑集在单位正方形的主对角线上。\nB. 该 copula 代表完全负单调依赖，其支撑集在单位正方形的反对角线上。\nC. 该 copula 是独立 copula，其概率质量均匀分布在整个单位正方形上。\nD. 该 copula 代表一种非单调依赖，其支撑集集中在单位正方形内的一条 V 形曲线上。\n\n请以一个数对的形式提供您的答案，该数对由相关系数的数值和正确选项对应的字母组成。", "solution": "设 $X$ 在 $[-1,1]$ 上均匀分布，因此其密度函数为 $f_{X}(x)=\\frac{1}{2}$，其中 $x\\in[-1,1]$。定义 $Y=X^{2}$。皮尔逊相关系数为 $\\rho(X,Y)=\\frac{\\operatorname{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Y)}}$。\n\n首先计算必要的矩。由于 $X$ 关于 $0$ 对称，\n$$\n\\mathbb{E}[X]=\\int_{-1}^{1}x\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{2}}{2}\\right]_{-1}^{1}=0.\n$$\n此外，\n$$\n\\mathbb{E}[X^{2}]=\\int_{-1}^{1}x^{2}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{3}}{3}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{3}-\\left(-\\frac{1}{3}\\right)\\right)=\\frac{1}{3},\n$$\n所以 $\\mathbb{E}[Y]=\\mathbb{E}[X^{2}]=\\frac{1}{3}$。接着，\n$$\n\\mathbb{E}[X^{3}]=\\int_{-1}^{1}x^{3}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{4}}{4}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{4}-\\frac{1}{4}\\right)=0,\n$$\n因此 $\\mathbb{E}[XY]=\\mathbb{E}[X^{3}]=0$。所以，\n$$\n\\operatorname{Cov}(X,Y)=\\mathbb{E}[XY]-\\mathbb{E}[X]\\mathbb{E}[Y]=0-0\\cdot\\frac{1}{3}=0.\n$$\n为了完整性，计算方差以确认分母为正。我们有\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{1}{3},\n$$\n并且\n$$\n\\mathbb{E}[Y^{2}]=\\mathbb{E}[X^{4}]=\\int_{-1}^{1}x^{4}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{5}}{5}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{5}-\\left(-\\frac{1}{5}\\right)\\right)=\\frac{1}{5},\n$$\n所以\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-(\\mathbb{E}[Y])^{2}=\\frac{1}{5}-\\left(\\frac{1}{3}\\right)^{2}=\\frac{1}{5}-\\frac{1}{9}=\\frac{4}{45}>0.\n$$\n因此，\n$$\n\\rho(X,Y)=\\frac{0}{\\sqrt{\\frac{1}{3}\\cdot\\frac{4}{45}}}=0.\n$$\n\n尽管 $Y$ 是 $X$ 的一个确定性函数，它们是完全相关的，但这种依赖关系在 $[-1,1]$ 上是非单调的，所以皮尔逊相关系数为零。为了确定 copula，我们考虑概率积分变换 $U=F_{X}(X)$ 和 $V=F_{Y}(Y)$。对于 $x\\in[-1,1]$，\n$$\nF_{X}(x)=\\frac{x+1}{2},\\quad\\text{所以}\\quad U=\\frac{X+1}{2}.\n$$\n对于 $y\\in[0,1]$，\n$$\nF_{Y}(y)=\\mathbb{P}(X^{2}\\le y)=\\mathbb{P}(-\\sqrt{y}\\le X\\le \\sqrt{y})=\\int_{-\\sqrt{y}}^{\\sqrt{y}}\\frac{1}{2}\\,dx=\\sqrt{y},\n$$\n因此\n$$\nV=F_{Y}(Y)=\\sqrt{Y}=\\sqrt{X^{2}}=|X|.\n$$\n通过 $U$ 表达 $X$ 得到 $X=2U-1$，所以这两个均匀变量之间的关系是\n$$\nV=|X|=|2U-1|.\n$$\n因此，该 copula 是奇异的，其支撑集集中在单位正方形内的 V 形曲线 $v=|2u-1|$ 上。这是一种非单调依赖，对应于选项 D。", "answer": "$$\\boxed{\\begin{pmatrix} 0 & D \\end{pmatrix}}$$"}, {"introduction": "选择正确的模型是应用统计分析的关键一步。在 Copula 建模中，一个核心区别在于不同 Copula 族刻画尾部依赖性的方式——即极端事件同时发生的可能性。本练习模拟了一个真实世界的水文学场景，要求你根据数据的非对称依赖特征（例如，洪水期比干旱期有更强的联动性）来选择合适的 Copula 模型，这是风险管理等领域一项至关重要的实践技能。[@problem_id:1353897]", "id": "1353897", "problem": "一位水文学家正在分析两条相邻河流（A河与B河）每日流量之间的相关性。他们收集了大量的配对测量数据集。作为copula建模中的一个标准程序，他们将每条河流流量的经验边际分布转换为标准均匀分布随机变量，记为 $U_A$ 和 $U_B$。\n\n通过查看转换后数据对 $(U_A, U_B)$ 的散点图，该水文学家观察到其相关性结构存在明显的不对称性。具体来说，数据点在单位正方形的右上角（即当 $U_A$ 和 $U_B$ 都接近1时）显示出显著的聚集现象，这表明同时发生的重大洪水事件是密切相关的。相反，在左下角（即当 $U_A$ 和 $U_B$ 都接近0时）几乎没有聚集现象，这表明两条河流的极端低流量时期（干旱）的相关性不那么强。\n\n该水文学家决定使用单参数Archimedean copula来对这种相关性进行建模，并将选择范围缩小到两种常见的模型：Clayton copula和Gumbel copula。\n\n根据所描述的数据特征，以下哪个陈述正确地指出了更合适的copula及其适用的原因？\n\nA. Clayton copula，因为它专门用于建模联合分布的上尾强相关性。\nB. Clayton copula，因为它专门用于建模联合分布的下尾强相关性。\nC. Gumbel copula，因为它专门用于建模联合分布的上尾强相关性。\nD. Gumbel copula，因为它专门用于建模联合分布的下尾强相关性。\nE. Clayton copula和Gumbel copula都同样适用，因为在相同的整体相关水平下，它们的尾部相关性属性是相同的。", "solution": "水文学家已将流量转换为标准均匀分布变量 $U_{A}$ 和 $U_{B}$，并观察到当两个变量都接近 $1$ 时（右上角）有强聚集现象，而当两个变量都接近 $0$ 时（左下角）聚集现象非常弱。用copula的术语来说，这表明存在强的上尾相关性和弱的（近似为零的）下尾相关性。\n\n尾部相关性由以下系数来量化：\n$$\n\\lambda_{U}=\\lim_{u\\to 1^{-}} \\mathbb{P}\\left(U_{B}>u \\mid U_{A}>u\\right)=\\lim_{u\\to 1^{-}} \\frac{1-2u+C(u,u)}{1-u},\n$$\n$$\n\\lambda_{L}=\\lim_{u\\to 0^{+}} \\mathbb{P}\\left(U_{B}\\leq u \\mid U_{A}\\leq u\\right)=\\lim_{u\\to 0^{+}} \\frac{C(u,u)}{u},\n$$\n其中 $C$ 是copula。\n\n对于候选的单参数Archimedean copula：\n- Clayton copula（参数 $\\theta>0$）具有下尾相关性，但没有上尾相关性：\n$$\n\\lambda_{L}=2^{-1/\\theta}>0,\\quad \\lambda_{U}=0.\n$$\n- Gumbel copula（参数 $\\theta\\geq 1$）具有上尾相关性，但没有下尾相关性：\n$$\n\\lambda_{U}=2-2^{1/\\theta}>0\\ \\text{for}\\ \\theta>1,\\quad \\lambda_{L}=0.\n$$\n\n由于数据显示出强的上尾相关性和弱的下尾相关性，因此合适的选择是 Gumbel copula，其定义特征与观察到的不对称性相匹配。因此，正确的陈述是 Gumbel copula 是合适的，因为它被设计用于建模上尾的强相关性。", "answer": "$$\\boxed{C}$$"}, {"introduction": "Copula 函数 $C(u,v)$ 本身是一个累积分布函数 (CDF)，它给出了变量小于特定阈值的概率。然而，在许多应用中，例如使用最大似然法进行参数估计时，我们需要的是联合概率密度函数 (PDF)，即 $c(u,v)$。本练习将指导你完成从 Copula CDF 推导其对应密度函数的关键数学步骤，这是掌握和应用 Copula 模型的 foundational skill。[@problem_id:1353902]", "id": "1353902", "problem": "在统计建模中，copula是一种多元累积分布函数，其各变量的边际概率分布均为区间 $[0, 1]$ 上的均匀分布。Farlie-Gumbel-Morgenstern (FGM) 族是用于建模两个随机变量之间相依性的最简单的copula族之一。\n\n一个二元FGM copula的累积分布函数由下式给出：\n$$C(u,v) = uv[1+\\alpha(1-u)(1-v)]$$\n其中 $u, v \\in [0, 1]$，相依参数 $\\alpha$ 是一个满足 $|\\alpha| \\le 1$ 的实常数。\n\ncopula密度函数记为 $c(u,v)$，描述了一个特定值对 $(u,v)$ 的相对可能性。请找出FGM copula所对应的copula密度函数 $c(u,v)$ 的解析表达式。", "solution": "copula密度函数是copula分布函数的混合二阶偏导数：\n$$c(u,v)=\\frac{\\partial^{2}}{\\partial u \\partial v}C(u,v).$$\n给定 $C(u,v)=uv\\left[1+\\alpha(1-u)(1-v)\\right]$，首先使用乘法法则计算其关于 $u$ 的偏导数：\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]+uv\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right].$$\n内部的导数是\n$$\\frac{\\partial}{\\partial u}\\left[1+\\alpha(1-u)(1-v)\\right]=\\alpha\\frac{\\partial}{\\partial u}\\left[(1-u)(1-v)\\right]=-\\alpha(1-v).$$\n因此，\n$$\\frac{\\partial C}{\\partial u}=v\\left[1+\\alpha(1-u)(1-v)\\right]-\\alpha uv(1-v).$$\n因式分解并化简：\n$$\\frac{\\partial C}{\\partial u}=v+\\alpha v(1-v)(1-2u).$$\n现在对 $v$ 求导：\n$$c(u,v)=\\frac{\\partial}{\\partial v}\\left[v+\\alpha v(1-v)(1-2u)\\right]=1+\\alpha(1-2u)\\frac{\\partial}{\\partial v}\\left[v-v^{2}\\right].$$\n由于 $\\frac{\\partial}{\\partial v}(v-v^{2})=1-2v$，我们得到\n$$c(u,v)=1+\\alpha(1-2u)(1-2v).$$", "answer": "$$\\boxed{1+\\alpha(1-2u)(1-2v)}$$"}]}