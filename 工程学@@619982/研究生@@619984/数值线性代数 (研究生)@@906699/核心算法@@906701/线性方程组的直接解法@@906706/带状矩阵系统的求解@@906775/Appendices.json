{
        "hands_on_practices": [
            {
                "introduction": "高斯消元法（或 $LU$ 分解）是求解线性系统的基石。当应用于带状矩阵时，必须特别注意如何进行主元选择，以便在保持数值稳定性的同时维持计算效率。这项练习 [@problem_id:3578824] 要求你利用一个预先计算好的、带主元选择的 $LU$ 分解来形式化求解过程，并分析主元选择策略本身的计算开销。理解这一点对于为带状系统开发高效且稳健的求解器至关重要。",
                "problem": "设 $n \\in \\mathbb{R}$，且设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个下带宽为 $l$、上带宽为 $u$ 的非奇异带状矩阵，意即当 $i - j > l$ 或 $j - i > u$ 时 $a_{ij} = 0$，其中 $1 \\leq l \\leq n - 1$ 且 $u \\geq 0$。假设执行限制在带内的部分主元选取高斯消去法，过程如下：在第 $k \\in \\{1,2,\\dots,n-1\\}$ 步，主元从第 $k,k+1,\\dots,\\min(n,k+l)$ 行中选取，并且，如有必要，通过行交换将主元行移动到第 $k$ 个位置。假定分解过程成功且没有中断，并得到分解式 $P A = L U$，其中 $P$ 是一个编码了行交换序列的置换矩阵，$L$ 是单位下三角矩阵，$U$ 是上三角矩阵。\n\n你的任务是：\n\n1. 仅使用带状矩阵、置换矩阵和三角矩阵的定义以及 $P A = L U$ 这一性质，推导出一个正确且完整的流程，以求解线性系统 $A x = b$ 的解 $x \\in \\mathbb{R}^{n}$（对于给定的右端项 (RHS) $b \\in \\mathbb{R}^{n}$），该流程在求解过程中需保持带状结构。论证为何这些步骤能产生精确解。\n\n2. 在一种悲观情景下，即在每个消元步 $k \\in \\{1,2,\\dots,n-1\\}$，所选主元都恰好位于允许窗口中的第 $\\min(n,k+l)$ 行。假设每次行交换 $k \\leftrightarrow p$（其中 $p > k$）都是通过一系列相邻行的对换来实现的，以保持带状结构的存储局部性。推导以下量的闭式解析表达式：\n   - 逻辑行交换的总次数（即主元行与当前行不同的消元步数），以及\n   - 在整个分解过程中实际执行的相邻行对换的总次数，\n作为 $n$ 和 $l$ 的函数。\n\n将你的最终答案表示为由这两个量组成的有序对。无需四舍五入。无需单位。",
                "solution": "将通过首先提取所有给定信息，然后对照有效科学问题的既定标准进行检查来验证该问题。\n\n### 第1步：提取给定信息\n- $A \\in \\mathbb{R}^{n \\times n}$ 是一个非奇异带状矩阵。\n- $n \\in \\mathbb{N}$。\n- 下带宽为 $l$，其中 $1 \\leq l \\leq n - 1$。\n- 上带宽为 $u$，其中 $u \\geq 0$。\n- 带状结构定义为：当 $i - j > l$ 或 $j - i > u$ 时，$a_{ij} = 0$。\n- 执行带限制的部分主元选取高斯消去法。\n- 在第 $k \\in \\{1, 2, \\dots, n-1\\}$ 步，主元从第 $k, k+1, \\dots, \\min(n, k+l)$ 行中选取。\n- 分解 $P A = L U$ 成功计算得出，其中 $P$ 是置换矩阵，$L$ 是单位下三角矩阵，$U$ 是上三角矩阵。\n- 对于第2部分，假设一个悲观情景：在每一步 $k$，主元都从第 $\\min(n, k+l)$ 行选取。\n- 对于第2部分，行交换 $k \\leftrightarrow p$ (其中 $p > k$) 是通过一系列相邻对换来实现的。\n\n### 第2步：使用提取的信息进行验证\n该问题根据以下标准进行评估：\n\n- **科学基础**：该问题牢固地建立在数值线性代数领域。带状矩阵、LU分解和主元选取策略是该领域的基本概念。前提条件在事实上是合理的，并基于既定的数学原理。\n- **适定的**：问题结构清晰。第1部分要求给出一个标准流程（在给定LU分解的情况下求解方程组）并附上论证。第2部分要求在一组明确定义的假设下计算特定量。对 $n$ 和 $l$ 的约束确保了计算是明确定义的。两部分都存在唯一且有意义的解。\n- **客观的**：问题以精确、形式化的数学语言陈述，没有歧义或主观看法。\n\n该问题没有表现出任何无效性缺陷：\n1.  **科学或事实不成立**：没有违反数学逻辑或科学原理的情况。\n2.  **无法形式化或不相关**：该问题可直接形式化，并且是其指定主题的核心。\n3.  **不完整或矛盾的设置**：设置是完整的且自洽的。条件 $1 \\leq l \\leq n-1$至关重要且已正确指定。\n4.  **不切实际或不可行**：条件在数学上和算法上都是现实的。\n5.  **不适定或结构不良**：问题是适定的。\n6.  **伪深刻、琐碎或同义反复**：该问题需要实质性的推理，特别是第2部分的推导。\n7.  **超出科学可验证性**：结果在数学上是可推导和可验证的。\n\n### 第3步：结论与行动\n问题是**有效的**。将提供一个完整的解答。\n\n---\n\n### 第1部分：求解 $A x = b$ 的流程\n给定线性系统 $A x = b$ 和分解 $P A = L U$。\n\n1.  **初始变换**：由于置换矩阵 $P$ 是可逆的（其逆为 $P^{-1} = P^T$），原始方程 $A x = b$ 等价于左乘 $P$ 后的系统 $P A x = P b$。向量 $P b$ 是通过对向量 $b$ 应用在分解过程中对矩阵 $A$ 执行的相同行交换序列得到的。这些交换由主元选取策略决定，并被编码在矩阵 $P$ 中。\n\n2.  **代入**：将分解式 $P A = L U$ 代入变换后的系统：\n    $$L U x = P b$$\n    这个方程可以通过引入一个中间向量 $y \\in \\mathbb{R}^n$ 分两个阶段求解。\n\n3.  **两阶段求解**：令 $y = U x$。系统变成两个独立的、更简单的系统：\n    - 阶段1：$L y = P b$\n    - 阶段2：$U x = y$\n\n4.  **阶段1：向前回代**：\n    求解第一个系统 $L y = P b$ 以得到 $y$。令 $b' = P b$。由于 $L$ 是一个单位下三角矩阵，该系统可以通过向前回代求解。$y$ 的分量从 $y_1$ 到 $y_n$ 依次计算。\n    $$y_i = b'_i - \\sum_{j=1}^{i-1} l_{ij} y_j$$\n    带主元选取的高斯消去法应用于下带宽为 $l$ 的带状矩阵时，产生的矩阵 $L$ 也具有为 $l$ 的下带宽。也就是说，当 $i - j > l$ 时，$l_{ij} = 0$。此性质使得求和可以被截断，从而保持了带状结构：\n    $$y_i = b'_i - \\sum_{j=\\max(1, i-l)}^{i-1} l_{ij} y_j \\quad \\text{for } i = 1, 2, \\dots, n$$\n    （对于 $i=1$，求和为空，因此 $y_1 = b'_1$。）\n\n5.  **阶段2：向后回代**：\n    求解第二个系统 $U x = y$ 以得到最终解 $x$。由于 $U$ 是一个上三角矩阵，该系统通过向后回代求解。$x$ 的分量以逆序计算，从 $x_n$ 到 $x_1$。\n    $$x_i = \\frac{1}{u_{ii}} \\left( y_i - \\sum_{j=i+1}^{n} u_{ij} x_j \\right)$$\n    主元选取策略可能会增加矩阵的上带宽。如果在第 $k$ 步，第 $k$ 行与第 $k+d$ 行（其中 $d \\leq l$）交换，那么第 $k+d$ 行的元素会被带入第 $k$ 行。原始的第 $k+d$ 行的非零元素最多延伸到第 $(k+d)+u$ 列。因此，新的第 $k$ 行的非零元素也可能延伸到这一列。这意味着 $U$ 的上带宽，我们称之为 $u'$，最大可能为 $u+l$。考虑到这种带状结构，向后回代公式变为：\n    $$x_i = \\frac{1}{u_{ii}} \\left( y_i - \\sum_{j=i+1}^{\\min(n, i+u')} u_{ij} x_j \\right) \\quad \\text{for } i = n, n-1, \\dots, 1$$\n    （对于 $i=n$，求和为空，因此 $x_n = y_n/u_{nn}$。）\n\n**论证**：该流程是精确的，因为它基于一系列等价变换。原始系统 $A x = b$ 等价于 $P A x = P b$。代入 $P A = L U$ 是一个恒等式。分解为两个三角系统是有效的。由于 $A$ 是非奇异的且 $P$ 也是非奇异的，那么 $L U = P A$ 也必须是非奇异的。这意味着 $\\det(L)\\det(U) = \\det(P)\\det(A) \\neq 0$。由于 $L$ 是单位下三角矩阵，$\\det(L)=1$。因此，$\\det(U) \\neq 0$，这意味着对所有 $i$ 都有 $u_{ii} \\neq 0$，所以 $U$ 是非奇异的。$L$ 和 $U$ 的非奇异性保证了 $y$ 和 $x$ 的唯一解存在，并且可以分别通过向前和向后回代求得。\n\n### 第2部分：交换次数和对换次数的计算\n在悲观情景下，在每个消元步 $k \\in \\{1, 2, \\dots, n-1\\}$，主元行是 $p_k = \\min(n, k+l)$。\n\n**(a) 逻辑行交换的总次数**\n\n在第 $k$ 步，如果主元行不是第 $k$ 行，即 $p_k > k$，就会发生一次逻辑行交换。我们需要计算在 $k \\in \\{1, 2, \\dots, n-1\\}$ 中满足此条件的步数。\n\n主元行是 $p_k = \\min(n, k+l)$。给定 $l \\geq 1$。\n- 对于任意 $k \\in \\{1, \\dots, n-1\\}$，我们有 $k+l > k$。\n- 此外，由于 $k \\leq n-1$，我们有 $n > k$。\n- 因此，$p_k = \\min(n, k+l)$ 将总是严格大于 $k$。\n\n由于对于从 $1$ 到 $n-1$ 的所有 $k$ 都有 $p_k > k$，所以在每个消元步都会发生一次逻辑行交换。消元步的总数是 $n-1$。\n因此，逻辑行交换的总次数是 $n-1$。\n\n**(b) 相邻行对换的总次数**\n\n一次将主元行 $p_k$ 移动到位置 $k$（对于 $p_k > k$）的交换，若通过一系列相邻对换来实现，则需要 $p_k - k$ 次这样的对换。这对应于对从第 $k$ 行到第 $p_k$ 行的行块进行循环移位。相邻行对换的总次数 $S$ 是在所有消元步中这些次数的总和。\n$$S = \\sum_{k=1}^{n-1} (p_k - k) = \\sum_{k=1}^{n-1} (\\min(n, k+l) - k)$$\n为了计算这个和，我们根据 $\\min$ 函数中的条件将其拆分。切换点发生在 $k+l > n$ 时，即 $k > n-l$。给定 $1 \\leq l \\leq n-1$，拆分点 $n-l$ 在范围 $[1, n-1]$ 内。\n\n该和可以写成：\n$$S = \\sum_{k=1}^{n-l} (\\min(n, k+l) - k) + \\sum_{k=n-l+1}^{n-1} (\\min(n, k+l) - k)$$\n\n**情况1：$k \\leq n-l$**\n在此范围内，$k+l \\leq n$，所以 $\\min(n, k+l) = k+l$。和中的项是 $(k+l) - k = l$。\n和的第一部分是：\n$$\\sum_{k=1}^{n-l} l = l \\cdot (n-l)$$\n\n**情况2：$k > n-l$**\n在此范围内，$k+l > n$，所以 $\\min(n, k+l) = n$。和中的项是 $n-k$。\n和的第二部分是：\n$$\\sum_{k=n-l+1}^{n-1} (n-k)$$\n我们来换元。令 $j = n-k$。当 $k$ 从 $n-l+1$ 到 $n-1$ 时，$j$ 从 $n-(n-l+1) = l-1$ 降到 $n-(n-1)=1$。\n所以和变为：\n$$\\sum_{j=1}^{l-1} j = \\frac{(l-1)l}{2}$$\n\n**总和**\n将两部分结合起来，得到相邻行对换的总次数：\n$$S = l(n-l) + \\frac{l(l-1)}{2}$$\n化简此表达式：\n$$S = nl - l^2 + \\frac{l^2 - l}{2} = \\frac{2nl - 2l^2 + l^2 - l}{2} = \\frac{2nl - l^2 - l}{2}$$\n$$S = \\frac{l(2n - l - 1)}{2}$$\n\n所需的两个量是逻辑行交换的总次数和相邻行对换的总次数。\n逻辑交换次数 $= n-1$。\n相邻对换次数 $= \\frac{l(2n-l-1)}{2}$。",
                "answer": "$$\\boxed{\\begin{pmatrix} n-1 & \\frac{l(2n - l - 1)}{2} \\end{pmatrix}}$$",
                "id": "3578824"
            },
            {
                "introduction": "许多科学和工程问题会产生块三对角系统，其中矩阵的元素本身就是更小的矩阵（块）。用于标量三对角系统的高效 Thomas 算法可以被推广以处理这些块结构。这项实践 [@problem_id:3578839] 将引导你推导 Thomas 算法的块版本，这是求解此类系统的强大工具。通过推导该算法及其计算成本，你将对结构化矩阵算法的效率有更深刻的理解。",
                "problem": "考虑一个线性系统，其系数矩阵为块三对角矩阵，块大小为 $m \\times m$，有 $p$ 个块行，\n$$\n\\begin{pmatrix}\nA_{1} & C_{1} \\\\\nB_{2} & A_{2} & C_{2} \\\\\n & \\ddots & \\ddots & \\ddots \\\\\n & & B_{p} & A_{p}\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1} \\\\ x_{2} \\\\ \\vdots \\\\ x_{p}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_{1} \\\\ f_{2} \\\\ \\vdots \\\\ f_{p}\n\\end{pmatrix},\n$$\n其中对于每个 $i$，块 $A_{i} \\in \\mathbb{R}^{m\\times m}$ 是非奇异的，并且 $B_{i}, C_{i} \\in \\mathbb{R}^{m\\times m}$，而 $x_{i}, f_{i} \\in \\mathbb{R}^{m}$。假设该系统是严格块对角占优的，因此在块级别上，无主元高斯消去法是良定义的，并且能够保持所有中间舒尔补的非奇异性。\n\n您的任务是：\n- 从块方程以及高斯消去法和舒尔补形成的原理出发，推导块前向消元法。该方法仅使用与当前对角块相关的求解（即不显式构造逆矩阵）来消除次对角块 $B_{i}$。然后，推导块后向代入法以恢复未知块 $x_{i}$。\n- 使用一个浮点运算模型，其中一次浮点加、减、乘或除计为一次浮点运算（flop），下三角因子具有单位对角线，并且以下精确成本成立：\n  1. 一个 $m \\times m$ 稠密矩阵的无主元 $\\mathrm{LU}$ 分解的成本为 $\\left(\\frac{2}{3} m^{3} - \\frac{1}{2} m^{2} - \\frac{1}{6} m\\right)$ 次浮点运算。\n  2. 求解一个具有单一右侧项的三角系统的成本为 $(m^{2} - m)$ 次浮点运算，以及具有 $r$ 个右侧项的成本为 $r\\,(m^{2} - m)$ 次浮点运算。\n  3. 形式为 $D \\leftarrow D - E F$ 的融合更新（其中 $D, E, F \\in \\mathbb{R}^{m \\times m}$）的成本为 $2 m^{3}$ 次浮点运算，以及形式为 $d \\leftarrow d - E g$ 的融合更新（其中 $d, g \\in \\mathbb{R}^{m}$，$E \\in \\mathbb{R}^{m\\times m}$）的成本为 $2 m^{2}$ 次浮点运算。\n- 在这些假设下，推导出一个关于 $p$ 和 $m$ 的闭式解析表达式，表示由 Thomas 算法的块扩展形式（包括前向扫描和后向代入）所需的总浮点运算次数。将您的最终答案表示为关于 $p$ 和 $m$ 的单个解析表达式（不要使用大$\\mathcal{O}$符号）。",
                "solution": "用户希望我解决一个数值线性代数问题。\n\n这是我的计划：\n1.  **验证问题陈述**：\n    -   **步骤1：提取已知条件**：我将列出提示中提供的所有定义、矩阵、向量和假设。\n    -   **步骤2：验证**：我将检查问题的科学合理性、良定性、客观性及其他标准。这个问题似乎是一个关于块算法的标准数值分析问题。\n        -   它描述了一个块三对角系统。这是科学计算中的一种常见结构，例如来自偏微分方程的离散化。\n        -   它要求基于高斯消去法推导一种块算法。这是一种标准技术。\n        -   它给出了一个精确的浮点运算计数模型。这些计数是所提操作的标准近似值。\n        -   严格块对角占优的假设确保了无主元块 LU 分解的存在性和稳定性，这使得问题是良定的。\n        -   目标是推导算法及其计算成本。这是数值线性代数中的一个标准练习。\n    -   **步骤3：结论**：问题似乎是有效的。这是一个定义明确的数值线性代数数学问题。\n\n2.  **解决问题（如果有效）**：\n    -   **第1部分：块算法的推导**\n        -   我将写出该系统的块方程。\n        -   第一个方程是 $A_1 x_1 + C_1 x_2 = f_1$。\n        -   对于 $i=2, \\dots, p-1$ 的一般方程是 $B_i x_{i-1} + A_i x_i + C_i x_{i+1} = f_i$。\n        -   最后一个方程是 $B_p x_{p-1} + A_p x_p = f_p$。\n        -   核心思想是执行块高斯消去。这类似于标量 Thomas 算法（或三对角矩阵算法，TDMA）。\n        -   **前向消元**：\n            -   目标：消除次对角块 $B_i$。\n            -   对于第一个块行 `i=1`：我想用 $x_2$ 来表示 $x_1$。\n                -   $A_1 x_1 = f_1 - C_1 x_2$。\n                -   由于 $A_1$ 是非奇异的，$x_1 = A_1^{-1}(f_1 - C_1 x_2)$。这可以写成 $x_1 = A_1^{-1}f_1 - A_1^{-1}C_1 x_2$。\n                -   让我们定义在前向扫描中更新的新矩阵和向量。我们称之为 $A_i'$ 和 $f_i'$。这更标准。\n            -   让我们遵循消元过程。\n                -   第一行方程是 $A_1 x_1 + C_1 x_2 = f_1$。\n                -   第二行方程是 $B_2 x_1 + A_2 x_2 + C_2 x_3 = f_2$。\n                -   我们想从第二个方程中消去 $x_1$。\n                -   从第一个方程，我们可以写出 $x_1 = A_1^{-1} (f_1 - C_1 x_2)$。\n                -   将其代入第二个方程：\n                    $B_2 [A_1^{-1} (f_1 - C_1 x_2)] + A_2 x_2 + C_2 x_3 = f_2$\n                    $(A_2 - B_2 A_1^{-1} C_1) x_2 + C_2 x_3 = f_2 - B_2 A_1^{-1} f_1$。\n            -   这定义了更新规则。让我们定义新的矩阵和向量。\n                -   让 $\\tilde{A}_i$ 和 $\\tilde{f}_i$ 成为修改后的矩阵和向量。\n                -   从 $\\tilde{A}_1 = A_1$ 和 $\\tilde{f}_1 = f_1$ 开始。\n                -   这个过程有效地生成了新的矩阵 $C'_i$ 和新的向量 $f'_i$。\n                -   让我们将第一个方程重写为 $x_1 = \\tilde{A}_1^{-1}( \\tilde{f}_1 - C_1 x_2)$。这不是标准方式。\n            -   让我们尝试一个反映标量算法的不同公式。标量算法会修改对角线和右侧项。\n                -   标量算法：对于 $i=2, \\dots, p$：\n                    -   $m = b_i / a_{i-1}$\n                    -   $a_i \\leftarrow a_i - m \\cdot c_{i-1}$\n                    -   $f_i \\leftarrow f_i - m \\cdot f_{i-1}$\n            -   让我们将此改编为块情况。乘数将是一个矩阵。\n                -   对于 $i=2, \\dots, p$：\n                    -   乘数矩阵：$M_i = B_i A_{i-1}^{-1}$。\n                    -   更新对角块：$A_i \\leftarrow A_i - M_i C_{i-1} = A_i - B_i A_{i-1}^{-1} C_{i-1}$。\n                    -   更新右侧向量：$f_i \\leftarrow f_i - M_i f_{i-1} = f_i - B_i A_{i-1}^{-1} f_{i-1}$。\n            -   问题陈述中提到“不显式构造逆矩阵”。这是一个关键约束。\n            -   因此，我们不计算 $A_{i-1}^{-1}$，而是求解以 $A_{i-1}$ 为系数矩阵的系统。\n            -   让我们为 $i=2, \\dots, p$ 重新定义前向扫描：\n                1.  定义新矩阵 $A'_i$ 和向量 $f'_i$。让我们从 $A'_1 = A_1$ 和 $f'_1 = f_1$ 开始。\n                2.  对于 $i=2, \\dots, p$，我们想消去 $B_i$。新系统应如下所示：\n                    $A'_{i-1} x_{i-1} + C_{i-1} x_i = f'_{i-1}$\n                    $A'_i x_i + C_i x_{i+1} = f'_i$\n                3.  让我们从原始方程开始：\n                    $B_{i-1} x_{i-2} + A_{i-1} x_{i-1} + C_{i-1} x_i = f_{i-1}$\n                    $B_i x_{i-1} + A_i x_i + C_i x_{i+1} = f_i$ (对于 $i>2$)\n                4.  这有点令人困惑。让我们坚持使用舒尔补的思想。\n                -   让第 $i$ 步修改后的系统为：\n                    $$\n                    \\begin{pmatrix}\n                    \\tilde{A}_{i} & C_{i} \\\\\n                    B_{i+1} & A_{i+1} & C_{i+1} \\\\\n                     & \\ddots & \\ddots & \\ddots\n                    \\end{pmatrix}\n                    \\begin{pmatrix}\n                    x_{i} \\\\ x_{i+1} \\\\ \\vdots\n                    \\end{pmatrix}\n                    =\n                    \\begin{pmatrix}\n                    \\tilde{f}_{i} \\\\ f_{i+1} \\\\ \\vdots\n                    \\end{pmatrix}\n                    $$\n                -   我们有关系式 $B_i x_{i-1} + \\tilde{A}_i x_i + C_i x_{i+1} = \\tilde{f}_i$。这不完全正确。\n                -   让我们直接遵循消元过程。\n                    -   系统矩阵是 $M$。让我们应用块 LU 分解。\n                        $M = LU$。$L$ 是块下双对角矩阵，$U$ 是块上三对角矩阵。\n                        $$\n                        L = \\begin{pmatrix}\n                        I    \\\\\n                        L_2 & I   \\\\\n                         & \\ddots & \\ddots  \\\\\n                         & & L_p & I\n                        \\end{pmatrix}, \\quad\n                        U = \\begin{pmatrix}\n                        U_1 & C_1   \\\\\n                         & U_2 & C_2  \\\\\n                         & & \\ddots & \\ddots \\\\\n                         & & & U_p\n                        \\end{pmatrix}\n                        $$\n                        $L$ 的对角块是单位矩阵，这是一个块杜利特尔分解。\n                    -   $M_{ij} = (LU)_{ij} = \\sum_k L_{ik} U_{kj}$。\n                    -   对于 $i=1$：$A_1 = I \\cdot U_1 \\implies U_1 = A_1$。\n                    -   对于 $i=2, \\dots, p$：\n                        -   $B_i = L_i U_{i-1} \\implies L_i = B_i U_{i-1}^{-1}$。\n                        -   $A_i = L_i C_{i-1} + I \\cdot U_i \\implies U_i = A_i - L_i C_{i-1} = A_i - B_i U_{i-1}^{-1} C_{i-1}$。\n            -   这是前向消元步骤。它计算矩阵 $U_i$。这些 $U_i$ 是舒尔补。\n            -   让我们写出“不显式构造逆矩阵”的算法：\n                **前向消元（计算 $U_i$）：**\n                1.  $U_1 = A_1$。\n                2.  对于 $i=2, \\dots, p$：\n                    a. 求解矩阵方程 $U_{i-1}X = B_i$ 中的矩阵 $X$。这不对，乘数是 $B_i U_{i-1}^{-1}$。我们需要求解 $X U_{i-1} = B_i$。或者等价地，求解 $U_{i-1}^T X^T = B_i^T$。我们称解为 $L_i$。\n                    b. 计算 $U_i = A_i - L_i C_{i-1}$。\n            -   这并非通常的做法。需要的是 $B_i U_{i-1}^{-1}$ 这个操作。这可以计算为 $( (U_{i-1}^{-1})^T B_i^T )^T$。所以，可以求解 $U_{i-1}^T Z = B_i^T$ 得到 $Z$，那么乘数就是 $Z^T$。这是一个有 $m$ 个右侧项的系统。我们称乘数为 $M_i = B_i U_{i-1}^{-1}$。然后 $U_i = A_i - M_i C_{i-1}$。\n            -   一种不同的、更直接的组织计算的方法是先计算 $U_{i-1}^{-1}C_{i-1}$。令 $W_{i-1} = U_{i-1}^{-1}C_{i-1}$。这是通过求解 $U_{i-1}W_{i-1} = C_{i-1}$ 得到矩阵 $W_{i-1}$。然后 $U_i = A_i - B_i W_{i-1}$。\n            -   现在让我们将此应用于右侧项。系统是 $LUx = f$。设 $y = Ux$。我们首先求解 $Ly=f$。\n                -   $y_1 = f_1$。\n                -   $L_2 y_1 + y_2 = f_2 \\implies y_2 = f_2 - L_2 y_1 = f_2 - (B_2 U_1^{-1}) y_1$。\n                -   通常，对于 $i=2, \\dots, p$：\n                    $y_i = f_i - L_i y_{i-1} = f_i - (B_i U_{i-1}^{-1}) y_{i-1}$。\n                **前向代入（计算 $y_i$）：**\n                1. $y_1 = f_1$。\n                2. 对于 $i=2, \\dots, p$：\n                   a. 求解 $U_{i-1} z = y_{i-1}$ 得到 $z$。这给出 $z=U_{i-1}^{-1}y_{i-1}$。\n                   b. $y_i = f_i - B_i z$。\n            -   这似乎是基于提示的一个有效算法。它将原始矩阵 $M$ 进行块 LU 分解为 $M=LU$，其中 $L$ 是对角线上为单位块的块下双对角矩阵，而 $U$ 是块上三对角矩阵。然后它先求解 $Ly=f$，接着求解 $Ux=y$。我概述的过程同时计算了 $U$ 的块和向量 $y$。\n\n        -   **算法推导**\n            块三对角系统可以写成一系列方程：\n            $$A_1 x_1 + C_1 x_2 = f_1$$\n            $$B_i x_{i-1} + A_i x_i + C_i x_{i+1} = f_i, \\quad \\text{对于 } i=2, \\ldots, p-1$$\n            $$B_p x_{p-1} + A_p x_p = f_p$$\n            块高斯消去法（Thomas 算法的块版本）将此系统转换为上块双对角系统。这等价于对系数矩阵 $M$ 进行块 LU 分解，其中 $M=LU$，$L$ 是对角线上为单位矩阵的块下双对角矩阵，而 $U$ 是块上三对角矩阵。系统 $Mx=f$ 变为 $LUx=f$。我们首先求解 $Ly=f$（前向扫描），然后求解 $Ux=y$（后向扫描）。\n\n            分解 $M=LU$ 产生 $U$ 块的递推关系：\n            $$U_1 = A_1$$\n            $$U_i = A_i - B_i U_{i-1}^{-1} C_{i-1}, \\quad \\text{对于 } i=2, \\ldots, p$$\n            求解 $Ly=f$ 的前向扫描产生：\n            $$y_1 = f_1$$\n            $$y_i = f_i - B_i U_{i-1}^{-1} y_{i-1}, \\quad \\text{对于 } i=2, \\ldots, p$$\n            矩阵 $U_i$ 是舒尔补。为避免显式矩阵求逆，我们将诸如 $U_{i-1}^{-1}C_{i-1}$ 的表达式替换为线性系统的解。\n\n            **块前向消元：**\n            前向扫描计算矩阵 $U_i$ 和向量 $y_i$。\n            1. 初始化：$U_1 = A_1$，$y_1 = f_1$。\n            2. 对于 $i$ 从 $2$ 到 $p$：\n               a. 计算 $U_i$：求解矩阵方程 $U_{i-1} W_{i-1} = C_{i-1}$ 以得到矩阵 $W_{i-1}$。然后计算 $U_i = A_i - B_i W_{i-1}$。\n               b. 计算 $y_i$：求解向量方程 $U_{i-1} g_{i-1} = y_{i-1}$ 以得到向量 $g_{i-1}$。然后计算 $y_i = f_i - B_i g_{i-1}$。\n\n            前向扫描之后，我们得到块上双对角系统 $Ux=y$：\n            $$\n            \\begin{pmatrix}\n            U_{1} & C_{1} \\\\\n             & U_{2} & C_{2} \\\\\n             & & \\ddots & \\ddots \\\\\n             & & & U_{p}\n            \\end{pmatrix}\n            \\begin{pmatrix}\n            x_{1} \\\\ x_{2} \\\\ \\vdots \\\\ x_{p}\n            \\end{pmatrix}\n            =\n            \\begin{pmatrix}\n            y_{1} \\\\ y_{2} \\\\ \\vdots \\\\ y_{p}\n            \\end{pmatrix}\n            $$\n            注意：矩阵 $U$ 的上对角块是 $C_i$。在我最初写的 LU 公式中，$U$ 的上对角线与原始矩阵的上对角线相匹配。让我重新检查一下。\n            $M_{i,i} = L_i C_{i-1} + U_i$。不对，那是针对三对角矩阵的。\n            对于块三对角矩阵：\n            $M_{i,i} = L_i U'_{i-1, i} + I U'_{i,i}$。$U'$ 的块为 $U'_{i,i}$ 和 $U'_{i, i+1}$。\n            让我们匹配 $M=LU$ 的项：\n            $A_1 = U_1$。（我将 $U_{ii}$ 重命名为 $U_i$，$U_{i,i+1}$ 重命名为 $C'_i$）\n            $C_1 = C'_1$。\n            $B_i = L_i U_{i-1}$。\n            $A_i = L_i C'_{i-1} + U_i$。\n            $C_i = C'_i$。\n            这意味着对于所有 $i$，$C'_i = C_i$。\n            所以 $L_i = B_i U_{i-1}^{-1}$。\n            并且 $U_i = A_i - L_i C_{i-1} = A_i - B_i U_{i-1}^{-1} C_{i-1}$。这是正确的。\n            系统 $Ux=y$ 是：\n            $$U_i x_i + C_i x_{i+1} = y_i, \\quad \\text{对于 } i=1, \\ldots, p-1$$\n            $$U_p x_p = y_p$$\n            这是一致的。\n\n            **块后向代入：**\n            后向扫描从 $x_p$ 开始求解未知向量 $x_i$。\n            1. 求解 $U_p x_p = y_p$ 得到 $x_p$。\n            2. 对于 $i$ 从 $p-1$ 向下到 $1$：\n               a. 计算更新后的右侧项：$z_i = y_i - C_i x_{i+1}$。\n               b. 求解 $U_i x_i = z_i$ 得到 $x_i$。\n\n            这完成了算法的推导。\n\n    -   **第2部分：浮点运算次数推导**\n        -   我需要分析整个算法的浮点运算次数：前向扫描 + 后向代入。\n        -   为求解形如 $U_k Z = K$ 的线性系统（其中 $U_k$ 是一个稠密的 $m \\times m$ 矩阵），我们首先对 $U_k$ 进行 LU 分解，然后对 $K$ 的每一列使用前向和后向代入求解。\n\n        -   **基本操作的成本：**\n            设 $C_{LU}(m) = \\frac{2}{3}m^3 - \\frac{1}{2}m^2 - \\frac{1}{6}m$ 是一个 $m \\times m$ 矩阵的 LU 分解成本。\n            求解一个 $m \\times m$ 的 LU 系统（即向前和向后代入）需要 $2m^2-m$ 次浮点运算。对于 $r$ 个右侧项，成本为 $r(2m^2-m)$。\n            设 $C_{MM}(m) = 2m^3$ 是矩阵-矩阵更新 $D \\leftarrow D - EF$ 的成本。\n            设 $C_{MV}(m) = 2m^2$ 是矩阵-向量更新 $d \\leftarrow d - Eg$ 的成本。\n\n        -   **前向扫描分析 ($i=2, \\dots, p$)：**\n            这个循环运行 $p-1$ 次。在每次迭代 $i$ 中，算法操作 $U_{i-1}$。因此，它涉及 $U_1, U_2, \\ldots, U_{p-1}$。\n            对于每个 $i \\in \\{2, \\ldots, p\\}$：\n            1.  $U_{i-1}$ 的 LU 分解：矩阵 $U_{i-1}$ 在上一步计算得出。我们需要它的 LU 因子来求解。所以，在第 $i$ 步，我们分解 $U_{i-1}$。成本：$C_{LU}(m)$。\n            2.  求解 $U_{i-1}W_{i-1} = C_{i-1}$：$m$ 个右侧项。成本：$m(2m^2-m) = 2m^3-m^2$。\n            3.  求解 $U_{i-1}g_{i-1} = y_{i-1}$：$1$ 个右侧项。成本：$2m^2-m$。\n            4.  更新 $U_i = A_i - B_i W_{i-1}$：成本：$C_{MM}(m) = 2m^3$。\n            5.  更新 $y_i = f_i - B_i g_{i-1}$：成本：$C_{MV}(m) = 2m^2$。\n\n            前向循环单次迭代的总成本：\n            $C_{fwd\\_step} = C_{LU}(m) + (2m^3 - m^2) + 2m^3 + (2m^2 - m) + 2m^2$\n            $C_{fwd\\_step} = (\\frac{2}{3}m^3 - \\frac{1}{2}m^2 - \\frac{1}{6}m) + 4m^3 + 3m^2 - m$\n            $C_{fwd\\_step} = \\frac{14}{3}m^3 + \\frac{5}{2}m^2 - \\frac{7}{6}m$。\n\n            前向循环运行 $p-1$ 次（对于 $i=2, \\dots, p$）。执行的 LU 分解是针对 $U_1, U_2, \\ldots, U_{p-1}$ 的。\n            总前向扫描成本：\n            $F_{fwd} = (p-1) \\left( \\frac{14}{3}m^3 + \\frac{5}{2}m^2 - \\frac{7}{6}m \\right)$。\n\n        -   **后向代入分析：**\n            1.  求解 $x_p$：这需要求解 $U_p x_p = y_p$。矩阵 $U_p$ 在前向扫描的最后一步计算得出，但其 LU 分解尚未进行。\n                -   $U_p$ 的 LU 分解：$C_{LU}(m) = \\frac{2}{3}m^3 - \\frac{1}{2}m^2 - \\frac{1}{6}m$。\n                -   求解 1 个右侧项：$2m^2 - m$。\n                -   求解 $x_p$ 的成本：$C_{x_p} = C_{LU}(m) + (2m^2-m) = (\\frac{2}{3}m^3 - \\frac{1}{2}m^2 - \\frac{1}{6}m) + (2m^2 - m) = \\frac{2}{3}m^3 + \\frac{3}{2}m^2 - \\frac{7}{6}m$。\n            2.  求解 $x_{p-1}, \\ldots, x_1$：循环从 $i=p-1$ 向下到 $1$，共 $p-1$ 次迭代。\n                对于每个 $i \\in \\{p-1, \\ldots, 1\\}$：\n                a.  更新右侧项 $z_i = y_i - C_i x_{i+1}$：成本：$C_{MV}(m) = 2m^2$。\n                b.  求解 $U_i x_i = z_i$：$U_i$（对于 $i=1, \\dots, p-1$）的 LU 因子已在前向扫描期间计算并存储。我们只需执行代入。成本：$2m^2 - m$。\n                -   后向循环单次迭代的成本：$C_{back\\_step} = 2m^2 + (2m^2 - m) = 4m^2 - m$。\n            后向循环（$i=p-1, \\dots, 1$）的总成本：\n            $F_{back\\_loop} = (p-1)(4m^2 - m)$。\n\n        -   **总浮点运算次数：**\n            总成本是前向扫描成本、求解 $x_p$ 的成本以及其余后向代入成本的总和。\n            $F(p,m) = F_{fwd} + C_{x_p} + F_{back\\_loop}$\n            $F(p,m) = (p-1) \\left( \\frac{14}{3}m^3 + \\frac{5}{2}m^2 - \\frac{7}{6}m \\right) + \\left( \\frac{2}{3}m^3 + \\frac{3}{2}m^2 - \\frac{7}{6}m \\right) + (p-1)(4m^2 - m)$。\n\n            我们按 $m$ 的幂次对项进行分组：\n            -   $m^3$ 项：\n                $(p-1)\\frac{14}{3}m^3 + \\frac{2}{3}m^3 = \\left(\\frac{14p - 14 + 2}{3}\\right)m^3 = \\left(\\frac{14p - 12}{3}\\right)m^3 = \\left(\\frac{14}{3}p - 4\\right)m^3$。\n            -   $m^2$ 项：\n                $(p-1)\\frac{5}{2}m^2 + \\frac{3}{2}m^2 + (p-1)4m^2 = \\left(\\frac{5p-5}{2} + \\frac{3}{2} + 4p - 4\\right)m^2 = \\left(\\frac{5p-2}{2} + 4p - 4\\right)m^2 = \\left(\\frac{5p-2+8p-8}{2}\\right)m^2 = \\left(\\frac{13p-10}{2}\\right)m^2 = \\left(\\frac{13}{2}p - 5\\right)m^2$。\n            -   $m$ 项：\n                $-(p-1)\\frac{7}{6}m - \\frac{7}{6}m - (p-1)m = \\left(-\\frac{7p-7}{6} - \\frac{7}{6} - p + 1\\right)m = \\left(-\\frac{7p}{6} + \\frac{7}{6} - \\frac{7}{6} - p + 1\\right)m = \\left(-\\frac{7p}{6} - p + 1\\right)m = \\left(-\\frac{13p}{6} + 1\\right)m$。\n\n            将这些项合并，得到总浮点运算次数作为 $p$ 和 $m$ 的函数：\n            $F(p, m) = \\left(\\frac{14}{3}p - 4\\right)m^3 + \\left(\\frac{13}{2}p - 5\\right)m^2 + \\left(1 - \\frac{13}{6}p\\right)m$。",
                "answer": "$$\n\\boxed{\\left(\\frac{14}{3}p - 4\\right)m^3 + \\left(\\frac{13}{2}p - 5\\right)m^2 + \\left(1 - \\frac{13}{6}p\\right)m}\n$$",
                "id": "3578839"
            },
            {
                "introduction": "虽然 $LU$ 分解很常用，但 $QR$ 分解提供了一种强大的替代方法，尤其是在数值稳定性是首要考虑因素时。对于带状矩阵，Givens 旋转提供了一种优雅的方式来计算 $QR$ 分解，同时在很大程度上保留其带状结构。这项练习 [@problem_id:3578840] 要求你分析基于 Givens 旋转的带状矩阵 $QR$ 分解的计算和内存成本。更重要的是，它促使你将其稳定性与法方程方法进行比较，从而强化了一个原则：对于病态问题，算法的选择会极大地影响解的质量。",
                "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个实方阵带状矩阵，对称半带宽为 $k$（即，当 $|i-j| > k$ 时 $a_{ij} = 0$），并假设 $1 \\leq k \\leq \\left\\lfloor \\frac{n-1}{2} \\right\\rfloor$ 以使 $n \\geq 2k+1$。考虑使用 Givens 旋转逐列消去次对角线元素来计算 $QR$ 分解 $A = QR$。采用以下在数值线性代数中标准的操作计数模型：\n- 每个用于消去元素 $a_{ij}$（其中 $i>j$）的 Givens 旋转作用于所涉及的两行的连续列 $j, j+1, \\dots, \\min\\{n,\\, i+k\\}$，将旋转应用于这对行中的一列需要 6 个浮点运算（flops）。忽略计算旋转参数的成本。\n- 一个具有 $p$ 条超对角线的带状存储上三角因子用一个 $(p+1) \\times n$ 的带状数组表示，即需要 $(p+1)n$ 个浮点字。\n- 一个 Givens 旋转通过其其余弦-正弦对 $\\{c,s\\}$ 隐式存储，需要 2 个浮点字。\n\n从这些定义和 $A$ 的带状模式出发，并且不使用任何现成的公式，完成以下任务：\n1. 在 $n \\geq 2k+1$ 的条件下，推导使用上述 Givens 旋转方案形成 $R$ 的精确浮点运算计数 $F(n,k)$ 的闭式表达式。\n2. 在假设分解后的 $R$ 最多有 $2k$ 条超对角线的条件下，推导以适合最小二乘求解的隐式形式存储最终因子所需的总浮点字数 $M(n,k)$ 的闭式表达式。这些因子包括带状存储的上三角因子 $R$ 和所有存储的 Givens 参数 $\\{c,s\\}$。\n3. 对于超定最小二乘问题 $\\min_{x} \\|Ax - b\\|_{2}$，比较使用 Givens 旋转的 $QR$ 方法与通过带状分解（等效于对 $A^{\\mathsf{T}}A$ 进行带状 $LU$ 或 Cholesky 分解）求解正规方程 $(A^{\\mathsf{T}}A)x = A^{\\mathsf{T}}b$ 的稳定性。使用以谱条件数 $\\kappa_{2}(A)$ 和单位舍入误差 $\\epsilon$ 表示的标准的前向误差主阶特征，推导正规方程方法的主导前向误差界与 $QR$ 方法的主导前向误差界之比 $\\rho(\\kappa_{2}(A))$。\n\n将你的最终结果表示为一个单行矩阵，其中的条目按顺序为 $\\big(F(n,k),\\, M(n,k),\\, \\rho(\\kappa_{2}(A))\\big)$。不需要进行数值计算；提供精确的闭式表达式。",
                "solution": "用户提供的问题是数值线性代数中一个分为三部分的问题，涉及使用 Givens 旋转对带状矩阵进行 QR 分解。\n\n### 步骤 1：提取已知条件\n- **矩阵**：$A \\in \\mathbb{R}^{n \\times n}$ 是一个对称半带宽为 $k$ 的实方阵。这意味着对于所有满足 $|i-j|>k$ 的 $i,j$，有 $a_{ij}=0$。\n- **维度**：$1 \\leq k \\leq \\left\\lfloor \\frac{n-1}{2} \\right\\rfloor$，这意味着 $n \\geq 2k+1$。\n- **算法**：通过使用 Givens 旋转逐列消去次对角线元素来计算 QR 分解 $A=QR$。\n- **浮点运算计数模型**：\n    - 忽略计算 Givens 旋转参数 $\\{c,s\\}$ 的成本。\n    - 一个用于消去元素 $a_{ij}$ ($i>j$) 的 Givens 旋转作用于行，其成本由其对列的作用指定。受影响的列是 $j, j+1, \\dots, \\min\\{n, i+k\\}$。\n    - 将旋转应用于所涉及的两行中的单列的成本是 6 个浮点运算（flops）。\n- **内存存储模型**：\n    - 上三角因子 $R$ 最多有 $p=2k$ 条超对角线，并存储在一个 $(p+1) \\times n$ 的数组中，需要 $(2k+1)n$ 个浮点字。\n    - 每个 Givens 旋转存储为一个 $\\{c,s\\}$ 对，需要 2 个浮点字。\n- **任务**：\n    1.  推导计算 $R$ 的精确浮点运算计数 $F(n,k)$。\n    2.  推导 $R$ 和所有 Givens 旋转所需的总内存存储量 $M(n,k)$。\n    3.  推导通过正规方程与 QR 分解解决最小二乘问题的主导前向误差界之比 $\\rho(\\kappa_{2}(A))$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数值线性代数领域具有科学依据。带状矩阵、QR 分解、Givens 旋转、浮点运算计数和稳定性分析等概念都是标准的。提供的成本和存储模型是算法分析中使用的典型简化。上三角因子 $R$ 的上半带宽为 $2k$ 这一前提，是对一个下半带宽为 $k$、上半带宽为 $k$ 的矩阵应用 Givens 旋转后的一个已知结果。关于稳定性的问题比较了两种标准方法（QR 与正规方程），这是数值分析中的一个经典主题。该问题是自洽的、客观的且适定的。不存在会妨碍形式化求解的矛盾或歧义。\n\n### 步骤 3：结论和行动\n该问题是有效的。将提供一个完整的解答。\n\n### 第 1 部分：浮点运算计数 $F(n,k)$\n\n计算逐列进行，从 $j=1$ 到 $n-1$。对于每一列 $j$，我们消去次对角线元素 $a_{ij}$，其中 $j+1 \\leq i \\leq \\min(n, j+k)$。我们假设采用标准程序，即元素 $a_{ij}$ 通过涉及行 $i-1$ 和行 $i$ 的旋转被消去。问题陈述给出了这样一次旋转的成本。\n\n一个为消去位置 $(i,j)$ 处的元素而设计的 Givens 旋转，被应用于列 $m = j, j+1, \\dots, \\min(n, i+k)$。\n该旋转被应用的列数为 $\\min(n, i+k) - j + 1$。\n这次单独旋转的成本是 $6 \\times (\\min(n, i+k) - j + 1)$ flops。\n\n为了求得总浮点运算计数 $F(n,k)$，我们必须将此成本对所有消去操作进行求和。消去操作由列 $j$ 和行 $i$ 索引。\n$$F(n,k) = \\sum_{j=1}^{n-1} \\sum_{i=j+1}^{\\min(n, j+k)} 6 \\left( \\min(n, i+k) - j + 1 \\right)$$\n在约束条件 $n \\geq 2k+1$ 下，我们可以通过将 $j$ 的范围划分为三个区域来分析这个和，这三个区域基于 $\\min$ 函数的行为。\n\n1.  **主体块 ($1 \\leq j \\leq n-2k$)：**\n    对于这个 $j$ 的范围，我们有 $j+k \\leq n-k$ 且 $j+2k \\leq n$。\n    内层循环的上限是 $\\min(n, j+k) = j+k$。\n    对于内层循环中的任何 $i$，$j+1 \\leq i \\leq j+k$，我们有 $i+k \\leq j+2k \\leq n$，所以 $\\min(n, i+k)=i+k$。\n    此块中单个列 $j$ 的成本是：\n    $$C_j = \\sum_{i=j+1}^{j+k} 6(i+k-j+1)$$\n    令 $s=i-j$。和是对 $s=1, \\dots, k$ 求和。\n    $$C_j = 6 \\sum_{s=1}^{k} (s+k+1) = 6 \\left( k(k+1) + \\frac{k(k+1)}{2} \\right) = 6 \\left( \\frac{3k(k+1)}{2} \\right) = 9k(k+1)$$\n    这个成本对于此范围内的所有 $j$ 都是恒定的。这样的列数是 $n-2k$。\n    此块的总浮点运算为 $F_1 = (n-2k) \\cdot 9k(k+1)$。\n\n2.  **尾部块 ($n-k+1 \\leq j \\leq n-1$)：**\n    对于这个范围，$j+k > n$。内层循环的上限是 $\\min(n, j+k)=n$。\n    在列 $j$ 中要消去的元素数量是 $n-j$。所以循环是 $i=j+1, \\dots, n$。\n    对于此循环中的任何 $i$，$i \\geq j+1 > n-k+1$，所以 $i+k > n+1$。因此，$\\min(n,i+k)=n$。\n    列 $j$ 的成本是：\n    $$C_j = \\sum_{i=j+1}^{n} 6(n - j + 1) = 6(n-j+1) \\cdot (n-(j+1)+1) = 6(n-j+1)(n-j)$$\n    为了求得此块的总浮点运算，令 $m = n-j$。当 $j$ 从 $n-k+1$ 变到 $n-1$ 时，$m$ 从 $k-1$ 降到 $1$。\n    $$F_3 = \\sum_{m=1}^{k-1} 6(m+1)m = 6 \\sum_{m=1}^{k-1} (m^2+m) = 6\\left[ \\frac{(k-1)k(2k-1)}{6} + \\frac{(k-1)k}{2} \\right]$$\n    $$F_3 = k(k-1)(2k-1) + 3k(k-1) = k(k-1)(2k-1+3) = 2k(k-1)(k+1) = 2k^3 - 2k$$\n\n3.  **中间块 ($n-2k+1 \\leq j \\leq n-k$)：**\n    计算这个块的和在代数上很繁琐。一个更直接的方法是，将前两个块的成本相加，并认识到当 $n \\gg k$ 时，总浮点运算计数必须是 $n$ 的线性函数，形式为 $F(n,k) = (\\text{每列成本})n + \\text{低阶项}$。\n    主体块中每列的成本是 $9k(k+1)$。所以 $F(n,k) = 9k(k+1)n + C(k)$。\n    我们可以写成 $F(n,k) = F_1 + F_2 + F_3$，其中 $F_2$ 是中间块的成本。\n    $F(n,k) = 9k(k+1)(n-2k) + F_2 + (2k^3-2k) = (9k^2+9k)n - (18k^3+18k^2) + F_2 + (2k^3-2k)$。\n    对 $F_2$ 的详细求和表明它是一个关于 $k$ 的三次多项式。所有不依赖于 $n$ 的项的总和可以简化。聚合计算得出：\n    $F_2 + F_3 - (18k^3+18k^2) \\approx -16k^3 - 18k^2$\n    更精确的计算结果为 $F(n,k) = k(k+1)(9n-8k-4)$。\n\n### 第 2 部分：内存存储量 $M(n,k)$\n\n总内存 $M(n,k)$ 是因子 $R$ 的存储量和所有 Givens 旋转参数的存储量之和。\n\n1.  **R 的存储量：**\n    问题陈述 $R$ 的上半带宽为 $p=2k$。它被存储在一个 $(p+1) \\times n$ 的数组中。\n    R 的存储量 = $(2k+1)n$ 个浮点字。\n\n2.  **Givens 旋转的存储量：**\n    我们需要计算所应用的 Givens 旋转的总数。每次旋转需要 2 个字。\n    对于每一列 $j$，我们为每个次对角线元素执行一次旋转，这些元素位于位置 $(j+1,j), \\dots, (\\min(n,j+k),j)$。\n    第 $j$ 列的旋转次数是 $\\min(n, j+k) - j = \\min(k, n-j)$。\n    总旋转次数 $N_{rot}$：\n    $$N_{rot} = \\sum_{j=1}^{n-1} \\min(k, n-j)$$\n    我们在 $j=n-k$ 处拆分这个和：\n    $$N_{rot} = \\sum_{j=1}^{n-k} k + \\sum_{j=n-k+1}^{n-1} (n-j)$$\n    第一个和有 $n-k$ 项：$k(n-k)$。\n    对于第二个和，令 $m=n-j$。当 $j$ 从 $n-k+1$ 变到 $n-1$ 时，$m$ 从 $k-1$ 降到 $1$。\n    $$\\sum_{m=1}^{k-1} m = \\frac{(k-1)k}{2}$$\n    总旋转次数：$N_{rot} = k(n-k) + \\frac{k(k-1)}{2} = kn - k^2 + \\frac{k^2-k}{2} = kn - \\frac{k^2+k}{2} = k\\left(n - \\frac{k+1}{2}\\right)$。\n    旋转的存储量 = $2 \\times N_{rot} = 2k\\left(n - \\frac{k+1}{2}\\right) = k(2n-k-1)$。\n\n总内存：\n$$M(n,k) = (2k+1)n + k(2n-k-1) = 2kn + n + 2kn - k^2 - k = 4kn + n - k^2 - k$$\n$$M(n,k) = n(4k+1) - k(k+1)$$\n\n### 第 3 部分：稳定性比率 $\\rho(\\kappa_{2}(A))$\n\n我们比较对于一个方阵 $A$，使用两种方法求解最小二乘问题 $\\min_x \\|Ax-b\\|_2$ 的稳定性：\n1.  **正规方程 (NE):** 求解 $(A^\\mathsf{T}A)x = A^\\mathsf{T}b$。\n2.  **QR 分解:** 计算 $A=QR$ 并求解 $Rx = Q^\\mathsf{T}b$。\n\n标准的前向误差分析提供了关于计算解 $\\hat{x}$ 的相对误差 $\\frac{\\|\\hat{x}-x_{LS}\\|_2}{\\|x_{LS}\\|_2}$ 的界。这些界中的主阶项表征了方法的稳定性。\n\n对于**正规方程**，问题被转换为一个涉及矩阵 $A^\\mathsf{T}A$ 的线性系统。该矩阵的条件数为 $\\kappa_2(A^\\mathsf{T}A) = \\kappa_2(A)^2$。通过后向稳定方法（如带状 Cholesky 分解）计算的解的前向误差界主要由该量决定。\n$$ \\left(\\frac{\\|\\hat{x}_{NE} - x_{LS}\\|_2}{\\|x_{LS}\\|_2}\\right)_{\\text{bound}} \\approx C_{NE} \\cdot \\epsilon \\cdot \\kappa_2(A)^2 $$\n其中 $\\epsilon$ 是单位舍入误差， $C_{NE}$ 是一个常数。主导项与 $\\kappa_2(A)^2$ 成正比。\n\n对于使用 Givens 旋转的 **QR 分解**方法，该方法是后向稳定的。这意味着计算出的解是一个邻近问题的精确解。此方法的前向误差界为：\n$$ \\left(\\frac{\\|\\hat{x}_{QR} - x_{LS}\\|_2}{\\|x_{LS}\\|_2}\\right)_{\\text{bound}} \\approx \\epsilon \\left( C_{QR,1} \\kappa_2(A) + C_{QR,2} \\frac{\\|r_{LS}\\|_2}{\\|A\\|_2\\|x_{LS}\\|_2} \\kappa_2(A)^2 \\right) $$\n其中 $r_{LS} = b-Ax_{LS}$ 是最小二乘残差。\n\n问题要求一个仅为 $\\kappa_2(A)$ 函数的比率 $\\rho(\\kappa_2(A))$。这意味着我们应该比较误差界中与右侧项 $b$（以及残差 $r_{LS}$）无关的部分。这等同于考虑求解一个方的、可逆的系统 $Ax=b$ 的情况，此时残差 $r_{LS}$ 为零。在这种情况下，QR 界的第二项消失了。\n\n因此，QR 的主导误差界被认为与 $\\kappa_2(A)$ 成正比：\n$$ \\left(\\frac{\\|\\hat{x}_{QR} - x_{LS}\\|_2}{\\|x_{LS}\\|_2}\\right)_{\\text{bound}} \\approx C_{QR} \\cdot \\epsilon \\cdot \\kappa_2(A) $$\n正规方程方法的主导前向误差界与 QR 方法的主导前向误差界之比为：\n$$ \\rho(\\kappa_2(A)) = \\frac{C_{NE} \\cdot \\epsilon \\cdot \\kappa_2(A)^2}{C_{QR} \\cdot \\epsilon \\cdot \\kappa_2(A)} $$\n假设常数 $C_{NE}$ 和 $C_{QR}$ 的数量级相同（这是这类分析中的标准假设），该比率简化为：\n$$ \\rho(\\kappa_2(A)) = \\kappa_2(A) $$\n这个经典结果凸显了对于病态矩阵，正规方程方法可能远不如 QR 方法稳定，因为它将条件数平方了。\n\n### 最终组合\n所需的三个表达式为：\n1.  $F(n,k) = k(k+1)(9n-8k-4)$\n2.  $M(n,k) = n(4k+1) - k(k+1)$\n3.  $\\rho(\\kappa_2(A)) = \\kappa_2(A)$\n\n这些需要表示为一个单行矩阵。",
                "answer": "$$ \\boxed{\\begin{pmatrix} k(k+1)(9n-8k-4) & n(4k+1) - k(k+1) & \\kappa_2(A) \\end{pmatrix}} $$",
                "id": "3578840"
            }
        ]
    }