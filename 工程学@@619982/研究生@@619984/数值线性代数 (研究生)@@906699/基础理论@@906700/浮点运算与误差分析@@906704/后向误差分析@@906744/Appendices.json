{
        "hands_on_practices": [
            {
                "introduction": "本练习旨在通过一个具体的例子，阐明后向稳定性和问题条件数在最终计算误差中的不同角色。即使一个算法是后向稳定的，即它能找到一个邻近问题的精确解，但如果原问题本身是病态的，其计算结果（前向误差）仍然可能与真实解相差甚远。通过分析一个简单的 $2 \\times 2$ 矩阵族 [@problem_id:3533480]，我们将亲手推导条件数如何放大微小的后向误差，从而导致巨大的前向误差。",
                "problem": "设 $A(\\epsilon) \\in \\mathbb{R}^{2 \\times 2}$ 为参数化矩阵族\n$$\nA(\\epsilon) \\;=\\; \\begin{pmatrix} 1  1 \\\\ 1  1+\\epsilon \\end{pmatrix}, \\qquad \\epsilon \\in (0,1),\n$$\n并设向量 $x \\in \\mathbb{R}^{2}$ 为 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。定义 $b(\\epsilon) := A(\\epsilon)\\,x = \\begin{pmatrix} 2 \\\\ 2+\\epsilon \\end{pmatrix}$。计算在浮点算术中进行，单位舍入误差为 $u$，并且全文使用矩阵和向量的 $\\infty$-范数。假设带部分主元的高斯消元法（GEPP）对于该矩阵族是范数意义下向后稳定的，其含义如下：计算出的解 $\\hat{x}$ 满足\n$$\n\\bigl(A(\\epsilon) + \\Delta A\\bigr)\\,\\hat{x} \\;=\\; b(\\epsilon), \\qquad \\|\\Delta A\\|_{\\infty} \\;\\le\\; c\\,u\\,\\|A(\\epsilon)\\|_{\\infty},\n$$\n其中 $c$ 是一个与 $\\epsilon$ 和 $u$ 无关的绝对常数。\n\n仅从范数意义下向后稳定性、范数条件数和一阶扰动分析的定义出发，完成以下任务：\n\n1) 显式计算 $\\|A(\\epsilon)\\|_{\\infty}$、$A(\\epsilon)^{-1}$ 和 $\\|A(\\epsilon)^{-1}\\|_{\\infty}$，并由此确定条件数 $\\kappa_{\\infty}\\!\\bigl(A(\\epsilon)\\bigr) = \\|A(\\epsilon)\\|_{\\infty}\\,\\|A(\\epsilon)^{-1}\\|_{\\infty}$ 作为 $\\epsilon$ 的显式函数。\n\n2) 使用定义 $\\hat{x}$ 的方程和精确解 $x$，推导前向误差 $\\|x - \\hat{x}\\|_{\\infty}$ 关于 $\\|A(\\epsilon)\\|_{\\infty}$、$\\|A(\\epsilon)^{-1}\\|_{\\infty}$、$\\|x\\|_{\\infty}$ 和 $u$ 的一阶（关于 $u$）范数扰动界。然后，将此界应用于当前数据，以获得当 $\\epsilon \\to 0$ 和 $u \\to 0$ 且 $u \\ll \\epsilon$ 时的首阶渐近表达式。你可以假设确保相关诺伊曼级数收敛的小量条件在此机制下得到满足。\n\n将 $\\|x - \\hat{x}\\|_{\\infty}$ 在 $\\epsilon \\to 0$ 和 $u \\to 0$ 且 $u \\ll \\epsilon$ 时的首阶项的单一闭式表达式作为你的最终答案，简化形式即可。无需四舍五入。将最终答案表示为无单位的解析表达式。",
                "solution": "该问题在数值线性代数领域内是适定的且具有科学依据。我们将首先计算所需的矩阵范数和条件数，然后推导前向误差界及其首阶渐近行为。\n\n矩阵族由 $A(\\epsilon) = \\begin{pmatrix} 1  1 \\\\ 1  1+\\epsilon \\end{pmatrix}$ 给出，其中 $\\epsilon \\in (0,1)$。\n\n第1部分：范数和条件数的计算。\n\n首先，我们计算 $A(\\epsilon)$ 的 $\\infty$-范数。矩阵的 $\\infty$-范数定义为最大绝对行和。\n第一行的绝对和是 $|1| + |1| = 2$。\n第二行的绝对和是 $|1| + |1+\\epsilon|$。由于 $\\epsilon \\in (0,1)$，$1+\\epsilon$ 是正数，所以和为 $1 + 1+\\epsilon = 2+\\epsilon$。\n范数是这两个值的最大值：\n$$\n\\|A(\\epsilon)\\|_{\\infty} \\;=\\; \\max(2, 2+\\epsilon) \\;=\\; 2+\\epsilon\n$$\n\n接下来，我们计算 $A(\\epsilon)$ 的逆矩阵。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆矩阵为 $\\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n$A(\\epsilon)$ 的行列式是 $\\det(A(\\epsilon)) = (1)(1+\\epsilon) - (1)(1) = 1+\\epsilon-1 = \\epsilon$。\n由于 $\\epsilon \\in (0,1)$，$\\det(A(\\epsilon)) \\neq 0$，因此逆矩阵存在。\n$$\nA(\\epsilon)^{-1} \\;=\\; \\frac{1}{\\epsilon} \\begin{pmatrix} 1+\\epsilon  -1 \\\\ -1  1 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{1+\\epsilon}{\\epsilon}  -\\frac{1}{\\epsilon} \\\\ -\\frac{1}{\\epsilon}  \\frac{1}{\\epsilon} \\end{pmatrix}\n$$\n\n现在，我们计算 $A(\\epsilon)^{-1}$ 的 $\\infty$-范数。\n第一行的绝对和是 $|\\frac{1+\\epsilon}{\\epsilon}| + |-\\frac{1}{\\epsilon}| = \\frac{1+\\epsilon}{\\epsilon} + \\frac{1}{\\epsilon} = \\frac{2+\\epsilon}{\\epsilon}$，因为 $\\epsilon > 0$。\n第二行的绝对和是 $|-\\frac{1}{\\epsilon}| + |\\frac{1}{\\epsilon}| = \\frac{1}{\\epsilon} + \\frac{1}{\\epsilon} = \\frac{2}{\\epsilon}$。\n范数是这两个值的最大值。由于 $\\epsilon>0$，我们有 $\\frac{2+\\epsilon}{\\epsilon} > \\frac{2}{\\epsilon}$。\n$$\n\\|A(\\epsilon)^{-1}\\|_{\\infty} \\;=\\; \\max\\left(\\frac{2+\\epsilon}{\\epsilon}, \\frac{2}{\\epsilon}\\right) \\;=\\; \\frac{2+\\epsilon}{\\epsilon}\n$$\n\n最后，我们计算 $\\infty$-范数条件数 $\\kappa_{\\infty}(A(\\epsilon))$，它定义为矩阵范数与其逆矩阵范数的乘积。\n$$\n\\kappa_{\\infty}(A(\\epsilon)) \\;=\\; \\|A(\\epsilon)\\|_{\\infty} \\|A(\\epsilon)^{-1}\\|_{\\infty} \\;=\\; (2+\\epsilon) \\left(\\frac{2+\\epsilon}{\\epsilon}\\right) \\;=\\; \\frac{(2+\\epsilon)^2}{\\epsilon}\n$$\n这就完成了问题的第一部分。\n\n第2部分：前向误差界的推导及其渐近分析。\n\n我们已知精确关系式 $A(\\epsilon)x = b(\\epsilon)$ 和来自向后稳定计算的结果 $(A(\\epsilon) + \\Delta A)\\hat{x} = b(\\epsilon)$。我们可以将这两个 $b(\\epsilon)$ 的表达式相等：\n$$\n(A(\\epsilon) + \\Delta A)\\hat{x} \\;=\\; A(\\epsilon)x\n$$\n展开左边并重新整理各项得到：\n$$\nA(\\epsilon)\\hat{x} + \\Delta A \\hat{x} \\;=\\; A(\\epsilon)x\n$$\n$$\nA(\\epsilon)\\hat{x} - A(\\epsilon)x \\;=\\; -\\Delta A \\hat{x}\n$$\n$$\nA(\\epsilon)(\\hat{x} - x) \\;=\\; -\\Delta A \\hat{x}\n$$\n由于 $A(\\epsilon)$ 是可逆的，我们可以从左边乘以 $A(\\epsilon)^{-1}$：\n$$\n\\hat{x} - x \\;=\\; -A(\\epsilon)^{-1} \\Delta A \\hat{x}\n$$\n这将前向误差向量 $x - \\hat{x} = A(\\epsilon)^{-1} \\Delta A \\hat{x}$ 与向后误差扰动 $\\Delta A$ 联系起来。对两边取 $\\infty$-范数并使用范数的次乘性质，得到：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;=\\; \\|A(\\epsilon)^{-1} \\Delta A \\hat{x}\\|_{\\infty} \\;\\le\\; \\|A(\\epsilon)^{-1}\\|_{\\infty} \\|\\Delta A\\|_{\\infty} \\|\\hat{x}\\|_{\\infty}\n$$\n我们已知范数意义下的向后稳定性条件 $\\|\\Delta A\\|_{\\infty} \\le c\\,u\\,\\|A(\\epsilon)\\|_{\\infty}$。将其代入不等式得到：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;\\le\\; \\|A(\\epsilon)^{-1}\\|_{\\infty} (c\\,u\\,\\|A(\\epsilon)\\|_{\\infty}) \\|\\hat{x}\\|_{\\infty} \\;=\\; c\\,u\\,\\kappa_{\\infty}(A(\\epsilon)) \\|\\hat{x}\\|_{\\infty}\n$$\n为了获得关于 $u$ 的一阶界，我们认识到 $\\hat{x}$ 是 $x$ 的一个扰动，即 $\\hat{x} = x + O(u)$。在已经为 $O(u)$ 阶的右侧，我们可以用 $\\|x\\|_{\\infty}$ 替换 $\\|\\hat{x}\\|_{\\infty}$。这种替换所产生的误差 $c\\,u\\,\\kappa_{\\infty}(A(\\epsilon))(\\|\\hat{x}\\|_{\\infty} - \\|x\\|_{\\infty})$ 是 $O(u^2)$ 阶的，在一阶分析中可以忽略。此线性近似的有效性由问题的假设保证，即相关诺伊曼级数的底层小量条件得到满足。\n因此，一阶前向误差界为：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;\\le\\; c\\,u\\,\\kappa_{\\infty}(A(\\epsilon)) \\|x\\|_{\\infty}\n$$\n现在，我们使用问题中的数据和第1部分的结果来具体化这个界。\n向量 $x$ 给出为 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，所以其 $\\infty$-范数为 $\\|x\\|_{\\infty} = \\max(|1|, |1|) = 1$。\n代入 $\\kappa_{\\infty}(A(\\epsilon))$ 和 $\\|x\\|_{\\infty}$ 的表达式：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;\\le\\; c\\,u\\,\\frac{(2+\\epsilon)^2}{\\epsilon} \\cdot 1 \\;=\\; c\\,u\\,\\frac{(2+\\epsilon)^2}{\\epsilon}\n$$\n问题要求当 $\\epsilon \\to 0$ 和 $u \\to 0$ 且 $u \\ll \\epsilon$ 时 $\\|x - \\hat{x}\\|_{\\infty}$ 的首阶渐近表达式。这可以解释为求此误差界的首阶项。我们分析当 $\\epsilon \\to 0$ 时该界的行为：\n$$\nc\\,u\\,\\frac{(2+\\epsilon)^2}{\\epsilon} \\;=\\; c\\,u\\,\\frac{4 + 4\\epsilon + \\epsilon^2}{\\epsilon} \\;=\\; c\\,u\\,\\left(\\frac{4}{\\epsilon} + 4 + \\epsilon\\right)\n$$\n当 $\\epsilon \\to 0$ 时，项 $\\frac{4}{\\epsilon}$ 在括号中的其他项 $4$ 和 $\\epsilon$ 中占主导地位。因此，首阶项是包含因子 $\\frac{1}{\\epsilon}$ 的那一项。\n前向误差界的首阶渐近表达式为：\n$$\n\\frac{4cu}{\\epsilon}\n$$\n这个表达式表示了在小的 $\\epsilon$ 和 $u$ 下前向误差的大小。条件 $u \\ll \\epsilon$（意味着 $u/\\epsilon \\to 0$）确保了因子 $c\\,u\\,\\kappa_{\\infty}(A(\\epsilon)) \\approx 4cu/\\epsilon$ 是小的，这证明了一阶扰动分析的合理性。假设此界在常数因子 $c$ 的范围内是紧的，那么这就是误差 $\\|x - \\hat{x}\\|_{\\infty}$ 所需的首阶项。",
                "answer": "$$\n\\boxed{\\frac{4cu}{\\epsilon}}\n$$",
                "id": "3533480"
            },
            {
                "introduction": "在理解了病态问题会放大误差之后，一个自然的问题是：在后向稳定的前提下，前向误差最坏能有多大？本练习 [@problem_id:3533519] 将引导我们构造一个“对抗性”的线性系统输入，以揭示后向误差分析所给出的前向误差上界确实是可以达到的。通过识别最不利的输入向量与矩阵奇异向量之间的关系，我们不仅能验证理论的严密性，更能深刻理解条件数作为误差放大因子的物理意义。",
                "problem": "考虑在电子电气工程师协会 (IEEE) 754 浮点算术模型下，使用后向稳定方法求解线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非奇异矩阵，$b \\in \\mathbb{R}^{n}$。后向稳定性意味着计算得到的解 $\\hat{x}$ 是某个邻近问题 $(A + \\Delta A)\\hat{x} = b$ 的精确解，并满足范数界 $\\|\\Delta A\\|_{2} \\leq \\eta \\|A\\|_{2}$，其中 $\\eta$ 是一个小的非负参数，用于模拟可达到的后向误差（例如，对于机器 epsilon $\\epsilon_{\\mathrm{mach}}$，其量级为 $n \\,\\epsilon_{\\mathrm{mach}}$）。定义 $2$-范数条件数为 $\\kappa_{2}(A) = \\|A\\|_{2}\\,\\|A^{-1}\\|_{2}$。\n\n从第一性原理出发，使用后向误差分析来构造对抗性浮点输入：找到一个具体的矩阵对 $(A,b)$（对于某个 $n \\geq 2$），使得范数相对前向误差 $\\|\\hat{x}-x\\|_{2}/\\|x\\|_{2}$ 在渐近意义上达到极端条件所允许的最大值，即使该方法是后向稳定的。然后，通过确定 $b$ 与 $A$ 的奇异向量之间的何种对齐方式会在后向误差约束下使前向误差最大化，来刻画最坏情况。并推导在 $\\|A\\|_{2}=1$ 和条件数 $\\kappa_{2}(A)=\\kappa$ 固定，且假设 $0  \\kappa \\eta  1$ 的情况下，范数相对前向误差在所有矩阵对 $(A,b)$ 上的上确界。\n\n你的推导必须从后向误差和条件数的核心定义开始，并可以利用关于奇异值和范数不等式的事实。在不援引任何现成的前向误差界的情况下，论证你的对抗性构造和最坏情况刻画的合理性。最后，仅用 $\\kappa$ 和 $\\eta$ 表示，给出范数相对前向误差的上确界的闭式解析表达式（对 $\\eta$ 的所有阶都精确，而不仅是一阶）。因为答案是符号表达式，所以无需进行舍入。",
                "solution": "我们从核心定义开始。一个后向稳定的方法产生的解 $\\hat{x}$ 满足 $(A + \\Delta A)\\hat{x} = b$，且 $\\|\\Delta A\\|_{2} \\leq \\eta \\|A\\|_{2}$。精确解 $x$ 满足 $A x = b$。我们希望将前向误差 $\\hat{x} - x$ 与后向扰动 $\\Delta A$ 以及 $A$ 的条件数联系起来。\n\n从代数上讲，\n$$\n\\hat{x} = (A + \\Delta A)^{-1} b = (A + \\Delta A)^{-1} A x = \\Big( (I + A^{-1}\\Delta A)^{-1} \\Big) x,\n$$\n所以\n$$\n\\hat{x} - x = \\Big( (I + A^{-1}\\Delta A)^{-1} - I \\Big) x.\n$$\n令 $E = A^{-1}\\Delta A$。则前向误差变换为\n$$\n\\hat{x} - x = \\big( (I + E)^{-1} - I \\big) x = -(I + E)^{-1} E x.\n$$\n取 $2$-范数并利用次乘性，\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} \\leq \\|(I + E)^{-1}\\|_{2} \\cdot \\frac{\\|E x\\|_{2}}{\\|x\\|_{2}} \\leq \\|(I + E)^{-1}\\|_{2} \\cdot \\|E\\|_{2}.\n$$\n当 $\\|E\\|_{2}  1$ 时，根据预解式界可得\n$$\n\\|(I + E)^{-1}\\|_{2} \\leq \\frac{1}{1 - \\|E\\|_{2}}.\n$$\n结合起来，我们得到不等式\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} \\leq \\frac{\\|E\\|_{2}}{1 - \\|E\\|_{2}}.\n$$\n现在，\n$$\n\\|E\\|_{2} = \\|A^{-1} \\Delta A\\|_{2} \\leq \\|A^{-1}\\|_{2} \\cdot \\|\\Delta A\\|_{2} \\leq \\|A^{-1}\\|_{2} \\cdot \\eta \\|A\\|_{2} = \\kappa_{2}(A)\\,\\eta.\n$$\n在约束条件 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$ 下，我们有 $\\|E\\|_{2} \\leq \\kappa \\eta$。因此，\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} \\leq \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n这是一个上界，但我们寻求构造能达到此界的对抗性输入 $(A,b)$，从而刻画最坏情况。\n\n为此，我们利用奇异值结构。设矩阵 $A$ 有奇异值 $\\sigma_{\\max} = \\|A\\|_{2}$ 和 $\\sigma_{\\min}$，以及右奇异向量 $v_{\\min}$ 和左奇异向量 $u_{\\min}$。在约束条件 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$ 下，我们有 $\\sigma_{\\max} = 1$ 和 $\\sigma_{\\min} = 1/\\kappa$。如果我们选择 $b$ 与右奇异向量 $v_{\\min}$ 对齐，使得 $x = A^{-1} b$ 也与 $v_{\\min}$ 对齐，那么解 $x$ 将主要位于 $A$ 的最病态方向上。\n\n具体来说，取 $n = 2$，并定义\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa^{-1} \\end{pmatrix},\n$$\n这满足 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$。选择\n$$\nb = \\begin{pmatrix} 0 \\\\ \\kappa^{-1} \\end{pmatrix},\n$$\n从而精确解为\n$$\nx = A^{-1} b = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\kappa^{-1} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\n它与 $\\sigma_{\\min} = \\kappa^{-1}$ 相关联的右奇异向量对齐。\n\n接下来，我们构造一个与后向稳定性一致的扰动 $\\Delta A$，使其在同一方向上最大程度地放大前向误差。考虑秩一扰动\n$$\n\\Delta A = -\\eta\\, e_{2} e_{2}^{\\top},\n$$\n其中 $e_{2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。这个选择满足后向误差约束，因为\n$$\n\\|\\Delta A\\|_{2} = \\eta \\|e_{2} e_{2}^{\\top}\\|_{2} = \\eta \\quad \\text{且} \\quad \\|A\\|_{2} = 1 \\quad \\Rightarrow \\quad \\|\\Delta A\\|_{2} = \\eta \\|A\\|_{2}.\n$$\n此外，\n$$\nE = A^{-1} \\Delta A = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa \\end{pmatrix} \\cdot \\big( -\\eta\\, e_{2} e_{2}^{\\top} \\big) = -\\kappa \\eta\\, e_{2} e_{2}^{\\top},\n$$\n其谱范数为 $\\|E\\|_{2} = \\kappa \\eta$，并且在 $e_{2}$ 方向上的作用等同于乘以标量 $-\\kappa \\eta$。因此，\n$$\n(I + E)^{-1} = \\big( I - \\kappa \\eta\\, e_{2} e_{2}^{\\top} \\big)^{-1} = I + \\frac{\\kappa \\eta}{1 - \\kappa \\eta}\\, e_{2} e_{2}^{\\top},\n$$\n因此\n$$\n\\hat{x} = (I + E)^{-1} x = \\left( I + \\frac{\\kappa \\eta}{1 - \\kappa \\eta}\\, e_{2} e_{2}^{\\top} \\right) x = x + \\frac{\\kappa \\eta}{1 - \\kappa \\eta}\\, e_{2} e_{2}^{\\top} x.\n$$\n由于 $x$ 与 $e_{2}$ 成正比，我们得到精确的相对前向误差为\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n等价地，这也可以通过对受扰的对角矩阵求逆直接看出：\n$$\nA + \\Delta A = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa^{-1} - \\eta \\end{pmatrix}, \\quad \\hat{x} = (A + \\Delta A)^{-1} b = \\begin{pmatrix} 0 \\\\ \\dfrac{\\kappa^{-1}}{\\kappa^{-1} - \\eta} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\dfrac{1}{1 - \\kappa \\eta} \\end{pmatrix},\n$$\n所以\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\left\\| \\begin{pmatrix} 0 \\\\ \\dfrac{1}{1 - \\kappa \\eta} - 1 \\end{pmatrix} \\right\\|_{2}}{\\|\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\|_{2}} = \\frac{1}{1 - \\kappa \\eta} - 1 = \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n\n这个构造表明，对于一个显式的对抗性矩阵对 $(A,b)$，上界是可以达到的。达到极值的情况是：将 $b$ 与对应于 $\\sigma_{\\min}(A)$ 的右奇异向量对齐，同时容许的扰动 $\\Delta A$ 在同一方向上作用，以在约束 $\\|\\Delta A\\|_{2} \\leq \\eta \\|A\\|_{2}$ 下最大化 $\\|E\\|_{2}$。因此，对于所有固定的 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$，且满足 $0  \\kappa \\eta  1$ 的矩阵对 $(A,b)$，范数相对前向误差的上确界为\n$$\n\\sup \\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n在对角对抗性构造中，该表达式对 $\\eta$ 的所有阶都是精确的，并且与在一般情况下从预解式不等式推导出的最坏情况界相匹配。",
                "answer": "$$\\boxed{\\frac{\\kappa \\eta}{1 - \\kappa \\eta}}$$",
                "id": "3533519"
            },
            {
                "introduction": "前面的练习假定算法是后向稳定的，并探讨了其后果。现在，我们将深入一种具体的算法——带部分主元的高斯消去法（GEPP），来分析其后向误差的来源。本练习 [@problem_id:3533507] 构造了一个特殊的矩阵族，在该矩阵上 GEPP 会产生巨大的中间元素增长，即“增长因子”很大。通过分析这个例子，我们将看到算法的后向误差并非总是微小常数，它可能依赖于计算过程中产生的增长因子，这揭示了数值稳定性分析中一个至关重要的细节。",
                "problem": "考虑将部分主元高斯消去法 (GEPP) 应用于一族旨在表现出大元素增长的矩阵。在标准的浮点 (FP) 算术模型中进行计算，在该模型中，对于任何基本运算，有 $\\operatorname{fl}(a \\,\\circ\\, b) = (a \\,\\circ\\, b)(1+\\delta)$，其中 $|\\delta| \\le u$，$u$ 是单位舍入误差。\n\n对于每个整数 $n \\ge 2$，定义矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$，其元素 $a_{ij}$ 如下：\n- $a_{ii} = 1$ 对所有 $i \\in \\{1,\\dots,n\\}$，\n- $a_{ij} = 0$ 对所有 $1 \\le i  j \\le n-1$，\n- $a_{in} = 1$ 对所有 $1 \\le i \\le n$，\n- $a_{ij} = -1$ 对所有 $1 \\le j  i \\le n$。\n等价地，$A_n$ 是一个单位下三角矩阵，其所有严格下三角元素均为 $-1$，除了最后一列外，对角线上方的严格上三角部分均为零，且其最后一列为全1向量。\n\n采用 GEPP 的增长因子的通常定义，\n$$\n\\gamma(A_n) \\;=\\; \\frac{\\max_{k \\in \\{0,\\dots,n-1\\}} \\max_{i,j} \\left| a_{ij}^{(k)} \\right|}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $a_{ij}^{(0)} = a_{ij}$ 是 $A_n$ 的元素，$a_{ij}^{(k)}$ 是 GEPP 经过 $k$ 步消去后的矩阵元素（部分主元法在出现相同大小的最大值时选择列中第一个出现的最大绝对值元素）。\n\n任务：\n1) 从以上定义和高斯消去法的机理出发，分析 $A_n$ 在部分主元法下的主元选择，并刻画消去乘子。然后，通过对步骤索引 $k$ 进行归纳，确定在精确算术下消去过程中最后一列的演变，并推导出增长因子 $\\gamma(A_n)$ 的精确值。\n\n2) 在浮点算术下，使用对 GEPP 计算出的 $\\widehat{L}\\widehat{U}$ 因子的第一性原理后向误差分析，推导出形式为 $\\|\\Delta A\\|_{\\infty} \\le c \\, n \\, u \\, \\gamma(A_n) \\, \\|A_n\\|_{\\infty}$ 的上界，其中 $c$ 是一个与 $n$ 和 $u$ 无关的绝对常数，且 $(A_n + \\Delta A) = \\widehat{L}\\widehat{U}$。简要说明在更新递归式中，由元素增长导致的因子 $\\gamma(A_n)$ 出现的原因。\n\n3) 证明矩阵族 $\\{A_n\\}$ 在以下精确意义上基本上饱和了第 2 部分中得到的依赖于增长因子的后向误差界：存在一个右端项 $b \\in \\mathbb{R}^n$ 且 $\\|b\\|_{\\infty} = 1$，使得通过使用 $(\\widehat{L},\\widehat{U})$ 进行前向和后向代换计算出的解 $\\widehat{x}$ 满足范数后向误差\n$$\n\\eta_{\\infty}(\\widehat{x}) \\;\\equiv\\; \\min \\left\\{ \\frac{\\|\\Delta A\\|_{\\infty}}{\\|A_n\\|_{\\infty}} : (A_n + \\Delta A)\\widehat{x} = b \\right\\} \\;\\ge\\; c' \\, n \\, u \\, \\gamma(A_n),\n$$\n对于某个与 $n$ 和 $u$ 无关的绝对常数 $c' > 0$。你的证明应依赖于最大的中间 U 元素的大小及其舍入扰动。\n\n作为你的最终答案，提供增长因子 $\\gamma(A_n)$ 作为 $n$ 的函数的精确闭式表达式。不需要进行数值舍入，也不涉及物理单位。",
                "solution": "问题要求对特定矩阵族 $A_n$ 上的部分主元高斯消去法 (GEPP) 进行分析，包括计算增长因子、推导后向误差界，并证明该界是紧的。\n\n### 第 1 部分：GEPP 分析及增长因子 $\\gamma(A_n)$ 的计算\n\n我们首先在精确算术下分析 $A_n$ 的结构和 GEPP 的过程。矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$ 定义如下：\n- $a_{ii} = 1$ 对所有 $i \\in \\{1,\\dots,n\\}$\n- $a_{ij} = -1$ 对所有 $1 \\le j  i \\le n$\n- $a_{in} = 1$ 对所有 $1 \\le i \\le n$\n- $a_{ij} = 0$ 对所有 $1 \\le i  j \\le n-1$\n\n例如，对于 $n=4$：\n$$ A_4 = \\begin{pmatrix}\n1  0  0  1 \\\\\n-1  1  0  1 \\\\\n-1  -1  1  1 \\\\\n-1  -1  -1  1\n\\end{pmatrix} $$\n$A_n$ 中任意元素的最大绝对值为 $\\max_{i,j} |a_{ij}| = 1$。\n\n我们将跟踪经过 $k$ 步消去后的矩阵元素 $a_{ij}^{(k)}$。令 $A^{(0)} = A_n$。\n\n**步骤 $k=1$**：\n第一列是 $(1, -1, -1, \\dots, -1)^T$。最大绝对值为 1。根据指定的决胜规则（选择第一个出现的），主元是 $a_{11}^{(0)} = 1$。不需要行交换。\n对于 $i \\in \\{2, \\dots, n\\}$ 的乘子是 $m_{i1} = a_{i1}^{(0)}/a_{11}^{(0)} = -1/1 = -1$。\n对于 $i,j \\ge 2$ 的子矩阵元素更新如下：\n$a_{ij}^{(1)} = a_{ij}^{(0)} - m_{i1} a_{1j}^{(0)} = a_{ij} + a_{1j}$。\n- 对于 $j \\in \\{2, \\dots, n-1\\}$，我们有 $a_{1j} = 0$，因此 $a_{ij}^{(1)} = a_{ij}$。\n- 对于 $j=n$，我们有 $a_{1n} = 1$，因此对于 $i \\in \\{2, \\dots, n\\}$，$a_{in}^{(1)} = a_{in} + a_{1n} = 1+1=2$。\n\n经过一步后，矩阵 $A_n^{(1)}$ 的形式为：\n$$ A_n^{(1)} = \\begin{pmatrix}\n1  0  \\dots  0  1 \\\\\n0        2 \\\\\n\\vdots    \\text{submatrix}   \\vdots \\\\\n0        2\n\\end{pmatrix} $$\n下一步的活动子矩阵 $A_{2:n, 2:n}^{(1)}$ 在其前 $n-2$ 列中具有与 $A_{n-1}$ 相同的结构，但其最后一列完全由 2 组成。\n\n**归纳步骤**：\n我们为第 $k$ 步开始时（即在 $A_n^{(k-1)}$ 中）的活动子矩阵的结构建立一个归纳假设，对于 $k \\in \\{1, \\dots, n-1\\}$。\n假设：活动子矩阵 $A_{k:n, k:n}^{(k-1)}$ 的元素为：\n- $a_{ii}^{(k-1)} = 1$ 对所有 $i \\in \\{k, \\dots, n-1\\}$\n- $a_{ij}^{(k-1)} = -1$ 对所有 $k \\le j  i \\le n$\n- $a_{ij}^{(k-1)} = 0$ 对所有 $k \\le i  j \\le n-1$\n- $a_{in}^{(k-1)} = 2^{k-1}$ 对所有 $i \\in \\{k, \\dots, n\\}$\n\n**基本情况 ($k=1$)**：活动子矩阵是 $A_n$ 本身。假设对于 $2^{1-1}=1$ 成立。\n\n**归纳步骤**：假设该假设对步骤 $k$ 成立。活动子矩阵的主元列是 $(a_{kk}^{(k-1)}, \\dots, a_{nk}^{(k-1)})^T = (1, -1, \\dots, -1)^T$。主元元素是 $a_{kk}^{(k-1)}=1$。不需要行交换。\n对于 $i \\in \\{k+1, \\dots, n\\}$ 的乘子是 $m_{ik} = a_{ik}^{(k-1)}/a_{kk}^{(k-1)} = -1/1 = -1$。\n新活动子矩阵 ($i,j \\ge k+1$) 的更新为：\n$a_{ij}^{(k)} = a_{ij}^{(k-1)} - m_{ik} a_{kj}^{(k-1)} = a_{ij}^{(k-1)} + a_{kj}^{(k-1)}$。\n- 对于 $j \\in \\{k+1, \\dots, n-1\\}$，$a_{kj}^{(k-1)}=0$ 根据假设。因此，$a_{ij}^{(k)} = a_{ij}^{(k-1)}$，保持了结构。\n- 对于 $j=n$，$a_{kn}^{(k-1)} = 2^{k-1}$ 根据假设。对于 $i \\in \\{k+1, \\dots, n\\}$，更新为 $a_{in}^{(k)} = a_{in}^{(k-1)} + a_{kn}^{(k-1)} = 2^{k-1} + 2^{k-1} = 2^k$。\n该假设对步骤 $k+1$ 成立。归纳完成。\n\n该归纳表明，在每一步 $k \\in \\{1, \\dots, n-1\\}$ 中，产生的最大元素是 $2^k$，它出现在最后一列。整个过程中的最大元素绝对值是在最后一步 $k=n-1$ 产生的。该元素是 $a_{nn}^{(n-1)}$。\n从 $k=n-1$ 的归纳步骤可知：\n$a_{nn}^{(n-1)} = a_{nn}^{(n-2)} + a_{n-1,n}^{(n-2)} = 2^{n-2} + 2^{n-2} = 2^{n-1}$。\n最终的上三角矩阵 $U=A_n^{(n-1)}$ 是：\n$$ U = \\begin{pmatrix}\n1  0  \\dots  0  1 \\\\\n0  1   \\dots  0  2 \\\\\n\\vdots   \\ddots  \\vdots \\\\\n0  0  \\dots  1  2^{n-2} \\\\\n0  0  \\dots   0  2^{n-1}\n\\end{pmatrix} $$\n所有中间矩阵中任意元素的最大绝对值是 $\\max_{k,i,j} |a_{ij}^{(k)}| = 2^{n-1}$。\n增长因子的定义为：\n$$ \\gamma(A_n) = \\frac{\\max_{k,i,j} |a_{ij}^{(k)}|}{\\max_{i,j} |a_{ij}|} $$\n我们有 $\\max_{i,j} |a_{ij}| = 1$。因此，增长因子是：\n$$ \\gamma(A_n) = \\frac{2^{n-1}}{1} = 2^{n-1} $$\n\n### 第 2 部分：后向误差界\n\n我们使用标准的浮点算术模型。计算出的因子 $\\widehat{L}$ 和 $\\widehat{U}$ 满足 $A_n + \\Delta A = \\widehat{L}\\widehat{U}$（因为没有进行主元交换，所以 $P=I$）。后向误差分析的一个标准结果给出了误差矩阵 $\\Delta A$ 的逐元素界：\n$$ |\\Delta A| \\le \\frac{nu}{1-nu} |\\widehat{L}||\\widehat{U}| $$\n其中 $|\\cdot|$ 表示绝对值矩阵，$u$ 是单位舍入误差。对于小的 $nu$，我们可以将其近似为 $|\\Delta A| \\le nu |\\widehat{L}||\\widehat{U}|$。\n因子 $\\gamma(A_n)$ 出现在后向误差界中的原因在于浮点误差的累积方式。在 GEPP 中，消去步骤的递归更新形式为 $a_{ij}^{(k)} = a_{ij}^{(k-1)} - m_{ik} a_{kj}^{(k-1)}$。在浮点算术中，此操作产生的舍入误差与操作数的大小成正比。增长因子 $\\gamma(A_n)$ 正是用来衡量这些中间元素 $a_{ij}^{(k)}$ 可能达到的最大幅度（相对于原始矩阵元素）。由于计算出的上三角矩阵 $\\widehat{U}$ 的元素就是最终的 $a_{ij}^{(k-1)}$，其最大值由增长因子控制，即 $\\max_{i,j}|\\widehat{u}_{ij}| \\approx \\gamma(A_n) \\|A_n\\|_{\\infty}$。同时，由于部分主元法保证了乘子的大小 $|m_{ik}| \\le 1$，所以计算出的下三角矩阵 $|\\widehat{L}|$ 的元素都小于等于1。这些因素共同作用，导致最终累积的后向误差 $\\|\\Delta A\\|_{\\infty}$ 的上界与 $n \\cdot u \\cdot \\gamma(A_n)$ 成正比。\n\n### 第 3 部分：误差界的饱和\n\n为了证明该界是紧的，我们需要构造一个右侧项 $b$，使得计算出的解 $\\widehat{x}$ 的后向误差确实达到 $\\mathcal{O}(n u \\gamma(A_n))$ 的量级。\n考虑解线性系统 $A_n x = b$。这等价于求解 $LUx=b$，通过两步完成：前向代换解 $Ly=b$，然后后向代换解 $Ux=y$。在浮点数中，我们解 $\\widehat{L}\\widehat{U}\\widehat{x}=b$。\n最大的舍入误差发生在计算 $U$ 的最后一个元素 $u_{nn}=2^{n-1}$ 时。这个计算值 $\\widehat{u}_{nn}$ 将会是 $\\widehat{u}_{nn} = 2^{n-1}(1+\\delta_{total})$，其中 $\\delta_{total}$ 是累积的相对舍入误差，量级为 $\\mathcal{O}(nu)$。这意味着 $\\widehat{u}_{nn} - u_{nn}$ 的绝对误差量级为 $u \\cdot n \\cdot 2^{n-1} = u \\cdot n \\cdot \\gamma(A_n)$。\n现在，我们选择一个 $b$ 来放大这个误差。如果我们选择 $b$ 使得 $x$ 的最后一个分量 $x_n$ 不为零，那么在后向代换的最后一步计算 $x_n$ 时，这个在 $\\widehat{u}_{nn}$ 中的巨大误差就会直接影响到 $x_n$ 的计算。\n设 $b = e_n = (0, \\dots, 0, 1)^T$。通过前向代换解 $Ly=e_n$ 得到 $y_1=0, \\dots, y_{n-1}=0, y_n=1$（因为 $L$ 是单位下三角矩阵）。然后，通过后向代换解 $Ux=y$。最后一步是 $u_{nn}x_n=y_n$，即 $2^{n-1}x_n=1$，所以 $x_n = 2^{-(n-1)}$。\n在浮点计算中，我们有 $\\widehat{u}_{nn}\\widehat{x}_n \\approx y_n=1$。因此 $\\widehat{x}_n \\approx 1/\\widehat{u}_{nn} \\approx 1/(u_{nn}(1+\\mathcal{O}(nu))) \\approx x_n(1-\\mathcal{O}(nu))$。\n这个解 $\\widehat{x}$ 的范数后向误差 $\\eta_{\\infty}(\\widehat{x})$ 定义为 $\\frac{\\|b-A_n \\widehat{x}\\|_{\\infty}}{\\|A_n\\|_{\\infty}\\|\\widehat{x}\\|_{\\infty}}$。残差 $r=b-A_n \\widehat{x}$ 的最后一个分量 $r_n$ 会反映出 $\\widehat{u}_{nn}$ 的误差，其大小与 $u \\cdot n \\cdot \\gamma(A_n)$ 成比例，从而证明后向误差界是被饱和的。因此，存在一个常数 $c'$ 使得该下界成立。",
                "answer": "$$\\boxed{2^{n-1}}$$",
                "id": "3533507"
            }
        ]
    }