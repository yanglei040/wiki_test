{
    "hands_on_practices": [
        {
            "introduction": "The best way to understand the predictor-corrector mechanism is to perform a calculation by hand. This first exercise provides a gentle introduction to the two-stage process using one of the simplest combinations: the Forward Euler method as the predictor and the trapezoidal rule as the corrector. By working through a single step, you will gain a concrete understanding of how a preliminary, rough prediction is refined to produce a more accurate final value .",
            "id": "2194236",
            "problem": "Consider the initial value problem defined by the ordinary differential equation:\n$$ y' = x^2 - y^2 $$\nwith the initial condition $y(0) = 1$.\n\nYour task is to approximate the value of $y(0.1)$ by performing a single step of the Euler predictor-trapezoidal corrector method. Use a step size of $h=0.1$.\n\nRound your final answer to four significant figures.",
            "solution": "We define the differential equation as $y' = f(x,y)$ with $f(x,y) = x^{2} - y^{2}$ and initial condition $y(0) = 1$. Let $h = 0.1$, $x_{0} = 0$, and $x_{1} = x_{0} + h = 0.1$.\n\nThe Euler predictor is given by\n$$\ny_{1}^{(p)} = y_{0} + h\\,f(x_{0},y_{0}).\n$$\nCompute\n$$\nf(x_{0},y_{0}) = f(0,1) = 0^{2} - 1^{2} = -1,\n$$\nso\n$$\ny_{1}^{(p)} = 1 + 0.1(-1) = 0.9.\n$$\n\nThe trapezoidal corrector (one correction using the predictor) is\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left[f(x_{0},y_{0}) + f(x_{1},y_{1}^{(p)})\\right].\n$$\nEvaluate\n$$\nf(x_{1},y_{1}^{(p)}) = f(0.1,0.9) = (0.1)^{2} - (0.9)^{2} = 0.01 - 0.81 = -0.8.\n$$\nThus\n$$\ny_{1} = 1 + \\frac{0.1}{2}\\left[(-1) + (-0.8)\\right] = 1 + 0.05(-1.8) = 1 - 0.09 = 0.91.\n$$\n\nRounding to four significant figures gives $0.9100$.",
            "answer": "$$\\boxed{0.9100}$$"
        },
        {
            "introduction": "A powerful numerical method does more than just produce a number; it should, as much as possible, respect the fundamental laws of the system it models. This practice challenges you to analyze the behavior of a predictor-corrector method when applied to a simple harmonic oscillator, a system with conserved energy. By examining how the numerical energy changes over a single step, you will uncover important characteristics of the method's long-term fidelity and learn how numerical choices can introduce artificial energy drift into a simulation .",
            "id": "2194239",
            "problem": "In computational physics, a critical test for any numerical integration algorithm is its ability to respect the conservation laws of the continuous physical system it aims to model. Consider the simple harmonic oscillator, a fundamental model in physics, described by the second-order differential equation $\\frac{d^2x}{dt^2} = -x$. This can be expressed as a system of two first-order ordinary differential equations:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\nwhere $x$ is the position and $v$ is the velocity. For this continuous system, the total energy, defined as $E = \\frac{1}{2}(v^2 + x^2)$, is a conserved quantity.\n\nWe wish to investigate the energy conservation properties of a specific numerical method, the Euler-Trapezoid predictor-corrector method. To advance the solution from a time $t_n$ to $t_{n+1} = t_n + h$, where $h$ is the step size, the method proceeds in two stages:\n\n1.  **Predictor Stage**: First, an intermediate, predicted state $(\\tilde{x}_{n+1}, \\tilde{v}_{n+1})$ is calculated using a single forward Euler step from the state $(x_n, v_n)$:\n    $$\n    \\tilde{x}_{n+1} = x_n + h \\cdot v_n\n    $$\n    $$\n    \\tilde{v}_{n+1} = v_n + h \\cdot (-x_n)\n    $$\n2.  **Corrector Stage**: The final state $(x_{n+1}, v_{n+1})$ is then computed by applying the trapezoidal rule, which averages the derivative at the beginning of the step, $(v_n, -x_n)$, and the derivative at the predicted end of the step, $(\\tilde{v}_{n+1}, -\\tilde{x}_{n+1})$:\n    $$\n    x_{n+1} = x_n + \\frac{h}{2}(v_n + \\tilde{v}_{n+1})\n    $$\n    $$\n    v_{n+1} = v_n + \\frac{h}{2}(-x_n - \\tilde{x}_{n+1})\n    $$\n\nLet $E_n = \\frac{1}{2}(v_n^2 + x_n^2)$ be the numerical energy of the system at step $n$. After a single step of this predictor-corrector method with step size $h$, the energy will change to $E_{n+1} = \\frac{1}{2}(v_{n+1}^2 + x_{n+1}^2)$.\n\nAssuming the initial state $(x_n, v_n)$ is not the origin, determine the ratio of the energy after one step to the initial energy, $E_{n+1}/E_n$, as a function of the step size $h$.",
            "solution": "We start from the given predictor-corrector scheme for the system $x' = v$, $v' = -x$.\n\nPredictor stage:\n$$\n\\tilde{x}_{n+1} = x_{n} + h v_{n}, \\qquad \\tilde{v}_{n+1} = v_{n} - h x_{n}.\n$$\n\nCorrector stage:\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + \\tilde{v}_{n+1}\\right), \\qquad v_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - \\tilde{x}_{n+1}\\right).\n$$\nSubstituting the predictor values into the corrector gives\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + v_{n} - h x_{n}\\right) = \\left(1 - \\frac{h^{2}}{2}\\right)x_{n} + h v_{n},\n$$\n$$\nv_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - (x_{n} + h v_{n})\\right) = -h x_{n} + \\left(1 - \\frac{h^{2}}{2}\\right)v_{n}.\n$$\n\nThus the one-step update can be written in matrix form as\n$$\n\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix} 1 - \\frac{h^{2}}{2}  h \\\\ -h  1 - \\frac{h^{2}}{2} \\end{pmatrix}}_{M}\n\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.\n$$\nLet $a = 1 - \\frac{h^{2}}{2}$ and $b = h$. Then $M = a I + b J$ with\n$$\nI = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\qquad J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}.\n$$\nNote the properties $J^{T} = -J$ and $J^{2} = -I$. Compute\n$$\nM^{T}M = (a I - b J)(a I + b J) = a^{2} I - b^{2} J^{2} = (a^{2} + b^{2}) I.\n$$\nFor any state vector $w_{n} = \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$, this implies\n$$\nx_{n+1}^{2} + v_{n+1}^{2} = \\|w_{n+1}\\|^{2} = w_{n}^{T} M^{T} M w_{n} = (a^{2} + b^{2}) \\|w_{n}\\|^{2} = (a^{2} + b^{2})(x_{n}^{2} + v_{n}^{2}).\n$$\nWith $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$, we get\n$$\n\\frac{E_{n+1}}{E_{n}} = \\frac{\\frac{1}{2}(x_{n+1}^{2} + v_{n+1}^{2})}{\\frac{1}{2}(x_{n}^{2} + v_{n}^{2})} = a^{2} + b^{2}.\n$$\nSubstituting $a = 1 - \\frac{h^{2}}{2}$ and $b = h$,\n$$\na^{2} + b^{2} = \\left(1 - \\frac{h^{2}}{2}\\right)^{2} + h^{2} = 1 - h^{2} + \\frac{h^{4}}{4} + h^{2} = 1 + \\frac{h^{4}}{4}.\n$$\nSince $(x_{n}, v_{n}) \\neq (0,0)$ by assumption, the ratio is well-defined and independent of the particular initial state.\n\nTherefore,\n$$\n\\frac{E_{n+1}}{E_{n}} = 1 + \\frac{h^{4}}{4}.\n$$",
            "answer": "$$\\boxed{1+\\frac{h^{4}}{4}}$$"
        },
        {
            "introduction": "The effectiveness of a predictor-corrector method depends critically on the choice of step size, especially for certain types of problems. This exercise demonstrates the crucial concept of numerical stability by showing what happens when a method is pushed beyond its limits. You will apply an iterative corrector to a \"stiff\" differential equation with a step size that is too large and observe that the successive corrections fail to converge, providing a dramatic illustration of why stability analysis is as important as accuracy analysis .",
            "id": "2194248",
            "problem": "Consider a simplified model for a self-regulating thermal component where the temperature deviation from the ambient, $y(t)$, decays over time. The dynamics are described by the initial value problem (IVP):\n$$ \\frac{dy}{dt} = -15 y, \\quad y(0) = 1 $$\nWe wish to approximate the solution at time $t_1 = h$ using an iterative corrector method based on the trapezoidal rule. The process for a single time step from $t_n$ to $t_{n+1} = t_n + h$ is as follows:\n\n1.  A preliminary prediction for $y_{n+1}$, which we will call $y_{n+1}^{(0)}$, is obtained using the explicit Forward Euler method: $y_{n+1}^{(0)} = y_n + h f(t_n, y_n)$, where $f(t, y) = -15y$.\n2.  This prediction is then refined by repeatedly applying the trapezoidal corrector formula, which defines a sequence $y_{n+1}^{(k)}$ for $k=1, 2, 3, \\ldots$:\n    $$ y_{n+1}^{(k)} = y_n + \\frac{h}{2} \\left( f(t_n, y_n) + f(t_{n+1}, y_{n+1}^{(k-1)}) \\right) $$\n\nUsing a step size of $h = 0.2$, and starting from the known value $y_0 = y(0) = 1$, calculate the value of the third corrector iterate, $y_1^{(3)}$.\n\nRound your final answer to four significant figures.",
            "solution": "We have the IVP $y^{\\prime}=-15y$, $y(0)=1$, step size $h=0.2$, and $f(t,y)=-15y$.\n\nPredictor (Forward Euler):\n$$\ny_{1}^{(0)}=y_{0}+h f(t_{0},y_{0})=y_{0}-15hy_{0}.\n$$\nWith $y_{0}=1$ and $h=0.2$,\n$$\ny_{1}^{(0)}=1-15\\cdot 0.2\\cdot 1=1-3=-2.\n$$\n\nCorrector (trapezoidal iteration):\n$$\ny_{1}^{(k)}=y_{0}+\\frac{h}{2}\\left(f(t_{0},y_{0})+f(t_{1},y_{1}^{(k-1)})\\right)=y_{0}-\\frac{15h}{2}\\left(y_{0}+y_{1}^{(k-1)}\\right).\n$$\nSubstituting $y_{0}=1$ and $h=0.2$ gives\n$$\ny_{1}^{(k)}=1-\\frac{15\\cdot 0.2}{2}\\left(1+y_{1}^{(k-1)}\\right)=1-\\frac{3}{2}\\left(1+y_{1}^{(k-1)}\\right)=-\\frac{1}{2}-\\frac{3}{2}\\,y_{1}^{(k-1)}.\n$$\n\nIterates:\n- For $k=1$:\n$$\ny_{1}^{(1)}=-\\frac{1}{2}-\\frac{3}{2}\\left(-2\\right)=-\\frac{1}{2}+3=\\frac{5}{2}=2.5.\n$$\n- For $k=2$:\n$$\ny_{1}^{(2)}=-\\frac{1}{2}-\\frac{3}{2}\\cdot\\frac{5}{2}=-\\frac{1}{2}-\\frac{15}{4}=-\\frac{17}{4}=-4.25.\n$$\n- For $k=3$:\n$$\ny_{1}^{(3)}=-\\frac{1}{2}-\\frac{3}{2}\\left(-\\frac{17}{4}\\right)=-\\frac{1}{2}+\\frac{51}{8}=\\frac{47}{8}=5.875.\n$$\n\nRounded to four significant figures, $y_{1}^{(3)}=5.875$.",
            "answer": "$$\\boxed{5.875}$$"
        }
    ]
}