{
    "hands_on_practices": [
        {
            "introduction": "理论是骨架，实践是血肉。让我们通过一个基础练习开始，亲手实现龙贝格积分法。我们将从一个我们熟知的积分 $\\int_0^{\\pi} \\sin(x) dx$ 入手，通过计算最初几项梯形法则近似值，并进行第一次理查森外推，来直观感受龙贝格积分是如何通过简单的低阶方法组合，显著提高计算精度的。这项练习将为你掌握该方法的核心机制奠定坚实的基础 。",
            "id": "2198712",
            "problem": "考虑定积分 $I = \\int_0^{\\pi} \\sin(x) dx$ 的数值计算，其中正弦函数的参数以弧度为单位。我们将使用龙贝格积分法（Romberg integration）来近似其值。龙贝格积分表是使用以下递推公式构建的：\n$$R_{k, j} = \\frac{4^{j-1} R_{k, j-1} - R_{k-1, j-1}}{4^{j-1} - 1}$$\n对于 $k \\ge 2$ 和 $j \\ge 2$。第一列，$R_{k,1}$（对于 $k \\ge 1$），是使用复合梯形法则计算的，其中包含 $n = 2^{k-1}$ 个子区间。对于一个积分 $\\int_a^b f(x) dx$，使用 $n$ 个宽度为 $h=(b-a)/n$ 的子区间的复合梯形法则由下式给出：\n$$T_n = \\frac{h}{2} \\left[f(a) + 2\\sum_{i=1}^{n-1} f(a+ih) + f(b)\\right]$$\n并且我们设 $R_{k,1} = T_{2^{k-1}}$。\n\n您的任务是计算给定积分的近似值 $R_{2,2}$。将您的答案报告为四舍五入到四位有效数字的数值。",
            "solution": "问题要求计算积分 $I = \\int_0^{\\pi} \\sin(x) dx$ 的龙贝格积分近似值 $R_{2,2}$。为了求出 $R_{2,2}$，我们首先需要计算梯形近似值 $R_{1,1}$ 和 $R_{2,1}$。\n\n**步骤 1：计算 $R_{1,1}$**\n$R_{1,1}$ 对应于使用 $n = 2^{1-1} = 1$ 个子区间的复合梯形法则。\n区间为 $[a, b] = [0, \\pi]$。\n步长为 $h = \\frac{b-a}{n} = \\frac{\\pi-0}{1} = \\pi$。\n使用一个子区间的梯形法则公式为：\n$$R_{1,1} = T_1 = \\frac{h}{2}[f(a) + f(b)]$$\n代入 $f(x) = \\sin(x)$，$a=0$，$b=\\pi$ 和 $h=\\pi$ 的值：\n$$R_{1,1} = \\frac{\\pi}{2}[\\sin(0) + \\sin(\\pi)]$$\n由于 $\\sin(0) = 0$ 且 $\\sin(\\pi) = 0$，我们有：\n$$R_{1,1} = \\frac{\\pi}{2}[0 + 0] = 0$$\n\n**步骤 2：计算 $R_{2,1}$**\n$R_{2,1}$ 对应于使用 $n = 2^{2-1} = 2$ 个子区间的复合梯形法则。\n步长为 $h = \\frac{b-a}{n} = \\frac{\\pi-0}{2} = \\frac{\\pi}{2}$。\n求值点为 $x_0 = 0$，$x_1 = 0+h = \\frac{\\pi}{2}$ 和 $x_2 = 0+2h = \\pi$。\n使用两个子区间的复合梯形法则公式为：\n$$R_{2,1} = T_2 = \\frac{h}{2}[f(x_0) + 2f(x_1) + f(x_2)]$$\n代入数值：\n$$R_{2,1} = \\frac{\\pi/2}{2}\\left[\\sin(0) + 2\\sin\\left(\\frac{\\pi}{2}\\right) + \\sin(\\pi)\\right]$$\n由于 $\\sin(0) = 0$，$\\sin(\\frac{\\pi}{2}) = 1$ 且 $\\sin(\\pi) = 0$，我们得到：\n$$R_{2,1} = \\frac{\\pi}{4}[0 + 2(1) + 0] = \\frac{\\pi}{4}(2) = \\frac{\\pi}{2}$$\n\n**步骤 3：计算 $R_{2,2}$**\n现在我们使用问题陈述中提供的龙贝格外推公式来求 $R_{2,2}$。对于 $k=2$ 和 $j=2$，公式为：\n$$R_{2,2} = \\frac{4^{2-1} R_{2, 2-1} - R_{2-1, 2-1}}{4^{2-1} - 1} = \\frac{4R_{2,1} - R_{1,1}}{3}$$\n代入先前计算出的值 $R_{1,1}=0$ 和 $R_{2,1}=\\frac{\\pi}{2}$：\n$$R_{2,2} = \\frac{4\\left(\\frac{\\pi}{2}\\right) - 0}{3} = \\frac{2\\pi}{3}$$\n\n**步骤 4：数值计算与四舍五入**\n最后，我们计算其数值，并按要求四舍五入到四位有效数字。\n$$R_{2,2} = \\frac{2\\pi}{3} \\approx \\frac{2 \\times 3.14159265...}{3} \\approx 2.0943951...$$\n四舍五入到四位有效数字，我们看第五位数字。由于它是 3（小于 5），我们向下舍入。\n$$R_{2,2} \\approx 2.094$$",
            "answer": "$$\\boxed{2.094}$$"
        },
        {
            "introduction": "在掌握了基本步骤后，我们将进入一个更接近实际工程应用的场景。这个练习要求我们为函数 $f(t) = (1 + \\sin^2(\\pi t)) \\exp(-0.5 t)$ 计算龙贝格积分表中的 $R(2, 2)$ 项，这需要我们系统地构建一个包含多项近似值的表格。通过这个过程，你将熟练掌握龙贝格算法的递归流程，并体会到逐次外推在求解复杂积分时展现出的强大威力 。",
            "id": "2198775",
            "problem": "一位工程师正在为一个新型机器人执行器的能耗建模。在短时间间隔内，该执行器消耗的瞬时功率 $P(t)$ 由函数 $P(t) = P_0 f(t)$ 描述，其中 $f(t) = (1 + \\sin^2(\\pi t)) \\exp(-0.5 t)$，时间 $t$ 的单位为秒。为了精确确定从 $t=0$ 到 $t=1$ 秒时间段内消耗的总能量，该工程师需要计算无量纲积分 $I = \\int_0^1 f(t) dt$。\n\n该工程师决定使用 Romberg 积分来近似这个积分。Romberg 积分表，记为 $R(i, j)$，按如下方式构造：\n1.  第一列，$R(i, 0)$（对于 $i \\ge 0$），包含由复合梯形法则得到的近似值。具体来说，$R(i, 0)$ 是使用 $n = 2^i$ 个子区间的复合梯形法则的结果。\n2.  后续各列（对于 $j \\ge 1$），使用 Richardson 外推公式生成：\n    $$R(i, j) = R(i, j-1) + \\frac{R(i, j-1) - R(i-1, j-1)}{4^j - 1}$$\n    对于 $i \\ge j \\ge 1$。\n\n您的任务是计算 Romberg 积分表中的表项 $R(2, 2)$ 的值。将您的最终答案四舍五入到五位有效数字。",
            "solution": "我们需要通过 Romberg 积分计算 $I=\\int_{0}^{1} f(t)\\,dt$ 的 $R(2,2)$，其中 $f(t)=(1+\\sin^{2}(\\pi t))\\exp(-0.5\\,t)$。\n\n首先，计算当 $i=0,1,2$ 时复合梯形近似值 $R(i,0)$。\n- 对于 $i=0$（一个区间），$h=1$，节点为 $t_{0}=0$，$t_{1}=1$：\n$$\nf(0)=(1+\\sin^{2}(0))\\exp(0)=1,\\quad f(1)=(1+\\sin^{2}(\\pi))\\exp(-0.5)=\\exp(-0.5).\n$$\n因此\n$$\nR(0,0)=\\frac{h}{2}\\left[f(0)+f(1)\\right]=\\frac{1}{2}\\left(1+\\exp(-0.5)\\right).\n$$\n- 对于 $i=1$（$n=2$），$h=\\frac{1}{2}$，节点为 $t=0,\\frac{1}{2},1$：\n$$\nf\\!\\left(\\tfrac{1}{2}\\right)=(1+\\sin^{2}(\\tfrac{\\pi}{2}))\\exp(-0.25)=2\\,\\exp(-0.25).\n$$\n因此\n$$\nR(1,0)=\\frac{h}{2}\\left[f(0)+2f\\!\\left(\\tfrac{1}{2}\\right)+f(1)\\right]\n=\\frac{1}{4}\\left(1+4\\exp(-0.25)+\\exp(-0.5)\\right).\n$$\n- 对于 $i=2$（$n=4$），$h=\\frac{1}{4}$，节点为 $t=0,\\frac{1}{4},\\frac{1}{2},\\frac{3}{4},1$：\n$$\nf\\!\\left(\\tfrac{1}{4}\\right)=\\left(1+\\sin^{2}\\!\\left(\\tfrac{\\pi}{4}\\right)\\right)\\exp(-0.125)=\\frac{3}{2}\\exp(-0.125),\n$$\n$$\nf\\!\\left(\\tfrac{3}{4}\\right)=\\left(1+\\sin^{2}\\!\\left(\\tfrac{3\\pi}{4}\\right)\\right)\\exp(-0.375)=\\frac{3}{2}\\exp(-0.375),\n$$\n以及如上所示的 $f(0)$, $f(\\tfrac{1}{2})$, $f(1)$。那么\n$$\nR(2,0)=\\frac{h}{2}\\left[f(0)+2\\left(f\\!\\left(\\tfrac{1}{4}\\right)+f\\!\\left(\\tfrac{1}{2}\\right)+f\\!\\left(\\tfrac{3}{4}\\right)\\right)+f(1)\\right]\n=\\frac{1}{8}\\left(1+3\\exp(-0.125)+4\\exp(-0.25)+3\\exp(-0.375)+\\exp(-0.5)\\right).\n$$\n\n接下来，应用 Richardson 外推法：\n$$\nR(i,j)=R(i,j-1)+\\frac{R(i,j-1)-R(i-1,j-1)}{4^{j}-1},\\quad i\\geq j\\geq 1.\n$$\n因此，\n$$\nR(1,1)=R(1,0)+\\frac{R(1,0)-R(0,0)}{3},\\qquad\nR(2,1)=R(2,0)+\\frac{R(2,0)-R(1,0)}{3},\n$$\n$$\nR(2,2)=R(2,1)+\\frac{R(2,1)-R(1,1)}{15}.\n$$\n\n现在进行数值计算（使用 $\\exp(-0.125)\\approx 0.8824969025845954$, $\\exp(-0.25)\\approx 0.7788007830714049$, $\\exp(-0.375)\\approx 0.6872892787909722$, $\\exp(-0.5)\\approx 0.6065306597126334$）：\n$R(0,0)\\approx 0.8032653298563167,\\quad R(1,0)\\approx 1.1804334479995632,\\quad R(2,0)\\approx 1.1788865420156195,$\n$R(1,1)\\approx 1.3061561540473120,\\quad R(2,1)\\approx 1.1783709066876382,$\n$R(2,2)\\approx 1.1698518901969933.$\n\n四舍五入到五位有效数字得到 $1.1699$。",
            "answer": "$$\\boxed{1.1699}$$"
        },
        {
            "introduction": "任何强大的数值方法都有其适用范围和前提假设。这项高级练习将引导我们超越机械的计算，转向对方法本身的批判性思考。我们将分析当被积函数不满足光滑性条件时（例如在积分端点存在奇点），为什么龙贝格积分会失效。更重要的是，我们将学习如何通过巧妙的变量替换来“修复”这个问题，从而恢复算法的高阶收敛性。这不仅是一次计算练习，更是一次培养诊断问题和调整策略能力的机会，这是从新手到专家的关键一步 。",
            "id": "3268261",
            "problem": "考虑积分 $I=\\int_{0}^{1}\\sqrt{x}\\,\\sin(x)\\,dx$ 以及应用龙贝格积分法来近似 $I$。龙贝格积分法是通过对复合梯形法则在步长逐次减半的情况下应用理查森外推得到的，它依赖于这样一个假设：在被积函数于 $[0,1]$ 上足够光滑的条件下，复合梯形法则的误差在步长 $h$ 上具有规则的渐近结构。仅使用此定义以及被积函数形式在端点附近所暗示的导数行为，从基本原理出发，推断这些光滑性条件是否满足，以及 $h$ 的误差结构如何受到影响。然后，确定一个变量代换，以恢复在 $[0,1]$ 上实现龙贝格高阶收敛所需的可微性。\n\n哪个选项正确解释了观察到的龙贝格积分未能达到其标称的偶数阶序列的原因，并提出了一个有效的变量代换来恢复高阶收敛？\n\n- A. 龙贝格积分法失败是因为被积函数在 $[0,1]$ 上不是周期性的，这使得外推所需的端点相消无效。使用 $x=\\sin^{2}(t)$ 来强制实现类似周期性的端点行为，然后在 $[0,\\pi/2]$ 上对 $t$ 应用龙贝格积分法。\n\n- B. 龙贝格积分法失败是因为被积函数的高阶导数在 $x=0$ 处无界，因此梯形法则的误差包含 $h$ 的非整数次幂，而标准外推法无法在一系列偶数次幂的层级中将其消除。使用代数去奇点代换 $x=t^{2}$ 得到 $\\int_{0}^{1}2t^{2}\\sin(t^{2})\\,dt$，然后在 $t\\in[0,1]$ 上对 $t$ 应用龙贝格积分法。\n\n- C. 龙贝格积分法失败是因为 $\\sin(x)$ 产生的振荡需要使用渐近振荡积分法。使用代换 $x=\\ln(t)$ 转换区间后，采用驻相法，然后对变换后的积分应用龙贝格积分法。\n\n- D. 龙贝格积分法失败是因为在 $x=1$ 处有一个尖点，它破坏了误差展开中的边界项。使用 $x=1-t^{2}$ 来平滑右端点的行为，然后在 $t\\in[0,1]$ 上对 $t$ 应用龙贝格积分法。",
            "solution": "问题要求分析龙贝格积分法对积分 $I=\\int_{0}^{1}\\sqrt{x}\\,\\sin(x)\\,dx$ 失败的原因，并寻找一个合适的变量代换来恢复其高阶收敛性。\n\n龙贝格积分法的核心原理是对复合梯形法则应用理查森外推。这种外推的成功取决于梯形法则的误差 $E_T(h)$ 是否具有一个关于步长 $h$ 的偶数次幂的特定渐近展开式。该展开式由欧拉-麦克劳林公式给出。对于一个积分 $I = \\int_a^b f(x) \\, dx$，用步长为 $h=(b-a)/n$ 的复合梯形法则 $T(h)$ 近似，其误差为：\n$$ E_T(h) = T(h) - I = \\sum_{k=1}^{m-1} \\frac{B_{2k}}{(2k)!} h^{2k} [f^{(2k-1)}(b) - f^{(2k-1)}(a)] + R_{2m}(h) $$\n这里，$B_{2k}$ 是伯努利数，$R_{2m}(h)$ 是一个阶为 $O(h^{2m})$ 的余项。为了使这个展开式存在到 $h^{2m-2}$ 项，被积函数 $f(x)$ 必须至少是 $C^{2m-1}[a, b]$ 类的，即其前 $2m-1$ 阶导数必须在闭区间 $[a, b]$ 上存在且连续。龙贝格积分法利用这种结构，通过构造不同 $h$ 下的梯形和的线性组合，系统地消除误差项 $c_1 h^2, c_2 h^4, c_3 h^6, \\dots$，从而达到更高阶的精度。\n\n我们来分析给定的被积函数 $f(x) = \\sqrt{x}\\sin(x)$ 在区间 $[0, 1]$ 上的情况。可微性可能失效的点是端点 $x=0$。\n\n一阶导数是：\n$$ f'(x) = \\frac{d}{dx}(x^{1/2}\\sin(x)) = \\frac{1}{2}x^{-1/2}\\sin(x) + x^{1/2}\\cos(x) $$\n为了检查在 $x=0$ 处的连续性，我们计算当 $x \\to 0^+$ 时的极限。对于小的 $x$，使用近似 $\\sin(x) \\approx x$，第一项的行为类似于 $\\frac{1}{2}x^{-1/2}(x) = \\frac{1}{2}x^{1/2}$，趋近于 $0$。第二项 $x^{1/2}\\cos(x)$ 也趋近于 $0$。因此，$f'(x)$ 在 $x=0$ 处是连续的，且 $f'(0)=0$。\n\n二阶导数是：\n$$ f''(x) = \\frac{d}{dx} \\left( \\frac{1}{2}x^{-1/2}\\sin(x) + x^{1/2}\\cos(x) \\right) $$\n$$ f''(x) = \\left( -\\frac{1}{4}x^{-3/2}\\sin(x) + \\frac{1}{2}x^{-1/2}\\cos(x) \\right) + \\left( \\frac{1}{2}x^{-1/2}\\cos(x) - x^{1/2}\\sin(x) \\right) $$\n$$ f''(x) = -\\frac{1}{4}x^{-3/2}\\sin(x) + x^{-1/2}\\cos(x) - x^{1/2}\\sin(x) $$\n我们来考察 $f''(x)$ 在 $x \\to 0^+$ 时的行为。\n- 项 $-\\frac{1}{4}x^{-3/2}\\sin(x) \\approx -\\frac{1}{4}x^{-3/2}(x) = -\\frac{1}{4}x^{-1/2}$，是无界的。\n- 项 $x^{-1/2}\\cos(x) \\approx x^{-1/2}$，也是无界的。\n- 项 $-x^{1/2}\\sin(x) \\approx -x^{3/2}$，趋近于 $0$。\n\n由于当 $x \\to 0^+$ 时 $f''(x)$ 是无界的，函数 $f(x)$ 不属于 $C^2[0, 1]$。所有更高阶的导数在 $x=0$ 处也将是无界的。这违反了标准欧拉-麦克劳林展开所需的光滑性条件。\n\n当被积函数不够光滑时，误差展开式会包含 $h$ 的非整数次幂。对于形式为 $f(x) = x^\\alpha g(x)$ 的被积函数，其中 $g(x)$ 光滑且 $\\alpha > -1$，广义欧拉-麦克劳林公式表明，梯形法则的误差除了通常的 $h$ 的偶数次幂项外，还包含形如 $h^{\\alpha+1+k}$ 的项。在我们的例子中，$f(x) = x^{1/2} \\sin(x) = x^{1/2}(x - x^3/6 + \\dots) = x^{3/2} - x^{7/2}/6 + \\dots$。主要的非解析行为来自于 $x^{3/2}$ 项（对应于 $\\alpha=3/2 > -1$）。梯形法则的误差展开式将具有以下形式：\n$$ E_T(h) = d_1 h^{3/2+1} + \\dots + c_1 h^2 + d_2 h^{3/2+2} + \\dots + c_2 h^4 + \\dots $$\n如果我们只考虑 $x^{3/2}$ 的积分，最小的 $h$ 次幂是 $h^{3/2+1} = h^{5/2}$。更仔细的分析（Lyness-Ninham 级数）表明，领先的异常项的阶为 $h^{1/2+1} = h^{3/2}$。总误差为 $E_T(h) = c_1 h^{3/2} + c_2 h^2 + c_3 h^{5/2} + c_4 h^4 + \\dots$。\n标准的龙贝格外推假设误差按 $h^2, h^4, \\dots$ 展开，它之所以失败是因为无法正确消除领先的 $h^{3/2}$ 项。\n\n为了恢复高阶收敛，我们必须使用变量代换使被积函数变得光滑。奇点源于 $\\sqrt{x}=x^{1/2}$ 项。代数代换 $x = t^2$ 是消除此类奇点的标准方法。\n令 $x = t^2$。则 $dx = 2t \\, dt$。积分限也随之改变：当 $x$ 从 $0$ 变到 $1$ 时，$t$ 也从 $0$ 变到 $1$。\n积分变为：\n$$ I = \\int_{0}^{1} \\sqrt{t^2} \\sin(t^2) (2t \\, dt) = \\int_{0}^{1} t \\sin(t^2) (2t \\, dt) = \\int_{0}^{1} 2t^2 \\sin(t^2) \\, dt $$\n新的被积函数是 $g(t) = 2t^2 \\sin(t^2)$。我们检查它在 $[0,1]$ 上的光滑性。\n使用 $\\sin(u) = u - u^3/3! + u^5/5! - \\dots$ 的泰勒级数，我们有：\n$$ g(t) = 2t^2 \\left( t^2 - \\frac{(t^2)^3}{6} + \\frac{(t^2)^5}{120} - \\dots \\right) = 2t^4 - \\frac{1}{3}t^8 + \\frac{1}{60}t^{12} - \\dots $$\n这是一个关于 $t$ 的幂级数，对所有 $t$ 都收敛。函数 $g(t)$ 是解析的，因此在 $[0,1]$ 上是无穷次可微的（$C^\\infty$）。它的所有导数都有界。现在对这个变换后的积分应用龙贝格积分法，将会展现预期的高阶收敛性，因为欧拉-麦克劳林公式的条件得到了满足。\n\n现在，我们来评估每个选项：\n\n- **A.** “龙贝格积分法失败是因为被积函数在 $[0,1]$ 上不是周期性的，这使得外推所需的端点相消无效。使用 $x=\\sin^{2}(t)$ 来强制实现类似周期性的端点行为，然后在 $[0,\\pi/2]$ 上对 $t$ 应用龙贝格积分法。”\n关于失败是由于缺少周期性的说法是不正确的。周期性是梯形法则实现超代数收敛的一个条件，但缺少周期性并非标准龙贝格积分法失败的原因。失败是由于缺少光滑性（无界导数）。代换 $x=\\sin^2(t)$ 确实可以产生一个光滑的被积函数，但为失败提供的原因是错误的。因此，这个选项没有 *正确解释* 失败的原因。**不正确**。\n\n- **B.** “龙贝格积分法失败是因为被积函数的高阶导数在 $x=0$ 处无界，因此梯形法则的误差包含 $h$ 的非整数次幂，而标准外推法无法在一系列偶数次幂的层级中将其消除。使用代数去奇点代换 $x=t^{2}$ 得到 $\\int_{0}^{1}2t^{2}\\sin(t^{2})\\,dt$，然后在 $t\\in[0,1]$ 上对 $t$ 应用龙贝格积分法。”\n这个选项正确地指出了失败的原因：在 $x=0$ 处高阶导数无界。它正确地解释了其后果：误差展开式包含 $h$ 的非整数次幂，这使得标准的理查森外推法失效。它还提出了正确且有效的变量代换 $x=t^2$，并正确地推导出了变换后的积分。这个选项与我们的分析完全一致。**正确**。\n\n- **C.** “龙贝格积分法失败是因为 $\\sin(x)$ 产生的振荡需要使用渐近振荡积分法。使用代换 $x=\\ln(t)$ 转换区间后，采用驻相法，然后对变换后的积分应用龙贝格积分法。”\n在 $[0,1]$ 上由 $\\sin(x)$ 引起的振荡并非“高频”，也不是该方法失败的原因。如果被积函数是光滑的，标准的求积法则能够很好地处理这种温和的振荡。驻相法在这里是不相关的。所提出的代换 $x=\\ln(t)$ 将 $x=0$ 处的奇点映射到 $t=1$，但并未消除它，因此是无效的。解释不正确，提出的解决方案也不合适。**不正确**。\n\n- **D.** “龙贝格积分法失败是因为在 $x=1$ 处有一个尖点，它破坏了误差展开中的边界项。使用 $x=1-t^{2}$ 来平滑右端点的行为，然后在 $t\\in[0,1]$ 上对 $t$ 应用龙贝格积分法。”\n这个陈述在事实上是错误的。被积函数 $f(x) = \\sqrt{x}\\sin(x)$ 在 $x=1$ 处是解析的。问题出在 $x=0$ 处。所提出的代换 $x=1-t^2$ 是为了处理在 $x=1$ 处的奇点，而不是 $x=0$。它只会将问题从积分区间的一个端点转移到另一个端点。解释不正确，提出的解决方案也用错了方向。**不正确**。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}