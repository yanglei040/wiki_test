## 引言
在科学与工程的广阔天地里，从行星的运动轨迹到金融市场的瞬息万变，“变化”是永恒的主题。导数，作为描述变化率的数学语言，构成了我们理解和建模物理世界的基础。然而，许多描述自然现象的[微分方程](@entry_id:264184)过于复杂，难以求得解析解。这催生了数值方法的发展，其中，有限差分法因其直观和强大而成为应用最广泛的技术之一。它通过将无限小的[微分](@entry_id:158718)过程替换为有限的差分计算，为在计算机上求解复杂的[微分方程](@entry_id:264184)架起了桥梁。

本文旨在带领读者深入探索导数的[有限差分近似](@entry_id:749375)。我们的目标不止于罗列公式，而是要从第一性原理出发，系统地建立对这一核心数值工具的深刻理解。我们将探讨这些近似公式从何而来，它们的精度和局限性是什么，以及如何巧妙地应用它们来解决现实世界中的复杂问题。

为实现这一目标，本文将分为三个核心部分：

首先，在“**原理与机制**”一章中，我们将深入[有限差分法](@entry_id:147158)的核心。您将学习如何利用[泰勒级数](@entry_id:147154)和[待定系数法](@entry_id:166225)来构建不同阶数的差分格式，理解截断误差和精度阶数的概念，并分析这些离散[算子的谱](@entry_id:272027)性质，揭示其与数值稳定性之间的深刻联系。

接着，在“**应用与[交叉](@entry_id:147634)学科联系**”一章中，我们将展示有限差分法的巨大威力。通过一系列来自固体力学、机器人学、图像处理、量子物理、计算金融乃至机器学习等领域的真实案例，您将看到这些数学工具如何被用来解决跨学科的具体问题。

最后，在“**动手实践**”部分，您将有机会通过解决精心设计的编程问题来巩固所学知识。这些实践将引导您直面数值计算中的关键挑战，如在[截断误差与舍入误差](@entry_id:164039)之间取得平衡，以及处理含噪声数据等，从而将理论知识转化为真正的实践能力。

## 原理与机制

本章在前一章介绍[数值近似](@entry_id:161970)基本概念的基础上，深入探讨[有限差分法](@entry_id:147158)的核心原理与具体机制。我们将从[有限差分格式](@entry_id:749361)的构建出发，系统地阐述其推导方法、[误差分析](@entry_id:142477)、以及在更复杂场景下的应用。我们的目标不仅是学会如何使用现成的公式，更是理解这些公式从何而来，以及它们的内在属性与局限性。

### 基础：[泰勒级数](@entry_id:147154)与[待定系数法](@entry_id:166225)

[微分](@entry_id:158718)的定义本身就蕴含着近似的思想。一个函数 $f(x)$ 在点 $x$ 的导数定义为极限：

$$
f'(x) = \lim_{h\to 0} \frac{f(x+h) - f(x)}{h}
$$

当步长 $h$ 是一个有限小的正数时，这个[差商](@entry_id:136462)就为导数提供了一个近似值。这便是**[前向差分](@entry_id:173829)**公式。然而，这种简单的近似其精度如何？我们能否构建出更精确的公式？要回答这些问题，我们需要一个更强大的理论工具——**[泰勒级数](@entry_id:147154)**。

对于一个在点 $x$ 附近足够光滑的函数 $f$，其在 $x+h$ 和 $x-h$ 处的[泰勒展开](@entry_id:145057)式为：

$$
f(x+h) = f(x) + h f'(x) + \frac{h^2}{2!} f''(x) + \frac{h^3}{3!} f'''(x) + \dots
$$

$$
f(x-h) = f(x) - h f'(x) + \frac{h^2}{2!} f''(x) - \frac{h^3}{3!} f'''(x) + \dots
$$

从第一个展开式，我们可以直接解出 $f'(x)$：

$$
f'(x) = \frac{f(x+h) - f(x)}{h} - \frac{h}{2} f''(x) - O(h^2)
$$

这告诉我们，[前向差分](@entry_id:173829)公式 $\frac{f(x+h) - f(x)}{h}$ 的误差主要是由 $- \frac{h}{2} f''(x)$ 这一项贡献的。因为误差与 $h$ 的一次方成正比，我们称这是一个**[一阶精度](@entry_id:749410)** ($O(h)$) 的格式。类似地，使用第二个展开式可以得到**[后向差分](@entry_id:637618)**公式 $\frac{f(x) - f(x-h)}{h}$，它同样是[一阶精度](@entry_id:749410)的。

然而，通过巧妙地组合这两个展开式，我们可以获得更高精度的结果。将第二个展开式从第一个中减去，我们得到：

$$
f(x+h) - f(x-h) = 2h f'(x) + \frac{2h^3}{3!} f'''(x) + O(h^5)
$$

整理后可得 $f'(x)$ 的一个新表达式：

$$
f'(x) = \frac{f(x+h) - f(x-h)}{2h} - \frac{h^2}{6} f'''(x) + O(h^4)
$$

这便是**中心差分**公式。它的主要误差项与 $h^2$ 成正比，因此这是一个**[二阶精度](@entry_id:137876)** ($O(h^2)$) 的格式。在 $h$ 很小时，二阶精度格式通常远比[一阶精度](@entry_id:749410)格式准确，因为当 $h$ 减半时，其误差会减小到原来的四分之一，而非仅仅二分之一。

虽然直接操作[泰勒级数](@entry_id:147154)很直观，但当我们需要构建更复杂的差分格式时，一种更系统化的方法是**[待定系数法](@entry_id:166225)**。这种方法将差分公式表示为待求点周围函数值的线性组合，然后通过强制该公式对低阶多项式精确成立来确定系数。

让我们用这个方法来推导[二阶导数](@entry_id:144508) $f''(x)$ 的一个近似公式。我们寻找一个使用 $f(x-h)$, $f(x)$ 和 $f(x+h)$ 这三个点来近似 $f''(x)$ 的对称格式 。设该近似具有如下形式：

$$
f''(x) \approx c_{-1} f(x-h) + c_0 f(x) + c_1 f(x+h)
$$

因为格式是对称的，我们要求 $c_{-1} = c_1$。现在，我们强制该公式对于低阶多项式 $p(t)=1$, $p(t)=t-x$, 和 $p(t)=(t-x)^2$ 精确成立。

1.  对于 $p(t) = 1$：$p''(x) = 0$。我们的近似给出 $c_1(1) + c_0(1) + c_1(1) = 2c_1 + c_0$。因此，我们有第一个方程：$2c_1 + c_0 = 0$。

2.  对于 $p(t) = t-x$：$p''(x) = 0$。我们的近似给出 $c_1(x-h-x) + c_0(x-x) + c_1(x+h-x) = c_1(-h) + c_1(h) = 0$。这个条件自然满足，没有提供新信息。

3.  对于 $p(t) = (t-x)^2$：$p''(x) = 2$。我们的近似给出 $c_1((x-h-x)^2) + c_0((x-x)^2) + c_1((x+h-x)^2) = c_1(-h)^2 + c_1(h)^2 = 2c_1 h^2$。因此，我们有第二个方程：$2c_1 h^2 = 2$。

从第二个方程我们解得 $c_1 = \frac{1}{h^2}$。代入第一个方程，我们得到 $c_0 = -2c_1 = -\frac{2}{h^2}$。因此，我们得到了著名的**[二阶导数](@entry_id:144508)[中心差分格式](@entry_id:747203)**：

$$
f''(x) \approx \frac{f(x-h) - 2f(x) + f(x+h)}{h^2}
$$

这个公式是数值求解二阶微分方程（如波动方程、[热传导方程](@entry_id:194763)和薛定谔方程）的基石。

### [截断误差](@entry_id:140949)与精度阶数

上一节我们已经看到，[有限差分公式](@entry_id:177895)并非精确等于导数，两者之间存在一个差值，这个差值被称为**截断误差**。[截断误差](@entry_id:140949)的大小和它如何随步长 $h$ 变化，决定了近似的质量。

让我们更正式地分析[截断误差](@entry_id:140949)。对于一阶导数的[中心差分](@entry_id:173198)，我们已经推导出：

$$
\frac{f(x+h) - f(x-h)}{2h} - f'(x) = \frac{h^2}{6} f'''(x) + O(h^4)
$$

截断误差的主导项是 $\frac{h^2}{6} f'''(x)$。由于误差与 $h^2$ 成正比，我们说这个格式具有**二阶精度**。

同样，我们可以分析[二阶导数](@entry_id:144508)的[中心差分格式](@entry_id:747203)的截断误差。通过将 $f(x+h)$ 和 $f(x-h)$ 的[泰勒展开](@entry_id:145057)式相加：

$$
f(x+h) + f(x-h) = 2f(x) + h^2 f''(x) + \frac{2h^4}{4!} f^{(4)}(x) + O(h^6)
$$

整理后得到：

$$
\frac{f(x+h) - 2f(x) + f(x-h)}{h^2} - f''(x) = \frac{h^2}{12} f^{(4)}(x) + O(h^4)
$$

有趣的是，尽管这个公式近似的是[二阶导数](@entry_id:144508)，但它的[截断误差](@entry_id:140949)主导项仍然是 $O(h^2)$，因此它也是一个二阶精度的格式 。

一个格式的**精度阶数** (order of accuracy) $p$ 是一个至关重要的概念。它意味着[截断误差](@entry_id:140949) $\epsilon_{trunc}$ 的行为类似于 $\epsilon_{trunc} \approx C h^p$，其中 $C$ 是一个不依赖于 $h$ 的常数。在实际计算中，这提供了一个强大的方法来检验我们的代码实现是否正确。

我们可以设计一个**数值收敛性实验**来凭经验验证[精度阶](@entry_id:145189)数 。具体步骤如下：
1.  选择一个我们知道其精确导数值的[光滑函数](@entry_id:267124)，例如 $f(x) = \sin(x)$。
2.  选择一个初始步长 $h_0$ 和一系列不断减小的步长，例如 $h_k = h_0 / 2^k$ for $k=0, 1, 2, \dots$。
3.  对于每个步长 $h_k$，计算[有限差分近似](@entry_id:749375)值 $A(h_k)$ 及其与真实导数值 $T$ 的[绝对误差](@entry_id:139354) $e_k = |A(h_k) - T|$。
4.  如果误差确实遵循 $e_k \approx C h_k^p = C (h_0/2^k)^p$，那么两个连续误差的比值应为：
    $$
    \frac{e_k}{e_{k+1}} \approx \frac{C (h_0/2^k)^p}{C (h_0/2^{k+1})^p} = 2^p
    $$
5.  因此，我们可以通过计算**观测精度阶数** $p_k = \log_2(e_k/e_{k+1})$ 来验证理论。当 $h_k$ 足够小时，$p_k$ 应该趋近于理论[精度阶](@entry_id:145189)数 $p$。

对于上面讨论的一阶和[二阶导数](@entry_id:144508)的[中心差分格式](@entry_id:747203)，执行这样的数值实验会发现，观测精度阶数 $p_k$ 会非常接近 2，从而证实了它们的[二阶精度](@entry_id:137876)。这种收敛性测试是计算科学中验证代码正确性的黄金标准。

### [高阶格式](@entry_id:150564)与其他导数

虽然二阶精度在许多应用中已经足够，但有时我们需要更高的精度来处理复杂问题，或者为了在给定的精度要求下使用更粗的网格（从而减少计算量）。[待定系数法](@entry_id:166225)可以被自然地推广，以构建任意阶精度的差分格式。

要构建一个更高精度的格式，我们通常需要使用更多的网格点。例如，让我们推导一个近似[二阶导数](@entry_id:144508) $f''(x)$ 的**四阶精度**[中心差分格式](@entry_id:747203) 。为了达到四阶精度，我们需要消除 $O(h^2)$ 和 $O(h^4)$ 的误差项。这通常需要一个包含 5 个点的对称 stencil：$\{x-2h, x-h, x, x+h, x+2h\}$。

设近似公式为：
$$
f''(x) \approx c_2 [f(x-2h) + f(x+2h)] + c_1 [f(x-h) + f(x+h)] + c_0 f(x)
$$

我们将系数 $c_0, c_1, c_2$（除以 $h^2$ 的因子已提取出来）作为未知数，并要求该公式对多项式 $1, x^2, x^4$ 精确成立（对奇次幂多项式因对称性自然成立）。这会产生一个关于 $c_0, c_1, c_2$ 的 $3 \times 3$ [线性方程组](@entry_id:148943)。求解该[方程组](@entry_id:193238)可得：

$$
c_0 = -30, \quad c_1 = 16, \quad c_2 = -1
$$

（这里系数被乘以了12以得到整数）。于是，我们得到四阶精度的[二阶导数](@entry_id:144508)[中心差分公式](@entry_id:139451)：

$$
f''(x) \approx \frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}
$$

其[截断误差](@entry_id:140949)为 $O(h^4)$。

同样的方法也可以用来近似更高阶的导数。例如，要近似三阶导数 $f'''(x)$，我们需要一个反对称的 stencil 来匹配三阶导数的奇对称性。一个常用的[二阶精度](@entry_id:137876)格式使用点 $\{x-2h, x-h, x+h, x+2h\}$ 。通过[待定系数法](@entry_id:166225)，强制公式对 $x, x^2, x^3, x^4$ 精确（或产生期望的导数值），我们可以推导出：

$$
f'''(x) \approx \frac{-f(x-2h) + 2f(x-h) - 2f(x+h) + f(x+2h)}{2h^3}
$$

对此公式进行[截断误差分析](@entry_id:756198)会发现，由于 stencil 的对称性和权重的反对称性， $O(h)$ 项被消除了，使其成为一个[二阶精度](@entry_id:137876)的格式，其误差为 $O(h^2)$。

### 多维空间中的[有限差分](@entry_id:167874)

物理世界是多维的，因此我们需要将有限差分的概念推广到多维空间中，以求解偏微分方程 (PDE)。对于定义在矩形网格上的函数 $u(x,y)$，这个推广非常直接。

偏导数的近似可以通过固定其他变量，然后应用一维公式来实现。例如，在格点 $(x_i, y_j)$ 处：

$$
\frac{\partial u}{\partial x}(x_i, y_j) \approx \frac{u(x_{i+1}, y_j) - u(x_{i-1}, y_j)}{2h_x} = \frac{u_{i+1,j} - u_{i-1,j}}{2h_x}
$$

$$
\frac{\partial^2 u}{\partial y^2}(x_i, y_j) \approx \frac{u(x_i, y_{j+1}) - 2u(x_i, y_j) + u(x_i, y_{j-1})}{h_y^2} = \frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_y^2}
$$

其中 $h_x$ 和 $h_y$ 分别是 $x$ 和 $y$ 方向的网格间距。

一个更有趣的情况是**[混合偏导数](@entry_id:139334)**，如 $\frac{\partial^2 u}{\partial x \partial y}$。我们可以通过算子的**复合**来近似它 。也就是说，我们先对 $y$ 方向求导，然后再对结果在 $x$ 方向求导：

$$
\frac{\partial^2 u}{\partial x \partial y} = \frac{\partial}{\partial x} \left( \frac{\partial u}{\partial y} \right) \approx D_x \left( D_y u \right)
$$

其中 $D_x$ 和 $D_y$ 是相应方向的[有限差分算子](@entry_id:749379)。如果在内部格点上我们对两个方向都使用[二阶中心差分](@entry_id:170774)，那么：

$$
D_y u_{i,j} \approx \frac{u_{i,j+1} - u_{i,j-1}}{2h_y}
$$

然后将 $D_x$ 应用于 $D_y u$：

$$
D_x(D_y u)_{i,j} \approx \frac{(D_y u)_{i+1,j} - (D_y u)_{i-1,j}}{2h_x} \approx \frac{\frac{u_{i+1,j+1} - u_{i+1,j-1}}{2h_y} - \frac{u_{i-1,j+1} - u_{i-1,j-1}}{2h_y}}{2h_x}
$$

整理后得到一个使用[九点模板](@entry_id:752492)的公式：

$$
\frac{\partial^2 u}{\partial x \partial y}(x_i, y_j) \approx \frac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4h_x h_y}
$$

由于 $D_x$ 和 $D_y$ 都是二阶精度的，它们复合而成的算子 $D_x D_y$ 也是二阶精度的，其截断误差为 $O(h_x^2, h_y^2)$。

处理计算域的**边界**是一个关键的实际问题。中心差分需要左右两边的点，这在边界上是不可行的。为了在边界上也保持二阶精度，我们可以使用**单边高精度格式**。例如，在左边界点 $x_0$ 处，一个二阶精度的[前向差分](@entry_id:173829)公式为 ：

$$
f'(x_0) \approx \frac{-3f(x_0) + 4f(x_1) - f(x_2)}{2h}
$$

通过在边界上使用这样的单边格式，而在内部使用[中心差分格式](@entry_id:747203)，我们可以为整个计算域构建一个统一的[二阶精度](@entry_id:137876)[导数近似](@entry_id:142976)。

### 代数性质与谱分析

到目前为止，我们都是在单个点上考虑近似。然而，当我们将有限差分应用于整个网格时，它就变成了一个作用于网格函数向量的**矩阵**运算。分析这个矩阵的性质，特别是它的**谱**（即[特征值](@entry_id:154894)集合），能为我们提供关于数值方法行为的深刻见解。

考虑一个具有 $N$ 个格点的一维周期性环。[二阶导数](@entry_id:144508)的[中心差分](@entry_id:173198)算子 $\mathcal{L}_h u_j = \frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}$ 可以表示为一个 $N \times N$ 的矩阵 $A$ 作用在向量 $u = (u_0, u_1, \dots, u_{N-1})^T$ 上。由于周期性边界条件 ($u_N=u_0$, $u_{-1}=u_{N-1}$)，这个矩阵具有一种特殊的结构 ：

$$
A = \frac{1}{h^2}
\begin{pmatrix}
-2  & 1  & 0  & \dots  & 0 & 1 \\
1  & -2  & 1  & \dots  & 0 & 0 \\
0  & 1  & -2  & \dots  & 0 & 0 \\
\vdots  & \vdots  & \ddots  & \ddots  & \ddots  & \vdots \\
0  & 0  & \dots  & 1  & -2 & 1 \\
1  & 0  & \dots  & 0  & 1 & -2
\end{pmatrix}
$$

这是一个**[循环矩阵](@entry_id:143620)** (circulant matrix)，每一行都是前一行循环右移一位得到的结果。[循环矩阵](@entry_id:143620)的一个美妙性质是它们的[特征向量](@entry_id:151813)是**离散傅里叶模**：

$$
v^{(k)}_j = \exp\left(i \frac{2\pi j k}{N}\right), \quad \text{for } k \in \{0, 1, \dots, N-1\}
$$

其中 $j$是格点索引，$k$是[波数](@entry_id:172452)（或模态）索引。将这个[特征向量](@entry_id:151813)代入 $A v^{(k)} = \lambda_k v^{(k)}$ 并求解，可以得到矩阵 $A$ 的[特征值](@entry_id:154894) $\lambda_k^{\text{disc}}$：

$$
\lambda_k^{\text{disc}} = \frac{2}{h^2} \left( \cos\left(\frac{2\pi k}{N}\right) - 1 \right) = -\frac{4}{h^2} \sin^2\left(\frac{\pi k}{N}\right)
$$

这个结果极其重要。它告诉我们离散算子作用在不同频率的波上时会发生什么。

我们可以将这些离散[特征值](@entry_id:154894)与它们所近似的连续微分算子 $\mathcal{L} = \frac{d^2}{dx^2}$ 的[特征值](@entry_id:154894)进行比较 。在长度为 $L=Nh$ 的周期域上，算子 $\mathcal{L}$ 的特征函数是 $f_k(x) = \exp(i \frac{2\pi k}{L} x)$，对应的[特征值](@entry_id:154894)为：

$$
\lambda_k^{\text{cont}} = -\left(\frac{2\pi k}{L}\right)^2
$$

现在，我们可以考察离散[特征值](@entry_id:154894)与连续[特征值](@entry_id:154894)的比值，这个比值描述了数值格式对不同波动的近似程度：

$$
R_k = \frac{\lambda_k^{\text{disc}}}{\lambda_k^{\text{cont}}} = \frac{-\frac{4}{(L/N)^2}\sin^2(\frac{\pi k}{N})}{-\frac{4\pi^2 k^2}{L^2}} = \frac{N^2 \sin^2(\frac{\pi k}{N})}{\pi^2 k^2} = \left( \frac{\sin(\pi k/N)}{\pi k/N} \right)^2
$$

这个比值揭示了**[色散误差](@entry_id:748555)** (dispersion error)。对于低[波数](@entry_id:172452)（长波，$k \ll N$），$\pi k/N$ 很小，根据 $\sin(x) \approx x$ for small $x$，比值 $R_k \approx 1$。这意味着离散格式能很好地模拟长波。但对于高[波数](@entry_id:172452)（短波，$k$ 接近 $N/2$），$\sin(\pi k/N)$ 与 $\pi k/N$ 的差异变大，比值 $R_k < 1$。这意味着离散格式会人为地减慢短[波的传播](@entry_id:144063)速度，导致数值解中出现非物理的[振荡](@entry_id:267781)。理解谱性质是分析[数值格式稳定性](@entry_id:752825)和准确性的关键。

### 进阶主题与实践考量

掌握了基本原理后，我们可以探讨一些更微妙但同样重要的 practical considerations.

#### 离散算子的代数性质

一个常见的陷阱是想当然地认为离散算子会继承其连续 counterparts 的所有代数性质。一个典型的例子是**乘法法则** (product rule)。对于连续导数，我们有 $(fg)' = f'g + fg'$。但是，对于[中心差分](@entry_id:173198)算子 $D_h$ 呢？

让我们来检验一下差值 $E(h) = D_h(fg) - [(D_h f)g + f(D_h g)]$ 。通过细致的泰勒展开分析，可以证明这个差值不为零。实际上，对于小的 $h$，可以推导出：

$$
E(h) = \frac{h^2}{3} [f'''(x)g(x) + f(x)g'''(x)] + O(h^4)
$$

这表明离散的乘法法则是**不成立的**，其“违背”程度为 $O(h^2)$。虽然在 $h \to 0$ 时差值也会消失，但在有限步长下，这种不一致性可能会在复杂的[非线性](@entry_id:637147)问题中累积，导致意想不到的误差来源。

#### [非均匀网格](@entry_id:752607)

在许多实际问题中，比如[边界层](@entry_id:139416)流动或者需要对特定区域进行精细解析的场景，使用**[非均匀网格](@entry_id:752607)**更为高效。在[非均匀网格](@entry_id:752607)上，[待定系数法](@entry_id:166225)依然是推导差分格式的有力工具 。

例如，考虑点 $x_i$ 及其邻近点 $x_{i-1}, x_{i+1}, x_{i+2}$，其间距分别为 $h_{i-1}=x_i-x_{i-1}$, $h_i=x_{i+1}-x_i$, $h_{i+1}=x_{i+2}-x_{i+1}$。要近似 $f''(x_i)$，我们可以构建一个使用这四个点函数值的线性组合，并通过强制它对多项式 $1, x, x^2, x^3$ 精确成立来求解系数。最终得到的系数会是 $h_{i-1}, h_i, h_{i+1}$ 的复杂函数。虽然公式比均匀网格上的要繁琐得多，但它保证了即使在网格间距变化的情况下，截断误差仍然是二阶的 ($O(\max(h^2))$)。

#### 与[稳定性分析](@entry_id:144077)的联系

最后，[有限差分格式](@entry_id:749361)的选择对求解含时演化[偏微分方程](@entry_id:141332)的**稳定性**有着至关重要的影响。考虑最简单的一维线性平流方程 $\frac{\partial u}{\partial t} + c \frac{\partial u}{\partial x} = 0$。

如果我们用[中心差分近似](@entry_id:177025)时间导数（跨越 $n-1$ 和 $n+1$ 时刻，称为**[蛙跳格式](@entry_id:163462)**）和空间导数（在 $n$ 时刻），会得到一个[数值格式](@entry_id:752822) ：

$$
\frac{u_j^{n+1} - u_j^{n-1}}{2\Delta t} + c \frac{u_{j+1}^n - u_{j-1}^n}{2\Delta x} = 0
$$

为了分析这个格式是否稳定（即误差是否会随时间无限增长），我们可以使用**[冯·诺依曼稳定性分析](@entry_id:145718)**。我们考察一个傅里葉模 $u_j^n = G^n e^{ik j \Delta x}$ 的演化，其中 $G$ 是**[放大因子](@entry_id:144315)**。如果对于所有[波数](@entry_id:172452) $k$，都有 $|G| \le 1$，则格式是稳定的。

将傅里葉模代入[蛙跳格式](@entry_id:163462)，可以解出 $G$ 满足的二次方程：

$$
G^2 + (2i \nu \sin(k\Delta x)) G - 1 = 0
$$

其中 $\nu = \frac{c \Delta t}{\Delta x}$ 是著名的**[Courant-Friedrichs-Lewy](@entry_id:175598) (CFL)数**。解出 $G$ 会发现，当 CFL 条件 $|\nu| \le 1$ 满足时，我们总是有 $|G|=1$。这意味着格式是中性稳定的，振幅不会增长。然而，如果 $|\nu| > 1$，[放大因子](@entry_id:144315)的一个解将会有大于1的模，导致数值解呈[指数增长](@entry_id:141869)并迅速崩溃。这个例子清晰地表明，空间导数的离散化方式（以及[时间离散化](@entry_id:169380)）直接决定了整个动态模拟的成败。