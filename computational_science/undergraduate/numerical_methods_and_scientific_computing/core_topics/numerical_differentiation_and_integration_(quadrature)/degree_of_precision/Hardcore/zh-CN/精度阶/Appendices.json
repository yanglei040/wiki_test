{
    "hands_on_practices": [
        {
            "introduction": "在数值计算的世界里，精度是一门微妙的平衡艺术。直觉上，我们可能认为减小步长总能带来更准确的结果，但事实并非如此。本练习将引导你探索一个核心挑战：由近似方法本身带来的截断误差，与计算机有限精度表示引起的舍入误差之间的权衡。通过分析一个简单的前向差分公式，你将亲手推导出最佳步长，从而深刻理解在实际计算中如何平衡这两种误差以达到最高精度。",
            "id": "3222056",
            "problem": "您正在使用前向差分公式 $D(h) = \\frac{f(x+h) - f(x)}{h}$，在具有单位舍入误差 $u \\in (0,1)$ 的标准浮点运算中，近似计算光滑函数 $f$ 在点 $x$ 处的导数。假设 $f$ 在 $x$ 的一个邻域内至少是二次连续可微的，且 $f''(x) \\neq 0$，$|f(x)| > 0$。采用常规浮点模型，即每次返回的函数值满足 $\\widehat{f}(y) = f(y)\\,(1+\\delta)$，其中 $|\\delta| \\leq u$，并且每次函数求值的误差是独立的。使用泰勒定理分析截断误差，并使用上述浮点模型分析舍入误差，推导 $D(h)$ 作为 $f'(x)$ 近似值的绝对误差的一个显式上界，该上界是步长 $h>0$ 的函数。然后，通过最小化该上界来确定平衡截断误差和舍入误差的步长 $h$。请以 $u$、$|f(x)|$ 和 $|f''(x)|$ 的单个闭式表达式形式给出您的最终答案。不要为这些量引入任何数值，也不要假设任何超出所述假设所能证明的相消。您的最终答案必须是一个单一的解析表达式。",
            "solution": "用户希望我验证问题陈述，如果有效，则提供一个完整的解。\n\n### 步骤 1：提取已知条件\n问题陈述中提供的数据和条件如下：\n- 近似导数的前向差分公式为 $D(h) = \\frac{f(x+h) - f(x)}{h}$。\n- 计算在单位舍入误差为 $u \\in (0,1)$ 的浮点运算中进行。\n- 函数 $f$ 至少是二次连续可微的，即 $f \\in C^2$。\n- 在目标点的二阶导数非零：$f''(x) \\neq 0$。\n- 在目标点的函数值非零：$|f(x)| > 0$。\n- 函数求值的浮点模型为 $\\widehat{f}(y) = f(y)(1+\\delta)$，其中 $|\\delta| \\leq u$。假设每次求值的误差 $\\delta$ 是独立的。\n- 步长 $h$ 是一个正实数，$h>0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题要求通过平衡截断误差和舍入误差来推导数值微分公式的最优步长。\n- **科学性：** 该问题是数值分析和科学计算中的一个经典基础课题。截断误差模型（通过泰勒定理）和舍入误差模型（标准浮点运算模型）是该领域的基石。所有假设和模型在科学上都是合理的。\n- **适定性：** 该问题提供了推导误差界并随后将其最小化的所有必要信息。条件 $f''(x) \\neq 0$ 和 $|f(x)| > 0$ 对于确保最优步长 $h$ 有一个唯一的、有意义的非平凡解至关重要。\n- **客观性：** 问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n该问题没有表现出验证清单中列出的任何缺陷。这是数值分析中一个定义明确的标准练习。\n\n### 步骤 3：结论与行动\n该问题是有效的。我现在开始进行解答。\n\n导数 $f'(x)$ 的计算近似值 $\\widehat{D}(h)$ 的总误差为 $E_{total}(h) = |\\widehat{D}(h) - f'(x)|$。我们可以使用三角不等式将此误差分解为两个分量：截断误差和舍入误差。\n$$E_{total}(h) = |(\\widehat{D}(h) - D(h)) + (D(h) - f'(x))| \\le |\\widehat{D}(h) - D(h)| + |D(h) - f'(x)|$$\n项 $|D(h) - f'(x)|$ 是截断误差 $E_{trunc}(h)$，其产生原因是我们使用有限差分公式来近似一个极限。项 $|\\widehat{D}(h) - D(h)|$ 是舍入误差 $E_{round}(h)$，其产生原因是浮点运算的有限精度。\n\n首先，我们分析截断误差 $E_{trunc}(h)$。由于函数 $f$ 假设为至少二次连续可微，我们可以使用泰勒定理将 $f(x+h)$ 在 $x$ 附近展开：\n$$f(x+h) = f(x) + hf'(x) + \\frac{h^2}{2} f''(\\xi)$$\n其中 $\\xi$ 是介于 $x$ 和 $x+h$ 之间的某个点。\n将此展开式代入 $D(h)$ 的公式中：\n$$D(h) = \\frac{\\left(f(x) + hf'(x) + \\frac{h^2}{2} f''(\\xi)\\right) - f(x)}{h} = f'(x) + \\frac{h}{2} f''(\\xi)$$\n因此，截断误差为：\n$$D(h) - f'(x) = \\frac{h}{2} f''(\\xi)$$\n截断误差的大小有界：\n$$E_{trunc}(h) = |D(h) - f'(x)| = \\left|\\frac{h}{2} f''(\\xi)\\right| = \\frac{h}{2} |f''(\\xi)|$$\n由于 $f''$ 是连续的，对于小的 $h$，$f''(\\xi)$ 的值趋近于 $f''(x)$。因此，截断误差的一个标准主阶上界是：\n$$E_{trunc}(h) \\le \\frac{h}{2} |f''(x)|$$\n\n接下来，我们分析舍入误差 $E_{round}(h)$。导数的计算值 $\\widehat{D}(h)$ 是基于函数在 $x$ 和 $x+h$ 处的计算值 $\\widehat{f}(x)$ 和 $\\widehat{f}(x+h)$。根据问题的模型：\n$$\\widehat{f}(x) = f(x)(1+\\delta_1) \\quad \\text{其中 } |\\delta_1| \\le u$$\n$$\\widehat{f}(x+h) = f(x+h)(1+\\delta_2) \\quad \\text{其中 } |\\delta_2| \\le u$$\n计算出的差商为 $\\widehat{D}(h) = \\frac{\\widehat{f}(x+h) - \\widehat{f}(x)}{h}$。在此分析中，我们忽略由减法和除法引入的额外舍入误差，因为来自函数求值的误差通常是主导的。\n舍入误差为：\n$$E_{round}(h) = |\\widehat{D}(h) - D(h)| = \\left|\\frac{f(x+h)(1+\\delta_2) - f(x)(1+\\delta_1)}{h} - \\frac{f(x+h) - f(x)}{h}\\right|$$\n$$E_{round}(h) = \\left|\\frac{f(x+h)\\delta_2 - f(x)\\delta_1}{h}\\right|$$\n对分子使用三角不等式：\n$$E_{round}(h) \\le \\frac{|f(x+h)\\delta_2| + |f(x)\\delta_1|}{h} \\le \\frac{|f(x+h)||\\delta_2| + |f(x)||\\delta_1|}{h}$$\n使用界 $|\\delta_i| \\le u$：\n$$E_{round}(h) \\le \\frac{u (|f(x+h)| + |f(x)|)}{h}$$\n由于 $f$ 是连续的，对于小的 $h$，$f(x+h) \\approx f(x)$。因此，我们可以通过用 $|f(x)|$ 替换 $|f(x+h)|$ 来近似这个界：\n$$E_{round}(h) \\le \\frac{2u|f(x)|}{h}$$\n这个近似是合理的，因为它捕捉了在减去两个几乎相等的数 $f(x+h)$ 和 $f(x)$ 时发生的灾难性相消效应，这种效应会将初始舍入误差放大一个与 $\\frac{1}{h}$ 成正比的因子。\n\n我们现在得到了总误差的一个上界，记为 $E(h)$：\n$$E(h) = E_{trunc}(h) + E_{round}(h) \\approx \\frac{h}{2}|f''(x)| + \\frac{2u|f(x)|}{h}$$\n为了找到最小化此误差界的步长 $h$，我们对 $E(h)$ 关于 $h$ 求导，并令结果为零。\n$$\\frac{dE}{dh} = \\frac{d}{dh}\\left(\\frac{h}{2}|f''(x)| + \\frac{2u|f(x)|}{h}\\right) = \\frac{1}{2}|f''(x)| - \\frac{2u|f(x)|}{h^2}$$\n令 $\\frac{dE}{dh} = 0$：\n$$\\frac{1}{2}|f''(x)| = \\frac{2u|f(x)|}{h^2}$$\n解出 $h^2$：\n$$h^2 = \\frac{4u|f(x)|}{|f''(x)|}$$\n由于 $h>0$，我们取正平方根：\n$$h = \\sqrt{\\frac{4u|f(x)|}{|f''(x)|}} = 2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}}$$\n为了确认这是一个最小值，我们检查二阶导数：\n$$\\frac{d^2E}{dh^2} = \\frac{d}{dh}\\left(\\frac{1}{2}|f''(x)| - 2u|f(x)|h^{-2}\\right) = -2u|f(x)|(-2h^{-3}) = \\frac{4u|f(x)|}{h^3}$$\n鉴于 $u>0$、$|f(x)|>0$ 且 $h>0$，二阶导数 $\\frac{d^2E}{dh^2}$ 总是正的。这证实了所求得的 $h$ 值对应于误差界函数 $E(h)$ 的一个最小值。这个最优步长代表了递减的截断误差和递增的舍入误差达到平衡的点。",
            "answer": "$$ \\boxed{2\\sqrt{\\frac{u|f(x)|}{|f''(x)|}}} $$"
        },
        {
            "introduction": "在理解了数值计算中普遍存在的误差挑战后，我们可以转向一个更具体的问题：如何衡量数值积分公式的“好坏”？“精度阶”（degree of precision）这一概念为此提供了一个明确的代数标准，即一个规则能够精确积分的最高次多项式次数。本练习将通过一个最简单的数值积分规则——单点高斯-勒让德求积（即中点法则），让你首次接触并验证精度阶的定义，为评估更复杂的求积方法打下基础。",
            "id": "2175007",
            "problem": "一个数值求积法则的精确度阶是该法则能对所有次数最高为 $d$（含 $d$ 次）的多项式精确计算积分的最大整数 $d$。\n\n考虑单点高斯-勒让德求积法则，它使用以下公式来近似计算函数 $f(x)$ 在区间 $[-1, 1]$ 上的定积分：\n$$ \\int_{-1}^{1} f(x) \\,dx \\approx 2 f(0) $$\n\n为确定此法则的精确度阶，您必须在形如 $f(x) = x^k$（其中 $k = 0, 1, 2, \\ldots$ 为非负整数）的单项式上测试其准确性。通过找出法则能给出精确结果的最高 $k$ 值，您就可以确定其精确度阶。\n\n上述单点高斯-勒让德求积法则的精确度阶是多少？\n\nA. 0\n\nB. 1\n\nC. 2\n\nD. 3",
            "solution": "我们在单项式 $f(x)=x^{k}$ 上测试法则 $Q(f)=2 f(0)$，并与在 $[-1,1]$ 上的精确积分进行比较，以确定使得该法则对所有次数至多为 $d$ 的多项式都精确的最大整数 $d$。\n\n对于 $k=0$ (常数): \n$$\\int_{-1}^{1} x^{0} \\, dx=\\int_{-1}^{1} 1 \\, dx=2,$$\n而求积法则给出\n$$Q(x^{0})=2 \\cdot 1=2.$$\n因此它对 $k=0$ 是精确的。\n\n对于 $k=1$ (线性):\n$$\\int_{-1}^{1} x \\, dx=0,$$\n而\n$$Q(x)=2 \\cdot 0=0.$$\n因此它对 $k=1$ 是精确的。\n\n对于 $k=2$ (二次):\n$$\\int_{-1}^{1} x^{2} \\, dx=\\left.\\frac{x^{3}}{3}\\right|_{-1}^{1}=\\frac{2}{3},$$\n但是\n$$Q(x^{2})=2 \\cdot 0^{2}=0.$$\n因此它对 $k=2$ 不是精确的。\n\n因此，该法则对所有次数至多为 $1$ 的多项式都是精确的，但在次数为 $2$ 时失效。所以，精确度阶为 $1$，对应于选项 B。(注：尽管由于对称性和 $f(0)=0$，该法则对所有奇次单项式也都是精确的，但精确度阶要求对直到某一给定次数的所有多项式都成立，而在 $k=2$ 处的失效将精确度阶限制为 $1$。)",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "掌握了精度阶的基本概念后，我们来探索一个更强大的工具。虽然中点法则简单直观，但其精度有限。通过精心选择积分节点和权重，我们可以构造出效率惊人的高斯求积法。本练习提供了一个看似神秘的3点求积公式，你的任务是像一名数值侦探一样，通过系统性测试来揭示其“隐藏”的精度阶，从而体会到高级数值方法设计的精妙之处。",
            "id": "2419560",
            "problem": "一个未知的3点求积法则$Q[f]$是为积分$\\int_{-1}^{1} f(x)\\,dx$而指定的，其节点和权重如下：\n- 节点：$x_{1}=-\\sqrt{\\dfrac{3}{5}}$，$x_{2}=0$，$x_{3}=+\\sqrt{\\dfrac{3}{5}}$。\n- 权重：$w_{1}=\\dfrac{5}{9}$，$w_{2}=\\dfrac{8}{9}$，$w_{3}=\\dfrac{5}{9}$。\n\n仅使用这些节点和权重，确定该法则的多项式精度阶，即对于每个次数至多为$m$的多项式$p$都有$Q[p]=\\int_{-1}^{1} p(x)\\,dx$成立的最大整数$m$。\n\n选择一项：\n\nA. $3$\n\nB. $4$\n\nC. $5$\n\nD. $6$",
            "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n**步骤1：提取已知条件**\n- 积分定义为$I[f] = \\int_{-1}^{1} f(x)\\,dx$。\n- 一个$3$点求积法则由$Q[f] = \\sum_{i=1}^{3} w_i f(x_i)$给出。\n- 节点指定为$x_{1}=-\\sqrt{\\frac{3}{5}}$，$x_{2}=0$和$x_{3}=+\\sqrt{\\frac{3}{5}}$。\n- 相应的权重为$w_{1}=\\frac{5}{9}$，$w_{2}=\\frac{8}{9}$和$w_{3}=\\frac{5}{9}$。\n- 目标是确定精度阶，定义为使得该法则对所有次数至多为$m$的多项式$p(x)$都精确成立（即$Q[p]=I[p]$）的最大整数$m$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题设置在数值分析的标准框架内，特别是数值积分。由给定节点和权重定义的求积法则可被识别为3点Gauss-Legendre求积法则，这是一种基础且成熟的方法。任务是通过直接验证来确定其精度阶，这是该领域的标准程序。该问题是自洽的，提供了所有必要的数据。定义清晰明确。没有科学或逻辑上的矛盾，不依赖伪科学，也没有不适定结构。该问题具有科学依据，是客观且适定的。\n\n**步骤3：结论和行动**\n问题陈述有效。将推导解答。\n\n**解答推导**\n\n求积法则的精度阶$m$是指该法则能精确积分所有次数最高为$m$的多项式的最大整数。为了找到$m$，我们对基底单项式$p_k(x) = x^k$（其中$k = 0, 1, 2, \\dots$）测试该法则。如果该法则对所有$k \\leq m$都精确，而对$k = m+1$不精确，则其精度阶为$m$。\n\n单项式$x^k$在区间$[-1, 1]$上的精确积分为：\n$$I[x^k] = \\int_{-1}^{1} x^k \\,dx = \\left[ \\frac{x^{k+1}}{k+1} \\right]_{-1}^{1} = \\frac{1 - (-1)^{k+1}}{k+1}$$\n计算结果为：\n- 如果$k$是偶数，则$I[x^k] = \\frac{2}{k+1}$。\n- 如果$k$是奇数，则$I[x^k] = 0$。\n\n求积近似值为：\n$$Q[x^k] = w_1 x_1^k + w_2 x_2^k + w_3 x_3^k = \\frac{5}{9}\\left(-\\sqrt{\\frac{3}{5}}\\right)^k + \\frac{8}{9}(0)^k + \\frac{5}{9}\\left(+\\sqrt{\\frac{3}{5}}\\right)^k$$\n\n我们现在对递增的$k$值进行测试。\n\n对于$k=0$：多项式为$p_0(x) = 1$。\n$I[1] = \\int_{-1}^{1} 1 \\,dx = 2$。\n$Q[1] = \\frac{5}{9}(1) + \\frac{8}{9}(1) + \\frac{5}{9}(1) = \\frac{5+8+5}{9} = \\frac{18}{9} = 2$。\n$I[1] = Q[1]$。该法则对0次多项式精确。\n\n对于奇数$k \\ge 1$：节点和权重关于$x=0$对称。即$x_1 = -x_3$且$w_1 = w_3$。对于任何奇函数$f(x)$，$Q[f] = w_1 f(x_1) + w_2 f(0) + w_3 f(x_3) = w_1 f(-x_3) + w_2 f(0) + w_1 f(x_3) = -w_1 f(x_3) + w_2 f(0) + w_1 f(x_3) = w_2 f(0)$。\n对于奇数$k \\ge 1$的$p_k(x) = x^k$，$p_k(0)=0$。因此，$Q[x^k] = 0$。\n对于奇数$k$，精确积分$I[x^k]=0$。\n因此，对于所有奇数$k \\ge 1$，$I[x^k] = Q[x^k]$。我们对$k=1, 3, 5$明确验证了这一点：\n- 对于$k=1$：$I[x]=0$，$Q[x]=0$。\n- 对于$k=3$：$I[x^3]=0$，$Q[x^3]=0$。\n- 对于$k=5$：$I[x^5]=0$，$Q[x^5]=0$。\n该法则对1次、3次和5次多项式精确。\n\n我们只需要检查偶数次幂。\n对于偶数$k$：\n$Q[x^k] = \\frac{5}{9}\\left(-\\sqrt{\\frac{3}{5}}\\right)^k + \\frac{8}{9}(0)^k + \\frac{5}{9}\\left(+\\sqrt{\\frac{3}{5}}\\right)^k = \\frac{5}{9}\\left(\\frac{3}{5}\\right)^{k/2} + 0 + \\frac{5}{9}\\left(\\frac{3}{5}\\right)^{k/2} = 2 \\cdot \\frac{5}{9}\\left(\\frac{3}{5}\\right)^{k/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{k/2}$。\n\n对于$k=2$：\n$I[x^2] = \\frac{2}{2+1} = \\frac{2}{3}$。\n$Q[x^2] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{2/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right) = \\frac{30}{45} = \\frac{2}{3}$。\n$I[x^2] = Q[x^2]$。该法则对2次多项式精确。\n\n对于$k=4$：\n$I[x^4] = \\frac{2}{4+1} = \\frac{2}{5}$。\n$Q[x^4] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{4/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^2 = \\frac{10}{9}\\left(\\frac{9}{25}\\right) = \\frac{10}{25} = \\frac{2}{5}$。\n$I[x^4] = Q[x^4]$。该法则对4次多项式精确。\n\n由于该法则对0、1、2、3、4、5次单项式都精确，因此它对这些单项式的任意线性组合（即任何次数至多为5的多项式）都精确。精度阶至少为5。\n\n现在我们必须测试$k=6$：\n$I[x^6] = \\frac{2}{6+1} = \\frac{2}{7}$。\n$Q[x^6] = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^{6/2} = \\frac{10}{9}\\left(\\frac{3}{5}\\right)^3 = \\frac{10}{9}\\left(\\frac{27}{125}\\right) = \\frac{10 \\cdot 27}{9 \\cdot 125} = \\frac{2 \\cdot 5 \\cdot 3 \\cdot 9}{9 \\cdot 25 \\cdot 5} = \\frac{6}{25}$。\n我们比较$I[x^6]$和$Q[x^6]$：\n$I[x^6] = \\frac{2}{7} \\approx 0.2857$。\n$Q[x^6] = \\frac{6}{25} = 0.24$。\n显然，$I[x^6] \\neq Q[x^6]$。该法则对6次多项式不精确。\n\n该法则对所有次数至多为$m$的多项式都精确的最大整数$m$是$5$。\n\n**选项评估**\n\nA. $3$：这是**不正确**的。该法则已被证明对4次和5次多项式精确。\n\nB. $4$：这是**不正确**的。该法则已被证明对5次多项式精确。\n\nC. $5$：这是**正确**的。该法则对所有次数直到并包括5的多项式都精确，但对于6次多项式则不成立。\n\nD. $6$：这是**不正确**的。该法则对多项式$p(x)=x^6$不精确。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}