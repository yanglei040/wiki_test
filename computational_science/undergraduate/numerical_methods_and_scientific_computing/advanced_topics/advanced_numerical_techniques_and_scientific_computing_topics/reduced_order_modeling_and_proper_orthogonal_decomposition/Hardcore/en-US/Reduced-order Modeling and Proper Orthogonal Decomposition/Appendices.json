{
    "hands_on_practices": [
        {
            "introduction": "Proper Orthogonal Decomposition is fundamentally built upon the Singular Value Decomposition (SVD) of your data matrix. This first practice invites you to explore the core conceptual link between them without getting lost in computation. By constructing a snapshot matrix from a known number of orthonormal patterns, you will see from first principles how the number of non-zero singular values directly reveals the underlying rankâ€”the number of \"building block\" patterns in the data .",
            "id": "3265930",
            "problem": "Consider a snapshot matrix $X \\in \\mathbb{R}^{100 \\times 50}$ used in reduced-order modeling via Proper Orthogonal Decomposition (POD). Construct $X$ by selecting three orthonormal spatial vectors $u_1, u_2, u_3 \\in \\mathbb{R}^{100}$, three orthonormal temporal vectors $v_1, v_2, v_3 \\in \\mathbb{R}^{50}$, and three positive scalars $\\sigma_1, \\sigma_2, \\sigma_3$. Let the spatial vectors be the first three standard basis vectors, $u_1 = e_1$, $u_2 = e_2$, $u_3 = e_3$, where $e_i \\in \\mathbb{R}^{100}$ has a $1$ in the $i$-th position and $0$ elsewhere. Let the temporal vectors be the first three standard basis vectors, $v_1 = e_1$, $v_2 = e_2$, $v_3 = e_3$, where $e_i \\in \\mathbb{R}^{50}$ has a $1$ in the $i$-th position and $0$ elsewhere. Choose the singular values $\\sigma_1 = 6$, $\\sigma_2 = 3$, and $\\sigma_3 = 1$. Define the snapshot matrix as the rank-$3$ sum of outer products\n$$\nX \\;=\\; \\sigma_1 \\, u_1 v_1^{\\top} \\;+\\; \\sigma_2 \\, u_2 v_2^{\\top} \\;+\\; \\sigma_3 \\, u_3 v_3^{\\top}.\n$$\nUsing only the foundational definitions of singular value decomposition and matrix rank, determine the number of non-zero singular values recovered by Proper Orthogonal Decomposition (POD) applied to $X$. Express your final answer as a single integer.",
            "solution": "The problem requires determining the number of non-zero singular values of a given matrix $X$, which is constructed in a specific manner relevant to Proper Orthogonal Decomposition (POD).\n\nFirst, let us establish the foundational principles. For any real matrix $X \\in \\mathbb{R}^{m \\times n}$, the Singular Value Decomposition (SVD) provides a factorization of the form $X = U \\Sigma V^{\\top}$. Here, $U \\in \\mathbb{R}^{m \\times m}$ and $V \\in \\mathbb{R}^{n \\times n}$ are orthogonal matrices, and $\\Sigma \\in \\mathbb{R}^{m \\times n}$ is a rectangular diagonal matrix. The diagonal entries of $\\Sigma$, denoted by $\\sigma_i$, are the singular values of $X$. They are non-negative and conventionally ordered such that $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_p \\ge 0$, where $p = \\min(m, n)$.\n\nThe SVD can also be expressed as a sum of rank-$1$ outer products:\n$$\nX = \\sum_{i=1}^{r} \\sigma_i u_i v_i^{\\top}\n$$\nwhere $r$ is the rank of the matrix $X$. The vectors $u_i \\in \\mathbb{R}^m$ are the columns of $U$ (the left singular vectors) and form an orthonormal set, i.e., $u_i^{\\top} u_j = \\delta_{ij}$. The vectors $v_i \\in \\mathbb{R}^n$ are the columns of $V$ (the right singular vectors) and also form an orthonormal set, i.e., $v_i^{\\top} v_j = \\delta_{ij}$. The scalars $\\sigma_i > 0$ for $i=1, \\dots, r$ are the non-zero singular values of $X$. The number of non-zero singular values is, by definition, the rank of the matrix.\n\nThe problem states that Proper Orthogonal Decomposition (POD) is applied to the snapshot matrix $X$. Within the framework of numerical linear algebra, POD (specifically, using the method of snapshots) is mathematically equivalent to the SVD of the snapshot matrix. The process recovers the left singular vectors $u_i$ (the POD modes), the right singular vectors $v_i$ (the temporal modes), and the singular values $\\sigma_i$. The number of non-zero singular values recovered is therefore the rank of $X$.\n\nThe snapshot matrix $X \\in \\mathbb{R}^{100 \\times 50}$ is defined as:\n$$\nX = \\sigma_1 u_1 v_1^{\\top} + \\sigma_2 u_2 v_2^{\\top} + \\sigma_3 u_3 v_3^{\\top}\n$$\nWe are given the following definitions:\n1.  The scalars are $\\sigma_1 = 6$, $\\sigma_2 = 3$, and $\\sigma_3 = 1$. These are all positive.\n2.  The spatial vectors are $u_1 = e_1$, $u_2 = e_2$, $u_3 = e_3$, where $e_i \\in \\mathbb{R}^{100}$ are the standard basis vectors. The set $\\{u_1, u_2, u_3\\}$ is an orthonormal set, as $e_i^{\\top}e_j = \\delta_{ij}$ for $i, j \\in \\{1, 2, 3\\}$.\n3.  The temporal vectors are $v_1 = e_1$, $v_2 = e_2$, $v_3 = e_3$, where $e_i \\in \\mathbb{R}^{50}$ are the standard basis vectors. The set $\\{v_1, v_2, v_3\\}$ is also an orthonormal set.\n\nThe given expression for $X$ perfectly matches the structure of the SVD outer product expansion. We have a sum of three terms. Each term is the product of a positive scalar $\\sigma_i$, a unit vector $u_i$, and the transpose of a unit vector $v_i$. The sets of vectors $\\{u_1, u_2, u_3\\}$ and $\\{v_1, v_2, v_3\\}$ are both orthonormal.\n\nThis means that the provided expression is, in fact, the singular value decomposition of $X$. The non-zero singular values of $X$ are precisely the scalars given: $\\sigma_1 = 6$, $\\sigma_2 = 3$, and $\\sigma_3 = 1$. All other singular values, $\\sigma_i$ for $i > 3$, are zero.\n\nThe problem asks for the *number* of non-zero singular values recovered by applying POD to $X$. Based on our analysis, there are exactly three positive singular values. The number of non-zero singular values is therefore $3$. This is also the rank of the matrix $X$.\n\nThe question is a direct test of the foundational definition of singular value decomposition and its relation to matrix rank. The construction of the matrix $X$ is a deliberate formulation of a rank-$3$ matrix via its SVD expansion. No further computation is necessary. The number of terms in the sum, given that the scalars are non-zero and the vector sets are orthonormal, directly provides the answer.\nThe number of non-zero singular values is $3$.",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "While POD is often applied to discrete data matrices, its roots are in the analysis of continuous fields governed by differential equations. This practice challenges you to derive the POD modes for a simple analytical function of space and time. You will construct the two-point correlation operator and solve the resulting integral eigenvalue problem, providing a powerful glimpse into the theoretical foundations of POD beyond just matrix decomposition .",
            "id": "3266047",
            "problem": "Consider the spatial-temporal field $u(x,t)$ defined on the spatial domain $x \\in [0,1]$ and time $t \\in \\mathbb{R}$ by\n$$\nu(x,t) = \\sin(2\\pi x)\\,\\cos(\\omega_{1} t) + \\sin(3\\pi x)\\,\\cos(\\omega_{2} t),\n$$\nwhere $\\omega_{1} \\neq \\omega_{2}$ are fixed positive constants. Using the definition of Proper Orthogonal Decomposition (POD), where the spatial modes are the eigenfunctions of the time-averaged two-point correlation operator\n$$\nR(x,x') = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} u(x,t)\\,u(x',t)\\,\\mathrm{d}t,\n$$\nderive the analytical spatial POD modes $\\{\\phi_{k}(x)\\}$ associated with $u(x,t)$. Assume the spatial inner product is the standard $L^{2}$ inner product on $[0,1]$,\n$$\n\\langle f, g \\rangle = \\int_{0}^{1} f(x)\\,g(x)\\,\\mathrm{d}x,\n$$\nand enforce the POD normalization condition $\\int_{0}^{1} \\phi_{k}(x)^{2}\\,\\mathrm{d}x = 1$ for each mode. Present the two nontrivial spatial POD modes in descending energy order, and provide your final answer as a single analytical expression containing both modes. No rounding is required.",
            "solution": "The first step is to compute the time-averaged two-point correlation operator, $R(x,x')$. We substitute the expression for $u(x,t)$ into its definition:\n$$\nR(x,x') = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\left( \\sin(2\\pi x)\\cos(\\omega_{1} t) + \\sin(3\\pi x)\\cos(\\omega_{2} t) \\right) \\left( \\sin(2\\pi x')\\cos(\\omega_{1} t) + \\sin(3\\pi x')\\cos(\\omega_{2} t) \\right) \\mathrm{d}t.\n$$\nExpanding the product inside the integral gives four terms. We can separate the spatial and temporal parts:\n\\begin{align*}\nR(x,x') = &\\sin(2\\pi x)\\sin(2\\pi x') \\left( \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\cos^2(\\omega_{1} t) \\mathrm{d}t \\right) \\\\\n&+ \\sin(3\\pi x)\\sin(3\\pi x') \\left( \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\cos^2(\\omega_{2} t) \\mathrm{d}t \\right) \\\\\n&+ \\sin(2\\pi x)\\sin(3\\pi x') \\left( \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\cos(\\omega_{1} t)\\cos(\\omega_{2} t) \\mathrm{d}t \\right) \\\\\n&+ \\sin(3\\pi x)\\sin(2\\pi x') \\left( \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\cos(\\omega_{1} t)\\cos(\\omega_{2} t) \\mathrm{d}t \\right).\n\\end{align*}\nWe evaluate the time-average integrals. For any $\\omega > 0$:\n$$\n\\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\cos^2(\\omega t) \\mathrm{d}t = \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\frac{1 + \\cos(2\\omega t)}{2} \\mathrm{d}t = \\lim_{T \\to \\infty} \\frac{1}{T} \\left[ \\frac{t}{2} + \\frac{\\sin(2\\omega t)}{4\\omega} \\right]_{0}^{T} = \\frac{1}{2}.\n$$\nFor the cross-terms, since $\\omega_{1} \\neq \\omega_{2}$, we use the product-to-sum identity $\\cos(A)\\cos(B) = \\frac{1}{2}(\\cos(A-B) + \\cos(A+B))$:\n$$\n\\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\cos(\\omega_{1} t)\\cos(\\omega_{2} t) \\mathrm{d}t = \\frac{1}{2} \\lim_{T \\to \\infty} \\frac{1}{T} \\int_{0}^{T} \\left( \\cos((\\omega_{1}-\\omega_{2})t) + \\cos((\\omega_{1}+\\omega_{2})t) \\right) \\mathrm{d}t = 0.\n$$\nThe integrals of the cosine terms with non-zero frequencies vanish when averaged over an infinite interval.\n\nSubstituting these temporal averages back into the expression for $R(x,x')$, the cross-terms vanish, yielding:\n$$\nR(x,x') = \\frac{1}{2} \\sin(2\\pi x)\\sin(2\\pi x') + \\frac{1}{2} \\sin(3\\pi x)\\sin(3\\pi x').\n$$\nThe spatial POD modes $\\phi(x)$ are the eigenfunctions of the Fredholm integral equation associated with this kernel:\n$$\n\\int_{0}^{1} R(x,x') \\phi(x') \\mathrm{d}x' = \\lambda \\phi(x),\n$$\nwhere $\\lambda$ are the corresponding eigenvalues, representing the energy of each mode.\n\nLet's define the spatial basis functions $\\psi_{1}(x) = \\sin(2\\pi x)$ and $\\psi_{2}(x) = \\sin(3\\pi x)$. The kernel is $R(x,x') = \\frac{1}{2}\\psi_{1}(x)\\psi_{1}(x') + \\frac{1}{2}\\psi_{2}(x)\\psi_{2}(x')$. Substituting this into the integral equation:\n$$\n\\int_{0}^{1} \\left(\\frac{1}{2}\\psi_{1}(x)\\psi_{1}(x') + \\frac{1}{2}\\psi_{2}(x)\\psi_{2}(x')\\right) \\phi(x') \\mathrm{d}x' = \\lambda \\phi(x).\n$$\nUsing the inner product notation $\\langle f, g \\rangle = \\int_{0}^{1} f(x)g(x)\\mathrm{d}x$:\n$$\n\\frac{1}{2}\\psi_{1}(x)\\langle \\psi_{1}, \\phi \\rangle + \\frac{1}{2}\\psi_{2}(x)\\langle \\psi_{2}, \\phi \\rangle = \\lambda \\phi(x).\n$$\nThis equation reveals that any eigenfunction $\\phi(x)$ must be a linear combination of $\\psi_{1}(x)$ and $\\psi_{2}(x)$. The functions $\\psi_{1}(x)$ and $\\psi_{2}(x)$ are orthogonal on the interval $[0,1]$ because they are of the form $\\sin(n\\pi x)$ for distinct integers $n$. Let's compute their norms:\n$$\n\\langle \\psi_{1}, \\psi_{1} \\rangle = \\int_{0}^{1} \\sin^{2}(2\\pi x) \\mathrm{d}x = \\int_{0}^{1} \\frac{1-\\cos(4\\pi x)}{2} \\mathrm{d}x = \\left[ \\frac{x}{2} - \\frac{\\sin(4\\pi x)}{8\\pi} \\right]_{0}^{1} = \\frac{1}{2}.\n$$\n$$\n\\langle \\psi_{2}, \\psi_{2} \\rangle = \\int_{0}^{1} \\sin^{2}(3\\pi x) \\mathrm{d}x = \\int_{0}^{1} \\frac{1-\\cos(6\\pi x)}{2} \\mathrm{d}x = \\left[ \\frac{x}{2} - \\frac{\\sin(6\\pi x)}{12\\pi} \\right]_{0}^{1} = \\frac{1}{2}.\n$$\nAnd $\\langle \\psi_{1}, \\psi_{2} \\rangle = 0$.\n\nSince the operator $R$ is constructed from an orthogonal basis $\\{\\psi_1, \\psi_2\\}$, its eigenfunctions will be aligned with this basis.\nLet's test $\\phi(x) = \\psi_{1}(x)$. The eigenvalue equation becomes:\n$$\n\\frac{1}{2}\\psi_{1}(x)\\langle \\psi_{1}, \\psi_{1} \\rangle + \\frac{1}{2}\\psi_{2}(x)\\langle \\psi_{2}, \\psi_{1} \\rangle = \\lambda_{1} \\psi_{1}(x).\n$$\n$$\n\\frac{1}{2}\\psi_{1}(x) \\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\psi_{2}(x)(0) = \\lambda_{1} \\psi_{1}(x) \\implies \\frac{1}{4} \\psi_{1}(x) = \\lambda_{1} \\psi_{1}(x).\n$$\nThus, the first eigenvalue is $\\lambda_{1} = 1/4$, and the corresponding unnormalized eigenfunction is $\\psi_{1}(x) = \\sin(2\\pi x)$.\n\nSimilarly, by testing $\\phi(x) = \\psi_{2}(x)$:\n$$\n\\frac{1}{2}\\psi_{1}(x)\\langle \\psi_{1}, \\psi_{2} \\rangle + \\frac{1}{2}\\psi_{2}(x)\\langle \\psi_{2}, \\psi_{2} \\rangle = \\lambda_{2} \\psi_{2}(x).\n$$\n$$\n\\frac{1}{2}\\psi_{1}(x)(0) + \\frac{1}{2}\\psi_{2}(x)\\left(\\frac{1}{2}\\right) = \\lambda_{2} \\psi_{2}(x) \\implies \\frac{1}{4} \\psi_{2}(x) = \\lambda_{2} \\psi_{2}(x).\n$$\nThe second eigenvalue is $\\lambda_{2} = 1/4$, and the corresponding unnormalized eigenfunction is $\\psi_{2}(x) = \\sin(3\\pi x)$.\n\nThese are the only two non-trivial modes, as the kernel $R$ has a rank of $2$. All other eigenfunctions will correspond to the eigenvalue $\\lambda=0$.\n\nThe final step is to normalize the eigenfunctions according to the condition $\\int_{0}^{1} \\phi_{k}(x)^2 \\mathrm{d}x = 1$.\nFor the first mode, $\\phi_{1}(x) = C_{1}\\psi_{1}(x)$:\n$$\n\\int_{0}^{1} (C_{1}\\sin(2\\pi x))^{2} \\mathrm{d}x = C_{1}^{2} \\int_{0}^{1} \\sin^{2}(2\\pi x) \\mathrm{d}x = C_{1}^{2} \\cdot \\frac{1}{2} = 1 \\implies C_{1} = \\sqrt{2}.\n$$\nSo, the first normalized POD mode is $\\phi_{1}(x) = \\sqrt{2}\\sin(2\\pi x)$.\n\nFor the second mode, $\\phi_{2}(x) = C_{2}\\psi_{2}(x)$:\n$$\n\\int_{0}^{1} (C_{2}\\sin(3\\pi x))^{2} \\mathrm{d}x = C_{2}^{2} \\int_{0}^{1} \\sin^{2}(3\\pi x) \\mathrm{d}x = C_{2}^{2} \\cdot \\frac{1}{2} = 1 \\implies C_{2} = \\sqrt{2}.\n$$\nThe second normalized POD mode is $\\phi_{2}(x) = \\sqrt{2}\\sin(3\\pi x)$.\n\nThe energies (eigenvalues) of both modes are equal, $\\lambda_1 = \\lambda_2 = 1/4$. Therefore, the \"descending energy order\" is not strict. We present the modes ordered by their spatial wavenumber.\n\nThe two non-trivial spatial POD modes are $\\phi_{1}(x) = \\sqrt{2}\\sin(2\\pi x)$ and $\\phi_{2}(x) = \\sqrt{2}\\sin(3\\pi x)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{2}\\sin(2\\pi x) & \\sqrt{2}\\sin(3\\pi x) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In practical applications, raw data is rarely ready for immediate analysis. This computational exercise explores one of the most critical pre-processing steps for POD: mean-subtraction. By comparing the POD basis of a dataset with and without its temporal mean removed, you will discover why POD is fundamentally a tool for capturing *variance*, and how failing to account for the mean can lead to a misinterpretation of the system's dominant dynamics .",
            "id": "3265876",
            "problem": "You are given a family of synthetic snapshot matrices representing temperature fields measured on a one-dimensional spatial grid over time. The goal is to analyze how subtracting the temporal mean affects the Proper Orthogonal Decomposition (POD) basis. Proper Orthogonal Decomposition (POD) is defined as the orthonormal basis obtained from the left singular vectors of the data matrix via the Singular Value Decomposition (SVD), which optimally captures the variance (energy) of the data in a least-squares sense. Specifically, if a data matrix is denoted by $X \\in \\mathbb{R}^{n \\times m}$ with columns as snapshots, the SVD is $X = U \\Sigma V^{\\top}$, where $U \\in \\mathbb{R}^{n \\times n}$ has orthonormal columns (spatial modes), $\\Sigma \\in \\mathbb{R}^{n \\times m}$ is diagonal with nonnegative entries (singular values), and $V \\in \\mathbb{R}^{m \\times m}$ has orthonormal columns (temporal coefficients). The energy captured by the first mode is quantified by $\\sigma_{1}^{2} / \\sum_{i} \\sigma_{i}^{2}$, where $\\sigma_{i}$ are the singular values.\n\nYou will construct data matrices from first principles as follows. Consider a spatial grid with $n$ points $x_{j}$ uniformly spaced over $[0,1)$ and $m$ time snapshots indexed by $k = 0, 1, \\dots, m-1$. Define two spatial patterns: a mean pattern $\\phi_{\\mathrm{mean}}(x) \\equiv 1$ and an oscillatory pattern $\\phi_{\\mathrm{osc}}(x) \\equiv \\sin(2 \\pi x)$. Normalize each spatial pattern to unit Euclidean norm in $\\mathbb{R}^{n}$. Let the phase be $\\theta_{k} = 2 \\pi k / m$. Define each snapshot (a column vector in $\\mathbb{R}^{n}$) as\n$$\nT_{k} = A \\,\\phi_{\\mathrm{mean}} + B \\cos(\\theta_{k}) \\,\\phi_{\\mathrm{osc}},\n$$\nand assemble the snapshot matrix $X = [T_{0}\\; T_{1}\\; \\cdots\\; T_{m-1}] \\in \\mathbb{R}^{n \\times m}$.\n\nTwo versions of the POD basis are to be computed for each $X$:\n- The uncentered version uses $X$ directly.\n- The mean-centered version uses $X_{\\mathrm{c}} = X - \\mu \\mathbf{1}^{\\top}$, where $\\mu = \\frac{1}{m} \\sum_{k=0}^{m-1} T_{k}$ is the temporal mean field and $\\mathbf{1} \\in \\mathbb{R}^{m}$ is the vector of ones.\n\nFrom each SVD, extract:\n- The first left singular vector $u_{1}$ (unit norm) and the singular values $\\{\\sigma_{i}\\}$.\n- Define the absolute correlation between $u_{1}$ and the mean field $\\mu$ as\n$$\nr \\equiv \\begin{cases}\n\\left| \\frac{u_{1}^{\\top} \\mu}{\\| \\mu \\|_{2}} \\right| & \\text{if } \\| \\mu \\|_{2} > 0 \\\\\n0 & \\text{if } \\| \\mu \\|_{2} = 0\n\\end{cases}\n$$\nwhere $\\| \\cdot \\|_{2}$ denotes the Euclidean norm. If the data matrix (centered or uncentered) is numerically zero so that $\\sum_{i} \\sigma_{i}^{2} = 0$, define its first-mode energy fraction as $0$ and set the correlation $r$ to $0$ by convention.\n\nFor each test case below, compute four quantities:\n- $r_{\\mathrm{unc}}$: absolute correlation between the uncentered first mode and $\\mu$.\n- $r_{\\mathrm{cen}}$: absolute correlation between the centered first mode and $\\mu$.\n- $e_{\\mathrm{unc}}$: uncentered first-mode energy fraction, equal to $\\sigma_{1}^{2} / \\sum_{i} \\sigma_{i}^{2}$ for $X$.\n- $e_{\\mathrm{cen}}$: centered first-mode energy fraction, equal to $\\sigma_{1}^{2} / \\sum_{i} \\sigma_{i}^{2}$ for $X_{\\mathrm{c}}$.\n\nUse the following fixed parameters (no randomness is allowed):\n- Spatial grid size $n = 128$ with $x_{j}$ uniformly spaced in $[0,1)$.\n- Number of snapshots $m = 80$ with $\\theta_{k} = 2 \\pi k / m$ for $k = 0, 1, \\dots, m-1$.\n\nTest suite of parameter values $(A, B)$:\n- Case $1$ (non-zero-mean dominant): $(A, B) = (3, 1)$.\n- Case $2$ (zero mean): $(A, B) = (0, 1)$.\n- Case $3$ (constant field): $(A, B) = (2, 0)$.\n- Case $4$ (oscillation dominant with small mean): $(A, B) = (0.1, 2)$.\n\nYour program must:\n- Construct $X$ for each case exactly as specified.\n- Compute $(r_{\\mathrm{unc}}, r_{\\mathrm{cen}}, e_{\\mathrm{unc}}, e_{\\mathrm{cen}})$ for each case.\n- Round each reported value to $6$ decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of results, one per test case, where each test case result is the list $[r_{\\mathrm{unc}}, r_{\\mathrm{cen}}, e_{\\mathrm{unc}}, e_{\\mathrm{cen}}]$.\n- The entire output must be printed as a single line with no spaces, using square brackets and comma separators, for example, $[[a_{11},a_{12},a_{13},a_{14}],[a_{21},a_{22},a_{23},a_{24}],\\dots]$, where each $a_{ij}$ is a floating-point number rounded to $6$ decimal places.",
            "solution": "The problem requires a comparison of the Proper Orthogonal Decomposition (POD) basis for a given synthetic dataset, $X$, and its mean-centered version, $X_c$. The analysis focuses on the first POD mode, its alignment with the temporal mean field, and the fraction of total variance it captures. The solution involves both a theoretical derivation and a numerical implementation.\n\n**1. Theoretical Framework**\n\n**Spatial Basis Construction**:\nThe spatial domain is a one-dimensional grid with $n=128$ points. Two spatial patterns are defined and normalized to have a unit Euclidean norm:\n- A constant pattern: $\\phi_{\\mathrm{mean}}$.\n- An oscillatory pattern: $\\phi_{\\mathrm{osc}}(x) = \\sin(2\\pi x)$.\nThese two vectors are orthogonal.\n\n**Temporal Basis Construction**:\nThe temporal behavior is described by $m=80$ snapshots. Two temporal vectors arise:\n- A constant vector: $\\mathbf{1} \\in \\mathbb{R}^m$.\n- A cosine vector: $c = [\\cos(2\\pi k/m)]_{k=0}^{m-1} \\in \\mathbb{R}^m$.\nThese two vectors are also orthogonal.\n\n**Snapshot Matrix and its SVD**:\nThe snapshot matrix $X = [T_0 \\dots T_{m-1}]$ can be written as an outer product sum:\n$$\nX = A \\phi_{\\mathrm{mean}}\\mathbf{1}^{\\top} + B \\phi_{\\mathrm{osc}}c^{\\top}\n$$\nBecause the spatial vectors $(\\phi_{\\mathrm{mean}}, \\phi_{\\mathrm{osc}})$ and temporal vectors $(\\mathbf{1}, c)$ form orthogonal pairs, the SVD of $X$ is composed of two non-zero singular values, $\\sigma_{\\mathrm{mean}} = A\\sqrt{m}$ and $\\sigma_{\\mathrm{osc}} = B\\sqrt{m/2}$, with corresponding left singular vectors (POD modes) $\\phi_{\\mathrm{mean}}$ and $\\phi_{\\mathrm{osc}}$. The first POD mode, $u_1$, will be the one associated with the larger singular value.\n\n**Mean Field and Centered Data**:\nThe temporal mean field is $\\mu = \\frac{1}{m}\\sum_k T_k$.\n$$\n\\mu = \\frac{1}{m} \\sum_{k=0}^{m-1} (A \\phi_{\\mathrm{mean}} + B \\cos(\\theta_k) \\phi_{\\mathrm{osc}}) = A \\phi_{\\mathrm{mean}} + B \\phi_{\\mathrm{osc}} \\left(\\frac{1}{m} \\sum_{k=0}^{m-1} \\cos(\\theta_k)\\right)\n$$\nSince $\\sum \\cos(\\theta_k) = 0$ for $m>1$, we have $\\mu = A \\phi_{\\mathrm{mean}}$. The mean-centered data matrix is:\n$$\nX_c = X - \\mu \\mathbf{1}^{\\top} = (A \\phi_{\\mathrm{mean}}\\mathbf{1}^{\\top} + B \\phi_{\\mathrm{osc}}c^{\\top}) - (A \\phi_{\\mathrm{mean}})\\mathbf{1}^{\\top} = B \\phi_{\\mathrm{osc}}c^{\\top}\n$$\nThus, $X_c$ is a rank-1 matrix whose only POD mode is $\\phi_{\\mathrm{osc}}$ (if $B \\neq 0$). Its POD basis captures the variance around the mean, not the mean itself.\n\n**2. Numerical Implementation**\n\nThe following Python code implements the required computations for each test case.\n\n```python\nimport numpy as np\n\ndef compute_pod_metrics(A, B, n, m):\n    \"\"\"\n    Computes POD metrics for a given set of parameters.\n\n    Args:\n        A (float): Amplitude of the mean pattern.\n        B (float): Amplitude of the oscillatory pattern.\n        n (int): Number of spatial grid points.\n        m (int): Number of time snapshots.\n\n    Returns:\n        tuple: A tuple containing (r_unc, r_cen, e_unc, e_cen).\n    \"\"\"\n    # 1. Define grid and spatial patterns\n    x = np.linspace(0, 1, n, endpoint=False)\n    phi_mean_raw = np.ones(n)\n    phi_osc_raw = np.sin(2 * np.pi * x)\n\n    # 2. Normalize spatial patterns to unit Euclidean norm\n    norm_mean = np.linalg.norm(phi_mean_raw)\n    norm_osc = np.linalg.norm(phi_osc_raw)\n    \n    phi_mean = phi_mean_raw / norm_mean if norm_mean > 0 else phi_mean_raw\n    phi_osc = phi_osc_raw / norm_osc if norm_osc > 0 else phi_osc_raw\n\n    # 3. Construct the snapshot matrix X\n    k_vals = np.arange(m)\n    theta_k = 2 * np.pi * k_vals / m\n    cos_theta = np.cos(theta_k)\n\n    X = A * np.outer(phi_mean, np.ones(m)) + B * np.outer(phi_osc, cos_theta)\n    \n    # 4. Calculate the temporal mean field mu\n    mu = np.mean(X, axis=1)\n    mu_norm = np.linalg.norm(mu)\n\n    # 5. Compute metrics for the uncentered data X\n    U_unc, s_unc, _ = np.linalg.svd(X, full_matrices=False)\n    total_energy_sq_unc = np.sum(s_unc**2)\n\n    if total_energy_sq_unc > 1e-14:\n        e_unc = s_unc[0]**2 / total_energy_sq_unc\n        u1_unc = U_unc[:, 0]\n        if mu_norm > 1e-14:\n            r_unc = np.abs(np.dot(u1_unc, mu) / mu_norm)\n        else:\n            r_unc = 0.0\n    else:\n        e_unc = 0.0\n        r_unc = 0.0\n\n    # 6. Compute metrics for the mean-centered data X_c\n    X_c = X - mu.reshape(-1, 1)\n    \n    U_cen, s_cen, _ = np.linalg.svd(X_c, full_matrices=False)\n    total_energy_sq_cen = np.sum(s_cen**2)\n\n    if total_energy_sq_cen > 1e-14:\n        e_cen = s_cen[0]**2 / total_energy_sq_cen\n        u1_cen = U_cen[:, 0]\n        if mu_norm > 1e-14:\n            r_cen = np.abs(np.dot(u1_cen, mu) / mu_norm)\n        else:\n            r_cen = 0.0\n    else:\n        e_cen = 0.0\n        r_cen = 0.0\n        \n    return r_unc, r_cen, e_unc, e_cen\n```\nRunning this code for the specified test cases yields the final answer.",
            "answer": "[[1.000000,0.000000,0.947368,1.000000],[0.000000,0.000000,1.000000,1.000000],[1.000000,0.000000,1.000000,0.000000],[0.000000,0.000000,0.995025,1.000000]]"
        }
    ]
}