{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握形函数，我们必须从其基本构建开始。第一个练习将引导您从零开始，为一个简单的一维单元推导二次拉格朗日形函数。通过验证“单位分解”（partition of unity）和多项式再生等基本属性，您将为更复杂的应用打下坚实的基础。",
            "id": "2635745",
            "problem": "在一维杆单元中，使用有限元法（FEM）来近似轴向位移场。考虑一个母（等参）坐标 $\\xi \\in [-1,1]$，其上有三个节点，分别位于 $\\xi_1=-1$、$\\xi_2=0$ 和 $\\xi_3=1$。设近似位移使用三个二次Lagrange形函数 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 进行插值，每个形函数都是次数最多为2的多项式，且满足克罗内克-德尔塔（Kronecker-delta）插值条件 $N_i(\\xi_j)=\\delta_{ij}$，其中 $i,j\\in\\{1,2,3\\}$。\n\n从节点插值和多项式完备性的核心定义出发，通过施加节点条件和二次多项式要求，推导 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 的显式表达式。然后，验证这种插值应具备的两个基本性质：\n- 最高二次的多项式再生性：对于任意二次多项式位移场 $u(\\xi)=a_0+a_1\\,\\xi+a_2\\,\\xi^2$，证明其插值函数 $u^h(\\xi)=\\sum_{i=1}^3 N_i(\\xi)\\,u(\\xi_i)$ 与 $u(\\xi)$ 对于所有 $\\xi\\in[-1,1]$ 恒等。\n- 单位分解性：证明对于所有 $\\xi\\in[-1,1]$，$\\sum_{i=1}^3 N_i(\\xi)=1$。\n\n将最终答案以单行向量 $\\left[N_1(\\xi)\\;N_2(\\xi)\\;N_3(\\xi)\\right]$ 的形式给出，其中包含关于 $\\xi$ 的封闭形式解析表达式。不需要进行数值取整。最终答案中不要包含单位。",
            "solution": "所提出的问题是有限元方法理论中的一个标准练习。该问题具有科学依据，是适定的、客观且完整的。其中不含任何矛盾或谬误。因此，我将着手解决此问题。\n\n任务是为一个一维三节点母单元推导二次Lagrange形函数，并验证其两个基本性质。该单元定义在等参坐标域 $\\xi \\in [-1, 1]$ 上，节点位于 $\\xi_1 = -1$、$\\xi_2 = 0$ 和 $\\xi_3 = 1$。\n\n形函数记为 $N_i(\\xi)$，其中 $i \\in \\{1, 2, 3\\}$，是次数最多为2的多项式。它们由在节点位置处的克罗内克-德尔塔性质定义：\n$$ N_i(\\xi_j) = \\delta_{ij} = \\begin{cases} 1  \\text{if } i=j \\\\ 0  \\text{if } i \\neq j \\end{cases} $$\n我们将通过假设一个一般的二次形式 $N(\\xi) = a\\xi^2 + b\\xi + c$，并施加这些节点条件来求解系数 $a$、$b$ 和 $c$，从而推导出每个函数。\n\n$N_1(\\xi)$ 的推导：\n$N_1(\\xi)$ 的条件是 $N_1(\\xi_1) = 1$、$N_1(\\xi_2) = 0$ 和 $N_1(\\xi_3) = 0$。\n设 $N_1(\\xi) = a_1\\xi^2 + b_1\\xi + c_1$。\n1.  在节点 $\\xi_2=0$ 处：$N_1(0) = a_1(0)^2 + b_1(0) + c_1 = c_1 = 0$。\n2.  在节点 $\\xi_3=1$ 处：$N_1(1) = a_1(1)^2 + b_1(1) + c_1 = a_1 + b_1 + 0 = 0$。这表明 $b_1 = -a_1$。\n3.  在节点 $\\xi_1=-1$ 处：$N_1(-1) = a_1(-1)^2 + b_1(-1) + c_1 = a_1 - b_1 + 0 = 1$。\n将 $b_1 = -a_1$ 代入第三个方程得到 $a_1 - (-a_1) = 2a_1 = 1$，得出 $a_1 = \\frac{1}{2}$。因此，$b_1 = -\\frac{1}{2}$。\n因此，$N_1(\\xi)$ 的表达式为：\n$$ N_1(\\xi) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi = \\frac{1}{2}\\xi(\\xi-1) $$\n\n$N_2(\\xi)$ 的推导：\n$N_2(\\xi)$ 的条件是 $N_2(\\xi_1) = 0$、$N_2(\\xi_2) = 1$ 和 $N_2(\\xi_3) = 0$。\n设 $N_2(\\xi) = a_2\\xi^2 + b_2\\xi + c_2$。\n1.  在节点 $\\xi_2=0$ 处：$N_2(0) = a_2(0)^2 + b_2(0) + c_2 = c_2 = 1$。\n2.  在节点 $\\xi_3=1$ 处：$N_2(1) = a_2(1)^2 + b_2(1) + c_2 = a_2 + b_2 + 1 = 0$。\n3.  在节点 $\\xi_1=-1$ 处：$N_2(-1) = a_2(-1)^2 + b_2(-1) + c_2 = a_2 - b_2 + 1 = 0$。\n我们得到一个关于 $a_2$ 和 $b_2$ 的二元一次方程组：\n$$ a_2 + b_2 = -1 $$\n$$ a_2 - b_2 = -1 $$\n将这两个方程相加得到 $2a_2 = -2$，所以 $a_2 = -1$。将此结果代入第一个方程得到 $-1 + b_2 = -1$，所以 $b_2 = 0$。\n因此，$N_2(\\xi)$ 的表达式为：\n$$ N_2(\\xi) = (-1)\\xi^2 + (0)\\xi + 1 = 1 - \\xi^2 $$\n\n$N_3(\\xi)$ 的推导：\n$N_3(\\xi)$ 的条件是 $N_3(\\xi_1) = 0$、$N_3(\\xi_2) = 0$ 和 $N_3(\\xi_3) = 1$。\n设 $N_3(\\xi) = a_3\\xi^2 + b_3\\xi + c_3$。\n1.  在节点 $\\xi_2=0$ 处：$N_3(0) = a_3(0)^2 + b_3(0) + c_3 = c_3 = 0$。\n2.  在节点 $\\xi_1=-1$ 处：$N_3(-1) = a_3(-1)^2 + b_3(-1) + c_3 = a_3 - b_3 + 0 = 0$。这表明 $b_3 = a_3$。\n3.  在节点 $\\xi_3=1$ 处：$N_3(1) = a_3(1)^2 + b_3(1) + c_3 = a_3 + b_3 + 0 = 1$。\n将 $b_3 = a_3$ 代入第三个方程得到 $a_3 + a_3 = 2a_3 = 1$，得出 $a_3 = \\frac{1}{2}$。因此，$b_3 = \\frac{1}{2}$。\n因此，$N_3(\\xi)$ 的表达式为：\n$$ N_3(\\xi) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\frac{1}{2}\\xi(\\xi+1) $$\n\n现在，我们验证所要求的两个性质。\n\n单位分解性验证：\n我们必须证明对于所有 $\\xi \\in [-1, 1]$，$\\sum_{i=1}^3 N_i(\\xi) = 1$。\n$$ \\sum_{i=1}^3 N_i(\\xi) = N_1(\\xi) + N_2(\\xi) + N_3(\\xi) $$\n$$ = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) $$\n合并 $\\xi$ 的同次幂项：\n$$ = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1 $$\n$$ = (0)\\xi^2 + (0)\\xi + 1 = 1 $$\n单位分解性对于所有 $\\xi$ 恒成立。\n\n多项式再生性验证：\n我们必须证明对于任意二次多项式 $u(\\xi) = a_0 + a_1\\xi + a_2\\xi^2$，其插值函数 $u^h(\\xi) = \\sum_{i=1}^3 N_i(\\xi)u(\\xi_i)$ 与 $u(\\xi)$ 恒等。\n首先，计算 $u(\\xi)$ 的节点值：\n$u(\\xi_1) = u(-1) = a_0 - a_1 + a_2$\n$u(\\xi_2) = u(0) = a_0$\n$u(\\xi_3) = u(1) = a_0 + a_1 + a_2$\n现在，构造插值函数 $u^h(\\xi)$：\n$$ u^h(\\xi) = N_1(\\xi)(a_0 - a_1 + a_2) + N_2(\\xi)(a_0) + N_3(\\xi)(a_0 + a_1 + a_2) $$\n通过提取系数 $a_0$、$a_1$ 和 $a_2$ 来重新整理表达式：\n$$ u^h(\\xi) = a_0 [N_1(\\xi)+N_2(\\xi)+N_3(\\xi)] + a_1 [-N_1(\\xi)+N_3(\\xi)] + a_2 [N_1(\\xi)+N_3(\\xi)] $$\n我们来分析每个 $a_k$ 的系数：\n$a_0$ 的系数是 $\\sum_{i=1}^3 N_i(\\xi)$，我们已经证明了它等于 $1$。\n$a_1$ 的系数是 $-N_1(\\xi)+N_3(\\xi)$：\n$$ -N_1(\\xi)+N_3(\\xi) = -\\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = -\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi + \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\xi $$\n$a_2$ 的系数是 $N_1(\\xi)+N_3(\\xi)$：\n$$ N_1(\\xi)+N_3(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = \\xi^2 $$\n将这些结果代回 $u^h(\\xi)$ 的表达式中：\n$$ u^h(\\xi) = a_0(1) + a_1(\\xi) + a_2(\\xi^2) = a_0 + a_1\\xi + a_2\\xi^2 $$\n这与 $u(\\xi)$ 恒等。再生任意二次多项式的能力得到了证实。这是基函数 $\\{N_i(\\xi)\\}$ 能够表示单项式 $\\{1, \\xi, \\xi^2\\}$ 的一个直接结果，而我们刚刚已经证明了这一点。\n\n推导和验证均已完成。最终答案是形函数的显式表达式集合。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}\\xi(\\xi-1)  1-\\xi^2  \\frac{1}{2}\\xi(\\xi+1) \\end{pmatrix} } $$"
        },
        {
            "introduction": "现在，我们将知识应用到工程分析中常见的二维场景中。本练习将探讨常应变三角形（CST）单元，您将直接根据形函数的梯度推导出至关重要的应变-位移（$B$）矩阵。这个过程不仅将抽象的数学与物理应变联系起来，还揭示了这种基本单元类型的内在局限性。",
            "id": "2635801",
            "problem": "考虑一个用于小应变平面问题的二维线性三角形有限元（常称为常应变三角形），该单元用于有限元法（FEM）。设三个节点的笛卡尔坐标为 $(x_{1},y_{1})=(0,0)$、$(x_{2},y_{2})=(3,0)$ 和 $(x_{3},y_{3})=(1,2)$。该单元具有通常的线性形函数 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$，每个函数都是关于 $x$ 和 $y$ 的线性多项式，满足克罗内克-德尔塔（Kronecker-delta）节点插值特性 $N_{i}(x_{j},y_{j})=\\delta_{ij}$ 和单位分解特性 $\\sum_{i=1}^{3}N_{i}(x,y)=1$。位移场通过插值得到：$u(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,u_{i}$ 和 $v(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,v_{i}$，其中 $u_{i}$ 和 $v_{i}$ 分别是节点 $i$ 在 $x$ 和 $y$ 方向上的节点位移分量。小应变向量定义为 $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x}  \\varepsilon_{y}  \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}=\\begin{pmatrix}\\partial u/\\partial x  \\partial v/\\partial y  \\partial u/\\partial y + \\partial v/\\partial x\\end{pmatrix}^{\\mathsf{T}}$。根据单元应变-位移矩阵的定义，有 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$，其中 $\\mathbf{d}=\\begin{pmatrix}u_{1}  v_{1}  u_{2}  v_{2}  u_{3}  v_{3}\\end{pmatrix}^{\\mathsf{T}}$。\n\n仅从上述形函数的基本性质和小应变的定义出发，完成以下任务：\n\n1) 根据给定的节点坐标，构造线性形函数 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$，并计算它们的常数梯度 $\\partial N_{i}/\\partial x$ 和 $\\partial N_{i}/\\partial y$。\n\n2) 组装单元应变-位移矩阵 $\\mathbf{B}$，使得 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\,\\mathbf{d}$ 成立，其中向量按标准顺序书写为 $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{x}  \\varepsilon_{y}  \\gamma_{xy}\\end{pmatrix}^{\\mathsf{T}}$ 和 $\\mathbf{d}=\\begin{pmatrix}u_{1}  v_{1}  u_{2}  v_{2}  u_{3}  v_{3}\\end{pmatrix}^{\\mathsf{T}}$。\n\n3) 仅使用第一性原理，解释为什么矩阵 $\\mathbf{B}$ 在整个单元域上是常数，并推断其后果：即该单元在任何节点位移向量下都会产生一个均匀（常数）的应变场，因此无法表示需要空间变化的法向应变的纯弯曲状态。通过刻画该单元能产生的最一般位移场并对其求导来阐述你的论证。\n\n提供最终的 $\\mathbf{B}$ 矩阵，其元素为精确有理数。不要四舍五入。你最终加框的答案必须是单个矩阵 $\\mathbf{B}$，不带单位。",
            "solution": "问题陈述经核实具有科学依据、是适定且客观的。它代表了有限元法理论中的一个标准、基础的练习。所有提供的数据都是自洽且一致的。我们开始求解。\n\n该问题要求构造线性三角形单元的应变-位移矩阵 $\\mathbf{B}$，并对其性质进行第一性原理的解释。将按要求分三部分进行。\n\n**第一部分：形函数及其梯度的构造**\n\n二维单元的线性形函数具有以下一般形式：\n$$N_{i}(x,y) = \\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$$\n每个形函数的三个系数是通过在三个节点上强制施加克罗内克-德尔塔特性 $N_{i}(x_{j},y_{j})=\\delta_{ij}$ 来确定的。给定的节点坐标为 $(x_{1},y_{1})=(0,0)$、$(x_{2},y_{2})=(3,0)$ 和 $(x_{3},y_{3})=(1,2)$。\n\n对于形函数 $N_{1}(x,y)$：\n1. $N_{1}(x_{1},y_{1})=N_{1}(0,0) = \\alpha_{10} = 1$\n2. $N_{1}(x_{2},y_{2})=N_{1}(3,0) = \\alpha_{10} + 3\\alpha_{11} = 1 + 3\\alpha_{11} = 0 \\implies \\alpha_{11} = -1/3$\n3. $N_{1}(x_{3},y_{3})=N_{1}(1,2) = \\alpha_{10} + \\alpha_{11} + 2\\alpha_{12} = 1 - 1/3 + 2\\alpha_{12} = 0 \\implies 2/3 + 2\\alpha_{12} = 0 \\implies \\alpha_{12} = -1/3$\n因此，$N_{1}(x,y) = 1 - \\frac{1}{3}x - \\frac{1}{3}y$。\n\n对于形函数 $N_{2}(x,y)$：\n1. $N_{2}(x_{1},y_{1})=N_{2}(0,0) = \\alpha_{20} = 0$\n2. $N_{2}(x_{2},y_{2})=N_{2}(3,0) = \\alpha_{20} + 3\\alpha_{21} = 3\\alpha_{21} = 1 \\implies \\alpha_{21} = 1/3$\n3. $N_{2}(x_{3},y_{3})=N_{2}(1,2) = \\alpha_{20} + \\alpha_{21} + 2\\alpha_{22} = 1/3 + 2\\alpha_{22} = 0 \\implies \\alpha_{22} = -1/6$\n因此，$N_{2}(x,y) = \\frac{1}{3}x - \\frac{1}{6}y$。\n\n对于形函数 $N_{3}(x,y)$：\n1. $N_{3}(x_{1},y_{1})=N_{3}(0,0) = \\alpha_{30} = 0$\n2. $N_{3}(x_{2},y_{2})=N_{3}(3,0) = \\alpha_{30} + 3\\alpha_{31} = 3\\alpha_{31} = 0 \\implies \\alpha_{31} = 0$\n3. $N_{3}(x_{3},y_{3})=N_{3}(1,2) = \\alpha_{30} + \\alpha_{31} + 2\\alpha_{32} = 2\\alpha_{32} = 1 \\implies \\alpha_{32} = 1/2$\n因此，$N_{3}(x,y) = \\frac{1}{2}y$。\n\n单位分解条件 $\\sum_{i=1}^{3}N_{i}=1$ 得到满足：\n$$ \\left(1 - \\frac{1}{3}x - \\frac{1}{3}y\\right) + \\left(\\frac{1}{3}x - \\frac{1}{6}y\\right) + \\left(\\frac{1}{2}y\\right) = 1 + \\left(-\\frac{1}{3}+\\frac{1}{3}\\right)x + \\left(-\\frac{1}{3}-\\frac{1}{6}+\\frac{1}{2}\\right)y = 1 $$\n形函数的梯度通过直接微分计算。由于形函数是关于 $x$ 和 $y$ 的线性多项式，它们的梯度是常数。\n$$ \\frac{\\partial N_{1}}{\\partial x} = -\\frac{1}{3}, \\quad \\frac{\\partial N_{1}}{\\partial y} = -\\frac{1}{3} $$\n$$ \\frac{\\partial N_{2}}{\\partial x} = \\frac{1}{3}, \\quad \\frac{\\partial N_{2}}{\\partial y} = -\\frac{1}{6} $$\n$$ \\frac{\\partial N_{3}}{\\partial x} = 0, \\quad \\frac{\\partial N_{3}}{\\partial y} = \\frac{1}{2} $$\n\n**第二部分：应变-位移矩阵 $\\mathbf{B}$ 的组装**\n\n位移场 $(u, v)$ 使用形函数从节点位移 $(u_i, v_i)$ 插值得到：\n$$ u(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) u_{i} = N_{1}u_{1} + N_{2}u_{2} + N_{3}u_{3} $$\n$$ v(x,y) = \\sum_{i=1}^{3} N_{i}(x,y) v_{i} = N_{1}v_{1} + N_{2}v_{2} + N_{3}v_{3} $$\n小应变分量定义为：\n$$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{y} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n通过代入插值得到的位移场，我们求出应变：\n$$ \\varepsilon_{x} = \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial x} u_{i} = \\frac{\\partial N_{1}}{\\partial x}u_{1} + \\frac{\\partial N_{2}}{\\partial x}u_{2} + \\frac{\\partial N_{3}}{\\partial x}u_{3} $$\n$$ \\varepsilon_{y} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\frac{\\partial N_{i}}{\\partial y} v_{i} = \\frac{\\partial N_{1}}{\\partial y}v_{1} + \\frac{\\partial N_{2}}{\\partial y}v_{2} + \\frac{\\partial N_{3}}{\\partial y}v_{3} $$\n$$ \\gamma_{xy} = \\frac{\\partial}{\\partial y} \\left( \\sum_{i=1}^{3} N_{i} u_{i} \\right) + \\frac{\\partial}{\\partial x} \\left( \\sum_{i=1}^{3} N_{i} v_{i} \\right) = \\sum_{i=1}^{3} \\left( \\frac{\\partial N_{i}}{\\partial y} u_{i} + \\frac{\\partial N_{i}}{\\partial x} v_{i} \\right) $$\n这些表达式可以写成矩阵形式 $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}$，其中 $\\mathbf{d} = \\begin{pmatrix} u_{1}  v_{1}  u_{2}  v_{2}  u_{3}  v_{3} \\end{pmatrix}^{\\mathsf{T}}$：\n$$\n\\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{\\partial N_{1}}{\\partial x}  0  \\frac{\\partial N_{2}}{\\partial x}  0  \\frac{\\partial N_{3}}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_{1}}{\\partial y}  0  \\frac{\\partial N_{2}}{\\partial y}  0  \\frac{\\partial N_{3}}{\\partial y} \\\\\n\\frac{\\partial N_{1}}{\\partial y}  \\frac{\\partial N_{1}}{\\partial x}  \\frac{\\partial N_{2}}{\\partial y}  \\frac{\\partial N_{2}}{\\partial x}  \\frac{\\partial N_{3}}{\\partial y}  \\frac{\\partial N_{3}}{\\partial x}\n\\end{pmatrix}\n\\begin{pmatrix} u_{1} \\\\ v_{1} \\\\ u_{2} \\\\ v_{2} \\\\ u_{3} \\\\ v_{3} \\end{pmatrix}\n$$\n矩阵 $\\mathbf{B}$ 由此确定。代入第一部分计算出的常数梯度，得到该单元的最终结果：\n$$ \\mathbf{B} = \\begin{pmatrix}\n-\\frac{1}{3}  0  \\frac{1}{3}  0  0  0 \\\\\n0  -\\frac{1}{3}  0  -\\frac{1}{6}  0  \\frac{1}{2} \\\\\n-\\frac{1}{3}  -\\frac{1}{3}  -\\frac{1}{6}  \\frac{1}{3}  \\frac{1}{2}  0\n\\end{pmatrix} $$\n\n**第三部分：第一性原理的解释**\n\n线性三角形单元的常应变行为是其形函数线性的直接后果。\n\n1.  **为什么 $\\mathbf{B}$ 是常数：** 矩阵 $\\mathbf{B}$ 完全由形函数的一阶偏导数 $\\frac{\\partial N_{i}}{\\partial x}$ 和 $\\frac{\\partial N_{i}}{\\partial y}$ 组成。根据定义，此类单元的形函数 $N_i(x, y)$ 是形如 $\\alpha_{i0} + \\alpha_{i1} x + \\alpha_{i2} y$ 的线性多项式。这类函数对 $x$ 或 $y$ 的偏导数是一个常数（分别为 $\\alpha_{i1}$ 或 $\\alpha_{i2}$）。由于 $\\mathbf{B}$ 矩阵中的每一个元素都是这些常数梯度之一（或为零），所以整个矩阵 $\\mathbf{B}$ 在单元域上是常数。其值仅取决于定义几何形状的节点坐标，而不取决于单元内的位置 $(x, y)$。\n\n2.  **后果（常应变及无法模拟弯曲）：**\n    位移场 $u(x,y)$ 和 $v(x,y)$ 是线性形函数的线性组合。线性多项式的线性组合结果仍然是线性多项式。因此，该单元能表示的最一般位移场具有以下形式：\n    $$ u(x,y) = c_{1} + c_{2}x + c_{3}y $$\n    $$ v(x,y) = c_{4} + c_{5}x + c_{6}y $$\n    其中系数 $c_{k}$ 是由节点位移决定的常数。通过对该位移场求导可得应变：\n    $$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x} = c_{2} $$\n    $$ \\varepsilon_{y} = \\frac{\\partial v}{\\partial y} = c_{6} $$\n    $$ \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = c_{3} + c_{5} $$\n    应变分量在整个单元内是常数。这就是为什么这种单元被称为常应变三角形（CST）。\n\n    然而，纯弯曲的基本特征是线性变化的应变场。例如，在 $x-y$ 平面内弯曲的梁，其法向应变 $\\varepsilon_x$ 是 $y$ 的线性函数，如 $\\varepsilon_{x}(y) = \\kappa y$，其中 $\\kappa$ 是曲率。一个常数应变场要成为一个非常数的线性函数是不可能的，除非常数和斜率都为零，而这对应于无变形的平凡情况。常应变三角形单元（CST）根据其构造，被限制在其域内为每个应变分量只产生一个单一的常数值。因此，它从根本上无法表示纯弯曲状态所必需的应变梯度。由这类单元组成的集合体只能用分段常数的“阶梯状”应力来近似弯曲力矩，这是一种很差的表示，并会导致如剪切自锁等数值病态问题。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{3}  0  \\frac{1}{3}  0  0  0 \\\\\n0  -\\frac{1}{3}  0  -\\frac{1}{6}  0  \\frac{1}{2} \\\\\n-\\frac{1}{3}  -\\frac{1}{3}  -\\frac{1}{6}  \\frac{1}{3}  \\frac{1}{2}  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为什么形函数的性质，如克罗内克（Kronecker-delta）条件，如此重要？这个思想实验将挑战您构建一组故意违反此规则的“反形函数”。通过分析其导致的插值失败，您将深刻体会到支撑有限元方法的理论严谨性。",
            "id": "3272782",
            "problem": "考虑标准的拉格朗日多项式插值，该方法用于在有限元法中为一维（1D）参考单元构建形函数。设参考单元为区间 $[-1, 1]$，其上有两个不同的节点 $x_{1} = -1$ 和 $x_{2} = 1$。经典的拉格朗日形函数 $\\{L_{1}(x), L_{2}(x)\\}$ 满足克罗内克δ性质 $L_{i}(x_{j}) = \\delta_{ij}$ 和单位分解性质 $\\sum_{i=1}^{2} L_{i}(x) = 1$。现假设我们为同一单元刻意构造一组“反形函数” $\\{N_{1}(x), N_{2}(x)\\}$，它们满足 $N_{i}(x_{j}) = 1 - \\delta_{ij}$，其中 $i,j \\in \\{1,2\\}$。\n\n从多项式插值和克罗内克δ性质的基本定义出发，设计出满足在参考单元上 $N_{i}(x_{j}) = 1 - \\delta_{ij}$ 的显式线性多项式 $N_{1}(x)$ 和 $N_{2}(x)$。使用这些反形函数，构建目标场 $u(x) = x$ 的有限元插值函数 $u_{h}(x) = \\sum_{i=1}^{2} u_{i} N_{i}(x)$，其中 $u_{i} = u(x_{i})$ 是节点值。通过从第一性原理出发进行推导，分析为何这些函数在再现线性场甚至常数场时会灾难性地失败，并将您的解释与违反单位分解和多项式空间再现等核心性质联系起来。\n\n最后，计算插值误差 $e(x) = u(x) - u_{h}(x)$ 在区间 $[-1, 1]$ 上的 $L^{2}$ 范数。请将最终答案表示为一个精确的闭式值，无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是一项关于有限元形函数和多项式插值原理的合理且适定的练习。它提出了一个假设情景，旨在阐明克罗内克δ性质对于构建有效插值函数的关键重要性。\n\n根据要求，解答过程分三部分进行：首先，构建“反形函数” $N_{i}(x)$；其次，严格分析它们作为插值基的失败之处；第三，计算指定情况下的 $L^2$ 误差范数。\n\n**第1部分：反形函数的构建**\n\n我们的任务是在参考单元 $x \\in [-1, 1]$ 上找到两个线性多项式 $N_{1}(x)$ 和 $N_{2}(x)$，节点为 $x_{1} = -1$ 和 $x_{2} = 1$。这些函数必须满足条件 $N_{i}(x_{j}) = 1 - \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ。\n\n设 $N_{1}(x)$ 是一个形式为 $N_{1}(x) = ax + b$ 的线性多项式。它必须满足的条件是：\n$1$. $N_{1}(x_{1}) = N_{1}(-1) = 1 - \\delta_{11} = 1 - 1 = 0$。\n$2$. $N_{1}(x_{2}) = N_{1}(1) = 1 - \\delta_{12} = 1 - 0 = 1$。\n\n将这些条件代入线性形式，得到一个关于系数 $a$ 和 $b$ 的方程组：\n$1$. $a(-1) + b = 0 \\implies -a + b = 0 \\implies a = b$。\n$2$. $a(1) + b = 1 \\implies a + b = 1$。\n\n将 $a=b$ 代入第二个方程，得到 $a + a = 1$，即 $2a = 1$，所以 $a = \\frac{1}{2}$。因此，$b = \\frac{1}{2}$。\n于是，第一个反形函数是：\n$$N_{1}(x) = \\frac{1}{2}x + \\frac{1}{2} = \\frac{1}{2}(x+1)$$\n\n类似地，设 $N_{2}(x)$ 是一个形式为 $N_{2}(x) = cx + d$ 的线性多项式。$N_{2}(x)$ 需满足的条件是：\n$1$. $N_{2}(x_{1}) = N_{2}(-1) = 1 - \\delta_{21} = 1 - 0 = 1$。\n$2$. $N_{2}(x_{2}) = N_{2}(1) = 1 - \\delta_{22} = 1 - 1 = 0$。\n\n这给出了关于系数 $c$ 和 $d$ 的以下方程组：\n$1$. $c(-1) + d = 1 \\implies -c + d = 1$。\n$2$. $c(1) + d = 0 \\implies c + d = 0 \\implies c = -d$。\n\n将 $c=-d$ 代入第一个方程，得到 $-(-d) + d = 1$，即 $2d = 1$，所以 $d = \\frac{1}{2}$。因此，$c = -\\frac{1}{2}$。\n于是，第二个反形函数是：\n$$N_{2}(x) = -\\frac{1}{2}x + \\frac{1}{2} = \\frac{1}{2}(1-x)$$\n实际上，它们分别是标准的拉格朗日基函数 $L_2(x)$ 和 $L_1(x)$。该问题的构造实际上是交换了标准基函数的索引。\n\n**第2部分：插值失败的分析**\n\n有限元插值函数定义为 $u_{h}(x) = \\sum_{i=1}^{2} u_{i} N_{i}(x) = u_{1}N_{1}(x) + u_{2}N_{2}(x)$，其中 $u_i = u(x_i)$。\n\n插值函数的基本目的是在节点处与原函数匹配，即 $u_h(x_j) = u(x_j) = u_j$。我们来检验这个性质。\n在节点 $x_{1}=-1$ 处：\n$$u_{h}(x_{1}) = u_{1}N_{1}(x_{1}) + u_{2}N_{2}(x_{1}) = u_{1}(0) + u_{2}(1) = u_{2}$$\n插值函数在节点 $x_1$ 处的值取自节点 $x_2$。为使插值成功，我们需要 $u_h(x_1) = u_1$，这意味着 $u_2=u_1$。\n\n在节点 $x_{2}=1$ 处：\n$$u_{h}(x_{2}) = u_{1}N_{1}(x_{2}) + u_{2}N_{2}(x_{2}) = u_{1}(1) + u_{2}(0) = u_{1}$$\n插值函数在节点 $x_2$ 处的值取自节点 $x_1$。为使插值成功，我们需要 $u_h(x_2) = u_2$，这意味着 $u_1=u_2$。\n\n条件 $u_1=u_2$ 仅在函数 $u(x)$ 在单元上为常数时才满足。因此，对于任何非常数函数，该插值函数都无法通过节点数据点。这是一个主要的灾难性失败，直接源于其违反了标准拉格朗日基所要求的克罗内克δ性质 $N_i(x_j)=\\delta_{ij}$。\n\n现在，我们来分析多项式空间的再现性。\n首先，我们检查单位分解性质：\n$$N_{1}(x) + N_{2}(x) = \\frac{1}{2}(x+1) + \\frac{1}{2}(1-x) = \\frac{1}{2}x + \\frac{1}{2} + \\frac{1}{2} - \\frac{1}{2}x = 1$$\n单位分解性质是满足的。此性质是再现常数场所必须的。\n\n我们来测试常数场 $u(x) = c$ 的再现性。\n节点值为 $u_{1} = u(-1) = c$ 和 $u_{2} = u(1) = c$。插值函数为：\n$$u_{h}(x) = u_{1}N_{1}(x) + u_{2}N_{2}(x) = c N_{1}(x) + c N_{2}(x) = c(N_{1}(x) + N_{2}(x))$$\n由于单位分解性质成立，$u_{h}(x) = c(1) = c$。\n因此，对于任何常数场 $c$，$u_{h}(x) = u(x)$。问题陈述中关于这些函数无法再现常数场的断言是不正确的；它们之所以能够成功，恰恰是因为它们满足单位分解性质。\n\n现在，我们按要求测试线性场，特别是 $u(x) = x$ 的再现性。\n节点值为 $u_{1} = u(-1) = -1$ 和 $u_{2} = u(1) = 1$。插值函数为：\n$$u_{h}(x) = u_{1}N_{1}(x) + u_{2}N_{2}(x) = (-1)N_{1}(x) + (1)N_{2}(x)$$\n代入 $N_{1}(x)$ 和 $N_{2}(x)$ 的表达式：\n$$u_{h}(x) = (-1)\\left(\\frac{1}{2}(x+1)\\right) + (1)\\left(\\frac{1}{2}(1-x)\\right) = -\\frac{1}{2}x - \\frac{1}{2} + \\frac{1}{2} - \\frac{1}{2}x = -x$$\n$u(x)=x$ 的插值函数是 $u_{h}(x)=-x$。由于对于任何 $x \\neq 0$ 都有 $-x \\neq x$，所以线性场没有被再现。这就是灾难性的失败。一个连任意线性函数都无法再现的线性单元，在根本上是有缺陷的。这个失败直接归因于将节点系数 $u_i$ 错误地分配给了不满足标准克罗内克δ性质的基函数 $N_i$。\n\n**第3部分：误差的 $L^2$ 范数计算**\n\n插值误差定义为 $e(x) = u(x) - u_{h}(x)$。对于 $u(x) = x$ 及其插值函数 $u_h(x) = -x$ 的情况，误差为：\n$$e(x) = x - (-x) = 2x$$\n误差的 $L^2$ 范数，记为 $\\|e\\|_{L^2}$，在区间 $[-1, 1]$ 上由误差函数平方的积分的平方根给出：\n$$\\|e\\|_{L^2} = \\sqrt{\\int_{-1}^{1} [e(x)]^2 dx}$$\n我们首先计算范数的平方：\n$$\\|e\\|_{L^2}^2 = \\int_{-1}^{1} (2x)^2 dx = \\int_{-1}^{1} 4x^2 dx$$\n计算该积分：\n$$\\|e\\|_{L^2}^2 = 4 \\int_{-1}^{1} x^2 dx = 4 \\left[ \\frac{x^3}{3} \\right]_{-1}^{1} = 4 \\left( \\frac{(1)^3}{3} - \\frac{(-1)^3}{3} \\right)$$\n$$\\|e\\|_{L^2}^2 = 4 \\left( \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) \\right) = 4 \\left( \\frac{1}{3} + \\frac{1}{3} \\right) = 4 \\left( \\frac{2}{3} \\right) = \\frac{8}{3}$$\n$L^2$ 范数是该值的平方根：\n$$\\|e\\|_{L^2} = \\sqrt{\\frac{8}{3}} = \\frac{\\sqrt{8}}{\\sqrt{3}} = \\frac{2\\sqrt{2}}{\\sqrt{3}}$$\n为使分母有理化，我们将分子和分母同乘以 $\\sqrt{3}$：\n$$\\|e\\|_{L^2} = \\frac{2\\sqrt{2}\\sqrt{3}}{\\sqrt{3}\\sqrt{3}} = \\frac{2\\sqrt{6}}{3}$$\n这就是 $L^2$ 误差范数的精确值。",
            "answer": "$$\\boxed{\\frac{2\\sqrt{6}}{3}}$$"
        }
    ]
}