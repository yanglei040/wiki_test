{
    "hands_on_practices": [
        {
            "introduction": "单纯形法的核心在于从可行域的一个顶点迭代移动到相邻的另一个顶点，并确保目标函数值在每一步都得到改善。这个迭代步骤是通过一种名为“主元变换”（pivot operation）的代数操作来完成的。本练习将带你完整地执行一次主元变换，这是掌握单纯形算法最基本的机械步骤 。",
            "id": "2221017",
            "problem": "一家市场分析公司正在使用线性规划来确定客户广告预算的最优分配方案。目标是最大化客户覆盖率。决策变量是 $x_1$（在社交媒体上购买的广告单元数量）和 $x_2$（在搜索引擎上购买的广告单元数量）。该问题已被构建为一个标准的最大化问题，其初始单纯形表如下所示。变量 $s_1$ 和 $s_2$ 是松弛变量，分别代表未使用的预算和员工工时。变量 $Z$ 代表需要最大化的总客户覆盖率。\n\n表的各行对应于目标函数 $Z$ 以及以 $s_1$ 和 $s_2$ 为基变量的两个约束条件。各列对应于变量 $Z, x_1, x_2, s_1, s_2$ 和右端项（RHS）值。\n\n初始单纯形表为：\n$$\n\\begin{array}{c|cccccc}\n\\text{基变量} & Z & x_1 & x_2 & s_1 & s_2 & \\text{RHS} \\\\\n\\hline\nZ & 1 & -5 & -4 & 0 & 0 & 0 \\\\\ns_1 & 0 & 10 & 8 & 1 & 0 & 80 \\\\\ns_2 & 0 & 2 & 3 & 0 & 1 & 24 \\\\\n\\end{array}\n$$\n\n根据标准最大化问题的单纯形算法，执行一次完整的主元操作。确定更新后的 Z 行中 $x_2$ 的系数、Z 行中 $s_1$ 的系数，以及目标函数 $Z$ 的新值（Z 行的右端项值）。\n\n你的答案应该是一组按指定顺序排列在行矩阵中的三个数值：（$x_2$ 的系数，$s_1$ 的系数，$Z$ 的值）。",
            "solution": "我们应用标准最大化问题的单纯形主元法则。\n\n1) 确定进基变量：在 Z 行中，决策变量中最小的负系数是 $x_{1}$ 的 $-5$，因此 $x_{1}$ 进基。\n\n2) 对 $x_{1}$ 列进行最小比率测试以选择出基变量：\n$$\n\\frac{80}{10}=8 \\quad \\text{对于 } s_{1}, \\qquad \\frac{24}{2}=12 \\quad \\text{对于 } s_{2}.\n$$\n最小比率为 $8$，因此 $s_{1}$ 出基。主元是 $s_{1}$ 行和 $x_{1}$ 列中的元素 $10$。\n\n3) 进行主元操作，使主元变为 1，并从其他行中消去 $x_{1}$。\n\n将主元行（$s_{1}$ 行）除以 $10$ 进行归一化：\n$$\ns_{1}\\text{行}: \\quad [0,\\;10,\\;8,\\;1,\\;0\\;|\\;80] \\;\\to\\; [0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8].\n$$\n\n将新的 $s_{1}$ 行乘以 $5$ 加到 Z 行，以从 Z 行中消去 $x_{1}$：\n$$\nZ\\text{行}: \\quad [1,\\;-5,\\;-4,\\;0,\\;0\\;|\\;0] + 5\\cdot[0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8]\n= [1,\\;0,\\;0,\\;\\tfrac{1}{2},\\;0\\;|\\;40].\n$$\n\n（从 $s_{2}$ 行中消去 $x_{1}$ 是完整主元操作的一部分，但对于求解所要求的 Z 行系数而言并非必需。）\n\n因此，在这次主元操作后，Z 行中 $x_{2}$ 的系数是 $0$，Z 行中 $s_{1}$ 的系数是 $\\tfrac{1}{2}$，新的目标函数值 $Z$（Z 行的右端项）是 $40$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0 & \\frac{1}{2} & 40\\end{pmatrix}}$$"
        },
        {
            "introduction": "标准的单纯形算法需要一个初始基本可行解作为起点，但这并非总是显而易见的，尤其是在处理包含“大于等于”约束的问题时。为了解决这个问题，我们引入了两阶段法。本练习将重点展示第一阶段（Phase I）的过程，即通过求解一个辅助问题来找到初始可行解，或者证明原问题无解 。",
            "id": "2443911",
            "problem": "一家贸易公司的食堂经理正在设计一份低钠、高蛋白的膳食计划，使用两种食物，记作 $x_{1}$ 和 $x_{2}$，其中 $x_{1}$ 和 $x_{2}$ 是每种食物的份数，且必须满足 $x_{1} \\geq 0$ 和 $x_{2} \\geq 0$。每份食物 $x_{1}$ 提供 $5$ 克蛋白质和 $4$ 克钠，而每份食物 $x_{2}$ 提供 $2$ 克蛋白质和 $3$ 克钠。膳食要求如下：\n- 总蛋白质摄入量至少为 $20$ 克，以及\n- 总钠摄入量最多为 $5$ 克。\n\n将此可行性问题建模为两阶段单纯形法框架下的一个线性规划问题。在第一阶段，仅对带有 $\\geq$ 运算符的约束引入人工变量，并将人工变量之和的最小值作为第一阶段的目标。该问题的第一阶段目标的最优值是多少？答案以克为单位表示。无需四舍五入，最终答案必须是一个数字。",
            "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n- 决策变量：$x_{1}, x_{2}$，代表两种食物的份数。\n- 非负性：$x_{1} \\geq 0$, $x_{2} \\geq 0$。\n- 食物 $1$（每份）：$5$ 克蛋白质，$4$ 克钠。\n- 食物 $2$（每份）：$2$ 克蛋白质，$3$ 克钠。\n- 约束 $1$：总蛋白质摄入量必须至少为 $20$ 克。\n- 约束 $2$：总钠摄入量最多为 $5$ 克。\n- 任务：建立并求解第一阶段线性规划，以找到第一阶段目标的最优值。\n- 第一阶段设置：为“$\\geq$”约束引入一个人工变量，并将其值最小化。\n\n**步骤2：使用提取的已知条件进行验证**\n这是一个线性规划的标准应用，特别是两阶段单纯形法，用于确定一个线性不等式系统的可行性。该问题具有科学依据，提法明确且客观。尽管约束条件最终被发现是矛盾的（即可行域为空），但它们的呈现方式使得关于第一阶段结果的问题变得有意义。第一阶段的目的正是为了检测这种不可行性。要求以克为单位表示答案，这在量纲上是一致的，因为人工变量继承了其所添加到的约束的单位。\n\n**结论：问题有效。**\n\n我们继续求解。\n\n首先，我们将问题形式化为一个线性规划。决策变量是 $x_{1}$ 和 $x_{2}$。约束条件源自营养需求。\n\n蛋白质约束是：\n$$5x_{1} + 2x_{2} \\geq 20$$\n钠约束是：\n$$4x_{1} + 3x_{2} \\leq 5$$\n非负约束是：\n$$x_{1} \\geq 0, \\quad x_{2} \\geq 0$$\n\n为了应用单纯形法，我们必须通过引入松弛变量和剩余变量将这些不等式转换为标准形式（等式）。\n从“$\\geq$”约束中减去一个剩余变量 $s_{1} \\geq 0$：\n$$5x_{1} + 2x_{2} - s_{1} = 20$$\n向“$\\leq$”约束中添加一个松弛变量 $s_{2} \\geq 0$：\n$$4x_{1} + 3x_{2} + s_{2} = 5$$\n\n得到的方程组是：\n$$5x_{1} + 2x_{2} - s_{1} = 20$$\n$$4x_{1} + 3x_{2} + s_{2} = 5$$\n$$x_{1}, x_{2}, s_{1}, s_{2} \\geq 0$$\n\n初始基本可行解不是立即可得的。对于第一个方程，如果我们设置非基变量 $x_{1}=0$ 和 $x_{2}=0$，我们得到 $-s_{1}=20$，即 $s_{1}=-20$，这违反了 $s_1$ 的非负性。因此，遵循处理“$\\geq$”约束的标准程序，我们在第一个方程中引入一个人工变量 $a_{1} \\geq 0$。第二个方程中的松弛变量 $s_{2}$ 可以作为基变量。\n\n第一阶段问题的方程组是：\n$$5x_{1} + 2x_{2} - s_{1} + a_{1} = 20$$\n$$4x_{1} + 3x_{2} + s_{2} = 5$$\n$$x_{1}, x_{2}, s_{1}, s_{2}, a_{1} \\geq 0$$\n\n第一阶段的目标是最小化人工变量之和。在这里，我们只有一个，所以我们最小化 $w = a_{1}$。如果 $w$ 的最小值大于零，那么原始问题是不可行的。\n\n我们用非基变量来表示目标函数 $w$。根据第一个约束：\n$$a_{1} = 20 - 5x_{1} - 2x_{2} + s_{1}$$\n因此，目标是最小化 $w = 20 - 5x_{1} - 2x_{2} + s_{1}$。这等同于在单纯形表中建立目标行。初始基变量是 $a_{1}$ 和 $s_{2}$。非基变量是 $x_{1}$、$x_{2}$ 和 $s_{1}$。\n\n第一阶段最小化问题的初始单纯形表构造如下。目标行 ($z_{j}-c_{j}$) 包含了用非基变量表示的目标函数 $w$ 的系数。目标是 $w + 5x_1 + 2x_2 - s_1 = 20$。\n当前基本解：$x_1=0, x_2=0, s_1=0$，给出 $a_1=20, s_2=5$。初始目标值为 $w=20$。\n\n**初始单纯形表：**\n$$\n\\begin{array}{c|c|ccccc|c}\n\\text{基} & w & x_{1} & x_{2} & s_{1} & a_{1} & s_{2} & \\text{RHS} \\\\\n\\hline\na_{1} & 0 & 5 & 2 & -1 & 1 & 0 & 20 \\\\\ns_{2} & 0 & 4 & 3 & 0 & 0 & 1 & 5 \\\\\n\\hline\n\\text{目标行} & 1 & 5 & 2 & -1 & 0 & 0 & 20\n\\end{array}\n$$\n对于一个最小化问题，我们选择目标行（$z_j - c_j$）中具有最大正系数的变量进入基。这个变量是 $x_{1}$，其系数为 $5$。\n\n为了确定离基变量，我们进行最小比率测试：\n对于 $a_{1}$ 行： $\\frac{20}{5} = 4$。\n对于 $s_{2}$ 行： $\\frac{5}{4} = 1.25$。\n\n最小比率为 $1.25$，对应于 $s_{2}$ 行。因此，$s_{2}$ 离开基，$x_{1}$ 进入基。主元是 $4$。我们执行一次主元运算。\n\n首先，将主元行（$s_2$ 行）除以主元（$4$）：\n$$R_{2, \\text{new}} = R_{2} / 4 \\implies [1, \\frac{3}{4}, 0, 0, \\frac{1}{4} | \\frac{5}{4}]$$\n这是基变量 $x_{1}$ 的新行。\n\n接下来，我们更新其他行，使主元列中的元素为零。\n更新 $a_{1}$ 行： $R_{1, \\text{new}} = R_{1} - 5 \\times R_{2, \\text{new}}$\n$$R_{1, \\text{new}} = [5, 2, -1, 1, 0 | 20] - 5 \\times [1, \\frac{3}{4}, 0, 0, \\frac{1}{4} | \\frac{5}{4}]$$\n$$R_{1, \\text{new}} = [0, 2 - \\frac{15}{4}, -1, 1, -\\frac{5}{4} | 20 - \\frac{25}{4}] = [0, -\\frac{7}{4}, -1, 1, -\\frac{5}{4} | \\frac{55}{4}]$$\n\n更新目标行： $R_{\\text{obj, new}} = R_{\\text{obj}} - 5 \\times R_{2, \\text{new}}$\n$$R_{\\text{obj, new}} = [5, 2, -1, 0, 0 | 20] - 5 \\times [1, \\frac{3}{4}, 0, 0, \\frac{1}{4} | \\frac{5}{4}]$$\n$$R_{\\text{obj, new}} = [0, 2 - \\frac{15}{4}, -1, 0, -\\frac{5}{4} | 20 - \\frac{25}{4}] = [0, -\\frac{7}{4}, -1, 0, -\\frac{5}{4} | \\frac{55}{4}]$$\n\n**一次迭代后的单纯形表：**\n$$\n\\begin{array}{c|c|ccccc|c}\n\\text{基} & w & x_{1} & x_{2} & s_{1} & a_{1} & s_{2} & \\text{RHS} \\\\\n\\hline\na_{1} & 0 & 0 & -\\frac{7}{4} & -1 & 1 & -\\frac{5}{4} & \\frac{55}{4} \\\\\nx_{1} & 0 & 1 & \\frac{3}{4} & 0 & 0 & \\frac{1}{4} & \\frac{5}{4} \\\\\n\\hline\n\\text{目标行} & 1 & 0 & -\\frac{7}{4} & -1 & 0 & -\\frac{5}{4} & \\frac{55}{4}\n\\end{array}\n$$\n当前基本解是 $a_{1} = \\frac{55}{4}$，$x_{1} = \\frac{5}{4}$。目标值为 $w = \\frac{55}{4}$。\n我们检查目标行系数 ($z_{j}-c_{j}$)：$[0, -\\frac{7}{4}, -1, 0, -\\frac{5}{4}]$。所有系数都小于或等于零。这满足了最小化问题的最优性条件。\n因此，单纯形算法终止。\n\n第一阶段目标函数的最优（最小）值为 $w^* = a_{1} = \\frac{55}{4}$。\n因为 $w^* > 0$，我们得出结论，原始问题没有可行解。然而，问题要求的是第一阶段目标的最优值，我们已经找到了这个值。\n\n该值为 $\\frac{55}{4} = 13.75$。人工变量 $a_{1}$被添加到蛋白质约束中，该约束以克为单位。因此，$a_1$ 的值单位是克。$a_1$ 的最小值表示在给定其他约束条件下，满足蛋白质需求时不可避免的最小缺口。在钠限制下可实现的最大蛋白质为 $5(\\frac{5}{4}) + 2(0) = \\frac{25}{4}$ 克，比要求的 $20$ 克少了 $\\frac{55}{4}$ 克。这证实了结果。",
            "answer": "$$\\boxed{\\frac{55}{4}}$$"
        },
        {
            "introduction": "当一个线性规划问题在找到最优解后，其约束条件发生变化（例如增加了一个新的约束），原最优解可能会变得不再可行。此时，与其从头重新求解，不如使用对偶单纯形法来更高效地恢复可行性并找到新的最优解。本练习将演示对偶单纯形法的一个关键步骤，让你体会其在处理最优解扰动时的威力 。",
            "id": "2212987",
            "problem": "考虑以下用于标准最大化问题的单纯形表，其中 $z$ 是目标函数，变量 $x_3, x_4, x_5$ 是当前的基变量。\n\n$$\n\\begin{array}{c|cccccc|c}\n\\text{基} & z & x_1 & x_2 & x_3 & x_4 & x_5 & \\text{右端项} \\\\\n\\hline\nz & 1 & 3 & 2 & 0 & 0 & 0 & 50 \\\\\n\\hline\nx_3 & 0 & 1 & 3 & 1 & 0 & 0 & 10 \\\\\nx_4 & 0 & -1 & 2 & 0 & 1 & 0 & -4 \\\\\nx_5 & 0 & -2 & -1 & 0 & 0 & 1 & -5 \\\\\n\\end{array}\n$$\n\n使用对偶单纯形法执行恰好一次枢轴运算。在这次单次迭代之后，确定新的基变量集合。报告这些新基变量的值以及目标函数 $z$ 的值。将基变量的值按其变量下标的升序排列。你的答案应该是一个包含这些值以及 $z$ 值的单行矩阵。例如，如果新的基变量是 $x_a, x_b, x_c$ 且 $a<b<c$，则答案格式为 $\\begin{pmatrix} x_a & x_b & x_c & z \\end{pmatrix}$。",
            "solution": "我们应用对偶单纯形法，因为当前基 $\\{x_{3},x_{4},x_{5}\\}$ 导致 $x_{4}$ 和 $x_{5}$ 的右端项为负，这表明原始问题不可行，而 $z$ 行中非基变量 $x_{1},x_{2}$ 的判别数是非负的，这在 $z_{j}-c_{j}$ 约定下表明对偶问题可行。\n\n步骤1：选择右端项值最负的基变量作为出基变量。从表中可以看出，基行的右端项值分别为 $10$（对于 $x_{3}$），$-4$（对于 $x_{4}$），和 $-5$（对于 $x_{5}$）。最负的值是 $-5$，所以 $x_{5}$ 出基。\n\n步骤2：使用对偶单纯形法比例检验选择进基变量。对于枢轴行（$x_{5}$ 所在的行），考虑满足 $a_{ij}  0$ 的列 $j$。在 $x_{5}$ 行中，$a_{5,1}=-2$ 和 $a_{5,2}=-1$，所以候选变量是 $x_{1}$ 和 $x_{2}$。将 $z$ 行的条目解释为 $z_{j}-c_{j}$，我们计算比率的最小值：\n$$\n\\min\\left\\{\\frac{z_{1}-c_{1}}{-a_{5,1}}, \\frac{z_{2}-c_{2}}{-a_{5,2}}\\right\\} = \\min\\left\\{\\frac{3}{-(-2)}, \\frac{2}{-(-1)}\\right\\} = \\min\\left\\{\\frac{3}{2}, 2\\right\\} = \\frac{3}{2}.\n$$\n最小值为 $\\frac{3}{2}$，对应于 $x_1$ 列，所以 $x_{1}$ 进基。枢轴元素是位于 $x_{5}$ 行和 $x_{1}$ 列交点处的 $-2$。\n\n步骤3：执行枢轴运算。首先将枢轴行乘以 $-\\frac{1}{2}$，使枢轴元素变为 $1$：\n$$\nR_{5}'=\\left[\\,0,\\;1,\\;\\frac{1}{2},\\;0,\\;0,\\;-\\frac{1}{2}\\;\\middle|\\;\\frac{5}{2}\\right].\n$$\n从其他行中消去 $x_{1}$：\n\n- 新的 $z$ 行：$R_{z}'=R_{z}-3R_{5}'$ 得到\n$$\n[\\,1,\\;0,\\;\\tfrac{1}{2},\\;0,\\;0,\\;\\tfrac{3}{2}\\;|\\;\\tfrac{85}{2}\\,].\n$$\n\n- 新的 $x_{3}$ 行：$R_{3}'=R_{3}-R_{5}'$ 得到\n$$\n[\\,0,\\;0,\\;\\tfrac{5}{2},\\;1,\\;0,\\;\\tfrac{1}{2}\\;|\\;\\tfrac{15}{2}\\,].\n$$\n\n- 新的 $x_{4}$ 行：$R_{4}'=R_{4}+R_{5}'$ 得到\n$$\n[\\,0,\\;0,\\;\\tfrac{5}{2},\\;0,\\;1,\\;-\\tfrac{1}{2}\\;|\\;-\\tfrac{3}{2}\\,].\n$$\n\n经过这次单次对偶单纯形迭代后，基变量为 $\\{x_{1},x_{3},x_{4}\\}$，非基变量为 $\\{x_{2},x_{5}\\}$。将非基变量设为 $0$，从各自行的右端项读取基变量的值：\n$$\nx_{1}=\\frac{5}{2},\\quad x_{3}=\\frac{15}{2},\\quad x_{4}=-\\frac{3}{2}.\n$$\n目标函数值是 $z$ 行的右端项：\n$$\nz=\\frac{85}{2}.\n$$\n将基变量 $(x_{1},x_{3},x_{4})$ 按下标升序排列，所求的行是 $\\left[\\frac{5}{2},\\,\\frac{15}{2},\\, -\\frac{3}{2},\\, \\frac{85}{2}\\right]$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2}  \\frac{15}{2}  -\\frac{3}{2}  \\frac{85}{2}\\end{pmatrix}}$$"
        }
    ]
}