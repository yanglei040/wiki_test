{
    "hands_on_practices": [
        {
            "introduction": "理论是基础，但实践才能带来真正的理解。让我们从一个与我们日常科技生活息息相关的实际问题开始——CPU的散热。这个练习将指导你使用隐式欧拉法，通过一个简单的线性模型来预测CPU温度的下一步变化。通过求解一个关于未来时刻温度的方程，你将亲身体验到该方法“隐式”特性的核心操作。",
            "id": "2178316",
            "problem": "一个中央处理器（CPU）在可变负载下的简化热模型由以下一阶常微分方程描述：\n$$ \\frac{dT}{dt} = -k(T - T_a) + P(t) $$\n其中，$T(t)$ 是CPU在时间 $t$（分钟）时的温度，单位为摄氏度（$^\\circ\\text{C}$），$k$ 是散热常数，$T_a$ 是恒定的环境温度，$P(t)$ 代表CPU活动产生的热量。\n\n假设参数如下：\n- 散热常数，$k = 0.5 \\text{ min}^{-1}$\n- 环境温度，$T_a = 25^\\circ\\text{C}$\n- 发热函数，$P(t) = P_0 \\cos(\\omega t)$，其中 $P_0 = 10^\\circ\\text{C}/\\text{min}$ 且 $\\omega = \\frac{\\pi}{6} \\text{ rad/min}$。\n- CPU的初始温度为 $T(0) = 85^\\circ\\text{C}$。\n\n为了预测温度的演变，我们采用一种数值方法。下一个时间步 $t_{n+1}$ 的温度 $T_{n+1}$，是根据当前时间步 $t_n$ 的温度 $T_n$ 使用以下更新规则估算得出的：\n$$ T_{n+1} = T_n + h \\left( \\frac{dT}{dt} \\right)_{t=t_{n+1}, T=T_{n+1}} $$\n其中 $h = t_{n+1} - t_n$ 是时间步长。\n\n使用该数值方法进行单步计算，步长为 $h = 0.5$ 分钟，计算在 $t = 0.5$ 分钟时CPU的大致温度。\n\n将您的答案以摄氏度表示，并四舍五入到四位有效数字。",
            "solution": "我们给定了一阶常微分方程\n$$\n\\frac{dT}{dt}=-k\\left(T-T_{a}\\right)+P(t), \\quad P(t)=P_{0}\\cos(\\omega t),\n$$\n并且我们要应用步长为 $h$ 的隐式（后向）欧拉法，从 $t_{0}=0$ 到 $t_{1}=h$ 进行一步计算。后向欧拉法的更新公式为\n$$\nT_{1}=T_{0}+h\\left.\\frac{dT}{dt}\\right|_{t=t_{1},\\,T=T_{1}}=T_{0}+h\\big(-k(T_{1}-T_{a})+P_{0}\\cos(\\omega t_{1})\\big).\n$$\n求解该方程以得到 $T_{1}$。展开右侧并合并 $T_{1}$ 项：\n$$\nT_{1}=T_{0}-hkT_{1}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n将 $T_{1}$ 项移到左侧：\n$$\nT_{1}+hkT_{1}=T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n对左侧进行因式分解并求解 $T_{1}$：\n$$\nT_{1}=\\frac{T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1})}{1+hk}.\n$$\n现在代入给定的数据 $T_{0}=85$, $k=0.5$, $T_{a}=25$, $P_{0}=10$, $\\omega=\\frac{\\pi}{6}$, $h=0.5$, 以及 $t_{1}=0.5$：\n$$\n1+hk=1+0.5\\times 0.5=1.25,\n$$\n$$\nhkT_{a}=0.5\\times 0.5\\times 25=6.25,\n$$\n$$\nhP_{0}\\cos(\\omega t_{1})=0.5\\times 10\\times \\cos\\!\\left(\\frac{\\pi}{6}\\times 0.5\\right)=5\\cos\\!\\left(\\frac{\\pi}{12}\\right).\n$$\n因此\n$$\nT_{1}=\\frac{85+6.25+5\\cos\\!\\left(\\frac{\\pi}{12}\\right)}{1.25}.\n$$\n使用 $\\cos\\!\\left(\\frac{\\pi}{12}\\right)\\approx 0.9659258263$，我们得到\n$$\nT_{1}\\approx \\frac{85+6.25+4.829629131}{1.25}=\\frac{96.079629131}{1.25}\\approx 76.86370331.\n$$\n四舍五入到四位有效数字，在 $t=0.5$ 分钟时的大致温度为 $76.86$ 摄氏度。",
            "answer": "$$\\boxed{76.86}$$"
        },
        {
            "introduction": "在解决了第一个具体问题后，我们来提升一下难度，从特例走向一般。这个练习要求你为一阶线性常微分方程推导通用的隐式欧拉法更新公式。这个推导过程不仅是重要的代数练习，它揭示了一个深刻的性质：对于线性问题，隐式步骤可以被解析地求解，从而得到一个显式的递推关系，这对于后续的理论分析和高效编程实现至关重要。",
            "id": "2178341",
            "problem": "考虑以下一阶线性常微分方程 (ODE)：\n$$\n\\frac{dy}{dt} = ay(t) + b\n$$\n其中 $a$ 和 $b$ 是非零实常数。我们希望使用具有恒定步长 $h > 0$ 的隐式欧拉法对此常微分方程的解进行数值近似。隐式欧拉法将时间导数离散化，并在下一个时间步计算常微分方程的右侧。设 $y_n$ 为解 $y(t_n)$ 在时间 $t_n = n h$ 处的数值近似值。\n\n你的任务是推导此方法的显式更新规则。将下一个近似值 $y_{n+1}$ 仅用当前近似值 $y_n$ 和常数 $a$、$b$、$h$ 来表示。",
            "solution": "我们将隐式欧拉法应用于常微分方程 $\\frac{dy}{dt} = a y + b$。对于恒定步长 $h$ 和网格点 $t_{n} = n h$，隐式欧拉离散化通过后向差分来近似导数，并在下一步计算右侧：\n$$\n\\frac{y_{n+1} - y_{n}}{h} = a y_{n+1} + b.\n$$\n两边同乘以 $h$ 得到\n$\ny_{n+1} - y_{n} = h \\left(a y_{n+1} + b\\right).\n$\n将包含 $y_{n+1}$ 的项收集到左边，得到\n$\ny_{n+1} - h a y_{n+1} = y_{n} + h b,\n$\n因式分解后得到\n$\n\\left(1 - a h\\right) y_{n+1} = y_{n} + h b.\n$\n假设 $1 - a h \\neq 0$，解出 $y_{n+1}$：\n$$\ny_{n+1} = \\frac{y_{n} + h b}{1 - a h}.\n$$\n这就将 $y_{n+1}$ 仅用 $y_{n}$ 和常数 $a$、$b$、$h$ 表示出来了。",
            "answer": "$$\\boxed{\\frac{y_{n}+h b}{1-a h}}$$"
        },
        {
            "introduction": "线性问题的世界是理想的，但现实充满了非线性。当我们用隐式欧拉法求解非线性常微分方程时，会遇到新的挑战。本练习探讨了一个著名非线性方程 $y' = 1 + y^2$，你会发现，在每一步求解 $y_{n+1}$ 时都需要解一个二次方程。这个过程将引导你发现一个“临界步长” $h_{crit}$，超过它，数值解甚至会“消失”在实数域中，这深刻揭示了在应用隐式方法时必须考虑的代数求解可行性问题。",
            "id": "2178313",
            "problem": "一位分析师正在研究求解一阶常微分方程（ODE）近似解的数值稳定性。正在研究的具体初值问题由微分方程 $y' = 1 + y^2$ 和初始条件 $y(0) = 0$ 给出。\n\n为了求解近似解，采用了隐式欧拉法。对于一个均匀的步长 $h$，该方法会生成一个数值序列 $y_0, y_1, y_2, \\ldots$，其中 $y_n$ 是在时间 $t_n = nh$ 处解的近似值。其迭代格式定义为：\n$$y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$$\n其中 $f(t, y)$ 是常微分方程的右端项，即 $y' = f(t,y)$。\n\n对于给定的常微分方程，应用隐式欧拉法会在每一步都产生一个关于 $y_{n+1}$ 的代数方程，必须求解该方程才能得到 $y_{n+1}$。结果表明，对于任意给定的状态 $y_n$，存在一个正的临界步长 $h_{crit}$，使得对于任何大于 $h_{crit}$ 的步长 $h$，关于 $y_{n+1}$ 的代数方程没有实数解，从而导致该方法失效。\n\n你的任务是确定这个临界步长 $h_{crit}$ 作为当前状态 $y_n$ 的函数的表达式。假设步长 $h$ 必须为正实数。",
            "solution": "我们将隐式欧拉法应用于步长为 $h>0$ 的常微分方程 $y' = 1 + y^{2}$。其迭代格式为\n$$\ny_{n+1} = y_{n} + h\\left(1 + y_{n+1}^{2}\\right).\n$$\n整理关于 $y_{n+1}$ 的项，得到\n$$\ny_{n+1} - h y_{n+1}^{2} - y_{n} - h = 0,\n$$\n这等价于关于 $y_{n+1}$ 的二次方程，\n$$\nh y_{n+1}^{2} - y_{n+1} + \\left(y_{n} + h\\right) = 0.\n$$\n一个二次方程 $a z^{2} + b z + c = 0$ 有实数解的充要条件是其判别式 $\\Delta = b^{2} - 4ac$ 满足 $\\Delta \\ge 0$。在这里，$a = h$, $b = -1$, $c = y_{n} + h$，所以\n$$\n\\Delta(h) = 1 - 4 h (y_{n} + h) = 1 - 4 h y_{n} - 4 h^{2}.\n$$\n对于固定的 $y_{n}$，存在实数解当且仅当 $\\Delta(h) \\ge 0$。临界步长 $h_{crit}$ 是使 $\\Delta(h) = 0$ 的正数 $h$：\n$$\n1 - 4 h y_{n} - 4 h^{2} = 0 \\;\\;\\Longleftrightarrow\\;\\; 4 h^{2} + 4 y_{n} h - 1 = 0.\n$$\n解这个关于 $h$ 的二次方程，\n$$\nh = \\frac{-4 y_{n} \\pm \\sqrt{16 y_{n}^{2} + 16}}{8} = \\frac{-y_{n} \\pm \\sqrt{y_{n}^{2} + 1}}{2}.\n$$\n在这些解中，正根是\n$$\nh_{crit}(y_{n}) = \\frac{-y_{n} + \\sqrt{1 + y_{n}^{2}}}{2},\n$$\n而另一个根是负数，因此不符合正步长的要求。当 $h > h_{crit}(y_{n})$ 时，判别式为负，不存在实数解 $y_{n+1}$，这导致该方法失效。一个等价的形式是 $h_{crit}(y_{n}) = \\frac{1}{2\\left(\\sqrt{1 + y_{n}^{2}} + y_{n}\\right)}$。",
            "answer": "$$\\boxed{\\frac{\\sqrt{1+y_{n}^{2}}-y_{n}}{2}}$$"
        }
    ]
}