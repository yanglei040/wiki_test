{
    "hands_on_practices": [
        {
            "introduction": "在许多科学计算中，我们面临一个核心问题：当模型输入存在微小的不确定性时，其输出结果会受到多大影响？本练习将通过一个经典的热辐射问题，指导你使用泰勒级数展开这一基础而强大的分析工具来回答这个问题。你将亲手推导在一个非线性物理定律下，输入温度的微小扰动是如何传播并影响输出热流率的均值和方差的 ()。",
            "id": "2536849",
            "problem": "一个发射率为 $\\epsilon$、面积为 $A$、绝对温度为 $T$ 的漫灰等温表面片向深空辐射。其净辐射热率遵循斯蒂芬-玻尔兹曼定律 $q=\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\, T^{4}$，其中 $\\sigma_{\\mathrm{SB}}$ 是斯蒂芬-玻尔兹曼常数。假设 $\\epsilon$、$A$ 和 $\\sigma_{\\mathrm{SB}}$ 是已知的确定性参数，但温度 $T$ 由于微小的传感器噪声和过程可变性而具有不确定性。将 $T$ 建模为一个均值为 $\\mu_{T}>0$、方差为 $\\sigma_{T}^{2}$ 的高斯随机变量，并假设其变异系数 $c=\\sigma_{T}/\\mu_{T}$ 很小，即 $c \\ll 1$。\n\n从斯蒂芬-玻尔兹曼定律以及期望和方差的定义出发，仅使用由 $c$ 的微小性所保证的基本级数展开，推导无量纲辐射热率\n$$\nr \\equiv \\frac{q}{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\,\\mu_{T}^{4}}\n$$\n的前两阶矩。在均值和方差的计算中，推导过程应在 $c$ 上一致地保留到前导非平凡阶，并包含直至 $c^{2}$ 阶的所有项。将最终答案表示为仅含 $c$ 的闭式解析表达式。将两个结果以单行矩阵 $\\big(\\,\\mathbb{E}[r]\\;\\;\\mathrm{Var}(r)\\,\\big)$ 的形式报告。由于 $r$ 是无量纲的，最终答案中不应包含单位。",
            "solution": "该问题陈述具有科学依据，提法恰当，客观，并包含足够信息以推导出唯一解。因此，该问题被认为是有效的。我们着手进行推导。\n\n目标是确定无量纲辐射热率 $r$ 的前两阶矩，即期望 $\\mathbb{E}[r]$ 和方差 $\\mathrm{Var}(r)$。问题指出，净辐射热率由斯蒂芬-玻尔兹曼定律 $q=\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\, T^{4}$ 给出。无量纲热率 $r$ 定义为\n$$\nr \\equiv \\frac{q}{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\,\\mu_{T}^{4}}\n$$\n将 $q$ 的表达式代入 $r$ 的定义，确定性参数 $\\epsilon$、$\\sigma_{\\mathrm{SB}}$ 和 $A$ 相消：\n$$\nr = \\frac{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\, T^{4}}{\\epsilon \\,\\sigma_{\\mathrm{SB}}\\, A \\,\\mu_{T}^{4}} = \\left(\\frac{T}{\\mu_{T}}\\right)^{4}\n$$\n绝对温度 $T$ 被建模为均值为 $\\mathbb{E}[T] = \\mu_{T}$、方差为 $\\mathrm{Var}(T) = \\sigma_{T}^{2}$ 的高斯随机变量。为方便计算，我们定义一个标准正态随机变量 $X$ 为\n$$\nX = \\frac{T - \\mu_{T}}{\\sigma_{T}}\n$$\n使得 $X \\sim \\mathcal{N}(0,1)$。根据此定义，我们可以用 $X$ 来表示 $T$：\n$$\nT = \\mu_{T} + \\sigma_{T} X\n$$\n将此式代入 $r$ 的表达式，得到：\n$$\nr = \\left(\\frac{\\mu_{T} + \\sigma_{T} X}{\\mu_{T}}\\right)^{4} = \\left(1 + \\frac{\\sigma_{T}}{\\mu_{T}} X\\right)^{4}\n$$\n利用变异系数的定义 $c = \\sigma_{T}/\\mu_{T}$， $r$ 的表达式成为一个关于 $X$ 的多项式，其系数是 $c$ 的幂：\n$$\nr = (1 + cX)^{4}\n$$\n由于指数是正整数，我们可以使用二项式定理得到一个精确的有限展开式：\n$$\nr = \\binom{4}{0}(cX)^{0} + \\binom{4}{1}(cX)^{1} + \\binom{4}{2}(cX)^{2} + \\binom{4}{3}(cX)^{3} + \\binom{4}{4}(cX)^{4}\n$$\n$$\nr = 1 + 4cX + 6c^{2}X^{2} + 4c^{3}X^{3} + c^{4}X^{4}\n$$\n为了求得期望 $\\mathbb{E}[r]$，我们利用期望算子的线性性质，对其逐项求期望：\n$$\n\\mathbb{E}[r] = \\mathbb{E}[1 + 4cX + 6c^{2}X^{2} + 4c^{3}X^{3} + c^{4}X^{4}] = 1 + 4c\\mathbb{E}[X] + 6c^{2}\\mathbb{E}[X^{2}] + 4c^{3}\\mathbb{E}[X^{3}] + c^{4}\\mathbb{E}[X^{4}]\n$$\n标准正态随机变量 $X \\sim \\mathcal{N}(0,1)$ 的各阶矩是众所周知的：$\\mathbb{E}[X] = 0$，$\\mathbb{E}[X^{2}] = 1$，$\\mathbb{E}[X^{3}] = 0$ 和 $\\mathbb{E}[X^{4}] = 3$。代入这些值，可得 $r$ 的均值的精确表达式：\n$$\n\\mathbb{E}[r] = 1 + 4c(0) + 6c^{2}(1) + 4c^{3}(0) + c^{4}(3) = 1 + 6c^{2} + 3c^{4}\n$$\n问题要求结果保留到 $c^{2}$ 阶（含）。截断该精确表达式，我们得到：\n$$\n\\mathbb{E}[r] \\approx 1 + 6c^{2}\n$$\n接下来，我们计算方差 $\\mathrm{Var}(r)$。我们使用基本关系式 $\\mathrm{Var}(r) = \\mathbb{E}[r^{2}] - (\\mathbb{E}[r])^{2}$。我们必须以所需精度阶数一致地计算右边的每一项。方差的前导项是 $c^{2}$ 阶的，因此我们计算 $\\mathbb{E}[r^{2}]$ 和 $(\\mathbb{E}[r])^{2}$ 时必须包含所有直至 $O(c^{2})$ 的项。\n\n首先，我们求出 $r^{2}$ 的表达式：\n$$\nr^{2} = ((1 + cX)^{4})^{2} = (1 + cX)^{8}\n$$\n使用二项式定理将其展开：\n$$\nr^{2} = 1 + 8cX + \\binom{8}{2}(cX)^{2} + O(c^{3}) = 1 + 8cX + 28c^{2}X^{2} + O(c^{3})\n$$\n求期望并保留到 $c^{2}$ 阶的项：\n$$\n\\mathbb{E}[r^{2}] \\approx \\mathbb{E}[1 + 8cX + 28c^{2}X^{2}] = 1 + 8c\\mathbb{E}[X] + 28c^{2}\\mathbb{E}[X^{2}] = 1 + 8c(0) + 28c^{2}(1) = 1 + 28c^{2}\n$$\n接下来，我们计算 $(\\mathbb{E}[r])^{2}$ 到 $c^{2}$ 阶。使用我们推导出的 $\\mathbb{E}[r]$ 的表达式：\n$$\n(\\mathbb{E}[r])^{2} = (1 + 6c^{2} + 3c^{4})^{2}\n$$\n展开并保留到 $c^{2}$ 阶的项：\n$$\n(\\mathbb{E}[r])^{2} \\approx (1 + 6c^{2})^{2} = 1^{2} + 2(1)(6c^{2}) + (6c^{2})^{2} = 1 + 12c^{2} + 36c^{4}\n$$\n截断到 $c^{2}$ 阶，可得：\n$$\n(\\mathbb{E}[r])^{2} \\approx 1 + 12c^{2}\n$$\n最后，我们计算方差：\n$$\n\\mathrm{Var}(r) = \\mathbb{E}[r^{2}] - (\\mathbb{E}[r])^{2} \\approx (1 + 28c^{2}) - (1 + 12c^{2}) = 16c^{2}\n$$\n这个结果是方差展开式中的前导非平凡项，并且精确到 $c^{2}$ 阶。\n\n无量纲热率 $r$ 的前两阶矩（精确到 $c^{2}$ 阶）为：\n$$\n\\mathbb{E}[r] = 1 + 6c^{2}\n$$\n$$\n\\mathrm{Var}(r) = 16c^{2}\n$$\n这些就是所要求的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1+6c^{2} & 16c^{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在从已知输入不确定性进行前向传播的基础上，我们更进一步，来解决一个更具挑战性的任务：如何利用带有噪声的实验数据来反向推断模型参数的不确定性。贝叶斯推断为此提供了一个强大的理论框架，它能够系统性地结合我们对参数的先验认知与数据中包含的信息。在本练习中，你将为一个力学模型中的材料属性（杨氏模量）进行贝叶斯校准，并学习如何利用校准结果来做出包含不确定性量化的新预测 ()。",
            "id": "2707423",
            "problem": "一根细长、均匀、线性弹性的杆承受小的单轴应变。小应变下的本构关系是线性胡克定律，可写为以下测量模型\n$$\n\\sigma_i \\;=\\; E\\,\\varepsilon_i \\;+\\; \\eta_i,\\quad i=1,\\dots,n,\n$$\n其中 $E$ 是（未知的）杨氏模量，$\\varepsilon_i$ 是给定的应变水平，$\\sigma_i$ 是测量的应力，$\\eta_i$ 是独立同分布 (i.i.d.) 的高斯测量误差，其均值为零，方差 $\\sigma^2$ 已知。假设使用共轭先验 $E \\sim \\mathcal{N}(m_0, s_0^2)$ 进行贝叶斯校准，且该先验独立于误差。\n\n给你 $n=4$ 组测量数据，应变和应力（单位为吉帕斯卡，$\\mathrm{GPa}$）如下：\n$$\n\\big(\\varepsilon_1,\\sigma_1\\big)=(0.0010,\\,0.212),\\quad\n\\big(\\varepsilon_2,\\sigma_2\\big)=(0.0015,\\,0.310),\\\\\n\\big(\\varepsilon_3,\\sigma_3\\big)=(0.0020,\\,0.425),\\quad\n\\big(\\varepsilon_4,\\sigma_4\\big)=(0.0025,\\,0.520).\n$$\n已知测量噪声方差为 $\\sigma^2 = (0.01)^2$ GPa$^2$，先验为 $m_0 = 200$ GPa 和 $s_0^2 = 30^2$ GPa$^2$。\n\n任务：\n- 从贝叶斯定理以及高斯似然和先验的定义出发，推导给定数据 $\\{(\\varepsilon_i,\\sigma_i)\\}_{i=1}^4$ 时 $E$ 的后验分布。你的推导不得引用任何未经证明的简化公式。\n- 使用全概率定律并以 $E$ 为条件，推导在新的应变水平 $\\varepsilon_\\star = 0.0030$ 下未来应力测量值 $\\sigma_\\star$ 的后验预测分布。\n- 最后，使用给定的数据和超参数，数值计算在 $\\varepsilon_\\star=0.0030$ 时的后验预测平均应力。将你的答案四舍五入到四位有效数字，并以 $\\mathrm{GPa}$ 为单位表示。你的最终响应必须是一个实数。",
            "solution": "该问题经检验具有科学依据、提法恰当且客观。这是一个固体力学中线性模型的贝叶斯校准的标准问题。所有必要信息均已提供且内部一致。我们开始求解。\n\n令 $n$ 个测量值的集合表示为 $\\mathcal{D} = \\{(\\varepsilon_i, \\sigma_i)\\}_{i=1}^n$。我们的任务是求杨氏模量 $E$ 的后验分布和新应力测量值 $\\sigma_\\star$ 的后验预测分布。\n\n第一个任务是推导给定数据时 $E$ 的后验分布 $p(E|\\mathcal{D})$。根据贝叶斯定理，后验概率密度函数正比于似然与先验的乘积：\n$$\np(E|\\mathcal{D}) \\propto p(\\mathcal{D}|E) p(E)\n$$\n测量模型由 $\\sigma_i = E\\varepsilon_i + \\eta_i$ 给出，其中误差 $\\eta_i$ 是独立同分布 (i.i.d.) 的，服从 $\\eta_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着在给定 $E$ 和 $\\varepsilon_i$ 的条件下，单次应力测量 $\\sigma_i$ 的条件分布是高斯分布：\n$$\n\\sigma_i | E \\sim \\mathcal{N}(E\\varepsilon_i, \\sigma^2)\n$$\n因此，$\\sigma_i$ 的概率密度函数为：\n$$\np(\\sigma_i|E) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(\\sigma_i - E\\varepsilon_i)^2}{2\\sigma^2} \\right)\n$$\n由于测量是独立的，整个数据集 $\\mathcal{D}$ (或简写为应力向量 $\\pmb{\\sigma} = (\\sigma_1, \\dots, \\sigma_n)^T$) 的似然是各个密度的乘积：\n$$\np(\\mathcal{D}|E) = \\prod_{i=1}^n p(\\sigma_i|E) = (2\\pi\\sigma^2)^{-n/2} \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (\\sigma_i - E\\varepsilon_i)^2 \\right)\n$$\n$E$ 的先验分布是高斯分布：$E \\sim \\mathcal{N}(m_0, s_0^2)$。其概率密度函数是：\n$$\np(E) = \\frac{1}{\\sqrt{2\\pi s_0^2}} \\exp\\left( -\\frac{(E - m_0)^2}{2s_0^2} \\right)\n$$\n现在，我们构建后验。我们可以忽略任何不依赖于 $E$ 的常数因子。\n$$\np(E|\\mathcal{D}) \\propto \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (\\sigma_i - E\\varepsilon_i)^2 \\right) \\exp\\left( -\\frac{(E - m_0)^2}{2s_0^2} \\right)\n$$\n后验分布正比于指数函数，其指数是两个参数之和：\n$$\np(E|\\mathcal{D}) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{1}{\\sigma^2} \\sum_{i=1}^n (\\sigma_i - E\\varepsilon_i)^2 + \\frac{1}{s_0^2} (E - m_0)^2 \\right] \\right)\n$$\n为了确定该分布的形式，我们将指数中的项展开为 $E$ 的二次函数：\n$$\n\\frac{1}{\\sigma^2} \\sum_{i=1}^n (\\sigma_i^2 - 2E\\varepsilon_i\\sigma_i + E^2\\varepsilon_i^2) + \\frac{1}{s_0^2} (E^2 - 2Em_0 + m_0^2)\n$$\n我们收集包含 $E^2$ 和 $E$ 的项：\n$$\nE^2 \\left( \\frac{\\sum_{i=1}^n \\varepsilon_i^2}{\\sigma^2} + \\frac{1}{s_0^2} \\right) - 2E \\left( \\frac{\\sum_{i=1}^n \\varepsilon_i\\sigma_i}{\\sigma^2} + \\frac{m_0}{s_0^2} \\right) + \\text{const.}\n$$\n这个关于 $E$ 的二次型表明后验分布也是高斯分布，我们可以写成 $E|\\mathcal{D} \\sim \\mathcal{N}(m_n, s_n^2)$。这种分布的密度正比于 $\\exp\\left(-\\frac{(E-m_n)^2}{2s_n^2}\\right)$，其指数的参数是：\n$$\n\\frac{(E-m_n)^2}{2s_n^2} = \\frac{1}{2s_n^2} (E^2 - 2Em_n + m_n^2) = E^2\\left(\\frac{1}{2s_n^2}\\right) - E\\left(\\frac{m_n}{s_n^2}\\right) + \\text{const.}\n$$\n通过将 $E^2$ 和 $E$ 的系数与从后验推导出的表达式进行比较，我们可以确定后验精度 $1/s_n^2$ 和项 $m_n/s_n^2$：\n$$\n\\frac{1}{s_n^2} = \\frac{1}{s_0^2} + \\frac{\\sum_{i=1}^n \\varepsilon_i^2}{\\sigma^2}\n$$\n$$\n\\frac{m_n}{s_n^2} = \\frac{m_0}{s_0^2} + \\frac{\\sum_{i=1}^n \\varepsilon_i\\sigma_i}{\\sigma^2}\n$$\n由此，后验方差 $s_n^2$ 和均值 $m_n$ 为：\n$$\ns_n^2 = \\left( \\frac{1}{s_0^2} + \\frac{1}{\\sigma^2} \\sum_{i=1}^n \\varepsilon_i^2 \\right)^{-1}\n$$\n$$\nm_n = s_n^2 \\left( \\frac{m_0}{s_0^2} + \\frac{1}{\\sigma^2} \\sum_{i=1}^n \\varepsilon_i\\sigma_i \\right)\n$$\n因此，后验分布为 $p(E|\\mathcal{D}) = \\mathcal{N}(m_n, s_n^2)$。这完成了第一个任务。\n\n第二个任务是推导在新应变 $\\varepsilon_\\star$ 下的新测量值 $\\sigma_\\star$ 的后验预测分布。我们使用全概率定律，对未知参数 $E$ 进行边缘化：\n$$\np(\\sigma_\\star|\\mathcal{D}) = \\int p(\\sigma_\\star, E | \\mathcal{D}) dE = \\int p(\\sigma_\\star | E, \\mathcal{D}) p(E|\\mathcal{D}) dE\n$$\n给定 $E$，新的测量值 $\\sigma_\\star$ 独立于过去的数据 $\\mathcal{D}$，所以 $p(\\sigma_\\star | E, \\mathcal{D}) = p(\\sigma_\\star | E)$。新测量的模型是 $\\sigma_\\star = E \\varepsilon_\\star + \\eta_\\star$，其中 $\\eta_\\star \\sim \\mathcal{N}(0, \\sigma^2)$。因此，相应的分布是：\n$$\np(\\sigma_\\star | E) = \\mathcal{N}(\\sigma_\\star; E\\varepsilon_\\star, \\sigma^2)\n$$\n后验预测分布是两个高斯分布的卷积：\n$$\np(\\sigma_\\star|\\mathcal{D}) = \\int \\mathcal{N}(\\sigma_\\star; E\\varepsilon_\\star, \\sigma^2) \\mathcal{N}(E; m_n, s_n^2) dE\n$$\n这个积分描述了随机变量 $\\sigma_\\star$ 的分布，它可以表示为两个独立高斯随机变量（以数据 $\\mathcal{D}$ 为条件）之和：测量中的不确定性 $\\eta_\\star \\sim \\mathcal{N}(0, \\sigma^2)$，以及平均应力中的不确定性 $E\\varepsilon_\\star$。变量 $E\\varepsilon_\\star$ 是一个缩放的高斯变量，因为 $E \\sim \\mathcal{N}(m_n, s_n^2)$，所以 $E\\varepsilon_\\star \\sim \\mathcal{N}(m_n\\varepsilon_\\star, s_n^2\\varepsilon_\\star^2)$。\n两个独立高斯随机变量之和也是一个高斯随机变量。其均值是均值之和，其方差是方差之和。\n后验预测分布的均值是：\n$$\n\\mathbb{E}[\\sigma_\\star|\\mathcal{D}] = \\mathbb{E}[E\\varepsilon_\\star + \\eta_\\star|\\mathcal{D}] = \\mathbb{E}[E\\varepsilon_\\star|\\mathcal{D}] + \\mathbb{E}[\\eta_\\star|\\mathcal{D}] = m_n \\varepsilon_\\star + 0 = m_n \\varepsilon_\\star\n$$\n后验预测分布的方差是：\n$$\n\\text{Var}(\\sigma_\\star|\\mathcal{D}) = \\text{Var}(E\\varepsilon_\\star + \\eta_\\star|\\mathcal{D}) = \\text{Var}(E\\varepsilon_\\star|\\mathcal{D}) + \\text{Var}(\\eta_\\star|\\mathcal{D}) = s_n^2 \\varepsilon_\\star^2 + \\sigma^2\n$$\n所以，后验预测分布是 $\\sigma_\\star|\\mathcal{D} \\sim \\mathcal{N}(m_n \\varepsilon_\\star, s_n^2 \\varepsilon_\\star^2 + \\sigma^2)$。这完成了第二个任务。\n\n第三个任务是使用提供的数据计算后验预测平均应力 $\\mathbb{E}[\\sigma_\\star|\\mathcal{D}] = m_n \\varepsilon_\\star$。\n给定数据：$n=4$, $(\\varepsilon_1,\\sigma_1)=(0.0010, 0.212)$, $(\\varepsilon_2,\\sigma_2)=(0.0015, 0.310)$, $(\\varepsilon_3,\\sigma_3)=(0.0020, 0.425)$, $(\\varepsilon_4,\\sigma_4)=(0.0025, 0.520)$。\n超参数：$m_0=200$, $s_0^2=30^2=900$, $\\sigma^2=(0.01)^2=0.0001$。\n新应变：$\\varepsilon_\\star = 0.0030$。\n\n首先，我们从数据中计算必要的总和：\n$$\n\\sum_{i=1}^4 \\varepsilon_i^2 = (0.0010)^2 + (0.0015)^2 + (0.0020)^2 + (0.0025)^2 = 1.35 \\times 10^{-5}\n$$\n$$\n\\sum_{i=1}^4 \\varepsilon_i\\sigma_i = (0.0010)(0.212) + (0.0015)(0.310) + (0.0020)(0.425) + (0.0025)(0.520) = 0.002827\n$$\n现在，我们计算后验参数。首先是后验方差 $s_n^2$：\n$$\n\\frac{1}{s_n^2} = \\frac{1}{s_0^2} + \\frac{\\sum \\varepsilon_i^2}{\\sigma^2} = \\frac{1}{900} + \\frac{1.35 \\times 10^{-5}}{0.0001} = \\frac{1}{900} + 0.135 = \\frac{1}{900} + \\frac{135}{1000} = \\frac{2 + 243}{1800} = \\frac{245}{1800} = \\frac{49}{360}\n$$\n$$\ns_n^2 = \\frac{360}{49}\n$$\n接下来，我们计算后验均值 $m_n$：\n$$\n\\frac{m_n}{s_n^2} = \\frac{m_0}{s_0^2} + \\frac{\\sum \\varepsilon_i\\sigma_i}{\\sigma^2} = \\frac{200}{900} + \\frac{0.002827}{0.0001} = \\frac{2}{9} + 28.27 = \\frac{2}{9} + \\frac{2827}{100} = \\frac{200 + 25443}{900} = \\frac{25643}{900}\n$$\n$$\nm_n = s_n^2 \\left( \\frac{25643}{900} \\right) = \\frac{360}{49} \\cdot \\frac{25643}{900} = \\frac{360}{900} \\cdot \\frac{25643}{49} = \\frac{2}{5} \\cdot \\frac{25643}{49} = \\frac{51286}{245}\n$$\n数值上，$m_n \\approx 209.3306 \\text{ GPa}$。最后，我们计算在 $\\varepsilon_\\star = 0.0030$ 时的后验预测平均应力：\n$$\n\\mathbb{E}[\\sigma_\\star|\\mathcal{D}] = m_n \\varepsilon_\\star = \\frac{51286}{245} \\times 0.0030 \\approx 209.330612 \\times 0.0030 \\approx 0.6279918\n$$\n四舍五入到四位有效数字，结果是 $0.6280$。单位是 GPa。",
            "answer": "$$ \\boxed{0.6280} $$"
        },
        {
            "introduction": "当简单的泰勒级数近似不足以描述复杂模型或较大输入不确定性时，我们需要更强大的工具。多项式混沌展开 (PCE) 是一种先进的谱方法，它将不确定的输出量表示为一系列关于输入随机变量的正交多项式的级数。在本练习中，你将探索 PCE 的核心机制，学习如何根据输入变量的概率分布（高斯分布或指数分布）选择合适的多项式基（Hermite 或 Laguerre 多项式），并计算截断误差 ()。这不仅能加深你对谱方法的理解，也让你掌握评估近似精度的实用技能。",
            "id": "3201102",
            "problem": "考虑量化指数响应方差的多项式混沌展开 (PCE) 中的截断误差。设 $X$ 为一维随机变量，且 $f(x) = \\exp(a x)$，其中 $a$ 为实数参数。您将比较高斯输入下使用 Hermite 多项式的 PCE 和指数输入下使用 Laguerre 多项式的 PCE。您的目标是计算每种情况下，当通过将 PCE 截断到总阶数 $p$ 来近似 $\\mathrm{Var}(f(X))$ 时所产生的绝对截断误差。\n\n请仅基于以下基本事实和定义进行推导：\n- 关于某一概率密度的正交多项式在平方可积函数空间中构成一个完备的正交基。$f(X)$ 相对于标准正交基 $\\{\\Psi_n\\}_{n \\ge 0}$ 的多项式混沌展开 (PCE) 为 $f(X) = \\sum_{n=0}^{\\infty} c_n \\Psi_n(X)$，其中 $c_n = \\mathbb{E}[f(X)\\Psi_n(X)]$ 且 $\\mathbb{E}[\\Psi_n(X)\\Psi_m(X)] = \\delta_{nm}$。\n- 对于标准正交展开，方差等于所有非常数项系数的平方和：$\\mathrm{Var}(f(X)) = \\sum_{n=1}^{\\infty} c_n^2$。阶数为 $p$ 的截断产生的近似值为 $\\mathrm{Var}_p(f(X)) = \\sum_{n=1}^{p} c_n^2$。\n- 高斯随机变量 $X \\sim \\mathcal{N}(\\mu,\\sigma^2)$ 的矩生成函数 (MGF) 为 $M_X(t) = \\exp(\\mu t + \\tfrac{1}{2}\\sigma^2 t^2)$。指数随机变量 $X \\sim \\mathrm{Exp}(\\lambda)$（速率为 $\\lambda$）的 MGF 为 $M_X(t) = \\dfrac{\\lambda}{\\lambda - t}$，其中 $t < \\lambda$。\n\n使用以下建模假设：\n- 高斯情况：若 $X \\sim \\mathcal{N}(\\mu,\\sigma^2)$，使用通过将概率论者的 Hermite 多项式 $\\mathrm{He}_n$ 应用于标准化变量 $Z = (X - \\mu)/\\sigma$ 所得到的标准正交基，即 $\\Psi_n(x) = \\mathrm{He}_n\\!\\big((x-\\mu)/\\sigma\\big)/\\sqrt{n!}$，其中 $n \\ge 0$。\n- 指数情况：若 $X \\sim \\mathrm{Exp}(\\lambda)$，其在 $[0,\\infty)$ 上的密度为 $\\lambda e^{-\\lambda x}$，使用标准正交基 $\\Psi_n(x) = L_n(\\lambda x)$，其中 $n \\ge 0$，$L_n$ 是相对于 $[0,\\infty)$ 上的权重 $e^{-y}$ 和标准化变量 $y = \\lambda x$ 的标准正交 Laguerre 多项式。\n\n您必须在程序中完成以下任务：\n- 在每种分布情况下，仅使用正交性、变量替换和基本的生成函数或变换恒等式，推导出 $f(x)=\\exp(a x)$ 的 PCE 系数 $c_n = \\mathbb{E}[f(X)\\Psi_n(X)]$ 的表达式，然后表达截断方差近似值 $\\mathrm{Var}_p(f(X)) = \\sum_{n=1}^{p} c_n^2$。\n- 仅使用提供的矩生成函数计算精确方差 $\\mathrm{Var}(f(X)) = \\mathbb{E}[\\exp(2 a X)] - \\left(\\mathbb{E}[\\exp(a X)]\\right)^2$。\n- 对于下面的每个测试用例，计算绝对截断误差 $E_p = \\left|\\mathrm{Var}(f(X)) - \\mathrm{Var}_p(f(X))\\right|$。\n- 重要有效域：在指数情况下，确保 $2a < \\lambda$ 以使 $\\mathbb{E}[\\exp(2 a X)]$ 存在；在高斯情况下，任何实数 $a$ 均有效。\n\n要实现和评估的测试套件：\n- 使用 Hermite 基的高斯情况：\n  - 情况 G$1$：$\\mu = 0$，$\\sigma = 1$， $a = 0.4$，$p = 0$。\n  - 情况 G$2$：$\\mu = 1$，$\\sigma = 0.5$，$a = 0.8$，$p = 3$。\n  - 情况 G$3$：$\\mu = -0.5$，$\\sigma = 2.0$，$a = 0.3$，$p = 6$。\n- 使用 Laguerre 基的指数情况：\n  - 情况 E$1$：$\\lambda = 1$， $a = 0.49$，$p = 2$。\n  - 情况 E$2$：$\\lambda = 1$， $a = 0.2$，$p = 0$。\n  - 情况 E$3$：$\\lambda = 2$， $a = 0.9$，$p = 5$。\n\n输出规范：\n- 对于每个用例，输出绝对截断误差 $E_p$，结果为浮点数，四舍五入到小数点后六位。\n- 您的程序应生成单行输出，其中包含按 G$1$、G$2$、G$3$、E$1$、E$2$、E$3$ 顺序排列的结果，格式为逗号分隔的列表，并用方括号括起来，例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$。\n\n角度单位不适用。不涉及物理单位。所有输出必须是数值标量。最终输出必须严格符合指定格式的一行。",
            "solution": "问题是量化函数 $f(x) = \\exp(ax)$ 的方差的多项式混沌展开 (PCE) 近似的绝对截断误差。我们考虑输入随机变量 $X$ 的两种情况：使用 Hermite 多项式基的高斯分布，以及使用 Laguerre 多项式基的指数分布。在阶数 $p$ 时的绝对截断误差定义为 $E_p = |\\mathrm{Var}(f(X)) - \\mathrm{Var}_p(f(X))|$，其中 $\\mathrm{Var}(f(X))$ 是精确方差，而 $\\mathrm{Var}_p(f(X))$ 是通过在阶数 $p$ 处截断 PCE 得到的近似方差。\n\n首先，我们建立一个精确方差的通用公式。随机变量 $Y$ 的方差为 $\\mathrm{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$。对于 $Y = f(X) = \\exp(aX)$，这变为 $\\mathrm{Var}(\\exp(aX)) = \\mathbb{E}[\\exp(2aX)] - (\\mathbb{E}[\\exp(aX)])^2$。$X$ 的矩生成函数 (MGF) 定义为 $M_X(t) = \\mathbb{E}[\\exp(tX)]$。因此，精确方差可以完全用 MGF 表示：\n$$\n\\mathrm{Var}(f(X)) = M_X(2a) - (M_X(a))^2\n$$\n这个公式将作为我们的基准真相。\n\n$f(X)$ 的 PCE 由 $f(X) = \\sum_{n=0}^{\\infty} c_n \\Psi_n(X)$ 给出，其中 $\\{\\Psi_n\\}_{n \\ge 0}$ 是一个多项式的标准正交基，系数为 $c_n = \\mathbb{E}[f(X)\\Psi_n(X)]$。标准正交性条件为 $\\mathbb{E}[\\Psi_n(X)\\Psi_m(X)] = \\delta_{nm}$。系数 $c_0$ 对应于均值，因为 $\\Psi_0$ 是一个常数（通常为 1）。具体来说，如果 $\\Psi_0=1$，则 $c_0 = \\mathbb{E}[f(X)\\Psi_0] = \\mathbb{E}[f(X)]$。方差是非常数基函数系数的平方和：$\\mathrm{Var}(f(X)) = \\sum_{n=1}^{\\infty} c_n^2$。阶数为 $p$ 的近似为 $\\mathrm{Var}_p(f(X)) = \\sum_{n=1}^{p} c_n^2$。\n\n现在我们为每种情况推导具体公式。\n\n### 情况 1：使用 Hermite PCE 的高斯输入\n设 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$。标准正交基由概率论者的 Hermite 多项式 $\\mathrm{He}_n$ 应用于标准正态变量 $Z = (X-\\mu)/\\sigma \\sim \\mathcal{N}(0,1)$ 构建。基函数为 $\\Psi_n(X) = \\frac{1}{\\sqrt{n!}}\\mathrm{He}_n(Z)$。\n\nPCE 系数为 $c_n = \\mathbb{E}[\\exp(aX) \\Psi_n(X)]$。我们进行变量替换，从 $X$ 换到 $Z$：$X = \\sigma Z + \\mu$。\n$$\nc_n = \\mathbb{E}\\left[\\exp(a(\\sigma Z + \\mu)) \\frac{1}{\\sqrt{n!}}\\mathrm{He}_n(Z)\\right] = \\frac{\\exp(a\\mu)}{\\sqrt{n!}} \\mathbb{E}\\left[\\exp(a\\sigma Z) \\mathrm{He}_n(Z)\\right]\n$$\n期望是关于 $Z \\sim \\mathcal{N}(0,1)$ 的。为了计算它，我们使用 Hermite 多项式的生成函数：$\\sum_{k=0}^{\\infty} \\frac{t^k}{k!} \\mathrm{He}_k(z) = \\exp(zt - \\frac{1}{2}t^2)$。\n考虑期望的生成函数：\n$$\n\\sum_{n=0}^{\\infty} \\frac{t^n}{n!} \\mathbb{E}[\\exp(a\\sigma Z)\\mathrm{He}_n(Z)] = \\mathbb{E}\\left[\\exp(a\\sigma Z) \\sum_{n=0}^{\\infty} \\frac{t^n}{n!}\\mathrm{He}_n(Z)\\right] = \\mathbb{E}\\left[\\exp(a\\sigma Z) \\exp(Zt - \\frac{1}{2}t^2)\\right]\n$$\n$$\n= \\exp\\left(-\\frac{1}{2}t^2\\right) \\mathbb{E}\\left[\\exp((a\\sigma + t)Z)\\right]\n$$\n期望项是 $Z \\sim \\mathcal{N}(0,1)$ 的 MGF，即 $M_Z(s) = \\exp(s^2/2)$。设 $s = a\\sigma + t$，我们得到：\n$$\n\\exp\\left(-\\frac{1}{2}t^2\\right) \\exp\\left(\\frac{1}{2}(a\\sigma+t)^2\\right) = \\exp\\left(-\\frac{1}{2}t^2 + \\frac{1}{2}(a^2\\sigma^2 + 2a\\sigma t + t^2)\\right) = \\exp\\left(\\frac{1}{2}a^2\\sigma^2 + a\\sigma t\\right)\n$$\n将其展开为关于 $t$ 的级数：$\\exp(\\frac{1}{2}a^2\\sigma^2) \\exp(a\\sigma t) = \\exp(\\frac{1}{2}a^2\\sigma^2) \\sum_{n=0}^{\\infty} \\frac{(a\\sigma t)^n}{n!} = \\sum_{n=0}^{\\infty} \\left( \\exp(\\frac{1}{2}a^2\\sigma^2) \\frac{(a\\sigma)^n}{n!} \\right) t^n$。\n通过将 $t^n$ 的系数与 $\\sum_{n=0}^{\\infty} \\frac{1}{n!} \\mathbb{E}[\\dots] t^n$ 进行匹配，我们发现 $\\mathbb{E}[\\exp(a\\sigma Z)\\mathrm{He}_n(Z)] = \\exp(\\frac{1}{2}a^2\\sigma^2) (a\\sigma)^n$。\n将此代回 $c_n$ 的表达式中：\n$$\nc_n = \\frac{\\exp(a\\mu)}{\\sqrt{n!}} \\left( \\exp(\\frac{1}{2}a^2\\sigma^2) (a\\sigma)^n \\right) = \\exp\\left(a\\mu + \\frac{1}{2}a^2\\sigma^2\\right) \\frac{(a\\sigma)^n}{\\sqrt{n!}}\n$$\n系数的平方为 $c_n^2 = \\exp\\left(2a\\mu + a^2\\sigma^2\\right) \\frac{(a^2\\sigma^2)^n}{n!}$。\n截断方差为 $\\mathrm{Var}_p(f(X)) = \\sum_{n=1}^{p} c_n^2 = \\exp(2a\\mu + a^2\\sigma^2) \\sum_{n=1}^{p} \\frac{(a^2\\sigma^2)^n}{n!}$。\n精确方差为 $\\mathrm{Var}(f(X)) = \\sum_{n=1}^{\\infty} c_n^2 = \\exp(2a\\mu + a^2\\sigma^2) \\sum_{n=1}^{\\infty} \\frac{(a^2\\sigma^2)^n}{n!}$。使用恒等式 $\\sum_{n=1}^{\\infty} \\frac{x^n}{n!} = e^x - 1$，我们得到：\n$$\n\\mathrm{Var}(f(X)) = \\exp(2a\\mu + a^2\\sigma^2) (\\exp(a^2\\sigma^2) - 1) = \\exp(2a\\mu + 2a^2\\sigma^2) - \\exp(2a\\mu + a^2\\sigma^2)\n$$\n这与基于 MGF 的公式相匹配，因为 $M_X(t)=\\exp(\\mu t + \\frac{1}{2}\\sigma^2 t^2)$。\n绝对误差为 $E_p = \\mathrm{Var}(f(X)) - \\mathrm{Var}_p(f(X))$（因为 $\\mathrm{Var}_p \\le \\mathrm{Var}$），通过从总和中减去有限和来计算。\n\n### 情况 2：使用 Laguerre PCE 的指数输入\n设 $X \\sim \\mathrm{Exp}(\\lambda)$，其概率密度函数为 $f_X(x) = \\lambda e^{-\\lambda x}$（对于 $x \\ge 0$）。标准正交基为 $\\Psi_n(X) = L_n(\\lambda X)$，其中 $L_n$ 是关于权重 $e^{-y}$ 在 $[0, \\infty)$ 上的标准正交 Laguerre 多项式。令 $Y = \\lambda X$，则 $Y \\sim \\mathrm{Exp}(1)$。\n\nPCE 系数为 $c_n = \\mathbb{E}[\\exp(aX) L_n(\\lambda X)]$。我们进行变量替换为 $Y$：$X = Y/\\lambda$。\n$$\nc_n = \\mathbb{E}\\left[\\exp(a Y/\\lambda) L_n(Y)\\right]\n$$\n期望是关于 $Y \\sim \\mathrm{Exp}(1)$ 的。我们使用标准正交 Laguerre 多项式的生成函数：$\\sum_{k=0}^{\\infty} t^k L_k(y) = \\frac{1}{1-t} \\exp\\left(\\frac{-yt}{1-t}\\right)$（对于 $|t| < 1$）。\n系数 $c_n$ 的生成函数为：\n$$\n\\sum_{n=0}^{\\infty} c_n t^n = \\mathbb{E}\\left[\\exp(aY/\\lambda) \\sum_{n=0}^{\\infty} t^n L_n(Y)\\right] = \\mathbb{E}\\left[\\exp\\left(\\frac{a}{\\lambda}Y\\right) \\frac{1}{1-t} \\exp\\left(\\frac{-Yt}{1-t}\\right)\\right]\n$$\n$$\n= \\frac{1}{1-t} \\mathbb{E}\\left[ \\exp\\left( Y \\left(\\frac{a}{\\lambda} - \\frac{t}{1-t}\\right) \\right) \\right]\n$$\n期望是 $Y \\sim \\mathrm{Exp}(1)$ 的 MGF，即 $M_Y(s)=\\frac{1}{1-s}$（对于 $s<1$）。令 $s = \\frac{a}{\\lambda}-\\frac{t}{1-t}$。条件 $2a < \\lambda$ 确保当 $t$ 接近 0 时 $s<1$。\n$$\n\\sum_{n=0}^{\\infty} c_n t^n = \\frac{1}{1-t} \\frac{1}{1 - \\left(\\frac{a}{\\lambda} - \\frac{t}{1-t}\\right)} = \\frac{1}{1-t - (1-t)\\frac{a}{\\lambda} + t} = \\frac{1}{1 - \\frac{a}{\\lambda} + \\frac{a}{\\lambda}t} = \\frac{1}{(1-a/\\lambda)(1 + \\frac{a/\\lambda}{1-a/\\lambda}t)}\n$$\n这是一个几何级数：$\\frac{1}{1-a/\\lambda} \\sum_{n=0}^{\\infty} \\left(-\\frac{a/\\lambda}{1-a/\\lambda} t\\right)^n = \\frac{\\lambda}{\\lambda-a} \\sum_{n=0}^{\\infty} \\left(-\\frac{a}{\\lambda-a}t\\right)^n$。\n通过匹配 $t^n$ 的系数：\n$$\nc_n = \\frac{\\lambda}{\\lambda-a} \\left( \\frac{-a}{\\lambda-a} \\right)^n\n$$\n系数的平方为 $c_n^2 = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 \\left( \\frac{a^2}{(\\lambda-a)^2} \\right)^n$。令 $r = \\left(\\frac{a}{\\lambda-a}\\right)^2$。则 $c_n^2 = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 r^n$。\n条件 $2a < \\lambda$ 确保 $r<1$。截断方差是一个几何和：$\\mathrm{Var}_p(f(X)) = \\sum_{n=1}^{p} c_n^2 = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 \\sum_{n=1}^{p} r^n = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 r \\frac{1-r^p}{1-r}$。\n总方差为该几何级数的和：\n$$\n\\mathrm{Var}(f(X)) = \\sum_{n=1}^{\\infty} c_n^2 = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 \\frac{r}{1-r}\n$$\n代入 $r = \\left(\\frac{a}{\\lambda-a}\\right)^2$ 并简化 $1-r$ 项：\n$$\n1-r = 1 - \\frac{a^2}{(\\lambda-a)^2} = \\frac{(\\lambda-a)^2 - a^2}{(\\lambda-a)^2} = \\frac{\\lambda^2 - 2a\\lambda}{(\\lambda-a)^2}\n$$\n因此，总方差为：\n$$\n\\mathrm{Var}(f(X)) = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 \\frac{\\left(\\frac{a}{\\lambda-a}\\right)^2}{\\frac{\\lambda^2 - 2a\\lambda}{(\\lambda-a)^2}} = \\frac{\\lambda^2 a^2}{(\\lambda-a)^4} \\frac{(\\lambda-a)^2}{\\lambda(\\lambda-2a)} = \\frac{\\lambda a^2}{(\\lambda-a)^2 (\\lambda - 2a)}\n$$\n这个结果与直接使用 MGF 得到的公式相匹配：\n$$\n\\mathrm{Var}(f(X)) = M_X(2a) - (M_X(a))^2 = \\frac{\\lambda}{\\lambda-2a} - \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 = \\frac{\\lambda(\\lambda-a)^2 - \\lambda^2(\\lambda-2a)}{(\\lambda-2a)(\\lambda-a)^2} = \\frac{a^2\\lambda}{(\\lambda-2a)(\\lambda-a)^2}\n$$\n绝对误差 $E_p = \\sum_{n=p+1}^{\\infty} c_n^2 = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 \\sum_{n=p+1}^{\\infty} r^n = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 \\frac{r^{p+1}}{1-r}$。\n代入 $r$ 和 $1-r$：\n$$\nE_p = \\left(\\frac{\\lambda}{\\lambda-a}\\right)^2 \\frac{\\left(\\frac{a}{\\lambda-a}\\right)^{2(p+1)}}{(\\lambda^2-2a\\lambda)/(\\lambda-a)^2} = \\frac{\\lambda^2}{\\lambda(\\lambda-2a)} \\left(\\frac{a}{\\lambda-a}\\right)^{2p+2} = \\frac{\\lambda}{\\lambda-2a} \\left(\\frac{a}{\\lambda-a}\\right)^{2p+2}\n$$\n这个紧凑的公式用于计算。\n\n下面的程序实现了这些推导出的解析公式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import factorial\n\ndef solve():\n    \"\"\"\n    Computes the PCE truncation error for the variance of an exponential response.\n    \"\"\"\n\n    def calculate_gaussian_error(mu, sigma, a, p):\n        \"\"\"\n        Calculates the absolute truncation error for the Gaussian case.\n        \n        The error is E_p = |Var(f(X)) - Var_p(f(X))|.\n        Var(f(X)) = exp(2*a*mu + a^2*sigma^2) * (exp(a^2*sigma^2) - 1).\n        Var_p(f(X)) = exp(2*a*mu + a^2*sigma^2) * sum_{n=1 to p} (a^2*sigma^2)^n / n!.\n        Error E_p = exp(2*a*mu + a^2*sigma^2) * |(exp(a^2*sigma^2) - 1) - sum|.\n        \"\"\"\n        # Pre-compute common terms\n        var_term_exp = 2 * a * mu + a**2 * sigma**2\n        var_term = np.exp(var_term_exp)\n        x = a**2 * sigma**2\n\n        # Calculate exact variance\n        exact_var = var_term * (np.exp(x) - 1)\n\n        # Calculate truncated variance approximation\n        # The sum is from n=1 to p. If p=0, the sum is 0.\n        if p == 0:\n            approx_var = 0.0\n        else:\n            pce_var_sum = 0.0\n            for n in range(1, p + 1):\n                pce_var_sum += (x**n) / factorial(n)\n            approx_var = var_term * pce_var_sum\n        \n        # Absolute error\n        error = np.abs(exact_var - approx_var)\n        return error\n\n    def calculate_exponential_error(lambda_val, a, p):\n        \"\"\"\n        Calculates the absolute truncation error for the Exponential case.\n        \n        Uses the derived compact formula for the error:\n        E_p = (lambda / (lambda - 2*a)) * (a / (lambda - a))**(2*p + 2)\n        \"\"\"\n        # Check validity condition\n        if 2 * a >= lambda_val:\n            raise ValueError(\"Condition 2*a  lambda is not met.\")\n        \n        term1 = lambda_val / (lambda_val - 2 * a)\n        term2 = (a / (lambda_val - a))**(2 * p + 2)\n        \n        error = term1 * term2\n        return error\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Gaussian cases: (type, mu, sigma, a, p)\n        ('G', 0.0, 1.0, 0.4, 0),\n        ('G', 1.0, 0.5, 0.8, 3),\n        ('G', -0.5, 2.0, 0.3, 6),\n        # Exponential cases: (type, lambda, a, p)\n        ('E', 1.0, 0.49, 2),\n        ('E', 1.0, 0.2, 0),\n        ('E', 2.0, 0.9, 5),\n    ]\n\n    results = []\n    for case in test_cases:\n        if case[0] == 'G':\n            _, mu, sigma, a, p = case\n            result = calculate_gaussian_error(mu, sigma, a, p)\n        elif case[0] == 'E':\n            _, lambda_val, a, p = case\n            result = calculate_exponential_error(lambda_val, a, p)\n        else:\n            raise ValueError(\"Unknown case type\")\n        \n        results.append(result)\n\n    # Format the results to six decimal places\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}