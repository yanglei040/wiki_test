{
    "hands_on_practices": [
        {
            "introduction": "This first exercise explores the fundamental trade-off between internal and external fragmentation in an extent-based system. You will analyze a scenario where an allocation decision, intended to keep a file contiguous, results in wasted space and complicates future allocations. This practice  is designed to build your intuition for the downstream consequences of even simple allocation choices, illustrating a classic dilemma in storage management.",
            "id": "3640753",
            "problem": "An Operating System (OS) uses extent-based allocation, where a file is stored as one or more extents, each consisting of a contiguous sequence of blocks. Internal fragmentation is defined as the count of unused blocks inside an allocated extent, i.e., the difference between the allocated extent length and the actual file data placed in that extent. External fragmentation is defined as the state where free space exists but is split into contiguous holes too small to satisfy future requests contiguously. Consider the following minimal, scientifically realistic scenario intended to contrast internal and external fragmentation.\n\nInitially, the free space map contains exactly three free extents of sizes $6$, $7$, and $5$ blocks. Two incoming file requests arrive in order:\n- File $\\mathsf{X}$ requires $6$ blocks.\n- File $\\mathsf{Y}$ requires $7$ blocks.\n\nAssume the system must allocate each file upon arrival without relocation of previously placed data. Extents may be split arbitrarily into smaller extents during allocation, but each extent itself is contiguous. Consider the following decision: when allocating $\\mathsf{X}$, choose the longer-than-needed $7$-block free extent for $\\mathsf{X}$ (to minimize the number of extents for $\\mathsf{X}$), thereby allocating a single $7$-block extent to hold $6$ blocks of $\\mathsf{X}$. Subsequently, allocate $\\mathsf{Y}$ using the remaining free extents as needed. This decision removes the only $7$-block free extent, so $\\mathsf{Y}$ cannot be placed contiguously in a single extent and must be split across multiple extents.\n\nUsing the simple metric\n$$F = \\frac{\\text{wasted blocks}}{\\text{allocated blocks}},$$\nwhere “wasted blocks” counts only internal fragmentation (unused blocks within allocated extents) and “allocated blocks” is the sum of all blocks reserved in extents for both files, compute $F$ for the above decision across the two-file trace. Round your answer to four significant figures and express it as a pure number with no units.",
            "solution": "The problem asks for the computation of a fragmentation metric, $F$, for a specific allocation scenario. The metric is defined as:\n$$F = \\frac{\\text{wasted blocks}}{\\text{allocated blocks}}$$\nwhere \"wasted blocks\" corresponds to internal fragmentation and \"allocated blocks\" is the total size of all extents reserved for the files.\n\nLet us trace the state of the system step-by-step.\n\n1.  **Initial State:**\n    The system's free space map consists of three contiguous extents of sizes $6$, $7$, and $5$ blocks. We can represent the set of available free extent sizes as {$6, 7, 5$}.\n\n2.  **Allocation of File $\\mathsf{X}$:**\n    The first request is for File $\\mathsf{X}$, which requires $6$ blocks of storage. The problem dictates a specific allocation decision: to use the $7$-block free extent for this request.\n    -   An extent of size $7$ blocks is allocated to File $\\mathsf{X}$.\n    -   The number of **allocated blocks** for File $\\mathsf{X}$ is therefore $7$.\n    -   Internal fragmentation is the number of unused blocks within an allocated extent. Since File $\\mathsf{X}$ uses $6$ blocks within a $7$-block extent, the internal fragmentation for File $\\mathsf{X}$ is $7 - 6 = 1$ block.\n    -   After this allocation, the $7$-block extent is removed from the free space map. The remaining free extents are of sizes $6$ and $5$ blocks. The free space map is now {$6, 5$}.\n\n3.  **Allocation of File $\\mathsf{Y}$:**\n    The second request is for File $\\mathsf{Y}$, which requires $7$ blocks of storage. The system must satisfy this request using the remaining free extents, which are of sizes $6$ and $5$.\n    -   There is no single contiguous extent of size $7$ or greater available. Therefore, File $\\mathsf{Y}$ must be stored across multiple extents (i.e., it will be split).\n    -   To satisfy the $7$-block request, the system allocates the $6$-block extent completely. This fulfills $6$ out of the $7$ required blocks.\n    -   The remaining requirement is $7 - 6 = 1$ block.\n    -   This final block must be satisfied from the remaining $5$-block free extent. The system splits this extent, creating and allocating a new extent of size $1$ block for File $\\mathsf{Y}$.\n    -   Thus, File $\\mathsf{Y}$ is stored in two extents: one of size $6$ and one of size $1$.\n    -   The total number of **allocated blocks** for File $\\mathsf{Y}$ is the sum of the sizes of its extents: $6 + 1 = 7$.\n    -   The internal fragmentation for File $\\mathsf{Y}$ is calculated for each of its extents. The $6$-block extent holds $6$ blocks of data, so its internal fragmentation is $6 - 6 = 0$. The $1$-block extent holds $1$ block of data, resulting in internal fragmentation of $1 - 1 = 0$. The total internal fragmentation for File $\\mathsf{Y}$ is $0 + 0 = 0$.\n\n4.  **Calculation of the Metric $F$:**\n    We now have all the necessary components to calculate $F$ for the entire two-file trace.\n    -   **Total wasted blocks (internal fragmentation):** This is the sum of internal fragmentation from all allocated files.\n        $$ \\text{Wasted Blocks} = (\\text{Internal Fragmentation for } \\mathsf{X}) + (\\text{Internal Fragmentation for } \\mathsf{Y}) = 1 + 0 = 1 $$\n    -   **Total allocated blocks:** This is the sum of all blocks reserved for both files.\n        $$ \\text{Allocated Blocks} = (\\text{Blocks for } \\mathsf{X}) + (\\text{Blocks for } \\mathsf{Y}) = 7 + 7 = 14 $$\n    -   The metric $F$ is the ratio of these two quantities:\n        $$ F = \\frac{1}{14} $$\n\n5.  **Final Numerical Answer:**\n    The problem requires the answer to be rounded to four significant figures.\n    $$ F = \\frac{1}{14} \\approx 0.07142857... $$\n    The first four significant figures are $7$, $1$, $4$, and $2$. The digit following the fourth significant figure ($2$) is $8$. Since $8 \\ge 5$, we round the last significant figure up.\n    $$ F \\approx 0.07143 $$",
            "answer": "$$\\boxed{0.07143}$$"
        },
        {
            "introduction": "Now, let's move from a single decision to a dynamic simulation of an extent-based file system. This problem  asks you to trace the state of a disk's free list as a file grows in bursts, applying a \"first-fit\" allocation policy. By tracking extent splits during allocation and merges during deallocation, you'll gain a concrete understanding of the bookkeeping involved in managing free space over time.",
            "id": "3640694",
            "problem": "A disk is modeled as a linear array of blocks indexed by nonnegative integers. An extent is defined as a contiguous run of blocks identified by a start index $s$ and a length $\\ell$, covering blocks $s, s+1, \\dots, s+\\ell-1$. The initial free list on the disk consists of the extents $\\{(s=0,\\ell=10),(s=20,\\ell=20),(s=50,\\ell=5)\\}$, ordered by ascending $s$. A single file grows in four bursts of sizes $[4,16,3,8]$ blocks, in that order. The system uses an extent-based allocator with the following well-tested policy:\n\n1. The free list is kept sorted by ascending start index $s$.\n2. To satisfy a burst request of size $x$, the allocator scans the free list from the beginning and greedily carves from the prefix of the current free extent. For a free extent $(s,\\ell)$, it allocates $\\min(x,\\ell)$ blocks starting at $s$. If $\\ell > \\min(x,\\ell)$, the free extent is replaced by the remainder $(s+\\min(x,\\ell),\\,\\ell-\\min(x,\\ell))$; if $\\ell = \\min(x,\\ell)$, the free extent is removed from the free list. The request size $x$ is reduced by the allocated amount and the scan continues until the burst is fully allocated.\n3. Define an extent split operation as any allocation action that leaves a positive-length remainder $(s',\\ell')$ with $\\ell' > 0$ from a previously free extent $(s,\\ell)$; consuming an entire free extent (i.e., $\\ell = \\min(x,\\ell)$) does not count as a split.\n4. After all four bursts are allocated, the file is immediately deleted. Deallocation returns each allocated extent to the free list. The free list then undergoes coalescing: any pair of adjacent free extents $(s_1,\\ell_1)$ and $(s_2,\\ell_2)$ with $s_1+\\ell_1 = s_2$ are merged into a single extent $(s_1,\\ell_1+\\ell_2)$. Coalescing proceeds until no adjacent pairs remain. Define a merge operation as the binary coalescing of one adjacent pair into one extent; a chain of $k$ adjacent extents requires $k-1$ merge operations.\n\nStarting from these definitions, compute the total number of extent split operations performed during allocation across all four bursts, plus the total number of merge operations performed during deallocation and subsequent coalescing. Express your final answer as a single integer with no units. No rounding is required.",
            "solution": "The problem requires tracing the state of the system through an allocation phase and a deallocation/coalescing phase. Let $F$ be the free list, $A$ be the list of extents allocated to the file, and let $N_{split}$ and $N_{merge}$ be the counters for split and merge operations, respectively. All extents are represented as tuples $(s, \\ell)$, where $s$ is the start index and $\\ell$ is the length.\n\n**Initial State:**\nThe initial free list is $F_0 = \\{(s=0, \\ell=10), (s=20, \\ell=20), (s=50, \\ell=5)\\}$.\nThe file's extent list is empty: $A_0 = \\{\\}$.\nThe operation counters are initialized to zero: $N_{split} = 0$, $N_{merge} = 0$.\n\n**Allocation Phase**\n\nWe process the four allocation bursts in the given order: $[4, 16, 3, 8]$.\n\n**Burst 1: Request size $x=4$**\n1.  Scan $F_0$. The first free extent is $(0, 10)$.\n2.  The request size is $x=4$, and the extent length is $\\ell=10$. We allocate $\\min(4, 10) = 4$ blocks.\n3.  An extent $(0, 4)$ is allocated to the file.\n4.  The request is satisfied ($4-4=0$).\n5.  The free extent $(0, 10)$ becomes a remainder $(0+4, 10-4) = (4, 6)$. Since the remainder length $6 > 0$, this is an extent split. We increment $N_{split}$ to $1$.\nState after Burst 1:\n-   $F_1 = \\{(4, 6), (20, 20), (50, 5)\\}$\n-   $A_1 = \\{(0, 4)\\}$\n-   $N_{split} = 1$\n\n**Burst 2: Request size $x=16$**\n1.  Scan $F_1$. The first free extent is $(4, 6)$.\n2.  The request size is $x=16$, extent length $\\ell=6$. We allocate $\\min(16, 6) = 6$ blocks. An extent $(4, 6)$ is allocated.\n3.  The request is now $16 - 6 = 10$. The extent $(4, 6)$ is fully consumed and removed from the free list. This is not a split.\n4.  The request is not yet satisfied. Continue scanning $F_1$. The next free extent is $(20, 20)$.\n5.  The request size is $x=10$, extent length $\\ell=20$. We allocate $\\min(10, 20) = 10$ blocks. An extent $(20, 10)$ is allocated.\n6.  The request is now satisfied ($10-10=0$).\n7.  The free extent $(20, 20)$ becomes a remainder $(20+10, 20-10) = (30, 10)$. Since the remainder length $10 > 0$, this is a split. We increment $N_{split}$ to $1+1=2$.\nState after Burst 2:\n-   $F_2 = \\{(30, 10), (50, 5)\\}$\n-   $A_2 = \\{(0, 4), (4, 6), (20, 10)\\}$\n-   $N_{split} = 2$\n\n**Burst 3: Request size $x=3$**\n1.  Scan $F_2$. The first free extent is $(30, 10)$.\n2.  The request size is $x=3$, extent length $\\ell=10$. We allocate $\\min(3, 10) = 3$ blocks. An extent $(30, 3)$ is allocated.\n3.  The request is satisfied ($3-3=0$).\n4.  The free extent $(30, 10)$ becomes a remainder $(30+3, 10-3) = (33, 7)$. Since the remainder length $7 > 0$, this is a split. We increment $N_{split}$ to $2+1=3$.\nState after Burst 3:\n-   $F_3 = \\{(33, 7), (50, 5)\\}$\n-   $A_3 = \\{(0, 4), (4, 6), (20, 10), (30, 3)\\}$\n-   $N_{split} = 3$\n\n**Burst 4: Request size $x=8$**\n1.  Scan $F_3$. The first free extent is $(33, 7)$.\n2.  The request size is $x=8$, extent length $\\ell=7$. We allocate $\\min(8, 7) = 7$ blocks. An extent $(33, 7)$ is allocated.\n3.  The request is now $8 - 7 = 1$. The extent $(33, 7)$ is fully consumed and removed from the free list. This is not a split.\n4.  The request is not yet satisfied. Continue scanning $F_3$. The next free extent is $(50, 5)$.\n5.  The request size is $x=1$, extent length $\\ell=5$. We allocate $\\min(1, 5) = 1$ block. An extent $(50, 1)$ is allocated.\n6.  The request is now satisfied ($1-1=0$).\n7.  The free extent $(50, 5)$ becomes a remainder $(50+1, 5-1) = (51, 4)$. Since the remainder length $4 > 0$, this is a split. We increment $N_{split}$ to $3+1=4$.\nState after Burst 4:\n-   $F_4 = \\{(51, 4)\\}$\n-   $A_4 = \\{(0, 4), (4, 6), (20, 10), (30, 3), (33, 7), (50, 1)\\}$\n-   $N_{split} = 4$\n\nThe allocation phase is complete. The total number of extent split operations is $N_{split} = 4$.\n\n**Deallocation and Coalescing Phase**\n\nThe file is deleted, and all extents in $A_4$ are returned to the free list. The free list must be kept sorted by start index $s$.\nThe current free list is $F_4 = \\{(51, 4)\\}$.\nThe extents to be returned are $A_4 = \\{(0, 4), (4, 6), (20, 10), (30, 3), (33, 7), (50, 1)\\}$.\nCombining and sorting these gives the pre-coalescing free list:\n$F_{dealloc} = \\{(0, 4), (4, 6), (20, 10), (30, 3), (33, 7), (50, 1), (51, 4)\\}$.\n\nNow we perform coalescing by identifying chains of adjacent extents. An extent $(s_1, \\ell_1)$ is adjacent to $(s_2, \\ell_2)$ if $s_1 + \\ell_1 = s_2$. A chain of $k$ adjacent extents requires $k-1$ merge operations.\n\n1.  **Chain 1**: Consider $(0, 4)$ and $(4, 6)$. Here, $s_1=0, \\ell_1=4$, so $s_1+\\ell_1 = 4$. This equals $s_2=4$. They are adjacent. The next extent is $(20, 10)$, and $4+6=10 \\ne 20$. So, this chain is $\\{(0, 4), (4, 6)\\}$. It has $k=2$ extents and requires $k-1=1$ merge operation.\n\n2.  **Chain 2**: Consider $(20, 10)$ and $(30, 3)$. Here, $20+10 = 30$. They are adjacent. Now consider $(30, 3)$ and $(33, 7)$. Here, $30+3 = 33$. They are also adjacent. The next extent is $(50, 1)$, and $33+7=40 \\ne 50$. So, this chain is $\\{(20, 10), (30, 3), (33, 7)\\}$. It has $k=3$ extents and requires $k-1=2$ merge operations.\n\n3.  **Chain 3**: Consider $(50, 1)$ and $(51, 4)$. Here, $50+1 = 51$. They are adjacent. This is the end of the list. So, this chain is $\\{(50, 1), (51, 4)\\}$. It has $k=2$ extents and requires $k-1=1$ merge operation.\n\nThe total number of merge operations is the sum of merges from each chain:\n$N_{merge} = 1 + 2 + 1 = 4$.\n\nThe final free list after coalescing would be $\\{(0, 10), (20, 20), (50, 5)\\}$, which is identical to the initial free list, as expected.\n\n**Final Calculation**\n\nThe problem asks for the total number of extent split operations plus the total number of merge operations.\nTotal Operations = $N_{split} + N_{merge} = 4 + 4 = 8$.",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "Over time, the allocation and deallocation cycle inevitably leads to external fragmentation, where free space is broken into many small, unusable pieces. This exercise  puts you in the role of a storage manager tasked with performing compaction to create a large contiguous free extent. Your goal is to find the most efficient plan by minimizing the cost of moving data, framing the practical task of defragmentation as an optimization puzzle.",
            "id": "3640686",
            "problem": "An operating system file system uses extent-based allocation, where a file occupies one or more contiguous runs of blocks called extents. External fragmentation arises when free space is split across multiple noncontiguous free extents. A compaction (defragmentation) operation may relocate whole allocated extents into currently free extents to coalesce free space. Moving an extent of length $L$ incurs a cost proportional to $L$, and the total cost of a compaction plan is the sum (in blocks) of the lengths of all moved extents. Assume that:\n- Only whole extents may be moved; an allocated extent cannot be split.\n- A moved extent must be placed entirely within a currently free extent of length at least as large; allocating into a free extent may leave a residual free fragment.\n- There are no metadata or alignment constraints beyond contiguity and capacity.\n- After moves, any adjacent free extents automatically merge into a single free extent.\n- The only cost considered is the total number of blocks moved; creating or merging free extents has no additional cost.\n\nA storage region is a linear sequence of extents from left to right as follows, where each item lists the extent type and its length in blocks:\n- $E_{1}$: free, length $10$\n- $E_{2}$: allocated, length $8$\n- $E_{3}$: free, length $6$\n- $E_{4}$: allocated, length $12$\n- $E_{5}$: free, length $5$\n- $E_{6}$: allocated, length $7$\n- $E_{7}$: free, length $14$\n- $E_{8}$: allocated, length $9$\n- $E_{9}$: free, length $4$\n- $E_{10}$: allocated, length $11$\n- $E_{11}$: free, length $13$\n- $E_{12}$: allocated, length $10$\n- $E_{13}$: free, length $11$\n\nA new file requires a single contiguous extent of size $S = 24$ blocks. You are to plan a manual compaction by moving allocated extents so that after compaction there exists at least one free contiguous run of at least $S$ blocks.\n\nStarting only from the above definitions and facts about extent-based allocation and fragmentation, determine the minimum total number of blocks that must be moved to make room for the new file. Express your answer as a single integer counting blocks. No rounding is required, and you should express the final answer in blocks (do not include units in the final boxed answer).",
            "solution": "The problem asks for the minimum cost, measured in the total number of blocks moved, to create a single contiguous free extent of at least $S = 24$ blocks. The file system uses extent-based allocation.\n\nFirst, we must formalize the objective. A contiguous free extent of size $S$ can be created by clearing a contiguous segment of the storage medium. This requires selecting a sequence of adjacent extents, $\\{E_i, E_{i+1}, \\dots, E_j\\}$, whose total length is at least $S$, and then moving all the *allocated* extents within this sequence to other free locations on the disk. The cost of this operation is the sum of the lengths of all the allocated extents that are moved. Our goal is to find the sequence of extents that meets the length requirement, allows for a valid relocation of its allocated extents, and has the minimum possible cost.\n\nAn allocated extent of length $L$ can be moved only if there exists a \"currently free extent\" (i.e., a free extent in the initial configuration) of length at least $L$. If a plan requires moving multiple allocated extents, a set of distinct, sufficiently large initial free extents must be available to accommodate all of them.\n\nLet's list the extents provided, denoting their type (F for free, A for allocated) and length $L_i$.\n- $E_{1}$: F, $L_1 = 10$\n- $E_{2}$: A, $L_2 = 8$\n- $E_{3}$: F, $L_3 = 6$\n- $E_{4}$: A, $L_4 = 12$\n- $E_{5}$: F, $L_5 = 5$\n- $E_{6}$: A, $L_6 = 7$\n- $E_{7}$: F, $L_7 = 14$\n- $E_{8}$: A, $L_8 = 9$\n- $E_{9}$: F, $L_9 = 4$\n- $E_{10}$: A, $L_{10} = 11$\n- $E_{11}$: F, $L_{11} = 13$\n- $E_{12}$: A, $L_{12} = 10$\n- $E_{13}$: F, $L_{13} = 11$\n\nThe set of allocated extent lengths is $\\{8, 12, 7, 9, 11, 10\\}$. The set of initial free extent lengths is $\\{10, 6, 5, 14, 4, 13, 11\\}$. The largest allocated extent has length $12$, and the largest free extents have lengths $14$ and $13$. Therefore, any single allocated extent can be moved. For plans requiring multiple moves, we will verify that sufficient free extents exist.\n\nWe can solve this problem by considering all possible contiguous windows of extents that could be cleared. For each possible starting extent $E_i$, we find the shortest sequence of subsequent extents $E_i, \\dots, E_j$ whose total length is at least $S=24$. We then calculate the cost for clearing this window, which is the sum of the lengths of the allocated extents within it. We find the minimum among these costs. This sliding window approach guarantees we check all minimal candidate regions.\n\nLet's calculate the cost for each minimal window satisfying the length requirement.\n\n1.  Window starting at $E_1$:\n    The sequence $E_1, E_2, E_3$ has a total length of $10 + 8 + 6 = 24$.\n    Allocated extents in this window: $E_2$ (length $8$).\n    Cost = $8$.\n\n2.  Window starting at $E_2$:\n    The sequence $E_2, E_3, E_4$ has a total length of $8 + 6 + 12 = 26$.\n    Allocated extents: $E_2$ (length $8$), $E_4$ (length $12$).\n    Cost = $8 + 12 = 20$.\n\n3.  Window starting at $E_3$:\n    The sequence $E_3, E_4, E_5, E_6$ has a total length of $6 + 12 + 5 + 7 = 30$.\n    Allocated extents: $E_4$ (length $12$), $E_6$ (length $7$).\n    Cost = $12 + 7 = 19$.\n\n4.  Window starting at $E_4$:\n    The sequence $E_4, E_5, E_6$ has a total length of $12 + 5 + 7 = 24$.\n    Allocated extents: $E_4$ (length $12$), $E_6$ (length $7$).\n    Cost = $12 + 7 = 19$.\n\n5.  Window starting at $E_5$:\n    The sequence $E_5, E_6, E_7$ has a total length of $5 + 7 + 14 = 26$.\n    Allocated extents: $E_6$ (length $7$).\n    Cost = $7$.\n\n6.  Window starting at $E_6$:\n    The sequence $E_6, E_7, E_8$ has a total length of $7 + 14 + 9 = 30$.\n    Allocated extents: $E_6$ (length $7$), $E_8$ (length $9$).\n    Cost = $7 + 9 = 16$.\n\n7.  Window starting at $E_7$:\n    The sequence $E_7, E_8, E_9$ has a total length of $14 + 9 + 4 = 27$.\n    Allocated extents: $E_8$ (length $9$).\n    Cost = $9$.\n\n8.  Window starting at $E_8$:\n    The sequence $E_8, E_9, E_{10}$ has a total length of $9 + 4 + 11 = 24$.\n    Allocated extents: $E_8$ (length $9$), $E_{10}$ (length $11$).\n    Cost = $9 + 11 = 20$.\n\n9.  Window starting at $E_9$:\n    The sequence $E_9, E_{10}, E_{11}$ has a total length of $4 + 11 + 13 = 28$.\n    Allocated extents: $E_{10}$ (length $11$).\n    Cost = $11$.\n\n10. Window starting at $E_{10}$:\n    The sequence $E_{10}, E_{11}$ has a total length of $11 + 13 = 24$.\n    Allocated extents: $E_{10}$ (length $11$).\n    Cost = $11$.\n\n11. Window starting at $E_{11}$:\n    The sequence $E_{11}, E_{12}, E_{13}$ has a total length of $13 + 10 + 11 = 34$.\n    Allocated extents: $E_{12}$ (length $10$).\n    Cost = $10$.\n\nNo other windows starting from $E_{12}$ or $E_{13}$ can sum to $24$ blocks.\n\nComparing the costs calculated: $\\{8, 20, 19, 19, 7, 16, 9, 20, 11, 11, 10\\}$.\nThe minimum cost among these is $7$.\n\nFinally, we must verify that the plan associated with the minimum cost is valid.\nThe minimum cost of $7$ corresponds to clearing the window spanning $E_5, E_6, E_7$. This plan requires moving one allocated extent, $E_6$, which has a length of $7$ blocks. The initial free extents have lengths $\\{10, 6, 5, 14, 4, 13, 11\\}$. There are several initial free extents large enough to accommodate $E_6$, such as $E_1$ (length $10$), $E_7$ (length $14$), $E_{11}$ (length $13$), and $E_{13}$ (length $11$). Since a valid destination exists for the moved extent, the plan is valid.\n\nTherefore, the minimum total number of blocks that must be moved is $7$.",
            "answer": "$$\\boxed{7}$$"
        }
    ]
}