{
    "hands_on_practices": [
        {
            "introduction": "抢占式调度的核心优势在于其灵活性，但这种优势在何时才能最大化？本练习将通过直接比较非抢占式的最短作业优先（SJF）算法和其抢占式版本——最短剩余时间优先（SRTF）算法，来揭示这一问题的答案。通过追踪一个具体工作负载的执行过程，你将亲手计算并量化抢占在降低平均等待时间方面的作用，并发现其性能增益与任务执行时间的差异性之间存在的深刻联系。",
            "id": "3670299",
            "problem": "一个操作系统运行在单核处理器上，上下文切换开销可忽略不计。考虑 $4$ 个独立的CPU密集型作业，其到达时间和CPU突发时间分别为 $(a_1,b_1)=(0,x)$、$(a_2,b_2)=(1,3)$、$(a_3,b_3)=(2,3)$ 和 $(a_4,b_4)=(3,3)$，其中 $x$ 是一个满足 $x \\geq 3$ 的实数参数。时间以抽象单位 $u$ 计量。调度程序使用两种策略之一：非抢占式最短作业优先 (SJF) 和抢占式最短剩余时间优先 (SRTF)。在SRTF中，仅当一个到达的作业的剩余时间严格小于当前正在运行的作业的剩余时间时，才会发生抢占；平局情况不会导致抢占。当多个作业具有同等资格时，决胜规则是最早到达时间优先；如果仍然平局，则按作业索引递增的顺序。只要有任何作业就绪，处理器就永远不会空闲。\n\n仅使用等待时间、平均等待时间的基本定义以及上述SJF和SRTF的操作规则，完成以下任务：\n\n- 构建每种策略为给定工作负载生成的精确执行调度（执行顺序和运行区间），并将其表示为 $x$ 的函数。\n- 根据这些调度，推导出SJF下的每个作业的等待时间 $W_i$ 和平均等待时间 $\\overline{W}_{\\mathrm{SJF}}(x)$，以及SRTF下的平均等待时间 $\\overline{W}_{\\mathrm{SRTF}}(x)$。\n- 确定使 $\\overline{W}_{\\mathrm{SRTF}}(x)  \\overline{W}_{\\mathrm{SJF}}(x)$ 的关于 $x$ 的条件。\n\n设 $V(x)$ 表示CPU突发时间多重集 $\\{x,3,3,3\\}$ 的总体方差，单位为 $u^2$。找到唯一的临界方差值 $V^{\\star}$，使得对于所有满足 $V(x) > V^{\\star}$ 的 $x \\geq 3$，严格不等式 $\\overline{W}_{\\mathrm{SRTF}}(x)  \\overline{W}_{\\mathrm{SJF}}(x)$ 成立。将最终答案表示为单个最简分数。最终数值应不带单位报告。无需四舍五入。方差应理解为四个突发时间的总体方差，时间单位为 $u$（因此方差单位为 $u^2$），但仅报告数值。",
            "solution": "用户要求我找到一个与两种调度算法性能差异相关的CPU突发时间方差的临界值。\n\n### 第1步：问题验证\n\n我将首先验证问题陈述。\n\n**从问题中提取的已知条件：**\n- **处理器：** 单核。\n- **上下文切换开销：** 可忽略不计。\n- **作业：** $4$ 个独立的CPU密集型作业。\n- **作业数据（到达时间 $a_i$，突发时间 $b_i$）：**\n  - 作业1: $(a_1, b_1) = (0, x)$\n  - 作业2: $(a_2, b_2) = (1, 3)$\n  - 作业3: $(a_3, b_3) = (2, 3)$\n  - 作业4: $(a_4, b_4) = (3, 3)$\n- **参数：** $x$ 是一个满足 $x \\geq 3$ 的实数参数。\n- **时间单位：** $u$。\n- **调度策略：**\n  - 非抢占式最短作业优先 (SJF)。\n  - 抢占式最短剩余时间优先 (SRTF)。\n- **SRTF抢占规则：** 仅当一个到达的作业的剩余时间严格小于当前正在运行的作业的剩余时间时，才会发生抢占。\n- **决胜规则：** 对于同等资格的作业，决胜规则是最早到达时间优先。如果平局持续，则按作业索引递增的顺序。\n- **处理器状态：** 如果就绪队列中有作业，处理器永不空闲。\n- **定义：**\n  - 等待时间 ($W_i$): $W_i = C_i - a_i - b_i$，其中 $C_i$ 是完成时间。\n  - 平均等待时间：$\\overline{W}$。\n- **目标：**\n  1. 构建SJF和SRTF的调度，作为 $x$ 的函数。\n  2. 推导每个作业的等待时间以及平均等待时间 $\\overline{W}_{\\mathrm{SJF}}(x)$ 和 $\\overline{W}_{\\mathrm{SRTF}}(x)$。\n  3. 确定使 $\\overline{W}_{\\mathrm{SRTF}}(x)  \\overline{W}_{\\mathrm{SJF}}(x)$ 成立的关于 $x$ 的条件。\n  4. 设 $V(x)$ 为突发时间 $\\{x, 3, 3, 3\\}$ 的总体方差。\n  5. 找到唯一的临界方差 $V^{\\star}$，使得对于所有满足 $V(x) > V^{\\star}$ 的 $x \\geq 3$，不等式 $\\overline{W}_{\\mathrm{SRTF}}(x)  \\overline{W}_{\\mathrm{SJF}}(x)$ 成立。\n\n**验证结论：**\n该问题具有科学依据，提法明确，目标客观，且内部一致。它描述了操作系统理论（CPU调度）中的一个标准场景，具有明确定义的规则和可量化的目标。所有必要信息均已提供，且没有矛盾之处。该问题需要严谨的、逐步的分析，使其成为计算机科学基础领域一个重要但可解的练习。该问题被判定为**有效**。\n\n### 第2步：求解推导\n\n我现在将进行求解。对于所有计算，时间均以 $u$ 为单位。\n\n**非抢占式最短作业优先 (SJF) 分析**\n在非抢占式策略下，作业一旦开始，就会一直运行直到完成。\n- 在时间 $t=0$ 时，只有作业1到达。它被选中运行。其突发时间为 $b_1 = x$。\n- 作业1从 $t=0$ 运行到 $t=x$。\n- 在作业1执行期间，作业2、3和4分别在时间 $t=1$、$t=2$ 和 $t=3$ 到达。\n- 在时间 $t=x$ 时，作业1完成。就绪队列包含作业2、3和4。\n- 调度程序现在必须选择下一个作业。它们的突发时间分别为 $b_2=3$、$b_3=3$ 和 $b_4=3$。由于所有突发时间都相等，因此使用最早到达时间优先的决胜规则。\n- 作业2在 $t=1$ 到达，作业3在 $t=2$ 到达，作业4在 $t=3$ 到达。首先选择作业2。\n- 作业2从 $t=x$ 运行到 $t=x+3$。\n- 在 $t=x+3$ 时，剩下的作业是作业3和作业4。两者的突发时间都是3。作业3（$t=2$ 到达）比作业4（$t=3$ 到达）先到，所以选择作业3。\n- 作业3从 $t=x+3$ 运行到 $t=x+6$。\n- 最后，作业4从 $t=x+6$ 运行到 $t=x+9$。\n\nSJF的调度顺序是：作业1 $\\to$ 作业2 $\\to$ 作业3 $\\to$ 作业4。\n完成时间 ($C_i$)：$C_1=x, C_2=x+3, C_3=x+6, C_4=x+9$。\n\n每个作业的等待时间为 $W_i = C_i - a_i - b_i$。\n- $W_{1, \\mathrm{SJF}} = x - 0 - x = 0$\n- $W_{2, \\mathrm{SJF}} = (x+3) - 1 - 3 = x-1$\n- $W_{3, \\mathrm{SJF}} = (x+6) - 2 - 3 = x+1$\n- $W_{4, \\mathrm{SJF}} = (x+9) - 3 - 3 = x+3$\n\nSJF的平均等待时间是：\n$$ \\overline{W}_{\\mathrm{SJF}}(x) = \\frac{1}{4} \\sum_{i=1}^{4} W_{i, \\mathrm{SJF}} = \\frac{1}{4} (0 + (x-1) + (x+1) + (x+3)) = \\frac{3x+3}{4} $$\n\n**抢占式最短剩余时间优先 (SRTF) 分析**\nSRTF的行为取决于是否发生抢占。如果一个到达的作业的突发时间严格小于当前正在运行作业的剩余时间，则发生抢占。\n- 在 $t=0$ 时，作业1到达并开始运行。\n- 在 $t=1$ 时，作业2到达，其突发时间 $b_2=3$。作业1已运行1个时间单位，其剩余时间为 $x-1$。如果 $3  x-1$（等价于 $x > 4$），则发生抢占。这需要根据 $x$ 的值进行案例分析。\n\n**情况1：$3 \\leq x \\leq 4$**\n- 在 $t=1$ 时，作业2到达 ($b_2=3$)。作业1的剩余时间为 $x-1$。由于 $x \\leq 4$，我们有 $x-1 \\leq 3$。抢占条件 $3  x-1$ 不成立。作业1继续运行。\n- 在 $t=2$ 时，作业3到达 ($b_3=3$)。作业1的剩余时间为 $x-2$。由于 $x \\leq 4$，我们有 $x-2 \\leq 2$。条件 $3  x-2$ 不成立。作业1继续运行。\n- 在 $t=3$ 时，作业4到达 ($b_4=3$)。作业1的剩余时间为 $x-3$。由于 $x \\leq 4$，我们有 $x-3 \\leq 1$。条件 $3  x-3$ 不成立。作业1继续运行。\n- 作业1一直运行到 $t=x$ 完成。没有发生抢占。后续对作业2、3、4的调度与SJF的情况相同。\n- 因此，对于 $3 \\leq x \\leq 4$，调度和等待时间与SJF的情况相同。\n- $\\overline{W}_{\\mathrm{SRTF}}(x) = \\overline{W}_{\\mathrm{SJF}}(x) = \\frac{3x+3}{4}$ 对于 $3 \\leq x \\leq 4$。\n\n**情况2：$x > 4$**\n- 在 $t=0$ 时，作业1 ($b_1=x$) 开始运行。\n- 在 $t=1$ 时，作业2 ($b_2=3$) 到达。作业1的剩余时间为 $x-1$。由于 $x>4$，我们有 $x-1>3$。抢占条件 $3  x-1$ 满足。作业1被抢占，作业2开始运行。\n- 在 $t=2$ 时，作业3 ($b_3=3$) 到达。作业2的剩余时间为 $3-1=2$。抢占条件 $3  2$ 不成立。作业2继续运行。\n- 在 $t=3$ 时，作业4 ($b_4=3$) 到达。作业2的剩余时间为 $2-1=1$。抢占条件 $3  1$ 不成立。作业2继续运行。\n- 作业2从 $t=1$ 运行到 $t=1+3=4$，此时它完成。\n- 在 $t=4$ 时，就绪队列中包含：作业1（剩余时间 $x-1 > 3$）、作业3（突发时间3）和作业4（突发时间3）。最短剩余时间是作业3和4的3。使用决胜规则，选择作业3（在 $t=2$ 到达）而不是作业4（在 $t=3$ 到达）。\n- 作业3从 $t=4$ 运行到 $t=4+3=7$。\n- 在 $t=7$ 时，就绪队列中包含：作业1（剩余时间 $x-1 > 3$）和作业4（突发时间3）。作业4的时间更短，被选中。\n- 作业4从 $t=7$ 运行到 $t=7+3=10$。\n- 在 $t=10$ 时，只剩下作业1。它恢复执行，并运行其剩余的 $x-1$ 个时间单位。\n- 作业1在 $t = 10 + (x-1) = x+9$ 完成。\n\n当 $x>4$ 时，完成时间 ($C_i$) 为：$C_1=x+9$, $C_2=4$, $C_3=7$, $C_4=10$。\n等待时间计算为 $W_i = C_i - a_i - b_i$：\n- $W_{1, \\mathrm{SRTF}} = (x+9) - 0 - x = 9$\n- $W_{2, \\mathrm{SRTF}} = 4 - 1 - 3 = 0$\n- $W_{3, \\mathrm{SRTF}} = 7 - 2 - 3 = 2$\n- $W_{4, \\mathrm{SRTF}} = 10 - 3 - 3 = 4$\n\n当 $x>4$ 时，SRTF的平均等待时间是：\n$$ \\overline{W}_{\\mathrm{SRTF}}(x) = \\frac{1}{4} (9 + 0 + 2 + 4) = \\frac{15}{4} $$\n对于所有 $x > 4$，此值是恒定的。\n\n**$\\overline{W}_{\\mathrm{SRTF}}(x)  \\overline{W}_{\\mathrm{SJF}}(x)$ 的条件**\n- 对于 $3 \\leq x \\leq 4$，我们有 $\\overline{W}_{\\mathrm{SRTF}}(x) = \\overline{W}_{\\mathrm{SJF}}(x)$，所以严格不等式不成立。\n- 对于 $x > 4$，我们比较 $\\overline{W}_{\\mathrm{SRTF}}(x) = \\frac{15}{4}$ 和 $\\overline{W}_{\\mathrm{SJF}}(x) = \\frac{3x+3}{4}$。\n不等式为 $\\frac{15}{4}  \\frac{3x+3}{4}$。\n$$ 15  3x+3 $$\n$$ 12  3x $$\n$$ 4  x $$\n这与我们的情况假设 ($x > 4$) 一致。\n因此，当且仅当 $x > 4$ 时，严格不等式 $\\overline{W}_{\\mathrm{SRTF}}(x)  \\overline{W}_{\\mathrm{SJF}}(x)$ 成立。\n\n**方差计算与临界值**\n设 $V(x)$ 为突发时间多重集 $\\{x, 3, 3, 3\\}$ 的总体方差。\n总体均值 $\\mu$ 为：\n$$ \\mu = \\frac{x+3+3+3}{4} = \\frac{x+9}{4} $$\n总体方差 $V(x) = \\frac{1}{N}\\sum(b_i - \\mu)^2$ 为：\n$$ V(x) = \\frac{1}{4} \\left[ \\left(x - \\frac{x+9}{4}\\right)^2 + 3 \\times \\left(3 - \\frac{x+9}{4}\\right)^2 \\right] $$\n$$ V(x) = \\frac{1}{4} \\left[ \\left(\\frac{4x - x - 9}{4}\\right)^2 + 3 \\times \\left(\\frac{12 - x - 9}{4}\\right)^2 \\right] $$\n$$ V(x) = \\frac{1}{4} \\left[ \\left(\\frac{3x - 9}{4}\\right)^2 + 3 \\times \\left(\\frac{3 - x}{4}\\right)^2 \\right] $$\n$$ V(x) = \\frac{1}{4} \\left[ \\frac{9(x-3)^2}{16} + \\frac{3(3-x)^2}{16} \\right] $$\n由于 $(3-x)^2 = (x-3)^2$：\n$$ V(x) = \\frac{1}{4} \\left[ \\frac{9(x-3)^2 + 3(x-3)^2}{16} \\right] = \\frac{1}{64} [12(x-3)^2] = \\frac{3(x-3)^2}{16} $$\n问题要求找到一个临界方差 $V^{\\star}$，使得对于所有满足 $V(x) > V^{\\star}$ 的 $x \\geq 3$，不等式 $\\overline{W}_{\\mathrm{SRTF}}(x)  \\overline{W}_{\\mathrm{SJF}}(x)$ 成立。\n我们发现此不等式在 $x > 4$ 时成立。\n我们现在必须找到与边界条件 $x=4$ 对应的 $V^{\\star}$ 值。\n函数 $V(x) = \\frac{3}{16}(x-3)^2$ 在 $x > 3$ 时是严格递增的。因此，不等式 $x>4$ 等价于不等式 $V(x) > V(4)$。\n临界方差 $V^{\\star}$ 是方差在 $x=4$ 处的值。\n$$ V^{\\star} = V(4) = \\frac{3(4-3)^2}{16} = \\frac{3(1)^2}{16} = \\frac{3}{16} $$\n对于任何满足 $V(x) > \\frac{3}{16}$ 的 $x \\ge 3$，我们必然有 $\\frac{3(x-3)^2}{16} > \\frac{3}{16}$，这意味着 $(x-3)^2 > 1$。由于 $x \\ge 3$，则 $x-3 \\ge 0$，所以我们可以取平方根得到 $x-3 > 1$，即 $x > 4$。这正是SRTF严格优于SJF的条件。\n临界方差值为 $\\frac{3}{16}$。这是一个最简分数。",
            "answer": "$$\\boxed{\\frac{3}{16}}$$"
        },
        {
            "introduction": "在理想模型中，抢占似乎总是有益的，但在真实系统中，每次上下文切换都伴随着不可忽视的开销。这个练习构建了一个巧妙的反例，让你看到最短剩余时间优先（SRTF）算法在面对密集到达的短任务时，其频繁的抢占行为如何导致“调度抖动”（thrashing），从而累积大量的切换开销。通过比较 SRTF 与一种更“保守”的调度策略，你将学会权衡抢占带来的响应速度提升与它所引发的系统开销之间的利弊。",
            "id": "3670363",
            "problem": "考虑以下单核中央处理器（CPU）调度场景。一次上下文切换会产生固定的 $s$ 个时间单位的开销，其中 $0  s  0.2$。每当 CPU 从运行一个进程切换到运行另一个不同进程时，都会发生上下文切换，包括从空闲状态到第一个进程的初始分派。当至少有一个进程就绪时，CPU 从不空闲。\n\n进程：\n- 长作业 $L$：到达时间 $0$，CPU 突发时间 $20$。\n- 构成密集到达簇的短作业：\n  - $S_{1}$：到达时间 $1.0$，CPU 突发时间 $2.0$。\n  - $S_{2}$：到达时间 $1.2$，CPU 突发时间 $1.7$。\n  - $S_{3}$：到达时间 $1.4$，CPU 突发时间 $1.4$。\n  - $S_{4}$：到达时间 $1.6$，CPU 突发时间 $1.1$。\n  - $S_{5}$：到达时间 $1.8$，CPU 突发时间 $0.8$。\n\n使用的基本定义：\n- 像最短剩余时间优先（SRTF）这样的抢占式策略总是运行剩余 CPU 突发时间最短的就绪进程，如果一个新到达的进程具有更短的剩余时间，则抢占当前进程。\n- 进程的等待时间是进程在就绪状态（未运行）下花费的总时间，可以计算为周转时间减去 CPU 突发时间，其中周转时间是完成时间减去到达时间。\n- 工作负载的总完成时间（也称为完工时间）等于所有 CPU 突发时间之和加上总上下文切换开销，前提是 CPU 没有空闲。\n\n任务：\n1. 使用最短剩余时间优先（SRTF），构建在时间区间 $[0, \\text{finish}]$ 内的运行轨迹，并计算上下文切换的次数。解释在给定 $0  s  0.2$ 的情况下，每次抢占为何在 SRTF 策略下发生。\n2. 提出一个替代调度方案，通过将抢占推迟到簇中最后一个短作业到达之后，来减少抢占次数，同时为短作业保持相似的等待时间。具体来说，从时间 $0$ 到时间 $1.8$ 运行 $L$，然后在 $1.8$ 时抢占一次 $L$，以最短作业优先的顺序 $S_{5}, S_{4}, S_{3}, S_{2}, S_{1}$ 非抢占式地运行短作业，最后恢复运行 $L$。计算此调度方案中的上下文切换次数。\n3. 使用上述计数和“总完成时间等于所有 CPU 突发时间之和加上 $s$ 乘以上下文切换次数（无 CPU 空闲时间）”这一基本关系，计算 SRTF 相对于替代调度方案所导致的总完成时间的增加量。将你的最终答案表示为一个关于 $s$（时间单位）的封闭形式解析表达式。最终的方框表达式中不要包含单位。",
            "solution": "我们从核心定义开始。在最短剩余时间优先（SRTF）策略下，每当一个进程到达且其剩余时间比当前运行进程的剩余时间短时，就会发生抢占。每次运行进程的更换都会产生持续时间为 $s$ 的上下文切换。对于这个工作负载，如果 CPU 从不空闲，总完成时间等于所有 CPU 突发时间之和加上 $s$ 乘以上下文切换的次数。\n\n首先，计算总 CPU 突发时间：\n$$\n\\text{CPU bursts sum} = 20 + 2.0 + 1.7 + 1.4 + 1.1 + 0.8 = 27.0.\n$$\n对于任何运行所有作业且无 CPU 空闲的调度方案，这个基础工作负载时间是相同的。\n\n现在定性地追踪 SRTF 以计算上下文切换次数。我们假设从空闲到第一个进程的初始分派产生一次上下文切换。\n\n- 在时间 $0$，系统分派 $L$ 并开始运行它。这计为 $1$ 次上下文切换（空闲 $\\to L$）。\n- 在时间 $1.0$，$S_{1}$ 到达，其突发时间为 $2.0$，这小于 $L$ 在 $t=1.0$ 时的剩余时间（即 $20 - (1.0 - s) = 19.0 + s$，因为 $L$ 在初始分派后于 $t=s$ 开始运行）。SRTF 抢占 $L$ 并切换到 $S_{1}$，增加 $1$ 次上下文切换（$L \\to S_{1}$）。\n- 在时间 $1.2$，$S_{2}$ 到达，其突发时间为 $1.7$。到那时，$S_{1}$ 已执行了 $(1.2 - (1.0 + s)) = 0.2 - s$ 的时间，所以其剩余时间为 $2.0 - (0.2 - s) = 1.8 + s$。由于 $1.7  1.8 + s$，SRTF 抢占 $S_{1}$ 并切换到 $S_{2}$，增加 $1$ 次上下文切换（$S_{1} \\to S_{2}$）。\n- 在时间 $1.4$，$S_{3}$ 到达，其突发时间为 $1.4$。$S_{2}$ 已执行了 $(1.4 - (1.2 + s)) = 0.2 - s$ 的时间，剩余时间为 $1.7 - (0.2 - s) = 1.5 + s$。由于 $1.4  1.5 + s$，抢占并切换到 $S_{3}$，增加 $1$ 次上下文切换（$S_{2} \\to S_{3}$）。\n- 在时间 $1.6$，$S_{4}$ 到达，其突发时间为 $1.1$。$S_{3}$ 在 $1.6$ 时的剩余时间为 $1.4 - (0.2 - s) = 1.2 + s$。由于 $1.1  1.2 + s$，抢占并切换到 $S_{4}$，增加 $1$ 次上下文切换（$S_{3} \\to S_{4}$）。\n- 在时间 $1.8$，$S_{5}$ 到达，其突发时间为 $0.8$。$S_{4}$ 在 $1.8$ 时的剩余时间为 $1.1 - (0.2 - s) = 0.9 + s$。由于 $0.8  0.9 + s$，抢占并切换到 $S_{5}$，增加 $1$ 次上下文切换（$S_{4} \\to S_{5}$）。\n\n从这里开始，没有新的进程到达。在 SRTF 策略下，$S_{5}$ 完成后，调度器会从 $\\{S_{4}, S_{3}, S_{2}, S_{1}, L\\}$ 中选择剩余时间最短的就绪进程。此时的剩余时间仍然保持 $S_{4}$、然后 $S_{3}$、然后 $S_{2}$、然后 $S_{1}$、最后 $L$ 的顺序，因为每个较早的短作业在被更短的作业抢占之前只执行了 $(0.2 - s)$ 的时间，因此其剩余时间几乎是其完整的突发时间减去 $(0.2 - s)$。\n\n因此，在 $S_{5}$ 完成后，SRTF 继续执行 $S_{4}$，然后是 $S_{3}$，然后是 $S_{2}$，然后是 $S_{1}$，最后返回到 $L$ 完成剩余部分。每次不同进程之间的转换都会产生一次上下文切换。计算 SRTF 下的所有切换次数：\n- 空闲 $\\to L$：$1$ 次。\n- $L \\to S_{1}$, $S_{1} \\to S_{2}$, $S_{2} \\to S_{3}$, $S_{3} \\to S_{4}$, $S_{4} \\to S_{5}$：$5$ 次。\n- $S_{5} \\to S_{4}$, $S_{4} \\to S_{3}$, $S_{3} \\to S_{2}$, $S_{2} \\to S_{1}$, $S_{1} \\to L$：$5$ 次。\n因此，\n$$\n\\text{switches}_{\\text{SRTF}} = 1 + 5 + 5 = 11.\n$$\n\n接下来，考虑替代调度方案，该方案通过推迟抢占直到作业簇完全到达来减少抢占，同时为短作业保持相似的等待时间：\n- 从时间 $0$ 到时间 $1.8$ 运行 $L$。\n- 在时间 $1.8$，抢占一次 $L$，并以最短作业优先的顺序非抢占式地运行短作业：$S_{5}$，然后是 $S_{4}$，然后是 $S_{3}$，然后是 $S_{2}$，然后是 $S_{1}$。\n- 短作业完成后恢复运行 $L$。\n\n计算这个替代方案中的上下文切换次数：\n- 空闲 $\\to L$：$1$ 次。\n- 在 $1.8$ 时 $L \\to S_{5}$：$1$ 次。\n- 短作业之间：$S_{5} \\to S_{4}$, $S_{4} \\to S_{3}$, $S_{3} \\to S_{2}$, $S_{2} \\to S_{1}$：$4$ 次。\n- $S_{1} \\to L$：$1$ 次。\n因此，\n$$\n\\text{switches}_{\\text{alt}} = 1 + 1 + 4 + 1 = 7.\n$$\n\n根据基本关系，在没有 CPU 空闲的情况下，总完成时间等于所有 CPU 突发时间之和加上 $s$ 乘以上下文切换的次数。由于两种调度方案运行相同的作业集且没有空闲，总完成时间的差异完全由上下文切换次数的差异决定：\n$$\nT_{\\text{SRTF}} - T_{\\text{alt}} = s \\cdot \\left(\\text{switches}_{\\text{SRTF}} - \\text{switches}_{\\text{alt}}\\right) = s \\cdot (11 - 7) = 4s.\n$$\n\n关于短作业等待时间的相似性，在 SRTF 下，每个短作业都在其到达时间附近开始，但会遭受簇内抢占；而在替代方案下，每个短作业在 $t=1.8$ 后不久开始，并运行至完成而无簇内抢占。因为作业簇在狭窄的时间区间 $[1.0, 1.8]$ 内到达，而替代方案在 $1.8$ 之后立即开始为它们服务，所以最早到达的作业（如 $S_{1}$）的额外等待时间大致受限于 $(1.8 - 1.0)$ 加上至多几次上下文切换的开销，而较晚到达的作业（如 $S_{5}$）几乎立即开始。这种集群特性确保了短作业的平均等待时间在数量级上保持相似，同时替代方案避免了导致上下文切换开销膨胀的簇内抢占连锁反应。然而，所要求的计算仅仅是完工时间的增加量，我们已经计算出来了。\n\n因此，SRTF 相对于替代调度方案所导致的总完成时间的增加量为 $4s$。",
            "answer": "$$\\boxed{4 s}$$"
        },
        {
            "introduction": "最短作业优先（SJF）和最短剩余时间优先（SRTF）算法的有效性建立在一个关键假设之上：我们能精确预知每个任务的执行时间。然而，在现实中，这几乎是不可能的，调度器只能依赖于估算。本练习将引导你从理论上分析当这些估算存在有界误差 $\\epsilon$ 时，对调度性能可能造成的最大影响。你将推导出一个通用的性能恶化上界，这不仅能加深你对调度算法鲁棒性的理解，也是对算法理论分析能力的一次重要锻炼。",
            "id": "3670280",
            "problem": "一个单处理器操作系统调度一组全部在时间 $t=0$ 到达的 $n$ 个进程 $\\{P_1,\\dots,P_n\\}$。每个进程 $P_{i}$ 有一个真实的CPU执行时间 $b_{i} \\in \\mathbb{R}_{>0}$，该时间对调度器是未知的。调度器使用抢占式最短剩余时间优先 (SRTF) 算法，该算法总是选择具有最小剩余执行时间的就绪进程。然而，调度器只能访问满足有界相对误差的估计执行时间 $\\hat{b}_{i}$：对于一个给定的 $\\epsilon$ 且 $0 \\le \\epsilon  1$，每个估计值都遵循 $|\\hat{b}_i - b_i| \\le \\epsilon b_i$。\n\n因为所有进程都在 $t=0$ 到达，SRTF调度等同于根据用于选择下一个作业的量，对进程进行非递减排序。因此，当真实执行时间已知时，SRTF退化为按 $\\{b_i\\}$ 排序的非抢占式最短作业优先 (SJF) 调度；而使用估计值时，它退化为按 $\\{\\hat{b}_i\\}$ 排序的非抢占式顺序。\n\n将进程的等待时间定义为它在首次获得CPU分配之前在就绪队列中花费的时间。令 $W_{\\mathrm{opt}}$ 表示在按非递减 $\\{b_i\\}$ 排序的先知调度下的平均等待时间，令 $W_{\\mathrm{est}}$ 表示在按非递减 $\\{\\hat{b}_i\\}$ 排序的调度下的平均等待时间。\n\n推导最紧的通用乘法界限 $R(\\epsilon)$，使得对于每个实例 $\\{b_i\\}$ 和每组满足 $|\\hat{b}_i - b_i| \\le \\epsilon b_i$（对所有 $i$）的估计值 $\\{\\hat{b}_i\\}$，不等式 $W_{\\mathrm{est}} \\le R(\\epsilon) W_{\\mathrm{opt}}$ 均成立。将你的最终答案表示为 $\\epsilon$ 的封闭形式函数。无需四舍五入。",
            "solution": "问题要求解出基于估计执行时间的调度的平均等待时间 $W_{\\mathrm{est}}$ 与最优先知调度的平均等待时间 $W_{\\mathrm{opt}}$ 之比的最紧通用乘法界限 $R(\\epsilon)$。\n\n首先，我们形式化地表述对于所有在时间 $t=0$ 到达的 $n$ 个进程的非抢占式调度的平均等待时间。设进程序列由 $\\{1, \\dots, n\\}$ 的一个排列 $\\sigma$ 给出，其中 $\\sigma(j)$ 是在第 $j$ 个位置运行的进程的索引。位于第 $j$ 个位置的进程 $P_{\\sigma(j)}$ 的等待时间是所有在其之前执行的进程的执行时间之和：$w_{\\sigma(j)} = \\sum_{k=1}^{j-1} b_{\\sigma(k)}$。\n\n调度 $\\sigma$ 的总等待时间是所有进程的等待时间之和：\n$$ TW(\\sigma) = \\sum_{j=1}^{n} w_{\\sigma(j)} = \\sum_{j=1}^{n} \\sum_{k=1}^{j-1} b_{\\sigma(k)} $$\n通过改变求和顺序，我们可以将其表示为执行时间的加权和。一个在位置 $k$ 运行的进程 $P_i$ 会将其执行时间 $b_i$ 贡献给其后 $n-k$ 个进程的等待时间。所以，$TW(\\sigma) = \\sum_{j=1}^{n-1} (n-j) b_{\\sigma(j)}$。\n平均等待时间是 $W(\\sigma) = \\frac{1}{n} TW(\\sigma)$。\n\n最优调度，即最短作业优先 (SJF)，按真实执行时间的非递减顺序对进程进行排序。设进程被索引以使得 $b_1 \\le b_2 \\le \\dots \\le b_n$。最优调度是 $\\sigma_{\\mathrm{opt}} = (1, 2, \\dots, n)$。相应的最优平均等待时间 $W_{\\mathrm{opt}}$ 是：\n$$ W_{\\mathrm{opt}} = \\frac{1}{n} \\sum_{j=1}^{n-1} (n-j) b_j $$\n\n基于估计的调度 $\\sigma_{\\mathrm{est}}$ 是一个排列 $\\pi$，它按估计执行时间的非递减顺序对进程排序，即 $\\hat{b}_{\\pi(1)} \\le \\hat{b}_{\\pi(2)} \\le \\dots \\le \\hat{b}_{\\pi(n)}$。由此产生的平均等待时间 $W_{\\mathrm{est}}$ 是：\n$$ W_{\\mathrm{est}} = \\frac{1}{n} \\sum_{j=1}^{n-1} (n-j) b_{\\pi(j)} $$\n\n我们寻求在所有可能的真实执行时间集 $\\{b_i\\}$ 和所有有效的估计集 $\\{\\hat{b}_i\\}$ 上，比率 $W_{\\mathrm{est}}/W_{\\mathrm{opt}}$ 的最大可能值。有效性条件是对于所有 $i$，有 $(1-\\epsilon) b_i \\le \\hat{b}_i \\le (1+\\epsilon) b_i$。\n$$ R(\\epsilon) = \\sup_{\\{\\{b_i\\}, \\{\\hat{b}_i\\}\\}} \\frac{W_{\\mathrm{est}}}{W_{\\mathrm{opt}}} = \\sup_{\\{\\{b_i\\}, \\pi\\}} \\frac{\\sum_{j=1}^{n-1} (n-j) b_{\\pi(j)}}{\\sum_{j=1}^{n-1} (n-j) b_j} $$\n其中排列 $\\pi$ 必须是可由一组有效估计值生成的。\n\n为了找到最紧的界限，我们构造一个最坏情况的实例。当较长的作业被安排在较早执行时，总等待时间最大化，因为它们会将自身较长的执行时间贡献给许多后续作业的等待时间。总等待时间公式中的权重 $(n-1), (n-2), \\dots, 1$ 证实了这一点。最坏情况发生在估计误差导致一个排列 $\\pi$，该排列将大的 $b_i$ 值放在调度的早期。\n\n考虑一个有 $n-1$ 个相同的“短”进程和一个“长”进程的实例。设执行时间为：\n- $n-1$ 个进程的执行时间为 $b_s$，我们可以将它们索引为 $P_1, \\dots, P_{n-1}$。\n- 一个进程 $P_n$ 的执行时间为 $b_l$，其中 $b_l > b_s$。\n\n最优调度首先运行 $n-1$ 个短进程，然后是长进程。调度顺序是 $(P_1, \\dots, P_{n-1})$ 的任意排列，后跟 $P_n$。\n$$ TW_{\\mathrm{opt}} = (n-1)b_s \\cdot (n-1-1) + \\dots = \\sum_{j=1}^{n-1} (n-j) b_s = b_s \\sum_{k=1}^{n-1} k = b_s \\frac{n(n-1)}{2} $$\n\n如果调度器被欺骗以首先运行长进程 $P_n$，则会出现最坏情况。让我们确定这是否可能。我们需要找到有效的估计值，使得对于所有 $i \\in \\{1, \\dots, n-1\\}$，都有 $\\hat{b}_n \\le \\hat{b}_i$。为了促成这种情况，我们可以选择在其允许区间极端的估计值：\n- $\\hat{b}_n = (1-\\epsilon)b_l$（长作业的最低可能估计值）\n- $\\hat{b}_i = (1+\\epsilon)b_s$ 对于 $i \\in \\{1, \\dots, n-1\\}$（短作业的最高可能估计值）\n\n条件 $\\hat{b}_n \\le \\hat{b}_i$ 变为 $(1-\\epsilon)b_l \\le (1+\\epsilon)b_s$，可简化为：\n$$ \\frac{b_l}{b_s} \\le \\frac{1+\\epsilon}{1-\\epsilon} $$\n令 $K = \\frac{1+\\epsilon}{1-\\epsilon}$。只要长短执行时间之比小于等于 $K$，首先运行长作业的调度就是可能的。为了最大化性能比，我们将考虑 $b_l/b_s \\to K^{-}$ 的极限情况。\n\n对于这种最坏情况的调度 $\\pi$，其中 $P_n$ 首先运行，然后是 $n-1$ 个短作业，总等待时间为：\n$$ TW_{\\mathrm{est}} = (n-1)b_{\\pi(1)} + (n-2)b_{\\pi(2)} + \\dots + 1 \\cdot b_{\\pi(n-1)} $$\n这里，$\\pi(1)=n$（长作业），而 $\\{\\pi(2), \\dots, \\pi(n)\\}$ 是 $\\{1, \\dots, n-1\\}$ 的一个排列。\n$$ TW_{\\mathrm{est}} = (n-1)b_l + \\sum_{k=1}^{n-2} k \\cdot b_s = (n-1)b_l + \\frac{(n-2)(n-1)}{2} b_s $$\n\n现在我们计算此实例的比率，它取决于 $n$ 和比率 $b_l/b_s$：\n$$ \\frac{TW_{\\mathrm{est}}}{TW_{\\mathrm{opt}}} = \\frac{(n-1)b_l + \\frac{(n-2)(n-1)}{2} b_s}{\\frac{n(n-1)}{2} b_s} = \\frac{b_l + \\frac{n-2}{2} b_s}{\\frac{n}{2} b_s} = \\frac{2}{n}\\frac{b_l}{b_s} + \\frac{n-2}{n} $$\n为了找到给定 $n$ 的最坏比率，我们取 $b_l/b_s \\to K$ 的极限：\n$$ R_n(\\epsilon) = \\frac{2}{n}K + \\frac{n-2}{n} = 1 + \\frac{2(K-1)}{n} $$\n代入 $K = \\frac{1+\\epsilon}{1-\\epsilon}$，我们得到 $K-1 = \\frac{1+\\epsilon - (1-\\epsilon)}{1-\\epsilon} = \\frac{2\\epsilon}{1-\\epsilon}$。\n$$ R_n(\\epsilon) = 1 + \\frac{2}{n} \\left( \\frac{2\\epsilon}{1-\\epsilon} \\right) = 1 + \\frac{4\\epsilon}{n(1-\\epsilon)} $$\n问题要求一个通用界限，因此我们必须找到 $R_n(\\epsilon)$ 在所有可能的进程数 $n$ 上的最大值。这种构造要求至少一个短作业和一个长作业，所以 $n \\ge 2$。\n因为 $\\epsilon \\ge 0$ 且 $1-\\epsilon > 0$，项 $\\frac{4\\epsilon}{n(1-\\epsilon)}$ 是非负的，并且是 $n$ 的递减函数。因此，$R_n(\\epsilon)$ 的最大值在 $n$ 的最小可能值处取得，即 $n=2$。\n\n对于 $n=2$：\n$$ R(\\epsilon) = R_2(\\epsilon) = 1 + \\frac{4\\epsilon}{2(1-\\epsilon)} = 1 + \\frac{2\\epsilon}{1-\\epsilon} = \\frac{1-\\epsilon+2\\epsilon}{1-\\epsilon} = \\frac{1+\\epsilon}{1-\\epsilon} $$\n这个界限是紧的，因为它可以被一个有效的问题序列所逼近（例如，当 $n=2$ 且 $b_2/b_1 \\to K^{-}$ 时）。虽然一个完整的证明还需要表明没有其他类型的实例会产生更差的比率，但这个构造给出了该问题的既定紧界。当估计误差刚好足以颠倒两个作业的顺序时，可以达到最坏情况的比率，这两个作业的真实执行时间在可颠倒性约束下相差最大。\n\n因此，最紧的通用乘法界限 $R(\\epsilon)$ 是 $\\frac{1+\\epsilon}{1-\\epsilon}$。",
            "answer": "$$\\boxed{\\frac{1+\\epsilon}{1-\\epsilon}}$$"
        }
    ]
}