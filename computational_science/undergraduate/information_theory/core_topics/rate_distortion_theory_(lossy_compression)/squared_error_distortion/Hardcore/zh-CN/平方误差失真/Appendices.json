{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基本任务开始：对于一个简单的离散信源，我们应如何选择最佳的代表值以最小化误差？这个练习将引导你计算给定划分下的“质心”(centroid)，这是量化器设计中最小化平方误差失真的基石。通过这个实践，你将掌握寻找最优重构电平的核心方法。",
            "id": "1659863",
            "problem": "一个离散无记忆信源 $X$ 从符号集 $\\mathcal{X} = \\{1, 2, 4, 8\\}$ 中产生符号。每个符号以相等的概率生成。我们希望使用一个两级量化器来设计一种简单的数据压缩方案。信源符号集被划分为两个不相交的集合：$R_1 = \\{1, 2\\}$ 和 $R_2 = \\{4, 8\\}$。$R_1$ 中的所有符号都映射到单个表示水平 $\\hat{x}_1$，$R_2$ 中的所有符号都映射到第二个表示水平 $\\hat{x}_2$。\n\n量化的质量由平均平方误差失真来衡量，其定义为信源符号与其表示之间差的平方的期望值。\n\n确定最佳表示水平 $\\hat{x}_1^*$ 和 $\\hat{x}_2^*$，以最小化给定划分下的平均平方误差失真。按顺序给出 $\\hat{x}_1^*$ 和 $\\hat{x}_2^*$ 的精确值作为您的答案。",
            "solution": "该问题要求找出最佳表示水平 $\\hat{x}_1^*$ 和 $\\hat{x}_2^*$，以最小化给定信源和划分下的平均平方误差失真。\n\n信源符号集为 $\\mathcal{X} = \\{1, 2, 4, 8\\}$。由于四个符号中的每一个都以相等的概率生成，因此对于每个 $x \\in \\mathcal{X}$，其概率质量函数 (PMF) 为 $p(x) = \\frac{1}{4}$。\n\n失真度量为平方误差，$d(x, \\hat{x}) = (x - \\hat{x})^2$。\n\n平均失真 $D$ 是失真的期望值，可以写为对所有信源符号的求和：\n$$D = E[d(X, \\hat{X})] = \\sum_{x \\in \\mathcal{X}} p(x) d(x, \\hat{x}(x))$$\n其中 $\\hat{x}(x)$ 是信源符号 $x$ 的表示水平。\n\n信源符号集被划分为 $R_1 = \\{1, 2\\}$ 和 $R_2 = \\{4, 8\\}$。$R_1$ 中的所有符号都由 $\\hat{x}_1$ 表示，$R_2$ 中的所有符号都由 $\\hat{x}_2$ 表示。因此，我们可以将平均失真写为 $\\hat{x}_1$ 和 $\\hat{x}_2$ 的函数：\n$$D(\\hat{x}_1, \\hat{x}_2) = \\sum_{x \\in R_1} p(x) (x - \\hat{x}_1)^2 + \\sum_{x \\in R_2} p(x) (x - \\hat{x}_2)^2$$\n和中的两项是独立的。第一项仅取决于 $\\hat{x}_1$，第二项仅取决于 $\\hat{x}_2$。因此，我们可以通过分别最小化每一项来最小化 $D$。\n\n为了找到区域 $R_1$ 的最佳表示水平 $\\hat{x}_1^*$，我们通过对相应项关于 $\\hat{x}_1$ 求导并将其设为零来最小化该项：\n$$\\frac{\\partial}{\\partial \\hat{x}_1} \\left[ \\sum_{x \\in R_1} p(x) (x - \\hat{x}_1)^2 \\right] = 0$$\n$$\\sum_{x \\in R_1} p(x) \\cdot 2(x - \\hat{x}_1) \\cdot (-1) = 0$$\n$$-2 \\left( \\sum_{x \\in R_1} x p(x) - \\hat{x}_1 \\sum_{x \\in R_1} p(x) \\right) = 0$$\n求解 $\\hat{x}_1$，我们得到最佳值 $\\hat{x}_1^*$：\n$$\\hat{x}_1^* = \\frac{\\sum_{x \\in R_1} x p(x)}{\\sum_{x \\in R_1} p(x)}$$\n这是在 $X \\in R_1$ 条件下 $X$ 的条件期望，也称为该区域的质心。\n\n现在我们可以代入区域 $R_1 = \\{1, 2\\}$ 的值：\n$$p(1) = \\frac{1}{4}, \\quad p(2) = \\frac{1}{4}$$\n$$\\hat{x}_1^* = \\frac{1 \\cdot p(1) + 2 \\cdot p(2)}{p(1) + p(2)} = \\frac{1 \\cdot \\frac{1}{4} + 2 \\cdot \\frac{1}{4}}{\\frac{1}{4} + \\frac{1}{4}} = \\frac{\\frac{3}{4}}{\\frac{2}{4}} = \\frac{3}{2}$$\n\n类似地，对于区域 $R_2 = \\{4, 8\\}$，最佳表示水平 $\\hat{x}_2^*$ 是 $R_2$ 的质心：\n$$\\hat{x}_2^* = \\frac{\\sum_{x \\in R_2} x p(x)}{\\sum_{x \\in R_2} p(x)}$$\n代入区域 $R_2 = \\{4, 8\\}$ 的值：\n$$p(4) = \\frac{1}{4}, \\quad p(8) = \\frac{1}{4}$$\n$$\\hat{x}_2^* = \\frac{4 \\cdot p(4) + 8 \\cdot p(8)}{p(4) + p(8)} = \\frac{4 \\cdot \\frac{1}{4} + 8 \\cdot \\frac{1}{4}}{\\frac{1}{4} + \\frac{1}{4}} = \\frac{\\frac{12}{4}}{\\frac{2}{4}} = \\frac{12}{2} = 6$$\n\n因此，最小化平均平方误差失真的最佳表示水平是 $\\hat{x}_1^* = 3/2$ 和 $\\hat{x}_2^* = 6$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3}{2}  6 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了最优重构电平的概念后，我们进一步探讨判决边界 (decision boundary) 选择的影响。这个实践  将挑战我们去比较一个连续信源的两种直观边界设置——均值和中位数，并揭示量化器的性能对边界选择的高度敏感性。这有助于我们理解量化器设计是一个涉及多个参数相互作用的优化问题。",
            "id": "1659817",
            "problem": "一个连续随机变量 $X$ 服从标准指数分布，其概率密度函数 (PDF) 为 $f(x) = \\exp(-x)$ (当 $x \\ge 0$ 时)，以及 $f(x) = 0$ (当 $x  0$ 时)。该信号将由一个一比特标量量化器进行量化。\n\n该量化器使用一个判决边界 $b > 0$ 将 $X$ 的取值范围划分为两个区域：$R_1 = [0, b)$ 和 $R_2 = [b, \\infty)$。对于给定的输入 $x$，如果 $x \\in R_i$，量化器的输出是一个固定的重建电平 $y_i$。为了在给定边界 $b$ 的情况下最小化平均平方误差失真，最优的重建电平是各自区域的形心（条件期望）：\n$$y_1 = E[X | X \\in R_1] \\quad \\text{和} \\quad y_2 = E[X | X \\in R_2]$$\n总平方误差失真由 $D = E[(X - Q(X))^2]$ 给出，其中 $Q(X)$ 是 $X$ 的量化值。\n\n我们希望比较两种不同判决边界 $b$ 选择所导致的失真：\n- **情况1**：判决边界 $b$ 设置为 $X$ 分布的均值。\n- **情况2**：判决边界 $b$ 设置为 $X$ 分布的中位数。\n\n下列哪个陈述是正确的？\n\nA. 将边界设置在均值处导致更低的失真。\nB. 将边界设置在中位数处导致更低的失真。\nC. 两种设置导致相同的失真。\nD. 其中一种或两种设置的失真为无穷大。",
            "solution": "为了解决这个问题，我们需要计算并比较两种情况下由判决边界 $b$ 引起的总平方误差失真 $D(b)$。\n\n对于标准指数分布 $X \\sim \\text{Exp}(1)$，其PDF为 $f(x)=e^{-x}$ for $x \\ge 0$。\n- **均值**: $E[X] = 1$。\n- **中位数**: 求解 $\\int_0^m e^{-x} dx = 0.5$，得到 $1 - e^{-m} = 0.5$，即 $m = \\ln(2)$。\n\n对于给定的边界 $b$，最优重构电平 $y_1$ 和 $y_2$ 是区域的形心。\n$y_1 = E[X | X  b] = \\frac{\\int_0^b x e^{-x} dx}{\\int_0^b e^{-x} dx} = \\frac{[-xe^{-x}-e^{-x}]_0^b}{[-e^{-x}]_0^b} = \\frac{1 - e^{-b}(b+1)}{1-e^{-b}}$\n$y_2 = E[X | X \\ge b]$。利用指数分布的无记忆性，$E[X-b | X \\ge b] = E[X] = 1$，所以 $y_2 = b + 1$。\n\n总失真可以方便地用公式 $D(b) = E[X^2] - E[Q(X)^2]$ 计算，其中 $E[X^2] = \\text{Var}(X) + (E[X])^2 = 1 + 1^2 = 2$。\n$E[Q(X)^2] = y_1^2 P(X  b) + y_2^2 P(X \\ge b) = y_1^2 (1-e^{-b}) + y_2^2 e^{-b}$。\n代入 $y_1$ 和 $y_2$ 的表达式：\n$E[Q(X)^2] = \\left(\\frac{1 - e^{-b}(b+1)}{1-e^{-b}}\\right)^2 (1-e^{-b}) + (b+1)^2 e^{-b} = \\frac{(1 - e^{-b}(b+1))^2}{1-e^{-b}} + (b+1)^2 e^{-b}$。\n因此，$D(b) = 2 - \\left[ \\frac{(1 - e^{-b}(b+1))^2}{1-e^{-b}} + (b+1)^2 e^{-b} \\right]$。\n\n**情况1：边界为均值，$b=1$**\n$e^{-1} \\approx 0.3679$\n$y_1 = \\frac{1-e^{-1}(1+1)}{1-e^{-1}} = \\frac{1-2e^{-1}}{1-e^{-1}} \\approx \\frac{1 - 2(0.3679)}{1 - 0.3679} \\approx \\frac{0.2642}{0.6321} \\approx 0.4180$\n$y_2 = 1+1=2$\n$D(1) = 2 - [y_1^2(1-e^{-1}) + y_2^2 e^{-1}] = 2 - [(0.4180)^2(0.6321) + 4(0.3679)] \\approx 2 - [0.1103 + 1.4715] = 2 - 1.5818 = 0.4182$\n\n**情况2：边界为中位数，$b=\\ln(2)$**\n$e^{-b} = e^{-\\ln(2)} = 0.5$\n$y_1 = \\frac{1-0.5(\\ln 2+1)}{1-0.5} = 2(1 - 0.5(\\ln 2+1)) = 2 - \\ln 2 - 1 = 1 - \\ln 2 \\approx 0.3069$\n$y_2 = \\ln 2 + 1 \\approx 1.6931$\n$E[Q(X)^2] = y_1^2(0.5) + y_2^2(0.5) = 0.5[(1-\\ln 2)^2 + (1+\\ln 2)^2]$\n利用代数恒等式 $(a-c)^2 + (a+c)^2 = 2(a^2+c^2)$，其中 $a=1, c=\\ln 2$：\n$E[Q(X)^2] = 0.5 \\cdot 2(1^2 + (\\ln 2)^2) = 1 + (\\ln 2)^2$\n$D(\\ln 2) = E[X^2] - E[Q(X)^2] = 2 - (1+(\\ln 2)^2) = 1 - (\\ln 2)^2 \\approx 1 - (0.6931)^2 \\approx 1 - 0.4805 = 0.5195$\n\n**比较**\n$D(1) \\approx 0.4182$\n$D(\\ln 2) \\approx 0.5195$\n由于 $D(1)  D(\\ln 2)$，将判决边界设置在均值处导致的失真更低。因此，陈述A是正确的。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "我们的最后一个实践将问题提升到信号处理中常见的系统层面。当资源有限时，我们应该优先量化哪个信号？这个练习  阐明了比特分配的一个基本原则：将资源集中在不确定性（即方差）最大的分量上，从而实现总体失真的最大程度降低。这是在通信和数据压缩中做出高效决策的关键。",
            "id": "1659835",
            "problem": "一个数据采集系统测量两个独立的物理量，这两个物理量可以建模为两个独立的随机变量 $X$ 和 $Y$。两者都服从均值为零的正态分布。$X$ 的方差为 $\\sigma_X^2 = 9$，$Y$ 的方差为 $\\sigma_Y^2 = 1$。\n\n由于带宽限制，您只能使用单个比特来改进其中一个量的表示。您有两个选择：\n1.  使用该比特为 $X$ 创建一个一位量化器。在这种情况下，$Y$ 的表示（记为 $\\hat{Y}$）将是其期望值。\n2.  使用该比特为 $Y$ 创建一个一位量化器。在这种情况下，$X$ 的表示（记为 $\\hat{X}$）将是其期望值。\n\n假设无论对哪个变量进行量化，都使用最优的一位量化器。最优量化器是指最小化均方误差失真的量化器。系统的总失真是各个失真之和：$D_{total} = E[(X-\\hat{X})^2] + E[(Y-\\hat{Y})^2]$。\n\n以下哪种策略会导致更低的总均方误差失真？\n\nA. 用一位量化 $X$ 会导致更低的总失真。\nB. 用一位量化 $Y$ 会导致更低的总失真。\nC. 两种策略导致的总失真完全相同。\nD. 如果没有关于量化器设计的更多信息，无法确定哪种策略更好。",
            "solution": "令 $X \\sim \\mathcal{N}(0,\\sigma_{X}^{2})$，其中 $\\sigma_{X}^{2}=9$；令 $Y \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})$，其中 $\\sigma_{Y}^{2}=1$，且两者独立。如果一个变量未被量化，而是用其均值（即零）来表示，那么它的均方误差等于其方差：\n$$ E[(V-0)^{2}] = \\text{Var}(V) $$\n对于使用最优MSE量化器进行一位量化的变量，我们首先考虑标准正态分布的情况 $Z \\sim \\mathcal{N}(0,1)$。根据对称性和 Lloyd-Max 最优性条件，最优的一位量化器具有零阈值和对称的重建电平 $\\pm a$。定义 $Q(Z)=a$ 如果 $Z \\ge 0$，且 $Q(Z)=-a$ 如果 $Z  0$。失真作为 $a$ 的函数为：\n$$ D(a) = E[(Z-Q(Z))^2] = E[Z^2] - 2aE[Z\\operatorname{sign}(Z)] + a^2 $$\n由于 $Z\\operatorname{sign}(Z)=|Z|$ 且 $E[Z^2]=1$，我们有：\n$$ D(a) = 1 - 2aE[|Z|] + a^2 $$\n对 $a$ 进行最小化可得：\n$$ \\frac{dD}{da}=-2E[|Z|]+2a=0 \\quad \\Rightarrow \\quad a^{\\star}=E[|Z|] $$\n因此，最小失真为：\n$$ D^{\\star}=1-(E[|Z|])^2 $$\n对于 $Z \\sim \\mathcal{N}(0,1)$，使用 $\\phi(z)=\\frac{1}{\\sqrt{2\\pi}}\\exp(-z^{2}/2)$，\n$$ E[|Z|]=2\\int_{0}^{\\infty} z \\phi(z)\\,dz=2\\left[-\\phi(z)\\right]_{0}^{\\infty}=2\\phi(0)=\\sqrt{\\frac{2}{\\pi}} $$\n所以\n$$ D^{\\star}=1-\\frac{2}{\\pi} $$\n根据尺度不变性，如果 $V=\\sigma Z$，应用缩放后的最优一位量化器可得：\n$$ E[(V-\\hat{V})^{2}]=\\sigma^{2} D^{\\star}=\\sigma^{2}\\left(1-\\frac{2}{\\pi}\\right) $$\n现在评估这两种策略：\n\n1) 量化 $X$，用 $Y$ 的均值表示 $Y$：\n$$ D_{\\text{total},X}=E[(X-\\hat{X})^{2}] + E[(Y-\\hat{Y})^{2}] = \\sigma_{X}^{2}\\left(1-\\frac{2}{\\pi}\\right) + \\sigma_{Y}^{2} = 9\\left(1-\\frac{2}{\\pi}\\right) + 1 $$\n\n2) 量化 $Y$，用 $X$ 的均值表示 $X$：\n$$ D_{\\text{total},Y}=E[(X-\\hat{X})^{2}] + E[(Y-\\hat{Y})^{2}] = \\sigma_{X}^{2} + \\sigma_{Y}^{2}\\left(1-\\frac{2}{\\pi}\\right) = 9 + 1\\left(1-\\frac{2}{\\pi}\\right) $$\n比较：\n$$ D_{\\text{total},X} - D_{\\text{total},Y} = \\left[9\\left(1-\\frac{2}{\\pi}\\right)+1\\right] - \\left[9 + \\left(1-\\frac{2}{\\pi}\\right)\\right] = 9 - \\frac{18}{\\pi} + 1 - 9 - 1 + \\frac{2}{\\pi} = -\\frac{16}{\\pi}  0 $$\n因此 $D_{\\text{total},X}  D_{\\text{total},Y}$，所以量化 $X$ 会产生更低的总失真。\n\n直观地看，一位量化带来的失真减少量为 $\\sigma^2 - \\sigma^2(1 - 2/\\pi) = \\sigma^2 (2/\\pi)$。这个减少量与方差 $\\sigma^2$ 成正比。因此，将有限的比特资源（本例中为1比特）用于量化方差更大的变量（$X$）会带来更大的失真降低，从而使总失真最小。\n\n因此，正确选项是 A。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}