## 引言
马尔可夫链是现代概率论和信息论中用于描述[随机过程](@entry_id:159502)的基石。从网页浏览到分子进化，从天气变化到市场波动，许多看似无序的系统都遵循着[马尔可夫过程](@entry_id:160396)的内在逻辑。一个核心问题是：当这些[随机系统](@entry_id:187663)演化足够长的时间后，它们的行为会呈现出何种模式？我们是否可以预测其最终的稳定状态，而不受其初始状态的干扰？

本文旨在深入探讨一类具有良好[长期行为](@entry_id:192358)的[马尔可夫链](@entry_id:150828)——遍历链和正则链，并解决上述知识鸿沟。我们将系统地揭示这类[随机过程](@entry_id:159502)如何以及为何会“忘记”它们的起点，并收敛到一个独特的、可预测的平衡状态，即[平稳分布](@entry_id:194199)。

在接下来的内容中，读者将循序渐进地掌握这一强大理论。在 **“原理与机制”** 章节中，我们将从基本的[状态分类](@entry_id:276397)出发，建立不可约性、周期性和遍历性的概念，并详细介绍如何计算决定系统[长期行为](@entry_id:192358)的平稳分布。随后，**“应用与跨学科联系”** 章节将展示这些理论如何在计算机科学（如[PageRank算法](@entry_id:138392)）、经济学（市场份额分析）和自然科学等领域发挥作用，将抽象的数学工具转化为解决实际问题的利器。最后，**“动手实践”** 部分将通过具体问题引导您应用所学知识，巩固对核心概念的理解。通过本次学习，您将能够洞察随机性背后的确定性规律。

## 原理与机制

在介绍性章节之后，我们现在深入探讨遍历和[正则马尔可夫链](@entry_id:261139)的核心原理。本章的目标是系统地阐述这些[随机过程](@entry_id:159502)的长期行为，并建立一个能够分析其稳定[状态和](@entry_id:193625)收敛特性的理论框架。我们将从状态的分类开始，逐步引入不可约性、周期性和遍历性的概念，最终聚焦于平稳分布的计算及其深刻的物理和信息论意义。

### [马尔可夫链](@entry_id:150828)中的[状态分类](@entry_id:276397)与结构

为了理解一个马尔可夫链的长期动态，我们首先必须理解其内部的结构，这通过对状态进行分类来实现。

#### 连通类与不可约性

一个[马尔可夫链](@entry_id:150828)的核心结构特征是其状态之间的可达性。我们称状态 $i$ 与状态 $j$ **连通**（记作 $i \leftrightarrow j$），如果从状态 $i$ 出发，经过有限步数可以到达状态 $j$，并且从状态 $j$ 出发，也能经过有限步数回到状态 $i$。这种连通关系是一种[等价关系](@entry_id:138275)，它将状态空间划分为若干个不相交的**连通类**（communicating classes）。

当整个[状态空间](@entry_id:177074)构成一个单一的连通类时，也就是说，从任何一个状态都可以到达任何其他状态，我们称这个[马尔可夫链](@entry_id:150828)是**不可约的**（irreducible）。如果一个链不是不可约的，则称为**可约的**（reducible）。

例如，考虑一个具有三个状态 $\{1, 2, 3\}$ 的系统，其转移矩阵为：
$$
P_B = \begin{pmatrix} 0.5 & 0.5 & 0 \\ 0.5 & 0.5 & 0 \\ 0 & 0 & 1 \end{pmatrix}
$$
在这个模型中，从状态 1 或 2 无法到达状态 3，同样，从状态 3 也无法到达状态 1 或 2。因此，这个链是可约的，它有两个连通类：$\{1, 2\}$ 和 $\{3\}$ 。

另一个[可约链](@entry_id:200553)的例子是模拟通勤过程的模型，其状态为 $S_1$（在家）、$S_2$（高速畅通）、$S_3$（中度拥堵）和 $S_4$（完全堵死）。其[转移矩阵](@entry_id:145510)可能形如：
$$
P = \begin{pmatrix}
0 & 1 & 0 & 0 \\
0 & 0.7 & 0.3 & 0 \\
0 & 0.4 & 0.4 & 0.2 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$
在这个模型中，一旦进入 $S_4$（完全堵死）状态，就无法再回到任何其他状态。因此，该链不是不可约的 。不可约性是讨论全局长期稳定行为的一个基本前提。

#### 暂态与[常返态](@entry_id:276969)

根据返回一个状态的概率，状态可以被分为两类。一个状态 $i$ 被称为**常返的**（recurrent），如果从状态 $i$ 出发，最终能以概率 1 返回状态 $i$。如果这个返回概率小于 1，则该状态被称为**暂态的**（transient）。直观地说，如果一个过程从一个暂态出发，它可能会访问该状态几次，但最终会离开并且永不返回。

在上述通勤模型  中，状态 $S_1$、$S_2$ 和 $S_3$ 都是暂态的。例如，从 $S_3$ 出发，有 $0.2$ 的概率转移到 $S_4$。一旦进入 $S_4$，系统将永远停留在那里。因此，存在一个非零的概率使得系统永远不会从 $S_4$ 返回到 $S_3$，这使得 $S_3$ 成为暂态。同理可证 $S_1$ 和 $S_2$ 也是暂态。

相比之下，状态 $S_4$ 是一个**[吸收态](@entry_id:161036)**（absorbing state），即一旦进入就无法离开（$P_{44}=1$）。[吸收态](@entry_id:161036)是一种特殊的[常返态](@entry_id:276969)。对于有限状态[马尔可夫链](@entry_id:150828)，一个重要的性质是：在一个不可约的链中，所有状态要么都是暂态的，要么都是常返的。由于至少会有一个状态被访问无穷多次，所以有限不[可约链](@entry_id:200553)中的所有状态都必须是常返的。

#### 周期性

对于一个[常返态](@entry_id:276969) $i$，我们关心系统返回该状态所需的时间步数。返回状态 $i$ 的所有可能步数 $n$（要求 $(P^n)_{ii} > 0$）的[最大公约数](@entry_id:142947)被称为状态 $i$ 的**周期**（period），记为 $d(i)$。如果 $d(i) = 1$，则称状态 $i$ 是**非周期的**（aperiodic）。如果 $d(i) > 1$，则称其为**周期的**（periodic）。在不[可约链](@entry_id:200553)中，所有状态都具有相同的周期。因此，我们可以谈论整个链的周期。

一个典型的周期链例子是一个确定性的循环。考虑一个三状态系统，其转移遵循 $1 \to 2 \to 3 \to 1$ 的循环 ：
$$
P_A = \begin{pmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ 1 & 0 & 0 \end{pmatrix}
$$
从任何状态 $i$ 出发，必须经过 3 的倍数步才能返回自身。例如，从状态 1 出发，返回路径是 $1 \to 2 \to 3 \to 1$ (3步), $1 \to \dots \to 1$ (6步) 等。因此，返回步数的集合是 $\{3, 6, 9, \dots\}$，其最大公约数是 3。这个链的周期为 3。

如果一个不[可约链](@entry_id:200553)中至少有一个状态存在自环，即 $P_{ii} > 0$，那么该[状态的周期](@entry_id:276903)就是 1，从而整个链都是非周期的。例如，在一个循环网络中，如果每个节点都有一定概率 $p \in (0,1)$ 保持在原位，而不是移动到下一个节点，那么这个链就从周期性链变为了非周期性链 。

### 遍历与[正则马尔可夫链](@entry_id:261139)

基于上述分类，我们可以定义两类具有良好长期行为的[马尔可夫链](@entry_id:150828)。

**[遍历马尔可夫链](@entry_id:266539)**（Ergodic Markov Chain）是一个不可约且非周期的[马尔可夫链](@entry_id:150828)。这是[随机过程](@entry_id:159502)理论中最重要的链类型之一，因为它们保证了系统会收敛到一个唯一的稳定状态，而不受初始状态的影响。例如，转移矩阵为
$$
P_C = \begin{pmatrix} 0 & 0.5 & 0.5 \\ 0.5 & 0 & 0.5 \\ 0.5 & 0.5 & 0 \end{pmatrix} \quad \text{和} \quad P_D = \begin{pmatrix} 0.5 & 0.5 & 0 \\ 0 & 0.5 & 0.5 \\ 0.5 & 0 & 0.5 \end{pmatrix}
$$
的链都是遍历的 。$P_C$ 是不可约的，因为任意两点之间都可以一步互达；它也是非周期的，因为存在长度为2的回路（如 $1 \to 2 \to 1$）和长度为3的回路（如 $1 \to 2 \to 3 \to 1$），返回步数的最大公约数为1。$P_D$ 是不可约的（因为存在 $1 \to 2 \to 3 \to 1$ 环路），且由于所有对角元素为正，它也是非周期的。

**[正则马尔可夫链](@entry_id:261139)**（Regular Markov Chain）是一个更强的概念。一个马尔可夫链被称为正则的，如果存在某个正整数 $k$，使得其 $k$ 次幂的转移矩阵 $P^k$ 的所有元素都严格为正 。这意味着，在 $k$ 步之后，从任何状态转移到任何其他状态的概率都大于零。

正则性保证了链既是不可约的也是非周期的，因此所有有限状态的正则链都是遍历链。但反之不尽然。不过，在许多实际应用中，这两个概念可以互换使用。正则性是一个在代数上更容易验证的条件。

### 平稳分布

[遍历马尔可夫链](@entry_id:266539)最引人注目的特性是其存在一个唯一的**[平稳分布](@entry_id:194199)**（stationary distribution）。[平稳分布](@entry_id:194199)是一个概率行向量 $\pi = (\pi_1, \pi_2, \dots, \pi_S)$，其中 $S$ 是状态数，它满足以下方程：
$$
\pi P = \pi
$$
并且其所有分量之和为 1，即 $\sum_{i=1}^{S} \pi_i = 1$。

这个方程的含义是，如果系统在某个时刻的状态[分布](@entry_id:182848)是 $\pi$，那么在经过一步转移之后，系统的状态[分布](@entry_id:182848)仍然是 $\pi$。它代表了系统在动态演化中的一种[统计平衡](@entry_id:186577)状态。

对于任何有限、不可约的[马尔可夫链](@entry_id:150828)，都存在唯一的[平稳分布](@entry_id:194199)，且该[分布](@entry_id:182848)的所有分量 $\pi_i$ 都是正的。

#### [平稳分布](@entry_id:194199)的计算

计算平稳分布 $\pi$ 的过程通常是求解一个线性方程组。方程 $\pi P = \pi$ 可以改写为 $\pi (P - I) = 0$，其中 $I$ 是[单位矩阵](@entry_id:156724)。这是一个[齐次线性方程组](@entry_id:153432)，它有非零解。我们将这个[方程组](@entry_id:193238)与[归一化条件](@entry_id:156486) $\sum \pi_i = 1$ 结合起来，就可以唯一地确定 $\pi$。

让我们通过一个具体的例子来说明。考虑一个服务器负载模型，有低（L）、中（M）、高（H）三个状态，其转移矩阵为 ：
$$
P = \begin{pmatrix}
\frac{1}{2} & \frac{1}{3} & \frac{1}{6} \\
\frac{1}{4} & \frac{1}{2} & \frac{1}{4} \\
\frac{1}{8} & \frac{5}{8} & \frac{1}{4}
\end{pmatrix}
$$
令平稳分布 $\pi = (\pi_L, \pi_M, \pi_H)$。根据 $\pi P = \pi$，我们得到[方程组](@entry_id:193238)：
$$
\begin{aligned}
\pi_L &= \frac{1}{2}\pi_L + \frac{1}{4}\pi_M + \frac{1}{8}\pi_H \\
\pi_M &= \frac{1}{3}\pi_L + \frac{1}{2}\pi_M + \frac{5}{8}\pi_H \\
\pi_H &= \frac{1}{6}\pi_L + \frac{1}{4}\pi_M + \frac{1}{4}\pi_H
\end{aligned}
$$
再加上[归一化条件](@entry_id:156486) $\pi_L + \pi_M + \pi_H = 1$。解这个[方程组](@entry_id:193238)（通常，由于[线性相关](@entry_id:185830)性，我们只需使用其中两个平衡方程和[归一化条件](@entry_id:156486)），可得：
$$
\pi_L = \frac{21}{71}, \quad \pi_M = \frac{34}{71}, \quad \pi_H = \frac{16}{71}
$$
因此，从长远来看，该服务器大约有 $29.6\%$ 的时间处于低负载状态， $47.9\%$ 的时间处于中负载状态， $22.5\%$ 的时间处于高负载状态。同样的计算方法也适用于其他模型，如智能助手的状态模型 。

### 收敛定理与平稳分布的意义

平稳分布之所以如此重要，是因为它描述了[马尔可夫链的长期行为](@entry_id:272323)。这由以下几个关键定理保证。

#### 正则链的收敛定理

对于一个[正则马尔可夫链](@entry_id:261139)，其[转移矩阵](@entry_id:145510)的幂 $P^n$ 会随着 $n \to \infty$ 收敛到一个极限矩阵 $L$。这个极限矩阵 $L$ 的每一行都是相同的，并且都等于该链唯一的平稳分布 $\pi$。
$$
\lim_{n \to \infty} P^n = L = \begin{pmatrix} \pi \\ \pi \\ \vdots \\ \pi \end{pmatrix} = \begin{pmatrix} \pi_1 & \pi_2 & \dots & \pi_S \\ \pi_1 & \pi_2 & \dots & \pi_S \\ \vdots & \vdots & \ddots & \vdots \\ \pi_1 & \pi_2 & \dots & \pi_S \end{pmatrix}
$$
这个强大的结果意味着，无论初始状态[分布](@entry_id:182848) $v_0$ 是什么，经过足够长的时间后，系统的状态[分布](@entry_id:182848) $v_n = v_0 P^n$ 将收敛到[平稳分布](@entry_id:194199) $\pi$：
$$
\lim_{n \to \infty} v_n = v_0 L = (\sum_i v_{0,i}) \pi = \pi
$$
这解释了为什么对于正则链，长期行为与初始状态无关 。例如，在一个[情感分析](@entry_id:637722)模型的性能演化模型中，如果其转移矩阵 $P$ 是正则的，那么无论模型初始性能是“差”、“中”还是“优”，经过大量训练周期后，处于各个性能状态的概率都将趋向于平稳分布 $\pi$ 的相应分量 。

#### 遍历链的[平均收敛](@entry_id:269534)

如果一个链是遍历的（不可约且非周期），它同样会收敛到唯一的[平稳分布](@entry_id:194199)。正则链是遍历链的一个特例。然而，如果一个链是不可约的但具有周期性，情况就有所不同。

考虑一个周期为 2 的不[可约链](@entry_id:200553) 。在这种情况下，状态[分布](@entry_id:182848) $v_n$ 可能不会收敛到一个单一的向量，而是在几个向量之间[振荡](@entry_id:267781)。例如，从状态1出发，系统可能在偶数时刻倾向于[分布](@entry_id:182848)在某个状态[子集](@entry_id:261956)，而在奇数时刻倾向于[分布](@entry_id:182848)在另一个[子集](@entry_id:261956)。

尽管 $v_n$ 本身不收敛，但其**时间平均**（Cesàro mean）确实会收敛。对于任何有限、不可约的马尔可夫链（无论是否为周期性），对于任意初始[分布](@entry_id:182848) $v_0$，时间平均[分布](@entry_id:182848)收敛于唯一的[平稳分布](@entry_id:194199) $\pi$：
$$
\lim_{N \to \infty} \frac{1}{N} \sum_{n=0}^{N-1} v_n = \pi
$$
这一结果更为普适，它保证了即使在[振荡](@entry_id:267781)系统中，平均行为也是稳定和可预测的。

#### 平稳分布的物理解释

[平稳分布](@entry_id:194199) $\pi_i$ 的一个关键解释是：它代表了**系统在长期运行中处于状态 $i$ 的时间比例**。例如，在一个数据传输协议模型中，如果计算出状态“[错误检测](@entry_id:275069)”（$S_2$）的平稳概率为 $\pi_2 = 2/13$，这意味着在长时间运行后，该协议大约有 $2/13 \approx 15.38\%$ 的时间处于[错误检测](@entry_id:275069)状态 。

此外，[平稳分布](@entry_id:194199)的分量的倒数还有另一层含义：对于一个[遍历马尔可夫链](@entry_id:266539)，从状态 $i$ 出发，返回到状态 $i$ 的平均时间（称为**平均返回时间**）等于 $1/\pi_i$。$\pi_i$ 越大，意味着系统越频繁地访问状态 $i$，因此返回所需的时间也越短。

### 应用：遍历源的[熵率](@entry_id:263355)

[马尔可夫链](@entry_id:150828)的概念在信息论中有着直接的应用。一个遍历[马尔可夫过程](@entry_id:160396)可以被看作一个**信息源**，在每个时间步长生成一个来自状态空间的符号。我们自然会问：这个源平均每个时间步长产生多少信息？这个量被称为**[熵率](@entry_id:263355)**（Entropy Rate）。

对于一个具有[转移矩阵](@entry_id:145510) $P$ 和[平稳分布](@entry_id:194199) $\pi$ 的[遍历马尔可夫链](@entry_id:266539)，其[熵率](@entry_id:263355) $H(\mathcal{S})$ 定义为：
$$
H(\mathcal{S}) = \sum_{i \in S} \pi_i H_i = -\sum_{i \in S} \pi_i \sum_{j \in S} p_{ij} \log_2(p_{ij})
$$
其中 $H_i = -\sum_{j \in S} p_{ij} \log_2(p_{ij})$ 是从状态 $i$ 出发进行一次转移所产生的不确定性（或信息），即[转移矩阵](@entry_id:145510) $P$ 第 $i$ 行的熵。

[熵率](@entry_id:263355)的公式直观地表示为各状态转移熵的加权平均，权重是在长期运行中系统处于各状态的概率 $\pi_i$。

考虑一个模拟虚拟宠物心情的模型，其状态为 {愉快(C), 平和(N), 暴躁(G)}，它是一个[遍历马尔可夫链](@entry_id:266539) 。要计算该过程的[熵率](@entry_id:263355)，我们首先需要计算其平稳分布 $\pi$。然后，计算从每个心情状态转移出去的熵 $H_C, H_N, H_G$。最后，[熵率](@entry_id:263355)就是 $H = \pi_C H_C + \pi_N H_N + \pi_G H_G$。这个值量化了宠物心情变化过程的“不可预测性”或“信息含量”，单位是比特/天。对于给定的[转移矩阵](@entry_id:145510)
$$
P = \begin{pmatrix} 0.7 & 0.2 & 0.1 \\ 0.3 & 0.4 & 0.3 \\ 0.1 & 0.6 & 0.3 \end{pmatrix}
$$
可以计算出[平稳分布](@entry_id:194199)为 $\pi = (\frac{3}{7}, \frac{5}{14}, \frac{3}{14})$，最终得到的[熵率](@entry_id:263355)约为 $1.334$ 比特/天。

总之，遍历和[正则马尔可夫链](@entry_id:261139)的理论为分析各种[随机系统的长期行为](@entry_id:186721)提供了强大的数学工具。通过理解[状态分类](@entry_id:276397)、[平稳分布](@entry_id:194199)和收敛定理，我们不仅可以预测系统的最终状态，还可以量化其动态过程中的平均行为和信息内容。