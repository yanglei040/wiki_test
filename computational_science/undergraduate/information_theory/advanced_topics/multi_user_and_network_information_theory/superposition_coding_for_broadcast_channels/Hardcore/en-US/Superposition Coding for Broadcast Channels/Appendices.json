{
    "hands_on_practices": [
        {
            "introduction": "This first practice focuses on the fundamental decoding step in a superposition coding scheme. For the system to be viable, the user with the worse channel condition—the \"weaker\" user—must be able to retrieve their information by treating the signal intended for the stronger user as additional background noise. This exercise challenges you to derive the maximum achievable rate for this weaker user, which forms the cornerstone of the entire broadcast strategy. ",
            "id": "1661770",
            "problem": "Consider a two-user Gaussian Broadcast Channel (GBC) where a single transmitter sends a signal to two separate receivers. The signals received by User 1 and User 2 are given by:\n$$Y_1 = X + Z_1$$\n$$Y_2 = X + Z_2$$\n\nHere, $X$ is the transmitted signal. $Z_1$ and $Z_2$ are independent random variables representing Additive White Gaussian Noise (AWGN), with zero mean and variances $E[Z_1^2] = N_1$ and $E[Z_2^2] = N_2$. The channel is degraded, with User 2 having a noisier channel, which means $N_2 > N_1$.\n\nTo serve both users simultaneously, the transmitter uses superposition coding. The transmitted signal is constructed as $X = X_1 + X_2$, where $X_1$ is the information-bearing signal for User 1 (the stronger user) and $X_2$ is for User 2 (the weaker user). The signals $X_1$ and $X_2$ are generated from independent Gaussian codebooks and are also independent of the noise variables $Z_1$ and $Z_2$.\n\nThe total average power of the transmitted signal is constrained to $P$. A fraction $\\alpha$ of this power is allocated to the signal for User 2, so $E[X_2^2] = \\alpha P$. The remaining power is allocated to the signal for User 1, so $E[X_1^2] = (1-\\alpha)P$, where $0 \\le \\alpha \\le 1$.\n\nIn this scheme, User 2 decodes its own message (from signal $X_2$) by considering the signal intended for User 1 ($X_1$) as part of the total noise.\n\nDetermine the maximum achievable communication rate $R_2$ for User 2 under this strategy. Express your answer as a closed-form analytic expression in terms of $P$, $N_2$, and the power allocation factor $\\alpha$.",
            "solution": "User 2 observes $Y_{2} = X_{1} + X_{2} + Z_{2}$. When User 2 treats $X_{1}$ as noise, define the effective noise as $W \\triangleq X_{1} + Z_{2}$. Because $X_{1}$ and $Z_{2}$ are independent, zero-mean Gaussian with variances $E[X_{1}^{2}] = (1-\\alpha)P$ and $E[Z_{2}^{2}] = N_{2}$, their sum $W$ is Gaussian with variance\n$$\n\\operatorname{Var}(W) = (1-\\alpha)P + N_{2}.\n$$\nThe desired signal for User 2 is $X_{2}$ with $E[X_{2}^{2}] = \\alpha P$, independent of $W$. Hence the effective channel for User 2 is an AWGN channel\n$$\nY_{2} = X_{2} + W,\n$$\nwith signal power $\\alpha P$ and noise variance $(1-\\alpha)P + N_{2}$.\n\nThe achievable rate for Gaussian input over a real AWGN channel equals the mutual information $I(X_{2};Y_{2}) = h(Y_{2}) - h(Y_{2}\\mid X_{2})$. Since $X_{2}$ and $W$ are independent Gaussians, $Y_{2} = X_{2} + W$ is Gaussian with variance\n$$\n\\operatorname{Var}(Y_{2}) = \\alpha P + (1-\\alpha)P + N_{2} = P + N_{2}.\n$$\nTherefore,\n$$\nh(Y_{2}) = \\frac{1}{2}\\ln\\!\\big(2\\pi e\\,(P+N_{2})\\big),\\qquad\nh(Y_{2}\\mid X_{2}) = h(W) = \\frac{1}{2}\\ln\\!\\big(2\\pi e\\,((1-\\alpha)P+N_{2})\\big).\n$$\nSubtracting gives\n$$\nI(X_{2};Y_{2}) = \\frac{1}{2}\\ln\\!\\left(\\frac{P+N_{2}}{(1-\\alpha)P+N_{2}}\\right)\n= \\frac{1}{2}\\ln\\!\\left(1 + \\frac{\\alpha P}{(1-\\alpha)P + N_{2}}\\right).\n$$\nThus, the maximum achievable rate for User 2 under this strategy is\n$$\nR_{2} = \\frac{1}{2}\\ln\\!\\left(1 + \\frac{\\alpha P}{(1-\\alpha)P + N_{2}}\\right).\n$$",
            "answer": "$$\\boxed{\\frac{1}{2}\\ln\\!\\left(1+\\frac{\\alpha P}{(1-\\alpha)P+N_{2}}\\right)}$$"
        },
        {
            "introduction": "Building on the principles of decoding for both strong and weak users, we can now address a practical system design problem. Superposition coding creates a trade-off: allocating more power to one user's signal improves their rate at the expense of the other's. This exercise asks you to find the precise power allocation factor $\\alpha$ that balances this trade-off to achieve rate fairness, a common objective in designing multi-user communication networks. ",
            "id": "1661703",
            "problem": "A cellular base station is communicating with two users, User A and User B, over a broadcast channel. The channel to User A is significantly better than the one to User B. This scenario can be modeled as two parallel Additive White Gaussian Noise (AWGN) channels. The signal received by User A is $Y_A = X + Z_A$ and by User B is $Y_B = X + Z_B$. Here, $X$ is the signal transmitted by the base station, and $Z_A$ and $Z_B$ are independent Gaussian noise processes with zero mean and variances $N_A$ and $N_B$ respectively, where $N_A  N_B$.\n\nThe base station employs superposition coding to send independent messages to the two users. The transmitted signal is formed as $X = U_A + U_B$, where $U_A$ and $U_B$ are the encoded signals for User A and User B, respectively. The signals $U_A$ and $U_B$ are generated from independent, zero-mean Gaussian codebooks. The total transmission power is constrained such that the expected power of $X$ is $P$. A fraction $\\alpha$ of the total power $P$ is allocated to signal $U_B$ (the signal for the weaker user), such that $E[U_B^2] = \\alpha P$, with $0 \\le \\alpha \\le 1$. The remaining power is allocated to $U_A$.\n\nLet $R_A$ and $R_B$ be the maximum achievable data rates for User A and User B, respectively, under this scheme. Find the specific value of the power allocation factor $\\alpha$ that results in equal data rates for both users, i.e., $R_A = R_B$. Express your answer as a single closed-form analytic expression in terms of the total power $P$, and the noise variances $N_A$ and $N_B$.",
            "solution": "The capacity of a real AWGN channel with Gaussian signaling and signal-to-noise ratio $s$ is $C=\\frac{1}{2}\\ln(1+s)$ nats per channel use. With superposition coding for the degraded Gaussian broadcast channel and power split $E[U_B^{2}]=\\alpha P$, $E[U_A^{2}]=(1-\\alpha)P$, User B (the weaker user) decodes $U_B$ while treating $U_A$ as noise, and User A (the stronger user) first decodes $U_B$ and cancels it, then decodes $U_A$.\n\nThus, the achievable rates are\n$$\nR_B=\\frac{1}{2}\\ln\\!\\left(1+\\frac{\\alpha P}{N_B+(1-\\alpha)P}\\right),\\qquad\nR_A=\\frac{1}{2}\\ln\\!\\left(1+\\frac{(1-\\alpha)P}{N_A}\\right).\n$$\nTo equalize the rates, set $R_A=R_B$. Since $\\frac{1}{2}\\ln(\\cdot)$ is strictly increasing, this is equivalent to\n$$\n1+\\frac{(1-\\alpha)P}{N_A}=1+\\frac{\\alpha P}{N_B+(1-\\alpha)P}.\n$$\nCancel the ones and $P0$ to obtain\n$$\n\\frac{1-\\alpha}{N_A}=\\frac{\\alpha}{N_B+(1-\\alpha)P}.\n$$\nCross-multiplying yields\n$$\n(1-\\alpha)\\bigl(N_B+(1-\\alpha)P\\bigr)=\\alpha N_A.\n$$\nExpanding and rearranging gives a quadratic in $\\alpha$:\n$$\nP\\alpha^{2}-(N_A+N_B+2P)\\alpha+(N_B+P)=0.\n$$\nThe physically relevant root in $[0,1]$ is\n$$\n\\alpha=\\frac{N_A+N_B+2P-\\sqrt{(N_A+N_B)^{2}+4PN_A}}{2P}.\n$$\nThis is the unique power split that equalizes $R_A$ and $R_B$.",
            "answer": "$$\\boxed{\\frac{2P+N_{A}+N_{B}-\\sqrt{(N_{A}+N_{B})^{2}+4PN_{A}}}{2P}}$$"
        },
        {
            "introduction": "To test your mastery of the concept, this final practice generalizes the superposition coding framework to a more complex and realistic scenario. Instead of two users, we now have three, each with a different channel quality, and we want to deliver a mix of private, semi-common, and common messages. This problem requires you to apply the logic of successive interference cancellation in multiple stages to find the maximum symmetric rate, demonstrating the scalability and flexibility of this powerful technique. ",
            "id": "1661771",
            "problem": "A satellite communication system is designed to broadcast information to three ground stations, which can be modeled as a three-user degraded Gaussian broadcast channel. The received signal at user $i$ is given by $Y_i = X + Z_i$, where $X$ is the transmitted signal from the satellite, and $Z_i$ is an independent, zero-mean Additive White Gaussian Noise (AWGN) term with variance $N_i$. The channel is degraded, meaning the noise variances are ordered as $N_1  N_2  N_3$, so User 1 has the best channel and User 3 has the worst. The satellite has a total average power constraint of $P$ for the signal $X$.\n\nThe satellite employs superposition coding to transmit three distinct messages simultaneously:\n1.  A private message, $W_p$, intended only for User 1.\n2.  A semi-common message, $W_s$, intended for both User 1 and User 2.\n3.  A common message, $W_c$, intended for all three users.\n\nTo achieve this, the transmitted signal $X$ is the sum of three independent, zero-mean Gaussian codebooks, $X = U_p + U_s + U_c$, with average powers $P_p = E[U_p^2]$, $P_s = E[U_s^2]$, and $P_c = E[U_c^2]$, such that $P_p + P_s + P_c = P$. The receivers use Successive Interference Cancellation (SIC) for decoding. The capacity of an AWGN channel with signal power $S$ and noise power $N$ is given by $\\frac{1}{2}\\ln(1 + S/N)$ in units of a nats per channel use.\n\nThe system is operated to achieve a symmetric rate, where the data rates for all three messages are identical: $R_p = R_s = R_c = R$. The power allocation $(P_p, P_s, P_c)$ is chosen to maximize this symmetric rate $R$. In a particular operational mode designed for robust performance, the total transmit power $P$ is specifically configured to be $P = 4N_1 + 2N_2 + N_3$.\n\nDetermine the maximum achievable symmetric rate $R$ under this specific power configuration. Express your answer as a single analytical expression in nats per channel use.",
            "solution": "The problem asks for the maximum symmetric rate $R$ for a three-user degraded Gaussian broadcast channel with a specific message structure and a special power constraint. We will use the principles of superposition coding and Successive Interference Cancellation (SIC).\n\nFirst, we establish the achievable rate for each message based on the decoding order. The decoding must proceed from the most public message to the most private one.\n\n1.  **Common Message ($W_c$):** This message must be decodable by all users. User 3 is the bottleneck as it has the highest noise variance ($N_3$). User 3 decodes $U_c$ while treating $U_p$ and $U_s$ as additional noise.\n    The signal power for $W_c$ is $P_c$.\n    The total noise power for User 3 is $P_p + P_s + N_3$.\n    The maximum achievable rate for the common message, $R_c$, is thus limited by User 3's capacity:\n    $$R_c \\le \\frac{1}{2}\\ln\\left(1 + \\frac{P_c}{P_p + P_s + N_3}\\right)$$\n\n2.  **Semi-common Message ($W_s$):** This message must be decodable by User 1 and User 2. User 2 is the bottleneck for this message since $N_1  N_2$. To decode $W_s$, User 2 must first successfully decode $W_c$ and subtract the corresponding signal $U_c$ from its received signal (SIC). After SIC, the remaining signal for User 2 is $Y_2' = U_p + U_s + Z_2$. Now, User 2 decodes $U_s$ while treating $U_p$ as noise.\n    The signal power for $W_s$ is $P_s$.\n    The noise power for User 2 after SIC is $P_p + N_2$.\n    The maximum achievable rate for the semi-common message, $R_s$, is limited by User 2's capacity:\n    $$R_s \\le \\frac{1}{2}\\ln\\left(1 + \\frac{P_s}{P_p + N_2}\\right)$$\n    (Note: For User 2 to decode $W_c$ in the first place, its rate must be at least $R_c$. Since $N_2  N_3$, User 2 has a better channel than User 3, so if User 3 can decode $W_c$, User 2 can as well. This condition is not binding.)\n\n3.  **Private Message ($W_p$):** This message is only for User 1. User 1 first decodes $W_c$ and subtracts $U_c$, then decodes $W_s$ and subtracts $U_s$. After two stages of SIC, the remaining signal is $Y_1'' = U_p + Z_1$.\n    The signal power for $W_p$ is $P_p$.\n    The noise power for User 1 is simply $N_1$.\n    The maximum achievable rate for the private message, $R_p$, is:\n    $$R_p \\le \\frac{1}{2}\\ln\\left(1 + \\frac{P_p}{N_1}\\right)$$\n\nTo maximize the symmetric rate $R = R_p = R_s = R_c$, we must satisfy all three inequalities, which means we should turn them into equalities. Let's define a variable $K = \\exp(2R)$. Since $R0$, we have $K1$.\n\nFrom the three rate equations, we get:\n(i) $K = 1 + \\frac{P_p}{N_1} \\implies P_p + N_1 = K N_1$\n(ii) $K = 1 + \\frac{P_s}{P_p + N_2} \\implies P_p + P_s + N_2 = K(P_p + N_2)$\n(iii) $K = 1 + \\frac{P_c}{P_p + P_s + N_3} \\implies P_p + P_s + P_c + N_3 = K(P_p + P_s + N_3)$\n\nWe can now build a recursive relationship to find the total power $P = P_p + P_s + P_c$.\nFrom (i), we have the power plus noise for the first SIC stage: $P_p + N_1 = KN_1$.\n\nFrom (ii), we can express the power plus noise for the second stage in terms of the first:\n$P_p + P_s + N_2 = K(P_p + N_2) = K((P_p+N_1) - N_1 + N_2) = K(KN_1 - N_1 + N_2)$\n$P_p + P_s + N_2 = N_1 K^2 + (N_2 - N_1)K$.\n\nFrom (iii), we can express the total power plus noise for the third stage in terms of the second. Note that $P_p + P_s + P_c = P$.\n$P + N_3 = K(P_p + P_s + N_3) = K((P_p+P_s+N_2) - N_2 + N_3)$\nSubstituting the expression for $P_p + P_s + N_2$:\n$P + N_3 = K( (N_1 K^2 + (N_2 - N_1)K) - N_2 + N_3 ) = N_1 K^3 + (N_2 - N_1)K^2 + (N_3 - N_2)K$.\n\nThis is the central cubic equation for $K = \\exp(2R)$. The problem provides a specific condition for the total power: $P = 4N_1 + 2N_2 + N_3$.\nLet's substitute this into the left side of our equation:\n$P + N_3 = (4N_1 + 2N_2 + N_3) + N_3 = 4N_1 + 2N_2 + 2N_3$.\n\nSo the equation becomes:\n$N_1 K^3 + (N_2 - N_1)K^2 + (N_3 - N_2)K = 4N_1 + 2N_2 + 2N_3$.\n\nLet's test if $K=2$ is a solution to this equation.\nSubstitute $K=2$ into the left hand side (LHS):\nLHS = $N_1 (2)^3 + (N_2 - N_1)(2)^2 + (N_3 - N_2)(2)$\nLHS = $8N_1 + 4(N_2 - N_1) + 2(N_3 - N_2)$\nLHS = $8N_1 + 4N_2 - 4N_1 + 2N_3 - 2N_2$\nLHS = $(8-4)N_1 + (4-2)N_2 + 2N_3$\nLHS = $4N_1 + 2N_2 + 2N_3$.\n\nThis is exactly equal to the right hand side (RHS). Therefore, $K=2$ is a root of the polynomial equation.\nLet $f(K) = N_1 K^3 + (N_2 - N_1)K^2 + (N_3 - N_2)K$.\nThe derivative is $f'(K) = 3N_1 K^2 + 2(N_2 - N_1)K + (N_3 - N_2)$.\nSince $N_1 > 0$, $N_2 - N_1 > 0$, and $N_3 - N_2 > 0$, all coefficients of $f(K)$ for $K>0$ are positive, so $f(K)$ is a strictly increasing function for positive $K$.\nThis implies that the equation $f(K) = P+N_3$ has a unique positive real root.\nSince we found that $K=2$ is a root, it must be this unique positive root.\n\nHaving found the unique valid solution for $K$, we can find the symmetric rate $R$:\n$K = \\exp(2R) \\implies 2 = \\exp(2R)$\n$\\ln(2) = 2R$\n$R = \\frac{1}{2}\\ln(2)$.\n\nThe maximum achievable symmetric rate is $\\frac{1}{2}\\ln(2)$ nats per channel use.",
            "answer": "$$\\boxed{\\frac{1}{2}\\ln(2)}$$"
        }
    ]
}