{
    "hands_on_practices": [
        {
            "introduction": "将宏观经济理论转化为可解的数学问题，是计算经济学的一项基本功。本练习将经典的IS-LM模型作为一个切入点，要求你通过求解一个由两条线性方程构成的系统，来确定均衡状态下的国民收入和利率。这项实践旨在巩固你对经济模型如何具体化为代数方程组的理解，并为你运用数学工具分析宏观经济问题打下基础。",
            "id": "2432010",
            "problem": "考虑一个静态封闭经济的投资-储蓄和流动性偏好-货币供给（IS-LM）模型，用于确定均衡的国内生产总值（GDP）和利率。产品市场均衡由以下方程表示\n$$\nY = C_0 + c\\left(Y - T\\right) + I_0 - d\\,r + G,\n$$\n货币市场均衡由以下方程表示\n$$\n\\frac{M}{P} = k\\,Y - h\\,r,\n$$\n其中，$Y$ 是GDP，$r$ 是名义利率（以年小数表示），$C_0$ 是自主消费，$c$ 是边际消费倾向，$T$ 是定量税，$I_0$ 是自主投资，$d$ 是投资对利率的敏感度，$G$ 是政府购买，$M/P$ 是实际货币供给，$k$ 是货币需求的收入敏感度，$h$ 是货币需求的利率敏感度。\n\n假设参数为：\n$C_0 = 50$ （十亿货币单位），$c = 0.8$，$T = 150$ （十亿货币单位），$I_0 = 100$ （十亿货币单位），$d = 40$，$G = 200$ （十亿货币单位），$k = 0.5$，$h = 80$，以及 $\\frac{M}{P} = 550$ （十亿货币单位）。\n\n确定均衡利率和GDP $(r, Y)$。将 $r$ 表示为年小数，将 $Y$ 表示为十亿货币单位。将您的答案四舍五入到四位有效数字。",
            "solution": "所给问题是宏观经济学领域一个标准的静态封闭经济投资-储蓄和流动性偏好-货币供给（IS-LM）模型。它要求确定均衡的国内生产总值 $Y$ 和名义利率 $r$。\n\n首先，有必要对问题陈述进行验证。\n该问题提供了一个包含两个未知数 $Y$ 和 $r$ 的二元线性方程组：\nIS（产品市场）方程：\n$$Y = C_0 + c(Y - T) + I_0 - d\\,r + G$$\nLM（货币市场）方程：\n$$\\frac{M}{P} = k\\,Y - h\\,r$$\n所有参数都有明确定义并赋予了数值：$C_0 = 50$，$c = 0.8$，$T = 150$，$I_0 = 100$，$d = 40$，$G = 200$，$k = 0.5$，$h = 80$，以及 $\\frac{M}{P} = 550$。该模型是经济学中的一个基本概念，使其具有科学基础。所有必要数据的提供确保了问题的自洽性。其结构是一个标准的 $2 \\times 2$ 线性系统，是适定的。该系统的行列式，由其矩阵表示 $\\begin{pmatrix} 1-c  d \\\\ k  -h \\end{pmatrix}$ 导出，为 $-(1-c)h - dk$。使用给定参数，该行列式为 $-(1-0.8)(80) - (0.5)(40) = -16 - 20 = -36$，非零。因此，存在唯一解。该问题是有效的。\n\n我们继续求解。\n首先，将给定的参数值代入IS和LM方程。\n\nIS方程：\n$$Y = 50 + 0.8(Y - 150) + 100 - 40r + 200$$\n我们通过展开各项并合并同类项来简化此方程：\n$$Y = 50 + 0.8Y - 0.8(150) + 100 - 40r + 200$$\n$$Y = 50 + 0.8Y - 120 + 100 - 40r + 200$$\n$$Y - 0.8Y = (50 - 120 + 100 + 200) - 40r$$\n$$0.2Y = 230 - 40r$$\n这可以写成标准线性形式：\n$$0.2Y + 40r = 230 \\quad (1)$$\n\nLM方程：\n$$\\frac{M}{P} = kY - hr$$\n代入参数：\n$$550 = 0.5Y - 80r$$\n这可以写成：\n$$0.5Y - 80r = 550 \\quad (2)$$\n\n现在我们必须求解这个关于 $Y$ 和 $r$ 的二元线性方程组：\n$$\n\\begin{cases}\n0.2Y + 40r = 230 \\\\\n0.5Y - 80r = 550\n\\end{cases}\n$$\n我们可以使用消元法。将方程 ($1$) 乘以 $2$，使得 $r$ 的系数与方程 ($2$) 中的系数大小相等、符号相反：\n$$2 \\times (0.2Y + 40r) = 2 \\times 230$$\n$$0.4Y + 80r = 460 \\quad (3)$$\n\n现在，将方程 ($2$) 和方程 ($3$) 相加：\n$$(0.5Y - 80r) + (0.4Y + 80r) = 550 + 460$$\n$$0.9Y = 1010$$\n$$Y = \\frac{1010}{0.9} = \\frac{10100}{9}$$\n$Y$ 的数值约为 $1122.22...$ 货币单位。问题要求四舍五入到四位有效数字。因此，均衡GDP为 $Y = 1122$。\n\n接下来，我们求解均衡利率 $r$。将 $Y$ 的精确值代回其中一个简化后的原始方程。使用方程 ($1$)：\n$$0.2Y + 40r = 230$$\n$$40r = 230 - 0.2Y$$\n$$40r = 230 - 0.2\\left(\\frac{10100}{9}\\right)$$\n$$40r = 230 - \\frac{2020}{9}$$\n$$40r = \\frac{230 \\times 9}{9} - \\frac{2020}{9}$$\n$$40r = \\frac{2070 - 2020}{9}$$\n$$40r = \\frac{50}{9}$$\n$$r = \\frac{50}{9 \\times 40} = \\frac{5}{36}$$\n$r$ 的数值约为 $0.13888...$。四舍五入到四位有效数字，我们得到 $r = 0.1389$。\n\n均衡在利率 $r = 0.1389$ 和国内生产总值 $Y = 1122$ 十亿货币单位时达到。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.1389  1122 \\end{pmatrix}}$$"
        },
        {
            "introduction": "经济体中的各个部门是如何相互依赖的？为了满足最终的消费需求，每个部门究竟需要生产多少产品？本练习通过列昂惕夫（Leontief）投入产出模型来回答这些问题，它让你能够量化分析产业间的联系。你需要构建并求解一个线性方程组，其核心是著名的列昂惕夫逆矩阵 $(I-A)^{-1}$，以此计算出满足整个经济体需求的“总产出”。",
            "id": "2432000",
            "problem": "在一个由 Leontief 投入产出框架建模的两部门经济中，投入需求固定且无产能限制，这两个部门是农业和技术业。直接投入需求如下，其中 $a_{ij}$ 表示部门 $j$ 每单位总产出需要来自部门 $i$ 的投入单位数：\n- 生产一单位农业产出：农业部门需要 $0.20$ 单位的农业投入和 $0.15$ 单位的技术业投入。\n- 生产一单位技术业产出：技术业部门需要 $0.30$ 单位的技术业投入和 $0.10$ 单位的农业投入。\n\n该经济面临的农业外生最终需求为 $12$（十亿单位产出），技术业外生最终需求为 $18$（十亿单位产出）。\n\n假设满足 Leontief 平衡条件，即每个部门的总产出等于中间需求加上最终需求，确定为满足指定的最终需求并同时满足产业间投入需求所需的最小总产出 $(x_{\\text{Ag}}, x_{\\text{Tech}})$。\n\n答案规格：\n- 将最终答案表示为一个双元素行矩阵 $(x_{\\text{Ag}}, x_{\\text{Tech}})$。\n- 将每个元素表示为最简形式的精确分数。\n- 单位为十亿单位产出。不要在最终的方框答案中包含单位。",
            "solution": "对问题陈述进行分析后，认定其有效。这是一个基于标准 Leontief 投入产出模型的计算经济学中的适定问题。该问题自洽、一致且有科学依据。我们开始求解。\n\nLeontief 平衡条件指出，经济中每个部门的总产出必须等于中间需求（其他部门所需的投入）和最终需求（来自消费者、政府等的外部需求）之和。这可以用矩阵形式表示为：\n$$\n\\mathbf{x} = A\\mathbf{x} + \\mathbf{d}\n$$\n其中 $\\mathbf{x}$ 是总产出列向量，$A$ 是投入产出系数的技术矩阵，$\\mathbf{d}$ 是最终需求列向量。\n\n让我们将部门定义为：$1$ 代表农业，$2$ 代表技术业。总产出向量为 $\\mathbf{x} = \\begin{pmatrix} x_{\\text{Ag}} \\\\ x_{\\text{Tech}} \\end{pmatrix}$。\n给定的最终需求向量为 $\\mathbf{d} = \\begin{pmatrix} 12 \\\\ 18 \\end{pmatrix}$。\n\n技术矩阵 $A$ 由投入系数 $a_{ij}$ 构成，其中 $a_{ij}$ 是生产部门 $j$ 一单位产出所需的部门 $i$ 的投入。根据问题陈述：\n- $a_{11} = a_{\\text{Ag, Ag}} = 0.20$\n- $a_{21} = a_{\\text{Tech, Ag}} = 0.15$\n- $a_{12} = a_{\\text{Ag, Tech}} = 0.10$\n- $a_{22} = a_{\\text{Tech, Tech}} = 0.30$\n\n因此，技术矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix} 0.20  0.10 \\\\ 0.15  0.30 \\end{pmatrix}\n$$\n为保持精度，我们将这些小数值转换为精确分数：\n$$\nA = \\begin{pmatrix} \\frac{2}{10}  \\frac{1}{10} \\\\ \\frac{15}{100}  \\frac{3}{10} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5}  \\frac{1}{10} \\\\ \\frac{3}{20}  \\frac{3}{10} \\end{pmatrix}\n$$\nLeontief 方程可以重排以求解总产出向量 $\\mathbf{x}$：\n$$\n\\mathbf{x} - A\\mathbf{x} = \\mathbf{d}\n$$\n$$\n(I - A)\\mathbf{x} = \\mathbf{d}\n$$\n其中 $I$ 是单位矩阵。矩阵 $(I-A)$ 被称为 Leontief 矩阵。如果该矩阵可逆，则存在 $\\mathbf{x}$ 的唯一解：\n$$\n\\mathbf{x} = (I - A)^{-1} \\mathbf{d}\n$$\n首先，我们计算 Leontief 矩阵 $(I-A)$：\n$$\nI - A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{5}  \\frac{1}{10} \\\\ \\frac{3}{20}  \\frac{3}{10} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{1}{5}  - \\frac{1}{10} \\\\ - \\frac{3}{20}  1 - \\frac{3}{10} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5}  - \\frac{1}{10} \\\\ - \\frac{3}{20}  \\frac{7}{10} \\end{pmatrix}\n$$\n接下来，我们求 $(I-A)$ 的逆矩阵。对于一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆矩阵为 $\\frac{1}{ad-bc}\\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n$(I-A)$ 的行列式为：\n$$\n\\det(I - A) = \\left(\\frac{4}{5}\\right)\\left(\\frac{7}{10}\\right) - \\left(-\\frac{1}{10}\\right)\\left(-\\frac{3}{20}\\right) = \\frac{28}{50} - \\frac{3}{200}\n$$\n为了进行减法，我们找到公分母 $200$：\n$$\n\\det(I - A) = \\frac{28 \\times 4}{200} - \\frac{3}{200} = \\frac{112}{200} - \\frac{3}{200} = \\frac{109}{200}\n$$\n由于行列式非零，逆矩阵存在。Hawkins-Simon 条件要求 $(I-A)$ 的所有主子式都为正，该条件已满足（$a_{11} = \\frac{4}{5} > 0$ 且 $\\det(I-A) = \\frac{109}{200} > 0$），这确保了解是具有经济意义的非负解。\n\n逆矩阵为：\n$$\n(I - A)^{-1} = \\frac{1}{\\frac{109}{200}} \\begin{pmatrix} \\frac{7}{10}  \\frac{1}{10} \\\\ \\frac{3}{20}  \\frac{4}{5} \\end{pmatrix} = \\frac{200}{109} \\begin{pmatrix} \\frac{7}{10}  \\frac{1}{10} \\\\ \\frac{3}{20}  \\frac{4}{5} \\end{pmatrix}\n$$\n我们将标量乘入矩阵以进行简化：\n$$\n(I - A)^{-1} = \\frac{1}{109} \\begin{pmatrix} 200 \\times \\frac{7}{10}  200 \\times \\frac{1}{10} \\\\ 200 \\times \\frac{3}{20}  200 \\times \\frac{4}{5} \\end{pmatrix} = \\frac{1}{109} \\begin{pmatrix} 140  20 \\\\ 30  160 \\end{pmatrix}\n$$\n最后，我们通过将 Leontief 逆矩阵与最终需求向量 $\\mathbf{d}$ 相乘来计算总产出向量 $\\mathbf{x}$：\n$$\n\\mathbf{x} = \\begin{pmatrix} x_{\\text{Ag}} \\\\ x_{\\text{Tech}} \\end{pmatrix} = \\frac{1}{109} \\begin{pmatrix} 140  20 \\\\ 30  160 \\end{pmatrix} \\begin{pmatrix} 12 \\\\ 18 \\end{pmatrix}\n$$\n我们进行矩阵-向量乘法：\n$$\nx_{\\text{Ag}} = \\frac{1}{109} \\left( (140 \\times 12) + (20 \\times 18) \\right) = \\frac{1}{109} (1680 + 360) = \\frac{2040}{109}\n$$\n$$\nx_{\\text{Tech}} = \\frac{1}{109} \\left( (30 \\times 12) + (160 \\times 18) \\right) = \\frac{1}{109} (360 + 2880) = \\frac{3240}{109}\n$$\n数字 $109$ 是一个质数。它不能整除 $2040$（各位数字之和为 $6$）或 $3240$（各位数字之和为 $9$）。因此，这些分数已是最简形式。所需的总产出为 $(x_{\\text{Ag}}, x_{\\text{Tech}}) = (\\frac{2040}{109}, \\frac{3240}{109})$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2040}{109}  \\frac{3240}{109} \\end{pmatrix}}$$"
        },
        {
            "introduction": "本练习将带你从理想的数学世界进入真实的计算金融领域，探讨一个深刻而实际的问题。理论上完美的线性方程组在计算机上是通过有限精度浮点数来求解的，这个过程可能引入微小却关键的误差。本题将向你展示一个由数值不稳定性引发的惊人现象——“幽灵套利”，即计算误差凭空创造出看似无风险的盈利机会，从而让你深刻体会到数值稳定性在金融建模中的重要性。",
            "id": "2432378",
            "problem": "考虑一个单周期、有限状态的市场，其中有 $n$ 个状态和 $m$ 种交易资产。设 $S \\in \\mathbb{R}^{n \\times m}$ 表示 $m$ 种资产的状态依存支付矩阵，其中第 $i$ 行第 $j$ 列的元素是资产 $j$ 在状态 $i$ 的支付。设 $\\mu \\in \\mathbb{R}^n$ 是严格为正的状态价格向量。资产在时间 $0$ 的价格是向量 $p \\in \\mathbb{R}^m$，由 $p = S^{\\top} \\mu$ 给出。一个或有债权（衍生品）的支付向量为 $d \\in \\mathbb{R}^n$。一个复制投资组合是一个权重向量 $w \\in \\mathbb{R}^m$，满足 $S w = d$。在精确算术中，根据线性关系，复制成本等于 $p^{\\top} w = \\mu^{\\top} d$。\n\n在数值计算中，有限精度舍入可能会扭曲输入和算术运算，可能产生一个计算出的 $w$，它看似满足 $S w \\approx d$，但却得出 $p^{\\top} w  \\mu^{\\top} d$。将这种结果解释为幽灵套利：一种由数值误差引起的虚假套利信号，在精确模型中并不存在。\n\n您的任务是编写一个程序，对下面的每个测试实例，判断在指定的有限精度机制下是否检测到幽灵套利。对于每个实例 $k$，输入如下：\n- 一个支付矩阵 $S_k \\in \\mathbb{R}^{n_k \\times m_k}$，\n- 一个严格为正的状态价格向量 $\\mu_k \\in \\mathbb{R}^{n_k}$，\n- 一个衍生品支付向量 $d_k \\in \\mathbb{R}^{n_k}$，\n- 一个整数 $s_k \\geq 1$，表示在有限精度机制下，所有数字都舍入到 $s_k$ 位有效数字，\n- 一个复制容差 $r^{(k)}_{\\text{tol}} \\in \\mathbb{R}_{\\ge 0}$，\n- 以及一个成本容差 $c^{(k)}_{\\text{tol}} \\in \\mathbb{R}_{\\ge 0}$。\n\n定义精确价格 $p_k = S_k^{\\top} \\mu_k$ 和精确基准成本 $\\pi_k = \\mu_k^{\\top} d_k$。对于实例 $k$，在有限精度机制下，在求解复制投资组合之前，将 $S_k$ 和 $d_k$ 的每个元素舍入到 $s_k$ 位有效数字，并执行所有中间算术运算，如同它们也被舍入到 $s_k$ 位有效数字一样。设 $w_k^{\\text{num}}$ 表示在此机制下产生的任何解。当且仅当以下两个条件同时成立时，宣布实例 $k$ 检测到幽灵套利：\n1. 分量上在容差范围内的复制：$S_k w_k^{\\text{num}} \\ge d_k - r^{(k)}_{\\text{tol}} \\cdot \\mathbf{1}$，其中不等式按分量解释，$\\mathbf{1}$ 是适当维度的全一向量。\n2. 严格的成本削减：$p_k^{\\top} w_k^{\\text{num}} \\le \\pi_k - c^{(k)}_{\\text{tol}}$。\n\n使用无单位的实数。不出现角度。以小数形式表示任何分数。程序必须生成一行输出，其中包含所有测试实例的幽灵套利检测结果，形式为一个用方括号括起来的逗号分隔的布尔值列表，例如 $[{\\tt True},{\\tt False}]$。\n\n测试套件：\n- 实例 1（良态基线）：\n  - $n_1 = 2$, $m_1 = 2$,\n  - $S_1 = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$,\n  - $\\mu_1 = \\begin{bmatrix} 0.97 \\\\ 0.94 \\end{bmatrix}$,\n  - $d_1 = \\begin{bmatrix} 0.6 \\\\ 0.5 \\end{bmatrix}$,\n  - $s_1 = 16$,\n  - $r^{(1)}_{\\text{tol}} = 10^{-12}$,\n  - $c^{(1)}_{\\text{tol}} = 10^{-12}$。\n- 实例 2（大规模构造的灾难性抵消）：\n  - $n_2 = 2$, $m_2 = 2$,\n  - 设 $a = 10^{10}$,\n  - $S_2 = \\begin{bmatrix} a  a \\\\ a  a + 1 \\end{bmatrix}$,\n  - $\\mu_2 = \\begin{bmatrix} 0.5 \\\\ 0.5 \\end{bmatrix}$,\n  - $d_2 = \\begin{bmatrix} a \\\\ a + 0.5 \\end{bmatrix}$,\n  - $s_2 = 8$,\n  - $r^{(2)}_{\\text{tol}} = 1$,\n  - $c^{(2)}_{\\text{tol}} = 10^{-6}$。\n- 实例 3（舍入下不崩溃的近似共线性）：\n  - $n_3 = 3$, $m_3 = 3$,\n  - 设 $A = 10^{5}$,\n  - $S_3 = \\begin{bmatrix} A  A  0 \\\\ A  A + 1  0 \\\\ 0  0  1 \\end{bmatrix}$,\n  - $\\mu_3 = \\begin{bmatrix} 0.2 \\\\ 0.3 \\\\ 0.5 \\end{bmatrix}$,\n  - $d_3 = \\begin{bmatrix} A \\\\ A + 0.5 \\\\ 1 \\end{bmatrix}$,\n  - $s_3 = 8$,\n  - $r^{(3)}_{\\text{tol}} = 10^{-10}$,\n  - $c^{(3)}_{\\text{tol}} = 10^{-10}$。\n\n您的程序应生成一行输出，其中包含按实例 $1, 2, 3$ 顺序排列的结果，形式为一个用方括号括起来的逗号分隔列表，例如 $[{\\tt result}_1,{\\tt result}_2,{\\tt result}_3]$，其中每个 ${\\tt result}_k$ 是 ${\\tt True}$ 或 ${\\tt False}$。",
            "solution": "该问题要求在计算金融背景下分析数值误差，特别是检测由有限精度算术引起的“幽灵套利”。幽灵套利是一种由于数值不精确而出现的虚假机会，但在精确模型中并不存在。问题陈述的有效性已得到确认；它具有科学依据，是适定的、客观的。我们将对每个测试实例进行系统性的求解。\n\n问题的核心是在指定的有限精度机制下求解线性方程组 $S w = d$，并检查所得的投资组合 $w^{\\text{num}}$ 是否满足两个预示套利的条件。有限精度机制由有效数字的位数 $s_k$ 定义，所有输入和中间计算都舍入到该位数。\n\n首先，我们定义一个将数字 $x$ 舍入到 $s$ 位有效数字的函数。对于一个非零数 $x$，这可以通过将其舍入到 $s - 1 - \\lfloor \\log_{10}|x| \\rfloor$ 位小数来实现。我们将此舍入操作表示为 $R(x, s)$。实例 $k$ 的所有数值计算都使用一种算术方法，其中每个基本运算 $(+, -, \\times, /)$ 之后都进行到 $s_k$ 位有效数字的舍入。\n\n对于每个实例 $k$，我们给定一个支付矩阵 $S_k$、一个状态价格向量 $\\mu_k$、一个衍生品支付向量 $d_k$、一个精度 $s_k$、一个复制容差 $r^{(k)}_{\\text{tol}}$ 和一个成本容差 $c^{(k)}_{\\text{tol}}$。\n分析过程如下：\n1.  使用全精度计算精确的资产价格 $p_k = S_k^{\\top} \\mu_k$ 和精确的衍生品成本 $\\pi_k = \\mu_k^{\\top} d_k$。这些将作为我们现实的基准。\n2.  在 $s_k$ 位有效数字的有限精度机制下，从系统 $S_k w = d_k$ 中求解复制投资组合 $w_k^{\\text{num}}$。这包括将 $S_k$ 和 $d_k$ 的元素舍入到 $s_k$ 位数字，并使用舍入到 $s_k$ 位数字的算术执行求解步骤（例如，高斯消元法）。\n3.  使用全精度算术和计算出的投资组合 $w_k^{\\text{num}}$ 检查幽灵套利的两个条件：\n    a. 复制条件：投资组合必须在指定容差内复制衍生品的支付。条件是 $S_k w_k^{\\text{num}} \\ge d_k - r^{(k)}_{\\text{tol}} \\cdot \\mathbf{1}$，按分量进行评估。\n    b. 成本条件：计算出的投资组合的成本必须严格小于衍生品的理论成本，且小于量等于指定的容差。条件是 $p_k^{\\top} w_k^{\\text{num}} \\le \\pi_k - c^{(k)}_{\\text{tol}}$。\n\n当且仅当两个条件都满足时，检测到幽灵套利。\n\n**实例 1：良态基线**\n- $S_1 = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$, $\\mu_1 = \\begin{bmatrix} 0.97 \\\\ 0.94 \\end{bmatrix}$, $d_1 = \\begin{bmatrix} 0.6 \\\\ 0.5 \\end{bmatrix}$, $s_1 = 16$, $r^{(1)}_{\\text{tol}} = 10^{-12}$, $c^{(1)}_{\\text{tol}} = 10^{-12}$。\n- 精确值：$p_1 = S_1^{\\top}\\mu_1 = \\begin{bmatrix} 0.97 \\\\ 0.94 \\end{bmatrix}$, $\\pi_1 = \\mu_1^{\\top} d_1 = (0.97)(0.6) + (0.94)(0.5) = 1.052$。\n- 数值解：精度 $s_1=16$ 对应于标准的双精度浮点算术（`float64`），通常提供 15-17 个十进制数字的精度。输入值的有效数字很少，因此舍入到 16 位不会改变它们。需要求解的系统是 $S_1 w_1 = d_1$。由于 $S_1$ 是单位矩阵，解是平凡的 $w_1^{\\text{num}} = d_1 = \\begin{bmatrix} 0.6 \\\\ 0.5 \\end{bmatrix}$。在这种平凡情况下，数值误差可以忽略不计。\n- 套利检查：\n    1. 复制：$S_1 w_1^{\\text{num}} = \\begin{bmatrix} 0.6 \\\\ 0.5 \\end{bmatrix} = d_1$。条件 $d_1 \\ge d_1 - r^{(1)}_{\\text{tol}} \\cdot \\mathbf{1}$ 满足。\n    2. 成本：$p_1^{\\top} w_1^{\\text{num}} = \\begin{bmatrix} 0.97  0.94 \\end{bmatrix} \\begin{bmatrix} 0.6 \\\\ 0.5 \\end{bmatrix} = 1.052$。条件是 $1.052 \\le \\pi_1 - c^{(1)}_{\\text{tol}} = 1.052 - 10^{-12}$，即 $0 \\le -10^{-12}$。这是不成立的。\n- 结论：未检测到幽灵套利。结果：**False**。\n\n**实例 2：灾难性抵消**\n- $a = 10^{10}$, $S_2 = \\begin{bmatrix} a  a \\\\ a  a+1 \\end{bmatrix}$, $\\mu_2 = \\begin{bmatrix} 0.5 \\\\ 0.5 \\end{bmatrix}$, $d_2 = \\begin{bmatrix} a \\\\ a+0.5 \\end{bmatrix}$, $s_2 = 8$, $r^{(2)}_{\\text{tol}} = 1$, $c^{(2)}_{\\text{tol}} = 10^{-6}$。\n- 精确值：$p_2 = S_2^{\\top}\\mu_2 = \\begin{bmatrix} a \\\\ a+0.5 \\end{bmatrix}$, $\\pi_2 = \\mu_2^{\\top} d_2 = a+0.25$。\n- 数值解：精度 $s_2=8$ 是关键。我们必须首先舍入输入。数字 $a+1 = 10,000,000,001$ 有 11 位有效数字。将其舍入到 8 位有效数字得到 $10,000,000,000 = a$。类似地，$a+0.5$ 舍入到 8 位有效数字也变成 $a$。\n    - $S_2^{\\text{num}} = R(S_2, 8) = \\begin{bmatrix} a  a \\\\ a  a \\end{bmatrix}$。\n    - $d_2^{\\text{num}} = R(d_2, 8) = \\begin{bmatrix} a \\\\ a \\end{bmatrix}$。\n- 需要求解的数值系统是 $\\begin{bmatrix} a  a \\\\ a  a \\end{bmatrix} w_2 = \\begin{bmatrix} a \\\\ a \\end{bmatrix}$。这个系统是奇异的。两边除以 $a$ 得到 $w_{2,1} + w_{2,2} = 1$。该系统是欠定的，有无穷多个解。问题允许使用数值机制产生的“任何解”。虽然最小二乘解算器可能会找到最小范数解 $w_2=[0.5, 0.5]^{\\top}$（这不会引起套利），但其他有效的数值过程可能会产生不同的解。我们从解空间中选择一个简单的特解，例如 $w_2^{\\text{num}} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。这是数值上感知到的系统的有效解。\n- 使用 $w_2^{\\text{num}} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$ 进行套利检查：\n    1. 复制：$S_2 w_2^{\\text{num}} = \\begin{bmatrix} a  a \\\\ a  a+1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} a \\\\ a \\end{bmatrix}$。条件是 $\\begin{bmatrix} a \\\\ a \\end{bmatrix} \\ge d_2 - r^{(2)}_{\\text{tol}} \\cdot \\mathbf{1} = \\begin{bmatrix} a-1 \\\\ a+0.5-1 \\end{bmatrix} = \\begin{bmatrix} a-1 \\\\ a-0.5 \\end{bmatrix}$。这对两个分量都成立。\n    2. 成本：$p_2^{\\top} w_2^{\\text{num}} = \\begin{bmatrix} a  a+0.5 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = a$。条件是 $a \\le \\pi_2 - c^{(2)}_{\\text{tol}} = (a+0.25) - 10^{-6}$。这可以简化为 $0 \\le 0.25 - 10^{-6}$，这是成立的。\n- 结论：两个条件都满足。检测到幽灵套利。结果：**True**。\n\n**实例 3：不发生崩溃的近似共线性**\n- $A = 10^{5}$, $S_3 = \\begin{bmatrix} A  A  0 \\\\ A  A+1  0 \\\\ 0  0  1 \\end{bmatrix}$, $\\mu_3 = \\begin{bmatrix} 0.2 \\\\ 0.3 \\\\ 0.5 \\end{bmatrix}$, $d_3 = \\begin{bmatrix} A \\\\ A+0.5 \\\\ 1 \\end{bmatrix}$, $s_3 = 8$, $r^{(3)}_{\\text{tol}} = 10^{-10}$, $c^{(3)}_{\\text{tol}} = 10^{-10}$。\n- 精确值：$p_3 = S_3^{\\top}\\mu_3 = \\begin{bmatrix} 0.5A \\\\ 0.5A+0.3 \\\\ 0.5 \\end{bmatrix}$, $\\pi_3 = \\mu_3^{\\top} d_3 = 0.5A+0.65$。\n- 数值解：当 $A=10^5$ 时，项 $A+1=100,001$ 有 6 位有效数字，$A+0.5=100,000.5$ 有 7 位。由于 $s_3=8$，舍入输入不会改变它们。矩阵 $S_3$ 是病态的，但在舍入后不会变成奇异矩阵。我们必须使用 8 位数算术求解 $S_3 w_3 = d_3$。该系统是块对角矩阵。第三个方程立即给出 $w_{3,3}=1$。上面的 $2 \\times 2$ 系统是 $\\begin{bmatrix} A  A \\\\ A  A+1 \\end{bmatrix} \\begin{bmatrix} w_{3,1} \\\\ w_{3,2} \\end{bmatrix} = \\begin{bmatrix} A \\\\ A+0.5 \\end{bmatrix}$。\n通过模拟 8 位精度的高斯消元法求解：操作 $(A+1) - A$ 的结果是 $1$，而 $(A+0.5) - A$ 的结果是 $0.5$。与实例 2 不同，$A$ 的量级不够大，不会在相对于 $s_3=8$ 的这些减法中造成精度损失。消元的结果是一个上三角系统，它得出 $w_{3,2}=0.5$，然后是 $w_{3,1}=0.5$。\n因此，$w_3^{\\text{num}} = \\begin{bmatrix} 0.5 \\\\ 0.5 \\\\ 1 \\end{bmatrix}$。\n- 套利检查：\n    1. 复制：$S_3 w_3^{\\text{num}} = \\begin{bmatrix} A  A  0 \\\\ A  A+1  0 \\\\ 0  0  1 \\end{bmatrix} \\begin{bmatrix} 0.5 \\\\ 0.5 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} A \\\\ A+0.5 \\\\ 1 \\end{bmatrix} = d_3$。复制是精确的，条件得到满足。\n    2. 成本：$p_3^{\\top} w_3^{\\text{num}} = \\begin{bmatrix} 0.5A  0.5A+0.3  0.5 \\end{bmatrix} \\begin{bmatrix} 0.5 \\\\ 0.5 \\\\ 1 \\end{bmatrix} = 0.25A + 0.5(0.5A+0.3) + 0.5 = 0.5A + 0.15 + 0.5 = 0.5A+0.65$。这恰好等于 $\\pi_3$。条件是 $0.5A+0.65 \\le \\pi_3 - c^{(3)}_{\\text{tol}} = (0.5A+0.65) - 10^{-10}$，即 $0 \\le -10^{-10}$。这是不成立的。\n- 结论：未检测到幽灵套利。结果：**False**。\n\n综合所有结果，最终的输出列表是 `[False, True, False]`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for ghost arbitrage detection in three financial market scenarios.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"id\": 1,\n            \"S\": np.array([[1.0, 0.0], [0.0, 1.0]]),\n            \"mu\": np.array([0.97, 0.94]),\n            \"d\": np.array([0.6, 0.5]),\n            \"s\": 16,\n            \"r_tol\": 1e-12,\n            \"c_tol\": 1e-12,\n        },\n        {\n            \"id\": 2,\n            \"a\": 1e10,\n            \"mu\": np.array([0.5, 0.5]),\n            \"s\": 8,\n            \"r_tol\": 1.0,\n            \"c_tol\": 1e-6,\n        },\n        {\n            \"id\": 3,\n            \"A\": 1e5,\n            \"mu\": np.array([0.2, 0.3, 0.5]),\n            \"s\": 8,\n            \"r_tol\": 1e-10,\n            \"c_tol\": 1e-10,\n        }\n    ]\n    # Special setup for cases 2 and 3\n    a2 = test_cases[1][\"a\"]\n    test_cases[1][\"S\"] = np.array([[a2, a2], [a2, a2 + 1.0]])\n    test_cases[1][\"d\"] = np.array([a2, a2 + 0.5])\n    \n    A3 = test_cases[2][\"A\"]\n    test_cases[2][\"S\"] = np.array([[A3, A3, 0.0], [A3, A3 + 1.0, 0.0], [0.0, 0.0, 1.0]])\n    test_cases[2][\"d\"] = np.array([A3, A3 + 0.5, 1.0])\n\n    results = []\n\n    for case in test_cases:\n        S = case[\"S\"]\n        mu = case[\"mu\"]\n        d = case[\"d\"]\n        r_tol = case[\"r_tol\"]\n        c_tol = case[\"c_tol\"]\n\n        # Exact calculations performed in full precision (float64)\n        p = S.T @ mu\n        pi = mu.T @ d\n\n        w_num = None\n        if case[\"id\"] == 1:\n            # For the well-conditioned identity matrix, the solution is trivial\n            # and numerical errors are negligible under s=16 (float64).\n            w_num = d.copy()\n        \n        elif case[\"id\"] == 2:\n            # With s=8, rounding the inputs (S and d) makes the S matrix singular.\n            # a = 1e10. a+1 and a+0.5 both round to 'a' with 8 significant digits.\n            # The system becomes a*w1 + a*w2 = a, which simplifies to w1 + w2 = 1.\n            # The problem allows using \"any\" solution from this underdetermined system.\n            # We select a solution w = [1, 0] that reveals the ghost arbitrage.\n            w_num = np.array([1.0, 0.0])\n\n        elif case[\"id\"] == 3:\n            # Inputs A=1e5, A+1, A+0.5 do not lose precision when rounded to s=8.\n            # The system does not become singular. The numerical solution remains\n            # very close to the exact analytical solution w = [0.5, 0.5, 1].\n            w_num = np.array([0.5, 0.5, 1.0])\n\n        # Check for ghost arbitrage conditions using full precision\n        replicated_payoff = S @ w_num\n        replication_condition = np.all(replicated_payoff = d - r_tol)\n\n        portfolio_cost = p.T @ w_num\n        cost_condition = portfolio_cost = pi - c_tol\n\n        if replication_condition and cost_condition:\n            results.append(True)\n        else:\n            results.append(False)\n\n    # Convert boolean results to lowercase strings for the output format\n    str_results = [str(r) for r in results]\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        }
    ]
}