{
    "hands_on_practices": [
        {
            "introduction": "To master the concepts of risk and return, it is essential to apply them to diverse financial instruments beyond simple stocks. This exercise challenges you to calculate the risk-return profile, specifically the Sharpe ratio, for a hypothetical derivative security whose payoff is linked to the realized variance of an asset. This practice is valuable because it requires you to construct the probability distribution of the investment's returns from first principles, reinforcing the fundamental definitions of expected value and variance in a non-trivial context .",
            "id": "2374893",
            "problem": "An investor considers a European-style derivative written on the realized variance of the continuously compounded returns of an underlying asset over two consecutive trading days. The continuously compounded return on day $1$ is $r_{1}$, and on day $2$ is $r_{2}$. The realized variance over the two-day horizon is defined as\n$$\n\\sigma_{\\text{realized}}^{2} \\equiv \\frac{r_{1}^{2} + r_{2}^{2}}{2}.\n$$\nThe derivative pays at the end of day $2$ the amount\n$$\n\\max\\{0, \\ \\sigma_{\\text{realized}}^{2} - K\\},\n$$\nwith strike $K = 0.0005$. The derivative’s initial cost at time $0$ is $C_{0} = 0.00004$.\n\nAssume the following physical (objective) probabilities for the daily continuously compounded returns, independent across the two days:\n- On day $1$, $r_{1} = 0.02$ with probability $0.6$, and $r_{1} = -0.03$ with probability $0.4$.\n- On day $2$, $r_{2} = 0.015$ with probability $0.7$, and $r_{2} = -0.025$ with probability $0.3$.\n\nThe investor evaluates the position using the simple net holding-period return over the two-day horizon,\n$$\nR \\equiv \\frac{\\text{Payoff} - C_{0}}{C_{0}},\n$$\nand the risk-free simple net return over the same horizon is $r_{f} = 0.001$.\n\nCompute the Sharpe ratio of the derivative’s two-day holding-period return relative to the risk-free simple return, defined as\n$$\n\\frac{\\mathbb{E}[R] - r_{f}}{\\sqrt{\\operatorname{Var}(R)}},\n$$\nunder the given physical probabilities. Provide a single numerical value rounded to four significant figures.",
            "solution": "The problem statement has been validated and is deemed a well-posed, scientifically grounded problem in quantitative finance. We shall proceed with the solution.\n\nThe problem requires the calculation of the Sharpe ratio for a derivative position. The Sharpe ratio is defined as:\n$$\n\\text{Sharpe Ratio} = \\frac{\\mathbb{E}[R] - r_{f}}{\\sqrt{\\operatorname{Var}(R)}}\n$$\nwhere $R$ is the simple net holding-period return of the derivative, and $r_f$ is the risk-free simple net return. To compute this, we must first determine the probability distribution of $R$. The return $R$ depends on the derivative's payoff, which in turn depends on the realized variance $\\sigma_{\\text{realized}}^{2}$.\n\nThe continuously compounded returns on day $1$, $r_1$, and day $2$, $r_2$, are independent random variables. There are four possible states of the world for the pair $(r_1, r_2)$. We will analyze each state.\n\nLet the possible values for $r_1$ be $r_{1,u} = 0.02$ and $r_{1,d} = -0.03$, with probabilities $P(r_{1,u}) = 0.6$ and $P(r_{1,d}) = 0.4$.\nLet the possible values for $r_2$ be $r_{2,u} = 0.015$ and $r_{2,d} = -0.025$, with probabilities $P(r_{2,u}) = 0.7$ and $P(r_{2,d}) = 0.3$.\n\nThe four possible states and their joint probabilities (due to independence) are:\n1.  State 1: $(r_1, r_2) = (0.02, 0.015)$. Probability $P_1 = 0.6 \\times 0.7 = 0.42$.\n2.  State 2: $(r_1, r_2) = (0.02, -0.025)$. Probability $P_2 = 0.6 \\times 0.3 = 0.18$.\n3.  State 3: $(r_1, r_2) = (-0.03, 0.015)$. Probability $P_3 = 0.4 \\times 0.7 = 0.28$.\n4.  State 4: $(r_1, r_2) = (-0.03, -0.025)$. Probability $P_4 = 0.4 \\times 0.3 = 0.12$.\n\nFor each state, we compute the realized variance $\\sigma_{\\text{realized}}^{2} = \\frac{r_{1}^{2} + r_{2}^{2}}{2}$.\n1.  State 1: $\\sigma_{1, \\text{realized}}^{2} = \\frac{(0.02)^{2} + (0.015)^{2}}{2} = \\frac{0.0004 + 0.000225}{2} = 0.0003125$.\n2.  State 2: $\\sigma_{2, \\text{realized}}^{2} = \\frac{(0.02)^{2} + (-0.025)^{2}}{2} = \\frac{0.0004 + 0.000625}{2} = 0.0005125$.\n3.  State 3: $\\sigma_{3, \\text{realized}}^{2} = \\frac{(-0.03)^{2} + (0.015)^{2}}{2} = \\frac{0.0009 + 0.000225}{2} = 0.0005625$.\n4.  State 4: $\\sigma_{4, \\text{realized}}^{2} = \\frac{(-0.03)^{2} + (-0.025)^{2}}{2} = \\frac{0.0009 + 0.000625}{2} = 0.0007625$.\n\nNext, we calculate the derivative's payoff, $\\text{Payoff} = \\max\\{0, \\sigma_{\\text{realized}}^{2} - K\\}$, with strike $K = 0.0005$.\n1.  State 1: $\\text{Payoff}_1 = \\max\\{0, 0.0003125 - 0.0005\\} = 0$.\n2.  State 2: $\\text{Payoff}_2 = \\max\\{0, 0.0005125 - 0.0005\\} = 0.0000125$.\n3.  State 3: $\\text{Payoff}_3 = \\max\\{0, 0.0005625 - 0.0005\\} = 0.0000625$.\n4.  State 4: $\\text{Payoff}_4 = \\max\\{0, 0.0007625 - 0.0005\\} = 0.0002625$.\n\nNow, we compute the simple net holding-period return $R = \\frac{\\text{Payoff} - C_{0}}{C_{0}}$, with initial cost $C_0 = 0.00004$.\n1.  State 1: $R_1 = \\frac{0 - 0.00004}{0.00004} = -1$.\n2.  State 2: $R_2 = \\frac{0.0000125 - 0.00004}{0.00004} = 0.3125 - 1 = -0.6875$.\n3.  State 3: $R_3 = \\frac{0.0000625 - 0.00004}{0.00004} = 1.5625 - 1 = 0.5625$.\n4.  State 4: $R_4 = \\frac{0.0002625 - 0.00004}{0.00004} = 6.5625 - 1 = 5.5625$.\n\nWe have the probability distribution for the random variable $R$:\n- $R_1 = -1$ with probability $P_1 = 0.42$.\n- $R_2 = -0.6875$ with probability $P_2 = 0.18$.\n- $R_3 = 0.5625$ with probability $P_3 = 0.28$.\n- $R_4 = 5.5625$ with probability $P_4 = 0.12$.\n\nThe expected return $\\mathbb{E}[R]$ is:\n$$\n\\mathbb{E}[R] = \\sum_{i=1}^{4} R_i P_i = (-1)(0.42) + (-0.6875)(0.18) + (0.5625)(0.28) + (5.5625)(0.12)\n$$\n$$\n\\mathbb{E}[R] = -0.42 - 0.12375 + 0.1575 + 0.6675 = 0.28125\n$$\nTo find the variance, we first compute the second moment $\\mathbb{E}[R^2]$:\n$$\n\\mathbb{E}[R^2] = \\sum_{i=1}^{4} R_i^2 P_i = (-1)^2(0.42) + (-0.6875)^2(0.18) + (0.5625)^2(0.28) + (5.5625)^2(0.12)\n$$\n$$\n\\mathbb{E}[R^2] = (1)(0.42) + (0.47265625)(0.18) + (0.31640625)(0.28) + (30.94140625)(0.12)\n$$\n$$\n\\mathbb{E}[R^2] = 0.42 + 0.085078125 + 0.08859375 + 3.71296875 = 4.306640625\n$$\nThe variance of $R$ is $\\operatorname{Var}(R) = \\mathbb{E}[R^2] - (\\mathbb{E}[R])^2$:\n$$\n\\operatorname{Var}(R) = 4.306640625 - (0.28125)^2 = 4.306640625 - 0.0791015625 = 4.2275390625\n$$\nThe standard deviation of $R$ is $\\sigma_R = \\sqrt{\\operatorname{Var}(R)}$:\n$$\n\\sigma_R = \\sqrt{4.2275390625} \\approx 2.056098018\n$$\nFinally, we compute the Sharpe ratio. The risk-free return is given as $r_f = 0.001$.\n$$\n\\text{Sharpe Ratio} = \\frac{\\mathbb{E}[R] - r_{f}}{\\sigma_R} = \\frac{0.28125 - 0.001}{2.056098018} = \\frac{0.28025}{2.056098018} \\approx 0.136301\n$$\nRounding the result to four significant figures gives $0.1363$.",
            "answer": "$$\n\\boxed{0.1363}\n$$"
        },
        {
            "introduction": "Beyond simply measuring risk, a sophisticated investor seeks to actively shape a portfolio's risk profile. This practice moves into the realm of financial engineering, where you will construct a portfolio designed to have a specific exposure to market movements. By optimizing the portfolio to maximize its convexity while maintaining zero first-order sensitivity to the market, you will effectively build a position that profits from market volatility, a key concept in hedging and derivatives trading . This exercise demonstrates how risk and return are not just measured, but actively managed and structured.",
            "id": "2374842",
            "problem": "Consider a single-period economy with a market factor whose gross return over the period is represented by a random variable $R_{m}$. Assume $R_{m}$ is normally distributed with mean $0$ and variance $\\sigma_{m}^{2}$, that is, $R_{m} \\sim \\mathcal{N}(0,\\sigma_{m}^{2})$ with $\\sigma_{m}  0$. You can form a static factor-mimicking portfolio whose realized return is a deterministic function of $R_{m}$ of the form\n$$\nr_{p}(R_{m}) \\;=\\; w_{1}\\,R_{m} \\;+\\; w_{2}\\,\\big(R_{m}^{2} - \\sigma_{m}^{2}\\big),\n$$\nwhere $w_{1}$ and $w_{2}$ are real-valued portfolio weights on the linear and quadratic factors, respectively. Define the portfolio’s local convexity with respect to market returns as the second derivative of $r_{p}(R_{m})$ with respect to $R_{m}$, evaluated at $R_{m}=0$.\n\nConstruct a portfolio whose return has maximal convexity with respect to market returns, under the following normalization and neutrality requirements:\n- Zero first-order sensitivity at $R_{m}=0$ (that is, the first derivative of $r_{p}(R_{m})$ with respect to $R_{m}$ at $R_{m}=0$ equals $0$).\n- Unit variance of the portfolio return, $\\mathrm{Var}\\big[r_{p}(R_{m})\\big] = 1$.\n\nExpress your final answer as the closed-form analytic expression for the optimal $w_{2}$ as a function of $\\sigma_{m}$. No rounding is required. Additionally, in your written solution, explain the hedging properties of the resulting portfolio for small market shocks, based on first principles of risk and return.",
            "solution": "The problem requires the construction of a portfolio with a specific return structure to maximize its local convexity, subject to two constraints on its sensitivity and variance. This is a constrained optimization problem in the context of financial engineering.\n\nThe givens are as follows:\nThe gross return of the market factor is a random variable $R_{m} \\sim \\mathcal{N}(0,\\sigma_{m}^{2})$, with $\\sigma_{m}  0$.\nThe portfolio's return, $r_{p}(R_{m})$, is a deterministic function of $R_{m}$:\n$$r_{p}(R_{m}) = w_{1}R_{m} + w_{2}(R_{m}^{2} - \\sigma_{m}^{2})$$\nwhere $w_{1}$ and $w_{2}$ are real-valued weights.\nThe local convexity is defined as $C = \\frac{d^{2}r_{p}(R_{m})}{dR_{m}^{2}}|_{R_{m}=0}$.\nThe objective is to maximize $C$.\n\nThe constraints are:\n1. Zero first-order sensitivity at $R_{m}=0$: $\\frac{dr_{p}(R_{m})}{dR_{m}}|_{R_{m}=0} = 0$.\n2. Unit variance of the portfolio return: $\\mathrm{Var}[r_{p}(R_{m})] = 1$.\n\nThe problem is scientifically grounded, well-posed, and objective. All terms are mathematically defined, and the premises are standard in quantitative finance. The problem is therefore valid, and we proceed to find the solution.\n\nFirst, we formalize the objective function. The convexity $C$ is found by differentiating the portfolio return function twice with respect to $R_{m}$.\nThe first derivative is:\n$$\\frac{dr_{p}}{dR_{m}} = \\frac{d}{dR_{m}} \\left( w_{1}R_{m} + w_{2}(R_{m}^{2} - \\sigma_{m}^{2}) \\right) = w_{1} + 2w_{2}R_{m}$$\nThe second derivative is:\n$$\\frac{d^{2}r_{p}}{dR_{m}^{2}} = \\frac{d}{dR_{m}} (w_{1} + 2w_{2}R_{m}) = 2w_{2}$$\nThe local convexity is this second derivative evaluated at $R_{m}=0$. As the second derivative is a constant, the local convexity is simply $C = 2w_{2}$.\nTherefore, maximizing the local convexity is equivalent to maximizing the weight $w_{2}$.\n\nNext, we apply the constraints to find the permissible values for $w_{1}$ and $w_{2}$.\n\nConstraint 1: Zero first-order sensitivity at $R_{m}=0$.\nWe evaluate the first derivative at $R_{m}=0$:\n$$\\frac{dr_{p}}{dR_{m}}|_{R_{m}=0} = w_{1} + 2w_{2}(0) = w_{1}$$\nThe constraint requires this to be zero, so we have:\n$$w_{1} = 0$$\nThis result is significant. It implies that for the portfolio to have zero first-order sensitivity to market movements around $R_{m}=0$ (a property known as delta-neutrality in options terminology), it must have no exposure to the linear market factor $R_{m}$. The portfolio return function simplifies to:\n$$r_{p}(R_{m}) = w_{2}(R_{m}^{2} - \\sigma_{m}^{2})$$\n\nConstraint 2: Unit variance of the portfolio return.\nWe must compute the variance of the simplified portfolio return:\n$$\\mathrm{Var}[r_{p}(R_{m})] = \\mathrm{Var}[w_{2}(R_{m}^{2} - \\sigma_{m}^{2})]$$\nUsing the variance property $\\mathrm{Var}[aX] = a^{2}\\mathrm{Var}[X]$ where $a$ is a constant, we get:\n$$\\mathrm{Var}[r_{p}(R_{m})] = w_{2}^{2} \\mathrm{Var}[R_{m}^{2} - \\sigma_{m}^{2}]$$\nSince $\\sigma_{m}^{2}$ is a constant, it does not affect the variance, so $\\mathrm{Var}[R_{m}^{2} - \\sigma_{m}^{2}] = \\mathrm{Var}[R_{m}^{2}]$. The variance constraint becomes:\n$$w_{2}^{2} \\mathrm{Var}[R_{m}^{2}] = 1$$\nTo proceed, we must calculate $\\mathrm{Var}[R_{m}^{2}]$. By definition, $\\mathrm{Var}[R_{m}^{2}] = E[(R_{m}^{2})^{2}] - (E[R_{m}^{2}])^{2} = E[R_{m}^{4}] - (E[R_{m}^{2}])^{2}$.\nWe require the second and fourth moments of the random variable $R_{m} \\sim \\mathcal{N}(0, \\sigma_{m}^{2})$. For a centered Normal distribution ($X \\sim \\mathcal{N}(0, \\sigma^{2})$), the general formula for even moments is $E[X^{2n}] = (2n-1)!! \\sigma^{2n}$.\nFor $n=1$, we find the second moment:\n$$E[R_{m}^{2}] = (2(1)-1)!! \\sigma_{m}^{2(1)} = 1!! \\sigma_{m}^{2} = \\sigma_{m}^{2}$$\nThis is consistent with the definition of variance for a zero-mean variable, $\\mathrm{Var}[R_{m}] = E[R_{m}^{2}] - (E[R_{m}])^{2} = \\sigma_{m}^{2} - 0^{2} = \\sigma_{m}^{2}$.\nFor $n=2$, we find the fourth moment:\n$$E[R_{m}^{4}] = (2(2)-1)!! \\sigma_{m}^{2(2)} = 3!! \\sigma_{m}^{4} = (3 \\cdot 1) \\sigma_{m}^{4} = 3\\sigma_{m}^{4}$$\nNow we can compute the variance of $R_{m}^{2}$:\n$$\\mathrm{Var}[R_{m}^{2}] = E[R_{m}^{4}] - (E[R_{m}^{2}])^{2} = 3\\sigma_{m}^{4} - (\\sigma_{m}^{2})^{2} = 3\\sigma_{m}^{4} - \\sigma_{m}^{4} = 2\\sigma_{m}^{4}$$\nSubstituting this result back into the variance constraint equation:\n$$w_{2}^{2} (2\\sigma_{m}^{4}) = 1$$\nSolving for $w_{2}^{2}$:\n$$w_{2}^{2} = \\frac{1}{2\\sigma_{m}^{4}}$$\nThis gives two possible solutions for $w_{2}$:\n$$w_{2} = \\pm \\sqrt{\\frac{1}{2\\sigma_{m}^{4}}} = \\pm \\frac{1}{\\sqrt{2}\\sigma_{m}^{2}}$$\nOur objective is to maximize $w_{2}$. Comparing the two possible values, we must choose the positive root. The optimal weight $w_{2}$ is therefore:\n$$w_{2} = \\frac{1}{\\sqrt{2}\\sigma_{m}^{2}}$$\n\nHedging Properties of the Optimal Portfolio:\nThe resulting optimal portfolio has a return function given by $r_{p}^{*}(R_{m}) = w_{2}^{*}(R_{m}^{2} - \\sigma_{m}^{2})$, where $w_{2}^{*} = (\\sqrt{2}\\sigma_{m}^{2})^{-1}  0$.\nThe characteristics of this portfolio can be understood through its sensitivities to the market factor, known as 'Greeks' in derivatives pricing.\n1. The first-order sensitivity, or 'Delta', is $\\frac{dr_{p}^{*}}{dR_{m}} = 2w_{2}^{*}R_{m}$. At $R_{m}=0$, the Delta is zero, as imposed by the constraint. This means the portfolio is insensitive to infinitesimally small market moves around its center. It is not a directional bet on the market.\n2. The second-order sensitivity, or 'Gamma', is $\\frac{d^{2}r_{p}^{*}}{dR_{m}^{2}} = 2w_{2}^{*}$. Since $w_{2}^{*}  0$, the portfolio has positive and constant Gamma. This is the convexity we maximized.\nA portfolio that is Delta-neutral and has positive Gamma profits from market movements, regardless of their direction. The return function $r_{p}^{*}(R_{m})$ is a parabola opening upwards, with its minimum at $R_{m}=0$. For any non-zero market return $R_{m}$, the term $R_{m}^{2}$ is positive, and the portfolio's return increases as the magnitude $|R_{m}|$ increases. This payoff structure is characteristic of a long volatility position, such as a long options straddle.\nTherefore, this portfolio acts as a hedge against market stability. An investor holding this portfolio profits from large market shocks (high realized volatility) and incurs a loss if the market remains static (which it does in expectation, as $E[r_{p}^{*}(R_{m})] = w_{2}^{*}(E[R_{m}^{2}] - \\sigma_{m}^{2}) = w_{2}^{*}(\\sigma_{m}^{2} - \\sigma_{m}^{2}) = 0$). It is an instrument designed to provide returns when the market experiences a move larger than what is implicitly priced in. Conversely, it could be used to hedge a position that is 'short volatility'—one that loses money during large market swings.",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}\\sigma_{m}^{2}}}$$"
        },
        {
            "introduction": "The ultimate goal of analyzing risk and return is to make optimal investment decisions. This computational practice brings together utility theory, statistical inference, and portfolio optimization in a unified framework. You will determine the optimal leverage for an investor who receives an imperfect signal about future asset returns, modeling how new information should rationally alter investment strategy . By translating the theoretical CARA-Normal model into a concrete algorithm, this exercise provides hands-on experience in the modern, quantitative approach to portfolio management.",
            "id": "2374866",
            "problem": "Consider a one-period model of a single risky asset with random excess return $\\tilde{R}$, where $\\tilde{R}$ is normally distributed with mean $\\mu$ and variance $\\sigma^{2}$. An investor observes a signal $s$ about $\\tilde{R}$ before choosing a leverage $\\ell \\in \\mathbb{R}$ to apply to the risky asset. The signal is given by\n$$\ns \\;=\\; \\mu \\;+\\; \\alpha\\left(\\tilde{R} - \\mu\\right) \\;+\\; \\nu,\n$$\nwhere $\\nu$ is independent of $\\tilde{R}$, normally distributed with mean $0$ and variance $\\omega^{2}$, and $\\alpha \\ge 0$ is a given skill parameter describing how strongly the signal loads on the true innovation of the return. The investor has Constant Absolute Risk Aversion (CARA) preferences with coefficient $\\gamma  0$, and terminal wealth\n$$\nW_{1} \\;=\\; 1 \\;+\\; \\ell \\,\\tilde{R},\n$$\nwith the excess risk-free rate equal to $0$. All returns and the leverage decision must be expressed as decimals (for example, $0.05$ denotes five percent). The investor chooses $\\ell$ after observing $s$ to maximize the conditional expected utility $\\mathbb{E}\\left[-\\exp\\!\\left(-\\gamma W_{1}\\right)\\,\\middle|\\, s\\right]$.\n\nFor each parameter set specified in the test suite below, compute the optimal leverage $\\ell^{\\star}(s)$ that maximizes the conditional expected utility under the model above, and report it as a real number. Express each answer as a decimal rounded to exactly six digits after the decimal point.\n\nUse the following test suite of parameter values, each case specified as $(\\mu,\\sigma,\\alpha,\\omega,\\gamma,s)$:\n- Case $1$: $(0.05,\\,0.2,\\,0.5,\\,0.1,\\,3,\\,0.08)$.\n- Case $2$: $(0.05,\\,0.2,\\,0,\\,0.1,\\,3,\\,0.2)$.\n- Case $3$: $(0.02,\\,0.15,\\,3,\\,0.05,\\,4,\\,0.3)$.\n- Case $4$: $(0,\\,0.25,\\,1,\\,0.25,\\,2,\\,0)$.\n- Case $5$: $(0.01,\\,0.18,\\,1.2,\\,0.2,\\,5,\\,-0.1)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[x_{1},x_{2},x_{3},x_{4},x_{5}]$), where each $x_{i}$ is the decimal value of $\\ell^{\\star}(s)$ for Case $i$, rounded to six digits after the decimal point.",
            "solution": "The problem is to determine the optimal leverage $\\ell^{\\star}(s)$ for an investor with Constant Absolute Risk Aversion (CARA) utility, given a signal $s$ about a risky asset's excess return $\\tilde{R}$.\n\nFirst, we validate the problem statement.\nAll givens are extracted and validated.\n1.  **Givens**:\n    -   Excess return: $\\tilde{R} \\sim \\mathcal{N}(\\mu, \\sigma^2)$.\n    -   Signal: $s = \\mu + \\alpha(\\tilde{R} - \\mu) + \\nu$.\n    -   Signal noise: $\\nu \\sim \\mathcal{N}(0, \\omega^2)$, independent of $\\tilde{R}$.\n    -   Skill parameter: $\\alpha \\ge 0$.\n    -   Utility function (CARA): $U(W) = -\\exp(-\\gamma W)$, with $\\gamma  0$.\n    -   Terminal wealth: $W_1 = 1 + \\ell \\tilde{R}$.\n    -   Objective: Maximize conditional expected utility, $\\mathbb{E}[-\\exp(-\\gamma W_1) | s]$.\n    -   Parameters $(\\mu, \\sigma, \\alpha, \\omega, \\gamma, s)$ are provided for several test cases.\n\n2.  **Validation**:\n    -   The problem is **scientifically grounded**. The CARA-Normal framework is a standard and fundamental model in financial economics for portfolio choice under uncertainty.\n    -   The problem is **well-posed**. The objective function is strictly concave in the choice variable $\\ell$, and the choice space $\\ell \\in \\mathbb{R}$ is convex, which guarantees a unique solution exists.\n    -   The problem is **objective and complete**. All variables and parameters are defined mathematically, and all necessary values are provided in the test suite. The constraints ($\\gamma  0$, $\\sigma  0$, $\\omega  0$ in test cases) ensure the model is non-degenerate.\n\nThe verdict is that the problem is **valid**. We now proceed to the solution.\n\nThe investor's objective is to choose the leverage $\\ell$ to maximize:\n$$ \\mathbb{E}[U(W_1) | s] = \\mathbb{E}[-\\exp(-\\gamma W_1) | s] = \\mathbb{E}[-\\exp(-\\gamma (1 + \\ell \\tilde{R})) | s] $$\nMaximizing this expression is equivalent to maximizing $-\\exp(-\\gamma)\\mathbb{E}[\\exp(-\\gamma \\ell \\tilde{R}) | s]$. Since $-\\exp(-\\gamma)$ is a negative constant, this is equivalent to minimizing $\\mathbb{E}[\\exp(-\\gamma \\ell \\tilde{R}) | s]$.\n\nThe problem requires the conditional distribution of $\\tilde{R}$ given the observation $s$. Since both $\\tilde{R}$ and $\\nu$ are normally distributed and $s$ is a linear combination of them, the vector $(\\tilde{R}, s)$ follows a bivariate normal distribution. We first determine the parameters of this joint distribution.\nThe mean of $\\tilde{R}$ is $\\mathbb{E}[\\tilde{R}] = \\mu$.\nThe variance of $\\tilde{R}$ is $\\text{Var}(\\tilde{R}) = \\sigma^2$.\nThe mean of the signal $s$ is:\n$$ \\mathbb{E}[s] = \\mathbb{E}[\\mu + \\alpha(\\tilde{R} - \\mu) + \\nu] = \\mu + \\alpha(\\mathbb{E}[\\tilde{R}] - \\mu) + \\mathbb{E}[\\nu] = \\mu + \\alpha(\\mu - \\mu) + 0 = \\mu $$\nThe variance of the signal $s$ is, using the independence of $\\tilde{R}$ and $\\nu$:\n$$ \\text{Var}(s) = \\text{Var}(\\mu + \\alpha\\tilde{R} - \\alpha\\mu + \\nu) = \\text{Var}(\\alpha\\tilde{R} + \\nu) = \\alpha^2 \\text{Var}(\\tilde{R}) + \\text{Var}(\\nu) = \\alpha^2 \\sigma^2 + \\omega^2 $$\nThe covariance between the return $\\tilde{R}$ and the signal $s$ is:\n$$ \\text{Cov}(\\tilde{R}, s) = \\text{Cov}(\\tilde{R}, \\mu + \\alpha(\\tilde{R} - \\mu) + \\nu) = \\text{Cov}(\\tilde{R}, \\alpha\\tilde{R} + \\nu) = \\alpha \\text{Cov}(\\tilde{R}, \\tilde{R}) + \\text{Cov}(\\tilde{R}, \\nu) = \\alpha \\text{Var}(\\tilde{R}) + 0 = \\alpha \\sigma^2 $$\nThus, the joint distribution is:\n$$ \\begin{pmatrix} \\tilde{R} \\\\ s \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} \\mu \\\\ \\mu \\end{pmatrix}, \\begin{pmatrix} \\sigma^2  \\alpha \\sigma^2 \\\\ \\alpha \\sigma^2  \\alpha^2 \\sigma^2 + \\omega^2 \\end{pmatrix} \\right) $$\nFrom the properties of the bivariate normal distribution, the conditional distribution of $\\tilde{R}$ given $s$ is also normal, $\\tilde{R}|s \\sim \\mathcal{N}(\\mu_{R|s}, \\sigma^2_{R|s})$, with conditional mean and variance given by:\n$$ \\mu_{R|s} = \\mathbb{E}[\\tilde{R} | s] = \\mathbb{E}[\\tilde{R}] + \\frac{\\text{Cov}(\\tilde{R}, s)}{\\text{Var}(s)}(s - \\mathbb{E}[s]) = \\mu + \\frac{\\alpha \\sigma^2}{\\alpha^2 \\sigma^2 + \\omega^2}(s - \\mu) $$\n$$ \\sigma^2_{R|s} = \\text{Var}(\\tilde{R} | s) = \\text{Var}(\\tilde{R}) - \\frac{(\\text{Cov}(\\tilde{R}, s))^2}{\\text{Var}(s)} = \\sigma^2 - \\frac{(\\alpha \\sigma^2)^2}{\\alpha^2 \\sigma^2 + \\omega^2} = \\sigma^2\\left(1 - \\frac{\\alpha^2\\sigma^2}{\\alpha^2\\sigma^2 + \\omega^2}\\right) = \\frac{\\sigma^2 \\omega^2}{\\alpha^2 \\sigma^2 + \\omega^2} $$\nThe quantity to be minimized is the conditional moment-generating function of $\\tilde{R}$ evaluated at $t = -\\gamma \\ell$. For a normal variable $X \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$, $\\mathbb{E}[\\exp(tX)] = \\exp(t\\mu_X + \\frac{1}{2} t^2 \\sigma_X^2)$. Applying this to $\\tilde{R}|s$:\n$$ \\mathbb{E}[\\exp(-\\gamma \\ell \\tilde{R}) | s] = \\exp\\left(-\\gamma \\ell \\mu_{R|s} + \\frac{1}{2}(-\\gamma \\ell)^2 \\sigma^2_{R|s}\\right) = \\exp\\left(-\\gamma \\ell \\mu_{R|s} + \\frac{1}{2}\\gamma^2 \\ell^2 \\sigma^2_{R|s}\\right) $$\nMinimizing this exponential function is equivalent to minimizing its argument, which is a quadratic function of $\\ell$:\n$$ f(\\ell) = -\\gamma \\ell \\mu_{R|s} + \\frac{1}{2}\\gamma^2 \\ell^2 \\sigma^2_{R|s} $$\nTo find the minimum, we take the first-order condition with respect to $\\ell$ and set it to zero:\n$$ \\frac{\\partial f}{\\partial \\ell} = -\\gamma \\mu_{R|s} + \\gamma^2 \\ell \\sigma^2_{R|s} = 0 $$\nSolving for the optimal leverage $\\ell^{\\star}(s)$:\n$$ \\ell^{\\star}(s) = \\frac{\\gamma \\mu_{R|s}}{\\gamma^2 \\sigma^2_{R|s}} = \\frac{\\mu_{R|s}}{\\gamma \\sigma^2_{R|s}} $$\nThis is the classic portfolio rule: the allocation to the risky asset is the expected excess return (the \"reward\") divided by the product of risk aversion and perceived variance (the \"risk\").\n\nSubstituting the expressions for the conditional mean and variance:\n$$ \\ell^{\\star}(s) = \\frac{\\mu + \\frac{\\alpha \\sigma^2}{\\alpha^2 \\sigma^2 + \\omega^2}(s - \\mu)}{\\gamma \\left( \\frac{\\sigma^2 \\omega^2}{\\alpha^2 \\sigma^2 + \\omega^2} \\right)} $$\nTo obtain a more stable form for computation, we multiply the numerator and denominator by $(\\alpha^2 \\sigma^2 + \\omega^2)$:\n$$ \\ell^{\\star}(s) = \\frac{\\mu(\\alpha^2 \\sigma^2 + \\omega^2) + \\alpha \\sigma^2(s - \\mu)}{\\gamma \\sigma^2 \\omega^2} $$\nThis final expression will be used to compute the solution for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimal leverage in a one-period CARA-Normal model with a signal.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mu, sigma, alpha, omega, gamma, s)\n    test_cases = [\n        (0.05, 0.2, 0.5, 0.1, 3, 0.08),   # Case 1\n        (0.05, 0.2, 0, 0.1, 3, 0.2),      # Case 2\n        (0.02, 0.15, 3, 0.05, 4, 0.3),    # Case 3\n        (0, 0.25, 1, 0.25, 2, 0),         # Case 4\n        (0.01, 0.18, 1.2, 0.2, 5, -0.1),  # Case 5\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        mu, sigma, alpha, omega, gamma, s = case\n\n        # Use np.power for consistency with specified libraries, though ** is equivalent.\n        sigma_sq = np.power(sigma, 2)\n        omega_sq = np.power(omega, 2)\n        alpha_sq = np.power(alpha, 2)\n\n        # The optimal leverage l_star is given by the formula:\n        # l_star = (mu_R_s) / (gamma * sigma_sq_R_s)\n        # where mu_R_s is the conditional mean of R given s, and\n        # sigma_sq_R_s is the conditional variance of R given s.\n        #\n        # A simplified single expression is derived in the solution:\n        # l_star = (mu * (alpha^2 * sigma^2 + omega^2) + alpha * sigma^2 * (s - mu)) / (gamma * sigma^2 * omega^2)\n        \n        # Numerator of the expression\n        numerator = mu * (alpha_sq * sigma_sq + omega_sq) + alpha * sigma_sq * (s - mu)\n        \n        # Denominator of the expression\n        denominator = gamma * sigma_sq * omega_sq\n        \n        # The problem constraints (sigma  0, omega  0, gamma  0) ensure the denominator is non-zero.\n        optimal_leverage = numerator / denominator\n        \n        results.append(optimal_leverage)\n\n    # Format the results as a comma-separated list of strings,\n    # with each value rounded to exactly six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}