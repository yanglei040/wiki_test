{
    "hands_on_practices": [
        {
            "introduction": "为了将波函数的概率诠释付诸实践，我们必须首先确保它在数学上是规范的。这个练习将引导你完成一个基本但至关重要的计算：为一个在一维空间中运动的粒子确定归一化常数，其波函数形式在描述沿反应坐标的运动时很常见。通过这个练习，你将掌握将总概率设为1所需的积分技巧。",
            "id": "2467238",
            "problem": "在计算化学中常用于描述沿束缚反应坐标运动的一维有效模型中，考虑波函数\n$$\\psi(x) = N\\,x\\,\\exp(-a x), \\quad x \\in [0,\\infty),$$\n其中 $a>0$ 是一个实常数，$N$ 是一个（可能为复数的）归一化常数。请确定 $N$ 的值，使得该波函数在量子力学的概率诠释意义下，在 $[0,\\infty)$ 区间上是归一化的。请将您的最终答案表示为以 $a$ 表示的精确代数表达式。无需进行四舍五入。",
            "solution": "所给问题是有效的。这是量子力学中一个标准的、适定的问题，要求对给定的波函数进行归一化。\n\n量子力学的概率诠释，特别是玻恩定则，规定了在位置 $x$ 处发现一个粒子的概率密度由其波函数的模的平方 $|\\psi(x)|^2$ 给出。为了使粒子存在，在整个允许域内任意位置找到它的总概率必须等于 $1$。这就是归一化条件。对于给定的定义在域 $x \\in [0, \\infty)$ 上的一维波函数 $\\psi(x)$，此条件表示为：\n$$ \\int_{0}^{\\infty} |\\psi(x)|^2 dx = 1 $$\n波函数为 $\\psi(x) = N x \\exp(-ax)$，其中 $N$ 是归一化常数，$a$ 是一个正实数常数 ($a>0$)，$x$ 是位置坐标。我们将此表达式代入归一化积分中：\n$$ \\int_{0}^{\\infty} |N x \\exp(-ax)|^2 dx = 1 $$\n模的平方项可以被分离出来。由于 $N$ 可能是一个复数，我们写作 $|N|^2$。在积分域内，变量 $x$ 是实数且非负的，因此 $|x|^2 = x^2$。常数 $a$ 也是实数，这使得指数项 $\\exp(-ax)$ 为实数。因此， $|\\exp(-ax)|^2 = (\\exp(-ax))^2 = \\exp(-2ax)$。归一化方程简化为：\n$$ |N|^2 \\int_{0}^{\\infty} x^2 \\exp(-2ax) dx = 1 $$\n接下来，我们必须计算这个定积分。这个积分是与伽马函数相关的一个通用公式的特例：\n$$ \\int_{0}^{\\infty} t^n \\exp(-ct) dt = \\frac{n!}{c^{n+1}} $$\n该公式对于任何整数 $n \\ge 0$ 和任何实常数 $c > 0$ 都成立。在我们的问题中，我们认定积分变量为 $t=x$，幂为 $n=2$，指数中的常数为 $c=2a$。因为给定 $a>0$，所以条件 $c>0$ 得到满足。应用该公式可得：\n$$ \\int_{0}^{\\infty} x^2 \\exp(-2ax) dx = \\frac{2!}{(2a)^{2+1}} = \\frac{2}{(2a)^3} = \\frac{2}{8a^3} = \\frac{1}{4a^3} $$\n现在，我们将此结果代回归一化方程中：\n$$ |N|^2 \\left( \\frac{1}{4a^3} \\right) = 1 $$\n解出 $|N|^2$ 可得：\n$$ |N|^2 = 4a^3 $$\n这给出了归一化常数的模长：\n$$ |N| = \\sqrt{4a^3} = 2\\sqrt{a^3} = 2a^{3/2} $$\n归一化常数 $N$ 可以是任何具有此模长的复数，即对于任意的实相位 $\\phi$，有 $N = 2a^{3/2} \\exp(i\\phi)$。然而，在量子力学中，一个常见且公认的惯例是选择归一化常数为一个实的正数，因为波函数的整体相位在物理上是不可观测的。遵循此惯例，我们设 $\\phi=0$ 并得到 $N$ 的最终表达式。\n$$ N = 2a^{3/2} $$\n这个 $N$ 值确保了沿着从 $x=0$ 到 $x=\\infty$ 的反应坐标找到粒子的总概率恰好为 $1$。",
            "answer": "$$\\boxed{2a^{3/2}}$$"
        },
        {
            "introduction": "在掌握了如何归一化波函数之后，下一步是应用这个经过归一化的波函数来预测可观测的物理量。这个练习以“无限深势阱中的粒子”这一经典模型为背景，要求你计算在特定量子态下，在箱子的特定区域内发现粒子的概率。这个过程不仅能加深你对波恩法则的理解，还能让你学会如何将抽象的数学形式与具体的、可验证的物理预测联系起来。",
            "id": "2467295",
            "problem": "一个处于宽度为 $L$ 的一维无限深势阱（盒子中的粒子）中的粒子，在 $x=0$ 和 $x=L$ 处有不可穿透的壁。其势能在区间外为 $V(x)=\\infty$，在区间内为 $V(x)=0$。归一化的定态本征函数为\n$$\n\\psi_{n}(x)=\n\\begin{cases}\n\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right),  0\\le x\\le L, \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\n其中 $n$ 是一个正整数。系统被制备在量子数为 $n=2$ 的定态上。一名学生声称，在盒子的左半部分，即在区间 $\\left[0,\\frac{L}{2}\\right]$ 内找到该粒子的概率恰好是 $0.5$。使用波函数的概率诠释，并从第一性原理出发进行显式计算，确定对于 $n=2$ 的态，在 $\\left[0,\\frac{L}{2}\\right]$ 区间内找到该粒子的概率。将你的最终答案表示为一个没有单位的简化分数（不作近似；不需要四舍五入）。",
            "solution": "波函数的概率诠释指出，在区间 $\\left[a,b\\right]$ 中找到粒子的概率由下式给出\n$$\nP\\left([a,b]\\right)=\\int_{a}^{b}\\left|\\psi(x)\\right|^{2}\\,dx.\n$$\n对于一维无限深势阱，归一化的定态本征函数为\n$$\n\\psi_{n}(x)=\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\n此式在 $0\\le x\\le L$ 时成立，在其他情况下为零。对于 $n=2$ 的态，该函数变为\n$$\n\\psi_{2}(x)=\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{2\\pi x}{L}\\right).\n$$\n因此，在盒子的左半部分 $\\left[0,\\frac{L}{2}\\right]$ 中找到该粒子的概率是\n$$\nP=\\int_{0}^{L/2}\\left|\\psi_{2}(x)\\right|^{2}\\,dx=\\int_{0}^{L/2}\\frac{2}{L}\\sin^{2}\\left(\\frac{2\\pi x}{L}\\right)\\,dx.\n$$\n使用三角恒等式 $\\sin^{2}(u)=\\frac{1}{2}\\left(1-\\cos(2u)\\right)$，并令 $u=\\frac{2\\pi x}{L}$，可以写出\n$$\n\\sin^{2}\\left(\\frac{2\\pi x}{L}\\right)=\\frac{1}{2}\\left(1-\\cos\\left(\\frac{4\\pi x}{L}\\right)\\right).\n$$\n将此式代入积分，得到\n$$\nP=\\int_{0}^{L/2}\\frac{2}{L}\\cdot\\frac{1}{2}\\left(1-\\cos\\left(\\frac{4\\pi x}{L}\\right)\\right)\\,dx=\\int_{0}^{L/2}\\frac{1}{L}\\left(1-\\cos\\left(\\frac{4\\pi x}{L}\\right)\\right)\\,dx.\n$$\n此积分可分为\n$$\nP=\\frac{1}{L}\\int_{0}^{L/2}1\\,dx-\\frac{1}{L}\\int_{0}^{L/2}\\cos\\left(\\frac{4\\pi x}{L}\\right)\\,dx.\n$$\n计算每一项：\n$$\n\\frac{1}{L}\\int_{0}^{L/2}1\\,dx=\\frac{1}{L}\\left[\\;x\\;\\right]_{0}^{L/2}=\\frac{1}{L}\\cdot\\frac{L}{2}=\\frac{1}{2},\n$$\n和\n$$\n\\frac{1}{L}\\int_{0}^{L/2}\\cos\\left(\\frac{4\\pi x}{L}\\right)\\,dx=\\frac{1}{L}\\cdot\\frac{L}{4\\pi}\\left[\\;\\sin\\left(\\frac{4\\pi x}{L}\\right)\\;\\right]_{0}^{L/2}=\\frac{1}{4\\pi}\\left(\\sin(2\\pi)-\\sin(0)\\right)=\\frac{1}{4\\pi}\\left(0-0\\right)=0.\n$$\n结合这些结果，\n$$\nP=\\frac{1}{2}-0=\\frac{1}{2}.\n$$\n因此，显式计算表明，对于 $n=2$ 的态，在 $\\left[0,\\frac{L}{2}\\right]$ 区间内找到该粒子的概率恰好是 $\\frac{1}{2}$，所以该学生声称其恰好为 $0.5$ 是正确的。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "虽然解析计算对于简单的模型至关重要，但现代计算化学更多地依赖于计算机模拟来研究复杂系统。这个实践练习将带你从理论走向实践，使用蒙特卡洛方法来模拟氢原子基态电子的概率分布。你将学习如何根据波函数的平方模（$|\\psi|^2$）设计一个抽样算法，从而以计算的方式“可视化”并定量分析原子轨道，这正是计算化学家研究原子和分子结构的核心方法之一。",
            "id": "2467283",
            "problem": "您需要为氢原子基态轨道实现一个蒙特卡洛采样器，并用它来计算采样分布的量化诊断指标。所使用的科学基础是波函数的Born诠释：位置空间中的概率密度是波函数的模平方。对于基态氢原子，$1s$轨道的实空间波函数是球对称的，由下式给出\n$$\n\\psi_{1s}(r) \\;=\\; \\frac{1}{\\sqrt{\\pi}}\\,\\frac{1}{a_0^{3/2}}\\,e^{-r/a_0},\n$$\n其中$r$是离原子核的径向距离，$a_0$是玻尔半径。在三维空间中可测量的概率密度是$|\\psi_{1s}(r)|^2$。您采取的每一步计算都必须遵循这种概率性诠释以及上述氢原子$1s$波函数的定义。\n\n您的任务是：\n- 设计一个基于概率定律的有原则的算法，用于在$\\mathbb{R}^3$中按照$|\\psi_{1s}(r)|^2$分布进行点采样。您必须从球对称性以及三维概率密度与径向分布之间的关系出发进行推导。角度必须以弧度处理。\n- 尽管概念上的目标是生成三维可视化图像，但在此编程任务中，您不能创建任何绘图。相反，您必须计算量化诊断指标来验证采样的正确性。\n- 对于每个测试用例，使用按规定设置种子的可复现随机数生成器生成$N$个独立样本。使用这些样本，计算以下三个诊断指标，所有指标均以玻尔半径$a_0$为单位表示为无量纲量：\n  1) $r/a_0$的样本均值，\n  2) $(r/a_0)^2$的样本均值，\n  3) 满足$r/a_0 \\le r_0/a_0$的点的样本比例，其中$r_0/a_0$是以$a_0$为单位给定的阈值。\n- 按上述顺序报告每个测试用例的三个诊断指标，四舍五入到6位小数。\n\n物理和数值单位：\n- 距离必须以玻尔半径$a_0$为单位处理。您的输出必须是无量綱数，并按照上述规定用$a_0$的适当幂进行显式归一化。\n- 您内部使用的任何角度变量都必须是弧度。无需输出任何角度。\n\n测试套件：\n实现您的程序以运行以下测试用例，每个用例指定为一个元组$(N,\\ \\text{seed},\\ a_0,\\ r_0/a_0)$：\n- 情况 A: $(100000,\\ 12345,\\ 1.0,\\ 1.0)$\n- 情况 B: $(200000,\\ 2023,\\ 2.0,\\ 2.0)$\n- 情况 C: $(1000,\\ 7,\\ 0.5,\\ 0.5)$\n\n答案规格和最终输出格式：\n- 对于每个测试用例，生成一个包含三个浮点数的列表：$[\\overline{r/a_0},\\ \\overline{(r/a_0)^2},\\ \\widehat{F}(r_0/a_0)]$，其中横线表示样本均值，帽子符号表示样本比例估计值。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为逗号分隔的列表的列表，并用方括号括起来。例如，包含三个用例的输出必须如下所示\n\"[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],[x_{31},x_{32},x_{33}]]\"\n其中每个$x_{ij}$是四舍五入到6位小数的浮点数，且无附加文本。",
            "solution": "问题陈述已经过验证，并被认定为有效。这是一个适定问题，其基础是量子力学的基本原理，特别是氢原子波函数的概率性诠释。该问题的表述是客观、自洽且计算上可行的。任务是为基态电子分布构建一个蒙特卡洛采样器，并计算指定的统计诊断指标。\n\n解决方案的科学基础是Born诠释，该诠释指出，在位置$\\vec{x}$处的一个小体积元$dV$中找到一个粒子的概率由$|\\psi(\\vec{x})|^2 dV$给出。对于氢原子的$1s$轨道，波函数$\\psi_{1s}(r)$仅依赖于径向距离$r = |\\vec{x}|$。该波函数由下式给出：\n$$\n\\psi_{1s}(r) = \\frac{1}{\\sqrt{\\pi} a_0^{3/2}} e^{-r/a_0}\n$$\n其中$a_0$是玻尔半径。因此，三维空间中的概率密度为：\n$$\n|\\psi_{1s}(r)|^2 = \\frac{1}{\\pi a_0^3} e^{-2r/a_0}\n$$\n为了设计采样算法，我们在球坐标$(r, \\theta, \\phi)$中将体积元$dV$表示为$dV = r^2 \\sin\\theta dr d\\theta d\\phi$。这些坐标的联合概率密度为：\n$$\nP(r, \\theta, \\phi) dr d\\theta d\\phi = |\\psi_{1s}(r)|^2 dV = \\left(\\frac{1}{\\pi a_0^3} e^{-2r/a_0}\\right) r^2 \\sin\\theta dr d\\theta d\\phi\n$$\n此表达式可分离为径向和角度分量。分布关于方位角$\\phi$在$[0, 2\\pi]$上是均匀的，而对于极角$\\theta$在$[0, \\pi]$上与$\\sin\\theta$成正比。这对应于空间方向上的各向同性分布。然而，所需的诊断指标仅依赖于径向距离$r$。因此，我们可以通过对角度依赖性进行积分来求得半径$r$的边际概率分布，记为$P(r)$：\n$$\nP(r) dr = \\left( \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\right) \\frac{1}{\\pi a_0^3} r^2 e^{-2r/a_0} dr\n$$\n角度积分的计算结果为$(2\\pi)(2) = 4\\pi$。代入此结果可得到径向分布函数：\n$$\nP(r) dr = (4\\pi) \\frac{1}{\\pi a_0^3} r^2 e^{-2r/a_0} dr = \\frac{4}{a_0^3} r^2 e^{-2r/a_0} dr\n$$\n为了简化问题并按要求使用无量纲量，我们引入一个缩放的径向坐标$\\rho = r/a_0$。因此，$r = \\rho a_0$且$dr = a_0 d\\rho$。将这些代入径向分布函数，得到$\\rho$的概率分布：\n$$\nP(\\rho) d\\rho = \\frac{4}{a_0^3} (\\rho a_0)^2 e^{-2(\\rho a_0)/a_0} (a_0 d\\rho) = 4 \\rho^2 e^{-2\\rho} d\\rho\n$$\n这个无量纲半径$\\rho$的概率密度函数$P(\\rho) = 4\\rho^2 e^{-2\\rho}$与玻尔半径$a_0$无关。因此，测试用例中给出的$a_0$值对于计算所要求的无量纲诊断指标来说是不必要的。\n\n算法的核心是从分布$P(\\rho)$中生成随机样本。这个分布是伽马分布的一个特例。形状参数为$k$、尺度参数为$\\theta$的伽马分布的概率密度函数由下式给出：\n$$\nf(x; k, \\theta) = \\frac{x^{k-1} e^{-x/\\theta}}{\\theta^k \\Gamma(k)}\n$$\n其中$\\Gamma(k)$是伽马函数。对于我们的分布$P(\\rho) = 4\\rho^2 e^{-2\\rho}$，我们可以确定$k-1=2 \\implies k=3$和$1/\\theta=2 \\implies \\theta=1/2$。归一化常数为$\\frac{1}{(1/2)^3 \\Gamma(3)} = \\frac{1}{(1/8) \\cdot 2!} = \\frac{1}{1/4} = 4$，这与我们的$P(\\rho)$相匹配。\n因此，无量纲半径$\\rho$服从形状参数$k=3$、尺度参数$\\theta=0.5$的伽马分布：$\\rho \\sim \\text{Gamma}(k=3, \\theta=0.5)$。\n\n从此分布中采样最符合原理且计算效率最高的方法是使用高质量的伽马分布随机数生成器，这种生成器在`NumPy`等标准科学计算库中均有提供。\n\n计算步骤如下：\n1. 对于每个测试用例，根据指定的样本数$N$、随机种子和阈值$\\rho_0 = r_0/a_0$，用给定的种子初始化一个随机数生成器以确保可复现性。\n2. 从$\\text{Gamma}(k=3, \\theta=0.5)$分布中生成$N$个随机样本$\\{\\rho_i\\}_{i=1}^N$。每个样本$\\rho_i$代表$r/a_0$的一个测量值。\n3. 从这组样本中计算所需的诊断指标：\n   - $r/a_0$的样本均值计算为 $\\overline{r/a_0} = \\frac{1}{N} \\sum_{i=1}^N \\rho_i$。\n   - $(r/a_0)^2$的样本均值计算为 $\\overline{(r/a_0)^2} = \\frac{1}{N} \\sum_{i=1}^N \\rho_i^2$。\n   - 满足$r/a_0 \\le r_0/a_0$的点的样本比例是累积概率$P(\\rho \\le \\rho_0)$的一个估计量，计算为 $\\widehat{F}(\\rho_0) = \\frac{\\text{count}(\\rho_i \\le \\rho_0)}{N}$。\n4. 然后将计算出的三个诊断指标四舍五入到6位小数，并按指定格式化。对所有测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Monte Carlo sampler for the hydrogen 1s orbital to compute\n    statistical diagnostics of the electron's radial distribution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (N, seed, a_0, r_0/a_0)\n    test_cases = [\n        (100000, 12345, 1.0, 1.0),\n        (200000, 2023, 2.0, 2.0),\n        (1000, 7, 0.5, 0.5),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, seed, a0_val, r0_a0 = case\n\n        # The dimensionless radial coordinate rho = r/a_0 follows a Gamma distribution\n        # with shape k=3 and scale theta=0.5.\n        # PDF(rho) = 4 * rho^2 * exp(-2*rho)\n        # This derivation makes the physical parameter a_0 formally unnecessary for\n        # the computation of the requested dimensionless quantities.\n        shape_k = 3.0\n        scale_theta = 0.5\n\n        # Initialize a random number generator with the specified seed for reproducibility.\n        rng = np.random.default_rng(seed)\n\n        # Generate N samples for the dimensionless radius rho = r/a_0.\n        rho_samples = rng.gamma(shape=shape_k, scale=scale_theta, size=N)\n\n        # 1) Compute the sample mean of r/a_0.\n        mean_rho = np.mean(rho_samples)\n\n        # 2) Compute the sample mean of (r/a_0)^2.\n        mean_rho_sq = np.mean(np.square(rho_samples))\n\n        # 3) Compute the sample fraction of points with r/a_0 = r_0/a_0.\n        # r0_a0 is the given dimensionless threshold rho_0.\n        fraction_le_r0 = np.sum(rho_samples = r0_a0) / N\n\n        current_results = [mean_rho, mean_rho_sq, fraction_le_r0]\n        \n        # Format the numbers as strings with 6 decimal places.\n        formatted_strings = [f\"{x:.6f}\" for x in current_results]\n        \n        # Create the string representation of the list for this case.\n        all_results.append(f\"[{','.join(formatted_strings)}]\")\n\n    # Final print statement in the exact required format.\n    # Creates a string representation of a list of lists of floats.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}