{
    "hands_on_practices": [
        {
            "introduction": "连续介质模型是模拟溶剂效应的强大工具，其中最基础的是用于离子的玻恩模型。该模型将离子视为一个带电球体，并计算将其从真空中转移到介电常数为 $\\varepsilon$ 的连续介质中所释放的能量。然而，模型的预测结果对一个关键参数——空腔半径 $r$ ——高度敏感。本练习  将通过计算氯离子在水中的溶剂化自由能，来量化这一能量对空腔半径选择的敏感性，从而帮助你理解在计算化学建模中进行参数敏感性分析的重要性。",
            "id": "2462575",
            "problem": "你需要编写一个完整、可运行的程序，计算在极化连续介质模型 (PCM) 中，液态水中氯离子 $\\mathrm{Cl^-}$ 的溶剂化自由能对所选空腔半径的敏感性。使用 Born 模型表达式计算溶剂化自由能，该模型近似计算了将半径为 $r$ 的球形离子嵌入电介质连续体中时的充电功：\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big),\n$$\n其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$z$ 是离子电荷数，$e$ 是元电荷，$\\varepsilon_0$ 是真空介电常数，$\\varepsilon$ 是溶剂的静态相对介电常数（介电常数）。将溶剂视为室温下的液态水，其介电常数 $\\varepsilon = 78.37$。对于 $\\mathrm{Cl^-}$，取 $z=-1$，$N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$，$e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$，以及 $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$。将空腔半径 $r$ 视为以米为单位的参数。上述 Born 模型公式得出的 $\\Delta G_{\\text{solv}}$ 单位是焦耳每摩尔；你需要将结果转换为千焦每摩尔。所有计算结果必须以千焦每摩尔表示。\n\n对于每个测试用例，定义一个标称 PCM 空腔半径 $r_0$（单位为埃），并考虑由 $\\pm 10\\%$ 的相对变化给出的两个扰动半径：\n- 减小的半径为 $0.9\\,r_0$。\n- 增大的半径为 $1.1\\,r_0$。\n\n对于每个测试用例，计算以下三个量，均以千焦每摩尔为单位：\n- 标称溶剂化自由能 $\\Delta G_{\\text{solv}}(r_0,\\varepsilon)$。\n- $-10\\%$ 变化的绝对误差，定义为 $\\big|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)\\big|$。\n- $+10\\%$ 变化的绝对误差，定义为 $\\big|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)\\big|$。\n\n对 $\\mathrm{Cl^-}$ 使用以下标称空腔半径 $r_0$ 的测试组（单位为埃）：$[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$。使用 $1$ Å $= 1.0\\times 10^{-10}$ m 将埃转换为米。\n\n你的程序必须生成单行输出，其中包含一个包含 $4$ 个子列表的列表，每个测试用例一个子列表，每个子列表包含上述三个浮点数，顺序完全一致，单位为千焦每摩尔，每个数值四舍五入到 $2$ 位小数。例如，要求的格式是\n$[\\,[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],[x_{31},x_{32},x_{33}],[x_{41},x_{42},x_{43}]\\,]$，\n无任何附加文本。",
            "solution": "问题陈述已根据所需标准进行了严格验证。\n\n**步骤 1：提取给定信息**\n- **模型方程**：Born 模型的溶剂化自由能，$\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big)$。\n- **离子**：氯离子 ($\\mathrm{Cl^-}$)，其电荷数为 $z=-1$。\n- **溶剂**：液态水，静态相对介电常数 $\\varepsilon = 78.37$。\n- **物理常数**：\n  - 阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n  - 元电荷：$e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$。\n  - 真空介电常数：$\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$。\n- **单位换算**：\n  - 输入半径 $r_0$ 的单位是埃 (Å)，其中 $1\\ \\text{Å} = 1.0\\times 10^{-10}\\ \\mathrm{m}$。\n  - 输出能量的单位是千焦每摩尔 ($\\mathrm{kJ \\cdot mol^{-1}}$)，其中 $1\\ \\mathrm{kJ} = 1000\\ \\mathrm{J}$。\n- **测试组**：一组用于 $\\mathrm{Cl^-}$ 的标称空腔半径 $r_0$：$[\\,1.60,\\ 1.81,\\ 2.00,\\ 2.20\\,]$，单位为埃。\n- **任务**：对于每个 $r_0$，计算三个值：\n  1. 标称溶剂化自由能 $\\Delta G_{\\text{solv}}(r_0,\\varepsilon)$。\n  2. 半径变化 $-10\\%$ 时的绝对误差：$|\\Delta G_{\\text{solv}}(0.9\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)|$。\n  3. 半径变化 $+10\\%$ 时的绝对误差：$|\\Delta G_{\\text{solv}}(1.1\\,r_0,\\varepsilon) - \\Delta G_{\\text{solv}}(r_0,\\varepsilon)|$。\n\n**步骤 2：使用提取的给定信息进行验证**\n该问题被评估为科学基础扎实、提法恰当且客观。\n- **科学基础**：它基于 Born 模型，这是物理化学中连续介质溶剂化理论的基石。所有物理常数均以其标准、公认的值提供。研究对模型参数（空腔半径）的敏感性是计算化学中的一项标准且有意义的任务。\n- **提法恰当性**：该问题提供了精确的数学公式、所有必要的数值输入以及对所需输出的清晰、明确的规范。它允许一个唯一、稳定且可直接计算的解。\n- **客观性**：语言是定量且精确的，没有任何主观或推测性内容。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将开发一个解决方案。\n\n该解决方案从球形离子在电介质连续体中的溶剂化自由能 $\\Delta G_{\\text{solv}}$ 的 Born 模型方程出发：\n$$\n\\Delta G_{\\text{solv}}(r,\\varepsilon) \\;=\\; N_{\\mathrm{A}} \\,\\frac{(z e)^2}{8\\pi \\varepsilon_0\\, r}\\,\\Big(\\frac{1}{\\varepsilon}-1\\Big)\n$$\n这里，$r$ 是空腔半径，$\\varepsilon$ 是溶剂的静态相对介电常数。所有其他符号代表基本物理常数。\n\n为了提高计算效率，将所有与半径 $r$ 无关的项组合成一个单一的常数因子是很有利的，我们将其表示为 $C_{\\text{Born}}$。\n$$\nC_{\\text{Born}} = N_{\\mathrm{A}} \\frac{(z e)^2}{8\\pi \\varepsilon_0} \\left( \\frac{1}{\\varepsilon} - 1 \\right)\n$$\n这个常数的单位是能量乘以长度每摩尔，在国际单位制 (SI) 中为 $\\mathrm{J \\cdot m \\cdot mol^{-1}}$。然后，溶剂化自由能可以表示为简化形式：\n$$\n\\Delta G_{\\text{solv}}(r) = \\frac{C_{\\text{Born}}}{r}\n$$\n这揭示了在 Born 模型中，溶剂化自由能与空腔半径 $r$ 成反比。这种关系是敏感性分析的核心。\n\n对于每个标称半径为 $r_0$（以埃为单位）的测试用例，计算过程如下：\n1.  **定义常数**：所有物理常数（$N_{\\mathrm{A}}$, $e$, $\\varepsilon_0$）和模型参数（$z$, $\\varepsilon$）均以国际单位制 (SI) 单位定义。\n2.  **预计算 Born 常数**：使用所提供的值计算 $C_{\\text{Born}}$ 的值。此常数将用于所有后续计算。\n3.  **处理测试用例**：对于测试组中的每个标称半径 $r_0$：\n    a. 使用换算因子 $1\\ \\text{Å} = 10^{-10}\\ \\mathrm{m}$ 将 $r_0$ 从埃转换为米。\n    b. 定义扰动半径：$r_{(-)} = 0.9 \\cdot r_0$ 和 $r_{(+)} = 1.1 \\cdot r_0$。\n    c. 使用公式 $\\Delta G_{\\text{solv}}(r_0) = C_{\\text{Born}} / r_0$ 计算标称溶剂化自由能 $\\Delta G_0$。结果单位为 $\\mathrm{J \\cdot mol^{-1}}$，通过除以 $1000$ 转换为 $\\mathrm{kJ \\cdot mol^{-1}}$。\n    d. 计算扰动自由能 $\\Delta G_{(-)} = C_{\\text{Born}} / r_{(-)}$ 和 $\\Delta G_{(+)} = C_{\\text{Born}} / r_{(+)}$，并将它们转换为 $\\mathrm{kJ \\cdot mol^{-1}}$。\n    e. 计算所需的绝对误差：$\\text{Err}_{(-)} = |\\Delta G_{(-)} - \\Delta G_0|$ 和 $\\text{Err}_{(+)} = |\\Delta G_{(+)} - \\Delta G_0|$。\n4.  **格式化输出**：为每个测试用例收集得到的三个浮点数（$\\Delta G_0$, $\\text{Err}_{(-)}$, $\\text{Err}_{(+)}$）。然后将这些结果列表按照问题陈述的规定格式化为最终字符串。\n\n这个分步过程为求解问题提供了一条直接而严谨的路径。$\\Delta G_{\\text{solv}}$ 的负号表示离子在极性溶剂中的溶剂化过程是自发的。敏感性分析将表明，计算出的能量高度依赖于空腔半径的选择，这是连续介质模型的一个已知局限性和关键参数。较小的半径导致更负（更有利）的溶剂化能，并且变化的幅度是非线性的，正如误差所示。半径 $-10\\%$ 变化的误差大于 $+10\\%$ 变化的误差，这与 $1/r$ 的依赖关系相符。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of the solvation free energy of Cl-\n    to the cavity radius in the Born model.\n    \"\"\"\n    # Define physical constants and parameters in SI units.\n    NA = 6.02214076e23  # Avogadro's number (mol^-1)\n    e = 1.602176634e-19  # Elementary charge (C)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F m^-1 or C^2 J^-1 m^-1)\n    z = -1.0             # Charge number for Cl-\n    eps_r = 78.37        # Relative permittivity of water\n    \n    # Define the list of nominal cavity radii in ångströms.\n    test_cases_r0_angstrom = [1.60, 1.81, 2.00, 2.20]\n\n    # Pre-calculate the constant part of the Born equation.\n    # The result has units of J * m / mol.\n    born_constant = (NA * (z * e)**2 / (8 * np.pi * eps0)) * (1.0 / eps_r - 1.0)\n\n    def calculate_g_solv_kj_mol(r_angstrom):\n        \"\"\"\n        Calculates the solvation free energy in kJ/mol for a given radius in ångströms.\n        \"\"\"\n        if r_angstrom == 0:\n            raise ValueError(\"Radius must be positive.\")\n        \n        # Convert radius from ångströms to meters.\n        r_meter = r_angstrom * 1.0e-10\n        \n        # Calculate solvation free energy in J/mol.\n        g_solv_j_mol = born_constant / r_meter\n        \n        # Convert to kJ/mol.\n        return g_solv_j_mol / 1000.0\n\n    # Store the results for all test cases.\n    all_results = []\n    \n    for r0_a in test_cases_r0_angstrom:\n        # Define the perturbed radii.\n        r_minus_a = 0.9 * r0_a\n        r_plus_a = 1.1 * r0_a\n\n        # Calculate the solvation free energies in kJ/mol.\n        g0 = calculate_g_solv_kj_mol(r0_a)\n        g_minus = calculate_g_solv_kj_mol(r_minus_a)\n        g_plus = calculate_g_solv_kj_mol(r_plus_a)\n\n        # Calculate the absolute errors.\n        err_minus = abs(g_minus - g0)\n        err_plus = abs(g_plus - g0)\n        \n        # Append the list of three required values.\n        all_results.append([g0, err_minus, err_plus])\n\n    # Format the final output string according to the specification.\n    # Each number is rounded to 2 decimal places.\n    formatted_sublists = []\n    for result_set in all_results:\n        g, err_m, err_p = result_set\n        formatted_sublists.append(f\"[{g:.2f},{err_m:.2f},{err_p:.2f}]\")\n\n    final_output_string = f\"[{','.join(formatted_sublists)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "从简单的球形离子模型拓展，我们可以使用Onsager反应场模型来处理具有永久偶极矩的中性分子。该模型对于理解溶剂极性如何影响化学反应平衡至关重要。本练习  将以丙酮乙酰的酮-烯醇互变异构为例，这是一个经典的物理有机化学问题。你将通过计算和比较酮式和烯醇式异构体在不同极性溶剂中的溶剂化能，来预测溶剂如何改变它们的平衡常数和摩尔分数。",
            "id": "2462628",
            "problem": "使用偶极溶剂化模型分析溶剂极性对乙酰丙酮酮-烯醇互变异构平衡的影响。酮式和烯醇式互变异构体被建模为点偶极子，位于嵌入均匀、各向同性、线性介电连续体中的球形空腔中心。在相对介电常数为 $\\,\\varepsilon\\,$ 的介质中，位于半径为 $\\,a\\,$ (单位：米) 的球形空腔中心的偶极矩大小为 $\\,\\mu\\,$ (单位：库仑·米) 的偶极子的静电溶剂化自由能由下式给出\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon-1}{2\\varepsilon+1},\n$$\n其中 $\\,\\varepsilon_0\\,$ 是真空介电常数，$\\,N_{\\mathrm{A}}\\,$ 是阿伏伽德罗常数。在温度 $\\,T\\,$下，互变异构体之间的气相标准自由能差定义为 $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$。在介电常数为 $\\,\\varepsilon\\,$ 的溶剂中，标准自由能差变为\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\n其中 $\\,\\mu_{\\mathrm{k}}\\,$ 和 $\\,a_{\\mathrm{k}}\\,$ 分别是酮式互变异构体的偶极矩和空腔半径，$\\,\\mu_{\\mathrm{e}}\\,$ 和 $\\,a_{\\mathrm{e}}\\,$ 分别是烯醇式互变异构体的偶极矩和空腔半径。酮式相对于烯醇式的平衡常数为\n$$\nK(\\varepsilon) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon)}{R\\,T}\\right),\n$$\n其中 $\\,R\\,$ 是理想气体常数。平衡时烯醇式互变异构体的摩尔分数为\n$$\nx_{\\mathrm{enol}}(\\varepsilon) = \\frac{1}{1 + K(\\varepsilon)}.\n$$\n\n在温度 $\\,T = 298.15\\,$ K 时，对乙酰丙酮使用以下基于物理的参数：\n- 气相自由能差：$\\,\\Delta G_{\\mathrm{gas}} = 12000\\,$ J/mol。\n- 酮式互变异构体偶极矩：$\\,\\mu_{\\mathrm{k}} = 4.0\\,$ Debye。\n- 烯醇式互变异构体偶极矩：$\\,\\mu_{\\mathrm{e}} = 1.7\\,$ Debye。\n- 酮式互变异构体空腔半径：$\\,a_{\\mathrm{k}} = 3.0\\,$ Ångström。\n- 烯醇式互变异构体空腔半径：$\\,a_{\\mathrm{e}} = 3.3\\,$ Ångström。\n\n使用以下常数：\n- 真空介电常数：$\\,\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,$ F/m。\n- 阿伏伽德罗常数：$\\,N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,$ mol$^{-1}$。\n- 理想气体常数：$\\,R = 8.31446261815324\\,$ J/(mol·K)。\n\n所需单位换算：\n- $\\,1\\,$ Debye $= 3.33564\\times 10^{-30}\\,$ C·m。\n- $\\,1\\,$ Ångström $= 1.0\\times 10^{-10}\\,$ m。\n\n任务：对于测试集\n$$\n[\\;1.0,\\;2.0,\\;10.0,\\;78.4,\\;200.0\\;]\n$$\n中的每个相对介电常数 $\\,\\varepsilon\\,$ 值，计算烯醇摩尔分数 $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$，结果为无量纲小数。将每个结果四舍五入到恰好六位小数。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表（例如，$[\\mathrm{r}_1,\\mathrm{r}_2,\\dots]$）。输出必须是一个包含五个浮点数的列表，按顺序对应于上面给出的测试介电常数。",
            "solution": "我们旨在利用连续介电模型，确定由相对介电常数 $\\,\\varepsilon\\,$ 量化的溶剂极性如何影响乙酰丙酮的酮-烯醇平衡。该框架是 Onsager 反应场模型，它提供了在介电常数为 $\\,\\varepsilon\\,$ 的介电介质中，半径为 $\\,a\\,$ 的球形空腔中心的偶极子 $\\,\\mu\\,$ 的静电溶剂化自由能 $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a)\\,$：\n$$\n\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu,a) = -\\,\\frac{N_{\\mathrm{A}}\\,\\mu^2}{8\\pi \\varepsilon_0\\,a^3}\\,\\frac{\\varepsilon-1}{2\\varepsilon+1}.\n$$\n该表达式源于经典静电学，通过计算极化介质所做的功，并通过阿伏伽德罗常数 $\\,N_{\\mathrm{A}}\\,$ 将单分子能量转换为摩尔单位得出。溶剂化有利于更大的偶极矩和更小的空腔半径，其稳定性通过因子 $\\,(\\varepsilon-1)/(2\\varepsilon+1)\\,$ 随 $\\,\\varepsilon\\,$ 单调增加，该因子在 $\\,\\varepsilon=1\\,$ 时为零，当 $\\,\\varepsilon\\to\\infty\\,$ 时趋近于 $\\,1/2\\,$。\n\n溶剂中酮式和烯醇式之间的总标准自由能差为\n$$\n\\Delta G_{\\mathrm{tot}}(\\varepsilon) = \\Delta G_{\\mathrm{gas}} + \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}}) - \\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}}),\n$$\n其中 $\\,\\Delta G_{\\mathrm{gas}} = G_{\\mathrm{keto}} - G_{\\mathrm{enol}}\\,$ 是在 $\\,T=298.15\\,$ K 下给出的。正的 $\\,\\Delta G_{\\mathrm{tot}}\\,$ 表示在指定溶剂中，酮式互变异构体比烯醇式互变异构体更不稳定。酮式相对于烯醇式的平衡常数是标准热力学关系式\n$$\nK(\\varepsilon) = \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{tot}}(\\varepsilon)}{R\\,T}\\right),\n$$\n烯醇的摩尔分数为\n$$\nx_{\\mathrm{enol}}(\\varepsilon) = \\frac{1}{1+K(\\varepsilon)}.\n$$\n\n所有量都必须使用一致的国际单位制（SI）。因此，将给定的偶极矩和半径转换为：\n$$\n\\mu_{\\mathrm{k}} = 4.0 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\\quad\n\\mu_{\\mathrm{e}} = 1.7 \\times (3.33564\\times 10^{-30})\\;\\mathrm{C\\cdot m},\n$$\n$$\na_{\\mathrm{k}} = 3.0 \\times 10^{-10}\\;\\mathrm{m},\\quad\na_{\\mathrm{e}} = 3.3 \\times 10^{-10}\\;\\mathrm{m}.\n$$\n使用常数\n$$\n\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\;\\mathrm{F/m},\\quad\nN_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\;\\mathrm{mol^{-1}},\\quad\nR = 8.31446261815324\\;\\mathrm{J/(mol\\cdot K)},\\quad\nT = 298.15\\;\\mathrm{K}.\n$$\n\n对于测试集 $[\\,1.0,\\,2.0,\\,10.0,\\,78.4,\\,200.0\\,]$ 中的每个 $\\,\\varepsilon\\,$，以 SI 单位执行以下计算：\n1. 使用上述表达式计算 $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{k}},a_{\\mathrm{k}})\\,$ 和 $\\,\\Delta G_{\\mathrm{solv}}(\\varepsilon;\\mu_{\\mathrm{e}},a_{\\mathrm{e}})\\,$。\n2. 将酮式和烯醇式溶剂化自由能的差值加到 $\\,\\Delta G_{\\mathrm{gas}}=12000\\,$ J/mol 上，从而构成 $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon)\\,$。\n3. 计算 $\\,K(\\varepsilon) = \\exp\\!\\left(-\\Delta G_{\\mathrm{tot}}(\\varepsilon)/(R T)\\right)\\,$。\n4. 计算 $\\,x_{\\mathrm{enol}}(\\varepsilon) = 1/(1+K(\\varepsilon))\\,$，这是一个无量纲的小数。\n\n与模型一致的定性预期：\n- 在 $\\,\\varepsilon=1\\,$ 时（无溶剂极化），两种互变异构体的 $\\,\\Delta G_{\\mathrm{solv}}=0\\,$，因此 $\\,\\Delta G_{\\mathrm{tot}}=\\Delta G_{\\mathrm{gas}}\\,$。由于 $\\,\\Delta G_{\\mathrm{gas}} > 0\\,$ 有利于烯醇式互变异构体，所以 $\\,x_{\\mathrm{enol}}\\,$ 接近于 $\\,1\\,$。\n- 随着 $\\,\\varepsilon\\,$ 的增加，由于酮式互变异构体具有更大的偶极矩和稍小的空腔半径，其溶剂化稳定性更强，因此 $\\,\\Delta G_{\\mathrm{tot}}(\\varepsilon)\\,$ 减小，而 $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$ 单调减小。\n- 对于大的 $\\,\\varepsilon\\,$，因子 $\\,(\\varepsilon-1)/(2\\varepsilon+1)\\,$ 饱和到 $\\,1/2\\,$，因此在该模型中，溶剂诱导的位移存在一个有限的极限。\n\n程序实现了这些原理，执行了单位一致的计算，对指定的 $\\,\\varepsilon\\,$ 值计算了 $\\,x_{\\mathrm{enol}}(\\varepsilon)\\,$，将每个值四舍五入到恰好六位小数，并以要求的格式输出单行列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef onsager_solvation_energy(mu_debye, a_angstrom, eps_r):\n    \"\"\"\n    Compute electrostatic solvation free energy (J/mol) via the Onsager reaction field model:\n    ΔG_solv(ε; μ, a) = - N_A * μ^2 / (8π ε0 a^3) * ( (ε - 1) / (2 ε + 1) )\n    Inputs:\n        mu_debye: dipole moment in Debye\n        a_angstrom: cavity radius in Ångström\n        eps_r: relative permittivity (dimensionless)\n    Returns:\n        ΔG_solv in J/mol (float)\n    \"\"\"\n    # Constants (SI)\n    eps0 = 8.8541878128e-12  # F/m\n    NA = 6.02214076e23       # 1/mol\n    # Unit conversions\n    mu = mu_debye * 3.33564e-30     # C·m\n    a = a_angstrom * 1.0e-10        # m\n    # Onsager factor\n    reaction_factor = (eps_r - 1.0) / (2.0 * eps_r + 1.0)\n    # Energy\n    dG = - NA * (mu**2) / (8.0 * np.pi * eps0 * (a**3)) * reaction_factor\n    return dG\n\ndef enol_fraction(eps_r, params):\n    \"\"\"\n    Compute enol mole fraction for a given relative permittivity.\n    params: dict with keys ΔG_gas (J/mol), mu_k (D), a_k (Å), mu_e (D), a_e (Å), T (K), R (J/mol/K)\n    \"\"\"\n    dG_gas = params[\"dG_gas\"]\n    mu_k = params[\"mu_k\"]\n    a_k = params[\"a_k\"]\n    mu_e = params[\"mu_e\"]\n    a_e = params[\"a_e\"]\n    T = params[\"T\"]\n    R = params[\"R\"]\n\n    dG_solv_k = onsager_solvation_energy(mu_k, a_k, eps_r)\n    dG_solv_e = onsager_solvation_energy(mu_e, a_e, eps_r)\n    dG_tot = dG_gas + dG_solv_k - dG_solv_e\n    K = np.exp(-dG_tot / (R * T))\n    x_enol = 1.0 / (1.0 + K)\n    return x_enol\n\ndef solve():\n    # Define the test cases from the problem statement (relative permittivities).\n    test_eps = [1.0, 2.0, 10.0, 78.4, 200.0]\n\n    # Physical parameters\n    params = {\n        \"dG_gas\": 12000.0,              # J/mol (G_keto - G_enol)\n        \"mu_k\": 4.0,                    # Debye\n        \"a_k\": 3.0,                     # Å\n        \"mu_e\": 1.7,                    # Debye\n        \"a_e\": 3.3,                     # Å\n        \"T\": 298.15,                    # K\n        \"R\": 8.31446261815324           # J/(mol·K)\n    }\n\n    results = []\n    for eps_r in test_eps:\n        x = enol_fraction(eps_r, params)\n        # Round to exactly six decimal places\n        x_str = f\"{x:.6f}\"\n        results.append(x_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "溶剂效应在分子识别和超分子化学中扮演着决定性角色，例如冠醚对特定离子的选择性结合。这种选择性的一个关键因素是“去溶剂化代价”：离子在进入主体（如冠醚）的空腔之前，必须摆脱其溶剂化层，而这个过程需要消耗能量。本练习  让你应用玻恩模型来比较钠离子 ($Na^+$) 和钾离子 ($K^+$) 的去溶剂化代价差异。通过这个计算，你将亲身体会到一个简单的物理模型如何为复杂的生物化学选择性现象提供深刻的定性解释。",
            "id": "2462622",
            "problem": "要求您通过在连续隐式溶剂近似下分离去溶剂化贡献，来模拟钠离子与钾离子在水中与冠醚结合的相对偏好。离子被视为一个球形电荷，冠醚空腔被视为一个均匀的电介质区域。您的任务是从静电学第一性原理出发，推导出控制表达式，并实现一个程序来评估测试用例。\n\n问题背景与假设：\n- 将离子建模为一个半径为 $r$、携带电荷 $q = z e$ 的完美球体，其中 $z$ 是形式电荷，$e$ 是元电荷。\n- 将环境建模为一个相对介电常数为 $\\varepsilon$ 的均匀、各向同性的连续电介质。\n- 将结合过程视为离子从相对介电常数为 $\\varepsilon_{\\mathrm{w}}$ 的体相水转移到一个相对介电常数为 $\\varepsilon_{\\mathrm{cav}}$ 的低介电常数空腔中的过程。\n- 去溶剂化代价是纯粹与离子在这两种电介质环境之间转移相关的自由能变化，并按一个因子 $\\alpha \\in [0,1]$ 进行缩放，该因子表示结合时失去的溶剂化分数（$\\alpha = 1$ 意味着完全转移，$\\alpha = 0$ 意味着没有转移）。\n- 忽略所有其他贡献（例如，特定的离子-配体相互作用、熵效应、色散力）。输出仅量化去溶剂化项。\n- 使用以下常数和单位：\n  - 真空介电常数：$\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{C^2\\ N^{-1}\\ m^{-2}}$。\n  - 元电荷：$e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n  - 阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n  - 圆周率：$\\pi = 3.141592653589793$。\n  - 使用米作为基本长度单位。使用 $1\\ \\text{\\AA} = 1.0 \\times 10^{-10}\\ \\mathrm{m}$ 将埃转换为米。\n  - 所有自由能以千焦每摩尔（$\\mathrm{kJ\\ mol^{-1}}$）为单位报告。\n\n您的任务：\n- 从经典静电学和嵌入电介质中的带电球形导体的静电场能量储存的定义出发，推导一个半径为 $r$、电荷为 $z e$ 的离子从水（$\\varepsilon_{\\mathrm{w}}$）转移到空腔（$\\varepsilon_{\\mathrm{cav}}$）的去溶剂化自由能 $\\Delta G_{\\mathrm{desolv}}(r,\\varepsilon_{\\mathrm{w}},\\varepsilon_{\\mathrm{cav}},z)$ 的表达式。结果以每摩尔表示。\n- 以此为基础，推导钠离子相对于钾离子的相对去溶剂化惩罚，定义为\n  $$\\Delta\\Delta G_{\\mathrm{desolv}} = \\alpha \\left[\\Delta G_{\\mathrm{desolv}}(r_{\\mathrm{Na}},\\varepsilon_{\\mathrm{w}},\\varepsilon_{\\mathrm{cav}},z) - \\Delta G_{\\mathrm{desolv}}(r_{\\mathrm{K}},\\varepsilon_{\\mathrm{w}},\\varepsilon_{\\mathrm{cav}},z)\\right],$$\n  其中 $r_{\\mathrm{Na}}$ 和 $r_{\\mathrm{K}}$ 分别是钠离子和钾离子的离子半径。解释其符号意义：一个正的 $\\Delta\\Delta G_{\\mathrm{desolv}}$ 值表示钠离子比钾离子付出更高的去溶剂化代价（因此，仅从去溶剂化角度看，钾离子相对更受偏好）。\n- 实现一个程序，为下面的每个测试用例计算 $\\Delta\\Delta G_{\\mathrm{desolv}}$，返回一个包含浮点数的单一列表，单位为 $\\mathrm{kJ\\ mol^{-1}}$，并四舍五入到三位小数。\n\n角度单位说明：本问题不使用角度。不使用百分比；对于任何分数参数，请使用小数。\n\n测试套件规范：\n对于每个测试用例，参数以 $(\\varepsilon_{\\mathrm{cav}}, \\varepsilon_{\\mathrm{w}}, r_{\\mathrm{Na}}\\ \\text{in \\AA}, r_{\\mathrm{K}}\\ \\text{in \\AA}, \\alpha, z)$ 的形式提供，其中 $z$ 是离子电荷数（两个离子使用相同的 $z$）。\n- 测试用例 $1$（理想路径，低介电常数空腔）：$(2.0, 78.37, 1.02, 1.38, 1.0, 1)$。\n- 测试用例 $2$（边界情况，零转移）：$(2.0, 78.37, 1.02, 1.38, 0.0, 1)$。\n- 测试用例 $3$（边界情况，相同介质）：$(78.37, 78.37, 1.02, 1.38, 1.0, 1)$。\n- 测试用例 $4$（边缘情况，半径相等）：$(2.0, 78.37, 1.20, 1.20, 1.0, 1)$。\n- 测试用例 $5$（中等介电常数空腔和部分转移）：$(10.0, 78.37, 1.02, 1.38, 0.7, 1)$。\n- 测试用例 $6$（极低介电常数空腔）：$(1.5, 78.37, 1.02, 1.38, 1.0, 1)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,\\dots,x_6]$，其中每个 $x_i$ 是测试用例 $i$ 计算出的 $\\Delta\\Delta G_{\\mathrm{desolv}}$ 值，单位为 $\\mathrm{kJ\\ mol^{-1}}$，并四舍五入到三位小数。",
            "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于经典静电学原理，特别是离子溶剂化的 Born 模型。问题是适定的，提供了所有必要的常数、参数和明确的目标。语言客观且无歧义。我们现在将进行推导和求解。\n\n任务是推导钠离子与钾离子从水转移到冠醚空腔（被建模为连续电介质）的相对去溶剂化自由能 $\\Delta\\Delta G_{\\mathrm{desolv}}$。此推导基于静电学的第一性原理。\n\n首先，我们推导一个半径为 $r$、电荷为 $q$ 的球形离子在相对介电常数为 $\\varepsilon$ 的均匀电介质中的静电自能。根据 Gauss 定律，球对称电荷分布外部的电场与其中心点电荷产生的电场相同。因此，离子表面的静电势 $V$ 为：\n$$\nV = \\frac{q}{4 \\pi \\varepsilon_{abs} r}\n$$\n其中 $\\varepsilon_{abs}$ 是介质的绝对介电常数，它通过 $\\varepsilon_{abs} = \\varepsilon \\varepsilon_0$ 与相对介电常数 $\\varepsilon$ 和真空介电常数 $\\varepsilon_0$ 相关。因此，电势为：\n$$\nV = \\frac{q}{4 \\pi \\varepsilon \\varepsilon_0 r}\n$$\n将球体从电荷为 $0$ 充电到最终电荷 $q$ 所做的功 $W$，等于存储在电场中的静电自由能 $G_{el}$。这可以通过对电荷积分电势来计算：\n$$\nG_{el} = W = \\int_0^q V(q') dq' = \\int_0^q \\frac{q'}{4 \\pi \\varepsilon \\varepsilon_0 r} dq'\n$$\n进行积分可得到 Born 能量：\n$$\nG_{el} = \\frac{1}{4 \\pi \\varepsilon \\varepsilon_0 r} \\left[ \\frac{q'^2}{2} \\right]_0^q = \\frac{q^2}{8 \\pi \\varepsilon \\varepsilon_0 r}\n$$\n该表达式表示离子在给定电介质中的静电自能。\n\n接下来，我们计算将离子从初始状态（在水中，$\\varepsilon_{\\mathrm{w}}$）转移到最终状态（在空腔中，$\\varepsilon_{\\mathrm{cav}}$）的去溶剂化自由能 $\\Delta G_{\\mathrm{desolv}}$。此过程的自由能变化是最终静电能与初始静电能之差：\n$$\n\\Delta G_{\\mathrm{transfer}} = G_{\\mathrm{final}} - G_{\\mathrm{initial}} = G_{el}(\\varepsilon_{\\mathrm{cav}}) - G_{el}(\\varepsilon_{\\mathrm{w}})\n$$\n代入 Born 能量表达式：\n$$\n\\Delta G_{\\mathrm{transfer}} = \\frac{q^2}{8 \\pi \\varepsilon_{\\mathrm{cav}} \\varepsilon_0 r} - \\frac{q^2}{8 \\pi \\varepsilon_{\\mathrm{w}} \\varepsilon_0 r}\n$$\n提出公因子，得到单个离子的能量变化：\n$$\n\\Delta G_{\\mathrm{transfer}} = \\frac{q^2}{8 \\pi \\varepsilon_0 r} \\left( \\frac{1}{\\varepsilon_{\\mathrm{cav}}} - \\frac{1}{\\varepsilon_{\\mathrm{w}}} \\right)\n$$\n问题要求结果以千焦每摩尔为单位。我们必须乘以阿伏伽德罗常数 $N_{\\mathrm{A}}$，并代入离子电荷 $q = ze$，其中 $z$ 是形式电荷数，$e$ 是元电荷。这给出了摩尔去溶剂化自由能 $\\Delta G_{\\mathrm{desolv}}$：\n$$\n\\Delta G_{\\mathrm{desolv}}(r, \\varepsilon_{\\mathrm{w}}, \\varepsilon_{\\mathrm{cav}}, z) = N_{\\mathrm{A}} \\frac{(ze)^2}{8 \\pi \\varepsilon_0 r} \\left( \\frac{1}{\\varepsilon_{\\mathrm{cav}}} - \\frac{1}{\\varepsilon_{\\mathrm{w}}} \\right)\n$$\n这就是完全转移的去溶剂化代价所需的表达式。\n\n最后，我们推导钠离子（$r_{\\mathrm{Na}}$）和钾离子（$r_{\\mathrm{K}}$）之间的相对去溶剂化惩罚 $\\Delta\\Delta G_{\\mathrm{desolv}}$ 的表达式。该量定义为：\n$$\n\\Delta\\Delta G_{\\mathrm{desolv}} = \\alpha \\left[ \\Delta G_{\\mathrm{desolv}}(r_{\\mathrm{Na}}, \\varepsilon_{\\mathrm{w}}, \\varepsilon_{\\mathrm{cav}}, z) - \\Delta G_{\\mathrm{desolv}}(r_{\\mathrm{K}}, \\varepsilon_{\\mathrm{w}}, \\varepsilon_{\\mathrm{cav}}, z) \\right]\n$$\n其中 $\\alpha$ 是去溶剂化分数因子。由于两个离子具有相同的电荷 $z$ 并且在相同的介质之间转移，我们可以代入我们推导出的 $\\Delta G_{\\mathrm{desolv}}$ 表达式：\n$$\n\\Delta\\Delta G_{\\mathrm{desolv}} = \\alpha \\left[ N_{\\mathrm{A}} \\frac{(ze)^2}{8 \\pi \\varepsilon_0 r_{\\mathrm{Na}}} \\left( \\frac{1}{\\varepsilon_{\\mathrm{cav}}} - \\frac{1}{\\varepsilon_{\\mathrm{w}}} \\right) - N_{\\mathrm{A}} \\frac{(ze)^2}{8 \\pi \\varepsilon_0 r_{\\mathrm{K}}} \\left( \\frac{1}{\\varepsilon_{\\mathrm{cav}}} - \\frac{1}{\\varepsilon_{\\mathrm{w}}} \\right) \\right]\n$$\n提出对于给定比较是常数的公因子，我们得到用于实现的最终表达式：\n$$\n\\Delta\\Delta G_{\\mathrm{desolv}} = \\alpha \\left[ N_{\\mathrm{A}} \\frac{(ze)^2}{8 \\pi \\varepsilon_0} \\left( \\frac{1}{\\varepsilon_{\\mathrm{cav}}} - \\frac{1}{\\varepsilon_{\\mathrm{w}}} \\right) \\right] \\left( \\frac{1}{r_{\\mathrm{Na}}} - \\frac{1}{r_{\\mathrm{K}}} \\right)\n$$\n由于 $\\varepsilon_{\\mathrm{cav}}  \\varepsilon_{\\mathrm{w}}$（转移到低介电常数空腔）且 $r_{\\mathrm{Na}}  r_{\\mathrm{K}}$，介电项 $(\\frac{1}{\\varepsilon_{\\mathrm{cav}}} - \\frac{1}{\\varepsilon_{\\mathrm{w}}})$ 和半径项 $(\\frac{1}{r_{\\mathrm{Na}}} - \\frac{1}{r_{\\mathrm{K}}})$ 均为正。当 $\\alpha > 0$ 时，所得的 $\\Delta\\Delta G_{\\mathrm{desolv}}$ 将为正值，这正确地表明较小的钠离子具有更大的去溶剂化惩罚。\n\n实现将为每个测试用例计算这个最终表达式。所有输入半径都以埃为单位，必须转换为米（$1\\ \\text{\\AA} = 1.0 \\times 10^{-10}\\ \\mathrm{m}$）。最终结果通过除以 $1000$ 从焦耳每摩尔转换为千焦每摩尔。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the relative desolvation penalty for sodium vs. potassium ion\n    based on the Born model of ion solvation.\n    \"\"\"\n    #\n    # CONSTANTS\n    #\n    # Vacuum permittivity in C^2 N^-1 m^-2\n    EPS_0 = 8.8541878128e-12\n    # Elementary charge in C\n    E_CHARGE = 1.602176634e-19\n    # Avogadro constant in mol^-1\n    N_A = 6.02214076e23\n\n    # Define the test cases from the problem statement.\n    # Format: (eps_cav, eps_w, r_Na_A, r_K_A, alpha, z)\n    # Radii are in Ångström.\n    test_cases = [\n        (2.0, 78.37, 1.02, 1.38, 1.0, 1),\n        (2.0, 78.37, 1.02, 1.38, 0.0, 1),\n        (78.37, 78.37, 1.02, 1.38, 1.0, 1),\n        (2.0, 78.37, 1.20, 1.20, 1.0, 1),\n        (10.0, 78.37, 1.02, 1.38, 0.7, 1),\n        (1.5, 78.37, 1.02, 1.38, 1.0, 1),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        eps_cav, eps_w, r_na_A, r_k_A, alpha, z = case\n\n        # Convert radii from Ångström to meters\n        r_na_m = r_na_A * 1.0e-10\n        r_k_m = r_k_A * 1.0e-10\n\n        # Handle trivial zero cases to avoid unnecessary computation\n        if alpha == 0.0 or eps_cav == eps_w or r_na_m == r_k_m:\n            results.append(0.0)\n            continue\n\n        # Derived final expression:\n        # ddG = alpha * [ (Na * (z*e)^2) / (8 * pi * eps_0) * \n        #               (1/eps_cav - 1/eps_w) ] * (1/r_Na - 1/r_K)\n        \n        # Calculate the constant part of the expression\n        # Unit: J * m * mol^-1\n        constant_factor = N_A * (z * E_CHARGE)**2 / (8 * np.pi * EPS_0)\n\n        # Calculate the dielectric-dependent term (dimensionless)\n        dielectric_term = (1 / eps_cav) - (1 / eps_w)\n\n        # Calculate the radius-dependent term (unit: m^-1)\n        radius_term = (1 / r_na_m) - (1 / r_k_m)\n\n        # Calculate ddG in J/mol\n        ddG_J_mol = alpha * constant_factor * dielectric_term * radius_term\n\n        # Convert to kJ/mol\n        ddG_kJ_mol = ddG_J_mol / 1000.0\n\n        # Round to three decimal places\n        results.append(round(ddG_kJ_mol, 3))\n\n    # Format and print the final output as a single-line list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}