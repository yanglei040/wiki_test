{
    "hands_on_practices": [
        {
            "introduction": "要理解隐式溶剂模型，第一步是掌握溶剂连续体如何响应溶质电荷分布的基本物理原理。Onsager 模型虽然简单，但它引入了“反应场”这一核心概念，为更复杂的模型奠定了基础。本练习将引导你通过经典的静电学原理，推导出 Onsager 反应场因子，这是构建所有连续介质模型基础数学直觉的关键一步 ()。",
            "id": "2456542",
            "problem": "一个矩为 $\\mu$ 的点电偶极子被固定在一个半径为 $a$ 的球形真空腔的中心，该真空腔嵌入在一个相对介电常数为 $\\epsilon$ 的无限、均匀、各向同性、线性的介电连续体中。在简单的 Onsager 模型中，反应场定义为在偶极子位置处，仅由周围介电质的极化产生、不包括偶极子自身场的电场。通过关系式定义反应场因子 $f(\\epsilon)$\n$$\nE_{\\mathrm{R}} = f(\\epsilon)\\,\\frac{\\mu}{4\\pi \\epsilon_{0} a^{3}},\n$$\n其中 $E_{\\mathrm{R}}$ 是反应场沿偶极子方向的大小，$\\epsilon_{0}$ 是真空介电常数。对于固态氩中空腔内的一个分子，其 $\\epsilon \\approx 1.5$，计算 $f(\\epsilon)$。将答案四舍五入到四位有效数字。将最终结果表示为一个纯数（无单位）。",
            "solution": "该问题要求确定球形腔中心的反应场。这是一个静电边值问题。我们将求解腔体内外的静电势 $\\Phi$，并在腔体表面应用适当的边界条件。\n\n设半径为 $a$ 的球形腔中心位于球坐标系 $(r, \\theta, \\phi)$ 的原点。一个矩为 $\\vec{\\mu}$ 的点偶极子放置在原点，与 $z$ 轴对齐，因此 $\\vec{\\mu} = \\mu \\hat{z}$。由于方位对称性，电势将与 $\\phi$ 无关。\n\n腔体内部（$r  a$）的电势 $\\Phi_{\\text{in}}$ 是点偶极子自身的电势 $\\Phi_{\\text{dip}}$ 与由外部介电质极化引起的电势 $\\Phi_{\\text{R}}$ 之和。后者被称为反应势。\n位于原点的点偶极子的电势为：\n$$\n\\Phi_{\\text{dip}}(r, \\theta) = \\frac{\\vec{\\mu} \\cdot \\vec{r}}{4\\pi \\epsilon_{0} r^{3}} = \\frac{\\mu r \\cos\\theta}{4\\pi \\epsilon_{0} r^{3}} = \\frac{\\mu \\cos\\theta}{4\\pi \\epsilon_{0} r^{2}}\n$$\n反应势 $\\Phi_{\\text{R}}$ 必须是腔体内拉普拉斯方程 $\\nabla^{2}\\Phi_{\\text{R}} = 0$ 的解，并且在原点（$r=0$）处必须是正则的。具有方位对称性的通解是一系列勒让德多项式。给定偶极源（$l=1$），反应势也将具有偶极特性。在原点处正则的解具有以下形式：\n$$\n\\Phi_{\\text{R}}(r, \\theta) = \\sum_{l=0}^{\\infty} A_{l} r^{l} P_{l}(\\cos\\theta)\n$$\n对于偶极源，只有 $l=1$ 项对原点处的反应场有贡献，因此我们写为 $\\Phi_{\\text{R}}(r, \\theta) = A_{1} r \\cos\\theta$。\n因此，腔体内部的总电势为：\n$$\n\\Phi_{\\text{in}}(r, \\theta) = \\frac{\\mu \\cos\\theta}{4\\pi \\epsilon_{0} r^{2}} + A_{1} r \\cos\\theta\n$$\n\n腔体外部（$r > a$）的电势 $\\Phi_{\\text{out}}$ 也必须是拉普拉斯方程 $\\nabla^{2}\\Phi_{\\text{out}} = 0$ 的解。该电势在 $r \\to \\infty$ 时必须趋于零。满足此条件的通解是：\n$$\n\\Phi_{\\text{out}}(r, \\theta) = \\sum_{l=0}^{\\infty} \\frac{B_{l}}{r^{l+1}} P_{l}(\\cos\\theta)\n$$\n再次，考虑到问题的偶极性质，我们只需要 $l=1$ 项：\n$$\n\\Phi_{\\text{out}}(r, \\theta) = \\frac{B_{1} \\cos\\theta}{r^{2}}\n$$\n\n在介电质界面（$r=a$）处的边界条件是：\n1.  静电势的连续性：$\\Phi_{\\text{in}}(a, \\theta) = \\Phi_{\\text{out}}(a, \\theta)$。\n2.  电位移场 $\\vec{D}$ 法向分量的连续性：$D_{\\text{in}, r}(a, \\theta) = D_{\\text{out}, r}(a, \\theta)$。\n\n应用第一个边界条件：\n$$\n\\frac{\\mu \\cos\\theta}{4\\pi \\epsilon_{0} a^{2}} + A_{1} a \\cos\\theta = \\frac{B_{1} \\cos\\theta}{a^{2}}\n$$\n这必须对所有 $\\theta$ 成立，所以我们可以除以 $\\cos\\theta$：\n$$\n\\frac{\\mu}{4\\pi \\epsilon_{0} a^{2}} + A_{1} a = \\frac{B_{1}}{a^{2}} \\quad (1)\n$$\n\n对于第二个边界条件，我们使用 $\\vec{D} = \\epsilon_{r}\\epsilon_{0}\\vec{E} = -\\epsilon_{r}\\epsilon_{0}\\nabla\\Phi$。$\\vec{D}$ 的法向分量是 $D_r = -\\epsilon_{r}\\epsilon_{0} \\frac{\\partial\\Phi}{\\partial r}$。在真空腔内部，$\\epsilon_r=1$。在外部的介电质中，$\\epsilon_r=\\epsilon$。\n$$\n-\\epsilon_{0}\\left(\\frac{\\partial\\Phi_{\\text{in}}}{\\partial r}\\right)_{r=a} = -\\epsilon_{0}\\epsilon\\left(\\frac{\\partial\\Phi_{\\text{out}}}{\\partial r}\\right)_{r=a}\n$$\n径向导数是：\n$$\n\\frac{\\partial\\Phi_{\\text{in}}}{\\partial r} = -\\frac{2\\mu \\cos\\theta}{4\\pi \\epsilon_{0} r^{3}} + A_{1} \\cos\\theta\n$$\n$$\n\\frac{\\partial\\Phi_{\\text{out}}}{\\partial r} = -\\frac{2B_{1} \\cos\\theta}{r^{3}}\n$$\n在 $r=a$ 处求值并代入边界条件：\n$$\n-\\epsilon_{0}\\left(-\\frac{2\\mu \\cos\\theta}{4\\pi \\epsilon_{0} a^{3}} + A_{1} \\cos\\theta\\right) = -\\epsilon_{0}\\epsilon\\left(-\\frac{2B_{1} \\cos\\theta}{a^{3}}\\right)\n$$\n除以 $\\epsilon_{0}\\cos\\theta$：\n$$\n\\frac{2\\mu}{4\\pi \\epsilon_{0} a^{3}} - A_{1} = \\frac{2\\epsilon B_{1}}{a^{3}} \\quad (2)\n$$\n\n我们现在求解由(1)和(2)组成的二元线性方程组，以求出决定反应场的系数 $A_1$。从方程(1)中，我们将 $B_1$ 表示为 $A_1$ 的函数：\n$$\nB_{1} = a^2 \\left( \\frac{\\mu}{4\\pi \\epsilon_{0} a^{2}} + A_{1} a \\right) = \\frac{\\mu a^{2}}{4\\pi \\epsilon_{0} a^{2}} + A_{1}a^3 = \\frac{\\mu}{4\\pi \\epsilon_{0}} + A_{1} a^{3}\n$$\n将这个 $B_1$ 的表达式代入方程(2)：\n$$\n\\frac{2\\mu}{4\\pi \\epsilon_{0} a^{3}} - A_{1} = \\frac{2\\epsilon}{a^{3}} \\left( \\frac{\\mu}{4\\pi \\epsilon_{0}} + A_{1} a^{3} \\right)\n$$\n$$\n\\frac{2\\mu}{4\\pi \\epsilon_{0} a^{3}} - A_{1} = \\frac{2\\epsilon\\mu}{4\\pi \\epsilon_{0} a^{3}} + 2\\epsilon A_{1}\n$$\n重新整理以求解 $A_1$：\n$$\n\\frac{2\\mu}{4\\pi \\epsilon_{0} a^{3}} (1 - \\epsilon) = A_{1} (1 + 2\\epsilon)\n$$\n$$\nA_{1} = \\frac{2(1 - \\epsilon)}{1 + 2\\epsilon} \\frac{\\mu}{4\\pi \\epsilon_{0} a^{3}} = -\\frac{2(\\epsilon - 1)}{2\\epsilon + 1} \\frac{\\mu}{4\\pi \\epsilon_{0} a^{3}}\n$$\n反应势为 $\\Phi_{\\text{R}} = A_{1} r \\cos\\theta = A_{1} z$。反应场 $\\vec{E}_{\\mathrm{R}}$ 是由此电势产生的电场，在偶极子所在的原点处求值。\n$$\n\\vec{E}_{\\mathrm{R}} = -\\nabla \\Phi_{\\text{R}} = -\\nabla(A_{1} z) = -A_{1}\\hat{z}\n$$\n反应场沿偶极子方向（$z$轴）的大小是 $E_{\\mathrm{R}} = -A_{1}$。\n$$\nE_{\\mathrm{R}} = - \\left( -\\frac{2(\\epsilon - 1)}{2\\epsilon + 1} \\frac{\\mu}{4\\pi \\epsilon_{0} a^{3}} \\right) = \\frac{2(\\epsilon - 1)}{2\\epsilon + 1} \\frac{\\mu}{4\\pi \\epsilon_{0} a^{3}}\n$$\n将此结果与问题中给出的定义 $E_{\\mathrm{R}} = f(\\epsilon)\\,\\frac{\\mu}{4\\pi \\epsilon_{0} a^{3}}$ 进行比较，我们确定反应场因子 $f(\\epsilon)$ 为：\n$$\nf(\\epsilon) = \\frac{2(\\epsilon - 1)}{2\\epsilon + 1}\n$$\n这就是 Onsager 反应场因子。\n\n问题要求计算这个因子在固态氩（$\\epsilon = 1.5$）情况下的数值。\n$$\nf(1.5) = \\frac{2(1.5 - 1)}{2(1.5) + 1} = \\frac{2(0.5)}{3 + 1} = \\frac{1}{4} = 0.25\n$$\n答案必须四舍五入到四位有效数字。因此，$f(1.5) = 0.2500$。",
            "answer": "$$\n\\boxed{0.2500}\n$$"
        },
        {
            "introduction": "在掌握了反应场的基本概念后，我们进一步探索现代隐式溶剂模型是如何实际计算它的。与简单的解析解不同，这些方法通常在离散化的分子表面上使用数值技术，如边界元方法 (Boundary Element Method, BEM)。本练习将指导你构建一个简化的 BEM 程序，让你亲身体验并理解诸如表面网格密度等数值参数如何影响计算出的溶剂化能的准确性，从而揭开高级计算模型“黑箱”的神秘面纱 ()。",
            "id": "2456562",
            "problem": "要求您设计并实现一个数值实验，以研究在使用可极化连续介质模型 (PCM) 进行隐式溶剂计算时，空腔表面网格剖分的精细程度如何影响收敛性及最终的静电溶剂化能。请从基本静电学和面积分公式出发，建立一个离散边界元近似，该近似允许您系统性地加密表面网格并观察收敛情况。\n\n考虑一个电荷量为 $q$ 的点电荷，位于半径为 $a$ 的球形溶质空腔中心，该空腔浸没在相对介电常数为 $\\varepsilon$ 的均匀电介质连续体中。计算完全采用原子单位制，即能量单位为 Hartree，长度单位为 bohr，电荷单位为基本电荷，真空介电常数被吸收到单位体系中（因此 $1/(4\\pi\\varepsilon_0)=1$）。\n\n您的推导和算法应基于以下经过充分检验的事实和核心定义：\n\n- 点电荷势的库仑定律以及电介质界面上的经典边界条件。\n- 通过分布在空腔边界上的表观表面电荷来表示反应场，从而得到表面势的边值积分方程。\n- 静电溶剂化自由能的定义为溶质电荷与其所受反应势乘积的一半。\n\n请按以下步骤进行：\n\n1) 在一个网格剖分后的球形表面上，为类导体极限（类导体屏蔽模型 (COSMO)，此时空腔表面上的总势为零）建立边界元配置法方案。使用恒定面元值和质心配置法来离散化单层算子。对于一个半径为 $a$ 的球体上的 $N$ 个表面面元，其质心位于 $\\{\\mathbf{r}_i\\}_{i=1}^N$，且面积相等，为 $A_i = 4\\pi a^2/N$，影响矩阵的元素可近似为：\n- 当 $i \\ne j$ 时：$S_{ij} \\approx \\dfrac{A_j}{\\left\\|\\mathbf{r}_i-\\mathbf{r}_j\\right\\|}$，\n- 当 $i = j$ 时：$S_{ii} \\approx 2\\sqrt{\\pi A_i}$，\n从而得到 $S\\boldsymbol{\\sigma} = -\\boldsymbol{\\phi}_q$，其中 $\\boldsymbol{\\sigma}$ 是面元电荷密度向量，$\\phi_{q,i}$ 是在没有极化时溶质电荷在面元 $i$ 处的势。请使用均匀的网格剖分，使得所有 $A_i$ 相等，并使用任何基于球坐标的算法，选择近似均匀分布在球面上的配置点；如果您使用角度，其单位必须是弧度。\n\n2) 对于位于中心的点电荷，对所有 $i$ 使用 $\\phi_{q,i} = q/a$，并求解线性系统以获得类导体表观表面电荷 $\\boldsymbol{\\sigma}$。通过离散化的单层势计算电荷位置（原点）处的类导体反应势：\n$$\n\\Phi_{\\mathrm{reac}}^{(\\infty)} \\approx \\sum_{j=1}^N \\frac{A_j \\sigma_j}{\\|\\mathbf{0}-\\mathbf{r}_j\\|} = \\frac{1}{a}\\sum_{j=1}^N A_j \\sigma_j.\n$$\n\n3) 通过应用适用于此几何构型的精确缩放因子，将类导体反应势映射到具有中心电荷的球形空腔在有限介电常数 $\\varepsilon$ 的情况：\n$$\n\\Phi_{\\mathrm{reac}}(\\varepsilon) = \\frac{\\varepsilon - 1}{\\varepsilon}\\,\\Phi_{\\mathrm{reac}}^{(\\infty)}.\n$$\n\n4) 计算静电溶剂化自由能：\n$$\n\\Delta G_{\\mathrm{num}} = \\frac{1}{2}\\, q \\, \\Phi_{\\mathrm{reac}}(\\varepsilon),\n$$\n以 Hartree 为单位。\n\n5) 为了验证并量化随网格剖分精细度的收敛情况，将您的数值结果与球形空腔中中心电荷的解析 Born 能量进行比较：\n$$\n\\Delta G_{\\mathrm{Born}} = -\\frac{1 - 1/\\varepsilon}{2a}\\, q^2,\n$$\n同样以 Hartree 为单位，并报告绝对误差：\n$$\nE = \\left|\\Delta G_{\\mathrm{num}} - \\Delta G_{\\mathrm{Born}}\\right|.\n$$\n\n实现要求：\n\n- 使用等面积面元 $A_i = 4\\pi a^2/N$ 和近似均匀分布在球面上的面元质心 $\\mathbf{r}_i$（例如，通过球面上的斐波那契格点）。如果您在内部使用角度，单位必须是弧度。\n- 使用上述对 $S_{ij}$ 和 $S_{ii}$ 的离散近似，不使用任何其他专门的求积法。\n- 始终使用原子单位：以 Hartree 为单位报告能量。最终的数值输出必须四舍五入到 $8$ 位小数。\n\n测试组：\n\n使用 $q = 1.0$ (基本电荷)，$a = 4.0$ (bohr)，以及以下七个测试用例，每个由一对 $(N,\\varepsilon)$ 指定：\n- 测试 1: $(N, \\varepsilon) = (16, 78.4)$，\n- 测试 2: $(N, \\varepsilon) = (32, 78.4)$，\n- 测试 3: $(N, \\varepsilon) = (64, 78.4)$，\n- 测试 4: $(N, \\varepsilon) = (128, 78.4)$，\n- 测试 5: $(N, \\varepsilon) = (128, 2.0)$，\n- 测试 6: $(N, \\varepsilon) = (128, 200.0)$，\n- 测试 7: $(N, \\varepsilon) = (256, 78.4)$。\n\n对于每个测试用例，计算并返回以 Hartree 为单位的绝对误差 $E$，四舍五入到 $8$ 位小数。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含按上述测试顺序排列的七个误差列表，格式为一个用方括号括起来的逗号分隔列表，例如，“[e1,e2,e3,e4,e5,e6,e7]”。不要打印任何其他文本或字符。",
            "solution": "问题的核心在于求解一个描述溶质与周围电介质连续体之间静电相互作用的积分方程。连续介质的响应通过在空腔表面 $S$ 上感生的表观表面电荷 $\\sigma(\\mathbf{s})$ 来建模。此电荷产生一个反应势 $\\phi_{\\text{reac}}$，该势与溶质相互作用。在表面上一点 $\\mathbf{s'}$ 处求值的控制积分方程为：\n$$\n\\phi_{\\text{reac}}(\\mathbf{s'}) = \\oint_S \\frac{\\sigma(\\mathbf{s})}{\\|\\mathbf{s'} - \\mathbf{s}\\|} dS\n$$\n在原子单位制中，$1/(4\\pi\\varepsilon_0)=1$。该模型通过首先考虑类导体极限（$\\varepsilon \\to \\infty$）来简化，此时电介质表现为完美导体。在这种 COSMO 近似中，空腔表面的总势必须为零。总势是溶质电荷分布产生的势 $\\phi_q$ 和反应势 $\\phi_{\\text{reac}}$ 的总和。因此，在表面上，$\\phi_{\\text{reac}}(\\mathbf{s'}) = -\\phi_q(\\mathbf{s'})$。这为未知的表面电荷密度 $\\sigma(\\mathbf{s})$ 提供了一个直接的积分方程：\n$$\n\\oint_S \\frac{\\sigma(\\mathbf{s})}{\\|\\mathbf{s'} - \\mathbf{s}\\|} dS = -\\phi_q(\\mathbf{s'})\n$$\n为了数值求解此方程，我们采用边界元方法。连续表面 $S$ 被离散化为 $N$ 个小的、不重叠的面元（或镶嵌单元），索引为 $j=1, \\dots, N$。为简单起见并按题目要求，我们假设每个面元具有相等的面积 $A_j = A = 4\\pi a^2/N$ 和恒定的表面电荷密度 $\\sigma_j$。然后，通过应用配置法，将积分方程转换为一个线性代数方程组，其中方程在离散点集上强制满足——在本例中是每个面元的质心 $\\mathbf{r}_i$。离散化后的方程变为：\n$$\n\\sum_{j=1}^N \\sigma_j \\left( \\int_{A_j} \\frac{1}{\\|\\mathbf{r}_i - \\mathbf{s}\\|} dS \\right) = -\\phi_q(\\mathbf{r}_i)\n$$\n这是一个 $S\\boldsymbol{\\sigma} = -\\boldsymbol{\\phi}_q$ 形式的线性系统，其中 $\\boldsymbol{\\sigma}$ 是未知面元电荷密度 $\\{\\sigma_j\\}$ 的向量，$\\boldsymbol{\\phi}_q$ 是在面元质心 $\\{\\phi_{q,i}\\}$ 处求值的溶质势向量。矩阵 $S$ 是影响矩阵，其元素 $S_{ij}$ 代表单位电荷密度在面元 $j$ 上时，在面元 $i$ 的质心处产生的势。问题给出了这些矩阵元素的标准近似：\n- 对于非对角元素（$i \\ne j$），面元 $A_j$ 被视为位于其质心 $\\mathbf{r}_j$ 处，电荷量为 $A_j$ 的点电荷：$S_{ij} \\approx \\frac{A_j}{\\|\\mathbf{r}_i - \\mathbf{r}_j\\|}$。\n- 对于对角元素（$i = j$），面元的自势由一个面积相同、均匀带电的平盘中心的势来近似：$S_{ii} \\approx 2\\sqrt{\\pi A_i}$。\n\n对于位于半径为 $a$ 的球形空腔原点的单个点电荷 $q$ 的特定情况，溶质势在表面所有点上都是恒定的：对所有 $i$ 都有 $\\phi_{q,i} = q/a$。因此，线性系统中的右侧向量的所有元素都等于 $-q/a$。\n\n面元质心 $\\{\\mathbf{r}_i\\}$ 的位置必须近似均匀地分布在球面上，以确保解的稳定性和准确性。斐波那契格点为生成这种分布提供了一种简单有效的方法。\n\n在求解线性系统 $S\\boldsymbol{\\sigma} = -\\boldsymbol{\\phi}_q$ 得到 $\\boldsymbol{\\sigma}$ 后，我们计算电荷 $q$ 所在位置（即原点 $\\mathbf{0}$）的类导体反应势。这通过对所有面元电荷的贡献求和得到：\n$$\n\\Phi_{\\mathrm{reac}}^{(\\infty)} = \\sum_{j=1}^N \\frac{A_j \\sigma_j}{\\|\\mathbf{0} - \\mathbf{r}_j\\|} = \\frac{1}{a} \\sum_{j=1}^N A_j \\sigma_j\n$$\n因为对所有质心都有 $\\|\\mathbf{r}_j\\| = a$。然后，问题利用了针对此特定几何构型的精确结果：对于有限介电常数 $\\varepsilon$ 的反应势可以通过一个简单的缩放因子从类导体势得到：\n$$\n\\Phi_{\\mathrm{reac}}(\\varepsilon) = \\frac{\\varepsilon - 1}{\\varepsilon} \\Phi_{\\mathrm{reac}}^{(\\infty)}\n$$\n静电溶剂化自由能 $\\Delta G_{\\mathrm{num}}$ 是在电介质存在下为溶质充电所做功的一半，由下式给出：\n$$\n\\Delta G_{\\mathrm{num}} = \\frac{1}{2} q \\Phi_{\\mathrm{reac}}(\\varepsilon)\n$$\n为了评估我们数值 BEM 方案的准确性，我们将此结果与此问题的精确解析解——Born 能量进行比较：\n$$\n\\Delta G_{\\mathrm{Born}} = -\\frac{1 - 1/\\varepsilon}{2a} q^2\n$$\n绝对误差 $E = |\\Delta G_{\\mathrm{num}} - \\Delta G_{\\mathrm{Born}}|$ 作为收敛性的度量。随着面元数量 $N$ 的增加，离散化变得更精细，这个误差预计会减小，从而证明数值近似向真实连续介质解的收敛。该实现将为一系列具有不同 $N$ 和 $\\varepsilon$ 的测试用例系统地计算此误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_case(N, epsilon, q, a):\n    \"\"\"\n    Calculates the absolute error of the BEM solvation energy for a given test case.\n\n    Args:\n        N (int): Number of tessellation panels.\n        epsilon (float): Relative permittivity of the continuum.\n        q (float): Charge of the point solute in atomic units.\n        a (float): Radius of the spherical cavity in bohr.\n\n    Returns:\n        float: The absolute error E = |delta_g_num - delta_g_born|.\n    \"\"\"\n    # Step 1: Generate N approximately uniform points on a sphere of radius 'a'.\n    # A Fibonacci lattice (or golden spiral) is used for this purpose.\n    points = np.zeros((N, 3))\n    golden_angle = np.pi * (3. - np.sqrt(5.))\n    indices = np.arange(N)\n\n    # The y-coordinates are distributed evenly from -1 to 1, then scaled by 'a'.\n    y = a * (1. - (2 * indices + 1) / N)\n    \n    # The radius of the circle at each height 'y'.\n    radius_at_y = np.sqrt(a**2 - y**2)\n    \n    # The angle for each point, using the golden angle for even distribution.\n    theta = golden_angle * indices\n    \n    x = np.cos(theta) * radius_at_y\n    z = np.sin(theta) * radius_at_y\n    \n    points = np.vstack([x, y, z]).T\n\n    # Step 2: Construct the influence matrix S.\n    S = np.zeros((N, N))\n    # Area of each panel is the total surface area divided by N.\n    A = 4. * np.pi * a**2 / N\n    \n    # Calculate the pairwise distance matrix between all panel centroids.\n    # This is done efficiently using NumPy broadcasting.\n    diffs = points[:, np.newaxis, :] - points[np.newaxis, :, :]\n    distances = np.linalg.norm(diffs, axis=2)\n    \n    # To avoid division by zero in the next step, temporarily set diagonal to 1.\n    np.fill_diagonal(distances, 1.0)\n    \n    # Calculate off-diagonal elements S_ij = A / ||r_i - r_j||.\n    S = A / distances\n    \n    # Calculate diagonal elements S_ii using the provided approximation.\n    S_ii = 2. * np.sqrt(np.pi * A)\n    np.fill_diagonal(S, S_ii)\n    \n    # Step 3: Construct the right-hand side vector b = -phi_q.\n    # For a central charge q, the potential is constant on the surface.\n    phi_q = q / a\n    b = np.full(N, -phi_q)\n    \n    # Step 4: Solve the linear system S*sigma = b for the charge densities sigma.\n    sigma = np.linalg.solve(S, b)\n    \n    # Step 5: Calculate the conductor-like reaction potential at the origin.\n    phi_reac_inf = (1. / a) * np.sum(A * sigma)\n    \n    # Step 6: Scale the potential for a finite dielectric constant epsilon.\n    phi_reac_eps = ((epsilon - 1.) / epsilon) * phi_reac_inf\n    \n    # Step 7: Compute the numerical electrostatic solvation free energy.\n    delta_g_num = 0.5 * q * phi_reac_eps\n    \n    # Step 8: Compute the exact analytical Born energy for comparison.\n    delta_g_born = -(1. - 1./epsilon) / (2. * a) * q**2\n    \n    # Step 9: Compute the absolute error between numerical and analytical results.\n    error = np.abs(delta_g_num - delta_g_born)\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    # Define physical constants and problem parameters from the statement.\n    q = 1.0  # Elementary charge\n    a = 4.0  # Bohr radius\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, epsilon)\n        (16, 78.4),\n        (32, 78.4),\n        (64, 78.4),\n        (128, 78.4),\n        (128, 2.0),\n        (128, 200.0),\n        (256, 78.4)\n    ]\n\n    results = []\n    for N, epsilon in test_cases:\n        # Calculate the error for each case.\n        error = solve_case(N, epsilon, q, a)\n        results.append(error)\n\n    # Format the final results list for output, rounding each error to 8 decimal places.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了理论和数值实现后，认识到隐式溶剂模型的内在局限性也同样至关重要。本练习是一个批判性思维挑战，它直接拷问了连续介质假设本身。通过分析一个含有结构上至关重要的深埋水分子的蛋白质折叠问题，本练习促使我们评估模型忽略了哪些关键的物理现象——例如特定的氢键网络、构象熵以及水分子的离散性，并理解为何这些忽略会导致预测出现重大偏差 ()。",
            "id": "2456154",
            "problem": "一种蛋白质折叠成一个紧凑状态，其中一个结构上至关重要的水分子被深深地埋藏在一个疏水空腔中，并形成 $2$ 个氢键来连接极性侧链。在未折叠状态下，这个水分子没有特异性结合，并与主体溶剂快速交换。你考虑使用隐式溶剂描述，即广义波恩（GB）模型或泊松-玻尔兹曼（PB）模型，来建模折叠的热力学。在这两种模型中，溶剂被视为介电常数为 $\\varepsilon_{\\text{out}}$ 的介电连续体，溶质具有内部介电常数 $\\varepsilon_{\\text{in}}$，并且不包含任何显式水分子。PB 模型求解形式为 $-\\nabla \\cdot \\left(\\varepsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r})\\right) = \\rho_{\\text{fixed}}(\\mathbf{r}) + \\rho_{\\text{mobile}}(\\mathbf{r})$ 的静电边值问题，其中 $\\rho_{\\text{mobile}}(\\mathbf{r})$ 代表离子的平均场分布；而 GB 模型通过有效波恩半径，为源于溶剂连续体的静电反应场自由能提供了解析近似。典型的实现会添加一个依赖于溶剂可及表面积的非极性自由能项。\n\n下列哪些陈述指出了在这些条件下使用 GB/PB 隐式溶剂模型研究该蛋白质折叠的根本性局限？选择所有适用项。\n\nA. 由于溶剂被表示为一个无特征的介电介质，GB/PB 无法表示单个埋藏水分子的离散占据、取向和方向性，也无法表示其特异性氢键；除非该水分子被显式建模，否则其对折叠状态的稳定作用将被系统性地错误表征。\n\nB. 在 PB 计算中，通过将容纳埋藏水分子的空腔区域的介电常数设为 $\\varepsilon(\\mathbf{r}) = \\varepsilon_{\\text{out}}$ 并使用主体离子强度，可以在不显式包含该水分子的情况下，精确地恢复其提供的稳定作用。\n\nC. 平均场连续体处理忽略了被捕获水分子的构象熵和交换动力学，因此即使静电势在其他方面是准确的，计算出的折叠自由能和能垒也可能存在偏差。\n\nD. 与 GB/PB 一起使用的标准非极性项（通常与溶剂可及表面积成正比）没有考虑形成一个纳米级空腔并用单个水分子填充它以及其色散相互作用的详细自由能，从而导致含水折叠状态的稳定性计算出现误差。\n\nE. GB/PB 模型沿折叠路径的预测内在地对原子半径的选择和介电边界的构建敏感；随着介电边界的变形，这会引入非物理的不连续性和依赖于参数的人为效应，从而影响折叠的热力学和动力学。",
            "solution": "问题中概述的核心挑战是，使用一个将溶剂视为无结构、均匀连续体的模型，来处理一个通过氢键发挥特定结构作用的单个、离散的水分子。像泊松-玻尔兹曼（PB）和广义波恩（GB）这样的隐式溶剂模型，旨在捕捉大量溶剂分子（主体溶剂）的平均静电和非极性效应，而不是单个、空间受限且取向有序的溶剂分子的特定行为。模型的局限性将直接源于这种根本性的不匹配。\n\n**选项 A 分析**\n该陈述断言，由于溶剂是一个无特征的介电介质，GB/PB 模型无法表示埋藏水分子的离散占据、特定取向和氢键方向性。因此，其稳定作用被错误地表征。这是一个正确且根本性的批评。一个介电常数为 $\\varepsilon_{\\text{out}}$（对于水，通常约为 80）的连续体没有单个分子的概念，更不用说它们的位置、取向或氢键的量子力学性质。埋藏水分子形成的 $2$ 个氢键的特定几何结构对稳定折叠结构至关重要，但在连续体描述中完全丢失了。该模型只捕捉了平均场静电屏蔽效应。因此，这个特定相互作用网络的能量贡献没有被正确捕捉。\n此选项的结论是**正确**。\n\n**选项 B 分析**\n该陈述提出了一个“修复方案”：通过将其介电常数设为 $\\varepsilon(\\mathbf{r}) = \\varepsilon_{\\text{out}}$ 并应用主体离子强度，将空腔视为主体水。它声称这将*精确地*恢复稳定作用。这个提议是荒谬的。将空腔内部的介电常数设置为像 $\\varepsilon_{\\text{out}} \\approx 80$ 这样的高值，会极大地*削弱*水分子本应连接的极性侧链之间的静电相互作用。它会几乎完全屏蔽它们的电荷，导致天然折叠的去稳定化，而不是稳定化。此外，声称*精确地*恢复能量学是荒谬的。这种粗糙的操作忽略了捕获水分子的熵成本、特定的色散相互作用以及氢键的精确几何排列。该陈述描述了一个会产生物理上不正确结果的过程。\n此选项的结论是**错误**。\n\n**选项 C 分析**\n该陈述指出，连续体处理忽略了被捕获水分子的构象熵。当水分子从主体溶剂移动到受限空腔中时，它会损失大量的平动和转动熵。这种熵罚是一个真实的热力学成本，对总折叠自由能 $\\Delta G_{\\text{folding}}$ 有贡献。由于隐式溶剂模型不包含显式水分子，它无法解释水分子构象熵的这种变化。这种遗漏导致计算出的折叠自由能存在系统性偏差。该陈述还正确地指出，作为动力学性质的交换动力学，完全超出了这些平衡溶剂化模型的范围。因此，热力学稳定性和动力学能垒都可能不准确。\n此选项的结论是**正确**。\n\n**选项 D 分析**\n该陈述批评了标准的非极性项，该项通常与溶剂可及表面积（SASA）成正比，常表示为 $\\Delta G_{\\text{nonpolar}} = \\gamma \\cdot \\text{SASA} + b$。该项是一个唯象近似，旨在在平均的、宏观尺度上捕捉两种效应：在溶剂中创建溶质大小空腔的自由能成本，以及溶质与溶剂之间有利的范德华（色散）相互作用。这个经验公式并非源自能够准确描述将单个水分子以特定几何形状填充到纳米级空腔中以及所涉及的详细色散力的微观理论。填充一个小的、预先组织的空洞的物理学与溶剂化一个大的、暴露的非极性表面的物理学是不同的。当处理复杂的内部空腔和埋藏水分子位点时，使用简单的基于 SASA 的项是一个已知的缺陷。\n此选项的结论是**正确**。\n\n**选项 E 分析**\n该陈述指出了 GB/PB 模型的一个普遍但高度相关的局限性：它们对输入参数选择的敏感性，特别是定义介电边界的原子半径。低介电常数溶质（$\\varepsilon_{\\text{in}}$）和高介电常数溶剂（$\\varepsilon_{\\text{out}}$）之间的边界是该模型的关键构建部分。其精确位置和形状取决于所选的原子半径集，会对计算出的溶剂化自由能产生巨大影响。在蛋白质折叠的模拟过程中，蛋白质的构象发生变化，导致介电边界变形。如果构建此边界的算法相对于原子坐标不是完全光滑和可微的，它可能会在势能面上引入非物理的能量波动或“噪声”。这些人為效应会错误地改变计算出的自由能差异并产生伪能垒，从而影响折叠的热力学和动力学预测。这是建模方法本身的一个根本性局限，在研究像折叠这样的大构象变化时尤其成问题。\n此选项的结论是**正确**。\n\n总之，陈述 A、C、D 和 E 都指出了使用标准 GB/PB 隐式溶剂模型研究上述折叠过程的有效且根本性的局限。",
            "answer": "$$\\boxed{ACDE}$$"
        }
    ]
}