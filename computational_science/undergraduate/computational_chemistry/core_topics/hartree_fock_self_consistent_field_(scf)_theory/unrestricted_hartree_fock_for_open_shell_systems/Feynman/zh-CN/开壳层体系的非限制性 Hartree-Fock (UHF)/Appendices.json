{
    "hands_on_practices": [
        {
            "introduction": "要真正理解非限制性 Hartree-Fock (UHF) 方法，我们必须从最基础的知识入手。第一个练习将挑战你将 UHF 方程应用于最简单的开壳层体系：一个氢原子。通过手动推导轨道能量和自旋期望值 $\\langle\\hat{S}^2\\rangle$，你将具体地理解自旋轨道的分裂是如何产生的，以及为什么这个简单情况没有自旋污染。",
            "id": "2466566",
            "problem": "在用于开壳层体系的非限制哈特里-福克（UHF）理论中，自旋分辨的福克算符取决于自旋密度，并包含库仑项和交换项。考虑一个在原子单位下，用由单个归一化斯莱特型轨道 $|\\phi\\rangle$ 组成的最小基组描述的氢原子，该轨道对应于指数 $\\zeta = 1$ 的类氢 $1s$ 函数。假设存在一个自旋为 $\\alpha$ 的单电子，因此占据数为 $n_{\\alpha} = 1$ 和 $n_{\\beta} = 0$。给定此基组下的以下积分：\n- 单电子（核心哈密顿量）期望值 $h \\equiv \\langle \\phi | \\hat{h} | \\phi \\rangle = -\\frac{1}{2}$，其中 $\\hat{h}$ 是单电子哈密顿量。\n- 双电子库仑自积分 $J \\equiv (\\phi\\phi|\\phi\\phi) = \\frac{5}{8}$。\n- 对于相同的轨道，交换积分等于库仑自积分，因此 $K = J$。\n\n从非限制哈特里-福克算符的定义出发，仅使用上述数据以及库仑和交换算符的基本性质，推导在此单函数基组中 $\\alpha$ 和 $\\beta$ 自旋的标量福克矩阵元，确定相应的轨道能 $\\varepsilon_{\\alpha}$ 和 $\\varepsilon_{\\beta}$，并计算此单电子体系的 UHF 行列式的总自旋平方算符期望值 $\\langle S^2 \\rangle$。\n\n以哈特里为单位提供 $\\varepsilon_{\\alpha}$ 和 $\\varepsilon_{\\beta}$ 的精确值，并以纯数形式提供 $\\langle S^2 \\rangle$ 的精确值。您的最终答案必须是包含 $\\varepsilon_{\\alpha}$、$\\varepsilon_{\\beta}$ 和 $\\langle S^2 \\rangle$ 的单行，并按此顺序排列，使用精确分数（不要四舍五入）。",
            "solution": "该问题被验证为具有科学依据、提法恰当且客观。这是非限制哈特里-福克（UHF）理论在一个最小体系（氢原子）上的标准应用，可以在该模型内推导出精确解。所有必要数据均已提供，且无内部矛盾。我们可以开始求解。\n\n自旋为 $\\alpha$ 和 $\\beta$ 的电子的 UHF 福克算符由下式给出：\n$$ \\hat{F}^{\\alpha} = \\hat{h} + \\hat{J}^{\\alpha} + \\hat{J}^{\\beta} - \\hat{K}^{\\alpha} $$\n$$ \\hat{F}^{\\beta} = \\hat{h} + \\hat{J}^{\\alpha} + \\hat{J}^{\\beta} - \\hat{K}^{\\beta} $$\n其中 $\\hat{h}$ 是单电子（核心）哈密顿量，$\\hat{J}^{\\sigma}$ 和 $\\hat{K}^{\\sigma}$ 分别是自旋为 $\\sigma$ 的总库仑算符和交换算符。这些算符由被电子占据的自旋轨道构建而成。\n\n在原子轨道基组 $\\{|\\phi_{\\mu}\\rangle\\}$ 中，福克算符的矩阵元为：\n$$ F_{\\mu\\nu}^{\\sigma} = h_{\\mu\\nu} + \\sum_{\\lambda\\rho} (P_{\\lambda\\rho}^{\\alpha} + P_{\\lambda\\rho}^{\\beta}) (\\mu\\nu|\\lambda\\rho) - \\sum_{\\lambda\\rho} P_{\\lambda\\rho}^{\\sigma} (\\mu\\lambda|\\nu\\rho) $$\n这里，$h_{\\mu\\nu} = \\langle \\phi_{\\mu} | \\hat{h} | \\phi_{\\nu} \\rangle$ 是单电子积分，$(\\mu\\nu|\\lambda\\rho)$ 是双电子排斥积分，$P^{\\sigma}$ 是自旋为 $\\sigma$ 的自旋密度矩阵。\n\n在给定问题中，基组由单个归一化的原子轨道 $|\\phi\\rangle$ 构成。因此，所有矩阵指数 $(\\mu, \\nu, \\lambda, \\rho)$ 皆等于 $1$，矩阵变为标量。我们将此单基函数表示为 $|\\phi_1\\rangle \\equiv |\\phi\\rangle$。分子轨道系数是平凡的；单个 $\\alpha$ 分子轨道为 $|\\psi^{\\alpha}\\rangle=|\\phi\\rangle$，虚 $\\beta$ 分子轨道为 $|\\psi^{\\beta}\\rangle=|\\phi\\rangle$。给定的占据数为 $n_{\\alpha} = 1$ 和 $n_{\\beta} = 0$。\n\n自旋密度矩阵是 $1 \\times 1$ 的矩阵（标量），由 $P^{\\sigma} = C^{\\sigma} n^{\\sigma} (C^{\\sigma})^\\dagger$ 给出。因为分子轨道就是基函数，所以系数矩阵为 $C^{\\alpha} = C^{\\beta} = [1]$。\n$\\alpha$ 自旋密度矩阵元为 $P_{11}^{\\alpha} = (1)(1)(1)^* = 1$。\n$\\beta$ 自旋密度矩阵元为 $P_{11}^{\\beta} = (1)(0)(1)^* = 0$。\n总密度矩阵元为 $P_{11} = P_{11}^{\\alpha} + P_{11}^{\\beta} = 1 + 0 = 1$。\n\n因此，标量福克矩阵元 $F^{\\alpha}$ 和 $F^{\\beta}$ 为：\n$$ F^{\\alpha} = F_{11}^{\\alpha} = h_{11} + P_{11} (11|11) - P_{11}^{\\alpha} (11|11) $$\n$$ F^{\\beta} = F_{11}^{\\beta} = h_{11} + P_{11} (11|11) - P_{11}^{\\beta} (11|11) $$\n注意，对于单个轨道，交换积分 $(\\phi_1\\phi_1|\\phi_1\\phi_1)$ 与库仑积分相同，所以 $K_{11} = J_{11} = (11|11)$，正如问题所述。给定的数据为：\n$h \\equiv h_{11} = -\\frac{1}{2}$\n$J \\equiv (11|11) = \\frac{5}{8}$\n\n现在，我们代入密度矩阵元和积分值。\n对于 $\\alpha$ 自旋福克矩阵元：\n$$ F^{\\alpha} = h + (P_{11}^{\\alpha} + P_{11}^{\\beta})J - P_{11}^{\\alpha}J = h + P_{11}^{\\beta}J $$\n$$ F^{\\alpha} = -\\frac{1}{2} + (0) \\left(\\frac{5}{8}\\right) = -\\frac{1}{2} $$\n这个结果在物理上是正确的。单个 $\\alpha$ 电子不与其他电子相互作用，因此其能量完全由核心哈密顿量决定。\n\n对于 $\\beta$ 自旋福克矩阵元：\n$$ F^{\\beta} = h + (P_{11}^{\\alpha} + P_{11}^{\\beta})J - P_{11}^{\\beta}J = h + P_{11}^{\\alpha}J $$\n$$ F^{\\beta} = -\\frac{1}{2} + (1) \\left(\\frac{5}{8}\\right) = -\\frac{4}{8} + \\frac{5}{8} = \\frac{1}{8} $$\n这代表一个虚 $\\beta$ 电子的能量，它受到原子核的吸引（$h$ 项）和来自现有 $\\alpha$ 电子的排斥（$J$ 项）。\n\n轨道能 $\\varepsilon_{\\alpha}$ 和 $\\varepsilon_{\\beta}$ 分别是对应福克矩阵的本征值。由于这些矩阵是标量，轨道能即为矩阵元本身。\n$$ \\varepsilon_{\\alpha} = F^{\\alpha} = -\\frac{1}{2} $$\n$$ \\varepsilon_{\\beta} = F^{\\beta} = \\frac{1}{8} $$\n\n最后，我们计算总自旋平方算符的期望值 $\\langle S^2 \\rangle$。对于单行列式 UHF 波函数，其通用公式为：\n$$ \\langle \\hat{S}^2 \\rangle = \\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}\\right)\\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}+1\\right) + N_{\\beta} - \\sum_{i}^{N_{\\alpha}} \\sum_{j}^{N_{\\beta}} |\\langle \\psi_i^{\\alpha} | \\psi_j^{\\beta} \\rangle|^2 $$\n其中 $N_{\\alpha}$ 和 $N_{\\beta}$ 分别是 $\\alpha$ 和 $\\beta$ 电子的数量，求和遍及所有占据的分子轨道。\n\n在此体系中，我们有 $N_{\\alpha} = 1$ 和 $N_{\\beta} = 0$。第一项是最大自旋投影态的自旋平方值，$S(S+1)$，其中 $S = \\langle S_z \\rangle = \\frac{1}{2}(N_{\\alpha}-N_{\\beta})$。\n$$ \\langle S_z \\rangle = \\frac{1}{2}(1-0) = \\frac{1}{2} $$\n求和项代表自旋污染。由于 $N_{\\beta}=0$，对 $j$ 的求和为空，其值为零。\n$$ \\sum_{i}^{1} \\sum_{j}^{0} |\\langle \\psi_i^{\\alpha} | \\psi_j^{\\beta} \\rangle|^2 = 0 $$\n因此，$\\langle S^2 \\rangle$ 的表达式可大幅简化为：\n$$ \\langle \\hat{S}^2 \\rangle = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}+1\\right) + 0 - 0 $$\n$$ \\langle \\hat{S}^2 \\rangle = \\left(\\frac{1}{2}\\right)\\left(\\frac{3}{2}\\right) = \\frac{3}{4} $$\n这个结果 $\\frac{3}{4}$ 等价于 $s=\\frac{1}{2}$ 时的 $s(s+1)$，这是一个纯双重态的精确值。对于单电子体系，UHF 波函数必然是 $\\hat{S}^2$ 的本征函数，因此不存在自旋污染。\n\n所求的值为 $\\varepsilon_{\\alpha} = -\\frac{1}{2}$、$\\varepsilon_{\\beta} = \\frac{1}{8}$ 和 $\\langle S^2 \\rangle = \\frac{3}{4}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{2} & \\frac{1}{8} & \\frac{3}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "UHF 方法的一个关键问题是自旋污染，即得到的波函数不是一个纯粹的自旋本征态。本练习通过考虑一个由纯自旋态混合而成的假设波函数，对这个问题进行了清晰、定量的审视。计算这个混合态的期望值 $\\langle\\hat{S}^2\\rangle$ 将帮助你解释计算化学软件报告的 $\\langle\\hat{S}^2\\rangle$ 值的含义。",
            "id": "2466590",
            "problem": "对一个开壳层体系进行非限制Hartree-Fock (UHF)计算，由于自旋污染，会得到一个归一化的波函数，但它不是总自旋平方算符 $\\hat{S}^{2}$ 的本征函数。假设该UHF波函数可以写成两个正交归一的纯自旋本征态的归一化叠加，\n$$|\\Psi\\rangle = c_{D}\\,|S=\\tfrac{1}{2}\\rangle + c_{Q}\\,|S=\\tfrac{3}{2}\\rangle$$\n其中 $|S=\\tfrac{1}{2}\\rangle$（双重态）和 $|S=\\tfrac{3}{2}\\rangle$（四重态）是 $\\hat{S}^{2}$ 的精确本征态，并且这种叠加是等量混合的，即 $|c_{D}|^{2} = |c_{Q}|^{2} = \\tfrac{1}{2}$。计算 $|\\Psi\\rangle$ 的期望值 $\\langle \\hat{S}^{2} \\rangle$（以 $\\hbar^{2}$ 为单位），并以单个精确数值的形式报告你的答案，不带单位。不要对答案进行四舍五入。",
            "solution": "该问题是量子化学领域中一个有效且适定的问题，具体涉及非限制Hartree-Fock (UHF)方法中的自旋污染概念。该问题具有科学依据，并包含了进行严谨求解所需的所有信息。我们将着手进行推导。\n\n体系的状态由两个正交归一的纯自旋本征态——一个双重态 $|S=\\frac{1}{2}\\rangle$ 和一个四重态 $|S=\\frac{3}{2}\\rangle$——的归一化线性组合给出：\n$$|\\Psi\\rangle = c_{D}\\,|S=\\tfrac{1}{2}\\rangle + c_{Q}\\,|S=\\tfrac{3}{2}\\rangle$$\n问题指出，这种叠加是等量混合的，意味着发现体系处于双重态和四重态的概率相等：\n$$|c_{D}|^{2} = |c_{Q}|^{2} = \\frac{1}{2}$$\n归一化条件得到满足，因为 $|c_{D}|^{2} + |c_{Q}|^{2} = \\frac{1}{2} + \\frac{1}{2} = 1$。态 $|S=\\frac{1}{2}\\rangle$ 和 $|S=\\frac{3}{2}\\rangle$ 是正交归一的，这意味着 $\\langle S=s | S=s' \\rangle = \\delta_{ss'}$。\n\n我们的任务是计算总自旋平方算符的期望值 $\\langle \\hat{S}^{2} \\rangle$。根据定义，它由以下表达式给出：\n$$\\langle \\hat{S}^{2} \\rangle = \\langle \\Psi | \\hat{S}^{2} | \\Psi \\rangle$$\n将左矢 $\\langle \\Psi | = c_{D}^{*}\\,\\langle S=\\tfrac{1}{2}| + c_{Q}^{*}\\,\\langle S=\\tfrac{3}{2}|$ 和右矢 $|\\Psi\\rangle$ 的表达式代入，我们得到：\n$$\\langle \\hat{S}^{2} \\rangle = \\left( c_{D}^{*}\\,\\langle S=\\tfrac{1}{2}| + c_{Q}^{*}\\,\\langle S=\\tfrac{3}{2}| \\right) \\hat{S}^{2} \\left( c_{D}\\,|S=\\tfrac{1}{2}\\rangle + c_{Q}\\,|S=\\tfrac{3}{2}\\rangle \\right)$$\n算符 $\\hat{S}^{2}$ 是线性的。我们可以先将它作用于右矢：\n$$\\hat{S}^{2} | \\Psi \\rangle = c_{D}\\,(\\hat{S}^{2}|S=\\tfrac{1}{2}\\rangle) + c_{Q}\\,(\\hat{S}^{2}|S=\\tfrac{3}{2}\\rangle)$$\n根据定义，态 $|S=s\\rangle$ 是算符 $\\hat{S}^{2}$ 的本征态，其本征值为 $s(s+1)\\hbar^{2}$。\n对于双重态，$s=\\frac{1}{2}$，所以本征值为：\n$$s(s+1)\\hbar^{2} = \\frac{1}{2}\\left(\\frac{1}{2}+1\\right)\\hbar^{2} = \\frac{1}{2}\\left(\\frac{3}{2}\\right)\\hbar^{2} = \\frac{3}{4}\\hbar^{2}$$\n因此，$\\hat{S}^{2}|S=\\frac{1}{2}\\rangle = \\frac{3}{4}\\hbar^{2}|S=\\frac{1}{2}\\rangle$。\n\n对于四重态，$s=\\frac{3}{2}$，所以本征值为：\n$$s(s+1)\\hbar^{2} = \\frac{3}{2}\\left(\\frac{3}{2}+1\\right)\\hbar^{2} = \\frac{3}{2}\\left(\\frac{5}{2}\\right)\\hbar^{2} = \\frac{15}{4}\\hbar^{2}$$\n因此，$\\hat{S}^{2}|S=\\frac{3}{2}\\rangle = \\frac{15}{4}\\hbar^{2}|S=\\frac{3}{2}\\rangle$。\n\n将这些结果代回到 $\\hat{S}^{2} | \\Psi \\rangle$ 的表达式中：\n$$\\hat{S}^{2} | \\Psi \\rangle = c_{D}\\left(\\frac{3}{4}\\hbar^{2}\\right)|S=\\tfrac{1}{2}\\rangle + c_{Q}\\left(\\frac{15}{4}\\hbar^{2}\\right)|S=\\tfrac{3}{2}\\rangle$$\n现在，我们计算完整的表达式 $\\langle \\Psi | (\\hat{S}^{2} | \\Psi \\rangle)$：\n$$\\langle \\hat{S}^{2} \\rangle = \\left( c_{D}^{*}\\,\\langle S=\\tfrac{1}{2}| + c_{Q}^{*}\\,\\langle S=\\tfrac{3}{2}| \\right) \\left( c_{D}\\frac{3}{4}\\hbar^{2}|S=\\tfrac{1}{2}\\rangle + c_{Q}\\frac{15}{4}\\hbar^{2}|S=\\tfrac{3}{2}\\rangle \\right)$$\n展开此表达式得到四项：\n$$\\langle \\hat{S}^{2} \\rangle = c_{D}^{*}c_{D}\\frac{3}{4}\\hbar^{2}\\langle S=\\tfrac{1}{2}|S=\\tfrac{1}{2}\\rangle + c_{D}^{*}c_{Q}\\frac{15}{4}\\hbar^{2}\\langle S=\\tfrac{1}{2}|S=\\tfrac{3}{2}\\rangle + c_{Q}^{*}c_{D}\\frac{3}{4}\\hbar^{2}\\langle S=\\tfrac{3}{2}|S=\\tfrac{1}{2}\\rangle + c_{Q}^{*}c_{Q}\\frac{15}{4}\\hbar^{2}\\langle S=\\tfrac{3}{2}|S=\\tfrac{3}{2}\\rangle$$\n由于自旋本征态的正交归一性，$\\langle S=\\frac{1}{2}|S=\\frac{3}{2}\\rangle = 0$ 且 $\\langle S=\\frac{3}{2}|S=\\frac{1}{2}\\rangle = 0$，这使得交叉项消失。每个态的归一性给出 $\\langle S=\\frac{1}{2}|S=\\frac{1}{2}\\rangle = 1$ 和 $\\langle S=\\frac{3}{2}|S=\\frac{3}{2}\\rangle = 1$。表达式简化为：\n$$\\langle \\hat{S}^{2} \\rangle = |c_{D}|^{2}\\frac{3}{4}\\hbar^{2} + |c_{Q}|^{2}\\frac{15}{4}\\hbar^{2}$$\n这是算符在其本征态的叠加态中的期望值的一般结果。该期望值是本征值的加权平均值，其中权重是测量到每个本征值的概率。\n\n给定条件为 $|c_{D}|^{2} = \\frac{1}{2}$ 和 $|c_{Q}|^{2} = \\frac{1}{2}$。代入这些值：\n$$\\langle \\hat{S}^{2} \\rangle = \\left(\\frac{1}{2}\\right)\\frac{3}{4}\\hbar^{2} + \\left(\\frac{1}{2}\\right)\\frac{15}{4}\\hbar^{2}$$\n提取公因式：\n$$\\langle \\hat{S}^{2} \\rangle = \\frac{1}{2}\\hbar^{2}\\left(\\frac{3}{4} + \\frac{15}{4}\\right) = \\frac{1}{2}\\hbar^{2}\\left(\\frac{18}{4}\\right) = \\frac{1}{2}\\hbar^{2}\\left(\\frac{9}{2}\\right) = \\frac{9}{4}\\hbar^{2}$$\n问题要求以 $\\hbar^{2}$ 为单位给出数值。因此，数值答案是：\n$$\\frac{\\langle \\hat{S}^{2} \\rangle}{\\hbar^{2}} = \\frac{9}{4}$$\n该结果是所要求的精确数值。",
            "answer": "$$\\boxed{\\frac{9}{4}}$$"
        },
        {
            "introduction": "现在，让我们通过构建一个计算模型来连接理论与实践。这个高级练习将指导你为烯丙基自由基（一个经典的离域开壳层体系）实现一个最小化的 UHF-SCF 计算。通过模拟自旋污染如何随分子几何结构变化，你将获得 SCF 程序的实践经验，并了解 UHF 的一些计算“瑕疵”如何能提供物理洞见。",
            "id": "2466609",
            "problem": "您将为烯丙基自由基实现一个最小的非限制性Hartree-Fock (UHF) 模型，以研究自旋污染如何依赖于中心碳-碳-碳键角的形变。烯丙基自由基被建模为一个三位点三角形碳链，在其离域 $\\pi$ 体系中携带一个未成对电子，碳-碳-键长固定，中心键角可变。目标是计算自旋污染，其定义为总自旋平方算符的期望值超过精确自旋值的部分，并研究其如何随键角变化。\n\n从以下物理上合理的依据和定义开始。\n\n1. 对 $\\pi$ 体系使用一个三位点单带Hubbard哈密顿量，\n$$\n\\hat{H} = \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\sum_{i,j=1}^{3} t_{ij} \\hat{c}^{\\dagger}_{i\\sigma} \\hat{c}_{j\\sigma} + U \\sum_{i=1}^{3} \\hat{n}_{i\\alpha} \\hat{n}_{i\\beta},\n$$\n其中 $t_{ij}$ 是位点 $i$ 和 $j$ 之间的单电子跃迁积分，$U$ 是在位库仑排斥，$\\hat{c}^{\\dagger}_{i\\sigma}$ 和 $\\hat{c}_{i\\sigma}$ 分别是位点 $i$ 上自旋为 $\\sigma$ 的电子的产生和湮灭算符，且 $\\hat{n}_{i\\sigma} = \\hat{c}^{\\dagger}_{i\\sigma} \\hat{c}_{i\\sigma}$。假设每个碳原子上有一个由类 $p_z$ 轨道组成的最小正交归一基组。\n\n2. 按如下方式对单电子跃迁矩阵 $T = [t_{ij}]$ 进行建模。设最近邻跃迁为常数且等于 $t_{12} = t_{21} = t_{23} = t_{32} = t_0$，并设末端碳原子之间的穿透空间的次近邻耦合为 $t_{13} = t_{31} = t_{13}(\\theta)$，它依赖于中心角 $\\theta$。在键长 $a$ 固定的情况下，末端距离为\n$$\nR_{13}(\\theta) = 2 a \\sin\\!\\left(\\frac{\\theta}{2}\\right).\n$$\n假设耦合形式为随距离衰减，\n$$\nt_{13}(\\theta) = \\operatorname{sgn}(t_0) \\, c \\, |t_0| \\exp\\!\\left[ -\\beta \\left( R_{13}(\\theta) - R_{\\mathrm{ref}} \\right) \\right],\n$$\n其中 $R_{\\mathrm{ref}} = 2 a \\sin\\!\\left( \\frac{\\pi}{3} \\right)$ 是当 $\\theta = 120^\\circ$ 时的末端间距，$c$ 是一个无量纲预因子，$\\beta$ 是一个逆衰减长度。\n\n3. 对Hubbard相互作用进行自洽平均场解耦，以获得非限制性Hartree-Fock (UHF) 的依赖于自旋的Fock矩阵：\n$$\nF^{\\alpha} = T + U \\, \\mathrm{diag}\\!\\left(n^{\\beta}_1 - \\frac{1}{2}, \\, n^{\\beta}_2 - \\frac{1}{2}, \\, n^{\\beta}_3 - \\frac{1}{2} \\right),\n$$\n$$\nF^{\\beta} = T + U \\, \\mathrm{diag}\\!\\left(n^{\\alpha}_1 - \\frac{1}{2}, \\, n^{\\alpha}_2 - \\frac{1}{2}, \\, n^{\\alpha}_3 - \\frac{1}{2} \\right),\n$$\n其中 $n^{\\sigma}_i$ 是自旋 $\\sigma$ 的位点布居数。使用 $N_{\\alpha} = 2$ 和 $N_{\\beta} = 1$，对应于烯丙基自由基中的3个 $\\pi$ 电子。用单位占据数占据 $F^{\\sigma}$ 的 $N_{\\sigma}$ 个最低能量本征态。迭代直至达到自洽。\n\n4. 从总自旋算符的二次量子化定义以及UHF波函数在正交归一基组中的结构，推导出一个可从已占据的 $\\alpha$ 和 $\\beta$ 分子轨道计算出的期望值 $ \\langle \\hat{S}^2 \\rangle $ 的表达式。然后将自旋污染定义为\n$$\n\\Delta = \\langle \\hat{S}^2 \\rangle - S(S+1),\n$$\n对于双重态，有 $S = \\frac{1}{2}$。您的程序必须仅使用从UHF解中可获得的量来计算 $\\Delta$。\n\n使用以下参数值和数值设定：\n- 碳-碳键长 $a = 1.40 \\, \\text{Å}$。\n- 最近邻跃迁 $t_0 = -2.50 \\, \\text{eV}$。\n- 在位库仑排斥 $U = 6.00 \\, \\text{eV}$。\n- 穿透空间耦合预因子 $c = 0.10$ (无量纲)。\n- 衰减常数 $\\beta = 1.50 \\, \\text{Å}^{-1}$。\n- 参考距离 $R_{\\mathrm{ref}} = 2 a \\sin\\!\\left( 60^\\circ \\right)$。\n- 阻尼（线性混合）因子 $m = 0.50$ 用于位点布居数。\n- 收敛容限 $\\varepsilon = 10^{-10}$ 用于位点布居数的最大绝对变化。\n- 最大自洽迭代次数 $N_{\\mathrm{it,max}} = 10{,}000$。\n\n角度单位和测试组：\n- 使用以度为单位的角度 $\\theta$。\n- 按照此确切顺序评估中心角测试组 $\\Theta = [180, 150, 120, 100, 90]$ 度。\n\n输出规格：\n- 对于每个 $\\theta \\in \\Theta$，计算收敛后的自旋污染 $\\Delta$ 作为浮点数。\n- 最终程序输出必须是单行，其中包含一个按 $\\Theta$ 顺序排列的五个 $\\Delta$ 值的逗号分隔列表，并用方括号括起来，例如 $[\\delta_{180},\\delta_{150},\\delta_{120},\\delta_{100},\\delta_{90}]$。\n- 以普通浮点数报告这些值。不需要单位，因为 $\\Delta$ 是无量纲的。\n\n您的推导和推理中的所有数学运算都必须基于上述定义和事实以及Hartree-Fock方法的一般性质。不允许使用此处指定以外的任何额外经验公式。确保数值模型是自洽的，并使用所提供的定义。您的程序必须是完全确定性的、自包含的、不使用任何外部输入，并且必须明确地实现自洽性过程和自旋期望值计算。",
            "solution": "在尝试给出解决方案之前，对问题陈述进行了严格的验证。\n\n### 步骤 1：提取已知条件\n- **模型：** 用于三个碳原子上 $\\pi$ 体系的三位点单带Hubbard哈密顿量。\n- **哈密顿量：** $\\hat{H} = \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\sum_{i,j=1}^{3} t_{ij} \\hat{c}^{\\dagger}_{i\\sigma} \\hat{c}_{j\\sigma} + U \\sum_{i=1}^{3} \\hat{n}_{i\\alpha} \\hat{n}_{i\\beta}$。\n- **基组：** 类 $p_z$ 原子轨道的正交归一基组。\n- **跃迁积分：** $t_{12} = t_{21} = t_{23} = t_{32} = t_0$。$t_{13} = t_{31}$ 依赖于中心角 $\\theta$。所有其他 $t_{ij}=0$ 当 $i \\ne j$。在位能量 $t_{ii}=0$。\n- **末端距离：** $R_{13}(\\theta) = 2 a \\sin(\\frac{\\theta}{2})$。\n- **末端跃迁：** $t_{13}(\\theta) = \\operatorname{sgn}(t_0) \\, c \\, |t_0| \\exp[-\\beta ( R_{13}(\\theta) - R_{\\mathrm{ref}} )]$。\n- **UHF Fock矩阵：**\n  - $F^{\\alpha} = T + U \\, \\mathrm{diag}(n^{\\beta}_1 - 1/2, \\, n^{\\beta}_2 - 1/2, \\, n^{\\beta}_3 - 1/2 )$\n  - $F^{\\beta} = T + U \\, \\mathrm{diag}(n^{\\alpha}_1 - 1/2, \\, n^{\\alpha}_2 - 1/2, \\, n^{\\alpha}_3 - 1/2 )$\n- **电子构型：** $N_{\\alpha} = 2$ 个自旋为 $\\alpha$ 的电子，$N_{\\beta} = 1$ 个自旋为 $\\beta$ 的电子。\n- **自旋污染：** $\\Delta = \\langle \\hat{S}^2 \\rangle - S(S+1)$，其中 $S=1/2$。\n- **参数：**\n  - 键长 $a = 1.40 \\, \\text{Å}$。\n  - 最近邻跃迁 $t_0 = -2.50 \\, \\text{eV}$。\n  - 在位库仑排斥 $U = 6.00 \\, \\text{eV}$。\n  - 耦合预因子 $c = 0.10$。\n  - 衰减常数 $\\beta = 1.50 \\, \\text{Å}^{-1}$。\n  - 参考距离 $R_{\\mathrm{ref}} = 2 a \\sin(60^\\circ)$。\n- **数值设定：**\n  - 阻尼因子 $m = 0.50$。\n  - 收敛容限 $\\varepsilon = 10^{-10}$。\n  - 最大迭代次数 $N_{\\mathrm{it,max}} = 10{,}000$。\n- **测试组：** 中心角 $\\Theta = [180, 150, 120, 100, 90]$ 度。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据充分：** 问题使用了Hubbard模型和非限制性Hartree-Fock (UHF) 方法，这些是计算化学和凝聚态物理中用于研究电子关联和开壳层体系的标准且成熟的理论框架。跃迁积分的参数化和自旋污染的概念在物理上是合理的。\n- **提法明确：** 问题提供了明确的目标、一套完备的方程、所有必需的数值参数以及一个确定的计算流程（自洽场，SCF）。SCF算法的结构保证了解的存在性，已知该算法对此类体系会收敛，尤其是在使用阻尼的情况下。\n- **客观性：** 问题以精确、定量且无偏见的科学语言陈述。所有量都有定义，不存在主观因素。\n\n该问题没有任何无效性缺陷。它在科学上是合理的、可形式化的、完整的且结构良好。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。将提供一个完整的、有理有据的解决方案。\n\n### 解决方案\n\n目标是使用非限制性Hartree-Fock (UHF) 方法，计算烯丙基自由基三位点模型中的自旋污染，并将其作为中心角 $\\theta$ 的函数。该解决方案需要两个主要部分：在UHF框架内推导自旋污染公式，以及实现UHF自洽场（SCF）算法。\n\n首先，我们推导总自旋平方算符的期望值 $\\langle \\hat{S}^2 \\rangle$ 的表达式。UHF波函数 $|\\Psi_{UHF}\\rangle$ 是一个由 $\\alpha$ 和 $\\beta$ 自旋的不同空间轨道构建的单一Slater行列式。虽然 $|\\Psi_{UHF}\\rangle$ 是总自旋投影算符 $\\hat{S}_z$ 的本征函数，具有明确的本征值 $M_S = \\frac{1}{2}(N_{\\alpha} - N_{\\beta})$，但它通常不是 $\\hat{S}^2$ 的本征函数。这种对纯自旋态的偏离被称为自旋污染。\n\n对于单行列式UHF波函数，$\\langle \\hat{S}^2 \\rangle$ 的一个广泛使用的表达式是：\n$$\n\\langle \\hat{S}^2 \\rangle = \\left(\\frac{N_{\\alpha}-N_{\\beta}}{2}\\right)\\left(\\frac{N_{\\alpha}-N_{\\beta}}{2} + 1\\right) + N_{\\beta} - \\sum_{p=1}^{N_{\\alpha}} \\sum_{q=1}^{N_{\\beta}} |\\langle \\psi_p^{\\alpha} | \\psi_q^{\\beta} \\rangle|^2\n$$\n其中 $|\\psi_p^{\\alpha}\\rangle$ 和 $|\\psi_q^{\\beta}\\rangle$ 分别是自旋 $\\alpha$ 和自旋 $\\beta$ 的已占据分子轨道（MO）。对于一个纯双重态，自旋量子数的精确值为 $S=1/2$，$\\hat{S}^2$ 的精确期望值为 $S(S+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。\n\n对于烯丙基自由基，我们有 $N_{\\alpha}=2$ 和 $N_{\\beta}=1$。$\\langle \\hat{S}^2 \\rangle$ 表达式中的第一项变为：\n$$\n\\left(\\frac{2-1}{2}\\right)\\left(\\frac{2-1}{2} + 1\\right) = \\frac{1}{2}\\left(\\frac{3}{2}\\right) = \\frac{3}{4} = S(S+1).\n$$\n自旋污染 $\\Delta$ 定义为计算出的期望值与精确值之间的差：\n$$\n\\Delta = \\langle \\hat{S}^2 \\rangle - S(S+1) = N_{\\beta} - \\sum_{p=1}^{N_{\\alpha}} \\sum_{q=1}^{N_{\\beta}} |\\langle \\psi_p^{\\alpha} | \\psi_q^{\\beta} \\rangle|^2.\n$$\n当 $N_{\\alpha}=2$ 和 $N_{\\beta}=1$ 时，这可以简化为：\n$$\n\\Delta = 1 - \\sum_{p=1}^{2} |\\langle \\psi_p^{\\alpha} | \\psi_1^{\\beta} \\rangle|^2 = 1 - \\left( |\\langle \\psi_1^{\\alpha} | \\psi_1^{\\beta} \\rangle|^2 + |\\langle \\psi_2^{\\alpha} | \\psi_1^{\\beta} \\rangle|^2 \\right).\n$$\nMO表示为正交归一原子轨道（AO）$|\\phi_i\\rangle$的线性组合：$|\\psi_p^{\\sigma}\\rangle = \\sum_i C_{ip}^{\\sigma} |\\phi_i\\rangle$。重叠积分则可以从MO系数向量计算得出：$\\langle \\psi_p^{\\alpha} | \\psi_q^{\\beta} \\rangle = \\sum_i C_{ip}^{\\alpha} C_{iq}^{\\beta}$。在矩阵表示法中，如果 $C_{occ}^{\\sigma}$ 是已占据MO系数（作为列向量）的矩阵，则重叠矩阵为 $S^{\\alpha\\beta} = (C_{occ}^{\\alpha})^T C_{occ}^{\\beta}$。平方和是该重叠矩阵的Frobenius范数的平方。\n\n计算的核心是找到收敛的MO系数的SCF过程。对于测试组中的每个角度 $\\theta$，执行以下迭代算法：\n1.  **系统设置：** 将角度 $\\theta$ 转换为弧度。使用给定的公式计算末端距离 $R_{13}(\\theta)$ 和相应的跃迁积分 $t_{13}(\\theta)$。构建大小为 $3 \\times 3$ 的单电子跃迁矩阵 $T$：\n    $$\n    T = \\begin{pmatrix} 0 & t_0 & t_{13}(\\theta) \\\\ t_0 & 0 & t_0 \\\\ t_{13}(\\theta) & t_0 & 0 \\end{pmatrix}\n    $$\n2.  **初始化：** 对位点布居数 $n_i^{\\alpha}$ 和 $n_i^{\\beta}$ 作出初始猜测。一个物理上合理的初始猜测是基于烯丙基自由基的Hückel理论，该理论将未成对的自旋密度置于末端碳原子上。这对应于初始布居数 $n^{\\alpha} = [0.75, 0.5, 0.75]$ 和 $n^{\\beta} = [0.25, 0.5, 0.25]$。\n\n3.  **SCF迭代：** 迭代该过程，直到连续迭代之间的位点布居数变化小于容限 $\\varepsilon = 10^{-10}$。\n    a. **构建Fock矩阵：** 使用当前的位点布居数构建依赖于自旋的Fock矩阵 $F^{\\alpha}$ 和 $F^{\\beta}$：\n       $$\n       F^{\\alpha} = T + U \\, \\mathrm{diag}(n_1^{\\beta} - 0.5, n_2^{\\beta} - 0.5, n_3^{\\beta} - 0.5)\n       $$\n       $$\n       F^{\\beta} = T + U \\, \\mathrm{diag}(n_1^{\\alpha} - 0.5, n_2^{\\alpha} - 0.5, n_3^{\\alpha} - 0.5)\n       $$\n    b. **对角化：** 对每个Fock矩阵求解本征值问题：$F^{\\sigma} C^{\\sigma} = C^{\\sigma} E^{\\sigma}$。这会得到MO能量（本征值）和系数（本征向量）。\n    c. **更新密度：** 根据构造原理占据MO。使用能量最低的 $N_{\\alpha}=2$ 个 $\\alpha$ 轨道和能量最低的 $N_{\\beta}=1$ 个 $\\beta$ 轨道来构建新的密度矩阵 $P^{\\sigma} = C_{occ}^{\\sigma} (C_{occ}^{\\sigma})^T$。新的位点布居数是这些矩阵的对角元素：$n_i^{\\sigma (new)} = P_{ii}^{\\sigma}$。\n    d. **阻尼：** 为确保平滑收敛，使用因子 $m=0.5$ 的线性混合方案将新布居数与旧布居数混合：\n       $$\n       n_i^{\\sigma} = (1-m)n_i^{\\sigma (old)} + m \\, n_i^{\\sigma (new)}\n       $$\n    e. **收敛性检查：** 将新旧布居数向量之间的最大绝对差与容限 $\\varepsilon$ 进行比较。如果变化小于 $\\varepsilon$，则认为SCF循环已收敛。\n\n4.  **SCF后计算：** 收敛后，使用最终的MO系数矩阵 $C_{occ}^{\\alpha}$ 和 $C_{occ}^{\\beta}$ 来计算重叠矩阵 $(C_{occ}^{\\alpha})^T C_{occ}^{\\beta}$。然后使用推导出的公式计算自旋污染 $\\Delta$。\n\n对每个指定的角度 $\\theta$ 重复此过程，并收集所得的 $\\Delta$ 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the UHF spin contamination for a 3-site Hubbard model of the allyl radical\n    as a function of the central C-C-C angle.\n    \"\"\"\n    \n    # --- Parameters ---\n    a = 1.40  # Carbon-carbon bond length (Å)\n    t0 = -2.50  # Nearest-neighbor hopping (eV)\n    U = 6.00  # On-site repulsion (eV)\n    c = 0.10  # Through-space coupling prefactor (dimensionless)\n    beta = 1.50  # Decay constant (Å⁻¹)\n    \n    # --- Numerical Settings ---\n    m = 0.50  # Damping factor for SCF mixing\n    eps = 1e-10  # Convergence tolerance for site populations\n    N_it_max = 10000  # Maximum number of SCF iterations\n    \n    # --- System Configuration ---\n    N_alpha = 2  # Number of alpha electrons\n    N_beta = 1   # Number of beta electrons\n    N_sites = 3  # Number of sites in the model\n    \n    # --- Test Suite ---\n    theta_degrees = [180.0, 150.0, 120.0, 100.0, 90.0]\n    \n    # --- Reference distance for t13 calculation ---\n    R_ref = 2.0 * a * np.sin(np.deg2rad(60.0))\n\n    results = []\n\n    for theta_deg in theta_degrees:\n        # --- 1. Set up the one-electron Hamiltonian for the current angle ---\n        theta_rad = np.deg2rad(theta_deg)\n        R13 = 2.0 * a * np.sin(theta_rad / 2.0)\n        t13 = np.sign(t0) * c * np.abs(t0) * np.exp(-beta * (R13 - R_ref))\n        \n        T = np.zeros((N_sites, N_sites))\n        T[0, 1] = T[1, 0] = t0\n        T[1, 2] = T[2, 1] = t0\n        T[0, 2] = T[2, 0] = t13\n\n        # --- 2. UHF-SCF Calculation ---\n        # Initial guess for site populations (based on Huckel non-bonding MO)\n        n_alpha = np.array([0.75, 0.5, 0.75])\n        n_beta = np.array([0.25, 0.5, 0.25])\n        \n        for i in range(N_it_max):\n            n_alpha_old = n_alpha.copy()\n            n_beta_old = n_beta.copy()\n            \n            # Construct Fock matrices\n            F_alpha = T + np.diag(U * (n_beta - 0.5))\n            F_beta = T + np.diag(U * (n_alpha - 0.5))\n            \n            # Diagonalize Fock matrices\n            eigvals_a, C_a = np.linalg.eigh(F_alpha)\n            eigvals_b, C_b = np.linalg.eigh(F_beta)\n            \n            # Form density matrices from occupied orbitals\n            C_occ_a = C_a[:, :N_alpha]\n            C_occ_b = C_b[:, :N_beta]\n            \n            P_alpha = C_occ_a @ C_occ_a.T\n            P_beta = C_occ_b @ C_occ_b.T\n            \n            # Calculate new site populations\n            n_alpha_new = np.diag(P_alpha)\n            n_beta_new = np.diag(P_beta)\n            \n            # Apply damping\n            n_alpha = (1 - m) * n_alpha_old + m * n_alpha_new\n            n_beta = (1 - m) * n_beta_old + m * n_beta_new\n            \n            # Check for convergence\n            error = max(np.max(np.abs(n_alpha - n_alpha_old)), \n                        np.max(np.abs(n_beta - n_beta_old)))\n            \n            if error < eps:\n                break\n        \n        # --- 3. Post-SCF: Calculate Spin Contamination ---\n        # After convergence, re-diagonalize one last time with final densities to get final MOs\n        F_alpha = T + np.diag(U * (n_beta - 0.5))\n        F_beta = T + np.diag(U * (n_alpha - 0.5))\n        eigvals_a, C_a = np.linalg.eigh(F_alpha)\n        eigvals_b, C_b = np.linalg.eigh(F_beta)\n        \n        C_occ_a = C_a[:, :N_alpha]\n        C_occ_b = C_b[:, :N_beta]\n\n        # Calculate overlap matrix between occupied alpha and beta orbitals\n        S_ab_occ = C_occ_a.T @ C_occ_b\n        \n        # Calculate sum of squared overlaps\n        sum_S_sq = np.sum(S_ab_occ**2)\n        \n        # Spin contamination Delta = <S^2> - S(S+1)\n        # For UHF, Delta = N_beta - sum_{p,q} |<psi_p^a | psi_q^b>|^2\n        delta = float(N_beta - sum_S_sq)\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}