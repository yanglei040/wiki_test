{
    "hands_on_practices": [
        {
            "introduction": "The essence of Configuration Interaction lies in improving upon the single-determinant Hartree-Fock picture by allowing different electronic configurations to mix. This mixing is governed by the off-diagonal elements of the Hamiltonian matrix, which quantify the interaction between these configurations. This foundational exercise guides you through the calculation of such a matrix element, revealing that it is the electron-electron repulsion term in the Hamiltonian that facilitates this crucial interaction.",
            "id": "1175157",
            "problem": "Consider a two-electron atom with nuclear charge $Z$ (e.g., Helium). In the Configuration Interaction (CI) method, the exact wave function is approximated as a linear combination of Configuration State Functions (CSFs). We will consider a minimal CI expansion involving only two CSFs.\n\nThe first CSF, $\\Phi_0$, is the ground-state configuration built from a real, normalized spatial orbital $\\phi_{1s}$. The second CSF, $\\Phi_1$, is a doubly-excited configuration built from a different real, normalized spatial orbital $\\phi_{2s}$. The spatial orbitals $\\phi_{1s}$ and $\\phi_{2s}$ are taken to be orthonormal, i.e., $\\langle \\phi_{1s} | \\phi_{2s} \\rangle = 0$.\n\nThe two CSFs are singlets, represented by the following Slater determinants:\n$$\n\\Phi_0 = \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{1s}(\\mathbf{r}_1)\\alpha(\\sigma_1) & \\phi_{1s}(\\mathbf{r}_1)\\beta(\\sigma_1) \\\\\n\\phi_{1s}(\\mathbf{r}_2)\\alpha(\\sigma_2) & \\phi_{1s}(\\mathbf{r}_2)\\beta(\\sigma_2)\n\\end{vmatrix}\n= | \\phi_{1s} \\overline{\\phi_{1s}} |\n$$\n$$\n\\Phi_1 = \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{2s}(\\mathbf{r}_1)\\alpha(\\sigma_1) & \\phi_{2s}(\\mathbf{r}_1)\\beta(\\sigma_1) \\\\\n\\phi_{2s}(\\mathbf{r}_2)\\alpha(\\sigma_2) & \\phi_{2s}(\\mathbf{r}_2)\\beta(\\sigma_2)\n\\end{vmatrix}\n= | \\phi_{2s} \\overline{\\phi_{2s}} |\n$$\nHere, $\\alpha$ and $\\beta$ are the orthonormal spin functions.\n\nThe non-relativistic Hamiltonian for this system in atomic units is:\n$$\nH = h(1) + h(2) + \\frac{1}{r_{12}}\n$$\nwhere $h(i) = -\\frac{1}{2}\\nabla_i^2 - \\frac{Z}{r_i}$ is the one-electron Hamiltonian for electron $i$, and $\\frac{1}{r_{12}}$ is the electron-electron repulsion operator.\n\nThe two-electron repulsion integrals are defined using the Mulliken notation:\n$$\n(pq|rs) = \\iint \\phi_p(\\mathbf{r}_1) \\phi_q(\\mathbf{r}_1) \\frac{1}{r_{12}} \\phi_r(\\mathbf{r}_2) \\phi_s(\\mathbf{r}_2) \\,d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nAssume that the specific exchange-type integral involving all four orbital indices is given by the symbol $K_{12} = (1s \\, 2s | 1s \\, 2s)$.\n\nDerive an expression for the off-diagonal element of the CI matrix, $H_{01} = \\langle \\Phi_0 | H | \\Phi_1 \\rangle$, in terms of the provided integral symbol $K_{12}$.",
            "solution": "We wish to compute the off-diagonal CI matrix element $H_{01} = \\langle \\Phi_0 | \\hat{H} | \\Phi_1 \\rangle$.\nThe Hamiltonian is $\\hat{H} = \\hat{h}(1) + \\hat{h}(2) + 1/r_{12}$. The determinants $\\Phi_0$ and $\\Phi_1$ differ by two spin-orbitals ($\\phi_{1s}\\alpha \\to \\phi_{2s}\\alpha$ and $\\phi_{1s}\\beta \\to \\phi_{2s}\\beta$).\nAccording to the Slater-Condon rules:\n1. The matrix element for the one-electron part of the Hamiltonian is zero: $\\langle \\Phi_0 | \\hat{h}(1) + \\hat{h}(2) | \\Phi_1 \\rangle = 0$.\n2. The matrix element for the two-electron operator is non-zero.\nThus, we only need to evaluate $H_{01} = \\langle \\Phi_0 | \\frac{1}{r_{12}} | \\Phi_1 \\rangle$.\n\nThe matrix element between two closed-shell singlet CSFs, which differ by a double excitation from orbital $\\phi_{1s}$ to $\\phi_{2s}$, is given directly by a two-electron integral over the spatial orbitals involved:\n$$H_{01} = \\iint \\phi_{1s}(\\mathbf{r}_1) \\phi_{2s}(\\mathbf{r}_1) \\frac{1}{r_{12}} \\phi_{1s}(\\mathbfr_2) \\phi_{2s}(\\mathbf{r}_2) \\,d\\mathbf{r}_1 d\\mathbf{r}_2$$\nIn the provided notation, this is written as $(\\phi_{1s}\\phi_{2s}|\\phi_{1s}\\phi_{2s})$. This is precisely the exchange-type integral that the problem defines as $K_{12}$.\nTherefore:\n$$H_{01} = K_{12}$$",
            "answer": "$$\\boxed{K_{12}}$$"
        },
        {
            "introduction": "While Full CI is exact within a given basis set, its immense computational cost necessitates the use of truncated methods like CISD (CI with Singles and Doubles). These approximations, however, come with their own theoretical deficiencies. This practice provides a clear, hands-on demonstration of one of the most critical flaws: the lack of size-consistency, where the calculated energy of non-interacting systems does not scale correctly.",
            "id": "1175061",
            "problem": "A major deficiency of truncated Configuration Interaction (CI) methods is their lack of size-consistency, meaning the calculated energy of a system of N non-interacting identical subsystems is not equal to N times the energy of a single subsystem. This problem demonstrates this issue for the CISD (CI with Single and Double excitations) method.\n\nConsider a system composed of two identical, non-interacting atoms, A and B. For each atom, we use a simplified quantum chemical model that provides two spatial molecular orbitals (MOs): one occupied ground state orbital $\\phi_1$ and one unoccupied (virtual) orbital $\\phi_2$. The Hamiltonian for the total system is the sum of the Hamiltonians for the individual atoms, $\\hat{H} = \\hat{H}_A + \\hat{H}_B$. Because the atoms are non-interacting, any matrix element of $\\hat{H}$ that involves an integral over orbitals from both atoms (e.g., two-electron integrals like $\\langle \\phi_{1A}\\phi_{1B}|\\frac{1}{r_{12}}|\\phi_{2A}\\phi_{2B}\\rangle$) is zero.\n\nFor a single atom (e.g., A), the Hartree-Fock (HF) ground state wavefunction is a Slater determinant corresponding to the configuration $\\phi_{1A}^2$, which we denote as $|\\Psi_0^A\\rangle$. The only possible double excitation produces the configuration $\\phi_{2A}^2$, denoted $|\\Psi_D^A\\rangle$. The relevant matrix elements for a single atom are defined as:\n1. The HF ground state energy: $E_0 = \\langle \\Psi_0^A | \\hat{H}_A | \\Psi_0^A \\rangle$.\n2. The energy of the doubly-excited configuration: $E_D = \\langle \\Psi_D^A | \\hat{H}_A | \\Psi_D^A \\rangle$.\n3. The interaction element between the ground and doubly-excited states: $K = \\langle \\Psi_0^A | \\hat{H}_A | \\Psi_D^A \\rangle$.\n\nFor the composite system of two atoms, A+B, the HF reference state $|\\Psi_0\\rangle$ corresponds to the configuration where both atoms are in their ground state, $\\phi_{1A}^2 \\phi_{1B}^2$. Your task is to perform a CI calculation for the ground state of this composite system. For this particular system, it can be shown that singly-excited configurations do not contribute to the ground state energy correction, so you only need to consider doubly-excited configurations (a CID calculation).\n\nDerive an expression for the exact ground state energy of the two-atom system at the CISD level of theory, $E_{CISD}^{(A+B)}$, in terms of the parameters $E_0$, $E_D$, and $K$.",
            "solution": "We label the three relevant determinants for A+B as $|0\\rangle \\equiv |\\Psi_0^A \\Psi_0^B\\rangle$, $|D_A\\rangle \\equiv |\\Psi_D^A \\Psi_0^B\\rangle$, and $|D_B\\rangle \\equiv |\\Psi_0^A \\Psi_D^B\\rangle$.  \nBecause $\\hat{H}=\\hat{H}_A+\\hat{H}_B$ and there is no inter-atomic coupling, the CI Hamiltonian matrix in the basis $\\{|0\\rangle, |D_A\\rangle, |D_B\\rangle\\}$ is  \n$$\n\\mathbf{H}=\\begin{pmatrix}\n2E_0 & K & K\\\\\nK & E_D+E_0 &0\\\\\nK & 0 &E_0+E_D\n\\end{pmatrix}.\n$$\nBy symmetry the antisymmetric combination $(|D_A\\rangle - |D_B\\rangle)/\\sqrt{2}$ decouples, leaving a $2 \\times 2$ block in the $\\{|0\\rangle, (|D_A\\rangle + |D_B\\rangle)/\\sqrt{2}\\}$ subspace:  \n$$\n\\mathbf{H}_{\\rm sym}=\n\\begin{pmatrix}\n2E_0 & \\sqrt{2}\\,K\\\\\n\\sqrt{2}\\,K & E_0+E_D\n\\end{pmatrix}.\n$$\nThe secular equation is  \n$$(2E_0 -E)(E_0+E_D -E)-2K^2=0\n\\;\\Longrightarrow\\;\nE^2-(3E_0+E_D)E+(2E_0^2+2E_0E_D-2K^2)=0.$$\nIts lowest root gives the CISD ground-state energy:  \n$$\nE_{CISD}^{(A+B)}\n=\\frac{3E_0+E_D-\\sqrt{(E_D-E_0)^2+8K^2}}{2}.\n$$",
            "answer": "$$\\boxed{\\frac{3E_0+E_D - \\sqrt{(E_D - E_0)^2 + 8K^2}}{2}}$$"
        },
        {
            "introduction": "Constructing the CI matrix is the first step, but for any realistic system, solving the resulting eigenvalue problem presents a formidable computational challenge due to the matrix's enormous size. Direct diagonalization is infeasible, so modern quantum chemistry relies on powerful iterative methods like the Davidson algorithm to efficiently find the lowest energy states. This exercise demystifies this process by having you perform one complete iteration, bridging the gap between abstract quantum theory and practical numerical implementation.",
            "id": "159291",
            "problem": "In Configuration Interaction (CI) calculations, one often needs to find the lowest eigenvalue (ground state energy) and corresponding eigenvector (ground state wavefunction) of a very large, sparse, and diagonally dominant Hamiltonian matrix, $\\mathbf{H}$. The Davidson diagonalization algorithm is an iterative method particularly well-suited for this task. It works by building a small subspace, diagonalizing the Hamiltonian in that subspace, and using the result to generate a correction vector that is used to expand the subspace for the next iteration.\n\nConsider a simple three-state CI problem described by the following symmetric Hamiltonian matrix $\\mathbf{H}$, where $\\Delta$ and $V$ are positive real-valued energy parameters:\n$$\n\\mathbf{H} = \\begin{pmatrix} 0 & V & V \\\\ V & \\Delta & 0 \\\\ V & 0 & \\Delta \\end{pmatrix}\n$$\nYour task is to perform one full iteration of the Davidson algorithm to find an improved estimate for the lowest energy eigenvalue.\n\nStart with a normalized initial guess vector $\\mathbf{b}_1$, corresponding to the configuration with the lowest diagonal energy:\n$$\n\\mathbf{b}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis vector forms the initial subspace.\n\nThe algorithm proceeds as follows:\n1.  **Subspace diagonalization (0-th iteration):** The initial approximation for the eigenvalue, $\\theta^{(0)}$, is the Rayleigh quotient for $\\mathbf{b}_1$: $\\theta^{(0)} = \\mathbf{b}_1^\\dagger \\mathbf{H} \\mathbf{b}_1$. The corresponding eigenvector approximation is $\\mathbf{c}^{(0)} = \\mathbf{b}_1$.\n2.  **Residual calculation:** Compute the residual vector $\\mathbf{r} = (\\mathbf{H} - \\theta^{(0)} \\mathbf{I}) \\mathbf{c}^{(0)}$.\n3.  **Correction vector:** Compute the correction vector $\\delta\\mathbf{c}$. Each component is given by $\\delta c_i = - r_i / (H_{ii} - \\theta^{(0)})$. If a diagonal element $H_{ii}$ happens to be equal to $\\theta^{(0)}$, the corresponding component $\\delta c_i$ is set to zero.\n4.  **Subspace expansion:** Orthogonalize the correction vector $\\delta\\mathbf{c}$ against the current basis vectors (in this case, just $\\mathbf{b}_1$) using the Gram-Schmidt procedure. Normalize the resulting vector to obtain the new basis vector, $\\mathbf{b}_2$.\n5.  **New subspace problem:** Construct the new $2 \\times 2$ subspace Hamiltonian matrix $\\mathbf{A}$ with elements $A_{ij} = \\mathbf{b}_i^\\dagger \\mathbf{H} \\mathbf{b}_j$ for $i,j \\in \\{1, 2\\}$.\n6.  **Final result:** Solve the eigenvalue problem for the matrix $\\mathbf{A}$. The lowest eigenvalue of $\\mathbf{A}$ is the updated estimate for the ground state energy.\n\nFind the lowest eigenvalue of the subspace matrix $\\mathbf{A}$ after this first full iteration. Express your answer as a symbolic expression in terms of $\\Delta$ and $V$.",
            "solution": "1. Subspace diagonalization:\n$$\\theta^{(0)} = \\mathbf{b}_1^\\dagger \\mathbf{H}\\,\\mathbf{b}_1 = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ V \\\\ V \\end{pmatrix} = 0, \\qquad \\mathbf{c}^{(0)}=\\mathbf{b}_1.$$\n\n2. Residual calculation:\n$$\\mathbf{r}=(\\mathbf{H} - \\theta^{(0)}\\mathbf{I})\\,\\mathbf{c}^{(0)} = \\mathbf{H} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ V \\\\ V \\end{pmatrix}.$$\n\n3. Correction vector:\nFor $i=1$: $H_{11}-\\theta^{(0)}=0$, so by the rule, $\\delta c_1=0$.  \nFor $i=2,3$: $H_{ii}-\\theta^{(0)}=\\Delta$, so $\\delta c_{2,3}=-\\frac{V}{\\Delta}$.  \nThus, the correction vector is:\n$$\\delta\\mathbf{c}=\\begin{pmatrix}0\\\\-V/\\Delta\\\\-V/\\Delta\\end{pmatrix}.$$\n\n4. Subspace expansion (orthogonalization and normalization):\nThe correction vector $\\delta\\mathbf{c}$ is already orthogonal to $\\mathbf{b}_1$ since $\\mathbf{b}_1^T \\delta\\mathbf{c}=0$.\nWe normalize $\\delta\\mathbf{c}$: $\\|\\delta\\mathbf{c}\\| = \\sqrt{0^2 + (-V/\\Delta)^2 + (-V/\\Delta)^2} = \\sqrt{2V^2/\\Delta^2} = \\frac{\\sqrt{2}V}{\\Delta}$.\nThe new basis vector $\\mathbf{b}_2$ is the normalized correction vector:\n$$\\mathbf{b}_2=\\frac{\\delta\\mathbf{c}}{\\|\\delta\\mathbf{c}\\|}\n=\\frac{1}{\\frac{\\sqrt{2}V}{\\Delta}}\\begin{pmatrix}0\\\\-V/\\Delta\\\\-V/\\Delta\\end{pmatrix}\n=\\begin{pmatrix}0\\\\-1/\\sqrt{2}\\\\-1/\\sqrt{2}\\end{pmatrix}.$$\n(The overall sign of $\\mathbf{b}_2$ is arbitrary, we choose the negative.)\n\n5. New subspace Hamiltonian:\nThe elements of the $2 \\times 2$ matrix $\\mathbf{A}$ are $A_{ij} = \\mathbf{b}_i^\\dagger \\mathbf{H} \\mathbf{b}_j$.\n$$A_{11}=\\mathbf{b}_1^\\dagger\\mathbf{H}\\,\\mathbf{b}_1=0$$\n$$A_{12}=\\mathbf{b}_1^\\dagger\\mathbf{H}\\,\\mathbf{b}_2\n= \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & V & V \\\\ V & \\Delta & 0 \\\\ V & 0 & \\Delta \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -2V/\\sqrt{2} \\\\ -\\Delta/\\sqrt{2} \\\\ -\\Delta/\\sqrt{2} \\end{pmatrix} = -\\sqrt{2}V$$\n$$A_{21} = A_{12} = -\\sqrt{2}V$$\n$$A_{22}=\\mathbf{b}_2^\\dagger\\mathbf{H}\\,\\mathbf{b}_2\n= \\begin{pmatrix} 0 & -1/\\sqrt{2} & -1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} -\\sqrt{2}V \\\\ -\\Delta/\\sqrt{2} \\\\ -\\Delta/\\sqrt{2} \\end{pmatrix} = 0 + \\frac{\\Delta}{2} + \\frac{\\Delta}{2} = \\Delta$$\nThus, the subspace Hamiltonian is:\n$$\\mathbf{A}=\\begin{pmatrix}0&-\\sqrt{2}\\,V\\\\-\\sqrt{2}\\,V&\\Delta\\end{pmatrix}.$$\n\n6. Final result:\nThe eigenvalues $\\lambda$ of $\\mathbf{A}$ are found from the characteristic equation $\\det(\\mathbf{A}-\\lambda\\mathbf{I})=0$:\n$$(0-\\lambda)(\\Delta-\\lambda) - (-\\sqrt{2}V)^2 = 0 \\implies \\lambda^2 - \\Delta\\lambda - 2V^2 = 0$$\nUsing the quadratic formula:\n$$\\lambda=\\frac{\\Delta\\pm\\sqrt{(-\\Delta)^2-4(1)(-2V^2)}}{2}\n=\\frac{\\Delta\\pm\\sqrt{\\Delta^2+8V^2}}{2}.$$\nThe lowest eigenvalue is the one with the minus sign.",
            "answer": "$$\\boxed{\\frac{\\Delta - \\sqrt{\\Delta^2 + 8 V^2}}{2}}$$"
        }
    ]
}