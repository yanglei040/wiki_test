{
    "hands_on_practices": [
        {
            "introduction": "To understand how Kohn-Sham DFT describes molecules with unpaired electrons, we can build a model for a classic example: the triplet ground state of molecular oxygen ($\\mathrm{O}_2$). This exercise provides a concrete model for how Spin-Unrestricted Kohn-Sham (UKS) theory accommodates different spin populations, leading to different energies for spin-up and spin-down orbitals. By exploring the competition between orbital energy splitting and a spin-dependent exchange interaction , you will gain a hands-on feel for how DFT determines the most stable electronic configuration in magnetic systems.",
            "id": "2456922",
            "problem": "You will implement a simplified, first-principles model of spin-unrestricted Kohn-Sham orbitals to analyze the ground-state of molecular oxygen, which is known experimentally to be a triplet. The goal is to demonstrate, within a minimal and mathematically explicit model, how Spin-Unrestricted Kohn-Sham (UKS) Density Functional Theory (DFT) accommodates two unpaired electrons and how this appears in the Kohn-Sham (KS) orbitals.\n\nDefinitions and setup:\n- Kohn-Sham (KS) Density Functional Theory (DFT) replaces the interacting electron problem with a noninteracting system subject to an effective potential. In the spin-unrestricted formulation (UKS), separate effective potentials are used for the two spin channels, labeled $\\alpha$ and $\\beta$, which can lead to different orbital energies for the two spins.\n- Consider a minimal valence-only model for $\\mathrm{O}_2$ using the following $7$ spatial orbitals (from lowest to highest base energy), each of which can host up to $2$ electrons when considering both spins:\n  1. $\\sigma_g(2s)$\n  2. $\\sigma_u^\\ast(2s)$\n  3. $\\sigma_g(2p_z)$\n  4. $\\pi_u(2p_x)$\n  5. $\\pi_u(2p_y)$\n  6. $\\pi_g^\\ast(2p_x)$\n  7. $\\pi_g^\\ast(2p_y)$\n- Let the base (spinless) energies in electronvolts be\n  $$\\varepsilon_0=-18,\\ \\varepsilon_1=-10,\\ \\varepsilon_2=-8,\\ \\varepsilon_3=-6,\\ \\varepsilon_4=-6,\\ \\varepsilon_5=-4,\\ \\varepsilon_6=-4.$$\n- Introduce a small crystal-field-like splitting $\\delta \\ge 0$ within the antibonding $\\pi_g^\\ast$ pair so that\n  $$\\varepsilon_5 = -4 - \\frac{\\delta}{2},\\quad \\varepsilon_6 = -4 + \\frac{\\delta}{2}.$$\n- Introduce a spin-dependent exchange-like splitting $\\Delta \\ge 0$ that acts only on the $\\pi_g^\\ast$ orbitals, such that for spins $\\sigma \\in \\{\\alpha,\\beta\\}$ the spin-orbital energies are\n  $$\\varepsilon_i^\\alpha = \\varepsilon_i,\\ \\varepsilon_i^\\beta = \\varepsilon_i\\quad \\text{for } i \\in \\{0,1,2,3,4\\},$$\n  $$\\varepsilon_j^\\alpha = \\varepsilon_j - \\frac{\\Delta}{2},\\ \\varepsilon_j^\\beta = \\varepsilon_j + \\frac{\\Delta}{2}\\quad \\text{for } j \\in \\{5,6\\}.$$\n- The total number of valence electrons is $N=12$. At zero temperature, the noninteracting KS filling consists of occupying the $N$ lowest spin-orbital energies across both spins, with at most one electron per spin orbital.\n\nTie-breaking for exact degeneracies (to ensure determinism):\n- When two spin orbitals have exactly equal energies, break ties by prioritizing $\\alpha$ before $\\beta$, and for identical spins prioritize the lower spatial-orbital index $i$ before the higher one.\n\nTask:\n- For each parameter pair $(\\delta,\\Delta)$ in the test suite below, construct the spin-orbital energies $\\varepsilon_i^\\sigma$, fill $N=12$ electrons according to the rule above, and compute:\n  1. The total spin magnetization $m = N_\\alpha - N_\\beta$, where $N_\\alpha$ and $N_\\beta$ are the total numbers of $\\alpha$ and $\\beta$ electrons, respectively.\n  2. The spin polarization on the two antibonding $\\pi_g^\\ast$ spatial orbitals, defined as the list $[s_5,s_6]$ where $s_i = n_i^\\alpha - n_i^\\beta$ and $n_i^\\sigma \\in \\{0,1\\}$ is the occupancy of spin $\\sigma$ in spatial orbital $i$.\n\nTest suite:\n- Use the following three parameter pairs $(\\delta,\\Delta)$, expressed in electronvolts. No numerical values in the final output require units.\n  - Case A (paired electrons favored by orbital splitting): $(\\delta,\\Delta) = (0.20, 0.10)$.\n  - Case B (unpaired triplet favored by spin splitting): $(\\delta,\\Delta) = (0.05, 0.30)$.\n  - Case C (exact degeneracy boundary): $(\\delta,\\Delta) = (0.00, 0.00)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, in the order A, B, C. Each list must be of the form $[m,s_5,s_6]$, where $m$, $s_5$, and $s_6$ are integers. For example, a syntactically valid output could look like\n  $$[[m_A,s_{5,A},s_{6,A}],[m_B,s_{5,B},s_{6,B}],[m_C,s_{5,C},s_{6,C}]].$$",
            "solution": "The problem is valid as it presents a scientifically grounded, well-posed, and objective model based on the principles of computational chemistry. It is a simplified but coherent representation of spin-unrestricted Kohn-Sham theory applied to molecular oxygen, with all parameters, rules, and objectives clearly and mathematically defined.\n\nThe task is to determine the ground-state electronic configuration of a simplified model of the $\\mathrm{O}_2$ molecule for different parameter sets and to compute the resulting spin properties. The model is based on the spin-unrestricted Kohn-Sham (UKS) framework of Density Functional Theory. In this framework, the complex many-electron problem is mapped onto a simpler problem of non-interacting quasiparticles (the Kohn-Sham electrons) moving in an effective potential. The spin-unrestricted formulation allows for different potentials for spin-$\\alpha$ and spin-$\\beta$ electrons, which is essential for describing systems with a net magnetic moment, such as the triplet ground state of $\\mathrm{O}_2$.\n\nThe model considers a basis of $7$ valence spatial molecular orbitals, which, combined with the two spin states ($\\alpha$ and $\\beta$), gives a total of $14$ available spin-orbitals. The problem is to fill these spin-orbitals with the $N=12$ valence electrons of the $\\mathrm{O}_2$ molecule. According to the Aufbau principle for a non-interacting system at zero temperature, the electrons occupy the spin-orbitals with the lowest energies first.\n\nThe energy $\\varepsilon_i^\\sigma$ of a spin-orbital, corresponding to spin $\\sigma \\in \\{\\alpha, \\beta\\}$ and spatial orbital $i \\in \\{0, 1, \\dots, 6\\}$, is determined by three components:\n$1$. The base energy of the spatial orbital, $\\varepsilon_i$. The initial base energies are given as $\\varepsilon_0=-18$, $\\varepsilon_1=-10$, $\\varepsilon_2=-8$, $\\varepsilon_3=-6$, $\\varepsilon_4=-6$, $\\varepsilon_5=-4$, and $\\varepsilon_6=-4$ in units of electronvolts.\n$2$. An orbital-degeneracy-breaking term $\\delta \\ge 0$, which acts like a crystal field splitting. It affects only the otherwise degenerate $\\pi_g^\\ast$ orbitals (indexed $i=5$ and $i=6$), modifying their base energies to $\\varepsilon_5 = -4 - \\frac{\\delta}{2}$ and $\\varepsilon_6 = -4 + \\frac{\\delta}{2}$.\n$3$. A spin-splitting exchange-like term $\\Delta \\ge 0$, which also acts only on the $\\pi_g^\\ast$ orbitals. This term makes the orbital energies spin-dependent.\n\nThe final spin-orbital energies are thus defined as:\n- For the lower $5$ spatial orbitals ($i \\in \\{0, 1, 2, 3, 4\\}$):\n$$ \\varepsilon_i^\\alpha = \\varepsilon_i, \\quad \\varepsilon_i^\\beta = \\varepsilon_i $$\n- For the two antibonding $\\pi_g^\\ast$ orbitals ($j \\in \\{5, 6\\}$), using their $\\delta$-modified base energies $\\varepsilon_j$:\n$$ \\varepsilon_j^\\alpha = \\varepsilon_j - \\frac{\\Delta}{2} \\quad (\\text{spin-up, stabilized}) $$\n$$ \\varepsilon_j^\\beta = \\varepsilon_j + \\frac{\\Delta}{2} \\quad (\\text{spin-down, destabilized}) $$\n\nTo find the ground-state configuration for a given pair of parameters $(\\delta, \\Delta)$, we must determine the energy ordering of all $14$ spin-orbitals. The problem specifies a strict tie-breaking rule for any degeneracies:\n$1$. Priority is given to lower energy.\n$2$. For equal energies, the $\\alpha$ spin is prioritized over the $\\beta$ spin.\n$3$. For equal energies and identical spins (which occurs when spatial orbitals are degenerate), the lower spatial orbital index $i$ is prioritized.\n\nThis complete ordering defines the sequence in which the $N=12$ electrons occupy the spin-orbitals. The first $12$ spin-orbitals in this sequence are the occupied ones.\n\nOnce the occupied spin-orbitals are identified, we can compute the required physical quantities. The occupancy of a spin-orbital $(\\sigma, i)$ is denoted as $n_i^\\sigma$, which is $1$ if occupied and $0$ if empty.\n- The total number of $\\alpha$ and $\\beta$ electrons are $N_\\alpha = \\sum_{i=0}^{6} n_i^\\alpha$ and $N_\\beta = \\sum_{i=0}^{6} n_i^\\beta$.\n- The total spin magnetization is $m = N_\\alpha - N_\\beta$. A value of $m=0$ corresponds to a singlet state, while $m=2$ corresponds to a triplet state (since $S_z = m/2$).\n- The spin polarization on the $\\pi_g^\\ast$ spatial orbitals is given by the list $[s_5, s_6]$, where $s_i = n_i^\\alpha - n_i^\\beta$ for $i \\in \\{5, 6\\}$. This measures the net spin density on each of these two orbitals.\n\nThe algorithmic procedure to solve the problem for each test case is as follows:\n$1$. For a given $(\\delta, \\Delta)$, construct a list of the $14$ spin-orbitals. Each spin-orbital is represented as a tuple containing its calculated energy, a numerical identifier for its spin (e.g., $0$ for $\\alpha$, $1$ for $\\beta$), and its spatial orbital index $i \\in \\{0, \\dots, 6\\}$.\n$2$. Sort this list of tuples. The standard lexicographical sorting of tuples naturally implements the prescribed ordering: it will sort primarily by the first element (energy), secondarily by the second element (spin identifier), and tertiarily by the third element (spatial index).\n$3$. The ground-state configuration consists of the first $N=12$ spin-orbitals from the sorted list.\n$4$. Initialize occupancy arrays $n^\\alpha$ and $n^\\beta$ of size $7$ to all zeros. Iterate through the $12$ occupied spin-orbitals. For each, update the corresponding occupancy entry $n_i^\\sigma$ to $1$.\n$5$. From the final occupancy arrays, calculate $m = \\sum_i n_i^\\alpha - \\sum_i n_i^\\beta$, $s_5 = n_5^\\alpha - n_5^\\beta$, and $s_6 = n_6^\\alpha - n_6^\\beta$.\n$6$. Collate the results for all test cases into the specified final format. This systematic application of quantum mechanical principles and deterministic rules ensures a unique and correct solution for each parameter set.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the spin-magnetization and orbital spin-polarization for a \n    simplified UKS-DFT model of O2 for three parameter sets.\n    \"\"\"\n    \n    # Test cases: (delta, Delta) in eV\n    test_cases = [\n        (0.20, 0.10),  # Case A\n        (0.05, 0.30),  # Case B\n        (0.00, 0.00)   # Case C\n    ]\n\n    # Constants\n    N_electrons = 12\n    num_spatial_orbitals = 7\n    base_energies_initial = np.array([-18.0, -10.0, -8.0, -6.0, -6.0, -4.0, -4.0])\n\n    results = []\n\n    for delta, Delta in test_cases:\n        # Step 1: Calculate spin-orbital energies for the current case\n        \n        base_energies = np.copy(base_energies_initial)\n        \n        # Apply crystal-field splitting delta to pi_g* orbitals (indices 5, 6)\n        base_energies[5] = -4.0 - delta / 2.0\n        base_energies[6] = -4.0 + delta / 2.0\n        \n        spin_orbitals = []\n        \n        # Create a list of all 14 spin-orbitals.\n        # Each is a tuple: (energy, spin_id, spatial_index)\n        # spin_id: 0 for alpha, 1 for beta (for sorting, alpha is prioritized)\n        for i in range(num_spatial_orbitals):\n            energy_i = base_energies[i]\n            \n            # alpha spin\n            energy_alpha = energy_i\n            if i >= 5:  # pi_g* orbitals\n                energy_alpha -= Delta / 2.0\n            spin_orbitals.append((energy_alpha, 0, i))\n            \n            # beta spin\n            energy_beta = energy_i\n            if i >= 5:  # pi_g* orbitals\n                energy_beta += Delta / 2.0\n            spin_orbitals.append((energy_beta, 1, i))\n            \n        # Step 2: Sort spin-orbitals to find the ground state ordering\n        # Python's tuple sorting is lexicographical and perfectly matches the\n        # tie-breaking rules: sort by energy, then spin, then index.\n        spin_orbitals.sort()\n        \n        # Step 3: Fill the lowest N_electrons orbitals\n        occupied_orbitals = spin_orbitals[:N_electrons]\n        \n        # Step 4: Calculate occupancies and derived quantities\n        n_alpha = np.zeros(num_spatial_orbitals, dtype=int)\n        n_beta = np.zeros(num_spatial_orbitals, dtype=int)\n        \n        for _, spin_id, spatial_index in occupied_orbitals:\n            if spin_id == 0:  # alpha electron\n                n_alpha[spatial_index] = 1\n            else:  # beta electron\n                n_beta[spatial_index] = 1\n        \n        # Total number of alpha and beta electrons\n        N_alpha = np.sum(n_alpha)\n        N_beta = np.sum(n_beta)\n        \n        # Total spin magnetization m\n        m = N_alpha - N_beta\n        \n        # Spin polarization on pi_g* orbitals\n        s5 = n_alpha[5] - n_beta[5]\n        s6 = n_alpha[6] - n_beta[6]\n        \n        results.append([m, s5, s6])\n\n    # Final print statement in the exact required format: [[m,s5,s6],[...],...]\n    # without any spaces.\n    formatted_results = \",\".join(f\"[{r[0]},{r[1]},{r[2]}]\" for r in results)\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A common rule of thumb is that a large HOMO-LUMO gap implies low chemical reactivity, but this is an oversimplification. This practice explores a scenario that challenges this notion, revealing a deeper truth about predicting chemical behavior from orbital energies. By analyzing a model electrophile , you will demonstrate that reactivity in charge-transfer processes depends on the absolute energy of the frontier orbitals, particularly the LUMO, relative to a reaction partner, not just the size of the internal KS gap.",
            "id": "2456921",
            "problem": "You are given a minimal one-electron model that serves as a surrogate for the Kohn–Sham (KS) description of a conjugated electrophile. Consider a linear triatomic $\\pi$ system with three atomic sites arranged in a chain. Its one-electron Hamiltonian in the atomic orbital basis is defined by a Hückel-type matrix with diagonal elements $H_{ii}=\\alpha_i$ (on-site energies, in eV) and nearest-neighbor off-diagonal elements $H_{i,i+1}=H_{i+1,i}=\\beta$ (hopping energy, in eV), and all other elements equal to $0$. The KS orbital energies are modeled by the eigenvalues $\\{\\varepsilon_k\\}$ of this matrix. For a system with $N$ electrons under a spin-restricted, closed-shell filling rule, the highest occupied molecular orbital (HOMO) energy $\\varepsilon_{\\mathrm{H}}$ is the energy of the highest fully or singly occupied orbital, and the lowest unoccupied molecular orbital (LUMO) energy $\\varepsilon_{\\mathrm{L}}$ is the next higher eigenvalue. The KS HOMO–LUMO gap is $\\Delta_{\\mathrm{KS}}=\\varepsilon_{\\mathrm{L}}-\\varepsilon_{\\mathrm{H}}$ in eV.\n\nDefine a simple charge-transfer driving force for an electron donor with HOMO energy $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}$ (in eV) interacting with the modeled acceptor (the triatomic system) as\n$$\n\\Delta E_{\\mathrm{CT}}=\\varepsilon_{\\mathrm{L}}-\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}-J,\n$$\nwhere $J$ (in eV) is an effective Coulomb stabilization upon charge separation. Interpret $\\Delta E_{\\mathrm{CT}}\\le 0$ as an exergonic electron-transfer propensity (i.e., “reactive” toward the donor under this model). A “large” KS gap is defined by the threshold $\\Delta_{\\mathrm{KS}}\\ge G_{\\mathrm{thr}}$, with $G_{\\mathrm{thr}}=4.0$ eV.\n\nYour task is to, for each test case below, compute:\n- the KS HOMO–LUMO gap $\\Delta_{\\mathrm{KS}}$ in eV,\n- the charge-transfer driving force $\\Delta E_{\\mathrm{CT}}$ in eV,\n- a boolean reporting whether both conditions hold simultaneously: $\\Delta_{\\mathrm{KS}}\\ge G_{\\mathrm{thr}}$ and $\\Delta E_{\\mathrm{CT}}\\le 0$.\n\nInterpret this simultaneous satisfaction as the “apparent contradiction” where the KS HOMO–LUMO gap is large, yet the system is predicted to be reactive toward the donor.\n\nUse the following test suite. Each case specifies $\\boldsymbol{\\alpha}=[\\alpha_1,\\alpha_2,\\alpha_3]$ (in eV), $\\beta$ (in eV), $N$ (electrons), $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}$ (in eV), and $J$ (in eV):\n- Case $1$: $\\boldsymbol{\\alpha}=[0.0,-4.0,0.0]$, $\\beta=-2.5$, $N=2$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$, $J=4.2$.\n- Case $2$: $\\boldsymbol{\\alpha}=[0.0,-3.0,0.0]$, $\\beta=-2.5$, $N=2$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-5.0$, $J=2.0$.\n- Case $3$: $\\boldsymbol{\\alpha}=[0.0,0.0,0.0]$, $\\beta=-2.82842712474619$, $N=2$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-6.0$, $J=1.0$.\n- Case $4$: $\\boldsymbol{\\alpha}=[0.0,-4.0,0.0]$, $\\beta=-2.5$, $N=3$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$, $J=4.2$.\n\nAngle units do not appear. Energies must be treated and computed in eV. The final output of your program should be a single line containing a comma-separated list of booleans enclosed in square brackets indicating, for Cases $1$ through $4$ respectively, whether the “apparent contradiction” holds. For example, the output format must be exactly like $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$ with each $\\text{result}_i$ being either $\\text{True}$ or $\\text{False}$.",
            "solution": "The provided problem is scientifically grounded, well-posed, and objective. It presents a simplified but valid model from computational chemistry to explore the relationship between the Kohn-Sham (KS) orbital gap and chemical reactivity. It is free of contradictions or ambiguities and can be solved through standard mathematical procedures. We will therefore proceed with a rigorous analytical solution.\n\nThe core of the problem is to analyze a one-electron model for a linear, triatomic $\\pi$ system. The electronic structure is described by a $3 \\times 3$ Hückel-type Hamiltonian matrix, $H$, whose elements are given in the atomic orbital basis. The diagonal elements are the on-site energies, $H_{ii} = \\alpha_i$, and the nearest-neighbor off-diagonal elements are the hopping energies, $H_{i,i+1} = H_{i+1,i} = \\beta$. All other elements are zero. The general form of this matrix is:\n$$\nH = \\begin{pmatrix} \\alpha_1  \\beta  0 \\\\ \\beta  \\alpha_2  \\beta \\\\ 0  \\beta  \\alpha_3 \\end{pmatrix}\n$$\nThe eigenvalues $\\{\\varepsilon_k\\}$ of this matrix represent the KS orbital energies. As $H$ is a real, symmetric matrix, its eigenvalues are guaranteed to be real. These eigenvalues are the roots of the characteristic equation $\\det(H - \\varepsilon I) = 0$, where $I$ is the $3 \\times 3$ identity matrix. The equation is:\n$$\n(\\alpha_1 - \\varepsilon)[(\\alpha_2 - \\varepsilon)(\\alpha_3 - \\varepsilon) - \\beta^2] - \\beta[\\beta(\\alpha_3 - \\varepsilon)] = 0\n$$\nSolving this cubic equation yields the three orbital energies, which we order as $\\varepsilon_1 \\le \\varepsilon_2 \\le \\varepsilon_3$.\n\nBased on the number of electrons, $N$, and a spin-restricted filling rule, the number of occupied orbitals is $N_{\\mathrm{occ}} = \\lceil N/2 \\rceil$. The highest occupied molecular orbital (HOMO) energy, $\\varepsilon_{\\mathrm{H}}$, and the lowest unoccupied molecular orbital (LUMO) energy, $\\varepsilon_{\\mathrm{L}}$, are then identified as:\n$$\n\\varepsilon_{\\mathrm{H}} = \\varepsilon_{N_{\\mathrm{occ}}} \\quad \\text{and} \\quad \\varepsilon_{\\mathrm{L}} = \\varepsilon_{N_{\\mathrm{occ}}+1}\n$$\nFrom these, we compute two key quantities:\n1.  The KS HOMO-LUMO gap: $\\Delta_{\\mathrm{KS}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}$\n2.  The charge-transfer driving force: $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J$\n\nThe problem defines an \"apparent contradiction\" as the simultaneous satisfaction of two conditions:\n1.  A large KS gap: $\\Delta_{\\mathrm{KS}} \\ge G_{\\mathrm{thr}}$, where the threshold is $G_{\\mathrm{thr}} = 4.0$ eV.\n2.  An exergonic propensity for charge transfer: $\\Delta E_{\\mathrm{CT}} \\le 0$ eV.\n\nWe now apply this procedure systematically to each specified test case.\n\n**Case 1:**\n- Parameters: $\\boldsymbol{\\alpha}=[0.0, -4.0, 0.0]$ eV, $\\beta=-2.5$ eV, $N=2$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$ eV, $J=4.2$ eV.\n- The Hamiltonian is $H_1 = \\begin{pmatrix} 0.0  -2.5  0.0 \\\\ -2.5  -4.0  -2.5 \\\\ 0.0  -2.5  0.0 \\end{pmatrix}$.\n- The characteristic equation is $-\\varepsilon[(\\varepsilon+4.0)\\varepsilon - (-2.5)^2] - (-2.5)[(-2.5)(-\\varepsilon)] = -\\varepsilon(\\varepsilon^2 + 4.0\\varepsilon - 12.5) = 0$.\n- The eigenvalues are $\\varepsilon = 0$ and the roots of $\\varepsilon^2 + 4.0\\varepsilon - 12.5 = 0$, which are $\\varepsilon = -2.0 \\pm \\sqrt{16.5}$.\n- The sorted eigenvalues are $\\varepsilon_1 = (-2.0 - \\sqrt{16.5}) \\approx -6.062$ eV, $\\varepsilon_2 = 0.0$ eV, and $\\varepsilon_3 = (-2.0 + \\sqrt{16.5}) \\approx 2.062$ eV.\n- For $N=2$ electrons, $N_{\\mathrm{occ}} = \\lceil 2/2 \\rceil = 1$.\n- $\\varepsilon_{\\mathrm{H}} = \\varepsilon_1 = (-2.0 - \\sqrt{16.5})$ eV.\n- $\\varepsilon_{\\mathrm{L}} = \\varepsilon_2 = 0.0$ eV.\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}} = (2.0 + \\sqrt{16.5}) \\approx 6.062$ eV.\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = 0.0 - (-4.0) - 4.2 = -0.2$ eV.\n- Condition check: $\\Delta_{\\mathrm{KS}} \\approx 6.062 \\ge 4.0$ (True) and $\\Delta E_{\\mathrm{CT}} = -0.2 \\le 0$ (True).\n- Both conditions hold. The result for this case is **True**.\n\n**Case 2:**\n- Parameters: $\\boldsymbol{\\alpha}=[0.0, -3.0, 0.0]$ eV, $\\beta=-2.5$ eV, $N=2$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-5.0$ eV, $J=2.0$ eV.\n- The Hamiltonian is $H_2 = \\begin{pmatrix} 0.0  -2.5  0.0 \\\\ -2.5  -3.0  -2.5 \\\\ 0.0  -2.5  0.0 \\end{pmatrix}$.\n- The characteristic equation is $-\\varepsilon(\\varepsilon^2 + 3.0\\varepsilon - 12.5) = 0$.\n- The eigenvalues are $\\varepsilon = 0$ and $\\varepsilon = -1.5 \\pm \\sqrt{14.75}$.\n- The sorted eigenvalues are $\\varepsilon_1 \\approx -5.341$ eV, $\\varepsilon_2 = 0.0$ eV, $\\varepsilon_3 \\approx 2.341$ eV.\n- For $N=2$ electrons, $N_{\\mathrm{occ}} = 1$. $\\varepsilon_{\\mathrm{H}} = \\varepsilon_1$ and $\\varepsilon_{\\mathrm{L}} = \\varepsilon_2$.\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_2 - \\varepsilon_1 \\approx 5.341$ eV.\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = 0.0 - (-5.0) - 2.0 = 3.0$ eV.\n- Condition check: $\\Delta_{\\mathrm{KS}} \\approx 5.341 \\ge 4.0$ (True) but $\\Delta E_{\\mathrm{CT}} = 3.0 \\le 0$ (False).\n- The result for this case is **False**.\n\n**Case 3:**\n- Parameters: $\\boldsymbol{\\alpha}=[0.0, 0.0, 0.0]$ eV, $\\beta=-2\\sqrt{2} \\approx -2.828$ eV, $N=2$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-6.0$ eV, $J=1.0$ eV.\n- The Hamiltonian is for the standard allyl system, $H_3 = \\begin{pmatrix} 0  \\beta  0 \\\\ \\beta  0  \\beta \\\\ 0  \\beta  0 \\end{pmatrix}$.\n- The eigenvalues are known to be $\\varepsilon=0, \\pm\\sqrt{2}\\beta$. With $\\beta = -2\\sqrt{2}$, these are $\\varepsilon=0, \\pm\\sqrt{2}(-2\\sqrt{2}) = \\mp 4.0$.\n- The sorted eigenvalues are $\\varepsilon_1 = -4.0$ eV, $\\varepsilon_2 = 0.0$ eV, $\\varepsilon_3 = 4.0$ eV.\n- For $N=2$ electrons, $N_{\\mathrm{occ}} = 1$. $\\varepsilon_{\\mathrm{H}} = \\varepsilon_1 = -4.0$ eV and $\\varepsilon_{\\mathrm{L}} = \\varepsilon_2 = 0.0$ eV.\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_2 - \\varepsilon_1 = 0.0 - (-4.0) = 4.0$ eV.\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = 0.0 - (-6.0) - 1.0 = 5.0$ eV.\n- Condition check: $\\Delta_{\\mathrm{KS}} = 4.0 \\ge 4.0$ (True) but $\\Delta E_{\\mathrm{CT}} = 5.0 \\le 0$ (False).\n- The result for this case is **False**.\n\n**Case 4:**\n- Parameters: $\\boldsymbol{\\alpha}=[0.0, -4.0, 0.0]$ eV, $\\beta=-2.5$ eV, $N=3$, $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$ eV, $J=4.2$ eV.\n- The Hamiltonian and its eigenvalues are identical to Case 1.\n- The eigenvalues are $\\varepsilon_1 \\approx -6.062$ eV, $\\varepsilon_2 = 0.0$ eV, and $\\varepsilon_3 \\approx 2.062$ eV.\n- For $N=3$ electrons, $N_{\\mathrm{occ}} = \\lceil 3/2 \\rceil = 2$.\n- $\\varepsilon_{\\mathrm{H}} = \\varepsilon_2 = 0.0$ eV.\n- $\\varepsilon_{\\mathrm{L}} = \\varepsilon_3 = (-2.0 + \\sqrt{16.5}) \\approx 2.062$ eV.\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}} \\approx 2.062$ eV.\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = (-2.0 + \\sqrt{16.5}) - (-4.0) - 4.2 = (-2.2 + \\sqrt{16.5}) \\approx 1.862$ eV.\n- Condition check: $\\Delta_{\\mathrm{KS}} \\approx 2.062 \\ge 4.0$ (False). The first condition fails.\n- The result for this case is **False**.\n\nThis rigorous analysis demonstrates that only the first case presents the \"apparent contradiction\", highlighting the fact that a large KS gap alone is not a sufficient predictor of chemical inertness. The reactivity in this charge-transfer model is determined by the absolute position of the LUMO, not just its separation from the HOMO.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases, determining if an \"apparent contradiction\"\n    between a large KS gap and predicted reactivity exists.\n    \"\"\"\n\n    # Each test case is a tuple: (alpha_vector, beta, N, e_h_don, J)\n    # alpha_vector: on-site energies [a1, a2, a3] in eV\n    # beta: hopping energy in eV\n    # N: number of electrons\n    # e_h_don: donor HOMO energy in eV\n    # J: Coulomb stabilization in eV\n    test_cases = [\n        ([0.0, -4.0, 0.0], -2.5, 2, -4.0, 4.2),  # Case 1\n        ([0.0, -3.0, 0.0], -2.5, 2, -5.0, 2.0),  # Case 2\n        ([0.0, 0.0, 0.0], -2.82842712474619, 2, -6.0, 1.0),  # Case 3\n        ([0.0, -4.0, 0.0], -2.5, 3, -4.0, 4.2),  # Case 4\n    ]\n\n    G_thr = 4.0  # Threshold for \"large\" KS gap in eV\n    results = []\n\n    for case in test_cases:\n        alpha, beta, N, e_h_don, J = case\n        \n        # Construct the 3x3 Hückel-type Hamiltonian matrix\n        H = np.array([\n            [alpha[0], beta, 0],\n            [beta, alpha[1], beta],\n            [0, beta, alpha[2]]\n        ])\n        \n        # Calculate the eigenvalues (orbital energies).\n        # np.linalg.eigh returns eigenvalues in ascending order.\n        eigenvalues = np.linalg.eigh(H)[0]\n        \n        # Determine the number of occupied orbitals based on N\n        # n_occ is 1-indexed for orbital numbering (e.g., orbital 1, 2, 3)\n        n_occ = int(np.ceil(N / 2.0))\n        \n        # Identify HOMO and LUMO energies. Arrays are 0-indexed.\n        # e.g., for n_occ=1, HOMO is eigenvalues[0], LUMO is eigenvalues[1]\n        e_homo = eigenvalues[n_occ - 1]\n        e_lumo = eigenvalues[n_occ]\n        \n        # Compute the KS HOMO-LUMO gap\n        delta_ks = e_lumo - e_homo\n        \n        # Compute the charge-transfer driving force\n        delta_ect = e_lumo - e_h_don - J\n        \n        # Check for the \"apparent contradiction\"\n        # Condition 1: Large KS gap\n        # Condition 2: Exergonic charge transfer\n        is_contradiction = (delta_ks >= G_thr) and (delta_ect = 0)\n        \n        results.append(is_contradiction)\n\n    # Format the final output as a single line: a comma-separated list of booleans\n    # Example: [True,False,False,False]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In practical computations, it's not uncommon to encounter results that seem to defy physical principles, such as a negative HOMO-LUMO gap. For any stable, isolated molecule, a true Kohn-Sham gap must be non-negative, so such a result is a clear red flag indicating a computational problem. This diagnostic exercise  trains you to be a computational detective, identifying the plausible numerical, algorithmic, or user-input errors that can lead to this unphysical outcome and reinforcing the theoretical foundations of the Self-Consistent Field procedure.",
            "id": "2456932",
            "problem": "A student performs a Kohn-Sham (KS) density functional theory (DFT) calculation on an isolated molecule and reads from the output that the Highest Occupied Molecular Orbital (HOMO)–Lowest Unoccupied Molecular Orbital (LUMO) gap is negative. The KS orbital energies are the eigenvalues $\\{\\varepsilon_i\\}$ of the KS one-electron operator, and at zero electronic temperature with integer occupations, the HOMO-LUMO gap is defined as $\\Delta_{\\mathrm{KS}}=\\varepsilon_{\\mathrm{LUMO}}-\\varepsilon_{\\mathrm{HOMO}}$. Which of the following are plausible physical and/or computational reasons that could lead to a reported negative value for $\\Delta_{\\mathrm{KS}}$ in such a molecular calculation? Select all that apply.\n\nA. The Self-Consistent Field (SCF) cycle did not reach a true stationary point, so the final occupations violate the Aufbau principle relative to the eigenvalue ordering, and the reported “HOMO” is not actually the highest occupied eigenvalue.\n\nB. For a finite closed-shell molecule at zero electronic temperature, a truly negative KS HOMO-LUMO gap is a physically allowed outcome that reflects electron correlation missing in the exchange–correlation functional.\n\nC. In an unrestricted (spin-polarized) KS calculation, defining the “gap” across spin channels (for example, subtracting the $\\beta$-spin LUMO from the $\\alpha$-spin HOMO) can yield a negative number even though within each spin channel the gap is nonnegative.\n\nD. Using Fermi–Dirac smearing (finite electronic temperature) can produce fractional occupations; if the code defines the “gap” relative to a smeared Fermi level in a nearly degenerate manifold, it may report a negative value.\n\nE. A basis set with severe linear dependence or overly diffuse functions can introduce numerical artifacts (spurious low-lying “ghost” orbitals) and unstable orbital ordering; combined with misassigned occupations, the printed “gap” can appear negative.\n\nF. The well-known KS band-gap problem implies that approximate functionals always yield negative KS gaps for anions, so a negative value is expected whenever the molecule is an anion.\n\nG. An incorrect specification of total charge or spin multiplicity can place the system in an unphysical electronic configuration; together with smearing or a nonconverged SCF, this can produce an apparent negative “gap” in the output.",
            "solution": "The problem asks for plausible reasons for obtaining a negative Kohn-Sham (KS) Highest Occupied Molecular Orbital (HOMO) to Lowest Unoccupied Molecular Orbital (LUMO) gap, $\\Delta_{\\mathrm{KS}} = \\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}}  0$, in a calculation on an isolated molecule.\n\nFirst, we must establish the fundamental principle. For an isolated N-electron system at zero electronic temperature ($T=0$), the ground state electronic configuration is obtained by filling the $N$ lowest-energy single-particle KS orbitals, a procedure known as the Aufbau principle. The KS orbitals $\\phi_i$ and their corresponding energies $\\varepsilon_i$ are solutions to the KS equation $\\hat{f}_{\\mathrm{KS}}\\phi_i = \\varepsilon_i\\phi_i$. By definition, at the true ground-state minimum, any occupied orbital must have an energy less than or equal to the energy of any unoccupied orbital. The HOMO is the highest-energy occupied orbital, and the LUMO is the lowest-energy unoccupied orbital. Therefore, for a true, stable ground state, it is a mathematical necessity that $\\varepsilon_{\\mathrm{HOMO}} \\le \\varepsilon_{\\mathrm{LUMO}}$, which implies the KS gap must be non-negative: $\\Delta_{\\mathrm{KS}} \\ge 0$. A report of a negative gap, $\\varepsilon_{\\mathrm{LUMO}}  \\varepsilon_{\\mathrm{HOMO}}$, is an unambiguous indication that the calculation has not produced the true ground state according to the Aufbau principle. This can be due to a failure in the algorithm, a numerical artifact, a misconfigured calculation, or an inappropriate definition of the \"gap\". We will evaluate each option against this principle.\n\nA. The Self-Consistent Field (SCF) cycle did not reach a true stationary point, so the final occupations violate the Aufbau principle relative to the eigenvalue ordering, and the reported “HOMO” is not actually the highest occupied eigenvalue.\n\nThe SCF procedure is iterative. If it terminates before reaching a true minimum on the potential energy surface, the resulting electron density and KS potential may not be consistent with the final orbital energy ordering. The program may assign occupations based on the orbital ordering of an earlier iteration and then perform a final diagonalization. If the orbital ordering changes in this last step, an orbital that was assigned an occupied status may end up with a higher energy than an orbital assigned an unoccupied status. This directly leads to a situation where the orbital labeled \"HOMO\" has energy $\\varepsilon_{\\mathrm{HOMO}}$ and the orbital labeled \"LUMO\" has energy $\\varepsilon_{\\mathrm{LUMO}}$, such that $\\varepsilon_{\\mathrm{HOMO}}  \\varepsilon_{\\mathrm{LUMO}}$. This is a classic symptom of a non-converged or poorly converged SCF calculation. Therefore, this is a very plausible computational reason.\n\n**Verdict: Correct.**\n\nB. For a finite closed-shell molecule at zero electronic temperature, a truly negative KS HOMO-LUMO gap is a physically allowed outcome that reflects electron correlation missing in the exchange–correlation functional.\n\nThis statement is fundamentally incorrect. A negative KS gap for the ground state of a stable molecule is not a physical outcome. It implies that the electronic state is unstable, as an electron could lower its energy by moving from the \"HOMO\" to the \"LUMO\". The system would spontaneously reconfigure its occupations to satisfy the Aufbau principle, meaning the state with the negative gap was not the ground state to begin with. The deficiencies of approximate exchange-correlation functionals (the \"missing\" electron correlation) manifest as an incorrect *magnitude* of the gap (the well-known band-gap problem, where the gap is typically underestimated), or an incorrect absolute position of the orbital energies, but not as a reversal of the sign of the gap for a stable ground state configuration.\n\n**Verdict: Incorrect.**\n\nC. In an unrestricted (spin-polarized) KS calculation, defining the “gap” across spin channels (for example, subtracting the $\\beta$-spin LUMO from the $\\alpha$-spin HOMO) can yield a negative number even though within each spin channel the gap is nonnegative.\n\nIn an unrestricted (UKS) calculation, separate KS equations are solved for spin-$\\alpha$ and spin-$\\beta$ electrons, yielding two distinct sets of orbitals and energies, $\\{\\varepsilon_i^{\\alpha}\\}$ and $\\{\\varepsilon_i^{\\beta}\\}$. Within each spin channel, the Aufbau principle holds for the ground state, so $\\Delta_{\\alpha} = \\varepsilon_{\\mathrm{LUMO}}^{\\alpha} - \\varepsilon_{\\mathrm{HOMO}}^{\\alpha} \\ge 0$ and $\\Delta_{\\beta} = \\varepsilon_{\\mathrm{LUMO}}^{\\beta} - \\varepsilon_{\\mathrm{HOMO}}^{\\beta} \\ge 0$. However, there is no fundamental principle that orders the $\\alpha$-spin eigenvalues relative to the $\\beta$-spin eigenvalues. It is entirely possible, especially in highly spin-polarized systems, to have $\\varepsilon_{\\mathrm{HOMO}}^{\\alpha}  \\varepsilon_{\\mathrm{LUMO}}^{\\beta}$ or $\\varepsilon_{\\mathrm{HOMO}}^{\\beta}  \\varepsilon_{\\mathrm{LUMO}}^{\\alpha}$. If a \"gap\" were to be defined by mixing spin channels, for example as $\\Delta' = \\varepsilon_{\\mathrm{LUMO}}^{\\beta} - \\varepsilon_{\\mathrm{HOMO}}^{\\alpha}$, this value could certainly be negative. While this is not the fundamental gap of the system, it is a number that could be calculated from the output, and it is a plausible scenario.\n\n**Verdict: Correct.**\n\nD. Using Fermi–Dirac smearing (finite electronic temperature) can produce fractional occupations; if the code defines the “gap” relative to a smeared Fermi level in a nearly degenerate manifold, it may report a negative value.\n\nFermi-Dirac smearing is a numerical technique to aid SCF convergence by modeling the system at a finite electronic temperature ($T_e  0$). This results in orbital occupations $n_i$ given by $n_i = (1 + \\exp((\\varepsilon_i - \\mu)/k_B T_e))^{-1}$, where $\\mu$ is the Fermi level. In this formalism, the clear distinction between occupied and unoccupied orbitals is lost. The standard definitions of HOMO and LUMO no longer apply. A program might still attempt to report a \"HOMO-LUMO gap\" based on an ad-hoc criterion (e.g., identifying orbitals with occupations closest to $1$ and $0$). In a situation with many nearly degenerate orbitals around the Fermi level, this automated labeling can easily fail or be misleading, especially if the SCF cycle is not fully converged. The report of a negative \"gap\" is a possible artifact of applying a $T=0$ concept to a $T_e0$ calculation with fractional occupations.\n\n**Verdict: Correct.**\n\nE. A basis set with severe linear dependence or overly diffuse functions can introduce numerical artifacts (spurious low-lying “ghost” orbitals) and unstable orbital ordering; combined with misassigned occupations, the printed “gap” can appear negative.\n\nThis describes a critical numerical problem. When basis functions are nearly linearly dependent, the overlap matrix $\\mathbf{S}$ becomes ill-conditioned (nearly singular). Solving the generalized eigenvalue equation $\\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\mathbf{\\epsilon}$ becomes numerically unstable. This instability can produce spurious, unphysical eigenvalues, often called \"ghost\" orbitals. It is possible for such a spurious, unoccupied orbital to have a very low, or even negative, energy. If such an artifactual orbital's energy appears below the energy of the true HOMO, the program, in its routine sorting of eigenvalues, would report $\\varepsilon_{\\mathrm{LUMO}}  \\varepsilon_{\\mathrm{HOMO}}$. This is a well-known consequence of using inadequate or poorly chosen basis sets.\n\n**Verdict: Correct.**\n\nF. The well-known KS band-gap problem implies that approximate functionals always yield negative KS gaps for anions, so a negative value is expected whenever the molecule is an anion.\n\nThis is a misinterpretation of the consequences of approximate functionals for anions. For a stable anion, the exact KS HOMO energy is equal to the negative of its ionization potential, so $\\varepsilon_{\\mathrm{HOMO}} = -A  0$. Many approximate functionals fail to bind the extra electron correctly due to the incorrect asymptotic behavior of the exchange-correlation potential, leading to a calculated $\\varepsilon_{\\mathrm{HOMO}}  0$. This indicates that the anion is artifactually predicted to be unstable in the gas phase. However, this is an issue with the absolute energy of the HOMO, not the sign of the gap. Even in such a faulty calculation, the Aufbau principle would still be enforced by the SCF algorithm, ensuring that $\\varepsilon_{\\mathrm{LUMO}} \\ge \\varepsilon_{\\mathrm{HOMO}}$. The gap $\\Delta_{\\mathrm{KS}}$ would remain non-negative. The statement that approximate functionals *always* yield *negative gaps* for anions is false.\n\n**Verdict: Incorrect.**\n\nG. An incorrect specification of total charge or spin multiplicity can place the system in an unphysical electronic configuration; together with smearing or a nonconverged SCF, this can produce an apparent negative “gap” in the output.\n\nSpecifying an incorrect total charge or spin multiplicity is a common user error. This forces the SCF procedure to attempt to find a minimum for an electronic configuration that may not be a stable state (e.g., a high-energy excited state, or a highly charged anion that is physically unbound). Such calculations are often difficult to converge, and are prone to the very SCF failures described in option (A). The system is being forced into an unphysical region of the conformational space of electronic structures. The combination of an ill-posed physical problem with the inherent difficulties of the SCF algorithm makes it highly plausible that the calculation will fail to converge properly and report nonsensical results, including a negative HOMO-LUMO gap.\n\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ACDEG}$$"
        }
    ]
}