{
    "hands_on_practices": [
        {
            "introduction": "One of the most significant shortcomings of standard density functional approximations is the self-interaction error, where an electron spuriously interacts with its own charge density. This practice will guide you through a fundamental derivation  to reveal how this error can be exactly eliminated. By analyzing the simplest possible molecular system, the hydrogen molecular ion ($\\mathrm{H}_{2}^{+}$), you will discover the theoretical justification for including Hartree-Fock exchange in what we now call hybrid functionals.",
            "id": "2456401",
            "problem": "Consider the hydrogen molecular ion $\\mathrm{H}_{2}^{+}$ within the Born–Oppenheimer approximation at a fixed internuclear separation. This is a one-electron system. Let the electron density be $\\rho(\\mathbf{r})$ and the occupied spin orbital be $\\varphi(\\mathbf{r})$, so that $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$. The classical Coulomb (Hartree) energy is defined by\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\nFor a single Slater determinant, the Hartree–Fock (HF) exchange energy is defined by\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\nConsider a global hybrid exchange–correlation energy of the form\n$$\nE_{xc}^{\\mathrm{hyb}}[\\rho] = \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] + E_{c}^{\\mathrm{DFA}}[\\rho],\n$$\nwhere $\\alpha \\in [0,1]$ is the HF mixing parameter, $E_{x}^{\\mathrm{DFA}}[\\rho]$ is an exchange energy from a given density functional approximation (DFA), and $E_{c}^{\\mathrm{DFA}}[\\rho]$ is a correlation DFA. For a one-electron density, take the exact correlation energy to be zero and assume the adopted correlation DFA respects this limit, so that $E_{c}^{\\mathrm{DFA}}[\\rho] = 0$ for the present system.\n\nImpose the requirement that the total electron–electron interaction contribution for $\\mathrm{H}_{2}^{+}$ be free of self-interaction error, meaning that the sum of the classical Coulomb energy and the hybrid exchange energy vanishes for any admissible one-electron density $\\rho(\\mathbf{r})$:\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0.\n$$\n\nDetermine the value of $\\alpha$ that satisfies this condition for all one-electron densities of $\\mathrm{H}_{2}^{+}$. Express your final answer as a single real number. No units are required. No rounding is necessary.",
            "solution": "The problem requires finding the value of the Hartree-Fock mixing parameter $\\alpha$ that ensures a global hybrid functional is free of self-interaction error for any one-electron density, such as that of the $\\mathrm{H}_{2}^{+}$ molecular ion. The condition for the total electron-electron interaction contribution to vanish is given as:\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\nwhere it is assumed that the correlation energy $E_{c}^{\\mathrm{DFA}}[\\rho]$ is zero for a one-electron system. This condition must hold for any admissible one-electron density $\\rho(\\mathbf{r})$.\n\nLet the single occupied spin-orbital of the one-electron system be $\\varphi(\\mathbf{r})$. The electron density is therefore $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$. We will now analyze the terms of the given equation for this specific case.\n\nThe classical Coulomb (Hartree) energy, $E_{\\mathrm{H}}[\\rho]$, is defined as:\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nSubstituting the expression for the one-electron density, we obtain:\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nThis term represents the spurious interaction of the electron's charge distribution with itself.\n\nNext, we evaluate the Hartree-Fock (HF) exchange energy, $E_{x}^{\\mathrm{HF}}$. The general definition for a single Slater determinant is:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nFor a system with only one electron, the set of occupied orbitals $\\{\\varphi_{i\\sigma}\\}$ contains a single spin-orbital, which we have denoted as $\\varphi(\\mathbf{r})$. Let us assign it to the spin-up channel, $\\sigma=\\uparrow$, with orbital index $i=1$, so $\\varphi_{1\\uparrow}(\\mathbf{r})=\\varphi(\\mathbf{r})$. The sum over $\\sigma$ will have only the $\\uparrow$ contribution. The sums over indices $i$ and $j$ will each have only one term, $i=1$ and $j=1$. The expression for the HF exchange energy therefore collapses to a single term:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{\\varphi^{*}(\\mathbf{r})\\,\\varphi(\\mathbf{r})\\,\\varphi^{*}(\\mathbf{r}')\\,\\varphi(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\nThis can be rewritten using the fact that $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n\nBy comparing the derived expressions for $E_{\\mathrm{H}}[\\rho]$ and $E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}]$ for a one-electron system, we establish the fundamental identity:\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -E_{\\mathrm{H}}[\\rho]\n$$\nThis identity demonstrates that pure Hartree-Fock theory is exactly free of self-interaction error, as the exchange term precisely cancels the unphysical Hartree self-repulsion.\n\nWe now substitute this identity into the problem's defining condition:\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,(-E_{\\mathrm{H}}[\\rho]) + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\nFactoring the terms gives:\n$$\n(1-\\alpha) E_{\\mathrm{H}}[\\rho] + (1-\\alpha) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n$$\n(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0\n$$\nThis equation must hold true for *any* admissible one-electron density $\\rho(\\mathbf{r})$ and for a given, but not specified, density functional approximation $E_{x}^{\\mathrm{DFA}}[\\rho]$. The term $\\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right)$ represents the self-interaction error inherent in the chosen DFA. Common density functional approximations (such as those from the Local Density or Generalized Gradient families) are not exact and are known to exhibit a non-zero self-interaction error, i.e., $E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\neq 0$ for arbitrary one-electron densities.\n\nFor the equality $(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0$ to be universally true for any $\\rho(\\mathbf{r})$ where the second factor is generally non-zero, the first factor must be identically zero.\nTherefore, we must impose the condition:\n$$\n1 - \\alpha = 0\n$$\nSolving this simple equation for $\\alpha$ yields the unique solution:\n$$\n\\alpha = 1\n$$\nThis result signifies that for a global hybrid functional to be strictly free from self-interaction error for all one-electron systems, it must incorporate $100\\%$ of the Hartree-Fock exchange and completely exclude the DFA exchange component.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "Beyond self-interaction, standard DFT functionals suffer from delocalization error, which incorrectly favors fractional charges distributed over multiple sites instead of integer charges localized on one. This exercise  provides a quantitative model to explore this issue, demonstrating how the energy of a system should behave as electrons are added. You will compare a typical GGA functional with a hybrid functional to see firsthand how mixing in exact exchange helps enforce the correct piecewise-linear behavior and reduces spurious charge delocalization.",
            "id": "1373539",
            "problem": "In Density Functional Theory (DFT), the total energy of a system as a function of the number of electrons, $E(N)$, should ideally be a piecewise linear function with kinks at integer electron numbers. However, many approximate exchange-correlation functionals, such as those based on the Generalized Gradient Approximation (GGA), exhibit a spurious convexity. This \"delocalization error\" artificially favors fractional electron counts on separated fragments. Hybrid functionals, which incorporate a fraction of exact exchange, typically reduce this error.\n\nConsider a single chlorine atom (Cl). For fractional electron numbers in the range $N \\in [17, 18]$, let the number of electrons be represented as $N = 17 + \\delta$, where $\\delta \\in [0, 1]$. We model the total energy as calculated by a GGA functional and a hybrid functional as:\n$$E_{\\text{GGA}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{GGA}}\\delta(1-\\delta)$$\n$$E_{\\text{hyb}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{hyb}}\\delta(1-\\delta)$$\nwhere $E(17)$ and $E(18)$ are the exact total energies of the neutral Cl atom and the Cl$^{-}$ anion, respectively. The positive constants $C_{\\text{GGA}}$ and $C_{\\text{hyb}}$ quantify the convexity, or the severity of the delocalization error, for each functional.\n\nThe values for these parameters are given as:\n- Energy of the neutral chlorine atom, $E(17) = -459.642 \\text{ Hartree}$\n- Energy of the chlorine anion, $E(18) = -459.775 \\text{ Hartree}$\n- GGA convexity parameter, $C_{\\text{GGA}} = 0.210 \\text{ Hartree}$\n- Hybrid functional convexity parameter, $C_{\\text{hyb}} = 0.055 \\text{ Hartree}$\n\nNow, consider a system composed of two identical, non-interacting chlorine atoms. If one electron is added to this two-atom system, the correct ground state corresponds to the electron localizing on one atom, forming a [Cl, Cl$^-$] pair. However, due to delocalization error, an approximate functional might incorrectly predict a lower energy for a state where the electron is delocalized over both atoms, resulting in a [Cl$^{-0.5}$, Cl$^{-0.5}$] system.\n\nCalculate the ratio of the spurious delocalization stabilization energy for the GGA functional to that for the hybrid functional. The spurious delocalization stabilization energy is defined as the energy of the delocalized state [Cl$^{-0.5}$, Cl$^{-0.5}$] minus the energy of the correct localized state [Cl, Cl$^-$]. Round your final answer to three significant figures.",
            "solution": "For a single atom with $N=17+\\delta$, the approximate energy with a given functional characterized by convexity parameter $C$ is\n$$\nE_{\\text{fun}}(17+\\delta)=(1-\\delta)E(17)+\\delta E(18)-C\\,\\delta(1-\\delta).\n$$\nFor two non-interacting chlorine atoms with one extra electron, the localized state [Cl, Cl$^{-}$] has one atom at $\\delta=0$ and the other at $\\delta=1$, so its total energy is\n$$\nE_{\\text{loc}}=E_{\\text{fun}}(17)+E_{\\text{fun}}(18)=E(17)+E(18).\n$$\nThe delocalized state [Cl$^{-0.5}$, Cl$^{-0.5}$] has each atom at $\\delta=\\frac{1}{2}$, giving per-atom energy\n$$\nE_{\\text{fun}}(17+\\tfrac{1}{2})=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-C\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-\\tfrac{C}{4}.\n$$\nThus the total energy of the delocalized state is\n$$\nE_{\\text{deloc}}=2E_{\\text{fun}}(17+\\tfrac{1}{2})=E(17)+E(18)-\\tfrac{C}{2}.\n$$\nThe spurious delocalization stabilization energy (delocalized minus localized) is therefore\n$$\n\\Delta E_{\\text{fun}}=E_{\\text{deloc}}-E_{\\text{loc}}=-\\tfrac{C}{2}.\n$$\nHence, the ratio of the GGA to hybrid stabilization energies is\n$$\nR=\\frac{\\Delta E_{\\text{GGA}}}{\\Delta E_{\\text{hyb}}}=\\frac{-\\tfrac{C_{\\text{GGA}}}{2}}{-\\tfrac{C_{\\text{hyb}}}{2}}=\\frac{C_{\\text{GGA}}}{C_{\\text{hyb}}}.\n$$\nInserting the given values,\n$$\nR=\\frac{0.210}{0.055}=\\frac{210}{55}=\\frac{42}{11}\\approx 3.81818\\ldots\n$$\nRounded to three significant figures, this is $3.82$.",
            "answer": "$$\\boxed{3.82}$$"
        },
        {
            "introduction": "The theoretical corrections offered by hybrid functionals have profound consequences for the electronic structure of complex systems, such as conjugated polymers. This computational practice  challenges you to build a simplified model of a polyene chain to visualize these effects. By varying a parameter that mimics the inclusion of exact exchange, you will observe how the highest occupied molecular orbital (HOMO) transitions from being overly delocalized to correctly localized, a crucial factor in determining the material's electronic properties.",
            "id": "2456372",
            "problem": "You are asked to construct and run a minimal, fully specified computational experiment that captures, at the level of a simplified tight-binding model, how hybrid functionals reduce the over-delocalization of the highest occupied molecular orbital (HOMO) in a long polyene chain.\n\nModel definition:\n- Consider a one-dimensional chain of $N$ sites with open boundary conditions representing a polyene. The one-electron Hamiltonian $H(a)$ acts in the site basis and is represented by an $N \\times N$ real symmetric matrix with elements\n  - On-site energies: $H_{i,i}(a) = V_i$ for $i \\in \\{1,\\dots,N\\}$,\n  - Nearest-neighbor couplings: $H_{i,i+1}(a) = H_{i+1,i}(a) = -t \\left[ 1 + (-1)^i d(a) \\right]$ for $i \\in \\{1,\\dots,N-1\\}$,\n  - All other elements are zero.\n- The external potential is a uniform field along the chain that breaks inversion symmetry, given by $V_i = s \\left( i - \\frac{N+1}{2} \\right)$, where $s$ is the field strength.\n- The bond-alternation parameter $d(a)$ models the strengthening of bond-length alternation associated with increasing the fraction of exact exchange in a hybrid functional. It is defined as $d(a) = d_0 + k a$, where $a \\in [0,1]$ is a parameter representing the fraction of exact exchange, and $d_0$ and $k$ are given constants. This Hamiltonian is a Hückel–Peierls model that uses $d(a)$ as a proxy variable to encode the qualitative effect that hybrid functionals increase the band gap and thereby reduce over-delocalization.\n\nElectronic structure and observable:\n- Assume a neutral polyene with $2N$ $\\pi$ electrons and spin degeneracy of $2$, so exactly $N$ spatial orbitals are occupied. Let the eigenvalues of $H(a)$ be ordered as $\\varepsilon_1 \\le \\varepsilon_2 \\le \\dots \\le \\varepsilon_N$, with corresponding normalized eigenvectors $\\psi^{(1)},\\dots,\\psi^{(N)}$. The HOMO is the eigenvector $\\psi^{(N)}$ associated with $\\varepsilon_N$.\n- Define the inverse participation ratio (IPR) of the HOMO as $\\mathrm{IPR} = \\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^4$, where $\\psi^{(N)}_i$ is the $i$-th component of the normalized HOMO eigenvector in the site basis. A larger $\\mathrm{IPR}$ indicates stronger spatial localization.\n\nTask:\n- For each parameter set in the test suite below, construct $H(a)$ exactly as defined, compute its eigen-decomposition, identify the HOMO, and compute the corresponding $\\mathrm{IPR}$.\n- Your program must output a single line that is a comma-separated list of the $\\mathrm{IPR}$ values, enclosed in square brackets, in the same order as the test suite. Each $\\mathrm{IPR}$ must be rounded to $6$ decimal places.\n\nTest suite:\n- Use the constants $d_0 = 0.04$ and $k = 0.20$ for all cases. Use the Hamiltonian units consistently for all quantities.\n- Case $1$ (baseline, no field, no hybrid mixing): $N = 80$, $t = 1.0$, $s = 0.0$, $a = 0.00$.\n- Case $2$ (field applied, no hybrid mixing): $N = 80$, $t = 1.0$, $s = 0.01$, $a = 0.00$.\n- Case $3$ (field applied, moderate hybrid mixing): $N = 80$, $t = 1.0$, $s = 0.01$, $a = 0.25$.\n- Case $4$ (field applied, stronger hybrid mixing): $N = 80$, $t = 1.0$, $s = 0.01$, $a = 0.50$.\n- Case $5$ (longer chain, field applied, stronger hybrid mixing): $N = 200$, $t = 1.0$, $s = 0.005$, $a = 0.50$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, `[\\mathrm{IPR}_1,\\mathrm{IPR}_2,\\mathrm{IPR}_3,\\mathrm{IPR}_4,\\mathrm{IPR}_5]`, with each entry rounded to $6$ decimal places.",
            "solution": "We formalize a Hückel–Peierls tight-binding description of a polyene and incorporate a proxy for hybrid functional effects. The core scientific principle is that hybrid functionals increase the electronic band gap by including a fraction of exact exchange, which reduces the delocalization error characteristic of semilocal approximations. In polyenes, increased bond-length alternation enhances the gap. In the presence of a weak symmetry-breaking field, a larger gap makes the frontier orbitals more spatially confined (shorter localization length). We cast this in a strictly defined Hamiltonian whose parameters can be varied and whose predictions can be quantified by the inverse participation ratio (IPR), an established localization metric.\n\n1. Hamiltonian construction. We define an $N \\times N$ matrix $H(a)$ with\n   - $H_{i,i}(a) = s \\left( i - \\frac{N+1}{2} \\right)$, which applies a linear potential of strength $s$ along the chain to break inversion symmetry and reveal the tendency of the HOMO to localize.\n   - $H_{i,i+1}(a) = H_{i+1,i}(a) = -t \\left[ 1 + (-1)^i d(a) \\right]$ for $i \\in \\{1,\\dots,N-1\\}$, which implements nearest-neighbor hopping with bond alternation.\n   - $d(a) = d_0 + k a$, which models the empirically established trend that increasing the exact exchange fraction $a$ increases bond-length alternation and the band gap in conjugated polymers.\n\n   All other matrix elements are zero. This is a purely mathematical Hamiltonian defined by explicit formulas, with no unspecified parameters.\n\n2. Electronic structure. For a neutral polyene with $2N$ $\\pi$ electrons and spin degeneracy $2$, exactly $N$ spatial orbitals are occupied. Let the eigenvalues of $H(a)$ be ordered as $\\varepsilon_1 \\le \\cdots \\le \\varepsilon_N$ with normalized eigenvectors $\\psi^{(1)},\\dots,\\psi^{(N)}$. The HOMO is $\\psi^{(N)}$. We compute the eigen-decomposition by solving the symmetric eigenproblem for $H(a)$.\n\n3. Localization metric. The inverse participation ratio is defined as\n   $$\\mathrm{IPR} = \\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^4,$$\n   where $\\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^2 = 1$ by normalization. If the HOMO is uniformly delocalized over $N$ sites, then $\\left| \\psi^{(N)}_i \\right|^2 \\approx \\frac{1}{N}$ and $\\mathrm{IPR} \\approx \\frac{1}{N}$. If it is strongly localized on a few sites, the IPR becomes larger, approaching $1$ in the extreme single-site limit.\n\n4. Algorithmic steps for each test case:\n   - Compute $d(a) = d_0 + k a$ from the given $a$, $d_0$, and $k$.\n   - Assemble the tridiagonal Hamiltonian with diagonal entries $H_{i,i} = s \\left( i - \\frac{N+1}{2} \\right)$ and off-diagonal entries $H_{i,i+1} = H_{i+1,i} = -t \\left[ 1 + (-1)^i d(a) \\right]$ for $i \\in \\{1,\\dots,N-1\\}$.\n   - Compute all eigenpairs by diagonalizing $H(a)$. Because $H(a)$ is real symmetric, an orthonormal set of eigenvectors exists and numerical diagonalization is stable.\n   - Select the HOMO eigenvector as the one associated with the largest eigenvalue (index $N$ in ascending order).\n   - Compute $\\mathrm{IPR} = \\sum_{i=1}^N \\left| \\psi^{(N)}_i \\right|^4$.\n   - Round the resulting $\\mathrm{IPR}$ to $6$ decimal places for output formatting.\n\n5. Expected qualitative behavior and coverage:\n   - Case $1$ has $s = 0$ and $a = 0$, giving a uniform chain ($d(a) = d_0$) with inversion symmetry; the HOMO is extended and the $\\mathrm{IPR}$ is small, close to $\\frac{1}{N}$.\n   - Case $2$ switches on a weak field ($s > 0$) at $a = 0$, introducing asymmetry; the HOMO begins to accumulate on one end, slightly increasing the $\\mathrm{IPR}$.\n   - Cases $3$ and $4$ increase $a$ while keeping the field on. Because $d(a)$ increases with $a$, the band gap increases and the HOMO localizes more strongly under the same field, so the $\\mathrm{IPR}$ increases monotonically from Case $2$ to Case $4$.\n   - Case $5$ uses a longer chain to probe the long-chain limit under stronger hybrid mixing; the $\\mathrm{IPR}$ remains significantly larger than in Case $1$ due to enhanced localization relative to a uniform, field-free chain.\n\nThe program implements these steps exactly and prints a single line with the five $\\mathrm{IPR}$ values rounded to $6$ decimal places and formatted as a comma-separated list enclosed in square brackets, as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_hamiltonian(N: int, t: float, s: float, a: float, d0: float, k: float) - np.ndarray:\n    \"\"\"\n    Construct the N x N Hamiltonian matrix H(a) for the Hückel–Peierls chain with:\n      - On-site potential: V_i = s * (i - (N+1)/2)\n      - Alternating hopping: H_{i,i+1} = H_{i+1,i} = -t * [1 + (-1)^i * d(a)]\n        where i is 1-based in the formula; in code we adjust indices accordingly.\n      - d(a) = d0 + k * a\n    Open boundary conditions are used (tridiagonal matrix).\n    \"\"\"\n    H = np.zeros((N, N), dtype=float)\n    # On-site potentials\n    center = (N + 1) / 2.0\n    for i in range(N):\n        H[i, i] = s * ((i + 1) - center)  # i+1 to map to 1-based site index\n\n    # Off-diagonal couplings\n    d_a = d0 + k * a\n    for i in range(N - 1):\n        # Map to 1-based index for alternating sign pattern (-1)^i with i = 1..N-1\n        i1_based = i + 1\n        hop = -t * (1.0 + ((-1) ** i1_based) * d_a)\n        H[i, i + 1] = hop\n        H[i + 1, i] = hop\n\n    return H\n\ndef homo_ipr(H: np.ndarray) - float:\n    \"\"\"\n    Compute the inverse participation ratio (IPR) of the HOMO for Hamiltonian H.\n    The HOMO is the eigenvector associated with the largest eigenvalue (highest occupied),\n    assuming a neutral system with N occupied spatial orbitals (spin-degenerate).\n    \"\"\"\n    # Use eigh for symmetric matrices; returns eigenvalues in ascending order\n    w, v = np.linalg.eigh(H)\n    homo_vec = v[:, -1]  # eigenvector for the largest eigenvalue\n    # Normalize explicitly (eigh returns normalized vectors, but ensure numerical safety)\n    norm = np.linalg.norm(homo_vec)\n    if norm == 0.0:\n        return 0.0\n    psi = homo_vec / norm\n    ipr = float(np.sum(np.abs(psi) ** 4))\n    return ipr\n\ndef solve():\n    # Constants used in all test cases\n    d0 = 0.04\n    k = 0.20\n\n    # Define the test cases from the problem statement: (N, t, s, a)\n    test_cases = [\n        (80, 1.0, 0.0, 0.00),   # Case 1\n        (80, 1.0, 0.01, 0.00),  # Case 2\n        (80, 1.0, 0.01, 0.25),  # Case 3\n        (80, 1.0, 0.01, 0.50),  # Case 4\n        (200, 1.0, 0.005, 0.50) # Case 5\n    ]\n\n    results = []\n    for N, t, s, a in test_cases:\n        H = build_hamiltonian(N=N, t=t, s=s, a=a, d0=d0, k=k)\n        ipr = homo_ipr(H)\n        # Round to 6 decimal places as required\n        results.append(f\"{ipr:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}