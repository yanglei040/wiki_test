{
    "hands_on_practices": [
        {
            "introduction": "我们为什么要将精确的 Hartree-Fock 交换混合到 DFT 泛函中？这项练习通过检验一个简单的单电子体系——氢分子离子（$H_2^+$），触及了问题的核心。通过要求泛函没有自相互作用误差（即电子与自身的虚假相互作用），我们可以推导出所需的“理想”精确交换量，从而为混合泛函方法提供严格的理论依据 。",
            "id": "2456401",
            "problem": "在固定核间距的玻恩-奥本海默近似下，考虑氢分子离子 $\\mathrm{H}_{2}^{+}$。这是一个单电子体系。设电子密度为 $\\rho(\\mathbf{r})$，已占据的自旋轨道为 $\\varphi(\\mathbf{r})$，因此 $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$。经典的库仑（哈特里）能量定义为\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\n对于单个斯莱特行列式，哈特里-福克（HF）交换能定义为\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'.\n$$\n考虑一个形式如下的全局混合交换相关能量\n$$\nE_{xc}^{\\mathrm{hyb}}[\\rho] = \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] + E_{c}^{\\mathrm{DFA}}[\\rho],\n$$\n其中 $\\alpha \\in [0,1]$ 是HF混合参数，$E_{x}^{\\mathrm{DFA}}[\\rho]$ 是来自给定密度泛函近似（DFA）的交换能，$E_{c}^{\\mathrm{DFA}}[\\rho]$ 是一个相关DFA。对于单电子密度，取精确相关能为零，并假设所采用的相关DFA遵循此极限，因此对于当前体系，$E_{c}^{\\mathrm{DFA}}[\\rho] = 0$。\n\n施加一个要求，即 $\\mathrm{H}_{2}^{+}$ 的总电子-电子相互作用贡献没有自相互作用误差，这意味着对于任何容许的单电子密度 $\\rho(\\mathbf{r})$，经典库仑能量与混合交换能量之和为零：\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0.\n$$\n\n确定满足此条件的 $\\alpha$ 值，该条件对 $\\mathrm{H}_{2}^{+}$ 的所有单电子密度均成立。将您的最终答案表示为一个实数。不需要单位。不需要四舍五入。",
            "solution": "该问题要求找到哈特里-福克混合参数 $\\alpha$ 的值，以确保一个全局混合泛函对于任何单电子密度（例如氢分子离子 $\\mathrm{H}_{2}^{+}$ 的密度）都没有自相互作用误差。总电子-电子相互作用贡献为零的条件如下：\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n这里假设对于单电子体系，相关能 $E_{c}^{\\mathrm{DFA}}[\\rho]$ 为零。这个条件必须对任何容许的单电子密度 $\\rho(\\mathbf{r})$ 都成立。\n\n设单电子体系的单一已占据自旋轨道为 $\\varphi(\\mathbf{r})$。因此电子密度为 $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$。我们现在将分析给定方程中各项在此特定情况下的形式。\n\n经典库仑（哈特里）能量 $E_{\\mathrm{H}}[\\rho]$ 定义为：\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n代入单电子密度的表达式，我们得到：\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n这一项表示电子电荷分布与其自身的虚假相互作用。\n\n接下来，我们计算哈特里-福克（HF）交换能 $E_{x}^{\\mathrm{HF}}$。对于单个斯莱特行列式的一般定义是：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi_{i\\sigma}\\}] = -\\frac{1}{2} \\sum_{\\sigma} \\sum_{i,j \\in \\sigma} \\int \\int \\frac{\\varphi_{i\\sigma}^{*}(\\mathbf{r})\\,\\varphi_{j\\sigma}(\\mathbf{r})\\,\\varphi_{j\\sigma}^{*}(\\mathbf{r}')\\,\\varphi_{i\\sigma}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n对于只有一个电子的体系，已占据轨道集 $\\{\\varphi_{i\\sigma}\\}$ 只包含一个自旋轨道，我们已将其表示为 $\\varphi(\\mathbf{r})$。我们将其分配到自旋向上通道，$\\sigma=\\uparrow$，轨道指数为 $i=1$，因此 $\\varphi_{1\\uparrow}(\\mathbf{r})=\\varphi(\\mathbf{r})$。对 $\\sigma$ 的求和将只有 $\\uparrow$ 的贡献。对指数 $i$ 和 $j$ 的求和将各自只有一项，$i=1$ 和 $j=1$。因此，HF交换能的表达式简化为单一项：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{\\varphi^{*}(\\mathbf{r})\\,\\varphi(\\mathbf{r})\\,\\varphi^{*}(\\mathbf{r}')\\,\\varphi(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n利用 $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^{2}$，这可以改写为：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -\\frac{1}{2} \\int \\int \\frac{|\\varphi(\\mathbf{r})|^{2}\\,|\\varphi(\\mathbf{r}')|^{2}}{|\\mathbf{r} - \\mathbf{r}'|}\\, \\mathrm{d}\\mathbf{r}\\,\\mathrm{d}\\mathbf{r}'\n$$\n\n通过比较推导出的单电子体系的 $E_{\\mathrm{H}}[\\rho]$ 和 $E_{x}^{\\mathrm{HF}}[\\{\\varphi\\}]$ 的表达式，我们建立了一个基本恒等式：\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\varphi\\}] = -E_{\\mathrm{H}}[\\rho]\n$$\n这个恒等式表明，纯哈特里-福克理论精确地没有自相互作用误差，因为交换项精确地抵消了非物理的哈特里自排斥。\n\n我们现在将这个恒等式代入问题的定义条件中：\n$$\nE_{\\mathrm{H}}[\\rho] + \\alpha\\,(-E_{\\mathrm{H}}[\\rho]) + \\left(1-\\alpha\\right) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n对各项进行因式分解得到：\n$$\n(1-\\alpha) E_{\\mathrm{H}}[\\rho] + (1-\\alpha) E_{x}^{\\mathrm{DFA}}[\\rho] = 0\n$$\n$$\n(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0\n$$\n这个方程必须对*任何*容许的单电子密度 $\\rho(\\mathbf{r})$ 和给定的（但未指明的）密度泛函近似 $E_{x}^{\\mathrm{DFA}}[\\rho]$ 都成立。项 $\\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right)$ 表示所选DFA固有的自相互作用误差。常见的密度泛函近似（例如来自局域密度或广义梯度族的近似）并非精确，并且已知存在非零的自相互作用误差，即对于任意单电子密度，$E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\neq 0$。\n\n为了使等式 $(1-\\alpha) \\left( E_{\\mathrm{H}}[\\rho] + E_{x}^{\\mathrm{DFA}}[\\rho] \\right) = 0$ 对于任何第二个因子通常非零的 $\\rho(\\mathbf{r})$ 都普遍成立，第一个因子必须恒等于零。\n因此，我们必须施加条件：\n$$\n1 - \\alpha = 0\n$$\n解这个简单的方程得到 $\\alpha$ 的唯一解：\n$$\n\\alpha = 1\n$$\n这个结果意味着，对于一个全局混合泛函，要使其对所有单电子体系严格没有自相互作用误差，它必须包含100%的哈特里-福克交换，并完全排除DFA交换分量。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "前述的自相互作用误差对多电子体系会产生深远影响，其中一个显著的后果就是“离域误差”。本练习使用一个氯原子模型来展示标准 DFT 泛函如何人为地偏好离域的非整数电荷，而混合泛函可以显著减轻这种失效。你将量化这种效应，并亲眼见证包含精确交换如何能够更物理地正确描述电子的定域化行为 。",
            "id": "1373539",
            "problem": "在密度泛函理论 (DFT) 中，一个系统的总能量作为电子数 $E(N)$ 的函数，理想情况下应该是一个分段线性函数，在整数电子数处出现拐点。然而，许多近似的交换相关泛函，例如基于广义梯度近似 (GGA) 的那些，表现出一种伪凸性。这种“离域误差”人为地偏好分离片段上的分数电子数。包含一部分精确交换的混合泛函通常会减小这种误差。\n\n考虑一个孤立的氯原子 (Cl)。对于范围 $N \\in [17, 18]$ 内的分数电子数，设电子数表示为 $N = 17 + \\delta$，其中 $\\delta \\in [0, 1]$。我们将由 GGA 泛函和混合泛函计算的总能量建模如下：\n$$E_{\\text{GGA}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{GGA}}\\delta(1-\\delta)$$\n$$E_{\\text{hyb}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{hyb}}\\delta(1-\\delta)$$\n其中 $E(17)$ 和 $E(18)$ 分别是中性 Cl 原子和 Cl$^{-}$ 阴离子的精确总能量。正常数 $C_{\\text{GGA}}$ 和 $C_{\\text{hyb}}$ 分别量化了每种泛函的凸性，即离域误差的严重程度。\n\n这些参数的值如下：\n- 中性氯原子的能量, $E(17) = -459.642 \\text{ Hartree}$\n- 氯阴离子的能量, $E(18) = -459.775 \\text{ Hartree}$\n- GGA 凸性参数, $C_{\\text{GGA}} = 0.210 \\text{ Hartree}$\n- 混合泛函凸性参数, $C_{\\text{hyb}} = 0.055 \\text{ Hartree}$\n\n现在，考虑一个由两个相同且不相互作用的氯原子组成的系统。如果向这个双原子系统添加一个电子，正确的基态对应于电子定域在其中一个原子上，形成一个 [Cl, Cl$^-$] 对。然而，由于离域误差，近似泛函可能会错误地预测电子离域在两个原子上的状态具有更低的能量，从而得到一个 [Cl$^{-0.5}$, Cl$^{-0.5}$] 系统。\n\n计算 GGA 泛函的伪离域稳定化能与混合泛函的伪离域稳定化能之比。伪离域稳定化能定义为离域态 [Cl$^{-0.5}$, Cl$^{-0.5}$] 的能量减去正确局域态 [Cl, Cl$^-$] 的能量。将最终答案四舍五入至三位有效数字。",
            "solution": "对于单个具有 $N=17+\\delta$ 个电子的原子，由凸性参数 $C$ 表征的给定泛函计算的近似能量为\n$$\nE_{\\text{fun}}(17+\\delta)=(1-\\delta)E(17)+\\delta E(18)-C\\,\\delta(1-\\delta).\n$$\n对于带有额外一个电子的两个不相互作用的氯原子，局域态 [Cl, Cl$^-$] 中一个原子处于 $\\delta=0$ 而另一个原子处于 $\\delta=1$，因此其总能量为\n$$\nE_{\\text{loc}}=E_{\\text{fun}}(17)+E_{\\text{fun}}(18)=E(17)+E(18).\n$$\n离域态 [Cl$^{-0.5}$, Cl$^{-0.5}$] 中每个原子都处于 $\\delta=\\frac{1}{2}$，给出每个原子的能量为\n$$\nE_{\\text{fun}}(17+\\tfrac{1}{2})=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-C\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-\\tfrac{C}{4}.\n$$\n因此，离域态的总能量为\n$$\nE_{\\text{deloc}}=2E_{\\text{fun}}(17+\\tfrac{1}{2})=E(17)+E(18)-\\tfrac{C}{2}.\n$$\n因此，伪离域稳定化能（离域态能量减去局域态能量）为\n$$\n\\Delta E_{\\text{fun}}=E_{\\text{deloc}}-E_{\\text{loc}}=-\\tfrac{C}{2}.\n$$\n因此，GGA 与混合泛函的稳定化能之比为\n$$\nR=\\frac{\\Delta E_{\\text{GGA}}}{\\Delta E_{\\text{hyb}}}=\\frac{-\\tfrac{C_{\\text{GGA}}}{2}}{-\\tfrac{C_{\\text{hyb}}}{2}}=\\frac{C_{\\text{GGA}}}{C_{\\text{hyb}}}.\n$$\n代入给定值，\n$$\nR=\\frac{0.210}{0.055}=\\frac{210}{55}=\\frac{42}{11}\\approx 3.81818\\ldots\n$$\n四舍五入至三位有效数字，结果为 $3.82$。",
            "answer": "$$\\boxed{3.82}$$"
        },
        {
            "introduction": "如果加入一些精确交换是好的，那么是不是越多越好呢？现实情况是，“最佳”的精确交换量可能取决于具体问题。这项实践练习模拟了计算化学中的一个常见任务：通过对照已知的实验值进行校准，来“调节”一个定制的混合泛函，以准确预测一个特定的敏感性质——卡宾分子的单线态-三线态能隙 。",
            "id": "1373559",
            "problem": "在现代密度泛函理论 (DFT) 中，混合泛函因其相比纯DFT泛函更高的精度而被广泛使用。一个全局混合泛函的交换相关能 $E_{\\text{xc}}$ 是通过将一部分（比例为 $\\alpha$）精确Hartree-Fock (HF) 交换能 $E_{\\text{x}}^{\\text{HF}}$ 与DFT交换泛函 $E_{\\text{x}}^{\\text{DFT}}$ 混合，并加上DFT相关泛函 $E_{\\text{c}}^{\\text{DFT}}$ 来构建的。\n\n一位计算化学家正在开发一种新的自定义混合泛函，其交换相关能由下式给出：\n$$ E_{\\text{xc}}^{\\text{custom}} = \\alpha E_{\\text{x}}^{\\text{HF}} + (1-\\alpha) E_{\\text{x}}^{\\text{PBE}} + E_{\\text{c}}^{\\text{PBE}} $$\n此处，$E_{\\text{x}}^{\\text{PBE}}$ 和 $E_{\\text{c}}^{\\text{PBE}}$ 是流行的PBE泛函的交换和相关部分。该化学家希望找到HF交换的最佳比例 $\\alpha$，以便精确预测亚甲基卡宾分子 (CH$_2$) 的单重态-三重态能隙 ($\\Delta E_{\\text{S-T}} = E_{\\text{singlet}} - E_{\\text{triplet}}$)。\n\n已知CH$_2$ 的 $\\Delta E_{\\text{S-T}}$ 的一个高精度实验基准值为 $37.8 \\text{ kJ/mol}$。为了确定最佳的 $\\alpha$ 值，该化学家使用自定义泛函和不同的 $\\alpha$ 值对 $\\Delta E_{\\text{S-T}}$ 进行了一系列计算。结果如下：\n\n- 当 $\\alpha = 0.10$ 时，计算出的 $\\Delta E_{\\text{S-T}}$ 为 $26.0 \\text{ kJ/mol}$。\n- 当 $\\alpha = 0.20$ 时，计算出的 $\\Delta E_{\\text{S-T}}$ 为 $32.0 \\text{ kJ/mol}$。\n- 当 $\\alpha = 0.30$ 时，计算出的 $\\Delta E_{\\text{S-T}}$ 为 $38.0 \\text{ kJ/mol}$。\n- 当 $\\alpha = 0.40$ 时，计算出的 $\\Delta E_{\\text{S-T}}$ 为 $44.0 \\text{ kJ/mol}$。\n\n假设在计算出的数据点之间 $\\Delta E_{\\text{S-T}}$ 与 $\\alpha$ 呈线性关系，请确定能够再现实验基准值的最佳 $\\alpha$ 值。将您的答案表示为一个无量纲小数值，并保留三位有效数字。",
            "solution": "假设单重态-三重态能隙与Hartree-Fock交换比例之间存在线性关系：$\\Delta E_{\\text{S-T}}(\\alpha) = m\\alpha + b$。使用两个数据点 $(\\alpha_{1}, \\Delta E_{1}) = (0.10, 26.0)$ 和 $(\\alpha_{2}, \\Delta E_{2}) = (0.20, 32.0)$，计算斜率：\n$$\nm = \\frac{\\Delta E_{2} - \\Delta E_{1}}{\\alpha_{2} - \\alpha_{1}} = \\frac{32.0 - 26.0}{0.20 - 0.10} = 60.0.\n$$\n使用点 $(0.10, 26.0)$ 确定截距：\n$$\n26.0 = 60.0 \\times 0.10 + b \\quad \\Rightarrow \\quad b = 26.0 - 6.0 = 20.0.\n$$\n因此，\n$$\n\\Delta E_{\\text{S-T}}(\\alpha) = 60.0\\,\\alpha + 20.0.\n$$\n将此等式设置为实验基准值 $\\Delta E_{\\text{S-T}}^{\\text{exp}} = 37.8$ 并求解 $\\alpha$：\n$$\n37.8 = 60.0\\,\\alpha + 20.0 \\quad \\Rightarrow \\quad \\alpha = \\frac{37.8 - 20.0}{60.0} = \\frac{17.8}{60.0} \\approx 0.296\\overline{6}.\n$$\n保留三位有效数字，\n$$\n\\alpha \\approx 0.297.\n$$",
            "answer": "$$\\boxed{0.297}$$"
        }
    ]
}