{
    "hands_on_practices": [
        {
            "introduction": "The Molecular Electrostatic Potential (MEP) is a powerful tool for understanding how a molecule's electronic structure influences its interactions. This first practice explores this connection by comparing two related molecules: furan and tetrahydrofuran. By analyzing how electron delocalization in the aromatic furan ring affects the MEP around its oxygen atom compared to the saturated tetrahydrofuran, you will gain a practical understanding of how MEP maps can be used to predict and rationalize relative strengths in noncovalent interactions like hydrogen bonding .",
            "id": "2458327",
            "problem": "In computational chemistry, the Molecular Electrostatic Potential (MEP) maps the scalar potential due to nuclei and electrons in a molecule and is commonly used to rationalize noncovalent interactions such as hydrogen bonding. Consider the oxygen atoms in furan and tetrahydrofuran. Furan contains an oxygen atom that is part of an aromatic ring, whereas tetrahydrofuran is a saturated cyclic ether. Based solely on fundamental considerations of electron delocalization and localization around the oxygen atom and their consequences for the MEP near the oxygen lone pairs, which statement best describes how the MEP around the oxygen differs in these two molecules and what this implies about their relative abilities as hydrogen-bond (H-bond) acceptors?\n\nA. The MEP minimum near the oxygen in furan is less negative than in tetrahydrofuran due to delocalization of one oxygen lone pair into the ring, implying that furan is the weaker H-bond acceptor.\n\nB. The MEP minimum near the oxygen in furan is more negative than in tetrahydrofuran because aromaticity concentrates electron density on the oxygen, implying that furan is the stronger H-bond acceptor.\n\nC. The MEP near the oxygen is essentially identical in the two molecules because the same element is involved, implying comparable H-bond acceptor abilities.\n\nD. The MEP near the oxygen in tetrahydrofuran is more positive because its lone pairs occupy $\\sigma$-type hybrids, implying that tetrahydrofuran is the weaker H-bond acceptor.",
            "solution": "The validity of the problem statement shall be examined first.\n\n**Step 1: Extract Givens**\n- **Topic**: Molecular Electrostatic Potential (MEP).\n- **Molecules**: Furan and tetrahydrofuran (THF).\n- **Structural Information**: Furan has an oxygen atom in an aromatic ring. Tetrahydrofuran is a saturated cyclic ether.\n- **Core Concept**: The analysis must be based on electron delocalization and localization around the oxygen atom.\n- **Objective**: Compare the MEP near the oxygen atom in both molecules and relate this to their relative abilities as hydrogen-bond (H-bond) acceptors.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. The concepts of MEP, furan, tetrahydrofuran, aromaticity, electron delocalization, lone pairs, and hydrogen bonding are all fundamental and well-established principles in chemistry. The question asks to connect these concepts, which represents a standard application of chemical theory. The problem is well-posed, as it provides sufficient information (the structures of the two molecules and the theoretical framework to use) to arrive at a single, logical conclusion. The language is objective and precise. The problem is self-contained and does not contain internal contradictions. It is a verifiable chemical problem that can be addressed through established theoretical reasoning and confirmed with computational or experimental data.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be derived.\n\n**Derivation**\n\nThe electrostatic potential $V(\\mathbf{r})$ at a point $\\mathbf{r}$ in space around a molecule is determined by the total charge distribution of the nuclei and electrons. It is given by the expression:\n$$\nV(\\mathbf{r}) = \\sum_{A} \\frac{Z_A}{|\\mathbf{R}_A - \\mathbf{r}|} - \\int \\frac{\\rho(\\mathbf{r'})}{|\\mathbf{r'} - \\mathbf{r}|} d\\mathbf{r'}\n$$\nwhere the first term represents the contribution from the nuclei with charges $Z_A$ at positions $\\mathbf{R}_A$, and the second term represents the contribution from the electron density $\\rho(\\mathbf{r'})$. Regions of high electron density, such as those associated with lone pairs, result in a negative electrostatic potential. The most negative value of the MEP, known as the MEP minimum ($V_{min}$), is a quantitative measure of a site's propensity to act as an electron donor in noncovalent interactions, such as hydrogen bonding. A more negative $V_{min}$ indicates a stronger hydrogen-bond acceptor.\n\nWe must analyze the electronic structure of the oxygen atom in furan and tetrahydrofuran.\n\n1.  **Tetrahydrofuran (THF)**: THF is a saturated cyclic ether. The oxygen atom is $sp^3$-hybridized. It has two covalent bonds to adjacent carbon atoms and two lone pairs of electrons. These two lone pairs occupy two distinct $sp^3$ hybrid orbitals. As there is no $\\pi$-system in the saturated ring, these lone pairs are **localized** on the oxygen atom. This localization creates a region of high electron density around the oxygen, leading to a significantly negative MEP minimum.\n\n2.  **Furan**: Furan is an aromatic heterocycle. Its five-membered ring conforms to Hückel's rule for aromaticity ($4n+2$ $\\pi$-electrons, with $n=1$, for a total of $6$ $\\pi$-electrons). To achieve this, the oxygen atom must contribute one of its lone pairs to the cyclic $\\pi$-system. The oxygen atom is therefore approximately $sp^2$-hybridized. One lone pair resides in an $sp^2$ hybrid orbital, which lies in the plane of the ring and is directed away from the ring center. This lone pair is localized. The second lone pair resides in a $p$ orbital, which is perpendicular to the ring plane and aligns with the $p$ orbitals of the four carbon atoms. This lone pair is **delocalized** throughout the aromatic $\\pi$-system.\n\nThe delocalization of one lone pair in furan means that the oxygen atom donates electron density to the aromatic ring. This effect is known as a positive resonance effect ($+R$). Consequently, the overall electron density localized on the oxygen atom in furan is reduced compared to an oxygen atom where both lone pairs are localized, as in THF.\n\n**Comparison and Implication**\n- The electron density around the oxygen atom in THF is higher than that in furan because both of its lone pairs are localized.\n- The electron density around the oxygen atom in furan is lower due to the delocalization of one lone pair into the aromatic ring.\n- Therefore, the MEP minimum ($V_{min}$) near the oxygen atom in THF will be more negative than the MEP minimum near the oxygen atom in furan.\n- A stronger H-bond acceptor is associated with a more negative MEP minimum.\n- This implies that THF is a stronger H-bond acceptor, and furan is a weaker H-bond acceptor.\n\n**Option-by-Option Analysis**\n\n**A. The MEP minimum near the oxygen in furan is less negative than in tetrahydrofuran due to delocalization of one oxygen lone pair into the ring, implying that furan is the weaker H-bond acceptor.**\nThis statement accurately describes the situation. The MEP in furan is indeed less negative (a smaller magnitude of negative potential) than in THF. The reason provided—delocalization of an oxygen lone pair into the aromatic ring—is correct. The consequence—that furan is the weaker H-bond acceptor—is also correct and follows directly from the MEP analysis.\n**Verdict: Correct.**\n\n**B. The MEP minimum near the oxygen in furan is more negative than in tetrahydrofuran because aromaticity concentrates electron density on the oxygen, implying that furan is the stronger H-bond acceptor.**\nThis statement is incorrect on multiple grounds. First, the MEP minimum in furan is less negative, not more negative. Second, the reason given is false; aromaticity in furan involves the oxygen *donating* electron density to the ring, thereby *decreasing* the electron density on the oxygen, not concentrating it. The conclusion that furan is the stronger H-bond acceptor is also false.\n**Verdict: Incorrect.**\n\n**C. The MEP near the oxygen is essentially identical in the two molecules because the same element is involved, implying comparable H-bond acceptor abilities.**\nThis statement is grossly oversimplified and incorrect. The chemical environment, including hybridization and participation in resonance, has a profound effect on the electronic properties of an atom. The oxygen atoms in furan ($sp^2$, aromatic) and THF ($sp^3$, saturated) are in vastly different electronic environments, leading to significantly different MEPs and H-bond acceptor strengths.\n**Verdict: Incorrect.**\n\n**D. The MEP near the oxygen in tetrahydrofuran is more positive because its lone pairs occupy $\\sigma$-type hybrids, implying that tetrahydrofuran is the weaker H-bond acceptor.**\nThis statement is incorrect. The MEP near the oxygen in THF is more negative (less positive) due to the high concentration of localized electron density in its lone pairs. The reason given—that lone pairs occupy $\\sigma$-type hybrids—is true but does not lead to a more positive potential; localized electrons create a negative potential. The conclusion that THF is the weaker acceptor is also incorrect.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving beyond simple comparisons, the MEP can also rationalize complex reaction selectivity. This exercise focuses on the classic organic chemistry problem of ambident nucleophiles, specifically the enolate anion, which can react at either its oxygen or carbon atom. You will use MEP concepts to understand why hard, charge-driven electrophiles prefer one site while soft, polarizable electrophiles prefer another, providing an electrostatic basis for the Hard and Soft Acids and Bases (HSAB) principle .",
            "id": "2458381",
            "problem": "An ambident enolate anion derived from a simple ketone has two plausible nucleophilic sites: the oxygen and the $\\alpha$-carbon. Consider two electrophiles: a strongly oxophilic, highly polarized silicon electrophile such as trimethylsilyl chloride and a soft, polarizable carbon electrophile such as methyl iodide. The molecular electrostatic potential (MEP) $V(\\mathbf{r})$ of a molecule at point $\\mathbf{r}$ is defined as the potential experienced by a unit positive test charge due to the molecule’s nuclei and electrons,\n$$\nV(\\mathbf{r}) \\;=\\; \\sum_{A} \\frac{Z_A}{|\\mathbf{r}-\\mathbf{R}_A|} \\;-\\; \\int \\frac{\\rho(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, \\mathrm{d}\\mathbf{r'} \\,,\n$$\nwhere $Z_A$ and $\\mathbf{R}_A$ are the charge and position of nucleus $A$, and $\\rho(\\mathbf{r'})$ is the electron density. Regions of more negative $V(\\mathbf{r})$ are more stabilizing for a positive charge. Which statement best uses the MEP to rationalize why the enolate reacts at oxygen with the silicon electrophile but at carbon with the carbon electrophile?\n\nA. The enolate’s MEP exhibits a deeper, more localized negative region adjacent to oxygen and a shallower, more diffuse negative region above the $\\alpha$-carbon; a hard, localized positive site is most stabilized by approaching the deepest negative $V(\\mathbf{r})$ pocket and thus reacts at oxygen, whereas a soft, diffuse positive site has a broader positive MEP and interacts more favorably with the more diffuse negative region near the $\\alpha$-carbon, leading to carbon attack.\n\nB. Nucleophilic sites correspond to local maxima of the MEP on an isodensity surface; since the $\\alpha$-carbon is typically a maximum and oxygen is a minimum, electrophiles preferentially approach the carbon.\n\nC. Resonance delocalization renders the MEP less negative near oxygen than near carbon; therefore electrostatic attraction of electrophiles is stronger at carbon, explaining carbon attack universally.\n\nD. The MEP depends only on nuclear charges and not on electron density; therefore it cannot distinguish between oxygen and carbon in an enolate, and site selectivity must be unrelated to electrostatics.",
            "solution": "The problem statement will first be subjected to a rigorous validation.\n\n### Step 1: Extract Givens\n- **System**: An ambident enolate anion derived from a simple ketone.\n- **Nucleophilic Sites**: The oxygen atom and the $\\alpha$-carbon atom.\n- **Electrophiles**:\n    1. A strongly oxophilic, highly polarized silicon electrophile (e.g., trimethylsilyl chloride).\n    2. A soft, polarizable carbon electrophile (e.g., methyl iodide).\n- **Observed Reactivity**: The enolate reacts at oxygen with the silicon electrophile and at carbon with the carbon electrophile.\n- **Definition of Molecular Electrostatic Potential (MEP)**:\n$$\nV(\\mathbf{r}) \\;=\\; \\sum_{A} \\frac{Z_A}{|\\mathbf{r}-\\mathbf{R}_A|} \\;-\\; \\int \\frac{\\rho(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, \\mathrm{d}\\mathbf{r'}\n$$\nwhere $Z_A$ and $\\mathbf{R}_A$ are the charge and position of nucleus $A$, and $\\rho(\\mathbf{r'})$ is the electron density.\n- **Interpretation of MEP**: Regions of more negative $V(\\mathbf{r})$ are more stabilizing for a positive charge.\n- **Question**: To identify the statement that best uses the MEP to rationalize the observed site selectivity of the enolate anion's reactions.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is well-grounded in fundamental principles of physical organic chemistry and computational chemistry. The concept of an ambident enolate anion, its differential reactivity with hard and soft electrophiles (a classic illustration of the Hard and Soft Acids and Bases (HSAB) principle), and the definition of the Molecular Electrostatic Potential (MEP) are all standard and factual.\n2.  **Well-Posedness**: The problem asks for a rationalization of an established chemical phenomenon using a defined theoretical tool (MEP). A unique conceptual explanation is expected. The question is structured to lead to a single best explanation among the choices.\n3.  **Objectivity**: The language is precise and unbiased. The terms \"strongly oxophilic,\" \"highly polarized,\" \"soft,\" and \"polarizable\" are standard qualitative descriptors in chemistry. The definition of MEP is the exact mathematical formalism.\n4.  **Consistency and Completeness**: The problem statement is self-contained. It provides the chemical context, the experimental observation (site selectivity), the theoretical tool (MEP definition), and its physical interpretation. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, and requires the application of a well-defined physical concept to explain a chemical observation. I will now proceed to derive the solution and evaluate the options.\n\n### Solution Derivation\n\nThe reactivity of an ambident nucleophile such as an enolate anion with an electrophile is governed by a combination of factors, primarily electrostatic interactions and orbital overlap (covalent interactions). The molecular electrostatic potential, $V(\\mathbf{r})$, provides a map of the electrostatic landscape of the molecule and is a primary indicator of where a positive point charge (a simple model for an electrophile) would experience the strongest attraction.\n\nFor an enolate anion, the negative charge is delocalized across the oxygen and the $\\alpha$-carbon, as described by the resonance structures $\\text{R}_2\\text{C=CR-O}^- \\leftrightarrow \\text{R}_2\\text{C}^-\\text{-CR=O}$. Although one resonance structure places the formal negative charge on the carbon, the greater electronegativity of oxygen and the presence of its lone-pair electrons cause the MEP to be most negative in the vicinity of the oxygen atom. This region of negative potential near the oxygen is typically a deep and spatially localized minimum. In contrast, the region of negative potential associated with the $\\pi$-system over the $\\alpha$-carbon is typically shallower (less negative) and more diffuse (spread out over a larger volume).\n\nThe interaction can be understood through the lens of the HSAB principle, which can be correlated with MEP characteristics:\n\n1.  **Reaction with a Hard Electrophile**: The silicon atom in trimethylsilyl chloride, Si(CH$_3$)$_3$Cl, is a classic \"hard\" electrophile. It is relatively small, bears a significant partial positive charge, and is not easily polarized. The interaction of such an electrophile with a nucleophile is dominated by electrostatic forces (it is \"charge-controlled\"). A hard electrophile, behaving like a localized positive charge, will be maximally stabilized by interaction with the site of the most negative electrostatic potential. For the enolate, this is the deep, localized MEP minimum at the oxygen atom. Consequently, the reaction is directed to the oxygen, yielding a silyl enol ether. This is known as O-silylation.\n\n2.  **Reaction with a Soft Electrophile**: The methyl carbon in methyl iodide, CH$_3$I, is a classic \"soft\" electrophile. The carbon atom is less electropositive than silicon, and the C-I bond is highly polarizable. The interaction of a soft electrophile is dominated by orbital overlap (it is \"orbital-controlled\"), specifically the interaction between the Highest Occupied Molecular Orbital (HOMO) of the nucleophile and the Lowest Unoccupied Molecular Orbital (LUMO) of the electrophile. For an enolate, the HOMO has a larger orbital coefficient (greater amplitude) on the $\\alpha$-carbon than on the oxygen. This makes the carbon atom the preferred site of attack for soft electrophiles that form strong covalent bonds through effective orbital overlap. This leads to C-alkylation.\n\nWhile the primary justification for soft-soft interactions is FMO theory, it can be rationalized in MEP terms by considering the nature of the electrophile's own potential. A \"soft\" electrophile has a diffuse, polarizable positive character, which can be thought of as a broad, shallow positive MEP region. Such a diffuse positive region can achieve a more favorable net interaction with the broad, diffuse negative MEP region of the enolate's $\\alpha$-carbon, as opposed to the highly localized, deep potential well at the oxygen.\n\n### Option-by-Option Analysis\n\n**A. The enolate’s MEP exhibits a deeper, more localized negative region adjacent to oxygen and a shallower, more diffuse negative region above the $\\alpha$-carbon; a hard, localized positive site is most stabilized by approaching the deepest negative $V(\\mathbf{r})$ pocket and thus reacts at oxygen, whereas a soft, diffuse positive site has a broader positive MEP and interacts more favorably with the more diffuse negative region near the $\\alpha$-carbon, leading to carbon attack.**\nThis statement correctly describes the typical topography of an enolate's MEP: a deep, localized minimum at oxygen and a shallower, diffuse negative region at the $\\alpha$-carbon. It then correctly correlates the nature of a hard electrophile (localized positive charge) with its preference for the deepest electrostatic potential minimum (oxygen), leading to O-attack. Finally, it provides a reasonable MEP-based analogy for the soft-soft interaction, describing the interaction of a diffuse electrophile with the diffuse negative region at the carbon, leading to C-attack. This explanation is comprehensive and consistent with established theory.\n**Verdict: Correct.**\n\n**B. Nucleophilic sites correspond to local maxima of the MEP on an isodensity surface; since the $\\alpha$-carbon is typically a maximum and oxygen is a minimum, electrophiles preferentially approach the carbon.**\nThis statement is fundamentally flawed. Nucleophilic sites are electron-rich and attract positive charges. They therefore correspond to regions of negative electrostatic potential, i.e., local **minima** of $V(\\mathbf{r})$, not maxima. Electrophilic sites, being electron-deficient, correspond to local maxima (positive potential). The premise is incorrect.\n**Verdict: Incorrect.**\n\n**C. Resonance delocalization renders the MEP less negative near oxygen than near carbon; therefore electrostatic attraction of electrophiles is stronger at carbon, explaining carbon attack universally.**\nThis statement makes an incorrect claim about the MEP of an enolate. Due to the high electronegativity of oxygen, the MEP minimum is almost invariably deeper (more negative) near the oxygen atom than near the carbon atom. The conclusion of stronger electrostatic attraction at carbon is therefore based on a false premise. Furthermore, it incorrectly predicts \"carbon attack universally,\" which contradicts the provided information that the silicon electrophile attacks at oxygen.\n**Verdict: Incorrect.**\n\n**D. The MEP depends only on nuclear charges and not on electron density; therefore it cannot distinguish between oxygen and carbon in an enolate, and site selectivity must be unrelated to electrostatics.**\nThis statement is a direct contradiction of the definition of MEP provided in the problem itself. The MEP, $V(\\mathbf{r})$, is explicitly defined with a term for the electron density, $\\rho(\\mathbf{r'})$. The electron density distribution is crucial for determining the shape and values of the MEP. It is precisely because the MEP incorporates the effects of the electronic structure that it is a useful tool for distinguishing reactive sites. The entire premise is false.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "To truly master a concept, it is often best to build it from the ground up. This final hands-on practice challenges you to do just that by writing a program to compute the MEP from a defined physical model for water and hydrogen sulfide. By implementing the mathematical definition of MEP, you will translate theory into practice, quantitatively mapping the potential landscape and locating the lone-pair regions, thereby solidifying your understanding of how fundamental properties like geometry and electronegativity shape a molecule's electrostatic character .",
            "id": "2458388",
            "problem": "Write a complete, runnable program that computes and reports the angular location and depth of the most negative Molecular Electrostatic Potential (MEP) minimum on a spherical surface centered at the central atom for bent triatomic molecules with two lone pairs, specifically water and hydrogen sulfide, under a specified, self-contained, point-charge model. Molecular Electrostatic Potential (MEP) is defined by Coulomb’s law as the scalar potential due to a set of fixed point charges. Use the following first-principles, physically grounded model and conventions.\n\n1. Geometry, coordinates, and units.\n   - Use a right-handed Cartesian coordinate system with the central atom at the origin. The molecular plane is the $x\\!-\\!z$ plane, and the angle bisector of the two bonds points along $+\\!z$.\n   - For each molecule, the two hydrogen atoms are located symmetrically in the $x\\!-\\!z$ plane at a bond length $b$ from the central atom with bond angle $\\alpha$ at the central atom. Let $\\beta=\\alpha/2$. The hydrogen positions are\n     $$\n     \\mathbf{R}_{\\mathrm{H}_1}=\\big(b\\sin\\beta,\\,0,\\,b\\cos\\beta\\big),\\quad\n     \\mathbf{R}_{\\mathrm{H}_2}=\\big(-b\\sin\\beta,\\,0,\\,b\\cos\\beta\\big).\n     $$\n   - Model each lone pair by an off-nuclear negative point charge located a distance $d_{\\mathrm{L}}$ from the central atom at polar angle $\\beta_{\\mathrm{L}}$ and azimuthal angles $\\phi=\\pm 90^\\circ$ (i.e., along $\\pm y$), where $\\beta_{\\mathrm{L}}$ is chosen to enforce a tetrahedral angle between each hydrogen direction and each lone pair direction. This requires\n     $$\n     \\cos\\beta_{\\mathrm{L}}=-\\frac{1}{3\\cos\\beta}.\n     $$\n     The lone-pair positions are\n     $$\n     \\mathbf{R}_{\\mathrm{L}_1}=\\big(0,\\,d_{\\mathrm{L}}\\sin\\beta_{\\mathrm{L}},\\,d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}}\\big),\\quad\n     \\mathbf{R}_{\\mathrm{L}_2}=\\big(0,\\,-d_{\\mathrm{L}}\\sin\\beta_{\\mathrm{L}},\\,d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}}\\big).\n     $$\n   - Use the following molecular parameters (gas-phase geometry and dipole moments), with distances in ångström $(\\mathrm{\\AA})$ and angles in degrees $(\\mathrm{deg})$:\n     - Water $\\left(\\mathrm{H_2O}\\right)$: $b=0.9572\\,\\mathrm{\\AA}$, $\\alpha=104.52\\,\\mathrm{deg}$, $\\mu=1.855\\,\\mathrm{D}$.\n     - Hydrogen sulfide $\\left(\\mathrm{H_2S}\\right)$: $b=1.336\\,\\mathrm{\\AA}$, $\\alpha=92.1\\,\\mathrm{deg}$, $\\mu=0.97\\,\\mathrm{D}$.\n   - Place lone-pair sites at a distance $d_{\\mathrm{L}}$ chosen by scaling the hydrogen bond length with the same ratio as in the TIP5P water model, i.e.,\n     $$\n     \\frac{d_{\\mathrm{L}}}{b}=\\frac{0.70}{0.9572}.\n     $$\n\n2. Charges and dipole-moment constraint.\n   - Let the two hydrogen sites carry equal positive charges $+q$, and the two lone-pair sites carry equal negative charges $-q$. The central atom is neutral. This enforces total charge neutrality.\n   - Determine the magnitude $q$ by matching the experimental gas-phase dipole moment $\\mu$ along the $+\\!z$ axis:\n     $$\n     \\mu_z=\\sum_i q_i z_i=2q\\left(b\\cos\\beta-d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}}\\right),\n     $$\n     hence\n     $$\n     q=\\frac{\\mu}{2\\left(b\\cos\\beta-d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}}\\right)}.\n     $$\n   - Use the Debye (D) to Coulomb-meter conversion $1\\,\\mathrm{D}=3.33564\\times 10^{-30}\\,\\mathrm{C\\cdot m}$, the ångström to meter conversion $1\\,\\mathrm{\\AA}=1.0\\times 10^{-10}\\,\\mathrm{m}$, and the vacuum permittivity $\\varepsilon_0=8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}$. Use the Coulomb constant $k=\\left(4\\pi\\varepsilon_0\\right)^{-1}$.\n\n3. Molecular Electrostatic Potential (MEP) on a sphere.\n   - For a field point at position $\\mathbf{r}$, the potential is\n     $$\n     V(\\mathbf{r})=\\sum_i \\frac{k\\,q_i}{\\left\\lvert \\mathbf{r}-\\mathbf{R}_i\\right\\rvert}.\n     $$\n   - Evaluate $V$ on a spherical surface of radius $R$ centered at the central atom:\n     $$\n     \\mathbf{r}(R,\\theta,\\phi)=\\big(R\\sin\\theta\\cos\\phi,\\,R\\sin\\theta\\sin\\phi,\\,R\\cos\\theta\\big),\n     $$\n     with polar angle $\\theta\\in[0,\\pi]$ and azimuthal angle $\\phi\\in[0,2\\pi)$.\n\n4. Task and output.\n   - For each specified test case, find the global minimum of $V$ over the discrete set of sample angles and report its angular location and depth. Use the conventions:\n     - Report angles in degrees, with $\\theta\\in[0,180]$ and $\\phi\\in(-180,180]$.\n     - Report potential in volts $(\\mathrm{V})$.\n     - If multiple equal minima occur due to symmetry and discretization, choose the one with the smallest polar-angle sample index, and then the smallest azimuthal-angle sample index.\n     - Round the reported $\\theta$ and $\\phi$ to $2$ decimal places, and $V$ to $3$ decimal places.\n   - Discretization of the spherical surface must use uniform angular grids with the provided integer sample counts $N_\\theta$ and $N_\\phi$:\n     $$\n     \\theta_j=\\frac{j}{N_\\theta-1}\\pi\\quad(j=0,\\dots,N_\\theta-1),\\qquad\n     \\phi_k=\\frac{k}{N_\\phi}2\\pi\\quad(k=0,\\dots,N_\\phi-1).\n     $$\n   - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist $[\\theta_{\\min},\\phi_{\\min},V_{\\min}]$. For example: $[[\\theta_1,\\phi_1,V_1],[\\theta_2,\\phi_2,V_2],\\dots]$.\n\n5. Test suite.\n   - Use the following four test cases to exercise geometry, magnitude, and resolution effects:\n     - Test $1$: $\\mathrm{H_2O}$, $R=2.0\\,\\mathrm{\\AA}$, $N_\\theta=181$, $N_\\phi=361$.\n     - Test $2$: $\\mathrm{H_2S}$, $R=2.0\\,\\mathrm{\\AA}$, $N_\\theta=181$, $N_\\phi=361$.\n     - Test $3$: $\\mathrm{H_2O}$, $R=3.0\\,\\mathrm{\\AA}$, $N_\\theta=121$, $N_\\phi=241$.\n     - Test $4$: $\\mathrm{H_2S}$, $R=3.0\\,\\mathrm{\\AA}$, $N_\\theta=121$, $N_\\phi=241$.\n\nYour program must output a single line in the exact format:\n$[[\\theta_1,\\phi_1,V_1],[\\theta_2,\\phi_2,V_2],[\\theta_3,\\phi_3,V_3],[\\theta_4,\\phi_4,V_4]]$\nwith the numerical values substituted and rounded as specified above, $\\theta$ and $\\phi$ in degrees and $V$ in volts.",
            "solution": "The problem has been validated and is determined to be scientifically sound, consistent, and well-posed. It presents a solvable computational task based on a clearly defined physical model. A complete solution is therefore provided. The methodology is structured into three main parts: establishing the physical and geometric parameters of the molecular model, formulating the expression for the Molecular Electrostatic Potential ($V$), and devising a computational strategy to find the minimum of $V$ on a spherical surface.\n\nFirst, we formalize the model parameters. All calculations will be performed in SI units to ensure consistency. The provided constants are: the Debye to Coulomb-meter conversion factor $1\\,\\mathrm{D}=3.33564\\times 10^{-30}\\,\\mathrm{C\\cdot m}$, the Ångström to meter conversion $1\\,\\mathrm{\\AA}=1.0\\times 10^{-10}\\,\\mathrm{m}$, and the vacuum permittivity $\\varepsilon_0=8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}$. The Coulomb constant is $k=\\left(4\\pi\\varepsilon_0\\right)^{-1}$.\n\nFor each molecule ($\\mathrm{H_2O}$ or $\\mathrm{H_2S}$), specified by its bond length $b$, bond angle $\\alpha$, and dipole moment $\\mu$, we determine the coordinates of the four point charges and their magnitude. The molecular geometry is fixed in a Cartesian system with the central atom at the origin. The hydrogens lie in the $x-z$ plane, and the molecular angle bisector is aligned with the $+z$ axis. The half-bond-angle is $\\beta = \\alpha/2$. The coordinates for the two hydrogen atoms ($\\mathrm{H}_1, \\mathrm{H}_2$) are given by:\n$$\n\\mathbf{R}_{\\mathrm{H}_1}=\\big(b\\sin\\beta,\\,0,\\,b\\cos\\beta\\big),\\quad\n\\mathbf{R}_{\\mathrm{H}_2}=\\big(-b\\sin\\beta,\\,0,\\,b\\cos\\beta\\big)\n$$\nThe two lone pairs ($\\mathrm{L}_1, \\mathrm{L}_2$) are modeled as point charges in the $y-z$ plane. The distance of these charges from the origin, $d_{\\mathrm{L}}$, is scaled from the bond length $b$ using the ratio from the TIP5P water model:\n$$\nd_{\\mathrm{L}} = b \\cdot \\frac{0.70\\,\\mathrm{\\AA}}{0.9572\\,\\mathrm{\\AA}}\n$$\nThe polar angle of the lone pairs, $\\beta_{\\mathrm{L}}$, is determined by the constraint that the angle between a hydrogen-atom vector and a lone-pair vector is the tetrahedral angle ($109.47^\\circ$, with $\\cos(109.47^\\circ) \\approx -1/3$). The dot product of the unit vectors gives $\\cos\\beta \\cos\\beta_{\\mathrm{L}} = -1/3$. This is solved for $\\cos\\beta_{\\mathrm{L}}$:\n$$\n\\cos\\beta_{\\mathrm{L}}=-\\frac{1}{3\\cos\\beta}\n$$\nSince for both molecules $\\alpha  141.06^\\circ$, we have $|\\cos\\beta_{\\mathrm{L}}|  1$, ensuring a real angle $\\beta_{\\mathrm{L}}$ exists. We can then find $\\sin\\beta_{\\mathrm{L}} = \\sqrt{1 - \\cos^2\\beta_{\\mathrm{L}}}$. The lone pair coordinates are:\n$$\n\\mathbf{R}_{\\mathrm{L}_1}=\\big(0,\\,d_{\\mathrm{L}}\\sin\\beta_{\\mathrm{L}},\\,d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}}\\big),\\quad\n\\mathbf{R}_{\\mathrm{L}_2}=\\big(0,\\,-d_{\\mathrm{L}}\\sin\\beta_{\\mathrm{L}},\\,d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}}\\big)\n$$\nThe charges are assigned as $+q$ for each hydrogen and $-q$ for each lone pair. The magnitude $q$ is calculated by matching the model's dipole moment to the experimental value $\\mu$. The dipole moment vector of this charge assembly points along the $z$-axis due to symmetry, and its magnitude is:\n$$\n\\mu_z=\\sum_i q_i z_i = q(z_{\\mathrm{H}_1}) + q(z_{\\mathrm{H}_2}) - q(z_{\\mathrm{L}_1}) - q(z_{\\mathrm{L}_2}) = 2q(b\\cos\\beta) - 2q(d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}})\n$$\nSetting $\\mu_z = \\mu$ and solving for $q$ yields:\n$$\nq=\\frac{\\mu}{2\\left(b\\cos\\beta-d_{\\mathrm{L}}\\cos\\beta_{\\mathrm{L}}\\right)}\n$$\nAll parameters ($b, d_{\\mathrm{L}}, \\mu$) must be converted to SI units (m and C$\\cdot$m) before calculating $q$, which will be in Coulombs.\n\nSecond, we define the algorithm for calculating the Molecular Electrostatic Potential ($V$) on a spherical surface of radius $R$. The potential at a point $\\mathbf{r}$ is the sum of potentials from each of the four point charges:\n$$\nV(\\mathbf{r}) = k \\sum_{i=1}^{4} \\frac{q_i}{\\left\\lvert \\mathbf{r}-\\mathbf{R}_i\\right\\rvert}\n$$\nwhere $\\mathbf{R}_i$ are the positions of the four charges and $q_i$ are their respective charge values ($+q$ or $-q$). We evaluate $V$ on a grid of points on the sphere, parameterized by spherical coordinates $(\\theta, \\phi)$:\n$$\n\\mathbf{r}(R,\\theta,\\phi)=\\big(R\\sin\\theta\\cos\\phi,\\,R\\sin\\theta\\sin\\phi,\\,R\\cos\\theta\\big)\n$$\nThe grid is discretized uniformly in $\\theta$ and $\\phi$ according to the specified sample counts, $N_\\theta$ and $N_\\phi$:\n$$\n\\theta_j=\\frac{j}{N_\\theta-1}\\pi\\quad(j=0,\\dots,N_\\theta-1)\n$$\n$$\n\\phi_k=\\frac{k}{N_\\phi}2\\pi\\quad(k=0,\\dots,N_\\phi-1)\n$$\nTo accelerate the computation, we employ vectorization using the `NumPy` library. We construct a meshgrid for the angles $(\\theta_j, \\phi_k)$ and compute the corresponding Cartesian coordinates for all points on the spherical surface simultaneously. The distances between every grid point and each of the four fixed charges are calculated using broadcasted array operations. This allows the potential $V$ to be computed for the entire grid in a single vectorized step, resulting in a $N_\\theta \\times N_\\phi$ matrix of potential values.\n\nThird, we find the minimum potential. The global minimum of $V$ on the discrete grid is found using `numpy.argmin`. This function returns the flattened index of the minimum value. A call to `numpy.unravel_index` converts this to a pair of indices $(j_{\\min}, k_{\\min})$. This procedure automatically adheres to the specified tie-breaking rule (smallest $j$, then smallest $k$) due to the row-major memory layout of NumPy arrays. The minimum potential is $V_{\\min} = V(\\theta_{j_{\\min}}, \\phi_{k_{\\min}})$, and its angular location is $(\\theta_{j_{\\min}}, \\phi_{k_{\\min}})$.\n\nFinally, the results for each test case are formatted as required. The angles $\\theta_{\\min}$ and $\\phi_{\\min}$ are converted from radians to degrees. The azimuthal angle $\\phi_{\\min}$ is adjusted from the range $[0, 360)$ to $(-180, 180]$. The values are then rounded: angles to $2$ decimal places and the potential to $3$ decimal places. The collective results are assembled into a single string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the molecular electrostatic potential problem for the given test cases.\n    \"\"\"\n\n    # Physical constants in SI units\n    D_TO_CM = 3.33564e-30  # Debye to Coulomb-meter\n    A_TO_M = 1.0e-10       # Angstrom to meter\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    K_E = 1.0 / (4.0 * np.pi * EPSILON_0) # Coulomb's constant (N*m^2/C^2)\n\n    # Molecular parameters\n    molecular_params = {\n        'H2O': {'b': 0.9572, 'alpha': 104.52, 'mu': 1.855}, # b in A, alpha in deg, mu in D\n        'H2S': {'b': 1.336, 'alpha': 92.1, 'mu': 0.97}\n    }\n\n    # Test suite\n    test_cases = [\n        # (Molecule, Radius R in A, N_theta, N_phi)\n        ('H2O', 2.0, 181, 361),\n        ('H2S', 2.0, 181, 361),\n        ('H2O', 3.0, 121, 241),\n        ('H2S', 3.0, 121, 241),\n    ]\n\n    all_results = []\n    \n    # Pre-calculate model parameters for each molecule to avoid redundant computation\n    charge_models = {}\n    for name, params in molecular_params.items():\n        # Convert parameters to SI units\n        b_m = params['b'] * A_TO_M\n        alpha_rad = np.deg2rad(params['alpha'])\n        mu_cm = params['mu'] * D_TO_CM\n        \n        beta_rad = alpha_rad / 2.0\n        cos_beta = np.cos(beta_rad)\n        sin_beta = np.sin(beta_rad)\n\n        # Calculate lone pair distance d_L\n        d_L_m = b_m * (0.70 / 0.9572)\n        \n        # Calculate lone pair angle beta_L\n        cos_beta_L = -1.0 / (3.0 * cos_beta)\n        sin_beta_L = np.sqrt(1.0 - cos_beta_L**2)\n\n        # Calculate charge positions in SI units (meters)\n        R_H1 = np.array([b_m * sin_beta, 0.0, b_m * cos_beta])\n        R_H2 = np.array([-b_m * sin_beta, 0.0, b_m * cos_beta])\n        R_L1 = np.array([0.0, d_L_m * sin_beta_L, d_L_m * cos_beta_L])\n        R_L2 = np.array([0.0, -d_L_m * sin_beta_L, d_L_m * cos_beta_L])\n        \n        charge_positions = np.array([R_H1, R_H2, R_L1, R_L2])\n\n        # Calculate charge magnitude q\n        denominator = 2.0 * (b_m * cos_beta - d_L_m * cos_beta_L)\n        q_coulomb = mu_cm / denominator\n        \n        charges = np.array([q_coulomb, q_coulomb, -q_coulomb, -q_coulomb])\n        \n        charge_models[name] = {\n            'positions': charge_positions,\n            'charges': charges\n        }\n\n    for case in test_cases:\n        molecule, R_A, N_theta, N_phi = case\n        R_m = R_A * A_TO_M\n        model = charge_models[molecule]\n        \n        # Create angular grids\n        theta_grid = np.linspace(0, np.pi, N_theta)\n        phi_grid = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n        \n        theta_mesh, phi_mesh = np.meshgrid(theta_grid, phi_grid, indexing='ij')\n\n        # Calculate Cartesian coordinates of all grid points on the sphere\n        x = R_m * np.sin(theta_mesh) * np.cos(phi_mesh)\n        y = R_m * np.sin(theta_mesh) * np.sin(phi_mesh)\n        z = R_m * np.cos(theta_mesh)\n        \n        # Reshape grid points for broadcasting: (N_theta, N_phi, 1, 3)\n        r_grid = np.stack([x, y, z], axis=-1)[:, :, np.newaxis, :]\n        \n        # Reshape charge positions for broadcasting: (1, 1, 4, 3)\n        charge_pos_bc = model['positions'][np.newaxis, np.newaxis, :, :]\n        \n        # Calculate distances from each grid point to each charge\n        dist_vectors = r_grid - charge_pos_bc\n        distances = np.linalg.norm(dist_vectors, axis=3)\n        \n        # Calculate potential V by summing contributions from each charge\n        # Reshape charges for broadcasting: (1, 1, 4)\n        charges_bc = model['charges'][np.newaxis, np.newaxis, :]\n        potential_grid = np.sum(K_E * charges_bc / distances, axis=2)\n\n        # Find the minimum potential and its indices\n        min_V = np.min(potential_grid)\n        min_idx_flat = np.argmin(potential_grid)\n        j_min, k_min = np.unravel_index(min_idx_flat, potential_grid.shape)\n        \n        # Get the angles corresponding to the minimum\n        theta_min_rad = theta_grid[j_min]\n        phi_min_rad = phi_grid[k_min]\n\n        # Convert angles to degrees and format for output\n        theta_min_deg = np.rad2deg(theta_min_rad)\n        phi_min_deg = np.rad2deg(phi_min_rad)\n        \n        # Adjust phi to be in the range (-180, 180]\n        if phi_min_deg  180.0:\n            phi_min_deg -= 360.0\n            \n        all_results.append([theta_min_deg, phi_min_deg, min_V])\n\n    # Format the final output string as specified\n    result_strings = []\n    for res in all_results:\n        theta, phi, V = res\n        result_strings.append(f\"[{theta:.2f},{phi:.2f},{V:.3f}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}