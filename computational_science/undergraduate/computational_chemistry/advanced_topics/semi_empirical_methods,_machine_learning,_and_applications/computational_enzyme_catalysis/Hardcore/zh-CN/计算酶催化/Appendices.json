{
    "hands_on_practices": [
        {
            "introduction": "计算酶催化研究中的一个核心任务是模拟化学反应的势能面。本练习将使用经验价键（EVB）模型，一种简化但功能强大的方法，来构建反应势能面并计算反应速率，从而让您对如何将分子模型与动力学可观测量联系起来建立基础的理解。通过实现这个模型，您将亲身体验从理论哈密顿量到可预测的催化速率的完整流程。",
            "id": "2452864",
            "problem": "要求您编写一个完整的程序，在一个简化的量子力学/分子力学 (QM/MM) 框架内，评估酶活性位点中一个提议的底物结合构象对于催化是否具有动力学活性。目标是根据一个源自量子力学和过渡态理论的原理模型，对代表不同构象的几组参数集，判断其计算出的转换速率是否至少达到指定的阈值。\n\n假设以下物理和建模原则为基本基础：\n\n- Born–Oppenheimer 近似表明，电子和原子核的运动可以分离。沿反应坐标 $x$ 的反应电子能量可以用一个经验价键 (EVB) 双态哈密顿量来建模，该哈密顿量将 QM/MM 能量近似为一个 $2 \\times 2$ 矩阵，其非绝热态代表嵌入在固定分子力学 (MM) 环境中的类反应物和类产物构型。\n- 非绝热势能定义为\n  $$U_1(x) = \\tfrac{1}{2} k_1 (x - x_1)^2 + s_1 (x - x_{\\mathrm{ref}}) + c_1,$$\n  $$U_2(x) = \\Delta_0 + \\tfrac{1}{2} k_2 (x - x_2)^2 + s_2 (x - x_{\\mathrm{ref}}) + c_2,$$\n  其中 $x$ 是一维反应坐标，单位为 $\\mathrm{\\AA}$；$k_1$ 和 $k_2$ 是谐波曲率，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$；$x_1$ 和 $x_2$ 是非绝热态极小值点的位置，单位为 $\\mathrm{\\AA}$；$s_1$ 和 $s_2$ 是线性耦合项，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$，用于模拟沿 $x$ 的环境极化；$x_{\\mathrm{ref}}$ 是参考位置，单位为 $\\mathrm{\\AA}$；$c_1$ 和 $c_2$ 是常数偏移，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$；$\\Delta_0$ 是受环境影响的非绝热态偏移，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。常数非绝热耦合为 $V$，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 绝热下表面 $E_{-}(x)$，代表沿 $x$ 的 Born–Oppenheimer 基态势能，是哈密顿量的较小特征值\n  $$\\mathbf{H}(x) = \\begin{pmatrix} U_1(x)  V \\\\ V  U_2(x) \\end{pmatrix},$$\n  其表达式为\n  $$E_{-}(x) = \\tfrac{1}{2}\\left[U_1(x) + U_2(x) - \\sqrt{\\left(U_1(x) - U_2(x)\\right)^2 + 4 V^2}\\right].$$\n- 活化自由能 $\\Delta G^{\\ddagger}$ 近似为绝热表面上过渡态（位于反应物和产物极小值之间的局部极大值）位置 $x^{\\ddagger}$ 与反应物极小值位置 $x_{\\mathrm{R}}$ 之间的能量差，两者均在 $E_{-}(x)$ 上：\n  $$\\Delta G^{\\ddagger} = E_{-}(x^{\\ddagger}) - E_{-}(x_{\\mathrm{R}}).$$\n- 过渡态理论 (TST)，特别是 Eyring 方程，给出的转换速率常数 $k$ 为\n  $$k = \\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right),$$\n  其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数， $h$ 是普朗克常数， $R$ 是气体常数， $T$ 是绝对温度。使用 $R$ 的单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，并通过在需要时将 $\\Delta G^{\\ddagger}$ 从 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 来确保单位一致性。\n\n您的程序必须：\n\n- 对每组参数集，在一个从 $x_{\\min} = \\min(x_1, x_2) - \\delta$ 到 $x_{\\max} = \\max(x_1, x_2) + \\delta$ 的均匀 $x$ 网格上数值计算 $E_{-}(x)$，其中 $\\delta = 0.3\\,\\mathrm{\\AA}$。在中点 $x_{\\mathrm{mid}} = \\tfrac{1}{2}(x_1 + x_2)$ 的左侧定位反应物极小值 $x_{\\mathrm{R}}$，在 $x_{\\mathrm{mid}}$ 的右侧定位产物极小值，然后确定这两个极小值之间的最大值以获得 $x^{\\ddagger}$。\n- 计算 $\\Delta G^{\\ddagger}$（单位 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$），然后使用 Eyring 方程在指定的温度 $T$ 下计算 $k$（单位 $\\mathrm{s}^{-1}$）。\n- 通过检查是否满足 $k \\ge k_{\\mathrm{thr}}$ 来判断动力学活性，其中 $k_{\\mathrm{thr}}$ 是一个指定的阈值，单位为 $\\mathrm{s}^{-1}$。\n- 为每个测试用例返回一个布尔值结果。\n\n使用以下常数和单位：\n\n- $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$，$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$，$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 温度 $T$ 的单位为 $\\mathrm{K}$。\n- 反应坐标 $x$ 的单位为 $\\mathrm{\\AA}$。\n- 能量 $U_1$, $U_2$, $V$, $\\Delta_0$, $c_1$, $c_2$ 和 $\\Delta G^{\\ddagger}$ 的单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 速率常数 $k$ 和阈值 $k_{\\mathrm{thr}}$ 的单位为 $\\mathrm{s}^{-1}$。\n\n测试套件（三个案例，分别用于探测一个典型的活性构象、一个新的结合模式导致的高势垒非活性构象，以及一个临界情况）：\n\n- 案例 1（类标准活性构象）：\n  - $k_1 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_1 = 2.4\\,\\mathrm{\\AA}$,\n  - $k_2 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_2 = 1.4\\,\\mathrm{\\AA}$,\n  - $\\Delta_0 = 5.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V = 2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $s_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$, $s_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$,\n  - $c_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $c_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $x_{\\mathrm{ref}} = 2.0\\,\\mathrm{\\AA}$, $T = 300.0\\,\\mathrm{K}$, $k_{\\mathrm{thr}} = 10.0\\,\\mathrm{s}^{-1}$。\n- 案例 2（具有更高势垒的新构象，预期为非活性）：\n  - $k_1 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_1 = 2.4\\,\\mathrm{\\AA}$,\n  - $k_2 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_2 = 1.4\\,\\mathrm{\\AA}$,\n  - $\\Delta_0 = 20.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V = 2.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $s_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$, $s_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$,\n  - $c_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $c_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $x_{\\mathrm{ref}} = 2.0\\,\\mathrm{\\AA}$, $T = 300.0\\,\\mathrm{K}$, $k_{\\mathrm{thr}} = 10.0\\,\\mathrm{s}^{-1}$。\n- 案例 3（临界新构象，接近阈值）：\n  - $k_1 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_1 = 2.4\\,\\mathrm{\\AA}$,\n  - $k_2 = 500.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$, $x_2 = 1.4\\,\\mathrm{\\AA}$,\n  - $\\Delta_0 = 12.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $V = 2.4\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $s_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$, $s_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-1}$,\n  - $c_1 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$, $c_2 = 0.0\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$,\n  - $x_{\\mathrm{ref}} = 2.0\\,\\mathrm{\\AA}$, $T = 300.0\\,\\mathrm{K}$, $k_{\\mathrm{thr}} = 10.0\\,\\mathrm{s}^{-1}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[True,False,True]”）。每个元素都必须是一个布尔值，指示相应的案例是否具有动力学活性（如果 $k \\ge k_{\\mathrm{thr}}$ 则为 $\\mathrm{True}$，否则为 $\\mathrm{False}$）。此行前后不得有任何多余的文本。不需要用户输入。所有计算都应是确定性的。",
            "solution": "所提出的问题是计算化学动力学中的一个标准且定义明确的练习，特别是在使用经验价键 (EVB) 方法的简化量子力学/分子力学 (QM/MM) 建模框架内。任务是通过计算酶促转换速率并将其与给定阈值进行比较，来评估底物结合构象的动力学活性。该问题具有科学依据，逻辑上一致，并为确定性解决方案提供了所有必要信息。因此，我们着手进行分析。\n\n解决方案是通过严格、逐步地应用问题陈述中概述的物理和数学原理来构建的。\n\n首先，我们定义一维反应势能面。该体系由两个非绝热态描述，分别代表类反应物和类产物的电子构型。它们的势能 $U_1(x)$ 和 $U_2(x)$ 是广义反应坐标 $x$ 的函数。其定义如下：\n$$U_1(x) = \\tfrac{1}{2} k_1 (x - x_1)^2 + s_1 (x - x_{\\mathrm{ref}}) + c_1$$\n$$U_2(x) = \\Delta_0 + \\tfrac{1}{2} k_2 (x - x_2)^2 + s_2 (x - x_{\\mathrm{ref}}) + c_2$$\n在这里，$k_1$ 和 $k_2$ 是力常数，$x_1$ 和 $x_2$ 是非绝热态极小值的位置，$\\Delta_0$ 是一个非绝热能量偏移，而涉及 $s_1$、$s_2$、$c_1$ 和 $c_2$ 的项则考虑了环境效应和能量移动。这两个态通过一个恒定的非对角项 $V$ 耦合。\n\nBorn-Oppenheimer 基态势能面，表示为较低的绝热面 $E_{-}(x)$，可从 $2 \\times 2$ EVB 哈密顿矩阵的较小特征值获得：\n$$\\mathbf{H}(x) = \\begin{pmatrix} U_1(x)  V \\\\ V  U_2(x) \\end{pmatrix}$$\n该特征值的解析表达式已提供：\n$$E_{-}(x) = \\tfrac{1}{2}\\left[U_1(x) + U_2(x) - \\sqrt{\\left(U_1(x) - U_2(x)\\right)^2 + 4 V^2}\\right]$$\n\n计算任务的核心是分析该绝热面 $E_{-}(x)$ 的拓扑结构。我们必须在反应坐标的一个指定范围（从 $x_{\\min} = \\min(x_1, x_2) - \\delta$ 到 $x_{\\max} = \\max(x_1, x_2) + \\delta$，其中 $\\delta = 0.3\\,\\mathrm{\\AA}$）内数值计算此函数。为确保准确性，我们将此范围离散化为一个精细、均匀的点网格。\n\n在这个 $E_{-}(x)$ 的数值表示上，我们必须确定关键点：反应物态极小值、产物态极小值以及分隔它们俩的过渡态极大值。根据问题的约定，反应物区域定义在中点 $x_{\\mathrm{mid}} = \\tfrac{1}{2}(x_1 + x_2)$ 的左侧，产物区域在其右侧。我们通过在网格的反应物区域中找到能量最低点来定位反应物极小值的位置 $x_{\\mathrm{R}}$。类似地，我们找到产物极小值 $x_{\\mathrm{P}}$。位于 $x^{\\ddagger}$ 位置的过渡态对应于连接 $x_{\\mathrm{R}}$ 和 $x_{\\mathrm{P}}$ 路径上的能量最高点。\n\n在确定了这些点之后，我们计算活化自由能 $\\Delta G^{\\ddagger}$。在此模型中，它被近似为过渡态和反应物态之间的势能差：\n$$\\Delta G^{\\ddagger} = E_{-}(x^{\\ddagger}) - E_{-}(x_{\\mathrm{R}})$$\n此能量的单位是 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n最后，我们通过 Eyring 方程应用过渡态理论 (TST) 来计算转换速率常数 $k$：\n$$k = \\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right)$$\n此处，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$h$ 是普朗克常数，$T$ 是绝对温度，$R$ 是理想气体常数。保持单位一致性至关重要。由于 $R$ 的单位是 $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，我们必须将 $\\Delta G^{\\ddagger}$ 从 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 乘以 $1000$ 转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n底物构象的动力学活性由一个简单的布尔条件确定：如果计算出的速率常数 $k$ 大于或等于指定的阈值速率 $k_{\\mathrm{thr}}$，则该构象被认为是具有活性的。程序将对提供的三个测试用例中的每一个实施此完整过程，生成一个布尔结果列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational enzyme catalysis problem for a set of test cases.\n    \"\"\"\n\n    # Physical constants\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    H = 6.62607015e-34   # Planck constant in J*s\n    R = 8.314462618     # Gas constant in J/(mol*K)\n\n    def is_kinetically_competent(params):\n        \"\"\"\n        Evaluates a single parameter set for kinetic competence.\n\n        Args:\n            params (tuple): A tuple containing all parameters for a single case.\n\n        Returns:\n            bool: True if k = k_thr, False otherwise.\n        \"\"\"\n        k1, x1, k2, x2, delta0, V, s1, s2, c1, c2, x_ref, T, k_thr = params\n\n        # Set up the reaction coordinate grid\n        delta = 0.3\n        x_min = min(x1, x2) - delta\n        x_max = max(x1, x2) + delta\n        # Use a high-resolution grid for numerical accuracy\n        num_points = 20000\n        x_grid = np.linspace(x_min, x_max, num_points)\n\n        # Calculate diabatic potential energies U1(x) and U2(x)\n        U1 = 0.5 * k1 * (x_grid - x1)**2 + s1 * (x_grid - x_ref) + c1\n        U2 = delta0 + 0.5 * k2 * (x_grid - x2)**2 + s2 * (x_grid - x_ref) + c2\n\n        # Calculate the adiabatic ground-state potential energy surface E_(x)\n        E_minus = 0.5 * (U1 + U2 - np.sqrt((U1 - U2)**2 + 4 * V**2))\n\n        # Partition the grid into reactant and product regions\n        x_mid = 0.5 * (x1 + x2)\n        mid_idx = np.abs(x_grid - x_mid).argmin()\n\n        # Locate the reactant minimum (left of midpoint)\n        reactant_E_slice = E_minus[:mid_idx]\n        reactant_x_slice = x_grid[:mid_idx]\n        reactant_min_idx_local = np.argmin(reactant_E_slice)\n        E_R = reactant_E_slice[reactant_min_idx_local]\n        reactant_min_idx_global = reactant_min_idx_local\n        \n        # Locate the product minimum (right of midpoint)\n        product_E_slice = E_minus[mid_idx:]\n        product_min_idx_local = np.argmin(product_E_slice)\n        product_min_idx_global = mid_idx + product_min_idx_local\n\n        # Locate the transition state as the maximum between the two minima\n        # Ensure the slice indices are in the correct order\n        start_idx = min(reactant_min_idx_global, product_min_idx_global)\n        end_idx = max(reactant_min_idx_global, product_min_idx_global)\n\n        ts_E_slice = E_minus[start_idx : end_idx + 1]\n        \n        # Avoid issues with empty slices if minima are adjacent\n        if ts_E_slice.size == 0:\n            # If there's no barrier, reaction is extremely fast.\n            # This case won't be triggered by the provided parameters.\n            return True \n            \n        ts_max_idx_local = np.argmax(ts_E_slice)\n        E_TS = ts_E_slice[ts_max_idx_local]\n\n        # Calculate activation energy in kJ/mol\n        delta_G_ddagger_kjmol = E_TS - E_R\n\n        # Convert activation energy to J/mol for the Eyring equation\n        delta_G_ddagger_jmol = delta_G_ddagger_kjmol * 1000.0\n\n        # Calculate the rate constant k using the Eyring equation\n        k = (KB * T / H) * np.exp(-delta_G_ddagger_jmol / (R * T))\n\n        # Compare with the threshold\n        return k = k_thr\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (competent canonical-like pose)\n        (500.0, 2.4, 500.0, 1.4, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 300.0, 10.0),\n        # Case 2 (new pose with higher barrier, expected incompetent)\n        (500.0, 2.4, 500.0, 1.4, 20.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 300.0, 10.0),\n        # Case 3 (borderline new pose, near threshold)\n        (500.0, 2.4, 500.0, 1.4, 12.0, 2.4, 0.0, 0.0, 0.0, 0.0, 2.0, 300.0, 10.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = is_kinetically_competent(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "酶的活性通常高度依赖于 pH 等环境因素，这会影响关键催化残基的质子化状态。本实践将超越简单的静态能垒概念，引导您将蛋白质静电环境对关键催化残基 $\\mathrm{p}K_a$ 的影响整合到模型中。通过这个练习，您将学会如何构建一个更真实、依赖于 pH 的活化能模型，从而理解酶在生理条件下的行为。",
            "id": "2452903",
            "problem": "您被要求编写一个完整、可运行的程序，该程序为一个由组氨酸残基在酶活性位点催化的质子转移步骤，建立一个耦合了质子化态和量子力学/分子力学 (QM/MM) 的活化自由能模型。对于每个测试用例，该程序必须首先使用类似于基于结构的预测器中所用的静电移位模型，估算组氨酸的有效酸解离常数（$\\mathrm{p}K_a$），然后计算在 $\\mathrm{pH}$ $7$ 时组氨酸的质子化分数，最后利用这些信息，使用嵌入在介电环境中的双态谐振（Marcus 型）近似，计算质子转移反应的一维活化自由能。需要报告的最终结果是所提供测试用例的总活化自由能，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，四舍五入到三位小数，并以要求的格式打印为单行列表。\n\n从以下基于物理的定义和关系开始。\n\n- 由单个点电荷在某一位点产生的库仑静电势：使用分子模拟的约定\n  $$\\phi = \\dfrac{k_e\\,q_{\\text{env}}}{\\varepsilon_r\\,r}$$,\n  其中 $\\phi$ 是该位点的静电势，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{e}^{-1}$，$k_e = 138.935458$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}\\,\\mathrm{e}^{-2}$ 是以方便单位表示的静电常数，$q_{\\text{env}}$ 是环境点电荷，以基本电荷单位 ($\\mathrm{e}$) 计，$\\varepsilon_r$ 是相对介电常数 (无量纲)，$r$ 是距离，单位为 $\\mathrm{nm}$。\n- 去质子化自由能与 $\\mathrm{p}K_a$ 之间的关系：如果 $\\Delta G_{\\text{deprot}}$ 是标准态去质子化自由能，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，则\n  $$\\Delta G_{\\text{deprot}} = R\\,T\\,\\ln(10)\\,\\mathrm{p}K_a$$,\n  其中 $R$ 是气体常数，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，$T$ 是绝对温度，单位为 $\\mathrm{K}$。\n- 对于质子化后电荷增加 $+\\!1$ 的位点（组氨酸从中性变为 $\\mathrm{HisH}^{+}$），其 $\\mathrm{p}K_a$ 的静电移位：由环境引起的去质子化自由能变化为 $\\Delta G_{\\text{deprot,env}} = -\\phi$，因此该位点的有效 $\\mathrm{p}K_a$ 为\n  $$\\mathrm{p}K_{a,\\text{eff}} = \\mathrm{p}K_{a,\\text{model}} - \\dfrac{\\phi}{R\\,T\\,\\ln(10)}$$。\n- 在给定 $\\mathrm{pH}$ 下，酸式（质子化组氨酸）分数的 Henderson–Hasselbalch 关系：\n  $$f_{\\text{prot}} = \\dfrac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_{a,\\text{eff}}}}$$。\n- 根据供体（组氨酸）和受体（底物）的有效酸度表示的质子转移反应的标准自由能：\n  $$\\Delta G^\\circ = R\\,T\\,\\ln(10)\\,\\left(\\mathrm{p}K_{a,\\text{donor,eff}} - \\mathrm{p}K_{a,\\text{acceptor,eff}}\\right)$$。\n- 对于具有相同曲率抛物线和重组自由能 $\\lambda$ 的原子核转移，其双态谐振 (Marcus 型) 活化自由能：\n  $$\\Delta G^\\ddagger_{\\text{intrinsic}} = \\dfrac{\\lambda}{4}\\left(1 + \\dfrac{\\Delta G^\\circ}{\\lambda}\\right)^2$$。\n- 布居门控罚分，因为只有质子化的组氨酸才能引发转移：如果可观测速率与 $f_{\\text{prot}}$ 乘以内禀速率成正比，那么用自由能表示则为\n  $$\\Delta G^\\ddagger_{\\text{pop}} = -R\\,T\\,\\ln\\left(f_{\\text{prot}}\\right)$$。\n- 总有效活化自由能为\n  $$\\Delta G^\\ddagger_{\\text{eff}} = \\Delta G^\\ddagger_{\\text{intrinsic}} + \\Delta G^\\ddagger_{\\text{pop}}$$。\n\n程序要求。\n\n- 精确实现上述方程。使用 $R = 8.314462618\\times 10^{-3}$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，并根据每个测试用例和定义的要求，数值计算 $\\ln(10)$。所有能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位计算和返回。所有距离以 $\\mathrm{nm}$ 为单位。所有电荷以基本电荷单位计。所有介电常数均为无量纲。角度不出现。\n- 对于每个测试用例：\n  1. 根据相同的环境电荷，计算组氨酸位点的静电势 $\\phi_{\\text{His}}$ 和受体位点的静电势 $\\phi_{\\text{Acc}}$。\n  2. 使用静电移位方程，计算 $\\mathrm{p}K_{a,\\text{His,eff}}$ 和 $\\mathrm{p}K_{a,\\text{Acc,eff}}$，其中组氨酸使用提供的 $\\mathrm{p}K_{a,\\text{model}}$，受体则使用其提供的溶液 $\\mathrm{p}K_a$ 作为其模型值。\n  3. 使用 Henderson–Hasselbalch 关系和 $\\mathrm{p}K_{a,\\text{His,eff}}$，计算在 $\\mathrm{pH}$ $7$ 时的 $f_{\\text{prot}}$。\n  4. 计算 $\\Delta G^\\circ$，然后用给定的 $\\lambda$ 计算 $\\Delta G^\\ddagger_{\\text{intrinsic}}$。\n  5. 计算 $\\Delta G^\\ddagger_{\\text{pop}}$，最后计算 $\\Delta G^\\ddagger_{\\text{eff}}$。\n- 测试套件：使用以下四个用例，每个用例定义为一个有序元组\n  $(\\mathrm{p}K_{a,\\text{His,model}}, q_{\\text{env}}, \\varepsilon_r, r_{\\text{His}}\\,\\mathrm{(nm)}, \\mathrm{pH}, \\mathrm{p}K_{a,\\text{Acc,sol}}, r_{\\text{Acc}}\\,\\mathrm{(nm)}, \\lambda\\,\\mathrm{(kJ/mol)}, T\\,\\mathrm{(K)})$：\n  - 用例 $1$（典型的埋藏负电荷环境，有利的供体）：$(6.50, -1.00, 20.0, 0.50, 7.00, 4.50, 0.60, 40.0, 300.0)$。\n  - 用例 $2$（无环境电荷，供体略弱于受体）：$(6.50, 0.00, 20.0, 0.50, 7.00, 7.50, 0.50, 40.0, 300.0)$。\n  - 用例 $3$（供体附近强烈的埋藏负电荷环境）：$(6.50, -1.00, 10.0, 0.30, 7.00, 5.00, 0.50, 30.0, 300.0)$。\n  - 用例 $4$（破坏供体质子化稳定性的正电荷环境）：$(6.50, +1.00, 15.0, 0.40, 7.00, 7.50, 0.50, 50.0, 300.0)$。\n- 输出：您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的结果列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是用例 $i$ 的 $\\Delta G^\\ddagger_{\\text{eff}}$ 值，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，四舍五入到三位小数。\n\n您的实现不得读取任何输入，也不得访问任何文件或网络资源。它必须能直接运行，并以指定格式精确打印一行。",
            "solution": "该问题要求计算由组氨酸残基催化的质子转移反应的有效活化自由能 $\\Delta G^\\ddagger_{\\text{eff}}$。这项任务通过构建一个基于物理化学和计算生物物理学基本原理的多步骤模型来完成。该模型将酶的静电环境对反应物性质的影响与经典反应动力学理论相结合。\n\n对每个测试用例，计算都按顺序进行。每个用例的参数包括：组氨酸催化剂的模型 $\\mathrm{p}K_a$ ($\\mathrm{p}K_{a,\\text{His,model}}$)、环境点电荷 ($q_{\\text{env}}$)、相对介电常数 ($\\varepsilon_r$)、从环境电荷到组氨酸质子化位点的距离 ($r_{\\text{His}}$)、系统 $\\mathrm{pH}$、质子受体的溶液 $\\mathrm{p}K_a$ ($\\mathrm{p}K_{a,\\text{Acc,sol}}$)、从环境电荷到受体质子化位点的距离 ($r_{\\text{Acc}}$)、质子转移的重组能 ($\\lambda$) 以及绝对温度 ($T$)。\n\n第一步是量化酶的静电环境对催化组氨酸和底物受体的质子亲和性的影响。这是通过计算环境电荷 $q_{\\text{env}}$ 在组氨酸和受体位点位置产生的静电势 $\\phi$ 来实现的。使用连续介电介质中静电势的标准公式：\n$$ \\phi = \\dfrac{k_e\\,q_{\\text{env}}}{\\varepsilon_r\\,r} $$\n其中 $k_e = 138.935458\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}\\,\\mathrm{e}^{-2}$ 是库仑常数，$q_{\\text{env}}$ 是以基本单位表示的电荷，$\\varepsilon_r$ 是相对介电常数，$r$ 是以 $\\mathrm{nm}$ 为单位的距离。我们使用各自的距离 $r_{\\text{His}}$ 和 $r_{\\text{Acc}}$ 计算出两个电势 $\\phi_{\\text{His}}$ 和 $\\phi_{\\text{Acc}}$。\n\n计算出的电势代表将单位正电荷从无穷远处移动到相应位点所需的静电功。这个功直接改变了去质子化的自由能。对于一个在其质子化状态下电荷多一个正单位的基团（如组氨酸），其标准去质子化自由能的变化为 $\\Delta\\Delta G_{\\text{deprot}} = -\\phi$。这导致了酸解离常数 $\\mathrm{p}K_a$ 的移位。有效 $\\mathrm{p}K_a$ 由下式给出：\n$$ \\mathrm{p}K_{a,\\text{eff}} = \\mathrm{p}K_{a,\\text{model}} - \\dfrac{\\phi}{R\\,T\\,\\ln(10)} $$\n其中 $R = 8.314462618\\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 是气体常数，$T$ 是开尔文温度。此方程用于计算 $\\mathrm{p}K_{a,\\text{His,eff}}$ 和 $\\mathrm{p}K_{a,\\text{Acc,eff}}$，使用它们各自的模型 $\\mathrm{p}K_a$ 值和计算出的电势。对于受体，其给定的溶液 $\\mathrm{p}K_a$ 作为其模型 $\\mathrm{p}K_a$。\n\n催化循环由质子化的组氨酸形式引发。因此，其在生理 $\\mathrm{pH}$ 条件下的可用性至关重要。质子化组氨酸的分数 $f_{\\text{prot}}$ 由 Henderson-Hasselbalch 方程确定，使用其新计算出的有效 $\\mathrm{p}K_a$：\n$$ f_{\\text{prot}} = \\dfrac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_{a,\\text{His,eff}}}} $$\n所有测试用例的指定 $\\mathrm{pH}$ 均为 $7.00$。\n\n在确定了供体（组氨酸）和受体的有效酸度后，我们可以计算质子转移反应本身的标准自由能变 $\\Delta G^\\circ$：\n$$ \\Delta G^\\circ = R\\,T\\,\\ln(10)\\,\\left(\\mathrm{p}K_{a,\\text{His,eff}} - \\mathrm{p}K_{a,\\text{Acc,eff}}\\right) $$\n此 $\\Delta G^\\circ$ 代表反应步骤的热力学驱动力。\n\n化学步骤的活化能使用双态谐振近似进行建模，这是 Marcus 理论的一种简化形式。对于曲率相等的抛物线，内禀活化自由能 $\\Delta G^\\ddagger_{\\text{intrinsic}}$ 由下式给出：\n$$ \\Delta G^\\ddagger_{\\text{intrinsic}} = \\dfrac{\\lambda}{4}\\left(1 + \\dfrac{\\Delta G^\\circ}{\\lambda}\\right)^2 $$\n其中 $\\lambda$ 是重组能，一个量化系统（蛋白质和溶剂）从反应物平衡几何构型重排到产物平衡几何构型所需能量代价的参数。\n\n最后，总的有效活化自由能必须考虑酶处于催化活性（质子化）状态的概率。这是一种预平衡或“布居门控”效应。用自由能来表示，这会给内禀能垒增加一个罚分 $\\Delta G^\\ddagger_{\\text{pop}}$：\n$$ \\Delta G^\\ddagger_{\\text{pop}} = -R\\,T\\,\\ln\\left(f_{\\text{prot}}\\right) $$\n由于 $f_{\\text{prot}} \\le 1$，该项始终为非负值。当活性形式稀疏分布时，其值会变大。\n\n总的有效活化自由能，对应于实验可观测的速率常数，是内禀能垒和布居门控罚分之和：\n$$ \\Delta G^\\ddagger_{\\text{eff}} = \\Delta G^\\ddagger_{\\text{intrinsic}} + \\Delta G^\\ddagger_{\\text{pop}} $$\n这个综合值既反映了活性位点质子化态的热力学，也反映了基本质子转移步骤的动力学。实现将对每组输入参数执行这些计算，并报告最终的 $\\Delta G^\\ddagger_{\\text{eff}}$，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the calculation for all test cases and print the results.\n    \"\"\"\n    # Define physical constants as per the problem statement.\n    K_E = 138.935458  # kJ/mol * nm / e^2\n    R_GAS = 8.314462618e-3  # kJ/mol/K\n\n    # Test cases as provided in the problem statement.\n    # Each tuple contains:\n    # (pKa_His_model, q_env, eps_r, r_His, pH, pKa_Acc_sol, r_Acc, lambda, T)\n    test_cases = [\n        (6.50, -1.00, 20.0, 0.50, 7.00, 4.50, 0.60, 40.0, 300.0),\n        (6.50, 0.00, 20.0, 0.50, 7.00, 7.50, 0.50, 40.0, 300.0),\n        (6.50, -1.00, 10.0, 0.30, 7.00, 5.00, 0.50, 30.0, 300.0),\n        (6.50, 1.00, 15.0, 0.40, 7.00, 7.50, 0.50, 50.0, 300.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        pka_his_model, q_env, eps_r, r_his, ph, pka_acc_sol, r_acc, lambda_val, temp = case\n        \n        # Calculate the activation energy for the current case.\n        result = calculate_activation_energy(\n            pka_his_model, q_env, eps_r, r_his, ph, pka_acc_sol, r_acc, lambda_val, temp,\n            K_E, R_GAS\n        )\n        results.append(result)\n\n    # Format the results for printing: rounded to three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_activation_energy(pka_his_model, q_env, eps_r, r_his, ph, pka_acc_sol, r_acc, lambda_val, temp, k_e, r_gas):\n    \"\"\"\n    Calculates the total effective activation free energy for a single test case.\n    \n    Args:\n        pka_his_model (float): Model pKa of histidine.\n        q_env (float): Environmental point charge in elementary charge units.\n        eps_r (float): Relative dielectric constant.\n        r_his (float): Distance from charge to His site (nm).\n        ph (float): System pH.\n        pka_acc_sol (float): Solution pKa of the acceptor.\n        r_acc (float): Distance from charge to acceptor site (nm).\n        lambda_val (float): Reorganization free energy (kJ/mol).\n        temp (float): Absolute temperature (K).\n        k_e (float): Electrostatic constant.\n        r_gas (float): Gas constant.\n        \n    Returns:\n        float: The calculated total effective activation free energy (kJ/mol).\n    \"\"\"\n    \n    # 1. Compute common thermodynamic factors.\n    ln10 = np.log(10)\n    rt_ln10 = r_gas * temp * ln10\n    rt_val = r_gas * temp\n\n    # 2. Compute electrostatic potentials at His and acceptor sites.\n    # phi = (k_e * q_env) / (eps_r * r)\n    phi_his = (k_e * q_env) / (eps_r * r_his)\n    phi_acc = (k_e * q_env) / (eps_r * r_acc)\n    \n    # 3. Compute effective pKa values.\n    # pKa_eff = pKa_model - phi / (R * T * ln(10))\n    pka_his_eff = pka_his_model - phi_his / rt_ln10\n    pka_acc_eff = pka_acc_sol - phi_acc / rt_ln10 # pka_acc_sol is used as its model value.\n    \n    # 4. Compute the protonation fraction of histidine.\n    # f_prot = 1 / (1 + 10^(pH - pKa_eff))\n    f_prot = 1.0 / (1.0 + 10**(ph - pka_his_eff))\n    \n    # 5. Compute the standard free energy of the proton transfer reaction.\n    # dG_reaction = R * T * ln(10) * (pKa_donor_eff - pKa_acceptor_eff)\n    dG_reaction = rt_ln10 * (pka_his_eff - pka_acc_eff)\n    \n    # 6. Compute the intrinsic activation free energy (Marcus-type model).\n    # dG_intrinsic = (lambda / 4) * (1 + dG_reaction / lambda)^2\n    dG_intrinsic = (lambda_val / 4.0) * (1.0 + dG_reaction / lambda_val)**2\n    \n    # 7. Compute the population gating free energy penalty.\n    # dG_pop = - R * T * ln(f_prot)\n    # Handle the case where f_prot is exactly 1 to avoid log(1) = -0.0 issues.\n    if f_prot  1.0 - 1e-9: # Effectively f_prot is 1.0\n        dG_pop = 0.0\n    else:\n        dG_pop = -rt_val * np.log(f_prot)\n        \n    # 8. Compute the total effective activation free energy.\n    # dG_eff = dG_intrinsic + dG_pop\n    dG_eff = dG_intrinsic + dG_pop\n\n    return dG_eff\n\n# Execute the main function when the script is run.\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "虽然静态模型是理解酶催化的有用起点，但酶本身是高度动态的分子实体。这项高级练习将挑战您对比一个静态的 QM 簇模型和一个更复杂的 QM/MM MD 模型，后者包含了环境的静电涨落和构象熵的贡献。通过推导和实现这个高级模型，您将揭示源于蛋白质动态特性的关键催化效应，并深入理解不同层次理论模型之间的差异与联系。",
            "id": "2452929",
            "problem": "您将实现一个沿单一反应坐标的酶催化反应的两种简化模型之间的、基于基本原理的比较。目的是量化并解释一个全原子量子力学/分子力学 (QM/MM) 分子动力学 (MD) 模型所能捕捉到，但一个带有隐式溶剂的静态量子力学 (QM) 簇模型所缺失的催化效应。为在确保可解性的同时保持科学真实性，您将使用一个双势阱来模拟沿单一坐标 $x$ 的反应，该双势阱代表反应物和产物势盆以及一个中心过渡态。您将从基本统计力学推导出有效自由能曲线，然后计算两种模型下的活化自由能。\n\n基本原理：\n- 过渡态理论 (TST) 通过 $k \\propto \\exp(-\\beta \\Delta G^{\\ddagger})$ 将速率常数与活化自由能关联起来，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是 Boltzmann 常数。对于每摩尔的能量，使用气体常数 $R$ 代替 $k_{\\mathrm{B}}$，因此 $\\beta = 1/(R T)$。\n- 平均力势 $W(x)$ 通过对环境自由度的边缘化来定义，$W(x) = -k_{\\mathrm{B}} T \\ln \\int \\mathrm{d}\\mathbf{s}\\, p(\\mathbf{s}) \\exp\\left(-\\beta U(x,\\mathbf{s})\\right)$，其中 $U(x,\\mathbf{s})$ 是总势能，$p(\\mathbf{s})$ 是在固定 $x$ 时环境坐标 $\\mathbf{s}$ 的平衡分布。\n- 如果环境通过与标量场 $E$ 的线性相互作用耦合到反应坐标，并且 $E$ 是一个均值为 $\\bar{E}$、方差为 $\\sigma_{E}^{2}$ 的 Gaussian 随机变量，那么 PMF 可以通过对 $E$ 进行解析积分获得。\n\n模型定义：\n- 沿 $x$ 的裸气相反应势（无量纲）：$V_{0}(x) = A \\left(x^{2} - x_{0}^{2}\\right)^{2}$，其在 $x \\approx \\pm x_{0}$ 附近有极小值点，在 $x \\approx 0$ 附近有高度约为 $A x_{0}^{4}$ 的势垒。\n- 沿 $x$ 的反应耦合“电荷分离强度”：$q(x) = q_{\\mathrm{TS}} \\exp\\!\\left(-\\dfrac{(x - x_{\\mathrm{TS}})^{2}}{2 s_{q}^{2}}\\right)$，其中 $x_{\\mathrm{TS}} = 0$。该模型模拟了电荷重组在过渡态附近达到最大的情况。\n- 沿 $x$ 的构象门控因子（可及构象数）：$g(x) = 1 + c_{g} \\exp\\!\\left(-\\dfrac{(x - x_{\\mathrm{TS}})^{2}}{2 s_{g}^{2}}\\right)$。这模拟了由于存在多个与过渡态对齐的构象而产生的熵贡献，该贡献使 $W(x)$ 降低了 $-k_{\\mathrm{B}} T \\ln g(x)$。\n\n待比较的模型：\n- 带隐式溶剂的 QM 簇模型（静态连续介质反应场）。假设平均场相互作用能的形式为 $U_{\\mathrm{imp}}(x) = - \\bar{E}\\, q(x)$，因此簇模型的自由能曲线为\n  $$\n  W_{\\mathrm{cl}}(x) = V_{0}(x) - \\bar{E}\\, q(x).\n  $$\n- QM/MM MD（全原子环境积分）。从 PMF 定义出发\n  $$\n  W_{\\mathrm{QM/MM}}(x) = -k_{\\mathrm{B}} T \\ln \\int_{-\\infty}^{\\infty} \\mathrm{d}E\\, \\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2}) \\exp\\!\\left(-\\beta \\left[V_{0}(x) - q(x) E\\right]\\right) \\;-\\; k_{\\mathrm{B}} T \\ln g(x),\n  $$\n  其中 $\\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2})$ 是均值为 $\\bar{E}$、方差为 $\\sigma_{E}^{2}$ 的 Gaussian 分布。您必须完成此 Gaussian 积分，以获得 $W_{\\mathrm{QM/MM}}(x)$ 关于 $V_{0}(x)$、$q(x)$、$\\bar{E}$、$\\sigma_{E}^{2}$、$\\beta$ 和 $g(x)$ 的解析表达式。此结果应能清晰地阐明平均静电作用、静电涨落和熵门控的作用。\n\n活化自由能：\n- 对每个模型，将过渡态位置定义为 $x_{\\mathrm{TS}} = 0$，并通过在包含左势阱（反应物势盆）的定义域上最小化相应的 $W(x)$ 来计算反应物态最小值点 $x_{\\mathrm{R}}$。然后计算活化自由能\n  $$\n  \\Delta G_{\\mathrm{cl}}^{\\ddagger} = W_{\\mathrm{cl}}(x_{\\mathrm{TS}}) - \\min_{x \\in \\mathcal{D}_{\\mathrm{R}}} W_{\\mathrm{cl}}(x), \\quad\n  \\Delta G_{\\mathrm{QM/MM}}^{\\ddagger} = W_{\\mathrm{QM/MM}}(x_{\\mathrm{TS}}) - \\min_{x \\in \\mathcal{D}_{\\mathrm{R}}} W_{\\mathrm{QM/MM}}(x).\n  $$\n- 通过将差异 $\\Delta \\Delta G^{\\ddagger} = \\Delta G_{\\mathrm{QM/MM}}^{\\ddagger} - \\Delta G_{\\mathrm{cl}}^{\\ddagger}$ 分解为簇模型缺失的两种催化效应来解释该差异：\n  1. 静电涨落稳定化效应（源于 $\\sigma_{E}^{2}  0$）。\n  2. 熵门控效应（源于 $g(x)$，其中 $c_{g}  0$）。\n  使用推导出的 $W_{\\mathrm{QM/MM}}(x)$，将相对于簇模型的势垒降低的各项贡献估算为 $x_{\\mathrm{TS}}$ 和 $x_{\\mathrm{R}}$ 之间各项的差值，并使用能量单位为 $0.05$ 的数值阈值来判断哪些效应是显著的。\n\n单位与常数：\n- 所有能量单位必须是 $\\mathrm{kJ\\,mol^{-1}}$。\n- 温度单位必须是 $\\mathrm{K}$。\n- 使用 $R = 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n- 报告的活化自由能以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，四舍五入到三位小数。\n\n测试组：\n实现您的程序，计算以下 4 种情况的结果。参数顺序为 $(A, x_{0}, q_{\\mathrm{TS}}, s_{q}, \\bar{E}, \\sigma_{E}, c_{g}, s_{g}, T)$：\n1. $(50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 1.0, 0.3, 300.0)$\n2. $(50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 1.0, 0.3, 300.0)$\n3. $(50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 0.0, 0.3, 300.0)$\n4. $(50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 0.0, 0.3, 300.0)$\n\n输出规格：\n- 对于每个测试用例，输出一个形式为 $[\\Delta G_{\\mathrm{cl}}^{\\ddagger}, \\Delta G_{\\mathrm{QM/MM}}^{\\ddagger}, C]$ 的列表，其中 $C$ 是一个整数分类代码，指示簇模型缺失了哪些催化效应：\n  - $0$：均不显著，\n  - $1$：仅静电涨落，\n  - $2$：仅熵门控，\n  - $3$：两种效应均有。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、包含 4 个列表的逗号分隔列表，例如：$[[a_{1},b_{1},c_{1}],[a_{2},b_{2},c_{2}],[a_{3},b_{3},c_{3}],[a_{4},b_{4},c_{4}]]$，其中每个 $a_{i}$ 和 $b_{i}$ 是四舍五入到三位小数的浮点数，每个 $c_{i}$ 是一个整数。\n\n实现约束：\n- 过渡态位置固定在 $x_{\\mathrm{TS}} = 0$。\n- 必须通过在左势阱域 $\\mathcal{D}_{\\mathrm{R}}$ 内进行连续优化来找到反应物最小值点；选择一个包含左侧最小值点的鲁棒有界区间（例如，一个跨越负 $x$ 值且包含 $-x_{0}$ 的区间）。\n- 该代码必须是一个完整、可运行的程序，并且精确地生成上述单行输出，不含任何附加文本。",
            "solution": "所提出的问题是计算化学和统计力学中的一个有效练习。它在科学上基于过渡态理论和平均力势（PMF）的定义。所提供的模型虽然经过简化，但代表了用于理解酶催化的常用方法，即带有隐式溶剂反应场的静态 QM 簇模型，以及一个更具动态性、明确考虑了环境涨落和构象效应的 QM/MM 模型。该问题是良定的，所有必要的参数、常数和函数形式都已定义，从而能够得出一个唯一且有意义的解。其表述客观，不包含任何科学或逻辑上的矛盾。从一个 Gaussian 积分推导 PMF 解析表达式的任务是一个标准且可解的过程。因此，我将给出完整的解法。\n\n问题的核心是推导 QM/MM 自由能曲线 $W_{\\mathrm{QM/MM}}(x)$ 的解析形式，然后用它与更简单的簇模型 $W_{\\mathrm{cl}}(x)$ 进行定量比较。\n\n让我们从推导 $W_{\\mathrm{QM/MM}}(x)$ 开始。其定义是两个项的和。第二项 $-k_{\\mathrm{B}} T \\ln g(x)$ 代表熵门控贡献，可以单独处理。我们先关注第一项，它涉及对环境电场 $E$ 的积分：\n$$\nW_{\\mathrm{int}}(x) = -k_{\\mathrm{B}} T \\ln \\int_{-\\infty}^{\\infty} \\mathrm{d}E\\, \\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2}) \\exp\\left(-\\beta \\left[V_{0}(x) - q(x) E\\right]\\right)\n$$\n其中对于摩尔能量，$\\beta = 1/(RT)$，而 $\\mathcal{N}(E \\mid \\bar{E}, \\sigma_{E}^{2}) = \\frac{1}{\\sqrt{2\\pi\\sigma_{E}^{2}}} \\exp\\left(-\\frac{(E-\\bar{E})^2}{2\\sigma_{E}^2}\\right)$ 是 $E$ 的 Gaussian 概率密度函数。\n\n设该积分为 $I(x)$。我们可以将与 $E$ 无关的项提取出来：\n$$\nI(x) = \\exp\\left(-\\beta V_{0}(x)\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma_{E}^{2}}} \\exp\\left(-\\frac{(E-\\bar{E})^2}{2\\sigma_{E}^2} + \\beta q(x) E\\right) \\mathrm{d}E\n$$\n积分内指数函数的参数可以通过对 $E$ 配方法进行重排：\n\\begin{align*}\n-\\frac{(E-\\bar{E})^2}{2\\sigma_{E}^2} + \\beta q(x) E = -\\frac{E^2 - 2E\\bar{E} + \\bar{E}^2}{2\\sigma_{E}^2} + \\beta q(x) E \\\\\n= -\\frac{1}{2\\sigma_{E}^2} \\left[ E^2 - 2E\\bar{E} + \\bar{E}^2 - 2\\sigma_{E}^2 \\beta q(x) E \\right] \\\\\n= -\\frac{1}{2\\sigma_{E}^2} \\left[ E^2 - 2E(\\bar{E} + \\sigma_{E}^2 \\beta q(x)) + \\bar{E}^2 \\right] \\\\\n\\end{align*}\n为了配方，我们定义一个新的均值 $\\mu' = \\bar{E} + \\sigma_{E}^2 \\beta q(x)$。表达式变为：\n\\begin{align*}\n= -\\frac{1}{2\\sigma_{E}^2} \\left[ (E - \\mu')^2 - (\\mu')^2 + \\bar{E}^2 \\right] \\\\\n= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\frac{(\\mu')^2 - \\bar{E}^2}{2\\sigma_{E}^2} \\\\\n= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\frac{(\\bar{E} + \\sigma_{E}^2 \\beta q(x))^2 - \\bar{E}^2}{2\\sigma_{E}^2} \\\\\n= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\frac{2\\bar{E}\\sigma_{E}^2 \\beta q(x) + (\\sigma_{E}^2 \\beta q(x))^2}{2\\sigma_{E}^2} \\\\\n= -\\frac{(E - \\mu')^2}{2\\sigma_{E}^2} + \\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2\n\\end{align*}\n将此代回 $I(x)$ 的积分中：\n$$\nI(x) = \\exp\\left(-\\beta V_{0}(x)\\right) \\exp\\left(\\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma_{E}^{2}}} \\exp\\left(-\\frac{(E - \\mu')^2}{2\\sigma_{E}^2}\\right) \\mathrm{d}E\n$$\n剩余的积分是一个 Gaussian 概率密度函数在其整个定义域上的积分，其值等于 $1$。因此：\n$$\nI(x) = \\exp\\left(-\\beta V_{0}(x) + \\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2\\right)\n$$\n现在，我们计算 $W_{\\mathrm{int}}(x) = -k_{\\mathrm{B}} T \\ln I(x) = -\\frac{1}{\\beta} \\ln I(x)$：\n$$\nW_{\\mathrm{int}}(x) = -\\frac{1}{\\beta} \\left( -\\beta V_{0}(x) + \\beta \\bar{E} q(x) + \\frac{1}{2} \\beta^2 \\sigma_{E}^2 q(x)^2 \\right) = V_{0}(x) - \\bar{E} q(x) - \\frac{1}{2} \\beta \\sigma_{E}^2 q(x)^2\n$$\n将此与熵门控项结合，我们得到 QM/MM 自由能曲线的完整表达式：\n$$\nW_{\\mathrm{QM/MM}}(x) = V_{0}(x) - \\bar{E} q(x) - \\frac{1}{2} \\beta \\sigma_{E}^2 q(x)^2 - RT \\ln g(x)\n$$\n我们可以识别出前两项正是簇模型的自由能 $W_{\\mathrm{cl}}(x) = V_{0}(x) - \\bar{E} q(x)$。这使得一个清晰的分解成为可能：\n$$\nW_{\\mathrm{QM/MM}}(x) = W_{\\mathrm{cl}}(x) + \\Delta W_{\\mathrm{fluc}}(x) + \\Delta W_{\\mathrm{gate}}(x)\n$$\n其中 $\\Delta W_{\\mathrm{fluc}}(x) = - \\frac{1}{2} \\beta \\sigma_{E}^2 q(x)^2$ 是来自静电涨落的稳定化能，而 $\\Delta W_{\\mathrm{gate}}(x) = -RT \\ln g(x)$ 是来自熵门控的稳定化能。\n\n为计算每个模型的活化自由能 $\\Delta G^{\\ddagger} = W(x_{\\mathrm{TS}}) - W(x_{\\mathrm{R}})$，我们必须首先通过在反应物势盆域 $\\mathcal{D}_{\\mathrm{R}}$ 上数值最小化相应的势能 $W(x)$ 来找到反应物最小值点的位置 $x_{\\mathrm{R}}$。鉴于 $V_{0}(x)$ 的形式，该域可以被鲁棒地选择为一个负 $x$ 值的区间，例如 $[-2x_0, 0)$。过渡态固定在 $x_{\\mathrm{TS}} = 0$。\n\n为了解释活化势垒的差异，我们估算 QM/MM 模型中每个附加效应对相对于簇模型活化势垒降低的贡献。这个贡献可以通过评估未扰动（簇）模型的过渡态和反应物态之间每个新增能量项的变化来估算。\n由静电涨落引起的势垒降低为：\n$$\n\\Delta(\\Delta G^{\\ddagger})_{\\mathrm{fluc}} \\approx -[\\Delta W_{\\mathrm{fluc}}(x_{\\mathrm{TS}}) - \\Delta W_{\\mathrm{fluc}}(x_{\\mathrm{R,cl}})] = \\frac{1}{2} \\beta \\sigma_{E}^2 (q(x_{\\mathrm{TS}})^2 - q(x_{\\mathrm{R,cl}})^2)\n$$\n由熵门控引起的势垒降低为：\n$$\n\\Delta(\\Delta G^{\\ddagger})_{\\mathrm{gate}} \\approx -[\\Delta W_{\\mathrm{gate}}(x_{\\mathrm{TS}}) - \\Delta W_{\\mathrm{gate}}(x_{\\mathrm{R,cl}})] = RT (\\ln g(x_{\\mathrm{TS}}) - \\ln g(x_{\\mathrm{R,cl}}))\n$$\n如果某个效应对势垒降低的贡献超过 $0.05\\ \\mathrm{kJ\\,mol^{-1}}$，则该效应被认为是显著的。分类代码 $C$ 的确定如下：如果两者都不显著，则 $C=0$；如果只有涨落效应显著，则 $C=1$；如果只有门控效应显著，则 $C=2$；如果两者都显著，则 $C=3$。\n\n以下程序实现了这一完整过程。它定义了能量函数，为每个测试用例数值确定了两种模型的反应物最小值点和活化能，然后评估催化贡献的显著性以生成最终分类。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves the enzyme catalysis model comparison problem for a given set of test cases.\n    \"\"\"\n    \n    # Universal gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    # Define the test cases as per the problem statement.\n    # Parameters: (A, x0, q_TS, s_q, E_bar, sigma_E, c_g, s_g, T)\n    test_cases = [\n        (50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 1.0, 0.3, 300.0),\n        (50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 1.0, 0.3, 300.0),\n        (50.0, 1.0, 1.0, 0.2, 5.0, 10.0, 0.0, 0.3, 300.0),\n        (50.0, 1.0, 1.0, 0.2, 5.0, 0.0, 0.0, 0.3, 300.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, x0, q_TS, s_q, E_bar, sigma_E, c_g, s_g, T = case\n        \n        beta = 1.0 / (R * T)\n        x_TS = 0.0\n\n        # Define the fundamental components of the potentials\n        def V0(x):\n            return A * (x**2 - x0**2)**2\n\n        def q(x):\n            return q_TS * np.exp(-(x - x_TS)**2 / (2 * s_q**2))\n\n        def g(x):\n            return 1.0 + c_g * np.exp(-(x - x_TS)**2 / (2 * s_g**2))\n\n        # Define the free energy profiles for both models\n        def W_cl(x):\n            return V0(x) - E_bar * q(x)\n\n        def W_qmmm(x):\n            fluc_term = -0.5 * beta * sigma_E**2 * q(x)**2\n            gate_term = -(1.0 / beta) * np.log(g(x))\n            return W_cl(x) + fluc_term + gate_term\n\n        # --- Cluster Model Calculation ---\n        # Find reactant minimum for the cluster model\n        # Search in the left well, e.g., [-2*x0, 0)\n        res_cl = minimize_scalar(W_cl, bounds=(-2.0 * x0, -1e-9), method='bounded')\n        x_R_cl = res_cl.x\n        W_R_cl = res_cl.fun\n        \n        # Calculate activation energy for the cluster model\n        W_TS_cl = W_cl(x_TS)\n        dG_cl = W_TS_cl - W_R_cl\n\n        # --- QM/MM Model Calculation ---\n        # Find reactant minimum for the QM/MM model\n        res_qmmm = minimize_scalar(W_qmmm, bounds=(-2.0 * x0, -1e-9), method='bounded')\n        x_R_qmmm = res_qmmm.x\n        W_R_qmmm = res_qmmm.fun\n        \n        # Calculate activation energy for the QM/MM model\n        W_TS_qmmm = W_qmmm(x_TS)\n        dG_qmmm = W_TS_qmmm - W_R_qmmm\n\n        # --- Interpretation and Classification ---\n        # Estimate catalytic contributions based on perturbations to the cluster model\n        # evaluated at the cluster model's stationary points (TS and Reactant).\n        \n        # Contribution from electrostatic fluctuations\n        fluc_lowering = 0.0\n        if sigma_E  0:\n            fluc_term_at_ts = -0.5 * beta * sigma_E**2 * q(x_TS)**2\n            fluc_term_at_r = -0.5 * beta * sigma_E**2 * q(x_R_cl)**2\n            fluc_lowering = -(fluc_term_at_ts - fluc_term_at_r)\n        \n        # Contribution from entropic gating\n        gate_lowering = 0.0\n        if c_g  0:\n            gate_term_at_ts = -(1.0 / beta) * np.log(g(x_TS))\n            gate_term_at_r = -(1.0 / beta) * np.log(g(x_R_cl))\n            gate_lowering = -(gate_term_at_ts - gate_term_at_r)\n\n        # Determine significance\n        threshold = 0.05\n        is_fluc_significant = fluc_lowering  threshold\n        is_gate_significant = gate_lowering  threshold\n\n        # Assign classification code C\n        # 0: none, 1: fluc, 2: gate, 3: both\n        C = int(is_fluc_significant) + 2 * int(is_gate_significant)\n\n        results.append([round(dG_cl, 3), round(dG_qmmm, 3), C])\n    \n    # Format the results into the required single-line string\n    # e.g., [[val1, val2, val3], [val4, val5, val6]]\n    result_str = \"[\" + \",\".join([str(r) for r in results]) + \"]\"\n    print(result_str.replace(\" \", \"\"))\n\n\nsolve()\n\n```"
        }
    ]
}