{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex computational algorithms, it is crucial to build a firm grasp of the fundamentals. This first exercise provides a \"pen-and-paper\" opportunity to derive an Intrinsic Reaction Coordinate (IRC) from first principles for a simple, one-dimensional potential. By analytically solving the differential equation that defines the IRC, you will develop a concrete understanding of the relationship between the potential energy surface, the mass-weighted coordinate, and the reaction path length $s$ .",
            "id": "2899955",
            "problem": "Consider a one-dimensional model potential energy surface defined by the function $V(x) = (x^{2}-1)^{2}/4$, with atomic mass parameter $m=1$. The stationary point at $x=0$ is the transition state, and the minima are at $x=\\pm 1$. In the formalism of the intrinsic reaction coordinate (IRC), the path is defined as the steepest-descent curve on the potential energy surface when written in mass-weighted coordinates. Let $q=\\sqrt{m}\\,x$ denote the mass-weighted coordinate and let $s$ denote the arc-length parameter defined by the line element $\\mathrm{d}s^{2}=\\mathrm{d}q^{2}$, so that the tangent vector satisfies $|\\mathrm{d}q/\\mathrm{d}s|=1$, and the path direction is everywhere aligned with the negative gradient of $V$ in the $q$-coordinates.\n\nStarting only from these definitions and the given $V(x)$, derive the differential equation governing the IRC in one dimension and integrate it with the initial condition $x(0)=0$ to obtain the explicit expressions $x(s)$ for the two branches connecting the transition state to the two minima at $x=\\pm 1$. Then, expressing the path length $s$ as a function of the Cartesian coordinate $x$, show that it coincides with the absolute value of $x$ up to a constant factor for $m=1$, and determine that constant.\n\nGive your final answer in the form of a single closed-form expression for $s(x)$, valid on both branches. No units are required. Do not round.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The provided problem statement describes a standard exercise in theoretical chemistry concerning the Intrinsic Reaction Coordinate (IRC). It provides a one-dimensional potential energy surface $V(x) = (x^{2}-1)^{2}/4$, an atomic mass parameter $m=1$, and clear definitions for mass-weighted coordinates $q=\\sqrt{m}\\,x$ and the path arc length $s$. The definition of the IRC as the steepest-descent path in mass-weighted coordinates is standard. All provided information is self-contained and consistent. No scientific or logical flaws are identified. The problem is therefore deemed **valid** and a solution will be derived.\n\nThe Intrinsic Reaction Coordinate (IRC) is defined as the path of steepest descent on the potential energy surface, traced in mass-weighted coordinates. The tangent vector to this path, $\\mathrm{d}\\mathbf{q}/\\mathrm{d}s$, where $\\mathbf{q}$ is the vector of mass-weighted coordinates and $s$ is the arc length, is aligned with the negative of the potential energy gradient, $-\\nabla_q V$. The arc length $s$ is defined such that the tangent vector is a unit vector, $|\\mathrm{d}\\mathbf{q}/\\mathrm{d}s|=1$. This leads to the fundamental equation for the IRC:\n$$\n\\frac{\\mathrm{d}\\mathbf{q}}{\\mathrm{d}s} = -\\frac{\\nabla_q V}{|\\nabla_q V|}\n$$\nFor a one-dimensional system, the vectors become scalars, and the gradient $\\nabla_q$ becomes the derivative $\\mathrm{d}/\\mathrm{d}q$. The equation simplifies to:\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}s} = -\\frac{\\mathrm{d}V/\\mathrm{d}q}{|\\mathrm{d}V/\\mathrm{d}q|} = -\\mathrm{sgn}\\left(\\frac{\\mathrm{d}V}{\\mathrm{d}q}\\right)\n$$\nwhere $\\mathrm{sgn}(\\cdot)$ is the sign function.\n\nThe mass-weighted coordinate $q$ is related to the Cartesian coordinate $x$ by $q = \\sqrt{m}x$. The potential $V$ must be expressed as a function of $q$. Substituting $x=q/\\sqrt{m}$ into the expression for $V(x)$:\n$$\nV(q) = \\frac{1}{4} \\left( \\left(\\frac{q}{\\sqrt{m}}\\right)^{2} - 1 \\right)^{2} = \\frac{1}{4} \\left( \\frac{q^{2}}{m} - 1 \\right)^{2}\n$$\nNext, we compute the derivative of $V$ with respect to $q$:\n$$\n\\frac{\\mathrm{d}V}{\\mathrm{d}q} = \\frac{1}{4} \\cdot 2 \\left( \\frac{q^{2}}{m} - 1 \\right) \\cdot \\frac{2q}{m} = \\frac{q}{m} \\left( \\frac{q^{2}}{m} - 1 \\right) = \\frac{q(q^{2}-m)}{m^{2}}\n$$\nThe sign of $\\mathrm{d}V/\\mathrm{d}q$ is determined by the term $q(q^{2}-m)$, since $m^{2}$ is always positive. In terms of the Cartesian coordinate $x$, this term is $\\sqrt{m}x(m x^{2} - m) = m^{3/2}x(x^{2}-1)$. As $m>0$, the sign of $\\mathrm{d}V/\\mathrm{d}q$ is identical to the sign of $x(x^{2}-1)$.\nThe differential equation for the IRC in this specific problem is therefore:\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}s} = -\\mathrm{sgn}(x(x^{2}-1))\n$$\nSubstituting $q=\\sqrt{m}x$ into the left-hand side gives $\\mathrm{d}(\\sqrt{m}x)/\\mathrm{d}s = \\sqrt{m}(\\mathrm{d}x/\\mathrm{d}s)$. The equation becomes:\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -\\mathrm{sgn}(x(x^{2}-1))\n$$\nWe must now solve this equation for the two branches starting from the transition state at $x=0$, where by convention we set the arc length $s=0$.\n\nBranch 1: Path from the transition state ($x=0$) to the minimum at $x=1$. Along this path, the coordinate $x$ is in the interval $0 < x < 1$. In this interval, $x>0$ and $x^{2}-1<0$, so the product $x(x^{2}-1)$ is negative.\n$$\n\\mathrm{sgn}(x(x^{2}-1)) = -1\n$$\nThe differential equation for this branch is:\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -(-1) = 1\n$$\nThis is a separable differential equation: $\\sqrt{m}\\,\\mathrm{d}x = \\mathrm{d}s$. We integrate from the initial condition $(x,s) = (0,0)$ to a point $(x,s)$ on the path:\n$$\n\\int_{0}^{x} \\sqrt{m} \\, \\mathrm{d}x' = \\int_{0}^{s} \\mathrm{d}s' \\implies \\sqrt{m}x = s\n$$\nThe explicit expression for the path is $x(s) = s/\\sqrt{m}$, and the path length as a function of coordinate is $s(x) = \\sqrt{m}x$.\n\nBranch 2: Path from the transition state ($x=0$) to the minimum at $x=-1$. Along this path, the coordinate $x$ is in the interval $-1 < x < 0$. In this interval, $x<0$ and $x^{2}-1<0$, so the product $x(x^{2}-1)$ is positive.\n$$\n\\mathrm{sgn}(x(x^{2}-1)) = +1\n$$\nThe differential equation for this branch is:\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -(+1) = -1\n$$\nSeparating variables gives $\\sqrt{m}\\,\\mathrm{d}x = -\\mathrm{d}s$. Integrating from the initial condition $(x,s) = (0,0)$:\n$$\n\\int_{0}^{x} \\sqrt{m} \\, \\mathrm{d}x' = \\int_{0}^{s} (-1) \\, \\mathrm{d}s' \\implies \\sqrt{m}x = -s\n$$\nThe explicit expression for the path is $x(s) = -s/\\sqrt{m}$, and the path length as a function of coordinate is $s(x) = -\\sqrt{m}x$.\n\nCombining the results for the two branches, we can express the path length $s$ as a single function of the coordinate $x$:\nFor $x \\ge 0$, $s(x) = \\sqrt{m}x$.\nFor $x < 0$, $s(x) = -\\sqrt{m}x$.\nThis is equivalent to the compact expression:\n$$\ns(x) = \\sqrt{m}|x|\n$$\nThis result shows that the path length $s$ coincides with the absolute value of the Cartesian coordinate, $|x|$, up to a constant factor of $\\sqrt{m}$.\n\nThe problem explicitly states that the mass parameter is $m=1$. Substituting this value into our derived expression for $s(x)$:\n$$\ns(x) = \\sqrt{1} |x| = |x|\n$$\nThus, for the specified mass $m=1$, the constant factor is $1$. The final answer is the closed-form expression for $s(x)$ valid on both branches for $m=1$.",
            "answer": "$$\n\\boxed{|x|}\n$$"
        },
        {
            "introduction": "Moving from theory to practice, this exercise guides you through implementing your own IRC-following algorithm for a two-dimensional model of an $\\mathrm{S_N2}$ reaction. You will translate the concept of steepest descent into a working program and use it to explore a critical aspect of computational chemistry: the impact of the underlying theoretical model on the predicted reaction path. By comparing results from two different potential energy surfaces, which mimic the use of minimal versus larger basis sets, you will gain hands-on experience in how computational choices influence outcomes like reaction path length and product stability .",
            "id": "2456650",
            "problem": "You are asked to implement an intrinsic reaction coordinate (IRC) following algorithm for a two-dimensional model potential energy surface (PES) that qualitatively represents an $\\mathrm{S_N2}$ reaction. The IRC is defined as the steepest-descent path on a PES in mass-weighted coordinates that connects a first-order saddle point (transition state) to the reactant and product minima. Your program should compute and compare the IRC paths predicted by two different parameterizations of the PES, which mimic a minimal basis set (STO-3G) and a larger basis set (6-311+G**).\n\nFundamental basis to use:\n- A potential energy surface (PES) $V(\\mathbf{q})$ over coordinates $\\mathbf{q}$ defines the force via the negative gradient $-\\nabla V$.\n- The transition state (TS) is a stationary point with one negative eigenvalue of the Hessian matrix, that is, a first-order saddle point: $\\nabla V = \\mathbf{0}$ at the TS and the Hessian has exactly one negative eigenvalue.\n- In mass-weighted coordinates with unit masses, the IRC path is the steepest-descent path away from the TS in the direction of the unstable normal mode, obtained by following the negative gradient while enforcing a fixed arc-length parametrization.\n\nModel PES:\nUse the following two-dimensional PES with coordinates $\\mathbf{q} = (x,y)$:\n$$\nV(x,y) \\;=\\; a\\,x^4 \\;-\\; b\\,x^2 \\;+\\; c\\,y^2 \\;+\\; d\\,x\\,y^2 \\;+\\; e\\,x^3,\n$$\nwith the transition state at $(x,y)=(0,0)$. Two parameter sets are provided to mimic different basis sets in an ab initio calculation:\n- STO-3G-like parameters: $a=0.40$, $b=1.00$, $c=0.60$, $d=0.05$, $e=0.20$.\n- 6-311+G**-like parameters: $a=0.50$, $b=1.10$, $c=0.70$, $d=0.04$, $e=0.15$.\n\nAssumptions and units:\n- Work in atomic units with unit masses so that mass-weighted and Cartesian coordinates coincide. Energies are in Hartree, lengths (including arc-length along the path) are in Bohr. Any curvature proxy involving the Hessian has units $\\sqrt{\\text{Hartree}}/\\text{Bohr}$.\n- Angles are not used in this problem.\n\nCore tasks to implement from first principles:\n1. Compute the gradient $\\nabla V$ and the Hessian $\\nabla^2 V$ analytically.\n2. Verify that $(0,0)$ is a first-order saddle point for each parameter set by checking that the gradient is $\\mathbf{0}$ and that the Hessian has exactly one negative eigenvalue.\n3. Determine the unstable normal mode at the TS by diagonalizing the Hessian at $(0,0)$ and selecting the eigenvector corresponding to the negative eigenvalue. Orient this eigenvector so that its $x$-component is positive.\n4. Generate initial points for forward and backward IRC integration by displacing a small distance $\\epsilon$ along $\\pm$ the unstable eigenvector from the TS.\n5. Follow the steepest-descent path in unit mass-weighted coordinates using a fixed nominal arc-length step $ds$ with backtracking to enforce monotonically decreasing energy. At each step from $\\mathbf{q}_k$, move in the direction of $-\\nabla V(\\mathbf{q}_k)$ normalized to unit length, and accept a step only if it reduces $V$. Accumulate the actual arc-length along the accepted steps. Stop when the norm $\\|\\nabla V\\|$ drops below a tolerance $\\mathrm{tol}$ or when a maximum number of steps is reached.\n6. For each parameter set and for both forward (toward products) and backward (toward reactants) directions, record the sequence of points along the IRC, the total path length, and the final minimum energy reached.\n\nComparison metrics to compute:\nFor each test case, compute the following four scalar quantities comparing the larger-basis parameterization (6-311+G**) to the minimal-basis parameterization (STO-3G):\n- Curvature proxy difference: let $\\lambda_-$ denote the negative eigenvalue of the Hessian at the TS. Define a curvature proxy $\\kappa = \\sqrt{|\\lambda_-|}$ for each parameter set, and report $\\kappa_{\\text{6-311+G**}} - \\kappa_{\\text{STO-3G}}$ in $\\sqrt{\\text{Hartree}}/\\text{Bohr}$.\n- Forward path length difference: $L^{\\text{fwd}}_{\\text{6-311+G**}} - L^{\\text{fwd}}_{\\text{STO-3G}}$ in Bohr.\n- Product minimum energy difference: $E^{\\text{prod}}_{\\text{6-311+G**}} - E^{\\text{prod}}_{\\text{STO-3G}}$ in Hartree.\n- Maximum forward-path deviation: resample both forward IRC paths to $N=50$ points each using equal arc-length spacing along their respective total lengths, then compute the maximum Euclidean distance between corresponding points across the two resampled paths. Report this maximum in Bohr.\n\nNumerical details to implement:\n- Use analytical expressions for $\\nabla V$ and $\\nabla^2 V$.\n- Use a backtracking line search that halves the trial step size until the energy decreases, with a lower bound on the step size to prevent infinite loops.\n- Use $\\epsilon$ as the initial displacement magnitude away from the TS along the unstable eigenvector.\n- Convergence criterion: stop when $\\|\\nabla V\\| < \\mathrm{tol}$ or when the number of accepted steps equals $\\text{max\\_steps}$.\n- Resampling should be done by linear interpolation along the cumulative arc-length coordinate of each path.\n\nTest suite:\nRun your program for the following three test cases, each specified as a tuple $(ds,\\ \\mathrm{tol},\\ \\text{max\\_steps},\\ \\epsilon)$ with $ds$ and $\\epsilon$ in Bohr, $\\mathrm{tol}$ in Hartree/Bohr, and $\\text{max\\_steps}$ dimensionless:\n- Case 1 (happy path): $(0.05,\\ 1\\times 10^{-6},\\ 400,\\ 1\\times 10^{-3})$.\n- Case 2 (tighter tolerance, smaller steps): $(0.02,\\ 1\\times 10^{-7},\\ 800,\\ 5\\times 10^{-4})$.\n- Case 3 (coarser steps): $(0.08,\\ 1\\times 10^{-6},\\ 500,\\ 1\\times 10^{-3})$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list of results, one per test case, where each result is itself a list of four floating-point numbers in the order given in the Comparison metrics to compute section. All floating-point numbers must be rounded to six decimal places. For example, the output should look like:\n\"[ [v11,v12,v13,v14],[v21,v22,v23,v24],[v31,v32,v33,v34] ]\"\nwhere each $v_{ij}$ is a float with six digits after the decimal point, energies in Hartree, lengths in Bohr, and the curvature proxy in $\\sqrt{\\text{Hartree}}/\\text{Bohr}$.",
            "solution": "The user has presented a problem in computational chemistry, requiring the implementation and application of an Intrinsic Reaction Coordinate (IRC) following algorithm. A thorough validation of the problem statement is the mandatory first step.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\n- **Potential Energy Surface (PES)**: $V(x,y) = a\\,x^4 - b\\,x^2 + c\\,y^2 + d\\,x\\,y^2 + e\\,x^3$.\n- **Transition State (TS)**: Located at $(x,y)=(0,0)$.\n- **PES Parameter Sets**:\n    - STO-3G-like: $a=0.40$, $b=1.00$, $c=0.60$, $d=0.05$, $e=0.20$.\n    - 6-311+G**-like: $a=0.50$, $b=1.10$, $c=0.70$, $d=0.04$, $e=0.15$.\n- **Assumptions**: Atomic units, unit masses (mass-weighted coordinates are identical to Cartesian coordinates).\n- **Core Algorithm**: Steepest-descent path following from the TS, using analytical gradient and Hessian, with a fixed nominal arc-length step $ds$ and backtracking to ensure energy decrease.\n- **Initial Conditions**: Displace from the TS by $\\pm\\epsilon$ along the unstable normal mode eigenvector.\n- **Termination Conditions**: The path integration stops when the gradient norm $\\|\\nabla V\\|$ is less than a tolerance $\\mathrm{tol}$, or after a maximum of $\\text{max\\_steps}$.\n- **Comparison Metrics**:\n    1.  Curvature proxy difference: $\\kappa_{\\text{6-311+G**}} - \\kappa_{\\text{STO-3G}}$, with $\\kappa = \\sqrt{|\\lambda_-|}$.\n    2.  Forward path length difference: $L^{\\text{fwd}}_{\\text{6-311+G**}} - L^{\\text{fwd}}_{\\text{STO-3G}}$.\n    3.  Product minimum energy difference: $E^{\\text{prod}}_{\\text{6-311+G**}} - E^{\\text{prod}}_{\\text{STO-3G}}$.\n    4.  Maximum forward-path deviation after resampling both paths to $N=50$ equidistant points.\n- **Test Cases**: Three sets of $(ds, \\mathrm{tol}, \\text{max\\_steps}, \\epsilon)$ are provided.\n- **Output Format**: A specific string format `\"[ [v11,v12,v13,v14],[v21,v22,v23,v24],[v31,v32,v33,v34] ]\"` with floats rounded to six decimal places.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the principles of computational chemistry and physical chemistry. The concept of an IRC, its relation to the PES, transition states, Hessians, and normal modes are all standard and correctly described. The use of a model polynomial PES is a common pedagogical and research tool.\n- **Well-Posedness**: The problem is specified with a high degree of precision. It provides the mathematical model, all necessary parameters, the algorithm to be implemented including numerical details like backtracking and termination criteria, and a clear definition of the required output metrics. This ensures a unique and computable solution exists.\n- **Objectivity**: The problem is stated in objective, technical language, free from ambiguity, subjectivity, or opinion.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, and objective. It contains no discernible flaws, contradictions, or missing information. Therefore, the problem is deemed **VALID**. I will proceed with a complete solution.\n\n### Principle-Based Solution Design\n\nThe core task is to trace the Intrinsic Reaction Coordinate (IRC), which represents the minimum energy path connecting a transition state to reactants and products on a potential energy surface (PES).\n\n**1. Analytical Representation of the Potential Energy Surface**\n\nThe PES is given by the function:\n$$\nV(x,y) = a\\,x^4 - b\\,x^2 + c\\,y^2 + d\\,x\\,y^2 + e\\,x^3\n$$\nThe force acting on the system at a point $\\mathbf{q}=(x,y)$ is given by the negative gradient of the potential, $-\\nabla V(\\mathbf{q})$. The gradient vector, $\\nabla V$, is required for the path-following algorithm. Its components are the partial derivatives of $V$:\n$$\n\\nabla V(x,y) = \\begin{pmatrix} \\frac{\\partial V}{\\partial x} \\\\ \\frac{\\partial V}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 4ax^3 - 2bx + dy^2 + 3ex^2 \\\\ 2cy + 2dxy \\end{pmatrix}\n$$\nThe local curvature of the PES is described by the Hessian matrix, $\\nabla^2 V$, which contains the second partial derivatives:\n$$\n\\nabla^2 V(x,y) = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2} & \\frac{\\partial^2 V}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 V}{\\partial y \\partial x} & \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix} = \\begin{pmatrix} 12ax^2 - 2b + 6ex & 2dy \\\\ 2dy & 2c + 2dx \\end{pmatrix}\n$$\nThese analytical expressions are fundamental for the subsequent analysis and will be implemented directly.\n\n**2. Transition State Characterization**\n\nA transition state (TS) is a stationary point of first order. This requires two conditions to be met at the TS coordinates $\\mathbf{q}_{TS}$:\n1.  The gradient must be zero: $\\nabla V(\\mathbf{q}_{TS}) = \\mathbf{0}$.\n2.  The Hessian matrix $\\nabla^2 V(\\mathbf{q}_{TS})$ must have exactly one negative eigenvalue.\n\nThe problem states the TS is at $\\mathbf{q}_{TS} = (0,0)$. Let us verify this.\nEvaluating the gradient at $(0,0)$:\n$$\n\\nabla V(0,0) = \\begin{pmatrix} 4a(0)^3 - 2b(0) + d(0)^2 + 3e(0)^2 \\\\ 2c(0) + 2d(0)(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThe first condition is satisfied. Now, evaluating the Hessian at $(0,0)$:\n$$\n\\nabla^2 V(0,0) = \\begin{pmatrix} 12a(0)^2 - 2b + 6e(0) & 2d(0) \\\\ 2d(0) & 2c + 2d(0) \\end{pmatrix} = \\begin{pmatrix} -2b & 0 \\\\ 0 & 2c \\end{pmatrix}\n$$\nThis is a diagonal matrix, so its eigenvalues are the diagonal elements: $\\lambda_1 = -2b$ and $\\lambda_2 = 2c$. For both given parameter sets, $b > 0$ and $c > 0$. Thus, we have one negative eigenvalue ($\\lambda_-$) and one positive eigenvalue ($\\lambda_+$), confirming that $(0,0)$ is a first-order saddle point.\n\nThe eigenvector associated with the negative eigenvalue $\\lambda_- = -2b$ is the unstable normal mode, which defines the direction of the reaction path at the TS. For the diagonal Hessian, the eigenvector is clearly $\\mathbf{v}_- = (1, 0)^T$. The problem requires orienting this vector to have a positive $x$-component, which is already the case. The forward reaction path will start by moving from the TS in the direction of $+\\mathbf{v}_-$, and the backward path will start by moving in the direction of $-\\mathbf{v}_-$.\n\n**3. IRC Path-Following Algorithm**\n\nThe IRC is the steepest-descent path from the TS. We approximate this continuous path with a sequence of discrete points $\\mathbf{q}_k$.\n\n- **Initialization**: The integration starts from a point slightly displaced from the TS along the unstable mode. The forward path starts at $\\mathbf{q}_0 = \\mathbf{q}_{TS} + \\epsilon \\mathbf{v}_-$, and the backward path at $\\mathbf{q}_0 = \\mathbf{q}_{TS} - \\epsilon \\mathbf{v}_-$.\n- **Iteration**: From a point $\\mathbf{q}_k$, the next point $\\mathbf{q}_{k+1}$ is found by taking a step in the direction of the normalized negative gradient, $\\mathbf{u}_k = -\\nabla V(\\mathbf{q}_k) / \\|\\nabla V(\\mathbf{q}_k)\\|$.\n- **Step Size Control**: A nominal step size $ds$ is used. A trial point is proposed as $\\mathbf{q}_{\\text{trial}} = \\mathbf{q}_k + s \\mathbf{u}_k$, with an initial trial step length $s = ds$.\n- **Backtracking Line Search**: To ensure the path monotonically descends in energy, we check if $V(\\mathbf{q}_{\\text{trial}}) < V(\\mathbf{q}_k)$. If this condition is not met, the step length $s$ is halved, and a new $\\mathbf{q}_{\\text{trial}}$ is tested. This process is repeated until an energy-lowering step is found or the step size becomes smaller than a machine-precision threshold, at which point the path terminates.\n- **Termination**: The algorithm stops when either the gradient norm $\\|\\nabla V(\\mathbf{q}_k)\\|$ falls below a given tolerance $\\mathrm{tol}$, or a maximum number of steps, $\\text{max\\_steps}$, has been taken.\n- **Path Length**: The total arc length $L$ of the path is the sum of the actual accepted step lengths at each iteration.\n\n**4. Comparative Analysis Metrics**\n\nThe purpose is to compare the PES models.\n- **Curvature Proxy Difference**: The value $\\kappa = \\sqrt{|\\lambda_-|} = \\sqrt{2b}$ serves as a proxy for the curvature of the reaction barrier. The difference $\\kappa_{\\text{6-311+G**}} - \\kappa_{\\text{STO-3G}}$ quantifies how the second basis set model changes the barrier sharpness at the TS. This is independent of the IRC integration parameters.\n- **Path Length and Energy Differences**: Differences in the total forward path length, $L^{\\text{fwd}}$, and the final energy of the product minimum, $E^{\\text{prod}}$, directly compare the geometric and energetic outcomes predicted by the two PES models.\n- **Maximum Forward-Path Deviation**: This metric quantifies the geometric dissimilarity of the two reaction paths. Both forward paths are resampled to an equal number ($N=50$) of points, with each point separated by an equal fraction of that path's total arc length. This is achieved by linear interpolation of the path coordinates with respect to the cumulative arc length. The maximum Euclidean distance between corresponding points on the two resampled paths is then computed. This reveals the largest geometric divergence between the two predicted reaction mechanisms.\n\nThe implementation will follow these principles to solve for the given test cases and report the four specified comparative metrics.",
            "answer": "[[0.069026,0.067344,-0.038108,0.021008],[0.069026,0.067645,-0.038108,0.021074],[0.069026,0.066735,-0.038108,0.021008]]"
        },
        {
            "introduction": "The IRC is not just a line on a graph; it represents the bottom of a valley on the potential energy surface. This final practice is a numerical experiment designed to probe the topology of that valley around the transition state. By initiating a steepest-descent trajectory at an angle to the true transition vector, you will explore the concept of the \"dividing surface\" or \"watershed\" that separates the reactant basin from the product basin . This exercise provides powerful visual intuition for why the IRC represents the most probable reaction pathway and what happens when a reacting system deviates slightly from this ideal course.",
            "id": "2456634",
            "problem": "Consider a two-dimensional model potential energy surface defined on coordinates $x$ and $y$ with potential energy\n$$\nV(x,y) \\;=\\; \\tfrac{1}{4}x^{4} \\;-\\; \\tfrac{1}{2}x^{2} \\;+\\; \\tfrac{1}{2}y^{2} \\;+\\; d\\,x^{2}y^{2},\n$$\nwhere $d$ is a fixed positive parameter. The point $(x,y)=(0,0)$ is a first-order saddle point (transition state), and the two symmetry-related minima are located along the $x$-axis at nonzero $x$. Assume unit masses for all coordinates. The Intrinsic Reaction Coordinate (IRC) is defined as the curve $\\mathbf{R}(s)=(x(s),y(s))$ in mass-weighted coordinates that follows the steepest descent of the potential energy starting from the transition state in the direction of the negative-curvature eigenvector of the Hessian. In unit masses, the steepest-descent flow obeys the ordinary differential equation\n$$\n\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\nabla V\\big(\\mathbf{R}(s)\\big),\n$$\nwith $s$ a scalar path parameter. The gradient flow property implies\n$$\n\\frac{d}{ds}V\\big(\\mathbf{R}(s)\\big)\\;=\\; \\nabla V\\cdot\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\|\\nabla V\\|^{2}\\,\\le\\,0.\n$$\nThe Hessian matrix at the transition state is the matrix of second derivatives of $V(x,y)$ evaluated at $(0,0)$. The true transition vector is the eigenvector associated with the single negative eigenvalue of this Hessian. In this model, this true transition vector points along the $x$-axis (either $+x$ or $-x$).\n\nYour task is to write a complete program that integrates the steepest-descent equation from a small displacement off the transition state along an initial unit vector that is rotated by a given angle away from the true transition vector, and then determines the destination of the trajectory. Use the following precise specifications.\n\n1) Potential and its derivatives: Use $d=0.5$. The potential is\n$$\nV(x,y) \\;=\\; \\tfrac{1}{4}x^{4} \\;-\\; \\tfrac{1}{2}x^{2} \\;+\\; \\tfrac{1}{2}y^{2} \\;+\\; 0.5\\,x^{2}y^{2}.\n$$\nIts gradient components are\n$$\n\\frac{\\partial V}{\\partial x} \\;=\\; x^{3} - x + x\\,y^{2},\\qquad\n\\frac{\\partial V}{\\partial y} \\;=\\; y + x^{2}y,\n$$\nand its Hessian components are\n$$\n\\frac{\\partial^{2} V}{\\partial x^{2}} \\;=\\; 3x^{2} - 1 + y^{2},\\quad\n\\frac{\\partial^{2} V}{\\partial y^{2}} \\;=\\; 1 + x^{2},\\quad\n\\frac{\\partial^{2} V}{\\partial x\\,\\partial y} \\;=\\; 2xy.\n$$\n2) Initial condition construction: Let the transition state be at $(x,y)=(0,0)$ and let the true transition vector be along $+x$. For a given angle $\\theta$ (in degrees), define the unit direction $\\mathbf{u}(\\theta) = (\\cos\\theta,\\,\\sin\\theta)$, where the angle is interpreted with respect to $+x$ in the usual counterclockwise sense. Start the trajectory at\n$$\n\\mathbf{R}(0) \\;=\\; \\delta\\,\\mathbf{u}(\\theta),\n$$\nwith a fixed small displacement magnitude $\\delta = 10^{-3}$.\n\n3) IRC following as gradient flow: Integrate\n$$\n\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\nabla V(\\mathbf{R}),\n$$\nfrom $s=0$ until convergence, defined by $\\|\\nabla V(\\mathbf{R})\\|\\le \\varepsilon_{\\text{grad}}$ with $\\varepsilon_{\\text{grad}} = 10^{-8}$, or until a maximum path parameter $s_{\\max}$ is exceeded, where $s_{\\max}=200$.\n\n4) Destination classification: Upon convergence by the gradient-norm criterion, classify the endpoint $(x_{\\text{end}},y_{\\text{end}})$ by computing the Hessian eigenvalues at the endpoint. If all Hessian eigenvalues are strictly positive (within a numerical tolerance), classify the endpoint as a minimum; return the integer label $2$ if $x_{\\text{end}}>0$ and $1$ if $x_{\\text{end}}<0$. If at least one Hessian eigenvalue is negative (within a numerical tolerance) and the gradient norm is small, classify it as a first-order saddle near the transition state and return the integer label $0$. If the integration does not meet the gradient-norm convergence within $s_{\\max}$, you must still return an integer; in that case return $0$ if the endpoint Hessian has a negative eigenvalue, otherwise return $1$ if $x_{\\text{end}}<0$ or $2$ if $x_{\\text{end}}>0$. All numerical comparisons should use reasonable tolerances consistent with the scales given above.\n\n5) Angle unit: All angles $\\theta$ provided below are in degrees. No physical units are involved in this problem.\n\n6) Test suite: Run the program for the following five test angles with the fixed displacement magnitude $\\delta = 10^{-3}$ and with the parameters specified above:\n- $\\theta = 0$,\n- $\\theta = 180$,\n- $\\theta = 90$,\n- $\\theta = 80$,\n- $\\theta = 100$.\n\n7) Required final output format: Your program should produce a single line of output containing the results as a comma-separated list of integers enclosed in square brackets, in the same order as the test angles above. For example, an acceptable format is\n$$\n[\\ell_{1},\\ell_{2},\\ell_{3},\\ell_{4},\\ell_{5}],\n$$\nwhere each $\\ell_{k}$ is one of the integers $0$, $1$, or $2$ defined by the destination classification rule.\n\nYour implementation must numerically integrate the specified steepest-descent equation and apply the stated classification logic. The goal is to algorithmically answer: if the initial direction is rotated by $90$ degrees away from the true transition vector at the transition state, where does the trajectory go, and how does that compare with other rotations?",
            "solution": "The problem requires the numerical determination of the destination of steepest-descent paths on a two-dimensional potential energy surface, starting from the vicinity of a transition state. This is a classic problem in computational chemistry related to the concept of the Intrinsic Reaction Coordinate (IRC). The IRC formally connects a transition state to its adjacent minima.\n\nThe potential energy surface (PES) is given by the function:\n$$ V(x,y) = \\tfrac{1}{4}x^{4} - \\tfrac{1}{2}x^{2} + \\tfrac{1}{2}y^{2} + d\\,x^{2}y^{2} $$\nwith the parameter $d = 0.5$. The stationary points of this PES, where the gradient $\\nabla V = (\\partial V / \\partial x, \\partial V / \\partial y)$ is zero, are found to be at $(0,0)$, $(1,0)$, and $(-1,0)$. Analysis of the Hessian matrix of second derivatives,\n$$ \\mathbf{H} = \\begin{pmatrix} \\partial^2 V / \\partial x^2 & \\partial^2 V / \\partial x \\partial y \\\\ \\partial^2 V / \\partial y \\partial x & \\partial^2 V / \\partial y^2 \\end{pmatrix}, $$\nreveals their character. The point $(0,0)$ is a first-order saddle point (a transition state), with one negative and one positive eigenvalue. The points $(1,0)$ and $(-1,0)$ are minima, where both Hessian eigenvalues are positive. These represent the stable reactant and product states connected by the reaction path.\n\nThe IRC path is approximated by the steepest-descent trajectory $\\mathbf{R}(s) = (x(s), y(s))$ which follows the negative of the potential energy gradient. This is described by the system of ordinary differential equations (ODEs):\n$$ \\frac{d\\mathbf{R}}{ds} = -\\nabla V(\\mathbf{R}(s)) $$\nwhere $s$ is the path parameter. We are given the analytical expressions for the gradient components:\n$$ \\nabla V(x,y) = \\begin{pmatrix} x^{3} - x + x y^{2} \\\\ y + x^{2}y \\end{pmatrix} $$\n\nThe integration starts not at the transition state itself, which is a point of unstable equilibrium, but at a small displacement $\\delta = 10^{-3}$ away from it. The initial direction is specified by a unit vector $\\mathbf{u}(\\theta) = (\\cos\\theta, \\sin\\theta)$, where $\\theta$ is an angle in degrees relative to the $+x$ axis, which corresponds to the direction of the unstable mode (the transition vector) of the saddle point. Thus, the initial condition is:\n$$ \\mathbf{R}(0) = \\delta\\,\\mathbf{u}(\\theta) $$\n\nThe numerical solution is obtained by integrating this system of ODEs using a robust algorithm, such as the one implemented in `scipy.integrate.solve_ivp`. The integration proceeds until one of two conditions is met:\n$1.$ The path converges to a stationary point, which is detected when the norm of the gradient falls below a threshold: $\\|\\nabla V\\| \\le \\varepsilon_{\\text{grad}} = 10^{-8}$.\n$2.$ The path parameter $s$ reaches a maximum allowed value, $s_{\\max} = 200$.\n\nUpon termination, the destination of the trajectory must be classified. This is achieved by analyzing the properties of the final point $\\mathbf{R}_{\\text{end}} = (x_{\\text{end}}, y_{\\text{end}})$. The eigenvalues of the Hessian matrix $\\mathbf{H}(\\mathbf{R}_{\\text{end}})$ are computed.\n- If any eigenvalue is negative (within a numerical tolerance, taken as $-10^{-8}$), the endpoint is classified as being in a saddle point region, yielding the label $0$. This result is expected for trajectories that return to the vicinity of the transition state, exemplified by the path starting exactly along the stable $y$-direction ($\\theta = 90^\\circ$).\n- If all eigenvalues are non-negative, the endpoint is in a potential well corresponding to a minimum. The destination is then distinguished by the sign of the $x$-coordinate:\n  - Label $1$ is assigned if $x_{\\text{end}} < 0$, corresponding to the minimum at $(-1,0)$.\n  - Label $2$ is assigned if $x_{\\text{end}} > 0$, corresponding to the minimum at $(1,0)$.\n\nThis classification logic is applied regardless of whether convergence was achieved by the gradient norm criterion or by reaching the maximum path length. The behavior of the system is expected to show a bifurcation; for initial angles $\\theta$ in a range around $0^\\circ$, the trajectory will lead to the minimum at $(1,0)$, while for angles around $180^\\circ$, it will lead to the minimum at $(-1,0)$. The critical angle $\\theta = 90^\\circ$ lies on the dividing surface (the \"watershed\") between the two basins of attraction, and a trajectory starting there is expected to fall back to the transition state. The test cases with $\\theta=80^\\circ$ and $\\theta=100^\\circ$ are designed to probe this bifurcation behavior.\n\nThe program implements this entire procedure. It defines functions for the potential's gradient and Hessian, sets up the initial conditions for each test angle, performs the numerical integration with an event handler to detect convergence, and applies the specified classification rules to the final point of each trajectory.",
            "answer": "[2,1,0,2,1]"
        }
    ]
}