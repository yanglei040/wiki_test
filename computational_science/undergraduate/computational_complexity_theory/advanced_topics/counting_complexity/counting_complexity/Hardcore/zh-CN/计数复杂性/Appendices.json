{
    "hands_on_practices": [
        {
            "introduction": "许多计数问题，例如计算一个布尔公式的满足赋值数量，通常被认为是计算上非常困难的。然而，并非所有计数问题都是如此。这个练习将引导你分析一个基于线性代数的计数问题，它展示了如何利用数学结构的特性来开发高效的计数算法。通过将问题置于有限域 $GF(2)$ 上的向量空间中，我们可以借助秩-零化度定理得出一个简洁的公式，从而证明该问题属于可在多项式时间内求解的函数类 `FP`。",
            "id": "1419328",
            "problem": "在计算复杂性理论中，`FP`（Function-P）类是可以在多项式时间内由确定性图灵机计算的函数问题的集合。函数问题接受一个输入字符串并产生一个输出字符串，这与输出简单“是”或“否”的判定问题形成对比。\n\n考虑以下函数问题，我们称之为 `CountGF2Solutions`。该问题的输入是一个包含 $n$ 个变量的 $m$ 个线性方程组，其中所有系数和常数都属于二元有限域 $GF(2) = \\{0, 1\\}$。这个方程组可以紧凑地表示为一个 $m \\times n$ 矩阵 $A$ 和一个 $m \\times 1$ 向量 $b$，两者的元素都来自 $\\{0, 1\\}$，代表方程 $Ax = b$。函数 `CountGF2Solutions` 必须为给定的方程组输出不同解向量 $x \\in \\{0, 1\\}^n$ 的数量。\n\n一个已知的结论是，`CountGF2Solutions` 属于 `FP` 类，这意味着它的输出可以在相对于输入大小（与 $m \\times n$ 成比例）的多项式时间内计算出来。证明这一点的关键一步是，在假设方程组是一致的（即至少存在一个解）的情况下，建立一个计算解数量的公式。\n\n令 $r$ 为系数矩阵 $A$ 的秩。假设已知方程组 $Ax=b$ 是一致的，那么不同解的总数是多少？请用关于 $n$ 和 $r$ 的解析表达式来表示你的答案。",
            "solution": "我们在向量空间 $(\\mathrm{GF}(2))^{n}$ 上进行讨论。设 $A$ 是一个在 $\\mathrm{GF}(2)$ 上的 $m \\times n$ 矩阵，其秩为 $r$，并假设方程组 $Ax=b$ 是一致的。那么存在一个特解 $x_{0}$ 使得 $Ax_{0}=b$。\n\n所有解的集合是\n$$\nS=\\{x \\in (\\mathrm{GF}(2))^{n} : Ax=b\\}=\\{x_{0}+y : y \\in \\ker(A)\\}=x_{0}+\\ker(A).\n$$\n由 $\\phi(y)=x_{0}+y$ 定义的映射 $\\phi:\\ker(A)\\to S$ 是一个双射，因为在一个阿贝尔群中，加上一个固定向量是可逆的。因此，\n$$\n|S|=|\\ker(A)|.\n$$\n考虑由 $T(x)=Ax$ 给出的线性变换 $T:(\\mathrm{GF}(2))^{n}\\to(\\mathrm{GF}(2))^{m}$。根据秩-零化度定理，\n$$\n\\dim(\\ker(A))+\\operatorname{rank}(A)=n,\n$$\n所以\n$$\n\\dim(\\ker(A))=n-r.\n$$\n在 $\\mathrm{GF}(2)$ 上，任何维度为 $d$ 的向量空间都恰好有 $2^{d}$ 个元素，因为每个向量都是基向量的线性组合，其系数在 $\\{0,1\\}$ 中。因此，\n$$\n|\\ker(A)|=2^{\\dim(\\ker(A))}=2^{n-r}.\n$$\n综合这些，解的总数为\n$$\n|S|=2^{n-r}.\n$$",
            "answer": "$$\\boxed{2^{n-r}}$$"
        },
        {
            "introduction": "在计算复杂性理论中，一个核心思想是通过“规约”（reduction）来比较问题的相对难度。这个练习是一个经典的思维实验，旨在阐明这一概念。我们假设拥有一个神奇的“预言机”（oracle），它可以瞬间解决一个已知的难题——计算图中的哈密顿圈数量。你的任务是利用这个强大的工具来解决一个相关但不同的问题：计算两个指定顶点之间的哈密顿路径数量。这种方法揭示了不同计算问题之间深刻的内在联系，是理解 `#P` 完备性等高级概念的基石。",
            "id": "1419335",
            "problem": "在计算复杂性理论中，许多问题都是通过预言机（oracle）的视角来研究的。预言机是一个假设性的黑箱，它可以在单一步骤内解决特定的判定问题或计数问题。\n\n考虑一个任意的简单无向图 $G = (V, E)$，其中 $V$ 是顶点集，$E$ 是边集。**哈密顿路径**是图中恰好访问每个顶点一次的路径。**哈密顿圈**是图中恰好访问每个顶点一次，且起点和终点相同的圈。\n\n你可以使用一个强大的预言机 `CountHC(graph)`，它接受任何图作为输入，并在多项式时间内返回其中不同哈密顿圈的数量。\n\n你的任务是使用这个预言机来解决一个相关问题。给定图 $G$ 和两个不同的顶点 $u, v \\in V$，你想要找出从顶点 $u$ 开始到顶点 $v$ 结束的哈密顿路径的数量。\n\n为此，你从 $G$ 构建一个新图 $G'$。新图 $G'$ 是通过添加一个新顶点 $w$（其中 $w \\notin V$）和两条新边 $(w, u)$ 和 $(w, v)$ 构成的。最终得到的图是 $G' = (V \\cup \\{w\\}, E \\cup \\{(w, u), (w, v)\\})$。\n\n在 $G$ 中从 $u$ 开始到 $v$ 结束的哈密顿路径数量，与 `CountHC` 预言机应用于其中一个图的输出有何关系？\n\nA. 路径数量等于 `CountHC(G)`。\n\nB. 路径数量等于 `CountHC(G')`。\n\nC. 路径数量等于 `CountHC(G') / 2`。\n\nD. 路径数量等于 `CountHC(G') - CountHC(G)`。\n\nE. 仅使用 `CountHC` 预言机无法确定路径数量。",
            "solution": "给定一个简单无向图 $G=(V,E)$ 和两个不同的顶点 $u,v\\in V$。通过添加一个只与 $u$ 和 $v$ 相邻的新顶点 $w$，构造 $G'=(V\\cup\\{w\\},E\\cup\\{(w,u),(w,v)\\})$。\n\n定义 $\\mathcal{C}(G')$ 为 $G'$ 中哈密顿圈的集合，$\\mathcal{P}_{u,v}(G)$ 为 $G$ 中从 $u$ 开始到 $v$ 结束的哈密顿路径的集合。\n\n步骤1（$G'$ 中的圈映射到 $G$ 中的 $u$-$v$ 哈密顿路径）：在 $G'$ 中，顶点 $w$ 的度为 $\\deg_{G'}(w)=2$，其邻居恰好是 $\\{u,v\\}$。$G'$ 中的任何哈密顿圈都必须包含边 $(w,u)$ 和 $(w,v)$，并且恰好访问 $w$ 一次。从这样的圈中移除 $w$ 及其关联的边，会得到一条在 $G$ 中的路径，该路径恰好访问 $V$ 中的每个顶点一次，且其端点恰好是 $u$ 和 $v$。因此，存在一个定义明确的映射\n$$\n\\phi:\\mathcal{C}(G')\\to \\mathcal{P}_{u,v}(G),\n$$\n该映射通过从圈中删除 $w$ 来实现。\n\n步骤2（$G$ 中的哈密顿 $u$-$v$ 路径映射到 $G'$ 中的圈）：反过来，取任意 $P\\in\\mathcal{P}_{u,v}(G)$，这是一个从 $u$ 开始到 $v$ 结束，恰好访问 $V$ 中所有顶点一次的序列。通过添加 $w$ 以及边 $(w,u)$ 和 $(w,v)$，我们在 $G'$ 中形成一个圈，该圈恰好访问 $V\\cup\\{w\\}$ 中的每个顶点一次。这定义了一个映射\n$$\n\\psi:\\mathcal{P}_{u,v}(G)\\to \\mathcal{C}(G'),\n$$\n该映射通过在 $u$ 和 $v$ 之间插入 $w$ 来闭合路径形成圈。\n\n步骤3（双射和计数）：这两种构造互为逆运算：将 $\\phi$ 应用于 $G'$ 中的一个圈，然后再应用 $\\psi$，会恢复同一个圈（在无向图中，圈在旋转和反转下是等价的，这里不影响计数）；将 $\\psi$ 应用于 $G$ 中的一条路径，然后再应用 $\\phi$，会恢复同一条路径。因此，在 $\\mathcal{C}(G')$ 和 $\\mathcal{P}_{u,v}(G)$ 之间存在一个双射，所以\n$$\n|\\mathcal{P}_{u,v}(G)|=|\\mathcal{C}(G')|=\\text{CountHC}(G').\n$$\n由于预言机计算的是无向图 $G'$ 中不同的哈密顿圈的数量（即，一个圈不会因为相反的方向而被重复计数），因此不会产生额外的因子。因此，正确的关系是 $G$ 中从 $u$ 到 $v$ 的哈密顿路径的数量等于 $\\text{CountHC}(G')$。\n\n因此，正确选项是B。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在证明一个计数问题的计算硬度（例如，证明其为 `#P` 完备）时，一种关键的技术是“保持解数量的规约”（parsimonious reduction）。这种规约不仅将一个问题转化为另一个问题，而且在转化过程中精确地保持（或按已知因子缩放）解的数量。这个练习提供了一个具体的例子，演示了如何将一个已知的 `#P` 完备问题 `#PAIRED-NOT-EQUAL` 规约到 `#Not-All-Equal 3-SAT`。通过设计一个巧妙的“小工具”（gadget）来转换约束，你可以亲身体验构建复杂性证明的核心逻辑。",
            "id": "1419342",
            "problem": "一位计算机科学家正在研究计算复杂性理论中不同计数问题之间的关系。他们专注于一个他们称之为 `#PAIRED-NOT-EQUAL` (`#PNE`) 的问题，该问题已知是一个 `#P`-完全问题。一个 `#PNE` 的实例由一组 $n$ 个布尔变量和 $m$ 个这些变量的特定配对列表定义。一个 `#PNE` 实例的有效解是对 $n$ 个变量的真值赋值，使得对于每个指定的配对 $(x_i, x_j)$，变量被赋予不同的真值（即 $x_i \\ne x_j$）。问题 `#PNE` 是要计算此类有效解的总数。\n\n为了利用一个为“非全等三元可满足性”（Not-All-Equal 3-Satisfiability, NAE-3-SAT）问题设计的强大硬件加速器，该科学家设计了一种转换方法。对于 `#PNE` 实例中的 $m$ 个配对 $(x_i, x_j)$ 中的每一个，都会创建一个“小工具”(gadget)。这个小工具包含两个 NAE-3-SAT 子句，涉及一个新的、唯一的辅助变量 $a_k$（其中 $k$ 是配对的索引，从 $1$ 到 $m$）。具体来说，为配对 $(x_i, x_j)$ 生成的两个子句是：$(x_i, x_j, a_k)$ 和 $(x_i, x_j, \\neg a_k)$。\n\n新的 NAE-3-SAT 公式，记为 $\\phi'$，由从 $m$ 个配对生成的所有 $2m$ 个子句集合而成。假设一个给定的 `#PNE` 实例有 $m$ 个配对，并且已知有 $N_{PNE}$ 个满足条件的赋值。确定相应的转换后公式 $\\phi'$ 的 NAE-满足赋值的总数。用包含 $N_{PNE}$ 和 $m$ 的解析表达式表示你的答案。",
            "solution": "设原始 #PNE 实例包含变量 $x_{1},\\dots,x_{n}$ 和 $m$ 个指定的配对。对 $x$ 变量的真值赋值对于 #PNE 是有效的，当且仅当对于每个指定的配对 $(x_{i},x_{j})$，我们有 $x_{i} \\neq x_{j}$。设此类赋值的数量为 $N_{PNE}$。\n\n对于由 $k \\in \\{1,\\dots,m\\}$ 索引的每个配对，转换引入一个辅助变量 $a_{k}$ 和两个 NAE-3-SAT 子句：\n$$\nC_{k}^{+}:(x_{i},x_{j},a_{k}), \\quad C_{k}^{-}:(x_{i},x_{j},\\neg a_{k}).\n$$\n回顾一下，一个包含三个文字的 NAE 子句被满足，当且仅当这三个文字不都具有相同的真值，等价地，当且仅当它们中至少有一个为真且至少有一个为假。\n\n固定对 $x$ 变量的任意赋值 $\\mathbf{x}$，并分析满足所有子句的对 $(a_{1},\\dots,a_{m})$ 的扩展数量。\n\n1) 如果对于给定的配对 $k$，在赋值 $\\mathbf{x}$ 下我们有 $x_{i} \\neq x_{j}$，那么在文字 $(x_{i},x_{j},a_{k})$ 中，已经有一个来自 $x_{i}$ 和 $x_{j}$ 的真值和一个假值。因此，对于 $a_{k}=0$ 和 $a_{k}=1$ 这两种情况，$C_{k}^{+}$ 都被满足。同样的推理也适用于 $C_{k}^{-}$，因为用 $\\neg a_{k}$ 替换 $a_{k}$ 并不会改变 $x_{i}$ 和 $x_{j}$ 已经同时体现了两种真值这一事实。因此，当 $x_{i} \\neq x_{j}$ 时，对于 $a_{k}$ 的两个值，子句 $C_{k}^{+}$ 和 $C_{k}^{-}$ 都被满足，从而为 $a_{k}$ 提供了恰好 $2$ 个有效选择。\n\n2) 如果对于给定的配对 $k$，在赋值 $\\mathbf{x}$ 下我们有 $x_{i}=x_{j}=v \\in \\{0,1\\}$，那么 $C_{k}^{+}$ 被 NAE-满足当且仅当 $a_{k} \\neq v$，而 $C_{k}^{-}$ 被 NAE-满足当且仅当 $\\neg a_{k} \\neq v$，即 $a_{k}=v$。这两个条件是矛盾的，因此不存在能同时满足 $C_{k}^{+}$ 和 $C_{k}^{-}$ 的 $a_{k}$ 值。因此，当 $x_{i}=x_{j}$ 时，对于 $a_{k}$ 有 $0$ 个有效选择。\n\n因为每个小工具使用一个不同的辅助变量，所以不同配对之间的 $a_{k}$ 选择是独立的。因此，对于一个固定的 $\\mathbf{x}$：\n- 如果 $\\mathbf{x}$ 满足所有 $m$ 个不等式（即 $\\mathbf{x}$ 是一个 #PNE 解），那么对于每个 $a_{k}$ 都有 $2$ 个有效选择，从而得到 $2^{m}$ 个对 $(a_{1},\\dots,a_{m})$ 的扩展，这些扩展能 NAE-满足 $\\phi'$ 中的所有子句。\n- 如果 $\\mathbf{x}$ 违反了至少一个不等式，那么对于那个被违反的配对，其对应的 $a_{k}$ 有 $0$ 个有效选择，导致总共有 $0$ 个扩展。\n\n对所有赋值 $\\mathbf{x} \\in \\{0,1\\}^{n}$ 求和，$\\phi'$ 的 NAE-满足赋值的总数是\n$$\n\\sum_{\\mathbf{x}} \\left|\\left\\{\\mathbf{a} \\in \\{0,1\\}^{m} : (\\mathbf{x},\\mathbf{a}) \\text{ NAE-satisfies } \\phi' \\right\\}\\right| \\;=\\; N_{PNE} \\cdot 2^{m}.\n$$\n因此，转换后的公式 $\\phi'$ 恰好有 $N_{PNE} 2^{m}$ 个 NAE-满足赋值。",
            "answer": "$$\\boxed{N_{PNE}\\,2^{m}}$$"
        }
    ]
}