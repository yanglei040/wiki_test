{
    "hands_on_practices": [
        {
            "introduction": "费马素性检验是费马小定理一个优雅的应用，但它并非万无一失。有些合数可以“欺骗”这个检验，伪装成素数。这个练习将引导你找到一个这样的合数（即费马伪素数），从而揭示该检验的关键弱点。理解这种失效是认识更复杂算法重要性的第一步。",
            "id": "1441645",
            "problem": "费马素性检验是一种判断一个数是否可能为素数的概率性方法。对于一个给定的待检验整数 $n > 2$，选择一个整数 $a$（称为底数），使其满足 $1  a  n-1$。根据费马小定理，如果 $n$ 是一个素数，那么 $a^{n-1} \\equiv 1 \\pmod{n}$。\n\n该检验的流程如下：如果 $a^{n-1} \\not\\equiv 1 \\pmod{n}$，那么 $n$ 必定是合数。然而，如果 $a^{n-1} \\equiv 1 \\pmod{n}$，数 $n$ 就被称为以 $a$ 为底的“可能素数”。虽然所有素数对于任何有效的底数 $a$ 都能通过此检验，但有些合数在某些底数下也满足该同余式。这些合数被称为费马伪素数，它们是该检验的“假阳性”结果。\n\n你的任务是找到最小的奇合数 $n$，该数是一个以 $a=2$ 为底的费马伪素数。",
            "solution": "我们要寻找最小的奇合数 $n$，使得 $2^{n-1} \\equiv 1 \\pmod{n}$。这样的 $n$ 称为以 2 为底的费马伪素数。\n\n考虑 $n=341$。首先将 $341$ 分解为 $11 \\cdot 31$，其中 $\\gcd(2,341)=1$。根据费马小定理，对于素数 $p$，有 $2^{p-1} \\equiv 1 \\pmod{p}$，并且 2 模 $p$ 的乘法阶整除 $p-1$。\n\n计算如下：\n- 模 $11$：$2^{5}=32 \\equiv 10 \\equiv -1 \\pmod{11}$，因此 $2^{10} \\equiv 1 \\pmod{11}$。\n- 模 $31$：$2^{5}=32 \\equiv 1 \\pmod{31}$，因此特别地，$2^{10} \\equiv 1 \\pmod{31}$。\n\n因此 $2^{10} \\equiv 1 \\pmod{11}$ 且 $2^{10} \\equiv 1 \\pmod{31}$。由于 $11$ 和 $31$ 互素，根据中国剩余定理，可得\n$$\n2^{10} \\equiv 1 \\pmod{341}.\n$$\n将两边同时进行 $34$ 次幂运算，得到\n$$\n2^{340} = \\left(2^{10}\\right)^{34} \\equiv 1^{34} \\equiv 1 \\pmod{341}.\n$$\n因此，$341$ 是一个以 2 为底的费马伪素数。\n\n这是一个标准且公认的事实：$341$ 是具有此性质的最小奇合数（第一个以 2 为底的费马伪素数，也称为第一个 Poulet 数）。因此，满足 $2^{n-1} \\equiv 1 \\pmod{n}$ 的最小奇合数 $n$ 是 $341$。",
            "answer": "$$\\boxed{341}$$"
        },
        {
            "introduction": "米勒-拉宾检验通过施加更严格的条件改进了费马检验。它寻找的不是简单的“骗子”，而是能为合数性质提供“强证据”的“强证人”。这个动手练习将带你走过为一个简单合数寻找强证人的完整过程，从而让该算法的内在逻辑变得清晰具体。",
            "id": "1441673",
            "problem": "在计算数论领域，米勒-拉宾检验是一种广泛用于判断一个数是否为合数的概率性算法。该检验的一个关键概念是“强见证”。对于我们希望检验的奇数 $n > 2$，我们首先将 $n-1$ 写成 $2^k \\cdot m$ 的形式，其中 $m$ 是一个奇数且 $k \\ge 1$。\n\n一个满足 $1  a  n-1$ 的整数 $a$ 被定义为 $n$ 的合数性质的一个 **强见证**，如果满足以下两个条件：\n1. $a^m \\not\\equiv 1 \\pmod n$\n2. $a^{2^i \\cdot m} \\not\\equiv -1 \\pmod n$ 对于所有在 $0 \\le i  k$ 范围内的整数 $i$。\n\n如果找到了这样一个强见证 $a$，那么数字 $n$ 就被确定为合数。\n\n考虑一个场景，一个密码学系统的素性检验模块正在被验证。它被输入已知的合数 $n=57$。你的任务是进行一次手动检查，找出作为 $n=57$ 合数性质的强见证的最小整数 $a > 1$。",
            "solution": "给定 $n=57$，我们必须将 $n-1$ 写成 $2^k \\cdot m$ 的形式，其中 $m$ 是奇数。我们有 $n-1 = 56 = 8 \\times 7 = 2^3 \\cdot 7$。因此，$k=3$，$m=7$。\n\n我们寻找满足 $1  a  56$ 的最小整数 $a$，使其成为 $n=57$ 的合数性质的强见证。让我们从 $a=2$ 开始测试。\n\n1.  计算 $a^m \\pmod n$：\n    $2^7 = 128$。\n    $128 \\pmod{57}$。因为 $128 = 2 \\times 57 + 14$，所以 $2^7 \\equiv 14 \\pmod{57}$。\n    这个结果不等于 $1$。所以第一个条件满足。\n\n2.  检查序列 $a^{2^i \\cdot m} \\pmod n$ 对于 $i$ 从 $0$ 到 $k-1=2$ 是否等于 $-1 \\pmod{57}$。\n    -   对于 $i=0$：$2^{7} \\equiv 14 \\not\\equiv -1 \\pmod{57}$。\n    -   对于 $i=1$：$2^{14} = (2^7)^2 \\equiv 14^2 = 196 \\pmod{57}$。因为 $196 = 3 \\times 57 + 25$，所以 $2^{14} \\equiv 25 \\not\\equiv -1 \\pmod{57}$。\n    -   对于 $i=2$：$2^{28} = (2^{14})^2 \\equiv 25^2 = 625 \\pmod{57}$。因为 $625 = 10 \\times 57 + 55$，所以 $2^{28} \\equiv 55 \\equiv -2 \\pmod{57}$。这仍然不等于 $-1 \\pmod{57}$。\n\n由于 $a^m \\not\\equiv 1 \\pmod n$ 并且对于所有 $0 \\le i  3$，都有 $a^{2^i \\cdot m} \\not\\equiv -1 \\pmod n$，因此 $a=2$ 是 $n=57$ 的合数性质的一个强见证。\n\n由于我们从最小的整数 $a > 1$ 开始测试，所以 $2$ 就是所求的答案。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "一些被称为卡迈克尔数的合数尤其具有欺骗性，它们对所有可能的底数都能通过费马检验，是终极的“骗子”。这个练习将展示米勒-拉宾检验的强大之处，通过它成功地将最小的卡迈克尔数 $n=561$ 识别为合数，而这正是费马检验完全无能为力的任务。",
            "id": "1441663",
            "problem": "在计算数论的研究中，米勒-拉宾测试是一种广泛使用的概率性算法，用于判断一个给定的数是否为素数。它改进了像费马素性检验这样更简单的方法，后者可能会被被称为卡迈克尔数的合数所欺骗。\n\n对一个奇整数 $n > 2$ 进行检验时，首先需要找到整数 $k$ 和 $d$，使得 $d$ 是奇数且 $n-1 = 2^k d$。然后，在范围 $1  a  n-1$ 内选择一个随机的基 $a$。该检验基于以下模幂运算序列：\n$x_0 = a^d \\pmod{n}$\n$x_1 = (x_0)^2 \\pmod{n} = a^{2d} \\pmod{n}$\n$x_2 = (x_1)^2 \\pmod{n} = a^{4d} \\pmod{n}$\n...\n$x_{k-1} = (x_{k-2})^2 \\pmod{n} = a^{2^{k-1}d} \\pmod{n}$\n\n考虑数 $n=561$，它是最小的 Carmichael 数。为了看看米勒-拉宾测试如何揭示其合数性质，我们可以执行初始步骤。\n\n使用基 $a=2$，确定米勒-拉宾检验序列中的第一项 $x_0$ 的值。",
            "solution": "对于米勒-拉宾测试的设置，将 $n-1$ 写成 $2^k d$ 的形式，其中 $d$ 为奇数。对于 $n=561$，\n$$\n561-1=560=2\\cdot 280=2^{2}\\cdot 140=2^{3}\\cdot 70=2^{4}\\cdot 35,\n$$\n所以 $k=4$ 且 $d=35$。对于基 $a=2$，第一项是\n$$\nx_{0}\\equiv 2^{d}\\equiv 2^{35}\\pmod{561}.\n$$\n使用中国剩余定理计算 $2^{35}\\pmod{561}$。将 $561=3\\cdot 11\\cdot 17$ 分解，并对每个因子取模：\n- 模 $3$：$2\\equiv -1\\pmod{3}$，因此 $2^{35}\\equiv (-1)^{35}\\equiv -1\\equiv 2\\pmod{3}$。\n- 模 $11$：根据费马小定理，$2^{10}\\equiv 1\\pmod{11}$，所以 $2^{35}\\equiv 2^{5}\\equiv 32\\equiv 10\\pmod{11}$。\n- 模 $17$：使用 $2^{16}\\equiv 1\\pmod{17}$，我们得到 $2^{35}\\equiv 2^{32}\\cdot 2^{3}\\equiv 1\\cdot 8\\equiv 8\\pmod{17}$。\n\n因此 $x_0$ 必须满足\n$$\nx_0\\equiv 2\\pmod{3},\\quad x_0\\equiv 10\\pmod{11},\\quad x_0\\equiv 8\\pmod{17}.\n$$\n通过设 $x_0=10+11t$ 并对模 $3$ 进行化简，来合并 $x_0\\equiv 10\\pmod{11}$ 和 $x_0\\equiv 2\\pmod{3}$：\n$$\n10+11t\\equiv 1+2t\\equiv 2\\pmod{3}\\;\\Rightarrow\\;2t\\equiv 1\\pmod{3}\\;\\Rightarrow\\;t\\equiv 2\\pmod{3}.\n$$\n令 $t=2+3s$，得到 $x_0=10+11(2+3s)=32+33s$，即 $x_0\\equiv 32\\pmod{33}$。现在应用条件 $x_0\\equiv 8\\pmod{17}$：\n$$\n32+33s\\equiv 8\\pmod{17},\\quad 32\\equiv 15,\\;33\\equiv -1\\pmod{17}\\;\\Rightarrow\\;15-s\\equiv 8\\pmod{17}\\;\\Rightarrow\\;s\\equiv 7\\pmod{17}.\n$$\n取 $s=7$ 得到最小正数解\n$$\nx_0=32+33\\cdot 7=263,\n$$\n这就是模 $561$ 所求的余数。因此，\n$$\nx_{0}\\equiv 2^{35}\\equiv 263\\pmod{561}.\n$$",
            "answer": "$$\\boxed{263}$$"
        }
    ]
}