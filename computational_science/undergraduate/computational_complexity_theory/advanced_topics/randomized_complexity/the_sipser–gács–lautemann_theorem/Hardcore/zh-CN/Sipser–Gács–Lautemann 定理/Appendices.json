{
    "hands_on_practices": [
        {
            "introduction": "要理解Sipser–Gács–Lautemann定理的精妙之处，一个有效的方法是先分析为何更简单的证明思路行不通。许多人最初的直觉可能会尝试将BPP直接归入NP。这个练习  就提出了这样一个看似合理的论证，但其中却隐藏着一个根本性的缺陷。通过识别这个缺陷，你将能更深刻地体会到为何证明BPP ⊆ Σ₂ᵖ需要一个更为复杂的构造，并为理解SGL定理的证明机制奠定基础。",
            "id": "1462894",
            "problem": "在计算复杂性理论中，一个核心问题是不同复杂性类之间如何相互关联。考虑类 $\\text{BPP}$，它代表“有界错误概率多项式时间”（Bounded-error Probabilistic Polynomial-time）。如果存在一个概率图灵机 $M$ 和一个多项式 $p(n)$，使得对于任何长度为 $n$ 的输入字符串 $x$，以下条件成立，则语言 $L$ 属于 $\\text{BPP}$：\n- 如果 $x \\in L$，那么 $\\Pr_{r}[M(x,r) \\text{ 接受}] \\ge \\frac{2}{3}$。\n- 如果 $x \\notin L$，那么 $\\Pr_{r}[M(x,r) \\text{ 接受}] \\le \\frac{1}{3}$。\n这里，$r$ 是一个长度为 $p(n)$ 的随机字符串，从所有可能的字符串中均匀随机选择。\n\n一名学生试图证明 $\\text{BPP}$ 是 $\\text{NP}$ 的子集，其中 $\\text{NP}$ 代表“非确定性多项式时间”（Nondeterministic Polynomial-time）。回顾一下，如果存在一个多项式时间的确定性验证机 $V$ 和一个多项式 $q(n)$，使得对于任何长度为 $n$ 的输入 $x$，以下条件成立，则语言 $L$ 属于 $\\text{NP}$：\n- 如果 $x \\in L$，存在一个长度为 $q(n)$ 的证书（或见证）$y$，使得 $V(x,y)$ 接受。\n- 如果 $x \\notin L$，对于所有长度为 $q(n)$ 的证书 $y$，$V(x,y)$ 拒绝。\n\n该学生提出了以下论证，为任何语言 $L \\in \\text{BPP}$ 构建一个 $\\text{NP}$ 算法。设 $M$ 是用于 $L$ 的概率图灵机，它使用长度为 $p(|x|)$ 的随机字符串 $r$。\n\n**提议的 NP 算法：**\n1.  **输入：** 一个实例 $x$。\n2.  **证书：** 证书 $y$ 是一个长度为 $p(|x|)$ 的单一字符串 $s$。\n3.  **验证机 $V(x, s)$：** 该验证机被设计用来检查位移 $s$ 是否能揭示 $x \\in L$ 的高接受概率。验证机 $V(x, s)$ 当且仅当以下条件成立时接受：\n    对于随机字符串 $r \\in \\{0,1\\}^{p(|x|)}$，使得谓词 $(M(x,r) \\text{ 接受}) \\lor (M(x,r \\oplus s) \\text{ 接受})$ 为真的比例，至少为 $\\frac{5}{6}$。（这里，$\\oplus$ 表示按位异或操作）。\n\n学生的直觉是，对于 $x \\in L$，接受概率很高，一个“好”的位移 $s$ 将覆盖大部分 $M(x,r)$ 最初失败的“不幸”随机字符串 $r$。对于 $x \\notin L$，接受概率很低，没有任何单个位移 $s$ 能够将组合接受率提升到如此之高。\n\n尽管有此直觉，学生的论证中包含一个根本性缺陷，使其成为一个无效的 $\\text{BPP} \\subseteq \\text{NP}$ 证明。下列哪个陈述正确地指出了这个主要缺陷？\n\nA. 证书 $s$ 的长度是 $p(|x|)$，这可能比 $|x|$ 大指数级倍。\n\nB. 对于输入 $x \\in L$，不保证存在满足验证机条件的证书 $s$。\n\nC. 对于输入 $x \\notin L$，可能存在一个证书 $s$ 会导致验证机错误地接受。\n\nD. 提议的验证机 $V(x, s)$ 不能被实现为一个确定性多项式时间图灵机。\n\nE. 按位异或操作 $r \\oplus s$ 不会产生一个均匀随机的字符串，从而破坏了概率图灵机 $M$ 的逻辑。",
            "solution": "设 $M$ 是用于 $L$ 的 $\\text{BPP}$ 机器，使用 $m=p(|x|)$ 个随机比特，并定义集合\n$$\nA \\subseteq \\{0,1\\}^{m}, \\quad A := \\{r \\in \\{0,1\\}^{m} : M(x,r) \\text{ 接受}\\}.\n$$\n那么 $\\text{BPP}$ 的保证是\n$$\nx \\in L \\Rightarrow \\frac{|A|}{2^{m}} \\ge \\frac{2}{3}, \\qquad x \\notin L \\Rightarrow \\frac{|A|}{2^{m}} \\le \\frac{1}{3}.\n$$\n给定一个证书 $s \\in \\{0,1\\}^{m}$，提议的验证机 $V(x,s)$ 接受当且仅当\n$$\n\\frac{|A \\cup (A \\oplus s)|}{2^{m}} \\ge \\frac{5}{6},\n$$\n其中 $A \\oplus s := \\{r \\in \\{0,1\\}^{m} : r \\oplus s \\in A\\}$。注意 $|A \\oplus s|=|A|$ 并且\n$$\n|A \\cup (A \\oplus s)| = 2|A| - |A \\cap (A \\oplus s)|.\n$$\n\n首先，对于 $x \\notin L$ 的可靠性（soundness）不是主要问题。如果 $x \\notin L$，那么 $|A| \\le \\frac{1}{3}2^{m}$，因此对于任何 $s$，\n$$\n|A \\cup (A \\oplus s)| \\le |A| + |A \\oplus s| = 2|A| \\le \\frac{2}{3} 2^{m}  \\frac{5}{6} 2^{m},\n$$\n所以没有 $s$ 能导致接受。因此选项 C 不是缺陷。\n\n其次，对于 $x \\in L$ 的完备性（completeness）似乎是满足的。如果 $\\frac{|A|}{2^{m}} = a \\ge \\frac{2}{3}$，那么对于均匀随机的 $s$，\n$$\n\\mathbb{E}_{s}\\bigl[|A \\cap (A \\oplus s)|\\bigr] = \\frac{|A|^{2}}{2^{m}},\n$$\n所以\n$$\n\\mathbb{E}_{s}\\bigl[|A \\cup (A \\oplus s)|\\bigr] = 2|A| - \\frac{|A|^{2}}{2^{m}} = \\bigl(2a - a^{2}\\bigr)2^{m}.\n$$\n当 $a=\\frac{2}{3}$ 时，$2a - a^{2} = \\frac{8}{9} \\ge \\frac{5}{6}$，所以存在某个 $s$ 使得 $\\frac{|A \\cup (A \\oplus s)|}{2^{m}} \\ge \\frac{5}{6}$。因此选项 B 不是缺陷。\n\n第三，证书长度 $|s|=m=p(|x|)$ 是 $|x|$ 的多项式，所以选项 A 不是缺陷。\n\n第四，操作 $r \\mapsto r \\oplus s$ 是 $\\{0,1\\}^{m}$ 上的一个双射，如果 $r$ 是均匀的，那么 $r \\oplus s$ 也是均匀的，所以选项 E 不是缺陷。\n\n核心问题是验证机的可实现性。条件\n$$\n\\frac{|A \\cup (A \\oplus s)|}{2^{m}} \\ge \\frac{5}{6}\n$$\n要求确定由运行 $M(x,\\cdot)$ 隐式给出的 $\\{0,1\\}^{m}$ 的两个子集之并集的大小。特别地，即使是 $s=0^{m}$ 的特殊情况也简化为检查\n$$\n\\frac{|A|}{2^{m}} \\ge \\frac{5}{6},\n$$\n即 $M$ 对 $x$ 的接受概率是否至少为 $\\frac{5}{6}$。对于多项式时间机器，判定这类阈值接受概率是一个典型的 $\\text{PP}$-完全问题，并且通常需要对 $2^{m}$ 种可能性进行计数；目前没有已知的确定性多项式时间过程来执行这种精确验证。因此，所提议的验证机不能是 $\\text{NP}$ 所要求的确定性多项式时间图灵机。\n\n因此，主要缺陷是验证机不能在确定性多项式时间内实现，这对应于选项 D。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "在揭示了将BPP归入NP的朴素尝试为何失败之后 ，我们转向Sipser–Gács–Lautemann证明中真正核心的洞见：覆盖引理（covering lemma）。这个引理巧妙地运用概率方法，证明了可以用一小组“移位串”来“覆盖”整个随机串空间。这个练习  将让你亲手实践这一关键思想，通过计算来建立放大后的错误概率与所需移位串数量之间的直接联系，从而量化理解SGL定理的威力所在。",
            "id": "1462936",
            "problem": "考虑一个由一个放大的概率多项式时间（PPT）算法判定的语言 $L$。该算法由一台确定性图灵机 $M$ 实现，它接受两个输入：一个长度为 $n$ 的主输入字符串 $x$，以及一个长度为 $m(n)$ 的随机比特串 $r$，其中 $m(n)$ 是 $n$ 的一个多项式。\n\n如果对于任何输入 $x$，$M(x, r)$ 对 $x$ 是否属于 $L$ 给出错误答案的概率（在均匀选择的随机字符串 $r$ 上）不超过 $\\epsilon$（其中 $\\epsilon  1/2$），则称该算法的错误概率至多为 $\\epsilon$。\n\n对于一个输入 $x \\in L$，令 $A_x$ 为“接受”随机字符串的集合，即 $A_x = \\{r \\in \\{0,1\\}^{m(n)} \\mid M(x, r) = 1\\}$。正确成员判定的条件意味着这个集合的大小为 $|A_x| \\ge (1-\\epsilon)2^{m(n)}$。\n\nSipser–Gács–Lautemann 定理证明中的一个关键步骤是证明存在一个小的“移位串”集合，可用于测试 $L$ 中的成员资格。具体来说，对于输入 $x \\in L$，存在一个包含 $t$ 个字符串的集合 $S = \\{s_1, s_2, \\ldots, s_t\\}$，其中每个 $s_i \\in \\{0,1\\}^{m(n)}$，使得整个随机字符串空间 $\\{0,1\\}^{m(n)}$ 被接受集合 $A_x$ 的移位版本所覆盖。这个覆盖条件表示为：\n$$\n\\bigcup_{i=1}^{t} (A_x \\oplus s_i) = \\{0,1\\}^{m(n)}\n$$\n其中 $A_x \\oplus s_i = \\{ r \\oplus s_i \\mid r \\in A_x \\}$ 且 $\\oplus$ 表示按位异或运算。\n\n确定能够证明存在这样一个覆盖集 $S$ 的最小整数值 $t$。请用 $m(n)$ 和 $\\epsilon$ 的闭式解析表达式表示你的答案。",
            "solution": "令 $m = m(n)$ 并固定 $x \\in L$。定义 $A_{x} \\subseteq \\{0,1\\}^{m}$ 且 $|A_{x}| \\ge (1-\\epsilon)2^{m}$。对于任意固定的 $y \\in \\{0,1\\}^{m}$ 和一个均匀随机的移位 $s \\in \\{0,1\\}^{m}$，我们有\n$$\ny \\in A_{x} \\oplus s \\iff s \\in y \\oplus A_{x},\n$$\n且 $|y \\oplus A_{x}| = |A_{x}|$。因此\n$$\n\\Pr_{s}\\big[y \\in A_{x} \\oplus s\\big] = \\frac{|A_{x}|}{2^{m}} \\ge 1 - \\epsilon,\n$$\n所以\n$$\n\\Pr_{s}\\big[y \\notin A_{x} \\oplus s\\big] \\le \\epsilon.\n$$\n现在取 $t$ 个独立的、均匀随机的移位 $s_{1},\\dots,s_{t}$。根据独立性，\n$$\n\\Pr\\big[y \\notin \\bigcup_{i=1}^{t} (A_{x} \\oplus s_{i})\\big] \\le \\epsilon^{t}.\n$$\n通过对所有 $y \\in \\{0,1\\}^{m}$ 应用并集界，\n$$\n\\Pr\\Big[\\exists\\, y \\in \\{0,1\\}^{m} \\text{ 未被覆盖}\\Big] \\le 2^{m}\\epsilon^{t}.\n$$\n因此，如果\n$$\n2^{m}\\epsilon^{t}  1,\n$$\n那么存在一个移位集合 $S = \\{s_{1},\\dots,s_{t}\\}$ 的选择，使得\n$$\n\\bigcup_{i=1}^{t} (A_{x} \\oplus s_{i}) = \\{0,1\\}^{m}.\n$$\n求解 $2^{m}\\epsilon^{t}  1$ 可得\n$$\n\\epsilon^{t}  2^{-m}\n\\iff t \\ln \\epsilon  - m \\ln 2\n\\iff t > \\frac{m \\ln 2}{\\ln(1/\\epsilon)}\n\\iff t > \\frac{m}{\\log_{2}(1/\\epsilon)}.\n$$\n因此，通过此论证保证存在的最小整数 $t$ 是\n$$\nt^{*} = \\left\\lfloor \\frac{m(n)}{\\log_{2}(1/\\epsilon)} \\right\\rfloor + 1.\n$$\n这就得到了所声称的覆盖集大小，表示为关于 $m(n)$ 和 $\\epsilon$ 的闭式表达式。",
            "answer": "$$\\boxed{\\left\\lfloor \\frac{m(n)}{\\log_{2}(1/\\epsilon)} \\right\\rfloor + 1}$$"
        },
        {
            "introduction": "现在，你已经理解了简单证明的局限性 ，并掌握了SGL证明中关键的覆盖引理 ，是时候将所有部分组装起来了。这个练习  要求你完成最后一步：构建一个将任意BPP语言置于$Σ_2^p$类中的完整逻辑谓词。通过将误差放大（amplification）和移位覆盖（shifting）等抽象概念转化为一个具体的、可在多项式时间内验证的公式，你将对整个SGL定理的证明框架有一个坚实而全面的把握。",
            "id": "1462919",
            "problem": "设 $L$ 是一个属于复杂度类 $\\mathsf{BPP}$ (有界错误概率多项式时间) 的语言。根据定义，存在一个确定性多项式时间图灵机 $M(x, r)$，它接受一个长度为 $n=|x|$ 的输入字符串 $x$ 和一个随机字符串 $r$。对于本问题，假设随机字符串 $r$ 的长度由多项式 $p(n) = n^3$ 给出。机器 $M$ 遵循以下概率保证：\n- 如果 $x \\in L$，则 $M(x, r)$ 输出 1 的概率至少为 $3/4$：$\\Pr_{r \\in \\{0,1\\}^{n^3}}[M(x, r) = 1] \\ge \\frac{3}{4}$。\n- 如果 $x \\notin L$，则 $M(x, r)$ 输出 1 的概率至多为 $1/4$：$\\Pr_{r \\in \\{0,1\\}^{n^3}}[M(x, r) = 1] \\le \\frac{1}{4}$。\n\nSipser–Gács–Lautemann 定理表明 $\\mathsf{BPP} \\subseteq \\Sigma_2^P$。其证明依赖于为语言 $L$ 的成员资格构造一个 $\\Sigma_2^P$ 表达式。这个构造始于一个**放大** (amplification) 步骤，以创建一个新的概率机 $M'$，其错误概率要小得多。我们定义 $M'$ 的操作方式为：对 $M(x, \\cdot)$ 运行 $k=6n$ 次独立试验，并在大多数试验接受时接受。用于 $M'$ 的总随机字符串（记为 $R$）是试验中使用的 $k$ 个独立随机字符串的串联。\n\n放大之后，使用一个**覆盖论证** (covering argument) 将 $L$ 的判定问题形式化为所需的 $\\Sigma_2^P$ 形式：\n$$x \\in L \\iff \\exists s_1, \\dots, s_q \\in \\{0,1\\}^m \\ \\forall r \\in \\{0,1\\}^m : V(x, s_1, \\dots, s_q, r)$$\n此处，$m$ 是放大后机器 $M'$ 的随机字符串 $R$ 的总长度，$q$ 是所选“移位” (shift) 字符串的数量。为了本问题的目的，$q$ 被定义为严格大于 $m/n$ 的最小整数。谓词 $V$ 必须在关于 $n$ 的多项式时间内可计算。\n\n你的任务是推导并写出多项式时间谓词 $V(x, s_1, \\dots, s_q, r)$ 的显式逻辑公式。你必须首先确定参数 $m$ 和 $q$ 作为 $n$ 的函数。$V$ 的最终表达式应使用基础机器 $M$、输入 $x$、移位字符串 $s_1, \\dots, s_q$ 和全称量化的字符串 $r$ 来表示。为使你的答案清晰，令 $(S)_j$ 表示字符串 $S$ 的第 $j$ 个长度为 $n^3$ 的子串。",
            "solution": "我们从给定的基础机器 $M(x,r)$ 开始，它使用 $p(n)=n^{3}$ 个随机比特。放大后的机器 $M'$ 运行 $k=6n$ 次独立试验并按多数决定是否接受。每次试验使用一个新的长度为 $n^{3}$ 的块，因此如果我们将 $k$ 个随机块串联成一个单一的字符串 $R$，则 $M'$ 使用的总随机长度为\n$$\nm \\;=\\; k \\cdot n^{3} \\;=\\; 6n \\cdot n^{3} \\;=\\; 6n^{4}.\n$$\n\n根据问题的定义，移位字符串的数量 $q$ 是严格大于 $m/n$ 的最小整数。由于 $m/n = 6n^{4}/n = 6n^{3}$ 是一个整数，我们得到\n$$\nq \\;=\\; 6n^{3} + 1.\n$$\n\n定义 $M'(x,R)$ 的操作为：在 $R$ 的 $k=6n$ 个长度为 $n^{3}$ 的块上独立运行 $M$，并在严格多数的试验接受时接受。使用提供的块表示法，这表示为\n$$\nM'(x,R)=1 \\;\\;\\iff\\;\\; \\sum_{j=1}^{6n} M\\bigl(x,(R)_{j}\\bigr) \\;\\; 3n.\n$$\n\nSipser–Gács–Lautemann 覆盖步骤断言，存在 $q$ 个移位 $s_{1},\\dots,s_{q}\\in\\{0,1\\}^{m}$，使得对于所有的 $r\\in\\{0,1\\}^{m}$，当 $x\\in L$ 时，至少有一个移位后的随机性 $(r\\oplus s_{i})$ 使 $M'$ 接受，而当 $x\\notin L$ 时，鉴于放大后的小接受概率，不存在这样的移位族能够成立。这就产生了 $\\Sigma_{2}^{P}$ 形式\n$$\nx\\in L \\iff \\exists s_{1},\\dots,s_{q}\\in\\{0,1\\}^{m}\\;\\forall r\\in\\{0,1\\}^{m}:\\;V(x,s_{1},\\dots,s_{q},r),\n$$\n其中多项式时间谓词 $V$ 正是关于 $q$ 个移位的析取，表示 $M'$ 在移位后的随机性上接受。将 $M'$ 用 $M$ 展开，并使用块表示法 $(S)_{j}$ 表示第 $j$ 个长度为 $n^{3}$ 的子串，我们得到显式公式\n$$\nV(x,s_{1},\\dots,s_{q},r)\n\\;\\equiv\\;\n\\bigvee_{i=1}^{q}\\left[\\;\\sum_{j=1}^{6n} M\\bigl(x,\\,(r\\oplus s_{i})_{j}\\bigr) \\;\\; 3n\\;\\right].\n$$\n这个谓词在关于 $n$ 的多项式时间内是可计算的，因为它执行了 $q\\cdot(6n)=\\Theta(n^{4})$ 次 $M$ 的求值（每次都是多项式时间），外加多项式时间的按位 $\\oplus$ 运算和计数，并且我们有符合要求的 $m=6n^{4}$ 和 $q=6n^{3}+1$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n6 n^{4}  6 n^{3} + 1  \\displaystyle \\bigvee_{i=1}^{6 n^{3}+1}\\left[\\;\\sum_{j=1}^{6 n} M\\bigl(x,\\,(r \\oplus s_{i})_{j}\\bigr)  3 n\\;\\right]\n\\end{pmatrix}}$$"
        }
    ]
}