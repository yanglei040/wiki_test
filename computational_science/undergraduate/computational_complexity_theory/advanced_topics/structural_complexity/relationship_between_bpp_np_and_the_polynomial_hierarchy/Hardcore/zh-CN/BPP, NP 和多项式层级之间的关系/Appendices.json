{
    "hands_on_practices": [
        {
            "introduction": "理论的坚实始于其定义的稳健性。本练习旨在探讨 BPP (有界错误概率多项式时间) 定义的内在强度。通过分析一个假设情景，即错误概率的优势从一个常数缩减为多项式分之一，我们能够深入理解概率放大（probability amplification）这一核心技术的力量，并揭示为何 BPP 的定义如此强大而富有弹性 。",
            "id": "1444372",
            "problem": "在计算复杂性理论中，BPP类（代表“有界错误概率多项式时间”，Bounded-error Probabilistic Polynomial time）被定义为这样一类判定问题：它们可以由一台概率图灵机在多项式时间内解决，且错误概率被一个严格小于1/2的常数所限制。形式上，一个语言 $L$ 属于BPP，如果存在一个概率多项式时间图灵机 $M$ 和一个常数 $\\epsilon$（满足 $0 \\le \\epsilon  1/2$），使得对于所有输入 $x$：\n- 如果 $x \\in L$，则 $P(M(x) \\text{ accepts}) \\geq 1 - \\epsilon$。\n- 如果 $x \\notin L$，则 $P(M(x) \\text{ accepts}) \\leq \\epsilon$。\n通常，$\\epsilon$ 被选择为 $1/3$。\n\n考虑一个修改后的复杂性类，我们称之为 $BPP_{weak}$，其中错误概率不是由一个常数限制，而是由一个多项式接近于 $1/2$ 的值限制。具体来说，一个语言 $L$ 属于 $BPP_{weak}$，如果存在一个概率多项式时间图灵机 $M$ 和一个多项式 $p(n)$，使得对于任何长度为 $n$ 的输入 $x$：\n- 如果 $x \\in L$，则 $P(M(x) \\text{ accepts}) \\geq \\frac{1}{2} + \\frac{1}{p(n)}$。\n- 如果 $x \\notin L$，则 $P(M(x) \\text{ accepts}) \\leq \\frac{1}{2} - \\frac{1}{p(n)}$。\n\n给定其他复杂性类（如NP（非确定性多项式时间）、PP（概率多项式时间，其中错误率仅小于1/2）和PH（多项式层级））的标准定义，以下哪个陈述正确地描述了 $BPP_{weak}$ 类？\n\nA. $BPP_{weak} = P$\n\nB. $BPP_{weak} = BPP$\n\nC. $BPP_{weak} = NP$\n\nD. $BPP_{weak} = PP$\n\nE. $BPP_{weak}$ 包含整个多项式层级 (PH)。",
            "solution": "我们首先重述这两个类的定义。在 $BPP$ 中，存在一个概率多项式时间图灵机 $M$ 和一个常数 $\\epsilon$（满足 $0 \\le \\epsilon  \\frac{1}{2}$），使得对于所有 $x$：\n- 如果 $x \\in L$，则 $P(M(x)\\ \\text{accepts}) \\geq 1 - \\epsilon$。\n- 如果 $x \\notin L$，则 $P(M(x)\\ \\text{accepts}) \\leq \\epsilon$。\n\n在 $BPP_{weak}$ 中，存在一个概率多项式时间图灵机 $M$ 和一个多项式 $p(n)$，使得对于所有 $|x|=n$ 的 $x$：\n- 如果 $x \\in L$，则 $P(M(x)\\ \\text{accepts}) \\geq \\frac{1}{2} + \\frac{1}{p(n)}$。\n- 如果 $x \\notin L$，则 $P(M(x)\\ \\text{accepts}) \\leq \\frac{1}{2} - \\frac{1}{p(n)}$。\n\n我们将通过证明两个方向的包含关系来证明 $BPP_{weak} = BPP$。\n\n1) $BPP \\subseteq BPP_{weak}$:\n假设 $L \\in BPP$。那么存在一个在多项式时间内运行的 $M$，其错误率最多为 $\\epsilon$，其中 $0 \\le \\epsilon  \\frac{1}{2}$。令 $\\delta = \\frac{1}{2} - \\epsilon$，它满足 $\\delta  0$ 并且是一个与 $n$ 无关的常数。对于 $x \\in L$，我们有\n$$\nP(M(x)\\ \\text{accepts}) \\geq 1 - \\epsilon = \\frac{1}{2} + \\delta,\n$$\n对于 $x \\notin L$，\n$$\nP(M(x)\\ \\text{accepts}) \\leq \\epsilon = \\frac{1}{2} - \\delta.\n$$\n选择多项式 $p(n) \\equiv \\frac{1}{\\delta}$（一个常数多项式）。那么 $\\frac{1}{p(n)} = \\delta$，并且 $BPP_{weak}$ 的条件得到满足。因此 $L \\in BPP_{weak}$，证明了 $BPP \\subseteq BPP_{weak}$。\n\n2) $BPP_{weak} \\subseteq BPP$:\n假设 $L \\in BPP_{weak}$。那么存在一个概率多项式时间图灵机 $M$ 和一个多项式 $p(n)$，使得对于 $|x|=n$，\n- 如果 $x \\in L$，则 $P(M(x)\\ \\text{accepts}) \\geq \\frac{1}{2} + \\frac{1}{p(n)}$。\n- 如果 $x \\notin L$，则 $P(M(x)\\ \\text{accepts}) \\leq \\frac{1}{2} - \\frac{1}{p(n)}$。\n\n定义 $\\delta(n) = \\frac{1}{p(n)}$。考虑一台新机器 $M'$，它在输入长度为 $n$ 的 $x$ 时，独立运行 $M(x)$ 共 $t$ 次（每次使用新的随机比特），并输出这 $t$ 次结果的多数票。我们选择 $t$ 为 $n$ 的一个多项式；具体来说，我们设置\n$$\nt(n) = \\left\\lceil \\frac{\\ln 3}{2}\\, p(n)^{2} \\right\\rceil.\n$$\n令 $X_{1},\\dots,X_{t}$ 为 $M$ 的 $t$ 次运行的指示随机变量，其中如果第 $i$ 次运行接受，则 $X_{i}=1$，否则 $X_{i}=0$。令 $S = \\sum_{i=1}^{t} X_{i}$。\n\n对于 $x \\in L$，我们有 $\\mathbb{E}[X_{i}] \\geq \\frac{1}{2} + \\delta(n)$，所以 $\\mathbb{E}[S] \\geq t\\left(\\frac{1}{2} + \\delta(n)\\right)$。$M'$ 在一个“是”实例（yes-instance）上出错的事件是 $\\{S \\leq t/2\\}$。根据 Hoeffding 不等式的加法形式（一种 Chernoff 界），对于独立的 $X_{i} \\in \\{0,1\\}$，\n$$\nP\\left(S - \\mathbb{E}[S] \\leq -\\delta(n)\\, t\\right) \\leq \\exp\\!\\left(-\\frac{2\\, \\delta(n)^{2}\\, t^{2}}{t}\\right) = \\exp\\!\\left(-2\\, \\delta(n)^{2}\\, t\\right).\n$$\n因此\n$$\nP(M'(x)\\ \\text{errs on } x \\in L) \\leq \\exp\\!\\left(-2\\, \\delta(n)^{2}\\, t\\right).\n$$\n代入 $\\delta(n) = \\frac{1}{p(n)}$ 和 $t = \\left\\lceil \\frac{\\ln 3}{2}\\, p(n)^{2} \\right\\rceil$，我们得到\n$$\n\\exp\\!\\left(-2\\, \\delta(n)^{2}\\, t\\right) \\leq \\exp\\!\\left(-2 \\cdot \\frac{1}{p(n)^{2}} \\cdot \\frac{\\ln 3}{2}\\, p(n)^{2}\\right) = \\exp(-\\ln 3) = \\frac{1}{3}.\n$$\n因此对于 $x \\in L$，$P(M'(x)\\ \\text{accepts}) \\geq \\frac{2}{3}$。\n\n一个对称的论证适用于 $x \\notin L$ 的情况，此时 $\\mathbb{E}[X_{i}] \\leq \\frac{1}{2} - \\delta(n)$；错误事件是 $\\{S \\geq t/2\\}$，并且同样的上界可以得出\n$$\nP(M'(x)\\ \\text{errs on } x \\notin L) \\leq \\frac{1}{3},\n$$\n所以 $P(M'(x)\\ \\text{accepts}) \\leq \\frac{1}{3}$。\n\n因此，$M'$ 是一个判定语言 $L$ 的概率多项式时间机器，其双边错误率最多为 $\\frac{1}{3}$，即 $L \\in BPP$。由于 $p(n)$ 是一个多项式，所以 $t(n)$ 也是一个多项式，并且 $M'$ 在多项式时间内运行。\n\n结合两个方向的包含关系，我们得出结论 $BPP_{weak} = BPP$。\n\n在给定的选项中，这对应于选项B，而其他选项通常不成立。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在掌握了概率算法的基础之上，本练习将引导我们探讨一个在实践中常见的陷阱。我们将研究为何在处理 NP 问题时非常有效的自规约（self-reducibility）方法，在与一个标准的 BPP 预言机（oracle）直接结合时会失效。通过这个思想实验，你将揭示概率算法在序列组合下的误差累积效应，这对理解和设计可靠的随机化算法至关重要 。",
            "id": "1444373",
            "problem": "在计算复杂性理论中，一种关联问题的搜索版本和判定版本的常用技术是*自归约性*。对于不确定性多项式时间（NP）类中的许多问题，例如布尔可满足性问题（SAT），一个判定问题（即“该公式是否可满足？”）的预言机可以用来解决搜索问题（即“找到一个可满足赋值”）。对于一个公式 $\\phi(x_1, x_2, \\ldots, x_n)$，我们可以将 $x_1$ 固定为 `false` 后查询关于 $\\phi$ 的预言机。如果得到的公式是可满足的，我们就将 $x_1$ 固定为 `false`；否则，我们将其固定为 `true`。对 $x_2, x_3, \\ldots, x_n$ 重复此过程，以构造一个完整的可满足赋值。\n\n现在，考虑一个假设的自归约判定问题 $L$，它属于复杂性类有界错误概率多项式时间（BPP）。如果存在一个概率算法，能在多项式时间内解决一个问题，且对任何输入的错误概率最多为 $1/3$，那么该问题就属于 BPP。因此，$L$ 的一个预言机就是这样一个概率算法，它提供一个“是”或“否”的答案，其正确的概率至少为 $2/3$。\n\n假设我们尝试使用相同的自归约策略来为 $L$ 的搜索版本寻找一个解。这涉及到对 BPP 预言机进行一系列 $n$ 次查询，以逐位确定解的 $n$ 个比特。\n\n以下哪个陈述为这种自归约过程的直接应用无法为搜索问题生成一个可靠算法提供了最准确和最根本的原因？\n\nA. BPP 问题的搜索空间结构不允许解被逐位增量构造。\n\nB. 根据定义，BPP 预言机不为“是”的答案提供证书或见证，而搜索到判定的归约从根本上要求在每一步都能验证这样的见证。\n\nC. 该过程需要多项式数量的顺序查询，而随着查询次数的增加，BPP 预言机对序列中的每一个查询都返回正确答案的概率会变得指数级小。\n\nD. BPP 中的错误是不对称的；“是”的答案比“否”的答案更可靠，这破坏了自归约以同等置信度对待两种预言机答案的逻辑。\n\nE. 因为普遍推测 BPP = P，所以任何 BPP 语言的搜索问题也必定在 P 中。因此，这样复杂的归约在计算上是多余且低效的。",
            "solution": "我们将自归约过程形式化，并量化当预言机仅具有 BPP 精度时的可靠性。\n\n设语言 $L$ 的判定预言机是一个 BPP 算法，它对任何输入返回正确的“是/否”答案的概率至少为 $p$，根据定义 $p \\geq \\frac{2}{3}$。标准的自归约进行 $n$ 次自适应查询来确定一个 $n$ 比特的解：在步骤 $i \\in \\{1,\\ldots,n\\}$，它通过查询一个受限实例上的预言机并信任返回的答案来固定第 $i$ 个比特。\n\n对于每个步骤 $i$，定义事件 $E_{i}$ 为“步骤 $i$ 中预言机对被查询的受限实例的回答是正确的”。对于每个 $i$，我们有\n$$\n\\Pr(E_{i}) \\geq p \\geq \\frac{2}{3}.\n$$\n为了输出一个正确的整体解，该过程需要所有 $n$ 个答案同时正确，即事件 $\\bigcap_{i=1}^{n} E_{i}$ 发生。如果在每一步都使用新的随机性来运行预言机，那么查询的正确性事件可以被视为在自适应选择的输入条件下是独立的。在这种使用新随机性的标准方式下，所有 $n$ 个答案都正确的概率满足\n$$\n\\Pr\\left(\\bigcap_{i=1}^{n} E_{i}\\right) \\;=\\; \\prod_{i=1}^{n} \\Pr(E_{i}) \\;\\geq\\; p^{n} \\;\\geq\\; \\left(\\frac{2}{3}\\right)^{n}.\n$$\n因此，当每个比特只使用一次查询时，对整个自归约成功概率的最佳保证至多是一个随 $n$ 指数衰减的界；更精确地说，保证的下界是 $\\left(\\frac{2}{3}\\right)^{n}$，它随 $n$ 呈指数级小。因此，这种直接应用是不可靠的：随着 $n$ 的增长，在整个序列中不犯任何错误的机会可能是指数级小的。\n\n等价地，考虑至少有一个步骤出错的失败概率。根据联合界，\n$$\n\\Pr\\left(\\bigcup_{i=1}^{n} \\overline{E_{i}}\\right) \\;\\leq\\; \\sum_{i=1}^{n} \\Pr(\\overline{E_{i}}) \\;\\leq\\; n \\left(1 - p\\right) \\;\\leq\\; \\frac{n}{3},\n$$\n所以成功的平凡下界 $1 - \\frac{n}{3}$ 在 $n$ 很大时变得没有意义。两种计算都表明，如果没有错误减少（放大），直接顺序使用 BPP 预言机得到的总成功概率不能可靠地保证不为零；在典型的独立情况下，它像 $\\left(\\frac{2}{3}\\right)^{n}$ 一样衰减。\n\n这指出了根本问题：每次查询的常数错误率会在一个多项式长度的序列上累积，除非我们进行放大，否则正确回答每个查询的概率会变得指数级小。因此，选项中最准确和最根本的原因是，常数错误判定的顺序组合使得全部正确的事件变得指数级不可能，这与选项 C 相对应。其他选项不是核心障碍：BPP 在“是/否”错误之间没有内在的不对称性（与 D 矛盾），搜索到判定的归约不需要 NP 风格的见证（与 B 矛盾），搜索空间的结构不是障碍（与 A 矛盾），关于 $\\mathrm{BPP}=\\mathrm{P}$ 的推测与这种直接归约的可靠性无关（与 E 矛盾）。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "在理解了概率计算的能力和局限之后，我们现在将其置于计算复杂性理论的宏大版图中。这个问题利用了一个具有指数级小错误率的 BPP 机器——我们知道这可以通过概率放大实现——来确定它在多项式时间层级 (Polynomial Hierarchy) 中的确切位置。这个练习不仅是对前面概念的应用，也直观地展示了著名的 Sipser-Gács-Lautemann 定理的精髓，即 BPP 被包含在多项式层级的第二层中 。",
            "id": "1444380",
            "problem": "在计算复杂性理论中，我们研究解决问题所需的资源。让我们考虑几个重要的复杂性类。BPP（有界错误概率多项式时间，Bounded-error Probabilistic Polynomial time）类包含那些可以在多项式时间内由一台概率图灵机判定的语言，其错误概率被一个小于1/2的常数所限制。NP（非确定性多项式时间，Nondeterministic Polynomial time）类包含那些对于“是”的答案，可以用一个给定的证书在多项式时间内验证的语言。多项式谱系（PH）是推广了 NP 的一个复杂性类的层次结构。该层次结构的第二层包括 $\\Sigma_2^P$ 和 $\\Pi_2^P$ 类。如果一个语言的成员资格可以由一个形式为 $\\exists y \\forall z, V(x,y,z)$ 的条件确定，其中 $V$ 是一个多项式时间验证机，那么该语言就在 $\\Sigma_2^P$ 中。如果一个语言的成员资格可以由一个形式为 $\\forall y \\exists z, V(x,y,z)$ 的条件确定，那么该语言就在 $\\Pi_2^P$ 中。\n\n现在，考虑一个特定的语言 $L$。已知 $L$ 可由一台概率图灵机 $M$ 判定，该机器的运行时间受多项式 $p(n)$ 限制，其中 $n$ 是输入的长度。然而，这台机器的错误概率随着输入规模的增大而指数级地减小。对于任何长度为 $n$ 的输入字符串 $x$，该机器的行为如下：\n- 如果 $x \\in L$，机器 $M$ 输出 1（接受）的概率至少为 $1 - 2^{-n}$。\n- 如果 $x \\notin L$，机器 $M$ 输出 1（接受）的概率至多为 $2^{-n}$。\n\n这里的概率是基于机器内部的随机硬币抛掷来计算的。基于对语言 $L$ 的这个比通常更强的保证，关于它在复杂性类层次结构中的位置，哪个陈述是最强的正确陈述？\n\nA. 语言 $L$ 必须在 P（多项式时间）中。\n\nB. 语言 $L$ 必须在 NP（非确定性多项式时间）中。\n\nC. 语言 $L$ 必须在 NP $\\cap$ co-NP 中。\n\nD. 语言 $L$ 必须在 $\\Sigma_2^P \\cap \\Pi_2^P$ 中。\n\nE. 这个保证不足以将 $L$ 放入比 BPP 本身更具体的任何类中。",
            "solution": "给定一个语言 $L$ 和一台概率图灵机 $M$，它在输入长度为 $n$ 的字符串 $x$ 上的运行时间受多项式 $p(n)$ 限制，并且满足\n$$\nx \\in L \\implies \\Pr_{r}[M(x;r)=1] \\geq 1 - 2^{-n}, \\quad\nx \\notin L \\implies \\Pr_{r}[M(x;r)=1] \\leq 2^{-n},\n$$\n其中概率是针对 $M$ 使用的内部随机币 $r$ 计算的。\n\n首先，观察到这是一个具有指数级小错误的有效 BPP 类型保证。事实上，对于任何具有常数间隙的标准 BPP 机器，可以通过进行 $t$ 次独立运行并输出多数结果来将错误放大到至多 $2^{-n}$；根据 Chernoff 界，存在一个常数 $c0$，使得选择 $t=cn$ 会产生至多 $2^{-n}$ 的错误，所有这些都在 $n$ 的多项式时间内完成。因此，给定的保证并未将 $L$ 放入一个严格比 BPP 更小的类中；它是在 BPP 内部可以实现的标准错误减小。\n\n接下来，我们引用 Sipser–Lautemann 定理，该定理指出\n$$\n\\mathrm{BPP} \\subseteq \\Sigma_{2}^{P} \\cap \\Pi_{2}^{P}.\n$$\n我们简要回顾一下这个包含关系的结构。对于每个输入 $x$，令 $G_{x} \\subseteq \\{0,1\\}^{m}$ 为使得 $M(x;r)=1$ 的随机字符串 $r$ 的集合，其中 $m$ 是 $M$ 在长度为 $n$ 的输入上使用的随机比特数。在“是”的情况下， $|G_{x}| \\geq (1 - 2^{-n}) 2^{m}$；在“否”的情况下， $|G_{x}| \\leq 2^{-n} 2^{m}$。固定一个在 $n$ 上是多项式级别的整数 $k$。考虑 $k$ 个位移 $s_{1},\\dots,s_{k} \\in \\{0,1\\}^{m}$ 以及如下性质\n$$\n\\forall r \\in \\{0,1\\}^{m} \\ \\exists i \\in \\{1,\\dots,k\\} \\text{ such that } r \\oplus s_{i} \\in G_{x},\n$$\n其中 $\\oplus$ 表示按位异或。在“是”的情况下，对于一个合适的多项式有界的 $k$，一个标准的概率论证表明，随机选择的 $(s_{1},\\dots,s_{k})$ 以正概率满足上述性质，因此存在这样一个元组 $(s_{1},\\dots,s_{k})$。在“否”的情况下，对于每一个 $(s_{1},\\dots,s_{k})$，$G_{x}$ 的小尺寸意味着存在一个 $r$ 可以避开所有的位移，所以该性质不成立。这就产生了一个 $\\Sigma_{2}^{P}$ 的刻画：\n$$\nx \\in L \\iff \\exists (s_{1},\\dots,s_{k}) \\ \\forall r \\ \\bigvee_{i=1}^{k} \\bigl[M(x;r \\oplus s_{i})=1\\bigr],\n$$\n其内部有一个多项式时间的谓词，并且对偶地，对于非成员关系有一个 $\\Pi_{2}^{P}$ 的刻画。因此 $L \\in \\Sigma_{2}^{P} \\cap \\Pi_{2}^{P}$。\n\n最后，我们比较各个选项：\n- A (P) 未被证明无条件地包含所有这样的 $L$。\n- B (NP) 和 C (NP $\\cap$ co-NP) 也未被证明包含所有这样的 $L$。\n- D ($\\Sigma_{2}^{P} \\cap \\Pi_{2}^{P}$) 是对所有 $\\mathrm{BPP}$ 语言的一个已知的无条件上界，因此也适用于 $L$。\n- E 是错误的，因为存在一个比仅仅 BPP 更强的无条件归类，即 $\\Sigma_{2}^{P} \\cap \\Pi_{2}^{P}$。\n\n因此最强的正确陈述是 D。",
            "answer": "$$\\boxed{D}$$"
        }
    ]
}