{
    "hands_on_practices": [
        {
            "introduction": "置信上界 (Upper Confidence Bound, UCB) 是一种直观的采集函数，它优雅地平衡了探索不确定区域和利用已知高价值区域之间的权衡。通过计算一个结合了模型预测均值（$\\mu(x)$）和其不确定性（$\\sigma(x)$）的分数，我们可以策略性地决定下一步要评估哪个点。这个练习将让你亲手应用 UCB 策略来做出这一关键决策。",
            "id": "2156656",
            "problem": "一位数据科学家正在使用带有高斯过程代理模型的贝叶斯优化来为一个机器学习模型调整超参数 $\\lambda$。目标是最大化模型的验证准确率。在一组初始评估之后，代理模型为 $\\lambda$ 的五个候选值提供了以下后验统计数据（平均准确率 $\\mu$ 和准确率标准差 $\\sigma$）：\n\n*   A点: $\\lambda = 0.10$，平均准确率 $\\mu = 0.915$，标准差 $\\sigma = 0.010$\n*   B点: $\\lambda = 0.25$，平均准确率 $\\mu = 0.920$，标准差 $\\sigma = 0.005$\n*   C点: $\\lambda = 0.50$，平均准确率 $\\mu = 0.890$，标准差 $\\sigma = 0.025$\n*   D点: $\\lambda = 0.75$，平均准确率 $\\mu = 0.910$，标准差 $\\sigma = 0.014$\n*   E点: $\\lambda = 0.90$，平均准确率 $\\mu = 0.905$，标准差 $\\sigma = 0.018$\n\n该数据科学家正在使用上置信界 (UCB) 采集函数来决定下一个要评估的 $\\lambda$ 值。UCB 策略定义为选择使量 $A(x) = \\mu(x) + \\kappa \\sigma(x)$ 最大化的点 $x$。在这个优化步骤中，探索-利用权衡参数设置为 $\\kappa = 2.5$。\n\n基于 UCB 采集函数，五个候选点中的哪一个将被选择用于下一次评估？\n\nA. A点\n\nB. B点\n\nC. C点\n\nD. D点\n\nE. E点",
            "solution": "我们使用上置信界 (UCB) 采集函数，它选择使 $A(x) = \\mu(x) + \\kappa \\sigma(x)$ 最大化的点 $x$。这里，$\\kappa = 2.5$。对于每个候选点：\n\n对于A点：\n$$A(\\text{A}) = 0.915 + 2.5 \\times 0.010 = 0.915 + 0.025 = 0.940.$$\n\n对于B点：\n$$A(\\text{B}) = 0.920 + 2.5 \\times 0.005 = 0.920 + 0.0125 = 0.9325.$$\n\n对于C点：\n$$A(\\text{C}) = 0.890 + 2.5 \\times 0.025 = 0.890 + 0.0625 = 0.9525.$$\n\n对于D点：\n$$A(\\text{D}) = 0.910 + 2.5 \\times 0.014 = 0.910 + 0.035 = 0.945.$$\n\n对于E点：\n$$A(\\text{E}) = 0.905 + 2.5 \\times 0.018 = 0.905 + 0.045 = 0.950.$$\n\n比较这些采集值，最大值为 $0.9525$，在C点取得。因此，UCB 策略选择C点。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "UCB 提供了一种有效的启发式方法，而期望提升 (Expected Improvement, EI) 则提供了一种更严谨的途径，它直接计算了在当前已发现最优值基础上的期望增益。这个指标是贝叶斯优化的基石，它以具体数值量化了每次潜在评估的价值。本题将引导你完成 EI 的计算，将理论公式与一个实际的材料科学场景联系起来。",
            "id": "2156694",
            "problem": "一位材料科学家正在使用贝叶斯优化框架来寻找能最大化一种新合金拉伸强度的最佳退火温度 $x$。拉伸强度 $f(x)$ 以兆帕 (MPa) 为单位进行测量。函数 $f(x)$ 的评估成本很高，因此使用高斯过程模型来指导对最优值的搜索。\n\n经过几次实验，迄今为止观察到的最高拉伸强度为 $f(x^+) = 350$ MPa。\n\n该科学家正在考虑一个新的、未经评估的温度 $x_{new}$。模型预测，在这个新温度下的拉伸强度 $f(x_{new})$ 将服从高斯（正态）分布，其均值为 $\\mu(x_{new}) = 360$ MPa，标准差为 $\\sigma(x_{new}) = 8$ MPa。\n\n为了决定评估 $x_{new}$ 是否值得，该科学家计算了期望提升 (Expected Improvement, EI)。该指标表示相对于当前最佳观测值的改进量的期望值，其中改进量定义为 $\\max(0, f(x_{new}) - f(x^+))$。\n\n计算候选温度 $x_{new}$ 的期望提升。\n\n为了帮助您计算，这里给出了与标准正态分布（均值为 0，方差为 1）相关的以下值。令 $\\phi(z)$ 为其概率密度函数，$\\Phi(z)$ 为其累积分布函数。当 $z=1.25$ 时，其值约为 $\\phi(1.25) = 0.1826$ 和 $\\Phi(1.25) = 0.8944$。\n\n请用 MPa 表示您的最终答案，并四舍五入到三位有效数字。",
            "solution": "我们要最大化拉伸强度，因此在 $x_{new}$ 处的改进量定义为 $I=\\max\\{0, f(x_{new})-f(x^{+})\\}$，其中 $f(x_{new}) \\sim \\mathcal{N}(\\mu(x_{new}), \\sigma^{2}(x_{new}))$。期望提升 (EI) 为\n$$\n\\operatorname{EI}(x_{new})=\\mathbb{E}[I]=\\int_{f(x^{+})}^{\\infty} (y-f(x^{+})) \\frac{1}{\\sigma(x_{new})}\\,\\phi\\!\\left(\\frac{y-\\mu(x_{new})}{\\sigma(x_{new})}\\right)\\,dy.\n$$\n令 $\\mu=\\mu(x_{new})$，$\\sigma=\\sigma(x_{new})$，以及 $f^{+}=f(x^{+})$。进行变量替换 $t=(y-\\mu)/\\sigma$，因此 $y=\\mu+\\sigma t$ 且 $dy=\\sigma\\,dt$。下限 $y=f^{+}$ 对应于 $t=(f^{+}-\\mu)/\\sigma$。然后\n$$\n\\operatorname{EI}=\\int_{(f^{+}-\\mu)/\\sigma}^{\\infty} \\left((\\mu+\\sigma t)-f^{+}\\right)\\phi(t)\\,dt\n=(\\mu-f^{+})\\int_{a}^{\\infty}\\phi(t)\\,dt+\\sigma\\int_{a}^{\\infty} t\\phi(t)\\,dt,\n$$\n其中 $a=(f^{+}-\\mu)/\\sigma$。使用 $\\int_{a}^{\\infty}\\phi(t)\\,dt=\\Phi(-a)$ 和 $\\int_{a}^{\\infty} t\\phi(t)\\,dt=\\phi(a)$ （因为 $\\frac{d}{dt}\\phi(t)=-t\\phi(t)$），并定义 $z=(\\mu-f^{+})/\\sigma=-a$，我们得到标准的 EI 公式\n$$\n\\operatorname{EI}=(\\mu-f^{+})\\Phi(z)+\\sigma\\,\\phi(z), \\quad z=\\frac{\\mu-f^{+}}{\\sigma}.\n$$\n对于给定值 $\\mu=360$ MPa，$f^{+}=350$ MPa，以及 $\\sigma=8$ MPa，因此\n$$\nz=\\frac{360-350}{8}=\\frac{10}{8}=1.25.\n$$\n使用提供的标准正态分布值 $\\Phi(1.25)=0.8944$ 和 $\\phi(1.25)=0.1826$，计算\n$$\n(\\mu-f^{+})\\Phi(z)=10\\times 0.8944=8.944,\\qquad \\sigma\\,\\phi(z)=8\\times 0.1826=1.4608,\n$$\n因此\n$$\n\\operatorname{EI}=8.944+1.4608=10.4048 \\text{ MPa}.\n$$\n四舍五入到三位有效数字，得到 $10.4$ MPa。",
            "answer": "$$\\boxed{10.4}$$"
        },
        {
            "introduction": "贝叶斯优化的目标不仅仅是探索一个函数，而是最终确定其最优点。当搜索预算耗尽后，我们该如何给出最终的建议，尤其是在处理带噪声的测量数据时？这个练习将挑战你批判性地思考优化过程的最终目标，比较原始的、带噪声的观测值与高斯过程模型提供的去噪后的洞见。",
            "id": "2156691",
            "problem": "一位材料科学家正在使用贝叶斯优化（BO）来寻找最佳固化温度 $x$，以最大化一种新型聚合物复合材料的拉伸强度 $f(x)$。拉伸强度的测量会受到实验噪声的影响。该科学家使用高斯过程（GP）对未知函数 $f(x)$ 进行建模。\n\n在进行了四次实验后，优化预算已经用尽。收集到的数据由固化温度（单位：摄氏度）和相应的带噪声的拉伸强度测量值（单位：兆帕，MPa）对组成。GP 模型为任何温度 $x$ 下的拉伸强度提供了后验均值 $\\mu(x)$ 和后验标准差 $\\sigma(x)$。\n\n四次实验的结果如下：\n\n| 实验 | 温度 $x$ ($^{\\circ}$C) | 观测强度 $y$ (MPa) | 后验均值 $\\mu(x)$ (MPa) | 后验标准差 $\\sigma(x)$ (MPa) |\n|------------|------------------------------|-------------------------------|---------------------------------|------------------------------------------|\n| 1          | 120                          | 315.4                         | 316.0                           | 1.8                                      |\n| 2          | 130                          | 325.1                         | 322.5                           | 1.7                                      |\n| 3          | 140                          | 324.8                         | 326.2                           | 1.9                                      |\n| 4          | 150                          | 320.7                         | 321.0                           | 2.5                                      |\n\n该科学家现在必须为这种聚合物的批量生产推荐一个唯一的最佳温度。根据以上数据，应该推荐哪个温度？其正确的理由是什么？\n\nA. 推荐 $140^{\\circ}$C，因为其对应的后验均值最高，这代表了模型在考虑所有数据并滤除噪声后对真实最大强度的最佳估计。\n\nB. 推荐 $130^{\\circ}$C，因为它产生了直接观测到的最高拉伸强度，并且经验测量值比模型预测更值得信赖。\n\nC. 推荐 $150^{\\circ}$C，因为该温度下的高后验标准差表明，它具有最大的未探索潜力，可能产生比已观测到的更高的强度。\n\nD. 推荐 $130^{\\circ}$C，因为与其他点相比，它具有相对较低的后验标准差，这表明其较高的测量强度是一个可靠的结果。",
            "solution": "贝叶斯优化的目标是找到一个未知且可能带噪声的函数 $f(x)$ 的全局最优解。在本问题中，需要最大化的函数是聚合物的拉伸强度，它是固化温度的函数。优化过程已经结束，最终任务不是进一步探索，而是利用已获得的知识来做出最佳推荐。这意味着我们必须确定最有可能产生真实的、潜在函数 $f(x)$ 最大值的输入 $x$，而不仅仅是产生最大噪声观测值 $y$ 的输入。\n\n让我们分析一下问题的各个组成部分：\n1.  **观测强度 ($y$)**：值 $y$ 是真实强度的带噪声测量值。某个特定的观测值由 $y_i = f(x_i) + \\epsilon_i$ 给出，其中 $\\epsilon_i$ 是一个随机噪声项。因此，在 $x = 130^{\\circ}$C 时的最高观测值 $y = 325.1$ MPa，可能是一个中等偏高的真实强度与一个较大的正向噪声波动相结合的结果。仅仅依赖单个最佳观测值是一种脆弱的策略，因为它忽略了数据的噪声特性。\n\n2.  **后验均值 ($\\mu(x)$)**：高斯过程（GP）模型在给定观测数据的情况下，提供了函数 $f(x)$ 的后验分布。后验均值 $\\mu(x)$ 代表了真实函数 $f(x)$ 在输入 $x$ 处的期望值。它是通过考虑*所有*数据点的影响来计算的，这些影响根据它们的邻近程度和模型的相关性假设进行加权。因此，$\\mu(x)$ 可作为真实函数的去噪估计。为了最大化真实强度 $f(x)$，我们的最佳策略是选择能够最大化我们对 $f(x)$ 的估计值的 $x$，而这个估计值正是后验均值 $\\mu(x)$。\n\n3.  **后验标准差 ($\\sigma(x)$)**：这个值量化了模型对其估计值 $\\mu(x)$ 的不确定性。在优化阶段（现已完成），高的不确定性对于探索是有价值的。例如，像上置信界（UCB）这样的采集函数，定义为 $\\text{UCB}(x) = \\mu(x) + \\beta \\sigma(x)$，它在高均值区域的利用（exploit）和高不确定性区域的探索（explore）之间取得平衡。然而，一旦过程结束并且需要做出最终推荐，目标就是纯粹的利用。当需要做出最终的、唯一的最佳选择时，仅仅因为一个点的不确定性高（探索）而选择它是不正确的。\n\n基于此理解，让我们评估一下各个选项：\n-   **_选项 A_**: 该选项建议选择 $x = 140^{\\circ}$C。查看表格，后验均值 $\\mu(140) = 326.2$ MPa 是 $\\mu(x)$ 列中的最大值。其理由是，后验均值是模型对真实函数进行去噪后的最佳估计。这与贝叶斯优化中的利用原则完全一致。我们希望推荐模型认为的真实最优点。\n\n-   **_选项 B_**: 该选项建议选择 $x = 130^{\\circ}$C，因为它产生了最高的观测值 $y = 325.1$ MPa。如前所述，这忽略了噪声的影响。模型在该点的后验均值 $\\mu(130) = 322.5$ MPa 显著低于观测值，这表明模型将这一高读数部分归因于正向噪声。这个选择不是最优的。\n\n-   **_选项 C_**: 该选项建议选择 $x = 150^{\\circ}$C，因为其不确定性高（$\\sigma(150) = 2.5$ MPa）。这是一种探索策略，而不是利用策略。如果预算没有用尽，这是一个决定*下一个*采样点的有效考虑因素，但对于做出最终推荐，这不是正确的策略。目标不再是改进模型，而是使用当前模型做出最佳选择。\n\n-   **_选项 D_**: 该选项建议选择 $x = 130^{\\circ}$C，但其理由是基于其低不确定性。虽然低不确定性意味着可靠性，但主要目标是最大化函数值。一个次优值的高度可靠的估计，并不比一个优越值但可靠性稍差的估计更好。推荐应基于期望结果（$\\mu(x)$），而不仅仅是其确定性（$\\sigma(x)$）。点 $x = 140^{\\circ}$C 具有更高的期望结果 $\\mu(140) = 326.2$ MPa，尽管其不确定性比 $x=130^{\\circ} \\text{C}$ 稍高，但这使其成为更好的选择。\n\n因此，正确的做法是相信模型的去噪估计，即后验均值，并选择使其最大化的输入。最高的后验均值是 $326.2$ MPa，对应于 $140^{\\circ}$C 的温度。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}