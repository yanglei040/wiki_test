{
    "hands_on_practices": [
        {
            "introduction": "三次样条不仅要穿过数据点，还要尽可能地平滑。这个练习将探讨一个最基本也最富启发性的情形：给定三个数据点，样条在中间节点处达到“最平滑”状态（即存在一个拐点）的条件是什么？通过解决这个问题 ，你将发现这一条件与数据点的几何排列有直接关系，从而深刻理解样条是如何在插值和最小化曲率之间取得平衡的。",
            "id": "2429320",
            "problem": "设$x_0  x_1  x_2$为三个节点，并令$h_0 = x_1 - x_0$，$h_1 = x_2 - x_1$。考虑穿过数据点$(x_0, y_0)$, $(x_1, y_1)$, $(x_2, y_2)$的自然三次样条$s(x)$。样条在内部节点$x_1$处有拐点（即$s''(x_1)=0$）的充要条件是，$y_1$可以表示为$y_0$和$y_2$的线性组合：$y_1 = \\alpha y_0 + (1-\\alpha) y_2$。请确定系数$\\alpha$的表达式，用$h_0$和$h_1$表示。",
            "solution": "该问题陈述在科学上是合理的、适定的、客观且自洽的。它提出了一个数值分析领域的标准问题，具体涉及自然三次样条的性质。该问题是有效的，并且可以推导出解。\n\n设$s(x)$为对数据点$\\{(x_j, y_j)\\}_{j=0}^2$进行插值的自然三次样条，其中$x_0  x_1  x_2$。区间定义为$h_0 = x_1 - x_0 > 0$和$h_1 = x_2 - x_1 > 0$。根据定义，三次样条是一个分段三次多项式，并且二阶连续可微。令$M_j = s''(x_j)$（$j=0,1,2$）为样条在节点处的二阶导数，这也被称为矩。\n\n对于一般的三次样条，其一阶导数在内部节点$x_1$处的连续性$s'(x_1^-) = s'(x_1^+)$决定了矩之间的一个线性关系。这个标准结果由以下方程给出：\n$$\n\\frac{h_0}{6} M_0 + \\frac{h_0+h_1}{3} M_1 + \\frac{h_1}{6} M_2 = \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\n$$\n问题指明$s(x)$是一个*自然*三次样条。这施加了边界条件$s''(x_0)=0$和$s''(x_2)=0$。用矩来表示，这些条件是$M_0=0$和$M_2=0$。\n\n将这些自然边界条件代入一般的矩方程，得到：\n$$\n\\frac{h_0}{6} (0) + \\frac{h_0+h_1}{3} M_1 + \\frac{h_1}{6} (0) = \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\n$$\n化简后得到：\n$$\n\\left(\\frac{h_0+h_1}{3}\\right) M_1 = \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\n$$\n问题要求样条在内部节点$x_1$处有拐点。对于一个二阶可微函数，拐点出现在其二阶导数为零的地方。因此，该条件等价于$s''(x_1) = 0$，即$M_1=0$。\n\n问题陈述该拐点存在的充要条件是$y_j$值之间满足某个特定关系。由于$h_0>0$和$h_1>0$，系数$\\frac{h_0+h_1}{3}$是严格为正且非零的。因此，条件$M_1=0$等价于方程右侧为零：\n$$\nM_1 = 0 \\iff \\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0} = 0\n$$\n这就建立了“当且仅当”的逻辑关系。我们现在对该方程求解$y_1$，以找到所需的关系。\n$$\n\\frac{y_2-y_1}{h_1} = \\frac{y_1-y_0}{h_0}\n$$\n这个条件有一个清晰的几何解释：连接$(x_0, y_0)$和$(x_1, y_1)$的线段的斜率必须等于连接$(x_1, y_1)$和$(x_2, y_2)$的线段的斜率。这意味着这三个数据点必须共线。\n\n为了求出系数$\\alpha$，我们进行代数运算：\n$$\nh_0(y_2-y_1) = h_1(y_1-y_0)\n$$\n$$\nh_0 y_2 - h_0 y_1 = h_1 y_1 - h_1 y_0\n$$\n$$\nh_1 y_0 + h_0 y_2 = (h_0 + h_1) y_1\n$$\n对$y_1$求解，我们得到：\n$$\ny_1 = \\left(\\frac{h_1}{h_0+h_1}\\right) y_0 + \\left(\\frac{h_0}{h_0+h_1}\\right) y_2\n$$\n问题陈述该关系必须具有$y_1 = \\alpha y_0 + (1-\\alpha) y_2$的形式。通过比较两个表达式中$y_0$的系数，我们确定$\\alpha$：\n$$\n\\alpha = \\frac{h_1}{h_0+h_1}\n$$\n为了验证，我们检查$y_2$的系数是否等于$1-\\alpha$：\n$$\n1-\\alpha = 1 - \\frac{h_1}{h_0+h_1} = \\frac{h_0+h_1-h_1}{h_0+h_1} = \\frac{h_0}{h_0+h_1}\n$$\n这与我们推导出的表达式中$y_2$的系数相匹配。因此，这个确定是正确的。系数$\\alpha$仅是$h_0$和$h_1$的函数，正如所要求的。",
            "answer": "$$\n\\boxed{\\frac{h_1}{h_0+h_1}}\n$$"
        },
        {
            "introduction": "在掌握了基本原理之后，我们将挑战一个更完整的分析任务。此练习要求你构建一个穿过四个数据点的自然三次样条，并精确地找出其所有的局部极值点。这项任务  需要你完整地执行从建立并求解样条二阶导数的方程组，到求解其分段二次导函数根的整个分析流程，从而将样条的代数定义与其具体的几何形状联系起来。",
            "id": "2429285",
            "problem": "考虑一个自然三次样条$S(x)$，它插值数据点$\\{(x_i,y_i)\\}_{i=0}^{3}$，其节点为$x_0=0$, $x_1=1$, $x_2=2$, $x_3=3$，对应的值为$y_0=0$, $y_1=2$, $y_2=1$, $y_3=2$。根据定义，自然三次样条是一个二次连续可微的分段三次函数，它插值这些数据点，并满足$S''(x_0)=0$和$S''(x_3)=0$。仅使用这些定义性质以及$S'(x)$是分段二次函数的要求，解析地确定$S(x)$的所有内部局部极值点，即所有满足$S'(x^{\\star})=0$的$x^{\\star}\\in(x_0,x_3)$。\n\n以单行矩阵的形式，按升序提供所有内部局部极值点的$x$坐标的精确形式（无四舍五入）。不要对极值点进行分类，也不要报告端点行为。",
            "solution": "**解**\n\n三次样条$S(x)$在每个子区间$[x_i, x_{i+1}]$上是分段定义的。令$M_i = S''(x_i)$为样条在节点$x_i$处的二阶导数。对于自然三次样条，边界条件为$M_0 = S''(x_0)=0$和$M_n=S''(x_n)=0$。在本问题中，$n=3$，所以$M_0=0$且$M_3=0$。\n\n节点是等间距的，步长为$h = x_{i+1} - x_i = 1$。一阶导数$S'(x)$在内部节点$x_1$和$x_2$处的连续性对$M_i$的值施加了约束。对于等间距节点，此关系由以下线性方程组给出：\n$$M_{i-1} + 4M_i + M_{i+1} = \\frac{6}{h^2}(y_{i+1} - 2y_i + y_{i-1})$$\n当$h=1$时，这简化为：\n$$M_{i-1} + 4M_i + M_{i+1} = 6(y_{i+1} - 2y_i + y_{i-1})$$\n我们对内部节点$i=1$和$i=2$应用此公式。\n\n对于$i=1$：\n$M_0 + 4M_1 + M_2 = 6(y_2 - 2y_1 + y_0)$\n代入给定值$M_0=0$, $y_0=0$, $y_1=2$, $y_2=1$：\n$0 + 4M_1 + M_2 = 6(1 - 2(2) + 0) = 6(-3) = -18$\n$$4M_1 + M_2 = -18 \\quad (1)$$\n\n对于$i=2$：\n$M_1 + 4M_2 + M_3 = 6(y_3 - 2y_2 + y_1)$\n代入给定值$M_3=0$, $y_1=2$, $y_2=1$, $y_3=2$：\n$M_1 + 4M_2 + 0 = 6(2 - 2(1) + 2) = 6(2) = 12$\n$$M_1 + 4M_2 = 12 \\quad (2)$$\n\n我们求解关于$M_1$和$M_2$的线性方程组：\n由方程(2)得，$M_1 = 12 - 4M_2$。代入方程(1)：\n$4(12 - 4M_2) + M_2 = -18$\n$48 - 16M_2 + M_2 = -18$\n$-15M_2 = -66 \\implies M_2 = \\frac{66}{15} = \\frac{22}{5}$。\n现在，我们求$M_1$：\n$M_1 = 12 - 4\\left(\\frac{22}{5}\\right) = \\frac{60 - 88}{5} = -\\frac{28}{5}$。\n所以，节点处的二阶导数为：$M_0=0$, $M_1 = -\\frac{28}{5}$, $M_2 = \\frac{22}{5}$, $M_3=0$。\n\n样条段$S_i(x)$在区间$[x_i, x_{i+1}]$上的一阶导数可以表示为$u = x-x_i$的二次函数。对于$h=1$，标准公式为：\n$S'_i(x) = \\frac{M_{i+1}-M_i}{2} u^2 + M_i u + \\left( (y_{i+1}-y_i) - \\frac{M_{i+1}+2M_i}{6} \\right)$\n我们在每个开区间$(x_i, x_{i+1})$内寻找$S'_i(x)=0$的根。\n\n**区间 1: $[0, 1]$ ($i=0$)**\n在这里，$u=x$。\n$S'_0(x) = \\frac{-28/5 - 0}{2} x^2 + (0)x + \\left((2-0) - \\frac{-28/5 + 0}{6}\\right)$\n$S'_0(x) = -\\frac{14}{5}x^2 + 2 + \\frac{14}{15} = -\\frac{14}{5}x^2 + \\frac{44}{15}$\n设置$S'_0(x)=0$：\n$-\\frac{14}{5}x^2 = -\\frac{44}{15} \\implies x^2 = \\frac{44}{15} \\cdot \\frac{5}{14} = \\frac{22}{21}$。\n解为$x = \\pm\\sqrt{\\frac{22}{21}}$。由于$\\sqrt{\\frac{22}{21}} > 1$，两个解都不在区间$(0,1)$内。此区间内没有极值点。\n\n**区间 2: $[1, 2]$ ($i=1$)**\n在这里，$u=x-1$。\n$S'_1(x) = \\frac{22/5 - (-28/5)}{2} u^2 - \\frac{28}{5}u + \\left((1-2) - \\frac{22/5 + 2(-28/5)}{6}\\right)$\n$S'_1(x) = 5u^2 - \\frac{28}{5}u + \\left(-1 - \\frac{-34/5}{6}\\right) = 5u^2 - \\frac{28}{5}u + \\left(-1 + \\frac{17}{15}\\right) = 5u^2 - \\frac{28}{5}u + \\frac{2}{15}$。\n设置$S'_1(x)=0$，并乘以$15$得到$75u^2 - 84u + 2 = 0$。\n对$u$使用二次公式：\n$u = \\frac{-(-84) \\pm \\sqrt{(-84)^2 - 4(75)(2)}}{2(75)} = \\frac{84 \\pm \\sqrt{7056 - 600}}{150} = \\frac{84 \\pm \\sqrt{6456}}{150}$。\n简化根式：$\\sqrt{6456} = 2\\sqrt{1614}$。\n$u = \\frac{84 \\pm 2\\sqrt{1614}}{150} = \\frac{42 \\pm \\sqrt{1614}}{75}$。\n我们需要$u \\in (0,1)$。我们知道$40^2=1600$和$41^2=1681$，所以$40  \\sqrt{1614}  41$。\n对于$u_1 = \\frac{42 + \\sqrt{1614}}{75}$，分子约等于$42+40.17=82.17$，所以$u_1 > 1$。此解在区间之外。\n对于$u_2 = \\frac{42 - \\sqrt{1614}}{75}$，分子约等于$42-40.17=1.83$，为正数。分母为$75$，所以$0  u_2  1$。此解有效。\n对应的$x$坐标为$x^{\\star}_1 = 1 + u_2 = 1 + \\frac{42 - \\sqrt{1614}}{75} = \\frac{75 + 42 - \\sqrt{1614}}{75} = \\frac{117 - \\sqrt{1614}}{75}$。\n\n**区间 3: $[2, 3]$ ($i=2$)**\n在这里，$u=x-2$。\n$S'_2(x) = \\frac{0 - 22/5}{2} u^2 + \\frac{22}{5}u + \\left((2-1) - \\frac{0 + 2(22/5)}{6}\\right)$\n$S'_2(x) = -\\frac{11}{5}u^2 + \\frac{22}{5}u + \\left(1 - \\frac{44/5}{6}\\right) = -\\frac{11}{5}u^2 + \\frac{22}{5}u + \\left(1 - \\frac{22}{15}\\right) = -\\frac{11}{5}u^2 + \\frac{22}{5}u - \\frac{7}{15}$。\n设置$S'_2(x)=0$，并乘以$-15$得到$33u^2 - 66u + 7 = 0$。\n对$u$使用二次公式：\n$u = \\frac{-(-66) \\pm \\sqrt{(-66)^2 - 4(33)(7)}}{2(33)} = \\frac{66 \\pm \\sqrt{4356 - 924}}{66} = \\frac{66 \\pm \\sqrt{3432}}{66}$。\n我们简化根式：$\\sqrt{3432} = 2\\sqrt{858}$。\n$u = \\frac{66 \\pm 2\\sqrt{858}}{66} = 1 \\pm \\frac{\\sqrt{858}}{33}$。\n我们需要$u \\in (0,1)$。\n对于$u_1 = 1 + \\frac{\\sqrt{858}}{33}$，显然$u_1 > 1$，所以此解无效。\n对于$u_2 = 1 - \\frac{\\sqrt{858}}{33}$，我们知道$29^2=841$和$30^2=900$，所以$29  \\sqrt{858}  30$。\n因此，$\\frac{29}{33}  \\frac{\\sqrt{858}}{33}  \\frac{30}{33}$，这意味着$0  u_2  1$。此解有效。\n对应的$x$坐标为$x^{\\star}_2 = 2 + u_2 = 2 + 1 - \\frac{\\sqrt{858}}{33} = 3 - \\frac{\\sqrt{858}}{33}$。\n\n两个内部局部极值点位于$x^{\\star}_1 = \\frac{117 - \\sqrt{1614}}{75}$和$x^{\\star}_2 = 3 - \\frac{\\sqrt{858}}{33}$。\n数值上，$x^{\\star}_1 \\approx 1.024$且$x^{\\star}_2 \\approx 2.112$。\n问题要求按升序排列这些值。\n\n最终答案是这两个$x$坐标的有序集合。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{117 - \\sqrt{1614}}{75}  3 - \\frac{\\sqrt{858}}{33} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在实际应用中，我们常常需要用样条来拟合带有噪声的数据，而非精确插值，这就引出了回归样条的概念。本练习  将我们的视角从解析推导转向计算实践，你将通过编程寻找单个“结”的最佳位置，以最小化对给定数据集的拟合误差。这个练习不仅介绍了回归样条和模型选择（结的位置）这一重要问题，还展示了如何利用截断幂基函数，将复杂的样条拟合问题转化为标准的线性最小二乘问题来解决。",
            "id": "2429284",
            "problem": "给定若干个点的数据集 $\\{(x_i,y_i)\\}_{i=1}^m$，其横坐标 $x_1  x_2  \\dots  x_m$ 严格递增。考虑 $C^2$ 连续（即函数、其一阶导数和二阶导数处处连续）的三次回归样条空间。一种表示在单个内部节点 $\\tau$ 处强制 $C^2$ 连续性的标准方法是使用截断幂基\n$$\ns(x;\\boldsymbol{\\theta},\\tau) \\;=\\; \\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\beta_3 x^3 + \\gamma\\,(x-\\tau)_+^3,\n$$\n其中 $(x-\\tau)_+^3 = \\max(x-\\tau,0)^3$，而 $\\boldsymbol{\\theta} = (\\beta_0,\\beta_1,\\beta_2,\\beta_3,\\gamma)$ 是待由数据通过最小二乘法确定的系数。当 $\\gamma=0$ 时（即没有内部节点），可恢复为纯三次多项式 $p(x)=\\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\beta_3 x^3$。数据拟合误差由残差平方和 (RSS) 度量，\n$$\n\\mathrm{RSS}(\\tau) \\;=\\; \\min_{\\boldsymbol{\\theta}} \\sum_{i=1}^m \\left(s(x_i;\\boldsymbol{\\theta},\\tau)-y_i\\right)^2,\n$$\n无节点基线误差为\n$$\n\\mathrm{RSS}_0 \\;=\\; \\min_{\\beta_0,\\beta_1,\\beta_2,\\beta_3} \\sum_{i=1}^m \\left(\\beta_0 + \\beta_1 x_i + \\beta_2 x_i^2 + \\beta_3 x_i^3 - y_i\\right)^2.\n$$\n因为具有一个内部节点的模型包含了无节点模型作为 $\\gamma=0$ 的特例，所以有节点的误差不会超过基线误差。\n\n您的任务是，对每个给定的数据集，通过在一个离散的候选集上最小化 $\\mathrm{RSS}(\\tau)$，以编程方式确定能最大程度减少总体近似误差的内部节点位置 $\\tau^\\star$。该候选集必须是内部横坐标的集合，即数据集中严格位于最小和最大 $x_i$ 值之间的所有 $x_i$。通过选择在数值公差范围内达到最小值的 $\\tau$ 中最小的一个来打破平局。拟合的样条必须如截断幂基所保证的那样处处 $C^2$ 连续。\n\n您必须直接使用截断幂基设计矩阵来实现最小二乘拟合。除线性最小二乘法外，不要假设任何已有的样条拟合功能。您的程序必须：\n- 构建列为 $[1, x, x^2, x^3]$ 的基线三次多项式设计矩阵，并计算 $\\mathrm{RSS}_0$。\n- 对每个候选 $\\tau$，构建列为 $[1, x, x^2, x^3, (x-\\tau)_+^3]$ 的增广设计矩阵，并计算 $\\mathrm{RSS}(\\tau)$。\n- 选择 $\\tau^\\star$ 作为在公差范围内（对 $\\mathrm{RSS}$ 差值使用固定的绝对公差 $\\varepsilon = 10^{-12}$）达到最小 $\\mathrm{RSS}(\\tau)$ 的最小候选 $\\tau$。\n- 对每个测试用例输出 $\\tau^\\star$。\n\n使用的基本原理和性质：\n- 三次多项式的一阶和二阶导数处处连续。\n- 截断幂函数 $(x-\\tau)_+^3$ 及其一阶和二阶导数在 $x\\le \\tau$ 时为零，在 $x\\tau$ 时分别为三次、二次和线性函数。因此，$s(x;\\boldsymbol{\\theta},\\tau)$ 在 $x=\\tau$ 处是 $C^2$ 连续的。\n- 普通最小二乘投影到线性模型子空间上，可以最小化残差平方和。\n\n测试套件：\n- 情况 $1$（理想情况，节点在中间）。使用 $m=11$ 和\n  $x = [\\,0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0\\,]$，\n  并为每个 $i$ 定义\n  $y_i = x_i^3 + (x_i-0.5)_+^3$。这可以被真实节点在 $\\tau=0.5$ 的模型精确表示。\n- 情况 $2$（平局情况，数据是精确的三次函数）。使用 $m=11$ 和\n  $x = [\\,0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,0.9,\\,1.0\\,]$，\n  以及\n  $y_i = x_i^3 - 2 x_i$。基线三次函数能完美拟合，因此 $\\mathrm{RSS}_0=0$。所有候选节点都会产生相同的最小残差（在数值公差范围内）。您的平局决胜规则应返回 $\\tau^\\star=0.1$（最小的内部横坐标）。\n- 情况 $3$（非均匀网格，偏离中心的节点）。使用 $m=12$ 和\n  $x = [\\,0.0,\\,0.05,\\,0.1,\\,0.15,\\,0.2,\\,0.25,\\,0.3,\\,0.4,\\,0.55,\\,0.7,\\,0.85,\\,1.0\\,]$，\n  以及\n  $y_i = 2 x_i^3 + 5 (x_i-0.25)_+^3$。这可以被真实节点在 $\\tau=0.25$ 的模型精确表示。\n\n不涉及角度单位。本问题中没有物理单位。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个 $\\tau^\\star$ 格式化为精确到 $6$ 位小数的十进制数（例如，$[0.500000,0.100000,0.250000]$）。顺序必须分别对应情况 $1$、$2$ 和 $3$。",
            "solution": "目标是为一个$C^2$连续的三次回归样条确定单个内部节点的最佳位置$\\tau^\\star$。最优性的标准是最小化残差平方和 (RSS)。对$\\tau^\\star$的搜索被限制在一个离散的候选位置集合上，这些位置是给定数据集$\\{ (x_i, y_i) \\}_{i=1}^m$的内部横坐标。\n\n带有节点$\\tau$的样条函数$s(x)$的模型由截断幂基表示给出：\n$$\ns(x; \\boldsymbol{\\theta}, \\tau) = \\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\beta_3 x^3 + \\gamma (x - \\tau)_+^3\n$$\n其中$(x - \\tau)_+^3 = \\max(0, x - \\tau)^3$。系数$\\boldsymbol{\\theta} = (\\beta_0, \\beta_1, \\beta_2, \\beta_3, \\gamma)^T$通过对给定的节点$\\tau$最小化 RSS 来确定。这是一个线性最小二乘问题。\n\n对于一组$m$个数据点，我们可以将模型表示为矩阵-向量形式$\\mathbf{y} = \\mathbf{X}(\\tau)\\boldsymbol{\\theta} + \\boldsymbol{\\epsilon}$，其中$\\mathbf{y} \\in \\mathbb{R}^m$是观测响应$y_i$的向量，$\\mathbf{X}(\\tau) \\in \\mathbb{R}^{m \\times 5}$是设计矩阵，$\\boldsymbol{\\theta} \\in \\mathbb{R}^5$是系数向量，$\\boldsymbol{\\epsilon} \\in \\mathbb{R}^m$是误差向量。\n\n设计矩阵$\\mathbf{X}(\\tau)$取决于所选的节点$\\tau$。其第$i$行对应于数据点$x_i$：\n$$\n[\\mathbf{X}(\\tau)]_{i,:} = \\begin{bmatrix} 1  x_i  x_i^2  x_i^3  (x_i - \\tau)_+^3 \\end{bmatrix}\n$$\n普通最小二乘法 (OLS) 估计$\\hat{\\boldsymbol{\\theta}}$最小化 RSS，定义为$\\mathrm{RSS}(\\tau) = \\|\\mathbf{y} - \\mathbf{X}(\\tau)\\boldsymbol{\\theta}\\|_2^2$。该最小化问题的解通过求解正规方程给出：\n$$\n(\\mathbf{X}(\\tau)^T \\mathbf{X}(\\tau)) \\hat{\\boldsymbol{\\theta}} = \\mathbf{X}(\\tau)^T \\mathbf{y}\n$$\n对于给定的$\\tau$，最小残差平方和为：\n$$\n\\mathrm{RSS}(\\tau) = \\|\\mathbf{y} - \\mathbf{X}(\\tau)\\hat{\\boldsymbol{\\theta}}\\|_2^2\n$$\n在数值计算上，最好使用稳健的线性代数程序（例如基于 QR 分解的程序）来求解$\\hat{\\boldsymbol{\\theta}}$并计算 RSS，而不是显式地构造和求逆$\\mathbf{X}(\\tau)^T \\mathbf{X}(\\tau)$。\n\n寻找最优节点$\\tau^\\star$的算法步骤如下：\n$1$. 对于一个给定的数据集$(\\mathbf{x}, \\mathbf{y})$，大小为$m$，确定候选节点集$\\mathcal{T} = \\{x_2, x_3, \\dots, x_{m-1}\\}$。\n$2$. 对每个候选节点$\\tau_k \\in \\mathcal{T}$：\n    a. 构建$m \\times 5$的设计矩阵$\\mathbf{X}(\\tau_k)$。\n    b. 求解线性最小二乘问题以找到 RSS，我们将其表示为$\\mathrm{RSS}(\\tau_k)$。该值可从标准的线性最小二乘数值求解器直接获得。\n$3$. 在为所有$\\tau_k \\in \\mathcal{T}$计算出$\\mathrm{RSS}(\\tau_k)$后，找到最小值：\n$$\n\\mathrm{RSS}_{\\min} = \\min_{\\tau_k \\in \\mathcal{T}} \\mathrm{RSS}(\\tau_k)\n$$\n$4$. 识别所有在指定数值公差$\\varepsilon = 10^{-12}$内达到此最小 RSS 的候选节点集合：\n$$\n\\mathcal{T}_{\\min} = \\{ \\tau_k \\in \\mathcal{T} \\mid \\mathrm{RSS}(\\tau_k) \\le \\mathrm{RSS}_{\\min} + \\varepsilon \\}\n$$\n$5$. 应用平局决胜规则，从此集合中选择最小的节点：\n$$\n\\tau^\\star = \\min(\\mathcal{T}_{\\min})\n$$\n此过程是确定性的，并保证对任何给定的数据集都有唯一的解$\\tau^\\star$。所提供的测试用例旨在验证此逻辑的正确实现，包括数据可被特定节点的模型完美表示的情况以及需要平局决胜规则的情况。附带的程序直接实现了此算法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Finds the optimal single interior knot for a C^2 cubic regression spline\n    by minimizing the Residual Sum of Squares (RSS) over a discrete set of\n    candidate knots.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (x_data, y_data)\n    m1 = 11\n    x1 = np.linspace(0.0, 1.0, m1)\n    y1 = x1**3 + np.maximum(0, x1 - 0.5)**3\n    \n    m2 = 11\n    x2 = np.linspace(0.0, 1.0, m2)\n    y2 = x2**3 - 2 * x2\n\n    m3 = 12\n    x3 = np.array([0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.4, 0.55, 0.7, 0.85, 1.0])\n    y3 = 2 * x3**3 + 5 * np.maximum(0, x3 - 0.25)**3\n    \n    test_cases = [\n        (x1, y1),\n        (x2, y2),\n        (x3, y3),\n    ]\n\n    results = []\n    \n    # Absolute tolerance for comparing RSS values\n    tolerance = 1e-12\n\n    for x, y in test_cases:\n        m = len(x)\n        # Candidate knots are the interior data points\n        candidate_taus = x[1:-1]\n        \n        rss_results = []\n\n        for tau in candidate_taus:\n            # Construct the design matrix X for the current knot tau\n            # Columns: 1, x, x^2, x^3, (x-tau)_+^3\n            X = np.zeros((m, 5))\n            X[:, 0] = 1.0\n            X[:, 1] = x\n            X[:, 2] = x**2\n            X[:, 3] = x**3\n            X[:, 4] = np.maximum(0, x - tau)**3\n            \n            # Solve the least squares problem.\n            # np.linalg.lstsq returns:\n            # 1. coefficients (solution)\n            # 2. residuals (sum of squared residuals), an array\n            # 3. rank of the matrix\n            # 4. singular values of the matrix\n            # We only need the sum of squared residuals.\n            # rcond=None is specified to use the machine-precision-based default.\n            _, rss_array, _, _ = np.linalg.lstsq(X, y, rcond=None)\n            \n            # rss_array is empty if m  5. If it's not empty, it contains one value.\n            current_rss = rss_array[0] if rss_array.size > 0 else 0.0\n            \n            rss_results.append((current_rss, tau))\n\n        # Find the minimum RSS achieved\n        if not rss_results:\n            # This case should not happen with the given test data\n            # (m > 2, so interior points exist)\n            results.append(np.nan)\n            continue\n            \n        min_rss = min(res[0] for res in rss_results)\n        \n        # Identify all knots that achieve the minimum RSS within the tolerance\n        tied_taus = [tau for rss, tau in rss_results if rss = min_rss + tolerance]\n        \n        # Apply the tie-breaking rule: choose the smallest tau\n        optimal_tau = min(tied_taus)\n        \n        results.append(optimal_tau)\n\n    # Format the final output according to the problem specification\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}