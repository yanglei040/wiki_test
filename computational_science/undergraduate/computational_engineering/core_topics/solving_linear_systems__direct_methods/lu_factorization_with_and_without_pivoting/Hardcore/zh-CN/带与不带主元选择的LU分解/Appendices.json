{
    "hands_on_practices": [
        {
            "introduction": "掌握LU分解的第一步是理解不带主元选择的基本算法。本练习提供了一个具体的矩阵，要求你计算 $L$ 因子中的一个特定元素。通过这个练习，你将巩固高斯消元法的逐步过程，以及如何将乘数储存在 $L$ 矩阵中。",
            "id": "1027925",
            "problem": "对矩阵进行无主元LU分解：\n$$  \nA = \\begin{bmatrix}  \n1  2  3 \\\\  \n4  5  6 \\\\  \n7  8  10  \n\\end{bmatrix}  \n$$  \n其中 $A = LU$，$L$ 是对角线元素为1的下三角矩阵，$U$ 是上三角矩阵。求 $L$ 中第三行第二列的元素，记为 $l_{32}$。",
            "solution": "1. 将 $A=LU$ 写作\n   $L=\\begin{bmatrix} 1 & 0 & 0 \\\\ l_{21} & 1 & 0 \\\\ l_{31} & l_{32} & 1 \\end{bmatrix}$，$U=\\begin{bmatrix} u_{11} & u_{12} & u_{13} \\\\ 0 & u_{22} & u_{23} \\\\ 0 & 0 & u_{33} \\end{bmatrix}$。\n\n2. 根据 $A=LU$ 的第一行：\n   $u_{11}=a_{11}=1,\\quad u_{12}=a_{12}=2,\\quad u_{13}=a_{13}=3.$\n\n3. 根据 $A=LU$ 的第一列：\n   $l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{1}=4,\\quad\n    l_{31}=\\frac{a_{31}}{u_{11}}=\\frac{7}{1}=7.$\n\n4. 根据 $A=LU$ 的 $(2,2)$ 元素：\n   $u_{22}=a_{22}-l_{21}u_{12}=5-4\\cdot2=5-8=-3.$\n\n5. 根据 $A=LU$ 的 $(3,2)$ 元素：\n   $l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}\n           =\\frac{8-7\\cdot2}{-3}\n           =\\frac{8-14}{-3}\n           =\\frac{-6}{-3}\n           =2.$",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在掌握了基本技巧之后，理解其局限性至关重要。这个思想实验展示了一个标准LU分解算法因对角线上出现零而失败的情景。通过这个练习，你将明白为何主元选择不仅是一个可选项，更是保证分解算法稳健性的基本要求。",
            "id": "2407904",
            "problem": "一位经济学家正在为一个包含$3$个金融部门的典型化交叉风险敞口网络建模，其中每个部门的内生融资成本仅取决于其他部门的短期利率，而不取决于其自身的利率。这种刻意的建模选择对应于一种具有零自身效应的极端交叉依赖情况，这种情况可能在计价物标准化或有约束力的无自我借贷规则下出现。由此产生的线性系统表示为 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  1 \\\\\n1  0  1 \\\\\n1  1  0\n\\end{pmatrix},\n$$\n其中，对角线上的零元素代表不存在直接的自我依赖，而非对角线上的元素代表对称的交叉依赖。\n\n从高斯消元法和LU（Lower-Upper）分解的核心定义出发，解释为什么即使底层系统是适定的，不带主元选择的朴素LU分解对矩阵 $A$ 依然会失败。然后，仅使用行列式和消元法的基本性质，确定 $\\det(A)$ 的精确值。你的最终答案需要以精确形式表示，不得进行四舍五入。",
            "solution": "问题陈述是连贯的，在数学上是明确的，并且基于线性代数的标准原理。它在一个典型化经济模型中，就一个特定矩阵的性质提出了一组有效的问题。我们将着手进行分析。\n\n问题要求两件事：首先，解释为什么对给定矩阵 $A$ 进行不带主元选择的朴素LU（Lower-Upper）分解会失败；其次，使用基本原理计算 $A$ 的行列式。\n\n所讨论的矩阵是：\n$$\nA = \\begin{pmatrix}\n0  1  1 \\\\\n1  0  1 \\\\\n1  1  0\n\\end{pmatrix}\n$$\n\n第一部分：不带主元选择的朴素LU分解的失败\n\n矩阵 $A$ 的LU分解是寻找一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 使得 $A = LU$ 的过程。通常，$L$ 被限制为单位下三角矩阵，即其对角线元素全为 $1$。矩阵 $U$ 通过高斯消元过程得到，而矩阵 $L$ 则存储了用于在 $A$ 的下三角部分制造零的乘数。\n\n高斯消元算法通过使用对角线元素（称为主元）来消除每列中其下方的非零项。让我们对矩阵 $A$ 尝试此过程。\n\n第一步是使用主元 $a_{11}$ 来消除元素 $a_{21}$ 和 $a_{31}$。标准的行操作是：\n$R_2 \\rightarrow R_2 - l_{21} R_1$\n$R_3 \\rightarrow R_3 - l_{31} R_1$\n其中乘数为 $l_{21} = \\frac{a_{21}}{a_{11}}$ 和 $l_{31} = \\frac{a_{31}}{a_{11}}$。\n\n在我们的矩阵 $A$ 中，第一个主元是 $a_{11} = 0$。第一个乘数 $l_{21}$ 的计算需要以下操作：\n$$\nl_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1}{0}\n$$\n这个操作构成了除以零，这是一个未定义的数学运算。因此，标准的高斯消元算法无法通过第一步。由于朴素LU分解算法是此消元过程的直接实现，它从一开始就失败了。失败的原因恰恰是因为主元为零。在实践中，这个问题的解决方法是主元选择，它涉及行交换，以将一个非零元素置于主元位置。问题指明了是“朴素”分解，根据定义，这排除了此类主元选择策略。\n\n因此，尽管系统 $Ax=b$ 是适定的（我们将通过证明 $\\det(A) \\neq 0$ 来证实这一点），用于LU分解的朴素计算算法由于主元位置上出现零而失败。\n\n第二部分：使用基本性质计算 $\\det(A)$\n\n问题要求使用行列式在初等行变换下的性质来确定 $\\det(A)$。关键性质如下：\n1.  交换矩阵的两行，其行列式的值乘以 $-1$。\n2.  将一行的倍数加到另一行上，行列式的值不变。\n3.  上三角矩阵的行列式是其对角线元素的乘积。\n\n我们将把 $A$ 转换为上三角形式，并追踪行列式在此过程中的变化。\n$$\nA = \\begin{pmatrix}\n0  1  1 \\\\\n1  0  1 \\\\\n1  1  0\n\\end{pmatrix}\n$$\n如前所述，主元 $a_{11} = 0$ 是个问题。我们进行一次行交换，例如 $R_1 \\leftrightarrow R_2$。根据性质1，这会引入一个 $-1$ 的因子。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1  0  1 \\\\\n0  1  1 \\\\\n1  1  0\n\\end{pmatrix}\n$$\n新的主元是 $1$，非零。元素 $a_{21}$ 已经是 $0$。我们通过执行行操作 $R_3 \\rightarrow R_3 - R_1$ 来消除 $a_{31} = 1$。根据性质2，此操作不改变行列式的值。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1  0  1 \\\\\n0  1  1 \\\\\n1-1  1-0  0-1\n\\end{pmatrix}\n= - \\det \\begin{pmatrix}\n1  0  1 \\\\\n0  1  1 \\\\\n0  1  -1\n\\end{pmatrix}\n$$\n现在，我们使用第二个主元 $a_{22} = 1$ 来消除元素 $a_{32} = 1$。我们执行行操作 $R_3 \\rightarrow R_3 - R_2$。同样，这不会改变行列式的值。\n$$\n\\det(A) = - \\det \\begin{pmatrix}\n1  0  1 \\\\\n0  1  1 \\\\\n0-0  1-1  -1-1\n\\end{pmatrix}\n= - \\det \\begin{pmatrix}\n1  0  1 \\\\\n0  1  1 \\\\\n0  0  -2\n\\end{pmatrix}\n$$\n得到的矩阵是一个上三角矩阵，我们称之为 $U$。根据性质3，其行列式是对角线元素的乘积：\n$$\n\\det(U) = (1)(1)(-2) = -2\n$$\n因此，原矩阵 $A$ 的行列式为：\n$$\n\\det(A) = - \\det(U) = -(-2) = 2\n$$\n由于 $\\det(A) = 2 \\neq 0$，矩阵 $A$ 是可逆的，并且对于任何向量 $b$，线性系统 $Ax=b$都有唯一解。这证实了问题本身的论断，即底层系统是适定的，尽管朴素分解算法失败了。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "现在我们理解了主元选择的必要性，它为我们带来了 $P A = L U$ 形式，接下来让我们探索其威力。这个问题挑战你在不显式构造矩阵 $A$ 的情况下，利用给定的 $P$、$L$ 和 $U$ 因子求解一个相关但不同的系统 $A^{\\top} x = b$。这个练习展示了在计算实践中使用矩阵分解的高效性和优雅性。",
            "id": "2410733",
            "problem": "在计算工程中，LU (Lower-Upper) 分解（带行主元选择）通过一个置换矩阵和多个三角因子来表示一个矩阵，从而可以高效地求解线性系统。假设给定一个置换矩阵 $P \\in \\mathbb{R}^{n \\times n}$、一个单位下三角矩阵 $L \\in \\mathbb{R}^{n \\times n}$ 和一个上三角矩阵 $U \\in \\mathbb{R}^{n \\times n}$，对于一个未知的非奇异矩阵 $A \\in \\mathbb{R}^{n \\times n}$，它们满足 $P A = L U$。请仅使用置换矩阵、三角矩阵和转置的基本性质，推导出一个求解转置系统 $A^{\\top} x = b$ 的算法，而无需显式地构造 $A$ 或 $A^{\\top}$。您的推导必须从定义关系 $P A = L U$ 和恒等式 $P^{\\top} = P^{-1}$ 及 $\\left(X Y\\right)^{\\top} = Y^{\\top} X^{\\top}$ 开始，并且必须说明所用三角求解的顺序和类型。\n\n然后，将您推导的算法应用于下面的具体数据，并计算精确解向量 $x$：\n$$\nP = \\begin{pmatrix}\n0  0  1 \\\\\n0  1  0 \\\\\n1  0  0\n\\end{pmatrix}, \\quad\nL = \\begin{pmatrix}\n1  0  0 \\\\\n2  1  0 \\\\\n-1  3  1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n2  -1  1 \\\\\n0  3  4 \\\\\n0  0  5\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n1 \\\\ 2 \\\\ 3\n\\end{pmatrix}.\n$$\n在计算中不要显式构造 $A$ 或 $A^{\\top}$；仅使用 $P$、$L$、$U$ 和 $b$。请将最终答案表示为具有精确有理数分量的单个行向量。不需要四舍五入。",
            "solution": "问题陈述需要经过验证。\n\n**第 1 步：提取已知条件**\n-   一个置换矩阵 $P \\in \\mathbb{R}^{n \\times n}$。\n-   一个单位下三角矩阵 $L \\in \\mathbb{R}^{n \\times n}$。\n-   一个上三角矩阵 $U \\in \\mathbb{R}^{n \\times n}$。\n-   一个未知的非奇异矩阵 $A \\in \\mathbb{R}^{n \\times n}$。\n-   分解关系：$P A = L U$。\n-   待求解的线性方程组：$A^{\\top} x = b$。\n-   推导的约束条件：仅使用基本性质 $P^{\\top} = P^{-1}$ 和 $\\left(X Y\\right)^{\\top} = Y^{\\top} X^{\\top}$，且不显式构造 $A$ 或 $A^{\\top}$。\n-   $n=3$ 的具体数据：\n    $P = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix}$，$L = \\begin{pmatrix} 1  0  0 \\\\ 2  1  0 \\\\ -1  3  1 \\end{pmatrix}$，$U = \\begin{pmatrix} 2  -1  1 \\\\ 0  3  4 \\\\ 0  0  5 \\end{pmatrix}$，$b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n根据指定标准对问题进行分析。\n-   **科学依据：** 该问题植根于数值线性代数的基本原理，特别是带主元选择的 LU 分解，这是计算工程中的一种标准方法。该领域对这些性质和矩阵有明确的定义。\n-   **适定性：** 该问题是适定的。给定矩阵 $A$ 是非奇异的。因子 $L$ 和 $U$ 也是非奇异的（单位下三角矩阵 $L$ 的行列式为 $1$；$U$ 的行列式是其非零对角元素的乘积 $2 \\times 3 \\times 5 = 30$）。这保证了系统 $A^{\\top} x = b$ 存在唯一解 $x$。\n-   **客观性：** 问题使用精确、明确的数学语言和符号进行陈述。它不含任何主观或推测性内容。\n\n**第 3 步：结论与行动**\n问题是有效的。这是一个数值分析中标准的、定义明确的问题，可以通过严格的推导来解决。我们继续进行求解。\n\n**算法推导**\n目标是求解线性系统 $A^{\\top} x = b$ 以得到未知向量 $x$。出发点是给定的分解 $P A = L U$。\n\n首先，我们必须用给定的因子 $P$、$L$ 和 $U$ 来表示 $A^{\\top}$。从初始方程中，我们分离出 $A$：\n$$ P A = L U $$\n因为 $P$ 是一个置换矩阵，它的逆等于它的转置，即 $P^{-1} = P^{\\top}$。用 $P^{\\top}$ 左乘得到：\n$$ P^{\\top} P A = P^{\\top} L U $$\n$$ I A = P^{\\top} L U $$\n$$ A = P^{\\top} L U $$\n现在，我们对这个 $A$ 的表达式取转置。使用性质 $(XYZ)^{\\top} = Z^{\\top}Y^{\\top}X^{\\top}$，我们得到：\n$$ A^{\\top} = (P^{\\top} L U)^{\\top} = U^{\\top} L^{\\top} (P^{\\top})^{\\top} $$\n因为 $(P^{\\top})^{\\top} = P$，所以 $A^{\\top}$ 的表达式简化为：\n$$ A^{\\top} = U^{\\top} L^{\\top} P $$\n将此代入系统 $A^{\\top} x = b$：\n$$ (U^{\\top} L^{\\top} P) x = b $$\n为了求解这个关于 $x$ 的系统，我们引入中间向量。这样可以避免矩阵-矩阵乘法，并允许我们求解一系列更简单的系统。我们定义一个向量 $y$ 为：\n$$ y = P x $$\n将此代入方程得到：\n$$ U^{\\top} L^{\\top} y = b $$\n接下来，我们定义一个向量 $z$ 为：\n$$ z = L^{\\top} y $$\n代入得到：\n$$ U^{\\top} z = b $$\n这一系列的代换定义了一个求解 $x$ 的三步算法：\n\n1.  **求解 $z$**：求解系统 $U^{\\top} z = b$。由于 $U$ 是一个上三角矩阵，其转置 $U^{\\top}$ 是一个下三角矩阵。因此，该系统可以使用**前向替换法**高效求解。\n2.  **求解 $y$**：求解系统 $L^{\\top} y = z$。由于 $L$ 是一个单位下三角矩阵，其转置 $L^{\\top}$ 是一个单位上三角矩阵。该系统可以使用**后向替换法**高效求解。\n3.  **求解 $x$**：根据定义 $y = P x$，我们通过应用 $P$ 的逆来求 $x$：$x = P^{-1} y$。利用性质 $P^{-1} = P^{\\top}$，我们得到 $x = P^{\\top} y$。这最后一步是对向量 $y$ 的元素进行简单的置换。\n\n该算法在求解 $x$ 的过程中，从未显式计算矩阵 $A$ 或其转置 $A^{\\top}$。\n\n**应用于给定数据**\n我们现在将此算法应用于给定的矩阵和向量。\n给定的数据是：\n$$ P = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 1  0  0 \\\\ 2  1  0 \\\\ -1  3  1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2  -1  1 \\\\ 0  3  4 \\\\ 0  0  5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n我们需要 $U$、$L$ 和 $P$ 的转置：\n$$ U^{\\top} = \\begin{pmatrix} 2  0  0 \\\\ -1  3  0 \\\\ 1  4  5 \\end{pmatrix}, \\quad L^{\\top} = \\begin{pmatrix} 1  2  -1 \\\\ 0  1  3 \\\\ 0  0  1 \\end{pmatrix}, \\quad P^{\\top} = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix} $$\n**第 1 步：通过前向替换法求解 $U^{\\top} z = b$。**\n$$ \\begin{pmatrix} 2  0  0 \\\\ -1  3  0 \\\\ 1  4  5 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n从第一行：$2z_1 = 1 \\implies z_1 = \\frac{1}{2}$。\n从第二行：$-z_1 + 3z_2 = 2 \\implies -(\\frac{1}{2}) + 3z_2 = 2 \\implies 3z_2 = \\frac{5}{2} \\implies z_2 = \\frac{5}{6}$。\n从第三行：$z_1 + 4z_2 + 5z_3 = 3 \\implies \\frac{1}{2} + 4(\\frac{5}{6}) + 5z_3 = 3 \\implies \\frac{1}{2} + \\frac{10}{3} + 5z_3 = 3 \\implies \\frac{23}{6} + 5z_3 = 3 \\implies 5z_3 = 3 - \\frac{23}{6} = -\\frac{5}{6} \\implies z_3 = -\\frac{1}{6}$。\n因此，中间向量 $z$ 是 $z = \\begin{pmatrix} 1/2 \\\\ 5/6 \\\\ -1/6 \\end{pmatrix}$。\n\n**第 2 步：通过后向替换法求解 $L^{\\top} y = z$。**\n$$ \\begin{pmatrix} 1  2  -1 \\\\ 0  1  3 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 5/6 \\\\ -1/6 \\end{pmatrix} $$\n从第三行：$y_3 = -\\frac{1}{6}$。\n从第二行：$y_2 + 3y_3 = \\frac{5}{6} \\implies y_2 + 3(-\\frac{1}{6}) = \\frac{5}{6} \\implies y_2 - \\frac{1}{2} = \\frac{5}{6} \\implies y_2 = \\frac{5}{6} + \\frac{3}{6} = \\frac{8}{6} = \\frac{4}{3}$。\n从第一行：$y_1 + 2y_2 - y_3 = \\frac{1}{2} \\implies y_1 + 2(\\frac{4}{3}) - (-\\frac{1}{6}) = \\frac{1}{2} \\implies y_1 + \\frac{8}{3} + \\frac{1}{6} = \\frac{1}{2} \\implies y_1 + \\frac{16}{6} + \\frac{1}{6} = \\frac{3}{6} \\implies y_1 + \\frac{17}{6} = \\frac{3}{6} \\implies y_1 = \\frac{3-17}{6} = -\\frac{14}{6} = -\\frac{7}{3}$。\n因此，中间向量 $y$ 是 $y = \\begin{pmatrix} -7/3 \\\\ 4/3 \\\\ -1/6 \\end{pmatrix}$。\n\n**第 3 步：计算 $x = P^{\\top} y$。**\n$$ x = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix} \\begin{pmatrix} -7/3 \\\\ 4/3 \\\\ -1/6 \\end{pmatrix} = \\begin{pmatrix} -1/6 \\\\ 4/3 \\\\ -7/3 \\end{pmatrix} $$\n最终解向量 $x$ 包含所要求的精确有理数分量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{6}  \\frac{4}{3}  -\\frac{7}{3}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}