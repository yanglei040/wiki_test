{
    "hands_on_practices": [
        {
            "introduction": "In computational engineering, debugging is as critical a skill as writing code from scratch. This exercise challenges you to act as a code inspector, focusing on the fundamental principle of direct stiffness summation to find a specific correct value in a faulty global matrix . Mastering the mapping from an element's local stiffness matrix to the global matrix is the key to verifying any Finite Element Method (FEM) implementation.",
            "id": "2371849",
            "problem": "Consider a scalar diffusion problem on the unit square discretized for the Finite Element Method (FEM) using linear triangular elements. The mesh has nodes at coordinates $(0,0)$, $(1,0)$, $(1,1)$, and $(0,1)$, labeled as global nodes $1$, $2$, $3$, and $4$, respectively. The elements are defined by the connectivities $e_{1}=(1,2,3)$ and $e_{2}=(1,3,4)$. The local stiffness matrices (for unit, nondimensional conductivity and linear shape functions) are known to be\n$$\nK^{(1)}=\\begin{pmatrix}\n0.5 & -0.5 & 0 \\\\\n-0.5 & 1 & -0.5 \\\\\n0 & -0.5 & 0.5\n\\end{pmatrix},\n\\quad\nK^{(2)}=\\begin{pmatrix}\n0.5 & 0 & -0.5 \\\\\n0 & 0.5 & -0.5 \\\\\n-0.5 & -0.5 & 1\n\\end{pmatrix},\n$$\nwhere $K^{(1)}$ is ordered according to local nodes corresponding to global nodes $(1,2,3)$ and $K^{(2)}$ is ordered according to local nodes corresponding to global nodes $(1,3,4)$. An implementation produced the following assembled global stiffness matrix $\\tilde{K}$:\n$$\n\\tilde{K}=\\begin{pmatrix}\n1.0 & -0.5 & -0.5 & 0 \\\\\n-0.5 & 1.0 & -0.5 & 0 \\\\\n-0.5 & -0.5 & 1.5 & -0.5 \\\\\n0 & 0 & -0.5 & 0.5\n\\end{pmatrix}.\n$$\nAssuming $K^{(1)}$ and $K^{(2)}$ are correct and the only issue is a fault in the assembly procedure, determine the correct value of the global stiffness matrix entry $K_{1,4}$ that should result from a correct assembly using the given element connectivities and local stiffness matrices. Provide the answer as an exact number with no units.",
            "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. The provided local stiffness matrices, $K^{(1)}$ and $K^{(2)}$, have been verified to be correct for linear triangular elements on the specified geometries with unit, nondimensional conductivity. The task is to determine the correct value of the entry $K_{1,4}$ in the global stiffness matrix $K$.\n\nThe assembly of the global stiffness matrix in the Finite Element Method is based on the principle of direct stiffness summation. The global matrix $K$ is initialized as a zero matrix of size $N \\times N$, where $N$ is the total number of global nodes. In this problem, $N=4$. The contribution of each element's local stiffness matrix is then added to the global matrix. An entry $K_{I,J}$ of the global matrix is the sum of contributions from all element matrices $K^{(e)}$:\n$$\nK_{I,J} = \\sum_{e} K^{(e)}_{I,J}\n$$\nwhere $K^{(e)}_{I,J}$ is the contribution of element $e$ to the global entry at row $I$ and column $J$. A contribution $K^{(e)}_{I,J}$ is non-zero only if both global nodes $I$ and $J$ are part of the element $e$.\n\nWe are required to find the value of the specific entry $K_{1,4}$. We must examine the connectivity of each element to determine which elements contribute to this entry.\nThe elements are defined by the connectivities:\n1. Element $e_1$: Connects global nodes $(1, 2, 3)$.\n2. Element $e_2$: Connects global nodes $(1, 3, 4)$.\n\nAn element contributes to $K_{1,4}$ only if it contains both global node $1$ and global node $4$.\n- Element $e_1$ contains node $1$ but does not contain node $4$. Therefore, its contribution to the $K_{1,4}$ entry is zero.\n- Element $e_2$ contains both node $1$ and node $4$. Therefore, it is the only element that contributes to the $K_{1,4}$ entry.\n\nConsequently, the value of $K_{1,4}$ is determined solely by the contribution from element $e_2$. We must identify which entry of the local stiffness matrix $K^{(2)}$ corresponds to the global entry $K_{1,4}$.\n\nThe problem states that for element $e_2$, the local nodes are ordered according to the global nodes $(1, 3, 4)$. This defines the mapping from the local node indices (let us call them $i, j, k$) to the global node indices ($I, J, K$):\n- Local node $1$ $\\rightarrow$ Global node $1$\n- Local node $2$ $\\rightarrow$ Global node $3$\n- Local node $3$ $\\rightarrow$ Global node $4$\n\nThe local stiffness matrix for element $e_2$ is given as:\n$$\nK^{(2)} = \\begin{pmatrix} k^{(2)}_{11} & k^{(2)}_{12} & k^{(2)}_{13} \\\\ k^{(2)}_{21} & k^{(2)}_{22} & k^{(2)}_{23} \\\\ k^{(2)}_{31} & k^{(2)}_{32} & k^{(2)}_{33} \\end{pmatrix} = \\begin{pmatrix} 0.5 & 0 & -0.5 \\\\ 0 & 0.5 & -0.5 \\\\ -0.5 & -0.5 & 1 \\end{pmatrix}\n$$\nThe contribution to the global entry $K_{I,J}$ from element $e_2$ is the local entry $k^{(2)}_{ij}$, where local node $i$ maps to global node $I$ and local node $j$ maps to global node $J$.\n\nWe seek the contribution to $K_{1,4}$.\n- The global row index is $I=1$, which corresponds to local node $i=1$.\n- The global column index is $J=4$, which corresponds to local node $j=3$.\nTherefore, the contribution to $K_{1,4}$ is the local matrix entry $k^{(2)}_{1,3}$.\n\nFrom the given matrix $K^{(2)}$, the entry in the first row and third column is:\n$$\nk^{(2)}_{1,3} = -0.5\n$$\nSince element $e_2$ is the only element contributing to $K_{1,4}$, the correct value of this entry in the assembled global stiffness matrix is:\n$$\nK_{1,4} = k^{(2)}_{1,3} = -0.5\n$$\nThe provided faulty matrix $\\tilde{K}$ is irrelevant to the calculation of the correct value. The correct assembly procedure leads unambiguously to this result.",
            "answer": "$$\n\\boxed{-0.5}\n$$"
        },
        {
            "introduction": "A deep understanding of the assembly process goes beyond simply summing matrices; it involves recognizing the global stiffness matrix $K$ as a complete blueprint of the discretized system. This practice flips the typical assembly procedure on its head, asking you to work backwards from a given global matrix to deduce the underlying mesh connectivity . Solving this puzzle will solidify your understanding of how element contributions additively construct the global system.",
            "id": "2371858",
            "problem": "Consider a scalar, two-dimensional diffusion problem discretized by the Finite Element Method (FEM) using linear triangular elements, with one degree of freedom per global node. The finite element assembly rule states that the global stiffness matrix $K$ is obtained by summing element stiffness contributions into $K$ according to the element-to-global connectivity.\n\nA small mesh with $4$ global nodes has two triangular elements, $e_1$ and $e_2$. The local stiffness matrices $k^{e_1}$ and $k^{e_2}$ have already been computed from the weak form using standard linear shape functions but are provided to you numerically:\n$$\nk^{e_1} \\;=\\;\n\\begin{pmatrix}\n2 & -1 & -1 \\\\\n-1 & 1 & 0 \\\\\n-1 & 0 & 1\n\\end{pmatrix},\n\\qquad\nk^{e_2} \\;=\\;\n\\begin{pmatrix}\n3 & -2 & -1 \\\\\n-2 & 2 & 0 \\\\\n-1 & 0 & 1\n\\end{pmatrix}.\n$$\nThe connectivity of $e_1$ is fully known: its local nodes $\\{1,2,3\\}$ map to the global nodes $\\{1,2,3\\}$, respectively. The connectivity of $e_2$ is only partially known: its local nodes $\\{1,2,3\\}$ map to the global nodes $\\{2,\\;?,\\;4\\}$, respectively, where $?$ is an unknown global node index in $\\{1,2,3,4\\}$ that is distinct from $2$ and $4$.\n\nThe assembled global stiffness matrix $K \\in \\mathbb{R}^{4 \\times 4}$ is given as\n$$\nK \\;=\\;\n\\begin{pmatrix}\n4 & -3 & -1 & 0 \\\\\n-3 & 4 & 0 & -1 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & -1 & 0 & 1\n\\end{pmatrix}.\n$$\n\nUsing only the foundational FEM assembly principle derived from the weak form (namely, that $K$ is the sum of element stiffness matrices placed into $K$ according to the connectivity), and without introducing any unprovided formulas, deduce the missing global node index $?$ in the connectivity of $e_2$ that is consistent with the given $K$, $k^{e_1}$, $k^{e_2}$, and the known mapping of $e_1$.\n\nProvide your final answer as the single integer value of $?$ (no units). No rounding is required.",
            "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n**Step 1: Extracted Givens**\n- The problem is a scalar, two-dimensional diffusion problem discretized via the Finite Element Method (FEM) with linear triangular elements.\n- There is one degree of freedom per global node.\n- The global stiffness matrix $K$ is formed by the assembly of element stiffness matrices, $k^e$.\n- The mesh consists of $4$ global nodes and $2$ elements, $e_1$ and $e_2$.\n- The local stiffness matrix for element $e_1$ is:\n$$\nk^{e_1} =\n\\begin{pmatrix}\n2 & -1 & -1 \\\\\n-1 & 1 & 0 \\\\\n-1 & 0 & 1\n\\end{pmatrix}\n$$\n- The local stiffness matrix for element $e_2$ is:\n$$\nk^{e_2} =\n\\begin{pmatrix}\n3 & -2 & -1 \\\\\n-2 & 2 & 0 \\\\\n-1 & 0 & 1\n\\end{pmatrix}\n$$\n- The connectivity for $e_1$ maps local nodes $\\{1, 2, 3\\}$ to global nodes $\\{1, 2, 3\\}$, respectively.\n- The connectivity for $e_2$ maps local nodes $\\{1, 2, 3\\}$ to global nodes $\\{2, ?, 4\\}$, respectively, where $?$ is an integer from the set $\\{1, 3, 4\\}$. The problem statement implies $?$ must be distinct from $2$ and $4$, so $?$ must be in $\\{1,3\\}$.\n- The assembled global stiffness matrix $K$ is:\n$$\nK =\n\\begin{pmatrix}\n4 & -3 & -1 & 0 \\\\\n-3 & 4 & 0 & -1 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & -1 & 0 & 1\n\\end{pmatrix}\n$$\n- The objective is to determine the unknown global node index $?$.\n\n**Step 2: Validation of Problem Statement**\nThe problem is scientifically grounded, as it describes the standard assembly procedure in the Finite Element Method, a cornerstone of computational engineering. The provided element stiffness matrices are symmetric and singular (the sum of each row is zero), which is consistent with the physics of a diffusion problem before the application of boundary conditions. The problem is well-posed, providing sufficient information to deduce the single unknown value. The language is objective and precise. The problem does not violate any of the specified invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be derived.\n\nThe foundational principle of assembly in the Finite Element Method states that the global stiffness matrix $K$ is the algebraic sum of the individual element stiffness matrices, expanded and mapped to the global degrees of freedom. For the given system with two elements, this relationship is expressed as:\n$$K = K^{(1)} + K^{(2)}$$\nwhere $K^{(1)}$ and $K^{(2)}$ are the contributions of elements $e_1$ and $e_2$ to the global matrix, respectively. These are $4 \\times 4$ matrices in this case.\n\nThis relationship can be rearranged to isolate the contribution from element $e_2$:\n$$K^{(2)} = K - K^{(1)}$$\n\nFirst, we must construct $K^{(1)}$. The connectivity for element $e_1$ maps its local nodes $\\{1, 2, 3\\}$ to global nodes $\\{1, 2, 3\\}$. This means that the entries of the local matrix $k^{e_1}$ contribute to the corresponding entries of the global matrix $K$. Specifically, the $ij$-th entry of $k^{e_1}$ adds to the $IJ$-th entry of $K$, where $I$ is the global node corresponding to local node $i$ and $J$ is the global node corresponding to local node $j$.\nGiven $k^{e_1}$ and the connectivity map $\\{1, 2, 3\\} \\to \\{1, 2, 3\\}$, the matrix $K^{(1)}$ is formed by placing $k^{e_1}$ into the top-left $3 \\times 3$ submatrix of a $4 \\times 4$ zero matrix:\n$$\nk^{e_1} =\n\\begin{pmatrix}\n2 & -1 & -1 \\\\\n-1 & 1 & 0 \\\\\n-1 & 0 & 1\n\\end{pmatrix}\n\\quad \\implies \\quad\nK^{(1)} =\n\\begin{pmatrix}\n2 & -1 & -1 & 0 \\\\\n-1 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\n\nNext, we calculate $K^{(2)}$ by subtracting $K^{(1)}$ from the given global matrix $K$:\n$$\nK^{(2)} =\n\\begin{pmatrix}\n4 & -3 & -1 & 0 \\\\\n-3 & 4 & 0 & -1 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & -1 & 0 & 1\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n2 & -1 & -1 & 0 \\\\\n-1 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\nPerforming the matrix subtraction yields:\n$$\nK^{(2)} =\n\\begin{pmatrix}\n4-2 & -3-(-1) & -1-(-1) & 0-0 \\\\\n-3-(-1) & 4-1 & 0-0 & -1-0 \\\\\n-1-(-1) & 0-0 & 1-1 & 0-0 \\\\\n0-0 & -1-0 & 0-0 & 1-0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 & -2 & 0 & 0 \\\\\n-2 & 3 & 0 & -1 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 1\n\\end{pmatrix}\n$$\nThis matrix, $K^{(2)}$, represents the assembled contribution of element $e_2$. The non-zero entries of $K^{(2)}$ must correspond to the global nodes associated with element $e_2$. By inspecting the rows and columns of $K^{(2)}$, we observe non-zero entries associated with global nodes $1$, $2$, and $4$. The row and column corresponding to global node $3$ are entirely zero. Therefore, the set of global nodes for element $e_2$ must be $\\{1, 2, 4\\}$.\n\nThe problem states that the connectivity of $e_2$ maps its local nodes to the global nodes $\\{2, ?, 4\\}$. Comparing this with our deduced set of nodes $\\{1, 2, 4\\}$, it is a matter of logical necessity that the unknown node index $?$ must be $1$.\n\nTo verify this conclusion, we can perform the forward assembly of $k^{e_2}$ using the connectivity map $\\{2, 1, 4\\}$ for local nodes $\\{1, 2, 3\\}$ respectively, and check if the result matches our calculated $K^{(2)}$. The mapping is as follows:\n- Local node $1 \\to$ Global node $2$\n- Local node $2 \\to$ Global node $1$\n- Local node $3 \\to$ Global node $4$\n\nUsing the given $k^{e_2}$:\n$$\nk^{e_2} =\n\\begin{pmatrix}\n3 & -2 & -1 \\\\\n-2 & 2 & 0 \\\\\n-1 & 0 & 1\n\\end{pmatrix}\n$$\nThe contributions to the $4 \\times 4$ global matrix are:\n- $k^{e_2}_{11} = 3 \\to K_{22}$\n- $k^{e_2}_{12} = -2 \\to K_{21}$\n- $k^{e_2}_{13} = -1 \\to K_{24}$\n- $k^{e_2}_{21} = -2 \\to K_{12}$\n- $k^{e_2}_{22} = 2 \\to K_{11}$\n- $k^{e_2}_{23} = 0 \\to K_{14}$\n- $k^{e_2}_{31} = -1 \\to K_{42}$\n- $k^{e_2}_{32} = 0 \\to K_{41}$\n- $k^{e_2}_{33} = 1 \\to K_{44}$\n\nAssembling these contributions into a $4 \\times 4$ zero matrix results in:\n$$\n\\begin{pmatrix}\nk^{e_2}_{22} & k^{e_2}_{21} & 0 & k^{e_2}_{23} \\\\\nk^{e_2}_{12} & k^{e_2}_{11} & 0 & k^{e_2}_{13} \\\\\n0 & 0 & 0 & 0 \\\\\nk^{e_2}_{32} & k^{e_2}_{31} & 0 & k^{e_2}_{33}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 & -2 & 0 & 0 \\\\\n-2 & 3 & 0 & -1 \\\\\n0 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 1\n\\end{pmatrix}\n$$\nThis matrix is identical to the $K^{(2)}$ derived from $K - K^{(1)}$. The hypothesis that $? = 1$ is thus confirmed. Any other valid choice for $?$, such as $? = 3$, would result in a different matrix, which would contradict the given global matrix $K$. Therefore, the unknown global node index is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "This capstone exercise bridges theory and practice by guiding you through the implementation of a complete FEM solver for a composite structure. Starting from first principles, you will derive element stiffness matrices for different materials, assemble them into a global system, and solve for the physical displacements under a given load . This hands-on project demonstrates how the assembly process serves as the core engine for analyzing complex, heterogeneous materials.",
            "id": "2371824",
            "problem": "You are to write a complete program that assembles the global stiffness matrix for a two-dimensional linear elastic composite using the Finite Element Method (FEM) starting from the Principle of Virtual Work and the small-strain, linear isotropic constitutive law. Use plane stress kinematics. The objective is to compute displacement responses for a simple mesh where adjacent elements have different Young’s moduli that may differ by several orders of magnitude. All distances must be expressed in meters, forces in newtons, and stresses in pascals. Angles are not needed. All outputs must be expressed in meters.\n\nThe fundamental base you must use includes: (i) the Principle of Virtual Work for linear elasticity, (ii) the small-strain tensor definition for two dimensions, and (iii) the linear, isotropic plane stress constitutive relation. From these principles, you must derive the element stiffness and assemble the global stiffness matrix, then apply boundary conditions and loads to solve for displacements.\n\nDomain and mesh:\n- Consider a rectangular domain of size $L_x = 2$ meters and $L_y = 1$ meter, with constant thickness $t = 1$ meter (plane stress through-thickness assumption, but keep thickness for load equivalence).\n- Use the following nodal set with coordinates $(x_i,y_i)$ in meters:\n  - Node index $0$: $(0,0)$,\n  - Node index $1$: $(1,0)$,\n  - Node index $2$: $(2,0)$,\n  - Node index $3$: $(0,1)$,\n  - Node index $4$: $(1,1)$,\n  - Node index $5$: $(2,1)$.\n- Use four linear triangular elements with the following node connectivity (each triplet lists the indices of the nodes of the triangle):\n  - Element $0$: $(0,1,4)$,\n  - Element $1$: $(0,4,3)$,\n  - Element $2$: $(1,2,5)$,\n  - Element $3$: $(1,5,4)$.\n\nComposite material assignment:\n- Each triangle with centroid $x$-coordinate strictly less than $1$ meter uses material $E_1$; otherwise it uses material $E_2$.\n- Poisson’s ratio is uniform and equal to $\\nu = 0.3$ for all elements.\n\nLoading and boundary conditions:\n- Apply a uniform traction $\\mathbf{t} = (t_x,t_y)$ with $t_x = 10^6$ pascals and $t_y = 0$ on the boundary at $x = L_x$, i.e., along the edge between node indices $2$ and $5$. Treat this as a physical traction (force per area), and convert to equivalent nodal line loads using the standard consistent load approach by integrating along the edge and multiplying by the thickness $t$.\n- Impose homogeneous Dirichlet boundary conditions on the displacement components at all nodes with $x = 0$ meters (node indices $0$ and $3$): set $u_x = 0$ and $u_y = 0$ at those nodes.\n\nGoverning equations and discretization framework:\n- Start from the Principle of Virtual Work for linear elasticity in two dimensions and the small-strain definitions to obtain the bilinear form that defines the stiffness operator and the linear functional for Neumann boundary conditions. Use linear triangular elements with constant strain per element. For each element, compute the standard strain-displacement matrix $B$ and the plane stress elasticity matrix $D$ from the constitutive law with the element’s Young’s modulus and $\\nu$.\n- Assemble the global stiffness matrix $K$ by summing element contributions mapped by the element connectivity.\n- Assemble the global force vector $f$ by adding the consistent nodal forces from the applied traction on the boundary edge at $x = L_x$.\n\nSolution and requested outputs:\n- Enforce the Dirichlet boundary conditions by eliminating the prescribed degrees of freedom and solve the resulting linear system for the unknown displacement degrees of freedom.\n- For each test case listed below, compute the displacement magnitude at node index $5$ (the top-right corner at $(2,1)$ meters), i.e., $\\|\\mathbf{u}_5\\|_2 = \\sqrt{u_x^2 + u_y^2}$ in meters.\n\nTest suite:\n- Case $1$ (extreme contrast): $E_1 = 10^{12}$ pascals, $E_2 = 10^{6}$ pascals.\n- Case $2$ (moderate contrast): $E_1 = 10^{9}$ pascals, $E_2 = 10^{6}$ pascals.\n- Case $3$ (uniform reference): $E_1 = 10^{9}$ pascals, $E_2 = 10^{9}$ pascals.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in meters, for the three test cases in the order above. Use scientific notation with exactly $6$ significant digits for each float. For example, a valid output format is like `[1.234560e-03,4.321000e+00,5.000000e-02]`.",
            "solution": "The problem as stated is subjected to rigorous validation.\n\nStep 1: Extract Givens.\n\n- **Objective**: Assemble the global stiffness matrix for a 2D linear elastic composite using FEM, solve for displacements, and report the displacement magnitude at a specified node for three material cases.\n- **Fundamental Principles**: Principle of Virtual Work, 2D small-strain tensor, linear isotropic plane stress constitutive law.\n- **Domain**: Rectangle with $L_x = 2$ meters, $L_y = 1$ meter, and uniform thickness $t = 1$ meter.\n- **Nodal Coordinates**:\n  - Node $0$: $(0,0)$ m\n  - Node $1$: $(1,0)$ m\n  - Node $2$: $(2,0)$ m\n  - Node $3$: $(0,1)$ m\n  - Node $4$: $(1,1)$ m\n  - Node $5$: $(2,1)$ m\n- **Element Connectivity (Linear Triangles)**:\n  - Element $0$: $(0,1,4)$\n  - Element $1$: $(0,4,3)$\n  - Element $2$: $(1,2,5)$\n  - Element $3$: $(1,5,4)$\n- **Material Properties**:\n  - For elements with centroid $x$-coordinate < 1 m: Young's modulus $E_1$.\n  - For elements with centroid $x$-coordinate $\\ge 1$ m: Young's modulus $E_2$.\n  - Uniform Poisson's ratio $\\nu = 0.3$.\n- **Loading**: Uniform traction $\\mathbf{t} = (t_x, t_y)$ with $t_x = 10^6$ Pa and $t_y = 0$ Pa on the boundary at $x = L_x$ (edge between nodes $2$ and $5$). This is to be converted to consistent nodal loads.\n- **Boundary Conditions**: Homogeneous Dirichlet conditions ($u_x = 0$, $u_y = 0$) at all nodes where $x=0$ m (nodes $0$ and $3$).\n- **Requested Output**: For each test case, compute $\\|\\mathbf{u}_5\\|_2 = \\sqrt{u_x^2 + u_y^2}$ at node $5$.\n- **Test Cases**:\n  - Case $1$: $E_1 = 10^{12}$ Pa, $E_2 = 10^{6}$ Pa.\n  - Case $2$: $E_1 = 10^{9}$ Pa, $E_2 = 10^{6}$ Pa.\n  - Case $3$: $E_1 = 10^{9}$ Pa, $E_2 = 10^{9}$ Pa.\n\nStep 2: Validate Using Extracted Givens.\n\n- **Scientifically Grounded**: The problem is based on the established theory of linear elasticity and the Finite Element Method, which are core topics in computational engineering. All principles invoked are standard and correct.\n- **Well-Posed**: The problem is well-posed. The domain, mesh, material properties, loading, and boundary conditions are fully specified. The Dirichlet boundary conditions are sufficient to prevent rigid body motion, which ensures the existence of a unique solution.\n- **Objective**: The problem is formulated with precise, objective, and unambiguous language.\n- **Completeness and Consistency**: The problem is self-contained. All data required for the formulation and solution are provided. There are no contradictions in the given information. The units (SI) are consistent.\n- **Realism**: The geometry and loading are physically plausible. The material properties, while showing high contrast in one case, are within the realm of engineering materials (e.g., steel vs. a soft polymer). The high contrast is a valid test of the numerical method's robustness.\n\nStep 3: Verdict and Action.\n\nThe problem is deemed **valid**. It is a standard, well-defined exercise in computational mechanics. A complete, reasoned solution will now be provided.\n\nThe derivation and solution proceed from fundamental principles as required.\n\nThe weak form of the equilibrium equations for a linear elastic solid is given by the Principle of Virtual Work. Neglecting body forces, it states that for any kinematically admissible virtual displacement field $\\delta\\mathbf{u}$:\n$$\n\\int_V \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\, dV = \\int_{S_t} \\mathbf{t} \\cdot \\delta\\mathbf{u} \\, dS\n$$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\delta\\boldsymbol{\\varepsilon}$ is the virtual strain tensor corresponding to $\\delta\\mathbf{u}$, $\\mathbf{t}$ is the applied traction vector on the boundary portion $S_t$, and $V$ is the volume of the body.\n\nThe problem is analyzed under plane stress conditions. The displacement field $\\mathbf{u}(x,y) = [u_x(x,y), u_y(x,y)]^T$ is discretized over the domain, which is tessellated into finite elements. Within each element $e$, the displacement field is approximated using nodal displacements $\\mathbf{d}_e$ and shape functions collected in a matrix $\\mathbf{N}(x,y)$:\n$$\n\\mathbf{u}(x,y) \\approx \\mathbf{u}^h(x,y) = \\mathbf{N}(x,y) \\mathbf{d}_e\n$$\nFor a 3-node linear triangular element with nodes $i, j, k$, the element nodal displacement vector is $\\mathbf{d}_e = [u_{ix}, u_{iy}, u_{jx}, u_{jy}, u_{kx}, u_{ky}]^T$. The shape function matrix is:\n$$\n\\mathbf{N} = \\begin{bmatrix} N_i & 0 & N_j & 0 & N_k & 0 \\\\ 0 & N_i & 0 & N_j & 0 & N_k \\end{bmatrix}\n$$\nThe virtual displacement is similarly approximated as $\\delta\\mathbf{u} = \\mathbf{N} \\delta\\mathbf{d}_e$.\n\nThe small-strain tensor components, arranged in vector form for 2D analysis as $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$, are derived from the displacement field:\n$$\n\\boldsymbol{\\varepsilon} = \\begin{Bmatrix} \\partial u_x / \\partial x \\\\ \\partial u_y / \\partial y \\\\ \\partial u_x / \\partial y + \\partial u_y / \\partial x \\end{Bmatrix}\n$$\nSubstituting the discretized displacement field, we obtain the algebraic strain-displacement relationship:\n$$\n\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}_e\n$$\nwhere $\\mathbf{B}$ is the strain-displacement matrix. For a linear triangular element with nodes $(x_i,y_i)$, $(x_j,y_j)$, and $(x_k,y_k)$ in counter-clockwise order, $\\mathbf{B}$ is constant within the element and is given by:\n$$\n\\mathbf{B} = \\frac{1}{2A_e}\n\\begin{bmatrix}\ny_j-y_k & 0 & y_k-y_i & 0 & y_i-y_j & 0 \\\\\n0 & x_k-x_j & 0 & x_i-x_k & 0 & x_j-x_i \\\\\nx_k-x_j & y_j-y_k & x_i-x_k & y_k-y_i & x_j-x_i & y_i-y_j\n\\end{bmatrix}\n$$\nHere, $A_e$ is the area of the element. The virtual strain is $\\delta\\boldsymbol{\\varepsilon} = \\mathbf{B} \\delta\\mathbf{d}_e$.\n\nFor a linear, isotropic, elastic material under plane stress, the stress vector $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^T$ is related to the strain vector by the constitutive matrix $\\mathbf{D}$:\n$$\n\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}\n$$\nThe matrix $\\mathbf{D}$ is:\n$$\n\\mathbf{D} = \\frac{E}{1 - \\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\nwhere $E$ is the Young's modulus and $\\nu$ is the Poisson's ratio.\n\nSubstituting the discretized quantities into the Principle of Virtual Work and summing over all elements gives:\n$$\n\\sum_e \\int_{V_e} (\\mathbf{B} \\delta\\mathbf{d}_e)^T (\\mathbf{D} \\mathbf{B} \\mathbf{d}_e) \\, dV = \\sum_e \\int_{S_{te}} (\\mathbf{N} \\delta\\mathbf{d}_e)^T \\mathbf{t} \\, dS\n$$\nThis can be rewritten as:\n$$\n\\delta\\mathbf{d}^T \\left( \\sum_e \\mathbf{L}_e^T \\mathbf{K}_e \\mathbf{L}_e \\right) \\mathbf{d} = \\delta\\mathbf{d}^T \\left( \\sum_e \\mathbf{L}_e^T \\mathbf{f}_e \\right)\n$$\nwhere $\\mathbf{d}$ is the global displacement vector and $\\mathbf{L}_e$ is the connectivity operator that maps element degrees of freedom (DOFs) to global DOFs. Since this must hold for any arbitrary $\\delta\\mathbf{d}$, we obtain the global system of linear equations $\\mathbf{K}\\mathbf{d} = \\mathbf{f}$.\n\nThe element stiffness matrix $\\mathbf{K}_e$ is given by the volume integral:\n$$\n\\mathbf{K}_e = \\int_{V_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dV = t \\int_{A_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dA = t A_e \\mathbf{B}^T \\mathbf{D} \\mathbf{B}\n$$\nsince $\\mathbf{B}$, $\\mathbf{D}$, and thickness $t$ are constant within a linear triangular element.\n\nThe element consistent force vector $\\mathbf{f}_e$ due to traction $\\mathbf{t}$ on an edge of length $L$ is:\n$$\n\\mathbf{f}_e = \\int_{S_{te}} \\mathbf{N}^T \\mathbf{t} \\, dS = t \\int_L \\mathbf{N}^T \\mathbf{t} \\, dL\n$$\nFor a linear element edge connecting two nodes, the integral evaluates to distributing the total force on the edge, $F = t \\cdot L \\cdot \\text{traction}$, equally between the two nodes. In this problem, a traction $t_x = 10^6$ Pa is applied on the edge between nodes $2$ and $5$. The edge has length $L_{2-5} = 1$ m. The total force is $F_x = t_x \\cdot L_{2-5} \\cdot t = 10^6 \\text{ N/m}^2 \\cdot 1 \\text{ m} \\cdot 1 \\text{ m} = 10^6$ N. The consistent nodal forces are thus $f_{2x} = 5 \\times 10^5$ N and $f_{5x} = 5 \\times 10^5$ N. These are assembled into the global force vector $\\mathbf{f}$.\n\nThe global stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{f}$ are constructed by iterating over all elements, computing their respective $\\mathbf{K}_e$, and assembling them into the global system based on node connectivity.\n\nThe specified homogeneous Dirichlet boundary conditions at nodes $0$ and $3$ ($u_x=u_y=0$) are imposed by striking out the corresponding rows and columns from the global stiffness matrix and the corresponding entries from the force vector. This leads to a reduced system $\\mathbf{K}_{red} \\mathbf{d}_{red} = \\mathbf{f}_{red}$, which is solved for the unknown nodal displacements $\\mathbf{d}_{red}$.\n\nThe full displacement vector is then reconstructed, and the magnitude of displacement at node $5$, $\\|\\mathbf{u}_5\\|_2 = \\sqrt{u_{5x}^2 + u_{5y}^2}$, is computed for each test case.\nThe material properties for the elements are determined by their centroid locations.\n- Elements $0$ and $1$ have centroid $x$-coordinates of $2/3$ m and $1/3$ m, respectively. Both are < 1 m, so they use material $E_1$.\n- Elements $2$ and $3$ have centroid $x$-coordinates of $5/3$ m and $4/3$ m, respectively. Both are $\\ge 1$ m, so they use material $E_2$.\n\nThe solution proceeds by implementing this procedure numerically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 2D linear elasticity problem using the Finite Element Method.\n    \"\"\"\n    \n    # Define problem parameters\n    nodes = np.array([\n        [0.0, 0.0], [1.0, 0.0], [2.0, 0.0],\n        [0.0, 1.0], [1.0, 1.0], [2.0, 1.0]\n    ])\n    \n    elements = np.array([\n        [0, 1, 4], [0, 4, 3],\n        [1, 2, 5], [1, 5, 4]\n    ])\n    \n    nu = 0.3  # Poisson's ratio\n    thickness = 1.0  # meters\n    traction_x = 1e6  # Pascals\n    \n    # Define test cases\n    test_cases = [\n        (1e12, 1e6), # Case 1\n        (1e9, 1e6),  # Case 2\n        (1e9, 1e9)   # Case 3\n    ]\n    \n    results = []\n\n    for E1, E2 in test_cases:\n        \n        n_nodes = nodes.shape[0]\n        n_dofs = 2 * n_nodes\n        \n        K = np.zeros((n_dofs, n_dofs))\n        f = np.zeros(n_dofs)\n        \n        # Assemble global stiffness matrix K\n        for elem_nodes in elements:\n            # Determine material properties for the element\n            coords = nodes[elem_nodes]\n            centroid_x = np.mean(coords[:, 0])\n            \n            E = E1 if centroid_x  1.0 else E2\n            \n            # Constitutive matrix D for plane stress\n            D_factor = E / (1.0 - nu**2)\n            D = D_factor * np.array([\n                [1.0, nu, 0.0],\n                [nu, 1.0, 0.0],\n                [0.0, 0.0, (1.0 - nu) / 2.0]\n            ])\n            \n            # Strain-displacement matrix B for linear triangle\n            (x1, y1), (x2, y2), (x3, y3) = coords[0], coords[1], coords[2]\n            \n            # Area of the element\n            # Using the determinant formula for area of a triangle\n            # The node ordering is consistently CCW, so area is positive\n            area = 0.5 * ((x2 - x1) * (y3 - y1) - (x3 - x1) * (y2 - y1))\n\n            B = (1.0 / (2.0 * area)) * np.array([\n                [y2 - y3, 0,       y3 - y1, 0,       y1 - y2, 0      ],\n                [0,       x3 - x2, 0,       x1 - x3, 0,       x2 - x1],\n                [x3 - x2, y2 - y3, x1 - x3, y3 - y1, x2 - x1, y1 - y2]\n            ])\n            \n            # Element stiffness matrix\n            Ke = thickness * area * (B.T @ D @ B)\n            \n            # Assemble Ke into K\n            dof_indices = []\n            for node_idx in elem_nodes:\n                dof_indices.extend([2 * node_idx, 2 * node_idx + 1])\n            \n            # Use np.ix_ for convenient submatrix assignment\n            K[np.ix_(dof_indices, dof_indices)] += Ke\n\n        # Assemble global force vector f\n        edge_len_2_5 = np.linalg.norm(nodes[5] - nodes[2])\n        total_force = traction_x * edge_len_2_5 * thickness\n        \n        # Distribute force to nodes 2 and 5 (consistent nodal loads for linear element)\n        f[2 * 2] += total_force / 2.0  # Force on node 2 in x-direction\n        f[2 * 5] += total_force / 2.0  # Force on node 5 in x-direction\n        \n        # Apply boundary conditions\n        prescribed_dofs = [0, 1, 6, 7] # DOFs for nodes 0 (0,1) and 3 (6,7)\n        all_dofs = np.arange(n_dofs)\n        free_dofs = np.setdiff1d(all_dofs, prescribed_dofs)\n        \n        # Solve for unknown displacements\n        K_reduced = K[np.ix_(free_dofs, free_dofs)]\n        f_reduced = f[free_dofs]\n        \n        u_reduced = np.linalg.solve(K_reduced, f_reduced)\n        \n        # Reconstruct full displacement vector\n        u = np.zeros(n_dofs)\n        u[free_dofs] = u_reduced\n        \n        # Calculate displacement magnitude at node 5\n        u5x, u5y = u[10], u[11]\n        disp_magnitude = np.sqrt(u5x**2 + u5y**2)\n        \n        results.append(disp_magnitude)\n\n    # Format output according to specification\n    formatted_results = [f\"{res:.6e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}