{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering the finite element method (FEM) is to build a deep intuition for the weak, or variational, formulation of a boundary value problem. This exercise guides you through the process using the Method of Manufactured Solutions, a standard technique for verifying the correctness of a numerical code. By starting with a known \"manufactured\" solution, you will work backward to derive the consistent source terms and boundary data, forcing you to engage directly with the integration-by-parts procedure that distinguishes essential from natural boundary conditions . This practice is invaluable for understanding precisely how Dirichlet, Neumann, and Robin conditions are incorporated into the FEM framework.",
            "id": "2544251",
            "problem": "Let $\\Omega = (0,1)\\times(0,1)$ be the unit square with boundary $\\partial\\Omega$ partitioned into three disjoint segments for an elliptic scalar diffusion model in the context of the finite element method (FEM) applied to a second-order partial differential equation (PDE). Consider the strong form\n$$-\\nabla\\cdot\\big(k(x,y)\\nabla u(x,y)\\big) = f(x,y)\\quad\\text{in }\\Omega,$$\nwith a manufactured choice of unknown and coefficient\n$$u(x,y) = \\exp(x)\\big(\\sin(\\pi y)+y^2\\big),\\qquad k(x,y) = 1+xy.$$\nImpose mixed boundary types on different boundary segments as follows:\n- Essential (Dirichlet) boundary $\\Gamma_D = \\{(x,0): 0<x<1\\}\\cup\\{(0,y): 0<y<1\\}$ with $u=g$.\n- Natural (Neumann) boundary $\\Gamma_N = \\{(x,1): 0<x<1\\}$ with outward unit normal $n=(0,1)$ and flux $q = n\\cdot(k\\nabla u)$ prescribed.\n- Robin boundary $\\Gamma_R = \\{(1,y): 0<y<1\\}$ with outward unit normal $n=(1,0)$ and condition $n\\cdot(k\\nabla u)+\\alpha u = h$, where the Robin parameter is chosen as $\\alpha(y)=1+y$ on $\\Gamma_R$.\n\nTasks:\n1. Starting from the strong form and using the divergence theorem, derive the weak form associated with the above model and classify which boundary conditions are essential versus natural within the FEM framework. Justify why Dirichlet data are enforced on the trial space, while Neumann and Robin data appear in the boundary integrals of the weak form.\n2. Using the given manufactured $u$ and $k$, compute consistent data $f$ in $\\Omega$, $g$ on $\\Gamma_D$, $q$ on $\\Gamma_N$, and $h$ on $\\Gamma_R$ (with the given $\\alpha$), so that the manufactured $u$ exactly satisfies the PDE and boundary conditions. Provide explicit expressions for $f$, $g$, $q$, and $h$.\n3. Provide the final simplified closed-form analytic expression for $f(x,y)$. This final expression is the answer to be graded. No rounding is required, and no units are necessary.\n\nYour final answer must be a single closed-form analytic expression for $f(x,y)$.",
            "solution": "The problem presented is a well-posed exercise in the framework of the finite element method, requiring the derivation of the weak form of a given partial differential equation and the calculation of consistent data for a manufactured solution. We shall proceed with the required tasks in sequence.\n\nFirst, we address the derivation of the weak formulation and the classification of the boundary conditions. The strong form of the problem is given by the second-order elliptic partial differential equation:\n$$-\\nabla\\cdot\\big(k(x,y)\\nabla u(x,y)\\big) = f(x,y) \\quad \\text{in } \\Omega$$\nTo derive the weak form, we multiply the PDE by an arbitrary test function $v$, which belongs to a suitable function space, and integrate over the domain $\\Omega$:\n$$\\int_{\\Omega} -\\nabla\\cdot(k\\nabla u) v \\,d\\Omega = \\int_{\\Omega} f v \\,d\\Omega$$\nWe apply the divergence theorem to the left-hand side. The divergence theorem in this context is often stated as Green's first identity: $\\int_{\\Omega} \\mathbf{F} \\cdot \\nabla v \\, d\\Omega = -\\int_{\\Omega} (\\nabla \\cdot \\mathbf{F}) v \\, d\\Omega + \\oint_{\\partial\\Omega} (\\mathbf{F} \\cdot \\mathbf{n}) v \\, dS$. Let $\\mathbf{F} = k\\nabla u$. This gives:\n$$\\int_{\\Omega} k\\nabla u \\cdot \\nabla v \\,d\\Omega - \\oint_{\\partial\\Omega} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Omega} f v \\,d\\Omega$$\nRearranging the terms, we obtain the general variational form:\n$$\\int_{\\Omega} k\\nabla u \\cdot \\nabla v \\,d\\Omega = \\int_{\\Omega} f v \\,d\\Omega + \\oint_{\\partial\\Omega} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS$$\nThe boundary integral is partitioned according to the given boundary segments $\\partial\\Omega = \\Gamma_D \\cup \\Gamma_N \\cup \\Gamma_R$:\n$$\\oint_{\\partial\\Omega} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Gamma_D} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS + \\int_{\\Gamma_N} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS + \\int_{\\Gamma_R} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS$$\nNow we incorporate the boundary conditions and define the appropriate function spaces. The trial function $u$ must belong to a space of functions with at least one square-integrable derivative, typically the Sobolev space $H^1(\\Omega)$. The test function $v$ belongs to a related space.\n\nThe Dirichlet condition $u=g$ on $\\Gamma_D$ is an **essential** boundary condition. In the finite element method, such conditions are imposed directly on the space of trial functions. We define the trial space $S = \\{ u \\in H^1(\\Omega) \\mid u|_{\\Gamma_D} = g \\}$ and the test space $V_0 = \\{ v \\in H^1(\\Omega) \\mid v|_{\\Gamma_D} = 0 \\}$. By requiring $v=0$ on $\\Gamma_D$, the integral over $\\Gamma_D$ vanishes: $\\int_{\\Gamma_D} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = 0$. This is why the condition is termed essential: it is a fundamental constraint on the function space itself, and the test functions are constructed to respect this constraint.\n\nThe Neumann condition, $k\\nabla u \\cdot \\mathbf{n} = q$ on $\\Gamma_N$, and the Robin condition, $k\\nabla u \\cdot \\mathbf{n} + \\alpha u = h$ on $\\Gamma_R$, are **natural** boundary conditions. They arise \"naturally\" from the integration-by-parts procedure and are incorporated into the weak form. We substitute these conditions into the remaining boundary integrals:\n- On $\\Gamma_N$: $\\int_{\\Gamma_N} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Gamma_N} q v \\,dS$.\n- On $\\Gamma_R$: $k\\nabla u \\cdot \\mathbf{n} = h - \\alpha u$. Thus, $\\int_{\\Gamma_R} (k\\nabla u \\cdot \\mathbf{n}) v \\,dS = \\int_{\\Gamma_R} (h-\\alpha u) v \\,dS = \\int_{\\Gamma_R} h v \\,dS - \\int_{\\Gamma_R} \\alpha u v \\,dS$.\n\nSubstituting these into the variational form and moving all terms involving the unknown $u$ to the left-hand side, we obtain the final weak form:\nFind $u \\in S$ such that for all $v \\in V_0$:\n$$ \\int_{\\Omega} k\\nabla u \\cdot \\nabla v \\,d\\Omega + \\int_{\\Gamma_R} \\alpha u v \\,dS = \\int_{\\Omega} f v \\,d\\Omega + \\int_{\\Gamma_N} q v \\,dS + \\int_{\\Gamma_R} h v \\,dS $$\nThe Neumann and Robin data ($q$ and $h$) appear in the linear functional on the right-hand side, while the Robin term $\\alpha u$ contributes to the bilinear form on the left-hand side. These conditions are satisfied in a weak, integral sense, rather than pointwise, which is why they are called natural.\n\nSecond, we compute the consistent data $f,g,q,h$ for the manufactured solution $u(x,y) = \\exp(x)(\\sin(\\pi y)+y^2)$ and coefficient $k(x,y)=1+xy$.\n\n1.  **Source Term $f(x,y)$**:\n    $f = -\\nabla\\cdot(k\\nabla u)$. We first compute the gradient of $u$:\n    $$ \\frac{\\partial u}{\\partial x} = \\exp(x)(\\sin(\\pi y)+y^2) $$\n    $$ \\frac{\\partial u}{\\partial y} = \\exp(x)(\\pi \\cos(\\pi y)+2y) $$\n    The flux vector is $\\mathbf{j} = -k\\nabla u$. The source is $f = \\nabla \\cdot \\mathbf{j}$ but the problem defines $f = -\\nabla\\cdot(k\\nabla u)$, so we compute $\\nabla\\cdot(k\\nabla u) = \\frac{\\partial}{\\partial x}(k u_x) + \\frac{\\partial}{\\partial y}(k u_y)$.\n    $$ \\frac{\\partial}{\\partial x}(k u_x) = \\frac{\\partial}{\\partial x}\\big[ (1+xy)\\exp(x)(\\sin(\\pi y)+y^2) \\big] = (y)\\exp(x)(\\sin(\\pi y)+y^2) + (1+xy)\\exp(x)(\\sin(\\pi y)+y^2) = (1+y+xy)\\exp(x)(\\sin(\\pi y)+y^2) $$\n    $$ \\frac{\\partial}{\\partial y}(k u_y) = \\frac{\\partial}{\\partial y}\\big[ (1+xy)\\exp(x)(\\pi \\cos(\\pi y)+2y) \\big] = \\exp(x) \\big[ (x)(\\pi \\cos(\\pi y)+2y) + (1+xy)(-\\pi^2\\sin(\\pi y)+2) \\big] $$\n    Summing these and multiplying by $-1$ gives $f(x,y)$:\n    $$ f(x,y) = -\\exp(x) \\left[ (1+y+xy)(\\sin(\\pi y)+y^2) + x(\\pi \\cos(\\pi y)+2y) + (1+xy)(2-\\pi^2\\sin(\\pi y)) \\right] $$\n    Upon simplification by expanding and grouping terms:\n    $$ f(x,y) = -\\exp(x) \\left\\{ \\big[1+y-\\pi^2 + (1-\\pi^2)xy\\big]\\sin(\\pi y) + \\pi x \\cos(\\pi y) + (1+x)y^3 + y^2 + 4xy + 2 \\right\\} $$\n\n2.  **Dirichlet Data $g$ on $\\Gamma_D$**: $\\Gamma_D = \\{(x,0): 0<x<1\\}\\cup\\{(0,y): 0<y<1\\}$\n    -   On $\\{(x,0)\\}$, we set $y=0$: $g(x,0) = u(x,0) = \\exp(x)(\\sin(0)+0^2) = 0$.\n    -   On $\\{(0,y)\\}$, we set $x=0$: $g(0,y) = u(0,y) = \\exp(0)(\\sin(\\pi y)+y^2) = \\sin(\\pi y)+y^2$.\n\n3.  **Neumann Data $q$ on $\\Gamma_N$**: $\\Gamma_N = \\{(x,1): 0<x<1\\}$, $n=(0,1)$.\n    $q = n\\cdot(k\\nabla u) = k \\frac{\\partial u}{\\partial y}$. We evaluate this at $y=1$:\n    $$ k(x,1) = 1+x $$\n    $$ \\frac{\\partial u}{\\partial y}(x,1) = \\exp(x)(\\pi \\cos(\\pi)+2) = \\exp(x)(2-\\pi) $$\n    $$ q(x,1) = (1+x)\\exp(x)(2-\\pi) $$\n\n4.  **Robin Data $h$ on $\\Gamma_R$**: $\\Gamma_R = \\{(1,y): 0<y<1\\}$, $n=(1,0)$, $\\alpha(y)=1+y$.\n    $h = n\\cdot(k\\nabla u) + \\alpha u = k \\frac{\\partial u}{\\partial x} + \\alpha u$. We evaluate this at $x=1$:\n    $$ k(1,y) = 1+y $$\n    $$ \\frac{\\partial u}{\\partial x}(1,y) = \\exp(1)(\\sin(\\pi y)+y^2) $$\n    $$ u(1,y) = \\exp(1)(\\sin(\\pi y)+y^2) $$\n    The flux term is $k \\frac{\\partial u}{\\partial x} = (1+y)\\exp(1)(\\sin(\\pi y)+y^2)$.\n    The reaction term is $\\alpha u = (1+y)\\exp(1)(\\sin(\\pi y)+y^2)$.\n    $$ h(1,y) = (1+y)\\exp(1)(\\sin(\\pi y)+y^2) + (1+y)\\exp(1)(\\sin(\\pi y)+y^2) = 2(1+y)\\exp(1)(\\sin(\\pi y)+y^2) $$\n\nThird, the problem requires the final simplified closed-form analytic expression for $f(x,y)$, which was derived above and constitutes the final answer.",
            "answer": "$$\n\\boxed{-\\exp(x) \\left\\{ \\left[1+y-\\pi^2 + (1-\\pi^2)xy\\right]\\sin(\\pi y) + \\pi x \\cos(\\pi y) + (1+x)y^3 + y^2 + 4xy + 2 \\right\\}}\n$$"
        },
        {
            "introduction": "Now that you have seen how different boundary conditions are incorporated into the weak form, let's explore a critical, practical consequence of this distinction. In computational engineering, the accuracy of a simulation can be dramatically affected by the behavior of the solution near geometric singularities like sharp corners. This exercise demonstrates that the smoothness of the solution depends not just on the corner's angle, but on the *types* of boundary conditions applied on the adjacent edges. By calculating the singularity exponent for different combinations of essential (Dirichlet) and natural (Neumann) conditions, you will discover when to expect a well-behaved solution and when to anticipate a singular gradient that demands special care in meshing and analysis .",
            "id": "2389711",
            "problem": "Consider the planar wedge domain in polar coordinates $\\Omega_{\\alpha} = \\{(r,\\theta)\\,:\\, 0 < r < 1,\\; 0 < \\theta < \\alpha\\}$, where $\\alpha \\in (0,2\\pi)$. Let $u(r,\\theta)$ solve the Laplace equation $\\Delta u = 0$ in $\\Omega_{\\alpha}$, where $\\Delta$ denotes the Laplacian in two dimensions. The two straight edges of the wedge are the rays $\\theta = 0$ and $\\theta = \\alpha$. On each edge, impose either an essential (Dirichlet) boundary condition $u=0$ or a natural (Neumann) boundary condition $\\partial u / \\partial n = 0$, where $n$ denotes the outward unit normal on the boundary.\n\nFor each configuration, define the corner singularity exponent $\\lambda_{\\min}(\\alpha,\\text{BC})$ to be the smallest positive real number $\\lambda > 0$ such that there exists a nontrivial harmonic solution in $\\Omega_{\\alpha}$ obeying the prescribed boundary conditions and having leading-order corner behavior of order $r^{\\lambda}$ as $r \\to 0^{+}$. Use this exponent to determine whether the gradient magnitude $\\|\\nabla u\\|$ is unbounded at the corner as $r \\to 0^{+}$. Classify the singularity using the indicator\n- $\\text{is\\_singular} = \\text{True}$ if $\\lambda_{\\min}(\\alpha,\\text{BC}) < 1$, and $\\text{False}$ otherwise,\nand quantify the blow-up rate of the gradient by the exponent\n- $b = \\max(0, 1 - \\lambda_{\\min}(\\alpha,\\text{BC}))$, in the sense that $\\|\\nabla u\\|$ behaves like $C\\, r^{-b}$ as $r \\to 0^{+}$ for some constant $C \\neq 0$ when $b > 0$.\n\nYour task is to write a complete, runnable program that, for each test case specified below, computes and returns the triple $[\\lambda_{\\min}, \\text{is\\_singular}, b]$.\n\nTest Suite (angles are in radians):\n- Case $1$: $\\alpha = \\dfrac{3\\pi}{2}$ with boundary conditions $\\text{Dirichlet}/\\text{Dirichlet}$ on $\\theta=0$ and $\\theta=\\alpha$.\n- Case $2$: $\\alpha = \\dfrac{3\\pi}{2}$ with boundary conditions $\\text{Neumann}/\\text{Neumann}$ on $\\theta=0$ and $\\theta=\\alpha$.\n- Case $3$: $\\alpha = \\dfrac{3\\pi}{2}$ with boundary conditions $\\text{Dirichlet}/\\text{Neumann}$ on $\\theta=0$ and $\\theta=\\alpha$.\n- Case $4$: $\\alpha = \\pi$ with boundary conditions $\\text{Dirichlet}/\\text{Dirichlet}$ on $\\theta=0$ and $\\theta=\\alpha$.\n- Case $5$: $\\alpha = \\dfrac{3\\pi}{4}$ with boundary conditions $\\text{Dirichlet}/\\text{Dirichlet}$ on $\\theta=0$ and $\\theta=\\alpha$.\n- Case $6$: $\\alpha = \\dfrac{7\\pi}{4}$ with boundary conditions $\\text{Dirichlet}/\\text{Neumann}$ on $\\theta=0$ and $\\theta=\\alpha$.\n- Case $7$: $\\alpha = \\dfrac{4\\pi}{3}$ with boundary conditions $\\text{Neumann}/\\text{Neumann}$ on $\\theta=0$ and $\\theta=\\alpha$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above.\n- Each case’s result must itself be a list in the form $[\\lambda_{\\min}, \\text{is\\_singular}, b]$, where $\\lambda_{\\min}$ and $b$ are floating-point numbers and $\\text{is\\_singular}$ is a boolean.\n- Concretely, the output must look like $[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],\\ldots]$ with no extra text before or after the list.",
            "solution": "The problem presented is valid, scientifically grounded, and well-posed. It addresses a classical topic in the theory of elliptic partial differential equations—the regularity of solutions near corners of the domain. This analysis is fundamental in computational engineering for designing accurate numerical methods, such as the finite element method, particularly in the context of adaptive mesh refinement.\n\nThe governing equation is the two-dimensional Laplace equation, $\\Delta u = 0$. In polar coordinates $(r, \\theta)$, this equation is:\n$$\n\\Delta u = \\frac{\\partial^2 u}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial u}{\\partial r} + \\frac{1}{r^2} \\frac{\\partial^2 u}{\\partial \\theta^2} = 0\n$$\nWe seek solutions in the wedge domain $\\Omega_{\\alpha} = \\{(r,\\theta)\\,:\\, 0 < r < 1,\\; 0 < \\theta < \\alpha\\}$. To analyze the behavior of the solution near the corner at $r=0$, we employ the method of separation of variables. We look for non-trivial solutions of the form $u(r,\\theta) = R(r)\\Theta(\\theta)$. Substituting this into the Laplace equation and rearranging terms yields:\n$$\n\\frac{r^2 R''(r) + r R'(r)}{R(r)} = - \\frac{\\Theta''(\\theta)}{\\Theta(\\theta)}\n$$\nSince the left side depends only on $r$ and the right side only on $\\theta$, both must equal a separation constant, which we denote by $\\mu$. This gives two ordinary differential equations:\n$$\n\\Theta''(\\theta) + \\mu \\Theta(\\theta) = 0\n$$\n$$\nr^2 R''(r) + r R'(r) - \\mu R(r) = 0\n$$\nFor the angular part, to have non-trivial solutions satisfying the homogeneous boundary conditions, we need oscillatory behavior, which requires the constant to be positive. We set $\\mu = \\lambda^2$ with $\\lambda > 0$. The angular equation becomes $\\Theta''(\\theta) + \\lambda^2 \\Theta(\\theta) = 0$, with the general solution:\n$$\n\\Theta(\\theta) = A \\cos(\\lambda\\theta) + B \\sin(\\lambda\\theta)\n$$\nThe radial equation is a Cauchy-Euler equation, $r^2 R'' + r R' - \\lambda^2 R = 0$, with general solution $R(r) = c_1 r^{\\lambda} + c_2 r^{-\\lambda}$. We are investigating solutions that have the form $r^{\\lambda}$ for positive $\\lambda$ as $r \\to 0^{+}$, so we focus on the $r^{\\lambda}$ term.\n\nThe coefficients $A$, $B$, and the permissible values of $\\lambda$ are determined by the boundary conditions on the straight edges $\\theta=0$ and $\\theta=\\alpha$. The problem specifies either essential (Dirichlet) or natural (Neumann) conditions.\n- A Dirichlet condition $u=0$ on a ray $\\theta = \\theta_0$ implies $\\Theta(\\theta_0) = 0$.\n- A Neumann condition $\\partial u / \\partial n = 0$ on a ray $\\theta = \\theta_0$ requires careful interpretation. The outward unit normal $\\vec{n}$ is orthogonal to the ray. In polar coordinates, this means $\\vec{n}$ is in the $\\pm \\hat{e}_{\\theta}$ direction. The gradient is $\\nabla u = \\frac{\\partial u}{\\partial r}\\hat{e}_r + \\frac{1}{r}\\frac{\\partial u}{\\partial \\theta}\\hat{e}_{\\theta}$. The normal derivative is thus $\\frac{\\partial u}{\\partial n} = \\nabla u \\cdot \\vec{n} = \\pm \\frac{1}{r}\\frac{\\partial u}{\\partial \\theta}$. The condition $\\partial u / \\partial n = 0$ is therefore equivalent to $\\frac{\\partial u}{\\partial \\theta} = 0$ on that ray, which implies $\\Theta'(\\theta_0) = 0$.\n\nWe analyze the four configurations of boundary conditions:\n\n1.  **Dirichlet/Dirichlet (DD)**: $u=0$ on $\\theta=0$ and $\\theta=\\alpha$.\n    - $\\Theta(0) = 0 \\implies A\\cos(0) + B\\sin(0) = A = 0$.\n    - The solution becomes $\\Theta(\\theta) = B\\sin(\\lambda\\theta)$.\n    - $\\Theta(\\alpha) = 0 \\implies B\\sin(\\lambda\\alpha) = 0$. For a non-trivial solution ($B \\neq 0$), we need $\\sin(\\lambda\\alpha) = 0$.\n    - This gives $\\lambda\\alpha = k\\pi$ for $k \\in \\{1, 2, 3, \\ldots\\}$. The smallest positive exponent is for $k=1$, so $\\lambda_{\\min} = \\dfrac{\\pi}{\\alpha}$.\n\n2.  **Neumann/Neumann (NN)**: $\\partial u/\\partial n=0$ on $\\theta=0$ and $\\theta=\\alpha$.\n    - $\\Theta'(0) = 0 \\implies \\lambda(-A\\sin(0) + B\\cos(0)) = \\lambda B = 0$. Since $\\lambda > 0$, we have $B=0$.\n    - The solution becomes $\\Theta(\\theta) = A\\cos(\\lambda\\theta)$.\n    - $\\Theta'(\\alpha) = 0 \\implies -\\lambda A\\sin(\\lambda\\alpha) = 0$. For a non-trivial solution ($A \\neq 0, \\lambda \\neq 0$), we need $\\sin(\\lambda\\alpha) = 0$.\n    - This again gives $\\lambda\\alpha = k\\pi$, and the smallest positive exponent is $\\lambda_{\\min} = \\dfrac{\\pi}{\\alpha}$ (for $k=1$; $k=0$ gives $\\lambda=0$, corresponding to a constant solution, which is excluded by the requirement $\\lambda > 0$).\n\n3.  **Dirichlet/Neumann (DN)**: $u=0$ on $\\theta=0$ and $\\partial u/\\partial n=0$ on $\\theta=\\alpha$.\n    - $\\Theta(0) = 0 \\implies A=0$. The solution is $\\Theta(\\theta) = B\\sin(\\lambda\\theta)$.\n    - $\\Theta'(\\alpha) = 0 \\implies \\lambda B\\cos(\\lambda\\alpha) = 0$. For a non-trivial solution, $\\cos(\\lambda\\alpha) = 0$.\n    - This gives $\\lambda\\alpha = (k + \\frac{1}{2})\\pi$ for $k \\in \\{0, 1, 2, \\ldots\\}$. The smallest positive exponent is for $k=0$, so $\\lambda_{\\min} = \\dfrac{\\pi}{2\\alpha}$.\n\n4.  **Neumann/Dirichlet (ND)**: $\\partial u/\\partial n=0$ on $\\theta=0$ and $u=0$ on $\\theta=\\alpha$.\n    - $\\Theta'(0) = 0 \\implies B=0$. The solution is $\\Theta(\\theta) = A\\cos(\\lambda\\theta)$.\n    - $\\Theta(\\alpha) = 0 \\implies A\\cos(\\lambda\\alpha) = 0$. For a non-trivial solution, $\\cos(\\lambda\\alpha) = 0$.\n    - This again gives $\\lambda\\alpha = (k + \\frac{1}{2})\\pi$, and the smallest positive exponent is $\\lambda_{\\min} = \\dfrac{\\pi}{2\\alpha}$.\n\nThe leading-order behavior of the solution near the corner is $u \\sim C r^{\\lambda_{\\min}} \\Theta_{\\min}(\\theta)$. The magnitude of the gradient is $\\|\\nabla u\\| = \\sqrt{(\\partial u/\\partial r)^2 + (r^{-1}\\partial u/\\partial \\theta)^2}$. The terms in the gradient behave as $r^{\\lambda_{\\min}-1}$. Therefore, $\\|\\nabla u\\| \\sim C' r^{\\lambda_{\\min}-1}$ as $r \\to 0^{+}$.\n\nThe gradient becomes unbounded if the exponent $\\lambda_{\\min}-1$ is negative, i.e., if $\\lambda_{\\min} < 1$. This justifies the definition of the singularity indicator: $\\text{is\\_singular} = (\\lambda_{\\min} < 1)$.\nIf a singularity exists, the blow-up rate is characterized by the exponent $b = -(\\lambda_{\\min}-1) = 1-\\lambda_{\\min}$. If the gradient is bounded ($\\lambda_{\\min} \\ge 1$), there is no blow-up, so the exponent is $0$. This corresponds to the given definition: $b = \\max(0, 1 - \\lambda_{\\min})$.\n\nThe algorithm is to compute $\\lambda_{\\min}$ based on the angle $\\alpha$ and the boundary condition type, and then use it to find $\\text{is\\_singular}$ and $b$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the corner singularity exponent, singularity presence, and\n    gradient blow-up rate for the Laplace equation in a wedge domain.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (angle_alpha_in_radians, boundary_condition_type).\n    test_cases = [\n        (3 * np.pi / 2, \"DD\"),  # Case 1: Dirichlet/Dirichlet\n        (3 * np.pi / 2, \"NN\"),  # Case 2: Neumann/Neumann\n        (3 * np.pi / 2, \"DN\"),  # Case 3: Dirichlet/Neumann\n        (np.pi,         \"DD\"),  # Case 4: Dirichlet/Dirichlet\n        (3 * np.pi / 4, \"DD\"),  # Case 5: Dirichlet/Dirichlet\n        (7 * np.pi / 4, \"DN\"),  # Case 6: Dirichlet/Neumann\n        (4 * np.pi / 3, \"NN\"),  # Case 7: Neumann/Neumann\n    ]\n\n    results = []\n    for alpha, bc_type in test_cases:\n        # Calculate the smallest positive singularity exponent lambda_min.\n        # The formulas are derived from separation of variables.\n        if bc_type == \"DD\" or bc_type == \"NN\":\n            # For Dirichlet/Dirichlet or Neumann/Neumann conditions.\n            lambda_min = np.pi / alpha\n        elif bc_type == \"DN\" or bc_type == \"ND\":\n            # For mixed Dirichlet/Neumann conditions.\n            lambda_min = np.pi / (2 * alpha)\n        else:\n            # This case should not be reached with the given test suite.\n            raise ValueError(f\"Unknown boundary condition type: {bc_type}\")\n\n        # The gradient of the solution behaves like r^(lambda_min - 1).\n        # A singularity in the gradient exists if lambda_min < 1.\n        is_singular = lambda_min  1\n\n        # The blow-up rate exponent b is defined as max(0, 1 - lambda_min).\n        # It is positive only when the gradient is singular.\n        b = max(0.0, 1.0 - lambda_min)\n\n        # Append the calculated triple to the results list.\n        results.append([lambda_min, is_singular, b])\n\n    # Format the results into the specified string format.\n    # Example: [[val1,True,val2],[val3,False,val4]]\n    result_strings = []\n    for res in results:\n        # str() provides sufficient precision for floats and correct 'True'/'False' for booleans.\n        lambda_str = str(res[0])\n        singular_str = str(res[1])\n        b_str = str(res[2])\n        result_strings.append(f\"[{lambda_str},{singular_str},{b_str}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from analysis to design, this final practice demonstrates how a fundamental understanding of boundary conditions can be leveraged to solve a structural optimization problem. The goal is to find the optimal shape of a bar to minimize its peak stress, a common task in engineering design. The solution hinges on a correct interpretation of the natural (Neumann) boundary condition, which specifies an applied force. As you will derive, this condition dictates that the internal axial force is constant throughout the bar, a non-obvious insight that makes the optimization problem analytically tractable. This exercise  perfectly illustrates how the abstract principles of variational formulations provide powerful tools for sophisticated engineering design and analysis.",
            "id": "2389742",
            "problem": "Consider a one-dimensional, linearly elastic bar occupying the interval $[0,L]$ with spatial coordinate $x$. The unknown displacement field is $u(x)$. The bar has spatially varying cross-sectional area $A(x)$ and constant Young's modulus $E$. The governing model is based on small strain and linear elasticity for axial deformation. Assume no body force.\n\nBoundary conditions are imposed as follows:\n- An essential (Dirichlet) boundary condition fixes the left end: $u(0)=0$.\n- A natural (Neumann) boundary condition prescribes a fixed total end force at the right end: the axial traction at $x=L$ equals a given value $F$, so the boundary condition is $(EA(x)u'(x))\\big|_{x=L}=F$.\n\nFrom the calculus of variations applied to the total potential energy, the interior equilibrium equation is enforced in the weak form and yields an interior ordinary differential equation, together with the above essential and natural boundary conditions.\n\nShape optimization problem. The design variable is the cross-sectional area function $A(x)$. The objective is to minimize the peak axial Cauchy stress along the bar,\n$$\n\\min_{A(\\cdot)}\\ \\ \\max_{x\\in[0,L]} \\ \\sigma(x),\n$$\nwhere $\\sigma(x)$ is the axial stress. The design must satisfy the following constraints:\n- A fixed total material volume: $\\int_0^L A(x)\\, dx = V$.\n- Pointwise geometric bounds: $a_{\\min} \\le A(x) \\le a_{\\max}$ for all $x\\in[0,L]$.\n\nAssume $F\\ge 0$ and that the triple $(L,V,[a_{\\min},a_{\\max}])$ is feasible, that is, $a_{\\min}L \\le V \\le a_{\\max}L$.\n\nYour task:\n1. Derive, from the weak form and boundary conditions, the expression for the axial force $N(x)$ and for the stress $\\sigma(x)$ in terms of $A(x)$ and $F$.\n2. Using only fundamental principles and inequalities from convex analysis, determine the shape $A(x)$ that minimizes the peak stress under the given constraints.\n3. Implement a program that, for each test case below, computes the minimized peak stress. The program must not perform numerical partial differential equation discretization; it must use the analytical structure you derived. The output for each test case is a single floating-point number representing the minimized peak stress in Pascals, rounded to six decimal places.\n\nUse the following test suite (each tuple lists $(L,\\ V,\\ F,\\ a_{\\min},\\ a_{\\max})$ with $L$ in meters, $V$ in square meters times meters, $F$ in Newtons, and $a_{\\min}, a_{\\max}$ in square meters):\n- Test 1 (general feasible case): $(1.2,\\ 0.006,\\ 10000,\\ 0.003,\\ 0.006)$\n- Test 2 (volume at lower bound): $(2.0,\\ 0.004,\\ 8000,\\ 0.002,\\ 0.010)$\n- Test 3 (volume at upper bound): $(1.0,\\ 0.010,\\ 500,\\ 0.002,\\ 0.010)$\n- Test 4 (zero load edge case): $(1.0,\\ 0.003,\\ 0,\\ 0.001,\\ 0.005)$\n\nFor each test case, compute and report the minimized peak stress in Pascals. Express the answer in $\\mathrm{Pa}$, rounded to six decimal places.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\") in the order of the test suite above. No additional whitespace or text is allowed in the output line.",
            "solution": "We start from the total potential energy of a one-dimensional, linearly elastic bar with spatially varying cross-sectional area $A(x)$ and Young's modulus $E$ under an applied end force $F$ at $x=L$:\n$$\n\\Pi[u] = \\int_0^L \\frac{1}{2} E A(x)\\, (u'(x))^2\\, dx - F\\, u(L),\n$$\nwhere $u(0)=0$ is an essential (Dirichlet) boundary condition and $u(L)$ is free. Taking the first variation with respect to kinematically admissible variations $\\delta u$ such that $\\delta u(0)=0$ yields\n$$\n\\delta \\Pi[u;\\delta u] = \\int_0^L E A(x)\\, u'(x)\\, \\delta u'(x)\\, dx - F\\, \\delta u(L).\n$$\nIntegrating by parts,\n$$\n\\int_0^L E A(x)\\, u'(x)\\, \\delta u'(x)\\, dx = \\left. E A(x)\\, u'(x)\\, \\delta u(x)\\right|_{0}^{L} - \\int_0^L \\frac{d}{dx}\\left(E A(x)\\, u'(x)\\right)\\, \\delta u(x)\\, dx.\n$$\nBecause $\\delta u(0)=0$, the boundary term at $x=0$ vanishes. Stationarity $\\delta \\Pi=0$ for all admissible $\\delta u$ implies the interior equilibrium equation and the natural boundary condition:\n$$\n- \\frac{d}{dx}\\left(E A(x)\\, u'(x)\\right) = 0\\quad \\text{for } x\\in(0,L), \\qquad \\left. E A(x)\\, u'(x)\\right|_{x=L} = F.\n$$\nDefine the axial force $N(x) := E A(x)\\, u'(x)$. The equilibrium equation gives\n$$\n\\frac{d}{dx} N(x) = 0 \\quad \\Rightarrow \\quad N(x) \\equiv F \\ \\text{ for all } x\\in[0,L],\n$$\nusing the natural boundary condition at $x=L$. Therefore the axial force is spatially constant and determined solely by the prescribed Neumann load. The axial Cauchy stress is\n$$\n\\sigma(x) = E\\, \\varepsilon(x) = E\\, u'(x) = \\frac{N(x)}{A(x)} = \\frac{F}{A(x)}.\n$$\nThus, for any admissible shape $A(x)$, the pointwise stress is inversely proportional to the local area, and the peak stress is\n$$\n\\sigma_{\\max}[A] := \\max_{x\\in[0,L]} \\sigma(x) = \\max_{x\\in[0,L]} \\frac{F}{A(x)}.\n$$\n\nShape optimization problem. The design constraints are the volume constraint and pointwise bounds:\n$$\n\\int_0^L A(x)\\, dx = V, \\qquad a_{\\min} \\le A(x) \\le a_{\\max} \\ \\text{for all } x\\in[0,L],\n$$\nwith feasibility $a_{\\min} L \\le V \\le a_{\\max} L$. Because $F\\ge 0$, minimizing the peak stress is equivalent to minimizing $\\max_{x} \\frac{1}{A(x)}$. Let $\\phi(a) = \\frac{1}{a}$, which is strictly convex on $(0,\\infty)$. For any two positive areas $a_1,a_2$ and $\\theta\\in[0,1]$, Jensen's inequality yields\n$$\n\\phi(\\theta a_1 + (1-\\theta) a_2) \\le \\theta \\phi(a_1) + (1-\\theta)\\phi(a_2),\n$$\nwith strict inequality if $a_1\\neq a_2$ and $\\theta\\in(0,1)$. Consider any admissible $A(x)$ and define its average\n$$\n\\bar{A} := \\frac{1}{L} \\int_0^L A(x)\\, dx = \\frac{V}{L}.\n$$\nLet $M := \\operatorname*{ess\\,sup}_{x\\in[0,L]} \\phi(A(x)) = \\max_{x\\in[0,L]} \\frac{1}{A(x)}$. Using the fact that $\\phi$ is convex and that the essential supremum bounds the mean,\n$$\n\\frac{1}{\\bar{A}} = \\phi(\\bar{A}) \\le \\frac{1}{L} \\int_0^L \\phi(A(x))\\, dx \\le \\operatorname*{ess\\,sup}_{x\\in[0,L]} \\phi(A(x)) = M.\n$$\nTherefore\n$$\n\\min_{A(\\cdot)} \\max_{x} \\frac{1}{A(x)} \\ge \\frac{1}{\\bar{A}}.\n$$\nThis bound is attained by the constant design $A(x)\\equiv \\bar{A}$ provided it satisfies the pointwise bounds. If $a_{\\min} \\le \\bar{A} \\le a_{\\max}$, the uniform design is admissible and optimal, yielding\n$$\n\\sigma_{\\max}^{\\star} = F \\cdot \\max_{x} \\frac{1}{A(x)} = \\frac{F}{\\bar{A}} = \\frac{F}{V/L} = \\frac{F L}{V}.\n$$\nIf $\\bar{A}$ equals a bound, the uniform design at that bound is the unique admissible uniform solution and is optimal; if $\\bar{A}$ lies strictly outside $[a_{\\min},a_{\\max}]$, the problem is infeasible (violates volume feasibility). Under the stated feasibility $a_{\\min} L \\le V \\le a_{\\max} L$, the optimizer is\n$$\nA^{\\star}(x) \\equiv \\bar{A} = \\frac{V}{L},\n$$\nand the minimized peak stress is\n$$\n\\sigma_{\\max}^{\\star} = \\frac{F}{\\bar{A}} = \\frac{F L}{V}.\n$$\nFor the zero-load edge case $F=0$, the equilibrium force $N(x)\\equiv 0$ and hence $\\sigma(x)\\equiv 0$ for any admissible $A(x)$, so $\\sigma_{\\max}^{\\star} = 0$.\n\nAlgorithmic implementation. Given $(L,V,F,a_{\\min},a_{\\max})$:\n- Compute $\\bar{A} = V/L$.\n- Verify feasibility $a_{\\min} \\le \\bar{A} \\le a_{\\max}$ (the provided tests satisfy this).\n- If $F=0$, return $0$.\n- Else return $\\sigma_{\\max}^{\\star} = F/\\bar{A}$, expressed in $\\mathrm{Pa}$.\n\nNumerical details. The program should compute the minimized peak stress for the four test cases and print the results as a single list in the specified order, rounding to six decimal places. Applying the above formulas to the provided test suite:\n- Test $1$: $\\bar{A} = \\frac{0.006}{1.2} = 0.005$, so $\\sigma_{\\max}^{\\star} = \\frac{10000}{0.005} = 2000000$ $\\mathrm{Pa}$.\n- Test $2$: $\\bar{A} = \\frac{0.004}{2.0} = 0.002$ (equals $a_{\\min}$), so $\\sigma_{\\max}^{\\star} = \\frac{8000}{0.002} = 4000000$ $\\mathrm{Pa}$.\n- Test $3$: $\\bar{A} = \\frac{0.010}{1.0} = 0.010$ (equals $a_{\\max}$), so $\\sigma_{\\max}^{\\star} = \\frac{500}{0.010} = 50000$ $\\mathrm{Pa}$.\n- Test $4$: $F=0$, so $\\sigma_{\\max}^{\\star} = 0$ $\\mathrm{Pa}$.\n\nThese values will be computed and printed by the program with six decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef minimized_peak_stress(L, V, F, a_min, a_max):\n    \"\"\"\n    Compute the minimized peak axial stress for a 1D elastic bar under a fixed end force (Neumann boundary),\n    with volume and pointwise area bounds. Uses the analytical result that the optimal area is uniform\n    A* = V/L (assuming feasibility), and sigma_max* = F / (V/L) = F*L/V. Handles F=0 edge case.\n\n    Parameters:\n        L (float): Length of the bar [m]\n        V (float): Total volume [m^3]\n        F (float): Applied end force [N]\n        a_min (float): Minimum allowable cross-sectional area [m^2]\n        a_max (float): Maximum allowable cross-sectional area [m^2]\n\n    Returns:\n        float: Minimized peak stress [Pa]\n    \"\"\"\n    # Average area implied by volume constraint\n    A_avg = V / L\n\n    # Feasibility check: if infeasible, raise an error as per problem specification assumptions\n    if not (a_min - 1e-14 = A_avg = a_max + 1e-14):\n        raise ValueError(\"Infeasible test case: volume not within [a_min*L, a_max*L].\")\n\n    # If force is zero, stress is zero everywhere\n    if abs(F) == 0.0:\n        return 0.0\n\n    # Optimal peak stress for feasible cases with Neumann load:\n    # sigma_max* = F / A_avg\n    sigma_max = F / A_avg\n    return sigma_max\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (L [m], V [m^3], F [N], a_min [m^2], a_max [m^2])\n    test_cases = [\n        (1.2, 0.006, 10000.0, 0.003, 0.006),  # Test 1: general feasible case\n        (2.0, 0.004, 8000.0, 0.002, 0.010),   # Test 2: volume at lower bound\n        (1.0, 0.010, 500.0, 0.002, 0.010),    # Test 3: volume at upper bound\n        (1.0, 0.003, 0.0, 0.001, 0.005),      # Test 4: zero load edge case\n    ]\n\n    results = []\n    for case in test_cases:\n        L, V, F, a_min, a_max = case\n        sigma_star = minimized_peak_stress(L, V, F, a_min, a_max)\n        results.append(f\"{sigma_star:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}