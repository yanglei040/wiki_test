{
    "hands_on_practices": [
        {
            "introduction": "为了在不同算法之间做出明智的选择，我们必须能够精确地量化它们的计算成本。这个练习  将一个复杂的牛顿-克雷洛夫方法分解为其基本操作单元——函数求值、预处理子应用和向量运算，并将其成本与一个更简单的迭代方法进行比较。这种详细的成本分析是培养算法效率直觉的关键一步。",
            "id": "2417772",
            "problem": "在计算工程中，您正在求解一个大型非线性系统 $F(u)=0$，其中 $u\\in\\mathbb{R}^n$。计算非线性残差 $F(u)$ 的成本为 $C_F$ 次浮点运算，其中 $C_F=\\Theta(n)$；将右预条件子 $M^{-1}$ 应用于一个向量的成本为 $C_P$，其中 $C_P=\\Theta(n)$。向量内积和标量向量加法每次操作的成本均为 $\\Theta(n)$。考虑以下两种从迭代点 $u_k$推进到下一个迭代点的算法。\n\n算法 1 (不动点/Richardson): $u_{k+1}=u_k-\\tau F(u_k)$，对于给定的标量 $\\tau0$。此步骤仅使用当前残差和向量运算；它不求解任何线性系统。\n\n算法 2 (Newton–Krylov): 通过使用 $m$ 步无重启的右预处理广义最小残差 (GMRES) 方法，近似求解线性系统 $J(u_k)s=-F(u_k)$ 来形成 Newton 步 $s_k$。其中，矩阵向量积 $J(u_k)v$ 通过一阶前向有限差分以无矩阵 (matrix-free) 的方式计算，\n$$\nJ(u_k)v \\approx \\frac{F(u_k+h v)-F(u_k)}{h},\n$$\n每次乘积需要一次新的 $F$ 求值，并且 $F(u_k)$ 在 Newton 步开始时已经可用。预条件子 $M^{-1}$ 在每次 GMRES 迭代中恰好应用一次。GMRES 使用修正的 Gram–Schmidt 正交化方法对 Krylov 基向量进行正交化。\n\n在这些实现细节下，并假设 $m\\ge 1$，与算法 1 相比，哪个选项正确地说明了算法 2 每步的 $F$ 求值次数、预条件子应用次数以及向量运算的渐近成本？\n\nA. 算法 2 需要 $(m+1)$ 次 $F$ 求值，$m$ 次预条件子应用，以及来自正交化的 $\\Theta(m^2 n)$ 额外向量运算工作量；算法 1 需要 1 次 $F$ 求值和 $\\Theta(n)$ 的向量运算工作量。\n\nB. 算法 2 由于 $F(u_k)$ 被重用，需要 $m$ 次 $F$ 求值，不需要预条件子应用，并且只有 $\\Theta(m n)$ 的向量运算工作量；算法 1 需要 1 次 $F$ 求值并求解一个线性系统。\n\nC. 由于在差分内重用，算法 2 无论 $m$ 为何值都只需要 1 次 $F$ 求值，并且只有 $\\Theta(m n)$ 的向量运算工作量；算法 1 每步更新 $u_{k+1}$ 需要 2 次 $F$ 求值。\n\nD. 由于对每个 $J(u_k)v$ 使用对称差分，算法 2 需要 $2m$ 次 $F$ 求值和 $m$ 次预条件子应用，向量运算工作量可忽略不计；如果 $\\tau$ 已知，算法 1 需要 0 次 $F$ 求值。",
            "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n-   **待解系统**：一个大型非线性系统 $F(u)=0$，其中 $u \\in \\mathbb{R}^n$。\n-   **残差求值成本**：$C_F = \\Theta(n)$ 次浮点运算。\n-   **预条件子应用成本**：$C_P = \\Theta(n)$ 次浮点运算，用于 $M^{-1}v$。\n-   **向量运算成本**：向量内积成本为 $\\Theta(n)$ 次运算，标量向量加法成本为 $\\Theta(n)$ 次运算。\n-   **算法 1 (不动点/Richardson)**：迭代公式为 $u_{k+1} = u_k - \\tau F(u_k)$，对于标量 $\\tau  0$。\n-   **算法 2 (Newton-Krylov)**：\n    -   更新公式为 $u_{k+1} = u_k + s_k$。\n    -   Newton 步 $s_k$ 是线性系统 $J(u_k)s = -F(u_k)$ 的一个近似解。\n    -   该线性系统使用 $m$ 步无重启的右预处理广义最小残差 (GMRES) 方法求解 ($m \\ge 1$）。\n    -   雅可比-向量积 $J(u_k)v$ 通过使用一阶前向有限差分的无矩阵方法近似：$J(u_k)v \\approx \\frac{F(u_k+h v)-F(u_k)}{h}$。\n    -   每个雅可比-向量积使用一次新的 $F$ 求值，而值 $F(u_k)$ 是预先计算并重用的。\n    -   预条件子 $M^{-1}$ 在每次 GMRES 迭代中恰好应用一次。\n    -   GMRES 使用修正的 Gram-Schmidt 方法进行正交化。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题陈述是分析非线性系统数值算法的标准练习。\n-   **科学依据**：不动点迭代、Newton-Krylov 方法、GMRES、无矩阵有限差分和预处理的描述都是数值分析和计算工程领域的标准和正确表述。\n-   **适定性**：该问题要求对两种明确定义的算法进行计算成本分析。所有必要的细节，如正交化类型（修正的 Gram-Schmidt）和雅可比-向量积的计算方法，都已提供，这使得成本的推导是唯一且明确的。\n-   **客观性**：问题以精确的技术语言陈述，并要求进行定量的、客观的比较。\n-   **一致性与完整性**：问题提供了一套自洽且一致的已知条件。没有矛盾或缺失关键信息。例如，基本运算（$F$ 求值、预条件子、向量操作）的成本都已指定，这对于分析是必需的。关于修正 Gram-Schmidt 的细节对于正确确定正交化成本至关重要。\n\n### 步骤 3：结论与行动\n问题陈述有效。我将继续进行求解和分析。\n\n### 推导与选项分析\n\n我们将根据 $F$ 求值次数、预条件子应用次数和向量运算，分析每种算法每步的计算成本。\n\n#### 算法 1 (不动点/Richardson) 的分析\n从 $u_k$ 到 $u_{k+1}$ 的单步更新规则是 $u_{k+1} = u_k - \\tau F(u_k)$。\n1.  **$F$ 的求值**：必须计算项 $F(u_k)$。这需要恰好 1 次函数 $F$ 的求值。\n2.  **预条件子应用**：此算法不涉及预条件子。应用次数为 0。\n3.  **向量运算工作量**：计算涉及一次标量向量加法 ($u_k - (\\tau F(u_k))$)。标量向量加法的成本给定为 $\\Theta(n)$。\n\n**算法 1 总结：**\n-   $F$ 求值次数：1。\n-   预条件子应用次数：0。\n-   向量运算工作量：$\\Theta(n)$。\n\n#### 算法 2 (Newton-Krylov) 的分析\n此算法的单步包括计算 Newton 更新量 $s_k$，然后设置 $u_{k+1} = u_k + s_k$。主要成本在于计算 $s_k$。\n\n首先，在 Newton 步开始时，必须构建线性系统的右侧项 $-F(u_k)$。\n-   这需要 1 次 $F(u_k)$ 的求值。然后在整个 GMRES 求解过程中重用此值。\n\n接下来，使用 $m$ 次迭代的右预处理 GMRES 近似求解线性系统 $J(u_k)s = -F(u_k)$。GMRES 实际求解的系统是 $(J(u_k)M^{-1})y = -F(u_k)$，最后一步是 $s_k=M^{-1}y$。我们来分析这 $m$ 次迭代的成本。\n\n对于每次 GMRES 迭代（从 $j=1$到 $m$）：\n1.  **矩阵向量积**：GMRES 需要为某个向量 $v$ 计算一个形如 $(J(u_k)M^{-1})v$ 的乘积。\n    -   首先，应用预条件子：$w = M^{-1}v$。这算作 1 次预条件子应用。根据问题陈述，这需要 $C_P = \\Theta(n)$ 的成本。\n    -   接下来，计算雅可比-向量积：$J(u_k)w$。问题指明这是使用公式 $\\frac{F(u_k+h w)-F(u_k)}{h}$ 完成的。由于 $F(u_k)$ 已经可用，这需要 1 次新的 $F$ 求值（在 $u_k+hw$ 处）。这需要 $C_F = \\Theta(n)$ 的成本。\n    -   在 $m$ 次迭代中，算法的这一部分需要 $m$ 次预条件子应用和 $m$ 次新的 $F$ 求值。\n\n2.  **正交化**：GMRES 使用修正的 Gram-Schmidt (MGS) 方法为 Krylov 子空间构建一个标准正交基。在第 $j$ 次迭代时，新生成的向量需要与之前的 $j-1$ 个基向量正交。\n    -   这涉及 $j-1$ 次内积和 $j-1$ 次标量向量加法。一次内积的成本是 $\\Theta(n)$，一次标量向量加法的成本是 $\\Theta(n)$。因此，在第 $j$ 次迭代时 MGS 的成本是 $(j-1) \\times \\Theta(n) = \\Theta((j-1)n)$。\n    -   在 $m$ 次迭代中，正交化的总成本是总和：\n    $$ \\sum_{j=1}^{m} \\Theta((j-1)n) = \\Theta(n) \\sum_{k=0}^{m-1} k = \\Theta(n) \\frac{(m-1)m}{2} = \\Theta(m^2 n). $$\n    GMRES 中的其他向量运算，例如归一化向量和从基向量构建最终解（成本为 $\\Theta(mn)$），阶数较低或相等。向量运算的主要成本来自 MGS，为 $\\Theta(m^2 n)$。\n\n**算法 2 总结：**\n-   **$F$ 求值次数**：1 次用于初始残差 $F(u_k)$，加上 $m$ 次用于 GMRES 内的 $m$ 个雅可比-向量积。总计：$m+1$。\n-   **预条件子应用次数**：每次 GMRES 迭代 1 次。总计：$m$。\n-   **向量运算工作量**：主要由 MGS 正交化主导。总计：$\\Theta(m^2 n)$。\n\n### 逐项分析\n\n-   **选项 A**：“算法 2 需要 $(m+1)$ 次 $F$ 求值，$m$ 次预条件子应用，以及来自正交化的 $\\Theta(m^2 n)$ 额外向量运算工作量；算法 1 需要 1 次 $F$ 求值和 $\\Theta(n)$ 的向量运算工作量。”\n    -   该陈述准确反映了我们对算法 2（F 求值次数：$m+1$，预条件子应用次数：$m$，向量运算：$\\Theta(m^2 n)$）和算法 1（F 求值次数：1，向量运算：$\\Theta(n)$）的分析。\n    -   结论：**正确**。\n\n-   **选项 B**：“算法 2 由于 $F(u_k)$ 被重用，需要 $m$ 次 $F$ 求值，不需要预条件子应用，并且只有 $\\Theta(m n)$ 的向量运算工作量；算法 1 需要 1 次 $F$ 求值并求解一个线性系统。”\n    -   该选项错误地指出算法 2 的 $F$ 求值次数为 $m$；实际上是 $m+1$。它错误地声称没有使用预条件子。它错误地指出向量运算工作量为 $\\Theta(mn)$ 而不是 $\\Theta(m^2 n)$。对于算法 1，它错误地声称求解了一个线性系统。\n    -   结论：**不正确**。\n\n-   **选项 C**：“由于在差分内重用，算法 2 无论 $m$ 为何值都只需要 1 次 $F$ 求值，并且只有 $\\Theta(m n)$ 的向量运算工作量；算法 1 每步更新 $u_{k+1}$ 需要 2 次 $F$ 求值。”\n    -   该选项错误地指出算法 2 的 $F$ 求值次数为 1；实际上是 $m+1$。它错误地指出向量运算工作量为 $\\Theta(mn)$。对于算法 1，它错误地声称每步需要 2 次 $F$ 求值。\n    -   结论：**不正确**。\n\n-   **选项 D**：“由于对每个 $J(u_k)v$ 使用对称差分，算法 2 需要 $2m$ 次 $F$ 求值和 $m$ 次预条件子应用，向量运算工作量可忽略不计；如果 $\\tau$ 已知，算法 1 需要 0 次 $F$ 求值。”\n    -   该选项错误地假设使用对称（中心）有限差分，这需要每次乘积进行两次 $F$ 求值，与问题陈述中指定的前向差分相矛盾。它错误地声称向量运算工作量可以忽略不计，而实际上是 $\\Theta(m^2 n)$。对于算法 1，它错误地声称需要 0 次 $F$ 求值。\n    -   结论：**不正确**。\n\n基于详细分析，只有选项 A 对两种算法的所有指定成本给出了正确的说明。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在成本分析的基础上，本实践提供了一个真实的工程计算场景 。您需要权衡构造雅可比矩阵的高昂前期成本，与在无雅可比矩阵设置中执行更多、但单次迭代成本更高的克雷洛夫迭代的代价。这个练习将向您展示如何基于性能数据做出实际决策，这是计算工程师的一项核心技能。",
            "id": "2417751",
            "problem": "一个大规模非线性残差映射 $F:\\mathbb{R}^n \\to \\mathbb{R}^n$ 是由在具有 $n$ 个未知量的非结构化网格上对稳态守恒律进行有限体积离散化而产生的。您必须使用牛顿法求解 $F(x)=0$。考虑在每个牛顿步中求解内部线性系统的两种变体，两者都使用广义最小残差法 (GMRES) 和相同的右预条件子，该预条件子是根据问题系数构建的，且独立于 $J(x)$。\n\n假设：\n- 在每个牛顿步 $k$，线性系统 $J(x_k)\\,\\delta x = -F(x_k)$ 使用 GMRES 求解，直到达到一个固定的相对残差容差。\n- 在每个牛顿步开始时，需要对 $F(x_k)$ 进行一次求值，并根据需要重复使用；每次求值的成本为 $t_F$。\n- 预条件子在每个牛顿步构建一次，成本为 $T_P$，每次应用的成本为 $t_{P\\mathrm{apply}}$。\n- 忽略向量更新、正交化、线性搜索以及所有其他未明确列出的成本。\n\n方法 S（组装雅可比矩阵）：\n- 在每个牛顿步，以成本 $T_J$ 形成解析稀疏雅可比矩阵 $J(x_k)$。\n- 每次 GMRES 迭代使用一次与 $J(x_k)$ 的稀疏矩阵-向量乘法，成本为 $t_{\\mathrm{spmv}}$，外加一次预条件子应用，成本为 $t_{P\\mathrm{apply}}$。\n- 每个牛顿步的平均 GMRES 迭代次数为 $m_S$。\n\n方法 JF（无雅可比的牛顿-克雷洛夫方法）：\n- 不形成 $J(x_k)$。每个克雷洛夫乘积 $J(x_k)v$ 通过有限差分方向导数来近似，这需要在每次 GMRES 迭代中额外进行一次 $F$ 的求值，成本为 $t_F$；每次迭代中预条件子的应用成本仍然是 $t_{P\\mathrm{apply}}$。\n- 每个牛顿步的平均 GMRES 迭代次数为 $m_{JF}$。\n\n特定案例的数据：\n- 牛顿步数：$k = 5$。\n- 残差求值成本：$t_F = 0.075\\,\\mathrm{s}$。\n- 稀疏雅可比矩阵组装成本：$T_J = 2.8\\,\\mathrm{s}$。\n- 预条件子构建成本：$T_P = 0.9\\,\\mathrm{s}$。\n- 稀疏矩阵-向量乘法成本：$t_{\\mathrm{spmv}} = 0.010\\,\\mathrm{s}$。\n- 预条件子应用成本：$t_{P\\mathrm{apply}} = 0.005\\,\\mathrm{s}$。\n- 使用组装雅可比矩阵时每个牛顿步的 GMRES 迭代次数：$m_S = 20$。\n- 使用无雅可比乘积时每个牛顿步的 GMRES 迭代次数：$m_{JF} = 30$。\n\n根据这些假设和数据，关于所有 $k$ 个牛顿步的总挂钟时间的哪个陈述是正确的？\n\nA. 组装雅可比矩阵的方法（方法 S）总体上快约 $3.5\\,\\mathrm{s}$。\n\nB. 无雅可比的方法（方法 JF）总体上快约 $3.5\\,\\mathrm{s}$。\n\nC. 两种方法的总时间大致相等，差距在 $1\\%$ 以内。\n\nD. 信息不足，无法决定；需要有限差分方向导数的步长才能比较时间。",
            "solution": "必须首先验证问题陈述的科学合理性、自洽性和清晰性。\n\n### 第1步：提取已知条件\n\n所提供的信息包括两种计算方法的定义和一组数值数据。\n\n**问题设置与定义：**\n-   使用牛顿法求解非线性系统 $F(x) = 0$，其中 $F: \\mathbb{R}^n \\to \\mathbb{R}^n$。\n-   在每个牛顿步 $k$，线性系统为 $J(x_k)\\,\\delta x = -F(x_k)$。\n-   该系统的线性求解器是广义最小残差法 (GMRES)。\n-   使用一个右预条件子，它是根据问题系数构建的，并且独立于雅可比矩阵 $J(x)$。\n-   所有未明确列出的成本都将被忽略（向量更新、正交化、线性搜索等）。\n\n**方法 S（组装雅可比矩阵）：**\n-   在每个牛顿步形成解析稀疏雅可比矩阵 $J(x_k)$。\n-   GMRES 迭代使用与 $J(x_k)$ 的稀疏矩阵-向量乘法。\n\n**方法 JF（无雅可比的牛顿-克雷洛夫方法）：**\n-   不显式形成 $J(x_k)$。\n-   雅可比矩阵对向量的作用 $J(x_k)v$，通过有限差分方向导数来近似。\n-   这种近似在每次 GMRES 迭代中需要额外进行一次 $F(x)$ 的求值。\n\n**数值数据：**\n-   牛顿步数：$k = 5$。\n-   一次残差求值 $F(x)$ 的成本：$t_F = 0.075\\,\\mathrm{s}$。\n-   组装稀疏雅可比矩阵 $J(x_k)$ 的成本：$T_J = 2.8\\,\\mathrm{s}$。\n-   构建预条件子的成本（每个牛顿步一次）：$T_P = 0.9\\,\\mathrm{s}$。\n-   一次与 $J(x_k)$ 的稀疏矩阵-向量乘法的成本：$t_{\\mathrm{spmv}} = 0.010\\,\\mathrm{s}$。\n-   一次预条件子应用的成本：$t_{P\\mathrm{apply}} = 0.005\\,\\mathrm{s}$。\n-   方法 S 每个牛顿步的平均 GMRES 迭代次数：$m_S = 20$。\n-   方法 JF 每个牛顿步的平均 GMRES 迭代次数：$m_{JF} = 30$。\n\n### 第2步：使用提取的已知条件进行验证\n\n该问题描述了计算科学与工程中的一个标准场景：比较牛顿-克雷洛夫方法两种变体的性能。\n\n1.  **科学依据充分：**该问题牢固地植根于数值线性代数和求解大规模非线性系统的迭代方法研究。牛顿-克雷洛夫方法，无论是使用组装的雅可比矩阵还是其无雅可比形式，都是一种基础且广泛使用的技术。其成本模型是分析计算性能的一种简化但标准的方法。该设置在科学上是有效的。\n2.  **适定性：**该问题要求基于一个定义明确的成本模型和一套完整的数据，直接比较总计算时间。可以确定一个唯一的数值答案。\n3.  **客观性：**语言技术性强且精确。假设被明确陈述。没有主观性或模糊性。\n4.  **完整性和一致性：**为所定义的成本模型提供了所有必要的数据。给定信息中没有矛盾之处。$m_{JF}  m_S$ 这个事实也是合理的，因为与使用精确的解析雅可比矩阵相比，无雅可比近似有时会导致克雷洛夫迭代次数略有增加。\n5.  **主题相关性：**该问题直接关系到用于大规模非线性系统的牛顿-克雷洛夫方法这一主题。\n\n### 第3步：结论与行动\n\n问题陈述是有效的。我将继续进行解的推导。\n\n### 解题推导\n\n任务是计算在 $k=5$ 个牛顿步中每种方法的总挂钟时间，并进行比较。总时间是每个牛顿步的成本乘以步数。\n\n**方法 S（组装雅可比矩阵）的成本分析**\n\n单个牛顿步的成本，记为 $C_S$，是其各组成部分操作成本的总和：\n1.  求值残差向量 $F(x_k)$：$t_F$。\n2.  组装解析稀疏雅可比矩阵 $J(x_k)$：$T_J$。\n3.  构建预条件子：$T_P$。\n4.  使用 GMRES 求解线性系统，该过程执行 $m_S$ 次迭代。每次迭代包括一次稀疏矩阵-向量乘积和一次预条件子应用。这 $m_S$ 次迭代的成本是 $m_S \\times (t_{\\mathrm{spmv}} + t_{P\\mathrm{apply}})$。\n\n方法 S 每个牛顿步的总成本是：\n$$ C_S = t_F + T_J + T_P + m_S (t_{\\mathrm{spmv}} + t_{P\\mathrm{apply}}) $$\n代入给定的数值：\n$$ C_S = 0.075\\,\\mathrm{s} + 2.8\\,\\mathrm{s} + 0.9\\,\\mathrm{s} + 20 \\times (0.010\\,\\mathrm{s} + 0.005\\,\\mathrm{s}) $$\n$$ C_S = 3.775\\,\\mathrm{s} + 20 \\times (0.015\\,\\mathrm{s}) $$\n$$ C_S = 3.775\\,\\mathrm{s} + 0.300\\,\\mathrm{s} $$\n$$ C_S = 4.075\\,\\mathrm{s} $$\n在 $k=5$ 个牛顿步中的总时间是：\n$$ C_{S, \\text{total}} = k \\times C_S = 5 \\times 4.075\\,\\mathrm{s} = 20.375\\,\\mathrm{s} $$\n\n**方法 JF（无雅可比）的成本分析**\n\n单个牛顿步的成本，记为 $C_{JF}$，计算方法类似。注意，雅可比矩阵没有被组装。\n1.  为牛顿系统右侧求值残差向量 $F(x_k)$：$t_F$。\n2.  构建预条件子：$T_P$。\n3.  使用 GMRES 求解线性系统，该过程执行 $m_{JF}$ 次迭代。每次迭代包括一次通过有限差分近似的雅可比-向量乘积（成本为一次函数求值，$t_F$）和一次预条件子应用（$t_{P\\mathrm{apply}}$）。这 $m_{JF}$ 次迭代的成本是 $m_{JF} \\times (t_F + t_{P\\mathrm{apply}})$。\n\n方法 JF 每个牛顿步的总成本是：\n$$ C_{JF} = t_F + T_P + m_{JF} (t_F + t_{P\\mathrm{apply}}) $$\n代入给定的数值：\n$$ C_{JF} = 0.075\\,\\mathrm{s} + 0.9\\,\\mathrm{s} + 30 \\times (0.075\\,\\mathrm{s} + 0.005\\,\\mathrm{s}) $$\n$$ C_{JF} = 0.975\\,\\mathrm{s} + 30 \\times (0.080\\,\\mathrm{s}) $$\n$$ C_{JF} = 0.975\\,\\mathrm{s} + 2.400\\,\\mathrm{s} $$\n$$ C_{JF} = 3.375\\,\\mathrm{s} $$\n在 $k=5$ 个牛顿步中的总时间是：\n$$ C_{JF, \\text{total}} = k \\times C_{JF} = 5 \\times 3.375\\,\\mathrm{s} = 16.875\\,\\mathrm{s} $$\n\n**总时间比较**\n\n我们比较两种方法的总计算时间：\n-   方法 S 的总时间：$C_{S, \\text{total}} = 20.375\\,\\mathrm{s}$。\n-   方法 JF 的总时间：$C_{JF, \\text{total}} = 16.875\\,\\mathrm{s}$。\n\n总时间的差值为：\n$$ \\Delta C = C_{S, \\text{total}} - C_{JF, \\text{total}} = 20.375\\,\\mathrm{s} - 16.875\\,\\mathrm{s} = 3.500\\,\\mathrm{s} $$\n正的差值表示方法 S 比方法 JF 慢。因此，方法 JF 快 $3.5\\,\\mathrm{s}$。\n\n### 逐项分析选项\n\n**A. 组装雅可比矩阵的方法（方法 S）总体上快约 $3.5\\,\\mathrm{s}$。**\n该陈述不正确。我们的计算表明，方法 S 比方法 JF 慢，而不是快。S 的总时间是 $20.375\\,\\mathrm{s}$，而 JF 的总时间是 $16.875\\,\\mathrm{s}$。\n\n**B. 无雅可比的方法（方法 JF）总体上快约 $3.5\\,\\mathrm{s}$。**\n该陈述正确。我们的计算表明 $C_{JF, \\text{total}} = 16.875\\,\\mathrm{s}$ 且 $C_{S, \\text{total}} = 20.375\\,\\mathrm{s}$。差值为 $20.375 - 16.875 = 3.5\\,\\mathrm{s}$，表明方法 JF 确实快这么多。“约”这个词是恰当的，尽管在这个理想化的模型中，结果是精确的。\n\n**C. 两种方法的总时间大致相等，差距在 $1\\%$ 以内。**\n该陈述不正确。相对于较快方法的总时间相对差异为：\n$$ \\frac{|C_{S, \\text{total}} - C_{JF, \\text{total}}|}{C_{JF, \\text{total}}} = \\frac{3.5}{16.875} \\approx 0.2074 $$\n这是一个约 $20.7\\%$ 的差异，远大于 $1\\%$。\n\n**D. 信息不足，无法决定；需要有限差分方向导数的步长才能比较时间。**\n该陈述不正确。问题提供了一个简化但完整的成本模型。有限差分雅可比-向量乘积的成本已明确给出为 $t_F$。有限差分公式 $Jv \\approx (F(x+\\epsilon v)-F(x))/\\epsilon$ 中的步长 $\\epsilon$ 会影响近似的准确性，而这又可能影响 GMRES 的迭代次数 $m_{JF}$。然而，$m_{JF}$ 是作为数据给出的。问题不要求我们推导出 $m_{JF}$；它要求我们使用它。因此，进行成本计算所需的所有信息都已提供。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "牛顿-克雷洛夫方法中存在一些微妙之处，可能会导致意外的失败。这个思想实验  要求您构建一个特殊情景，在该情景中，算法的失败不是因为预处理子本身不好，而是因为它被应用的位置不当（左预处理与右预处理）。这个练习揭示了确保内层线性求解器的优化目标与外层非线性迭代的收敛目标相一致的至关重要性。",
            "id": "2417681",
            "problem": "考虑使用非精确牛顿-克雷洛夫方法求解非线性系统 $F(u)=0$，其中 $u=(x,y)^{\\top}\\in\\mathbb{R}^{2}$。设“基于物理的”残差为\n$$\n\\widetilde{F}(u)=\\begin{bmatrix}\\sin(x)\\\\ \\tanh(y)\\end{bmatrix}, \n$$\n其根为 $u_{\\star}=(0,0)^{\\top}$，并定义一个缩放后的系统\n$$\nF(u)=Q\\,\\widetilde{F}(u), \\quad Q=\\operatorname{diag}(\\gamma,\\delta),\n$$\n其参数满足 $\\gamma\\gg 1$ 和 $0  \\delta\\ll 1$。假设初始猜测值 $u_{0}=(x_{0},y_{0})^{\\top}$ 满足 $x_{0}\\in(0,\\pi)$ 和 $y_{0}0$，使得 $\\cos(x_{0})0$ 且 $0  \\operatorname{sech}^{2}(y_{0})  1$。雅可比矩阵为\n$$\n\\widetilde{J}(u)=\\begin{bmatrix}\\cos(x)  0\\\\ 0  \\operatorname{sech}^{2}(y)\\end{bmatrix}, \n\\qquad \nJ(u)=Q\\,\\widetilde{J}(u).\n$$\n在每个牛顿步，使用广义最小残差方法（GMRES）近似求解线性化系统 $J(u_{k})\\,\\Delta u=-F(u_{k})$。考虑使用相同的预处理算子 $M=Q$ 的两种预处理位置：\n- 左预处理：用 GMRES 求解 $Q^{-1}J(u_{k})\\,\\Delta u=-Q^{-1}F(u_{k})$，并更新 $u_{k+1}=u_{k}+\\Delta u$。\n- 右预处理：用 GMRES 求解 $J(u_{k})\\,Q^{-1}y=-F(u_{k})$，令 $\\Delta u=Q^{-1}y$，并更新 $u_{k+1}=u_{k}+\\Delta u$。\n\nGMRES 内层求解由一个固定的相对缩减准则终止\n$$\n\\|r_{m}\\|_{2}\\le \\eta\\,\\|r_{0}\\|_{2}, \\quad \\eta\\in(0,1),\n$$\n其中 $r_{m}$ 是当前牛顿步正在求解的线性系统的 GMRES 残差向量。标准的回溯线搜索在完整步长能够减小外层（基于物理的）残差范数\n$$\n\\|Q^{-1}F(u)\\|_{2}=\\|\\widetilde{F}(u)\\|_{2}\n$$\n时接受该步长。\n\n尽管使用了相同的 $M=Q$ 和相同的内层停止因子 $\\eta$，以下哪种设计会产生一种病态情况，即左预处理的牛顿-克雷洛夫方法取得稳健的外层进展（$\\|\\widetilde{F}(u_{k})\\|_{2}$ 快速下降），而右预处理的方法则表现出外层迭代停滞（在多次外层迭代中 $\\|\\widetilde{F}(u_{k})\\|_{2}$ 下降非常缓慢或不下降）？\n\nA. 使用 $F(u)=Q\\,\\widetilde{F}(u)$，其中 $Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，在基于物理的范数 $\\|\\widetilde{F}(u)\\|_{2}$ 中监控外层收敛，并通过在正在求解的线性系统的 GMRES 残差的原生范数下的 $\\|r_{m}\\|_{2}\\le\\eta\\|r_{0}\\|_{2}$ 准则终止 GMRES（使得左 GMRES 最小化 $\\|\\widetilde{F}(u_{k})+\\widetilde{J}(u_{k})\\Delta u\\|_{2}$，而右 GMRES 最小化 $\\|Q(\\widetilde{F}(u_{k})+\\widetilde{J}(u_{k})\\Delta u)\\|_{2}$）。\n\nB. 使用 $F(u)=Q\\,\\widetilde{F}(u)$，其中 $Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，但在缩放后的范数 $\\|F(u)\\|_{2}$ 中监控外层收敛，并使用与所述相同的内层停止准则和预处理位置。\n\nC. 使用未缩放的系统 $F(u)=\\widetilde{F}(u)$ 和相同的 $M=Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，使得左 GMRES 最小化 $\\|Q^{-1}(\\widetilde{F}+\\widetilde{J}\\Delta u)\\|_{2}$，右 GMRES 最小化 $\\|\\widetilde{F}+\\widetilde{J}\\Delta u\\|_{2}$，而外层范数为 $\\|\\widetilde{F}(u)\\|_{2}$。\n\nD. 使用 $F(u)=Q\\,\\widetilde{F}(u)$，其中 $Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，但为左右预处理都选择 $M=Q^{-1}$，同时监控外层范数 $\\|\\widetilde{F}(u)\\|_{2}$ 并使用相同的内层停止准则。",
            "solution": "对问题陈述的有效性进行审查。\n\n### 步骤 1：提取已知条件\n-   待求解的非线性系统：$F(u)=0$，其中 $u=(x,y)^{\\top}\\in\\mathbb{R}^{2}$。\n-   “基于物理的”残差：$\\widetilde{F}(u)=\\begin{bmatrix}\\sin(x)\\\\ \\tanh(y)\\end{bmatrix}$。其根为 $u_{\\star}=(0,0)^{\\top}$。\n-   缩放后的系统：$F(u)=Q\\,\\widetilde{F}(u)$，缩放矩阵为 $Q=\\operatorname{diag}(\\gamma,\\delta)$。\n-   参数缩放：$\\gamma\\gg 1$ 且 $0  \\delta\\ll 1$。\n-   初始猜测值：$u_{0}=(x_{0},y_{0})^{\\top}$，满足 $x_{0}\\in(0,\\pi)$ 和 $y_{0}0$。\n-   对初始猜测值的条件：$\\cos(x_{0})0$ 且 $0  \\operatorname{sech}^{2}(y_{0})  1$。这些条件意味着 $x_0 \\in (0, \\pi/2)$ 并确保初始雅可比矩阵是良定义且非奇异的。\n-   基于物理的系统的雅可比矩阵：$\\widetilde{J}(u)=\\begin{bmatrix}\\cos(x)  0\\\\ 0  \\operatorname{sech}^{2}(y)\\end{bmatrix}$。\n-   缩放后的系统的雅可比矩阵：$J(u)=Q\\,\\widetilde{J}(u)$。\n-   牛顿迭代线性系统：$J(u_{k})\\,\\Delta u=-F(u_{k})$。\n-   内层求解器：广义最小残差方法（GMRES）。\n-   预处理器：$M=Q$。\n-   左预处理：GMRES 求解 $Q^{-1}J(u_{k})\\,\\Delta u=-Q^{-1}F(u_{k})$。\n-   右预处理：GMRES 求解 $J(u_{k})\\,Q^{-1}y=-F(u_{k})$，然后 $\\Delta u=Q^{-1}y$。\n-   内层停止准则：GMRES 残差 $r_m$ 满足 $\\|r_{m}\\|_{2}\\le \\eta\\,\\|r_{0}\\|_{2}$，对于一个固定的 $\\eta\\in(0,1)$。\n-   外层收敛度量：如果基于物理的残差范数 $\\|Q^{-1}F(u)\\|_{2}=\\|\\widetilde{F}(u)\\|_{2}$ 减小，则认为该方法取得了进展。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、是适定且客观的。它在一个高等数值分析课题（用于非线性系统的牛顿-克雷洛夫方法）中提出了一个标准问题，探讨了预处理、系统缩放和收敛准则之间的相互作用。其数学设定是自洽且一致的。在给定条件下，函数和矩阵是良定义的。不存在科学或逻辑上的缺陷。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将推导解答。\n\n### 推导\n问题的核心在于内层 GMRES 求解器最小化的量与用于评估外层牛顿迭代收敛性的量之间的区别。在迭代 $k$ 步的牛顿更新量 $\\Delta u_k$ 是线性系统 $J(u_k)\\Delta u_k = -F(u_k)$ 的一个非精确解。此更新的质量取决于线性残差 $r_{lin} = F(u_k) + J(u_k)\\Delta u_k$ 变得多“小”。为使外层牛顿迭代在范数 $\\|\\widetilde{F}(u)\\|_2$ 下稳健收敛，步长 $\\Delta u_k$ 理想情况下应导致此量的线性化版本，即 $\\|\\widetilde{F}(u_k) + \\widetilde{J}(u_k)\\Delta u_k\\|_2$，显著减小。\n\n让我们分析问题中描述的两种预处理策略。基本线性系统是 $J(u_k) \\Delta u = -F(u_k)$，使用给定的定义，可以写成 $Q\\widetilde{J}(u_k) \\Delta u = -Q\\widetilde{F}(u_k)$。\n\n**左预处理**\nGMRES 求解的预处理系统是 $M^{-1}J(u_k)\\Delta u = -M^{-1}F(u_k)$。\n当预处理器为 $M=Q$ 时，系统变为：\n$$\nQ^{-1} \\left( Q\\widetilde{J}(u_k) \\right) \\Delta u = -Q^{-1} \\left( Q\\widetilde{F}(u_k) \\right) \\implies \\widetilde{J}(u_k) \\Delta u = -\\widetilde{F}(u_k)\n$$\nGMRES 方法应用于一般系统 $A'x'=b'$ 时，会最小化残差 $r'_m = b' - A'x'_m$ 的欧几里得范数。在这种情况下，$A' = \\widetilde{J}(u_k)$，$x'=\\Delta u$，$b'=-\\widetilde{F}(u_k)$。因此，GMRES 最小化：\n$$\n\\| r'_m \\|_2 = \\| (-\\widetilde{F}(u_k)) - \\widetilde{J}(u_k) \\Delta u_m \\|_2 = \\| \\widetilde{F}(u_k) + \\widetilde{J}(u_k) \\Delta u_m \\|_2\n$$\n这个量是线性化的“基于物理的”残差的范数。由于外层收敛是使用 $\\|\\widetilde{F}(u)\\|_2$ 来监控的，内层求解器直接最小化的量是下一步外层残差的一阶近似，即 $\\|\\widetilde{F}(u_{k+1})\\|_2 \\approx \\|\\widetilde{F}(u_k) + \\widetilde{J}(u_k)\\Delta u_k\\|_2$。内外目标之间的这种一致性促进了外层牛顿迭代的稳健收敛。\n\n**右预处理**\nGMRES 求解的预处理系统是 $(J(u_k)M^{-1})y = -F(u_k)$，牛顿更新量通过 $\\Delta u = M^{-1}y$ 恢复。\n当 $M=Q$ 时，GMRES 求解的系统是 $(J(u_k)Q^{-1})y = -F(u_k)$。这里，$A' = J(u_k)Q^{-1} = (Q\\widetilde{J}(u_k))Q^{-1}$ 且 $b' = -F(u_k) = -Q\\widetilde{F}(u_k)$。GMRES 最小化残差 $r'_m = b' - A'y_m$ 的范数：\n$$\n\\| r'_m \\|_2 = \\| (-Q\\widetilde{F}(u_k)) - (Q\\widetilde{J}(u_k)Q^{-1}) y_m \\|_2\n$$\n为了将其与 $\\Delta u_m$ 联系起来，我们代入 $y_m = Q\\Delta u_m$：\n$$\n\\| r'_m \\|_2 = \\| -Q\\widetilde{F}(u_k) - (Q\\widetilde{J}(u_k)Q^{-1}) (Q\\Delta u_m) \\|_2 = \\| -Q\\widetilde{F}(u_k) - Q\\widetilde{J}(u_k)\\Delta u_m \\|_2 = \\| Q(\\widetilde{F}(u_k) + \\widetilde{J}(u_k)\\Delta u_m) \\|_2\n$$\nGMRES 最小化*缩放后的*线性化残差的范数。设 $\\tilde{r}_{lin} = \\widetilde{F}(u_k) + \\widetilde{J}(u_k)\\Delta u_m = (\\tilde{r}_{x}, \\tilde{r}_{y})^\\top$。最小化的范数是 $\\|Q \\tilde{r}_{lin}\\|_2 = \\sqrt{(\\gamma \\tilde{r}_{x})^2 + (\\delta \\tilde{r}_{y})^2}$。\n鉴于 $\\gamma \\gg 1$ 和 $\\delta \\ll 1$，GMRES 将产生一个步长 $\\Delta u_m$，该步长会极大地减小 $\\tilde{r}_{x}$ 以使 $(\\gamma \\tilde{r}_{x})^2$ 项变小，但它几乎不会努力去减小 $\\tilde{r}_{y}$，因为后者对范数的贡献被 $\\delta$ 抑制了。内层 GMRES 求解可以在 $\\tilde{r}_{x}$ 非常小但 $\\tilde{r}_{y}$ 很大的情况下成功终止。\n\n然而，外层收敛是通过 $\\|\\widetilde{F}(u_{k+1})\\|_2$ 来衡量的，其近似为 $\\|\\tilde{r}_{lin}\\|_2 = \\sqrt{\\tilde{r}_{x}^2 + \\tilde{r}_{y}^2}$。如果 $\\tilde{r}_{y}$ 仍然很大，这个范数将不会显著减小，从而导致外层牛顿迭代的停滞。这是一个典型的病态情况，其中内层克雷洛夫求解收敛于一个与外层非线性收敛度量不一致的量。\n\n### 逐项分析\n\n**A. 使用 $F(u)=Q\\,\\widetilde{F}(u)$，其中 $Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，在基于物理的范数 $\\|\\widetilde{F}(u)\\|_{2}$ 中监控外层收敛，并通过在正在求解的线性系统的 GMRES 残差的原生范数下的 $\\|r_{m}\\|_{2}\\le\\eta\\|r_{0}\\|_{2}$ 准则终止 GMRES（使得左 GMRES 最小化 $\\|\\widetilde{F}(u_{k})+\\widetilde{J}(u_{k})\\Delta u\\|_{2}$，而右 GMRES 最小化 $\\|Q(\\widetilde{F}(u_{k})+\\widetilde{J}(u_{k})\\Delta u)\\|_{2}$）。**\n这个选项正确地描述了上面分析的设置。左预处理使内层求解器的目标与外层收敛准则保持一致，从而带来稳健的进展。右预处理最小化了一个缩放后的量，该量与外层准则不一致，导致了所描述的病态停滞。关于哪些量被最小化的解释是正确的。\n**结论：正确。**\n\n**B. 使用 $F(u)=Q\\,\\widetilde{F}(u)$，其中 $Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，但在缩放后的范数 $\\|F(u)\\|_{2}$ 中监控外层收敛，并使用与所述相同的内层停止准则和预处理位置。**\n在这种情况下，外层范数是 $\\|F(u)\\|_2 = \\|Q\\widetilde{F}(u)\\|_2$。\n- 左预处理最小化 $\\|\\widetilde{F}_k + \\widetilde{J}_k \\Delta u_k\\|_2$。外层范数是 $\\|Q\\widetilde{F}_{k+1}\\|_2 \\approx \\|Q(\\widetilde{F}_k + \\widetilde{J}_k \\Delta u_k)\\|_2$。存在不匹配。现在，这对左预处理来说是病态情况。\n- 右预处理最小化 $\\|Q(\\widetilde{F}_k + \\widetilde{J}_k \\Delta u_k)\\|_2$。外层范数的线性化版本是 $\\|Q(\\widetilde{F}_k + \\widetilde{J}_k \\Delta u_k)\\|_2$。目标完全一致。右预处理将是稳健的。\n这种情况与问题要求的情况相反。\n**结论：不正确。**\n\n**C. 使用未缩放的系统 $F(u)=\\widetilde{F}(u)$ 和相同的 $M=Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，使得左 GMRES 最小化 $\\|Q^{-1}(\\widetilde{F}+\\widetilde{J}\\Delta u)\\|_{2}$，右 GMRES 最小化 $\\|\\widetilde{F}+\\widetilde{J}\\Delta u\\|_{2}$，而外层范数为 $\\|\\widetilde{F}(u)\\|_{2}$。**\n系统是 $J(u_k) = \\widetilde{J}(u_k)$ 且 $F(u_k) = \\widetilde{F}(u_k)$。外层范数是 $\\|\\widetilde{F}(u)\\|_2$。\n- 使用 $M=Q$ 进行左预处理求解 $Q^{-1}\\widetilde{J}_k \\Delta u = -Q^{-1}\\widetilde{F}_k$。GMRES 最小化 $\\|Q^{-1}(\\widetilde{F}_k + \\widetilde{J}_k \\Delta u_k)\\|_2$。由于 $Q^{-1}$ 缩放，这与外层范数 $\\|\\widetilde{F}_{k+1}\\|_2 \\approx \\|\\widetilde{F}_k + \\widetilde{J}_k \\Delta u_k\\|_2$ 不一致。这将导致停滞。\n- 使用 $M=Q$ 进行右预处理求解 $(\\widetilde{J}_k Q^{-1}) y = -\\widetilde{F}_k$。GMRES 最小化 $\\|\\widetilde{F}_k + \\widetilde{J}_k \\Delta u_k\\|_2$。这与外层范数完全一致。这将是稳健的。\n这种情况也与要求相反。\n**结论：不正确。**\n\n**D. 使用 $F(u)=Q\\,\\widetilde{F}(u)$，其中 $Q=\\operatorname{diag}(\\gamma,\\delta)$，$\\gamma\\gg 1\\gg \\delta$，但为左右预处理都选择 $M=Q^{-1}$，同时监控外层范数 $\\|\\widetilde{F}(u)\\|_{2}$ 并使用相同的内层停止准则。**\n外层范数是 $\\|\\widetilde{F}(u)\\|_2 = \\|Q^{-1}F(u)\\|_2$。基本系统是 $J \\Delta u = -F$。预处理器是 $M=Q^{-1}$。\n- 左预处理：求解 $(Q^{-1})^{-1}J \\Delta u = -(Q^{-1})^{-1}F$，即 $QJ\\Delta u = -QF$。GMRES 最小化 $\\|Q(F_k+J_k \\Delta u_k)\\|_2$。这与外层范数 $\\|Q^{-1}(F_{k+1})\\|_2 \\approx \\|Q^{-1}(F_k+J_k \\Delta u_k)\\|_2$ 不一致。这种设置是病态的。\n- 右预处理：求解 $J M^{-1} y = -F$，即 $J(Q^{-1})^{-1}y = -F$，或 $JQy = -F$。GMRES 最小化 $\\|F_k + J_k Q y_k\\|_2$。使用 $\\Delta u = M^{-1}y = Qy$，我们得到 $y = Q^{-1}\\Delta u$。最小化的量是 $\\|F_k + J_k Q (Q^{-1}\\Delta u_k)\\|_2 = \\|F_k + J_k \\Delta u_k\\|_2$。这与外层范数 $\\|Q^{-1}(F_{k+1})\\|_2$ 不一致。这种设置也是病态的。\n在这种情况下，两种预处理策略预计都会表现不佳。问题要求的是左预处理稳健而右预处理停滞的情况。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}