{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex simulations, it is essential to grasp the fundamental relationship between free energy and experimentally measurable quantities. This first practice exercise connects the thermodynamic quantity of Gibbs free energy ($\\Delta G^\\circ$) to the biochemical concept of binding affinity, represented by the dissociation constant ($K_d$). By working through this problem, you will learn how to quantify the impact of a mutation on binding stability, a core task in drug design and protein engineering. ",
            "id": "2112182",
            "problem": "In the development of a novel antibiotic, a researcher is studying its interaction with a crucial bacterial enzyme. The wild-type version of the enzyme binds to the antibiotic with a dissociation constant, $K_{d, \\text{WT}}$, of $1.0 \\times 10^{-6}$ M. A resistant strain of the bacterium is found to possess a single point mutation in this enzyme. Biochemical analysis reveals that this mutant enzyme binds to the same antibiotic with a significantly weaker affinity, characterized by a dissociation constant, $K_{d, \\text{MUT}}$, of $5.0 \\times 10^{-5}$ M.\n\nCalculate the change in the standard Gibbs free energy of binding, defined as $\\Delta \\Delta G^\\circ = \\Delta G^\\circ_{\\text{MUTANT}} - \\Delta G^\\circ_{\\text{WILD-TYPE}}$, that results from this single point mutation.\n\nAssume the measurements are made at a standard temperature of $298$ K. Use the value of the ideal gas constant, $R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$. Express your final answer in units of kJ/mol, rounded to three significant figures.",
            "solution": "The relationship between the standard Gibbs free energy of binding, $\\Delta G^\\circ$, and the equilibrium constant of the binding process is a fundamental principle in thermodynamics. For a binding reaction, the equilibrium constant is the association constant, $K_a$. The equation is:\n$$ \\Delta G^\\circ = -RT \\ln K_a $$\nwhere $R$ is the ideal gas constant and $T$ is the absolute temperature.\n\nThe problem provides the dissociation constant, $K_d$, which is the reciprocal of the association constant, $K_a$.\n$$ K_d = \\frac{1}{K_a} $$\nSubstituting this relationship into the free energy equation gives us an expression for $\\Delta G^\\circ$ in terms of $K_d$:\n$$ \\Delta G^\\circ = -RT \\ln\\left(\\frac{1}{K_d}\\right) $$\nUsing the property of logarithms that $\\ln(1/x) = -\\ln(x)$, we can simplify the equation to:\n$$ \\Delta G^\\circ = RT \\ln K_d $$\nThis equation applies to both the wild-type (WT) and mutant (MUT) enzyme-antibiotic interactions.\n\nFor the wild-type enzyme, the standard Gibbs free energy of binding is:\n$$ \\Delta G^\\circ_{\\text{WILD-TYPE}} = RT \\ln K_{d, \\text{WT}} $$\n\nFor the mutant enzyme, the standard Gibbs free energy of binding is:\n$$ \\Delta G^\\circ_{\\text{MUTANT}} = RT \\ln K_{d, \\text{MUT}} $$\n\nThe problem asks for the change in the standard Gibbs free energy of binding, $\\Delta \\Delta G^\\circ$, which is defined as the difference between the free energy of binding for the mutant and the wild-type:\n$$ \\Delta \\Delta G^\\circ = \\Delta G^\\circ_{\\text{MUTANT}} - \\Delta G^\\circ_{\\text{WILD-TYPE}} $$\nSubstituting the expressions for each $\\Delta G^\\circ$ term:\n$$ \\Delta \\Delta G^\\circ = (RT \\ln K_{d, \\text{MUT}}) - (RT \\ln K_{d, \\text{WT}}) $$\nWe can factor out the common term $RT$:\n$$ \\Delta \\Delta G^\\circ = RT (\\ln K_{d, \\text{MUT}} - \\ln K_{d, \\text{WT}}) $$\nUsing the logarithm property $\\ln(a) - \\ln(b) = \\ln(a/b)$, we get the final symbolic expression for $\\Delta \\Delta G^\\circ$:\n$$ \\Delta \\Delta G^\\circ = RT \\ln\\left(\\frac{K_{d, \\text{MUT}}}{K_{d, \\text{WT}}}\\right) $$\n\nNow, we can substitute the given numerical values into this expression.\nThe constants are:\n$R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n$T = 298 \\text{ K}$\n\nThe dissociation constants are:\n$K_{d, \\text{WT}} = 1.0 \\times 10^{-6} \\text{ M}$\n$K_{d, \\text{MUT}} = 5.0 \\times 10^{-5} \\text{ M}$\n\nFirst, calculate the ratio of the dissociation constants. Note that the units (M) will cancel out, leaving a dimensionless number, which is required for the argument of a logarithm.\n$$ \\frac{K_{d, \\text{MUT}}}{K_{d, \\text{WT}}} = \\frac{5.0 \\times 10^{-5} \\text{ M}}{1.0 \\times 10^{-6} \\text{ M}} = 50 $$\n\nNow, substitute this ratio and the constants into the equation for $\\Delta \\Delta G^\\circ$:\n$$ \\Delta \\Delta G^\\circ = (8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}) \\times (298 \\text{ K}) \\times \\ln(50) $$\nCalculate the product of $R$ and $T$:\n$$ RT = 8.314 \\times 298 \\approx 2477.572 \\text{ J/mol} $$\nCalculate the natural logarithm of 50:\n$$ \\ln(50) \\approx 3.912023 $$\nNow, multiply these values to find $\\Delta \\Delta G^\\circ$ in J/mol:\n$$ \\Delta \\Delta G^\\circ \\approx 2477.572 \\text{ J/mol} \\times 3.912023 \\approx 9692.23 \\text{ J/mol} $$\n\nThe problem asks for the answer in kJ/mol. To convert from J/mol to kJ/mol, we divide by 1000:\n$$ \\Delta \\Delta G^\\circ \\approx \\frac{9692.23}{1000} \\text{ kJ/mol} \\approx 9.69223 \\text{ kJ/mol} $$\nFinally, we must round the answer to three significant figures as requested:\n$$ \\Delta \\Delta G^\\circ \\approx 9.69 \\text{ kJ/mol} $$\nThe positive value indicates that the binding is less favorable (destabilized) for the mutant enzyme, which is consistent with its higher dissociation constant.",
            "answer": "$$\\boxed{9.69}$$"
        },
        {
            "introduction": "Calculating the absolute free energy of binding is computationally demanding, so a more tractable approach is to calculate the *relative* binding free energy between two similar ligands. This is achieved using a thermodynamic cycle, a conceptual cornerstone of computational free energy calculations. This exercise challenges you to design the correct alchemical pathway to determine the difference in binding affinity, a critical skill for lead optimization in drug discovery. ",
            "id": "2391919",
            "problem": "A protein $P$ binds two small-molecule ligands: a core ligand $L$ and an extended ligand $L^{\\ast}$. The ligand $L^{\\ast}$ is constructed by covalently appending a substituent $\\chi$ to $L$, so that $L$ is a strict substructure of $L^{\\ast}$. You wish to compute the relative binding free energy at standard concentration $c^{\\circ}=1\\,\\mathrm{M}$,\n$$\\Delta\\Delta G_{\\mathrm{bind}} \\equiv \\Delta G_{\\mathrm{bind}}(L^{\\ast})-\\Delta G_{\\mathrm{bind}}(L),$$\nby designing an alchemical thermodynamic cycle that transforms $L$ into $L^{\\ast}$ in the protein binding site and in bulk aqueous solution. All simulations are performed at fixed temperature and pressure, and when an alchemical transformation is carried out in the binding site, the protein environment is unchanged except for its interactions with the ligand being transformed. The solvent environment in the solution leg is bulk water with any required counterions at the same macroscopic thermodynamic conditions as the binding-site leg.\n\nFor clarity, the following process-level symbols are available to you:\n\n- $\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$: the equilibrium free energy change to alchemically morph $L$ into $L^{\\ast}$ in the binding site of $P$ under otherwise identical thermodynamic conditions, without changing the number of particles, and without introducing or removing any external restraints beyond those inherent to the alchemical mapping itself.\n\n- $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$: the equilibrium free energy change to morph $L$ into $L^{\\ast}$ in bulk solvent, with no restraints applied.\n\n- $\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X)$: the equilibrium free energy to alchemically turn off all nonbonded interactions of ligand $X\\in\\{L,L^{\\ast}\\}$ with its environment in the binding site of $P$ while keeping the chemical topology of $X$ intact; this process is performed under a position-orientation restraint that keeps $X$ localized in the binding site during decoupling.\n\n- $\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(X)$: the equilibrium free energy to turn off all nonbonded interactions of ligand $X$ in bulk solvent, with no restraints.\n\n- $\\Delta G_{\\mathrm{release}}^{\\circ}$: the analytic standard-state correction required to release a fully decoupled, harmonically restrained ligand from its restraint to a $c^{\\circ}=1\\,\\mathrm{M}$ noninteracting ideal gas in the same volume, if such a restraint-release step is part of the cycle.\n\nAssume that any term involving a restraint must explicitly include $\\Delta G_{\\mathrm{release}}^{\\circ}$ if it is needed for a valid standard-state cycle. Which of the following expressions correctly yields $\\Delta\\Delta G_{\\mathrm{bind}}$ for this substructure pair using a minimal, closed thermodynamic cycle?\n\nA. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\n\nB. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\n\nC. $\\Delta\\Delta G_{\\mathrm{bind}}=\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L)-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L)\\big]-\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L^{\\ast})-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L^{\\ast})\\big]$.\n\nD. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$.\n\nE. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{release}}^{\\circ}$.",
            "solution": "The problem asks for the correct expression for the relative binding free energy, $\\Delta\\Delta G_{\\mathrm{bind}}$, of two ligands, $L$ and $L^{\\ast}$, to a protein $P$. The ligand $L^{\\ast}$ is a superset of $L$. The calculation is to be based on an alchemical thermodynamic cycle.\n\nFirst, we establish the fundamental principle. The Gibbs free energy, $G$, is a state function. This means that for any closed thermodynamic cycle, the net change in free energy is zero. We will construct such a cycle connecting the physical processes of binding with the computational, alchemical processes of transforming one ligand into another.\n\nThe states involved in our system are combinations of the protein $P$ and the ligands $L$ and $L^{\\ast}$ in their bound and unbound forms:\n$1$. The protein-ligand complex $P:L$.\n$2$. The protein-ligand complex $P:L^{\\ast}$.\n$3$. The unbound protein $P$ and ligand $L$ in solution.\n$4\". The unbound protein $P$ and ligand $L^{\\ast}$ in solution.\n\nThe standard binding free energies for the physical processes are defined as:\n$$ \\Delta G_{\\mathrm{bind}}(L) = G(P:L) - [G(P) + G(L)] $$\n$$ \\Delta G_{\\mathrm{bind}}(L^{\\ast}) = G(P:L^{\\ast}) - [G(P) + G(L^{\\ast})] $$\nHere, $G(\\cdot)$ represents the standard Gibbs free energy of the specified species. The quantity we seek to calculate is the relative binding free energy:\n$$ \\Delta\\Delta G_{\\mathrm{bind}} \\equiv \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L) $$\nSubstituting the definitions above and simplifying, we get:\n$$ \\Delta\\Delta G_{\\mathrm{bind}} = [G(P:L^{\\ast}) - G(P:L)] - [G(L^{\\ast}) - G(L)] $$\n\nNow, we construct the thermodynamic cycle. The cycle connects these four states through four processes (two physical, two alchemical).\n- Path A (physical, horizontal top): Binding of $L$. $P + L \\rightarrow P:L$. The free energy change is $\\Delta G_{\\mathrm{bind}}(L)$.\n- Path B (physical, horizontal bottom): Binding of $L^{\\ast}$. $P + L^{\\ast} \\rightarrow P:L^{\\ast}$. The free energy change is $\\Delta G_{\\mathrm{bind}}(L^{\\ast})$.\n- Path C (alchemical, vertical left): Morphing of $L$ to $L^{\\ast}$ in solvent. $P + L \\rightarrow P + L^{\\ast}$. The protein $P$ is merely a spectator. The free energy change is $G(L^{\\ast}) - G(L)$, which is precisely the quantity defined in the problem as $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\n- Path D (alchemical, vertical right): Morphing of $L$ to $L^{\\ast}$ in the binding site. $P:L \\rightarrow P:L^{\\ast}$. The free energy change is $G(P:L^{\\ast}) - G(P:L)$, which is the quantity defined as $\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$.\n\nThe thermodynamic cycle can be visualized as a rectangle:\n$$\n\\begin{array}{ccc}\nP + L & \\xrightarrow{\\Delta G_{\\mathrm{bind}}(L)} & P:L \\\\\n\\downarrow{\\tiny\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})} & & \\downarrow{\\tiny\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})} \\\\\nP + L^{\\ast} & \\xrightarrow{\\Delta G_{\\mathrm{bind}}(L^{\\ast})} & P:L^{\\ast}\n\\end{array}\n$$\nSince $G$ is a state function, the sum of free energy changes around a closed loop is zero. Traversing the cycle clockwise starting from the state $P+L$:\n$$ \\Delta G_{\\mathrm{bind}}(L) + \\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) = 0 $$\nNote that the reverse of Path B has a free energy change of $-\\Delta G_{\\mathrm{bind}}(L^{\\ast})$ and the reverse of Path C has a change of $-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\nRearranging this equation to solve for the desired quantity, $\\Delta\\Delta G_{\\mathrm{bind}} = \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L)$:\n$$ \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L) = \\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast}) - \\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) $$\nTherefore:\n$$ \\Delta\\Delta G_{\\mathrm{bind}} = \\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast}) - \\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) $$\n\nThis derivation is based on the \"relative\" or \"morphing\" alchemical pathway. The problem statement's definitions of $\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$ and $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$ are consistent with this pathway. It is crucial to note that for this type of calculation involving substructure modification, the large entropic contributions to binding related to translation and rotation are assumed to be similar for both $L$ and $L^{\\ast}$ and thus cancel in the relative free energy. Consequently, the standard-state correction term $\\Delta G_{\\mathrm{release}}^{\\circ}$ is not required for this specific cycle. The definition of $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$ explicitly states \"with no restraints applied\", supporting this conclusion.\n\nNow we evaluate each option.\n\nA. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\nThis expression matches our derivation from the thermodynamic cycle exactly. It correctly represents the relative binding free energy as the difference between the alchemical transformation free energy in the protein and in the solvent.\n**Verdict: Correct.**\n\nB. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})$.\nThis expression has an incorrect sign for the solvation term. According to the thermodynamic cycle, the solvation and bound legs must be subtracted, not added. This would correspond to an invalid cycle construction.\n**Verdict: Incorrect.**\n\nC. $\\Delta\\Delta G_{\\mathrm{bind}}=\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L)-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L)\\big]-\\big[\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(L^{\\ast})-\\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(L^{\\ast})\\big]$.\nThis expression is structured according to a different methodology, often called \"double decoupling\", which computes absolute binding free energies for each ligand separately. The absolute binding free energy is approximately $\\Delta G_{\\mathrm{bind}}(X) \\approx \\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(X) - \\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X)$. Based on this, the expression in C becomes $\\Delta\\Delta G_{\\mathrm{bind}} \\approx [-\\Delta G_{\\mathrm{bind}}(L)] - [-\\Delta G_{\\mathrm{bind}}(L^{\\ast})] = \\Delta G_{\\mathrm{bind}}(L^{\\ast}) - \\Delta G_{\\mathrm{bind}}(L)$. While this appears correct, it ignores the critical detail of standard state corrections. The definition of $\\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X)$ requires a positional restraint. According to the problem statement, any term involving such a restraint must include $\\Delta G_{\\mathrm{release}}^{\\circ}$ for a valid standard-state cycle. The proper expression for the standard binding free energy is $\\Delta G_{\\mathrm{bind}}^{\\circ}(X) = \\Delta G_{\\mathrm{decouple}}^{\\mathrm{solv}}(X) - \\Delta G_{\\mathrm{decouple}}^{\\mathrm{bound}}(X) - \\Delta G_{\\mathrm{release}}^{\\circ}$. The expression in option C omits these non-canceling restraint correction terms and is therefore an incomplete and incorrect formula for the standard relative binding free energy via this pathway.\n**Verdict: Incorrect.**\n\nD. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})$.\nThis expression would be correct only if $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) = 0$. This would mean that the free energy of solvation is identical for ligands $L$ and $L^{\\ast}$. Since $L^{\\ast}$ is constructed by adding a substituent $\\chi$ to $L$, their chemical properties and interactions with the solvent (water) will necessarily differ. Thus, $\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast}) \\neq 0$ in any non-trivial case.\n**Verdict: Incorrect.**\n\nE. $\\Delta\\Delta G_{\\mathrm{bind}}=\\Delta G_{\\mathrm{bound}}(L\\to L^{\\ast})-\\Delta G_{\\mathrm{solv}}(L\\to L^{\\ast})+\\Delta G_{\\mathrm{release}}^{\\circ}$.\nThis option incorrectly adds a standard state correction term $\\Delta G_{\\mathrm{release}}^{\\circ}$ to the correct relative free energy expression. As discussed previously, for a relative calculation between two related ligands with a common core, the entropic changes associated with binding are assumed to cancel. The alchemical morphing pathway as defined does not require the use of the types of restraints whose release is corrected by $\\Delta G_{\\mathrm{release}}^{\\circ}$. This term is pertinent to absolute binding free energy calculations (as in pathway C), not this relative one.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a simulation based on a thermodynamic cycle is run, we are left with raw data in the form of potential energy differences, and the final step is to use a statistical estimator to calculate the free energy change. This problem introduces the Bennett Acceptance Ratio (BAR) method, a highly efficient and accurate technique for this purpose. By implementing the BAR equation to process simulated data, you will gain hands-on experience with the rigorous data analysis that underpins modern free energy calculations. ",
            "id": "2455727",
            "problem": "You are given discrete samples from two thermodynamic states that represent an alchemical transformation between a wild-type protein (state $0$) and a mutant protein (state $1$). For each thermodynamic environment (bound complex and unbound ligand in solvent), you are provided two lists of dimensionless reduced potential energy differences, defined for a configuration $\\mathbf{x}$ as $\\Delta u(\\mathbf{x}) = \\beta \\left[ U_1(\\mathbf{x}) - U_0(\\mathbf{x}) \\right]$, where $\\beta = 1/(k_B T)$, $U_0$ and $U_1$ are the potential energies of states $0$ and $1$, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. One list, $\\{\\Delta u_i^{(0)}\\}_{i=1}^{n_0}$, contains values computed from configurations sampled in state $0$ (each element is $\\Delta u(\\mathbf{x}_i)$ with $\\mathbf{x}_i \\sim \\pi_0$), and the other list, $\\{\\Delta u_j^{(1)}\\}_{j=1}^{n_1}$, contains values computed from configurations sampled in state $1$ (each element is $\\Delta u(\\mathbf{y}_j)$ with $\\mathbf{y}_j \\sim \\pi_1$). The dimensionless free energy difference $\\Delta f$ between state $1$ and state $0$ is defined as the unique real number that satisfies the implicit equation\n$$\n\\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}\n=\n\\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}.\n$$\nFor each environment (bound and unbound), compute $\\Delta f$ from the corresponding pair of lists. The binding free energy change of mutation relative to wild-type, denoted $\\Delta\\Delta G_{\\text{bind}}$, is then given by\n$$\n\\Delta\\Delta G_{\\text{bind}} = \\left( \\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}} \\right) \\, k_B T N_A,\n$$\nwhere $N_A$ is Avogadro's number. Express $\\Delta\\Delta G_{\\text{bind}}$ in kilojoules per mole (kJ/mol). Use $k_B = 1.380\\,649 \\times 10^{-23}$ joule per kelvin, $N_A = 6.022\\,140\\,76 \\times 10^{23}$ per mole, and $T$ as specified in each test case. Note that $k_B T N_A = R T$, where $R$ is the molar gas constant.\n\nYour program must evaluate $\\Delta\\Delta G_{\\text{bind}}$ for each of the following test cases and output a single line containing a comma-separated list of the three results enclosed in square brackets. Each result must be rounded to exactly three decimal places, in kJ/mol.\n\nTest suite:\n- Case $1$ (happy path, moderate overlap):\n  - Temperature: $T = 300$ K.\n  - Bound environment:\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,-1.2,\\,-0.8,\\,-1.0,\\,-1.1,\\,-0.9,\\,-1.3,\\,-0.7,\\,-1.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,-0.4,\\,-0.6,\\,-0.5,\\,-0.7,\\,-0.8,\\,-0.3,\\,-0.6,\\,-0.5\\,]$\n  - Unbound environment:\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.2,\\,0.1,\\,0.3,\\,0.0,\\,0.4,\\,0.2,\\,0.1,\\,0.3\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.5,\\,0.4,\\,0.6,\\,0.7,\\,0.3,\\,0.5,\\,0.4,\\,0.6\\,]$\n- Case $2$ (boundary, identical states):\n  - Temperature: $T = 300$ K.\n  - Bound environment:\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n  - Unbound environment:\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n- Case $3$ (unequal sample sizes, skewed distributions):\n  - Temperature: $T = 300$ K.\n  - Bound environment:\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,0.9,\\,1.1,\\,0.8,\\,1.0,\\,0.7,\\,1.2\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,0.4,\\,0.3,\\,0.5\\,]$\n  - Unbound environment:\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.2,\\,0.3,\\,0.1,\\,0.4,\\,0.2,\\,0.3\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.1,\\,0.2\\,]$\n\nRequirements:\n- Use the provided definition of $\\Delta f$ for each environment.\n- Compute $\\Delta\\Delta G_{\\text{bind}}$ in $\\text{kJ}\\cdot\\text{mol}^{-1}$ for each case and round to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\") with no spaces and no additional text.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extracted Givens**\n- Definition of dimensionless reduced potential energy difference: $\\Delta u(\\mathbf{x}) = \\beta \\left[ U_1(\\mathbf{x}) - U_0(\\mathbf{x}) \\right]$.\n- Sampled data from state $0$: $\\{\\Delta u_i^{(0)}\\}_{i=1}^{n_0}$.\n- Sampled data from state $1$: $\\{\\Delta u_j^{(1)}\\}_{j=1}^{n_1}$.\n- Implicit equation for dimensionless free energy difference $\\Delta f$:\n$$\n\\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}\n=\n\\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}.\n$$\n- Formula for binding free energy change: $\\Delta\\Delta G_{\\text{bind}} = \\left( \\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}} \\right) \\, k_B T N_A$.\n- Constants: $k_B = 1.380\\,649 \\times 10^{-23} \\, \\text{J/K}$, $N_A = 6.022\\,140\\,76 \\times 10^{23} \\, \\text{mol}^{-1}$.\n- Test cases provide specific temperatures $T$ and lists of $\\{\\Delta u\\}$ values for 'bound' and 'unbound' environments.\n\n**Step 2: Validation**\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: The problem describes the Bennett Acceptance Ratio (BAR) method, a rigorous and widely used statistical mechanics technique for calculating free energy differences. The provided equation is the correct maximum likelihood estimator for $\\Delta f$ derived from the BAR method. The thermodynamic cycle used to define $\\Delta\\Delta G_{\\text{bind}}$ is also a standard and fundamental concept in chemistry.\n- **Well-Posedness**: The core task is to solve the given implicit equation for $\\Delta f$. We wish to find the root of the function $g(\\Delta f)$, defined as:\n$$\ng(\\Delta f) = \\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - K \\right)} - \\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - K \\right)}\n$$\nwhere $K = \\ln(n_1/n_0)$.\nTo assess if a unique solution exists, we examine the derivative of $g(\\Delta f)$ with respect to $\\Delta f$. Let $h(x) = (1 + e^x)^{-1}$. Its derivative is $h'(x) = -e^x(1+e^x)^{-2} = -h(x)(1-h(x))$, which is strictly negative.\nThe derivative of the first term with respect to $\\Delta f$ is $\\sum_{i=1}^{n_0} h'(\\dots) \\cdot (-1) > 0$.\nThe derivative of the second term with respect to $\\Delta f$ is $\\sum_{j=1}^{n_1} h'(\\dots) \\cdot (+1) < 0$.\nTherefore, the derivative of their difference, $g'(\\Delta f)$, is the sum of two positive terms and is thus strictly positive. This proves that $g(\\Delta f)$ is a strictly monotonic increasing function of $\\Delta f$. Furthermore, as $\\Delta f \\to \\infty$, $g(\\Delta f) \\to n_0 > 0$. As $\\Delta f \\to -\\infty$, $g(\\Delta f) \\to -n_1 < 0$. A continuous, monotonic function that crosses the axis from negative to positive must have exactly one root. The problem is therefore well-posed.\n- **Objectivity and Completeness**: The problem is stated using precise, unambiguous mathematical and scientific language. All necessary data and constants are provided. No flaws are identified.\n\n**Verdict:** The problem is valid.\n\n**Solution Procedure**\nThe solution proceeds by first determining the dimensionless free energy difference, $\\Delta f$, for each thermodynamic environment (bound protein-ligand complex and unbound ligand in solvent). This is achieved by numerically solving the provided implicit equation. The change in binding free energy, $\\Delta\\Delta G_{\\text{bind}}$, is then calculated from these values.\n\n1.  **Solving for $\\Delta f$**: For each environment, we must find the root of the function $g(\\Delta f) = 0$. Since $g(\\Delta f)$ is proven to be monotonic, we can employ a robust one-dimensional root-finding algorithm. Brent's method is an excellent choice for this purpose due to its efficiency and guaranteed convergence within a bracketing interval. We must define the function $g(\\Delta f)$ based on the input data arrays $\\{\\Delta u_i^{(0)}\\}$ and $\\{\\Delta u_j^{(1)}\\}$, and the sample sizes $n_0$ and $n_1$. The constant term $K = \\ln(n_1/n_0)$ is pre-calculated. A wide search interval, such as $[-100, 100]$, is sufficient to bracket the root given the function's asymptotic behavior.\n\n2.  **Calculating $\\Delta\\Delta G_{\\text{bind}}$**: Once the free energy differences for the bound ($\\Delta f_{\\text{bound}}$) and unbound ($\\Delta f_{\\text{unbound}}$) states are computed, the relative binding free energy is calculated using the thermodynamic cycle relation:\n    $$\n    \\Delta\\Delta G_{\\text{bind}} = (\\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}}) \\times k_B T N_A\n    $$\n    The product $k_B N_A$ is the molar gas constant, $R \\approx 8.314\\,462\\,618 \\dots \\, \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$. The resulting value, initially in Joules per mole, must be converted to kilojoules per mole by dividing by $1000$.\n\n3.  **Implementation**: The overall algorithm is implemented in a Python program. For each test case, the procedure is:\n    a. Extract the temperature $T$ and the four lists of energy differences.\n    b. Call a helper function that implements Brent's method (using `scipy.optimize.brentq`) to solve for $\\Delta f_{\\text{bound}}$ using the 'bound' data.\n    c. Call the same helper function to solve for $\\Delta f_{\\text{unbound}}$ using the 'unbound' data.\n    d. Compute $\\Delta\\Delta G_{\\text{bind}}$ in $\\text{kJ/mol}$ using the values from steps b and c.\n    e. Round the result to three decimal places as required.\n    f. Collect the results for all test cases and format them into the specified output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the change in binding free energy for three test cases\n    using the Bennett Acceptance Ratio (BAR) method.\n    \"\"\"\n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    N_A = 6.02214076e+23 # Avogadro's number in mol^-1\n    R_J_PER_MOL_K = K_B * N_A # Molar gas constant in J/(mol*K)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [-1.2, -0.8, -1.0, -1.1, -0.9, -1.3, -0.7, -1.0],\n                \"u1\": [-0.4, -0.6, -0.5, -0.7, -0.8, -0.3, -0.6, -0.5],\n            },\n            \"unbound\": {\n                \"u0\": [0.2, 0.1, 0.3, 0.0, 0.4, 0.2, 0.1, 0.3],\n                \"u1\": [0.5, 0.4, 0.6, 0.7, 0.3, 0.5, 0.4, 0.6],\n            },\n        },\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [0.0, 0.0, 0.0, 0.0],\n                \"u1\": [0.0, 0.0, 0.0, 0.0],\n            },\n            \"unbound\": {\n                \"u0\": [0.0, 0.0, 0.0, 0.0],\n                \"u1\": [0.0, 0.0, 0.0, 0.0],\n            },\n        },\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [0.9, 1.1, 0.8, 1.0, 0.7, 1.2],\n                \"u1\": [0.4, 0.3, 0.5],\n            },\n            \"unbound\": {\n                \"u0\": [0.2, 0.3, 0.1, 0.4, 0.2, 0.3],\n                \"u1\": [0.0, 0.1, 0.2],\n            },\n        },\n    ]\n\n    def _bar_objective_function(delta_f, u0, u1, log_n1_over_n0):\n        \"\"\"\n        The objective function for BAR, the root of which is delta_f.\n        g(delta_f) = LHS - RHS from the problem statement.\n        \"\"\"\n        # Arguments for the exponential function\n        arg1 = u0 - delta_f - log_n1_over_n0\n        arg2 = -u1 + delta_f - log_n1_over_n0\n        \n        # Fermi-Dirac-like terms\n        # np.exp handles large negative exponents (result is 0) and large positive\n        # exponents (result is inf), which leads to the correct limit of 0 for 1/inf.\n        lhs = np.sum(1.0 / (1.0 + np.exp(arg1)))\n        rhs = np.sum(1.0 / (1.0 + np.exp(arg2)))\n        \n        return lhs - rhs\n\n    def calculate_delta_f(u0_list, u1_list):\n        \"\"\"\n        Calculates the dimensionless free energy difference (delta_f)\n        by finding the root of the BAR equation.\n        \"\"\"\n        u0 = np.array(u0_list, dtype=np.float64)\n        u1 = np.array(u1_list, dtype=np.float64)\n        \n        n0 = len(u0)\n        n1 = len(u1)\n        \n        if n0 == 0 or n1 == 0:\n            raise ValueError(\"Sample lists cannot be empty.\")\n\n        log_n1_over_n0 = np.log(n1 / n0)\n        \n        # Use brentq a robust root-finding algorithm. The function is monotonic,\n        # so a wide bracket is safe.\n        try:\n            # A search interval of [-100, 100] is sufficiently large.\n            delta_f = brentq(\n                _bar_objective_function,\n                a=-100.0,\n                b=100.0,\n                args=(u0, u1, log_n1_over_n0)\n            )\n        except ValueError:\n            # This can happen if the function does not cross zero within the interval,\n            # which indicates an issue with the data or interval. For this problem,\n            # it should not occur. A wider interval could be used if necessary.\n            delta_f = brentq(\n                _bar_objective_function,\n                a=-1000.0,\n                b=1000.0,\n                args=(u0, u1, log_n1_over_n0)\n            )\n\n        return delta_f\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        \n        # Calculate delta_f for the bound state\n        delta_f_bound = calculate_delta_f(case[\"bound\"][\"u0\"], case[\"bound\"][\"u1\"])\n        \n        # Calculate delta_f for the unbound state\n        delta_f_unbound = calculate_delta_f(case[\"unbound\"][\"u0\"], case[\"unbound\"][\"u1\"])\n        \n        # Calculate the final binding free energy change in kJ/mol\n        # delta_delta_G = (delta_f_bound - delta_f_unbound) * R * T\n        delta_delta_G_j_mol = (delta_f_bound - delta_f_unbound) * R_J_PER_MOL_K * T\n        delta_delta_G_kj_mol = delta_delta_G_j_mol / 1000.0\n        \n        results.append(delta_delta_G_kj_mol)\n\n    # Format the results to exactly three decimal places and create the final output string.\n    formatted_results = [\"{:.3f}\".format(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}