{
    "hands_on_practices": [
        {
            "introduction": "分子动力学模拟的核心是力场，它通过一套数学函数和参数来描述原子间的相互作用。理解这些参数的物理意义对于解释模拟结果至关重要。本练习将通过一个思想实验，探讨力场中 Lennard-Jones 势的尺寸参数 $\\sigma$ 的微小改变，如何对蛋白质的整体结构和动力学行为（如回旋半径和扩散系数）产生可预测的宏观影响（）。",
            "id": "2417106",
            "problem": "一个单链球状蛋白在显式水中使用全原子分子动力学（MD）进行模拟。所有非键参数均为标准参数，但所有骨架 $\\alpha$-碳原子的 Lennard-Jones $\\sigma$ 参数统一增加了 $15\\%$。Lennard-Jones $\\epsilon$ 参数和所有静电部分电荷保持不变。假设对不同类型的原子对使用标准的 Lorentz–Berthelot 混合规则，并且模拟在恒温恒压下运行足够长的时间以重新达到平衡。相对于未修改的模拟，哪个陈述最能描述蛋白质动力学和堆积方面预期的定性变化？\n\nA. 骨架碳原子周围的有效范德华排斥作用增加，使优选的原子间距向外移动；平均回转半径 $R_g$ 略有增加，天然分子内接触的数量减少，平动扩散系数 $D$ 减小。\n\nB. Lennard-Jones 势能最小值的向外移动增加了吸引范围并稳定了更紧密的堆积；平均回转半径 $R_g$ 减小，平动扩散系数 $D$ 增大。\n\nC. 预计不会有明显变化，因为只有 $\\alpha$-碳原子被修改，而它们不控制堆积；堆积度量和平动扩散系数 $D$ 都保持不变。\n\nD. Lennard-Jones $\\sigma$ 的增加有效地增加了蛋白质的质量，这减少了均方根涨落，并使回转半径 $R_g$ 保持不变。",
            "solution": "按照要求，首先将验证问题陈述。\n\n**步骤 1：提取给定条件**\n- 系统：显式水中的单链球状蛋白。\n- 模拟：全原子分子动力学（MD）。\n- 力场微扰：所有骨架 $\\alpha$-碳原子（$C_\\alpha$）的 Lennard-Jones（LJ）$\\sigma$ 参数统一增加 $15\\%$。\n- 不变参数：LJ $\\epsilon$ 参数和所有静电部分电荷。\n- 混合规则：标准 Lorentz–Berthelot 混合规则。\n- 模拟系综：恒温恒压（NPT）。\n- 平衡：允许系统重新达到平衡。\n- 问题：描述相对于未修改的模拟，蛋白质动力学（平动扩散系数 $D$）和堆积（回转半径 $R_g$，天然接触）方面的预期定性变化。\n\n**步骤 2：使用提取的给定条件进行验证**\n该问题描述了一个在经典分子动力学框架内定义明确的计算实验。其组成部分——蛋白质、显式水、全原子力场、Lennard-Jones 势、Lorentz-Berthelot 规则和 NPT 系综——都是计算生物物理学领域的标准配置。修改力场参数（$\\sigma$）是一种研究原子相互作用的能量和结构后果的常用技术。所提及的可观测量（$R_g$，$D$，分子内接触）是表征蛋白质结构和动力学的标准度量。该问题在科学上是合理的、自洽的、客观的且定义明确的。它要求基于统计力学和高分子物理学的基本原理进行定性预测。\n\n**步骤 3：结论和行动**\n问题陈述有效。将推导解决方案。\n\n**解决方案的推导**\nLennard-Jones 势用于模拟范德华相互作用，其公式为：\n$$V_{LJ}(r_{ij}) = 4\\epsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6} \\right]$$\n这里，$r_{ij}$ 是原子 $i$ 和 $j$ 之间的距离。参数 $\\sigma_{ij}$ 表示粒子间势能为零时的有限距离，与有效原子尺寸或范德华半径直接相关。与 $(r_{ij})^{-12}$ 成正比的排斥项在短距离内占主导地位，模拟空间排斥。与 $(r_{ij})^{-6}$ 成正比的吸引项在中等距离内占主导地位。势能在距离 $r_{min} = 2^{1/6}\\sigma_{ij}$ 处达到最小值。\n\n问题陈述指出，对于一个 $\\alpha$-碳原子 $i$，其自相互作用参数 $\\sigma_{ii}$ 增加了：$\\sigma'_{ii} = 1.15 \\times \\sigma_{ii}$。根据 Lorentz–Berthelot 混合规则，对于一个由原子 $(i,j)$ 组成的非相似对，其中 $i$ 是一个 $C_\\alpha$，混合参数 $\\sigma'_{ij}$ 变为：\n$$ \\sigma'_{ij} = \\frac{\\sigma'_{ii} + \\sigma_{jj}}{2} = \\frac{1.15\\sigma_{ii} + \\sigma_{jj}}{2} $$\n由于 $\\sigma_{ii}$ 和 $\\sigma_{jj}$ 是正定的，很明显 $\\sigma'_{ij} > \\sigma_{ij}$，其中 $\\sigma_{ij} = (\\sigma_{ii} + \\sigma_{jj})/2$。\n\n$\\sigma'_{ij}$ 的增加有两个主要后果：\n1.  **增加的空间排斥：** 势能的排斥壁被向外推。对于任何给定的原子间距 $r_{ij}$，排斥能 $4\\epsilon_{ij}(\\sigma'_{ij}/r_{ij})^{12}$ 比之前显著增大。这意味着其他原子被 $C_\\alpha$ 碳原子更强烈地排斥。这构成了这些骨架原子周围有效范德华排斥体积的增加。\n2.  **势能最小值的移动：** 最佳相互作用距离 $r'_{min} = 2^{1/6}\\sigma'_{ij}$ 增加。与骨架 $\\alpha$-碳原子相互作用的原子现在将倾向于保持更大的间距。\n\n由于 $\\alpha$-碳原子构成了多肽链的骨架，它们在结构上至关重要。增加它们的有效尺寸迫使整个链进行调整。为了避免能量上不利的空间冲突，蛋白质必须膨胀。这导致整体结构变得不那么紧凑。\n- 因此，衡量蛋白质尺寸的平均回转半径 $R_g$ 将会**增加**。\n- 这种膨胀扰乱了天然状态下精细调整的堆积。侧链将重新排列，最佳的相互作用网络将被破坏。因此，天然分子内接触的数量预计会**减少**。\n\n接下来，我们考虑对动力学的影响。平动扩散系数 $D$ 描述了蛋白质在溶剂中移动的速度。对于在粘性流体中近似球形的物体，这由斯托克斯-爱因斯坦方程描述：\n$$ D = \\frac{k_B T}{6 \\pi \\eta R_h} $$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\eta$ 是溶剂（水）的粘度，$R_h$ 是蛋白质的流体力学半径。流体力学半径是衡量大分子在溶液中翻滚和扩散时有效尺寸的指标。它与回转半径 $R_g$ 密切相关。既然我们已经确定蛋白质会膨胀（$R_g$ 增加），其流体力学半径 $R_h$ 也将**增加**。由于 $D$ 与 $R_h$ 成反比，平动扩散系数 $D$ 将**减小**。更大、更膨胀的蛋白质会受到溶剂更大的拖拽力，从而扩散得更慢。\n\n总而言之，该修改导致：空间排斥增加，$R_g$ 增加，天然接触减少，以及 $D$ 减少。\n\n**选项评估**\n\n**A. 骨架碳原子周围的有效范德华排斥作用增加，使优选的原子间距向外移动；平均回转半径 $R_g$ 略有增加，天然分子内接触的数量减少，平动扩散系数 $D$ 减小。**\n该陈述与推导完全一致。$\\sigma$ 的增加增大了范德华排斥，并使优选距离向外移动。这导致蛋白质膨胀（$R_g$ 增加），从而破坏了天然堆积（接触减少）。更大的尺寸导致更慢的扩散（$D$ 减小）。\n**结论：正确。**\n\n**B. Lennard-Jones 势能最小值的向外移动增加了吸引范围并稳定了更紧密的堆积；平均回转半径 $R_g$ 减小，平动扩散系数 $D$ 增大。**\n该陈述不正确。虽然吸引*范围*在技术上确实延伸得更远，但增加 $\\sigma$ 的主要效应是在更短距离上更强的排斥力，这会*破坏*紧密堆积的稳定性。这导致 $R_g$ 增加而不是减小。增加的 $R_g$ 对应于 $D$ 的减小而不是增大。\n**结论：不正确。**\n\n**C. 预计不会有明显变化，因为只有 $\\alpha$-碳原子被修改，而它们不控制堆积；堆积度量和平动扩散系数 $D$ 都保持不变。**\n该陈述基于一个错误的前提。骨架 $C_\\alpha$ 原子是定义蛋白质折叠和整体堆积的基础。修改它们的有效尺寸是一个显著的微扰，将导致结构和动力学发生明显变化。\n**结论：不正确。**\n\n**D. Lennard-Jones $\\sigma$ 的增加有效地增加了蛋白质的质量，这减少了均方根涨落，并使回转半径 $R_g$ 保持不变。**\n该陈述将 LJ 尺寸参数 $\\sigma$ 与质量混淆了。这是两个不同的物理量。增加 $\\sigma$ 不会改变模拟中任何原子的质量。因此，基于这一错误前提得出的后续结论是无效的。此外，$R_g$ 预计会发生变化，而不是保持不变。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然分子动力学模拟能够准确地对系统的热力学平衡态进行抽样，但它所揭示的动力学路径——即系统从一个状态转变为另一个状态的过程——对模拟方法的选择极为敏感。本练习通过一个蛋白质-配体结合的案例，展示了一个不符合物理实际的恒温器摩擦系数 $\\gamma$ 如何会人为地改变事件发生的时间顺序，从而可能导致对结合机制的错误判断（）。这个例子提醒我们，在解释模拟的动力学过程时，必须批判性地审视所使用的参数。",
            "id": "2417122",
            "problem": "一种蛋白质受体可以采纳两种可相互转换的构象状态：一种是呈现出完全形成的结合口袋的开放状态$P_{\\mathrm{O}}$，另一种是口袋被封闭的关闭状态$P_{\\mathrm{C}}$。在没有配体的情况下，$P_{\\mathrm{O}} \\rightleftharpoons P_{\\mathrm{C}}$ 的转变在温度$T=300\\,\\mathrm{K}$下于亚微秒时间尺度上发生。一个小配体$L$从溶液主体中结合过来。一名研究人员使用分子动力学（MD）模拟了该结合过程，采用朗之万恒温器，摩擦系数$\\gamma=100\\ \\mathrm{ps}^{-1}$，溶剂为隐式溶剂，积分时间步长为$2\\ \\mathrm{fs}$。他观察到多个结合事件，其中$L$首先与$P_{\\mathrm{C}}$形成一个松散的、非特异性的接触，随后蛋白质发生较慢的构象变化转变为$P_{\\mathrm{O}}$，而$L$始终保持结合状态。基于这些轨迹，该研究人员得出结论，认为结合机制是诱导契合（即配体结合后发生构象变化）。该系统没有可用的实验动力学数据。所有模拟的运行时长都足以使结合态和非结合态的平衡布居收敛。\n\n哪个选项最好地解释了为什么由于$\\gamma$的选择，这个结论可能是不正确的，并指出了一个适当的方法学上的改变来检验该机制的推断？\n\nA. 极大的$\\gamma$会驱动系统进入过阻尼状态，该状态不成比例地抑制了蛋白质构象转变速率相对于配体平移扩散的速率，从而使事件发生的时间顺序偏向于表观的诱导契合；解决方法是，将$\\gamma$减小到一个物理上现实的范围（例如，$\\gamma\\sim 1\\ \\mathrm{ps}^{-1}$），验证平衡统计量保持不变，并将推断出的事件序列和有效扩散与已知的物理值进行比较。\n\nB. 极大的$\\gamma$会改变正则平衡分布，增加了$P_{\\mathrm{C}}$的布居，从而强制形成诱导契合；解决方法是在相同的$\\gamma$下运行更长时间，直到平衡恢复。\n\nC. 极大的$\\gamma$违反了涨落-耗散关系并破坏了细致平衡，引入了一种非物理的漂移，该漂移有利于结合后的构象变化；解决方法是将随机力设置为零，同时保留摩擦项。\n\nD. 极大的$\\gamma$提高了数值稳定性和跨越能垒估计的准确性，因此观察到的诱导契合比在较低$\\gamma$下更可靠；解决方法是在不改变$\\gamma$的情况下进一步增长时间步长以加速采样。",
            "solution": "问题陈述描述了一个计算实验，旨在阐明配体$L$与一个存在两种构象——$P_{\\mathrm{O}}$（开放）和$P_{\\mathrm{C}}$（关闭）——的蛋白质受体的结合机制。在继续之前，必须确定问题设置的有效性。\n\n**问题有效性验证**\n\n**步骤1：提取已知条件**\n- 系统：具有$P_{\\mathrm{O}}$和$P_{\\mathrm{C}}$状态的蛋白质，以及一个配体$L$。\n- 脱辅基蛋白质平衡：$P_{\\mathrm{O}} \\rightleftharpoons P_{\\mathrm{C}}$。\n- 脱辅基蛋白质动力学：转变在亚微秒时间尺度上发生。\n- 模拟温度：$T=300\\,\\mathrm{K}$。\n- 模拟方法：分子动力学（MD），使用朗之万恒温器。\n- 溶剂模型：隐式溶剂。\n- 摩擦系数：$\\gamma=100\\ \\mathrm{ps}^{-1}$。\n- 积分时间步长：$2\\ \\mathrm{fs}$。\n- 模拟观察：配体$L$与$P_{\\mathrm{C}}$结合，随后蛋白质构象变为$P_{\\mathrm{O}}$。\n- 研究人员的结论：机制是诱导契合。\n- 数据限制：没有可用的实验动力学数据。\n- 收敛性：模拟时长足以使平衡布居收敛。\n\n**步骤2：有效性分析**\n该问题具有科学依据。它提出了计算生物学中一个关于蛋白质-配体结合机制研究的标准情景。诱导契合与构象选择的概念是该领域的核心。使用分子动力学和朗之万恒温器是一种成熟的技术。问题的核心在于对一个特定的模拟参数——摩擦系数$\\gamma$——及其对动力学路径的影响进行批判性评估。这在MD模拟中是一个重要且不容忽视的方法论考量。问题指定了$\\gamma=100\\ \\mathrm{ps}^{-1}$的值，这个值已知远高于液态水对应的摩擦（通常模型中$\\gamma \\approx 1\\ \\mathrm{ps}^{-1}$）。这样一个参数选择如何可能在观察到的动力学中产生人为假象，是一个有效且表述清晰的科学问题。问题陈述是自洽的、客观的，并且没有违反任何物理或化学的基本原理。它描述了一个现实的、尽管可能存在缺陷的计算研究。\n\n**步骤3：结论**\n问题陈述是有效的。我现在将着手解答。\n\n**解答推导**\n\n目标是分析为什么基于高摩擦系数$\\gamma=100\\ \\mathrm{ps}^{-1}$的MD模拟得出的“诱导契合”机制的结论可能是错误的。\n\n系统的动力学由每个原子$i$的朗之万运动方程决定：\n$$ m_i \\frac{d^2\\mathbf{r}_i}{dt^2} = \\mathbf{F}_i(\\{\\mathbf{r}_j\\}) - \\gamma m_i \\frac{d\\mathbf{r}_i}{dt} + \\mathbf{R}_i(t) $$\n此处，$\\mathbf{F}_i$是从势能函数导出的保守力，第二项是摩擦阻力，$\\mathbf{R}_i(t)$是代表与隐式溶剂随机碰撞的随机力。摩擦力和随机力通过涨落-耗散定理联系在一起，该定理确保对于任何正的$\\gamma$，只要模拟运行到收敛，系统将正确地对正则（NVT）系综进行采样。问题陈述中提到平衡布居已经收敛，这意味着热力学（即各状态的相对自由能）被正确地采样了。然而，研究人员的结论是关于*机制*的，这是一个关于动力学和反应路径的陈述，而不是关于热力学的。\n\n摩擦系数$\\gamma$关键地决定了系统的动力学。一个非常大的$\\gamma$值，例如$\\gamma=100\\ \\mathrm{ps}^{-1}$，会将系统推向高摩擦或“过阻尼”状态。在这种状态下，惯性效应可以忽略不计，运动主要由系统力与摩擦力的平衡所主导。\n\n高摩擦对不同类型运动的影响是关键。\n1.  **配体扩散：** 配体$L$的平移扩散是一个随机行走过程。其扩散系数$D$与摩擦系数成反比，即$D \\propto 1/\\gamma$。高$\\gamma$会减慢配体接近蛋白质的速度。\n2.  **蛋白质构象变化：** $P_{\\mathrm{C}} \\rightleftharpoons P_{\\mathrm{O}}$的转变是一个大规模的集体运动，涉及跨越一个显著的能垒。根据Kramers关于过阻尼极限下跨越能垒的理论，这个过程的速率常数$k_{conf}$也与摩擦成反比，即$k_{conf} \\propto 1/\\gamma$。\n\n虽然这两个过程都被减慢了，但它们被减慢的程度不一定相同。大分子的宏观构象变化通常对摩擦的增加比小分子的简单平移扩散要敏感得多。一个高的、非物理的粘度会不成比例地抑制蛋白质的慢速集体模式。脱辅基蛋白质的内在构象动力学（$P_{\\mathrm{C}} \\rightleftharpoons P_{\\mathrm{O}}$），在现实中发生在亚微秒时间尺度上，被人为地减慢了几个数量级。\n\n这就产生了一个动力学上的人为假象。模拟实际上“冻结”了蛋白质的自然构象涨落。配体虽然也被减慢，但在其接近的时间尺度上，它扩散并遇到的蛋白质看起来是静态的。如果$P_{\\mathrm{C}}$状态是平衡时的主要构象（或者仅仅是配体遇到的第一个构象），配体就会与它结合。随后观察到的是$P_{\\mathrm{C}}L$复合物到最终$P_{\\mathrm{O}}L$状态的、慢得多的转变。这个事件序列——配体结合后发生构象变化——就是诱导契合的定义。\n\n然而，这个观察到的路径可能不是真实的物理路径。在现实中，在物理的（低的）摩擦下，蛋白质可能在$P_{\\mathrm{C}}$和$P_{\\mathrm{O}}$之间快速涨落。配体可能会在溶液中等待，直到一个具有结合能力的$P_{\\mathrm{O}}$状态出现，然后迅速结合。这将是一个“构象选择”机制。高摩擦的模拟通过人为地使$P_{\\mathrm{C}} \\to P_{\\mathrm{O}}$的转换变得极慢，从而在动力学上阻断了这条路径，因此使结果偏向于诱导契合。\n\n检验这一假说的正确方法学途径是，将$\\gamma$减小到一个物理上合理的值（例如，$\\gamma \\approx 1-5\\ \\mathrm{ps}^{-1}$，这个值能更好地代表水的粘度），并重复模拟。如果结合机制发生改变（例如，现在观察到了构象选择事件），那么最初的结论确实是模拟参数造成的人为假象。作为对照，必须验证所有状态的平衡布居保持不变，因为它们是力场和温度的属性，而不是动力学参数$\\gamma$的属性。\n\n**选项评估**\n\n**A. 极大的$\\gamma$会驱动系统进入过阻尼状态，该状态不成比例地抑制了蛋白质构象转变速率相对于配体平移扩散的速率，从而使事件发生的时间顺序偏向于表观的诱导契合；解决方法是，将$\\gamma$减小到一个物理上现实的范围（例如，$\\gamma\\sim 1\\ \\mathrm{ps}^{-1}$），验证平衡统计量保持不变，并将推断出的事件序列和有效扩散与已知的物理值进行比较。**\n这个选项正确地指出了高$\\gamma$会导致过阻尼状态。它正确地假设了这会不成比例地抑制蛋白质的慢速集体构象变化（相对于其他运动），从而导致一种动力学偏差，使诱导契合路径显得占主导地位。所提出的解决方法在科学上是合理的：将$\\gamma$减小到一个物理值，重新运行模拟以观察动力学，并使用平衡性质作为合理性检查。这是正确的分析。**正确**。\n\n**B. 极大的$\\gamma$会改变正则平衡分布，增加了$P_{\\mathrm{C}}$的布居，从而强制形成诱导契合；解决方法是在相同的$\\gamma$下运行更长时间，直到平衡恢复。**\n这个陈述是根本错误的。一个正确实现的朗之万恒温器确保了无论$\\gamma > 0$的值是多少，都能对正则平衡分布进行采样。摩擦系数影响的是动力学，而不是由势能函数决定的平衡态概率。问题也明确指出平衡布居已经收敛。由于这些原因，其解决方法是无稽之谈。**错误**。\n\n**C. 极大的$\\gamma$违反了涨落-耗散关系并破坏了细致平衡，引入了一种非物理的漂移，该漂移有利于结合后的构象变化；解决方法是将随机力设置为零，同时保留摩擦项。**\n选择一个大的$\\gamma$本身并不违反涨落-耗散定理或细致平衡；这些是积分算法的属性。这种人为假象是动力学上的，而不是恒温器统计力学基础的根本性崩溃。所提出的解决方法是灾难性的：在保留摩擦的同时移除随机力会消除热源，导致系统冷却到绝对零度（$T=0\\ \\mathrm{K}$）并停止所有运动。这将不再是在$T=300\\ \\mathrm{K}$下的模拟。**错误**。\n\n**D. 极大的$\\gamma$提高了数值稳定性和跨越能垒估计的准确性，因此观察到的诱导契合比在较低$\\gamma$下更可靠；解决方法是在不改变$\\gamma$的情况下进一步增长时间步长以加速采样。**\n这个陈述具有危险的误导性。虽然高摩擦可能对某些积分器能增强数值稳定性，但它从根本上扭曲了跨越能垒的物理动力学。一个由人为假象导致的结果，根据定义，不可能是“更可靠的”。目标是物理准确性，而不仅仅是数值稳定性。增长时间步长的解决方法也是有缺陷的；对于许多生物分子系统来说，$2\\ \\mathrm{fs}$的时间步长已经接近极限，进一步增加它会带来引入显著积分错误的风险，从而加剧了现有的物理不准确性。**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "分子动力学模拟的一个强大应用是从微观的原子运动中计算出宏观的、可测量的物理性质。本练习提供了一个从理论到实践的具体案例，要求您使用非平衡分子动力学 (NEMD) 模拟产生的假设数据来计算水的剪切粘度 $\\eta$。通过分析速度梯度并应用粘度的基本定义，您将体验到如何将原始的模拟输出转化为一个重要的输运系数（）。",
            "id": "2417123",
            "problem": "您的任务是设计一个非平衡分子动力学模拟，来计算可转移分子间势三点（TIP3P）水模型的剪切黏度。剪切黏度的基本定义是，对于均匀的稳态剪切流，剪切应力分量 $\\sigma_{xz}$ 与速度梯度 $\\partial v_x / \\partial z$ 成正比，其关系为 $\\sigma_{xz} = \\eta \\, \\partial v_x / \\partial z$，其中 $\\eta$ 是剪切黏度。在使用周期性边界条件的 TIP3P 水的均匀剪切非平衡分子动力学稳态模拟中，沿梯度方向 $z$ 测量了板层平均速度剖面 $v_x(z)$，同时还测量了时间平均的微观剪切应力 $\\sigma_{xz}$。系统沿 $z$ 方向的盒子长度为 $L_z$。\n\n对于下面描述的每个测试用例，假设稳态剪切速率是唯一的常数 $a$，使得线性函数 $v_x(z) = a z + b$ 在限制在内部区间 $z \\in [\\alpha L_z, (1-\\alpha)L_z]$ 时，与所提供数据点 $(z_i, v_{x,i})$ 的平方偏差之和最小化，其中每个用例都给定了 $\\alpha$。使用这个 $a$ 作为剪切速率 $\\partial v_x / \\partial z$ 来根据定义关系式计算 $\\eta$。所有位置 $z_i$ 和 $L_z$ 均以纳米为单位给出，必须转换为米。所有速度 $v_{x,i}$ 均以米/秒为单位给出。所有应力 $\\sigma_{xz}$ 均以帕斯卡为单位给出。最终黏度 $\\eta$ 以毫帕·秒（mPa·s）表示，并四舍五入到三位小数。\n\n测试套件（每个用例提供 $L_z$、$\\alpha$、$\\sigma_{xz}$ 以及 $(z_i, v_{x,i})$ 对的列表）：\n\n- 用例 1：\n  - $L_z = 10$ 纳米\n  - $\\alpha = 0.2$\n  - $\\sigma_{xz} = 9.0 \\times 10^{6}$ 帕斯卡\n  - $(z_i \\text{ 单位为纳米}, v_{x,i} \\text{ 单位为米/秒})$ 列表：\n    [$(0, -50)$, $(1, -40)$, $(2, -30)$, $(3, -20)$, $(4, -10)$, $(5, 0)$, $(6, 10)$, $(7, 20)$, $(8, 30)$, $(9, 40)$, $(10, 50)$]\n- 用例 2：\n  - $L_z = 8$ 纳米\n  - $\\alpha = 0.25$\n  - $\\sigma_{xz} = -4.0 \\times 10^{6}$ 帕斯卡\n  - $(z_i \\text{ 单位为纳米}, v_{x,i} \\text{ 单位为米/秒})$ 列表：\n    [$(0, 20.2)$, $(1, 14.9)$, $(2, 10.3)$, $(3, 4.8)$, $(4, 0.0)$, $(5, -4.9)$, $(6, -10.3)$, $(7, -14.8)$, $(8, -20.1)$]\n- 用例 3：\n  - $L_z = 12$ 纳米\n  - $\\alpha = 0.2$\n  - $\\sigma_{xz} = 1.9 \\times 10^{5}$ 帕斯卡\n  - $(z_i \\text{ 单位为纳米}, v_{x,i} \\text{ 单位为米/秒})$ 列表：\n    [$(0, -1.2)$, $(2, -0.8)$, $(4, -0.4)$, $(6, 0.0)$, $(8, 0.4)$, $(10, 0.8)$, $(12, 1.2)$]\n- 用例 4：\n  - $L_z = 10$ 纳米\n  - $\\alpha = 0.3$\n  - $\\sigma_{xz} = 1.26 \\times 10^{7}$ 帕斯卡\n  - $(z_i \\text{ 单位为纳米}, v_{x,i} \\text{ 单位为米/秒})$ 列表：\n    [$(0, -52)$, $(1, -44)$, $(2, -36)$, $(3, -24)$, $(4, -12)$, $(5, 0)$, $(6, 12)$, $(7, 24)$, $(8, 36)$, $(9, 44)$, $(10, 52)$]\n\n您的程序必须对每个用例，仅使用基本关系式 $\\sigma_{xz} = \\eta \\, \\partial v_x / \\partial z$ 和剪切速率的定义（即 $v_x(z)$ 在指定内部区间上最佳线性近似的斜率 $a$）来计算剪切黏度 $\\eta$（单位为毫帕·秒）。所有计算必须使用国际单位制（SI）。最终输出必须是单行文本，包含一个逗号分隔的四个黏度值列表（单位为毫帕·秒），四舍五入到三位小数，并用方括号括起来，例如 $[x_1,x_2,x_3,x_4]$。",
            "solution": "其指导原理是牛顿黏性定律在简单剪切下的形式，该定律指出剪切应力 $\\sigma_{xz}$ 通过比例常数 $\\eta$（剪切黏度）与速度梯度 $\\partial v_x / \\partial z$ 成正比。数学上表示为 $\\sigma_{xz} = \\eta \\, \\partial v_x / \\partial z$。因此，一旦知道了稳态剪切速率 $\\partial v_x / \\partial z$，就可以通过 $\\eta = \\sigma_{xz} / (\\partial v_x / \\partial z)$ 获得黏度。\n\n在可转移分子间势三点（TIP3P）水的非平衡分子动力学稳态剪切模拟中，测得的板层平均剖面 $v_x(z)$ 相对于 $z$ 在体相内部应近似为线性。为了减轻周期性镜像或壁面附近的边界层畸变，我们将注意力限制在内部区域 $z \\in [\\alpha L_z, (1-\\alpha)L_z]$，其中 $\\alpha$ 因用例而异。在此，稳态剪切速率定义为线性函数 $v_x(z) = a z + b$ 的斜率 $a$，该函数使得内部区段内与所提供数据点的平方偏差之和最小。这是唯一的最小二乘法最佳拟合斜率，\n$$\na \\;=\\; \\frac{\\sum_{i} \\left(z_i - \\bar{z}\\right)\\left(v_{x,i} - \\bar{v}\\right)}{\\sum_{i} \\left(z_i - \\bar{z}\\right)^2}\n$$\n其中，求和是对所有满足 $z_i \\in [\\alpha L_z, (1-\\alpha)L_z]$ 的点进行的，$\\bar{z}$ 是这些 $z_i$ 的平均值，$\\bar{v}$ 是相应 $v_{x,i}$ 的平均值。在计算 $a$ 之前，所有 $z_i$ 和 $L_z$ 都必须从纳米转换为米，这样 $a$ 的单位才是秒的倒数（$\\mathrm{s}^{-1}$）。当 $a$ 的单位为 $\\mathrm{s}^{-1}$，$\\sigma_{xz}$ 的单位为帕斯卡时，比值 $\\eta = \\sigma_{xz}/a$ 得出的黏度单位为帕斯卡·秒，乘以 $1000$ 可将其转换为毫帕·秒。\n\n将此方法应用于每个用例：\n\n- 用例 1：内部区域为 $z \\in [\\alpha L_z, (1-\\alpha)L_z] = [0.2 \\times 10, (1-0.2) \\times 10]$ 纳米 $= [2, 8]$ 纳米。所列剖面在内部是完全线性的，斜率为每纳米 10 米/秒。将纳米转换为米，得到 $a = 10 / (10^{-9}) = 1.0 \\times 10^{10}$ 秒$^{-1}$。因此，\n$$\n\\eta = \\frac{9.0 \\times 10^{6}}{1.0 \\times 10^{10}} = 9.0 \\times 10^{-4} \\text{ Pa·s} = 0.900 \\text{ mPa·s}.\n$$\n\n- 用例 2：内部区域为 $z \\in [0.25 \\times 8, (1-0.25) \\times 8]$ 纳米 $= [2, 6]$ 纳米。使用提供的五个内部点和最小二乘公式，可以得到斜率约 $a \\approx -5.09 \\times 10^{9}$ 秒$^{-1}$（负号反映了负梯度）。由于 $\\sigma_{xz} = -4.0 \\times 10^{6}$ 帕斯卡，\n$$\n\\eta = \\frac{-4.0 \\times 10^{6}}{-5.09 \\times 10^{9}} \\approx 7.861 \\times 10^{-4} \\text{ Pa·s} \\approx 0.786 \\text{ mPa·s}.\n$$\n\n- 用例 3：内部区域为 $z \\in [0.2 \\times 12, (1-0.2) \\times 12]$ 纳米 $= [2.4, 9.6]$ 纳米。内部数据点位于 $z = 4, 6, 8$ 纳米，对应的 $v_x = -0.4, 0.0, 0.4$ 米/秒。最小二乘斜率恰好为每纳米 0.2 米/秒，所以 $a = 0.2 / (10^{-9}) = 2.0 \\times 10^{8}$ 秒$^{-1}$。由于 $\\sigma_{xz} = 1.9 \\times 10^{5}$ 帕斯卡，\n$$\n\\eta = \\frac{1.9 \\times 10^{5}}{2.0 \\times 10^{8}} = 9.5 \\times 10^{-4} \\text{ Pa·s} = 0.950 \\text{ mPa·s}.\n$$\n\n- 用例 4：内部区域为 $z \\in [0.3 \\times 10, (1-0.3) \\times 10]$ 纳米 $= [3, 7]$ 纳米。内部数据点是线性的，斜率为每纳米 12 米/秒，得到 $a = 12 / (10^{-9}) = 1.2 \\times 10^{10}$ 秒$^{-1}$。由于 $\\sigma_{xz} = 1.26 \\times 10^{7}$ 帕斯卡，\n$$\n\\eta = \\frac{1.26 \\times 10^{7}}{1.2 \\times 10^{10}} = 1.05 \\times 10^{-3} \\text{ Pa·s} = 1.050 \\text{ mPa·s}.\n$$\n\n将结果以毫帕·秒为单位收集并四舍五入到三位小数，得到列表 $[0.900, 0.786, 0.950, 1.050]$，这符合最终输出格式的要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef best_fit_slope_in_interval(z_nm, v_ms, Lz_nm, alpha):\n    \"\"\"\n    Compute the least-squares slope a of v(z) = a z + b over the interior\n    interval [alpha*Lz, (1-alpha)*Lz], converting z from nm to m so that\n    a has units of 1/s.\n    \"\"\"\n    z_nm = np.asarray(z_nm, dtype=float)\n    v_ms = np.asarray(v_ms, dtype=float)\n    # Select interior points\n    z_min = alpha * Lz_nm\n    z_max = (1.0 - alpha) * Lz_nm\n    mask = (z_nm >= z_min) & (z_nm <= z_max)\n    z_sel_nm = z_nm[mask]\n    v_sel = v_ms[mask]\n    # Convert nm to m\n    z_sel_m = z_sel_nm * 1e-9\n    # Least-squares slope\n    z_mean = np.mean(z_sel_m)\n    v_mean = np.mean(v_sel)\n    dz = z_sel_m - z_mean\n    dv = v_sel - v_mean\n    denom = np.sum(dz * dz)\n    if denom == 0.0:\n        raise ValueError(\"Insufficient variation in z to determine slope.\")\n    a = np.sum(dz * dv) / denom  # units: (m/s)/m = 1/s\n    return a\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Lz_nm, alpha, sigma_Pa, list_of_pairs (z_nm, v_ms))\n    test_cases = [\n        (\n            10.0,\n            0.2,\n            9.0e6,\n            [\n                (0.0, -50.0), (1.0, -40.0), (2.0, -30.0), (3.0, -20.0), (4.0, -10.0),\n                (5.0, 0.0), (6.0, 10.0), (7.0, 20.0), (8.0, 30.0), (9.0, 40.0), (10.0, 50.0)\n            ]\n        ),\n        (\n            8.0,\n            0.25,\n            -4.0e6,\n            [\n                (0.0, 20.2), (1.0, 14.9), (2.0, 10.3), (3.0, 4.8), (4.0, 0.0),\n                (5.0, -4.9), (6.0, -10.3), (7.0, -14.8), (8.0, -20.1)\n            ]\n        ),\n        (\n            12.0,\n            0.2,\n            1.9e5,\n            [\n                (0.0, -1.2), (2.0, -0.8), (4.0, -0.4), (6.0, 0.0),\n                (8.0, 0.4), (10.0, 0.8), (12.0, 1.2)\n            ]\n        ),\n        (\n            10.0,\n            0.3,\n            1.26e7,\n            [\n                (0.0, -52.0), (1.0, -44.0), (2.0, -36.0), (3.0, -24.0), (4.0, -12.0),\n                (5.0, 0.0), (6.0, 12.0), (7.0, 24.0), (8.0, 36.0), (9.0, 44.0), (10.0, 52.0)\n            ]\n        ),\n    ]\n\n    results = []\n    for Lz_nm, alpha, sigma_Pa, pairs in test_cases:\n        z_nm = [p[0] for p in pairs]\n        v_ms = [p[1] for p in pairs]\n        a = best_fit_slope_in_interval(z_nm, v_ms, Lz_nm, alpha)  # 1/s\n        eta_Pa_s = sigma_Pa / a  # Pa*s\n        eta_mPa_s = eta_Pa_s * 1e3  # mPa*s\n        results.append(eta_mPa_s)\n\n    # Round to three decimal places and format as required.\n    formatted = [f\"{x:.3f}\" for x in results]\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```"
        }
    ]
}