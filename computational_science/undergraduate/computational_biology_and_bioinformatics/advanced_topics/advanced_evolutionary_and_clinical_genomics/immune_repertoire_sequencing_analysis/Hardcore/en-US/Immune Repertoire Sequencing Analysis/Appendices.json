{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in any sequencing project is experimental design. Before committing resources to a deep sequencing run, it is essential to estimate the sampling depth required to achieve your goals. This exercise explores the fundamental probabilistic relationship between a clonotype's frequency, the number of cells you sample, and the likelihood of detecting that clonotype, providing a quantitative basis for planning your experiments. ",
            "id": "2399355",
            "problem": "In high-throughput T cell receptor (TCR) repertoire sequencing, each clonotype (defined here by a unique complementarity-determining region 3 (CDR3) nucleotide sequence) has an underlying population frequency. Consider an individual whose most frequent clonotype has true relative frequency $0.01$ in the circulating T cell population at the time of sampling, as established by an earlier deep sequencing study. You plan a new experiment that samples T cells at random from this individual and sequences their TCRs, retaining one sequence per successfully captured distinct T cell so that each observation corresponds to one cell. Assume the repertoire is sufficiently large that sampling can be modeled as independent draws with replacement, that per-cell capture and sequencing is unbiased with respect to clonotype, and that technical artifacts have been removed so that observed sequences reflect biological cells.\n\nDetermine the minimum number $n$ of unique TCR sequences (i.e., distinct cells) you must obtain in this experiment so that the probability is at least $0.95$ that you have sampled the most frequent clonotype at least once. Report the smallest integer $n$ that satisfies this requirement. No units are required, and no rounding beyond reporting this minimum integer is needed.",
            "solution": "The problem statement is first subjected to validation.\n\nStep 1: Extract Givens\n- The true relative frequency of the most frequent clonotype is $0.01$.\n- The experiment involves sampling $n$ unique TCR sequences (distinct cells).\n- Sampling is modeled as independent draws with replacement.\n- The probability of sampling the most frequent clonotype at least once must be at least $0.95$.\n- The objective is to find the minimum integer $n$ that satisfies this condition.\n\nStep 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on valid principles of statistics and their application to computational biology, specifically immune repertoire sequencing. The concept of clonotype frequency and stochastic sampling is fundamental to the field. The given frequency of $0.01$ is biologically plausible for a dominant clonotype. The model of sampling with replacement is a standard and appropriate approximation for a large population like the T-cell repertoire.\n- **Well-Posed:** The problem is well-posed. It provides all necessary parameters to construct a mathematical inequality and solve for a unique minimum integer value. The question is unambiguous.\n- **Objective:** The problem is stated using precise, objective, and scientific terminology.\n\nThe problem is deemed valid as it is scientifically sound, well-posed, and objective. It contains no logical contradictions, missing information, or pseudoscientific claims. We may proceed with the solution.\n\nThe problem describes a series of Bernoulli trials. Let $n$ be the total number of unique TCR sequences sampled, which corresponds to the number of independent trials. Let $p$ be the true frequency of the specific clonotype of interest. From the problem statement, we are given:\n$$p = 0.01$$\nEach trial consists of sampling one T cell. A \"success\" is defined as observing the clonotype of interest. The probability of success in any single trial is $p$. A \"failure\" is observing any other clonotype, and the probability of failure in any single trial is $1 - p$.\n\nThe problem requires that the probability of observing the clonotype *at least once* in $n$ trials is at least $0.95$. Let $A$ be the event that the clonotype is observed at least once in $n$ samples. It is more straightforward to first calculate the probability of the complementary event, $A^c$, which is the event that the clonotype is *not* observed in any of the $n$ samples.\n\nSince the samples are independent draws, the probability of not observing the clonotype in one trial is $(1 - p)$. The probability of not observing it in $n$ consecutive independent trials is:\n$$P(A^c) = (1 - p)^n$$\nThe probability of event $A$ is therefore:\n$$P(A) = 1 - P(A^c) = 1 - (1 - p)^n$$\nThe condition specified in the problem is $P(A) \\ge 0.95$. We express this as an inequality:\n$$1 - (1 - p)^n \\ge 0.95$$\nWe must now solve for the smallest integer $n$ that satisfies this inequality. First, we rearrange the terms to isolate the expression containing $n$:\n$$(1 - p)^n \\le 1 - 0.95$$\n$$(1 - p)^n \\le 0.05$$\nNow, we substitute the given value of $p = 0.01$:\n$$(1 - 0.01)^n \\le 0.05$$\n$$(0.99)^n \\le 0.05$$\nTo solve for the exponent $n$, we take the natural logarithm of both sides of the inequality. Since the natural logarithm function, $\\ln(x)$, is a strictly increasing function for $x  0$, the direction of the inequality is preserved.\n$$\\ln((0.99)^n) \\le \\ln(0.05)$$\nUsing the logarithmic property $\\ln(a^b) = b \\ln(a)$, we have:\n$$n \\ln(0.99) \\le \\ln(0.05)$$\nTo isolate $n$, we must divide by $\\ln(0.99)$. It is critical to recognize that for any value $x$ in the interval $(0, 1)$, its natural logarithm $\\ln(x)$ is negative. Therefore, $\\ln(0.99)  0$. When dividing both sides of an inequality by a negative number, the inequality sign must be reversed.\n$$n \\ge \\frac{\\ln(0.05)}{\\ln(0.99)}$$\nWe can now evaluate the right-hand side of the inequality.\n$$n \\ge \\frac{-2.995732...}{-0.010050...}$$\n$$n \\ge 298.0728...$$\nThe problem requires the minimum integer value of $n$. Since $n$ must be an integer representing a count of cells, and it must be greater than or equal to $298.0728...$, the smallest integer that satisfies this condition is obtained by taking the ceiling of this value.\n$$n_{min} = \\lceil 298.0728... \\rceil = 299$$\nTherefore, a minimum of $299$ unique TCR sequences must be sampled to ensure the probability of observing the specified clonotype at least once is at least $0.95$.",
            "answer": "$$\\boxed{299}$$"
        },
        {
            "introduction": "Raw sequencing data is never perfect; it contains a mixture of true biological variation and noise from technical errors. A fundamental challenge in repertoire analysis is to distinguish a rare but genuine clonotype from a phantom one that appears due to errors in sequencing a highly abundant clone. This practice will guide you through applying a statistical hypothesis test, based on the Binomial distribution, to make a principled decision about whether an observed low-frequency sequence is a real signal or just noise. ",
            "id": "2399399",
            "problem": "You are given an independent read sampling model of an immune repertoire sequencing experiment in which a single, known clonotype with relative frequency $f$ is present in a sample. Let the total number of reads be $N$. A candidate clonotype is observed $k$ times in the sequencing data. Each read from the known clonotype is independently mis-sequenced into the candidate clonotype with probability $p_{error}$, where $p_{error}$ is an effective per-read miscall probability to that specific erroneous sequence. Assume that reads are independent and that any contribution from other clonotypes to the candidate clonotype via sequencing errors is negligible in comparison to the known clonotype. Under the null hypothesis that the candidate clonotype is entirely an error-derived artifact of the known clonotype, the number of observed reads $K$ for the candidate clonotype follows a Binomial distribution with parameters $N$ and $f \\cdot p_{error}$. Under the alternative hypothesis, the candidate clonotype has a true underlying frequency $\\theta$ in addition to any error-derived contribution from the known clonotype. For each case, use a right-tail criterion at significance level $\\alpha$ to decide whether the observation is inconsistent with the null hypothesis.\n\nYour task is to write a complete program that, for each test case, outputs a Boolean indicating whether the candidate clonotype should be called a true clonotype (reject the null hypothesis) based on the probability of observing at least $k$ under the null model and the threshold $\\alpha$. The program must hard-code the following test suite and produce results in the required format.\n\nTest suite (each case is a tuple of $(N, f, p_{error}, k, \\alpha)$):\n- Case 1: (N=100000, f=0.01, p_error=0.001, k=6, alpha=0.01)\n- Case 2: (N=100000, f=0.01, p_error=0.001, k=1, alpha=0.05)\n- Case 3: (N=20000, f=0.005, p_error=0.001, k=1, alpha=0.1)\n- Case 4: (N=50000, f=0.0, p_error=0.001, k=1, alpha=0.05)\n- Case 5: (N=1000000, f=0.01, p_error=0.001, k=8, alpha=0.01)\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being either True or False in the order of the test cases. For example, the output must look like: \"[result1,result2,result3,result4,result5]\".",
            "solution": "The problem presented is a standard exercise in statistical hypothesis testing, applied to the field of computational biology, specifically the analysis of immune repertoire sequencing data. The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We shall proceed with the formal analysis.\n\nThe central task is to determine whether an observed candidate clonotype is a genuine biological entity or merely an artifact of sequencing error from a known, highly abundant clonotype. This is formulated as a hypothesis test.\n\nThe null hypothesis, $H_0$, is that the candidate clonotype is entirely an artifact. Under this hypothesis, its observed read count, which we denote by the random variable $K$, arises from mis-sequencing events of reads belonging to the known clonotype. The known clonotype has a true relative frequency of $f$ in a sample from which a total of $N$ reads are sequenced. The probability that any single read from the known clonotype is mis-sequenced into the candidate clonotype is given as $p_{error}$. Since we assume the contribution from any other source is negligible, the probability that any given read in the entire sequencing run of $N$ reads is observed as the candidate clonotype due to this specific error process is the product of the probability of sampling the known clonotype and the probability of the subsequent error. This gives a per-read success probability of $p = f \\cdot p_{error}$.\n\nAs the problem states, the reads are sampled independently. Therefore, the number of observed reads for the candidate clonotype, $K$, follows a Binomial distribution with $N$ trials and a success probability of $p$.\n$$K \\sim \\text{Binomial}(n, p)$$\nwhere $n = N$ and $p = f \\cdot p_{error}$.\n\nWe are given an observed count of $k$ reads for the candidate clonotype. To test the validity of $H_0$, we employ a right-tail test. We calculate the probability of observing a result at least as extreme as the one we measured, assuming $H_0$ is true. This probability is the p-value. For a right-tail test, the p-value is:\n$$p\\text{-value} = P(K \\ge k | H_0)$$\n\nThis probability is calculated from the Binomial distribution's probability mass function (PMF), $P(K=i) = \\binom{n}{i} p^i (1-p)^{n-i}$, as follows:\n$$p\\text{-value} = \\sum_{i=k}^{n} \\binom{n}{i} p^i (1-p)^{n-i}$$\n\nFor computational purposes, this sum can be more efficiently and accurately calculated using the complement of the cumulative distribution function (CDF), $F(k) = P(K \\le k)$. The relationship is:\n$$P(K \\ge k) = 1 - P(K  k) = 1 - P(K \\le k-1) = 1 - F(k-1; n, p)$$\nThis is equivalent to the survival function (SF) evaluated at $k-1$.\n\nThe decision rule is to compare the calculated p-value with the pre-determined significance level, $\\alpha$. If the p-value is less than or equal to $\\alpha$, the observed result is deemed sufficiently unlikely to have occurred by chance under the null hypothesis.\n$$\\text{Reject } H_0 \\text{ if } p\\text{-value} \\le \\alpha$$\n\nRejecting $H_0$ means we have statistical evidence to conclude that the candidate clonotype is not solely an error artifact and should be considered a \"true\" clonotype. If $p\\text{-value}  \\alpha$, we fail to reject $H_0$, meaning the observation is consistent with the error model.\n\nFor each test case with parameters $(N, f, p_{error}, k, \\alpha)$, we will:\n1.  Calculate the Binomial probability parameter $p = f \\cdot p_{error}$.\n2.  Calculate the p-value, $P(K \\ge k)$, for $K \\sim \\text{Binomial}(N, p)$.\n3.  Compare the p-value to $\\alpha$ and conclude whether to reject $H_0$. A rejection corresponds to a `True` result, and a failure to reject corresponds to a `False` result.\n\nLet us briefly analyze the special case where $f=0$, as in Case $4$. Here, the probability parameter $p = 0 \\cdot p_{error} = 0$. The distribution is $\\text{Binomial}(N, 0)$, which means $P(K=0)=1$ and $P(K0)=0$. If any non-zero count $k \\ge 1$ is observed, the p-value $P(K \\ge k | p=0)$ is exactly $0$. Since $0 \\le \\alpha$ for any conventional significance level, observing even one read when it is impossible under the null model leads to an immediate rejection of $H_0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import binom\n\ndef solve():\n    \"\"\"\n    Solves the immune repertoire clonotype calling problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (N, f, p_error, k, alpha).\n    test_cases = [\n        (100000, 0.01, 0.001, 6, 0.01),\n        (100000, 0.01, 0.001, 1, 0.05),\n        (20000, 0.005, 0.001, 1, 0.1),\n        (50000, 0.0, 0.001, 1, 0.05),\n        (1000000, 0.01, 0.001, 8, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        N, f, p_error, k, alpha = case\n\n        # Number of trials for the Binomial distribution\n        n = int(N)\n        \n        # Probability of success for each trial under the null hypothesis\n        p = f * p_error\n\n        # Under the null hypothesis, the number of observed reads K for the candidate\n        # clonotype follows a Binomial distribution B(n, p).\n        # We perform a right-tail test. The p-value is the probability of\n        # observing a count of at least k.\n        # p-value = P(K = k)\n\n        # Handle the edge case where k=0. P(K=0) is always 1.\n        # The problem implies k=1 since the clonotype is \"observed k times\".\n        # However, for completeness:\n        if k == 0:\n            p_value = 1.0\n        else:\n            # P(K = k) is calculated using the survival function (SF), which is 1 - CDF.\n            # sf(x) = P(X  x). Therefore, P(K = k) = P(K  k-1) = sf(k-1).\n            # This is numerically more stable than 1 - cdf(k-1) or summing the pmf.\n            p_value = binom.sf(k - 1, n, p)\n\n        # Reject the null hypothesis if the p-value is less than or equal to the\n        # significance level alpha. Rejecting H0 means we call it a true clonotype.\n        is_true_clonotype = p_value = alpha\n        results.append(is_true_clonotype)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After processing your data, a critical question remains: have you sequenced deeply enough to capture the full diversity of the immune repertoire? To answer this, we use a technique called rarefaction analysis, which assesses how the number of observed unique clonotypes increases with sequencing depth. This advanced practice involves implementing the exact formula for a rarefaction curve to determine if the rate of discovering new clonotypes has plateaued, helping you to judge the completeness of your sample. ",
            "id": "2399358",
            "problem": "A laboratory has sequenced the immune receptor repertoire of a lymphocyte population and obtained a list of observed clonotypes with their read counts. Model the sequenced reads as draws without replacement from a finite multiset of size $N$, where $N$ is the total number of reads observed and each clonotype $i$ appears $c_i$ times, with $c_i \\ge 1$ and $\\sum_i c_i = N$. Define the rarefaction function as the expected number of distinct clonotypes observed when subsampling $n$ reads without replacement, denoted by $E[S(n)]$.\n\nYour task is to write a program that, for each specified test case, decides whether additional sequencing is advisable based on the slope of the rarefaction curve near the current depth. Use the following scientifically grounded base:\n\n- Sampling without replacement from a finite population follows the hypergeometric law.\n- For each clonotype $i$ with count $c_i$, the probability that none of its $c_i$ molecules are observed in a subsample of size $n$ is the ratio of binomial coefficients $\\dfrac{\\binom{N - c_i}{n}}{\\binom{N}{n}}$ when $0 \\le n \\le N$.\n- By linearity of expectation, $E[S(n)]$ equals the sum, over clonotypes, of the probability that each clonotype is observed at least once in the subsample.\n\nDecision rule: Given a positive integer window size $m$ with $1 \\le m \\le N$ and a nonnegative threshold $\\alpha$ (measured in expected new clonotypes per additional read), compute the average marginal gain in expected clonal richness over the last $m$ reads,\n$$\ng = \\frac{E[S(N)] - E[S(N - m)]}{m}.\n$$\nIf $g  \\alpha$, return the boolean value True (advise sequencing to greater depth); otherwise return False.\n\nCompute $E[S(n)]$ using only the assumptions above and standard mathematical functions. To ensure numerical stability for large $N$, compute ratios of binomial coefficients via logarithms of factorials (for example, using the logarithm of the gamma function).\n\nInput for each test case is:\n- A list of positive integers $[c_1,c_2,\\dots,c_R]$ with $\\sum_i c_i = N$,\n- An integer window size $m$ with $1 \\le m \\le N$,\n- A nonnegative real threshold $\\alpha$.\n\nYour program must process the following test suite:\n\n- Test case 1: counts $[25,20,15,10,8,7,5,5,3,2]$, $m = 10$, $\\alpha = 0.05$.\n- Test case 2: counts $[50,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]$ (one clonotype with $50$ reads and $50$ singletons), $m = 10$, $\\alpha = 0.15$.\n- Test case 3: counts consisting of $20$ clonotypes each with $5$ reads, i.e., $[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]$, $m = 10$, $\\alpha = 0.05$.\n- Test case 4: counts $[100]$, $m = 10$, $\\alpha = 0.001$.\n- Test case 5: counts consisting of $100$ singletons, i.e., $[1,1,1,\\dots,1]$ (with $100$ entries), $m = 10$, $\\alpha = 0.5$.\n\nYour program should produce a single line of output containing the boolean decisions for the test cases as a comma-separated list enclosed in square brackets (for example, `[True, False,...]`). No additional text should be printed.",
            "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in established principles of probability theory and their standard application in computational biology, specifically in the analysis of immune repertoire sequencing data. The problem is well-posed, with all terms, conditions, and data provided in a clear, consistent, and objective manner. There are no logical contradictions, scientific inaccuracies, or ambiguities. We may therefore proceed with a formal solution.\n\nThe core task is to evaluate a decision rule for further sequencing based on the local slope of the clonotype rarefaction curve. The decision is `True` if the average marginal gain $g$ exceeds a threshold $\\alpha$, and `False` otherwise. The marginal gain is defined as:\n$$\ng = \\frac{E[S(N)] - E[S(N - m)]}{m}\n$$\nwhere $N$ is the total number of reads, $m$ is a specified window size, and $E[S(n)]$ is the expected number of distinct clonotypes observed in a random subsample of $n$ reads drawn without replacement. The inputs are a list of clonotype counts $[c_1, c_2, \\dots, c_R]$, the window size $m$, and the threshold $\\alpha$.\n\nOur derivation proceeds in two parts: first, the evaluation of $E[S(N)]$, and second, the evaluation of $E[S(N-m)]$.\n\n**1. Evaluation of $E[S(N)]$**\n\nThe term $E[S(N)]$ represents the expected number of distinct clonotypes observed when sampling all $N$ reads from the population. By definition, if one samples all reads, one is guaranteed to observe every clonotype that was present in the original library. Therefore, the number of observed clonotypes is deterministically equal to $R$, the total number of distinct clonotypes.\n$$\nE[S(N)] = R\n$$\nwhere $R$ is simply the length of the input list of counts. This simplifies the expression for $g$:\n$$\ng = \\frac{R - E[S(N - m)]}{m}\n$$\n\n**2. Evaluation of $E[S(n)]$ for a general subsample size $n$**\n\nThe expected number of distinct clonotypes, $E[S(n)]$, is derived from the principle of linearity of expectation. Let $I_i(n)$ be an indicator random variable such that $I_i(n) = 1$ if clonotype $i$ is observed in a subsample of size $n$, and $I_i(n) = 0$ otherwise. The total number of observed clonotypes is $S(n) = \\sum_{i=1}^{R} I_i(n)$. The expectation is:\n$$\nE[S(n)] = E\\left[\\sum_{i=1}^{R} I_i(n)\\right] = \\sum_{i=1}^{R} E[I_i(n)]\n$$\nThe expectation of an indicator variable is the probability of the event it indicates.\n$$\nE[I_i(n)] = P(\\text{clonotype } i \\text{ is observed}) = 1 - P(\\text{clonotype } i \\text{ is not observed})\n$$\nThe problem correctly states that sampling is without replacement, which is governed by the hypergeometric distribution. The probability of not observing clonotype $i$ (which has $c_i$ reads) in a subsample of size $n$ is the probability of choosing all $n$ reads from the $N-c_i$ reads that do not belong to clonotype $i$. The total number of ways to choose $n$ reads from $N$ is $\\binom{N}{n}$. The number of ways to choose $n$ reads from the non-$i$ reads is $\\binom{N-c_i}{n}$. Thus,\n$$\nP(\\text{clonotype } i \\text{ is not observed}) = \\frac{\\binom{N - c_i}{n}}{\\binom{N}{n}}\n$$\nThis is valid for $0 \\le n \\le N-c_i$. If $n  N-c_i$, it is impossible to avoid selecting at least one read from clonotype $i$, so the probability of not observing it is $0$.\n\nCombining these results, we have the formula for the rarefaction curve:\n$$\nE[S(n)] = \\sum_{i=1}^{R} \\left(1 - \\frac{\\binom{N-c_i}{n}}{\\binom{N}{n}}\\right) = R - \\sum_{i=1}^{R} \\frac{\\binom{N-c_i}{n}}{\\binom{N}{n}}\n$$\n\n**3. Numerical Computation and Final Algorithm**\n\nTo compute $g$, we must calculate $E[S(N-m)]$. Let $n' = N-m$.\n$$\nE[S(n')] = R - \\sum_{i=1}^{R} \\frac{\\binom{N-c_i}{n'}}{\\binom{N}{n'}}\n$$\nDirect computation of binomial coefficients with large arguments leads to numerical overflow. As stipulated, we must compute the ratio using logarithms of the Gamma function, $\\log \\Gamma(z+1) = \\log(z!)$. The logarithm of the probability of missing clonotype $i$ is:\n$$\n\\log P_i(\\text{miss}) = \\log\\left(\\frac{\\binom{N-c_i}{n'}}{\\binom{N}{n'}}\\right) = \\log\\left(\\frac{(N-c_i)!(N-n')!}{N!(N-c_i-n')!}\\right)\n$$\nUsing the log-gamma function, this becomes:\n$$\n\\log P_i(\\text{miss}) = \\log\\Gamma(N-c_i+1) + \\log\\Gamma(N-n'+1) - \\log\\Gamma(N+1) - \\log\\Gamma(N-c_i-n'+1)\n$$\nThe probability is then $P_i(\\text{miss}) = \\exp(\\log P_i(\\text{miss}))$. The `scipy.special.gammaln` function correctly handles cases where arguments are non-positive integers by returning infinity, which, after exponentiation, correctly yields a probability of $0$ when $n'  N-c_i$.\n\nThe complete algorithm is as follows:\n1.  Given the list of counts $[c_1, \\dots, c_R]$, $m$, and $\\alpha$.\n2.  Compute the total reads $N = \\sum_{i=1}^{R} c_i$ and the number of distinct clonotypes $R$.\n3.  Set the subsample size for the calculation to $n' = N-m$.\n4.  Initialize a sum for miss probabilities, $\\Sigma_P = 0$.\n5.  For each count $c_i$ in the list:\n    a. If $n' \\le N-c_i$, compute $\\log P_i(\\text{miss})$ using the log-gamma formula above.\n    b. Add $\\exp(\\log P_i(\\text{miss}))$ to $\\Sigma_P$.\n6.  Calculate the expected number of clonotypes at depth $n'$: $E[S(n')] = R - \\Sigma_P$.\n7.  Calculate the marginal gain: $g = (R - E[S(n')]) / m$.\n8.  Return the boolean result of the comparison $g  \\alpha$.\nThis procedure is robust and directly implements the validated scientific model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Solves the immune repertoire sequencing analysis problem for a suite of test cases.\n    \"\"\"\n\n    def compute_decision(counts, m, alpha):\n        \"\"\"\n        Computes the decision to continue sequencing based on the slope of the rarefaction curve.\n\n        Args:\n            counts (list): A list of positive integers representing clonotype read counts.\n            m (int): A positive integer window size.\n            alpha (float): A non-negative real threshold for the marginal gain.\n\n        Returns:\n            bool: True if further sequencing is advisable, False otherwise.\n        \"\"\"\n        # Total number of reads (N) and distinct clonotypes (R)\n        N = sum(counts)\n        R = len(counts)\n\n        # The expected number of clonotypes at full depth E[S(N)] is exactly R.\n        E_S_N = float(R)\n\n        # We need to compute E[S(N-m)], the expected number of clonotypes when\n        # subsampling n_prime = N - m reads.\n        n_prime = N - m\n\n        # E[S(n')] = sum_{i=1 to R} (1 - P(clonotype i is missed))\n        # This is equivalent to R - sum_{i=1 to R} P(clonotype i is missed).\n        # We calculate the sum of miss probabilities.\n        sum_prob_miss = 0.0\n\n        for c_i in counts:\n            # The probability of missing a clonotype is non-zero only if\n            # it's possible to draw n_prime reads without picking any of its c_i members.\n            # This requires the number of other reads (N - c_i) to be at least n_prime.\n            if N - c_i = n_prime:\n                # To avoid numerical overflow with large factorials, we compute the\n                # log of the ratio of binomial coefficients C(N-c_i, n') / C(N, n').\n                # log(P_miss) = log( (N-c_i)! * (N-n')! / (N! * (N-c_i-n')!) )\n                # This is computed using the log-gamma function, where lgamma(x+1) = log(x!).\n                log_prob_miss = (gammaln(N - c_i + 1) +\n                                 gammaln(N - n_prime + 1) -\n                                 gammaln(N + 1) -\n                                 gammaln(N - c_i - n_prime + 1))\n                \n                sum_prob_miss += np.exp(log_prob_miss)\n\n        # The expected number of clonotypes at depth n_prime\n        E_S_N_minus_m = R - sum_prob_miss\n\n        # The average marginal gain 'g' is the slope of the rarefaction curve\n        # approximated over the last m reads.\n        # The problem statement guarantees 1 = m = N, so m is never zero.\n        g = (E_S_N - E_S_N_minus_m) / m\n\n        return g  alpha\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # counts, m, alpha\n        ([25, 20, 15, 10, 8, 7, 5, 5, 3, 2], 10, 0.05),\n        (([50] + [1] * 50), 10, 0.15),\n        ([5] * 20, 10, 0.05),\n        ([100], 10, 0.001),\n        ([1] * 100, 10, 0.5),\n    ]\n\n    results = []\n    for counts, m, alpha in test_cases:\n        decision = compute_decision(counts, m, alpha)\n        # Format boolean as specified (True, False)\n        results.append(str(decision))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}