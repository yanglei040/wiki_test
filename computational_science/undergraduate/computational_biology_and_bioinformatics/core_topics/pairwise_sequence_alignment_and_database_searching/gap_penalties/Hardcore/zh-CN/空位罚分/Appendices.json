{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们对空位罚分的实践探索，让我们从最基础的模型——线性空位罚分——入手。这项练习提供了一个直接的动手实践机会，要求你计算一个给定的序列比对得分，其中每一个空位都会产生固定的罚分。通过这个计算，你将能够巩固序列比对得分计算的基本方法。",
            "id": "2136014",
            "problem": "在生物信息学领域，序列比对是一种比较蛋白质或核苷酸序列的基本方法，用以识别可能由功能、结构或进化关系导致的相似区域。比对的质量通过一个分数来量化，该分数使用替换矩阵和空位罚分计算得出。\n\n考虑以下两个短肽序列 Seq1 和 Seq2 的有空位比对：\n\nSeq1: `F E S A G K D E`\nSeq2: `F R S - G K T E`\n\n请使用 BLOcks SUbstitution Matrix 62 (BLOSUM62) 和线性空位罚分来计算总比对分数。线性空位罚分意味着每个由连字符（`-`）表示的空位字符都会产生一个固定的负分，而与其长度或位置无关。对于本题，线性空位罚分为 8。\n\nBLOSUM62 矩阵中的相关替换分数如下所示：\n- Score(F, F) = 6\n- Score(E, R) = 0\n- Score(S, S) = 4\n- Score(G, G) = 6\n- Score(K, K) = 5\n- Score(D, T) = -1\n- Score(E, E) = 5\n\n请以整数形式提供总分数。",
            "solution": "比对分数是通过将每个比对上的残基对的替换分数相加，并减去每个空位字符的罚分来计算的。设 $s(x,y)$ 表示 BLOSUM62 替换分数，线性空位罚分为 $g=8$。\n\n对于给定的跨 8 列的比对，各项贡献分数如下：\n$$\ns(F,F)=6,\\quad s(E,R)=0,\\quad s(S,S)=4,\\quad \\text{gap penalty}=g=8,\\quad s(G,G)=6,\\quad s(K,K)=5,\\quad s(D,T)=-1,\\quad s(E,E)=5.\n$$\n\n因此，总比对分数 $S$ 为\n$$\nS=6+0+4-8+6+5-1+5=17.\n$$",
            "answer": "$$\\boxed{17}$$"
        },
        {
            "introduction": "在线性模型的基础上，我们现在转向一个更精细且更符合生物学现实的模型：仿射空位罚分。该模型通过区分“打开”一个空位的成本和“延伸”一个空位的成本，从而能更准确地进行评分。这项练习将挑战你应用仿射罚分公式到一个具体的比对中，从而加深你对这种两部分罚分系统如何工作的理解。",
            "id": "2136038",
            "problem": "在生物信息学中，序列比对是一种比较蛋白质或核苷酸序列以识别相似区域的基本方法。给定比对的质量由一个数值分数来量化，该分数基于序列之间的匹配、错配和空位进行计算。一种特别常见的空位罚分模型是仿射空位罚分模型，它区分了打开一个空位的代价和延长它的代价。\n\n考虑以下两条短肽序列 `PEPTIDE X` 和 `PEPTIDE Y` 的特定比对：\n\n`PEPTIDE X: VDLMSETKRG`\n`PEPTIDE Y: VDL-----RG`\n\n总比对分数是通过对每对垂直对齐的氨基酸的替换分数求和，并加上存在的任何空位的罚分来确定的。本任务的评分系统定义如下：\n\n1.  **替换分数**：将 `PEPTIDE X` 中的一个氨基酸与 `PEPTIDE Y` 中相同的氨基酸进行比对的分数在下表中给出。\n    *   S(V,V) = 4\n    *   S(D,D) = 6\n    *   S(L,L) = 4\n    *   S(R,R) = 5\n    *   S(G,G) = 6\n\n2.  **仿射空位罚分**：引入空位使用仿射模型进行罚分，参数如下：\n    *   空位开放罚分：11\n    *   空位扩展罚分：1\n\n计算上述特定比对的总比对分数。最终答案应为一个整数。",
            "solution": "我们解析给定的比对：\nPEPTIDE X: V D L M S E T K R G\nPEPTIDE Y: V D L - - - - - R G\n\n垂直对齐的配对是：\n- 匹配：$(V,V)$, $(D,D)$, $(L,L)$, $(R,R)$, $(G,G)$。\n- PEPTIDE Y 中一个长度为 $k=5$ 的连续空位，与 PEPTIDE X 中的 $M,S,E,T,K$ 对齐。\n\n替换分数的贡献是给定相同配对分数的总和：\n$$\nS_{\\text{sub}} = S(V,V) + S(D,D) + S(L,L) + S(R,R) + S(G,G)\n= 4 + 6 + 4 + 5 + 6 = 25.\n$$\n\n使用仿射空位罚分模型，长度为 $k$ 的单个连续空位的罚分成本由下式给出：\n$$\n\\text{Cost}_{\\text{gap}} = \\text{gap\\_open} + (k-1)\\,\\text{gap\\_extend}.\n$$\n在本题中，空位开放罚分为 $11$，空位延伸罚分为 $1$，空位长度 $k=5$。因此，罚分成本为：\n$$\n\\text{Cost}_{\\text{gap}} = 11 + (5-1)(1) = 11 + 4 = 15.\n$$\n\n总比对分数是替换得分减去空位罚分成本：\n$$\nS_{\\text{total}} = S_{\\text{sub}} - \\text{Cost}_{\\text{gap}} = 25 - 15 = 10.\n$$",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "在掌握了线性和仿射罚分的计算之后，我们现在转向一个更具概念性的挑战，它触及了序列比对的核心：替换得分与空位罚分之间的权衡。这个问题  要求你确定一个空位罚分的临界阈值，通过这个过程，你将清晰地看到罚分参数的选择如何直接决定一个有空位的比对还是一个无空位的比对被认为是“最优”的。",
            "id": "2392977",
            "problem": "考虑在仿射空位罚分模型下，对两个特定的等长核苷酸序列进行全局比对。比对得分定义为所有比对列的得分之和，其中包括碱基对的替换得分以及任何连续空位块的空位成本。替换得分为：一个匹配贡献 $+2$ 分，一个错配贡献 $-1$ 分。对于任意长度为 $\\ell$ 的空位块，其仿射空位成本为 $g_{open} + g_{ext} \\times (\\ell - 1)$，其中 $g_{open} \\ge 0$ 是空位开放罚分，$g_{ext} = 1$ 是超出第一个字符后每个额外空位字符的空位延伸罚分。\n\n给定这两个长度为 $n = 12$ 的序列，禁止空位的最佳全局比对（即按位置的、无空位的比对）恰好能达到 $m_{0} = 6$ 个匹配和 $n - m_{0} = 6$ 个错配。如果比对被允许在任一序列中包含最多一个长度为 $\\ell = 1$ 的连续空位块，那么存在一种这种单空位比对的放置方式，可以恰好产生 $m_{1} = 10$ 个匹配和 $(n - 1) - m_{1} = 1$ 个错配（注意，其中一个比对列是碱基-空位对）。\n\n确定空位开放罚分 $g_{open}$ 的最大值（与替换得分使用相同的计分单位），使得存在一个包含至少一个空位的最佳全局比对；等价地，确定阈值 $g_{open}^{*}$，使得当且仅当 $g_{open} \\le g_{open}^{*}$ 时，单空位比对获得的分数大于或等于最佳无空位比对的分数。请以单一数字形式给出答案。无需四舍五入。",
            "solution": "首先应对问题进行严格的验证过程。\n\n步骤 1：提取给定条件\n- 两个序列等长，$n = 12$。\n- 比对得分是替换得分和空位成本的总和。\n- 匹配的替换得分：$+2$。\n- 错配的替换得分：$-1$。\n- 长度为 $\\ell$ 的空位块的仿射空位成本由函数 $C(\\ell) = g_{open} + g_{ext} \\times (\\ell - 1)$ 给出。\n- 空位开放罚分为 $g_{open} \\ge 0$。\n- 空位延伸罚分为 $g_{ext} = 1$。\n- 一个纯粹无空位的比对（最佳可能）产生 $m_{0} = 6$ 个匹配和 $n - m_{0} = 6$ 个错配。\n- 考虑一个最多包含一个长度为 $\\ell=1$ 的连续空位块的替代比对。\n- 这个单空位比对产生 $m_{1} = 10$ 个匹配和 $(n - 1) - m_{1} = 1$ 个错配。\n- 任务是找到 $g_{open}$ 的最大值，记为 $g_{open}^{*}$，使得包含至少一个空位的比对是最佳的。这等价于找到一个阈值，在该阈值下，含空位比对的分数大于或等于无空位比对的分数。\n\n步骤 2：使用提取的给定条件进行验证\n- **科学依据**：该问题设置在计算生物学中序列比对的标准框架内。仿射空位罚分模型是该领域的一个基本概念。所有定义和评分方案均与既有文献一致。该问题是科学合理的。\n- **良态问题**：该问题提供了计算两种不同比对情景得分所需的所有必要参数和条件。目标是通过比较这两个得分来找到参数 $g_{open}$ 的一个特定阈值。这是一个定义明确且有唯一解的数学任务。\n- **客观性**：问题陈述使用精确的、定量的语言来表述。它没有歧义、主观性或基于观点的断言。\n\n步骤 3：结论与行动\n该问题是有效的。它具有科学依据，是良态问题，并且是客观的。我将继续推导解决方案。\n\n目标是找到空位开放罚分的阈值 $g^{*}_{open}$，使得对于任何 $g_{open} \\le g^{*}_{open}$，最佳比对得分由一个包含至少一个空位的比对实现。这意味着我们必须找到含空位比对的得分 $S_{gap}$ 大于或等于无空位比对的得分 $S_{nogap}$ 的条件。\n\n首先，我们计算最佳无空位比对的得分 $S_{nogap}$。根据问题陈述，该比对有 $m_{0} = 6$ 个匹配和 $n - m_{0} = 12 - 6 = 6$ 个错配。得分计算如下：\n$$S_{nogap} = (\\text{number of matches} \\times \\text{match score}) + (\\text{number of mismatches} \\times \\text{mismatch score})$$\n$$S_{nogap} = m_{0} \\times (+2) + (n - m_{0}) \\times (-1)$$\n代入给定值：\n$$S_{nogap} = 6 \\times 2 + 6 \\times (-1) = 12 - 6 = 6$$\n\n接下来，我们计算指定的含一个空位的比对得分 $S_{gap}$。该比对有一个长度为 $\\ell = 1$ 的连续空位块。它产生了 $m_{1} = 10$ 个匹配和 $(n - 1) - m_{1} = (12 - 1) - 10 = 1$ 个错配。因此，该比对包含 10 个匹配列，1 个错配列，和 1 个含空位的列。\n\n得分 $S_{gap}$ 是匹配和错配得分的总和，减去空位的成本。\n来自匹配和错配的贡献为：\n$$S_{substitutions} = m_{1} \\times (+2) + ((n - 1) - m_{1}) \\times (-1)$$\n$$S_{substitutions} = 10 \\times 2 + 1 \\times (-1) = 20 - 1 = 19$$\n\n空位块的成本 $C(\\ell)$ 由仿射空位罚分模型确定：\n$$C(\\ell) = g_{open} + g_{ext} \\times (\\ell - 1)$$\n对于此比对，空位长度为 $\\ell = 1$，延伸罚分为 $g_{ext} = 1$。\n$$C(1) = g_{open} + 1 \\times (1 - 1) = g_{open} + 0 = g_{open}$$\n此成本从得分中减去。因此，含空位比对的总得分为：\n$$S_{gap} = S_{substitutions} - C(1) = 19 - g_{open}$$\n\n如果含空位比对的得分大于或等于无空位比对的得分，则它更优或同等最优：\n$$S_{gap} \\ge S_{nogap}$$\n代入得分的表达式：\n$$19 - g_{open} \\ge 6$$\n\n我们现在解这个关于 $g_{open}$ 的不等式：\n$$19 - 6 \\ge g_{open}$$\n$$13 \\ge g_{open}$$\n这表明当且仅当 $g_{open} \\le 13$ 时，单空位比对的得分将大于或等于无空位比对的得分。问题要求的是使此条件成立的 $g_{open}$ 的最大值。这个阈值就是 $g_{open}^{*}$。\n\n因此，最大值为 $g_{open}^{*} = 13$。对于任何 $g_{open} > 13$，引入空位的罚分过高，无空位比对将是严格最优的。对于 $g_{open} \\le 13$，包含至少一个空位的比对会成为最优解之一。",
            "answer": "$$\\boxed{13}$$"
        }
    ]
}