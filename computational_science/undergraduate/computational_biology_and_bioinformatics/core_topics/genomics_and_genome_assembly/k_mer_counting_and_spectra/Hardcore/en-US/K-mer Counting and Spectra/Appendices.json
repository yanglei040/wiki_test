{
    "hands_on_practices": [
        {
            "introduction": "The shape of a k-mer spectrum is a rich source of information about the underlying genome's structure. This practice challenges you to move from qualitative observation to quantitative analysis by interpreting a hypothetical spectrum. By calculating a \"Repeat Complexity Index\" from the areas under the haploid and repeat peaks, you will learn how these spectral features can be used to summarize complex genomic characteristics like repeat content. ",
            "id": "2400957",
            "problem": "A k-mer histogram is constructed by counting the number of distinct length-$k$ substrings (k-mers) from sequencing reads and tabulating how many times each distinct k-mer occurs in the reads. After excluding low-frequency error k-mers, the remaining non-error k-mer multiplicities for a diploid genome typically form a dominant haploid peak (unique sequence) near the average coverage and secondary peaks at higher multiplicities corresponding to repeats. Consider a non-overlapping binning of the non-error k-mer spectrum from a deeply sequenced diploid genome with $k=31$. The bins have been chosen to isolate two peaks: a haploid peak centered near coverage $c \\approx 40$ and a repeat peak centered near coverage $c \\approx 80$. For each listed coverage value $c$, you are given the number of distinct k-mers recorded at that multiplicity.\n\nHaploid-peak coverage values and counts (coverage $c$; distinct k-mer count in that bin):\n- $c = 32$: $2.40 \\times 10^{5}$\n- $c = 36$: $4.80 \\times 10^{5}$\n- $c = 40$: $6.00 \\times 10^{5}$\n- $c = 44$: $4.50 \\times 10^{5}$\n- $c = 48$: $2.00 \\times 10^{5}$\n\nRepeat-peak coverage values and counts (coverage $c$; distinct k-mer count in that bin):\n- $c = 68$: $1.00 \\times 10^{5}$\n- $c = 72$: $2.50 \\times 10^{5}$\n- $c = 76$: $4.00 \\times 10^{5}$\n- $c = 80$: $4.50 \\times 10^{5}$\n- $c = 84$: $4.00 \\times 10^{5}$\n- $c = 88$: $2.80 \\times 10^{5}$\n- $c = 92$: $1.20 \\times 10^{5}$\n\nDefine the Repeat Complexity Index $R$ as the ratio of the area under the repeat peak to the area under the haploid peak, where each peakâ€™s area is defined as the sum of the listed distinct k-mer counts across its coverage bins. Compute $R$. Round your answer to four significant figures.",
            "solution": "The k-mer histogram records, for each multiplicity $c$, the number of distinct k-mers observed exactly $c$ times. When peak intervals are non-overlapping and chosen to isolate a peak, the area under a peak is obtained by summing the distinct k-mer counts across the bins in that interval. By the definition in the problem, the Repeat Complexity Index $R$ is\n$$\nR \\equiv \\frac{A_{\\text{repeat}}}{A_{\\text{haploid}}},\n$$\nwhere $A_{\\text{repeat}}$ is the sum of the repeat-peak counts and $A_{\\text{haploid}}$ is the sum of the haploid-peak counts.\n\nFirst, compute the haploid peak area:\n\n$$\nA_{\\text{haploid}} = \\left(2.40 \\times 10^{5}\\right) + \\left(4.80 \\times 10^{5}\\right) + \\left(6.00 \\times 10^{5}\\right) + \\left(4.50 \\times 10^{5}\\right) + \\left(2.00 \\times 10^{5}\\right).\n$$\n\nGroup the terms to simplify:\n\n$$\n\\left(2.40 + 4.80\\right) \\times 10^{5} = 7.20 \\times 10^{5},\n$$\n\n\n$$\n7.20 \\times 10^{5} + 6.00 \\times 10^{5} = 1.32 \\times 10^{6},\n$$\n\n\n$$\n1.32 \\times 10^{6} + 4.50 \\times 10^{5} = 1.77 \\times 10^{6},\n$$\n\n\n$$\n1.77 \\times 10^{6} + 2.00 \\times 10^{5} = 1.97 \\times 10^{6}.\n$$\n\nThus,\n\n$$\nA_{\\text{haploid}} = 1.97 \\times 10^{6}.\n$$\n\n\nNext, compute the repeat peak area:\n\n$$\nA_{\\text{repeat}} = \\left(1.00 \\times 10^{5}\\right) + \\left(2.50 \\times 10^{5}\\right) + \\left(4.00 \\times 10^{5}\\right) + \\left(4.50 \\times 10^{5}\\right) + \\left(4.00 \\times 10^{5}\\right) + \\left(2.80 \\times 10^{5}\\right) + \\left(1.20 \\times 10^{5}\\right).\n$$\n\nSum progressively:\n\n$$\n\\left(1.00 + 2.50\\right) \\times 10^{5} = 3.50 \\times 10^{5},\n$$\n\n\n$$\n3.50 \\times 10^{5} + 4.00 \\times 10^{5} = 7.50 \\times 10^{5},\n$$\n\n\n$$\n7.50 \\times 10^{5} + 4.50 \\times 10^{5} = 1.20 \\times 10^{6},\n$$\n\n\n$$\n1.20 \\times 10^{6} + 4.00 \\times 10^{5} = 1.60 \\times 10^{6},\n$$\n\n\n$$\n1.60 \\times 10^{6} + 2.80 \\times 10^{5} = 1.88 \\times 10^{6},\n$$\n\n\n$$\n1.88 \\times 10^{6} + 1.20 \\times 10^{5} = 2.00 \\times 10^{6}.\n$$\n\nThus,\n\n$$\nA_{\\text{repeat}} = 2.00 \\times 10^{6}.\n$$\n\n\nForm the ratio:\n\n$$\nR = \\frac{A_{\\text{repeat}}}{A_{\\text{haploid}}} = \\frac{2.00 \\times 10^{6}}{1.97 \\times 10^{6}} = \\frac{2.00}{1.97}.\n$$\n\n\nEvaluate the ratio:\n\n$$\n\\frac{2.00}{1.97} = 1.015228426\\ldots\n$$\n\nRounded to four significant figures,\n\n$$\nR = 1.015.\n$$",
            "answer": "$$\\boxed{1.015}$$"
        },
        {
            "introduction": "Beyond characterizing a known genome, k-mer spectra are invaluable for discovery, such as identifying somatic mutations in cancer. This exercise places you in the role of a computational oncologist, using a model of tumor biology to predict where to find the signal for cancer-specific mutations. By calculating the expected multiplicity of mutation-bearing k-mers based on tumor purity and sequencing depth, you will see how theoretical principles guide the search for critical variants in complex biological data. ",
            "id": "2401000",
            "problem": "A whole-genome sequencing experiment is performed on a tissue sample that is a mixture of normal cells and tumor cells. The tumor cell fraction (tumor purity) is $0.15$. Sequencing is unbiased so that the expected fraction of reads originating from tumor cells equals the tumor cell fraction. The genome is diploid and copy-number neutral at all loci considered. Reads are long relative to the chosen $k$ so that the expected multiplicity of a unique $k$-mer equals the expected read depth at its genomic locus. Sequencing errors have been filtered so that erroneous $k$-mers are negligible, and $k$ is large enough that $k$-mers overlapping a single-nucleotide somatic mutation are unique in the genome.\n\nLet the mean per-base read depth across the mixture be $D = 80$. Consider $k$-mers that uniquely span heterozygous somatic point mutations present only in tumor cells. Under the assumptions above, at what expected multiplicity $x$ (the mode location of the peak in the $k$-mer multiplicity spectrum for these mutation-bearing $k$-mers) would you expect these $k$-mers to appear? Provide $x$ as a single real number. No rounding is necessary and no units should be included in your answer.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Tumor cell fraction (tumor purity): $p = 0.15$\n- Genome status: Diploid and copy-number neutral.\n- Mean per-base read depth across the mixture: $D = 80$\n- Mutation type: Heterozygous somatic point mutations present only in tumor cells.\n- Assumption 1: Expected fraction of reads from tumor cells equals the tumor cell fraction.\n- Assumption 2: Expected multiplicity of a unique $k$-mer equals the expected read depth at its genomic locus (specifically, for the allele spanned by the $k$-mer).\n- Assumption 3: Sequencing errors are negligible.\n- Assumption 4: $k$-mers overlapping a single-nucleotide somatic mutation are unique in the genome.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard simplified model for analyzing somatic mutations from whole-genome sequencing data of a tumor-normal mixture. The concepts of tumor purity, read depth, diploidy, heterozygous mutations, and $k$-mer spectra are fundamental in computational biology. The problem is well-posed, providing all necessary parameters ($D$ and $p$) and clear assumptions to calculate a unique expected value. The language is objective and precise. The problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe objective is to calculate the expected multiplicity, $x$, of $k$-mers that contain a heterozygous somatic mutation found only in tumor cells. This multiplicity is equivalent to the expected read depth of the mutated allele.\n\nLet $D$ be the total mean read depth across the sample mixture, given as $D = 80$.\nLet $p$ be the tumor purity, or the fraction of tumor cells in the sample, given as $p = 0.15$. The fraction of normal cells is therefore $1-p$.\n\nThe total read depth $D$ is composed of reads originating from normal cells and tumor cells.\nThe expected depth contribution from normal cells is $D_{normal} = D \\times (1-p)$.\nThe expected depth contribution from tumor cells is $D_{tumor} = D \\times p$.\n\nWe consider a specific genomic locus where a heterozygous somatic mutation exists. Let the reference allele be 'A' and the mutated allele be 'a'.\n- **Normal cells:** These cells are diploid and do not contain the mutation. Their genotype at this locus is AA.\n- **Tumor cells:** These cells are diploid and contain a heterozygous mutation. Their genotype at this locus is Aa.\n\nThe reads covering this locus will be composed of reads supporting allele 'A' and reads supporting allele 'a'. We need to find the expected depth of reads supporting the mutated allele 'a'.\n\nReads from normal cells (genotype AA) will only support the reference allele 'A'.\nReads from tumor cells (genotype Aa), being diploid and heterozygous, will be split equally between supporting the reference allele 'A' and the mutated allele 'a'. Thus, the frequency of the 'a' allele within the tumor cell population is $0.5$.\n\nThe expected depth of the mutated allele, $D_a$, is sourced exclusively from the tumor cells. It is the product of the depth from tumor cells and the frequency of the allele 'a' within those cells.\n$$\nD_a = D_{tumor} \\times (\\text{frequency of 'a' in tumor cells})\n$$\nSubstituting the expressions for $D_{tumor}$ and the allele frequency:\n$$\nD_a = (D \\times p) \\times 0.5\n$$\nThe problem states that the expected multiplicity $x$ of a unique $k$-mer equals the expected read depth of the allele it spans. Therefore, the expected multiplicity of the mutation-bearing $k$-mer is equal to $D_a$.\n$$\nx = D_a = 0.5 \\times p \\times D\n$$\nNow, we substitute the given numerical values: $D = 80$ and $p = 0.15$.\n$$\nx = 0.5 \\times 0.15 \\times 80\n$$\n$$\nx = 0.5 \\times (0.15 \\times 80) = 0.5 \\times 12\n$$\n$$\nx = 6\n$$\nThe expected multiplicity for $k$-mers spanning the heterozygous somatic mutation is $6$. This value represents the expected location of the somatic mutation peak in the $k$-mer multiplicity spectrum. The corresponding peak for heterozygous germline variants would be at an expected multiplicity of $0.5 \\times D = 0.5 \\times 80 = 40$. The peak for homozygous reference $k$-mers would be at $D = 80$. The calculated value of $6$ is consistent with this model.",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "The power of any k-mer based method hinges on a crucial initial choice: the value of $k$. This parameter is not arbitrary; it must be carefully selected to balance sensitivity and specificity. This hands-on practice guides you through the process of determining an optimal $k$ for distinguishing between two bacterial genomes by formalizing the trade-offs into mathematical constraints, a core task in bioinformatics algorithm design. ",
            "id": "2400966",
            "problem": "You are given two haploid bacterial genomes modeled as sequences over a four-letter alphabet with size $|\\Sigma| = 4$. Let the sequences have equal length $L$ nucleotides and be positionally aligned. Assume a stochastic point-mutation model in which each aligned site matches with probability $p$ (Average Nucleotide Identity (ANI)) and mismatches with probability $1 - p$, independently across sites. For a given integer $k$ with $1 \\le k \\le L$, define the $k$-mer set of a genome as the set of all distinct contiguous substrings of length $k$ obtained by sliding a window of step size $1$ across the genome. Assume that for the values of $k$ you will consider, within-genome $k$-mer duplicates can be neglected (so the size of each $k$-mer set is $N = L - k + 1$ to a very good approximation). Let $A_k$ and $B_k$ denote the $k$-mer sets of the two genomes, respectively.\n\nDefine the Jaccard similarity of sets $A$ and $B$ as $J(A,B) = \\frac{|A \\cap B|}{|A \\cup B|}$. Under the stochastic model above and the within-genome uniqueness approximation, the only contributors to $|A_k \\cap B_k|$ are $k$-mers that remain unchanged at homologous positions, provided that non-homologous cross-genome coincidences are negligible. To ensure that such accidental non-homologous matches are negligible, impose the collision-avoidance constraint\n$$\n4^k \\ge \\alpha \\, (L - k + 1)^2,\n$$\nwith a fixed constant $\\alpha = 10$, which guarantees that the expected number of accidental matches between non-homologous $k$-mers across the two genomes is much less than $1$ under an independent and identically distributed uniform background approximation.\n\nA value of $k$ is called acceptable if both of the following hold:\n- The expected Jaccard similarity $J(A_k,B_k)$, computed from first principles under the model described above, is less than or equal to a given threshold $\\tau$.\n- The collision-avoidance inequality $4^k \\ge \\alpha \\, (L - k + 1)^2$ holds.\n\nA value of $k$ is called optimal if it is acceptable and no smaller positive integer $k'$ with $1 \\le k'  k$ is acceptable.\n\nTask: For each test case below, determine the optimal $k$. If no acceptable $k$ exists within the range $1 \\le k \\le L$, return $-1$.\n\nUse the following test suite, each specified as a triple $(L, p, \\tau)$:\n- Test $1$: $(L, p, \\tau) = (\\,5000000,\\, 0.99,\\, 0.1\\,)$.\n- Test $2$: $(L, p, \\tau) = (\\,100000,\\, 1.0,\\, 0.9\\,)$.\n- Test $3$: $(L, p, \\tau) = (\\,10000,\\, 0.9,\\, 0.2\\,)$.\n- Test $4$: $(L, p, \\tau) = (\\,3000000,\\, 0.95,\\, 0.05\\,)$.\n- Test $5$: $(L, p, \\tau) = (\\,50,\\, 0.999,\\, 0.2\\,)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of integers enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\"), where each entry is the optimal $k$ (or $-1$ when no acceptable $k$ exists) for the corresponding test in the same order.",
            "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in computational biology that is free of contradictions, ambiguities, and factual errors. All necessary parameters and constraints are clearly defined. We may therefore proceed with a formal solution.\n\nThe task is to find the optimal $k$, defined as the smallest positive integer $k$ in the range $1 \\le k \\le L$ that satisfies two conditions: one related to the expected Jaccard similarity and another being a collision-avoidance constraint.\n\nFirst, we must derive a tractable expression for the expected Jaccard similarity, $E[J(A_k, B_k)]$, under the given model and its approximations. The Jaccard similarity for two sets $A_k$ and $B_k$ is defined as $J(A_k, B_k) = \\frac{|A_k \\cap B_k|}{|A_k \\cup B_k|}$.\n\nThe problem states several key approximations:\n1.  The number of distinct $k$-mers within each genome is approximately $N = L - k + 1$. Thus, we take $|A_k| \\approx N$ and $|B_k| \\approx N$.\n2.  The intersection $A_k \\cap B_k$ is formed almost exclusively by $k$-mers at homologous positions that have remained identical. Accidental matches between non-homologous $k$-mers are considered negligible.\n\nLet us calculate the expected size of the intersection, $E[|A_k \\cap B_k|]$. There are $N = L - k + 1$ homologous pairs of $k$-mers. For a single homologous pair to be identical, all $k$ nucleotides must match. The probability of a single nucleotide site matching is given as $p$. Since mutations are independent across sites, the probability of a $k$-mer matching its homologous counterpart is $p^k$. By linearity of expectation, the expected number of identical homologous $k$-mers is the sum of these probabilities over all $N$ positions:\n$$E[|A_k \\cap B_k|] = \\sum_{i=1}^{N} P(\\text{k-mer at position } i \\text{ matches}) = N \\cdot p^k = (L - k + 1)p^k$$\n\nNext, we consider the union $|A_k \\cup B_k| = |A_k| + |B_k| - |A_k \\cap B_k|$. Using the approximation $|A_k| \\approx |B_k| \\approx N$, we get $|A_k \\cup B_k| \\approx 2N - |A_k \\cap B_k|$.\n\nThe problem asks for a constraint on the expected Jaccard similarity, $E[J(A_k, B_k)] = E\\left[\\frac{|A_k \\cap B_k|}{2N - |A_k \\cap B_k|}\\right]$. A standard, justifiable approximation in such stochastic models is to approximate the expectation of the ratio by the ratio of the expectations:\n$$E[J(A_k, B_k)] \\approx \\frac{E[|A_k \\cap B_k|]}{E[|A_k \\cup B_k|]} = \\frac{E[|A_k \\cap B_k|]}{2N - E[|A_k \\cap B_k|]}$$\nSubstituting our expression for $E[|A_k \\cap B_k|]$:\n$$E[J(A_k, B_k)] \\approx \\frac{N p^k}{2N - N p^k} = \\frac{p^k}{2 - p^k}$$\nThis expression correctly captures the limiting behavior: as $p \\to 1$, the expected Jaccard index approaches $1$; as $p \\to 0$, it approaches $0$.\n\nWith this, we can state the two conditions for a value of $k$ to be \"acceptable\":\n\n1.  **Jaccard Similarity Condition**: The expected Jaccard similarity must not exceed a threshold $\\tau$.\n    $$\\frac{p^k}{2 - p^k} \\le \\tau$$\n2.  **Collision-Avoidance Condition**: This is provided in the problem statement, with $\\alpha = 10$.\n    $$4^k \\ge 10 \\cdot (L - k + 1)^2$$\n\nAn integer $k$ is optimal if it is the smallest positive integer ($1 \\le k \\le L$) that satisfies both of these inequalities. The logical approach is to search for this minimum value. Both conditions establish a lower bound on $k$. For $p  1$, the function $f_1(k) = \\frac{p^k}{2-p^k}$ is a decreasing function of $k$, so the first condition is met for sufficiently large $k$. The function $f_2(k) = 4^k$ grows exponentially, while $g_2(k) = 10(L-k+1)^2$ decreases for $k1$. Thus, the second condition is also met for sufficiently large $k$. This monotonic behavior guarantees that once both conditions are met for a value $k^*$, they will also be met for all $k  k^*$.\n\nThe algorithm to find the optimal $k$ is therefore a simple linear search:\n1.  Iterate through integer values of $k$ starting from $1$ up to the maximum possible length, $L$.\n2.  For each $k$, test if both inequalities are satisfied.\n3.  The first value of $k$ for which both inequalities hold true is, by definition, the optimal $k$.\n4.  If the search completes up to $k=L$ without finding any acceptable value, no such $k$ exists in the specified range, and the result is $-1$.\n\nThis procedure is implemented for each of the given test cases. Python's arbitrary-precision integers are necessary to handle the large numbers encountered in the collision-avoidance condition, specifically the term $4^k$.",
            "answer": "[170,-1,15,46,-1]"
        }
    ]
}