{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握邻接法，没有比亲自动手实践更好的方法了。本练习将引导您完成邻接算法关键的第一轮迭代，使用一个为五个向日葵物种设计的假设遗传距离矩阵。通过计算 $Q$ 矩阵并找出要合并的第一对物种，您将对这个强大的系统发育工具的核心机制有一个具体的理解 。",
            "id": "1771208",
            "problem": "一个植物学家团队正在研究五种最近发现的向日葵物种之间的进化关系。他们对每个物种的一个特定基因进行了测序，并计算了一个成对遗传距离矩阵，该矩阵量化了每对物种之间的分歧。这些物种是 *Helianthus arcanus*（HA）、*Helianthus borealis*（HB）、*Helianthus campestris*（HC）、*Helianthus deserticola*（HD） 和 *Helianthus elegans*（HE）。\n\n植物学家们决定使用邻接法（NJ）算法构建一个系统发育树。你的任务是执行该算法的第一步，以确定哪两个物种最先被组合在一起形成一个新的内部节点。\n\n遗传距离矩阵如下所示，其中的值代表无单位的遗传分歧度量：\n\n|        | HA | HB | HC | HD | HE |\n| :----: | :-: | :-: | :-: | :-: | :-: |\n| **HA** | 0  | 5  | 4  | 7  | 6  |\n| **HB** | 5  | 0  | 7  | 10 | 9  |\n| **HC** | 4  | 7  | 0  | 7  | 6  |\n| **HD** | 7  | 10 | 7  | 0  | 5  |\n| **HE** | 6  | 9  | 6  | 5  | 0  |\n\n根据这个矩阵，以下哪个陈述正确描述了邻接法算法第一个连接步骤的结果？\n\nA. 将 (*H. deserticola*, *H. elegans*) 这对进行连接。从这个新节点到 *H. arcanus* 的新距离为4，到 *H. borealis* 的新距离为7，到 *H. campestris* 的新距离为4。\n\nB. 将 (*H. arcanus*, *H. borealis*) 这对进行连接。从这个新节点到 *H. campestris* 的新距离为3，到 *H. deserticola* 的新距离为6，到 *H. elegans* 的新距离为5。\n\nC. 将 (*H. arcanus*, *H. campestris*) 这对进行连接。从这个新节点到 *H. borealis* 的新距离为4，到 *H. deserticola* 的新距离为5，到 *H. elegans* 的新距离为4。\n\nD. 将 (*H. deserticola*, *H. elegans*) 这对进行连接。从这个新节点到 *H. arcanus* 的新距离为3，到 *H. borealis* 的新距离为2，到 *H. campestris* 的新距离为3。\n\nE. 将 (*H. campestris*, *H. deserticola*) 这对进行连接。从这个新节点到 *H. arcanus* 的新距离为5.5，到 *H. borealis* 的新距离为8，到 *H. elegans* 的新距离为4。",
            "solution": "要使用分类单元 $\\{\\mathrm{HA}, \\mathrm{HB}, \\mathrm{HC}, \\mathrm{HD}, \\mathrm{HE}\\}$ 和距离矩阵 $d(i,j)$ 执行邻接法（NJ）算法的第一步，需要计算行和 $r_{i}=\\sum_{k \\ne i} d(i,k)$ 以及 $Q$ 矩阵的条目\n$$\nQ(i,j)=(n-2)\\,d(i,j)-r_{i}-r_{j},\n$$\n其中 $n=5$。\n\n首先计算行和：\n$$\n\\begin{aligned}\nr_{\\mathrm{HA}}=d(\\mathrm{HA},\\mathrm{HB})+d(\\mathrm{HA},\\mathrm{HC})+d(\\mathrm{HA},\\mathrm{HD})+d(\\mathrm{HA},\\mathrm{HE})=5+4+7+6=22,\\\\\nr_{\\mathrm{HB}}=5+7+10+9=31,\\\\\nr_{\\mathrm{HC}}=4+7+7+6=24,\\\\\nr_{\\mathrm{HD}}=7+10+7+5=29,\\\\\nr_{\\mathrm{HE}}=6+9+6+5=26.\n\\end{aligned}\n$$\n当 $n-2=3$ 时，计算 $Q$ 值：\n$$\n\\begin{aligned}\nQ(\\mathrm{HA},\\mathrm{HB})=3\\cdot 5-22-31=15-53=-38,\\\\\nQ(\\mathrm{HA},\\mathrm{HC})=3\\cdot 4-22-24=12-46=-34,\\\\\nQ(\\mathrm{HA},\\mathrm{HD})=3\\cdot 7-22-29=21-51=-30,\\\\\nQ(\\mathrm{HA},\\mathrm{HE})=3\\cdot 6-22-26=18-48=-30,\\\\\nQ(\\mathrm{HB},\\mathrm{HC})=3\\cdot 7-31-24=21-55=-34,\\\\\nQ(\\mathrm{HB},\\mathrm{HD})=3\\cdot 10-31-29=30-60=-30,\\\\\nQ(\\mathrm{HB},\\mathrm{HE})=3\\cdot 9-31-26=27-57=-30,\\\\\nQ(\\mathrm{HC},\\mathrm{HD})=3\\cdot 7-24-29=21-53=-32,\\\\\nQ(\\mathrm{HC},\\mathrm{HE})=3\\cdot 6-24-26=18-50=-32,\\\\\nQ(\\mathrm{HD},\\mathrm{HE})=3\\cdot 5-29-26=15-55=-40.\n\\end{aligned}\n$$\n最小的 $Q$ 值为 $Q(\\mathrm{HD},\\mathrm{HE})=-40$，因此第一个连接的对是 $(\\mathrm{HD},\\mathrm{HE})$。\n\nNJ归约法给出从连接 $\\mathrm{HD}$ 和 $\\mathrm{HE}$ 的新节点 $U$ 到任何剩余分类单元 $k$ 的距离，公式为\n$$\nd(U,k)=\\frac{d(\\mathrm{HD},k)+d(\\mathrm{HE},k)-d(\\mathrm{HD},\\mathrm{HE})}{2}.\n$$\n使用 $d(\\mathrm{HD},\\mathrm{HE})=5$ 为 $k\\in\\{\\mathrm{HA},\\mathrm{HB},\\mathrm{HC}\\}$ 计算这些距离：\n$$\n\\begin{aligned}\nd(U,\\mathrm{HA})=\\frac{d(\\mathrm{HD},\\mathrm{HA})+d(\\mathrm{HE},\\mathrm{HA})-d(\\mathrm{HD},\\mathrm{HE})}{2}=\\frac{7+6-5}{2}=4,\\\\\nd(U,\\mathrm{HB})=\\frac{10+9-5}{2}=7,\\\\\nd(U,\\mathrm{HC})=\\frac{7+6-5}{2}=4.\n\\end{aligned}\n$$\n因此，第一个连接的对是 $(\\mathrm{HD},\\mathrm{HE})$，其到 $\\mathrm{HA}$ 的新距离为 $4$，到 $\\mathrm{HB}$ 的新距离为 $7$，到 $\\mathrm{HC}$ 的新距离为 $4$，这与选项A相符。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "邻接算法的优势在于其独特的选择标准，它不仅仅是简单地挑选最接近的一对分类单元。这个思想实验使用一个精心构建的对称距离矩阵，揭示了 $Q$ 矩阵公式背后的逻辑。通过解决这个例子，您将看到该算法如何平衡原始距离与分类单元在整个数据集中的位置，这是准确识别真正“邻居”的关键特性 。",
            "id": "2385845",
            "problem": "考虑一个包含 $4$ 个分类单元的集合，标记为 $A$、$B$、$C$ 和 $D$，其加性成对距离为 $d(A,B)=2$、$d(C,D)=2$，所有其他成对距离等于 $3$。在近邻结合法（NJ）中，第一个要连接的对的选择是基于最小化为 $n$ 个分类单元定义的准则矩阵 $Q(i,j)$：\n$$\nQ(i,j) = (n-2)\\,d(i,j) - \\sum_{k} d(i,k) - \\sum_{k} d(j,k),\n$$\n其中每个求和都遍及集合中的所有分类单元。使用此定义及 $n=4$ 的情况，计算对于给定的距离，在所有无序对 $\\{i,j\\}$ 上 $Q(i,j)$ 的最小值。请以精确整数形式给出你的答案。",
            "solution": "任务是对于一组标记为 $A$、$B$、$C$ 和 $D$ 的 $n=4$ 个分类单元，找出近邻结合法准则 $Q(i,j)$ 的最小值。成对距离给出为 $d(A,B)=2$、$d(C,D)=2$，所有其他成对距离等于 $3$。具体来说，这意味着 $d(A,C)=3$、$d(A,D)=3$、$d(B,C)=3$ 以及 $d(B,D)=3$。距离是对称的，因此对于任何分类单元对 $\\{i,j\\}$，都有 $d(i,j) = d(j,i)$。\n\n$Q$ 矩阵的公式如下：\n$$\nQ(i,j) = (n-2)\\,d(i,j) - \\sum_{k} d(i,k) - \\sum_{k} d(j,k)\n$$\n其中求和遍及集合中的所有分类单元。\n当有 $n=4$ 个分类单元时，公式变为：\n$$\nQ(i,j) = (4-2)\\,d(i,j) - \\sum_{k \\in \\{A,B,C,D\\}} d(i,k) - \\sum_{k \\in \\{A,B,C,D\\}} d(j,k)\n$$\n$$\nQ(i,j) = 2\\,d(i,j) - \\sum_{k \\in \\{A,B,C,D\\}} d(i,k) - \\sum_{k \\in \\{A,B,C,D\\}} d(j,k)\n$$\n让我们将 $S_i$ 定义为从分类单元 $i$ 到集合中所有其他分类单元的距离之和：\n$$\nS_i = \\sum_{k \\in \\{A,B,C,D\\}} d(i,k)\n$$\n$Q(i,j)$ 的公式可以更紧凑地写为：\n$$\nQ(i,j) = 2\\,d(i,j) - S_i - S_j\n$$\n首先，我们计算每个分类单元 $i \\in \\{A,B,C,D\\}$ 的 $S_i$ 值。按照惯例，一个分类单元到其自身的距离为 $d(i,i)=0$。\n\n对于分类单元 $A$：\n$S_A = d(A,A) + d(A,B) + d(A,C) + d(A,D) = 0 + 2 + 3 + 3 = 8$。\n\n对于分类单元 $B$：\n$S_B = d(B,A) + d(B,B) + d(B,C) + d(B,D) = 2 + 0 + 3 + 3 = 8$。\n\n对于分类单元 $C$：\n$S_C = d(C,A) + d(C,B) + d(C,C) + d(C,D) = 3 + 3 + 0 + 2 = 8$。\n\n对于分类单元 $D$：\n$S_D = d(D,A) + d(D,B) + d(D,C) + d(D,D) = 3 + 3 + 2 + 0 = 8$。\n\n所有的和 $S_i$ 都等于 $8$。现在，我们必须计算所有不同的无序对 $\\{i,j\\}$ 的 $Q(i,j)$ 值。所有这些对的集合是 $\\{A,B\\}$、$\\{A,C\\}$、$\\{A,D\\}$、$\\{B,C\\}$、$\\{B,D\\}$ 和 $\\{C,D\\}$。由于给定距离矩阵的对称性，我们可以根据距离值将这些对分组。对于不相同的对，只有两种不同的距离值：$2$ 和 $3$。\n\n情况1：距离 $d(i,j)=2$ 的对。\n这组包括对 $\\{A,B\\}$ 和 $\\{C,D\\}$。我们来计算 $Q(A,B)$：\n$Q(A,B) = 2\\,d(A,B) - S_A - S_B = 2(2) - 8 - 8 = 4 - 16 = -12$。\n由于对称性，$Q(C,D)$ 的计算是相同的：\n$Q(C,D) = 2\\,d(C,D) - S_C - S_D = 2(2) - 8 - 8 = 4 - 16 = -12$。\n\n情况2：距离 $d(i,j)=3$ 的对。\n这组包括对 $\\{A,C\\}$、$\\{A,D\\}$、$\\{B,C\\}$ 和 $\\{B,D\\}$。我们来计算 $Q(A,C)$：\n$Q(A,C) = 2\\,d(A,C) - S_A - S_C = 2(3) - 8 - 8 = 6 - 16 = -10$。\n对于该组中的所有其他对，结果都是相同的。例如，对于 $\\{B,D\\}$：\n$Q(B,D) = 2\\,d(B,D) - S_B - S_D = 2(3) - 8 - 8 = 6 - 16 = -10$。\n\n所有计算出的 $Q(i,j)$ 值的集合是 $\\{ -12, -10 \\}$。问题要求所有无序对中 $Q(i,j)$ 的最小值。\n通过比较两种情况下的值来找到最小值：\n$$\n\\min(Q(A,B), Q(A,C)) = \\min(-12, -10) = -12\n$$\nNJ 算法会选择对 $\\{A,B\\}$ 或 $\\{C,D\\}$ 中的一个首先进行连接，因为它们对应于最小的 $Q$ 值。最小值本身是 $-12$。",
            "answer": "$$\n\\boxed{-12}\n$$"
        },
        {
            "introduction": "虽然邻接法功能强大，但没有一种系统发育方法是万无一失的，理解其局限性与掌握其使用方法同等重要。这个高级练习探讨了一个经典的陷阱，即所谓的“长枝吸引”（Long-Branch Attraction, LBA），使用了一个来自“Felsenstein 区”的距离矩阵。通过将邻接法应用于这个具有挑战性的假设数据集，您将亲眼看到未经校正的距离如何误导算法，并学会批判性地评估系统发育重建的结果 。",
            "id": "2408887",
            "problem": "一个说明长枝吸引构型（称为Felsenstein区域）的四分类单元案例如下构建。真实的无根拓扑是划分 $(A,B)\\,|\\,(C,D)$，其中分类单元 $A$ 和 $C$ 具有长的外部支，分类单元 $B$ 和 $D$ 具有短的外部支，由一个短的内部支隔开。假设不使用模型校正的进化距离，而是使用根据足够长的独立同分布位点估计的未校正汉明距离（也称为 $p$-距离），得到关于分类单元 $\\{A,B,C,D\\}$ 的以下对称距离矩阵 $D = (d_{ij})$：\n$$\nD \\;=\\;\n\\begin{pmatrix}\n0   0.6669  0.7366  0.6692 \\\\\n0.6669  0  0.6692  0.2603 \\\\\n0.7366  0.6692  0  0.6669 \\\\\n0.6692  0.2603  0.6669  0\n\\end{pmatrix}.\n$$\n请逐步将邻接法（NJ）应用于矩阵 $D$，以确定NJ将推断出的无根拓扑，并解释为什么该拓扑相对于真实划分 $(A,B)\\,|\\,(C,D)$ 是不正确的。作为您报告的数值结果，请计算第一次NJ迭代中NJ $Q$-矩阵的最负项。将您的答案四舍五入到四位有效数字。以不带单位的纯数字形式表示最终答案。",
            "solution": "该问题要求将邻接法（NJ）应用于给定的四个分类单元 $\\{A, B, C, D\\}$ 的距离矩阵。目标是确定推断出的拓扑，解释为什么它相对于给定的真实拓扑是不正确的，并计算第一次迭代中NJ $Q$-矩阵的最负值。\n\n邻接算法首先从距离矩阵 $D$ 构建一个 $Q$-矩阵。对于一个包含 $n$ 个分类单元的集合，$Q$-矩阵的项定义为：\n$$\nQ_{ij} = (n-2)d_{ij} - \\sum_{k=1}^{n} d_{ik} - \\sum_{k=1}^{n} d_{jk}\n$$\n其中 $d_{ij}$ 是分类单元 $i$ 和 $j$ 之间的距离。\n\n在这个问题中，我们有 $n=4$ 个分类单元。因此，系数 $(n-2)$ 等于 $2$。我们定义 $u_i = \\sum_{k=1}^{4} d_{ik}$，它表示从分类单元 $i$ 到所有其他分类单元的距离之和。$Q_{ij}$ 的公式变为：\n$$\nQ_{ij} = 2d_{ij} - u_i - u_j\n$$\n\n首先，我们为每个分类单元 $i \\in \\{A, B, C, D\\}$ 计算 $u_i$ 的值。\n$$\nu_A = d_{AB} + d_{AC} + d_{AD} = 0.6669 + 0.7366 + 0.6692 = 2.0727\n$$\n$$\nu_B = d_{BA} + d_{BC} + d_{BD} = 0.6669 + 0.6692 + 0.2603 = 1.5964\n$$\n$$\nu_C = d_{CA} + d_{CB} + d_{CD} = 0.7366 + 0.6692 + 0.6669 = 2.0727\n$$\n$$\nu_D = d_{DA} + d_{DB} + d_{DC} = 0.6692 + 0.2603 + 0.6669 = 1.5964\n$$\n\n接下来，我们计算 $Q$-矩阵中所有不同分类单元对的非对角项。\n$$\nQ_{AB} = 2d_{AB} - u_A - u_B = 2(0.6669) - 2.0727 - 1.5964 = 1.3338 - 3.6691 = -2.3353\n$$\n$$\nQ_{AC} = 2d_{AC} - u_A - u_C = 2(0.7366) - 2.0727 - 2.0727 = 1.4732 - 4.1454 = -2.6722\n$$\n$$\nQ_{AD} = 2d_{AD} - u_A - u_D = 2(0.6692) - 2.0727 - 1.5964 = 1.3384 - 3.6691 = -2.3307\n$$\n$$\nQ_{BC} = 2d_{BC} - u_B - u_C = 2(0.6692) - 1.5964 - 2.0727 = 1.3384 - 3.6691 = -2.3307\n$$\n$$\nQ_{BD} = 2d_{BD} - u_B - u_D = 2(0.2603) - 1.5964 - 1.5964 = 0.5206 - 3.1928 = -2.6722\n$$\n$$\nQ_{CD} = 2d_{CD} - u_C - u_D = 2(0.6669) - 2.0727 - 1.5964 = 1.3338 - 3.6691 = -2.3353\n$$\n\n完整的 $Q$-矩阵（对角项未定义）是：\n$$\nQ =\n\\begin{pmatrix}\n-   -2.3353  -2.6722  -2.3307 \\\\\n-2.3353  -  -2.3307  -2.6722 \\\\\n-2.6722  -2.3307  -  -2.3353 \\\\\n-2.3307  -2.6722  -2.3353  -\n\\end{pmatrix}\n$$\n\n此 $Q$-矩阵中最负的项是 $-2.6722$。这个值出现在两对中：$(A,C)$ 和 $(B,D)$。将此值四舍五入到四位有效数字得到 $-2.672$。这就是所要求的数值结果。\n\n为了确定推断出的拓扑，我们继续运行NJ算法。该算法识别出使 $Q_{ij}$ 最小的分类单元对 $(i,j)$。在这种情况下，$(A,C)$ 和 $(B,D)$ 的值相同，出现了平局。NJ算法可以选择任意一对继续进行。我们选择连接分类单元 $A$ 和 $C$。一个新节点（称之为 $U$）被创建，并计算从 $U$ 到 $A$ 和 $C$ 的支长。然后为剩余的分类单元 $\\{B, D, U\\}$ 计算一个新的距离矩阵。由于只剩下三个分类单元，算法通过将它们连接到一个中心节点而终止。最终的无根树结构将演化支 $(A,C)$ 作为 $B$ 和 $D$ 的姐妹群连接起来。这对应于由划分 $(A,C)\\,|\\,(B,D)$ 定义的无根拓扑。如果我们当初选择先连接 $(B,D)$ 对，结果将是相同的，产生同样的拓扑。\n\n问题陈述，真实的拓扑是划分 $(A,B)\\,|\\,(C,D)$。然而，NJ算法推断出的拓扑是 $(A,C)\\,|\\,(B,D)$。因此，NJ算法返回了一个不正确的结果。\n\n这种失败的原因是系统发育重建中一个众所周知的伪迹，称为长枝吸引（LBA）。该问题被设置在所谓的Felsenstein区域内，该区域旨在诱导LBA。真实的树具有通向分类单元 $A$ 和 $C$ 的长外部支。在这些长枝上，发生了大量的替换。使用未校正的汉明（$p$-）距离未能考虑到在同一位点发生的多次替换（饱和）。这导致对远缘相关分类单元之间的进化距离的系统性低估。因此，测量的距离 $d_{AC}$ 比真实的进化路径长度要短。\n\n此外，由于两条长枝上发生了大量的独立替换，分类单元 $A$ 和 $C$ 有很大的概率会巧合地获得相同的性状状态（同塑性）。这使得它们之间看起来比它们各自真实的、亲缘关系更近的姐妹分类单元（分别为 $B$ 和 $D$）更相似，而后者位于短枝上，经历的变化较少。\n\nNJ算法作为一种基于距离的方法，对输入距离矩阵中的不准确性很敏感。未校正距离的非加性性质，因饱和和同塑性而失真，误导了该算法。$Q$-矩阵最小化准则错误地将长枝对 $(A,C)$ 识别为相邻，因为它们被低估的距离使它们看起来人为地接近。这导致算法将长枝“吸引”到一起，从而得到不正确的拓扑 $(A,C)\\,|\\,(B,D)$，而不是真实的拓扑 $(A,B)\\,|\\,(C,D)$。这展示了一个经典案例，说明如果不使用合适的进化模型来校正多次击中（multiple hits），基于距离的方法可能会失败。",
            "answer": "$$\n\\boxed{-2.672}\n$$"
        }
    ]
}