{
    "hands_on_practices": [
        {
            "introduction": "The best way to understand an algorithm is to perform the calculations by hand. This first practice exercise  guides you through the fundamental mechanics of building a Romberg tableau. By computing the initial trapezoidal approximations and applying the first level of Richardson extrapolation, you will gain a concrete understanding of how more accurate estimates are generated from less accurate ones.",
            "id": "2198730",
            "problem": "Romberg integration is a numerical method used to estimate the definite integral of a function by applying Richardson extrapolation to the results from the trapezoidal rule. The estimates are organized in a triangular array called the Romberg tableau, denoted by $R_{k,j}$. The first column, $R_{k,1}$ (for $k \\geq 1$), is generated using the composite trapezoidal rule with $n = 2^{k-1}$ subintervals. Subsequent entries are computed using the recursive formula:\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\nConsider the definite integral of a polynomial function $f(x) = 4x^3 - 3x^2 + 5$ over the interval $[0, 2]$. Your task is to manually compute the first three entries of the Romberg tableau for this integral.\n\nCalculate the values of $R_{1,1}$, $R_{2,1}$, and $R_{2,2}$. Provide your answer as a row vector of the three numerical values $(R_{1,1}, R_{2,1}, R_{2,2})$ expressed as exact integers.",
            "solution": "We integrate $f(x)=4x^3-3x^2+5$ over $[a,b]=[0,2]$. The composite trapezoidal rule with $n$ subintervals of width $h=\\frac{b-a}{n}$ is\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\nBy definition, $R_{k,1}=T_{2^{k-1}}$.\n\nFor $R_{1,1}$, take $n=1$ so $h=2$. Evaluate $f(0)=5$ and $f(2)=4 \\cdot 2^3-3 \\cdot 2^2+5=32-12+5=25$. Then\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}(f(0)+f(2))=1 \\cdot (5+25)=30.\n$$\n\nFor $R_{2,1}$, take $n=2$ so $h=1$ with nodes $0,1,2$. Compute $f(1)=4-3+5=6$. Then\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}(f(0)+2f(1)+f(2))=\\frac{1}{2}(5+2 \\cdot 6+25)=\\frac{42}{2}=21.\n$$\n\nRomberg extrapolation uses\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{j-1}-1}(R_{k,j-1}-R_{k-1,j-1}), \\quad k \\ge j \\ge 2.\n$$\nThus,\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^1-1}(R_{2,1}-R_{1,1})=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\nAs a consistency check, the exact integral is\n$$\n\\int_{0}^{2}(4x^3-3x^2+5)\\,dx=[x^4-x^3+5x]\\bigg|_0^2=16-8+10=18,\n$$\nagreeing with $R_{2,2}$ as expected for a cubic.",
            "answer": "$$\\boxed{\\begin{pmatrix}30 & 21 & 18\\end{pmatrix}}$$"
        },
        {
            "introduction": "After learning the mechanics, it's natural to ask: why use Romberg integration? This exercise  is designed to demonstrate the remarkable efficiency of the method. By comparing the number of function evaluations required by Romberg integration to that of the basic composite trapezoidal rule for a similar level of accuracy, you will see the significant computational savings that recursive extrapolation provides.",
            "id": "2198711",
            "problem": "A signal processing algorithm for analyzing Gaussian pulses requires the precise evaluation of the integral $I = \\int_0^1 \\exp(-x^2) dx$. The exact value of this integral is known to be approximately $I_{true} = 0.746824133$.\n\nTwo numerical methods are being considered for this task: Romberg integration and the composite trapezoidal rule.\n\nFirst, using Romberg integration, compute the approximation denoted as $R_{3,3}$.\n    \nNext, calculate the absolute error of this $R_{3,3}$ approximation with respect to $I_{true}$. Then, determine the minimum number of subintervals, let's call it $n_{trap}$, that the composite trapezoidal rule would need to guarantee an absolute error that is less than or equal to the error you found for $R_{3,3}$.\n\nWhat is the total number of unique function evaluations of $\\exp(-x^2)$ required to compute $R_{3,3}$, and what is the number of function evaluations ($n_{trap}+1$) required by the composite trapezoidal rule?\n\nState your answer as two integers: the number of evaluations for the Romberg method followed by the number of evaluations for the composite trapezoidal rule.",
            "solution": "The problem asks for two values: the number of function evaluations needed to compute the Romberg integral approximation $R_{3,3}$ for $I = \\int_0^1 \\exp(-x^2) dx$, and the number of function evaluations needed for the composite trapezoidal rule to achieve a comparable accuracy.\n\nFirst, we address the Romberg integration part. The calculation of $R_{3,3}$ requires the construction of a 3x3 Romberg table. The first column of this table, $R_{1,1}, R_{2,1}, R_{3,1}$, consists of approximations from the composite trapezoidal rule with $n=2^{1-1}=1$, $n=2^{2-1}=2$, and $n=2^{3-1}=4$ subintervals, respectively. The highest number of subintervals used is $n=4$. The composite trapezoidal rule with $n=4$ on the interval $[0,1]$ requires evaluating the function $f(x) = \\exp(-x^2)$ at the points $x_i = 0 + i \\cdot \\frac{1-0}{4}$ for $i=0, 1, 2, 3, 4$. These points are $0, 0.25, 0.5, 0.75, 1$. This constitutes a total of 5 unique function evaluations. Since the evaluations for $n=1$ and $n=2$ are subsets of these points, the total number of function evaluations for finding $R_{3,3}$ is 5.\n\nNow, we compute the values in the Romberg table. Let $f(x) = \\exp(-x^2)$.\nThe required function values are:\n$f(0) = \\exp(0) = 1$\n$f(0.25) = \\exp(-0.0625) \\approx 0.939413115$\n$f(0.5) = \\exp(-0.25) \\approx 0.778800783$\n$f(0.75) = \\exp(-0.5625) \\approx 0.569782825$\n$f(1) = \\exp(-1) \\approx 0.367879441$\n\nThe first column of the Romberg table ($R_{i,1}$) is calculated using the composite trapezoidal rule:\n$R_{1,1}$ (n=1, h=1): $\\frac{1}{2}(f(0) + f(1)) = \\frac{1}{2}(1 + 0.367879441) = 0.683939721$\n$R_{2,1}$ (n=2, h=0.5): $\\frac{0.5}{2}(f(0) + 2f(0.5) + f(1)) = 0.25(1 + 2(0.778800783) + 0.367879441) = 0.731370252$\n$R_{3,1}$ (n=4, h=0.25): $\\frac{0.25}{2}(f(0) + 2(f(0.25)+f(0.5)+f(0.75)) + f(1)) = 0.125(1 + 2(0.939413115+0.778800783+0.569782825) + 0.367879441) = 0.742984111$\n\nNext, we use Richardson's extrapolation formula, $R_{i,j} = R_{i, j-1} + \\frac{R_{i, j-1} - R_{i-1, j-1}}{4^{j-1}-1}$, to find the other entries.\nFor $j=2$:\n$R_{2,2} = R_{2,1} + \\frac{R_{2,1} - R_{1,1}}{4^{1}-1} = 0.731370252 + \\frac{0.731370252 - 0.683939721}{3} = 0.747180432$\n$R_{3,2} = R_{3,1} + \\frac{R_{3,1} - R_{2,1}}{4^{1}-1} = 0.742984111 + \\frac{0.742984111 - 0.731370252}{3} = 0.746855397$\n\nFor $j=3$:\n$R_{3,3} = R_{3,2} + \\frac{R_{3,2} - R_{2,2}}{4^{2}-1} = 0.746855397 + \\frac{0.746855397 - 0.747180432}{15} = 0.746833765$\n\nThe absolute error of the $R_{3,3}$ approximation is:\n$\\epsilon_{R_{3,3}} = |R_{3,3} - I_{true}| = |0.746833765 - 0.746824133| = 9.632 \\times 10^{-6}$.\n\nNext, we find the number of subintervals $n_{trap}$ needed for the composite trapezoidal rule to have an error no greater than $\\epsilon_{R_{3,3}}$. The error bound for the composite trapezoidal rule is $|E_T| \\le \\frac{(b-a)^3}{12n^2} \\max_{x \\in [a,b]} |f''(x)|$.\nHere, $a=0$, $b=1$, and $f(x) = \\exp(-x^2)$.\nWe need to find the second derivative, $f''(x)$:\n$f'(x) = -2x \\exp(-x^2)$\n$f''(x) = -2 \\exp(-x^2) + (-2x)(-2x \\exp(-x^2)) = (4x^2 - 2) \\exp(-x^2)$\n\nWe need to find the maximum value of $|f''(x)|$ on the interval $[0,1]$. Let's analyze $g(x) = f''(x)$. We check the critical points and endpoints.\nTo find critical points, we take the derivative of $f''(x)$:\n$f'''(x) = 8x \\exp(-x^2) + (4x^2 - 2)(-2x \\exp(-x^2)) = (8x - 8x^3 + 4x)\\exp(-x^2) = (12x - 8x^3)\\exp(-x^2)$.\nSetting $f'''(x)=0$ gives $x=0$ or $12 - 8x^2 = 0 \\implies x^2 = 3/2 \\implies x = \\sqrt{3/2} \\approx 1.225$, which is outside $[0,1]$.\nSo we only need to check the values of $|f''(x)|$ at the endpoints $x=0$ and $x=1$:\n$|f''(0)| = |(4(0)^2 - 2)\\exp(0)| = |-2| = 2$.\n$|f''(1)| = |(4(1)^2 - 2)\\exp(-1)| = |2e^{-1}| \\approx 0.7357$.\nThe maximum value of $|f''(x)|$ on $[0,1]$ is 2.\n\nNow we can set up the inequality for the error:\n$\\frac{(1-0)^3}{12n_{trap}^2} \\times 2 \\le \\epsilon_{R_{3,3}}$\n$\\frac{1}{6n_{trap}^2} \\le 9.632 \\times 10^{-6}$\n$n_{trap}^2 \\ge \\frac{1}{6 \\times 9.632 \\times 10^{-6}} \\approx 17303.4$\n$n_{trap} \\ge \\sqrt{17303.4} \\approx 131.54$\nSince $n_{trap}$ must be an integer, the minimum number of subintervals required is $n_{trap}=132$.\n\nThe number of function evaluations for the composite trapezoidal rule with $n_{trap}$ subintervals is $n_{trap}+1$.\nSo, the number of evaluations is $132 + 1 = 133$.\n\nIn conclusion, the number of function evaluations for the Romberg method ($R_{3,3}$) is 5, and the number of evaluations for the composite trapezoidal rule to achieve a similar error guarantee is 133.\nThe two integers for the answer are 5 and 133.",
            "answer": "$$\\boxed{\\begin{pmatrix} 5 & 133 \\end{pmatrix}}$$"
        },
        {
            "introduction": "In real-world applications, we often don't have an exact answer to compare against. So, how do we know when our numerical approximation is good enough? This final practice  introduces the practical concept of a stopping criterion, where the process is terminated once the approximations converge to a desired tolerance. You will construct a Romberg table until the diagonal entries stabilize, mimicking how the algorithm is implemented in software to achieve a target precision without unnecessary computation.",
            "id": "2198735",
            "problem": "Romberg integration is a numerical method that improves the accuracy of integral approximations by applying Richardson extrapolation to the results from the composite trapezoidal rule. The method generates a triangular table of approximations, denoted by $R_{k,j}$, where $k$ is the row index (increasing the number of subintervals) and $j$ is the column index (increasing the order of extrapolation).\n\nThe entries are generated as follows:\nThe first column, $R_{k,1}$, consists of approximations from the composite trapezoidal rule with $n = 2^{k-1}$ subintervals.\nSubsequent entries are computed using the recursive formula:\n$$R_{k,j} = R_{k,j-1} + \\frac{R_{k,j-1} - R_{k-1,j-1}}{4^{j-1}-1} \\quad \\text{for } k \\ge 2 \\text{ and } j \\ge 2$$\nThe diagonal entries, $R_{k,k}$, typically provide the most accurate approximations for a given number of function evaluations. A common strategy to terminate the algorithm is to monitor the convergence of these diagonal entries.\n\nConsider the task of approximating the definite integral $I = \\int_{0}^{1} \\exp(x^2) dx$. The first four approximations from the composite trapezoidal rule ($R_{k,1}$) have been pre-computed for you:\n- $R_{1,1} = 1.859141$\n- $R_{2,1} = 1.571583$\n- $R_{3,1} = 1.490679$\n- $R_{4,1} = 1.469730$\n\nYour task is to construct the Romberg table and find the most accurate approximation for the integral based on a specific stopping criterion. The process should be terminated as soon as the absolute difference between two successive diagonal approximants, $|R_{k,k} - R_{k-1,k-1}|$, is less than a tolerance of $\\epsilon = 3 \\times 10^{-4}$.\n\nDetermine the value of the final approximation $R_{k,k}$ that first satisfies this condition. Round your final answer to six significant figures.",
            "solution": "We are given the Romberg recursion\n$$\nR_{k,j} = R_{k,j-1} + \\frac{R_{k,j-1} - R_{k-1,j-1}}{4^{j-1}-1}, \\quad k \\ge 2, j \\ge 2,\n$$\nwith first-column entries from the composite trapezoidal rule:\n$R_{1,1}=1.859141$, $R_{2,1}=1.571583$, $R_{3,1}=1.490679$, $R_{4,1}=1.469730$.\nWe construct the Romberg table column by column and monitor the diagonal entries $R_{k,k}$ until the stopping criterion $|R_{k,k}-R_{k-1,k-1}|  \\epsilon$ with $\\epsilon=3 \\times 10^{-4}$ is first satisfied.\n\nCompute second column ($j=2$, denominator $4^1-1=3$):\n$$\nR_{2,2}=R_{2,1}+\\frac{R_{2,1}-R_{1,1}}{3}\n=1.571583+\\frac{1.571583-1.859141}{3}\n=1.4757303333333333,\n$$\n$$\nR_{3,2}=R_{3,1}+\\frac{R_{3,1}-R_{2,1}}{3}\n=1.490679+\\frac{1.490679-1.571583}{3}\n=1.463711,\n$$\n$$\nR_{4,2}=R_{4,1}+\\frac{R_{4,1}-R_{3,1}}{3}\n=1.469730+\\frac{1.469730-1.490679}{3}\n=1.462747.\n$$\n\nCompute third column ($j=3$, denominator $4^2-1=15$):\n$$\nR_{3,3}=R_{3,2}+\\frac{R_{3,2}-R_{2,2}}{15}\n=1.463711+\\frac{1.463711-1.4757303333333333}{15}\n=1.4629097111111111,\n$$\n$$\nR_{4,3}=R_{4,2}+\\frac{R_{4,2}-R_{3,2}}{15}\n=1.462747+\\frac{1.462747-1.463711}{15}\n=1.4626827333333334.\n$$\n\nCompute fourth column ($j=4$, denominator $4^3-1=63$):\n$$\nR_{4,4}=R_{4,3}+\\frac{R_{4,3}-R_{3,3}}{63}\n=1.4626827333333334+\\frac{1.4626827333333334-1.4629097111111111}{63}\n\\approx 1.4626791305114639.\n$$\n\nNow check the diagonal convergence:\n$|R_{2,2}-R_{1,1}|=|1.4757303333333333-1.859141|=0.3834106666666667 > \\epsilon$,\n$$\n|R_{3,3}-R_{2,2}|=|1.4629097111111111-1.4757303333333333|=0.0128206222222222 > \\epsilon,\n$$\n$|R_{4,4}-R_{3,3}|=|1.4626791305114639-1.4629097111111111| \\approx 2.30580599647 \\times 10^{-4}  3 \\times 10^{-4}$.\nThus the first diagonal entry to satisfy the stopping criterion is $R_{4,4}$. Rounding $R_{4,4}$ to six significant figures gives $1.46268$.",
            "answer": "$$\\boxed{1.46268}$$"
        }
    ]
}