## 引言
线性平流方程是科学与工程领域中描述输运现象的最基本模型之一，它刻画了物理量（如温度、密度或污染物浓度）如何随流体或场整体移动。然而，对这个看似简单的方程进行数值求解却充满挑战。许多直观的[离散化方法](@entry_id:272547)，例如[中心差分](@entry_id:173198)，会产生不稳定的、充满非物理[振荡](@entry_id:267781)的解，这暴露了数值方法设计中的一个核心难题：如何构建既稳定又准确的算法来捕捉定向的信息传播。

本文旨在系统性地解决这一问题，深入剖析一种强大而基础的数值技术——迎风格式。我们将揭示[迎风格式](@entry_id:756374)成功的秘诀在于其设计深刻地遵循了[平流方程](@entry_id:144869)的物理本质。通过阅读本文，您将不仅掌握一种数值方法，更将学会一种根据物理原理来设计和分析算法的思维方式。文章将分为三个核心部分：在“原理与机制”中，我们将从第一性原理出发，推导[迎风格式](@entry_id:756374)，并严谨分析其稳定性、精度和守恒性等关键数值性质。接着，在“应用与跨学科联系”中，我们将跨越从天体物理到[计算金融](@entry_id:145856)的广阔领域，展示[迎风格式](@entry_id:756374)在解决真实世界问题中的强大威力与广泛适用性。最后，通过“动手实践”部分，您将有机会亲手实现并测试迎风格式，将理论知识转化为解决实际问题的计算技能。

## 原理与机制

本章深入探讨迎风格式的数学原理及其在求解线性平流问题中的内在机制。我们将从一维问题入手，建立[有限差分](@entry_id:167874)和有限体积两种形式的[迎风格式](@entry_id:756374)，然后[系统分析](@entry_id:263805)其数值性质，包括稳定性、[数值耗散](@entry_id:168584)、数值频散和守恒性。随后，我们会将这些概念推广到多维问题、[非均匀网格](@entry_id:752607)乃至非结构网格，并讨论一些更高级的主题，如[源项处理](@entry_id:755077)和时变系数。

### 一维线性平流方程的离散化

#### [有限差分法](@entry_id:147158)：[迎风格式](@entry_id:756374)

考虑最简单的一维[常系数](@entry_id:269842)线性[平流方程](@entry_id:144869)：
$$
\frac{\partial u}{\partial t} + a \frac{\partial u}{\partial x} = 0
$$
其中 $u(x, t)$ 是一个[标量场](@entry_id:151443)，$a$ 是一个常数平流速度。该方程描述了物理量 $u$ 以速度 $a$ 沿着 $x$ 轴平移而不改变其形状。

为了数值求解该方程，我们首先对时间和空间进行离散化。我们采用均匀网格，$x_j = j \Delta x$ 和 $t^n = n \Delta t$。$u_j^n$ 表示对真解 $u(x_j, t^n)$ 的[数值近似](@entry_id:161970)。

时间导数 $\partial u / \partial t$ 可以用[一阶精度](@entry_id:749410)的向前欧拉差分来近似：
$$
\frac{\partial u}{\partial t} \approx \frac{u_j^{n+1} - u_j^n}{\Delta t}
$$
对于空间导数 $\partial u / \partial x$，其离散方式的选择至关重要。一个朴素的想法是使用中心差分，但这会导致无条件不稳定的格式。稳定的显式格式必须遵循所谓的**[迎风原理](@entry_id:756377)（upwind principle）**。该原理指出，空间导数的离散必须从信息传播的上游（即“迎风”方向）获取信息。信息传播的方向由[平流](@entry_id:270026)速度 $a$ 的符号决定。

*   **当 $a > 0$ 时**，信息从左向右传播。因此，在点 $x_j$ 处，我们需要使用其上游点 $x_{j-1}$ 的信息来构造差分。这导出了**一阶[向后差分](@entry_id:637618)**（backward difference）：
    $$
    \frac{\partial u}{\partial x} \approx \frac{u_j^n - u_{j-1}^n}{\Delta x}
    $$
    将此代入原方程，我们得到适用于 $a>0$ 的**前向时间，后向空间（Forward-Time, Backward-Space, FTBS）**格式：
    $$
    u_j^{n+1} = u_j^n - \frac{a \Delta t}{\Delta x} (u_j^n - u_{j-1}^n)
    $$

*   **当 $a  0$ 时**，信息从右向左传播。此时，$x_j$ 的上游点是 $x_{j+1}$。因此，我们使用**[一阶向前差分](@entry_id:173870)**（forward difference）：
    $$
    \frac{\partial u}{\partial x} \approx \frac{u_{j+1}^n - u_j^n}{\Delta x}
    $$
    这导出了适用于 $a0$ 的**前向时间，前向空间（Forward-Time, Forward-Space, FTFS）**格式：
    $$
    u_j^{n+1} = u_j^n - \frac{a \Delta t}{\Delta x} (u_{j+1}^n - u_j^n)
    $$

这两种格式统称为**[一阶迎风格式](@entry_id:749417)**。它们的核心思想是让数值格式的依赖关系与[偏微分方程](@entry_id:141332)的物理特性（特征线方向）相匹配。一个经典的测试是模拟一个不连续的[初始条件](@entry_id:152863)，如赫维赛德阶跃函数（Heaviside step function）的传播。使用[迎风格式](@entry_id:756374)，尽管不连续处会被“抹平”（一种称为[数值耗散](@entry_id:168584)的现象），但解的整体是稳定的，不会产生非物理的[振荡](@entry_id:267781) 。

#### 守恒型[有限体积法](@entry_id:749372)

虽然有限差分法很直观，但对于更复杂的问题，特别是那些涉及[守恒定律](@entry_id:269268)的问题，**[有限体积法](@entry_id:749372)（Finite Volume Method, FVM）**提供了一个更强大和更严谨的框架。

我们从[守恒形式](@entry_id:747710)的平流方程出发。对于一个被动的[标量密度](@entry_id:161438) $\rho$，其[守恒定律](@entry_id:269268)（[连续性方程](@entry_id:195013)）为：
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \boldsymbol{v}) = 0
$$
在一维情况下，若速度 $v$ 为常数 $a$，方程变为 $\frac{\partial \rho}{\partial t} + \frac{\partial (a\rho)}{\partial x} = 0$。这里的 $f(\rho) = a\rho$ 被称为**物理通量**。

有限体积法的核心思想是在一系列不重叠的[控制体积](@entry_id:143882)（或称为单元）$C_i = [x_{i-1/2}, x_{i+1/2}]$ 上对守恒律进行积分，而不是在单个点上进行离散。对单元 $C_i$ 积分得到：
$$
\int_{x_{i-1/2}}^{x_{i+1/2}} \frac{\partial \rho}{\partial t} dx + \int_{x_{i-1/2}}^{x_{i+1/2}} \frac{\partial f(\rho)}{\partial x} dx = 0
$$
定义单元平均值 $\rho_i(t) = \frac{1}{\Delta x_i} \int_{x_{i-1/2}}^{x_{i+1/2}} \rho(x,t) dx$，其中 $\Delta x_i$ 是单元宽度。应用[牛顿-莱布尼茨公式](@entry_id:147280)，上式变为关于单元平均值的精确[演化方程](@entry_id:268137)：
$$
\frac{d\rho_i}{dt} = -\frac{1}{\Delta x_i} \left( f(x_{i+1/2}, t) - f(x_{i-1/2}, t) \right)
$$
其中 $f(x_{i\pm1/2}, t)$ 是在单元边界（或称为“面”）处的瞬时通量。

为了得到一个可计算的格式，我们需要用已知的单元平均值来近似这些界面通量。我们将界面 $x_{i+1/2}$ 处的**数值通量**记为 $F_{i+1/2}$。用向前[欧拉法](@entry_id:749108)离散时间，我们得到守恒型更新格式  ：
$$
\rho_i^{n+1} = \rho_i^n - \frac{\Delta t}{\Delta x_i} (F_{i+1/2}^n - F_{i-1/2}^n)
$$
这种形式是**显式守恒**的，因为离开一个单元的通量就是进入相邻单元的通量，确保了全域内总质量的离散守恒。

#### [迎风](@entry_id:756372)数值通量

现在的问题是如何定义数值通量 $F_{i+1/2}$。**[迎风通量](@entry_id:143931)**正是基于[迎风原理](@entry_id:756377)来定义的。在界面 $x_{i+1/2}$，通量的值由其上游单元的状态决定：
*   如果 $a  0$，风从左侧（单元 $i$）吹来，因此界面通量由 $\rho_i^n$ 决定：$F_{i+1/2}^n = f(\rho_i^n) = a \rho_i^n$。
*   如果 $a  0$，风从右侧（单元 $i+1$）吹来，因此界面通量由 $\rho_{i+1}^n$ 决定：$F_{i+1/2}^n = f(\rho_{i+1}^n) = a \rho_{i+1}^n$。

我们可以将这两种情况统一成一个表达式。一种方式是使用速度的正部和负部 $a^+ = \max(a,0)$ 和 $a^- = \min(a,0)$，得到：
$$
F_{i+1/2}^n = a^+ \rho_i^n + a^- \rho_{i+1}^n
$$
通过简单的代数操作，这个表达式可以被重写为一个更具启发性的形式 ：
$$
F_{i+1/2}^n = \frac{1}{2} a (\rho_i^n + \rho_{i+1}^n) - \frac{1}{2} |a| (\rho_{i+1}^n - \rho_i^n)
$$
这个形式非常重要，它揭示了[迎风通量](@entry_id:143931)由两部分构成：
1.  **[中心通量](@entry_id:747204)项**：$\frac{1}{2} a (\rho_i^n + \rho_{i+1}^n)$ 是对左右两边状态物理通量的简单平均。单独使用这个项会得到[中心差分格式](@entry_id:747203)，而我们已知它是不稳定的。
2.  **数值耗散项（或称[人工黏性](@entry_id:756576)项）**：$-\frac{1}{2} |a| (\rho_{i+1}^n - \rho_i^n)$ 是一个与速度大小 $|a|$ 和相邻单元值的差 $(\rho_{i+1}^n - \rho_i^n)$ 成正比的项。这一项的关键作用是引入必要的耗散来抑制不稳定的[振荡](@entry_id:267781)，从而稳定整个格式。当 $\rho_i^n = \rho_{i+1}^n$ 时，此项为零，[数值通量](@entry_id:752791)退化为物理通量，这保证了格式的一致性。

### [迎风格式](@entry_id:756374)的数值性质

一个[数值格式](@entry_id:752822)是否可用，取决于它的几个关键性质：稳定性、精度和守恒性。

#### 稳定性与CFL条件

[迎风格式](@entry_id:756374)是一种显式格式，它的稳定性是**有条件的**。这个条件被称为**[Courant-Friedrichs-Lewy (CFL) 条件](@entry_id:747986)**。对于一维迎风格式，该条件要求无量纲的**[Courant数](@entry_id:143767)**（或CFL数） $\nu$ 不超过1。[Courant数](@entry_id:143767)定义为：
$$
\nu = \frac{|a| \Delta t}{\Delta x}
$$
因此，稳定性条件为：
$$
\nu = \frac{|a| \Delta t}{\Delta x} \le 1
$$
这个条件有一个直观的物理解释：在一个时间步 $\Delta t$ 内，信息传播的物理距离 $|a|\Delta t$ 不能超过一个空间网格的宽度 $\Delta x$。换句话说，数值格式的“信息传播速度” $(\Delta x / \Delta t)$ 必须大于或等于[物理信息](@entry_id:152556)的[传播速度](@entry_id:189384) $|a|$，以确保数值计算能够“捕捉”到所有物理上发生的变化。

我们可以通过**[冯·诺依曼稳定性分析](@entry_id:145718)（von Neumann stability analysis）**来严格推导这个条件。分析结果表明，当 $0 \le \nu \le 1$ 时， Fourier 模式的[放大因子](@entry_id:144315)模长小于等于1，格式是稳定的。

一个非常特殊的、具有重要理论意义的情况是当 $\nu = 1$ 时。此时，对于 $a0$ 的情况，更新格式变为：
$$
u_j^{n+1} = u_j^n - 1 \cdot (u_j^n - u_{j-1}^n) = u_{j-1}^n
$$
这意味着在一个时间步内，每个网格点的值被精确地传递给了它右边的邻居。这恰好与物理 reality 相符：在时间 $\Delta t = \Delta x / a$ 内，波形精确地向右平移了一个网格间距 $\Delta x$。因此，当 $\nu=1$ 时，迎风格式在网格点上是**精确的**，它没有任何[数值误差](@entry_id:635587)  。此时，格式的[截断误差](@entry_id:140949)为零，并且没有[数值耗散](@entry_id:168584)和数值频散。

#### [数值耗散](@entry_id:168584)与数值频散

当 CFL 数 $\nu  1$ 时，[迎风格式](@entry_id:756374)会引入误差。这些误差主要表现为两种形式：[数值耗散](@entry_id:168584)和数值频散。

**[数值耗散](@entry_id:168584) (Numerical Diffusion)**

数值耗散表现为解的尖锐特征（如阶跃或尖峰）随着时间的推移被抹平或“[模糊化](@entry_id:260771)”。这是迎风格式最显著的特点。这种效应可以通过**修正方程分析（modified equation analysis）**来量化。通过对离散格式进行[泰勒展开](@entry_id:145057)，我们可以发现迎风格式实际上更好地近似于一个带有[人工黏性](@entry_id:756576)项的[平流-扩散方程](@entry_id:746317)，而不是原始的纯[平流方程](@entry_id:144869) ：
$$
\frac{\partial u}{\partial t} + a \frac{\partial u}{\partial x} = \epsilon_{\text{num}} \frac{\partial^2 u}{\partial x^2} + \text{H.O.T.}
$$
其中 H.O.T. 代表更高阶的导数项。$\epsilon_{\text{num}}$ 被称为**[数值黏性](@entry_id:141318)系数**或**数值扩散系数**，对于[一阶迎风格式](@entry_id:749417)，其表达式为：
$$
\epsilon_{\text{num}} = \frac{|a| \Delta x}{2} (1 - \nu)
$$
这个表达式揭示了：
*   [数值耗散](@entry_id:168584)正比于网格尺寸 $\Delta x$，这意味着网格越粗，耗散越严重。
*   [数值耗散](@entry_id:168584)与 $(1-\nu)$ 成正比。当 $\nu \to 1$ 时，$\epsilon_{\text{num}} \to 0$，数值耗散消失，这与我们观察到的 $\nu=1$ 时格式精确的结论一致。当 $\nu \to 0$ 时（例如，时间步长非常小），数值耗散达到最大。

将[迎风格式](@entry_id:756374)与其他一阶格式（如[Lax-Friedrichs格式](@entry_id:635215)）进行比较，可以发现它们具有不同程度的[数值耗散](@entry_id:168584)。通常，[迎风格式](@entry_id:756374)的耗散性比[Lax-Friedrichs格式](@entry_id:635215)要小，使其在许多应用中更受欢迎 。

**数值频散 (Numerical Dispersion)**

数值频散是指不同波长的数值波以不同的速度传播的现象。在物理上，纯线性平流方程是非频散的，所有波都以相同的速度 $a$ 传播。然而，在数值格式中，[波的传播](@entry_id:144063)速度可能依赖于其波长（或[波数](@entry_id:172452)）。

我们可以通过分析[数值格式](@entry_id:752822)的**群速度** $v_g(k)$ 来研究频散。对于[一阶迎风格式](@entry_id:749417)，可以推导出数值群速度与物理速度 $a$ 的比值是关于无量纲[波数](@entry_id:172452) $\theta = k \Delta x$ 和CFL数 $\nu$ 的复杂函数 。由于 $v_g$ 依赖于 $\theta$，不同波长的分量会以不同的速度传播，导致波包变形。例如，一个初始的方波可能会在传播过程中出现一系列的[振荡](@entry_id:267781)（称为吉布斯现象的[数值模拟](@entry_id:137087)）。

同样地，当 $\nu=1$ 时，可以证明数值群速度 $v_g(k)$ 对于所有[波数](@entry_id:172452) $k$都精确等于物理速度 $a$ 。这意味着在 $\nu=1$ 的特殊情况下，[迎风格式](@entry_id:756374)也是**无频散**的。

#### 守恒性

守恒性是[数值格式](@entry_id:752822)的一个至关重要的属性，特别是对于模拟物理[守恒定律](@entry_id:269268)（如质量、动量、[能量守恒](@entry_id:140514)）而言。
*   **一阶矩守恒（[质量守恒](@entry_id:204015)）**：对于周期性边界条件，[一阶迎风格式](@entry_id:749417)（特别是其有限[体积形式](@entry_id:203000)）是**严格守恒**的。这意味着离散的总“质量” $M = \sum_j u_j^n \Delta x$ 在时间演化过程中保持不变（在不考虑[浮点舍入](@entry_id:749455)误差的情况下）。这一点可以通过对更新格式在所有单元上求和来[直接证明](@entry_id:141172)，由于通量的伸缩求和特性，内部通量会相互抵消 。
*   **[高阶矩](@entry_id:266936)不守恒**：尽管一阶矩守恒，但由于[数值耗散](@entry_id:168584)的存在，[高阶矩](@entry_id:266936)通常不守恒。例如，离散的“能量” $M_2 = \sum_j (u_j^n)^2 \Delta x$ 会随时间衰减。这种衰减正是数值耗散将解的“能量”从可分辨的尺度耗散掉的体现。因此，监测 $M_2$ 的衰减率可以作为衡量格式[数值耗散](@entry_id:168584)强度的一种方法 。

### 多维与[非均匀网格](@entry_id:752607)扩展

#### 二维笛卡尔网格上的迎风格式

将[迎风格式](@entry_id:756374)推广到二维或三维的笛卡尔网格是直接的。考虑二维[平流方程](@entry_id:144869)：
$$
\frac{\partial u}{\partial t} + v_x \frac{\partial u}{\partial x} + v_y \frac{\partial u}{\partial y} = 0
$$
最直接的[离散化方法](@entry_id:272547)是在每个维度上独立应用[迎风](@entry_id:756372)思想 。例如，对 $\partial u / \partial x$ 的离散化取决于 $v_x$ 的符号，而对 $\partial u / \partial y$ 的离散化取决于 $v_y$ 的符号。

其稳定性条件也相应地推广。通过二维的[冯·诺依曼分析](@entry_id:153661)，可以得到二维[CFL条件](@entry_id:178032) ：
$$
\frac{|v_x| \Delta t}{\Delta x} + \frac{|v_y| \Delta t}{\Delta y} \le 1
$$
这意味着时间步长 $\Delta t$ 受到两个方向上[Courant数](@entry_id:143767)的和的限制。

#### [算子分裂法](@entry_id:752962)

另一种处理多维问题的强大技术是**[算子分裂法](@entry_id:752962)（operator splitting）**。其思想是将多维演化[算子分解](@entry_id:154443)为一系列一维算子的相继作用。例如，要将解从 $t^n$ 推进到 $t^{n+1}$，我们可以先只考虑 $x$ 方向的平流，演化一个时间步 $\Delta t$，然后再对得到的结果进行 $y$ 方向的平流演化。

一种更精确的分裂方法是**[Strang分裂](@entry_id:755497)**，它具有二阶时间精度。对于二维平流，一个时间步的[更新过程](@entry_id:273573)如下 ：
1.  进行半个时间步的 $x$ 方向平流：$u^* = A_x(\Delta t / 2) u^n$
2.  对结果进行一个完整时间步的 $y$ 方向[平流](@entry_id:270026)：$u^{**} = A_y(\Delta t) u^*$
3.  再对结果进行半个时间步的 $x$ 方向[平流](@entry_id:270026)：$u^{n+1} = A_x(\Delta t / 2) u^{**}$

这种方法允许我们重用高效的一维求解器来构建多维求解器。

#### [非均匀网格](@entry_id:752607)上的应用

在实际应用中，网格往往不是均匀的。对于[非均匀网格](@entry_id:752607)，[CFL稳定性条件](@entry_id:747253)必须在**每个**单元上都得到满足。这意味着全局时间步长 $\Delta t$ 必须由最苛刻的单元决定，通常是最小的单元。例如，在一个一维[非均匀网格](@entry_id:752607)上，时间步长必须满足 ：
$$
\Delta t \le \min_i \left( \frac{\Delta x_i}{|a|} \right)
$$
一个有趣的例子是在对数间隔的网格上，单元尺寸随位置系统性地变化。稳定的时间步长将由最小的那个单元（通常在区域的一端）决定。

然而，在某些具有特定周期性结构的[非均匀网格](@entry_id:752607)上，这个“最小单元”规则可能只是一个充分条件而非必要条件。通过更精细的稳定性分析（例如使用[放大矩阵](@entry_id:746417)），可以发现在某些情况下，稳定性极限可能比基于最小单元的估计要宽松 。

#### 非结构网格上的有限体积法

有限体积法的巨大优势在于它可以自然地推广到**非结构网格**（例如，由三角形或任意多边形组成的网格）。这对于处理复杂几何形状至关重要。

在非结构网格上，守恒型更新公式保持不变，但通量的计算需要更仔细的几何处理 。对于任意一个[三角形单元](@entry_id:167871) $K_i$，其半离散[演化方程](@entry_id:268137)为：
$$
\frac{d\bar{\phi}_i}{dt} = -\frac{1}{A_i} \sum_{e \in \partial K_i} F_e
$$
其中 $A_i$ 是单元面积，求和遍及单元的所有边。每条边 $e$ 的通量 $F_e$ 被近似为 $\phi^*_e (\boldsymbol{u} \cdot \boldsymbol{n}_e)$，其中 $\boldsymbol{n}_e$ 是边的[法向量](@entry_id:264185)（长度等于边长），$\phi^*_e$ 是界面上的迎风值。

[迎风](@entry_id:756372)值的确定依赖于法向速度 $\boldsymbol{u} \cdot \boldsymbol{n}_e$ 的符号：
*   如果 $\boldsymbol{u} \cdot \boldsymbol{n}_e \ge 0$，表示流出单元 $K_i$，则迎风值为 $K_i$ 内的平均值 $\bar{\phi}_i$。
*   如果 $\boldsymbol{u} \cdot \boldsymbol{n}_e  0$，表示流入单元 $K_i$，则[迎风](@entry_id:756372)值为相邻单元的平均值 $\bar{\phi}_j$（对于内部边）或由边界条件给定（对于边界边）。

非结构网格的CFL条件形式上与均匀网格类似，但几何因子更复杂，时间步长由所有单元中“最快”的那个决定。

### 进阶主题

#### 包含源项的方程

许多物理问题包含源项或汇项，方程形式为 $\frac{\partial u}{\partial t} + a \frac{\partial u}{\partial x} = S(x,t)$。在显式一阶格式中处理源项的最简单方法是在时间步上对其进行积分。对于向前欧拉法，这意味着简单地在更新公式中加上一个[源项](@entry_id:269111)的贡献 ：
$$
u_j^{n+1} = u_j^n - \nu (u_j^n - u_{j-1}^n) + \Delta t \cdot S(x_j, t^n)
$$
这里的关键是，为了保持格式的[一阶精度](@entry_id:749410)和显式特性，[源项](@entry_id:269111) $S$ 必须在当前时间层 $t^n$ 进行评估。

#### 时变系数

当[平流](@entry_id:270026)速度随时间变化时，即 $a = a(t)$，[稳定性分析](@entry_id:144077)的基本思想保持不变，但必须在每个时间步上重新评估[CFL条件](@entry_id:178032)。为了确保整个模拟过程的稳定性，时间步长必须满足基于**瞬时速度**的CFL条件 ：
$$
\frac{|a(t^n)| \Delta t}{\Delta x} \le 1, \quad \text{for all } n
$$
这意味着全局时间步长必须由整个模拟过程中可能出现的最大速度来限制：
$$
\Delta t \le \frac{\Delta x}{\max_t |a(t)|}
$$

#### 半离散分析与[特征值](@entry_id:154894)

另一种分析[数值格式](@entry_id:752822)性质的有力工具是**半离散分析（semi-discrete analysis）**，也称为**方法之线（method of lines）**。我们将[空间离散化](@entry_id:172158)，但[保持时间](@entry_id:266567)为连续，得到一个常微分方程（ODE）组：
$$
\frac{d\boldsymbol{u}}{dt} = L \boldsymbol{u}
$$
其中 $\boldsymbol{u}$ 是所有网格点上值的向量，$L$ 是代表空间离散算子的矩阵。

算子 $L$ 的[特征值](@entry_id:154894) $\lambda$ 包含了关于格式性质的重要信息。对于一维周期域上的迎风格式，可以推导出 $L$ 的[特征值](@entry_id:154894)与无量纲波数 $\theta$ 的关系为 ：
$$
\lambda(\theta) = -\frac{a}{\Delta x} (1 - e^{-i\theta}) = -\frac{a}{\Delta x} (1 - \cos\theta + i\sin\theta)
$$
[特征值](@entry_id:154894)的实部 ($\text{Re}(\lambda)$) 与数值耗散有关（负实部导致衰减），而虚部 ($\text{Im}(\lambda)$) 与数值频散有关（虚部与物理频散关系 $-ia k$ 的偏离导致相速度误差）。

#### 极坐标下的应用

将[平流](@entry_id:270026)格式应用于[曲线坐标系](@entry_id:172561)（如极坐标或[球坐标](@entry_id:146054)）是许多物理应用（如天体物理盘或大气模型）的常见要求。考虑在极坐标 $(r, \theta)$ 下的[平流方程](@entry_id:144869)：
$$
\frac{\partial \phi}{\partial t} + v_r \frac{\partial \phi}{\partial r} + \frac{v_\theta}{r} \frac{\partial \phi}{\partial \theta} = 0
$$
一个重要的例子是刚体[旋转流](@entry_id:276737)，其中 $v_r=0$，$v_\theta = \Omega r$。方程简化为 $\frac{\partial \phi}{\partial t} + \Omega \frac{\partial \phi}{\partial \theta} = 0$。这实际上是每个半径 $r$ 上的一维[平流](@entry_id:270026)问题。我们可以直接在 $(\theta)$ 方向应用一维迎风格式来求解 。这个例子说明了，通过仔细分析物理问题和[坐标系](@entry_id:156346)，多维问题有时可以简化为更容易处理的低维问题。