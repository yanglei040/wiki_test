{
    "hands_on_practices": [
        {
            "introduction": "To begin, we explore one of the most fundamental applications of boundary conditions: determining the steady-state temperature in a one-dimensional system. This classic problem  provides a concrete physical context for understanding Dirichlet conditions, where the value of a field—in this case, temperature—is fixed at the boundaries. By solving this analytically, you will build foundational intuition for how boundary constraints shape the equilibrium solution of a system governed by a second-order partial differential equation.",
            "id": "946",
            "problem": "Consider a one-dimensional, uniform rod of length $L$. The temperature distribution within the rod, denoted by $u(x, t)$, where $x$ is the position along the rod ($0 \\le x \\le L$) and $t$ is time, is governed by the one-dimensional heat equation:\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\nHere, $\\alpha$ is the thermal diffusivity of the material, a positive constant.\n\nWe are interested in the steady-state temperature distribution, which is the temperature profile $u(x)$ after a sufficiently long time has passed, such that the temperature no longer changes with time. This implies that $\\frac{\\partial u}{\\partial t} = 0$.\n\nThe ends of the rod are maintained at fixed, constant temperatures. These are known as Dirichlet boundary conditions:\n1. At $x=0$, the temperature is $u(0) = T_0$.\n2. At $x=L$, the temperature is $u(L) = T_1$.\n\nStarting from the heat equation, derive the expression for the steady-state temperature distribution $u(x)$ along the rod as a function of position $x$, the length $L$, and the boundary temperatures $T_0$ and $T_1$.",
            "solution": "Starting from the steady-state condition ∂u/∂t=0 in the heat equation gives  \n$$0=\\alpha\\,\\frac{d^2u}{dx^2}\\,. $$  \nSince α≠0,  \n$$\\frac{d^2u}{dx^2}=0\\,. $$  \nIntegrate once:  \n$$\\frac{du}{dx}=A$$  \nand integrate again:  \n$$u(x)=A\\,x+B\\,, $$  \nwhere A and B are constants.  \nApply the Dirichlet conditions: at x=0, u(0)=B=T₀; at x=L, u(L)=AL+B=T₁. Solving for A:  \n$$A=\\frac{T_1-T_0}{L}\\,. $$  \nHence the steady-state solution is  \n$$u(x)=T_0+\\frac{T_1-T_0}{L}\\,x\\,. $$",
            "answer": "$$\\boxed{T_0 + \\frac{(T_1 - T_0)x}{L}}$$"
        },
        {
            "introduction": "Analytical solutions are often limited to simple geometries, making numerical methods essential for most real-world problems. This practice  transitions from theory to application, challenging you to implement a second-order accurate finite difference scheme for a Neumann (flux) boundary condition, specifically on a non-uniform grid. Mastering such numerical techniques is critical, as the accuracy of a simulation often depends heavily on the precise handling of boundary derivatives.",
            "id": "2386433",
            "problem": "Consider the one-dimensional steady Poisson equation, a linear second-order partial differential equation (PDE), on the domain $[0,1]$:\n$$\n\\frac{d^2 u}{dx^2} = f(x), \\quad x \\in (0,1),\n$$\nwith mixed boundary conditions: a Dirichlet condition at the left endpoint and a Neumann condition at the right endpoint. Let the exact solution be\n$$\nu_{\\text{exact}}(x) = \\sin(\\pi x) + x,\n$$\nso that\n$$\nf(x) = \\frac{d^2 u_{\\text{exact}}}{dx^2} = -\\pi^2 \\sin(\\pi x), \\quad u(0) = u_{\\text{exact}}(0), \\quad \\frac{du}{dx}(1) = \\frac{du_{\\text{exact}}}{dx}(1).\n$$\nAll quantities are non-dimensional; no physical units are required.\n\nYour task is to derive from first principles and implement a second-order accurate finite difference (FD) method on a nonuniform grid to solve this boundary value problem, with particular attention to the effect of grid point density near the right boundary on the accuracy of imposing the Neumann boundary condition. The derivation must start from Taylor expansions and basic definitions of derivatives, without introducing pre-assembled stencils from external sources.\n\nGrid generation: Use a family of monotone grids parameterized by a clustering parameter $\\gamma \\ge 0$ that controls the density of grid points near $x=1$. For a given integer $N \\ge 2$ (the total number of subintervals), define the reference grid points $\\xi_i = i/N$ for $i=0,1,\\dots,N$, and map them to physical points $x_i \\in [0,1]$ by\n$$\nx_i = \\begin{cases}\n\\xi_i, & \\text{if } \\gamma = 0, \\\\\n1 - \\dfrac{e^{\\gamma (1 - \\xi_i)} - 1}{e^{\\gamma} - 1}, & \\text{if } \\gamma > 0.\n\\end{cases}\n$$\nThis mapping increases the grid point density near $x=1$ as $\\gamma$ increases, while $\\gamma=0$ produces a uniform grid.\n\nDiscretization requirements:\n- For each interior node $x_i$ with $i=1,2,\\dots,N-1$, derive a second-order accurate approximation of $\\dfrac{d^2 u}{dx^2}(x_i)$ on the nonuniform grid using only $x_{i-1}$, $x_i$, $x_{i+1}$ and the corresponding unknowns $u_{i-1}$, $u_i$, $u_{i+1}$. Your derivation must start from Taylor series about $x_i$ for $u(x_{i-1})$ and $u(x_{i+1})$ in terms of $u$ and its derivatives at $x_i$, eliminating lower-order errors to achieve second-order accuracy.\n- At the right boundary $x_N = 1$, derive a second-order accurate one-sided approximation of $\\dfrac{du}{dx}(x_N)$ on the nonuniform grid using a quadratic polynomial interpolation through the last three nodes $x_{N-2}$, $x_{N-1}$, $x_N$. This yields a linear relation between $u_{N-2}$, $u_{N-1}$, $u_N$ and the boundary flux $\\dfrac{du}{dx}(1)$. Do not introduce any auxiliary ghost points; enforce the Neumann boundary condition directly on $u_{N-2}$, $u_{N-1}$, $u_N$.\n- At the left boundary $x_0=0$, enforce the Dirichlet condition by taking $u_0 = u_{\\text{exact}}(0)$ as known.\n\nAssemble the resulting linear system for the unknown vector $\\mathbf{u} = [u_1, u_2, \\dots, u_N]^T$ and solve it numerically. Then, quantify the accuracy of the computed solution by comparing it to $u_{\\text{exact}}(x)$ at the grid points.\n\nTest suite:\nEvaluate the implementation on the following parameter sets $(N,\\gamma)$:\n- $(40, 0)$,\n- $(40, 1)$,\n- $(40, 3)$,\n- $(40, 8)$,\n- $(12, 3)$.\nFor each parameter set, compute two scalar error metrics:\n1. The root-mean-square (RMS) error over all grid points, defined as\n$$\nE_{\\text{RMS}} = \\sqrt{\\frac{1}{N+1} \\sum_{i=0}^{N} \\left(u_i - u_{\\text{exact}}(x_i)\\right)^2 }.\n$$\n2. The maximum absolute error restricted to the near-boundary region $x \\ge 0.9$, defined as\n$$\nE_{\\text{max,bdry}} = \\max\\left\\{ \\left| u_i - u_{\\text{exact}}(x_i) \\right| \\, : \\, x_i \\ge 0.9 \\right\\}.\n$$\nIf no grid point satisfies $x_i \\ge 0.9$ (which can happen for small $N$ and extreme clustering), then take the near-boundary region to consist of the single rightmost node $x_N$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append the two floating-point numbers in order: first $E_{\\text{RMS}}$, then $E_{\\text{max,bdry}}$. Concatenate the five test cases in the order listed above, resulting in a list of length $10$. For example, the output must have the form\n$$\n[ E_{\\text{RMS}}^{(1)}, E_{\\text{max,bdry}}^{(1)}, E_{\\text{RMS}}^{(2)}, E_{\\text{max,bdry}}^{(2)}, E_{\\text{RMS}}^{(3)}, E_{\\text{max,bdry}}^{(3)}, E_{\\text{RMS}}^{(4)}, E_{\\text{max,bdry}}^{(4)}, E_{\\text{RMS}}^{(5)}, E_{\\text{max,bdry}}^{(5)} ].\n$$\nAll outputs are non-dimensional real numbers with no units, printed in standard decimal notation.",
            "solution": "The problem presented is a well-posed one-dimensional boundary value problem for the Poisson equation. It is scientifically grounded, mathematically consistent, and all necessary information for its numerical solution and verification is provided. The method of manufactured solutions is employed, which is a standard and rigorous technique for assessing the accuracy of numerical algorithms. The problem is therefore deemed valid. I will now proceed with the derivation and solution.\n\nThe problem requires the numerical solution of the following differential equation on the domain $x \\in [0, 1]$:\n$$\n\\frac{d^2 u}{dx^2} = f(x)\n$$\nwith the source term $f(x)$ and boundary conditions derived from the specified exact solution $u_{\\text{exact}}(x) = \\sin(\\pi x) + x$.\nThe source term is the second derivative of the exact solution:\n$$\nf(x) = \\frac{d^2}{dx^2} (\\sin(\\pi x) + x) = -\\pi^2 \\sin(\\pi x)\n$$\nThe boundary conditions are of a mixed type:\n- Dirichlet condition at $x=0$: $u(0) = u_{\\text{exact}}(0) = \\sin(0) + 0 = 0$.\n- Neumann condition at $x=1$: $\\frac{du}{dx}(1) = \\frac{d}{dx}|_{x=1} (\\sin(\\pi x) + x) = \\pi \\cos(\\pi x) + 1 |_{x=1} = \\pi \\cos(\\pi) + 1 = 1 - \\pi$.\n\nWe will discretize the domain $[0, 1]$ using a set of $N+1$ grid points $x_0, x_1, \\dots, x_N$, where $x_0=0$ and $x_N=1$. The grid may be non-uniform. The step sizes are defined as $h_i = x_i - x_{i-1}$ for $i=1, \\dots, N$. The unknown values of the solution at the grid points are denoted by $u_i \\approx u(x_i)$.\n\nThe task is to assemble a system of linear equations for the unknown vector $\\mathbf{v} = [u_1, u_2, \\dots, u_N]^T$. Note that $u_0 = 0$ is known and not part of the vector of unknowns.\n\nFirst, we derive the finite difference approximation for the second derivative at an interior node $x_i$, where $i \\in \\{1, \\dots, N-1\\}$. We use Taylor series expansions for $u(x_{i+1})$ and $u(x_{i-1})$ about the point $x_i$:\n$$\nu(x_{i+1}) = u(x_i) + h_{i+1} u'(x_i) + \\frac{h_{i+1}^2}{2} u''(x_i) + \\frac{h_{i+1}^3}{6} u'''(x_i) + \\mathcal{O}(h_{i+1}^4)\n$$\n$$\nu(x_{i-1}) = u(x_i) - h_i u'(x_i) + \\frac{h_i^2}{2} u''(x_i) - \\frac{h_i^3}{6} u'''(x_i) + \\mathcal{O}(h_i^4)\n$$\nwhere $h_{i+1} = x_{i+1} - x_i$ and $h_i = x_i - x_{i-1}$. To eliminate the first derivative term $u'(x_i)$, we multiply the first equation by $h_i$ and the second by $h_{i+1}$ and add them:\n$$\nh_i u_{i+1} + h_{i+1} u_{i-1} = (h_i + h_{i+1}) u_i + \\frac{h_i h_{i+1}^2 + h_{i+1} h_i^2}{2} u''_i + \\frac{h_i h_{i+1}^3 - h_{i+1} h_i^3}{6} u'''_i + \\dots\n$$\n$$\nh_i u_{i+1} + h_{i+1} u_{i-1} = (h_i + h_{i+1}) u_i + \\frac{h_i h_{i+1}(h_i + h_{i+1})}{2} u''_i + \\frac{h_i h_{i+1}(h_{i+1}^2 - h_i^2)}{6} u'''_i + \\dots\n$$\nSolving for $u''_i$, we obtain:\n$$\nu''(x_i) = \\frac{h_i u_{i+1} + h_{i+1} u_{i-1} - (h_i + h_{i+1}) u_i}{\\frac{h_i h_{i+1}(h_i+h_{i+1})}{2}} - \\frac{h_{i+1}-h_i}{3} u'''(x_i) + \\mathcal{O}((h_i+h_{i+1})^2)\n$$\nThe stencil is thus:\n$$\n\\frac{d^2 u}{dx^2}\\bigg|_{x_i} \\approx \\frac{2}{h_i+h_{i+1}} \\left( \\frac{u_{i+1} - u_i}{h_{i+1}} - \\frac{u_i - u_{i-1}}{h_i} \\right) = \\frac{2}{h_i(h_i+h_{i+1})} u_{i-1} - \\frac{2}{h_i h_{i+1}} u_i + \\frac{2}{h_{i+1}(h_i+h_{i+1})} u_{i+1}\n$$\nThe leading term of the truncation error is $\\frac{1}{3}(h_i - h_{i+1}) u'''(x_i)$. For a general non-uniform grid, this stencil is only first-order accurate. However, the problem specifies a grid generated by a smooth mapping $x(\\xi)$. In this case, $h_i = x_i - x_{i-1} = x'( \\xi_{i-1/2} ) \\Delta\\xi + \\mathcal{O}((\\Delta\\xi)^3)$, where $\\Delta\\xi = 1/N$. The difference in step sizes is $h_{i+1} - h_i \\approx x''(\\xi_i)(\\Delta\\xi)^2 = \\mathcal{O}(N^{-2})$. Consequently, the leading error term behaves as $\\mathcal{O}(N^{-2})$, and the scheme is indeed second-order accurate on such a smoothly varying grid.\n\nFor each interior node $i=1, \\dots, N-1$, the discretized PDE is:\n$$\n\\frac{2}{h_i(h_i+h_{i+1})} u_{i-1} - \\frac{2}{h_i h_{i+1}} u_i + \\frac{2}{h_{i+1}(h_i+h_{i+1})} u_{i+1} = f(x_i)\n$$\n\nNext, we derive the second-order one-sided approximation for the Neumann condition $\\frac{du}{dx}(x_N) = g_N = 1-\\pi$. We use a Taylor series expansion for $u_{N-1}$ and $u_{N-2}$ around $x_N$:\n$$\nu_{N-1} = u_N - h_N u'(x_N) + \\frac{h_N^2}{2} u''(x_N) + \\mathcal{O}(h_N^3)\n$$\n$$\nu_{N-2} = u_N - (h_N + h_{N-1}) u'(x_N) + \\frac{(h_N + h_{N-1})^2}{2} u''(x_N) + \\mathcal{O}((h_N + h_{N-1})^3)\n$$\nwhere $h_N = x_N - x_{N-1}$ and $h_{N-1} = x_{N-1} - x_{N-2}$. We eliminate the second derivative term $u''(x_N)$. From the first equation, $\\frac{1}{2}u''(x_N) = \\frac{u_{N-1} - u_N + h_N u'_N}{h_N^2}+\\mathcal{O}(h_N)$. Substituting this into the second equation creates an inconsistent mixture of error terms. A more sound procedure is to combine the two equations to eliminate $u''$:\nMultiply the first equation by $(h_N+h_{N-1})^2$ and the second by $h_N^2$, then subtract the second from the first.\n$$\n(h_N+h_{N-1})^2 u_{N-1} - h_N^2 u_{N-2} = ((h_N+h_{N-1})^2 - h_N^2) u_N - [h_N(h_N+h_{N-1})^2 - h_N^2(h_N+h_{N-1})] u'_N + \\mathcal{O}(h^4)\n$$\nThe term multiplying $u'_N$ simplifies to $h_N(h_N+h_{N-1})[(h_N+h_{N-1})-h_N] = h_N h_{N-1}(h_N+h_{N-1})$.\nSolving for $u'_N$:\n$$\nu'(x_N) = \\frac{h_N^2 u_{N-2} - (h_N+h_{N-1})^2 u_{N-1} + (2h_N h_{N-1} + h_{N-1}^2) u_N}{h_N h_{N-1}(h_N+h_{N-1})} + \\mathcal{O}(h_N h_{N-1})\n$$\nThe stencil for the Neumann boundary condition is:\n$$\n\\frac{h_N}{h_{N-1}(h_N+h_{N-1})} u_{N-2} - \\frac{h_N+h_{N-1}}{h_N h_{N-1}} u_{N-1} + \\frac{2h_N+h_{N-1}}{h_N(h_N+h_{N-1})} u_N = g_N\n$$\nThis approximation is second-order accurate.\n\nWe construct an $N \\times N$ linear system $A\\mathbf{v}=\\mathbf{b}$ for the unknown vector $\\mathbf{v} = [u_1, \\dots, u_N]^T$.\n\nThe first $N-1$ rows correspond to the interior points $i=1, \\dots, N-1$. Using 0-based indexing for the matrix $A$ (rows/columns $k=0, \\dots, N-1$) and vector $\\mathbf{b}$ (entries $k=0, \\dots, N-1$):\nFor $k=0$ (point $i=1$):\n$$\nA_{0,0} = -\\frac{2}{h_1 h_2} \\quad , \\quad A_{0,1} = \\frac{2}{h_2(h_1+h_2)}\n$$\n$$\nb_0 = f(x_1) - \\frac{2}{h_1(h_1+h_2)}u_0 = f(x_1) \\quad (\\text{since } u_0=0)\n$$\nFor $k=1, \\dots, N-2$ (points $i=2, \\dots, N-1$), the equation for $u_i$ populates row $k=i-1$ of the matrix:\n$$\nA_{k, k-1} = \\frac{2}{h_{k+1}(h_{k+1}+h_{k+2})} \\quad , \\quad A_{k, k} = -\\frac{2}{h_{k+1} h_{k+2}} \\quad , \\quad A_{k, k+1} = \\frac{2}{h_{k+2}(h_{k+1}+h_{k+2})}\n$$\n$$\nb_k = f(x_{k+1})\n$$\nThe last row, $k=N-1$, is from the Neumann boundary condition at $i=N$:\n$$\nA_{N-1, N-3} = \\frac{h_N}{h_{N-1}(h_N+h_{N-1})}\n$$\n$$\nA_{N-1, N-2} = -\\frac{h_N+h_{N-1}}{h_N h_{N-1}}\n$$\n$$\nA_{N-1, N-1} = \\frac{2h_N+h_{N-1}}{h_N(h_N+h_{N-1})}\n$$\n$$\nb_{N-1} = g_N = 1-\\pi\n$$\nThis fully defines the linear system. The matrix $A$ is almost tridiagonal, with the exception of the last row having three non-zero entries. This system can be efficiently solved using a standard linear solver. Once the vector $\\mathbf{v}$ is found, the complete numerical solution on the grid is given by $[u_0, v_0, v_1, \\dots, v_{N-1}]$. The error is then evaluated by comparison against $u_{\\text{exact}}(x_i)$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve as solve_linear_system\n\ndef solve():\n    \"\"\"\n    Main function to solve the BVP for all test cases and print results.\n    \"\"\"\n    test_cases = [\n        (40, 0),\n        (40, 1),\n        (40, 3),\n        (40, 8),\n        (12, 3),\n    ]\n\n    results = []\n    for N, gamma in test_cases:\n        u_numerical, x_grid = solve_bvp(N, gamma)\n        u_exact_vals = u_exact(x_grid)\n        \n        # 1. Root-Mean-Square (RMS) error\n        N_points = N + 1\n        rms_error = np.sqrt(np.sum((u_numerical - u_exact_vals)**2) / N_points)\n        \n        # 2. Maximum absolute error in the near-boundary region x >= 0.9\n        boundary_region_indices = np.where(x_grid >= 0.9)[0]\n        if len(boundary_region_indices) == 0:\n            # If no points in region, use the rightmost node as per problem spec\n            boundary_region_indices = np.array([N])\n            \n        max_boundary_error = np.max(np.abs(u_numerical[boundary_region_indices] - u_exact_vals[boundary_region_indices]))\n        \n        results.extend([rms_error, max_boundary_error])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_bvp(N, gamma):\n    \"\"\"\n    Solves the 1D Poisson BVP for a given N and gamma.\n    \n    Args:\n        N (int): Number of subintervals.\n        gamma (float): Grid clustering parameter.\n        \n    Returns:\n        tuple: (u_numerical, x) where u_numerical is the solution on grid x.\n    \"\"\"\n    \n    # 1. Grid Generation\n    xi = np.linspace(0.0, 1.0, N + 1)\n    if gamma == 0:\n        x = xi\n    else:\n        x = 1.0 - (np.exp(gamma * (1.0 - xi)) - 1.0) / (np.exp(gamma) - 1.0)\n\n    # 2. Setup Linear System A*v = b for unknowns v = [u_1, ..., u_N]\n    A = np.zeros((N, N))\n    b = np.zeros(N)\n    \n    # Grid spacings h_i = x_i - x_{i-1}\n    # h_steps[i-1] corresponds to h_i\n    h_steps = np.diff(x)\n\n    # Boundary value at x=0\n    u0 = u_exact(x[0]) # which is 0\n\n    # 3. Populate matrix A and vector b\n    \n    # First N-1 rows for interior points i = 1, ..., N-1\n    for i in range(1, N):\n        h_i = h_steps[i - 1]\n        h_i_plus_1 = h_steps[i]\n        \n        # Coefficients for u_{i-1}, u_i, u_{i+1}\n        coeff_im1 = 2.0 / (h_i * (h_i + h_i_plus_1))\n        coeff_i = -2.0 / (h_i * h_i_plus_1)\n        coeff_ip1 = 2.0 / (h_i_plus_1 * (h_i + h_i_plus_1))\n        \n        # Row index k = i - 1\n        k = i - 1\n        \n        if i == 1: # Equation for u_1\n            # A[k, k] corresponds to u_1, A[k, k+1] to u_2\n            A[k, k] = coeff_i\n            A[k, k + 1] = coeff_ip1\n            # u_0 term moves to RHS\n            b[k] = f_source(x[i]) - coeff_im1 * u0\n        else: # Equation for u_i, i > 1\n            # A[k, k-1] -> u_{i-1}, A[k, k] -> u_i, A[k, k+1] -> u_{i+1}\n            A[k, k - 1] = coeff_im1\n            A[k, k] = coeff_i\n            A[k, k + 1] = coeff_ip1\n            b[k] = f_source(x[i])\n            \n    # Last row for Neumann boundary condition at x_N = 1\n    h_N = h_steps[N - 1]\n    h_Nm1 = h_steps[N - 2]\n    \n    # Point i = N, corresponds to row k = N - 1\n    k = N - 1\n    \n    # Coefficients for u_{N-2}, u_{N-1}, u_N\n    coeff_Nm2 = h_N / (h_Nm1 * (h_N + h_Nm1))\n    coeff_Nm1 = -(h_N + h_Nm1) / (h_N * h_Nm1)\n    coeff_N = (2.0 * h_N + h_Nm1) / (h_N * (h_N + h_Nm1))\n    \n    # A[k, k-2] -> u_{N-2}, A[k, k-1] -> u_{N-1}, A[k, k] -> u_N\n    A[k, k - 2] = coeff_Nm2\n    A[k, k - 1] = coeff_Nm1\n    A[k, k] = coeff_N\n    \n    g_N = 1.0 - np.pi # Boundary value du/dx(1)\n    b[k] = g_N\n\n    # 4. Solve the system\n    u_unknowns = solve_linear_system(A, b)\n\n    # 5. Assemble full solution vector [u_0, u_1, ..., u_N]\n    u_numerical = np.concatenate(([u0], u_unknowns))\n    \n    return u_numerical, x\n\ndef u_exact(x):\n    \"\"\"\n    Exact solution u(x) = sin(pi*x) + x.\n    \"\"\"\n    return np.sin(np.pi * x) + x\n\ndef f_source(x):\n    \"\"\"\n    Source term f(x) = d^2(u_exact)/dx^2 = -pi^2 * sin(pi*x).\n    \"\"\"\n    return -(np.pi**2) * np.sin(np.pi * x)\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "A deep understanding of a physical model requires knowing not just how to implement it correctly, but also recognizing the distinct signatures of common errors. This exercise  is a conceptual diagnostic, asking you to predict the physical and mathematical consequences of swapping Dirichlet and Neumann boundary conditions in a diffusion simulation. By analyzing effects on mass conservation, solution behavior, and transient dynamics, you will learn to connect abstract boundary conditions to tangible physical outcomes.",
            "id": "2386501",
            "problem": "A one-dimensional (1D) diffusion process for a scalar field $u(x,t)$ on the interval $x \\in [0,L]$ with constant diffusivity $D>0$ is governed by the partial differential equation (PDE)\n$$\n\\frac{\\partial u}{\\partial t} = D\\,\\frac{\\partial^2 u}{\\partial x^2}, \\quad x \\in (0,L), \\; t>0,\n$$\nwith initial condition $u(x,0)=u_0(x)$. The intended boundary conditions are a Dirichlet condition (fixed value) at the left boundary and a Neumann condition (no flux) at the right boundary:\n$$\nu(0,t)=u_L \\;\\; \\text{for all } t\\ge 0, \\qquad \\frac{\\partial u}{\\partial x}(L,t)=0 \\;\\; \\text{for all } t\\ge 0,\n$$\nwhere $u_L$ is a constant. By mistake, an implementation swaps these boundary conditions and enforces instead\n$$\n\\frac{\\partial u}{\\partial x}(0,t)=0 \\;\\; \\text{for all } t\\ge 0, \\qquad u(L,t)=u_L \\;\\; \\text{for all } t\\ge 0.\n$$\nAssume $u_0(x)$ and $u_L$ are bounded and real-valued, and interpret $u$ as a concentration so that nonnegativity matters physically.\n\nWhich of the following statements about the consequences of this swap are correct? Select all that apply.\n\nA. If $u_L$ is constant in time, then in both the intended and the swapped problems the unique steady state is $u(x)\\equiv u_L$. Therefore a test that only checks the final steady state $u(x)$ cannot detect the swap.\n\nB. Define the total mass $M(t)=\\int_0^L u(x,t)\\,dx$. In the intended problem one has $M'(t) = -D\\,\\frac{\\partial u}{\\partial x}(0,t)$, whereas in the swapped problem one has $M'(t) = D\\,\\frac{\\partial u}{\\partial x}(L,t)$. Hence any exchange of mass with the environment occurs at the wrong boundary in the swapped implementation.\n\nC. Swapping the Dirichlet and Neumann boundary conditions necessarily violates the maximum principle, so even if $u_0(x)\\ge 0$ for all $x$ and $u_L\\ge 0$, the swapped simulation will generally produce negative values of $u$ at intermediate times.\n\nD. If the same asymmetric initial condition $u_0(x)$ (not symmetric about $x=L/2$) is used in both runs, then the time-dependent solutions produced by the intended-BC run and the swapped-BC run generally differ in a way that cannot be obtained by a simple spatial reflection $x\\mapsto L-x$.\n\nE. The spectrum of the spatial operator $-D\\,\\frac{d^2}{dx^2}$ with mixed Dirichlet–Neumann boundary conditions is unchanged by swapping which end is Dirichlet versus Neumann; thus the transient decay rates are identical in the intended and swapped problems, although the spatial mode shapes are mirrored.",
            "solution": "The problem statement is subjected to validation before proceeding to a solution.\n\n**Step 1: Extract Givens**\n-   Governing PDE: $\\frac{\\partial u}{\\partial t} = D\\,\\frac{\\partial^2 u}{\\partial x^2}$, for $x \\in (0,L)$, $t > 0$, with diffusivity $D > 0$.\n-   Domain: $x \\in [0,L]$.\n-   Initial condition: $u(x,0) = u_0(x)$.\n-   Intended boundary conditions (BCs): $u(0,t) = u_L$ and $\\frac{\\partial u}{\\partial x}(L,t) = 0$ for all $t \\ge 0$.\n-   Swapped boundary conditions (BCs): $\\frac{\\partial u}{\\partial x}(0,t) = 0$ and $u(L,t) = u_L$ for all $t \\ge 0$.\n-   The value $u_L$ is a constant.\n-   The initial condition $u_0(x)$ and the boundary value $u_L$ are bounded and real-valued.\n-   The field $u$ is interpreted as a concentration.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem describes the one-dimensional diffusion equation, a fundamental parabolic partial differential equation in multiple fields of science and engineering. The boundary conditions, Dirichlet ($u$ specified) and Neumann ($\\partial u/\\partial n$ specified), are standard and physically meaningful (e.g., fixed concentration and no-flux boundary). The setup is scientifically impeccable.\n-   **Well-Posed**: The initial-boundary value problem for the heat/diffusion equation with the specified mixed boundary conditions is a classic example of a well-posed problem. For reasonable initial data (e.g., $u_0(x) \\in L^2([0,L])$), a unique solution exists, which depends continuously on the initial and boundary data.\n-   **Objective**: The problem is stated in precise mathematical language, free of any ambiguity, subjectivity, or non-scientific claims.\n-   **Other Criteria**: The problem is self-contained, consistent, and describes a physically realistic scenario. No flaws are detected.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full analysis of each option is warranted.\n\n**Analysis of Options**\n\n**Option A Evaluation**\nA steady-state solution $u(x)$ is one for which $\\frac{\\partial u}{\\partial t} = 0$. The PDE reduces to the ordinary differential equation $D\\,\\frac{d^2 u}{dx^2} = 0$, which, since $D > 0$, implies $\\frac{d^2 u}{dx^2} = 0$. The general solution is a linear function $u(x) = C_1 x + C_2$, where $C_1$ and $C_2$ are constants to be determined by the boundary conditions.\n\n1.  **Intended Problem**: The BCs are $u(0) = u_L$ and $\\frac{du}{dx}(L) = 0$.\n    -   $u(0) = u_L \\implies C_1 \\cdot 0 + C_2 = u_L \\implies C_2 = u_L$.\n    -   $\\frac{du}{dx}(x) = C_1$, so $\\frac{du}{dx}(L) = 0 \\implies C_1 = 0$.\n    -   The unique steady state is $u(x) = u_L$.\n\n2.  **Swapped Problem**: The BCs are $\\frac{du}{dx}(0) = 0$ and $u(L) = u_L$.\n    -   $\\frac{du}{dx}(0) = 0 \\implies C_1 = 0$.\n    -   $u(L) = u_L \\implies C_1 \\cdot L + C_2 = u_L \\implies 0 \\cdot L + C_2 = u_L \\implies C_2 = u_L$.\n    -   The unique steady state is also $u(x) = u_L$.\n\nSince both problems converge to the identical steady-state solution $u(x) \\equiv u_L$, an experimental or numerical test that only measures this final state would be unable to distinguish between the correct and the swapped implementations.\n**Verdict**: The statement in option A is **Correct**.\n\n**Option B Evaluation**\nThe total mass is given by $M(t) = \\int_0^L u(x,t)\\,dx$. Its rate of change is found by differentiating under the integral sign (Leibniz rule) and using the PDE:\n$$\n\\frac{dM}{dt} = \\int_0^L \\frac{\\partial u}{\\partial t}(x,t)\\,dx = \\int_0^L D\\,\\frac{\\partial^2 u}{\\partial x^2}(x,t)\\,dx\n$$\nBy the Fundamental Theorem of Calculus, this integral evaluates to:\n$$\n\\frac{dM}{dt} = D \\left[ \\frac{\\partial u}{\\partial x}(x,t) \\right]_0^L = D \\left( \\frac{\\partial u}{\\partial x}(L,t) - \\frac{\\partial u}{\\partial x}(0,t) \\right)\n$$\nThis equation represents the net flux of the quantity $u$ into the domain.\n\n1.  **Intended Problem**: The BCs are $u(0,t) = u_L$ and $\\frac{\\partial u}{\\partial x}(L,t) = 0$. Substituting the no-flux condition at $x=L$:\n    $$\n    \\frac{dM}{dt} = D \\left( 0 - \\frac{\\partial u}{\\partial x}(0,t) \\right) = -D\\,\\frac{\\partial u}{\\partial x}(0,t)\n    $$\n    This shows mass exchange occurs solely through the boundary at $x=0$.\n\n2.  **Swapped Problem**: The BCs are $\\frac{\\partial u}{\\partial x}(0,t) = 0$ and $u(L,t) = u_L$. Substituting the no-flux condition at $x=0$:\n    $$\n    \\frac{dM}{dt} = D \\left( \\frac{\\partial u}{\\partial x}(L,t) - 0 \\right) = D\\,\\frac{\\partial u}{\\partial x}(L,t)\n    $$\n    This shows mass exchange occurs solely through the boundary at $x=L$.\n\nThe statement correctly provides these expressions for $M'(t)$ and correctly concludes that the location of mass exchange with the environment is swapped.\n**Verdict**: The statement in option B is **Correct**.\n\n**Option C Evaluation**\nThe statement claims that swapping the boundary conditions violates the maximum principle, leading to negative values for $u$ even with non-negative initial and boundary data. This is fundamentally incorrect. The heat equation obeys a maximum (and minimum) principle for a wide variety of boundary conditions, including the mixed Dirichlet-Neumann conditions presented here.\n\nThe weak maximum principle for this problem states that the maximum and minimum values of the solution $u(x,t)$ on the domain $[0,L] \\times [0, T]$ are attained either at the initial time ($t=0$) or on the part of the boundary with a Dirichlet condition.\nFor the swapped problem, the boundary data is specified by $u_0(x)$ at $t=0$ and $u(L,t) = u_L$. Let $m = \\min\\left( \\inf_{x\\in[0,L]} u_0(x), u_L \\right)$. The minimum principle guarantees that for all $x \\in [0,L]$ and $t \\ge 0$, $u(x,t) \\ge m$.\nIf it is given that $u_0(x) \\ge 0$ for all $x$ and $u_L \\ge 0$, then $m \\ge 0$. Consequently, $u(x,t) \\ge 0$ for all time. The solution will remain non-negative. Swapping the boundary conditions does not negate this fundamental property of the diffusion equation.\n**Verdict**: The statement in option C is **Incorrect**.\n\n**Option D Evaluation**\nLet $u_I(x,t)$ be the solution to the intended problem, and $u_S(x,t)$ be the solution to the swapped problem.\nLet us define a new function $v(x,t) = u_I(L-x, t)$. We investigate the PDE and BCs satisfied by $v(x,t)$. Let $y=L-x$.\n-   $\\frac{\\partial v}{\\partial t} = \\frac{\\partial u_I}{\\partial t}(L-x, t)$.\n-   $\\frac{\\partial v}{\\partial x} = \\frac{\\partial u_I}{\\partial y}(y,t) \\frac{dy}{dx} = -\\frac{\\partial u_I}{\\partial y}(y,t)$.\n-   $\\frac{\\partial^2 v}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(-\\frac{\\partial u_I}{\\partial y}\\right) = -\\frac{\\partial}{\\partial y}\\left(-\\frac{\\partial u_I}{\\partial y}\\right)\\frac{dy}{dx} = \\frac{\\partial^2 u_I}{\\partial y^2}$.\nSince $\\frac{\\partial u_I}{\\partial t} = D \\frac{\\partial^2 u_I}{\\partial y^2}$, we have $\\frac{\\partial v}{\\partial t} = D \\frac{\\partial^2 v}{\\partial x^2}$. So $v(x,t)$ solves the same PDE.\n\nNow, check the BCs for $v(x,t)$:\n-   At $x=0$, which corresponds to $y=L$: $\\frac{\\partial v}{\\partial x}(0,t) = -\\frac{\\partial u_I}{\\partial y}(L,t) = 0$, which is the intended BC at $x=L$.\n-   At $x=L$, which corresponds to $y=0$: $v(L,t) = u_I(0,t) = u_L$, which is the intended BC at $x=0$.\nSo, $v(x,t) = u_I(L-x,t)$ satisfies the swapped boundary conditions.\n\nNow, check the initial condition for $v(x,t)$:\n-   $v(x,0) = u_I(L-x,0) = u_0(L-x)$.\nThe solution to the swapped problem, $u_S(x,t)$, is defined with the initial condition $u_S(x,0)=u_0(x)$.\nThus, $u_I(L-x, t)$ is the solution to the swapped problem for the *reflected* initial condition $u_0(L-x)$. Since the problem states that $u_0(x)$ is asymmetric ($u_0(x) \\not\\equiv u_0(L-x)$), the initial conditions for $u_S(x,t)$ and $v(x,t)$ are different. By uniqueness of the solution, $u_S(x,t) \\neq v(x,t)$ in general. That is, $u_S(x,t) \\neq u_I(L-x,t)$.\nThis confirms that the solution to the swapped problem is not simply a spatial reflection of the solution to the intended problem when the initial condition is asymmetric.\n**Verdict**: The statement in option D is **Correct**.\n\n**Option E Evaluation**\nThe transient behavior is governed by the eigenvalues of the spatial operator $\\mathcal{L} = -D \\frac{d^2}{dx^2}$ with the respective homogeneous boundary conditions. The solutions are superpositions of modes of the form $e^{-\\lambda t}\\phi(x)$, where $(\\lambda, \\phi)$ are eigenpairs of $\\mathcal{L}\\phi = \\lambda\\phi$. The eigenvalues $\\lambda$ are the decay rates.\n\n1.  **Intended Problem**: The eigenvalue problem is $-D \\phi''(x) = \\lambda \\phi(x)$ with BCs $\\phi(0) = 0$, $\\phi'(L) = 0$. Let $k^2 = \\lambda/D$. Then $\\phi''(x) + k^2\\phi(x) = 0$.\n    -   General solution: $\\phi(x) = A\\cos(kx) + B\\sin(kx)$.\n    -   $\\phi(0)=0 \\implies A=0$. Solution is $\\phi(x) = B\\sin(kx)$.\n    -   $\\phi'(x) = Bk\\cos(kx)$. $\\phi'(L)=0 \\implies \\cos(kL)=0$.\n    -   This requires $kL = \\frac{(2n-1)\\pi}{2}$ for $n=1,2,3,\\dots$.\n    -   $k_n = \\frac{(2n-1)\\pi}{2L}$.\n    -   The eigenvalues are $\\lambda_n = Dk_n^2 = D \\left(\\frac{(2n-1)\\pi}{2L}\\right)^2$.\n    -   The eigenfunctions are $\\phi_n^I(x) = \\sin\\left(\\frac{(2n-1)\\pi x}{2L}\\right)$.\n\n2.  **Swapped Problem**: The eigenvalue problem is $-D \\phi''(x) = \\lambda \\phi(x)$ with BCs $\\phi'(0) = 0$, $\\phi(L) = 0$.\n    -   General solution: $\\phi(x) = A\\cos(kx) + B\\sin(kx)$.\n    -   $\\phi'(x) = -Ak\\sin(kx) + Bk\\cos(kx)$. $\\phi'(0)=0 \\implies B=0$. Solution is $\\phi(x) = A\\cos(kx)$.\n    -   $\\phi(L)=0 \\implies \\cos(kL)=0$.\n    -   This yields the same condition for $k$: $kL = \\frac{(2n-1)\\pi}{2}$ for $n=1,2,3,\\dots$.\n    -   The eigenvalues $\\lambda_n = Dk_n^2 = D \\left(\\frac{(2n-1)\\pi}{2L}\\right)^2$ are identical to the intended case.\n    -   The eigenfunctions are $\\phi_n^S(x) = \\cos\\left(\\frac{(2n-1)\\pi x}{2L}\\right)$.\n\nThe set of eigenvalues (the spectrum) is identical for both problems. Therefore, the transient decay rates are identical.\nThe spatial mode shapes (eigenfunctions) are different. Let's check if they are mirrored:\n$$\n\\phi_n^I(L-x) = \\sin\\left(\\frac{(2n-1)\\pi (L-x)}{2L}\\right) = \\sin\\left(\\frac{(2n-1)\\pi}{2} - \\frac{(2n-1)\\pi x}{2L}\\right)\n$$\nUsing the trigonometric identity $\\sin(\\alpha - \\beta) = \\sin\\alpha\\cos\\beta - \\cos\\alpha\\sin\\beta$ with $\\alpha = (2n-1)\\pi/2$, we note $\\cos\\alpha=0$ and $\\sin\\alpha=(-1)^{n-1}$.\n$$\n\\phi_n^I(L-x) = (-1)^{n-1} \\cos\\left(\\frac{(2n-1)\\pi x}{2L}\\right) \\propto \\phi_n^S(x)\n$$\nThe eigenfunctions of one problem are, up to a sign, the spatial reflection of the eigenfunctions of the other. The statement is entirely correct.\n**Verdict**: The statement in option E is **Correct**.",
            "answer": "$$\\boxed{ABDE}$$"
        }
    ]
}