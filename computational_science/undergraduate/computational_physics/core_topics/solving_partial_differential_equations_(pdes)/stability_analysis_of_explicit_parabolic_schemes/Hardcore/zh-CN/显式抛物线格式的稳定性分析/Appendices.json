{
    "hands_on_practices": [
        {
            "introduction": "我们从一个熟悉的一维热方程开始，但通过用一个更精确的四阶模板替换标准的空间离散化方法来增加一些挑战。这个练习展示了提高空间精度如何影响显式格式的时间稳定性约束。这是冯·诺依曼分析的一个直接应用，可以加深对空间和时间离散化之间相互作用的理解。",
            "id": "2441883",
            "problem": "考虑一维热方程 $u_{t} = \\alpha\\,u_{xx}$，其中 $\\alpha$ 为常数扩散系数。该方程在一个周期性区域上进行离散化，使用间距为 $\\Delta x$ 的均匀网格。定义一个显式时间前向欧拉格式，该格式对空间二阶导数使用具有 $\\mathcal{O}(\\Delta x^{4})$ 四阶精度的标准五点模板，具体如下：\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;+\\; \\alpha\\,\\Delta t\\,\\frac{-u_{j-2}^{n} + 16\\,u_{j-1}^{n} - 30\\,u_{j}^{n} + 16\\,u_{j+1}^{n} - u_{j+2}^{n}}{12\\,\\Delta x^{2}} \\,,\n$$\n此式对所有整数网格指标 $j$ 和时间层 $n$ 成立。引入无量纲比 $r := \\alpha\\,\\Delta t / \\Delta x^{2}$。假设采用周期性边界条件，从而离散空间傅里叶模张成整个解空间。\n\n确定使该格式对于周期性网格上所有离散空间波数都保持稳定的最大允许值 $r$。将最终答案表示为一个无单位的精确数，无需四舍五入。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 偏微分方程：$u_{t} = \\alpha\\,u_{xx}$\n- 有限差分格式：$u_{j}^{n+1} \\;=\\; u_{j}^{n} \\;+\\; \\alpha\\,\\Delta t\\,\\frac{-u_{j-2}^{n} + 16\\,u_{j-1}^{n} - 30\\,u_{j}^{n} + 16\\,u_{j+1}^{n} - u_{j+2}^{n}}{12\\,\\Delta x^{2}}$\n- 无量纲参数：$r := \\alpha\\,\\Delta t / \\Delta x^{2}$\n- 边界条件：周期性\n- 目标：确定使格式稳定的 $r$ 的最大允许值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是计算物理和数值分析中的一个标准课题——具体而言，是针对抛物型偏微分方程的有限差分格式的稳定性分析。这是一个适定的问题，目标明确，信息充分。语言精确客观。问题陈述没有违反科学原理，没有信息缺失，也没有歧义。\n\n**步骤3：结论与行动**\n该问题被认定为有效。下面将推导其解。\n\n对于给定的具有常数系数和周期性边界条件的线性有限差分格式，其稳定性可以使用冯·诺依曼稳定性分析方法进行严格分析。我们将以下形式的单个傅里叶模作为数值解代入：\n$$\nu_{j}^{n} = g^{n} \\exp(\\mathrm{i} k j \\Delta x)\n$$\n其中 $n$ 是时间指标，$j$ 是空间指标，$k$ 是空间波数，$\\mathrm{i} = \\sqrt{-1}$，而 $g = g(k)$ 是波数为 $k$ 的模的放大因子。时间步长为 $\\Delta t$，空间步长为 $\\Delta x$。该格式是稳定的，当且仅当对所有可能的波数 $k$，都有 $|g| \\le 1$。\n\n首先，我们使用 $r := \\alpha\\,\\Delta t / \\Delta x^{2}$ 的定义来重写该格式：\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\frac{r}{12} \\left( -u_{j-2}^{n} + 16u_{j-1}^{n} - 30u_{j}^{n} + 16u_{j+1}^{n} - u_{j+2}^{n} \\right)\n$$\n将傅里叶模拟设代入该格式，得到：\n$$\ng^{n+1} \\exp(\\mathrm{i} k j \\Delta x) = g^{n} \\exp(\\mathrm{i} k j \\Delta x) + \\frac{r}{12} g^{n} \\left( -\\exp(\\mathrm{i}k(j-2)\\Delta x) + 16\\exp(\\mathrm{i}k(j-1)\\Delta x) - 30\\exp(\\mathrm{i}kj\\Delta x) + 16\\exp(\\mathrm{i}k(j+1)\\Delta x) - \\exp(\\mathrm{i}k(j+2)\\Delta x) \\right)\n$$\n将整个方程除以 $g^{n} \\exp(\\mathrm{i} k j \\Delta x)$，我们得到放大因子 $g = g^{n+1}/g^n$ 的表达式：\n$$\ng = 1 + \\frac{r}{12} \\left( -\\exp(-\\mathrm{i} 2 k \\Delta x) + 16\\exp(-\\mathrm{i} k \\Delta x) - 30 + 16\\exp(\\mathrm{i} k \\Delta x) - \\exp(\\mathrm{i} 2 k \\Delta x) \\right)\n$$\n令 $\\theta = k \\Delta x$ 为无量纲波数，对于离散网格，其取值范围为 $\\theta \\in [-\\pi, \\pi]$。我们可以使用欧拉公式 $\\cos(\\phi) = \\frac{\\exp(\\mathrm{i}\\phi) + \\exp(-\\mathrm{i}\\phi)}{2}$ 将复指数项组合起来：\n$$\ng = 1 + \\frac{r}{12} \\left( -(\\exp(\\mathrm{i} 2 \\theta) + \\exp(-\\mathrm{i} 2 \\theta)) + 16(\\exp(\\mathrm{i} \\theta) + \\exp(-\\mathrm{i} \\theta)) - 30 \\right)\n$$\n$$\ng = 1 + \\frac{r}{12} \\left( -2\\cos(2\\theta) + 32\\cos(\\theta) - 30 \\right)\n$$\n为进一步简化此表达式，我们使用二倍角恒等式 $\\cos(2\\theta) = 2\\cos^{2}(\\theta) - 1$：\n$$\ng = 1 + \\frac{r}{12} \\left( -2(2\\cos^{2}(\\theta) - 1) + 32\\cos(\\theta) - 30 \\right)\n$$\n$$\ng = 1 + \\frac{r}{12} \\left( -4\\cos^{2}(\\theta) + 2 + 32\\cos(\\theta) - 30 \\right)\n$$\n$$\ng = 1 + \\frac{r}{12} \\left( -4\\cos^{2}(\\theta) + 32\\cos(\\theta) - 28 \\right)\n$$\n从括号中提出因子 $-4$：\n$$\ng = 1 - \\frac{4r}{12} \\left( \\cos^{2}(\\theta) - 8\\cos(\\theta) + 7 \\right)\n$$\n$$\ng = 1 - \\frac{r}{3} \\left( \\cos^{2}(\\theta) - 8\\cos(\\theta) + 7 \\right)\n$$\n$\\cos(\\theta)$ 的二次项可以被因式分解：\n$$\ng = 1 - \\frac{r}{3} (\\cos(\\theta) - 1)(\\cos(\\theta) - 7)\n$$\n放大因子 $g$ 是纯实数。因此，稳定性条件 $|g| \\le 1$ 变为 $-1 \\le g \\le 1$。\n\n让我们分别分析这两个不等式。令 $c = \\cos(\\theta)$。由于 $\\theta \\in [-\\pi, \\pi]$，我们有 $c \\in [-1, 1]$。关于 $c$ 的多项式是 $P(c) = (c - 1)(c - 7)$。\n第一个不等式是 $g \\le 1$：\n$$\n1 - \\frac{r}{3} P(c) \\le 1 \\implies -\\frac{r}{3} P(c) \\le 0\n$$\n由于 $r = \\alpha \\Delta t / \\Delta x^{2}$ 必须是非负的（$r \\ge 0$），这就要求 $P(c) \\ge 0$。\n对于 $c \\in [-1, 1]$，项 $(c - 1)$ 是非正的（$\\le 0$），而项 $(c - 7)$ 是严格为负的（$ 0$）。因此，它们的乘积 $P(c) = (c-1)(c-7)$ 对所有有效的 $c$ 始终是非负的。所以，对于任何 $r \\ge 0$，不等式 $g \\le 1$ 都成立。\n\n第二个不等式是 $g \\ge -1$：\n$$\n1 - \\frac{r}{3} P(c) \\ge -1 \\implies 2 \\ge \\frac{r}{3} P(c) \\implies 6 \\ge r \\cdot P(c)\n$$\n这个不等式必须对 $c = \\cos(\\theta)$ 的所有可能值都成立，即对所有 $c \\in [-1, 1]$ 成立。为保证这一点，我们必须确保该不等式对于 $P(c)$ 在此区间上的最大值成立。\n$$\nr \\cdot \\max_{c \\in [-1, 1]} P(c) \\le 6\n$$\n函数为 $P(c) = c^{2} - 8c + 7$。为求其在区间 $[-1, 1]$ 上的最大值，我们检查其导数：$P'(c) = 2c - 8$。临界点在 $c=4$，该点在区间 $[-1, 1]$ 之外。由于抛物线 $P(c)$ 开口向上，其在某一区间上的最大值必定在该区间的某个端点处取得。我们计算 $P(c)$ 在 $c=-1$ 和 $c=1$ 处的值：\n在 $c=1$ 处（对应于 $\\theta=0$，即最长波长模）：\n$P(1) = (1 - 1)(1 - 7) = 0$。\n在 $c=-1$ 处（对应于 $\\theta=\\pm\\pi$，即最短波长模，或称奈奎斯特频率）：\n$P(-1) = (-1 - 1)(-1 - 7) = (-2)(-8) = 16$。\n\n$P(c)$ 在区间 $[-1, 1]$ 上的最大值是 $16$。这种“最坏情况”决定了稳定性的极限。将这个最大值代入稳定性条件：\n$$\nr \\cdot 16 \\le 6\n$$\n$$\nr \\le \\frac{6}{16} = \\frac{3}{8}\n$$\n使该格式对所有空间波数都保持稳定的 $r$ 的最大允许值为 $\\frac{3}{8}$。",
            "answer": "$$\\boxed{\\frac{3}{8}}$$"
        },
        {
            "introduction": "接下来，我们将分析扩展到二维，并引入一个混合导数项 $u_{xy}$。在非笛卡尔坐标系中或处理各向异性扩散时，物理学中经常会出现这类项。这个练习揭示了一个非直观但重要的结果：该显式格式的稳定性是由模态的“最坏情况”组合决定的，并且某些项可能不会影响最终的稳定性极限。",
            "id": "2441824",
            "problem": "考虑二维线性抛物型偏微分方程（PDE）\n$$\nu_{t} \\;=\\; a\\,u_{xx} \\;+\\; 2\\,b\\,u_{xy} \\;+\\; c\\,u_{yy},\n$$\n该方程定义在矩形域上，且在两个方向上均具有周期性边界条件。系数满足 $a>0$, $c>0$ 和 $ac - b^2 > 0$（椭圆性条件）。在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀网格上对空间进行离散化，并使用前向欧拉格式在时间上推进。对 $u_{xx}$ 和 $u_{yy}$ 使用中心二阶有限差分，对 $u_{xy}$ 使用标准的中心混合导数模板：\n$$\n\\begin{aligned}\nu_{xx}\\big|_{i,j} \\approx \\frac{u_{i+1,j} - 2 u_{i,j} + u_{i-1,j}}{\\Delta x^{2}}, \\\\\nu_{yy}\\big|_{i,j} \\approx \\frac{u_{i,j+1} - 2 u_{i,j} + u_{i,j-1}}{\\Delta y^{2}}, \\\\\nu_{xy}\\big|_{i,j} \\approx \\frac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4\\,\\Delta x\\,\\Delta y}.\n\\end{aligned}\n$$\n因此，完全显式的时间步进格式为\n$$\n\\begin{aligned}\nu_{i,j}^{n+1} \\;=\\; u_{i,j}^{n} \\;+\\; \\Delta t \\Bigg[\n\\,a\\,\\frac{u_{i+1,j}^{n} - 2 u_{i,j}^{n} + u_{i-1,j}^{n}}{\\Delta x^{2}}\n\\;+\\; c\\,\\frac{u_{i,j+1}^{n} - 2 u_{i,j}^{n} + u_{i,j-1}^{n}}{\\Delta y^{2}} \\\\\n\\;+\\; 2\\,b\\,\\frac{u_{i+1,j+1}^{n} - u_{i+1,j-1}^{n} - u_{i-1,j+1}^{n} - u_{i-1,j-1}^{n}}{4\\,\\Delta x\\,\\Delta y}\n\\Bigg].\n\\end{aligned}\n$$\n使用 von Neumann（傅里叶）稳定性分析，并仅利用中心差分算子的离散傅里叶符号的定义和性质，确定精确的最大时间步长 $\\Delta t_{\\max}$，该步长表示为关于 $a$、$b$、$c$、$\\Delta x$ 和 $\\Delta y$ 的简化闭式解析表达式，使得显式格式对所有空间傅里叶模式都是线性稳定的。请以解析表达式的形式提供 $\\Delta t_{\\max}$ 的最终答案。不要提供不等式。不需要四舍五入，最终表达式中不应包含单位。",
            "solution": "所述问题是有效的。它具有科学依据，是适定的、客观的，并包含获得唯一解所需的所有必要信息。条件 $a>0$，$c>0$ 和 $ac-b^{2}0$ 确保了偏微分方程是抛物型的，而在周期性域上使用 von Neumann 分析是确定给定有限差分格式线性稳定性的标准程序。我们继续进行推导。\n\n显式时间步进格式的稳定性由 von Neumann 稳定性分析中的放大因子 $G$ 决定。我们考虑解的单个傅里叶模式，表示为\n$$\nu_{i,j}^{n} = (G)^{n} \\exp\\left(\\mathrm{i}(k_x i \\Delta x + k_y j \\Delta y)\\right)\n$$\n其中 $G$ 是一个时间步长 $\\Delta t$ 的放大因子，$\\mathrm{i}$ 是虚数单位，满足 $\\mathrm{i}^2 = -1$，$k_x$ 和 $k_y$ 分别是 $x$ 和 $y$ 方向的波数。\n\n将此形式代入有限差分格式，可将 $u_{i,j}^{n+1} = G \\cdot u_{i,j}^{n}$ 与时间层 $n$ 的各项联系起来。空间位移算子作用于指数项。例如，$u_{i+1,j}^{n} = u_{i,j}^{n} \\exp(\\mathrm{i} k_x \\Delta x)$。将此应用于格式中的所有项，并除以公因子 $u_{i,j}^{n}$，得到 $G$ 的表达式：\n$$\nG = 1 + \\Delta t \\left[ a\\,\\frac{\\exp(\\mathrm{i} k_x \\Delta x) - 2 + \\exp(-\\mathrm{i} k_x \\Delta x)}{\\Delta x^{2}} + c\\,\\frac{\\exp(\\mathrm{i} k_y \\Delta y) - 2 + \\exp(-\\mathrm{i} k_y \\Delta y)}{\\Delta y^{2}} + \\frac{b}{2}\\,\\frac{\\exp(\\mathrm{i}(k_x \\Delta x+k_y \\Delta y)) - \\dots}{\\Delta x \\Delta y} \\right]\n$$\n混合导数项的分子是\n$$\n\\exp(\\mathrm{i}(k_x\\Delta x+k_y\\Delta y)) - \\exp(\\mathrm{i}(k_x\\Delta x-k_y\\Delta y)) - \\exp(\\mathrm{i}(-k_x\\Delta x+k_y\\Delta y)) + \\exp(\\mathrm{i}(-k_x\\Delta x-k_y\\Delta y))\n= (\\exp(\\mathrm{i} k_x \\Delta x)-\\exp(-\\mathrm{i} k_x \\Delta x))(\\exp(\\mathrm{i} k_y \\Delta y)-\\exp(-\\mathrm{i} k_y \\Delta y))\n= (2\\mathrm{i} \\sin(k_x \\Delta x))(2\\mathrm{i} \\sin(k_y \\Delta y))\n= -4 \\sin(k_x \\Delta x)\\sin(k_y \\Delta y)\n$$\n使用恒等式 $\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta) = 2\\cos(\\theta)$ 和 $2\\cos(\\theta) - 2 = -4\\sin^2(\\theta/2)$，放大因子变为：\n$$\nG(k_x, k_y) = 1 + \\Delta t \\left[ -\\frac{4a}{\\Delta x^{2}}\\sin^{2}\\left(\\frac{k_x \\Delta x}{2}\\right) - \\frac{4c}{\\Delta y^{2}}\\sin^{2}\\left(\\frac{k_y \\Delta y}{2}\\right) - \\frac{2b}{\\Delta x \\Delta y}\\sin(k_x \\Delta x)\\sin(k_y \\Delta y) \\right]\n$$\n我们将括号内的表达式乘以 $-1$ 定义为一个函数 $S(k_x, k_y)$：\n$$\nS(k_x, k_y) = \\frac{4a}{\\Delta x^{2}}\\sin^{2}\\left(\\frac{k_x \\Delta x}{2}\\right) + \\frac{4c}{\\Delta y^{2}}\\sin^{2}\\left(\\frac{k_y \\Delta y}{2}\\right) + \\frac{2b}{\\Delta x \\Delta y}\\sin(k_x \\Delta x)\\sin(k_y \\Delta y)\n$$\n于是放大因子为 $G = 1 - \\Delta t S(k_x, k_y)$。前向欧拉格式的线性稳定性条件是 $|G| \\leq 1$，这可以转化为 $-1 \\leq 1 - \\Delta t S(k_x, k_y) \\leq 1$。\n\n空间算子是耗散的，意味着其离散符号是非正的。这表明 $S(k_x, k_y) \\ge 0$。这种非负性由椭圆性条件 $ac-b^2  0$ 保证，并且可以被严格证明。考虑到 $\\Delta t  0$，上界 $1 - \\Delta t S(k_x, k_y) \\leq 1$ 是满足的。因此，稳定性由下界决定：\n$$\n-1 \\leq 1 - \\Delta t S(k_x, k_y) \\implies \\Delta t S(k_x, k_y) \\leq 2\n$$\n这个不等式必须对所有可能的波数 $k_x$ 和 $k_y$ 都成立。为了找到允许的最大时间步长 $\\Delta t_{\\max}$，我们必须在最坏情况下强制执行此条件，即当 $S(k_x, k_y)$ 最大化时：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\max_{k_x, k_y} S(k_x, k_y)}\n$$\n我们现在必须找到 $S(k_x, k_y)$ 的最大值。令 $\\phi_x = k_x \\Delta x$ 和 $\\phi_y = k_y \\Delta y$。由于网格上的混叠效应，这些归一化波数的唯一范围是 $[-\\pi, \\pi]$。需要最大化的函数是：\n$$\nS(\\phi_x, \\phi_y) = \\frac{4a}{\\Delta x^2} \\sin^2\\left(\\frac{\\phi_x}{2}\\right) + \\frac{4c}{\\Delta y^2} \\sin^2\\left(\\frac{\\phi_y}{2}\\right) + \\frac{2b}{\\Delta x \\Delta y} \\sin(\\phi_x) \\sin(\\phi_y)\n$$\n这可以使用 $1-\\cos\\phi = 2\\sin^2(\\phi/2)$ 进行改写。令 $u = \\cos\\phi_x$ 和 $v = \\cos\\phi_y$。定义域为 $(u,v) \\in [-1, 1] \\times [-1, 1]$。我们有 $\\sin\\phi_x = \\sigma_x \\sqrt{1-u^2}$ 和 $\\sin\\phi_y = \\sigma_y \\sqrt{1-v^2}$，其中 $\\sigma_x, \\sigma_y \\in \\{\\pm 1\\}$。为了找到最大值，我们必须考虑混合导数项为正的情况，这意味着对 $\\sigma_x, \\sigma_y$ 进行最大化并使用 $|b|$：\n$$\nF(u,v) = \\frac{2a}{\\Delta x^2}(1-u) + \\frac{2c}{\\Delta y^2}(1-v) + \\frac{2|b|}{\\Delta x \\Delta y} \\sqrt{1-u^2}\\sqrt{1-v^2}\n$$\n$F(u,v)$ 的最大值必须出现在 $\\nabla F = 0$ 的内部临界点，或者在定义域 $[-1, 1]^2$ 的边界上。\n偏导数为：\n$$\n\\frac{\\partial F}{\\partial u} = -\\frac{2a}{\\Delta x^2} - \\frac{2|b|}{\\Delta x \\Delta y} \\frac{u}{\\sqrt{1-u^2}}\\sqrt{1-v^2}\n$$\n$$\n\\frac{\\partial F}{\\partial v} = -\\frac{2c}{\\Delta y^2} - \\frac{2|b|}{\\Delta x \\Delta y} \\frac{v}{\\sqrt{1-v^2}}\\sqrt{1-u^2}\n$$\n对于 $u,v \\in (-1, 1)$，将这些偏导数设为零需要 $u0$ 和 $v0$。将所得方程相乘得到 $uv = (ac)/b^2$。然而，问题陈述了 $ac-b^2  0$，这意味着 $(ac)/b^2  1$。由于 $u,v \\in (-1, 1)$，它们的乘积 $|uv|$ 必须小于 1。因此，条件 $uv = ac/b^2  1$ 在定义域内部没有解。\n\n因此，最大值必须位于 $u=\\pm 1$ 或 $v=\\pm 1$ 的边界上。在边界上，其中一个平方根项会消失。例如，如果 $u=-1$（对应于 $\\phi_x = \\pm \\pi$），函数变为 $F(-1, v) = \\frac{4a}{\\Delta x^2} + \\frac{2c}{\\Delta y^2}(1-v)$。这是一个关于 $v$ 的线性函数，在 $v=-1$（即 $\\phi_y = \\pm \\pi$）时取最大值。\n边界上的最大值在角点 $(u,v) = (-1,-1)$ 处取得：\n$$\n\\max F(u,v) = F(-1,-1) = \\frac{2a}{\\Delta x^2}(1-(-1)) + \\frac{2c}{\\Delta y^2}(1-(-1)) + 0 = \\frac{4a}{\\Delta x^2} + \\frac{4c}{\\Delta y^2}\n$$\n这对应于奈奎斯特频率 $k_x \\Delta x = \\pm\\pi$ 和 $k_y \\Delta y = \\pm\\pi$。在这些频率下，$\\sin(\\phi_x)\\sin(\\phi_y)$ 项为零。\n因此，$S(k_x, k_y)$ 的最大值为：\n$$\n\\max_{k_x, k_y} S(k_x, k_y) = \\frac{4a}{\\Delta x^2} + \\frac{4c}{\\Delta y^2}\n$$\n将此代入最大稳定时间步长的表达式中，得到：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\frac{4a}{\\Delta x^2} + \\frac{4c}{\\Delta y^2}} = \\frac{1}{2\\left(\\frac{a}{\\Delta x^2} + \\frac{c}{\\Delta y^2}\\right)}\n$$\n简化此表达式可得到最终结果：\n$$\n\\Delta t_{\\max} = \\frac{1}{2\\left(\\frac{a\\Delta y^2 + c\\Delta x^2}{\\Delta x^2 \\Delta y^2}\\right)} = \\frac{\\Delta x^2 \\Delta y^2}{2(a \\Delta y^2 + c \\Delta x^2)}\n$$\n值得注意的是，混合导数系数 $b$ 没有出现在最终的稳定性限制中。这是因为当二阶导数的符号达到最大值时，混合导数的中心差分模板的傅里叶符号为零。",
            "answer": "$$\n\\boxed{\\frac{\\Delta x^{2} \\Delta y^{2}}{2(a \\Delta y^{2} + c \\Delta x^{2})}}\n$$"
        },
        {
            "introduction": "最后，我们来解决一个将扩散与非线性反应项相结合的问题，这种情况在从生物学到材料科学的许多领域都很常见。通过一个面包褐变的模型，这个练习要求在应用稳定性分析之前，围绕一个稳态对非线性方程进行线性化。练习的高潮部分是一个编程任务，从而搭建了从理论推导到实际实现的桥梁，这是任何计算物理学家都必须掌握的一项关键技能。",
            "id": "2441809",
            "problem": "一块薄的矩形面包片被理想化为一个二维薄片。令 $b(x,y,t)$ 表示一个无量纲的褐变指数，其中 $b \\in [0,1]$。一个用于描述 $b$ 演化的最小模型，耦合了反应前体的平面内扩散与自催化的 Maillard 反应。其控制偏微分方程 (PDE) 为\n$$\n\\frac{\\partial b}{\\partial t} = D \\nabla^2 b + k\\, b\\,(1-b),\n$$\n其中 $D$ 是有效扩散系数（单位为 $\\mathrm{m^2/s}$），$k$ 是动力学速率（单位为 $\\mathrm{s^{-1}}$）。考虑一个间距为 $h$（单位为 $\\mathrm{m}$）的均匀方形网格，时间步长为 $\\Delta t$（单位为 $\\mathrm{s}$），以及使用拉普拉斯算子标准五点模板的显式前向 Euler 有限差分格式：\n$$\nb_{i,j}^{n+1} = b_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(b_{i+1,j}^{n} + b_{i-1,j}^{n} + b_{i,j+1}^{n} + b_{i,j-1}^{n} - 4 b_{i,j}^{n}\\right) + k\\, b_{i,j}^{n}\\left(1 - b_{i,j}^{n}\\right)\\right].\n$$\n分析此显式格式在空间均匀稳态 $b^\\star = 1$ 附近的线性稳定性，并确定在给定 $D$、$k$ 和 $h$ 的情况下，保证线性化格式稳定性的最大允许时间步长 $\\Delta t_{\\max}$（单位为 $\\mathrm{s}$）。您的程序必须为下面测试套件中的每一组参数计算 $\\Delta t_{\\max}$，并以秒为单位的十进制数形式输出结果。\n\n测试套件（每个案例是一个三元组 $(D,k,h)$，其中 $D$ 的单位为 $\\mathrm{m^2/s}$，$k$ 的单位为 $\\mathrm{s^{-1}}$，$h$ 的单位为 $\\mathrm{m}$）：\n- 案例 1：$(D,k,h) = \\left(1.0\\times 10^{-6},\\, 5.0\\times 10^{-1},\\, 1.0\\times 10^{-3}\\right)$。\n- 案例 2：$(D,k,h) = \\left(1.0\\times 10^{-6},\\, 0.0,\\, 1.0\\times 10^{-3}\\right)$。\n- 案例 3：$(D,k,h) = \\left(0.0,\\, 2.0,\\, 1.0\\times 10^{-3}\\right)$。\n- 案例 4：$(D,k,h) = \\left(1.0\\times 10^{-6},\\, 5.0\\times 10^{-1},\\, 5.0\\times 10^{-4}\\right)$。\n- 案例 5：$(D,k,h) = \\left(5.0\\times 10^{-7},\\, 2.0\\times 10^{-1},\\, 2.0\\times 10^{-3}\\right)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，没有空格，结果按上述案例的顺序排列，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是以秒为单位的十进制数 $\\Delta t_{\\max}$。",
            "solution": "所提交的问题已按规定进行验证。根据既定协议提取并分析了给定条件。该问题描述了一个标准的反应扩散系统，具体来说是 Fisher-KPP 方程，及其使用显式有限差分法的数值解法。任务是执行线性稳定性分析，这是计算物理学中的一个典型步骤。经审查，该问题在科学上是合理的、适定的和完整的，因此被认定为有效。我们开始求解。\n\n目标是通过对空间均匀稳态 $b^\\star = 1$ 进行线性稳定性分析，来确定所给显式有限差分格式的最大允许时间步长 $\\Delta t_{\\max}$。\n\n控制偏微分方程为：\n$$\n\\frac{\\partial b}{\\partial t} = D \\nabla^2 b + k\\, b\\,(1-b)\n$$\n显式前向 Euler 格式由下式给出：\n$$\nb_{i,j}^{n+1} = b_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(b_{i+1,j}^{n} + b_{i-1,j}^{n} + b_{i,j+1}^{n} + b_{i,j-1}^{n} - 4 b_{i,j}^{n}\\right) + k\\, b_{i,j}^{n}\\left(1 - b_{i,j}^{n}\\right)\\right]\n$$\n为了分析线性稳定性，我们在稳态 $b^\\star = 1$ 附近引入一个小扰动 $\\epsilon_{i,j}^n$，使得 $b_{i,j}^n = b^\\star + \\epsilon_{i,j}^n = 1 + \\epsilon_{i,j}^n$。\n\n非线性反应项 $f(b) = k\\, b\\,(1-b)$ 必须在 $b^\\star=1$ 附近进行线性化。其一阶导数为 $f'(b) = k(1 - 2b)$。在稳态时，$f'(1) = k(1 - 2(1)) = -k$。$f(b)$ 在 $b^\\star=1$ 附近的泰勒展开为 $f(1+\\epsilon) = f(1) + f'(1)\\epsilon + \\mathcal{O}(\\epsilon^2)$。由于 $f(1)=0$，对于小的 $\\epsilon$，我们有 $k(1+\\epsilon)(1-(1+\\epsilon)) = k(1+\\epsilon)(-\\epsilon) = -k\\epsilon - k\\epsilon^2 \\approx -k\\epsilon$。\n\n将 $b_{i,j}^n = 1 + \\epsilon_{i,j}^n$ 代入数值格式并仅保留 $\\epsilon$ 的线性项，得到扰动的演化方程：\n$$\n1 + \\epsilon_{i,j}^{n+1} = 1 + \\epsilon_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(\\epsilon_{i+1,j}^{n} + \\epsilon_{i-1,j}^{n} + \\epsilon_{i,j+1}^{n} + \\epsilon_{i,j-1}^{n} - 4\\epsilon_{i,j}^{n}\\right) - k\\epsilon_{i,j}^{n}\\right]\n$$\n从两边减去 $1$，我们得到线性化差分方程：\n$$\n\\epsilon_{i,j}^{n+1} = \\epsilon_{i,j}^{n} + \\frac{D\\Delta t}{h^2}\\left(\\epsilon_{i+1,j}^{n} + \\epsilon_{i-1,j}^{n} + \\epsilon_{i,j+1}^{n} + \\epsilon_{i,j-1}^{n} - 4\\epsilon_{i,j}^{n}\\right) - k\\Delta t\\epsilon_{i,j}^{n}\n$$\n现在我们应用 von Neumann 稳定性分析。我们考虑扰动的单个傅里叶模式：\n$$\n\\epsilon_{i,j}^n = A^n e^{\\mathrm{i}(k_x i h + k_y j h)}\n$$\n其中 $A^n$ 是在时间步长 $n$ 时的振幅，$\\mathrm{i}$ 是虚数单位，$k_x, k_y$ 是波数。将此代入线性化方程并除以 $e^{\\mathrm{i}(k_x i h + k_y j h)}$，得到放大因子 $G = A^{n+1}/A^n$：\n$$\nG = 1 + \\frac{D\\Delta t}{h^2}\\left(e^{\\mathrm{i}k_x h} + e^{-\\mathrm{i}k_x h} + e^{\\mathrm{i}k_y h} + e^{-\\mathrm{i}k_y h} - 4\\right) - k\\Delta t\n$$\n使用恒等式 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$，我们简化表达式：\n$$\nG = 1 + \\frac{2D\\Delta t}{h^2}\\left(\\cos(k_x h) + \\cos(k_y h) - 2\\right) - k\\Delta t\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们可以将其重写为：\n$$\nG = 1 - \\frac{4D\\Delta t}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) - k\\Delta t\n$$\n为使格式稳定，放大因子的模对于所有可能的波数都不能超过 1，即 $|G| \\le 1$。由于 $G$ 是纯实数，此条件等价于 $-1 \\le G \\le 1$。\n\n第一个条件：$G \\le 1$。\n$$\n1 - \\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\le 1\n$$\n$$\n-\\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\le 0\n$$\n鉴于 $D \\ge 0$，$k \\ge 0$，$\\Delta t > 0$，且包含正弦的项是非负的，这个不等式总是成立的。该条件对 $\\Delta t$ 没有施加任何限制。\n\n第二个条件：$G \\ge -1$。\n$$\n1 - \\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\ge -1\n$$\n$$\n2 \\ge \\Delta t \\left[ k + \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) \\right]\n$$\n$$\n\\Delta t \\le \\frac{2}{k + \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right)}\n$$\n这个不等式必须对所有波数 $(k_x, k_y)$ 成立。为了找到对 $\\Delta t$ 最严格的条件，我们必须找到右侧的最小值。这发生在分母最大化时。项 $S = \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)$ 的最大值出现在 $k_x h = \\pi$ 和 $k_y h = \\pi$ 时，这对应于最高频率（棋盘格）模式。在这种情况下，$S = \\sin^2(\\pi/2) + \\sin^2(\\pi/2) = 1 + 1 = 2$。\n\n将 $S=2$ 代入不等式，得到适用于所有模式的稳定性约束：\n$$\n\\Delta t \\le \\frac{2}{k + \\frac{4D}{h^2}(2)}\n$$\n因此，为使线性化格式稳定，最大允许时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{k + \\frac{8D}{h^2}}\n$$\n该公式正确地恢复了二维热方程的已知稳定性极限 $\\Delta t \\le h^2/(4D)$（当 $k=0$ 时），以及逻辑斯谛方程的极限 $\\Delta t \\le 2/k$（当 $D=0$ 时）。有了这个公式，我们就可以计算给定测试案例所需的值了。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable time step for a 2D reaction-diffusion\n    equation discretized with an explicit finite-difference scheme.\n    \"\"\"\n    # Test suite: each case is a tuple (D, k, h)\n    # D: diffusion coefficient in m^2/s\n    # k: kinetic rate in s^-1\n    # h: grid spacing in m\n    test_cases = [\n        (1.0e-6, 5.0e-1, 1.0e-3),\n        (1.0e-6, 0.0, 1.0e-3),\n        (0.0, 2.0, 1.0e-3),\n        (1.0e-6, 5.0e-1, 5.0e-4),\n        (5.0e-7, 2.0e-1, 2.0e-3),\n    ]\n\n    results = []\n    for D, k, h in test_cases:\n        # The stability condition for the linearized scheme is derived as:\n        # delta_t_max = 2 / (k + 8*D / h^2)\n        \n        # Check for division by zero, although not expected with given test cases.\n        # The denominator is zero only if both D and k are zero.\n        denominator = k + (8.0 * D) / (h**2)\n        \n        if denominator == 0:\n            # For D=0 and k=0, the equation is db/dt = 0, which is stable\n            # for any dt. The result is effectively infinite.\n            # However, this case is not in the test suite and the problem\n            # context implies a finite, positive denominator.\n            # We would need a problem-specific rule for this edge case.\n            # For now, we assume denominator > 0.\n            pass\n\n        delta_t_max = 2.0 / denominator\n        results.append(delta_t_max)\n\n    # Format the output as a comma-separated list in brackets, with no spaces.\n    print(f\"[{','.join(f'{r:.17g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}