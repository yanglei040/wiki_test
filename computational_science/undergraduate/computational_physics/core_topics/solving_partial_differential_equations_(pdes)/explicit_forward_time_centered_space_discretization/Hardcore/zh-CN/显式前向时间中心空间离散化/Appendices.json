{
    "hands_on_practices": [
        {
            "introduction": "理论是基础，但真正的理解始于实践。我们的第一个练习  将引导您完成应用 FTCS（前向时间中心空间）方法的核心计算。通过为一个一维热棒模型手动计算单个时间步长后的温度，您将固化对离散化更新规则如何工作的理解，并为更复杂的模拟打下坚实的基础。",
            "id": "2171711",
            "problem": "一个用于原型电子设备散热的导热条，被建模为长度为 $L = 0.5$ 米的一维杆。该杆具有均匀的热扩散系数 $\\alpha = 1.2 \\times 10^{-5}$ m$^2$/s。杆的两端连接到大型散热器，保持恒定温度 $0$ °C，因此对于所有时间 $t \\ge 0$，边界条件为 $u(0, t) = 0$ °C 和 $u(L, t) = 0$ °C。\n\n在时间 $t=0$ 时，设备被短暂激活，沿杆产生初始温度分布，由函数 $u(x, 0) = 1600x(L-x)$ 给出，其中 $x$ 是沿杆的位置，单位为米。\n\n为了分析冷却过程，需要使用有限差分法对一维热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$ 进行数值求解。空间域 $[0, L]$ 被离散化为 $N=5$ 个相等的部分，创建了一个网格点集 $x_i = i \\Delta x$，其中 $i=0, 1, \\dots, 5$。模拟以固定的时间步长 $\\Delta t = 200$ s 进行。\n\n计算第一个时间步长 $t_1 = \\Delta t$ 后，在第一个内部网格点 $x_1$ 处的温度。答案以摄氏度为单位，四舍五入到三位有效数字。",
            "solution": "我们用一维热方程 $\\frac{\\partial u}{\\partial t}=\\alpha \\frac{\\partial^{2}u}{\\partial x^{2}}$ 在 $[0,L]$ 上对温度演化进行建模，其狄利克雷边界条件为对所有 $t\\ge 0$，$u(0,t)=0$ 和 $u(L,t)=0$，初始条件为 $u(x,0)=1600\\,x(L-x)$。空间区间被分为 $N=5$ 个相等的部分，得到网格点 $x_{i}=i\\Delta x$，其中 $i=0,1,\\dots,5$，且 $\\Delta x=\\frac{L}{N}$。使用显式前向时间、中心空间 (FTCS) 有限差分格式，内部节点的更新公式为\n$$\nu_{i}^{n+1}=u_{i}^{n}+r\\left(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}\\right),\n$$\n其中 $r=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}$。边界值满足对所有 $n$，$u_{0}^{n}=0$ 和 $u_{5}^{n}=0$。\n\n计算空间步长：\n$$\n\\Delta x=\\frac{L}{N}=\\frac{0.5}{5}=0.1.\n$$\n计算稳定性参数：\n$$\nr=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}=\\frac{\\left(1.2\\times 10^{-5}\\right)\\cdot 200}{(0.1)^{2}}=\\frac{1.2\\times 10^{-5}\\cdot 200}{0.01}=0.24.\n$$\n初始离散温度为 $u_{i}^{0}=u(x_{i},0)=1600\\,x_{i}\\left(L-x_{i}\\right)$，其中 $x_{i}=i\\cdot 0.1$。具体来说，\n$$\nu_{0}^{0}=0,\\quad u_{1}^{0}=1600\\cdot 0.1\\cdot(0.5-0.1)=64,\\quad u_{2}^{0}=1600\\cdot 0.2\\cdot(0.5-0.2)=96.\n$$\n对第一个时间步长，在第一个内部点 $i=1$ 处应用 FTCS 更新公式：\n$$\nu_{1}^{1}=u_{1}^{0}+r\\left(u_{2}^{0}-2u_{1}^{0}+u_{0}^{0}\\right)=64+0.24\\left(96-2\\cdot 64+0\\right)=64+0.24\\cdot(-32)=64-7.68=56.32.\n$$\n四舍五入到三位有效数字，第一个时间步长后 $x_{1}$ 处的温度为 $56.3$ 摄氏度。",
            "answer": "$$\\boxed{56.3}$$"
        },
        {
            "introduction": "在掌握了单步计算之后，我们必须面对数值模拟中的一个核心挑战：稳定性。一个不稳定的方案会产生无意义的、爆炸性的结果。这个练习  探讨了著名的稳定性条件，该条件将时间步长 $\\Delta t$ 与空间步长 $\\Delta x$ 联系起来。通过分析改变网格分辨率对最大允许时间步长的影响，您将学到在计算物理中一个至关重要的权衡法则。",
            "id": "2164702",
            "problem": "一位工程师正在模拟一根用于热管理系统的细长一维杆的散热情况。该模拟使用显式数值方法来求解热扩散控制方程。已知这种数值格式的稳定性受时间步长和空间网格尺寸之间的关系制约，这通常被称为 Courant-Friedrichs-Lewy (CFL) 条件。\n\n在一次初始模拟中，工程师使用的空间网格间距为 $\\Delta x_1 = 0.12$ m。在此设置下，为保持解的稳定，确定的最大允许时间步长为 $\\Delta t_1 = 1.0 \\times 10^{-3}$ s。\n\n为了获得更详细的温度分布，工程师使用更精细的网格重新进行了模拟，其空间间距减小到 $\\Delta x_2 = 0.07$ m。假设模拟始终在稳定性条件所允许的最大时间步长下运行，请计算新的最大时间步长 $\\Delta t_2$。\n\n将 $\\Delta t_2$ 的答案以秒为单位表示，并四舍五入到两位有效数字。",
            "solution": "我们考虑使用显式前向时间中心差分 (FTCS) 格式求解的一维热方程 $ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}} $。此格式的(CFL型)稳定性条件要求无量纲参数\n$$\nr \\equiv \\frac{\\alpha \\,\\Delta t}{(\\Delta x)^{2}} \\leq \\frac{1}{2}.\n$$\n因此，最大稳定时间步长为\n$$\n\\Delta t_{\\max} = \\frac{1}{2}\\,\\frac{(\\Delta x)^{2}}{\\alpha}.\n$$\n对于使用相同材料（即 $\\alpha$ 相同）的两次模拟，最大时间步长与空间步长的平方成正比：\n$$\n\\frac{\\Delta t_{2}}{\\Delta t_{1}} = \\left(\\frac{\\Delta x_{2}}{\\Delta x_{1}}\\right)^{2}.\n$$\n因此，\n$$\n\\Delta t_{2} = \\Delta t_{1}\\left(\\frac{\\Delta x_{2}}{\\Delta x_{1}}\\right)^{2}.\n$$\n代入给定值 $ \\Delta x_{1} = 0.12 $，$ \\Delta t_{1} = 1.0 \\times 10^{-3} $ 和 $ \\Delta x_{2} = 0.07 $（所有单位均为一致的国际单位制单位），\n$$\n\\Delta t_{2} = \\left(1.0 \\times 10^{-3}\\right)\\left(\\frac{0.07}{0.12}\\right)^{2}\n= \\left(1.0 \\times 10^{-3}\\right)\\left(\\frac{7}{12}\\right)^{2}\n= \\left(1.0 \\times 10^{-3}\\right)\\frac{49}{144}.\n$$\n计算数值：\n$$\n\\frac{49}{144} \\approx 0.340277\\ldots,\\quad \\Rightarrow\\quad \\Delta t_{2} \\approx 3.40277\\ldots \\times 10^{-4}.\n$$\n四舍五入到两位有效数字，\n$$\n\\Delta t_{2} \\approx 3.4 \\times 10^{-4}.\n$$",
            "answer": "$$\\boxed{3.4 \\times 10^{-4}}$$"
        },
        {
            "introduction": "现在，让我们将知识从一维理论扩展到二维实践中。这个编程练习  要求您实现一个 FTCS 模拟来研究二维平板上的热扩散。通过精心设置一个违反稳定性条件的场景，您将亲眼目睹经典的“棋盘”不稳定性模式的出现，这是对理论分析一个强有力的视觉证明。这个练习将理论与实际的计算观察联系起来，让抽象概念变得具体可见。",
            "id": "2391393",
            "problem": "考虑二维热方程，该方程模拟了方板上的温度扩散，其偏微分方程为 $u_t = \\alpha \\left(u_{xx} + u_{yy}\\right)$，其中 $u(x,y,t)$ 是温度，$\\alpha$ 是热扩散率，下标表示偏导数，$t$ 表示时间。使用显式时间前向中心空间 (FTCS) 方法，在均匀周期性网格上推进解。该方法在时间上采用前向差分，在空间上采用中心差分。该周期性网格有 $N \\times N$ 个节点，在两个方向上的均匀间距均为 $h$。令 $r = \\alpha \\,\\Delta t / h^2$ 表示无量纲时间步长参数。在两个方向上实现周期性边界条件。不要先验地假设任何稳定性属性；而是通过数值观察其行为。从离散网格上的以下初始条件开始：一个纯正负交替模式 $u_{i,j}^0 = (-1)^{i+j}$，适用于所有网格索引 $i,j$。这是周期性下的最高波数模式。通过重复应用 FTCS 更新来演化此初始条件。您的程序必须执行以下操作：\n- 根据有限差分定义实现 FTCS 离散化：时间层 $n$ 的时间导数用前向差分替换，每个二阶空间导数在均匀网格上用中心差分替换。应用周期性边界条件，使得相邻索引在两个方向的边界处回绕。\n- 对于给定的 $r$、时间步数 $n_{\\text{steps}}$ 和网格大小 $N$，计算比率 $R = \\left|A^{n_{\\text{steps}}}\\right| / \\left|A^0\\right|$，其中 $A^n$ 是时间层 $n$ 上正负交替模式的标量振幅，由离散内积 $A^n = \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} u_{i,j}^n \\, (-1)^{i+j}$ 定义。\n- 使用周期性边界条件以确保此正负交替模式是一个离散傅里叶模式。\n- 输出中不需要物理单位，因为 $R$ 是无量纲的。\n\n测试套件：在以下三个参数集上运行程序，它们共同提供了一个一般情况、一个边界情况和一个违反经典稳定性条件的情况：\n- 情况 1（稳定内部）：$(N, r, n_{\\text{steps}}) = (64, 0.2, 12)$。\n- 情况 2（稳定性边界）：$(N, r, n_{\\text{steps}}) = (64, 0.25, 12)$。\n- 情况 3（不稳定，预期的棋盘式增长）：$(N, r, n_{\\text{steps}}) = (64, 0.3, 12)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按 $[R_1, R_2, R_3]$ 的顺序排列，分别对应情况 1、2 和 3。每个 $R_k$ 必须打印为浮点数，并精确到小数点后六位，例如 $[0.123456,1.000000,9.876543]$。唯一允许的输出是这一行。不允许用户输入或外部文件，所有计算都必须通过编程方式执行。",
            "solution": "问题陈述已经过严格验证，并被确定为有效。它具有科学依据，问题设定良好，客观，并包含进行唯一可验证求解所需的所有必要信息。\n\n控制偏微分方程 (PDE) 是二维热方程：\n$$ u_t = \\alpha \\left(u_{xx} + u_{yy}\\right) $$\n在此，$u(x,y,t)$ 表示空间坐标 $(x,y)$ 和时间 $t$ 处的温度，$\\alpha$ 是热扩散率常数。问题要求使用显式时间前向中心空间 (FTCS) 方法，在大小为 $N \\times N$、空间步长为 $h$、时间步长为 $\\Delta t$ 的均匀周期性网格上进行离散化。\n\n首先，我们对 PDE 进行离散化。时间导数 $u_t$ 在时间层 $n$ 处使用前向差分近似：\n$$ u_t \\approx \\frac{u_{i,j}^{n+1} - u_{i,j}^n}{\\Delta t} $$\n其中 $u_{i,j}^n$ 表示在网格点 $(i,j)$ 和时间步 $n$ 处的数值解。二阶空间导数 $u_{xx}$ 和 $u_{yy}$ 使用中心差分近似：\n$$ u_{xx} \\approx \\frac{u_{i+1,j}^n - 2u_{i,j}^n + u_{i-1,j}^n}{h^2} $$\n$$ u_{yy} \\approx \\frac{u_{i,j+1}^n - 2u_{i,j}^n + u_{i,j-1}^n}{h^2} $$\n将这些近似值代入热方程，得到完整的离散格式：\n$$ \\frac{u_{i,j}^{n+1} - u_{i,j}^n}{\\Delta t} = \\alpha \\left( \\frac{u_{i+1,j}^n - 2u_{i,j}^n + u_{i-1,j}^n}{h^2} + \\frac{u_{i,j+1}^n - 2u_{i,j}^n + u_{i,j-1}^n}{h^2} \\right) $$\n给定无量纲参数 $r = \\alpha \\Delta t / h^2$。通过重新整理方程以求解下一时间步的解 $u_{i,j}^{n+1}$，我们得到 FTCS 更新规则：\n$$ u_{i,j}^{n+1} = u_{i,j}^n + r \\left( u_{i+1,j}^n + u_{i-1,j}^n + u_{i,j+1}^n + u_{i,j-1}^n - 4u_{i,j}^n \\right) $$\n这可以重写为：\n$$ u_{i,j}^{n+1} = (1 - 4r)u_{i,j}^n + r(u_{i+1,j}^n + u_{i-1,j}^n + u_{i,j+1}^n + u_{i,j-1}^n) $$\n问题指定了一个对应于周期性网格上最高波数模式的初始条件：\n$$ u_{i,j}^0 = (-1)^{i+j} $$\n该模式是离散数值算子的一个本征模。为了证明这一点，我们将 $u_{i,j}^0$ 代入更新规则。相邻点的值与中心点的值相差一个因子 $-1$：\n$$ u_{i \\pm 1, j}^0 = (-1)^{i \\pm 1 + j} = -(-1)^{i+j} = -u_{i,j}^0 $$\n$$ u_{i, j \\pm 1}^0 = (-1)^{i + j \\pm 1} = -(-1)^{i+j} = -u_{i,j}^0 $$\n将这些代入第一个时间步的更新规则，得到：\n$$ u_{i,j}^1 = (1 - 4r)u_{i,j}^0 + r(-u_{i,j}^0 - u_{i,j}^0 - u_{i,j}^0 - u_{i,j}^0) = (1 - 4r)u_{i,j}^0 - 4r u_{i,j}^0 = (1 - 8r)u_{i,j}^0 $$\n因此，该模式从一个时间步到下一个时间步的放大因子为 $G = (1 - 8r)$。经过 $n_{\\text{steps}}$ 步后，解为：\n$$ u_{i,j}^{n_{\\text{steps}}} = G^{n_{\\text{steps}}} u_{i,j}^0 = (1 - 8r)^{n_{\\text{steps}}} (-1)^{i+j} $$\n数值格式的稳定性由该放大因子的大小决定。为保证稳定性，我们需要 $|G| \\le 1$。对于这个特定模式，条件是 $|1 - 8r| \\le 1$，这等价于 $0 \\le r \\le 1/4$。这证实了最高波数模式决定了整个格式的稳定性极限。\n\n问题要求计算比率 $R = |A^{n_{\\text{steps}}}| / |A^0|$，其中振幅 $A^n$ 由离散内积定义：\n$$ A^n = \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} u_{i,j}^n \\, (-1)^{i+j} $$\n首先，我们计算初始振幅 $A^0$：\n$$ A^0 = \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} u_{i,j}^0 (-1)^{i+j} = \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} (-1)^{i+j} (-1)^{i+j} = \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} 1 = 1 $$\n接下来，我们计算在 $n_{\\text{steps}}$ 步时的振幅：\n$$ A^{n_{\\text{steps}}} = \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} u_{i,j}^{n_{\\text{steps}}} (-1)^{i+j} = \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} \\left( (1 - 8r)^{n_{\\text{steps}}} (-1)^{i+j} \\right) (-1)^{i+j} $$\n$$ A^{n_{\\text{steps}}} = (1 - 8r)^{n_{\\text{steps}}} \\left( \\frac{1}{N^2}\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} 1 \\right) = (1 - 8r)^{n_{\\text{steps}}} $$\n因此，所需的比率 $R$ 为：\n$$ R = \\frac{|A^{n_{\\text{steps}}}|}{|A^0|} = \\frac{|(1 - 8r)^{n_{\\text{steps}}}|}{|1|} = |1 - 8r|^{n_{\\text{steps}}} $$\n这个解析结果提供了一个精确的理论预测。实现将按要求执行完整的数值模拟，其结果必须与此理论结果高度吻合。\n\n计算流程如下：\n1. 对每个测试用例 $(N, r, n_{\\text{steps}})$，用初始条件 $u_{i,j}^0 = (-1)^{i+j}$ 初始化一个 $N \\times N$ 的网格。\n2. 创建第二个 $N \\times N$ 网格来表示投影模式，$p_{i,j} = (-1)^{i+j}$。\n3. 初始振幅 $A^0$ 通过计算初始网格和投影模式网格的归一化内积得到。其值将精确为 $1.0$。\n4. 循环运行 $n_{\\text{steps}}$ 次迭代。在每次迭代中，将 FTCS 更新规则应用于网格上的每个点。通过对索引使用模运算来处理周期性边界条件，这可以通过使用向量化数组移位（例如 `numpy.roll`）来高效实现。\n5. 循环结束后，以与 $A^0$ 类似的方式计算最终振幅 $A^{n_{\\text{steps}}}$。\n6. 比率 $R$ 计算为 $|A^{n_{\\text{steps}}}| / |A^0|$。\n7. 收集三个情况的结果，并按指定格式打印。这些测试用例探索了稳定区域（$r=0.2$, $|G|=0.61$）、稳定性边界（$r=0.25$, $|G|=1$）和不稳定区域（$r=0.3$, $|G|=1.41$）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 2D heat equation using the FTCS method for a specific initial mode\n    and computes the amplitude ratio over a number of time steps.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (stable interior): (N, r, n_steps)\n        (64, 0.2, 12),\n        # Case 2 (stability boundary): (N, r, n_steps)\n        (64, 0.25, 12),\n        # Case 3 (unstable): (N, r, n_steps)\n        (64, 0.3, 12),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, r, n_steps = case\n\n        # Create the grid and initialize with the alternating-sign mode\n        # u_{i,j}^0 = (-1)^(i+j)\n        i, j = np.meshgrid(np.arange(N), np.arange(N), indexing='ij')\n        u = np.power(-1.0, i + j)\n\n        # This mode is used to project the solution and find the amplitude\n        projector_mode = u.copy()\n        \n        # Calculate the initial amplitude A^0\n        # A^n = (1/N^2) * sum_{i,j} u_{i,j}^n * (-1)^(i+j)\n        A0 = np.sum(u * projector_mode) / (N * N)\n\n        # Evolve the solution for n_steps\n        for _ in range(n_steps):\n            # Apply FTCS update rule using vectorized operations for efficiency\n            # and to handle periodic boundary conditions with np.roll.\n            # u_new = (1 - 4r)u + r*(u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1})\n            \n            # Sum of neighbors with periodic BC\n            neighbors_sum = (\n                np.roll(u, 1, axis=0) + \n                np.roll(u, -1, axis=0) +\n                np.roll(u, 1, axis=1) + \n                np.roll(u, -1, axis=1)\n            )\n            \n            # Update the solution grid\n            u = (1.0 - 4.0 * r) * u + r * neighbors_sum\n\n        # Calculate the final amplitude A^n_steps\n        A_final = np.sum(u * projector_mode) / (N * N)\n\n        # Compute the ratio R = |A^n_steps| / |A^0|\n        # Since A0 is 1.0, this simplifies to |A_final|\n        ratio = np.abs(A_final) / np.abs(A0)\n        \n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    # Each result is a float rounded to exactly six digits after the decimal point.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}