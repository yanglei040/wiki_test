{
    "hands_on_practices": [
        {
            "introduction": "Applying new techniques to equations from fundamental physics is a powerful way to build understanding. This first practice focuses on the Thomas-Fermi equation, which describes the electron cloud in an atom, providing a perfect setting to master the core skill of converting a second-order ODE into a first-order system . This transformation is not just a mathematical trick; it is the standard prerequisite for using the vast majority of numerical ODE solvers.",
            "id": "2433655",
            "problem": "Consider the Thomas–Fermi ordinary differential equation (ODE) for the radial screening function in an atom,\n$$\ny''(x) \\;=\\; x^{-1/2}\\,y(x)^{3/2}\\,, \\quad x>0,\n$$\nsubject to the two-point boundary conditions\n$$\ny(0)\\,=\\,1,\\qquad y(x)\\,\\to\\,0\\ \\text{as}\\ x\\to\\infty,\n$$\nand assume the physically relevant solution satisfies $y(x)>0$ and is monotonically decreasing for $x>0$.\n\n(a) Reduce this second-order ODE to a first-order system by introducing appropriate dependent variables.\n\n(b) To initialize a numerical method at small $x>0$, impose regularity at $x=0$ (finiteness of $y$ and $y'$) and determine the leading coefficient $a$ in the local expansion\n$$\ny(x)\\;=\\;1\\;+\\;a\\,x^{3/2}\\;+\\;o\\!\\left(x^{3/2}\\right)\\quad\\text{as}\\quad x\\to 0^{+}.\n$$\nProvide the value of $a$ as an exact number. No units are required. Your final answer must be a single real number.",
            "solution": "The problem shall first be subjected to rigorous validation.\n\nStep 1: Extract Givens.\nThe problem provides the following information:\n- The ordinary differential equation (ODE) is the Thomas–Fermi equation:\n$$\ny''(x) \\;=\\; x^{-1/2}\\,y(x)^{3/2}\\,,\\quad x > 0\n$$\n- The boundary conditions are:\n$$\ny(0)\\,=\\,1,\\qquad y(x)\\,\\to\\,0\\ \\text{as}\\ x\\to\\infty\n$$\n- The solution is assumed to have the properties: $y(x)>0$ and is monotonically decreasing for $x>0$.\n- Part (a) asks to reduce the second-order ODE to a first-order system.\n- Part (b) posits a local expansion near $x=0$:\n$$\ny(x)\\;=\\;1\\;+\\;a\\,x^{3/2}\\;+\\;o\\!\\left(x^{3/2}\\right)\\quad\\text{as}\\quad x\\to 0^{+}\n$$\nand asks for the determination of the coefficient $a$.\n\nStep 2: Validate Using Extracted Givens.\n- **Scientific Grounding**: The Thomas–Fermi equation is a cornerstone of the semi-classical model of the atom in quantum mechanics. The equation and its boundary conditions are standard and factually correct as presented. The problem is scientifically sound.\n- **Well-Posedness**: The problem is a well-defined boundary value problem. Part (a) is a standard technique in the theory of ODEs. Part (b) addresses the local behavior of the solution near a singular point of the equation, which is a standard analysis in mathematical physics. The existence and uniqueness of the physically relevant solution are well-established. The problem is well-posed.\n- **Objectivity**: The problem is formulated in precise mathematical language, free from any subjective or ambiguous statements.\n- **Completeness and Consistency**: All necessary information (the ODE, boundary conditions, and form of the series) is provided. There are no internal contradictions.\n- **Relation to Topic**: The problem directly addresses the reduction of a higher-order ODE to a first-order system and the analysis of local behavior for numerical initialization, which are fundamental concepts in computational physics.\n\nStep 3: Verdict and Action.\nThe problem is valid. A complete solution will be provided.\n\n**Part (a): Reduction to a First-Order System**\n\nA second-order ordinary differential equation can be transformed into a system of two first-order equations. We introduce a state vector $\\mathbf{u}(x)$ with two components. Let the components be defined as:\n$$\nu_1(x) = y(x)\n$$\n$$\nu_2(x) = y'(x)\n$$\nThe goal is to find expressions for the derivatives of these new variables, $u_1'(x)$ and $u_2'(x)$, in terms of $x$, $u_1(x)$, and $u_2(x)$.\n\nBy definition, the derivative of the first component is:\n$$\nu_1'(x) = \\frac{d}{dx}y(x) = y'(x) = u_2(x)\n$$\nThe derivative of the second component is obtained from the original Thomas–Fermi equation:\n$$\nu_2'(x) = \\frac{d}{dx}y'(x) = y''(x)\n$$\nSubstituting the expression for $y''(x)$ from the given ODE:\n$$\ny''(x) = x^{-1/2} y(x)^{3/2}\n$$\nwe replace $y(x)$ with $u_1(x)$ to obtain:\n$$\nu_2'(x) = x^{-1/2} u_1(x)^{3/2}\n$$\nThus, the second-order ODE is equivalent to the following system of two coupled first-order ODEs:\n$$\n\\begin{cases}\n    u_1'(x) &= u_2(x) \\\\\n    u_2'(x) &= x^{-1/2} u_1(x)^{3/2}\n\\end{cases}\n$$\nIn vector notation, if we define $\\mathbf{u}(x) = \\begin{pmatrix} u_1(x) \\\\ u_2(x) \\end{pmatrix}$, the system is written as $\\mathbf{u}'(x) = \\mathbf{f}(x, \\mathbf{u}(x))$, where:\n$$\n\\mathbf{f}(x, \\mathbf{u}) = \\begin{pmatrix} u_2 \\\\ x^{-1/2} u_1^{3/2} \\end{pmatrix}\n$$\n\n**Part (b): Determination of the Coefficient $a$**\n\nWe are asked to find the coefficient $a$ in the expansion of the solution $y(x)$ near $x=0$:\n$$\ny(x) = 1 + a x^{3/2} + o(x^{3/2})\n$$\nThis expansion must satisfy the Thomas–Fermi equation $y''(x) = x^{-1/2} y(x)^{3/2}$ in the limit $x \\to 0^{+}$.\n\nFirst, we compute the first and second derivatives of the given expansion for $y(x)$.\nThe first derivative is:\n$$\ny'(x) = \\frac{d}{dx} \\left( 1 + a x^{3/2} + o(x^{3/2}) \\right) = a \\frac{3}{2} x^{1/2} + o(x^{1/2})\n$$\nThe second derivative is:\n$$\ny''(x) = \\frac{d}{dx} \\left( a \\frac{3}{2} x^{1/2} + o(x^{1/2}) \\right) = a \\frac{3}{2} \\cdot \\frac{1}{2} x^{-1/2} + o(x^{-1/2}) = \\frac{3a}{4} x^{-1/2} + o(x^{-1/2})\n$$\nSo, the leading term of the left-hand side (LHS) of the ODE as $x \\to 0^{+}$ is $\\frac{3a}{4} x^{-1/2}$.\n\nNext, we analyze the right-hand side (RHS) of the ODE, $x^{-1/2} y(x)^{3/2}$.\nWe substitute the expansion for $y(x)$:\n$$\n\\text{RHS} = x^{-1/2} \\left( 1 + a x^{3/2} + o(x^{3/2}) \\right)^{3/2}\n$$\nFor small values of $z$, the binomial expansion gives $(1+z)^\\alpha \\approx 1 + \\alpha z$. In our case, $z = a x^{3/2} + o(x^{3/2})$ and $\\alpha = 3/2$. As $x \\to 0^{+}$, $z \\to 0$. Therefore, we can expand the term in parentheses:\n$$\n\\left( 1 + a x^{3/2} + o(x^{3/2}) \\right)^{3/2} = 1 + \\frac{3}{2} \\left( a x^{3/2} + o(x^{3/2}) \\right) + \\dots = 1 + \\frac{3a}{2} x^{3/2} + o(x^{3/2})\n$$\nHowever, this detail is not necessary for finding the leading term. The leading behavior of $y(x)$ as $x \\to 0^{+}$ is simply $y(x) \\to 1$, due to the boundary condition $y(0)=1$.\nSo, the leading behavior of the RHS is:\n$$\n\\text{RHS} = x^{-1/2} y(x)^{3/2} \\approx x^{-1/2} \\cdot (1)^{3/2} = x^{-1/2}\n$$\nA more rigorous view of the expansion confirms this:\n$$\nx^{-1/2} \\left( 1 + \\frac{3a}{2} x^{3/2} + o(x^{3/2}) \\right) = x^{-1/2} + \\frac{3a}{2} x + o(x)\n$$\nThe leading term of the RHS as $x \\to 0^{+}$ is $x^{-1/2}$.\n\nTo satisfy the ODE, the leading terms of the LHS and RHS must be equal. We equate the coefficients of the $x^{-1/2}$ term:\n$$\n\\frac{3a}{4} = 1\n$$\nSolving for the coefficient $a$:\n$$\na = \\frac{4}{3}\n$$\nThis value ensures that the series expansion is consistent with the differential equation near the origin. The boundary condition $y(0)=1$ and the regularity condition $y'(0)=0$ are also satisfied by this form of the solution.",
            "answer": "$$\\boxed{\\frac{4}{3}}$$"
        },
        {
            "introduction": "Moving from mathematical mechanics to practical simulation, this exercise traces the full workflow from a fundamental physical law to a computational model. You will start with Fermat's principle of least time to derive the equation for a light ray's path, then convert this second-order ODE into a first-order system for numerical integration . This practice demonstrates how the reduction technique empowers us to visualize and analyze complex physical phenomena like light propagation in graded-index optical materials.",
            "id": "2433582",
            "problem": "A monochromatic light ray propagates in the plane with Cartesian coordinates. The optical path length functional is given by Fermat's principle as the integral $S = \\int n(y)\\,ds$, where $ds = \\sqrt{dx^2 + dy^2}$ and $n(y)$ is the refractive index depending only on the transverse coordinate $y$. Parameterize the ray path as $y(x)$ over the interval $x \\in [0,L]$. The initial position and direction are $y(0) = y_0$ and an initial angle $\\theta_0$ with respect to the positive $x$-axis, which implies $y'(0) = \\tan(\\theta_0)$. Distances must be expressed in meters and angles in radians.\n\nStarting from the functional $S = \\int n(y)\\sqrt{1+y'(x)^2}\\,dx$, obtain the governing ordinary differential equation for $y(x)$ from first principles and reduce it to a first-order system suitable for numerical solution with the state variables $y(x)$ and $v(x) = y'(x)$. For each test case below, compute the transverse position $y(L)$ in meters and the exit angle $\\theta(L)$ in radians at $x = L$.\n\nTest suite (each test case specifies a refractive index profile $n(y)$, its parameters, and the initial and terminal conditions):\n\n- Test case A (baseline, uniform medium):\n  - $n(y) = n_0$ with $n_0 = 1.5$.\n  - $y_0 = 0.0\\,\\mathrm{m}$, $\\theta_0 = 0.1\\,\\mathrm{rad}$, $L = 0.2\\,\\mathrm{m}$.\n\n- Test case B (linear graded index):\n  - $n(y) = n_0 + a\\,y$ with $n_0 = 1.0$ and $a = 0.5\\,\\mathrm{m}^{-1}$.\n  - $y_0 = 0.0\\,\\mathrm{m}$, $\\theta_0 = 0.2\\,\\mathrm{rad}$, $L = 0.5\\,\\mathrm{m}$.\n\n- Test case C (parabolic graded index, small curvature):\n  - $n(y) = n_0\\left(1 - \\dfrac{1}{2}(g\\,y)^2\\right)$ with $n_0 = 1.6$ and $g = 3.0\\,\\mathrm{m}^{-1}$.\n  - $y_0 = 0.01\\,\\mathrm{m}$, $\\theta_0 = -0.15\\,\\mathrm{rad}$, $L = 0.3\\,\\mathrm{m}$.\n\n- Test case D (boundary condition with zero propagation length):\n  - $n(y) = n_0 + a\\,y$ with $n_0 = 1.2$ and $a = 1.0\\,\\mathrm{m}^{-1}$.\n  - $y_0 = 0.02\\,\\mathrm{m}$, $\\theta_0 = 0.3\\,\\mathrm{rad}$, $L = 0.0\\,\\mathrm{m}$.\n\nYour program must output the results for all test cases in a single line, as a comma-separated list enclosed in square brackets. Each test case result must itself be a two-element list $[y(L), \\theta(L)]$ with both values rounded to six decimal places. The final output format must therefore be\n$[[y_A(L), \\theta_A(L)],[y_B(L), \\theta_B(L)],[y_C(L), \\theta_C(L)],[y_D(L), \\theta_D(L)]]$\nwith no additional text.",
            "solution": "The problem statement is scientifically sound, well-posed, and objective. It is based on the fundamental Fermat's principle in optics and the standard mathematical framework of the calculus of variations for deriving equations of motion. All required parameters and conditions are provided for each test case. The problem is a standard exercise in computational physics related to the reduction of higher-order ordinary differential equations (ODEs). Therefore, the problem is valid, and a solution will be provided.\n\nThe objective is to determine the trajectory of a light ray $y(x)$ in a medium with a variable refractive index $n(y)$. According to Fermat's principle, the light ray follows a path that extremizes the optical path length, given by the functional $S$:\n$$\nS[y] = \\int n(y) \\, ds\n$$\nwhere $ds = \\sqrt{dx^2 + dy^2}$ is the infinitesimal arc length. Parameterizing the path as $y(x)$, we can write $ds = \\sqrt{1 + (y'(x))^2} \\, dx$, where $y'(x) = dy/dx$. The functional becomes:\n$$\nS[y] = \\int_{0}^{L} n(y(x)) \\sqrt{1 + (y'(x))^2} \\, dx\n$$\nThis is a classic problem in the calculus of variations. The integrand, $F(y, y') = n(y)\\sqrt{1 + (y')^2}$, is the Lagrangian for the system. The path $y(x)$ that extremizes this integral must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial F}{\\partial y} - \\frac{d}{dx}\\left(\\frac{\\partial F}{\\partial y'}\\right) = 0\n$$\nWe compute the necessary partial derivatives of $F(y, y') = n(y)\\sqrt{1 + (y')^2}$:\n$$\n\\frac{\\partial F}{\\partial y} = \\frac{dn}{dy} \\sqrt{1 + (y')^2} = n'(y) \\sqrt{1 + (y')^2}\n$$\n$$\n\\frac{\\partial F}{\\partial y'} = n(y) \\frac{y'}{\\sqrt{1 + (y')^2}}\n$$\nSubstituting these into the Euler-Lagrange equation gives the ray equation:\n$$\nn'(y) \\sqrt{1 + (y')^2} - \\frac{d}{dx}\\left( \\frac{n(y)y'}{\\sqrt{1 + (y')^2}} \\right) = 0\n$$\nTo obtain an explicit second-order ODE for $y(x)$, we must evaluate the total derivative with respect to $x$. Let us rearrange the equation first:\n$$\n\\frac{d}{dx}\\left( \\frac{n(y)y'}{\\sqrt{1 + (y')^2}} \\right) = n'(y) \\sqrt{1 + (y')^2}\n$$\nBy applying the chain rule to the term being differentiated, $\\frac{d}{dx} = y' \\frac{\\partial}{\\partial y} + y'' \\frac{\\partial}{\\partial y'}$, and then solving for $y''$, we arrive at the following second-order ODE after algebraic simplification:\n$$\ny'' = \\frac{n'(y)}{n(y)} \\left(1 + (y')^2\\right)\n$$\nThis is the governing differential equation for the ray path $y(x)$.\n\nThe next task is to reduce this second-order ODE to a system of two first-order ODEs. We introduce the state variables as requested: $u_1(x) = y(x)$ and $u_2(x) = v(x) = y'(x)$. The state vector is $\\mathbf{u}(x) = [u_1(x), u_2(x)]^T$. We seek a system of the form $d\\mathbf{u}/dx = \\mathbf{f}(x, \\mathbf{u})$.\n\nThe first equation of the system comes directly from the definition of $u_2(x)$:\n$$\n\\frac{du_1}{dx} = \\frac{dy}{dx} = y' = v = u_2\n$$\nThe second equation is obtained by substituting the state variables into the governing ODE:\n$$\n\\frac{du_2}{dx} = \\frac{dv}{dx} = y'' = \\frac{n'(y)}{n(y)} (1 + (y')^2) = \\frac{n'(u_1)}{n(u_1)} (1 + u_2^2)\n$$\nThus, the first-order system is:\n$$\n\\frac{d}{dx}\\begin{pmatrix} y \\\\ v \\end{pmatrix} = \\begin{pmatrix} v \\\\ \\frac{n'(y)}{n(y)}(1+v^2) \\end{pmatrix}\n$$\nThe initial conditions at $x=0$ are given as $y(0) = y_0$ and an angle $\\theta_0$ with the x-axis. The initial slope is $y'(0) = v(0) = \\tan(\\theta_0)$. The initial state vector for the numerical integration is therefore:\n$$\n\\mathbf{u}(0) = \\begin{pmatrix} y(0) \\\\ v(0) \\end{pmatrix} = \\begin{pmatrix} y_0 \\\\ \\tan(\\theta_0) \\end{pmatrix}\n$$\nThis initial value problem can be solved numerically from $x=0$ to $x=L$ using standard methods like the Runge-Kutta family. After integrating, we obtain the final state vector $\\mathbf{u}(L) = [y(L), v(L)]^T$. The final transverse position is $y(L)$. The final angle $\\theta(L)$ is found from the final slope $v(L) = y'(L) = \\tan(\\theta(L))$, which gives $\\theta(L) = \\arctan(v(L))$.\n\nFor each test case, the appropriate functions for $n(y)$ and its derivative $n'(y) = dn/dy$ must be supplied to the system.\n- Case A ($n(y)=n_0$): $n'(y) = 0$. The system becomes $y' = v$, $v' = 0$. This yields $v(x) = v_0$ and $y(x) = y_0 + v_0 x$, representing a straight line, which is solved analytically.\n- Case B ($n(y)=n_0 + a\\,y$): $n'(y) = a$.\n- Case C ($n(y)=n_0(1 - \\frac{1}{2}(g\\,y)^2)$): $n'(y) = -n_0 g^2 y$.\n- Case D ($L=0$): This is a trivial case where the propagation distance is zero, so the final state is identical to the initial state. $y(L)=y(0)$ and $\\theta(L)=\\theta(0)$.\n\nCases B and C do not generally have simple analytical solutions and require numerical integration. The provided program will implement a numerical solver for these cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Solves the ray equation for different refractive index profiles.\n    Derives the ODE from Fermat's principle, reduces it to a first-order system,\n    and solves it numerically for the given test cases.\n    \"\"\"\n\n    # Define refractive index functions and their derivatives for each case\n    def n_A(y, n0, **kwargs):\n        return n0\n\n    def dn_dy_A(y, n0, **kwargs):\n        return 0.0\n\n    def n_B_D(y, n0, a, **kwargs):\n        return n0 + a * y\n\n    def dn_dy_B_D(y, n0, a, **kwargs):\n        return a\n    \n    def n_C(y, n0, g, **kwargs):\n        return n0 * (1.0 - 0.5 * (g * y)**2)\n\n    def dn_dy_C(y, n0, g, **kwargs):\n        return -n0 * g**2 * y\n\n    def ray_ode_system(x, u, n_func, dn_dy_func, params):\n        \"\"\"\n        Defines the first-order system for the ray equation.\n        u = [y, v], where v = y'.\n        y'' = (n'(y)/n(y)) * (1 + (y')^2)\n        \"\"\"\n        y, v = u\n        \n        n_val = n_func(y, **params)\n        dn_dy_val = dn_dy_func(y, **params)\n        \n        # Avoid potential division by zero, though not expected for these test cases.\n        if abs(n_val) < 1e-12:\n            # At n=0, physics is singular. Stop integration.\n            # Here we can return a large number to signify an error or NaN.\n            # However, for given parameters, n(y) is always positive.\n            dv_dx = np.nan\n        else:\n            dv_dx = (dn_dy_val / n_val) * (1.0 + v**2)\n            \n        return [v, dv_dx]\n\n    test_cases = [\n        {'id': 'A', 'n_func': n_A, 'dn_dy_func': dn_dy_A, 'params': {'n0': 1.5}, 'y0': 0.0, 'theta0': 0.1, 'L': 0.2},\n        {'id': 'B', 'n_func': n_B_D, 'dn_dy_func': dn_dy_B_D, 'params': {'n0': 1.0, 'a': 0.5}, 'y0': 0.0, 'theta0': 0.2, 'L': 0.5},\n        {'id': 'C', 'n_func': n_C, 'dn_dy_func': dn_dy_C, 'params': {'n0': 1.6, 'g': 3.0}, 'y0': 0.01, 'theta0': -0.15, 'L': 0.3},\n        {'id': 'D', 'n_func': n_B_D, 'dn_dy_func': dn_dy_B_D, 'params': {'n0': 1.2, 'a': 1.0}, 'y0': 0.02, 'theta0': 0.3, 'L': 0.0},\n    ]\n\n    output_parts = []\n    \n    for case in test_cases:\n        y0, theta0, L = case['y0'], case['theta0'], case['L']\n        v0 = np.tan(theta0)\n\n        y_L = 0.0\n        theta_L = 0.0\n\n        if L == 0.0:\n            # Case D: Zero propagation distance, final state is initial state\n            y_L = y0\n            theta_L = theta0\n        elif case['id'] == 'A':\n            # Case A: Uniform medium, analytical solution (straight line)\n            # v' = 0 -> v(x) = v0. y' = v0 -> y(x) = y0 + v0*x\n            y_L = y0 + L * v0\n            theta_L = theta0\n        else:\n            # Cases B and C: Numerical integration\n            initial_state = [y0, v0]\n            \n            sol = solve_ivp(\n                ray_ode_system,\n                [0.0, L],\n                initial_state,\n                args=(case['n_func'], case['dn_dy_func'], case['params']),\n                method='DOP853',  # A high-accuracy solver\n                rtol=1e-9,\n                atol=1e-12\n            )\n            \n            y_L, v_L = sol.y[:, -1]\n            theta_L = np.arctan(v_L)\n\n        # Format each result as a string '[y,theta]' with 6 decimal places.\n        y_L_str = f\"{y_L:.6f}\"\n        theta_L_str = f\"{theta_L:.6f}\"\n        output_parts.append(f\"[{y_L_str},{theta_L_str}]\")\n\n    # Combine all results into the final required format.\n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice tackles a more advanced and conceptually deep problem from classical electrodynamics: the motion of an electron including the effects of its own radiation. This exercise involves reducing a third-order ODE and confronts the challenge of unphysical \"runaway\" solutions, which requires careful physical reasoning to formulate a well-posed problem for numerical simulation . Successfully solving it showcases the synergy between physical insight and numerical strategy that is central to computational physics.",
            "id": "2433622",
            "problem": "Consider a nonrelativistic point electron moving along one spatial dimension under a prescribed external electric field $E(t)$ in the absence of magnetic fields. The electron has charge $q=-e$ and mass $m=m_e$. The Abraham–Lorentz radiation-reaction model states that the net force equals the sum of the external force and a radiation-reaction term proportional to the time derivative of acceleration. Starting from Newton's second law and the radiation-reaction model, the governing equation for the position $x(t)$ is a third-order ordinary differential equation in time, involving $x(t)$, $\\dot{x}(t)$, $\\ddot{x}(t)$, and $\\dddot{x}(t)$. Your tasks are:\n\n- Derive a first-order system of ordinary differential equations equivalent to this third-order equation by introducing appropriate state variables. Clearly identify the state variables, their physical meanings, and their first-order time derivatives in terms of each other and the external field.\n- Explain and adopt a physically motivated boundary condition that removes runaway (exponentially growing) solutions, and state how it changes the well-posedness of the problem.\n- Implement a robust numerical strategy based on this first-order system to compute the final position $x(T)$ for several prescribed external fields. Your implementation must be a complete, runnable program, with no user input, that numerically integrates the required system and prints the requested results in the exact format described below.\n\nFundamental base and constants to use:\n- Newton's second law: $m\\,\\ddot{x}(t)=F_{\\text{net}}(t)$.\n- External electric force: $F_{\\text{ext}}(t)=q\\,E(t)$.\n- Abraham–Lorentz radiation-reaction model: $F_{\\text{rr}}(t)=m\\,\\tau\\,\\dot{a}(t)$, where $a(t)=\\ddot{x}(t)$ and $\\tau$ is a constant given by\n$$\n\\tau=\\frac{2\\,e^2}{3\\,4\\pi\\,\\varepsilon_0\\,m\\,c^3}.\n$$\n- Physical constants in the International System of Units (SI) to be used numerically in your code:\n    - Elementary charge $e=1.602176634\\times 10^{-19}$ coulombs.\n    - Electron mass $m_e=9.1093837015\\times 10^{-31}$ kilograms.\n    - Vacuum permittivity $\\varepsilon_0=8.8541878128\\times 10^{-12}$ farads per meter.\n    - Speed of light $c=299792458$ meters per second.\n\nInitial and boundary conditions:\n- Use $x(0)=0$ meters and $\\dot{x}(0)=0$ meters per second.\n- Impose the physically acceptable, non-runaway condition that $a(t)\\to 0$ as $t\\to +\\infty$. For practical computation, enforce $a(T)=0$ at a sufficiently large finite time $T$ where $E(t)$ is negligible.\n\nNumerical strategy requirements:\n- To obtain a stable and accurate computation that respects the non-runaway condition, reduce the third-order equation to a first-order system in the variables $x(t)$, $v(t)=\\dot{x}(t)$, and $a(t)=\\ddot{x}(t)$. Then, exploit the fact that the equation for $a(t)$ is linear and first order in time to compute $a(t)$ on $[0,T]$ subject to $a(T)=0$ and the given $E(t)$. Next, compute $v(t)$ and $x(t)$ on $[0,T]$ using their definitions in terms of $a(t)$. You may use any scientifically sound discretization and ordinary differential equation integration method consistent with the above physical requirements.\n- Angles are not used; no angle unit specification is needed.\n- All reported positions must be expressed in meters.\n\nTest suite:\nYour program must compute $x(T)$ for each of the following three external fields. In each case, define the characteristic Abraham–Lorentz time $\\tau$ from the constants above, and use it to construct the fields and the final time $T$. Let $U=\\frac{T}{\\tau}$ denote the dimensionless final time.\n\n1. Gaussian pulse (happy-path smooth pulse):\n   - Electric field: $E(t)=E_0\\exp\\!\\left(-\\dfrac{(t-t_c)^2}{2\\,\\sigma^2}\\right)$.\n   - Parameters: $E_0=1.0\\times 10^6$ volts per meter, $t_c=10\\,\\tau$, $\\sigma=3\\,\\tau$, $U=40$, so $T=U\\,\\tau$.\n\n2. Damped sinusoid (oscillatory forcing with decay):\n   - Electric field: $E(t)=E_0\\,\\sin(\\omega t)\\,\\exp\\!\\left(-\\dfrac{t}{T_{\\text{env}}}\\right)$.\n   - Parameters: $E_0=1.0\\times 10^6$ volts per meter, $\\omega=\\dfrac{0.2}{\\tau}$ radians per second, $T_{\\text{env}}=15\\,\\tau$, $U=60$, so $T=U\\,\\tau$.\n\n3. Zero field (edge case):\n   - Electric field: $E(t)=0$ for all $t$.\n   - Parameters: $U=10$, so $T=U\\,\\tau$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, namely $[x_1,x_2,x_3]$, where $x_k$ is the final position $x(T)$ in meters for test case $k$, represented as a floating-point decimal number with standard string formatting (no units in the printout).",
            "solution": "The problem statement has been analyzed and is deemed valid. It is a well-posed problem in computational physics, based on established, albeit simplified, principles of classical electrodynamics. The formulation is self-contained, objective, and provides all necessary information for a unique solution under the prescribed physical boundary condition. I will now proceed with the derivation and construction of the numerical solution.\n\nThe motion of the nonrelativistic electron is governed by Newton's second law, where the net force is the sum of the external electric force and the Abraham-Lorentz radiation-reaction force. The equation is:\n$$\nm\\,\\ddot{x}(t) = F_{\\text{net}}(t) = F_{\\text{ext}}(t) + F_{\\text{rr}}(t)\n$$\nHere, $m$ is the electron mass, $x(t)$ is its position, $F_{\\text{ext}}(t) = q\\,E(t)$ is the external force from the electric field $E(t)$ with charge $q=-e$, and $F_{\\text{rr}}(t) = m\\,\\tau\\,\\dot{a}(t)$ is the radiation-reaction force. The quantity $a(t) = \\ddot{x}(t)$ is the acceleration, and $\\tau = \\frac{2\\,e^2}{3\\,4\\pi\\,\\varepsilon_0\\,m\\,c^3}$ is the characteristic time constant of the radiation reaction. Substituting these expressions yields the governing equation:\n$$\nm\\,\\ddot{x}(t) = q\\,E(t) + m\\,\\tau\\,\\dddot{x}(t)\n$$\nThis is a third-order linear ordinary differential equation for the position $x(t)$. It is customary to write it with the highest derivative isolated:\n$$\n\\dddot{x}(t) - \\frac{1}{\\tau}\\ddot{x}(t) = \\frac{q}{m\\,\\tau}E(t)\n$$\n\nTo solve this equation numerically, we reduce it to a system of first-order differential equations. We introduce a state vector $\\mathbf{y}(t)$ whose components are the physically meaningful quantities of position, velocity, and acceleration. Let the state variables be:\n- $y_1(t) = x(t)$: position\n- $y_2(t) = v(t) = \\dot{x}(t)$: velocity\n- $y_3(t) = a(t) = \\ddot{x}(t)$: acceleration\n\nThe first-order time derivatives of these state variables are then expressed in terms of the state variables themselves and the external forcing function $E(t)$. The first two are definitions:\n$$\n\\dot{y}_1(t) = \\dot{x}(t) = v(t) = y_2(t)\n$$\n$$\n\\dot{y}_2(t) = \\dot{v}(t) = a(t) = y_3(t)\n$$\nThe third equation is obtained from the governing third-order ODE by substituting the state variables:\n$$\n\\dot{y}_3(t) = \\dot{a}(t) = \\dddot{x}(t) = \\frac{1}{\\tau}\\ddot{x}(t) + \\frac{q}{m\\,\\tau}E(t) = \\frac{1}{\\tau}y_3(t) + \\frac{q}{m\\,\\tau}E(t)\n$$\nThus, the equivalent first-order system is:\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\ny_1 \\\\\ny_2 \\\\\ny_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny_2 \\\\\ny_3 \\\\\n\\frac{1}{\\tau}y_3 + \\frac{q}{m\\,\\tau}E(t)\n\\end{pmatrix}\n$$\n\nThe equation for acceleration, $\\dot{a}(t) - \\frac{1}{\\tau}a(t) = \\frac{q}{m\\,\\tau}E(t)$, has a homogeneous part $\\dot{a}_h(t) - \\frac{1}{\\tau}a_h(t) = 0$ whose solution is $a_h(t) = C\\,e^{t/\\tau}$ for some constant $C$. This solution grows exponentially in time and is referred to as a \"runaway\" solution. Such behavior is unphysical; an electron's acceleration should not grow without bound in the absence of a continuously growing external force. The problem statement correctly mandates the adoption of a physical condition to eliminate this non-physical behavior, namely that $a(t) \\to 0$ as $t \\to \\infty$. This condition forces the constant $C$ to be zero, thereby selecting the unique physically acceptable solution from an infinite family of mathematical solutions. For a numerical computation over a finite interval $[0, T]$, where $T$ is chosen such that $E(t)$ is negligible for $t \\ge T$, this condition is imposed as $a(T)=0$.\n\nThe combination of two initial conditions, $x(0)=0$ and $\\dot{x}(0)=0$, with the final boundary condition $a(T)=0$ makes the problem a boundary value problem, not a simple initial value problem. The numerical strategy must respect this structure. The problem is decoupled. The equation for $a(t)$ can be solved first, independently of $x(t)$ and $v(t)$, as it does not depend on them. We must solve the linear first-order equation for $a(t)$ with a final value condition. A standard technique for this is time reversal. Let $s = T-t$, which implies $t=T-s$ and $\\frac{d}{dt} = -\\frac{d}{ds}$. The ODE for $a(t(s))$ becomes:\n$$\n-\\frac{da}{ds} = \\frac{1}{\\tau}a(s) + \\frac{q}{m\\,\\tau}E(T-s)\n$$\nRearranging gives a standard initial value problem for $a(s)$:\n$$\n\\frac{da}{ds} = -\\frac{1}{\\tau}a(s) - \\frac{q}{m\\,\\tau}E(T-s)\n$$\nThe boundary condition $a(t=T)=0$ becomes an initial condition $a(s=0)=0$. This equation can be robustly integrated forward in $s$ from $s=0$ to $s=T$ using a standard numerical solver like a Runge-Kutta method. The result is the function $a(s)$ on the interval $[0, T]$. Reversing the resulting array of values gives the solution $a(t)$ on the interval $[0, T]$.\n\nOnce the acceleration $a(t)$ is determined numerically on a discrete time grid, the velocity $v(t)$ and position $x(t)$ are obtained by successive integrations, using the initial conditions $v(0)=0$ and $x(0)=0$:\n$$\nv(t) = v(0) + \\int_0^t a(t') dt' = \\int_0^t a(t') dt'\n$$\n$$\nx(t) = x(0) + \\int_0^t v(t') dt' = \\int_0^t v(t') dt'\n$$\nThese integrations are performed numerically. For instance, the cumulative trapezoidal rule is suitable. The final position $x(T)$ is the last value obtained in the numerical integration for $x(t)$. This completes the design of the numerical solution.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the Abraham-Lorentz equation of motion for an electron for three test cases\n    and prints the final positions.\n    \"\"\"\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in Kilograms\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in Farads/meter\n    C_LIGHT = 299792458.0         # Speed of light in meters/second\n\n    # Derived constants\n    Q = -E_CHARGE\n    M = M_ELECTRON\n    # Abraham-Lorentz characteristic time\n    TAU = (2 * E_CHARGE**2) / (3 * 4 * np.pi * EPSILON_0 * M * C_LIGHT**3)\n    # Pre-calculated coefficient for the ODE\n    Q_OVER_M_TAU = Q / (M * TAU)\n\n    def compute_final_position(E_func, T, num_points):\n        \"\"\"\n        Computes the final position x(T) for a given electric field and duration.\n\n        Args:\n            E_func (callable): A function E(t) for the external electric field.\n            T (float): The final time for the simulation.\n            num_points (int): The number of points for the time grid.\n\n        Returns:\n            float: The final position x(T) in meters.\n        \"\"\"\n        # Set up a uniform time grid for the simulation.\n        t_grid = np.linspace(0.0, T, num_points)\n\n        # Define the ODE for a(s) where s = T - t.\n        # This transforms the final value problem into an initial value problem.\n        # da/ds = -a/tau - (q/(m*tau)) * E(T-s)\n        def a_ode(s, a_vec):\n            a = a_vec[0]\n            return [-a / TAU - Q_OVER_M_TAU * E_func(T - s)]\n\n        # The time-reversed variable s runs from 0 to T. We ask the solver\n        # to evaluate the solution on a grid for s that corresponds to our t_grid.\n        s_eval = np.linspace(0.0, T, num_points)\n\n        # Solve the IVP for a(s) from s=0 to s=T with initial condition a(s=0)=0.\n        # We use RK45, a standard adaptive Runge-Kutta method.\n        sol = solve_ivp(a_ode, [0.0, T], [0.0], method='RK45', t_eval=s_eval)\n        \n        a_s = sol.y[0]\n        \n        # The solution a(t) is a(s) reversed in time.\n        a_t = a_s[::-1]\n        \n        # Integrate a(t) to get v(t) with v(0)=0.\n        # cumulative_trapezoid produces an array one element shorter than the input.\n        # By setting initial=0, it prepends a 0 and returns an array of the same size.\n        v_t = cumulative_trapezoid(a_t, t_grid, initial=0.0)\n        \n        # Integrate v(t) to get x(t) with x(0)=0.\n        x_t = cumulative_trapezoid(v_t, t_grid, initial=0.0)\n        \n        # The final position is the last element of the integrated array.\n        return x_t[-1]\n\n    # Test Case 1: Gaussian pulse\n    E0_1 = 1.0e6\n    tc_1 = 10.0 * TAU\n    sigma_1 = 3.0 * TAU\n    U_1 = 40.0\n    T_1 = U_1 * TAU\n    def E1(t):\n        return E0_1 * np.exp(-((t - tc_1)**2) / (2.0 * sigma_1**2))\n    \n    # Test Case 2: Damped sinusoid\n    E0_2 = 1.0e6\n    omega_2 = 0.2 / TAU\n    T_env_2 = 15.0 * TAU\n    U_2 = 60.0\n    T_2 = U_2 * TAU\n    def E2(t):\n        # Piecewise definition to handle large arguments in exp for t<0 from E(T-s)\n        if t < 0:\n            return 0.0\n        return E0_2 * np.sin(omega_2 * t) * np.exp(-t / T_env_2)\n\n    # Test Case 3: Zero field\n    U_3 = 10.0\n    T_3 = U_3 * TAU\n    def E3(t):\n        return 0.0\n\n    # Number of points for each simulation.\n    # A higher density of points is used to ensure accuracy,\n    # chosen proportional to the dimensionless simulation time U.\n    points_per_tau = 2000\n    num_points_1 = int(U_1 * points_per_tau) + 1\n    num_points_2 = int(U_2 * points_per_tau) + 1\n    num_points_3 = int(U_3 * points_per_tau) + 1\n        \n    test_cases = [\n        (E1, T_1, num_points_1),\n        (E2, T_2, num_points_2),\n        (E3, T_3, num_points_3),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_func, T, n_pts = case\n        x_final = compute_final_position(E_func, T, n_pts)\n        results.append(x_final)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}