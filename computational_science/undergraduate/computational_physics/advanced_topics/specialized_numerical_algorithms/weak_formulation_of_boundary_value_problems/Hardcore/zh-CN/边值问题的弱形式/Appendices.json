{
    "hands_on_practices": [
        {
            "introduction": "掌握弱公式化的第一步是熟悉其推导过程。这个练习将带你实践从一个给定的 (强形式) 微分方程出发，通过乘以检验函数并进行分部积分，得到其等价的积分 (弱) 形式的基本流程。这个过程不仅是数值方法 (如有限元法) 的理论基础，还能降低对解的光滑性要求，从而将解的范围扩大到更广泛的函数空间中。",
            "id": "2156992",
            "problem": "考虑由以下微分方程定义的一维边值问题 (BVP)：\n$$\n-(e^x u'(x))' = \\sin(x)\n$$\n在开区间 $(a, b)$ 上，满足齐次狄利克雷边界条件 $u(a) = 0$ 和 $u(b) = 0$。\n\n该边值问题的弱 (或变分) 形式要求从一个合适的函数空间 $V$ 中找到一个解函数 $u$，使得对于来自同一空间 $V$ 的所有“检验函数” $v$，某个积分方程都成立。对于此问题，空间 $V$ 被定义为在区间 $(a, b)$ 上连续、一阶导数平方可积，并满足边界条件 $f(a) = 0$ 和 $f(b) = 0$ 的函数集合。\n\n下列哪个积分方程正确地表示了给定边值问题的弱形式？任务是找到 $u \\in V$，使得所选方程对所有 $v \\in V$ 都成立。\n\nA. $\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nB. $\\int_{a}^{b} u'(x) v'(x) \\,dx = \\int_{a}^{b} e^{-x}\\sin(x) v(x) \\,dx$\n\nC. $-\\int_{a}^{b} e^x u'(x) v'(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nD. $\\int_{a}^{b} e^x u(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$\n\nE. $\\int_{a}^{b} e^x u'(x) v(x) \\,dx = -\\int_{a}^{b} \\cos(x) v'(x) \\,dx$\n\nF. $-\\int_{a}^{b} e^x u'(x) v(x) \\,dx = \\int_{a}^{b} \\sin(x) v(x) \\,dx$",
            "solution": "我们从该边值问题的强形式开始：\n$$\n-(\\exp(x)\\,u'(x))'=\\sin(x)\\quad\\text{for }x\\in(a,b),\\qquad u(a)=0,\\;u(b)=0.\n$$\n令 $V=\\{v\\in H^{1}(a,b):v(a)=v(b)=0\\}$。为了导出弱形式，将微分方程乘以任意一个检验函数 $v \\in V$，然后在 $(a,b)$ 上积分：\n$$\n\\int_{a}^{b}-(\\exp(x)\\,u'(x))'\\,v(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\n使用恒等式对左边进行分部积分\n$$\n\\int_{a}^{b}-\\left(p(x)w'(x)\\right)'\\,v(x)\\,dx=\\int_{a}^{b}p(x)\\,w'(x)\\,v'(x)\\,dx-\\left[p(x)\\,w'(x)\\,v(x)\\right]_{x=a}^{x=b},\n$$\n其中 $p(x)=\\exp(x)$ 且 $w(x)=u(x)$。这得到\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx-\\left[\\exp(x)\\,u'(x)\\,v(x)\\right]_{x=a}^{x=b}=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx.\n$$\n由于对所有 $v \\in V$ 都有 $v(a)=v(b)=0$，边界项消失，从而得到弱 (变分) 形式：\n$$\n\\int_{a}^{b}\\exp(x)\\,u'(x)\\,v'(x)\\,dx=\\int_{a}^{b}\\sin(x)\\,v(x)\\,dx\\quad\\text{for all }v\\in V.\n$$\n与选项比较，这对应于选项 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "弱公式化的真正威力在于它能优雅地处理经典微分方程难以描述的物理情景。本练习探讨了一个由两种不同材料组成的复合杆中的稳态热传导问题，其热导率在材料交界处存在跳跃间断。通过推导此问题的弱形式，你将发现，物理上必须满足的界面“传输条件” (即温度的连续性和热通量的守恒) 被自然地、隐式地包含在了积分公式中，而无需在问题设定时额外声明。",
            "id": "2146778",
            "problem": "考虑一个一维复合杆中的稳态热传导问题，杆长为 $L=2$，占据区间 $x \\in [-1, 1]$。杆中的温度分布 $u(x)$ 由以下微分方程控制：\n$$-\\frac{d}{dx}\\left(k(x) \\frac{du}{dx}\\right) = f(x) \\quad \\text{for } x \\in (-1, 1)$$\n其中 $f(x)$ 是一个连续的热源项。杆的两端保持在零温度，因此 $u(-1) = 0$ 且 $u(1) = 0$。\n\n该杆由两种不同材料在 $x=0$ 处连接而成。因此，热导率 $k(x)$ 是一个不连续的阶跃函数，定义为：\n$$ k(x) = \\begin{cases} k_1 & \\text{if } -1 < x < 0 \\\\ k_2 & \\text{if } 0 < x < 1 \\end{cases} $$\n其中 $k_1$ 和 $k_2$ 是不同的正常数。\n\n这个问题的经典提法要求在界面 $x=0$ 处指定“传输条件”，以确保得到一个物理上有意义的解。当这个问题以其弱 (或变分) 形式重新表述时，这些条件被该公式本身隐式地强制执行。\n\n任务是确定在界面 $x=0$ 处这组被隐式强制执行的传输条件。在下面的选项中，$u(0^-)$ 和 $u'(0^-)$ 表示当 $x$ 从左侧趋近于 $0$ 时函数及其导数的极限，而 $u(0^+)$ 和 $u'(0^+)$ 表示从右侧的极限。\n\n以下哪对条件被该边值问题的弱形式隐式地强制执行？\n\nA. $u(0^-) = u(0^+)$ 和 $k_1 u'(0^-) = k_2 u'(0^+)$\n\nB. $u'(0^-) = u'(0^+)$ 和 $k_1 u(0^-) = k_2 u(0^+)$\n\nC. $u(0^-) = u(0^+)$ 和 $u'(0^-) = u'(0^+)$\n\nD. 弱形式在 $x=0$ 处不施加任何条件，因为 $k(x)$ 的导数在该点没有定义。\n\nE. $k_1 u(0^-) = k_2 u(0^+)$ 和 $k_1 u'(0^-) = k_2 u'(0^+)$",
            "solution": "我们从弱 (变分) 形式开始：求 $u \\in H_{0}^{1}(-1,1)$，使得对于任意 $v \\in H_{0}^{1}(-1,1)$，\n$$\n\\int_{-1}^{1} k(x)\\, u'(x)\\, v'(x)\\, dx \\;=\\; \\int_{-1}^{1} f(x)\\, v(x)\\, dx,\n$$\n其中在 $(-1,0)$ 上 $k(x)=k_{1}$，在 $(0,1)$ 上 $k(x)=k_{2}$，且 $k_{1},k_{2}>0$，$u(-1)=u(1)=0$ 作为通过 $H_{0}^{1}(-1,1)$ 的迹被强制执行。\n\n首先，$u$ 在 $x=0$ 处的连续性来自于函数空间。在一维情况下，每个 $u \\in H^{1}(-1,1)$ 在 $[-1,1]$ 上都有一个绝对连续的代表元，因此在 $[-1,1]$ 上是连续的。因此，在 $0$ 处的左极限和右极限是相等的：\n$$\nu(0^{-}) \\;=\\; u(0^{+}).\n$$\n\n其次，我们推导通量连续性条件。由于 $C_{c}^{\\infty}(-1,1)$ 在 $H_{0}^{1}(-1,1)$ 中是稠密的，所以弱形式对所有 $v \\in C_{c}^{\\infty}(-1,1)$ 都成立。将积分在界面处分开，并在每个子区间上进行分部积分：\n$$\n\\int_{-1}^{0} k_{1}\\, u' v' \\, dx \\;+\\; \\int_{0}^{1} k_{2}\\, u' v' \\, dx\n\\;=\\; \\int_{-1}^{1} f\\, v \\, dx.\n$$\n在 $(-1,0)$ 上，\n$$\n\\int_{-1}^{0} k_{1}\\, u' v' \\, dx\n= \\big[ k_{1}\\, u' v \\big]_{x=-1}^{x=0^{-}} \\;-\\; \\int_{-1}^{0} (k_{1}\\, u')' v \\, dx,\n$$\n在 $(0,1)$ 上，\n$$\n\\int_{0}^{1} k_{2}\\, u' v' \\, dx\n= \\big[ k_{2}\\, u' v \\big]_{x=0^{+}}^{x=1} \\;-\\; \\int_{0}^{1} (k_{2}\\, u')' v \\, dx.\n$$\n将它们相加并利用 $v(-1)=v(1)=0$ (因为 $v \\in C_{c}^{\\infty}(-1,1)$) 可得\n$$\n\\big(k_{1}\\, u'(0^{-}) - k_{2}\\, u'(0^{+})\\big)\\, v(0)\n\\;-\\; \\int_{-1}^{0} (k_{1}\\, u')' v \\, dx \\;-\\; \\int_{0}^{1} (k_{2}\\, u')' v \\, dx\n\\;=\\; \\int_{-1}^{1} f\\, v \\, dx.\n$$\n在每个子区间内，强形式在分布意义下成立：\n$$\n-(k_{1}\\, u')' = f \\quad \\text{on } (-1,0), \\qquad -(k_{2}\\, u')' = f \\quad \\text{on } (0,1).\n$$\n将这些代入前面的恒等式，可以消去与 $\\int f v\\, dx$ 相关的积分项，剩下\n$$\n\\big(k_{1}\\, u'(0^{-}) - k_{2}\\, u'(0^{+})\\big)\\, v(0) \\;=\\; 0 \\quad \\text{for all } v \\in C_{c}^{\\infty}(-1,1).\n$$\n因为我们可以选择在 $x=0$ 处具有任意值的 $v$，所以可得\n$$\nk_{1}\\, u'(0^{-}) \\;=\\; k_{2}\\, u'(0^{+}).\n$$\n\n结合这两个结论，弱形式强制了界面上温度的连续性和热通量的连续性：\n$$\nu(0^{-}) = u(0^{+}), \\qquad k_{1}\\, u'(0^{-}) = k_{2}\\, u'(0^{+}).\n$$\n这些恰好是选项 A 中的条件。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "弱公式化是一种极为灵活的数学工具，其应用远不止求解源问题 (形如 $Au=f$)。本练习将展示如何将这种方法应用于另一类核心物理问题——特征值问题，例如计算系统的振动模态或量子态。通过对亥姆霍兹方程建立弱形式，你将看到它如何直接导出一个广义矩阵特征值问题 $K\\mathbf{c} = \\lambda M\\mathbf{c}$，这构成了计算物理和工程中有限元分析的基石。",
            "id": "2450442",
            "problem": "考虑标量偏微分方程 (PDE) 特征值问题：求特征对 $(\\lambda, u)$，其中 $u \\not\\equiv 0$，使得\n$$\n-\\nabla^{2} u = \\lambda\\, u \\quad \\text{在 } \\Omega \\text{ 内},\n$$\n带有齐次 Dirichlet 边界条件\n$$\nu = 0 \\quad \\text{在 } \\partial \\Omega \\text{ 上},\n$$\n其中 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个有 Lipschitz 边界 $\\partial \\Omega$ 的有界域，且 $d \\in \\{1,2,3\\}$。使用有限元法 (FEM) 的协调伽辽金离散化在一个由基函数 $\\{\\phi_{i}\\}_{i=1}^{N}$ 张成的有限维子空间 $V_{h} \\subset H^{1}_{0}(\\Omega)$ 中寻求 $u$。\n\n哪个选项正确地陈述了这种协调伽辽金有限元法所产生的弱形式和离散矩阵特征值问题的结构？\n\nA. 弱形式：求 $(\\lambda, u)$，其中 $u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n离散问题：设 $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$，\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c},\n$$\n其中 $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$ 且 $\\mathbf{M}_{ij} = \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x$。\n\nB. 弱形式：求 $(\\lambda, u)$，其中 $u \\in H^{1}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\partial \\Omega} \\frac{\\partial u}{\\partial n}\\, v \\, \\mathrm{d}s = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}(\\Omega).\n$$\n离散问题：设 $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$，其中 $\\{\\phi_{i}\\}$ 在 $\\partial \\Omega$ 上不必为零，\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c},\n$$\n其中 $\\mathbf{K}$ 和 $\\mathbf{M}$ 的定义与选项 A 中相同。\n\nC. 弱形式：求 $(\\lambda, u)$，其中 $u \\in H^{2}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} (\\nabla^{2} u)\\, v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega),\n$$\n因此离散系统为\n$$\n\\tilde{\\mathbf{K}}\\,\\mathbf{c} = \\lambda\\, \\mathbf{M}\\,\\mathbf{c}, \\quad \\tilde{\\mathbf{K}}_{ij} = \\int_{\\Omega} (\\nabla^{2} \\phi_{i})\\, \\phi_{j}\\, \\mathrm{d}x.\n$$\n\nD. 弱形式：求 $(\\lambda, u)$，其中 $u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\}$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n离散问题：选择任意协调有限元法基 $\\{\\phi_{i}\\}_{i=1}^{N}$ 后，特征值问题总是简化为标准形式\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\lambda\\, \\mathbf{c},\n$$\n其中 $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$。",
            "solution": "控制性偏微分方程 (PDE) 是\n$$\n-\\nabla^{2} u = \\lambda\\, u \\quad \\text{在 } \\Omega \\text{ 内}, \\quad u = 0 \\quad \\text{在 } \\partial \\Omega \\text{ 上}。\n$$\n为从第一性原理导出弱形式，将 PDE 乘以一个可接受的测试函数 $v$ 并在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} \\left(-\\nabla^{2} u\\right) v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x.\n$$\n对左侧应用 Green 恒等式（分部积分）：\n$$\n\\int_{\\Omega} \\left(-\\nabla^{2} u\\right) v \\, \\mathrm{d}x = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\partial \\Omega} \\frac{\\partial u}{\\partial n} v \\, \\mathrm{d}s.\n$$\n对于齐次 Dirichlet 边界条件，试验空间和测试空间的自然协调选择是 Sobolev 空间 $H^{1}_{0}(\\Omega)$，它被定义为 $C^{\\infty}_{c}(\\Omega)$ 在 $H^{1}$ 范数下的闭包，因此 $v \\in H^{1}_{0}(\\Omega)$ 意味着在迹的意义上 $v = 0$ 在 $\\partial \\Omega$ 上。因此，由于在 $\\partial \\Omega$ 上 $v=0$，边界积分消失，从而得到对称的弱形式：\n$$\n\\text{求 } \\left(\\lambda, u\\right) \\text{，其中 } u \\in H^{1}_{0}(\\Omega)\\setminus\\{0\\} \\text{，使得 } \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n此形式仅需要 $u$ 和 $v$ 的一阶导数，因此 $H^{1}_{0}(\\Omega)$ 是足够的，并且相关的双线性形式对于左侧在 $H^{1}_{0}(\\Omega)$ 上是连续、对称和强制的。\n\n对于协调有限元法 (FEM) 离散化，选择一个具有基 $\\{\\phi_{i}\\}_{i=1}^{N}$ 的有限维子空间 $V_{h} \\subset H^{1}_{0}(\\Omega)$。用 $u_{h} = \\sum_{i=1}^{N} c_{i} \\phi_{i}$ 近似 $u$，并用每个基函数 $\\phi_{j}$（$j \\in \\{1,\\dots,N\\}$）进行测试。弱形式变为\n$$\n\\sum_{i=1}^{N} c_{i} \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x = \\lambda \\sum_{i=1}^{N} c_{i} \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x \\quad \\text{对每个 } j.\n$$\n收集系数得到广义矩阵特征值问题\n$$\n\\mathbf{K}\\, \\mathbf{c} = \\lambda\\, \\mathbf{M}\\, \\mathbf{c},\n$$\n其中刚度矩阵项为 $\\mathbf{K}_{ij} = \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\, \\mathrm{d}x$，质量矩阵项为 $\\mathbf{M}_{ij} = \\int_{\\Omega} \\phi_{i}\\, \\phi_{j}\\, \\mathrm{d}x$。对于标准的协调有限元空间，$\\mathbf{K}$ 和 $\\mathbf{M}$ 是对称的，$\\mathbf{K}$ 在与零空间正交的子空间上是正定的（此处 Dirichlet 约束移除了常数零空间），而 $\\mathbf{M}$ 是对称正定的。\n\n逐个选项分析：\n\nA. 弱形式使用试验和测试空间 $H^{1}_{0}(\\Omega)$ 来陈述，这强加了齐次 Dirichlet 边界条件。由于在 $\\partial \\Omega$ 上 $v = 0$，边界积分消失，得到\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\lambda \\int_{\\Omega} u\\, v \\, \\mathrm{d}x \\quad \\forall v \\in H^{1}_{0}(\\Omega).\n$$\n离散的伽辽金系统被正确地识别为具有标准刚度矩阵和质量矩阵的广义特征值问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$。结论 — 正确。\n\nB. 该选项使用 $H^{1}(\\Omega)$ 作为测试函数和试验函数，并保留了边界项。对于齐次 Dirichlet 条件，适当的协调空间是 $H^{1}_{0}(\\Omega)$，使得迹为零且边界积分消失；使用 $H^{1}(\\Omega)$ 而不额外强制边界条件与本质边界条件不一致。因此，对于给定的边界条件，空间的选择和所显示的弱形式陈述都是不正确的。结论 — 不正确。\n\nC. 该选项将拉普拉斯算子作用于 $u$ 保留在域积分内，并要求 $u \\in H^{2}(\\Omega)$，这是不必要的，并且与弱形式的目的相悖。标准的弱形式将导数转移到 $v$ 上，以将正则性要求降低到 $H^{1}(\\Omega)$。此外，所显示的离散矩阵使用了基函数的二阶导数，这对于该问题不是协调 $H^{1}$ 有限元法的方法。结论 — 不正确。\n\nD. 该选项中的弱形式是正确的，但声称离散问题对于“任何”协调基“总是简化”为标准特征值问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{c}$ 通常是错误的。如果没有额外的步骤，例如对基进行显式的 $\\mathbf{M}$-正交归一化或变量变换，伽辽金离散化会产生广义特征值问题 $\\mathbf{K}\\mathbf{c} = \\lambda \\mathbf{M}\\mathbf{c}$，而不是标准特征值问题。结论 — 不正确。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}