{
    "hands_on_practices": [
        {
            "introduction": "在计算流体力学中，当使用显式时间积分方法时，Courant-Friedrichs-Lewy (CFL) 条件是保证数值稳定性的基石。这个条件将时间步长、空间步长和物理波速联系起来，确保信息在网格上的传播速度不会超过其物理传播速度。通过亲手实践，你将直接体验当CFL数满足、达到极限以及被违反时，数值解分别表现出的稳定、精确（在特定条件下）和灾难性的不稳定性，从而深刻理解这一基本原理的重要性。",
            "id": "2381376",
            "problem": "您将研究一维线性平流方程的显式有限体积求解器的数值稳定性，并使用 Courant-Friedrichs-Lewy (CFL) 条件作为组织原则。从线性平流的守恒律形式开始，\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{\\partial f}{\\partial x} = 0,\\quad f = a\\,q,\n$$\n其中 $q(x,t)$ 是一个标量场，$a$ 是一个恒定的平流速度。使用以下物理上一致的设置：空间域是周期性的，长度为 $L$ 米，平流速度 $a$ 的单位是米/秒，时间 $t$ 的单位是秒。对于光滑的初始数据，其精确解是等速平移\n$$\nq(x,t) = q_0(x - a\\,t) \\quad \\text{on the periodic domain}\n$$\n您的任务是：\n- 从守恒形式和显式时间推进出发，推导一个适用于均匀网格上 $a  0$ 情况的一阶迎风有限体积法。不要使用任何预先推导出的离散更新表达式；从数值通量的定义和单元平均值的有限体积更新开始。\n- 对推导出的格式使用离散傅里叶（冯·诺依曼）分析，得到关于无量纲 Courant 数 $C$ 的稳定性限制，其中\n$$\nC = \\frac{|a|\\,\\Delta t}{\\Delta x}\n$$\n- 实现所推导的带有周期性边界条件的方法，并将一个初始条件推进到指定的最终时间。使用具有 $N$ 个单元的均匀网格，$\\Delta x = L/N$，以及通过目标 Courant 数 $C$ 选择的恒定时间步长 $\\Delta t = C\\,\\Delta x/a$。对于每次运行，使用整数个时间步 $n_{\\text{steps}}$，因此最终时间为 $T = n_{\\text{steps}}\\,\\Delta t$。\n- 使用光滑、周期性的高斯初始条件，其单位振幅，中心位于 $x_0$，宽度为 $\\sigma$：\n$$\nq_0(x) = \\exp\\!\\left(-\\frac{d(x,x_0)^2}{2\\,\\sigma^2}\\right)\n$$\n其中 $d(x,x_0)$ 是区间 $[0,L)$ 上的最短周期距离。\n- 为从数值上评估稳定性，如果在任何时间步，任何单元平均值的绝对值超过了初始最大振幅的 $M$ 倍（其中 $M$ 是一个固定因子）的阈值，则宣布该次运行不稳定。否则，宣布运行稳定。通过相对于网格上精确解的相对离散 $\\ell^2$ 误差来量化最终时刻的精度，\n$$\n\\varepsilon = \\frac{\\left\\| q^{n_{\\text{steps}}} - q_{\\text{exact}}(\\cdot,T)\\right\\|_2}{\\left\\| q_{\\text{exact}}(\\cdot,T) \\right\\|_2}\n$$\n其中 $\\|\\cdot\\|_2$ 是网格点值上的欧几里得范数。对于不稳定的运行，报告一个大的哨兵误差值 $E_{\\text{sentinel}}$。\n\n实现一个程序，精确执行以下测试套件，为每个案例返回一个列表，其中包含一个布尔稳定性标志和误差 $\\varepsilon$（如果不稳定，则为哨兵值）：\n\n- 案例 A（低于稳定性极限）：$L = 1.0$ 米，$a = 1.0$ 米/秒，$N = 100$，$x_0 = 0.25$ 米，$\\sigma = 0.05$ 米，$C = 0.5$，$n_{\\text{steps}} = 200$，$M = 10$，$E_{\\text{sentinel}} = 10^{9}$。\n- 案例 B（处于稳定性极限）：$L = 1.0$ 米，$a = 1.0$ 米/秒，$N = 100$，$x_0 = 0.25$ 米，$\\sigma = 0.05$ 米，$C = 1.0$，$n_{\\text{steps}} = 100$，$M = 10$，$E_{\\text{sentinel}} = 10^{9}$。\n- 案例 C（高于稳定性极限）：$L = 1.0$ 米，$a = 1.0$ 米/秒，$N = 100$，$x_0 = 0.25$ 米，$\\sigma = 0.05$ 米，$C = 1.1$，$n_{\\text{steps}} = 50$，$M = 10$，$E_{\\text{sentinel}} = 10^{9}$。\n\n本问题中不使用角度单位。确保程序对所有有量纲的输入，如上所述，一致地使用米和秒。最终输出必须是单行，包含三个结果的列表，每个结果本身都是 $[\\text{stable}, \\varepsilon]$ 形式的列表，并严格按照 A、B、C 的顺序排列。例如，格式必须为\n$$\n\\big[\\,[\\text{True},\\,0.0123],[\\text{True},\\,0.0],[\\text{False},\\,1000000000.0]\\,\\big],\n$$\n其中稳定性为布尔值，误差为浮点值。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。",
            "solution": "所述问题需经过验证。\n\n### 步骤 1：提取已知条件\n\n控制偏微分方程是一维线性平流方程的守恒形式：\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{\\partial f}{\\partial x} = 0\n$$\n其通量为 $f = a\\,q$，其中 $a$ 是一个恒定的平流速度。\n\n区域是周期性的，长度为 $L$。\n初始条件是一个光滑的高斯分布：\n$$\nq_0(x) = \\exp\\!\\left(-\\frac{d(x,x_0)^2}{2\\,\\sigma^2}\\right)\n$$\n其中 $d(x,x_0)$ 是 $[0,L)$ 上的最短周期距离。\n对于光滑的初始数据，其精确解为 $q(x,t) = q_0(x - a\\,t)$。\n\n数值参数定义如下：\n- 均匀网格单元数：$N$\n- 单元宽度：$\\Delta x = L/N$\n- Courant 数：$C = \\frac{|a|\\,\\Delta t}{\\Delta x}$\n- 时间步长：$\\Delta t = C\\,\\Delta x/a$ (对于 $a0$)\n- 时间步数：$n_{\\text{steps}}$\n- 最终时间：$T = n_{\\text{steps}}\\,\\Delta t$\n\n稳定性和精度度量标准如下：\n- 稳定性阈值因子：$M$\n- 如果在任何时刻 $\\max(|q|)  M \\times \\max(|q_0|)$，则宣布该次运行不稳定。\n- 不稳定运行的哨兵误差：$E_{\\text{sentinel}}$\n- 相对离散 $\\ell^2$ 误差：$\\varepsilon = \\frac{\\left\\| q^{n_{\\text{steps}}} - q_{\\text{exact}}(\\cdot,T)\\right\\|_2}{\\left\\| q_{\\text{exact}}(\\cdot,T) \\right\\|_2}$\n\n测试案例：\n- 案例 A：$L = 1.0$，$a = 1.0$，$N = 100$，$x_0 = 0.25$，$\\sigma = 0.05$，$C = 0.5$，$n_{\\text{steps}} = 200$，$M = 10$，$E_{\\text{sentinel}} = 10^{9}$。\n- 案例 B：$L = 1.0$，$a = 1.0$，$N = 100$，$x_0 = 0.25$，$\\sigma = 0.05$，$C = 1.0$，$n_{\\text{steps}} = 100$，$M = 10$，$E_{\\text{sentinel}} = 10^{9}$。\n- 案例 C：$L = 1.0$，$a = 1.0$，$N = 100$，$x_0 = 0.25$，$\\sigma = 0.05$，$C = 1.1$，$n_{\\text{steps}} = 50$，$M = 10$，$E_{\\text{sentinel}} = 10^{9}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n- **科学依据：** 该问题基于线性平流方程、有限体积法和冯·诺依曼稳定性分析。这些是计算物理和应用数学中基本且公认的概念。该问题在科学上是合理的。\n- **适定性：** 问题陈述清晰，为每个案例提供了所有必要的参数和条件。推导、分析和实现等任务定义明确，可得出唯一且有意义的结果。\n- **客观性：** 问题以精确、客观的语言表述。没有主观或基于观点的陈述。\n- **完整性和一致性：** 问题是自洽的。所有变量和常量都已定义，测试案例也已完全指定。物理单位（米、秒）在全文中保持一致。\n\n### 步骤 3：结论与行动\n\n该问题有效。这是一个关于偏微分方程数值方法的标准、适定的练习。将提供完整的解答。\n\n### 一阶迎风有限体积法的推导\n\n我们从守恒律在控制体积（或单元）$I_i = [x_{i-1/2}, x_{i+1/2}]$ 上的积分形式开始，其中单元中心是 $x_i$，单元宽度是 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。将偏微分方程在该单元上积分得到：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial q}{\\partial t} dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial f}{\\partial x} dx = 0\n$$\n应用莱布尼茨积分法则和微积分基本定理，我们得到：\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) dx + \\left[ f(q(x_{i+1/2},t)) - f(q(x_{i-1/2},t)) \\right] = 0\n$$\n我们将单元 $i$ 在时间 $t$ 上的 $q$ 的单元平均值定义为：\n$$\n\\bar{q}_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,t) dx\n$$\n将此定义代入积分方程，得到关于单元平均值 $\\bar{q}_i(t)$ 的一个精确常微分方程：\n$$\n\\frac{d\\bar{q}_i}{dt} = -\\frac{1}{\\Delta x} \\left[ f(q(x_{i+1/2},t)) - f(q(x_{i-1/2},t)) \\right]\n$$\n为了获得数值格式，我们使用前向欧拉法对时间进行离散，并近似单元界面处的通量 $f$ 的点值。设 $\\bar{q}_i^n \\approx \\bar{q}_i(t^n)$，其中 $t^n = n\\Delta t$。时间导数近似为 $\\frac{d\\bar{q}_i}{dt} \\approx \\frac{\\bar{q}_i^{n+1} - \\bar{q}_i^n}{\\Delta t}$。\n界面通量由一个数值通量函数 $F$ 来近似，该函数取决于相邻单元在时间 $t^n$ 的状态。方程变为：\n$$\n\\frac{\\bar{q}_i^{n+1} - \\bar{q}_i^n}{\\Delta t} = -\\frac{1}{\\Delta x} \\left[ F_{i+1/2} - F_{i-1/2} \\right]\n$$\n其中 $F_{i+1/2}$ 是界面 $x_{i+1/2}$ 处的数值通量。这可以重写为有限体积更新公式：\n$$\n\\bar{q}_i^{n+1} = \\bar{q}_i^n - \\frac{\\Delta t}{\\Delta x} \\left[ F_{i+1/2} - F_{i-1/2} \\right]\n$$\n对于一阶迎风格式，数值通量由信息传播的方向决定，该方向由平流速度 $a$ 的符号给出。问题指定 $a  0$，因此信息从左向右传播。界面处的通量应由“迎风”单元（即左侧的单元）的状态确定。\n因此，单元 $i$ 的右界面 $x_{i+1/2}$ 处的通量由单元 $i$ 的状态确定：\n$$\nF_{i+1/2} = f(\\bar{q}_i^n) = a \\bar{q}_i^n\n$$\n类似地，单元 $i$ 的左界面 $x_{i-1/2}$ 处的通量由单元 $i-1$ 的状态确定：\n$$\nF_{i-1/2} = f(\\bar{q}_{i-1}^n) = a \\bar{q}_{i-1}^n\n$$\n将这些数值通量代入更新公式，我们得到适用于 $a  0$ 的一阶迎风格式：\n$$\n\\bar{q}_i^{n+1} = \\bar{q}_i^n - \\frac{\\Delta t}{\\Delta x} (a \\bar{q}_i^n - a \\bar{q}_{i-1}^n)\n$$\n根据问题定义，我们引入无量纲 Courant 数 $C = \\frac{a \\Delta t}{\\Delta x}$（因为 $a0$，所以 $|a|=a$）。最终的格式是：\n$$\n\\bar{q}_i^{n+1} = \\bar{q}_i^n - C (\\bar{q}_i^n - \\bar{q}_{i-1}^n)\n$$\n\n### 冯·诺依曼稳定性分析\n\n为了分析所推导格式的稳定性，我们采用离散傅里叶（冯·诺依曼）分析。我们考虑网格上解的单个傅里叶模式：\n$$\n\\bar{q}_j^n = \\hat{q}^n e^{i k x_j} = \\hat{q}^n e^{i k j \\Delta x}\n$$\n其中 $\\hat{q}^n$ 是在时间步 $n$ 的模式的复振幅，$k$ 是波数，$i = \\sqrt{-1}$。将此假设代入数值格式：\n$$\n\\hat{q}^{n+1} e^{i k j \\Delta x} = \\hat{q}^n e^{i k j \\Delta x} - C \\left( \\hat{q}^n e^{i k j \\Delta x} - \\hat{q}^n e^{i k (j-1) \\Delta x} \\right)\n$$\n我们定义放大因子 $G(k) = \\frac{\\hat{q}^{n+1}}{\\hat{q}^n}$。将方程两边除以 $\\hat{q}^n e^{i k j \\Delta x}$ 得到：\n$$\nG(k) = 1 - C \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\n设 $\\theta = k \\Delta x$ 为无量纲波数。放大因子是 $\\theta$ 的函数：\n$$\nG(\\theta) = 1 - C (1 - e^{-i\\theta}) = 1 - C (1 - (\\cos\\theta - i\\sin\\theta)) = (1 - C + C\\cos\\theta) + i(C\\sin\\theta)\n$$\n为使格式稳定，对于所有可能的 $\\theta$ 值，放大因子的模都不能超过 1，即 $|G(\\theta)| \\le 1$。我们分析其模的平方：\n$$\n|G(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2 = 1 - 2C + 2C^2 + (2C-2C^2)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos\\theta = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 意味着：\n$$\n1 - 2C(1-C)(1-\\cos\\theta) \\le 1 \\implies -2C(1-C)(1-\\cos\\theta) \\le 0\n$$\n由于 $\\theta$ 是实数，项 $(1-\\cos\\theta)$ 始终是非负的，范围从 $0$ 到 $2$。因此，稳定性要求：\n$$\nC(1-C) \\ge 0\n$$\n考虑到 Courant 数 $C = \\frac{a \\Delta t}{\\Delta x}$ 是非负的（因为 $a0, \\Delta t0, \\Delta x0$），该不等式在以下条件下成立：\n$$\n0 \\le C \\le 1\n$$\n这是一阶迎风格式的 Courant-Friedrichs-Lewy (CFL) 稳定性条件。\n\n### 数值实现策略\n\n所推导的格式在均匀周期性网格上实现。\n1.  **网格和参数**：对于长度为 $L$、有 $N$ 个单元的域，单元宽度为 $\\Delta x = L/N$。代表单元中心的网格点为 $x_j = j \\Delta x$，其中 $j=0, 1, \\dots, N-1$。\n2.  **初始条件**：初始状态向量 $q^0$ 由值 $q_j^0 = q_0(x_j)$ 填充。长度为 $L$ 的域上的周期性距离函数 $d(x_1, x_2)$ 计算为 $d(x_1, x_2) = \\min(|x_1-x_2|, L - |x_1-x_2|)$。根据构造，初始最大振幅为 $\\max(|q_0|) = 1$。\n3.  **时间步进**：时间步长 $\\Delta t$ 根据指定的 Courant 数 $C$ 计算得出，即 $\\Delta t = C \\Delta x / a$。模拟运行固定的步数 $n_{\\text{steps}}$。\n4.  **更新步骤**：更新方程 $\\bar{q}_i^{n+1} = \\bar{q}_i^n - C (\\bar{q}_i^n - \\bar{q}_{i-1}^n)$ 应用于所有单元 $i=0, \\dots, N-1$。由于周期性边界条件，对于单元 $i=0$，项 $\\bar{q}_{i-1}^n$ 是 $\\bar{q}_{N-1}^n$。这可以通过循环移位（`numpy.roll`）高效实现。\n5.  **稳定性检查**：在每个时间步 $n$，更新之前，检查条件 $\\max(|\\bar{q}^n|) \\le M \\times 1.0$。如果违反该条件，则将该次运行标记为不稳定，并终止该案例的模拟。\n6.  **误差计算**：如果模拟在不违反稳定性准则的情况下完成了所有 $n_{\\text{steps}}$ 步，则将其标记为稳定。最终的数值解是 $q^{n_{\\text{steps}}}$。在最终时间 $T=n_{\\text{steps}}\\Delta t$ 的精确解是 $q_{exact}(x,T) = q_0(x-aT)$。这通过在移动了 $-aT$ 的网格点上评估初始剖面来计算。高斯分布的最终中心是 $x_{0,final} = (x_0 + aT) \\pmod L$。然后网格上的精确解为 $q_{exact,j} = \\exp(-d(x_j, x_{0,final})^2 / (2\\sigma^2))$。然后计算相对 $\\ell^2$ 误差 $\\varepsilon$。对于不稳定的运行，$\\varepsilon$ 被设置为 $E_{\\text{sentinel}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linear advection problem for three test cases\n    to investigate numerical stability of the first-order upwind scheme.\n    \"\"\"\n    \n    test_cases = [\n        # Case A: C = 0.5 (stable)\n        {'L': 1.0, 'a': 1.0, 'N': 100, 'x0': 0.25, 'sigma': 0.05, \n         'C': 0.5, 'n_steps': 200, 'M': 10, 'E_sentinel': 1e9},\n        # Case B: C = 1.0 (marginally stable, exact shift)\n        {'L': 1.0, 'a': 1.0, 'N': 100, 'x0': 0.25, 'sigma': 0.05, \n         'C': 1.0, 'n_steps': 100, 'M': 10, 'E_sentinel': 1e9},\n        # Case C: C = 1.1 (unstable)\n        {'L': 1.0, 'a': 1.0, 'N': 100, 'x0': 0.25, 'sigma': 0.05, \n         'C': 1.1, 'n_steps': 50, 'M': 10, 'E_sentinel': 1e9},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters\n        L = case['L']\n        a = case['a']\n        N = case['N']\n        x0 = case['x0']\n        sigma = case['sigma']\n        C = case['C']\n        n_steps = case['n_steps']\n        M = case['M']\n        E_sentinel = case['E_sentinel']\n\n        # Grid setup\n        dx = L / N\n        x = np.linspace(0, L, N, endpoint=False) # Grid points for cell centers\n\n        # Time step calculation\n        dt = C * dx / a\n        T_final = n_steps * dt\n\n        # Helper for periodic distance\n        def periodic_distance(x1, x2, domain_length):\n            diff = np.abs(x1 - x2)\n            return np.minimum(diff, domain_length - diff)\n\n        # Initial condition\n        q = np.exp(-periodic_distance(x, x0, L)**2 / (2 * sigma**2))\n        \n        # Initial maximum amplitude is 1.0 by definition of the Gaussian\n        initial_max_q = 1.0\n        stability_threshold = M * initial_max_q\n\n        is_stable = True\n        # Time-stepping loop\n        for _ in range(n_steps):\n            if np.max(np.abs(q)) > stability_threshold:\n                is_stable = False\n                break\n            \n            # Copy of current state for the update\n            q_n = q.copy()\n            \n            # First-order upwind scheme (for a > 0)\n            # q_i^{n+1} = q_i^n - C * (q_i^n - q_{i-1}^n)\n            # np.roll(q_n, 1) provides q_{i-1} with periodic boundaries\n            q = q_n - C * (q_n - np.roll(q_n, 1))\n\n        # Final error calculation\n        if not is_stable:\n             # Check one last time after the final step for cases that blow up on the last step\n            if np.max(np.abs(q)) > stability_threshold:\n                 error = E_sentinel\n            else: # Should not happen if loop broke, but as a safeguard\n                is_stable = True # If it did not actually exceed threshold\n\n        if is_stable:\n            # Exact solution at T_final\n            x_center_final = (x0 + a * T_final) % L\n            q_exact = np.exp(-periodic_distance(x, x_center_final, L)**2 / (2 * sigma**2))\n            \n            # Calculate relative L2 error\n            norm_diff = np.linalg.norm(q - q_exact)\n            norm_exact = np.linalg.norm(q_exact)\n            \n            if norm_exact > 0:\n                error = norm_diff / norm_exact\n            else:\n                error = norm_diff # Should not happen for a Gaussian\n        else:\n            error = E_sentinel\n\n        results.append([is_stable, error])\n\n    # Final print statement in the exact required format\n    # The default str representation of a list in Python is '[item1, item2, ...]'\n    # which matches the required format including the space after the comma.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实流体流动通常涉及对流和扩散的复杂相互作用。白格斯方程（Burgers' equation）是一个经典的非线性模型，它能同时捕捉到由非线性对流引起的激波形成趋势，以及由物理黏性导致的梯度平滑效应。通过解决这个方程，你将学习如何用数值方法处理这些相互竞争的物理过程，特别是如何使用迎风格式来稳定对流项，并直观地观察黏性在防止非物理解（激波）产生中的关键作用。",
            "id": "2381332",
            "problem": "考虑粘性一维 Burgers 方程，这是计算物理学中计算流体力学基础里的一个对流-扩散动力学的典型模型：\n$$\nu_t + u\\,u_x = \\nu\\,u_{xx},\n$$\n该方程建立在一个具有固定边界状态的有限一维域上。从平衡非线性对流通量与菲克扩散的守恒律观点出发，基于第一性原理推导出一个稳定的半离散方法：场的速率等于其平流通量的负散度加上扩散项。利用此方法设计一个全离散算法，以近似类激波初始剖面的时间演化，并展示粘度 $\\,\\nu\\,$ 如何平滑陡峭的梯度。\n\n您的任务是编写一个完整、可运行的程序，该程序：\n- 在域 $\\,x \\in [-L/2,\\,L/2]\\,$（其中 $\\,L = 2\\,$）上均匀离散空间，使用 $\\,N_x\\,$ 个网格点，间距为 $\\,\\Delta x\\,$.\n- 对所有 $\\,t\\,$ 强制施加固定的狄利克雷边界条件 $\\,u(-L/2,t)=+1\\,$ 和 $\\,u(+L/2,t)=-1\\,$.\n- 使用光滑的类激波初始条件\n$$\nu(x,0) = -\\tanh\\!\\left(\\frac{x}{\\delta}\\right),\n$$\n其中 $\\,\\delta  0\\,$ 控制初始厚度。\n- 使用显式方法将时间推进到指定的最终时间 $\\,T\\,$. 在每一步选择一个时间步长 $\\,\\Delta t\\,$ 以满足同时考虑对流和扩散的稳定性限制。具体来说，强制执行\n$$\n\\Delta t \\le C \\,\\min\\!\\left(\\frac{\\Delta x}{\\max_x |u|},\\,\\frac{\\Delta x^2}{2\\nu}\\right),\n$$\n其中 $\\,C \\in (0,1)\\,$ 是一个 Courant–Friedrichs–Lewy (CFL) 安全因子。\n- 对于内部点，使用基于 $\\,u\\,$ 局部符号的单调一阶迎风差分来近似对流导数 $\\,u\\,u_x\\,$, 并使用中心二阶差分来近似扩散项 $\\,u_{xx}\\,$. 在每个时间层保持边界值固定。\n\n对于每个测试用例，在演化到时间 $\\,T\\,$后，计算单一的标量诊断值\n$$\nG(T) = \\max_{x \\,\\text{on grid interior}} \\left| \\frac{\\partial u}{\\partial x}(x,T) \\right|,\n$$\n在内部点上使用中心差分来近似空间导数。将 $\\,G(T)\\,$ 报告为一个四舍五入到 $\\,6\\,$ 位小数的浮点数。较大的 $\\,G(T)\\,$ 表示更陡峭的剖面；较小的 $\\,G(T)\\,$ 表示更强的平滑效果。\n\n所有量都是无量纲的，因此不需要物理单位。\n\n实现您的求解器以处理以下参数测试套件，每个测试用例指定为一个元组 $\\,( \\nu,\\, T,\\, N_x,\\, \\delta,\\, C )\\,$：\n- 案例 1：$\\,(0.01,\\,0.2,\\,401,\\,0.05,\\,0.4)$\n- 案例 2：$\\,(0.001,\\,0.2,\\,401,\\,0.05,\\,0.4)$\n- 案例 3：$\\,(0.05,\\,0.2,\\,401,\\,0.05,\\,0.4)$\n- 案例 4（边界情况，无演化）：$\\,(0.01,\\,0.0,\\,401,\\,0.05,\\,0.4)$\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中 $\\,r_k = G(T)\\,$ 是案例 $\\,k\\,$ 的结果，每个结果都四舍五入到 $\\,6\\,$ 位小数。",
            "solution": "问题陈述在科学上是合理的，且提法恰当。它提出了计算流体力学中的一个标准问题：一维粘性 Burgers 方程的数值解。所有参数、条件和数值格式都得到了明确定义，从而可以获得唯一且可验证的解。我们继续进行指定算法的推导和实现。\n\n该问题要求在域 $x \\in [-L/2, L/2]$（其中 $L=2$）上求解粘性 Burgers 方程，\n$$\n\\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\n该方程是描述非线性对流和粘性扩散同时存在的现象的基本模型。\n\n正如问题所要求的，控制方程可以从第一性原理来解释。在一维情况下，对于具有通量 $J$ 的量 $u$，其守恒律为 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0$。总通量 $J$ 由平流部分和扩散部分组成。平流通量由该量自身的流动给出，由通量函数 $F(u) = \\frac{1}{2}u^2$ 描述。扩散通量由菲克定律建模，即 $q = -\\nu \\frac{\\partial u}{\\partial x}$。因此，总通量为 $J = F(u) + q = \\frac{1}{2}u^2 - \\nu \\frac{\\partial u}{\\partial x}$。将其代入守恒律可得\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2}u^2 - \\nu \\frac{\\partial u}{\\partial x} \\right) = 0\n$$\n应用链式法则 $\\frac{\\partial}{\\partial x}(\\frac{1}{2}u^2) = u \\frac{\\partial u}{\\partial x}$，并假设粘度 $\\nu$ 为常数，我们恢复了方程的原始形式：$\\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2}$。这证实了问题陈述基于守恒原理。项 $u_t$ 是变化率，$-u u_x$ 是平流通量的负散度，而 $\\nu u_{xx}$ 是扩散项。\n\n我们使用有限差分法来开发数值解。将域离散为 $N_x$ 个等距点 $x_j = -L/2 + j \\cdot \\Delta x$，其中 $j=0, 1, \\dots, N_x-1$，网格间距为 $\\Delta x = L/(N_x-1)$。令 $u_j^n$ 表示 $u(x_j, t_n)$ 的数值近似。\n\n对于内部网格点 $j$，方程的半离散形式为\n$$\n\\frac{d u_j}{d t} = - \\left(u \\frac{\\partial u}{\\partial x}\\right)_j + \\nu \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_j\n$$\n\n空间导数按规定进行近似：\n1.  **对流项**：对 $u \\frac{\\partial u}{\\partial x}$ 项使用一阶迎风格式。差分模板的选择取决于局部速度 $u_j$ 的符号。如果 $u_j  0$，信息从左向右传播，因此使用后向差分。如果 $u_j \\le 0$，信息从右向左传播，需要使用前向差分。\n    $$\n    \\left(u \\frac{\\partial u}{\\partial x}\\right)_j \\approx\n    \\begin{cases}\n    u_j \\frac{u_j - u_{j-1}}{\\Delta x}  \\text{if } u_j  0 \\\\\n    u_j \\frac{u_{j+1} - u_j}{\\Delta x}  \\text{if } u_j \\le 0\n    \\end{cases}\n    $$\n    该格式引入了数值扩散，有助于在存在陡峭梯度（激波）时稳定解，使其成为一种单调格式。\n\n2.  **扩散项**：对粘性项 $\\frac{\\partial^2 u}{\\partial x^2}$ 使用二阶中心差分。\n    $$\n    \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_j \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\n    $$\n\n结合这些，内部点（$j=1, \\dots, N_x-2$）的半离散方程变为：\n$$\n\\frac{d u_j}{d t} = -\\left( \\begin{cases} u_j \\frac{u_j - u_{j-1}}{\\Delta x}  \\text{if } u_j  0 \\\\ u_j \\frac{u_{j+1} - u_j}{\\Delta x}  \\text{if } u_j \\le 0 \\end{cases} \\right) + \\nu \\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\n$$\n\n对于时间积分，采用显式前向欧拉法。时间步 $n+1$ 的解由时间步 $n$ 的解计算得出：\n$$\nu_j^{n+1} = u_j^n + \\Delta t_n \\cdot \\left(\\frac{du_j}{dt}\\right)^n\n$$\n其中 $\\Delta t_n$ 是在步骤 $n$ 的时间步长。这种显式格式的稳定性取决于时间步长是否满足 Courant–Friedrichs–Lewy (CFL) 条件。对于对流-扩散方程，该条件结合了两种现象的约束：\n$$\n\\Delta t_n \\le C \\cdot \\min\\left(\\frac{\\Delta x}{\\max_j |u_j^n|}, \\frac{\\Delta x^2}{2\\nu}\\right)\n$$\n其中 $C$ 是一个安全因子 $(0  C  1)$。最小值中的第一项是对流约束，第二项是扩散约束。在每次迭代中计算自适应时间步长以确保稳定性。\n\n初始条件是一个光滑的类激波剖面：\n$$\nu(x,0) = -\\tanh(x/\\delta)\n$$\n这被应用于网格，使得 $u_j^0 = -\\tanh(x_j/\\delta)$。边界条件在所有时间内都是固定的（狄利克雷条件）：$u(x_0, t) = u(-1, t) = +1$ 和 $u(x_{N_x-1}, t) = u(1, t) = -1$。在离散算法中，通过在每个时间层设置 $u_0^{n+1}=+1$ 和 $u_{N_x-1}^{n+1}=-1$ 来强制执行这些条件。\n\n整个算法流程如下：\n1.  从初始条件初始化解向量 $u^0$。强制施加边界值。\n2.  设置当前时间 $t=0$。\n3.  当 $t  T$ 时循环：\n    a. 计算最大绝对速度 $\\max|u^n|$。\n    b. 使用 CFL 条件计算稳定时间步长 $\\Delta t_n$。确保 $t + \\Delta t_n$ 不超过 $T$。\n    c. 对于所有内部点 $j=1, \\dots, N_x-2$，计算半离散方程的右端项。\n    d. 使用前向欧拉步更新内部点：$u_j^{n+1} = u_j^n + \\Delta t_n \\cdot (\\text{RHS})_j^n$。\n    e. 边界值 $u_0^{n+1}$ 和 $u_{N_x-1}^{n+1}$ 保持固定。\n    f. 推进时间：$t \\leftarrow t + \\Delta t_n$。\n4.  一旦 $t=T$，模拟完成。\n\n最后，计算诊断度量 $G(T)$。它被定义为在最终时间 $T$ 时网格内部空间梯度的最大绝对值：\n$$\nG(T) = \\max_{j \\in \\{1, \\dots, N_x-2\\}} \\left| \\left(\\frac{\\partial u}{\\partial x}\\right)_j \\right|\n$$\n梯度使用二阶中心差分进行近似：\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_j \\approx \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}\n$$\n该度量量化了剖面的陡峭程度，值越大表示“激波”越尖锐。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_burgers(nu, T, Nx, delta, C_cfl):\n    \"\"\"\n    Solves the 1D viscous Burgers' equation using a finite difference method.\n\n    Args:\n        nu (float): Viscosity coefficient.\n        T (float): Final time.\n        Nx (int): Number of grid points.\n        delta (float): Initial shock profile thickness parameter.\n        C_cfl (float): CFL safety factor.\n\n    Returns:\n        float: The diagnostic G(T) rounded to 6 decimal places.\n    \"\"\"\n    # 1. Setup the spatial grid and initial condition\n    L = 2.0\n    x = np.linspace(-L / 2.0, L / 2.0, Nx)\n    dx = L / (Nx - 1)\n\n    # Initial condition: u(x, 0) = -tanh(x / delta)\n    u = -np.tanh(x / delta)\n\n    # 2. Time evolution loop\n    t = 0.0\n    # The loop condition handles the T=0 case naturally.\n    while t  T:\n        # Enforce fixed Dirichlet boundary conditions at each step.\n        u[0] = 1.0\n        u[-1] = -1.0\n\n        # Calculate the adaptive time step based on the CFL condition.\n        umax = np.max(np.abs(u))\n        \n        # Convective time step constraint. Handle umax=0 to avoid division by zero.\n        if umax > 1e-12:\n            dt_conv = dx / umax\n        else:\n            dt_conv = float('inf')\n\n        # Diffusive time step constraint.\n        dt_diff = dx**2 / (2.0 * nu)\n        \n        # Determine the time step, ensuring not to step over the final time T.\n        dt = C_cfl * min(dt_conv, dt_diff)\n        if t + dt > T:\n            dt = T - t\n\n        # Store the current state to compute the RHS of the PDE.\n        u_old = u.copy()\n        \n        # Isolate interior points for vectorization.\n        u_interior = u_old[1:-1]\n\n        # Calculate convective term using first-order upwind scheme.\n        # This is vectorized for efficiency.\n        grad_fwd = (u_old[2:] - u_old[1:-1]) / dx\n        grad_bwd = (u_old[1:-1] - u_old[0:-2]) / dx\n        \n        # np.where selects the appropriate difference based on the sign of u.\n        convection_term = np.where(u_interior > 0, u_interior * grad_bwd, u_interior * grad_fwd)\n\n        # Calculate diffusive term using second-order central difference.\n        diffusion_term = nu * (u_old[2:] - 2 * u_old[1:-1] + u_old[0:-2]) / (dx**2)\n        \n        # Update the solution for interior points using forward Euler.\n        u[1:-1] = u_interior + dt * (-convection_term + diffusion_term)\n\n        # Advance time.\n        t += dt\n\n    # 3. Post-processing: Compute the diagnostic G(T).\n    # The gradient is computed on interior points using a centered difference.\n    du_dx_interior = (u[2:] - u[0:-2]) / (2.0 * dx)\n    \n    # G(T) is the max absolute value of this gradient.\n    G_T = np.max(np.abs(du_dx_interior))\n\n    return round(G_T, 6)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.01, 0.2, 401, 0.05, 0.4),   # Case 1\n        (0.001, 0.2, 401, 0.05, 0.4),  # Case 2\n        (0.05, 0.2, 401, 0.05, 0.4),   # Case 3\n        (0.01, 0.0, 401, 0.05, 0.4),   # Case 4 (edge case)\n    ]\n\n    results = []\n    for case in test_cases:\n        nu, T, Nx, delta, C_cfl = case\n        result = solve_burgers(nu, T, Nx, delta, C_cfl)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在计算中，我们常追求高精度，但数值误差有时也能出人意料地模拟物理效应。对于湍流等复杂流动，当模拟分辨率不足时，低阶格式（如一阶迎风）产生的数值耗散会像一个“隐式”的湍流模型一样，耗散掉无法解析的尺度上的能量。本练习旨在量化这种数值耗散，并将其与一个“显式”的亚格子模型（Smagorinsky模型）的耗散进行直接比较，从而揭示“隐式大涡模拟”（ILES）与标准大涡模拟（LES）在哲学上的联系与区别。",
            "id": "2447860",
            "problem": "要求您在一维、周期性、欠解析的设置中，量化和比较由一阶迎风格式的隐式数值扩散和显式 Smagorinsky 亚格子尺度模型引起的瞬时动能耗散。请完全在一维周期性域中进行计算，并使用下面给出的定义。所有角度都应以弧度为单位。所有涉及物理量的输出都必须以国际单位制 (SI) 报告。\n\n考虑一个标量场 $u(x,t)$，作为在周期性域 $x \\in [0,L)$（其中 $L0$）上演化的速度分量的替代。设均匀网格有 $N$ 个点，间距为 $\\Delta x = L/N$，并采用周期性索引。定义节点位置 $x_i = i\\,\\Delta x$（对于 $i \\in \\{0,1,\\dots,N-1\\}$）和初始场\n$$\nu_i = u(x_i,0) = U_0 \\,\\sin\\!\\left(\\frac{2\\pi m}{L}\\,x_i\\right)\n$$\n其中 $U_00$ 是振幅，$m \\in \\mathbb{Z}^+$ 是域中的波长数量。均匀平流速度 $a \\ge 0$ 是恒定的。Smagorinsky 常数 $C_s0$ 是无量纲的，滤波宽度取为 $\\Delta=\\Delta x$。\n\n定义单位质量单位长度的离散动能为\n$$\nE = \\frac{1}{2L}\\sum_{i=0}^{N-1} u_i^2\\,\\Delta x,\n$$\n并定义单位质量单位长度的瞬时动能耗散率为\n$$\nD = -\\frac{\\mathrm{d}E}{\\mathrm{d}t}.\n$$\n\n您必须在同一网格上，使用周期性索引，为以下两个半离散模型计算 $t=0$ 时的 $D$：\n\n1) 一阶迎风平流（恒定速度 $a \\ge 0$）：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -\\,a\\,\\frac{u_i - u_{i-1}}{\\Delta x}.\n$$\n\n2) 带有显式 Smagorinsky 亚格子尺度粘性的中心平流：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -\\,a\\,\\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x} \\;+\\; \\left[\\frac{\\partial}{\\partial x}\\left(\\nu_{t}\\,\\frac{\\partial u}{\\partial x}\\right)\\right]_i,\n$$\n其中离散梯度为\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_i \\equiv g_i = \\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x},\n$$\nSmagorinsky 涡粘性为\n$$\n\\nu_{t,i} = \\left(C_s\\,\\Delta x\\right)^2\\,|g_i|,\n$$\n粘性通量的离散散度使用中心差分\n$$\n\\left[\\frac{\\partial}{\\partial x}\\left(\\nu_{t}\\,\\frac{\\partial u}{\\partial x}\\right)\\right]_i = \\frac{(\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}}{2\\,\\Delta x}.\n$$\n\n对于每个模型，通过半离散右侧项直接计算 $t=0$ 时的 $D$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{1}{L}\\sum_{i=0}^{N-1} u_i \\left(\\frac{\\mathrm{d}u_i}{\\mathrm{d}t}\\right)\\Delta x,\n$$\n然后 $D=-\\mathrm{d}E/\\mathrm{d}t$。为每个测试案例报告以下内容：\n- 迎风模型的 $D_{\\text{up}}$，单位为 $\\mathrm{m}^2/\\mathrm{s}^3$，四舍五入到六位小数。\n- Smagorinsky 模型的 $D_{\\text{sgs}}$，单位为 $\\mathrm{m}^2/\\mathrm{s}^3$，四舍五入到六位小数。\n- 无量纲比率 $R = D_{\\text{up}}/D_{\\text{sgs}}$，四舍五入到六位小数。\n\n使用以下测试套件，其旨在探究一个典型案例、一个更严重欠解析的案例以及一个平流速度为零的边界情况：\n- 案例 A（一般欠解析）：$L = 2\\pi\\,\\mathrm{m}$，$N=16$，$m=3$，$U_0 = 1.0\\,\\mathrm{m/s}$，$a=1.0\\,\\mathrm{m/s}$，$C_s=0.17$。\n- 案例 B（更严重欠解析）：$L = 2\\pi\\,\\mathrm{m}$，$N=12$，$m=3$，$U_0 = 1.0\\,\\mathrm{m/s}$，$a=1.0\\,\\mathrm{m/s}$，$C_s=0.17$。\n- 案例 C（隐式耗散的边界情况）：$L = 2\\pi\\,\\mathrm{m}$，$N=16$，$m=3$，$U_0 = 1.0\\,\\mathrm{m/s}$，$a=0.0\\,\\mathrm{m/s}$，$C_s=0.17$。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个元素是表示一个测试案例的三元素列表，顺序为 $\\left[D_{\\text{up}},D_{\\text{sgs}},R\\right]$。例如：\n\"[ [D_up_A,D_sgs_A,R_A], [D_up_B,D_sgs_B,R_B], [D_up_C,D_sgs_C,R_C] ]\"\n所有 $D_{\\text{up}}$ 和 $D_{\\text{sgs}}$ 值必须以 $\\mathrm{m}^2/\\mathrm{s}^3$ 为单位，$R$ 必须是无量纲的。每个数值必须四舍五入到六位小数，并表示为十进制数。",
            "solution": "所述问题是有效的。它在科学上基于计算流体力学的原理，特别是数值格式和湍流模拟的分析。它是适定的，所有必要的参数和方程都已提供，以获得唯一解。其语言是客观的，要求是明确的。我们将进行完整的求解。\n\n目标是量化和比较一维平流问题在时间 $t=0$ 时，两种不同半离散模型的瞬时动能耗散率。该分析在由 $N$ 个均匀间隔点离散化的周期性域 $x \\in [0, L)$ 上进行。\n\n首先，我们建立基本定义。单位质量单位长度的离散动能由下式给出：\n$$\nE = \\frac{1}{2L}\\sum_{i=0}^{N-1} u_i^2\\,\\Delta x\n$$\n其中 $u_i$ 是网格点 $i$ 处的标量场，$\\Delta x = L/N$。单位质量单位长度的瞬时动能耗散率 $D$ 定义为 $E$ 的负时间导数：\n$$\nD = -\\frac{\\mathrm{d}E}{\\mathrm{d}t}\n$$\n通过对 $E$ 的表达式求时间导数，我们基于 $u_i$ 的半离散演化方程，得到其变化率的公式：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2L}\\sum_{i=0}^{N-1} u_i^2\\,\\Delta x\\right) = \\frac{\\Delta x}{2L}\\sum_{i=0}^{N-1} 2u_i\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\frac{1}{N}\\sum_{i=0}^{N-1} u_i\\frac{\\mathrm{d}u_i}{\\mathrm{d}t}\n$$\n因此，待计算的耗散率为：\n$$\nD = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left(\\frac{\\mathrm{d}u_i}{\\mathrm{d}t}\\right)_i\n$$\n初始条件为单一正弦模态：\n$$\nu_i(0) = U_0 \\,\\sin\\!\\left(\\frac{2\\pi m}{L}\\,x_i\\right)\n$$\n现在我们将分别分析每个模型。\n\n**模型 1：一阶迎风平流**\n\n对于恒定平流速度 $a \\ge 0$ 的一阶迎风格式，其半离散方程为：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -a\\,\\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n将此代入耗散率的表达式，我们得到迎风格式的耗散 $D_{\\text{up}}$：\n$$\nD_{\\text{up}} = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left( -a\\,\\frac{u_i - u_{i-1}}{\\Delta x} \\right) = \\frac{a}{N\\Delta x}\\sum_{i=0}^{N-1} u_i(u_i - u_{i-1})\n$$\n使用 $\\Delta x = L/N$，可简化为：\n$$\nD_{\\text{up}} = \\frac{a}{L}\\sum_{i=0}^{N-1} (u_i^2 - u_i u_{i-1})\n$$\n此公式表明，耗散是空间离散化的直接结果，并与平流速度 $a$ 成正比。这是一阶迎风格式固有的著名数值扩散。\n\n**模型 2：带有显式 Smagorinsky 亚格子尺度 (SGS) 模型的中心平流**\n\n半离散方程将用于平流的二阶中心差分与一个显式 SGS 粘性项结合起来：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\underbrace{-\\,a\\,\\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x}}_{\\text{平流}} \\;+\\; \\underbrace{\\frac{(\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}}{2\\,\\Delta x}}_{\\text{SGS 扩散}}\n$$\n其中 $g_i = (u_{i+1}-u_{i-1})/(2\\Delta x)$ 是离散梯度，$\\nu_{t,i} = (C_s \\Delta x)^2 |g_i|$ 是 Smagorinsky 涡粘性。总耗散 $D_{\\text{sgs}}$ 是右侧两项贡献之和。\n\n来自中心平流项的贡献是：\n$$\nD_{\\text{adv}} = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left( -a\\,\\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x} \\right) = \\frac{a}{2N\\Delta x}\\sum_{i=0}^{N-1} u_i(u_{i+1}-u_{i-1})\n$$\n由于周期性，通过离散分部求和，该求和项为零：\n$$\n\\sum_{i=0}^{N-1} u_i(u_{i+1}-u_{i-1}) = \\sum_{i=0}^{N-1} u_i u_{i+1} - \\sum_{i=0}^{N-1} u_i u_{i-1}\n$$\n通过用 $j=i-1$ 重新索引第二个和（并利用周期性），它变为 $\\sum_{j=0}^{N-1} u_{j+1} u_j$。这两个和是相同的，相互抵消，证明了中心差分平流格式对于总动能是非耗散的。\n\n因此，此模型中的耗散完全来自显式 SGS 项。\n$$\nD_{\\text{sgs}} = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left( \\frac{(\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}}{2\\,\\Delta x} \\right)\n$$\n对此表达式应用分部求和：\n$$\nD_{\\text{sgs}} = -\\frac{1}{2N\\Delta x} \\sum_i u_i ((\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}) = \\frac{1}{2N\\Delta x} \\sum_i (u_{i+1}-u_{i-1}) (\\nu_t g)_i\n$$\n认识到 $g_i = (u_{i+1}-u_{i-1})/(2\\Delta x)$，我们得到一个简化的、正定的公式：\n$$\nD_{\\text{sgs}} = \\frac{1}{N}\\sum_{i=0}^{N-1} g_i (\\nu_t g)_i = \\frac{1}{N}\\sum_{i=0}^{N-1} \\nu_{t,i} g_i^2\n$$\n代入 $\\nu_{t,i}$ 的定义：\n$$\nD_{\\text{sgs}} = \\frac{1}{N}\\sum_{i=0}^{N-1} (C_s\\Delta x)^2|g_i| \\cdot g_i^2 = \\frac{(C_s\\Delta x)^2}{N}\\sum_{i=0}^{N-1} |g_i|^3\n$$\n这在物理上表示动能从可解尺度中被移除并转移到亚格子尺度的速率，而这正是 SGS 模型的目的。\n\n**计算步骤**\n\n对于每个测试案例，我们将执行以下步骤：\n1. 使用给定参数 $L, N, m, U_0$ 初始化网格 $x_i$ 和 $t=0$ 时的场 $u_i$。\n2. 使用公式 $D_{\\text{up}} = \\frac{a}{L}\\sum_{i=0}^{N-1} (u_i^2 - u_i u_{i-1})$ 计算 $D_{\\text{up}}$。对于周期性边界，$u_{-1}$ 取为 $u_{N-1}$。\n3. 计算离散梯度 $g_i = (u_{i+1}-u_{i-1})/(2\\Delta x)$，其中 $u_{N}$ 为 $u_0$，$u_{-1}$ 为 $u_{N-1}$。\n4. 使用公式 $D_{\\text{sgs}} = \\frac{(C_s\\Delta x)^2}{N}\\sum_{i=0}^{N-1} |g_i|^3$ 计算 $D_{\\text{sgs}}$。\n5. 计算比率 $R = D_{\\text{up}}/D_{\\text{sgs}}$。对于案例 C，其中 $a=0$，$D_{\\text{up}}$ 将为零，导致 $R=0$。\n6. 按要求将所有数值结果四舍五入到六位小数。为提高效率，将使用数值数组进行实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the instantaneous kinetic energy dissipation rate for two numerical schemes\n    for a one-dimensional advection problem on a periodic domain.\n    \"\"\"\n\n    test_cases = [\n        # Case A: General under-resolved case\n        {'L': 2 * np.pi, 'N': 16, 'm': 3, 'U0': 1.0, 'a': 1.0, 'Cs': 0.17},\n        # Case B: More severe under-resolution\n        {'L': 2 * np.pi, 'N': 12, 'm': 3, 'U0': 1.0, 'a': 1.0, 'Cs': 0.17},\n        # Case C: Edge case with zero advection speed\n        {'L': 2 * np.pi, 'N': 16, 'm': 3, 'U0': 1.0, 'a': 0.0, 'Cs': 0.17},\n    ]\n\n    results = []\n    for params in test_cases:\n        # Extract parameters for the current test case\n        L = params['L']\n        N = params['N']\n        m = params['m']\n        U0 = params['U0']\n        a = params['a']\n        Cs = params['Cs']\n\n        # 1. Set up grid and initial condition\n        dx = L / N\n        # x_i = i * dx\n        x = np.arange(N) * dx\n        # Initial field u(x,0)\n        # Using the fact that L=2*pi simplifies the argument of sin\n        u = U0 * np.sin(m * x)\n\n        # 2. Compute dissipation for the first-order upwind scheme (D_up)\n        # u_{i-1} using periodic boundary condition\n        u_im1 = np.roll(u, 1)\n        # D_up = (a/L) * sum(u_i^2 - u_i * u_{i-1})\n        sum_term_up = np.sum(u**2 - u * u_im1)\n        D_up = a / L * sum_term_up\n\n        # 3. Compute dissipation for the Smagorinsky SGS model (D_sgs)\n        # u_{i+1} and u_{i-1} using periodic boundary conditions\n        u_ip1 = np.roll(u, -1)\n        # Gradient g_i = (u_{i+1} - u_{i-1}) / (2*dx)\n        g = (u_ip1 - u_im1) / (2 * dx)\n        # D_sgs = ((Cs*dx)^2 / N) * sum(|g_i|^3)\n        sum_term_sgs = np.sum(np.abs(g)**3)\n        D_sgs = ((Cs * dx)**2 / N) * sum_term_sgs\n        \n        # 4. Compute the ratio R = D_up / D_sgs\n        # This handles the case where D_sgs could be zero, although not expected here.\n        # For Case C, a=0 implies D_up=0, so R=0.\n        if D_sgs != 0:\n            R = D_up / D_sgs\n        elif D_up == 0:\n            R = 0.0\n        else:\n            R = np.inf # Should not occur in these test cases\n\n        # 5. Round results to six decimal places\n        D_up_rounded = round(D_up, 6)\n        D_sgs_rounded = round(D_sgs, 6)\n        R_rounded = round(R, 6)\n\n        results.append([D_up_rounded, D_sgs_rounded, R_rounded])\n\n    # Format the final output string exactly as specified in the problem,\n    # including spaces as shown in the example.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n```"
        }
    ]
}