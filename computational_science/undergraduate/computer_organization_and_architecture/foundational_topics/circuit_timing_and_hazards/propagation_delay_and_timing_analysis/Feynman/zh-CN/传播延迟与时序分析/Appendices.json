{
    "hands_on_practices": [
        {
            "introduction": "本练习是时序分析的基础。我们将剖析一个真实的处理器数据通路——高速缓存读取操作——以确定其最高工作频率 。通过计算关键路径（寄存器之间最慢的逻辑路径）的延迟，我们可以找到最小可能的时钟周期，并了解逻辑门、存储阵列和时钟不确定性（如偏移和抖动）等不同组件如何共同影响整体性能。",
            "id": "3670838",
            "problem": "中央处理器 (CPU) 的一个流水线阶段从一个使用静态随机存取存储器 (SRAM) 实现的一级 (L1) 数据缓存中执行单周期读取。地址在时钟上升沿由源寄存器发出，并在下一个时钟上升沿由目标寄存器捕获。读取路径包括以下阶段：\n\n- 在标签阵列中进行标签比较，最坏情况延迟为 $t_{\\text{tag}}$。\n- 在数据阵列中进行字线激活，最坏情况延迟为 $t_{\\text{wl}}$。\n- 在数据阵列中进行位线建立和感应，最坏情况延迟为 $t_{\\text{bl}}$。\n- 读出放大器 (SA) 判决时间，最坏情况延迟为 $t_{\\text{sa}}$。\n- 输出多路复用器选择，最坏情况延迟为 $t_{\\text{mux}}$。\n- 目标寄存器的建立时间，$t_{\\text{setup}}$。\n\n假设一个简单的组织结构，其中在地址发出后，标签比较和数据阵列访问并行进行，并且输出多路复用器由标签匹配结果控制。目标寄存器对多路复用器的输出进行采样。时钟分配具有有界的偏斜和抖动。\n\n给定在目标工作角点下的以下最坏情况参数：\n- 源寄存器 clock-to-$Q$ 延迟：$t_{\\text{cq}} = 37 \\ \\text{ps}$。\n- 标签比较延迟：$t_{\\text{tag}} = 205 \\ \\text{ps}$。\n- 数据阵列字线延迟：$t_{\\text{wl}} = 135 \\ \\text{ps}$。\n- 数据阵列位线建立延迟：$t_{\\text{bl}} = 295 \\ \\text{ps}$。\n- 读出放大器延迟：$t_{\\text{sa}} = 82 \\ \\text{ps}$。\n- 输出多路复用器延迟：$t_{\\text{mux}} = 58 \\ \\text{ps}$。\n- 目标寄存器建立时间：$t_{\\text{setup}} = 54 \\ \\text{ps}$。\n- 时钟偏斜预算：$t_{\\text{skew}} = 22 \\ \\text{ps}$。\n- 周期到周期时钟抖动预算：$t_{\\text{jitter}} = 13 \\ \\text{ps}$。\n\n使用同步时序的基本原理，计算保证该组织结构中最坏情况路径能正确采样的最小可行时钟周期 $T_{\\text{clk}}$。将您的答案四舍五入到四位有效数字，并以 $\\text{ns}$ 为单位表示。\n\n此外，请确定在 $\\{\\text{标签比较}, \\text{字线}, \\text{位线}, \\text{读出放大器}, \\text{多路复用器}\\}$ 中，哪个单一命名阶段是多路复用器之前关键路径延迟的主要贡献者。请在您的推理过程中提供该阶段的名称，但请注意，最终的数值答案必须仅为 $T_{\\text{clk}}$（以 $\\text{ns}$ 为单位），并按要求进行四舍五入。",
            "solution": "该问题要求计算同步数字电路的最小可行时钟周期 $T_{\\text{clk}}$。此计算的指导原则是建立时间约束，该约束确保数据在捕获时钟沿到达之前，到达寄存器输入端并稳定至少一段最短时间 ($t_{\\text{setup}}$)。\n\n建立时间约束的通用时序方程为：\n$$T_{\\text{clk}} \\ge t_{\\text{cq}} + t_{\\text{logic}} + t_{\\text{setup}} + t_{\\text{uncertainty}}$$\n项 $t_{\\text{uncertainty}}$ 考虑了时钟的非理想性，特别是时钟偏斜 ($t_{\\text{skew}}$) 和时钟抖动 ($t_{\\text{jitter}}$)。在最坏情况的建立时间分析中，偏斜和抖动都会减少逻辑计算的可用时间，因此它们被加到路径延迟中。因此，最小时钟周期 $T_{\\text{clk,min}}$ 由下式给出：\n$$T_{\\text{clk,min}} = t_{\\text{cq}} + t_{\\text{logic}} + t_{\\text{setup}} + t_{\\text{skew}} + t_{\\text{jitter}}$$\n\n项 $t_{\\text{logic}}$ 表示源寄存器和目标寄存器之间组合逻辑路径的总延迟。我们必须首先根据问题描述确定该路径的结构。\n\n地址从源寄存器发出，并通过两条并行路径传播：\n1.  标签路径，由标签比较组成。此路径的延迟为 $t_{\\text{tag-path}} = t_{\\text{tag}}$。\n2.  数据路径，涉及字线的顺序激活、位线建立和感应。此路径的延迟为 $t_{\\text{data-path}} = t_{\\text{wl}} + t_{\\text{bl}} + t_{\\text{sa}}$。\n\n这两条路径的结果在输出多路复用器处汇合。多路复用器的选择输入由标签比较结果驱动，其数据输入由来自数据阵列的读出放大器输出驱动。只有在选择输入和数据输入都稳定后，多路复用器才能产生稳定的输出。因此，到多路复用器输入的延迟是两条并行路径延迟的最大值。\n$$t_{\\text{delay-to-mux}} = \\max(t_{\\text{tag-path}}, t_{\\text{data-path}}) = \\max(t_{\\text{tag}}, t_{\\text{wl}} + t_{\\text{bl}} + t_{\\text{sa}})$$\n信号到达多路复用器后，信号传播通过它到达目标寄存器输入端还需要一个额外的延迟 $t_{\\text{mux}}$。因此，总的组合逻辑延迟 $t_{\\text{logic}}$ 为：\n$$t_{\\text{logic}} = \\max(t_{\\text{tag}}, t_{\\text{wl}} + t_{\\text{bl}} + t_{\\text{sa}}) + t_{\\text{mux}}$$\n\n现在，我们将给定的数值代入这些表达式中。所有延迟值都以皮秒 ($\\text{ps}$) 为单位。\n给定的延迟为：\n- $t_{\\text{cq}} = 37 \\ \\text{ps}$\n- $t_{\\text{tag}} = 205 \\ \\text{ps}$\n- $t_{\\text{wl}} = 135 \\ \\text{ps}$\n- $t_{\\text{bl}} = 295 \\ \\text{ps}$\n- $t_{\\text{sa}} = 82 \\ \\text{ps}$\n- $t_{\\text{mux}} = 58 \\ \\text{ps}$\n- $t_{\\text{setup}} = 54 \\ \\text{ps}$\n- $t_{\\text{skew}} = 22 \\ \\text{ps}$\n- $t_{\\text{jitter}} = 13 \\ \\text{ps}$\n\n首先，我们计算数据路径的延迟：\n$$t_{\\text{data-path}} = t_{\\text{wl}} + t_{\\text{bl}} + t_{\\text{sa}} = 135 \\ \\text{ps} + 295 \\ \\text{ps} + 82 \\ \\text{ps} = 512 \\ \\text{ps}$$\n接下来，我们将数据路径延迟与标签路径延迟进行比较，以找出输入到多路复用器的关键路径：\n$$t_{\\text{delay-to-mux}} = \\max(t_{\\text{tag}}, t_{\\text{data-path}}) = \\max(205 \\ \\text{ps}, 512 \\ \\text{ps}) = 512 \\ \\text{ps}$$\n多路复用器之前的关键路径是数据路径。问题要求确定该路径中起主导作用的单一命名阶段。比较数据路径的各个组成部分，$t_{\\text{wl}} = 135 \\ \\text{ps}$、$t_{\\text{bl}} = 295 \\ \\text{ps}$ 和 $t_{\\text{sa}} = 82 \\ \\text{ps}$，位线建立延迟 ($t_{\\text{bl}}$) 是最大的。因此，主要贡献者是 **位线** 阶段。\n\n现在，我们计算总的逻辑延迟 $t_{\\text{logic}}$：\n$$t_{\\text{logic}} = t_{\\text{delay-to-mux}} + t_{\\text{mux}} = 512 \\ \\text{ps} + 58 \\ \\text{ps} = 570 \\ \\text{ps}$$\n最后，我们将所有分量延迟代入最小时钟周期的方程中：\n$$T_{\\text{clk,min}} = t_{\\text{cq}} + t_{\\text{logic}} + t_{\\text{setup}} + t_{\\text{skew}} + t_{\\text{jitter}}$$\n$$T_{\\text{clk,min}} = 37 \\ \\text{ps} + 570 \\ \\text{ps} + 54 \\ \\text{ps} + 22 \\ \\text{ps} + 13 \\ \\text{ps} = 696 \\ \\text{ps}$$\n问题要求答案以纳秒 ($\\text{ns}$) 表示，并四舍五入到四位有效数字。\n$$T_{\\text{clk,min}} = 696 \\ \\text{ps} = 0.696 \\ \\text{ns}$$\n四舍五入到四位有效数字，我们得到 $0.6960 \\ \\text{ns}$。",
            "answer": "$$\\boxed{0.6960}$$"
        },
        {
            "introduction": "建立时间决定了电路能运行多快，而保持时间则确保了其正确性。本练习探讨了信号“过快”的问题，即数据在时钟沿后变化太快导致错误 。我们将分析一个流水线旁路通路，并学习一种实用技术——插入缓冲器——通过策略性地为短路径增加延迟来修复保持时间违例。",
            "id": "3670803",
            "problem": "一个单时钟域中的流水线阶段使用旁路（转发）路径来减少发送寄存器和捕获寄存器之间的延迟。这两个寄存器是上升沿触发的D触发器（DFF）。旁路路径减少了最小组合延迟，这在存在时钟偏斜时，有违反捕获寄存器保持时间要求的风险。保持时间定义为在捕获时钟沿之后，捕获寄存器输入端的数据必须保持稳定的时间间隔。时钟偏斜定义为 $s = t_{\\text{dest clk}} - t_{\\text{src clk}}$，其中 $t_{\\text{dest clk}}$ 是捕获时钟沿的到达时间，而 $t_{\\text{src clk}}$ 是发送时钟沿的到达时间。从发送寄存器到捕获寄存器输入的最小传播延迟是发送寄存器的最小“时钟到Q端”延迟与最小组合路径延迟之和。\n\n给定以下参数，单位均为皮秒（ps）：\n- 发送寄存器最小“时钟到Q端”延迟：$t_{\\text{cq,min}} = 35$。\n- 捕获寄存器保持时间：$t_{\\text{hold}} = 60$。\n- 时钟偏斜（目标减源）：$s = 15$。\n- 旁路路径最小逻辑延迟：$t_{\\text{bp,min}} = 10$。\n- 旁路路径上的最小互连延迟：$t_{\\text{wire,min}} = 5$。\n- 每个插入的单位缓冲器在旁路路径上贡献的最小传播延迟为 $d_b = 20$。\n\n仅使用保持时间的基本定义和给定的时钟偏斜，从第一性原理出发，推导为满足给定偏斜下的保持时间要求，必须在旁路路径中插入的相同单位缓冲器的最小数量 $N$，以使捕获寄存器输入端的最小数据到达时间被充分延迟。将您的最终答案表示为整数 $N$。整数结果无需舍入指令。最终答案中不要包含单位。",
            "solution": "本题要求我们确定在旁路路径中需要插入的最小缓冲器数量，以满足捕获触发器的保持时间要求。我们必须从时序分析的第一性原理出发。\n\n设 $t_{\\text{src clk}}$ 为时钟沿到达发送寄存器的时间， $t_{\\text{dest clk}}$ 为同一标称时钟沿到达捕获寄存器的时间。题目将时钟偏斜定义为 $s = t_{\\text{dest clk}} - t_{\\text{src clk}}$。\n\n捕获寄存器的保持时间要求规定，其输入数据在捕获时钟沿到达后必须保持稳定一段时长 $t_{\\text{hold}}$。这意味着来自前一个周期的数据不能在时间 $t_{\\text{dest clk}} + t_{\\text{hold}}$ 之前被新数据覆盖。因此，由源寄存器发出的新数据不得早于此时间到达捕获寄存器的输入端。\n\n新数据在时间 $t_{\\text{src clk}}$ 从源寄存器发出。经过发送寄存器的最小“时钟到Q端”延迟 $t_{\\text{cq,min}}$ 后，新数据出现在其输出端。此事件发生的时间是 $t_{\\text{src clk}} + t_{\\text{cq,min}}$。\n\n然后，该数据通过组合逻辑路径传播到捕获寄存器的输入端。为了检查是否存在保持时间违例，我们必须考虑最快的可能路径，即具有最小传播延迟的路径，我们将其表示为 $t_{\\text{path,min}}$。新数据到达捕获寄存器输入端的最早可能时间 $t_{\\text{data arrival,min}}$ 由下式给出：\n$$t_{\\text{data arrival,min}} = t_{\\text{src clk}} + t_{\\text{cq,min}} + t_{\\text{path,min}}$$\n为防止保持时间违例，这个最早到达时间必须大于或等于保持窗口关闭的时间。这给出了基本的保持时间不等式：\n$$t_{\\text{data arrival,min}} \\ge t_{\\text{dest clk}} + t_{\\text{hold}}$$\n代入 $t_{\\text{data arrival,min}}$ 的表达式：\n$$t_{\\text{src clk}} + t_{\\text{cq,min}} + t_{\\text{path,min}} \\ge t_{\\text{dest clk}} + t_{\\text{hold}}$$\n可以重新整理这个不等式，以包含时钟偏斜的定义 $s = t_{\\text{dest clk}} - t_{\\text{src clk}}$：\n$$t_{\\text{cq,min}} + t_{\\text{path,min}} \\ge (t_{\\text{dest clk}} - t_{\\text{src clk}}) + t_{\\text{hold}}$$\n$$t_{\\text{cq,min}} + t_{\\text{path,min}} \\ge s + t_{\\text{hold}}$$\n这就是保持时间约束方程。它规定了最小“时钟到Q端”延迟与最小路径延迟之和必须至少等于时钟偏斜与保持时间之和。\n\n题目指出，在旁路路径中插入 $N$ 个相同的单位缓冲器以增加延迟。总的最小路径延迟 $t_{\\text{path,min}}$ 是旁路逻辑的最小延迟（$t_{\\text{bp,min}}$）、互连线的最小延迟（$t_{\\text{wire,min}}$）以及 $N$ 个附加缓冲器的延迟之和，每个缓冲器的最小延迟为 $d_b$。\n$$t_{\\text{path,min}} = t_{\\text{bp,min}} + t_{\\text{wire,min}} + N \\cdot d_b$$\n将此代入保持时间约束方程：\n$$t_{\\text{cq,min}} + (t_{\\text{bp,min}} + t_{\\text{wire,min}} + N \\cdot d_b) \\ge s + t_{\\text{hold}}$$\n我们的目标是找到满足此条件的最小整数 $N$。我们可以分离出 $N$：\n$$N \\cdot d_b \\ge s + t_{\\text{hold}} - t_{\\text{cq,min}} - t_{\\text{bp,min}} - t_{\\text{wire,min}}$$\n$$N \\ge \\frac{s + t_{\\text{hold}} - t_{\\text{cq,min}} - t_{\\text{bp,min}} - t_{\\text{wire,min}}}{d_b}$$\n现在，我们代入指定的数值，单位均为皮秒（ps）：\n- $t_{\\text{cq,min}} = 35$\n- $t_{\\text{hold}} = 60$\n- $s = 15$\n- $t_{\\text{bp,min}} = 10$\n- $t_{\\text{wire,min}} = 5$\n- $d_b = 20$\n\n将这些值代入关于 $N$ 的不等式：\n$$N \\ge \\frac{15 + 60 - 35 - 10 - 5}{20}$$\n$$N \\ge \\frac{75 - (35 + 10 + 5)}{20}$$\n$$N \\ge \\frac{75 - 50}{20}$$\n$$N \\ge \\frac{25}{20}$$\n$$N \\ge 1.25$$\n由于 $N$ 代表物理缓冲器的数量，它必须是一个整数。满足不等式 $N \\ge 1.25$ 的最小整数值是 $2$。因此，必须插入最少 $2$ 个缓冲器才能保证满足保持时间要求。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "掌握了建立时间和保持时间约束后，我们现在可以利用它们通过流水线技术来主动提升电路性能。本练习将演示如何通过插入寄存器将一个长的组合逻辑路径分解为更短的阶段 。我们将分析一个ALU数据通路，并确定流水线寄存器的最佳放置位置，以平衡各阶段的延迟，从而实现最快的时钟速度。",
            "id": "3670819",
            "problem": "一个处理器的数据通路包含一个算术逻辑单元（ALU），该ALU执行一个复合操作，其最坏情况下的数据通路是由三个组合逻辑块组成的固定序列：一个加法器，后跟一个桶形移位器，再后跟一个最终的输出多路选择器。你可以在ALU内部精确插入一个流水线寄存器，使得这个ALU操作在两个流水线阶段上执行。模块的顺序是固定的：加法器的输出连接到移位器的输入，移位器的输出再连接到多路选择器的输入。目标是选择一种寄存器放置方案，以最小化每个阶段的最大组合逻辑延迟，同时确保在每个接收寄存器处满足建立时间要求。\n\n假设模块的传播延迟如下：加法器延迟 $t_{A} = 0.317\\,\\text{ns}$，移位器延迟 $t_{S} = 0.183\\,\\text{ns}$，以及多路选择器延迟 $t_{M} = 0.092\\,\\text{ns}$。每个流水线寄存器的建立时间为 $t_{\\text{setup}} = 0.039\\,\\text{ns}$。忽略时钟到Q端的延迟、时钟偏斜以及给定模块延迟之外的任何互连延迟。内部流水线寄存器只有两个合法放置位置：在加法器和移位器之间，或在移位器和多路选择器之间。在两种情况下，阶段边界都必须遵守给定的模块顺序。\n\n仅使用同步时序的基本定义，在所述假设下，通过对内部流水线寄存器进行最优放置，确定可实现的最小可行单周期时钟周期 $T_{\\text{clk,min}}$。请以纳秒为单位表示您的最终答案，并将其四舍五入到四位有效数字。",
            "solution": "本题的目标是通过在组合逻辑路径中最佳地插入一个流水线寄存器来最小化时钟周期。系统的最小可行时钟周期 $T_{\\text{clk,min}}$ 由最慢的流水线阶段决定。根据题目的简化假设（忽略 $t_{\\text{clk-q}}$ 和时钟偏斜），一个阶段的延迟是其组合逻辑延迟 $t_{\\text{comb, stage}}$ 与寄存器建立时间 $t_{\\text{setup}}$ 之和。因此，整个流水线的时钟周期为：\n$$T_{\\text{clk,min}} = \\max(t_{\\text{comb, stage}}) + t_{\\text{setup}}$$\n\n我们已知模块的传播延迟：\n- 加法器延迟: $t_{A} = 0.317\\,\\text{ns}$\n- 移位器延迟: $t_{S} = 0.183\\,\\text{ns}$\n- 多路选择器延迟: $t_{M} = 0.092\\,\\text{ns}$\n- 寄存器建立时间: $t_{\\text{setup}} = 0.039\\,\\text{ns}$\n\n我们需要分析两种流水线寄存器放置方案：\n\n**情况1：寄存器放置在加法器和移位器之间。**\n- 阶段1延迟（加法器）: $t_{\\text{stage1}} = t_{A} = 0.317\\,\\text{ns}$\n- 阶段2延迟（移位器 + 多路选择器）: $t_{\\text{stage2}} = t_{S} + t_{M} = 0.183\\,\\text{ns} + 0.092\\,\\text{ns} = 0.275\\,\\text{ns}$\n此方案中，最长的组合逻辑延迟为 $t_{\\text{comb,max,1}} = \\max(0.317\\,\\text{ns}, 0.275\\,\\text{ns}) = 0.317\\,\\text{ns}$。\n对应的时钟周期为 $T_{\\text{clk},1} = 0.317\\,\\text{ns} + 0.039\\,\\text{ns} = 0.356\\,\\text{ns}$。\n\n**情况2：寄存器放置在移位器和多路选择器之间。**\n- 阶段1延迟（加法器 + 移位器）: $t_{\\text{stage1}} = t_{A} + t_{S} = 0.317\\,\\text{ns} + 0.183\\,\\text{ns} = 0.500\\,\\text{ns}$\n- 阶段2延迟（多路选择器）: $t_{\\text{stage2}} = t_{M} = 0.092\\,\\text{ns}$\n此方案中，最长的组合逻辑延迟为 $t_{\\text{comb,max,2}} = \\max(0.500\\,\\text{ns}, 0.092\\,\\text{ns}) = 0.500\\,\\text{ns}$。\n对应的时钟周期为 $T_{\\text{clk},2} = 0.500\\,\\text{ns} + 0.039\\,\\text{ns} = 0.539\\,\\text{ns}$。\n\n**结论**\n为了实现最小的时钟周期，我们选择两种情况中周期较小者：\n$$T_{\\text{clk,min}} = \\min(T_{\\text{clk},1}, T_{\\text{clk},2}) = \\min(0.356\\,\\text{ns}, 0.539\\,\\text{ns}) = 0.356\\,\\text{ns}$$\n最优放置是在加法器和移位器之间，因为它能更好地平衡两个流水线阶段的延迟。\n\n问题要求答案四舍五入到四位有效数字，因此结果为 $0.3560\\,\\text{ns}$。",
            "answer": "$$\\boxed{0.3560}$$"
        }
    ]
}