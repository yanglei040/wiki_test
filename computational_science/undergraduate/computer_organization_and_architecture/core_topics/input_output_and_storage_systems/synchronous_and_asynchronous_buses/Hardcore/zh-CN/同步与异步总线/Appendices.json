{
    "hands_on_practices": [
        {
            "introduction": "在为特定应用选择总线架构时，功耗是一个关键的决定因素。本练习将探讨同步总线和异步总线在能量消耗上的根本差异，特别是与数据活动相关的动态功耗。通过从第一性原理出发，你将推导出CMOS电路中数据传输的能量模型，并量化在不同数据活动模式下两种总线类型的能效表现。这个实践将阐明为什么异步设计在数据传输稀疏的应用中具有天然的低功耗优势。",
            "id": "3683515",
            "problem": "考虑一个采用互补金属氧化物半导体（CMOS）技术实现的宽片上数据总线。该总线宽度为 $w$ 位，每条位线呈现一个负载电容 $C_{\\ell}$。电源电压为 $V$。假设静态泄漏和短路功率可以忽略不计，并将每个位线转换建模为通过一个电阻网络对一个等效电容器进行充电或放电。\n\n该总线在两种模式下使用：\n- 同步模式，时钟频率高，总线上连续的字是独立的，每个比特为 $0$ 或 $1$ 的可能性相等。\n- 异步模式，数据活动稀疏，在连续的字之间只有一小部分比特位会经历 $0 \\to 1$ 的转换。\n\n利用从 $0$ 到 $V$ 通过电阻路径为电容器充电时的能量转换第一性原理，推导出在每种模式下，每个传输字从电源汲取的期望能量，作为 $w$、$C_{\\ell}$、$V$ 以及活动因子 $\\alpha$ 的函数。活动因子 $\\alpha$ 定义为在连续的字之间经历 $0 \\to 1$ 转换的比特位的期望分数。对于同步模式，根据独立性和等概率假设推导出 $\\alpha$。然后，使用以下参数评估异步与同步模式下每字能量的比率：\n- 总线宽度 $w = 128$，\n- 每比特线路电容 $C_{\\ell} = 0.20 \\,\\text{pF}$，\n- 电源电压 $V = 0.90 \\,\\text{V}$，\n- 异步活动因子 $\\alpha_{\\text{async}} = 0.05$。\n\n将最终结果表示为单一比率 $R = \\dfrac{E_{\\text{async}}}{E_{\\text{sync}}}$。无需四舍五入。如果计算中间能量，请以焦耳为单位表示。",
            "solution": "该问题是有效的，因为它科学地基于CMOS电路功耗的原理，问题提出得很好，提供了所有必要的信息，并使用了客观的技术语言。所提供的参数对于现代集成电路是物理上现实的。\n\n求解过程分为三个主要步骤：\n1.  基于第一性原理，推导单次 $0 \\to 1$ 比特转换从电源汲取的能量。\n2.  使用活动因子的概念，为同步和异步两种模式建立每字传输的期望能量公式。\n3.  计算异步能量与同步能量的比率。\n\n**步骤1：单次比特转换的能量**\n问题要求考虑通过电阻路径为电容器充电时的能量转换。设单条位线被建模为一个电容为 $C_{\\ell}$ 的电容器。一次 $0 \\to 1$ 的转换对应于将该电容器从初始电压 $0$ 充电到电源电压 $V$。充电过程通过上拉网络从电源电压 $V$ 进行，该网络具有某个等效电阻 $R$。\n\n充电期间从电源流出的瞬时电流为 $i(t)$。从电源汲取的瞬时功率为 $P(t) = V i(t)$。从电源汲取的总能量 $E_{\\text{supply}}$ 是该功率在整个充电期间（从 $t=0$ 到 $t \\to \\infty$）的积分：\n$$E_{\\text{supply}} = \\int_0^\\infty P(t) \\,dt = \\int_0^\\infty V i(t) \\,dt$$\n由于电源电压 $V$ 是恒定的，我们可以写出：\n$$E_{\\text{supply}} = V \\int_0^\\infty i(t) \\,dt$$\n电流对时间的积分是从电源流向电容器以将其充电至电压 $V$ 的总电荷 $Q$。电容器上存储的电荷由 $Q = C_{\\ell}V$ 给出。\n将此代入能量方程，我们得到：\n$$E_{\\text{supply}} = V Q = V(C_{\\ell}V) = C_{\\ell}V^2$$\n这是在单条位线上进行一次 $0 \\to 1$ 转换时从电源汲取的总能量。一个基本结论是，这些能量的一半，即 $\\frac{1}{2}C_{\\ell}V^2$，存储在电容器中，另一半则在电阻路径中以热量的形式耗散掉。\n\n对于 $1 \\to 0$ 的转换，电容器 $C_{\\ell}$ 通过下拉网络向地放电。存储的能量 $\\frac{1}{2}C_{\\ell}V^2$ 在下拉晶体管中以热量的形式耗散掉。在此过程中，没有能量从电源 $V$ 中汲取。\n对于 $0 \\to 0$ 和 $1 \\to 1$ 的转换，电容器电压不发生变化，因此不消耗动态能量。\n因此，只有在 $0 \\to 1$ 转换期间，动态能量才会从电源中汲取。\n\n**步骤2：每字的期望能量**\n每次字传输从电源汲取的总能量取决于从 $0$ 转换到 $1$ 的位线的期望数量。\n设 $\\alpha$ 为活动因子，定义为在连续字之间经历 $0 \\to 1$ 转换的比特位的期望分数。这等同于单条位线从 $0$ 转换到 $1$ 的概率。\n对于宽度为 $w$ 的总线，每次字传输的 $0 \\to 1$ 转换的期望数量 $N_{0 \\to 1}$ 为：\n$$N_{0 \\to 1} = w \\alpha$$\n每个字从电源汲取的总期望能量 $E_{\\text{word}}$ 是 $0 \\to 1$ 转换的期望数量与每次转换能量的乘积：\n$$E_{\\text{word}} = N_{0 \\to 1} \\times E_{\\text{supply}} = (w \\alpha) (C_{\\ell}V^2) = w \\alpha C_{\\ell}V^2$$\n\n**同步模式：**\n在同步模式下，连续的字是独立的，每个比特为 $0$ 或 $1$ 的可能性相等。设 $b_t$ 为比特在时间 $t$ 的状态。\n$$P(b_t=0) = \\frac{1}{2} \\quad \\text{和} \\quad P(b_t=1) = \\frac{1}{2}$$\n同步模式的活动因子 $\\alpha_{\\text{sync}}$ 是从时间 $t-1$ 到 $t$ 发生 $0 \\to 1$ 转换的概率。由于独立性：\n$$\\alpha_{\\text{sync}} = P(b_{t-1}=0 \\text{ and } b_t=1) = P(b_{t-1}=0) \\times P(b_t=1) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4} = 0.25$$\n在同步模式下，每字的期望能量为：\n$$E_{\\text{sync}} = w \\alpha_{\\text{sync}} C_{\\ell}V^2 = w (0.25) C_{\\ell}V^2$$\n\n**异步模式：**\n在异步模式下，活动因子 $\\alpha_{\\text{async}}$ 在问题陈述中直接作为反映稀疏数据活动的参数给出。\n$$\\alpha_{\\text{async}} = 0.05$$\n在异步模式下，每字的期望能量为：\n$$E_{\\text{async}} = w \\alpha_{\\text{async}} C_{\\ell}V^2 = w (0.05) C_{\\ell}V^2$$\n\n**步骤3：能量比率**\n问题要求计算比率 $R = \\frac{E_{\\text{async}}}{E_{\\text{sync}}}$。\n$$R = \\frac{w \\alpha_{\\text{async}} C_{\\ell}V^2}{w \\alpha_{\\text{sync}} C_{\\ell}V^2}$$\n总线宽度 ($w$)、线路电容 ($C_{\\ell}$) 和电源电压 ($V$) 的项相互抵消。该比率仅取决于两种模式的活动因子。\n$$R = \\frac{\\alpha_{\\text{async}}}{\\alpha_{\\text{sync}}}$$\n代入活动因子的值：\n$$R = \\frac{0.05}{0.25} = \\frac{5}{25} = \\frac{1}{5} = 0.2$$\n$w$、$C_{\\ell}$ 和 $V$ 的具体数值不需要用来计算最终比率，因为它们在两种模式下是相同的，因此相互抵消。该比率表明，在同步、随机数据模式下，总线每字消耗的能量是在所述的异步、稀疏数据模式下的 $5$ 倍。",
            "answer": "$$\\boxed{0.2}$$"
        },
        {
            "introduction": "除了能效，性能是衡量总线设计的另一个核心指标，尤其是在处理具有可变服务时间的设备时。本练习旨在对比同步和异步总线在真实世界可变工作负载下的平均传输延迟。你将为一个假设的片上性能计数器建模，分析同步总线的时钟周期量化效应以及异步总线的自适应握手延迟。通过这个计算，你将深入理解异步总线如何灵活适应服务时间的变化，而同步总线则受限于固定的时钟栅格。",
            "id": "3683502",
            "problem": "一个计算机系统内置两种外设互连：同步总线和异步总线。您的任务是为一个片上性能计数器建模，该计数器用于估计在工作负载可变的情况下，同步总线上每次数据传输的平均总线时钟周期数，并将其与异步总线上的平均握手持续时间进行比较。\n\n假设有以下操作定义和条件：\n\n- 在同步总线上，每次传输都由一个地址阶段和一个数据阶段组成。总线仅在时钟边界上采样数据。如果设备的服务时间超过了到下一个采样边界的时间，总线将插入等待状态，直到服务完成后或之后出现一个采样边界。性能计数器记录在长观察窗口内主动执行传输所花费的总线时钟周期总数以及已完成传输的总数。\n\n- 在异步总线上，使用经典的四相请求-应答握手协议：请求置位、应答置位、请求撤销、应答撤销。每个控制信号的转换都会产生一个固定的传播延迟。直到设备完成其服务，应答信号才会被置位。\n\n- 设备服务时间是一个模拟工作负载可变性的随机变量：服务时间等于 $x_{f}$（快速情况）的概率为 $p$，等于 $x_{s}$（慢速情况）的概率为 $1 - p$。同样的服务时间可变性适用于两种总线。\n\n给定以下参数：\n\n- 同步总线时钟频率 $f = 200$ 兆赫兹。\n- 异步总线上每次控制信号转换的传播延迟 $t_{p} = 1$ 纳秒。\n- 快速服务时间 $x_{f} = 7$ 纳秒。\n- 慢速服务时间 $x_{s} = 19$ 纳秒。\n- 快速情况概率 $p = 0.7$。\n\n仅使用同步传输时序和四相异步握手时间线的基​​本原理定义：\n\n1. 推导性能计数器在长窗口内报告的同步总线上每次传输的期望时钟周期数。\n2. 推导异步总线上的期望握手持续时间。\n3. 计算异步总线的期望握手持续时间与同步总线的期望传输时间（以秒为单位）的比率 $R$。\n\n将最终比率 $R$ 表示为一个简化的精确分数。无需四舍五入，该比率为无量纲。最终答案中不要包含任何单位。",
            "solution": "该问题要求在概率性工作负载下分析同步总线和异步总线的性能。分析必须基于基本原理。问题陈述具有科学依据、问题明确且客观，因此是有效的。我们进行形式化推导。\n\n给定参数如下：\n- 同步总线时钟频率, $f = 200 \\times 10^6$ Hz。\n- 异步总线上每次控制信号转换的传播延迟, $t_p = 1 \\times 10^{-9}$ s。\n- 快速服务时间, $x_f = 7 \\times 10^{-9}$ s。\n- 慢速服务时间, $x_s = 19 \\times 10^{-9}$ s。\n- 快速服务时间的概率, $p = 0.7$。\n\n服务时间 $x$ 是一个随机变量，其概率质量函数为 $P(x=x_f) = p$ 和 $P(x=x_s) = 1-p$。\n\n**1. 同步总线分析**\n\n首先，我们确定同步总线的时钟周期 $T_{clk}$。\n$$T_{clk} = \\frac{1}{f} = \\frac{1}{200 \\times 10^6 \\text{ Hz}} = 5 \\times 10^{-9} \\text{ s} = 5 \\text{ ns}$$\n\n同步总线上的一次传输包含一个地址阶段和一个数据阶段。对此类协议的一个标准和最小化模型假设地址阶段占用一个时钟周期。时长为 $x$ 的设备服务在地址发出后开始。数据只能在时钟上升沿被采样。因此，会插入等待状态，直到服务完成后的第一个或之后的时钟沿到来。\n\n假设一次传输在时间 $t=0$ 开始。地址阶段消耗一个时钟周期，因此在时间 $t=T_{clk}$ 结束。时长为 $x$ 的服务在此时开始，数据在时间 $T_{clk} + x$ 变为可用。传输的总持续时间必须是整数个时钟周期，记为 $C_{sync}(x)$，使得总时间 $C_{sync}(x) \\cdot T_{clk}$ 至少为 $T_{clk} + x$。\n$$C_{sync}(x) \\cdot T_{clk} \\ge T_{clk} + x$$\n周期数是满足此条件的最小整数，可通过上取整函数求得：\n$$C_{sync}(x) = \\left\\lceil \\frac{T_{clk} + x}{T_{clk}} \\right\\rceil = 1 + \\left\\lceil \\frac{x}{T_{clk}} \\right\\rceil$$\n\n我们将此模型应用于两种服务时间情况：\n对于快速情况（$x_f = 7 \\text{ ns}$）：\n$$C_{sync}(x_f) = 1 + \\left\\lceil \\frac{7 \\text{ ns}}{5 \\text{ ns}} \\right\\rceil = 1 + \\lceil 1.4 \\rceil = 1 + 2 = 3 \\text{ 个周期}$$\n对于慢速情况（$x_s = 19 \\text{ ns}$）：\n$$C_{sync}(x_s) = 1 + \\left\\lceil \\frac{19 \\text{ ns}}{5 \\text{ ns}} \\right\\rceil = 1 + \\lceil 3.8 \\rceil = 1 + 4 = 5 \\text{ 个周期}$$\n\n每次传输的期望时钟周期数 $E[C_{sync}]$ 是快速和慢速情况下周期数的加权平均值。\n$$E[C_{sync}] = p \\cdot C_{sync}(x_f) + (1-p) \\cdot C_{sync}(x_s)$$\n$$E[C_{sync}] = (0.7)(3) + (1-0.7)(5) = (0.7)(3) + (0.3)(5) = 2.1 + 1.5 = 3.6$$\n这是问题第一部分的答案。\n\n**2. 异步总线分析**\n\n异步总线使用四相握手协议。对于给定的服务时间 $x$，此握手的持续时间 $T_{async}(x)$ 可以通过对每个阶段的延迟求和来确定：\n1. 主设备置位请求信号。它需要时间 $t_p$ 传播到从设备。\n2. 从设备接收到请求，执行服务（持续时间 $x$），然后置位应答信号。\n3. 应答信号传播回主设备，这又需要时间 $t_p$。\n4. 主设备接收到应答并撤销请求。该信号在 $t_p$ 内传播到从设备。\n5. 从设备接收到撤销的请求并撤销应答。该信号在 $t_p$ 内传回主设备。\n握手的总持续时间是服务时间与四次传播延迟之和。\n$$T_{async}(x) = x + 4t_p$$\n\n我们将此模型应用于两种服务时间情况，其中 $t_p = 1 \\text{ ns}$：\n对于快速情况（$x_f = 7 \\text{ ns}$）：\n$$T_{async}(x_f) = 7 \\text{ ns} + 4(1 \\text{ ns}) = 11 \\text{ ns}$$\n对于慢速情况（$x_s = 19 \\text{ ns}$）：\n$$T_{async}(x_s) = 19 \\text{ ns} + 4(1 \\text{ ns}) = 23 \\text{ ns}$$\n\n期望握手持续时间 $E[T_{async}]$ 是加权平均值。\n$$E[T_{async}] = p \\cdot T_{async}(x_f) + (1-p) \\cdot T_{async}(x_s)$$\n$$E[T_{async}] = (0.7)(11 \\text{ ns}) + (0.3)(23 \\text{ ns}) = 7.7 \\text{ ns} + 6.9 \\text{ ns} = 14.6 \\text{ ns}$$\n这是问题第二部分的答案。\n\n**3. 比率 R 的计算**\n\n问题要求计算异步总线的期望握手持续时间与同步总线的期望传输时间（以秒为单位）的比率 $R$。\n分子是 $E[T_{async}] = 14.6 \\text{ ns}$。\n\n分母是同步总线上的期望传输时间 $E[T_{sync}]$。对于服务时间 $x$，同步传输的时间是 $T_{sync}(x) = C_{sync}(x) \\cdot T_{clk}$。期望时间为：\n$$E[T_{sync}] = E[C_{sync}(x) \\cdot T_{clk}]$$\n由于 $T_{clk}$ 是一个常数，我们可以写成：\n$$E[T_{sync}] = E[C_{sync}] \\cdot T_{clk}$$\n使用第1部分的结果 $E[C_{sync}] = 3.6$ 和 $T_{clk} = 5 \\text{ ns}$：\n$$E[T_{sync}] = 3.6 \\cdot 5 \\text{ ns} = 18 \\text{ ns}$$\n\n现在我们可以计算比率 $R$：\n$$R = \\frac{E[T_{async}]}{E[T_{sync}]} = \\frac{14.6 \\text{ ns}}{18 \\text{ ns}} = \\frac{14.6}{18}$$\n\n为将其表示为简化的精确分数，我们将小数转换为分数：\n$$R = \\frac{146}{180}$$\n我们通过将分子和分母除以它们的最大公约数 $2$ 来简化分数：\n$$R = \\frac{146 \\div 2}{180 \\div 2} = \\frac{73}{90}$$\n由于 $73$ 是一个素数，且不能整除 $90$，因此该分数已完全简化。",
            "answer": "$$\\boxed{\\frac{73}{90}}$$"
        },
        {
            "introduction": "异步系统的灵活性也带来了独特的可靠性设计挑战，因为它们缺乏全局时钟来保证时序。本练习将引导你解决一个在异步通信中至关重要的问题：如何处理握手信号丢失的故障情况。你将设计一个超时恢复机制，并结合几何退避策略，以确保即使在发生瞬态错误时，系统也能在规定的延迟期限内完成传输。这个练习模拟了网络协议和健壮硬件接口中常见的错误处理技术，是构建可靠异步系统的关键实践。",
            "id": "3683463",
            "problem": "一部异步总线使用两阶段请求-应答握手协议，其中请求方发出一个请求（REQ）并等待一个应答（ACK）。在嘈杂的环境中，由于瞬态干扰，应答（ACK）可能会丢失。该接口实现了超时恢复：如果在 $T_{\\text{to}}$ 的超时时间内没有观察到应答（ACK），请求方会中止该次尝试，撤销请求以将线路复位 $T_{\\text{rst}}$ 时间，等待一个退避间隔 $B_k$，然后重试。假设第 $k$ 次重试的延迟采用几何退避形式 $B_k = B_1 r^{k-1}$，其中 $B_1$ 是初始退避时间， $r$ 是一个无量纲比率。为确保服务质量，系统必须保证任何事务的端到端延迟以一个截止时间 $L_{\\max}$ 为界，即使在最坏情况下，即前 $N-1$ 次尝试超时而第 $N$ 次尝试成功。当一次尝试成功时，应答（ACK）总是在请求发出后不迟于 $T_{\\text{ack,max}}$ 到达。\n\n仅从异步握手时序和几何退避的定义出发，推导在 $N$ 次尝试下的最坏情况延迟表达式，并确定在以下设计参数下，为满足截止时间 $L_{\\max}$ 所允许的最大几何比率 $r$：\n- 每次尝试的超时时间：$T_{\\text{to}} = 120\\,\\text{ns}$。\n- 尝试之间的线路复位时间：$T_{\\text{rst}} = 20\\,\\text{ns}$。\n- 成功尝试时的最大应答延迟：$T_{\\text{ack,max}} = 80\\,\\text{ns}$。\n- 初始退避时间：$B_1 = 50\\,\\text{ns}$。\n- 最大尝试次数（包括成功的一次）：$N = 3$。\n- 端到端延迟截止时间：$L_{\\max} = 1.0\\,\\mu\\text{s}$。\n\n假设退避仅在失败的尝试之后应用，而不在最终成功的尝试之后应用，并且失败尝试的超时会消耗全部的 $T_{\\text{to}}$ 时间。将所允许的最大 $r$ 值作为一个无量纲数报告，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导在采用超时和几何退避恢复机制的异步总线上，一个事务的最坏情况延迟，然后确定在满足给定的端到端延迟截止时间 $L_{\\max}$ 的前提下，所允许的最大几何比率 $r$。\n\n首先，我们必须将最坏情况延迟 $L_{\\text{wc}}$ 形式化。问题指定最坏情况为前 $N-1$ 次尝试超时，随后是第 $N$ 次尝试成功。总延迟是这 $N$ 次尝试中每次所花费时间的总和。\n\n单次失败尝试（比如第 $k$ 次尝试，其中 $1 \\le k \\le N-1$）的持续时间由三个部分组成：\n1. 请求方等待完整的超时持续时间 $T_{\\text{to}}$。\n2. 请求方复位总线线路，这需要持续时间 $T_{\\text{rst}}$。\n3. 在发起下一次尝试之前，请求方等待一个退避间隔 $B_k$。\n因此，第 $k$ 次失败尝试的延迟为 $T_{\\text{fail}, k} = T_{\\text{to}} + T_{\\text{rst}} + B_k$。\n\n最后一次，即第 $N$ 次成功的尝试的持续时间，由发出请求后接收到应答信号所需的最长时间决定。这由 $T_{\\text{ack,max}}$ 给出。问题说明退避仅在失败的尝试之后应用，因此这次成功的事务之后没有退避间隔。成功尝试的延迟为 $T_{\\text{success}} = T_{\\text{ack,max}}$。\n\n总的最坏情况延迟 $L_{\\text{wc}}$ 是 $N-1$ 次失败尝试和一次成功尝试的延迟之和：\n$$L_{\\text{wc}} = \\left( \\sum_{k=1}^{N-1} T_{\\text{fail}, k} \\right) + T_{\\text{success}}$$\n代入每个分量的表达式：\n$$L_{\\text{wc}} = \\left( \\sum_{k=1}^{N-1} (T_{\\text{to}} + T_{\\text{rst}} + B_k) \\right) + T_{\\text{ack,max}}$$\n我们可以将总和分成几个部分：\n$$L_{\\text{wc}} = \\sum_{k=1}^{N-1} (T_{\\text{to}} + T_{\\text{rst}}) + \\sum_{k=1}^{N-1} B_k + T_{\\text{ack,max}}$$\n第一项是一个常数值在 $N-1$ 个项上的总和：\n$$\\sum_{k=1}^{N-1} (T_{\\text{to}} + T_{\\text{rst}}) = (N-1)(T_{\\text{to}} + T_{\\text{rst}})$$\n第二项是退避间隔的总和。退避是几何的，由 $B_k = B_1 r^{k-1}$ 给出。因此，该总和是一个几何级数：\n$$\\sum_{k=1}^{N-1} B_k = \\sum_{k=1}^{N-1} B_1 r^{k-1} = B_1 \\sum_{k=1}^{N-1} r^{k-1}$$\n几何级数 $\\sum_{j=0}^{m} r^j$ 的和为 $\\frac{r^{m+1}-1}{r-1}$（当 $r \\ne 1$ 时）。当索引 $j=k-1$ 时，求和范围从 $j=0$ 到 $j=N-2$。因此：\n$$\\sum_{k=1}^{N-1} B_k = B_1 \\frac{r^{(N-2)+1}-1}{r-1} = B_1 \\frac{r^{N-1}-1}{r-1}$$\n结合所有部分，最坏情况延迟的一般表达式为：\n$$L_{\\text{wc}} = (N-1)(T_{\\text{to}} + T_{\\text{rst}}) + B_1 \\frac{r^{N-1}-1}{r-1} + T_{\\text{ack,max}}$$\n\n为确保服务质量，此最坏情况延迟不得超过截止时间 $L_{\\max}$：\n$$L_{\\text{wc}} \\le L_{\\max}$$\n$$(N-1)(T_{\\text{to}} + T_{\\text{rst}}) + B_1 \\frac{r^{N-1}-1}{r-1} + T_{\\text{ack,max}} \\le L_{\\max}$$\n\n现在，我们代入指定的设计参数：\n- $T_{\\text{to}} = 120\\,\\text{ns}$\n- $T_{\\text{rst}} = 20\\,\\text{ns}$\n- $T_{\\text{ack,max}} = 80\\,\\text{ns}$\n- $B_1 = 50\\,\\text{ns}$\n- $N = 3$\n- $L_{\\max} = 1.0\\,\\mu\\text{s} = 1000\\,\\text{ns}$\n\n对于 $N=3$，$N-1$ 项变为 $2$，几何级数求和也随之简化。\n退避时间的总和为 $\\sum_{k=1}^{2} B_k = B_1 + B_2 = B_1 r^{1-1} + B_1 r^{2-1} = B_1 + B_1 r = B_1(1+r)$。\n这与 $N=3$ 的通用公式一致：$B_1 \\frac{r^{3-1}-1}{r-1} = B_1 \\frac{r^2-1}{r-1} = B_1 \\frac{(r-1)(r+1)}{r-1} = B_1(r+1)$（当 $r \\ne 1$ 时）。\n\n对于 $N=3$，延迟不等式为：\n$$2(T_{\\text{to}} + T_{\\text{rst}}) + B_1(1+r) + T_{\\text{ack,max}} \\le L_{\\max}$$\n代入数值：\n$$2(120 + 20) + 50(1+r) + 80 \\le 1000$$\n所有数值单位均为纳秒。\n$$2(140) + 50(1+r) + 80 \\le 1000$$\n$$280 + 50 + 50r + 80 \\le 1000$$\n合并常数项：\n$$280 + 50 + 80 = 410$$\n因此不等式变为：\n$$410 + 50r \\le 1000$$\n现在，我们求解 $r$：\n$$50r \\le 1000 - 410$$\n$$50r \\le 590$$\n$$r \\le \\frac{590}{50}$$\n$$r \\le 11.8$$\n所允许的最大几何比率 $r$ 是 $11.8$。问题要求将此值四舍五入到四位有效数字。\n\n因此，最大值为 $r_{\\max} = 11.80$。",
            "answer": "$$\\boxed{11.80}$$"
        }
    ]
}