{
    "hands_on_practices": [
        {
            "introduction": "新兴存储技术的一个核心优势是其非易失性，与需要持续供电刷新来维持数据的DRAM形成鲜明对比。本练习通过一个具体场景——系统掉电后的数据保持——来量化DRAM的能耗成本。通过从基本物理原理出发计算维持DRAM数据所需的备用电池能量，你将能更深刻地理解和体会相变存储器（PCM）等非易失性存储器在静态功耗方面的巨大优势。",
            "id": "3638958",
            "problem": "一个服务器级系统必须具备抗崩溃能力，通过确保主内存的内容在突然断电后能够得以保存，直到可以进行有序恢复。目前正在讨论两种设计方案：电池备用的动态随机存取存储器 (DRAM) 和相变存储器 (PCM)。DRAM 需要持续的能量来（通过刷新）保存数据，而 PCM 是非易失性的，不需要能量来被动地保存数据。仅使用电荷、电压、功率和能量之间的基本关系，推导出一个表达式，用于计算在 DRAM 中为大小为 $S$ 字节的任意内存占用保存数据达 $t$ 时间所需的电池能量，然后针对指定的系统对其进行数值计算。\n\n假设和参数：\n- DRAM 子系统在电源电压 $V_{\\text{DRAM}}$ 下工作，每个比特需要以周期 $T_{\\text{ref}}$ 进行周期性刷新。将刷新过程建模为每个比特在每个刷新间隔内从电源汲取有效电荷 $q_{r}$。这个集总参数 $q_{r}$ 包含了在一个存储位刷新期间读出放大器和外围电路切换所产生的消耗。\n- 在数据保存间隔内，DRAM 内存控制器和其关联的数据保存管理逻辑消耗一个近似恒定的功率 $P_{\\text{ctl}}$，该功率与 $S$ 无关。\n- 电池通过一个效率为 $\\eta$（其中 $0  \\eta \\leq 1$）的稳压器向 DRAM 负载提供能量。所需的电池能量等于负载能量除以 $\\eta$。\n- 对于所考虑的时间尺度，相变存储器 (PCM) 被假定为完全非易失性的，因此它保存数据所需的能量为零；你可以在推导中定性地使用这一事实，但你必须只计算 DRAM 情况下的电池能量。\n- 使用 1 吉字节 (GB) 等于 $10^{9}$ 字节的定义。\n\n任务：\n1. 从第一性原理出发，用 $S$、$q_{r}$ 和 $T_{\\text{ref}}$ 表示 DRAM 刷新电流。由此推导出 DRAM 刷新功率，然后推导出包含 $P_{\\text{ctl}}$ 的 DRAM 总负载功率。最后，推导在时间 $t$ 内所需电池能量 $E_{\\text{battery}}(S,t)$ 的闭式表达式，用 $S$、$V_{\\text{DRAM}}$、$q_{r}$、$T_{\\text{ref}}$、$P_{\\text{ctl}}$ 和 $\\eta$ 表示。\n2. 对你的表达式进行数值计算，参数如下：\n   - $S = 16 \\times 10^{9}$ 字节，\n   - $t = 2 \\text{ hours}$，\n   - $V_{\\text{DRAM}} = 1.2 \\text{ V}$，\n   - $q_{r} = 4.0 \\times 10^{-13} \\text{ C/bit/refresh}$，\n   - $T_{\\text{ref}} = 64 \\times 10^{-3} \\text{ s}$，\n   - $P_{\\text{ctl}} = 0.20 \\text{ W}$，\n   - $\\eta = 0.90$。\n以 $\\text{kJ}$ 为单位表示最终能量，并将你的答案四舍五入到四位有效数字。\n\n你的最终答案必须是对应于所述参数下 DRAM 情况所需电池能量的单个实数值，以 $\\text{kJ}$ 为单位表示。最终方框内的答案不要包含任何单位。",
            "solution": "解题过程按要求分为两部分：首先，推导电池能量的符号表达式；其次，进行数值计算。\n\n第 1 部分：电池能量表达式 $E_{\\text{battery}}(S, t)$ 的推导。\n\n大小为 $S$ 字节的内存中的总比特数 $N_{\\text{bits}}$ 由下式给出：\n$$N_{\\text{bits}} = 8 S$$\n这源于 1 字节等于 8 比特的标准定义。\n\n问题指明，在每个刷新周期 $T_{\\text{ref}}$ 内，每个比特会汲取有效电荷 $q_{r}$。因此，刷新整个存储阵列一次从电源汲取的总电荷为：\n$$Q_{\\text{total\\_ref}} = N_{\\text{bits}} \\times q_{r} = 8 S q_{r}$$\n\n电流是电荷流动的速率，即 $I = \\frac{dQ}{dt}$。对于一个周期性过程，平均电流是每个周期内传输的总电荷除以周期时长。因此，DRAM 刷新所需的平均电流 $I_{\\text{DRAM\\_ref}}$ 为：\n$$I_{\\text{DRAM\\_ref}} = \\frac{Q_{\\text{total\\_ref}}}{T_{\\text{ref}}} = \\frac{8 S q_{r}}{T_{\\text{ref}}}$$\n\n电功率是电压和电流的乘积，即 $P = V I$。DRAM 单元专门用于刷新操作所消耗的功率 $P_{\\text{DRAM\\_ref}}$ 是刷新电流与 DRAM 电源电压 $V_{\\text{DRAM}}$ 的乘积：\n$$P_{\\text{DRAM\\_ref}} = V_{\\text{DRAM}} I_{\\text{DRAM\\_ref}} = \\frac{8 S q_{r} V_{\\text{DRAM}}}{T_{\\text{ref}}}$$\n\n电池必须支持的负载所消耗的总功率 $P_{\\text{load}}$ 是 DRAM 刷新功率与内存控制器及其关联的数据保存逻辑所消耗的恒定功率 $P_{\\text{ctl}}$ 之和。\n$$P_{\\text{load}} = P_{\\text{DRAM\\_ref}} + P_{\\text{ctl}} = \\frac{8 S q_{r} V_{\\text{DRAM}}}{T_{\\text{ref}}} + P_{\\text{ctl}}$$\n\n能量是功率对时间的积分。由于在数据保存间隔 $t$ 内总负载功率 $P_{\\text{load}}$ 是恒定的，因此负载消耗的总能量 $E_{\\text{load}}$ 是该功率与时间长度的乘积：\n$$E_{\\text{load}} = P_{\\text{load}} \\times t = \\left( \\frac{8 S q_{r} V_{\\text{DRAM}}}{T_{\\text{ref}}} + P_{\\text{ctl}} \\right) t$$\n\n该负载由电池通过一个效率为 $\\eta$ 的稳压器供电。效率是输出功率（或能量）与输入功率（或能量）的比值，即 $\\eta = \\frac{E_{\\text{load}}}{E_{\\text{battery}}}$。因此，电池必须提供的能量 $E_{\\text{battery}}$ 是负载能量除以效率：\n$$E_{\\text{battery}} = \\frac{E_{\\text{load}}}{\\eta}$$\n代入 $E_{\\text{load}}$ 的表达式，得到所需电池能量作为内存大小 $S$ 和保存时间 $t$ 函数的最终闭式表达式：\n$$E_{\\text{battery}}(S, t) = \\frac{t}{\\eta} \\left( \\frac{8 S q_{r} V_{\\text{DRAM}}}{T_{\\text{ref}}} + P_{\\text{ctl}} \\right)$$\n\n第 2 部分：数值计算。\n\n我们现在将所提供的数值代入推导出的表达式。我们必须确保所有单位都一致（使用国际单位制）。\n给定参数如下：\n$S = 16 \\times 10^{9}$ 字节\n$t = 2 \\text{ 小时} = 2 \\times 3600 \\text{ 秒} = 7200 \\text{ 秒}$\n$V_{\\text{DRAM}} = 1.2 \\text{ V}$\n$q_{r} = 4.0 \\times 10^{-13} \\text{ C}$ 每比特每次刷新\n$T_{\\text{ref}} = 64 \\times 10^{-3} \\text{ s}$\n$P_{\\text{ctl}} = 0.20 \\text{ W}$\n$\\eta = 0.90$\n\n首先，我们计算 DRAM 刷新功率 $P_{\\text{DRAM\\_ref}}$：\n$$P_{\\text{DRAM\\_ref}} = \\frac{8 \\times (16 \\times 10^{9} \\text{ bytes}) \\times (4.0 \\times 10^{-13} \\text{ C/bit}) \\times (1.2 \\text{ V})}{64 \\times 10^{-3} \\text{ s}}$$\n因子 8 正确地将字节转换为比特。\n$$P_{\\text{DRAM\\_ref}} = \\frac{(128 \\times 10^{9}) \\times (4.0 \\times 10^{-13}) \\times 1.2}{64 \\times 10^{-3}} \\text{ W}$$\n$$P_{\\text{DRAM\\_ref}} = \\frac{51.2 \\times 10^{-2} \\times 1.2}{64 \\times 10^{-3}} \\text{ W} = \\frac{61.44 \\times 10^{-2}}{64 \\times 10^{-3}} \\text{ W}$$\n$$P_{\\text{DRAM\\_ref}} = 0.96 \\text{ W}$$\n\n接下来，我们计算总负载功率 $P_{\\text{load}}$：\n$$P_{\\text{load}} = P_{\\text{DRAM\\_ref}} + P_{\\text{ctl}} = 0.96 \\text{ W} + 0.20 \\text{ W} = 1.16 \\text{ W}$$\n\n现在，我们可以计算所需的总电池能量 $E_{\\text{battery}}$，单位为焦耳：\n$$E_{\\text{battery}} = \\frac{P_{\\text{load}} \\times t}{\\eta} = \\frac{1.16 \\text{ W} \\times 7200 \\text{ s}}{0.90} \\text{ J}$$\n$$E_{\\text{battery}} = \\frac{8352}{0.90} \\text{ J} = 9280 \\text{ J}$$\n\n问题要求最终答案以千焦 (kJ) 为单位。\n$$E_{\\text{battery}} = 9280 \\text{ J} \\times \\frac{1 \\text{ kJ}}{1000 \\text{ J}} = 9.280 \\text{ kJ}$$\n该值已按要求用四位有效数字表示。",
            "answer": "$$\\boxed{9.280}$$"
        },
        {
            "introduction": "虽然PCM在数据保持方面具有能效优势，但它也带来了新的挑战，其中最显著的就是其写操作相对于读操作的高昂代价。本练习将探讨这一特性如何影响算法设计，通过比较两种排序算法在PCM上的能耗，你将看到减少写操作次数成为优化关键。这个例子清晰地展示了为新兴存储器设计高效软件时，必须将硬件的非对称特性纳入考量。",
            "id": "3639004",
            "problem": "一位系统设计师正在评估两种在相变存储器 (PCM) 上运行的内存排序算法。相变存储器 (PCM) 的特点是，与读操作相比，其写操作的能耗要高得多。设 $n$ 表示要排序的 $64$ 位元素的数量。对于算法 $\\mathrm{A}$，排序期间不同字的写入总次数建模为 $W_{\\mathrm{A}}(n) = \\frac{n}{2}\\ln(n)$；对于算法 $\\mathrm{B}$，则为 $W_{\\mathrm{B}}(n) = 2n$。假设在 PCM 中，写入一个 $64$ 位字的能量为 $E_{\\mathrm{write}} = 3.0 \\times 10^{-9}$，读取一个 $64$ 位字的能量为 $E_{\\mathrm{read}} = 1.5 \\times 10^{-10}$，且 $E_{\\mathrm{write}} \\gg E_{\\mathrm{read}}$。两种算法的读取次数与其写入次数在同一数量级（在一个常数因子内），但由于给定的不等式，您可以在一阶能量比较中忽略读取能耗。\n\n从计算的总能量是其基本操作能量的总和这一原理出发，在所述近似条件下，推导算法 $\\mathrm{A}$ 和 $\\mathrm{B}$ 之间能量比 $\\rho(n) = \\frac{E_{\\mathrm{A}}(n)}{E_{\\mathrm{B}}(n)}$ 的闭式解析表达式。将您的最终答案表示为关于 $n$ 的简化表达式。无需四舍五入，答案应为无量纲单位。",
            "solution": "一个算法所消耗的总能量是其所有基本操作能量的总和。在此背景下，这些操作是内存读取和写入。一个算法的总能量 $E(n)$ 可以表示为：\n$$E(n) = N_{\\mathrm{reads}}(n) \\cdot E_{\\mathrm{read}} + N_{\\mathrm{writes}}(n) \\cdot E_{\\mathrm{write}}$$\n其中 $N_{\\mathrm{reads}}(n)$ 和 $N_{\\mathrm{writes}}(n)$ 分别是问题规模为 $n$ 时的总读取和写入操作次数。\n\n对于算法 A，能量 $E_{\\mathrm{A}}(n)$ 为：\n$$E_{\\mathrm{A}}(n) = R_{\\mathrm{A}}(n) \\cdot E_{\\mathrm{read}} + W_{\\mathrm{A}}(n) \\cdot E_{\\mathrm{write}}$$\n对于算法 B，能量 $E_{\\mathrm{B}}(n)$ 为：\n$$E_{\\mathrm{B}}(n) = R_{\\mathrm{B}}(n) \\cdot E_{\\mathrm{read}} + W_{\\mathrm{B}}(n) \\cdot E_{\\mathrm{write}}$$\n这里，$R_{\\mathrm{A}}(n)$ 和 $R_{\\mathrm{B}}(n)$ 代表每种算法的读取次数。\n\n问题陈述指出，我们可以在一阶比较中忽略读取能耗。这是由条件 $E_{\\mathrm{write}} \\gg E_{\\mathrm{read}}$ 所证明的。这个近似将能量方程简化为：\n$$E_{\\mathrm{A}}(n) \\approx W_{\\mathrm{A}}(n) \\cdot E_{\\mathrm{write}}$$\n$$E_{\\mathrm{B}}(n) \\approx W_{\\mathrm{B}}(n) \\cdot E_{\\mathrm{write}}$$\n\n我们已知每种算法的写入次数模型：\n$$W_{\\mathrm{A}}(n) = \\frac{n}{2}\\ln(n)$$\n$$W_{\\mathrm{B}}(n) = 2n$$\n\n将这些表达式代入近似能量方程，我们得到：\n$$E_{\\mathrm{A}}(n) \\approx \\left(\\frac{n}{2}\\ln(n)\\right) E_{\\mathrm{write}}$$\n$$E_{\\mathrm{B}}(n) \\approx (2n) E_{\\mathrm{write}}$$\n\n问题要求能量比 $\\rho(n) = \\frac{E_{\\mathrm{A}}(n)}{E_{\\mathrm{B}}(n)}$。使用近似能量表达式，我们可以将该比率写为：\n$$\\rho(n) \\approx \\frac{\\left(\\frac{n}{2}\\ln(n)\\right) E_{\\mathrm{write}}}{(2n) E_{\\mathrm{write}}}$$\n\n我们可以简化这个表达式。项 $E_{\\mathrm{write}}$ 是分子和分母的公因子，因此可以消去。这是预料之中的，因为比率应取决于算法属性，而不是底层硬件的具体能量值（只要比率 $E_{\\mathrm{write}}/E_{\\mathrm{read}}$ 很大）。\n$$\\rho(n) = \\frac{\\frac{n}{2}\\ln(n)}{2n}$$\n\n变量 $n$ 也同时出现在分子和分母中，可以消去，前提是 $n \\neq 0$，这对于排序问题来说是一个安全的假设。\n$$\\rho(n) = \\frac{\\frac{1}{2}\\ln(n)}{2}$$\n\n最后，简化该分数即可得到能量比的闭式解析表达式：\n$$\\rho(n) = \\frac{1}{4}\\ln(n)$$\n该表达式表示在指定的模型和近似下，算法A与算法B的能耗比率，作为元素数量 $n$ 的函数。",
            "answer": "$$\\boxed{\\frac{1}{4}\\ln(n)}$$"
        }
    ]
}