{
    "hands_on_practices": [
        {
            "introduction": "Many real-world decisions are not about 'how much' but 'whether or not'—selecting projects, assigning tasks, or scheduling events. This practice introduces Integer Linear Programming (ILP), a powerful framework for modeling such discrete choices. By working through a student timetabling scenario , you will learn to translate complex logical rules, like time conflicts and capacity limits, into a system of linear constraints and binary variables, transforming a word problem into a solvable mathematical model.",
            "id": "3147876",
            "problem": "A registrar is scheduling students into tutorial sections over three consecutive time blocks in a single morning. There are $3$ students, indexed by $i \\in \\{1,2,3\\}$, and $4$ sections, indexed by $j \\in \\{1,2,3,4\\}$. The sections occur at these times: section $1$ from $09:00$ to $09:50$, section $2$ from $09:30$ to $10:20$, section $3$ from $10:20$ to $11:10$, and section $4$ from $11:00$ to $11:50$. Two sections that overlap in time cannot be attended by the same student simultaneously. Based on the times given, the pairs of overlapping sections are $(1,2)$, $(2,3)$, and $(3,4)$.\n\nEach student $i$ can enroll in at most $2$ sections in total over the morning. Each section $j$ has a capacity $C_{j}$ indicating the maximum number of students allowed: $C_{1}=1$, $C_{2}=1$, $C_{3}=2$, and $C_{4}=1$.\n\nFor each student $i$ and section $j$, there is a nonnegative preference weight $w_{ij}$ that measures how much student $i$ values attending section $j$. The weights are:\n- Student $1$: $w_{11}=9$, $w_{12}=6$, $w_{13}=8$, $w_{14}=4$.\n- Student $2$: $w_{21}=3$, $w_{22}=9$, $w_{23}=5$, $w_{24}=7$.\n- Student $3$: $w_{31}=6$, $w_{32}=4$, $w_{33}=8$, $w_{34}=5$.\n\nLet $x_{ij}$ be a binary decision variable that equals $1$ if student $i$ is assigned to section $j$ and $0$ otherwise. Using fundamental definitions of linear optimization and integer decision variables, formulate the resulting Integer Linear Program (ILP) that maximizes the total preference value and imposes both conflict constraints (no student attends overlapping sections) and capacity constraints (sections do not exceed their capacities), as well as the per-student limit of at most $2$ sections.\n\nThen, for the specific numerical instance given above, determine the optimal total preference value, that is, the maximum value of $\\sum_{i=1}^{3} \\sum_{j=1}^{4} w_{ij} x_{ij}$ subject to all the stated constraints. Provide the final answer as a single integer with no units. No rounding is necessary.",
            "solution": "The problem asks for two parts: first, to formulate an Integer Linear Program (ILP) for a student scheduling problem, and second, to solve the specific instance provided to find the maximum total preference value.\n\nFirst, we formulate the ILP. Let $x_{ij}$ be the binary decision variable such that $x_{ij} = 1$ if student $i$ is assigned to section $j$, and $x_{ij} = 0$ otherwise. The indices are $i \\in \\{1, 2, 3\\}$ for the students and $j \\in \\{1, 2, 3, 4\\}$ for the sections. The preference weight of student $i$ for section $j$ is denoted by $w_{ij}$.\n\nThe objective is to maximize the sum of preference weights for all assignments made. This is expressed by the objective function $Z$:\n$$ \\text{Maximize } Z = \\sum_{i=1}^{3} \\sum_{j=1}^{4} w_{ij} x_{ij} $$\n\nThis maximization is subject to several constraints based on the problem description.\n\n1.  **Binary Decision Variables**: The variables $x_{ij}$ must be binary, as a student is either assigned to a section or not.\n    $$ x_{ij} \\in \\{0, 1\\} \\quad \\forall i \\in \\{1, 2, 3\\}, \\; \\forall j \\in \\{1, 2, 3, 4\\} $$\n\n2.  **Student Enrollment Limit**: Each student can enroll in at most $2$ sections. This translates to a constraint for each student $i$.\n    $$ \\sum_{j=1}^{4} x_{ij} \\le 2 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\n\n3.  **Section Capacity Constraints**: The number of students in any section $j$ cannot exceed the given capacity $C_j$. This gives a constraint for each section $j$.\n    $$ \\sum_{i=1}^{3} x_{ij} \\le C_j \\quad \\text{for each } j \\in \\{1, 2, 3, 4\\} $$\n    Using the specific capacities $C_{1}=1$, $C_{2}=1$, $C_{3}=2$, and $C_{4}=1$, these constraints are:\n    $$ \\sum_{i=1}^{3} x_{i1} \\le 1 $$\n    $$ \\sum_{i=1}^{3} x_{i2} \\le 1 $$\n    $$ \\sum_{i=1}^{3} x_{i3} \\le 2 $$\n    $$ \\sum_{i=1}^{3} x_{i4} \\le 1 $$\n\n4.  **Conflict Constraints**: A student cannot attend two sections that have overlapping times. The problem states the overlapping pairs are $(1,2)$, $(2,3)$, and $(3,4)$. For any student $i$, they can be assigned to at most one section from each pair. This is modeled as:\n    $$ x_{i1} + x_{i2} \\le 1 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\n    $$ x_{i2} + x_{i3} \\le 1 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\n    $$ x_{i3} + x_{i4} \\le 1 \\quad \\text{for each } i \\in \\{1, 2, 3\\} $$\nThis completes the formulation of the ILP.\n\nNext, we solve the specific instance to find the optimal total preference value. The total number of available slots in all sections is the sum of their capacities: $C_1+C_2+C_3+C_4 = 1+1+2+1 = 5$. The total number of enrollments is also limited by the number of students and their individual limits, which is at most $3 \\times 2 = 6$. The more restrictive limit is the total capacity, so a maximum of $5$ assignments ($x_{ij}=1$) can be made.\n\nAn upper bound on the objective function's value can be established by summing the $5$ highest preference weights. The given weights $w_{ij}$ are:\n- Student $1$: $w_{11}=9$, $w_{12}=6$, $w_{13}=8$, $w_{14}=4$.\n- Student $2$: $w_{21}=3$, $w_{22}=9$, $w_{23}=5$, $w_{24}=7$.\n- Student $3$: $w_{31}=6$, $w_{32}=4$, $w_{33}=8$, $w_{34}=5$.\n\nListing all weights in descending order: $9, 9, 8, 8, 7, 6, 6, 5, 5, 4, 4, 3$.\nThe top $5$ weights are $w_{11}=9$, $w_{22}=9$, $w_{13}=8$, $w_{33}=8$, and $w_{24}=7$. Their sum gives an upper bound on the total preference value:\n$$ Z_{\\text{upper bound}} = 9 + 9 + 8 + 8 + 7 = 41 $$\nIf a feasible assignment exists that corresponds to these five weights, it must be an optimal solution. Let's define this potential solution:\n- $x_{11}=1$ (Student $1$ in Section $1$)\n- $x_{22}=1$ (Student $2$ in Section $2$)\n- $x_{13}=1$ (Student $1$ in Section $3$)\n- $x_{33}=1$ (Student $3$ in Section $3$)\n- $x_{24}=1$ (Student $2$ in Section $4$)\nAll other $x_{ij}$ variables are $0$.\n\nWe must verify this set of assignments against all constraints:\n1.  **Student Enrollment Limits**:\n    - Student $1$: assigned to sections $1$ and $3$, for a total of $2$ sections. This satisfies the $\\le 2$ limit.\n    - Student $2$: assigned to sections $2$ and $4$, for a total of $2$ sections. This satisfies the $\\le 2$ limit.\n    - Student $3$: assigned to section $3$, for a total of $1$ section. This satisfies the $\\le 2$ limit.\n\n2.  **Section Capacity Constraints**:\n    - Section $1$ ($C_1=1$): one student ($1$) is assigned. This satisfies the capacity.\n    - Section $2$ ($C_2=1$): one student ($2$) is assigned. This satisfies the capacity.\n    - Section $3$ ($C_3=2$): two students ($1$ and $3$) are assigned. This satisfies the capacity.\n    - Section $4$ ($C_4=1$): one student ($2$) is assigned. This satisfies the capacity.\n\n3.  **Conflict Constraints**:\n    - Student $1$ (Sections $1, 3$): Sections $1$ and $3$ do not overlap. The formal constraints are checked: $x_{11}+x_{12} = 1+0 = 1 \\le 1$; $x_{12}+x_{13} = 0+1 = 1 \\le 1$; $x_{13}+x_{14} = 1+0 = 1 \\le 1$. All are satisfied.\n    - Student $2$ (Sections $2, 4$): Sections $2$ and $4$ do not overlap. The formal constraints are checked: $x_{21}+x_{22} = 0+1 = 1 \\le 1$; $x_{22}+x_{23} = 1+0 = 1 \\le 1$; $x_{23}+x_{24} = 0+1 = 1 \\le 1$. All are satisfied.\n    - Student $3$ (Section $3$): Only one section is assigned, so no conflict is possible. All conflict constraints for student $3$ are trivially satisfied.\n\nThe proposed assignment is feasible as it satisfies all problem constraints. The value of the objective function for this assignment is the sum of the top $5$ weights, which is $41$. Since we found a feasible solution that achieves the calculated upper bound, this solution is optimal.\n\nThus, the optimal total preference value is $41$.",
            "answer": "$$\n\\boxed{41}\n$$"
        },
        {
            "introduction": "We now shift from discrete decisions to continuous ones, a domain where convex optimization provides powerful guarantees of finding the single best solution. This exercise explores how to optimally combine information from multiple sources—a fundamental task in fields from engineering to finance. In this sensor fusion problem , you will model the task of finding the ideal weights for different sensor readings to minimize the overall error, and use the celebrated Karush-Kuhn-Tucker (KKT) conditions to derive an elegant and insightful analytical solution.",
            "id": "3147996",
            "problem": "A data fusion engineer is combining readings from $n$ independent sensors that measure a common scalar quantity $\\theta$. Sensor $i$ produces an unbiased reading $y_i$ with $\\mathbb{E}[y_i]=\\theta$ and variance $\\operatorname{Var}(y_i)=\\sigma_i^2$, where $\\sigma_i^2 > 0$ is known. The fused estimator is a convex combination $\\hat{\\theta}=\\sum_{i=1}^{n} w_i y_i$ with weights $w_i$ satisfying unbiasedness $\\sum_{i=1}^{n} w_i = 1$ and nonnegativity $w_i \\ge 0$ for all $i$. The engineer seeks to minimize the estimator variance $\\operatorname{Var}(\\hat{\\theta})$ subject to these constraints.\n\nFormulate the problem of choosing the weights $w_i$ as a convex optimization problem by explicitly modeling the objective and constraints using the facts that the sensors are independent, that the variance of a sum of independent random variables equals the sum of their variances, and that unbiasedness of $\\hat{\\theta}$ requires $\\sum_{i=1}^{n} w_i = 1$. Then, starting from the Karush–Kuhn–Tucker (KKT) optimality conditions for convex optimization (stationarity, primal feasibility, dual feasibility, and complementary slackness), derive the optimizer $w_i$ in terms of $\\sigma_i^2$ and compute the minimized value of $\\operatorname{Var}(\\hat{\\theta})$ in closed form.\n\nProvide as your final answer only the minimized variance of the fused estimator expressed as a single simplified analytic expression in terms of $\\{\\sigma_i^2\\}_{i=1}^{n}$.",
            "solution": "First, we formulate the optimization problem. The goal is to minimize the variance of the fused estimator, $\\operatorname{Var}(\\hat{\\theta})$. The estimator is given by $\\hat{\\theta} = \\sum_{i=1}^{n} w_i y_i$. Using the properties of variance, we have:\n$$\n\\operatorname{Var}(\\hat{\\theta}) = \\operatorname{Var}\\left(\\sum_{i=1}^{n} w_i y_i\\right)\n$$\nSince the sensor readings $y_i$ are independent, the variance of the sum is the sum of the variances:\n$$\n\\operatorname{Var}(\\hat{\\theta}) = \\sum_{i=1}^{n} \\operatorname{Var}(w_i y_i)\n$$\nUsing the variance property $\\operatorname{Var}(aX) = a^{2}\\operatorname{Var}(X)$ for a constant $a$ and random variable $X$, we get:\n$$\n\\operatorname{Var}(\\hat{\\theta}) = \\sum_{i=1}^{n} w_i^{2} \\operatorname{Var}(y_i) = \\sum_{i=1}^{n} w_i^{2} \\sigma_i^{2}\n$$\nThis expression is the objective function to be minimized. The minimization is subject to two constraints on the weights $w_i$: the unbiasedness constraint $\\sum_{i=1}^{n} w_i = 1$ and the non-negativity constraint $w_i \\ge 0$ for all $i \\in \\{1, 2, \\dots, n\\}$.\n\nThe complete optimization problem is therefore:\n$$\n\\begin{array}{ll}\n\\underset{w_1, \\dots, w_n}{\\operatorname{minimize}} & f(w) = \\sum_{i=1}^{n} w_i^{2} \\sigma_i^{2} \\\\\n\\text{subject to} & \\sum_{i=1}^{n} w_i - 1 = 0 \\\\\n& -w_i \\le 0, \\quad \\text{for } i=1, \\dots, n\n\\end{array}\n$$\nThis is a convex optimization problem because the objective function is a convex quadratic function (as all $\\sigma_i^{2} > 0$), and the constraints define a convex set (a simplex).\n\nTo find the optimal weights, we use the Karush–Kuhn–Tucker (KKT) conditions. We form the Lagrangian function $L(w, \\lambda, \\mu)$, where $\\lambda$ is the Lagrange multiplier for the equality constraint and $\\mu_i$ are the multipliers for the non-negativity constraints:\n$$\nL(w, \\lambda, \\mu_1, \\dots, \\mu_n) = \\sum_{i=1}^{n} w_i^{2} \\sigma_i^{2} + \\lambda \\left(\\sum_{i=1}^{n} w_i - 1\\right) - \\sum_{i=1}^{n} \\mu_i w_i\n$$\nThe KKT optimality conditions are:\n1.  **Stationarity**: The gradient of the Lagrangian with respect to each $w_i$ must be zero.\n    $$ \\frac{\\partial L}{\\partial w_i} = 2 w_i \\sigma_i^{2} + \\lambda - \\mu_i = 0 \\quad \\text{for } i=1, \\dots, n $$\n2.  **Primal feasibility**: The original constraints must be satisfied.\n    $$ \\sum_{i=1}^{n} w_i = 1 \\quad \\text{and} \\quad w_i \\ge 0 \\quad \\text{for } i=1, \\dots, n $$\n3.  **Dual feasibility**: The Lagrange multipliers for the inequality constraints must be non-negative.\n    $$ \\mu_i \\ge 0 \\quad \\text{for } i=1, \\dots, n $$\n4.  **Complementary slackness**: The product of each inequality multiplier and its corresponding constraint function must be zero.\n    $$ \\mu_i w_i = 0 \\quad \\text{for } i=1, \\dots, n $$\n\nFrom the stationarity condition, we can express $w_i$ as:\n$$\nw_i = \\frac{\\mu_i - \\lambda}{2 \\sigma_i^{2}}\n$$\nThe complementary slackness condition $\\mu_i w_i = 0$ implies that for any given $i$, either $w_i=0$ or $\\mu_i=0$. Since $\\sigma_i^{2} > 0$ for all $i$, it is reasonable to expect that all sensors contribute to the estimate, implying $w_i > 0$ for all $i$. If $w_i > 0$, then complementary slackness requires $\\mu_i = 0$. This also satisfies dual feasibility ($\\mu_i \\ge 0$).\n\nSetting $\\mu_i = 0$ for all $i$ in the stationarity equation gives:\n$$\n2 w_i \\sigma_i^{2} + \\lambda = 0 \\implies w_i = -\\frac{\\lambda}{2 \\sigma_i^{2}}\n$$\nFor $w_i$ to be positive, $\\lambda$ must be negative. We determine $\\lambda$ by substituting this expression for $w_i$ into the primal feasibility constraint $\\sum_{i=1}^{n} w_i = 1$:\n$$\n\\sum_{i=1}^{n} \\left(-\\frac{\\lambda}{2 \\sigma_i^{2}}\\right) = 1\n$$\n$$\n-\\frac{\\lambda}{2} \\sum_{i=1}^{n} \\frac{1}{\\sigma_i^{2}} = 1\n$$\nSolving for $\\lambda$:\n$$\n\\lambda = \\frac{-2}{\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}} = -2 \\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}\\right)^{-1}\n$$\nAs $\\sigma_j^{2} > 0$, the sum is positive, so $\\lambda  0$. This is consistent with the condition for $w_i > 0$. Now we substitute the expression for $\\lambda$ back into the equation for $w_i$:\n$$\nw_i = -\\frac{1}{2 \\sigma_i^{2}} \\left(-2 \\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}\\right)^{-1}\\right) = \\frac{1}{\\sigma_i^{2}} \\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}\\right)^{-1} = \\frac{\\frac{1}{\\sigma_i^{2}}}{\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}}\n$$\nThis solution for $w_i$ is positive for all $i$, so our assumption that $\\mu_i=0$ is consistent. All KKT conditions are satisfied, and thus we have found the unique optimal weights. The optimal weight for sensor $i$ is proportional to the inverse of its variance (its precision).\n\nFinally, we compute the minimized variance $\\operatorname{Var}(\\hat{\\theta})$ by substituting the optimal weights $w_i$ into the objective function:\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\sum_{i=1}^{n} w_i^{2} \\sigma_i^{2} = \\sum_{i=1}^{n} \\left(\\frac{\\frac{1}{\\sigma_i^{2}}}{\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}}\\right)^{2} \\sigma_i^{2}\n$$\nThe denominator is constant with respect to the summation index $i$, so we can factor it out:\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\frac{1}{\\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}\\right)^{2}} \\sum_{i=1}^{n} \\frac{1}{(\\sigma_i^{2})^{2}} \\sigma_i^{2}\n$$\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\frac{1}{\\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}\\right)^{2}} \\sum_{i=1}^{n} \\frac{1}{\\sigma_i^{2}}\n$$\nThe sum in the numerator is identical to one of the factors in the squared denominator, leading to a cancellation:\n$$\n\\operatorname{Var}(\\hat{\\theta})_{\\text{min}} = \\frac{\\sum_{i=1}^{n} \\frac{1}{\\sigma_i^{2}}}{\\left(\\sum_{j=1}^{n} \\frac{1}{\\sigma_j^{2}}\\right)^{2}} = \\frac{1}{\\sum_{i=1}^{n} \\frac{1}{\\sigma_i^{2}}}\n$$\nThis is the minimum achievable variance for the fused estimator. It is the reciprocal of the sum of the individual sensor precisions.",
            "answer": "$$\n\\boxed{\\left(\\sum_{i=1}^{n} \\frac{1}{\\sigma_i^{2}}\\right)^{-1}}\n$$"
        },
        {
            "introduction": "Standard optimization models often assume that all input data is known with perfect certainty, a condition rarely met in practice. This practice introduces robust optimization, a methodology for creating solutions that are resilient to data uncertainty. Using the classic knapsack problem as a foundation , we will explore how to build a model that guarantees feasibility even when package weights vary within a predicted range, moving from a simple, conservative 'worst-case' formulation to a more practical and nuanced 'budgeted uncertainty' approach.",
            "id": "3147927",
            "problem": "A small delivery drone must select a subset of packages to maximize delivered value while respecting a payload capacity under weight uncertainty. There are $5$ packages indexed by $i \\in \\{1,2,3,4,5\\}$. Selecting package $i$ yields value $v_i$ and consumes weight $w_i$, where the true weight is uncertain within the interval $w_i \\in [\\underline{w}_i,\\overline{w}_i]$. The drone’s capacity is $W$. Decision variables are $x_i \\in \\{0,1\\}$ indicating whether package $i$ is selected.\n\nData:\n- Package $1$: $v_1=12$, $\\underline{w}_1=3$, $\\overline{w}_1=5$.\n- Package $2$: $v_2=10$, $\\underline{w}_2=4$, $\\overline{w}_2=4.5$.\n- Package $3$: $v_3=14$, $\\underline{w}_3=2$, $\\overline{w}_3=6$.\n- Package $4$: $v_4=16$, $\\underline{w}_4=5$, $\\overline{w}_4=7$.\n- Package $5$: $v_5=7$, $\\underline{w}_5=1$, $\\overline{w}_5=3$.\n\nCapacity: $W=15$.\n\nTasks:\n1. Using fundamental definitions of robust feasibility, write the conservative robust knapsack model that guarantees feasibility for all realizations $w_i \\in [\\underline{w}_i,\\overline{w}_i]$ by enforcing the capacity constraint at the most adverse end of each interval.\n2. To reduce conservatism, model a budgeted uncertainty set based on the following idea: let the deviation of each item be $d_i=\\overline{w}_i-\\underline{w}_i$, and let adversarial deviation variables $s_i \\in [0,1]$ represent the fraction of $d_i$ realized, with a total budget $\\sum_{i=1}^{5} s_i \\le \\Gamma$. For $\\Gamma=2$, and starting from the definition of robust feasibility “the capacity must hold for all $w_i=\\underline{w}_i+d_i s_i$ with $s_i \\in [0,1]$ and $\\sum_i s_i \\le \\Gamma$,” derive the robust capacity constraint in terms of $\\{x_i\\}$ and $\\{d_i\\}$ without appealing to any pre-stated shortcut formulas.\n3. Using your robust capacity constraint for $\\Gamma=2$ and the given data, determine the maximum obtainable total value $\\sum_{i=1}^{5} v_i x_i$. Provide your final answer as a single real number. No rounding is required, and no units are needed.",
            "solution": "### Task 1: Conservative Robust Knapsack Model\n\nThe problem requires a model that guarantees feasibility for all possible weight realizations $w_i \\in [\\underline{w}_i, \\overline{w}_i]$. This is known as a box uncertainty model. The capacity constraint is $\\sum_{i=1}^{5} w_i x_i \\le W$. To guarantee feasibility for any realization of $w_i$ in its interval, the constraint must hold for the worst-case scenario. For a given selection of packages (a fixed set of $x_i = 1$), the left-hand side of the constraint, $\\sum_{i=1}^{5} w_i x_i$, is maximized when each selected package $i$ assumes its maximum possible weight, $\\overline{w}_i$.\n\nTherefore, the conservative robust constraint is:\n$$ \\sum_{i=1}^{5} \\overline{w}_i x_i \\le W $$\nThe full optimization model is to maximize the total value subject to this constraint and the binary nature of the decision variables.\n\nThe model is:\n$$ \\text{Maximize} \\quad Z = \\sum_{i=1}^{5} v_i x_i $$\n$$ \\text{Subject to:} \\quad \\sum_{i=1}^{5} \\overline{w}_i x_i \\le W $$\n$$ x_i \\in \\{0, 1\\} \\quad \\forall i \\in \\{1, 2, 3, 4, 5\\} $$\n\n### Task 2: Budgeted Uncertainty Model Derivation\n\nThe budgeted uncertainty set is defined by weights $w_i = \\underline{w}_i + d_i s_i$, where $d_i = \\overline{w}_i - \\underline{w}_i$ is the deviation, $s_i \\in [0, 1]$ are adversarial variables, and their sum is bounded by a budget $\\Gamma$, i.e., $\\sum_{i=1}^{5} s_i \\le \\Gamma$.\n\nThe robust feasibility condition requires the capacity constraint $\\sum_{i=1}^{5} w_i x_i \\le W$ to hold for all admissible realizations of $w_i$. Substituting the expression for $w_i$:\n$$ \\sum_{i=1}^{5} (\\underline{w}_i + d_i s_i) x_i \\le W \\quad \\forall s_i \\in [0, 1] \\text{ such that } \\sum_{i=1}^{5} s_i \\le \\Gamma $$\nThis can be rewritten as:\n$$ \\sum_{i=1}^{5} \\underline{w}_i x_i + \\sum_{i=1}^{5} d_i s_i x_i \\le W $$\nTo ensure this inequality holds for all valid $s_i$, it must hold for the choice of $s_i$ that maximizes the left-hand side. This leads to the robust counterpart constraint:\n$$ \\sum_{i=1}^{5} \\underline{w}_i x_i + \\max_{\\substack{s_i \\in [0,1] \\forall i \\\\ \\sum_i s_i \\le \\Gamma}} \\left\\{ \\sum_{i=1}^{5} d_i x_i s_i \\right\\} \\le W $$\nFor a fixed vector $x \\in \\{0,1\\}^5$, the inner maximization is a linear programming problem for the adversary:\n$$\n\\begin{aligned}\n\\text{(P)} \\quad \\max_{s_1, \\dots, s_5}  \\sum_{i=1}^{5} (d_i x_i) s_i \\\\\n\\text{s.t.}  \\sum_{i=1}^{5} s_i \\le \\Gamma \\\\\n s_i \\le 1, \\quad \\forall i \\in \\{1, \\dots, 5\\} \\\\\n s_i \\ge 0, \\quad \\forall i \\in \\{1, \\dots, 5\\}\n\\end{aligned}\n$$\nThe value of this maximum is the \"protection function\". Deriving a general closed form for this function in terms of $x_i$ leads to a non-linear constraint. A standard way to obtain an equivalent linear constraint system is to use strong duality of linear programming. The dual of the adversary's problem (P) is:\n$$\n\\begin{aligned}\n\\text{(D)} \\quad \\min_{\\lambda, \\mu_i}  \\quad \\Gamma \\lambda + \\sum_{i=1}^{5} \\mu_i \\\\\n\\text{s.t.}  \\quad \\lambda + \\mu_i \\ge d_i x_i, \\quad \\forall i \\in \\{1, \\dots, 5\\} \\\\\n \\quad \\lambda \\ge 0, \\mu_i \\ge 0, \\quad \\forall i \\in \\{1, \\dots, 5\\}\n\\end{aligned}\n$$\nBy strong duality, $\\max(P) = \\min(D)$. We can substitute the dual problem into the robust counterpart constraint. This gives a min-min problem, which can be combined into a single minimization. Furthermore, we can introduce new variables $z_i$ to represent the terms $\\mu_i$, which allows us to linearize the formulation. Let $z_i$ be variables that will take the place of $\\mu_i$ in the objective. From the dual constraint, we must have $\\mu_i \\ge d_i x_i - \\lambda$. Since we are minimizing and $\\mu_i$ must be non-negative, we can set $\\mu_i = \\max(0, d_i x_i - \\lambda)$. To model this in a linear fashion, we introduce variables $z_i$ such that $z_i \\ge 0$ and $z_i \\ge d_i x_i - \\lambda$. The minimization will ensure $z_i$ takes on the value $\\max(0, d_i x_i - \\lambda)$.\n\nThe robust capacity constraint is thus equivalent to the following system of linear inequalities involving the original variables $x_i$ and auxiliary continuous variables $\\lambda$ and $z_i$:\n$$ \\sum_{i=1}^{5} \\underline{w}_i x_i + \\Gamma \\lambda + \\sum_{i=1}^{5} z_i \\le W $$\n$$ z_i \\ge d_i x_i - \\lambda, \\quad \\forall i \\in \\{1, \\dots, 5\\} $$\n$$ z_i \\ge 0, \\quad \\forall i \\in \\{1, \\dots, 5\\} $$\n$$ \\lambda \\ge 0 $$\nThis set of constraints is the robust capacity constraint derived from first principles.\n\n### Task 3: Optimal Value for $\\Gamma=2$\n\nWe need to solve the following mixed-integer linear program (MILP):\n$$ \\text{Maximize} \\quad Z = 12x_1 + 10x_2 + 14x_3 + 16x_4 + 7x_5 $$\nSubject to:\n$$ x_i \\in \\{0, 1\\}, \\quad \\forall i \\in \\{1, \\dots, 5\\} $$\nand the robust capacity constraint from Task 2, with given data:\n- $v = (12, 10, 14, 16, 7)$\n- $\\underline{w} = (3, 4, 2, 5, 1)$\n- $\\overline{w} = (5, 4.5, 6, 7, 3)$\n- $d = \\overline{w} - \\underline{w} = (2, 0.5, 4, 2, 2)$\n- $W = 15$ and $\\Gamma = 2$\n\nFor a small problem with $2^5=32$ possible selections, we can find the optimal solution by evaluating the most promising combinations. For any given selection $x$, the robust weight is $\\sum_i \\underline{w}_i x_i + R(x)$, where $R(x)$ is the protection cost. Since $\\Gamma=2$ is an integer, $R(x)$ is the sum of the two largest deviations $\\{d_i\\}$ for which $x_i=1$. If one or zero packages are selected, it is the sum of all their deviations.\n\nLet's test key combinations:\n\n1.  **Selection {3, 4, 5}**: $x=(0,0,1,1,1)$\n    - Value: $v_3+v_4+v_5 = 14+16+7 = 37$.\n    - Nominal weight: $\\underline{w}_3+\\underline{w}_4+\\underline{w}_5 = 2+5+1 = 8$.\n    - Selected deviations: $\\{d_3, d_4, d_5\\} = \\{4, 2, 2\\}$.\n    - Protection cost (sum of 2 largest): $4+2=6$.\n    - Robust weight: $8+6 = 14$.\n    - Feasibility: $14 \\le 15$. This solution is feasible.\n\n2.  **Selection {1, 2, 3}**: $x=(1,1,1,0,0)$\n    - Value: $v_1+v_2+v_3 = 12+10+14=36$.\n    - Nominal weight: $\\underline{w}_1+\\underline{w}_2+\\underline{w}_3 = 3+4+2=9$.\n    - Selected deviations: $\\{d_1, d_2, d_3\\} = \\{2, 0.5, 4\\}$.\n    - Protection cost (sum of 2 largest): $4+2=6$.\n    - Robust weight: $9+6=15$.\n    - Feasibility: $15 \\le 15$. This solution is feasible.\n\n3.  **Selection {1, 4, 5}**: $x=(1,0,0,1,1)$\n    - Value: $v_1+v_4+v_5 = 12+16+7=35$.\n    - Nominal weight: $\\underline{w}_1+\\underline{w}_4+\\underline{w}_5 = 3+5+1=9$.\n    - Selected deviations: $\\{d_1, d_4, d_5\\} = \\{2, 2, 2\\}$.\n    - Protection cost (sum of 2 largest): $2+2=4$.\n    - Robust weight: $9+4=13$.\n    - Feasibility: $13 \\le 15$. This solution is feasible.\n\n4.  **Selection {1, 3, 4}**: $x=(1,0,1,1,0)$\n    - Value: $v_1+v_3+v_4 = 12+14+16=42$.\n    - Nominal weight: $\\underline{w}_1+\\underline{w}_3+\\underline{w}_4 = 3+2+5=10$.\n    - Selected deviations: $\\{d_1, d_3, d_4\\} = \\{2, 4, 2\\}$.\n    - Protection cost (sum of 2 largest): $4+2=6$.\n    - Robust weight: $10+6=16$.\n    - Feasibility: $16 > 15$. This solution is infeasible.\n\nSystematic exploration shows that any combination of 4 or 5 packages is infeasible. For example, the combination with the lowest nominal weight among 4-package sets is {1, 2, 3, 5}, with nominal weight $3+4+2+1=10$. The deviations are $\\{2, 0.5, 4, 2\\}$, so the protection cost is $4+2=6$. The robust weight is $10+6=16$, which exceeds the capacity of $15$.\n\nComparing the values of all feasible solutions, the maximum value obtained is from the selection {3, 4, 5}.\n\nThe maximum obtainable total value is $37$.",
            "answer": "$$\\boxed{37}$$"
        }
    ]
}