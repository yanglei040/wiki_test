{
    "hands_on_practices": [
        {
            "introduction": "我们如何通过计算来判断一个向量 $y$ 是否可以由一组给定的向量 $\\{r_i\\}$ 非负线性组合而成？这个练习将引导你将这个几何问题构建成一个线性规划问题。你会发现，当答案为“否”时，对偶性原理会提供一个“非成员”的证明：一个分离超平面。这个练习连接了基本定义和计算算法。",
            "id": "3110862",
            "problem": "给定一个实向量空间中的有限射线族，由向量 $\\{r_i\\}_{i=1}^m \\subset \\mathbb{R}^n$ 表示。这些射线的锥包（也称为有限生成锥）根据第一性原理定义为集合\n$$\n\\operatorname{cone}(\\{r_i\\}_{i=1}^m) \\;=\\; \\left\\{ \\sum_{i=1}^m \\lambda_i r_i \\;:\\; \\lambda_i \\in \\mathbb{R}_{\\ge 0} \\right\\}.\n$$\n给定一个目标向量 $y \\in \\mathbb{R}^n$，您的任务是算法性地判断是否 $y \\in \\operatorname{cone}(\\{r_i\\})$，并在 $y \\notin \\operatorname{cone}(\\{r_i\\})$ 时解释一个对偶凭证。\n\n基本依据和要求：\n- 使用锥包的核心定义和标准的线性规划可行性观点：隶属关系 $y \\in \\operatorname{cone}(\\{r_i\\})$ 等价于存在非负系数 $\\lambda \\in \\mathbb{R}^m_{\\ge 0}$ 满足线性等式 $\\sum_{i=1}^m \\lambda_i r_i = y$。\n- 将此问题构建为一个以 $\\lambda \\in \\mathbb{R}^m$ 为决策变量的线性规划：最小化 $0$，约束条件为 $R \\lambda = y$，$\\lambda \\ge 0$，其中 $R \\in \\mathbb{R}^{n \\times m}$ 的列为 $r_1, \\dots, r_m$。\n- 如果上述问题不可行，则使用基于分离超平面定理或 Farkas' Lemma 的对偶分离观点，找到一个分离向量 $w \\in \\mathbb{R}^n$ 满足对所有 $i$ 都有 $w^\\top r_i \\ge 0$ 且 $w^\\top y  0$。为了通过线性规划获得一个具体的凭证，求解一个关于 $w$ 的可行性线性规划：\n  - 找到 $w \\in \\mathbb{R}^n$ 使得 $R^\\top w \\le 0$ 且 $y^\\top w \\ge 1$；然后设 $w_{\\mathrm{sep}} := -w$。这确保了对所有 $i$ 都有 $w_{\\mathrm{sep}}^\\top r_i \\ge 0$ 且 $w_{\\mathrm{sep}}^\\top y \\le -1  0$，这是一个严格的分离超平面凭证。\n\n您的程序必须使用线性规划实现此方法，并为每个测试用例生成以下内容：\n- 一个布尔值，指示 $y \\in \\operatorname{cone}(\\{r_i\\})$ 是否成立。\n- 如果答案为真，提供一个可行的系数向量 $\\lambda \\in \\mathbb{R}^m_{\\ge 0}$，并报告欧几里得残差范数 $\\lVert R \\lambda - y \\rVert_2$。\n- 如果答案为假，提供一个分离向量 $w_{\\mathrm{sep}} \\in \\mathbb{R}^n$，并报告在生成元上的最小间隔 $\\min_i \\{ w_{\\mathrm{sep}}^\\top r_i \\}$ 以及值 $w_{\\mathrm{sep}}^\\top y$。\n\n测试套件：\n在 $\\mathbb{R}^2$ 中进行操作，并使用以下五个测试用例。每个用例包含一个射线列表和一个目标向量 $y$。\n1. 射线 $\\{(1,0), (0,1)\\}$，目标 $y = (1,2)$。\n2. 射线 $\\{(1,0), (0,1)\\}$，目标 $y = (-1,1)$。\n3. 射线 $\\{(1,0), (0,1)\\}$，目标 $y = (0,0)$。\n4. 射线 $\\{(1,1), (1,-1)\\}$，目标 $y = (2,0)$。\n5. 射线 $\\{(1,1), (1,-1)\\}$，目标 $y = (1,1.2)$。\n\n所有向量都应被解释为 $\\mathbb{R}^2$ 的元素，没有物理单位。不涉及角度，也不使用百分比。\n\n程序输出规范：\n- 对于每个测试用例，输出一个具有以下结构的列表：\n  - 用例结果格式：$[\\text{is\\_member}, \\lambda\\_\\text{list}, w\\_\\text{sep\\_list}, \\text{verification\\_list}]$,\n    - 如果 $\\text{is\\_member}$ 为真，则 $\\lambda\\_\\text{list}$ 是系数 $\\lambda_i$ 的列表，$w\\_\\text{sep\\_list}$ 是空列表，而 $\\text{verification\\_list}$ 包含一个等于 $\\lVert R \\lambda - y \\rVert_2$ 的浮点数。\n    - 如果 $\\text{is\\_member}$ 为假，则 $\\lambda\\_\\text{list}$ 是空列表，$w\\_\\text{sep\\_list}$ 是一个分离向量 $w_{\\mathrm{sep}}$，而 $\\text{verification\\_list}$ 包含两个浮点数：$\\min_i \\{ w_{\\mathrm{sep}}^\\top r_i \\}$ 和 $w_{\\mathrm{sep}}^\\top y$。\n- 您的程序应生成单行输出，其中包含所有五个用例的结果，形式为用方括号括起来的逗号分隔列表。具体来说，输出必须是以下形式的单行：\n  $$\n  [\\text{case1\\_result},\\text{case2\\_result},\\text{case3\\_result},\\text{case4\\_result},\\text{case5\\_result}]\n  $$\n其中每个 $\\text{caseX\\_result}$ 本身就是如上所述的列表。\n\n覆盖范围和边界情况设计：\n- 用例 1 是一个典型的隶属实例。\n- 用例 2 是一个典型的非隶属实例，具有清晰的轴对齐分离器。\n- 用例 3 是一个边界情况 ($y = 0$)。\n- 用例 4 是在一个非象限锥中的隶属关系。\n- 用例 5 是在一个非象限锥中的非隶属关系，具有一个非平凡的分离超平面。\n\n您的解决方案必须仅依赖于锥包的基本定义以及带有非负约束的线性等式的可行性，并且必须使用线性规划来获得凭证。不允许外部输入；所有数据都如上所示硬编码。最终的数值输出应四舍五入到合理的小数位数，以确保可读性，同时保持符号和零与非零区别的正确性。",
            "solution": "该问题要求一个算法程序，以确定给定向量 $y \\in \\mathbb{R}^n$ 是否位于有限向量集 $\\{r_i\\}_{i=1}^m \\subset \\mathbb{R}^n$ 的锥包内。锥包，记作 $\\operatorname{cone}(\\{r_i\\})$，是生成向量的所有非负线性组合的集合：\n$$\n\\operatorname{cone}(\\{r_i\\}_{i=1}^m) \\;=\\; \\left\\{ \\sum_{i=1}^m \\lambda_i r_i \\;:\\; \\lambda_i \\in \\mathbb{R}_{\\ge 0} \\right\\}\n$$\n一个向量 $y$ 在此锥中，当且仅当存在系数 $\\lambda = (\\lambda_1, \\dots, \\lambda_m)^\\top$ 使得：\n$$\n\\sum_{i=1}^m \\lambda_i r_i = y, \\quad \\text{其中对于所有 } i=1, \\dots, m\\text{，都有 } \\lambda_i \\ge 0\n$$\n这可以表示为矩阵形式 $R\\lambda = y$，其中 $R \\in \\mathbb{R}^{n \\times m}$ 是列为向量 $r_i$ 的矩阵。因此，隶属关系的条件是存在一个带有变量非负约束的线性方程组的解。\n\n这个可行性问题可以被表述为一个线性规划（LP）。具体来说，我们寻求找到一个满足约束条件的向量 $\\lambda \\in \\mathbb{R}^m$，其中对于可行性问题，目标函数的选择是无关紧要的。一个标准的选择是最小化一个零目标函数，$c^\\top \\lambda = 0^\\top \\lambda = 0$：\n\n**原始 LP (隶属问题):**\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  0 \\\\\n\\text{subject to} \\quad  R \\lambda = y \\\\\n \\lambda \\ge 0\n\\end{aligned}\n$$\n如果这个 LP 有一个可行解，那么这样的 $\\lambda$ 就存在，并且 $y \\in \\operatorname{cone}(\\{r_i\\})$。向量 $\\lambda$ 本身可作为隶属关系的凭证。这个凭证的质量可以通过计算欧几里得残差范数 $\\lVert R \\lambda - y \\rVert_2$ 来检验，对于一个数值精确的解，这个值应该接近于零。\n\n如果原始 LP 不可行，那么就不存在这样的非负 $\\lambda$，并且 $y \\notin \\operatorname{cone}(\\{r_i\\})$。根据线性规划的对偶性原理，特别是 Farkas' Lemma（一个择一性定理），原始系统的不可行性意味着一个相关对偶系统的可行性。这就引出了分离超平面的概念。一个由法向量 $w_{\\mathrm{sep}} \\in \\mathbb{R}^n$ 定义的超平面将 $y$ 与锥分开，如果 $w_{\\mathrm{sep}}^\\top y  0$ 且对所有 $z \\in \\operatorname{cone}(\\{r_i\\})$ 都有 $w_{\\mathrm{sep}}^\\top z \\ge 0$。为使后一个条件成立，对于所有生成向量 $r_i$ 都有 $w_{\\mathrm{sep}}^\\top r_i \\ge 0$ 是充分的。\n\n问题陈述提供了一个特定的 LP 公式来寻找这样一个分离向量。我们寻求一个中间向量 $w \\in \\mathbb{R}^n$ 来满足一组不等式，并从中推导出 $w_{\\mathrm{sep}}$。\n\n**分离 LP (非隶属凭证):**\n$$\n\\begin{aligned}\n\\text{寻找} \\quad  w \\in \\mathbb{R}^n \\\\\n\\text{subject to} \\quad  R^\\top w \\le 0 \\\\\n y^\\top w \\ge 1\n\\end{aligned}\n$$\n这也是一个可行性 LP。我们可以将约束 $y^\\top w \\ge 1$ 重写为 $(-y)^\\top w \\le -1$ 以符合标准形式 $A_w w \\le b_w$。如果该系统存在一个解 $w$，我们定义分离向量为 $w_{\\mathrm{sep}} := -w$。让我们验证一下这个 $w_{\\mathrm{sep}}$ 是否具有所需的性质：\n1. 对于每个生成元 $r_i$，约束为 $r_i^\\top w \\le 0$。那么 $w_{\\mathrm{sep}}^\\top r_i = (-w)^\\top r_i = -(w^\\top r_i) \\ge 0$。这证实了 $w_{\\mathrm{sep}}$ 与所有生成元形成非负内积，因此也与锥中的所有向量形成非负内积。\n2. 约束 $y^\\top w \\ge 1$ 意味着 $w_{\\mathrm{sep}}^\\top y = (-w)^\\top y = -(y^\\top w) \\le -1$。这是一个严格的负值，证实了 $y$ 位于超平面上与锥相对的一侧。\n\n总体算法如下：\n1. 为系数 $\\lambda$ 构建并尝试求解原始 LP。\n2. 如果原始 LP 可行（成功），则断定 $y$ 在锥内。解向量 $\\lambda$ 即为隶属凭证。\n3. 如果原始 LP 不可行，则断定 $y$ 不在锥内。为向量 $w$ 构建并求解分离 LP。导出的向量 $w_{\\mathrm{sep}} = -w$ 即为非隶属凭证。\n\n将使用数值线性规划求解器为每个测试用例实现此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_case(rays, y):\n    \"\"\"\n    Determines if a vector y is in the conic hull of a set of rays.\n\n    Args:\n        rays (list of tuples): A list of vectors representing the rays.\n        y (np.ndarray): The target vector.\n\n    Returns:\n        list: A result list in the format specified by the problem.\n    \"\"\"\n    R = np.array(rays).T\n    if R.ndim == 1: # Handle case of a single ray (1D vector)\n        R = R.reshape(-1, 1)\n        \n    n_dim, m_rays = R.shape\n\n    # --- Primal LP (Membership Test) ---\n    # Try to find lambda = 0 such that R @ lambda = y.\n    # min 0 subject to R @ lambda = y, lambda = 0\n    c_primal = np.zeros(m_rays)\n    # The bounds argument enforces lambda = 0 by default when set to (0, None).\n    res_primal = linprog(\n        c=c_primal,\n        A_eq=R,\n        b_eq=y,\n        bounds=(0, None),\n        method='highs'\n    )\n\n    if res_primal.success:\n        # y is in the cone.\n        lambda_coeffs = res_primal.x\n        residual = np.linalg.norm(R @ lambda_coeffs - y)\n        return [\n            True,\n            list(np.round(lambda_coeffs, 5)),\n            [],\n            [round(residual, 5)]\n        ]\n    else:\n        # y is not in the cone. Find a separating hyperplane.\n        # --- Separation LP (Non-Membership Certificate) ---\n        # Find w such that R.T @ w = 0 and y.T @ w = 1.\n        # We rewrite y.T @ w = 1 as -y.T @ w = -1.\n        # This is equivalent to min 0 subject to A_ub @ w = b_ub.\n        c_dual = np.zeros(n_dim)\n        \n        # A_ub has shape (m_rays + 1, n_dim)\n        A_ub_dual = np.vstack([R.T, -y.reshape(1, -1)])\n        \n        # b_ub has shape (m_rays + 1,)\n        b_ub_dual = np.zeros(m_rays + 1)\n        b_ub_dual[-1] = -1.0\n        \n        res_dual = linprog(\n            c=c_dual,\n            A_ub=A_ub_dual,\n            b_ub=b_ub_dual,\n            bounds=(None, None), # w is unbounded\n            method='highs'\n        )\n\n        if res_dual.success:\n            w = res_dual.x\n            w_sep = -w\n            \n            # verification_list: [min_margin, w_sep_dot_y]\n            min_margin = np.min(w_sep @ R)\n            w_sep_dot_y = w_sep @ y\n            \n            return [\n                False,\n                [],\n                list(np.round(w_sep, 5)),\n                [round(min_margin, 5), round(w_sep_dot_y, 5)]\n            ]\n        else:\n            # According to Farkas' Lemma, this case should not be reached\n            # if the primal is infeasible. This indicates a numerical issue.\n            return [\"Error: Both primal and dual LPs are infeasible.\"]\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # 1. Rays {(1,0), (0,1)}, target y = (1,2) - In cone\n        ([(1, 0), (0, 1)], (1, 2)),\n        # 2. Rays {(1,0), (0,1)}, target y = (-1,1) - Not in cone\n        ([(1, 0), (0, 1)], (-1, 1)),\n        # 3. Rays {(1,0), (0,1)}, target y = (0,0) - In cone (boundary)\n        ([(1, 0), (0, 1)], (0, 0)),\n        # 4. Rays {(1,1), (1,-1)}, target y = (2,0) - In cone\n        ([(1, 1), (1, -1)], (2, 0)),\n        # 5. Rays {(1,1), (1,-1)}, target y = (1,1.2) - Not in cone\n        ([(1, 1), (1, -1)], (1, 1.2)),\n    ]\n\n    results = []\n    for rays, y in test_cases:\n        y_vec = np.array(y)\n        result = solve_case(rays, y_vec)\n        # The string representation of a Python list matches the required output format for a single case.\n        results.append(str(result))\n\n    # Join the string representations of each case result with commas and enclose in brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对偶锥 $K^*$ 是一个优美的几何概念，但它在优化中的真正威力体现在我们构建对偶问题之时。本练习要求你从拉格朗日函数等第一性原理出发，推导一个锥优化问题的对偶问题。通过比较一个标准的线性规划（其锥为非负卦限）和一个二阶锥规划，你将更深刻地理解锥 $K$ 的几何性质是如何通过 $K^*$ 直接影响其对偶问题的约束条件的。",
            "id": "3110866",
            "problem": "考虑带有锥约束的锥优化模板。设决策向量为 $x \\in \\mathbb{R}^{3}$，成本向量为 $c \\in \\mathbb{R}^{3}$，线性约束为 $A x = b$，其中 $A \\in \\mathbb{R}^{1 \\times 3}$ 且 $b \\in \\mathbb{R}$。从第一性原理出发，从锥、其对偶锥以及约束优化问题的拉格朗日量的定义开始。不要使用任何预先给出的对偶公式；相反，通过对拉格朗日量取下确界来消去原始变量，从而推导出对偶问题。\n\n使用以下具体数据：设 $A = \\begin{bmatrix} 1  1  1 \\end{bmatrix}$，$b = 1$，$c = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$。考虑仅由锥 $K$ 区分的两种情况。\n\n1) 首先，取 $K = \\mathbb{R}^{3}_{+}$。构造相应的原始问题，使用对偶锥 $K^{\\ast}$ 的定义和拉格朗日量推导出其对偶问题，并求解最优值。用基本几何对象的术语解释对偶可行域的几何形状。\n\n2) 接下来，将 $K$ 替换为三维二阶锥 $Q_{3} = \\{ (t,u_{1},u_{2}) \\in \\mathbb{R}^{3} \\mid t \\geq \\sqrt{u_{1}^{2} + u_{2}^{2}} \\}$。构造相应的原始问题，通过相同的第一性原理方法推导出其对偶问题，并求解最优值。就可行集的形状而言，将你在此处得到的对偶可行域的几何形状与第一部分中的进行比较。\n\n最后，令 $v_{+}$ 表示当 $K = \\mathbb{R}^{3}_{+}$ 时的最优目标值，令 $v_{Q}$ 表示当 $K = Q_{3}$ 时的最优目标值。报告 $v_{Q} - v_{+}$ 的精确值。无需四舍五入，不涉及单位。你的最终答案必须是单一的封闭形式表达式。",
            "solution": "本问题要求推导并求解两个锥优化问题，这两个问题仅在锥 $K$ 的选择上有所不同。最终目标是计算它们最优目标值之间的差。我们将按要求从第一性原理出发。\n\n一个锥 $K \\subseteq \\mathbb{R}^{n}$ 是一个在非负标量乘法下封闭的集合，即对于任何 $x \\in K$ 和任何 $\\alpha \\geq 0$，都有 $\\alpha x \\in K$。\n一个锥 $K$ 的对偶锥 $K^{\\ast}$ 定义为 $K^{\\ast} = \\{y \\in \\mathbb{R}^{n} \\mid y^{T}x \\geq 0 \\text{ for all } x \\in K\\}$。\n\n原始锥优化问题的一般形式是：\n$$\n\\begin{array}{ll}\n\\text{minimize}   c^{T}x \\\\\n\\text{subject to}  Ax = b \\\\\n x \\in K\n\\end{array}\n$$\n其中 $x \\in \\mathbb{R}^{n}$ 是决策向量，$c \\in \\mathbb{R}^{n}$ 是成本向量，$A \\in \\mathbb{R}^{m \\times n}$ 和 $b \\in \\mathbb{R}^{m}$ 定义了线性等式约束，而 $K$ 是一个闭凸锥。\n\n为了推导对偶问题，我们通过将对偶变量 $\\nu \\in \\mathbb{R}^{m}$ 与等式约束 $Ax=b$ 相关联来构造拉格朗日量：\n$$L(x, \\nu) = c^{T}x + \\nu^{T}(Ax - b) = (c + A^{T}\\nu)^{T}x - b^{T}\\nu$$\n对偶函数 $g(\\nu)$ 是拉格朗日量在原始变量 $x$ 上的下确界，受限于剩余约束 $x \\in K$：\n$$g(\\nu) = \\inf_{x \\in K} L(x, \\nu) = \\inf_{x \\in K} \\left\\{ (c + A^{T}\\nu)^{T}x \\right\\} - b^{T}\\nu$$\n下确界的值取决于向量 $s = c + A^{T}\\nu$ 是否位于对偶锥 $K^{\\ast}$ 中。\n如果 $s \\in K^{\\ast}$，那么根据定义，对于所有 $x \\in K$，都有 $s^{T}x \\geq 0$。由于 $0 \\in K$（因为 $K$ 是一个锥），下确界在 $x=0$ 处达到，其值为 $0$。\n如果 $s \\notin K^{\\ast}$，则存在某个 $x_{0} \\in K$ 使得 $s^{T}x_{0}  0$。由于 $K$ 是一个锥，对于任何 $\\alpha > 0$，都有 $\\alpha x_{0} \\in K$。那么当 $\\alpha \\to \\infty$ 时，$s^{T}(\\alpha x_{0}) = \\alpha (s^{T}x_{0}) \\to -\\infty$。因此下确界为 $-\\infty$。\n因此，对偶函数为：\n$$\ng(\\nu) = \\begin{cases}\n-b^{T}\\nu  \\text{if } c + A^{T}\\nu \\in K^{\\ast} \\\\\n-\\infty  \\text{otherwise}\n\\end{cases}\n$$\n对偶问题是最大化对偶函数 $g(\\nu)$：\n$$\n\\begin{array}{ll}\n\\text{maximize}   -b^{T}\\nu \\\\\n\\text{subject to}  c + A^{T}\\nu \\in K^{\\ast}\n\\end{array}\n$$\n在这个具体问题中，我们有 $n=3$ 和 $m=1$。数据为 $c = \\begin{bmatrix} 1  0  0 \\end{bmatrix}^{T}$，$A = \\begin{bmatrix} 1  1  1 \\end{bmatrix}$，以及 $b=1$。对偶变量 $\\nu$ 是一个标量。对偶问题变为：\n$$\n\\begin{array}{ll}\n\\text{maximize}   -\\nu \\\\\n\\text{subject to}  \\begin{bmatrix} 1 + \\nu \\\\ \\nu \\\\ \\nu \\end{bmatrix} \\in K^{\\ast}\n\\end{array}\n$$\n\n**1) 情况1：非负象限, $K = \\mathbb{R}^{3}_{+}$**\n\n首先，我们确定对偶锥 $K^{\\ast} = (\\mathbb{R}^{3}_{+})^{\\ast}$。一个向量 $y = (y_1, y_2, y_3)^{T}$ 属于 $(\\mathbb{R}^{3}_{+})^{\\ast}$ 当且仅当对于所有 $x = (x_1, x_2, x_3)^{T}$ 且 $x_i \\geq 0$，都有 $y^{T}x = y_1x_1 + y_2x_2 + y_3x_3 \\geq 0$。通过选择在 $\\mathbb{R}^{3}_{+}$ 中的标准基向量 $x = e_i$，我们发现必须有 $y_i \\geq 0$ (对于 $i=1,2,3$）。这意味着 $y \\in \\mathbb{R}^{3}_{+}$。反之，如果 $y \\in \\mathbb{R}^{3}_{+}$，那么对于所有 $x \\in \\mathbb{R}^{3}_{+}$，都有 $y^{T}x \\geq 0$。因此，$\\mathbb{R}^{3}_{+}$ 是自对偶的：$(\\mathbb{R}^{3}_{+})^{\\ast} = \\mathbb{R}^{3}_{+}$。\n\n原始问题 $(P_{+})$ 是：\n$$\n\\begin{array}{ll}\n\\text{minimize}   x_1 \\\\\n\\text{subject to}  x_1+x_2+x_3 = 1 \\\\\n x_1 \\geq 0, x_2 \\geq 0, x_3 \\geq 0\n\\end{array}\n$$\n为在约束条件下最小化 $x_1$，我们应该为 $x_1$ 选择最小的可能的非负值，即 $x_1=0$。这是可行的；例如，$x=(0, 1, 0)^{T}$ 满足 $0+1+0=1$ 并且所有分量都是非负的。最优目标值为 $v_{+} = 0$。\n\n对偶问题 $(D_{+})$ 是：\n$$\n\\begin{array}{ll}\n\\text{maximize}   -\\nu \\\\\n\\text{subject to}  \\begin{bmatrix} 1 + \\nu \\\\ \\nu \\\\ \\nu \\end{bmatrix} \\in \\mathbb{R}^{3}_{+}\n\\end{array}\n$$\n约束条件是 $1+\\nu \\geq 0$，$\\nu \\geq 0$ 和 $\\nu \\geq 0$。这些可以简化为 $\\nu \\geq 0$。我们想要在 $\\nu \\geq 0$ 的约束下最大化 $-\\nu$。最大值在 $\\nu$ 的最小可能值处取得，即 $\\nu=0$。最优对偶值为 $-0 = 0$，这与原始最优值相匹配。\n\n$\\nu$ 的对偶可行域是集合 $\\{\\nu \\in \\mathbb{R} \\mid \\nu \\geq 0\\}$，这是一个闭的、无界的区间（一条射线）。\n\n**2) 情况2：二阶锥, $K = Q_{3}$**\n\n设 $x=(x_1, x_2, x_3)^{T}$。该锥为 $Q_{3} = \\{ x \\in \\mathbb{R}^{3} \\mid x_1 \\geq \\sqrt{x_2^2 + x_3^2} \\}$。\n二阶锥也是自对偶的：$(Q_{3})^{\\ast} = Q_{3}$。为了证明这一点，考虑 $y \\in (Q_3)^*$。那么对于所有 $x \\in Q_3$ 都有 $y^T x \\ge 0$。设 $x = (x_1, x_v)$，其中 $x_v=(x_2,x_3)$。条件是 $x_1 \\ge \\|x_v\\|_2$。我们需要 $y_1 x_1 + y_v^T x_v \\ge 0$。这必须对所有 $x_1 \\ge \\|x_v\\|_2$ 成立。为了在给定 $x_v$ 的情况下最小化该表达式，我们选择 $x_1 = \\|x_v\\|_2$。所以我们需要对所有 $x_v$ 都有 $y_1 \\|x_v\\|_2 + y_v^T x_v \\ge 0$。根据柯西-施瓦茨不等式，$y_v^T x_v \\ge -\\|y_v\\|_2 \\|x_v\\|_2$。因此 $y_1 \\|x_v\\|_2 + y_v^T x_v \\ge (y_1 - \\|y_v\\|_2)\\|x_v\\|_2$。为使该式对所有 $x_v$ 都为非负，我们必须有 $y_1 - \\|y_v\\|_2 \\ge 0$，即 $y_1 \\ge \\sqrt{y_2^2+y_3^2}$。这正是 $y \\in Q_3$ 的条件。\n\n原始问题 $(P_{Q})$ 是：\n$$\n\\begin{array}{ll}\n\\text{minimize}   x_1 \\\\\n\\text{subject to}  x_1+x_2+x_3 = 1 \\\\\n x_1 \\geq \\sqrt{x_2^2 + x_3^2}\n\\end{array}\n$$\n根据等式约束，$x_1 = 1 - x_2 - x_3$。代入锥约束中：$1-x_2-x_3 \\geq \\sqrt{x_2^2+x_3^2}$。最小化 $x_1$ 等价于最大化 $x_2+x_3$。\n约束要求 $1-x_2-x_3 \\geq 0$，所以我们可以对两边平方：$(1-(x_2+x_3))^2 \\geq x_2^2+x_3^2$，简化为 $1-2(x_2+x_3)+2x_2x_3 \\geq 0$。我们可以将其重写为 $2(x_2-1)(x_3-1) \\geq 1$。\n问题简化为在 $(x_2-1)(x_3-1) \\geq \\frac{1}{2}$ 和 $x_2+x_3 \\leq 1$ 的约束下最大化 $S=x_2+x_3$。在一个具有对称边界的区域上，对称线性函数的最大值出现在 $x_2=x_3$ 的点上。将 $x_2=x_3$ 代入边界条件 $(x_2-1)(x_3-1) = \\frac{1}{2}$ 得到 $(x_2-1)^2 = \\frac{1}{2}$，所以 $x_2-1 = \\pm \\frac{1}{\\sqrt{2}}$。由于 $x_2+x_3 \\leq 1$ 意味着 $2x_2 \\leq 1$ 或 $x_2 \\leq 1/2$，我们必须选择负根：$x_2 = 1 - \\frac{1}{\\sqrt{2}}$。那么 $x_3 = 1 - \\frac{1}{\\sqrt{2}}$。\n$x_2+x_3$ 的最大值是 $(1 - \\frac{1}{\\sqrt{2}}) + (1-\\frac{1}{\\sqrt{2}}) = 2-\\frac{2}{\\sqrt{2}} = 2-\\sqrt{2}$。\n最优原始值为 $v_{Q} = \\min x_1 = 1 - \\max(x_2+x_3) = 1 - (2-\\sqrt{2}) = \\sqrt{2}-1$。\n\n对偶问题 $(D_{Q})$ 是：\n$$\n\\begin{array}{ll}\n\\text{maximize}   -\\nu \\\\\n\\text{subject to}  \\begin{bmatrix} 1 + \\nu \\\\ \\nu \\\\ \\nu \\end{bmatrix} \\in Q_{3}\n\\end{array}\n$$\n约束条件是 $1+\\nu \\geq \\sqrt{\\nu^2+\\nu^2} = \\sqrt{2\\nu^2} = \\sqrt{2}|\\nu|$。\n此外，从 $1+\\nu \\geq \\dots \\geq 0$ 可知，我们必须有 $1+\\nu \\geq 0$，所以 $\\nu \\geq -1$。\n情况1：$\\nu \\geq 0$。不等式为 $1+\\nu \\geq \\sqrt{2}\\nu$，这意味着 $1 \\geq (\\sqrt{2}-1)\\nu$，所以 $\\nu \\leq \\frac{1}{\\sqrt{2}-1} = \\sqrt{2}+1$。这得出 $0 \\leq \\nu \\leq \\sqrt{2}+1$。\n情况2：$-1 \\leq \\nu  0$。不等式为 $1+\\nu \\geq \\sqrt{2}(-\\nu) = -\\sqrt{2}\\nu$，这意味着 $1 \\geq -(\\sqrt{2}+1)\\nu$，所以 $\\nu \\geq -\\frac{1}{\\sqrt{2}+1} = 1-\\sqrt{2}$。这得出 $1-\\sqrt{2} \\leq \\nu  0$。\n结合两种情况，$\\nu$ 的可行集是闭区间 $[1-\\sqrt{2}, \\sqrt{2}+1]$。\n我们想要最大化 $-\\nu$，这意味着我们必须选择 $\\nu$ 的最小可能值。最小的可行 $\\nu$ 是 $1-\\sqrt{2}$。\n最优对偶值为 $-(1-\\sqrt{2}) = \\sqrt{2}-1$，这也与原始最优值相匹配。\n\n$\\nu$ 的对偶可行域是集合 $\\{\\nu \\in \\mathbb{R} \\mid 1-\\sqrt{2} \\leq \\nu \\leq \\sqrt{2}+1\\}$，这是一个闭的、有界的区间（一条线段）。这与第一部分中发现的无界射线形成对比。原始问题中更具限制性的锥 ($Q_3 \\subset \\mathbb{R}^3_+$) 导致了对偶变量更大的可行集。\n\n最后，我们计算所需的最优值之差：\n$v_{Q} = \\sqrt{2}-1$\n$v_{+} = 0$\n差值为 $v_{Q} - v_{+} = (\\sqrt{2}-1) - 0 = \\sqrt{2}-1$。",
            "answer": "$$\\boxed{\\sqrt{2}-1}$$"
        },
        {
            "introduction": "当一个点在锥外时，一个分离超平面可以证明这一点。但是，我们能否找到“最佳”的分离超平面，或者量化该点与锥的“距离”？本练习将指导你基于这一思想，为一些重要的锥设计一个正式的成员资格测试。你将推导出一些出人意料的优雅结论：对于非负卦限，这个测试归结为找到向量的最小分量；而对于半正定锥，它则对应于找到最小特征值。",
            "id": "3110877",
            "problem": "考虑一个闭凸锥 $K \\subset \\mathbb{R}^{n}$，其对偶锥为 $K^{*} = \\{y \\in \\mathbb{R}^{n} \\mid \\langle y, x \\rangle \\ge 0 \\text{ for all } x \\in K\\}$，其中 $\\langle \\cdot, \\cdot \\rangle$ 表示标准欧几里得内积。根据超平面分离定理（凸分析中一个经过充分检验的事实），如果 $x \\notin K$，则存在一个由某个 $y \\in K^{*}$ 指定的超平面，将 $x$ 与 $K$ 严格分离，即对于所有 $z \\in K$，有 $\\langle y, x \\rangle  0 \\le \\langle y, z \\rangle$。\n\nA部分（多面体锥）。令 $K = \\mathbb{R}_{+}^{4}$ 为 $\\mathbb{R}^{4}$ 中的非负象限，并注意 $K^{*} = \\mathbb{R}_{+}^{4}$。通过考虑以下统计量，设计一个基于与 $K^{*}$ 严格分离的 $K$ 的成员资格检验：\n$$\nv(x) = \\inf\\{\\langle y, x \\rangle \\mid y \\in K^{*}, \\ \\mathbf{1}^{\\top} y = 1\\},\n$$\n其中 $\\mathbf{1}$ 是 $\\mathbb{R}^{4}$ 中所有分量均为 $1$ 的向量。从上述定义出发，推导一个适用于任何 $x \\in \\mathbb{R}^{4}$ 的 $v(x)$ 的闭式表达式，然后对下式计算该表达式的值：\n$$\nx = (1, -2, 3, 0).\n$$\n\nB部分（曲锥）。现在考虑由 $2 \\times 2$ 实对称半正定（PSD）矩阵构成的锥，记为 $S_{+}^{2}$，并赋以弗罗贝尼乌斯内积 $\\langle Y, X \\rangle = \\mathrm{Tr}(Y X)$，其中 $\\mathrm{Tr}(\\cdot)$ 表示迹。在此内积下，$S_{+}^{2}$ 的对偶锥是其自身。通过定义以下统计量，设计一个类似的基于严格分离的成员资格检验：\n$$\nw(X) = \\inf\\{\\langle Y, X \\rangle \\mid Y \\in S_{+}^{2}, \\ \\mathrm{Tr}(Y) = 1\\}.\n$$\n从第一性原理出发，推导一个适用于任何对称矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$ 的 $w(X)$ 的闭式表达式，然后对下式计算该表达式的值：\n$$\nX = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}.\n$$\n\n最后，将您的答案表示为一个包含 $v(x)$ 和 $w(X)$ 这两个值的单行矩阵，并按此顺序排列。无需四舍五入。最终答案不带单位。",
            "solution": "A部分：对非负象限的 $v(x)$ 进行分析\n\n问题的A部分要求为统计量 $v(x)$ 推导一个闭式表达式，其定义为：\n$$\nv(x) = \\inf\\{\\langle y, x \\rangle \\mid y \\in K^{*}, \\ \\mathbf{1}^{\\top} y = 1\\}\n$$\n其中 $K = \\mathbb{R}_{+}^{4}$ 是 $\\mathbb{R}^{4}$ 中的非负象限。已知对偶锥为 $K^{*} = \\mathbb{R}_{+}^{4}$。向量 $\\mathbf{1}$ 是一个所有分量都为1的向量，因此条件 $\\mathbf{1}^{\\top} y = 1$ 等价于 $\\sum_{i=1}^{4} y_i = 1$。内积是标准欧几里得内积，因此 $\\langle y, x \\rangle = \\sum_{i=1}^{4} y_i x_i$。\n\n因此，该问题是一个线性规划问题：\n$$\n\\begin{array}{ll}\n\\text{minimize}  \\sum_{i=1}^{4} y_i x_i \\\\\n\\text{subject to}  \\sum_{i=1}^{4} y_i = 1 \\\\\n y_i \\ge 0, \\quad \\text{for } i=1, 2, 3, 4.\n\\end{array}\n$$\n$y = (y_1, y_2, y_3, y_4)$ 的可行域是 $\\mathbb{R}^{4}$ 中的标准3-单纯形，它是一个紧凸集（一个多胞体）。目标函数是关于 $y$ 的线性函数。线性规划的一个基本定理指出，线性函数在多胞体上的最小值总是在其某个顶点处取得。\n\n标准单纯形的顶点是标准基向量：\n$e_1 = (1, 0, 0, 0)$, $e_2 = (0, 1, 0, 0)$, $e_3 = (0, 0, 1, 0)$ 和 $e_4 = (0, 0, 0, 1)$。\n\n我们可以通过在每个顶点处计算目标函数 $\\langle y, x \\rangle$ 的值来找到最小值：\n\\begin{itemize}\n    \\item 在 $y = e_1$ 处，值为 $\\langle e_1, x \\rangle = x_1$。\n    \\item 在 $y = e_2$ 处，值为 $\\langle e_2, x \\rangle = x_2$。\n    \\item 在 $y = e_3$ 处，值为 $\\langle e_3, x \\rangle = x_3$。\n    \\item 在 $y = e_4$ 处，值为 $\\langle e_4, x \\rangle = x_4$。\n\\end{itemize}\n下确界（即最小值）是这些值中最小的一个。因此，$v(x)$ 的闭式表达式为：\n$$\nv(x) = \\min\\{x_1, x_2, x_3, x_4\\}\n$$\n另外，令 $x_{\\min} = \\min_{i} x_i$。对于任何可行的 $y$（即 $y_i \\ge 0$ 且 $\\sum y_i = 1$），我们有：\n$$\n\\sum_{i=1}^{4} y_i x_i \\ge \\sum_{i=1}^{4} y_i x_{\\min} = x_{\\min} \\sum_{i=1}^{4} y_i = x_{\\min} \\cdot 1 = x_{\\min}\n$$\n这表明 $x_{\\min}$ 是一个下界。这个下界可以通过设置 $y = e_j$ 来达到，其中 $j$ 是使 $x_j = x_{\\min}$ 的任意索引。这个 $y$ 是可行的，且目标值为 $\\langle e_j, x \\rangle = x_j = x_{\\min}$。\n\n对于特定向量 $x = (1, -2, 3, 0)$，我们计算此表达式：\n$$\nv(x) = \\min\\{1, -2, 3, 0\\} = -2\n$$\n\nB部分：对半正定锥的 $w(X)$ 进行分析\n\n问题的B部分要求为统计量 $w(X)$ 推导一个闭式表达式：\n$$\nw(X) = \\inf\\{\\langle Y, X \\rangle \\mid Y \\in S_{+}^{2}, \\ \\mathrm{Tr}(Y) = 1\\}\n$$\n其中 $S_{+}^{2}$ 是 $2 \\times 2$ 实对称半正定（PSD）矩阵构成的锥，内积是弗罗贝尼乌斯内积，$\\langle Y, X \\rangle = \\mathrm{Tr}(Y X)$。矩阵 $X$ 是一个一般的 $2 \\times 2$ 实对称矩阵。\n\n由于 $X$ 是对称的，它具有谱分解 $X = U \\Lambda U^{\\top}$，其中 $U$ 是一个正交矩阵（$U^{\\top}U=I$），其列是 $X$ 的特征向量，$\\Lambda = \\mathrm{diag}(\\lambda_1, \\lambda_2)$ 是相应特征值构成的对角矩阵。\n\n利用迹的循环性质，目标函数可以重写为：\n$$\n\\mathrm{Tr}(YX) = \\mathrm{Tr}(Y U \\Lambda U^{\\top}) = \\mathrm{Tr}(U^{\\top} Y U \\Lambda)\n$$\n我们引入变量替换 $Y' = U^{\\top} Y U$。可行 $Y$ 的集合是 $\\{Y \\in S_+^2, \\mathrm{Tr}(Y)=1\\}$。我们来看看 $Y$ 的性质如何变换到 $Y'$：\n\\begin{enumerate}\n    \\item 对称性：$(Y')^{\\top} = (U^{\\top} Y U)^{\\top} = U^{\\top} Y^{\\top} U = U^{\\top} Y U = Y'$。所以 $Y'$ 是对称的。\n    \\item 半正定性：对于任意 $v \\in \\mathbb{R}^2$，$v^{\\top}Y'v = v^{\\top}U^{\\top}Y U v = (Uv)^{\\top}Y(Uv) \\ge 0$，因为 $Y \\in S_+^2$。所以 $Y' \\in S_+^2$。\n    \\item 迹：$\\mathrm{Tr}(Y') = \\mathrm{Tr}(U^{\\top} Y U) = \\mathrm{Tr}(Y U U^{\\top}) = \\mathrm{Tr}(Y)$。因此，$\\mathrm{Tr}(Y')=1$。\n\\end{enumerate}\n变换 $Y \\mapsto Y'$ 是从可行集到其自身的双射。因此，该优化问题等价于：\n$$\nw(X) = \\inf\\{\\mathrm{Tr}(Y' \\Lambda) \\mid Y' \\in S_{+}^{2}, \\ \\mathrm{Tr}(Y')=1\\}\n$$\n令 $Y' = \\begin{pmatrix} y'_{11}  y'_{12} \\\\ y'_{12}  y'_{22} \\end{pmatrix}$。目标函数是 $\\mathrm{Tr}(Y' \\Lambda) = \\lambda_1 y'_{11} + \\lambda_2 y'_{22}$。约束条件是 $Y' \\in S_+^2$（即 $y'_{11} \\ge 0, y'_{22} \\ge 0, y'_{11}y'_{22} \\ge (y'_{12})^2$）和 $\\mathrm{Tr}(Y') = y'_{11} + y'_{22}=1$。\n\n表达式 $\\lambda_1 y'_{11} + \\lambda_2 y'_{22}$ 是特征值 $\\lambda_1$ 和 $\\lambda_2$ 的凸组合，因为 $y'_{11}, y'_{22} \\ge 0$ 且它们的和为 1。为了最小化该表达式，我们应该将所有权重放在最小的特征值上。\n令 $\\lambda_{\\min}(X) = \\min\\{\\lambda_1, \\lambda_2\\}$。那么对于任何可行的 $Y'$，\n$$\n\\lambda_1 y'_{11} + \\lambda_2 y'_{22} \\ge \\lambda_{\\min}(X) y'_{11} + \\lambda_{\\min}(X) y'_{22} = \\lambda_{\\min}(X) (y'_{11} + y'_{22}) = \\lambda_{\\min}(X)\n$$\n这表明 $\\lambda_{\\min}(X)$ 是一个下界。这个界是可达到的。令 $u$ 为对应于 $\\lambda_{\\min}(X)$ 的单位特征向量。令 $Y = uu^{\\top}$。这个 $Y$ 属于 $S_+^2$ 并且有 $\\mathrm{Tr}(Y) = \\mathrm{Tr}(uu^{\\top}) = u^{\\top}u=1$，所以它是一个可行点。目标函数在该点的值为：\n$$\n\\mathrm{Tr}(YX) = \\mathrm{Tr}(uu^{\\top}X) = \\mathrm{Tr}(u^{\\top}Xu) = u^{\\top}Xu = u^{\\top}(\\lambda_{\\min}(X)u) = \\lambda_{\\min}(X)u^{\\top}u = \\lambda_{\\min}(X)\n$$\n因此，最小值确实是 $X$ 的最小特征值。$w(X)$ 的闭式表达式为：\n$$\nw(X) = \\lambda_{\\min}(X)\n$$\n我们需要为特定矩阵 $X = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$ 计算这个值。特征值 $\\lambda$ 是特征方程 $\\det(X - \\lambda I) = 0$ 的根：\n$$\n\\det\\begin{pmatrix} 1-\\lambda  1 \\\\ 1  -1-\\lambda \\end{pmatrix} = (1-\\lambda)(-1-\\lambda) - 1 \\cdot 1 = 0\n$$\n$$\n-(1-\\lambda)(1+\\lambda) - 1 = 0\n$$\n$$\n-(1-\\lambda^2) - 1 = 0\n$$\n$$\n\\lambda^2 - 1 - 1 = 0\n$$\n$$\n\\lambda^2 = 2\n$$\n特征值为 $\\lambda = \\sqrt{2}$ 和 $\\lambda = -\\sqrt{2}$。最小特征值为 $\\lambda_{\\min}(X) = -\\sqrt{2}$。\n因此，对于给定的 $X$，我们有：\n$$\nw(X) = -\\sqrt{2}\n$$\n问题要求将 $v(x)$ 和 $w(X)$ 这两个值放在一个单行矩阵中。这两个值是 $v(x) = -2$ 和 $w(X) = -\\sqrt{2}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -2  -\\sqrt{2} \\end{pmatrix}}\n$$"
        }
    ]
}