{
    "hands_on_practices": [
        {
            "introduction": "Understanding cones begins with building strong geometric intuition. This exercise challenges you to explore the relationship between a set of generating vectors and the resulting conic hull and its dual in the familiar two-dimensional plane. By analyzing how the shape of the cone and its dual evolve as the generating set—an arc on the unit circle—expands, you will gain a visual and conceptual grasp of fundamental properties that hold in higher dimensions as well .",
            "id": "3110923",
            "problem": "Consider the Euclidean plane $\\mathbb{R}^2$ and the unit circle $\\mathbb{S}^1 = \\{ x \\in \\mathbb{R}^2 : \\|x\\|_2 = 1 \\}$. Let $S \\subset \\mathbb{S}^1$ be an infinite set consisting of all unit vectors whose polar angle lies in the closed interval $[\\alpha,\\beta]$ (angles measured in radians), where the arc length $\\theta := \\beta - \\alpha$ is interpreted modulo $2\\pi$ so that $0  \\theta \\le 2\\pi$. Define the conic hull (also called the convex cone generated by $S$) by\n$$\n\\operatorname{cone}(S) := \\left\\{ \\sum_{i=1}^k \\lambda_i s_i \\;:\\; k \\in \\mathbb{N},\\; \\lambda_i \\ge 0,\\; s_i \\in S \\right\\},\n$$\nand its dual cone by\n$$\n\\operatorname{cone}(S)^* := \\left\\{ y \\in \\mathbb{R}^2 \\;:\\; y^\\top x \\ge 0 \\text{ for all } x \\in \\operatorname{cone}(S) \\right\\}.\n$$\nThe dual can also be viewed as an intersection of halfspaces\n$$\n\\operatorname{cone}(S)^* = \\bigcap_{s \\in S} \\{ y \\in \\mathbb{R}^2 \\;:\\; y^\\top s \\ge 0 \\}.\n$$\nLet $u := (\\cos \\alpha,\\sin \\alpha)$ and $v := (\\cos \\beta,\\sin \\beta)$ denote the endpoint directions of the arc. Select all statements that are correct.\n\nA. If $0\\theta\\pi$, then $\\operatorname{cone}(S)$ equals the closed wedge generated by $u$ and $v$, and $\\operatorname{cone}(S)^* = \\{ y \\in \\mathbb{R}^2 : y^\\top u \\ge 0,\\; y^\\top v \\ge 0 \\}$, the intersection of the $2$ halfspaces associated with the endpoints.\n\nB. If $\\theta=\\pi$, then $\\operatorname{cone}(S)=\\mathbb{R}^2$ and $\\operatorname{cone}(S)^*=\\{0\\}$.\n\nC. If $\\theta\\pi$, then $\\operatorname{cone}(S)=\\mathbb{R}^2$, hence $\\operatorname{cone}(S)^*=\\{0\\}$.\n\nD. For any $\\theta$, $\\operatorname{cone}(S)^*$ always equals a single halfspace of the form $\\{ y \\in \\mathbb{R}^2 : n^\\top y \\ge 0 \\}$ for some unit vector $n$.\n\nE. If $\\theta=\\pi$, then $\\operatorname{cone}(S)$ is a closed halfspace $\\{ x \\in \\mathbb{R}^2 : n^\\top x \\ge 0 \\}$ for a unique unit normal $n$, and $\\operatorname{cone}(S)^* = \\{ \\lambda n : \\lambda \\ge 0 \\}$ (a ray along $n$).",
            "solution": "The user wants me to act as a meticulous STEM professor to solve a problem about conic hulls and dual cones.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   The space is the Euclidean plane $\\mathbb{R}^2$.\n*   $\\mathbb{S}^1 = \\{ x \\in \\mathbb{R}^2 : \\|x\\|_2 = 1 \\}$ is the unit circle.\n*   $S \\subset \\mathbb{S}^1$ is an infinite set containing all unit vectors whose polar angle lies in the closed interval $[\\alpha,\\beta]$.\n*   The arc length is $\\theta := \\beta - \\alpha$, interpreted modulo $2\\pi$ such that $0  \\theta \\le 2\\pi$.\n*   The conic hull is defined as $\\operatorname{cone}(S) := \\left\\{ \\sum_{i=1}^k \\lambda_i s_i \\;:\\; k \\in \\mathbb{N},\\; \\lambda_i \\ge 0,\\; s_i \\in S \\right\\}$.\n*   The dual cone is defined as $\\operatorname{cone}(S)^* := \\left\\{ y \\in \\mathbb{R}^2 \\;:\\; y^\\top x \\ge 0 \\text{ for all } x \\in \\operatorname{cone}(S) \\right\\}$.\n*   An equivalent definition for the dual cone is given: $\\operatorname{cone}(S)^* = \\bigcap_{s \\in S} \\{ y \\in \\mathbb{R}^2 \\;:\\; y^\\top s \\ge 0 \\}$.\n*   The endpoint vectors are $u := (\\cos \\alpha,\\sin \\alpha)$ and $v := (\\cos \\beta,\\sin \\beta)$.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded**: The problem is based on standard, well-established definitions from convex analysis and geometry, specifically the concepts of conic hulls and dual cones. The mathematics is sound.\n2.  **Well-Posed**: The problem is well-defined. The set $S$ is a closed arc on the unit circle, and the quantities $\\operatorname{cone}(S)$ and $\\operatorname{cone}(S)^*$ are uniquely determined by $S$. The question asks for an evaluation of statements about these objects, which is a solvable mathematical task.\n3.  **Objective**: The language is precise and mathematical, free of ambiguity or subjective claims. The definitions provided are standard. The equivalence stated for the dual cone is a fundamental property: $y^\\top x \\ge 0$ for all $x \\in \\operatorname{cone}(S)$ if and only if $y^\\top s \\ge 0$ for all $s \\in S$, because any $x \\in \\operatorname{cone}(S)$ is a non-negative linear combination of elements of $S$.\n\nThe problem statement is formally correct and contains all necessary information. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. I will proceed to derive the solution.\n\n### Solution Derivation\n\nThe problem asks us to determine the structure of the conic hull $\\operatorname{cone}(S)$ and its dual $\\operatorname{cone}(S)^*$ based on the angular width $\\theta$ of the arc $S$. We analyze the problem by considering three cases for $\\theta$. A key property is that for any set $S$, $\\operatorname{cone}(S)$ is a closed convex cone, and $(\\operatorname{cone}(S)^*)^* = \\operatorname{cone}(S)$. The dual cone $\\operatorname{cone}(S)^*$ is the set of vectors $y$ that form a non-obtuse angle with every vector in $S$.\n\n**Case 1: $0  \\theta  \\pi$**\n\nIn this case, the arc $S$ spans an angle less than a semicircle. Let the endpoint vectors be $u$ and $v$.\nFirst, we determine $\\operatorname{cone}(S)$. Let $K = \\operatorname{cone}(\\{u,v\\}) = \\{ \\lambda_1 u + \\lambda_2 v : \\lambda_1 \\ge 0, \\lambda_2 \\ge 0 \\}$. This $K$ is the closed wedge between the rays generated by $u$ and $v$.\nSince $u, v \\in S$, any non-negative combination of $u$ and $v$ is also in $\\operatorname{cone}(S)$. Thus, $K \\subseteq \\operatorname{cone}(S)$.\nFor the converse, consider any vector $s \\in S$. Let its angle be $\\phi \\in [\\alpha, \\beta]$. Since $0  \\theta = \\beta - \\alpha  \\pi$, the vectors $u$ and $v$ are linearly independent and form a basis for $\\mathbb{R}^2$. Any $s$ can be written as $s = a u + b v$. Using Cramer's rule on the system $s = \\begin{pmatrix} u  v \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix}$, we find:\n$$ a = \\frac{\\det\\begin{pmatrix} s  v \\end{pmatrix}}{\\det\\begin{pmatrix} u  v \\end{pmatrix}} = \\frac{\\sin(\\beta-\\phi)}{\\sin(\\beta-\\alpha)} = \\frac{\\sin(\\beta-\\phi)}{\\sin\\theta} $$\n$$ b = \\frac{\\det\\begin{pmatrix} u  s \\end{pmatrix}}{\\det\\begin{pmatrix} u  v \\end{pmatrix}} = \\frac{\\sin(\\phi-\\alpha)}{\\sin(\\beta-\\alpha)} = \\frac{\\sin(\\phi-\\alpha)}{\\sin\\theta} $$\nSince $\\phi \\in [\\alpha, \\beta]$, we have $\\phi-\\alpha \\in [0, \\theta]$ and $\\beta-\\phi \\in [0, \\theta]$. As $0  \\theta  \\pi$, the sines of these angles are non-negative. Therefore, $a \\ge 0$ and $b \\ge 0$.\nThis shows that every $s \\in S$ is in $K$. Since $K$ is a convex cone, any non-negative linear combination of elements of $S$ will also be in $K$. Hence, $\\operatorname{cone}(S) \\subseteq K$.\nCombining both inclusions, we have $\\operatorname{cone}(S) = K = \\operatorname{cone}(\\{u,v\\})$.\n\nNow, we determine the dual cone, $\\operatorname{cone}(S)^* = (\\operatorname{cone}(\\{u,v\\}))^*$. A vector $y$ belongs to this dual cone if and only if $y^\\top x \\ge 0$ for all $x \\in \\operatorname{cone}(\\{u,v\\})$. This is equivalent to the conditions $y^\\top u \\ge 0$ and $y^\\top v \\ge 0$. Thus,\n$$ \\operatorname{cone}(S)^* = \\{ y \\in \\mathbb{R}^2 : y^\\top u \\ge 0 \\} \\cap \\{ y \\in \\mathbb{R}^2 : y^\\top v \\ge 0 \\} $$\nThis is the intersection of the two closed halfspaces defined by $u$ and $v$. Geometrically, this is a wedge-shaped cone.\n\n**Option A Evaluation**: \"If $0\\theta\\pi$, then $\\operatorname{cone}(S)$ equals the closed wedge generated by $u$ and $v$, and $\\operatorname{cone}(S)^* = \\{ y \\in \\mathbb{R}^2 : y^\\top u \\ge 0,\\; y^\\top v \\ge 0 \\}$, the intersection of the $2$ halfspaces associated with the endpoints.\" This statement perfectly matches our derivation.\n**Verdict for A: Correct**\n\n**Case 2: $\\theta = \\pi$**\n\nIn this case, the arc $S$ is a closed semicircle. The endpoint vectors are antipodal, so $v = -u$.\nLet's determine $\\operatorname{cone}(S)$. Let $n$ be the unit vector pointing to the midpoint of the arc $S$. For any vector $s \\in S$, the angle between $s$ and $n$ is in $[-\\pi/2, \\pi/2]$, so $n^\\top s \\ge 0$. For any $x = \\sum \\lambda_i s_i \\in \\operatorname{cone}(S)$ with $\\lambda_i \\ge 0$, we have $n^\\top x = \\sum \\lambda_i (n^\\top s_i) \\ge 0$. This shows that $\\operatorname{cone}(S)$ is contained in the closed halfspace $H = \\{ x \\in \\mathbb{R}^2 : n^\\top x \\ge 0 \\}$.\nConversely, any vector $x \\in H$ can be expressed as a non-negative linear combination of vectors in $S$. The set of directions of vectors in $S$ covers a continuous range of $\\pi$ radians. Any direction in the halfspace $H$ can be formed by a positive combination of two directions from $S$. Thus, $\\operatorname{cone}(S)$ is the entire closed halfspace $H$. The unit normal $n$ is uniquely determined as the direction of the midpoint of the arc.\n\nNow, let's find the dual cone, $\\operatorname{cone}(S)^* = H^* = \\{ y \\in \\mathbb{R}^2 : y^\\top x \\ge 0 \\text{ for all } x \\in H \\}$.\nLet $y \\in H^*$. For any vector $z$ such that $n^\\top z = 0$, both $z$ and $-z$ are in $H$. So we must have $y^\\top z \\ge 0$ and $y^\\top (-z) \\ge 0$, which implies $y^\\top z = 0$. This means $y$ must be orthogonal to any vector orthogonal to $n$. In $\\mathbb{R}^2$, this implies $y$ must be collinear with $n$, so $y = \\lambda n$ for some scalar $\\lambda$.\nFurthermore, $n \\in H$, so we must have $y^\\top n \\ge 0$. Substituting $y=\\lambda n$, we get $(\\lambda n)^\\top n = \\lambda \\|n\\|^2 = \\lambda \\ge 0$.\nSo, $H^*$ consists of all non-negative multiples of $n$.\n$$ \\operatorname{cone}(S)^* = \\{ \\lambda n : \\lambda \\ge 0 \\} $$\nThis is a ray originating from the origin in the direction of $n$.\n\n**Option B Evaluation**: \"If $\\theta=\\pi$, then $\\operatorname{cone}(S)=\\mathbb{R}^2$ and $\\operatorname{cone}(S)^*=\\{0\\}$.\" This is incorrect. As shown, $\\operatorname{cone}(S)$ is a halfspace and its dual is a ray.\n**Verdict for B: Incorrect**\n\n**Option E Evaluation**: \"If $\\theta=\\pi$, then $\\operatorname{cone}(S)$ is a closed halfspace $\\{ x \\in \\mathbb{R}^2 : n^\\top x \\ge 0 \\}$ for a unique unit normal $n$, and $\\operatorname{cone}(S)^* = \\{ \\lambda n : \\lambda \\ge 0 \\}$ (a ray along $n$).\" This statement perfectly matches our derivation.\n**Verdict for E: Correct**\n\n**Case 3: $\\pi  \\theta \\le 2\\pi$**\n\nIn this case, the arc $S$ spans an angle greater than a semicircle.\nA fundamental result in convex geometry states that $\\operatorname{cone}(C) = \\mathbb{R}^d$ if and only if the origin $0$ is in the interior of the convex hull of $C$, $\\operatorname{conv}(C)$.\nHere, $S$ is an arc of length $\\theta  \\pi$. The convex hull $\\operatorname{conv}(S)$ is the segment of the unit disk bounded by this arc and the chord connecting its endpoints. Since the arc is longer than a semicircle, the origin $0$ is an interior point of $\\operatorname{conv}(S)$. Therefore, $\\operatorname{cone}(S) = \\mathbb{R}^2$.\nAlternatively, since $\\theta  \\pi$, for any vector $s_1 \\in S$, the vector $-s_1$ lies in the open sector spanned by the rest of the arc. This means we can find $s_2, s_3 \\in S$ such that $-s_1$ is a positive linear combination of $s_2$ and $s_3$. So $-s_1 \\in \\operatorname{cone}(S)$. Since $s_1 \\in \\operatorname{cone}(S)$ and $-s_1 \\in \\operatorname{cone}(S)$, the cone is not pointed. For a closed convex cone in $\\mathbb{R}^2$, not being pointed implies it is the entire space. So $\\operatorname{cone}(S) = \\mathbb{R}^2$.\n\nThe dual cone is $(\\mathbb{R}^2)^* = \\{ y \\in \\mathbb{R}^2 : y^\\top x \\ge 0 \\text{ for all } x \\in \\mathbb{R}^2 \\}$.\nIf we take any non-zero vector $y \\in \\mathbb{R}^2$, we can choose $x = -y$. Then $x \\in \\mathbb{R}^2$, but $y^\\top x = y^\\top(-y) = -\\|y\\|_2^2  0$. This violates the condition. The only vector $y$ for which this is not possible is $y=0$, for which $0^\\top x = 0$ for all $x$.\nThus, $\\operatorname{cone}(S)^* = \\{0\\}$.\n\n**Option C Evaluation**: \"If $\\theta\\pi$, then $\\operatorname{cone}(S)=\\mathbb{R}^2$, hence $\\operatorname{cone}(S)^*=\\{0\\}$.\" This statement perfectly matches our derivation.\n**Verdict for C: Correct**\n\n**Evaluation of the General Statement**\n\n**Option D Evaluation**: \"For any $\\theta$, $\\operatorname{cone}(S)^*$ always equals a single halfspace of the form $\\{ y \\in \\mathbb{R}^2 : n^\\top y \\ge 0 \\}$ for some unit vector $n$.\"\nThis statement claims that the dual cone is always a halfspace. Let's review our findings:\n*   For $0  \\theta  \\pi$, $\\operatorname{cone}(S)^*$ is a wedge (intersection of two halfspaces), which is not a halfspace unless the angle between $u$ and $v$ is $0$, i.e., $\\theta=0$, which is excluded.\n*   For $\\theta = \\pi$, $\\operatorname{cone}(S)^*$ is a ray, not a halfspace.\n*   For $\\pi  \\theta \\le 2\\pi$, $\\operatorname{cone}(S)^*$ is the origin $\\{0\\}$, not a halfspace.\nThe dual cone $\\operatorname{cone}(S)^*$ is a halfspace if and only if $\\operatorname{cone}(S)$ is a ray. This would require $S$ to be a single point, i.e., $\\theta=0$. The problem states $0  \\theta \\le 2\\pi$. Thus, the statement is incorrect.\n**Verdict for D: Incorrect**\n\n**Summary of Correct Statements:**\nA, C, and E are the correct statements.",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "After developing a geometric picture of cones, the next step is to test these concepts algorithmically. This practice guides you through designing a computational method to determine if a vector lies within a finitely generated conic hull, translating the abstract definition into a concrete linear programming feasibility problem . Furthermore, you will explore the powerful concept of duality by finding a separating hyperplane, which serves as an undeniable mathematical certificate when a vector is not in the cone.",
            "id": "3110862",
            "problem": "You are given a finite family of rays in a real vector space, represented by vectors $\\{r_i\\}_{i=1}^m \\subset \\mathbb{R}^n$. The conic hull (also called the finitely generated cone) of these rays is defined from first principles as the set\n$$\n\\operatorname{cone}(\\{r_i\\}_{i=1}^m) \\;=\\; \\left\\{ \\sum_{i=1}^m \\lambda_i r_i \\;:\\; \\lambda_i \\in \\mathbb{R}_{\\ge 0} \\right\\}.\n$$\nGiven a target vector $y \\in \\mathbb{R}^n$, your task is to decide algorithmically whether $y \\in \\operatorname{cone}(\\{r_i\\})$, and to interpret a dual certificate when $y \\notin \\operatorname{cone}(\\{r_i\\})$.\n\nFundamental base and requirements:\n- Use the core definition of a conic hull and the standard linear programming feasibility viewpoint: membership $y \\in \\operatorname{cone}(\\{r_i\\})$ is equivalent to the existence of nonnegative coefficients $\\lambda \\in \\mathbb{R}^m_{\\ge 0}$ satisfying the linear equality $\\sum_{i=1}^m \\lambda_i r_i = y$.\n- Frame this as a linear program with decision variables $\\lambda \\in \\mathbb{R}^m$: minimize $0$ subject to $R \\lambda = y$, $\\lambda \\ge 0$, where $R \\in \\mathbb{R}^{n \\times m}$ has columns $r_1, \\dots, r_m$.\n- If the above problem is infeasible, use a dual-separation viewpoint grounded in the Separating Hyperplane Theorem or Farkas' Lemma to find a separating vector $w \\in \\mathbb{R}^n$ satisfying $w^\\top r_i \\ge 0$ for all $i$ and $w^\\top y  0$. To obtain a concrete certificate via linear programming, solve a feasibility linear program in $w$:\n  - Find $w \\in \\mathbb{R}^n$ such that $R^\\top w \\le 0$ and $y^\\top w \\ge 1$; then set $w_{\\mathrm{sep}} := -w$. This ensures $w_{\\mathrm{sep}}^\\top r_i \\ge 0$ for all $i$ and $w_{\\mathrm{sep}}^\\top y \\le -1  0$, which is a strict separating hyperplane certificate.\n\nYour program must implement this approach using linear programming and produce the following for each test case:\n- A boolean indicating whether $y \\in \\operatorname{cone}(\\{r_i\\})$.\n- If the answer is true, provide one feasible vector of coefficients $\\lambda \\in \\mathbb{R}^m_{\\ge 0}$ and also report the Euclidean residual norm $\\lVert R \\lambda - y \\rVert_2$.\n- If the answer is false, provide one separating vector $w_{\\mathrm{sep}} \\in \\mathbb{R}^n$ and also report the minimum margin over generators $\\min_i \\{ w_{\\mathrm{sep}}^\\top r_i \\}$ and the value $w_{\\mathrm{sep}}^\\top y$.\n\nTest suite:\nWork in $\\mathbb{R}^2$ and use the following five test cases. Each case consists of a list of rays and a target vector $y$.\n1. Rays $\\{(1,0), (0,1)\\}$, target $y = (1,2)$.\n2. Rays $\\{(1,0), (0,1)\\}$, target $y = (-1,1)$.\n3. Rays $\\{(1,0), (0,1)\\}$, target $y = (0,0)$.\n4. Rays $\\{(1,1), (1,-1)\\}$, target $y = (2,0)$.\n5. Rays $\\{(1,1), (1,-1)\\}$, target $y = (1,1.2)$.\n\nAll vectors should be interpreted as elements of $\\mathbb{R}^2$ with no physical units. Angles do not appear, and percentages are not used.\n\nProgram output specification:\n- For each test case, output a list with the following structure:\n  - Case result format: $[\\text{is\\_member}, \\lambda\\_\\text{list}, w\\_\\text{sep\\_list}, \\text{verification\\_list}]$,\n    - If $\\text{is\\_member}$ is true, then $\\lambda\\_\\text{list}$ is a list of the coefficients $\\lambda_i$, $w\\_\\text{sep\\_list}$ is the empty list, and $\\text{verification\\_list}$ contains a single float equal to $\\lVert R \\lambda - y \\rVert_2$.\n    - If $\\text{is\\_member}$ is false, then $\\lambda\\_\\text{list}$ is the empty list, $w\\_\\text{sep\\_list}$ is one separating vector $w_{\\mathrm{sep}}$, and $\\text{verification\\_list}$ contains two floats: $\\min_i \\{ w_{\\mathrm{sep}}^\\top r_i \\}$ and $w_{\\mathrm{sep}}^\\top y$.\n- Your program should produce a single line of output containing the results for all five cases as a comma-separated list enclosed in square brackets. Concretely, the output must be a single line in the form:\n  $$\n  [\\text{case1\\_result},\\text{case2\\_result},\\text{case3\\_result},\\text{case4\\_result},\\text{case5\\_result}]\n  $$\nwhere each $\\text{caseX\\_result}$ is itself a list as specified above.\n\nDesign for coverage and edge cases:\n- Case 1 is a typical membership instance.\n- Case 2 is a typical non-membership instance with a clear axis-aligned separator.\n- Case 3 is a boundary case ($y = 0$).\n- Case 4 is membership in a non-orthant cone.\n- Case 5 is non-membership in a non-orthant cone with a nontrivial separating hyperplane.\n\nYour solution must rely only on fundamental definitions of conic hulls and the feasibility of linear equalities with nonnegativity constraints, and must obtain certificates using linear programming. No external inputs are allowed; all data are hard-coded as above. The final numerical outputs should be rounded to a reasonable number of decimal places to ensure readability while preserving correctness of signs and zero-versus-nonzero distinctions.",
            "solution": "The problem requires an algorithmic procedure to determine if a given vector $y \\in \\mathbb{R}^n$ lies within the conic hull of a finite set of vectors $\\{r_i\\}_{i=1}^m \\subset \\mathbb{R}^n$. The conic hull, denoted $\\operatorname{cone}(\\{r_i\\})$, is the set of all non-negative linear combinations of the generating vectors:\n$$\n\\operatorname{cone}(\\{r_i\\}_{i=1}^m) \\;=\\; \\left\\{ \\sum_{i=1}^m \\lambda_i r_i \\;:\\; \\lambda_i \\in \\mathbb{R}_{\\ge 0} \\right\\}\n$$\nA vector $y$ is in this cone if and only if there exist coefficients $\\lambda = (\\lambda_1, \\dots, \\lambda_m)^\\top$ such that:\n$$\n\\sum_{i=1}^m \\lambda_i r_i = y, \\quad \\text{with } \\lambda_i \\ge 0 \\text{ for all } i=1, \\dots, m\n$$\nThis can be expressed in matrix form as $R\\lambda = y$, where $R \\in \\mathbb{R}^{n \\times m}$ is the matrix whose columns are the vectors $r_i$. The condition for membership is thus the existence of a solution to a system of linear equations with non-negativity constraints on the variables.\n\nThis feasibility problem can be formulated as a linear program (LP). Specifically, we seek to find a vector $\\lambda \\in \\mathbb{R}^m$ that satisfies the constraints, where the choice of objective function is immaterial for a feasibility problem. A standard choice is to minimize a zero objective function, $c^\\top \\lambda = 0^\\top \\lambda = 0$:\n\n**Primal LP (Membership Problem):**\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  0 \\\\\n\\text{subject to} \\quad  R \\lambda = y \\\\\n \\lambda \\ge 0\n\\end{aligned}\n$$\nIf this LP has a feasible solution, then such a $\\lambda$ exists, and $y \\in \\operatorname{cone}(\\{r_i\\})$. The vector $\\lambda$ itself serves as a certificate of membership. The quality of this certificate can be checked by computing the Euclidean residual norm, $\\lVert R \\lambda - y \\rVert_2$, which should be nearly zero for a numerically accurate solution.\n\nIf the primal LP is infeasible, then no such non-negative $\\lambda$ exists, and $y \\notin \\operatorname{cone}(\\{r_i\\})$. By the principles of duality in linear programming, specifically Farkas' Lemma (a theorem of the alternative), the infeasibility of the primal system implies the feasibility of a related dual system. This leads to the concept of a separating hyperplane. A hyperplane defined by a normal vector $w_{\\mathrm{sep}} \\in \\mathbb{R}^n$ separates $y$ from the cone if $w_{\\mathrm{sep}}^\\top y  0$ and $w_{\\mathrm{sep}}^\\top z \\ge 0$ for all $z \\in \\operatorname{cone}(\\{r_i\\})$. For the latter condition to hold, it is sufficient that $w_{\\mathrm{sep}}^\\top r_i \\ge 0$ for all generating vectors $r_i$.\n\nThe problem statement provides a specific LP formulation to find such a separating vector. We seek an intermediate vector $w \\in \\mathbb{R}^n$ that satisfies a set of inequalities, from which $w_{\\mathrm{sep}}$ is derived.\n\n**Separation LP (Non-Membership Certificate):**\n$$\n\\begin{aligned}\n\\text{find} \\quad  w \\in \\mathbb{R}^n \\\\\n\\text{subject to} \\quad  R^\\top w \\le 0 \\\\\n y^\\top w \\ge 1\n\\end{aligned}\n$$\nThis is also a feasibility LP. We can rewrite the constraint $y^\\top w \\ge 1$ as $(-y)^\\top w \\le -1$ to fit the standard form $A_w w \\le b_w$. If a solution $w$ to this system exists, we define the separating vector as $w_{\\mathrm{sep}} := -w$. Let us verify that this $w_{\\mathrm{sep}}$ has the desired properties:\n$1$. For each generator $r_i$, the constraint is $r_i^\\top w \\le 0$. Then $w_{\\mathrm{sep}}^\\top r_i = (-w)^\\top r_i = -(w^\\top r_i) \\ge 0$. This confirms that $w_{\\mathrm{sep}}$ forms a non-negative inner product with all generators, and thus with all vectors in the cone.\n$2$. The constraint $y^\\top w \\ge 1$ implies $w_{\\mathrm{sep}}^\\top y = (-w)^\\top y = -(y^\\top w) \\le -1$. This is a strictly negative value, confirming that $y$ is on the opposite side of the hyperplane from the cone.\n\nThe overall algorithm is as follows:\n$1$. Formulate and attempt to solve the primal LP for the coefficients $\\lambda$.\n$2$. If the primal LP is feasible (successful), conclude that $y$ is in the cone. The solution vector $\\lambda$ is the membership certificate.\n$3$. If the primal LP is infeasible, conclude that $y$ is not in the cone. Formulate and solve the separation LP for the vector $w$. The derived vector $w_{\\mathrm{sep}} = -w$ is the non-membership certificate.\n\nThis procedure will be implemented for each test case using a numerical linear programming solver.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_case(rays, y):\n    \"\"\"\n    Determines if a vector y is in the conic hull of a set of rays.\n\n    Args:\n        rays (list of tuples): A list of vectors representing the rays.\n        y (np.ndarray): The target vector.\n\n    Returns:\n        list: A result list in the format specified by the problem.\n    \"\"\"\n    R = np.array(rays).T\n    if R.ndim == 1: # Handle case of a single ray (1D vector)\n        R = R.reshape(-1, 1)\n        \n    n_dim, m_rays = R.shape\n\n    # --- Primal LP (Membership Test) ---\n    # Try to find lambda = 0 such that R @ lambda = y.\n    # min 0 subject to R @ lambda = y, lambda = 0\n    c_primal = np.zeros(m_rays)\n    # The bounds argument enforces lambda = 0 by default when set to (0, None).\n    res_primal = linprog(\n        c=c_primal,\n        A_eq=R,\n        b_eq=y,\n        bounds=(0, None),\n        method='highs'\n    )\n\n    if res_primal.success:\n        # y is in the cone.\n        lambda_coeffs = res_primal.x\n        residual = np.linalg.norm(R @ lambda_coeffs - y)\n        return [\n            True,\n            list(np.round(lambda_coeffs, 5)),\n            [],\n            [round(residual, 5)]\n        ]\n    else:\n        # y is not in the cone. Find a separating hyperplane.\n        # --- Separation LP (Non-Membership Certificate) ---\n        # Find w such that R.T @ w = 0 and y.T @ w = 1.\n        # We rewrite y.T @ w = 1 as -y.T @ w = -1.\n        # This is equivalent to min 0 subject to A_ub @ w = b_ub.\n        c_dual = np.zeros(n_dim)\n        \n        # A_ub has shape (m_rays + 1, n_dim)\n        A_ub_dual = np.vstack([R.T, -y.reshape(1, -1)])\n        \n        # b_ub has shape (m_rays + 1,)\n        b_ub_dual = np.zeros(m_rays + 1)\n        b_ub_dual[-1] = -1.0\n        \n        res_dual = linprog(\n            c=c_dual,\n            A_ub=A_ub_dual,\n            b_ub=b_ub_dual,\n            bounds=(None, None), # w is unbounded\n            method='highs'\n        )\n\n        if res_dual.success:\n            w = res_dual.x\n            w_sep = -w\n            \n            # verification_list: [min_margin, w_sep_dot_y]\n            min_margin = np.min(w_sep @ R)\n            w_sep_dot_y = w_sep @ y\n            \n            return [\n                False,\n                [],\n                list(np.round(w_sep, 5)),\n                [round(min_margin, 5), round(w_sep_dot_y, 5)]\n            ]\n        else:\n            # According to Farkas' Lemma, this case should not be reached\n            # if the primal is infeasible. This indicates a numerical issue.\n            return [\"Error: Both primal and dual LPs are infeasible.\"]\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # 1. Rays {(1,0), (0,1)}, target y = (1,2) - In cone\n        ([(1, 0), (0, 1)], (1, 2)),\n        # 2. Rays {(1,0), (0,1)}, target y = (-1,1) - Not in cone\n        ([(1, 0), (0, 1)], (-1, 1)),\n        # 3. Rays {(1,0), (0,1)}, target y = (0,0) - In cone (boundary)\n        ([(1, 0), (0, 1)], (0, 0)),\n        # 4. Rays {(1,1), (1,-1)}, target y = (2,0) - In cone\n        ([(1, 1), (1, -1)], (2, 0)),\n        # 5. Rays {(1,1), (1,-1)}, target y = (1,1.2) - Not in cone\n        ([(1, 1), (1, -1)], (1, 1.2)),\n    ]\n\n    results = []\n    for rays, y in test_cases:\n        y_vec = np.array(y)\n        result = solve_case(rays, y_vec)\n        # The string representation of a Python list matches the required output format for a single case.\n        results.append(str(result))\n\n    # Join the string representations of each case result with commas and enclose in brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Cones are not just geometric objects; they are the building blocks for powerful classes of optimization problems. This final practice moves from membership checking to the heart of conic optimization, asking you to derive the dual of a conic program from first principles . By constructing and comparing dual problems for both a standard linear program (using the non-negative orthant) and a second-order cone program, you will see firsthand how the geometry of the cone dictates the structure of the dual and the nature of the solution.",
            "id": "3110866",
            "problem": "Consider the conic optimization template with a cone constraint. Let the decision vector be $x \\in \\mathbb{R}^{3}$, the cost vector be $c \\in \\mathbb{R}^{3}$, and the linear constraint be $A x = b$ with $A \\in \\mathbb{R}^{1 \\times 3}$ and $b \\in \\mathbb{R}$. Work from first principles, beginning with the definitions of a cone, its dual cone, and the Lagrangian of a constrained optimization problem. Do not use any pre-stated duality formulas; instead, derive the dual problem by eliminating primal variables through the infimum over the Lagrangian.\n\nUse the following specific data: let $A = \\begin{bmatrix} 1  1  1 \\end{bmatrix}$, $b = 1$, and $c = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$. Consider two instances distinguished only by the cone $K$.\n\n1) First, take $K = \\mathbb{R}^{3}_{+}$. Construct the corresponding primal problem, derive its dual problem using the definition of the dual cone $K^{\\ast}$ and the Lagrangian, and solve for the optimal value. Interpret the geometry of the dual feasibility region in terms of basic geometric objects.\n\n2) Next, replace $K$ with the $3$-dimensional second-order cone $Q_{3} = \\{ (t,u_{1},u_{2}) \\in \\mathbb{R}^{3} \\mid t \\geq \\sqrt{u_{1}^{2} + u_{2}^{2}} \\}$. Construct the corresponding primal problem, derive its dual problem by the same first-principles route, and solve for the optimal value. Compare the geometry of the dual feasibility constraint you obtain here with that in part 1) in terms of how the feasible set is shaped.\n\nFinally, let $v_{+}$ denote the optimal objective value when $K = \\mathbb{R}^{3}_{+}$ and $v_{Q}$ denote the optimal objective value when $K = Q_{3}$. Report the exact value of $v_{Q} - v_{+}$. No rounding is required, and no units are involved. Your final answer must be a single closed-form expression.",
            "solution": "This problem asks for the derivation and solution of two conic optimization problems, differing only in the choice of the cone $K$. The final goal is to compute the difference between their optimal objective values. We will proceed from first principles as requested.\n\nA cone $K \\subseteq \\mathbb{R}^{n}$ is a set that is closed under non-negative scalar multiplication, i.e., for any $x \\in K$ and any $\\alpha \\geq 0$, it holds that $\\alpha x \\in K$.\nThe dual cone $K^{\\ast}$ of a cone $K$ is defined as $K^{\\ast} = \\{y \\in \\mathbb{R}^{n} \\mid y^{T}x \\geq 0 \\text{ for all } x \\in K\\}$.\n\nThe general form of the primal conic optimization problem is:\n$$\n\\begin{array}{ll}\n\\text{minimize}  c^{T}x \\\\\n\\text{subject to}  Ax = b \\\\\n x \\in K\n\\end{array}\n$$\nwhere $x \\in \\mathbb{R}^{n}$ is the decision vector, $c \\in \\mathbb{R}^{n}$ is the cost vector, $A \\in \\mathbb{R}^{m \\times n}$ and $b \\in \\mathbb{R}^{m}$ define the linear equality constraints, and $K$ is a closed convex cone.\n\nTo derive the dual problem, we form the Lagrangian by associating a dual variable $\\nu \\in \\mathbb{R}^{m}$ with the equality constraint $Ax=b$:\n$$L(x, \\nu) = c^{T}x + \\nu^{T}(Ax - b) = (c + A^{T}\\nu)^{T}x - b^{T}\\nu$$\nThe dual function $g(\\nu)$ is the infimum of the Lagrangian over the primal variable $x$, subject to the remaining constraint $x \\in K$:\n$$g(\\nu) = \\inf_{x \\in K} L(x, \\nu) = \\inf_{x \\in K} \\left\\{ (c + A^{T}\\nu)^{T}x \\right\\} - b^{T}\\nu$$\nThe value of the infimum depends on whether the vector $s = c + A^{T}\\nu$ lies in the dual cone $K^{\\ast}$.\nIf $s \\in K^{\\ast}$, then by definition, $s^{T}x \\geq 0$ for all $x \\in K$. Since $0 \\in K$ (as $K$ is a cone), the infimum is achieved at $x=0$, and its value is $0$.\nIf $s \\notin K^{\\ast}$, there exists some $x_{0} \\in K$ such that $s^{T}x_{0}  0$. Since $K$ is a cone, $\\alpha x_{0} \\in K$ for any $\\alpha  0$. Then $s^{T}(\\alpha x_{0}) = \\alpha (s^{T}x_{0}) \\to -\\infty$ as $\\alpha \\to \\infty$. So the infimum is $-\\infty$.\nTherefore, the dual function is:\n$$\ng(\\nu) = \\begin{cases}\n-b^{T}\\nu  \\text{if } c + A^{T}\\nu \\in K^{\\ast} \\\\\n-\\infty  \\text{otherwise}\n\\end{cases}\n$$\nThe dual problem is to maximize the dual function $g(\\nu)$:\n$$\n\\begin{array}{ll}\n\\text{maximize}  -b^{T}\\nu \\\\\n\\text{subject to}  c + A^{T}\\nu \\in K^{\\ast}\n\\end{array}\n$$\nIn this specific problem, we have $n=3$ and $m=1$. The data are $c = \\begin{bmatrix} 1  0  0 \\end{bmatrix}^{T}$, $A = \\begin{bmatrix} 1  1  1 \\end{bmatrix}$, and $b=1$. The dual variable $\\nu$ is a scalar. The dual problem becomes:\n$$\n\\begin{array}{ll}\n\\text{maximize}  -\\nu \\\\\n\\text{subject to}  \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\end{bmatrix}\\nu \\in K^{\\ast}\n\\end{array}\n$$\n\n**1) Case 1: The non-negative orthant, $K = \\mathbb{R}^{3}_{+}$**\n\nFirst, we determine the dual cone $K^{\\ast} = (\\mathbb{R}^{3}_{+})^{\\ast}$. A vector $y = (y_1, y_2, y_3)^{T}$ is in $(\\mathbb{R}^{3}_{+})^{\\ast}$ if and only if $y^{T}x = y_1x_1 + y_2x_2 + y_3x_3 \\geq 0$ for all $x = (x_1, x_2, x_3)^{T}$ with $x_i \\geq 0$. By choosing $x = e_i$ (the standard basis vectors), which are in $\\mathbb{R}^{3}_{+}$, we find that we must have $y_i \\geq 0$ for $i=1,2,3$. This means $y \\in \\mathbb{R}^{3}_{+}$. Conversely, if $y \\in \\mathbb{R}^{3}_{+}$, then $y^{T}x \\geq 0$ for all $x \\in \\mathbb{R}^{3}_{+}$. Thus, $\\mathbb{R}^{3}_{+}$ is self-dual: $(\\mathbb{R}^{3}_{+})^{\\ast} = \\mathbb{R}^{3}_{+}$.\n\nThe primal problem $(P_{+})$ is:\n$$\n\\begin{array}{ll}\n\\text{minimize}  x_1 \\\\\n\\text{subject to}  x_1+x_2+x_3 = 1 \\\\\n x_1 \\geq 0, x_2 \\geq 0, x_3 \\geq 0\n\\end{array}\n$$\nTo minimize $x_1$ subject to the constraints, we should choose the smallest possible non-negative value for $x_1$, which is $x_1=0$. This is feasible; for instance, $x=(0, 1, 0)^{T}$ satisfies $0+1+0=1$ and all components are non-negative. The optimal objective value is $v_{+} = 0$.\n\nThe dual problem $(D_{+})$ is:\n$$\n\\begin{array}{ll}\n\\text{maximize}  -\\nu \\\\\n\\text{subject to}  \\begin{bmatrix} 1 + \\nu \\\\ \\nu \\\\ \\nu \\end{bmatrix} \\in \\mathbb{R}^{3}_{+}\n\\end{array}\n$$\nThe constraints are $1+\\nu \\geq 0$, $\\nu \\geq 0$, and $\\nu \\geq 0$. These simplify to $\\nu \\geq 0$. We want to maximize $-\\nu$ subject to $\\nu \\geq 0$. The maximum is achieved at the smallest possible value of $\\nu$, which is $\\nu=0$. The optimal dual value is $-0 = 0$, which matches the primal optimal value.\n\nThe dual feasibility region for $\\nu$ is the set $\\{\\nu \\in \\mathbb{R} \\mid \\nu \\geq 0\\}$, which is a closed, unbounded interval (a ray).\n\n**2) Case 2: The second-order cone, $K = Q_{3}$**\n\nLet $x=(x_1, x_2, x_3)^{T}$. The cone is $Q_{3} = \\{ x \\in \\mathbb{R}^{3} \\mid x_1 \\geq \\sqrt{x_2^2 + x_3^2} \\}$.\nThe second-order cone is also self-dual: $(Q_{3})^{\\ast} = Q_{3}$. To show this, consider $y \\in (Q_3)^*$. Then $y^T x \\ge 0$ for all $x \\in Q_3$. Let $x = (x_1, x_v)$ where $x_v=(x_2,x_3)$. The condition is $x_1 \\ge \\|x_v\\|_2$. We need $y_1 x_1 + y_v^T x_v \\ge 0$. This must hold for all $x_1 \\ge \\|x_v\\|_2$. To minimize the expression for a given $x_v$, we choose $x_1 = \\|x_v\\|_2$. So we need $y_1 \\|x_v\\|_2 + y_v^T x_v \\ge 0$ for all $x_v$. By Cauchy-Schwarz inequality, $y_v^T x_v \\ge -\\|y_v\\|_2 \\|x_v\\|_2$. Thus $y_1 \\|x_v\\|_2 + y_v^T x_v \\ge (y_1 - \\|y_v\\|_2)\\|x_v\\|_2$. For this to be non-negative for all $x_v$, we must have $y_1 - \\|y_v\\|_2 \\ge 0$, which is $y_1 \\ge \\sqrt{y_2^2+y_3^2}$. This is precisely the condition for $y \\in Q_3$.\n\nThe primal problem $(P_{Q})$ is:\n$$\n\\begin{array}{ll}\n\\text{minimize}  x_1 \\\\\n\\text{subject to}  x_1+x_2+x_3 = 1 \\\\\n x_1 \\geq \\sqrt{x_2^2 + x_3^2}\n\\end{array}\n$$\nFrom the equality constraint, $x_1 = 1 - x_2 - x_3$. Substituting into the cone constraint: $1-x_2-x_3 \\geq \\sqrt{x_2^2+x_3^2}$. Minimizing $x_1$ is equivalent to maximizing $x_2+x_3$.\nThe constraint requires $1-x_2-x_3 \\geq 0$, so we can square both sides: $(1-(x_2+x_3))^2 \\geq x_2^2+x_3^2$, which simplifies to $1-2(x_2+x_3)+2x_2x_3 \\geq 0$. We can rewrite this as $2(x_2-1)(x_3-1) \\geq 1$.\nThe problem reduces to maximizing $S=x_2+x_3$ subject to $(x_2-1)(x_3-1) \\geq \\frac{1}{2}$ and $x_2+x_3 \\leq 1$. The maximum of a symmetric linear function over a region with symmetric boundary occurs at a point where $x_2=x_3$. Substituting $x_2=x_3$ into the boundary condition $(x_2-1)(x_3-1) = \\frac{1}{2}$ gives $(x_2-1)^2 = \\frac{1}{2}$, so $x_2-1 = \\pm \\frac{1}{\\sqrt{2}}$. Since $x_2+x_3 \\leq 1$ implies $2x_2 \\leq 1$ or $x_2 \\leq 1/2$, we must choose the negative root: $x_2 = 1 - \\frac{1}{\\sqrt{2}}$. Then $x_3 = 1 - \\frac{1}{\\sqrt{2}}$.\nThe maximum value of $x_2+x_3$ is $(1 - \\frac{1}{\\sqrt{2}}) + (1-\\frac{1}{\\sqrt{2}}) = 2-\\frac{2}{\\sqrt{2}} = 2-\\sqrt{2}$.\nThe optimal primal value is $v_{Q} = \\min x_1 = 1 - \\max(x_2+x_3) = 1 - (2-\\sqrt{2}) = \\sqrt{2}-1$.\n\nThe dual problem $(D_{Q})$ is:\n$$\n\\begin{array}{ll}\n\\text{maximize}  -\\nu \\\\\n\\text{subject to}  \\begin{bmatrix} 1 + \\nu \\\\ \\nu \\\\ \\nu \\end{bmatrix} \\in Q_{3}\n\\end{array}\n$$\nThe constraint is $1+\\nu \\geq \\sqrt{\\nu^2+\\nu^2} = \\sqrt{2\\nu^2} = \\sqrt{2}|\\nu|$.\nAlso, from $1+\\nu \\geq \\dots \\geq 0$, we must have $1+\\nu \\geq 0$, so $\\nu \\geq -1$.\nCase 1: $\\nu \\geq 0$. The inequality is $1+\\nu \\geq \\sqrt{2}\\nu$, which means $1 \\geq (\\sqrt{2}-1)\\nu$, so $\\nu \\leq \\frac{1}{\\sqrt{2}-1} = \\sqrt{2}+1$. This gives $0 \\leq \\nu \\leq \\sqrt{2}+1$.\nCase 2: $-1 \\leq \\nu  0$. The inequality is $1+\\nu \\geq \\sqrt{2}(-\\nu) = -\\sqrt{2}\\nu$, which means $1 \\geq -(\\sqrt{2}+1)\\nu$, so $\\nu \\geq -\\frac{1}{\\sqrt{2}+1} = 1-\\sqrt{2}$. This gives $1-\\sqrt{2} \\leq \\nu  0$.\nCombining both cases, the feasible set for $\\nu$ is the closed interval $[1-\\sqrt{2}, \\sqrt{2}+1]$.\nWe want to maximize $-\\nu$, which means we must choose the minimum possible value for $\\nu$. The minimum feasible $\\nu$ is $1-\\sqrt{2}$.\nThe optimal dual value is $-(1-\\sqrt{2}) = \\sqrt{2}-1$, which again matches the primal optimal value.\n\nThe dual feasibility region for $\\nu$ is the set $\\{\\nu \\in \\mathbb{R} \\mid 1-\\sqrt{2} \\leq \\nu \\leq \\sqrt{2}+1\\}$, which is a closed, bounded interval (a line segment). This contrasts with the unbounded ray found in Part 1. The more restrictive cone ($Q_3 \\subset \\mathbb{R}^3_+$) in the primal problem leads to a larger feasible set for the dual variable.\n\nFinally, we calculate the required difference between the optimal values:\n$v_{Q} = \\sqrt{2}-1$\n$v_{+} = 0$\nThe difference is $v_{Q} - v_{+} = (\\sqrt{2}-1) - 0 = \\sqrt{2}-1$.",
            "answer": "$$\\boxed{\\sqrt{2}-1}$$"
        }
    ]
}