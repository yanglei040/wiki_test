{
    "hands_on_practices": [
        {
            "introduction": "掌握庞特里亚金极大值原理的第一步是将其应用于一个清晰、直观的问题。这个练习  探讨了最基本的时间最优控制问题：如何在最短时间内将一个系统（此处为一个简化的电路）从初始状态驱动到目标状态。通过解决这个问题，你将亲身体验到哈密顿量 $H$ 的最大化如何直接导出“bang-bang”控制策略，即控制输入 $u(t)$ 始终处于其允许的极限值。",
            "id": "1600522",
            "problem": "一个简单的电子电路由一个电容器和一个漏电阻组成。电容器两端电压 $x(t)$ 的动态由以下一阶线性微分方程建模：\n$$ \\frac{dx}{dt} = -x(t) + u(t) $$\n其中，$x(t)$ 是时间 $t$ 时的电压，单位为伏特，$u(t)$ 是一个可控电压源，单位也为伏特，代表控制输入。由于电源限制，控制输入受到约束，即对所有时间 $t \\ge 0$ 都有 $|u(t)| \\le 1$。\n\n测得电容器上的初始电压为 $x(0) = 5.0$ 伏特。你的任务是确定控制策略 $u(t)$，使得电容器的电压在最短时间内降至零。计算达到最终状态 $x(t_f) = 0$ 所需的这个最短时间 $t_f$。\n\n你的答案应表示最短时间，单位为秒，并四舍五入到三位有效数字。",
            "solution": "我们得到受控线性系统\n$$\n\\frac{dx}{dt}=-x(t)+u(t), \\quad |u(t)|\\le 1, \\quad x(0)=5.\n$$\n我们希望最小化到达 $x(t_{f})=0$ 的时间。对于任何可测输入 $u(t)$，使用积分因子法（使用因子 $\\exp(t)$）得到的通解是\n$$\nx(t)=x(0)\\exp(-t)+\\int_{0}^{t}\\exp\\bigl(-(t-s)\\bigr)u(s)\\,ds.\n$$\n由于核 $\\exp\\bigl(-(t-s)\\bigr)$ 在 $0\\le s\\le t$ 上是严格为正的，因此通过选择最小的容许输入，即\n$$\nu(t)\\equiv -1.\n$$\n可以使状态 $x(t)$ 在时间上逐点最小化。因此，对于任何容许的控制 $u$，对所有 $t\\ge 0$ 都有 $x(t)\\ge x_{-1}(t)$，其中 $x_{-1}$ 表示在 $u\\equiv -1$ 下的轨迹。因此，最早到达 $x=0$ 的时间是通过 $u\\equiv -1$ 实现的。\n\n当 $u(t)\\equiv -1$ 时，系统为\n$$\n\\frac{dx}{dt}=-x(t)-1.\n$$\n求解这个线性常微分方程，使用常数 $u_{0}$ 的标准形式 $x(t)=(x(0)-u_{0})\\exp(-t)+u_{0}$，得到\n$$\nx(t)=(5-(-1))\\exp(-t)-1=6\\exp(-t)-1.\n$$\n到达时间 $t_{f}$ 满足 $x(t_{f})=0$，所以\n$$\n6\\exp(-t_{f})-1=0 \\quad \\Longrightarrow \\quad \\exp(-t_{f})=\\frac{1}{6} \\quad \\Longrightarrow \\quad t_{f}=\\ln 6.\n$$\n数值上，保留三位有效数字，\n$$\nt_{f}\\approx 1.79.\n$$\n因此，最短时间控制是在 $x$ 到达零之前 $u(t)\\equiv -1$，最短时间为 $t_{f}=\\ln 6\\approx 1.79$ 秒。根据最终答案格式，我们只报告四舍五入到三位有效数字的数值。",
            "answer": "$$\\boxed{1.79}$$"
        },
        {
            "introduction": "在理解了“bang-bang”控制的基本思想后，一个自然而然的问题是：我们应该在何时切换控制？这个问题  引导我们探索双积分器系统（一个广泛应用于机械和航空航天领域的模型）的时间最优控制。你的任务是推导出著名的“切换曲线”，即状态空间中定义了最优控制从一个极端切换到另一个极端的分界线，从而深入理解最优轨迹是如何分段构建的。",
            "id": "3162819",
            "problem": "考虑带边界控制的双积分器的时间最优控制问题。系统动力学由下式给出\n$$\\dot{x}_1 = x_2, \\quad \\dot{x}_2 = u,$$\n控制约束为\n$$|u| \\leq 1.$$\n给定任意初始条件 $(x_1(0), x_2(0))$ 和固定的终端条件\n$$x_1(T) = 0, \\quad x_2(T) = 0,$$\n目标是最小化转移时间 $T$。使用庞特里亚金极大值原理（PMP），从哈密顿量、协态动力学、自由终端时间的横截条件和最大化条件的基本定义出发，推导最优控制结构 $u = \\operatorname{sgn}(\\lambda_2)$，其中 $\\lambda_2$ 是第二个协态变量。从第一性原理出发，证明 $\\lambda_2$ 是时间的仿射函数，并且最优軌跡至多只有一个切换点。然后，通过使用状态动力学和最后一段弧线必须以零速度精确到达终端流形的条件，消除协态和切换时间，推导出 $(x_1,x_2)$ 平面中的切换曲线，形式为对所有 $x_2 \\in \\mathbb{R}$ 均成立的单个显式函数 $x_1 = \\Phi(x_2)$。你的最终答案必须是该切换曲线的显式解析表达式。不需要数值近似，也不涉及单位。仅提供 $x_1$ 作为 $x_2$ 的函数的最终表达式。",
            "solution": "目标是最小化最终时间 $T$。这可以表示为最小化成本泛函 $J = \\int_0^T 1 \\, dt$。被积函数为 $L(x, u, t) = 1$。状态向量为 $x(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$，向量形式的状态动力学为 $\\dot{x} = f(x, u) = \\begin{pmatrix} x_2 \\\\ u \\end{pmatrix}$。\n\n根据庞特里亚金极大值原理，我们首先定义哈密顿量 $H$。\n$$H(\\lambda, x, u) = L(x, u, t) + \\lambda^T f(x, u)$$\n$$H = 1 + \\lambda_1 x_2 + \\lambda_2 u$$\n其中 $\\lambda = \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\end{pmatrix}$ 是协态向量。\n\n协态（或伴随）方程由 $\\dot{\\lambda} = -\\frac{\\partial H}{\\partial x}$ 给出。\n$$\\dot{\\lambda}_1 = -\\frac{\\partial H}{\\partial x_1} = 0$$\n$$\\dot{\\lambda}_2 = -\\frac{\\partial H}{\\partial x_2} = -\\lambda_1$$\n对第一个方程积分得到 $\\lambda_1(t) = c_1$，其中 $c_1$ 是一个常数。将此代入第二个方程得到 $\\dot{\\lambda}_2 = -c_1$。对其积分可得：\n$$\\lambda_2(t) = -c_1 t + c_2$$\n其中 $c_2$ 是另一个积分常数。这表明协态变量 $\\lambda_2(t)$ 是时间 $t$ 的仿射函数。\n\nPMP 要求最优控制 $u^*(t)$ 在每个瞬时 $t \\in [0, T]$ 在容许控制集 $U = [-1, 1]$ 上最大化哈密顿量。\n$$u^*(t) = \\arg\\max_{u \\in [-1, 1]} H(\\lambda(t), x(t), u) = \\arg\\max_{u \\in [-1, 1]} (1 + \\lambda_1 x_2 + \\lambda_2 u)$$\n为使 $H$ 最大化，我们必须最大化项 $\\lambda_2 u$。因此，最优控制律是 $\\lambda_2(t)$ 符号的函数：\n- 若 $\\lambda_2(t)  0$，我们选择 $u(t) = 1$。\n- 若 $\\lambda_2(t)  0$，我们选择 $u(t) = -1$。\n- 若 $\\lambda_2(t) = 0$，哈密顿量与 $u$ 无关。这是一个奇异情况。\n\n该控制结构可以紧凑地写为 $u^*(t) = \\operatorname{sgn}(\\lambda_2(t))$，前提是 $\\lambda_2(t) \\neq 0$。如果 $\\lambda_2(t) = 0$ 在一个有限时间区间上成立，那么在该区间上 $\\dot{\\lambda}_2(t)$ 也必须为零。这将意味着在该区间上 $\\lambda_1(t) = 0$。如果两个协态变量都为零，则协态向量是平凡的，这被PMP的一个必要条件（非平凡性条件）所禁止。因此，$\\lambda_2(t)$ 只能在孤立的时间点上为零。由于 $\\lambda_2(t)$ 是时间的线性（仿射）函数，它最多只能穿过轴 $\\lambda_2=0$ 一次（如果 $c_1 \\neq 0$）。因此，一个最优軌跡至多只能有一个控制切换。\n\n最终时间 $T$ 是自由的，最终状态 $x(T) = (0, 0)^T$ 是固定的。自由最终时间的横截条件是 $H(T) = 0$。\n$$H(T) = 1 + \\lambda_1(T) x_2(T) + \\lambda_2(T) u^*(T) = 1 + \\lambda_1(T) \\cdot 0 + \\lambda_2(T) u^*(T) = 0$$\n这意味着 $1 + \\lambda_2(T) u^*(T) = 0$。由于 $|u^*(T)| \\leq 1$，我们必须有 $|\\lambda_2(T)| \\geq 1$，所以 $\\lambda_2(T) \\neq 0$。\n\n切换曲线是 $(x_1, x_2)$ 平面中的状态集合，从这些状态出发，可以通过施加常数控制 $u=+1$ 或 $u=-1$ 到达原点。这些是任何最优軌跡的最后一段。我们通过从原点反向分析系统动力学来推导该曲线，或者等效地，通过寻找可以在时间 $T$ 内用常数控制驱动到原点的初始状态。\n\n情况 1：常数控制 $u = -1$。\n系统动力学为 $\\dot{x}_2 = -1$ 和 $\\dot{x}_1 = x_2$。\n从初始状态 $(x_1(0), x_2(0))$ 积分：\n$x_2(t) = x_2(0) - t$\n$x_1(t) = x_1(0) + x_2(0)t - \\frac{1}{2}t^2$\n我们要求状态在时间 $T$ 到达原点 $(0,0)$。\n$x_2(T) = x_2(0) - T = 0 \\implies T = x_2(0)$。由于 $T  0$，我们必须有 $x_2(0)  0$。\n$x_1(T) = x_1(0) + x_2(0)T - \\frac{1}{2}T^2 = 0$。\n代入 $T = x_2(0)$：\n$x_1(0) + x_2(0)(x_2(0)) - \\frac{1}{2}(x_2(0))^2 = 0$\n$x_1(0) + \\frac{1}{2}x_2(0)^2 = 0$\n去掉初始状态的 $(0)$ 记号，我们得到对于任意状态 $(x_1, x_2)$ 的曲线：\n$$x_1 = -\\frac{1}{2}x_2^2, \\quad \\text{for } x_2 \\ge 0$$\n这是切换曲线的一部分，其最终控制动作为 $u=-1$。\n\n情况 2：常数控制 $u = +1$。\n系统动力学为 $\\dot{x}_2 = 1$ 和 $\\dot{x}_1 = x_2$。\n从 $(x_1(0), x_2(0))$ 积分：\n$x_2(t) = x_2(0) + t$\n$x_1(t) = x_1(0) + x_2(0)t + \\frac{1}{2}t^2$\n我们要求状态在时间 $T$ 到达 $(0,0)$。\n$x_2(T) = x_2(0) + T = 0 \\implies T = -x_2(0)$。由于 $T  0$，这要求 $x_2(0)  0$。\n$x_1(T) = x_1(0) + x_2(0)T + \\frac{1}{2}T^2 = 0$。\n代入 $T = -x_2(0)$：\n$x_1(0) + x_2(0)(-x_2(0)) + \\frac{1}{2}(-x_2(0))^2 = 0$\n$x_1(0) - x_2(0)^2 + \\frac{1}{2}x_2(0)^2 = 0$\n$x_1(0) - \\frac{1}{2}x_2(0)^2 = 0$\n这给出对于任意状态 $(x_1,x_2)$ 的曲线：\n$$x_1 = \\frac{1}{2}x_2^2, \\quad \\text{for } x_2 \\le 0$$\n这是切换曲线的一部分，其最终控制动作为 $u=+1$。\n\n完整的切换曲线，记为 $\\mathcal{S}$，是这两段抛物线弧和原点的并集：\n$$\\mathcal{S} = \\left\\{ (x_1, x_2) \\in \\mathbb{R}^2 \\mid (x_1 = -\\frac{1}{2}x_2^2 \\text{ and } x_2 \\ge 0) \\lor (x_1 = \\frac{1}{2}x_2^2 \\text{ and } x_2 \\le 0) \\right\\}$$\n我们需要将其表示为单个显式函数 $x_1 = \\Phi(x_2)$。\n我们观察到，对于 $x_2  0$，曲线为 $x_1 = -\\frac{1}{2}x_2^2$。\n对于 $x_2  0$，曲线为 $x_1 = \\frac{1}{2}x_2^2$。\n这个分段定义可以使用绝对值函数 $|x_2|$ 或符号函数 $\\operatorname{sgn}(x_2)$ 来统一。我们使用绝对值。\n如果 $x_2 \\ge 0$，则 $|x_2| = x_2$。表达式 $x_1 = -\\frac{1}{2}x_2|x_2|$ 变为 $x_1 = -\\frac{1}{2}x_2(x_2) = -\\frac{1}{2}x_2^2$。这与第一段相符。\n如果 $x_2 \\le 0$，则 $|x_2| = -x_2$。表达式 $x_1 = -\\frac{1}{2}x_2|x_2|$ 变为 $x_1 = -\\frac{1}{2}x_2(-x_2) = \\frac{1}{2}x_2^2$。这与第二段相符。\n因此，切换曲线由单个显式函数描述：\n$$x_1 = -\\frac{1}{2}x_2|x_2|$$\n这个函数 $\\Phi(x_2) = -\\frac{1}{2}x_2|x_2|$ 就是所要求的切换曲线的表达式，对所有 $x_2 \\in \\mathbb{R}$ 均有效。",
            "answer": "$$\\boxed{-\\frac{1}{2}x_{2}|x_{2}|}$$"
        },
        {
            "introduction": "庞特里亚金极大值原理的威力远不止于时间最优控制。这个练习  将我们的视野扩展到一个更普遍的场景，其目标函数混合了能量消耗和时间成本。此外，问题的最终时间 $t_f$ 和最终状态 $\\mathbf{x}(t_f)$ 不是固定的，而是在到达一个目标区域（一个圆）时结束。通过解决此问题，你将学会如何应用横截性条件来处理自由终端时间和终端流形约束，展示了PMP在解决更广泛、更现实问题中的强大功能。",
            "id": "1600523",
            "problem": "一个位于二维笛卡尔平面上的质点，其位置向量为 $\\mathbf{x}(t) = [x_1(t), x_2(t)]^T$，由一个速度输入 $\\mathbf{u}(t) = [u_1(t), u_2(t)]^T$ 控制。该质点的动力学由以下简单积分器模型决定：\n$$\n\\dot{\\mathbf{x}}(t) = \\mathbf{u}(t)\n$$\n该质点在时间 $t=0$ 时从原点出发，即 $\\mathbf{x}(0) = [0, 0]^T$。目标是驱动质点到达一个以原点为中心、半径为 $R$ 的目标圆上。终端时间 $t_f$ 不固定，由质点首次到达该圆的时刻决定。因此，终端条件由流形方程 $x_1(t_f)^2 + x_2(t_f)^2 = R^2$ 给出。\n\n目标是找到一个控制输入 $\\mathbf{u}(t)$，使得目标泛函 $J$ 最小化，该泛函表示控制能量和时间长度的组合：\n$$\nJ = \\int_{0}^{t_f} \\left( \\frac{1}{2} (u_1(t)^2 + u_2(t)^2) + 1 \\right) dt\n$$\n\n确定该目标泛函的最小可能值 $J_{min}$，并用半径 $R$ 表示。",
            "solution": "我们应用 Pontryagin 最小值原理来解决最小化问题：\n$$\nJ=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\left(u_{1}(t)^{2}+u_{2}(t)^{2}\\right)+1\\right)dt=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\|\\mathbf{u}(t)\\|^{2}+1\\right)dt\n$$\n约束条件为动力学 $\\dot{\\mathbf{x}}(t)=\\mathbf{u}(t)$、初始条件 $\\mathbf{x}(0)=\\mathbf{0}$、自由终端时间 $t_{f}$ 以及终端流形 $g(\\mathbf{x}(t_{f}))=\\|\\mathbf{x}(t_{f})\\|^{2}-R^{2}=0$。\n\n定义哈密顿量\n$$\nH(\\mathbf{x},\\mathbf{u},\\boldsymbol{\\lambda})=\\frac{1}{2}\\|\\mathbf{u}\\|^{2}+1+\\boldsymbol{\\lambda}^{T}\\mathbf{u}.\n$$\n关于 $\\mathbf{u}$ 的平稳性条件给出\n$$\n\\frac{\\partial H}{\\partial \\mathbf{u}}=\\mathbf{u}+\\boldsymbol{\\lambda}=\\mathbf{0}\\quad\\Rightarrow\\quad \\mathbf{u}^{*}(t)=-\\boldsymbol{\\lambda}(t).\n$$\n协态动力学为\n$$\n\\dot{\\boldsymbol{\\lambda}}(t)=-\\frac{\\partial H}{\\partial \\mathbf{x}}=\\mathbf{0}\\quad\\Rightarrow\\quad \\boldsymbol{\\lambda}(t)=\\boldsymbol{\\lambda}_{0}\\ \\text{(常数)}.\n$$\n因此，最优控制是常数 $\\mathbf{u}^{*}(t)=-\\boldsymbol{\\lambda}_{0}$，状态演化为\n$$\n\\mathbf{x}(t)=\\int_{0}^{t}\\mathbf{u}^{*}(\\tau)\\,d\\tau=\\mathbf{u}^{*}\\,t=-\\boldsymbol{\\lambda}_{0}\\,t.\n$$\n终端流形条件为\n$$\n\\|\\mathbf{x}(t_{f})\\|^{2}=R^{2}\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|^{2}\\,t_{f}^{2}=R^{2}\\quad\\Rightarrow\\quad t_{f}=\\frac{R}{\\|\\mathbf{u}^{*}\\|}.\n$$\n因为终端时间自由且没有终端成本，横截条件得出\n$$\nH(t_{f})=0.\n$$\n将 $\\mathbf{u}^{*}=-\\boldsymbol{\\lambda}_{0}$ 代入哈密顿量得到\n$$\nH=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1+\\boldsymbol{\\lambda}_{0}^{T}\\mathbf{u}^{*}\n=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1-\\|\\boldsymbol{\\lambda}_{0}\\|^{2}\n=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1-\\|\\mathbf{u}^{*}\\|^{2}\n=1-\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}.\n$$\n令 $H(t_{f})=0$ 得出\n$$\n1-\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}=0\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|^{2}=2\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|=\\sqrt{2}.\n$$\n因此\n$$\nt_{f}=\\frac{R}{\\sqrt{2}}.\n$$\n那么最优成本为\n$$\nJ_{\\min}=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1\\right)dt\n=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\cdot 2+1\\right)dt\n=\\int_{0}^{t_{f}}2\\,dt\n=2t_{f}\n=2\\cdot\\frac{R}{\\sqrt{2}}\n=\\sqrt{2}\\,R.\n$$\n为了完整起见，同样的值也可以通过直接变分法得到。对于任意固定的 $t_{f}$ 和终点 $\\mathbf{y}$（满足 $\\|\\mathbf{y}\\|=R$），最小控制能量由常数控制 $\\mathbf{u}(t)=\\mathbf{y}/t_{f}$ 实现，得到\n$$\nJ(t_{f})=\\frac{1}{2}\\int_{0}^{t_{f}}\\|\\mathbf{u}\\|^{2}dt+\\int_{0}^{t_{f}}1\\,dt=\\frac{1}{2}\\cdot t_{f}\\cdot\\frac{R^{2}}{t_{f}^{2}}+t_{f}=\\frac{R^{2}}{2t_{f}}+t_{f}.\n$$\n通过令 $\\frac{dJ}{dt_{f}}=-\\frac{R^{2}}{2t_{f}^{2}}+1=0$ 对 $t_{f}0$ 进行最小化，可得 $t_{f}=R/\\sqrt{2}$，因此 $J_{\\min}=\\sqrt{2}\\,R$，这与 Pontryagin 分析的结果一致。",
            "answer": "$$\\boxed{\\sqrt{2}\\,R}$$"
        }
    ]
}