{
    "hands_on_practices": [
        {
            "introduction": "Mastering the simplex method starts with a deep understanding of what happens during a single pivot. This exercise challenges you to go beyond simply applying formulas by deriving the update rules for the basic variables and reduced costs directly from foundational principles. By working through the derivation and then applying it to a concrete example (), you will solidify your understanding of the algebraic and geometric intuition behind each step of the algorithm.",
            "id": "3164090",
            "problem": "Consider the primal Simplex method for a Linear Programming (LP) problem in standard equality form for maximization: maximize $c^{\\top} x$ subject to $A x = b$, $x \\ge 0$. Let a current basis be defined by a set of basic columns $B \\in \\mathbb{R}^{m \\times m}$ and nonbasic columns $N \\in \\mathbb{R}^{m \\times (n-m)}$, with associated subvectors $c_B \\in \\mathbb{R}^{m}$, $c_N \\in \\mathbb{R}^{n-m}$. The current basic feasible solution is $x_B = B^{-1} b$, $x_N = 0$, and the reduced costs are given by the fundamental definition $\\bar c^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A$. Suppose a nonbasic variable $x_j$ is chosen to enter the basis by a pricing rule that selects an index with strictly positive reduced cost (Dantzig’s rule: choose $j$ with the largest positive $\\bar c_j$), and let $u = B^{-1} a_j$, where $a_j$ is the $j$-th column of $A$. The primal ratio test determines the leaving basic variable by selecting index $r$ such that $u_r  0$ and $\\theta^{\\star} = \\min_{i : u_i  0} \\frac{x_{B,i}}{u_i}$ is attained at $i = r$. \n\nTasks:\n- Starting only from the core definitions $x_B = B^{-1} b$, $\\bar c^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A$, and the feasibility step equations induced by moving along the direction defined by $u = B^{-1} a_j$, derive exact algebraic update formulas for the new basic variable values and the new reduced costs after a single pivot. Your formulas should give $x_{B}^{+}$ and $\\bar c^{+}$ in terms of $x_B$, $\\bar c$, $u$, the pivot row index $r$, and the quantities from the pre-pivot tableau, without invoking any shortcut formulas not derived from these definitions.\n- Then apply your derived formulas to the specific LP:\nmaximize $3 x_1 + 5 x_2$ subject to\n$$\n\\begin{pmatrix}\n2  1 \\\\\n1  2\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix}\n\\begin{pmatrix}\ns_1 \\\\\ns_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8 \\\\\n8\n\\end{pmatrix}, \\quad\nx_1, x_2, s_1, s_2 \\ge 0,\n$$\nwith initial basis given by the slack variables $s_1$ and $s_2$. Use Dantzig’s pricing rule (choose the nonbasic index with largest strictly positive reduced cost) and the standard primal minimum-ratio test with the deterministic tie-breaker “smallest row index” if needed. Perform exactly two pivots starting from the initial basic feasible solution. At each pivot, verify that the chosen entering variable satisfies the pricing rule and that the chosen leaving variable satisfies the ratio test, and check that feasibility is preserved.\n- Let $z$ denote the objective value after completing the second pivot. Provide $z$ as a single exact simplified fraction.\n\nExpress your final numerical answer as an exact fraction. Do not round. The final answer must be a single real number.",
            "solution": "The problem asks for two main tasks: first, to derive the update formulas for the basic variable values and reduced costs in the Simplex method, starting from fundamental definitions; and second, to apply these formulas to solve a specific Linear Programming (LP) problem for two pivots and find the resulting objective value.\n\n### Part 1: Derivation of Update Formulas\n\nLet the LP be in the standard form: maximize $z = c^{\\top} x$ subject to $A x = b$, $x \\ge 0$.\nThe matrix $A \\in \\mathbb{R}^{m \\times n}$ is partitioned into a basic matrix $B \\in \\mathbb{R}^{m \\times m}$ and a nonbasic matrix $N \\in \\mathbb{R}^{m \\times (n-m)}$. The vectors $x$ and $c$ are partitioned accordingly into $x_B, x_N$ and $c_B, c_N$.\nThe current basic feasible solution (BFS) is given by $x_N = 0$ and $x_B = B^{-1} b \\ge 0$.\nThe reduced costs are $\\bar c^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A$.\n\nA nonbasic variable $x_j$ is chosen to enter the basis, where its reduced cost $\\bar{c}_j  0$. We seek to find a new solution $x^{\\text{new}}$ by increasing $x_j$ from $0$ to some value $\\theta  0$, while keeping all other nonbasic variables at $0$. The basic variables $x_B$ will be adjusted to maintain feasibility.\n\n#### Derivation of the New Basic Variable Values ($x_B^{+}$)\n\nLet the new solution be $x^{\\text{new}}$. The nonbasic part is $x_N^{\\text{new}} = \\theta e_k$, where $e_k$ is the standard basis vector corresponding to the position of $x_j$ within the nonbasic variables. The feasibility constraint $A x = b$ must be maintained:\n$$B x_B^{\\text{new}} + N x_N^{\\text{new}} = b$$\n$$B x_B^{\\text{new}} + a_j \\theta = b$$\nwhere $a_j$ is the column of $A$ (and $N$) corresponding to $x_j$. To solve for $x_B^{\\text{new}}$, we multiply by $B^{-1}$:\n$$x_B^{\\text{new}} = B^{-1}(b - a_j \\theta) = B^{-1}b - \\theta (B^{-1}a_j)$$\nUsing the provided definitions $x_B = B^{-1} b$ and $u = B^{-1} a_j$, we get:\n$$x_B^{\\text{new}}(\\theta) = x_B - \\theta u$$\nFor the new solution to remain feasible, we must have $x_B^{\\text{new}} \\ge 0$, which means $x_{B,i} - \\theta u_i \\ge 0$ for all basic indices $i=1, \\dots, m$.\nIf $u_i \\le 0$, this inequality holds for any $\\theta \\ge 0$.\nIf $u_i  0$, we must have $\\theta \\le \\frac{x_{B,i}}{u_i}$.\nTo maximize the increase in the objective function, we choose the largest possible $\\theta$ that maintains feasibility for all basic variables:\n$$\\theta^{\\star} = \\min_{i \\,:\\, u_i  0} \\left\\{ \\frac{x_{B,i}}{u_i} \\right\\}$$\nThis is the primal ratio test. Let the minimum be achieved for the index $i=r$. This means the basic variable $x_{B,r}$ will be driven to $0$ and will leave the basis.\n$$x_{B,r}^{\\text{new}} = x_{B,r} - \\theta^{\\star} u_r = x_{B,r} - \\left(\\frac{x_{B,r}}{u_r}\\right) u_r = 0$$\nThe new set of basic variables, denoted by $x_B^{+}$, consists of the entering variable $x_j$ and the old basic variables except for the leaving variable $x_{B,r}$. The values of these new basic variables are:\n- The entering variable $x_j$ takes the value $x_j^{+} = \\theta^{\\star} = \\frac{x_{B,r}}{u_r}$.\n- The basic variables that remain in the basis, $x_{B,i}$ for $i \\neq r$, have their values updated to $x_{B,i}^{+} = x_{B,i} - \\theta^{\\star} u_i = x_{B,i} - \\left(\\frac{x_{B,r}}{u_r}\\right) u_i$.\n\n#### Derivation of the New Reduced Costs ($\\bar{c}^{+}$)\n\nThe reduced cost for any variable $x_k$ is $\\bar{c}_k = c_k - \\pi^{\\top} a_k$, where $\\pi^{\\top} = c_B^{\\top} B^{-1}$ is the vector of simplex multipliers. After the pivot, the basis changes from $B$ to $B^{+}$ and the basic cost vector changes from $c_B$ to $c_{B^{+}}$. The new multipliers are $(\\pi^{+})^{\\top} = c_{B^{+}}^{\\top} (B^{+})^{-1}$.\nThe new multipliers must satisfy $(\\pi^{+})^{\\top} a_k = c_k$ for all variables $x_k$ in the new basis.\nLet's express the new multipliers as a modification of the old ones: $(\\pi^{+})^{\\top} = \\pi^{\\top} + \\delta^{\\top}$.\n\nThe new basis consists of the columns $\\{a_{B_i}\\}_{i \\neq r}$ and the new column $a_j$.\n$1$. For the entering variable $x_j$, which is now basic:\n$$(\\pi^{+})^{\\top} a_j = c_j \\implies (\\pi^{\\top} + \\delta^{\\top}) a_j = c_j$$\nSince $\\pi^{\\top} a_j = c_j - \\bar{c}_j$, this gives $(c_j - \\bar{c}_j) + \\delta^{\\top} a_j = c_j$, which simplifies to $\\delta^{\\top} a_j = \\bar{c}_j$.\n\n$2$. For the variables $x_{B_i}$ that remain basic ($i \\neq r$):\n$$(\\pi^{+})^{\\top} a_{B_i} = c_{B_i} \\implies (\\pi^{\\top} + \\delta^{\\top}) a_{B_i} = c_{B_i}$$\nSince $\\pi^{\\top} a_{B_i} = c_{B_i}$ (as $x_{B_i}$ was in the old basis), this simplifies to $\\delta^{\\top} a_{B_i} = 0$ for all $i \\neq r$.\n\nWe now have a system of equations for $\\delta$. We use the relation $a_j = B u = \\sum_{i=1}^{m} u_i a_{B_i}$:\n$$\\bar{c}_j = \\delta^{\\top} a_j = \\delta^{\\top} \\left( \\sum_{i=1}^{m} u_i a_{B_i} \\right) = \\sum_{i=1}^{m} u_i (\\delta^{\\top} a_{B_i})$$\nUsing $\\delta^{\\top} a_{B_i}=0$ for $i \\neq r$, the sum reduces to a single term:\n$$\\bar{c}_j = u_r (\\delta^{\\top} a_{B_r})$$\nThis implies $\\delta^{\\top} a_{B_r} = \\frac{\\bar{c}_j}{u_r}$.\nLet $v_r^{\\top}$ be the $r$-th row of the matrix $B^{-1}$. Then $v_r^{\\top} B = e_r^{\\top}$ (the $r$-th standard basis vector), which means $v_r^{\\top} a_{B_i} = \\delta_{ir}$ (Kronecker delta).\nLet's define a vector $\\eta^{\\top} = \\frac{\\bar{c}_j}{u_r} v_r^{\\top}$. Let's check if this satisfies the conditions on $\\delta^{\\top}$.\n$\\eta^{\\top} a_{B_i} = \\frac{\\bar{c}_j}{u_r} (v_r^{\\top} a_{B_i}) = \\frac{\\bar{c}_j}{u_r} \\delta_{ir}$. This is $0$ for $i \\neq r$ and $\\frac{\\bar{c}_j}{u_r}$ for $i=r$. This matches our findings. So, we have found the change $\\delta^{\\top}$:\n$$\\delta^{\\top} = \\frac{\\bar{c}_j}{u_r} v_r^{\\top} = \\frac{\\bar{c}_j}{u_r} (\\text{r-th row of } B^{-1})$$\nNow we can compute the new reduced cost $\\bar{c}_k^{+}$ for any variable $x_k$:\n$$\\bar{c}_k^{+} = c_k - (\\pi^{+})^{\\top} a_k = c_k - (\\pi^{\\top} + \\delta^{\\top}) a_k = (c_k - \\pi^{\\top} a_k) - \\delta^{\\top} a_k = \\bar{c}_k - \\delta^{\\top} a_k$$\nSubstituting the expression for $\\delta^{\\top}$:\n$$\\bar{c}_k^{+} = \\bar{c}_k - \\left( \\frac{\\bar{c}_j}{u_r} (\\text{r-th row of } B^{-1}) \\right) a_k$$\nThe term $(\\text{r-th row of } B^{-1}) a_k$ is the $r$-th component of the vector $B^{-1}a_k$, which is the column corresponding to $x_k$ in the current simplex tableau. Let's denote this column by $\\bar{a}_k = B^{-1}a_k$. Then the pivot element is $u_r = (\\bar{a}_j)_r = \\bar{a}_{rj}$. The expression becomes:\n$$\\bar{c}_k^{+} = \\bar{c}_k - \\frac{\\bar{c}_j}{\\bar{a}_{rj}} \\bar{a}_{rk}$$\n\n### Part 2: Application to the Specific LP\n\nThe problem is: maximize $z = 3 x_1 + 5 x_2$ subject to\n$$\n\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix}, \\quad x_1, x_2, s_1, s_2 \\ge 0.\n$$\nHere, $x = [x_1, x_2, s_1, s_2]^{\\top}$, $c = [3, 5, 0, 0]^{\\top}$, $A = \\begin{pmatrix} 2  1  1  0 \\\\ 1  2  0  1 \\end{pmatrix}$, $b = \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix}$.\n\n**Initial State (Pivot 0)**\nThe initial basis is given by the slack variables $s_1$ and $s_2$.\n- Basic variables: $x_B = [s_1, s_2]^{\\top}$. Nonbasic variables: $x_N = [x_1, x_2]^{\\top}$.\n- $B = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$, so $B^{-1} = I$.\n- $c_B = [0, 0]^{\\top}$.\n- Initial BFS: $x_B = B^{-1}b = I \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 8 \\end{pmatrix}$. So $s_1=8, s_2=8$. The full solution is $(x_1, x_2, s_1, s_2) = (0, 0, 8, 8)$. This is feasible as all variables are non-negative.\n- Initial objective value: $z = c^{\\top}x = 3(0) + 5(0) + 0(8) + 0(8) = 0$.\n- Reduced costs: $\\bar{c}^{\\top} = c^{\\top} - c_B^{\\top} B^{-1} A = c^{\\top} - 0 \\cdot A = c^{\\top} = [3, 5, 0, 0]$.\n- So, $\\bar{c}_1=3, \\bar{c}_2=5, \\bar{c}_{s1}=0, \\bar{c}_{s2}=0$.\n\n**Pivot 1**\n- **Pricing Rule**: We select the entering variable using Dantzig's rule: choose $j$ with $\\max_{k} \\{\\bar{c}_k\\}  0$.\nHere, $\\max\\{3, 5\\} = 5$, corresponding to $x_2$. So $x_2$ enters the basis. The choice is valid as $\\bar{c}_2=50$.\n- **Ratio Test**: We find the leaving variable. The entering column is $a_2=[1, 2]^{\\top}$. The direction vector is $u = B^{-1}a_2 = I a_2 = [1, 2]^{\\top}$.\nThe current basic variables are $x_B = [s_1, s_2]^{\\top}$ with values $[8, 8]^{\\top}$.\nThe ratios are:\n  - For $s_1$ (index $i=1$): $u_1 = 1  0$, ratio is $x_{B,1}/u_1 = 8/1 = 8$.\n  - For $s_2$ (index $i=2$): $u_2 = 2  0$, ratio is $x_{B,2}/u_2 = 8/2 = 4$.\nThe minimum ratio is $\\theta^{\\star} = \\min\\{8, 4\\} = 4$, which corresponds to index $i=2$ (the variable $s_2$). So $s_2$ leaves the basis. The pivot row is $r=2$. The pivot element is $u_2=2$.\n- **Update**:\n  - New basic variables are $s_1, x_2$.\n  - New values:\n    - Entering $x_2$ gets value $\\theta^{\\star} = 4$.\n    - $s_1$ is updated: $s_1^{+} = s_1 - u_1 \\theta^{\\star} = 8 - 1 \\cdot 4 = 4$.\n  - New BFS: $(x_1, x_2, s_1, s_2) = (0, 4, 4, 0)$. This is feasible.\n  - New objective value: $z = 3(0) + 5(4) = 20$.\n  - New reduced costs using $\\bar{c}_k^{+} = \\bar{c}_k - (\\bar{c}_j/\\bar{a}_{rj}) \\bar{a}_{rk}$. Here $j=2$, $r=2$, $\\bar{c}_2=5$, pivot element $\\bar{a}_{22}=u_2=2$. The multiplier is $5/2$. The pivot row of the tableau ($B^{-1}A = A$) is the $2$nd row of $A$, which is $[1, 2, 0, 1]$.\n    - $\\bar{c}_1^{+} = \\bar{c}_1 - (5/2) \\bar{a}_{21} = 3 - (5/2)(1) = 1/2$.\n    - $\\bar{c}_2^{+} = \\bar{c}_2 - (5/2) \\bar{a}_{22} = 5 - (5/2)(2) = 0$.\n    - $\\bar{c}_{s1}^{+} = \\bar{c}_{s1} - (5/2) \\bar{a}_{2,s1} = 0 - (5/2)(0) = 0$.\n    - $\\bar{c}_{s2}^{+} = \\bar{c}_{s2} - (5/2) \\bar{a}_{2,s2} = 0 - (5/2)(1) = -5/2$.\n  - Post-pivot reduced costs: $\\bar{c}^{\\top} = [1/2, 0, 0, -5/2]$.\n\n**Pivot 2**\n- **State**: Basis consists of $s_1, x_2$. $B = [a_{s1}, a_2] = \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix}$. $x_B = [s_1, x_2]^{\\top} = [4, 4]^{\\top}$.\n- **Pricing Rule**: The only positive reduced cost is $\\bar{c}_1 = 1/2$. So $x_1$ enters the basis. This is valid.\n- **Ratio Test**: Entering column is $a_1=[2, 1]^{\\top}$. We need the corresponding tableau column $u = B^{-1}a_1$.\nFirst, find $B^{-1}$: $B^{-1} = \\frac{1}{2-0} \\begin{pmatrix} 2  -1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  -1/2 \\\\ 0  1/2 \\end{pmatrix}$.\nNow, $u = \\begin{pmatrix} 1  -1/2 \\\\ 0  1/2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2-1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 3/2 \\\\ 1/2 \\end{pmatrix}$.\nThe basic variables are $x_B = [s_1, x_2]^{\\top}$ with values $[4, 4]^{\\top}$.\nThe ratios are:\n  - For $s_1$ (index $i=1$): $u_1 = 3/2  0$, ratio is $x_{B,1}/u_1 = 4/(3/2) = 8/3$.\n  - For $x_2$ (index $i=2$): $u_2 = 1/2  0$, ratio is $x_{B,2}/u_2 = 4/(1/2) = 8$.\nThe minimum ratio is $\\theta^{\\star} = \\min\\{8/3, 8\\} = 8/3$, which corresponds to index $i=1$ (the variable $s_1$). So $s_1$ leaves the basis. The pivot row is $r=1$. The pivot element is $u_1=3/2$.\n- **Update**:\n  - New basic variables are $x_1, x_2$.\n  - New values:\n    - Entering $x_1$ gets value $\\theta^{\\star} = 8/3$.\n    - $x_2$ is updated: $x_2^{+} = x_2 - u_2 \\theta^{\\star} = 4 - (1/2)(8/3) = 4 - 4/3 = 8/3$.\n  - New BFS: $(x_1, x_2, s_1, s_2) = (8/3, 8/3, 0, 0)$. This is feasible.\n  - Final objective value after two pivots: $z = 3 x_1 + 5 x_2 = 3(8/3) + 5(8/3) = 8 + 40/3 = 24/3 + 40/3 = 64/3$.\n\nThe final state has basic variables $x_1=8/3, x_2=8/3$. The objective value is $z=64/3$. This corresponds to the optimal solution. The problem requires providing this value.",
            "answer": "$$\\boxed{\\frac{64}{3}}$$"
        },
        {
            "introduction": "While the simplex method is powerful, it can encounter a phenomenon called degeneracy, where a pivot fails to improve the objective function, potentially leading to cycling. This practice problem uses a carefully constructed hypothetical scenario to demonstrate how a basic ratio test can \"stall\" in a degenerate situation (). You will then see how a more sophisticated approach, the lexicographic ratio test, systematically breaks the tie to guarantee progress, offering insight into the design of robust optimization algorithms.",
            "id": "3164060",
            "problem": "Consider a linear programming (LP) problem in standard form being solved by the simplex method. You are given a current basic feasible solution (BFS) with basic variables $s_{1}, s_{2}, s_{3}$ and nonbasic variables $x_{1}, x_{2}$, where the current solution satisfies $x_{1}=0$, $x_{2}=0$, $s_{1}=0$, $s_{2}=0$, and $s_{3}=1$. This BFS is degenerate because two basic variables are zero. The reduced cost of the nonbasic variable $x_{1}$ is $\\bar{c}_{1}=1$, and $x_{1}$ has been selected as the entering variable by pricing (positive reduced cost for a maximization).\n\nYou are provided the entering column of $x_{1}$ in the current tableau for the three basic rows:\n$$\nA_{\\cdot 1}=\\begin{pmatrix}\na_{11} \\\\\na_{21} \\\\\na_{31}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n2 \\\\\n\\frac{1}{2}\n\\end{pmatrix},\n\\quad\nb=\n\\begin{pmatrix}\nb_{1} \\\\\nb_{2} \\\\\nb_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n1\n\\end{pmatrix}.\n$$\n\nThe naive ratio test selects the leaving variable using the rule $\\theta=\\min\\{b_{i}/a_{i1}:a_{i1}0\\}$, with ties broken by the smallest row index. In contrast, the lexicographic ratio test applies a symbolic perturbation to the right-hand side vector $b$ so that\n$$\nb^{(\\varepsilon)}=\n\\begin{pmatrix}\n\\varepsilon \\\\\n\\varepsilon^{2} \\\\\n1\n\\end{pmatrix},\n\\quad 0\\varepsilon \\ll 1,\n$$\nand then chooses the leaving variable by minimizing $b^{(\\varepsilon)}_{i}/a_{i1}$ in the lexicographic order.\n\nStarting from the foundational definitions of the simplex method, degeneracy, reduced costs, and ratio tests, do the following:\n- Use the naive ratio test to determine the step length $\\theta_{\\text{naive}}$ for the entering variable $x_{1}$ and compute the corresponding one-step change in the objective value $\\Delta z_{\\text{naive}}$.\n- Use the lexicographic ratio test with the perturbation $b^{(\\varepsilon)}$ to determine the step length $\\theta_{\\text{lex}}$ and compute the corresponding one-step change in the objective value $\\Delta z_{\\text{lex}}$.\n\nExpress your final answer as the ordered pair $\\left(\\Delta z_{\\text{naive}},\\ \\Delta z_{\\text{lex}}\\right)$ in exact analytic form as a function of $\\varepsilon$. No rounding is required.",
            "solution": "The problem asks for the one-step change in the objective function value, $\\Delta z$, for a linear programming problem being solved by the simplex method. The entering variable is $x_1$, and its reduced cost is given as $\\bar{c}_1 = 1$. The problem is a maximization problem. For a maximization problem, the change in the objective function value $z$ is given by $\\Delta z = \\bar{c}_1 \\theta$. Given $\\bar{c}_1 = 1$, the change in the objective value is $\\Delta z = \\theta$. Therefore, calculating the change in the objective value is equivalent to calculating the step length $\\theta$ for the entering variable $x_1$. We will calculate this for both the naive and the lexicographic ratio tests.\n\nThe current basic feasible solution is given by the right-hand side vector $b$, which represents the values of the basic variables $(s_1, s_2, s_3)$. The entering column for $x_1$ is $A_{\\cdot 1}$. These are given as:\n$$\nb = \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad A_{\\cdot 1} = \\begin{pmatrix} a_{11} \\\\ a_{21} \\\\ a_{31} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ \\frac{1}{2} \\end{pmatrix}\n$$\nThe current solution is degenerate because two basic variables, $s_1$ and $s_2$, have a value of $0$.\n\nFirst, we analyze the naive ratio test. The step length $\\theta$ is determined by the minimum ratio rule:\n$$\n\\theta = \\min \\left\\{ \\frac{b_i}{a_{i1}} : a_{i1}  0 \\right\\}\n$$\nwhere $i$ ranges over the indices of the basic variables. In this case, the indices are $1$, $2$, and $3$. All entries in the column $A_{\\cdot 1}$ are positive ($a_{11}=1  0$, $a_{21}=2  0$, $a_{31}=1/2  0$), so all three rows are considered in the ratio test.\nThe ratios are:\nFor row $1$ (corresponding to basic variable $s_1$): $\\frac{b_1}{a_{11}} = \\frac{0}{1} = 0$.\nFor row $2$ (corresponding to basic variable $s_2$): $\\frac{b_2}{a_{21}} = \\frac{0}{2} = 0$.\nFor row $3$ (corresponding to basic variable $s_3$): $\\frac{b_3}{a_{31}} = \\frac{1}{1/2} = 2$.\n\nThe minimum ratio is $\\min\\{0, 0, 2\\} = 0$. There is a tie between row $1$ and row $2$. The problem specifies that ties are broken by selecting the row with the smallest index. Therefore, row $1$ is chosen as the pivot row, and the corresponding basic variable $s_1$ is the leaving variable.\nThe step length for the naive test is the value of this minimum ratio:\n$$\n\\theta_{\\text{naive}} = 0\n$$\nThis is a degenerate pivot, where a nonbasic variable enters the basis, but the solution vector and the objective value do not change. The change in the objective value is:\n$$\n\\Delta z_{\\text{naive}} = \\bar{c}_1 \\theta_{\\text{naive}} = 1 \\cdot 0 = 0\n$$\n\nNext, we analyze the lexicographic ratio test as described in the problem. This test resolves degeneracy by using a symbolically perturbed right-hand side vector $b^{(\\varepsilon)}$:\n$$\nb^{(\\varepsilon)} = \\begin{pmatrix} b_1^{(\\varepsilon)} \\\\ b_2^{(\\varepsilon)} \\\\ b_3^{(\\varepsilon)} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon \\\\ \\varepsilon^2 \\\\ 1 \\end{pmatrix}\n$$\nwhere $\\varepsilon$ is a symbolic quantity satisfying $0  \\varepsilon \\ll 1$. The problem states that the leaving variable is chosen by minimizing the ratio $b_i^{(\\varepsilon)}/a_{i1}$. This implies we are to find the step length for this perturbed problem. Let this step length be $\\theta_{\\text{lex}}$.\n$$\n\\theta_{\\text{lex}} = \\min \\left\\{ \\frac{b_i^{(\\varepsilon)}}{a_{i1}} : a_{i1}  0 \\right\\}\n$$\nWe compute the ratios using the perturbed values:\nFor row $1$: $\\frac{b_1^{(\\varepsilon)}}{a_{11}} = \\frac{\\varepsilon}{1} = \\varepsilon$.\nFor row $2$: $\\frac{b_2^{(\\varepsilon)}}{a_{21}} = \\frac{\\varepsilon^2}{2}$.\nFor row $3$: $\\frac{b_3^{(\\varepsilon)}}{a_{31}} = \\frac{1}{1/2} = 2$.\n\nWe must find the minimum of these three values: $\\min\\{\\varepsilon, \\frac{\\varepsilon^2}{2}, 2\\}$. Since $\\varepsilon$ is a small positive number ($0  \\varepsilon \\ll 1$), we know that $\\varepsilon^2$ is of a smaller order of magnitude than $\\varepsilon$. For instance, if $\\varepsilon  2$, then $\\varepsilon^2  2\\varepsilon$, which implies $\\frac{\\varepsilon^2}{2}  \\varepsilon$. Also, for small $\\varepsilon$, we have $\\varepsilon  2$. Thus, the ordering of the ratios is $\\frac{\\varepsilon^2}{2}  \\varepsilon  2$.\nThe minimum ratio is $\\frac{\\varepsilon^2}{2}$, which corresponds to row $2$. The lexicographic rule thus selects row $2$ as the pivot row, and $s_2$ as the leaving variable. The step length under this procedure is the minimum ratio itself:\n$$\n\\theta_{\\text{lex}} = \\frac{\\varepsilon^2}{2}\n$$\nThe corresponding one-step change in the objective value is calculated using this step length:\n$$\n\\Delta z_{\\text{lex}} = \\bar{c}_1 \\theta_{\\text{lex}} = 1 \\cdot \\left( \\frac{\\varepsilon^2}{2} \\right) = \\frac{\\varepsilon^2}{2}\n$$\nThe perturbation has successfully broken the tie and produced a non-zero step length in the perturbed space, leading to a strict improvement in the objective function for any $\\varepsilon  0$.\n\nThe final answer is the ordered pair $(\\Delta z_{\\text{naive}}, \\Delta z_{\\text{lex}})$.\n$$\n(\\Delta z_{\\text{naive}}, \\Delta z_{\\text{lex}}) = \\left(0, \\frac{\\varepsilon^2}{2}\\right)\n$$",
            "answer": "$$\n\\boxed{\\left(0, \\frac{\\varepsilon^2}{2}\\right)}\n$$"
        },
        {
            "introduction": "Choosing which variable should enter the basis—the \"pricing\" step—seems simple, but the choice of rule can have significant consequences. This exercise explores the crucial property of scale-invariance, questioning how a simple change of units for a variable might affect the pivot selection (). By analyzing the behavior of different pricing scores under scaling, you will develop a more critical perspective on why rules like \"steepest-edge\" are considered more robust than the standard Dantzig's rule in certain contexts.",
            "id": "3164024",
            "problem": "Consider a Linear Programming (LP) problem in standard form with objective maximize $c^{\\top} x$ subject to $A x = b$, $x \\ge 0$, being solved by the primal simplex method at a nondegenerate basic feasible solution. Let the current basis matrix be $B$ (the collection of columns of $A$ corresponding to basic variables), and let $c_B$ be the corresponding basic cost vector. For a nonbasic column indexed by $j$, denote its column in $A$ by $a_j$ and its objective coefficient by $c_j$. The primal simplex method computes a reduced cost $\\bar c_j$ for each nonbasic column and a pivot direction vector $d = B^{-1} a_j$ used in the ratio test.\n\nSuppose we change the physical units of variable $x_j$ by scaling its column and cost coefficient as $a_j \\mapsto \\gamma a_j$ and $c_j \\mapsto \\gamma c_j$ for some scalar $\\gamma0$, while keeping the basis $B$ and $c_B$ unchanged. Examine how this transformation affects the reduced cost and the pivot direction used in the ratio test, and decide which strategies preserve decision-making under such column scaling.\n\nSelect all statements that are correct:\n\nA. Under $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$ with $\\gamma0$, the reduced cost transforms to $\\bar c_j^{\\prime} = \\gamma \\bar c_j$ and the pivot direction transforms to $d^{\\prime} = \\gamma d$. Therefore, the sign of $\\bar c_j$ and the identity of the leaving variable selected by the standard ratio test remain unchanged, although the step length along $x_j$ scales by a factor of $1/\\gamma$.\n\nB. The “most negative reduced cost” pricing rule (select $j$ with the smallest $\\bar c_j$ among all negative $\\bar c_j$) is invariant under $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$ for each $j$, because the ordering of reduced costs by magnitude is preserved.\n\nC. A scaling-invariant pricing score is $\\bar c_j / \\lVert a_j \\rVert_2$, because under $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$ with $\\gamma0$, both the numerator and denominator scale by the same factor, leaving the ratio unchanged.\n\nD. A scaling-invariant pricing score is $\\bar c_j / \\lVert B^{-1} a_j \\rVert_2$, sometimes called a “steepest-edge” style normalization, because both $\\bar c_j$ and $B^{-1} a_j$ scale proportionally when $a_j$ and $c_j$ are scaled by the same positive $\\gamma$.\n\nE. Under $a_j \\mapsto \\gamma a_j$, $c_j \\mapsto \\gamma c_j$ with $\\gamma0$, the standard ratio test may select a different leaving basic variable due to the scaling of the pivot column entries $a_{ij}$ in the simplex tableau.\n\nChoose all that apply.",
            "solution": "The user wants me to solve a problem about the simplex method in linear programming.\n\n### Step 1: Extract Givens\n-   **Problem Type**: Linear Programming (LP) in standard form.\n-   **Objective**: Maximize `$c^{\\top} x$`.\n-   **Constraints**: `$A x = b$`, `$x \\ge 0$`.\n-   **Method**: Primal simplex method at a nondegenerate basic feasible solution.\n-   **Notation**:\n    -   `$B$`: Basis matrix (a collection of columns of `$A$`).\n    -   `$c_B$`: Basic cost vector corresponding to `$B$`.\n    -   `$j$`: Index of a nonbasic column.\n    -   `$a_j$`: Column `$j$` of matrix `$A$`.\n    -   `$c_j$`: Objective coefficient corresponding to column `$j$`.\n    -   `$\\bar c_j$`: Reduced cost for nonbasic column `$j$`.\n    -   `$d = B^{-1} a_j$`: Pivot direction vector.\n-   **Transformation**: For a single nonbasic column `$j$`, its data is scaled: `$a_j \\mapsto \\gamma a_j$` and `$c_j \\mapsto \\gamma c_j$`, where `$\\gamma  0$` is a scalar.\n-   **Invariance**: The basis `$B$` and cost vector `$c_B$` remain unchanged.\n-   **Question**: Examine the effect of this transformation on the reduced cost, pivot direction, and ratio test, and identify which statements about pricing strategies and their invariance are correct.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is set firmly within the well-established theory of the simplex method for linear programming. All terms (`reduced cost`, `pivot direction`, `ratio test`, `basis matrix`) are standard and correctly defined in this context. The nondegeneracy assumption is a standard condition for simplifying the analysis of the simplex method.\n2.  **Well-Posed**: The problem asks for an analysis of the consequences of a specific, well-defined mathematical transformation on standard algorithmic quantities. A unique and stable analysis is possible.\n3.  **Objective**: The problem is stated using precise, objective mathematical language.\n4.  **No Flaws Identified**: The problem does not violate any scientific principles, is not ambiguous, incomplete, or contradictory. It is a standard theoretical question in the field of optimization methods.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. I will proceed with the detailed derivation and evaluation.\n\n### Derivation\nLet the LP problem be to maximize `$z = c^{\\top} x$` subject to `$Ax=b, x \\ge 0$`. At a basic feasible solution with basis `$B$`, the basic variables are given by `$x_B = B^{-1} b$`, and nonbasic variables are `$x_N = 0$`. The problem states this solution is nondegenerate, which means `$x_B  0$`.\n\nThe reduced cost for a nonbasic variable `$x_j$` is defined as:\n$$ \\bar{c}_j = c_j - c_B^{\\top} B^{-1} a_j $$\nFor a maximization problem, if `$\\bar{c}_j  0$`, then increasing `$x_j$` will increase the objective function value.\n\nIf `$x_j$` is chosen to enter the basis, the corresponding pivot direction (also known as the simplex tableau column for `$x_j$`) is:\n$$ d = B^{-1} a_j $$\nThe update to the basic variables is `$x_B \\leftarrow x_B - \\theta d$`, where `$\\theta$` is the step size.\n\nThe step size `$\\theta$` is determined by the ratio test to maintain feasibility (`$x_B - \\theta d \\ge 0$`):\n$$ \\theta = \\min_{i: d_i  0} \\left\\{ \\frac{(x_B)_i}{d_i} \\right\\} $$\nThe leaving variable is the basic variable `$x_{B_r}$` for which this minimum is achieved:\n$$ r = \\arg\\min_{i: d_i  0} \\left\\{ \\frac{(x_B)_i}{d_i} \\right\\} $$\nThe nondegeneracy assumption `$x_B  0$` ensures that `$\\theta  0$`.\n\nNow we analyze the effect of the given transformation for a nonbasic variable `$x_j$`. Let the new quantities be denoted with a prime (`$\\prime$`).\nThe transformation is `$c_j \\mapsto c_j' = \\gamma c_j$` and `$a_j \\mapsto a_j' = \\gamma a_j$`, with `$\\gamma  0$`. The basis `$B$` and cost vector `$c_B$` are unchanged.\n\nThe new reduced cost `$\\bar{c}_j'$` is:\n$$ \\bar{c}_j' = c_j' - c_B^{\\top} B^{-1} a_j' = (\\gamma c_j) - c_B^{\\top} B^{-1} (\\gamma a_j) = \\gamma (c_j - c_B^{\\top} B^{-1} a_j) = \\gamma \\bar{c}_j $$\nSince `$\\gamma  0$`, the sign of the reduced cost is unchanged. If `$x_j$` was a candidate to enter the basis (`$\\bar{c}_j  0$`), it remains a candidate (`$\\bar{c}_j'  0$`).\n\nThe new pivot direction `$d'$` is:\n$$ d' = B^{-1} a_j' = B^{-1} (\\gamma a_j) = \\gamma (B^{-1} a_j) = \\gamma d $$\nEach component of the pivot direction vector is scaled by `$\\gamma$`.\n\nThe new step size `$\\theta'$` from the ratio test is:\n$$ \\theta' = \\min_{i: d'_i  0} \\left\\{ \\frac{(x_B)_i}{d'_i} \\right\\} $$\nSince `$\\gamma  0$`, the condition `$d'_i  0$` is equivalent to `$d_i  0$`.\n$$ \\theta' = \\min_{i: d_i  0} \\left\\{ \\frac{(x_B)_i}{\\gamma d_i} \\right\\} = \\frac{1}{\\gamma} \\min_{i: d_i  0} \\left\\{ \\frac{(x_B)_i}{d_i} \\right\\} = \\frac{1}{\\gamma} \\theta $$\nThe new step size is the original step size scaled by `$1/\\gamma$`.\n\nThe index `$r'$` of the new leaving variable is:\n$$ r' = \\arg\\min_{i: d'_i  0} \\left\\{ \\frac{(x_B)_i}{d'_i} \\right\\} = \\arg\\min_{i: d_i  0} \\left\\{ \\frac{(x_B)_i}{\\gamma d_i} \\right\\} $$\nSince `$1/\\gamma$` is a positive constant, it does not change the index `$i$` that achieves the minimum.\n$$ r' = \\arg\\min_{i: d_i  0} \\left\\{ \\frac{(x_B)_i}{d_i} \\right\\} = r $$\nThe leaving variable is unchanged by the scaling.\n\n### Option-by-Option Analysis\n\n**A. Under `$a_j \\mapsto \\gamma a_j$`, `$c_j \\mapsto \\gamma c_j$` with `$\\gamma0$`, the reduced cost transforms to `$\\bar c_j^{\\prime} = \\gamma \\bar c_j$` and the pivot direction transforms to `$d^{\\prime} = \\gamma d$`. Therefore, the sign of `$\\bar c_j$` and the identity of the leaving variable selected by the standard ratio test remain unchanged, although the step length along `$x_j$` scales by a factor of `$1/\\gamma$`.**\n\n-   `$\\bar c_j^{\\prime} = \\gamma \\bar c_j$`: This is correct, as derived above.\n-   `$d^{\\prime} = \\gamma d$`: This is correct, as derived above.\n-   The sign of `$\\bar c_j$` remains unchanged: This is correct, as `$\\gamma  0$`.\n-   The identity of the leaving variable remains unchanged: This is correct, as `$r' = r$`.\n-   The step length scales by a factor of `$1/\\gamma$`: The step length computed by the ratio test for the scaled problem is `$\\theta' = \\theta/\\gamma$`. This is what \"step length\" refers to in this context. Thus, this part of the statement is also correct.\n\nThe statement is a complete and accurate description of the effects of scaling.\n**Verdict: Correct**\n\n**B. The “most negative reduced cost” pricing rule (select `$j$` with the smallest `$\\bar c_j$` among all negative `$\\bar c_j$`) is invariant under `$a_j \\mapsto \\gamma a_j$`, `$c_j \\mapsto \\gamma c_j$` for each `$j$`, because the ordering of reduced costs by magnitude is preserved.**\n\nThis rule applies to minimization problems. For our maximization problem, the equivalent is the \"most positive reduced cost\" rule (Dantzig's rule). A pricing rule is invariant if the choice of entering variable does not change due to scaling. Consider two nonbasic variables `$x_j$` and `$x_k$` with reduced costs `$\\bar c_j  0$` and `$\\bar c_k  0$`. Suppose `$\\bar c_j  \\bar c_k$`, so `$x_j$` is chosen. Now, scale the column for `$x_k$` by `$\\gamma_k  1$` such that `$\\gamma_k \\bar c_k  \\bar c_j$`. The new reduced costs are `$\\bar c_j' = \\bar c_j$` and `$\\bar c_k' = \\gamma_k \\bar c_k$`. Now, `$\\bar c_k'  \\bar c_j'$`, so `$x_k$` would be chosen. For instance, if `$\\bar c_j=10$` and `$\\bar c_k=8$`, we choose `$j$`. If we scale column `$k$` with `$\\gamma_k=2$`, the new reduced cost is `$\\bar c_k' = 16$`. Now we choose `$k$`. The decision changes. The justification in the statement, \"because the ordering of reduced costs by magnitude is preserved,\" is false. The magnitude ` $|\\bar c_j| = \\bar c_j $` does not scale at the same rate for different `$j$` if they are scaled by different `$\\gamma_j$`. A change of units for one variable should not affect the choice of entering variable for a robust pricing rule. This rule is not robust.\n**Verdict: Incorrect**\n\n**C. A scaling-invariant pricing score is `$\\bar c_j / \\lVert a_j \\rVert_2$`, because under `$a_j \\mapsto \\gamma a_j$`, `$c_j \\mapsto \\gamma c_j$` with `$\\gamma0$`, both the numerator and denominator scale by the same factor, leaving the ratio unchanged.**\n\nLet the score be `$S_j = \\bar c_j / \\lVert a_j \\rVert_2$`. Under the transformation, the new score `$S_j'$` becomes:\n$$ S_j' = \\frac{\\bar c_j'}{\\lVert a_j' \\rVert_2} = \\frac{\\gamma \\bar c_j}{\\lVert \\gamma a_j \\rVert_2} $$\nUsing the property of the norm `$\\lVert \\alpha v \\rVert = |\\alpha| \\lVert v \\rVert$`, and since `$\\gamma  0$`, we have `$|\\gamma| = \\gamma$`.\n$$ S_j' = \\frac{\\gamma \\bar c_j}{\\gamma \\lVert a_j \\rVert_2} = \\frac{\\bar c_j}{\\lVert a_j \\rVert_2} = S_j $$\nThe score `$S_j$` is indeed invariant to the scaling. The reasoning provided in the statement is also correct.\n**Verdict: Correct**\n\n**D. A scaling-invariant pricing score is `$\\bar c_j / \\lVert B^{-1} a_j \\rVert_2$`, sometimes called a “steepest-edge” style normalization, because both `$\\bar c_j$` and `$B^{-1} a_j$` scale proportionally when `$a_j$` and `$c_j$` are scaled by the same positive `$\\gamma$`.**\n\nLet the score be `$T_j = \\bar c_j / \\lVert B^{-1} a_j \\rVert_2 = \\bar c_j / \\lVert d \\rVert_2$`. Under the transformation, the new score `$T_j'$` becomes:\n$$ T_j' = \\frac{\\bar c_j'}{\\lVert B^{-1} a_j' \\rVert_2} = \\frac{\\gamma \\bar c_j}{\\lVert B^{-1} (\\gamma a_j) \\rVert_2} = \\frac{\\gamma \\bar c_j}{\\lVert \\gamma (B^{-1} a_j) \\rVert_2} = \\frac{\\gamma \\bar c_j}{\\gamma \\lVert B^{-1} a_j \\rVert_2} = \\frac{\\bar c_j}{\\lVert B^{-1} a_j \\rVert_2} = T_j $$\nThe score `$T_j$` is invariant. The reasoning provided is that `$\\bar c_j$` and `$B^{-1} a_j$` scale proportionally (by `$\\gamma$`), which leads to the norm `$\\lVert B^{-1} a_j \\rVert_2$` also scaling by `$\\gamma$`, which is correct. This form of normalization is indeed associated with the steepest-edge pricing rule, which aims to select the entering variable that gives the greatest rate of objective improvement per unit of distance moved in the solution space.\n**Verdict: Correct**\n\n**E. Under `$a_j \\mapsto \\gamma a_j$`, `$c_j \\mapsto \\gamma c_j$` with `$\\gamma0$`, the standard ratio test may select a different leaving basic variable due to the scaling of the pivot column entries `$a_{ij}$` in the simplex tableau.**\n\nThe pivot column in the tableau is not `$a_j$`, but `$d = B^{-1} a_j$`. As shown in the main derivation, the index of the leaving variable is `$r = \\arg\\min_{i: d_i  0} \\{ (x_B)_i/d_i \\}$`. Under scaling, the new index is `$r' = \\arg\\min_{i: d_i  0} \\{ (x_B)_i/(\\gamma d_i) \\}$`. Since `$1/\\gamma$` is a positive constant, it does not affect the `$\\arg\\min$` operator. Thus, `$r' = r$`, meaning the leaving variable is identical. The statement that it *may* select a different variable is false. The nondegeneracy assumption ensures a unique minimum ratio (in terms of value, though multiple indices could in principle achieve it; however, any tie-breaking rule would also be unaffected by the constant scaling factor).\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{ACD}$$"
        }
    ]
}