## 引言
在[线性规划](@entry_id:138188)的求解工具箱中，[原始单纯形法](@entry_id:634231)从一个[可行解](@entry_id:634783)出发，逐步逼近最优。然而，当初始状态并非可行，或者一个已优化的系统发生变化时，我们该何去何从？这正是对偶单纯形法大放异彩的舞台。它解决了一个核心难题：如何从一个满足[最优性条件](@entry_id:634091)但违反约束的“超优”解出发，高效地恢复可行性并找到真正的最优解。本文将系统地引导您穿越对偶单纯形法的世界。在“原理与机制”一章中，我们将揭示其“保持对偶可行，追求原始可行”的核心思想和枢轴变换规则。接着，在“应用与跨学科联系”中，您将看到该方法如何成为[灵敏度分析](@entry_id:147555)、[整数规划](@entry_id:178386)以及解决能源、金融等领域复杂问题的关键。最后，“动手实践”部分将通过具体练习，巩固您对算法操作的理解。通过本次学习，您将掌握一个不仅在理论上与[原始单纯形法](@entry_id:634231)形成优美对偶，更在实践中极具威力的优化利器。

## 原理与机制

在前一章中，我们介绍了[线性规划](@entry_id:138188)的基本概念和单纯形法。标准的单纯形法（或称[原始单纯形法](@entry_id:634231)）从一个原始可行的基本解出发，通过一系列的枢轴变换，在保持可行性的前提下逐步走向最优。然而，在许多实际应用场景中，我们可能更容易获得一个满足[最优性条件](@entry_id:634091)但不可行的解。此时，对偶单纯形法便提供了一个优雅而高效的解决方案。本章将深入探讨对偶单纯形法的核心原理、算法机制及其深刻的理论内涵。

### 对偶单纯形法的基本思想：从“最优”到“可行”

与[原始单纯形法](@entry_id:634231)“保持可行，追求最优”的路径相反，对偶单纯形法的核心策略是“**保持对偶可行，追求原始可行**”。这里的“对偶可行”与原始问题的[最优性条件](@entry_id:634091)是等价的。让我们通过一个典型的单纯形表来精确定义这一出发点。

考虑一个线性规划问题，其单纯形表满足以下两个条件：
1.  **原始不可行 (Primal Infeasible)**：在单纯形表的右端项 (RHS) 列中，至少有一个值为负数。由于RHS列代表了当前基本解中基变量的取值，负值的出现意味着至少有一个基变量违反了非负约束，因此当前解是不可行的。
2.  **对偶可行 (Dual Feasible)**：在目标函数行中，所有非基变量的[检验数](@entry_id:173345)（或称判别数，reduced costs）均满足[最优性检验](@entry_id:164180)。对于最大化问题，这意味着所有[检验数](@entry_id:173345)都非正（例如，在使用 $c_j - z_j$ 形式的[检验数](@entry_id:173345)时）；对于最小化问题，则要求所有[检验数](@entry_id:173345)都非负。

当一个线性规划问题的状态同时满足这两个条件时，就为启动对偶单纯形法创造了理想的条件  。例如，考虑以下最大化问题的中间单纯形表：

| 基 | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | RHS |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| $z$ | 0 | 0 | 0 | -4 | -2 | 180 |
| $x_1$ | 1 | 0 | 0 | 2 | -1 | 12 |
| $x_2$ | 0 | 1 | 0 | -3 | -2 | -6 |
| $x_3$ | 0 | 0 | 1 | 1 | 5 | 30 |

在这个表中，基变量是 $\{x_1, x_2, x_3\}$。由于基变量 $x_2$ 的值为 $-6$，违反了非负约束 $x_2 \ge 0$，因此当前[基本解](@entry_id:184782)是**原始不可行**的。然而，我们观察目标函数 $z$ 行中非基变量 $x_4$ 和 $x_5$ 的[检验数](@entry_id:173345)，它们分别是 $-4$ 和 $-2$。对于一个最大化问题，最优性判据要求所有[检验数](@entry_id:173345)都为非正数。这两个[检验数](@entry_id:173345)都满足条件，因此该解是**对偶可行**的。这种情况正是应用对偶单纯形法的经典场景。

这种情况在实践中并不少见。例如，在对一个已求得最优解的[线性规划](@entry_id:138188)问题进行灵敏度分析时，如果改变某个约束的右端项，可能会导致原最优解变得不可行，但其[检验数](@entry_id:173345)仍然满足[最优性条件](@entry_id:634091)。此外，在[整数规划](@entry_id:178386)的[割平面法](@entry_id:635930)或[分支定界法](@entry_id:635251)中，向模型中添加新的约束（[割平面](@entry_id:177960)）时，也常常会产生这种对偶可行但原始不可行的状态。对偶单纯形法提供了一种无需从头开始、也无需引入[人工变量](@entry_id:164298)即可修复可行性的强大工具。

### 对偶单纯形枢轴变换的机制

对偶单纯形法的每一次迭代，即一次枢轴变换，都旨在消除一个[原始不可行性](@entry_id:176249)（即一个负的RHS值），同时维持对偶可行性。这个过程包含两个关键步骤：选择离基变量和选择进基变量。

#### 步骤 1：选择离基变量（确定枢轴行）

对偶单纯形法的第一步是识别当前解中“最不可行”的变量。算法规定，选择RHS值最负的基变量作为**离基变量**。这个选择是直观的，因为它优先处理对非负约束最严重的违规。该基变量所在的行即为**枢轴行**。

例如，对于以下最小化问题的初始单纯形表，其RHS值分别为 $-10, -8, -12$。

| 基 | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $s_2$ | $s_3$ | RHS |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| $z$ | 2 | 3 | 4 | 0 | 0 | 0 | 0 |
| $s_1$ | -1 | -2 | -1 | 1 | 0 | 0 | -10 |
| $s_2$ | -2 | -1 | -3 | 0 | 1 | 0 | -8 |
| $s_3$ | -3 | -1 | -1 | 0 | 0 | 1 | -12 |

由于 $\min\{-10, -8, -12\} = -12$，我们选择对应的基变量 $s_3$ 作为离基变量，其所在的第三行（$s_3$ 行）成为枢轴行 。

#### 步骤 2：选择进基变量（确定枢轴列）

确定了枢轴行后，下一步是选择一个非基变量进入基，以替换离基变量。这个选择必须保证在下一次迭代中，[目标函数](@entry_id:267263)的对偶可行性得以保持。这通过**对偶比率测试**来实现。

规则如下：只考虑在枢轴行中系数为**负值**的那些非基变量。对于每一个这样的候选变量 $x_j$，计算一个比率：

$$ \text{比率}_j = \frac{\text{目标函数行中 } x_j \text{ 的检验数}}{\text{枢轴行中 } x_j \text{ 的系数}} $$

或者，为了避免符号混淆，更稳妥的规则是选择使得以下[绝对值](@entry_id:147688)比率最小的变量 $x_j$：

$$ \min_{j \in N, \bar{a}_{rj}  0} \left| \frac{\bar{c}_j}{\bar{a}_{rj}} \right| $$

其中，$r$ 是枢轴行的索引，$N$ 是非基变量的集合，$\bar{c}_j$ 是 $x_j$ 的[检验数](@entry_id:173345)，$\bar{a}_{rj}$ 是 $x_j$ 在枢轴行中的系数。被选中的变量即为**进基变量**，其所在的列为**枢轴列**。

让我们看一个具体的例子。假设我们正在求解一个最小化问题，当前单纯形表（部分）如下，并且我们已经确定枢轴行为 $s_2$ 所在行 ：

- 目标行 ($z$): $[-2, -3, 0, 0]$ (对应非基变量 $x_1, x_2$ 的[检验数](@entry_id:173345))
- 枢轴行 ($s_2$): $[-3, -1, 0, 1]$ (对应非基变量 $x_1, x_2$ 的系数)

在枢轴行中，非基变量 $x_1$ 和 $x_2$ 的系数（分别为 $-3$ 和 $-1$）都是负数，因此它们都是进基的候选变量。我们计算它们的[绝对值](@entry_id:147688)比率：

- 对于 $x_1$: 比率 $= |\frac{-2}{-3}| = \frac{2}{3}$
- 对于 $x_2$: 比率 $= |\frac{-3}{-1}| = 3$

我们选择[绝对值](@entry_id:147688)最小的比率，即 $\min\{\frac{2}{3}, 3\} = \frac{2}{3}$。这个比率对应的变量是 $x_1$，因此 $x_1$ 成为进基变量。

为何只考虑枢轴行中的负系数？因为枢轴元素（枢轴行与枢轴列的交点）必须为负。在接下来的枢轴变换中，枢轴行将被除以枢轴元素。由于枢轴行的RHS值是负的，一个负的枢轴元素将确保新的RHS值（即新进基变量的值）变为正，从而朝着原始可行的方向迈出一步。

#### 步骤 3：执行枢轴变换

一旦确定了枢轴元素（进基变量和离基变量交汇处的元素），就执行标准的行变换操作，将枢轴列变换为单位向量（枢轴元素变为1，该列其他元素变为0）。这将产生一个新的单纯形表，对应一个新的[基本解](@entry_id:184782)。算法重复这三个步骤，直到所有RHS值都变为非负。

### 算法的终止条件

对偶单纯形法的迭代过程有两种可能的结局：

1.  **找到最优解**：算法持续进行，直到所有RHS值都变为非负。此时，单纯形表既是原始可行的，也是对偶可行的，因此表示了原问题的最优解。

2.  **确定原问题无[可行解](@entry_id:634783)**：在算法的某一步，我们选择了一个枢轴行（其RHS为负），但在该行中，所有非基变量的系数都**非负**。根据对偶比率测试的规则，我们找不到任何一个负系数来选择进基变量。此时，[算法终止](@entry_id:143996)。这种情况表明原问题**没有可行解** 。从[对偶理论](@entry_id:143133)的角度看，这对应于[对偶问题](@entry_id:177454)是无界的。例如，在下面这个为最小化问题构建的表中，$x_4$行是枢轴行（RHS为-1），但其对应的非基变量 $x_1, x_2$ 的系数（1和0）都是非负的，因此无法选择进基变量。这证明了原始问题是不可行的。

| 基 | ... | $x_1$ | $x_2$ | ... | RHS |
|:---:|:---:|:---:|:---:|:---:|:---:|
| z | ... | -3 | -5 | ... | ... |
| $x_4$| ... | 1 | 0 | ... | -1 |
| ... | ... | ... | ... | ... | ... |

### 深入探究：对偶视角下的对偶单纯形法

对偶单纯形法的名称并非偶然，它的每一步操作都与原问题的对偶问题中的操作有着深刻的对应关系。实际上，**对偶单纯形法可以被精确地看作是在原始问题的单纯形表上执行[原始单纯形法](@entry_id:634231)来求解其对偶问题**。

让我们阐明这种联系。在一个给定的单纯形表中，我们不仅可以读出原始问题的[基本解](@entry_id:184782)，还可以读出其[对偶问题](@entry_id:177454)的对应解。对于一个最小化问题，其对偶变量的值，可以通过原始问题[松弛变量](@entry_id:268374)（slack/surplus variables）在目标函数行的[检验数](@entry_id:173345)直接得到（通常需要取相反数，具体取决于单纯形表的构建方式）。

当原始问题的单纯形表是对偶可行时，意味着从中读出的[对偶问题](@entry_id:177454)的解是可行的。而当这个表是原始不可行时，意味着原始问题的解不可行。因此，“对偶可行，原始不可行”的状态，对应于“[对偶问题](@entry_id:177454)有一个可行解，而原始问题没有”。

最关键的洞见在于，在这样一个表上执行一次**对偶单纯形枢轴变换**，其效果与在对应的[对偶问题](@entry_id:177454)上执行一次**原始单纯形枢轴变换**是完全等价的 。对偶单纯形法选择离基变量和进基变量的规则，恰好是[原始单纯形法](@entry_id:634231)在其对偶问题上选择进基和离基变量规则的“镜像”。

这个发现解释了对偶单纯形法为何能奏效：它实际上是在对偶问题的[可行域的顶点](@entry_id:174284)上移动，每一步都改善对偶问题的目标函数值。由于强[对偶定理](@entry_id:137804)，当这个过程达到对偶问题的最优解时，也就找到了原始问题的最优解。

### 高级主题与理论诠释

#### 几何诠释

[原始单纯形法](@entry_id:634231)的每一步可以看作是在原始问题[可行域](@entry_id:136622)（一个多胞体）的边上从一个顶点移动到另一个相邻的、[目标函数](@entry_id:267263)值更优的顶点。相比之下，对偶单纯形法的几何路径则不同。它是在原始问题的决策变量空间中，从一个**不可行**的基本解（可行域外的一个“顶点”）移动到另一个**不可行**的基本解，但每一步都向着[可行域](@entry_id:136622)逼近，直到最终进入[可行域](@entry_id:136622)并达到最优顶点 。例如，在二维空间中，一次对偶单纯形迭代可能将解从原点 $(0,0)$（一个不满足任何约束的不可行点）移动到点 $(0,2)$（一个满足了部分约束但仍不可行的点），但这个新点在某种意义上“减少了[不可行性](@entry_id:164663)”。

#### [KKT条件](@entry_id:185881)视角

从更广义的 [Karush-Kuhn-Tucker](@entry_id:634966) (KKT) [最优性条件](@entry_id:634091)来看，对偶单纯形法也有一种深刻的解释。[KKT条件](@entry_id:185881)包含：原始可行性、对偶可行性和[互补松弛性](@entry_id:141017)。对偶单纯形法的起始状态（对偶可行，原始不可行）可以被描述为满足了**对偶可行性**和**[互补松弛性](@entry_id:141017)**条件，但违反了**原始可行性**（即 $x \ge 0$ 和 $Ax \le b$）。对偶单纯形法的每一次枢轴变换，其精妙之处在于它在修复原始可行性违规的同时，始终保持对偶可行性和[互补松弛性](@entry_id:141017)不被破坏。当所有原始可行性条件最终都被满足时，所有[KKT条件](@entry_id:185881)同时成立，从而达到最优解 。

#### 退化与循环问题

与[原始单纯形法](@entry_id:634231)一样，对偶单纯形法也可能遇到**退化 (degeneracy)** 问题。对偶退化发生在对偶比率测试中出现平局，即多个非基变量有相同的最小比率。虽然理论上这可能导致算法循环，但在实践中极为罕见。为了从理论上保证算法的终止性，可以采用类似于[原始单纯形法](@entry_id:634231)中的Bland规则或**[字典序](@entry_id:143032)规则 (lexicographical rule)**。[字典序](@entry_id:143032)规则通过比较向量而不仅仅是单个比率值来打破平局，确保每次迭代都有严格的改进，从而杜绝循环的发生 。这种规则通过将整个枢轴候选列（包括目标行）除以枢轴行系数的[绝对值](@entry_id:147688)，然后进行[字典序](@entry_id:143032)比较，从而为选择进基变量提供一个明确无误的、能保证收敛的判据。

总之，对偶单纯形法不仅是一个强大的计算工具，也是理解[线性规划](@entry_id:138188)[对偶理论](@entry_id:143133)的一扇窗口。它通过一种与[原始单纯形法](@entry_id:634231)截然不同的路径达到最优点，深刻地体现了原始问题与[对偶问题](@entry_id:177454)之间优美而对称的内在联系。