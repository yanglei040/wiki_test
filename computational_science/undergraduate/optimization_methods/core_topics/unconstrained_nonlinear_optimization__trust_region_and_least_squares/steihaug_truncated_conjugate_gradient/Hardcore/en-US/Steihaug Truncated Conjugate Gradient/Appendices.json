{
    "hands_on_practices": [
        {
            "introduction": "To begin, we will explore the most fundamental scenario in the Steihaug Truncated Conjugate Gradient (TCG) method. This exercise examines the very first iteration, where the search direction is simply the path of steepest descent. You will see how the algorithm handles the case where the optimal step along this direction lies outside the trust region, requiring the step to be truncated at the boundary (). This specific truncated step is known as the Cauchy point, a cornerstone in trust-region analysis.",
            "id": "3185651",
            "problem": "Consider the trust-region quadratic model of order two for minimizing a smooth function near a current iterate, defined by\n$$\nm(p) \\;=\\; m(0) \\;+\\; g^{\\top}p \\;+\\; \\tfrac{1}{2}\\,p^{\\top}Hp,\n$$\nwhere the gradient at the current iterate is\n$$\ng \\;=\\; \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix},\n$$\nand the symmetric positive definite Hessian approximation is\n$$\nH \\;=\\; \\begin{pmatrix} 2 & 0 \\\\ 0 & 6 \\end{pmatrix}.\n$$\nLet the trust-region radius be\n$$\n\\Delta \\;=\\; 1.\n$$\nApply one iteration of Steihaug's truncated conjugate gradient method, which starts from\n$$\np_{0} \\;=\\; 0, \\quad d_{0} \\;=\\; -g,\n$$\nand moves along the ray\n$$\np(\\alpha) \\;=\\; p_{0} + \\alpha d_{0}\n$$\nuntil either the one-dimensional minimizer is reached or the boundary of the trust region is encountered.\n\nUsing only the definitions of the trust-region model and the line search along the initial direction, do the following:\n- Determine the first trial step length $\\alpha_{0}$ at which the trust-region boundary is hit along the direction $d_{0}$ by solving the boundary equation $\\|p(\\alpha)\\| = \\Delta$.\n- Verify by differentiating the univariate model $\\phi(\\alpha) = m(p(\\alpha))$ that the unconstrained minimizer along $d_{0}$ occurs at some $\\alpha_{\\star}$, and decide whether $\\alpha_{\\star}$ lies beyond the trust-region boundary.\n- Compute the step $p_{1} = p(\\alpha_{0})$.\n- Compute the predicted reduction $m(0) - m(p_{1})$.\n- Compute the Cauchy decrease for this data and verify that it equals the predicted reduction.\n\nReport the common value of the predicted reduction and the Cauchy decrease. Round your answer to four significant figures.",
            "solution": "The problem is to apply one iteration of Steihaug's truncated conjugate gradient method to a given trust-region quadratic model. The process involves finding the step that minimizes the model along the steepest descent direction within the trust-region boundary.\n\nThe given quadratic model is\n$$\nm(p) \\;=\\; m(0) \\;+\\; g^{\\top}p \\;+\\; \\tfrac{1}{2}\\,p^{\\top}Hp\n$$\nwith the gradient vector\n$$\ng \\;=\\; \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}\n$$\nand the symmetric positive definite Hessian matrix\n$$\nH \\;=\\; \\begin{pmatrix} 2 & 0 \\\\ 0 & 6 \\end{pmatrix}\n$$\nThe trust-region radius is $\\Delta = 1$.\n\nThe first iteration of Steihaug's method starts from the origin, $p_{0} = 0$, and searches along the steepest descent direction, $d_{0} = -g$. The trial step is defined by the ray $p(\\alpha) = p_{0} + \\alpha d_{0} = \\alpha d_{0}$ for $\\alpha \\geq 0$.\n\nFirst, we determine the step length $\\alpha_{0}$ at which the search path intersects the trust-region boundary. The boundary is defined by the equation $\\|p\\| = \\Delta$.\nSubstituting $p(\\alpha) = \\alpha d_{0}$, we get:\n$$\n\\|\\alpha d_{0}\\| \\;=\\; \\Delta\n$$\nSince $\\alpha \\ge 0$, this simplifies to $\\alpha \\|d_{0}\\| = \\Delta$. The norm of the search direction $d_{0} = -g$ is:\n$$\n\\|d_{0}\\| \\;=\\; \\|-g\\| \\;=\\; \\|g\\| \\;=\\; \\sqrt{3^2 + 4^2} \\;=\\; \\sqrt{9 + 16} \\;=\\; \\sqrt{25} \\;=\\; 5\n$$\nThe step length to reach the boundary is therefore:\n$$\n\\alpha_{0} \\;=\\; \\frac{\\Delta}{\\|d_{0}\\|} \\;=\\; \\frac{1}{5} \\;=\\; 0.2\n$$\n\nNext, we determine the unconstrained minimizer of the quadratic model along the direction $d_{0}$. We define a univariate quadratic function $\\phi(\\alpha) = m(p(\\alpha))$:\n$$\n\\phi(\\alpha) \\;=\\; m(0) + g^{\\top}(\\alpha d_{0}) + \\frac{1}{2}(\\alpha d_{0})^{\\top}H(\\alpha d_{0})\n$$\n$$\n\\phi(\\alpha) \\;=\\; m(0) + \\alpha (g^{\\top}d_{0}) + \\frac{1}{2}\\alpha^2 (d_{0}^{\\top}H d_{0})\n$$\nTo find the minimizer $\\alpha_{\\star}$, we set the derivative with respect to $\\alpha$ to zero:\n$$\n\\phi'(\\alpha) \\;=\\; g^{\\top}d_{0} + \\alpha (d_{0}^{\\top}H d_{0}) \\;=\\; 0\n$$\nThis gives the step length for the unconstrained minimizer:\n$$\n\\alpha_{\\star} \\;=\\; -\\frac{g^{\\top}d_{0}}{d_{0}^{\\top}H d_{0}}\n$$\nWe compute the two quadratic terms. Since $d_{0} = -g$:\n$$\ng^{\\top}d_{0} \\;=\\; g^{\\top}(-g) \\;=\\; -\\|g\\|^2 \\;=\\; -25\n$$\n$$\nd_{0}^{\\top}H d_{0} \\;=\\; (-g)^{\\top}H(-g) \\;=\\; g^{\\top}H g\n$$\nWe calculate $g^{\\top}H g$:\n$$\ng^{\\top}H g \\;=\\; \\begin{pmatrix} 3 & 4 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 6 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 3 & 4 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 24 \\end{pmatrix} \\;=\\; 3(6) + 4(24) \\;=\\; 18 + 96 \\;=\\; 114\n$$\nNow, we can find $\\alpha_{\\star}$:\n$$\n\\alpha_{\\star} \\;=\\; -\\frac{-25}{114} \\;=\\; \\frac{25}{114} \\approx 0.2193\n$$\nWe compare the unconstrained minimizing step length $\\alpha_{\\star}$ with the step length to the boundary $\\alpha_{0}$:\n$$\n\\alpha_{\\star} \\;=\\; \\frac{25}{114} \\quad > \\quad \\alpha_{0} \\;=\\; \\frac{1}{5} \\;=\\; 0.2\n$$\nSince the unconstrained minimizer along $d_{0}$ lies beyond the trust-region boundary, Steihaug's method truncates the step at the boundary. The step taken is $p_{1} = p(\\alpha_{0})$.\n\nThe step $p_{1}$ is computed as:\n$$\np_{1} \\;=\\; \\alpha_{0} d_{0} \\;=\\; 0.2 \\times (-g) \\;=\\; 0.2 \\begin{pmatrix} -3 \\\\ -4 \\end{pmatrix} \\;=\\; \\begin{pmatrix} -0.6 \\\\ -0.8 \\end{pmatrix}\n$$\n\nThe predicted reduction in the model value is $m(0) - m(p_{1})$.\n$$\nm(0) - m(p_{1}) \\;=\\; - \\left( g^{\\top}p_{1} + \\frac{1}{2} p_{1}^{\\top}H p_{1} \\right)\n$$\nWe compute the terms:\n$$\ng^{\\top}p_{1} \\;=\\; \\begin{pmatrix} 3 & 4 \\end{pmatrix} \\begin{pmatrix} -0.6 \\\\ -0.8 \\end{pmatrix} \\;=\\; 3(-0.6) + 4(-0.8) \\;=\\; -1.8 - 3.2 \\;=\\; -5\n$$\n$$\np_{1}^{\\top}H p_{1} \\;=\\; \\begin{pmatrix} -0.6 & -0.8 \\end{pmatrix} \\begin{pmatrix} 2 & 0 \\\\ 0 & 6 \\end{pmatrix} \\begin{pmatrix} -0.6 \\\\ -0.8 \\end{pmatrix} \\;=\\; \\begin{pmatrix} -0.6 & -0.8 \\end{pmatrix} \\begin{pmatrix} -1.2 \\\\ -4.8 \\end{pmatrix}\n$$\n$$\np_{1}^{\\top}H p_{1} \\;=\\; (-0.6)(-1.2) + (-0.8)(-4.8) \\;=\\; 0.72 + 3.84 \\;=\\; 4.56\n$$\nThe predicted reduction is:\n$$\nm(0) - m(p_{1}) \\;=\\; - \\left( -5 + \\frac{1}{2}(4.56) \\right) \\;=\\; -(-5 + 2.28) \\;=\\; -(-2.72) \\;=\\; 2.72\n$$\n\nFinally, we must verify that this value equals the Cauchy decrease. The Cauchy point is defined as the minimizer of the quadratic model along the steepest descent direction within the trust region. The step we have just computed, $p_{1}$, is precisely the Cauchy point for this problem, because the unconstrained minimizer along the steepest descent direction was found to be outside the trust-region boundary, causing the step to be truncated at the boundary. The Cauchy decrease is, by definition, the predicted model reduction at the Cauchy point, which is $m(0) - m(p_{1})$. Therefore, the value we computed for the predicted reduction, $2.72$, is identical to the Cauchy decrease.\n\nThe problem asks for this common value, rounded to four significant figures.\n$$\n2.720\n$$",
            "answer": "$$\\boxed{2.720}$$"
        },
        {
            "introduction": "Building upon the first practice, this problem moves to the second iteration of the TCG method. Here, the initial step lies safely within the trust region, prompting the algorithm to compute a new, improved search direction that is conjugate to the first. This exercise illustrates the iterative power of the method and demonstrates how the trust-region boundary check is a critical safeguard at every step, not just the first one ().",
            "id": "3185626",
            "problem": "Consider the quadratic model of the trust-region subproblem\n$$m(p) = g^{\\top}p + \\frac{1}{2}p^{\\top}Hp,$$\nwith symmetric positive definite Hessian matrix\n$$H = \\begin{pmatrix}1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 4\\end{pmatrix},$$\ngradient\n$$g = \\begin{pmatrix}1 \\\\ 1 \\\\ 0\\end{pmatrix},$$\nand trust-region radius\n$$\\Delta = 1.$$\nStarting from the zero vector $p_0 = \\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$, apply Steihaug's Truncated Conjugate Gradient (TCG) method, which uses Conjugate Gradient (CG) search directions, exact line minimization along each search direction, and truncation on detecting either negative curvature or boundary intersection, to generate iterates within the ball $\\|p\\|_2 \\leq \\Delta$.\n\nCarry out the first iteration to compute the first step $p_1$ produced by exact line minimization along the initial CG search direction. Verify whether $\\|p_1\\|_2 < \\Delta$. Proceed to the second iteration to construct the next CG search direction $d_2$. Assume no negative curvature is encountered. Show that the full step along $d_2$ would leave the trust region and therefore the boundary must be reached at iteration $2$. Determine the unique scalar $\\alpha \\in (0,\\infty)$ such that the truncated step $p_1 + \\alpha d_2$ lies exactly on the boundary, i.e.,\n$$\\|p_1 + \\alpha d_2\\|_2 = \\Delta.$$\n\nReport the value of $\\alpha$ as an exact rational number. No rounding is required. Use the Euclidean norm $\\|\\cdot\\|_2$ throughout.",
            "solution": "The problem is well-posed and provides all necessary information to apply Steihaug's Truncated Conjugate Gradient (TCG) method. We are given the quadratic model $m(p) = g^{\\top}p + \\frac{1}{2}p^{\\top}Hp$ with gradient $g$, Hessian $H$, and trust-region radius $\\Delta$.\nThe given parameters are:\n$$\nH = \\begin{pmatrix}1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 4\\end{pmatrix}, \\quad g = \\begin{pmatrix}1 \\\\ 1 \\\\ 0\\end{pmatrix}, \\quad \\Delta = 1\n$$\nThe starting point for the TCG method is $p_0 = \\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}$.\n\n**Iteration 1**\nFirst, we initialize the residual and the search direction. The residual $r_k$ for the quadratic model is $r_k = g + Hp_k$.\nAt the start, with $p_0 = 0$:\n$$r_0 = g + H p_0 = g = \\begin{pmatrix}1 \\\\ 1 \\\\ 0\\end{pmatrix}$$\nThe first search direction in the Conjugate Gradient (CG) method is the negative residual:\n$$d_1 = -r_0 = \\begin{pmatrix}-1 \\\\ -1 \\\\ 0\\end{pmatrix}$$\n\nThe TCG method first checks for negative curvature, i.e., if $d_1^{\\top}Hd_1 \\le 0$. Since $H$ is given as positive definite, we expect positive curvature.\n$$d_1^{\\top}Hd_1 = \\begin{pmatrix}-1 & -1 & 0\\end{pmatrix} \\begin{pmatrix}1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 4\\end{pmatrix} \\begin{pmatrix}-1 \\\\ -1 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}-1 & -2 & 0\\end{pmatrix} \\begin{pmatrix}-1 \\\\ -1 \\\\ 0\\end{pmatrix} = (-1)(-1) + (-2)(-1) = 1+2=3$$\nSince $d_1^{\\top}Hd_1 = 3 > 0$, we proceed.\n\nThe optimal step length $\\alpha_1$ that minimizes $m(p_0 + \\alpha d_1)$ is given by the standard CG formula:\n$$\\alpha_1 = \\frac{r_0^{\\top}r_0}{d_1^{\\top}Hd_1}$$\nWe compute $r_0^{\\top}r_0$:\n$$r_0^{\\top}r_0 = \\begin{pmatrix}1 & 1 & 0\\end{pmatrix} \\begin{pmatrix}1 \\\\ 1 \\\\ 0\\end{pmatrix} = 1^2 + 1^2 + 0^2 = 2$$\nSo, the step length is:\n$$\\alpha_1 = \\frac{2}{3}$$\nThe first iterate is $p_1$:\n$$p_1 = p_0 + \\alpha_1 d_1 = 0 + \\frac{2}{3}\\begin{pmatrix}-1 \\\\ -1 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}-2/3 \\\\ -2/3 \\\\ 0\\end{pmatrix}$$\n\nNext, we must verify if $p_1$ is within the trust region, i.e., if $\\|p_1\\|_2 \\le \\Delta$.\n$$\\|p_1\\|_2^2 = \\left(-\\frac{2}{3}\\right)^2 + \\left(-\\frac{2}{3}\\right)^2 + 0^2 = \\frac{4}{9} + \\frac{4}{9} = \\frac{8}{9}$$\nSince $\\Delta=1$, $\\Delta^2=1$. We have $\\|p_1\\|_2^2 = \\frac{8}{9} < 1$, which means $\\|p_1\\|_2 = \\frac{\\sqrt{8}}{3} = \\frac{2\\sqrt{2}}{3} < 1$. The point $p_1$ is strictly inside the trust region.\n\n**Iteration 2**\nTo proceed to the second iteration, we compute the new residual $r_1$ and the new search direction $d_2$.\n$$r_1 = r_0 + \\alpha_1 H d_1 = \\begin{pmatrix}1 \\\\ 1 \\\\ 0\\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix}1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 4\\end{pmatrix} \\begin{pmatrix}-1 \\\\ -1 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}1 \\\\ 1 \\\\ 0\\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix}-1 \\\\ -2 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}1 - 2/3 \\\\ 1 - 4/3 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}1/3 \\\\ -1/3 \\\\ 0\\end{pmatrix}$$\nNow, we compute the factor $\\beta_1$ for the new search direction:\n$$\\beta_1 = \\frac{r_1^{\\top}r_1}{r_0^{\\top}r_0}$$\nFirst, $r_1^{\\top}r_1$:\n$$r_1^{\\top}r_1 = \\left(\\frac{1}{3}\\right)^2 + \\left(-\\frac{1}{3}\\right)^2 + 0^2 = \\frac{1}{9} + \\frac{1}{9} = \\frac{2}{9}$$\nUsing $r_0^{\\top}r_0=2$ from before:\n$$\\beta_1 = \\frac{2/9}{2} = \\frac{1}{9}$$\nThe new search direction $d_2$ is:\n$$d_2 = -r_1 + \\beta_1 d_1 = -\\begin{pmatrix}1/3 \\\\ -1/3 \\\\ 0\\end{pmatrix} + \\frac{1}{9}\\begin{pmatrix}-1 \\\\ -1 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}-1/3 - 1/9 \\\\ 1/3 - 1/9 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}-4/9 \\\\ 2/9 \\\\ 0\\end{pmatrix}$$\n\nThe problem states that the full step along $d_2$ would leave the trust region. The TCG algorithm requires us to find a step $\\alpha > 0$ along $d_2$ starting from $p_1$ that reaches the boundary of the trust region. This means we must solve for $\\alpha$ in the equation:\n$$\\|p_1 + \\alpha d_2\\|_2 = \\Delta = 1$$\nSquaring both sides gives:\n$$\\|p_1 + \\alpha d_2\\|_2^2 = 1$$\nExpanding the left-hand side:\n$$(p_1 + \\alpha d_2)^{\\top}(p_1 + \\alpha d_2) = p_1^{\\top}p_1 + 2\\alpha(p_1^{\\top}d_2) + \\alpha^2(d_2^{\\top}d_2) = 1$$\nThis is a quadratic equation in $\\alpha$ of the form $A\\alpha^2 + B\\alpha + C = 0$. Let's compute the coefficients.\n$A = d_2^{\\top}d_2 = \\|d_2\\|_2^2 = \\left(-\\frac{4}{9}\\right)^2 + \\left(\\frac{2}{9}\\right)^2 + 0^2 = \\frac{16}{81} + \\frac{4}{81} = \\frac{20}{81}$.\n$B = 2(p_1^{\\top}d_2)$. First, $p_1^{\\top}d_2$:\n$$p_1^{\\top}d_2 = \\begin{pmatrix}-2/3 & -2/3 & 0\\end{pmatrix} \\begin{pmatrix}-4/9 \\\\ 2/9 \\\\ 0\\end{pmatrix} = \\left(-\\frac{2}{3}\\right)\\left(-\\frac{4}{9}\\right) + \\left(-\\frac{2}{3}\\right)\\left(\\frac{2}{9}\\right) = \\frac{8}{27} - \\frac{4}{27} = \\frac{4}{27}$$\nSo, $B = 2\\left(\\frac{4}{27}\\right) = \\frac{8}{27}$.\n$C = p_1^{\\top}p_1 - 1 = \\|p_1\\|_2^2 - 1 = \\frac{8}{9} - 1 = -\\frac{1}{9}$.\n\nThe quadratic equation for $\\alpha$ is:\n$$\\left(\\frac{20}{81}\\right)\\alpha^2 + \\left(\\frac{8}{27}\\right)\\alpha - \\frac{1}{9} = 0$$\nTo simplify, we multiply the entire equation by $81$:\n$$20\\alpha^2 + 3(8)\\alpha - 9 = 0$$\n$$20\\alpha^2 + 24\\alpha - 9 = 0$$\nWe solve for $\\alpha$ using the quadratic formula, $\\alpha = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=20$, $b=24$, $c=-9$:\n$$\\alpha = \\frac{-24 \\pm \\sqrt{24^2 - 4(20)(-9)}}{2(20)} = \\frac{-24 \\pm \\sqrt{576 + 720}}{40} = \\frac{-24 \\pm \\sqrt{1296}}{40}$$\nThe square root is $\\sqrt{1296}=36$.\n$$\\alpha = \\frac{-24 \\pm 36}{40}$$\nThis gives two solutions for $\\alpha$:\n$$\\alpha_1 = \\frac{-24 + 36}{40} = \\frac{12}{40} = \\frac{3}{10}$$\n$$\\alpha_2 = \\frac{-24 - 36}{40} = \\frac{-60}{40} = -\\frac{3}{2}$$\nThe problem asks for the unique scalar $\\alpha \\in (0,\\infty)$. The TCG algorithm considers a step in the direction $d_2$, so we need the positive value of $\\alpha$.\nThus, the required value is $\\alpha = \\frac{3}{10}$.",
            "answer": "$$\\boxed{\\frac{3}{10}}$$"
        },
        {
            "introduction": "Our final practice addresses a critical feature of the Steihaug TCG algorithm: its ability to handle non-convex quadratic models. In many practical optimization problems, the Hessian approximation $B$ may not be positive definite, leading to directions of negative curvature where $d^{\\top}Bd \\le 0$. This exercise guides you through the process of detecting such a direction and applying the correct truncation rule, showcasing the robustness that makes the TCG method so effective in real-world applications ().",
            "id": "3185627",
            "problem": "Consider the trust-region quadratic model $m(p) = g^{\\top} p + \\frac{1}{2} p^{\\top} B p$ for a step $p \\in \\mathbb{R}^{3}$, where the symmetric tridiagonal matrix $B \\in \\mathbb{R}^{3 \\times 3}$ and gradient $g \\in \\mathbb{R}^{3}$ are given by\n$$\nB = \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & -2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}, \n\\quad\ng = \\begin{pmatrix}\n1 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n$$\nLet the trust-region radius be $\\Delta = \\frac{3}{4}$. Use Steihaug's truncated Conjugate Gradient method (TCG) to solve the trust-region subproblem $\\min \\{ m(p) : \\|p\\| \\leq \\Delta \\}$ starting from $p_{0} = 0$, where the Conjugate Gradient (CG) iteration for the linear system $B p = -g$ is initiated with residual $r_{0} = g$ and search direction $d_{0} = -r_{0}$. In each CG iteration $k$, if the curvature $d_{k}^{\\top} B d_{k} > 0$ and the full step $p_{k+1} = p_{k} + \\alpha_{k} d_{k}$ with $\\alpha_{k} = \\frac{r_{k}^{\\top} r_{k}}{d_{k}^{\\top} B d_{k}}$ stays within the trust region (i.e., $\\|p_{k+1}\\| < \\Delta$), update the residual $r_{k+1} = r_{k} + \\alpha_{k} B d_{k}$ and the direction $d_{k+1} = -r_{k+1} + \\beta_{k} d_{k}$ with $\\beta_{k} = \\frac{r_{k+1}^{\\top} r_{k+1}}{r_{k}^{\\top} r_{k}}$. If either (i) the step along $d_{k}$ hits the trust-region boundary, or (ii) negative curvature is detected (i.e., $d_{k}^{\\top} B d_{k} \\leq 0$), truncate by moving from $p_{k}$ along $d_{k}$ to the boundary point $p^{\\star} = p_{k} + \\tau d_{k}$ with $\\tau > 0$ chosen so that $\\|p^{\\star}\\| = \\Delta$.\n\nTasks:\n1. Carry out the first CG iteration to compute $p_{1}$, $r_{1}$, and $d_{1}$.\n2. Determine whether negative curvature is present at the second direction $d_{1}$ by evaluating $d_{1}^{\\top} B d_{1}$.\n3. If truncation is required, solve analytically for the boundary intersection parameter $\\tau$ satisfying $\\|p_{1} + \\tau d_{1}\\| = \\Delta$, and compute the truncated step $p^{\\star} = p_{1} + \\tau d_{1}$.\n4. Verify the $B$-conjugacy of the directions generated before truncation by computing $d_{0}^{\\top} B d_{1}$, and verify the truncation rule by checking $\\|p^{\\star}\\| = \\Delta$.\n\nExpress the final trust-region step $p^{\\star}$ as a single exact analytic row vector. Use exact algebra and do not round.",
            "solution": "We follow the steps of the Steihaug TCG method as described.\n\n**Task 1: First CG Iteration**\n\nStart with $p_0 = 0$. The initial residual is $r_0 = g + Bp_0 = g = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\nThe initial search direction is $d_0 = -r_0 = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n\nFirst, we check the curvature along $d_0$:\n$$ d_0^{\\top} B d_0 = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & -2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix} = 2 $$\nSince $d_0^{\\top} B d_0 = 2 > 0$, the curvature is positive. We compute the step length $\\alpha_0$:\n$$ \\alpha_0 = \\frac{r_0^{\\top} r_0}{d_0^{\\top} B d_0} = \\frac{1^2 + 0^2 + 0^2}{2} = \\frac{1}{2} $$\nThe next iterate is $p_1 = p_0 + \\alpha_0 d_0 = 0 + \\frac{1}{2} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n\nWe check if $p_1$ is inside the trust region:\n$$ \\|p_1\\| = \\sqrt{(-1/2)^2} = 1/2 $$\nSince $1/2  \\Delta = 3/4$, the step is accepted and we continue.\n\nNow, we update the residual and direction.\nThe new residual is $r_1 = r_0 + \\alpha_0 B d_0$:\n$$ B d_0 = \\begin{pmatrix} 2  -1  0 \\\\ -1  -2  -1 \\\\ 0  -1  2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n$$ r_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 1/2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\end{pmatrix} $$\nTo find the next direction $d_1$, we compute $\\beta_0$:\n$$ \\beta_0 = \\frac{r_1^{\\top} r_1}{r_0^{\\top} r_0} = \\frac{(1/2)^2}{1^2} = \\frac{1}{4} $$\nThe new direction is $d_1 = -r_1 + \\beta_0 d_0$:\n$$ d_1 = -\\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1/4 \\\\ -1/2 \\\\ 0 \\end{pmatrix} $$\n\n**Task 2: Check Curvature for $d_1$**\n\nWe evaluate the curvature along $d_1$:\n$$ d_1^{\\top} B d_1 = \\begin{pmatrix} -1/4  -1/2  0 \\end{pmatrix} \\begin{pmatrix} 2  -1  0 \\\\ -1  -2  -1 \\\\ 0  -1  2 \\end{pmatrix} \\begin{pmatrix} -1/4 \\\\ -1/2 \\\\ 0 \\end{pmatrix} $$\nFirst, compute $B d_1$:\n$$ B d_1 = \\begin{pmatrix} 2(-1/4) -1(-1/2) \\\\ -1(-1/4) -2(-1/2) \\\\ -1(-1/2) \\end{pmatrix} = \\begin{pmatrix} -1/2 + 1/2 \\\\ 1/4 + 1 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 5/4 \\\\ 1/2 \\end{pmatrix} $$\nThen, compute the dot product:\n$$ d_1^{\\top} B d_1 = \\begin{pmatrix} -1/4  -1/2  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 5/4 \\\\ 1/2 \\end{pmatrix} = (-1/4)(0) + (-1/2)(5/4) + 0 = -5/8 $$\nSince $d_1^{\\top} B d_1 = -5/8 \\le 0$, negative curvature is detected. The TCG algorithm terminates the CG iterations and proceeds to find the intersection with the trust-region boundary.\n\n**Task 3: Truncate and Compute Final Step**\n\nWe need to find $\\tau > 0$ such that the step $p^{\\star} = p_1 + \\tau d_1$ satisfies $\\|p^{\\star}\\| = \\Delta$.\nThe equation is $\\|p_1 + \\tau d_1\\|^2 = \\Delta^2$.\n$$ \\|p_1\\|^2 + 2\\tau(p_1^{\\top}d_1) + \\tau^2 \\|d_1\\|^2 = \\Delta^2 $$\nWe compute the coefficients:\n$$ \\|p_1\\|^2 = (-1/2)^2 = 1/4 $$\n$$ p_1^{\\top} d_1 = \\begin{pmatrix} -1/2  0  0 \\end{pmatrix} \\begin{pmatrix} -1/4 \\\\ -1/2 \\\\ 0 \\end{pmatrix} = (-1/2)(-1/4) = 1/8 $$\n$$ \\|d_1\\|^2 = (-1/4)^2 + (-1/2)^2 = 1/16 + 1/4 = 5/16 $$\n$$ \\Delta^2 = (3/4)^2 = 9/16 $$\nThe quadratic equation for $\\tau$ is:\n$$ \\frac{1}{4} + 2\\tau\\left(\\frac{1}{8}\\right) + \\tau^2\\left(\\frac{5}{16}\\right) = \\frac{9}{16} $$\n$$ \\frac{1}{4} + \\frac{\\tau}{4} + \\frac{5\\tau^2}{16} = \\frac{9}{16} $$\nMultiplying by 16 gives:\n$$ 4 + 4\\tau + 5\\tau^2 = 9 \\implies 5\\tau^2 + 4\\tau - 5 = 0 $$\nUsing the quadratic formula for $\\tau$:\n$$ \\tau = \\frac{-4 \\pm \\sqrt{4^2 - 4(5)(-5)}}{2(5)} = \\frac{-4 \\pm \\sqrt{16 + 100}}{10} = \\frac{-4 \\pm \\sqrt{116}}{10} = \\frac{-4 \\pm 2\\sqrt{29}}{10} = \\frac{-2 \\pm \\sqrt{29}}{5} $$\nSince we need $\\tau > 0$, we take the positive root:\n$$ \\tau = \\frac{-2 + \\sqrt{29}}{5} $$\nThe final truncated step $p^{\\star}$ is:\n$$ p^{\\star} = p_1 + \\tau d_1 = \\begin{pmatrix} -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{\\sqrt{29}-2}{5} \\begin{pmatrix} -1/4 \\\\ -1/2 \\\\ 0 \\end{pmatrix} $$\nThe components are:\n$$ p_x^{\\star} = -\\frac{1}{2} - \\frac{\\sqrt{29}-2}{20} = \\frac{-10 - (\\sqrt{29}-2)}{20} = \\frac{-8 - \\sqrt{29}}{20} $$\n$$ p_y^{\\star} = 0 - \\frac{\\sqrt{29}-2}{10} = \\frac{2 - \\sqrt{29}}{10} $$\n$$ p_z^{\\star} = 0 $$\nSo, $p^{\\star} = \\begin{pmatrix} \\frac{-8 - \\sqrt{29}}{20}  \\frac{2 - \\sqrt{29}}{10}  0 \\end{pmatrix}$.\n\n**Task 4: Verifications**\n\n*   **B-conjugacy:** We verify that $d_0^{\\top} B d_1 = 0$.\n    $$ d_0^{\\top} B d_1 = \\begin{pmatrix} -1  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 5/4 \\\\ 1/2 \\end{pmatrix} = (-1)(0) + 0 + 0 = 0 $$\n    The directions generated before truncation are indeed B-conjugate.\n*   **Truncation rule:** The parameter $\\tau$ was chosen specifically to satisfy $\\|p_1 + \\tau d_1\\| = \\Delta$. Therefore, by construction, $\\|p^{\\star}\\| = \\Delta = 3/4$.\n\nThe final trust-region step is $p^{\\star}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{-8 - \\sqrt{29}}{20}  \\frac{2 - \\sqrt{29}}{10}  0 \\end{pmatrix}}\n$$"
        }
    ]
}