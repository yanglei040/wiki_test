## 引言
在优化理论中，函数的几何形态对其分析和求解至关重要。然而，直接理解高维函数的结构往往非常困难，这构成了理论与实践之间的一道鸿沟。为了弥合这一差距，数学家们发展出了上境图（epigraph）和[水平集](@entry_id:751248)（level set）这两个强大的几何工具，它们能将抽象的函数关系转化为直观的集合进行分析。本文旨在系统地介绍这两个核心概念。在接下来的内容中，读者将首先在“原理与机制”一章中学习上境图与[水平集](@entry_id:751248)的基本定义、性质，并深入探索它们与优化基石——[凸性](@entry_id:138568)——之间的根本联系。随后，在“应用与跨学科联系”一章中，我们将展示这些理论如何在优化、机器学习、信号处理乃至物理和经济学等多个领域中解决实际问题。最后，通过“动手实践”部分，读者将有机会巩固所学知识，并将其应用于具体问题中。

## 原理与机制

在优化理论的研究中，我们不仅关心函数的代数表达式，更关心其内在的几何结构。函[数的几何](@entry_id:192990)形态深刻地影响着优化算法的行为和收敛性。为了系统地描述和分析这些几何特征，我们引入了两个核心工具：**上境图（epigraph）**和**水平集（level set）**。本章将深入探讨这些概念的定义、性质，并揭示它们与优化理论基石——凸性之间的深刻联系。

### 可视化函数：上境图与[水平集](@entry_id:751248)

理解一个高维函数是困难的，但通过上境图和[水平集](@entry_id:751248)，我们可以将其几何特征转化为更直观的集合概念进行分析。

#### 上境图：从上方观察函数

想象一个函数 $f: \mathbb{R}^n \to \mathbb{R}$ 的图像，它是一个在 $\mathbb{R}^{n+1}$ 空间中的 $n$ 维[曲面](@entry_id:267450)。现在，如果我们不仅考虑这个[曲面](@entry_id:267450)上的点，还包括该[曲面](@entry_id:267450)“上方”的所有点，那么所得到的集合就是函数的上境图。

**上境图**（Epigraph）的正式定义如下：对于函数 $f: \mathbb{R}^n \to \mathbb{R}$，其上境图 $\text{epi}(f)$ 是 $\mathbb{R}^{n+1}$ 空间中的一个集合，由所有位于函数图像之上或之上的点 $(\mathbf{x}, t)$ 组成。数学上，
$$ \text{epi}(f) = \{(\mathbf{x}, t) \in \mathbb{R}^n \times \mathbb{R} \mid t \ge f(\mathbf{x}) \} $$
其中 $\mathbf{x} \in \mathbb{R}^n$ 是函数的输入，而 $t \in \mathbb{R}$ 是一个标量，代表“高度”。

这个定义将函数的研究转化为了对其对应集合的研究。例如，考虑集合 $S = \{(x,y,z) \in \mathbb{R}^3 \mid z \ge x^4 + y^2\}$。通过与上境图的定义进行比对，我们可以立即识别出，这个集合 $S$ 正是二维函数 $f(x,y) = x^4 + y^2$ 的上境图，其中变量 $z$ 扮演了定义中 $t$ 的角色 。

上境图的几何形态直观地反映了函数的形状。
- 对于一个[常数函数](@entry_id:152060) $f(\mathbf{x}) = c$（其中 $\mathbf{x} \in \mathbb{R}^n$），它的图像是 $\mathbb{R}^{n+1}$ 中一个“水平”的超平面。其上境图则是这个超平面及其上方的整个半空间，即集合 $\{(\mathbf{x}, t) \in \mathbb{R}^n \times \mathbb{R} \mid t \ge c\}$ 。
- 对于一个更复杂的函数，如定义在 $\mathbb{R}^2$ 上的欧几里得范数 $f(\mathbf{x}) = \|\mathbf{x}\|_2 = \sqrt{x_1^2 + x_2^2}$，其上境图是集合 $\{(x_1, x_2, t) \in \mathbb{R}^3 \mid t \ge \sqrt{x_1^2 + x_2^2}\}$。这个不等式描述了一个坚实的、顶点在原点、沿 $t$ 轴正方向开口的圆锥体 。

#### [水平集](@entry_id:751248)：绘制[地形图](@entry_id:202940)

与上境图从“侧面”和“上方”捕捉函数不同，[水平集](@entry_id:751248)则是从“正上方”俯视函数，类似于地理学中的[等高线图](@entry_id:178003)。

对于一个函数 $f: \mathbb{R}^n \to \mathbb{R}$ 和一个标量 $\alpha \in \mathbb{R}$，我们定义了三种类型的[水平集](@entry_id:751248)：
- **$\alpha$-[下水平集](@entry_id:636882) (Sublevel Set)**：$S_\alpha = \{\mathbf{x} \in \text{dom}(f) \mid f(\mathbf{x}) \le \alpha\}$。这是函数值小于或等于 $\alpha$ 的所有定义域点的集合。
- **$\alpha$-上[水平集](@entry_id:751248) (Superlevel Set)**：$\{\mathbf{x} \in \text{dom}(f) \mid f(\mathbf{x}) \ge \alpha\}$。
- **$\alpha$-[水平集](@entry_id:751248) (Level Set)**：$\{\mathbf{x} \in \text{dom}(f) \mid f(\mathbf{x}) = \alpha\}$。

在优化中，[下水平集](@entry_id:636882)尤为重要，因为它通常代表了满足某个性能约束（例如，成本、误差）的所有[可行解](@entry_id:634783)的集合。

让我们再次考察[常数函数](@entry_id:152060) $f(\mathbf{x}) = c$ 。
- 如果我们选择一个水平 $\beta  c$，那么条件 $f(\mathbf{x}) \le \beta$ (即 $c \le \beta$) 永远无法满足，因此其[下水平集](@entry_id:636882) $S_\beta$ 是空集 $\emptyset$。
- 如果我们选择一个水平 $\beta \ge c$，那么条件 $c \le \beta$ 对定义域中所有的 $\mathbf{x}$ 都成立，因此[下水平集](@entry_id:636882) $S_\beta$ 是整个空间 $\mathbb{R}^n$。

对于线性函数，[下水平集](@entry_id:636882)具有特别清晰的几何意义。例如，在一个生产场景中，生产两种产品（数量为 $x_1, x_2$）的总成本为 $f(x_1, x_2) = 4x_1 + 7x_2$。如果预算上限为 $\alpha = 350$，那么所有满足预算的生产计划 $(x_1, x_2)$ 构成了[下水平集](@entry_id:636882) $S_{350} = \{(x_1, x_2) \mid 4x_1 + 7x_2 \le 350, x_1 \ge 0, x_2 \ge 0\}$。这个集合在几何上是一个由坐标轴和直线 $4x_1 + 7x_2 = 350$ 围成的闭合[凸多边形](@entry_id:165008)区域，这在几何上是一个（受限于非负象限的）闭合半平面 。

区分这几种水平集是至关重要的。以前面的例子 $S = \{(x,y,z) \mid z \ge x^4 + y^2\}$ 为例，我们可以将其视为函数 $g(x,y,z) = z - x^4 - y^2$ 的 $0$-上[水平集](@entry_id:751248)。而该函数的 $0$-[水平集](@entry_id:751248) $\{(x,y,z) \mid z - x^4 - y^2 = 0\}$ 则仅代表函数的图像本身，即一个[曲面](@entry_id:267450)，而不是一个实体区域 。

### 与[凸性](@entry_id:138568)的根本联系

上境图和水平集不仅仅是几何可视化工具，它们与优化理论的核心概念——**[凸性](@entry_id:138568) (convexity)**——有着密不可分的关系。

#### 上境图判据：[凸函数](@entry_id:143075)与凸集的等价性

凸性的研究中有一个极其深刻和优美的基本定理：**一个函数是[凸函数](@entry_id:143075)，当且仅当它的上境图是一个[凸集](@entry_id:155617)。**

一个集合 $C$ 是**[凸集](@entry_id:155617)**，如果集合中任意两点之间的线段完全包含在该集合内。即对任意 $\mathbf{p}_1, \mathbf{p}_2 \in C$ 和任意 $\lambda \in [0, 1]$，点 $\lambda \mathbf{p}_1 + (1-\lambda) \mathbf{p}_2$ 仍然在 $C$ 中。

这个定理的直观含义是：如果在函数图像上方的空间中任取两点，连接它们的直线段也必须完全位于这个空间内。这几何上等价于函数图像上任意两点连接的弦（chord）始终位于这两点之间函数图像的上方或之上。

这个判据为我们提供了一个从几何角度判断函数[凸性](@entry_id:138568)的强大方法。
- 考虑函数 $f(x) = 1/x$，其定义域为 $D = (0, \infty)$。我们可以通过[二阶导数](@entry_id:144508)判据来检验其[凸性](@entry_id:138568)。$f''(x) = 2x^{-3}$，在定义域 $x > 0$ 上恒为正。因此，$f(x)$ 在其（凸的）定义域上是[凸函数](@entry_id:143075)。根据上境图判据，我们直接得出其上境图 $\text{epi}(f) = \{(x,y) \in \mathbb{R}^2 \mid x>0, y \ge 1/x\}$ 是一个[凸集](@entry_id:155617) 。
- 考虑函数 $g(x_1, x_2) = x_1^2 + |x_2|$。函数 $f_1(x_1, x_2) = x_1^2$ 和 $f_2(x_1, x_2) = |x_2|$ 都是[凸函数](@entry_id:143075)。由于凸函数的和仍然是[凸函数](@entry_id:143075)，所以 $g(x_1, x_2)$ 是一个凸函数。因此，无需进行复杂的代数验证，我们就可以断定它的上境图 $\text{epi}(g)$ 是一个[凸集](@entry_id:155617) 。

#### [下水平集](@entry_id:636882)的凸性与拟[凸性](@entry_id:138568)

与上境图和凸函数之间的[等价关系](@entry_id:138275)不同，[下水平集](@entry_id:636882)与凸性之间是一种单向关系：**如果一个函数是凸函数，那么它的所有[下水平集](@entry_id:636882)都是[凸集](@entry_id:155617)。**

这个性质的证明非常直接。假设 $f$ 是[凸函数](@entry_id:143075)，考虑其任意一个 $\alpha$-[下水平集](@entry_id:636882) $S_\alpha$。取任意两点 $\mathbf{x}_1, \mathbf{x}_2 \in S_\alpha$，这意味着 $f(\mathbf{x}_1) \le \alpha$ 且 $f(\mathbf{x}_2) \le \alpha$。对于任意 $\lambda \in [0, 1]$，根据 $f$ 的[凸性](@entry_id:138568)定义：
$$ f(\lambda \mathbf{x}_1 + (1-\lambda) \mathbf{x}_2) \le \lambda f(\mathbf{x}_1) + (1-\lambda) f(\mathbf{x}_2) \le \lambda \alpha + (1-\lambda) \alpha = \alpha $$
这表明点 $\lambda \mathbf{x}_1 + (1-\lambda) \mathbf{x}_2$ 的函数值也不超过 $\alpha$，因此该点也属于 $S_\alpha$。由于 $\mathbf{x}_1, \mathbf{x}_2, \lambda$ 是任意选择的，这证明了 $S_\alpha$ 是一个凸集。

然而，这个命题的**逆命题不成立**。也就是说，一个函数的所有[下水平集](@entry_id:636882)都是[凸集](@entry_id:155617)，并不能保证该函数本身是凸函数。满足这一性质但非凸的函数被称为**拟凸函数 (quasiconvex function)**。拟[凸性](@entry_id:138568)是比凸性更弱的一个条件，但在优化中仍然非常有用。

以下是一些经典的拟[凸函数](@entry_id:143075)例子 ：
- **$f(x) = \sqrt{|x|}$**：这个函数不是[凸函数](@entry_id:143075)（例如，连接 $(-1, 1)$ 和 $(1, 1)$ 的线段位于函数图像下方）。然而，它的[下水平集](@entry_id:636882)对于 $\alpha \ge 0$ 是[闭区间](@entry_id:136474) $[-\alpha^2, \alpha^2]$，对于 $\alpha  0$ 是空集。在所有情况下，[下水平集](@entry_id:636882)都是区间或[空集](@entry_id:261946)，因此都是凸集。
- **$f(x) = x^3$**：这个函数在 $x0$ 时是凹的，在 $x>0$ 时是凸的，因此在整个 $\mathbb{R}$ 上不是凸函数。但是，它的任意 $\alpha$-[下水平集](@entry_id:636882)是 $S_\alpha = \{x \in \mathbb{R} \mid x^3 \le \alpha\} = (-\infty, \sqrt[3]{\alpha}]$，这是一个半无限区间，因此是[凸集](@entry_id:155617)。

### 关键性质与运算

上境图和[水平集](@entry_id:751248)不仅定义了函[数的几何](@entry_id:192990)形态，它们之间还存在着运算关系，这些关系在构建和分析[优化问题](@entry_id:266749)时至关重要。

#### 几何联系：切割上境图

上境图和[下水平集](@entry_id:636882)之间存在一个直接的几何构造关系。一个函数的 $\alpha$-[下水平集](@entry_id:636882)，可以通过对其上境图进行“水平切割”并“投影”得到。

具体步骤如下 ：
1.  取函数的上境图 $\text{epi}(f)$。
2.  用高度为 $\alpha$ 的水平超平面 $\{(\mathbf{x}, t) \mid t = \alpha\}$ 与之相交。得到的交集是 $C_\alpha = \{(\mathbf{x}, \alpha) \mid \alpha \ge f(\mathbf{x})\}$。
3.  将这个交集 $C_\alpha$ 投影到[函数的定义域](@entry_id:162002)空间 $\mathbb{R}^n$ 上。这个投影就是所有属于 $C_\alpha$ 的点的 $\mathbf{x}$ 坐标的集合。

这个投影的结果正是 $\alpha$-[下水平集](@entry_id:636882) $S_\alpha = \{\mathbf{x} \mid f(\mathbf{x}) \le \alpha\}$。例如，对于 $f(x) = x^2$ 和 $\alpha > 0$，其上境图是 $y \ge x^2$ 的区域。用直线 $y=\alpha$ 切割，得到线段 $\{(x, \alpha) \mid -\sqrt{\alpha} \le x \le \sqrt{\alpha}\}$。将这条线段投影到 $x$ 轴上，我们就得到了闭区间 $[-\sqrt{\alpha}, \sqrt{\alpha}]$，这正是 $f(x)=x^2$ 的 $\alpha$-[下水平集](@entry_id:636882)。

#### 构建函数：逐点最大化

上境图的一个强大之处在于它简化了某些函数运算的分析。考虑两个函数 $f_1, f_2$，并定义一个新函数 $h(\mathbf{x}) = \max(f_1(\mathbf{x}), f_2(\mathbf{x}))$。那么 $h$ 的上境图与 $f_1, f_2$ 的上境图有何关系？

答案是：**逐点最大化函数的上境图是原函数上境图的交集** 。
$$ \text{epi}(h) = \text{epi}(\max(f_1, f_2)) = \text{epi}(f_1) \cap \text{epi}(f_2) $$
证明过程非常直观：一个点 $(\mathbf{x}, y)$ 位于 $h$ 的上境图中，当且仅当 $y \ge h(\mathbf{x}) = \max(f_1(\mathbf{x}), f_2(\mathbf{x}))$。这等价于 $y \ge f_1(\mathbf{x})$ **并且** $y \ge f_2(\mathbf{x})$ 同时成立。前者意味着 $(\mathbf{x}, y) \in \text{epi}(f_1)$，后者意味着 $(\mathbf{x}, y) \in \text{epi}(f_2)$。因此，$(\mathbf{x}, y)$ 必须同时属于两个上境图，即属于它们的交集。

这个性质有一个重要的推论：由于任意[凸集](@entry_id:155617)的交集仍然是[凸集](@entry_id:155617)，如果 $f_1$ 和 $f_2$ 都是凸函数，那么它们的上境图都是凸集。其交集 $\text{epi}(h)$ 也是一个[凸集](@entry_id:155617)。根据上境图判据，这意味着函数 $h$ 本身也是一个[凸函数](@entry_id:143075)。这为我们从已知的简单凸函数出发，通过取逐点最大值来构造更复杂的[凸函数](@entry_id:143075)提供了一种系统性的方法。

#### 最优解的存在性：强制性与紧致性

在[优化问题](@entry_id:266749)中，一个基本问题是：一个最优解是否存在？**强制性 (coercivity)** 函数的概念，结合[下水平集](@entry_id:636882)的性质，为我们解答这个问题提供了强有力的工具。

一个[连续函数](@entry_id:137361) $f: \mathbb{R}^n \to \mathbb{R}$ 被称为**强制的**，如果当其输入 $\mathbf{x}$ 的范数 $\|\mathbf{x}\|$ 趋向于无穷大时，其函数值 $f(\mathbf{x})$ 也趋向于无穷大。形式上，$\lim_{\|\mathbf{x}\| \to \infty} f(\mathbf{x}) = \infty$。

强制性有一个关键的拓扑推论：**对于一个连续的[强制函数](@entry_id:146284)，其所有非空的[下水平集](@entry_id:636882)都是紧集 (compact sets)** 。

一个集合在 $\mathbb{R}^n$ 中是紧集，当且仅当它既是**[闭集](@entry_id:136446) (closed)** 又是**[有界集](@entry_id:157754) (bounded)**（Heine-Borel 定理）。我们可以证明[强制函数](@entry_id:146284)的[下水平集](@entry_id:636882)同时满足这两个条件：
1.  **闭合性**：由于 $f$ 是[连续函数](@entry_id:137361)，而区间 $(-\infty, \alpha]$ 是 $\mathbb{R}$ 中的[闭集](@entry_id:136446)，那么其原像 $S_\alpha = f^{-1}((-\infty, \alpha])$ 在 $\mathbb{R}^n$ 中也必然是[闭集](@entry_id:136446)。
2.  **有界性**：我们可以用反证法证明。假设某个非空[下水平集](@entry_id:636882) $S_\alpha$ 是无界的。那么我们可以从中找到一个点序列 $\{\mathbf{x}_k\}$，使得 $\|\mathbf{x}_k\| \to \infty$。根据函数的强制性，必然有 $f(\mathbf{x}_k) \to \infty$。但是，由于所有 $\mathbf{x}_k$ 都属于 $S_\alpha$，它们必须满足 $f(\mathbf{x}_k) \le \alpha$。这两个结论相互矛盾。因此，初始假设错误， $S_\alpha$ 必须是有界的。

[下水平集](@entry_id:636882)的紧致性是[优化理论](@entry_id:144639)中的一个里程碑。根据[极值定理](@entry_id:142794)（Extreme Value Theorem），任何在[紧集](@entry_id:147575)上定义的[连续函数](@entry_id:137361)都必将在这个集合上达到其最小值。当我们试图最小化一个连续[强制函数](@entry_id:146284) $f$ 时，我们可以将搜索范围限制在任意一个非空的（因此是紧的）[下水平集](@entry_id:636882)内。[极值定理](@entry_id:142794)保证了在这个紧集内必然存在一个[最小值点](@entry_id:634980)，这个点也就是函数 $f$ 在整个 $\mathbb{R}^n$ 上的全局最小值点。这为许多[无约束优化](@entry_id:137083)问题解的存在性提供了坚实的理论基础。