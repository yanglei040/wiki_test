{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握计算机如何处理实数，从头开始理解其编码过程至关重要。第一个练习让你扮演一名设计定制浮点格式的工程师，任务是将一个熟悉的十进制数转换为其二进制表示。这项实践将巩固你对符号、偏置指数和分数域等核心概念的理解。",
            "id": "1937489",
            "problem": "一个工程师团队正在为一款嵌入式物联网（IoT）设备开发专用处理器。为了最小化功耗和电路复杂性，他们设计了一种自定义的10位浮点数格式来表示传感器读数。该格式遵循以下结构：\n- 1位用于符号（S），其中S=0表示正数，S=1表示负数。\n- 4位用于偏置阶码（E）。阶码偏置值为7。\n- 5位用于尾数（F）。\n\n规格化数的值通过公式 $V = (-1)^{S} \\times (1.F)_2 \\times 2^{(E-7)}$ 进行解释，其中 $(1.F)_2$ 表示带有隐藏前导“1”的有效数。完整的10位字结构为：符号位在前，然后是阶码位，最后是尾数位，顺序为 `S EEEE FFFFF`。\n\n设备上的一个温度传感器返回了等效于十进制值-13.5的读数。在该自定义格式下，这个值的正确10位二进制表示是什么？\n\nA. 1101010110\n\nB. 0101010110\n\nC. 1101111011\n\nD. 1101001011\n\nE. 1100110110",
            "solution": "我们给定一个自定义的10位浮点数格式，其字段包括：符号 $S$（1位）、带偏置值7的阶码 $E$（4位）和尾数 $F$（5位）。对于规格化数，其值为\n$$\nV = (-1)^{S} (1.F)_{2} 2^{(E-7)}.\n$$\n我们需要对 $V=-13.5$ 进行编码。\n\n步骤1：确定符号位。\n因为该值为负数，所以符号位是\n$$\nS=1.\n$$\n\n步骤2：将绝对值转换为二进制并进行规格化。\n其绝对值为 $13.5$。用二进制表示，\n$$\n13.5 = 1101.1_{2}.\n$$\n规格化为 $(1.F)_{2} 2^{e}$ 的形式：\n$$\n1101.1_{2} = 1.1011_{2} \\times 2^{3}.\n$$\n因此，未偏置的指数为\n$$\ne = 3.\n$$\n\n步骤3：计算偏置后的阶码并将其编码为4位。\n偏置值为 $7$，所以存储的阶码是\n$$\nE = e + 7 = 3 + 7 = 10.\n$$\n用4位二进制表示，$10$ 是\n$$\nE = 1010.\n$$\n\n步骤4：确定5位的尾数部分。\n从规格化有效数 $1.1011_{2}$ 可知，尾数（小数点后的部分）是 $1011$。我们需要5位尾数位；因为 $13.5$ 可以被精确表示，我们追加一个后缀零：\n$$\nF = 10110.\n$$\n\n步骤5：按 $S\\,EEEE\\,FFFFF$ 的顺序拼接字段。\n当 $S=1$，$E=1010$，$F=10110$ 时，这个10位字是\n$$\n1\\,1010\\,10110 \\;\\Rightarrow\\; 1101010110.\n$$\n\n这与选项A匹配。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然自定义格式有助于学习，但大多数现实世界的计算都依赖于 IEEE 754 标准。人们可能想当然地认为这种强大的格式可以精确表示所有整数，但事实并非如此。这个问题将挑战你去发现一个令人惊讶的精度边界，找出无法用标准单精度浮点数完美存储的最小正整数。",
            "id": "2173582",
            "problem": "在现代计算中，实数通常使用浮点表示法来近似。其中一个广泛采用的标准是电气和电子工程师协会（IEEE）的 754 标准。该标准下的单精度格式使用 32 位来表示一个数字。\n\n这 32 位的分配如下：\n- 1 位用于符号（$s$）。\n- 8 位用于偏置指数（$E$）。\n- 23 位用于小数部分（$f$）。\n\n对于一个正的规格化数（符号位 $s=0$），其值 $V$ 由以下公式确定：\n$$V = 2^{E-127} \\times (1.f)_2$$\n在这里，$127$ 是指数偏置量。项 $(1.f)_2$ 表示二进制的有效数，其中 ‘1.’ 是一个不被存储的隐含前导位，$f$ 是存储在小数位中的 23 位二进制小数。对于规格化数，偏置指数 $E$ 的范围可以从 1 到 254。\n\n虽然这种格式可以表示极大范围的数字，但其有限的精度意味着并非所有数字都能被精确表示。在考虑整数时，这个限制尤其有趣。例如，整数 5 可以写成 $1.25 \\times 4 = (1.01)_2 \\times 2^2$。这对应于小数部分 $f=0100...0$ 和一个产生 2 的幂的指数部分，因此 5 是可以精确表示的。\n\n你的任务是找出无法用 IEEE 754 单精度浮点格式精确表示的最小正整数。",
            "solution": "一个规格化的单精度值具有以下形式\n$$V=2^{e}\\,(1.f)_{2},\\quad e=E-127,$$\n其中有效数有一个隐含的前导位加上 23 个存储的小数位，从而得到 $p=24$ 位的有效精度。将小数部分 $f$ 增加一个单位会使 $(1.f)_{2}$ 改变 $2^{-23}$，因此对于一个固定的指数 $e$，连续可表示数之间的间距（最后一个位置的单位，即 ulp）是\n$$\\mathrm{ulp}(e)=2^{e}\\cdot 2^{-23}=2^{e-23}.$$\n\n为了能精确表示某个区间内的每一个整数，那里的间距必须至多为 $1$。因此，我们要求\n$$\\mathrm{ulp}(e)\\leq 1 \\quad \\Longleftrightarrow \\quad 2^{e-23}\\leq 1 \\quad \\Longleftrightarrow \\quad e\\leq 23.$$\n区间 $[2^{23},\\,2^{24})$ 内的数具有 $e=23$，因此 $\\mathrm{ulp}=1$，所以该范围内的每个整数都是可以表示的。值 $2^{24}$ 本身作为一个 2 的幂，其有效数为 $(1.0)_{2}$ 且 $e=24$，也是可以精确表示的。\n\n对于下一个区间 $[2^{24},\\,2^{25})$，我们有 $e=24$，因此\n$$\\mathrm{ulp}(24)=2^{24-23}=2,$$\n所以在该区间内只有 $2$ 的倍数是可表示的。因此，这个区间内不能精确表示的最小整数是最小的奇数，即\n$$2^{24}+1.$$\n\n因为所有小于或等于 $2^{24}$ 的正整数都可以精确表示，而 $2^{24}+1$ 不能，所以无法用 IEEE 754 单精度格式精确表示的最小正整数是 $2^{24}+1$。",
            "answer": "$$\\boxed{16777217}$$"
        },
        {
            "introduction": "浮点数的有限性会导致计算过程中的舍入，使得其算术行为在某些情况下会违背我们的直觉。数学中的一个基本定律——加法结合律（即 $(A+B)+C = A+(B+C)$），在浮点计算的世界里并非总是成立。本练习将通过一个具体的例子，让你亲手验证这种非结合性，揭示了数值编程中的一个关键陷阱。",
            "id": "1937506",
            "problem": "考虑一个为简单嵌入式系统设计的自定义6位浮点数表示法。该格式使用1位作为符号位（S），3位作为指数（E），以及2位作为尾数（F）。各位的排列顺序为 S E E E F F。\n\n数值由以下规则确定：\n- 如果指数域 E 不全为0或全为1（即，对于 $1 \\leq E_{decimal} \\leq 6$），该数为规格化值，其值由 $V = (-1)^S \\times (1.F)_2 \\times 2^{E_{decimal} - 3}$ 给出。其中的 `3` 是指数偏置量。\n- 如果指数域 E 全为0，该数为非规格化值，其值由 $V = (-1)^S \\times (0.F)_2 \\times 2^{-2}$ 给出。零由所有位都为0来表示。\n- 如果指数域 E 全为1，该数表示无穷大（若 F=00）或非数值（NaN）（若 F 不为 00）。\n\n所有涉及这些数的算术运算都必须遵循以下流程：运算以完全精度执行，然后在进行任何后续运算之前，将结果舍入以适应6位格式。使用的舍入方案是“向最近偶数舍入”(round-to-nearest, ties-to-even)。\n\n给定三个以这种6位格式表示的数，$A$、$B$ 和 $C$：\n- $A = \\text{011010}$\n- $B = \\text{111010}$\n- $C = \\text{000100}$\n\n你的任务是演示浮点数加法的非结合性。首先，计算 $X = (A+B)+C$ 的结果。其次，计算 $Y = A+(B+C)$ 的结果。最后，计算它们的绝对差 $|X-Y|$。\n\n请将最终答案表示为一个十进制数。",
            "solution": "该6位格式使用 $S$（符号位）、$E$（带偏置量 $3$ 的3位指数）和 $F$（2位尾数）。对于规格化数（$1 \\leq E_{\\text{decimal}} \\leq 6$），其值为 $V = (-1)^{S}(1.F)_{2}2^{E_{\\text{decimal}}-3}$。对于非规格化数（$E=0$），其值为 $V = (-1)^{S}(0.F)_{2}2^{-2}$。算术运算先精确执行，然后在进行任何后续运算前，舍入到6位格式（向最近偶数舍入）。\n\n解码 $A=011010$。此处，$S=0$，$E=110$ 因此 $E_{\\text{decimal}}=6$，以及 $F=10$。这是一个规格化数，指数 $e=6-3=3$，有效数 $(1.F)_{2}=1+2^{-1}= \\frac{3}{2}$。因此\n$$\nA = \\frac{3}{2}\\cdot 2^{3} = 12.\n$$\n\n解码 $B=111010$。此处，$S=1$，$E=110$ 因此 $e=3$，$F=10$；所以 $B=-\\frac{3}{2}\\cdot 2^{3}=-12$。\n\n解码 $C=000100$。此处，$S=0$，$E=001$ 因此 $e=1-3=-2$，$F=00$；所以 $(1.F)_{2}=1$ 且\n$$\nC = 1\\cdot 2^{-2} = \\frac{1}{4}.\n$$\n\n计算 $X=(A+B)+C$，每次运算后进行舍入。\n首先，精确和为\n$$\nA+B = 12 + (-12) = 0,\n$$\n该值可以被精确表示，所以 $\\operatorname{round}(A+B)=0$。接下来，\n$$\n0 + C = \\frac{1}{4},\n$$\n并且 $\\frac{1}{4}$ 可以被精确表示（作为规格化数，其中 $E=001$，$F=00$），所以 $X=\\frac{1}{4}$。\n\n计算 $Y=A+(B+C)$，每次运算后进行舍入。\n首先，\n$$\nB+C = -12 + \\frac{1}{4} = -\\frac{47}{4} = -11.75.\n$$\n在指数 $e=3$ 时，最接近的可表示规格化值的形式为 $(1+\\frac{q}{4})2^{3}$，其中 $q\\in\\{0,1,2,3\\}$，即量值为 $8,10,12,14$，当为负数时，这些值为 $\\{-14,-12,-10,-8\\}$。其距离分别为\n$$\n\\left|-\\frac{47}{4}-(-12)\\right|=\\frac{1}{4},\\quad \\left|-\\frac{47}{4}-(-10)\\right|=\\frac{7}{4},\n$$\n所以根据向最近值舍入规则（非平局情况），$\\operatorname{round}(B+C)=-12$。然后\n$$\nA+(-12) = 12+(-12)=0,\n$$\n该值可以被精确表示，所以 $Y=0$。\n\n最后，\n$$\n|X-Y| = \\left|\\frac{1}{4}-0\\right| = \\frac{1}{4} = 0.25.\n$$",
            "answer": "$$\\boxed{0.25}$$"
        }
    ]
}