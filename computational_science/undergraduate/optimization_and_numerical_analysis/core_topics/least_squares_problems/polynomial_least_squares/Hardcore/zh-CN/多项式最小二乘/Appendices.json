{
    "hands_on_practices": [
        {
            "introduction": "理论是灰色的，而实践之树常青。让我们从一个最基本也是最常见的场景开始：线性拟合。这个练习将带你亲手应用最小二乘法，为一个模拟物理实验的数据找到最佳拟合直线，就像在验证胡克定律一样。通过从头开始建立并求解正规方程组 ，你将牢固掌握最小二乘法的核心计算过程。",
            "id": "2194103",
            "problem": "在一个验证胡克定律的物理实验室实验中，一名学生测量了弹簧在不同外力作用下的位移。该学生使用线性方程 $F(x) = kx + F_0$ 来模拟所施加的力 $F$ 与产生的位移 $x$ 之间的关系，其中 $k$ 是弹簧常数，$F_0$ 是由于预加载或测量零点误差可能产生的力偏移。\n\n收集了以下五个数据点 $(x_i, F_i)$，其中位移 $x$ 的单位是米 (m)，力 $F$ 的单位是牛顿 (N)：\n$$ (0.10, 16.0), \\ (0.20, 30.0), \\ (0.30, 46.0), \\ (0.40, 61.5), \\ (0.50, 74.0) $$\n\n使用最小二乘法，确定弹簧常数 $k$ 和力偏移 $F_0$ 的最佳拟合值。报告弹簧常数 $k$ 的值（单位 N/m）和力偏移 $F_0$ 的值（单位 N）。将你的两个最终答案四舍五入到三位有效数字。",
            "solution": "问题要求为一组给定的五个数据点 $(x_i, F_i)$ 找到形式为 $F(x) = kx + F_0$ 的最佳拟合线。最小二乘法旨在最小化残差平方和 $S$，即观测到的力值 $F_i$ 与线性模型预测值 $F(x_i)$ 之差的平方和。\n\n需要最小化的函数是：\n$$ S(k, F_0) = \\sum_{i=1}^{5} (F_i - (kx_i + F_0))^2 $$\n\n为了找到使 $S$ 最小化的 $k$ 和 $F_0$ 的值，我们对 $S$ 分别求关于 $k$ 和 $F_0$ 的偏导数，并令它们为零。\n\n关于 $k$ 的偏导数是：\n$$ \\frac{\\partial S}{\\partial k} = \\sum_{i=1}^{5} 2(F_i - kx_i - F_0)(-x_i) = -2 \\left( \\sum_{i=1}^{5} x_i F_i - k \\sum_{i=1}^{5} x_i^2 - F_0 \\sum_{i=1}^{5} x_i \\right) = 0 $$\n这简化为第一个正规方程：\n$$ k \\left( \\sum_{i=1}^{5} x_i^2 \\right) + F_0 \\left( \\sum_{i=1}^{5} x_i \\right) = \\sum_{i=1}^{5} x_i F_i $$\n\n关于 $F_0$ 的偏导数是：\n$$ \\frac{\\partial S}{\\partial F_0} = \\sum_{i=1}^{5} 2(F_i - kx_i - F_0)(-1) = -2 \\left( \\sum_{i=1}^{5} F_i - k \\sum_{i=1}^{5} x_i - F_0 \\sum_{i=1}^{5} 1 \\right) = 0 $$\n这简化为第二个正规方程，其中 $n=5$ 是数据点的数量：\n$$ k \\left( \\sum_{i=1}^{5} x_i \\right) + n F_0 = \\sum_{i=1}^{5} F_i $$\n\n现在，我们根据给定的数据计算所需的总和：\n$(x_1, F_1) = (0.10, 16.0)$，$(x_2, F_2) = (0.20, 30.0)$，$(x_3, F_3) = (0.30, 46.0)$，$(x_4, F_4) = (0.40, 61.5)$，$(x_5, F_5) = (0.50, 74.0)$。\n\n$$ \\sum_{i=1}^{5} x_i = 0.10 + 0.20 + 0.30 + 0.40 + 0.50 = 1.50 $$\n$$ \\sum_{i=1}^{5} F_i = 16.0 + 30.0 + 46.0 + 61.5 + 74.0 = 227.5 $$\n$$ \\sum_{i=1}^{5} x_i^2 = (0.10)^2 + (0.20)^2 + (0.30)^2 + (0.40)^2 + (0.50)^2 = 0.01 + 0.04 + 0.09 + 0.16 + 0.25 = 0.55 $$\n$$ \\sum_{i=1}^{5} x_i F_i = (0.10)(16.0) + (0.20)(30.0) + (0.30)(46.0) + (0.40)(61.5) + (0.50)(74.0) $$\n$$ \\sum_{i=1}^{5} x_i F_i = 1.6 + 6.0 + 13.8 + 24.6 + 37.0 = 83.0 $$\n\n正规方程组的矩阵形式是：\n$$ \\begin{pmatrix} \\sum x_i^2  \\sum x_i \\\\ \\sum x_i  n \\end{pmatrix} \\begin{pmatrix} k \\\\ F_0 \\end{pmatrix} = \\begin{pmatrix} \\sum x_i F_i \\\\ \\sum F_i \\end{pmatrix} $$\n\n代入计算出的值：\n$$ \\begin{pmatrix} 0.55  1.50 \\\\ 1.50  5 \\end{pmatrix} \\begin{pmatrix} k \\\\ F_0 \\end{pmatrix} = \\begin{pmatrix} 83.0 \\\\ 227.5 \\end{pmatrix} $$\n\n我们可以求解这个 2x2 方程组来得到 $k$ 和 $F_0$。我们将使用矩阵求逆法。设矩阵为 $M$。\n$$ M = \\begin{pmatrix} 0.55  1.50 \\\\ 1.50  5 \\end{pmatrix} $$\n$M$ 的行列式是：\n$$ \\det(M) = (0.55)(5) - (1.50)(1.50) = 2.75 - 2.25 = 0.50 $$\n$M$ 的逆矩阵是：\n$$ M^{-1} = \\frac{1}{\\det(M)} \\begin{pmatrix} 5  -1.50 \\\\ -1.50  0.55 \\end{pmatrix} = \\frac{1}{0.50} \\begin{pmatrix} 5  -1.50 \\\\ -1.50  0.55 \\end{pmatrix} = \\begin{pmatrix} 10  -3 \\\\ -3  1.1 \\end{pmatrix} $$\n\n现在，求解系数向量：\n$$ \\begin{pmatrix} k \\\\ F_0 \\end{pmatrix} = M^{-1} \\begin{pmatrix} 83.0 \\\\ 227.5 \\end{pmatrix} = \\begin{pmatrix} 10  -3 \\\\ -3  1.1 \\end{pmatrix} \\begin{pmatrix} 83.0 \\\\ 227.5 \\end{pmatrix} $$\n\n计算 $k$：\n$$ k = (10)(83.0) - (3)(227.5) = 830 - 682.5 = 147.5 $$\n\n计算 $F_0$：\n$$ F_0 = (-3)(83.0) + (1.1)(227.5) = -249 + 250.25 = 1.25 $$\n\n因此，弹簧常数为 $k = 147.5$ N/m，力偏移为 $F_0 = 1.25$ N。\n\n问题要求将两个值都四舍五入到三位有效数字。\n$k = 147.5$ 四舍五入为 $148$。\n$F_0 = 1.25$ 已经是三位有效数字。\n\n最终答案是 $k = 148$ N/m 和 $F_0 = 1.25$ N。",
            "answer": "$$\\boxed{\\begin{pmatrix} 148  1.25 \\end{pmatrix}}$$"
        },
        {
            "introduction": "掌握了直线拟合后，我们自然会想，如何拟合更复杂的曲线？这个练习将难度提升到二次多项式拟合。然而，它也暗含了一个更深层次的问题：最小二乘法总能找到一个数学上的“最佳”解，但这个模型是否真的适合描述数据背后的物理规律 ？通过这个练习，你不仅能学会拟合高次多项式，还能开始思考模型选择和残差分析的重要性。",
            "id": "2194121",
            "problem": "一位工程师正在分析来自一个简谐振子的传感器数据。在一个特定的时间区间内，记录了在时间 $x$ 测得的位移 $y$。采集到的五个数据点 $(x_i, y_i)$ 为：$(0, 0)$、$(0.5, 1)$、$(1, 0)$、$(1.5, -1)$ 和 $(2, 0)$。为了创建一个简单的经验模型，该工程师决定使用最小二乘法将一个形如 $P(x) = c_0 + c_1 x + c_2 x^2$ 的二次多项式拟合到这些数据上。确定残差平方和 $S = \\sum_{i=1}^{5} (y_i - P(x_i))^2$ 的最小可能值。将最终答案四舍五入至三位有效数字。",
            "solution": "我们使用最小二乘法将 $P(x)=c_{0}+c_{1}x+c_{2}x^{2}$ 拟合到数据 $(x_{i},y_{i})$（$i=1,\\dots,5$）上。设 $A$ 为设计矩阵，其各行为 $[1, x_{i}, x_{i}^{2}]$，$y$ 为观测值 $y_{i}$ 构成的向量。正规方程组为\n$$\n(A^{\\mathsf{T}}A)\\mathbf{c}=A^{\\mathsf{T}}\\mathbf{y},\n$$\n其求和形式为\n$$\n\\begin{aligned}\nS_{0}c_{0}+S_{1}c_{1}+S_{2}c_{2}=T_{0},\\\\\nS_{1}c_{0}+S_{2}c_{1}+S_{3}c_{2}=T_{1},\\\\\nS_{2}c_{0}+S_{3}c_{1}+S_{4}c_{2}=T_{2},\n\\end{aligned}\n$$\n其中 $S_{k}=\\sum_{i=1}^{5}x_{i}^{k}$ 且 $T_{k}=\\sum_{i=1}^{5}x_{i}^{k}y_{i}$。对于数据 $x \\in \\{0,\\frac{1}{2},1,\\frac{3}{2},2\\}$ 和 $y \\in \\{0,1,0,-1,0\\}$，计算\n$$\n\\begin{aligned}\nS_{0}=5,\\quad S_{1}=5,\\quad S_{2}=\\frac{15}{2},\\quad S_{3}=\\frac{25}{2},\\quad S_{4}=\\frac{177}{8},\\\\\nT_{0}=0,\\quad T_{1}=-1,\\quad T_{2}=-2.\n\\end{aligned}\n$$\n因此\n$$\n\\begin{bmatrix}\n5  5  \\frac{15}{2}\\\\\n5  \\frac{15}{2}  \\frac{25}{2}\\\\\n\\frac{15}{2}  \\frac{25}{2}  \\frac{177}{8}\n\\end{bmatrix}\n\\begin{bmatrix}c_{0}\\\\ c_{1}\\\\ c_{2}\\end{bmatrix}\n=\n\\begin{bmatrix}0\\\\ -1\\\\ -2\\end{bmatrix}.\n$$\n两边乘以 $8$ 以消去分母，并通过消元法求解，得到 $c_{2}=0$，$c_{1}=-\\frac{2}{5}$，$c_{0}=\\frac{2}{5}$。因此，最小二乘拟合多项式为 $P(x)=\\frac{2}{5}-\\frac{2}{5}x$。\n\n最小残差平方和为\n$$\nS_{\\min}=\\sum_{i=1}^{5}\\left(y_{i}-P(x_{i})\\right)^{2}.\n$$\n在五个点上计算：\n$$\n\\begin{aligned}\nx=0:\\quad r=0-\\frac{2}{5}=-\\frac{2}{5}, r^{2}=\\frac{4}{25},\\\\\nx=\\frac{1}{2}:\\quad r=1-\\frac{1}{5}=\\frac{4}{5}, r^{2}=\\frac{16}{25},\\\\\nx=1:\\quad r=0-0=0, r^{2}=0,\\\\\nx=\\frac{3}{2}:\\quad r=-1-(-\\frac{1}{5})=-\\frac{4}{5}, r^{2}=\\frac{16}{25},\\\\\nx=2:\\quad r=0-(-\\frac{2}{5})=\\frac{2}{5}, r^{2}=\\frac{4}{25}.\n\\end{aligned}\n$$\n因此\n$$\nS_{\\min}=\\frac{4}{25}+\\frac{16}{25}+0+\\frac{16}{25}+\\frac{4}{25}=\\frac{40}{25}=\\frac{8}{5}=1.6.\n$$\n四舍五入到三位有效数字，结果为 $1.60$。",
            "answer": "$$\\boxed{1.60}$$"
        },
        {
            "introduction": "在现实世界的数据分析中，我们很少事先知道哪个多项式模型是“正确”的。选择过于简单的模型会导致欠拟合，而过于复杂的模型则会过拟合。这个练习将你置于一个典型工程问题的场景中，教你使用一种强大的技术——验证集——来选择最优的多项式次数 。这是从“如何拟合”到“拟合哪个最好”的关键一步，是避免过拟合、提升模型泛化能力的核心实践。",
            "id": "2194119",
            "problem": "一个工程团队正在对一种新型无源电子元件进行特性分析，该元件的电阻是外部控制参数的函数。为了建立这种行为的预测模型，他们收集了一组实验数据点，其中 $x$ 是控制参数的值（单位任意），$y$ 是测量的电阻值（单位为欧姆）。\n\n该团队希望使用多项式函数 $P_d(x) = \\sum_{j=0}^{d} c_j x^j$ 来模拟这种关系，其中 $d$ 是多项式的阶数。为避免过拟合，他们将数据分为训练集和验证集。对于给定的阶数 $d$，模型系数 $c_j$ 将通过对训练数据进行最小二乘拟合来确定。然后，选择在独立的验证数据上使预测误差最小化的阶数 $d$ 作为最佳阶数。\n\n误差使用均方根误差 (RMSE) 进行量化，其定义为 $E_{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}$，其中 $y_i$ 是真实的测量值，$\\hat{y}_i$ 是模型对 $n$ 个数据点的预测值。\n\n收集到的数据如下：\n- **训练集**：$(0, 5.6)$, $(1, 3.1)$, $(2, 1.4)$, $(4, 1.6)$, $(5, 2.9)$, $(6, 5.7)$\n- **验证集**：$(0.5, 4.2)$, $(2.5, 1.0)$, $(3.5, 1.2)$, $(5.5, 4.0)$\n\n您的任务是从候选集合 $\\{1, 2, 3\\}$ 中确定最佳的多项式阶数 $d$，该阶数通过最小化验证集上的均方根误差 (RMSE) 来最佳地模拟该元件的行为。\n\n以下哪个是最佳的多项式阶数？\nA. $d=1$\nB. $d=2$\nC. $d=3$\nD. 三个阶数得到的验证集均方根误差值在两位有效数字内相等。",
            "solution": "我们用多项式 $P_{d}(x)=\\sum_{j=0}^{d}c_{j}x^{j}$ 对 $y$ 进行建模，该多项式通过对训练集进行最小二乘拟合得到，然后我们选择使验证集均方根误差 (RMSE) 最小的 $d\\in\\{1,2,3\\}$。因为 $\\sqrt{\\cdot}$ 是严格递增的，所以最小化均方根误差 (RMSE) 等价于最小化均方误差 (MSE)，即验证集上残差平方的平均值。\n\n训练数据（转换为精确分数）：$(0,\\frac{28}{5}), (1,\\frac{31}{10}), (2,\\frac{7}{5}), (4,\\frac{8}{5}), (5,\\frac{29}{10}), (6,\\frac{57}{10})$。\n验证数据：$(\\frac{1}{2},\\frac{21}{5}), (\\frac{5}{2},1), (\\frac{7}{2},\\frac{6}{5}), (\\frac{11}{2},4)$。\n\n阶数 $d=1$（线性）：$P_{1}(x)=a+bx$。使用正规方程组公式\n$$\nb=\\frac{n\\sum x_{i}y_{i}-(\\sum x_{i})(\\sum y_{i})}{n\\sum x_{i}^{2}-(\\sum x_{i})^{2}}\n$$\n$$\na=\\frac{\\sum y_{i}-b\\sum x_{i}}{n}\n$$\n其中 $n=6$, $\\sum x_{i}=18$, $\\sum y_{i}=\\frac{203}{10}$, $\\sum x_{i}^{2}=82$, $\\sum x_{i}y_{i}=61$，我们得到\n$$\nb=\\frac{6\\cdot 61-18\\cdot \\frac{203}{10}}{6\\cdot 82-18^{2}}=\\frac{1}{280},\\quad\na=\\frac{\\frac{203}{10}-\\frac{1}{280}\\cdot 18}{6}=\\frac{2833}{840}.\n$$\n因此 $P_{1}(x)=\\frac{2833}{840}+\\frac{1}{280}x$。验证集的预测值和残差 $r_{i}=y_{i}-\\hat{y}_{i}$ 如下：\n- $x=\\frac{1}{2}$ 时：$\\hat{y}=\\frac{5669}{1680}$，$r=\\frac{21}{5}-\\frac{5669}{1680}=\\frac{1387}{1680}$。\n- $x=\\frac{5}{2}$ 时：$\\hat{y}=\\frac{5681}{1680}$，$r=1-\\frac{5681}{1680}=-\\frac{4001}{1680}$。\n- $x=\\frac{7}{2}$ 时：$\\hat{y}=\\frac{5687}{1680}$，$r=\\frac{6}{5}-\\frac{5687}{1680}=-\\frac{3671}{1680}$。\n- $x=\\frac{11}{2}$ 时：$\\hat{y}=\\frac{5699}{1680}$，$r=4-\\frac{5699}{1680}=\\frac{1021}{1680}$。\n残差平方和：$\\sum r_{i}^{2}=\\frac{32{,}450{,}452}{1680^{2}}$。因此\n$$\n\\text{MSE}_{1}=\\frac{1}{4}\\sum r_{i}^{2}=\\frac{32{,}450{,}452}{4\\cdot 1680^{2}}=\\frac{32{,}450{,}452}{11{,}289{,}600}.\n$$\n\n阶数 $d=2$（二次）：$P_{2}(x)=c_{0}+c_{1}x+c_{2}x^{2}$。使用和 $\\sum x^{k}$ 和 $\\sum x^{k}y$（来自训练集 $x\\in\\{0,1,2,4,5,6\\}$）的正规方程组为\n$$\n\\begin{aligned}\n6c_{0}+18c_{1}+82c_{2}=\\frac{203}{10},\\\\\n18c_{0}+82c_{1}+414c_{2}=61,\\\\\n82c_{0}+414c_{1}+2194c_{2}=312.\n\\end{aligned}\n$$\n求解得到\n$$\nc_{2}=\\frac{1019}{1960},\\quad c_{1}=-\\frac{6107}{1960},\\quad\nc_{0}=\\frac{5513}{980}.\n$$\n因此 $P_{2}(x)=\\frac{5513}{980}-\\frac{6107}{1960}x+\\frac{1019}{1960}x^{2}$，等价于\n$$\n\\hat{y}(x)=\\frac{11026-6107\\,x+1019\\,x^{2}}{1960}.\n$$\n验证集的预测值和残差如下：\n- $x=\\frac{1}{2}$ 时：$\\hat{y}=\\frac{32909}{7840}$，$r=\\frac{21}{5}-\\hat{y}=\\frac{19}{7840}$。\n- $x=\\frac{5}{2}$ 时：$\\hat{y}=\\frac{8509}{7840}$，$r=1-\\hat{y}=-\\frac{669}{7840}$。\n- $x=\\frac{7}{2}$ 时：$\\hat{y}=\\frac{8537}{7840}$，$r=\\frac{6}{5}-\\hat{y}=\\frac{871}{7840}$。\n- $x=\\frac{11}{2}$ 时：$\\hat{y}=\\frac{33049}{7840}$，$r=4-\\hat{y}=-\\frac{1689}{7840}$。\n残差平方和：$\\sum r_{i}^{2}=\\frac{4{,}059{,}284}{7840^{2}}$。因此\n$$\n\\text{MSE}_{2}=\\frac{1}{4}\\sum r_{i}^{2}=\\frac{4{,}059{,}284}{4\\cdot 7{,}840^{2}}=\\frac{4{,}059{,}284}{245{,}862{,}400}.\n$$\n\n阶数 $d=3$（三次）：$P_{3}(x)=c_{0}+c_{1}x+c_{2}x^{2}+c_{3}x^{3}$。对训练集的 $x$ 值，使用截至 $\\sum x^{6}$ 的和以及截至 $k=3$ 的 $\\sum x^{k}y$，得到并求解正规方程组，可得系数\n$$\nc_{3}=\\frac{1}{360},\\quad c_{2}=\\frac{97}{196}, \\quad c_{1}=-\\frac{53983}{17640},\\quad c_{0}=\\frac{1649}{294}.\n$$\n因此 $P_{3}(x)=\\frac{1649}{294}-\\frac{53983}{17640}x+\\frac{97}{196}x^{2}+\\frac{1}{360}x^{3}$。验证集的残差（公分母为 $141{,}120$）为：\n$$\nr_{1}=-\\frac{393}{141120},\\quad r_{2}=-\\frac{13365}{141120},\\quad r_{3}=\\frac{17001}{141120},\\quad r_{4}=-\\frac{29667}{141120}.\n$$\n残差平方和：$\\sum r_{i}^{2}=\\frac{1{,}347{,}942{,}564}{141{,}120^{2}}$。因此\n$$\n\\text{MSE}_{3}=\\frac{1}{4}\\sum r_{i}^{2}=\\frac{1{,}347{,}942{,}564}{4\\cdot 141{,}120^{2}}=\\frac{1{,}347{,}942{,}564}{79{,}659{,}417{,}600}.\n$$\n\n验证误差比较：为了精确比较 $\\text{MSE}_{2}$ 和 $\\text{MSE}_{3}$，注意到 $141{,}120=18\\cdot 7{,}840$，所以将 $\\text{MSE}_{2}$ 的分子乘以 $18^{2}=324$ 以匹配分母：\n$$\n324\\cdot 4{,}059{,}284=1{,}315{,}208{,}016  1{,}347{,}942{,}564\n$$\n因此 $\\text{MSE}_{2}  \\text{MSE}_{3}$。同时，$\\text{MSE}_{1}=\\frac{32{,}450{,}452}{11{,}289{,}600} \\approx 2.87$ 远大于 $\\text{MSE}_{2} \\approx 0.0165$（因此 RMSE$_{1}\\gg$RMSE$_{2}$）。所以，在 $d\\in\\{1,2,3\\}$ 中，2次多项式产生了最小的验证集均方根误差。\n\n因此，最佳阶数为 $d=2$，对应选项 B。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}