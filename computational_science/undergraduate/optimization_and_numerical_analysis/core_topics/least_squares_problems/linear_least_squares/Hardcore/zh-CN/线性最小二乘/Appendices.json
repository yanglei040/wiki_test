{
    "hands_on_practices": [
        {
            "introduction": "我们从线性最小二乘法最经典的应用——数据拟合——开始。这个练习将指导你为一组实验数据点找到最佳拟合直线，这是一个在从物理学到经济学的各个领域中都至关重要的基本技能。通过手动推导和求解正规方程，你将牢固掌握最小二乘法的核心计算过程。",
            "id": "2142967",
            "problem": "一名材料科学专业的学生正在研究一种新合成的聚合物纤维的弹性特性。在一项实验中，该学生施加不同大小的拉伸力，并测量纤维产生的相应伸长量。力以一个标准化的无量纲单位来测量，记作 $x$，相应的伸长量以另一个无量纲单位来测量，记作 $y$。该学生收集了三个数据点 $(x, y)$：$(0, 1)$、$(1, 3)$ 和 $(2, 2)$。\n\n为了对材料在此范围内的行为进行建模，该学生希望用一个 $y = mx + c$ 形式的线性模型来拟合这些数据。参数 $m$（有效刚度）和 $c$（零力下的初始伸长量）将使用最小二乘法确定，该方法旨在找到一条使数据点到该直线的纵向距离平方和最小的直线。\n\n确定这条最佳拟合线的斜率 $m$ 和 y轴截距 $c$。按顺序给出 $m$ 和 $c$ 的值作为你的最终答案。请用精确分数表示你的结果。",
            "solution": "我们用 $y = mx + c$ 对数据进行建模，并通过最小化 $S(m,c) = \\sum_{i=1}^{n}\\left(y_{i} - (m x_{i} + c)\\right)^{2}$，用最小二乘法确定 $m$ 和 $c$。由 $\\partial S/\\partial m = 0$ 和 $\\partial S/\\partial c = 0$ 得到的正规方程组是\n$$\nm \\sum_{i=1}^{n} x_{i}^{2} + c \\sum_{i=1}^{n} x_{i} = \\sum_{i=1}^{n} x_{i} y_{i}, \\qquad\nm \\sum_{i=1}^{n} x_{i} + c\\, n = \\sum_{i=1}^{n} y_{i}.\n$$\n对于数据 $(x,y) = (0,1),(1,3),(2,2)$，我们有 $n=3$，$\\sum x_{i} = 0+1+2 = 3$，$\\sum y_{i} = 1+3+2 = 6$，$\\sum x_{i}^{2} = 0^{2}+1^{2}+2^{2} = 5$，以及 $\\sum x_{i} y_{i} = 0\\cdot 1 + 1\\cdot 3 + 2\\cdot 2 = 7$。将这些值代入正规方程组，得到\n$$\n5m + 3c = 7, \\qquad 3m + 3c = 6.\n$$\n用第一个方程减去第二个方程，得到 $2m = 1$，因此 $m = \\frac{1}{2}$。代入 $3m + 3c = 6$ 得到 $3\\left(\\frac{1}{2}\\right) + 3c = 6$，所以 $3c = \\frac{9}{2}$ 且 $c = \\frac{3}{2}$。这些是所要求的精确分数。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2}  \\frac{3}{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "仅仅找到模型参数是不够的；评估模型的拟合优度同样重要。此练习将模型从简单的直线扩展到二次多项式，并让你专注于计算最小二乘误差。掌握这项技能可以让你量化预测与实际观测值之间的差异，这是验证和比较不同模型的关键一步。",
            "id": "2185338",
            "problem": "一位工程专业的学生正在分析一个物体在非标准力场下的运动。该学生记录了物体在几个不同时间点 $t$ 的位置 $p$。测量数据以 $(t, p)$ 对的形式给出，分别为 (1 秒, 3 米), (2 秒, 10 米) 和 (3 秒, 20 米)。\n\n该学生提出了一个位置关于时间的理论模型：$p(t) = c_{1}t + c_{2}t^2$，其中 $c_1$ 和 $c_2$ 是未知常数。为了找到该模型的最佳拟合，该学生建立了一个超定线性系统 $A\\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。使用最小二乘法，该学生确定最优系数由向量 $\\hat{\\mathbf{x}} = \\begin{pmatrix} 53/38 \\\\ 67/38 \\end{pmatrix}$ 给出。\n\n您的任务是计算该模型的最小二乘误差，该误差定义为残差向量的欧几里得范数，即 $\\| \\mathbf{b} - A\\hat{\\mathbf{x}} \\|_2$。请将您的最终答案以米为单位表示，并四舍五入到四位有效数字。",
            "solution": "我们用数据 $(t,p)$ 在 $t=1,2,3$ 时对 $p(t)=c_{1}t+c_{2}t^{2}$ 进行建模。设计矩阵和观测向量分别为\n$$\nA=\\begin{pmatrix}\n1  1 \\\\\n2  4 \\\\\n3  9\n\\end{pmatrix},\\quad\n\\mathbf{b}=\\begin{pmatrix}\n3 \\\\ 10 \\\\ 20\n\\end{pmatrix}.\n$$\n利用最小二乘解 $\\hat{\\mathbf{x}}=\\begin{pmatrix} \\frac{53}{38} \\\\ \\frac{67}{38} \\end{pmatrix}$，残差为 $\\mathbf{r}=\\mathbf{b}-A\\hat{\\mathbf{x}}$。逐项计算 $A\\hat{\\mathbf{x}}$：\n$$\n(A\\hat{\\mathbf{x}})_{1}=1\\cdot \\frac{53}{38}+1\\cdot \\frac{67}{38}=\\frac{120}{38}=\\frac{60}{19},\\quad\n(A\\hat{\\mathbf{x}})_{2}=2\\cdot \\frac{53}{38}+4\\cdot \\frac{67}{38}=\\frac{374}{38}=\\frac{187}{19},\n$$\n$$\n(A\\hat{\\mathbf{x}})_{3}=3\\cdot \\frac{53}{38}+9\\cdot \\frac{67}{38}=\\frac{762}{38}=\\frac{381}{19}.\n$$\n因此\n$$\n\\mathbf{r}=\\begin{pmatrix}\n3-\\frac{60}{19} \\\\\n10-\\frac{187}{19} \\\\\n20-\\frac{381}{19}\n\\end{pmatrix}\n=\\begin{pmatrix}\n-\\frac{3}{19} \\\\\n\\frac{3}{19} \\\\\n-\\frac{1}{19}\n\\end{pmatrix}.\n$$\n最小二乘误差是欧几里得范数\n$$\n\\|\\mathbf{r}\\|_{2}=\\sqrt{\\left(-\\frac{3}{19}\\right)^{2}+\\left(\\frac{3}{19}\\right)^{2}+\\left(-\\frac{1}{19}\\right)^{2}}\n=\\frac{1}{19}\\sqrt{9+9+1}=\\frac{\\sqrt{19}}{19}=\\frac{1}{\\sqrt{19}}.\n$$\n转换为小数并四舍五入到四位有效数字，得到\n$$\n\\|\\mathbf{b}-A\\hat{\\mathbf{x}}\\|_{2}=\\frac{1}{\\sqrt{19}}\\approx 0.2294.\n$$\n该值的单位是米。",
            "answer": "$$\\boxed{0.2294}$$"
        },
        {
            "introduction": "线性最小二乘法的威力在解决现实世界的工程问题时得到了充分体现。在这个实践中，你将扮演信号处理工程师的角色，设计一个滤波器来消除音频信号中常见的 $60$ $\\mathrm{Hz}$ 电力线“嗡嗡声”。通过将问题转化为最小二乘拟合，你不仅会应用前面学到的知识，还会体验到如何利用数学工具解决实际的技术挑战。",
            "id": "2409659",
            "problem": "给定一个均匀采样的离散时间信号，其中可能包含频率为 $60$ $\\mathrm{Hz}$ 的强正弦干扰。对于一组采样时间 $\\{t_k\\}_{k=0}^{N-1}$，其中 $t_k = k / f_s$，采样率为 $f_s$（单位为 $\\mathrm{Hz}$），$N$ 为样本数，将干扰建模为\n$$\ny_k \\approx c_1 \\sin(\\omega t_k) + c_2 \\cos(\\omega t_k),\n$$\n其中 $\\omega = 2\\pi \\cdot 60$ $\\mathrm{rad/s}$，三角函数的角度单位为弧度。对于下述每个测试用例，确定系数 $c_1$ 和 $c_2$，使得\n$$\n\\sum_{k=0}^{N-1} \\left(y_k - c_1 \\sin(\\omega t_k) - c_2 \\cos(\\omega t_k)\\right)^2,\n$$\n最小化，然后从原始信号中减去拟合分量，形成残差序列\n$$\nr_k = y_k - \\left(c_1 \\sin(\\omega t_k) + c_2 \\cos(\\omega t_k)\\right).\n$$\n对于每个测试用例，计算残差的均方根 (RMS) 值，\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N}\\sum_{k=0}^{N-1} r_k^2}.\n$$\n\n使用以下测试套件，其中所有振幅均为无量纲，时间单位为 $\\mathrm{s}$，频率单位为 $\\mathrm{Hz}$，角频率单位为 $\\mathrm{rad/s}$：\n\n- 测试用例 $1$ (含干扰内容的一般情况)：\n  - $f_s = 8000$ $\\mathrm{Hz}$，$N = 4000$。对于 $k = 0,1,\\dots,N-1$，$t_k = k/f_s$ 且\n    $$\n    y_k = 0.7 \\sin(\\omega t_k + 1.0) + 0.2 \\sin(2\\pi \\cdot 5 \\, t_k) + 0.1 \\sin(2\\pi \\cdot 120 \\, t_k).\n    $$\n- 测试用例 $2$ (不存在 $60$ $\\mathrm{Hz}$ 分量)：\n  - $f_s = 44100$ $\\mathrm{Hz}$，$N = 2205$。对于 $k = 0,1,\\dots,N-1$，$t_k = k/f_s$ 且\n    $$\n    y_k = 0.3 \\cos(2\\pi \\cdot 440 \\, t_k) + 0.05 \\sin(2\\pi \\cdot 1000 \\, t_k).\n    $$\n- 测试用例 $3$ (数据最少且为纯交流声的边界情况)：\n  - $f_s = 1000$ $\\mathrm{Hz}$，$N = 2$。对于 $k = 0,1$，$t_k = k/f_s$ 且\n    $$\n    y_k = 1.5 \\sin(\\omega t_k + 0.3).\n    $$\n\n您的程序必须为每个测试用例计算减去上述定义的最佳拟合 $c_1 \\sin(\\omega t) + c_2 \\cos(\\omega t)$ 分量后的残差 RMS。最终输出必须是单行文本，包含三个 RMS 值，每个值四舍五入到六位小数，形式为用方括号括起来的逗号分隔列表。例如：\n$$\n[\\text{rms}_1,\\text{rms}_2,\\text{rms}_3].\n$$",
            "solution": "我们用线性代数的术语来形式化这个问题。对于单个测试用例，定义列向量\n$$\n\\mathbf{s} = \\begin{bmatrix} \\sin(\\omega t_0) \\\\ \\sin(\\omega t_1) \\\\ \\vdots \\\\ \\sin(\\omega t_{N-1}) \\end{bmatrix}, \\quad\n\\mathbf{c} = \\begin{bmatrix} \\cos(\\omega t_0) \\\\ \\cos(\\omega t_1) \\\\ \\vdots \\\\ \\cos(\\omega t_{N-1}) \\end{bmatrix}, \\quad\n\\mathbf{y} = \\begin{bmatrix} y_0 \\\\ y_1 \\\\ \\vdots \\\\ y_{N-1} \\end{bmatrix}.\n$$\n构建设计矩阵\n$$\n\\mathbf{A} = \\begin{bmatrix} \\mathbf{s}  \\mathbf{c} \\end{bmatrix} \\in \\mathbb{R}^{N \\times 2},\n$$\n并令参数向量为\n$$\n\\boldsymbol{\\theta} = \\begin{bmatrix} c_1 \\\\ c_2 \\end{bmatrix}.\n$$\n模型为 $\\mathbf{y} \\approx \\mathbf{A}\\boldsymbol{\\theta}$。我们寻求使残差平方和最小化的 $\\boldsymbol{\\theta}$\n$$\nJ(\\boldsymbol{\\theta}) = \\|\\mathbf{y} - \\mathbf{A}\\boldsymbol{\\theta}\\|_2^2 = (\\mathbf{y} - \\mathbf{A}\\boldsymbol{\\theta})^\\top (\\mathbf{y} - \\mathbf{A}\\boldsymbol{\\theta}).\n$$\n将关于 $\\boldsymbol{\\theta}$ 的梯度设为零，可得到正规方程\n$$\n\\nabla_{\\boldsymbol{\\theta}} J = -2 \\mathbf{A}^\\top \\mathbf{y} + 2 \\mathbf{A}^\\top \\mathbf{A} \\boldsymbol{\\theta} = \\mathbf{0}\n\\;\\;\\Rightarrow\\;\\;\n\\mathbf{A}^\\top \\mathbf{A} \\, \\boldsymbol{\\theta} = \\mathbf{A}^\\top \\mathbf{y}.\n$$\n当 $\\mathbf{A}$ 具有满列秩时，$\\mathbf{A}^\\top \\mathbf{A}$ 是对称正定且可逆的，唯一的最小化子是\n$$\n\\boldsymbol{\\theta}^\\star = (\\mathbf{A}^\\top \\mathbf{A})^{-1} \\mathbf{A}^\\top \\mathbf{y}.\n$$\n拟合的干扰为 $\\widehat{\\mathbf{y}} = \\mathbf{A}\\boldsymbol{\\theta}^\\star$，残差为 $\\mathbf{r} = \\mathbf{y} - \\widehat{\\mathbf{y}}$。残差的均方根 (RMS) 为\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N} \\sum_{k=0}^{N-1} r_k^2} = \\sqrt{\\frac{1}{N} \\mathbf{r}^\\top \\mathbf{r}}.\n$$\n\n应用于测试套件：\n- 在测试用例 $1$ 中，信号包含一个振幅为 $0.7$、相位为 $1.0$ $\\mathrm{rad}$ 的 $60$ $\\mathrm{Hz}$ 分量，以及在 $5$ $\\mathrm{Hz}$ 和 $120$ $\\mathrm{Hz}$ 的附加分量。最小二乘拟合将提取 $60$ $\\mathrm{Hz}$ 的部分，主要将 $5$ $\\mathrm{Hz}$ 和 $120$ $\\mathrm{Hz}$ 的内容留在残差中。计算出的 RMS 将反映这些剩余分量。\n- 在测试用例 $2$ 中，信号不含 $60$ $\\mathrm{Hz}$ 内容，因此最优系数应接近于零，残差 RMS 将几乎等于原始信号的 RMS (在有限窗口上，除了微小的数值投影效应外)。\n- 在测试用例 $3$ 中，$N=2$ 且存在纯 $60$ $\\mathrm{Hz}$ 正弦波，对于指定的采样时间，$\\mathbf{A}$ 的两列是线性无关的，因此双参数模型可以精确匹配这两个样本，产生零残差，从而得到零 RMS (在数值精度范围内)。\n\n每个用例的算法步骤：\n1. 对于 $k = 0,1,\\dots,N-1$，构建 $t_k = k/f_s$ 并计算 $\\omega = 2\\pi \\cdot 60$ $\\mathrm{rad/s}$。\n2. 用 $\\sin(\\omega t_k)$ 和 $\\cos(\\omega t_k)$ 作为列来构建 $\\mathbf{A}$。\n3. 通过求解 $\\mathbf{A}^\\top \\mathbf{A} \\, \\boldsymbol{\\theta} = \\mathbf{A}^\\top \\mathbf{y}$ 来计算 $\\boldsymbol{\\theta}^\\star$。\n4. 计算残差 $\\mathbf{r} = \\mathbf{y} - \\mathbf{A}\\boldsymbol{\\theta}^\\star$ 及其 $\\mathrm{RMS}$。\n5. 将每个 $\\mathrm{RMS}$ 四舍五入到六位小数，并作为单个列表输出。\n\n这个过程直接源于通过正规方程定义的最小二乘最小化子，以及离散序列均方根的定义。",
            "answer": "$$[0.148807,0.213600,0.000000]$$"
        }
    ]
}