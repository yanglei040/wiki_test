{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering any numerical method is to apply it to a problem where the exact solution is known, which allows us to directly assess the method's accuracy. This exercise guides you through approximating the integral of $f(x) = \\frac{1}{x}$, a fundamental function in calculus. You will not only calculate the approximation but also compare the actual error against the theoretical error bound, providing a concrete understanding of the relationship between the numerical result and its guaranteed precision .",
            "id": "2210486",
            "problem": "A numerical analyst is studying the accuracy of the composite trapezoidal rule for approximating the definite integral $I = \\int_1^2 \\frac{1}{x} dx$. The approximation is performed using $n=4$ subintervals of equal width.\n\nThe exact value of the integral is known to be $I = \\ln(2)$. The theoretical error bound for the composite trapezoidal rule is given by the inequality $|E_T| \\le \\frac{M(b-a)^3}{12n^2}$, where $[a, b]$ is the interval of integration and $M$ is a constant such that $|f''(x)| \\le M$ for all $x$ in $[a, b]$.\n\nCalculate the difference between the theoretical maximum absolute error (the error bound, using the smallest possible value for $M$) and the actual absolute error of the approximation. For the purpose of this calculation, use the value $\\ln(2) \\approx 0.69314718$.\n\nExpress your final answer as a single real number rounded to six significant figures.",
            "solution": "We approximate $I=\\int_{1}^{2}\\frac{1}{x}\\,dx$ with the composite trapezoidal rule using $n=4$ subintervals. The step size is\n$$\nh=\\frac{b-a}{n}=\\frac{2-1}{4}=\\frac{1}{4}.\n$$\nThe nodes are $x_{0}=1$, $x_{1}=1+\\frac{1}{4}=\\frac{5}{4}$, $x_{2}=1+\\frac{2}{4}=\\frac{3}{2}$, $x_{3}=1+\\frac{3}{4}=\\frac{7}{4}$, $x_{4}=2$.\n\nThe composite trapezoidal approximation is\n$$\nT=\\frac{h}{2}\\left[f(x_{0})+2\\sum_{k=1}^{n-1}f(x_{k})+f(x_{n})\\right].\n$$\nWith $f(x)=\\frac{1}{x}$, we have\n$$\nf(x_{0})=1,\\quad f(x_{1})=\\frac{4}{5},\\quad f(x_{2})=\\frac{2}{3},\\quad f(x_{3})=\\frac{4}{7},\\quad f(x_{4})=\\frac{1}{2}.\n$$\nCompute the weighted sum:\n$$\nS=f(x_{0})+2\\big(f(x_{1})+f(x_{2})+f(x_{3})\\big)+f(x_{4})\n=1+2\\left(\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}\\right)+\\frac{1}{2}.\n$$\nWith common denominator $105$ inside the parentheses,\n$$\n\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}=\\frac{84+70+60}{105}=\\frac{214}{105},\n$$\nso\n$$\nS=1+2\\cdot\\frac{214}{105}+\\frac{1}{2}\n=1+\\frac{428}{105}+\\frac{1}{2}\n=\\frac{1171}{210}.\n$$\nThus\n$$\nT=\\frac{h}{2}S=\\frac{1/4}{2}\\cdot\\frac{1171}{210}=\\frac{1}{8}\\cdot\\frac{1171}{210}=\\frac{1171}{1680}.\n$$\nThe approximation is $T = \\frac{1171}{1680} \\approx 0.69702381$.\n\nUsing $\\ln(2)\\approx 0.69314718$, the actual absolute error is\n$$\nE_{\\text{actual}}=\\left|\\,\\ln(2)-T\\,\\right|=\\left|\\;0.69314718 - 0.69702381 \\;\\right| \\approx 0.00387663.\n$$\n\nFor the trapezoidal rule error bound,\n$$\n|E_{T}|\\le \\frac{M(b-a)^{3}}{12n^{2}},\n$$\nwith $f''(x)=\\frac{2}{x^{3}}$, so on $[1,2]$ the smallest possible $M$ satisfying $|f''(x)|\\le M$ is $M=|f''(1)|=2$. With $b-a=1$ and $n=4$, we get\n$$\nE_{\\text{bound}}=\\frac{2\\cdot 1^{3}}{12\\cdot 4^{2}}=\\frac{2}{192}=\\frac{1}{96}\\approx 0.01041667.\n$$\n\nThe requested difference (error bound minus actual absolute error) is\n$$\nD=E_{\\text{bound}}-E_{\\text{actual}} \\approx 0.01041667 - 0.00387663 \\approx 0.00654004.\n$$\nRounding to six significant figures gives\n$$\nD\\approx 0.00654004.\n$$",
            "answer": "$$\\boxed{0.00654004}$$"
        },
        {
            "introduction": "In many scientific and engineering scenarios, we must guarantee a certain level of accuracy *before* performing a calculation. This problem places you in a practical setting of pharmacokinetic modeling, where you must determine the minimum number of subintervals required to ensure the total drug exposure calculation meets a specified tolerance. This practice shifts the focus from analyzing error after the fact to using the error formula as a predictive tool for efficient and reliable computation .",
            "id": "2210520",
            "problem": "In a pharmacokinetic study, the concentration of a new drug in a patient's bloodstream is modeled as a function of time, $t$, by the equation $C(t) = C_0 \\exp(-kt^2)$. Here, $t$ is the time in hours after injection, $C_0 = 50$ mg/L is the initial concentration, and $k = 0.5 \\text{ hr}^{-2}$ is a constant related to the drug's elimination rate.\n\nTo assess the total drug exposure over the first two hours, a biomedical engineer needs to calculate the Area Under the Curve (AUC), which is given by the definite integral $A = \\int_{0}^{T} C(t) dt$ with $T=2$ hours.\n\nThe engineer uses a numerical approximation method. The time interval $[0, T]$ is divided into $n$ equal subintervals, and the value of the integral is approximated by summing the areas of the trapezoids formed by connecting the points $(t_i, C(t_i))$ and $(t_{i+1}, C(t_{i+1}))$ for each subinterval.\n\nFor this specific numerical method, the absolute error, $|E_n|$, is known to be bounded by the inequality:\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\nwhere $M$ is the maximum absolute value of the second derivative of the concentration function, $M = \\max_{t \\in [0, T]} |C''(t)|$.\n\nDetermine the minimum integer number of subintervals, $n$, that the engineer must use to guarantee that the absolute error in the calculated AUC is less than $10^{-3}$ mgÂ·hr/L.",
            "solution": "We are given $C(t) = C_{0}\\exp(-k t^{2})$ with $C_{0} = 50$ and $k = 0.5$, and the trapezoidal rule error bound\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\nFirst compute $C''(t)$. Differentiating,\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(2k t^{2}-1\\right).$$\nWe need to find $M=\\max_{t\\in[0,2]}|C''(t)|$. Let $g(t) = |C''(t)| = 2kC_0 e^{-kt^2} |2kt^2 - 1|$.\nWith $k=0.5$ and $C_0=50$, this is $g(t) = 50 e^{-0.5t^2}|t^2 - 1|$.\n\nWe must find the maximum of $g(t)$ on $[0,2]$. We can analyze the function in two parts:\n1. On $[0, 1]$, $g(t) = 50(1-t^2)e^{-0.5t^2}$. Its derivative is $g'(t) = 50t(t^2-3)e^{-0.5t^2}$. On $(0,1)$, $g'(t)  0$, so $g(t)$ is decreasing. The maximum on this interval occurs at $t=0$, where $g(0) = 50$.\n2. On $[1, 2]$, $g(t) = 50(t^2-1)e^{-0.5t^2}$. Its derivative is $g'(t) = 50t(3-t^2)e^{-0.5t^2}$. The derivative is zero at $t=\\sqrt{3} \\in [1,2]$. We check the function values at the critical point and endpoints:\n   - $g(1) = 0$.\n   - $g(\\sqrt{3}) = 50(3-1)e^{-0.5(3)} = 100e^{-1.5} \\approx 22.31$.\n   - $g(2) = 50(4-1)e^{-0.5(4)} = 150e^{-2} \\approx 20.29$.\n\nComparing the maximum on $[0,1]$ (which is $50$) with the maximum on $[1,2]$ (which is $\\approx 22.31$), the overall maximum value of $|C''(t)|$ on $[0,2]$ is $M = 50$.\n\nApply the error bound with $T=2$ and $M=50$:\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{400}{12 n^{2}} = \\frac{100}{3 n^{2}}.$$\nRequire $|E_{n}|  10^{-3}$:\n$$\\frac{100}{3 n^{2}}  10^{-3} \\quad \\Longleftrightarrow \\quad n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3}.$$\nThus $n > \\sqrt{\\frac{100000}{3}} \\approx \\sqrt{33333.33} \\approx 182.57$.\nSince $n$ must be an integer, the minimal integer $n$ satisfying the inequality is\n$$n = 183.$$",
            "answer": "$$\\boxed{183}$$"
        },
        {
            "introduction": "The composite trapezoidal rule performs best on smooth, continuous functions, but many real-world problems involve integrals with singularities. This exercise introduces a sophisticated technique known as 'singularity subtraction,' which is essential for handling such cases. By analytically separating the singular part of the integrand, you can transform a seemingly intractable problem into one that is perfectly suited for numerical approximation with the trapezoidal rule, showcasing how analytical insight and numerical methods work hand-in-hand .",
            "id": "2210479",
            "problem": "A common challenge in numerical integration is the presence of an integrable singularity at one of the endpoints of the integration interval, which prevents the direct application of standard quadrature rules. Consider the definite integral\n$$ I = \\int_{0}^{1} \\frac{\\cos(x)}{\\sqrt[3]{x}} dx $$\nThe integrand is singular at $x=0$. A standard technique to handle this is to rewrite the integral by separating the singular and non-singular behaviors. We can express the integral $I$ as the sum of a purely analytical integral and another integral whose integrand is well-behaved over the closed interval $[0, 1]$:\n$$ I = \\int_{0}^{1} \\left( \\frac{\\cos(x) - 1}{\\sqrt[3]{x}} \\right) dx + \\int_{0}^{1} \\frac{1}{\\sqrt[3]{x}} dx $$\nLet's call the first integral on the right-hand side $I_{num}$ and the second one $I_{an}$. The main integral is then $I = I_{num} + I_{an}$.\n\nYour task is to find a numerical approximation for the original integral $I$. First, evaluate $I_{an}$ analytically. Then, approximate the value of $I_{num}$ using the composite trapezoidal rule with $N=4$ subintervals. Combine your results to find the final value for $I$.\n\nProvide the final numerical value for $I$, rounded to five significant figures. Use radians for the argument of the cosine function.",
            "solution": "We rewrite the integral as stated:\n$$\nI=\\int_{0}^{1}\\frac{\\cos(x)}{x^{1/3}}\\,dx=\\int_{0}^{1}\\frac{\\cos(x)-1}{x^{1/3}}\\,dx+\\int_{0}^{1}\\frac{1}{x^{1/3}}\\,dx=I_{num}+I_{an}.\n$$\nFirst, evaluate the analytical part, $I_{an}$. Using the power rule for integration $\\int x^{\\alpha}\\,dx=\\frac{x^{\\alpha+1}}{\\alpha+1}$ for $\\alpha\\neq -1$,\n$$\nI_{an}=\\int_{0}^{1}x^{-1/3}\\,dx=\\left[\\frac{x^{2/3}}{2/3}\\right]_{0}^{1} = \\frac{3}{2} (1^{2/3} - 0^{2/3}) = \\frac{3}{2}.\n$$\nFor the numerical part, $I_{num}$, we define the integrand $f(x)=\\frac{\\cos(x)-1}{x^{1/3}}$. For the method to work, the function must be well-behaved at $x=0$. We check the limit as $x \\to 0$ using the Taylor expansion for $\\cos(x) \\approx 1 - \\frac{x^2}{2}$:\n$$\n\\lim_{x\\to 0}f(x)=\\lim_{x\\to 0}\\frac{(1-x^2/2)-1}{x^{1/3}}=\\lim_{x\\to 0}\\frac{-x^{2}/2}{x^{1/3}}=\\lim_{x\\to 0} -\\frac{1}{2}x^{5/3}=0,\n$$\nso we can define $f(0)=0$. We apply the composite trapezoidal rule on $[0,1]$ with $N=4$ subintervals, which gives a step size $h=\\frac{1-0}{4}=\\frac{1}{4}$. The nodes are $x_0=0, x_1=1/4, x_2=1/2, x_3=3/4, x_4=1$.\n$$\nI_{num}\\approx T_4 = \\frac{h}{2}\\left( f(x_0) + 2f(x_1) + 2f(x_2) + 2f(x_3) + f(x_4) \\right).\n$$\nWe compute the function values (using radians):\n- $f(x_0)=f(0)=0$.\n- $f(x_1)=f(0.25) = (\\cos(0.25)-1)/(0.25)^{1/3} \\approx -0.0493484$.\n- $f(x_2)=f(0.5) = (\\cos(0.5)-1)/(0.5)^{1/3} \\approx -0.1542363$.\n- $f(x_3)=f(0.75) = (\\cos(0.75)-1)/(0.75)^{1/3} \\approx -0.2953146$.\n- $f(x_4)=f(1) = \\cos(1)-1 \\approx -0.4596977$.\n\nAssemble the trapezoidal approximation:\n$$\nT_4 \\approx \\frac{0.25}{2}\\left(0 + 2(-0.0493484) + 2(-0.1542363) + 2(-0.2953146) + (-0.4596977)\\right)\n$$\n$$\nT_4 \\approx 0.125 \\left( -0.0986968 - 0.3084726 - 0.5906292 - 0.4596977 \\right)\n$$\n$$\nT_4 \\approx 0.125 \\left( -1.4574963 \\right) \\approx -0.1821870.\n$$\nCombine with $I_{an}=1.5$:\n$$\nI \\approx I_{an}+I_{num} = 1.5 - 0.1821870 \\approx 1.317813.\n$$\nRounded to five significant figures, the value is $1.3178$.",
            "answer": "$$\\boxed{1.3178}$$"
        }
    ]
}