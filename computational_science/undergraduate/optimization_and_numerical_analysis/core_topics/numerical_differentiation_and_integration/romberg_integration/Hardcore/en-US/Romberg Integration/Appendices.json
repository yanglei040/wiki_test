{
    "hands_on_practices": [
        {
            "introduction": "The best way to understand a numerical algorithm is often to perform the initial steps by hand. This first exercise will guide you through the fundamental mechanics of building a Romberg tableau for a simple polynomial integral . By manually calculating the initial trapezoidal estimates and applying the first level of Richardson extrapolation, you will gain a concrete feel for how Romberg integration systematically refines an approximation.",
            "id": "2198730",
            "problem": "Romberg integration is a numerical method used to estimate the definite integral of a function by applying Richardson extrapolation to the results from the trapezoidal rule. The estimates are organized in a triangular array called the Romberg tableau, denoted by $R_{i,j}$. The first column, $R_{i,1}$ (for $i \\geq 1$), is generated using the composite trapezoidal rule with $n = 2^{i-1}$ subintervals. Subsequent entries are computed using the recursive formula:\n$$R_{i,j} = R_{i, j-1} + \\frac{1}{4^{j-1} - 1}(R_{i, j-1} - R_{i-1, j-1}) \\quad \\text{for } i \\geq j \\geq 2.$$\n\nConsider the definite integral of a polynomial function $f(x) = 4x^3 - 3x^2 + 5$ over the interval $[0, 2]$. Your task is to manually compute the first three entries of the Romberg tableau for this integral.\n\nCalculate the values of $R_{1,1}$, $R_{2,1}$, and $R_{2,2}$. Provide your answer as a row vector of the three numerical values $(R_{1,1}, R_{2,1}, R_{2,2})$ expressed as exact integers.",
            "solution": "We integrate $f(x)=4x^{3}-3x^{2}+5$ over $[a,b]=[0,2]$. The composite trapezoidal rule with $n$ subintervals of width $h=\\frac{b-a}{n}$ is\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\nBy definition, $R_{i,1}=T_{2^{i-1}}$.\n\nFor $R_{1,1}$, we use $n=1$ interval, so $h=2$. Evaluate $f(0)=5$ and $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$. Then\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\nFor $R_{2,1}$, we use $n=2$ intervals, so $h=1$ with nodes $0,1,2$. Compute $f(1)=4-3+5=6$. Then\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\nFor the first extrapolation step, we compute $R_{2,2}$ using the formula for $j=2$:\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{2-1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\nAs a consistency check, the exact integral is\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\nagreeing with $R_{2,2}$. This is expected because $R_{i,2}$ is equivalent to Simpson's rule, which is exact for cubic polynomials.",
            "answer": "$$\\boxed{\\begin{pmatrix}30 & 21 & 18\\end{pmatrix}}$$"
        },
        {
            "introduction": "Romberg integration is exceptionally powerful because it is specifically designed to systematically cancel out successive terms in the error expansion of the trapezoidal rule. This practice problem moves from pure calculation to theory, asking you to determine how many extrapolation steps are needed to achieve an exact answer for a polynomial of a given degree . Solving this requires insight into the underlying structure of the trapezoidal rule's error, which is the secret to the method's high efficiency and rapid convergence for smooth functions.",
            "id": "2198758",
            "problem": "Romberg integration is a numerical method for estimating the definite integral of a function, which applies successive levels of Richardson extrapolation to the results of the composite trapezoidal rule. The results are typically organized in a triangular array called the Romberg tableau, with entries denoted by $R_{i,j}$.\n\nThe first column, $R_{i,1}$ for $i = 1, 2, \\ldots$, contains the approximations from the composite trapezoidal rule with $2^{i-1}$ subintervals. Subsequent columns are generated by the recurrence relation:\n$$\nR_{i,j} = R_{i, j-1} + \\frac{R_{i, j-1} - R_{i-1, j-1}}{4^{j-1} - 1} \\quad \\text{for } j \\ge 2\n$$\nEach column $j$ represents a higher order of accuracy. For a sufficiently smooth function, the values in the tableau converge to the true value of the integral.\n\nConsider the task of integrating an arbitrary polynomial of degree 5. There exists a minimum column index $j$ for which the result $R_{i,j}$ is no longer an approximation but becomes the exact value of the integral for any sufficiently large row index $i$. What is this smallest value of $j$?\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5",
            "solution": "Let the integral be $I=\\int_{a}^{b} f(x)\\,dx$ and let $h$ be a given step size. The composite trapezoidal rule approximation $R(h)$ has an error expansion given by the Eulerâ€“Maclaurin formula:\n$$\nR(h) = I + C_1 h^2 + C_2 h^4 + C_3 h^6 + \\dots\n$$\nwhere the coefficients $C_k$ depend on the derivatives of $f(x)$ at the endpoints. If $f(x)$ is a polynomial of degree 5, its derivatives of order 6 and higher are identically zero. The coefficient $C_3$ involves the fifth derivatives, $f^{(5)}(b) - f^{(5)}(a)$. Since $f^{(5)}(x)$ is a constant for a degree-5 polynomial, this term is zero. Therefore, all error coefficients $C_k$ for $k \\ge 3$ are zero, and the error expansion is exact and finite:\n$$\nR(h) = I + C_1 h^2 + C_2 h^4.\n$$\n\nThe Romberg tableau is constructed to systematically eliminate these error terms. The columns are indexed by $j=1, 2, 3, \\ldots$.\n- **Column $j=1$ ($R_{i,1}$):** This is the trapezoidal rule itself. Its error is $O(h^2)$, as shown above.\n- **Column $j=2$ ($R_{i,2}$):** The first extrapolation step combines $R(h)$ and $R(h/2)$ to eliminate the $C_1 h^2$ term. The resulting approximation, which is equivalent to Simpson's rule, has a remaining error of the form $K_2 h^4$ for some constant $K_2$. So, $R_{i,2} = I + K_2 h_i^4$. The method is exact for polynomials of degree up to 3.\n- **Column $j=3$ ($R_{i,3}$):** The second extrapolation step combines approximations from column 2 to eliminate the $K_2 h^4$ term. The resulting approximation has an error of order $O(h^6)$. Since the $h^6$ term in the original error expansion was zero for a degree-5 polynomial, this new approximation will be exact.\n\nLet's verify this step. We have $R_{i,2} = I + K_2 h_i^4$ and $R_{i-1,2} = I + K_2 h_{i-1}^4 = I + K_2 (2h_i)^4 = I + 16 K_2 h_i^4$.\nThe formula for the third column is:\n$$\nR_{i,3} = R_{i,2} + \\frac{R_{i,2} - R_{i-1,2}}{4^{3-1} - 1} = (I + K_2 h_i^4) + \\frac{(I + K_2 h_i^4) - (I + 16 K_2 h_i^4)}{15} = I + K_2 h_i^4 - \\frac{15 K_2 h_i^4}{15} = I.\n$$\nTherefore, $R_{i,3}$ is the first entry in the tableau that is guaranteed to be exact. The column index is $j=3$.\n\nThis corresponds to the known property that the method in column $j$ has a degree of precision of $2j-1$. For $j=3$, the degree of precision is $2(3)-1=5$. This means it integrates any polynomial of degree up to 5 exactly.\n\nHence, the minimal column index $j$ is 3.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "The standard Romberg algorithm works so well because it relies on key assumptions about the smoothness of the function being integrated, which leads to a predictable error structure. This advanced problem explores what happens when those assumptions don't hold, presenting a scenario where the error behaves differently . To find the solution, you must modify the standard extrapolation formula, demonstrating a deep mastery of the Richardson extrapolation principle that powers the entire method.",
            "id": "2198771",
            "problem": "An engineer is testing a new numerical integration library on a proprietary, non-trivial function $f(x)$ over an interval of length $L$. They use the composite trapezoidal rule and attempt to use Romberg extrapolation to improve accuracy. The trapezoidal rule approximation with $N=2^{i-1}$ subintervals is denoted by $R_{i,1}$. The step size for this approximation is $h_i = L/2^{i-1}$. The first column of the Romberg tableau is calculated and found to be:\n\n$R_{1,1} = 2.79159265$\n$R_{2,1} = 2.85096765$\n$R_{3,1} = 2.97030359$\n$R_{4,1} = 3.04905115$\n\nThe engineer observes that the convergence is not quadratic as would be expected for a very smooth function. A theoretical analysis of the integrand $f(x)$ reveals that the error of the trapezoidal rule approximation, $E(h_i) = I - R_{i,1}$ (where $I$ is the true value of the integral), has a full asymptotic expansion in integer powers of the step size $h_i$. That is, $E(h_i) \\sim \\sum_{k=1}^{\\infty} C_k h_i^k$ for some non-zero coefficients $C_k$, rather than an expansion in only even powers of $h_i$.\n\nBased on this information, determine the correct extrapolation procedure to build the Romberg tableau. Use this procedure to compute the most accurate possible estimate of the integral from the given data, which corresponds to the diagonal entry $R_{4,4}$.\n\nExpress your final answer as a single real number rounded to five significant figures.",
            "solution": "The composite trapezoidal approximations are $R_{i,1}$ with step sizes $h_{i} = L/2^{i-1}$. The error satisfies an asymptotic expansion in all integer powers of $h_i$:\n$$\nR_{i,1} = I + \\sum_{k=1}^{\\infty} C_{k} h_{i}^{k}, \\quad C_{k} \\neq 0 \\text{ in general}.\n$$\nThis means the leading error term is proportional to $h_i^1$. To perform Richardson extrapolation, we need to eliminate successive powers of $h_i$.\n\nLet's derive the general extrapolation formula. Suppose the entries in column $j$, $R_{i,j}$, have an error expansion that starts with $h_i^j$: $R_{i,j} = I + K h_i^j + O(h_i^{j+1})$.\nTo generate column $j+1$, we use the two estimates $R_{i,j}$ and $R_{i-1,j}$. Note that $h_{i-1} = 2h_i$.\n$$\nR_{i,j} = I + K h_i^j + O(h_i^{j+1})\n$$\n$$\nR_{i-1,j} = I + K h_{i-1}^j + O(h_{i-1}^{j+1}) = I + K (2h_i)^j + O(h_i^{j+1}) = I + K 2^j h_i^j + O(h_i^{j+1})\n$$\nTo eliminate the $h_i^j$ term, we form the linear combination $2^j R_{i,j} - R_{i-1,j} = (2^j - 1)I + O(h_i^{j+1})$. Thus, the improved estimate is:\n$$\nR_{i,j+1} = \\frac{2^j R_{i,j} - R_{i-1,j}}{2^j - 1} \\quad \\text{for } j \\geq 1.\n$$\nLet's apply this to build the tableau. The given data is column $j=1$:\n$R_{1,1} = 2.79159265$\n$R_{2,1} = 2.85096765$\n$R_{3,1} = 2.97030359$\n$R_{4,1} = 3.04905115$\n\n**Column $j=2$ (first extrapolation, eliminates $h^1$ term):** Use $R_{i,2} = \\frac{2^1 R_{i,1} - R_{i-1,1}}{2^1-1} = 2R_{i,1} - R_{i-1,1}$.\n$R_{2,2} = 2 R_{2,1} - R_{1,1} = 2(2.85096765) - 2.79159265 = 2.91034265$\n$R_{3,2} = 2 R_{3,1} - R_{2,1} = 2(2.97030359) - 2.85096765 = 3.08963953$\n$R_{4,2} = 2 R_{4,1} - R_{3,1} = 2(3.04905115) - 2.97030359 = 3.12779871$\n\n**Column $j=3$ (second extrapolation, eliminates $h^2$ term):** Use $R_{i,3} = \\frac{2^2 R_{i,2} - R_{i-1,2}}{2^2-1} = \\frac{4R_{i,2} - R_{i-1,2}}{3}$.\n$R_{3,3} = \\frac{4 R_{3,2} - R_{2,2}}{3} = \\frac{4(3.08963953) - 2.91034265}{3} \\approx 3.14940516$\n$R_{4,3} = \\frac{4 R_{4,2} - R_{3,2}}{3} = \\frac{4(3.12779871) - 3.08963953}{3} \\approx 3.14051844$\n\n**Column $j=4$ (third extrapolation, eliminates $h^3$ term):** Use $R_{i,4} = \\frac{2^3 R_{i,3} - R_{i-1,3}}{2^3-1} = \\frac{8R_{i,3} - R_{i-1,3}}{7}$.\n$R_{4,4} = \\frac{8 R_{4,3} - R_{3,3}}{7} = \\frac{8(3.14051844) - 3.14940516}{7} \\approx 3.13924891$\n\nThe most accurate estimate is the diagonal entry $R_{4,4} \\approx 3.13924891$.\nRounding to five significant figures gives $3.1392$.",
            "answer": "$$\\boxed{3.1392}$$"
        }
    ]
}