{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基本练习开始，以建立对分段插值的直观理解。此练习将引导您为函数 $f(x) = x^4$ 构建最简单的分段插值——分段线性插值。通过计算并比较不同子区间上的插值误差，您将亲身体验近似的好坏程度，并为理解为何以及何时需要更复杂的高阶插值方法（如样条插值）打下坚实基础。",
            "id": "2193842",
            "problem": "在数值分析中，分段插值是近似复杂函数的一种常用方法。考虑定义在区间 $[-1, 1]$ 上的函数 $f(x) = x^4$。我们希望使用一个连续分段线性插值函数来近似这个函数，我们将其记为 $L(x)$。该插值函数是使用节点 $x_0 = -1$、$x_1 = 0$ 和 $x_2 = 1$ 构建的。在给定子区间上的插值误差定义为该子区间上函数与其插值函数之间的最大绝对差，即 $\\max |f(x) - L(x)|$。\n\n你的任务是确定在 $[-1, 0]$ 或 $[0, 1]$ 这两个子区间中的哪一个上，插值误差最大。\n\n从以下选项中选择正确的陈述。\n\nA. 子区间 $[-1, 0]$。\n\nB. 子区间 $[0, 1]$。\n\nC. 两个子区间上的最大误差相同。\n\nD. 最大误差出现在节点 $x=0$ 处，因此没有哪个子区间的误差唯一更大。\n\nE. 信息不足，无法确定结果。",
            "solution": "题目要求我们使用节点 $x = -1, 0, 1$ 为函数 $f(x) = x^4$ 在区间 $[-1, 1]$ 上构建一个分段线性插值函数 $L(x)$，然后比较在子区间 $[-1, 0]$ 和 $[0, 1]$ 上的最大插值误差。\n\n首先，我们计算函数 $f(x)$ 在给定节点处的值：\n$f(x_0) = f(-1) = (-1)^4 = 1$\n$f(x_1) = f(0) = 0^4 = 0$\n$f(x_2) = f(1) = 1^4 = 1$\n\n现在，我们为每个子区间构建线性插值函数。\n\n**子区间 1: $[-1, 0]$**\n线性插值函数，我们称之为 $L_1(x)$，是经过点 $(x_0, f(x_0)) = (-1, 1)$ 和 $(x_1, f(x_1)) = (0, 0)$ 的直线。\n这条线的斜率是 $m_1 = \\frac{f(x_1) - f(x_0)}{x_1 - x_0} = \\frac{0 - 1}{0 - (-1)} = -1$。\n使用点 $(0, 0)$ 的点斜式，直线方程为：\n$L_1(x) - 0 = -1(x - 0)$，化简为 $L_1(x) = -x$。\n\n在此子区间上的误差函数是 $E_1(x) = f(x) - L_1(x) = x^4 - (-x) = x^4 + x$。\n为了找到最大绝对误差，我们需要求 $E_1(x)$ 在 $[-1, 0]$ 上的极值。我们对其关于 $x$ 求导并令其为零：\n$E_1'(x) = \\frac{d}{dx}(x^4 + x) = 4x^3 + 1$。\n令 $E_1'(x) = 0$ 得到 $4x^3 = -1$，所以 $x^3 = -1/4$。\n临界点是 $x_c = \\sqrt[3]{-1/4} = -\\frac{1}{\\sqrt[3]{4}}$。\n这个值位于区间 $[-1, 0]$ 内，因为 $1  4  8$，所以 $1  \\sqrt[3]{4}  2$，因此 $-1  -1/\\sqrt[3]{4}  -1/2$。\n根据构造，区间端点（即节点）处的误差为零：$E_1(-1) = (-1)^4 + (-1) = 0$ 且 $E_1(0) = 0^4 + 0 = 0$。\n因此，最大绝对误差必定出现在临界点 $x_c$ 处。\n该点的误差为：\n$E_1(x_c) = \\left(-\\frac{1}{\\sqrt[3]{4}}\\right)^4 + \\left(-\\frac{1}{\\sqrt[3]{4}}\\right) = \\frac{1}{4\\sqrt[3]{4}} - \\frac{1}{\\sqrt[3]{4}} = \\frac{1 - 4}{4\\sqrt[3]{4}} = -\\frac{3}{4\\sqrt[3]{4}}$。\n在 $[-1, 0]$ 上的最大绝对误差是 $|E_1(x_c)| = \\frac{3}{4\\sqrt[3]{4}}$。\n\n**子区间 2: $[0, 1]$**\n线性插值函数，我们称之为 $L_2(x)$，是经过点 $(x_1, f(x_1)) = (0, 0)$ 和 $(x_2, f(x_2)) = (1, 1)$ 的直线。\n这条线的斜率是 $m_2 = \\frac{f(x_2) - f(x_1)}{x_2 - x_1} = \\frac{1 - 0}{1 - 0} = 1$。\n使用点 $(0, 0)$ 的点斜式，直线方程为：\n$L_2(x) - 0 = 1(x - 0)$，化简为 $L_2(x) = x$。\n\n在此子区间上的误差函数是 $E_2(x) = f(x) - L_2(x) = x^4 - x$。\n为了找到最大绝对误差，我们求 $E_2(x)$ 在 $[0, 1]$ 上的极值。我们求导：\n$E_2'(x) = \\frac{d}{dx}(x^4 - x) = 4x^3 - 1$。\n令 $E_2'(x) = 0$ 得到 $4x^3 = 1$，所以 $x^3 = 1/4$。\n临界点是 $x_d = \\sqrt[3]{1/4} = \\frac{1}{\\sqrt[3]{4}}$。\n这个值位于区间 $[0, 1]$ 内。\n端点处的误差为零：$E_2(0) = 0^4 - 0 = 0$ 且 $E_2(1) = 1^4 - 1 = 0$。\n最大绝对误差必定出现在临界点 $x_d$ 处。\n该点的误差为：\n$E_2(x_d) = \\left(\\frac{1}{\\sqrt[3]{4}}\\right)^4 - \\left(\\frac{1}{\\sqrt[3]{4}}\\right) = \\frac{1}{4\\sqrt[3]{4}} - \\frac{1}{\\sqrt[3]{4}} = \\frac{1 - 4}{4\\sqrt[3]{4}} = -\\frac{3}{4\\sqrt[3]{4}}$。\n在 $[0, 1]$ 上的最大绝对误差是 $|E_2(x_d)| = \\frac{3}{4\\sqrt[3]{4}}$。\n\n**比较**\n在 $[-1, 0]$ 上的最大绝对误差是 $\\frac{3}{4\\sqrt[3]{4}}$。\n在 $[0, 1]$ 上的最大绝对误差是 $\\frac{3}{4\\sqrt[3]{4}}$。\n两个子区间上的最大误差是相同的。\n\n**使用对称性的另一种推理**\n函数 $f(x)=x^4$ 是一个偶函数，意味着 $f(x) = f(-x)$。\n节点关于 $x=0$ 对称分布。\n分段线性插值函数在 $x \\in [-1, 0]$ 上是 $L(x) = -x$，在 $x \\in [0, 1]$ 上是 $L(x) = x$。这可以紧凑地写作 $L(x) = |x|$。\n函数 $L(x) = |x|$ 也是一个偶函数。\n误差函数 $E(x) = f(x) - L(x) = x^4 - |x|$ 是两个偶函数之差，因此它也是一个偶函数。\n对于一个偶函数 $E(x)$， $|E(x)|$ 的值与 $|E(-x)|$ 相同。这意味着误差分布关于 $x=0$ 是对称的。因此，在区间 $[-1, 0]$ 上的最大误差必定等于在区间 $[0, 1]$ 上的最大误差。\n\n基于两种分析方法，两个子区间上的最大误差是相同的。这对应于选项 C。选项 D 是错误的，因为根据插值的定义，节点 $x=0$ 处的误差为零，这是最小误差，而不是最大误差。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "从分段线性函数过渡到更平滑的曲线，我们便进入了样条插值的世界。样条的核心思想是在连接点（称为“节点”）处强制执行连续性条件，以确保曲线没有尖角。本练习将让您直接实践这一概念，通过求解一个常数值，使两个二次多项式在节点处平滑连接，从而构成一个二次样条函数。完成此练习有助于您掌握样条插值背后的关键数学原理。",
            "id": "2193847",
            "problem": "一个复合函数 $S(x)$ 在区间 $[0, 2]$ 上由两个多项式片段连接而成。第一片段由函数 $p_1(x) = x^2$ 给出，适用于区间 $[0, 1]$ 内的 $x$。第二片段由函数 $p_2(x) = -x^2 + 4x + c$ 给出，适用于区间 $[1, 2]$ 内的 $x$，其中 $c$ 是一个实数常数。确定 $c$ 的具体值，使得复合函数 $S(x)$ 在其定义域 $[0, 2]$ 上成为一个二次样条。",
            "solution": "在具有单个内部节点的区间上的二次样条必须满足两个条件：在每个子区间上，它是一个次数最多为二的多项式；在节点处，函数值和一阶导数连续（即，它属于 $C^1$）。\n\n给定的片段是在 $[0,1]$ 上的 $p_{1}(x) = x^{2}$ 和在 $[1,2]$ 上的 $p_{2}(x) = -x^{2} + 4x + c$，它们本身都已经是二次多项式。为了确保在节点 $x=1$ 处是 $C^1$ 连续的，我们要求：\n1) 函数连续性：$p_{1}(1) = p_{2}(1)$。\n2) 一阶导数连续性：$p_{1}'(1) = p_{2}'(1)$。\n\n计算导数：\n$$\np_{1}'(x) = 2x, \\qquad p_{2}'(x) = -2x + 4.\n$$\n在 $x=1$ 处求值：\n$$\np_{1}'(1) = 2, \\qquad p_{2}'(1) = -2 \\cdot 1 + 4 = 2,\n$$\n因此，对于任意的 $c$，一阶导数连续性都自动成立。\n\n强制在 $x=1$ 处的函数连续性：\n$p_{1}(1) = 1^{2} = 1$\n$p_{2}(1) = -1^{2} + 4 \\cdot 1 + c = -1 + 4 + c = 3 + c$\n令它们相等：\n$$\n1 = 3 + c \\;\\;\\Longrightarrow\\;\\; c = -2.\n$$\n因此，$c = -2$ 使得 $S(x)$ 在 $[0,2]$ 上成为一个二次样条。",
            "answer": "$$\\boxed{-2}$$"
        },
        {
            "introduction": "虽然三次样条等高阶插值方法能提供极佳的光滑度，但在处理包含急剧变化的数据时，它们有时会产生违反物理直觉的“过冲”或“下冲”现象。这个高级练习模拟了一个工程场景，其中冷却系统导致温度骤降。通过计算自然三次样条在该区间内预测的最低温度，您将量化这种过冲效应，并深刻理解在选择插值模型时，光滑度与忠实于数据局部趋势之间的权衡。",
            "id": "2193885",
            "problem": "一位工程师正在为一个新设备中的关键组件的温度建模。温度是在短时间内测量的。在时间 $t=2.0$ 秒时，一个强大的冷却系统被激活，导致温度迅速下降。记录的数据点 $(t_i, T_i)$ 如下所示，其中 $t$ 是以秒为单位的时间，$T$ 是以摄氏度为单位的温度：\n$(t_0, T_0) = (0.0, 100.0)$\n$(t_1, T_1) = (1.0, 101.0)$\n$(t_2, T_2) = (2.0, 102.0)$\n$(t_3, T_3) = (3.0, 50.0)$\n$(t_4, T_4) = (4.0, 48.0)$\n\n提出了两种模型来插值这些数据点：分段线性插值 $L(t)$ 和自然三次样条 $S(t)$。自然三次样条是指其二阶导数在整个插值区间的端点处为零的样条。\n\n虽然分段线性模型显示温度在区间 $[3.0, 4.0]$ 秒内单调递减，但自然三次样条在急剧的温度下降处强制要求的光滑性（$C^2$ 连续性）可能会引入不符合物理规律的假象。其中一种假象是非单调行为，有时被称为“过冲”或“下冲”。\n\n您的任务是量化这种效应。确定自然三次样条 $S(t)$ 在时间区间 $[3.0, 4.0]$ 秒内预测的最低温度。请用摄氏度表示您的答案，并四舍五入到四位有效数字。",
            "solution": "给定数据点 $(t_{i},T_{i})$，其中 $t_{0}=0, t_{1}=1, t_{2}=2, t_{3}=3, t_{4}=4$，对应的 $T_{0}=100, T_{1}=101, T_{2}=102, T_{3}=50, T_{4}=48$。对于一个具有均匀间距 $h_{i}=t_{i+1}-t_{i}=1$ 的自然三次样条 $S(t)$，其二阶导数 $M_{i}=S''(t_{i})$ 满足以下关于 $i=1,2,3$ 的三对角系统：\n$$\nM_{i-1}+4M_{i}+M_{i+1}=6\\left(T_{i+1}-2T_{i}+T_{i-1}\\right),\n$$\n其中 $M_{0}=0$ 且 $M_{4}=0$。计算右侧项：\n- 当 $i=1$ 时：$T_{2}-2T_{1}+T_{0}=102-202+100=0$，因此 $M_{0}+4M_{1}+M_{2}=0$ 得到 $4M_{1}+M_{2}=0$。\n- 当 $i=2$ 时：$T_{3}-2T_{2}+T_{1}=50-204+101=-53$，因此 $M_{1}+4M_{2}+M_{3}=-318$。\n- 当 $i=3$ 时：$T_{4}-2T_{3}+T_{2}=48-100+102=50$，因此 $M_{2}+4M_{3}+M_{4}=300$ 得到 $M_{2}+4M_{3}=300$。\n\n使用 $M_{0}=0, M_{4}=0$ 求解这些方程：\n由 $4M_{1}+M_{2}=0$ 可得 $M_{2}=-4M_{1}$。代入 $M_{1}+4M_{2}+M_{3}=-318$ 得到 $-15M_{1}+M_{3}=-318$。由 $M_{2}+4M_{3}=300$ 和 $M_{2}=-4M_{1}$ 可得 $-4M_{1}+4M_{3}=300$，所以 $M_{3}=75+M_{1}$。代入 $-15M_{1}+M_{3}=-318$ 得到 $-14M_{1}+75=-318$，因此 $M_{1}=393/14$，然后得到 $M_{2}=-786/7, M_{3}=1443/14$。\n\n在区间 $[t_{3},t_{4}]=[3,4]$上，定义 $x=t-3\\in[0,1]$。该段的三次样条为\n$$\nS(t)=\\frac{M_{3}(1-x)^{3}}{6}+\\frac{M_{4}x^{3}}{6}+\\left(T_{3}-\\frac{M_{3}}{6}\\right)(1-x)+\\left(T_{4}-\\frac{M_{4}}{6}\\right)x.\n$$\n当 $M_{4}=0, T_{3}=50, T_{4}=48$ 且 $A=M_{3}/6=481/28$ 时，上式变为\n$$\nS(x)=A(1-3x+3x^{2}-x^{3})+(50-A)(1-x)+48x.\n$$\n展开并合并同类项得到\n$$\nS(x)=50+\\left(-\\frac{509}{14}\\right)x+\\left(\\frac{1443}{28}\\right)x^{2}-\\left(\\frac{481}{28}\\right)x^{3}.\n$$\n求导以寻找临界点：\n$$\nS'(x)=-\\frac{509}{14}+\\frac{1443}{14}x-\\frac{1443}{28}x^{2}=\\frac{-1018+2886x-1443x^{2}}{28}.\n$$\n令 $S'(x)=0$ 得到\n$$\n1443x^{2}-2886x+1018=0.\n$$\n根为\n$$\nx=1\\pm\\frac{5\\sqrt{24531}}{1443},\n$$\n其中在 $(0,1)$ 内的根是\n$$\nx_{c}=1-\\frac{5\\sqrt{24531}}{1443}.\n$$\n由于在 $(0,1)$ 上 $S''(x)=\\frac{1443}{14}(1-x)>0$，所以 $x_{c}$ 对应于 $[3,4]$ 上的一个局部最小值。为了高效地计算 $S$ 在 $x_c$ 处的值，我们使用关系式 $S'(x_{c})=0$ 来消去 $x^{3}$ 项：\n$$\nS(x)=50+\\frac{2}{3}\\left(-\\frac{509}{14}\\right)x+\\frac{1}{3}\\left(\\frac{1443}{28}\\right)x^{2}=50-\\frac{509}{21}x+\\frac{481}{28}x^{2}.\n$$\n根据二次方程条件，$1443x^{2}=2886x-1018$，所以\n$$\n\\frac{481}{28}x^{2}=\\frac{2886x-1018}{84}.\n$$\n因此，\n$$\nS_{\\min}=50-\\frac{509}{21}x+\\frac{2886x-1018}{84}=50-\\frac{509}{42}+\\frac{425}{42}x.\n$$\n将 $x=x_{c}=1-\\frac{5\\sqrt{24531}}{1443}$ 代入，上式变为\n$$\nS_{\\min}=50-\\frac{509}{42}+\\frac{425}{42}\\left(1-\\frac{5\\sqrt{24531}}{1443}\\right)=\\frac{2016}{42}-\\frac{2125}{42\\cdot 1443}\\sqrt{24531}.\n$$\n因为 $2016/42=48$ 且 $42\\cdot 1443=60606$，我们得到精确表达式\n$$\nS_{\\min}=48-\\frac{2125}{60606}\\sqrt{24531}.\n$$\n为了得到数值，计算 $\\sqrt{24531}\\approx 156.623753$，得到\n$$\nS_{\\min}\\approx 48-\\left(\\frac{2125}{60606}\\right)\\times 156.623753\\approx 48-5.491625831\\approx 42.50837417.\n$$\n四舍五入到四位有效数字，自然三次样条在 $[3.0,4.0]$ 秒区间内预测的最低温度是 $42.51$。",
            "answer": "$$\\boxed{42.51}$$"
        }
    ]
}