{
    "hands_on_practices": [
        {
            "introduction": "To begin our practice, we will focus on the foundational step of the scaled partial pivoting algorithm. This first exercise  will guide you through calculating the initial scale vector and using it to identify the very first pivot row. Mastering this core mechanic is essential for understanding how the method works to maintain numerical stability from the outset.",
            "id": "2199854",
            "problem": "Consider the linear system $A\\mathbf{x} = \\mathbf{b}$, where the matrix $A$ is given by:\n$$ A = \\begin{pmatrix} 2 & 1 & -5 \\\\ -4 & 8 & 2 \\\\ 3 & -1 & 4 \\end{pmatrix} $$\nWhen solving this system using Gaussian elimination with a scaled partial pivoting strategy, the procedure begins by determining an initial scale vector and selecting the first pivot row. The scale vector $\\mathbf{s}$ is a column vector where its $i$-th component, $s_i$, is the maximum absolute value of the elements in the $i$-th row of $A$ (i.e., $s_i = \\max_{j} |a_{ij}|$). The first pivot row is then chosen by identifying the row index $p$ that maximizes the ratio $\\frac{|a_{p1}|}{s_p}$.\n\nWhich of the following options correctly identifies the initial scale vector $\\mathbf{s}$ (written as a row vector for display) and the index of the first pivot row? (Assume rows are indexed starting from 1).\n\nA. Scale vector $[5, 8, 4]$, first pivot row is 2.\n\nB. Scale vector $[2, 4, 3]$, first pivot row is 2.\n\nC. Scale vector $[5, 8, 4]$, first pivot row is 3.\n\nD. Scale vector $[8, 14, 8]$, first pivot row is 3.\n\nE. Scale vector $[5, 8, 4]$, first pivot row is 1.",
            "solution": "We use scaled partial pivoting. For each row $i$, the scale $s_{i}$ is defined by $s_{i}=\\max_{j}|a_{ij}|$. For the given matrix\n$$\nA=\\begin{pmatrix}\n2 & 1 & -5\\\\\n-4 & 8 & 2\\\\\n3 & -1 & 4\n\\end{pmatrix},\n$$\ncompute the rowwise maxima:\n- Row 1: $\\max(|2|,|1|,|-5|)=5$, so $s_{1}=5$.\n- Row 2: $\\max(|-4|,|8|,|2|)=8$, so $s_{2}=8$.\n- Row 3: $\\max(|3|,|-1|,|4|)=4$, so $s_{3}=4$.\n\nThus the initial scale vector (displayed as a row vector) is $[5,8,4]$.\n\nTo choose the first pivot row, compute the ratios $r_{i}=\\frac{|a_{i1}|}{s_{i}}$ for $i=1,2,3$:\n$$\nr_{1}=\\frac{|2|}{5}=\\frac{2}{5},\\quad\nr_{2}=\\frac{|-4|}{8}=\\frac{4}{8}=\\frac{1}{2},\\quad\nr_{3}=\\frac{|3|}{4}=\\frac{3}{4}.\n$$\nThe maximum ratio is $\\frac{3}{4}$, attained at row $3$. Therefore, the first pivot row index is $3$.\n\nComparing with the options, this corresponds to option C.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "Having mastered the first pivot selection, we now extend this process to a complete LU decomposition. This practice problem  asks you to determine the full sequence of pivot choices for a specially structured matrix. By working through multiple steps, you will solidify your understanding of how the algorithm proceeds iteratively, updating its search for the best pivot at each stage of the elimination.",
            "id": "2199837",
            "problem": "In numerical linear algebra, scaled partial pivoting is a strategy used to select pivots during algorithms like Gaussian elimination or LU decomposition to mitigate the effects of round-off errors. The process can be summarized as follows:\n\nFirst, for the original $n \\times n$ matrix $A$, a scale factor $s_i$ is computed for each row $i=1, \\dots, n$. The scale factor is defined as the maximum absolute value of any element in that row: $s_i = \\max_{1 \\le j \\le n} |A_{ij}|$.\n\nThen, for each step $k$ of the elimination process (from $k=1$ to $n-1$):\n1. For each candidate row $i$ from the current $k$-th row to the $n$-th row of the partially processed matrix, a ratio is computed. This ratio is the absolute value of the element in the pivot column ($k$-th column) divided by the scale factor of that row (the scale factor is always the one computed from the original matrix).\n2. The row that yields the largest ratio is selected as the pivot row for step $k$. Let the *original* index of this chosen row be $p_k$.\n3. The current $k$-th row is swapped with this pivot row.\n4. Elimination is performed to create zeros below the pivot element in the $k$-th column.\n\nConsider the $4 \\times 4$ matrix $A$ given by:\n$$A = \\begin{pmatrix} 0 & 0 & 0 & 8 \\\\ 0 & 0 & 2 & 0 \\\\ 0 & 4 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix}$$\nDetermine the sequence of pivot rows $(p_1, p_2, p_3)$ selected for the first three steps of the elimination process. Each $p_k$ must be the *original* row index (1, 2, 3, or 4) of the row chosen as the pivot at step $k$.\n\nPresent your answer as a row matrix of these three integer indices.",
            "solution": "We apply scaled partial pivoting. First compute the row scale factors from the original matrix $A$:\n$$s_{1}=\\max(|0|,|0|,|0|,|8|)=8,\\quad s_{2}=\\max(|0|,|0|,|2|,|0|)=2,\\quad s_{3}=\\max(|0|,|4|,|0|,|0|)=4,\\quad s_{4}=\\max(|1|,|0|,|0|,|0|)=1.$$\n\nStep $k=1$, pivot column $1$, candidates are current rows $1$ to $4$ (initially identical to original rows). Ratios are\n$$\\frac{|A_{11}|}{s_{1}}=\\frac{0}{8}=0,\\quad \\frac{|A_{21}|}{s_{2}}=\\frac{0}{2}=0,\\quad \\frac{|A_{31}|}{s_{3}}=\\frac{0}{4}=0,\\quad \\frac{|A_{41}|}{s_{4}}=\\frac{1}{1}=1.$$\nThe largest ratio is at current row $4$, whose original index is $p_{1}=4$. Swap current rows $1$ and $4$. The current row order by original indices becomes $(4,2,3,1)$. Elimination below the pivot in column $1$ produces no changes because the entries are already zero.\n\nStep $k=2$, pivot column $2$, candidates are current rows $2$ to $4$, whose original indices are $(2,3,1)$. Using the current matrix after the $k=1$ swap, the column-$2$ entries and ratios are\n$$\\text{current row 2 (orig 2)}:\\ \\frac{|a_{22}|}{s_{2}}=\\frac{0}{2}=0,\\quad \\text{current row 3 (orig 3)}:\\ \\frac{|a_{32}|}{s_{3}}=\\frac{4}{4}=1,\\quad \\text{current row 4 (orig 1)}:\\ \\frac{|a_{42}|}{s_{1}}=\\frac{0}{8}=0.$$\nThe largest ratio is at current row $3$, whose original index is $p_{2}=3$. Swap current rows $2$ and $3$. The current row order by original indices becomes $(4,3,2,1)$. Elimination below the pivot in column $2$ yields no changes since those entries are zero.\n\nStep $k=3$, pivot column $3$, candidates are current rows $3$ to $4$, whose original indices are $(2,1)$. Ratios are\n$$\\text{current row 3 (orig 2)}:\\ \\frac{|a_{33}|}{s_{2}}=\\frac{2}{2}=1,\\quad \\text{current row 4 (orig 1)}:\\ \\frac{|a_{43}|}{s_{1}}=\\frac{0}{8}=0.$$\nThe largest ratio is at current row $3$, whose original index is $p_{3}=2$. No swap is needed. \n\nTherefore, the sequence of pivot rows is $(p_{1},p_{2},p_{3})=(4,3,2)$.",
            "answer": "$$\\boxed{\\begin{pmatrix}4 & 3 & 2\\end{pmatrix}}$$"
        },
        {
            "introduction": "Now let's move from execution to analysis by exploring the algorithm's sensitivity to changes in the matrix. In this problem , you will investigate how altering a single element can change the pivot choice in a *subsequent* step of the elimination process. This exercise highlights the dynamic nature of scaled partial pivoting and deepens your insight into the factors that govern numerical stability.",
            "id": "2199850",
            "problem": "In applying Gaussian elimination to solve a linear system $A\\mathbf{x} = \\mathbf{b}$, a pivoting strategy is often employed to enhance numerical stability. One such strategy is scaled partial pivoting. In this method, before the $k$-th elimination step, we select a pivot row from the set of rows $\\{k, k+1, \\dots, n\\}$. The chosen pivot row, designated by index $p$, is the one that maximizes the ratio of the absolute value of the potential pivot element to a pre-computed scale factor for that row. Specifically, we find $p$ such that\n$$\n\\frac{|A_{pk}^{(k-1)}|}{s_p} = \\max_{i=k, \\dots, n} \\frac{|A_{ik}^{(k-1)}|}{s_i}\n$$\nwhere $A_{ij}^{(k-1)}$ denotes the matrix elements after the first $k-1$ elimination steps, and the scale factor $s_i$ for each row $i$ is determined only once from the original matrix $A^{(0)} = A$ as $s_i = \\max_{j=1, \\dots, n} |A_{ij}|$. In case of a tie in the maximal ratio, the row with the smallest index is selected as the pivot row.\n\nConsider the $3 \\times 3$ matrix $A$ defined as:\n$$\nA = \\begin{pmatrix}\n10 & 2 & -1 \\\\\n5 & 20 & 5 \\\\\n-2 & C & 8\n\\end{pmatrix}\n$$\nwhere $C$ is a real parameter. When performing Gaussian elimination with scaled partial pivoting on this matrix, it is known that for the case $C=18$, the second pivot row chosen (for the second elimination step) is row 3.\n\nDetermine the largest positive integer value of $C$ strictly less than 18 for which the second pivot row becomes row 2 instead.",
            "solution": "We apply scaled partial pivoting. The row scale factors, computed once from the original matrix $A$, are\n$$\ns_{1}=\\max\\{|10|,|2|,|-1|\\}=10,\\quad s_{2}=\\max\\{|5|,|20|,|5|\\}=20,\\quad s_{3}=\\max\\{|-2|,|C|,|8|\\}=\\max\\{8,|C|\\}.\n$$\nAt the first step ($k=1$), the selection ratios are\n$$\n\\frac{|A_{11}|}{s_{1}}=\\frac{10}{10}=1,\\quad \\frac{|A_{21}|}{s_{2}}=\\frac{5}{20}=\\frac{1}{4},\\quad \\frac{|A_{31}|}{s_{3}}=\\frac{2}{\\max\\{8,|C|\\}}\\leq \\frac{1}{4}.\n$$\nThus row $1$ is the pivot. Perform elimination with multipliers $m_{21}=A_{21}/A_{11}=1/2$ and $m_{31}=A_{31}/A_{11}=-1/5$. The updated entries in column $2$ after the first step are\n$$\nA_{22}^{(1)}=20-\\frac{1}{2}\\cdot 2=19,\\qquad A_{32}^{(1)}=C-\\left(-\\frac{1}{5}\\right)\\cdot 2=C+\\frac{2}{5}.\n$$\nFor the second step ($k=2$), the scaled ratios to select the pivot from rows $2$ and $3$ are\n$$\nr_{2}=\\frac{|A_{22}^{(1)}|}{s_{2}}=\\frac{19}{20},\\qquad r_{3}=\\frac{|A_{32}^{(1)}|}{s_{3}}=\\frac{C+\\frac{2}{5}}{\\max\\{8,|C|\\}}.\n$$\nUsing the tie-break rule (smaller index wins), row $2$ is selected if and only if $r_{2}\\geq r_{3}$. Consider two cases for $s_{3}$:\n\n1) If $C\\geq 8$, then $s_{3}=C$ and\n$$\nr_{3}=\\frac{C+\\frac{2}{5}}{C}=1+\\frac{2}{5C}>1>\\frac{19}{20}=r_{2},\n$$\nso row $3$ is selected.\n\n2) If $0<C<8$, then $s_{3}=8$ and the condition $r_{2}\\geq r_{3}$ becomes\n$$\n\\frac{19}{20}\\geq \\frac{C+\\frac{2}{5}}{8}\\quad\\Longleftrightarrow\\quad 19\\cdot 8\\geq 20\\left(C+\\frac{2}{5}\\right)\\quad\\Longleftrightarrow\\quad 152\\geq 20C+8\n$$\n$$\n\\Longleftrightarrow\\quad 144\\geq 20C\\quad\\Longleftrightarrow\\quad C\\leq \\frac{36}{5}=7.2.\n$$\nFor positive integers $C<18$, this yields $C\\in\\{1,2,3,4,5,6,7\\}$ for which the second pivot row is row $2$. Therefore, the largest positive integer $C$ strictly less than $18$ making the second pivot row equal to row $2$ is $7$.",
            "answer": "$$\\boxed{7}$$"
        }
    ]
}