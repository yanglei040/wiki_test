{
    "hands_on_practices": [
        {
            "introduction": "本练习是理解截断误差的第一步。我们将直接对一个特定的微分方程应用局部截断误差的定义，这需要先求出精确解，然后将其与单步欧拉法的结果进行比较。通过这个实践，可以巩固局部截断误差的基本定义和所涉及的数学步骤。",
            "id": "2185646",
            "problem": "考虑由一阶常微分方程给出的初值问题 (IVP)：\n$$\ny'(t) = \\alpha y(t) - \\beta t^2\n$$\n其初始条件为 $y(0) = y_0$。在此方程中，$\\alpha$、$\\beta$ 和 $y_0$ 是给定的非零实常数。\n\n该 IVP 将使用步长为 $h$ 的欧拉法进行数值求解。欧拉法在第 $(i+1)$ 步的局部截断误差定义为 $\\tau_{i+1} = y(t_{i+1}) - \\left[y(t_i) + h f(t_i, y(t_i))\\right]$，其中 $y(t)$ 表示该 IVP 的精确解。\n\n计算在该方法的第一步（从 $t_0 = 0$ 到 $t_1 = h$）中出现的局部截断误差 $\\tau_1$ 的精确值。请用一个包含 $\\alpha$、$\\beta$、$y_0$ 和 $h$ 的单一闭式解析表达式来表示你的答案。",
            "solution": "本题要求计算将欧拉法应用于初值问题 $y'(t) = \\alpha y(t) - \\beta t^2$（初始条件为 $y(0) = y_0$）时，第一步的精确局部截断误差 $\\tau_1$。\n\n第一步（从 $t_0=0$ 到 $t_1=h$）的局部截断误差的定义由下式给出：\n$$\n\\tau_1 = y(t_1) - \\left[y(t_0) + h f(t_0, y(t_0))\\right]\n$$\n其中 $y(t)$ 是该常微分方程 (ODE) 的精确解。\n\n首先，我们确定此定义中的各项：\n- $t_0 = 0$ 且 $t_1 = h$。\n- $y(t_0) = y(0) = y_0$。\n- $f(t,y) = \\alpha y - \\beta t^2$。因此，$f(t_0, y(t_0)) = f(0, y_0) = \\alpha y_0 - \\beta (0)^2 = \\alpha y_0$。\n\n将这些项代入 $\\tau_1$ 的定义中，我们得到：\n$$\n\\tau_1 = y(h) - \\left[y_0 + h(\\alpha y_0)\\right] = y(h) - y_0(1 + \\alpha h)\n$$\n为了求出 $\\tau_1$ 的精确值，我们必须首先求出该 ODE 的精确解 $y(t)$，然后在 $t=h$ 处对其求值。\n\n该 ODE 为 $y'(t) = \\alpha y(t) - \\beta t^2$，这是一个一阶线性常微分方程。我们可以将其重写为标准形式 $y' - \\alpha y = -\\beta t^2$。\n积分因子 $I(t)$ 由下式给出：\n$$\nI(t) = \\exp\\left(\\int -\\alpha \\, dt\\right) = \\exp(-\\alpha t)\n$$\n将 ODE 的标准形式乘以 $I(t)$：\n$$\n\\exp(-\\alpha t)y' - \\alpha \\exp(-\\alpha t)y = -\\beta t^2 \\exp(-\\alpha t)\n$$\n左边是乘积 $I(t)y(t)$ 的导数：\n$$\n\\frac{d}{dt}\\left(y(t) \\exp(-\\alpha t)\\right) = -\\beta t^2 \\exp(-\\alpha t)\n$$\n对两边关于 $t$ 进行积分：\n$$\ny(t) \\exp(-\\alpha t) = -\\beta \\int t^2 \\exp(-\\alpha t) \\, dt\n$$\n右边的积分需要进行两次分部积分。设 $J = \\int t^2 \\exp(-\\alpha t) \\, dt$。\n对于第一次分部积分，设 $u = t^2$ 且 $dv = \\exp(-\\alpha t) dt$。则 $du = 2t \\, dt$ 且 $v = -\\frac{1}{\\alpha}\\exp(-\\alpha t)$。\n$$\nJ = t^2 \\left(-\\frac{1}{\\alpha}\\exp(-\\alpha t)\\right) - \\int \\left(-\\frac{1}{\\alpha}\\exp(-\\alpha t)\\right) (2t \\, dt) = -\\frac{t^2}{\\alpha}\\exp(-\\alpha t) + \\frac{2}{\\alpha} \\int t \\exp(-\\alpha t) \\, dt\n$$\n对于剩下的积分 $\\int t \\exp(-\\alpha t) \\, dt$，我们再次使用分部积分。设 $u = t$ 且 $dv = \\exp(-\\alpha t) dt$。则 $du = dt$ 且 $v = -\\frac{1}{\\alpha}\\exp(-\\alpha t)$。\n$$\n\\int t \\exp(-\\alpha t) \\, dt = t\\left(-\\frac{1}{\\alpha}\\exp(-\\alpha t)\\right) - \\int \\left(-\\frac{1}{\\alpha}\\exp(-\\alpha t)\\right) dt = -\\frac{t}{\\alpha}\\exp(-\\alpha t) - \\frac{1}{\\alpha^2}\\exp(-\\alpha t)\n$$\n将此结果代回到 $J$ 的表达式中：\n$$\nJ = -\\frac{t^2}{\\alpha}\\exp(-\\alpha t) + \\frac{2}{\\alpha} \\left(-\\frac{t}{\\alpha}\\exp(-\\alpha t) - \\frac{1}{\\alpha^2}\\exp(-\\alpha t)\\right) = -\\left(\\frac{t^2}{\\alpha} + \\frac{2t}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right)\\exp(-\\alpha t)\n$$\n现在我们可以写出 $y(t) \\exp(-\\alpha t)$ 的解：\n$$\ny(t) \\exp(-\\alpha t) = -\\beta J + C = \\beta\\left(\\frac{t^2}{\\alpha} + \\frac{2t}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right)\\exp(-\\alpha t) + C\n$$\n其中 $C$ 是积分常数。\n乘以 $\\exp(\\alpha t)$ 得到 $y(t)$ 的通解：\n$$\ny(t) = \\beta\\left(\\frac{t^2}{\\alpha} + \\frac{2t}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right) + C \\exp(\\alpha t)\n$$\n我们使用初始条件 $y(0) = y_0$ 来求出 $C$：\n$$\ny(0) = y_0 = \\beta\\left(0 + 0 + \\frac{2}{\\alpha^3}\\right) + C \\exp(0) = \\frac{2\\beta}{\\alpha^3} + C\n$$\n所以，$C = y_0 - \\frac{2\\beta}{\\alpha^3}$。\n\n该 IVP 的精确解是：\n$$\ny(t) = \\beta\\left(\\frac{t^2}{\\alpha} + \\frac{2t}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right) + \\left(y_0 - \\frac{2\\beta}{\\alpha^3}\\right) \\exp(\\alpha t)\n$$\n现在，我们在 $t = h$ 处计算这个精确解的值：\n$$\ny(h) = \\beta\\left(\\frac{h^2}{\\alpha} + \\frac{2h}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right) + \\left(y_0 - \\frac{2\\beta}{\\alpha^3}\\right) \\exp(\\alpha h)\n$$\n最后，我们将这个 $y(h)$ 的表达式代入我们的局部截断误差 $\\tau_1$ 的公式中：\n$$\n\\tau_1 = y(h) - y_0(1 + \\alpha h)\n$$\n$$\n\\tau_1 = \\left[ \\beta\\left(\\frac{h^2}{\\alpha} + \\frac{2h}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right) + \\left(y_0 - \\frac{2\\beta}{\\alpha^3}\\right) \\exp(\\alpha h) \\right] - y_0(1 + \\alpha h)\n$$\n这就是精确局部截断误差的最终表达式。为了清晰起见，我们可以对其稍作整理：\n$$\n\\tau_1 = \\left(y_0 - \\frac{2\\beta}{\\alpha^3}\\right) \\exp(\\alpha h) + \\beta\\left(\\frac{h^2}{\\alpha} + \\frac{2h}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right) - y_0 - y_0 \\alpha h\n$$",
            "answer": "$$\\boxed{\\left(y_0 - \\frac{2\\beta}{\\alpha^3}\\right) \\exp(\\alpha h) + \\beta\\left(\\frac{h^2}{\\alpha} + \\frac{2h}{\\alpha^2} + \\frac{2}{\\alpha^3}\\right) - y_0(1 + \\alpha h)}$$"
        },
        {
            "introduction": "除了纯粹的计算，为误差的产生方式和原因建立直观理解也至关重要。这个问题将局部截断误差的符号与真实解曲线的几何形状（特别是其凹凸性）联系起来。理解这种联系为预测欧拉法的行为提供了一个强大的可视化和概念性工具。",
            "id": "2185648",
            "problem": "考虑一个形式为 $y'(t) = f(t, y(t))$ 的一阶常微分方程(ODE)，其初始条件为 $y(t_0) = y_0$。该初值问题的解使用欧拉方法进行近似，步长 $h$ 为一个正常数，其中近似序列由 $y_{n+1} = y_n + h f(t_n, y_n)$ 给出，对 $n=0, 1, 2, \\dots$ 成立。\n\n在第 $n+1$ 步的局部截断误差 (LTE)，记为 $e_{n+1}$，定义为该方法单步所引入的误差。它被计算为时间 $t_{n+1}$ 处的精确解与从时间 $t_n$ 处的精确解值出发、由欧拉方法预测的值之差。即 $e_{n+1} = y(t_{n+1}) - (y(t_n) + h f(t_n, y(t_n)))$，其中 $y(t)$ 是该常微分方程的精确解。\n\n假设已知精确解 $y(t)$ 在区间 $[a, b]$ 上是二阶可导且严格上凹的。对于完全在此区间内进行的任何一步，即 $t_n$ 和 $t_{n+1}$ 均在 $[a, b]$ 内，关于局部截断误差 $e_{n+1}$ 的符号，可以得出什么确切的结论？\n\nA. 局部截断误差恒为正。\n\nB. 局部截断误差恒为负。\n\nC. 局部截断误差恒为零。\n\nD. 无法根据给定信息确定局部截断误差的符号。",
            "solution": "第 $n+1$ 步的局部截断误差定义为\n$$\ne_{n+1} = y(t_{n+1}) - \\left(y(t_n) + h f(t_n, y(t_n))\\right),\n$$\n其中 $f(t,y) = y'(t)$，因此上式变为\n$$\ne_{n+1} = y(t_{n+1}) - \\left(y(t_n) + h y'(t_n)\\right).\n$$\n根据带有拉格朗日余项的泰勒定理，将 $y$ 在 $t_n$ 点展开，步长为 $h = t_{n+1} - t_n  0$，存在某个 $\\xi_n \\in (t_n, t_{n+1})$ 使得\n$$\ny(t_{n+1}) = y(t_n) + h y'(t_n) + \\frac{h^{2}}{2} y''(\\xi_n).\n$$\n将此式代入 $e_{n+1}$ 的表达式中，得到\n$$\ne_{n+1} = \\frac{h^{2}}{2} y''(\\xi_n).\n$$\n由于解在 $[a,b]$ 上是严格上凹的，我们有对于所有 $t \\in [a,b]$ 都有 $y''(t)  0$。因为 $t_n, t_{n+1} \\in [a,b]$，所以 $\\xi_n \\in (t_n, t_{n+1}) \\subset [a,b]$，因此 $y''(\\xi_n)  0$。又因为 $h0$，我们得出结论\n$$\ne_{n+1}  0.\n$$\n因此，对于完全在 $[a,b]$ 区间内进行的步骤，局部截断误差恒为正。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一个完整数值解的总误差，即全局误差，并不仅仅是局部误差的简单加总。本练习演示了误差抵消的关键概念，即不同步骤产生的局部误差可能具有相反的符号，从而部分地相互抵消。通过分析一个振荡函数，我们可以量化这种效应，并理解局部误差与全局误差之间的复杂关系。",
            "id": "2185640",
            "problem": "考虑一个由以下公式给出的常微分方程（ODE）的初值问题：\n$$\ny'(t) = \\cos(\\pi t), \\quad y(0) = 0\n$$\n该常微分方程的近似解可以使用欧拉方法求得，该方法以离散的时间步长推进求解。在每一步中，都会引入一个小的误差，称为局部截断误差（LTE）。在第 $n$ 步（从时间 $t_n$ 到 $t_{n+1} = t_n + h$），LTE 的主阶项由 $L_n = \\frac{1}{2}h^2 y''(t_n)$ 给出，其中 $y(t)$ 是该常微分方程的精确解，$h$ 是步长。\n\n我们希望分析这些局部误差在一个区间上的累积效应。为此，我们基于这些主阶误差项的和定义了两个量：\n1.  局部误差绝对值之和：$E_{abs} = \\sum_{n=0}^{N-1} |L_n|$\n2.  净累积局部误差：$E_{net} = \\left| \\sum_{n=0}^{N-1} L_n \\right|$\n\n使用恒定步长 $h=0.25$，计算在时间从 $t=0$ 到最终时间 $T=1.75$ 的区间内的比率 $R = \\frac{E_{net}}{E_{abs}}$。总步数是 $N = T/h$。\n\n将您的最终答案四舍五入到三位有效数字。",
            "solution": "本题要求计算常微分方程 $y'(t) = \\cos(\\pi t)$（其中 $y(0)=0$）在步长 $h=0.25$、时间上限为 $T=1.75$ 的条件下，净累积局部误差与局部误差绝对值之和的比率。\n\n首先，我们需要求出精确解的二阶导数 $y''(t)$。\n一阶导数由 $y'(t) = \\cos(\\pi t)$ 给出。\n对 $t$ 求导，我们得到二阶导数：\n$$\ny''(t) = \\frac{d}{dt} \\left( \\cos(\\pi t) \\right) = -\\pi \\sin(\\pi t)\n$$\n第 $n$ 步的局部截断误差（LTE）的主阶项由 $L_n = \\frac{1}{2}h^2 y''(t_n)$ 给出。代入我们得到的 $y''(t)$ 的表达式，有：\n$$\nL_n = \\frac{1}{2}h^2 (-\\pi \\sin(\\pi t_n)) = -\\frac{\\pi h^2}{2} \\sin(\\pi t_n)\n$$\n题目指定步长 $h=0.25$ 和最终时间 $T=1.75$。总步数为 $N = \\frac{T}{h} = \\frac{1.75}{0.25} = 7$。\n时间点为 $t_n = n \\cdot h = 0.25n$，其中 $n=0, 1, 2, \\ldots, 6$。$E_{abs}$ 和 $E_{net}$ 的求和范围是从 $n=0$ 到 $N-1=6$。\n\n我们来计算当 $n=0, 1, \\dots, 6$ 时 $y''(t_n) = -\\pi \\sin(\\pi \\cdot 0.25n) = -\\pi \\sin(\\frac{n\\pi}{4})$ 的值：\n-   当 $n=0$ 时：$y''(t_0) = -\\pi\\sin(0) = 0$\n-   当 $n=1$ 时：$y''(t_1) = -\\pi\\sin(\\frac{\\pi}{4}) = -\\frac{\\pi\\sqrt{2}}{2}$\n-   当 $n=2$ 时：$y''(t_2) = -\\pi\\sin(\\frac{\\pi}{2}) = -\\pi$\n-   当 $n=3$ 时：$y''(t_3) = -\\pi\\sin(\\frac{3\\pi}{4}) = -\\frac{\\pi\\sqrt{2}}{2}$\n-   当 $n=4$ 时：$y''(t_4) = -\\pi\\sin(\\pi) = 0$\n-   当 $n=5$ 时：$y''(t_5) = -\\pi\\sin(\\frac{5\\pi}{4}) = -\\pi(-\\frac{\\sqrt{2}}{2}) = \\frac{\\pi\\sqrt{2}}{2}$\n-   当 $n=6$ 时：$y''(t_6) = -\\pi\\sin(\\frac{3\\pi}{2}) = -\\pi(-1) = \\pi$\n\n现在，我们可以计算 $E_{net}$ 和 $E_{abs}$。\n项 $L_n$ 是 $\\frac{h^2}{2} y''(t_n)$。我们定义一个常数 $C = \\frac{h^2}{2} = \\frac{(0.25)^2}{2} = \\frac{0.0625}{2} = 0.03125$。\n那么 $L_n = C \\cdot y''(t_n)$。\n\n首先，我们计算带符号的局部误差之和 $\\sum_{n=0}^{6} L_n$：\n$$\n\\sum_{n=0}^{6} L_n = C \\cdot \\sum_{n=0}^{6} y''(t_n) = C \\left( 0 - \\frac{\\pi\\sqrt{2}}{2} - \\pi - \\frac{\\pi\\sqrt{2}}{2} + 0 + \\frac{\\pi\\sqrt{2}}{2} + \\pi \\right)\n$$\n$$\n\\sum_{n=0}^{6} L_n = C \\left( -\\frac{\\pi\\sqrt{2}}{2} \\right) = -\\frac{C\\pi\\sqrt{2}}{2}\n$$\n所以，$E_{net} = \\left| \\sum_{n=0}^{6} L_n \\right| = \\left| -\\frac{C\\pi\\sqrt{2}}{2} \\right| = \\frac{C\\pi\\sqrt{2}}{2}$。\n\n接下来，我们计算局部误差绝对值之和 $\\sum_{n=0}^{6} |L_n|$：\n$$\n\\sum_{n=0}^{6} |L_n| = C \\cdot \\sum_{n=0}^{6} |y''(t_n)| = C \\left( |0| + \\left|-\\frac{\\pi\\sqrt{2}}{2}\\right| + |-\\pi| + \\left|-\\frac{\\pi\\sqrt{2}}{2}\\right| + |0| + \\left|\\frac{\\pi\\sqrt{2}}{2}\\right| + |\\pi| \\right)\n$$\n$$\n\\sum_{n=0}^{6} |L_n| = C \\left( 0 + \\frac{\\pi\\sqrt{2}}{2} + \\pi + \\frac{\\pi\\sqrt{2}}{2} + 0 + \\frac{\\pi\\sqrt{2}}{2} + \\pi \\right)\n$$\n$$\n\\sum_{n=0}^{6} |L_n| = C \\left( 2\\pi + 3\\frac{\\pi\\sqrt{2}}{2} \\right) = C\\pi \\left( 2 + \\frac{3\\sqrt{2}}{2} \\right)\n$$\n所以，$E_{abs} = C\\pi \\left( 2 + \\frac{3\\sqrt{2}}{2} \\right)$。\n\n最后，我们计算比率 $R = \\frac{E_{net}}{E_{abs}}$：\n$$\nR = \\frac{\\frac{C\\pi\\sqrt{2}}{2}}{C\\pi \\left( 2 + \\frac{3\\sqrt{2}}{2} \\right)}\n$$\n$C\\pi$ 项被消掉了：\n$$\nR = \\frac{\\frac{\\sqrt{2}}{2}}{2 + \\frac{3\\sqrt{2}}{2}} = \\frac{\\sqrt{2}}{4 + 3\\sqrt{2}}\n$$\n为简化此表达式，我们将分子和分母同乘以分母的共轭式 $4 - 3\\sqrt{2}$：\n$$\nR = \\frac{\\sqrt{2}(4 - 3\\sqrt{2})}{(4 + 3\\sqrt{2})(4 - 3\\sqrt{2})} = \\frac{4\\sqrt{2} - 3(\\sqrt{2})^2}{4^2 - (3\\sqrt{2})^2} = \\frac{4\\sqrt{2} - 6}{16 - 9(2)} = \\frac{4\\sqrt{2} - 6}{16 - 18} = \\frac{4\\sqrt{2} - 6}{-2}\n$$\n$$\nR = \\frac{6 - 4\\sqrt{2}}{2} = 3 - 2\\sqrt{2}\n$$\n现在，我们需要求出数值并将其四舍五入到三位有效数字。\n使用 $\\sqrt{2} \\approx 1.41421356...$\n$$\nR \\approx 3 - 2(1.41421356) = 3 - 2.82842712 = 0.17157288\n$$\n四舍五入到三位有效数字，我们得到 $R \\approx 0.172$。",
            "answer": "$$\\boxed{0.172}$$"
        }
    ]
}