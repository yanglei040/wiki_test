{
    "hands_on_practices": [
        {
            "introduction": "共轭梯度法的旅程始于与最速下降法非常相似的一步。初始搜索方向就是起点处梯度的负方向。这个首次练习  提供了一个基础的起点，让你能够练习计算初始梯度、确定第一个搜索方向，并通过精确线搜索找到最优步长。",
            "id": "2211287",
            "problem": "考虑如下给定的二次目标函数 $f(\\mathbf{x}) = f(x_1, x_2)$ 的最小化问题：\n$$f(x_1, x_2) = \\frac{3}{2}x_1^2 + x_1x_2 + x_2^2 - x_1 - 4x_2$$\n其中 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。\n\n我们希望应用共轭梯度法，从初始点 $\\mathbf{x}_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始。该算法的第一次迭代从 $\\mathbf{x}_0$ 移动到一个新点 $\\mathbf{x}_1 = \\mathbf{x}_0 + \\alpha_0 \\mathbf{d}_0$，其中 $\\mathbf{d}_0$ 是初始搜索方向，$\\alpha_0$ 是最优步长。\n\n确定初始搜索方向向量 $\\mathbf{d}_0 = \\begin{pmatrix} d_{0,1} \\\\ d_{0,2} \\end{pmatrix}$ 的分量，以及最优步长 $\\alpha_0$ 的精确值。\n\n将你的最终答案表示为一个 $1 \\times 3$ 的行矩阵，其中按顺序包含 $d_{0,1}$、$d_{0,2}$ 和 $\\alpha_0$ 的值。在必要时，将所有值表示为精确分数。",
            "solution": "我们将二次目标函数重写为标准形式 $f(\\mathbf{x})=\\frac{1}{2}\\mathbf{x}^{T}Q\\mathbf{x}-\\mathbf{c}^{T}\\mathbf{x}$，通过确定对称矩阵 $Q$ 和向量 $\\mathbf{c}$。根据\n$$f(x_{1},x_{2})=\\frac{3}{2}x_{1}^{2}+x_{1}x_{2}+x_{2}^{2}-x_{1}-4x_{2},$$\n我们有\n$$Q=\\begin{pmatrix}3  1 \\\\ 1  2\\end{pmatrix},\\qquad \\mathbf{c}=\\begin{pmatrix}1 \\\\ 4\\end{pmatrix}.$$\n梯度为 $\\nabla f(\\mathbf{x})=Q\\mathbf{x}-\\mathbf{c}$。在初始点 $\\mathbf{x}_{0}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，梯度为\n$$\\mathbf{g}_{0}=\\nabla f(\\mathbf{x}_{0})=Q\\mathbf{x}_{0}-\\mathbf{c}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}-\\begin{pmatrix}1 \\\\ 4\\end{pmatrix}=\\begin{pmatrix}-1 \\\\ -4\\end{pmatrix}.$$\n在共轭梯度法中，初始搜索方向是负梯度：\n$$\\mathbf{d}_{0}=-\\mathbf{g}_{0}=\\begin{pmatrix}1 \\\\ 4\\end{pmatrix}.$$\n沿着 $\\mathbf{d}_{0}$ 方向的精确线搜索步长可以通过最小化 $\\phi(\\alpha)=f(\\mathbf{x}_{0}+\\alpha\\mathbf{d}_{0})$ 得到，可得\n$$\\alpha_{0}=-\\frac{\\mathbf{d}_{0}^{T}\\mathbf{g}_{0}}{\\mathbf{d}_{0}^{T}Q\\mathbf{d}_{0}}=\\frac{\\mathbf{g}_{0}^{T}\\mathbf{g}_{0}}{\\mathbf{d}_{0}^{T}Q\\mathbf{d}_{0}},$$\n因为 $\\mathbf{d}_{0}=-\\mathbf{g}_{0}$。计算分子：\n$$\\mathbf{g}_{0}^{T}\\mathbf{g}_{0}=(-1)^{2}+(-4)^{2}=1+16=17.$$\n计算分母：\n$$Q\\mathbf{d}_{0}=\\begin{pmatrix}3  1 \\\\ 1  2\\end{pmatrix}\\begin{pmatrix}1 \\\\ 4\\end{pmatrix}=\\begin{pmatrix}7 \\\\ 9\\end{pmatrix},\\qquad \\mathbf{d}_{0}^{T}Q\\mathbf{d}_{0}=\\begin{pmatrix}1  4\\end{pmatrix}\\begin{pmatrix}7 \\\\ 9\\end{pmatrix}=7+36=43.$$\n因此，\n$$\\alpha_{0}=\\frac{17}{43}.$$\n因此，$d_{0,1}=1$，$d_{0,2}=4$，以及 $\\alpha_{0}=\\frac{17}{43}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  4  \\frac{17}{43} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在确定了搜索方向和最优步长之后，下一个合理的步骤就是更新我们的位置。这个练习  直接建立在初始计算之上，引导你完成共轭梯度算法的完整第一次迭代。通过计算新点 $\\mathbf{x}_1$，你将具体地理解该方法是如何向最小值前进的。",
            "id": "2211319",
            "problem": "在数值优化中，共轭梯度法是一种用于寻找函数局部最小值的迭代算法。对于二次函数，它可以在有限步数内找到精确的最小值。\n\n考虑一个包含两个变量 $x_1$ 和 $x_2$ 的二次目标函数 $f(x)$，其中 $x = [x_1, x_2]^T$：\n$$\nf(x_1, x_2) = (x_1 - 2)^2 + 2(x_2 - 1)^2\n$$\n从初始点 $x_0 = [0, 0]^T$ 开始，执行一次完整的共轭梯度算法迭代。这包括计算初始搜索方向、找到最优步长以及更新位置以找到下一个点 $x_1$。\n\n确定点 $x_1$ 的坐标。将 $x_1$ 的答案表示为一个包含精确分数分量的列向量。",
            "solution": "我们使用共轭梯度法，从 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，最小化二次函数 $f(x) = (x_{1}-2)^{2} + 2(x_{2}-1)^{2}$。其梯度和海森矩阵为\n$$\n\\nabla f(x) = \\begin{pmatrix} 2(x_{1}-2) \\\\ 4(x_{2}-1) \\end{pmatrix}, \\quad H = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix}.\n$$\n在 $x_{0}$ 处，梯度为\n$$\ng_{0} = \\nabla f(x_{0}) = \\begin{pmatrix} -4 \\\\ -4 \\end{pmatrix}.\n$$\n共轭梯度法的初始搜索方向是最速下降方向\n$$\nd_{0} = -g_{0} = \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix}.\n$$\n沿着 $d_{0}$ 进行精确线搜索，定义 $\\phi(\\alpha) = f(x_{0} + \\alpha d_{0})$。对于具有常数海森矩阵的二次函数，其导数为\n$$\n\\phi'(\\alpha) = d_{0}^{T}\\left(g_{0} + \\alpha H d_{0}\\right).\n$$\n令 $\\phi'(\\alpha) = 0$ 可得\n$$\nd_{0}^{T} g_{0} + \\alpha_{0}\\, d_{0}^{T} H d_{0} = 0 \\quad \\Longrightarrow \\quad \\alpha_{0} = -\\frac{d_{0}^{T} g_{0}}{d_{0}^{T} H d_{0}}.\n$$\n计算所需的量：\n$$\nd_{0}^{T} g_{0} = \\begin{pmatrix} 4  4 \\end{pmatrix} \\begin{pmatrix} -4 \\\\ -4 \\end{pmatrix} = -32, \\quad H d_{0} = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 16 \\end{pmatrix},\n$$\n$$\nd_{0}^{T} H d_{0} = \\begin{pmatrix} 4  4 \\end{pmatrix} \\begin{pmatrix} 8 \\\\ 16 \\end{pmatrix} = 96.\n$$\n因此，\n$$\n\\alpha_{0} = -\\frac{-32}{96} = \\frac{1}{3}.\n$$\n更新以得到 $x_{1}$：\n$$\nx_{1} = x_{0} + \\alpha_{0} d_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{3} \\begin{pmatrix} 4 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3} \\\\ \\frac{4}{3} \\end{pmatrix}.\n$$\n因此，经过一次迭代后，下一个点是如上所示的包含精确分数分量的列向量。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{4}{3} \\\\ \\frac{4}{3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "真正让共轭梯度法与众不同的是它能生成“共轭”的搜索方向。这一特性确保了在一个方向上完成的最小化过程不会被后续步骤所“抵消”。这个练习  深入探讨了这一核心概念，要求你明确计算出两个连续的搜索方向，并验证它们相对于黑塞矩阵 $A$ 是共轭的，这一条件表示为 $\\mathbf{p}_0^T A \\mathbf{p}_1 = 0$。",
            "id": "2211315",
            "problem": "考虑一个最小化二维二次函数 $f(\\mathbf{x})$ 的无约束优化问题，其中 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$。该函数定义为 $f(\\mathbf{x}) = \\frac{1}{2}\\mathbf{x}^T A \\mathbf{x} - \\mathbf{b}^T \\mathbf{x}$，其中对称正定矩阵 $A$ 和向量 $\\mathbf{b}$ 如下所示：\n$$\nA = \\begin{pmatrix} 5  2 \\\\ 2  1 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n我们将使用共轭梯度（CG）法的 Fletcher-Reeves 变体来寻找该函数的最小值。该函数的梯度为 $\\nabla f(\\mathbf{x}) = A\\mathbf{x} - \\mathbf{b}$。从点 $\\mathbf{x}_k$ 开始，CG 方法的迭代步骤如下：\n\n1.  令 $g_k = \\nabla f(\\mathbf{x}_k)$ 为当前点的梯度。\n2.  搜索方向 $\\mathbf{p}_k$ 由以下规则确定：\n    -   对于第一次迭代（$k=0$）：$\\mathbf{p}_0 = -g_0$。\n    -   对于后续的迭代（$k  0$）：$\\mathbf{p}_k = -g_k + \\beta_k \\mathbf{p}_{k-1}$，其中 $\\beta_k = \\frac{g_k^T g_k}{g_{k-1}^T g_{k-1}}$。\n3.  步长 $\\alpha_k$ 计算为 $\\alpha_k = \\frac{g_k^T g_k}{\\mathbf{p}_k^T A \\mathbf{p}_k}$。\n4.  位置更新为 $\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\alpha_k \\mathbf{p}_k$。\n5.  下一次迭代的梯度使用高效公式 $g_{k+1} = g_k + \\alpha_k A \\mathbf{p}_k$ 进行更新。\n\n如果数量 $\\mathbf{u}^T A \\mathbf{v}$ 等于零，则称两个向量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 关于矩阵 $A$ 是共轭的。CG 方法的一个关键性质是它会生成一系列相互共轭的搜索方向。\n\n你的任务是从点 $\\mathbf{x}_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，应用 CG 方法来生成前两个搜索方向 $\\mathbf{p}_0$ 和 $\\mathbf{p}_1$。然后，计算表达式 $\\mathbf{p}_0^T A \\mathbf{p}_1$ 的值。",
            "solution": "我们最小化 $f(\\mathbf{x})=\\frac{1}{2}\\mathbf{x}^{T}A\\mathbf{x}-\\mathbf{b}^{T}\\mathbf{x}$，其中 $A=\\begin{pmatrix}5  2\\\\2  1\\end{pmatrix}$，$\\mathbf{b}=\\begin{pmatrix}1\\\\1\\end{pmatrix}$，起始点为 $\\mathbf{x}_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$。梯度为 $\\nabla f(\\mathbf{x})=A\\mathbf{x}-\\mathbf{b}$。\n\n计算初始梯度：\n$$\n\\mathbf{g}_{0}=\\nabla f(\\mathbf{x}_{0})=A\\mathbf{x}_{0}-\\mathbf{b}=\\begin{pmatrix}0\\\\0\\end{pmatrix}-\\begin{pmatrix}1\\\\1\\end{pmatrix}=\\begin{pmatrix}-1\\\\-1\\end{pmatrix}.\n$$\n第一个搜索方向：\n$$\n\\mathbf{p}_{0}=-\\mathbf{g}_{0}=\\begin{pmatrix}1\\\\1\\end{pmatrix}.\n$$\n步长 $\\alpha_{0}$：\n$$\n\\alpha_{0}=\\frac{\\mathbf{g}_{0}^{T}\\mathbf{g}_{0}}{\\mathbf{p}_{0}^{T}A\\mathbf{p}_{0}},\\quad \\mathbf{g}_{0}^{T}\\mathbf{g}_{0}=(-1)^{2}+(-1)^{2}=2,\n$$\n$$\nA\\mathbf{p}_{0}=\\begin{pmatrix}5  2\\\\2  1\\end{pmatrix}\\begin{pmatrix}1\\\\1\\end{pmatrix}=\\begin{pmatrix}7\\\\3\\end{pmatrix},\\quad \\mathbf{p}_{0}^{T}A\\mathbf{p}_{0}=\\begin{pmatrix}1  1\\end{pmatrix}\\begin{pmatrix}7\\\\3\\end{pmatrix}=10,\n$$\n$$\n\\alpha_{0}=\\frac{2}{10}=\\frac{1}{5}.\n$$\n更新位置和梯度：\n$$\n\\mathbf{x}_{1}=\\mathbf{x}_{0}+\\alpha_{0}\\mathbf{p}_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}+\\frac{1}{5}\\begin{pmatrix}1\\\\1\\end{pmatrix}=\\begin{pmatrix}\\frac{1}{5}\\\\\\frac{1}{5}\\end{pmatrix},\n$$\n$$\n\\mathbf{g}_{1}=\\mathbf{g}_{0}+\\alpha_{0}A\\mathbf{p}_{0}=\\begin{pmatrix}-1\\\\-1\\end{pmatrix}+\\frac{1}{5}\\begin{pmatrix}7\\\\3\\end{pmatrix}=\\begin{pmatrix}\\frac{2}{5}\\\\-\\frac{2}{5}\\end{pmatrix}.\n$$\n计算 $\\beta_{1}$ 和第二个搜索方向 $\\mathbf{p}_{1}$：\n$$\n\\beta_{1}=\\frac{\\mathbf{g}_{1}^{T}\\mathbf{g}_{1}}{\\mathbf{g}_{0}^{T}\\mathbf{g}_{0}}=\\frac{\\left(\\frac{2}{5}\\right)^{2}+\\left(-\\frac{2}{5}\\right)^{2}}{2}=\\frac{\\frac{8}{25}}{2}=\\frac{4}{25},\n$$\n$$\n\\mathbf{p}_{1}=-\\mathbf{g}_{1}+\\beta_{1}\\mathbf{p}_{0}=-\\begin{pmatrix}\\frac{2}{5}\\\\-\\frac{2}{5}\\end{pmatrix}+\\frac{4}{25}\\begin{pmatrix}1\\\\1\\end{pmatrix}=\\begin{pmatrix}-\\frac{6}{25}\\\\\\frac{14}{25}\\end{pmatrix}.\n$$\n最后，计算 $\\mathbf{p}_{0}^{T}A\\mathbf{p}_{1}$：\n$$\nA\\mathbf{p}_{1}=\\begin{pmatrix}5  2\\\\2  1\\end{pmatrix}\\begin{pmatrix}-\\frac{6}{25}\\\\\\frac{14}{25}\\end{pmatrix}=\\begin{pmatrix}-\\frac{2}{25}\\\\\\frac{2}{25}\\end{pmatrix},\n$$\n$$\n\\mathbf{p}_{0}^{T}A\\mathbf{p}_{1}=\\begin{pmatrix}1  1\\end{pmatrix}\\begin{pmatrix}-\\frac{2}{25}\\\\\\frac{2}{25}\\end{pmatrix}=0.\n$$\n这证实了前两个 CG 搜索方向是 $A$-共轭的。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}