{
    "hands_on_practices": [
        {
            "introduction": "次梯度方法的一个关键特性是，它不像梯度下降法那样保证每一步都能减小目标函数值，这使得步长的选择尤为重要。这个练习将通过一个简单的例子让你亲身体验这一点 。我们将使用一个过大的固定步长来最小化绝对值函数 $f(x) = |x|$，你会发现迭代点会直接“越过”最小值点，这直观地揭示了次梯度法非单调下降的特性。",
            "id": "2207140",
            "problem": "考虑使用次梯度法最小化非光滑凸函数 $f(x) = |x|$ 的问题。次梯度法的迭代更新规则为 $x_{k+1} = x_k - \\alpha_k g_k$，其中 $x_k$ 是第 $k$ 步的迭代点，$\\alpha_k$ 是步长，$g_k$ 是函数 $f$ 在点 $x_k$ 处的一个次梯度。对于函数 $f(x)=|x|$，在任意点 $x \\neq 0$ 处的一个有效次梯度由 $g = \\text{sgn}(x)$ 给出，其中 $\\text{sgn}(x)$ 是符号函数，当 $x>0$ 时返回 $1$，当 $x<0$ 时返回 $-1$。\n\n假设我们从点 $x_0 = 5$ 开始迭代，并对所有步骤使用恒定步长 $\\alpha_k = \\alpha = 10$。\n\n计算下一个迭代点 $x_1$ 的值。",
            "solution": "我们使用次梯度法最小化非光滑凸函数 $f(x)=|x|$，其更新规则为\n$$\nx_{k+1} = x_{k} - \\alpha_{k} g_{k},\n$$\n其中 $g_{k} \\in \\partial f(x_{k})$ 是 $f$ 在 $x_{k}$ 处的一个次梯度。对于 $f(x)=|x|$ 和任意 $x \\neq 0$，一个有效的次梯度是 $g=\\text{sgn}(x)$，其中，如果 $x>0$，则 $\\text{sgn}(x)=1$；如果 $x<0$，则 $\\text{sgn}(x)=-1$。\n\n给定 $x_{0}=5$ 和恒定步长 $\\alpha_{k}=\\alpha=10$，我们计算在 $x_{0}$ 处的次梯度：\n$$\ng_{0}=\\text{sgn}(x_{0})=\\text{sgn}(5)=1.\n$$\n应用更新规则，\n$$\nx_{1}=x_{0}-\\alpha g_{0}=5-10\\cdot 1=-5.\n$$\n因此，下一个迭代点是 $x_{1}=-5$。",
            "answer": "$$\\boxed{-5}$$"
        },
        {
            "introduction": "在函数的不可微点（例如 $L_1$ 范数等值线的“拐角”处），梯度是未定义的，取而代之的是一个包含所有可能方向的次梯度集合，即次微分。这个练习  让你直接探索这个核心概念。通过在同一点为 $L_1$ 范数选择两个不同的有效次梯度，你将计算并观察到优化过程会走向不同的方向，从而深刻理解次梯度的非唯一性及其对算法路径的影响。",
            "id": "2207146",
            "problem": "考虑在 $\\mathbb{R}^2$ 中使用次梯度法最小化 $L_1$ 范数函数 $f(x_1, x_2) = |x_1| + |x_2|$ 的问题。次梯度法的迭代更新法则由下式给出：\n$$x_{k+1} = x_k - \\alpha_k g_k$$\n其中 $x_k$ 是当前迭代点，$\\alpha_k > 0$ 是步长，$g_k$ 是函数 $f$ 在 $x_k$ 处的一个次梯度。\n\n$L_1$ 范数的所有次梯度的集合，称为次微分 $\\partial f(x)$，其定义如下：如果向量 $g = (g_1, g_2)$ 的分量满足以下条件，则该向量是函数 $f(x_1, x_2) = |x_1| + |x_2|$ 在点 $x = (x_1, x_2)$ 处的一个次梯度：\n$$ g_i = \\begin{cases} \\operatorname{sign}(x_i) & \\text{if } x_i \\neq 0 \\\\ v_i & \\text{if } x_i = 0 \\end{cases} $$\n其中 $\\operatorname{sign}(\\cdot)$ 是符号函数，并且对于任何 $x_i=0$ 的分量 $i$，$v_i$ 可以是区间 $[-1, 1]$ 中的任意值。\n\n假设我们从点 $x_0 = (1, 0)$ 开始，并使用固定步长 $\\alpha_0 = 0.5$。由于 $x_0$ 的第二个分量为零，因此该点的次梯度不是唯一的。\n\n让我们考虑在 $x_0$ 处的两个不同的有效次梯度。\n首先，选择次梯度 $g^{(a)}$，其中对应于 $x_0$ 零坐标的分量被设置为其允许区间内的最小可能值。\n其次，选择次梯度 $g^{(b)}$，其中对应于 $x_0$ 零坐标的分量被设置为其允许区间内的最大可能值。\n\n分别使用次梯度 $g^{(a)}$ 和 $g^{(b)}$，应用一步次梯度法，计算得到的下一迭代点 $x_1^{(a)}$ 和 $x_1^{(b)}$。\n\n你的最终答案应该是一个行矩阵，按 $(x_{1}^{(a)}, x_{2}^{(a)}, x_{1}^{(b)}, x_{2}^{(b)})$ 的顺序包含这两个点的四个坐标。",
            "solution": "我们使用次梯度法 $x_{k+1}=x_k-\\alpha_k g_k$ 最小化 $f(x_1,x_2)=|x_1|+|x_2|$，其中 $g_k \\in \\partial f(x_k)$。次微分按分量给出：如果 $x_i \\neq 0$，则 $g_i=\\operatorname{sign}(x_i)$；如果 $x_i=0$，则 $g_i \\in [-1,1]$。\n\n在点 $x_0=(1,0)$ 处，次梯度的分量满足 $g_1=\\operatorname{sign}(1)=1$ 且 $g_2 \\in [-1,1]$。当步长为 $\\alpha_0=\\frac{1}{2}$ 时：\n- 选择 $g^{(a)}=(1,-1)$，即为第二个分量取其允许的最小值。\n- 选择 $g^{(b)}=(1,1)$，即为第二个分量取其允许的最大值。\n\n应用更新法则：\n$$x_{1}^{(a)}=x_{0}-\\alpha_{0}g^{(a)}=(1,0)-\\frac{1}{2}(1,-1)=\\left(1-\\frac{1}{2},\\,0-(-\\frac{1}{2})\\right)=\\left(\\frac{1}{2},\\,\\frac{1}{2}\\right),$$\n$$x_{1}^{(b)}=x_{0}-\\alpha_{0}g^{(b)}=(1,0)-\\frac{1}{2}(1,1)=\\left(1-\\frac{1}{2},\\,0-\\frac{1}{2}\\right)=\\left(\\frac{1}{2},\\,-\\frac{1}{2}\\right).$$\n\n因此，按 $(x_{1}^{(a)}, x_{2}^{(a)}, x_{1}^{(b)}, x_{2}^{(b)})$ 的顺序，行矩阵为 $\\left(\\frac{1}{2},\\,\\frac{1}{2},\\,\\frac{1}{2},\\,-\\frac{1}{2}\\right)$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "许多现实世界中的决策问题，尤其是在经济学和工程学中，需要最小化“最坏情况”下的成本或风险，这常常可以被建模为最小化多个函数的最大值。这个练习  将你置于一个生产计划优化的场景中，其成本函数正是这种形式。你将练习在每次迭代中通过比较函数值来识别“激活”的函数，并选取其梯度作为次梯度，从而逐步优化生产方案，这是一个在实际应用中非常有价值的技巧。",
            "id": "2207196",
            "problem": "一家制造公司正在优化其两种产品的生产计划。设 $x_1$ 和 $x_2$ 分别是产品1和产品2的产量。公司寻求最小化的相关成本函数由 $C(x_1, x_2) = \\max(3x_1 + x_2 + 5, x_1 + 4x_2 - 2)$ 给出。公司使用一种称为次梯度法的迭代优化算法来更新其生产计划。从第 $k$ 次迭代到第 $k+1$ 次，生产向量 $\\mathbf{x} = (x_1, x_2)$ 的更新规则由 $\\mathbf{x}_{k+1} = \\mathbf{x}_k - \\alpha \\mathbf{g}_k$ 给出，其中 $\\mathbf{g}_k$ 是成本函数 $C$ 在点 $\\mathbf{x}_k$ 处的一个次梯度，$\\alpha$ 是一个固定的步长。\n\n初始生产计划为 $\\mathbf{x}_0 = (2, 3)$。公司使用恒定步长 $\\alpha = 0.5$。\n\n计算算法经过两轮完整迭代后的生产计划向量 $\\mathbf{x}_2 = (x_{1,2}, x_{2,2})$。将您的答案表示为行矩阵 $\\begin{bmatrix} x_{1,2} & x_{2,2} \\end{bmatrix}$。",
            "solution": "问题要求我们执行两次次梯度法迭代来最小化成本函数 $C(x_1, x_2) = \\max(3x_1 + x_2 + 5, x_1 + 4x_2 - 2)$。更新规则为 $\\mathbf{x}_{k+1} = \\mathbf{x}_k - \\alpha \\mathbf{g}_k$，初始点为 $\\mathbf{x}_0 = (2, 3)$，步长为 $\\alpha = 0.5$。\n\n首先，我们确定成本函数的组成部分。设 $f_1(x_1, x_2) = 3x_1 + x_2 + 5$ 且 $f_2(x_1, x_2) = x_1 + 4x_2 - 2$。那么 $C(\\mathbf{x}) = \\max(f_1(\\mathbf{x}), f_2(\\mathbf{x}))$。\n\n对于一个定义为多个可微函数的最大值的函数，其在点 $\\mathbf{x}$ 的一个次梯度可以选择为在点 $\\mathbf{x}$“激活”（即其值等于最大值）的任意一个函数的梯度。如果只有一个函数是激活的，那么次梯度是唯一的，并且等于该函数的梯度。\n\n我们这两个线性函数的梯度是常数向量：\n$\\nabla f_1(x_1, x_2) = (3, 1)$\n$\\nabla f_2(x_1, x_2) = (1, 4)$\n\n**第一次迭代 (k=0)**\n\n我们从初始点 $\\mathbf{x}_0 = (2, 3)$ 开始。我们必须首先通过计算 $f_1$ 和 $f_2$ 在该点的值来确定激活的函数：\n$f_1(\\mathbf{x}_0) = 3(2) + 3 + 5 = 6 + 3 + 5 = 14$\n$f_2(\\mathbf{x}_0) = 2 + 4(3) - 2 = 2 + 12 - 2 = 12$\n\n由于 $f_1(\\mathbf{x}_0) = 14$ 严格大于 $f_2(\\mathbf{x}_0) = 12$，因此在 $\\mathbf{x}_0$ 处，$f_1$ 是唯一激活的函数。因此，次梯度 $\\mathbf{g}_0$ 是 $f_1$ 的梯度：\n$\\mathbf{g}_0 = \\nabla f_1 = (3, 1)$\n\n现在我们应用更新规则来找到下一个点 $\\mathbf{x}_1$：\n$\\mathbf{x}_1 = \\mathbf{x}_0 - \\alpha \\mathbf{g}_0 = (2, 3) - 0.5 \\cdot (3, 1)$\n$\\mathbf{x}_1 = (2, 3) - (1.5, 0.5)$\n$\\mathbf{x}_1 = (2 - 1.5, 3 - 0.5) = (0.5, 2.5)$\n\n**第二次迭代 (k=1)**\n\n新的点是 $\\mathbf{x}_1 = (0.5, 2.5)$。我们通过计算 $f_1$ 和 $f_2$ 在 $\\mathbf{x}_1$ 处的值来重复这个过程：\n$f_1(\\mathbf{x}_1) = 3(0.5) + 2.5 + 5 = 1.5 + 2.5 + 5 = 9$\n$f_2(\\mathbf{x}_1) = 0.5 + 4(2.5) - 2 = 0.5 + 10 - 2 = 8.5$\n\n同样，$f_1(\\mathbf{x}_1) = 9$ 严格大于 $f_2(\\mathbf{x}_1) = 8.5$，所以 $f_1$ 仍然是唯一激活的函数。因此，次梯度 $\\mathbf{g}_1$ 是 $f_1$ 的梯度：\n$\\mathbf{g}_1 = \\nabla f_1 = (3, 1)$\n\n我们再应用一次更新规则来找到 $\\mathbf{x}_2$：\n$\\mathbf{x}_2 = \\mathbf{x}_1 - \\alpha \\mathbf{g}_1 = (0.5, 2.5) - 0.5 \\cdot (3, 1)$\n$\\mathbf{x}_2 = (0.5, 2.5) - (1.5, 0.5)$\n$\\mathbf{x}_2 = (0.5 - 1.5, 2.5 - 0.5) = (-1, 2)$\n\n经过两次迭代后，生产计划向量为 $\\mathbf{x}_2 = (-1, 2)$。",
            "answer": "$$\\boxed{\\begin{bmatrix} -1 & 2 \\end{bmatrix}}$$"
        }
    ]
}