{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the QR algorithm, there's no substitute for performing an iteration by hand. This first exercise guides you through one complete step of the unshifted QR algorithm on a simple $2 \\times 2$ symmetric matrix. By calculating the QR decomposition and then computing the next iterate, you will solidify the fundamental mechanics that are the building blocks of this powerful eigenvalue-finding method.",
            "id": "2219215",
            "problem": "The unshifted QR algorithm is an iterative numerical method used to compute the eigenvalues of a matrix. The process begins with a matrix $A_0 = A$. In each iteration $k$ (starting from $k=0$), the matrix $A_k$ is decomposed into a product $A_k = Q_k R_k$, where $Q_k$ is an orthogonal matrix and $R_k$ is an upper triangular matrix. The matrix for the next iteration is then computed as $A_{k+1} = R_k Q_k$.\n\nConsider the initial real symmetric matrix $A_0$ given by:\n$$A_0 = \\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$$\nPerform one full iteration of the unshifted QR algorithm to find the matrix $A_1$. Your final answer should be the matrix $A_1$ with its entries expressed as exact fractions.",
            "solution": "We apply one unshifted QR step to $A_{0}=\\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$. First, we compute the QR decomposition $A_{0}=Q_{0}R_{0}$ using the Gram-Schmidt process. Let the columns of $A_{0}$ be $a_{1}=\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}$ and $a_{2}=\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}$.\n\n1.  Compute the first column of $Q_0$ and the first entry of $R_0$.\n    $r_{11}=\\|a_{1}\\|=\\sqrt{5^{2}+2^{2}}=\\sqrt{29}$.\n    $q_{1}=a_{1}/r_{11}=\\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}$.\n\n2.  Compute the remaining entries of $R_0$ and the second column of $Q_0$.\n    $r_{12}=q_{1}^{T}a_{2}=\\frac{1}{\\sqrt{29}}(5\\cdot 2+2\\cdot 2)=\\frac{14}{\\sqrt{29}}$.\n    Next, compute the vector orthogonal to $q_1$: $u_{2}=a_{2}-r_{12}q_{1}=\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}-\\frac{14}{29}\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}=\\begin{pmatrix} 2 - 70/29 \\\\ 2 - 28/29 \\end{pmatrix} = \\begin{pmatrix} -12/29 \\\\ 30/29 \\end{pmatrix}$.\n    $r_{22}=\\|u_{2}\\|=\\sqrt{(\\frac{-12}{29})^2+(\\frac{30}{29})^2}=\\frac{\\sqrt{144+900}}{29}=\\frac{\\sqrt{1044}}{29}=\\frac{\\sqrt{36 \\cdot 29}}{29}=\\frac{6\\sqrt{29}}{29}$.\n    $q_{2}=u_{2}/r_{22}=\\frac{29}{6\\sqrt{29}}\\begin{pmatrix} -12/29 \\\\ 30/29 \\end{pmatrix}=\\frac{1}{6\\sqrt{29}}\\begin{pmatrix} -12 \\\\ 30 \\end{pmatrix}=\\frac{1}{\\sqrt{29}}\\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}$.\n\n3.  Assemble the matrices $Q_0$ and $R_0$.\n    $$ Q_{0}=\\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 & -2 \\\\ 2 & 5 \\end{pmatrix}, \\quad R_{0}=\\begin{pmatrix} \\sqrt{29} & \\frac{14}{\\sqrt{29}} \\\\ 0 & \\frac{6}{\\sqrt{29}} \\end{pmatrix} $$\n\n4.  Compute the next iterate $A_1 = R_0 Q_0$.\n    $$ A_{1}=R_{0}Q_{0}=\\begin{pmatrix} \\sqrt{29} & \\frac{14}{\\sqrt{29}} \\\\ 0 & \\frac{6}{\\sqrt{29}} \\end{pmatrix} \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 & -2 \\\\ 2 & 5 \\end{pmatrix} = \\frac{1}{29}\\begin{pmatrix} 29 \\cdot 5 + 14 \\cdot 2 & 29 \\cdot (-2) + 14 \\cdot 5 \\\\ 6 \\cdot 2 & 6 \\cdot 5 \\end{pmatrix} $$\n    $$ A_1 = \\frac{1}{29}\\begin{pmatrix} 145 + 28 & -58 + 70 \\\\ 12 & 30 \\end{pmatrix} = \\frac{1}{29}\\begin{pmatrix} 173 & 12 \\\\ 12 & 30 \\end{pmatrix} = \\begin{pmatrix} \\frac{173}{29} & \\frac{12}{29} \\\\ \\frac{12}{29} & \\frac{30}{29} \\end{pmatrix} $$\nThus,\n$$ A_{1}=\\begin{pmatrix} \\frac{173}{29} & \\frac{12}{29} \\\\ \\frac{12}{29} & \\frac{30}{29} \\end{pmatrix}. $$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{173}{29} & \\frac{12}{29} \\\\ \\frac{12}{29} & \\frac{30}{29}\\end{pmatrix}}$$"
        },
        {
            "introduction": "After practicing the mechanics, let's explore the algorithm's behavior in an ideal scenario. This problem considers what happens when the QR algorithm is applied to a matrix that is already diagonal. Investigating such fixed points is crucial for understanding the concept of convergence and what a \"solution\" looks like in the context of this iterative process, as the algorithm's goal is to transform a matrix into a triangular form where eigenvalues are revealed on the diagonal.",
            "id": "2219204",
            "problem": "The basic QR algorithm is an iterative method used to approximate the eigenvalues of a matrix. For a given square matrix $A_k$, one iteration of the algorithm consists of two steps:\n\n1.  Find a QR decomposition of the matrix, which expresses it as a product $A_k = Q_k R_k$, where $Q_k$ is an orthogonal matrix and $R_k$ is an upper triangular matrix.\n2.  Compute the next matrix in the sequence by reversing the order of multiplication: $A_{k+1} = R_k Q_k$.\n\nConsider the initial matrix $A_0 = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$.\n\nWhat is the matrix $A_1$ that results from applying one full iteration of the basic QR algorithm to $A_0$?\n\nA) $\\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n\nB) $\\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$\n\nC) $\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n\nD) $\\begin{pmatrix} -1 & 0 \\\\ 0 & 3 \\end{pmatrix}$\n\nE) $\\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$",
            "solution": "We apply one iteration of the basic QR algorithm to the given matrix $A_{0} = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$.\n\nFirst, we must find a QR decomposition $A_{0} = Q_{0} R_{0}$, where $Q_{0}$ is orthogonal and $R_{0}$ is upper triangular. For uniqueness, a standard convention is to require the diagonal entries of $R_0$ to be positive.\n\nSince $A_0$ is diagonal, we can find its QR decomposition by inspection. We want to express $A_0$ as a product of an orthogonal matrix and an upper-triangular matrix with a positive diagonal. We can factor out the negative sign from the second diagonal entry:\n$$A_{0} = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix}$$\nWe can identify $Q_{0} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$ and $R_{0} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\nThe matrix $Q_0$ is orthogonal (since $Q_0^T Q_0 = I$), and $R_0$ is upper triangular with positive diagonal entries. Thus, this is a valid QR decomposition.\n\nThe second step of the QR iteration defines the next matrix $A_1$ as $A_1 = R_0 Q_0$.\n$$ A_{1} = R_{0} Q_{0} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}. $$\nTherefore, $A_{1} = A_{0}$, which shows that a diagonal matrix with distinct eigenvalues is a fixed point of the QR iteration (up to this choice of decomposition). This corresponds to option E.",
            "answer": "$$\\boxed{E}$$"
        },
        {
            "introduction": "The power of a numerical algorithm lies not just in its procedure, but in its performance and limitations. This final exercise delves into the convergence behavior of the QR algorithm when faced with a more challenging case: a matrix that is a small perturbation of a non-diagonalizable Jordan block. By analyzing how the sub-diagonal entry changes after one iteration, you will gain a deeper appreciation for the factors that influence the algorithm's efficiency and understand why enhancements like shifting strategies are essential for practical applications.",
            "id": "2219199",
            "problem": "The unshifted QR algorithm is a fundamental method for computing the eigenvalues of a matrix. The algorithm generates a sequence of matrices $\\{A_k\\}$ starting with $A_0 = A$. Each step consists of computing the QR decomposition of the current matrix, $A_k = Q_k R_k$, and then reversing the factors to form the next matrix, $A_{k+1} = R_k Q_k$. Here, $Q_k$ is an orthogonal matrix and $R_k$ is an upper-triangular matrix. For a unique decomposition, we enforce the condition that the diagonal entries of $R_k$ must be positive.\n\nThe convergence rate of the algorithm is known to be slow for matrices with eigenvalues of nearly equal magnitude. This behavior is particularly pronounced for matrices that are close to being non-diagonalizable (defective). A canonical example of a defective matrix is a Jordan block.\n\nConsider the matrix $A$ which is a small perturbation of a Jordan block:\n$$\nA = \\begin{pmatrix} \\lambda & 1 \\\\ \\delta^2 & \\lambda \\end{pmatrix}\n$$\nwhere $\\lambda$ is a positive real number and $\\delta$ is a real parameter such that $0 < |\\delta| \\ll \\lambda$. As $\\delta \\to 0$, this matrix approaches a defective Jordan block with a double eigenvalue at $\\lambda$.\n\nLet $A_0 = A$. Perform one full iteration of the unshifted QR algorithm to obtain the matrix $A_1$. The sub-diagonal entry, $(A_1)_{2,1}$, is a key indicator of the algorithm's progress towards finding the eigenvalues. Determine the exact expression for this entry, $(A_1)_{2,1}$, as a function of $\\lambda$ and $\\delta$.",
            "solution": "We write $A$ by columns as $A=[a_{1}\\ a_{2}]$ with $a_{1}=\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$ and $a_{2}=\\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}$. The QR decomposition with positive diagonal entries in $R$ is obtained by the Gram-Schmidt process:\n1) Compute the first column of Q and R.\n$r_{11}=\\|a_{1}\\|_{2}=\\sqrt{\\lambda^{2}+(\\delta^{2})^2}=\\sqrt{\\lambda^{2}+\\delta^{4}}>0$.\n$q_{1}=a_{1}/r_{11}=\\frac{1}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$.\n\n2) Compute the remaining entries of R and the second column of Q.\n$r_{12}=q_{1}^{\\top}a_{2}=\\frac{1}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\left(\\lambda\\cdot 1+\\delta^{2}\\cdot \\lambda\\right)=\\frac{\\lambda(1+\\delta^{2})}{\\sqrt{\\lambda^{2}+\\delta^{4}}}$.\nForm $u_{2}=a_{2}-r_{12}q_{1}$. Using $r_{11}^{2}=\\lambda^{2}+\\delta^{4}$,\n$$\nu_{2}= \\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}-\\frac{\\lambda(1+\\delta^{2})}{\\lambda^{2}+\\delta^{4}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}\n=\\frac{1}{\\lambda^{2}+\\delta^{4}}\\begin{pmatrix}(\\lambda^2+\\delta^4) - \\lambda^2(1+\\delta^2) \\\\ \\lambda(\\lambda^2+\\delta^4) - \\lambda\\delta^2(1+\\delta^2)\\end{pmatrix}\n=\\frac{\\lambda^2-\\delta^2}{\\lambda^2+\\delta^4}\\begin{pmatrix}-\\delta^{2}\\\\ \\lambda\\end{pmatrix}.\n$$\n$r_{22}=\\|u_{2}\\|_{2}=\\left|\\frac{\\lambda^{2}-\\delta^{2}}{\\lambda^{2}+\\delta^{4}}\\right|\\sqrt{(-\\delta^2)^2+\\lambda^{2}}=\\frac{|\\lambda^{2}-\\delta^{2}|}{\\lambda^{2}+\\delta^{4}}\\sqrt{\\lambda^{2}+\\delta^{4}}=\\frac{|\\lambda^{2}-\\delta^{2}|}{\\sqrt{\\lambda^{2}+\\delta^{4}}}>0$.\n\n3) Form the next iterate $A_1 = R_0 Q_0$.\nThe sub-diagonal entry is $(A_{1})_{2,1}=R_{2,1}Q_{1,1}+R_{2,2}Q_{2,1}$. Since $R$ is upper triangular, $R_{2,1}=0$, so $(A_{1})_{2,1}=r_{22}Q_{2,1}$.\nFrom the Gram-Schmidt process, $Q_{2,1}$ is the second component of the first column vector $q_1$. We have $q_{1} = \\frac{1}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$, so $Q_{2,1} = \\frac{\\delta^{2}}{\\sqrt{\\lambda^{2}+\\delta^{4}}}$.\n\n4) Substitute the expressions for $r_{22}$ and $Q_{2,1}$.\n$$\n(A_{1})_{2,1}=r_{22} \\cdot Q_{2,1} = \\frac{|\\lambda^{2}-\\delta^{2}|}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\\cdot \\frac{\\delta^{2}}{\\sqrt{\\lambda^{2}+\\delta^{4}}}\n=\\frac{\\delta^{2}\\,|\\lambda^{2}-\\delta^{2}|}{\\lambda^{2}+\\delta^{4}}.\n$$\nGiven the stated regime $0<|\\delta|\\ll \\lambda$ with $\\lambda>0$, we have $\\lambda^{2}-\\delta^{2}>0$, so the absolute value can be dropped, yielding\n$$\n(A_{1})_{2,1}=\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}.\n$$",
            "answer": "$$\\boxed{\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}}$$"
        }
    ]
}