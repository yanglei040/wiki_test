{
    "hands_on_practices": [
        {
            "introduction": "要掌握障碍函数法，第一步是理解其核心构件：对数障碍函数本身。这个函数通过在可行域的边界上设置一个“惩罚”，从而将约束问题转化为无约束问题。为了使用基于梯度的方法来最小化这个新的目标函数，我们必须首先计算它的梯度。这个练习  将引导你推导一个典型线性约束下的对数障碍函数的梯度，这是任何内点法算法的基础计算。",
            "id": "2155906",
            "problem": "在优化领域，内点法是用于求解线性和非线性凸优化问题的一类算法。这些方法的一个关键组成部分是使用障碍函数来处理不等式约束。\n\n考虑一个由$\\mathbb{R}^n$中的$m$个线性不等式组定义的可行集，其矩阵形式写作$Ax \\le b$，其中$A$是一个$m \\times n$矩阵，$b$是一个$m \\times 1$向量。设$a_i^T$表示矩阵$A$的第$i$行，设$b_i$为向量$b$的第$i$个分量。因此，第$i$个不等式为$a_i^T x \\le b_i$。\n\n对于这组不等式，标准的对数障碍函数定义在严格可行的点$x$上（即，对所有$i=1, \\dots, m$都有$a_i^T x  b_i$）：\n$$ \\phi(x) = -\\sum_{i=1}^m \\ln(b_i - a_i^T x) $$\n你的任务是确定该函数的梯度$\\nabla \\phi(x)$。请用向量$a_i$（其中$a_i$是行向量$a_i^T$转置后对应的列向量）、$x$和标量$b_i$来表示你的最终答案。",
            "solution": "给定严格可行点$x$的对数障碍函数：\n$$\n\\phi(x) = -\\sum_{i=1}^{m} \\ln\\!\\big(b_i - a_i^{T} x\\big).\n$$\n对每个$i$，定义$f_i(x) = -\\ln\\!\\big(b_i - a_i^{T} x\\big)$。根据应用于标量函数$g(u) = -\\ln(u)$与$u_i(x) = b_i - a_i^{T} x$复合的链式法则，我们有\n$$\n\\nabla f_i(x) = g^{\\prime}\\!\\big(u_i(x)\\big)\\,\\nabla u_i(x).\n$$\n计算导数：\n- $g^{\\prime}(u) = -\\frac{1}{u}$，所以$g^{\\prime}\\!\\big(u_i(x)\\big) = -\\frac{1}{b_i - a_i^{T} x}$。\n- 由于$u_i(x) = b_i - a_i^{T} x$是仿射函数，其梯度为$\\nabla u_i(x) = -a_i$。\n\n因此，\n$$\n\\nabla f_i(x) = -\\frac{1}{b_i - a_i^{T} x}\\,(-a_i) = \\frac{a_i}{b_i - a_i^{T} x}.\n$$\n对所有$i$求和，\n$$\n\\nabla \\phi(x) = \\sum_{i=1}^{m} \\nabla f_i(x) = \\sum_{i=1}^{m} \\frac{a_i}{b_i - a_i^{T} x}.\n$$\n该表达式对于满足所有$i$都有$a_i^{T} x  b_i$的严格可行点$x$是有效的。",
            "answer": "$$\\boxed{\\sum_{i=1}^{m}\\frac{a_i}{b_i - a_i^{T} x}}$$"
        },
        {
            "introduction": "中心路径是障碍函数法中的一个核心理论概念，它描述了随着障碍参数 $t$ 的变化，一系列无约束子问题的解如何逐渐逼近原始问题的最优解。虽然这个概念可能听起来很抽象，但通过一个简单的例子，我们可以清晰地看到它的具体形态。这个练习  要求你为一个一维线性规划问题显式地推导出中心路径的表达式，从而将抽象的路径概念转化为一个具体的函数。",
            "id": "2155925",
            "problem": "考虑一个简单的一维线性规划问题，定义如下：\n最小化 $f(x) = c x$\n约束条件为 $x \\ge 0$\n其中 $x$ 是一个标量变量，$c$ 是一个给定的正常数，满足 $c > 0$。\n\n为了使用内点法求解此问题，我们可以采用对数障碍函数。通过在目标函数中增加一个障碍项，原始的约束问题被转化为一系列无约束优化问题。此问题的修正后目标函数由下式给出：\n$$P(x; t) = t(cx) - \\ln(x)$$\n其中 $t > 0$ 是一个标量障碍参数。对于给定的 $t$ 值，$P(x; t)$ 的最小化点是所谓的“中心路径”上的一个点，我们记此点为 $x^*(t)$。\n\n请确定中心路径点 $x^*(t)$ 关于常数 $c$ 和 $t$ 的显式公式。",
            "solution": "我们考虑对于 $x>0$ 的障碍增广目标函数：\n$$\nP(x;t) = t c x - \\ln(x),\n$$\n其中 $t>0$ 且 $c>0$。为了找到中心路径点 $x^{*}(t)$，我们将一阶导数设为零：\n$$\n\\frac{dP}{dx} = t c - \\frac{1}{x} = 0.\n$$\n求解 $x$ 可得\n$$\n\\frac{1}{x} = t c \\quad \\Rightarrow \\quad x^{*}(t) = \\frac{1}{c t}.\n$$\n为了验证这是一个最小化点，我们检查二阶导数：\n$$\n\\frac{d^{2}P}{dx^{2}} = \\frac{1}{x^{2}} > 0 \\quad \\text{for } x>0,\n$$\n因此 $P(\\cdot;t)$ 在其定义域上是严格凸的，该临界点是唯一的最小化点。所以，中心路径为\n$$\nx^{*}(t) = \\frac{1}{c t}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{c t}}$$"
        },
        {
            "introduction": "理论和概念最终需要通过有效的算法来实现。在内点法中，求解中心路径上的点（即每一步的无约束子问题）通常采用牛顿法，因为它具有快速的局部收敛性。这个练习  将带你进入算法的内部，推导求解二次规划（QP）问题的原始-对偶内点法中牛顿方向所需要求解的线性系统。理解这个系统的构建方式是理解现代优化求解器如何工作的关键一步。",
            "id": "2155926",
            "problem": "考虑一个标准的凸二次规划 (QP) 问题，其目标是在线性不等式约束下最小化一个二次函数：\n$$\n\\min_{x \\in \\mathbb{R}^n} \\frac{1}{2}x^T Q x + c^T x \\quad \\text{subject to} \\quad Ax \\le b\n$$\n其中，$x \\in \\mathbb{R}^n$ 是优化变量，$Q \\in \\mathbb{R}^{n \\times n}$ 是一个对称半正定矩阵，$c \\in \\mathbb{R}^n$ 是一个向量，$A \\in \\mathbb-R}^{m \\times n}$ 是一个矩阵，$b \\in \\mathbb-R}^m$ 是一个向量。\n\n原始-对偶内点法是解决此类问题的一种强大技术。该方法通过引入松弛变量 $s \\in \\mathbb-R}^m$ 将不等式约束转化为等式约束（$Ax+s=b, s \\ge 0$），然后对 $s$ 的非负性约束应用对数障碍函数。这种方法将原始约束问题转化为一个寻找解 $(x, \\lambda, s)$ 的任务，该解满足一组关于参数 $t0$ 的扰动 Karush-Kuhn-Tucker (KKT) 条件：\n1. $Qx + c + A^T \\lambda = 0$\n2. $Ax + s - b = 0$\n3. $\\text{diag}(s)\\lambda = (1/t)\\mathbf{1}$\n\n这里，$\\lambda \\in \\mathbb-R}^m$ 是对偶变量向量，$\\mathbf{1}$ 是所有元素都为1的 $m \\times 1$ 向量，$\\text{diag}(v)$ 表示一个方阵，其主对角线上的元素是向量 $v$ 的元素，其他位置为零。\n\n为了求解这个非线性系统，我们采用牛顿法。在每次迭代中，给定一个严格可行点 $(x, \\lambda, s)$（其中 $s>0, \\lambda>0$），我们通过求解对 KKT 方程进行线性化得到的线性系统来计算搜索方向 $(\\Delta x, \\Delta \\lambda, \\Delta s)$。该线性系统可以写成 3x3 分块矩阵的形式：\n$$\n\\begin{pmatrix} M_{11}  M_{12}  M_{13} \\\\ M_{21}  M_{22}  M_{23} \\\\ M_{31}  M_{32}  M_{33} \\end{pmatrix} \\begin{pmatrix} \\Delta x \\\\ \\Delta \\lambda \\\\ \\Delta s \\end{pmatrix} = \\begin{pmatrix} r_{\\text{dual}} \\\\ r_{\\text{primal}} \\\\ r_{\\text{cent}} \\end{pmatrix}\n$$\n其中左侧的矩阵是 KKT 方程组的雅可比矩阵。\n\n确定构成该雅可比矩阵第一分块列的分块矩阵：$M_{11}$、$M_{21}$ 和 $M_{31}$。用问题数据（$Q, A, b, c$）和当前迭代的变量（$x, \\lambda, s$）来表示你的答案。你的最终答案应该是一个复合行矩阵，按顺序包含这三个所需的分块矩阵。使用 $I$ 表示单位矩阵，使用 $0$ 表示适当维度的零矩阵。",
            "solution": "我们将扰动的 KKT 方程写成映射形式\n$$\nF(x,\\lambda,s) \\equiv \\begin{pmatrix}\nQx + c + A^{T}\\lambda \\\\\nAx + s - b \\\\\n\\operatorname{diag}(s)\\lambda - \\frac{1}{t}\\mathbf{1}\n\\end{pmatrix} = 0.\n$$\n牛顿系统在严格可行点处对此映射进行线性化，并使用其雅可比矩阵。雅可比矩阵的第一分块列由每个分块方程对 $x$ 的偏导数组成。\n\n对于第一个方程 $Qx + c + A^{T}\\lambda = 0$，其关于 $x$ 的导数为\n$$\n\\frac{\\partial}{\\partial x}(Qx + c + A^{T}\\lambda) = Q,\n$$\n所以 $M_{11} = Q$。\n\n对于第二个方程 $Ax + s - b = 0$，其关于 $x$ 的导数为\n$$\n\\frac{\\partial}{\\partial x}(Ax + s - b) = A,\n$$\n所以 $M_{21} = A$。\n\n对于第三个方程 $\\operatorname{diag}(s)\\lambda - \\frac{1}{t}\\mathbf{1} = 0$，它不依赖于 $x$，因此\n$$\n\\frac{\\partial}{\\partial x}\\big(\\operatorname{diag}(s)\\lambda - \\tfrac{1}{t}\\mathbf{1}\\big) = 0,\n$$\n所以 $M_{31} = 0$（具有适当的维度 $m \\times n$）。\n\n因此，第一分块列由三个分块 $M_{11} = Q$、$M_{21} = A$ 和 $M_{31} = 0$ 给出，我们按照所要求的复合行矩阵顺序列出它们。",
            "answer": "$$\\boxed{\\begin{pmatrix} Q  A  0 \\end{pmatrix}}$$"
        }
    ]
}