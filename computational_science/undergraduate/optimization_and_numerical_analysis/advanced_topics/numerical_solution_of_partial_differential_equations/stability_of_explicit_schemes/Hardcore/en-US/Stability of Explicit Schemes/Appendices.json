{
    "hands_on_practices": [
        {
            "introduction": "A crucial aspect of designing numerical simulations is understanding the trade-off between accuracy and computational cost. For explicit schemes like FTCS, increasing spatial resolution to capture finer details has a direct and often severe impact on the required time step to maintain stability. This first exercise  guides you through a thought experiment to quantify this relationship, revealing the steep computational price of refining the simulation grid.",
            "id": "2205166",
            "problem": "A numerical analyst is simulating heat diffusion along a one-dimensional, uniform rod. The temperature evolution is governed by the heat equation, $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$, where $u(x,t)$ is the temperature, $t$ is time, $x$ is the spatial coordinate along the rod, and $\\alpha$ is the constant thermal diffusivity of the material.\n\nThe analyst uses the Forward-Time Central-Space (FTCS) method for the simulation. In an initial run, the spatial grid spacing is set to $\\Delta x_0$ and the time step is set to $\\Delta t_0$. These values are chosen such that the simulation operates at the critical limit, meaning any larger time step would cause the numerical solution to develop unbounded, non-physical oscillations.\n\nTo improve the spatial resolution of the simulation, the analyst decides to perform a new run with the spatial grid spacing halved, such that the new spacing is $\\Delta x_{new} = \\frac{1}{2}\\Delta x_0$. To ensure this new, higher-resolution simulation also runs at its corresponding critical limit to avoid non-physical oscillations, the time step must be adjusted to a new value, $\\Delta t_{new}$.\n\nDetermine the numerical factor by which the original time step $\\Delta t_0$ must be multiplied to obtain the new time step $\\Delta t_{new}$. Your answer should be a single numerical value.",
            "solution": "For the one-dimensional heat equation discretized by the FTCS scheme on a uniform grid, the update formula is\n$$\nu_{j}^{n+1} = u_{j}^{n} + r\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right),\n$$\nwhere the dimensionless parameter is\n$$\nr = \\frac{\\alpha \\,\\Delta t}{\\Delta x^{2}}.\n$$\nVon Neumann stability analysis for FTCS applied to the heat equation yields the stability condition\n$$\nr \\leq \\frac{1}{2}.\n$$\nOperating at the critical limit means equality holds. For the initial run with spacings $\\Delta x_{0}$ and $\\Delta t_{0}$,\n$$\n\\frac{\\alpha \\,\\Delta t_{0}}{\\Delta x_{0}^{2}} = \\frac{1}{2}\n\\quad \\Longrightarrow \\quad\n\\Delta t_{0} = \\frac{\\Delta x_{0}^{2}}{2\\alpha}.\n$$\nFor the new run, the spatial step is halved, $\\Delta x_{\\text{new}} = \\frac{1}{2}\\Delta x_{0}$, and to remain at the critical limit we require\n$$\n\\frac{\\alpha \\,\\Delta t_{\\text{new}}}{\\Delta x_{\\text{new}}^{2}} = \\frac{1}{2}\n\\quad \\Longrightarrow \\quad\n\\Delta t_{\\text{new}} = \\frac{\\Delta x_{\\text{new}}^{2}}{2\\alpha}.\n$$\nSubstituting $\\Delta x_{\\text{new}} = \\frac{1}{2}\\Delta x_{0}$ gives\n$$\n\\Delta t_{\\text{new}} = \\frac{\\left(\\frac{1}{2}\\Delta x_{0}\\right)^{2}}{2\\alpha} = \\frac{\\Delta x_{0}^{2}}{2\\alpha}\\cdot \\frac{1}{4} = \\Delta t_{0}\\cdot \\frac{1}{4}.\n$$\nTherefore, the original time step must be multiplied by the factor $\\frac{1}{4}$.",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "Building on the one-dimensional case, this practice extends the concept of numerical stability to higher dimensions, where physical phenomena are often more complex. You will calculate the maximum stable time step for a simulation of heat diffusing across a two-dimensional surface . This problem illustrates how stability constraints from multiple spatial dimensions combine, making the choice of $\\Delta t$ even more restrictive and critical for a successful simulation.",
            "id": "2205183",
            "problem": "A materials science student is developing a numerical simulation to model heat diffusion across a thin, rectangular silicon wafer. The temperature distribution $u(x,y,t)$ on the wafer is governed by the two-dimensional heat equation:\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\nThe student implements a numerical solution using the explicit Forward Time, Central Space (FTCS) finite difference method. For the simulation grid, the following parameters are used:\n- The thermal diffusivity of silicon, $\\alpha = 0.85 \\text{ cm}^2/\\text{s}$.\n- The spatial step size in the x-direction, $\\Delta x = 0.05 \\text{ cm}$.\n- The spatial step size in the y-direction, $\\Delta y = 0.12 \\text{ cm}$.\n\nTo prevent the numerical solution from becoming unstable and producing nonsensical results, the time step $\\Delta t$ must be chosen carefully. Calculate the maximum possible value for the time step $\\Delta t$ that will ensure the stability of this FTCS simulation.\n\nProvide your answer in seconds (s), rounded to three significant figures.",
            "solution": "The problem asks for the maximum time step $\\Delta t_{max}$ for which the Forward Time, Central Space (FTCS) scheme applied to the two-dimensional heat equation is numerically stable.\n\nThe two-dimensional heat equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n\nThe FTCS scheme discretizes this equation. The time derivative is approximated using a forward difference, and the spatial derivatives are approximated using central differences. Let $u_{i,j}^n$ represent the temperature at spatial grid point $(i\\Delta x, j\\Delta y)$ and time step $n\\Delta t$. The discretized equation is:\n$$\n\\frac{u_{i,j}^{n+1} - u_{i,j}^{n}}{\\Delta t} = \\alpha \\left( \\frac{u_{i+1,j}^{n} - 2u_{i,j}^{n} + u_{i-1,j}^{n}}{(\\Delta x)^2} + \\frac{u_{i,j+1}^{n} - 2u_{i,j}^{n} + u_{i,j-1}^{n}}{(\\Delta y)^2} \\right)\n$$\n\nFor this explicit scheme to be stable, the coefficients in the update equation for $u_{i,j}^{n+1}$ must satisfy certain conditions. A von Neumann stability analysis shows that the stability condition for the 2D FTCS heat equation is:\n$$\n2 \\alpha \\Delta t \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) \\le 1\n$$\nThis can also be written as:\n$$\n\\Delta t \\le \\frac{1}{2\\alpha \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)}\n$$\n\nThe maximum allowable time step, $\\Delta t_{max}$, corresponds to the equality in this relation:\n$$\n\\Delta t_{max} = \\frac{1}{2\\alpha \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right)}\n$$\n\nNow, we substitute the given values into this expression:\n- $\\alpha = 0.85 \\text{ cm}^2/\\text{s}$\n- $\\Delta x = 0.05 \\text{ cm}$\n- $\\Delta y = 0.12 \\text{ cm}$\n\nFirst, we calculate the terms involving the spatial steps:\n$$\n(\\Delta x)^2 = (0.05 \\text{ cm})^2 = 0.0025 \\text{ cm}^2\n$$\n$$\n(\\Delta y)^2 = (0.12 \\text{ cm})^2 = 0.0144 \\text{ cm}^2\n$$\n\nNext, we find their reciprocals:\n$$\n\\frac{1}{(\\Delta x)^2} = \\frac{1}{0.0025 \\text{ cm}^2} = 400 \\text{ cm}^{-2}\n$$\n$$\n\\frac{1}{(\\Delta y)^2} = \\frac{1}{0.0144 \\text{ cm}^2} \\approx 69.444... \\text{ cm}^{-2}\n$$\n\nNow, we sum these values:\n$$\n\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} = 400 \\text{ cm}^{-2} + 69.444... \\text{ cm}^{-2} = 469.444... \\text{ cm}^{-2}\n$$\n\nFinally, we substitute this sum and the value of $\\alpha$ into the equation for $\\Delta t_{max}$:\n$$\n\\Delta t_{max} = \\frac{1}{2 \\cdot (0.85 \\text{ cm}^2/\\text{s}) \\cdot (469.444... \\text{ cm}^{-2})}\n$$\n$$\n\\Delta t_{max} = \\frac{1}{1.7 \\text{ cm}^2/\\text{s} \\cdot 469.444... \\text{ cm}^{-2}}\n$$\n$$\n\\Delta t_{max} = \\frac{1}{798.055... \\text{ s}^{-1}} \\approx 0.00125304 \\text{ s}\n$$\n\nThe problem asks for the answer to be rounded to three significant figures.\nThe first significant figure is 1, the second is 2, and the third is 5. The next digit is 3, which is less than 5, so we round down.\n$$\n\\Delta t_{max} \\approx 0.00125 \\text{ s}\n$$",
            "answer": "$$\\boxed{0.00125}$$"
        },
        {
            "introduction": "So far, we have worked with the standard heat equation. However, real-world physical models often include additional effects, such as heat loss or reaction terms. This final exercise  challenges you to go beyond applying a known formula and instead derive a new stability condition from first principles using von Neumann analysis for a modified PDE. Mastering this technique is essential, as it equips you to analyze the stability of any new explicit scheme you may encounter in your future work.",
            "id": "2205168",
            "problem": "A long, thin conductive rod is aligned with the x-axis. Heat flows along the rod according to the principles of thermal diffusion, and the rod also loses heat to the surrounding environment along its entire length. The temperature of the rod, $u(x,t)$, is described by the partial differential equation:\n$$ \\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2} - \\beta u $$\nwhere $\\alpha$ is the thermal diffusivity and $\\beta$ is a positive constant representing the rate of heat loss to the surroundings.\n\nTo solve this equation numerically, we use the Forward-Time Central-Space (FTCS) method. The domain is discretized with a spatial step $\\Delta x$ and a time step $\\Delta t$, such that $u_j^n \\approx u(j\\Delta x, n\\Delta t)$. The FTCS scheme for this equation is:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right) - \\beta u_j^n $$\nFor this numerical scheme to produce a stable solution (i.e., one that does not grow without bound due to numerical errors), the time step $\\Delta t$ must be smaller than a certain critical value, $\\Delta t_{max}$.\n\nUsing von Neumann stability analysis, determine the expression for the maximum stable time step, $\\Delta t_{max}$, in terms of the parameters $\\alpha$, $\\beta$, and $\\Delta x$. Assume both $\\alpha$ and $\\beta$ are positive constants.",
            "solution": "We start from the FTCS discretization\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\alpha\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}-\\beta u_{j}^{n}.$$\nRearranging and defining $r=\\alpha\\Delta t/(\\Delta x)^{2}$ gives the update\n$$u_{j}^{n+1}=\\left(1-2r-\\beta\\Delta t\\right)u_{j}^{n}+r\\left(u_{j+1}^{n}+u_{j-1}^{n}\\right).$$\nFor von Neumann stability analysis, assume a Fourier mode $u_{j}^{n}=G^{n}\\exp(i k j \\Delta x)$, where $G$ is the amplification factor. Substituting $u_{j\\pm 1}^{n}=G^{n}\\exp(i k j \\Delta x)\\exp(\\pm i k \\Delta x)$ into the update and dividing by $G^{n}\\exp(i k j \\Delta x)$ yields\n$$G=1-2r-\\beta\\Delta t+r\\left(\\exp(i k \\Delta x)+\\exp(-i k \\Delta x)\\right)=1-\\beta\\Delta t+2r\\left(\\cos(k\\Delta x)-1\\right).$$\nUsing $\\cos\\theta-1=-2\\sin^{2}(\\theta/2)$ with $\\theta=k\\Delta x$ gives\n$$G=1-\\beta\\Delta t-4r\\sin^{2}\\!\\left(\\frac{k\\Delta x}{2}\\right).$$\nBecause $G$ is real and $\\sin^{2}$ ranges in $[0,1]$, $G$ ranges over\n$$G\\in\\left[\\,1-\\beta\\Delta t-4r,\\;1-\\beta\\Delta t\\,\\right].$$\nStability requires $|G|\\leq 1$ for all wavenumbers. The upper endpoint satisfies $1-\\beta\\Delta t\\leq 1$ automatically, and to prevent $|G|>1$ at $\\sin^{2}=0$ we need\n$$-1\\leq 1-\\beta\\Delta t\\quad\\Longrightarrow\\quad \\beta\\Delta t\\leq 2.$$\nFor the lower endpoint at $\\sin^{2}=1$, we require\n$$1-\\beta\\Delta t-4r\\geq -1\\quad\\Longrightarrow\\quad 4r+\\beta\\Delta t\\leq 2.$$\nSince $r=\\alpha\\Delta t/(\\Delta x)^{2}$ and $r\\geq 0$, the condition $4r+\\beta\\Delta t\\leq 2$ implies $\\beta\\Delta t\\leq 2$ and is therefore the binding constraint. Substituting $r$ yields\n$$4\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}+\\beta\\Delta t\\leq 2\\quad\\Longrightarrow\\quad \\Delta t\\leq \\frac{2}{\\beta+\\frac{4\\alpha}{(\\Delta x)^{2}}}=\\frac{2(\\Delta x)^{2}}{4\\alpha+\\beta(\\Delta x)^{2}}.$$\nThus, the maximum stable time step is\n$$\\Delta t_{\\max}=\\frac{2}{\\beta+\\frac{4\\alpha}{(\\Delta x)^{2}}}=\\frac{2(\\Delta x)^{2}}{4\\alpha+\\beta(\\Delta x)^{2}}.$$",
            "answer": "$$\\boxed{\\frac{2(\\Delta x)^{2}}{4\\alpha+\\beta(\\Delta x)^{2}}}$$"
        }
    ]
}