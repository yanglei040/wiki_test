{
    "hands_on_practices": [
        {
            "introduction": "在使用显式有限差分法求解波动方程时，首要任务是确保模拟的稳定性。Courant-Friedrichs-Lewy (CFL) 条件为我们提供了一个关键准则，它将时间步长$\\Delta t$、空间步长$\\Delta x$和波速$c$联系起来，防止数值解出现无界的增长。这个练习将指导你如何应用 CFL 条件来计算保证稳定性的最大时间步长，这是设置任何波动方程数值模拟的第一个实际步骤。",
            "id": "2172272",
            "problem": "一位计算物理学家正在模拟声波在一维管道中的传播，该过程由波动方程 $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}$ 描述。介质中的声速为 $c = 320$ m/s。该模拟在空间网格上采用显式有限差分格式，空间步长为 $\\Delta x = 0.8$ m。为使该数值方法保持稳定，所选的时间步长 $\\Delta t$ 必须满足 Courant-Friedrichs-Lewy (CFL) 稳定性条件，该条件由关系式 $c \\frac{\\Delta t}{\\Delta x} \\le 1$ 给出。请确定能确保模拟稳定性的时间步长 $\\Delta t$ 的最大可能值。答案以秒为单位表示。",
            "solution": "应用于一维波动方程的显式有限差分格式的 Courant-Friedrichs-Lewy (CFL) 稳定性条件由下式给出\n$$\nc \\frac{\\Delta t}{\\Delta x} \\le 1.\n$$\n为了在确保稳定性的前提下使用可能的最大时间步长，我们将不等式取等号：\n$$\nc \\frac{\\Delta t_{\\max}}{\\Delta x} = 1 \\quad \\Rightarrow \\quad \\Delta t_{\\max} = \\frac{\\Delta x}{c}.\n$$\n代入给定值 $\\Delta x = 0.8$ 和 $c = 320$：\n$$\n\\Delta t_{\\max} = \\frac{0.8}{320}.\n$$\n化简该分数：\n$$\n\\frac{0.8}{320} = \\frac{8}{3200} = \\frac{1}{400} = 0.0025.\n$$\n因此，最大稳定时间步长为 $0.0025$ 秒。",
            "answer": "$$\\boxed{0.0025}$$"
        },
        {
            "introduction": "理论上的差分格式通常在无限大的或简单的矩形区域中推导，但在实际应用中，我们常常需要处理具有复杂几何形状的区域。当网格点靠近不规则边界时，标准的更新模板需要进行调整以正确地包含边界条件。这个练习模拟了一个在 L 形膜上的二维波传播问题，它将让你实践如何修改标准五点模板以适应齐次狄利克雷边界条件，这是处理非标准几何区域的一项核心技能。",
            "id": "2172249",
            "problem": "考虑二维波动方程 $u_{tt} = c^2 (u_{xx} + u_{yy})$，该方程模拟了薄膜在位置 $(x,y)$ 和时间 $t$ 的位移 $u(x,y,t)$。常数 $c$ 是波的传播速度。我们感兴趣的是在单位正方形内一个特定框架上拉伸的薄膜的行为。\n\n该框架定义了一个边界 $\\partial\\Omega$，薄膜在该边界上是固定的，这意味着一个齐次狄利克雷边界条件：对于框架上的所有点 $(x,y)$，有 $u(x,y,t) = 0$。该框架由单位正方形 $[0,1]\\times[0,1]$ 的外周长和一个内部的L形边界组成，该L形边界由两个线段的并集定义：$\\{ (x, 0.5) \\mid 0.5 \\le x \\le 1 \\}$ 和 $\\{ (0.5, y) \\mid 0.5 \\le y \\le 1 \\}$。这实际上将正方形的右上角四分之一区域从振动区域中移除。\n\n为了数值求解此问题，在 $[0,1]\\times[0,1]$ 正方形上铺设一个均匀网格，空间网格间距为 $\\Delta x = \\Delta y = h$，时间步长为 $\\Delta t$。我们将网格点上位移的数值近似值表示为 $u_{i,j}^k \\approx u(ih, jh, k\\Delta t)$。波动方程的标准显式有限差分格式由五点模板给出：\n$$u_{i,j}^{k+1} = 2(1 - 2\\lambda^2)u_{i,j}^k - u_{i,j}^{k-1} + \\lambda^2 (u_{i+1,j}^k + u_{i-1,j}^k + u_{i,j+1}^k + u_{i,j-1}^k)$$\n其中 $\\lambda = \\frac{c \\Delta t}{h}$ 是库朗数。\n\n假设对于一个大的偶数整数 $N$，网格间距设置为 $h = 1/N$。考虑位于坐标 $(0.5-h, 0.5)$ 的内部网格点 $P$。设该点的网格索引为 $(I, J)$，其中 $I = N/2 - 1$ 且 $J=N/2$。\n\n推导该点位移 $u_{I,J}^{k+1}$ 的具体更新方程。您的答案应为一个用 $\\lambda$ 以及在时间步 $k$ 和 $k-1$ 时相关网格点上的 $u$ 值表示的 $u_{I,J}^{k+1}$ 的表达式。",
            "solution": "问题要求推导网格索引为 $(I,J)$、坐标为 $(x_I, y_J) = ((N/2-1)h, (N/2)h) = (0.5-h, 0.5)$ 的点 $P$ 的具体有限差分更新方程。\n\n通用的更新方程如下：\n$$u_{i,j}^{k+1} = 2(1 - 2\\lambda^2)u_{i,j}^k - u_{i,j}^{k-1} + \\lambda^2 (u_{i+1,j}^k + u_{i-1,j}^k + u_{i,j+1}^k + u_{i,j-1}^k)$$\n\n为了找到点 $(I,J)$ 的具体方程，我们需要分析其模板中涉及的四个邻居点的位置：$(I+1, J)$、$(I-1, J)$、$(I, J+1)$ 和 $(I, J-1)$。\n\n1.  **东侧邻居：** 索引为 $(I+1, J)$ 的点。\n    其坐标为 $(x_{I+1}, y_J) = ((I+1)h, Jh) = ((N/2)h, (N/2)h) = (0.5, 0.5)$。\n    该点位于内部L形边界上，特别是在线段 $\\{ (x, 0.5) \\mid 0.5 \\le x \\le 1 \\}$ 和 $\\{ (0.5, y) \\mid 0.5 \\le y \\le 1 \\}$ 交汇的角落。根据齐次狄利克雷边界条件，任何边界点上的位移在所有时间内均为零。\n    因此，$u_{I+1,J}^k = 0$。\n\n2.  **西侧邻居：** 索引为 $(I-1, J)$ 的点。\n    其坐标为 $(x_{I-1}, y_J) = ((I-1)h, Jh) = ((N/2-2)h, (N/2)h) = (0.5-2h, 0.5)$。\n    由于 $0  0.5-2h  0.5$，该点是薄膜的一个内部点。值 $u_{I-1,J}^k$ 是仿真中需要求解的未知数。\n\n3.  **北侧邻居：** 索引为 $(I, J+1)$ 的点。\n    其坐标为 $(x_I, y_{J+1}) = (Ih, (J+1)h) = ((N/2-1)h, (N/2+1)h) = (0.5-h, 0.5+h)$。\n    由于 $0  0.5-h  0.5$ 且 $0.5  0.5+h  1$，该点是一个内部点。值 $u_{I,J+1}^k$ 是一个未知数。\n\n4.  **南侧邻居：** 索引为 $(I, J-1)$ 的点。\n    其坐标为 $(x_I, y_{J-1}) = (Ih, (J-1)h) = ((N/2-1)h, (N/2-1)h) = (0.5-h, 0.5-h)$。\n    由于 $0  0.5-h  0.5$，该点是一个内部点。值 $u_{I,J-1}^k$ 是一个未知数。\n\n现在我们将这些发现代入 $(i,j)=(I,J)$ 的通用模板中：\n$$u_{I,J}^{k+1} = 2(1 - 2\\lambda^2)u_{I,J}^k - u_{I,J}^{k-1} + \\lambda^2 (u_{I+1,J}^k + u_{I-1,J}^k + u_{I,J+1}^k + u_{I,J-1}^k)$$\n\n代入 $u_{I+1,J}^k = 0$：\n$$u_{I,J}^{k+1} = 2(1 - 2\\lambda^2)u_{I,J}^k - u_{I,J}^{k-1} + \\lambda^2 (0 + u_{I-1,J}^k + u_{I,J+1}^k + u_{I,J-1}^k)$$\n\n简化表达式得到点 $P$ 的具体更新方程：\n$$u_{I,J}^{k+1} = 2(1 - 2\\lambda^2)u_{I,J}^k - u_{I,J}^{k-1} + \\lambda^2 (u_{I-1,J}^k + u_{I,J+1}^k + u_{I,J-1}^k)$$\n这就是所要求的表达式。",
            "answer": "$$\\boxed{2(1 - 2\\lambda^2)u_{I,J}^k - u_{I,J}^{k-1} + \\lambda^2 (u_{I-1,J}^k + u_{I,J+1}^k + u_{I,J-1}^k)}$$"
        },
        {
            "introduction": "编写数值模拟程序后，我们如何确信其计算结果是正确的？一个关键的验证步骤是检验数值方法的收敛率。理论上，一个二阶精度的格式在网格步长减半时，其误差应该减少为原来的四分之一。这个练习提供了一组在不同分辨率下进行的模拟结果，让你通过计算误差缩减因子来亲手验证该有限差分格式是否达到了预期的二阶收敛精度，这是计算科学中验证代码正确性的标准做法。",
            "id": "2172254",
            "problem": "设置了一个数值模拟，用以求解一维波动偏微分方程（PDE）$u_{tt} = c^2 u_{xx}$，其空间域为 $x \\in [0, 1]$，时间域为 $t \\geq 0$。波速给定为 $c=1$。该问题受固定边界条件 $u(0, t) = 0$ 和 $u(1, t) = 0$ 的约束，系统的初始状态由初始条件 $u(x, 0) = \\sin(\\pi x)$ 和 $u_t(x, 0) = 0$ 定义。对于这些特定条件，已知其精确解析解为 $u(x, t) = \\sin(\\pi x) \\cos(\\pi t)$。\n\n该偏微分方程在空间和时间上均采用标准中心差分格式进行离散化。令 $u_j^n$ 为 $u(x_j, t_n)$ 的数值近似解，其中 $x_j = j\\Delta x$ 且 $t_n = n\\Delta t$。更新规则由下式给出：\n$$u_j^{n+1} = 2(1-\\lambda^2)u_j^n + \\lambda^2(u_{j+1}^n + u_{j-1}^n) - u_j^{n-1} \\quad \\text{for } n \\geq 1$$\n其中 $\\lambda = c \\frac{\\Delta t}{\\Delta x}$ 是库朗数。对于第一个时间步（$n=0$），使用一个由初始速度条件导出的特殊公式：\n$$u_j^1 = (1-\\lambda^2)u_j^0 + \\frac{\\lambda^2}{2}(u_{j+1}^0 + u_{j-1}^0)$$\n\n为了分析该数值方法的精度，进行了一项研究。运行了多次模拟，直至最终时间 $T \\approx 0.5$，每次模拟使用不同数量的空间区间 $N_x$。在所有模拟中，库朗数保持恒定为 $\\lambda=0.5$。在每次模拟的最终时刻，计算误差的离散L2范数 $E$。结果汇总在下表中。\n\n| 空间区间数 ($N_x$) | L2误差范数 ($E$) |\n|-------------------------------------|-----------------------|\n| 20                                  | $1.0181 \\times 10^{-3}$ |\n| 40                                  | $2.5539 \\times 10^{-4}$ |\n| 80                                  | $6.3916 \\times 10^{-5}$ |\n\n我们将“误差缩减因子”$R(M)$ 定义为使用 $M$ 个空间区间的模拟所产生的误差与使用 $2M$ 个空间区间的模拟所产生的误差之比。\n计算误差缩减因子 $R(40)$。将最终答案四舍五入到四位有效数字。",
            "solution": "误差缩减因子定义为分辨率为 $M$ 时的误差与分辨率加倍为 $2M$ 时的误差之比：\n$$R(M) = \\frac{E(M)}{E(2M)}.$$\n对于 $M=40$，表格给出 $E(40) = 2.5539 \\times 10^{-4}$ 和 $E(80) = 6.3916 \\times 10^{-5}$。因此，\n$$R(40) = \\frac{2.5539 \\times 10^{-4}}{6.3916 \\times 10^{-5}} = \\frac{2.5539}{6.3916} \\times 10^{(-4)-(-5)} = 10 \\times \\frac{2.5539}{6.3916}.$$\n计算该比值：\n$$\\frac{2.5539}{6.3916} \\approx 0.3995713,$$\n所以\n$$R(40) \\approx 10 \\times 0.3995713 = 3.995713.$$\n四舍五入到四位有效数字，得到\n$$R(40) \\approx 3.996.$$",
            "answer": "$$\\boxed{3.996}$$"
        }
    ]
}