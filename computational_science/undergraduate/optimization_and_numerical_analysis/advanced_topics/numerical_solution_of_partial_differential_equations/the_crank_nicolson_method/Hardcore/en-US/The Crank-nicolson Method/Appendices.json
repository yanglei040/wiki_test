{
    "hands_on_practices": [
        {
            "introduction": "The first step in implementing the Crank-Nicolson method is translating the continuous partial differential equation into a system of linear algebraic equations. This foundational exercise guides you through this process for the one-dimensional heat equation . By explicitly constructing the matrices that govern the time evolution, you will gain a concrete understanding of how the implicit nature of the method is expressed in the form $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$.",
            "id": "2139888",
            "problem": "Consider the one-dimensional heat equation, $u_t = \\alpha u_{xx}$, for a function $u(x, t)$ defined on the spatial domain $x \\in [0, L]$ and for time $t \\geq 0$. The equation is subject to homogeneous Dirichlet boundary conditions, $u(0, t) = u(L, t) = 0$.\n\nWe wish to solve this equation numerically using the Crank-Nicolson method. The spatial domain is discretized into a uniform grid with spacing $\\Delta x$, such that there are exactly three interior grid points. Let $\\Delta t$ be the time step. The method results in a matrix system of the form $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$, where $\\mathbf{u}^{k}$ is the column vector of the numerical solution at the three interior grid points at time step $k$.\n\nLet the parameter $\\lambda$ be defined as $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$.\n\nWhich of the following options correctly identifies the $3 \\times 3$ matrices $A$ and $B$?\n\nA. $A = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$, $B = \\begin{pmatrix} 1-2\\lambda & \\lambda & 0 \\\\ \\lambda & 1-2\\lambda & \\lambda \\\\ 0 & \\lambda & 1-2\\lambda \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1+2\\lambda & -\\lambda & 0 \\\\ -\\lambda & 1+2\\lambda & -\\lambda \\\\ 0 & -\\lambda & 1+2\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$",
            "solution": "We discretize the spatial interval with uniform spacing $\\Delta x$ and denote interior indices $i=1,2,3$. The homogeneous Dirichlet boundary conditions impose $u_{0}^{n}=0$ and $u_{4}^{n}=0$ for all $n$.\n\nLet $u_{i}^{n}$ approximate $u(x_{i}, t^{n})$. The Crank–Nicolson discretization of $u_{t}=\\alpha u_{xx}$ at interior point $i$ is\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}\n=\\frac{\\alpha}{2}\\left(\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{(\\Delta x)^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{(\\Delta x)^{2}}\\right).\n$$\nWith $\\lambda=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$, multiply both sides by $\\Delta t$ to obtain\n$$\nu_{i}^{n+1}-u_{i}^{n}\n=\\frac{\\lambda}{2}\\left[(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n})+(u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1})\\right].\n$$\nRearranging to collect the unknown time level $n+1$ on the left and time level $n$ on the right gives\n$$\n\\left(1+\\lambda\\right)u_{i}^{n+1}-\\frac{\\lambda}{2}u_{i+1}^{n+1}-\\frac{\\lambda}{2}u_{i-1}^{n+1}\n=\\left(1-\\lambda\\right)u_{i}^{n}+\\frac{\\lambda}{2}u_{i+1}^{n}+\\frac{\\lambda}{2}u_{i-1}^{n}.\n$$\nBecause the boundary values are zero, no additional boundary terms appear. Writing this system for $i=1,2,3$ in matrix form $A\\mathbf{u}^{n+1}=B\\mathbf{u}^{n}$ with $\\mathbf{u}^{k}=(u_{1}^{k},u_{2}^{k},u_{3}^{k})^{\\mathsf{T}}$, the matrices are\n$$\nA=\\begin{pmatrix}\n1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\\n-\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\\n0 & -\\frac{\\lambda}{2} & 1+\\lambda\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\\n\\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\\n0 & \\frac{\\lambda}{2} & 1-\\lambda\n\\end{pmatrix}.\n$$\nThese match option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a PDE is discretized into a matrix system, the next challenge is solving it efficiently at each time step. The Crank-Nicolson method characteristically produces a tridiagonal matrix system, a special structure that allows for remarkably fast solutions. This practice problem  moves beyond theory to quantify the immense computational advantage of using a specialized solver, the Thomas algorithm, compared to a general-purpose approach, highlighting a key aspect of practical scientific computing.",
            "id": "2139847",
            "problem": "When the one-dimensional heat equation $u_t = \\alpha u_{xx}$ is discretized using the Crank-Nicolson finite difference method on a spatial domain with $N$ interior grid points, the problem of finding the solution at each time step reduces to solving a system of $N$ linear equations for $N$ unknowns. This system can be written in matrix form as $A \\mathbf{u} = \\mathbf{d}$, where $A$ is an $N \\times N$ constant, sparse, tridiagonal matrix, and $\\mathbf{d}$ is a vector that depends on the solution from the previous time step.\n\nTwo common methods for solving such a system are standard Gaussian elimination and the Thomas algorithm, which is a specialized direct solver for tridiagonal systems, also known as the Tridiagonal Matrix Algorithm (TDMA). Your task is to quantify the computational advantage of using the specialized algorithm.\n\nLet the computational cost be defined as the total number of multiplication and division operations required to solve the system. Determine the ratio of the leading-order computational cost of standard Gaussian elimination to that of the Thomas algorithm, expressed as a function of $N$, for a very large number of interior points $N$.",
            "solution": "We consider the linear system $A\\mathbf{u}=\\mathbf{d}$ of size $N\\times N$ with $A$ tridiagonal. The computational cost is defined as the total number of multiplications and divisions required to solve for $\\mathbf{u}$.\n\nFirst, we count the operations for the Thomas algorithm (TDMA), which exploits tridiagonality. Using the standard forward elimination/back substitution form:\n\nForward elimination for $i=2,\\dots,N$:\n- Compute $w_{i}=a_{i}/b_{i-1}$: $1$ division.\n- Update $b_{i}\\leftarrow b_{i}-w_{i}c_{i-1}$: $1$ multiplication.\n- Update $d_{i}\\leftarrow d_{i}-w_{i}d_{i-1}$: $1$ multiplication.\n\nThis yields $3$ multiplications/divisions per $i$, giving $3(N-1)$ in total.\n\nBack substitution:\n- Compute $u_{N}=d_{N}/b_{N}$: $1$ division.\n- For $i=N-1,\\dots,1$: $u_{i}=(d_{i}-c_{i}u_{i+1})/b_{i}$, which requires $1$ multiplication and $1$ division per $i$, contributing $2(N-1)$ operations.\n\nThus, the Thomas algorithm cost is\n$$\nC_{T}(N) = 3(N-1) + [1+2(N-1)] = 5N-4.\n$$\n\nNext, we count the operations for standard Gaussian elimination treating the matrix as dense (i.e., not exploiting tridiagonality).\n\nElimination phase: For each column $k=1,\\dots,N-1$,\n- Compute multipliers $m_{ik}=a_{ik}/a_{kk}$ for $i=k+1,\\dots,N$: $(N-k)$ divisions.\n- Update row entries $a_{ij}\\leftarrow a_{ij}-m_{ik}a_{kj}$ for $j=k+1,\\dots,N$: $(N-k)$ multiplications per row and $(N-k)$ rows, giving $(N-k)^{2}$ multiplications.\n\nSumming over $k$,\n- Elimination multiplications: $\\sum_{k=1}^{N-1}(N-k)^{2}=\\sum_{m=1}^{N-1}m^{2}=\\frac{(N-1)N(2N-1)}{6}$.\n- Elimination divisions: $\\sum_{k=1}^{N-1}(N-k)=\\sum_{m=1}^{N-1}m=\\frac{(N-1)N}{2}$.\n\nBack substitution:\n- $u_{N}=b_{N}/a_{NN}$: $1$ division.\n- For $i=N-1,\\dots,1$, compute $u_{i}=(b_{i}-\\sum_{j=i+1}^{N}a_{ij}u_{j})/a_{ii}$, which requires $(N-i)$ multiplications and $1$ division per $i$.\n\nSumming,\n- Back-sub multiplications: $\\sum_{i=1}^{N-1}(N-i)=\\frac{(N-1)N}{2}$.\n- Back-sub divisions: $N$.\n\nTherefore, the total multiplications and divisions are\n$$\n\\text{Multiplications: } \\frac{(N-1)N(2N-1)}{6}+\\frac{(N-1)N}{2} = \\frac{1}{3}N^{3}-\\frac{1}{3}N,\n$$\n$$\n\\text{Divisions: } \\frac{(N-1)N}{2}+N=\\frac{1}{2}N^{2}+\\frac{1}{2}N.\n$$\nHence the total cost for standard Gaussian elimination is\n$$\nC_{G}(N)=\\left(\\frac{1}{3}N^{3}-\\frac{1}{3}N\\right)+\\left(\\frac{1}{2}N^{2}+\\frac{1}{2}N\\right) = \\frac{1}{3}N^{3}+\\frac{1}{2}N^{2}+\\frac{1}{6}N.\n$$\n\nThe ratio of leading-order costs, for very large $N$, compares the dominant terms: the $N^{3}$ term in $C_{G}$ and the $N$ term in $C_{T}$. Thus,\n$$\n\\frac{C_{G,\\text{lead}}(N)}{C_{T,\\text{lead}}(N)}=\\frac{\\frac{1}{3}N^{3}}{5N}=\\frac{N^{2}}{15}.\n$$\nTherefore, for large $N$, the computational advantage factor of the Thomas algorithm relative to standard Gaussian elimination grows like $\\frac{N^2}{15}$.",
            "answer": "$$\\boxed{\\frac{N^{2}}{15}}$$"
        },
        {
            "introduction": "A hallmark of a skilled numerical analyst is the ability to critically interpret simulation results. While the Crank-Nicolson method is lauded for its unconditional stability, this does not guarantee physical accuracy in all situations. This insightful exercise  explores a scenario with sharp initial conditions where the method can produce spurious oscillations, teaching a crucial lesson in understanding the subtle behaviors and limitations of numerical schemes.",
            "id": "2139894",
            "problem": "Consider the one-dimensional heat equation, $u_t = \\alpha u_{xx}$, defined on a spatial domain $x \\in [0, L]$. The rod is subject to homogeneous Dirichlet boundary conditions, such that $u(0, t) = u(L, t) = 0$ for all time $t \\ge 0$.\n\nThe equation is to be solved numerically using the Crank-Nicolson finite difference scheme. The spatial domain is discretized into $N_x$ equal intervals of size $\\Delta x = L/N_x$, with grid points labeled $x_j = j \\Delta x$ for $j=0, 1, \\dots, N_x$. The time is discretized with a constant step size $\\Delta t$, with time levels $t_n = n \\Delta t$. The numerical approximation to the solution $u(x_j, t_n)$ is denoted by $u_j^n$.\n\nThe Crank-Nicolson scheme is given by:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} + \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n\nFor this problem, use the following parameters:\n-   Length of the rod, $L = 1.0$.\n-   Thermal diffusivity, $\\alpha = 1.0$.\n-   Number of spatial intervals, $N_x = 4$. This results in three interior grid points.\n-   The initial condition at $t=0$ is a sharp, localized pulse approximated on the grid by setting the temperature at the central interior point to $u_2^0 = 2.0$, and the temperature at all other interior points to zero.\n-   The computational mesh ratio is set to $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = 10.0$. This corresponds to a large time step, chosen to investigate the method's behavior under such conditions.\n\nYour task is to calculate the value of the solution at the central interior grid point, $u_2^1$, after the first time step. Express your answer as a fraction in simplest form.",
            "solution": "We discretize the heat equation $u_{t}=\\alpha u_{xx}$ on $x\\in[0,L]$ with homogeneous Dirichlet boundary conditions using the Crank–Nicolson scheme. With mesh ratio $r=\\alpha \\Delta t/(\\Delta x)^{2}$, the Crank–Nicolson update for interior nodes is\n$$\nu_{j}^{n+1}-u_{j}^{n}=\\frac{r}{2}\\Big[(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n})+(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1})\\Big].\n$$\nRearranging to collect the $n+1$ terms on the left gives, for $j=1,2,3$,\n$$\n-\\frac{r}{2}u_{j-1}^{n+1}+(1+r)u_{j}^{n+1}-\\frac{r}{2}u_{j+1}^{n+1}=(1-r)u_{j}^{n}+\\frac{r}{2}(u_{j-1}^{n}+u_{j+1}^{n}),\n$$\nwith $u_{0}^{n}=u_{4}^{n}=0$.\n\nWith $N_{x}=4$, the interior unknowns at the first step are $u_{1}^{1},u_{2}^{1},u_{3}^{1}$, and the initial condition is $u_{1}^{0}=0$, $u_{2}^{0}=2$, $u_{3}^{0}=0$. Substituting these and the boundary values into the right-hand sides yields the linear system\n$$\n(1+r)u_{1}^{1}-\\frac{r}{2}u_{2}^{1}=r,\n$$\n$$\n-\\frac{r}{2}u_{1}^{1}+(1+r)u_{2}^{1}-\\frac{r}{2}u_{3}^{1}=2-2r,\n$$\n$$\n-\\frac{r}{2}u_{2}^{1}+(1+r)u_{3}^{1}=r.\n$$\nBy symmetry, $u_{1}^{1}=u_{3}^{1}$; denote $a=u_{1}^{1}=u_{3}^{1}$ and $b=u_{2}^{1}$. The system reduces to\n$$\n(1+r)a-\\frac{r}{2}b=r,\n$$\n$$\n-ra+(1+r)b=2-2r.\n$$\nFrom the first equation, $a=\\big(r+\\frac{r}{2}b\\big)/(1+r)$. Substituting into the second gives\n$$\n-\\frac{r\\big(r+\\frac{r}{2}b\\big)}{1+r}+(1+r)b=2-2r.\n$$\nMultiplying through by $(1+r)$ and collecting $b$ terms,\n$$\n-r^{2}-\\frac{r^{2}}{2}b+(1+2r+r^{2})b=2-2r^{2},\n$$\n$$\n\\Big(1+2r+\\frac{r^{2}}{2}\\Big)b=2-r^{2}.\n$$\nHence,\n$$\nb=\\frac{2-r^{2}}{1+2r+\\frac{r^{2}}{2}}=\\frac{4-2r^{2}}{r^{2}+4r+2}.\n$$\nWith the given mesh ratio $r=10$, this yields\n$$\nu_{2}^{1}=b=\\frac{4-2\\cdot 100}{100+40+2}=\\frac{-196}{142}=-\\frac{98}{71}.\n$$\nTherefore, the value at the central interior grid point after the first time step is $-\\frac{98}{71}$.",
            "answer": "$$\\boxed{-\\frac{98}{71}}$$"
        }
    ]
}