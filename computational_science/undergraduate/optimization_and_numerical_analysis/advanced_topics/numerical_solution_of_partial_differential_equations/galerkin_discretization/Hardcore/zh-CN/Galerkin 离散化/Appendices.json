{
    "hands_on_practices": [
        {
            "introduction": "掌握伽辽金方法的最好方式就是亲手实践。我们从一个最简单的例子开始，使用单个基函数来求解一个常见的二阶边值问题。这个练习将复杂的伽辽金方法简化为求解一个代数方程，清晰地揭示了将方程残差投影到测试函数空间并使其为零的核心思想。",
            "id": "2174720",
            "problem": "考虑由微分方程 $-u''(x) = 1$（其中 $x \\in (0, 1)$）定义，并满足齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$ 的两点边值问题。该方程可以模拟，例如，一根拉紧的缆绳在均布向下载荷作用下的微小竖向位移 $u(x)$。\n\n我们寻求使用伽辽金方法（Galerkin method）求此问题的近似解。近似解记为 $u_h(x)$，由单个基函数 $\\phi_1(x) = x(1-x)$ 构造，使得 $u_h(x) = c_1 \\phi_1(x)$。系数 $c_1$ 是一个待定常数。在伽辽金方法中，基函数也用作检验函数。\n\n请确定通过正确应用此过程所得到的系数 $c_1$ 的数值。请以分数形式表示你的答案。",
            "solution": "我们考虑该边值问题的弱形式：找到 $u \\in V$ 且 $V = H_{0}^{1}(0,1)$，使得对于所有 $v \\in V$，\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx = \\int_{0}^{1} 1 \\cdot v(x)\\,dx.\n$$\n使用伽辽金方法，试探和检验空间由 $\\phi_{1}(x) = x(1-x)$ 张成，我们取 $u_{h}(x) = c_{1}\\phi_{1}(x)$ 并施加 $v = \\phi_{1}$ 的伽辽金条件：\n$$\n\\int_{0}^{1} (u_{h})'(x)\\,\\phi_{1}'(x)\\,dx = \\int_{0}^{1} \\phi_{1}(x)\\,dx.\n$$\n由于 $u_{h}' = c_{1}\\phi_{1}'$，上式变为\n$$\nc_{1}\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx = \\int_{0}^{1} \\phi_{1}(x)\\,dx,\n$$\n所以\n$$\nc_{1} = \\frac{\\int_{0}^{1} \\phi_{1}(x)\\,dx}{\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx}.\n$$\n计算所需的积分。首先，对于 $\\phi_{1}(x) = x(1-x) = x - x^{2}$，\n$$\n\\int_{0}^{1} \\phi_{1}(x)\\,dx = \\int_{0}^{1} \\left(x - x^{2}\\right)\\,dx = \\left[\\frac{x^{2}}{2} - \\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}.\n$$\n其次，$\\phi_{1}'(x) = 1 - 2x$，因此\n$$\n\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx = \\int_{0}^{1} \\left(1 - 4x + 4x^{2}\\right)\\,dx = \\left[x - 2x^{2} + \\frac{4}{3}x^{3}\\right]_{0}^{1} = 1 - 2 + \\frac{4}{3} = \\frac{1}{3}.\n$$\n因此，\n$$\nc_{1} = \\frac{\\frac{1}{6}}{\\frac{1}{3}} = \\frac{1}{2}.\n$$\n作为一致性检验，满足 $u(0)=u(1)=0$ 的 $-u''=1$ 的精确解是 $u(x) = \\frac{1}{2}x(1-x)$，这证实了 $c_{1} = \\frac{1}{2}$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在掌握了单一方程的求解后，我们进而将其扩展到方程组的情形。这个练习将引入“刚度矩阵”这一有限元分析中的核心概念。我们将使用一组特殊的正弦基函数，它们在这种特定问题下具有正交性，从而极大地简化了最终的矩阵形式，并揭示了问题更深层次的结构。",
            "id": "2174693",
            "problem": "考虑定义在区间 $(0, 1)$ 上的一维泊松方程，这是一个在静电学和力学中的基本方程：\n$$ -u''(x) = f(x) $$\n该方程满足齐次狄利克雷边界条件：\n$$ u(0) = 0 \\quad \\text{and} \\quad u(1) = 0 $$\n为了找到近似解，我们可以使用伽辽金有限元法。在这种方法中，近似解 $u_h(x)$ 表示为基函数的线性组合，$u_h(x) = \\sum_{j=1}^{N} c_j \\phi_j(x)$，其中基函数 $\\phi_j(x)$ 必须满足给定的边界条件。\n\n这个过程会导出一个线性代数方程组 $Ac = b$，其中向量 $c$ 包含未知系数 $c_j$。矩阵 $A$ 的元素，称为刚度矩阵，是通过对基函数导数的乘积进行积分来计算的。具体来说，对于任意两个基函数 $\\phi_i(x)$ 和 $\\phi_j(x)$，刚度矩阵中对应的元素由以下公式给出：\n$$ A_{ij} = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\,dx $$\n其中 $\\phi_i'(x)$ 表示 $\\phi_i(x)$ 关于 $x$ 的一阶导数。\n\n使用由 $\\phi_1(x) = \\sin(\\pi x)$ 和 $\\phi_2(x) = \\sin(2\\pi x)$ 给出的基函数集，确定 $2 \\times 2$ 刚度矩阵 $A$。",
            "solution": "我们已知在区间 $(0,1)$ 上的一维泊松方程，其带有齐次狄利克雷边界条件，以及使用基函数 $\\phi_{1}(x)=\\sin(\\pi x)$ 和 $\\phi_{2}(x)=\\sin(2\\pi x)$ 的伽辽金有限元近似。刚度矩阵的元素定义为\n$$\nA_{ij}=\\int_{0}^{1}\\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx.\n$$\n首先计算基函数的导数：\n$$\n\\phi_{1}'(x)=\\pi\\cos(\\pi x), \\qquad \\phi_{2}'(x)=2\\pi\\cos(2\\pi x).\n$$\n计算 $A_{11}$：\n$$\nA_{11}=\\int_{0}^{1}\\left(\\pi\\cos(\\pi x)\\right)^{2}dx=\\pi^{2}\\int_{0}^{1}\\cos^{2}(\\pi x)\\,dx.\n$$\n使用恒等式 $\\cos^{2}\\theta=\\frac{1}{2}\\left(1+\\cos(2\\theta)\\right)$，我们有\n$$\nA_{11}=\\pi^{2}\\int_{0}^{1}\\frac{1}{2}\\left(1+\\cos(2\\pi x)\\right)dx=\\frac{\\pi^{2}}{2}\\left[\\int_{0}^{1}1\\,dx+\\int_{0}^{1}\\cos(2\\pi x)\\,dx\\right].\n$$\n因为 $\\int_{0}^{1}\\cos(2\\pi x)\\,dx=\\left.\\frac{1}{2\\pi}\\sin(2\\pi x)\\right|_{0}^{1}=0$，所以\n$$\nA_{11}=\\frac{\\pi^{2}}{2}.\n$$\n计算 $A_{22}$：\n$$\nA_{22}=\\int_{0}^{1}\\left(2\\pi\\cos(2\\pi x)\\right)^{2}dx=4\\pi^{2}\\int_{0}^{1}\\cos^{2}(2\\pi x)\\,dx.\n$$\n使用相同的三角恒等式，\n$$\nA_{22}=4\\pi^{2}\\int_{0}^{1}\\frac{1}{2}\\left(1+\\cos(4\\pi x)\\right)dx=2\\pi^{2}\\left[\\int_{0}^{1}1\\,dx+\\int_{0}^{1}\\cos(4\\pi x)\\,dx\\right].\n$$\n因为 $\\int_{0}^{1}\\cos(4\\pi x)\\,dx=\\left.\\frac{1}{4\\pi}\\sin(4\\pi x)\\right|_{0}^{1}=0$，所以\n$$\nA_{22}=2\\pi^{2}.\n$$\n计算非对角线元素 $A_{12}=A_{21}$：\n$$\nA_{12}=\\int_{0}^{1}\\left(\\pi\\cos(\\pi x)\\right)\\left(2\\pi\\cos(2\\pi x)\\right)dx=2\\pi^{2}\\int_{0}^{1}\\cos(\\pi x)\\cos(2\\pi x)\\,dx.\n$$\n使用积化和差恒等式 $\\cos a\\,\\cos b=\\frac{1}{2}\\left[\\cos(a-b)+\\cos(a+b)\\right]$，我们得到\n$$\n\\cos(\\pi x)\\cos(2\\pi x)=\\frac{1}{2}\\left[\\cos(\\pi x)+\\cos(3\\pi x)\\right].\n$$\n因此，\n$$\nA_{12}=2\\pi^{2}\\cdot\\frac{1}{2}\\left[\\int_{0}^{1}\\cos(\\pi x)\\,dx+\\int_{0}^{1}\\cos(3\\pi x)\\,dx\\right]=\\pi^{2}\\left[\\left.\\frac{1}{\\pi}\\sin(\\pi x)\\right|_{0}^{1}+\\left.\\frac{1}{3\\pi}\\sin(3\\pi x)\\right|_{0}^{1}\\right]=0.\n$$\n综合这些结果，刚度矩阵为\n$$\nA=\\begin{pmatrix}\n\\frac{\\pi^{2}}{2} & 0 \\\\\n0 & 2\\pi^{2}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\pi^{2}}{2} & 0 \\\\ 0 & 2\\pi^{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在实际应用中，我们很难找到像上一个练习中那样理想的正交基。这个练习将展示伽辽金方法的普适性，即便是对于非正交的混合基函数，该方法依然有效。通过这个练习，我们将看到这种更普遍的基函数选择如何产生一个非对角、全填充的刚度矩阵，而这也是实际工程计算中更常见的情况。",
            "id": "2174708",
            "problem": "在求解域 $\\Omega$ 上的微分方程 $Lu = f$ 的伽辽金法中，解 $u$ 由一个有限维子空间中的函数 $u_h$ 来近似，该子空间由一组基函数 $\\{\\phi_i\\}_{i=1}^N$ 张成。这会导出一个线性系统 $Ac=b$，其中“刚度矩阵” $A$ 的元素由 $A_{ij} = (L\\phi_j, \\phi_i)$ 给出。\n\n考虑在区间 $[0, 1]$ 上与算子 $Lu = -u''$ 相关的一维边值问题。我们希望使用一个由非正交基函数 $\\phi_1(x) = \\sin(\\pi x)$ 和 $\\phi_2(x) = x(1-x)$ 张成的二维子空间来找到一个近似解。两个基函数都满足齐次狄利克雷边界条件，即对于 $i=1, 2$，有 $\\phi_i(0) = \\phi_i(1) = 0$。\n\n在区间 $[0, 1]$ 上，两个函数 $g(x)$ 和 $h(x)$ 的内积定义为 $(g, h) = \\int_0^1 g(x)h(x) dx$。\n\n确定与这组基函数选择相对应的 $2 \\times 2$ 刚度矩阵 $A$，其元素定义为 $A_{ij} = (L\\phi_j, \\phi_i) = \\int_0^1 (-\\phi_j''(x)) \\phi_i(x) dx$。将您的答案表示为一个具有精确解析元素的矩阵。",
            "solution": "我们应用伽辽金刚度矩阵的定义，对于 $L=-\\frac{d^{2}}{dx^{2}}$：\n$$\nA_{ij}=(L\\phi_{j},\\phi_{i})=\\int_{0}^{1}\\left(-\\phi_{j}''(x)\\right)\\phi_{i}(x)\\,dx.\n$$\n基函数为 $\\phi_{1}(x)=\\sin(\\pi x)$ 和 $\\phi_{2}(x)=x(1-x)=x-x^{2}$。它们的导数是\n$$\n\\phi_{1}'(x)=\\pi\\cos(\\pi x),\\quad \\phi_{1}''(x)=-\\pi^{2}\\sin(\\pi x),\\quad -\\phi_{1}''(x)=\\pi^{2}\\sin(\\pi x),\n$$\n$$\n\\phi_{2}'(x)=1-2x,\\quad \\phi_{2}''(x)=-2,\\quad -\\phi_{2}''(x)=2.\n$$\n\n计算每个元素：\n1) 对于 $A_{11}$，\n$$\nA_{11}=\\int_{0}^{1}\\left(-\\phi_{1}''(x)\\right)\\phi_{1}(x)\\,dx=\\int_{0}^{1}\\pi^{2}\\sin(\\pi x)\\sin(\\pi x)\\,dx=\\pi^{2}\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx.\n$$\n使用 $\\sin^{2}(\\theta)=\\frac{1-\\cos(2\\theta)}{2}$，\n$$\n\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx=\\int_{0}^{1}\\frac{1-\\cos(2\\pi x)}{2}\\,dx=\\frac{1}{2}-\\frac{1}{2}\\int_{0}^{1}\\cos(2\\pi x)\\,dx=\\frac{1}{2},\n$$\n所以\n$$\nA_{11}=\\frac{\\pi^{2}}{2}.\n$$\n\n2) 对于 $A_{12}$，\n$$\nA_{12}=\\int_{0}^{1}\\left(-\\phi_{2}''(x)\\right)\\phi_{1}(x)\\,dx=\\int_{0}^{1}2\\sin(\\pi x)\\,dx=2\\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{0}^{1}=\\frac{4}{\\pi}.\n$$\n\n3) 对于 $A_{21}$，\n$$\nA_{21}=\\int_{0}^{1}\\left(-\\phi_{1}''(x)\\right)\\phi_{2}(x)\\,dx=\\pi^{2}\\int_{0}^{1}\\sin(\\pi x)\\left(x-x^{2}\\right)\\,dx.\n$$\n令 $J=\\int_{0}^{1}\\sin(\\pi x)\\left(x-x^{2}\\right)\\,dx=\\int_{0}^{1}x\\sin(\\pi x)\\,dx-\\int_{0}^{1}x^{2}\\sin(\\pi x)\\,dx$。\n计算\n$$\n\\int_{0}^{1}x\\sin(\\pi x)\\,dx=\\left[-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}\\right]_{0}^{1}=\\frac{1}{\\pi},\n$$\n和\n$$\n\\int_{0}^{1}x^{2}\\sin(\\pi x)\\,dx=\\left[-\\frac{x^{2}\\cos(\\pi x)}{\\pi}+\\frac{2x\\sin(\\pi x)}{\\pi^{2}}+\\frac{2\\cos(\\pi x)}{\\pi^{3}}\\right]_{0}^{1}=\\frac{1}{\\pi}-\\frac{4}{\\pi^{3}}.\n$$\n因此\n$$\nJ=\\frac{1}{\\pi}-\\left(\\frac{1}{\\pi}-\\frac{4}{\\pi^{3}}\\right)=\\frac{4}{\\pi^{3}},\\quad A_{21}=\\pi^{2}J=\\frac{4}{\\pi}.\n$$\n\n4) 对于 $A_{22}$，\n$$\nA_{22}=\\int_{0}^{1}\\left(-\\phi_{2}''(x)\\right)\\phi_{2}(x)\\,dx=\\int_{0}^{1}2\\left(x-x^{2}\\right)\\,dx=\\left[x^{2}-\\frac{2}{3}x^{3}\\right]_{0}^{1}=\\frac{1}{3}.\n$$\n\n因此，刚度矩阵为\n$$\nA=\\begin{pmatrix}\n\\frac{\\pi^{2}}{2} & \\frac{4}{\\pi} \\\\\n\\frac{4}{\\pi} & \\frac{1}{3}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\pi^{2}}{2} & \\frac{4}{\\pi} \\\\ \\frac{4}{\\pi} & \\frac{1}{3}\\end{pmatrix}}$$"
        }
    ]
}