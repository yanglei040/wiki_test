{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the Galerkin method, we begin with the simplest possible scenario: approximating a solution using just one basis function. This exercise reduces the entire numerical scheme to a single algebraic equation for one unknown coefficient. By working through this fundamental example , you will directly apply the core principle of making the equation's residual orthogonal to your chosen test function, laying a solid foundation for more complex problems.",
            "id": "2174720",
            "problem": "Consider the two-point boundary value problem defined by the differential equation $-u''(x) = 1$ for $x \\in (0, 1)$, subject to the homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. This equation models, for example, the small vertical displacement $u(x)$ of a taut cable under a uniform downward load.\n\nWe seek an approximate solution to this problem using the Galerkin method. The approximate solution, denoted $u_h(x)$, is constructed from a single basis function, $\\phi_1(x) = x(1-x)$, such that $u_h(x) = c_1 \\phi_1(x)$. The coefficient $c_1$ is a constant to be determined. In the Galerkin method, the basis function(s) are also used as the test function(s).\n\nDetermine the numerical value of the coefficient $c_1$ that is obtained by correctly applying this procedure. Express your answer as a fraction.",
            "solution": "We consider the weak form of the boundary value problem: find $u \\in V$ with $V = H_{0}^{1}(0,1)$ such that for all $v \\in V$,\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,dx = \\int_{0}^{1} 1 \\cdot v(x)\\,dx.\n$$\nUsing the Galerkin method with the trial and test space spanned by $\\phi_{1}(x) = x(1-x)$, we take $u_{h}(x) = c_{1}\\phi_{1}(x)$ and enforce the Galerkin condition with $v = \\phi_{1}$:\n$$\n\\int_{0}^{1} (u_{h})'(x)\\,\\phi_{1}'(x)\\,dx = \\int_{0}^{1} \\phi_{1}(x)\\,dx.\n$$\nSince $u_{h}' = c_{1}\\phi_{1}'$, this becomes\n$$\nc_{1}\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx = \\int_{0}^{1} \\phi_{1}(x)\\,dx,\n$$\nso\n$$\nc_{1} = \\frac{\\int_{0}^{1} \\phi_{1}(x)\\,dx}{\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx}.\n$$\nCompute the needed integrals. First, with $\\phi_{1}(x) = x(1-x) = x - x^{2}$,\n$$\n\\int_{0}^{1} \\phi_{1}(x)\\,dx = \\int_{0}^{1} \\left(x - x^{2}\\right)\\,dx = \\left[\\frac{x^{2}}{2} - \\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}.\n$$\nNext, $\\phi_{1}'(x) = 1 - 2x$, hence\n$$\n\\int_{0}^{1} \\left(\\phi_{1}'(x)\\right)^{2}\\,dx = \\int_{0}^{1} \\left(1 - 4x + 4x^{2}\\right)\\,dx = \\left[x - 2x^{2} + \\frac{4}{3}x^{3}\\right]_{0}^{1} = 1 - 2 + \\frac{4}{3} = \\frac{1}{3}.\n$$\nTherefore,\n$$\nc_{1} = \\frac{\\frac{1}{6}}{\\frac{1}{3}} = \\frac{1}{2}.\n$$\nAs a consistency check, the exact solution of $-u''=1$ with $u(0)=u(1)=0$ is $u(x) = \\frac{1}{2}x(1-x)$, which confirms $c_{1} = \\frac{1}{2}$.",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "Having mastered the single-function case, we now advance to using multiple basis functions to build a more accurate approximation. This practice  focuses on assembling the \"stiffness matrix,\" a key component of the final linear system $Ac=b$. We will use a carefully chosen basis of sine functions, which are eigenfunctions of the differential operator, and discover how this choice leads to a simple diagonal matrix, a computationally desirable outcome.",
            "id": "2174693",
            "problem": "Consider the one-dimensional Poisson equation, a fundamental equation in electrostatics and mechanics, defined on the interval $(0, 1)$:\n$$ -u''(x) = f(x) $$\nThis equation is subject to homogeneous Dirichlet boundary conditions:\n$$ u(0) = 0 \\quad \\text{and} \\quad u(1) = 0 $$\nTo find an approximate solution, we can use the Galerkin finite element method. In this method, the approximate solution $u_h(x)$ is represented as a linear combination of basis functions, $u_h(x) = \\sum_{j=1}^{N} c_j \\phi_j(x)$, where the basis functions $\\phi_j(x)$ must satisfy the given boundary conditions.\n\nThis procedure leads to a system of linear algebraic equations $Ac = b$, where the vector $c$ contains the unknown coefficients $c_j$. The entries of the matrix $A$, known as the stiffness matrix, are calculated by integrating the product of the derivatives of the basis functions. Specifically, for any two basis functions $\\phi_i(x)$ and $\\phi_j(x)$, the corresponding entry in the stiffness matrix is given by:\n$$ A_{ij} = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\,dx $$\nwhere $\\phi_i'(x)$ denotes the first derivative of $\\phi_i(x)$ with respect to $x$.\n\nUsing the set of basis functions given by $\\phi_1(x) = \\sin(\\pi x)$ and $\\phi_2(x) = \\sin(2\\pi x)$, determine the $2 \\times 2$ stiffness matrix $A$.",
            "solution": "We are given the one-dimensional Poisson equation with homogeneous Dirichlet boundary conditions on the interval $(0,1)$ and the Galerkin finite element approximation with basis functions $\\phi_{1}(x)=\\sin(\\pi x)$ and $\\phi_{2}(x)=\\sin(2\\pi x)$. The stiffness matrix entries are defined by\n$$\nA_{ij}=\\int_{0}^{1}\\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx.\n$$\nFirst compute the derivatives of the basis functions:\n$$\n\\phi_{1}'(x)=\\pi\\cos(\\pi x), \\qquad \\phi_{2}'(x)=2\\pi\\cos(2\\pi x).\n$$\nCompute $A_{11}$:\n$$\nA_{11}=\\int_{0}^{1}\\left(\\pi\\cos(\\pi x)\\right)^{2}dx=\\pi^{2}\\int_{0}^{1}\\cos^{2}(\\pi x)\\,dx.\n$$\nUsing the identity $\\cos^{2}\\theta=\\frac{1}{2}\\left(1+\\cos(2\\theta)\\right)$, we have\n$$\nA_{11}=\\pi^{2}\\int_{0}^{1}\\frac{1}{2}\\left(1+\\cos(2\\pi x)\\right)dx=\\frac{\\pi^{2}}{2}\\left[\\int_{0}^{1}1\\,dx+\\int_{0}^{1}\\cos(2\\pi x)\\,dx\\right].\n$$\nSince $\\int_{0}^{1}\\cos(2\\pi x)\\,dx=\\left.\\frac{1}{2\\pi}\\sin(2\\pi x)\\right|_{0}^{1}=0$, it follows that\n$$\nA_{11}=\\frac{\\pi^{2}}{2}.\n$$\nCompute $A_{22}$:\n$$\nA_{22}=\\int_{0}^{1}\\left(2\\pi\\cos(2\\pi x)\\right)^{2}dx=4\\pi^{2}\\int_{0}^{1}\\cos^{2}(2\\pi x)\\,dx.\n$$\nUsing the same trigonometric identity,\n$$\nA_{22}=4\\pi^{2}\\int_{0}^{1}\\frac{1}{2}\\left(1+\\cos(4\\pi x)\\right)dx=2\\pi^{2}\\left[\\int_{0}^{1}1\\,dx+\\int_{0}^{1}\\cos(4\\pi x)\\,dx\\right].\n$$\nSince $\\int_{0}^{1}\\cos(4\\pi x)\\,dx=\\left.\\frac{1}{4\\pi}\\sin(4\\pi x)\\right|_{0}^{1}=0$, it follows that\n$$\nA_{22}=2\\pi^{2}.\n$$\nCompute the off-diagonal entries $A_{12}=A_{21}$:\n$$\nA_{12}=\\int_{0}^{1}\\left(\\pi\\cos(\\pi x)\\right)\\left(2\\pi\\cos(2\\pi x)\\right)dx=2\\pi^{2}\\int_{0}^{1}\\cos(\\pi x)\\cos(2\\pi x)\\,dx.\n$$\nUsing the product-to-sum identity $\\cos a\\,\\cos b=\\frac{1}{2}\\left[\\cos(a-b)+\\cos(a+b)\\right]$, we obtain\n$$\n\\cos(\\pi x)\\cos(2\\pi x)=\\frac{1}{2}\\left[\\cos(\\pi x)+\\cos(3\\pi x)\\right].\n$$\nTherefore,\n$$\nA_{12}=2\\pi^{2}\\cdot\\frac{1}{2}\\left[\\int_{0}^{1}\\cos(\\pi x)\\,dx+\\int_{0}^{1}\\cos(3\\pi x)\\,dx\\right]=\\pi^{2}\\left[\\left.\\frac{1}{\\pi}\\sin(\\pi x)\\right|_{0}^{1}+\\left.\\frac{1}{3\\pi}\\sin(3\\pi x)\\right|_{0}^{1}\\right]=0.\n$$\nCollecting these results, the stiffness matrix is\n$$\nA=\\begin{pmatrix}\n\\frac{\\pi^{2}}{2} & 0 \\\\\n0 & 2\\pi^{2}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\pi^{2}}{2} & 0 \\\\ 0 & 2\\pi^{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "While orthogonal bases are elegant, practical applications often involve non-orthogonal functions, such as the piecewise polynomials used in standard finite element methods. This exercise  tackles this general case by mixing a trigonometric function with a polynomial to form the basis. Calculating the stiffness matrix here will demonstrate that non-orthogonality results in a full (non-diagonal) matrix, but its symmetry is preserved, a crucial property that reflects the self-adjoint nature of the underlying differential operator.",
            "id": "2174708",
            "problem": "In the Galerkin method for solving a differential equation of the form $Lu = f$ on a domain $\\Omega$, one approximates the solution $u$ by a function $u_h$ from a finite-dimensional subspace spanned by a set of basis functions $\\{\\phi_i\\}_{i=1}^N$. This leads to a linear system $Ac=b$, where the entries of the \"stiffness matrix\" $A$ are given by $A_{ij} = (L\\phi_j, \\phi_i)$.\n\nConsider the one-dimensional boundary value problem associated with the operator $Lu = -u''$ on the interval $[0, 1]$. We wish to find an approximate solution using a two-dimensional subspace spanned by the non-orthogonal basis functions $\\phi_1(x) = \\sin(\\pi x)$ and $\\phi_2(x) = x(1-x)$. Both basis functions satisfy homogeneous Dirichlet boundary conditions, i.e., $\\phi_i(0) = \\phi_i(1) = 0$ for $i=1, 2$.\n\nThe inner product of two functions $g(x)$ and $h(x)$ on the interval $[0, 1]$ is defined as $(g, h) = \\int_0^1 g(x)h(x) dx$.\n\nDetermine the $2 \\times 2$ stiffness matrix $A$ corresponding to this choice of basis functions, where its entries are defined by $A_{ij} = (L\\phi_j, \\phi_i) = \\int_0^1 (-\\phi_j''(x)) \\phi_i(x) dx$. Express your answer as a matrix with exact analytical entries.",
            "solution": "We apply the Galerkin stiffness matrix definition for $L=-\\frac{d^{2}}{dx^{2}}$:\n$$\nA_{ij}=(L\\phi_{j},\\phi_{i})=\\int_{0}^{1}\\left(-\\phi_{j}''(x)\\right)\\phi_{i}(x)\\,dx.\n$$\nThe basis functions are $\\phi_{1}(x)=\\sin(\\pi x)$ and $\\phi_{2}(x)=x(1-x)=x-x^{2}$. Their derivatives are\n$$\n\\phi_{1}'(x)=\\pi\\cos(\\pi x),\\quad \\phi_{1}''(x)=-\\pi^{2}\\sin(\\pi x),\\quad -\\phi_{1}''(x)=\\pi^{2}\\sin(\\pi x),\n$$\n$$\n\\phi_{2}'(x)=1-2x,\\quad \\phi_{2}''(x)=-2,\\quad -\\phi_{2}''(x)=2.\n$$\n\nCompute each entry:\n1) For $A_{11}$,\n$$\nA_{11}=\\int_{0}^{1}\\left(-\\phi_{1}''(x)\\right)\\phi_{1}(x)\\,dx=\\int_{0}^{1}\\pi^{2}\\sin(\\pi x)\\sin(\\pi x)\\,dx=\\pi^{2}\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx.\n$$\nUsing $\\sin^{2}(\\theta)=\\frac{1-\\cos(2\\theta)}{2}$,\n$$\n\\int_{0}^{1}\\sin^{2}(\\pi x)\\,dx=\\int_{0}^{1}\\frac{1-\\cos(2\\pi x)}{2}\\,dx=\\frac{1}{2}-\\frac{1}{2}\\int_{0}^{1}\\cos(2\\pi x)\\,dx=\\frac{1}{2},\n$$\nso\n$$\nA_{11}=\\frac{\\pi^{2}}{2}.\n$$\n\n2) For $A_{12}$,\n$$\nA_{12}=\\int_{0}^{1}\\left(-\\phi_{2}''(x)\\right)\\phi_{1}(x)\\,dx=\\int_{0}^{1}2\\sin(\\pi x)\\,dx=2\\left[-\\frac{\\cos(\\pi x)}{\\pi}\\right]_{0}^{1}=\\frac{4}{\\pi}.\n$$\n\n3) For $A_{21}$,\n$$\nA_{21}=\\int_{0}^{1}\\left(-\\phi_{1}''(x)\\right)\\phi_{2}(x)\\,dx=\\pi^{2}\\int_{0}^{1}\\sin(\\pi x)\\left(x-x^{2}\\right)\\,dx.\n$$\nLet $J=\\int_{0}^{1}\\sin(\\pi x)\\left(x-x^{2}\\right)\\,dx=\\int_{0}^{1}x\\sin(\\pi x)\\,dx-\\int_{0}^{1}x^{2}\\sin(\\pi x)\\,dx$.\nCompute\n$$\n\\int_{0}^{1}x\\sin(\\pi x)\\,dx=\\left[-\\frac{x\\cos(\\pi x)}{\\pi}+\\frac{\\sin(\\pi x)}{\\pi^{2}}\\right]_{0}^{1}=\\frac{1}{\\pi},\n$$\nand\n$$\n\\int_{0}^{1}x^{2}\\sin(\\pi x)\\,dx=\\left[-\\frac{x^{2}\\cos(\\pi x)}{\\pi}+\\frac{2x\\sin(\\pi x)}{\\pi^{2}}+\\frac{2\\cos(\\pi x)}{\\pi^{3}}\\right]_{0}^{1}=\\frac{1}{\\pi}-\\frac{4}{\\pi^{3}}.\n$$\nHence\n$$\nJ=\\frac{1}{\\pi}-\\left(\\frac{1}{\\pi}-\\frac{4}{\\pi^{3}}\\right)=\\frac{4}{\\pi^{3}},\\quad A_{21}=\\pi^{2}J=\\frac{4}{\\pi}.\n$$\n\n4) For $A_{22}$,\n$$\nA_{22}=\\int_{0}^{1}\\left(-\\phi_{2}''(x)\\right)\\phi_{2}(x)\\,dx=\\int_{0}^{1}2\\left(x-x^{2}\\right)\\,dx=\\left[x^{2}-\\frac{2}{3}x^{3}\\right]_{0}^{1}=\\frac{1}{3}.\n$$\n\nTherefore, the stiffness matrix is\n$$\nA=\\begin{pmatrix}\n\\frac{\\pi^{2}}{2} & \\frac{4}{\\pi} \\\\\n\\frac{4}{\\pi} & \\frac{1}{3}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\pi^{2}}{2} & \\frac{4}{\\pi} \\\\ \\frac{4}{\\pi} & \\frac{1}{3}\\end{pmatrix}}$$"
        }
    ]
}