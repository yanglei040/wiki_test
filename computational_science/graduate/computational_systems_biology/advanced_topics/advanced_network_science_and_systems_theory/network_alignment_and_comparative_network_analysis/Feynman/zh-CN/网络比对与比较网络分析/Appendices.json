{
    "hands_on_practices": [
        {
            "introduction": "成功的网络比对依赖于如何有效地整合不同来源的相似性信息。本练习将指导您完成一个基础但关键的步骤：将序列相似性（生物学信息）和拓扑相似性（网络结构信息）融合成一个统一的评分矩阵。通过解决一个小型网络上的最大权重匹配问题 ，您将亲身体验如何量化节点间的对应关系，并为更复杂的比对算法奠定基础。",
            "id": "3330944",
            "problem": "给定两个蛋白质相互作用网络，每个网络有四个节点。网络 $\\mathcal{A}$ 的节点为 $\\{a_{1},a_{2},a_{3},a_{4}\\}$，网络 $\\mathcal{B}$ 的节点为 $\\{b_{1},b_{2},b_{3},b_{4}\\}$。对于每个有序对 $(a_{i},b_{j})$，提供了两个归一化相似度度量：一个基于序列的相似度 $S_{\\mathrm{seq}}(i,j)$ 和一个基于图元（graphlet）的拓扑相似度 $S_{\\mathrm{topo}}(i,j)$。这些相似度被排列成矩阵，其行由 $\\mathcal{A}$ 索引，列由 $\\mathcal{B}$ 索引：\n$$\nS_{\\mathrm{seq}} \\;=\\;\n\\begin{bmatrix}\n0.9  0.2  0.3  0.4 \\\\\n0.1  0.8  0.4  0.3 \\\\\n0.2  0.3  0.85  0.5 \\\\\n0.4  0.3  0.2  0.88\n\\end{bmatrix},\n\\qquad\nS_{\\mathrm{topo}} \\;=\\;\n\\begin{bmatrix}\n0.8  0.2  0.6  0.1 \\\\\n0.1  0.9  0.3  0.4 \\\\\n0.2  0.3  0.95  0.2 \\\\\n0.3  0.3  0.2  0.9\n\\end{bmatrix}.\n$$\n在计算系统生物学中用于全局网络比对的标准线性聚合模型下，对于权重参数 $\\alpha \\in [0,1]$，综合相似度定义为\n$$\nS(i,j) \\;=\\; \\alpha\\, S_{\\mathrm{seq}}(i,j) \\;+\\; \\bigl(1-\\alpha\\bigr)\\, S_{\\mathrm{topo}}(i,j).\n$$\n设 $\\alpha \\,=\\, 0.7$。考虑一对一比对问题：找到一个双射 $\\pi:\\{1,2,3,4\\}\\to\\{1,2,3,4\\}$，使得总综合相似度最大化\n$$\n\\sum_{i=1}^{4} S\\bigl(i,\\pi(i)\\bigr),\n$$\n这等价于在 $\\mathcal{A}$ 和 $\\mathcal{B}$ 之间寻找最大权重二分匹配，其中边权重为 $S(i,j)$。计算综合相似度矩阵 $S$，并确定在所有一对一映射下的最大总综合相似度。仅报告最大总综合相似度，以单个实数值的形式。不要报告该映射。无需四舍五入。",
            "solution": "### 步骤 1：计算综合相似度矩阵 S\n根据给定的公式 $S(i,j) = \\alpha S_{\\mathrm{seq}}(i,j) + (1-\\alpha) S_{\\mathrm{topo}}(i,j)$ 和 $\\alpha = 0.7$，我们首先计算综合相似度矩阵 $S$。\n$$\nS = 0.7 \\cdot S_{\\mathrm{seq}} + 0.3 \\cdot S_{\\mathrm{topo}}\n$$\n$$\nS = 0.7 \\begin{bmatrix}\n0.9  & 0.2  & 0.3  & 0.4 \\\\\n0.1  & 0.8  & 0.4  & 0.3 \\\\\n0.2  & 0.3  & 0.85 & 0.5 \\\\\n0.4  & 0.3  & 0.2  & 0.88\n\\end{bmatrix}\n+ 0.3 \\begin{bmatrix}\n0.8  & 0.2  & 0.6  & 0.1 \\\\\n0.1  & 0.9  & 0.3  & 0.4 \\\\\n0.2  & 0.3  & 0.95 & 0.2 \\\\\n0.3  & 0.3  & 0.2  & 0.9\n\\end{bmatrix}\n$$\n$$\nS = \\begin{bmatrix}\n0.63 & 0.14 & 0.21 & 0.28 \\\\\n0.07 & 0.56 & 0.28 & 0.21 \\\\\n0.14 & 0.21 & 0.595 & 0.35 \\\\\n0.28 & 0.21 & 0.14 & 0.616\n\\end{bmatrix}\n+ \\begin{bmatrix}\n0.24 & 0.06 & 0.18 & 0.03 \\\\\n0.03 & 0.27 & 0.09 & 0.12 \\\\\n0.06 & 0.09 & 0.285 & 0.06 \\\\\n0.09 & 0.09 & 0.06 & 0.27\n\\end{bmatrix}\n$$\n$$\nS = \\begin{bmatrix}\n0.87 & 0.20 & 0.39 & 0.31 \\\\\n0.10 & 0.83 & 0.37 & 0.33 \\\\\n0.20 & 0.30 & 0.88 & 0.41 \\\\\n0.37 & 0.30 & 0.20 & 0.886\n\\end{bmatrix}\n$$\n\n### 步骤 2：求解最大权重二分匹配\n我们的目标是找到一个排列 $\\pi$，使得总权重 $\\sum_{i=1}^{4} S(i,\\pi(i))$ 最大。这是一个最大权重二分匹配问题，对于这个 $4 \\times 4$ 的矩阵，我们可以通过观察或使用匈牙利算法来求解。\n\n观察矩阵 $S$，可以发现对角线上的元素 $S(i,i)$ 都非常大，远大于其所在行或列的其他元素。这表明将每个节点 $a_i$ 匹配到对应的节点 $b_i$ 可能会得到最优解。\n\n我们来验证这个直观的匹配方案，即 $\\pi(1)=1, \\pi(2)=2, \\pi(3)=3, \\pi(4)=4$。\n该匹配的总相似度为：\n$$\n\\text{Total Similarity} = S(1,1) + S(2,2) + S(3,3) + S(4,4)\n$$\n$$\n\\text{Total Similarity} = 0.87 + 0.83 + 0.88 + 0.886 = 3.466\n$$\n由于对角线元素在各自的行列中占主导地位，任何偏离此对角线匹配的置换（例如，交换任意两个匹配）都会导致总和降低。例如，如果我们交换前两个匹配，即 $\\pi(1)=2, \\pi(2)=1$，而保持 $\\pi(3)=3, \\pi(4)=4$，总和将变为 $S(1,2) + S(2,1) + S(3,3) + S(4,4) = 0.20 + 0.10 + 0.88 + 0.886 = 2.066$，这远小于 $3.466$。\n\n因此，最大总综合相似度是 $3.466$。",
            "answer": "$$\n\\boxed{3.466}\n$$"
        },
        {
            "introduction": "一个比对算法的好坏需要通过客观的指标来衡量。本练习将带您深入了解几种关键的网络比对质量评估指标，包括边正确率（EC）、诱导保守结构（ICS）、对称子结构得分（S3）和最大公共连通子图（LCCS）。通过从第一性原理出发计算这些指标 ，您将学会如何从不同维度——如精确度、召回率和拓扑连续性——来审视一个比对结果的优劣。",
            "id": "3330942",
            "problem": "考虑两个无向简单图 $G_1 = (V_1,E_1)$ 和 $G_2 = (V_2,E_2)$，它们代表两个物种的蛋白质-蛋白质相互作用网络。设 $V_1 = \\{v_1,v_2,v_3,v_4,v_5\\}$ 且 $E_1 = \\{(v_1,v_2), (v_2,v_3), (v_3,v_4), (v_4,v_5)\\}$。设 $V_2 = \\{u_1,u_2,u_3,u_4,u_5\\}$ 且\n$$E_2 = \\{(u_1,u_2), (u_2,u_3), (u_3,u_4), (u_1,u_5), (u_1,u_3), (u_2,u_4)\\}.$$\n假设给定一个建议的比对 $f: V_1 \\to V_2$，该比对是单射的，并定义为 $f(v_i) = u_i$，其中 $i \\in \\{1,2,3,4,5\\}$。\n\n仅使用诱导子图、连通性、集合交并集的核心集合论和图论定义，并且不借助度量指标本身的预先陈述的公式，推导并计算在映射 $f$ 下的以下比对质量度量指标：\n- 边正确性 ($\\mathrm{EC}$)，\n- 诱导保守结构 ($\\mathrm{ICS}$)，\n- 对称子结构分数 ($\\mathrm{S3}$)，\n- 最大公共连通子图 ($\\mathrm{LCCS}$) 的大小（以节点数计）。\n\n将 $\\mathrm{EC}$、$\\mathrm{ICS}$ 和 $\\mathrm{S3}$ 表示为精确有理数，并将 $\\mathrm{LCCS}$ 表示为精确整数。以单行矩阵的形式提供最终答案，其中包含按 $\\mathrm{EC}$、$\\mathrm{ICS}$、$\\mathrm{S3}$、$\\mathrm{LCCS}$ 顺序排列的四个值。然后，根据您的第一性原理推导，就比对精确度、比对召回率和保守区域内的拓扑连续性方面，解释这些度量指标之间的权衡。",
            "solution": "该问题在算法上和数学上是明确定义的，提供了计算所要求度量指标所需的所有信息。图 $G_1 = (V_1, E_1)$ 和 $G_2 = (V_2, E_2)$ 以及比对函数 $f: V_1 \\to V_2$ 都被明确说明。因此，该问题是有效的，可以推导出解。\n\n给定的已知条件如下：\n图 $G_1$：\n$V_1 = \\{v_1, v_2, v_3, v_4, v_5\\}$，所以 $|V_1| = 5$。\n$E_1 = \\{(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5)\\}$，所以 $|E_1| = 4$。$G_1$ 是一个有 $5$ 个顶点的路径图，记为 $P_5$。\n\n图 $G_2$：\n$V_2 = \\{u_1, u_2, u_3, u_4, u_5\\}$，所以 $|V_2| = 5$。\n$E_2 = \\{(u_1, u_2), (u_2, u_3), (u_3, u_4), (u_1, u_5), (u_1, u_3), (u_2, u_4)\\}$，所以 $|E_2| = 6$。\n\n比对 $f$：\n$f$ 是从 $V_1$ 到 $V_2$ 的单射映射，定义为 $f(v_i) = u_i$，其中 $i \\in \\{1, 2, 3, 4, 5\\}$。因为 $|V_1| = |V_2|$，所以该映射是一个双射。$G_2$ 中的比对节点集为 $f(V_1) = \\{f(v_1), \\dots, f(v_5)\\} = \\{u_1, \\dots, u_5\\} = V_2$。\n\n我们的首要任务是确定 $G_1$ 中的哪些边在比对 $f$ 下是保守的。如果对应的边 $(f(v_i), f(v_j))$ 存在于 $E_2$ 中，则边 $(v_i, v_j) \\in E_1$ 是保守的。我们可以将 $G_1$ 的边集定义为映射到 $G_2$ 节点空间中的集合：\n$f(E_1) = \\{ (f(v_i), f(v_j)) \\mid (v_i, v_j) \\in E_1 \\}$.\n根据 $f$ 的定义，我们有：\n$f(E_1) = \\{ (u_1, u_2), (u_2, u_3), (u_3, u_4), (u_4, u_5) \\}$.\n\n保守边的集合，我们称之为 $E_c$，是映射边集 $f(E_1)$ 与目标图 $E_2$ 的边集的交集。\n$E_c = f(E_1) \\cap E_2$.\n我们检查 $f(E_1)$ 中的每条边是否属于 $E_2$：\n1. $(u_1, u_2) \\in E_2$ 吗？是。\n2. $(u_2, u_3) \\in E_2$ 吗？是。\n3. $(u_3, u_4) \\in E_2$ 吗？是。\n4. $(u_4, u_5) \\in E_2$ 吗？否。\n\n因此，保守边的集合为 $E_c = \\{ (u_1, u_2), (u_2, u_3), (u_3, u_4) \\}$。\n保守边的数量为 $|E_c| = 3$。\n\n现在我们可以根据四个度量指标的基本定义来推导和计算它们。\n\n**边正确性 ($\\mathrm{EC}$)**\n$\\mathrm{EC}$ 度量指标定义为源图 $G_1$ 中在比对下被保守的边的比例。这衡量了比对相对于 $G_1$ 结构的精确度。\n从第一性原理出发，这是保守边数量与 $G_1$ 中总边数的比率。\n$$ \\mathrm{EC} = \\frac{|f(E_1) \\cap E_2|}{|E_1|} $$\n使用我们计算出的值：\n$$ \\mathrm{EC} = \\frac{|E_c|}{|E_1|} = \\frac{3}{4} $$\n\n**诱导保守结构 ($\\mathrm{ICS}$)**\n$\\mathrm{ICS}$ 度量指标从目标图 $G_2$ 的角度评估比对的质量。它衡量了 $G_2$ 中参与比对的部分中的边有多少实际上可以由 $G_1$ 的边来解释。“参与的 $G_2$ 的部分”是由比对节点集 $f(V_1)$ 诱导的 $G_2$ 的子图。\n设 $G'_2 = G_2[f(V_1)]$ 为该诱导子图。$G'_2$ 的顶点集是 $f(V_1) = V_2$。$G'_2$ 的边集，我们称之为 $E'_2$，由 $E_2$ 中其两个端点都在 $f(V_1)$ 中的所有边组成。由于 $f(V_1) = V_2$，诱导子图就是 $G_2$ 本身，所以 $G'_2 = G_2$ 且 $E'_2 = E_2$。\n$\\mathrm{ICS}$ 定义为保守边数量与该诱导子图中总边数的比率。\n$$ \\mathrm{ICS} = \\frac{|f(E_1) \\cap E_2|}{|E'_2|} = \\frac{|f(E_1) \\cap E_2|}{|E(G_2[f(V_1)])|} $$\n在我们的例子中，这可以简化为：\n$$ \\mathrm{ICS} = \\frac{|E_c|}{|E_2|} = \\frac{3}{6} = \\frac{1}{2} $$\n\n**对称子结构分数 ($\\mathrm{S3}$)**\n$\\mathrm{S3}$ 分数是一个对称度量指标，它平衡了 $\\mathrm{EC}$ 和 $\\mathrm{ICS}$ 的观点。它被定义为 $G_1$ 的映射边集与 $G_2$ 中诱导子图的边集之间的 Jaccard 指数。它是这些集合交集的大小除以它们并集的大小。\n$$ \\mathrm{S3} = \\frac{|f(E_1) \\cap E(G_2[f(V_1)])|}{|f(E_1) \\cup E(G_2[f(V_1)])|} $$\n如前所述，$E(G_2[f(V_1)]) = E_2$。公式变为：\n$$ \\mathrm{S3} = \\frac{|f(E_1) \\cap E_2|}{|f(E_1) \\cup E_2|} $$\n使用容斥原理计算并集的大小：\n$|f(E_1) \\cup E_2| = |f(E_1)| + |E_2| - |f(E_1) \\cap E_2|$.\n我们有 $|f(E_1)| = |E_1| = 4$，$|E_2| = 6$ 和 $|f(E_1) \\cap E_2| = |E_c| = 3$。\n因此，$|f(E_1) \\cup E_2| = 4 + 6 - 3 = 7$。\n将这些值代入 $\\mathrm{S3}$ 公式：\n$$ \\mathrm{S3} = \\frac{3}{7} $$\n\n**最大公共连通子图 ($\\mathrm{LCCS}$)**\n$\\mathrm{LCCS}$ 的求解方法是首先构建公共子图 $G_c$，该子图由所有比对节点和仅保守的边定义。$\\mathrm{LCCS}$ 的大小是 $G_c$ 的最大连通分量中的节点数。\n公共子图可以看作是 $G_1$ 的一个子图，其顶点集为 $V_1$，边集仅由 $E_1$ 中那些被保守的边组成。\n$E_1$ 中的边是 $(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5)$。\n对应的映射边是 $(u_1, u_2), (u_2, u_3), (u_3, u_4), (u_4, u_5)$。\n保守的边是 $(u_1, u_2), (u_2, u_3), (u_3, u_4)$。\n这意味着 $E_1$ 中被保守的原始边是 $E_{c,1} = \\{(v_1, v_2), (v_2, v_3), (v_3, v_4)\\}$。\n公共子图是 $G_c = (V_1, E_{c,1})$。\n我们现在求 $G_c$ 的连通分量：\n边 $\\{(v_1, v_2), (v_2, v_3), (v_3, v_4)\\}$ 形成一条连接顶点 $\\{v_1, v_2, v_3, v_4\\}$ 的路径。这形成了一个大小为 $4$ 的连通分量。\n顶点 $v_5$ 在 $E_{c,1}$ 中没有关联边（因为边 $(v_4, v_5)$ 未被保守），所以它是一个孤立顶点。这形成了第二个大小为 $1$ 的连通分量。\n连通分量的大小分别为 $4$ 和 $1$。其中最大的是 $4$。\n因此，$\\mathrm{LCCS}$ 的大小为 $4$。\n\n**度量指标的解释**\n基于这些推导，我们可以解释这些权衡：\n- $\\mathrm{EC} = \\frac{3}{4} = 0.75$。这是一个衡量**比对精确度**的指标。它回答了：“在比对预测的邻接关系（即 $G_1$ 的边）中，正确的比例是多少？” 在本例中，$G_1$ 中 $75\\%$ 的边成功地映射到了 $G_2$ 中的边。该分数对 $G_2$ 中不在 $E_1$ 映射中的边不敏感。\n- $\\mathrm{ICS} = \\frac{1}{2} = 0.5$。这与**比对召回率**或拓扑纯度有关。它回答了：“在目标图 $G_2$ 的比对区域中存在的所有邻接关系中，有多少被比对恢复了？” 在这里，比对仅解释了 $G_2$ 中存在的 $6$ 条边中的 $3$ 条。低分表明目标子图与源图显著不同（更密集或已重连），包含了像 $(u_1, u_3), (u_2, u_4), (u_1, u_5)$ 这样的边，这些边在当前比对下在 $G_1$ 中没有对应关系。\n- $\\mathrm{S3} = \\frac{3}{7} \\approx 0.429$。这是一个**平衡分数**，同时考虑了假阳性（在 $f(E_1)$ 中但不在 $E_2$ 中的边）和假阴性（在 $E_2$ 中但不在 $f(E_1)$ 中的边）。作为 Jaccard 相似度，它提供了一个单一、对称的衡量整体拓扑重叠的指标。其值介于 $\\mathrm{EC}$ 和 $\\mathrm{ICS}$ 之间，反映了比对从两个角度看都是不完美的。\n- $\\mathrm{LCCS} = 4$。该度量指标衡量了保守结构的**拓扑连续性**。虽然基于边的度量指标提供了全局的保守百分比，但 $\\mathrm{LCCS}$ 确定了最大的单个保守功能模块或通路的大小。在这里，一个包含 $4$ 个节点的连续路径被保留了下来。这与例如两个不连通的边被保守的情况不同，后者可能产生更低的 $\\mathrm{EC}$ ($\\frac{2}{4}$)，但会导致小得多的 $\\mathrm{LCCS}$，为 $2$。因此，$\\mathrm{LCCS}$ 捕捉了连通子结构的生物学上显著的保守性，而这仅通过边计数是无法完全描述的。比对未能保守边 $(v_4,v_5)$ 破坏了原始的 $P_5$ 结构，使 $v_5$ 孤立，并将最大的连通块从 $5$ 个节点减少到 $4$ 个。\n\n总而言之，$\\mathrm{EC}$ 优先考虑精确度，$\\mathrm{ICS}$ 优先考虑召回率/纯度，$\\mathrm{S3}$ 平衡两者，而 $\\mathrm{LCCS}$ 优先考虑最大未断裂保守块的大小。\n\n最终答案计算：\n$\\mathrm{EC} = \\frac{3}{4}$\n$\\mathrm{ICS} = \\frac{1}{2}$\n$\\mathrm{S3} = \\frac{3}{7}$\n$\\mathrm{LCCS} = 4$\n最终答案矩阵为 $\\begin{pmatrix} \\frac{3}{4}  \\frac{1}{2}  \\frac{3}{7}  4 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{4}  \\frac{1}{2}  \\frac{3}{7}  4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "网络比对问题在数学上常被构建为二次分配问题（QAP），这是一个以其计算复杂性而闻名的一般框架。然而，在某些特定条件下，该问题可以简化为更易于处理的线性分配问题（LAP）。本练习将通过一个特殊案例 ，引导您从理论上证明这种简化，并应用匈牙利算法求解，从而深刻理解全局比对背后的优化原理及其适用边界。",
            "id": "3330917",
            "problem": "在两个具有相同节点数的蛋白质-蛋白质相互作用（PPI）网络的比较网络对齐中，一种标准方法是将该问题转化为一个关于排列矩阵的二次分配优化问题，其中排列矩阵编码了节点对应关系。考虑两个节点集大小为 $3$ 的网络，其邻接矩阵分别为 $A \\in \\mathbb{R}^{3 \\times 3}$ 和 $B \\in \\mathbb{R}^{3 \\times 3}$。给定\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix},\n\\qquad\nB \\;=\\; \\begin{pmatrix}\n0  0  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n此外，给定一个节点相似度矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$，它量化了第一个网络中的节点 $i$ 与第二个网络中的节点 $j$ 之间的生物相似性：\n$$\nS \\;=\\; \\begin{pmatrix}\n0.9  0.2  0.4 \\\\\n0.3  0.8  0.5 \\\\\n0.6  0.4  0.7\n\\end{pmatrix}.\n$$\n令 $P \\in \\{0,1\\}^{3 \\times 3}$ 表示一个排列矩阵，代表两个网络节点之间的一一映射。\n\n任务：\n1. 从结合了边一致性项和节点相似性项的网络对齐二次分配公式的定义出发，形式化地证明当其中一个网络没有边（即 $B$ 是零矩阵）时，该优化问题简化为仅涉及 $S$ 的线性形式的关于 $P$ 的线性分配问题。\n2. 解释如何通过定义一个以 $S$ 表示的合适的成本矩阵 $C$，将得到的线性分配问题转化为适合用匈牙利算法求解的成本最小化问题，并证明最大化和最小化公式的等价性。\n3. 求解得到的 $3 \\times 3$ 线性分配实例，以计算最优排列矩阵 $P^{\\star}$。将最终答案报告为 $3 \\times 3$ 的排列矩阵 $P^{\\star}$。无需四舍五入，不涉及单位。",
            "solution": "该问题需要一个三部分的解答：首先，证明在特定条件下二次分配问题（QAP）简化为线性分配问题（LAP）；其次，将此 LAP 表述为成本最小化问题；第三，根据给定数据求解该问题。\n\n### 第一部分：QAP到LAP的简化\n\n网络对齐的一般目标函数被表述为二次分配问题，旨在找到一个排列矩阵 $P$，以最大化保留的边和节点相似性的组合。该目标函数 $J(P)$ 的一个标准形式是：\n$$\n\\text{maximize} \\quad J(P) = \\text{Tr}(A P B^T P^T) + \\gamma \\text{Tr}(S P^T)\n$$\n约束条件为 $P$ 是一个排列矩阵。此处，$A$ 和 $B$ 是两个网络的邻接矩阵，$S$ 是节点相似度矩阵，$\\gamma$ 是一个平衡两项的正常数，$\\text{Tr}$ 表示矩阵的迹。$\\text{Tr}(A P B^T P^T)$ 项量化了保留边的得分，而 $\\gamma \\text{Tr}(S P^T)$ 项量化了节点相似性的得分。\n\n问题指出一个网络没有边，这表示其邻接矩阵 $B$ 是零矩阵，$B = 0_{3 \\times 3}$。\n$$\nB = \\begin{pmatrix}\n0  0  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n零矩阵的转置也是零矩阵，$B^T = 0_{3 \\times 3}$。将此代入目标函数的边保留项，得到：\n$$\n\\text{Tr}(A P B^T P^T) = \\text{Tr}(A P 0_{3 \\times 3} P^T)\n$$\n由于任何矩阵与零矩阵的乘积都是零矩阵，该表达式简化为：\n$$\n\\text{Tr}(A P 0_{3 \\times 3}) = \\text{Tr}(0_{3 \\times 3}) = 0\n$$\n因此，边保留项消失。目标函数 $J(P)$ 简化为：\n$$\n\\text{maximize} \\quad J(P) = \\gamma \\text{Tr}(S P^T)\n$$\n由于 $\\gamma$ 是一个正常数，最大化 $\\gamma \\text{Tr}(S P^T)$ 等价于最大化 $\\text{Tr}(S P^T)$。让我们展开这一项：\n$$\n\\text{Tr}(S P^T) = \\sum_{i=1}^3 (S P^T)_{ii} = \\sum_{i=1}^3 \\sum_{j=1}^3 S_{ij} (P^T)_{ji}\n$$\n根据转置的定义，$(P^T)_{ji} = P_{ij}$。所以，目标函数变为：\n$$\n\\text{maximize} \\sum_{i=1}^3 \\sum_{j=1}^3 S_{ij} P_{ij}\n$$\n该目标函数是排列矩阵 $P$ 的元素 $P_{ij}$ 的线性组合。在 $P$ 是一个排列矩阵（$P_{ij} \\in \\{0, 1\\}$, $\\sum_{i} P_{ij} = 1$ 且 $\\sum_{j} P_{ij} = 1$）的约束下，最大化此线性泛函的问题即为线性分配问题（LAP）的定义。\n\n### 第二部分：表述为成本最小化问题\n\n匈牙利算法是解决LAP的标准方法，但它通常被表述为一个最小化问题：\n$$\n\\text{minimize} \\sum_{i=1}^3 \\sum_{j=1}^3 C_{ij} P_{ij}\n$$\n其中 $C$ 是一个具有非负项（$C_{ij} \\ge 0$）的成本矩阵。我们需要将我们的最大化问题转换为一个等价的最小化问题。\n\n这可以通过将相似度矩阵 $S$ 转换为成本矩阵 $C$ 来实现。设 $M$ 为一个常数。考虑最小化量 $\\sum_{i,j} (M - S_{ij}) P_{ij}$：\n$$\n\\text{minimize} \\sum_{i,j} (M - S_{ij}) P_{ij} = \\text{minimize} \\left( \\sum_{i,j} M P_{ij} - \\sum_{i,j} S_{ij} P_{ij} \\right)\n$$\n由于 $P$ 是一个 $3 \\times 3$ 的排列矩阵，它恰好包含三个值为 $1$ 的元素，其余为 $0$。因此，和 $\\sum_{i,j} P_{ij} = 3$。该表达式变为：\n$$\n\\text{minimize} \\left( 3M - \\sum_{i,j} S_{ij} P_{ij} \\right)\n$$\n由于 $3M$ 相对于 $P$ 的选择是一个常数，最小化 $3M - (\\text{某个量})$ 等价于最大化那个量。因此，最小化此目标函数等价于我们最初的最大化 $\\sum_{i,j} S_{ij} P_{ij}$ 的问题。\n\n为了使成本矩阵项 $C_{ij} = M - S_{ij}$ 满足匈牙利算法要求的非负性，我们必须选择 $M$ 使得对于所有的 $i,j$ 都有 $M \\ge S_{ij}$。一个方便的选择是 $M = \\max_{i,j} S_{ij}$。\n给定相似度矩阵 $S$：\n$$\nS = \\begin{pmatrix}\n0.9  0.2  0.4 \\\\\n0.3  0.8  0.5 \\\\\n0.6  0.4  0.7\n\\end{pmatrix}\n$$\n最大元素是 $M = 0.9$。则成本矩阵 $C$ 为：\n$$\nC_{ij} = 0.9 - S_{ij}\n$$\n$$\nC = \\begin{pmatrix}\n0.9 - 0.9  & 0.9 - 0.2  & 0.9 - 0.4 \\\\\n0.9 - 0.3  & 0.9 - 0.8  & 0.9 - 0.5 \\\\\n0.9 - 0.6  & 0.9 - 0.4  & 0.9 - 0.7\n\\end{pmatrix} = \\begin{pmatrix}\n0.0  & 0.7  & 0.5 \\\\\n0.6  & 0.1  & 0.4 \\\\\n0.3  & 0.5  & 0.2\n\\end{pmatrix}\n$$\n这个成本矩阵 $C$ 的所有项都是非负的，可以用于匈牙利算法。\n\n### 第三部分：求解线性分配问题\n\n我们对成本矩阵 $C$ 应用匈牙利算法。\n\n**步骤1：行归约**\n从每行的所有元素中减去该行的最小元素。\n- 第1行：最小值为 $0.0$。该行保持为 $(0.0, 0.7, 0.5)$。\n- 第2行：最小值为 $0.1$。该行变为 $(0.6-0.1, 0.1-0.1, 0.4-0.1) = (0.5, 0.0, 0.3)$。\n- 第3行：最小值为 $0.2$。该行变为 $(0.3-0.2, 0.5-0.2, 0.2-0.2) = (0.1, 0.3, 0.0)$。\n行归约后的矩阵为：\n$$\nC' = \\begin{pmatrix}\n0.0  & 0.7  & 0.5 \\\\\n0.5  & 0.0  & 0.3 \\\\\n0.1  & 0.3  & 0.0\n\\end{pmatrix}\n$$\n**步骤2：列归约**\n从 $C'$ 的每列的所有元素中减去该列的最小元素。\n- 第1列：最小值为 $0.0$。该列不变。\n- 第2列：最小值为 $0.0$。该列不变。\n- 第3列：最小值为 $0.0$。该列不变。\n列归约后的矩阵 $C''$ 与 $C'$ 相同：\n$$\nC'' = \\begin{pmatrix}\n0.0  & 0.7  & 0.5 \\\\\n0.5  & 0.0  & 0.3 \\\\\n0.1  & 0.3  & 0.0\n\\end{pmatrix}\n$$\n**步骤3：确定是否存在最优分配**\n我们找出覆盖 $C''$ 中所有零所需的最少水平和垂直线的数量。零位于位置 $(1,1)$, $(2,2)$ 和 $(3,3)$。这些零位于主对角线上。任何单条线（行或列）最多只能覆盖其中一个零。因此，要覆盖所有三个零，需要最少三条线。\n由于最少画线数（$3$）等于矩阵的维度（$n=3$），可以使用当前零的位置进行最优分配。\n\n**步骤4：找到最优分配**\n我们必须选择一组三个零元素，且任意两个不在同一行或同一列。在矩阵 $C''$ 中，仅有的可用零位于 $(1,1)$, $(2,2)$ 和 $(3,3)$。选择这三个位置提供了一个有效的分配：\n- 第 $1$ 行分配给第 $1$ 列。\n- 第 $2$ 行分配给第 $2$ 列。\n- 第 $3$ 行分配给第 $3$ 列。\n\n**步骤5：构建最优排列矩阵 $P^{\\star}$**\n这个分配对应于一个排列矩阵 $P^{\\star}$，其中 $P_{11}=1$, $P_{22}=1$, $P_{33}=1$，所有其他项均为 $0$。\n这是单位矩阵：\n$$\nP^{\\star} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n这个分配产生的总相似性得分为 $S_{11} + S_{22} + S_{33} = 0.9 + 0.8 + 0.7 = 2.4$，这是可能的最大和，从而证实了解的最优性。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}