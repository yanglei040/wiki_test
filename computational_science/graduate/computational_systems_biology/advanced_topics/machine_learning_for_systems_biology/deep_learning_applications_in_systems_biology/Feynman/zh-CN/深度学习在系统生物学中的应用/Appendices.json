{
    "hands_on_practices": [
        {
            "introduction": "生物系统，如蛋白质相互作用网络，天然地具有图结构。图卷积网络 (GCN) 是一种强大的深度学习工具，它通过在相连节点之间传递信息来学习这种结构化数据。本练习将带您亲手计算 GCN 的一个基本步骤，从而具体理解信息是如何在生物网络中传播和转换的。",
            "id": "3299390",
            "problem": "考虑一个小的蛋白质信号网络，它表示为一个无向图，其中节点对应于蛋白质，边表示实验观察到的物理相互作用。设该网络有 $3$ 个蛋白质，标记为 $P_1$、$P_2$ 和 $P_3$，其对称邻接矩阵 $\\mathbf{A}$ 由下式给出\n$$\n\\mathbf{A}=\\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}.\n$$\n在图卷积网络（Graph Convolutional Network, GCN）中，信息通过自环和对称归一化进行传播。通过构建 $\\tilde{\\mathbf{A}}=\\mathbf{A}+\\mathbf{I}$ 来添加自环，度矩阵 $\\tilde{\\mathbf{D}}$ 定义为 $\\tilde{D}_{ii}=\\sum_{j} \\tilde{A}_{ij}$。对称归一化使用算子 $\\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2}$。节点特征矩阵 $\\mathbf{H}\\in\\mathbb{R}^{3\\times 2}$ 收集了每个蛋白质的两个具有生物学意义的特征（例如，基础活性和磷酸化相关活性），该层的权重矩阵为 $\\mathbf{W}\\in\\mathbb{R}^{2\\times 1}$。非线性激活函数是修正线性单元（Rectified Linear Unit, ReLU），定义为 $\\sigma(x)=\\max\\{0,x\\}$。\n\n假设初始节点特征矩阵和权重矩阵为\n$$\n\\mathbf{H}=\\begin{pmatrix}\n2  0 \\\\\n1  1 \\\\\n0  2\n\\end{pmatrix},\n\\qquad\n\\mathbf{W}=\\begin{pmatrix}\n1 \\\\\n-2\n\\end{pmatrix}.\n$$\n使用一个如上所述的带有自环和对称归一化的GCN层，计算该层之后蛋白质 $P_2$（第二个节点）的单个激活标量特征。将您的答案表示为一个精确的封闭形式实数。不需要四舍五入，也不需要单位。",
            "solution": "该问题要求计算在单个图卷积网络（GCN）层之后，蛋白质 $P_2$ 的激活标量特征。该层的操作由以下传播规则定义：\n$$\n\\mathbf{H}' = \\sigma(\\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2} \\mathbf{H} \\mathbf{W})\n$$\n其中 $\\mathbf{H}$ 是输入特征矩阵，$\\mathbf{W}$ 是权重矩阵，$\\sigma$ 是ReLU激活函数，而项 $\\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2}$ 是带有自环的对称归一化邻接矩阵。\n\n首先，我们确定给定的矩阵。这个 $3$ 蛋白质网络的邻接矩阵 $\\mathbf{A}$ 是：\n$$\n\\mathbf{A}=\\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix}\n$$\n初始节点特征矩阵 $\\mathbf{H} \\in \\mathbb{R}^{3\\times 2}$ 和权重矩阵 $\\mathbf{W} \\in \\mathbb{R}^{2\\times 1}$ 是：\n$$\n\\mathbf{H}=\\begin{pmatrix}\n2  0 \\\\\n1  1 \\\\\n0  2\n\\end{pmatrix},\n\\qquad\n\\mathbf{W}=\\begin{pmatrix}\n1 \\\\\n-2\n\\end{pmatrix}\n$$\n\n计算过程分几个步骤进行：\n\n1.  **为邻接矩阵添加自环。**\n    这是通过计算 $\\tilde{\\mathbf{A}} = \\mathbf{A} + \\mathbf{I}$ 来完成的，其中 $\\mathbf{I}$ 是 $3 \\times 3$ 的单位矩阵。\n    $$\n    \\tilde{\\mathbf{A}} = \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix}\n    $$\n\n2.  **计算度矩阵 $\\tilde{\\mathbf{D}}$。**\n    $\\tilde{\\mathbf{D}}$ 的对角线元素是 $\\tilde{\\mathbf{A}}$ 的行和。\n    -   $\\tilde{D}_{11} = 1 + 1 + 0 = 2$\n    -   $\\tilde{D}_{22} = 1 + 1 + 1 = 3$\n    -   $\\tilde{D}_{33} = 0 + 1 + 1 = 2$\n    所以，度矩阵是：\n    $$\n    \\tilde{\\mathbf{D}} = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  2 \\end{pmatrix}\n    $$\n\n3.  **计算对称归一化的邻接矩阵 $\\hat{\\mathbf{A}} = \\tilde{\\mathbf{D}}^{-1/2}\\tilde{\\mathbf{A}}\\tilde{\\mathbf{D}}^{-1/2}$。**\n    首先，我们通过对 $\\tilde{\\mathbf{D}}$ 的对角线元素取逆平方根来求得 $\\tilde{\\mathbf{D}}^{-1/2}$。\n    $$\n    \\tilde{\\mathbf{D}}^{-1/2} = \\begin{pmatrix} 2^{-1/2}  0  0 \\\\ 0  3^{-1/2}  0 \\\\ 0  0  2^{-1/2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n    $$\n    现在我们进行矩阵乘法：\n    $$\n    \\hat{\\mathbf{A}} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n    $$\n    $$\n    \\hat{\\mathbf{A}} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\ \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}} \\\\ 0  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  0 \\\\ 0  \\frac{1}{\\sqrt{3}}  0 \\\\ 0  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n    $$\n    $$\n    \\hat{\\mathbf{A}} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{\\sqrt{6}}  0 \\\\ \\frac{1}{\\sqrt{6}}  \\frac{1}{3}  \\frac{1}{\\sqrt{6}} \\\\ 0  \\frac{1}{\\sqrt{6}}  \\frac{1}{2} \\end{pmatrix}\n    $$\n\n4.  **计算线性变换部分, $\\mathbf{Z} = \\hat{\\mathbf{A}}\\mathbf{H}\\mathbf{W}$。**\n    首先计算乘积 $\\mathbf{X} = \\mathbf{H}\\mathbf{W}$ 在计算上更高效。\n    $$\n    \\mathbf{X} = \\begin{pmatrix} 2  0 \\\\ 1  1 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} (2)(1) + (0)(-2) \\\\ (1)(1) + (1)(-2) \\\\ (0)(1) + (2)(-2) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ -4 \\end{pmatrix}\n    $$\n    现在我们计算 $\\mathbf{Z} = \\hat{\\mathbf{A}}\\mathbf{X}$。\n    $$\n    \\mathbf{Z} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{\\sqrt{6}}  0 \\\\ \\frac{1}{\\sqrt{6}}  \\frac{1}{3}  \\frac{1}{\\sqrt{6}} \\\\ 0  \\frac{1}{\\sqrt{6}}  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ -4 \\end{pmatrix}\n    $$\n    该问题只要求蛋白质 $P_2$ 的特征，它对应于最终输出向量的第二个元素。我们计算 $\\mathbf{Z}$ 的第二个元素，记为 $Z_2$。\n    $$\n    Z_2 = \\left(\\frac{1}{\\sqrt{6}}\\right)(2) + \\left(\\frac{1}{3}\\right)(-1) + \\left(\\frac{1}{\\sqrt{6}}\\right)(-4)\n    $$\n    $$\n    Z_2 = \\frac{2}{\\sqrt{6}} - \\frac{1}{3} - \\frac{4}{\\sqrt{6}} = -\\frac{2}{\\sqrt{6}} - \\frac{1}{3}\n    $$\n\n5.  **应用ReLU激活函数。**\n    激活函数为 $\\sigma(x) = \\max\\{0, x\\}$。我们需要将此函数应用于 $Z_2$。$Z_2$ 的值为 $-\\frac{2}{\\sqrt{6}} - \\frac{1}{3}$。由于两项均为负数，它们的和也是负数，即 $Z_2  0$。\n    蛋白质 $P_2$ 的激活特征，记为 $H'_{2}$，是：\n    $$\n    H'_{2} = \\sigma(Z_2) = \\max\\{0, -\\frac{2}{\\sqrt{6}} - \\frac{1}{3}\\} = 0\n    $$\n蛋白质 $P_2$ 的单个激活标量特征是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "纯粹的机理模型可能无法捕捉所有生物复杂性，而纯粹的数据驱动模型则缺乏生物学可解释性。神经微分方程 (Neural ODEs) 等混合模型通过将神经网络与传统的常微分方程 (ODE) 相结合，为这一挑战提供了解决方案。通过本练习，您将模拟一个结合了基因调控开关经典模型和神经网络残差的混合系统，体验如何将这两种方法融为一体。",
            "id": "3299355",
            "problem": "考虑一个双基因触发开关，其中基因产物浓度 $x_1$ 和 $x_2$（无量纲单位）相互抑制。根据分子生物学的中心法则和现象学基因调控，一个受抑制基因的净生成速率可以使用一个Hill型抑制项和一个一阶降解项来建模。具体来说，假设其动力学由一个常微分方程（ODE）给出：$\\dot{x} = g(x)$，其中 $x = (x_1, x_2)^{\\top}$ 并且\n$$\ng_1(x) = \\frac{\\alpha_1}{1 + x_2^{n}} - \\beta_1 x_1,\\qquad\ng_2(x) = \\frac{\\alpha_2}{1 + x_1^{m}} - \\beta_2 x_2,\n$$\n其中 $\\alpha_1$, $\\alpha_2$ 是最大合成速率，$\\beta_1$, $\\beta_2$ 是降解速率常数，而 $n$, $m$ 是Hill系数。假设我们在离散时间点 $t_k = t_0 + k h$（步长 $h  0$ 为常数）观测该系统，并且我们通过一个神经残差来增强该机理模型，以捕捉模型失配和未建模的效应。将神经残差模型定义为\n$$\n\\dot{x} = g(x) + r_{\\theta}(x),\n$$\n其中 $r_{\\theta}(x)$ 是一个双层多层感知器（MLP），使用双曲正切激活函数，由权重和偏置 $\\theta = \\{W_1, b_1, W_2, b_2\\}$ 参数化：\n$$\nr_{\\theta}(x) = W_2\\,\\tanh\\!\\big(W_1 x + b_1\\big) + b_2.\n$$\n假设触发开关的参数值如下：\n$$\n\\alpha_1 = 3,\\quad \\alpha_2 = 4,\\quad \\beta_1 = 1,\\quad \\beta_2 = 1.5,\\quad n = 2,\\quad m = 2,\n$$\n以及以下神经网络参数：\n$$\nW_1 = \\begin{pmatrix} 0.5  -0.3 \\\\ 0.2  0.4 \\end{pmatrix},\\quad\nb_1 = \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix},\\quad\nW_2 = \\begin{pmatrix} 0.7  -0.1 \\\\ 0.05  0.6 \\end{pmatrix},\\quad\nb_2 = \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}.\n$$\n给定当前离散观测值 $x_k = \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix}$ 和步长 $h = 0.05$，请根据以上定义明确地构建 $g(x)$ 和 $r_{\\theta}(x)$，然后使用与采样方案一致的一阶离散化方法计算单步前向更新值 $x_{k+1}$。将最终向量的每个分量四舍五入到四位有效数字。浓度使用无量纲单位。",
            "solution": "系统动力学由一个神经微分方程（ODE）描述：\n$$\n\\dot{x} = F(x) = g(x) + r_{\\theta}(x)\n$$\n其中 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 代表两种基因产物的浓度。$g(x)$ 项是双基因触发开关的机理模型，$r_{\\theta}(x)$ 项是神经残差项。\n\n问题要求从时间 $t_k$ 的当前状态 $x_k$ 计算下一个状态 $x_{k+1}$，使用步长为 $h$ 的“一阶离散化”。这对应于前向欧拉法：\n$$\nx_{k+1} = x_k + h F(x_k) = x_k + h \\left( g(x_k) + r_{\\theta}(x_k) \\right)\n$$\n\n给定当前状态 $x_k = \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix}$ 和步长 $h = 0.05$。我们首先计算在此状态下的机理项 $g(x_k)$ 和神经残差项 $r_{\\theta}(x_k)$。\n\n**步骤1：计算机理项 $g(x_k)$**\n\n$g(x)$ 的分量由以下公式给出：\n$$\ng_1(x) = \\frac{\\alpha_1}{1 + x_2^{n}} - \\beta_1 x_1, \\qquad g_2(x) = \\frac{\\alpha_2}{1 + x_1^{m}} - \\beta_2 x_2\n$$\n机理模型的参数为 $\\alpha_1 = 3$，$\\alpha_2 = 4$，$\\beta_1 = 1$，$\\beta_2 = 1.5$， $n = 2$ 和 $m = 2$。我们将这些值以及 $x_k = (x_{k,1}, x_{k,2})^{\\top} = (1.2, 0.8)^{\\top}$ 的分量代入：\n$$\ng_1(x_k) = \\frac{3}{1 + (0.8)^{2}} - (1)(1.2) = \\frac{3}{1 + 0.64} - 1.2 = \\frac{3}{1.64} - 1.2 \\approx 1.829268 - 1.2 = 0.629268\n$$\n$$\ng_2(x_k) = \\frac{4}{1 + (1.2)^{2}} - (1.5)(0.8) = \\frac{4}{1 + 1.44} - 1.2 = \\frac{4}{2.44} - 1.2 \\approx 1.639344 - 1.2 = 0.439344\n$$\n因此，机理速率向量为：\n$$\ng(x_k) \\approx \\begin{pmatrix} 0.629268 \\\\ 0.439344 \\end{pmatrix}\n$$\n\n**步骤2：计算神经残差项 $r_{\\theta}(x_k)$**\n\n神经残差由一个双层MLP定义：\n$$\nr_{\\theta}(x) = W_2\\,\\tanh\\!\\big(W_1 x + b_1\\big) + b_2\n$$\n我们使用给定的网络参数计算该表达式在 $x_k$ 处的值。首先，我们计算激活前向量 $z = W_1 x_k + b_1$：\n$$\nz = \\begin{pmatrix} 0.5  -0.3 \\\\ 0.2  0.4 \\end{pmatrix} \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix} = \\begin{pmatrix} (0.5)(1.2) + (-0.3)(0.8) \\\\ (0.2)(1.2) + (0.4)(0.8) \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix}\n$$\n$$\nz = \\begin{pmatrix} 0.6 - 0.24 \\\\ 0.24 + 0.32 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix} = \\begin{pmatrix} 0.36 \\\\ 0.56 \\end{pmatrix} + \\begin{pmatrix} 0.1 \\\\ -0.2 \\end{pmatrix} = \\begin{pmatrix} 0.46 \\\\ 0.36 \\end{pmatrix}\n$$\n接下来，我们应用逐元素的双曲正切激活函数 $a = \\tanh(z)$：\n$$\na = \\begin{pmatrix} \\tanh(0.46) \\\\ \\tanh(0.36) \\end{pmatrix} \\approx \\begin{pmatrix} 0.430080 \\\\ 0.345260 \\end{pmatrix}\n$$\n最后，我们计算网络的输出 $r_{\\theta}(x_k) = W_2 a + b_2$：\n$$\nr_{\\theta}(x_k) = \\begin{pmatrix} 0.7  -0.1 \\\\ 0.05  0.6 \\end{pmatrix} \\begin{pmatrix} 0.430080 \\\\ 0.345260 \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}\n$$\n$$\nr_{\\theta}(x_k) \\approx \\begin{pmatrix} (0.7)(0.430080) + (-0.1)(0.345260) \\\\ (0.05)(0.430080) + (0.6)(0.345260) \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix}\n$$\n$$\nr_{\\theta}(x_k) \\approx \\begin{pmatrix} 0.301056 - 0.034526 \\\\ 0.021504 + 0.207156 \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.266530 \\\\ 0.228660 \\end{pmatrix} + \\begin{pmatrix} 0.01 \\\\ -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.276530 \\\\ 0.208660 \\end{pmatrix}\n$$\n\n**步骤3：计算前向欧拉更新**\n\n我们现在计算总变化率向量 $F(x_k) = g(x_k) + r_{\\theta}(x_k)$：\n$$\nF(x_k) \\approx \\begin{pmatrix} 0.905798 \\\\ 0.648004 \\end{pmatrix}\n$$\n我们用它通过前向欧拉法求出下一个状态 $x_{k+1}$：\n$$\nx_{k+1} = x_k + h F(x_k) \\approx \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix} + 0.05 \\begin{pmatrix} 0.905798 \\\\ 0.648004 \\end{pmatrix}\n$$\n$$\nx_{k+1} \\approx \\begin{pmatrix} 1.2 \\\\ 0.8 \\end{pmatrix} + \\begin{pmatrix} 0.045290 \\\\ 0.032400 \\end{pmatrix} = \\begin{pmatrix} 1.245290 \\\\ 0.832400 \\end{pmatrix}\n$$\n\n**步骤4：四舍五入到四位有效数字**\n\n最后一步是按要求将 $x_{k+1}$ 的每个分量四舍五入到四位有效数字。\n第一个分量是 $1.245290$，四舍五入为 $1.245$。\n第二个分量是 $0.832400$，四舍五入为 $0.8324$。\n因此，更新后的状态向量为：\n$$\nx_{k+1} = \\begin{pmatrix} 1.245 \\\\ 0.8324 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.245 \\\\ 0.8324 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "系统生物学的一个核心目标是预测干预（如基因敲除）的效果，但这需要区分相关性与因果关系。一个在观测数据上训练的标准机器学习模型可能会产生误导性的预测，因为它捕捉到的是相关性而非因果效应。本练习通过一个结构因果模型，让您量化观测预测与干预效应之间的差异，从而揭示潜在混杂变量所带来的偏差。",
            "id": "3299366",
            "problem": "考虑一个基因调控模块，它被建模为一个具有已知有向无环图 (DAG) 的线性结构因果模型 (SCM)。该 DAG 包含节点 $C$ (一个未观察到的细胞环境背景变量)，$G_1$ (一个被敲降的转录因子)，$G_2$ (一个下游基因)，以及 $Y$ (一个表型输出)。有向边为 $C \\rightarrow G_1$，$C \\rightarrow Y$，$G_1 \\rightarrow G_2$，$G_1 \\rightarrow Y$ 以及 $G_2 \\rightarrow Y$。该 SCM 由以下线性高斯结构方程指定：\n$$\nC \\sim \\mathcal{N}(\\mu_C,\\sigma_C^2), \\quad G_1 = a_{CG_1} C + \\varepsilon_1, \\quad G_2 = a_{12} G_1 + \\varepsilon_2, \\quad Y = b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y,\n$$\n其中 $\\varepsilon_1 \\sim \\mathcal{N}(0,\\sigma_1^2)$、$\\varepsilon_2 \\sim \\mathcal{N}(0,\\sigma_2^2)$ 和 $\\varepsilon_Y \\sim \\mathcal{N}(0,\\sigma_Y^2)$ 是相互独立的，并且也独立于 $C$。所有变量表示稳态水平，以一致的无单位相对表达或活性单位进行测量。\n\n给定数值参数：$\\mu_C = 0.5$，$\\sigma_C^2 = 1.0$， $a_{CG_1} = 1.3$，$\\sigma_1^2 = 0.4$， $a_{12} = 0.8$，$\\sigma_2^2 = 0.3$， $b_{2Y} = 2.0$，$b_{1Y} = 0.5$，$b_{CY} = 1.1$ 和 $\\sigma_Y^2 = 0.2$。\n\n一次系统性敲降将转录因子 $G_1$ 设置到固定水平 $g^* = 0.2$。使用 SCM 干预分布的截断分解定义，推导此次敲降的干预期望 $\\mathbb{E}[Y \\mid do(G_1 = g^*)]$。\n\n另外，考虑一个仅在观测数据对 $(G_1,Y)$ 上训练的深度神经预测器，其目标是最小化期望平方误差。假设数据无限且容量充足，使得学习到的预测器收敛于观测条件期望 $\\mathbb{E}[Y \\mid G_1 = g^*]$。在给定的 SCM 下推导这个观测期望。\n\n最后，计算在敲降条件下，观测预测器与干预效应之间的数值差异，定义为\n$$\n\\Delta \\equiv \\mathbb{E}[Y \\mid G_1 = g^*] - \\mathbb{E}[Y \\mid do(G_1 = g^*)].\n$$\n以无单位实数形式给出 $\\Delta$ 的值。将您的答案四舍五入到四位有效数字。",
            "solution": "### 干预期望的推导\n\n干预期望 $\\mathbb{E}[Y \\mid do(G_1 = g^*)]$ 使用修改后的 SCM 计算。$do(G_1 = g^*)$ 操作将 $G_1$ 的结构方程替换为赋值 $G_1 = g^*$，从而有效地移除了其父节点 $C$ 的影响。\n\n修改后的 SCM 为：\n$C \\sim \\mathcal{N}(\\mu_C, \\sigma_C^2)$\n$G_1 = g^*$\n$G_2 = a_{12} G_1 + \\varepsilon_2 = a_{12} g^* + \\varepsilon_2$\n$Y = b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y$\n\n我们在这个新模型下计算 $Y$ 的期望。根据期望的线性性质：\n$$\n\\mathbb{E}[Y \\mid do(G_1 = g^*)] = \\mathbb{E}[b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y]\n$$\n$$\n= b_{2Y} \\mathbb{E}[G_2] + b_{1Y} \\mathbb{E}[G_1] + b_{CY} \\mathbb{E}[C] + \\mathbb{E}[\\varepsilon_Y]\n$$\n各个分量的期望是：\n- $\\mathbb{E}[G_1] = g^*$ (因为 $G_1$ 是一个常数)。\n- $C$ 的分布不受对其子节点 $G_1$ 的干预影响，所以 $\\mathbb{E}[C] = \\mu_C$。\n- 噪声项的均值为零，$\\mathbb{E}[\\varepsilon_Y] = 0$。\n- $\\mathbb{E}[G_2] = \\mathbb{E}[a_{12} g^* + \\varepsilon_2] = a_{12} g^* + \\mathbb{E}[\\varepsilon_2] = a_{12} g^*$。\n\n将这些代入 $Y$ 的期望方程：\n$$\n\\mathbb{E}[Y \\mid do(G_1 = g^*)] = b_{2Y} (a_{12} g^*) + b_{1Y} g^* + b_{CY} \\mu_C\n$$\n$$\n= (a_{12}b_{2Y} + b_{1Y}) g^* + b_{CY} \\mu_C\n$$\n这个表达式代表了将 $G_1$ 设置为 $g^*$ 对 $Y$ 的因果效应。\n\n### 观测条件期望的推导\n\n观测条件期望 $\\mathbb{E}[Y \\mid G_1 = g^*]$ 使用原始的、未经修改的 SCM 进行计算。其前提是，一个在无限观测数据上训练以最小化平方误差的预测器将收敛到这个量。\n$$\n\\mathbb{E}[Y \\mid G_1 = g^*] = \\mathbb{E}[b_{2Y} G_2 + b_{1Y} G_1 + b_{CY} C + \\varepsilon_Y \\mid G_1 = g^*]\n$$\n使用条件期望的线性性质：\n$$\n= b_{2Y} \\mathbb{E}[G_2 \\mid G_1 = g^*] + b_{1Y} \\mathbb{E}[G_1 \\mid G_1 = g^*] + b_{CY} \\mathbb{E}[C \\mid G_1 = g^*] + \\mathbb{E}[\\varepsilon_Y \\mid G_1 = g^*]\n$$\n我们计算每一项：\n- $\\mathbb{E}[G_1 \\mid G_1 = g^*] = g^*$。\n- 因为 $\\varepsilon_Y$ 独立于所有其他变量，所以 $\\mathbb{E}[\\varepsilon_Y \\mid G_1 = g^*] = \\mathbb{E}[\\varepsilon_Y] = 0$。\n- $G_2 = a_{12}G_1 + \\varepsilon_2$。因为 $\\varepsilon_2$ 独立于 $C$ 和 $\\varepsilon_1$，所以它独立于 $G_1$。因此，$\\mathbb{E}[G_2 \\mid G_1 = g^*] = \\mathbb{E}[a_{12}G_1 + \\varepsilon_2 \\mid G_1 = g^*] = a_{12}g^* + \\mathbb{E}[\\varepsilon_2] = a_{12}g^*$。\n- 关键项是 $\\mathbb{E}[C \\mid G_1 = g^*]$。$C$ 和 $G_1$ 是联合高斯分布的，因为 $G_1$ 是 $C$ 和一个独立高斯噪声项的线性函数。\n$(C, G_1)$ 的联合分布是二元正态分布。该分布的参数为：\n$\\mathbb{E}[C] = \\mu_C$\n$\\text{Var}(C) = \\sigma_C^2$\n$\\mathbb{E}[G_1] = \\mathbb{E}[a_{CG_1}C + \\varepsilon_1] = a_{CG_1}\\mathbb{E}[C] + \\mathbb{E}[\\varepsilon_1] = a_{CG_1}\\mu_C$\n$\\text{Var}(G_1) = \\text{Var}(a_{CG_1}C + \\varepsilon_1) = a_{CG_1}^2 \\text{Var}(C) + \\text{Var}(\\varepsilon_1) = a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2$\n$\\text{Cov}(C, G_1) = \\text{Cov}(C, a_{CG_1}C + \\varepsilon_1) = a_{CG_1}\\text{Var}(C) = a_{CG_1}\\sigma_C^2$\n\n在二元正态系统中的条件期望公式为：\n$$\n\\mathbb{E}[C \\mid G_1 = g^*] = \\mathbb{E}[C] + \\frac{\\text{Cov}(C, G_1)}{\\text{Var}(G_1)} (g^* - \\mathbb{E}[G_1])\n$$\n代入推导出的参数：\n$$\n\\mathbb{E}[C \\mid G_1 = g^*] = \\mu_C + \\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\n$$\n组合成 $\\mathbb{E}[Y \\mid G_1 = g^*]$ 的完整表达式：\n$$\n\\mathbb{E}[Y \\mid G_1 = g^*] = b_{2Y}(a_{12}g^*) + b_{1Y}g^* + b_{CY}\\left(\\mu_C + \\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\\right)\n$$\n$$\n= (a_{12}b_{2Y} + b_{1Y})g^* + b_{CY}\\mu_C + b_{CY}\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\n$$\n这个表达式代表了基于观测到 $G_1=g^*$ 对 $Y$ 的预测，其中包含了来自未观察到的共同原因 $C$ 的混淆偏倚。\n\n### 差异 $\\Delta$ 的计算\n\n差异 $\\Delta$ 是观测预测减去干预效应。\n$$\n\\Delta = \\mathbb{E}[Y \\mid G_1 = g^*] - \\mathbb{E}[Y \\mid do(G_1 = g^*)]\n$$\n将两个推导出的表达式相减：\n$$\n\\Delta = \\left[(a_{12}b_{2Y} + b_{1Y})g^* + b_{CY}\\mu_C + b_{CY}\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\\right] - \\left[(a_{12}b_{2Y} + b_{1Y}) g^* + b_{CY} \\mu_C\\right]\n$$\n公共项相消，剩下混淆偏倚项：\n$$\n\\Delta = b_{CY}\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2} (g^* - a_{CG_1}\\mu_C)\n$$\n该项源于“后门路径” $G_1 \\leftarrow C \\rightarrow Y$。观测 $G_1$ 使得可以推断未观察到的混淆因子 $C$ 的状态，而 $C$ 也影响 $Y$。\n\n### 数值计算\n\n我们将给定的数值代入 $\\Delta$ 的表达式中：\n$\\mu_C = 0.5$, $\\sigma_C^2 = 1.0$, $a_{CG_1} = 1.3$, $\\sigma_1^2 = 0.4$, $b_{CY} = 1.1$, 和 $g^* = 0.2$。\n\n首先，计算表达式的各个部分：\n项 $(g^* - a_{CG_1}\\mu_C)$：\n$$\n0.2 - (1.3 \\times 0.5) = 0.2 - 0.65 = -0.45\n$$\n分数项 $\\frac{a_{CG_1}\\sigma_C^2}{a_{CG_1}^2 \\sigma_C^2 + \\sigma_1^2}$：\n$$\n\\frac{1.3 \\times 1.0}{(1.3)^2 \\times 1.0 + 0.4} = \\frac{1.3}{1.69 + 0.4} = \\frac{1.3}{2.09}\n$$\n现在，组合 $\\Delta$：\n$$\n\\Delta = 1.1 \\times \\left(\\frac{1.3}{2.09}\\right) \\times (-0.45)\n$$\n$$\n\\Delta = \\frac{1.1 \\times 1.3 \\times (-0.45)}{2.09} = \\frac{-0.6435}{2.09}\n$$\n$$\n\\Delta \\approx -0.3078947368...\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta = -0.3079$。",
            "answer": "$$\n\\boxed{-0.3079}\n$$"
        }
    ]
}