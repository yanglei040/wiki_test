{
    "hands_on_practices": [
        {
            "introduction": "Microbial communities within a host are often shaped by intense competition for limited resources. A cornerstone of theoretical ecology, the $R^*$ rule, provides a powerful framework for predicting the outcome of resource competition by identifying the species that can persist at the lowest equilibrium resource concentration. This exercise will guide you through the fundamental derivation and application of the $R^*$ concept within a chemostat model, a foundational skill for analyzing competitive dynamics in host-microbe systems .",
            "id": "3319034",
            "problem": "Consider a well-mixed mucosal niche in the host where a single limiting resource, denoted by $R$ in units of millimoles per liter ($\\mathrm{mmol\\ L^{-1}}$), is supplied by the host at inflow concentration $S$ and washed out at a volumetric turnover rate $D$ in units of per hour ($\\mathrm{h^{-1}}$). Three microbial populations use $R$: a pathogen $P$ and two commensals $C_{A}$ and $C_{B}$. Assume the following chemostat-style dynamics, consistent with mass balance and standard microbial physiology:\n- The resource dynamics are given by\n$$\n\\frac{dR}{dt} \\;=\\; D\\,(S - R) \\;-\\; \\sum_{i\\in\\{P,C_{A},C_{B}\\}} \\frac{1}{Y_{i}}\\,\\mu_{i}(R)\\,X_{i},\n$$\nwhere $X_{i}$ is the biomass concentration of species $i$ (in any consistent biomass unit), $Y_{i}$ is the biomass yield per unit resource (in biomass per $\\mathrm{mmol}$), and $\\mu_{i}(R)$ is the gross specific growth rate.\n- The population dynamics are given by\n$$\n\\frac{dX_{i}}{dt} \\;=\\; \\big(\\mu_{i}(R) - m_{i} - D\\big)\\,X_{i},\n$$\nwhere $m_{i}$ is a maintenance rate (in $\\mathrm{h^{-1}}$) that subtracts from the gross growth to yield the net growth available for dilution-balanced persistence.\n\nAssume Michaelis–Menten (Monod) growth kinetics for each species,\n$$\n\\mu_{i}(R) \\;=\\; \\mu_{\\max,i}\\,\\frac{R}{K_{i} + R},\n$$\nwhere $\\mu_{\\max,i}$ is the maximal specific growth rate (in $\\mathrm{h^{-1}}$) and $K_{i}$ is the half-saturation constant (in $\\mathrm{mmol\\ L^{-1}}$). The equilibrium resource requirement $R^{*}_{i}$ for species $i$ is defined as the steady-state resource concentration at which species $i$ can just persist alone in the chemostat (its net per-capita growth balances dilution), under the above dynamics.\n\nParameters for the host environment and the three species are:\n- Host supply concentration $S = 0.25$ $\\mathrm{mmol\\ L^{-1}}$; turnover $D = 0.20$ $\\mathrm{h^{-1}}$.\n- Pathogen $P$: $\\mu_{\\max,P} = 0.85$ $\\mathrm{h^{-1}}$, $K_{P} = 0.030$ $\\mathrm{mmol\\ L^{-1}}$, $m_{P} = 0.050$ $\\mathrm{h^{-1}}$, $Y_{P} = 0.45$ (biomass per $\\mathrm{mmol}$).\n- Commensal $C_{A}$: $\\mu_{\\max,C_{A}} = 0.65$ $\\mathrm{h^{-1}}$, $K_{C_{A}} = 0.015$ $\\mathrm{mmol\\ L^{-1}}$, $m_{C_{A}} = 0.020$ $\\mathrm{h^{-1}}$, $Y_{C_{A}} = 0.55$ (biomass per $\\mathrm{mmol}$).\n- Commensal $C_{B}$: $\\mu_{\\max,C_{B}} = 1.10$ $\\mathrm{h^{-1}}$, $K_{C_{B}} = 0.080$ $\\mathrm{mmol\\ L^{-1}}$, $m_{C_{B}} = 0.120$ $\\mathrm{h^{-1}}$, $Y_{C_{B}} = 0.40$ (biomass per $\\mathrm{mmol}$).\n\nTasks:\n1. Starting from the above dynamical definitions and the Monod law, derive a general closed-form expression for $R^{*}_{i}$ in terms of $(\\mu_{\\max,i}, K_{i}, m_{i}, D)$ for any single species $i$.\n2. Use the derived expression to compute $R^{*}_{P}$, $R^{*}_{C_{A}}$, and $R^{*}_{C_{B}}$ with the given parameters.\n3. Assume the host niche is initially dominated by $C_{A}$ alone at its single-species steady state. Using the dynamical definitions and your $R^{*}$ results, determine whether $P$ or $C_{B}$ can invade when introduced at infinitesimal density by evaluating the quantity\n$$\n\\Delta_{i\\mid C_{A}} \\;=\\; R_{\\mathrm{res}} - R^{*}_{i},\n$$\nwhere $R_{\\mathrm{res}}$ is the resource concentration in the resident state with $C_{A}$ alone. A positive $\\Delta_{i\\mid C_{A}}$ implies invasion is possible; a negative value implies invasion fails.\n\nAnswer format:\n- Report the five requested quantities in the ordered row matrix $\\big(R^{*}_{P}\\; R^{*}_{C_{A}}\\; R^{*}_{C_{B}}\\; \\Delta_{P\\mid C_{A}}\\; \\Delta_{C_{B}\\mid C_{A}}\\big)$.\n- Express each entry in $\\mathrm{mmol\\ L^{-1}}$.\n- Round each reported value to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded in standard ecological competition theory, and contains all necessary information for a unique solution. We can therefore proceed with the derivation and calculation.\n\n**1. Derivation of the equilibrium resource requirement, $R^{*}_{i}$**\n\nThe equilibrium resource requirement, $R^{*}_{i}$, is defined as the steady-state resource concentration at which a single species $i$ can just persist in the chemostat. This means its population biomass $X_{i}$ is non-zero and constant, i.e., at a non-trivial steady state. The condition for any steady state is that the population's rate of change is zero:\n$$\n\\frac{dX_{i}}{dt} \\;=\\; \\big(\\mu_{i}(R) - m_{i} - D\\big)\\,X_{i} \\;=\\; 0\n$$\nFor a non-trivial steady state ($X_i  0$), the term in the parenthesis must be zero. The resource concentration that satisfies this condition is, by definition, $R^{*}_{i}$:\n$$\n\\mu_{i}(R^{*}_{i}) - m_{i} - D \\;=\\; 0\n$$\nThis equation states that at the equilibrium resource level $R^{*}_{i}$, the gross specific growth rate must exactly balance the total loss rate due to maintenance ($m_i$) and washout ($D$).\nRearranging gives the required growth rate for persistence:\n$$\n\\mu_{i}(R^{*}_{i}) \\;=\\; m_{i} + D\n$$\nWe now substitute the given Michaelis–Menten (Monod) kinetics for the growth rate $\\mu_{i}(R)$:\n$$\n\\mu_{\\max,i}\\,\\frac{R^{*}_{i}}{K_{i} + R^{*}_{i}} \\;=\\; m_{i} + D\n$$\nTo find the closed-form expression for $R^{*}_{i}$, we solve this equation algebraically:\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} \\;=\\; (m_{i} + D)(K_{i} + R^{*}_{i})\n$$\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} \\;=\\; (m_{i} + D)K_{i} + (m_{i} + D)R^{*}_{i}\n$$\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} - (m_{i} + D)R^{*}_{i} \\;=\\; (m_{i} + D)K_{i}\n$$\n$$\nR^{*}_{i}\\,\\big(\\mu_{\\max,i} - m_{i} - D\\big) \\;=\\; K_{i}\\,(m_{i} + D)\n$$\nFinally, isolating $R^{*}_{i}$ yields the general expression:\n$$\nR^{*}_{i} \\;=\\; K_{i}\\,\\frac{m_{i} + D}{\\mu_{\\max,i} - m_{i} - D}\n$$\nThis expression is valid provided that $\\mu_{\\max,i}  m_{i} + D$, which ensures that the species has a maximum potential growth rate sufficient to overcome its losses, leading to a physically meaningful positive value for $R^{*}_{i}$.\n\n**2. Calculation of $R^{*}_{P}$, $R^{*}_{C_{A}}$, and $R^{*}_{C_{B}}$**\n\nUsing the derived formula and the provided parameters, with the dilution rate $D = 0.20$ $\\mathrm{h^{-1}}$, we compute the equilibrium resource requirement for each species.\n\nFor the pathogen $P$:\n$m_{P} + D = 0.050 + 0.20 = 0.25$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,P} - m_{P} - D = 0.85 - 0.25 = 0.60$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{P} \\;=\\; K_{P}\\,\\frac{m_{P} + D}{\\mu_{\\max,P} - m_{P} - D} \\;=\\; (0.030\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.25}{0.60} \\;=\\; 0.0125\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\nFor the commensal $C_{A}$:\n$m_{C_{A}} + D = 0.020 + 0.20 = 0.22$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,C_{A}} - m_{C_{A}} - D = 0.65 - 0.22 = 0.43$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{C_{A}} \\;=\\; K_{C_{A}}\\,\\frac{m_{C_{A}} + D}{\\mu_{\\max,C_{A}} - m_{C_{A}} - D} \\;=\\; (0.015\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.22}{0.43} \\;\\approx\\; 0.0076744\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\nFor the commensal $C_{B}$:\n$m_{C_{B}} + D = 0.120 + 0.20 = 0.32$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,C_{B}} - m_{C_{B}} - D = 1.10 - 0.32 = 0.78$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{C_{B}} \\;=\\; K_{C_{B}}\\,\\frac{m_{C_{B}} + D}{\\mu_{\\max,C_{B}} - m_{C_{B}} - D} \\;=\\; (0.080\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.32}{0.78} \\;\\approx\\; 0.032821\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\n**3. Invasion Analysis**\n\nThe problem posits a niche dominated by commensal $C_A$ at its single-species steady state. In this state, assuming the species is not washed out ($X_{C_A}  0$), the species will draw down the limiting resource concentration to its own equilibrium requirement. Therefore, the resident resource concentration is $R_{\\mathrm{res}} = R^{*}_{C_{A}}$. This is possible because $R^{*}_{C_{A}} \\approx 0.007674\\,\\mathrm{mmol\\ L^{-1}}$ is less than the supply concentration $S=0.25\\,\\mathrm{mmol\\ L^{-1}}$.\n\nAn invading species $i$ (here, $P$ or $C_B$) can successfully establish in this environment if its initial per-capita growth rate is positive. The growth rate for an invader at infinitesimal density is determined by the resource level set by the resident, $R_{\\mathrm{res}}$:\n$$\n\\frac{1}{X_i}\\frac{dX_{i}}{dt} \\;=\\; \\mu_{i}(R_{\\mathrm{res}}) - m_{i} - D\n$$\nThis growth rate is positive if and only if $\\mu_{i}(R_{\\mathrm{res}})  m_{i} + D$. Since $\\mu_i(R)$ is a monotonically increasing function of $R$, and by definition $\\mu_{i}(R^{*}_{i}) = m_{i} + D$, the condition for positive growth becomes $R_{\\mathrm{res}}  R^{*}_{i}$.\n\nThe problem defines the quantity $\\Delta_{i\\mid C_{A}} = R_{\\mathrm{res}} - R^{*}_{i}$. A positive value indicates successful invasion.\nUsing $R_{\\mathrm{res}} = R^{*}_{C_{A}}$, we calculate $\\Delta$ for the two potential invaders.\n\nFor the invasion of pathogen $P$:\n$$\n\\Delta_{P\\mid C_{A}} \\;=\\; R^{*}_{C_{A}} - R^{*}_{P} \\;\\approx\\; 0.0076744 - 0.0125 \\;=\\; -0.0048256\\,\\mathrm{mmol\\ L^{-1}}\n$$\nSince $\\Delta_{P\\mid C_{A}}  0$, the pathogen $P$ cannot invade the niche when occupied by $C_A$.\n\nFor the invasion of commensal $C_{B}$:\n$$\n\\Delta_{C_{B}\\mid C_{A}} \\;=\\; R^{*}_{C_{A}} - R^{*}_{C_{B}} \\;\\approx\\; 0.0076744 - 0.032821 \\;=\\; -0.0251466\\,\\mathrm{mmol\\ L^{-1}}\n$$\nSince $\\Delta_{C_{B}\\mid C_{A}}  0$, commensal $C_B$ also cannot invade.\n\nThis outcome is consistent with the R-star competition rule, which states that for a single limiting resource, the species with the lowest $R^*$ will be the superior competitor and exclude all others. Here, $R^{*}_{C_{A}}$ is the lowest of the three values.\n\nRounding the five requested quantities to four significant figures gives:\n$R^{*}_{P} \\to 0.01250$\n$R^{*}_{C_{A}} \\to 0.007674$\n$R^{*}_{C_{B}} \\to 0.03282$\n$\\Delta_{P\\mid C_{A}} \\to -0.004826$\n$\\Delta_{C_{B}\\mid C_{A}} \\to -0.02515$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01250  0.007674  0.03282  -0.004826  -0.02515 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The host immune system, particularly components like Secretory Immunoglobulin A (sIgA), imposes strong selective pressures that can prevent or limit microbial colonization. We can capture these direct host-microbe conflicts using dynamic models where immune-mediated removal acts as a loss term on the microbial population. In this practice, you will use linear stability analysis to determine the conditions for microbial persistence and explore how therapeutic interventions could shift the balance by modulating this immune pressure .",
            "id": "3319080",
            "problem": "You are asked to formalize and analyze a host–microbe interaction model in which Secretory Immunoglobulin A (sIgA) acts as a selective pressure on microbial adhesion by binding to adherent microbes and reducing their effective net growth. Start from the following foundational bases in computational systems biology: (i) mass-action kinetics for binding or removal processes, (ii) logistic growth of a microbial population constrained by a finite resource or niche, and (iii) linear stability analysis near a boundary equilibrium for invasion criteria. Construct a model for an adherent microbial population $N_{\\mathrm{adh}}(t)$ whose dynamics obey logistic birth and removal by sIgA binding proportional to the product of the sIgA level and the adherent population. Assume the functional form\n$$\n\\frac{dN_{\\mathrm{adh}}}{dt} = r\\,N_{\\mathrm{adh}}\\left(1 - \\frac{N_{\\mathrm{adh}}}{K}\\right) - \\sigma\\, \\mathrm{sIgA}(t)\\, N_{\\mathrm{adh}},\n$$\nwhere $r$ is the intrinsic growth rate, $K$ is the carrying capacity, and $\\sigma$ is the binding-mediated removal coefficient. Here $r$ has units of per day, $K$ is a reference population scale, and $\\sigma$ has units of per day per unit of sIgA. The quantity $\\mathrm{sIgA}(t)$ is a dimensionless, normalized measure of Secretory Immunoglobulin A (sIgA) concentration as a function of time in days. All numerical answers should be treated as dimensionless except quantities that inherently have units of per day; express all rates in per day and all time-like quantities in days. The required outputs here are dimensionless, so no explicit physical unit should appear in the outputs.\n\nYour tasks are:\n- Using first principles, derive a criterion for colonization persistence versus eradication based on the linear stability of the boundary equilibrium $N_{\\mathrm{adh}} = 0$ under time-varying $\\mathrm{sIgA}(t)$. Specialize your criterion to the case of periodic $\\mathrm{sIgA}(t)$ and express it in terms of the time average $\\overline{\\mathrm{sIgA}}$ over one period. Use this criterion to produce a boolean persistence indicator for each test case, defined as true if the adherent population persists (strictly positive growth at vanishing density) and false otherwise.\n- Using an averaging approximation for periodic forcing, obtain the long-time equilibrium abundance $N_{\\ast}$ when persistence holds by replacing $\\mathrm{sIgA}(t)$ with its time average $\\overline{\\mathrm{sIgA}}$ in the nonlinear term and solving for a steady state. If the equilibrium is non-positive, report it as zero. Your program must output $N_{\\ast}$ as a float.\n- Design an intervention that modulates the baseline of $\\mathrm{sIgA}(t)$ by adding a constant shift $\\Delta s_{0}$ to obtain $\\mathrm{sIgA}'(t) = \\mathrm{sIgA}(t) + \\Delta s_{0}$, and compute two minimal non-negative shifts: (i) the smallest $\\Delta s_{0}^{\\uparrow}$ that achieves eradication (non-persistence), and (ii) the smallest $\\Delta s_{0}^{\\downarrow}$ that achieves persistence. Report these as floats. If the current regime already satisfies the target, the minimal shift is zero. Treat the boundary (exact neutrality) as non-persistent for the boolean indicator, and define the minimal shift as zero when the system already sits at the boundary or on the desired side.\n\nFor periodic $\\mathrm{sIgA}(t)$, consider two classes:\n- Sinusoidal: $\\mathrm{sIgA}(t) = s_{0} + A \\sin\\left(2\\pi t/T\\right)$ with time average $s_{0}$.\n- Pulsed: $\\mathrm{sIgA}(t)$ equals $s_{\\mathrm{low}}$ for a fraction $\\phi$ of each period and $s_{\\mathrm{high}}$ for the remaining fraction $1-\\phi$; the time average is $\\overline{\\mathrm{sIgA}} = \\phi s_{\\mathrm{low}} + (1-\\phi) s_{\\mathrm{high}}$.\n\nImplement a program that, for each test case, does the following:\n- Computes the time average $\\overline{\\mathrm{sIgA}}$ for the specified profile.\n- Uses your derived persistence criterion to output a boolean.\n- Computes the averaged equilibrium $N_{\\ast}$ as a float using the averaging approximation.\n- Computes the minimal baseline shifts $\\Delta s_{0}^{\\uparrow}$ and $\\Delta s_{0}^{\\downarrow}$ as floats.\n\nExpress all floats rounded to six decimal places. Booleans must be unquoted logical values.\n\nTest suite:\n- Case 1 (sinusoidal): $r = 0.8$ per day, $K = 1.0$ (dimensionless scaling), $\\sigma = 0.5$ per day per unit sIgA, $s_{0} = 1.0$, $A = 0.2$, $T = 7$ days.\n- Case 2 (sinusoidal, boundary): $r = 0.5$ per day, $K = 1.0$, $\\sigma = 0.5$, $s_{0} = 1.0$, $A = 0.4$, $T = 7$ days.\n- Case 3 (sinusoidal, extinction): $r = 0.6$ per day, $K = 1.0$, $\\sigma = 1.0$, $s_{0} = 0.8$, $A = 0.1$, $T = 7$ days.\n- Case 4 (pulsed): $r = 1.2$ per day, $K = 1.0$, $\\sigma = 0.7$, $s_{\\mathrm{low}} = 0.2$, $s_{\\mathrm{high}} = 1.8$, $\\phi = 0.25$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case produces a list of the form $[\\text{boolean}, N_{\\ast}, \\Delta s_{0}^{\\uparrow}, \\Delta s_{0}^{\\downarrow}]$. For example, a line like $[[\\text{True},0.123456,0.100000,0.000000],[\\dots]]$ is acceptable. Do not print any additional text.",
            "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\nThe problem provides the following model and parameters for an adherent microbial population $N_{\\mathrm{adh}}(t)$:\n- **Governing Equation**:\n$$\n\\frac{dN_{\\mathrm{adh}}}{dt} = r\\,N_{\\mathrm{adh}}\\left(1 - \\frac{N_{\\mathrm{adh}}}{K}\\right) - \\sigma\\, \\mathrm{sIgA}(t)\\, N_{\\mathrm{adh}}\n$$\n- **Parameters**:\n  - $r$: intrinsic growth rate (units: per day)\n  - $K$: carrying capacity (dimensionless scaling)\n  - $\\sigma$: binding-mediated removal coefficient (units: per day per unit of sIgA)\n- **Variable**:\n  - $N_{\\mathrm{adh}}(t)$: adherent microbial population\n  - $\\mathrm{sIgA}(t)$: dimensionless, normalized measure of Secretory Immunoglobulin A concentration as a function of time (in days).\n- **Functional Forms for $\\mathrm{sIgA}(t)$**:\n  - **Sinusoidal**: $\\mathrm{sIgA}(t) = s_{0} + A \\sin\\left(2\\pi t/T\\right)$. Time average is $\\overline{\\mathrm{sIgA}} = s_0$.\n  - **Pulsed**: $\\mathrm{sIgA}(t)$ is $s_{\\mathrm{low}}$ for a fraction $\\phi$ of each period and $s_{\\mathrm{high}}$ for the fraction $1-\\phi$. Time average is $\\overline{\\mathrm{sIgA}} = \\phi s_{\\mathrm{low}} + (1-\\phi) s_{\\mathrm{high}}$.\n- **Tasks**:\n  1.  Derive a persistence criterion from the linear stability of the $N_{\\mathrm{adh}} = 0$ equilibrium for periodic $\\mathrm{sIgA}(t)$, expressed in terms of $\\overline{\\mathrm{sIgA}}$. Use this to generate a boolean persistence indicator.\n  2.  Compute the long-time equilibrium abundance $N_{\\ast}$ using an averaging approximation, replacing $\\mathrm{sIgA}(t)$ with $\\overline{\\mathrm{sIgA}}$. If non-positive, report $0$.\n  3.  Compute two minimal non-negative shifts: $\\Delta s_{0}^{\\uparrow}$ to achieve eradication and $\\Delta s_{0}^{\\downarrow}$ to achieve persistence. The intervention is defined as $\\mathrm{sIgA}'(t) = \\mathrm{sIgA}(t) + \\Delta s_{0}$. If the target regime is already met or the system is at the boundary, the shift is $0$. Boundary case ($r = \\sigma\\overline{\\mathrm{sIgA}}$) is treated as non-persistent.\n- **Test Cases**:\n  - Case 1: (sinusoidal) $r = 0.8$, $K = 1.0$, $\\sigma = 0.5$, $s_{0} = 1.0$, $A = 0.2$, $T = 7$.\n  - Case 2: (sinusoidal) $r = 0.5$, $K = 1.0$, $\\sigma = 0.5$, $s_{0} = 1.0$, $A = 0.4$, $T = 7$.\n  - Case 3: (sinusoidal) $r = 0.6$, $K = 1.0$, $\\sigma = 1.0$, $s_{0} = 0.8$, $A = 0.1$, $T = 7$.\n  - Case 4: (pulsed) $r = 1.2$, $K = 1.0$, $\\sigma = 0.7$, $s_{\\mathrm{low}} = 0.2$, $s_{\\mathrm{high}} = 1.8$, $\\phi = 0.25$.\n- **Output Format**: A list of lists, with each inner list being $[\\text{boolean}, N_{\\ast}, \\Delta s_{0}^{\\uparrow}, \\Delta s_{0}^{\\downarrow}]$. Floats rounded to six decimal places.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The model is a standard logistic growth model modified with a linear loss term proportional to an external factor. This is a common and valid approach in population dynamics, ecology, and epidemiology (e.g., modeling predation or treatment). The use of mass-action kinetics for the removal term is a foundational principle.\n- **Well-Posed**: The problem is clearly defined with a specific differential equation, parameter values, and distinct, quantifiable tasks. The concepts of linear stability analysis, averaging approximations, and intervention design are standard mathematical techniques in systems biology. A unique solution exists for each requested calculation.\n- **Objective**: The problem is stated in precise, formal language. All terms are defined, and the tasks are unambiguous computational objectives.\n- **No Flaws Detected**: The problem does not violate any scientific principles, is not metaphorical, is fully specified, is scientifically feasible, is well-structured, is non-trivial, and is scientifically verifiable. The potential ambiguity in the definition of the \"minimal non-negative shift\" for persistence is resolved by interpreting it as the magnitude of a required downward shift, a common practice in control problems where one seeks the magnitude of an intervention. This interpretation renders the problem fully coherent.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe analysis proceeds in three parts as requested by the problem statement. The governing differential equation is:\n$$\n\\frac{dN_{\\mathrm{adh}}}{dt} = N_{\\mathrm{adh}} \\left[ r\\left(1 - \\frac{N_{\\mathrm{adh}}}{K}\\right) - \\sigma\\, \\mathrm{sIgA}(t) \\right]\n$$\n\n**1. Persistence Criterion from Linear Stability Analysis**\n\nThe persistence of the microbial population is determined by its ability to invade a microbe-free environment. This is analyzed by examining the stability of the boundary equilibrium $N_{\\mathrm{adh}} = 0$. We consider a small perturbation $\\epsilon(t)$ around this equilibrium, such that $N_{\\mathrm{adh}}(t) = 0 + \\epsilon(t)$. Substituting this into the governing equation and retaining only terms linear in $\\epsilon$ yields the linearized dynamics:\n$$\n\\frac{d\\epsilon}{dt} = \\epsilon \\left[ r\\left(1 - \\frac{\\epsilon}{K}\\right) - \\sigma\\, \\mathrm{sIgA}(t) \\right] \\approx \\left( r - \\sigma\\, \\mathrm{sIgA}(t) \\right) \\epsilon(t)\n$$\nThis linear ODE has the solution:\n$$\n\\epsilon(t) = \\epsilon(0) \\exp\\left( \\int_0^t [r - \\sigma\\, \\mathrm{sIgA}(\\tau)] d\\tau \\right)\n$$\nThe population will grow (persist) if the long-term average growth rate, denoted $\\lambda$, is positive. For a periodic function $\\mathrm{sIgA}(t)$ with period $T_p$, this corresponds to the average growth rate over one period:\n$$\n\\lambda = \\frac{1}{T_p} \\int_0^{T_p} \\left( r - \\sigma\\, \\mathrm{sIgA}(\\tau) \\right) d\\tau = r - \\frac{\\sigma}{T_p} \\int_0^{T_p} \\mathrm{sIgA}(\\tau) d\\tau\n$$\nRecognizing the integral term as the time-average of sIgA, $\\overline{\\mathrm{sIgA}}$, the criterion simplifies to:\n$$\n\\lambda = r - \\sigma \\overline{\\mathrm{sIgA}}\n$$\nPersistence requires $\\lambda  0$, leading to the criterion:\n$$\nr  \\sigma \\overline{\\mathrm{sIgA}} \\quad \\text{or} \\quad \\frac{r}{\\sigma}  \\overline{\\mathrm{sIgA}}\n$$\nThe boolean persistence indicator is `True` if this condition is met, and `False` otherwise, including the boundary case $r = \\sigma \\overline{\\mathrm{sIgA}}$.\n\nThe time-average $\\overline{\\mathrm{sIgA}}$ is calculated for each specified profile:\n- For the sinusoidal profile, $\\mathrm{sIgA}(t) = s_0 + A \\sin(2\\pi t/T)$, the average over one period $T$ is $\\overline{\\mathrm{sIgA}} = s_0$, since the sine term integrates to zero.\n- For the pulsed profile, the average is given as $\\overline{\\mathrm{sIgA}} = \\phi s_{\\mathrm{low}} + (1-\\phi) s_{\\mathrm{high}}$.\n\n**2. Averaged Equilibrium Abundance $N_{\\ast}$**\n\nThe problem asks for an averaging approximation where the time-varying forcing $\\mathrm{sIgA}(t)$ is replaced by its constant time-average $\\overline{\\mathrm{sIgA}}$ in the full nonlinear equation:\n$$\n\\frac{dN_{\\mathrm{adh}}}{dt} = r N_{\\mathrm{adh}}\\left(1 - \\frac{N_{\\mathrm{adh}}}{K}\\right) - \\sigma \\overline{\\mathrm{sIgA}} N_{\\mathrm{adh}}\n$$\nThe non-trivial equilibrium state $N_{\\ast}$ is found by setting $\\frac{dN_{\\mathrm{adh}}}{dt} = 0$ for $N_{\\mathrm{adh}}0$:\n$$\nr \\left(1 - \\frac{N_{\\ast}}{K}\\right) - \\sigma \\overline{\\mathrm{sIgA}} = 0\n$$\nSolving for $N_{\\ast}$:\n$$\nr - \\frac{r N_{\\ast}}{K} = \\sigma \\overline{\\mathrm{sIgA}}\n$$\n$$\n\\frac{r N_{\\ast}}{K} = r - \\sigma \\overline{\\mathrm{sIgA}}\n$$\n$$\nN_{\\ast} = K \\left(1 - \\frac{\\sigma \\overline{\\mathrm{sIgA}}}{r}\\right)\n$$\nThis equilibrium is physically meaningful (i.e., $N_{\\ast}  0$) only if $1 - \\frac{\\sigma \\overline{\\mathrm{sIgA}}}{r}  0$, which is identical to the persistence criterion $r  \\sigma \\overline{\\mathrm{sIgA}}$. If the persistence criterion is not met, the only stable and non-negative equilibrium is $N_{\\ast} = 0$.\n\n**3. Minimal Intervention Shifts**\n\nThe persistence of the population is determined by the relationship between the time-averaged sIgA level, $\\overline{\\mathrm{sIgA}}$, and the critical threshold $s_c = r/\\sigma$. The system is persistent if $\\overline{\\mathrm{sIgA}}  s_c$ and non-persistent if $\\overline{\\mathrm{sIgA}} \\ge s_c$.\nWe are asked to find the minimal non-negative shifts $\\Delta s_{0}^{\\uparrow}$ and $\\Delta s_{0}^{\\downarrow}$ that achieve eradication and persistence, respectively. This is interpreted as finding the minimum non-negative magnitudes of intervention required to move the parameter $\\overline{\\mathrm{sIgA}}$ across the critical boundary $s_c$.\n\n- **Minimal shift for eradication ($\\Delta s_{0}^{\\uparrow}$)**: This requires increasing the sIgA level to achieve non-persistence. The target is to have the new average, $\\overline{\\mathrm{sIgA}}' = \\overline{\\mathrm{sIgA}} + \\Delta s_{0}^{\\uparrow}$, satisfy $\\overline{\\mathrm{sIgA}}' \\ge s_c$.\n  If the system is already non-persistent ($\\overline{\\mathrm{sIgA}} \\ge s_c$), no action is needed, so $\\Delta s_{0}^{\\uparrow} = 0$.\n  If the system is persistent ($\\overline{\\mathrm{sIgA}}  s_c$), we need to increase $\\overline{\\mathrm{sIgA}}$ to at least $s_c$. The minimal non-negative shift required is the difference:\n  $$ \\Delta s_{0}^{\\uparrow} = s_c - \\overline{\\mathrm{sIgA}} = \\frac{r}{\\sigma} - \\overline{\\mathrm{sIgA}} $$\n  Combining these cases, the formula is $\\Delta s_{0}^{\\uparrow} = \\max\\left(0, \\frac{r}{\\sigma} - \\overline{\\mathrm{sIgA}}\\right)$.\n\n- **Minimal shift for persistence ($\\Delta s_{0}^{\\downarrow}$)**: This requires decreasing the sIgA level to achieve persistence. The target is to have the new average, $\\overline{\\mathrm{sIgA}}'' = \\overline{\\mathrm{sIgA}} - \\Delta s_{0}^{\\downarrow}$, satisfy $\\overline{\\mathrm{sIgA}}''  s_c$. Note the subtractive intervention, corresponding to the goal of promoting persistence.\n  If the system is already persistent ($\\overline{\\mathrm{sIgA}}  s_c$), no action is needed, so $\\Delta s_{0}^{\\downarrow} = 0$.\n  If the system is non-persistent ($\\overline{\\mathrm{sIgA}} \\ge s_c$), we need to decrease $\\overline{\\mathrm{sIgA}}$ until it is just below $s_c$. The minimal non-negative magnitude of the required reduction is:\n  $$ \\Delta s_{0}^{\\downarrow} = \\overline{\\mathrm{sIgA}} - s_c = \\overline{\\mathrm{sIgA}} - \\frac{r}{\\sigma} $$\n  Combining these cases, the formula is $\\Delta s_{0}^{\\downarrow} = \\max\\left(0, \\overline{\\mathrm{sIgA}} - \\frac{r}{\\sigma}\\right)$.\n\nThese formulae provide a complete algorithm to compute the required outputs for each test case.",
            "answer": "[[True,0.375000,0.600000,0.000000],[False,0.000000,0.000000,0.000000],[False,0.000000,0.000000,0.200000],[True,0.183333,0.314286,0.000000]]"
        },
        {
            "introduction": "To understand the intricate metabolic dependencies between organisms, we can move beyond population-level descriptions to genome-scale models. Community Flux Balance Analysis (FBA) is a powerful constraint-based approach that models the coupled metabolic networks of a host and its microbes, allowing us to investigate phenomena like nutrient cross-feeding and metabolic competition. This hands-on coding problem will walk you through the process of building and solving a community FBA model, giving you practical experience with a core technique in computational systems biology .",
            "id": "3319045",
            "problem": "You are asked to formalize and solve a community Flux Balance Analysis (FBA) model coupling a host and a microbe under steady-state mass balance. Flux Balance Analysis (FBA) models metabolic networks by asserting a steady-state mass balance for intracellular metabolites, encoded by a stoichiometric matrix and a flux vector, and optimizes a biologically meaningful linear objective subject to physicochemical flux bounds. In a host–microbe community FBA, the host and the microbe are represented by separate stoichiometric matrices and flux vectors, and are coupled through exchange fluxes representing inter-compartment metabolite transport.\n\nStart from the fundamental principles:\n- Steady-state mass balance for each compartment implies that intracellular metabolite concentrations are time-invariant under constant flux patterns. This is encoded as a homogeneous linear system for the fluxes. For a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ (where $m$ is the number of intracellular metabolites and $n$ is the number of reactions) and flux vector $v \\in \\mathbb{R}^{n}$, the mass balance is $S v = 0$.\n- Reaction fluxes are bounded due to enzyme capacity, thermodynamics, and transport limits. Each flux $v_i$ is constrained by lower and upper bounds $l_i \\le v_i \\le u_i$ in the physical units millimole per gram dry weight per hour ($\\mathrm{mmol\\ gDW^{-1}\\ h^{-1}}$).\n- A community objective is a weighted sum of host and microbe objectives. With a host objective flux $v_{h,\\text{obj}}$ and a microbe objective flux $v_{m,\\text{obj}}$, and nonnegative weights $w_h, w_m$, the community objective is $w_h v_{h,\\text{obj}} + w_m v_{m,\\text{obj}}$.\n\nFormulate the optimization problem\n$$\n\\max_{v_h, v_m, v_e}\\quad w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}\n$$\nsubject to\n$$\nS_h v_h = 0,\\quad S_m v_m = 0,\n$$\nand exchange coupling constraints between host and microbe through exchange fluxes $v_e$, along with individual flux bounds. The exchange coupling must enforce that the host’s export flux of the exchanged metabolite equals the microbe’s import flux and also equals the exchange variable. Specifically, if $v_{h,\\text{exp}}$ is the host export reaction flux and $v_{m,\\text{imp}}$ is the microbe import reaction flux, impose\n$$\nv_e - v_{h,\\text{exp}} = 0,\\quad v_e - v_{m,\\text{imp}} = 0,\n$$\nwith $v_e$ bounded by $0 \\le v_e \\le E_{\\max}$ in $\\mathrm{mmol\\ gDW^{-1}\\ h^{-1}}$.\n\nImplement this linear optimization as a single program that, given the following test suite of parameter values, computes the optimal objective value $w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}$ for each case. Report each optimal value in $\\mathrm{mmol\\ gDW^{-1}\\ h^{-1}}$ as a float rounded to six decimal places.\n\nHost network definition:\n- Host metabolites: two intracellular species, labeled implicitly by rows.\n- Host reactions: $4$ reactions with stoichiometric matrix\n$$\nS_h = \\begin{bmatrix}\n1  -1  0  0\\\\\n0  1  -1  -1\n\\end{bmatrix},\n$$\nwhere the columns correspond to reactions in order: $R_{h,1}$ (uptake of $A$ from environment), $R_{h,2}$ (conversion $A_h \\to B_h$), $R_{h,3}$ (host biomass using $B_h$), $R_{h,4}$ (export of $B_h$ to microbe). The host objective is to maximize the host biomass flux, so the host objective selector is\n$$\nc_h = \\begin{bmatrix}0  0  1  0\\end{bmatrix}^\\top,\n$$\nwhich picks $R_{h,3}$.\n\nMicrobe network definition:\n- Microbe metabolites: two intracellular species, labeled implicitly by rows.\n- Microbe reactions: $3$ reactions with stoichiometric matrix\n$$\nS_m = \\begin{bmatrix}\n1  -1  0\\\\\n0  1  -1\n\\end{bmatrix},\n$$\nwhere the columns correspond to reactions in order: $R_{m,1}$ (import of $B$ from host), $R_{m,2}$ (conversion $B_m \\to C_m$), $R_{m,3}$ (microbe biomass using $C_m$). The microbe objective selector is\n$$\nc_m = \\begin{bmatrix}0  0  1\\end{bmatrix}^\\top,\n$$\nwhich picks $R_{m,3}$.\n\nExchange coupling:\n- Single exchange variable $v_e$ represents the net flux of $B$ from host to microbe. It is coupled to host export and microbe import by the equalities $v_e = v_{h,4}$ and $v_e = v_{m,1}$.\n- Bound for $v_e$: $0 \\le v_e \\le E_{\\max}$, where $E_{\\max}$ is specified per test case.\n\nFlux bounds, unless otherwise specified per test case:\n- Host reaction bounds (in order $R_{h,1}$, $R_{h,2}$, $R_{h,3}$, $R_{h,4}$): lower bounds $l_h = [0, 0, 0, 0]$ and upper bounds $u_h = [U_{\\text{in}}, 10, 10, 10]$, where $U_{\\text{in}}$ is the host uptake capacity for $R_{h,1}$ provided per test case in $\\mathrm{mmol\\ gDW^{-1}\\ h^{-1}}$, and the other upper bounds are $10$ $\\mathrm{mmol\\ gDW^{-1}\\ h^{-1}}$.\n- Microbe reaction bounds (in order $R_{m,1}$, $R_{m,2}$, $R_{m,3}$): lower bounds $l_m = [0, 0, 0]$ and upper bounds $u_m = [10, 10, 10]$ in $\\mathrm{mmol\\ gDW^{-1}\\ h^{-1}}$.\n\nTest suite:\n- Case $1$: weights $w_h = 0.5$, $w_m = 0.5$; host uptake capacity $U_{\\text{in}} = 10$; exchange cap $E_{\\max} = 5$.\n- Case $2$: weights $w_h = 0.5$, $w_m = 0.5$; $U_{\\text{in}} = 10$; $E_{\\max} = 0$.\n- Case $3$: weights $w_h = 0$, $w_m = 1$; $U_{\\text{in}} = 10$; $E_{\\max} = 5$.\n- Case $4$: weights $w_h = 0.2$, $w_m = 0.8$; $U_{\\text{in}} = 3$; $E_{\\max} = 100$.\n\nYour program should set up the combined linear program for each case as follows. Let the full decision vector be $x = [v_h; v_m; v_e] \\in \\mathbb{R}^{8}$, with $v_h \\in \\mathbb{R}^{4}$, $v_m \\in \\mathbb{R}^{3}$, and $v_e \\in \\mathbb{R}^{1}$. Construct equality constraints\n$$\nA_{\\text{eq}} x = b_{\\text{eq}},\n$$\nby embedding $S_h v_h = 0$ and $S_m v_m = 0$ into $A_{\\text{eq}}$ with appropriate zero-padding, and adding two rows for $v_e - v_{h,4} = 0$ and $v_e - v_{m,1} = 0$. Bounds on $x$ are formed by concatenating the host bounds, microbe bounds, and the exchange bound $0 \\le v_e \\le E_{\\max}$. The objective vector for the maximization is\n$$\nc^\\top x = w_h c_h^\\top v_h + w_m c_m^\\top v_m + 0 \\cdot v_e,\n$$\nwhich you should implement as a minimization by negating $c$.\n\nRequired output format:\n- Compute the optimal objective value $w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}$ for each case, expressed in $\\mathrm{mmol\\ gDW^{-1}\\ h^{-1}}$, rounded to six decimal places.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4]$, where each $\\alpha_i$ is the float for the corresponding case in the order listed above.",
            "solution": "The problem statement has been critically examined and is deemed valid. It presents a well-posed, scientifically grounded, and computationally tractable problem in community Flux Balance Analysis (FBA), a standard methodology in computational systems biology. All required data, parameters, and constraints are provided, allowing for a unique optimal objective value to be determined for each test case.\n\nThe task is to solve a linear programming (LP) problem that models the metabolic coupling between a host and a microbe. The objective is to maximize a weighted sum of their respective biomass fluxes under steady-state conditions. The problem is formulated as follows:\n$$\n\\max_{v_h, v_m, v_e}\\quad w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}\n$$\nsubject to a set of linear equality and inequality constraints. This maximization problem can be solved using standard LP solvers, which typically perform minimization. We can achieve this by minimizing the negative of the objective function:\n$$\n\\min_{v_h, v_m, v_e}\\quad -(w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}})\n$$\nTo implement this, we first construct a single linear system representing the combined host-microbe community. The full vector of decision variables, $x$, is formed by concatenating the individual flux vectors:\n$$\nx = \\begin{bmatrix} v_h \\\\ v_m \\\\ v_e \\end{bmatrix} = [v_{h,1}, v_{h,2}, v_{h,3}, v_{h,4}, v_{m,1}, v_{m,2}, v_{m,3}, v_e]^\\top \\in \\mathbb{R}^8\n$$\nThe components of $x$ correspond to the $4$ host reaction fluxes ($v_h$), $3$ microbe reaction fluxes ($v_m$), and $1$ exchange flux ($v_e$).\n\nThe objective function to maximize is $Z = w_h v_{h,3} + w_m v_{m,3}$. In terms of the vector $x$, this is $c_{orig}^\\top x$ where $c_{orig} = [0, 0, w_h, 0, 0, 0, w_m, 0]^\\top$. For minimization, we use the objective vector $c = -c_{orig} = [0, 0, -w_h, 0, 0, 0, -w_m, 0]^\\top$.\n\nThe constraints are of two types: equality constraints and bounds. The equality constraints $A_{eq} x = b_{eq}$ enforce mass balance and coupling.\nThe steady-state mass balance conditions are $S_h v_h = 0$ for the host and $S_m v_m = 0$ for the microbe. These equations are embedded into the larger system.\nGiven $S_h = \\begin{bmatrix} 1  -1  0  0\\\\ 0  1  -1  -1 \\end{bmatrix}$ and $S_m = \\begin{bmatrix} 1  -1  0\\\\ 0  1  -1 \\end{bmatrix}$, these correspond to:\n$1 \\cdot v_{h,1} - 1 \\cdot v_{h,2} = 0$\n$1 \\cdot v_{h,2} - 1 \\cdot v_{h,3} - 1 \\cdot v_{h,4} = 0$\n$1 \\cdot v_{m,1} - 1 \\cdot v_{m,2} = 0$\n$1 \\cdot v_{m,2} - 1 \\cdot v_{m,3} = 0$\n\nThe exchange coupling constraints are $v_e = v_{h,4}$ and $v_e = v_{m,1}$. In the standard form for a linear solver, these are written as:\n$-v_{h,4} + v_e = 0$\n$-v_{m,1} + v_e = 0$\n\nCombining these $6$ equations gives the equality constraint matrix $A_{eq} \\in \\mathbb{R}^{6 \\times 8}$ and the vector $b_{eq} \\in \\mathbb{R}^{6}$. Since all equations are homogeneous, $b_{eq}$ is a zero vector.\n$$\nA_{eq} = \\begin{bmatrix}\n1  -1  0  0  0  0  0  0 \\\\\n0  1  -1  -1  0  0  0  0 \\\\\n0  0  0  0  1  -1  0  0 \\\\\n0  0  0  0  0  1  -1  0 \\\\\n0  0  0  -1  0  0  0  1 \\\\\n0  0  0  0  -1  0  0  1\n\\end{bmatrix}, \\quad\nb_{eq} = \\begin{bmatrix}\n0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{bmatrix}\n$$\nThe bounds for each flux variable $x_i$ are specified as $l_i \\le x_i \\le u_i$. These are assembled from the individual bounds on $v_h$, $v_m$, and $v_e$. For each test case, the bounds are:\n$v_{h,1} \\in [0, U_{\\text{in}}]$\n$v_{h,2} \\in [0, 10]$\n$v_{h,3} \\in [0, 10]$\n$v_{h,4} \\in [0, 10]$\n$v_{m,1} \\in [0, 10]$\n$v_{m,2} \\in [0, 10]$\n$v_{m,3} \\in [0, 10]$\n$v_e \\in [0, E_{\\max}]$\nThese form a list of (lower bound, upper bound) tuples for the solver.\n\nFor each test case, we substitute the given values for $w_h$, $w_m$, $U_{\\text{in}}$, and $E_{\\max}$ to define the specific LP instance. The problem is then solved using the `linprog` function from the `scipy.optimize` library. The returned optimal value from the minimization, `res.fun`, is negated to obtain the maximum value for the original objective function. This value is then rounded to six decimal places as required.",
            "answer": "[5.000000,5.000000,5.000000,2.400000]"
        }
    ]
}