{
    "hands_on_practices": [
        {
            "introduction": "Understanding how a population will evolve often comes down to identifying which strategy has the largest basin of attraction. This first exercise provides a foundational link between the population dynamics described by the replicator equation and the game-theoretic concept of risk dominance. By analyzing a simple two-strategy coordination game, you will derive from first principles how the evolutionary dynamics naturally select for the risk-dominant equilibrium, providing a powerful intuition for predicting evolutionary outcomes .",
            "id": "3307090",
            "problem": "Consider a well-mixed microbial population in computational systems biology where cells adopt one of two signaling strategies, denoted by $A$ and $B$. Interactions are pairwise and symmetric, and the payoff to a focal cell depends only on the focal and partner strategies according to the following payoff matrix for the focal cell:\n$$\n\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix},\n$$\nwhere $a$, $b$, $c$, and $d$ are real constants representing interaction payoffs. Assume a coordination regime with two pure-strategy equilibria, meaning $a>c$ and $d>b$. Let $x \\in [0,1]$ denote the population fraction using strategy $A$.\n\nFitness is an affine function of payoff under weak selection: for selection intensity $w \\in (0,1)$, the fitness of a cell using strategy $i \\in \\{A,B\\}$ is $f_{i}(x) = 1 - w + w\\,\\pi_{i}(x)$, where $\\pi_{A}(x) = a x + b (1-x)$ and $\\pi_{B}(x) = c x + d (1-x)$. The population dynamics follow the replicator equation $\\dot{x} = x\\,(f_{A}(x) - \\bar{f}(x))$, where $\\bar{f}(x)$ is the average fitness in the population.\n\nStarting from these definitions and assumptions, derive from first principles the analytic expression for the fraction of initial population states $x(0) \\in [0,1]$ (drawn uniformly at random) that converge to the $A$-monomorphic equilibrium under the replicator dynamics in the weak selection limit $w \\to 0^{+}$. Express your final answer purely in terms of $a$, $b$, $c$, and $d$ as a closed-form expression. No intermediate formulas should be stated in the answer. No rounding is required, and no units are to be included in the expression. In your derivation, justify why the weak selection limit identifies the equilibrium with the larger basin of attraction and explain, in terms of the basin boundary, how this connects to risk-dominance in a symmetric $2 \\times 2$ coordination game without directly invoking pre-formed selection criteria.",
            "solution": "The problem asks for the fraction of initial population states that converge to the A-monomorphic equilibrium under replicator dynamics in a symmetric $2 \\times 2$ coordination game. This fraction corresponds to the normalized size of the basin of attraction of the equilibrium where the population consists entirely of strategy A users.\n\nFirst, we formalize the replicator equation based on the provided definitions. The population state is given by $x$, the fraction of individuals using strategy A, where $x \\in [0,1]$. The dynamics are described by $\\dot{x} = x(f_{A}(x) - \\bar{f}(x))$, where $f_{A}(x)$ is the fitness of strategy A users and $\\bar{f}(x)$ is the average fitness in the population.\n\nThe average fitness is defined as $\\bar{f}(x) = x f_{A}(x) + (1-x) f_{B}(x)$. Substituting this into the replicator equation yields:\n$$\n\\dot{x} = x(f_{A}(x) - [x f_{A}(x) + (1-x) f_{B}(x)])\n$$\n$$\n\\dot{x} = x( (1-x)f_{A}(x) - (1-x)f_{B}(x) )\n$$\n$$\n\\dot{x} = x(1-x)(f_{A}(x) - f_{B}(x))\n$$\nThis form of the replicator equation shows that the change in the fraction $x$ is proportional to the difference in fitness between the two strategies.\n\nThe fitness functions are given as $f_{i}(x) = 1 - w + w\\,\\pi_{i}(x)$, where $w \\in (0,1)$ is the selection intensity. The difference in fitness is:\n$$\nf_{A}(x) - f_{B}(x) = (1 - w + w\\,\\pi_{A}(x)) - (1 - w + w\\,\\pi_{B}(x)) = w(\\pi_{A}(x) - \\pi_{B}(x))\n$$\nThe expected payoffs $\\pi_A(x)$ and $\\pi_B(x)$ are:\n$$\n\\pi_{A}(x) = a x + b (1-x)\n$$\n$$\n\\pi_{B}(x) = c x + d (1-x)\n$$\nThe difference in expected payoffs is:\n$$\n\\pi_{A}(x) - \\pi_{B}(x) = (ax + b(1-x)) - (cx + d(1-x)) = (a-c)x - (d-b)(1-x) = (a-c+d-b)x - (d-b)\n$$\nSubstituting this back into the replicator equation gives the full dynamic equation for $x$:\n$$\n\\dot{x} = w x(1-x)[(a-c+d-b)x - (d-b)]\n$$\nThe fixed points of the dynamics are the values of $x$ for which $\\dot{x}=0$. From the equation, we can identify three such points:\n1.  $x^* = 0$, the B-monomorphic equilibrium.\n2.  $x^* = 1$, the A-monomorphic equilibrium.\n3.  An interior fixed point, $x_{int}$, where the term in square brackets is zero:\n    $$\n    (a-c+d-b)x_{int} - (d-b) = 0\n    $$\n    Solving for $x_{int}$ yields:\n    $$\n    x_{int} = \\frac{d-b}{a-c+d-b}\n    $$\nThe problem states that we are in a coordination regime where $a>c$ and $d>b$. These conditions ensure that $x_{int}$ lies strictly between $0$ and $1$. The numerator $d-b$ is positive, and the denominator $(a-c)+(d-b)$ is also positive. Thus, $x_{int} > 0$. Also, $d-b < (a-c)+(d-b)$ since $a-c > 0$, which implies $x_{int} < 1$.\n\nNext, we analyze the stability of these fixed points to determine the basins of attraction. The sign of $\\dot{x}$ for $x \\in (0,1)$ is determined by the sign of the polynomial $P(x) = (a-c+d-b)x - (d-b)$. This is a linear function of $x$ with a positive slope (since $a-c+d-b > 0$) and a root at $x=x_{int}$.\n- For $x \\in (0, x_{int})$, we have $P(x) < 0$, which means $\\dot{x} < 0$. Trajectories starting in this interval will move towards $x=0$.\n- For $x \\in (x_{int}, 1)$, we have $P(x) > 0$, which means $\\dot{x} > 0$. Trajectories starting in this interval will move towards $x=1$.\n\nThis analysis shows that the monomorphic equilibria $x^*=0$ and $x^*=1$ are stable fixed points (attractors), while the interior fixed point $x_{int}$ is unstable (a repellor). The point $x_{int}$ acts as a separatrix, dividing the state space $[0,1]$ into two basins of attraction.\n- The basin of attraction for the B-monomorphic equilibrium ($x^*=0$) is the interval $[0, x_{int})$.\n- The basin of attraction for the A-monomorphic equilibrium ($x^*=1$) is the interval $(x_{int}, 1]$.\n\nThe problem asks for the fraction of initial states $x(0)$, drawn uniformly at random from $[0,1]$, that converge to the A-monomorphic equilibrium. This is equivalent to the Lebesgue measure (length) of the basin of attraction for $x^*=1$, since the total interval has length $1$.\nThe length of the attraction basin for $x^*=1$ is:\n$$\n\\text{Length}((x_{int}, 1]) = 1 - x_{int}\n$$\nSubstituting the expression for $x_{int}$:\n$$\n1 - x_{int} = 1 - \\frac{d-b}{a-c+d-b} = \\frac{(a-c+d-b) - (d-b)}{a-c+d-b} = \\frac{a-c}{a-c+d-b}\n$$\nThis expression depends only on the payoff parameters $a, b, c, d$ and is independent of the selection intensity $w$. Therefore, taking the weak selection limit $w \\to 0^{+}$ has no effect on the result, as the geometric structure of the phase space is determined by the payoff matrix, provided $w>0$. The role of the weak selection assumption $f_i = 1-w+w\\pi_i$ is to ensure that the evolutionary dynamics directly reflect the payoff structure of the underlying game, making the interior fixed point of the dynamics identical to the mixed-strategy Nash equilibrium of the game.\n\nFinally, we connect this result to the concept of risk-dominance. In a symmetric $2 \\times 2$ coordination game, strategy A is said to risk-dominate strategy B if the condition $a-c > d-b$ is met. This condition compares the payoff penalties for unilateral deviation from each of the pure-strategy Nash equilibria.\n\nThe basin of attraction for strategy A is larger than that for strategy B if its size, $1-x_{int}$, is greater than $1/2$.\n$$\n1-x_{int} > \\frac{1}{2} \\implies x_{int} < \\frac{1}{2}\n$$\nSubstituting the expression for the basin boundary $x_{int}$:\n$$\n\\frac{d-b}{a-c+d-b} < \\frac{1}{2}\n$$\nSince the denominator is positive, we can multiply both sides by $2(a-c+d-b)$:\n$$\n2(d-b) < a-c+d-b\n$$\n$$\nd-b < a-c\n$$\nThis is precisely the condition for strategy A to be risk-dominant. Therefore, the replicator dynamics predict that the equilibrium corresponding to the risk-dominant strategy will have a larger basin of attraction. The basin boundary $x_{int}$ is the critical threshold; if the initial frequency of a strategy is greater than its proportion in the unstable mixed equilibrium, it will eventually take over the entire population. The risk-dominant equilibrium is the one that can invade from a state of higher uncertainty (i.e., a smaller initial frequency, as long as it is above the threshold $x_{int}$ which is less than $1/2$). This derivation connects the population-level dynamics to the game-theoretic concept of risk-dominance without *a priori* assuming any selection criterion beyond the replicator equation itself.\n\nThe analytic expression for the fraction of initial states converging to the A-monomorphic equilibrium is $\\frac{a-c}{a-c+d-b}$.",
            "answer": "$$\n\\boxed{\\frac{a-c}{a-c+d-b}}\n$$"
        },
        {
            "introduction": "While many evolutionary games converge to a stable equilibrium, some of the most interesting dynamics in nature involve persistent cycles of dominance, as seen in microbial communities and lizard mating strategies. This practice problem moves beyond simple two-strategy games to the classic three-strategy Rock-Paper-Scissors (RPS) model, a canonical example of cyclic dominance. You will perform a stability analysis at the system's interior equilibrium to uncover not a stable point, but neutrally stable orbits, and quantify their frequency .",
            "id": "3307089",
            "problem": "In a computational systems biology model of cyclic dominance among $3$ microbial strains, suppose pairwise interactions are encoded by a fitness game in the sense of evolutionary game theory, with the population composition $x = (x_{1}, x_{2}, x_{3})$ evolving on the unit simplex under the replicator ordinary differential equation (ODE)\n$$\n\\dot{x}_{i} = x_{i} \\left( (A x)_{i} - x^{\\top} A x \\right), \\quad i \\in \\{1,2,3\\},\n$$\nwhere $A \\in \\mathbb{R}^{3 \\times 3}$ is the payoff matrix and $x^{\\top} A x$ denotes the mean fitness. Consider the rock-paper-scissors (RPS) interaction structure with an antisymmetric payoff matrix\n$$\nA = \\begin{pmatrix}\n0 & a & -c \\\\\n-a & 0 & b \\\\\nc & -b & 0\n\\end{pmatrix},\n$$\nwhere $a$, $b$, and $c$ are real parameters that quantify the advantage of one strain over another in cyclic dominance. Assume $a>0$, $b>0$, and $c>0$ so that all three strains can invade one another in cyclic fashion and an interior equilibrium exists.\n\nStarting from the fundamental definition of the replicator ODE and the given antisymmetric structure of $A$, do the following:\n- Derive the interior equilibrium $x^{\\ast}$.\n- Linearize the replicator dynamics at $x^{\\ast}$ and classify the stability of $x^{\\ast}$ in terms of the parameters $a$, $b$, and $c$.\n- Compute the exact angular frequency $\\omega$ of small-amplitude cycles in the neighborhood of $x^{\\ast}$, expressed in closed form as a function of $a$, $b$, and $c$.\n\nProvide the final answer as a single closed-form analytic expression for $\\omega$. No rounding is required and no physical units are needed. If $a$, $b$, or $c$ are zero or negative, explain in words how the classification changes, but your final answer must still be the expression for $\\omega$ under the stated assumption $a>0$, $b>0$, and $c>0$.",
            "solution": "The replicator ordinary differential equation (ODE) for $3$ strategies is\n$$\n\\dot{x}_{i} = x_{i} \\left( (A x)_{i} - x^{\\top} A x \\right), \\quad i \\in \\{1,2,3\\}.\n$$\nWe first exploit the antisymmetry of $A$. Because $A^{\\top} = -A$, for any $x \\in \\mathbb{R}^{3}$ one has\n$$\nx^{\\top} A x = - x^{\\top} A x \\;\\Rightarrow\\; x^{\\top} A x = 0.\n$$\nTherefore, for the antisymmetric rock-paper-scissors (RPS) game, the replicator ODE simplifies to\n$$\n\\dot{x}_{i} = x_{i} (A x)_{i}, \\quad i \\in \\{1,2,3\\}.\n$$\nAn interior equilibrium $x^{\\ast}$ (with $x_{i}^{\\ast} > 0$ and $x_{1}^{\\ast} + x_{2}^{\\ast} + x_{3}^{\\ast} = 1$) must satisfy $(A x^{\\ast})_{i} = 0$ for all $i$, because $x^{\\top} A x \\equiv 0$ and $\\dot{x}_{i} = x_{i} (A x)_{i}$. Thus, $x^{\\ast}$ is in the kernel of $A$:\n$$\nA x^{\\ast} = 0.\n$$\nWith\n$$\nA = \\begin{pmatrix}\n0 & a & -c \\\\\n-a & 0 & b \\\\\nc & -b & 0\n\\end{pmatrix},\n$$\nwrite $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast}, x_{3}^{\\ast})$. The equations $A x^{\\ast} = 0$ are\n$$\na x_{2}^{\\ast} - c x_{3}^{\\ast} = 0, \\quad - a x_{1}^{\\ast} + b x_{3}^{\\ast} = 0, \\quad c x_{1}^{\\ast} - b x_{2}^{\\ast} = 0.\n$$\nThese yield the ratios\n$$\nx_{2}^{\\ast} = \\frac{c}{a} x_{3}^{\\ast}, \\qquad x_{1}^{\\ast} = \\frac{b}{a} x_{3}^{\\ast}.\n$$\nNormalizing to the unit simplex $x_{1}^{\\ast} + x_{2}^{\\ast} + x_{3}^{\\ast} = 1$ gives\n$$\nx^{\\ast} = \\frac{1}{a + b + c} \\left( b,\\, c,\\, a \\right).\n$$\nUnder the assumption $a>0$, $b>0$, and $c>0$, this $x^{\\ast}$ is indeed an interior equilibrium.\n\nTo classify stability, we linearize the dynamics at $x^{\\ast}$. Consider the Jacobian $J$ with entries\n$$\nJ_{ij} = \\left. \\frac{\\partial \\dotx_{i}}{\\partial x_{j}} \\right|_{x = x^{\\ast}}.\n$$\nFrom $\\dot{x}_{i} = x_{i} (A x)_{i}$ and the product rule,\n$$\n\\frac{\\partial \\dot{x}_{i}}{\\partial x_{j}} = \\delta_{ij} (A x)_{i} + x_{i} A_{ij}.\n$$\nAt $x = x^{\\ast}$, $(A x^{\\ast})_{i} = 0$, so the first term vanishes and\n$$\nJ_{ij} = x_{i}^{\\ast} A_{ij}.\n$$\nThus,\n$$\nJ = D A, \\quad \\text{with} \\quad D = \\mathrm{diag}(x_{1}^{\\ast}, x_{2}^{\\ast}, x_{3}^{\\ast}).\n$$\nBecause $A$ is antisymmetric and $D$ is positive diagonal, $J$ has one zero eigenvalue corresponding to the invariant direction associated with the simplex constraint, and the other two eigenvalues are purely imaginary and conjugate. One way to see this and to quantify the oscillation frequency is to compute $\\mathrm{trace}(J^{2})$ and use the identity that if the eigenvalues of $J$ are $\\{0,\\, \\mathrm{i} \\omega,\\, - \\mathrm{i} \\omega\\}$, then\n$$\n\\mathrm{trace}(J^{2}) = 0 + (-\\omega^{2}) + (-\\omega^{2}) = - 2 \\omega^{2}.\n$$\nWe therefore compute $J^{2}$ and its trace. With\n$$\nJ = \\begin{pmatrix}\n0 & x_{1}^{\\ast} a & - x_{1}^{\\ast} c \\\\\n- x_{2}^{\\ast} a & 0 & x_{2}^{\\ast} b \\\\\nx_{3}^{\\ast} c & - x_{3}^{\\ast} b & 0\n\\end{pmatrix},\n$$\nthe diagonal entries of $J^{2}$ are\n$$\n(J^{2})_{11} = J_{12} J_{21} + J_{13} J_{31} = - x_{1}^{\\ast} x_{2}^{\\ast} a^{2} - x_{1}^{\\ast} x_{3}^{\\ast} c^{2},\n$$\n$$\n(J^{2})_{22} = J_{21} J_{12} + J_{23} J_{32} = - x_{1}^{\\ast} x_{2}^{\\ast} a^{2} - x_{2}^{\\ast} x_{3}^{\\ast} b^{2},\n$$\n$$\n(J^{2})_{33} = J_{31} J_{13} + J_{32} J_{23} = - x_{1}^{\\ast} x_{3}^{\\ast} c^{2} - x_{2}^{\\ast} x_{3}^{\\ast} b^{2}.\n$$\nHence,\n$$\n\\mathrm{trace}(J^{2}) = (J^{2})_{11} + (J^{2})_{22} + (J^{2})_{33} = - 2 \\left( x_{1}^{\\ast} x_{2}^{\\ast} a^{2} + x_{1}^{\\ast} x_{3}^{\\ast} c^{2} + x_{2}^{\\ast} x_{3}^{\\ast} b^{2} \\right).\n$$\nEquating to $- 2 \\omega^{2}$ yields\n$$\n\\omega^{2} = x_{1}^{\\ast} x_{2}^{\\ast} a^{2} + x_{1}^{\\ast} x_{3}^{\\ast} c^{2} + x_{2}^{\\ast} x_{3}^{\\ast} b^{2}.\n$$\nSubstituting $x^{\\ast} = \\frac{1}{a + b + c} (b, c, a)$ gives\n$$\nx_{1}^{\\ast} x_{2}^{\\ast} a^{2} = \\frac{b c}{(a + b + c)^{2}} a^{2}, \\quad x_{1}^{\\ast} x_{3}^{\\ast} c^{2} = \\frac{b a}{(a + b + c)^{2}} c^{2}, \\quad x_{2}^{\\ast} x_{3}^{\\ast} b^{2} = \\frac{c a}{(a + b + c)^{2}} b^{2}.\n$$\nTherefore,\n$$\n\\omega^{2} = \\frac{a^{2} b c + b a c^{2} + c a b^{2}}{(a + b + c)^{2}} = \\frac{a b c (a + b + c)}{(a + b + c)^{2}} = \\frac{a b c}{a + b + c},\n$$\nand the angular frequency is\n$$\n\\omega = \\sqrt{\\frac{a b c}{a + b + c}}.\n$$\nThis shows that the interior equilibrium is a neutrally stable center for all $a>0$, $b>0$, and $c>0$, with small-amplitude closed orbits having angular frequency $\\omega$ as above. The neutrality follows from the antisymmetry of $A$, which makes the replicator dynamics conservative in the interior (there exists a constant of motion), yielding purely imaginary eigenvalues about $x^{\\ast}$.\n\nRegarding classification if $a$, $b$, or $c$ are zero or negative:\n- If any of $a$, $b$, or $c$ is zero, the cyclic dominance is broken along one edge, the matrix $A$ becomes rank-deficient with reduced dynamics that typically have a line of fixed points or neutrally stable edges; the interior equilibrium either collides with the boundary or ceases to exist.\n- If any of $a$, $b$, or $c$ is negative while the others are positive, then the corresponding $x^{\\ast}$ component determined by $(b, c, a)/(a + b + c)$ will not be strictly positive, and no interior equilibrium exists; dynamics are confined to faces and edges with heteroclinic behavior potentially emerging.\nUnder the stated assumption $a>0$, $b>0$, and $c>0$, the interior equilibrium exists and is neutrally stable, with the exact angular frequency given above.",
            "answer": "$$\\boxed{\\sqrt{\\frac{a b c}{a + b + c}}}$$"
        },
        {
            "introduction": "The replicator equation is a powerful tool, but its assumption of an infinite population overlooks the crucial role of random chance, or genetic drift, in finite populations. This hands-on computational exercise bridges this fundamental gap between deterministic theory and stochastic reality. You will derive a formal mapping between the continuous-time replicator dynamics and the discrete-generation, stochastic Wright-Fisher model, and then implement a simulation to test when the idealized model serves as a good approximation of the more realistic finite-population process .",
            "id": "3307058",
            "problem": "You are asked to formalize and test a principled mapping from continuous-time replicator dynamics to a discrete-generation Wright-Fisher (WF) selection model in a two-strategy game within the domain of computational systems biology. Your solution must be a complete, runnable program that evaluates whether the mapping preserves trajectories under specified regimes.\n\nFundamental base to use:\n- Replicator dynamics for two strategies: For a population with frequency $x$ of strategy $A$ and $1 - x$ of strategy $B$, with expected payoffs $f_A(x)$ and $f_B(x)$ determined by a $2 \\times 2$ payoff matrix $\\Pi = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$, the continuous-time replicator equation is\n$$\n\\frac{dx}{dt} = x \\left(f_A(x) - \\bar f(x)\\right) = x(1-x)\\left(f_A(x) - f_B(x)\\right),\n$$\nwhere $f_A(x) = a x + b (1-x)$, $f_B(x) = c x + d (1-x)$, and $\\bar f(x) = x f_A(x) + (1-x) f_B(x)$.\n- Wright-Fisher selection with haploid genotypes in a population of effective size $N_e$ (effective population size): At discrete generation $k$, with frequency $x_k$ of strategy $A$, selection produces sampling probabilities proportional to fitnesses, and the next generation count of $A$ is binomially distributed. Under weak selection, use fitness parametrization $w_A(x) = 1 + s f_A(x)$ and $w_B(x) = 1 + s f_B(x)$, with selection coefficient $s$ and $s$ small. The conditional sampling probability of an $A$ individual is $p(x) = \\frac{x w_A(x)}{x w_A(x) + (1-x) w_B(x)}$.\n\nTasks:\n1. Using only the fundamental base above, perform a principled derivation to determine a mapping between the replicator time step and the Wright-Fisher selection coefficient that aligns one discrete WF generation with an infinitesimal replicator time step. You must not assume any pre-derived mapping; instead, work from the definitions.\n2. Implement a program that, for each test case below, does the following:\n   - Integrate the replicator dynamics ordinary differential equation (ODE) from $t=0$ to $t = G \\cdot s$, where $G$ is the number of discrete WF generations, and record the solution at times $t_k = k \\cdot s$ for $k \\in \\{0,1,\\dots,G\\}$. Use the $2 \\times 2$ payoff matrix to compute $f_A(x)$ and $f_B(x)$ at the current $x$.\n   - Compute a deterministic WF mean trajectory $\\{x^{\\mathrm{det}}_k\\}_{k=0}^G$ using the recursion $x^{\\mathrm{det}}_{k+1} = p(x^{\\mathrm{det}}_k)$ with $x^{\\mathrm{det}}_0 = x_0$, where $p(x)$ is defined above.\n   - Compute a stochastic WF ensemble-mean trajectory $\\{x^{\\mathrm{stoch}}_k\\}_{k=0}^G$ by simulating $R$ independent WF replicates with effective population size $N_e$, each updated as $X^{(r)}_{k+1} \\sim \\mathrm{Binomial}\\left(N_e, p\\left(X^{(r)}_k\\right)\\right)/N_e$, with $X^{(r)}_0 = x_0$ for each replicate $r \\in \\{1,\\dots,R\\}$, and then averaging across replicates at each generation to get $x^{\\mathrm{stoch}}_k = \\frac{1}{R}\\sum_{r=1}^R X^{(r)}_k$. Use a fixed pseudorandom seed for reproducibility.\n   - Quantify the discrepancy between the replicator trajectory $\\{x^{\\mathrm{rep}}(t_k)\\}$ and each of the two WF trajectories using the root-mean-square (RMS) error,\n     $$\n     \\mathrm{RMS}_{\\mathrm{det}} = \\sqrt{\\frac{1}{G+1} \\sum_{k=0}^G \\left( x^{\\mathrm{rep}}(t_k) - x^{\\mathrm{det}}_k \\right)^2}, \\quad\n     \\mathrm{RMS}_{\\mathrm{stoch}} = \\sqrt{\\frac{1}{G+1} \\sum_{k=0}^G \\left( x^{\\mathrm{rep}}(t_k) - x^{\\mathrm{stoch}}_k \\right)^2 }.\n     $$\n   - For each test case, return a boolean indicating whether both $\\mathrm{RMS}_{\\mathrm{det}}$ and $\\mathrm{RMS}_{\\mathrm{stoch}}$ are below their respective tolerances $\\varepsilon_{\\mathrm{det}}$ and $\\varepsilon_{\\mathrm{stoch}}$.\n3. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,False,True]\").\n\nAngle units are not applicable. No answer involves physical units. All numeric thresholds and parameters must be treated as pure numbers.\n\nUse the following test suite. Each test case is a tuple:\n- $\\left([a,b;c,d], \\, x_0, \\, s, \\, N_e, \\, G, \\, R, \\, \\varepsilon_{\\mathrm{det}}, \\, \\varepsilon_{\\mathrm{stoch}}\\right)$\n\nProvide exactly the five cases below, in this order:\n1. $\\left([\\,3.0,\\,2.0;\\,1.0,\\,0.0\\,], \\, 0.2, \\, 0.01, \\, 5000, \\, 40, \\, 200, \\, 0.005, \\, 0.01\\right)$\n2. $\\left([\\,3.0,\\,0.0;\\,2.0,\\,1.0\\,], \\, 0.6, \\, 0.005, \\, 4000, \\, 60, \\, 200, \\, 0.004, \\, 0.01\\right)$\n3. $\\left([\\,3.0,\\,0.0;\\,2.0,\\,1.0\\,], \\, 0.6, \\, 0.25, \\, 5000, \\, 20, \\, 200, \\, 0.004, \\, 0.01\\right)$\n4. $\\left([\\,3.0,\\,0.0;\\,2.0,\\,1.0\\,], \\, 0.6, \\, 0.01, \\, 50, \\, 80, \\, 30, \\, 0.005, \\, 0.007\\right)$\n5. $\\left([\\,1.0,\\,1.0;\\,1.0,\\,1.0\\,], \\, 0.37, \\, 0.2, \\, 1000, \\, 50, \\, 200, \\, 1.0\\times 10^{-6}, \\, 0.003\\right)$\n\nYour program must implement the mapping you derived between the continuous-time replicator dynamics and the discrete Wright-Fisher process, and it must decide, for each case, whether the mapping preserves trajectories according to the specified thresholds. The final output must be exactly a single line with a Python list of five booleans in order, with no additional text.",
            "solution": "The problem is assessed as valid. It is scientifically grounded in the established principles of evolutionary game theory, specifically replicator dynamics and the Wright-Fisher model of population genetics. The problem is well-posed, providing all necessary definitions, equations, and parameters to perform the requested derivation, simulation, and analysis. Its language is objective and the tasks are formalizable and computationally tractable.\n\nThe solution proceeds in two main parts: first, a principled derivation of the mapping between the continuous-time and discrete-time models, and second, an algorithmic implementation to numerically test this mapping.\n\n**1. Derivation of the Time-Step Mapping**\n\nThe objective is to establish a formal correspondence between one discrete generation of the Wright-Fisher (WF) selection model and an infinitesimal time step in the continuous-time replicator dynamics.\n\nThe continuous-time replicator equation for a population with strategy frequencies $x$ (for strategy A) and $1-x$ (for strategy B) is given by:\n$$\n\\frac{dx}{dt} = x(1-x) \\left( f_A(x) - f_B(x) \\right)\n$$\nwhere $f_A(x)$ and $f_B(x)$ are the expected payoffs to strategies A and B, respectively, derived from the payoff matrix $\\Pi = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$. Specifically, $f_A(x) = a x + b (1-x)$ and $f_B(x) = c x + d (1-x)$.\n\nThe Wright-Fisher model describes the change in frequency over discrete generations. The expected frequency of strategy A in generation $k+1$, denoted $x_{k+1}$, is determined by the frequency $x_k$ in generation $k$ and the relative fitness of the strategies. Using the provided fitness parameterization for weak selection ($s \\ll 1$), the fitnesses are $w_A(x) = 1 + s f_A(x)$ and $w_B(x) = 1 + s f_B(x)$. The conditional probability of sampling an individual with strategy A, given the population frequency is $x_k$, is:\n$$\np(x_k) = \\frac{x_k w_A(x_k)}{x_k w_A(x_k) + (1-x_k) w_B(x_k)}\n$$\nThis is the expected frequency in the next generation, i.e., $x^{\\mathrm{det}}_{k+1} = p(x_k)$. The change in frequency over one generation, $\\Delta x_k$, is:\n$$\n\\Delta x_k = x_{k+1} - x_k = p(x_k) - x_k = \\frac{x_k w_A(x_k)}{x_k w_A(x_k) + (1-x_k) w_B(x_k)} - x_k\n$$\nLet $\\bar w(x_k) = x_k w_A(x_k) + (1-x_k) w_B(x_k)$ be the mean fitness of the population.\n$$\n\\Delta x_k = \\frac{x_k w_A - x_k \\bar w}{\\bar w} = \\frac{x_k w_A - x_k (x_k w_A + (1-x_k) w_B)}{\\bar w} = \\frac{x_k(1-x_k)w_A - x_k(1-x_k)w_B}{\\bar w} = \\frac{x_k(1-x_k)(w_A - w_B)}{\\bar w}\n$$\nNow, we substitute the fitness definitions:\n$$\nw_A(x_k) - w_B(x_k) = (1 + s f_A(x_k)) - (1 + s f_B(x_k)) = s (f_A(x_k) - f_B(x_k))\n$$\nThe mean fitness is:\n$$\n\\bar w(x_k) = x_k (1+sf_A(x_k)) + (1-x_k)(1+sf_B(x_k)) = 1 + s(x_k f_A(x_k) + (1-x_k)f_B(x_k)) = 1 + s \\bar f(x_k)\n$$\nwhere $\\bar f(x_k)$ is the mean payoff. Substituting these into the expression for $\\Delta x_k$:\n$$\n\\Delta x_k = \\frac{x_k(1-x_k) s (f_A(x_k) - f_B(x_k))}{1 + s \\bar f(x_k)}\n$$\nTo connect this discrete change to the continuous differential equation, we consider the limit of weak selection, where the selection coefficient $s$ is very small ($s \\to 0$). In this limit, the denominator $1 + s \\bar f(x_k) \\approx 1$. Thus, the change per generation becomes:\n$$\n\\Delta x_k \\approx s \\cdot x_k(1-x_k) (f_A(x_k) - f_B(x_k))\n$$\nWe can view the continuous replicator equation as the limit of a discrete process where the time step $\\Delta t$ goes to zero, i.e., $\\frac{dx}{dt} = \\lim_{\\Delta t \\to 0} \\frac{\\Delta x}{\\Delta t}$. If we equate one WF generation with a time step of duration $\\Delta t$, we have:\n$$\n\\frac{\\Delta x_k}{\\Delta t} \\approx \\frac{s \\cdot x_k(1-x_k) (f_A(x_k) - f_B(x_k))}{\\Delta t}\n$$\nFor this to be consistent with the replicator equation $\\frac{dx}{dt} = x(1-x)(f_A(x) - f_B(x))$, we must have:\n$$\n\\frac{s}{\\Delta t} \\approx 1 \\implies \\Delta t \\approx s\n$$\nTherefore, one discrete generation in the WF model corresponds to a time interval of $\\Delta t = s$ in the continuous replicator dynamics. Consequently, the state of the WF process after $k$ generations should be compared to the solution of the replicator ODE at time $t_k = k \\cdot s$. The total simulation time for $G$ generations is $T = G \\cdot s$. This derived mapping is central to the implementation.\n\n**2. Algorithmic Implementation**\n\nThe program implements three parallel simulations for each test case, based on the derived mapping.\n\n**Replicator Trajectory:** The continuous-time replicator ODE is solved numerically.\n- The ODE function implements $\\frac{dx}{dt} = x(1-x)((a-c)x + (b-d)(1-x))$.\n- We use `scipy.integrate.solve_ivp`, a robust adaptive step-size ODE solver, to integrate from $t=0$ to $t_{final} = G \\cdot s$.\n- The argument `t_eval` is set to `np.linspace(0, G*s, G+1)` to ensure the solution is evaluated at times $t_k = k \\cdot s$ for $k \\in \\{0, 1, \\dots, G\\}$. This yields the trajectory $\\{x^{\\mathrm{rep}}(t_k)\\}$.\n\n**Deterministic WF Trajectory:** A deterministic trajectory is computed using the exact mean-field update rule.\n- Starting with $x^{\\mathrm{det}}_0 = x_0$, the trajectory $\\{x^{\\mathrm{det}}_k\\}$ is generated via the recursion $x^{\\mathrm{det}}_{k+1} = p(x^{\\mathrm{det}}_k)$ for $k \\in \\{0, \\dots, G-1\\}$.\n- The function $p(x)$ is calculated using the full, unapproximated formula for the next-generation frequency: $p(x) = \\frac{x(1+sf_A(x))}{x(1+sf_A(x))+(1-x)(1+sf_B(x))}$.\n- This simulation serves as a test of the weak selection approximation used in the derivation, as the error between this trajectory and the replicator path is expected to increase with $s$.\n\n**Stochastic WF Trajectory:** An ensemble of stochastic simulations is run to account for genetic drift.\n- For reproducibility, a pseudorandom number generator is initialized with a fixed seed.\n- $R$ independent replicates are simulated. For each replicate $r$ and generation $k$, starting with $X_0^{(r)} = x_0$, the number of strategy A individuals in the next generation is drawn from a binomial distribution: $N_{A, k+1}^{(r)} \\sim \\mathrm{Binomial}(N_e, p(X_k^{(r)}))$. The frequency is updated to $X_{k+1}^{(r)} = N_{A, k+1}^{(r)} / N_e$.\n- The ensemble-mean trajectory $\\{x^{\\mathrm{stoch}}_k\\}$ is computed by averaging the frequencies of all $R$ replicates at each generation $k$: $x^{\\mathrm{stoch}}_k = \\frac{1}{R} \\sum_{r=1}^R X_k^{(r)}$. This trajectory is expected to approximate the replicator path when $N_e$ and $R$ are large.\n\n**Discrepancy and Evaluation:**\nFor each test case, the Root-Mean-Square (RMS) error is calculated to quantify the discrepancy between the continuous replicator trajectory $\\{x^{\\mathrm{rep}}(t_k)\\}$ and the two discrete WF trajectories, $\\{x^{\\mathrm{det}}_k\\}$ and $\\{x^{\\mathrm{stoch}}_k\\}$.\n$$\n\\mathrm{RMS}_{\\mathrm{det}} = \\sqrt{\\frac{1}{G+1} \\sum_{k=0}^G \\left( x^{\\mathrm{rep}}(t_k) - x^{\\mathrm{det}}_k \\right)^2}\n$$\n$$\n\\mathrm{RMS}_{\\mathrm{stoch}} = \\sqrt{\\frac{1}{G+1} \\sum_{k=0}^G \\left( x^{\\mathrm{rep}}(t_k) - x^{\\mathrm{stoch}}_k \\right)^2}\n$$\nA test case is considered successful if both $\\mathrm{RMS}_{\\mathrm{det}} < \\varepsilon_{\\mathrm{det}}$ and $\\mathrm{RMS}_{\\mathrm{stoch}} < \\varepsilon_{\\mathrm{stoch}}$, where $\\varepsilon_{\\mathrm{det}}$ and $\\varepsilon_{\\mathrm{stoch}}$ are the given tolerances. The final output is a list of boolean values indicating success or failure for each case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef run_one_case(payoff_matrix, x0, s, Ne, G, R, eps_det, eps_stoch):\n    \"\"\"\n    Runs a single test case comparing replicator dynamics with a Wright-Fisher model.\n    \"\"\"\n    # Unpack payoff matrix\n    Pi = np.array(payoff_matrix)\n    a, b, c, d = Pi.flatten()\n\n    # Define payoff functions based on the payoff matrix\n    def fA(x):\n        return a * x + b * (1.0 - x)\n\n    def fB(x):\n        return c * x + d * (1.0 - x)\n\n    # 1. Replicator Dynamics Integration\n    def replicator_ode(t, y):\n        x = y[0]\n        # dx/dt = x(1-x)(fA(x) - fB(x))\n        # Handle boundary cases to prevent numerical issues if x goes slightly out of [0, 1]\n        if x <= 0.0 or x >= 1.0:\n            return 0.0\n        return x * (1.0 - x) * (fA(x) - fB(x))\n\n    t_final = G * s\n    t_eval_points = np.linspace(0, t_final, G + 1)\n    \n    sol = solve_ivp(\n        replicator_ode,\n        [0.0, t_final],\n        [x0],\n        t_eval=t_eval_points,\n        method='RK45'\n    )\n    x_rep = sol.y[0]\n\n    # Define the discrete update function for WF model\n    def get_p(x_k):\n        # Handle boundary cases\n        if x_k <= 0.0: return 0.0\n        if x_k >= 1.0: return 1.0\n        \n        # Fitnesses\n        wA = 1.0 + s * fA(x_k)\n        wB = 1.0 + s * fB(x_k)\n        \n        # Average fitness\n        w_bar = x_k * wA + (1.0 - x_k) * wB\n        if w_bar <= 0.0:\n            return x_k\n        \n        return (x_k * wA) / w_bar\n\n    # 2. Deterministic Wright-Fisher Trajectory\n    x_det = np.zeros(G + 1)\n    x_det[0] = x0\n    \n    for k in range(G):\n        x_det[k+1] = get_p(x_det[k])\n\n    # 3. Stochastic Wright-Fisher Trajectory\n    # Use a fixed seed for reproducibility as requested.\n    rng = np.random.default_rng(seed=42)\n    \n    X_stoch_replicates = np.zeros((R, G + 1))\n    X_stoch_replicates[:, 0] = x0\n    \n    for r in range(R):\n        for k in range(G):\n            current_x = X_stoch_replicates[r, k]\n            p_k = get_p(current_x)\n            num_A_next = rng.binomial(Ne, p_k)\n            X_stoch_replicates[r, k+1] = num_A_next / float(Ne)\n\n    x_stoch = np.mean(X_stoch_replicates, axis=0)\n\n    # 4. Quantify Discrepancy (RMS Error)\n    rms_det = np.sqrt(np.mean((x_rep - x_det)**2))\n    rms_stoch = np.sqrt(np.mean((x_rep - x_stoch)**2))\n\n    # 5. Return Boolean Decision\n    return (rms_det < eps_det) and (rms_stoch < eps_stoch)\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Payoff_matrix, x0, s, Ne, G, R, eps_det, eps_stoch)\n        ([[3.0, 2.0], [1.0, 0.0]], 0.2, 0.01, 5000, 40, 200, 0.005, 0.01),\n        ([[3.0, 0.0], [2.0, 1.0]], 0.6, 0.005, 4000, 60, 200, 0.004, 0.01),\n        ([[3.0, 0.0], [2.0, 1.0]], 0.6, 0.25, 5000, 20, 200, 0.004, 0.01),\n        ([[3.0, 0.0], [2.0, 1.0]], 0.6, 0.01, 50, 80, 30, 0.005, 0.007),\n        ([[1.0, 1.0], [1.0, 1.0]], 0.37, 0.2, 1000, 50, 200, 1.0e-6, 0.003),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_one_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}