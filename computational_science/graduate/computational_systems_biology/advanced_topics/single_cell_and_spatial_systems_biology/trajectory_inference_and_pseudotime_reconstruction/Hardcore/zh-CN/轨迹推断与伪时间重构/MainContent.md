## 引言
[单细胞测序](@entry_id:198847)技术的革命性进展使我们能够以前所未有的分辨率捕捉到复杂生物组织中每个细胞的分子快照。然而，这些静态的快照本身无法揭示生命过程的动态本质，例如细胞如何从一个共同的祖先分化为多种功能各异的类型，或者细胞如何响应外界刺激而改变其状态。为了克服这一挑战，[计算生物学](@entry_id:146988)领域发展出了一套强大的分析[范式](@entry_id:161181)——[轨迹推断](@entry_id:176370)（Trajectory Inference）与[伪时间重构](@entry_id:753855)（Pseudotime Reconstruction）。这些方法旨在通过计算手段，将离散的单细胞数据点在数学上重新[排列](@entry_id:136432)，构建出能够反映潜在生物学过程（如分化、发育或重编程）的连续性轨迹。

本文旨在系统性地剖析[轨迹推断](@entry_id:176370)与[伪时间重构](@entry_id:753855)的理论与实践。我们将回答一系列核心问题：这些方法背后的核心假设是什么？它们如何将高维、嘈杂的单细胞数据转化为清晰的发育路径？我们如何利用这些推断出的轨迹来解读复杂的生物学调控逻辑？文章将分为三个章节，引领读者逐步深入这一领域。第一章“原理与机制”将奠定理论基础，深入探讨将细胞数据构建为连续[流形](@entry_id:153038)的数学原理、伪时间的定义，以及主流算法的设计思想与内在联系。第二章“应用与跨学科连接”将展示[轨迹推断](@entry_id:176370)如何作为假设生成和检验的引擎，在[发育生物学](@entry_id:141862)、系统生物学等领域发挥关键作用，并揭示其与物理学、数学等基础学科的深刻联系。最后，第三章“动手实践”将通过一系列精心设计的计算练习，帮助读者将理论知识转化为解决实际问题的能力。现在，让我们从[轨迹推断](@entry_id:176370)的基石——其核心原理与计算机制——开始我们的探索。

## 原理与机制

本章旨在深入探讨[轨迹推断](@entry_id:176370)与[伪时间重构](@entry_id:753855)的核心科学原理和计算机制。继前一章对该领域的背景和意义进行介绍之后，我们将从基本概念出发，系统性地构建一个理解细胞动态过程如何从高维单细胞数据中被揭示的理论框架。我们将阐述“[伪时间](@entry_id:262363)”的数学定义，探索其在生物物理学中的根基，并详细分析将离散的细胞数据点连接成连续发展轨迹的计算策略。此外，本章还将剖析用于学习和表示这些轨迹的主要算法家族，并讨论在真实世界数据分析中遇到的关键挑战，如确定发育方向、处理复杂分叉拓扑以及校正技术混杂因素等。

### 概念基础：从细胞状态到发育[流形](@entry_id:153038)

[轨迹推断](@entry_id:176370)的核心思想是**[流形假设](@entry_id:275135)**（manifold hypothesis）。该假设提出，尽管单个细胞的基因表达谱存在于一个数以万计的维度（基因）构成的极高维空间 $\mathbb{R}^p$ 中，但由一个连续生物学过程（如分化、重编程或刺激响应）产生的所有细胞状态，实际上仅局限于该高维空间中的一个低维内在[流形](@entry_id:153038) $\mathcal{M}$ 上或其附近。这个[流形](@entry_id:153038)捕捉了系统允许的动态演化路径。

#### 形式化[伪时间](@entry_id:262363)

在这一框架下，**[伪时间](@entry_id:262363)**（pseudotime）被定义为衡量细胞沿此发育[流形](@entry_id:153038)进展程度的量度。重要的是，伪时间并非真实世界中的**时序时间**（chronological time）。考虑一个由常微分方程 $\dot{x} = F(x)$ 描述的细胞状态[演化动力](@entry_id:273961)学系统，其解的轨迹为 $\gamma(t)$，其中 $t$ 是时序时间。生物发育的速度，即 $\lVert\dot{\gamma}(t)\rVert$，通常不是恒定的；细胞在某些阶段可能快速分化，而在其他阶段则可能停滞或缓慢变化。伪时间旨在捕捉沿着轨迹 $\gamma$ 的“距离”或“进程”，而非流逝的物理时间 $t$。

一个严谨的定义是，伪时间是沿发育[流形](@entry_id:153038)的一维路径的**[弧长](@entry_id:191173)**的任意严格递增的重参数化。设想一条由 $C^1$ 嵌入 $\phi: [0,1] \to \mathbb{R}^p$ 描绘的光滑[一维流](@entry_id:269448)形 $M = \phi([0,1])$，其[弧长](@entry_id:191173)参数为 $s$。那么，任何形式为 $\tau = h \circ s$ 的函数都是一个有效的[伪时间](@entry_id:262363)，其中 $h: \mathbb{R} \to \mathbb{R}$ 是一个严格递增函数。这意味着[伪时间](@entry_id:262363)并非唯一的，而是代表了一个等价类。所有属于这个等价类的函数都能正确地为细胞排序，但它们各自的“刻度”或“尺度”可能不同 。从根本上说，[伪时间](@entry_id:262363)捕捉的是细胞间的相对顺序，而非绝对的时间间隔。这也解释了为什么在没有额外假设（例如，关于动力学速度）的情况下，我们只能确定细胞的顺序，而无法确定发育过程的“公制计时” 。

[伪时间](@entry_id:262363)也不同于一个通用的**潜变量**。例如，[主成分分析](@entry_id:145395)（PCA）得到的主成分是旨在最大化数据[方差](@entry_id:200758)的潜变量，但当发育[流形](@entry_id:153038)高度弯曲时，线性投影可能无法保持细胞的正确顺序。伪时间作为一个概念，必须忠实于[流形](@entry_id:153038)内在的一维拓扑和顺序 。

#### 生物物理动机：瓦丁顿[表观遗传景观](@entry_id:139786)

[流形假设](@entry_id:275135)并非纯粹的数学抽象，它与发育生物学的经典概念——**瓦丁顿的[表观遗传景观](@entry_id:139786)**（Waddington's epigenetic landscape）——紧密相连。我们可以将细胞状态 $x$ 的演化想象成一个“小球”在一个由势能函数 $U(x)$ 定义的景观上滚动。在随机扰动的驱动下，细胞状态的动力学可以用一个[过阻尼](@entry_id:167953)的朗之万型随机微分方程（SDE）来描述：

$$
\dot{x}(t) = -\nabla U(x(t)) + \sqrt{2D}\,\eta(t)
$$

其中 $D$ 是一个[扩散](@entry_id:141445)系数，$\eta(t)$ 是[高斯白噪声](@entry_id:749762)。在这个模型中，景观的“山谷”代表稳定的细胞类型（[吸引子](@entry_id:275077)），而“山脊”则代表分化决策的障碍。

在满足**[细致平衡](@entry_id:145988)**（detailed balance）条件（即不存在净概率流）的系统中，其[稳态](@entry_id:182458)细胞密度[分布](@entry_id:182848) $p^\star(x)$ 与[势能](@entry_id:748988)景观 $U(x)$ 直接相关，遵循[玻尔兹曼分布](@entry_id:142765)的关系：$p^\star(x) \propto \exp(-U(x)/D)$。这意味着我们可以通过观测到的细胞密度来反推潜在的[势能](@entry_id:748988)景观：$U(x) = -D\ln p^\star(x) + \text{const}$。高细胞密度区域对应于[势能](@entry_id:748988)景观的低点（山谷）。在一个吸引盆内部，从高[势能](@entry_id:748988)的“祖细胞”状态向低势能的“成熟”状态的演化路径，在低噪声极限下，主要由确定性梯度流 $\dot{x}=-\nabla U(x)$ 决定。沿着这条路径，势能 $U(x)$ 是单调递减的。因此，通过将细胞按 $U(x)$ 的降序[排列](@entry_id:136432)，可以构建一个与生物学进程一致的[伪时间](@entry_id:262363)坐标 。这个理论为通过分析细胞密度[分布](@entry_id:182848)来推断发育方向和伪时间提供了坚实的物理基础。

### 构建细胞状态[流形](@entry_id:153038)：从数据到图

由于真实的低维[流形](@entry_id:153038) $\mathcal{M}$ 是未知的，我们需要从观测到的数据点 $\\{x_i\\}_{i=1}^n$ 中对其进行近似。标准的做法是构建一个**邻域图**（neighborhood graph），例如 **$k$-近邻（k-NN）图**。在这个图中，每个细胞是一个节点，如果一个细胞是另一个细胞的 $k$ 个最近邻居之一，则在它们之间连接一条边。这个图被视为[流形](@entry_id:153038)的一个离散化表示，后续的伪时间计算都将在这个图结构上进行。

#### 定义邻近性：度量与归一化

构建邻域图的第一步，也是至关重要的一步，是选择一个合适的**度量**（metric）来量化细胞间的“距离”或“相似性”。不同的选择会极大地影响图的拓扑结构。常用的度量包括：

*   **欧氏距离**（Euclidean distance）：$d_{\mathrm{Euc}}(x,y) = \sqrt{\sum_{g=1}^p (x_g - y_g)^2}$。它对基因表达值的绝对差异敏感。
*   **余[弦距离](@entry_id:170189)**（Cosine distance）：$d_{\mathrm{cos}}(x,y) = 1 - \frac{x^\top y}{\|x\|_2 \|y\|_2}$。它衡量两个细胞表达谱向量之间的夹角，对基因表达的相对丰度模式敏感，而不受细胞总表达量（文库大小）的缩放影响。
*   **[相关距离](@entry_id:634939)**（Correlation distance）：$d_{\mathrm{corr}}(x,y) = 1 - \mathrm{corr}(x,y)$。它基于[皮尔逊相关系数](@entry_id:270276)，不仅对缩放不敏感，还对每个细胞表达谱的平移（均值中心化）不敏感。

选择哪种度量与数据**[预处理](@entry_id:141204)**策略密切相关。例如，[单细胞RNA测序](@entry_id:142269)数据中，不同细胞的总RNA捕获量（**文库大小**）差异很大，这是一个需要校正的技术偏差。如果使用欧氏距离，文库大小的差异会主导距离计算，使得两个生物学上相似但文库大小不同的细胞看起来相距很远。

一种常见的策略是进行**文库大小归一化**，例如将每个细胞的表达向量缩放至单位 $\ell_1$ 范数。经过这种正向标量缩放后，细胞间的余[弦距离](@entry_id:170189)和[相关距离](@entry_id:634939)保持不变，但欧氏距离会发生改变。因此，使用余弦或[相关距离](@entry_id:634939)构建的[kNN图](@entry_id:751051)对于这种归一化是不变的 。

在实践中，一个鲁棒的工作流程通常涉及对原始计数进行对数转换，然后进行文库大小归一化或将其作为[协变](@entry_id:634097)量回归掉。之后，在降维后的空间中计算距离（通常是欧氏距离），此时主要的技术偏差已经被移除。

#### [测地线](@entry_id:269969)理想与[最短路径](@entry_id:157568)近似

理论上，两个细胞之间的理想伪时间是它们在未知[流形](@entry_id:153038) $\mathcal{M}$ 上的**[测地线](@entry_id:269969)距离**（geodesic distance）——即连接两点最短的[流形](@entry_id:153038)内路径的长度。由于 $\mathcal{M}$ 未知，我们通过计算它们在k-NN图上的**[最短路径距离](@entry_id:754797)**来进行近似。

这一近似的有效性基于一个关键假设：在足够近的距离上，[流形](@entry_id:153038)上的[测地线](@entry_id:269969)距离约等于高维空间中的欧氏距离。因此，一条由图上的短边[串联](@entry_id:141009)而成的路径，其总长度（各边欧氏距离之和）可以很好地逼近[流形](@entry_id:153038)上的长路径的[测地线](@entry_id:269969)长度。

该近似的收敛性是有理论保证的。在密集采样（$n \to \infty$）且 $k$ 被适当地选择（使得邻域半径趋于零，同时图保持连通）的条件下，使用欧氏距离作为边权重的图[最短路径距离](@entry_id:754797)会收敛到真实的[流形](@entry_id:153038)[测地线](@entry_id:269969)距离 。

#### 一个主要陷阱：捷径偏差

然而，这种近似方法存在一个严重的隐患，即**捷径偏差**（shortcut bias）。当[流形](@entry_id:153038)发生弯曲或折叠，使得在[流形](@entry_id:153038)上相距很远的两部分在嵌入的[欧氏空间](@entry_id:138052)中彼此靠近时，k-NN图可能会在它们之间错误地添加一条“捷径”边。如果算法在计算最短路径时使用了这条边，将会得到一个远小于真实[测地线](@entry_id:269969)距离的值，从而系统性地**低估**伪时间。

捷径偏差的风险与参数 $k$ 的选择直接相关。**增加 $k$ 会增大捷径偏差的风险**，因为更大的邻域更容易跨越[流形](@entry_id:153038)的不同部分。反之，减小 $k$ 会使连接更具局部性，从而减少捷径，但过小的 $k$ 可能导致图断裂成多个不连通的部分。此外，边权重的选择也至关重要。例如，若错误地使用相似性度量（如高斯核相似度 $K_\epsilon(\cdot)$）作为[最短路径算法](@entry_id:634863)的“成本”，那么距离很远的捷径边（欧氏距离大）将获得接近于零的成本，而沿[流形](@entry_id:153038)的正确路径由许多成本接近于1的短边构成，这将极大地加剧捷径偏差 。

### 用于[轨迹推断](@entry_id:176370)的降维与[流形学习](@entry_id:156668)

直接在高维基因空间中构建图并计算距离，不仅计算成本高，而且容易受到噪声的影响。因此，大多数现代[轨迹推断](@entry_id:176370)方法首先将数据嵌入到一个低维空间，旨在更好地揭示[流形](@entry_id:153038)的内在几何结构。

#### 方法比较分析

*   **[主成分分析](@entry_id:145395) (PCA)**：PCA 是一种线性方法，它通过寻找最大化数据[方差](@entry_id:200758)的投影方向来降维。虽然它在探索数据主导变异来源时很有用，但对于[非线性](@entry_id:637147)、弯曲的轨迹，PCA的线性投影可能会扭曲[流形](@entry_id:153038)结构，无法准确反映细胞的真实邻近关系。

*   **[拉普拉斯特征图](@entry_id:635562) (Laplacian Eigenmaps, LE)**：LE 是一种[非线性](@entry_id:637147)的、基于图的[流形学习](@entry_id:156668)方法。其核心目标是最小化图的**[狄利克雷能量](@entry_id:276589)**（Dirichlet energy）$E(\mathbf{Y}) = \frac{1}{2}\sum_{i,j} W_{ij}\|\mathbf{y}_i - \mathbf{y}_j\|^2$，其中 $W_{ij}$ 是细胞 $i$ 和 $j$ 之间的亲和力（相似度），$\mathbf{y}_i$ 是细胞 $i$ 在低维空间中的新坐标。这个[目标函数](@entry_id:267263)旨在将图中紧密连接的细胞在低维嵌入中也保持靠近。该[优化问题](@entry_id:266749)的解由图拉普拉斯算子 $L=D-W$ 的[广义特征向量](@entry_id:152349)给出 ($L \mathbf{y} = \lambda D \mathbf{y}$，其中 $D$ 是度矩阵)。

*   **[扩散图](@entry_id:748414) (Diffusion Maps, DM)**：DM 采用一种概率性的视角。它构建一个马尔可夫[转移矩阵](@entry_id:145510) $P = D^{-1} W$，描述了在细胞[状态图](@entry_id:176069)上进行[随机游走](@entry_id:142620)的概率。DM 的嵌入坐标由 $P$ 的主要[特征向量](@entry_id:151813)给出。通过引入**扩散时间** $t$，DM 可以有效地对数据进行[去噪](@entry_id:165626)：$P^t$ 描述了经过 $t$ 步[随机游走](@entry_id:142620)后的转移概率，随着 $t$ 的增加，高频的噪声和微小结构被平滑掉，只有[流形](@entry_id:153038)的宏观几何结构被保留下来。两个细胞间的**[扩散](@entry_id:141445)距离** $D_t(i,j)$ 衡量了在 $t$ 步后，从它们出发的[随机游走概率](@entry_id:269354)[分布](@entry_id:182848)的差异。DM嵌入的一个优美特性是，细胞在[扩散图](@entry_id:748414)[嵌入空间](@entry_id:637157)中的欧氏距离等于它们之间的[扩散](@entry_id:141445)距离。

#### 深层联系：[图拉普拉斯算子](@entry_id:275190)与密度效应

这些看似不同的方法在**谱图理论**的框架下是统一的。LE 和 DM 的解都与[图拉普拉斯算子](@entry_id:275190)的不同变体相关：
*   未归一化的拉普拉斯算子: $L = D - W$
*   对称归一化的拉普拉斯算子: $L_{\mathrm{sym}} = I - D^{-1/2} W D^{-1/2}$
*   [随机游走](@entry_id:142620)归一化的拉普拉斯算子: $L_{\mathrm{rw}} = I - D^{-1} W = I - P$

在[流形](@entry_id:153038)极限下（即细胞数量极大，图精细地逼近连续[流形](@entry_id:153038)），这些离散的算子会收敛到[流形](@entry_id:153038)上的连续[微分算子](@entry_id:140145)。值得注意的是，除非进行特定校正，否则这些算子会受到细胞**采样密度不均匀**的影响。例如，[随机游走](@entry_id:142620)[拉普拉斯算子](@entry_id:146319) $L_{\mathrm{rw}}$ 的[连续极限](@entry_id:162780)包含一个由密度梯度引起的“漂移项”。这意味着，在细胞密集的区域，[随机游走](@entry_id:142620)会倾向于“停滞”，从而扭曲对[伪时间](@entry_id:262363)的估计。

DM 的一个强大之处在于它提供了一种机制来校正这种密度效应。通过对亲和力矩阵进行一种称为 $\alpha$-归一化的调整（当 $\alpha=1$ 时），可以使得其对应的[连续算子](@entry_id:143297)恰好是[流形](@entry_id:153038)上的**[拉普拉斯-贝尔特拉米算子](@entry_id:267002)**（Laplace-Beltrami operator），这是一个纯粹依赖于[流形](@entry_id:153038)几何而与采样密度无关的算子。这使得基于这种校正的[扩散图](@entry_id:748414)方法对于不均匀的细胞密度具有更强的鲁棒性 。

### 高级主题与实践挑战

在掌握了基本原理和核心算法之后，我们转向[轨迹推断](@entry_id:176370)中的一些高级概念和必须解决的实际问题。

#### 在图上定义[伪时间](@entry_id:262363)：[扩散伪时间](@entry_id:748419) (DPT)

**[扩散伪时间](@entry_id:748419)（Diffusion Pseudotime, DPT）** 是一个具体的、基于[扩散图](@entry_id:748414)框架的伪时间定义。在选定一个“根细胞”（即轨迹的起点）$r$ 后，任何其他细胞 $i$ 的 DPT 被定义为从 $r$ 开始的[随机游走](@entry_id:142620)**首次到达** $i$ 的**[平均击中时间](@entry_id:275600)**（mean first hitting time），即 $T_{\mathrm{DPT}}(i; r) = \mathbb{E}_r[\tau_i]$。在[可逆马尔可夫链](@entry_id:198392)的设定下，这个量可以通过[扩散算子](@entry_id:136699) $P$ 的[基本矩阵](@entry_id:275638)（格林算子）精确计算。这个定义将伪时间与图上的[随机过程](@entry_id:159502)直接联系起来，提供了一种全局的、对噪声鲁棒的[排序方法](@entry_id:180385) 。

#### 确定[方向性](@entry_id:266095)：为轨迹寻根

一个无向的图结构或[流形](@entry_id:153038)本身并不能告诉我们发育的方向。为了使伪时间与生物学进程（例如，从祖细胞到终端细胞）的方向一致，必须进行**寻根**（rooting）。这需要引入额外的生物学知识或假设。主要的寻根策略包括：

*   **基于实验捕获时间**：如果实验设计涉及时间序列采样，原则上可以假设最早被捕获的细胞是发育的起点。然而，这一策略的正确性依赖于严格的假设：实验捕获时间必须是生物学时间的严格单调增函数，并且采样窗口必须包含真正的祖细胞，同时不能有[批次效应](@entry_id:265859)等技术混杂因素干扰时间对应关系 。
*   **基于标记基因的表达**：如果已知某个基因在所研究的过程中表达是严格单调的（例如，一个[多能性](@entry_id:139300)因子在分化中持续下调），那么可以利用该基因表达的[极值](@entry_id:145933)（最大值或最小值）来确定轨迹的起点。此方法的成功取决于该基因的单调性是否在整个轨迹上都成立，并且其表达不受细胞周期等其他过程的干扰 。
*   **基于计算属性（如熵）**：在分叉轨迹中，细胞的“命运”可以通过其到达不同终端状态的概率来量化。一个多能的祖细胞可以分化为多种命运，其命运[概率分布](@entry_id:146404)较为均匀，因此**香农熵**较高。相反，一个已经确定命运的终端细胞，其命运概率集中于一种，熵较低。因此，在典型的“前向分化”过程中，可以通过寻找**熵最大**的细胞来确定轨迹的根。反之，在“[去分化](@entry_id:162707)”过程中，则应寻找熵最小的细胞 。

#### 建模复杂拓扑：分叉与汇合

生物学过程往往比线性路径更复杂，包含**分叉**（branching，一个祖系分化为多个子系）和**[汇合](@entry_id:148680)**（convergence，多个谱系融合成一个共同的终点）。一个**分叉点**在拓扑上可以被定义为 lineage graph 中度数大于等于3的节点，并且在伪时间上，存在多个从该点出发且伪时间增加的方向 。不同的算法对处理这类复杂拓扑的能力不同：

*   **基于树的方法 (如 MST, Slingshot)**：这类方法显式或隐式地假设轨迹的拓扑结构是一棵**树**（即[无环图](@entry_id:272495)）。例如，通过在[聚类](@entry_id:266727)中心上构建**最小生成树（Minimum Spanning Tree, MST）** 来初始化拓扑。这种方法本质上无法表示包含环路或汇合的结构，因为树的定义排除了这些可能性。
*   **基于图的方法 (如 PAGA)**：像 PAGA（Partition-based Graph Abstraction）这样的方法更为灵活。它首先将细胞划分为不同的群落（partitions），然后在这些群落之间构建一个“抽象图”，图的边表示群落间存在统计上显著的连接性。这个抽象图可以包含环路和不连通的组件，从而能够表示更广泛的拓扑结构，包括分叉和[汇合](@entry_id:148680)。PAGA本身不生成伪时间，而是提供一个宏观的拓扑骨架，以指导下游更精细的路径和[伪时间](@entry_id:262363)推断 。

#### 处理不期望的变异：混杂因素

真实的单细胞数据总是受到各种技术和生物学**混杂因素**（confounders）的影响，这些因素会掩盖我们感兴趣的发育轨迹。常见的混杂因素包括：

*   **[批次效应](@entry_id:265859)**（Batch effects）：来自不同实验批次、供体或技术平台的数据通常存在系统性差异。
*   **[细胞周期](@entry_id:140664)**（Cell cycle）：细胞增殖是一个强烈的生物学信号，但如果研究目标是分化，它就成为需要移除的混杂因素。
*   **[测序深度](@entry_id:178191)**（Library size）：如前述，这是一个主要的技术变异源。

若不加以处理，这些混杂因素可能在降维空间中造成虚假的细胞聚集，导致[轨迹推断](@entry_id:176370)完全失败。应对策略包括：

*   **回归**：对于可以量化的混杂因素（如文库大小、[细胞周期](@entry_id:140664)评分），可以在每个基因的表达模型中将其作为[协变](@entry_id:634097)量进行线性回归，然后使用残差进行下游分析。
*   **数据整合**：对于[非线性](@entry_id:637147)的[批次效应](@entry_id:265859)，需要使用专门的数据整合算法。这些算法，如**Harmony**或**Mutual Nearest Neighbors (MNN)**，在低维空间中操作，旨在对齐不同批次中的共同细胞群体，同时保留每个批次内部的生物学差异。选择合适的整合方法至关重要；例如，对于[非线性](@entry_id:637147)的[批次效应](@entry_id:265859)，应使用像Harmony这样的[非线性](@entry_id:637147)方法，而不是像ComBat这样的线性模型 。一个成功的整合流程通常是多步骤的，例如，首先回归掉[细胞周期](@entry_id:140664)和文库大小的影响，然后在PCA空间中使用Harmony来校正[批次效应](@entry_id:265859)，最后在整合后的空间中构建图并推断轨迹。

#### 基本限制：可识别性

最后，我们必须回到一个根本性的理论问题：在何种条件下，从观测到的基因表达数据中恢复潜在的伪时间顺序是可能的？这涉及到**统计可识别性**（statistical identifiability）问题。

理论上，如果存在至少一个**单调标记基因**——即其期望表达值 $f_j(T)$ 是[伪时间](@entry_id:262363) $T$ 的一个[严格单调函数](@entry_id:158442)——那么潜在的顺序就是可恢复的。这样一个基因的存在，为不同时间点的细胞提供了明确的统计排序依据。例如，如果一个基因的表达随时间严格增加，那么观测到更高表达值的细胞就更有可能处于发育的更晚阶段 。

然而，并非所有基因都必须是单调的。即使所有基因的表达模式都是非单调的（例如呈钟形），只要由所有基因组成的**多维表达向量的轨迹** $F(t) = (f_1(t), \dots, f_p(t))$ 在伪时间区间上是**[单射](@entry_id:183792)**的（即轨迹不自相交），那么[伪时间](@entry_id:262363) $T$ 及其顺序就是可识别的。一个单调的基因足以保证这种[单射性](@entry_id:147722)，但多个非单调基因的组合也可以实现。反之，如果轨迹自相交（例如，一个周期性过程），那么不同时间点的细胞可能具有完全相同的表达谱，此时它们的顺序将无法被唯一确定 。