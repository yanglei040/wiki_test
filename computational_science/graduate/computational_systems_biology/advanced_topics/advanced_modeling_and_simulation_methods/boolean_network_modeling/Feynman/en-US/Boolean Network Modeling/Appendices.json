{
    "hands_on_practices": [
        {
            "introduction": "Understanding the long-term behavior of a biological network is a central goal of systems biology. This first exercise walks you through the fundamental process of mapping the entire dynamic landscape of a small Boolean network. By constructing the State Transition Graph and identifying its attractors, you will gain a concrete understanding of how a system's trajectory is determined and how it settles into stable patterns, which can be interpreted as cellular phenotypes or functional states .",
            "id": "3292409",
            "problem": "Consider a deterministic Boolean network (BN) with $3$ nodes representing a simplified gene regulatory module. In a Boolean network (BN), each node $x_{i} \\in \\{0,1\\}$ updates synchronously by applying its Boolean update function $f_{i}$ to the current network state $\\mathbf{x} = (x_{1}, x_{2}, x_{3}) \\in \\{0,1\\}^{3}$. The synchronous update induces a global update map $\\mathbf{f} : \\{0,1\\}^{3} \\to \\{0,1\\}^{3}$ defined by $\\mathbf{f}(\\mathbf{x}) = (f_{1}(\\mathbf{x}), f_{2}(\\mathbf{x}), f_{3}(\\mathbf{x}))$. The State Transition Graph (STG) is the directed graph whose vertices are all $2^{3}$ states and whose edges are the ordered pairs $(\\mathbf{x}, \\mathbf{f}(\\mathbf{x}))$. An attractor is a minimal nonempty set $\\mathcal{A} \\subseteq \\{0,1\\}^{3}$ that is closed under $\\mathbf{f}$; fixed points are attractors of period $1$, and cyclic attractors have period greater than $1$.\n\nYou are given the node update rules\n$$\nf_{1} = x_{2} \\land \\neg x_{3}, \\quad f_{2} = x_{1} \\lor x_{3}, \\quad f_{3} = \\neg x_{1}.\n$$\nTasks:\n- Construct the full transition relation under synchronous updating by computing $\\mathbf{f}(\\mathbf{x})$ for all $2^{3}$ states $\\mathbf{x} \\in \\{0,1\\}^{3}$.\n- Using first principles, verify determinism of trajectories for this synchronous BN by arguing from the definition of the global update map and the STG.\n- Identify all attractors in the STG (including fixed points and cycles). Then, report the total number of distinct attractors.\n\nProvide your final answer as a single integer. No rounding is needed; no units are required.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and self-contained. It presents a standard exercise in the analysis of Boolean networks, a well-established topic in computational systems biology. All required definitions and functions are provided, and there are no contradictions or ambiguities.\n\nThe Boolean network (BN) consists of $3$ nodes, with states $x_1, x_2, x_3 \\in \\{0,1\\}$. The network state is a vector $\\mathbf{x} = (x_1, x_2, x_3) \\in \\{0,1\\}^3$. The synchronous update functions are given as:\n$$\nf_1(\\mathbf{x}) = x_2 \\land \\neg x_3\n$$\n$$\nf_2(\\mathbf{x}) = x_1 \\lor x_3\n$$\n$$\nf_3(\\mathbf{x}) = \\neg x_1\n$$\nwhere we interpret logical TRUE as $1$ and FALSE as $0$. The global update map is $\\mathbf{f}(\\mathbf{x}) = (f_1(\\mathbf{x}), f_2(\\mathbf{x}), f_3(\\mathbf{x}))$.\n\n**Task 1: Construct the full transition relation**\n\nWe compute the next state $\\mathbf{f}(\\mathbf{x})$ for each of the $2^3 = 8$ possible current states $\\mathbf{x}$. The results are compiled into the State Transition Table below.\n\n1.  For $\\mathbf{x} = (0,0,0)$:\n    $f_1 = 0 \\land \\neg 0 = 0 \\land 1 = 0$\n    $f_2 = 0 \\lor 0 = 0$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,0,0) = (0,0,1)$\n\n2.  For $\\mathbf{x} = (0,0,1)$:\n    $f_1 = 0 \\land \\neg 1 = 0 \\land 0 = 0$\n    $f_2 = 0 \\lor 1 = 1$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,0,1) = (0,1,1)$\n\n3.  For $\\mathbf{x} = (0,1,0)$:\n    $f_1 = 1 \\land \\neg 0 = 1 \\land 1 = 1$\n    $f_2 = 0 \\lor 0 = 0$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,1,0) = (1,0,1)$\n\n4.  For $\\mathbf{x} = (0,1,1)$:\n    $f_1 = 1 \\land \\neg 1 = 1 \\land 0 = 0$\n    $f_2 = 0 \\lor 1 = 1$\n    $f_3 = \\neg 0 = 1$\n    $\\mathbf{f}(0,1,1) = (0,1,1)$\n\n5.  For $\\mathbf{x} = (1,0,0)$:\n    $f_1 = 0 \\land \\neg 0 = 0 \\land 1 = 0$\n    $f_2 = 1 \\lor 0 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,0,0) = (0,1,0)$\n\n6.  For $\\mathbf{x} = (1,0,1)$:\n    $f_1 = 0 \\land \\neg 1 = 0 \\land 0 = 0$\n    $f_2 = 1 \\lor 1 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,0,1) = (0,1,0)$\n\n7.  For $\\mathbf{x} = (1,1,0)$:\n    $f_1 = 1 \\land \\neg 0 = 1 \\land 1 = 1$\n    $f_2 = 1 \\lor 0 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,1,0) = (1,1,0)$\n\n8.  For $\\mathbf{x} = (1,1,1)$:\n    $f_1 = 1 \\land \\neg 1 = 1 \\land 0 = 0$\n    $f_2 = 1 \\lor 1 = 1$\n    $f_3 = \\neg 1 = 0$\n    $\\mathbf{f}(1,1,1) = (0,1,0)$\n\nThe full state transition relation is:\n$$(0,0,0) \\to (0,0,1)$$\n$$(0,0,1) \\to (0,1,1)$$\n$$(0,1,0) \\to (1,0,1)$$\n$$(0,1,1) \\to (0,1,1)$$\n$$(1,0,0) \\to (0,1,0)$$\n$$(1,0,1) \\to (0,1,0)$$\n$$(1,1,0) \\to (1,1,0)$$\n$$(1,1,1) \\to (0,1,0)$$\n\n**Task 2: Verify determinism of trajectories**\n\nThe system is deterministic by definition. The global update map $\\mathbf{f}: \\{0,1\\}^3 \\to \\{0,1\\}^3$ is a mathematical function. A core property of a function is that for any given input $\\mathbf{x}$ in its domain, it produces a single, unique output $\\mathbf{f}(\\mathbf{x})$. The State Transition Graph (STG) is constructed with vertices representing the states and directed edges given by $(\\mathbf{x}, \\mathbf{f}(\\mathbf{x}))$. Because $\\mathbf{f}$ is a function, every vertex (state) in the STG has exactly one outgoing edge. A trajectory starting from an initial state $\\mathbf{x}(0)$ is the sequence of states $\\mathbf{x}(t)$ generated by the iterative application of $\\mathbf{f}$, i.e., $\\mathbf{x}(t+1) = \\mathbf{f}(\\mathbf{x}(t))$. Since each step from $\\mathbf{x}(t)$ to $\\mathbf{x}(t+1)$ is uniquely determined, the entire trajectory is uniquely determined by its initial state. This is the definition of a deterministic dynamical system.\n\n**Task 3: Identify all attractors**\n\nAn attractor is a minimal set of states from which the system cannot escape. In a finite deterministic system, all trajectories must lead to an attractor, which will be either a fixed point or a limit cycle. We analyze the state transitions to find these minimal closed sets.\n\nFrom the transition table:\n- We can immediately identify two fixed-point attractors, where $\\mathbf{f}(\\mathbf{x}) = \\mathbf{x}$:\n  - $\\mathbf{f}(0,1,1) = (0,1,1)$. This is a fixed point. Let's call this attractor $\\mathcal{A}_1 = \\{(0,1,1)\\}$.\n  - $\\mathbf{f}(1,1,0) = (1,1,0)$. This is also a fixed point. Let's call this attractor $\\mathcal{A}_2 = \\{(1,1,0)\\}$.\n\n- Next, we trace the trajectories of the remaining states to see where they lead. Let's start with a state not already in an attractor, for example, $(0,1,0)$:\n  - $(0,1,0) \\to (1,0,1)$\n  - Now we trace $(1,0,1)$: $(1,0,1) \\to (0,1,0)$.\n  This forms a 2-cycle: $(0,1,0) \\leftrightarrows (1,0,1)$. This is a cyclic attractor of period $2$. Let's call this attractor $\\mathcal{A}_3 = \\{(0,1,0), (1,0,1)\\}$.\n\n- We must check that all other states lead to one of these three attractors.\n  - $(0,0,0) \\to (0,0,1) \\to (0,1,1)$. This trajectory enters the fixed point $\\mathcal{A}_1$.\n  - $(1,0,0) \\to (0,1,0)$. This trajectory enters the 2-cycle $\\mathcal{A}_3$.\n  - $(1,1,1) \\to (0,1,0)$. This trajectory also enters the 2-cycle $\\mathcal{A}_3$.\n\nAll $8$ states have been accounted for. The state space is partitioned into the basins of attraction of these three attractors. The distinct attractors are:\n1. A fixed point: $\\mathcal{A}_1 = \\{(0,1,1)\\}$\n2. A fixed point: $\\mathcal{A}_2 = \\{(1,1,0)\\}$\n3. A 2-cycle: $\\mathcal{A}_3 = \\{(0,1,0), (1,0,1)\\}$\n\nThe total number of distinct attractors is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "While mapping the entire state space is feasible for small networks, this approach does not scale. A more powerful analysis comes from dissecting the properties of the Boolean functions that govern each node's behavior. This practice focuses on identifying key structural properties like unateness and canalization, which provide crucial clues about the network's stability and information processing capabilities without requiring exhaustive simulation .",
            "id": "3292411",
            "problem": "In computational systems biology, Boolean network modeling represents gene regulatory interactions by nodes with Boolean-valued states and update rules constructed from logical operations. Consider a single-node Boolean update function $f : \\{0,1\\}^{3} \\to \\{0,1\\}$ with inputs $(x_{1},x_{2},x_{3})$ encoding upstream regulators, defined by $f(x_{1},x_{2},x_{3}) = x_{1} \\lor (\\neg x_{2} \\land x_{3})$. Use the following foundational definitions.\n\nA Boolean function $f$ is evaluated on the Boolean lattice $\\{0,1\\}^{n}$ under the product partial order: $(u_{1},\\dots,u_{n}) \\preceq (v_{1},\\dots,v_{n})$ if and only if $u_{i} \\leq v_{i}$ for all $i \\in \\{1,\\dots,n\\}$, where $0 \\leq 1$. A function $f$ is globally monotone nondecreasing if $(u \\preceq v)$ implies $f(u) \\leq f(v)$. A function is unate if, for each variable $x_{i}$, there exists a sign $\\sigma_{i} \\in \\{+1,-1\\}$ such that $f$ is monotone nondecreasing in $x_{i}$ when $\\sigma_{i}=+1$ and monotone nonincreasing in $x_{i}$ when $\\sigma_{i}=-1$, holding all other variables fixed. A variable $x_{i}$ is canalizing if there exists an input value $a \\in \\{0,1\\}$ such that setting $x_{i}=a$ forces $f$ to be equal to a constant $b \\in \\{0,1\\}$ regardless of the values of the remaining inputs; such a pair $(a,b)$ is called a canalizing input and canalized output.\n\nTasks:\n- Compute the truth table values of $f$ for all inputs in canonical lexicographic order $(x_{1},x_{2},x_{3}) \\in \\{0,1\\}^{3}$ from $(0,0,0)$ through $(1,1,1)$, and report the eight outputs as $0$-$1$ values.\n- Determine whether $f$ is globally monotone nondecreasing with respect to the product partial order on $\\{0,1\\}^{3}$.\n- If $f$ is not globally monotone nondecreasing, determine whether $f$ is unate, and provide the unate sign vector $(\\sigma_{1},\\sigma_{2},\\sigma_{3})$ with entries in $\\{+1,-1\\}$ corresponding to $(x_{1},x_{2},x_{3})$.\n- Identify all canalizing variables $x_{i}$ and, for each, all canalizing inputs $(a,b)$.\n\nReport your final answer as a single row matrix using the following encoding:\n- The first eight entries are the truth table outputs of $f$ in the specified input order.\n- The ninth entry $m$ is $1$ if $f$ is globally monotone nondecreasing and $0$ otherwise.\n- The next three entries are the unate sign vector $(s_{1},s_{2},s_{3})$ with $s_{i} \\in \\{-1,0,1\\}$, where $s_{i}=1$ denotes monotone nondecreasing in $x_{i}$, $s_{i}=-1$ denotes monotone nonincreasing in $x_{i}$, and $s_{i}=0$ denotes neither.\n- Append, for each canalizing variable, the triple $(i,a,b)$ encoded as three consecutive numeric entries: the variable index $i \\in \\{1,2,3\\}$, its canalizing input $a \\in \\{0,1\\}$, and the corresponding canalized output $b \\in \\{0,1\\}$. If multiple canalizing variables exist, list their triples in increasing order of $i$.\n\nNo rounding is required. Express all entries as exact integers $0$ or $1$ except for unate signs which may be $-1$.",
            "solution": "The analysis proceeds according to the specified tasks.\n\n**Task 1: Compute the Truth Table**\n\nLet $f(x_{1},x_{2},x_{3}) = x_{1} \\lor (\\neg x_{2} \\land x_{3})$. We evaluate the function for all $2^{3}=8$ possible input vectors $(x_{1},x_{2},x_{3})$ in canonical lexicographic order.\n-   $f(0,0,0) = 0 \\lor (\\neg 0 \\land 0) = 0 \\lor (1 \\land 0) = 0 \\lor 0 = 0$.\n-   $f(0,0,1) = 0 \\lor (\\neg 0 \\land 1) = 0 \\lor (1 \\land 1) = 0 \\lor 1 = 1$.\n-   $f(0,1,0) = 0 \\lor (\\neg 1 \\land 0) = 0 \\lor (0 \\land 0) = 0 \\lor 0 = 0$.\n-   $f(0,1,1) = 0 \\lor (\\neg 1 \\land 1) = 0 \\lor (0 \\land 1) = 0 \\lor 0 = 0$.\n-   $f(1,0,0) = 1 \\lor (\\neg 0 \\land 0) = 1 \\lor (1 \\land 0) = 1 \\lor 0 = 1$.\n-   $f(1,0,1) = 1 \\lor (\\neg 0 \\land 1) = 1 \\lor (1 \\land 1) = 1 \\lor 1 = 1$.\n-   $f(1,1,0) = 1 \\lor (\\neg 1 \\land 0) = 1 \\lor (0 \\land 0) = 1 \\lor 0 = 1$.\n-   $f(1,1,1) = 1 \\lor (\\neg 1 \\land 1) = 1 \\lor (0 \\land 1) = 1 \\lor 0 = 1$.\n\nThe sequence of truth table outputs is $(0, 1, 0, 0, 1, 1, 1, 1)$.\n\n**Task 2: Determine Global Monotonicity**\n\nA function is globally monotone nondecreasing if $u \\preceq v$ implies $f(u) \\leq f(v)$ for all $u, v \\in \\{0,1\\}^{3}$. We test this condition by finding a counterexample. Consider the vectors $u=(0,0,1)$ and $v=(0,1,1)$.\nThe condition $u \\preceq v$ holds because $0 \\leq 0$, $0 \\leq 1$, and $1 \\leq 1$.\nNow we evaluate the function at these points:\n-   $f(u) = f(0,0,1) = 1$.\n-   $f(v) = f(0,1,1) = 0$.\nSince $f(u) = 1$ and $f(v) = 0$, we have $f(u) > f(v)$. This violates the condition $f(u) \\leq f(v)$.\nTherefore, the function $f$ is **not** globally monotone nondecreasing. The corresponding flag $m$ is $0$.\n\n**Task 3: Determine Unateness and Sign Vector**\n\nWe must determine the monotonicity of $f$ with respect to each variable individually, while holding the other variables constant. The sign vector $(s_{1},s_{2},s_{3})$ will be determined, where $s_i=1$ for nondecreasing, $s_i=-1$ for nonincreasing, and $s_i=0$ if neither.\n\n-   **Variable $x_{1}$:** We check if $f(0,x_2,x_3) \\leq f(1,x_2,x_3)$ for all $(x_2,x_3)$.\n    $f(1,x_2,x_3) = 1 \\lor (\\neg x_2 \\land x_3) = 1$. The output is always $1$.\n    $f(0,x_2,x_3) = 0 \\lor (\\neg x_2 \\land x_3) = \\neg x_2 \\land x_3$, which can be $0$ or $1$.\n    Since $f(0,x_2,x_3) \\in \\{0,1\\}$ and $f(1,x_2,x_3)=1$, the condition $f(0,x_2,x_3) \\leq f(1,x_2,x_3)$ is always satisfied. Thus, $f$ is monotone nondecreasing in $x_1$. So, $s_{1}=1$.\n\n-   **Variable $x_{2}$:** We check the relationship between $f(x_1,0,x_3)$ and $f(x_1,1,x_3)$.\n    $f(x_1,0,x_3) = x_1 \\lor (\\neg 0 \\land x_3) = x_1 \\lor x_3$.\n    $f(x_1,1,x_3) = x_1 \\lor (\\neg 1 \\land x_3) = x_1 \\lor 0 = x_1$.\n    We must check if the function is consistently nondecreasing or nonincreasing.\n    Is $f(x_1,0,x_3) \\leq f(x_1,1,x_3)$? This means $x_1 \\lor x_3 \\leq x_1$. This is false when $x_1=0$ and $x_3=1$, giving $1 \\leq 0$. So $f$ is not nondecreasing in $x_2$.\n    Is $f(x_1,0,x_3) \\geq f(x_1,1,x_3)$? This means $x_1 \\lor x_3 \\geq x_1$. This is always true, because if $x_1=1$, the expression is $1 \\geq 1$. If $x_1=0$, the expression is $x_3 \\geq 0$, which is also true for $x_3 \\in \\{0,1\\}$.\n    Since $f(x_1,0,x_3) \\geq f(x_1,1,x_3)$ for all $(x_1, x_3)$, $f$ is monotone nonincreasing in $x_2$. So, $s_{2}=-1$.\n\n-   **Variable $x_{3}$:** We check the relationship between $f(x_1,x_2,0)$ and $f(x_1,x_2,1)$.\n    $f(x_1,x_2,0) = x_1 \\lor (\\neg x_2 \\land 0) = x_1 \\lor 0 = x_1$.\n    $f(x_1,x_2,1) = x_1 \\lor (\\neg x_2 \\land 1) = x_1 \\lor \\neg x_2$.\n    We check for monotonicity. Is $f(x_1,x_2,0) \\leq f(x_1,x_2,1)$? This means $x_1 \\leq x_1 \\lor \\neg x_2$. This is always true, because if $x_1=1$, the expression is $1 \\leq 1$. If $x_1=0$, the expression is $0 \\leq \\neg x_2$, which is also true for $x_2 \\in \\{0,1\\}$.\n    Since $f(x_1,x_2,0) \\leq f(x_1,x_2,1)$ for all $(x_1, x_2)$, $f$ is monotone nondecreasing in $x_3$. So, $s_{3}=1$.\n\nSince a sign exists for each variable, the function is unate. The sign vector is $(s_{1}, s_{2}, s_{3}) = (1, -1, 1)$.\n\n**Task 4: Identify Canalizing Variables**\n\nA variable $x_i$ is canalizing if setting it to a value $a$ makes the function output a constant $b$.\n\n-   **Variable $x_{1}$:**\n    -   Set $x_{1}=0$: $f(0,x_2,x_3) = \\neg x_2 \\land x_3$. This depends on $x_2$ and $x_3$, so it is not constant.\n    -   Set $x_{1}=1$: $f(1,x_2,x_3) = 1 \\lor (\\neg x_2 \\land x_3) = 1$. The output is constant.\n    Thus, $x_1$ is a canalizing variable. The canalizing input is $a=1$ and the canalized output is $b=1$. The triple is $(i,a,b)=(1,1,1)$.\n\n-   **Variable $x_{2}$:**\n    -   Set $x_{2}=0$: $f(x_1,0,x_3) = x_1 \\lor x_3$. This depends on $x_1$ and $x_3$, so it is not constant.\n    -   Set $x_{2}=1$: $f(x_1,1,x_3) = x_1 \\lor 0 = x_1$. This depends on $x_1$, so it is not constant.\n    Thus, $x_2$ is not a canalizing variable.\n\n-   **Variable $x_{3}$:**\n    -   Set $x_{3}=0$: $f(x_1,x_2,0) = x_1 \\lor 0 = x_1$. This depends on $x_1$, so it is not constant.\n    -   Set $x_{3}=1$: $f(x_1,x_2,1) = x_1 \\lor \\neg x_2$. This depends on $x_1$ and $x_2$, so it is not constant.\n    Thus, $x_3$ is not a canalizing variable.\n\nThe only canalizing variable is $x_{1}$, with a single canalizing pair $(a,b) = (1,1)$.\n\n### Final Assembly\n\nThe components of the final answer are:\n-   Truth table outputs: $(0, 1, 0, 0, 1, 1, 1, 1)$.\n-   Global monotonicity flag $m$: $0$.\n-   Unate sign vector $(s_1,s_2,s_3)$: $(1, -1, 1)$.\n-   Canalizing variable triple $(i,a,b)$: $(1, 1, 1)$.\n\nThese are assembled into a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  0  0  1  1  1  1  0  1  -1  1  1  1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from analysis to intervention is a key step in applying computational systems biology. This exercise introduces the concept of network control, where we aim to steer the system towards a desired stable state—such as a healthy cellular phenotype—by pinning a small subset of nodes. You will explore the challenge of finding a minimal control set by comparing an optimal, exhaustive search with a fast, graph-based heuristic, a common trade-off in computational biology .",
            "id": "3292470",
            "problem": "You are given three finite, synchronous, deterministic Boolean networks used in computational systems biology. Each network consists of a finite set of nodes $V=\\{0,1,\\dots,n-1\\}$, a vector of node-update functions $F=(f_0,\\dots,f_{n-1})$ with $f_i:\\{0,1\\}^n\\to\\{0,1\\}$, and a designated target attractor $\\alpha^*\\in\\{0,1\\}^n$ which is a fixed point of the unpinned dynamics. The synchronous update is $x(t+1)=F\\big(x(t)\\big)$ with $x(0)\\in\\{0,1\\}^n$. A pinning control chooses a subset $S\\subseteq V$ and forces $x_i(t)=\\alpha^*_i$ for all $i\\in S$ and all $t\\ge 0$; all other nodes update by their $f_i$ using the current state $x(t)$ that includes the pinned values. We say that a control set $S$ is valid if for every initial state $x(0)\\in\\{0,1\\}^n$ the pinned dynamics converges to the target fixed point $\\alpha^*$ in finite time.\n\nFundamental base for this exercise:\n- A Boolean network is a directed graph on $V$ with edges $j\\to i$ whenever $f_i$ depends on $x_j$; the dynamics are given by $x_i(t+1)=f_i\\big(x(t)\\big)$.\n- A fixed point $\\alpha^*\\in\\{0,1\\}^n$ satisfies $\\alpha^*_i=f_i(\\alpha^*)$ for all $i\\in V$.\n- A feedback vertex set (FVS) is a subset $S\\subseteq V$ that intersects every directed cycle of the dependency graph. Pinning any FVS to target values eliminates all directed cycles and yields a directed acyclic graph; in a directed acyclic graph, synchronous updates propagate information forward, and after at most the length of the longest directed path, the state becomes uniquely determined by the pinned values, hence converges to the fixed point consistent with those pinned values.\n\nYour task is to compute, for each test network below:\n1. An optimal minimal-cardinality control set $S_{\\mathrm{opt}}$ such that pinning $x_S$ to $x_S^*=\\alpha^*_S$ drives the network to $\\alpha^*$ from all initial states. Among all sets of minimal cardinality, choose the lexicographically smallest one when nodes are ordered by their indices.\n2. A heuristic control set $S_{\\mathrm{heu}}$ produced by a greedy feedback vertex set algorithm that repeatedly detects a directed cycle via depth-first search (DFS) and removes the current node where the back-edge is discovered, until the remaining graph is acyclic. The DFS explores nodes and out-edges in increasing index order. The set $S_{\\mathrm{heu}}$ is then pinned to $\\alpha^*$.\n\nYou must verify the validity of a candidate control set $S$ by exhaustive simulation over all initial conditions $x(0)\\in\\{0,1\\}^n$ with synchronous updates under pinning, for a time horizon $T_{\\max}=2^n$, which is sufficient to detect convergence in a finite deterministic Boolean network. A candidate $S$ is valid if and only if every trajectory reaches $\\alpha^*$ within $T_{\\max}$ steps.\n\nFormulate the optimal control problem as an Integer Linear Program (ILP) based on the following principles, without using a solver in your program:\n- Introduce binary decision variables $y_i\\in\\{0,1\\}$ indicating whether node $i$ is pinned ($y_i=1$) or free ($y_i=0$), and, for each initial condition $s\\in\\{0,1\\}^n$ and time $t=0,\\dots,T$, introduce state variables $z_i^{(t,s)}\\in\\{0,1\\}$ that represent $x_i(t)$ along the trajectory initialized at $x(0)=s$. Choose $T$ large enough so that when cycles are eliminated (by the chosen $S$), $T$ bounds the longest directed path length; a safe choice is $T=n$ for a directed acyclic graph on $n$ nodes.\n- For each initial condition $s$, enforce $z_i^{(0,s)}=s_i$.\n- For each node $i$, time $t$ and initial condition $s$, enforce pinning and dynamics via big-$M$ constraints for binary variables:\n  - If $y_i=1$ then $z_i^{(t+1,s)}=\\alpha^*_i$, encoded by\n    $$z_i^{(t+1,s)}-\\alpha^*_i\\le 1-y_i,\\quad \\alpha^*_i-z_i^{(t+1,s)}\\le 1-y_i.$$\n  - If $y_i=0$ then $z_i^{(t+1,s)}=f_i\\big(z^{(t,s)}\\big)$, encoded by\n    $$z_i^{(t+1,s)}-f_i\\big(z^{(t,s)}\\big)\\le y_i,\\quad f_i\\big(z^{(t,s)}\\big)-z_i^{(t+1,s)}\\le y_i.$$\n- Linearize the Boolean functions using standard binary linear constraints:\n  - For $y=\\bigwedge_{j\\in P} x_j$: impose $y\\le x_j$ for all $j\\in P$ and $y\\ge \\sum_{j\\in P} x_j-|P|+1$.\n  - For $y=\\bigvee_{j\\in P} x_j$: impose $y\\ge x_j$ for all $j\\in P$ and $y\\le \\sum_{j\\in P} x_j$.\n  - For $y=\\neg x$: impose $y=1-x$.\n  - For $y=x$: impose $y=x$.\n- Enforce terminal constraints $z_i^{(T,s)}=\\alpha^*_i$ for all $i$ and all initial conditions $s$.\n- Minimize $\\sum_{i=0}^{n-1} y_i$.\n\nAlthough you shall not call an external solver, the optimal solution to the ILP above is exactly the minimal-cardinality valid control set. You will compute it by exhaustive enumeration of subsets $S$ and checking the validity constraint, which is equivalent for the given small test suite.\n\nTest suite specification. For each case, the network is given through explicit node-update formulas and a target fixed point. The dependency graph edge $j\\to i$ exists if and only if $f_i$ depends on $x_j$.\n\n- Case A: Three-node ring with copies. Nodes $V=\\{0,1,2\\}$, synchronous update\n  $$f_0(x)=x_2,\\quad f_1(x)=x_0,\\quad f_2(x)=x_1,$$\n  and target fixed point\n  $$\\alpha^*=(1,1,1).$$\n\n- Case B: Two three-cycles sharing one node. Nodes $V=\\{0,1,2,3,4\\}$, synchronous update\n  $$f_0(x)=x_2\\wedge x_4,\\quad f_1(x)=x_0,\\quad f_2(x)=x_1,\\quad f_3(x)=x_0,\\quad f_4(x)=x_3,$$\n  and target fixed point\n  $$\\alpha^*=(1,1,1,1,1).$$\n  The dependency graph has cycles $0\\to 1\\to 2\\to 0$ and $0\\to 3\\to 4\\to 0$.\n\n- Case C: Directed acyclic graph (no cycles). Nodes $V=\\{0,1,2,3\\}$, synchronous update\n  $$f_0(x)=1,\\quad f_1(x)=\\neg x_0,\\quad f_2(x)=x_0\\wedge x_1,\\quad f_3(x)=x_2,$$\n  and target fixed point\n  $$\\alpha^*=(1,0,0,0).$$\n\nAlgorithmic tasks to implement for each test case:\n- Compute $S_{\\mathrm{opt}}$ by exhaustive search over $S\\subseteq V$, increasing by $|S|$, and verifying validity by simulating all $2^n$ initial conditions under pinning for $T_{\\max}=2^n$ steps.\n- Compute $S_{\\mathrm{heu}}$ by the greedy FVS heuristic described above (DFS cycle detection removing the current node where a back-edge is discovered, exploring nodes and adjacency lists in increasing index order). Pin the nodes in $S_{\\mathrm{heu}}$ to $\\alpha^*$.\n- Verify validity of $S_{\\mathrm{heu}}$ by simulation as above.\n\nFinal output format:\n- Your program must produce a single line containing a list of results, one per test case, where each result is a list\n  $$\\big[|S_{\\mathrm{opt}}|,\\ |S_{\\mathrm{heu}}|,\\ \\text{is\\_equal},\\ S_{\\mathrm{opt}},\\ S_{\\mathrm{heu}}\\big],$$\n  with $|S_{\\mathrm{opt}}|$ and $|S_{\\mathrm{heu}}|$ as integers, $\\text{is\\_equal}$ a boolean indicating whether the sizes are equal, and $S_{\\mathrm{opt}}$ and $S_{\\mathrm{heu}}$ given as sorted lists of $0$-based node indices. The entire line must be printed exactly in a Python list literal format, for example\n  $$\\big[\\,[1,2,\\mathrm{False},[0],[1,3]]\\,\\big].$$\nThere are no physical units, angle units, or percentages in this task. All returned numbers are unitless integers or booleans, and lists of such.",
            "solution": "The solution proceeds by first representing each Boolean network, including its update functions and dependency graph. Then, two distinct algorithms are implemented to find the required control sets: one for the optimal control set ($S_{\\mathrm{opt}}$) and one for the heuristic control set ($S_{\\mathrm{heu}}$).\n\n### 1. Network Representation\nFor each test case, the network is defined by its number of nodes $n$, its vector of update functions $F=(f_0, \\dots, f_{n-1})$, its target fixed point $\\alpha^*$, and its dependency graph. The dependency graph, where an edge $j \\to i$ exists if $f_i$ depends on $x_j$, is pre-computed and stored as an adjacency list.\n\n### 2. Core Function: Validity Check\nA crucial component is the function to verify if a candidate control set $S$ is valid. A set $S$ is valid if, for all $2^n$ possible initial states, the network dynamics, under pinning of the nodes in $S$ to their corresponding values in $\\alpha^*$, converge to the target state $\\alpha^*$.\n\nThe verification proceeds as follows:\n- For each of the $2^n$ initial states $x(0) \\in \\{0, 1\\}^n$:\n  - Simulate the pinned network dynamics synchronously for a maximum of $T_{\\max} = 2^n$ steps. The state at step $t+1$ is computed from the state at step $t$ as:\n    $$\n    x_i(t+1) = \\begin{cases} \\alpha^*_i  \\text{if } i \\in S \\\\ f_i(x(t))  \\text{if } i \\notin S \\end{cases}\n    $$\n  - If the state $x(t)$ becomes equal to $\\alpha^*$ at any time $t \\le T_{\\max}$, the trajectory from this initial condition is successful.\n  - If any trajectory fails to reach $\\alpha^*$ within $T_{\\max}$ steps, the set $S$ is deemed invalid.\n- If all $2^n$ trajectories converge to $\\alpha^*$, the set $S$ is valid.\n\n### 3. Optimal Control Set ($S_{\\mathrm{opt}}$)\nThe optimal control set $S_{\\mathrm{opt}}$ is the valid control set with the minimum possible number of nodes. Among all sets of this minimal size, we select the one that is lexicographically smallest. This is found via an exhaustive search:\n1. Iterate through possible set sizes $k$, starting from $k=0$ up to $n$.\n2. For each size $k$, generate all possible subsets $S \\subseteq V$ of cardinality $k$ in lexicographical order.\n3. For each generated subset $S$, check its validity using the simulation method described above.\n4. The first valid set found is guaranteed to be $S_{\\mathrm{opt}}$.\n\n### 4. Heuristic Control Set ($S_{\\mathrm{heu}}$)\nThe heuristic control set $S_{\\mathrm{heu}}$ is determined by applying a greedy algorithm to find a Feedback Vertex Set (FVS) of the network's dependency graph. The specific algorithm is as follows:\n1. Initialize $S_{\\mathrm{heu}}$ as an empty set.\n2. Repeatedly search for a directed cycle in the current graph (the original graph minus nodes already in $S_{\\mathrm{heu}}$) using a Depth-First Search (DFS). The DFS traversal prioritizes nodes with smaller indices first, and for each node, explores its outgoing edges in increasing order of the neighbor's index.\n3. When a back-edge is found (from a node `u` to an ancestor `v`), a cycle is detected. The node `u` is added to $S_{\\mathrm{heu}}$.\n4. This process continues until a full DFS traversal of the remaining graph reveals no more cycles.\n5. The resulting set $S_{\\mathrm{heu}}$ is the heuristic FVS.\n\nFor each test case, the sizes and contents of $S_{\\mathrm{opt}}$ and $S_{\\mathrm{heu}}$ are collected and formatted into the required output structure.",
            "answer": "```\n[[1,1,True,[0],[2]],[1,2,False,[0],[2,4]],[0,0,True,[],[]]]\n```"
        }
    ]
}