{
    "hands_on_practices": [
        {
            "introduction": "在粒子滤波的实际应用中，观测数据的似然值在不同粒子之间可能存在几个数量级的差异。这带来了严峻的数值计算挑战，因为直接的权重乘法很容易导致浮点数下溢。本练习 () 将演示标准的解决方案：传递对数权重，并使用数值稳定的 log-sum-exp 技巧进行归一化。这是任何稳健的序贯蒙特卡洛（SMC）实现都必须掌握的基础技术。",
            "id": "3347782",
            "problem": "考虑一个细胞群体中单个基因转录活性的隐状态模型，其中离散时间 $t$ 的潜在启动子活性 $x_t$ 根据马尔可夫过程演化，观测读数 $y_t$ 是由标准观测模型（例如，泊松或负二项模型）生成的计数，其似然 $p(y_t \\mid x_t)$ 在不同潜在状态下可能跨越多个数量级变化。在先验即提议分布设置下的序贯蒙特卡洛（SMC）粒子滤波器中，$N$ 个粒子 $\\{x_t^{(i)}\\}_{i=1}^{N}$ 向前传播，未归一化的权重通过观测似然进行乘法更新。为了在存在极端似然比的情况下保持数值稳定性，我们传播对数权重 $\\ell_t^{(i)}$，并使用指数和的对数进行稳定归一化。\n\n从粒子滤波的原理出发，定义对数权重，并说明如何仅使用加法、减法和差分的指数运算来稳定地执行归一化。然后，将此方法应用于以下模仿计算系统生物学中SMC更新的简单示例，其中有 $N=4$ 个粒子。假设先前的归一化权重是均匀的，即对于 $i \\in \\{1,2,3,4\\}$，$w_{t-1}^{(i)} = 1/4$，并假设在时间 $t$ 由新观测值 $y_t$ 引起的增量对数似然贡献为\n$$\\delta_1 = -300,\\quad \\delta_2 = -0.1,\\quad \\delta_3 = 0,\\quad \\delta_4 = -200.$$\n使用对数权重传播和数值稳定的log-sum-exp归一化方法，计算 $i \\in \\{1,2,3,4\\}$ 的归一化权重 $w_t^{(i)}$，并将权重向量以指数函数表示的单个闭式解析表达式的形式报告。无需四舍五入；请用 $\\exp(\\cdot)$ 的函数精确表达最终答案。",
            "solution": "该问题要求推导序贯蒙特卡洛（SMC）方法中使用的数值稳定的对数权重更新和归一化过程，并将其应用于一个具体的数值示例。该问题陈述已通过验证，并被认为是有效的。\n\n首先，我们详细说明粒子滤波器中权重更新的原理。设一组 $N$ 个粒子 $\\{x_{t-1}^{(i)}, w_{t-1}^{(i)}\\}_{i=1}^{N}$ 代表时间 $t-1$ 时潜在状态的后验分布，其中 $w_{t-1}^{(i)}$ 是归一化权重，满足 $\\sum_{i=1}^{N} w_{t-1}^{(i)} = 1$。在采用先验即提议分布的标准SMC算法中，每个粒子的状态根据系统动力学进行传播：$x_t^{(i)} \\sim p(x_t | x_{t-1}^{(i)})$。\n\n在接收到新观测值 $y_t$ 后，每个粒子的重要性权重被更新。时间 $t$ 的未归一化权重，记为 $\\tilde{w}_t^{(i)}$，是前一个权重与给定粒子新状态下的观测似然的乘积：\n$$ \\tilde{w}_t^{(i)} = w_{t-1}^{(i)} \\cdot p(y_t | x_t^{(i)}) $$\n然后将权重归一化，使其总和为1：\n$$ w_t^{(i)} = \\frac{\\tilde{w}_t^{(i)}}{\\sum_{j=1}^{N} \\tilde{w}_t^{(j)}} $$\n在许多应用中，包括本题描述的应用，似然值 $p(y_t | x_t^{(i)})$ 可能极小，如果直接计算权重，会导致数值下溢。为规避此问题，计算在对数域中进行。\n\n令 $\\ell_t^{(i)} = \\ln(w_t^{(i)})$ 为对数权重。未归一化对数权重 $\\tilde{\\ell}_t^{(i)} = \\ln(\\tilde{w}_t^{(i)})$ 的更新变为加法运算：\n$$ \\tilde{\\ell}_t^{(i)} = \\ln(w_{t-1}^{(i)}) + \\ln(p(y_t | x_t^{(i)})) $$\n这可以写成 $\\tilde{\\ell}_t^{(i)} = \\ell_{t-1}^{(i)} + \\delta_t^{(i)}$，其中 $\\ell_{t-1}^{(i)}$ 是上一步的归一化对数权重，$\\delta_t^{(i)} = \\ln(p(y_t | x_t^{(i)}))$ 是增量对数似然贡献。\n\n为获得归一化权重 $w_t^{(i)}$，我们必须计算：\n$$ w_t^{(i)} = \\frac{\\exp(\\tilde{\\ell}_t^{(i)})}{\\sum_{j=1}^{N} \\exp(\\tilde{\\ell}_t^{(j)})} $$\n分母中的和 $\\sum_{j=1}^{N} \\exp(\\tilde{\\ell}_t^{(j)})$ 是数值不稳定性的一个潜在来源。如果 $\\tilde{\\ell}_t^{(j)}$ 的值很大，$\\exp(\\tilde{\\ell}_t^{(j)})$ 可能会上溢。如果它们是很大的负数，它可能会下溢为零，导致除以零的错误。\n\n用于此归一化的标准且数值稳定的方法，被称为log-sum-exp技巧，它涉及将对数权重减去它们的最大值。令 $L_{\\max} = \\max_{j} \\{ \\tilde{\\ell}_t^{(j)} \\}$。这个和可以重写为：\n$$ \\sum_{j=1}^{N} \\exp(\\tilde{\\ell}_t^{(j)}) = \\sum_{j=1}^{N} \\exp(L_{\\max} + \\tilde{\\ell}_t^{(j)} - L_{\\max}) = \\exp(L_{\\max}) \\sum_{j=1}^{N} \\exp(\\tilde{\\ell}_t^{(j)} - L_{\\max}) $$\n将此代回归一化权重的表达式中：\n$$ w_t^{(i)} = \\frac{\\exp(\\tilde{\\ell}_t^{(i)})}{\\exp(L_{\\max}) \\sum_{j=1}^{N} \\exp(\\tilde{\\ell}_t^{(j)} - L_{\\max})} = \\frac{\\exp(\\tilde{\\ell}_t^{(i)} - L_{\\max})}{\\sum_{j=1}^{N} \\exp(\\tilde{\\ell}_t^{(j)} - L_{\\max})} $$\n这个公式是数值稳定的。项 $\\tilde{\\ell}_t^{(j)} - L_{\\max}$ 总是非正的，且至少有一项恰好为零。因此，其指数 $\\exp(\\tilde{\\ell}_t^{(j)} - L_{\\max})$ 总是在 $0$ 和 $1$ 之间，从而防止了上溢。分母是这些表现良好的项之和，并且由于其中一项等于 $1$，所以这个和保证至少为 $1$，从而防止了下溢和除以零的错误。如要求所述，此计算仅依赖于对数权重的减法、这些差值的指数运算、求和和除法。\n\n现在，我们将此过程应用于所提供的简单示例。\n已知条件如下：\n- 粒子数：$N=4$。\n- 先前的归一化权重：对于 $i \\in \\{1,2,3,4\\}$，$w_{t-1}^{(i)} = 1/4$。\n- 增量对数似然：$\\delta_1 = -300$, $\\delta_2 = -0.1$, $\\delta_3 = 0$, $\\delta_4 = -200$。\n\n1.  计算时间 $t$ 的未归一化对数权重。\n先前的归一化对数权重为 $\\ell_{t-1}^{(i)} = \\ln(w_{t-1}^{(i)}) = \\ln(1/4) = -\\ln(4)$，对所有 $i$ 均如此。\n未归一化的对数权重为 $\\tilde{\\ell}_t^{(i)} = \\ell_{t-1}^{(i)} + \\delta_i = -\\ln(4) + \\delta_i$。\n$$ \\tilde{\\ell}_t^{(1)} = -\\ln(4) - 300 $$\n$$ \\tilde{\\ell}_t^{(2)} = -\\ln(4) - 0.1 $$\n$$ \\tilde{\\ell}_t^{(3)} = -\\ln(4) + 0 = -\\ln(4) $$\n$$ \\tilde{\\ell}_t^{(4)} = -\\ln(4) - 200 $$\n\n2.  找到最大的未归一化对数权重 $L_{\\max}$。\n$$ L_{\\max} = \\max_{i} \\{ \\tilde{\\ell}_t^{(i)} \\} = \\max \\{ -\\ln(4) - 300, -\\ln(4) - 0.1, -\\ln(4), -\\ln(4) - 200 \\} $$\n最大值显然是 $\\tilde{\\ell}_t^{(3)} = -\\ln(4)$。\n$$ L_{\\max} = -\\ln(4) $$\n\n3.  使用稳定公式计算归一化权重 $w_t^{(i)}$。\n$$ w_t^{(i)} = \\frac{\\exp(\\tilde{\\ell}_t^{(i)} - L_{\\max})}{\\sum_{j=1}^{4} \\exp(\\tilde{\\ell}_t^{(j)} - L_{\\max})} $$\n首先，计算指数的差值：$\\tilde{\\ell}_t^{(i)} - L_{\\max} = (-\\ln(4) + \\delta_i) - (-\\ln(4)) = \\delta_i$。\n分母（我们记为 $S$）是这些差值的指数之和：\n$$ S = \\sum_{j=1}^{4} \\exp(\\delta_j) = \\exp(\\delta_1) + \\exp(\\delta_2) + \\exp(\\delta_3) + \\exp(\\delta_4) $$\n$$ S = \\exp(-300) + \\exp(-0.1) + \\exp(0) + \\exp(-200) $$\n为清晰起见重新排序：\n$$ S = 1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300) $$\n归一化权重 $w_t^{(i)}$ 由 $w_t^{(i)} = \\frac{\\exp(\\delta_i)}{S}$ 给出：\n$$ w_t^{(1)} = \\frac{\\exp(-300)}{1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300)} $$\n$$ w_t^{(2)} = \\frac{\\exp(-0.1)}{1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300)} $$\n$$ w_t^{(3)} = \\frac{\\exp(0)}{1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300)} = \\frac{1}{1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300)} $$\n$$ w_t^{(4)} = \\frac{\\exp(-200)}{1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300)} $$\n最终的权重向量 $\\mathbf{w}_t = (w_t^{(1)}, w_t^{(2)}, w_t^{(3)}, w_t^{(4)})$ 可以写成一个标量乘以一个向量的形式：\n$$ \\mathbf{w}_t = \\frac{1}{1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300)} \\begin{pmatrix} \\exp(-300)  \\exp(-0.1)  1  \\exp(-200) \\end{pmatrix} $$\n该表达式代表了四个粒子的精确、未四舍五入的归一化权重。",
            "answer": "$$\n\\boxed{\\frac{1}{1 + \\exp(-0.1) + \\exp(-200) + \\exp(-300)} \\begin{pmatrix} \\exp(-300)  \\exp(-0.1)  1  \\exp(-200) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "粒子滤波器一个常见的失效模式是权重退化，即几乎所有的重要性权重都集中在单个粒子上。为了量化这一问题，我们使用有效粒子数（$N_{\\text{eff}}$）。本练习 () 不再是简单的计算，而是要求你在一个经典的退化场景中，推导出 $N_{\\text{eff}}$ 的解析表达式。这将让你深刻理解粒子系统为何以及如何迅速地丧失其多样性。",
            "id": "3417298",
            "problem": "考虑一个用于逆问题数据同化设置的序贯蒙特卡罗（SMC）粒子滤波器，其中包含 $N$ 个粒子。在同化单个观测值后，假设（非负）重要性权重为 $\\{w_{i}\\}_{i=1}^{N}$，并且权重向量表现出单一主导权重，即其中一个权重 $w_{1}$ 大于其余 $N-1$ 个权重。假设这 $N-1$ 个非主导权重相等。定义归一化权重为 $\\tilde{w}_{i} = w_{i} / \\sum_{j=1}^{N} w_{j}$，定义主导水平为 $\\rho = w_{1} / \\sum_{j=1}^{N} w_{j}$，并考虑将有效样本量（ESS）$N_{\\mathrm{eff}}$ 作为序贯蒙特卡罗中标准的退化诊断指标。\n\n从粒子滤波中基于归一化权重的退化问题的标准定义出发，在 $N-1$ 个非主导归一化权重相等的假设下，推导 $N_{\\mathrm{eff}}$ 作为粒子数 $N$ 和主导水平 $\\rho$ 的函数的封闭形式解析表达式。然后，通过刻画当 $\\rho$ 在 $[0,1]$ 区间内变化时 $N_{\\mathrm{eff}}$ 的单调性和极值，来分析 $N_{\\mathrm{eff}}$ 对 $\\rho$ 的敏感性，并解释其对权重退化和维度灾难的影响。\n\n将 $N_{\\mathrm{eff}}$ 的最终答案表示为关于 $N$ 和 $\\rho$ 的单个封闭形式解析表达式。无需进行数值计算或四舍五入。",
            "solution": "首先验证问题陈述，以确保其科学上合理、适定且客观。\n\n### 第1步：提取已知条件\n- 考虑一个序贯蒙特卡罗（SMC）粒子滤波器。\n- 粒子数量为 $N$。\n- 非负重要性权重集合为 $\\{w_{i}\\}_{i=1}^{N}$。\n- 权重向量有一个单一主导权重 $w_{1}$，该权重比其他 $N-1$ 个权重都要大。\n- $N-1$ 个非主导权重彼此相等。\n- 归一化权重定义为 $\\tilde{w}_{i} = w_{i} / \\sum_{j=1}^{N} w_{j}$。\n- 主导水平定义为 $\\rho = w_{1} / \\sum_{j=1}^{N} w_{j}$。\n- 有效样本量 $N_{\\mathrm{eff}}$ 用作退化诊断指标。\n- 任务是使用退化的标准定义，推导 $N_{\\mathrm{eff}}$ 作为 $N$ 和 $\\rho$ 的函数的封闭形式表达式。\n- 任务包括分析 $N_{\\mathrm{eff}}$ 对 $\\rho$ 的敏感性，通过刻画其在 $\\rho \\in [0,1]$ 上的单调性和极值。\n- 任务要求在权重退化和维度灾难的背景下解释结果。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学或事实合理性**：问题在科学上是合理的。它基于数据同化和统计信号处理领域的标准、基本概念，特别是序贯蒙特卡罗方法（粒子滤波）。归一化权重、有效样本量、权重退化和维度灾难的定义在该领域都是标准的。$N_{\\mathrm{eff}}$ 的标准定义是 $N_{\\mathrm{eff}} = (\\sum_{i=1}^{N} \\tilde{w}_{i}^{2})^{-1}$。\n2.  **不可形式化或不相关**：问题高度相关且可直接形式化。它在指定主题内提出了一个精确的数学问题。\n3.  **不完整或矛盾的设置**：设置是完整的且内部一致。所提供的定义和假设足以推导出所要求的表达式。假设 $w_1$ 是最大权重意味着对于 $j \\neq 1$ 有 $\\tilde{w}_1 > \\tilde{w}_j$。这意味着 $\\rho > (1-\\rho)/(N-1)$，简化后为 $\\rho > 1/N$。要求在 $\\rho \\in [0,1]$ 上分析函数是一个标准的数学练习，旨在理解函数的行为，即使子区间 $\\rho \\in [0, 1/N]$ 与“主导”假设相矛盾。这并不会使问题无效，但需要在分析中注意这一点。核心推导不受影响。\n4.  **不切实际或不可行**：所描述的场景非常现实。权重坍缩到单个或少数几个粒子上是粒子滤波器实际应用中的一个常见且关键的问题，尤其是在高维系统中。\n5.  **不适定或结构不良**：问题是适定的。这些假设导向一个唯一的解析解。术语定义明确。\n6.  **伪深刻、琐碎或同义反复**：问题并非琐碎。它需要基于该方法的第一性原理进行形式推导和分析推理。\n7.  **超出科学可验证性**：问题完全是数学性的，其解可通过逻辑推导和计算进行验证。\n\n### 第3步：结论与行动\n问题被判定为**有效**。我们可以继续进行求解。\n\n### 推导 $N_{\\mathrm{eff}}$ 的表达式\n\n基于归一化重要性权重 $\\{\\tilde{w}_{i}\\}_{i=1}^{N}$ 的有效样本量 $N_{\\mathrm{eff}}$ 的标准定义由下式给出：\n$$N_{\\mathrm{eff}} = \\frac{1}{\\sum_{i=1}^{N} \\tilde{w}_{i}^{2}}$$\n归一化权重的总和必须等于 $1$：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i} = 1$$\n根据问题陈述，主导水平 $\\rho$ 是第一个粒子的归一化权重：\n$$\\tilde{w}_{1} = \\rho$$\n问题还指出，其余的 $N-1$ 个非主导权重相等。我们用 $\\tilde{w}_{k}$ 表示这些权重的值，其中 $k \\in \\{2, 3, \\ldots, N\\}$。我们可以用 $\\rho$ 和 $N$ 来表示 $\\tilde{w}_{k}$。\n使用归一化条件：\n$$\\tilde{w}_{1} + \\sum_{k=2}^{N} \\tilde{w}_{k} = 1$$\n代入 $\\tilde{w}_{1} = \\rho$ 并注意到其他 $N-1$ 个权重相等：\n$$\\rho + (N-1)\\tilde{w}_{k} = 1$$\n求解 $\\tilde{w}_{k}$（假设 $N > 1$，这在问题的措辞中是隐含的）：\n$$\\tilde{w}_{k} = \\frac{1-\\rho}{N-1}$$\n现在，我们可以计算归一化权重的平方和 $\\sum_{i=1}^{N} \\tilde{w}_{i}^{2}$：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\tilde{w}_{1}^{2} + \\sum_{k=2}^{N} \\tilde{w}_{k}^{2}$$\n代入 $\\tilde{w}_{1}$ 和 $\\tilde{w}_{k}$ 的表达式：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\rho^{2} + (N-1) \\left( \\frac{1-\\rho}{N-1} \\right)^{2}$$\n简化表达式：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\rho^{2} + (N-1) \\frac{(1-\\rho)^{2}}{(N-1)^{2}} = \\rho^{2} + \\frac{(1-\\rho)^{2}}{N-1}$$\n为了合并这些项，我们找到一个公分母：\n$$\\sum_{i=1}^{N} \\tilde{w}_{i}^{2} = \\frac{(N-1)\\rho^{2} + (1-\\rho)^{2}}{N-1} = \\frac{(N-1)\\rho^{2} + (1 - 2\\rho + \\rho^{2})}{N-1}$$\n$$= \\frac{N\\rho^{2} - \\rho^{2} + 1 - 2\\rho + \\rho^{2}}{N-1} = \\frac{N\\rho^{2} - 2\\rho + 1}{N-1}$$\n最后，我们将此结果代回 $N_{\\mathrm{eff}}$ 的定义中：\n$$N_{\\mathrm{eff}} = \\frac{1}{\\frac{N\\rho^{2} - 2\\rho + 1}{N-1}} = \\frac{N-1}{N\\rho^{2} - 2\\rho + 1}$$\n这就是 $N_{\\mathrm{eff}}$ 作为 $N$ 和 $\\rho$ 的函数的封闭形式解析表达式。\n\n### 敏感性分析与解释\n\n为了分析 $N_{\\mathrm{eff}}$ 对 $\\rho$ 的敏感性，我们计算一阶导数 $\\frac{d N_{\\mathrm{eff}}}{d \\rho}$。设分母为 $f(\\rho) = N\\rho^{2} - 2\\rho + 1$。\n$$\\frac{d N_{\\mathrm{eff}}}{d \\rho} = \\frac{d}{d\\rho} \\left( (N-1) (N\\rho^{2} - 2\\rho + 1)^{-1} \\right)$$\n使用链式法则：\n$$\\frac{d N_{\\mathrm{eff}}}{d \\rho} = (N-1) (-1) (N\\rho^{2} - 2\\rho + 1)^{-2} (2N\\rho - 2)$$\n$$\\frac{d N_{\\mathrm{eff}}}{d \\rho} = -2(N-1) \\frac{N\\rho - 1}{(N\\rho^{2} - 2\\rho + 1)^{2}}$$\n分母 $(N\\rho^{2} - 2\\rho + 1)^{2}$ 总是非负的。当 $N>1$ 时，其根是复数，因此它严格为正。因此，导数的符号由分子中的非常数项 $-(N\\rho - 1)$ 的符号决定。\n1.  如果 $N\\rho - 1 > 0 \\implies \\rho > 1/N$，则 $\\frac{d N_{\\mathrm{eff}}}{d \\rho}  0$。$N_{\\mathrm{eff}}$ 是 $\\rho$ 的单调递减函数。\n2.  如果 $N\\rho - 1  0 \\implies \\rho  1/N$，则 $\\frac{d N_{\\mathrm{eff}}}{d \\rho} > 0$。$N_{\\mathrm{eff}}$ 是 $\\rho$ 的单调递增函数。\n3.  如果 $N\\rho - 1 = 0 \\implies \\rho = 1/N$，则 $\\frac{d N_{\\mathrm{eff}}}{d \\rho} = 0$。这表示一个临界点。\n\n分析揭示了在 $\\rho = 1/N$ 处存在一个极值。由于导数在该点由正变负，因此它是一个局部最大值。让我们在区间 $[0,1]$ 的边界和这个临界点上计算 $N_{\\mathrm{eff}}$ 的值。\n\n-   **最大值**：在 $\\rho = 1/N$ 时，\n    $$N_{\\mathrm{eff}}\\left(\\rho = \\frac{1}{N}\\right) = \\frac{N-1}{N\\left(\\frac{1}{N}\\right)^{2} - 2\\left(\\frac{1}{N}\\right) + 1} = \\frac{N-1}{\\frac{1}{N} - \\frac{2}{N} + 1} = \\frac{N-1}{\\frac{N-1}{N}} = N$$\n    这种情况对应于所有权重都相等，即对所有 $i$ 都有 $\\tilde{w}_{i} = 1/N$，表示没有发生退化。有效样本量等于粒子的实际数量。\n\n-   **最小值**：在 $\\rho = 1$ 时，\n    $$N_{\\mathrm{eff}}(\\rho = 1) = \\frac{N-1}{N(1)^{2} - 2(1) + 1} = \\frac{N-1}{N-1} = 1$$\n    这种情况对应于完全退化，即一个粒子拥有全部权重（$\\tilde{w}_{1} = 1$），而所有其他粒子的权重都为零。有效样本量坍缩为 $1$。\n\n-   在 $\\rho = 0$ 时：\n    $$N_{\\mathrm{eff}}(\\rho = 0) = \\frac{N-1}{N(0)^{2} - 2(0) + 1} = N-1$$\n    这对应于主导粒子的权重为零，而权重均匀分布在其他 $N-1$ 个粒子中。\n\n考虑到 $\\tilde{w}_1$ 是最大权重，$\\rho$ 的物理上有意义的定义域是 $[\\frac{1}{N}, 1]$。在此定义域上，$N_{\\mathrm{eff}}$ 是 $\\rho$ 的严格单调递减函数。\n\n**解释**：\n-   **权重退化**：推导出的表达式及其分析在数学上形式化了权重退化的概念。当权重分布变得更加倾斜（即，当 $\\rho$ 从其最均匀的值 $1/N$ 增加到 $1$ 时），对后验分布的近似做出贡献的有效粒子数量从 $N$ 急剧下降到 $1$。一个低的 $N_{\\mathrm{eff}}$ 是一个信号，表明粒子表示效果很差，需要进行重采样步骤，通过消除低权重粒子并复制高权重粒子来缓解退化。\n-   **维度灾难**：在高维状态空间中，众所周知，似然函数 $p(\\text{观测值}|\\text{状态})$ 倾向于高度集中在空间的一个小体积内。在更新粒子权重时，粒子落入这个高似然区域的情况变得极其罕见。因此，在更新之后，大多数粒子的权重接近于零，而恰好位于正确位置的一个或极少数粒子几乎占据了全部的总权重。这种情况直接导致 $\\rho$ 值接近 $1$。我们的分析表明，当 $\\rho \\to 1$ 时，$N_{\\mathrm{eff}} \\to 1$，而这与总粒子数 $N$ 无关。这说明了粒子滤波器维度灾难的一个关键方面：简单地增加 $N$ 并不是一个有效的解决方案，因为要充分采样高似然区域（从而避免权重坍缩）所需的粒子数量通常随着状态空间维度的增加而呈指数级增长。",
            "answer": "$$\n\\boxed{\\frac{N-1}{N\\rho^2 - 2\\rho + 1}}\n$$"
        },
        {
            "introduction": "当通过较低的有效粒子数检测到权重退化时，必须进行重采样来“复兴”粒子群体。系统重采样是实现此目的的一种广泛使用的高效算法。本练习 () 提供了一个动手实践的机会，让你一步步地执行系统重采样的具体机制，从而巩固你对如何根据粒子的重要性选择性地复制它们的理解。",
            "id": "3347857",
            "problem": "在计算系统生物学的背景下，使用序贯蒙特卡洛 (SMC) 粒子滤波器随时间追踪一个单细胞转录爆发模型。在时间步 $t$ 同化一次荧光测量后，您有 $N=8$ 个粒子代表潜在的启动子活性状态，其归一化重要性权重 $w_{1:8}$ 是通过高斯观测模型进行贝叶斯更新得到的。重採样的目标是根据这些归一化权重抽取祖先索引，以减轻权重退化问题，同时保持经验测度的无偏性。\n\n给定归一化权重向量\n$$\nw_{1:8} = \\big(0.04,\\; 0.08,\\; 0.12,\\; 0.06,\\; 0.20,\\; 0.10,\\; 0.30,\\; 0.10\\big),\n$$\n其满足 $\\sum_{i=1}^{8} w_i = 1$。在此时间步，使用基于 1 的索引约定实现系统重采样，其中单个随机偏移量从 $U \\sim \\mathrm{Uniform}(0, 1/N)$ 中抽取，并实现为 $U = 0.03$。计算权重的累积和向量以及从 $U$ 开始、间隔为 $1/N$ 的 $N$ 个等间距阈值，然后对每个阈值，确定其累积和大于或等于该阈值的最小祖先索引。\n\n使用基于 1 的索引，将所选的长度为 8 的祖先索引向量报告为八个整数。将您的最终答案表示为单个行向量，不要包含任何单位。无需四舍五入。",
            "solution": "问题陈述经评估有效。它在科学上基于序贯蒙特卡洛方法（特别是粒子滤波）的既定原理。该问题是适定的，提供了计算唯一确定性答案所需的所有数据——粒子数 $N$、归一化权重向量 $w_{1:8}$ 以及实现的随机偏移量 $U$。该问题客观、完整且无矛盾。所要求的任务是该领域的标准计算程序。\n\n该问题要求对一组具有给定归一化重要性权重的 $N=8$ 个粒子实施系统重采样。该过程涉及三个主要步骤：\n1.  计算归一化权重的累积和。\n2.  从给定的随机偏移量 $U$ 开始，生成一组 $N$ 个有序的、均匀间隔的随机数（阈值）。\n3.  对于每个阈值，通过找到其累积权重超过或等于该阈值的第一个粒子来确定相应的祖先粒子。\n\n给定的参数是：\n-   粒子数：$N=8$。\n-   归一化权重向量：$w_{1:8} = \\left(0.04,\\; 0.08,\\; 0.12,\\; 0.06,\\; 0.20,\\; 0.10,\\; 0.30,\\; 0.10\\right)$。\n-   从 $U \\sim \\mathrm{Uniform}(0, 1/N)$ 中抽取的随机偏移量实现为 $U=0.03$。\n-   索引是基于 1 的。\n\n首先，我们计算累积和向量 $c$，其中 $c_k = \\sum_{i=1}^{k} w_i$。\n$$\n\\begin{aligned}\nc_1 = w_1 = 0.04 \\\\\nc_2 = w_1 + w_2 = 0.04 + 0.08 = 0.12 \\\\\nc_3 = c_2 + w_3 = 0.12 + 0.12 = 0.24 \\\\\nc_4 = c_3 + w_4 = 0.24 + 0.06 = 0.30 \\\\\nc_5 = c_4 + w_5 = 0.30 + 0.20 = 0.50 \\\\\nc_6 = c_5 + w_6 = 0.50 + 0.10 = 0.60 \\\\\nc_7 = c_6 + w_7 = 0.60 + 0.30 = 0.90 \\\\\nc_8 = c_7 + w_8 = 0.90 + 0.10 = 1.00\n\\end{aligned}\n$$\n累积和向量为 $c_{1:8} = \\left(0.04,\\; 0.12,\\; 0.24,\\; 0.30,\\; 0.50,\\; 0.60,\\; 0.90,\\; 1.00\\right)$。\n\n其次，我们计算 $N=8$ 个等间距阈值，我们将其表示为向量 $u_{1:8}$。阈值根据公式 $u_j = U + \\frac{j-1}{N}$ 生成，其中 $j = 1, 2, \\ldots, N$。间距为 $\\frac{1}{N} = \\frac{1}{8} = 0.125$。\n$$\n\\begin{aligned}\nu_1 = U = 0.03 \\\\\nu_2 = 0.03 + 1 \\times 0.125 = 0.155 \\\\\nu_3 = 0.03 + 2 \\times 0.125 = 0.03 + 0.25 = 0.280 \\\\\nu_4 = 0.03 + 3 \\times 0.125 = 0.03 + 0.375 = 0.405 \\\\\nu_5 = 0.03 + 4 \\times 0.125 = 0.03 + 0.5 = 0.530 \\\\\nu_6 = 0.03 + 5 \\times 0.125 = 0.03 + 0.625 = 0.655 \\\\\nu_7 = 0.03 + 6 \\times 0.125 = 0.03 + 0.75 = 0.780 \\\\\nu_8 = 0.03 + 7 \\times 0.125 = 0.03 + 0.875 = 0.905\n\\end{aligned}\n$$\n阈值向量为 $u_{1:8} = \\left(0.03,\\; 0.155,\\; 0.280,\\; 0.405,\\; 0.530,\\; 0.655,\\; 0.780,\\; 0.905\\right)$。\n\n第三，我们确定所选的祖先索引。对于每个阈值 $u_j$，我们找到满足 $u_j \\le c_k$ 的最小整数索引 $k \\in \\{1, 2, ..., 8\\}$。设此索引为 $a_j$。\n\n-   对于 $u_1 = 0.03$：我们寻找满足 $c_k \\ge 0.03$ 的最小 $k$。由于 $c_1 = 0.04 \\ge 0.03$，所选索引为 $a_1=1$。\n-   对于 $u_2 = 0.155$：我们寻找满足 $c_k \\ge 0.155$ 的最小 $k$。我们有 $c_2 = 0.12  0.155$ 和 $c_3 = 0.24 \\ge 0.155$。所选索引为 $a_2=3$。\n-   对于 $u_3 = 0.280$：我们寻找满足 $c_k \\ge 0.280$ 的最小 $k$。我们有 $c_3 = 0.24  0.280$ 和 $c_4 = 0.30 \\ge 0.280$。所选索引为 $a_3=4$。\n-   对于 $u_4 = 0.405$：我们寻找满足 $c_k \\ge 0.405$ 的最小 $k$。我们有 $c_4 = 0.30  0.405$ 和 $c_5 = 0.50 \\ge 0.405$。所选索引为 $a_4=5$。\n-   对于 $u_5 = 0.530$：我们寻找满足 $c_k \\ge 0.530$ 的最小 $k$。我们有 $c_5 = 0.50  0.530$ 和 $c_6 = 0.60 \\ge 0.530$。所选索引为 $a_5=6$。\n-   对于 $u_6 = 0.655$：我们寻找满足 $c_k \\ge 0.655$ 的最小 $k$。我们有 $c_6 = 0.60  0.655$ 和 $c_7 = 0.90 \\ge 0.655$。所选索引为 $a_6=7$。\n-   对于 $u_7 = 0.780$：我们寻找满足 $c_k \\ge 0.780$ 的最小 $k$。我们有 $c_6 = 0.60  0.780$ 和 $c_7 = 0.90 \\ge 0.780$。所选索引为 $a_7=7$。\n-   对于 $u_8 = 0.905$：我们寻找满足 $c_k \\ge 0.905$ 的最小 $k$。我们有 $c_7 = 0.90  0.905$ 和 $c_8 = 1.00 \\ge 0.905$。所选索引为 $a_8=8$。\n\n综合这些结果，所选祖先索引的向量为 $(1, 3, 4, 5, 6, 7, 7, 8)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  3  4  5  6  7  7  8\n\\end{pmatrix}\n}\n$$"
        }
    ]
}