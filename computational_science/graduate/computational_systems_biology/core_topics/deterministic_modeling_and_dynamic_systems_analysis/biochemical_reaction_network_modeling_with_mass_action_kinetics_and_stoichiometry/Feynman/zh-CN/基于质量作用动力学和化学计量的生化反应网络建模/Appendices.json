{
    "hands_on_practices": [
        {
            "introduction": "将生化反应网络转化为精确的数学形式是进行计算分析的第一步。化学计量矩阵 $S$ 正是实现这一转化的核心工具，它简洁地编码了网络中每个物种在各个反应中的净变化。本练习将指导您为一个给定的反应网络构建化学计量矩阵 $S$，并运用线性代数的基本原理来揭示其内在属性，例如独立反应的数量和系统存在的守恒定律。",
            "id": "3291006",
            "problem": "考虑一个充分混合的生化系统，其物种集合为 $\\{A,B,C,D\\}$，在固定体积内发生以下反应：$2A + B \\to C$、$C \\to A + D$ 和 $D \\to B$。采用物种排序 $(A,B,C,D)$ 和与所写三个反应相对应的反应排序 $(R_{1},R_{2},R_{3})$。根据反应网络理论中化学计量矩阵的核心定义，其中每一列是根据指定的物种排序排列的净化学计量变化向量（产物的化学计量系数减去反应物的化学计量系数），为该网络构建化学计量矩阵 $S \\in \\mathbb{R}^{m \\times r}$，其中 $m$ 是物种数量，$r$ 是反应数量。然后，从第一性原理出发，利用线性代数和 $S$ 的结构，确定 $\\operatorname{rank}(S)$、$\\dim(\\ker S)$ 和 $\\dim(\\ker S^{\\top})$。将您的最终答案表示为 $(\\operatorname{rank}(S),\\ \\dim(\\ker S),\\ \\dim(\\ker S^{\\top}))$ 顺序的行矩阵。无需数值取整。无需单位。",
            "solution": "该问题陈述具有科学依据、提法明确且客观。这是一个计算系统生物学中的标准练习，涉及化学计量矩阵的构建与分析。所有必要信息均已提供，且前提与化学反应网络理论的原理一致。因此，我们可以着手求解。\n\n该系统包含 $m=4$ 个物种，根据指定的排序 $(A,B,C,D)$，可以用浓度向量 $\\mathbf{x} = \\begin{pmatrix} [A]  [B]  [C]  [D] \\end{pmatrix}^{\\top}$ 表示。共有 $r=3$ 个反应，排序为 $(R_1, R_2, R_3)$。\n\n化学计量矩阵 $S \\in \\mathbb{R}^{m \\times r}$ 的构建方式为：其第 $(i,j)$ 个元素 $S_{ij}$ 表示物种 $i$ 的分子数因反应 $j$ 发生一次而产生的净变化。$S$ 的每一列是对应反应的化学计量向量。\n\n对于反应 $R_1: 2A + B \\to C$：\n物种数量的变化为 $\\Delta A = -2$、$\\Delta B = -1$、$\\Delta C = +1$ 和 $\\Delta D = 0$。$S$ 的第一列，对应于 $R_1$，因此是：\n$$ \\mathbf{s}_1 = \\begin{pmatrix} -2 \\\\ -1 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n\n对于反应 $R_2: C \\to A + D$：\n物种数量的变化为 $\\Delta A = +1$、$\\Delta B = 0$、$\\Delta C = -1$ 和 $\\Delta D = +1$。$S$ 的第二列，对应于 $R_2$，是：\n$$ \\mathbf{s}_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 1 \\end{pmatrix} $$\n\n对于反应 $R_3: D \\to B$：\n物种数量的变化为 $\\Delta A = 0$、$\\Delta B = +1$、$\\Delta C = 0$ 和 $\\Delta D = -1$。$S$ 的第三列，对应于 $R_3$，是：\n$$ \\mathbf{s}_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} $$\n\n按指定的顺序 $(R_1, R_2, R_3)$ 组合这些列向量，得到 $4 \\times 3$ 的化学计量矩阵 $S$：\n$$ S = \\begin{pmatrix} \\mathbf{s}_1  \\mathbf{s}_2  \\mathbf{s}_3 \\end{pmatrix} = \\begin{pmatrix} -2  1  0 \\\\ -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} $$\n\n接下来，我们确定 $S$ 的秩以及其核与转置的核的维数。矩阵的秩是其列空间的维数，等于线性无关列的数量。如果方程 $c_1\\mathbf{s}_1 + c_2\\mathbf{s}_2 + c_3\\mathbf{s}_3 = \\mathbf{0}$ 的唯一解是平凡解 $c_1=c_2=c_3=0$，则列向量 $\\mathbf{s}_1, \\mathbf{s}_2, \\mathbf{s}_3$ 是线性无关的。这等价于求 $S$ 的核（零空间）。\n方程 $S\\mathbf{c} = \\mathbf{0}$，其中 $\\mathbf{c} = \\begin{pmatrix} c_1  c_2  c_3 \\end{pmatrix}^{\\top}$，对应于以下线性方程组：\n$$-2c_1 + c_2 = 0$$\n$$-c_1 + c_3 = 0$$\n$$c_1 - c_2 = 0$$\n$$c_2 - c_3 = 0$$\n由第三个方程，我们得到 $c_1 = c_2$。将其代入第一个方程，得到 $-2c_1 + c_1 = 0$，这意味着 $-c_1 = 0$，所以 $c_1 = 0$。\n因为 $c_1=c_2$，我们有 $c_2 = 0$。\n由第二个方程，$c_3 = c_1$，所以 $c_3 = 0$。\n唯一的解是 $c_1 = c_2 = c_3 = 0$。这证明了 $S$ 的列是线性无关的。\n因为有 3 个线性无关的列，所以列空间的维数是 3。因此，$\\operatorname{rank}(S) = 3$。\n\n$S$ 的核，记作 $\\ker S$，是所有满足 $S\\mathbf{c} = \\mathbf{0}$ 的向量 $\\mathbf{c}$ 的集合。我们刚刚证明了唯一的这样的向量是零向量 $\\mathbf{c} = \\mathbf{0}$。核是平凡子空间 $\\{\\mathbf{0}\\}$，其维数为 0。\n因此，$\\dim(\\ker S) = 0$。\n这个结果也与秩-零度定理一致，该定理指出，对于一个有 $r$ 列的矩阵，$\\operatorname{rank}(S) + \\dim(\\ker S) = r$。这里，$r=3$，我们得到 $\\operatorname{rank}(S)=3$，所以 $3 + \\dim(\\ker S) = 3$，这证实了 $\\dim(\\ker S) = 0$。\n\n最后，我们确定 $\\dim(\\ker S^{\\top})$。矩阵 $S^{\\top}$ 是一个 $r \\times m$ 矩阵，在本例中是一个 $3 \\times 4$ 矩阵。应用于 $S^{\\top}$ 的秩-零度定理指出 $\\operatorname{rank}(S^{\\top}) + \\dim(\\ker S^{\\top}) = m$，其中 $m$ 是 $S^{\\top}$ 的列数（即 $S$ 的行数）。\n线性代数的一个基本定理指出，矩阵的秩等于其转置的秩，即 $\\operatorname{rank}(S) = \\operatorname{rank}(S^{\\top})$。\n我们有 $m=4$ 且 $\\operatorname{rank}(S) = 3$，所以 $\\operatorname{rank}(S^{\\top}) = 3$。\n将这些值代入 $S^{\\top}$ 的秩-零度定理：\n$$ 3 + \\dim(\\ker S^{\\top}) = 4 $$\n解出 $\\dim(\\ker S^{\\top})$，我们得到：\n$$ \\dim(\\ker S^{\\top}) = 1 $$\n$\\ker S^{\\top}$ 中的向量代表系统的守恒定律。其维数为 1 的事实意味着存在一个线性无关的守恒定律。\n\n总之，计算出的值为：\n$\\operatorname{rank}(S) = 3$\n$\\dim(\\ker S) = 0$\n$\\dim(\\ker S^{\\top}) = 1$\n\n最终答案应以 $(\\operatorname{rank}(S),\\ \\dim(\\ker S),\\ \\dim(\\ker S^{\\top}))$ 的顺序表示为行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  0  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了网络的数学表示方法后，一个自然而然的问题是：系统将如何演化，其最终的稳定状态是什么？本练习将化学计量矩阵 $S$ 与质量作用动力学原理相结合，向您展示如何建立并求解一个系统的稳态方程。通过这个过程，您将能够在一个封闭系统中，根据给定的物种总量，精确计算出各物种的平衡浓度。",
            "id": "3291003",
            "problem": "考虑一个封闭、充分混合的质量作用反应网络，其中包含三种化学物种 $A$、$B$ 和 $C$：\n$$A \\;\\xrightleftharpoons[k_{-1}]{k_{1}}\\; B \\;\\xrightleftharpoons[k_{-2}]{k_{2}}\\; C,$$\n解释为四个基元反应通道 $r_{1}: A \\to B$、$r_{2}: B \\to A$、$r_{3}: B \\to C$ 和 $r_{4}: C \\to B$。该系统是等温的，体积恒定，并遵循质量作用动力学。\n\n速率常数为 $k_{1} = 2.4\\,\\mathrm{s}^{-1}$、$k_{-1} = 1.2\\,\\mathrm{s}^{-1}$、$k_{2} = 3.6\\,\\mathrm{s}^{-1}$ 和 $k_{-2} = 1.2\\,\\mathrm{s}^{-1}$。初始条件定义了一个化学计量相容类，该类由守恒总量 $T = x_{A}(0) + x_{B}(0) + x_{C}(0) = 95\\,\\mu\\mathrm{M}$ 确定，由于网络的化学计量特性，该总量在所有时间内保持不变。\n\n仅从质量作用动力学的定义和生化反应网络的化学计量表述出发，完成以下任务：\n- 以紧凑形式 $S\\,v(x^{*}) = 0$（其中 $x^{*} \\in \\mathbb{R}_{>0}^{3}$，$S$ 是化学计量矩阵，$v(x)$ 是质量作用动力学下的反应速率向量）写出稳态方程。\n- 施加表征指定化学计量相容类的守恒约束。\n- 求解这些方程，以获得该类中所有的正平衡点。\n\n最后，报告对应于该类的稳态浓度 $x_{C}^{*}$。将您的 $x_{C}^{*}$ 最终数值答案四舍五入到四位有效数字，并以微摩尔 (μM) 为单位表示。",
            "solution": "问题要求对于一个封闭的化学反应网络，求出物种 C 的稳态浓度，记为 $x_C^*$。解必须从质量作用动力学和化学计量网络分析的基本原理推导得出。\n\n该网络由三种物种 $S_1 = A$、$S_2 = B$、$S_3 = C$ 和四个可逆基元反应组成：\n$r_1: A \\to B$\n$r_2: B \\to A$\n$r_3: B \\to C$\n$r_4: C \\to B$\n\n设浓度向量为 $x = (x_A, x_B, x_C)^T$。根据质量作用定律，四个反应的速率由以下公式给出：\n$v_1(x) = k_1 x_A$\n$v_2(x) = k_{-1} x_B$\n$v_3(x) = k_2 x_B$\n$v_4(x) = k_{-2} x_C$\n我们可以将这些速率写成向量 $v(x) = (v_1, v_2, v_3, v_4)^T$。\n\n网络的化学计量由化学计量矩阵 S 捕获，S 是一个 $m \\times n$ 矩阵，其中 $m=3$ 是物种数，$n=4$ 是反应数。S 的每一列代表给定反应中物种浓度的净变化。\n对于 $r_1: A \\to B$，物种变化向量是 $(-1, 1, 0)^T$。\n对于 $r_2: B \\to A$，物种变化向量是 $(1, -1, 0)^T$。\n对于 $r_3: B \\to C$，物种变化向量是 $(0, -1, 1)^T$。\n对于 $r_4: C \\to B$，物种变化向量是 $(0, 1, -1)^T$。\n\n组合这些列向量，化学计量矩阵 S 为：\n$$ S = \\begin{pmatrix} -1  1  0  0 \\\\ 1  -1  -1  1 \\\\ 0  0  1  -1 \\end{pmatrix} $$\n\n系统的动态演化由常微分方程组 (ODEs) $\\frac{dx}{dt} = S v(x)$ 描述：\n$$ \\frac{dx_A}{dt} = -v_1 + v_2 = -k_1 x_A + k_{-1} x_B $$\n$$ \\frac{dx_B}{dt} = v_1 - v_2 - v_3 + v_4 = k_1 x_A - k_{-1} x_B - k_2 x_B + k_{-2} x_C $$\n$$ \\frac{dx_C}{dt} = v_3 - v_4 = k_2 x_B - k_{-2} x_C $$\n\n在稳态（平衡）时，浓度是恒定的，因此 $\\frac{dx}{dt} = 0$。我们寻求一个正平衡向量 $x^* = (x_A^*, x_B^*, x_C^*)^T$（其中 $x_i^* > 0$），该向量满足代数方程组 $S v(x^*) = 0$：\n1.  $-k_1 x_A^* + k_{-1} x_B^* = 0$\n2.  $k_1 x_A^* - (k_{-1} + k_2) x_B^* + k_{-2} x_C^* = 0$\n3.  $k_2 x_B^* - k_{-2} x_C^* = 0$\n\n化学计量矩阵 S 的各行是线性相关的，因为它们的和是零向量。这意味着这个三方程系统只有两个独立方程。我们可以选择第一个和第三个方程，它们更简单：\n由(1)得：$k_1 x_A^* = k_{-1} x_B^*$\n由(3)得：$k_2 x_B^* = k_{-2} x_C^*$\n\n这两个方程定义了一条可能的平衡点线。通过施加问题中指定的守恒定律，可以找到唯一解。该网络是封闭的，其化学计量意味着对于任何反应，分子总数是守恒的。因此，总浓度 $T$ 随时间保持恒定：\n4. $x_A(t) + x_B(t) + x_C(t) = T$\n问题指出这个守恒量是 $T = 95\\,\\mu\\mathrm{M}$。在平衡时，我们有：\n$x_A^* + x_B^* + x_C^* = T$\n\n我们现在得到了一个关于三个未知数 $x_A^*, x_B^*, x_C^*$ 的三个独立线性方程组。我们将 $x_A^*$ 和 $x_C^*$ 表示为 $x_B^*$ 的函数：\n$$ x_A^* = \\frac{k_{-1}}{k_1} x_B^* $$\n$$ x_C^* = \\frac{k_2}{k_{-2}} x_B^* $$\n将这些表达式代入守恒方程(4)：\n$$ \\left(\\frac{k_{-1}}{k_1}\\right) x_B^* + x_B^* + \\left(\\frac{k_2}{k_{-2}}\\right) x_B^* = T $$\n提取因子 $x_B^*$：\n$$ x_B^* \\left(1 + \\frac{k_{-1}}{k_1} + \\frac{k_2}{k_{-2}}\\right) = T $$\n求解 $x_B^*$：\n$$ x_B^* = \\frac{T}{1 + \\frac{k_{-1}}{k_1} + \\frac{k_2}{k_{-2}}} $$\n问题要求的是 $x_C^*$。我们使用以 $x_B^*$ 表示 $x_C^*$ 的表达式：\n$$ x_C^* = \\frac{k_2}{k_{-2}} x_B^* = \\frac{k_2}{k_{-2}} \\left( \\frac{T}{1 + \\frac{k_{-1}}{k_1} + \\frac{k_2}{k_{-2}}} \\right) $$\n现在，我们代入给定的数值：$k_1 = 2.4$、$k_{-1} = 1.2$、$k_2 = 3.6$、$k_{-2} = 1.2$（单位为 $\\mathrm{s}^{-1}$），以及 $T = 95\\,\\mu\\mathrm{M}$。\n首先，计算无量纲比率：\n$$ \\frac{k_{-1}}{k_1} = \\frac{1.2}{2.4} = 0.5 $$\n$$ \\frac{k_2}{k_{-2}} = \\frac{3.6}{1.2} = 3 $$\n将这些比率代入 $x_C^*$ 的表达式中：\n$$ x_C^* = 3 \\left( \\frac{95}{1 + 0.5 + 3} \\right) = 3 \\left( \\frac{95}{4.5} \\right) $$\n$$ x_C^* = \\frac{285}{4.5} = \\frac{2850}{45} = \\frac{570}{9} = 63.333\\ldots $$\n$x_C^*$ 的值必须以微摩尔 ($\\mu\\mathrm{M}$) 为单位报告，并四舍五入到四位有效数字。\n$$ x_C^* \\approx 63.33\\,\\mu\\mathrm{M} $$\n最终数值答案是 $63.33$。",
            "answer": "$$\n\\boxed{63.33}\n$$"
        },
        {
            "introduction": "更深入的分析使我们能够在不依赖具体反应速率常数的情况下，仅通过网络结构来预测其动态行为的可能性。这种强大的方法根植于化学反应网络理论，它关注的是网络本身的“连接图”。本练习将引导您探索网络亏格($\\delta$)和弱可逆性等核心概念，并运用亏格为零定理来判断系统是否保证在任何动力学参数下都具有唯一的稳定平衡点。",
            "id": "3291054",
            "problem": "考虑由反应 $A \\rightleftharpoons B$ 和 $2B \\to A + B$ 给出的、关于物种 $A$ 和 $B$ 的生物化学反应网络。使用质量作用动力学和化学计量分析的框架。\n\n从复合物、联动类和化学计量子空间的核心定义出发，执行以下步骤，不使用任何预先给出的简化公式：\n\n- 识别复合物集合并确定不同复合物的数量。\n- 通过构建复合物上的无向图来确定联动类的数量，其中如果相应复合物之间存在反应，则绘制一条无向边。\n- 为每个反应构建化学计量变化向量，并确定由这些向量张成的化学计量子空间的维数。\n- 使用网络亏格的定义（一个由复合物数量、联动类数量和化学计量子空间维数决定的属性），计算亏格 $\\delta$。\n- 使用弱可逆性的定义（在复合物的有向反应图中，联动类层面的强连通性），确定该网络是否是弱可逆的。\n- 使用化学反应网络理论中亏格零定理的标准准则（即亏格为零和弱可逆性），推断该网络是否满足这些条件。\n\n为确保最终答案是单个数值，将您的结论编码为整数\n$$C \\;=\\; \\delta \\;+\\; 2\\,\\chi_{\\mathrm{WR}} \\;+\\; 4\\,\\chi_{\\mathrm{DZ}},$$\n其中，如果网络是弱可逆的，则 $\\chi_{\\mathrm{WR}}$ 等于 $1$，否则等于 $0$；如果网络满足亏格零定理的条件，则 $\\chi_{\\mathrm{DZ}}$ 等于 $1$，否则等于 $0$。仅报告 $C$ 的值作为您的最终答案。无需四舍五入，也无需报告单位。",
            "solution": "我们从化学反应网络理论的第一性原理出发。复合物是物种的形式线性组合，在至少一个反应中作为反应物或产物出现。联动类是一个无向图的连通分量，该图的顶点是复合物，如果两个复合物之间至少存在一个反应（任一方向），则它们之间存在一条无向边。化学计量子空间是由反应的化学计量变化向量张成的线性子空间。亏格是由复合物数量、联动类数量和化学计量子空间维数决定的非负整数。如果复合物上的有向反应图的每个连通分量都是强连通的，则称网络是弱可逆的。化学反应网络理论中的亏格零定理要求网络亏格为零且是弱可逆的。\n\n步骤 $1$：识别复合物。反应为 $A \\to B$、$B \\to A$ 和 $2B \\to A + B$。出现的复合物是 $A$、$B$、$2B$ 和 $A + B$。因此，复合物集合是 $\\{A, B, 2B, A + B\\}$，复合物的数量为 $n = 4$。\n\n步骤 $2$：确定联动类。在 $n = 4$ 个复合物上构建无向图，如果一个反应在任一方向上连接它们，则在它们之间画一条边。在 $A$ 和 $B$ 之间存在一条无向边，因为 $A \\to B$ 和 $B \\to A$ 都存在。在 $2B$ 和 $A + B$ 之间存在一条无向边，因为有反应 $2B \\to A + B$。没有反应连接 $\\{A, B\\}$ 和 $\\{2B, A + B\\}$，因此在这两个集合之间没有边。因此，该无向图有两个连通分量，即 $\\{A, B\\}$ 和 $\\{2B, A + B\\}$。所以，联动类的数量为 $l = 2$。\n\n步骤 $3$：构建化学计量变化向量并计算化学计量子空间的维数。设物种顺序为 $(A, B)$。对于每个反应，化学计量变化向量是产物复合物减去反应物复合物，在 $(A, B)$ 中按分量解释。\n\n- 对于 $A \\to B$，反应物复合物对应于 $(1, 0)$，产物复合物对应于 $(0, 1)$，所以变化向量是 $(0, 1) - (1, 0) = (-1, 1)$。\n- 对于 $B \\to A$，变化向量是 $(1, 0) - (0, 1) = (1, -1)$。\n- 对于 $2B \\to A + B$，反应物复合物对应于 $(0, 2)$，产物复合物对应于 $(1, 1)$，所以变化向量是 $(1, 1) - (0, 2) = (1, -1)$。\n\n变化向量的集合是 $\\{(-1, 1), (1, -1), (1, -1)\\}$。所有这些向量都在 $(1, -1)$ 的张成空间中，因为 $(-1, 1) = - (1, -1)$。因此，化学计量子空间是一维的，其维数为 $s = 1$。\n\n步骤 $4$：计算亏格 $\\delta$。根据定义，亏格由复合物数量、联动类数量和化学计量子空间的维数决定。使用 $n = 4$，$l = 2$ 和 $s = 1$，我们得到\n$$\\delta \\;=\\; n - l - s \\;=\\; 4 - 2 - 1 \\;=\\; 1.$$\n\n步骤 $5$：确定弱可逆性。如果在一个复合物上的有向反应图中，每个联动类都是强连通的，则该网络是弱可逆的。考虑这两个联动类：\n\n- 第一个联动类 $\\{A, B\\}$ 有有向边 $A \\to B$ 和 $B \\to A$。这个类是强连通的。\n- 第二个联动类 $\\{2B, A + B\\}$ 有有向边 $2B \\to A + B$，但没有从 $A + B$ 到 $2B$ 的反应。因此，没有从 $A + B$ 回到 $2B$ 的有向路径，所以这个类不是强连通的。\n\n因为至少有一个联动类不是强连通的，所以该网络不是弱可逆的。因此，$\\chi_{\\mathrm{WR}} = 0$。\n\n步骤 $6$：推断是否满足亏格零定理的条件。亏格零定理要求网络是弱可逆的且亏格为零。在这里，$\\delta = 1 \\neq 0$，并且网络不是弱可逆的。因此，这些条件不被满足，$\\chi_{\\mathrm{DZ}} = 0$。\n\n步骤 $7$：计算编码整数 $C$。使用编码公式\n$$C \\;=\\; \\delta \\;+\\; 2\\,\\chi_{\\mathrm{WR}} \\;+\\; 4\\,\\chi_{\\mathrm{DZ}},$$\n我们代入 $\\delta = 1$，$\\chi_{\\mathrm{WR}} = 0$ 和 $\\chi_{\\mathrm{DZ}} = 0$ 得到\n$$C \\;=\\; 1 \\;+\\; 2 \\cdot 0 \\;+\\; 4 \\cdot 0 \\;=\\; 1.$$\n\n因此，所要求的单个数值输出是 $1$。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}