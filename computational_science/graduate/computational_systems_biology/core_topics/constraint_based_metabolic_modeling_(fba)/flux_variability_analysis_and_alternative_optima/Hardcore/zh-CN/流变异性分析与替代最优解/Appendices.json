{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握通量变异性分析（FVA），我们必须首先从基本原理入手。在依赖自动化计算工具之前，通过手动分析一个简单的“玩具”网络，我们可以直观地理解通量平衡、约束和最优化之间的相互作用。这个练习  将引导你手动推导最优生物量，并计算一个特定反应的通量范围，从而揭示替代最优解空间是如何产生的。",
            "id": "3309703",
            "problem": "给定一个示例代谢网络，其设计旨在揭示通量平衡分析 (FBA) 下的替代最优解，并允许进行解析性的通量变异性分析 (FVA)。该网络包含内部代谢物 $S$、$A$、$C$ 和 $B$，以及一个生物量汇 $X$。通量的单位为毫摩尔每克干重每小时 (mmol gDW$^{-1}$ h$^{-1}$)。假设所有内部代谢物处于稳态，并且所有反应都是不可逆的。\n\n反应 (所有通量 $v_i \\geq 0$):\n- $v_1$: $\\varnothing \\rightarrow S$，边界为 $0 \\leq v_1 \\leq 10$。\n- $v_2$: $S \\rightarrow A$，边界为 $0 \\leq v_2$ (无有限上界)。\n- $v_3$: $A \\rightarrow B$，边界为 $0 \\leq v_3 \\leq 8$。\n- $v_4$: $S \\rightarrow C$，边界为 $0 \\leq v_4$ (无有限上界)。\n- $v_5$: $C \\rightarrow B$，边界为 $0 \\leq v_5 \\leq 8$。\n- $v_6$: $B \\rightarrow X$ (生物量合成)，边界为 $0 \\leq v_6$ (无有限上界)。\n- $v_7$: $A \\rightarrow \\varnothing$ (废物)，边界为 $0 \\leq v_7$ (无有限上界)。\n- $v_8$: $C \\rightarrow \\varnothing$ (废物)，边界为 $0 \\leq v_8$ (无有限上界)。\n\n对内部代谢物采用标准的稳态质量平衡，形式化为 $S v = 0$，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量，同时需满足给定的边界条件。FBA 问题是最大化线性目标 $c^{\\top} v$，其中 $c$ 选择生物量合成，即 $c^{\\top} v = v_6$。\n\n任务：\n1. 仅使用上述基本定义（稳态、线性边界和线性目标），推导 FBA 下的最优生物量值 $z^{\\star}$。\n2. 然后，在最优生物量水平下对反应 $v_3$ 进行解析性通量变异性分析 (FVA)，即在满足稳态约束、反应边界以及额外最优性约束 $v_6 = z^{\\star}$ 的条件下，最小化 $v_3$。\n3. 报告在最优生物量下 $v_3$ 的最小可行值。仅提供数值（不包括单位），不要四舍五入；给出精确值。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **内部代谢物：** $S, A, C, B$\n- **外部代谢物：** $\\varnothing$ (源/汇), $X$ (生物量)\n- **反应和通量 ($v_i$)：**\n  - $v_1$: $\\varnothing \\rightarrow S$\n  - $v_2$: $S \\rightarrow A$\n  - $v_3$: $A \\rightarrow B$\n  - $v_4$: $S \\rightarrow C$\n  - $v_5$: $C \\rightarrow B$\n  - $v_6$: $B \\rightarrow X$ (生物量合成)\n  - $v_7$: $A \\rightarrow \\varnothing$ (废物)\n  - $v_8$: $C \\rightarrow \\varnothing$ (废物)\n- **通量边界：**\n  - 所有通量都是不可逆的：对于所有 $i \\in \\{1, ..., 8\\}$，$v_i \\geq 0$。\n  - $0 \\leq v_1 \\leq 10$\n  - $0 \\leq v_3 \\leq 8$\n  - $0 \\leq v_5 \\leq 8$\n  - $v_2, v_4, v_6, v_7, v_8$ 没有有限上界，只有 $v_i \\geq 0$。\n- **约束：** 所有内部代谢物处于稳态，导出质量平衡方程 $S v = 0$。\n- **目标函数：** 最大化生物量合成通量 $v_6$。\n- **任务：**\n  1. 求出最优生物量值 $z^{\\star} = \\max(v_6)$。\n  2. 通过在附加约束 $v_6 = z^{\\star}$ 下找到 $v_3$ 的最小可行值，对 $v_3$ 进行通量变异性分析 (FVA)。\n  3. 报告 $v_3$ 的最小值。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是通量平衡分析 (FBA) 和通量变异性分析 (FVA) 的标准应用，这是计算系统生物学和代谢工程中的核心、成熟方法。该示例网络是一种常见的教学工具。该问题在科学上是合理的。\n- **适定性：** 该问题被表述为一个线性规划 (LP) 问题，众所周知这是适定的。约束是线性的，目标是变量的线性函数。可行域是一个凸多胞体，并且保证解的存在。\n- **客观性：** 问题使用精确的数学和生物学术语进行陈述。没有主观或模糊的陈述。所有术语都是该领域的标准术语。\n- **完整性与一致性：** 提供了所有必要的信息（反应、边界、目标）。给定的数据中没有矛盾。问题是自洽的。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的。它是在指定领域内的一个适定的、有科学依据的、客观的问题。我现在将继续进行一个完整的、有理有据的求解。\n\n### 求解\n\n第一步是建立问题的数学公式。在稳态下，每种内部代谢物的生成速率必须等于其消耗速率。这给出了一个线性方程组，表示为 $S v = 0$，其中 $S$ 是化学计量矩阵，$v$ 是通量向量。\n\n对于给定的网络，内部代谢物 $S$、$A$、$C$ 和 $B$ 的质量平衡方程如下：\n1. 对于代谢物 $S$: $v_1 - v_2 - v_4 = 0 \\implies v_1 = v_2 + v_4$\n2. 对于代谢物 $A$: $v_2 - v_3 - v_7 = 0 \\implies v_2 = v_3 + v_7$\n3. 对于代谢物 $C$: $v_4 - v_5 - v_8 = 0 \\implies v_4 = v_5 + v_8$\n4. 对于代谢物 $B$: $v_3 + v_5 - v_6 = 0 \\implies v_6 = v_3 + v_5$\n\n问题受到所有 $i$ 的不可逆约束 $v_i \\geq 0$ 以及特定边界 $0 \\leq v_1 \\leq 10$，$0 \\leq v_3 \\leq 8$ 和 $0 \\leq v_5 \\leq 8$ 的限制。\n\n**第 1 部分：推导最优生物量值 ($z^{\\star}$)**\n\n通量平衡分析 (FBA) 的目标是最大化生物量通量 $v_6$。\n根据方程 (4)，目标函数为 $v_6 = v_3 + v_5$。我们需要最大化这个和。\n\n让我们用系统的输入通量 $v_1$ 来表示目标函数。我们可以将方程 (2) 和 (3) 中 $v_2$ 和 $v_4$ 的表达式代入方程 (1)：\n$v_1 = (v_3 + v_7) + (v_5 + v_8)$\n\n整理各项：\n$v_1 = (v_3 + v_5) + (v_7 + v_8)$\n\n现在，代入 $v_6 = v_3 + v_5$：\n$v_1 = v_6 + v_7 + v_8$\n\n这个方程可以重新整理，用其他通量来表示目标 $v_6$：\n$v_6 = v_1 - v_7 - v_8$\n\n为了最大化 $v_6$，我们必须在各自边界条件下最大化 $v_1$ 并最小化 $v_7$ 和 $v_8$。\n- $v_1$ 的上界是 $10$。为了最大化 $v_6$，我们将 $v_1$ 设为其最大值：$v_1 = 10$。\n- $v_7$ 的下界是 $0$ (来自 $v_7 \\geq 0$)。为了最大化 $v_6$，我们将 $v_7$ 设为其最小值：$v_7 = 0$。\n- $v_8$ 的下界是 $0$ (来自 $v_8 \\geq 0$)。为了最大化 $v_6$，我们将 $v_8$ 设为其最小值：$v_8 = 0$。\n\n这给出了 $v_6$ 最大值的候选值：\n$v_{6, \\text{max}} = 10 - 0 - 0 = 10$\n\n我们必须验证是否存在一个通量分布，在 $v_6 = 10$ 的情况下满足所有约束。换句话说，这种状态是否可行？\n如果 $v_6 = 10$，那么根据 $v_6 = v_3 + v_5$，我们有 $v_3 + v_5 = 10$。\n问题约束包括 $0 \\leq v_3 \\leq 8$ 和 $0 \\leq v_5 \\leq 8$。\n一个解需要找到满足所有三个条件的 $v_3$ 和 $v_5$：\n1. $v_3 + v_5 = 10$\n2. $0 \\leq v_3 \\leq 8$\n3. $0 \\leq v_5 \\leq 8$\n\n从 $v_3+v_5=10$，我们可以写出 $v_5 = 10 - v_3$。将此代入 $v_5$ 的边界条件，得到：\n$0 \\leq 10 - v_3 \\leq 8$\n这产生了关于 $v_3$ 的两个不等式：\n- $10 - v_3 \\geq 0 \\implies v_3 \\leq 10$\n- $10 - v_3 \\leq 8 \\implies 2 \\leq v_3$\n所以，根据对 $v_5$ 的约束，我们要求 $v_3 \\in [2, 10]$。\n\n将此与对 $v_3$ 的直接约束 $v_3 \\in [0, 8]$ 相结合，我们通过取两个区间的交集来找到 $v_3$ 的可行范围：$[2, 10] \\cap [0, 8] = [2, 8]$。\n由于这个区间非空，所以存在可行解。例如，如果我们选择 $v_3 = 5$，那么 $v_5 = 10 - 5 = 5$。这满足 $0 \\leq 5 \\leq 8$。完整的通量向量将是 $(v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8) = (10, 5, 5, 5, 5, 10, 0, 0)$，这是一个有效的通量分布。\n\n因此，可实现的最大生物量通量是 $10$。\n$z^{\\star} = 10$\n\n**第 2 部分：对 $v_3$ 进行解析性通量变异性分析 (FVA)**\n\n任务是找到 $v_3$ 的最小可行值，同时维持最优的生物量生产，即在附加约束 $v_6 = z^{\\star} = 10$ 的条件下。这被表述为一个新的线性规划问题：\n\n最小化：$v_3$\n约束条件：\n1. 稳态质量平衡方程 $S v = 0$。\n2. 反应边界：$0 \\leq v_1 \\leq 10$，$0 \\leq v_3 \\leq 8$，$0 \\leq v_5 \\leq 8$，以及 $v_2, v_4, v_6, v_7, v_8 \\geq 0$。\n3. 最优性约束：$v_6 = 10$。\n\n正如在 FBA 步骤中确定的，$v_1 = v_6 + v_7 + v_8$、$v_1 \\leq 10$、$v_6=10$、$v_7 \\geq 0$ 和 $v_8 \\geq 0$ 的组合迫使 $v_7 = 0$ 和 $v_8 = 0$，这又进而迫使 $v_1 = 10$。\n\n因此，问题简化为在定义替代最优解的约束集下找到最小的 $v_3$。我们在第 1 部分检查可行性时已经推导出了这组约束。确保在 $v_6=10$ 时存在可行解的对 $v_3$ 的约束是：\n- $v_3 + v_5 = 10$\n- $0 \\leq v_3 \\leq 8$\n- $0 \\leq v_5 \\leq 8$\n\n如前所示，结合这些约束可以得出 $v_3$ 的可行范围：\n$2 \\leq v_3 \\leq 8$\n\n问题是在这个可行范围内最小化 $v_3$。在区间 $[2, 8]$ 中的最小值是 $2$。\n\n**第 3 部分：报告 $v_3$ 的最小值**\n\n在最优生物量水平 $z^{\\star}=10$ 时，通量 $v_3$ 的最小可行值是 $2$。\n对于这个最小值 $v_3 = 2$，对应的 $v_5$ 值为 $v_5 = 10 - 2 = 8$。这是一个有效的通量分布，具体为 $(v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8) = (10, 2, 2, 8, 8, 10, 0, 0)$。所有通量边界都得到满足。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "从解析推导过渡到计算实现是系统生物学建模的关键一步。这个练习  将指导你使用编程来执行 FBA 和 FVA，并探究一个核心建模假设——反应方向性——如何影响预测的代谢灵活性。通过比较可逆与不可逆反应模型，你将亲身体会到施加更严格的生物化学约束如何缩小甚至消除替代最优解空间。",
            "id": "3309643",
            "problem": "考虑一个由反应通量的线性约束建模的稳态代谢网络，其中未知通量向量为 $v \\in \\mathbb{R}^n$，化学计量矩阵为 $S \\in \\mathbb{R}^{m \\times n}$。稳态假设施加了质量平衡约束 $$S\\,v = 0.$$ 在一个代表伪代谢物“生物量”生产速率的线性目标函数 $c^\\top v$ 下，通量平衡分析 (FBA) 旨在寻找一个通量向量 $v$，使其在满足质量平衡和边界约束的条件下，最大化标量 $c^\\top v$。通量变异性分析 (FVA) 则通过计算每个反应 $i$ 的 $v_i$ 的最小和最大可达值来量化替代最优解。这些计算需满足相同的约束条件，并额外增加一个强制执行最优目标值的等式约束 $$c^\\top v = z^\\star,$$ 其中 $z^\\star$ 是从 FBA 获得的最优值。\n\n使用以下包含 $m = 4$ 种代谢物和 $n = 6$ 个反应的小型网络。代谢物为 $A$、$B$、$C$ 和生物量 (Biomass)。反应如下：\n- $R_1$：摄取 $A$，\n- $R_2$：转化 $A \\rightarrow B$，\n- $R_3$：转化 $A \\rightarrow C$，\n- $R_4$：转化 $B \\rightarrow \\text{Biomass}$，\n- $R_5$：转化 $C \\rightarrow \\text{Biomass}$，\n- $R_6$：排出生物量（目标反应）。\n\n化学计量矩阵 $S \\in \\mathbb{R}^{4 \\times 6}$ 为\n$$\nS = \\begin{bmatrix}\n1  -1  -1  0  0  0 \\\\\n0  1  0  -1  0  0 \\\\\n0  0  1  0  -1  0 \\\\\n0  0  0  1  1  -1\n\\end{bmatrix}.\n$$\n目标向量 $c \\in \\mathbb{R}^6$ 为\n$$\nc = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix},\n$$\n以便在 FBA 中最大化 $c^\\top v = v_6$。\n\n您将比较两种边界体系：\n- 体系 $\\mathcal{R}_{\\text{rev}}$ (可逆内部反应)：内部转化被允许在有限边界内可逆。\n- 体系 $\\mathcal{R}_{\\text{irrev}}$ (强制不可逆性)：内部转化被限制为非负。\n\n设内部反应的公共上界常数为 $U_{\\max} = 100$。对于每个测试用例，摄取边界和一个内部旁路边界是参数化的。具体来说，每个体系的边界定义如下。\n- 在体系 $\\mathcal{R}_{\\text{rev}}$ 中：\n  - $R_1$：$0 \\le v_1 \\le U_{\\text{uptake}}$，\n  - $R_2$：$-U_{\\max} \\le v_2 \\le U_{\\max}$，\n  - $R_3$：$-U_{\\max} \\le v_3 \\le U_{\\max}$，\n  - $R_4$：$-U_{\\max} \\le v_4 \\le U_{\\max}$，\n  - $R_5$：$-U_{\\max} \\le v_5 \\le U_{\\max}$，\n  - $R_6$：$0 \\le v_6 \\le U_{\\max}$。\n- 在体系 $\\mathcal{R}_{\\text{irrev}}$ 中：\n  - $R_1$：$0 \\le v_1 \\le U_{\\text{uptake}}$，\n  - $R_2$：$0 \\le v_2 \\le U_{\\max}$，\n  - $R_3$：$0 \\le v_3 \\le U_{\\max}$，\n  - $R_4$：$0 \\le v_4 \\le U_{\\max}$，\n  - $R_5$：$0 \\le v_5 \\le U_{\\max}$，\n  - $R_6$：$0 \\le v_6 \\le U_{\\max}$。\n\n目标是在两种体系下计算 FVA 范围。对于每个体系，执行 FBA 以获得最优目标值 $z^\\star$，然后通过求解以下问题来执行 FVA，针对每个反应索引 $i \\in \\{1,2,3,4,5,6\\}$：\n- 最小化问题 $$\\min_{v} \\; v_i \\quad \\text{约束条件} \\quad S\\,v = 0, \\;\\; c^\\top v = z^\\star, \\;\\; \\text{体系的边界},$$\n- 最大化问题 $$\\max_{v} \\; v_i \\quad \\text{约束条件} \\quad S\\,v = 0, \\;\\; c^\\top v = z^\\star, \\;\\; \\text{体系的边界}.$$\n\n将一个体系中反应 $i$ 的 FVA 范围宽度定义为 $$w_i = (\\max v_i) - (\\min v_i).$$\n\n为了说明方向性的作用，您将运行一个测试套件，该套件改变摄取边界 $U_{\\text{uptake}}$，并在体系 $\\mathcal{R}_{\\text{rev}}$ 中通过可逆边界允许内部反应的对称性，而在体系 $\\mathcal{R}_{\\text{irrev}}$ 中强制非负性。对于每个测试用例，检查强制不可逆性是否不会增加任何反应的 FVA 宽度，即验证 $$w_i^{(\\mathcal{R}_{\\text{irrev}})} \\le w_i^{(\\mathcal{R}_{\\text{rev}})} \\quad \\text{对所有 } i.$$ 每个测试用例的最终答案应为一个布尔值，指示该不等式是否对所有反应都成立。\n\n使用以下参数值测试套件，其中每个用例由 $(U_{\\text{uptake}}, U_7)$ 给出，$U_7$ 是体系 $\\mathcal{R}_{\\text{rev}}$ 中内部转化的对称可逆边界大小，也是体系 $\\mathcal{R}_{\\text{irrev}}$ 中相同反应的非负上界：\n- 用例 1：$(10, 100)$，\n- 用例 2：$(10, 0)$，\n- 用例 3：$(0, 100)$，\n- 用例 4：$(5, 1)$。\n\n您的程序必须：\n- 实现所述的 FBA 和 FVA 计算。\n- 对于每个测试用例，使用给定的参数和 $U_{\\max} = 100$ 为两种体系构建边界。\n- 生成一行输出，其中包含一个逗号分隔并用方括号括起来的结果列表，例如，$$[ \\text{result}_1, \\text{result}_2, \\text{result}_3, \\text{result}_4 ]$$ 其中每个 $\\text{result}_k$ 是对应于用例 $k$ 的一个布尔值。\n\n所有优化问题都必须作为线性规划精确求解；不使用角度，输出中也没有物理单位转换，因为最终结果是布尔值。",
            "solution": "该问题要求对一个小规模代谢网络在两种不同反应边界设定下的通量变异性分析（FVA）结果进行比较分析：一种是内部反应可逆（$\\mathcal{R}_{\\text{rev}}$），另一种是内部反应不可逆（$\\mathcal{R}_{\\text{irrev}}$）。任务的核心是实现通量平衡分析（FBA）和 FVA 程序，并针对一组给定的测试用例，验证一个关于所得通量变异性范围的假设。\n\n首先，我们将问题形式化为一系列线性规划（LP）。代谢网络由其化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 定义，其中 $m=4$ 是代谢物数量，$n=6$ 是反应数量。反应通量向量为 $v \\in \\mathbb{R}^6$。稳态假设施加了线性等式约束 $S v = 0$。\n\n化学计量矩阵 $S$ 如下所示：\n$$\nS = \\begin{bmatrix}\n1  -1  -1  0  0  0 \\\\\n0  1  0  -1  0  0 \\\\\n0  0  1  0  -1  0 \\\\\n0  0  0  1  1  -1\n\\end{bmatrix}\n$$\n各行分别对应代谢物 $A$、$B$、$C$ 和生物量。各列对应反应 $R_1, \\dots, R_6$。$S$ 的零空间（即满足 $S v = 0$ 的向量 $v$）的解析分析揭示了以下依赖关系：\n$v_1 = v_2 + v_3$\n$v_2 = v_4$\n$v_3 = v_5$\n$v_6 = v_4 + v_5$\n将这些关系结合起来，可以得到适用于任何稳态通量向量的关键关系：$v_1 = v_6$。\n\nFBA 的目标函数是最大化生物量生产速率，即反应 $R_6$ 的通量。这由目标向量 $c = [0, 0, 0, 0, 0, 1]^\\top$ 定义，得到目标函数 $c^\\top v = v_6$。\n\n问题为通量向量 $v$ 指定了参数化边界。关于内部反应的边界，问题陈述中存在一个小的歧义。问题首先声明了一个通用上界常数 $U_{\\max} = 100$，但随后在测试用例中为“内部转化”（$R_2$、$R_3$、$R_4$、$R_5$）引入了一个参数 $U_7$。最合理的解释是，$U_7$ 覆盖了这些特定反应的边界，而其他边界（如 $R_6$ 的边界）仍由 $U_{\\max}$ 定义。因此，对于由元组 $(U_{\\text{uptake}}, U_7)$ 指定的测试用例，两种体系的边界定义如下：\n\n体系 $\\mathcal{R}_{\\text{rev}}$（可逆）：\n$l_b^{(\\text{rev})} = [0, -U_7, -U_7, -U_7, -U_7, 0]^\\top$\n$u_b^{(\\text{rev})} = [U_{\\text{uptake}}, U_7, U_7, U_7, U_7, 100]^\\top$\n\n体系 $\\mathcal{R}_{\\text{irrev}}$（不可逆）：\n$l_b^{(\\text{irrev})} = [0, 0, 0, 0, 0, 0]^\\top$\n$u_b^{(\\text{irrev})} = [U_{\\text{uptake}}, U_7, U_7, U_7, U_7, 100]^\\top$\n\n每个测试用例的求解过程包括以下步骤：\n1.  **FBA**：对于每个体系，求解 FBA 问题以找到最优目标值 $z^\\star$。\n    $$\n    z^\\star = \\max_{v} \\; v_6 \\quad \\text{s.t.} \\quad S v = 0, \\;\\; l_b \\le v \\le u_b\n    $$\n    这是一个标准的 LP。基于化学计量依赖关系 $v_1 = v_6$ 以及边界 $0 \\le v_1 \\le U_{\\text{uptake}}$ 和 $v_6 = v_2 + v_3 \\le ub_2 + ub_3$，最优目标值可以通过解析确定为 $z^\\star = \\min(U_{\\text{uptake}}, 2U_7)$。对于 $\\mathcal{R}_{\\text{rev}}$ 和 $\\mathcal{R}_{\\text{irrev}}$， $v_2$ 和 $v_3$ 的上界都是 $U_7$。因此，对于两种体系，$z^\\star = \\min(U_{\\text{uptake}}, 2U_7)$。这是一个至关重要的发现，因为它意味着两种体系的 FVA 都是在相同的最优目标值约束下进行的。\n\n2.  **FVA**：对于每个体系，以及每个反应 $i \\in \\{1, \\dots, 6\\}$，求解两个 LP 以找到最小和最大可能通量 $v_i$。\n    $$\n    \\min_{v} / \\max_{v} \\; v_i \\quad \\text{s.t.} \\quad S v = 0, \\;\\; c^\\top v = z^\\star, \\;\\; l_b \\le v \\le u_b\n    $$\n    附加约束 $c^\\top v = z^\\star$（即 $v_6 = z^\\star$）将解空间限制为仅那些能实现最大生物量产量的通量分布。\n\n3.  **宽度计算**：对于每个反应 $i$，计算两种体系的 FVA 范围宽度 $w_i = (\\max v_i) - (\\min v_i)$，得到 $w_i^{(\\mathcal{R}_{\\text{rev}})}$ 和 $w_i^{(\\mathcal{R}_{\\text{irrev}})}$。\n\n4.  **验证**：检查条件 $w_i^{(\\mathcal{R}_{\\text{irrev}})} \\le w_i^{(\\mathcal{R}_{\\text{rev}})}$ 是否对所有 $i \\in \\{1, \\dots, 6\\}$ 都成立。该测试用例的结果是一个表示此验证结果的布尔值。\n\n理论上，条件 $w_i^{(\\mathcal{R}_{\\text{irrev}})} \\le w_i^{(\\mathcal{R}_{\\text{rev}})}$ 预期成立。不可逆体系中 FVA 线性规划的可行集（我们称之为 $V_{\\text{irrev}}$）是可逆体系中可行集（$V_{\\text{rev}}$）的一个子集，因为不可逆约束（$v_i \\ge 0$）比可逆约束（$v_i \\ge -U_7$）更严格，并且我们已经证明两种体系的 $z^\\star$ 是相同的。对于任何凸集 $A$，如果它是凸集 $B$ 的子集（$A \\subseteq B$），那么 $A$ 的任何坐标投影的范围必须包含在 $B$ 的相应投影范围内或与之相等。因此，$A$ 的范围宽度不能超过 $B$ 的范围宽度。这确保了该假设对所有测试用例都成立。下面的实现通过计算验证了这一原则。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the FBA/FVA problem for a series of test cases.\n    For each case, it computes FVA widths for a reversible and an irreversible regime,\n    then verifies if the irreversible widths are less than or equal to the reversible ones.\n    \"\"\"\n    \n    # Stoichiometric matrix S for m=4 metabolites and n=6 reactions.\n    S = np.array([\n        [1., -1., -1., 0., 0., 0.],  # Metabolite A\n        [0., 1., 0., -1., 0., 0.],   # Metabolite B\n        [0., 0., 1., 0., -1., 0.],   # Metabolite C\n        [0., 0., 0., 1., 1., -1.]    # Metabolite Biomass\n    ])\n    \n    # Objective vector c to maximize v_6 (flux of R6).\n    c_obj = np.array([0., 0., 0., 0., 0., 1.])\n    \n    n_reactions = 6\n    n_metabolites = 4\n    \n    # Common upper bound for the biomass drain reaction R6.\n    U_max = 100.\n    \n    # Test suite of parameters (U_uptake, U_7).\n    test_cases = [\n        (10., 100.),\n        (10., 0.),\n        (0., 100.),\n        (5., 1.)\n    ]\n\n    results = []\n    \n    for U_uptake, U_7 in test_cases:\n        # Define bounds for the two regimes based on test case parameters.\n        # Regime R_rev (reversible internal reactions)\n        bounds_rev = [\n            (0., U_uptake),      # R1: Uptake\n            (-U_7, U_7),         # R2: A -> B\n            (-U_7, U_7),         # R3: A -> C\n            (-U_7, U_7),         # R4: B -> Biomass\n            (-U_7, U_7),         # R5: C -> Biomass\n            (0., U_max)         # R6: Biomass drain\n        ]\n\n        # Regime R_irrev (irreversible internal reactions)\n        bounds_irrev = [\n            (0., U_uptake),      # R1\n            (0., U_7),           # R2\n            (0., U_7),           # R3\n            (0., U_7),           # R4\n            (0., U_7),           # R5\n            (0., U_max)          # R6\n        ]\n\n        # Calculate FVA widths for both regimes\n        widths_rev = calculate_fva_widths(S, c_obj, bounds_rev, n_reactions, n_metabolites)\n        widths_irrev = calculate_fva_widths(S, c_obj, bounds_irrev, n_reactions, n_metabolites)\n        \n        # Verify the condition: w_irrev = w_rev for all reactions.\n        # A small tolerance is used for robust floating point comparison.\n        is_le = np.all(widths_irrev = widths_rev + 1e-9)\n        results.append(is_le)\n\n    # Format and print the final output.\n    print(f\"[{', '.join(map(str, results))}]\")\n\n\ndef calculate_fva_widths(S, c_obj, bounds, n_reactions, n_metabolites):\n    \"\"\"\n    Performs FBA and FVA to compute the width of the flux range for each reaction.\n    \"\"\"\n    # 1. Flux Balance Analysis (FBA)\n    # We want to maximize c_obj.T @ v, which is equivalent to minimizing -c_obj.T @ v.\n    b_eq_fba = np.zeros(n_metabolites)\n    res_fba = linprog(c=-c_obj, A_eq=S, b_eq=b_eq_fba, bounds=bounds, method='highs')\n\n    # If FBA is infeasible or fails, FVA cannot be performed.\n    # Based on problem analysis, FBA is always feasible for the given cases.\n    if not res_fba.success:\n        # This case suggests an issue (e.g., infeasibility), return zero-widths.\n        return np.zeros(n_reactions)\n        \n    z_star = -res_fba.fun\n    \n    # 2. Flux Variability Analysis (FVA)\n    # Augment constraints with the FBA optimum: c_obj.T @ v = z_star\n    A_eq_fva = np.vstack([S, c_obj])\n    b_eq_fva = np.zeros(n_metabolites + 1)\n    b_eq_fva[-1] = z_star\n    \n    widths = np.zeros(n_reactions)\n    \n    for i in range(n_reactions):\n        # Minimize v_i\n        c_fva_min = np.zeros(n_reactions)\n        c_fva_min[i] = 1.\n        res_min = linprog(c=c_fva_min, A_eq=A_eq_fva, b_eq=b_eq_fva, bounds=bounds, method='highs')\n        \n        # Maximize v_i (by minimizing -v_i)\n        c_fva_max = np.zeros(n_reactions)\n        c_fva_max[i] = -1.\n        res_max = linprog(c=c_fva_max, A_eq=A_eq_fva, b_eq=b_eq_fva, bounds=bounds, method='highs')\n        \n        v_min, v_max = 0., 0.\n        if res_min.success:\n            v_min = res_min.fun\n        if res_max.success:\n            v_max = -res_max.fun\n        \n        # Ensure max is not smaller than min due to numerical issues\n        if v_max  v_min:\n            v_max = v_min\n\n        widths[i] = v_max - v_min\n        \n    return widths\n\nsolve()\n```"
        },
        {
            "introduction": "FVA 常常揭示一个广阔的替代最优解空间，这提出了一个实际问题：在众多同样“最优”的通量分布中，哪一个最能代表真实的生物状态？这个高级练习  介绍了一种强大的方法——简约通量平衡分析（parsimonious FBA），它通过引入一个次级优化目标（最小化总通量）来从众多解中挑选出一个最高效的解。你将通过理论推导和计算实践，学习如何应用这种字典序优化方法来消除模糊性，并获得一个唯一的、更可能符合生物学现实的通量分布。",
            "id": "3309695",
            "problem": "给定一个稳态代谢网络，该网络被形式化为一个线性规划模型。其基本原理是，一个充分混合的稳态网络遵循线性质量平衡和容量约束，并且通量变异性分析是针对线性目标的最优解面进行的。具体来说，一个代谢网络由一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$、一个通量向量 $v \\in \\mathbb{R}^n$、下界和上界 $l \\in \\mathbb{R}^n$ 和 $u \\in \\mathbb{R}^n$（其中 $l \\le u$）以及一个线性目标系数向量 $c \\in \\mathbb{R}^n$ 指定。标准的稳态可行集为\n$$\n\\mathcal{F} = \\left\\{ v \\in \\mathbb{R}^n \\;\\middle|\\; S v = 0,\\; l \\le v \\le u \\right\\}.\n$$\n首要的生物质最大化问题是以下线性规划\n$$\n\\text{maximize } c^\\top v \\text{ subject to } v \\in \\mathcal{F}.\n$$\n通量变异性分析（FVA）将注意力限制在最优目标值 $Z^\\star = \\max_{v \\in \\mathcal{F}} c^\\top v$ 上，并为每个反应 $j$ 计算在最优解面\n$$\n\\mathcal{F}_{\\text{opt}} = \\left\\{ v \\in \\mathcal{F} \\;\\middle|\\; c^\\top v = Z^\\star \\right\\}\n$$\n上的最小和最大可达 $v_j$。\n反应 $j$ 的 FVA 范围宽度为 $w_j = \\max\\{v_j : v \\in \\mathcal{F}_{\\text{opt}}\\} - \\min\\{v_j : v \\in \\mathcal{F}_{\\text{opt}}\\}$。\n\n考虑一个字典序优化，它首先最大化 $c^\\top v$，然后在 $\\mathcal{F}_{\\text{opt}}$ 上最小化 $L_1$ 范数 $\\|v\\|_1 = \\sum_{i=1}^n |v_i|$。为了使第二步成为一个线性规划，引入辅助变量 $t_i \\ge 0$ 并施加约束 $-t_i \\le v_i \\le t_i$，这样最小化 $\\sum_i t_i$ 就等价于最小化 $\\|v\\|_1$。次要优化问题是\n$$\n\\text{minimize } \\sum_{i=1}^n t_i \\text{ subject to } S v = 0,\\; l \\le v \\le u,\\; c^\\top v = Z^\\star,\\; -t_i \\le v_i \\le t_i,\\; t_i \\ge 0\\; \\text{for all } i.\n$$\n您必须完成以下任务：\n- 从第一性原理出发，推导为什么在 $\\mathcal{F}_{\\text{opt}}$ 上最小化 $\\|v\\|_1$ 会选择至少一个作为最优解面极点的解。此推导必须从线性规划和凸多胞体的性质开始，并且除了 $S v = 0$、$l \\le v \\le u$ 和 $c^\\top v = Z^\\star$ 之外，不得假定任何特殊结构。\n- 以数学上明确的方式，量化当限制在 $\\mathcal{F}_{\\text{opt}}$ 内 $\\|v\\|_1$ 的最小化子集上时，具有对称边界的反应（即满足 $l_j = -u_j$ 且 $u_j  0$ 的反应 $j$）的 FVA 宽度 $w_j$ 是如何减小的。您的量化必须将这种减小与约束的几何形状联系起来，并在适用时，为简单循环场景提供一个封闭形式的表征，其中反应 $j$ 仅出现在 $v_j = \\alpha + x$ 的线性关系中，其中 $x$ 是一个自由循环通量，$\\alpha \\ge 0$ 在 $\\mathcal{F}_{\\text{opt}}$ 上是固定的。\n\n实现一个程序，对以下每个测试用例执行：\n$1.$ 计算所有反应在 $\\mathcal{F}_{\\text{opt}}$ 上的 $Z^\\star$ 和原始 FVA 宽度 $w_j$。\n$2.$ 使用辅助变量公式计算在 $\\mathcal{F}_{\\text{opt}}$ 上 $\\sum_i t_i$ 的一个最小化子 $(v^\\star, t^\\star)$。\n$3.$ 计算限制在 $\\sum_i t_i$ 最小化子集上的所有反应的 FVA 宽度 $w^{\\text{L1}}_j$，通过为每个反应 $j$ 的线性规划添加等式约束 $\\sum_i t_i = \\sum_i t^\\star_i$ 来实现。\n$4.$ 计算 FVA 宽度的总减少量，定义为\n$$\nR = \\sum_{j \\in \\mathcal{J}_{\\text{sym}}} \\left( w_j - w^{\\text{L1}}_j \\right),\n$$\n其中 $\\mathcal{J}_{\\text{sym}} = \\{ j \\mid l_j = -u_j,\\; u_j  0 \\}$ 是具有对称边界的反应的索引集。\n\n测试套件：\n- 案例 A（通过单个内部循环产生的替代最优解）：$m = 3$，$n = 5$，代谢物 $\\{A,B,C\\}$，反应 $\\{R_1,\\dots,R_5\\}$，化学计量矩阵为\n$$\nS = \\begin{bmatrix}\n+1  -1  0  0  +1 \\\\\n0  +1  -1  0  -1 \\\\\n0  0  +1  -1  0\n\\end{bmatrix},\n$$\n目标 $c = [0, 0, 0, 1, 0]^\\top$，边界 $l = [0, -20, 0, 0, -5]^\\top$, $u = [10, 20, 10, 100, 5]^\\top$。\n- 案例 B（唯一最优解，无循环）：$m = 3$，$n = 4$，代谢物 $\\{A,B,C\\}$，反应 $\\{R_1,\\dots,R_4\\}$，化学计量矩阵为\n$$\nS = \\begin{bmatrix}\n+1  -1  0  0 \\\\\n0  +1  -1  0 \\\\\n0  0  +1  -1\n\\end{bmatrix},\n$$\n目标 $c = [0, 0, 0, 1]^\\top$，边界 $l = [0, 0, 0, 0]^\\top$, $u = [10, 10, 10, 100]^\\top$。\n- 案例 C（两个独立循环，一个与摄取耦合，一个自由）：$m = 5$，$n = 7$，代谢物 $\\{A,B,C,D,E\\}$，反应 $\\{R_1,\\dots,R_5,R_7,R_8\\}$，化学计量矩阵为\n$$\nS = \\begin{bmatrix}\n+1  -1  +1  0  0  0  0 \\\\\n0  +1  -1  -1  0  0  0 \\\\\n0  0  0  +1  -1  0  0 \\\\\n0  0  0  0  0  -1  +1 \\\\\n0  0  0  0  0  +1  -1\n\\end{bmatrix},\n$$\n目标 $c = [0, 0, 0, 0, 1, 0, 0]^\\top$，边界 $l = [0, -20, -20, 0, 0, -5, -5]^\\top$, $u = [10, 20, 20, 10, 100, 5, 5]^\\top$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[R_A, R_B, R_C]$，其中 $R_A$、$R_B$ 和 $R_C$ 分别是案例 A、B 和 C 的总减少量 $R$。所有报告值必须是不带任何单位的实数。不允许用户输入；所有数据必须嵌入程序中。求解器容差必须强制执行指定的精确等式，即，在您设置的线性规划中，$c^\\top v = Z^\\star$ 和 $\\sum_i t_i = \\sum_i t^\\star_i$ 是等式约束。使用上述辅助变量 $t_i$ 实现 $L_1$ 范数最小化，并计算在有和没有 $L_1$ 最小化约束集的情况下的 FVA 宽度。",
            "solution": "问题陈述经评估为**有效**。它在基于约束的代谢建模这一成熟领域具有科学依据，在数学上是适定的，提供了完整且一致的数据和定义集，并且表述客观。所要求的任务，既涉及理论推导，也涉及标准线性规划技术（通量变异性分析和 $L_1$ 范数最小化）的计算实现，是清晰且可行的。\n\n### 理论推导\n\n#### 1. $\\|v\\|_1$ 的最小化与最优解面的极点\n\n第一个指令的核心是证明，在主线性规划的最优解集上最小化 $L_1$ 范数将选择一个作为该解集极点（顶点）的解。\n\n设主优化问题为 $\\max_{v \\in \\mathcal{F}} c^\\top v$，其中可行集是凸多胞体 $\\mathcal{F} = \\{ v \\in \\mathbb{R}^n \\mid S v = 0,\\; l \\le v \\le u \\}$。最优目标值为 $Z^\\star$。所有最优解的集合，通常称为最优解面，由以下公式给出\n$$\n\\mathcal{F}_{\\text{opt}} = \\left\\{ v \\in \\mathcal{F} \\;\\middle|\\; c^\\top v = Z^\\star \\right\\}。\n$$\n$\\mathcal{F}_{\\text{opt}}$ 是多胞体 $\\mathcal{F}$ 与由 $c^\\top v = Z^\\star$ 定义的超平面的交集。凸多胞体与超平面的交集也是一个凸多胞体（可能维度更低）。因此，$\\mathcal{F}_{\\text{opt}}$ 是一个具有有限个极点的紧凸集。\n\n次要优化问题是在此最优解面上最小化通量向量 $v$ 的 $L_1$ 范数：\n$$\n\\text{minimize } \\|v\\|_1 \\text{ subject to } v \\in \\mathcal{F}_{\\text{opt}}.\n$$\n目标函数是 $f(v) = \\|v\\|_1 = \\sum_{i=1}^n |v_i|$。绝对值函数 $|x|$ 是凸函数，凸函数的和也是凸函数。因此，$f(v) = \\|v\\|_1$ 是一个凸函数。\n\n因此，我们面临的问题是在一个紧凸集 $\\mathcal{F}_{\\text{opt}}$ 上最小化一个凸函数 $f(v)$。凸分析中的一个基本结果，即 Bauer's maximum principle（及其用于最小化的推论），指出定义在紧凸集上的凸函数在该集合的某个极点上达到其最小值。\n\n设 $v_{\\text{L1}}^*$ 是 $L_1$ 最小化问题的一个解，即 $v_{\\text{L1}}^* \\in \\mathcal{F}_{\\text{opt}}$ 且对于所有 $v \\in \\mathcal{F}_{\\text{opt}}$ 都有 $\\|v_{\\text{L1}}^*\\|_1 \\le \\|v\\|_1$。根据该原理，这类最小化子的集合，我们称之为 $\\mathcal{F}_{\\text{L1-opt}}$，是非空的，并且存在 $\\mathcal{F}_{\\text{L1-opt}}$ 中至少一个点，它同时也是 $\\mathcal{F}_{\\text{opt}}$ 的一个极点。\n\n如果最小化子 $v_{\\text{L1}}^*$ 是唯一的，它必须是 $\\mathcal{F}_{\\text{opt}}$ 的一个极点。如果最小化子不唯一，则最小化子集合 $\\mathcal{F}_{\\text{L1-opt}} = \\{ v \\in \\mathcal{F}_{\\text{opt}} \\mid \\|v\\|_1 = \\|v_{\\text{L1}}^*\\|_1 \\}$ 是 $\\mathcal{F}_{\\text{opt}}$ 的一个凸子集。$\\mathcal{F}_{\\text{L1-opt}}$ 的极点也必须是更大集合 $\\mathcal{F}_{\\text{opt}}$ 的极点。\n\n这个结论也可以通过将问题表述为单个线性规划来得出。通过引入辅助变量 $t_i \\ge 0$ 使得 $-t_i \\le v_i \\le t_i$，最小化 $\\|v\\|_1$ 变得等价于最小化 $\\sum_i t_i$，因为在最优解处，我们将有 $t_i = |v_i|$。完整的问题是：\n$$\n\\text{minimize } \\sum_{i=1}^n t_i \\text{ subject to } (v,t) \\in P'\n$$\n其中 $P'$ 是 $\\mathbb{R}^{2n}$ 中的多胞体，由 $S v = 0$、$l \\le v \\le u$、$c^\\top v = Z^\\star$、$v - t \\le 0$、$-v - t \\le 0$ 和 $t \\ge 0$ 定义。由于目标是线性的，并且可行集 $P'$ 是一个多胞体，线性规划基本定理保证了存在一个最优解 $(v^*, t^*)$，它是 $P'$ 的一个极点。$P'$ 的一个极点投影到一个通量向量 $v^*$，该向量是 $\\mathcal{F}_{\\text{opt}}$ 的一个极点。因此，该方法自然地找到最优解面顶点处的解。Parsimonious FBA (pFBA) 是一种基于此原理建立的方法，用于从可能很大的备选方案空间中找到一个单一的、资源高效的通量分布。\n\n#### 2. FVA 宽度减少的量化\n\n在最优解面 $\\mathcal{F}_{\\text{opt}}$ 上进行通量变异性分析（FVA），可以确定与最大目标产率一致的每个通量 $v_j$ 的完整范围。这个范围 $[\\min_{v \\in \\mathcal{F}_{\\text{opt}}} v_j, \\max_{v \\in \\mathcal{F}_{\\text{opt}}} v_j]$ 定义了宽度 $w_j$。如果此范围非零，则表示存在代谢灵活性，这通常源于网络冗余，如平行通路或循环。\n\n最小化 $L_1$ 范数会选择 $\\mathcal{F}_{\\text{opt}}$ 的一个凸子集，我们称之为 $\\mathcal{F}_{\\text{L1-opt}}$，其中绝对通量之和最小。这可以作为最小化总通量“成本”的代理，惩罚那些使用不必要大通量的解。具有对称边界 $l_j = -u_j  0$ 的反应是可逆的，可以在任一方向上运行。它们通常参与“无效循环”，例如，底物被转化为产物，然后又被转化回来，没有净效益，却消耗了资源。$L_1$ 范数目标专门针对此类循环，因为它们在对主目标非必需的情况下增加了 $\\|v\\|_1$ 的值。\n\n对 $\\mathcal{F}_{\\text{L1-opt}}$ 的限制（操作上通过向线性规划中添加约束 $\\sum_i t_i = \\|v^*_{\\text{L1}}\\|_1$ 来定义）意味着新的 FVA 是在一个更小的凸集上执行的。由于 $\\mathcal{F}_{\\text{L1-opt}} \\subseteq \\mathcal{F}_{\\text{opt}}$，新的通量范围必须包含在原始范围内或与之相等。因此，新的宽度 $w^{\\text{L1}}_j$ 保证小于或等于原始宽度：$w^{\\text{L1}}_j \\le w_j$。减少量为 $w_j - w^{\\text{L1}}_j \\ge 0$。\n\n为了提供封闭形式的表征，考虑一个简单场景，其中最优解面 $\\mathcal{F}_{\\text{opt}}$ 是一维的。此集合中的任何通量向量都可以描述为 $v(\\lambda) = v_0 + \\lambda\\delta$，其中 $\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]$，$v_0$ 是 $\\mathcal{F}_{\\text{opt}}$ 中的一个特定解，而 $\\delta$ 是 $S$ 和 $c^\\top$ 的零空间中的一个向量（即 $S\\delta=0$ 和 $c^\\top\\delta=0$）。$\\lambda$ 的区间由边界 $l \\le v_0 + \\lambda\\delta \\le u$ 决定。反应 $j$ 的 FVA 宽度为 $w_j = |\\delta_j| (\\lambda_{\\max} - \\lambda_{\\min})$。\n\n$L_1$ 最小化问题变为在 $\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]$ 上最小化 $f(\\lambda)=\\sum_i |v_{0,i} + \\lambda\\delta_i|$。这是一个一维凸最小化问题。最优 $\\lambda$ 值的集合将是一个凸区间 $[\\lambda^*_{\\min}, \\lambda^*_{\\max}] \\subseteq [\\lambda_{\\min}, \\lambda_{\\max}]$。这个新区间定义了 L1 最优集 $\\mathcal{F}_{\\text{L1-opt}}$。反应 $j$ 的新 FVA 宽度为 $w^{\\text{L1}}_j = |\\delta_j| (\\lambda^*_{\\max} - \\lambda^*_{\\min})$。\n\n宽度的减少量明确为\n$$\nw_j - w^{\\text{L1}}_j = |\\delta_j| \\left[ (\\lambda_{\\max} - \\lambda_{\\min}) - (\\lambda^*_{\\max} - \\lambda^*_{\\min}) \\right].\n$$\n这量化了初始灵活性（由 $\\lambda$ 参数化）中有多少被 $L_1$ 范数准则视为“低效”。对于无效循环中的可逆反应 $j$，我们可能有 $\\delta_j \\ne 0$。$L_1$ 范数将偏好使 $|v_{0,j} + \\lambda\\delta_j|$ 尽可能小的 $\\lambda$ 值，从而缩小 $\\lambda$ 的范围并减小 FVA 宽度 $w_j$。如果最优 $\\lambda$ 是一个单点，则精炼后的 FVA 宽度变为零。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to define, solve, and print results for all test cases.\n    \"\"\"\n\n    # Define test cases as tuples of (S, c, l, u)\n    # Case A: Alternative optima via a single internal cycle\n    S_A = np.array([\n        [1, -1, 0, 0, 1],\n        [0, 1, -1, 0, -1],\n        [0, 0, 1, -1, 0]\n    ])\n    c_A = np.array([0, 0, 0, 1, 0])\n    l_A = np.array([0, -20, 0, 0, -5])\n    u_A = np.array([10, 20, 10, 100, 5])\n    \n    # Case B: Unique optimum, no cycles\n    S_B = np.array([\n        [1, -1, 0, 0],\n        [0, 1, -1, 0],\n        [0, 0, 1, -1]\n    ])\n    c_B = np.array([0, 0, 0, 1])\n    l_B = np.array([0, 0, 0, 0])\n    u_B = np.array([10, 10, 10, 100])\n\n    # Case C: Two independent cycles\n    S_C = np.array([\n        [1, -1, 1, 0, 0, 0, 0],\n        [0, 1, -1, -1, 0, 0, 0],\n        [0, 0, 0, 1, -1, 0, 0],\n        [0, 0, 0, 0, 0, -1, 1],\n        [0, 0, 0, 0, 0, 1, -1]\n    ])\n    c_C = np.array([0, 0, 0, 0, 1, 0, 0])\n    l_C = np.array([0, -20, -20, 0, 0, -5, -5])\n    u_C = np.array([10, 20, 20, 10, 100, 5, 5])\n\n    test_cases = [\n        (S_A, c_A, l_A, u_A),\n        (S_B, c_B, l_B, u_B),\n        (S_C, c_C, l_C, u_C),\n    ]\n\n    results = []\n    for case in test_cases:\n        S, c, l, u = case\n        total_reduction = run_fva_reduction_analysis(S, c, l, u)\n        results.append(total_reduction)\n\n    # Format and print the final output\n    print(f\"[{', '.join(f'{r:.10f}'.rstrip('0').rstrip('.') for r in results)}]\")\n\n\ndef run_fva_reduction_analysis(S, c, l, u):\n    \"\"\"\n    Performs the complete analysis for a single metabolic network case.\n    1. Finds optimal objective value Z*.\n    2. Computes original FVA widths on the optimal face.\n    3. Finds the minimum L1 norm.\n    4. Computes refined FVA widths on the L1-minimal face.\n    5. Calculates total reduction in widths for symmetric-bound reactions.\n    \"\"\"\n    m, n = S.shape\n    bounds = list(zip(l, u))\n    lp_options = {'tol': 1e-9, 'disp': False}\n\n    # 1. Compute Z_star (optimal objective value)\n    res_opt = linprog(-c, A_eq=S, b_eq=np.zeros(m), bounds=bounds, method='highs', options=lp_options)\n    if not res_opt.success:\n        # If optimization fails, likely due to empty feasible set in some cases.\n        # Total reduction is 0 if no optimal solution exists.\n        return 0.0\n    Z_star = -res_opt.fun\n\n    # Prepare constraints for FVA on the optimal face\n    A_eq_fva = np.vstack([S, c])\n    b_eq_fva = np.concatenate([np.zeros(m), [Z_star]])\n    \n    # 2. Compute original FVA widths (w_j)\n    w = np.zeros(n)\n    for j in range(n):\n        obj_min = np.zeros(n)\n        obj_min[j] = 1\n        res_min = linprog(obj_min, A_eq=A_eq_fva, b_eq=b_eq_fva, bounds=bounds, method='highs', options=lp_options)\n\n        obj_max = np.zeros(n)\n        obj_max[j] = -1\n        res_max = linprog(obj_max, A_eq=A_eq_fva, b_eq=b_eq_fva, bounds=bounds, method='highs', options=lp_options)\n\n        if res_min.success and res_max.success:\n            v_min = res_min.fun\n            v_max = -res_max.fun\n            # Clamp values to bounds to handle solver tolerance issues\n            v_min = max(v_min, l[j])\n            v_max = min(v_max, u[j])\n            w[j] = v_max - v_min\n        else:\n            # If FVA fails, suggests point solution, width is 0\n            w[j] = 0\n\n    # 3. Compute minimum L1 norm\n    # Variables are [v_1..v_n, t_1..t_n]\n    c_l1 = np.concatenate([np.zeros(n), np.ones(n)])\n    \n    A_eq_l1 = np.hstack([A_eq_fva, np.zeros((m + 1, n))])\n    b_eq_l1 = b_eq_fva\n    \n    # Constraints: v_i - t_i = 0 and -v_i - t_i = 0\n    I_n = np.eye(n)\n    A_ub_l1 = np.vstack([np.hstack([I_n, -I_n]), np.hstack([-I_n, -I_n])])\n    b_ub_l1 = np.zeros(2*n)\n\n    bounds_l1 = bounds + [(0, None)] * n\n    \n    res_l1_min = linprog(c_l1, A_eq=A_eq_l1, b_eq=b_eq_l1, A_ub=A_ub_l1, b_ub=b_ub_l1, bounds=bounds_l1, method='highs', options=lp_options)\n    \n    if not res_l1_min.success:\n        # If L1 min fails, likely due to infeasibility from precision, assume no variability\n        return 0.0\n    min_l1_norm = res_l1_min.fun\n\n    # 4. Compute refined FVA widths (w_l1_j)\n    # Add constraint sum(t_i) = min_l1_norm\n    A_eq_fva_l1 = np.vstack([A_eq_l1, c_l1])\n    b_eq_fva_l1 = np.concatenate([b_eq_l1, [min_l1_norm]])\n    \n    w_l1 = np.zeros(n)\n    for j in range(n):\n        obj_vec = np.zeros(2*n)\n        \n        # Minimize v_j\n        obj_vec[j] = 1\n        res_min = linprog(obj_vec, A_eq=A_eq_fva_l1, b_eq=b_eq_fva_l1, A_ub=A_ub_l1, b_ub=b_ub_l1, bounds=bounds_l1, method='highs', options=lp_options)\n        \n        # Maximize v_j\n        obj_vec[j] = -1\n        res_max = linprog(obj_vec, A_eq=A_eq_fva_l1, b_eq=b_eq_fva_l1, A_ub=A_ub_l1, b_ub=b_ub_l1, bounds=bounds_l1, method='highs', options=lp_options)\n\n        if res_min.success and res_max.success:\n            v_min = res_min.fun\n            v_max = -res_max.fun\n            v_min = max(v_min, l[j])\n            v_max = min(v_max, u[j])\n            w_l1[j] = v_max - v_min\n        else:\n            w_l1[j] = 0\n\n    # 5. Compute total reduction R\n    total_reduction = 0.0\n    # Identify indices of reactions with symmetric bounds\n    # using a tolerance for float comparison\n    sym_indices = [j for j in range(n) if u[j] > 0 and abs(l[j] + u[j])  1e-9]\n\n    for j in sym_indices:\n        reduction = w[j] - w_l1[j]\n        # Ensure reduction is non-negative due to potential floating point noise\n        total_reduction += max(0, reduction)\n\n    return total_reduction\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}