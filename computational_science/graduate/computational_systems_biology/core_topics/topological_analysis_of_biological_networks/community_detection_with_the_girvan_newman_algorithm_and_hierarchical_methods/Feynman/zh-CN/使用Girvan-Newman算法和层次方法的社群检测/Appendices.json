{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固您对边介数中心性这一基本概念的理解。通过在一个具有清晰社群结构的简单合成网络上手动计算该指标，您将直观地认识到为何它能有效识别连接社群的“桥梁”边，而这正是 Girvan-Newman 算法的核心机制。",
            "id": "3296007",
            "problem": "在计算系统生物学的背景下，考虑一个具有预设模块化结构的合成无向基因相互作用网络。设顶点集为 $V=\\{A_1,A_2,A_3,B_1,B_2,B_3\\}$，其中 $\\{A_1,A_2,A_3\\}$ 和 $\\{B_1,B_2,B_3\\}$ 代表两个基因社群。边集为\n$$\nE=\\{(A_1,A_2),(A_2,A_3),(A_3,A_1),(B_1,B_2),(B_2,B_3),(B_3,B_1),(A_3,B_1)\\}.\n$$\n单个社群间桥 $(A_3,B_1)$ 构成了预设割。仅使用无权图中最短路径和边介数中心性的基本定义，通过从每个源节点执行广度优先搜索（Breadth-First Search (BFS)）来计算每条边 $e \\in E$ 的边介数中心性 $C_B(e)$，这与 Girvan–Newman 社群检测算法中的做法相同。\n\n用作基础的定义：\n- 对于每对无序的不同节点 $\\{s,t\\}$，令 $\\sigma_{st}$ 表示 $s$ 和 $t$ 之间的最短路径数量，令 $\\sigma_{st}(e)$ 表示穿过边 $e$ 的此类最短路径的数量。\n- 边介数中心性定义为\n$$\nC_B(e)=\\sum_{\\{s,t\\}\\subset V,\\, s\\neq t}\\frac{\\sigma_{st}(e)}{\\sigma_{st}}.\n$$\n\n在计算完所有边的 $C_B(e)$ 后，令 $\\mathcal{E}_{\\text{cut}}$ 为社群间边的集合，$\\mathcal{E}_{\\text{intra}}$ 为社群内边的集合。定义比率\n$$\nR=\\frac{\\text{mean}\\left(C_B(e): e\\in \\mathcal{E}_{\\text{cut}}\\right)}{\\text{mean}\\left(C_B(e): e\\in \\mathcal{E}_{\\text{intra}}\\right)}.\n$$\n将 $R$ 的值作为最终答案报告。无需四舍五入。将最终答案表示为无单位的精确值。此外，在你的推理过程中，根据你计算出的 $C_B(e)$ 值，验证跨越预设割的边比社群内边具有更高的中心性。",
            "solution": "### 步骤 1：分析网络结构与简化计算\n该网络由两个3-团（三角形社群 $C_A=\\{A_1,A_2,A_3\\}$ 和 $C_B=\\{B_1,B_2,B_3\\}$）通过一条桥边 $(A_3,B_1)$ 连接而成。\n一个关键特性是，对于此图中任意一对不同的节点 $\\{s,t\\}$，它们之间的最短路径都是唯一的。因此，对于所有 $\\{s,t\\}$，最短路径数 $\\sigma_{st}=1$。这使得边介数中心性的计算公式简化为：\n$$\nC_B(e) = \\sum_{\\{s,t\\}\\subset V,\\, s\\neq t} \\sigma_{st}(e)\n$$\n其中，如果连接 $s$ 和 $t$ 的唯一最短路径经过边 $e$，则 $\\sigma_{st}(e)=1$，否则为0。因此，$C_B(e)$ 就是穿过边 $e$ 的最短路径的总数。\n\n### 步骤 2：计算各边的边介数中心性 $C_B(e)$\n\n1.  **社群间边（桥）$\\mathcal{E}_{\\text{cut}} = \\{(A_3,B_1)\\}$**：\n    连接社群 $C_A$ 中任意节点与社群 $C_B$ 中任意节点之间的唯一最短路径都必须穿过边 $(A_3,B_1)$。这样的节点对共有 $|C_A| \\times |C_B| = 3 \\times 3 = 9$ 对。\n    因此，$C_B((A_3, B_1)) = 9$。\n\n2.  **社群内边 $\\mathcal{E}_{\\text{intra}}$**：\n    根据对称性，我们只需计算三类边的中心性：\n    - **边 $(A_1,A_2)$**：穿过此边的唯一最短路径仅为节点对 $\\{A_1, A_2\\}$ 本身的路径。任何其他从 $A_1$ 或 $A_2$ 到达网络其余部分的最短路径都不会经过此边。因此，$C_B((A_1,A_2)) = 1$。通过对称性，$C_B((B_2,B_3)) = 1$。\n    - **边 $(A_1,A_3)$**：穿过此边的最短路径包括：\n      a) 节点对 $\\{A_1, A_3\\}$ 的路径（1条）。\n      b) 从 $A_1$ 到社群 $C_B$ 中任意节点（$B_1, B_2, B_3$）的路径。这些最短路径都必须是 $A_1-A_3-\\dots$，因此都会穿过 $(A_1,A_3)$。共3条路径。\n      总计：$1 + 3 = 4$。所以，$C_B((A_1,A_3)) = 4$。\n    - **其他社群内边**：根据对称性，我们有：\n      $C_B((A_2,A_3)) = 4$。\n      $C_B((B_1,B_2)) = 4$（路径为 $\\{B_1,B_2\\}$ 以及从 $B_2$ 到 $C_A$ 中所有3个节点的路径）。\n      $C_B((B_1,B_3)) = 4$。\n\n### 步骤 3：验证中心性并计算比率 R\n\n*   **中心性验证**：社群间边 $(A_3,B_1)$ 的中心性为9，而所有社群内边的中心性为1或4。由于 $9 > 4$ 且 $9 > 1$，这验证了跨越社群的“桥梁”边具有最高的介数中心性，这正是 Girvan-Newman 算法所依赖的原理。\n\n*   **比率 R 的计算**：\n    - **社群间边的平均中心性**:\n      $\\text{mean}\\left(C_B(e): e\\in \\mathcal{E}_{\\text{cut}}\\right) = C_B((A_3,B_1)) = 9$。\n    - **社群内边的平均中心性**:\n      社群内边共有6条，其中心性值为 $\\{1, 4, 4, 4, 1, 4\\}$。\n      $\\text{mean}\\left(C_B(e): e\\in \\mathcal{E}_{\\text{intra}}\\right) = \\frac{1+4+4+4+1+4}{6} = \\frac{18}{6} = 3$。\n    - **最终比率**:\n      $R = \\frac{\\text{mean}\\left(C_B(e): e\\in \\mathcal{E}_{\\text{cut}}\\right)}{\\text{mean}\\left(C_B(e): e\\in \\mathcal{E}_{\\text{intra}}\\right)} = \\frac{9}{3} = 3$。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "在静态计算的基础上，本练习将模拟 Girvan-Newman 算法的动态迭代过程。您将追踪一个模拟蛋白质复合物相互作用的网络，在移除具有最高边介数的边后如何被逐步切分，从而直接观察该算法揭示社群结构的方式。",
            "id": "3295991",
            "problem": "考虑一个来自计算系统生物学的简化蛋白质-蛋白质相互作用（PPI）网络，其中两个蛋白质复合物被建模为通过复合物间相互作用连接的团（clique）。设无向、无权图 $G=(V,E)$ 的顶点集为 $V=\\{a_1,a_2,a_3,b_1,b_2,b_3\\}$，其中 $\\{a_1,a_2,a_3\\}$ 表示复合物 $A$ 中的蛋白质，$\\{b_1,b_2,b_3\\}$ 表示复合物 $B$ 中的蛋白质。边集 $E$ 由在 $A$ 和 $B$ 中形成团的所有复合物内边以及两条复合物间边组成：\n- $A$ 中的复合物内边： $\\{(a_1,a_2),(a_1,a_3),(a_2,a_3)\\}$。\n- $B$ 中的复合物内边： $\\{(b_1,b_2),(b_1,b_3),(b_2,b_3)\\}$。\n- 复合物间边： $\\{(a_1,b_1),(a_2,b_2)\\}$。\n\n社区检测通过 Girvan–Newman 算法进行，该算法在每次迭代中移除一条具有最高边介数中心性的边，然后在下一次移除前在更新后的图上重新计算边介数中心性。边 $e$ 的边介数中心性定义为 $C_B(e) = \\sum_{s \\neq t} \\frac{\\sigma_{st}(e)}{\\sigma_{st}}$，其中 $\\sigma_{st}$ 是从 $s$到 $t$ 的最短路径总数，而 $\\sigma_{st}(e)$ 则是这些最短路径中经过边 $e$ 的数量。在图 $G$ 首次变得不连通之前，需要进行多少次迭代（即移除边的次数）？",
            "solution": "### 算法模拟\n\n该问题要求我们模拟 Girvan-Newman 算法的迭代过程，以确定需要多少次迭代才能使给定的图变得不连通。该算法的规则是：在每一步中，计算所有边的边介数中心性（EBC），然后移除具有最高 EBC 的**一条**边。\n\n**初始图分析**\n图由两个3-团（复合物A和B）组成，它们通过两条“桥”边 $e_{ab1}=(a_1,b_1)$ 和 $e_{ab2}=(a_2,b_2)$ 连接。由于图的对称性，这两条桥边是拓扑等价的。直观上，连接不同复合物的桥边承载了所有的跨复合物通信，因此它们的 EBC 将高于任何复合物内部的边。由于对称，这两条桥边的 EBC 将会相等且是网络中最高的。\n\n**第 1 次迭代**\n1.  **计算 EBC**：计算图中所有边的 EBC。边 $e_{ab1}=(a_1,b_1)$ 和 $e_{ab2}=(a_2,b_2)$ 将具有相同的、最高的 EBC 值。所有复合物内部边的 EBC 将会较低。\n2.  **移除边**：算法选择一条具有最高 EBC 的边进行移除。由于 $e_{ab1}$ 和 $e_{ab2}$ 的 EBC 并列最高，算法将选择移除其中一条。我们假设移除 $e_{ab1}=(a_1,b_1)$。\n3.  **检查连通性**：移除 $e_{ab1}$ 后，图仍然通过另一条桥边 $e_{ab2}=(a_2,b_2)$ 保持连通。\n\n**第 2 次迭代**\n1.  **重新计算 EBC**：在新图中（已移除 $e_{ab1}$），算法重新计算所有剩余边的 EBC。现在，唯一的桥边 $e_{ab2}=(a_2,b_2)$ 成为连接两个复合物的唯一路径。因此，所有跨复合物的最短路径都必须经过它，使其 EBC 值急剧上升，远高于图中任何其他边。\n2.  **移除边**：算法确定 $e_{ab2}$ 具有当前网络中最高的 EBC，并将其移除。\n3.  **检查连通性**：移除 $e_{ab2}$ 后，两个复合物之间不再有任何连接。图分裂为两个独立的连通分量：$\\{a_1,a_2,a_3\\}$ 和 $\\{b_1,b_2,b_3\\}$。图首次变得不连通。\n\n**结论**\n经过两次迭代（移除了两条边），图首次变得不连通。因此，答案是2。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "Girvan-Newman 算法会生成一个完整的潜在社群结构层级，但哪种划分才是最优的？最后的这个练习引入模块度 $Q$ 作为决策的关键工具来回答此问题。通过为一个假设的共现网络计算不同层级划分的 $Q$ 值，您将学会如何选择最有意义的社群划分，并理解其与避免过度分割之间的权衡。",
            "id": "3296083",
            "problem": "一个宿主相关的微生物共现网络表示为一个无向、无权图，其节点集为 $\\{1,2,3,4,5,6,7,8\\}$，边集为 $E=\\{(1,2),(2,3),(1,3),(3,4),(4,5),(5,6),(4,6),(6,7),(7,8)\\}$。Girvan-Newman 算法生成一个群落划分的层次树状图，随着高介数（betweenness）的边被逐步移除，产生以下划分序列（从根到叶）：\n- 步骤 $\\mathsf{s_0}$: $\\{\\{1,2,3,4,5,6,7,8\\}\\}$.\n- 步骤 $\\mathsf{s_1}$: $\\{\\{1,2,3\\},\\{4,5,6,7,8\\}\\}$.\n- 步骤 $\\mathsf{s_2}$: $\\{\\{1,2,3\\},\\{4,5,6\\},\\{7,8\\}\\}$.\n- 步骤 $\\mathsf{s_3}$: $\\{\\{1,2\\},\\{3\\},\\{4,5,6\\},\\{7,8\\}\\}$.\n\n使用网络群落检测中模块度的标准定义作为量化标准，计算上述每个划分的模块度 $Q$，并选择使 $Q$ 最大化的切割。在你的推理中，解释在计算系统生物学的背景下，分层群落检测在过度碎片化方面固有的权衡。只报告步骤 $\\mathsf{s_0}$ 到 $\\mathsf{s_3}$ 中的最大模块度值 $Q$，并将你的最终答案四舍五入到四位有效数字。",
            "solution": "网络划分的模块度 $Q$ 是衡量群落内部链接密度与群落之间链接密度相比较的指标。对于一个无权无向图，其定义为：\n$$Q = \\sum_{c=1}^{N_c} \\left[ \\frac{L_c}{m} - \\left( \\frac{D_c}{2m} \\right)^2 \\right]$$\n其中 $N_c$ 是群落数量，$m$ 是网络中的总边数，$L_c$ 是两个端点都在群落 $c$ 内的边数，$D_c$ 是群落 $c$ 中所有节点度数的总和。\n\n首先，我们描述给定网络的特征：\n- 节点数 $|V|=8$。\n- 总边数 $m = |E| = 9$，因此 $2m = 18$。\n- 各节点度数为：$k_1=2, k_2=2, k_3=3, k_4=3, k_5=2, k_6=3, k_7=2, k_8=1$。度数总和 $\\sum k_i = 18 = 2m$。\n\n现在，我们为每个划分计算模块度 $Q$。\n\n**步骤 $\\mathsf{s_0}$：划分 $P_0 = \\{\\{1,2,3,4,5,6,7,8\\}\\}$**\n只有一个群落 $c_1$。$L_{c_1} = 9$, $D_{c_1} = 18$。\n$Q_0 = \\frac{9}{9} - \\left(\\frac{18}{18}\\right)^2 = 1 - 1 = 0$。\n\n**步骤 $\\mathsf{s_1}$：划分 $P_1 = \\{\\{1,2,3\\}, \\{4,5,6,7,8\\}\\}$**\n有两个群落，$c_1 = \\{1,2,3\\}$ 和 $c_2 = \\{4,5,6,7,8\\}$。\n- 对于 $c_1$: $L_{c_1} = 3$, $D_{c_1} = k_1+k_2+k_3 = 2+2+3 = 7$。\n- 对于 $c_2$: $L_{c_2} = 5$, $D_{c_2} = k_4+k_5+k_6+k_7+k_8 = 3+2+3+2+1 = 11$。\n- 模块度为：\n$Q_1 = \\left[\\frac{3}{9} - \\left(\\frac{7}{18}\\right)^2\\right] + \\left[\\frac{5}{9} - \\left(\\frac{11}{18}\\right)^2\\right] = \\frac{59}{324} + \\frac{59}{324} = \\frac{118}{324} \\approx 0.3642$。\n\n**步骤 $\\mathsf{s_2}$：划分 $P_2 = \\{\\{1,2,3\\}, \\{4,5,6\\}, \\{7,8\\}\\}$**\n有三个群落，$c_1=\\{1,2,3\\}$, $c_2=\\{4,5,6\\}$, 和 $c_3=\\{7,8\\}$。\n- 对于 $c_1$: $L_{c_1}=3$, $D_{c_1}=7$。\n- 对于 $c_2$: $L_{c_2} = 3$, $D_{c_2} = k_4+k_5+k_6 = 3+2+3 = 8$。\n- 对于 $c_3$: $L_{c_3} = 1$, $D_{c_3} = k_7+k_8 = 2+1 = 3$。\n- 模块度为：\n$Q_2 = \\left[\\frac{3}{9} - \\left(\\frac{7}{18}\\right)^2\\right] + \\left[\\frac{3}{9} - \\left(\\frac{8}{18}\\right)^2\\right] + \\left[\\frac{1}{9} - \\left(\\frac{3}{18}\\right)^2\\right] = \\frac{59}{324} + \\frac{44}{324} + \\frac{27}{324} = \\frac{130}{324} \\approx 0.4012$。\n\n**步骤 $\\mathsf{s_3}$：划分 $P_3 = \\{\\{1,2\\}, \\{3\\}, \\{4,5,6\\}, \\{7,8\\}\\}$**\n有四个群落，$c_1=\\{1,2\\}$, $c_2=\\{3\\}$, $c_3=\\{4,5,6\\}$, 和 $c_4=\\{7,8\\}$。\n- 对于 $c_1$: $L_{c_1}=1$, $D_{c_1} = k_1+k_2 = 4$。\n- 对于 $c_2$: $L_{c_2}=0$, $D_{c_2} = k_3 = 3$。\n- 对于 $c_3$: $L_{c_3}=3$, $D_{c_3}=8$。\n- 对于 $c_4$: $L_{c_4}=1$, $D_{c_4}=3$。\n- 模块度为：\n$Q_3 = \\left[\\frac{1}{9} - \\left(\\frac{4}{18}\\right)^2\\right] + \\left[\\frac{0}{9} - \\left(\\frac{3}{18}\\right)^2\\right] + \\left[\\frac{3}{9} - \\left(\\frac{8}{18}\\right)^2\\right] + \\left[\\frac{1}{9} - \\left(\\frac{3}{18}\\right)^2\\right] = \\frac{20}{324} - \\frac{9}{324} + \\frac{44}{324} + \\frac{27}{324} = \\frac{82}{324} \\approx 0.2531$。\n\n**比较与选择**\n计算出的模块度值为：$Q_0 = 0$, $Q_1 \\approx 0.3642$, $Q_2 \\approx 0.4012$, $Q_3 \\approx 0.2531$。\n最大模块度值为 $Q_{max} = Q_2 \\approx 0.4012$。这表明，根据模块度标准，划分 $P_2 = \\{\\{1,2,3\\}, \\{4,5,6\\}, \\{7,8\\}\\}$ 代表了网络中最显著的群落结构。\n\n**分层群落检测中的权衡**\n像 Girvan-Newman 算法这样的分层方法通过树状图提供了跨多个尺度的群落结构视图。然而，这引入了选择层次结构中“正确”层级的关键问题，即平衡分辨率。在计算系统生物学中，这个选择至关重要，因为网络群落通常对应于功能模块。\n内在的权衡在于：\n- **划分不足**：树状图中过高的切割（如步骤 $\\mathsf{s_1}$）可能导致不同的生物模块被错误地合并成一个大群落，掩盖其特定功能。\n- **过度碎片化**：树状图中过低的切割（如步骤 $\\mathsf{s_3}$）会导致一个有意义的生物模块被分裂成更小的、非功能的亚群。例如，在步骤 $\\mathsf{s_3}$ 中，群落 $\\{1,2,3\\}$ 被分解，使得模块度从 $Q_2$ 降至 $Q_3$，表明这是一个次优结构，功能单元的完整性可能受到了损害。\n模块度最大化的目标是找到“最佳点”划分（本例中为 $P_2$），它最好地平衡了合并无关节点和拆分相关节点之间的折衷，从而识别出系统最显著的功能组织。\n\n最大模块度值为 $Q_2$。将其四舍五入到四位有效数字得到 $0.4012$。",
            "answer": "$$\n\\boxed{0.4012}\n$$"
        }
    ]
}