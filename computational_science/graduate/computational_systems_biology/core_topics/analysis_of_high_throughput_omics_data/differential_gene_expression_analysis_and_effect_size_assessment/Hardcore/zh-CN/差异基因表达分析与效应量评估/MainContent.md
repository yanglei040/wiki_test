## 引言
在生命科学研究中，识别不同实验条件下基因表达水平的变化是理解生物学过程、疾病机理和药物响应的核心。然而，从原始测[序数](@entry_id:150084)据到可靠的生物学结论，需要穿越一系列统计陷阱和计算挑战。仅仅依赖P值阈值已不足以应对现代生物学研究的复杂性，如何准确评估变化的生物学幅度（[效应量](@entry_id:177181)），以及如何将分析框架扩展到单细胞、空间等[多维数据](@entry_id:189051)，构成了当前计算生物学面临的关键知识缺口。

本文旨在为研究者提供一份关于[差异基因表达分析](@entry_id:178873)与[效应量](@entry_id:177181)评估的全面指南。在第一章“原理与机制”中，我们将深入探讨支撑现代分析工具的统计模型基础，从[数据归一化](@entry_id:265081)、[负二项分布](@entry_id:262151)到[广义线性模型](@entry_id:171019)的构建。随后的第二章“应用与跨学科交叉”，将展示这些核心原理如何创造性地应用于解决前沿问题，例如解析亚型动态、处理单[细胞异质性](@entry_id:262569)、分析空间表达模式以及融合[网络科学](@entry_id:139925)与信息论的视角。最后，第三章“动手实践”将通过一系列精心设计的编程练习，帮助读者将理论知识转化为解决实际问题的能力。通过这三章的学习，读者将不仅掌握[差异表达分析](@entry_id:266370)的“操作方法”，更能深刻理解其背后的统计思想，从而在自己的研究中做出更稳健、更深刻的数据解读。

## 原理与机制

本章在前一章介绍背景的基础上，深入探讨[差异表达](@entry_id:748396)基因分析和[效应量](@entry_id:177181)评估背后的核心统计原理与计算机制。我们将从基因表达计数的建模出发，逐步构建用于[假设检验](@entry_id:142556)的[广义线性模型](@entry_id:171019)框架，并讨论结果解读中的关键概念，最终将这些原理扩展到[单细胞数据分析](@entry_id:173175)的独特挑战中。

### 基因表达计数的建模：从原始数据到可比较的丰度

[差异表达分析](@entry_id:266370)的第一步是建立一个能够准确描述测序计数数据生成过程的统计模型。这个模型必须能处理[测序深度](@entry_id:178191)的差异，并解释数据中固有的随机性。

#### 基础模型：均值、文库大小因子与生物丰度

高通量测序实验中，我们观测到的基因 $g$ 在样本 $i$ 中的读长计数（read count），记为 $Y_{gi}$，是该基因真实分子丰度的一个随机、带噪声的度量。一个基础且核心的建模思想是，将该计数的[期望值](@entry_id:153208) $\mu_{gi}$ 分解为两个部分的乘积：

$$ E[Y_{gi}] = \mu_{gi} = s_i q_{gi} $$

在这个模型中，各个参数的含义如下：
- $s_i$ 是一个样本特异性的**文库大小因子（size factor）**。它捕获了与样本相关的技术变异，其中最主要的是[测序深度](@entry_id:178191)。一个[测序深度](@entry_id:178191)是另一个样本两倍的样本，在其他条件相同的情况下，其基因的[期望计数](@entry_id:162854)也会是两倍。$s_i$ 的作用就是对这种技术层面的尺度差异进行归一化。
- $q_{gi}$ 代表了基因 $g$ 在样本 $i$ 中的**生物丰度**。这是一个与生物学状态直接相关、且在校正了技术尺度差异后，可以在不同样本间直接比较的量。

[差异表达分析](@entry_id:266370)的最终目标，正是要推断不同实验条件下（例如处理组与对照组）$q_{g}$ 的变化，而非原始观测计数 $Y_{gi}$ 的变化。因此，**归一化（Normalization）**，即估算并校正文库大小因子 $s_i$ 的过程，是任何[差异表达分析](@entry_id:266370)流程中不可或缺的关键第一步。

为了理解归一化的必要性，我们来看一个简单的思想实验。假设我们有两个生物学上完全相同的样本，但它们的[测序深度](@entry_id:178191)不同，例如样本1的总读长数为 $N_1 = 10^6$，样本2为 $N_2 = 2 \times 10^6$。对于一个表达水平稳定的基因 $g$，其真实的相对丰度在两个样本中是相同的，例如 $p_{g1} = p_{g2} = 10^{-4}$。在理想的抽样模型下，我们期望的计数值分别为 $E[Y_{g1}] = 10^6 \times 10^{-4} = 100$ 和 $E[Y_{g2}] = 2 \times 10^6 \times 10^{-4} = 200$。如果不进行归一化，直接比较原始计数会得出基因 $g$ 在样本2中表达量翻倍的错误结论。然而，通过使用与总读长数成比例的文库大小因子（例如，令 $s_1=1$, $s_2=2$）进行校正，我们估计的生物丰度就变得具有可比性了：$E[Y_{g1}/s_1] = 100/1 = 100$，$E[Y_{g2}/s_2] = 200/2 = 100$。这正确地反映了该基因在生物学上没有发生变化的事实。因此，经过恰当归一化的量 $Y_{gi}/s_i$ 在期望上是 $q_{gi}$ 的一个无偏估计，即 $E[Y_{gi}/s_i] = q_{gi}$ 。

#### 成分性问题

仅仅考虑[测序深度](@entry_id:178191)差异的归一化（例如，使用总读长数作为文库大小因子）在许多情况下是不够的。这是因为[RNA测序](@entry_id:178187)数据本质上是**成分性（compositional）**的：我们观测到的是一个固定读长总数在所有基因间的相对分配，而非每个基因的绝对分子数量。

这个特性会带来一个棘手的问题：一个或少数几个基因表达量的剧烈变化会系统性地影响其他所有基因的观测计数。让我们通过一个例子来阐明这一点 。假设在条件1下，基因的绝对丰度为 $(a_{1,1}, \dots, a_{G,1})$，总丰度为 $A_1 = \sum_{j} a_{j,1}$。在条件2下，只有一个高表达基因 $g^{\star}$ 的绝对丰度增加了两倍（$a_{g^{\star},2} = 3 a_{g^{\star},1}$），而所有其他基因 $i \neq g^{\star}$ 的绝对丰度保持不变（$a_{i,2} = a_{i,1}$）。这导致条件2的总丰度增加到 $A_2 = A_1 + 2 a_{g^{\star},1}$。在[测序深度](@entry_id:178191)相同（$N_1=N_2=N$）的情况下，基因 $i$ 的[期望计数](@entry_id:162854)为 $E[X_{i,c}] = N \cdot (a_{i,c} / A_c)$。

对于任何一个绝对丰度未发生变化的基因 $i \neq g^{\star}$，其观测计数的变化倍数（Fold Change, FC）为：
$$ \mathrm{FC}_{i} = \frac{E[X_{i,2}]}{E[X_{i,1}]} = \frac{N \cdot (a_{i,2}/A_{2})}{N \cdot (a_{i,1}/A_{1})} = \frac{a_{i,2}}{a_{i,1}} \cdot \frac{A_{1}}{A_{2}} = 1 \cdot \frac{A_{1}}{A_{2}} $$
由于 $A_2 > A_1$，我们得到 $\mathrm{FC}_{i}  1$。这意味着，仅仅因为一个不相关的基因 $g^{\star}$ 的上调，导致了所有其他表达稳定的基因看起来像是被下调了。这是成分性数据的一个固有“伪影”。

这个问题促使了更稳健的归一化方法的产生，例如Trimmed Mean of M-values (TMM)或[DESeq2](@entry_id:167268)中的中位数比例法（median-of-ratios）。这些方法的核心思想是，它们假设大部分基因的表达量在不同样本间是稳定的。通过寻找一个能使这部分稳定基因的计数对齐的缩放因子，它们能更准确地估计出由[测序深度](@entry_id:178191)和成分性效应共同构成的文库大小因子 $s_i$，从而避免少数几个剧烈变化的基因对整体归一化产生不成比例的影响  。

#### 计数的统计分布：过离散与负[二项模型](@entry_id:275034)

在归一化解决了样本间的可比性问题后，我们还需要一个概率模型来描述单个计数值 $Y_{gi}$ 的随机性。最简单的计数模型是**泊松（Poisson）[分布](@entry_id:182848)**，其一个关键特征是[方差](@entry_id:200758)等于均值，即 $\mathrm{Var}(Y) = E[Y]$。然而，在真实的[RNA测序](@entry_id:178187)数据中，生物学重复样本间的变异通常远大于泊松分布所预测的水平。这种现象被称为**过离散（overdispersion）**。

过离散的来源是多方面的，包括细胞间内在的基因表达随机性（例如[转录爆发](@entry_id:156205)）、不同样本间细微的实验条件差异等。为了对这种额外的变异进行建模，**负二项（Negative Binomial, NB）[分布](@entry_id:182848)**成为了分析RNA-seq数据的黄金标准。

N[B模型](@entry_id:159413)可以从一个直观的**伽马-泊松（Gamma-Poisson）混合模型**中导出  。其思想是，每个观测计数 $Y_i$ 产生于一个泊松过程 $Y_i | \lambda_i \sim \text{Poisson}(\lambda_i)$，但其速率参数 $\lambda_i$ 本身在不同生物学重复样本间不是固定的，而是遵循一个伽马[分布](@entry_id:182848) $\lambda_i \sim \text{Gamma}$。这个分层结构精确地描述了生物学变异（由Gamma[分布](@entry_id:182848)捕获）和技术性抽样噪声（由Poisson分布捕获）的叠加。

通[过积分](@entry_id:753033)掉潜变量 $\lambda_i$，我们可以得到 $Y_i$ 的[边际分布](@entry_id:264862)，即[负二项分布](@entry_id:262151)。其最重要的特性是其均值-[方差](@entry_id:200758)关系：
$$ \mathrm{Var}(Y_i) = \mu_i + \phi \mu_i^2 $$
其中 $\mu_i = E[Y_i]$ 是[期望计数](@entry_id:162854)，$\phi$ 是**离散度参数（dispersion parameter）**。这个关系式完美地诠释了过离散的含义：
- [方差](@entry_id:200758)由两部分组成：第一部分 $\mu_i$ 是泊松分布所预期的抽样[方差](@entry_id:200758)。
- 第二部分 $\phi \mu_i^2$ 是额外的[方差](@entry_id:200758)，它随着均值的平方增长，代表了生物学重复之间的变异。$\phi$ 值越大，过离散程度越高。
当 $\phi \to 0$ 时，生物学变异消失，NB[分布](@entry_id:182848)退化为泊松分布。因此，N[B模型](@entry_id:159413)为我们提供了一个灵活的框架，能够同时容纳抽样噪声和生物学变异。

### [差异表达](@entry_id:748396)的线性模型框架

有了合适的统计分布模型后，我们下一步需要一个强大的数学框架来系统地关联基因表达、实验设计和我们希望检验的生物学效应。[广义线性模型](@entry_id:171019)（GLMs）为此提供了理想的解决方案。

#### 定义[效应量](@entry_id:177181)：[对数倍数变化](@entry_id:272578)

在比较两个条件（例如，处理组B与[对照组](@entry_id:747837)A）时，我们最关心的**[效应量](@entry_id:177181)（effect size）**是基因表达水平的变化幅度。在生物学上，乘法性的变化比加法性的变化更有意义。因此，我们通常使用**[倍数变化](@entry_id:272598)（Fold Change, FC）**，即生物丰度的比值 $q_{gB}/q_{gA}$。

为了数学处理的方便性和结果解释的对称性，我们通常在对数尺度上工作，定义**[对数倍数变化](@entry_id:272578)（Log Fold Change, LFC）**为：
$$ \mathrm{LFC}_g = \log_{2}\left(\frac{q_{gB}}{q_{gA}}\right) $$
使用以2为底的对数是惯例，因为它使得结果的解释非常直观：LFC为1代表2倍的上调，LFC为-2代表4倍的下调，LFC为0代表没有变化。

我们可以利用前文提到的[矩量法](@entry_id:752140)（method-of-moments）从归一化后的计数中估计LFC。例如，给定各组的计数和文库大小因子，我们可以先估计各组的平均生物丰度 $\hat{\mu}_{gA}$ 和 $\hat{\mu}_{gB}$，然后计算 $\widehat{\mathrm{LFC}}_g = \log_2(\hat{\mu}_{gA}/\hat{\mu}_{gB})$ 。

#### [广义线性模型](@entry_id:171019)（GLM）的力量

[广义线性模型](@entry_id:171019)（GLM）是一个强大而灵活的框架，它将[负二项分布](@entry_id:262151)与实验设计联系起来。一个用于[RNA-seq分析](@entry_id:173715)的NB-GLM由三个部分组成：

1.  **随机部分**：观测值 $Y_i$ 服从[负二项分布](@entry_id:262151)，$Y_i \sim \text{NB}(\mu_i, \phi)$。
2.  **系统部分**：一个**[线性预测](@entry_id:180569)器（linear predictor）** $\eta_i$，它是样本$i$的协变量（covariates）的[线性组合](@entry_id:154743)，$\eta_i = \mathbf{x}_i^\top \boldsymbol{\beta}$。这里的向量 $\mathbf{x}_i$ 编码了样本 $i$ 的所有相关信息（如属于哪个实验条件、哪个批次等），而向量 $\boldsymbol{\beta}$ 是我们想要估计的效应系数。
3.  **[连接函数](@entry_id:636388)**：一个**对数连接（log link）**函数将[期望计数](@entry_id:162854) $\mu_i$ 与[线性预测](@entry_id:180569)器 $\eta_i$ 联系起来。在RNA-seq中，这个关系式还必须包含归一化因子，通常是以**偏移量（offset）**的形式出现：
    $$ \log(\mu_i) = \log(s_i) + \mathbf{x}_i^\top \boldsymbol{\beta} $$
    这个公式优雅地将归一化（通过偏移量 $\log(s_i)$）和对生物学效应的建模（通过[线性预测](@entry_id:180569)器 $\mathbf{x}_i^\top \boldsymbol{\beta}$）整合在同一个模型中。通过指数化，我们可以看到它与我们最初的基础模型 $E[Y_i] = s_i q_i$ 是一致的，其中生物学部分 $q_i$ 正是由线性模型 $\exp(\mathbf{x}_i^\top \boldsymbol{\beta})$ 决定的。

#### [设计矩阵](@entry_id:165826)与对比：提出正确的问题

在GLM框架中，实验设计通过**[设计矩阵](@entry_id:165826)（design matrix）** $X$ 来体现。[设计矩阵](@entry_id:165826)的每一行对应一个样本，每一列对应一个模型参数（$\beta$ 向量的一个元素）。如何构建[设计矩阵](@entry_id:165826)决定了模型参数 $\beta$ 的具体生物学含义 。

例如，对于一个简单的两组比较（[对照组](@entry_id:747837)A，处理组B），一个常见的设计是：
$$ X = \begin{pmatrix} 1  0 \\ \vdots  \vdots \\ 1  0 \\ 1  1 \\ \vdots  \vdots \\ 1  1 \end{pmatrix} \begin{matrix} \left. \begin{array}{c} \\ \\ \end{array} \right\} \text{对照组} \\ \left. \begin{array}{c} \\ \\ \end{array} \right\} \text{处理组} \end{matrix} $$
模型为 $\log(\mu_i) = \beta_0 + \beta_1 x_{i,1}$。在这种“0/1”编码下：
- 对照组样本（$x_{i,1}=0$）：$\log(\mu_A) = \beta_0$。因此，$\beta_0$ 代表了对照组的平均对数表达水平。
- 处理组样本（$x_{i,1}=1$）：$\log(\mu_B) = \beta_0 + \beta_1$。
因此，$\beta_1 = \log(\mu_B) - \log(\mu_A) = \log(\mu_B/\mu_A)$。在这种参数化下，系数 $\beta_1$ 正是我们感兴趣的[对数倍数变化](@entry_id:272578)（LFC）。

要从模型中正式地检验某个效应（例如，$\beta_1$ 是否为零），我们使用**对比向量（contrast vector）** $c$。对于上述模型，检验 LFC 的对比向量是 $c = (0, 1)^\top$，因为 $c^\top \boldsymbol{\beta} = 0 \cdot \beta_0 + 1 \cdot \beta_1 = \beta_1$。[设计矩阵](@entry_id:165826)和对比向量的组合为我们提供了一种精确、灵活且可编程的方式来向数据“提问”。

#### 处理协变量：批次效应与混杂

GLM框架的另一个强大之处在于它能够轻松地处理额外的协变量，例如**[批次效应](@entry_id:265859)（batch effects）**。批次效应是由于实验在不同时间或由不同人员处理而引入的系统性技术变异，如果处理不当，会严重影响分析结果。

我们可以在[设计矩阵](@entry_id:165826)中加入代表批次的[指示变量](@entry_id:266428)来校正批次效应。例如，对于一个包含3个批次的实验，我们可以构建如下模型 ：
$$ \log(\mu_i) = \beta_0 + \beta_{\text{cond}} \cdot \text{condition}_i + \beta_{\text{b2}} \cdot \text{batch2}_i + \beta_{\text{b3}} \cdot \text{batch3}_i $$
这里，`batch1`被设为基准。系数 $\beta_{\text{cond}}$ 现在代表了在**控制了批次效应之后**的条件效应，即在同一批次内部，处理组与对照组之间的平[均差](@entry_id:138238)异。这样的模型估计出的[效应量](@entry_id:177181)更加准确。

在设计实验和模型时，必须注意**混杂（confounding）**的问题 。
- **正交（平衡）设计**：如果每个实验条件在所有批次中都有均等的代表（例如，每个批次都有一半[对照组](@entry_id:747837)和一半处理组），那么条件效应和批次效应是**正交的（orthogonal）**。在这种理想情况下，是否在模型中校正[批次效应](@entry_id:265859)，并不会改变条件效应的[点估计](@entry_id:174544)值，但校正可以吸收掉批次带来的变异，从而降低残差[方差](@entry_id:200758)，提高检验的统计功效。
- **完全混杂设计**：如果实验设计存在严重缺陷，例如所有[对照组](@entry_id:747837)样本都在批次1，所有处理组样本都在批次2，那么条件效应和批次效应就完全混杂了。在这种情况下，[设计矩阵](@entry_id:165826)是**[秩亏](@entry_id:754065)的（rank-deficient）**，模型参数是**不可识别的（non-identifiable）**。数据本身无法区分观测到的差异是源于生物学条件还是技术批次。任何对纯粹条件效应的估计都是不可能的，除非引入数据之外的强假设。

### 统计推断：从估计到结论

在建立模型并获得[参数估计](@entry_id:139349)后，我们需要进行统计推断，以判断观测到的效应是否显著。

#### [假设检验](@entry_id:142556)：[似然比检验](@entry_id:268070)

在GLM框架中，一个强大而通用的[假设检验](@entry_id:142556)方法是**[似然比检验](@entry_id:268070)（Likelihood Ratio Test, LRT）** 。LRT通过比较两个[嵌套模型](@entry_id:635829)的[拟合优度](@entry_id:637026)来工作：
- **全模型（Full Model）** $\mathcal{M}_1$：包含我们感兴趣的参数（例如，代表LFC的系数 $\beta_1$）。
- **简化模型（Reduced Model）** $\mathcal{M}_0$：在[原假设](@entry_id:265441)（$H_0: \beta_1=0$）下，将该参数固定为零的模型。

[检验统计量](@entry_id:167372)是两个模型最大似然值的比率，通常以对数形式表示：
$$ -2\log\Lambda = -2(\ell(\hat{\theta}_0) - \ell(\hat{\theta}_1)) $$
其中 $\ell(\hat{\theta}_0)$ 和 $\ell(\hat{\theta}_1)$ 分别是在简化模型和全模型下获得的最大[对数似然](@entry_id:273783)。这个统计量衡量的是，允许 $\beta_1$ 自由变化能在多大程度上改善模型对数据的解释。

根据**[威尔克斯定理](@entry_id:169826)（Wilks' Theorem）**，在原假设成立且满足一定[正则性条件](@entry_id:166962)的情况下，当样本量足够大时，$-2\log\Lambda$ 统计量近似服从一个**卡方（$\chi^2$）[分布](@entry_id:182848)**。其自由度 $r$ 等于全模型与简化模型之间参数数量的差异。在检验单个LFC系数时，$r=1$。值得注意的是，模型中共同存在的其他“滋扰参数”（nuisance parameters），如[离散度](@entry_id:168823)参数 $\phi$，以及作为偏移量的文库大小因子，均不影响此自由度的计算。

#### [效应量](@entry_id:177181) vs. P值：[统计显著性](@entry_id:147554)与生物学意义

统计检验会产生一个**P值（p-value）**，它代表在[原假设](@entry_id:265441)为真的情况下，观测到当前或更极端结果的概率。P值越小，我们越有理由拒绝[原假设](@entry_id:265441)。然而，解读P值时必须极其小心，因为它并不等同于效应的生物学重要性 。

- 一个极小的P值（例如，$10^{-8}$）可能仅仅反映了一个拥有极大样本量、从而能以极高精度估计出的、但大小微不足道（例如，LFC $\approx 0.07$）的效应。这被称为**统计上显著但生物学上不重要**。
- 相反，一个较大的、不显著的P值（例如，$0.09$）可能伴随着一个很大的[效应量](@entry_id:177181)估计（例如，LFC $\approx 1.5$）。这通常发生在样本量小、统计功效不足的研究中。我们观测到了一个可能具有重要生物学意义的巨大变化，但由于数据量太少，不确定性太高，无法在统计上确认它。

因此，[效应量](@entry_id:177181)（LFC）和P值提供了互补而非冗余的信息。LFC衡量变化的**幅度**，而P值衡量我们对该变化非零的**信心**。在评估[差异表达](@entry_id:748396)结果时，必须同时考虑两者。仅仅依据P值阈值进行筛选，可能会丢弃有潜在重要价值的基因，或被大量无实际意义的微小变化所淹没。

#### 跨基因[借力](@entry_id:167067)：[经验贝叶斯收缩](@entry_id:748954)

在典型的RNA-seq实验中，我们通常面临“大G，小n”的困境：基因数量（$G$）成千上万，而生物学重复数量（$n$）往往很有限。这导致单个基因的LFC估计值 $\hat{\beta}_j$ 可能非常不稳定、噪声很大。

**[经验贝叶斯](@entry_id:171034)（Empirical Bayes, EB）**方法为此提供了一个优雅的解决方案 。其核心思想是**跨基因[借力](@entry_id:167067)（borrowing strength across genes）**。它假设所有基因的真实[效应量](@entry_id:177181) $\beta_j$ 都来自于一个共同的先验分布 $g(\beta)$。这个先验分布通常被建模为以零为中心的（即假设大多[数基](@entry_id:634389)因没有[差异表达](@entry_id:748396)或效应很小）。通过同时分析数千个基因的观测效应 $\hat{\beta}_j$，我们可以从数据中“经验地”学习到这个先验分布 $g(\beta)$ 的形状。

一旦确定了先验分布，对于任何一个基因 $j$，其[效应量](@entry_id:177181)的后验估计就不再仅仅依赖于它自身的数据（[似然](@entry_id:167119)），而是其[似然](@entry_id:167119)与从所有基因中学到的先验知识的折衷。这导致了对LFC估计值的**自适应收缩（adaptive shrinkage）**：
- 对于那些测量噪声很大（即标准误 $s_j$ 很大）或者观测值 $|\hat{\beta}_j|$ 本身就很小的基因，它们的估计值会被更强烈地向零“收缩”。
- 对于那些信号强、噪声小的基因，它们的估计值则更多地保留原始信息。

这种[收缩方法](@entry_id:167472)能够有效地平滑噪声，提供更稳定和可靠的[效应量](@entry_id:177181)排序。此外，这个贝叶斯框架还允许我们计算比P值更直观的误差度量，例如**局部伪[符号率](@entry_id:271903)（local false sign rate, lfsr）**。lfsr定义为在报告一个基因的效应方向（上调或下调）时，犯符号错误的[后验概率](@entry_id:153467)。它直接量化了我们对效应方向判断的信心，为基因排序提供了一个有吸[引力](@entry_id:175476)的替代方案。

### 扩展到单细胞数据

上述原理大多也适用于[单细胞RNA测序](@entry_id:142269)（[scRNA-seq](@entry_id:155798)）数据，但[scRNA-seq](@entry_id:155798)数据呈现出一些独特的统计挑战，需要对模型进行扩展。

#### [scRNA-seq](@entry_id:155798)的独特挑战：零膨胀

与汇集了成千上万个细胞信号的“平均”图景的批量（bulk）RNA-seq不同，[scRNA-seq](@entry_id:155798)在单个细胞层面进行测量。这种高分辨率揭示了bulk数据中被掩盖的特征，其中最突出的是**零膨胀（zero-inflation）** 。[scRNA-seq](@entry_id:155798)数据中观测到的零值数量远远超过了标准的泊松或负二项分布所能解释的范畴。

这种现象主要有两个来源：
1.  **生物学来源**：[基因转录](@entry_id:155521)本质上是一个随机的、脉冲式的过程（**[转录爆发](@entry_id:156205)**）。在捕获细胞的瞬间，某个基因可能恰好处于转录沉默期，导致其mRNA分子数量为真正的零。
2.  **技术来源**：单个细胞中的mRNA含量极低。在[逆转录](@entry_id:141572)和扩增过程中，一些低表达的转录本可能未能被成功捕获和测序，导致一个技术性的、非真实的零计数（**dropout**）。

相比之下，在bulk [RNA-seq](@entry_id:140811)中，由于信号是大量细胞的加和，只要一个基因在少数细胞中有所表达，其总计数就极不可能是零。因此，零膨胀是[scRNA-seq](@entry_id:155798)数据的一个标志性特征。

#### 零膨胀负二项（ZINB）模型

为了同时处理过离散和零膨胀，**零膨胀负二项（Zero-Inflated Negative Binomial, ZINB）**模型应运而生 。[ZINB模型](@entry_id:756826)是一个双组分[混合模型](@entry_id:266571)：
1.  一个**伯努利“门控”**过程，以概率 $\pi$ 决定一个观测值是否为“结构性零”（即来自零膨胀部分的零）。
2.  若未被“门控”为零（以概率 $1-\pi$），则该观测值从一个标准的[负二项分布](@entry_id:262151)中抽取。

因此，一个ZINB[随机变量](@entry_id:195330) $Y$ 的[概率质量函数](@entry_id:265484)为：
$$ P(Y=y) = \begin{cases} \pi + (1-\pi)P_{\text{NB}}(0)  \text{if } y=0 \\ (1-\pi)P_{\text{NB}}(y)  \text{if } y > 0 \end{cases} $$
这里的 $P(Y=0)$ 由两部分构成：结构性零（概率为 $\pi$）和来自NB[分布](@entry_id:182848)的抽样零（概率为 $(1-\pi)P_{\text{NB}}(0)$）。

[ZINB模型](@entry_id:756826)的均值和[方差](@entry_id:200758)分别为：
$$ E[Y] = (1-\pi)\mu $$
$$ \mathrm{Var}(Y) = (1-\pi)\mu(1+\pi\mu) + (1-\pi)\frac{\mu^2}{k} $$
其中 $\mu$ 和 $k$ 是NB部分的均值和[离散度](@entry_id:168823)参数。这个[方差](@entry_id:200758)表达式展示了比标准N[B模型](@entry_id:159413)更复杂的、由零膨胀引入的额外变异。

在ZINB框架下进行[差异表达分析](@entry_id:266370)变得更加复杂。一个实验条件的变化可能影响三个参数中的任何一个：改变表达细胞的平均表达量（$\mu$）、改变表达细胞的比例（通过 $\pi$），或改变细胞间的变异性（通过 $k$）。因此，对scRNA-seq数据的[差异表达分析](@entry_id:266370)需要更复杂的模型来分别或联合地检验这些不同类型的变化，而不能简单地将零值视为纯粹的技术噪音并丢弃。