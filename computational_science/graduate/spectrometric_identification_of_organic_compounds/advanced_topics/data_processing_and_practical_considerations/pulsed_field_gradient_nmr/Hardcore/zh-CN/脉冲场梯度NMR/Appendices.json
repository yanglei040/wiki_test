{
    "hands_on_practices": [
        {
            "introduction": "脉冲场梯度核磁共振（PFG NMR）的强大之处在于它能将分子的位移定量地编码为可测量的信号衰减。第一个练习将引导你完成 $b$ 值（$b$-factor）的推导，这是概括所有实验条件的核心参数。通过从第一性原理出发并进行量纲分析，你将建立坚实的理论基础，并随即将该理论应用于一个涉及硬件限制的实际实验设计任务中。",
            "id": "3719997",
            "problem": "您正在设计一个脉冲场梯度核磁共振（PFG NMR）扩散实验，以通过物质的自扩散系数来分辨物质，从而辅助有机化合物的波谱鉴定。考虑一个沿实验室$z$轴施加的一维线性磁场梯度，其中有两个幅度为$G$、持续时间为$\\delta$的相同矩形梯度脉冲，其中心间距为一个扩散时间$\\Delta$。假设各向同性的自由扩散、上升/下降时间可忽略的矩形脉冲、理想的重聚焦（因此只有扩散失相导致信号衰减），并忽略弛豫和伴随场。\n\n(a) 从自旋在时变梯度场中位置$z(t)$处的相位累积定义出发，\n$$\n\\phi(t) = \\gamma \\int_{0}^{t} G(t')\\, z(t')\\, dt',\n$$\n其中$\\gamma$是旋磁比，并利用对于高斯分布位移，回波衰减服从$\\langle \\exp(i \\phi) \\rangle = \\exp\\!\\left(-\\tfrac{1}{2}\\langle \\phi^{2} \\rangle\\right)$这一事实，推导扩散系数为$D$的回波衰减形式$E = \\exp(-b D)$，并确定参数$b$的国际单位制（SI）量纲。明确验证$b$在国际单位制基本单位下的量纲一致性。\n\n(b) 对于上述双脉冲矩形梯度波形，推导$b$关于$\\gamma$、$G$、$\\delta$和$\\Delta$的表达式。\n\n(c) 一项目标实验要求质子的$b$值为$b = 5 \\times 10^{9}\\ \\mathrm{s\\ m^{-2}}$，硬件限制为$G \\leq 0.6\\ \\mathrm{T\\ m^{-1}}$和$\\delta \\leq 4\\ \\mathrm{ms}$。取质子旋磁比为$\\gamma = 2.675\\,222\\,005 \\times 10^{8}\\ \\mathrm{rad\\ s^{-1}\\ T^{-1}}$。利用(b)部分的结果，选择$G$和$\\delta$为其硬件极限值以最小化$\\Delta$，并计算达到目标$b$值所需的最小扩散时间$\\Delta$。将$\\Delta$的最终答案以毫秒表示，并四舍五入到三位有效数字。",
            "solution": "本题涉及脉冲场梯度（PFG）核磁共振（NMR）扩散测量的原理。题目分为三部分：信号衰减公式的一般性推导、一个常用脉冲序列的具体推导，以及一个实际实验设计的数值计算。\n\n(a) 回波衰减形式的推导及$b$因子的量纲分析。\n\n我们已知回波衰减$E$是施加梯度与不施加梯度时信号的比值，即相位因子的系综平均，$E = \\langle \\exp(i \\phi) \\rangle$。对于高斯过程，其位移呈正态分布，该式可简化为$E = \\exp(-\\frac{1}{2}\\langle \\phi^{2} \\rangle)$。在时变梯度$G(t)$中，位于$z(t)$处的自旋所累积的相位$\\phi$由下式给出：\n$$ \\phi(t_{E}) = \\gamma \\int_{0}^{t_{E}} G(t')\\, z(t')\\, dt' $$\n其中$\\gamma$是旋磁比，$t_{E}$是实验中梯度编码部分的总持续时间。\n\n为求$\\langle \\phi^2 \\rangle$，我们必须计算扩散自旋系综的均方相位。\n$$ \\langle \\phi^2 \\rangle = \\left\\langle \\left( \\gamma \\int_{0}^{t_{E}} G(t')\\, z(t')\\, dt' \\right)^2 \\right\\rangle = \\gamma^2 \\int_{0}^{t_{E}} dt_1 \\int_{0}^{t_{E}} dt_2 \\, G(t_1) G(t_2) \\langle z(t_1) z(t_2) \\rangle $$\n项$\\langle z(t_1) z(t_2) \\rangle$是位置-位置相关函数。对于一维各向同性自由扩散，从$z(0)=0$开始，该函数为$\\langle z(t_1) z(t_2) \\rangle = 2D \\min(t_1, t_2)$，其中$D$是自扩散系数。虽然这条路径能得到正确结果，但一个更简洁的方法是对相位表达式进行分部积分。令$v(t') = \\int_0^{t'} G(t'') dt''$。则$dv = G(t') dt'$。令$u = z(t')$。\n$$ \\phi = \\gamma \\left( \\left[ z(t')v(t') \\right]_0^{t_E} - \\int_0^{t_E} v(t') \\dot{z}(t') dt' \\right) $$\n对于任何具有“理想重聚焦”的有效PFG序列，梯度对静止自旋的净效应为零。这要求有效梯度波形的时间积分为零，$\\int_0^{t_E} G(t') dt' = 0$。这意味着$v(t_E)=0$。由于根据定义$v(0)=0$，边界项消失。因此相位为：\n$$ \\phi = - \\gamma \\int_0^{t_E} v(t') \\dot{z}(t') dt' = - \\gamma \\int_0^{t_E} \\left( \\int_0^{t'} G(t'') dt'' \\right) \\dot{z}(t') dt' $$\n现在，我们计算均方相位：\n$$ \\langle \\phi^2 \\rangle = \\gamma^2 \\int_0^{t_E} dt_1 \\int_0^{t_E} dt_2 \\left( \\int_0^{t_1} G(t'') dt'' \\right) \\left( \\int_0^{t_2} G(t''') dt''' \\right) \\langle \\dot{z}(t_1) \\dot{z}(t_2) \\rangle $$\n对于描述自由扩散的维纳过程，速度-速度相关函数是一个狄拉克$\\delta$函数：$\\langle \\dot{z}(t_1) \\dot{z}(t_2) \\rangle = 2D \\delta(t_1 - t_2)$。将此代入$\\langle \\phi^2 \\rangle$的表达式中：\n$$ \\langle \\phi^2 \\rangle = \\gamma^2 \\int_0^{t_E} dt_1 \\int_0^{t_E} dt_2 \\left( \\int_0^{t_1} G(t'') dt'' \\right) \\left( \\int_0^{t_2} G(t''') dt''' \\right) 2D \\delta(t_1 - t_2) $$\n对$t_2$积分，$\\delta$函数消失：\n$$ \\langle \\phi^2 \\rangle = 2D \\gamma^2 \\int_0^{t_E} \\left( \\int_0^{t'} G(t'') dt'' \\right)^2 dt' $$\n于是回波衰减为$E = \\exp(-\\frac{1}{2}\\langle\\phi^2\\rangle) = \\exp \\left( -D \\gamma^2 \\int_0^{t_E} \\left( \\int_0^{t'} G(t'') dt'' \\right)^2 dt' \\right)$。\n这具有$E = \\exp(-bD)$的形式，其中$b$因子定义为：\n$$ b = \\gamma^2 \\int_0^{t_E} \\left( \\int_0^{t'} G(t'') dt'' \\right)^2 dt' $$\n为确定$b$的国际单位制量纲，我们分析所涉及各量的量纲。令$[X]$表示量$X$的量纲。\n在国际单位制中，各量纲为：\n$[\\gamma] = \\mathrm{s^{-1} T^{-1}}$（注意：弧度是无量纲的）\n$[G] = \\mathrm{T\\ m^{-1}}$\n$[t] = \\mathrm{s}$\n$[D] = \\mathrm{m^2\\ s^{-1}}$\n\n$E=\\exp(-bD)$中指数的参数必须是无量纲的。因此，$[b][D] = 1$。\n$[b] = [D]^{-1} = (\\mathrm{m^2\\ s^{-1}})^{-1} = \\mathrm{s\\ m^{-2}}$。\n$b$的国际单位制单位是秒每平方米。\n\n我们可以从$b$的积分定义来验证这一点。\n内层积分的量纲为：$[\\int G dt''] = [G][t] = \\mathrm{T\\ m^{-1}\\ s}$。\n其平方的量纲为：$(\\mathrm{T\\ m^{-1}\\ s})^2 = \\mathrm{T^2\\ m^{-2}\\ s^2}$。\n外层积分的量纲为：$[(\\mathrm{T^2\\ m^{-2}\\ s^2})][t] = \\mathrm{T^2\\ m^{-2}\\ s^3}$。\n最后，$b$的完整表达式的量纲为：\n$[b] = [\\gamma^2] \\mathrm{T^2\\ m^{-2}\\ s^3} = (\\mathrm{s^{-1}\\ T^{-1}})^2 \\mathrm{T^2\\ m^{-2}\\ s^3} = \\mathrm{s^{-2}\\ T^{-2}\\ T^2\\ m^{-2}\\ s^3} = \\mathrm{s\\ m^{-2}}$。\n这证实了量纲的一致性。在国际单位制基本单位中，特斯拉为$\\mathrm{T} = \\mathrm{kg\\ A^{-1}\\ s^{-2}}$：\n$[b] = \\mathrm{s\\ m^{-2}}$。这已经是基本单位（秒、米）的形式，不需要进一步分解。\n\n(b) 矩形脉冲序列的$b$值推导。\n\n该序列由两个幅度为$G$、持续时间为$\\delta$的相同矩形梯度脉冲组成。在标准的自旋回波或受激回波PFG实验中，重聚焦机制确保静止自旋不产生净相位累积。这等效于一个有效梯度波形$G(t')$，其中第二个脉冲相对于第一个脉冲符号相反。我们假设采用标准的Stejskal-Tanner时序，其中第一个脉冲在$t=0$开始，第二个脉冲在$t=\\Delta$开始。\n有效梯度波形为：\n$$ G(t') = \\begin{cases} +G   \\text{if } 0 \\le t'  \\delta \\\\ 0  \\text{if } \\delta \\le t'  \\Delta \\\\ -G  \\text{if } \\Delta \\le t'  \\Delta+\\delta \\\\ 0  \\text{otherwise} \\end{cases} $$\n我们必须计算在不同时间区间内的$F(t') = \\int_0^{t'} G(t'') dt''$。\n1.  对于$0 \\le t'  \\delta$：$F(t') = \\int_0^{t'} G \\, dt'' = G t'$。\n2.  对于$\\delta \\le t'  \\Delta$：$F(t') = \\int_0^{\\delta} G \\, dt'' + \\int_{\\delta}^{t'} 0 \\, dt'' = G\\delta$。\n3.  对于$\\Delta \\le t'  \\Delta+\\delta$：$F(t') = \\int_0^{\\delta} G \\, dt'' + \\int_{\\Delta}^{t'} (-G) \\, dt'' = G\\delta - G(t'-\\Delta) = G(\\delta+\\Delta-t')$.\n4.  对于$t' \\ge \\Delta+\\delta$：$F(t') = \\int_0^{\\delta} G \\, dt'' + \\int_{\\Delta}^{\\Delta+\\delta} (-G) \\, dt'' = G\\delta - G\\delta = 0$。\n\n现在我们通过对三个非零区间的积分求和来计算$b = \\gamma^2 \\int_0^{\\infty} [F(t')]^2 dt'$：\n$$ b = \\gamma^2 \\left[ \\int_0^{\\delta} (Gt')^2 dt' + \\int_{\\delta}^{\\Delta} (G\\delta)^2 dt' + \\int_{\\Delta}^{\\Delta+\\delta} (G(\\delta+\\Delta-t'))^2 dt' \\right] $$\n计算每个积分：\n$$ \\int_0^{\\delta} G^2 t'^2 dt' = G^2 \\left[ \\frac{t'^3}{3} \\right]_0^{\\delta} = \\frac{G^2\\delta^3}{3} $$\n$$ \\int_{\\delta}^{\\Delta} G^2 \\delta^2 dt' = G^2\\delta^2 \\left[ t' \\right]_{\\delta}^{\\Delta} = G^2\\delta^2(\\Delta-\\delta) $$\n对于第三个积分，令$u = \\delta+\\Delta-t'$，则$du = -dt'$。积分上下限从$t'=\\Delta \\to u=\\delta$和$t'=\\Delta+\\delta \\to u=0$改变。\n$$ \\int_{\\delta}^{0} G^2 u^2 (-du) = G^2 \\int_0^{\\delta} u^2 du = G^2 \\left[ \\frac{u^3}{3} \\right]_0^{\\delta} = \\frac{G^2\\delta^3}{3} $$\n将三部分相加：\n$$ b = \\gamma^2 \\left( \\frac{G^2\\delta^3}{3} + G^2\\delta^2(\\Delta-\\delta) + \\frac{G^2\\delta^3}{3} \\right) = \\gamma^2 G^2 \\left( \\frac{2\\delta^3}{3} + \\delta^2\\Delta - \\delta^3 \\right) $$\n$$ b = \\gamma^2 G^2 \\left( \\delta^2\\Delta - \\frac{\\delta^3}{3} \\right) $$\n此表达式通常写为：\n$$ b = (\\gamma G \\delta)^2 \\left( \\Delta - \\frac{\\delta}{3} \\right) $$\n\n(c) 最小扩散时间$\\Delta$的计算。\n\n我们已知目标$b$值和硬件限制。我们需要找到最小的$\\Delta$。相关参数的方程是(b)部分的结果。我们首先重新整理方程以求解$\\Delta$：\n$$ \\frac{b}{(\\gamma G \\delta)^2} = \\Delta - \\frac{\\delta}{3} $$\n$$ \\Delta = \\frac{b}{(\\gamma G \\delta)^2} + \\frac{\\delta}{3} $$\n要对固定的目标$b$值最小化$\\Delta$，我们必须最大化$(\\gamma G \\delta)^2$项。由于$\\gamma$是常数，这可以通过使用梯度幅度$G$和持续时间$\\delta$的最大允许值来实现。\n给定的值，转换为国际单位制基本单位后为：\n$b = 5 \\times 10^{9}\\ \\mathrm{s\\ m^{-2}}$\n$G = 0.6\\ \\mathrm{T\\ m^{-1}}$\n$\\delta = 4\\ \\mathrm{ms} = 4 \\times 10^{-3}\\ \\mathrm{s}$\n$\\gamma = 2.675222005 \\times 10^{8}\\ \\mathrm{rad\\ s^{-1}\\ T^{-1}}$\n\n首先，计算复合项$\\gamma G \\delta$：\n$$ \\gamma G \\delta = (2.675222005 \\times 10^{8}\\ \\mathrm{s^{-1}\\ T^{-1}}) \\times (0.6\\ \\mathrm{T\\ m^{-1}}) \\times (4 \\times 10^{-3}\\ \\mathrm{s}) $$\n$$ \\gamma G \\delta = 642053.2812\\ \\mathrm{m^{-1}} $$\n接下来，将此值平方：\n$$ (\\gamma G \\delta)^2 = (642053.2812\\ \\mathrm{m^{-1}})^2 \\approx 4.122324 \\times 10^{11}\\ \\mathrm{m^{-2}} $$\n现在，将此值代入$\\Delta$的表达式中：\n$$ \\Delta = \\frac{5 \\times 10^{9}\\ \\mathrm{s\\ m^{-2}}}{4.122324 \\times 10^{11}\\ \\mathrm{m^{-2}}} + \\frac{4 \\times 10^{-3}\\ \\mathrm{s}}{3} $$\n$$ \\Delta \\approx 0.01212906\\ \\mathrm{s} + 0.00133333\\ \\mathrm{s} $$\n$$ \\Delta \\approx 0.01346239\\ \\mathrm{s} $$\n题目要求答案以毫秒为单位，所以我们从秒转换：\n$$ \\Delta \\approx 13.46239\\ \\mathrm{ms} $$\n四舍五入到三位有效数字，我们得到：\n$$ \\Delta \\approx 13.5\\ \\mathrm{ms} $$\n这是在给定硬件限制下达到目标$b$值所需的最小扩散时间。",
            "answer": "$$\\boxed{13.5}$$"
        },
        {
            "introduction": "精确的扩散测量依赖于一个基本假设：分子的位移主要由无规热运动引起。然而，诸如对流之类的整体流体运动会引入巨大的、系统性的位移，从而破坏数据。最后一个练习将通过推导对流效应压倒扩散效应的临界条件，来探讨这一关键问题，并思考在实验中如何减弱这一常见干扰的实用方法。",
            "id": "3719992",
            "problem": "考虑一个使用脉冲梯度自旋回波 (PGSE) 方法的脉冲场梯度核磁共振 (PFG NMR) 实验，实验对象为一种有机化合物溶液，其中存在具有均匀轴向速度的整体对流。设梯度波矢量 $q$ 固定为由实验梯度设定的某个值。假设核自旋进行一维布朗运动，具有恒定的漂移速度和菲克扩散特性。在扩散编码时间内，位移被建模为一个高斯随机变量，其平均漂移与速度和时间成正比，方差与扩散系数和时间成正比。对于窄脉冲近似下的 PGSE，相关的扩散编码时间可以取为梯度间隔 $ \\Delta $。\n\n从带漂移的布朗运动和 PGSE 位移编码框架的第一性原理出发，推导一个定量判据，用于判断在何种情况下对流“主导”扩散，即确定性对流平均位移超过编码时间内的均方根扩散位移。求解所得判据，得到发生对流主导现象的临界 $ \\Delta $ 值。\n\n然后，对于一个漂移速度 $v = 100\\,\\mathrm{\\mu m \\cdot s^{-1}}$ 和扩散系数 $D = 1 \\times 10^{-9}\\,\\mathrm{m^2 \\cdot s^{-1}}$ 的样品，计算该临界 $ \\Delta $，并将最终数值以秒为单位表示，保留三位有效数字。简要讨论当存在对流时，实验者在 PFG NMR 中可以采取哪些实际的缓解措施，以使测量保持在扩散主导的区域内。\n\n你最终报告的答案应该只是计算出的临界 $ \\Delta $ 的单个数值，以秒为单位表示。",
            "solution": "本问题要求我们比较在时间间隔 $\\Delta$ 内，由对流引起的位移和由扩散引起的位移，从而确定对流效应占主导的条件。\n\n1.  **对流与扩散位移的数学模型**\n\n    粒子的运动被建模为一维布朗运动，包含一个恒定的漂移速度 $v$（对流）和一个扩散系数为 $D$ 的随机分量。\n    \n    *   **对流位移**：对流是一种确定性的整体运动。在时间 $\\Delta$ 内，由对流引起的平均位移为：\n        $$ \\langle \\delta z_{\\text{conv}} \\rangle = v \\Delta $$\n    \n    *   **扩散位移**：扩散是一个随机过程。根据爱因斯坦-斯摩洛霍夫斯基关系，在一维空间中，粒子在时间 $\\Delta$ 内的均方位移 (MSD) 为：\n        $$ \\langle (\\delta z_{\\text{diff}})^2 \\rangle = 2 D \\Delta $$\n        问题中定义的“均方根扩散位移” (RMSD) 是该值的平方根：\n        $$ \\text{RMSD}_{\\text{diff}} = \\sqrt{\\langle (\\delta z_{\\text{diff}})^2 \\rangle} = \\sqrt{2 D \\Delta} $$\n\n2.  **对流主导判据及临界时间 $\\Delta_c$ 的推导**\n\n    根据问题定义，当对流平均位移超过均方根扩散位移时，对流效应“主导”扩散。其数学表达式为：\n    $$ \\langle \\delta z_{\\text{conv}} \\rangle > \\text{RMSD}_{\\text{diff}} $$\n    $$ v \\Delta > \\sqrt{2 D \\Delta} $$\n    临界时间 $\\Delta_c$ 是指两种效应相等的时刻，它标志着从扩散主导区到对流主导区的转变点。\n    $$ v \\Delta_c = \\sqrt{2 D \\Delta_c} $$\n    为求解 $\\Delta_c$，我们将方程两边平方（$\\Delta_c$ 必须为正值）：\n    $$ v^2 \\Delta_c^2 = 2 D \\Delta_c $$\n    由于对于非平凡实验 $\\Delta_c \\neq 0$，我们可以用 $\\Delta_c$ 去除等式两边：\n    $$ v^2 \\Delta_c = 2 D $$\n    由此得到临界扩散时间的最终表达式：\n    $$ \\Delta_c = \\frac{2 D}{v^2} $$\n    当实验的扩散时间 $\\Delta$ 大于此临界值 $\\Delta_c$ 时，对流效应将主导信号衰减。\n\n3.  **数值计算**\n\n    使用给定的参数进行计算：\n    *   $v = 100\\,\\mathrm{\\mu m \\cdot s^{-1}} = 1.00 \\times 10^{-4}\\,\\mathrm{m \\cdot s^{-1}}$\n    *   $D = 1 \\times 10^{-9}\\,\\mathrm{m^2 \\cdot s^{-1}}$\n\n    将这些值代入 $\\Delta_c$ 的表达式中：\n    $$ \\Delta_c = \\frac{2 \\times (1 \\times 10^{-9}\\,\\mathrm{m^2 \\cdot s^{-1}})}{(1 \\times 10^{-4}\\,\\mathrm{m \\cdot s^{-1}})^2} = \\frac{2 \\times 10^{-9}}{1 \\times 10^{-8}}\\,\\mathrm{s} = 0.2\\,\\mathrm{s} $$\n    保留三位有效数字，临界时间为 $0.200\\,\\mathrm{s}$。\n\n4.  **实际缓解措施的讨论**\n\n    为了获得可靠的扩散数据，实验应尽量在扩散主导的区域（即 $\\Delta  \\Delta_c$）进行。当对流成为问题时，可以采取以下策略：\n\n    *   **物理抑制**：最直接的方法是减少流体本身的运动。样品中的热梯度是对流的主要驱动力。可以通过改善温控单元的稳定性和均匀性、使用更小直径的样品管（如3 mm管）或特殊样品管（如Shigemi管）来抑制大规模对流的形成。\n    *   **脉冲序列补偿**：这是更常用和强大的方法。可以设计专门的脉冲序列来主动补偿由恒速流动引起的相位变化，同时保留对随机扩散的敏感性。\n        *   **缩短 $\\Delta$**：从推导可知，对流位移与 $\\Delta$ 成正比，而扩散位移与 $\\sqrt{\\Delta}$ 成正比。因此，在保证足够信噪比和扩散衰减的前提下，使用尽可能短的 $\\Delta$ 是最简单的策略。\n        *   **对流补偿序列**：使用包含双极脉冲场梯度（Bipolar Pulsed Field Gradient, BPPFG）的序列，如 BPP-STE（双极脉冲对-激发回波）或 BPP-LED（纵向涡流延迟）。在这些序列中，每个扩散编码模块由两个极性相反、面积相等的梯度脉冲组成。对于以恒定速度运动的自旋，第一个脉冲产生的相移会被第二个脉冲精确抵消，从而消除对流对信号的影响。而随机的扩散运动不会被重聚焦，其引起的信号衰减仍然可以被测量，从而能够准确提取扩散系数 $D$。这是目前克服对流伪影最稳健和有效的方法。",
            "answer": "$$\n\\boxed{0.200}\n$$"
        }
    ]
}