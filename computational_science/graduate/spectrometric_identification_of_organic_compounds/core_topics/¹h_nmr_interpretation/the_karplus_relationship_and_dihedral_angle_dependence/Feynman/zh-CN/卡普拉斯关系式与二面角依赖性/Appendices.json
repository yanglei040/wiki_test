{
    "hands_on_practices": [
        {
            "introduction": "Karplus 关系式为我们提供了将二面角与耦合常数相关联的定量工具。本练习旨在通过计算关键构象（如邻交叉和反式共平面）的耦合常数，并解释其对分子构象偏好的意义，来巩固您对该方程的基本应用和物理直觉 。",
            "id": "3727285",
            "problem": "在核磁共振（NMR）波谱学中，邻位质子-质子自旋-自旋耦合常数（记为 $^{3}J$）主要源于自旋信息通过费米接触相互作用经由化学键的传递，并依赖于耦合核之间的二面角 $\\phi$。根据经验和理论，$^{3}J(\\phi)$ 是一个周期为 $360^{\\circ}$ 的函数，其极值对应于居间化学键的特定轨道排列构型。请仅使用以下物理约束：$^{3}J(\\phi)$ 是关于 $\\phi$ 的周期函数，周期为 $360^{\\circ}$；其主要角度依赖性由与键轨道重叠一致的低阶余弦谐波捕捉；取代基各向异性可以打破 $\\phi$ 和 $-\\phi$ 之间的对称性，推导出一个包含三个参数的 $^{3}J(\\phi)$ 的最小余弦级数表示。然后，对于一个由 $A=7.0$、$B=-1.0$ 和 $C=0.5$ 表征的Karplus型三参数模型，计算在 $\\phi=60^{\\circ}$、$\\phi=120^{\\circ}$ 和 $\\phi=180^{\\circ}$ 时的 $J(\\phi)$ 值。将您的数值结果四舍五入到四位有效数字，并以赫兹（Hz）为单位表示最终值。最后，根据构象偏好（例如，反叠构象与邻位交叉构象）解释这些 $J$ 值的相对大小，并讨论在 $\\phi=60^{\\circ}$ 和 $\\phi=120^{\\circ}$ 之间的不对称性对取代基环境意味着什么。在本题中，角度 $\\phi$ 应始终以度为单位处理。",
            "solution": "该问题陈述被评估为有效。它在科学上基于核磁共振（NMR）波谱学的原理，特别是Karplus关系式。该问题提法恰当，为进行一组唯一的计算和基于已建立的化学理论进行合理的解释提供了足够的信息。尽管在讨论对称性时存在潜在的模糊性，但这可以通过对广义Karplus方程及其内在物理意义的标准解释来解决，从而使问题内部一致且可解。\n\n按照问题的要求，解答分为三个部分：函数形式的推导、特定耦合常数的计算以及结果的解释。\n\n**第一部分：Karplus型方程的推导**\n\n问题要求推导邻位耦合常数 $^{3}J$ 作为二面角 $\\phi$ 函数的一个最小三参数表示。给定的约束是：\n1. $^{3}J(\\phi)$ 是一个周期为 $360^{\\circ}$（或 $2\\pi$ 弧度）的周期函数。\n2. 主要的角度依赖性由低阶余弦谐波描述。\n3. 模型应包含三个可调参数。\n\n一个周期为 $2\\pi$ 的周期函数可以表示为傅里叶级数。使用余弦谐波的约束导出了一个余弦级数表示：\n$$ J(\\phi) = C_0 + \\sum_{n=1}^{\\infty} C_n \\cos(n\\phi) $$\n“最小”表示和“低阶”谐波的指令意味着截断此级数。通过包含到 $n=2$ 的项，可以实现一个三参数模型：\n$$ J(\\phi) = C_0 + C_1 \\cos(\\phi) + C_2 \\cos(2\\phi) $$\n此表达式代表了最通用的三参数余弦级数。为了将其与更常见的Karplus方程形式联系起来，我们使用三角恒等式 $\\cos(2\\phi) = 2\\cos^2(\\phi) - 1$：\n$$ J(\\phi) = C_0 + C_1 \\cos(\\phi) + C_2 (2\\cos^2(\\phi) - 1) $$\n按 $\\cos(\\phi)$ 的幂次重新整理各项，得到：\n$$ J(\\phi) = (2C_2) \\cos^2(\\phi) + C_1 \\cos(\\phi) + (C_0 - C_2) $$\n此方程具有 $A \\cos^2(\\phi) + B \\cos(\\phi) + C$ 的一般形式，其中参数被确定为 $A = 2C_2$、$B = C_1$ 和 $C = C_0 - C_2$。这是广泛认可的广义Karplus方程，其从截断的余弦级数的推导过程因此得以展示。\n\n问题陈述中提到“取代基各向异性可以打破 $\\phi$ 和 $-\\phi$ 之间的对称性”。这在数学上需要在傅里葉展开中包含正弦项，因为 $\\sin(n\\phi)$ 是一个奇函数。一个纯余弦级数，以及因此推导出的形式 $A \\cos^2(\\phi) + B \\cos(\\phi) + C$，是一个偶函数，意味着 $J(\\phi) = J(-\\phi)$。问题接着使用了一组针对此对称形式的特定参数。这表明我们正在考虑一个特定的情况，其中导致 $\\phi \\leftrightarrow -\\phi$ 不对称性的效应是可忽略的，或者在此模型中被忽略了。然而，如下文所示，$B \\cos(\\phi)$ 项引入了另一种不对称性，即相对于 $\\phi = 90^{\\circ}$ 的不对称性。\n\n**第二部分：耦合常数的计算**\n\n问题为Karplus型模型提供了一组特定的参数：$A=7.0$、$B=-1.0$ 和 $C=0.5$。耦合常数以赫兹（Hz）为单位。控制方程为：\n$$ J(\\phi) = 7.0 \\cos^2(\\phi) - 1.0 \\cos(\\phi) + 0.5 $$\n我们需要计算 $\\phi = 60^{\\circ}$、$\\phi = 120^{\\circ}$ 和 $\\phi = 180^{\\circ}$ 时 $J(\\phi)$ 的值。注意三角函数的参数以度为单位。\n\n对于 $\\phi = 60^{\\circ}$：\n$ \\cos(60^{\\circ}) = \\frac{1}{2} = 0.5 $\n$$ J(60^{\\circ}) = 7.0 (\\frac{1}{2})^2 - 1.0 (\\frac{1}{2}) + 0.5 $$\n$$ J(60^{\\circ}) = 7.0(0.25) - 0.5 + 0.5 = 1.75 $$\n四舍五入到四位有效数字，$J(60^{\\circ}) = 1.750$ Hz。\n\n对于 $\\phi = 120^{\\circ}$：\n$ \\cos(120^{\\circ}) = -\\frac{1}{2} = -0.5 $\n$$ J(120^{\\circ}) = 7.0 (-\\frac{1}{2})^2 - 1.0 (-\\frac{1}{2}) + 0.5 $$\n$$ J(120^{\\circ}) = 7.0(0.25) + 0.5 + 0.5 = 1.75 + 1.0 = 2.75 $$\n四舍五入到四位有效数字，$J(120^{\\circ}) = 2.750$ Hz。\n\n对于 $\\phi = 180^{\\circ}$：\n$ \\cos(180^{\\circ}) = -1 $\n$$ J(180^{\\circ}) = 7.0 (-1)^2 - 1.0 (-1) + 0.5 $$\n$$ J(180^{\\circ}) = 7.0(1) + 1.0 + 0.5 = 8.5 $$\n四舍五入到四位有效数字，$J(180^{\\circ}) = 8.500$ Hz。\n\n**第三部分：结果的解释**\n\n计算出的耦合常数分别为 $J(60^{\\circ}) = 1.750$ Hz，$J(120^{\\circ}) = 2.750$ Hz，和 $J(180^{\\circ}) = 8.500$ Hz。\n\n- **构象偏好**：二面角 $\\phi=180^{\\circ}$ 对应于*反叠*构象，而 $\\phi=60^{\\circ}$ 对应于*邻位交叉*构象。结果显示，反叠排列的耦合常数（$8.500$ Hz）远大于邻位交叉排列的耦合常数（$1.750$ Hz）。这是使用NMR进行构象分析的基石。邻位耦合的大小与C-H键轨道的重叠有关，重叠在平面排列（$\\phi=0^{\\circ}, 180^{\\circ}$）时最大化，在垂直排列（$\\phi=90^{\\circ}$）时最小化。在自由旋转的体系中，观察到的是时间平均的耦合常数。一个大的实验 $^{3}J$ 值（通常为 $8-13$ Hz）意味着对反叠构象有强烈的偏好，而一个小的数值（通常为 $1-5$ Hz）则表明邻位交叉构象占主导地位。计算出的值对于这些不同的构象是典型的。\n\n- **不对称性与取代基环境**：问题要求解释 $J(60^{\\circ})$ 和 $J(120^{\\circ})$ 之间的不对稱性。我们发现 $J(60^{\\circ}) = 1.750$ Hz 和 $J(120^{\\circ}) = 2.750$ Hz。这两个值不相等。这种不等式展示了Karplus曲线相对于 $\\phi=90^{\\circ}$ 的不对称性。在方程 $J(\\phi) = A \\cos^2(\\phi) + B \\cos(\\phi) + C$ 中，$A \\cos^2(\\phi)$ 和 $C$ 项关于 $\\phi=90^{\\circ}$ 是对称的，因为 $\\cos^2(90^{\\circ}+\\delta) = \\cos^2(90^{\\circ}-\\delta)$。然而，$B \\cos(\\phi)$ 项关于 $\\phi=90^{\\circ}$ 是反对称的，因为 $\\cos(90^{\\circ}+\\delta) = -\\sin(\\delta)$ 而 $\\cos(90^{\\circ}-\\delta) = \\sin(\\delta)$。因此，一个非零的 $B$ 值打破了关于 $\\phi=90^{\\circ}$ 的对称性。在我们的例子中，$B=-1.0$。差值为 $J(120^{\\circ}) - J(60^{\\circ}) = (A/4 - B/2 + C) - (A/4 + B/2 + C) = -B = -(-1.0) = 1.0$ Hz，这与我们的计算结果（$2.750 - 1.750 = 1.0$）相符。\n物理上，$B$ 参数解释了电负性取代基对碳骨架的影响。在一个对称体系中，如未取代的乙烷（H-CH$_2$-CH$_2$-H），$B$ 值会接近于零。一个非零 $B$ 项的存在，以及因此导致的像 $60^{\\circ}$ 和 $120^{\\circ}$ 这样角度的耦合常数之间的不对称性，表明存在一个不对称的取代基环境，例如，由于其中一个碳上存在电负性原子，它以角度依赖的方式扰动了成键框架的电子结构。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.750  2.750  8.500 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在现代科学实践中，我们不仅使用模型，更要构建和验证模型。本练习将引导您完成一个计算任务，将模拟的理论计算数据拟合到Karplus方程，并使用严格的统计检验（F检验）来判断是否需要引入更高阶的谐波项 。这种方法是定量分析光谱数据、选择最佳物理模型的基石。",
            "id": "3727283",
            "problem": "您的任务是实现一个程序，该程序将 H–C–C–H 片段中的邻位质子-质子核磁共振标量耦合模拟为二面角的周期函数，并执行统计模型比较。目标是测试在截断余弦级数中包含更高次的谐波是否能有意义地改善对模拟密度泛函理论 (DFT) 计算耦合的确定性数据的拟合。\n\n背景与基本原理：对于核磁共振 (NMR) 中的邻位耦合，耦合常数对二面角的依赖性是周期性的，因为旋转一整圈会使分子几何保持不变。这表明可以将耦合表示为二面角的傅里叶余弦级数。在建模方面，通过最小化残差平方和来估计系数等同于普通最小二乘法，这是最小二乘法的标准推论。对于嵌套模型，确定一个附加项是否产生统计上显著的改进的标准方法是使用基于残差平方和与自由度的 $F$ 检验。\n\n实现以下任务：\n\n1) 建模假设：\n- 设二面角用 $\\phi$ 表示。角度以度为单位提供；在计算三角函数时，您必须将 $\\phi$ 转换为弧度。\n- 考虑两个嵌套模型：\n  - 2阶基本模型：一个截断到二次谐波的余弦级数，具有三个参数：一个常数项以及 $\\cos(\\phi)$ 和 $\\cos(2\\phi)$ 的系数。\n  - 3阶增广模型：基本模型加上第四个参数，用于 $\\cos(3\\phi)$。\n- 使用普通最小二乘法，通过最小化残差平方和来对每个数据集拟合这两个模型。\n\n2) 统计比较：\n- 对于每个数据集，计算基本模型的残差平方和（表示为 $RSS_2$）和增广模型的残差平方和（表示为 $RSS_3$）。设 $N$ 为观测次数，$p_2 = 3$ 为基本模型的参数个数，$p_3 = 4$ 为增广模型的参数个数。\n- 计算用于检验附加的 $\\cos(3\\phi)$ 项是否显著改善拟合的 $F$ 统计量：\n  $$F \\;=\\; \\frac{(RSS_2 - RSS_3)/(p_3 - p_2)}{RSS_3/(N - p_3)}.$$\n- 使用自由度为 $df_1 = p_3 - p_2$ 和 $df_2 = N - p_3$ 的 $F$ 分布的累积分布函数计算相应的双边 $p$ 值，并在 $\\alpha = 0.05$ 的水平下确定显著性。\n- 在所有计算中，将三角函数参数视为弧度。将报告的 $F$ 统计量和 $p$ 值四舍五入到六位小数。\n\n3) 测试套件：\n您必须评估三个模拟带有小的确定性扰动的DFT计算耦合的数据集（所有耦合单位均为赫兹）。对于每个数据集，使用以下公式确定性地生成数据对 $\\{(\\phi_i, J_i)\\}$\n$$J_i \\;=\\; A + B\\cos(\\phi_i) + C\\cos(2\\phi_i) + D\\cos(3\\phi_i) + \\varepsilon(\\phi_i),$$\n其中，在三角函数中 $\\phi_i$ 以弧度为单位，并且确定性扰动 $\\varepsilon(\\phi)$ 对每个数据集的定义如下所述。下面的数组 $\\{\\phi_i\\}$ 以度为单位提供；您必须在程序内部将其转换为弧度。\n\n- 数据集1（理想情况；无三次谐波）：\n  - 角度（度）：$[0,30,60,90,120,150,180,210,240,270,300,330]$。\n  - 参数：$A = 7.2$，$B = -1.1$，$C = 2.3$，$D = 0.0$。\n  - 扰动：$\\varepsilon(\\phi) = 0.15 \\sin(5\\phi)$，其中 $\\phi$ 以弧度为单位。\n\n- 数据集2（需要增广；存在三次谐波）：\n  - 角度（度）：$[15,45,75,105,135,165,195,225,255,285,315,345]$。\n  - 参数：$A = 7.2$，$B = -1.1$，$C = 2.3$，$D = 0.9$。\n  - 扰动：$\\varepsilon(\\phi) = 0.12 \\cos(7\\phi)$，其中 $\\phi$ 以弧度为单位。\n\n- 数据集3（边缘情况；最小样本量；无三次谐波）：\n  - 角度（度）：$[0,72,144,216,288]$。\n  - 参数：$A = 7.0$，$B = 0.0$，$C = 2.0$，$D = 0.0$。\n  - 扰动：$\\varepsilon(\\phi) = 0.05 \\sin(3\\phi)$，其中 $\\phi$ 以弧度为单位。\n\n4) 要求输出：\n- 对于每个数据集，按顺序输出一个包含三个元素的列表：$F$ 统计量（四舍五入到六位小数）、$p$ 值（四舍五入到六位小数）以及一个布尔值，指示增广模型在 $\\alpha = 0.05$ 水平下是否显著。\n- 将三个数据集各自的结果聚合成一个单一列表，并按以下格式将该列表作为单行输出打印：一个用方括号括起来的逗号分隔列表。例如： \"[[F1,p1,significant1],[F2,p2,significant2],[F3,p3,significant3]]\"。\n- 最终数字中无需报告物理单位；角度仅在输入中以度为单位，所有三角函数求值必须使用弧度。\n\n您的程序必须是一个单一、完整的脚本，不需要任何输入，并严格按照指定格式打印一行输出。",
            "solution": "该问题被评估为有效。它提出了一个在计算化学和统计学领域中定义明确的任务，其基础是核磁共振 (NMR) 波谱学和回归分析的既定原理。该问题要求使用截断傅里叶余弦级数对邻位质子-质子耦合常数 ($J$) 对二面角 ($\\phi$) 的周期性依赖关系进行建模，并对两个嵌套模型进行统计比较。\n\n解决方案的理论基础建立在两个主要支柱之上：用于模型拟合的普通最小二乘法 (OLS) 和用于嵌套模型比较的 $F$ 检验。\n\n**1. 建模与普通最小二乘法 (OLS)**\n\n邻位耦合 $J$ 对二面角 $\\phi$ 的依赖性通过余弦函数的线性组合来建模。我们被要求比较两个模型：\n- 2阶基本模型：\n$$J(\\phi) = \\beta_0 + \\beta_1 \\cos(\\phi) + \\beta_2 \\cos(2\\phi) + \\epsilon$$\n该模型有 $p_2 = 3$ 个参数（$\\beta_0$, $\\beta_1$, $\\beta_2$）。\n\n- 3阶增广模型：\n$$J(\\phi) = \\beta_0 + \\beta_1 \\cos(\\phi) + \\beta_2 \\cos(2\\phi) + \\beta_3 \\cos(3\\phi) + \\epsilon$$\n该模型增加了一个参数 $\\beta_3$，总共有 $p_3 = 4$ 个参数。\n\n对于一个给定的包含 $N$ 个观测值 $\\{(\\phi_i, J_i)\\}_{i=1}^N$ 的数据集，每个模型都可以用矩阵形式表示为 $y \\approx X\\beta$，其中 $y$ 是观测到的 $J_i$ 值的 $N \\times 1$ 向量，$X$ 是 $N \\times p$ 的设计矩阵，$\\beta$ 是 $p \\times 1$ 的参数向量。设计矩阵的列是在每个 $\\phi_i$ 处求值的基函数。对于增广模型，设计矩阵 $X_3$ 为：\n$$\nX_3 = \\begin{pmatrix}\n1  \\cos(\\phi_1)  \\cos(2\\phi_1)  \\cos(3\\phi_1) \\\\\n1  \\cos(\\phi_2)  \\cos(2\\phi_2)  \\cos(3\\phi_2) \\\\\n\\vdots  \\vdots  \\vdots  \\vdots \\\\\n1  \\cos(\\phi_N)  \\cos(2\\phi_N)  \\cos(3\\phi_N)\n\\end{pmatrix}\n$$\n基本模型的设计矩阵 $X_2$ 由 $X_3$ 的前三列组成。请注意，所有三角函数都必须使用弧度角进行计算。\n\nOLS方法找到最小化残差平方和 ($RSS$) 的参数向量 $\\hat{\\beta}$，定义为 $RSS = \\sum_{i=1}^N (J_i - \\hat{J}_i)^2$，其中 $\\hat{J}_i$ 是模型的预测值。解通常由 $\\hat{\\beta} = (X^T X)^{-1} X^T y$ 给出。在数值上，使用基于矩阵分解的方法更为稳健，例如 `numpy.linalg.lstsq` 中实现的方法，它可以处理多重共线性的情况。即使参数 $\\hat{\\beta}$ 不是唯一的（由于秩亏设计矩阵），$RSS$ 的值也是唯一确定的。\n\n**2. 使用F检验进行统计比较**\n\n$F$ 检验用于确定增广模型是否比嵌套的基本模型在拟合优度上有统计上显著的改进。检验统计量 $F$ 是根据基本模型的 $RSS$ ($RSS_2$) 和增广模型的 $RSS$ ($RSS_3$) 计算的：\n$$F = \\frac{(RSS_2 - RSS_3) / (p_3 - p_2)}{RSS_3 / (N - p_3)}$$\n在原假设（即附加参数 $\\beta_3$ 为零）下，此统计量服从自由度为 $df_1 = p_3 - p_2 = 1$ 和 $df_2 = N - p_3$ 的 $F$ 分布。\n\n$p$ 值是在假设原假设为真的情况下，观测到至少与计算出的 $F$ 统计量一样极端的概率。它是根据 $F$ 分布的累积分布函数 (CDF) 计算的：$p = P(\\mathcal{F}_{df_1, df_2} \\ge F_{obs})$。如果 $p$ 值小于显著性水平 $\\alpha = 0.05$，我们拒绝原假设，并得出结论：包含 $\\cos(3\\phi)$ 项为模型提供了显著的改进。\n\n**3. 测试数据集的实现**\n\n对于所提供的三个数据集中的每一个，执行以下过程：\n- 首先，根据指定的公式 $J_i = A + B\\cos(\\phi_i) + C\\cos(2\\phi_i) + D\\cos(3\\phi_i) + \\varepsilon(\\phi_i)$ 生成数据点 $\\{(\\phi_i, J_i)\\}$。输入的以度为单位的角度被转换为弧度，用于三角函数计算。\n- 构建设计矩阵 $X_2$（大小为 $N \\times 3$）和 $X_3$（大小为 $N \\times 4$）。\n- 使用 `numpy.linalg.lstsq` 函数将基本模型和增广模型拟合到生成的数据。该函数返回，除其他外，每个模型的最小化 $RSS$，我们将其表示为 $RSS_2$ 和 $RSS_3$。\n- 使用上述公式计算 $F$ 统计量和相应的 $p$ 值。使用 `scipy.stats.f.sf`（生存函数，即 $1 - \\text{CDF}$）计算 $p$ 值。\n- 将每个数据集的结果——$F$ 统计量、$p$ 值（均四舍五入到六位小数）以及一个指示显著性（$p  0.05$）的布尔值——进行汇编。\n\n**关于数据集3的说明：** 这个数据集构成了一个特殊的“边缘情况”，有 $N=5$ 个数据点，角度为 $\\phi_k = k \\cdot 72^\\circ$，其中 $k \\in \\{0, 1, 2, 3, 4\\}$。对于这组特定的角度，增广模型中出现了完全多重共线性的情况，因为回归量 $\\cos(2\\phi)$ 和 $\\cos(3\\phi)$ 变得相同。这可以用恒等式 $\\cos(3\\phi_k) = \\cos(3 \\cdot k \\cdot 2\\pi/5) = \\cos(5k \\cdot 2\\pi/5 - 2k \\cdot 2\\pi/5) = \\cos(2\\pi k - 2\\phi_k) = \\cos(2\\phi_k)$ 来证明。\n因此，设计矩阵 $X_3$ 是秩亏的（其秩为 $3$，而不是 $4$），并且增广模型的参数不是唯一可识别的。然而，$X_3$ 的列空间与 $X_2$ 的列空间相同。这意味着数据到两个模型空间上的投影是相同的，导致相同的拟合值和相同的残差。因此，$RSS_2 = RSS_3$。将此代入 $F$ 统计量公式，得到 $F=0$，相应的 $p$ 值为 $1$。分析仍然是明确定义的，并正确地得出结论：增广模型没有提供任何改进。\n\n最终程序将系统地将此方法应用于所有三个数据集，并按要求格式化输出。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import f\n\ndef solve():\n    \"\"\"\n    Main function to perform model comparison for three datasets.\n    \"\"\"\n\n    def generate_data(angles_deg, params, perturbation_func):\n        \"\"\"Generates J-coupling data based on model parameters and a perturbation.\"\"\"\n        phi_rad = np.deg2rad(angles_deg)\n        A, B, C, D = params\n        J = A + B * np.cos(phi_rad) + C * np.cos(2 * phi_rad) + D * np.cos(3 * phi_rad)\n        J += perturbation_func(phi_rad)\n        return phi_rad, J\n\n    def perform_analysis(angles_deg, params, perturbation_func):\n        \"\"\"\n        Performs OLS fitting and F-test for a single dataset.\n        \n        Args:\n            angles_deg (np.array): Dihedral angles in degrees.\n            params (tuple): A, B, C, D coefficients for the data generation.\n            perturbation_func (function): A function phi -> epsilon(phi) for perturbations.\n\n        Returns:\n            list: A list containing [F-statistic, p-value, significant_boolean].\n        \"\"\"\n        phi_rad, J = generate_data(angles_deg, params, perturbation_func)\n        N = len(angles_deg)\n        \n        # Model parameters\n        p2 = 3  # Base model (order 2)\n        p3 = 4  # Augmented model (order 3)\n\n        # ---- Base Model (order 2) ----\n        # Design matrix X2 for model J = b0 + b1*cos(phi) + b2*cos(2*phi)\n        X2 = np.vstack([np.ones(N), np.cos(phi_rad), np.cos(2 * phi_rad)]).T\n        \n        # Perform OLS using numpy.linalg.lstsq\n        _, res2, _, _ = np.linalg.lstsq(X2, J, rcond=None)\n        RSS2 = res2[0] if len(res2) > 0 else np.sum((J - X2 @ np.linalg.lstsq(X2, J, rcond=None)[0])**2)\n\n        # ---- Augmented Model (order 3) ----\n        # Design matrix X3 for model J = b0 + b1*cos(phi) + b2*cos(2*phi) + b3*cos(3*phi)\n        X3 = np.vstack([np.ones(N), np.cos(phi_rad), np.cos(2 * phi_rad), np.cos(3 * phi_rad)]).T\n\n        # Perform OLS\n        _, res3, _, _ = np.linalg.lstsq(X3, J, rcond=None)\n        RSS3 = res3[0] if len(res3) > 0 else np.sum((J - X3 @ np.linalg.lstsq(X3, J, rcond=None)[0])**2)\n\n        # ---- F-test for nested models ----\n        df1 = p3 - p2\n        df2 = N - p3\n\n        # Check for division by zero or invalid RSS values\n        if RSS3 == 0 or df2 = 0:\n            # Handle the case where RSS3 or degrees of freedom are not positive.\n            # For Dataset 3, RSS2=RSS3, so the numerator is 0.\n            if RSS2 == RSS3:\n                f_stat = 0.0\n            else:\n                # This case shouldn't be reached with the given problems but is a safe fallback.\n                f_stat = np.inf \n        else:\n            f_stat = ((RSS2 - RSS3) / df1) / (RSS3 / df2)\n\n        # Calculate p-value from the F-distribution survival function (1-CDF)\n        p_value = f.sf(f_stat, df1, df2)\n\n        # Significance at alpha = 0.05\n        alpha = 0.05\n        is_significant = p_value  alpha\n        \n        # Round to 6 decimal places for output\n        f_stat_rounded = round(f_stat, 6)\n        p_value_rounded = round(p_value, 6)\n        \n        return [f_stat_rounded, p_value_rounded, is_significant]\n\n    # Definition of test cases from the problem statement\n    test_cases = [\n        {\n            \"angles_deg\": np.array([0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330]),\n            \"params\": (7.2, -1.1, 2.3, 0.0),\n            \"perturbation\": lambda phi: 0.15 * np.sin(5 * phi)\n        },\n        {\n            \"angles_deg\": np.array([15, 45, 75, 105, 135, 165, 195, 225, 255, 285, 315, 345]),\n            \"params\": (7.2, -1.1, 2.3, 0.9),\n            \"perturbation\": lambda phi: 0.12 * np.cos(7 * phi)\n        },\n        {\n            \"angles_deg\": np.array([0, 72, 144, 216, 288]),\n            \"params\": (7.0, 0.0, 2.0, 0.0),\n            \"perturbation\": lambda phi: 0.05 * np.sin(3 * phi)\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = perform_analysis(case[\"angles_deg\"], case[\"params\"], case[\"perturbation\"])\n        all_results.append(result)\n\n    # Convert boolean to lowercase 'true'/'false' for string formatting\n    output_str = \"[\"\n    for i, res in enumerate(all_results):\n        # Format: [F, p, significant_bool]\n        f_val, p_val, is_sig = res\n        output_str += f\"[{f_val},{p_val},{str(is_sig).lower()}]\"\n        if i  len(all_results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "真实的波谱解析往往是一个综合多种证据、进行逻辑推理的复杂过程。这个案例研究将挑战您综合分析多维核磁共振数据（如COSY、NOESY）、连接性信息和几何约束，以区分不同类型的自旋耦合 。通过解决这个难题，您将学会如何像一名结构化学家一样，从看似不完整或模棱两可的数据中提炼出关于分子三维结构的关键信息。",
            "id": "3727327",
            "problem": "一个饱和六元环的孤立片段，由于在碳原子 $C1$ 和 $C4$ 上的两个大体积取代基，其构象被锁定为椅式几何构型，这使得在 $T = 298\\,\\text{K}$ 时环的翻转变得不利。两个质子，分别标记为 $H_{a}$ 和 $H_{b}$，位于 $C2$ 和 $C5$ 上。在氘代氯仿中于 $600\\,\\text{MHz}$ 下进行的高场质子核磁共振 (NMR) 光谱显示，$H_{a}$ 和 $H_{b}$ 各自解析为一级多重峰，其主要特征是与各自近邻质子的邻位耦合：$H_{a}$ 与 $C3$ 和 $C4$ 上的质子耦合，$H_{b}$ 与 $C4$ 和 $C6$ 上的质子耦合。根据轴向/平伏向关系，耦合常数在 $8.5$–$12.0\\,\\text{Hz}$ 的范围内。在这些裂分模式上，还叠加了一个额外的、微小的、对称的 $0.8\\,\\text{Hz}$ 裂分，通过选择性辐照实验可以追溯到这是由 $H_{a}$ 和 $H_{b}$ 之间的相互作用引起的：对 $H_{a}$ 或 $H_{b}$ 的任何一个邻位近邻质子进行连续波辐照，只会使相应的大邻位裂分消失，但 $0.8\\,\\text{Hz}$ 的特征保持不变。$H_{a}$ 和 $H_{b}$ 之间的化学位移差为 $0.30\\,\\text{ppm}$，在 $600\\,\\text{MHz}$ 谱仪上对应于 $180\\,\\text{Hz}$。二维相关谱 (COSY) 显示 $H_{a}$ 和 $H_{b}$ 之间有一个弱的交叉峰，而核奥弗豪泽效应谱 (NOESY) 显示 $H_{a}$ 和 $H_{b}$ 之间没有高于噪音水平的交叉弛豫，这与非邻近的、通过化学键的相互作用相符。异核单量子相干谱 (HSQC) 和异核多键相关谱 (HMBC) 明确地将 $H_{a}$ 归属到 $C2$，将 $H_{b}$ 归属到 $C5$，其最短的成键路径为 $C2$–$C3$–$C4$–$C5$（四根键）。一种保留了环构象的类似物的单晶 X 射线衍射结果报告了关于 $C2$–$C3$ 和 $C3$–$C4$ 的扭转角分别约为 $180^{\\circ}$ 和 $180^{\\circ}$，这在 $H_{a}$ 和 $H_{b}$ 之间沿着 $C2$–$C3$–$C4$–$C5$ 路径建立了一个锯齿形的“W”型排列。在两种溶剂（氘代氯仿和氘代二甲基亚砜）中，于 $238$–$315\\,\\text{K}$ 温度范围内进行的变温 $^{1}\\text{H}$ NMR 实验显示，这个 $0.8\\,\\text{Hz}$ 的裂分在实验误差范围内持续存在。\n\n仅利用通过费米接触机制的键合自旋-自旋耦合的基本原理、邻位耦合对二面角的定性依赖关系（Karplus 型关系）以及饱和体系中长程“W”型耦合的几何要求，判断观测到的 $H_{a}$ 和 $H_{b}$ 之间的 $0.8\\,\\text{Hz}$ 相互作用，应被解释为由于近乎正交的几何构型而减弱的 $^{3}J$ 耦合，还是一个真正的 $^{4}J$ 耦合。哪个选项提供了最科学一致的理由？\n\nA. 这个 $0.8\\,\\text{Hz}$ 的相互作用是 $H_{a}$ 和 $H_{b}$ 之间因二面角接近 $90^{\\circ}$ 而减弱的邻位 $^{3}J_{\\text{HH}}$ 耦合，这一点由其较小的值和缺乏 NOE 效应所支持。\n\nB. 这个 $0.8\\,\\text{Hz}$ 的相互作用是一个真正的长程 $^{4}J_{\\text{HH}}$ “W”型耦合，它沿着 $C2$–$C3$–$C4$–$C5$ 路径传递，并受到连续的反式共平面扭转角的有利影响，这与四键连接性、弱的 COSY 交叉峰以及对温度/溶剂的不变性相一致。\n\nC. 这个 $0.8\\,\\text{Hz}$ 的特征是在溶液中部分取向产生的剩余偶极耦合，与成键网络无关，这解释了它在不同条件下为何持续存在。\n\nD. 这个 $0.8\\,\\text{Hz}$ 的特征是由于共振频率接近简并而产生的二级“虚拟耦合”假象；即使 $H_{a}$ 和 $H_{b}$ 没有直接耦合，在对一个共同的近邻质子进行去耦时它也会消失。",
            "solution": "基本依据是，质子核磁共振 (NMR) 中的标量自旋-自旋耦合主要源于费米接触机制，该机制通过电子密度经由化学键传递自旋信息。对于邻位质子-质子耦合 $^{3}J_{\\text{HH}}$，其大小取决于耦合质子之间的二面角 $\\phi$，在共线排列（$\\phi \\approx 0^{\\circ}, 180^{\\circ}$）时显示最大值，而在几何构型接近正交（$\\phi \\approx 90^{\\circ}$）时显示最小值。这种定性依赖关系通常由 Karplus 型关系描述，是经验性的但得到了充分支持，此处无需明确的公式。对于如 $^{4}J_{\\text{HH}}$ 这样的长程耦合，在特定的“W”型几何构型中，通过化学键的传递可以很高效，这通常发生在连续的扭转角为反式共平面且拓扑结构提供了有利的轨道重叠和超共轭途径时。\n\n我们分析数据如下：\n\n1. 连接性：HSQC/HMBC 的归属将 $H_{a}$ 定位于 $C2$，$H_{b}$ 定位于 $C5$，最短路径为 $C2$–$C3$–$C4$–$C5$，即四根化学键。因此，$H_{a}$ 和 $H_{b}$ 不是邻位关系。仅从连接性来看，它们之间的相互作用不可能是 $^{3}J_{\\text{HH}}$；它必须是 $^{4}J_{\\text{HH}}$ 或更高阶的耦合。\n\n2. 几何构型：X 射线衍射测得的关于 $C2$–$C3$ 和 $C3$–$C4$ 的扭转角近似为 $180^{\\circ}$ 和 $180^{\\circ}$。这在 $H_{a}$ 到 $H_{b}$ 之间产生了一个锯齿形排列，与跨越四根键的“W”路径一致。已知这种排列在饱和环中支持可测量的 $^{4}J_{\\text{HH}}$，其值通常在亚赫兹到几赫兹的范围内，与观测到的 $0.8\\,\\text{Hz}$ 相符。\n\n3. 大小和选择性：在 $T = 238$–$315\\,\\text{K}$ 的温度范围和两种溶剂中，该相互作用始终保持在 $0.8\\,\\text{Hz}$，即使其他邻位耦合随着构象和介电常数的变化而略有移动。对邻位近邻质子的选择性辐照仅消除了大的邻位裂分（$8.5$–$12.0\\,\\text{Hz}$），而 $0.8\\,\\text{Hz}$ 的裂分保持不变，这表明这个小的裂分不是通过一个共同的近邻质子传递的，而是直接在 $H_{a}$ 和 $H_{b}$ 之间沿着多键路径产生的。\n\n4. 一级行为：$H_{a}$ 和 $H_{b}$ 之间的化学位移差为 $0.30\\,\\text{ppm}$，在 $600\\,\\text{MHz}$ 下对应于 $\\Delta \\nu \\approx 180\\,\\text{Hz}$。给定 $J = 0.8\\,\\text{Hz}$，比率 $J/\\Delta \\nu \\approx 0.0044 \\ll 0.1$，完全在弱耦合极限内。在这些条件下，二级效应（包括导致多重峰畸变的虚拟耦合）可以忽略不计，而干净、对称的 $0.8\\,\\text{Hz}$ 裂分与一个真正的标量耦合常数相符。\n\n5. 偶极相互作用：剩余偶极耦合需要在各向异性介质中实现部分取向。实验是在各向同性的氘代溶剂中进行的，并且观察到的特征是常规的标量裂分，而不是依赖于取向的模式。在不同溶剂和温度下（这些变化不改变取向）的不变性排除了剩余偶极耦合是其来源的可能性。\n\n6. NOESY：$H_{a}$ 和 $H_{b}$ 之间没有 NOESY 交叉峰，这与它们在空间上不邻近的排列相符，但 NOE 反映的是通过空间的弛豫，而不是通过化学键的标量耦合。它的缺失既不能支持也不能反对标量耦合的存在；它仅仅表明该耦合不能归因于空间上的邻近性。\n\n综合以上各点，四键连接性、有利的“W”型几何构型、在预期范围内的耦合常数值、弱的 COSY 交叉峰（如果足够强，COSY 可以显示长程耦合）以及在实验操作下的持续存在，共同支持这是一个真正的 $^{4}J_{\\text{HH}}$ 长程耦合，而不是一个邻位 $^{3}J_{\\text{HH}}$ 耦合。\n\n逐个选项分析：\n\nA. 该选项声称这是一个由于 $\\phi \\approx 90^{\\circ}$ 而减弱的邻位 $^{3}J_{\\text{HH}}$ 耦合。虽然 Karplus 型推理正确地预测了在近正交几何构型下 $^{3}J_{\\text{HH}}$ 会很小，但 $H_{a}$ 和 $H_{b}$ 并非邻位关系；它们相隔四根键（$C2$–$C3$–$C4$–$C5$）。因此，这种解释与已确定的连接性相矛盾。结论：不正确。\n\nB. 该选项将 $0.8\\,\\text{Hz}$ 的裂分归因于沿 $C2$–$C3$–$C4$–$C5$ 路径的真正的 $^{4}J_{\\text{HH}}$ “W”型耦合，这种耦合受到反式共平面扭转角的有利影响，并得到弱 COSY 信号、对温度/溶剂的不变性以及选择性辐照实验证据的支持。这与通过化学键耦合的基本机制、几何构型和耦合常数值都相符。结论：正确。\n\nC. 该选项将该特征归因于部分取向产生的剩余偶极耦合。在各向同性溶液中，不存在剩余偶极耦合，且实验中未使用取向介质。观察到的行为和实验条件与此解释相矛盾。结论：不正确。\n\nD. 该选项暗示这是一个由于近简并频率引起的二级虚拟耦合假象。频率差为 $180\\,\\text{Hz}$，而 $J = 0.8\\,\\text{Hz}$，这使得该体系稳固地处于一级谱区域。此外，对近邻质子的选择性去耦并未消除 $0.8\\,\\text{Hz}$ 的特征，如果这是一个传递来的假象，则应该会消失。结论：不正确。\n\n因此，科学上一致的解释是，观测到的 $0.8\\,\\text{Hz}$ 相互作用是一个真正的 $^{4}J_{\\text{HH}}$ “W”型耦合，而不是一个减弱的邻位 $^{3}J_{\\text{HH}}$ 耦合。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}