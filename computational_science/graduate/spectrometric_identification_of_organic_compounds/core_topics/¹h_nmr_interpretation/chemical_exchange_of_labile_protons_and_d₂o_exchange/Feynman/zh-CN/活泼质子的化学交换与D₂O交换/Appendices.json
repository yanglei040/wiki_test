{
    "hands_on_practices": [
        {
            "introduction": "本练习将我们的知识应用于一个核心场景：未知物结构解析。您将学习如何综合运用多种波谱信息，并通过 D₂O 交换后信号的消失来准确识别和计数分子中的活性质子。这项实践将使您熟练掌握利用 D₂O 交换这一简洁而有效的方法来确认羟基、胺基等官能团。",
            "id": "3695986",
            "problem": "一种未知的电中性有机化合物通过高分辨率质谱（HRMS）表征，其分子式为 $\\text{C}_7\\text{H}_7\\text{NO}_2$。红外光谱（IR）显示了一个强的羰基伸缩振动吸收峰和一个与氢键化羟基一致的宽信号。碳-13核磁共振（$^{13}$C NMR）光谱揭示了一个位于低场的共振信号，表明存在一个羰基碳，以及六个芳香碳，这与一个对位二取代苯环的结构一致。在非交换溶剂中进行的质子核磁共振（$^{1}$H NMR）光谱显示，总积分强度对应于 $7$ 个质子，其芳香区图谱与对位二取代环一致，并有额外的归因于杂原子键合质子的低场/宽信号。当在确保所有活泼氢完全交换的条件下加入氧化氘（$\\text{D}_2\\text{O}$）时，活泼位点被完全氘代。\n\n利用核磁共振（NMR）信号积分和同位素取代的基本原理，确定当 $m$ 个可交换位点完全氘代后，观测到的总 $^{1}$H 数量的预期减少量，记为 $\\Delta n_{^{1}\\text{H}}$。然后，仅使用给定的光谱推论和分子式，验证计算出的 $\\Delta n_{^{1}\\text{H}}$ 与对位二取代苯环的不可交换芳香质子数是否一致。请用一个不带单位的纯数字表示您的最终答案。",
            "solution": "相关的基本事实如下：\n- 在质子核磁共振（$^{1}$H NMR）中，每个共振信号的积分面积与产生该信号的 $^{1}$H 原子核数量成正比。如果积分总和对应于 $n_{^{1}\\text{H, total}}$ 个质子，那么用 $^{2}$H（氘）替换其中一些 $^{1}$H 将使这些原子核在标准的 $^{1}$H 实验中无法被检测到。\n- 氘（$^{2}$H）是自旋为1的原子核，在典型的采集参数下，它在标准的质子检测实验中不产生信号。因此，用D完全交换 $m$ 个活泼质子会使观测到的 $^{1}$H 数量精确地减少 $m$。\n- 活泼氢通常包括与杂原子（如氧（OH）和氮（NH 和 $\\text{NH}_2$））键合的氢，它们在适当条件下会与 $\\text{D}_2\\text{O}$ 发生快速的化学交换。\n\n题目要求我们计算 $\\Delta n_{^{1}\\text{H}}$，即当 $m$ 个可交换位点完全氘代后，总 $^{1}$H 数量的减少量。根据积分与观测到的 $^{1}$H 原子核数量成正比以及交换后的位点从质子通道中移除的原理，减少量为\n$$\n\\Delta n_{^{1}\\text{H}} = m.\n$$\n\n接下来，我们必须根据分子式 $\\text{C}_7\\text{H}_7\\text{NO}_2$ 和光谱推论来确定 $m$，然后验证其与不可交换的芳香质子数的一致性。\n\n我们计算双键当量（DBE）来约束官能团的拓扑结构。对于分子式 $\\text{C}_c\\text{H}_h\\text{N}_n\\text{O}_o\\text{X}_x$ 且不含卤素（$x=0$）的情况，DBE的计算公式为\n$$\n\\text{DBE} = \\frac{2c + 2 + n - h - x}{2}.\n$$\n代入 $c=7$, $h=7$, $n=1$, 和 $x=0$ 可得\n$$\n\\text{DBE} = \\frac{2\\cdot 7 + 2 + 1 - 7 - 0}{2} = \\frac{14 + 2 + 1 - 7}{2} = \\frac{10}{2} = 5.\n$$\n一个对位二取代苯环占了 $4$ 个不饱和度（一个环和三个 $\\pi$ 键），一个羰基占了另外 $1$ 个不饱和度，总DBE为 $5$。这与一个芳香环和一个羰基的结构相符。\n\n分子中存在一个氮和两个氧，以及一个羰基，这表明可能存在一个酰胺官能团 $\\text{CONH}_2$（提供羰基和氮）和一个作为环上取代基的羟基（一个酚类结构）。光谱观察结果支持了这一点：红外光谱表明存在羰基和氢键化的羟基，碳-13核磁共振谱显示一个羰基碳和六个芳香碳，与对位二取代环一致。因此，与杂原子键合的氢是：\n- $\\text{NH}_2$ 上的氢：$2$ 个可交换的 $^{1}$H，\n- $\\text{OH}$ 上的氢：$1$ 个可交换的 $^{1}$H。\n\n因此，可交换位点的数量为\n$$\nm = 2 + 1 = 3,\n$$\n因此，完全氘代后总 $^{1}$H 数量的预期减少量为\n$$\n\\Delta n_{^{1}\\text{H}} = m = 3.\n$$\n\n我们现在验证其与分子式的一致性。氢原子总数为 $7$，芳香环为对位二取代，这意味着环上有 $4$ 个不可交换的芳香 $^{1}$H。剩下的 $3$ 个氢原子必须与杂原子键合，因此是可交换的，这与 $\\text{NH}_2$（$2$个）加上 $\\text{OH}$（$1$个）的情况一致。完全氘代后，观测到的总 $^{1}$H 数量变为\n$$\nn_{^{1}\\text{H, after}} = n_{^{1}\\text{H, before}} - \\Delta n_{^{1}\\text{H}} = 7 - 3 = 4,\n$$\n这与一个对位二取代苯环预期的 $4$ 个芳香质子相匹配。因此，减少量 $\\Delta n_{^{1}\\text{H}} = 3$ 与分子式和光谱推论是一致的。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在学会识别交换质子之后，我们进一步探索交换过程的动力学。本练习将引导您通过分析 NMR 信号随温度变化的特征（特别是在“合并”现象发生时）来估算化学交换的速率。通过这项实践，您将掌握如何将一个关键的光谱现象——两个峰合并为一个宽峰——与交换速率常数 $k_c$ 直接关联，从而定量地连接宏观谱图与微观分子动态。",
            "id": "3696102",
            "problem": "一种二醇在质子拉莫尔频率为 $600.0$ MHz 的室温一维核磁共振（NMR）谱中表现出两个羟基质子共振峰。在交换可忽略不计的低温下，观测到羟基信号的化学位移为 $\\delta_1 = 1.90$ ppm 和 $\\delta_2 = 2.75$ ppm。加热后，这两个羟基共振峰变宽并在一个明确的合并温度下合并为一条单峰。在低温下进行的氧化氘（$\\text{D}_2\\text{O}$）振荡实验消除了两个羟基信号，证实它们是活泼且可交换的。对该交换过程作如下假设：(i) A 和 B 两格点间的双格点交换，布居数相等，且为对称的一级交换（$k_{AB} = k_{BA} = k$）；(ii) 两个格点具有相同的固有横向弛豫速率 $R_2$，且在合并点附近 $R_2 \\ll k$；(iii) 标量耦合和基线扭曲可忽略不计。\n\n从化学交换的双格点 Bloch–McConnell 描述和化学位移的定义出发，推导出等布居数情况下用两格点间的角频率差 $\\Delta \\omega$ 表示的合并条件，然后利用给定数据估算合并时的交换速率 $k_c$。你的步骤应包括：使用谱仪频率将化学位移差转换为以赫兹为单位的频率差，再将其转换为以 $\\text{rad s}^{-1}$ 为单位的角频率 $\\Delta \\omega$，最后应用你从双格点交换形式推导出的合并条件。\n\n将最终数值答案四舍五入至三位有效数字。速率常数以 $\\text{s}^{-1}$ 为单位表示。",
            "solution": "分析始于 Bloch–McConnell 方程，该方程描述了双格点交换系统中复数横向磁化强度的演化。对于布居数相等（$p_A = p_B = 1/2$）、对称一级交换动力学（$k_{AB} = k_{BA} = k$）以及相同横向弛豫速率（$R_{2,A} = R_{2,B} = R_2$）的格点 A 和 B，在慢横向弛豫极限下（$R_2 \\ll k$），从这些方程推导出的线型函数 $I(\\omega)$ 由下式给出：\n\n$$\nI(\\omega) \\propto \\frac{k (\\Delta \\omega)^2}{\\left( \\frac{(\\Delta \\omega)^2}{4} - (\\omega - \\omega_0)^2 \\right)^2 + 4k^2(\\omega - \\omega_0)^2}\n$$\n\n此处，$\\omega_A$ 和 $\\omega_B$ 是两个格点以角频率单位（$\\text{rad s}^{-1}$）表示的拉莫尔频率，$\\Delta \\omega = \\omega_A - \\omega_B$ 是它们之间的频率差，$\\omega_0 = (\\omega_A + \\omega_B)/2$ 是平均频率，$\\omega$ 是变量频率。\n\nNMR 谱的形状由该函数 $I(\\omega)$ 的极大值决定。为了找到这些极大值，我们可以分析分母的极小值。令 $x = \\omega - \\omega_0$。我们寻求该函数相对于 $x$ 的极大值。$I(x)$ 的极大值对应于分母 $D(x)$ 的极小值：\n\n$$\nD(x) = \\left( \\frac{(\\Delta \\omega)^2}{4} - x^2 \\right)^2 + 4k^2x^2\n$$\n\n我们通过将关于 $x$ 的一阶导数设为零来求极值：\n\n$$\n\\frac{dD(x)}{dx} = 2\\left( \\frac{(\\Delta \\omega)^2}{4} - x^2 \\right)(-2x) + 8k^2x = -4x \\left( \\frac{(\\Delta \\omega)^2}{4} - x^2 - 2k^2 \\right) = 0\n$$\n\n该方程在 $x=0$（谱图中心）处有解，以及当括号中的项为零时有解：\n\n$$\nx^2 = \\frac{(\\Delta \\omega)^2}{4} - 2k^2\n$$\n\n为了在谱图中观察到两个独立的峰（即，$x$ 存在实数非零解），方程的右侧必须为正：\n\n$$\n\\frac{(\\Delta \\omega)^2}{4} - 2k^2 > 0 \\implies (\\Delta \\omega)^2 > 8k^2 \\implies |\\Delta \\omega| > 2\\sqrt{2}k\n$$\n\n这是慢交换区域。合并是两个独立的峰合并为一个宽峰的临界点。这发生在上述条件的边界处，即 $x \\neq 0$ 处的两个极大值与 $x=0$ 处的极值点合并。这种情况发生在：\n\n$$\n\\frac{(\\Delta \\omega)^2}{4} - 2k^2 = 0\n$$\n\n求解合并时的速率常数，记为 $k_c$：\n\n$$\n(\\Delta \\omega)^2 = 8k_c^2 \\implies k_c = \\frac{|\\Delta \\omega|}{2\\sqrt{2}}\n$$\n\n这就是推导出的合并条件。现在，我们将此条件应用于所提供的数据。\n\n1.  **计算化学位移差 $\\Delta\\delta$：**\n    给定化学位移为 $\\delta_1 = 1.90 \\, \\text{ppm}$ 和 $\\delta_2 = 2.75 \\, \\text{ppm}$。\n    $$\n    \\Delta\\delta = |\\delta_2 - \\delta_1| = |2.75 - 1.90| \\, \\text{ppm} = 0.85 \\, \\text{ppm}\n    $$\n\n2.  **将 $\\Delta\\delta$ 转换为以赫兹为单位的频率差 $\\Delta\\nu$：**\n    谱仪频率为 $\\nu_{\\text{spec}} = 600.0 \\, \\text{MHz} = 600.0 \\times 10^6 \\, \\text{Hz}$。\n    $$\n    \\Delta\\nu = \\Delta\\delta \\times \\nu_{\\text{spec}} = (0.85 \\times 10^{-6}) \\times (600.0 \\times 10^6 \\, \\text{Hz}) = 0.85 \\times 600.0 \\, \\text{Hz} = 510 \\, \\text{Hz}\n    $$\n\n3.  **将频率差 $\\Delta\\nu$ 转换为角频率差 $\\Delta\\omega$：**\n    角频率和频率之间的关系是 $\\omega = 2\\pi\\nu$。\n    $$\n    \\Delta\\omega = 2\\pi \\Delta\\nu = 2\\pi (510 \\, \\text{s}^{-1}) = 1020\\pi \\, \\text{rad s}^{-1}\n    $$\n\n4.  **计算合并时的交换速率 $k_c$：**\n    使用推导出的合并条件：\n    $$\n    k_c = \\frac{|\\Delta \\omega|}{2\\sqrt{2}} = \\frac{1020\\pi}{2\\sqrt{2}} \\, \\text{s}^{-1} = \\frac{510\\pi}{\\sqrt{2}} \\, \\text{s}^{-1}\n    $$\n    现在，我们计算其数值：\n    $$\n    k_c \\approx \\frac{510 \\times 3.14159265}{1.41421356} \\, \\text{s}^{-1} \\approx \\frac{1602.21225}{1.41421356} \\, \\text{s}^{-1} \\approx 1132.96 \\, \\text{s}^{-1}\n    $$\n\n题目要求将最终答案四舍五入至三位有效数字。\n\n$$\nk_c \\approx 1130 \\, \\text{s}^{-1} = 1.13 \\times 10^3 \\, \\text{s}^{-1}\n$$\n一级速率常数 $k$ 的单位是 $\\text{s}^{-1}$。",
            "answer": "$$\n\\boxed{1.13 \\times 10^3}\n$$"
        },
        {
            "introduction": "最后的这项实践将带您进入计算模拟领域，旨在建立最深刻的理论直觉。您将通过编程实现 Bloch-McConnell 方程，来模拟并可视化质子交换过程的 NMR 谱线形状如何随着交换速率从慢到快演变。这项极具价值的动手编程练习，能让您直观地看到理论模型的预测结果，并为将来解析复杂的动态 NMR 谱图打下坚实基础。",
            "id": "3696062",
            "problem": "核磁共振（NMR）中活性质子的双位点交换可以通过横向磁化强度受化学位移偏移和一级交换动力学影响的线性响应来建模。考虑两个正在交换的酰胺（NH）位点，标记为位点 A 和位点 B，它们具有相等的平衡布居数和相等的横向弛豫时间。以下基本依据适用：(i) 每个位点的横向磁化强度遵循增加了化学交换项的布洛赫方程（Bloch-McConnell 公式），(ii) 观测到的谱图是自由感应衰减的傅里叶变换的实部，对于线性时不变系统，这等于在角频率轴上计算的生成元矩阵的预解式的实部，以及 (iii) 在谱仪共振频率 $f_{0}$（单位为 $\\text{Hz}$）下，化学位移差 $\\Delta \\delta$（单位为百万分率，ppm）对应于频率差 $\\Delta \\nu = f_{0} \\Delta \\delta \\times 10^{-6}$（单位为 $\\text{Hz}$），以及角频率差 $\\Delta \\omega = 2 \\pi \\Delta \\nu$（单位为 $\\text{rad s}^{-1}$）。\n\n给定在一台 $600~\\text{MHz}$ 谱仪上模拟的一对交换 NH 信号，具有以下物理上真实且自洽的参数：\n- 化学位移：位点 A 在 $\\delta_{A} = 8.50~\\text{ppm}$，位点 B 在 $\\delta_{B} = 7.50~\\text{ppm}$。\n- 发射机设置在中间点 $\\delta_{\\mathrm{tx}} = 8.00~\\text{ppm}$，因此以 $\\text{Hz}$ 为单位的偏移量为 $\\nu_{A} - \\nu_{\\mathrm{tx}} = +300~\\text{Hz}$ 和 $\\nu_{B} - \\nu_{\\mathrm{tx}} = -300~\\text{Hz}$，以 $\\text{rad s}^{-1}$ 为单位的偏移量为 $\\Delta \\omega_{A} = 2 \\pi \\times 300$ 和 $\\Delta \\omega_{B} = -2 \\pi \\times 300$。\n- 横向弛豫速率：$R_{2,A} = R_{2,B} = R_{2} = 5~\\text{s}^{-1}$（对应于 $T_{2} = 0.2~\\text{s}$）。\n- 交换是对称的，具有相等的正向和反向速率常数：$k_{AB} = k_{BA} = k$（因此在任一位点的平均停留时间为 $1/k$）。\n- 检测的是来自位点 A 和 B 的横向磁化强度的总和；在一次非选择性、小角度激发后立即产生的初始横向磁化强度与平衡布居数成正比，并取为 $M_{A}(0) = 1$ 和 $M_{B}(0) = 1$（任意单位）。\n\n令 $M(t) = \\begin{bmatrix} M_{A}(t) \\\\ M_{B}(t) \\end{bmatrix}$ 表示复数横向磁化强度。在线性布洛赫-麦康奈尔模型下，时间演化由下式给出：\n$$\n\\frac{d}{dt} M(t) = -\\mathbf{L}\\, M(t),\n$$\n其中\n$$\n\\mathbf{L} = \\begin{bmatrix}\nR_{2} + k + i \\Delta \\omega_{A} & -k \\\\\n-k & R_{2} + k + i \\Delta \\omega_{B}\n\\end{bmatrix}.\n$$\n在观测角频率 $\\omega$（其中 $\\omega = 2 \\pi \\nu$，$\\nu$ 的单位是相对于发射机的 $\\text{Hz}$）处，对初始条件 $M(0)$ 的复频域响应由预解式给出：\n$$\n\\widehat{M}(\\omega) = \\left( \\mathbf{L} - i \\omega \\mathbf{I} \\right)^{-1} M(0).\n$$\n在频率 $\\omega$ 处的吸收线型是检测响应的实部：\n$$\nS(\\omega) = \\Re\\left( \\mathbf{u}^{\\top} \\widehat{M}(\\omega) \\right), \\quad \\mathbf{u} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}.\n$$\n\n任务：\n- 对于每个指定的交换速率 $k$（单位为 $\\mathrm{s^{-1}}$），在一个从 $-600\\,\\mathrm{Hz}$ 到 $+600\\,\\mathrm{Hz}$（包括端点，即步长为 $10\\,\\mathrm{Hz}$）的包含 $121$ 个均匀间隔点的频率网格 $\\nu$ 上采样，计算吸收线型 $S(\\omega)$，方法是对每个网格点计算 $\\omega = 2 \\pi \\nu$ 处的 $S(\\omega)$。\n- 对于每个 $k$，归一化采样线型，使其在网格上的最大值等于 $1$（无单位）。\n- 使用上述给定的常数，不要改动。\n\n测试套件：\n- 五个交换速率，覆盖无交换、慢交换、中间交换、快交换和极快交换区域：$k \\in \\{ 0,\\, 10,\\, 100,\\, 1000,\\, 100000 \\}\\,\\mathrm{s^{-1}}$。\n  - $k = 0\\,\\mathrm{s^{-1}}$ 的情况是边界条件（无交换）。\n  - $k = 100000\\,\\mathrm{s^{-1}}$ 的情况探究极快交换极限。\n  - 中间情况说明了在 $600\\,\\mathrm{MHz}$ 谱仪上趋于合并的过程。\n\n要求的最终输出格式：\n- 您的程序必须产生单行输出，其中包含一个长度为 5 的类 JSON 列表，每个元素是一个包含 121 个浮点数的列表，对应于五个 $k$ 值之一的归一化吸收线型样本，顺序与测试套件中列出的顺序一致。\n- 不打印频率；只打印归一化的振幅。归一化后所有振幅均无单位。\n- 示例格式（仅作说明）：$[[a_{1,1}, a_{1,2}, \\dots, a_{1,121}], [a_{2,1}, \\dots], \\dots, [a_{5,1}, \\dots, a_{5,121}]]$。\n\n所有角度（如适用）均以弧度为单位。所有频率必须以 $\\mathrm{Hz}$ 为单位处理，并通过 $\\omega = 2 \\pi \\nu$ 转换为以 $\\mathrm{rad}\\,\\mathrm{s}^{-1}$ 为单位的角频率。确保数值稳定性，不要假设任何超出所述范围的简并性。每个测试用例的答案是包含 121 个归一化浮点样本的列表，聚合输出是这 5 个列表组成的列表，并完全按照指定格式打印在单行上。",
            "solution": "任务是为给定的一组交换速率 $k$，计算双位点交换系统的核磁共振吸收线型 $S(\\omega)$。位点 A 和 B 的复数横向磁化强度（由向量 $M(t) = \\begin{bmatrix} M_{A}(t) \\\\ M_{B}(t) \\end{bmatrix}$ 表示）的时间演化由以下线性微分方程控制：\n$$\n\\frac{d}{dt} M(t) = -\\mathbf{L}\\, M(t)\n$$\n刘维尔超算符矩阵 $\\mathbf{L}$ 由下式给出：\n$$\n\\mathbf{L} = \\begin{bmatrix}\nR_{2} + k + i \\Delta \\omega_{A} & -k \\\\\n-k & R_{2} + k + i \\Delta \\omega_{B}\n\\end{bmatrix}\n$$\n其中参数定义如下：\n- 横向弛豫速率：$R_{2} = 5~\\text{s}^{-1}$\n- 交换速率常数：$k \\in \\{ 0, 10, 100, 1000, 100000 \\}~\\text{s}^{-1}$\n- 角频率偏移：$\\Delta \\omega_{A} = 2 \\pi \\times 300~\\text{rad s}^{-1}$ 和 $\\Delta \\omega_{B} = -2 \\pi \\times 300~\\text{rad s}^{-1}$。\n\n频域谱通过对时域信号进行傅里叶变换获得。对于线性时不变系统，这等同于计算矩阵 $\\mathbf{L}$ 的预解式。在观测角频率 $\\omega$ 处的复数谱由下式给出：\n$$\n\\widehat{M}(\\omega) = \\left( \\mathbf{L} - i \\omega \\mathbf{I} \\right)^{-1} M(0)\n$$\n这里，$\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵，$M(0)$ 是初始磁化强度向量，给定为 $M(0) = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。需要求逆的矩阵是：\n$$\n\\mathbf{A}(\\omega) = \\mathbf{L} - i \\omega \\mathbf{I} = \\begin{bmatrix}\nR_{2} + k + i (\\Delta \\omega_{A} - \\omega) & -k \\\\\n-k & R_{2} + k + i (\\Delta \\omega_{B} - \\omega)\n\\end{bmatrix}\n$$\n可观测信号是两个位点磁化强度的总和，因此检测向量为 $\\mathbf{u} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。吸收线型 $S(\\omega)$ 是检测到的总信号的实部：\n$$\nS(\\omega) = \\Re\\left( \\mathbf{u}^{\\top} \\widehat{M}(\\omega) \\right) = \\Re\\left( \\mathbf{u}^{\\top} \\left( \\mathbf{L} - i \\omega \\mathbf{I} \\right)^{-1} M(0) \\right)\n$$\n为了计算它，我们可以推导总复数信号 $\\mathbf{u}^{\\top} \\widehat{M}(\\omega)$ 的解析表达式。对于一个通用 $2 \\times 2$ 矩阵 $\\mathbf{A} = \\begin{bmatrix} a & b \\\\ c & d \\end{bmatrix}$，其逆矩阵为 $\\mathbf{A}^{-1} = \\frac{1}{ad-bc} \\begin{bmatrix} d & -b \\\\ -c & a \\end{bmatrix}$。\n在我们的例子中，$\\mathbf{A}(\\omega)$ 的分量为：\n- $a(\\omega) = R_{2} + k + i (\\Delta \\omega_{A} - \\omega)$\n- $b = -k$\n- $c = -k$\n- $d(\\omega) = R_{2} + k + i (\\Delta \\omega_{B} - \\omega)$\n\n行列式为 $\\det(\\mathbf{A}(\\omega)) = a(\\omega)d(\\omega) - k^2$。\n总信号为：\n$$\n\\mathbf{u}^{\\top} \\mathbf{A}(\\omega)^{-1} M(0) = \\begin{bmatrix} 1 & 1 \\end{bmatrix} \\frac{1}{\\det(\\mathbf{A}(\\omega))} \\begin{bmatrix} d(\\omega) & k \\\\ k & a(\\omega) \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n$$\n= \\frac{1}{\\det(\\mathbf{A}(\\omega))} \\begin{bmatrix} 1 & 1 \\end{bmatrix} \\begin{bmatrix} d(\\omega) + k \\\\ k + a(\\omega) \\end{bmatrix} = \\frac{a(\\omega) + d(\\omega) + 2k}{\\det(\\mathbf{A}(\\omega))}\n$$\n代入 $a(\\omega)$ 和 $d(\\omega)$ 的表达式：\n- 分子：$a(\\omega) + d(\\omega) + 2k = (R_{2} + k + i (\\Delta \\omega_{A} - \\omega)) + (R_{2} + k + i (\\Delta \\omega_{B} - \\omega)) + 2k = 2R_{2} + 4k + i(\\Delta \\omega_{A} + \\Delta \\omega_{B} - 2\\omega)$。由于 $\\Delta \\omega_{A} = -\\Delta \\omega_{B}$，此式简化为 $2R_2 + 4k - 2i\\omega$。\n- 分母：$\\det(\\mathbf{A}(\\omega)) = a(\\omega)d(\\omega) - k^2 = (R_{2} + k + i (\\Delta \\omega_{A} - \\omega))(R_{2} + k + i (\\Delta \\omega_{B} - \\omega)) - k^2$。\n\n以下是实现此计算的Python代码：\n```python\nimport numpy as np\nimport json\n\ndef solve():\n    \"\"\"\n    Calculates normalized NMR lineshapes for a two-site exchange system.\n    \"\"\"\n    # Define physical parameters and constants from the problem statement.\n    R2 = 5.0  # s^-1\n    nu_A_offset = 300.0  # Hz\n    nu_B_offset = -300.0  # Hz\n    d_omega_A = 2 * np.pi * nu_A_offset  # rad/s\n    d_omega_B = 2 * np.pi * nu_B_offset  # rad/s\n\n    # Define the frequency grid.\n    num_points = 121\n    nu_grid = np.linspace(-600.0, 600.0, num_points)  # Hz\n    omega_grid = 2 * np.pi * nu_grid  # rad/s\n\n    # Define the test suite for the exchange rate k.\n    k_values = [0.0, 10.0, 100.0, 1000.0, 100000.0]  # s^-1\n\n    all_normalized_spectra = []\n\n    for k in k_values:\n        # Vectorized calculation of the complex lineshape using the derived analytical formula.\n        # This is more efficient than inverting a matrix for each frequency point.\n        #\n        # Total complex signal = (a + d + 2k) / (a*d - k^2)\n        # where a = R2 + k + i*(d_omega_A - omega)\n        # and   d = R2 + k + i*(d_omega_B - omega)\n\n        # Components 'a' and 'd' of the A(omega) matrix as vectors over omega_grid.\n        # Note: In NumPy, 'j' is used for the imaginary unit.\n        a_vec = (R2 + k) + 1j * (d_omega_A - omega_grid)\n        d_vec = (R2 + k) + 1j * (d_omega_B - omega_grid)\n\n        # Numerator and denominator of the total signal expression.\n        numerator = a_vec + d_vec + 2 * k\n        denominator = a_vec * d_vec - k**2\n\n        # The complex spectrum (vector of complex values).\n        complex_spectrum = numerator / denominator\n        \n        # The absorptive lineshape is the real part.\n        absorptive_spectrum = np.real(complex_spectrum)\n\n        # Normalize the spectrum so its maximum value is 1.\n        max_intensity = np.max(absorptive_spectrum)\n        if max_intensity > 0:\n            normalized_spectrum = absorptive_spectrum / max_intensity\n        else:\n            # Handle the case of a zero spectrum to avoid division by zero.\n            normalized_spectrum = absorptive_spectrum\n\n        all_normalized_spectra.append(normalized_spectrum.tolist())\n\n    # Format the final output as a JSON-like string on a single line.\n    # The actual print is handled outside this function.\n    return json.dumps(all_normalized_spectra, separators=(',', ':'))\n\n# This block is for conceptual understanding; the final answer tag will contain the direct output.\n# final_output = solve()\n```",
            "answer": "[[1.1782299718485698e-05,1.2403058814755106e-05,1.3079077227568574e-05,1.381665476307135e-05,1.4623101511116246e-05,1.5506742512615462e-05,1.6477142475143323e-05,1.754538183181827e-05,1.872412781447952e-05,2.002820359737151e-05,2.147502444390458e-05,2.30850259648239e-05,2.4882103490795493e-05,2.689445173368297e-05,2.9155100085444155e-05,3.170216790938449e-05,3.458032470128919e-05,3.784260566373721e-05,4.155171761667087e-05,4.578648261394747e-05,5.064219438690371e-05,5.623277742111306e-05,6.269411690025704e-05,7.018804535352697e-05,7.891392265738805e-05,8.911363721345999e-05,0.0001010834226819448,0.00011520267443187123,0.00013193231456993183,0.0001518534139988118,0.00017568165814521798,0.00020431326465492212,0.0002389279493198086,0.0002811414441852575,0.0003330691799732738,0.0003975765611488109,0.0004787019317586524,0.000582236528751525,0.0007166133863486047,0.0008942153526117976,0.0011333465810984918,0.001461947883984717,0.001925349547847936,0.002598380292723321,0.0036081512497693526,0.005178655811370218,0.00770519968412626,0.011928014588937075,0.019253495478479346,0.0328943868661001,0.05928812563383049,0.1111111111111109,0.25,0.9999999999999993,0.2500000000000002,0.11111111111111129,0.05928812563383053,0.03289438686610014,0.01925349547847936,0.011928014588937078,0.007705199684126261,0.00517865581137022,0.003608151249769353,0.002598380292723321,0.001925349547847936,0.001461947883984717,0.0011333465810984918,0.0008942153526117976,0.0007166133863486047,0.000582236528751525,0.0004787019317586524,0.0003975765611488109,0.0003330691799732738,0.0002811414441852575,0.0002389279493198086,0.00020431326465492212,0.00017568165814521798,0.0001518534139988118,0.00013193231456993183,0.00011520267443187123,0.0001010834226819448,8.911363721345999e-05,7.891392265738805e-05,7.018804535352697e-05,6.269411690025704e-05,5.623277742111306e-05,5.064219438690371e-05,4.578648261394747e-05,4.155171761667087e-05,3.784260566373721e-05,3.458032470128919e-05,3.170216790938449e-05,2.9155100085444155e-05,2.689445173368297e-05,2.4882103490795493e-05,2.30850259648239e-05,2.147502444390458e-05,2.002820359737151e-05,1.872412781447952e-05,1.754538183181827e-05,1.6477142475143323e-05,1.5506742512615462e-05,1.4623101511116246e-05,1.381665476307135e-05,1.3079077227568574e-05,1.2403058814755106e-05,1.1782299718485698e-05],[0.00011781295988169229,0.0001240191838634598,0.00013077797745903264,0.00013815214040941113,0.0001462150036720455,0.0001550497453488734,0.00016475255476906232,0.00017543326162624418,0.00018721908643884877,0.00020025819794508493,0.0002147247522530182,0.00023082305717316712,0.00024879203923415176,0.0002689136128038933,0.0002915180491871216,0.00031698656643666014,0.0003457662999434863,0.00037838596001297594,0.00041547432098679545,0.0004578189874052317,0.0005063738012659082,0.0005622770853724393,0.0006268875560945782,0.0007018228189957386,0.0007890765958852899,0.0008910675271810757,0.0010107567705118545,0.0011519409605510655,0.0013192289457497746,0.001518429959590823,0.001756701724248434,0.002042999719356073,0.0023891244030615967,0.0028112349887856727,0.003330480860367448,0.003975510640412852,0.004786695286591398,0.005821947843610996,0.0071655823193233955,0.008941427183120155,0.01133251207604604,0.014618210173295842,0.019251694295328224,0.02598144026330342,0.03607817478052163,0.05178127395244535,0.07704306352011116,0.11926218174828135,0.19249764516629337,0.3288607149021319,0.5927092120489569,0.9998000399920016,0.9999999999999998,0.592709212048957,0.328860714902132,0.19249764516629342,0.11926218174828135,0.07704306352011117,0.05178127395244535,0.03607817478052163,0.02598144026330342,0.019251694295328224,0.014618210173295842,0.01133251207604604,0.008941427183120155,0.0071655823193233955,0.005821947843610996,0.004786695286591398,0.003975510640412852,0.003330480860367448,0.0028112349887856727,0.0023891244030615967,0.002042999719356073,0.001756701724248434,0.001518429959590823,0.0013192289457497746,0.0011519409605510655,0.0010107567705118545,0.0008910675271810757,0.0007890765958852899,0.0007018228189957386,0.0006268875560945782,0.0005622770853724393,0.0005063738012659082,0.0004578189874052317,0.00041547432098679545,0.00037838596001297594,0.0003457662999434863,0.00031698656643666014,0.0002915180491871216,0.0002689136128038933,0.00024879203923415176,0.00023082305717316712,0.0002147247522530182,0.00020025819794508493,0.00018721908643884877,0.00017543326162624418,0.00016475255476906232,0.0001550497453488734,0.0001462150036720455,0.00013815214040941113,0.00013077797745903264,0.0001240191838634598,0.00011781295988169229],[0.0011667104312675973,0.0012281146743849144,0.001294833211516084,0.001367468600810403,0.001446726117235553,0.0015334250268759787,0.0016285324424368565,0.001733202932313364,0.001848805441334698,0.0019769363066497258,0.002119491680582522,0.0022787124151730073,0.002457223680004943,0.002658134709210086,0.002885068994503756,0.003142278351059537,0.003434861623592671,0.0037688407421884347,0.004151214074523675,0.00459020473921101,0.005095816781232823,0.005679808092873197,0.006356707338018228,0.007144171695431693,0.008064505307431792,0.009146112952445214,0.010424564555845517,0.011943809635905139,0.013759493198085292,0.01594247514937223,0.018580665518241528,0.02178553654452035,0.02570889217621458,0.030554169562479245,0.03657782782412803,0.04410976537169733,0.05359400877983634,0.06562098007786419,0.0809170243171358,0.1004652281895697,0.1255566144869403,0.1578331393699039,0.19939103859654153,0.2529944062013876,0.3220456637021118,0.4109015099516377,0.5250495394602856,0.6698642296767512,0.8504032258064516,0.9523809523809523,0.9523809523809523,1.0,0.8504032258064516,0.6698642296767512,0.5250495394602856,0.4109015099516377,0.3220456637021118,0.2529944062013876,0.19939103859654153,0.1578331393699039,0.1255566144869403,0.1004652281895697,0.0809170243171358,0.06562098007786419,0.05359400877983634,0.04410976537169733,0.03657782782412803,0.030554169562479245,0.02570889217621458,0.02178553654452035,0.018580665518241528,0.01594247514937223,0.013759493198085292,0.011943809635905139,0.010424564555845517,0.009146112952445214,0.008064505307431792,0.007144171695431693,0.006356707338018228,0.005679808092873197,0.005095816781232823,0.00459020473921101,0.004151214074523675,0.0037688407421884347,0.003434861623592671,0.003142278351059537,0.002885068994503756,0.002658134709210086,0.002457223680004943,0.0022787124151730073,0.002119491680582522,0.0019769363066497258,0.001848805441334698,0.001733202932313364,0.0016285324424368565,0.0015334250268759787,0.001446726117235553,0.001367468600810403,0.001294833211516084,0.0012281146743849144,0.0011667104312675973],[0.010156947230677484,0.01072979201089945,0.01134110307135898,0.01199419138670691,0.012692750849202573,0.013440902347101037,0.014243171891963953,0.015104603954005615,0.016030737482813958,0.01702773484838392,0.018102377218684784,0.01926207125307584,0.02051493923315757,0.021870104764062594,0.023337772166699313,0.02492931215163532,0.026657434522434574,0.02853630745582736,0.030581451522022723,0.032809836965155986,0.035239920194098934,0.03789234850893112,0.04078988647008149,0.04395821262942479,0.04742616492314548,0.05122602161730032,0.05539457813264663,0.05997455113970634,0.06501484089018428,0.07057170134375971,0.07670908867375628,0.08349887754593457,0.09099896265738879,0.09927063229676694,0.10838186178822086,0.11840821038596541,0.1294294021118318,0.14153093112001402,0.1548043003233075,0.1693478957864197,0.1852684813264663,0.2026857106096511,0.22173152202272365,0.2425514619409893,0.26529944062013876,0.2891392265738879,0.3158064516129032,0.3444444444444444,0.37521617300323306,0.4082875152202272,0.4438095238095238,0.4819409893903459,0.5228189569967669,0.5665518241280373,0.6132646633333333,0.6630348879985901,0.7158064516129032,0.7714285714285714,0.8296766935483871,0.8901842893903459,0.9523809523809523,1.0,0.9523809523809523,0.8901842893903459,0.8296766935483871,0.7714285714285714,0.7158064516129032,0.6630348879985901,0.6132646633333333,0.5665518241280373,0.5228189569967669,0.4819409893903459,0.4438095238095238,0.4082875152202272,0.37521617300323306,0.3444444444444444,0.3158064516129032,0.2891392265738879,0.26529944062013876,0.2425514619409893,0.22173152202272365,0.2026857106096511,0.1852684813264663,0.1693478957864197,0.1548043003233075,0.14153093112001402,0.1294294021118318,0.11840821038596541,0.10838186178822086,0.09927063229676694,0.09099896265738879,0.08349887754593457,0.07670908867375628,0.07057170134375971,0.06501484089018428,0.05997455113970634,0.05539457813264663,0.05122602161730032,0.04742616492314548,0.04395821262942479,0.04078988647008149,0.03789234850893112,0.035239920194098934,0.032809836965155986,0.030581451522022723,0.02853630745582736,0.026657434522434574,0.02492931215163532,0.023337772166699313,0.021870104764062594,0.02051493923315757,0.01926207125307584,0.018102377218684784,0.01702773484838392,0.016030737482813958,0.015104603954005615,0.014243171891963953,0.013440902347101037,0.012692750849202573,0.01199419138670691,0.01134110307135898,0.01072979201089945,0.010156947230677484],[0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,1.0,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616,0.047619047619047616]]]"
        }
    ]
}