{
    "hands_on_practices": [
        {
            "introduction": "本练习是理解含多种卤素化合物同位素图谱的起点。我们将具体计算一个同时含有一个氯原子和一个溴原子的分子中，$M+2$ 峰的相对强度。通过这个实践，你将掌握一个核心原理：特定质量数峰的总强度是所有能产生该质量数的不同同位素组合出现概率的总和 。",
            "id": "3709377",
            "problem": "一个未知的、价态饱和的中性有机分子仅由碳、氢、氮、氧、氯和溴组成，通过电子电离质谱法（EI-MS）进行分析，产生奇电子分子离子 $\\left[\\mathrm{M}\\right]^{+\\bullet}$。$m/z$ 附近的分子离子簇仅表现出由卤素引起的 $+2$ 单位间距，且 $\\left[\\mathrm{M}\\right]^{+\\bullet}$ 的标称单同位素 $m/z$ 为奇数。已知该分子（通过补充结构分析）恰好含有1个氯原子和1个溴原子。假设对于单同位素组成，所有非卤素元素都以 $^{12}\\mathrm{C}$、$^{1}\\mathrm{H}$、$^{14}\\mathrm{N}$ 和 $^{16}\\mathrm{O}$ 的形式存在，并忽略这些元素的重同位素对 $M$、$M+2$ 和 $M+4$ 簇的贡献。\n\n基本同位素事实：自然同位素丰度为：$^{35}\\mathrm{Cl}$ 的分数丰度为 $f_{\\mathrm{Cl}}=0.7576$，$^{37}\\mathrm{Cl}$ 的分数丰度为 $1-f_{\\mathrm{Cl}}=0.2424$；$^{79}\\mathrm{Br}$ 的分数丰度为 $f_{\\mathrm{Br}}=0.5065$，$^{81}\\mathrm{Br}$ 的分数丰度为 $1-f_{\\mathrm{Br}}=0.4935$。您可以假设不同卤素原子上的同位素取代在统计上是独立的，并且卤素取代是局部簇中 $+2$ 和 $+4$ 间距的唯一来源。\n\n从这些基本定义和事实出发，并援引价态饱和有机分子的奇偶质量规则（氮规则），从第一性原理推导归一化概率（等效地，归一化相对强度），即 $\\left[\\mathrm{M}\\right]^{+\\bullet}$ 簇出现在 $M+2$ 位置的概率，且这完全是由这个含1个氯和1个溴的分子中的卤素同位素取代引起的。以小数形式表示您的最终答案，并四舍五入到4位有效数字。最终答案不需要单位。",
            "solution": "经评估，该问题陈述科学上合理、表述清晰、客观且内容自洽。它提出了一个质谱学中的标准情景，可以从第一性原理解决。包括氮规则的应用在内的前提，与已确立的化学原理一致。所提供的同位素丰度在事实上是正确的，并且简化假设被明确陈述，适合用于分离所测试的特定概念。因此，该问题是有效的。\n\n该问题要求计算在质荷比为 $M+2$ 处观察到分子离子峰的归一化概率，其中 $M$ 是分子的标称单同位素质量。该分子恰好含有一个氯原子和一个溴原子。分子离子簇的同位素模式由氯和溴同位素的自然丰度决定。\n\n让我们根据题目提供的信息定义相关同位素的分数丰度：\n$^{35}\\mathrm{Cl}$ 的分数丰度为 $f_{^{35}\\mathrm{Cl}} = 0.7576$。\n$^{37}\\mathrm{Cl}$ 的分数丰度为 $f_{^{37}\\mathrm{Cl}} = 1 - f_{^{35}\\mathrm{Cl}} = 1 - 0.7576 = 0.2424$。\n$^{79}\\mathrm{Br}$ 的分数丰度为 $f_{^{79}\\mathrm{Br}} = 0.5065$。\n$^{81}\\mathrm{Br}$ 的分数丰度为 $f_{^{81}\\mathrm{Br}} = 1 - f_{^{79}\\mathrm{Br}} = 1 - 0.5065 = 0.4935$。\n\n问题陈述指出，除氯和溴以外的元素（例如，来自 $^{13}\\mathrm{C}$）对同位素簇的贡献可以忽略。这将分析简化为仅考虑卤素同位素的组合。\n\n单同位素峰，记为 $M$，对应于含有每种元素最轻、最常见同位素的分子离子。对于卤素，这些是 $^{35}\\mathrm{Cl}$ 和 $^{79}\\mathrm{Br}$。在统计独立性的假设下，这种特定同位素组合的概率 $P(M)$ 是各个同位素丰度的乘积：\n$$P(M) = P(^{35}\\mathrm{Cl}, ^{79}\\mathrm{Br}) = f_{^{35}\\mathrm{Cl}} \\times f_{^{79}\\mathrm{Br}}$$\n\nM+2 峰对应于比单同位素物种重2个原子质量单位的分子离子。对于含有一个氯原子和一个溴原子的分子，这可以通过两种互斥的方式发生：\n1.  分子含有 $^{37}\\mathrm{Cl}$（质量增加 $37-35=2$）和 $^{79}\\mathrm{Br}$（与参考相比无变化）。\n2.  分子含有 $^{35}\\mathrm{Cl}$（与参考相比无变化）和 $^{81}\\mathrm{Br}$（质量增加 $81-79=2$）。\n\n观察到 M+2 峰的总概率 $P(M+2)$ 是这两个事件概率的总和：\n$$P(M+2) = P(^{37}\\mathrm{Cl}, ^{79}\\mathrm{Br}) + P(^{35}\\mathrm{Cl}, ^{81}\\mathrm{Br})$$\n$$P(M+2) = (f_{^{37}\\mathrm{Cl}} \\times f_{^{79}\\mathrm{Br}}) + (f_{^{35}\\mathrm{Cl}} \\times f_{^{81}\\mathrm{Br}})$$\n\nM+4 峰对应于质量增加4个原子质量单位。当分子同时含有较重的同位素 $^{37}\\mathrm{Cl}$（质量增加2）和 $^{81}\\mathrm{Br}$（质量增加2）时，就会出现这种情况。这种组合的概率 $P(M+4)$ 为：\n$$P(M+4) = P(^{37}\\mathrm{Cl}, ^{81}\\mathrm{Br}) = f_{^{37}\\mathrm{Cl}} \\times f_{^{81}\\mathrm{Br}}$$\n\n“归一化概率”是特定结果的概率相对于所有可能结果概率总和的比值。在本例中，所有可能结果的集合由 M、M+2 和 M+4 峰组成。让我们计算这些概率的总和 $P_{\\text{total}}$：\n$$P_{\\text{total}} = P(M) + P(M+2) + P(M+4)$$\n$$P_{\\text{total}} = (f_{^{35}\\mathrm{Cl}} f_{^{79}\\mathrm{Br}}) + (f_{^{37}\\mathrm{Cl}} f_{^{79}\\mathrm{Br}} + f_{^{35}\\mathrm{Cl}} f_{^{81}\\mathrm{Br}}) + (f_{^{37}\\mathrm{Cl}} f_{^{81}\\mathrm{Br}})$$\n对各项进行因式分解：\n$$P_{\\text{total}} = f_{^{79}\\mathrm{Br}}(f_{^{35}\\mathrm{Cl}} + f_{^{37}\\mathrm{Cl}}) + f_{^{81}\\mathrm{Br}}(f_{^{35}\\mathrm{Cl}} + f_{^{37}\\mathrm{Cl}})$$\n$$P_{\\text{total}} = (f_{^{35}\\mathrm{Cl}} + f_{^{37}\\mathrm{Cl}})(f_{^{79}\\mathrm{Br}} + f_{^{81}\\mathrm{Br}})$$\n由于 $f_{^{35}\\mathrm{Cl}} + f_{^{37}\\mathrm{Cl}} = 1$ 且 $f_{^{79}\\mathrm{Br}} + f_{^{81}\\mathrm{Br}} = 1$，总概率为：\n$$P_{\\text{total}} = 1 \\times 1 = 1$$\n这证实了在问题的假设下，所考虑的同位素组合涵盖了所有可能性。因此，计算出的值 $P(M+2)$ 已经是归一化概率。该值也等同于分子离子簇内 M+2 峰的归一化相对强度。\n\n现在，我们将数值代入 $P(M+2)$ 的表达式中：\n$$P(M+2) = (f_{^{37}\\mathrm{Cl}} \\times f_{^{79}\\mathrm{Br}}) + (f_{^{35}\\mathrm{Cl}} \\times f_{^{81}\\mathrm{Br}})$$\n$$P(M+2) = (0.2424 \\times 0.5065) + (0.7576 \\times 0.4935)$$\n分别计算这两项：\n$$0.2424 \\times 0.5065 = 0.1227936$$\n$$0.7576 \\times 0.4935 = 0.3739176$$\n将这些值相加，得到 M+2 峰的总概率：\n$$P(M+2) = 0.1227936 + 0.3739176 = 0.4967112$$\n\n问题要求将答案四舍五入到4位有效数字。\n$$P(M+2) \\approx 0.4967$$\n\n这就是由于卤素同位素取代，分子离子簇出现在 M+2 位置的归一化概率。",
            "answer": "$$\\boxed{0.4967}$$"
        },
        {
            "introduction": "在掌握了基础计算之后，本练习将展示同位素图谱在解析未知结构中的强大分析能力。我们将逆向思考：不再是从已知结构计算图谱，而是利用一个实验测得的 $M+4/M$ 强度比，来推断未知分子中可能含有的卤原子总数的上限。这个练习突显了同位素数据如何为鉴定未知化合物提供关键的结构限制信息 。",
            "id": "3709363",
            "problem": "一台高分辨质谱仪（MS）分析了一个未知的有机自由基阳离子，该离子表现出一个可分辨的卤素同位素簇，其中，$M\\!+\\!4$ 峰强度与单一同位素 $M$ 峰强度的比值测得为 $R = 0.420$。仪器去卷积已经定量地去除了非卤素同位素（例如，重氧和硫的组合）对 $M\\!+\\!4$ 的贡献，因此这里的 $M\\!+\\!4$ 仅反映了卤素重同位素的取代。该离子的卤素含量仅由氯和溴组成。假设：\n- 每个卤素原子的同位素选择是相互独立的。\n- 氯的自然丰度为：$^{35}\\mathrm{Cl}$ 的概率为 $q_{\\mathrm{Cl}} = 0.7578$，$^{37}\\mathrm{Cl}$ 的概率为 $p_{\\mathrm{Cl}} = 0.2422$。\n- 溴的自然丰度为：$^{79}\\mathrm{Br}$ 的概率为 $q_{\\mathrm{Br}} = 0.5069$，$^{81}\\mathrm{Br}$ 的概率为 $p_{\\mathrm{Br}} = 0.4931$。\n\n一个重卤素同位素取代会使其质量相对于其轻同位素增加 $+2$。因此，$M$ 峰对应于零个重卤素，而 $M\\!+\\!4$ 峰对应于存在的卤素原子中恰好有两个重卤素。\n\n设 $N$ 表示离子中卤素原子的总数，其在氯和溴之间的组成未知。仅使用同位素选择的独立性和所列出的自然丰度作为基本依据，从第一性原理推导，对于固定的总卤素数 $N$，在所有氯/溴组成下，可能的最小 $M\\!+\\!4/M$ 比值 $R_{\\min}(N)$ 的表达式。然后，确定由该测量值所隐含的 $N$ 的最紧上界，该上界定义为满足 $R_{\\min}(N) \\le R$ 的最大整数 $N$。请以单个无单位的整数形式提供最终答案。",
            "solution": "本题要求推导含有 $N$ 个卤素原子（氯和溴）的分子可能产生的最小 $M\\!+\\!4/M$ 强度比，然后利用此结果，根据给定的实验比值，求出 $N$ 的最紧上界。\n\n首先，我们将问题陈述形式化。设 $n_{\\mathrm{Cl}}$ 为氯原子数，$n_{\\mathrm{Br}}$ 为溴原子数，使得卤素原子总数为 $N = n_{\\mathrm{Cl}} + n_{\\mathrm{Br}}$。同位素丰度以概率形式给出：\n- 对于氯：$q_{\\mathrm{Cl}} = P(^{35}\\mathrm{Cl}) = 0.7578$（轻同位素），$p_{\\mathrm{Cl}} = P(^{37}\\mathrm{Cl}) = 0.2422$（重同位素）。\n- 对于溴：$q_{\\mathrm{Br}} = P(^{79}\\mathrm{Br}) = 0.5069$（轻同位素），$p_{\\mathrm{Br}} = P(^{81}\\mathrm{Br}) = 0.4931$（重同位素）。\n\n质谱峰的强度与产生该质量的所有同位素组合的总概率成正比。单一同位素峰 $M$ 对应于只含有所有原子最轻同位素的分子。对于卤素原子，这意味着所有原子都是 $^{35}\\mathrm{Cl}$ 和 $^{79}\\mathrm{Br}$。假设同位素选择是独立事件，则对应于 $M$ 峰的概率为：\n$$ P(M) = q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}} q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}} $$\n\n$M\\!+\\!4$ 峰对应于存在恰好两个重卤素同位素。一个重卤素同位素（$^{37}\\mathrm{Cl}$ 或 $^{81}\\mathrm{Br}$）的质量相对于其轻同位素增加了 $+2$。因此，一个 $M\\!+\\!4$ 的质量位移需要两次这样的取代。有三种互斥的方式可以实现这一点：\n1.  两个重氯原子（$^{37}\\mathrm{Cl}$）且没有重溴原子。从 $n_{\\mathrm{Cl}}$ 个氯原子中选择 2 个的方式有 $\\binom{n_{\\mathrm{Cl}}}{2}$ 种。其概率为 $\\binom{n_{\\mathrm{Cl}}}{2} p_{\\mathrm{Cl}}^2 q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}-2} \\cdot q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}}$。\n2.  一个重氯原子和一个重溴原子。其方式有 $\\binom{n_{\\mathrm{Cl}}}{1} \\binom{n_{\\mathrm{Br}}}{1} = n_{\\mathrm{Cl}} n_{\\mathrm{Br}}$ 种。其概率为 $n_{\\mathrm{Cl}} p_{\\mathrm{Cl}} q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}-1} \\cdot n_{\\mathrm{Br}} p_{\\mathrm{Br}} q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}-1}$。\n3.  两个重溴原子（$^{81}\\mathrm{Br}$）且没有重氯原子。其方式有 $\\binom{n_{\\mathrm{Br}}}{2}$ 种。其概率为 $q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}} \\cdot \\binom{n_{\\mathrm{Br}}}{2} p_{\\mathrm{Br}}^2 q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}-2}$。\n\n$M\\!+\\!4$ 峰的总概率是这些概率之和：\n$$ P(M\\!+\\!4) = \\binom{n_{\\mathrm{Cl}}}{2} p_{\\mathrm{Cl}}^2 q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}-2} q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}} + n_{\\mathrm{Cl}} n_{\\mathrm{Br}} p_{\\mathrm{Cl}} p_{\\mathrm{Br}} q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}-1} q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}-1} + \\binom{n_{\\mathrm{Br}}}{2} p_{\\mathrm{Br}}^2 q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}-2} q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}} $$\n\n峰强度的比值 $R$ 是它们概率的比值：\n$$ R(n_{\\mathrm{Cl}}, n_{\\mathrm{Br}}) = \\frac{P(M\\!+\\!4)}{P(M)} = \\frac{\\binom{n_{\\mathrm{Cl}}}{2} p_{\\mathrm{Cl}}^2 q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}-2} q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}} + n_{\\mathrm{Cl}} n_{\\mathrm{Br}} p_{\\mathrm{Cl}} p_{\\mathrm{Br}} q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}-1} q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}-1} + \\binom{n_{\\mathrm{Br}}}{2} p_{\\mathrm{Br}}^2 q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}-2} q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}}}{q_{\\mathrm{Cl}}^{n_{\\mathrm{Cl}}} q_{\\mathrm{Br}}^{n_{\\mathrm{Br}}}} $$\n将分子逐项除以分母得到：\n$$ R(n_{\\mathrm{Cl}}, n_{\\mathrm{Br}}) = \\binom{n_{\\mathrm{Cl}}}{2} \\left(\\frac{p_{\\mathrm{Cl}}}{q_{\\mathrm{Cl}}}\\right)^2 + n_{\\mathrm{Cl}} n_{\\mathrm{Br}} \\left(\\frac{p_{\\mathrm{Cl}}}{q_{\\mathrm{Cl}}}\\right) \\left(\\frac{p_{\\mathrm{Br}}}{q_{\\mathrm{Br}}}\\right) + \\binom{n_{\\mathrm{Br}}}{2} \\left(\\frac{p_{\\mathrm{Br}}}{q_{\\mathrm{Br}}}\\right)^2 $$\n我们定义重同位素与轻同位素的比值 $\\rho_i = p_i/q_i$：\n$$ \\rho_{\\mathrm{Cl}} = \\frac{p_{\\mathrm{Cl}}}{q_{\\mathrm{Cl}}} = \\frac{0.2422}{0.7578} \\quad \\text{和} \\quad \\rho_{\\mathrm{Br}} = \\frac{p_{\\mathrm{Br}}}{q_{\\mathrm{Br}}} = \\frac{0.4931}{0.5069} $$\n比值的表达式变为：\n$$ R(n_{\\mathrm{Cl}}, n_{\\mathrm{Br}}) = \\binom{n_{\\mathrm{Cl}}}{2} \\rho_{\\mathrm{Cl}}^2 + n_{\\mathrm{Cl}} n_{\\mathrm{Br}} \\rho_{\\mathrm{Cl}} \\rho_{\\mathrm{Br}} + \\binom{n_{\\mathrm{Br}}}{2} \\rho_{\\mathrm{Br}}^2 $$\n该表达式等价于一个包含 $N$ 个变量的集合的第二初等对称多项式 $e_2$，其中 $n_{\\mathrm{Cl}}$ 个变量为 $\\rho_{\\mathrm{Cl}}$，$n_{\\mathrm{Br}}$ 个变量为 $\\rho_{\\mathrm{Br}}$。\n\n下一步是对于固定的卤素总数 $N$，找到使该比值 $R$ 最小化的组成 $(n_{\\mathrm{Cl}}, n_{\\mathrm{Br}})$。我们有 $\\rho_{\\mathrm{Cl}} \\approx 0.3196$ 和 $\\rho_{\\mathrm{Br}} \\approx 0.9728$。由于 $\\rho_{\\mathrm{Cl}}  \\rho_{\\mathrm{Br}}$，直观上，通过最大化具有较小同位素比的氯原子数，可以使该比值最小化。\n为了严格证明这一点，我们考虑当一个溴原子被一个氯原子取代时 $R$ 的变化。这对应于从状态 $(n_{\\mathrm{Cl}}, n_{\\mathrm{Br}})$ 到 $(n_{\\mathrm{Cl}}+1, n_{\\mathrm{Br}}-1)$ 的转变，其中 $n_{\\mathrm{Br}} \\ge 1$。其变化量 $\\Delta R$ 为：\n$$ \\Delta R = R(n_{\\mathrm{Cl}}+1, n_{\\mathrm{Br}}-1) - R(n_{\\mathrm{Cl}}, n_{\\mathrm{Br}}) $$\n我们可以使用 $R$ 的公式计算这个差值。一个更优雅的方法是考虑成对乘积之和 $\\sum_{1 \\le i  j \\le N} \\rho_i \\rho_j$ 的变化。当将原子 $k$ 从 Br 变为 Cl 时，和式中的每一项 $\\rho_k \\rho_j = \\rho_{\\mathrm{Br}}\\rho_j$（对于 $j \\ne k$）都被替换为 $\\rho_{\\mathrm{Cl}}\\rho_j$。其变化为：\n$$ \\Delta R = \\sum_{j \\ne k} (\\rho_{\\mathrm{Cl}}\\rho_j - \\rho_{\\mathrm{Br}}\\rho_j) = (\\rho_{\\mathrm{Cl}} - \\rho_{\\mathrm{Br}}) \\sum_{j \\ne k} \\rho_j $$\n和 $\\sum_{j \\ne k} \\rho_j$ 的原始比值集合包含 $n_{\\mathrm{Cl}}$ 个 $\\rho_{\\mathrm{Cl}}$ 值和 $(n_{\\mathrm{Br}}-1)$ 个 $\\rho_{\\mathrm{Br}}$ 值。\n$$ \\sum_{j \\ne k} \\rho_j = n_{\\mathrm{Cl}}\\rho_{\\mathrm{Cl}} + (n_{\\mathrm{Br}}-1)\\rho_{\\mathrm{Br}} $$\n因此，比值的变化为：\n$$ \\Delta R = (\\rho_{\\mathrm{Cl}} - \\rho_{\\mathrm{Br}}) (n_{\\mathrm{Cl}}\\rho_{\\mathrm{Cl}} + (n_{\\mathrm{Br}}-1)\\rho_{\\mathrm{Br}}) $$\n根据数值，$\\rho_{\\mathrm{Cl}} - \\rho_{\\mathrm{Br}}  0$。第二项 $(n_{\\mathrm{Cl}}\\rho_{\\mathrm{Cl}} + (n_{\\mathrm{Br}}-1)\\rho_{\\mathrm{Br}})$ 是非负项之和。为了使这种变化成为可能，必须有 $n_{\\mathrm{Br}} \\ge 1$。对于 $N \\ge 2$，问题是非平凡的。如果 $n_{\\mathrm{Br}} \\ge 2$，则 $n_{\\mathrm{Br}}-1 \\ge 1$，该项显然为正。如果 $n_{\\mathrm{Br}} = 1$，则 $n_{\\mathrm{Cl}} = N-1 \\ge 1$，该项为 $(N-1)\\rho_{\\mathrm{Cl}} > 0$。在所有相关情况下，第二个因子都为正。\n因此，$\\Delta R  0$。这证明了用一个氯原子取代一个溴原子总会使比值 $R$ 减小。因此，对于固定的卤素总数 $N$，当氯原子数最大化时，比值 $R$ 最小化。这在组成为 $n_{\\mathrm{Cl}} = N$ 和 $n_{\\mathrm{Br}} = 0$ 时发生。\n\n因此，给定 $N$ 的最小比值，记为 $R_{\\min}(N)$，为：\n$$ R_{\\min}(N) = R(N, 0) = \\binom{N}{2} \\rho_{\\mathrm{Cl}}^2 = \\frac{N(N-1)}{2} \\left(\\frac{p_{\\mathrm{Cl}}}{q_{\\mathrm{Cl}}}\\right)^2 $$\n\n题目陈述了测量比值为 $R = 0.420$。我们需要找到满足 $R_{\\min}(N) \\le R$ 的最大整数 $N$。这意味着需要解以下不等式：\n$$ \\frac{N(N-1)}{2} \\left(\\frac{0.2422}{0.7578}\\right)^2 \\le 0.420 $$\n首先，我们计算常数项的值：\n$$ \\rho_{\\mathrm{Cl}}^2 = \\left(\\frac{0.2422}{0.7578}\\right)^2 \\approx (0.319609)^2 \\approx 0.102150 $$\n将此值代入不等式：\n$$ \\frac{N(N-1)}{2} \\times 0.102150 \\le 0.420 $$\n$$ N(N-1) \\le \\frac{2 \\times 0.420}{0.102150} $$\n$$ N(N-1) \\le \\frac{0.840}{0.102150} \\approx 8.2232 $$\n我们必须找到满足此条件的、最大的整数 $N \\ge 2$（因为对于 $N2$，纯氯化合物的 $M\\!+\\!4$ 峰为零）。我们可以测试较小的整数 $N$ 值：\n- 对于 $N=2$：$N(N-1) = 2(1) = 2$。$2 \\le 8.2232$，成立。\n- 对于 $N=3$：$N(N-1) = 3(2) = 6$。$6 \\le 8.2232$，成立。\n- 对于 $N=4$：$N(N-1) = 4(3) = 12$。$12 \\le 8.2232$，不成立。\n\n该不等式对 $N=3$ 成立，但对 $N=4$ 不成立。因此，满足 $R_{\\min}(N) \\le R$ 的最大整数 $N$ 是 $3$。这是与实验观察结果一致的卤素原子总数的最紧上界。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "真实世界的样品通常是混合物，其质谱峰会发生重叠，导致手动解析变得异常困难。这项高级实践将介绍一种计算方法来应对这一挑战：使用非负最小二乘法 (NNLS) 将复杂的光谱解卷积为单个卤代物种的贡献。通过构建基于理论同位素模式的模型，你将学会如何从混合物的复合质谱中定量估算其组分构成 。",
            "id": "3709432",
            "problem": "您的任务是为卤代有机化合物的同位素模式构建一个计算模型，并从高分辨率质谱（HRMS）的重叠峰中估算混合物成分。该场景涉及有机化合物质谱鉴定中氯和溴的同位素模式分析。其关键物理基础是，分子离子附近的实验质谱由一系列离散的峰组成，这些峰位于质荷比（m/z）位置上，彼此相隔 $2$ 个统一原子质量单位，这对应于重同位素 $^{37}\\mathrm{Cl}$ 和 $^{81}\\mathrm{Br}$ 的存在，并且强度在共存的物种之间是可加的。\n\n从以下基本且被广泛接受的事实出发：\n- 氯的天然同位素丰度为：$^{35}\\mathrm{Cl}$ 是 $p^{\\mathrm{Cl}}_{35} = 0.7578$，$^{37}\\mathrm{Cl}$ 是 $p^{\\mathrm{Cl}}_{37} = 0.2422$。\n- 溴的天然同位素丰度为：$^{79}\\mathrm{Br}$ 是 $p^{\\mathrm{Br}}_{79} = 0.5069$，$^{81}\\mathrm{Br}$ 是 $p^{\\mathrm{Br}}_{81} = 0.4931$。\n- 对于含有 $n$ 个氯原子的化合物，在峰位 $M+2k$ 处，重同位素 $^{37}\\mathrm{Cl}$ 的数量为 $k$ 个的分布遵循二项定律，其概率质量为 $\\binom{n}{k} \\left(p^{\\mathrm{Cl}}_{37}\\right)^k \\left(p^{\\mathrm{Cl}}_{35}\\right)^{n-k}$，溴的情况也类似。\n- 对于混合卤素含量，其模式由氯和溴计数的独立二项分布的离散卷积给出，从而产生总和为 $1$ 的峰概率。\n\n考虑以下可对质谱产生贡献的候选物种，每种最多含有 $2$ 个卤原子：\n- 物种 1：一氯代物，含有 1 个氯原子和 0 个溴原子。\n- 物种 2：一溴代物，含有 0 个氯原子和 1 个溴原子。\n- 物种 3：二氯代物，含有 2 个氯原子和 0 个溴原子。\n- 物种 4：二溴代物，含有 0 个氯原子和 2 个溴原子。\n- 物种 5：氯溴代物，含有 1 个氯原子和 1 个溴原子。\n\n假设一个离散谱由一个强度向量 $\\mathbf{y}$ 表示，该向量有 $3$ 个区间，分别对应于 $M$、$M+2$ 和 $M+4$ 处的峰，并且每个候选物种都有一个根据上述同位素定律构建的理论三区间概率向量 $\\mathbf{s}_i$。设未知的非负混合权重为 $\\mathbf{w} = [w_1,w_2,w_3,w_4,w_5]^\\top$，代表五种候选物种的贡献，并假设加性叠加，即观测到的强度向量满足 $\\mathbf{y} \\approx \\sum_{i=1}^{5} w_i \\mathbf{s}_i$。\n\n您的任务是编写一个程序，该程序：\n- 构建一个 $3 \\times 5$ 的设计矩阵 $\\mathbf{A}$，其列是按上述顺序排列的五个物种的理论模式 $\\mathbf{s}_i$。\n- 对于每个提供的测试用例，求解非负最小二乘问题以估计 $\\mathbf{w}$：\n  $$\\min_{\\mathbf{w} \\ge 0} \\left\\| \\mathbf{A}\\mathbf{w} - \\mathbf{y} \\right\\|_2^2,$$\n  然后对解进行归一化以获得混合物分数：\n  $$\\tilde{\\mathbf{w}} = \\frac{\\mathbf{w}}{\\sum_{i=1}^{5} w_i},$$\n  约定如果 $\\sum_{i=1}^{5} w_i = 0$，则 $\\tilde{\\mathbf{w}}$ 为零向量。\n- 返回估计的混合物分数 $\\tilde{\\mathbf{w}}$，四舍五入到 $6$ 位小数。\n\n所有强度值都是无单位的小数，并且必须按此方式处理和报告。此问题不涉及角度；不需要角度单位。同位素模式必须根据所述的天然丰度和同位素取代的独立性推导出来。除了基本的二项式和卷积原理外，不要使用任何快捷公式。\n\n测试套件：\n- 测试用例 1 (理想情况；一氯代物和一溴代物重叠)：\n  $$\\mathbf{y}_1 = [\\,0.65744,\\,0.34256,\\,0\\,].$$\n- 测试用例 2 (边界情况；纯二溴代物)：\n  $$\\mathbf{y}_2 = [\\,0.25694761,\\,0.49990478,\\,0.24314761\\,].$$\n- 测试用例 3 (可辨识性压力测试；二氯代物和氯溴代物的等量混合物)：\n  $$\\mathbf{y}_3 = [\\,0.47919483,\\,0.43176034,\\,0.08904483\\,].$$\n- 测试用例 4 (边缘情况；纯一氯代物)：\n  $$\\mathbf{y}_4 = [\\,0.7578,\\,0.2422,\\,0\\,].$$\n\n答案规范：\n- 您的程序应生成单行输出，其中包含按测试用例顺序排列的结果，形式为方括号括起来的逗号分隔列表。每个结果本身是一个包含 $5$ 个浮点数的列表，代表物种 $[\\,\\text{一氯代物},\\,\\text{一溴代物},\\,\\text{二氯代物},\\,\\text{二溴代物},\\,\\text{氯溴代物}\\,]$ 的估计混合物分数 $\\tilde{\\mathbf{w}}$，四舍五入到 $6$ 位小数。例如，输出可能如下所示：\n  $$[\\, [\\,a_1,a_2,a_3,a_4,a_5\\,], [\\,b_1,b_2,b_3,b_4,b_5\\,], [\\,c_1,c_2,c_3,c_4,c_5\\,], [\\,d_1,d_2,d_3,d_4,d_5\\,] \\,],$$\n  其中 $a_i$、$b_i$、$c_i$ 和 $d_i$ 是小数。",
            "solution": "该问题要求从给定的低维质谱中估算五种卤代有机物种的混合物分数。解决方案涉及基于理论同位素模式构建线性模型，然后求解一个约束优化问题。\n\n其基本科学原理是：含有多个相同卤素原子的分子中同位素的二项分布，以及含有不同卤素的分子中这些分布的卷积。设 $p^{\\mathrm{Cl}}_{37} = 0.2422$ 为重氯同位素 $^{37}\\mathrm{Cl}$ 的天然丰度，$p^{\\mathrm{Br}}_{81} = 0.4931$ 为重溴同位素 $^{81}\\mathrm{Br}$ 的丰度。相应的轻同位素丰度为 $p^{\\mathrm{Cl}}_{35} = 1 - p^{\\mathrm{Cl}}_{37} = 0.7578$ 和 $p^{\\mathrm{Br}}_{79} = 1 - p^{\\mathrm{Br}}_{81} = 0.5069$。\n\n一个含有 $n_{\\mathrm{Cl}}$ 个氯原子和 $n_{\\mathrm{Br}}$ 个溴原子的分子会呈现一簇同位素峰。实验质谱被简化为3个强度区间，分别对应于分子离子（$M$）、$M+2$ 和 $M+4$。这些分别对应于含有 $k=0$、$k=1$ 和 $k=2$ 个重同位素（$^{37}\\mathrm{Cl}$ 或 $^{81}\\mathrm{Br}$）。对于每个物种 $i$，我们必须计算其理论上的3元素概率向量 $\\mathbf{s}_i = [P(k=0), P(k=1), P(k=2)]^\\top$。\n\n在 $n_{\\mathrm{Cl}}$ 个总氯原子中含有 $k_{\\mathrm{Cl}}$ 个重 $^{37}\\mathrm{Cl}$ 同位素的概率遵循二项定律：\n$$P(k_{\\mathrm{Cl}}; n_{\\mathrm{Cl}}) = \\binom{n_{\\mathrm{Cl}}}{k_{\\mathrm{Cl}}} (p^{\\mathrm{Cl}}_{37})^{k_{\\mathrm{Cl}}} (p^{\\mathrm{Cl}}_{35})^{n_{\\mathrm{Cl}}-k_{\\mathrm{Cl}}}$$\n类似的公式适用于溴。对于混合卤素物种，总共含有 $k$ 个重同位素的概率由各个二项分布的离散卷积给出：\n$$P(k; n_{\\mathrm{Cl}}, n_{\\mathrm{Br}}) = \\sum_{j=0}^{k} P(j; n_{\\mathrm{Cl}}) \\cdot P(k-j; n_{\\mathrm{Br}})$$\n\n我们现在为五个候选物种中的每一个计算模式向量 $\\mathbf{s}_i$。\n\n1.  **物种 1: 一氯代物** ($n_{\\mathrm{Cl}}=1, n_{\\mathrm{Br}}=0$)\n    $P(k=0) = \\binom{1}{0}(p^{\\mathrm{Cl}}_{37})^0(p^{\\mathrm{Cl}}_{35})^1 = 0.7578$\n    $P(k=1) = \\binom{1}{1}(p^{\\mathrm{Cl}}_{37})^1(p^{\\mathrm{Cl}}_{35})^0 = 0.2422$\n    $P(k=2) = 0$\n    $\\mathbf{s}_1 = [0.7578, 0.2422, 0]^\\top$\n\n2.  **物种 2: 一溴代物** ($n_{\\mathrm{Cl}}=0, n_{\\mathrm{Br}}=1$)\n    $P(k=0) = \\binom{1}{0}(p^{\\mathrm{Br}}_{81})^0(p^{\\mathrm{Br}}_{79})^1 = 0.5069$\n    $P(k=1) = \\binom{1}{1}(p^{\\mathrm{Br}}_{81})^1(p^{\\mathrm{Br}}_{79})^0 = 0.4931$\n    $P(k=2) = 0$\n    $\\mathbf{s}_2 = [0.5069, 0.4931, 0]^\\top$\n\n3.  **物种 3: 二氯代物** ($n_{\\mathrm{Cl}}=2, n_{\\mathrm{Br}}=0$)\n    $P(k=0) = \\binom{2}{0}(p^{\\mathrm{Cl}}_{37})^0(p^{\\mathrm{Cl}}_{35})^2 = (0.7578)^2 = 0.57426084$\n    $P(k=1) = \\binom{2}{1}(p^{\\mathrm{Cl}}_{37})^1(p^{\\mathrm{Cl}}_{35})^1 = 2(0.2422)(0.7578) = 0.36706752$\n    $P(k=2) = \\binom{2}{2}(p^{\\mathrm{Cl}}_{37})^2(p^{\\mathrm{Cl}}_{35})^0 = (0.2422)^2 = 0.05866084$\n    $\\mathbf{s}_3 = [0.57426084, 0.36706752, 0.05866084]^\\top$\n\n4.  **物种 4: 二溴代物** ($n_{\\mathrm{Cl}}=0, n_{\\mathrm{Br}}=2$)\n    $P(k=0) = \\binom{2}{0}(p^{\\mathrm{Br}}_{81})^0(p^{\\mathrm{Br}}_{79})^2 = (0.5069)^2 = 0.25694761$\n    $P(k=1) = \\binom{2}{1}(p^{\\mathrm{Br}}_{81})^1(p^{\\mathrm{Br}}_{79})^1 = 2(0.4931)(0.5069) = 0.49990478$\n    $P(k=2) = \\binom{2}{2}(p^{\\mathrm{Br}}_{81})^2(p^{\\mathrm{Br}}_{79})^0 = (0.4931)^2 = 0.24314761$\n    $\\mathbf{s}_4 = [0.25694761, 0.49990478, 0.24314761]^\\top$\n\n5.  **物种 5: 氯溴代物** ($n_{\\mathrm{Cl}}=1, n_{\\mathrm{Br}}=1$)\n    我们应用卷积公式：\n    $P(k=0) = P(0; n_{\\mathrm{Cl}}=1)P(0; n_{\\mathrm{Br}}=1) = p^{\\mathrm{Cl}}_{35} \\cdot p^{\\mathrm{Br}}_{79} = 0.7578 \\cdot 0.5069 = 0.38416302$\n    $P(k=1) = P(1; n_{\\mathrm{Cl}}=1)P(0; n_{\\mathrm{Br}}=1) + P(0; n_{\\mathrm{Cl}}=1)P(1; n_{\\mathrm{Br}}=1) = p^{\\mathrm{Cl}}_{37} \\cdot p^{\\mathrm{Br}}_{79} + p^{\\mathrm{Cl}}_{35} \\cdot p^{\\mathrm{Br}}_{81} = 0.2422 \\cdot 0.5069 + 0.7578 \\cdot 0.4931 = 0.49645656$\n    $P(k=2) = P(1; n_{\\mathrm{Cl}}=1)P(1; n_{\\mathrm{Br}}=1) = p^{\\mathrm{Cl}}_{37} \\cdot p^{\\mathrm{Br}}_{81} = 0.2422 \\cdot 0.4931 = 0.11943622$\n    $\\mathbf{s}_5 = [0.38416302, 0.49645656, 0.11943622]^\\top$\n\n这五个向量构成了 $3 \\times 5$ 设计矩阵 $\\mathbf{A} = [\\mathbf{s}_1, \\mathbf{s}_2, \\mathbf{s}_3, \\mathbf{s}_4, \\mathbf{s}_5]$ 的列。观测到的强度向量 $\\mathbf{y}$被建模为这些模式的线性组合：$\\mathbf{y} \\approx \\mathbf{A}\\mathbf{w}$，其中 $\\mathbf{w} = [w_1, w_2, w_3, w_4, w_5]^\\top$ 是非负权重向量。\n\n为了从给定的 $\\mathbf{y}$ 估计 $\\mathbf{w}$，我们求解非负最小二乘（NNLS）问题：\n$$\\min_{\\mathbf{w} \\ge 0} \\left\\| \\mathbf{A}\\mathbf{w} - \\mathbf{y} \\right\\|_2^2$$\n这是一个标准的凸优化问题，其解提供了估计的绝对贡献 $w_i$。\n\n最后，对权重进行归一化以获得相对混合物分数 $\\tilde{\\mathbf{w}}$：\n$$\\tilde{\\mathbf{w}} = \\frac{\\mathbf{w}}{\\sum_{i=1}^{5} w_i}$$\n如果权重之和为零（即 $\\mathbf{w}=\\mathbf{0}$），则归一化向量 $\\tilde{\\mathbf{w}}$ 为零向量。然后将所得向量的分量四舍五入到 $6$ 位小数。对每个提供的测试用例都以计算方式实现这整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Constructs the theoretical isotopic patterns for halogenated compounds,\n    and solves for mixture compositions from test spectra using non-negative\n    least squares.\n    \"\"\"\n\n    # Define the natural isotopic abundances as per the problem statement.\n    p_cl35 = 0.7578\n    p_cl37 = 0.2422\n    p_br79 = 0.5069\n    p_br81 = 0.4931\n\n    # --- Step 1: Build the design matrix A ---\n\n    # Each column s_i of A is the theoretical 3-bin isotopic pattern for a species.\n    # The bins correspond to M, M+2, M+4 (0, 1, or 2 heavy isotopes).\n\n    # s_1: monochloro (1 Cl, 0 Br)\n    s1 = np.array([\n        p_cl35,  # k=0: 35Cl\n        p_cl37,  # k=1: 37Cl\n        0.0      # k=2\n    ])\n\n    # s_2: monobromo (0 Cl, 1 Br)\n    s2 = np.array([\n        p_br79,  # k=0: 79Br\n        p_br81,  # k=1: 81Br\n        0.0      # k=2\n    ])\n\n    # s_3: dichloro (2 Cl, 0 Br)\n    s3 = np.array([\n        p_cl35**2,                    # k=0: 35Cl, 35Cl\n        2 * p_cl35 * p_cl37,          # k=1: 35Cl, 37Cl\n        p_cl37**2                     # k=2: 37Cl, 37Cl\n    ])\n\n    # s_4: dibromo (0 Cl, 2 Br)\n    s4 = np.array([\n        p_br79**2,                    # k=0: 79Br, 79Br\n        2 * p_br79 * p_br81,          # k=1: 79Br, 81Br\n        p_br81**2                     # k=2: 81Br, 81Br\n    ])\n\n    # s_5: chlorobromo (1 Cl, 1 Br) - discrete convolution\n    s5 = np.array([\n        p_cl35 * p_br79,              # k=0: (35Cl, 79Br)\n        p_cl37 * p_br79 + p_cl35 * p_br81,  # k=1: (37Cl, 79Br) or (35Cl, 81Br)\n        p_cl37 * p_br81               # k=2: (37Cl, 81Br)\n    ])\n\n    # The 3x5 design matrix A\n    A = np.stack([s1, s2, s3, s4, s5], axis=1)\n\n    # --- Step 2: Define test cases ---\n    test_cases = [\n        np.array([0.65744, 0.34256, 0]),\n        np.array([0.25694761, 0.49990478, 0.24314761]),\n        np.array([0.47919483, 0.43176034, 0.08904483]),\n        np.array([0.7578, 0.2422, 0])\n    ]\n\n    results = []\n    # --- Step 3: Solve for each test case ---\n    for y in test_cases:\n        # Solve the nonnegative least squares problem: min ||Ax - y||_2^2 for x >= 0\n        w, _ = nnls(A, y)\n\n        # Normalize the weights to get mixture fractions\n        w_sum = np.sum(w)\n        if w_sum > 0:\n            w_tilde = w / w_sum\n        else:\n            w_tilde = np.zeros_like(w)\n\n        # Round to 6 decimal places and store as a list\n        w_rounded = np.round(w_tilde, 6)\n        results.append(list(w_rounded))\n\n    # Final print statement in the exact required format.\n    # str() of a list of lists matches the desired output style.\n    print(str(results).replace(\"],\", \"], \"))\n\nsolve()\n```"
        }
    ]
}