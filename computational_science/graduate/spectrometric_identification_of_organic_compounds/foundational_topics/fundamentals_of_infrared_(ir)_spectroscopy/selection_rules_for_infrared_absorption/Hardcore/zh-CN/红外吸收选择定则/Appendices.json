{
    "hands_on_practices": [
        {
            "introduction": "这第一个实践是一项基础练习。我们将从一个简单的双原子分子——一氧化碳——入手，看看基本的转动选择定则 $\\Delta J = \\pm 1$ 和刚性转子模型如何产生红外光谱中特征性的 P 支和 R 支结构。通过应用这些原理，你将计算出谱线的精确位置，从而将抽象的量子理论与具体的可观测量联系起来。",
            "id": "3723186",
            "problem": "具有永久电偶极矩的异核双原子分子，例如一氧化碳 (CO)，在红外 (IR) 光谱中表现出转振吸收。考虑以下基本事实：(i) 电偶极跃迁矩积分对由球谐函数表征的刚性转子态施加了角动量选择定则，从而得出偶极允许跃迁的转动选择定则为 $\\Delta J=\\pm 1$；(ii) 振动基频带中心由谱带原点波数 $\\tilde{\\nu}_{0}$ 表征，其定义为在没有转动结构的情况下，$v=0$ 和 $v=1$ 之间的能量差（以波数表示）；(iii) 以波数表示的刚性转子转动能级为 $\\tilde{E}_{J}=B\\,J(J+1)$，其中 $B$ 是转动常数，$J$ 是转动量子数，且离心畸变可以忽略；(iv) 对于给定的振动跃迁 $v=0\\to 1$，当振动激发引起的键长变化很小时，高能级和低能级的转动常数可近似相等，即 $B^{\\prime}\\approx B^{\\prime\\prime}=B$。\n\n仅从这些原理出发，推导双原子分子R支和P支中转振谱线位置的表达式，并明确说明选择定则 $\\Delta J=\\pm 1$ 和刚性转子能级间距如何确定相对于谱带原点 $\\tilde{\\nu}_{0}$ 的谱线位置。然后，使用CO的值 $B=1.9313\\,\\text{cm}^{-1}$ 和基频带原点 $\\tilde{\\nu}_{0}=2143\\,\\text{cm}^{-1}$，计算 $R(0)$ 到 $R(3)$ 谱线和 $P(1)$ 到 $P(4)$ 谱线的波数位置（单位为 $\\text{cm}^{-1}$），计算中忽略离心畸变并假设 $B^{\\prime}=B^{\\prime\\prime}=B$。最终数值答案以 $\\text{cm}^{-1}$ 表示。没有舍入要求；报告由给定数据所隐含的精确值。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n-   系统是一个具有永久电偶极矩的异核双原子分子。\n-   光谱过程是红外 (IR) 区域的转振吸收。\n-   $i) 转动选择定则：$\\Delta J = \\pm 1$。\n-   $ii) 振动基频带原点波数：$\\tilde{\\nu}_{0}$，对应于在没有转动的情况下，振动能级 $v=0$ 和 $v=1$ 之间的能量差。\n-   $iii) 以波数表示的刚性转子转动能级：$\\tilde{E}_{J} = B\\,J(J+1)$，其中 $B$ 是转动常数，$J$ 是转动量子数，且离心畸变可忽略。\n-   $iv) 转动常数的近似：$B^{\\prime} \\approx B^{\\prime\\prime} = B$，其中 $B^{\\prime}$ 是高振动态 ($v=1$) 的转动常数，$B^{\\prime\\prime}$ 是低振动态 ($v=0$) 的转动常数。\n-   CO的转动常数值：$B = 1.9313\\,\\text{cm}^{-1}$。\n-   CO的基频带原点值：$\\tilde{\\nu}_{0} = 2143\\,\\text{cm}^{-1}$。\n-   任务是推导R支和P支中谱线位置的表达式。\n-   任务是计算CO的 $R(0)$ 到 $R(3)$ 谱线和 $P(1)$ 到 $P(4)$ 谱线的数值波数位置。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题基于双原子分子转振光谱学中公认的刚性转子-谐振子模型。选择定则、能级表达式以及P支和R支的概念是分子光谱学的基本原理。所有前提在事实上和科学上都是合理的。\n-   **适定性：** 问题定义清晰。它提供了所有必要的方程、常数和约束（例如，忽略离心畸变，$B^{\\prime}=B^{\\prime\\prime}$），以推导所需的表达式并计算特定的谱线位置。存在唯一且有意义的解。\n-   **客观性：** 问题陈述使用精确的技术语言表达，没有主观性或歧义。\n\n### 第3步：结论与行动\n该问题是 **有效的**。它在科学上是合理的、适定的和客观的。可以继续进行求解过程。\n\n### 解题推导\n在给定的近似下，双原子分子的总转振能量（以波数 $\\text{cm}^{-1}$ 表示）是其振动能量和转动能量之和。问题指出，振动基态 ($v=0$) 与第一激发态 ($v=1$) 之间的能量差是谱带原点 $\\tilde{\\nu}_{0}$。给定振动态 $v$ 中的转动能量由 $\\tilde{E}_{J} = B_{v}J(J+1)$ 给出，其中 $B_v$ 是该振动态的转动常数。\n\n转振跃迁从初态 $(v'', J'')$ 发生到末态 $(v', J')$。对于基频吸收带，振动量子数从 $v''=0$ 变为 $v'=1$。吸收光子的波数 $\\tilde{\\nu}$ 由末态和初态之间的能量差给出：\n$$ \\tilde{\\nu} = E_{v', J'} - E_{v'', J''} = (E_{v=1} - E_{v=0}) + (E_{J'} - E_{J''}) $$\n使用问题陈述中的符号：\n$$ \\tilde{\\nu}(J', J'') = \\tilde{\\nu}_{0} + \\tilde{E}_{J'} - \\tilde{E}_{J''} $$\n转动能级为 $\\tilde{E}_{J'} = B'J'(J'+1)$ 和 $\\tilde{E}_{J''} = B''J''(J''+1)$。问题指定了高能态和低能态的转动常数相等的近似，因此 $B' = B'' = B$。跃迁波数的表达式变为：\n$$ \\tilde{\\nu}(J', J'') = \\tilde{\\nu}_{0} + B J'(J'+1) - B J''(J''+1) $$\n\n该问题受转动选择定则 $\\Delta J = J' - J'' = \\pm 1$ 的支配。该选择定则在光谱中产生两个分支。\n\n**1. R支 ($\\Delta J = +1$)**\n对于R支，末态转动量子数比初态大一：$J' = J'' + 1$。按照惯例，谱线由低能态的量子数 $J''$ 表示，因此我们令 $J'' = J$，其中 $J = 0, 1, 2, \\dots$。因此，$J' = J+1$。将这些代入 $\\tilde{\\nu}$ 的通用表达式中：\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)((J+1)+1) - B J(J+1) $$\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)(J+2) - B J(J+1) $$\n提出公因式 $B(J+1)$：\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)[(J+2) - J] $$\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + B(J+1)(2) $$\n推导出的R支谱线位置表达式为：\n$$ \\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + 2B(J+1) \\quad | \\quad J=0, 1, 2, \\dots $$\n这些谱线出现在比谱带原点 $\\tilde{\\nu}_{0}$ 更高的波数处，谱线间距为 $2B$。\n\n**2. P支 ($\\Delta J = -1$)**\n对于P支，末态转动量子数比初态小一：$J' = J'' - 1$。谱线同样由低能态的量子数 $J''$ 表示，因此我们令 $J'' = J$。因此，$J' = J-1$。$J''$ 的最低可能值为1，因为如果 $J''=0$，则 $J'=-1$，这在物理上是不可能的。因此，对于P支，$J = 1, 2, 3, \\dots$。将这些代入 $\\tilde{\\nu}$ 的通用表达式中：\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + B(J-1)((J-1)+1) - B J(J+1) $$\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + B(J-1)J - B J(J+1) $$\n提出公因式 $BJ$：\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + BJ[(J-1) - (J+1)] $$\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} + BJ(-2) $$\n推导出的P支谱线位置表达式为：\n$$ \\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} - 2BJ \\quad | \\quad J=1, 2, 3, \\dots $$\n这些谱线出现在比谱带原点 $\\tilde{\\nu}_{0}$ 更低的波数处，谱线间距同样为 $2B$。\n\n### CO的数值计算\n给定值为 $\\tilde{\\nu}_{0} = 2143\\,\\text{cm}^{-1}$ 和 $B = 1.9313\\,\\text{cm}^{-1}$。\n\n**R支谱线（$R(0)$ 到 $R(3)$）：**\n使用公式 $\\tilde{\\nu}_{R(J)} = \\tilde{\\nu}_{0} + 2B(J+1)$：\n-   对于 $R(0)$，$J=0$：\n    $\\tilde{\\nu}_{R(0)} = 2143 + 2(1.9313)(0+1) = 2143 + 2(1.9313) = 2143 + 3.8626 = 2146.8626\\,\\text{cm}^{-1}$。\n-   对于 $R(1)$，$J=1$：\n    $\\tilde{\\nu}_{R(1)} = 2143 + 2(1.9313)(1+1) = 2143 + 4(1.9313) = 2143 + 7.7252 = 2150.7252\\,\\text{cm}^{-1}$。\n-   对于 $R(2)$，$J=2$：\n    $\\tilde{\\nu}_{R(2)} = 2143 + 2(1.9313)(2+1) = 2143 + 6(1.9313) = 2143 + 11.5878 = 2154.5878\\,\\text{cm}^{-1}$。\n-   对于 $R(3)$，$J=3$：\n    $\\tilde{\\nu}_{R(3)} = 2143 + 2(1.9313)(3+1) = 2143 + 8(1.9313) = 2143 + 15.4504 = 2158.4504\\,\\text{cm}^{-1}$。\n\n**P支谱线（$P(1)$ 到 $P(4)$）：**\n使用公式 $\\tilde{\\nu}_{P(J)} = \\tilde{\\nu}_{0} - 2BJ$：\n-   对于 $P(1)$，$J=1$：\n    $\\tilde{\\nu}_{P(1)} = 2143 - 2(1.9313)(1) = 2143 - 3.8626 = 2139.1374\\,\\text{cm}^{-1}$。\n-   对于 $P(2)$，$J=2$：\n    $\\tilde{\\nu}_{P(2)} = 2143 - 2(1.9313)(2) = 2143 - 4(1.9313) = 2143 - 7.7252 = 2135.2748\\,\\text{cm}^{-1}$。\n-   对于 $P(3)$，$J=3$：\n    $\\tilde{\\nu}_{P(3)} = 2143 - 2(1.9313)(3) = 2143 - 6(1.9313) = 2143 - 11.5878 = 2131.4122\\,\\text{cm}^{-1}$。\n-   对于 $P(4)$，$J=4$：\n    $\\tilde{\\nu}_{P(4)} = 2143 - 2(1.9313)(4) = 2143 - 8(1.9313) = 2143 - 15.4504 = 2127.5496\\,\\text{cm}^{-1}$。\n\n汇总所请求谱线位置的最终计算值。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 2146.8626  2150.7252  2154.5878  2158.4504  2139.1374  2135.2748  2131.4122  2127.5496 \\end{pmatrix}} $$"
        },
        {
            "introduction": "我们的第一个练习关注的是谱线的*位置*，而这个实践则深入探讨了它们的*强度*。红外吸收的核心选择定则取决于振动过程中偶极矩的变化，这个变化由偶极矩导数 $(\\partial \\mu / \\partial Q)_0$ 来描述。本练习  提供了一个假设情景，旨在阐明该导数的大小如何直接与观测到的基频跃迁积分强度相关联，让你能够量化一个红外活性模式的“强度”。",
            "id": "3723223",
            "problem": "在有机分子的红外(IR)光谱学中，于Born–Oppenheimer和简谐近似下，考虑$2$个局域C–H伸缩振动简正模式，标记为$\\mathrm{A}$和$\\mathrm{B}$，其简正坐标分别为$Q_{\\mathrm{A}}$和$Q_{\\mathrm{B}}$。对于$v=0 \\to 1$的跃迁，两个基频振动都被观测到，并且都是红外允许的。假设分子的取代基模式改变了偶极矩响应，使得平衡位置的偶极矩导数满足\n$$\\left(\\frac{\\partial \\mu}{\\partial Q_{\\mathrm{A}}}\\right)_{0} = 2 \\left(\\frac{\\partial \\mu}{\\partial Q_{\\mathrm{B}}}\\right)_{0}.$$\n假设决定这两种模式强度的力学因素是相同的，包括简谐频率$\\omega_{\\mathrm{A}}=\\omega_{\\mathrm{B}}$、有效质量以及测量条件下的热布居数，并忽略非谐效应和Fermi共振效应。根据红外吸收的选择定则以及跃迁偶极矩与基频振动的积分谱带强度之间的关系，计算这两个基频振动的积分强度之比$I_{\\mathrm{A}}/I_{\\mathrm{B}}$。最终答案以无单位的纯数表示。",
            "solution": "用户希望根据给定的偶极矩导数关系，计算两个红外活性基频跃迁的积分强度之比。\n\n### 步骤1：提取已知条件\n- 系统：一个用红外(IR)光谱学研究的有机分子。\n- 近似：Born–Oppenheimer近似和简谐近似。忽略非谐效应和Fermi共振效应。\n- 振动模式：两个局域C–H伸缩振动简正模式，A和B，简正坐标为$Q_{\\mathrm{A}}$和$Q_{\\mathrm{B}}$。\n- 跃迁：两个基频振动($v=0 \\to 1$)都是红外允许的。\n- 偶极矩条件：$\\left(\\frac{\\partial \\mu}{\\partial Q_{\\mathrm{A}}}\\right)_{0} = 2 \\left(\\frac{\\partial \\mu}{\\partial Q_{\\mathrm{B}}}\\right)_{0}$，其中下标$0$表示在平衡几何构型下取值。\n- 假设的相同因素：两种模式的力学因素相同，包括简谐频率($\\omega_{\\mathrm{A}}=\\omega_{\\mathrm{B}}$)、有效质量和热布居数。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础**：该问题牢固地植根于红外光谱的量子力学理论。红外强度、跃迁偶极矩以及分子偶极矩对简正坐标的导数之间的关系是该领域的核心概念。使用Born–Oppenheimer近似和简谐近似是振动光谱学入门和中级处理的标准方法。\n- **适定性**：该问题是适定的。它提供了足够的信息来确定所要求的比率$I_{\\mathrm{A}}/I_{\\mathrm{B}}$。这些假设将问题简化为其基本要素，从而得出一个唯一且有意义的解。\n- **客观性**：该问题使用物理化学和光谱学中精确、客观的术语来陈述。诸如“简正模式”、“简谐近似”和“偶极矩导数”之类的术语具有清晰、明确的定义。\n- **结论**：该问题在科学上是有效的、自洽的且适定的。没有发现任何缺陷。\n\n### 步骤3：进行求解\n\n对于一个简正模式$k$的基频跃迁($v=0 \\to v=1$)，其振动吸收谱带的积分强度$I_k$与跃迁偶极矩$\\vec{R}_{10}^{(k)}$大小的平方成正比：\n$$I_k \\propto \\left| \\vec{R}_{10}^{(k)} \\right|^2$$\n跃迁偶极矩是一个量子力学量，由积分定义：\n$$\\vec{R}_{10}^{(k)} = \\int \\psi_{1}^{(k)*} \\vec{\\mu} \\, \\psi_{0}^{(k)} \\, d\\tau = \\langle \\psi_{1}^{(k)} | \\vec{\\mu} | \\psi_{0}^{(k)} \\rangle$$\n其中$\\psi_{0}^{(k)}$和$\\psi_{1}^{(k)}$分别是简正模式$k$的基态($v=0$)和第一激发态($v=1$)的振动波函数。$\\vec{\\mu}$是分子的电偶极矩算符。积分遍及所有空间坐标。\n\n在Born–Oppenheimer近似下，偶极矩$\\vec{\\mu}$是核坐标的函数，可以表示为简正坐标$Q_k$的函数。我们可以在平衡位置（对所有$k$，$Q_k=0$）附近将$\\vec{\\mu}$展开为泰勒级数：\n$$\\vec{\\mu} = \\vec{\\mu}_0 + \\sum_k \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}\\right)_0 Q_k + \\frac{1}{2} \\sum_{k,j} \\left(\\frac{\\partial^2 \\vec{\\mu}}{\\partial Q_k \\partial Q_j}\\right)_0 Q_k Q_j + \\dots$$\n此处，$\\vec{\\mu}_0$是平衡位置的永久偶极矩。问题要求忽略非谐效应，这允许我们通过在单个模式对跃迁的贡献中，将级数截断到线性项，来使用“电学谐和性”近似：\n$$\\vec{\\mu} \\approx \\vec{\\mu}_0 + \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}\\right)_0 Q_k$$\n将此线性近似代入模式$k$的跃迁偶极矩积分中：\n$$\\vec{R}_{10}^{(k)} = \\left\\langle \\psi_{1}^{(k)} \\left| \\vec{\\mu}_0 + \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}\\right)_0 Q_k \\right| \\psi_{0}^{(k)} \\right\\rangle$$\n我们可以将其分为两项：\n$$\\vec{R}_{10}^{(k)} = \\vec{\\mu}_0 \\langle \\psi_{1}^{(k)} | \\psi_{0}^{(k)} \\rangle + \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}\\right)_0 \\langle \\psi_{1}^{(k)} | Q_k | \\psi_{0}^{(k)} \\rangle$$\n在简谐振子近似中，振动本征函数是正交的。因此，第一项为零：\n$$\\langle \\psi_{1}^{(k)} | \\psi_{0}^{(k)} \\rangle = 0$$\n这就留下了第二项。积分$\\langle \\psi_{1}^{(k)} | Q_k | \\psi_{0}^{(k)} \\rangle$不为零，这与简谐振子的选择定则$\\Delta v = \\pm 1$一致。红外光谱的总选择定则要求分子的偶极矩在振动过程中必须改变，这意味着导数$\\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}\\right)_0$必须不为零。问题说明这些模式是红外允许的，与此要求一致。\n\n模式$k$的基频跃迁的跃迁偶极矩简化为：\n$$\\vec{R}_{10}^{(k)} = \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}\\right)_0 \\langle \\psi_{1}^{(k)} | Q_k | \\psi_{0}^{(k)} \\rangle$$\n积分强度则与其大小的平方成正比：\n$$I_k \\propto \\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}\\right)_0 \\right|^2 \\left| \\langle \\psi_{1}^{(k)} | Q_k | \\psi_{0}^{(k)} \\rangle \\right|^2$$\n积分项的值为$\\left| \\langle \\psi_{1}^{(k)} | Q_k | \\psi_{0}^{(k)} \\rangle \\right|^2 = \\frac{\\hbar}{2 \\omega_k m_{\\text{eff}}^{(k)}}$，其中$\\hbar$是约化普朗克常数，$\\omega_k$和$m_{\\text{eff}}^{(k)}$分别是简正模式的角频率和有效质量。\n\n我们需要求积分强度之比$I_{\\mathrm{A}}/I_{\\mathrm{B}}$。设比例常数为$C$，它包含初始态布居数和基本常数等因素。问题指出模式A和B的热布居数相同。\n$$\\frac{I_{\\mathrm{A}}}{I_{\\mathrm{B}}} = \\frac{C \\cdot \\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{A}}}\\right)_0 \\right|^2 \\left| \\langle \\psi_{1}^{(\\mathrm{A})} | Q_{\\mathrm{A}} | \\psi_{0}^{(\\mathrm{A})} \\rangle \\right|^2}{C \\cdot \\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right|^2 \\left| \\langle \\psi_{1}^{(\\mathrm{B})} | Q_{\\mathrm{B}} | \\psi_{0}^{(\\mathrm{B})} \\rangle \\right|^2}$$\n问题指出，决定强度的所有力学因素都是相同的，包括简谐频率($\\omega_{\\mathrm{A}} = \\omega_{\\mathrm{B}}$)和有效质量。这直接意味着积分项相等：\n$$\\left| \\langle \\psi_{1}^{(\\mathrm{A})} | Q_{\\mathrm{A}} | \\psi_{0}^{(\\mathrm{A})} \\rangle \\right|^2 = \\left| \\langle \\psi_{1}^{(\\mathrm{B})} | Q_{\\mathrm{B}} | \\psi_{0}^{(\\mathrm{B})} \\rangle \\right|^2$$\n因此，这些项在比值中被消去，常数$C$也是如此。强度之比简化为偶极矩导数大小平方之比：\n$$\\frac{I_{\\mathrm{A}}}{I_{\\mathrm{B}}} = \\frac{\\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{A}}}\\right)_0 \\right|^2}{\\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right|^2}$$\n问题给出了关系$\\left(\\frac{\\partial \\mu}{\\partial Q_{\\mathrm{A}}}\\right)_{0} = 2 \\left(\\frac{\\partial \\mu}{\\partial Q_{\\mathrm{B}}}\\right)_{0}$。尽管用标量符号$\\mu$书写，但在强度的背景下，这必须指向量$\\vec{\\mu}$之间的关系，可以是它们的大小关系，也可以是共线向量且其大小具有此比率。在任何一种标准解释中，这对大小都意味着：\n$$\\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{A}}}\\right)_0 \\right| = 2 \\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right|$$\n将此代入强度比的表达式中：\n$$\\frac{I_{\\mathrm{A}}}{I_{\\mathrm{B}}} = \\frac{\\left( 2 \\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right| \\right)^2}{\\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right|^2} = \\frac{4 \\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right|^2}{\\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right|^2}$$\n非零项$\\left| \\left(\\frac{\\partial \\vec{\\mu}}{\\partial Q_{\\mathrm{B}}}\\right)_0 \\right|^2$相互抵消，得到最终的数值比：\n$$\\frac{I_{\\mathrm{A}}}{I_{\\mathrm{B}}} = 4$$",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "对于比双原子分子更复杂的分子，手动推导所有性质变得不切实际。这最后一个实践将我们带入计算化学的领域，展示我们所学的原理如何被推广和自动化。通过使用一个关于甲醛的假设数据集，你将实现一个算法，通过对力常数矩阵进行对角化来找到简正模式，然后利用偶极矩导数矩阵来预测哪些模式是红外活性的以及它们的相对强度是多少，这正反映了现代光谱学软件的工作流程。",
            "id": "3723197",
            "problem": "给定甲醛（化学式为H$_2$CO，非线性分子，含有$N=4$个原子）的约化振动空间数据，包括一个表示投影到振动子空间的质量加权Hessian矩阵的$6 \\times 6$实对称正定矩阵，以及一个表示分子偶极矩矢量对相同的$6$个正交振动笛卡尔坐标的一阶导数的$3 \\times 6$实数矩阵（在进行简正模式对角化之前）。红外吸收的选择定则规定，一个振动简正模式是红外活性的，当且仅当分子偶极矩对该简正坐标的导数不为零。\n\n你的任务是编写一个完整程序，对每个提供的测试用例，完全从第一性原理出发执行以下步骤：\n\n1. 从经典平衡点附近微振动模型开始。势能是位移的二次函数，动能是速度的二次函数。投影到振动子空间的质量加权Hessian矩阵产生一个对称矩阵，其本征值是角频率的平方，其标准正交本征矢量是在所选的$6$维振动坐标基下的简正模式。\n\n2. 使用此模型，通过对给定的$6 \\times 6$矩阵进行正交对角化来获得简正模式。将得到的简正模式按其角频率升序（等效于按本征值升序）排序。\n\n3. 使用从与辐射场的相互作用哈密顿量推导出的红外吸收偶极选择定则：如果偶极矩对相应简正坐标的导数不为零，则模式$k$是红外活性的。给定关于原始振动坐标的$3 \\times 6$偶极导数矩阵，通过线性变换到简正模式基，为每个简正模式计算偶极矩矢量对该简正坐标的导数。红外强度正比于该导数矢量的模方。实现一个数值活性阈值$\\varepsilon = 10^{-8}$来判断一个模式是否是活性的：如果模方大于$\\varepsilon$，则该模式被认为是红外活性的；否则为非活性。\n\n4. 通过归一化非负强度来报告相对强度，使得六个模式的强度之和为$1$。如果强度之和为$0$（所有模式均非活性），则报告归一化强度为六个零。你的程序应将归一化强度四舍五入到小数点后六位进行输出。\n\n你的程序必须独立处理每个测试用例，并生成一行包含结果列表的输出，每个测试用例一个，格式如下所述。对于每个测试用例，报告一对列表：第一个是布尔值列表，每个布尔值对应按角频率升序排列的六个模式之一，表示红外活性；第二个是相应的六个归一化强度（浮点数）列表，四舍五入到小数点后六位。最终输出格式为一行，包含一个包含三个此类对的列表，每个测试用例一个，严格打印为有效的Python嵌套列表字面量，例如：\n[[[True,False,True,True,False,True],[0.0,0.1,0.2,0.3,0.4,0.0]],[[...],[...]],[[...],[...]]]\n\n你必须采用的基础出发点：\n- 保守系统在平衡点附近的经典微振动：势能是位移的二次函数，动能是速度的二次函数。在质量加权坐标中，对二阶导数对称矩阵的对角化可得到简正模式和角频率的平方。\n- 电磁相互作用，其中电偶极近似下的跃迁强度与偶极矩对原子核简正坐标的导数相关，这意味着选择定则：红外活性要求沿着简正模式的偶极矩导数不为零。\n\n除了这些基础知识，不要使用任何预先推导的快捷公式；在你的解法中从这些基础出发推导所需的工作关系。\n\n测试套件：\n\n每个测试用例提供一个$6 \\times 6$的对称正定矩阵$\\mathbf{F}$和一个$3 \\times 6$的矩阵$\\mathbf{D}$。\n\n- 测试用例1（对角振动Hessian矩阵；直接的模式对应）：\n  - $\\mathbf{F}_1 = \\mathrm{diag}([\\,4,\\,9,\\,16,\\,25,\\,36,\\,49\\,])$，即\n    $$\\mathbf{F}_1 = \\begin{bmatrix}\n    4  0  0  0  0  0\\\\\n    0  9  0  0  0  0\\\\\n    0  0  16  0  0  0\\\\\n    0  0  0  25  0  0\\\\\n    0  0  0  0  36  0\\\\\n    0  0  0  0  0  49\n    \\end{bmatrix}.$$\n  - $\\mathbf{D}_1$的列对应六个振动坐标：\n    $$\\mathbf{D}_1 = \\begin{bmatrix}\n    0.0  0.2  0.1  0.0  0.05  -0.2\\\\\n    0.0  0.0  -0.1  0.0  0.05  0.2\\\\\n    0.0  0.0  0.0  0.3  0.05  0.0\n    \\end{bmatrix}.$$\n\n- 测试用例2（弱耦合振动Hessian矩阵；所有偶极导数为零：边界情况）：\n  - $$\\mathbf{F}_2 = \\begin{bmatrix}\n    6.0  0.2  0.0  0.0  0.0  0.0\\\\\n    0.2  7.0  0.1  0.0  0.0  0.0\\\\\n    0.0  0.1  8.0  0.3  0.0  0.0\\\\\n    0.0  0.0  0.3  9.0  0.2  0.0\\\\\n    0.0  0.0  0.0  0.2  10.0  0.1\\\\\n    0.0  0.0  0.0  0.0  0.1  11.0\n    \\end{bmatrix},\\quad\n    \\mathbf{D}_2 = \\begin{bmatrix}\n    0.0  0.0  0.0  0.0  0.0  0.0\\\\\n    0.0  0.0  0.0  0.0  0.0  0.0\\\\\n    0.0  0.0  0.0  0.0  0.0  0.0\n    \\end{bmatrix}.$$\n\n- 测试用例3（近简并块和中等耦合；一般的偶极导数）：\n  - $$\\mathbf{F}_3 = \\begin{bmatrix}\n    5.0  0.4  0.0  0.0  0.0  0.0\\\\\n    0.4  5.1  0.2  0.0  0.0  0.0\\\\\n    0.0  0.2  8.2  0.3  0.0  0.0\\\\\n    0.0  0.0  0.3  10.0  0.1  0.0\\\\\n    0.0  0.0  0.0  0.1  12.0  0.25\\\\\n    0.0  0.0  0.0  0.0  0.25  20.0\n    \\end{bmatrix},\\quad\n    \\mathbf{D}_3 = \\begin{bmatrix}\n    0.1  0.0  0.2  -0.1  0.1  0.0\\\\\n    0.0  0.15  0.0  0.05  -0.05  0.2\\\\\n    0.05  -0.05  0.1  0.0  0.0  -0.1\n    \\end{bmatrix}.$$\n\n要求的最终输出格式：\n- 你的程序应生成一行输出，其中包含一个Python风格的列表，列表包含三个元素，每个测试用例一个，每个元素本身是一个包含两个元素的列表：第一个元素是六个布尔值的列表（按角频率升序排列的红外活性标志），第二个元素是六个归一化强度的列表，四舍五入到小数点后六位。例如，一个语法上有效的输出可能看起来像：\n[[[False,True,True,True,True,True],[0.0,0.1,0.2,0.3,0.25,0.15]],[[False,False,False,False,False,False],[0.0,0.0,0.0,0.0,0.0,0.0]],[[True,True,True,True,True,True],[0.05,0.1,0.2,0.25,0.15,0.25]]]\n\n重要说明：\n- 不涉及角度，因此不需要角度单位。\n- 频率或强度不需要物理单位；将强度视为无量纲量，并将其归一化使其总和为$1$，如果总和为$0$则全为零。\n- 使用如上所述的数值活性阈值$\\varepsilon = 10^{-8}$。",
            "solution": "问题要求我们根据给定的甲醛的质量加权Hessian矩阵和在特定振动坐标系下的偶极矩导数矩阵，确定其振动简正模式的红外（IR）活性和相对强度。解法必须从经典微振动的第一性原理和红外吸收的量子力学选择定则推导得出。\n\n设质量加权振动坐标的$6$维向量为$\\mathbf{q}$。对于离平衡构型的小位移，动能$T$和势能$V$由下式给出：\n$$ T = \\frac{1}{2} \\dot{\\mathbf{q}}^T \\dot{\\mathbf{q}} $$\n$$ V = \\frac{1}{2} \\mathbf{q}^T \\mathbf{F} \\mathbf{q} $$\n这里，向量是列向量，$^T$表示转置，$\\mathbf{F}$是给定的$6 \\times 6$实对称正定质量加权Hessian矩阵。从拉格朗日量$L = T - V$导出的运动方程是：\n$$ \\ddot{\\mathbf{q}} + \\mathbf{F} \\mathbf{q} = \\mathbf{0} $$\n这是一个耦合线性二阶微分方程组。为了求解它，我们通过变换到简正坐标$\\mathbf{Q}$的基来解耦这些方程，在简正坐标基中势能是对角的。此变换通过找到$\\mathbf{F}$的本征矢量来实现。$\\mathbf{F}$的本征值方程为：\n$$ \\mathbf{F} \\mathbf{L} = \\mathbf{L} \\mathbf{\\Lambda} $$\n其中$\\mathbf{L}$是一个正交矩阵（$\\mathbf{L}^T \\mathbf{L} = \\mathbf{I}$），其列是$\\mathbf{F}$的标准正交本征矢量，$\\mathbf{\\Lambda}$是相应本征值$\\lambda_k$构成的对角矩阵。\n向简正坐标$\\mathbf{Q}$的变换定义为$\\mathbf{q} = \\mathbf{L} \\mathbf{Q}$。在这个新基中，运动方程变成解耦的简谐振子方程：\n$$ \\ddot{Q}_k + \\lambda_k Q_k = 0, \\quad \\text{对于 } k=1, \\dots, 6 $$\n本征值$\\lambda_k$是简正模式的角频率的平方（$\\lambda_k = \\omega_k^2$）。本征矢量，即$\\mathbf{L}$的列，表示为原始$\\mathbf{q}$坐标的线性组合的简正模式。问题要求按角频率升序对这些模式进行排序，这等同于按本征值$\\lambda_k$升序排序。\n\n一个振动模式具有红外活性的选择定则是跃迁偶极矩必须非零。在谐振子近似下，这简化为分子偶极矩矢量$\\vec{\\mu}$对相应简正坐标$Q_k$的导数必须为非零矢量的条件：\n$$ \\frac{\\partial \\vec{\\mu}}{\\partial Q_k} \\neq \\vec{0} $$\n吸收强度$I_k$正比于该导数矢量的模方：\n$$ I_k \\propto \\left\\| \\frac{\\partial \\vec{\\mu}}{\\partial Q_k} \\right\\|^2 $$\n我们被提供了$3 \\times 6$的矩阵$\\mathbf{D}$，其元素是偶极矩的三个笛卡尔分量（$\\mu_x, \\mu_y, \\mu_z$）对原始坐标$q_j$的导数：\n$$ D_{ij} = \\frac{\\partial \\mu_i}{\\partial q_j} \\quad (i \\in \\{x, y, z\\}, j \\in \\{1, \\dots, 6\\}) $$\n利用链式法则，我们可以将简正坐标基下的导数与原始坐标基下的导数联系起来。因为$\\mathbf{q} = \\mathbf{L} \\mathbf{Q}$，或$q_j = \\sum_k L_{jk} Q_k$，我们有：\n$$ \\frac{\\partial \\mu_i}{\\partial Q_k} = \\sum_{j=1}^{6} \\frac{\\partial \\mu_i}{\\partial q_j} \\frac{\\partial q_j}{\\partial Q_k} = \\sum_{j=1}^{6} D_{ij} L_{jk} $$\n这正是矩阵乘法的公式。设$\\mathbf{D}'$是关于简正坐标的$3 \\times 6$偶极导数矩阵，其中$D'_{ik} = \\frac{\\partial \\mu_i}{\\partial Q_k}$。那么：\n$$ \\mathbf{D}' = \\mathbf{D} \\mathbf{L} $$\n$\\mathbf{D}'$的第$k$列是矢量$\\frac{\\partial \\vec{\\mu}}{\\partial Q_k}$。第$k$个模式的未归一化强度是此列向量的模方：\n$$ I_k = \\left\\| \\left(\\mathbf{D}'\\right)_{\\text{col } k} \\right\\|^2 = \\sum_{i=1}^{3} (D'_{ik})^2 $$\n如果模式$k$的强度$I_k$大于给定的数值阈值$\\varepsilon = 10^{-8}$，则该模式被认为是红外活性的。\n\n最后一步是计算相对强度。这些强度是通过归一化计算出的强度，使其总和为$1$来获得的。对于一组六个强度$\\{I_1, I_2, \\dots, I_6\\}$，总强度为$I_{\\text{total}} = \\sum_{k=1}^6 I_k$。模式$k$的归一化强度为：\n$$ I_{k, \\text{norm}} = \\frac{I_k}{I_{\\text{total}}} $$\n如果$I_{\\text{total}} = 0$，则所有归一化强度都报告为$0$。\n\n每个测试用例$(\\mathbf{F}, \\mathbf{D})$的总体算法如下：\n1.  计算对称矩阵$\\mathbf{F}$的本征值$\\lambda_k$和相应的标准正交本征矢量（$\\mathbf{L}$的列）。这通过数值本征求解器完成，该求解器按惯例返回升序排列的本征值和相应的本征矢量。\n2.  将偶极导数矩阵从初始坐标基变换到简正模式基：$\\mathbf{D}' = \\mathbf{D} \\mathbf{L}$。\n3.  通过对$\\mathbf{D}'$的第$k$列中的元素求平方和，计算每个模式$k=1, \\dots, 6$的未归一化强度$I_k$。\n4.  确定每个模式的活性：如果$I_k  10^{-8}$，则模式$k$是活性的。这将产生一个包含六个布尔值的列表。\n5.  计算总强度$I_{\\text{total}} = \\sum_k I_k$。如果$I_{\\text{total}}$实际上为零，则归一化强度全为$0$。否则，为每个模式计算$I_{k, \\text{norm}} = I_k / I_{\\text{total}}$。\n6.  将归一化强度四舍五入到小数点后六位，并将两个列表（活性布尔值和归一化强度）组合成最终所需的输出格式。",
            "answer": "[[[False, True, True, True, True, True], [0.0, 0.168421, 0.084211, 0.378947, 0.031579, 0.336842]], [[False, False, False, False, False, False], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]], [[True, True, True, True, True, True], [0.170942, 0.090629, 0.260589, 0.065275, 0.049449, 0.363116]]]"
        }
    ]
}