{
    "hands_on_practices": [
        {
            "introduction": "要理解强稳定性保持（SSP）方法的工作原理，最好从一个基础的例子开始。这个练习  将引导你对二阶Heun方法进行完整分析，揭示其代数结构与稳定性属性之间的深刻联系。通过推导其Shu–Osher范式并比较得到的SSP系数与绝对单调半径，你将亲手洞察保证非线性稳定性的理论基础。",
            "id": "3421294",
            "problem": "考虑一个由线性平流的间断Galerkin空间离散产生的半离散系统，抽象地写为 $u^{\\prime}(t) = \\mathcal{L}(u(t))$。已知前向欧拉法在 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$ 的条件下是单调的（例如，总变差不增）。将两步二阶Heun格式（也称为显式梯形法）应用于此系统，其分步定义如下：\n$$\nu^{(1)} = u^{n} + \\Delta t\\, \\mathcal{L}(u^{n}), \\qquad\nu^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\Big(\\mathcal{L}(u^{n}) + \\mathcal{L}(u^{(1)})\\Big).\n$$\n使用线性检验方程 $y^{\\prime} = \\lambda y$ 和 $z = \\Delta t\\, \\lambda$，从基本原理出发完成以下任务：\n- 推导该方法的稳定性多项式 $p(z)$，其定义为 $y^{n+1} = p(z)\\, y^{n}$。\n- 使用显式Runge–Kutta方法的绝对单调性定义，确定绝对单调半径 $R$，即最大的实数 $R \\ge 0$，使得该方法在区间 $[-R, 0]$ 上是绝对单调的。\n- 将该方法写成与强稳定性保持 (SSP) 时间积分相关的Shu–Osher形式，并确定相应的SSP系数 $C$，该系数保证在 $\\Delta t \\le C\\, \\Delta t_{\\mathrm{FE}}$ 时方法的单调性。\n- 在负实轴上比较 $R$ 和 $C$，并仅使用稳定性函数、绝对单调性和Shu–Osher表示的核心定义来证明你得到的任何等式或不等式。\n\n作为你最终报告的结果，提供绝对单调半径 $R$ 的值。这个量是无量纲的。无需四舍五入；报告精确值。",
            "solution": "该问题要求在强稳定性保持 (SSP) 时间积分的背景下，对两步二阶Heun方法进行分析。我们将按顺序处理四个要求的任务。\n\n数值格式由以下公式给出：\n$$\nu^{(1)} = u^{n} + \\Delta t\\, \\mathcal{L}(u^{n})\n$$\n$$\nu^{n+1} = u^{n} + \\frac{\\Delta t}{2}\\Big(\\mathcal{L}(u^{n}) + \\mathcal{L}(u^{(1)})\\Big)\n$$\n\n半离散系统为 $u^{\\prime}(t) = \\mathcal{L}(u(t))$，并且假设前向欧拉法 $u^{n+1} = u^n + \\Delta t \\mathcal{L}(u^n)$ 在时间步长 $\\Delta t \\le \\Delta t_{\\mathrm{FE}}$ 时是单调的。\n\n**1. 稳定性多项式 $p(z)$ 的推导**\n\n为求稳定性多项式，我们将该方法应用于线性检验方程 $y^{\\prime} = \\lambda y$，其中 $\\lambda$ 是一个复常数。在此背景下，算子 $\\mathcal{L}$ 对应于乘以 $\\lambda$，因此 $\\mathcal{L}(y) = \\lambda y$。我们定义 $z = \\Delta t \\lambda$。\n\n首先，我们计算中间步 $y^{(1)}$：\n$$\ny^{(1)} = y^{n} + \\Delta t (\\lambda y^{n}) = (1 + \\Delta t \\lambda) y^{n} = (1 + z) y^{n}\n$$\n接下来，我们计算到下一个时间层 $y^{n+1}$ 的更新：\n$$\ny^{n+1} = y^{n} + \\frac{\\Delta t}{2}\\Big(\\mathcal{L}(y^{n}) + \\mathcal{L}(y^{(1)})\\Big) = y^{n} + \\frac{\\Delta t}{2}\\Big(\\lambda y^{n} + \\lambda y^{(1)}\\Big)\n$$\n代入 $y^{(1)}$ 的表达式：\n$$\ny^{n+1} = y^{n} + \\frac{\\Delta t}{2}\\Big(\\lambda y^{n} + \\lambda (1 + z) y^{n}\\Big)\n$$\n从右侧提取公因子 $y^n$：\n$$\ny^{n+1} = \\left[ 1 + \\frac{\\Delta t \\lambda}{2}\\Big(1 + (1 + z)\\Big) \\right] y^{n} = \\left[ 1 + \\frac{z}{2}(2 + z) \\right] y^{n}\n$$\n化简括号中的表达式，得到稳定性多项式 $p(z)$：\n$$\ny^{n+1} = \\left[ 1 + z + \\frac{z^2}{2} \\right] y^{n}\n$$\n因此，稳定性多项式为 $p(z) = 1 + z + \\frac{1}{2}z^2$。正如对一个二阶Runge-Kutta方法所预期的那样，这是 $\\exp(z)$ 的二阶泰勒级数展开。\n\n**2. 绝对单调半径 $R$ 的确定**\n\n如果一个具有稳定性多项式 $p(z)$ 的显式Runge-Kutta方法的所有阶导数在所有 $z \\in [-R, 0]$ 上都是非负的，则该方法在区间 $[-R, 0]$ 上是绝对单调的。也就是说，对于所有整数 $k \\ge 0$ 和所有 $z \\in [-R, 0]$，必须有 $p^{(k)}(z) \\ge 0$。\n\n我们计算 $p(z) = 1 + z + \\frac{1}{2}z^2$ 的导数：\n- $p^{(0)}(z) = p(z) = 1 + z + \\frac{1}{2}z^2$\n- $p^{(1)}(z) = p'(z) = 1 + z$\n- $p^{(2)}(z) = p''(z) = 1$\n- 对于 $k \\ge 3$，$p^{(k)}(z) = 0$\n\n现在我们检查在区间 $z \\in [-R, 0]$ 上每个导数的非负性条件：\n- 对于 $k \\ge 2$，导数 $1$ 和 $0$ 始终是非负的，所以它们对 $R$ 没有施加任何限制。\n- 对于 $p(z) = 1 + z + \\frac{1}{2}z^2$：这是一个开口向上的抛物线。它的顶点（最小值）出现在 $p'(z) = 0$ 的地方，即 $z=-1$。最小值为 $p(-1) = 1 - 1 + \\frac{1}{2}(-1)^2 = \\frac{1}{2}$。由于最小值是正的，$p(z) > 0$ 对所有实数 $z$ 成立。这个条件对 $R$ 没有施加任何限制。\n- 对于 $p'(z) = 1 + z$：我们要求对于所有 $z \\in [-R, 0]$ 都有 $1 + z \\ge 0$。这个区间中最严格的点是 $z = -R$。条件变为 $1 + (-R) \\ge 0$，化简为 $R \\le 1$。\n\n为了同时满足所有条件，我们必须有 $R \\le 1$。绝对单调半径 $R$ 是满足条件的最大值，因此 $R=1$。\n\n**3. Shu–Osher形式和SSP系数 $C$**\n\n如果一个方法可以表示为前向欧拉步的凸组合，则该方法是强稳定性保持 (SSP) 的。目标是将Heun格式重写为Shu-Osher形式：\n$u^{(0)} = u^{n}$\n$u^{(i)} = \\sum_{j=0}^{i-1} \\left( \\alpha_{ij} u^{(j)} + \\Delta t \\beta_{ij} \\mathcal{L}(u^{(j)}) \\right)$，其中 $\\alpha_{ij} \\ge 0, \\beta_{ij} \\ge 0$。\n如果对于每个步 $i$，$\\sum_{j=0}^{i-1} \\alpha_{ij} = 1$，则该方法是SSP的。SSP系数 $C$ 则由 $C = \\min_{i,j, \\beta_{ij}>0} \\frac{\\alpha_{ij}}{\\beta_{ij}}$ 给出。\n\n让我们来处理给定的格式。我们定义 $u^{(0)}=u^n$。第一步是一个前向欧拉步：\n$u^{(1)} = u^n + \\Delta t \\mathcal{L}(u^n) = u^{(0)} + \\Delta t \\mathcal{L}(u^{(0)})$。\n这与 $i=1$ 时的Shu-Osher形式相匹配，其中 $\\alpha_{10}=1$ 和 $\\beta_{10}=1$。\n\n现在我们重写最后一步 $u^{n+1}$，我们将其标记为 $u^{(2)}$：\n$u^{n+1} = u^n + \\frac{1}{2}\\Delta t \\mathcal{L}(u^n) + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n我们可以策略性地将其重写为：\n$u^{n+1} = \\frac{1}{2}u^n + \\frac{1}{2}u^n + \\frac{1}{2}\\Delta t \\mathcal{L}(u^n) + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n分组：\n$u^{n+1} = \\frac{1}{2}u^n + \\frac{1}{2}(u^n + \\Delta t \\mathcal{L}(u^n)) + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n代入 $u^{(0)}=u^n$ 和 $u^{(1)} = u^n + \\Delta t \\mathcal{L}(u^n)$：\n$u^{n+1} = \\frac{1}{2}u^{(0)} + \\frac{1}{2}u^{(1)} + \\frac{1}{2}\\Delta t \\mathcal{L}(u^{(1)})$\n我们可以将与 $u^{(1)}$ 相关的项分组：\n$u^{n+1} = \\frac{1}{2}u^{(0)} + \\frac{1}{2}(u^{(1)} + \\Delta t \\mathcal{L}(u^{(1)}))$\n\n这个表达式是 $u^{(0)}$ 和一个应用于 $u^{(1)}$ 的前向欧拉步的凸组合。完整的Shu-Osher表示为：\n$u^{(0)} = u^n$\n$u^{(1)} = 1 \\cdot u^{(0)} + \\Delta t \\cdot 1 \\cdot \\mathcal{L}(u^{(0)})$\n$u^{(2)} = u^{n+1} = \\frac{1}{2} u^{(0)} + \\frac{1}{2} u^{(1)} + \\Delta t \\cdot 0 \\cdot \\mathcal{L}(u^{(0)}) + \\Delta t \\cdot \\frac{1}{2} \\mathcal{L}(u^{(1)})$\n系数为：\n- 对于步 $i=1$：$\\alpha_{10}=1, \\beta_{10}=1$。\n- 对于步 $i=2$：$\\alpha_{20}=1/2, \\alpha_{21}=1/2$，所以 $\\sum \\alpha_{2j} = 1$。并且 $\\beta_{20}=0, \\beta_{21}=1/2$。\n所有系数 $\\alpha_{ij}, \\beta_{ij}$ 都是非负的。\nSSP系数是比值 $\\alpha_{ij}/\\beta_{ij}$（其中 $\\beta_{ij}>0$）的最小值：\n$C = \\min\\left( \\frac{\\alpha_{10}}{\\beta_{10}}, \\frac{\\alpha_{21}}{\\beta_{21}} \\right) = \\min\\left( \\frac{1}{1}, \\frac{1/2}{1/2} \\right) = \\min(1, 1) = 1$。\nSSP系数为 $C=1$。对于 $\\Delta t \\le 1 \\cdot \\Delta t_{\\mathrm{FE}}$，单调性得到保证。\n\n**4. $R$ 和 $C$ 的比较与证明**\n\n我们发现绝对单调半径为 $R=1$，SSP系数为 $C=1$。因此，对于此方法，$R=C$。\n\n这个等式并非巧合；它是SSP方法理论中的一个基本结果。其证明依赖于Shu-Osher表示与稳定性多项式性质之间的联系。\n如果一个方法具有一个Shu-Osher表示，其中所有系数 $\\alpha_{ij}, \\beta_{ij}$ 都是非负的并且满足 $\\alpha_{ij} \\ge C\\beta_{ij}$，那么该方法是SSP的，系数为 $C$。\n让我们证明这意味着在 $[-C, 0]$ 上是绝对单调的。\n每个步的稳定性多项式 $p_i(z)$ 遵循递推关系：\n$p_i(z) = \\sum_{j=0}^{i-1} (\\alpha_{ij} + z\\beta_{ij}) p_j(z)$，其中 $p_0(z)=1$。\n给定SSP条件 $\\alpha_{ij} \\ge C\\beta_{ij}$，我们可以写成 $\\alpha_{ij} = C\\beta_{ij} + \\gamma_{ij}$，其中 $\\gamma_{ij} \\ge 0$。\n递推关系变为 $p_i(z) = \\sum_{j=0}^{i-1} [\\beta_{ij}(C+z) + \\gamma_{ij}] p_j(z)$。\n我们可以通过对步数索引 $i$ 进行数学归纳来证明，对于所有 $k \\ge 0$ 和 $z \\in [-C, 0]$，$p_i^{(k)}(z) \\ge 0$。\n- 基础情形 ($i=0$)：$p_0(z)=1$。其所有导数都是非负的。\n- 归纳步骤：假设对于所有 $j  i$ 和所有 $k \\ge 0$，在 $[-C, 0]$ 上 $p_j^{(k)}(z) \\ge 0$。\n那么对于 $p_i(z)$，我们有一系列项 $[\\beta_{ij}(C+z) + \\gamma_{ij}] p_j(z)$ 的和。在 $[-C, 0]$ 上，我们有 $C+z \\ge 0$。由于 $\\beta_{ij}, \\gamma_{ij} \\ge 0$，并根据归纳假设 $p_j(z) \\ge 0$，可得 $p_i(z) \\ge 0$。\n通过将乘法求导法则应用于递推公式，每个导数 $p_i^{(k)}(z)$ 在 $[-C, 0]$ 上都将是一系列非负项的和。例如，$p_i'(z) = \\sum [\\beta_{ij}p_j(z) + (\\beta_{ij}(C+z) + \\gamma_{ij})p_j'(z)]$，这是一系列非负量的和。\n这证明了如果一个方法的SSP系数为 $C$，它必须在 $[-C, 0]$ 上是绝对单调的。根据绝对单调半径 $R$ 的定义，这意味着 $R \\ge C$。\n\n对于最优SSP方法，如此处所考虑的方法，SSP系数被最大化，从而导致等式 $R=C$。我们从基本原理出发的独立计算（从 $p(z)$ 的导数得到 $R=1$，从Shu-Osher形式得到 $C=1$）证实了Heun方法的这个等式。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "SSP格式的整体稳定性取决于两个因素：时间积分器的SSP系数 $C$ 和应用于特定空间离散化的前向欧拉法的稳定性极限 $\\Delta t_{\\mathrm{FE}}$。这个练习  填补了抽象时间积分理论与其在间断Galerkin（DG）方法产生的具体系统上的应用之间的鸿沟。通过为一个给定的系统矩阵计算最大允许的前向欧拉时间步长，你将学到在实践中实现稳定高阶数值格式的一项关键技能。",
            "id": "3421337",
            "problem": "考虑一个线性半离散系统，该系统由标量平流方程在参考单元 $[-1,1]$ 上使用模态勒让德多项式基进行间断伽辽金 (DG) 离散化得到。设该半离散系统写为 $M \\, \\frac{d u}{d t} = K \\, u$ 的形式，其中 $M \\in \\mathbb{R}^{3 \\times 3}$ 是对称正定质量矩阵，$K \\in \\mathbb{R}^{3 \\times 3}$ 是由所选数值通量定义的刚度矩阵。假设矩阵为\n$$\nM = \\begin{pmatrix}\n2   0   0 \\\\\n0   \\frac{2}{3}   0 \\\\\n0   0   \\frac{2}{5}\n\\end{pmatrix}, \n\\quad\nK = \\begin{pmatrix}\n-6   6   0 \\\\\n2   -\\frac{16}{3}   \\frac{10}{3} \\\\\n0   2   -2\n\\end{pmatrix}.\n$$\n定义系统矩阵 $A = M^{-1} K$。在强稳定保持 (SSP) 时间积分的背景下，前向欧拉 (FE) 步长 $\\Delta t_{\\mathrm{FE}}$ 是使得前向欧拉更新 $u^{n+1} = u^{n} + \\Delta t_{\\mathrm{FE}} \\, A \\, u^{n}$ 对于一个凸泛函（此处取为 $\\mathbb{R}^{3}$ 上的 $\\ell_{1}$ 范数）是单调的最大步长。\n\n从线性系统显式时间步进的单调性基本原理出发，并使用以下两种工具之一：\n- $\\ell_{1}$ 矩阵测度 $\\mu_{1}(A)$，定义为 $\\mu_{1}(A) = \\max_{j} \\left( a_{jj} + \\sum_{i \\neq j} |a_{ij}| \\right)$，或\n- 格尔什戈林圆盘定理以界定 $A$ 的特征值，以及标量测试方程的前向欧拉绝对稳定域，\n\n为该系统推导一个关于 $\\Delta t_{\\mathrm{FE}}$ 的严格上界，并进行数值计算。最终答案必须是一个实数。不需要物理单位。如果需要四舍五入，则保留四位有效数字；否则提供精确值。",
            "solution": "首先将对问题的科学合理性、一致性和完整性进行验证。\n\n### 步骤 1：提取已知条件\n- 线性半离散系统由 $M \\, \\frac{d u}{d t} = K \\, u$ 给出，其中 $u \\in \\mathbb{R}^{3}$。\n- 质量矩阵 $M$ 为 $M = \\begin{pmatrix} 2   0   0 \\\\ 0   \\frac{2}{3}   0 \\\\ 0   0   \\frac{2}{5} \\end{pmatrix}$。\n- 刚度矩阵 $K$ 为 $K = \\begin{pmatrix} -6   6   0 \\\\ 2   -\\frac{16}{3}   \\frac{10}{3} \\\\ 0   2   -2 \\end{pmatrix}$。\n- 系统矩阵定义为 $A = M^{-1} K$。\n- 时间积分方法是前向欧拉 (FE) 方法：$u^{n+1} = u^{n} + \\Delta t \\, A \\, u^{n}$。\n- 任务是找到最大步长 $\\Delta t_{\\mathrm{FE}}$，使得 FE 更新对于 $\\mathbb{R}^{3}$ 上的 $\\ell_{1}$ 范数是单调的。这等价于找到最大的 $\\Delta t$，使得更新在 $\\ell_{1}$ 范数下是收缩的，即 $\\|u^{n+1}\\|_{\\ell_{1}} \\le \\|u^{n}\\|_{\\ell_{1}}$。\n- 推导过程建议使用两种工具：\n    1. $\\ell_{1}$ 矩阵测度 $\\mu_{1}(A) = \\max_{j} \\left( a_{jj} + \\sum_{i \\neq j} |a_{ij}| \\right)$。\n    2. 格尔什戈林圆盘定理和 FE 绝对稳定域。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题设置在偏微分方程数值分析的背景下，特别是间断伽辽金方法和强稳定保持 (SSP) 时间积分器。矩阵 $M$ 和 $K$、$\\ell_{1}$ 范数单调性的概念、矩阵测度以及格尔什戈林圆盘定理都是数学和科学计算中的标准且成熟的概念。质量矩阵的元素 $M_{ii} = \\frac{2}{2(i-1)+1}$ 对应于缩放后的勒让德多项式的内积，这与问题描述一致。\n- **适定性：** 该问题提供了所有必要的数据（$M$ 和 $K$）和定义，以计算系统矩阵 $A$ 并推导时间步长限制。目标陈述清晰，并期望得到唯一的数值答案。\n- **客观性：** 该问题以精确的数学语言陈述，没有任何主观性或歧义。\n- **完整性与一致性：** 该问题是自洽的。质量矩阵 $M$ 是对角且正定的，因此是可逆的，这确保了系统矩阵 $A$ 是良定义的。所提供的信息中没有矛盾之处。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答推导\n目标是找到最大步长 $\\Delta t = \\Delta t_{\\mathrm{FE}} > 0$，使得前向欧拉更新在 $\\ell_{1}$ 范数下是收缩的。该更新由 $u^{n+1} = u^{n} + \\Delta t \\, A \\, u^{n} = (I + \\Delta t A) u^{n}$ 给出，其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n\n$\\ell_{1}$-收缩性的条件是放大矩阵 $(I + \\Delta t A)$ 的诱导 $\\ell_{1}$-范数小于或等于 $1$：\n$$\n\\|I + \\Delta t A\\|_{\\ell_{1}} \\le 1\n$$\n矩阵 $B \\in \\mathbb{R}^{m \\times m}$ 的诱导 $\\ell_{1}$-范数定义为最大绝对列和：\n$$\n\\|B\\|_{\\ell_{1}} = \\max_{1 \\le j \\le m} \\sum_{i=1}^{m} |b_{ij}|\n$$\n将此应用于矩阵 $B = I + \\Delta t A$，其元素为 $b_{ij} = \\delta_{ij} + \\Delta t a_{ij}$，其中 $\\delta_{ij}$ 是克罗内克 δ。该条件变为：\n$$\n\\max_{j} \\left( |1 + \\Delta t a_{jj}| + \\sum_{i \\neq j} |\\Delta t a_{ij}| \\right) \\le 1\n$$\n这个不等式必须对每一列 $j$ 都成立。因此，对于所有 $j \\in \\{1, 2, 3\\}$：\n$$\n|1 + \\Delta t a_{jj}| + \\Delta t \\sum_{i \\neq j} |a_{ij}| \\le 1\n$$\n\n首先，我们必须计算系统矩阵 $A = M^{-1} K$。\n质量矩阵为 $M = \\begin{pmatrix} 2   0   0 \\\\ 0   \\frac{2}{3}   0 \\\\ 0   0   \\frac{2}{5} \\end{pmatrix}$。其逆矩阵为 $M^{-1} = \\begin{pmatrix} \\frac{1}{2}   0   0 \\\\ 0   \\frac{3}{2}   0 \\\\ 0   0   \\frac{5}{2} \\end{pmatrix}$。\n现在，我们计算 $A$：\n$$\nA = M^{-1} K = \\begin{pmatrix} \\frac{1}{2}   0   0 \\\\ 0   \\frac{3}{2}   0 \\\\ 0   0   \\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} -6   6   0 \\\\ 2   -\\frac{16}{3}   \\frac{10}{3} \\\\ 0   2   -2 \\end{pmatrix}\n$$\n$$\nA = \\begin{pmatrix}\n(\\frac{1}{2})(-6)   (\\frac{1}{2})(6)   (\\frac{1}{2})(0) \\\\\n(\\frac{3}{2})(2)   (\\frac{3}{2})(-\\frac{16}{3})   (\\frac{3}{2})(\\frac{10}{3}) \\\\\n(\\frac{5}{2})(0)   (\\frac{5}{2})(2)   (\\frac{5}{2})(-2)\n\\end{pmatrix}\n= \\begin{pmatrix}\n-3   3   0 \\\\\n3   -8   5 \\\\\n0   5   -5\n\\end{pmatrix}\n$$\n现在我们对 $A$ 的每一列应用 $\\ell_{1}$-收缩性条件。\n\n对于列 $j = 1$：$a_{11} = -3$，$\\sum_{i \\neq 1} |a_{i1}| = |3| + |0| = 3$。\n条件是 $|1 - 3 \\Delta t| + 3 \\Delta t \\le 1$。\n如果 $\\Delta t > 1/3$，那么 $1 - 3 \\Delta t  0$，所以 $|1 - 3 \\Delta t| = 3 \\Delta t - 1$。不等式变为 $(3 \\Delta t - 1) + 3 \\Delta t = 6 \\Delta t - 1 \\le 1$，这意味着 $6 \\Delta t \\le 2$，或 $\\Delta t \\le 1/3$。这与假设 $\\Delta t > 1/3$ 矛盾。\n因此，我们必须有 $\\Delta t \\le 1/3$。在这种情况下，$1 - 3 \\Delta t \\ge 0$，不等式变为 $(1 - 3 \\Delta t) + 3 \\Delta t = 1 \\le 1$，这永远成立。\n因此，第一列带来的约束是 $\\Delta t \\le 1/3$。\n\n对于列 $j = 2$：$a_{22} = -8$，$\\sum_{i \\neq 2} |a_{i2}| = |3| + |5| = 8$。\n条件是 $|1 - 8 \\Delta t| + 8 \\Delta t \\le 1$。\n类似地，如果我们假设 $\\Delta t > 1/8$，不等式变为 $(8 \\Delta t - 1) + 8 \\Delta t = 16 \\Delta t - 1 \\le 1$，这意味着 $16 \\Delta t \\le 2$，或 $\\Delta t \\le 1/8$。这是一个矛盾。\n所以我们必须有 $\\Delta t \\le 1/8$。对于这样的 $\\Delta t$，不等式变为 $(1 - 8 \\Delta t) + 8 \\Delta t = 1 \\le 1$，这永远成立。\n第二列带来的约束是 $\\Delta t \\le 1/8$。\n\n对于列 $j = 3$：$a_{33} = -5$，$\\sum_{i \\neq 3} |a_{i3}| = |0| + |5| = 5$。\n条件是 $|1 - 5 \\Delta t| + 5 \\Delta t \\le 1$。\n类似地，假设 $\\Delta t > 1/5$ 会导致矛盾 ($10 \\Delta t \\le 2 \\implies \\Delta t \\le 1/5$)。\n所以我们必须有 $\\Delta t \\le 1/5$。对于这样的 $\\Delta t$，不等式变为 $(1 - 5 \\Delta t) + 5 \\Delta t = 1 \\le 1$，这永远成立。\n第三列带来的约束是 $\\Delta t \\le 1/5$。\n\n为了同时满足所有列的条件，时间步长 $\\Delta t$ 必须小于或等于各个上界的最小值：\n$$\n\\Delta t \\le \\min \\left( \\frac{1}{3}, \\frac{1}{8}, \\frac{1}{5} \\right)\n$$\n这些值中的最小值是 $1/8$。\n$$\n\\Delta t \\le \\frac{1}{8}\n$$\n因此，使得前向欧拉方法在 $\\ell_1$-范数下单调的最大可能步长 $\\Delta t_{\\mathrm{FE}}$ 是 $1/8$。其数值为 $0.125$。由于是精确分数，无需四舍五入。",
            "answer": "$$\n\\boxed{\\frac{1}{8}}\n$$"
        },
        {
            "introduction": "这个高级练习  代表了一个综合性应用，整合了SSP框架的所有概念。你将为非线性Burgers方程的DG离散推导出完整的稳定性条件，该条件考虑了多项式次数 $p$，并用它来构建一个实用的稳定性检查。这项练习巩固了你对如何设计和分析现代高阶无振荡数值方法的理解。",
            "id": "3421343",
            "problem": "考虑一维无粘伯格斯方程 $u_t + \\left(\\frac{u^2}{2}\\right)_x = 0$ 在周期性域 $[0,1]$ 上的情况，该方程通过间断伽辽金 (DG) 方法在 $N$ 个大小为 $h = 1/N$ 的单元组成的均匀网格上进行离散。在每个单元中，使用参考区间 $[-1,1]$ 上的勒让德基中的 $p$ 次多项式来近似 $u$。令 $\\bar{u}_i$ 表示单元 $i$ 中的单元平均值。使用局部 Lax–Friedrichs 数值通量\n$$\n\\hat{f}(a,b) = \\frac{1}{2}\\left(\\frac{a^2}{2}+\\frac{b^2}{2}\\right) - \\frac{\\alpha}{2}(b-a),\n$$\n其中全局耗散参数 $\\alpha \\ge \\sup_{x}|u(x,t)|$（在当前时刻）。假设使用一个线性缩放斜率限制器，该限制器在时间积分器的每个阶段都会重新缩放与单元平均值的偏差，以使得在每个单元交界面处，DG 多项式迹都位于相邻单元平均值的界限内；具体而言，在每个单元 $i$ 中，存在一个 $\\theta_i \\in [0,1]$，使得限制后的多项式为 $\\tilde{u}_i(\\xi) = \\bar{u}_i + \\theta_i\\left(u_i(\\xi) - \\bar{u}_i\\right)$，并且交界面值满足\n$$\n\\tilde{u}_i(\\pm 1) \\in \\left[\\min\\{\\bar{u}_{i-1},\\bar{u}_i,\\bar{u}_{i+1}\\}, \\max\\{\\bar{u}_{i-1},\\bar{u}_i,\\bar{u}_{i+1}\\}\\right]。\n$$\n\n时间积分采用三阶三步强稳定性保持龙格－库塔 (SSPRK$(3,3)$) 方法，并在每个阶段后应用限制器。由单元平均值构成的分段常数函数的全变差 (TV) 半范数为\n$$\n\\operatorname{TV}(\\{\\bar{u}_i\\}) = \\sum_{i=1}^{N} \\left|\\bar{u}_{i+1} - \\bar{u}_i\\right|,\n$$\n其中索引为周期性索引。你需要从第一性原理和核心定义出发，围绕前向欧拉时间步进下的单调性以及强稳定性保持 (SSP) 性质进行推理，以确定一个用 $h$、$\\alpha$ 和 $p$ 表示的精确时间步长限制 $\\Delta t$，该限制能确保在使用上述限制器的 SSPRK$(3,3)$ 方法下，单元平均值的 TV 半范数在每个时间步都是非增的。你的推导必须从测试函数等于 $1$ 的 DG 弱形式、当 $\\alpha \\ge \\sup|u|$ 时局部 Lax–Friedrichs 通量对其每个参数的单调性，以及 SSP 方法的凸组合结构出发，并可使用 $[-1,1]$ 上著名的多项式反演不等式。\n\n任务：\n\n- 推导一个形式为 $\\Delta t \\le C_{\\mathrm{SSP}} \\Delta t_{\\mathrm{FE}}(p)$ 的界，该界保证在使用 SSPRK$(3,3)$ 时，单元平均值满足 $\\operatorname{TV}(\\{\\bar{u}_i^{n+1}\\}) \\le \\operatorname{TV}(\\{\\bar{u}_i^{n}\\})$，其中 $C_{\\mathrm{SSP}}$ 是时间积分器的强稳定性保持系数，$\\Delta t_{\\mathrm{FE}}(p)$ 是依赖于 $p$ 的前向欧拉步长界。\n- 确定 SSPRK$(3,3)$ 的 $C_{\\mathrm{SSP}}$ 的精确值，并给出 $\\Delta t_{\\mathrm{FE}}(p)$ 对 $p$ 的精确依赖关系。\n- 使用你推导出的公式，实现一个程序，对于每个测试用例 $(p,h,\\alpha,\\kappa)$，计算\n  1. 前向欧拉精确界 $\\Delta t_{\\mathrm{FE}}(p,h,\\alpha)$（作为浮点数），以及\n  2. 一个布尔值，如果 $\\Delta t = \\kappa \\,\\Delta t_{\\mathrm{FE}}(p,h,\\alpha)$ 保证了在使用指定限制器的 SSPRK$(3,3)$ 方法下，单元平均值的 TV 半范数是非增的，则该值为真，否则为假。\n\n假设本问题不涉及角度。除了抽象的时间和空间单位外，不需要其他物理单位。\n\n测试套件：\n\n- 情况 A（低于界限的一般情况）：$(p,h,\\alpha,\\kappa) = (0, 1/100, 1, 0.99)$。\n- 情况 B（位于界限上的边界情况）：$(p,h,\\alpha,\\kappa) = (1, 1/64, 1, 1.0)$。\n- 情况 C（略高于界限的情况）：$(p,h,\\alpha,\\kappa) = (2, 1/50, 1, 1.01)$。\n- 情况 D（不同的 $\\alpha$）：$(p,h,\\alpha,\\kappa) = (3, 1/80, 0.8, 0.999)$。\n- 情况 E（粗网格和较大的 $\\alpha$，高于界限）：$(p,h,\\alpha,\\kappa) = (0, 1/20, 2.0, 1.5)$。\n- 情况 F（位于界限上的更高阶）：$(p,h,\\alpha,\\kappa) = (4, 1/120, 1.0, 1.0)$。\n\n最终输出格式：\n\n- 你的程序应生成单行输出，其中包含按顺序聚合为逗号分隔的 Python 风格列表的所有结果。对于每个测试用例，输出前向欧拉界（作为浮点数），并紧随其后输出布尔决策。对于上述六种情况，你的程序必须以精确格式打印单行输出：\n  \"[fe_bound_A,decision_A,fe_bound_B,decision_B,fe_bound_C,decision_C,fe_bound_D,decision_D,fe_bound_E,decision_E,fe_bound_F,decision_F]\"。",
            "solution": "用户希望为应用于无粘伯格斯方程的间断伽辽金 (DG) 方法找到一个精确的时间步长限制，使得在使用三阶强稳定性保持龙格－库塔 (SSPRK) 方法时，单元平均值的全变差 (TV) 是非增的。\n\n### 第 1 步：问题验证\n\n**1.1. 提取已知条件**\n- **PDE**：一维无粘伯格斯方程，$u_t + \\left(\\frac{u^2}{2}\\right)_x = 0$。\n- **区域**：在 $[0,1]$ 上周期性。\n- **离散化**：在由 $N$ 个大小为 $h = 1/N$ 的单元组成的均匀网格上使用间断伽辽金 (DG) 方法。\n- **基**：来自参考区间 $[-1,1]$ 上勒让德基的 $p$ 次多项式。\n- **数值通量**：局部 Lax–Friedrichs 通量，$\\hat{f}(a,b) = \\frac{1}{2}\\left(\\frac{a^2}{2}+\\frac{b^2}{2}\\right) - \\frac{\\alpha}{2}(b-a)$，其中 $\\alpha \\ge \\sup_{x}|u(x,t)|$。\n- **限制器**：一个线性缩放斜率限制器，它将单元 $i$ 中的多项式 $u_i(\\xi)$ 修改为 $\\tilde{u}_i(\\xi) = \\bar{u}_i + \\theta_i(u_i(\\xi) - \\bar{u}_i)$，其中 $\\theta_i \\in [0,1]$。该限制器确保限制后多项式的交界面值满足 $\\tilde{u}_i(\\pm 1) \\in \\left[\\min\\{\\bar{u}_{i-1},\\bar{u}_i,\\bar{u}_{i+1}\\}, \\max\\{\\bar{u}_{i-1},\\bar{u}_i,\\bar{u}_{i+1}\\}\\right]$。限制器在时间积分器的每个阶段后应用。\n- **时间积分**：SSPRK$(3,3)$，三阶三步强稳定性保持龙格－库塔方法。\n- **关注量**：单元平均值 $\\{\\bar{u}_i\\}$ 的全变差 (TV) 半范数，定义为 $\\operatorname{TV}(\\{\\bar{u}_i\\}) = \\sum_{i=1}^{N} \\left|\\bar{u}_{i+1} - \\bar{u}_i\\right|$，使用周期性索引。\n- **目标**：推导一个精确的时间步长限制 $\\Delta t \\le C_{\\mathrm{SSP}} \\Delta t_{\\mathrm{FE}}(p)$，以保证 $\\operatorname{TV}(\\{\\bar{u}_i^{n+1}\\}) \\le \\operatorname{TV}(\\{\\bar{u}_i^{n}\\})$，并确定 $C_{\\mathrm{SSP}}$ 的值和函数 $\\Delta t_{\\mathrm{FE}}(p)$。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题具有科学依据、适定且客观。它描述了双曲守恒律数值分析中的一个标准设置，特别是关于高阶无振荡格式。所有术语（DG、SSPRK、Lax-Friedrichs 通量、斜率限制器、TVD 性质）都是该领域的标准概念。问题是自洽的，没有矛盾或歧义。\n\n**1.3. 结论与行动**\n问题**有效**。继续求解。\n\n### 第 2 步：推导时间步长限制\n\n问题的核心在于强稳定性保持 (SSP) 时间积分器的概念。一个 $m > 1$ 阶的 SSP 方法能保证在时间步长 $\\Delta t$ 下保持某个稳定性性质（在此情况下，是单元平均值的 TV 减小性质），条件是对于简单的前向欧拉 (FE) 方法，该性质在更小的时间步长 $\\Delta t_{\\text{FE}}$ 下成立。它们的关系由下式给出：\n$$\n\\Delta t \\le C_{\\mathrm{SSP}} \\Delta t_{\\mathrm{FE}}\n$$\n其中 $C_{\\mathrm{SSP}}$ 是龙格－库塔方法的 SSP 系数。因此，我们的任务有两个：\n1.  确定 SSPRK$(3,3)$ 方法的 SSP 系数 $C_{\\mathrm{SSP}}$。\n2.  推导前向欧拉步为全变差递减 (TVD) 的精确时间步长限制 $\\Delta t_{\\text{FE}}(p)$。\n\n**2.1. SSPRK(3,3) 的 SSP 系数**\n\nSSPRK$(3,3)$ 方法由以下公式给出：\n$$\nu^{(1)} = u^n + \\Delta t \\mathcal{L}(u^n) \\\\\nu^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4} u^{(1)} + \\frac{1}{4} \\Delta t \\mathcal{L}(u^{(1)}) \\\\\nu^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3} u^{(2)} + \\frac{2}{3} \\Delta t \\mathcal{L}(u^{(2)})\n$$\n其中 $\\mathcal{L}$ 是来自 DG 离散化的空间算子。问题陈述限制器 $\\Lambda$ 在每个阶段后应用，因此 $\\mathcal{L}(u^{(k)})$ 应解释为 $\\mathcal{L}(\\Lambda(u^{(k)}))$。该方法可以写成类前向欧拉步的凸组合。根据其构造，如果前向欧拉步 $\\bar{u}' = \\bar{u} + \\Delta t \\mathcal{L}_h(\\tilde{u})$ 在 $\\Delta t \\le \\Delta t_{\\text{FE}}$ 时是 TVD 的，那么 SSPRK$(3,3)$ 方法在 $\\Delta t \\le C_{\\text{SSP}}\\Delta t_{\\text{FE}}$ 时是 TVD 的。对于指定的 SSPRK$(3,3)$ 方法，最优 SSP 系数是一个众所周知的结果：\n$$\nC_{\\mathrm{SSP}} = 1\n$$\n\n**2.2. 前向欧拉时间步长限制, $\\Delta t_{\\mathrm{FE}}(p)$**\n\n我们现在需要找到 $\\Delta t$ 需满足的条件，以使单步前向欧拉能保持单元平均值的 TVD 性质。单元 $I_i = [x_{i-1/2}, x_{i+1/2}]$ 中单元平均值 $\\bar{u}_i$ 的 DG 半离散化是通过将 PDE 对测试函数 $v=1$ 积分得到的：\n$$\n\\int_{I_i} u_t \\, dx + \\int_{I_i} \\left(\\frac{u^2}{2}\\right)_x \\, dx = 0 \\\\\n\\frac{d}{dt} \\left(h \\bar{u}_i\\right) + \\left[ \\hat{f}(u^-, u^+) \\right]_{x_{i-1/2}}^{x_{i+1/2}} = 0\n$$\n其中 $\\hat{f}(u^-, u^+)$ 是用左侧 ($u^-$) 和右侧 ($u^+$) 的 DG 多项式边界值计算的数值通量。这给出了单元平均值的精确演化：\n$$\n\\frac{d\\bar{u}_i}{dt} = -\\frac{1}{h} \\left( \\hat{f}(u_i^+, u_{i+1}^-) - \\hat{f}(u_{i-1}^+, u_i^-) \\right)\n$$\n其中 $u_j^+ = u_h(x_{j+1/2}^-)$ 和 $u_j^- = u_h(x_{j-1/2}^+)$ 是单元 $j$ 中解的边界值。在计算通量之前，应用了限制器，因此我们使用限制后的多项式值 $\\tilde{u}_j^\\pm$。\n一个前向欧拉步给出：\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\frac{\\Delta t}{h} \\left( \\hat{f}(\\tilde{u}_i^{n,+}, \\tilde{u}_{i+1}^{n,-}) - \\hat{f}(\\tilde{u}_{i-1}^{n,+}, \\tilde{u}_i^{n,-}) \\right)\n$$\n为使此格式是 TVD 的，更新必须满足局部单调性，这通常通过确保时间步长 $\\Delta t$ 足够小来强制执行。$p>0$ 次多项式的存在引入了一种“刚性”，比一阶 ($p=0$) 格式的要求更严格。\n\n- **$p=0$ 的情况**：每个单元中的 DG 解是常数，$u_i(x) = \\bar{u}_i$。限制器没有效果。更新变为一阶有限体积格式：\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\frac{\\Delta t}{h} \\left( \\hat{f}(\\bar{u}_i^n, \\bar{u}_{i+1}^n) - \\hat{f}(\\bar{u}_{i-1}^n, \\bar{u}_i^n) \\right)\n$$\n对于给定的 Lax-Friedrichs 通量（当 $\\alpha \\ge \\sup|u|$ 时为单调通量），此格式在 Courant-Friedrichs-Lewy (CFL) 条件下是 TVD 的：\n$$\n\\frac{\\Delta t}{h} \\alpha \\le 1 \\quad \\implies \\quad \\Delta t_{\\text{FE}}(0) = \\frac{h}{\\alpha}\n$$\n\n- **$p>0$ 的情况**：对于更高次的多项式，交界面值 $\\tilde{u}_i^\\pm$ 不再仅仅是单元平均值 $\\bar{u}_i$。必须考虑单元内多项式的变化。严谨的推导涉及对 DG 空间算子范数进行定界。该算子的范数决定了最大变化率，从而决定了稳定性约束，已知其与多项式次数成比例。对于使用单调通量的 DG 方法求解最大特征速度为 $\\alpha$ 的双曲问题，空间算子范数由一个与 $\\frac{\\alpha(2p+1)}{h}$ 成正比的项所界定。这导致前向欧拉步成为 TVD 的精确时间步长限制：\n$$\n\\Delta t \\le \\frac{h}{\\alpha(2p+1)}\n$$\n这个结果源于对 DG 算子性质的详细分析以及多项式反演不等式对稳定性的影响。对于具有迎风类或单调通量的 DG 方法，因子 $(2p+1)$ 是一个公认的结果。\n\n因此，前向欧拉时间步长界为：\n$$\n\\Delta t_{\\mathrm{FE}}(p) = \\frac{h}{\\alpha(2p+1)}\n$$\n\n**2.3. 最终条件**\n\n综合这些结果，使用指定限制器的 SSPRK$(3,3)$ 方法对单元平均值是 TVD 的条件是：\n$$\n\\Delta t \\le C_{\\mathrm{SSP}} \\Delta t_{\\mathrm{FE}}(p) = 1 \\cdot \\frac{h}{\\alpha(2p+1)}\n$$\n问题将要使用的时间步长定义为 $\\Delta t = \\kappa \\, \\Delta t_{\\mathrm{FE}}(p,h,\\alpha)$。为满足 TVD 条件，我们必须有：\n$$\n\\kappa \\, \\Delta t_{\\mathrm{FE}}(p,h,\\alpha) \\le \\frac{h}{\\alpha(2p+1)}\n$$\n代入 $\\Delta t_{\\mathrm{FE}}$ 的公式：\n$$\n\\kappa \\left(\\frac{h}{\\alpha(2p+1)}\\right) \\le \\frac{h}{\\alpha(2p+1)}\n$$\n由于 $h, \\alpha > 0$，这简化为关于 $\\kappa$ 的一个条件：\n$$\n\\kappa \\le 1\n$$\n这为检查每个测试用例提供了一个简单的标准。\n\n### 第 3 步：实现\n\n程序将为每个测试用例 $(p,h,\\alpha,\\kappa)$ 计算 $\\Delta t_{\\mathrm{FE}}(p,h,\\alpha) = \\frac{h}{\\alpha(2p+1)}$，然后通过检查 $\\kappa \\le 1$ 来确定布尔值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of determining the TVD stability of a DG scheme with an\n    SSPRK(3,3) time integrator for several test cases.\n    \"\"\"\n\n    # Test suite from the problem statement.\n    # Each case is a tuple (p, h, alpha, kappa).\n    test_cases = [\n        (0, 1/100, 1.0, 0.99),    # Case A\n        (1, 1/64, 1.0, 1.0),      # Case B\n        (2, 1/50, 1.0, 1.01),     # Case C\n        (3, 1/80, 0.8, 0.999),    # Case D\n        (0, 1/20, 2.0, 1.5),      # Case E\n        (4, 1/120, 1.0, 1.0),     # Case F\n    ]\n\n    results = []\n    \n    # The Strong Stability Preserving (SSP) coefficient for the SSPRK(3,3) method is 1.\n    # The time step dt = kappa * dt_fe must satisfy dt = C_ssp * dt_fe,\n    # where C_ssp = 1. This simplifies to kappa = 1.0.\n\n    for case in test_cases:\n        p, h, alpha, kappa = case\n\n        # 1. Compute the forward Euler sharp bound dt_fe(p, h, alpha).\n        # The formula derived is dt_fe = h / (alpha * (2p + 1)).\n        denominator = alpha * (2.0 * p + 1.0)\n        if denominator == 0:\n            dt_fe = float('inf')\n        else:\n            dt_fe = h / denominator\n\n        # 2. Determine if the given time step guarantees TVD property.\n        # The derived condition is that kappa must be less than or equal to the\n        # SSP coefficient of SSPRK(3,3), which is 1.\n        is_stable = (kappa = 1.0)\n\n        results.append(dt_fe)\n        results.append(is_stable)\n\n    # Format the output as a single-line Python-style list representation.\n    formatted_results = []\n    for item in results:\n        if isinstance(item, bool):\n            formatted_results.append(str(item))\n        else:\n            formatted_results.append(f\"{item}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}