{
    "hands_on_practices": [
        {
            "introduction": "斜率限制器的一个核心目标是确保数值格式在捕捉激波时保持稳定性。总变差不增（Total Variation Diminishing, TVD）准则是衡量这种稳定性的经典理论基石。本练习将深入探讨一个广泛使用的限制器——单调中心（Monotonized Central, MC）限制器，要求你从有限体积法的更新格式出发，证明该限制器如何确保TVD性质，从而将抽象的稳定性理论与限制器的具体数学形式联系起来。",
            "id": "3414647",
            "problem": "考虑标量线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数，网格是均匀的，单元中心为 $x_{i}$，单元宽度为 $\\Delta x$。令 $u_{i}$ 表示 $u$ 在第 $i$ 个单元上的单元平均值。在单元 $i$ 内的二阶精度分段线性重构由 $u_{i}(x) = u_{i} + \\sigma_{i}\\,\\frac{x - x_{i}}{\\Delta x}$ 给出，其中 $\\sigma_{i}$ 是一个待确定的受限斜率。从单元 $i$ 重构的左右界面状态分别为 $u_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\sigma_{i}$ 和 $u_{i-1/2}^{+} = u_{i} - \\frac{1}{2}\\sigma_{i}$。对于迎风数值通量 $F(u) = a\\,u$（适用于 $a>0$），前向欧拉有限体积更新为\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\big(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\big), \\quad \\lambda = \\frac{\\Delta t}{\\Delta x}, \\quad F_{i+1/2}^{n} = a\\,u_{i+1/2}^{-,n},\n$$\n其中 $u_{i+1/2}^{-,n} = u_{i}^{n} + \\frac{1}{2}\\sigma_{i}^{n}$，$u_{i-1/2}^{-,n}$ 的情况类似。定义单边差分\n$$\nD_{i}^{-} = u_{i} - u_{i-1}, \\qquad D_{i}^{+} = u_{i+1} - u_{i}.\n$$\n如果一个斜率限制器产生的更新 $u_{i}^{n} \\mapsto u_{i}^{n+1}$ 使得离散全变分\n$$\n\\operatorname{TV}(u^{n}) = \\sum_{i} \\big|u_{i+1}^{n} - u_{i}^{n}\\big|\n$$\n不增加，即 $\\operatorname{TV}(u^{n+1}) \\le \\operatorname{TV}(u^{n})$，这在关于 $\\lambda a$ 的 Courant–Friedrichs–Lewy (CFL) 条件下成立，则称该斜率限制器是全变分递减 (Total Variation Diminishing, TVD) 的。单调中心 (Monotonized Central, MC) 限制器旨在通过对 $\\sigma_{i}$ 强制执行以下可容许条件来维持 TVD 性质：\n1. 如果 $D_{i}^{-} D_{i}^{+} \\le 0$，则 $\\sigma_{i} = 0$。\n2. 如果 $D_{i}^{-} D_{i}^{+} > 0$，则 $\\sigma_{i}$ 的符号与 $D_{i}^{-}$ 和 $D_{i}^{+}$ 相同，且其大小受限于\n$$\n|\\sigma_{i}| \\le \\min\\!\\left\\{\\, 2|D_{i}^{-}|,\\, 2|D_{i}^{+}|,\\, \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right| \\right\\}.\n$$\n从上述有限体积更新和迎风通量的定义出发，使用可容许条件证明，在 $0  \\lambda a \\le 1$ 的条件下，使用 MC 限制器构造的格式是 TVD 的。然后，为 MC 限制器计算受限斜率 $\\sigma_{i}$ 的显式闭合形式表达式，用 $D_{i}^{-}$ 和 $D_{i}^{+}$ 表示。你的最终答案必须是单一的闭合形式解析表达式。不需要数值近似或四舍五入。",
            "solution": "我们从标量线性平流方程 $u_{t} + a\\,u_{x} = 0$ 及其采用分段线性重构的有限体积离散化开始。对于 $a>0$，迎风通量为 $F(u) = a\\,u$，因此数值界面通量在每个界面处取左侧状态：\n$$\nF_{i+1/2}^{n} = a\\,u_{i+1/2}^{-,n} = a\\left(u_{i}^{n} + \\frac{1}{2}\\sigma_{i}^{n}\\right), \\qquad F_{i-1/2}^{n} = a\\,u_{i-1/2}^{-,n} = a\\left(u_{i-1}^{n} + \\frac{1}{2}\\sigma_{i-1}^{n}\\right).\n$$\n因此，前向欧拉更新为\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda a \\left[\\left(u_{i}^{n} + \\frac{1}{2}\\sigma_{i}^{n}\\right) - \\left(u_{i-1}^{n} + \\frac{1}{2}\\sigma_{i-1}^{n}\\right)\\right] = (1 - \\lambda a)\\,u_{i}^{n} + \\lambda a\\,u_{i-1}^{n} - \\frac{\\lambda a}{2}\\left(\\sigma_{i}^{n} - \\sigma_{i-1}^{n}\\right).\n$$\n定义离散全变分 $\\operatorname{TV}(u^{n}) = \\sum_{i} |u_{i+1}^{n} - u_{i}^{n}|$。为了证明该格式是全变分递减 (TVD) 的，只需证明在 $0  \\lambda a \\le 1$ 的条件下，更新是单调的并且不产生新的极值。一个经典的充分条件是利用相邻单元平均值对重构界面值的有界性。我们分析界面重构：\n$$\nu_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\sigma_{i}, \\qquad u_{i-1/2}^{-} = u_{i-1} + \\frac{1}{2}\\sigma_{i-1}.\n$$\nMC 限制器强制执行以下可容许条件：\n1. 如果 $D_{i}^{-} D_{i}^{+} \\le 0$，则设 $\\sigma_{i} = 0$。那么 $u_{i+1/2}^{-} = u_{i}$，这显然被界定在 $u_{i}$ 和 $u_{i+1}$ 之间。类似地，$u_{i-1/2}^{-} = u_{i-1}$ 被界定在 $u_{i-1}$ 和 $u_{i}$ 之间。\n2. 如果 $D_{i}^{-} D_{i}^{+} > 0$，$\\sigma_{i}$ 的符号一致性以及大小限制\n$$\n|\\sigma_{i}| \\le \\min\\!\\left\\{\\, 2|D_{i}^{-}|,\\, 2|D_{i}^{+}|,\\, \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right| \\right\\}\n$$\n意味着界面值位于相邻单元平均值之间。为了看到这一点，假设 $D_{i}^{+} > 0$（对于 $D_{i}^{+}  0$ 的论证是类似的）。那么 $u_{i+1} = u_{i} + D_{i}^{+}$，并且 $|\\sigma_{i}| \\le 2|D_{i}^{+}|$ 的界限与 $\\sigma_{i}$ 的符号一起得出\n$$\nu_{i+1/2}^{-} = u_{i} + \\frac{1}{2}\\sigma_{i} \\le u_{i} + \\frac{1}{2}\\cdot 2 D_{i}^{+} = u_{i+1}.\n$$\n类似地，如果 $D_{i}^{-} > 0$，则 $u_{i} = u_{i-1} + D_{i}^{-}$ 且 $|\\sigma_{i}| \\le 2|D_{i}^{-}|$ 保证\n$$\nu_{i-1/2}^{+} = u_{i} - \\frac{1}{2}\\sigma_{i} \\ge u_{i} - D_{i}^{-} = u_{i-1}.\n$$\n当 $D_{i}^{-} D_{i}^{+} > 0$ 时，额外的界限 $|\\sigma_{i}| \\le \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right|$ 控制中心斜率，以防止即使在单边差分高度不平衡时出现过度陡峭，确保 $u_{i+1/2}^{-}$ 和 $u_{i-1/2}^{+}$ 都保持在它们各自的邻近区间内：\n$$\n\\min\\{u_{i}, u_{i+1}\\} \\le u_{i+1/2}^{-} \\le \\max\\{u_{i}, u_{i+1}\\}, \\qquad \\min\\{u_{i-1}, u_{i}\\} \\le u_{i-1/2}^{+} \\le \\max\\{u_{i-1}, u_{i}\\}.\n$$\n因此，对所有 $i$，重构的界面状态都被相邻的单元平均值所界定。对于迎风通量 $F(u) = a\\,u$（对于 $a>0$ 是单调非减的）和前向欧拉更新（$0  \\lambda a \\le 1$），这种有界性意味着该格式在离散极值原理的意义上是单调的：不产生新的局部极值，并且界面通量在邻近值范围内插值。根据经典的 Harten–Crandall–Tartar 关于单调格式的 TVD 框架，离散全变分不增加，即 $\\operatorname{TV}(u^{n+1}) \\le \\operatorname{TV}(u^{n})$。因此，在 $0  \\lambda a \\le 1$ 的条件下，带有 MC 限制器的格式是 TVD 的。\n\n我们现在用单边差分 $D_{i}^{-}$ 和 $D_{i}^{+}$ 来计算显式的受限斜率 $\\sigma_{i}$。引入带多个参数的 minmod 函数，\n$$\n\\operatorname{minmod}(a_{1}, a_{2}, \\dots, a_{m}) = \n\\begin{cases}\n\\operatorname{sign}(a_{1}) \\min\\limits_{1 \\le j \\le m} |a_{j}|,  \\text{if } \\operatorname{sign}(a_{1}) = \\operatorname{sign}(a_{2}) = \\cdots = \\operatorname{sign}(a_{m}) \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\nMC 的可容许性要求可以通过选择 $\\sigma_{i}$ 为三个候选斜率的 minmod 来紧凑地实施：一个中心斜率和两倍的单边斜率，所有这些都在均匀网格上进行了一致的缩放。使用 $D_{i}^{-}$ 和 $D_{i}^{+}$，中心斜率为 $\\frac{D_{i}^{-} + D_{i}^{+}}{2}$，而缩放后的单边斜率为 $2D_{i}^{-}$ 和 $2D_{i}^{+}$。因此，MC 受限斜率的闭合形式表达式为\n$$\n\\sigma_{i} = \\operatorname{minmod}\\!\\left( \\frac{D_{i}^{-} + D_{i}^{+}}{2},\\, 2 D_{i}^{-},\\, 2 D_{i}^{+} \\right).\n$$\n该表达式满足 MC 限制器所要求的符号一致性和大小界限。如果 $D_{i}^{-} D_{i}^{+} \\le 0$，则参数的符号不同，$\\sigma_{i} = 0$。如果 $D_{i}^{-} D_{i}^{+} > 0$，所有参数共享相同的符号，$\\sigma_{i}$ 取三者中最小的大小，从而强制\n$$\n|\\sigma_{i}| \\le \\min\\!\\left\\{\\, \\left|\\frac{D_{i}^{-} + D_{i}^{+}}{2}\\right|,\\, 2|D_{i}^{-}|,\\, 2|D_{i}^{+}| \\right\\}.\n$$\n因此，已经推导出了用单边差分表示的显式 MC 受限斜率，并且在 $0  \\lambda a \\le 1$ 条件下的 TVD 性质也已确立。",
            "answer": "$$\\boxed{\\operatorname{minmod}\\!\\left(\\frac{D_{i}^{-} + D_{i}^{+}}{2},\\, 2 D_{i}^{-},\\, 2 D_{i}^{+}\\right)}$$"
        },
        {
            "introduction": "与在单元平均值上操作的有限体积法不同，间断Galerkin（DG）方法在每个单元内使用多项式来表示解。这使得我们可以在谱空间或模态空间中设计限制器，通过调整多项式的模态系数来控制振荡。本练习将探讨一种分层模态限制器的具体操作，要求你分析当限制最高阶模态系数时，解在节点上的值会如何变化，并验证此过程为何能保持单元平均值不变——这是守恒格式的一个关键要求。",
            "id": "3414617",
            "problem": "考虑一个由间断伽辽金 (DG) 方法离散的一维标量守恒律，其中，在一个映射到参考区间 $[-1,1]$ 的单元中的局部表示，使用模态勒让德基下的一个次数为3的多项式。设解表示为 $u(x) = \\sum_{k=0}^{3} a_k L_k(x)$，其中 $L_k(x)$ 是 $[-1,1]$ 上的标准勒让德多项式。为了以最小的伪振荡捕捉激波，一个分层斜率限制器仅缩放最高阶的模态系数，用 $\\lambda a_3$ 替换 $a_3$（其中限制器因子 $\\lambda \\in [0,1]$），同时保持 $a_0$、$a_1$ 和 $a_2$ 不变。对于次数为3的多项式，在 $[-1,1]$ 上的高斯-罗巴托插值点为 $x=-1$、$x=-1/\\sqrt{5}$、$x=1/\\sqrt{5}$ 和 $x=1$。\n\n从勒让德多项式的基本性质及其关于 $L^2([-1,1])$ 内积的正交性出发，推导在限制 $k=3$ 模态后，解 $u(x)$ 在四个高斯-罗巴托点上的节点值，并从第一性原理验证该限制器保持单元平均值。将你的最终答案表示为一个单行矩阵，其中按顺序包含四个节点值和限制后的单元平均值，并以 $a_0$、$a_1$、$a_2$、$a_3$ 和 $\\lambda$ 的精确符号形式表示。",
            "solution": "目标是在 DG 框架内，分析分层斜率限制器对多项式解表示的影响。给定一个单元中的解 $u(x)$，在参考区间 $[-1, 1]$ 上表示为一个以模态勒让德基表达的3次多项式：\n$$\nu(x) = \\sum_{k=0}^{3} a_k L_k(x) = a_0 L_0(x) + a_1 L_1(x) + a_2 L_2(x) + a_3 L_3(x)\n$$\n其中 $L_k(x)$ 是标准勒让德多项式，$a_k$ 是模态系数。\n\n分层限制器通过一个因子 $\\lambda \\in [0,1]$ 仅缩放最高阶系数 $a_3$。因此，限制后的解（我们记作 $u_{lim}(x)$）为：\n$$\nu_{lim}(x) = a_0 L_0(x) + a_1 L_1(x) + a_2 L_2(x) + (\\lambda a_3) L_3(x)\n$$\n我们需要执行两个任务：\n1. 从第一性原理验证该限制器保持解的单元平均值。\n2. 推导限制后的解 $u_{lim}(x)$ 在四个指定的高斯-罗巴托点上的节点值。\n\n首先，我们验证单元平均值的保持。在参考区间 $[-1, 1]$ 上，函数 $f(x)$ 的单元平均值定义为：\n$$\n\\bar{f} = \\frac{1}{1 - (-1)} \\int_{-1}^{1} f(x) \\, dx = \\frac{1}{2} \\int_{-1}^{1} f(x) \\, dx\n$$\n勒让德多项式 $L_k(x)$ 关于 $L^2([-1,1])$ 内积是正交的，该内积定义为 $\\langle f, g \\rangle = \\int_{-1}^{1} f(x)g(x) \\, dx$。其正交关系为：\n$$\n\\int_{-1}^{1} L_k(x) L_j(x) \\, dx = \\frac{2}{2k+1} \\delta_{kj}\n$$\n其中 $\\delta_{kj}$ 是克罗内克 δ。\n\n第一个勒让德多项式是 $L_0(x) = 1$。限制后的解 $u_{lim}(x)$ 的单元平均值为：\n$$\n\\bar{u}_{lim} = \\frac{1}{2} \\int_{-1}^{1} u_{lim}(x) \\, dx = \\frac{1}{2} \\int_{-1}^{1} \\left( a_0 L_0(x) + a_1 L_1(x) + a_2 L_2(x) + \\lambda a_3 L_3(x) \\right) dx\n$$\n根据积分的线性性质，我们可以将其写为：\n$$\n\\bar{u}_{lim} = \\frac{1}{2} \\left( a_0 \\int_{-1}^{1} L_0(x) \\, dx + a_1 \\int_{-1}^{1} L_1(x) \\, dx + a_2 \\int_{-1}^{1} L_2(x) \\, dx + \\lambda a_3 \\int_{-1}^{1} L_3(x) \\, dx \\right)\n$$\n我们可以通过注意到 $\\int_{-1}^{1} L_k(x) \\, dx = \\int_{-1}^{1} L_k(x) L_0(x) \\, dx$ 来利用正交性质表示每个积分。根据正交关系，该积分仅在 $k=0$ 时非零：\n$$\n\\int_{-1}^{1} L_k(x) L_0(x) \\, dx = \\frac{2}{2(0)+1} \\delta_{k0} = 2 \\delta_{k0}\n$$\n因此，$L_1(x)$、$L_2(x)$ 和 $L_3(x)$ 的积分都为零。单元平均值的表达式简化为：\n$$\n\\bar{u}_{lim} = \\frac{1}{2} \\left( a_0 (2\\delta_{00}) + a_1 (2\\delta_{10}) + a_2 (2\\delta_{20}) + \\lambda a_3 (2\\delta_{30}) \\right) = \\frac{1}{2} (a_0 \\cdot 2) = a_0\n$$\n原始未限制解 $\\bar{u}$ 的单元平均值也是 $a_0$。因此，$\\bar{u}_{lim} = \\bar{u} = a_0$。单元平均值得以保持，并等于第一个模态系数 $a_0$。这个基本性质是使用正交基（其中第一个基函数是常数）的直接结果。\n\n接下来，我们推导 $u_{lim}(x)$ 在指定的高斯-罗巴托点 $x = -1$、$x = -1/\\sqrt{5}$、$x = 1/\\sqrt{5}$ 和 $x=1$ 上的节点值。为此，我们需要前四个勒让德多项式的表达式：\n$L_0(x) = 1$\n$L_1(x) = x$\n$L_2(x) = \\frac{1}{2}(3x^2 - 1)$\n$L_3(x) = \\frac{1}{2}(5x^3 - 3x)$\n\n我们在四个点上对这些多项式进行求值：\n\n1. 在 $x = -1$ 处：\n$L_0(-1) = 1$\n$L_1(-1) = -1$\n$L_2(-1) = \\frac{1}{2}(3(-1)^2 - 1) = 1$\n$L_3(-1) = \\frac{1}{2}(5(-1)^3 - 3(-1)) = -1$\n\n2. 在 $x = -1/\\sqrt{5}$ 处：\n$L_0(-1/\\sqrt{5}) = 1$\n$L_1(-1/\\sqrt{5}) = -1/\\sqrt{5}$\n$L_2(-1/\\sqrt{5}) = \\frac{1}{2}(3(-1/\\sqrt{5})^2 - 1) = \\frac{1}{2}(\\frac{3}{5} - 1) = -\\frac{1}{5}$\n$L_3(-1/\\sqrt{5}) = \\frac{1}{2}(5(-1/\\sqrt{5})^3 - 3(-1/\\sqrt{5})) = \\frac{1}{2}(-\\frac{5}{5\\sqrt{5}} + \\frac{3}{\\sqrt{5}}) = \\frac{1}{2}(\\frac{2}{\\sqrt{5}}) = \\frac{1}{\\sqrt{5}}$\n\n3. 在 $x = 1/\\sqrt{5}$ 处：\n$L_0(1/\\sqrt{5}) = 1$\n$L_1(1/\\sqrt{5}) = 1/\\sqrt{5}$\n$L_2(1/\\sqrt{5}) = \\frac{1}{2}(3(1/\\sqrt{5})^2 - 1) = \\frac{1}{2}(\\frac{3}{5} - 1) = -\\frac{1}{5}$\n$L_3(1/\\sqrt{5}) = \\frac{1}{2}(5(1/\\sqrt{5})^3 - 3(1/\\sqrt{5})) = \\frac{1}{2}(\\frac{5}{5\\sqrt{5}} - \\frac{3}{\\sqrt{5}}) = \\frac{1}{2}(-\\frac{2}{\\sqrt{5}}) = -\\frac{1}{\\sqrt{5}}$\n\n4. 在 $x = 1$ 处：\n$L_0(1) = 1$\n$L_1(1) = 1$\n$L_2(1) = \\frac{1}{2}(3(1)^2 - 1) = 1$\n$L_3(1) = \\frac{1}{2}(5(1)^3 - 3(1)) = 1$\n\n现在，我们将这些值代入 $u_{lim}(x)$ 的表达式中，以求出节点值。\n\n在 $x=-1$ 处的节点值：\n$u_{lim}(-1) = a_0 L_0(-1) + a_1 L_1(-1) + a_2 L_2(-1) + \\lambda a_3 L_3(-1)$\n$u_{lim}(-1) = a_0(1) + a_1(-1) + a_2(1) + \\lambda a_3(-1) = a_0 - a_1 + a_2 - \\lambda a_3$\n\n在 $x=-1/\\sqrt{5}$ 处的节点值：\n$u_{lim}(-1/\\sqrt{5}) = a_0 L_0(-1/\\sqrt{5}) + a_1 L_1(-1/\\sqrt{5}) + a_2 L_2(-1/\\sqrt{5}) + \\lambda a_3 L_3(-1/\\sqrt{5})$\n$u_{lim}(-1/\\sqrt{5}) = a_0(1) + a_1(-1/\\sqrt{5}) + a_2(-1/5) + \\lambda a_3(1/\\sqrt{5}) = a_0 - \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} + \\frac{\\lambda a_3}{\\sqrt{5}}$\n\n在 $x=1/\\sqrt{5}$ 处的节点值：\n$u_{lim}(1/\\sqrt{5}) = a_0 L_0(1/\\sqrt{5}) + a_1 L_1(1/\\sqrt{5}) + a_2 L_2(1/\\sqrt{5}) + \\lambda a_3 L_3(1/\\sqrt{5})$\n$u_{lim}(1/\\sqrt{5}) = a_0(1) + a_1(1/\\sqrt{5}) + a_2(-1/5) + \\lambda a_3(-1/\\sqrt{5}) = a_0 + \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} - \\frac{\\lambda a_3}{\\sqrt{5}}$\n\n在 $x=1$ 处的节点值：\n$u_{lim}(1) = a_0 L_0(1) + a_1 L_1(1) + a_2 L_2(1) + \\lambda a_3 L_3(1)$\n$u_{lim}(1) = a_0(1) + a_1(1) + a_2(1) + \\lambda a_3(1) = a_0 + a_1 + a_2 + \\lambda a_3$\n\n最终结果是这四个节点值和守恒的单元平均值 $a_0$ 的集合。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\na_0 - a_1 + a_2 - \\lambda a_3  a_0 - \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} + \\frac{\\lambda a_3}{\\sqrt{5}}  a_0 + \\frac{a_1}{\\sqrt{5}} - \\frac{a_2}{5} - \\frac{\\lambda a_3}{\\sqrt{5}}  a_0 + a_1 + a_2 + \\lambda a_3  a_0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个设计良好的高阶数值格式必须能够精确地保持简单的物理状态，例如均匀流（即常数解），即便是在弯曲的网格上。这一性质被称为“均匀流保持”（free-stream preservation）。然而，在参考坐标系中简单地应用限制器可能会因几何映射的非线性而引入非物理的修正。本练习将引导你分析这一关键陷阱，通过计算揭示在一个弯曲单元上，限制器为何会被错误地激活并破坏一个完美的均匀流解，从而凸显几何相容性在限制器设计中的重要性。",
            "id": "3414596",
            "problem": "考虑一维线性平流守恒律 $\\partial_{t} u + a \\, \\partial_{x} u = 0$，其平流速度 $a$ 为常数。该方程在一个弯曲的等参单元上通过1次间断Galerkin (DG) 方法进行离散。物理坐标 $x$ 通过 $x(\\xi) = \\xi + \\alpha \\, \\xi^{2}$ 从参考坐标 $\\xi \\in [-1,1]$ 映射而来，其中 $\\alpha$ 是一个非零曲率参数，映射的雅可比为 $J(\\xi) = \\frac{dx}{d\\xi} = 1 + 2 \\alpha \\, \\xi$。假设精确物理-解为自由流 $u(x) \\equiv u_{0}$，其中 $u_{0} \\neq 0$ 为常数。在参考单元上的弱守恒形式中，由DG多项式表示的守恒变量为 $q(\\xi) = J(\\xi) \\, u(\\xi)$。\n\n一个全变差递减 (TVD) minmod型斜率限制器在参考坐标系中应用于守恒变量 $q(\\xi)$，使用1次多项式表示 $q(\\xi) = c_{0} + c_{1} \\, \\xi$。该限制器重构 $q^{L}(\\xi) = \\bar{q} + s^{L} \\, \\xi$，其中 $\\bar{q}$ 是由 $\\bar{q} = \\frac{1}{2} \\int_{-1}^{1} q(\\xi) \\, d\\xi$ 定义的参考单元平均值，限制前的斜率为 $s = c_{1}$，并且如果对于给定的阈值 $\\kappa \\in (0,1)$，有 $S = \\frac{|s|}{|\\bar{q}|}  \\kappa$，则激波传感器触发。当传感器触发时，限制器设置 $s^{L} = 0$（否则 $s^{L} = s$）。相反，一个物理上一致的限制器应该在物理坐标系中对 $u(\\xi)$ 而不是 $q(\\xi)$ 进行操作。\n\n从这些定义和映射出发，推导用 $\\alpha$ 和 $\\kappa$ 表示的激活条件，解释为什么在参考坐标系中对 $q(\\xi)$ 进行限制会在弯曲单元上使限制器产生偏差并破坏自由流保持特性，并计算当传感器触发且 $s^{L} = 0$ 时得到的受限物理-解 $u^{L}(\\xi)$。你的最终答案必须是使用给定的 $J(\\xi)$ 表示的 $u^{L}(\\xi)$ 的单一闭式解析表达式。不需要进行数值近似或舍入，也不需要报告单位。",
            "solution": "问题考虑了一个一维线性平流方程 $\\partial_{t} u + a \\, \\partial_{x} u = 0$，其精确解为自由流 $u(x) = u_{0}$，其中 $u_{0} \\neq 0$ 是一个常数。离散化是使用1次间断Galerkin (DG) 方法在单个弯曲单元上进行的。几何形状由从参考坐标 $\\xi \\in [-1,1]$ 到物理坐标 $x$ 的映射 $x(\\xi) = \\xi + \\alpha \\, \\xi^{2}$ 定义。此映射的雅可比为 $J(\\xi) = \\frac{dx}{d\\xi} = 1 + 2 \\alpha \\, \\xi$。\n\nDG方法对参考单元中守恒变量的多项式表示进行操作，该变量定义为 $q(\\xi) = J(\\xi) \\, u(\\xi)$。由于物理-解是常数 $u_{0}$，因此参考系中的相应解也是常数，$u(\\xi) = u_{0}$。\n因此，精确的守恒变量是：\n$$q(\\xi) = J(\\xi) u_{0} = (1 + 2 \\alpha \\, \\xi) u_{0} = u_{0} + 2 \\alpha u_{0} \\, \\xi$$\n这是一个关于 $\\xi$ 的线性多项式。\n\n该变量的1次DG表示形式为 $q(\\xi) = c_{0} + c_{1} \\, \\xi$。由于 $q(\\xi)$ 的精确表达式已经是一个1次多项式，DG表示是精确的，我们可以通过比较直接确定系数：\n$$c_{0} = u_{0}$$\n$$c_{1} = 2 \\alpha u_{0}$$\n\n一个minmod型斜率限制器被应用于此表示。限制器对参考单元平均值 $\\bar{q}$ 和限制前斜率 $s$ 进行操作。\n\n首先，我们计算参考单元平均值 $\\bar{q}$：\n$$\\bar{q} = \\frac{1}{2} \\int_{-1}^{1} q(\\xi) \\, d\\xi = \\frac{1}{2} \\int_{-1}^{1} (u_{0} + 2 \\alpha u_{0} \\, \\xi) \\, d\\xi$$\n$$\\bar{q} = \\frac{u_{0}}{2} \\left[ \\xi + \\alpha \\, \\xi^{2} \\right]_{-1}^{1} = \\frac{u_{0}}{2} \\left( (1 + \\alpha) - (-1 + \\alpha) \\right) = \\frac{u_{0}}{2} (2) = u_{0}$$\n或者，使用多项式系数，在对称区间 $[-1,1]$ 上 $c_{0} + c_{1} \\xi$ 的平均值就是 $c_{0}$。因此，$\\bar{q} = c_{0} = u_{0}$。\n\n限制前的斜率 $s$ 是线性项的系数，即 $s = c_{1}$。\n$$s = 2 \\alpha u_{0}$$\n\n激波传感器定义为 $S = \\frac{|s|}{|\\bar{q}|}$，并且如果对于给定的阈值 $\\kappa \\in (0,1)$，有 $S  \\kappa$，则传感器触发。我们可以代入计算出的 $s$ 和 $\\bar{q}$ 的值：\n$$S = \\frac{|2 \\alpha u_{0}|}{|u_{0}|} = 2 |\\alpha| \\frac{|u_{0}|}{|u_{0}|}$$\n由于 $u_{0} \\neq 0$，这可以简化为：\n$$S = 2 |\\alpha|$$\n因此，限制器的激活条件是 $S  \\kappa$，即：\n$$2 |\\alpha|  \\kappa$$\n\n这个条件揭示了为什么在参考坐标系中对 $q(\\xi)$ 进行限制可能是有问题的，并且会破坏自由流保持特性。物理-解 $u(x) = u_{0}$ 是一个常数，代表一个完全光滑的自由流。任何物理上一致的数值方法都应精确地保持此解而不做任何修改。然而，限制器应用于 $q(\\xi) = J(\\xi) u(\\xi)$。在弯曲单元上（$\\alpha \\neq 0$），雅可比 $J(\\xi)$ 不是常数。将常数物理-解 $u_{0}$ 乘以空间变化的雅可比 $J(\\xi)$，得到的守恒变量 $q(\\xi)$ 具有非零斜率 $s = 2 \\alpha u_{0}$。限制器将这个纯粹由单元曲率造成的斜率错误地解释为解本身的物理梯度或振荡。如果曲率足够大，使得 $2|\\alpha|  \\kappa$，限制器就会被虚假地激活。对一个完全光滑解的这种修改正是破坏自由流保持特性的定义。一个一致的限制器需要对物理变量 $u(\\xi)$ 进行操作，它会将其重构为 $u(\\xi) = q(\\xi) / J(\\xi) = (u_0 + 2\\alpha u_0 \\xi)/(1+2\\alpha\\xi) = u_0(1+2\\alpha\\xi)/(1+2\\alpha\\xi) = u_0$。这个重构的物理变量的斜率为零，所以一个物理上一致的限制器不会触发。\n\n最后，我们计算当传感器触发时得到的受限物理-解 $u^{L}(\\xi)$。根据问题陈述，当传感器触发时，限制器将新斜率设置为零，$s^{L} = 0$。受限的守恒变量随后被重构为：\n$$q^{L}(\\xi) = \\bar{q} + s^{L} \\, \\xi$$\n代入 $\\bar{q} = u_{0}$ 和 $s^{L} = 0$：\n$$q^{L}(\\xi) = u_{0} + (0) \\xi = u_{0}$$\n限制器有效地将守恒变量的表示展平为其单元平均值。\n\n为了找到受限的物理-解 $u^{L}(\\xi)$，我们必须通过除以雅可比从参考系中的守恒变量变换回来：\n$$u^{L}(\\xi) = \\frac{q^{L}(\\xi)}{J(\\xi)}$$\n代入 $q^{L}(\\xi) = u_{0}$ 和 $J(\\xi) = 1 + 2 \\alpha \\, \\xi$：\n$$u^{L}(\\xi) = \\frac{u_{0}}{1 + 2 \\alpha \\, \\xi}$$\n这是虚假的限制器作用后单元内部物理-解的最终表达式。它不再是常数，这表明了限制器引入的误差。",
            "answer": "$$\\boxed{\\frac{u_{0}}{1 + 2 \\alpha \\, \\xi}}$$"
        }
    ]
}