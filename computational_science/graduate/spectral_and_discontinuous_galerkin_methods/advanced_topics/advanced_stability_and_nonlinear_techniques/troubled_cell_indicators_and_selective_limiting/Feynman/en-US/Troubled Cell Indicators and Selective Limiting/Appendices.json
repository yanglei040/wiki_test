{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of modern high-order methods is the ability to detect non-smooth features in a solution, and spectral decay indicators are a powerful tool for this task. These indicators operate on the principle that the modal coefficients of a smooth function decay rapidly, while those of a non-smooth function decay slowly. This practice problem provides a rigorous analytical dive into this concept, asking you to derive the asymptotic behavior of a Persson–Peraire type indicator for a function representing a smooth but steep internal layer, thereby revealing precisely how the indicator's value relates to the resolution of a feature on the computational grid .",
            "id": "3425756",
            "problem": "Consider a one-dimensional Discontinuous Galerkin (DG) element $K=[-h/2,h/2]$ centered at $x=0$, using a polynomial approximation of degree $p=3$ in a Legendre polynomial modal basis. Map $K$ to the reference interval via $x=(h/2)\\,\\xi$ with $\\xi\\in[-1,1]$. Let the exact solution on $K$ be the smooth internal layer\n$$\nu(x)=\\tanh(\\alpha x),\n$$\nand denote $\\beta=\\alpha h/2$. Let $\\{P_n(\\xi)\\}_{n=0}^{3}$ be the Legendre polynomials on $[-1,1]$. Define the modal coefficients of the $L^2$-projection of $u$ onto $\\mathrm{span}\\{P_0,P_1,P_2,P_3\\}$ by\n$$\na_n=\\frac{2n+1}{2}\\int_{-1}^{1} u\\big((h/2)\\,\\xi\\big)\\,P_n(\\xi)\\,d\\xi,\\quad n=0,1,2,3.\n$$\nAdopt a Persson–Peraire-type spectral decay indicator with selective activation that is robust to parity by aggregating the top two modes:\n$$\ns_K=\\ln\\!\\left(\\frac{a_2^2+a_3^2}{a_0^2+a_1^2+a_2^2+a_3^2}\\right).\n$$\nIn a selective limiting strategy, limiting on $K$ is activated if and only if $s_K > \\ln(\\varepsilon)$ for a prescribed tolerance $\\varepsilon$.\n\nUsing only the orthogonality of Legendre polynomials, known analytic properties of $\\tanh$, and asymptotic expansions valid for small and large $\\beta$, do the following:\n\n1. Derive the small-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order.\n2. Derive the large-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order by relating $\\tanh(\\beta\\xi)$ to its pointwise limit as $\\beta\\to\\infty$ and projecting onto the same modal basis.\n3. Using the small-$\\beta$ asymptotics, determine the leading-order critical value $(\\alpha h)_c$ such that $s_K(\\beta)$ crosses the activation threshold $s_K=\\ln(\\varepsilon)$, i.e., limiting is activated for $\\alpha h>(\\alpha h)_c$ and not activated for $\\alpha h<(\\alpha h)_c$.\n\nAssume the threshold parameter is $\\varepsilon=10^{-4}$. Your final answer must be a single closed-form analytic expression for $(\\alpha h)_c$ with no units. Do not round; provide the exact expression.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Discontinuous Galerkin (DG) Element:** $K = [-h/2, h/2]$, centered at $x=0$.\n- **Polynomial Approximation Degree:** $p=3$.\n- **Basis:** Legendre polynomial modal basis on $[-1, 1]$, $\\{P_n(\\xi)\\}_{n=0}^{3}$.\n- **Mapping to Reference Interval:** $x = (h/2)\\xi$ for $\\xi \\in [-1, 1]$.\n- **Exact Solution:** $u(x) = \\tanh(\\alpha x)$.\n- **Parameter:** $\\beta = \\alpha h / 2$.\n- **Modal Coefficients:** $a_n = \\frac{2n+1}{2} \\int_{-1}^{1} u((h/2)\\xi) P_n(\\xi) d\\xi$, for $n=0, 1, 2, 3$.\n- **Spectral Decay Indicator:** $s_K = \\ln\\left(\\frac{a_2^2 + a_3^2}{a_0^2 + a_1^2 + a_2^2 + a_3^2}\\right)$.\n- **Limiting Activation Condition:** $s_K > \\ln(\\varepsilon)$.\n- **Threshold Parameter:** $\\varepsilon = 10^{-4}$.\n- **Tasks:**\n    1. Derive the small-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order.\n    2. Derive the large-$\\beta$ asymptotics of $s_K(\\beta)$ to leading order.\n    3. Determine the leading-order critical value $(\\alpha h)_c$ using the small-$\\beta$ result.\n- **Constraints:** Use only orthogonality of Legendre polynomials, analytic properties of $\\tanh$, and asymptotic expansions.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly rooted in the field of numerical analysis for partial differential equations, specifically concerning spectral and Discontinuous Galerkin methods. The use of Legendre polynomials, $L^2$-projections, and spectral decay indicators for troubled-cell detection (like the Persson-Peraire indicator) are standard concepts. The function $\\tanh(\\alpha x)$ is a canonical representation of a smooth layer.\n- **Well-Posedness:** The problem is mathematically well-defined. All variables, functions, and objectives are specified with precision. The tasks lead to a unique and meaningful solution.\n- **Objectivity:** The problem statement is objective and devoid of any subjective or ambiguous language.\n- **Completeness and Consistency:** The problem is self-contained. All necessary information (definitions, constants, conditions) is provided. There are no contradictions in the setup.\n- **Realism and Feasibility:** The problem describes a standard theoretical analysis exercise in the development or study of numerical methods. The calculations required are feasible.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Solution\n\nThe solution is derived in three parts as requested. First, we note a crucial property stemming from parity. The function to be projected is $u((h/2)\\xi) = \\tanh(\\alpha (h/2) \\xi) = \\tanh(\\beta \\xi)$. This is an odd function of $\\xi$ because $\\tanh(-y) = -\\tanh(y)$. The Legendre polynomials $P_n(\\xi)$ are even functions for even $n$ and odd functions for odd $n$. The integral of an odd function over a symmetric interval like $[-1, 1]$ is zero.\n\nThe modal coefficients are given by $a_n = \\frac{2n+1}{2} \\int_{-1}^{1} \\tanh(\\beta \\xi) P_n(\\xi) d\\xi$.\nFor $n=0$ and $n=2$, the polynomials $P_0(\\xi)=1$ and $P_2(\\xi)=\\frac{1}{2}(3\\xi^2-1)$ are even. Therefore, the integrand $\\tanh(\\beta \\xi) P_n(\\xi)$ is an odd function for $n=0, 2$. Consequently, the integral over $[-1, 1]$ is zero.\n$$ a_0 = 0, \\quad a_2 = 0 $$\nThis holds for all values of $\\beta$. The indicator $s_K$ simplifies to:\n$$ s_K = \\ln\\left(\\frac{a_3^2}{a_1^2 + a_3^2}\\right) $$\n\n**1. Small-$\\beta$ Asymptotics of $s_K(\\beta)$**\n\nFor small values of its argument $y$, the Taylor expansion of $\\tanh(y)$ is $\\tanh(y) = y - \\frac{1}{3}y^3 + O(y^5)$. Thus, for small $\\beta$:\n$$ \\tanh(\\beta \\xi) \\approx \\beta \\xi - \\frac{1}{3}(\\beta \\xi)^3 = \\beta \\xi - \\frac{\\beta^3}{3}\\xi^3 $$\nTo find the coefficients $a_1$ and $a_3$, we project this polynomial onto the Legendre basis. We use the relations:\n$$ P_1(\\xi) = \\xi $$\n$$ P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi) \\implies \\xi^3 = \\frac{2}{5}P_3(\\xi) + \\frac{3}{5}\\xi = \\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi) $$\nSubstituting these into the expansion for $\\tanh(\\beta \\xi)$:\n$$ \\tanh(\\beta \\xi) \\approx \\beta P_1(\\xi) - \\frac{\\beta^3}{3}\\left(\\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi)\\right) $$\n$$ \\tanh(\\beta \\xi) \\approx \\left(\\beta - \\frac{\\beta^3}{5}\\right)P_1(\\xi) - \\frac{2\\beta^3}{15}P_3(\\xi) $$\nThe modal coefficients $a_n$ are precisely the coefficients in the Legendre series expansion. Thus, for small $\\beta$:\n$$ a_1 \\approx \\beta - \\frac{\\beta^3}{5} \\implies a_1 = \\beta + O(\\beta^3) $$\n$$ a_3 \\approx -\\frac{2\\beta^3}{15} $$\nTo find the leading-order behavior of $s_K$, we use the leading-order terms of the coefficients: $a_1 \\approx \\beta$ and $a_3 \\approx -2\\beta^3/15$.\n$$ s_K(\\beta) \\approx \\ln\\left(\\frac{(-\\frac{2\\beta^3}{15})^2}{(\\beta)^2 + (-\\frac{2\\beta^3}{15})^2}\\right) = \\ln\\left(\\frac{\\frac{4\\beta^6}{225}}{\\beta^2 + \\frac{4\\beta^6}{225}}\\right) $$\nIn the denominator, for small $\\beta$, $\\beta^2$ is the dominant term.\n$$ s_K(\\beta) \\approx \\ln\\left(\\frac{\\frac{4\\beta^6}{225}}{\\beta^2}\\right) = \\ln\\left(\\frac{4\\beta^4}{225}\\right) $$\nThis is the leading-order small-$\\beta$ asymptotic behavior of $s_K$.\n\n**2. Large-$\\beta$ Asymptotics of $s_K(\\beta)$**\n\nAs $\\beta \\to \\infty$, the function $\\tanh(\\beta \\xi)$ approaches the sign function pointwise for $\\xi \\neq 0$:\n$$ \\text{sgn}(\\xi) = \\begin{cases} 1 & \\xi > 0 \\\\ 0 & \\xi = 0 \\\\ -1 & \\xi < 0 \\end{cases} $$\nThe asymptotic coefficients, denoted $a_n^{(\\infty)}$, are found by projecting $\\text{sgn}(\\xi)$ onto the Legendre basis. As before, $a_0^{(\\infty)}=a_2^{(\\infty)}=0$ due to parity.\nFor $a_1^{(\\infty)}$:\n$$ a_1^{(\\infty)} = \\frac{3}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)P_1(\\xi)d\\xi = \\frac{3}{2}\\int_{-1}^{1} \\xi\\,\\text{sgn}(\\xi)d\\xi = \\frac{3}{2}\\int_{-1}^{1} |\\xi|d\\xi = \\frac{3}{2} \\left( 2\\int_{0}^{1} \\xi d\\xi \\right) = 3\\left[\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{3}{2} $$\nFor $a_3^{(\\infty)}$:\n$$ a_3^{(\\infty)} = \\frac{7}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)P_3(\\xi)d\\xi = \\frac{7}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)\\frac{1}{2}(5\\xi^3 - 3\\xi)d\\xi $$\nThe integrand is an even function, so we can write:\n$$ a_3^{(\\infty)} = \\frac{7}{2} \\cdot 2 \\int_{0}^{1} \\frac{1}{2}(5\\xi^3 - 3\\xi)d\\xi = \\frac{7}{2}\\left[5\\frac{\\xi^4}{4} - 3\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{7}{2}\\left(\\frac{5}{4}-\\frac{3}{2}\\right) = \\frac{7}{2}\\left(-\\frac{1}{4}\\right) = -\\frac{7}{8} $$\nThe large-$\\beta$ limit of the indicator is:\n$$ s_K^{(\\infty)} = \\ln\\left(\\frac{(a_3^{(\\infty)})^2}{(a_1^{(\\infty)})^2 + (a_3^{(\\infty)})^2}\\right) = \\ln\\left(\\frac{(-\\frac{7}{8})^2}{(\\frac{3}{2})^2 + (-\\frac{7}{8})^2}\\right) = \\ln\\left(\\frac{\\frac{49}{64}}{\\frac{9}{4} + \\frac{49}{64}}\\right) $$\n$$ s_K^{(\\infty)} = \\ln\\left(\\frac{\\frac{49}{64}}{\\frac{144}{64} + \\frac{49}{64}}\\right) = \\ln\\left(\\frac{49}{193}\\right) $$\n\n**3. Critical Value $(\\alpha h)_c$**\n\nThe limiting procedure is activated when $s_K > \\ln(\\varepsilon)$. The critical value corresponds to the threshold $s_K = \\ln(\\varepsilon)$. We use the small-$\\beta$ asymptotics derived in Part 1, as the threshold $\\varepsilon = 10^{-4}$ results in a large negative value for $\\ln(\\varepsilon)$, which is attained for small $\\beta$.\n$$ \\ln\\left(\\frac{4\\beta^4}{225}\\right) = \\ln(\\varepsilon) $$\nTaking the exponential of both sides:\n$$ \\frac{4\\beta^4}{225} = \\varepsilon $$\nSolving for the critical value $\\beta_c$:\n$$ \\beta_c^4 = \\frac{225}{4}\\varepsilon \\implies \\beta_c = \\left(\\frac{225\\varepsilon}{4}\\right)^{1/4} $$\nThe critical value is expressed in terms of $(\\alpha h)_c = 2\\beta_c$:\n$$ (\\alpha h)_c = 2 \\left(\\frac{15^2 \\varepsilon}{2^2}\\right)^{1/4} = 2 \\left(\\frac{15}{2}\\right)^{2/4} \\varepsilon^{1/4} = 2 \\left(\\frac{15}{2}\\right)^{1/2} \\varepsilon^{1/4} = 2 \\frac{\\sqrt{15}}{\\sqrt{2}} \\varepsilon^{1/4} = \\sqrt{2}\\sqrt{15}\\varepsilon^{1/4} = \\sqrt{30}\\varepsilon^{1/4} $$\nSubstituting the given value $\\varepsilon = 10^{-4}$:\n$$ (\\alpha h)_c = \\sqrt{30}(10^{-4})^{1/4} = \\sqrt{30} \\times 10^{-1} = \\frac{\\sqrt{30}}{10} $$\nThis is the final analytical expression for the critical value.",
            "answer": "$$\\boxed{\\frac{\\sqrt{30}}{10}}$$"
        },
        {
            "introduction": "Once a troubled-cell indicator flags an element, the next step is to apply a limiter to the local solution to enforce physical admissibility and prevent spurious oscillations. This exercise focuses on the mechanics of this limiting process, specifically using the widely adopted Total Variation Bounded (TVB) minmod limiter. By working through a concrete example with given cell averages and an unlimited slope, you will learn how the limiter selects a new, more conservative slope that maintains monotonicity, and how the TVB modification prevents the unnecessary damping of smooth solution extrema .",
            "id": "3425753",
            "problem": "Consider a one-dimensional scalar conservation law discretized by a second-order Discontinuous Galerkin (DG) method using piecewise linear polynomials on a uniform mesh with cell size $h$. A troubled-cell indicator has flagged cell $i$ because the exact solution is piecewise linear with a slope discontinuity located at the interface between cells $i$ and $i+1$. In such a flagged cell, apply the Total Variation Bounded (TVB) minmod limiter to the cellwise slope.\n\nUse the following data:\n- The uniform cell size is $h = \\frac{1}{10}$.\n- The cell averages in the neighboring cells are $\\bar{u}_{i-1} = 1$, $\\bar{u}_{i} = \\frac{8}{5}$, and $\\bar{u}_{i+1} = 2$.\n- The unlimited slope in cell $i$ (obtained from the DG polynomial representation) is $s_{i} = 8$.\n- The TVB parameter is $M = 30$.\n\nAdopt the standard TVB minmod limiter for piecewise linear reconstructions, defined by\n$$\n\\tilde{s}_{i} = \\operatorname{mm}_{\\mathrm{TVB}}\\!\\left(s_{i}, \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}\\right),\n$$\nwhere the Total Variation Bounded (TVB) modification is\n$$\n\\operatorname{mm}_{\\mathrm{TVB}}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\na_{1}, & \\text{if } |a_{1}| \\le M h^{2}, \\\\\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}), & \\text{otherwise},\n\\end{cases}\n$$\nand the standard minmod function is\n$$\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\n\\operatorname{sgn}(a_{1}) \\min\\left(|a_{1}|, |a_{2}|, |a_{3}|\\right), & \\text{if } \\operatorname{sgn}(a_{1}) = \\operatorname{sgn}(a_{2}) = \\operatorname{sgn}(a_{3}), \\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nCompute the limited slope $\\tilde{s}_{i}$ in cell $i$. Express your final answer as a single real number. No rounding is required.",
            "solution": "The problem requires the computation of a limited slope, $\\tilde{s}_{i}$, for a cell $i$ using a Total Variation Bounded (TVB) minmod limiter. The problem provides all necessary data and definitions to perform this calculation.\n\nThe problem is valid as it is scientifically grounded in the field of numerical methods for conservation laws, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe limited slope $\\tilde{s}_{i}$ is defined as:\n$$\n\\tilde{s}_{i} = \\operatorname{mm}_{\\mathrm{TVB}}\\!\\left(s_{i}, \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}\\right)\n$$\nwhere the TVB minmod function is given by:\n$$\n\\operatorname{mm}_{\\mathrm{TVB}}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\na_{1}, & \\text{if } |a_{1}| \\le M h^{2}, \\\\\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}), & \\text{otherwise}.\n\\end{cases}\n$$\nThe standard minmod function, $\\operatorname{mm}(a_{1}, a_{2}, a_{3})$, is defined as:\n$$\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\n\\operatorname{sgn}(a_{1}) \\min\\left(|a_{1}|, |a_{2}|, |a_{3}|\\right), & \\text{if } \\operatorname{sgn}(a_{1}) = \\operatorname{sgn}(a_{2}) = \\operatorname{sgn}(a_{3}), \\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nThe first step is to check the condition for the TVB modification. We must evaluate whether $|s_{i}| \\le M h^{2}$.\nThe given values are:\n- Unlimited slope in cell $i$: $s_{i} = 8$.\n- TVB parameter: $M = 30$.\n- Uniform cell size: $h = \\frac{1}{10}$.\n\nWe calculate the threshold $M h^{2}$:\n$$\nM h^{2} = 30 \\times \\left(\\frac{1}{10}\\right)^{2} = 30 \\times \\frac{1}{100} = \\frac{3}{10}.\n$$\nNext, we take the absolute value of the unlimited slope $s_{i}$:\n$$\n|s_{i}| = |8| = 8.\n$$\nNow, we compare $|s_{i}|$ with $M h^{2}$:\n$$\n8 > \\frac{3}{10}.\n$$\nSince $|s_{i}| > M h^{2}$, the condition $|s_{i}| \\le M h^{2}$ is false. Therefore, we must use the second case of the $\\operatorname{mm}_{\\mathrm{TVB}}$ function, which involves the standard minmod function:\n$$\n\\tilde{s}_{i} = \\operatorname{mm}\\left(s_{i}, \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}\\right).\n$$\n\nTo evaluate this function, we must first compute its arguments. Let these be $a_1$, $a_2$, and $a_3$.\nThe first argument is the unlimited slope:\n$$\na_{1} = s_{i} = 8.\n$$\nThe second argument is the backward difference slope:\n$$\na_{2} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}.\n$$\nUsing the given cell averages $\\bar{u}_{i} = \\frac{8}{5}$ and $\\bar{u}_{i-1} = 1$, and cell size $h = \\frac{1}{10}$:\n$$\na_{2} = \\frac{\\frac{8}{5} - 1}{\\frac{1}{10}} = \\frac{\\frac{8}{5} - \\frac{5}{5}}{\\frac{1}{10}} = \\frac{\\frac{3}{5}}{\\frac{1}{10}} = \\frac{3}{5} \\times 10 = 6.\n$$\nThe third argument is the forward difference slope:\n$$\na_{3} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}.\n$$\nUsing the given cell averages $\\bar{u}_{i+1} = 2$ and $\\bar{u}_{i} = \\frac{8}{5}$:\n$$\na_{3} = \\frac{2 - \\frac{8}{5}}{\\frac{1}{10}} = \\frac{\\frac{10}{5} - \\frac{8}{5}}{\\frac{1}{10}} = \\frac{\\frac{2}{5}}{\\frac{1}{10}} = \\frac{2}{5} \\times 10 = 4.\n$$\nNow we must compute $\\operatorname{mm}(8, 6, 4)$.\nFirst, we check the signs of the arguments $a_1=8$, $a_2=6$, and $a_3=4$:\n$$\n\\operatorname{sgn}(8) = +1, \\quad \\operatorname{sgn}(6) = +1, \\quad \\operatorname{sgn}(4) = +1.\n$$\nSince all arguments have the same sign, the first case of the $\\operatorname{mm}$ function applies:\n$$\n\\tilde{s}_{i} = \\operatorname{sgn}(a_{1}) \\min(|a_{1}|, |a_{2}|, |a_{3}|).\n$$\nSubstituting the values:\n$$\n\\tilde{s}_{i} = \\operatorname{sgn}(8) \\min(|8|, |6|, |4|) = (+1) \\min(8, 6, 4).\n$$\nThe minimum of the set $\\{8, 6, 4\\}$ is $4$. Therefore, the limited slope is:\n$$\n\\tilde{s}_{i} = 4.\n$$",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "Applying troubled-cell indicators to systems of conservation laws, such as the Euler equations of gas dynamics, introduces an important practical consideration: which physical variable should be monitored? Shocks and contact discontinuities manifest differently across variables like density, pressure, and entropy. This practice problem explores this critical choice by providing a snapshot of a blast wave simulation and asking you to evaluate the performance of a spectral indicator on three different variables, demonstrating how selecting a physically robust quantity like entropy can lead to a more selective and accurate limiting strategy .",
            "id": "3425758",
            "problem": "A one-dimensional Euler blast wave snapshot is represented in a Discontinuous Galerkin (DG) discretization of polynomial degree $p=2$ on three contiguous elements $E \\in \\{1,2,3\\}$. For three scalar variable sets—density $\\rho$, pressure $p$, and mathematical entropy $s=\\ln(p)-\\gamma \\ln(\\rho)$ with $\\gamma=1.4$—you are given the degree-$2$ modal coefficients of the DG polynomial in each element in an $L^{2}$-orthonormal Legendre basis on the reference element. Denote the modal coefficients by $\\{\\hat{v}_{k}^{(E)}\\}_{k=0}^{2}$ for variable $v \\in \\{\\rho,p,s\\}$. The troubled-cell indicator to be used is the Persson–Peraire high-mode content indicator:\n$$\nI_{E}^{(v)} \\;=\\; \\ln\\!\\left(\\frac{\\left(\\hat{v}_{2}^{(E)}\\right)^{2}}{\\sum_{k=0}^{2}\\left(\\hat{v}_{k}^{(E)}\\right)^{2}}\\right).\n$$\nA cell $E$ is flagged as troubled for variable $v$ if $I_{E}^{(v)} > \\tau$ with threshold $\\tau=-4.5$. The physically consistent target set of cells that genuinely require limiting for this snapshot is $\\mathcal{T}=\\{3\\}$.\n\nThe variable-specific modal coefficients are as follows (each number is a coefficient in the orthonormal Legendre basis):\n\n- For density $v=\\rho$:\n  - $E=1$: $\\left(\\hat{\\rho}_{0}^{(1)},\\hat{\\rho}_{1}^{(1)},\\hat{\\rho}_{2}^{(1)}\\right)=(1.0,\\,0.02,\\,0.01)$.\n  - $E=2$: $\\left(\\hat{\\rho}_{0}^{(2)},\\hat{\\rho}_{1}^{(2)},\\hat{\\rho}_{2}^{(2)}\\right)=(1.1,\\,0.05,\\,0.3)$.\n  - $E=3$: $\\left(\\hat{\\rho}_{0}^{(3)},\\hat{\\rho}_{1}^{(3)},\\hat{\\rho}_{2}^{(3)}\\right)=(3.0,\\,0.5,\\,0.4)$.\n\n- For pressure $v=p$:\n  - $E=1$: $\\left(\\hat{p}_{0}^{(1)},\\hat{p}_{1}^{(1)},\\hat{p}_{2}^{(1)}\\right)=(1.0,\\,0.3,\\,0.2)$.\n  - $E=2$: $\\left(\\hat{p}_{0}^{(2)},\\hat{p}_{1}^{(2)},\\hat{p}_{2}^{(2)}\\right)=(1.05,\\,0.25,\\,0.15)$.\n  - $E=3$: $\\left(\\hat{p}_{0}^{(3)},\\hat{p}_{1}^{(3)},\\hat{p}_{2}^{(3)}\\right)=(2.0,\\,0.6,\\,0.4)$.\n\n- For entropy $v=s$:\n  - $E=1$: $\\left(\\hat{s}_{0}^{(1)},\\hat{s}_{1}^{(1)},\\hat{s}_{2}^{(1)}\\right)=(0.2,\\,0.01,\\,0.001)$.\n  - $E=2$: $\\left(\\hat{s}_{0}^{(2)},\\hat{s}_{1}^{(2)},\\hat{s}_{2}^{(2)}\\right)=(0.25,\\,0.015,\\,0.0015)$.\n  - $E=3$: $\\left(\\hat{s}_{0}^{(3)},\\hat{s}_{1}^{(3)},\\hat{s}_{2}^{(3)}\\right)=(0.9,\\,0.2,\\,0.12)$.\n\nDefine the selectivity and physical consistency score for each variable set $v$ by\n$$\nC(v) \\;=\\; 3\\,N_{\\mathrm{FN}}(v) \\;+\\; N_{\\mathrm{FP}}(v),\n$$\nwhere $N_{\\mathrm{FN}}(v)$ is the number of false negatives (cells in $\\mathcal{T}$ not flagged for $v$) and $N_{\\mathrm{FP}}(v)$ is the number of false positives (cells flagged for $v$ but not in $\\mathcal{T}$). A lower score indicates more selective and physically consistent limiting.\n\nCompute $I_{E}^{(v)}$ for all $v \\in \\{\\rho,p,s\\}$ and $E \\in \\{1,2,3\\}$, determine the flagged cells for each $v$ using the threshold $\\tau=-4.5$, evaluate $C(v)$, and decide which variable set minimizes $C(v)$. Report your final choice by the code: $\\rho \\mapsto 1$, $p \\mapsto 2$, $s \\mapsto 3$. The final answer must be this single integer code. No rounding is required and no units are involved.",
            "solution": "The problem requires evaluating the Persson–Peraire indicator for three different variables—density ($\\rho$), pressure ($p$), and entropy ($s$)—across three computational elements and determining which variable provides the most accurate set of \"troubled\" cells compared to a given ground truth.\n\nThe core of the problem is to evaluate the Persson–Peraire indicator for a variable $v$ in element $E$ is given by:\n$$\nI_{E}^{(v)} = \\ln\\left(\\frac{\\left(\\hat{v}_{2}^{(E)}\\right)^{2}}{\\sum_{k=0}^{2}\\left(\\hat{v}_{k}^{(E)}\\right)^{2}}\\right)\n$$\nwhere $\\{\\hat{v}_{k}^{(E)}\\}_{k=0}^{2}$ are the modal coefficients of the DG polynomial of degree $p=2$ in an orthonormal basis. An element $E$ is flagged as troubled if $I_{E}^{(v)} > \\tau$, where the threshold is given as $\\tau = -4.5$. The set of cells that are genuinely troubled is $\\mathcal{T}=\\{3\\}$.\n\nFor each variable $v$, we will identify the set of flagged cells $\\mathcal{F}^{(v)}$. We then compute the number of false negatives, $N_{\\mathrm{FN}}(v) = |\\mathcal{T} \\setminus \\mathcal{F}^{(v)}|$, and false positives, $N_{\\mathrm{FP}}(v) = |\\mathcal{F}^{(v)} \\setminus \\mathcal{T}|$. The performance is measured by the cost function $C(v) = 3 N_{\\mathrm{FN}}(v) + N_{\\mathrm{FP}}(v)$. The goal is to find the variable that minimizes $C(v)$.\n\nThe calculations for each variable are as follows:\n\n**1. Density Variable ($v=\\rho$)**\n\n*   **Element $E=1$**: Coefficients are $(\\hat{\\rho}_{0}^{(1)}, \\hat{\\rho}_{1}^{(1)}, \\hat{\\rho}_{2}^{(1)}) = (1.0, 0.02, 0.01)$.\n    $$\n    I_{1}^{(\\rho)} = \\ln\\left(\\frac{(0.01)^2}{(1.0)^2 + (0.02)^2 + (0.01)^2}\\right) = \\ln\\left(\\frac{0.0001}{1.0 + 0.0004 + 0.0001}\\right) = \\ln\\left(\\frac{0.0001}{1.0005}\\right) \\approx -9.2108\n    $$\n    Since $I_{1}^{(\\rho)} \\approx -9.2108 < -4.5$, element $1$ is not flagged.\n\n*   **Element $E=2$**: Coefficients are $(\\hat{\\rho}_{0}^{(2)}, \\hat{\\rho}_{1}^{(2)}, \\hat{\\rho}_{2}^{(2)}) = (1.1, 0.05, 0.3)$.\n    $$\n    I_{2}^{(\\rho)} = \\ln\\left(\\frac{(0.3)^2}{(1.1)^2 + (0.05)^2 + (0.3)^2}\\right) = \\ln\\left(\\frac{0.09}{1.21 + 0.0025 + 0.09}\\right) = \\ln\\left(\\frac{0.09}{1.3025}\\right) \\approx -2.6723\n    $$\n    Since $I_{2}^{(\\rho)} \\approx -2.6723 > -4.5$, element $2$ is flagged.\n\n*   **Element $E=3$**: Coefficients are $(\\hat{\\rho}_{0}^{(3)}, \\hat{\\rho}_{1}^{(3)}, \\hat{\\rho}_{2}^{(3)}) = (3.0, 0.5, 0.4)$.\n    $$\n    I_{3}^{(\\rho)} = \\ln\\left(\\frac{(0.4)^2}{(3.0)^2 + (0.5)^2 + (0.4)^2}\\right) = \\ln\\left(\\frac{0.16}{9.0 + 0.25 + 0.16}\\right) = \\ln\\left(\\frac{0.16}{9.41}\\right) \\approx -4.0743\n    $$\n    Since $I_{3}^{(\\rho)} \\approx -4.0743 > -4.5$, element $3$ is flagged.\n\nThe set of flagged cells for density is $\\mathcal{F}^{(\\rho)} = \\{2, 3\\}$.\n*   False Negatives ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(\\rho)} = \\{3\\} \\setminus \\{2, 3\\} = \\emptyset$. So, $N_{\\mathrm{FN}}(\\rho) = 0$.\n*   False Positives ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(\\rho)} \\setminus \\mathcal{T} = \\{2, 3\\} \\setminus \\{3\\} = \\{2\\}$. So, $N_{\\mathrm{FP}}(\\rho) = 1$.\n*   Cost for density: $C(\\rho) = 3 \\times 0 + 1 = 1$.\n\n**2. Pressure Variable ($v=p$)**\n\n*   **Element $E=1$**: Coefficients are $(\\hat{p}_{0}^{(1)}, \\hat{p}_{1}^{(1)}, \\hat{p}_{2}^{(1)}) = (1.0, 0.3, 0.2)$.\n    $$\n    I_{1}^{(p)} = \\ln\\left(\\frac{(0.2)^2}{(1.0)^2 + (0.3)^2 + (0.2)^2}\\right) = \\ln\\left(\\frac{0.04}{1.0 + 0.09 + 0.04}\\right) = \\ln\\left(\\frac{0.04}{1.13}\\right) \\approx -3.3414\n    $$\n    Since $I_{1}^{(p)} \\approx -3.3414 > -4.5$, element $1$ is flagged.\n\n*   **Element $E=2$**: Coefficients are $(\\hat{p}_{0}^{(2)}, \\hat{p}_{1}^{(2)}, \\hat{p}_{2}^{(2)}) = (1.05, 0.25, 0.15)$.\n    $$\n    I_{2}^{(p)} = \\ln\\left(\\frac{(0.15)^2}{(1.05)^2 + (0.25)^2 + (0.15)^2}\\right) = \\ln\\left(\\frac{0.0225}{1.1025 + 0.0625 + 0.0225}\\right) = \\ln\\left(\\frac{0.0225}{1.1875}\\right) \\approx -3.9655\n    $$\n    Since $I_{2}^{(p)} \\approx -3.9655 > -4.5$, element $2$ is flagged.\n\n*   **Element $E=3$**: Coefficients are $(\\hat{p}_{0}^{(3)}, \\hat{p}_{1}^{(3)}, \\hat{p}_{2}^{(3)}) = (2.0, 0.6, 0.4)$.\n    $$\n    I_{3}^{(p)} = \\ln\\left(\\frac{(0.4)^2}{(2.0)^2 + (0.6)^2 + (0.4)^2}\\right) = \\ln\\left(\\frac{0.16}{4.0 + 0.36 + 0.16}\\right) = \\ln\\left(\\frac{0.16}{4.52}\\right) \\approx -3.3414\n    $$\n    Since $I_{3}^{(p)} \\approx -3.3414 > -4.5$, element $3$ is flagged.\n\nThe set of flagged cells for pressure is $\\mathcal{F}^{(p)} = \\{1, 2, 3\\}$.\n*   False Negatives ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(p)} = \\{3\\} \\setminus \\{1, 2, 3\\} = \\emptyset$. So, $N_{\\mathrm{FN}}(p) = 0$.\n*   False Positives ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(p)} \\setminus \\mathcal{T} = \\{1, 2, 3\\} \\setminus \\{3\\} = \\{1, 2\\}$. So, $N_{\\mathrm{FP}}(p) = 2$.\n*   Cost for pressure: $C(p) = 3 \\times 0 + 2 = 2$.\n\n**3. Entropy Variable ($v=s$)**\n\n*   **Element $E=1$**: Coefficients are $(\\hat{s}_{0}^{(1)}, \\hat{s}_{1}^{(1)}, \\hat{s}_{2}^{(1)}) = (0.2, 0.01, 0.001)$.\n    $$\n    I_{1}^{(s)} = \\ln\\left(\\frac{(0.001)^2}{(0.2)^2 + (0.01)^2 + (0.001)^2}\\right) = \\ln\\left(\\frac{10^{-6}}{0.04 + 0.0001 + 10^{-6}}\\right) = \\ln\\left(\\frac{10^{-6}}{0.040101}\\right) \\approx -10.5991\n    $$\n    Since $I_{1}^{(s)} \\approx -10.5991 < -4.5$, element $1$ is not flagged.\n\n*   **Element $E=2$**: Coefficients are $(\\hat{s}_{0}^{(2)}, \\hat{s}_{1}^{(2)}, \\hat{s}_{2}^{(2)}) = (0.25, 0.015, 0.0015)$.\n    $$\n    I_{2}^{(s)} = \\ln\\left(\\frac{(0.0015)^2}{(0.25)^2 + (0.015)^2 + (0.0015)^2}\\right) = \\ln\\left(\\frac{2.25 \\times 10^{-6}}{0.0625 + 0.000225 + 2.25 \\times 10^{-6}}\\right) = \\ln\\left(\\frac{2.25 \\times 10^{-6}}{0.06272725}\\right) \\approx -10.2364\n    $$\n    Since $I_{2}^{(s)} \\approx -10.2364 < -4.5$, element $2$ is not flagged.\n\n*   **Element $E=3$**: Coefficients are $(\\hat{s}_{0}^{(3)}, \\hat{s}_{1}^{(3)}, \\hat{s}_{2}^{(3)}) = (0.9, 0.2, 0.12)$.\n    $$\n    I_{3}^{(s)} = \\ln\\left(\\frac{(0.12)^2}{(0.9)^2 + (0.2)^2 + (0.12)^2}\\right) = \\ln\\left(\\frac{0.0144}{0.81 + 0.04 + 0.0144}\\right) = \\ln\\left(\\frac{0.0144}{0.8644}\\right) \\approx -4.0954\n    $$\n    Since $I_{3}^{(s)} \\approx -4.0954 > -4.5$, element $3$ is flagged.\n\nThe set of flagged cells for entropy is $\\mathcal{F}^{(s)} = \\{3\\}$.\n*   False Negatives ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(s)} = \\{3\\} \\setminus \\{3\\} = \\emptyset$. So, $N_{\\mathrm{FN}}(s) = 0$.\n*   False Positives ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(s)} \\setminus \\mathcal{T} = \\{3\\} \\setminus \\{3\\} = \\emptyset$. So, $N_{\\mathrm{FP}}(s) = 0$.\n*   Cost for entropy: $C(s) = 3 \\times 0 + 0 = 0$.\n\n**Conclusion**\n\nComparing the costs for the three variables:\n*   $C(\\rho) = 1$\n*   $C(p) = 2$\n*   $C(s) = 0$\n\nThe minimum cost is $0$, achieved when using the entropy variable $s$. The problem specifies the final answer should be a code: $\\rho \\mapsto 1$, $p \\mapsto 2$, $s \\mapsto 3$. Since the optimal variable is $s$, the corresponding code is $3$.",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}