{
    "hands_on_practices": [
        {
            "introduction": "The remarkable efficiency of spectral methods stems from their ability to achieve exponential convergence for analytic functions. This exercise provides a foundational look into this phenomenon by connecting the smoothness of a function, characterized by its region of analyticity in the complex plane, to the decay rate of its Legendre polynomial coefficients. By working through this problem, you will derive from first principles how the location of a function's nearest singularity dictates the exponential convergence rate of its spectral approximation, a cornerstone of a priori error analysis for spectral methods .",
            "id": "3361637",
            "problem": "Consider the interval $[-1,1]$ and the Legendre polynomials $\\{P_{n}\\}_{n\\geq 0}$, which are orthogonal on $[-1,1]$ with respect to the weight $1$, so that $\\int_{-1}^{1} P_{m}(x) P_{n}(x) \\, dx = \\frac{2}{2n+1} \\delta_{mn}$, where $\\delta_{mn}$ denotes the Kronecker delta. Let $u:[-1,1]\\to\\mathbb{R}$ be analytic and expanded in the Legendre series $u(x) = \\sum_{n=0}^{\\infty} \\hat{u}_{n} P_{n}(x)$ with modal coefficients $\\hat{u}_{n} = \\frac{2n+1}{2}\\int_{-1}^{1} u(x) P_{n}(x)\\,dx$. The Spectral Galerkin method, in the setting of the Spectral Galerkin (SG) method for approximation on a single element, uses the finite-dimensional subspace $V_{N} := \\operatorname{span}\\{P_{0},P_{1},\\dots,P_{N}\\}$ and the orthogonal projection $u_{N}\\in V_{N}$ satisfying $\\int_{-1}^{1}(u-u_{N}) P_{n} \\, dx = 0$ for $0\\leq n\\leq N$.\n\nAssume that $u$ is analytic on and inside the Bernstein ellipse\n$$\nE_{\\rho} := \\left\\{ x(\\theta) = \\frac{1}{2}\\left(\\rho e^{i\\theta} + \\rho^{-1} e^{-i\\theta}\\right) : \\theta\\in[0,2\\pi) \\right\\}\n$$\nfor some $\\rho>1$, and has a single isolated simple pole on the real axis at $x=a$ with $a>1$. In particular, consider the concrete analytic datum\n$$\nu(x) = \\frac{1}{a - x}, \\quad a>1,\n$$\nwhich is analytic in a neighborhood of $[-1,1]$ and has its nearest singularity at $x=a$. Starting from the orthogonality of Legendre polynomials and the complex-analytic characterization of the Bernstein ellipse via the Joukowski map $x=\\frac{1}{2}(w+w^{-1})$, use first principles to:\n\n- derive the large-$n$ decay of the Legendre modal coefficients $\\hat{u}_{n}$ for the given $u$ in terms of the ellipse parameter $\\rho$ determined by the location of the pole $x=a$,\n- and explain why this decay implies an a priori exponential convergence rate for the SG projection error $\\|u-u_{N}\\|_{L^{2}(-1,1)}$ as $N\\to\\infty$.\n\nYour final output should be the exact closed-form expression for the exponential base $\\lambda(a)\\in(0,1)$ such that the SG a priori error bound scales like $\\mathcal{O}(\\lambda(a)^{N})$ for large $N$.\n\nProvide the exact symbolic expression for $\\lambda(a)$ in terms of $a$. No numerical approximation is required for the final answer.",
            "solution": "The core of the problem is to determine the rate of convergence of a Spectral Galerkin approximation for a specific analytic function. This rate is governed by the function's region of analyticity in the complex plane, which is characterized by the Bernstein ellipse.\n\n**1. Analyticity and the Bernstein Ellipse**\n\nThe function $u(x) = \\frac{1}{a - x}$ with $a > 1$ is analytic in the complex plane except for a simple pole at $z=a$. The rate of convergence of its Legendre polynomial approximation is determined by the largest Bernstein ellipse $E_{\\rho}$ inside which $u(z)$ is analytic. The Bernstein ellipse $E_{\\rho}$ is the image of the circle $|w|=\\rho$ in the complex $w$-plane under the Joukowski map $x(w) = \\frac{1}{2}(w + w^{-1})$. The interval $[-1, 1]$ corresponds to the unit circle $|w|=1$. Since the singularity at $z=a$ is on the real axis, the boundary of the maximal ellipse of analyticity must pass through this point. Thus, we seek the parameter $\\rho > 1$ such that $a$ is on the ellipse $E_{\\rho}$. For a point on the positive real axis, this corresponds to $w$ being real and positive, so $w=\\rho$. We solve for $\\rho$:\n$$\na = \\frac{1}{2}\\left(\\rho + \\frac{1}{\\rho}\\right)\n$$\nThis leads to the quadratic equation $\\rho^2 - 2a\\rho + 1 = 0$. The roots are:\n$$\n\\rho = \\frac{2a \\pm \\sqrt{4a^2 - 4}}{2} = a \\pm \\sqrt{a^2 - 1}\n$$\nSince the map $w \\mapsto \\frac{1}{2}(w+w^{-1})$ maps both $|w|=\\rho$ and $|w|=\\rho^{-1}$ to the same ellipse, we choose the root with magnitude greater than $1$ to define the exterior region. As $a > 1$, we have $a^2 > 1$, and $a+\\sqrt{a^2-1} > 1$, while $a-\\sqrt{a^2-1} = (a+\\sqrt{a^2-1})^{-1}  1$. Thus, the parameter for the largest ellipse of analyticity is:\n$$\n\\rho = a + \\sqrt{a^2 - 1}\n$$\n\n**2. Asymptotic Decay of Legendre Coefficients**\n\nThe Spectral Galerkin projection $u_N(x)$ is the $L^2([-1,1])$-orthogonal projection of $u(x)$ onto the space $V_N = \\operatorname{span}\\{P_0, \\dots, P_N\\}$. This means $u_N(x) = \\sum_{n=0}^{N} \\hat{u}_n P_n(x)$, where the modal coefficients $\\hat{u}_n$ are given by\n$$\n\\hat{u}_n = \\frac{2n+1}{2} \\int_{-1}^{1} u(x) P_n(x) \\, dx\n$$\nFor the specific function $u(x) = \\frac{1}{a-x}$, the coefficients are:\n$$\n\\hat{u}_n = \\frac{2n+1}{2} \\int_{-1}^{1} \\frac{P_n(x)}{a-x} \\, dx\n$$\nThis integral is related to the Legendre function of the second kind, $Q_n(z)$, defined for $z \\notin [-1,1]$ as:\n$$\nQ_n(z) = \\frac{1}{2} \\int_{-1}^{1} \\frac{P_n(x)}{z-x} \\, dx\n$$\nThus, we can write the integral as $2 Q_n(a)$, and the coefficient becomes:\n$$\n\\hat{u}_n = \\frac{2n+1}{2} (2 Q_n(a)) = (2n+1) Q_n(a)\n$$\nTo find the large-$n$ decay of $\\hat{u}_n$, we need the asymptotic behavior of $Q_n(a)$. We can deduce this from the three-term recurrence relation for Legendre functions, which is valid for both $P_n$ and $Q_n$:\n$$\n(n+1) y_{n+1}(z) - (2n+1)z y_n(z) + n y_{n-1}(z) = 0\n$$\nAssuming an asymptotic form $Q_n(a) \\sim c \\lambda^n$ for large $n$, we substitute this into the recurrence. Dividing by $c\\lambda^{n-1}$ gives the characteristic equation:\n$$\n(n+1)\\lambda^2 - (2n+1)a\\lambda + n = 0\n$$\nFor large $n$, we divide by $n$ to find the asymptotic roots: $\\lambda^2 - 2a\\lambda + 1 = 0$, which yields $\\lambda = a \\pm \\sqrt{a^2-1}$. Since $Q_n(a) \\to 0$ as $n \\to \\infty$ for $a > 1$, we must choose the root with magnitude less than $1$:\n$$\n\\lambda = a - \\sqrt{a^2 - 1} = \\frac{1}{a + \\sqrt{a^2-1}} = \\rho^{-1}\n$$\nA more detailed asymptotic analysis shows that $Q_n(a) \\sim C_a n^{-1/2} \\rho^{-n}$ for some constant $C_a$. Substituting this into the expression for $\\hat{u}_n$:\n$$\n\\hat{u}_n = (2n+1)Q_n(a) \\sim (2n)(C_a n^{-1/2} \\rho^{-n}) = (2C_a) n^{1/2} \\rho^{-n}\n$$\nSo, the Legendre coefficients decay exponentially with a rate of $\\rho^{-1}$, modulated by an algebraic factor of $n^{1/2}$. Specifically, $|\\hat{u}_n| = \\mathcal{O}(n^{1/2}\\rho^{-n})$.\n\n**3. A Priori Error Estimate for the SG Projection**\n\nThe error of the Spectral Galerkin projection is the tail of the series: $e_N(x) = u(x) - u_N(x) = \\sum_{n=N+1}^{\\infty} \\hat{u}_n P_n(x)$. We measure the error in the $L^2(-1,1)$ norm. Using the orthogonality of the Legendre polynomials, $\\int_{-1}^1 P_m(x)P_n(x)\\,dx = \\frac{2}{2n+1}\\delta_{mn}$, we compute the squared norm of the error:\n$$\n\\|u-u_N\\|_{L^2}^2 = \\sum_{n=N+1}^{\\infty} |\\hat{u}_n|^2 \\frac{2}{2n+1}\n$$\nNow, we substitute the large-$n$ behavior of $\\hat{u}_n$:\n$$\n\\|u-u_N\\|_{L^2}^2 \\sim \\sum_{n=N+1}^{\\infty} (4|C_a|^2 n \\rho^{-2n}) \\frac{2}{2n+1}\n$$\nFor large $n$, the term $\\frac{2n}{2n+1}$ approaches $1$. Thus, the summand is asymptotically equivalent to $4|C_a|^2 \\rho^{-2n}$.\n$$\n\\|u-u_N\\|_{L^2}^2 \\sim 4|C_a|^2 \\sum_{n=N+1}^{\\infty} (\\rho^{-2})^n\n$$\nThis is a geometric series with ratio $r = \\rho^{-2}  1$. For large $N$, the sum is dominated by its first term, and the squared error behaves as:\n$$\n\\|u-u_N\\|_{L^2}^2 = \\mathcal{O}((\\rho^{-2})^N)\n$$\nTaking the square root of both sides gives the convergence rate for the $L^2$ error norm:\n$$\n\\|u-u_N\\|_{L^2} = \\mathcal{O}((\\rho^{-1})^N)\n$$\nThis demonstrates the exponential convergence of the Spectral Galerkin method for analytic functions. The base of the exponential convergence is $\\lambda(a) = \\rho^{-1}$.\n\n**4. Final Expression for the Convergence Base**\n\nThe exponential base $\\lambda(a)$ is $\\rho^{-1}$, where $\\rho = a + \\sqrt{a^2-1}$. Thus:\n$$\n\\lambda(a) = \\frac{1}{a + \\sqrt{a^2-1}} = \\frac{a - \\sqrt{a^2-1}}{ (a+\\sqrt{a^2-1})(a-\\sqrt{a^2-1}) } = \\frac{a - \\sqrt{a^2-1}}{a^2 - (a^2-1)} = a - \\sqrt{a^2-1}\n$$\nThis is the exact symbolic expression for the exponential base $\\lambda(a)$ such that the error scales as $\\mathcal{O}(\\lambda(a)^N)$.",
            "answer": "$$\n\\boxed{a - \\sqrt{a^2 - 1}}\n$$"
        },
        {
            "introduction": "While energy-norm estimates provide a natural starting point for proving the stability and convergence of finite element methods, we often seek stronger results in the $L^2$-norm. This practice introduces the Aubin–Nitsche duality argument, a fundamental technique used to lift an existing energy-norm error estimate to a higher-order estimate in the $L^2$-norm. Working through this guided derivation for a discontinuous Galerkin method will solidify your understanding of how to leverage dual problems and elliptic regularity to establish optimal convergence rates .",
            "id": "3361655",
            "problem": "Consider the second-order elliptic boundary value problem on the one-dimensional domain $\\Omega = (0,1)$: find $u \\in H^{1}_{0}(\\Omega)$ such that\n$$\n- u'' = f \\quad \\text{in } \\Omega, \\qquad u(0) = u(1) = 0,\n$$\nfor a given $f \\in L^{2}(\\Omega)$. Let $\\mathcal{T}_{h}$ be a quasi-uniform partition of $\\Omega$ into elements of size $h$, and let $V_{h}$ be the space of functions that are polynomials of degree at most $p \\ge 1$ on each element of $\\mathcal{T}_{h}$, with no interelement continuity enforced. Consider the symmetric interior penalty discontinuous Galerkin (SIPDG) method for this problem, defined by: find $u_{h} \\in V_{h}$ such that\n$$\na_{h}(u_{h}, v_{h}) = \\ell_{h}(v_{h}) \\quad \\text{for all } v_{h} \\in V_{h},\n$$\nwhere the bilinear form $a_{h}(\\cdot,\\cdot)$ is obtained by elementwise integration by parts with consistency and symmetric numerical fluxes, and includes a penalty with parameter $\\eta$ chosen sufficiently large to ensure coercivity. The linear functional $\\ell_{h}(\\cdot)$ represents the discrete right-hand side consistent with $f$. Assume the following foundational facts:\n- The bilinear form $a_{h}(\\cdot,\\cdot)$ is coercive and continuous in the broken energy norm, that is, there exist constants $C_{\\mathrm{coer}}  0$ and $C_{\\mathrm{cont}}  0$ independent of $h$ such that\n$$\nC_{\\mathrm{coer}} \\, \\| v \\|_{1,h}^{2} \\le a_{h}(v,v) \\quad \\text{and} \\quad |a_{h}(w,v)| \\le C_{\\mathrm{cont}} \\, \\| w \\|_{1,h} \\, \\| v \\|_{1,h}\n$$\nfor all $w, v \\in V_{h} + H^{1}_{0}(\\Omega)$, where $\\| \\cdot \\|_{1,h}$ denotes the broken energy norm induced by $a_{h}$.\n- The SIPDG method is consistent and satisfies Galerkin orthogonality: if $u$ is the exact solution, then $a_{h}(u - u_{h}, v_{h}) = 0$ for all $v_{h} \\in V_{h}$.\n- For $u \\in H^{p+1}(\\Omega)$, there is an a priori energy-norm error bound $\\| u - u_{h} \\|_{1,h} \\le C \\, h^{p} \\, \\| u \\|_{H^{p+1}(\\Omega)}$ with a constant $C$ independent of $h$.\n- The dual (adjoint) problem associated with the $L^{2}(\\Omega)$ norm of the error enjoys elliptic regularity: if $e \\in L^{2}(\\Omega)$ and $\\phi \\in H^{1}_{0}(\\Omega)$ solves\n$$\n- \\phi'' = e \\quad \\text{in } \\Omega, \\qquad \\phi(0) = \\phi(1) = 0,\n$$\nthen $\\phi \\in H^{2}(\\Omega)$ and $\\| \\phi \\|_{H^{2}(\\Omega)} \\le C_{\\mathrm{ellreg}} \\, \\| e \\|_{L^{2}(\\Omega)}$, with $C_{\\mathrm{ellreg}}$ independent of $h$.\nUsing only these foundational facts and the Aubin–Nitsche duality argument, determine the leading-order exponent $\\alpha$ (as a function of $p$) such that the $L^{2}(\\Omega)$ error of the SIPDG solution satisfies a bound of the form\n$$\n\\| u - u_{h} \\|_{L^{2}(\\Omega)} \\le C_{\\star} \\, h^{\\alpha} \\, \\| u \\|_{H^{p+1}(\\Omega)},\n$$\nfor $u \\in H^{p+1}(\\Omega)$ and a constant $C_{\\star}$ independent of $h$. Your final answer must be the closed-form analytical expression for $\\alpha$ in terms of $p$.",
            "solution": "The Aubin–Nitsche duality argument is used to derive an $L^{2}$-norm error estimate from an energy-norm error estimate. Let the error be $e_{h} = u - u_{h}$. Our goal is to bound the norm $\\| e_{h} \\|_{L^{2}(\\Omega)}$.\n\nThe argument begins by considering a dual (or adjoint) problem. Let $\\phi \\in H_{0}^{1}(\\Omega)$ be the unique weak solution to the problem\n$$\n- \\phi'' = e_{h} \\quad \\text{in } \\Omega, \\qquad \\phi(0) = \\phi(1) = 0.\n$$\nFrom the provided foundational facts, we know this dual problem has an elliptic regularity property. Since $e_{h} = u - u_{h}$ is in $L^{2}(\\Omega)$, the solution $\\phi$ is in $H^{2}(\\Omega)$ and satisfies the estimate:\n$$\n\\| \\phi \\|_{H^{2}(\\Omega)} \\le C_{\\mathrm{ellreg}} \\| e_{h} \\|_{L^{2}(\\Omega)}.\n$$\nNext, we express the squared $L^{2}$-norm of the error using the solution of this dual problem and the consistency of the DG formulation. For a sufficiently smooth function $\\psi$ that solves $-\\psi''=g$, the bilinear form satisfies $a_{h}(w, \\psi) = (w, g)_{L^{2}(\\Omega)}$. Applying this with $w=e_h$ and $\\psi=\\phi$:\n$$\n\\| e_{h} \\|_{L^{2}(\\Omega)}^{2} = \\int_{\\Omega} e_{h} \\cdot e_{h} \\, dx = (e_{h}, -\\phi'')_{L^{2}(\\Omega)} = a_{h}(e_{h}, \\phi).\n$$\nWe now invoke the Galerkin orthogonality property, $a_{h}(e_{h}, v_{h}) = 0$ for any $v_{h} \\in V_{h}$. Let $\\phi_{h}$ be an arbitrary function in $V_{h}$. We can then write:\n$$\na_{h}(e_{h}, \\phi) = a_{h}(e_{h}, \\phi - \\phi_{h}) + a_{h}(e_{h}, \\phi_{h}) = a_{h}(e_{h}, \\phi - \\phi_{h}).\n$$\nUsing the continuity of the bilinear form $a_{h}(\\cdot, \\cdot)$ in the broken energy norm $\\| \\cdot \\|_{1,h}$:\n$$\n\\| e_{h} \\|_{L^{2}(\\Omega)}^{2} = |a_{h}(e_{h}, \\phi - \\phi_{h})| \\le C_{\\mathrm{cont}} \\| e_{h} \\|_{1,h} \\| \\phi - \\phi_{h} \\|_{1,h}.\n$$\nThe next step is to bound the two terms on the right-hand side.\n\nThe first term, $\\| e_{h} \\|_{1,h}$, is the error in the energy norm. We are given the a priori error bound for this term:\n$$\n\\| e_{h} \\|_{1,h} = \\| u - u_{h} \\|_{1,h} \\le C h^{p} \\| u \\|_{H^{p+1}(\\Omega)}.\n$$\nThe second term, $\\| \\phi - \\phi_{h} \\|_{1,h}$, is the approximation error for the dual solution $\\phi$ in the space $V_{h}$. Since $\\phi_{h}$ can be any function in $V_{h}$, we can choose it to be a good approximation of $\\phi$. The problem assumes standard approximation properties for the space of degree $p$ polynomials. For a function $\\psi \\in H^{s}(\\Omega)$, the approximation error in the broken energy norm is $\\| \\psi - \\psi_{h} \\|_{1,h} \\le C' h^{\\min(p, s-1)} \\| \\psi \\|_{H^{s}(\\Omega)}$ for some $\\psi_{h} \\in V_{h}$. Our dual solution has regularity $\\phi \\in H^{2}(\\Omega)$, which corresponds to $s=2$. Thus,\n$$\n\\| \\phi - \\phi_{h} \\|_{1,h} \\le C'' h^{\\min(p, 2-1)} \\| \\phi \\|_{H^{2}(\\Omega)} = C'' h^{\\min(p,1)} \\| \\phi \\|_{H^{2}(\\Omega)}.\n$$\nSince the polynomial degree is $p \\ge 1$, we have $\\min(p,1) = 1$. Therefore,\n$$\n\\| \\phi - \\phi_{h} \\|_{1,h} \\le C'' h^{1} \\| \\phi \\|_{H^{2}(\\Omega)}.\n$$\nSubstituting these bounds back into our inequality for the $L^{2}$-norm of the error:\n$$\n\\| e_{h} \\|_{L^{2}(\\Omega)}^{2} \\le C_{\\mathrm{cont}} \\left( C h^{p} \\| u \\|_{H^{p+1}(\\Omega)} \\right) \\left( C'' h^{1} \\| \\phi \\|_{H^{2}(\\Omega)} \\right).\n$$\nCombining constants and powers of $h$:\n$$\n\\| e_{h} \\|_{L^{2}(\\Omega)}^{2} \\le C_{1} h^{p+1} \\| u \\|_{H^{p+1}(\\Omega)} \\| \\phi \\|_{H^{2}(\\Omega)}.\n$$\nFinally, we use the elliptic regularity estimate for $\\phi$:\n$$\n\\| e_{h} \\|_{L^{2}(\\Omega)}^{2} \\le C_{1} h^{p+1} \\| u \\|_{H^{p+1}(\\Omega)} \\left( C_{\\mathrm{ellreg}} \\| e_{h} \\|_{L^{2}(\\Omega)} \\right).\n$$\nAssuming $\\| e_{h} \\|_{L^{2}(\\Omega)} > 0$, we can divide both sides by $\\| e_{h} \\|_{L^{2}(\\Omega)}$ to obtain:\n$$\n\\| e_{h} \\|_{L^{2}(\\Omega)} \\le C_{\\star} h^{p+1} \\| u \\|_{H^{p+1}(\\Omega)},\n$$\nwhere $C_{\\star}$ is a constant independent of $h$. By comparing this result to the requested form $\\| u - u_{h} \\|_{L^{2}(\\Omega)} \\le C_{\\star} \\, h^{\\alpha} \\, \\| u \\|_{H^{p+1}(\\Omega)}$, we identify the exponent $\\alpha = p+1$. This demonstrates a one-order-higher convergence rate in the $L^{2}$-norm compared to the energy norm.",
            "answer": "$$\n\\boxed{p+1}\n$$"
        },
        {
            "introduction": "A powerful feature of modern high-order methods, such as the Hybridizable Discontinuous Galerkin (HDG) method, is the ability to achieve superconvergence through local post-processing. This advanced exercise demonstrates how a simple, element-wise computation applied to the numerical solution can yield a new approximation that converges at a significantly faster rate. By deriving the $O(h^{p+2})$ error bound for the post-processed solution, you will gain insight into the sophisticated error structures of HDG methods and the practical techniques used to enhance their accuracy beyond standard estimates .",
            "id": "3361609",
            "problem": "Consider the second-order elliptic model problem on a bounded, convex polygonal domain $\\Omega \\subset \\mathbb{R}^d$ with $d \\in \\{2,3\\}$: find $u \\in H_0^1(\\Omega)$ such that $-\\Delta u = f$ in $\\Omega$ and $u = 0$ on $\\partial \\Omega$, where $f \\in L^2(\\Omega)$. Let $\\mathcal{T}_h$ be a family of shape-regular, quasi-uniform simplicial meshes with meshsize $h$, and denote by $\\mathcal{E}_h$ the set of mesh faces. Introduce the flux $ \\boldsymbol{q} := -\\nabla u$. Assume the exact solution satisfies $u \\in H^{p+2}(\\Omega)$ for some integer polynomial degree $p \\ge 0$.\n  \nLet $(\\boldsymbol{q}_h, u_h, \\widehat{u}_h)$ be the Hybridizable Discontinuous Galerkin (HDG) approximation with polynomial degree $p$ on $\\mathcal{T}_h$, using the discrete spaces\n- $V_h := \\{\\boldsymbol{v} \\in [L^2(\\Omega)]^d : \\boldsymbol{v}|_K \\in [\\mathbb{P}^p(K)]^d \\text{ for all } K \\in \\mathcal{T}_h\\}$,\n- $W_h := \\{w \\in L^2(\\Omega) : w|_K \\in \\mathbb{P}^p(K) \\text{ for all } K \\in \\mathcal{T}_h\\}$,\n- $M_h := \\{\\mu \\in L^2(\\mathcal{E}_h) : \\mu|_F \\in \\mathbb{P}^p(F) \\text{ for all } F \\in \\mathcal{E}_h\\}$,\n\nand a stabilization function $\\tau$ that is piecewise constant on faces and satisfies $c_1 h^{-1} \\le \\tau \\le c_2 h^{-1}$ for some mesh-independent positive constants $c_1$ and $c_2$. Assume standard HDG consistency, stability, and approximation properties hold, and that the dual Poisson problem on $\\Omega$ enjoys elliptic regularity: for any $g \\in L^2(\\Omega)$, the solution $\\phi \\in H_0^1(\\Omega)$ of $-\\Delta \\phi = g$ satisfies $\\|\\phi\\|_{H^2(\\Omega)} \\le C_{\\mathrm{reg}} \\|g\\|_{L^2(\\Omega)}$, with a constant $C_{\\mathrm{reg}}$ depending only on $\\Omega$.\n\nDefine the standard elementwise HDG postprocessing $u_h^\\star \\in \\prod_{K \\in \\mathcal{T}_h} \\mathbb{P}^{p+1}(K)$ by, for each element $K \\in \\mathcal{T}_h$, the conditions\n- $(\\nabla u_h^\\star, \\nabla w)_K = -(\\boldsymbol{q}_h, \\nabla w)_K$ for all $w \\in \\mathbb{P}^{p+1}(K)$ with $(w,1)_K = 0$,\n- $(u_h^\\star, 1)_K = (u_h, 1)_K$.\n\nUsing only the assumptions stated above together with well-tested approximation properties of polynomial $L^2$-projections on shape-regular meshes, derive an a priori bound of the form\n$$\n\\|u - u_h^\\star\\|_{L^2(\\Omega)} \\le C h^q \\|u\\|_{H^{p+2}(\\Omega)},\n$$\nwhere $C$ is independent of $h$ and depends at most on the shape-regularity of $\\mathcal{T}_h$, the stabilization constants $c_1$ and $c_2$, the elliptic regularity constant $C_{\\mathrm{reg}}$, and the polynomial degree $p$. Determine the largest guaranteed exponent $q$ as an explicit function of $p$ that your derivation supports under the stated assumptions. Provide your final answer as a closed-form analytic expression in $p$.",
            "solution": "To estimate the error $\\|u - u_h^\\star\\|_{L^2(\\Omega)}$, we first introduce an auxiliary projection of the exact solution $u$ that shares the structure of the post-processed solution $u_h^\\star$. Let $\\Pi_{p+1}^{\\nabla} u \\in \\prod_{K \\in \\mathcal{T}_h} \\mathbb{P}^{p+1}(K)$ be defined element-wise for each $K \\in \\mathcal{T}_h$ by:\n1. $(\\nabla (\\Pi_{p+1}^{\\nabla} u), \\nabla w)_K = (\\nabla u, \\nabla w)_K$ for all $w \\in \\mathbb{P}^{p+1}(K)$ with $(w,1)_K = 0$.\n2. $(\\Pi_{p+1}^{\\nabla} u, 1)_K = (u, 1)_K$.\n\nWe split the total error $e_u^\\star := u - u_h^\\star$ using the triangle inequality:\n$$\n\\|e_u^\\star\\|_{L^2(\\Omega)} \\le \\|u - \\Pi_{p+1}^{\\nabla} u\\|_{L^2(\\Omega)} + \\|\\Pi_{p+1}^{\\nabla} u - u_h^\\star\\|_{L^2(\\Omega)} =: \\|\\eta_u\\|_{L^2(\\Omega)} + \\|\\xi_h\\|_{L^2(\\Omega)}.\n$$\nWe bound each term separately.\n\n**1. Bounding the projection error $\\|\\eta_u\\|_{L^2(\\Omega)}$**\nThe term $\\eta_u = u - \\Pi_{p+1}^{\\nabla} u$ has zero mean on each element $K$, as $(\\eta_u, 1)_K = (u, 1)_K - (\\Pi_{p+1}^{\\nabla} u, 1)_K = 0$. By the Poincaré-Wirtinger inequality and approximation properties of the projection,\n$$\n\\|\\eta_u\\|_{L^2(K)} \\le C h_K \\|\\nabla \\eta_u\\|_{L^2(K)} = C h_K \\|\\nabla u - \\nabla(\\Pi_{p+1}^{\\nabla} u)\\|_{L^2(K)}.\n$$\nSince $\\nabla(\\Pi_{p+1}^{\\nabla} u)$ is a best approximation to $\\nabla u$ from the space $\\{\\nabla w : w \\in \\mathbb{P}^{p+1}(K)\\}$, and assuming $u \\in H^{p+2}(\\Omega)$, standard polynomial approximation theory gives $\\|\\nabla u - \\nabla(\\Pi_{p+1}^{\\nabla} u)\\|_{L^2(K)} \\le C h_K^{p+1} |u|_{H^{p+2}(K)}$. Combining these gives:\n$$\n\\|\\eta_u\\|_{L^2(K)} \\le C h_K (C h_K^{p+1} |u|_{H^{p+2}(K)}) = C' h_K^{p+2} |u|_{H^{p+2}(K)}.\n$$\nSquaring and summing over all elements yields the first bound:\n$$\n\\|\\eta_u\\|_{L^2(\\Omega)} \\le C h^{p+2} \\|u\\|_{H^{p+2}(\\Omega)}.\n$$\n\n**2. Bounding the discrete error $\\|\\xi_h\\|_{L^2(\\Omega)}$**\nThe term $\\xi_h = \\Pi_{p+1}^{\\nabla} u - u_h^\\star$ belongs to $\\prod_{K \\in \\mathcal{T}_h} \\mathbb{P}^{p+1}(K)$. We decompose it into its element-wise mean value $\\overline{\\xi_h}$ and zero-mean part $\\xi_h^0$, so that $\\|\\xi_h\\|_{L^2(\\Omega)}^2 = \\|\\overline{\\xi_h}\\|_{L^2(\\Omega)}^2 + \\|\\xi_h^0\\|_{L^2(\\Omega)}^2$.\n\n- **Mean part $\\overline{\\xi_h}$:** From the definitions, the element-wise mean of $\\xi_h$ is $(\\xi_h, 1)_K = (u, 1)_K - (u_h, 1)_K = (u-u_h, 1)_K$. Standard HDG theory states that element averages of the scalar error exhibit superconvergence, giving the estimate:\n$$\n\\|\\overline{\\xi_h}\\|_{L^2(\\Omega)} = \\left( \\sum_{K \\in \\mathcal{T}_h} |K| \\left( \\frac{(u-u_h, 1)_K}{|K|} \\right)^2 \\right)^{1/2} \\le C h^{p+2} \\|u\\|_{H^{p+2}(\\Omega)}.\n$$\n\n- **Zero-mean part $\\xi_h^0$:** For any $w \\in \\mathbb{P}^{p+1}(K)$ with $(w,1)_K=0$, we subtract the defining equations for $u_h^\\star$ and $\\Pi_{p+1}^{\\nabla} u$:\n$$\n(\\nabla \\xi_h, \\nabla w)_K = (\\nabla(\\Pi_{p+1}^{\\nabla} u), \\nabla w)_K - (\\nabla u_h^\\star, \\nabla w)_K = (\\nabla u, \\nabla w)_K - (-(\\boldsymbol{q}_h, \\nabla w)_K).\n$$\nUsing $\\boldsymbol{q} = -\\nabla u$, this simplifies to $(\\nabla \\xi_h, \\nabla w)_K = -(\\boldsymbol{q} - \\boldsymbol{q}_h, \\nabla w)_K$. Since $\\xi_h^0$ has zero mean and $\\nabla\\xi_h = \\nabla\\xi_h^0$, we can choose $w = \\xi_h^0$ and apply the Cauchy-Schwarz and Poincaré-Wirtinger inequalities:\n$$\n\\|\\nabla \\xi_h^0\\|_{L^2(K)}^2 = -(\\boldsymbol{q} - \\boldsymbol{q}_h, \\nabla \\xi_h^0)_K \\le \\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|_{L^2(K)} \\|\\nabla \\xi_h^0\\|_{L^2(K)}.\n$$\n$$\n\\|\\xi_h^0\\|_{L^2(K)} \\le C h_K \\|\\nabla \\xi_h^0\\|_{L^2(K)} \\le C h_K \\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|_{L^2(K)}.\n$$\nSquaring and summing over all elements gives $\\|\\xi_h^0\\|_{L^2(\\Omega)} \\le C h \\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|_{L^2(\\Omega)}$. From standard HDG approximation properties, the flux error is bounded by $\\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|_{L^2(\\Omega)} \\le C h^{p+1} \\|u\\|_{H^{p+2}(\\Omega)}$. Therefore,\n$$\n\\|\\xi_h^0\\|_{L^2(\\Omega)} \\le C h (C'h^{p+1} \\|u\\|_{H^{p+2}(\\Omega)}) = C'' h^{p+2} \\|u\\|_{H^{p+2}(\\Omega)}.\n$$\n\n- **Combining bounds for $\\xi_h$:** Combining the bounds for the mean and zero-mean parts gives:\n$$\n\\|\\xi_h\\|_{L^2(\\Omega)} \\le C h^{p+2} \\|u\\|_{H^{p+2}(\\Omega)}.\n$$\n\n**3. Final Bound**\nSumming the bounds for $\\eta_u$ and $\\xi_h$ yields the final error estimate for the post-processed solution:\n$$\n\\|u - u_h^\\star\\|_{L^2(\\Omega)} \\le \\|\\eta_u\\|_{L^2(\\Omega)} + \\|\\xi_h\\|_{L^2(\\Omega)} \\le C h^{p+2} \\|u\\|_{H^{p+2}(\\Omega)}.\n$$\nThe analysis shows that the largest guaranteed convergence exponent is $q = p+2$. This demonstrates that the local post-processing step enhances the accuracy of the HDG scalar solution from the standard rate to a superconverged rate of order $p+2$.",
            "answer": "$$\\boxed{p+2}$$"
        }
    ]
}