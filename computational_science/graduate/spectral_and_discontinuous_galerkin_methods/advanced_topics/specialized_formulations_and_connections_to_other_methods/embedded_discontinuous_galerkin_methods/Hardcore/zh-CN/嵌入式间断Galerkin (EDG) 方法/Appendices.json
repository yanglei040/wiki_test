{
    "hands_on_practices": [
        {
            "introduction": "要掌握任何一种数值方法，最好的起点是将其应用于一个典型的模型问题。本练习将指导你为泊松方程构建嵌入式间断伽辽金(EDG)格式，这是理解该方法核心要素（包括一阶系统、离散空间和迹变量）的绝佳实践。通过推导此基本格式并预测其收敛阶，你将为分析更复杂的问题打下坚实的基础。",
            "id": "3383258",
            "problem": "考虑带有狄利克雷边界条件的标量扩散模型问题：求 $u:\\Omega \\to \\mathbb{R}$ 使得 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 在 $\\Omega=(0,1)^2$ 内成立，且 $u=g$ 在 $\\partial \\Omega$ 上成立，其中 $\\kappa=1$。取人造解 $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ 和源项 $f=\\pi^2 u$，并设 $g=u|_{\\partial \\Omega}$（其恒为零）。从一阶系统表示和单元弱形式出发，推导在 $\\Omega$ 的一个由轴对齐矩形组成的形状规则、拟一致剖分上，多项式次数为 $k=1$ 的嵌入式间断伽辽金（EDG）方法。明确指定单元通量 $q_h$、单元标量场 $u_h$ 和嵌入迹 $\\widehat{u}_h$ 的离散空间，并写出包含数值通量和稳定化参数 $\\tau>0$（该参数在每条边上为常数）的局部 EDG 方程。然后，详细说明在这种矩形网格上，当 $k=1$ 时 EDG 迹空间中的迹连续性约束：解释在内部顶点和内部边上强制施加了何种连续性，以及狄利克雷边界值是如何在 $\\partial \\Omega$ 上被并入的。最后，将能量误差定义为 $\\left(\\sum_{K}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2}$，将 $L^2$ 误差定义为 $\\|u-u_h\\|_{L^2(\\Omega)}$，并在 EDG 方法于拟一致网格上且精确解光滑时所具有的标准稳定性和逼近性质下，提供指数的有序对 $(r_E,r_{L^2})$，使得当 $h\\to 0$ 时，对于 $k=1$ 的情况，这些误差的行为分别像 $C h^{r_E}$ 和 $C h^{r_{L^2}}$。将你的最终答案表示为一个包含这两个指数的单行矩阵。无需四舍五入，不涉及物理单位。",
            "solution": "该问题陈述在科学上是合理的、适定的且客观的。它提出了一个偏微分方程数值分析领域的标准问题，具体涉及嵌入式间断伽辽金（EDG）方法。构建该方法并确定其理论收敛性质所需的所有信息都已提供。\n\n问题始于域 $\\Omega=(0,1)^2$ 上的标量扩散方程：\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = f\n$$\n其中 $\\kappa=1$。这是泊松方程 $-\\nabla^2 u = f$。为了推导该方法，我们将使用一般的源项 $f$。所提供的人造解 $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ 对应的源项是 $f = -\\nabla^2 u = 2\\pi^2\\sin(\\pi x)\\sin(\\pi y) = 2\\pi^2 u$，这与问题中定义的 $f=\\pi^2 u$ 相差一个因子 $2$。这个不一致之处很小，不影响数值方法的推导或其一般收敛性质，而这些才是问题的核心。\n\nEDG 方法首先将二阶偏微分方程改写为一阶系统来构建。我们引入通量变量 $q = -\\kappa \\nabla u$。当 $\\kappa=1$ 时，即为 $q = -\\nabla u$。该系统为：\n$$\n\\begin{cases}\nq + \\nabla u = 0  \\text{在 } \\Omega \\text{ 内} \\\\\n\\nabla \\cdot q = f  \\text{在 } \\Omega \\text{ 内}\n\\end{cases}\n$$\n弱形式是在逐个单元的基础上推导的。设 $\\mathcal{T}_h$ 是 $\\Omega$ 的一个由形状规则、拟一致、轴对齐的矩形 $K$ 组成的剖分。对于任意单元 $K \\in \\mathcal{T}_h$，我们将这两个方程分别乘以向量测试函数 $v_q$ 和标量测试函数 $v_u$，并在 $K$ 上积分：\n$$\n\\int_K (q + \\nabla u) \\cdot v_q \\, dK = 0\n$$\n$$\n\\int_K (\\nabla \\cdot q) v_u \\, dK = \\int_K f v_u \\, dK\n$$\n对散度项应用分部积分，得到：\n$$\n\\int_K q \\cdot v_q \\, dK - \\int_K u (\\nabla \\cdot v_q) \\, dK + \\int_{\\partial K} u (v_q \\cdot n) \\, dS = 0\n$$\n$$\n-\\int_K q \\cdot \\nabla v_u \\, dK + \\int_{\\partial K} (q \\cdot n) v_u \\, dS = \\int_K f v_u \\, dK\n$$\n其中 $n$ 是边界 $\\partial K$ 的外单位法向量。\n\nEDG 方法定义了三个离散变量：近似标量场 $u_h$、近似通量 $q_h$ 和嵌入迹 $\\widehat{u}_h$。对于矩形网格上多项式次数 $k=1$ 的情况，离散空间的定义如下：\n\\begin{itemize}\n    \\item 单元标量场 $u_h$ 属于空间 $U_h = \\{v \\in L^2(\\Omega): v|_K \\in Q_1(K) \\text{ for all } K \\in \\mathcal{T}_h \\}$，其中 $Q_1(K)$ 是矩形 $K$ 上的双线性多项式空间，由 $\\{1, x, y, xy\\}$ 张成。\n    \\item 单元通量 $q_h$ 属于空间 $Q_h = \\{ v_q \\in (L^2(\\Omega))^2: v_q|_K \\in (P_1(K))^2 \\text{ for all } K \\in \\mathcal{T}_h \\}$，其中 $P_1(K)$ 是线性多项式空间。\n    \\item 嵌入迹 $\\widehat{u}_h$ 属于空间 $\\widehat{U}_h = \\{ \\widehat{v} \\in C^0(\\mathcal{E}_h) : \\widehat{v}|_e \\in P_1(e) \\text{ for all } e \\in \\mathcal{E}_h \\}$，其中 $\\mathcal{E}_h$ 是网格骨架（所有单元面的并集）。$C^0(\\mathcal{E}_h)$ 表示骨架上的连续函数空间，$P_1(e)$ 是边 $e$ 上的线性多项式空间。\n\\end{itemize}\n\nEDG 格式是通过在弱形式中用离散对应项和数值通量替换精确解及其边界迹得到的。$u$ 在 $\\partial K$ 上的迹被单值的迹变量 $\\widehat{u}_h$ 替换。通量的法向分量 $q \\cdot n$ 被数值通量 $\\widehat{q}_h \\cdot n$ 替换。一个包含稳定化参数 $\\tau>0$ 的标准数值通量选择是：\n$$\n\\widehat{q}_h \\cdot n = q_h \\cdot n - \\tau(u_h - \\widehat{u}_h)\n$$\n对于任意单元 $K \\in \\mathcal{T}_h$，局部 EDG 方程为：求 $(u_h|_K, q_h|_K) \\in Q_1(K) \\times (P_1(K))^2$，使得对于给定的 $\\partial K$ 上的 $\\widehat{u}_h$：\n$$\n\\int_K q_h \\cdot v_q \\, dK - \\int_K u_h (\\nabla \\cdot v_q) \\, dK + \\int_{\\partial K} \\widehat{u}_h (v_q \\cdot n) \\, dS = 0, \\quad \\forall v_q \\in (P_1(K))^2\n$$\n$$\n-\\int_K q_h \\cdot \\nabla v_u \\, dK + \\int_{\\partial K} (q_h \\cdot n - \\tau(u_h - \\widehat{u}_h)) v_u \\, dS = \\int_K f v_u \\, dK, \\quad \\forall v_u \\in Q_1(K)\n$$\n这些局部方程通过迹变量 $\\widehat{u}_h$ 全局耦合。\n\n连续性约束完全编码在迹空间 $\\widehat{U}_h$ 的定义中。\n\\begin{itemize}\n    \\item **内部顶点：** $\\widehat{U}_h$ 的自由度是函数在网格顶点处的值。对于一个内部顶点 $V$，只有一个未知值 $\\widehat{u}_h(V)$。这个值由所有以 $V$ 为顶点的边共享，从而在顶点处强制施加 $C^0$ 连续性。\n    \\item **内部边：** 对于一个具有顶点 $V_1$ 和 $V_2$ 的内部边 $e$，函数 $\\widehat{u}_h|_e$ 是由值 $\\widehat{u}_{h}(V_1)$ 和 $\\widehat{u}_{h}(V_2)$ 唯一确定的线性多项式。由于 $\\widehat{u}_h$ 在骨架 $\\mathcal{E}_h$ 上是单值的，这同一个线性函数作为共享该边 $e$ 的两个单元的迹。\n    \\item **狄利克雷边界：** 在域边界 $\\partial\\Omega$ 上，$\\widehat{u}_h$ 的值不是未知的，而是由狄利克雷条件 $u=g$ 指定。对于任何顶点 $V \\in \\partial\\Omega$，对应的自由度是固定的：$\\widehat{u}_h(V) = g(V)$。在这个具体问题中，$g=0$，所以对于边界上的所有顶点 $V$，$\\widehat{u}_h(V) = 0$。这意味着 $\\widehat{u}_h \\equiv 0$ 在 $\\partial\\Omega$ 上。\n\\end{itemize}\n\n最后，我们考虑收敛阶。问题将能量误差和 $L^2$ 误差定义为：\n$$\n\\text{能量误差} = \\left(\\sum_{K \\in \\mathcal{T}_h}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2}\n$$\n$$\nL^2 \\text{ 误差} = \\|u-u_h\\|_{L^2(\\Omega)}\n$$\n对于足够光滑的精确解 $u$ 和网格尺寸 $h \\to 0$ 的拟一致网格序列，使用次数为 $k$ 的多项式的 DG 类方法的标准先验误差分析会得到最优收敛阶。EDG 方法作为可杂交 DG (HDG) 方法族的一员，也达到了这些最优阶。\n对于标量变量的 $L^2$ 误差，收敛阶比用于逼近的多项式次数高一阶。\n$$\n\\|u-u_h\\|_{L^2(\\Omega)} = O(h^{k+1})\n$$\n对于能量误差，在破碎的 $H^1$ 半范数意义下，收敛阶由多项式梯度的逼近性质决定。\n$$\n\\left(\\sum_{K \\in \\mathcal{T}_h}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2} = O(h^k)\n$$\n虽然 HDG/EDG 方法以其通量变量 $q_h$ 能达到 $O(h^{k+1})$ 的更高收敛阶而著称，但这种高阶收敛通常不会在没有特殊参数选择或后处理的情况下传递给破碎梯度 $\\nabla u_h$。\n对于指定的多项式次数 $k=1$，误差行为的指数为：\n\\begin{itemize}\n    \\item $r_E = k = 1$。能量误差的行为像 $C h^1$。\n    \\item $r_{L^2} = k+1 = 2$。$L^2$ 误差的行为像 $C h^2$。\n\\end{itemize}\n指数的有序对是 $(r_E, r_{L^2}) = (1, 2)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从基本公式到高效的计算实现，需要对方法的整体架构有清晰的认识。这个练习将挑战你从宏观角度思考，如何利用张量积谱元高效实现高阶EDG方法。它将理论概念（如多项式基和静态凝聚）与实际性能（如求和分解技术）联系起来，为你构建现代求解器提供了一幅蓝图。",
            "id": "3383236",
            "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^d$ 上的标量扩散方程，其具有齐次 Dirichlet 边界条件：求 $u$ 使得\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \\qquad u = 0 \\quad \\text{on } \\partial \\Omega,\n$$\n其中扩散系数 $\\kappa \\in L^\\infty(\\Omega)$ 严格为正，且由一个正常数从下方有界。要在张量积谱元的协调网格上构建一个嵌入式间断 Galerkin (EDG) 方法，其中每个单元 $K$ 是参考超立方体 $\\hat{K} = (-1,1)^d$ 在一个仿射映射下的像。在每个单元上，使用模态张量积 Legendre 基或节点式 Gauss–Lobatto–Legendre (GLL) 基进行阶数不低于 $p \\ge 1$ 的多项式逼近。\n\n使用一阶系统重构，引入 $q = \\kappa \\nabla u$，模型变为\n$$\n\\kappa^{-1} q - \\nabla u = 0 \\quad \\text{in } \\Omega, \\qquad -\\nabla \\cdot q = f \\quad \\text{in } \\Omega,\n$$\n并提出一个 EDG 离散化方案，其包含单元未知量 $(u_h, q_h)$ 和定义在网格骨架上的单值面迹 $\\hat{u}_h$。面迹要求在骨架上的一个合适的多项式空间中是全局连续的，并且 Dirichlet 边界条件要通过该迹来施加。假设使用标准的数值通量，该通量使用迹势 $\\hat{u}_h$ 和一个一致为正且量纲一致的稳定化参数。\n\n基于此基础，推断以下特征：\n- 当使用模态或节点式基时，张量积单元上 $(u_h, q_h)$ 和 $\\hat{u}_h$ 的离散空间；\n- EDG 方法在单元间面上强制 $\\hat{u}_h$ 连续性的机制，以及如何引入边界条件；\n- 单元未知量经过静态凝聚后，凝聚全局系统的结构和定性，以及利用张量积结构通过求和-分解实现的有效局部求解策略，及其关于 $p$ 和 $d$ 的计算复杂度。\n\n哪个选项正确地概述了与这些原则一致的 EDG 实现？\n\nA. 为 $u_h$ 选择阶数为 $p$ 的单元多项式空间 $V_h$，为 $q_h$ 选择 $W_h = [\\mathbb{Q}_p]^d$，并选择一个面迹空间 $\\hat{V}_h$，该空间由在网格骨架上全局 $C^0$ 连续的 $p$ 次多项式组成。通过在边界面上规定 $\\hat{u}_h$ 来施加 Dirichlet 边界条件。在每个单元上，求解一个局部混合系统并静态凝聚 $(u_h, q_h)$ 以获得关于 $\\hat{u}_h$ 的全局对称正定系统。无论是使用模态 Legendre 基还是节点式 Gauss–Lobatto–Legendre 基，都可利用张量积求和-分解技术来应用局部算子，每个单元的成本规模约为 $O(p^{d+1})$，并通过在相邻单元间共享面自由度来强制 $\\hat{u}_h$ 的连续性，从而使迹在每个面以及面的交汇处都是单值的。\n\nB. 保持面迹 $\\hat{u}_h$ 不连续，并仅通过内部罚项来强制单元间的耦合，罚项参数的缩放方式为 $\\alpha p^2 / h$，其中 $h$ 是单元尺寸。得到的迹的凝聚系统是不定的，需要额外的稳定化。模态基破坏了张量积结构，因此求和-分解不适用。\n\nC. 当使用节点式 Gauss–Lobatto–Legendre 基时，必须反演全局质量矩阵来强制 $\\hat{u}_h$ 的连续性，因此单元级的静态凝聚是不可能的，方法失去了局部性。因此，若无全局求解，EDG 无法用节点式张量积基实现。\n\nD. 通过在每个网格顶点和边上引入 Lagrange 乘子来约束跳跃，从而强制 $\\hat{u}_h$ 的连续性。这导致了一个关于 $(\\hat{u}_h,\\lambda)$ 的全局鞍点问题，使得在张量积单元上不可能静态凝聚到单个迹变量。\n\nE. 在张量积单元上，求和-分解将算子应用的成本降低到 $O(p^d)$，且与 $d$ 无关；EDG 的适定性要求迹空间是 $H^{1/2}$-协调的，且在网格顶点处具有 $C^1$ 连续性；$C^0$ 连续性对于扩散问题是不够的。",
            "solution": "用户希望对问题陈述进行严格验证，然后是对给定选项的详细解答和评估。\n\n### 问题验证\n\n**步骤 1：提取给定条件**\n\n-   **控制方程：** 在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^d$ 中，$-\\nabla \\cdot (\\kappa \\nabla u) = f$。\n-   **边界条件：** 在 $\\partial \\Omega$ 上 $u = 0$ (齐次 Dirichlet)。\n-   **扩散系数：** $\\kappa \\in L^\\infty(\\Omega)$，对于某个常数 $\\kappa_0$，有 $\\kappa \\ge \\kappa_0 > 0$。\n-   **一阶重构：** 引入 $q = \\kappa \\nabla u$。系统为：\n    1.  $\\kappa^{-1} q - \\nabla u = 0$，在 $\\Omega$ 中。\n    2.  $-\\nabla \\cdot q = f$，在 $\\Omega$ 中。\n-   **离散化方法：** 嵌入式间断 Galerkin (EDG) 方法。\n-   **网格：** 张量积谱元的协调网格，其中每个单元 $K$ 是参考超立方体 $\\hat{K} = (-1,1)^d$ 的一个仿射映射。\n-   **逼近基：** 在每个单元上，使用模态张量积 Legendre 基或节点式 Gauss–Lobatto–Legendre (GLL) 基，多项式阶数 $p \\ge 1$。\n-   **离散未知量：**\n    -   单元未知量 $(u_h, q_h)$。\n    -   定义在网格骨架上的单值面迹 $\\hat{u}_h$。\n-   **迹空间属性：** $\\hat{u}_h$ 在骨架上的一个合适的多项式空间中是全局连续的。\n-   **数值通量：** 使用标准通量，包含迹势 $\\hat{u}_h$ 和一个一致为正且量纲一致的稳定化参数。\n-   **要求分析：** 推理应涵盖：\n    1.  $(u_h, q_h)$ 和 $\\hat{u}_h$ 的离散空间。\n    2.  $\\hat{u}_h$ 的连续性机制和边界条件的施加方式。\n    3.  静态凝聚后凝聚全局系统的结构和定性，以及使用求和-分解的局部求解的计算复杂度。\n\n**步骤 2：使用提取的给定条件进行验证**\n\n-   **科学依据：** 该问题描述了嵌入式间断 Galerkin (EDG) 方法（也广泛称为可杂交间断 Galerkin (HDG) 方法）在二阶椭圆扩散问题上的一个标准应用。所有概念——偏微分方程、其一阶系统形式、谱元法、张量积基（模态 Legendre 和节点式 GLL）、静态凝聚、求和-分解，以及连续迹变量的定义——在偏微分方程数值分析领域都是成熟且基础的。该问题在科学上和数学上都是合理的。\n-   **适定性：** 该连续问题是一个适定椭圆问题的教科书式例子。所描述的 EDG/HDG 格式是一种标准的、经过充分研究的离散化方法，已知可以得到稳定且收敛的方法。问题的结构旨在测试对该方法关键特征的理解，这是一个适定的教学任务。\n-   **客观性：** 语言正式、技术性强，没有任何主观或模棱两可的术语。所有术语在相关领域都是标准的。\n-   **缺陷清单：** 对照潜在缺陷列表审查问题陈述。\n    1.  *科学/事实不准确*：无。\n    2.  *无法形式化/不相关*：无。问题直接相关且可形式化。\n    3.  *不完整/矛盾的设置*：无。设置为自洽的，足以进行概念分析。\n    4.  *不切实际/不可行*：无。该设置在计算科学中是标准的。\n    5.  *不适定/结构不良*：无。问题清晰。\n    6.  *故作高深/琐碎*：无。该问题需要对现代有限元方法有深入的了解。\n    7.  *超出科学可验证范围*：无。所有论断在数学上都是可验证的。\n\n**步骤 3：结论与行动**\n\n问题陈述是**有效的**。将推导完整的解答。\n\n### 解答推导\n\n针对给定的一阶系统，EDG 方法寻求局部的（单元上的）解 $(u_h, q_h)$ 和定义在网格骨架 $\\mathcal{F}_h$ 上的全局迹解 $\\hat{u}_h$。在一个单元 $K$ 上的弱形式为：\n求 $(u_h, q_h) \\in \\mathbb{Q}_p(K) \\times [\\mathbb{Q}_p(K)]^d$，使得对于所有测试函数 $(v, r) \\in \\mathbb{Q}_p(K) \\times [\\mathbb{Q}_p(K)]^d$：\n$$\n\\int_K \\kappa^{-1} q_h \\cdot r \\,d\\vec{x} - \\int_K u_h (\\nabla \\cdot r) \\,d\\vec{x} + \\int_{\\partial K} \\hat{u}_h (r \\cdot n) \\,dS = 0\n$$\n$$\n\\int_K q_h \\cdot \\nabla v \\,d\\vec{x} - \\int_{\\partial K} (q_h \\cdot n) v \\,dS = -\\int_K f v \\,d\\vec{x}\n$$\n根据分析要求，EDG/HDG方法的关键特征是：\n\n1.  **离散空间：**\n    -   在每个单元 $K$ 内部，标量场 $u_h$ 和向量场 $q_h$ 由多项式逼近。对于阶数为 $p$ 的张量积单元，该空间通常是 $\\mathbb{Q}_p$，即在 $d$ 个变量中每个变量的阶数最多为 $p$ 的多项式空间。所以，$u_h|_K \\in \\mathbb{Q}_p(K)$ 且 $q_h|_K \\in [\\mathbb{Q}_p(K)]^d$。\n    -   迹变量 $\\hat{u}_h$ 定义在网格骨架 $\\mathcal{F}_h$ 上。EDG 的一个定义性特征是 $\\hat{u}_h$ 在单元间面上是单值的。这是通过在骨架上一个全局连续的有限元空间中定义 $\\hat{u}_h$ 来实现的。由于 $\\mathbb{Q}_p(K)$ 中的多项式在一个面上的迹是 $p$ 次多项式，因此迹空间 $\\hat{V}_h$ 由面上分片的 $p$ 次多项式组成，并且是全局连续的 ($C^0$)。\n\n2.  **连续性和边界条件：**\n    -   $\\hat{u}_h$ 的连续性是通过构造空间 $\\hat{V}_h$ 来强制执行的。对于骨架上的节点基，对应于同一几何实体（例如，多个单元共享的顶点或边）的自由度被识别为单个全局自由度。这确保了 $\\hat{u}_h$ 是单值且连续的。\n    -   在 $\\partial\\Omega$ 上的 Dirichlet 边界条件 $u=0$ 是通过将边界骨架 $\\mathcal{F}_h \\cap \\partial\\Omega$ 上 $\\hat{u}_h$ 的相应自由度设置为零来强加于全局迹变量的。\n\n3.  **静态凝聚与系统性质：**\n    -   单元未知量 $(u_h, q_h)$ 完全由源项 $f$ 和边界 $\\partial K$ 上的迹变量 $\\hat{u}_h$ 决定。这允许在每个单元上使用一个局部“求解器”，将 $(u_h, q_h)$ 表示为 $\\hat{u}_h$ 的函数。这个过程称为静态凝聚。\n    -   弱形式的第二个方程，结合通量法向分量在面上的连续性 ($\\sum_{K} \\int_{\\partial K} (q_h\\cdot n) v dS=0$)，产生一个仅涉及 $\\hat{u}_h$ 自由度的全局方程组。\n    -   对于自伴、强制的扩散问题，得到的关于 $\\hat{u}_h$ 的全局系统是对称正定的 (SPD)。\n\n4.  **计算复杂度：**\n    -   每个单元上的局部求解涉及反演单元局部矩阵。\n    -   在组装全局系统或在迭代求解器中，必须应用局部算子的作用。对于张量积单元，这可以通过使用求和-分解来高效完成。\n    -   在一个具有 $N=(p+1)^d$ 个自由度的单元上，标准的矩阵-向量乘积成本为 $O(N^2) = O(p^{2d})$。求和-分解利用了基和算子的张量积结构，将成本降低到 $O(d \\cdot (p+1) \\cdot (p+1)^d) = O(d p^{d+1})$。$O(p^{d+1})$ 的缩放比例是张量积单元上谱方法的一个关键优势。这适用于模态 (Legendre) 基或节点 (GLL) 基，因为两者都是由一维基的张量积构造的。\n\n### 逐项分析\n\n**A. 为 $u_h$ 选择阶数为 $p$ 的单元多项式空间 $V_h$，为 $q_h$ 选择 $W_h = [\\mathbb{Q}_p]^d$，并选择一个面迹空间 $\\hat{V}_h$，该空间由在网格骨架上全局 $C^0$ 连续的 $p$ 次多项式组成。通过在边界面上规定 $\\hat{u}_h$ 来施加 Dirichlet 边界条件。在每个单元上，求解一个局部混合系统并静态凝聚 $(u_h, q_h)$ 以获得关于 $\\hat{u}_h$ 的全局对称正定系统。无论是使用模态 Legendre 基还是节点式 Gauss–Lobatto–Legendre 基，都可利用张量积求和-分解技术来应用局部算子，每个单元的成本规模约为 $O(p^{d+1})$，并通过在相邻单元间共享面自由度来强制 $\\hat{u}_h$ 的连续性，从而使迹在每个面以及面的交汇处都是单值的。**\n\n此选项完美准确且全面地总结了所描述的 EDG/HDG 方法。\n-   多项式空间的选择是标准且正确的。\n-   将迹空间定义为全局 $C^0$ 是该方法的基础。\n-   在迹上施加边界条件是正确的。\n-   对于该问题，通过静态凝聚得到关于 $\\hat{u}_h$ 的对称正定全局系统的过程是正确的。\n-   求和-分解技术对模态和节点式张量积基都适用，以及由此产生的 $O(p^{d+1})$（对于固定的 $d$）的计算复杂度都是正确的。\n-   通过共享自由度来实现 $C^0$ 连续性的机制是正确的实现细节。\n**结论：正确。**\n\n**B. 保持面迹 $\\hat{u}_h$ 不连续，并仅通过内部罚项来强制单元间的耦合，罚项参数的缩放方式为 $\\alpha p^2 / h$，其中 $h$ 是单元尺寸。得到的迹的凝聚系统是不定的，需要额外的稳定化。模态基破坏了张量积结构，因此求和-分解不适用。**\n\n该选项描述的是内部罚分间断 Galerkin (IPDG) 方法，而不是 EDG 方法。\n-   EDG 的定义是具有单值、连续的迹 $\\hat{u}_h$，而不是由罚项耦合的不连续迹。\n-   对于扩散问题，标准 IPDG 方法得到的系统是对称正定的，而不是不定的。\n-   声称模态基破坏张量积结构的说法是错误的；求和-分解是基于基函数的张量积性质，这对模态和节点构造都成立。\n**结论：不正确。**\n\n**C. 当使用节点式 Gauss–Lobatto–Legendre 基时，必须反演全局质量矩阵来强制 $\\hat{u}_h$ 的连续性，因此单元级的静态凝聚是不可能的，方法失去了局部性。因此，若无全局求解，EDG 无法用节点式张量积基实现。**\n\n这个陈述有根本性错误。\n-   $\\hat{u}_h$ 的连续性是通过识别共享网格骨架上的自由度来强制的，而不是通过反演全局质量矩阵。\n-   单元级静态凝聚是 EDG 的一个核心特征，并且与节点基完全兼容。局部求解仅涉及单个单元上的矩阵，与其他单元无关，因此该方法保持其局部性。\n**结论：不正确。**\n\n**D. 通过在每个网格顶点和边上引入 Lagrange 乘子来约束跳跃，从而强制 $\\hat{u}_h$ 的连续性。这导致了一个关于 $(\\hat{u}_h,\\lambda)$ 的全局鞍点问题，使得在张量积单元上不可能静态凝聚到单个迹变量。**\n\n这描述了一种不同的格式。\n-   标准的 EDG 方法直接在连续空间内定义 $\\hat{u}_h$，而不是使用 Lagrange 乘子来对不连续的迹强制施加连续性。\n-   虽然可以构造一种使用 Lagrange 乘子的方法，但这并不是所描述的方法。得到的全局系统将是一个鞍点问题，但 EDG 的核心思想是得到一个关于单个迹变量 $\\hat{u}_h$ 的对称正定系统。\n-   声称静态凝聚“不可能”的说法是不正确的；单元内部变量仍然可以被凝聚掉，留下一个骨架上的系统。\n**结论：不正确。**\n\n**E. 在张量积单元上，求和-分解将算子应用的成本降低到 $O(p^d)$，且与 $d$ 无关；EDG 的适定性要求迹空间是 $H^{1/2}$-协调的，且在网格顶点处具有 $C^1$ 连续性；$C^0$ 连续性对于扩散问题是不够的。**\n\n这个选项包含两个主要错误。\n-   求和-分解的成本是 $O(d p^{d+1})$，而不是 $O(p^d)$。对维度 $d$ 的依赖是线性的，而 $p$ 的指数是 $d+1$。\n-   对于二阶问题，骨架上迹空间所需的正则性是 $H^{1/2}$。全局 $C^0$ 的分片多项式空间是 $H^{1/2}$ 的一个协调子空间。要求 $C^1$ 连续性是不正确的，并且是不必要的限制；$C^1$ 连续性与四阶问题相关。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一种数值方法的真正威力在于其处理非理想情况时的鲁棒性。本练习深入探讨了在各向异性网格上确保EDG方法稳定性的一个关键技术细节：如何明智地选择稳定化参数 $\\tau$。通过分析该参数与网格尺寸及物理属性的依赖关系，你将掌握设计一个在更真实、更复杂的条件下仍能保持稳定性和最优收敛性的数值格式的要领。",
            "id": "3383210",
            "problem": "考虑矩形域 $\\Omega \\subset \\mathbb{R}^2$ 上的标量扩散问题，其带有齐次狄利克雷边界条件：求 $u$ 使得\n$$\n-\\nabla \\cdot \\left(\\mathbf{A}\\,\\nabla u\\right) = f \\quad \\text{in } \\Omega, \n\\qquad u = 0 \\quad \\text{on } \\partial\\Omega,\n$$\n其中扩散张量为对称正定对角矩阵 $\\mathbf{A} = \\mathrm{diag}(a_x, a_y)$，且 $a_x>0$ 和 $a_y>0$。设 $\\mathcal{T}_h$ 是 $\\Omega$ 的一个形状正则剖分，其将 $\\Omega$ 剖分为边长为 $h_x$ 和 $h_y$ 的轴对齐矩形，可能存在各向异性 $h_x \\neq h_y$，但在整个网格上纵横比有界。\n\n我们考虑在 $\\mathcal{T}_h$ 上采用多项式次数为 $k \\ge 1$ 的嵌入间断伽辽金 (EDG) 方法，其中单元未知量 $u_h$ 和网格骨架上的全局单值迹 $\\widehat{u}_h$ 通过每个面 $F$ 上基于面的稳定化（也称为嵌入）参数 $\\tau_F>0$ 进行耦合。在每个具有单位法向量 $\\mathbf{n}_F$ 的内部面 $F$ 上，数值法向通量具有以下形式\n$$\n-\\mathbf{A}\\,\\nabla u_h \\cdot \\mathbf{n}_F \\;+\\; \\tau_F\\,(u_h - \\widehat{u}_h),\n$$\n并在边界面上有一致的选择。假设 $\\tau_F$ 可能依赖于局部单元尺寸和 $\\mathbf{A}$，并且网格是一致的，因此每个竖直面由两个宽度为 $h_x$ 的矩形共享，每个水平面由两个高度为 $h_y$ 的矩形共享。定义垂直于面 $F$ 的网格尺寸为 $h_{n,F}$，因此在竖直面上 $h_{n,F} = h_x$，在水平面上 $h_{n,F} = h_y$，并定义法向扩散率 $\\kappa_F := \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$。\n\n从 EDG 双线性形式的定义、逐单元分部积分、柯西-施瓦茨不等式和杨氏不等式、矩形上的各向异性迹不等式以及标准多项式反不等式出发，确定 $\\tau_F$ 的一个逐面的各向异性缩放，该缩放足以保证 EDG 双线性形式的一致矫顽性，其常数与纵横比 $h_x/h_y$ 无关，并且在标准正则性假设下，该缩放能在破碎能量范数和 $L^2$ 范数中保持最优收敛率。您提出的缩放应以 $k$、$\\kappa_F$ 和 $h_{n,F}$ 表示，并且在竖直面上应简化为涉及 $a_x$ 和 $h_x$ 的缩放，在水平面上应简化为涉及 $a_y$ 和 $h_y$ 的缩放。在以下选项中，选择一个满足这些标准且不会在单元较长的方向过度惩罚面，从而使得凝聚的 EDG 系统的条件数能最优地正比于面法向网格尺寸倒数的平方。\n\n$\\tau_F$ 的哪种选择是合适的？\n\nA. $\\tau_F \\simeq C\\,(k+1)\\,\\dfrac{\\sqrt{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}}{h_{t,F}}$，其中 $h_{t,F}$ 是与 $F$ 相切的网格尺寸， $C>0$ 是一个与 $h_x$, $h_y$, $a_x$, $a_y$ 和 $k$ 无关的通用常数。\n\nB. $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}{h_{n,F}}$，当 $h_{n,F}$ 在面两侧不同时，面的取值为两个相邻单元贡献的最大值；在一致矩形网格上，这在竖直面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_x/h_x$，在水平面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_y/h_y$。\n\nC. $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathrm{tr}(\\mathbf{A})}{(h_x + h_y)}$，统一应用于所有面，不考虑其方向。\n\nD. $\\tau_F \\simeq C\\,(k+1)^2\\,\\max\\!\\left(\\dfrac{a_x}{h_x},\\,\\dfrac{a_y}{h_y}\\right)$，统一应用于所有面，不考虑其方向。\n\nE. $\\tau_F \\simeq C\\,(k+1)^2\\,\\big(\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F\\big)\\,h_{n,F}$，其中 $C>0$ 与 $h_x$, $h_y$, $a_x$, $a_y$ 和 $k$ 无关。\n\n选择正确的选项。",
            "solution": "嵌入间断伽辽金 (EDG) 方法是可杂交间断伽辽金 (HDG) 方法的一种。其稳定性和收敛性分析取决于稳定化参数 $\\tau_F$ 的正确选择，该参数弱施加解在单元面上的连续性。问题要求为在具有各向异性单元的网格上、带有各向异性张量 $\\mathbf{A}$ 的扩散问题，找到 $\\tau_F$ 的一个各向异性缩放。该缩放必须确保迹变量 $\\widehat{u}_h$ 的最终全局系统具有一致矫顽性，保持最优收敛率，并维持全局矩阵的良好条件数，其中相关常数独立于网格纵横比 $h_x/h_y$ 和扩散各向异性 $a_x/a_y$。\n\n稳定化参数的推导源于该方法的稳定性分析。为了使迹变量 $\\widehat{u}_h$ 的全局系统具有矫顽性，必须控制由分部积分产生的某些项。在 DG 类型方法的分析中，一个关键步骤是利用体积积分来界定面积分项。让我们分析这个关键项。经过一些代数运算后，矫顽性证明需要用自然能量范数项 $\\sum_{K \\in \\mathcal{T}_h} \\|\\mathbf{A}^{1/2} \\nabla u_h\\|^2_{L^2(K)}$ 的一部分来界定形如 $\\sum_{K \\in \\mathcal{T}_h} \\sum_{F \\subset \\partial K} \\frac{1}{\\tau_F} \\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla u_h)\\|^2_{L^2(F)}$ 的项。这需要一个如下形式的不等式：\n$$\n\\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla v_h)\\|^2_{L^2(F)} \\le C_{inv} \\frac{\\kappa_F}{h_{n,F}} \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}\n$$\n对于单元 $K$ 上的任意 $k$ 次多项式 $v_h$，其中 $F$ 是 $K$ 的一个面。此处，$C_{inv}$ 是一个依赖于多项式次数 $k$ 但独立于单元几何形状（$h_x$，$h_y$）和扩散张量（$\\mathbf{A}$）的常数。这是一种各向异性迹反不等式。众所周知，其对多项式次数的依赖关系是二次的，即 $C_{inv} \\propto (k+1)^2$。\n\n为理解此不等式为何成立，考虑一个边长为 $h_x$ 和 $h_y$ 的矩形单元 $K$ 和一个竖直面 $F$（因此 $\\mathbf{n}_F = (\\pm 1, 0)^\\top$）。在此面上，$h_{n,F} = h_x$，法向扩散率为 $\\kappa_F = \\mathbf{n}_F^\\top\\mathbf{A}\\mathbf{n}_F = a_x$。需要界定的量是 $\\|a_x \\partial_x v_h\\|^2_{L^2(F)}$。通过缩放到参考单元 $\\hat{K}$，应用针对多项式及其导数的迹不等式，然后缩放回物理单元 $K$，可以证明：\n$$\n\\|a_x \\partial_x v_h\\|^2_{L^2(F)} \\le C(k+1)^2 \\frac{a_x}{h_x} \\left( a_x \\|\\partial_x v_h\\|^2_{L^2(K)} + a_y \\|\\partial_y v_h\\|^2_{L^2(K)} \\right)\n$$\n右侧的项恰好是 $C(k+1)^2 \\frac{\\kappa_F}{h_{n,F}} \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}$。\n类似的论证对水平面也成立。\n\n为保证稳定性，我们必须选择足够大的 $\\tau_F$ 来控制由迹不等式产生的项。具体来说，为了使 $\\sum_{K,F}\\frac{1}{\\tau_F} \\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla v_h)\\|^2_{L^2(F)}$ 可被 $\\sum_K \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}$ 吸收，我们需要选择 $\\tau_F$ 使得：\n$$\n\\tau_F \\ge C_0 (k+1)^2 \\frac{\\kappa_F}{h_{n,F}}\n$$\n对于一个足够大的常数 $C_0 > 0$。这个选择确保了 $\\widehat{u}_h$ 全局系统的矫顽性常数独立于纵横比 $h_x/h_y$ 和扩散各向异性 $a_x/a_y$。\n\n这个缩放也被认为是最优的。一个较小的 $\\tau_F$（例如，$(k+1)$ 的幂次较低或对 $h$ 或 $\\mathbf{A}$ 的依赖关系不同）将无法提供一致稳定性。一个显著较大的 $\\tau_F$（过度惩罚）会降低近似误差界中的常数并污染解，导致次优收敛。它还会不必要地增加系统矩阵的条件数。这个特定的选择不会过度惩罚面，因为在面 $F$ 上，惩罚仅取决于垂直于它的网格尺寸 $h_{n,F}$ 和该法向方向的扩散率 $\\kappa_F$。此性质对于维持凝聚系统的最优条件数至关重要，该条件数应与 $\\max_{F} (h_{n,F}^{-2})$ 成比例缩放，且与任何各向异性无关。\n\n让我们基于此推导来检查给定的选项。$\\tau_F$ 的合适缩放应正比于 $(k+1)^2 \\frac{\\kappa_F}{h_{n,F}}$。\n\n**选项 A: $\\tau_F \\simeq C\\,(k+1)\\,\\dfrac{\\sqrt{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}}{h_{t,F}}$**\n这个选项有几个缺陷。\n1. 对多项式次数的依赖关系是 $(k+1)$，这对于一般的 $k \\ge 1$ 来说不足以保证稳定性。反不等式引入了一个 $(k+1)^2$ 因子。\n2. 对法向扩散率 $\\kappa_F = \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$ 的依赖是通过其平方根 $\\sqrt{\\kappa_F}$，这是不正确的。缩放应与 $\\kappa_F$ 呈线性关系。\n3. 网格尺寸的依赖关系是 $h_{t,F}^{-1}$，即*切向*网格尺寸的倒数。对于各向异性单元，稳定性要求依赖于*法向*网格尺寸 $h_{n,F}^{-1}$。使用 $h_{t,F}$ 会使得在法向短而切向长的单元上，稳定化参数过小，从而导致失去一致稳定性。\n**结论：不正确。**\n\n**选项 B: $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}{h_{n,F}}$，当 $h_{n,F}$ 在面两侧不同时，面的取值为两个相邻单元贡献的最大值；在一致矩形网格上，这在竖直面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_x/h_x$，在水平面上简化为 $\\tau_F \\simeq C\\,(k+1)^2\\,a_y/h_y$。**\n这正是从稳定性分析中推导出的缩放。\n1. 对多项式次数的依赖关系是 $(k+1)^2$。\n2. 对扩散率的依赖关系与 $\\kappa_F = \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$ 呈线性关系。\n3. 对网格尺寸的依赖关系是 $h_{n,F}^{-1}$，即法向网格尺寸的倒数。\n这个选择确保了一致矫顽性，能得到最优误差估计，并且不会过度惩罚，从而保持了凝聚系统的最优条件数。对于一致矩形网格，指定的简化形式也是正确的：在竖直面上，$\\kappa_F = a_x$ 且 $h_{n,F}=h_x$；在水平面上，$\\kappa_F = a_y$ 且 $h_{n,F}=h_y$。\n**结论：正确。**\n\n**选项 C: $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathrm{tr}(\\mathbf{A})}{(h_x + h_y)}$，统一应用于所有面，不考虑其方向。**\n这是一个各向同性缩放，因为它不依赖于面的方向 $\\mathbf{n}_F$。它使用了网格尺寸的算术平均和扩散张量的迹 $\\mathrm{tr}(\\mathbf{A}) = a_x + a_y$。如果一个单元是高度各向异性的，例如 $h_x \\ll h_y$，那么在竖直面上，稳定性要求一个与 $a_x/h_x$ 成正比的惩罚。这个公式提供了一个约为 $(a_x+a_y)/h_y$ 的惩罚，该值可能任意地小于所需值，从而导致失去稳定性。因此，它无法提供一致矫顽性。\n**结论：不正确。**\n\n**选项 D: $\\tau_F \\simeq C\\,(k+1)^2\\,\\max\\!\\left(\\dfrac{a_x}{h_x},\\,\\dfrac{a_y}{h_y}\\right)$，统一应用于所有面，不考虑其方向。**\n这是另一个各向同性缩放。虽然它可能通过取所有可能方向上所需的最大惩罚来保证矫顽性，但它违反了不过度惩罚的准则。例如，如果 $a_x/h_x \\gg a_y/h_y$，这个缩放将大的惩罚 $\\sim a_x/h_x$ 应用于*所有*面，包括那些只需要较小惩罚 $\\sim a_y/h_y$ 的水平面。这种过度惩罚会降低误差估计中的精度常数，并且关键地，会恶化全局系统的条件数，使其依赖于纵横比。\n**结论：不正确。**\n\n**选项 E: $\\tau_F \\simeq C\\,(k+1)^2\\,\\big(\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F\\big)\\,h_{n,F}$，其中 $C>0$ 与 $h_x$, $h_y$, $a_x$, $a_y$ 和 $k$ 无关。**\n这个缩放建议 $\\tau_F \\simeq C(k+1)^2 \\kappa_F h_{n,F}$。网格尺寸依赖是 $h_{n,F}$，而不是 $h_{n,F}^{-1}$。随着网格加密（$h_{n,F} \\to 0$），这个稳定化参数会消失。一个消失的惩罚无法控制跳跃项或通量项，因此该方法将不稳定。惩罚参数必须足够大，而不是小。尽管公式中含有 $(k+1)^2$ 但 $C$ 被说成与 $k$ 无关，这个微小的不一致性并不能改变与 $h_{n,F}$ 的缩放关系从根本上是错误的这一事实。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}