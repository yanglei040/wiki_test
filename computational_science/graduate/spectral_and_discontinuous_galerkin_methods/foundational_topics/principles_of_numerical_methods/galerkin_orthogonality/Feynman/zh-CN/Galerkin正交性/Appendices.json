{
    "hands_on_practices": [
        {
            "introduction": "间断Galerkin (DG) 方法功能强大，但其公式涉及复杂的界面项，这些项对于确保稳定性和一致性至关重要。本练习将引导您详细分析对称内罚DG (IPDG) 方法的代数机理。通过显式推导来自弱形式和IPDG双线性形式的界面贡献，您将揭示确保方法一致性的关键抵消机制，这正是伽辽金正交性的基础。",
            "id": "3388538",
            "problem": "考虑区间 $\\Omega = (0,1)$ 上的一个一维二阶椭圆模型问题，其扩散系数 $k(x)$ 为分段常数，\n$$\n- \\left(k(x)\\,u'(x)\\right)' = f(x) \\quad \\text{in } \\Omega,\n$$\n且带有 Dirichlet 边界条件 $u(0) = g_{0}$ 和 $u(1) = g_{1}$，其中 $f \\in L^{2}(\\Omega)$ 且 $g_{0}, g_{1} \\in \\mathbb{R}$。设网格由两个单元 $K_{1} = (0,x_{\\star})$ 和 $K_{2} = (x_{\\star},1)$ 组成，其内部只有一个交界面（面）$\\Gamma = \\{x_{\\star}\\}$。假设在 $x_{\\star}$ 处，相对于 $K_{1}$ 和 $K_{2}$ 的单位外法向量分别为 $n_{1} = +1$ 和 $n_{2} = -1$。假设在 $K_{1}$ 上 $k(x) = k^{-} > 0$，在 $K_{2}$ 上 $k(x) = k^{+} > 0$。\n\n设 $V_{h}$ 是此网格上的一个不连续多项式空间，并设 $u_{h} \\in V_{h}$ 是通过对称内部罚分片伽辽金 (IPDG) 方法获得的离散解。对于 $w,v \\in V_{h}$，对称 IPDG 双线性形式 $a_{h}(\\cdot,\\cdot)$ 定义为\n$$\na_{h}(w,v) := \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,w'(x)\\,v'(x)\\,\\mathrm{d}x \n\\;-\\; \\int_{\\Gamma} \\big\\{k\\,w'\\big\\}\\,[v]\\,\\mathrm{d}s \n\\;-\\; \\int_{\\Gamma} \\big\\{k\\,v'\\big\\}\\,[w]\\,\\mathrm{d}s \n\\;+\\; \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[w]\\,[v]\\,\\mathrm{d}s,\n$$\n其中 $\\eta > 0$ 是罚参数，$h_{\\Gamma} > 0$ 是与 $\\Gamma$ 相关的特征长度，在 $\\Gamma$ 处的标准跳跃和平均算子为\n$$\n[w] := w^{-} n_{1} + w^{+} n_{2} = w^{-} - w^{+}, \n\\qquad \n\\{q\\} := \\frac{1}{2}\\left(q^{-} + q^{+}\\right),\n$$\n其中 $q^{-}$ 和 $q^{+}$ 分别表示来自 $K_{1}$ 和 $K_{2}$ 的迹。假设数值边界处理与 Dirichlet 边界条件相容，从而使得该方法对于光滑精确解是相容的。\n\n定义误差 $e := u - u_{h}$ 并设 $v_{h} \\in V_{h}$ 为任意函数。你的任务是：\n\n1. 从精确解 $u$ 和逐单元的分部积分恒等式\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,u'\\,v_{h}'\\,\\mathrm{d}x \n= - \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} (k\\,u')'\\,v_{h}\\,\\mathrm{d}x \n+ \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s,\n$$\n出发，推导出在 $\\Gamma$ 处的显式交界面贡献，并用 $\\{k\\,u'\\}$, $[v_{h}]$, $\\{v_{h}\\}$ 和 $[k\\,u']$ 表示。仅使用上述定义，且不假设 $v_{h}$ 具有任何特殊结构。\n\n2. 使用对称 IPDG 形式写出 $a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的显式内部面部分，并利用精确解 $u$ 的正则性性质（即在 $\\Gamma$ 处有 $[u] = 0$ 和 $[k\\,u'] = 0$）来简化它。\n\n3. 指出在步骤1中得到的交界面项与 IPDG 双线性形式中由相容性得到的关于 $u$ 的相应项之间的对消机制。总结出对 $a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的净内部交界面贡献。\n\n将对 $a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的净内部交界面贡献的最终值报告为单个实数。无需四舍五入。",
            "solution": "该问题被评估为**有效**。这是一个偏微分方程数值分析领域中的适定理论问题，具体涉及对称内部罚分片伽辽金 (IPDG) 方法的相容性。所有术语和概念都经过了形式化定义，并且该问题基于已建立的数学原理。\n\n问题的核心是确定内部交界面项对误差 $e := u - u_h$ 的伽辽金正交关系的净贡献。对于一个相容方法，其伽辽金正交关系为对所有测试函数 $v_h \\in V_h$ 都有 $a_h(e, v_h) = 0$。此关系源于格式的相容性，即精确解 $u$ 满足离散方程，即 $a_h(u, v_h) = L_h(v_h)$，其中 $L_h(v_h)$ 是离散载荷向量。由于数值解 $u_h$ 根据定义满足 $a_h(u_h, v_h) = L_h(v_h)$，将这两个方程相减可得 $a_h(u, v_h) - a_h(u_h, v_h) = 0$，即 $a_h(u - u_h, v_h) = 0$。\n\n“净内部交界面贡献”被解释为相容性误差 $a_h(u, v_h) - L_h(v_h)$ 的交界面部分。我们将按照问题中规定的三个步骤来计算这个量。为简化记法，由于交界面 $\\Gamma$ 只包含一个点，形如 $\\int_{\\Gamma} \\phi \\, \\mathrm{d}s$ 的积分对应于在点 $x_{\\star}$ 处对函数 $\\phi$ 的求值。\n\n### 步骤1：来自弱形式的交界面贡献\n\n我们从问题中为精确解 $u$ 提供的逐单元分部积分恒等式开始：\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,u'\\,v_{h}'\\,\\mathrm{d}x = - \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} (k\\,u')'\\,v_{h}\\,\\mathrm{d}x + \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s.\n$$\n由于 $u$ 是 $-\\left(k(x)\\,u'(x)\\right)' = f(x)$ 的精确解，右侧第一项为 $\\sum_{K} \\int_{K} f\\,v_{h}\\,\\mathrm{d}x$。我们关注第二项，该项包含边界和交界面的贡献。积分域为 $\\cup_{K} \\partial K = \\{0\\} \\cup \\{x_{\\star}\\} \\cup \\{x_{\\star}\\} \\cup \\{1\\}$。问题要求在内部交界面 $\\Gamma = \\{x_{\\star}\\}$ 处的贡献。\n\n对单元边界的求和可以写为：\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s = \\int_{\\partial K_{1}} n_{K_{1}}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s + \\int_{\\partial K_{2}} n_{K_{2}}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s.\n$$\n对于单元 $K_1=(0, x_\\star)$，其边界为 $\\partial K_1 = \\{0, x_\\star\\}$。在 $x=0$ 处的外法向量为 $-1$，在 $x=x_\\star$ 处为 $n_1=+1$。对于单元 $K_2=(x_\\star, 1)$，其边界为 $\\partial K_2 = \\{x_\\star, 1\\}$。在 $x=x_\\star$ 处的外法向量为 $n_2=-1$，在 $x=1$ 处为 $+1$。\n\n来自内部交界面 $\\Gamma=\\{x_\\star\\}$ 的贡献是在该点处两个单元求值的和：\n$$\n(n_{K_{1}}\\,k\\,u'\\,v_{h})|_{x=x_{\\star}} + (n_{K_{2}}\\,k\\,u'\\,v_{h})|_{x=x_{\\star}} = (+1)\\,(k\\,u')^{-}\\,v_{h}^{-} + (-1)\\,(k\\,u')^{+}\\,v_{h}^{+}.\n$$\n这个表达式是 $(k\\,u')^{-}v_{h}^{-} - (k\\,u')^{+}v_{h}^{+}$。为了用跳跃和平均算子来表示它，我们使用将迹与平均和跳跃关联起来的恒等式：\n对于一个函数 $w$，$w^{-} = \\{w\\} + \\frac{1}{2}[w]$ 且 $w^{+} = \\{w\\} - \\frac{1}{2}[w]$。对于一个类流量 $q$，其跳跃为 $[q] = q^- n_1 + q^+ n_2 = q^- - q^+$，我们有 $q^{-} = \\{q\\} + \\frac{1}{2}[q]$ 和 $q^{+} = \\{q\\} - \\frac{1}{2}[q]$。\n\n令 $q=k u'$。交界面贡献变为：\n$$\nq^{-}v_{h}^{-} - q^{+}v_{h}^{+} = \\left(\\{q\\} + \\frac{1}{2}[q]\\right)\\left(\\{v_h\\} + \\frac{1}{2}[v_h]\\right) - \\left(\\{q\\} - \\frac{1}{2}[q]\\right)\\left(\\{v_h\\} - \\frac{1}{2}[v_h]\\right)\n$$\n$$\n= \\left( \\{q\\}\\{v_h\\} + \\frac{1}{2}\\{q\\}[v_h] + \\frac{1}{2}[q]\\{v_h\\} + \\frac{1}{4}[q][v_h] \\right) - \\left( \\{q\\}\\{v_h\\} - \\frac{1}{2}\\{q\\}[v_h] - \\frac{1}{2}[q]\\{v_h\\} + \\frac{1}{4}[q][v_h] \\right)\n$$\n$$\n= \\{q\\}[v_h] + [q]\\{v_h\\}.\n$$\n代入 $q=k\\,u'$，来自弱形式的交界面贡献为 $\\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\}$。\n\n### 步骤2：来自 IPDG 形式的交界面贡献\n\nIPDG 双线性形式 $a_{h}(w,v)$ 的内部面部分由下式给出：\n$$\nI(w,v) := - \\int_{\\Gamma} \\{k\\,w'\\}\\,[v]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v'\\}\\,[w]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[w]\\,[v]\\,\\mathrm{d}s.\n$$\n为分析相容性，我们对精确解 $u$ 和任意测试函数 $v_h \\in V_h$ 计算该式：\n$$\nI(u,v_h) = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v_h'\\}\\,[u]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_h]\\,\\mathrm{d}s.\n$$\n问题给出了精确解 $u$ 的正则性性质：它的迹在交界面上是连续的（$[u] = 0$），并且流量也是连续的（$[k\\,u'] = 0$）。\n\n在 $\\Gamma$ 处使用 $[u]=0$， $I(u,v_h)$ 中的第二项和第三项为零：\n$$\nI(u,v_h) = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s - 0 + 0 = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s.\n$$\n问题要求 $a_{h}(u - u_{h}, v_{h})$ 的内部面部分，即 $I(u-u_h, v_h) = I(e,v_h)$。根据算子的线性性，这等于：\n$$\nI(e,v_h) = - \\int_{\\Gamma} \\{k\\,e'\\}\\,[v_{h}]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v_{h}'\\}\\,[e]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[e]\\,[v_{h}]\\,\\mathrm{d}s.\n$$\n\n### 步骤3：对消和净贡献\n\n相容性误差是将精确解代入离散格式后得到的残差：$a_h(u,v_h) - L_h(v_h)$。来自内部交界面对此误差的贡献是在推导中出现的交界面项的总和。这包括来自弱形式的项（步骤1）和来自 DG 双线性形式的项（步骤2）。\n\n根据步骤1，对项 $\\int_K k u' v_h' \\mathrm{d}x$ 进行分部积分产生一个交界面项 $+\\left( \\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\} \\right)$。\n根据步骤2，在双线性形式 $a_h(u, v_h)$ 中定义的交界面项为 $- \\{k\\,u'\\}\\,[v_{h}] - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}]$。\n\n对相容性误差的净交界面贡献是这些部分的总和：\n$$\n\\text{Net Contribution} = \\left( \\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\} \\right) + \\left( -\\{k\\,u'\\}\\,[v_{h}] - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}] \\right).\n$$\n项 $\\{k\\,u'\\}\\,[v_{h}]$ 被对消。这是对称 DG 方法设计的基础“对消机制”。剩下的项是：\n$$\n\\text{Net Contribution} = [k\\,u']\\{v_{h}\\} - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}].\n$$\n现在，我们应用精确解 $u$ 在交界面 $\\Gamma$ 处的正则性性质：\n1. $[u] = 0$ (解的连续性)\n2. $[k\\,u'] = 0$ (流量的连续性)\n\n将这些代入净贡献的表达式中：\n$$\n\\text{Net Contribution} = (0)\\cdot\\{v_{h}\\} - \\{k\\,v_{h}'\\}\\cdot(0) + \\frac{\\eta}{h_{\\Gamma}}\\cdot(0)\\cdot[v_{h}] = 0 - 0 + 0 = 0.\n$$\n来自内部交界面对相容性误差 $a_h(u, v_h) - L_h(v_h)$ 的净贡献，并因此对伽辽金正交表达式 $a_h(u-u_h, v_h)$ 的净贡献为零。这表明对于足够正则的解，IPDG 格式在内部面上是相容的。\n\n因此，对 $a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的净内部交界面贡献的最终值为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在实际计算中，伽辽金方法中的积分通常通过数值求积来近似，这可能会引入误差。本练习探讨了当求积规则的精度不足以精确积分变分形式中的所有项时会发生什么，这种情况被称为“欠积分”。通过计算一个非零的“一致性缺陷”，您将直接观察到伽辽金正交性的破坏，从而理解为维持方法的理论属性而选择恰当求积规则的实际重要性。",
            "id": "3388522",
            "problem": "考虑一维参考单元 $\\Omega = [-1,1]$ 和由双线性形式定义的变系数扩散算子\n$$\na(u,v) := \\int_{-1}^{1} a(x)\\, u'(x)\\, v'(x)\\, dx,\n$$\n其中 $a(x) = 1 + x^{2}$。设逼近空间为次数 $p=2$ 的节点多项式空间，由与高斯-洛巴托-勒让德 (Gauss–Lobatto–Legendre, GLL) 节点相关的拉格朗日基函数张成。对于 $\\Omega$ 上的 $p=2$，GLL 节点位于 $x_{0}=-1$、$x_{1}=0$ 和 $x_{2}=1$，相应的 GLL 求积权重为 $w_{0} = \\tfrac{1}{3}$、$w_{1} = \\tfrac{4}{3}$ 和 $w_{2} = \\tfrac{1}{3}$。具有 $N$ 个节点的 GLL 求积对于次数至多为 $2N-3$ 的多项式是精确的。\n\n定义用 $p=2$ 的 GLL 求积组装的离散刚度双线性形式为\n$$\na_{h}(u,v) := \\sum_{i=0}^{2} w_{i}\\, a(x_{i})\\, u'(x_{i})\\, v'(x_{i})。\n$$\n\n设连续右端项泛函精确地组装为 $l(v) := a(u,v)$，因此精确解 $u$ 对所有容许的 $v$ 满足 $a(u,v)=l(v)$。考虑以下具体选择\n$$\nu(x) = x^{3}, \\qquad v_{h}(x) = \\phi_{+1}(x) := \\frac{x(x+1)}{2},\n$$\n其中 $v_{h}$ 是与右端点节点 $x=1$ 相关的拉格朗日节点基函数。\n\n在欠积分情况下导致伽辽金正交性损失的一致性缺陷，是在欠积分的离散形式中代入精确解检验得到的残差，\n$$\nr_{h}(v_{h}) := l(v_{h}) - a_{h}(u, v_{h}) = a(u, v_{h}) - a_{h}(u, v_{h})。\n$$\n\n精确计算 $r_{h}(v_{h})$ 的值。您的最终答案必须是一个实数。无需四舍五入。",
            "solution": "该问题是有效的。这是一个在偏微分方程数值方法的标准框架内的适定计算问题，具体涉及伽辽金方法中求积误差的分析。所有定义和数据均已提供，并且在数学上是一致的。\n\n目标是计算一致性缺陷 $r_{h}(v_{h})$，其定义为：\n$$\nr_{h}(v_{h}) := a(u, v_{h}) - a_{h}(u, v_{h})\n$$\n这需要计算两项：连续双线性形式 $a(u, v_{h})$ 及其离散近似 $a_{h}(u, v_{h})$。\n\n首先，我们计算连续项 $a(u, v_{h})$。\n连续双线性形式由下式给出：\n$$\na(u,v) = \\int_{-1}^{1} a(x)\\, u'(x)\\, v'(x)\\, dx\n$$\n我们给定的函数是：\n- $u(x) = x^{3}$\n- $v_{h}(x) = \\frac{x(x+1)}{2} = \\frac{1}{2}x^{2} + \\frac{1}{2}x$\n- $a(x) = 1 + x^{2}$\n\n我们首先求 $u(x)$ 和 $v_{h}(x)$ 的导数：\n$$\nu'(x) = \\frac{d}{dx}(x^{3}) = 3x^{2}\n$$\n$$\nv_{h}'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}x^{2} + \\frac{1}{2}x\\right) = x + \\frac{1}{2}\n$$\n接下来，我们构建被积函数 $a(x) u'(x) v_{h}'(x)$：\n$$\na(x) u'(x) v_{h}'(x) = (1 + x^{2})(3x^{2})\\left(x + \\frac{1}{2}\\right)\n$$\n展开这个多项式得到：\n$$\n(3x^{2} + 3x^{4})\\left(x + \\frac{1}{2}\\right) = 3x^{3} + \\frac{3}{2}x^{2} + 3x^{5} + \\frac{3}{2}x^{4}\n$$\n现在，我们在定义域 $\\Omega = [-1,1]$ 上对这个多项式进行积分：\n$$\na(u, v_{h}) = \\int_{-1}^{1} \\left(3x^{5} + \\frac{3}{2}x^{4} + 3x^{3} + \\frac{3}{2}x^{2}\\right) dx\n$$\n一个奇函数（如 $x^{3}$ 和 $x^{5}$）在对称区间 $[-c, c]$ 上的积分为零。因此，奇数次幂的项消失：\n$$\n\\int_{-1}^{1} 3x^{5}\\, dx = 0 \\quad \\text{和} \\quad \\int_{-1}^{1} 3x^{3}\\, dx = 0\n$$\n我们剩下偶数次幂项的积分：\n$$\na(u, v_{h}) = \\int_{-1}^{1} \\left(\\frac{3}{2}x^{4} + \\frac{3}{2}x^{2}\\right) dx\n$$\n由于被积函数是偶函数，我们可以简化积分为：\n$$\na(u, v_{h}) = 2 \\int_{0}^{1} \\left(\\frac{3}{2}x^{4} + \\frac{3}{2}x^{2}\\right) dx = 3 \\int_{0}^{1} (x^{4} + x^{2})\\, dx\n$$\n计算积分：\n$$\na(u, v_{h}) = 3 \\left[ \\frac{x^{5}}{5} + \\frac{x^{3}}{3} \\right]_{0}^{1} = 3 \\left( \\left(\\frac{1^{5}}{5} + \\frac{1^{3}}{3}\\right) - 0 \\right) = 3 \\left( \\frac{1}{5} + \\frac{1}{3} \\right)\n$$\n$$\na(u, v_{h}) = 3 \\left( \\frac{3+5}{15} \\right) = 3 \\left( \\frac{8}{15} \\right) = \\frac{8}{5}\n$$\n\n其次，我们使用高斯-洛巴托-勒让德求积计算离散项 $a_{h}(u, v_{h})$。\n离散双线性形式定义为：\n$$\na_{h}(u,v_{h}) = \\sum_{i=0}^{2} w_{i}\\, a(x_{i})\\, u'(x_{i})\\, v_{h}'(x_{i})\n$$\nGLL 节点为 $x_{0}=-1$、$x_{1}=0$、$x_{2}=1$。权重为 $w_{0} = \\frac{1}{3}$、$w_{1} = \\frac{4}{3}$、$w_{2} = \\frac{1}{3}$。\n\n我们在每个节点上计算被加数的各个分量：\n- 在 $x_{0} = -1$ 处：\n  - $a(x_{0}) = 1 + (-1)^{2} = 2$\n  - $u'(x_{0}) = 3(-1)^{2} = 3$\n  - $v_{h}'(x_{0}) = -1 + \\frac{1}{2} = -\\frac{1}{2}$\n  - 该项为 $w_{0}\\, a(x_{0})\\, u'(x_{0})\\, v_{h}'(x_{0}) = \\frac{1}{3} (2) (3) \\left(-\\frac{1}{2}\\right) = -1$。\n\n- 在 $x_{1} = 0$ 处：\n  - $a(x_{1}) = 1 + 0^{2} = 1$\n  - $u'(x_{1}) = 3(0)^{2} = 0$\n  - $v_{h}'(x_{1}) = 0 + \\frac{1}{2} = \\frac{1}{2}$\n  - 该项为 $w_{1}\\, a(x_{1})\\, u'(x_{1})\\, v_{h}'(x_{1}) = \\frac{4}{3} (1) (0) \\left(\\frac{1}{2}\\right) = 0$。\n\n- 在 $x_{2} = 1$ 处：\n  - $a(x_{2}) = 1 + 1^{2} = 2$\n  - $u'(x_{2}) = 3(1)^{2} = 3$\n  - $v_{h}'(x_{2}) = 1 + \\frac{1}{2} = \\frac{3}{2}$\n  - 该项为 $w_{2}\\, a(x_{2})\\, u'(x_{2})\\, v_{h}'(x_{2}) = \\frac{1}{3} (2) (3) \\left(\\frac{3}{2}\\right) = 3$。\n\n将这三项相加得到 $a_{h}(u, v_{h})$ 的值：\n$$\na_{h}(u, v_{h}) = -1 + 0 + 3 = 2\n$$\n问题说明，具有 $N=p+1=3$ 个节点的 $p=2$ GLL 求积对于次数至多为 $2N-3=2(3)-3=3$ 的多项式是精确的。被积函数是一个 5 次多项式，所以该求积不是精确的，这是一致性缺陷的来源。\n\n最后，我们计算一致性缺陷 $r_{h}(v_{h})$：\n$$\nr_{h}(v_{h}) = a(u, v_{h}) - a_{h}(u, v_{h}) = \\frac{8}{5} - 2 = \\frac{8}{5} - \\frac{10}{5} = -\\frac{2}{5}\n$$",
            "answer": "$$\n\\boxed{-\\frac{2}{5}}\n$$"
        },
        {
            "introduction": "伽辽金正交性不仅是一个抽象的数学性质，它还是分析和控制数值误差的强大工具。本练习将深入探讨后验误差估计领域，特别是针对我们感兴趣的某个特定物理量（或“目标泛函”）的误差估计。您将看到伽辽金正交性是如何成为推导涉及对偶问题的精确误差表达式的关键，这构成了可计算的、有保证的误差界的基础，展示了理论性质如何转化为强大的计算工具。",
            "id": "3388529",
            "problem": "考虑单位区间 $[0,1]$ 上的标量扩散模型问题：求 $u \\in H_{0}^{1}(0,1)$，使得\n$$\na(u,v) = \\ell(v) \\quad \\text{对所有 } v \\in H_{0}^{1}(0,1),\n$$\n其中双线性形式为 $a(w,v) := \\int_{0}^{1} w'(x)\\,v'(x)\\,dx$，线性形式为 $\\ell(v) := \\int_{0}^{1} f(x)\\,v(x)\\,dx$，且 $f(x) \\equiv 2$。设目标泛函为 $J(v) := \\int_{0}^{1} v(x)\\,dx$。设 $V_{h}$ 是 $H_{0}^{1}(0,1)$ 的协调子空间，由网格 $0 \\tfrac{1}{2} 1$ 上与中点 $x=\\tfrac{1}{2}$ 相关联的单个连续分片线性帽子函数 $\\varphi$ 张成。设 $u_{h}\\in V_{h}$ 为 Galerkin 近似解，使得对于所有 $v_{h} \\in V_{h}$ 都有 $a(u_{h},v_{h})=\\ell(v_{h})$。\n\n1. 仅从弱形式和目标泛函的定义出发，构建对偶问题：求 $z \\in H_{0}^{1}(0,1)$，使得对于所有 $v \\in H_{0}^{1}(0,1)$ 都有 $a(v,z)=J(v)$。使用 Galerkin 正交性，推导误差表示恒等式\n$$\nJ(u-u_{h}) \\;=\\; a(u-u_{h},\\,z-z_{h})\n$$\n其中 $z_{h} \\in V_{h}$ 为任意函数。\n\n2. 在一维空间中，定义对偶通量 $q_{z} := -z'$，它属于空间 $H^{1}(0,1)$，因此在一维中是 $H(\\mathrm{div})$-协调的。通过取 $\\widehat{q}_{z} := q_{z}$ 来构造平衡对偶通量重构 $\\widehat{q}_{z}$，并验证它在强意义下精确满足局部平衡条件 $\\frac{d}{dx}\\widehat{q}_{z} = 1$。证明将第1部分的恒等式与单元分部积分相结合，可以得到保证的目标误差界，该界可简化为精确恒等式\n$$\nJ(u-u_{h}) \\;=\\; \\int_{0}^{1} (u(x)-u_{h}(x))\\,\\frac{d}{dx}\\widehat{q}_{z}(x)\\,dx,\n$$\n因此，在选择平衡的 $\\widehat{q}_{z}=q_{z}$ 时，可简化为\n$$\nJ(u-u_{h}) \\;=\\; \\int_{0}^{1} (u(x)-u_{h}(x))\\,dx.\n$$\n\n3. 对于给定的数据 $f(x)\\equiv 2$ 和网格，显式计算 $u$ 和 $u_{h}$。然后，评估第2部分中的保证界（在此设置中是精确的），以获得 $J(u-u_{h})$ 的一个实数值。以精确形式表示最终答案（无需四舍五入）。",
            "solution": "该问题已经过验证，被认为是适定的、有科学依据且自洽的。确定唯一解所需的所有定义和数据均已提供。\n\n问题分为三个部分。我们将按顺序逐一解决。\n\n第1部分：误差表示恒等式的推导\n\n目标是推导恒等式 $J(u-u_{h}) = a(u-u_{h}, z-z_{h})$，其中 $z_{h} \\in V_{h}$ 为任意函数。\n\n目标泛函中的误差表示为 $J(u-u_{h})$。根据泛函 $J$ 的线性性质，我们有 $J(u-u_{h}) = J(u) - J(u_h)$，但这不是指定的推导路径。我们从对偶问题的定义开始。\n\n对偶问题定义为：求 $z \\in H_{0}^{1}(0,1)$，使得对于所有 $v \\in H_{0}^{1}(0,1)$，都有 $a(v,z) = J(v)$。\n设原始解的误差为 $e := u-u_h$。由于 $u \\in H_{0}^{1}(0,1)$ 且 $u_h \\in V_h \\subset H_{0}^{1}(0,1)$，误差 $e$ 也在 $H_{0}^{1}(0,1)$ 中。\n因此，我们可以在对偶问题的定义中令 $v=e=u-u_h$：\n$$\nJ(u-u_{h}) = a(u-u_{h}, z)\n$$\n这是第一步。接下来，我们从离散空间 $V_h$ 中引入一个任意函数 $z_h$。由于 $V_h$ 是 $H_0^1(0,1)$ 的子空间，所以 $z_h \\in H_0^1(0,1)$。\n\nGalerkin 正交性是 Galerkin 近似解 $u_h$ 的一个性质。它表明误差 $u-u_h$ 相对于双线性形式 $a(\\cdot, \\cdot)$ 与子空间 $V_h$ 正交。在数学上，这表示为：\n$$\na(u-u_h, v_h) = 0 \\quad \\text{对所有 } v_h \\in V_h\n$$\n这是通过从连续弱形式中减去离散弱形式得到的：$a(u,v_h) = \\ell(v_h)$ 和 $a(u_h, v_h) = \\ell(v_h)$。相减得到 $a(u,v_h) - a(u_h, v_h) = 0$，根据 $a(\\cdot, \\cdot)$ 的线性性质，有 $a(u-u_h, v_h) = 0$。\n\n由于 $z_h$ 是 $V_h$ 的任意元素，我们可以在 Galerkin 正交性条件中令 $v_h = z_h$ 得到：\n$$\na(u-u_h, z_h) = 0\n$$\n现在，我们可以从目标误差的表达式中减去这个零量：\n$$\nJ(u-u_{h}) = a(u-u_{h}, z) - a(u-u_{h}, z_{h})\n$$\n利用双线性形式 $a(\\cdot, \\cdot)$ 在其第二个参数上的线性性质，我们可以合并右侧的项：\n$$\nJ(u-u_{h}) = a(u-u_{h}, z-z_{h})\n$$\n这对于 $V_h$ 中任意选择的 $z_h$ 都成立。至此完成了第一部分的推导。\n\n第2部分：对偶通量和误差恒等式简化\n\n首先，我们求解对偶问题以求出 $z(x)$。对偶问题的弱形式是 $\\int_{0}^{1} v'(x)z'(x)dx = \\int_{0}^{1} v(x)dx$，对所有 $v \\in H_0^1(0,1)$ 成立。假设 $z$ 具有足够的光滑性，我们可以进行分部积分：\n$$\n\\int_{0}^{1} v'(x)z'(x)dx = [v(x)z'(x)]_{0}^{1} - \\int_{0}^{1} v(x)z''(x)dx\n$$\n由于 $v \\in H_{0}^{1}(0,1)$，我们有 $v(0)=v(1)=0$，所以边界项消失。弱形式变为：\n$$\n-\\int_{0}^{1} v(x)z''(x)dx = \\int_{0}^{1} v(x) \\cdot 1 dx\n$$\n根据变分法基本引理，这蕴含了对偶问题的强形式：$-z''(x)=1$，其中 $x \\in (0,1)$，边界条件为 $z(0)=z(1)=0$。\n积分两次得到 $z(x) = -\\frac{x^2}{2} + C_1 x + C_2$。\n应用边界条件：\n$z(0) = C_2 = 0$。\n$z(1) = -\\frac{1}{2} + C_1 = 0 \\implies C_1 = \\frac{1}{2}$。\n精确对偶解为 $z(x) = \\frac{x(1-x)}{2}$。该解在 $H^2(0,1)$ 中，这使得分部积分是合理的。\n\n对偶通量为 $q_z := -z'$。我们计算 $z'(x) = -x + \\frac{1}{2}$，所以 $q_z(x) = x - \\frac{1}{2}$。问题将平衡对偶通量重构定义为 $\\widehat{q}_z := q_z = x - \\frac{1}{2}$。\n我们验证局部平衡条件：\n$$\n\\frac{d}{dx}\\widehat{q}_{z}(x) = \\frac{d}{dx}\\left(x - \\frac{1}{2}\\right) = 1\n$$\n这在强意义下对所有 $x \\in (0,1)$ 成立。右侧的源项（$1$）对应于对偶问题中的分布载荷，它源于泛函 $J(v) = \\int_0^1 1 \\cdot v(x) dx$ 的定义。\n\n现在，我们证明第1部分的恒等式可以导出指定的积分形式。我们从恒等式 $J(u-u_h) = a(u-u_h, z-z_h)$ 开始。从第1部分我们知道，Galerkin 正交性意味着 $a(u-u_h, z_h) = 0$。因此：\n$$\nJ(u-u_h) = a(u-u_h, z-z_h) = a(u-u_h, z) - a(u-u_h, z_h) = a(u-u_h, z)\n$$\n现在我们使用 $a(\\cdot,\\cdot)$ 和对偶通量的定义：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u-u_h)'(x) z'(x) dx = \\int_{0}^{1} (u-u_h)'(x) (-q_z(x)) dx\n$$\n当选择 $\\widehat{q}_z = q_z$ 时，这变为：\n$$\nJ(u-u_h) = -\\int_{0}^{1} (u-u_h)'(x) \\widehat{q}_z(x) dx\n$$\n我们进行分部积分。令 $e(x) = u(x)-u_h(x)$。\n$$\nJ(e) = - \\left( [e(x) \\widehat{q}_z(x)]_{0}^{1} - \\int_{0}^{1} e(x) \\frac{d}{dx}\\widehat{q}_z(x) dx \\right)\n$$\n由于 $u, u_h \\in H_0^1(0,1)$，我们有 $e(0) = u(0)-u_h(0) = 0-0=0$ 和 $e(1)=u(1)-u_h(1)=0-0=0$。边界项 $[e(x)\\widehat{q}_z(x)]_0^1$ 为零。剩下：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x)-u_h(x)) \\frac{d}{dx}\\widehat{q}_z(x) dx\n$$\n这是要求我们推导的第一个恒等式。\n最后，使用平衡性质 $\\frac{d}{dx}\\widehat{q}_z(x) = 1$，我们将其代入恒等式：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x)-u_h(x)) \\cdot 1 \\, dx\n$$\n这个最终的恒等式，虽然看起来是同义反复，因为它就是 $J(u-u_h)$ 的定义，但它是从误差表示公式 $J(u-u_h) = a(u-u_h, z-z_h)$ 严格推导出来的，证明了该理论框架的一致性。\n\n第3部分：显式计算\n\n首先，我们计算精确解 $u(x)$。原始问题的强形式是 $-u''(x) = f(x) = 2$，在 $(0,1)$ 上，且 $u(0)=u(1)=0$。\n第一次积分得到 $u'(x) = -2x + C_1$。\n第二次积分得到 $u(x) = -x^2 + C_1 x + C_2$。\n应用边界条件：\n$u(0) = C_2 = 0$。\n$u(1) = -1 + C_1 = 0 \\implies C_1 = 1$。\n精确解为 $u(x) = x - x^2$。\n\n接下来，我们计算 Galerkin 近似解 $u_h(x) \\in V_h$。空间 $V_h$ 由单个基函数 $\\varphi(x)$ 张成，该函数是满足 $\\varphi(\\frac{1}{2})=1$ 和 $\\varphi(0)=\\varphi(1)=0$ 的分片线性帽子函数。其显式形式为：\n$$\n\\varphi(x) = \\begin{cases} 2x  \\text{若 } 0 \\le x \\le 1/2 \\\\ 2(1-x)  \\text{若 } 1/2 \\le x \\le 1 \\end{cases}\n$$\n解 $u_h(x)$ 可以写成 $u_h(x) = c_1 \\varphi(x)$ 的形式，其中 $c_1$ 是某个系数。Galerkin 系统为 $a(u_h, \\varphi) = \\ell(\\varphi)$。\n代入 $u_h = c_1 \\varphi$：\n$c_1 a(\\varphi, \\varphi) = \\ell(\\varphi)$。\n我们计算这些项。$\\varphi(x)$ 的导数为 $\\varphi'(x) = 2$ (当 $x \\in (0, \\frac{1}{2})$ 时) 和 $\\varphi'(x) = -2$ (当 $x \\in (\\frac{1}{2}, 1)$ 时)。\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} (\\varphi'(x))^2 dx = \\int_{0}^{1/2} 2^2 dx + \\int_{1/2}^{1} (-2)^2 dx = 4 \\cdot \\frac{1}{2} + 4 \\cdot \\frac{1}{2} = 4\n$$\n$$\n\\ell(\\varphi) = \\int_{0}^{1} f(x)\\varphi(x)dx = \\int_{0}^{1} 2 \\varphi(x) dx = 2 \\int_{0}^{1} \\varphi(x)dx\n$$\n积分 $\\int_{0}^{1} \\varphi(x)dx$ 是一个底为1、高为1的三角形的面积，即 $\\frac{1}{2}$。\n所以，$\\ell(\\varphi) = 2 \\cdot \\frac{1}{2} = 1$。\n关于 $c_1$ 的方程是 $c_1 \\cdot 4 = 1$，解得 $c_1 = \\frac{1}{4}$。\nGalerkin 近似解为 $u_h(x) = \\frac{1}{4}\\varphi(x)$。\n\n最后，我们计算目标泛函中的误差值 $J(u-u_h)$。使用第2部分中的恒等式，该恒等式在本例中是精确的：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x) - u_h(x)) dx = \\int_{0}^{1} u(x) dx - \\int_{0}^{1} u_h(x) dx\n$$\n我们分别计算每个积分：\n$$\n\\int_{0}^{1} u(x) dx = \\int_{0}^{1} (x - x^2) dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{3-2}{6} = \\frac{1}{6}\n$$\n$$\n\\int_{0}^{1} u_h(x)dx = \\int_{0}^{1} \\frac{1}{4}\\varphi(x)dx = \\frac{1}{4} \\int_{0}^{1} \\varphi(x)dx = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}\n$$\n目标误差的值为：\n$$\nJ(u-u_h) = \\frac{1}{6} - \\frac{1}{8} = \\frac{4}{24} - \\frac{3}{24} = \\frac{1}{24}\n$$\n这是最终的数值结果。",
            "answer": "$$\n\\boxed{\\frac{1}{24}}\n$$"
        }
    ]
}