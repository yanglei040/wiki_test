{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解伽辽金正交性，我们必须首先探究数值方法是如何被构建以确保其一致性的。本练习将引导您深入剖析对称内罚间断伽辽金 (IPDG) 方法的核心机制。通过在一个简单的一维双单元网格上进行推导，您将亲手揭示该方法中精心设计的界面项如何为精确解抵消为零，从而为伽辽金正交性的建立奠定坚实基础。",
            "id": "3388538",
            "problem": "考虑在区间 $\\Omega = (0,1)$ 上的一个一维二阶椭圆模型问题，其扩散系数 $k(x)$ 为分段常数，\n$$\n- \\left(k(x)\\,u'(x)\\right)' = f(x) \\quad \\text{在 } \\Omega \\text{ 中},\n$$\n并带有 Dirichlet 边界条件 $u(0) = g_{0}$ 和 $u(1) = g_{1}$，其中 $f \\in L^{2}(\\Omega)$ 且 $g_{0}, g_{1} \\in \\mathbb{R}$。设网格由两个单元 $K_{1} = (0,x_{\\star})$ 和 $K_{2} = (x_{\\star},1)$ 组成，具有一个单一的内部界面（面）$\\Gamma = \\{x_{\\star}\\}$，并假设在 $x_{\\star}$ 处相对于 $K_{1}$ 和 $K_{2}$ 的外单位法向量分别为 $n_{1} = +1$ 和 $n_{2} = -1$。假定在 $K_{1}$ 上 $k(x) = k^{-} > 0$ 且在 $K_{2}$ 上 $k(x) = k^{+} > 0$。\n\n令 $V_{h}$ 为此网格上的一个不连续多项式空间，并令 $u_{h} \\in V_{h}$ 为通过对称内罚不连续 Galerkin (IPDG) 方法得到的离散解。对于 $w,v \\in V_{h}$，对称 IPDG 双线性形式 $a_{h}(\\cdot,\\cdot)$ 定义为\n$$\na_{h}(w,v) := \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,w'(x)\\,v'(x)\\,\\mathrm{d}x \n\\;-\\; \\int_{\\Gamma} \\big\\{k\\,w'\\big\\}\\,[v]\\,\\mathrm{d}s \n\\;-\\; \\int_{\\Gamma} \\big\\{k\\,v'\\big\\}\\,[w]\\,\\mathrm{d}s \n\\;+\\; \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[w]\\,[v]\\,\\mathrm{d}s,\n$$\n其中 $\\eta > 0$ 是罚参数，$h_{\\Gamma} > 0$ 是与 $\\Gamma$ 相关的特征长度，在 $\\Gamma$ 处的标准跳跃和平均算子为\n$$\n[w] := w^{-} n_{1} + w^{+} n_{2} = w^{-} - w^{+}, \n\\qquad \n\\{q\\} := \\frac{1}{2}\\left(q^{-} + q^{+}\\right),\n$$\n其中 $q^{-}$ 和 $q^{+}$ 分别表示来自 $K_{1}$ 和 $K_{2}$ 的迹。假设数值边界处理与 Dirichlet 边界条件一致，从而该方法对于光滑精确解是一致的。\n\n定义误差 $e := u - u_{h}$，并令 $v_{h} \\in V_{h}$ 为任意函数。您的任务是：\n\n1. 从精确解 $u$ 和逐单元分部积分恒等式\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,u'\\,v_{h}'\\,\\mathrm{d}x \n= - \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} (k\\,u')'\\,v_{h}\\,\\mathrm{d}x \n+ \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s,\n$$\n出发，推导出在 $\\Gamma$ 处的显式界面贡献，并用 $\\{k\\,u'\\}$、$[v_{h}]$、$\\{v_{h}\\}$ 和 $[k\\,u']$ 来表示它。仅使用上述定义，不要假设 $v_{h}$ 有任何特殊结构。\n\n2. 使用对称 IPDG 形式，写出 $a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的显式内部界面部分，并利用精确解 $u$ 的正则性（即在 $\\Gamma$ 处有 $[u] = 0$ 和 $[k\\,u'] = 0$）来简化它。\n\n3. 识别在步骤 1 中得到的界面项与 IPDG 双线性形式中由一致性产生的对应于 $u$ 的项之间的抵消机制。总结出 $a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的净内部界面贡献。\n\n将 $a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的净内部界面贡献的最终值报告为一个实数。无需四舍五入。",
            "solution": "该问题被评估为**有效**。这是一个在偏微分方程数值分析领域中关于对称内罚不连续 Galerkin (IPDG) 方法一致性的适定理论问题。所有术语和概念都得到了正式定义，并且该问题建立在公认的数学原理之上。\n\n问题的核心是确定内部界面项对误差 $e := u - u_h$ 的 Galerkin 正交关系 $a_h(e, v_h) = 0$ 的净贡献，该关系对所有测试函数 $v_h \\in V_h$ 成立。此关系源于格式的一致性，即精确解 $u$ 满足离散方程，也即 $a_h(u, v_h) = L_h(v_h)$，其中 $L_h(v_h)$ 是离散载荷向量。由于数值解 $u_h$ 根据定义满足 $a_h(u_h, v_h) = L_h(v_h)$，将这两个方程相减可得 $a_h(u, v_h) - a_h(u_h, v_h) = 0$，即 $a_h(u - u_h, v_h) = 0$。\n\n“净内部界面贡献”被解释为一致性误差 $a_h(u, v_h) - L_h(v_h)$ 的界面部分。我们将按照问题中规定的三个步骤来计算这个量。为简化符号，由于界面 $\\Gamma$ 仅包含一个点，形如 $\\int_{\\Gamma} \\phi \\, \\mathrm{d}s$ 的积分对应于在点 $x_{\\star}$ 处对函数 $\\phi$ 的求值。\n\n### 步骤 1：来自弱形式的界面贡献\n\n我们从为精确解 $u$ 提供的逐单元分部积分恒等式开始：\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} k\\,u'\\,v_{h}'\\,\\mathrm{d}x = - \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} (k\\,u')'\\,v_{h}\\,\\mathrm{d}x + \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s.\n$$\n由于 $u$ 是 $-\\left(k(x)\\,u'(x)\\right)' = f(x)$ 的精确解，右侧第一项为 $\\sum_{K} \\int_{K} f\\,v_{h}\\,\\mathrm{d}x$。我们关注第二项，它包含了边界和界面的贡献。积分区域是 $\\cup_{K} \\partial K = \\{0\\} \\cup \\{x_{\\star}\\} \\cup \\{x_{\\star}\\} \\cup \\{1\\}$。问题要求的是在内部界面 $\\Gamma = \\{x_{\\star}\\}$ 处的贡献。\n\n对单元边界的求和可以写为：\n$$\n\\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{\\partial K} n_{K}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s = \\int_{\\partial K_{1}} n_{K_{1}}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s + \\int_{\\partial K_{2}} n_{K_{2}}\\,k\\,u'\\,v_{h}\\,\\mathrm{d}s.\n$$\n对于单元 $K_1=(0, x_\\star)$，边界是 $\\partial K_1 = \\{0, x_\\star\\}$。在 $x=0$ 处的外法向量是 $-1$，在 $x=x_\\star$ 处是 $n_1=+1$。\n对于单元 $K_2=(x_\\star, 1)$，边界是 $\\partial K_2 = \\{x_\\star, 1\\}$。在 $x=x_\\star$ 处的外法向量是 $n_2=-1$，在 $x=1$ 处是 $+1$。\n\n来自内部界面 $\\Gamma=\\{x_\\star\\}$ 的贡献是在此点上两个单元求值的总和：\n$$\n(n_{K_{1}}\\,k\\,u'\\,v_{h})|_{x=x_{\\star}} + (n_{K_{2}}\\,k\\,u'\\,v_{h})|_{x=x_{\\star}} = (+1)\\,(k\\,u')^{-}\\,v_{h}^{-} + (-1)\\,(k\\,u')^{+}\\,v_{h}^{+}.\n$$\n此表达式为 $(k\\,u')^{-}v_{h}^{-} - (k\\,u')^{+}v_{h}^{+}$。为了用跳跃和平均算子来表示它，我们使用将迹与平均值和跳跃值联系起来的恒等式：\n对于函数 $w$，有 $w^{-} = \\{w\\} + \\frac{1}{2}[w]$ 和 $w^{+} = \\{w\\} - \\frac{1}{2}[w]$。\n对于类通量 $q$，其跳跃为 $[q] = q^- n_1 + q^+ n_2 = q^- - q^+$，我们有 $q^{-} = \\{q\\} + \\frac{1}{2}[q]$ 和 $q^{+} = \\{q\\} - \\frac{1}{2}[q]$。\n\n令 $q=k u'$。界面贡献变为：\n$$\nq^{-}v_{h}^{-} - q^{+}v_{h}^{+} = \\left(\\{q\\} + \\frac{1}{2}[q]\\right)\\left(\\{v_h\\} + \\frac{1}{2}[v_h]\\right) - \\left(\\{q\\} - \\frac{1}{2}[q]\\right)\\left(\\{v_h\\} - \\frac{1}{2}[v_h]\\right)\n$$\n$$\n= \\left( \\{q\\}\\{v_h\\} + \\frac{1}{2}\\{q\\}[v_h] + \\frac{1}{2}[q]\\{v_h\\} + \\frac{1}{4}[q][v_h] \\right) - \\left( \\{q\\}\\{v_h\\} - \\frac{1}{2}\\{q\\}[v_h] - \\frac{1}{2}[q]\\{v_h\\} + \\frac{1}{4}[q][v_h] \\right)\n$$\n$$\n= \\{q\\}[v_h] + [q]\\{v_h\\}.\n$$\n代入 $q=k\\,u'$，来自弱形式的界面贡献是 $\\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\}$。\n\n### 步骤 2：来自 IPDG 形式的界面贡献\n\nIPDG 双线性形式 $a_{h}(w,v)$ 的内部界面部分由下式给出：\n$$\nI(w,v) := - \\int_{\\Gamma} \\{k\\,w'\\}\\,[v]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v'\\}\\,[w]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[w]\\,[v]\\,\\mathrm{d}s.\n$$\n为了分析一致性，我们对精确解 $u$ 和任意测试函数 $v_h \\in V_h$ 计算此式：\n$$\nI(u,v_h) = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v_h'\\}\\,[u]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_h]\\,\\mathrm{d}s.\n$$\n问题提供了精确解 $u$ 的正则性：其迹在界面上是连续的（$[u] = 0$），并且通量也是连续的（$[k\\,u'] = 0$）。\n\n在 $\\Gamma$ 处使用 $[u]=0$， $I(u,v_h)$ 中的第二项和第三项消失：\n$$\nI(u,v_h) = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s - 0 + 0 = - \\int_{\\Gamma} \\{k\\,u'\\}\\,[v_h]\\,\\mathrm{d}s.\n$$\n问题要求 $a_{h}(u - u_{h}, v_{h})$ 的内部界面部分，即 $I(u-u_h, v_h) = I(e,v_h)$。根据算子的线性性质，这等于：\n$$\nI(e,v_h) = - \\int_{\\Gamma} \\{k\\,e'\\}\\,[v_{h}]\\,\\mathrm{d}s - \\int_{\\Gamma} \\{k\\,v_{h}'\\}\\,[e]\\,\\mathrm{d}s + \\int_{\\Gamma} \\frac{\\eta}{h_{\\Gamma}}\\,[e]\\,[v_{h}]\\,\\mathrm{d}s.\n$$\n\n### 步骤 3：抵消和净贡献\n\n一致性误差是将精确解代入离散格式后得到的残差：$a_h(u,v_h) - L_h(v_h)$。在推导过程中出现的界面项之和，就是内部界面对此误差的贡献。这包括来自弱形式的项（步骤 1）和来自 DG 双线性形式的项（步骤 2）。\n\n从步骤 1，对项 $\\int_K k u' v_h' \\mathrm{d}x$ 进行分部积分产生一个界面项 $+\\left( \\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\} \\right)$。\n从步骤 2，在双线性形式 $a_h(u, v_h)$ 中定义的界面项是 $- \\{k\\,u'\\}\\,[v_{h}] - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}]$。\n\n一致性误差的净界面贡献是这些部分的总和：\n$$\n\\text{净贡献} = \\left( \\{k\\,u'\\}[v_{h}] + [k\\,u']\\{v_{h}\\} \\right) + \\left( -\\{k\\,u'\\}\\,[v_{h}] - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}] \\right).\n$$\n项 $\\{k\\,u'\\}\\,[v_{h}]$ 被抵消了。这是对称 DG 方法设计的核心“抵消机制”。剩余的项是：\n$$\n\\text{净贡献} = [k\\,u']\\{v_{h}\\} - \\{k\\,v_{h}'\\}\\,[u] + \\frac{\\eta}{h_{\\Gamma}}\\,[u]\\,[v_{h}].\n$$\n现在，我们应用精确解 $u$ 在界面 $\\Gamma$ 处的正则性：\n1. $[u] = 0$（解的连续性）\n2. $[k\\,u'] = 0$（通量的连续性）\n\n将这些代入净贡献的表达式中：\n$$\n\\text{净贡献} = (0)\\cdot\\{v_{h}\\} - \\{k\\,v_{h}'\\}\\cdot(0) + \\frac{\\eta}{h_{\\Gamma}}\\cdot(0)\\cdot[v_{h}] = 0 - 0 + 0 = 0.\n$$\n来自内部界面对一致性误差 $a_h(u, v_h) - L_h(v_h)$ 的净贡献，以及因此对 Galerkin 正交表达式 $a_h(u-u_h, v_h)$ 的净贡献，为零。这表明 IPDG 格式对于足够正则的解在内部面上是一致的。\n\n因此，$a_{h}(u - u_{h}, v_{h})$ 在 $\\Gamma$ 处的净内部界面贡献的最终值为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "理论上的伽辽金正交性依赖于精确积分，但在实际计算中，这通常被数值求积所取代。本练习将探讨当离散双线性形式由于求积误差而未能精确匹配其连续形式时会发生什么。通过一个具体的节点谱元法的例子，您将计算出由“积分不足”（即使用过少的求积点）引起的“一致性缺陷”，从而量化正交性的破坏程度，这揭示了在实现数值方法时选择恰当求积法则的极端重要性。",
            "id": "3388522",
            "problem": "考虑一维参考单元 $\\Omega = [-1,1]$ 以及由双线性形式定义的变系数扩散算子\n$$\na(u,v) := \\int_{-1}^{1} a(x)\\, u'(x)\\, v'(x)\\, dx,\n$$\n其中 $a(x) = 1 + x^{2}$。设逼近空间为次数 $p=2$ 的节点多项式空间，由与高斯-洛巴托-勒让德 (GLL) 节点相关的拉格朗日基函数张成。对于 $\\Omega$ 上的 $p=2$ 的情况，GLL 节点位于 $x_{0}=-1$、$x_{1}=0$ 和 $x_{2}=1$，相应的 GLL 求积权重为 $w_{0} = \\tfrac{1}{3}$、$w_{1} = \\tfrac{4}{3}$ 和 $w_{2} = \\tfrac{1}{3}$。具有 $N$ 个节点的 GLL 求积对于次数至多为 $2N-3$ 的多项式是精确的。\n\n定义用 $p=2$ GLL 求积组装的离散刚度双线性形式为\n$$\na_{h}(u,v) := \\sum_{i=0}^{2} w_{i}\\, a(x_{i})\\, u'(x_{i})\\, v'(x_{i}).\n$$\n\n设连续右端泛函被精确地组装为 $l(v) := a(u,v)$，因此精确解 $u$ 对所有容许的 $v$ 满足 $a(u,v)=l(v)$。考虑以下具体选择\n$$\nu(x) = x^{3}, \\qquad v_{h}(x) = \\phi_{+1}(x) := \\frac{x(x+1)}{2},\n$$\n其中 $v_{h}$ 是与右端点节点 $x=1$ 相关的拉格朗日节点基函数。\n\n在欠积分条件下导致伽辽金正交性损失的相容性缺陷，是在欠积分的离散形式中检验精确解所得到的残差，\n$$\nr_{h}(v_{h}) := l(v_{h}) - a_{h}(u, v_{h}) = a(u, v_{h}) - a_{h}(u, v_{h}).\n$$\n\n精确计算 $r_{h}(v_{h})$ 的值。你的最终答案必须是一个实数。不需要四舍五入。",
            "solution": "该问题是有效的。这是一个适定的计算问题，属于偏微分方程数值方法的标准框架内，具体涉及伽辽金方法中求积误差的分析。所有定义和数据都已提供并且在数学上是一致的。\n\n目标是计算相容性缺陷 $r_{h}(v_{h})$，其定义为：\n$$\nr_{h}(v_{h}) := a(u, v_{h}) - a_{h}(u, v_{h})\n$$\n这需要计算两项：连续双线性形式 $a(u, v_{h})$ 及其离散近似 $a_{h}(u, v_{h})$。\n\n首先，我们计算连续项 $a(u, v_{h})$。\n连续双线性形式由下式给出：\n$$\na(u,v) = \\int_{-1}^{1} a(x)\\, u'(x)\\, v'(x)\\, dx\n$$\n我们给定的函数是：\n- $u(x) = x^{3}$\n- $v_{h}(x) = \\frac{x(x+1)}{2} = \\frac{1}{2}x^{2} + \\frac{1}{2}x$\n- $a(x) = 1 + x^{2}$\n\n我们首先求 $u(x)$ 和 $v_{h}(x)$ 的导数：\n$$\nu'(x) = \\frac{d}{dx}(x^{3}) = 3x^{2}\n$$\n$$\nv_{h}'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}x^{2} + \\frac{1}{2}x\\right) = x + \\frac{1}{2}\n$$\n接下来，我们构建被积函数 $a(x) u'(x) v_{h}'(x)$：\n$$\na(x) u'(x) v_{h}'(x) = (1 + x^{2})(3x^{2})\\left(x + \\frac{1}{2}\\right)\n$$\n展开这个多项式得到：\n$$\n(3x^{2} + 3x^{4})\\left(x + \\frac{1}{2}\\right) = 3x^{3} + \\frac{3}{2}x^{2} + 3x^{5} + \\frac{3}{2}x^{4}\n$$\n现在，我们在定义域 $\\Omega = [-1,1]$ 上对这个多项式进行积分：\n$$\na(u, v_{h}) = \\int_{-1}^{1} \\left(3x^{5} + \\frac{3}{2}x^{4} + 3x^{3} + \\frac{3}{2}x^{2}\\right) dx\n$$\n一个奇函数（如 $x^{3}$ 和 $x^{5}$）在对称区间 $[-c, c]$ 上的积分为零。因此，奇次幂项消失：\n$$\n\\int_{-1}^{1} 3x^{5}\\, dx = 0 \\quad \\text{和} \\quad \\int_{-1}^{1} 3x^{3}\\, dx = 0\n$$\n剩下的是偶次幂项的积分：\n$$\na(u, v_{h}) = \\int_{-1}^{1} \\left(\\frac{3}{2}x^{4} + \\frac{3}{2}x^{2}\\right) dx\n$$\n由于被积函数是偶函数，我们可以简化积分：\n$$\na(u, v_{h}) = 2 \\int_{0}^{1} \\left(\\frac{3}{2}x^{4} + \\frac{3}{2}x^{2}\\right) dx = 3 \\int_{0}^{1} (x^{4} + x^{2})\\, dx\n$$\n计算该积分：\n$$\na(u, v_{h}) = 3 \\left[ \\frac{x^{5}}{5} + \\frac{x^{3}}{3} \\right]_{0}^{1} = 3 \\left( \\left(\\frac{1^{5}}{5} + \\frac{1^{3}}{3}\\right) - 0 \\right) = 3 \\left( \\frac{1}{5} + \\frac{1}{3} \\right)\n$$\n$$\na(u, v_{h}) = 3 \\left( \\frac{3+5}{15} \\right) = 3 \\left( \\frac{8}{15} \\right) = \\frac{8}{5}\n$$\n\n其次，我们使用高斯-洛巴托-勒让德求积计算离散项 $a_{h}(u, v_{h})$。\n离散双线性形式定义为：\n$$\na_{h}(u,v_{h}) = \\sum_{i=0}^{2} w_{i}\\, a(x_{i})\\, u'(x_{i})\\, v_{h}'(x_{i})\n$$\nGLL 节点为 $x_{0}=-1$、$x_{1}=0$、$x_{2}=1$。权重为 $w_{0} = \\frac{1}{3}$、$w_{1} = \\frac{4}{3}$、$w_{2} = \\frac{1}{3}$。\n\n我们在每个节点上计算被加数的各个分量：\n- 在 $x_{0} = -1$ 处：\n  - $a(x_{0}) = 1 + (-1)^{2} = 2$\n  - $u'(x_{0}) = 3(-1)^{2} = 3$\n  - $v_{h}'(x_{0}) = -1 + \\frac{1}{2} = -\\frac{1}{2}$\n  - 该项为 $w_{0}\\, a(x_{0})\\, u'(x_{0})\\, v_{h}'(x_{0}) = \\frac{1}{3} (2) (3) \\left(-\\frac{1}{2}\\right) = -1$。\n\n- 在 $x_{1} = 0$ 处：\n  - $a(x_{1}) = 1 + 0^{2} = 1$\n  - $u'(x_{1}) = 3(0)^{2} = 0$\n  - $v_{h}'(x_{1}) = 0 + \\frac{1}{2} = \\frac{1}{2}$\n  - 该项为 $w_{1}\\, a(x_{1})\\, u'(x_{1})\\, v_{h}'(x_{1}) = \\frac{4}{3} (1) (0) \\left(\\frac{1}{2}\\right) = 0$。\n\n- 在 $x_{2} = 1$ 处：\n  - $a(x_{2}) = 1 + 1^{2} = 2$\n  - $u'(x_{2}) = 3(1)^{2} = 3$\n  - $v_{h}'(x_{2}) = 1 + \\frac{1}{2} = \\frac{3}{2}$\n  - 该项为 $w_{2}\\, a(x_{2})\\, u'(x_{2})\\, v_{h}'(x_{2}) = \\frac{1}{3} (2) (3) \\left(\\frac{3}{2}\\right) = 3$。\n\n将这三项相加得到 $a_{h}(u, v_{h})$ 的值：\n$$\na_{h}(u, v_{h}) = -1 + 0 + 3 = 2\n$$\n问题中说明，具有 $N=p+1=3$ 个节点的 $p=2$ GLL 求积对于次数至多为 $2N-3=2(3)-3=3$ 的多项式是精确的。被积函数是一个 5 次多项式，因此求积不是精确的，这是相容性缺陷的来源。\n\n最后，我们计算相容性缺陷 $r_{h}(v_{h})$：\n$$\nr_{h}(v_{h}) = a(u, v_{h}) - a_{h}(u, v_{h}) = \\frac{8}{5} - 2 = \\frac{8}{5} - \\frac{10}{5} = -\\frac{2}{5}\n$$",
            "answer": "$$\n\\boxed{-\\frac{2}{5}}\n$$"
        },
        {
            "introduction": "伽辽金正交性不仅是一个优美的理论属性，更是一个强大的实用工具。本练习旨在展示其在“目标导向”后验误差估计这一前沿领域中的关键作用。您将看到，伽辽金正交性正是推导精确误差表达式的基石，它使得我们能够为工程或科学问题中特定的“关注量”计算出有保证的误差界，这在现代计算科学中至关重要。",
            "id": "3388529",
            "problem": "考虑单位区间 $[0,1]$ 上的标量扩散模型问题：求解 $u \\in H_{0}^{1}(0,1)$ 使得\n$$\na(u,v) = \\ell(v) \\quad \\text{对所有 } v \\in H_{0}^{1}(0,1),\n$$\n其中双线性形式为 $a(w,v) := \\int_{0}^{1} w'(x)\\,v'(x)\\,dx$，线性形式为 $\\ell(v) := \\int_{0}^{1} f(x)\\,v(x)\\,dx$，其中 $f(x) \\equiv 2$。设目标泛函为 $J(v) := \\int_{0}^{1} v(x)\\,dx$。令 $V_{h}$ 为 $H_{0}^{1}(0,1)$ 的协调子空间，由与网格 $0 - \\tfrac{1}{2} - 1$ 上的中点 $x=\\tfrac{1}{2}$ 相关联的单个连续分段线性帽子函数 $\\varphi$ 张成。令 $u_{h}\\in V_{h}$ 为 Galerkin 近似解，使得对所有 $v_{h} \\in V_{h}$ 都有 $a(u_{h},v_{h})=\\ell(v_{h})$。\n\n1.  仅从弱形式和目标泛函的定义出发，构造对偶问题：求解 $z \\in H_{0}^{1}(0,1)$ 使得对所有 $v \\in H_{0}^{1}(0,1)$ 都有 $a(v,z)=J(v)$。利用 Galerkin 正交性，对任意 $z_{h} \\in V_{h}$ 推导误差表示恒等式\n    $$\n    J(u-u_{h}) \\;=\\; a(u-u_{h},\\,z-z_{h})\n    $$\n\n2.  在一维空间中，定义对偶通量 $q_{z} := -z'$，它属于空间 $H^{1}(0,1)$，因此在一维中是 $H(\\mathrm{div})$-协调的。通过取 $\\widehat{q}_{z} := q_{z}$ 来构造均衡对偶通量重构 $\\widehat{q}_{z}$，并验证它在强意义下精确满足局部均衡条件 $\\frac{d}{dx}\\widehat{q}_{z} = 1$。证明将第 1 部分的恒等式与单元分部积分相结合，可得到保证的目标误差界，该误差界可简化为精确恒等式\n    $$\n    J(u-u_{h}) \\;=\\; \\int_{0}^{1} (u(x)-u_{h}(x))\\,\\frac{d}{dx}\\widehat{q}_{z}(x)\\,dx,\n    $$\n    因此，对于均衡选择 $\\widehat{q}_{z}=q_{z}$，可简化为\n    $$\n    J(u-u_{h}) \\;=\\; \\int_{0}^{1} (u(x)-u_{h}(x))\\,dx.\n    $$\n\n3.  对于给定的数据 $f(x)\\equiv 2$ 和网格，显式计算 $u$ 和 $u_{h}$。然后评估第 2 部分的保证界（在此设置下是精确的），以获得 $J(u-u_{h})$ 的一个实数值。以精确形式表示最终答案（无需四舍五入）。",
            "solution": "该问题已经过验证，被认为是适定的、有科学依据且自洽的。所有必要的定义和数据都已提供，以确定唯一的解。\n\n问题分为三部分。我们将依次解决每一部分。\n\n第一部分：误差表示恒等式的推导\n\n目标是推导恒等式 $J(u-u_{h}) = a(u-u_{h}, z-z_{h})$，对任意 $z_{h} \\in V_{h}$ 成立。\n\n目标泛函的误差表示为 $J(u-u_{h})$。根据泛函 $J$ 的线性性，我们有 $J(u-u_{h}) = J(u) - J(u_h)$，但这不是指定的路径。我们从对偶问题的定义开始。\n\n对偶问题定义为：求解 $z \\in H_{0}^{1}(0,1)$ 使得对所有 $v \\in H_{0}^{1}(0,1)$ 有 $a(v,z) = J(v)$。\n令原问题的解的误差为 $e := u-u_h$。由于 $u \\in H_{0}^{1}(0,1)$ 且 $u_h \\in V_h \\subset H_{0}^{1}(0,1)$，误差 $e$ 也属于 $H_{0}^{1}(0,1)$。\n因此，我们可以在对偶问题的定义中令 $v=e=u-u_h$：\n$$\nJ(u-u_{h}) = a(u-u_{h}, z)\n$$\n这是第一步。接下来，我们从离散空间 $V_h$ 中引入一个任意函数 $z_h$。由于 $V_h$ 是 $H_0^1(0,1)$ 的子空间，所以 $z_h \\in H_0^1(0,1)$。\n\nGalerkin 正交性是 Galerkin 近似解 $u_h$ 的一个性质。它表明误差 $u-u_h$ 关于双线性形式 $a(\\cdot, \\cdot)$ 与子空间 $V_h$ 正交。在数学上，这表示为：\n$$\na(u-u_h, v_h) = 0 \\quad \\text{对所有 } v_h \\in V_h\n$$\n这是通过从连续弱形式中减去离散弱形式得到的：\n$a(u,v_h) = \\ell(v_h)$ 和 $a(u_h, v_h) = \\ell(v_h)$。相减得到 $a(u,v_h) - a(u_h, v_h) = 0$，根据 $a(\\cdot, \\cdot)$ 的线性性，有 $a(u-u_h, v_h) = 0$。\n\n由于 $z_h$ 是 $V_h$ 的任意元素，我们可以在 Galerkin 正交性条件中令 $v_h=z_h$ 得到：\n$$\na(u-u_h, z_h) = 0\n$$\n现在，我们可以从我们的目标误差表达式中减去这个零值量：\n$$\nJ(u-u_{h}) = a(u-u_{h}, z) - a(u-u_{h}, z_{h})\n$$\n利用双线性形式 $a(\\cdot, \\cdot)$ 对其第二个参数的线性性，我们可以合并右边的项：\n$$\nJ(u-u_{h}) = a(u-u_{h}, z-z_{h})\n$$\n这对 $V_h$ 中任意选择的 $z_h$ 都成立。第一部分的推导到此结束。\n\n第二部分：对偶通量与误差恒等式简化\n\n首先，我们求解对偶问题以找到 $z(x)$。对偶问题的弱形式是 $\\int_{0}^{1} v'(x)z'(x)dx = \\int_{0}^{1} v(x)dx$，对所有 $v \\in H_0^1(0,1)$ 成立。假设 $z$ 具有足够的正则性，我们可以进行分部积分：\n$$\n\\int_{0}^{1} v'(x)z'(x)dx = [v(x)z'(x)]_{0}^{1} - \\int_{0}^{1} v(x)z''(x)dx\n$$\n由于 $v \\in H_{0}^{1}(0,1)$，我们有 $v(0)=v(1)=0$，所以边界项消失。弱形式变为：\n$$\n-\\int_{0}^{1} v(x)z''(x)dx = \\int_{0}^{1} v(x) \\cdot 1 dx\n$$\n根据变分法基本引理，这意味着对偶问题的强形式为：$-z''(x)=1$，对于 $x \\in (0,1)$，边界条件为 $z(0)=z(1)=0$。\n两次积分得到 $z(x) = -\\frac{x^2}{2} + C_1 x + C_2$。\n应用边界条件：\n$z(0) = C_2 = 0$。\n$z(1) = -\\frac{1}{2} + C_1 = 0 \\implies C_1 = \\frac{1}{2}$。\n精确对偶解为 $z(x) = \\frac{x(1-x)}{2}$。该解属于 $H^2(0,1)$，这证明了分部积分的合理性。\n\n对偶通量是 $q_z := -z'$。我们计算 $z'(x) = -x + \\frac{1}{2}$，所以 $q_z(x) = x - \\frac{1}{2}$。问题将均衡对偶通量重构定义为 $\\widehat{q}_z := q_z = x - \\frac{1}{2}$。\n我们验证局部均衡条件：\n$$\n\\frac{d}{dx}\\widehat{q}_{z}(x) = \\frac{d}{dx}\\left(x - \\frac{1}{2}\\right) = 1\n$$\n这在强意义下对所有 $x \\in (0,1)$ 成立。右侧的源项（$1$）对应于对偶问题中的分布载荷，它源于泛函 $J(v) = \\int_0^1 1 \\cdot v(x) dx$ 的定义。\n\n现在，我们证明第一部分的恒等式可以导出指定的积分形式。我们从恒等式 $J(u-u_h) = a(u-u_h, z-z_h)$ 开始。从第一部分我们知道 Galerkin 正交性意味着 $a(u-u_h, z_h) = 0$。因此：\n$$\nJ(u-u_h) = a(u-u_h, z-z_h) = a(u-u_h, z) - a(u-u_h, z_h) = a(u-u_h, z)\n$$\n现在我们使用 $a(\\cdot,\\cdot)$ 和对偶通量的定义：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u-u_h)'(x) z'(x) dx = \\int_{0}^{1} (u-u_h)'(x) (-q_z(x)) dx\n$$\n选择 $\\widehat{q}_z = q_z$，上式变为：\n$$\nJ(u-u_h) = -\\int_{0}^{1} (u-u_h)'(x) \\widehat{q}_z(x) dx\n$$\n我们进行分部积分。令 $e(x) = u(x)-u_h(x)$。\n$$\nJ(e) = - \\left( [e(x) \\widehat{q}_z(x)]_{0}^{1} - \\int_{0}^{1} e(x) \\frac{d}{dx}\\widehat{q}_z(x) dx \\right)\n$$\n由于 $u, u_h \\in H_0^1(0,1)$，我们有 $e(0) = u(0)-u_h(0) = 0-0=0$ 和 $e(1)=u(1)-u_h(1)=0-0=0$。边界项 $[e(x)\\widehat{q}_z(x)]_0^1$ 为零。剩下：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x)-u_h(x)) \\frac{d}{dx}\\widehat{q}_z(x) dx\n$$\n这是要求我们推导的第一个恒等式。\n最后，使用均衡性质 $\\frac{d}{dx}\\widehat{q}_z(x) = 1$，我们将其代入恒等式中：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x)-u_h(x)) \\cdot 1 \\, dx\n$$\n这个最终的恒等式，虽然表面上是同义反复，因为这正是 $J(u-u_h)$ 的定义，但它是从误差表示公式 $J(u-u_h) = a(u-u_h, z-z_h)$ 严格推导出来的，展示了理论框架的一致性。\n\n第三部分：显式计算\n\n首先，我们计算精确解 $u(x)$。原问题的强形式是 $-u''(x) = f(x) = 2$，在 $(0,1)$ 上，且 $u(0)=u(1)=0$。\n一次积分得到 $u'(x) = -2x + C_1$。\n二次积分得到 $u(x) = -x^2 + C_1 x + C_2$。\n应用边界条件：\n$u(0) = C_2 = 0$。\n$u(1) = -1 + C_1 = 0 \\implies C_1 = 1$。\n精确解是 $u(x) = x - x^2$。\n\n接下来，我们计算 Galerkin 近似解 $u_h(x) \\in V_h$。空间 $V_h$ 由单个基函数 $\\varphi(x)$ 张成，该函数是满足 $\\varphi(\\frac{1}{2})=1$ 和 $\\varphi(0)=\\varphi(1)=0$ 的分段线性帽子函数。其显式形式为：\n$$\n\\varphi(x) = \\begin{cases} 2x & \\text{若 } 0 \\le x \\le 1/2 \\\\ 2(1-x) & \\text{若 } 1/2 \\le x \\le 1 \\end{cases}\n$$\n解 $u_h(x)$ 可以写为 $u_h(x) = c_1 \\varphi(x)$，其中 $c_1$ 是某个系数。Galerkin 系统为 $a(u_h, \\varphi) = \\ell(\\varphi)$。\n代入 $u_h = c_1 \\varphi$：\n$c_1 a(\\varphi, \\varphi) = \\ell(\\varphi)$。\n我们计算各项。$\\varphi(x)$ 的导数是 $\\varphi'(x) = 2$ 对于 $x \\in (0, \\frac{1}{2})$ 和 $\\varphi'(x) = -2$ 对于 $x \\in (\\frac{1}{2}, 1)$。\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} (\\varphi'(x))^2 dx = \\int_{0}^{1/2} 2^2 dx + \\int_{1/2}^{1} (-2)^2 dx = 4 \\cdot \\frac{1}{2} + 4 \\cdot \\frac{1}{2} = 4\n$$\n$$\n\\ell(\\varphi) = \\int_{0}^{1} f(x)\\varphi(x)dx = \\int_{0}^{1} 2 \\varphi(x) dx = 2 \\int_{0}^{1} \\varphi(x)dx\n$$\n积分 $\\int_{0}^{1} \\varphi(x)dx$ 是一个底为 1、高为 1 的三角形的面积，即 $\\frac{1}{2}$。\n所以，$\\ell(\\varphi) = 2 \\cdot \\frac{1}{2} = 1$。\n关于 $c_1$ 的方程是 $c_1 \\cdot 4 = 1$，这给出 $c_1 = \\frac{1}{4}$。\nGalerkin 近似解是 $u_h(x) = \\frac{1}{4}\\varphi(x)$。\n\n最后，我们计算目标泛函的误差值 $J(u-u_h)$。使用第二部分中在此情况下为精确的恒等式：\n$$\nJ(u-u_h) = \\int_{0}^{1} (u(x) - u_h(x)) dx = \\int_{0}^{1} u(x) dx - \\int_{0}^{1} u_h(x) dx\n$$\n我们分别计算每个积分：\n$$\n\\int_{0}^{1} u(x) dx = \\int_{0}^{1} (x - x^2) dx = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{3-2}{6} = \\frac{1}{6}\n$$\n$$\n\\int_{0}^{1} u_h(x)dx = \\int_{0}^{1} \\frac{1}{4}\\varphi(x)dx = \\frac{1}{4} \\int_{0}^{1} \\varphi(x)dx = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}\n$$\n目标误差的值为：\n$$\nJ(u-u_h) = \\frac{1}{6} - \\frac{1}{8} = \\frac{4}{24} - \\frac{3}{24} = \\frac{1}{24}\n$$\n这就是最终的数值结果。",
            "answer": "$$\n\\boxed{\\frac{1}{24}}\n$$"
        }
    ]
}