{
    "hands_on_practices": [
        {
            "introduction": "对于椭圆型偏微分方程，其解的存在唯一性通常通过Lax-Milgram定理来保证，而该定理的一个核心要求是双线性泛函的矫顽性（coercivity）。庞加莱不等式（Poincaré inequality）正是建立这种矫顽性的关键工具。本练习将引导您从一个微分算子的谱特性（即其第一特征值）出发，推导出最优的庞加莱常数，深刻揭示泛函不等式、算子谱理论与偏微分方程适定性之间的内在联系。",
            "id": "3429233",
            "problem": "考虑一维有界域 $\\Omega=(0,L)$，其中 $L0$。令 $H_{0}^{1}(\\Omega)$ 表示 $\\Omega$ 上的 Sobolev 空间，该空间中的函数是平方可积的，其弱导数也是平方可积的，并且在迹的意义上在边界处为零。Poincaré 不等式指出，存在一个常数 $C_{P}0$，使得对于任意 $u\\in H_{0}^{1}(\\Omega)$，有\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|u'\\|_{L^{2}(\\Omega)}.\n$$\n从 Dirichlet 拉普拉斯算子的谱特征出发，即特征值问题\n$$\n-\\frac{d^{2}}{dx^{2}}\\phi=\\lambda\\,\\phi \\quad \\text{in }(0,L),\\qquad \\phi(0)=\\phi(L)=0,\n$$\n以及通过 Rayleigh 商对第一特征值的变分刻画，推导该域上的最优（最佳）Poincaré 常数 $C_{P}$。您的推导必须基于以下基本事实：第一 Dirichlet 特征值使 Rayleigh 商最小化，并且特征函数在 $L^{2}(\\Omega)$ 中构成一个完备正交系。如果需要，您可以使用傅里叶正弦基展开来证明最优性。\n\n简要解释最优常数如何控制与具有齐次 Dirichlet 边界条件的 Poisson 问题 $-\\frac{d^{2}}{dx^{2}}u=f$ 相关的能量双线性形式的矫顽性，以及这为何与 Lax–Milgram 定理意义下的适定性相关。不要在一开始就陈述或假设 $C_{P}$ 的值；需从第一性原理计算它。\n\n请以 $L$ 的封闭形式符号表达式给出最终答案。不需要数值近似。",
            "solution": "### 最优 Poincaré 常数的推导\n\nPoincaré 不等式由 $\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P} \\|u'\\|_{L^{2}(\\Omega)}$ 给出，对所有 $u \\in H_0^1(\\Omega)$ 成立。最优或最佳常数 $C_P$ 是使该不等式成立的最小值。这等价于找到以下比值的上确界：\n$$\nC_P = \\sup_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}}{\\|u'\\|_{L^{2}(\\Omega)}}\n$$\n由于所有项都是非负的，这等价于找到平方比值的上确界：\n$$\nC_P^2 = \\sup_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}^2}{\\|u'\\|_{L^{2}(\\Omega)}^2}\n$$\n问题要求我们将其与 Dirichlet 拉普拉斯算子的特征值问题 $-\\phi'' = \\lambda \\phi$ 联系起来。第一（最小）特征值 $\\lambda_1$ 的变分刻画由 Rayleigh 商的最小值给出：\n$$\n\\lambda_1 = \\min_{u \\in H_0^1(\\Omega), u \\neq 0} R(u) = \\min_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\langle -u'', u \\rangle_{L^2(\\Omega)}}{\\|u\\|_{L^2(\\Omega)}^2}\n$$\n分子中的内积可以用分部积分法简化。对于任意 $u \\in H_0^1(\\Omega)$，我们有 $u(0)=u(L)=0$。\n$$\n\\langle -u'', u \\rangle_{L^2(\\Omega)} = \\int_0^L \\left(-\\frac{d^2u}{dx^2}\\right) u \\, dx = -\\left[ u'(x)u(x) \\right]_0^L + \\int_0^L u'(x) u'(x) \\, dx = \\|u'\\|_{L^2(\\Omega)}^2\n$$\n由于齐次 Dirichlet 条件，边界项为零。因此，Rayleigh 商精确地为：\n$$\nR(u) = \\frac{\\|u'\\|_{L^2(\\Omega)}^2}{\\|u\\|_{L^2(\\Omega)}^2}\n$$\n第一特征值 $\\lambda_1$ 是该商的下确界。这意味着对于任意 $u \\in H_0^1(\\Omega)$：\n$$\n\\lambda_1 \\leq \\frac{\\|u'\\|_{L^2(\\Omega)}^2}{\\|u\\|_{L^2(\\Omega)}^2}\n$$\n整理这个不等式，我们得到：\n$$\n\\|u\\|_{L^2(\\Omega)}^2 \\leq \\frac{1}{\\lambda_1} \\|u'\\|_{L^2(\\Omega)}^2\n$$\n这直接与 Poincaré 不等式的平方形式相关，表明 $C_P^2 \\leq 1/\\lambda_1$。\n\n为了确认 $1/\\lambda_1$ 是 $C_P^2$ 的最优值，我们必须证明这个上界是可以达到的。Rayleigh 商的最小值在 $u$ 是第一特征函数 $\\phi_1$ 时达到。对于 $u = \\phi_1$，我们有：\n$$\n\\frac{\\|\\phi_1'\\|_{L^2(\\Omega)}^2}{\\|\\phi_1\\|_{L^2(\\Omega)}^2} = \\lambda_1\n$$\n这意味着反比值的上确界是：\n$$\n\\sup_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^2(\\Omega)}^2}{\\|u'\\|_{L^2(\\Omega)}^2} = \\left( \\inf_{u \\in H_0^1(\\Omega), u \\neq 0} \\frac{\\|u'\\|_{L^2(\\Omega)}^2}{\\|u\\|_{L^2(\\Omega)}^2} \\right)^{-1} = (\\lambda_1)^{-1} = \\frac{1}{\\lambda_1}\n$$\n因此，最优常数为 $C_P^2 = 1/\\lambda_1$，这意味着 $C_P = 1/\\sqrt{\\lambda_1}$。\n\n为了求出 $C_P$ 的值，我们必须计算 $\\lambda_1$。我们求解特征值问题：\n$$\n-\\frac{d^2\\phi}{dx^2} = \\lambda \\phi, \\quad \\phi(0)=0, \\quad \\phi(L)=0\n$$\n该常微分方程的通解为 $\\phi(x) = A \\sin(\\sqrt{\\lambda}x) + B \\cos(\\sqrt{\\lambda}x)$。\n条件 $\\phi(0)=0$ 意味着 $A \\sin(0) + B \\cos(0) = 0$，所以 $B=0$。\n解的形式为 $\\phi(x) = A \\sin(\\sqrt{\\lambda}x)$。\n条件 $\\phi(L)=0$ 意味着 $A \\sin(\\sqrt{\\lambda}L) = 0$。对于非平凡解（$A \\neq 0$），我们必须有 $\\sin(\\sqrt{\\lambda}L)=0$。这在 $\\sqrt{\\lambda}L = k\\pi$ 时发生，其中 $k$ 为任意整数 $k \\ge 1$。\n因此，特征值为 $\\lambda_k = \\left(\\frac{k\\pi}{L}\\right)^2$，其中 $k=1, 2, 3, \\ldots$。\n第一且最小的特征值对应于 $k=1$：\n$$\n\\lambda_1 = \\left(\\frac{\\pi}{L}\\right)^2\n$$\n将此代入我们最优 Poincaré 常数的表达式中：\n$$\nC_P = \\frac{1}{\\sqrt{\\lambda_1}} = \\frac{1}{\\sqrt{(\\pi/L)^2}} = \\frac{1}{\\pi/L} = \\frac{L}{\\pi}\n$$\n这个推导满足了使用第一特征值的变分刻画的要求。最优性可以通过将任意函数 $u \\in H_0^1(\\Omega)$ 在傅里叶正弦基 $\\phi_k(x) = \\sin(k\\pi x/L)$（即特征函数）中展开来进一步证明。这证实了当 $u$ 是第一特征函数 $\\phi_1$ 的倍数时，比值 $\\|u\\|_{L^2}^2 / \\|u'\\|_{L^2}^2$ 达到最大值。\n\n### 与矫顽性和适定性的联系\n\n考虑在 $\\Omega=(0,L)$ 上的 Poisson 问题 $-\\frac{d^2u}{dx^2} = f$，其具有齐次 Dirichlet 边界条件 $u(0)=u(L)=0$。这里给定 $f \\in L^2(\\Omega)$，我们寻求一个解 $u \\in H_0^1(\\Omega)$。\n通过将偏微分方程乘以一个测试函数 $v \\in H_0^1(\\Omega)$ 并在 $\\Omega$ 上积分，可以得到弱形式：\n$$\n\\int_0^L \\left(-\\frac{d^2u}{dx^2}\\right) v \\, dx = \\int_0^L f v \\, dx\n$$\n对左侧进行分部积分得到：\n$$\n\\int_0^L \\frac{du}{dx}\\frac{dv}{dx} \\, dx - \\left[ \\frac{du}{dx} v \\right]_0^L = \\int_0^L f v \\, dx\n$$\n由于 $v \\in H_0^1(\\Omega)$，$v(0)=v(L)=0$，边界项为零。弱形式为：求 $u \\in H_0^1(\\Omega)$，使得对于所有 $v \\in H_0^1(\\Omega)$，\n$$\na(u,v) = F(v)\n$$\n其中能量双线性形式为 $a(u,v) = \\int_0^L u'(x)v'(x)\\,dx$，线性泛函为 $F(v) = \\int_0^L f(x)v(x)\\,dx$。\n\nLax-Milgram 定理保证了该问题的唯一解的存在性，前提是 Hilbert 空间（这里是 $H_0^1(\\Omega)$）是完备的，$F$ 是一个连续线性泛函，且 $a$ 是一个连续且矫顽的双线性形式。\n空间 $V=H_0^1(\\Omega)$ 上 $a(\\cdot,\\cdot)$ 的矫顽性意味着存在一个常数 $\\alpha  0$，使得对于所有 $v \\in V$：\n$$\na(v,v) \\ge \\alpha \\|v\\|_{V}^2\n$$\n$H_0^1(\\Omega)$ 上的自然范数是 $H^1$-范数，$\\|v\\|_{H^1(\\Omega)}^2 = \\|v\\|_{L^2(\\Omega)}^2 + \\|v'\\|_{L^2(\\Omega)}^2$。\n对于我们的问题，$a(v,v) = \\int_0^L (v')^2 \\, dx = \\|v'\\|_{L^2(\\Omega)}^2$。我们需要将其与 $\\|v\\|_{H^1(\\Omega)}^2$ 联系起来。这正是 Poincaré 不等式至关重要的地方。\n\n根据 Poincaré 不等式，我们有 $\\|v\\|_{L^2(\\Omega)}^2 \\le C_P^2 \\|v'\\|_{L^2(\\Omega)}^2$。然后我们可以对 $H^1$-范数进行界定：\n$$\n\\|v\\|_{H^1(\\Omega)}^2 = \\|v\\|_{L^2(\\Omega)}^2 + \\|v'\\|_{L^2(\\Omega)}^2 \\le C_P^2 \\|v'\\|_{L^2(\\Omega)}^2 + \\|v'\\|_{L^2(\\Omega)}^2 = (1+C_P^2)\\|v'\\|_{L^2(\\Omega)}^2\n$$\n通过整理，我们可以用完整的 $H^1$-范数从下方界定 $\\|v'\\|_{L^2(\\Omega)}^2$：\n$$\n\\|v'\\|_{L^2(\\Omega)}^2 \\ge \\frac{1}{1+C_P^2} \\|v\\|_{H^1(\\Omega)}^2\n$$\n将此代入 $a(v,v)$ 的表达式中：\n$$\na(v,v) = \\|v'\\|_{L^2(\\Omega)}^2 \\ge \\frac{1}{1+C_P^2} \\|v\\|_{H^1(\\Omega)}^2\n$$\n这证明了该双线性形式是矫顽的，矫顽常数为 $\\alpha = (1+C_P^2)^{-1}$。由于我们已经求出最优 Poincaré 常数 $C_P = L/\\pi$，因此以这种方式推导出的最佳可能矫顽常数为 $\\alpha = (1+(L/\\pi)^2)^{-1}$。\n\n总而言之，Poincaré 不等式提供了关键的估计，使得半范数 $\\|v'\\|_{L^2}$（出现在能量双线性形式中）能够控制空间 $H_0^1(\\Omega)$ 上的完整 $H^1$-范数。这种控制直接确立了双线性形式的矫顽性，这是 Lax-Milgram 定理的一个关键条件。Poincaré 常数 $C_P$ 的值明确地决定了矫顽常数 $\\alpha$，从而保证了 Poisson 问题在变分框架下的适定性（稳定解的存在性和唯一性）。",
            "answer": "$$\n\\boxed{\\frac{L}{\\pi}}\n$$"
        },
        {
            "introduction": "一个连续的偏微分方程是适定的，并不意味着其任意的数值离散格式都是稳定的。本练习旨在探讨从连续到离散的这一关键过渡，通过对线性对流方程的两种常见数值格式——中心通量和迎风通量——进行稳定性分析。通过研究离散能量的演化，您将揭示为何迎风格式是稳定的（且具有耗散性），而中心格式则不然，从而清晰地理解数值稳定性和数值耗散等核心概念。",
            "id": "3429165",
            "problem": "考虑一个周期区间上的守恒形式的线性平流方程，\n$$u_{t} + a\\,u_{x} = 0,$$\n其中平流速度 $a0$ 为常数，且在 $[0,L]$ 上具有周期性边界条件。将该区域划分为 $N$ 个宽度为 $h=L/N$ 的均匀单元，并用 $u_{j}(t)$ 表示在零阶间断伽辽金 (DG) 方法（等价于具有精确单元平均值的守恒型有限体积法）下单元 $j$ 中离散解的表示。在界面处使用相容的数值通量，并考虑以下两种选择：\n- 中心数值通量，以及\n- 迎风数值通量。\n\n假设一个形式为\n$$u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta),$$\n的离散傅里叶模态 ansatz，其中无量纲波数 $\\theta \\in [0,2\\pi)$，且 $i=\\sqrt{-1}$。令此模态的半离散演化为\n$$\\frac{d}{dt}u_{j}(t) = \\lambda(\\theta)\\,u_{j}(t),$$\n其中 $\\lambda(\\theta)$ 是由通量选择决定的（复）离散符号。\n\n将离散 $L^{2}$ 能量定义为\n$$E(t) = \\sum_{j=0}^{N-1} h\\,|u_{j}(t)|^{2},$$\n以及单位能量的能量增长率为\n$$G(\\theta) := \\frac{1}{E(t)}\\frac{d}{dt}E(t)。$$\n\n从守恒律及其在每个单元上带有界面数值通量的弱形式出发，推导在均匀网格上，对于中心通量和迎风通量，零阶 DG 方法的半离散更新式。使用傅里叶 ansatz，在每种情况下求得 $\\lambda(\\theta)$，然后从第一性原理计算每种情况下的 $G(\\theta)$。将你的最终答案表示为关于 $a$、$h$ 和 $\\theta$ 的差值 $G_{\\text{up}}(\\theta)-G_{\\text{cen}}(\\theta)$ 的单一闭式解析表达式。不要引入任何额外的无量纲参数。你的最终答案必须是单一的符号表达式。",
            "solution": "我们的出发点是一维空间中的线性平流方程，\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n它定义在周期性区域 $[0,L]$ 上，具有恒定的平流速度 $a  0$。我们将区域离散化为 $N$ 个均匀单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$，其中 $j=0, 1, \\dots, N-1$，每个单元的宽度为 $h = L/N$。\n\n零阶间断伽辽金 (DG(0)) 方法，等价于一种单元平均有限体积法，其构建方法为：在一个单元 $I_j$ 上对偏微分方程进行积分，并乘以一个常数测试函数（该函数在 $I_j$ 上为 $1$，在其他地方为 $0$）。这得到：\n$$\n\\int_{x_{j-1/2}}^{x_{j+1/2}} u_t \\, dx + \\int_{x_{j-1/2}}^{x_{j+1/2}} a u_x \\, dx = 0\n$$\n令 $u_j(t)$ 为单元 $I_j$ 中解的单元平均值，定义为 $u_j(t) = \\frac{1}{h} \\int_{I_j} u(x,t) dx$。对于 DG(0) 方法，离散解由这些分段常数值表示。第一项变为 $h \\frac{d u_j}{dt}$。第二项积分得到 $[a u]_{x_{j-1/2}}^{x_{j+1/2}} = a u(x_{j+1/2}, t) - a u(x_{j-1/2}, t)$。因此，单元平均值的方程为：\n$$\n\\frac{d u_j}{dt} + \\frac{1}{h} \\left( a u(x_{j+1/2}, t) - a u(x_{j-1/2}, t) \\right) = 0\n$$\n由于解在单元界面处是不连续的，物理通量 $f(u) = a u$ 必须被一个单值数值通量 $f^*(u_L, u_R)$ 替换，其中 $u_L$ 和 $u_R$ 是界面左右两侧的解值。在界面 $x_{j+1/2}$ 处，$u_L = u_j$ 且 $u_R = u_{j+1}$。半离散格式变为：\n$$\n\\frac{d u_j}{dt} = - \\frac{1}{h} \\left( f^*_{j+1/2} - f^*_{j-1/2} \\right)\n$$\n其中 $f^*_{j+1/2} = f^*(u_j, u_{j+1})$ 且 $f^*_{j-1/2} = f^*(u_{j-1}, u_j)$。\n\n我们现在考虑两种指定的数值通量。\n1.  **中心通量**：数值通量是左右两个状态物理通量的平均值。\n    $$f^*_{\\text{cen}}(u_L, u_R) = \\frac{a u_L + a u_R}{2} = a \\frac{u_L + u_R}{2}$$\n    半离散格式为：\n    $$\n    \\frac{d u_j}{dt} = - \\frac{1}{h} \\left( a \\frac{u_j + u_{j+1}}{2} - a \\frac{u_{j-1} + u_j}{2} \\right) = - \\frac{a}{2h} (u_{j+1} - u_{j-1})\n    $$\n\n2.  **迎风通量**：由于 $a0$，特征信息从左向右传播。迎风通量取自迎风（左侧）状态的值。\n    $$f^*_{\\text{up}}(u_L, u_R) = a u_L$$\n    半离散格式为：\n    $$\n    \\frac{d u_j}{dt} = - \\frac{1}{h} \\left( a u_j - a u_{j-1} \\right) = - \\frac{a}{h} (u_j - u_{j-1})\n    $$\n\n接下来，我们通过代入离散傅里叶模态 ansatz $u_j(t) = \\hat{u}(t)\\exp(i j \\theta)$ 来分析这些格式的行为，其中 $\\theta$ 是无量纲波数。时间演化由 $\\frac{d u_j}{dt} = \\lambda(\\theta) u_j$ 给出。我们的目标是为每种格式找到符号 $\\lambda(\\theta)$。\n\n对于 **中心通量格式**：\n$$\n\\lambda_{\\text{cen}}(\\theta) u_j = - \\frac{a}{2h} \\left( \\hat{u}(t)\\exp(i(j+1)\\theta) - \\hat{u}(t)\\exp(i(j-1)\\theta) \\right)\n$$\n两边同除以 $u_j = \\hat{u}(t)\\exp(i j \\theta)$：\n$$\n\\lambda_{\\text{cen}}(\\theta) = - \\frac{a}{2h} \\left( \\exp(i\\theta) - \\exp(-i\\theta) \\right) = - \\frac{a}{2h} (2i\\sin\\theta) = - \\frac{ia}{h} \\sin\\theta\n$$\n\n对于 **迎风通量格式**：\n$$\n\\lambda_{\\text{up}}(\\theta) u_j = - \\frac{a}{h} \\left( \\hat{u}(t)\\exp(ij\\theta) - \\hat{u}(t)\\exp(i(j-1)\\theta) \\right)\n$$\n两边同除以 $u_j$：\n$$\n\\lambda_{\\text{up}}(\\theta) = - \\frac{a}{h} \\left( 1 - \\exp(-i\\theta) \\right) = - \\frac{a}{h} \\left( 1 - (\\cos\\theta - i\\sin\\theta) \\right) = - \\frac{a}{h} (1 - \\cos\\theta + i\\sin\\theta)\n$$\n\n现在我们推导单位能量的能量增长率 $G(\\theta)$ 的表达式。离散 $L^2$ 能量为 $E(t) = \\sum_{j=0}^{N-1} h |u_j(t)|^2$。它的时间导数为：\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( h \\sum_{j=0}^{N-1} u_j \\bar{u}_j \\right) = h \\sum_{j=0}^{N-1} \\left( \\frac{du_j}{dt} \\bar{u}_j + u_j \\frac{d\\bar{u}_j}{dt} \\right)\n$$\n使用演化方程 $\\frac{du_j}{dt} = \\lambda(\\theta) u_j$ 及其共轭 $\\frac{d\\bar{u}_j}{dt} = \\overline{\\lambda(\\theta)} \\bar{u}_j$：\n$$\n\\frac{dE}{dt} = h \\sum_{j=0}^{N-1} \\left( \\lambda(\\theta) u_j \\bar{u}_j + u_j \\overline{\\lambda(\\theta)} \\bar{u}_j \\right) = h \\sum_{j=0}^{N-1} (\\lambda(\\theta) + \\overline{\\lambda(\\theta)}) |u_j|^2\n$$\n因为 $\\lambda + \\bar{\\lambda} = 2 \\text{Re}(\\lambda)$，我们有：\n$$\n\\frac{dE}{dt} = 2 \\text{Re}(\\lambda(\\theta)) \\left( h \\sum_{j=0}^{N-1} |u_j|^2 \\right) = 2 \\text{Re}(\\lambda(\\theta)) E(t)\n$$\n因此，单位能量的能量增长率为：\n$$\nG(\\theta) = \\frac{1}{E(t)}\\frac{dE}{dt} = 2 \\text{Re}(\\lambda(\\theta))\n$$\n\n我们现在可以为每种通量选择计算 $G(\\theta)$。\n对于 **中心通量**：\n$$\n\\lambda_{\\text{cen}}(\\theta) = - \\frac{ia}{h} \\sin\\theta\n$$\n实部为 $\\text{Re}(\\lambda_{\\text{cen}}(\\theta)) = 0$。因此，能量增长率为：\n$$\nG_{\\text{cen}}(\\theta) = 2 \\times 0 = 0\n$$\n这证实了中心通量格式是能量守恒的（中性稳定）。\n\n对于 **迎风通量**：\n$$\n\\lambda_{\\text{up}}(\\theta) = - \\frac{a}{h} (1 - \\cos\\theta) - i\\frac{a}{h}\\sin\\theta\n$$\n实部为 $\\text{Re}(\\lambda_{\\text{up}}(\\theta)) = - \\frac{a}{h} (1 - \\cos\\theta)$。能量增长率为：\n$$\nG_{\\text{up}}(\\theta) = - \\frac{2a}{h} (1 - \\cos\\theta)\n$$\n由于 $a0$，$h0$ 且 $1-\\cos\\theta \\geq 0$，我们有 $G_{\\text{up}}(\\theta) \\le 0$，这表明迎风格式是耗散的，因此是稳定的。\n\n最后，我们计算所要求的差值 $G_{\\text{up}}(\\theta) - G_{\\text{cen}}(\\theta)$：\n$$\nG_{\\text{up}}(\\theta) - G_{\\text{cen}}(\\theta) = \\left( - \\frac{2a}{h} (1 - \\cos\\theta) \\right) - 0 = - \\frac{2a}{h} (1 - \\cos\\theta)\n$$\n该表达式代表了迎风通量相对于无耗散的中心通量所引入的数值耗散。",
            "answer": "$$\n\\boxed{- \\frac{2a}{h} (1 - \\cos\\theta)}\n$$"
        }
    ]
}