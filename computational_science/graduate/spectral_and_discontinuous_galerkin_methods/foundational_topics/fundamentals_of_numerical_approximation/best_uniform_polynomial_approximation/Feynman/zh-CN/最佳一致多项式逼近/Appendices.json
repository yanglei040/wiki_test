{
    "hands_on_practices": [
        {
            "introduction": "本练习探讨了最佳一致逼近理论中的一个经典原型问题：在区间 $[-1, 1]$ 上用线性多项式逼近函数 $f(x)=|x|$。这个问题虽然形式简单，但它清晰地展示了如何运用对称性和切比雪夫交错定理来确定唯一的最佳逼近多项式。通过解决这个非光滑函数的问题 ，您可以掌握寻找最佳逼近解的核心思想和基本技巧。",
            "id": "3367314",
            "problem": "在谱方法和间断 Galerkin 方法的背景下，考虑最佳一致多项式逼近问题。令函数 $f(x) = |x|$ 定义在区间 $[-1,1]$ 上。对于任意连续函数 $g$，定义其一致范数为 $\\|g\\|_{\\infty} = \\sup_{x \\in [-1,1]} |g(x)|$。在所有次数至多为 1 的多项式中，考虑 $p(x) = a x + b$ 以及一致逼近误差 $E = \\|f - p\\|_{\\infty}$。利用 Chebyshev 交错定理和对称性等基本结果，确定唯一最佳一致逼近多项式的系数 $a$ 和 $b$ 以及相应的误差 $E$。\n\n现在，为了在采用 Legendre 多项式的模态谱方法设置中确定系数，考虑 Legendre 多项式 $P_{0}(x) = 1$ 和 $P_{1}(x) = x$，它们在区间 $[-1,1]$ 上关于权重 $1$ 正交，满足 $\\int_{-1}^{1} P_{n}(x) P_{m}(x)\\, dx = \\frac{2}{2n+1} \\delta_{nm}$。定义具有 3 个节点 $x_{0} = -1$、$x_{1} = 0$、$x_{2} = 1$ 和权重 $w_{0} = \\frac{1}{3}$、$w_{1} = \\frac{4}{3}$、$w_{2} = \\frac{1}{3}$ 的 Legendre-Gauss-Lobatto (LGL) 求积法，该方法能精确积分次数最高为 3 的多项式。考虑一个离散系数确定算子 $M$，它通过 LGL 权重所诱导的离散内积，将节点采样向量 $\\mathbf{u} = \\big(u(x_{0}), u(x_{1}), u(x_{2})\\big)^{\\top}$ 映射到模态系数 $(c_{0}, c_{1})^{\\top}$：\n$$\nc_{n} = \\alpha_{n} \\sum_{j=0}^{2} w_{j}\\, u(x_{j})\\, P_{n}(x_{j}), \\quad \\text{其中 } n = 0,1,\n$$\n其中 $\\alpha_{n} = \\frac{2n+1}{2}$。如果使用精确积分，连续 $L^{2}$ Legendre 系数将为 $c_{n} = \\alpha_{n} \\int_{-1}^{1} u(x)\\, P_{n}(x)\\, dx$。构建与此映射相对应的 $2 \\times 3$ 矩阵 $M$。\n\n计算其 2-范数条件数 $\\kappa_{2}(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)}$，其中 $\\sigma_{\\max}(M)$ 和 $\\sigma_{\\min}(M)$ 分别表示 $M$ 的最大和最小奇异值。将最终答案表示为一个精确的单一数值。",
            "solution": "这个问题包含两个独立的部分。第一部分要求找出函数 $f(x) = |x|$ 在区间 $[-1,1]$ 上的最佳一致线性多项式逼近。第二部分涉及构建一个与谱方法背景下的离散系数确定过程相关的矩阵算子 $M$，然后计算其 2-范数条件数。我将按顺序解决这两个部分。\n\n第一部分：$f(x)=|x|$ 的最佳一致逼近\n\n问题是找到一个次数至多为 1 的多项式 $p(x) = ax+b$，使得误差的一致范数 $E = \\|f - p\\|_{\\infty} = \\sup_{x \\in [-1,1]} ||x| - (ax+b)|$ 最小。\n\n首先，我们利用对称性。函数 $f(x)=|x|$ 是一个偶函数，即对所有 $x$ 都有 $f(x) = f(-x)$。逼近区间 $[-1,1]$ 关于 $x=0$ 对称。在这种情况下，唯一的 $n$ 次最佳一致逼近多项式本身也是一个偶多项式。一个次数至多为 1 的多项式 $p(x) = ax+b$ 是偶函数，当且仅当其奇数部分为零。其奇数部分由 $\\frac{p(x)-p(-x)}{2} = \\frac{(ax+b)-(-ax+b)}{2} = ax$ 给出。要使此式对所有 $x$ 都为零，系数 $a$ 必须为 $0$。\n因此，最佳线性逼近多项式必须是一个常数多项式，$p(x) = b$。\n\n接下来，我们必须找到使 $E = \\sup_{x \\in [-1,1]} ||x|-b|$ 最小化的常数 $b$。\n函数 $|x|$ 在区间 $[-1,1]$ 上的值域是 $[0,1]$。问题简化为在无穷范数的意义下，找到一个与区间 $[0,1]$“最接近”的常数 $b$。这等价于最小化 $\\max_{y \\in [0,1]} |y-b|$。当 $b$ 是值域区间 $[0,1]$ 的中点时，可以达到这个最小值。\n因此，$b = \\frac{0+1}{2} = \\frac{1}{2}$。\n\n最佳一致逼近多项式是 $p(x) = \\frac{1}{2}$，对应的系数为 $a=0$ 和 $b=\\frac{1}{2}$。\n\n相应的误差为 $E = \\sup_{x \\in [-1,1]} ||x|-\\frac{1}{2}|$。\n函数 $e(x) = |x|-\\frac{1}{2}$ 在 $[-1,1]$ 上，于 $x=\\pm 1$ 处取得最大值 $e(\\pm 1) = 1-\\frac{1}{2} = \\frac{1}{2}$，于 $x=0$ 处取得最小值 $e(0) = 0-\\frac{1}{2} = -\\frac{1}{2}$。\n因此，最大绝对误差为 $E = \\frac{1}{2}$。\n\n为了正式确认这个结果，我们应用 Chebyshev 交错定理。对于一个次数 $n=1$ 的多项式逼近，区间内必须存在至少 $n+2=3$ 个点，使得误差函数 $e(x)$ 在这些点上达到其最大绝对值 $E$ 且符号交错。\n我们来检验误差函数 $e(x) = |x|-\\frac{1}{2}$（其中 $E=\\frac{1}{2}$）：\n1. 在 $x_1 = -1$ 处，$e(-1) = |-1|-\\frac{1}{2} = 1-\\frac{1}{2} = \\frac{1}{2} = +E$。\n2. 在 $x_2 = 0$ 处，$e(0) = |0|-\\frac{1}{2} = -\\frac{1}{2} = -E$。\n3. 在 $x_3 = 1$ 处，$e(1) = |1|-\\frac{1}{2} = 1-\\frac{1}{2} = \\frac{1}{2} = +E$。\n点 $x_1=-1  x_2=0  x_3=1$ 展示了所要求的误差符号交错 $(+E, -E, +E)$。这证实了 $p(x)=\\frac{1}{2}$ 确实是唯一的次数至多为 1 的最佳一致逼近。\n系数为 $a=0$，$b=\\frac{1}{2}$，误差为 $E=\\frac{1}{2}$。\n\n第二部分：矩阵 $M$ 的条件数\n\n问题定义了一个从节点采样向量 $\\mathbf{u} = (u(x_0), u(x_1), u(x_2))^\\top$ 到模态系数向量 $\\mathbf{c} = (c_0, c_1)^\\top$ 的映射，通过矩阵-向量乘积 $\\mathbf{c} = M\\mathbf{u}$ 实现。矩阵 $M$ 的元素公式源于系数的表达式：\n$$c_{n} = \\sum_{j=0}^{2} \\left( \\alpha_{n} w_{j} P_{n}(x_{j}) \\right) u(x_{j})$$\n矩阵 $M$ 是一个 $2 \\times 3$ 的矩阵，其中元素 $M_{n,j}$ 是括号中乘以 $u(x_j)=u_j$ 的项。因此，对于 $n \\in \\{0, 1\\}$ 和 $j \\in \\{0, 1, 2\\}$，有 $M_{n,j} = \\alpha_n w_j P_n(x_j)$。\n\n给定的值为：\n- Legendre 多项式：$P_0(x) = 1$，$P_1(x) = x$。\n- LGL 节点：$x_0 = -1$，$x_1 = 0$，$x_2 = 1$。\n- LGL 权重：$w_0 = \\frac{1}{3}$，$w_1 = \\frac{4}{3}$，$w_2 = \\frac{1}{3}$。\n- 归一化因子：$\\alpha_n = \\frac{2n+1}{2}$，所以 $\\alpha_0 = \\frac{1}{2}$ 且 $\\alpha_1 = \\frac{3}{2}$。\n\n我们逐行构建矩阵 $M$。\n\n对于第一行 ($n=0$)：\n$M_{0,0} = \\alpha_0 w_0 P_0(x_0) = \\frac{1}{2} \\cdot \\frac{1}{3} \\cdot P_0(-1) = \\frac{1}{6} \\cdot 1 = \\frac{1}{6}$。\n$M_{0,1} = \\alpha_0 w_1 P_0(x_1) = \\frac{1}{2} \\cdot \\frac{4}{3} \\cdot P_0(0) = \\frac{2}{3} \\cdot 1 = \\frac{2}{3}$。\n$M_{0,2} = \\alpha_0 w_2 P_0(x_2) = \\frac{1}{2} \\cdot \\frac{1}{3} \\cdot P_0(1) = \\frac{1}{6} \\cdot 1 = \\frac{1}{6}$。\n\n对于第二行 ($n=1$)：\n$M_{1,0} = \\alpha_1 w_0 P_1(x_0) = \\frac{3}{2} \\cdot \\frac{1}{3} \\cdot P_1(-1) = \\frac{1}{2} \\cdot (-1) = -\\frac{1}{2}$。\n$M_{1,1} = \\alpha_1 w_1 P_1(x_1) = \\frac{3}{2} \\cdot \\frac{4}{3} \\cdot P_1(0) = 2 \\cdot 0 = 0$。\n$M_{1,2} = \\alpha_1 w_2 P_1(x_2) = \\frac{3}{2} \\cdot \\frac{1}{3} \\cdot P_1(1) = \\frac{1}{2} \\cdot 1 = \\frac{1}{2}$。\n\n所以，矩阵 $M$ 是：\n$$M = \\begin{pmatrix} \\frac{1}{6}  \\frac{2}{3}  \\frac{1}{6} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\end{pmatrix}$$\n\n2-范数条件数 $\\kappa_2(M)$ 是 $M$ 的最大奇异值与最小奇异值之比，即 $\\kappa_2(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)}$。$M$ 的奇异值是矩阵 $MM^\\top$ 的特征值的平方根。\n$M^\\top = \\begin{pmatrix} \\frac{1}{6}  -\\frac{1}{2} \\\\ \\frac{2}{3}  0 \\\\ \\frac{1}{6}  \\frac{1}{2} \\end{pmatrix}$。\n我们来计算 $MM^\\top$：\n$$MM^\\top = \\begin{pmatrix} \\frac{1}{6}  \\frac{2}{3}  \\frac{1}{6} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{6}  -\\frac{1}{2} \\\\ \\frac{2}{3}  0 \\\\ \\frac{1}{6}  \\frac{1}{2} \\end{pmatrix}$$\n元素 $(1,1)$ 是 $(\\frac{1}{6})^2 + (\\frac{2}{3})^2 + (\\frac{1}{6})^2 = \\frac{1}{36} + \\frac{4}{9} + \\frac{1}{36} = \\frac{1}{36} + \\frac{16}{36} + \\frac{1}{36} = \\frac{18}{36} = \\frac{1}{2}$。\n元素 $(1,2)$ 是 $(\\frac{1}{6})(-\\frac{1}{2}) + (\\frac{2}{3})(0) + (\\frac{1}{6})(\\frac{1}{2}) = -\\frac{1}{12} + 0 + \\frac{1}{12} = 0$。\n元素 $(2,1)$ 是 $(-\\frac{1}{2})(\\frac{1}{6}) + (0)(\\frac{2}{3}) + (\\frac{1}{2})(\\frac{1}{6}) = -\\frac{1}{12} + 0 + \\frac{1}{12} = 0$。\n元素 $(2,2)$ 是 $(-\\frac{1}{2})^2 + (0)^2 + (\\frac{1}{2})^2 = \\frac{1}{4} + 0 + \\frac{1}{4} = \\frac{2}{4} = \\frac{1}{2}$。\n所以，我们得到：\n$$MM^\\top = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}$$\n这个对角矩阵的特征值就是其对角元素，即 $\\lambda_1 = \\frac{1}{2}$ 和 $\\lambda_2 = \\frac{1}{2}$。\n$M$ 的奇异值是这些特征值的平方根。由于 $M$ 是一个秩为 2 的 $2 \\times 3$ 矩阵，它有两个非零奇异值。\n$\\sigma_{\\max}(M) = \\sigma_1 = \\sqrt{\\lambda_1} = \\sqrt{\\frac{1}{2}}$。\n$\\sigma_{\\min}(M) = \\sigma_2 = \\sqrt{\\lambda_2} = \\sqrt{\\frac{1}{2}}$。\n条件数是这些值的比率：\n$$\\kappa_2(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)} = \\frac{\\sqrt{\\frac{1}{2}}}{\\sqrt{\\frac{1}{2}}} = 1$$\n矩阵 $M$ 的条件数是 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "与处理非光滑函数的上一个练习不同，本练习将目光投向光滑的解析函数 $F(x) = \\exp(\\gamma x)$。这个例子说明，即使对于无限可微的函数，确定其最佳线性逼近也并非易事，需要严谨的分析。通过利用函数本身的凸性等性质 ，您可以巧妙地应用切比雪夫交错定理，推导出最佳逼近的精确解析解，从而加深对该定理实际应用的理解。",
            "id": "3367337",
            "problem": "考虑在参考单元 $[-1,1]$ 上通过高阶谱间断伽辽金(DG)方法离散化的一维标量守恒律。在单个单元中，假设守恒状态由一个1次多项式 $u(x) = \\gamma x$（其中 $\\gamma  0$）精确表示。非线性物理通量为 $f(u) = \\exp(u)$，因此单元内的通量复合为 $F(x) = f(u(x)) = \\exp(\\gamma x)$。\n\n在模态混叠控制步骤中，我们寻求 $F$ 在 $[-1,1]$ 上通过一个1次多项式 $p(x) = a x + b$ 的最佳一致多项式逼近。最佳一致逼近问题是选择系数 $a$ 和 $b$ 以最小化误差的一致(上确界)范数，\n$$\n\\|F - p\\|_{\\infty} = \\sup_{x \\in [-1,1]} \\left| \\exp(\\gamma x) - (a x + b) \\right|.\n$$\n\n仅从一致范数和最佳一致多项式逼近的基本定义，以及经过充分检验的事实（例如当 $\\gamma  0$ 时 $\\exp(\\gamma x)$ 的凸性）出发，推导表征最小化 $p(x)$ 的必要条件，并求解这些条件以获得最优斜率 $a(\\gamma)$、截距 $b(\\gamma)$ 和最小一致误差大小 $\\Delta(\\gamma) = \\min_{a,b} \\|F - p\\|_{\\infty}$ 的精确表达式。\n\n你的最终答案必须是 $\\Delta(\\gamma)$ 关于 $\\gamma$ 的单一闭式解析表达式。不要四舍五入；仅使用标准函数（$\\exp$, $\\ln$）给出精确表达式。",
            "solution": "该问题的解由 Chebyshev 交错定理决定。对于区间 $[c, d]$ 上的连续函数 $F(x)$，一个次数至多为 $n$ 的多项式 $p(x)$ 是 $F(x)$ 的最佳一致逼近，当且仅当误差函数 $E(x) = F(x) - p(x)$ 表现出至少 $n+2$ 个等振荡点。这意味着在 $[c,d]$ 中存在至少 $n+2$ 个点 $x_0  x_1  \\dots  x_{n+1}$，使得对所有 $i$ 都有 $|E(x_i)| = \\|E\\|_{\\infty}$，并且 $E(x_i) = -E(x_{i+1})$。值 $\\|E\\|_{\\infty}$ 就是最小误差 $\\Delta$。\n\n在本问题中，我们用一个次数为 $n=1$ 的多项式 $p(x) = ax+b$ 在区间 $[-1, 1]$ 上逼近函数 $F(x) = \\exp(\\gamma x)$。误差函数为：\n$$\nE(x) = \\exp(\\gamma x) - (ax+b)\n$$\n该定理要求在 $[-1, 1]$ 中至少有 $n+2=3$ 个等振荡点。设这些点为 $z_1, z_2, z_3$，满足 $-1 \\le z_1  z_2  z_3 \\le 1$。\n\n让我们分析误差函数 $E(x)$ 的性质。其导数为：\n$$\nE'(x) = \\frac{d}{dx}(\\exp(\\gamma x) - ax - b) = \\gamma \\exp(\\gamma x) - a\n$$\n$$\nE''(x) = \\frac{d^2}{dx^2}(\\exp(\\gamma x) - ax - b) = \\gamma^2 \\exp(\\gamma x)\n$$\n由于 $\\gamma  0$，我们有 $\\gamma^2  0$ 且对于所有实数 $x$，$\\exp(\\gamma x)  0$。因此，对于所有 $x \\in [-1, 1]$，$E''(x)  0$。这意味着误差函数 $E(x)$ 在该区间上是严格凸的。\n\n闭区间上的严格凸函数只能在区间的端点处达到其最大值。如果存在内部极值，则它必须是唯一的全局最小值。等振荡性质要求误差大小 $|E(x)|$ 在三个点上达到其最大值 $\\Delta$，且符号交替。鉴于 $E(x)$ 的凸性，这只能在以下情况下发生：最大正误差 $\\Delta$ 在端点 $x = -1$ 和 $x = 1$ 处达到，而最小负误差 $-\\Delta$ 在单个内部点 $x_2 \\in (-1, 1)$ 处达到。\n\n因此，三个等振荡点必须是 $z_1 = -1$，$z_2 = x_2 \\in (-1, 1)$，以及 $z_3 = 1$。内部点 $x_2$ 必须是 $E(x)$ 达到其最小值的点，这意味着 $E'(x_2)=0$。\n\n这导出了一个关于四个未知数 $a, b, x_2$ 和 $\\Delta$ 的四元方程组：\n1. $E(-1) = \\Delta \\implies \\exp(-\\gamma) - a(-1) - b = \\Delta \\implies \\exp(-\\gamma) + a - b = \\Delta$\n2. $E(1) = \\Delta \\implies \\exp(\\gamma) - a(1) - b = \\Delta \\implies \\exp(\\gamma) - a - b = \\Delta$\n3. $E(x_2) = -\\Delta \\implies \\exp(\\gamma x_2) - ax_2 - b = -\\Delta$\n4. $E'(x_2) = 0 \\implies \\gamma \\exp(\\gamma x_2) - a = 0$\n\n我们来解这个方程组。\n从(1)和(2)，我们令 $\\Delta$ 的表达式相等：\n$$\n\\exp(-\\gamma) + a - b = \\exp(\\gamma) - a - b\n$$\n$$\n2a = \\exp(\\gamma) - \\exp(-\\gamma)\n$$\n这给出了 $a$ 的值：\n$$\na = \\frac{\\exp(\\gamma) - \\exp(-\\gamma)}{2} = \\sinh(\\gamma)\n$$\n\n现在，使用方程(4)，我们可以解出 $\\exp(\\gamma x_2)$：\n$$\n\\gamma \\exp(\\gamma x_2) = a = \\sinh(\\gamma) \\implies \\exp(\\gamma x_2) = \\frac{\\sinh(\\gamma)}{\\gamma}\n$$\n由此，我们可以求得 $x_2$：\n$$\n\\gamma x_2 = \\ln\\left(\\frac{\\sinh(\\gamma)}{\\gamma}\\right) \\implies x_2 = \\frac{1}{\\gamma} \\ln\\left(\\frac{\\sinh(\\gamma)}{\\gamma}\\right)\n$$\n对于 $\\gamma > 0$，有一个已知的不等式 $\\sinh(\\gamma) > \\gamma$，所以 $\\frac{\\sinh(\\gamma)}{\\gamma} > 1$，这确保了 $\\ln(\\frac{\\sinh(\\gamma)}{\\gamma})$ 是实数且为正，因此 $x_2 > 0$。也可以证明 $x_2  1$，所以 $x_2 \\in (-1, 1)$，符合要求。\n\n接下来，我们求 $b$ 和 $\\Delta$。将方程(1)和(2)相加：\n$$\n(\\exp(-\\gamma) + a - b) + (\\exp(\\gamma) - a - b) = \\Delta + \\Delta\n$$\n$$\n\\exp(\\gamma) + \\exp(-\\gamma) - 2b = 2\\Delta\n$$\n$$\n2\\cosh(\\gamma) - 2b = 2\\Delta \\implies \\cosh(\\gamma) - b = \\Delta\n$$\n这给出了一个关系式 $b = \\cosh(\\gamma) - \\Delta$。\n\n现在我们使用方程(3)：\n$$\n\\exp(\\gamma x_2) - ax_2 - b = -\\Delta\n$$\n代入 $b = \\cosh(\\gamma) - \\Delta$：\n$$\n\\exp(\\gamma x_2) - ax_2 - (\\cosh(\\gamma) - \\Delta) = -\\Delta\n$$\n$$\n\\exp(\\gamma x_2) - ax_2 - \\cosh(\\gamma) + \\Delta = -\\Delta\n$$\n$$\n2\\Delta = \\cosh(\\gamma) + ax_2 - \\exp(\\gamma x_2)\n$$\n最后，我们代入已求得的 $a$、$\\exp(\\gamma x_2)$ 和 $x_2$ 的表达式：\n$$\n2\\Delta = \\cosh(\\gamma) + \\sinh(\\gamma) \\left(\\frac{1}{\\gamma} \\ln\\left(\\frac{\\sinh(\\gamma)}{\\gamma}\\right)\\right) - \\frac{\\sinh(\\gamma)}{\\gamma}\n$$\n两边除以 $2$ 得到所求的最小误差 $\\Delta(\\gamma)$：\n$$\n\\Delta(\\gamma) = \\frac{1}{2}\\left[ \\cosh(\\gamma) - \\frac{\\sinh(\\gamma)}{\\gamma} + \\frac{\\sinh(\\gamma)}{\\gamma}\\ln\\left(\\frac{\\sinh(\\gamma)}{\\gamma}\\right) \\right]\n$$\n这可以更紧凑地写作，通过提取公因式 $\\frac{\\sinh(\\gamma)}{\\gamma}$：\n$$\n\\Delta(\\gamma) = \\frac{1}{2}\\left[ \\cosh(\\gamma) + \\frac{\\sinh(\\gamma)}{\\gamma}\\left(\\ln\\left(\\frac{\\sinh(\\gamma)}{\\gamma}\\right) - 1\\right) \\right]\n$$\n这就是最小一致误差的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{2}\\left( \\cosh(\\gamma) + \\frac{\\sinh(\\gamma)}{\\gamma}\\left( \\ln\\left(\\frac{\\sinh(\\gamma)}{\\gamma}\\right) - 1 \\right) \\right)}\n$$"
        },
        {
            "introduction": "本练习将我们从解析解的世界带入计算实践的前沿，旨在解决更具挑战性的一类函数 $f(x)=|x|^{\\alpha}$ 的最佳逼近问题。您将学习如何将一个连续的极小极大问题转化为一个有限维的线性规划问题，并用数值方法求解。更重要的是，这个练习将抽象的逼近误差 $E_N$ 与一个具体的应用联系起来 ：确定求解哈密顿-雅可比方程的谱方法所需的数值黏性，这对于设计稳健的数值格式至关重要。",
            "id": "3367329",
            "problem": "考虑函数 $f(x)=|x|^{\\alpha}$ 在区间 $[-1,1]$ 上的情况，其中 $0  \\alpha  1$ 是一个固定参数。我们研究其在谱方法和间断Galerkin方法求解Hamilton–Jacobi方程背景下的最佳一致多项式逼近问题。N次最佳一致逼近是多项式 $p_N \\in \\mathcal{P}_N$，它最小化一致范数误差 $\\|f-p_N\\|_{\\infty}=\\sup_{x\\in[-1,1]}|f(x)-p_N(x)|$。函数 $f$ 是偶函数，任何最佳一致逼近式 $p_N$ 都可以（根据对称性）取为偶多项式，这在正则化谱方法Hamilton–Jacobi求解器中使用的不可微Hamiltonian量 $H(p)=|p|^{\\alpha}$ 时具有重要意义。为了将逼近与稳定性联系起来，我们考虑对Hamilton–Jacobi方程 $u_t + H(u_x)=0$ 进行消失黏性正则化，即添加一个黏性项 $\\nu \\, u_{xx}$（其中 $\\nu>0$），并用一个次数至多为N的多项式逼近式 $P_N$ 替换 $H$。一个一致的稳定性要求是取足够大的 $\\nu_N$ 以主导一致Hamiltonian逼近误差，从而在谱方法或间断Galerkin离散化的标准假设下，确保收敛到黏性解。\n\n你的任务是构造限制在偶多项式内的最佳一致逼近式，方法是将其简化为关于一个变换变量的 $m=\\lfloor N/2\\rfloor$ 次问题。令 $y=2x^2-1$，这样 $x \\in [-1,1]$ 就映射到 $y \\in [-1,1]$。那么，用 $y$ 变量表示时，$f(x)=|x|^{\\alpha}$ 等于 $g(y)=\\left(\\frac{1+y}{2}\\right)^{\\alpha/2}$。如果 $q_m(y)$ 是在一致范数下，$\\mathcal{P}_m$ 中对 $g(y)$ 的一个最佳一致逼近式，那么 $p_N(x)=q_m(2x^2-1)$ 是一个次数至多为 $2m \\le N$ 的偶多项式，并且它是在次数至多为N的所有偶多项式中的一个最佳一致逼近式。\n\n仅从一致范数、最佳一致逼近的基本定义以及Chebyshev多项式 $T_k(y)$ 的性质出发，完成以下任务：\n\n1. 使用Chebyshev多项式基 $\\{T_k(y)\\}_{k=0}^m$（其中 $m=\\lfloor N/2\\rfloor$）为 $g(y)$ 在 $[-1,1]$ 上建立最佳一致逼近问题。将 $q_m(y)$ 表示为 $\\sum_{k=0}^m c_k T_k(y)$，并建立一致误差最小化问题 $\\min_{c_0,\\dots,c_m} \\sup_{y\\in[-1,1]} \\left| g(y) - \\sum_{k=0}^m c_k T_k(y) \\right|$。\n\n2. 通过在大小为 $M$（$M$ 为一个固定的奇数）的Chebyshev–Lobatto网格上对 $y$ 进行采样，将此连续极小极大问题转化为一个有限维线性规划问题。引入一个辅助变量 $t\\ge 0$ 表示采样点集上的一致误差上界，并对每个网格点 $y_j$ 强制满足不等式 $-t \\le g(y_j)-\\sum_{k=0}^m c_k T_k(y_j) \\le t$。你的表述应将得到的线性规划问题表示为以 $(c_0,\\dots,c_m,t)$ 为未知数的标准形式。\n\n3. 求解该线性规划以获得系数 $\\{c_k\\}_{k=0}^m$，并通过在一个独立的、大小为 $M_{\\mathrm{eval}}$ 的更精细均匀网格上进行评估，计算得到的一致误差 $E_N=\\sup_{y\\in[-1,1]} \\left| g(y)-\\sum_{k=0}^m c_k T_k(y)\\right|$。将 $E_N$ 报告为浮点数。\n\n4. 根据逼近论中经过充分检验的结论（例如，针对H\\\"older连续函数的Jackson型估计），预期 $E_N$ 会以 $C N^{-\\alpha}$ 的速率衰减，其中 $C>0$ 是一个依赖于 $\\alpha$ 的常数。对于每个测试用例，计算经验常数 $K_N = E_N (N+1)^{\\alpha}$ 并将其报告为浮点数。因子 $(N+1)^{\\alpha}$ 用于对 $N=0$ 的情况进行正则化。\n\n5. 为了使谱方法或间断Galerkin逼近收敛到黏性解，通过简单准则 $\\nu_N^\\star = E_N$ 定义一个足够的人工黏性大小 $\\nu_N^\\star$。这一选择的合理性在于要求人工黏性在离散残差中主导一致Hamiltonian逼近误差。将 $\\nu_N^\\star$ 报告为浮点数。\n\n程序实现要求：\n\n- 对于每个测试用例，通过在 $y\\in[-1,1]$ 上的 $M=2049$ 个点的Chebyshev–Lobatto网格上求解所述的线性规划来计算 $q_m$，并在一个独立的、位于 $y\\in[-1,1]$ 上、大小为 $M_{\\mathrm{eval}}=20001$ 个点的均匀网格上评估 $E_N$。\n- 为了数值条件的改善，使用Chebyshev多项式基 $T_k(y)$，$0\\le k\\le m$。\n- 每个测试用例的最终输出是三元组 $[E_N, K_N, \\nu_N^\\star]$。\n\n测试套件：\n\n- 使用以下测试用例 $(\\alpha,N)$:\n    - $(\\alpha,N)=(0.25,8)$,\n    - $(\\alpha,N)=(0.5,16)$,\n    - $(\\alpha,N)=(0.9,32)$,\n    - $(\\alpha,N)=(0.75,0)$。\n- 为每个测试用例生成三元组 $[E_N, K_N, \\nu_N^\\star]$。\n\n最终输出格式：\n\n- 你的程序应生成单行输出，其中包含结果列表，每个结果是对应一个测试用例的三个浮点数列表。该列表必须以逗号分隔，并用方括号括起来，不含空格。例如，格式为 $[[r_{11},r_{12},r_{13}],[r_{21},r_{22},r_{23}],\\dots]$，其中每个 $r_{ij}$ 都是一个浮点数。",
            "solution": "我们从最佳一致逼近的基本定义和Chebyshev多项式的性质出发。函数 $f(x)=|x|^{\\alpha}$（其中 $0  \\alpha  1$）在 $[-1,1]$ 上是偶函数，并且是指数为 $\\alpha$ 的H\\\"older连续函数。因为 $f$ 是偶函数，所以任意次数 $N$ 的最佳一致多项式逼近都可以取为偶函数：如果 $p_N$ 是最优的，那么 $(p_N(x)+p_N(-x))/2$ 是偶函数且不会增加一致误差，因此可以在不失最优性的情况下强制要求偶性。因此，我们将研究范围限制在偶多项式上。\n\n为了消除偶性约束，我们使用变量替换 $y=2x^2-1$，它将 $x \\in [-1,1]$ 映射到 $y \\in [-1,1]$，并定义 $g(y)=\\left(\\frac{1+y}{2}\\right)^{\\alpha/2}$，从而有 $f(x)=g(2x^2-1)$。任何次数至多为 $N$ 的偶多项式 $p(x)$ 都可以写成 $p(x)=q_m(2x^2-1)$ 的形式，其中 $q_m$ 是一个关于 $y$ 的次数至多为 $m=\\lfloor N/2\\rfloor$ 的多项式。因此，对于次数至多为 $N$ 的偶多项式的最佳一致逼近问题，等价于在 $[-1,1]$ 上用多项式 $q_m \\in \\mathcal{P}_m$ 对 $g$ 进行最佳一致逼近：\n$$\n\\inf_{q_m\\in \\mathcal{P}_m} \\| g - q_m \\|_{\\infty}, \\quad \\|h\\|_{\\infty}=\\sup_{y\\in[-1,1]}|h(y)|.\n$$\n\n我们在Chebyshev多项式基 $\\{T_k(y)\\}_{k=0}^m$ 中表示 $q_m$，其中 $T_k$ 是由 $T_k(\\cos\\theta)=\\cos(k\\theta)$ 定义的第一类Chebyshev多项式。写出\n$$\nq_m(y)=\\sum_{k=0}^m c_k T_k(y),\n$$\n其中系数 $\\{c_k\\}_{k=0}^m$ 待定。最佳一致逼近问题于是变为\n$$\n\\min_{c_0,\\dots,c_m} \\sup_{y\\in[-1,1]} \\left| g(y) - \\sum_{k=0}^m c_k T_k(y) \\right|.\n$$\n\n为了计算数值解，我们通过在一组点上采样来离散化一致范数，并将问题转化为一个线性规划。设 $M$ 是一个奇数，并使用 $[-1,1]$ 上的 $M$ 点Chebyshev–Lobatto网格：\n$$\ny_j=\\cos\\left(\\frac{\\pi j}{M-1}\\right), \\quad j=0,1,\\dots,M-1.\n$$\n定义 $g_j=g(y_j)$ 和 $V_{jk}=T_k(y_j)$，其中 $0\\le j\\le M-1$ 且 $0\\le k\\le m$。引入一个辅助变量 $t\\ge 0$ 表示采样点上一致误差的一个上界。离散极小极大问题就变成了以下线性规划问题\n$$\n\\min_{c_0,\\dots,c_m,t} \\; t\n$$\n对每个 $j$ 满足以下线性不等式约束，\n$$\n-g_j \\le -\\sum_{k=0}^m c_k T_k(y_j) + t, \\qquad g_j \\ge \\sum_{k=0}^m c_k T_k(y_j) - t,\n$$\n或者等价地，\n$$\n\\sum_{k=0}^m c_k T_k(y_j) - t \\le g_j, \\qquad -\\sum_{k=0}^m c_k T_k(y_j) - t \\le -g_j.\n$$\n这是一个标准形式的线性规划，其变量为 $(c_0,\\dots,c_m,t)$，目标函数系数向量为 $(0,\\dots,0,1)$，并有 $2M$ 个不等式约束。使用Chebyshev基是为了改善数值条件。\n\n求解这个线性规划可以得到系数 $\\{c_k\\}$ 和网格上的离散界 $t$。为了估计真实的一致误差，我们在一个大小为 $M_{\\mathrm{eval}}$ 的、在 $y\\in[-1,1]$ 上均匀分布的独立精细网格上评估误差：\n$$\nE_N \\approx \\max_{0\\le j \\le M_{\\mathrm{eval}}-1} \\left| g(y_j^{\\mathrm{eval}}) - \\sum_{k=0}^m c_k T_k\\left(y_j^{\\mathrm{eval}}\\right) \\right|.\n$$\n由于 $x\\mapsto y=2x^2-1$ 将 $[-1,1]$ 映射到 $[-1,1]$，且 $p_N(x)=q_m(2x^2-1)$，因此这个在 $y$ 上的误差等于偶多项式 $p_N$ 在 $x$ 上的一致误差：\n$$\nE_N=\\sup_{x\\in[-1,1]}|f(x)-p_N(x)|=\\sup_{y\\in[-1,1]}|g(y)-q_m(y)|.\n$$\n\n根据逼近论中诸如H\\\"older函数的Jackson型估计等经过充分检验的结论，已知最佳一致误差满足 $E_N\\le C N^{-\\alpha}$ 形式的界，其中 $C$ 是一个依赖于 $\\alpha$ 的常数。这启发我们定义经验常数\n$$\nK_N = E_N \\,(N+1)^{\\alpha}\n$$\n以考虑低次情况（特别是 $N=0$）并评估观察到的速率。\n\n为了将此与谱方法和间断Galerkin (DG) Hamilton–Jacobi求解器中不可微Hamiltonian量的正则化联系起来，考虑方程 $u_t+H(u_x)=0$（其中 $H(p)=|p|^{\\alpha}$），并用一个次数至多为 $N$ 的多项式 $P_N$ 逼近 $H$，同时加入人工黏性 $\\nu u_{xx}$。一致Hamiltonian误差会引入一个大小至多为 $E_N$ 的一致性误差，而要收敛到黏性解，一个充分的稳定性准则是选择的黏性在离散残差中能够主导该误差。一个简单的充分选择是\n$$\n\\nu_N^\\star = E_N.\n$$\n在当前纯数学背景下，此准则是无量纲的，并且它抓住了基于最佳一致Hamiltonian逼近误差的消失黏性方法论的精髓。\n\n算法设计：\n\n- 计算 $m=\\lfloor N/2\\rfloor$。\n- 构建具有 $M=2049$ 个点的Chebyshev–Lobatto网格 $\\{y_j\\}_{j=0}^{M-1}$，并计算 $g_j=\\left(\\frac{1+y_j}{2}\\right)^{\\alpha/2}$。\n- 构造Chebyshev Vandermonde矩阵 $V\\in\\mathbb{R}^{M\\times(m+1)}$，其元素为 $V_{jk}=T_k(y_j)$，$0\\le k\\le m$。\n- 构造线性规划，变量为 $(c_0,\\dots,c_m,t)$，目标是最小化 $t$，约束条件为 $V c - t\\mathbf{1}\\le g$ 和 $-V c - t\\mathbf{1}\\le -g$，界限为 $t\\ge 0$，$c_k\\in\\mathbb{R}$。\n- 使用一个可靠的线性规划求解器求解该线性规划。\n- 通过计算 $g$ 与 $q_m(y)=\\sum_{k=0}^m c_k T_k(y)$ 之间的最大绝对偏差，在一个大小为 $M_{\\mathrm{eval}}=20001$ 的 $y\\in[-1,1]$ 均匀网格上评估 $E_N$。\n- 计算 $K_N=E_N (N+1)^{\\alpha}$ 并设置 $\\nu_N^\\star=E_N$。\n- 对指定的测试用例重复上述步骤。\n\n测试套件与输出：\n\n- 对于 $(\\alpha,N)=(0.25,8)$, $(0.5,16)$, $(0.9,32)$, $(0.75,0)$，计算 $[E_N,K_N,\\nu_N^\\star]$。\n- 程序打印单行结果 $[[E_1,K_1,\\nu_1],[E_2,K_2,\\nu_2],[E_3,K_3,\\nu_3],[E_4,K_4,\\nu_4]]$，无空格，其中每个条目都是一个浮点数。\n\n这种方法从最佳一致逼近的基本定义出发，使用了一个离散线性规划的表述，当采样网格加密时，该表述会收敛到极小极大解。Chebyshev基利用了Chebyshev多项式经过充分检验的性质，而经验常数 $K_N$ 则展示了预期的H\\\"older速率。引入的黏性 $\\nu_N^\\star=E_N$ 是一个有原则的充分选择，用于在Hamilton–Jacobi方程的谱方法和间断Galerkin求解器中控制由Hamiltonian逼近误差引起的残差，从而契合为收敛到黏性解所必需的消失黏性框架。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\nfrom numpy.polynomial.chebyshev import chebvander\n\ndef chebyshev_lobatto_grid(M: int) - np.ndarray:\n    # M must be odd; returns y_j = cos(pi * j / (M-1)), j=0..M-1\n    j = np.arange(M, dtype=float)\n    return np.cos(np.pi * j / (M - 1))\n\ndef build_lp_matrices(y: np.ndarray, m: int, alpha: float):\n    # Build Vandermonde in Chebyshev basis and LP constraints\n    V = chebvander(y, m)  # shape (M, m+1), columns are T_k(y)\n    g = ((1.0 + y) / 2.0) ** (alpha / 2.0)\n    M = y.shape[0]\n    # Inequalities: V c - t = g  and  -V c - t = -g\n    A1 = np.hstack([V, -np.ones((M, 1))])\n    A2 = np.hstack([-V, -np.ones((M, 1))])\n    A_ub = np.vstack([A1, A2])\n    b_ub = np.concatenate([g, -g])\n    # Objective: minimize t\n    c_obj = np.zeros(m + 2)\n    c_obj[-1] = 1.0\n    # Bounds: c_k free, t = 0\n    bounds = [(None, None)] * (m + 1) + [(0.0, None)]\n    return c_obj, A_ub, b_ub, bounds\n\ndef solve_minimax_even(alpha: float, N: int, M: int = 2049, M_eval: int = 20001):\n    # m is degree in y for the even polynomial space\n    m = N // 2\n    # Build Chebyshev-Lobatto grid for LP\n    y = chebyshev_lobatto_grid(M)\n    c_obj, A_ub, b_ub, bounds = build_lp_matrices(y, m, alpha)\n    # Solve LP\n    res = linprog(c=c_obj, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method=\"highs\")\n    if not res.success:\n        raise RuntimeError(f\"Linear program failed to solve: {res.message}\")\n    coeffs = res.x[:m + 1]\n    # Evaluate uniform error on a fine uniform grid\n    y_eval = np.linspace(-1.0, 1.0, M_eval)\n    V_eval = chebvander(y_eval, m)\n    q_eval = V_eval @ coeffs\n    g_eval = ((1.0 + y_eval) / 2.0) ** (alpha / 2.0)\n    E = np.max(np.abs(g_eval - q_eval))\n    return coeffs, E\n\ndef format_results(results):\n    # Format as [[a,b,c],[...]] with no spaces, numbers in scientific notation\n    parts = []\n    for triple in results:\n        nums = \",\".join(f\"{v:.12e}\" for v in triple)\n        parts.append(f\"[{nums}]\")\n    return \"[\" + \",\".join(parts) + \"]\"\n\ndef solve():\n    # Define test cases: (alpha, N)\n    test_cases = [\n        (0.25, 8),\n        (0.5, 16),\n        (0.9, 32),\n        (0.75, 0),\n    ]\n    M = 2049\n    M_eval = 20001\n    results = []\n    for alpha, N in test_cases:\n        _, E_N = solve_minimax_even(alpha, N, M=M, M_eval=M_eval)\n        K_N = E_N * (N + 1) ** alpha\n        nu_star = E_N\n        results.append([E_N, K_N, nu_star])\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}