{
    "hands_on_practices": [
        {
            "introduction": "本练习是连接局部间断伽辽金（LDG）方法理论与实践的第一步。通过为简单的双单元系统显式计算局部矩阵，你将亲身体验数值通量如何在代数层面耦合不同单元的自由度。此练习的核心是验证对称罚通量选择如何直接转化为离散系统中关键的对称矩阵结构，这对于理解方法的稳定性至关重要。",
            "id": "3405412",
            "problem": "考虑在一个双单元片(patch)上的一维泊松方程，其一阶局部间断伽辽金(LDG)形式为：\n$$\nq = u_x, \\qquad -q_x = f,\n$$\n在区域 $\\Omega = [0,2h]$ 上，该区域被划分为单元 $K^{-} = [0,h]$ 和 $K^{+} = [h,2h]$。在每个单元上，在同一个次数为 $p=1$ 的多项式空间中近似 $u$ 和 $q$，该空间由参考单元 $\\hat{K} = [-1,1]$ 上的模态勒让德基函数张成，\n$$\n\\phi_0(\\xi) = \\frac{1}{\\sqrt{2}}, \\qquad \\phi_1(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi,\n$$\n通过从 $\\hat{K}$ 到每个物理单元的仿射映射 $x = x_c + \\frac{h}{2}\\,\\xi$。在内部界面 $F = \\{x=h\\}$ 处，采用外法线约定，即在 $K^{-}$ 上 $n^{-}=+1$，在 $K^{+}$ 上 $n^{+}=-1$。对于任意标量迹 $w$，定义其平均和跳跃为\n$$\n\\{w\\} = \\frac{w^{-} + w^{+}}{2}, \\qquad [w] = w^{-} - w^{+},\n$$\n其中上标 $(-)$ 和 $(+)$ 分别表示来自 $K^{-}$ 和 $K^{+}$ 的迹。\n\n通过分部积分在每个单元上构建 LDG 弱形式：\n- 将 $q = u_x$ 乘以一个测试函数 $r$，并在每个单元上进行分部积分，以获得边界项 $\\int_{\\partial K} \\hat{u}\\, r\\, n\\, ds$。\n- 将 $-q_x = f$ 乘以一个测试函数 $v$，并在每个单元上进行分部积分，以获得边界项 $-\\int_{\\partial K} \\hat{q}\\, n\\, v\\, ds$。\n\n在内表面 $F$ 上，对此一阶 LDG 系统采用对称内部罚 (symmetric LDG) 数值通量：\n$$\n\\hat{u} = \\{u\\}, \\qquad \\hat{q}\\,n = \\{q\\} - \\sigma\\,[u],\n$$\n其中罚参数 $\\sigma > 0$ 是对称的、与单元无关的。\n\n使用这些定义：\n1. 根据在 $\\xi=\\pm 1$ 处的基函数迹，显式地组装 $F$-局部界面通量贡献矩阵，用于以下三个贡献项：\n   - 来自 $\\int_{F} \\hat{u}\\,[r]\\,ds$ 的 $u$ 到 $r$ 的一致性块，\n   - 来自 $-\\int_{F} \\{q\\}\\,[v]\\,ds$ 的 $q$ 到 $v$ 的一致性块，\n   - 来自 $+\\int_{F} \\sigma\\,[u]\\,[v]\\,ds$ 的 $u$ 到 $v$ 的罚项块。\n   在表面上使用由 $u$ 系数向量 $\\big(u_0^{-},u_1^{-},u_0^{+},u_1^{+}\\big)$ 给出的自由度排序，对 $q$ 也类似，以及对 $r$ 和 $v$ 的测试函数系数使用相应的排序。\n2. 关注 $u$ 到 $v$ 的罚项块矩阵，将其表示为 $P(\\sigma)$。通过量化其斜对称部分的 Frobenius 范数来确认其在对称罚选择下的对称性缺陷，\n$$\nS(\\sigma) = \\frac{1}{2}\\left(P(\\sigma) - P(\\sigma)^{\\top}\\right), \\qquad \\|S(\\sigma)\\|_{F}.\n$$\n\n$\\|S(\\sigma)\\|_{F}$ 的值是多少？请给出一个精确的数值作为最终答案。不需要四舍五入，该量没有单位。",
            "solution": "该问题要求计算一维泊松方程的局部间断伽辽金(LDG)公式中，由界面项产生的罚矩阵 $P(\\sigma)$ 的斜对称部分的 Frobenius 范数。\n\n首先，我们建立计算所需的必要组成部分。在两个单元 $K^{-} = [0,h]$ 和 $K^{+} = [h,2h]$ 上，对未知场 $u$ 和测试函数 $v$ 的近似是在一个次数为 $p=1$ 的多项式空间中进行的。参考单元 $\\hat{K} = [-1,1]$ 上的基函数为 $\\phi_0(\\xi) = \\frac{1}{\\sqrt{2}}$ 和 $\\phi_1(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi$。\n\n场 $u$ 的自由度(DoFs)是每个单元上基展开的系数：$K^{-}$ 上的 $(u_0^{-}, u_1^{-})$ 和 $K^{+}$ 上的 $(u_0^{+}, u_1^{+})$。跨越这两个单元片的 $u$ 的完整系数向量是 $\\mathbf{U} = (u_0^{-}, u_1^{-}, u_0^{+}, u_1^{+})^{\\top}$。类似地，对于测试函数 $v$，其系数向量是 $\\mathbf{V} = (v_0^{-}, v_1^{-}, v_0^{+}, v_1^{+})^{\\top}$。\n\n每个物理单元上的函数 $u$ 和 $v$ 由下式给出：\n在 $K^{-}$ 上，其中 $x = \\frac{h}{2} + \\frac{h}{2}\\xi$：\n$u(x)|_{K^{-}} = u_h^{-}(\\xi) = u_0^{-} \\phi_0(\\xi) + u_1^{-} \\phi_1(\\xi)$\n$v(x)|_{K^{-}} = v_h^{-}(\\xi) = v_0^{-} \\phi_0(\\xi) + v_1^{-} \\phi_1(\\xi)$\n\n在 $K^{+}$ 上，其中 $x = \\frac{3h}{2} + \\frac{h}{2}\\xi$：\n$u(x)|_{K^{+}} = u_h^{+}(\\xi) = u_0^{+} \\phi_0(\\xi) + u_1^{+} \\phi_1(\\xi)$\n$v(x)|_{K^{+}} = v_h^{+}(\\xi) = v_0^{+} \\phi_0(\\xi) + v_1^{+} \\phi_1(\\xi)$\n\n问题指定了对弱形式的罚项贡献为 $I_p = \\int_{F} \\sigma\\,[u]\\,[v]\\,ds$。界面 $F$ 是点 $\\{x=h\\}$。对于一维问题，此积分简化为在该点处被积函数的值，因此 $I_p = \\sigma [u][v] |_{x=h}$。\n\n跳跃算子定义为 $[w] = w^{-} - w^{+}$，其中 $w^{-}$ 是来自 $K^{-}$ 的迹，$w^{+}$ 是来自 $K^{+}$ 的迹。界面 $x=h$ 对应于 $K^{-}$ 上的 $\\xi=1$ 和 $K^{+}$ 上的 $\\xi=-1$。\n首先，我们计算这些点上的基函数值：\n$\\phi_0(1) = \\frac{1}{\\sqrt{2}}$\n$\\phi_1(1) = \\sqrt{\\frac{3}{2}}$\n$\\phi_0(-1) = \\frac{1}{\\sqrt{2}}$\n$\\phi_1(-1) = -\\sqrt{\\frac{3}{2}}$\n\n$u$ 在 $x=h$ 处的迹为：\n$u^{-} = u_h^{-}(\\xi=1) = u_0^{-} \\phi_0(1) + u_1^{-} \\phi_1(1) = u_0^{-} \\frac{1}{\\sqrt{2}} + u_1^{-} \\sqrt{\\frac{3}{2}}$\n$u^{+} = u_h^{+}(\\xi=-1) = u_0^{+} \\phi_0(-1) + u_1^{+} \\phi_1(-1) = u_0^{+} \\frac{1}{\\sqrt{2}} - u_1^{+} \\sqrt{\\frac{3}{2}}$\n\n因此，跳跃 $[u]$ 为：\n$[u] = u^{-} - u^{+} = \\left(u_0^{-} \\frac{1}{\\sqrt{2}} + u_1^{-} \\sqrt{\\frac{3}{2}}\\right) - \\left(u_0^{+} \\frac{1}{\\sqrt{2}} - u_1^{+} \\sqrt{\\frac{3}{2}}\\right)$\n$[u] = u_0^{-} \\frac{1}{\\sqrt{2}} + u_1^{-} \\sqrt{\\frac{3}{2}} - u_0^{+} \\frac{1}{\\sqrt{2}} + u_1^{+} \\sqrt{\\frac{3}{2}}$\n\n这可以写成点积 $\\mathbf{b}^{\\top}\\mathbf{U}$，其中 $\\mathbf{U} = (u_0^{-}, u_1^{-}, u_0^{+}, u_1^{+})^{\\top}$，而 $\\mathbf{b}$ 是基函数迹值的向量：\n$\\mathbf{b} = \\begin{pmatrix} \\phi_0(1) \\\\ \\phi_1(1) \\\\ -\\phi_0(-1) \\\\ -\\phi_1(-1) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\end{pmatrix}$\n\n所以，$[u] = \\mathbf{b}^{\\top}\\mathbf{U}$。类似地，对于测试函数 $v$，$[v] = \\mathbf{b}^{\\top}\\mathbf{V}$。\n\n现在，罚项 $I_p$ 可以用系数向量表示：\n$I_p = \\sigma [u][v] = \\sigma (\\mathbf{b}^{\\top}\\mathbf{U}) (\\mathbf{b}^{\\top}\\mathbf{V})$\n由于这些项是标量，我们可以重新排列：\n$I_p = \\sigma (\\mathbf{V}^{\\top}\\mathbf{b}) (\\mathbf{b}^{\\top}\\mathbf{U}) = \\mathbf{V}^{\\top} (\\sigma\\,\\mathbf{b}\\mathbf{b}^{\\top}) \\mathbf{U}$\n\n这个双线性形式的矩阵，我们表示为 $P(\\sigma)$，是中间的量：\n$P(\\sigma) = \\sigma\\,\\mathbf{b}\\mathbf{b}^{\\top}$\n\n这是向量 $\\mathbf{b}$ 与其自身的外积，并按 $\\sigma$ 缩放。让我们显式地计算这个 $4 \\times 4$ 矩阵：\n$P(\\sigma) = \\sigma \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  \\sqrt{\\frac{3}{2}}  -\\frac{1}{\\sqrt{2}}  \\sqrt{\\frac{3}{2}} \\end{pmatrix}$\n\n$P(\\sigma) = \\sigma \\begin{pmatrix}\n\\frac{1}{2}  \\frac{\\sqrt{3}}{2}  -\\frac{1}{2}  \\frac{\\sqrt{3}}{2} \\\\\n\\frac{\\sqrt{3}}{2}  \\frac{3}{2}  -\\frac{\\sqrt{3}}{2}  \\frac{3}{2} \\\\\n-\\frac{1}{2}  -\\frac{\\sqrt{3}}{2}  \\frac{1}{2}  -\\frac{\\sqrt{3}}{2} \\\\\n\\frac{\\sqrt{3}}{2}  \\frac{3}{2}  -\\frac{\\sqrt{3}}{2}  \\frac{3}{2}\n\\end{pmatrix}$\n\n问题要求我们量化该矩阵的对称性缺陷。如果 $A = A^{\\top}$，则矩阵 $A$ 是对称的。任何实数列向量 $\\mathbf{b}$ 与其转置的外积 $\\mathbf{b}\\mathbf{b}^{\\top}$ 总是产生一个对称矩阵。设 $A = \\mathbf{b}\\mathbf{b}^{\\top}$。则元素 $A_{ij} = b_i b_j$。转置矩阵的元素是 $(A^{\\top})_{ij} = A_{ji} = b_j b_i$。由于标量乘法是可交换的，所以 $b_i b_j = b_j b_i$，因此 $A_{ij}=(A^{\\top})_{ij}$。所以，$A = A^{\\top}$。\n\n这意味着我们的矩阵 $P(\\sigma) = \\sigma \\mathbf{b}\\mathbf{b}^{\\top}$ 是对称的。我们也可以通过检查其显式矩阵形式来看到这一点。\n\n$P(\\sigma)$ 的斜对称部分定义为 $S(\\sigma) = \\frac{1}{2}\\left(P(\\sigma) - P(\\sigma)^{\\top}\\right)$。\n由于 $P(\\sigma)$ 是对称的，所以 $P(\\sigma) = P(\\sigma)^{\\top}$。\n因此，$S(\\sigma) = \\frac{1}{2}\\left(P(\\sigma) - P(\\sigma)\\right) = \\frac{1}{2} \\mathbf{0} = \\mathbf{0}$，其中 $\\mathbf{0}$ 是 $4 \\times 4$ 的零矩阵。\n\n最后一步是计算 $S(\\sigma)$ 的 Frobenius 范数。矩阵 $A$ 的 Frobenius 范数是 $\\|A\\|_{F} = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$。\n对于零矩阵，其所有元素都为 $0$，所以总和为 $0$。\n$\\|S(\\sigma)\\|_{F} = \\|\\mathbf{0}\\|_{F} = \\sqrt{0^2 + 0^2 + \\dots + 0^2} = 0$。\n\n由罚矩阵斜对称部分的 Frobenius 范数量化的对称性缺陷值为 $0$。这证实了该特定罚项对公式的贡献是对称的。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在掌握了如何将数值通量转化为矩阵贡献之后，下一个关键问题是：我们为什么采用特定的通量形式？本练习旨在探讨数值通量的一个核心性质——相容性。通过将一个精确的平滑解代入LDG弱形式，你将验证离散残差是否为零，从而证明一个设计良好的数值通量对于精确解是“不可见的”，这是保证任何数值方法准确性的基石。",
            "id": "3405445",
            "problem": "考虑区间 $[0,1]$ 上的一维椭圆模型问题，其精确解为 $u(x)=x^{2}$。引入一阶系统，令 $q=u'$ 且 $-q'=f$，因此 $f(x)=-2$。设 $\\{x_{i}\\}_{i=0}^{N}$ 是 $[0,1]$ 上的一个网格，包含 $N \\geq 2$ 个单元 $K_{i}=(x_{i-1},x_{i})$。对于每个单元 $K$，令 $n$表示 $\\partial K$ 上的单位外法向量，即在左端点处 $n=-1$，在右端点处 $n=+1$。对于一个内部界面 $x_{i}$，其左右迹为 $\\phi^{-}$ 和 $\\phi^{+}$，定义跳跃和平均为 $[\\phi]=\\phi^{+}-\\phi^{-}$ 和 $\\{\\phi\\}=(\\phi^{+}+\\phi^{-})/2$。\n\n与该一阶系统相关的局部间断伽辽金 (LDG) 残差泛函 $R(v,r)$ 对分片检验函数 $v$ 和 $r$ 定义为\n$$\nR(v,r)\n=\n\\sum_{K}\\left(\\int_{K} q\\,r\\,dx+\\int_{K} u\\,r'\\,dx-\\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right)\n+\n\\sum_{K}\\left(\\int_{K} q\\,v'\\,dx-\\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n-\\int_{K} f\\,v\\,dx\\right).\n$$\n在内部界面 $x_{i}$上，采用双参数数值通量族\n$$\n\\hat{u}=\\{u\\}-\\sigma\\,[q],\n\\qquad\n\\hat{q}=\\{q\\}-\\tau\\,[u],\n$$\n其中 $\\sigma$ 和 $\\tau$ 为实常数。在边界 $\\{0,1\\}$ 上，施加狄利克雷(Dirichlet)相容通量\n$$\n\\hat{u}(0)=u(0)=0,\\quad \\hat{u}(1)=u(1)=1,\\qquad \\hat{q}(0)=q(0),\\quad \\hat{q}(1)=q(1).\n$$\n\n(a) 当 $u(x)=x^{2}$ 和 $q(x)=2x$ 代入残差时，以闭合形式解析计算对 $R(v,r)$ 的内部界面总贡献。将结果表示为界面处检验迹 $v^{\\pm}$ 和 $r^{\\pm}$ 以及参数 $\\sigma$ 和 $\\tau$ 的函数。\n\n(b) 仅使用分部积分基本恒等式和上述定义，验证至少存在一种内部通量参数 $\\sigma$ 和 $\\tau$ 的选择，使得全局残差 $R(v,r)$ 对所有分片检验函数 $v$ 和 $r$ 都为零。然后，对于这样的选择并在所述的边界通量下，确定全局残差 $R(v,r)$ 的值。\n\n你的最终答案必须是一个实数，给出在所选通量下 $R(v,r)$ 的值。无需四舍五入。",
            "solution": "该问题分为两部分。我们将依次解决它们。问题的核心在于分析给定精确解的局部间断伽辽金 (LDG) 残差泛函。\n\n设精确解为 $u(x) = x^2$。一阶系统由 $q = u'$ 和 $-q' = f$ 定义。\n这意味着 $q(x) = \\frac{d}{dx}(x^2) = 2x$ 且 $f(x) = -\\frac{d}{dx}(2x) = -2$。\n函数 $u(x)$ 和 $q(x)$ 在定义域 $[0,1]$ 上是连续的。因此，在任何内部界面 $x_{i}$ 处，左右迹相等：$u(x_i^-) = u(x_i^+) = u(x_i)$ 和 $q(x_i^-) = q(x_i^+) = q(x_i)$。\n这导致在任何内部界面 $x_i$ 处，跳跃 $[ \\cdot ]$ 和平均 $\\{ \\cdot \\}$ 算子的值如下：\n$[u](x_i) = u(x_i^+) - u(x_i^-) = 0$\n$[q](x_i) = q(x_i^+) - q(x_i^-) = 0$\n$\\{u\\}(x_i) = \\frac{u(x_i^+) + u(x_i^-)}{2} = u(x_i) = x_i^2$\n$\\{q\\}(x_i) = \\frac{q(x_i^+) + q(x_i^-)}{2} = q(x_i) = 2x_i$\n\nLDG 残差泛函由下式给出：\n$$\nR(v,r)\n=\n\\sum_{K}\\left(\\int_{K} q\\,r\\,dx+\\int_{K} u\\,r'\\,dx-\\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right)\n+\n\\sum_{K}\\left(\\int_{K} q\\,v'\\,dx-\\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n-\\int_{K} f\\,v\\,dx\\right).\n$$\n\n**(a) 对 $R(v,r)$ 的内部界面总贡献的计算**\n\n$R(v,r)$ 中涉及对单元边界 $\\partial K$ 求和的项可以重组为对内部界面的求和以及对定义域边界点 $\\{0,1\\}$ 的求和。\n来自所有单元面的总贡献为 $-\\sum_K \\sum_{x\\in\\partial K} (\\hat{u}rn + \\hat{q}vn)$。\n让我们考虑位于 $x_i$ 的单个内部界面，它是单元 $K_i=(x_{i-1},x_i)$ 的右边界和单元 $K_{i+1}=(x_i,x_{i+1})$ 的左边界。对于 $K_i$，在 $x_i$ 处的单位外法向量为 $n=+1$。对于 $K_{i+1}$，在 $x_i$ 处的单位外法向量为 $n=-1$。数值通量 $\\hat{u}$ 和 $\\hat{q}$ 在界面处是单值的。\n来自界面 $x_i$ 对求和的贡献是：\n$$\n-(\\hat{u}(x_i)r(x_i^-)(+1) + \\hat{u}(x_i)r(x_i^+)(-1)) - (\\hat{q}(x_i)v(x_i^-)(+1) + \\hat{q}(x_i)v(x_i^+)(-1))\n$$\n$$\n= -\\hat{u}(x_i)(r(x_i^-) - r(x_i^+)) - \\hat{q}(x_i)(v(x_i^-) - v(x_i^+)) = \\hat{u}(x_i)[r](x_i) + \\hat{q}(x_i)[v](x_i)\n$$\n对 $R(v,r)$ 的内部界面总贡献，我们记为 $I(v,r)$，是这些项对所有内部界面 $x_i$（其中 $i=1, \\dots, N-1$）求和的结果：\n$$\nI(v,r) = \\sum_{i=1}^{N-1} \\left( \\hat{u}(x_i)[r](x_i) + \\hat{q}(x_i)[v](x_i) \\right)\n$$\n现在，我们代入内部界面处数值通量的定义：\n$$\n\\hat{u}(x_i) = \\{u\\}(x_i) - \\sigma [q](x_i)\n\\qquad\n\\hat{q}(x_i) = \\{q\\}(x_i) - \\tau [u](x_i)\n$$\n由于我们使用的是光滑精确解，因此有 $[u](x_i)=0$ 和 $[q](x_i)=0$。通量简化为：\n$$\n\\hat{u}(x_i) = \\{u\\}(x_i) = u(x_i) = x_i^2\n$$\n$$\n\\hat{q}(x_i) = \\{q\\}(x_i) = q(x_i) = 2x_i\n$$\n这证明了数值通量的相容性。值得注意的是，当使用光滑精确解进行计算时，$\\hat{u}(x_i)$ 和 $\\hat{q}(x_i)$ 的值与参数 $\\sigma$ 和 $\\tau$ 无关。\n将这些代入 $I(v,r)$ 的表达式中：\n$$\nI(v,r) = \\sum_{i=1}^{N-1} \\left( u(x_i)[r](x_i) + q(x_i)[v](x_i) \\right)\n$$\n使用具体形式 $u(x_i) = x_i^2$ 和 $q(x_i) = 2x_i$，并将跳跃表示为迹 $v^\\pm$ 和 $r^\\pm$：\n$$\nI(v,r) = \\sum_{i=1}^{N-1} \\left( x_i^2 (r(x_i^+) - r(x_i^-)) + 2x_i (v(x_i^+) - v(x_i^-)) \\right)\n$$\n这就是内部界面总贡献的闭合形式表达式。\n\n**(b) 全局残差 $R(v,r)$ 的验证和确定**\n\n为了分析全局残差，我们对包含检验函数 $v$ 和 $r$ 导数的项应用分部积分。对于一个单元 $K$：\n$\\int_K u r' dx = [ur]_{\\partial K} - \\int_K u' r dx$\n$\\int_K q v' dx = [qv]_{\\partial K} - \\int_K q' v dx$\n将这些代入 $R(v,r)$ 的定义中：\n$$\nR(v,r) = \\sum_{K}\\left(\\int_{K} (q - u')r\\,dx + [ur]_{\\partial K} -\\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right) + \\sum_{K}\\left([qv]_{\\partial K} - \\int_{K} (f+q')v\\,dx -\\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n\\right)\n$$\n由于我们使用 $u(x)=x^2$，$q(x)=2x$ 和 $f(x)=-2$，我们有 $q-u'=0$ 和 $-q'-f = 0$。因此，在每个单元 $K$ 上的体积分为零：\n$$\n\\int_K (q-u')r\\,dx = 0 \\quad \\text{and} \\quad \\int_K(f+q')v\\,dx=0\n$$\n残差简化为界面项和边界项的和：\n$$\nR(v,r) = \\sum_{K}\\left([ur]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right) + \\sum_{K}\\left([qv]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n\\right)\n$$\n让我们分析这个和的第一部分。通过将对单元及其边界的求和重排为对界面和定义域边界的求和，我们得到：\n$$\n\\sum_{K}\\left([ur]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right) = \\sum_{i=1}^{N-1}(\\hat{u}(x_i)-u(x_i))[r](x_i) + (u(1)-\\hat{u}(1))r(1^-) - (u(0)-\\hat{u}(0))r(0^+)\n$$\n第二部分类似：\n$$\n\\sum_{K}\\left([qv]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n\\right) = \\sum_{i=1}^{N-1}(\\hat{q}(x_i)-q(x_i))[v](x_i) + (q(1)-\\hat{q}(1))v(1^-) - (q(0)-\\hat{q}(0))v(0^+)\n$$\n我们现在计算这些项中的每一项。\n对于内部界面 $x_i \\in (0,1)$，我们已在 (a) 部分证明，对于 $\\sigma$ 和 $\\tau$ 的任何值，都有 $\\hat{u}(x_i)=u(x_i)$ 和 $\\hat{q}(x_i)=q(x_i)$。因此，对内部界面的求和为零：\n$$\n\\sum_{i=1}^{N-1}(\\hat{u}(x_i)-u(x_i))[r](x_i) = 0\n\\qquad \\text{and} \\qquad\n\\sum_{i=1}^{N-1}(\\hat{q}(x_i)-q(x_i))[v](x_i) = 0\n$$\n这对于参数 $\\sigma$ 和 $\\tau$ 的任何选择都成立。这验证了至少存在一种这样的选择（事实上，任何选择都有效）。\n\n现在我们计算在 $x=0$ 和 $x=1$ 处的边界项。我们已知边界通量条件：\n$\\hat{u}(0)=u(0)$, $\\hat{u}(1)=u(1)$, $\\hat{q}(0)=q(0)$, $\\hat{q}(1)=q(1)$。\n使用精确解，我们有 $u(0)=0^2=0$，$u(1)=1^2=1$，$q(0)=2(0)=0$ 和 $q(1)=2(1)=2$。所以边界通量的值为：$\\hat{u}(0)=0$, $\\hat{u}(1)=1$, $\\hat{q}(0)=0$, $\\hat{q}(1)=2$。\n将这些值代入残差的剩余项中：\n$$\n(u(1)-\\hat{u}(1))r(1^-) = (1-1)r(1^-) = 0\n$$\n$$\n-(u(0)-\\hat{u}(0))r(0^+) = -(0-0)r(0^+) = 0\n$$\n$$\n(q(1)-\\hat{q}(1))v(1^-) = (2-2)v(1^-) = 0\n$$\n$$\n-(q(0)-\\hat{q}(0))v(0^+) = -(0-0)v(0^+) = 0\n$$\n$R(v,r)$ 表达式中的所有项都为零。这意味着对于任何参数 $\\sigma, \\tau$，以及给定的边界通量，当使用精确解时，全局残差对所有分片检验函数 $v,r$ 都为零。\n$$\nR(v,r) = 0\n$$\n题目要求对于一个有效的参数选择，全局残差的值是多少。如上所示，任何选择都有效，且对于任何这样的选择，残差的值都是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "除了相容性，守恒性是另一个对物理问题至关重要的数值通量属性。本练习通过一个巧妙的反例来突显其重要性。你将使用一个特意设计的非守恒数值通量，并推导出它如何导致一个非物理的结果——即在没有源或汇的情况下，系统总质量发生了变化。这个计算将具体地展示为何在间断伽辽金方法中坚持使用单值（守恒）通量是构建稳定且有物理意义的模型的根本要求。",
            "id": "3405510",
            "problem": "考虑一维纯扩散方程 $u_{t} = \\kappa u_{xx}$，其定义域为 $[0,1]$，边界条件为齐次诺伊曼(Neumann)边界条件 $u_{x}(0,t) = 0$ 和 $u_{x}(1,t) = 0$。引入一阶系统 $q = u_{x}$ 和 $u_{t} = \\kappa q_{x}$。使用局部间断伽辽金(LDG)方法 (Local Discontinuous Galerkin (LDG))，在包含两个均匀单元 $K_{1} = [0,\\tfrac{1}{2}]$ 和 $K_{2} = [\\tfrac{1}{2},1]$ 的网格上离散化此系统，其中 $u$ 和 $q$ 的试验函数和检验函数均为分片常数。将单元上的常数值分别记为 $u$ 的 $u_{1}(t)$ 和 $u_{2}(t)$，以及 $q$ 的 $q_{1}(t)$ 和 $q_{2}(t)$。设每个单元端点处的外单位法向量为：在左端点处 $n = -1$，在右端点处 $n = +1$。\n\n使用 $q - u_{x} = 0$ 和 $u_{t} - (\\kappa q)_{x} = 0$ 的LDG弱形式，并采用以下数值通量。在内部界面 $x = \\tfrac{1}{2}$ 处，选择一个非守恒的数值迹 $\\widehat{u}$，该迹是逐单元的（双值的）：对于 $K_{1}$ 的右侧，设 $\\widehat{u} = u_{1}$；对于 $K_{2}$ 的左侧，设 $\\widehat{u} = u_{2}$。在区域边界 $x = 0$ 和 $x = 1$ 处，设 $\\widehat{u} = 0$。通过在 $x = 0$ 和 $x = 1$ 处取 $\\widehat{\\kappa q} = 0$ 来施加守恒律的齐次诺伊曼边界条件。在内部界面 $x = \\tfrac{1}{2}$ 处，令扩散数值通量同样是逐单元的（双值的）：对于 $K_{1}$ 的右侧，设 $\\widehat{\\kappa q} = \\kappa q_{1}$；对于 $K_{2}$ 的左侧，设 $\\widehat{\\kappa q} = \\kappa q_{2}$。\n\n从LDG弱形式和这些通量选择出发，推导 $q_{1}(t)$ 和 $q_{2}(t)$ 的半离散方程，以及总质量 $\\int_{0}^{1} u(x,t)\\,dx$ 的全局变化率。对于具体数据 $\\kappa = 1$，$h = \\tfrac{1}{2}$，$u_{1}(0) = 1$ 和 $u_{2}(0) = 0$，计算总质量在 $t = 0$ 时的瞬时变化率 $\\dfrac{d}{dt}\\int_{0}^{1} u(x,t)\\,dx$。将最终答案表示为单个实数。无需四舍五入。",
            "solution": "首先，我们推导半离散方程。\n\n我们从一阶系统在单元 $K_j$ 上的弱形式开始。\n设 $v$ 是 $u$ 方程的检验函数，$p$ 是 $q$ 方程的检验函数。由于试验函数和检验函数在每个单元上都是分片常数，因此对于 $x \\in K_j$，有 $u(x,t) = u_j(t)$，$q(x,t) = q_j(t)$，$v(x) = v_j$ 和 $p(x) = p_j$。\n\n**1. $q - u_x = 0$ 的弱形式：**\n乘以检验函数 $p$ 并在单元 $K_j$ 上积分：\n$$ \\int_{K_j} q p \\,dx - \\int_{K_j} u_x p \\,dx = 0 $$\n对第二项进行分部积分并用数值通量替换边界值：\n$$ \\int_{K_j} q p \\,dx + \\int_{K_j} u p_x \\,dx - [\\widehat{u} p n]_{\\partial K_j} = 0 $$\n由于 $p$ 在 $K_j$ 上是常数，$p_x = 0$。选择检验函数 $p$ 在 $K_j$ 上为 $1$，在其他地方为 $0$，$p_j=1$。方程简化为：\n$$ q_j \\int_{K_j} dx - [\\widehat{u} n]_{\\partial K_j} = 0 \\implies h q_j - (\\widehat{u}(x_{j,R}) n(x_{j,R}) + \\widehat{u}(x_{j,L}) n(x_{j,L})) = 0 $$\n对于单元 $K_1 = [0, \\tfrac{1}{2}]$ ($h=\\tfrac{1}{2}$, $n(0)=-1$, $n(\\tfrac{1}{2})=+1$):\n$$ \\tfrac{1}{2} q_1 - (\\widehat{u}(\\tfrac{1}{2}) \\cdot (+1) + \\widehat{u}(0) \\cdot (-1)) = 0 $$\n使用给定的通量，在 $K_1$ 右侧 $\\widehat{u}(\\tfrac{1}{2}) = u_1$ 且 $\\widehat{u}(0)=0$：\n$$ \\tfrac{1}{2} q_1 - (u_1 \\cdot 1 + 0) = 0 \\implies q_1(t) = 2 u_1(t) $$\n对于单元 $K_2 = [\\tfrac{1}{2}, 1]$ ($h=\\tfrac{1}{2}$, $n(\\tfrac{1}{2})=-1$, $n(1)=+1$):\n$$ \\tfrac{1}{2} q_2 - (\\widehat{u}(1) \\cdot (+1) + \\widehat{u}(\\tfrac{1}{2}) \\cdot (-1)) = 0 $$\n使用给定的通量，在 $K_2$ 左侧 $\\widehat{u}(\\tfrac{1}{2}) = u_2$ 且 $\\widehat{u}(1) = 0$：\n$$ \\tfrac{1}{2} q_2 - (0 + u_2 \\cdot (-1)) = 0 \\implies \\tfrac{1}{2} q_2 = -u_2 \\implies q_2(t) = -2 u_2(t) $$\n\n**2. $u_t - \\kappa q_x = 0$ 的弱形式：**\n乘以检验函数 $v$ 并在 $K_j$ 上积分，分部积分后得到：\n$$ \\int_{K_j} u_t v \\,dx + \\int_{K_j} \\kappa q v_x \\,dx - [\\widehat{\\kappa q} v n]_{\\partial K_j} = 0 $$\n对于分片常数 $v$，$v_x=0$。选择在 $K_j$ 上 $v=1$，在其他地方为 $0$：\n$$ h \\frac{du_j}{dt} - (\\widehat{\\kappa q}(x_{j,R}) n(x_{j,R}) + \\widehat{\\kappa q}(x_{j,L}) n(x_{j,L})) = 0 $$\n对于单元 $K_1 = [0, \\tfrac{1}{2}]$：\n$$ \\tfrac{1}{2} \\frac{du_1}{dt} - (\\widehat{\\kappa q}(\\tfrac{1}{2}) \\cdot (+1) + \\widehat{\\kappa q}(0) \\cdot (-1)) = 0 $$\n使用通量，在 $K_1$ 右侧 $\\widehat{\\kappa q}(\\tfrac{1}{2}) = \\kappa q_1$ 且 $\\widehat{\\kappa q}(0) = 0$：\n$$ \\tfrac{1}{2} \\frac{du_1}{dt} - (\\kappa q_1 \\cdot 1 + 0) = 0 \\implies \\frac{du_1}{dt} = 2 \\kappa q_1 $$\n对于单元 $K_2 = [\\tfrac{1}{2}, 1]$：\n$$ \\tfrac{1}{2} \\frac{du_2}{dt} - (\\widehat{\\kappa q}(1) \\cdot (+1) + \\widehat{\\kappa q}(\\tfrac{1}{2}) \\cdot (-1)) = 0 $$\n使用通量，在 $K_2$ 左侧 $\\widehat{\\kappa q}(\\tfrac{1}{2}) = \\kappa q_2$ 且 $\\widehat{\\kappa q}(1) = 0$：\n$$ \\tfrac{1}{2} \\frac{du_2}{dt} - (0 + \\kappa q_2 \\cdot (-1)) = 0 \\implies \\frac{du_2}{dt} = -2 \\kappa q_2 $$\n\n### 总质量全局变化率的推导\n\n总质量由 $M(t) = \\int_0^1 u(x,t) \\,dx$ 给出。对于分片常数近似，这变为：\n$$ M(t) = u_1(t) h + u_2(t) h = h(u_1(t)+u_2(t)) $$\n总质量的变化率为：\n$$ \\frac{dM}{dt} = h \\left( \\frac{du_1}{dt} + \\frac{du_2}{dt} \\right) $$\n代入推导出的 $u_1$ 和 $u_2$ 的常微分方程：\n$$ \\frac{dM}{dt} = h (2 \\kappa q_1 - 2 \\kappa q_2) = 2h\\kappa (q_1(t) - q_2(t)) $$\n由于 $h=\\tfrac{1}{2}$，这简化为：\n$$ \\frac{dM}{dt} = \\kappa (q_1(t) - q_2(t)) $$\n这证实了在该格式中质量是不守恒的，除非 $q_1=q_2$。这是对 $\\widehat{\\kappa q}$ 选择非守恒数值通量的直接后果，因为界面处的通量没有保持连续性（$\\widehat{\\kappa q}|_{K_1 \\text{ side}} \\neq -\\widehat{\\kappa q}|_{K_2 \\text{ side}}$）。\n\n### 计算 $t=0$ 时的瞬时变化率\n\n我们需要计算 $\\frac{dM}{dt}$ 在 $t=0$ 时的值，即 $\\kappa(q_1(0) - q_2(0))$。\n给定的参数和初始条件为：\n- $\\kappa = 1$\n- $h = \\tfrac{1}{2}$\n- $u_1(0) = 1$\n- $u_2(0) = 0$\n\n首先，我们使用前面推导的半离散关系计算 $q_1$ 和 $q_2$ 的初始值：\n$$ q_1(0) = 2 u_1(0) = 2 \\cdot 1 = 2 $$\n$$ q_2(0) = -2 u_2(0) = -2 \\cdot 0 = 0 $$\n现在，我们可以计算在 $t=0$ 时总质量的瞬时变化率：\n$$ \\left. \\frac{dM}{dt} \\right|_{t=0} = \\kappa (q_1(0) - q_2(0)) = 1 \\cdot (2 - 0) = 2 $$\n在 $t=0$ 时总质量的瞬时变化率为 $2$。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}