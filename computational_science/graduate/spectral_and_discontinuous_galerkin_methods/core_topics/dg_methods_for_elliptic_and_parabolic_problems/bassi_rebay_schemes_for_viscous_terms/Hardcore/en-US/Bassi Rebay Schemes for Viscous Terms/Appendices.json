{
    "hands_on_practices": [
        {
            "introduction": "Understanding the connections between different discontinuous Galerkin (DG) methods is key to mastering the field. This first exercise reveals the deep link between the Bassi-Rebay 2 (BR2) scheme and the Local Discontinuous Galerkin (LDG) method by exploring their equivalence in the simplest setting of piecewise constant basis functions ($p=0$). By locally eliminating the auxiliary variable in the LDG formulation, you will derive an effective penalty term and show how it relates directly to the one generated by the BR2 lifting operator .",
            "id": "3366106",
            "problem": "Consider the scalar diffusion model problem in one spatial dimension with constant diffusivity $\\nu>0$,\n$$ -(\\nu\\, u_{x})_{x} = f, $$\nand focus on a single interior interface $F=\\{x=0\\}$ between two uniform elements $K^{-}=(-h,0)$ and $K^{+}=(0,h)$ of size $h>0$. Let the discrete trial and test spaces on $K^{-}\\cup K^{+}$ be piecewise constants (polynomial degree $p=0$). Denote jumps and averages at $F$ by $[[\\phi]]=\\phi^{+}-\\phi^{-}$ and $\\{\\phi\\}=(\\phi^{+}+\\phi^{-})/2$, and the outward unit normals by $n^{-}=-1$ on $K^{-}$ and $n^{+}=+1$ on $K^{+}$.\n\n1) Starting from the mixed weak form for the Local Discontinuous Galerkin (LDG) method with auxiliary variable $q \\approx u_{x}$,\n$$\n\\begin{aligned}\n&(q,r)_{K^{-}\\cup K^{+}} + (u,r_{x})_{K^{-}\\cup K^{+}} - \\langle \\widehat{u}, r\\, n \\rangle_{F} = 0, \\\\\n&(\\nu q, v_{x})_{K^{-}\\cup K^{+}} - \\langle \\nu \\widehat{q}, v\\, n \\rangle_{F} = (f,v)_{K^{-}\\cup K^{+}},\n\\end{aligned}\n$$\nimpose the standard LDG numerical traces at the interior face $F$,\n$$ \\widehat{u} = \\{u\\}, \\qquad \\widehat{q} = \\{q\\} - \\frac{\\tau}{h}\\, [[u]], $$\nwith a dimensionless stabilization parameter $\\tau>0$. Perform a local elimination of $q$ on the two-element patch to obtain the induced primal bilinear form in $u$ and $v$. Specialize to the present degree-$0$ setting and isolate the face contribution at $F$. Show that the LDG-induced penalty term at $F$ has the form\n$$ \\nu\\,\\frac{\\tau}{h}\\, [[u]]\\, [[v]]. $$\n\n2) Define the Bassi–Rebay 2 (BR2) lifting operator on the same two-element patch as follows: for a given jump $[[u]]$ at $F$, find $r_{F}(u)$, piecewise constant on $K^{-}\\cup K^{+}$, such that\n$$ (r_{F}(u), w)_{K^{-}\\cup K^{+}} = \\langle [[u]], \\{w\\} \\rangle_{F} \\quad \\text{for all piecewise constant } w. $$\nCompute $r_{F}(u)$ explicitly and show that the BR2 face penalty contribution equals\n$$ \\nu\\, (r_{F}(u), r_{F}(v))_{K^{-}\\cup K^{+}} = \\nu\\,\\frac{1}{2h}\\, [[u]]\\, [[v]]. $$\n\n3) The Symmetric Interior Penalty Galerkin (SIPG) method on this patch uses a face penalty of the form $\\nu\\,\\frac{\\sigma}{h}\\, [[u]]\\, [[v]]$ with a dimensionless penalty parameter $\\sigma>0$. By comparing the BR2 penalty in part 2 with the LDG-induced penalty in part 1, determine the value of the LDG parameter $\\tau$ that minimizes the difference between the LDG-induced penalty and the BR2 penalty on the face $F$ (equivalently, matches them). Report this optimal $\\tau$ as a single exact number with no units.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard theoretical exercise in the field of Discontinuous Galerkin (DG) methods. We will proceed with the solution in three parts as requested.\n\nThe setting is a one-dimensional domain consisting of two elements, $K^{-} = (-h, 0)$ and $K^{+} = (0, h)$, for a positive length $h > 0$. The interface between them is at $F = \\{x=0\\}$. The discrete function space is composed of piecewise constant functions, corresponding to a polynomial degree of $p=0$. A function $u$ in this space is thus defined by its constant values $u^{-}$ on $K^{-}$ and $u^{+}$ on $K^{+}$. The jump and average operators at the interface $F$ are defined as $[[u]] = u^{+} - u^{-}$ and $\\{u\\} = (u^{+} + u^{-})/2$, respectively. The outward unit normals are $n^{+} = +1$ for $K^{+}$ at $x=0$ and $n^{-} = -1$ for $K^{-}$ at $x=0$.\n\nThe contribution of a term $\\langle \\phi, \\psi \\rangle_{F}$ at the interface $F$ is understood as the sum of contributions from each side: $\\phi(0^{+})\\psi(0^{+}) + \\phi(0^{-})\\psi(0^{-})$. For terms involving the normal vector, such as $\\langle \\widehat{u}, r n \\rangle_{F}$, this becomes $\\widehat{u}(0) r(0^{+}) n^{+} + \\widehat{u}(0) r(0^{-}) n^{-} = \\widehat{u}(r^{+} - r^{-}) = \\widehat{u}\\,[[r]]$. Similarly, $\\langle \\nu \\widehat{q}, v n \\rangle_{F} = \\nu \\widehat{q}\\,[[v]]$.\n\n**Part 1: Derivation of the LDG-induced penalty term**\n\nWe start with the Local Discontinuous Galerkin (LDG) mixed weak form provided:\n$$\n\\begin{aligned}\n&(q,r)_{K^{-}\\cup K^{+}} + (u,r_{x})_{K^{-}\\cup K^{+}} - \\langle \\widehat{u}, r\\, n \\rangle_{F} = 0, \\\\\n&(\\nu q, v_{x})_{K^{-}\\cup K^{+}} - \\langle \\nu \\widehat{q}, v\\, n \\rangle_{F} = (f,v)_{K^{-}\\cup K^{+}}.\n\\end{aligned}\n$$\nThe trial functions $u, q$ and test functions $v, r$ are piecewise constants. Therefore, their derivatives $u_{x}$, $q_{x}$, $v_{x}$, and $r_{x}$ are zero within each element $K^{-}$ and $K^{+}$. Consequently, the inner products involving these derivatives vanish: $(u,r_{x})_{K^{-}\\cup K^{+}} = 0$ and $(\\nu q, v_{x})_{K^{-}\\cup K^{+}} = 0$.\n\nThe first equation of the weak form simplifies to:\n$$ (q,r)_{K^{-}\\cup K^{+}} - \\langle \\widehat{u}, r\\, n \\rangle_{F} = 0. $$\nLet $q$ and $r$ have constant values $(q^{-}, q^{+})$ and $(r^{-}, r^{+})$ on $(K^{-}, K^{+})$. The equation expands to:\n$$ \\int_{-h}^{0} q^{-} r^{-} dx + \\int_{0}^{h} q^{+} r^{+} dx - \\widehat{u} [[r]] = 0. $$\n$$ h q^{-} r^{-} + h q^{+} r^{+} - \\widehat{u} (r^{+} - r^{-}) = 0. $$\nRearranging the terms by factoring out $r^{-}$ and $r^{+}$ yields:\n$$ (h q^{-} + \\widehat{u}) r^{-} + (h q^{+} - \\widehat{u}) r^{+} = 0. $$\nThis equation must hold for all piecewise constant test functions $r$, meaning for any choice of $r^{-}$ and $r^{+}$. This is only possible if the coefficients of $r^{-}$ and $r^{+}$ are individually zero.\n$$ h q^{-} + \\widehat{u} = 0 \\implies q^{-} = -\\frac{\\widehat{u}}{h}. $$\n$$ h q^{+} - \\widehat{u} = 0 \\implies q^{+} = \\frac{\\widehat{u}}{h}. $$\nWe now use the given numerical flux for $u$, $\\widehat{u} = \\{u\\}$. Substituting this into the expressions for $q^{-}$ and $q^{+}$:\n$$ q^{-} = -\\frac{\\{u\\}}{h}, \\quad q^{+} = \\frac{\\{u\\}}{h}. $$\nNext, we determine the numerical flux $\\widehat{q}$. It is given as:\n$$ \\widehat{q} = \\{q\\} - \\frac{\\tau}{h}\\, [[u]]. $$\nThe average of $q$ is $\\{q\\} = (q^{+} + q^{-})/2 = (\\frac{\\{u\\}}{h} - \\frac{\\{u\\}}{h})/2 = 0$.\nThus, the numerical flux for $q$ simplifies to:\n$$ \\widehat{q} = -\\frac{\\tau}{h}\\, [[u]]. $$\nNow we turn to the second equation of the weak form. With $(\\nu q, v_{x})_{K^{-}\\cup K^{+}} = 0$, it becomes:\n$$ -\\langle \\nu \\widehat{q}, v\\, n \\rangle_{F} = (f,v)_{K^{-}\\cup K^{+}}. $$\nThe left-hand side defines the bilinear form induced by the LDG scheme, $a(u,v)$, while the right-hand side is the linear form $L(v)$. The face contribution to the bilinear form is:\n$$ a_{F}(u,v) = -\\langle \\nu \\widehat{q}, v\\, n \\rangle_{F} = -\\nu \\widehat{q} [[v]]. $$\nSubstituting the expression we found for $\\widehat{q}$:\n$$ a_{F}(u,v) = -\\nu \\left( -\\frac{\\tau}{h}\\, [[u]] \\right) [[v]] = \\nu \\frac{\\tau}{h}\\, [[u]]\\, [[v]]. $$\nThis is the LDG-induced penalty term at the face $F$.\n\n**Part 2: Derivation of the BR2 penalty term**\n\nThe Bassi–Rebay 2 (BR2) method introduces a lifting operator $r_{F}(u)$, which for a given jump $[[u]]$ is a piecewise constant function defined by the relation:\n$$ (r_{F}(u), w)_{K^{-}\\cup K^{+}} = \\langle [[u]], \\{w\\} \\rangle_{F} $$\nfor all piecewise constant test functions $w$. Let $r_{F}(u)$ be $(r_{F}^{-}, r_{F}^{+})$ and $w$ be $(w^{-}, w^{+})$ on $(K^{-}, K^{+})$. The left-hand side is:\n$$ (r_{F}(u), w)_{K^{-}\\cup K^{+}} = \\int_{-h}^{0} r_{F}^{-} w^{-} dx + \\int_{0}^{h} r_{F}^{+} w^{+} dx = h r_{F}^{-} w^{-} + h r_{F}^{+} w^{+}. $$\nThe right-hand side is:\n$$ \\langle [[u]], \\{w\\} \\rangle_{F} = [[u]] \\{w\\} = [[u]] \\frac{w^{+} + w^{-}}{2} = \\frac{1}{2}[[u]] w^{-} + \\frac{1}{2}[[u]] w^{+}. $$\nEquating the two sides:\n$$ h r_{F}^{-} w^{-} + h r_{F}^{+} w^{+} = \\frac{1}{2}[[u]] w^{-} + \\frac{1}{2}[[u]] w^{+}. $$\nThis must hold for all $w^{-}$ and $w^{+}$, so we can equate the coefficients:\n$$ h r_{F}^{-} = \\frac{1}{2} [[u]] \\implies r_{F}^{-} = \\frac{[[u]]}{2h}. $$\n$$ h r_{F}^{+} = \\frac{1}{2} [[u]] \\implies r_{F}^{+} = \\frac{[[u]]}{2h}. $$\nSo, the lifting operator $r_{F}(u)$ produces a constant function over the entire patch $K^{-} \\cup K^{+}$ with the value $\\frac{[[u]]}{2h}$.\n\nThe BR2 face penalty contribution is defined as $\\nu\\, (r_{F}(u), r_{F}(v))_{K^{-}\\cup K^{+}}$. We compute the inner product:\n$$ (r_{F}(u), r_{F}(v))_{K^{-}\\cup K^{+}} = \\int_{K^{-} \\cup K^{+}} r_{F}(u) r_{F}(v) dx. $$\nSince $r_{F}(u) = \\frac{[[u]]}{2h}$ and $r_{F}(v) = \\frac{[[v]]}{2h}$ are constant on the domain $K^{-} \\cup K^{+} = (-h, h)$, which has length $2h$:\n$$ (r_{F}(u), r_{F}(v))_{K^{-}\\cup K^{+}} = \\int_{-h}^{h} \\left(\\frac{[[u]]}{2h}\\right) \\left(\\frac{[[v]]}{2h}\\right) dx = (2h) \\left(\\frac{[[u]]}{2h}\\right) \\left(\\frac{[[v]]}{2h}\\right) = 2h \\frac{[[u]]\\,[[v]]}{4h^{2}} = \\frac{[[u]]\\,[[v]]}{2h}. $$\nTherefore, the BR2 penalty contribution is:\n$$ \\nu\\, (r_{F}(u), r_{F}(v))_{K^{-}\\cup K^{+}} = \\nu \\frac{1}{2h}\\, [[u]]\\, [[v]]. $$\n\n**Part 3: Comparison and determination of $\\tau$**\n\nWe are asked to find the value of the LDG stabilization parameter $\\tau > 0$ that matches the LDG-induced penalty to the BR2 penalty.\nFrom Part 1, the LDG penalty is $P_{\\text{LDG}} = \\nu\\,\\frac{\\tau}{h}\\, [[u]]\\, [[v]]$.\nFrom Part 2, the BR2 penalty is $P_{\\text{BR2}} = \\nu\\,\\frac{1}{2h}\\, [[u]]\\, [[v]]$.\n\nEquating the two penalty terms:\n$$ \\nu\\,\\frac{\\tau}{h}\\, [[u]]\\, [[v]] = \\nu\\,\\frac{1}{2h}\\, [[u]]\\, [[v]]. $$\nSince this identity must hold for any non-zero jump $[[u]]=[[v]]$, we can equate the coefficients:\n$$ \\nu\\,\\frac{\\tau}{h} = \\nu\\,\\frac{1}{2h}. $$\nGiven that the diffusivity $\\nu > 0$ and the element size $h > 0$, we can cancel these terms from both sides:\n$$ \\tau = \\frac{1}{2}. $$\nThis is the value of the LDG parameter $\\tau$ that makes the LDG penalty identical to the BR2 penalty on the face $F$ for the specified $p=0$ approximation.",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "The power and elegance of the BR2 scheme lie in its \"corrected gradient\" formulation, which recasts the viscous operator into a purely volume-based form. This practice provides direct experience with the core mechanism of BR2: the face-based lifting operator that enforces inter-element coupling. By calculating a specific off-diagonal entry of the stiffness matrix, you will trace how information is communicated across element boundaries through this essential lifting process .",
            "id": "3366134",
            "problem": "Consider the one-dimensional linear diffusion equation on the domain $[0,2h]$ with constant diffusivity,\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; \\nu \\,\\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\nand let $\\nu=1$. Discretize the spatial operator using the Discontinuous Galerkin (DG) method with the Bassi–Rebay 2 (BR2) scheme for viscous terms on a mesh of two elements: $K^{-}=[0,h]$ and $K^{+}=[h,2h]$. Use a polynomial degree $p=1$ modal basis that is orthonormal on the reference element $\\xi\\in[-1,1]$:\n$$\n\\psi_{0}(\\xi) \\;=\\; \\frac{1}{\\sqrt{2}}, \\qquad \\psi_{1}(\\xi) \\;=\\; \\sqrt{\\frac{3}{2}}\\,\\xi,\n$$\nand the affine mapping $x=x_{c}+\\frac{h}{2}\\,\\xi$ from the reference element to each physical element of length $h$. The corrected gradient in BR2 is defined by\n$$\ng_{h} \\;=\\; \\frac{\\partial u_{h}}{\\partial x} \\;+\\; \\eta \\sum_{f} r_{f}\\!\\left([u_{h}]\\right),\n$$\nwith $\\eta=1$, where $[u_{h}]$ denotes the jump of $u_{h}$ across an interior face and $r_{f}$ is the face-wise lifting operator. For the single interior face at $x=h$ joining $K^{-}$ and $K^{+}$, define the jump by\n$$\n[u_{h}] \\;=\\; u_{h}^{-}(h) - u_{h}^{+}(h),\n$$\nand define the lifting operators on each adjacent element $K^{\\pm}$ by the relations\n$$\n\\int_{K^{\\pm}} r_{f}^{\\pm}(\\psi)\\, w \\,\\mathrm{d}x \\;=\\; -\\frac{1}{2}\\,\\psi \\, w\\big|_{x=h}\n\\quad\\text{for all test functions } w \\text{ in the local basis on } K^{\\pm}.\n$$\nUsing these definitions and $\\nu=1$, form the bilinear form\n$$\nB(u_{h},v_{h}) \\;=\\; \\sum_{E\\in\\{K^{-},K^{+}\\}} \\int_{E} g_{h}(u_{h}) \\,\\frac{\\partial v_{h}}{\\partial x}\\,\\mathrm{d}x,\n$$\nand evaluate the single matrix entry that couples the left-element linear trial mode to the right-element linear test mode:\n$$\nu_{h}(x) \\;=\\; \n\\begin{cases}\n\\psi_{1}(\\xi(x)) & x\\in K^{-},\\\\\n0 & x\\in K^{+},\n\\end{cases}\n\\qquad\nv_{h}(x) \\;=\\; \n\\begin{cases}\n0 & x\\in K^{-},\\\\\n\\psi_{1}(\\xi(x)) & x\\in K^{+}.\n\\end{cases}\n$$\nCompute $B(u_{h},v_{h})$ exactly as an analytic expression in terms of $h$ only. State your final answer as a single closed-form expression. No rounding is required, and no physical units should be included in the final expression.",
            "solution": "The objective is to compute the bilinear form $B(u_{h},v_{h})$ for the given trial function $u_h$ and test function $v_h$. The bilinear form is defined as:\n$$\nB(u_{h},v_{h}) = \\sum_{E\\in\\{K^{-},K^{+}\\}} \\int_{E} g_{h}(u_{h}) \\,\\frac{\\partial v_{h}}{\\partial x}\\,\\mathrm{d}x\n$$\nThis sum can be split into two integrals, one over each element $K^{-} = [0, h]$ and $K^{+} = [h, 2h]$:\n$$\nB(u_{h},v_{h}) = \\int_{K^{-}} g_{h}(u_{h}) \\,\\frac{\\partial v_{h}}{\\partial x}\\,\\mathrm{d}x + \\int_{K^{+}} g_{h}(u_{h}) \\,\\frac{\\partial v_{h}}{\\partial x}\\,\\mathrm{d}x\n$$\nThe test function $v_h$ is defined to be zero on the element $K^{-}$. Consequently, its spatial derivative $\\frac{\\partial v_{h}}{\\partial x}$ is also zero on $K^{-}$. This makes the first integral vanish:\n$$\n\\int_{K^{-}} g_{h}(u_{h}) \\cdot 0 \\,\\mathrm{d}x = 0\n$$\nThus, the bilinear form simplifies to the integral over the element $K^{+}$ only:\n$$\nB(u_{h},v_{h}) = \\int_{K^{+}} g_{h}(u_{h}) \\,\\frac{\\partial v_{h}}{\\partial x}\\,\\mathrm{d}x\n$$\nNext, we examine the corrected gradient $g_{h}(u_{h})$ on the element $K^{+}$. The definition of $g_{h}$ is:\n$$\ng_{h}(u_{h}) = \\frac{\\partial u_{h}}{\\partial x} + \\eta \\sum_{f} r_{f}([u_{h}])\n$$\nwith $\\eta=1$. On the element $K^{+}$, the trial function $u_h$ is defined to be zero. Therefore, its derivative $\\frac{\\partial u_{h}}{\\partial x}$ is also zero on $K^{+}$. The sum over faces $f$ considers only the interior face at $x=h$ for the jump term. The corrected gradient on $K^{+}$ is thus composed solely of the lifting term from the face at $x=h$:\n$$\ng_{h}(u_{h})|_{K^{+}} = \\frac{\\partial u_{h}}{\\partial x}\\bigg|_{K^{+}} + r_{f}^{+}([u_{h}]) = 0 + r_{f}^{+}([u_{h}]) = r_{f}^{+}([u_{h}])\n$$\nHere, $r_{f}^{+}$ denotes the lifting operator acting on the element $K^{+}$. Substituting this into the expression for $B(u_{h},v_{h})$ yields:\n$$\nB(u_{h},v_{h}) = \\int_{K^{+}} r_{f}^{+}([u_{h}]) \\,\\frac{\\partial v_{h}}{\\partial x}\\,\\mathrm{d}x\n$$\nThe problem provides the definition for the lifting operator: for a scalar value $\\psi$, the function $r_f^{\\pm}(\\psi)$ is defined on $K^{\\pm}$ through the relation\n$$\n\\int_{K^{\\pm}} r_{f}^{\\pm}(\\psi)\\, w \\,\\mathrm{d}x = -\\frac{1}{2}\\,\\psi \\, w\\big|_{x=h} \\quad\\text{for all test functions } w \\text{ in the local basis on } K^{\\pm}.\n$$\nThe space of test functions on an element is the space of polynomials of degree up to $p=1$, which is spanned by the local basis functions. Let's analyze the term $w(x) = \\frac{\\partial v_{h}}{\\partial x}$ on $K^{+}$. The test function $v_h$ on $K^{+}$ is given by $v_{h}(x) = \\psi_{1}(\\xi(x))$. The mapping from the reference coordinate $\\xi$ to the physical coordinate $x$ on $K^{+} = [h, 2h]$ (center $x_c = 3h/2$, length $h$) is $x = \\frac{3h}{2} + \\frac{h}{2}\\xi$. From this, we have $\\xi(x) = \\frac{2}{h}(x - \\frac{3h}{2})$. The derivative of the mapping is $\\frac{d\\xi}{dx} = \\frac{2}{h}$.\nUsing the chain rule, we find the derivative of $v_h$:\n$$\n\\frac{\\partial v_{h}}{\\partial x} = \\frac{d\\psi_{1}}{d\\xi} \\frac{d\\xi}{dx}\n$$\nWith $\\psi_{1}(\\xi) = \\sqrt{\\frac{3}{2}}\\xi$, we have $\\frac{d\\psi_{1}}{d\\xi} = \\sqrt{\\frac{3}{2}}$.\n$$\n\\frac{\\partial v_{h}}{\\partial x} = \\sqrt{\\frac{3}{2}} \\cdot \\frac{2}{h} = \\frac{2\\sqrt{3}}{\\sqrt{2}h} = \\frac{\\sqrt{2}\\sqrt{2}\\sqrt{3}}{\\sqrt{2}h} = \\frac{\\sqrt{6}}{h}\n$$\nThis derivative is a constant, which is a polynomial of degree $0$. The local test function space on $K^{+}$ consists of all polynomials of degree up to $p=1$. Since a polynomial of degree $0$ is also a polynomial of degree $\\le 1$, the term $w(x) = \\frac{\\partial v_{h}}{\\partial x}$ is a valid test function in the local space on $K^{+}$.\n\nWe can therefore directly apply the defining relation for the lifting operator to evaluate the integral. Let $\\psi = [u_h]$ be the jump at the interface $x=h$, and let $w = \\frac{\\partial v_h}{\\partial x}$. The integral is then:\n$$\nB(u_{h},v_{h}) = \\int_{K^{+}} r_{f}^{+}([u_{h}]) \\,w(x)\\,\\mathrm{d}x = -\\frac{1}{2}\\,[u_h] \\, w(x)\\big|_{x=h}\n$$\nNow, we compute the two components on the right-hand side.\nFirst, the jump $[u_h]$ at $x=h$ is defined as $[u_{h}] = u_{h}^{-}(h) - u_{h}^{+}(h)$.\nThe function $u_h$ on the left element $K^{-} = [0,h]$ is $u_{h}^{-}(x) = \\psi_{1}(\\xi(x))$. The mapping for $K^{-}$ (center $x_c=h/2$) is $x = \\frac{h}{2} + \\frac{h}{2}\\xi$. At the interface $x=h$, we have $h = \\frac{h}{2} + \\frac{h}{2}\\xi$, which solves to $\\xi=1$. So, $u_{h}^{-}(h) = \\psi_{1}(1) = \\sqrt{\\frac{3}{2}}(1) = \\sqrt{\\frac{3}{2}}$.\nThe function $u_h$ on the right element $K^{+}$ is $u_{h}^{+}(x) = 0$, so $u_{h}^{+}(h)=0$.\nThe jump is $[u_h] = \\sqrt{\\frac{3}{2}} - 0 = \\sqrt{\\frac{3}{2}}$.\n\nSecond, the value of $w(x) = \\frac{\\partial v_h}{\\partial x}$ at $x=h$. We found that $w(x) = \\frac{\\sqrt{6}}{h}$, which is a constant. Its value at $x=h$ is thus:\n$$\nw(h) = \\frac{\\sqrt{6}}{h}\n$$\nFinally, we substitute these values into the expression for $B(u_{h},v_{h})$:\n$$\nB(u_{h},v_{h}) = -\\frac{1}{2} \\left( \\sqrt{\\frac{3}{2}} \\right) \\left( \\frac{\\sqrt{6}}{h} \\right) = -\\frac{1}{2h} \\sqrt{\\frac{3 \\cdot 6}{2}} = -\\frac{1}{2h} \\sqrt{\\frac{18}{2}} = -\\frac{1}{2h} \\sqrt{9} = -\\frac{3}{2h}\n$$",
            "answer": "$$\n\\boxed{-\\frac{3}{2h}}\n$$"
        },
        {
            "introduction": "Moving from theory to a functional simulation requires assembling global system matrices and analyzing their properties. This comprehensive exercise guides you through the full discretization of a time-dependent problem using a DG method with a BR2-type penalization (specifically, the equivalent Symmetric Interior Penalty Galerkin formulation). You will construct the mass and stiffness matrices for a 1D heat equation and then perform a stability analysis by calculating the system's spectral radius, a critical quantity for determining the maximum allowable time step in explicit integration schemes .",
            "id": "3366084",
            "problem": "Consider the heat equation in one space dimension, $u_{t} = \\nu \\, u_{xx}$, on the periodic interval $[0,2h]$ partitioned into $2$ elements of equal length $h$: element $1$ on $[0,h]$ and element $2$ on $[h,2h]$, with periodic identification of $x=0$ and $x=2h$. Use a Discontinuous Galerkin (DG) discretization with polynomial degree $p=1$ on each element, employing the nodal basis $\\{\\phi_{L}(\\xi), \\phi_{R}(\\xi)\\}$ on the reference element $\\xi \\in [-1,1]$ mapped affinely to each physical element, with $\\phi_{L}(\\xi) = \\frac{1-\\xi}{2}$ and $\\phi_{R}(\\xi) = \\frac{1+\\xi}{2}$. Discretize the viscous term using the Bassi and Rebay scheme of type $2$ (BR2) in its standard primal formulation, which in one dimension is equivalent to the symmetric interior penalty Galerkin (SIPG) method with penalty parameter $\\eta > 0$. Specifically, for trial function $u_{h}$ and test function $v_{h}$, the viscous bilinear form on the mesh is\n$$\na(u_{h},v_{h}) = \\sum_{K}\\int_{K} u_{x} v_{x}\\,dx \\;-\\; \\sum_{F}\\left(\\{u_{x}\\}[v] + \\{v_{x}\\}[u]\\right) \\;+\\; \\sum_{F} \\frac{\\eta}{h}[u][v],\n$$\nwhere $[w] = w^{+} - w^{-}$ is the jump across an interface $F$ with canonical normal pointing from the left element to the right element, and $\\{q\\} = \\frac{1}{2}(q^{-} + q^{+})$ is the average. Use exact integration for all volume and face terms. There are exactly $2$ faces in this periodic mesh: the interior face at $x=h$ and the periodic face identifying $x=2h$ with $x=0$.\n\n(a) Assemble explicitly the global mass matrix $M$ and the global stiffness matrix $K$ associated with $a(\\cdot,\\cdot)$ in the global basis ordered as $(\\text{element }1:\\, \\phi_{L},\\phi_{R};\\; \\text{element }2:\\, \\phi_{L},\\phi_{R})$.\n\n(b) Consider the semi-discrete system $M \\,\\dot{\\mathbf{u}}(t) + \\nu \\, K \\,\\mathbf{u}(t) = \\mathbf{0}$, and let $\\Lambda$ denote the spectral radius of the operator $\\nu\\,M^{-1}K$. Derive $\\Lambda$ in closed form as a function of $\\nu$, $\\eta$, and $h$, by analytical calculation of the eigenvalues.\n\nProvide your final answer for $\\Lambda$ as a single exact analytic expression in terms of $\\nu$, $\\eta$, and $h$. Do not include units.",
            "solution": "The user-provided problem is a well-posed and scientifically grounded exercise in the numerical analysis of partial differential equations, specifically using the Discontinuous Galerkin (DG) method. It requires the explicit assembly of system matrices for a simple heat equation problem and the subsequent analytical derivation of the spectral radius of the semi-discretized operator. All necessary information is provided, and the problem is internally consistent. We can therefore proceed with a full solution.\n\nThe solution is organized as follows. First, we define the local-to-global mappings and the basis functions on each physical element. Second, we compute the elemental mass and stiffness matrices. Third, we compute the contributions from the numerical fluxes at the element interfaces. Fourth, we assemble the global mass matrix $M$ and stiffness matrix $K$. Finally, we solve the generalized eigenvalue problem $K\\mathbf{u} = \\lambda' M\\mathbf{u}$ to find the spectrum of $M^{-1}K$ and thereby determine the spectral radius $\\Lambda$ of $\\nu M^{-1}K$.\n\n**Part (a): Assembly of Global Matrices $M$ and $K$**\n\n**1. Basis Functions and Mappings**\nThe domain $[0, 2h]$ is divided into two elements, $K_1 = [0, h]$ and $K_2 = [h, 2h]$. We use an affine mapping from the reference element $\\xi \\in [-1, 1]$ to each physical element $x \\in K_k$.\nFor element $K_1 = [0, h]$:\n$x(\\xi) = \\frac{h}{2}(1+\\xi)$. The Jacobian of this mapping is $J_1 = \\frac{dx}{d\\xi} = \\frac{h}{2}$.\nThe inverse mapping is $\\xi(x) = \\frac{2x}{h} - 1$, and $\\frac{d\\xi}{dx} = \\frac{2}{h}$.\n\nFor element $K_2 = [h, 2h]$:\n$x(\\xi) = h + \\frac{h}{2}(1+\\xi)$. The Jacobian is $J_2 = \\frac{dx}{d\\xi} = \\frac{h}{2}$.\nThe inverse mapping is $\\xi(x) = \\frac{2(x-h)}{h} - 1$, and $\\frac{d\\xi}{dx} = \\frac{2}{h}$.\n\nThe local nodal basis functions are $\\phi_L(\\xi) = \\frac{1-\\xi}{2}$ and $\\phi_R(\\xi) = \\frac{1+\\xi}{2}$. Their derivatives on the reference element are $\\frac{d\\phi_L}{d\\xi} = -\\frac{1}{2}$ and $\\frac{d\\phi_R}{d\\xi} = \\frac{1}{2}$.\nUsing the chain rule, the derivatives of the basis functions with respect to $x$ on any element are constant:\n$\\frac{d\\phi}{dx} = \\frac{d\\phi}{d\\xi}\\frac{d\\xi}{dx} = \\frac{d\\phi}{d\\xi} \\frac{2}{h}$.\nSo, for both elements, the derivatives of the mapped basis functions are $\\frac{d\\phi_L}{dx} = -\\frac{1}{h}$ and $\\frac{d\\phi_R}{dx} = \\frac{1}{h}$.\n\nThe global basis functions are denoted by $v_1, v_2, v_3, v_4$, corresponding to $(\\text{element }1: \\phi_L, \\phi_R)$ and $(\\text{element }2: \\phi_L, \\phi_R)$.\n\n**2. Mass Matrix $M$**\nThe mass matrix entries are $M_{ij} = \\int_{0}^{2h} v_i v_j \\, dx$. Since the basis functions have support only on a single element, the global mass matrix is block-diagonal: $M = \\begin{pmatrix} M^{(1)} & 0 \\\\ 0 & M^{(2)} \\end{pmatrix}$.\nThe local mass matrix for an element $K$ is given by $M_{ij}^{\\text{local}} = \\int_K \\phi_i \\phi_j \\, dx = \\int_{-1}^1 \\phi_i(\\xi) \\phi_j(\\xi) J \\, d\\xi$.\nSince $J_1=J_2=h/2$, the local mass matrices are identical for both elements.\n$M_{11}^{\\text{local}} = \\int_{-1}^1 (\\frac{1-\\xi}{2})^2 \\frac{h}{2} d\\xi = \\frac{h}{8} [\\xi - \\xi^2 + \\frac{\\xi^3}{3}]_{-1}^1 = \\frac{h}{8} (\\frac{8}{3}) = \\frac{h}{3}$.\n$M_{22}^{\\text{local}} = \\int_{-1}^1 (\\frac{1+\\xi}{2})^2 \\frac{h}{2} d\\xi = \\frac{h}{8} [\\xi + \\xi^2 + \\frac{\\xi^3}{3}]_{-1}^1 = \\frac{h}{8} (\\frac{8}{3}) = \\frac{h}{3}$.\n$M_{12}^{\\text{local}} = M_{21}^{\\text{local}} = \\int_{-1}^1 (\\frac{1-\\xi}{2})(\\frac{1+\\xi}{2}) \\frac{h}{2} d\\xi = \\frac{h}{8} [\\xi - \\frac{\\xi^3}{3}]_{-1}^1 = \\frac{h}{8}(\\frac{4}{3}) = \\frac{h}{6}$.\nSo, the local mass matrix is $M^{\\text{local}} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$.\nThe global mass matrix is:\n$$M = \\frac{h}{6} \\begin{pmatrix} 2 & 1 & 0 & 0 \\\\ 1 & 2 & 0 & 0 \\\\ 0 & 0 & 2 & 1 \\\\ 0 & 0 & 1 & 2 \\end{pmatrix}$$\n\n**3. Stiffness Matrix $K$**\nThe stiffness matrix $K$ is assembled from the bilinear form $a(u_h, v_h)$ with entries $K_{ij} = a(v_j, v_i)$. It consists of a volume contribution and two face contributions.\n$a(v_j, v_i) = \\sum_K \\int_K (v_j)_x (v_i)_x \\, dx - \\sum_F (\\ \\{(v_j)_x\\}[v_i] + \\{(v_i)_x\\}[v_j] \\ ) + \\sum_F \\frac{\\eta}{h} [v_j][v_i]$.\n\n**Volume Contribution:** The local stiffness contribution from the volume integral is $K_{ij}^{\\text{vol}} = \\int_K (v_i)_x (v_j)_x \\, dx$.\n$K^{\\text{vol}} = \\int_0^h \\begin{pmatrix} (-1/h)^2 & (-1/h)(1/h) \\\\ (1/h)(-1/h) & (1/h)^2 \\end{pmatrix} dx = \\frac{1}{h^2} \\int_0^h \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} dx = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nThis is the same for both elements. The total volume contribution to $K$ is $K^{\\text{vol, global}} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 & 0 & 0 \\\\ -1 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & -1 \\\\ 0 & 0 & -1 & 1 \\end{pmatrix}$.\n\n**Face Contributions:** There are two faces: $F_1$ at $x=h$ and $F_2$ at $x=0 \\equiv 2h$ (periodic).\nFor a face term involving test function $v_i$ and trial function $v_j$, the contribution to the matrix is $S_{ij} = -(\\{(v_j)_x\\}[v_i] + \\{(v_i)_x\\}[v_j]) + \\frac{\\eta}{h} [v_j][v_i]$.\n\n*   **Face $F_1$ at $x=h$**: Normal points from $K_1$ (side $-$) to $K_2$ (side $+$). The interacting basis functions are $v_2$ (from $K_1$) and $v_3$ (from $K_2$).\n    Function values at $x=h$: $v_2^-(h)=1$, $v_2^+(h)=0$; $v_3^-(h)=0$, $v_3^+(h)=1$.\n    Jumps: $[v_2] = v_2^+ - v_2^- = -1$, $[v_3] = v_3^+ - v_3^- = 1$. Other jumps are $0$.\n    Derivatives at $x=h$: $(v_2)_x^-(h)=1/h$, $(v_3)_x^+(h)=-1/h$.\n    Averages: $\\{(v_2)_x\\} = \\frac{1}{2}(1/h + 0) = \\frac{1}{2h}$, $\\{(v_3)_x\\} = \\frac{1}{2}(0 - 1/h) = -\\frac{1}{2h}$.\n    The non-zero contributions from this face are:\n    $K_{22} \\leftarrow S_{22} = -2\\{(v_2)_x\\}[v_2] + \\frac{\\eta}{h}[v_2]^2 = -2(\\frac{1}{2h})(-1) + \\frac{\\eta}{h}(-1)^2 = \\frac{1}{h} + \\frac{\\eta}{h}$.\n    $K_{33} \\leftarrow S_{33} = -2\\{(v_3)_x\\}[v_3] + \\frac{\\eta}{h}[v_3]^2 = -2(-\\frac{1}{2h})(1) + \\frac{\\eta}{h}(1)^2 = \\frac{1}{h} + \\frac{\\eta}{h}$.\n    $K_{23} \\leftarrow S_{32} = -(\\{(v_2)_x\\}[v_3] + \\{(v_3)_x\\}[v_2]) + \\frac{\\eta}{h}[v_2][v_3] = -((\\frac{1}{2h})(1) + (-\\frac{1}{2h})(-1)) + \\frac{\\eta}{h}(-1)(1) = -\\frac{1}{h} - \\frac{\\eta}{h}$.\n    $K_{32} \\leftarrow S_{23} = K_{23}$.\n\n*   **Face $F_2$ at $x=0 \\equiv 2h$**: Normal points from $K_2$ (side $-$) to $K_1$ (side $+$). Interacting functions are $v_4$ (from $K_2$) and $v_1$ (from $K_1$).\n    Function values: $v_4^-(2h)=1$, $v_4^+(0)=0$; $v_1^-(2h)=0$, $v_1^+(0)=1$.\n    Jumps: $[v_4] = v_4^+ - v_4^- = -1$, $[v_1] = v_1^+ - v_1^- = 1$.\n    Derivatives: $(v_4)_x^-(2h)=1/h$, $(v_1)_x^+(0)=-1/h$.\n    Averages: $\\{(v_4)_x\\} = \\frac{1}{2h}$, $\\{(v_1)_x\\} = -\\frac{1}{2h}$.\n    The non-zero contributions are:\n    $K_{11} \\leftarrow S_{11} = -2\\{(v_1)_x\\}[v_1] + \\frac{\\eta}{h}[v_1]^2 = -2(-\\frac{1}{2h})(1) + \\frac{\\eta}{h}(1)^2 = \\frac{1}{h} + \\frac{\\eta}{h}$.\n    $K_{44} \\leftarrow S_{44} = -2\\{(v_4)_x\\}[v_4] + \\frac{\\eta}{h}[v_4]^2 = -2(\\frac{1}{2h})(-1) + \\frac{\\eta}{h}(-1)^2 = \\frac{1}{h} + \\frac{\\eta}{h}$.\n    $K_{14} \\leftarrow S_{41} = -(\\{(v_1)_x\\}[v_4] + \\{(v_4)_x\\}[v_1]) + \\frac{\\eta}{h}[v_1][v_4] = -((-\\frac{1}{2h})(-1) + (\\frac{1}{2h})(1)) + \\frac{\\eta}{h}(1)(-1) = -\\frac{1}{h} - \\frac{\\eta}{h}$.\n    $K_{41} \\leftarrow S_{14} = K_{14}$.\n\nSumming all contributions: $K = K^{\\text{vol, global}} + K^{F_1} + K^{F_2}$.\n$$K = \\frac{1}{h} \\begin{pmatrix} 1 & -1 & 0 & 0 \\\\ -1 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & -1 \\\\ 0 & 0 & -1 & 1 \\end{pmatrix} + \\frac{1}{h} \\begin{pmatrix} 1+\\eta & 0 & 0 & -1-\\eta \\\\ 0 & 1+\\eta & -1-\\eta & 0 \\\\ 0 & -1-\\eta & 1+\\eta & 0 \\\\ -1-\\eta & 0 & 0 & 1+\\eta \\end{pmatrix}$$\n$$K = \\frac{1}{h} \\begin{pmatrix} 2+\\eta & -1 & 0 & -1-\\eta \\\\ -1 & 2+\\eta & -1-\\eta & 0 \\\\ 0 & -1-\\eta & 2+\\eta & -1 \\\\ -1-\\eta & 0 & -1 & 2+\\eta \\end{pmatrix}$$\n\n**Part (b): Spectral Radius of $\\nu M^{-1}K$**\n\nWe need to find the eigenvalues $\\lambda$ of the operator $\\nu M^{-1}K$. This is equivalent to finding the eigenvalues $\\lambda'$ of the generalized eigenvalue problem $K\\mathbf{u} = \\lambda' M\\mathbf{u}$, where $\\lambda = \\nu\\lambda'$. The spectral radius is $\\Lambda = \\max|\\lambda| = \\nu \\max|\\lambda'|$.\n\nThe matrices $M$ and $K$ have a block circulant structure. Let $M_0 = \\frac{h}{6}\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$, $A_0 = \\frac{1}{h}\\begin{pmatrix} 2+\\eta & -1 \\\\ -1 & 2+\\eta \\end{pmatrix}$, and $A_1 = \\frac{1}{h}\\begin{pmatrix} 0 & -1-\\eta \\\\ -1-\\eta & 0 \\end{pmatrix}$.\nThen $M = \\begin{pmatrix} M_0 & 0 \\\\ 0 & M_0 \\end{pmatrix}$ and $K = \\begin{pmatrix} A_0 & A_1 \\\\ A_1 & A_0 \\end{pmatrix}$.\nThe eigenvalue problem $K\\mathbf{u} = \\lambda' M\\mathbf{u}$ decouples into two smaller $2 \\times 2$ problems by considering eigenvectors of the form $(\\mathbf{v}^T, \\mathbf{v}^T)^T$ and $(\\mathbf{w}^T, -\\mathbf{w}^T)^T$.\nThis leads to the two generalized eigenvalue problems:\n1. $(A_0 + A_1)\\mathbf{v} = \\lambda' M_0 \\mathbf{v}$\n2. $(A_0 - A_1)\\mathbf{w} = \\lambda' M_0 \\mathbf{w}$\n\n**Case 1:**\n$A_0+A_1 = \\frac{1}{h}\\left( \\begin{pmatrix} 2+\\eta & -1 \\\\ -1 & 2+\\eta \\end{pmatrix} + \\begin{pmatrix} 0 & -1-\\eta \\\\ -1-\\eta & 0 \\end{pmatrix} \\right) = \\frac{1}{h}\\begin{pmatrix} 2+\\eta & -2-\\eta \\\\ -2-\\eta & 2+\\eta \\end{pmatrix}$.\nWe solve $\\det(\\frac{1}{h}(A_0+A_1) - \\lambda' M_0) = 0$. Let $\\mu = \\lambda' \\frac{h^2}{6}$.\n$\\det \\left( \\frac{1}{h} \\begin{pmatrix} 2+\\eta & -2-\\eta \\\\ -2-\\eta & 2+\\eta \\end{pmatrix} - \\frac{6\\mu}{h^2} \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\right) = 0$.\n$\\det \\begin{pmatrix} 2+\\eta-2\\mu & -2-\\eta-\\mu \\\\ -2-\\eta-\\mu & 2+\\eta-2\\mu \\end{pmatrix} = 0$.\n$(2+\\eta-2\\mu)^2 - (2+\\eta+\\mu)^2 = 0$.\nFactoring the difference of squares: $((2+\\eta-2\\mu) - (2+\\eta+\\mu))((2+\\eta-2\\mu) + (2+\\eta+\\mu)) = 0$.\n$(-3\\mu)(4+2\\eta-\\mu) = 0$.\nThe solutions are $\\mu_1 = 0$ and $\\mu_2 = 4+2\\eta$.\nThis gives eigenvalues for $\\lambda'$:\n$\\lambda'_1 = 0$.\n$\\lambda'_2 = \\mu_2 \\frac{6}{h^2} = \\frac{6(4+2\\eta)}{h^2} = \\frac{12(2+\\eta)}{h^2}$.\n\n**Case 2:**\n$A_0-A_1 = \\frac{1}{h}\\left( \\begin{pmatrix} 2+\\eta & -1 \\\\ -1 & 2+\\eta \\end{pmatrix} - \\begin{pmatrix} 0 & -1-\\eta \\\\ -1-\\eta & 0 \\end{pmatrix} \\right) = \\frac{1}{h}\\begin{pmatrix} 2+\\eta & \\eta \\\\ \\eta & 2+\\eta \\end{pmatrix}$.\nWe solve $\\det(\\frac{1}{h}(A_0-A_1) - \\lambda' M_0) = 0$. Let $\\mu = \\lambda' \\frac{h^2}{6}$.\n$\\det \\begin{pmatrix} 2+\\eta-2\\mu & \\eta-\\mu \\\\ \\eta-\\mu & 2+\\eta-2\\mu \\end{pmatrix} = 0$.\n$(2+\\eta-2\\mu)^2 - (\\eta-\\mu)^2 = 0$.\nFactoring: $((2+\\eta-2\\mu) - (\\eta-\\mu))((2+\\eta-2\\mu) + (\\eta-\\mu)) = 0$.\n$(2-\\mu)(2+2\\eta-3\\mu)=0$.\nThe solutions for $\\mu$ are $\\mu_3 = 2$ and $\\mu_4 = \\frac{2+2\\eta}{3}$.\nThis gives eigenvalues for $\\lambda'$:\n$\\lambda'_3 = \\mu_3 \\frac{6}{h^2} = 2 \\frac{6}{h^2} = \\frac{12}{h^2}$.\n$\\lambda'_4 = \\mu_4 \\frac{6}{h^2} = \\frac{2(1+\\eta)}{3} \\frac{6}{h^2} = \\frac{4(1+\\eta)}{h^2}$.\n\n**Find the Spectral Radius**\nThe four eigenvalues of $M^{-1}K$ are $\\lambda'_1=0$, $\\lambda'_2 = \\frac{12(2+\\eta)}{h^2}$, $\\lambda'_3 = \\frac{12}{h^2}$, and $\\lambda'_4 = \\frac{4(1+\\eta)}{h^2}$. Since $\\eta > 0$, all these eigenvalues are real and non-negative. The spectral radius of $M^{-1}K$ is the maximum of these values.\n- Comparing $\\lambda'_2$ and $\\lambda'_3$: $\\frac{12(2+\\eta)}{h^2} > \\frac{12}{h^2}$ because $2+\\eta > 1$.\n- Comparing $\\lambda'_2$ and $\\lambda'_4$: We compare $12(2+\\eta)$ with $4(1+\\eta)$. This is equivalent to comparing $3(2+\\eta) = 6+3\\eta$ with $1+\\eta$. The difference is $5+2\\eta$, which is positive for $\\eta>0$. Thus, $\\lambda'_2 > \\lambda'_4$.\n\nThe maximum eigenvalue is $\\lambda'_{\\max} = \\lambda'_2 = \\frac{12(2+\\eta)}{h^2}$.\nThe spectral radius $\\Lambda$ of the operator $\\nu M^{-1}K$ is:\n$\\Lambda = \\nu \\cdot \\lambda'_{\\max} = \\nu \\frac{12(2+\\eta)}{h^2}$.",
            "answer": "$$\\boxed{\\frac{12\\nu(2+\\eta)}{h^2}}$$"
        }
    ]
}