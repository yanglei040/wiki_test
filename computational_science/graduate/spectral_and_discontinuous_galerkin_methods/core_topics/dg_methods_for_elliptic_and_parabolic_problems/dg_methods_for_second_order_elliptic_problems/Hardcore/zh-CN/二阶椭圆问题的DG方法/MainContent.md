## 引言
[二阶椭圆问题](@entry_id:754613)是描述众多物理现象的基础模型，从[热传导](@entry_id:147831)到弹性力学，其精确高效的数值求解至关重要。传统的连续有限元方法在处理复杂几何、[非匹配网格](@entry_id:168552)和不连续系数时面临挑战，而间断Galerkin（DG）方法以其独特的灵活性和局部性，为解决这些难题提供了强有力的框架。然而，DG方法的强大功能也伴随着其理论的复杂性：如何在不连续的[函数空间](@entry_id:143478)上构建稳定的离散格式？如何设计数值通量来正确传递单元间的信息？这些是理解和应用DG方法的关键障碍。

本文旨在系统性地剖析求解[二阶椭圆问题](@entry_id:754613)的[DG方法](@entry_id:748369)。通过三个层次分明的章节，我们将带领读者从理论基础走向实际应用。在“原理与机制”一章中，我们将深入探讨[DG方法](@entry_id:748369)的核心，从[破碎函数空间](@entry_id:746988)的定义出发，推导经典的SIPG格式，并分析其稳定性的来源。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示[DG方法](@entry_id:748369)如何处理异构介质、复杂边界条件，并阐述其在自适应网格加密（AMR）中的强大能力。最后，“动手实践”部分将通过具体的计算问题，巩固读者对理论的理解。学完本文，读者将对DG方法的构建、分析与应用建立起一个全面而深入的认识。

## 原理与机制

在上一章引言的基础上，本章旨在深入剖析求解[二阶椭圆问题](@entry_id:754613)的间断Galerkin（Discontinuous Galerkin, DG）方法的核心原理与关键机制。我们将从构建[DG方法](@entry_id:748369)所必需的数学基础——“破碎”函数空间出发，系统地推导出典型的对称内罚（Symmetric Interior Penalty Galerkin, SIPG）格式。随后，我们将探讨保证该方法稳定性的核心机制，即罚参数的选取，并阐述与实际计算实现紧密相关的技术细节，如[参考单元](@entry_id:168425)变换和[数值积分](@entry_id:136578)。进一步，我们将分析[DG方法](@entry_id:748369)所产生的代数系统的结构特性。最后，本章将介绍两种重要的DG方法变体：局部间断Galerkin（Local Discontinuous Galerkin, [LDG](@entry_id:751395)）方法和可杂交间断Galerkin（Hybridizable Discontinuous Galerkin, HDG）方法，并阐明它们各自的独特优势。

### DG方法的基础：[破碎函数空间](@entry_id:746988)与[数值通量](@entry_id:752791)

与要求解在整个区域内满足一定连续性的标准有限元方法不同，[DG方法](@entry_id:748369)构建于“破碎”（broken）的函数空间之上，它允许函数在单元边界上存在间断。这为处理复杂几何、[非匹配网格](@entry_id:168552)以及局部适应性提供了极大的灵活性。

#### [破碎Sobolev空间](@entry_id:746989)

让我们首先精确定义DG方法的工作空间。给定求解区域 $\Omega$ 的一个剖分 $\mathcal{T}_h$，该剖分由有限个互不重叠的开单元 $K$ 组成。我们定义**[破碎Sobolev空间](@entry_id:746989)** $H^1(\mathcal{T}_h)$ 为：
$$
H^1(\mathcal{T}_h) = \{ v \in L^2(\Omega) : v|_K \in H^1(K) \text{ for all } K \in \mathcal{T}_h \}
$$
其中 $v|_K$ 表示函数 $v$ 在单元 $K$ 上的限制。这个定义的核心在于，它只要求函数在每个单元 $K$ 内部是 $H^1$ 正则的（即函数本身及其一阶[弱导数](@entry_id:189356)在 $K$ 上是平方可积的），但对函数跨越单元边界的行为不施加任何连续性约束 。因此，$H^1(\mathcal{T}_h)$ 中的函数通常是间断的。相应地，我们可以定义**破碎梯度**（或称分片梯度）$\nabla_h v$，其在每个单元 $K$ 上的定义就是该单元上函数限制的梯度，即 $(\nabla_h v)|_K = \nabla (v|_K)$。由于每个 $\nabla(v|_K)$ 都是 $L^2(K)$ 中的向量场，且单元数量有限，易知 $\nabla_h v$ 整体上也属于 $L^2(\Omega)^d$ 。

标准Sobolev空间 $H^1(\Omega)$ 是 $H^1(\mathcal{T}_h)$ 的一个真[子空间](@entry_id:150286)。任何 $H^1(\Omega)$ 中的函数自然满足 $H^1(\mathcal{T}_h)$ 的定义，并且根据[迹定理](@entry_id:203967)，它们在任意内部界面上的迹是单值的，即从相邻两个单元逼近界面时，函数值是相同的。

#### 界面上的算子：跳跃与平均

由于 $H^1(\mathcal{T}_h)$ 中函数的间断性，我们需要引入新的算子来描述函数在单元界面（在二维中是边，三维中是面）上的行为。考虑一个共享于单元 $K^-$ 和 $K^+$ 之间的内部界面 $F$。设 $\boldsymbol{n}^-$ 和 $\boldsymbol{n}^+$ 分别为 $F$ 相对于 $K^-$ 和 $K^+$ 的单位外法向向量（注意 $\boldsymbol{n}^- = -\boldsymbol{n}^+$）。对于一个标量函数 $v \in H^1(\mathcal{T}_h)$ 和一个向量函数 $\boldsymbol{q}$，我们定义**跳跃**（jump）算子 $[[\cdot]]$ 和**平均**（average）算子 $\{\!\{\cdot\}\!\}$ 如下：
-   标量跳跃: $[[v]] = v^- \boldsymbol{n}^- + v^+ \boldsymbol{n}^+$
-   向量法向分量跳跃: $[[\boldsymbol{q} \cdot \boldsymbol{n}]] = \boldsymbol{q}^- \cdot \boldsymbol{n}^- + \boldsymbol{q}^+ \cdot \boldsymbol{n}^+$
-   标量平均: $\{\!\{v\}\!\} = \frac{1}{2}(v^- + v^+)$
-   向量平均: $\{\!\{\boldsymbol{q}\}\!\} = \frac{1}{2}(\boldsymbol{q}^- + \boldsymbol{q}^+)$
-   向量法向分量平均: $\{\!\{\boldsymbol{q} \cdot \boldsymbol{n}\}\!\} = \frac{1}{2}(\boldsymbol{q}^- \cdot \boldsymbol{n}^- + \boldsymbol{q}^+ \cdot \boldsymbol{n}^+)$

这里的上标 $^-$ 和 $^+$ 分别表示从 $K^-$ 和 $K^+$ 一侧取迹。在许多文献中，标量跳跃也被定义为无方向的 $v^- - v^+$，这需要在使用时明确[法向量](@entry_id:264185)的方向。我们在此采用带法向的定义，这在公式推导中更为稳健。对于属于 $H^1(\Omega)$ 的[连续函数](@entry_id:137361) $w$，其在任何内部界面上的跳跃均为零，即 $[[w]] = 0$ 。

#### 从单元[弱形式](@entry_id:142897)到[DG格式](@entry_id:178043)

考虑[二阶椭圆问题](@entry_id:754613) $-\nabla \cdot (\kappa \nabla u) = f$。DG方法的起点是在每个单元 $K$ 上写出其[弱形式](@entry_id:142897)。将方程乘以一个[检验函数](@entry_id:166589) $v \in H^1(\mathcal{T}_h)$ 并在 $K$ 上积分，然后使用分部积分（[Green公式](@entry_id:173118)），我们得到：
$$
\int_K \kappa \nabla u \cdot \nabla v \, d\boldsymbol{x} - \int_{\partial K} (\kappa \nabla u \cdot \boldsymbol{n}_K) v \, dS = \int_K f v \, d\boldsymbol{x}
$$
其中 $\boldsymbol{n}_K$ 是单元 $K$ 边界 $\partial K$ 上的单位外法向。将上式在所有单元 $K \in \mathcal{T}_h$ 上求和，我们会得到一系列跨单元边界的积分项。[DG方法](@entry_id:748369)的核心思想就是用精心设计的**数值通量**（numerical flux）来替代这些边界积分项中的物理通量 $\kappa \nabla u \cdot \boldsymbol{n}$ 和解的迹 $u$，从而将所有单元耦合起来。不同的[数值通量](@entry_id:752791)定义会导出不同性质的DG方法。

### 对称内罚Galerkin（SIPG）方法

[SIPG方法](@entry_id:754927)是求解[椭圆问题](@entry_id:146817)最常用的一种[DG格式](@entry_id:178043)。其[双线性形式](@entry_id:746794) $a_h(u, v)$ 由三部分组成：
$$
a_h(u, v) = \sum_{K \in \mathcal{T}_h} \int_K \kappa \nabla_h u \cdot \nabla_h v \, d\boldsymbol{x} - \sum_{F \in \mathcal{F}_h} \int_F \left( \{\!\{\kappa \nabla_h u\}\!\} \cdot [[v]] + \{\!\{\kappa \nabla_h v\}\!\} \cdot [[u]] \right) dS + \sum_{F \in \mathcal{F}_h} \int_F \frac{\sigma}{h_F} [[u]] \cdot [[v]] \, dS
$$
让我们逐项分析其构成和作用 。

1.  **体积项**: $\sum_{K} \int_K \kappa \nabla_h u \cdot \nabla_h v \, d\boldsymbol{x}$。这是最直观的部分，即在每个单元内部计算的[弱形式](@entry_id:142897)拉普拉斯算子。

2.  **一致性与对称性项**: $-\sum_{F} \int_F (\{\!\{\kappa \nabla_h u\}\!\} \cdot [[v]] + \{\!\{\kappa \nabla_h v\}\!\} \cdot [[u]]) \, dS$。
    *   第一部分 $-\int_F \{\!\{\kappa \nabla_h u\}\!\} \cdot [[v]] \, dS$ 被称为**一致性项**。如果 $u$ 是方程的真实光滑解，那么 $\kappa \nabla u$ 是连续的，其平均值 $\{\!\{\kappa \nabla u\}\!\}$ 就等于其在界面上的真实值。这一项与[分部积分](@entry_id:136350)产生的边界项形式上一致，保证了当真实解代入时，方法能够还原原方程的弱形式，此即**一致性**。
    *   第二部分 $-\int_F \{\!\{\kappa \nabla_h v\}\!\} \cdot [[u]] \, dS$ 被称为**对称性项**。它的引入使得整个[双线性形式](@entry_id:746794) $a_h(u, v)$ 对于交换 $u$ 和 $v$ 是对称的，即 $a_h(u, v) = a_h(v, u)$。这确保了最终产生的[刚度矩阵](@entry_id:178659)是对称的，这在代数求解中是一个非常有利的性质。

3.  **内罚项**: $\sum_{F} \int_F \frac{\sigma}{h_F} [[u]] \cdot [[v]] \, dS$。
    *   这一项是对解在界面上的跳跃进行惩罚，因此称为**内罚项**。$\sigma$ 是一个无量纲的正常数，称为**罚参数**；$h_F$ 是界面的特征尺寸。当 $u$ 和 $v$ 相同时，该项为 $\frac{\sigma}{h_F} \|[[u]]\|_{L^2(F)}^2$，它惩罚了函数的不连续性，从而弱形式地“强制”解趋向于连续。更重要的是，这一项为整个[双线性形式](@entry_id:746794)提供了稳定性（或称[矫顽性](@entry_id:159399)），这将在下一节详细讨论。

通过一个具体的计算实例，我们可以更清楚地理解这些抽象的定义。假设在两个相邻的矩形单元 $K_1 = (0,1) \times (0,1)$ 和 $K_2 = (1,2) \times (0,1)$ 上，定义了分片线性函数 $u_h$ 和 $v_h$，[扩散](@entry_id:141445)系数 $\kappa$ 在 $K_1$ 上为2，在 $K_2$ 上为3。为了计算内部界面 $F$ (在 $x=1$ 处) 对 $a_h(u_h, v_h)$ 的贡献，我们需要 ：
1.  计算 $u_h, v_h$ 在 $F$ 两侧的迹 $u_h^-, u_h^+, v_h^-, v_h^+$。
2.  利用迹计算跳跃 $[[u_h]], [[v_h]]$。
3.  计算 $u_h, v_h$ 在两个单元内的梯度 $\nabla u_h^-, \nabla u_h^+, \nabla v_h^-, \nabla v_h^+$。
4.  结合[法向量](@entry_id:264185)和[扩散](@entry_id:141445)系数，计算[梯度向量](@entry_id:141180)的迹，并求其平均 $\{\!\{\kappa \nabla u_h\}\!\}$ 和 $\{\!\{\kappa \nabla v_h\}\!\}$。
5.  将以上所有量代入SIPG界[面积分](@entry_id:275394)公式中，并沿界面 $F$ 进行积分。这个过程虽然繁琐，但完全是按部就班的代数运算，是[DG方法](@entry_id:748369)编程实现的核心部分。

### DG方法的关键机制

#### 稳定性的基石：罚参数

[破碎Sobolev空间](@entry_id:746989) $H^1(\mathcal{T}_h)$ 上的范数必须能[控制函数](@entry_id:183140)的梯度和跳跃。仅有体积项 $\sum_K \|\nabla_h v\|_{L^2(K)}^2$ 是不足以构成一个范数的，因为它对于任意分片[常数函数](@entry_id:152060)其值都为零 。SIPG格式通过引入内罚项来解决这个问题。完整的DG范数定义为：
$$
\|v\|_{\mathrm{DG}}^2 := \sum_{K \in \mathcal{T}_h} \|\nabla v\|_{L^2(K)}^2 + \sum_{F \in \mathcal{F}_i \cup \mathcal{F}_b} \frac{\sigma}{h_F} \|[[v]]\|_{L^2(F)}^2
$$
其中 $\mathcal{F}_i$ 和 $\mathcal{F}_b$ 分别是内部和边界界面集合。可以证明，只要罚参数 $\sigma$ 取得足够大，SIPG双线性形式就是关于此DG范数矫顽的（coercive），即存在常数 $\alpha > 0$ 使得 $a_h(v, v) \ge \alpha \|v\|_{\mathrm{DG}}^2$。

那么，“足够大”是多大呢？这涉及到DG理论中的一个核心结果：**[迹不等式](@entry_id:756082)**（trace inequality）和**反不等式**（inverse inequality）。在证明[矫顽性](@entry_id:159399)时，对称性项会产生一个负项，需要被罚项和体积项控制住。通过应用Cauchy-Schwarz不等式和[迹不等式](@entry_id:756082)，可以发现为了保证[矫顽性](@entry_id:159399)，无量纲罚参数 $\sigma$ 必须满足一个依赖于多项式次数 $p$ 的下界条件。一个典型的定标关系是 $\sigma \ge C p^2$，其中 $C$ 是一个只依赖于网格[形状规则性](@entry_id:754733)和[扩散](@entry_id:141445)系数的常数 。
-   $p^2$ 因子来自于[多项式空间](@entry_id:144410)上的反不等式，它量化了多项式在边界上的范数与其在内部的范数之间的关系。次数越高，边界上的震荡可能越剧烈，需要更强的惩罚。
-   当处理**[非均匀介质](@entry_id:750241)**问题时，常数 $C$ 还将依赖于界面两侧[扩散](@entry_id:141445)系数的对比度，以确保足够的稳定性。

#### 计算的实现：参考单元与数值积分

在实际编程中，所有计算都在一个标准的**参考单元** $\widehat{K}$（例如，对于三角形是单位直角三角形，对于四边形是 $[-1,1]^2$ 的正方形）上进行。物理单元 $K$ 上的积分通过一个可逆映射 $T_K: \widehat{K} \to K$ 变换到[参考单元](@entry_id:168425)上。
$$
\int_K \kappa \nabla u \cdot \nabla v \, d\boldsymbol{x} = \int_{\widehat{K}} \kappa (\boldsymbol{J}^{-T} \widehat{\nabla} \widehat{u}) \cdot (\boldsymbol{J}^{-T} \widehat{\nabla} \widehat{v}) |\det(\boldsymbol{J})| \, d\widehat{\boldsymbol{x}}
$$
其中 $\boldsymbol{J}$ 是映射 $T_K$ 的[雅可比矩阵](@entry_id:264467)，$\widehat{\nabla}$ 是在参考坐标下的梯度。[基函数](@entry_id:170178)通常也在[参考单元](@entry_id:168425)上定义，例如使用勒让德（Legendre）多项式的张量积构成**[模态基](@entry_id:752055)**（modal basis） 。通过这个变换，我们可以预计算[参考单元](@entry_id:168425)上的各种积分（例如质量矩阵和刚度矩阵），然后在每个物理单元上通过[雅可比矩阵](@entry_id:264467)进行伸缩和旋转，这极大地提高了[计算效率](@entry_id:270255)。

由于被积函数通常是高次多项式，解析积分不可行，因此必须使用**[数值积分](@entry_id:136578)**（quadrature）。一个关键问题是：需要多高精度的[求积公式](@entry_id:753909)才能保证不损失[DG方法](@entry_id:748369)的理论精度？
-   对于体积项 $\int_K \kappa \nabla u_h \cdot \nabla v_h \, d\boldsymbol{x}$，如果 $u_h, v_h$ 是 $p$ 次多项式，那么 $\nabla u_h, \nabla v_h$ 是 $p-1$ 次多项式，其[点积](@entry_id:149019)是 $2p-2$ 次多项式。因此，体积积分需要一个至少能精确积分 $2p-2$ 次多项式的[求积公式](@entry_id:753909)。
-   对于界面项，例如罚项 $\int_F \frac{\sigma}{h_F} [[u_h]] \cdot [[v_h]] \, dS$，其被积函数最高次数为 $p+p=2p$。
因此，为了精确计算SIPG[双线性形式](@entry_id:746794)，我们需要体积积分公式的精度为 $m_{\text{vol}} = 2p-2$，界面积分公式的精度为 $m_{\text{face}} = 2p$ 。

如果使用**欠积分**（under-integration），即求积公式的精度不足，会有什么后果？
-   **对称性**：SIPG的被积函数在每个积分点上都是对称的，所以即使求积不精确，求和之后的结果仍然是对称的。因此，欠积分不破坏[刚度矩阵](@entry_id:178659)的对称性。
-   **一致性**：DG方法的一致性依赖于[分部积分恒等式](@entry_id:197773)的精确成立。[数值积分](@entry_id:136578)通常无法精确保持这个恒等式，导致所谓的“变分犯罪”（variational crime）。这会引入一个额外的[离散化误差](@entry_id:748522)，可能降低方法的收敛阶。

### [DG方法](@entry_id:748369)的代数系统与高级变体

#### [全局刚度矩阵](@entry_id:138630)的结构

将DG[双线性形式](@entry_id:746794)作用于一组[基函数](@entry_id:170178)，就可以组装出全局的代数系统 $A\boldsymbol{u} = \boldsymbol{b}$。这个[刚度矩阵](@entry_id:178659) $A$ 具有一个非常重要的结构特点：**块[稀疏性](@entry_id:136793)**。
-   [DG方法](@entry_id:748369)的耦合只发生在共享界面的单元之间。一个单元上的[基函数](@entry_id:170178)只与其自身以及其“面相邻”单元上的[基函数](@entry_id:170178)有非零的矩阵项。它不与“点相邻”或更远的单元直接耦合。
-   因此，如果按单元对自由度进行分组，[刚度矩阵](@entry_id:178659)呈现出块结构。对一个二维内部[三角形单元](@entry_id:167871)（有3个邻居）而言，其对应的矩阵行将只在4个块（自身块+3个邻居块）中有非零元。
-   这种局部耦合特性是[DG方法](@entry_id:748369)的一大优势，使得它非常适合[大规模并行计算](@entry_id:268183)。

一个值得注意的趋势是，随着多项式次数 $p$ 的增加，每个单元的自由度数量 $n_p$（例如，二维三角形为 $(p+1)(p+2)/2$）会迅速增长。虽然块稀疏的模式不变，但每个块的尺寸变大，每行的非零元总数（约为 $(1+N_{\text{neighbors}})n_p$）也随之增加，这意味着矩阵的“填充度”在增加，或者说变得“更不稀疏”了 。

#### 混合与杂交方法：[LDG](@entry_id:751395)与HDG

除了SIPG这种“原始”格式，DG大家族中还有许多重要的变体，它们通过引入辅助变量来获得额外的优良性质。

**局部间断Galerkin ([LDG](@entry_id:751395)) 方法**

[LDG方法](@entry_id:751397)首先将二阶方程 $-\nabla \cdot (\kappa \nabla u) = f$ 重写为一个一阶系统：
$$
\boldsymbol{q} + \kappa \nabla u = 0, \quad -\nabla \cdot \boldsymbol{q} = f
$$
然后同时对[原始变量](@entry_id:753733) $u$ 和这个新的通量变量 $\boldsymbol{q}$ 进行DG离散。与SIPG相比，[LDG](@entry_id:751395)有几个显著不同 ：
-   **局部守恒性**: [LDG方法](@entry_id:751397)通过其构造，自然地满足单元级别的**通量守恒**。这意味着在每个单元上，流入的数值通量等于流出的[数值通量](@entry_id:752791)加上[源项](@entry_id:269111)的贡献。这个性质在许多物理问题中至关重要，而SIPG需要额外的后处理才能恢复一个满足守恒性的通量场。
-   **对称性与等价性**: [LDG](@entry_id:751395)的混合形式通常会产生一个非对称的[鞍点问题](@entry_id:174221)代数系统。然而，通过巧妙地选择界面上的[数值通量](@entry_id:752791)（例如，使用“交替”通量），可以使得消去通量变量 $\boldsymbol{q}$ 后得到的关于 $u$ 的系统是对称的，甚至在某些特定条件下（如均匀网格、常数系数、匹配的罚参数）与[SIPG方法](@entry_id:754927)完[全等](@entry_id:273198)价。

**可杂交间断Galerkin (HDG) 方法**

[HDG方法](@entry_id:170956)是DG思想的又一次升华。它同样从[一阶系统](@entry_id:147467)出发，但引入了第三类未知数：定义在网格所有界面上的“杂交”迹变量 $\hat{u}_h$。HDG的离散系统包含三个未知场：单元内部的解 $u_h$，单元内部的通量 $\boldsymbol{q}_h$，以及界面上的迹 $\hat{u}_h$ 。

HDG的核心优势在于其**[静态凝聚](@entry_id:176722)**（static condensation）能力。通过代数操作，可以发现每个单元内部的未知数 $(u_h, \boldsymbol{q}_h)$ 完全可以由其边界上的迹变量 $\hat{u}_h$ 和[源项](@entry_id:269111) $f$ 局部地表示出来。这意味着我们可以先在每个单元上求解一个只与该单元边界值有关的局部问题，然后将结果代入到全局的通量连续性条件中，最终得到一个只涉及界面未知数 $\hat{u}_h$ 的全局[线性系统](@entry_id:147850) 。

这一特性带来了巨大的计算优势 ：
-   **显著减少全局自由度**: 全局求解的未知数数量从所有单元内部的自由度（与单元数 $N_e$ 成正比）减少到所有界面上的自由度（与界面数 $N_f$ 成正比）。对于高次多项式 $p$，这种减少尤为显著。例如，对于二维三角形网格，当 $p \ge 2$ 时，HDG的全局自由度就少于标准DG；对于三维四面体网格，当 $p \ge 4$ 时开始体现优势。
-   **改善条件数**: 标准DG方法（如SIPG）离散的是一个二阶算子，其刚度[矩阵的条件数](@entry_id:150947)与网格尺寸 $h$ 的关系为 $\mathcal{O}(h^{-2})$。而HDG的全局系统等价于一个定义在网格骨架上的一阶算子（离散的Steklov-Poincaré算子），其[条件数](@entry_id:145150) scaling 为 $\mathcal{O}(h^{-1})$。更小的条件数意味着代数系统更容易求解，迭代求解器收敛更快。

综上所述，DG方法通过在[破碎函数空间](@entry_id:746988)中引入[数值通量](@entry_id:752791)和罚项，构建了一套灵活而强大的数值框架。从基本的SIPG到高级的[LDG](@entry_id:751395)和HDG，不同的方法在对称性、守恒性、计算成本和系统性质之间提供了不同的权衡，使得研究者和工程师可以根据具体问题选择最合适的工具。