{
    "hands_on_practices": [
        {
            "introduction": "这是时间线方法的第一步，也是最关键的一步。我们将从一个一维守恒律出发，推导控制每个单元内解的系数演化的常微分方程（ODE）组。这个练习将揭示间断伽辽金（DG）离散化的核心组成部分：质量矩阵、体积积分项，以及耦合相邻单元的关键的表面数值通量项 。",
            "id": "3399419",
            "problem": "考虑定义在有界区间 $\\Omega = [a,b]$ 上的一维守恒律 $u_t + f(u)_x = 0$，其中 $u(x,t)$ 是一个标量，$f(u)$ 是一个光滑通量函数。设 $\\Omega$ 被划分为 $N$ 个不相交的开单元 $K_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$（$j = 1,\\dots,N$），界面位于点 $x_{j\\pm\\frac{1}{2}}$ 处。在每个单元 $K_j$ 上，用次数至多为 $p$ 的多项式 $u_h(x,t) \\in P^p(K_j)$ 来近似 $u(x,t)$，该多项式在一组选定的局部基 $\\{\\phi_{j,m}(x)\\}_{m=0}^{p}$ 中展开，使得 $u_h(x,t) = \\sum_{m=0}^{p} c_{j,m}(t)\\,\\phi_{j,m}(x)$，其中 $\\{c_{j,m}(t)\\}$ 是随时间变化的模态系数。\n\n使用间断 Galerkin (DG) 方法和直线法离散，通过将守恒律乘以一个测试函数 $v \\in P^p(K_j)$，在每个单元上进行分部积分，并将界面处的物理通量 $f(u)$ 替换为一个依赖于每个界面上内部迹 $u^-$ 和外部迹 $u^+$ 的相容数值通量 $\\hat{f}(u^-,u^+)$，来构建单元上的半离散方程。通过选择局部 Lax–Friedrichs 形式的数值通量 $\\hat{f}(u^-,u^+) = \\{f(u)\\} - \\frac{\\alpha}{2}[u]$，明确指出界面的跳跃和平均是如何通过该数值通量引入的。其中 $\\{f(u)\\} = \\frac{1}{2}\\big(f(u^-)+f(u^+)\\big)$，$[u] = u^+ - u^-$，并且 $\\alpha \\ge \\sup_{s \\in [u^-,u^+]}|f'(s)|$ 是波速的一个局部界。\n\n详细推导模态系数 $c_{j,m}(t)$ 的半离散常微分方程，该方程应以单元质量矩阵元 $M_{j,mq} = \\int_{K_j} \\phi_{j,m}(x)\\,\\phi_{j,q}(x)\\,\\mathrm{d}x$、包含 $f(u_h)$ 和 $\\partial_x\\phi_{j,q}$ 的体积分项，以及在 $x_{j\\pm\\frac{1}{2}}$ 处通过使用相邻单元的迹计算的 $\\{f(u)\\}$ 和 $[u]$ 所表示的两个界面贡献项来表示。你的最终答案必须是关于 $\\dot{c}_{j,m}(t)$ 的单个闭式解析表达式，使用指数记法，并包含以平均和跳跃形式写出的数值通量。不需要进行数值计算，除了在界面处使用内部/外部迹之外，无需施加任何边界条件。最终答案不应包含任何单位。",
            "solution": "模态系数的半离散常微分方程 (ODE) 的推导始于守恒律 $u_t + f(u)_x = 0$ 在单元 $K_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$ 上的弱形式。我们将该偏微分方程乘以一个测试函数 $v_h(x) \\in P^p(K_j)$ 并在单元 $K_j$ 上积分：\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h(x) \\, \\mathrm{d}x + \\int_{K_j} \\frac{\\partial f(u_h)}{\\partial x} v_h(x) \\, \\mathrm{d}x = 0 $$\n这里，$u_h$ 是解 $u$ 在 $K_j$ 上的多项式近似。\n\n包含通量导数的第二项进行分部积分：\n$$ \\int_{K_j} \\frac{\\partial f(u_h)}{\\partial x} v_h(x) \\, \\mathrm{d}x = \\left[ f(u_h(x,t)) v_h(x) \\right]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} - \\int_{K_j} f(u_h(x,t)) \\frac{\\mathrm{d}v_h(x)}{\\mathrm{d}x} \\, \\mathrm{d}x $$\n边界项计算为：\n$$ \\left[ f(u_h) v_h \\right]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} = f(u_h(x_{j+\\frac{1}{2}}^-,t))v_h(x_{j+\\frac{1}{2}}) - f(u_h(x_{j-\\frac{1}{2}}^+,t))v_h(x_{j-\\frac{1}{2}}) $$\n其中 $u_h(x_{j\\pm\\frac{1}{2}}^\\mp)$ 表示解 $u_h$ 从单元 $K_j$ 内部在相应界面上的迹。\n\n将此代回弱形式可得：\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}x = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}v_h}{\\mathrm{d}x} \\, \\mathrm{d}x - f(u_h(x_{j+\\frac{1}{2}}^-))v_h(x_{j+\\frac{1}{2}}) + f(u_h(x_{j-\\frac{1}{2}}^+))v_h(x_{j-\\frac{1}{2}}) $$\n在间断 Galerkin 方法中，间断界面处的单值物理通量被一个数值通量函数 $\\hat{f}(u^-, u^+)$ 所取代，该函数依赖于界面两侧的两个状态。在界面 $x_{j+\\frac{1}{2}}$ 处，左侧（来自单元 $K_j$）的状态是 $u_h(x_{j+\\frac{1}{2}}^-)$，右侧（来自 $K_{j+1}$）的状态是 $u_h(x_{j+\\frac{1}{2}}^+)$。在界面 $x_{j-\\frac{1}{2}}$ 处，左侧状态（来自 $K_{j-1}$）是 $u_h(x_{j-\\frac{1}{2}}^-)$，右侧状态（来自 $K_j$）是 $u_h(x_{j-\\frac{1}{2}}^+)$。\n弱形式变为：\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}x = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}v_h}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}}v_h(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}}v_h(x_{j-\\frac{1}{2}}) $$\n其中 $\\hat{f}_{j+\\frac{1}{2}} = \\hat{f}(u_h(x_{j+\\frac{1}{2}}^-), u_h(x_{j+\\frac{1}{2}}^+))$ 且 $\\hat{f}_{j-\\frac{1}{2}} = \\hat{f}(u_h(x_{j-\\frac{1}{2}}^-), u_h(x_{j-\\frac{1}{2}}^+))$。\n\n为了获得系数的常微分方程组，我们代入基展开 $u_h(x,t) = \\sum_{m=0}^{p} c_{j,m}(t)\\,\\phi_{j,m}(x)$ 并选择测试函数为基函数，$v_h(x) = \\phi_{j,q}(x)$（$q=0, \\dots, p$）。\n$$ \\int_{K_j} \\left( \\sum_{m=0}^{p} \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} \\phi_{j,m}(x) \\right) \\phi_{j,q}(x) \\, \\mathrm{d}x = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}} \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}} \\phi_{j,q}(x_{j-\\frac{1}{2}}) $$\n左侧可以用质量矩阵元 $M_{j,qm} = \\int_{K_j} \\phi_{j,q}(x)\\,\\phi_{j,m}(x)\\,\\mathrm{d}x$ 来表示。由于乘法是可交换的，$M_{j,qm} = M_{j,mq}$。方程变为：\n$$ \\sum_{m=0}^{p} M_{j,qm} \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = R_{j,q}(t) $$\n其中 $R_{j,q}(t)$ 是右侧项，它依赖于单元 $j$ 及其相邻单元的系数。对于单元 $j$，其矩阵形式为 $\\mathbf{M}_j \\dot{\\mathbf{c}}_j = \\mathbf{R}_j$。\n\n问题要求 $\\dot{c}_{j,m}(t)$ 的显式表达式，这需要对质量矩阵求逆：$\\dot{\\mathbf{c}}_j = \\mathbf{M}_j^{-1} \\mathbf{R}_j$。其分量形式为：\n$$ \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = \\sum_{q=0}^{p} (M_j^{-1})_{mq} R_{j,q}(t) $$\n现在，我们代入指定的局部 Lax-Friedrichs 通量：$\\hat{f}(u^-,u^+) = \\{f(u)\\} - \\frac{\\alpha}{2}[u]$。\n在界面 $x_{j+\\frac{1}{2}}$ 处：$\\hat{f}_{j+\\frac{1}{2}} = \\{f(u_h)\\}_{j+\\frac{1}{2}} - \\frac{\\alpha_{j+\\frac{1}{2}}}{2}[u_h]_{j+\\frac{1}{2}}$。\n在界面 $x_{j-\\frac{1}{2}}$ 处：$\\hat{f}_{j-\\frac{1}{2}} = \\{f(u_h)\\}_{j-\\frac{1}{2}} - \\frac{\\alpha_{j-\\frac{1}{2}}}{2}[u_h]_{j-\\frac{1}{2}}$。\n界面上的跳跃 $[u_h]$ 是 $u_h^+ - u_h^-$，平均 $\\{f(u_h)\\}$ 是 $\\frac{1}{2}(f(u_h^-)+f(u_h^+))$。\n\n结合这些元素，得到模态系数 $c_{j,m}(t)$ 的最终半离散方程：\n$$ \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = \\sum_{q=0}^{p} (M_j^{-1})_{mq} \\left[ \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}} \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}} \\phi_{j,q}(x_{j-\\frac{1}{2}}) \\right] $$\n代入数值通量的显式形式即可得到最终表达式。$u_h$ 及其迹这些量依赖于单元 $j$ 及其相邻单元的系数 $\\{c_{j,m}(t)\\}$，使得常微分方程组是耦合的。",
            "answer": "$$ \\boxed{ \\dot{c}_{j,m}(t) = \\sum_{q=0}^{p} (M_j^{-1})_{mq} \\left[ \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\left( \\{f(u_h)\\}_{j+\\frac{1}{2}} - \\frac{\\alpha_{j+\\frac{1}{2}}}{2}[u_h]_{j+\\frac{1}{2}} \\right) \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\left( \\{f(u_h)\\}_{j-\\frac{1}{2}} - \\frac{\\alpha_{j-\\frac{1}{2}}}{2}[u_h]_{j-\\frac{1}{2}} \\right) \\phi_{j,q}(x_{j-\\frac{1}{2}}) \\right] } $$"
        },
        {
            "introduction": "一旦我们得到了形如 $\\dot{\\mathbf{u}} = A \\mathbf{u}$ 的半离散ODE系统，一个关键问题就是如何为显式时间积分器选择一个稳定的时间步长 $\\Delta t$。本练习将探讨空间算子的特征值与时间积分器稳定域之间的联系。通过将简单的前向欧拉法应用于扩散方程的DG离散化，您将推导出最大稳定时间步长，这是CFL（Courant–Friedrichs–Lewy）条件中的一个基本概念 。",
            "id": "3399416",
            "problem": "考虑周期区间上的一维线性扩散方程 $u_{t}=\\nu u_{xx}$，在均匀网格上使用多项式次数为 $p$ 的对称内部罚间断伽辽金 (DG) 方法进行空间离散。这得到了一个线方法半离散系统 $M \\dot{\\mathbf{u}}(t)=K \\mathbf{u}(t)$，其中质量矩阵 $M$ 是对称正定的，当罚函数足够大时刚度矩阵 $K$ 是对称半负定的，以及线性算子 $A=M^{-1}K$。假设采用周期性边界条件，因此 $A$ 的所有特征值都是实数且非正。\n\n设时间积分通过前向欧拉显式龙格-库塔 (RK) 方法进行，其稳定性函数为 $R(z)=1+z$。从线方法公式和稳定性函数的定义出发，完成以下任务：\n\n- 用 $R$ 和 $A$ 表示单步线性放大矩阵 $G$（您必须从第一性原理出发，为线性常系数右端项证明该表达式）。\n- 仅使用谱半径 $\\rho(A)$ 和 $A$ 的假定谱位置，推导最大时间步长界限 $\\Delta t_{\\max}$，使得所有 DG 模式在一步内不被放大，即最大模态放大因子的模长小于或等于 $1$。您的界限必须是仅含 $\\rho(A)$ 的闭式解析表达式。\n\n您的最终答案必须是 $\\Delta t_{\\max}$ 的单一表达式。不需要进行数值舍入。",
            "solution": "我们从线方法半离散系统 $M \\dot{\\mathbf{u}}(t)=K \\mathbf{u}(t)$ 开始。由于 $M$ 是对称正定的，我们可以将系统重写为标准线性形式\n$$\n\\dot{\\mathbf{u}}(t) = A \\mathbf{u}(t), \\quad A := M^{-1}K.\n$$\n根据对称内部罚离散化和周期性边界条件的假设，当罚函数足够大时，$K$ 是对称半负定的，因此 $A$ 通过由 $M^{1/2}$ 导出的合同变换与一个对称半负定矩阵相似。特别地，$A$ 的所有特征值都是实数且非正。\n\n让我们回顾一下应用于线性测试问题的单步法稳定性函数的基本定义。对于线性右端项 $\\dot{\\mathbf{u}}(t)=A \\mathbf{u}(t)$ 和稳定性函数为 $R(z)$ 的单步时间积分器，数值更新可以写成以下形式\n$$\n\\mathbf{u}^{n+1} = G \\,\\mathbf{u}^{n}, \\quad G = R(\\Delta t\\, A),\n$$\n其中 $R$ 通过其幂级数作用于矩阵参数。这是通过将该方法应用于标量测试方程 $y'=\\lambda y$（得到 $y^{n+1} = R(\\Delta t \\lambda) y^{n}$），然后在线性常系数情况下通过谱映射定理进行推广得出的：对于多项式 $R(z)=\\sum_{k=0}^{s} c_{k} z^{k}$，我们定义 $R(\\Delta t A)=\\sum_{k=0}^{s} c_{k} (\\Delta t)^{k} A^{k}$，这正是将该方法应用于 $\\dot{\\mathbf{u}}=A \\mathbf{u}$ 时的放大矩阵。\n\n对于前向欧拉方法，其稳定性函数为 $R(z)=1+z$，我们得到\n$$\nG \\;=\\; R(\\Delta t A) \\;=\\; I + \\Delta t\\, A.\n$$\n\n我们现在推导一个步长界限，以保证在前向欧拉一步中所有模式都不被放大。设 $\\{\\lambda_{j}\\}$ 表示 $A$ 的特征值。由于 $A$ 的特征值为实数且非正，记 $\\lambda_{j}=-r_{j}$，其中 $r_{j}\\ge 0$。作用于一个特征模态，标量放大因子为\n$$\ng(\\lambda_{j}) \\;=\\; R(\\Delta t \\lambda_{j}) \\;=\\; 1 + \\Delta t \\lambda_{j} \\;=\\; 1 - \\Delta t r_{j}.\n$$\n一步内不放大要求对所有 $j$ 都有 $|g(\\lambda_{j})|\\le 1$。因为 $g(\\lambda_{j})$ 是实数，条件 $|1 - \\Delta t r_{j}| \\le 1$ 等价于\n$$\n-1 \\le 1 - \\Delta t r_{j} \\le 1 \\;\\;\\Longleftrightarrow\\;\\; 0 \\le \\Delta t r_{j} \\le 2.\n$$\n最严格的约束对应于最大的 $r_{j}$，即 $r_{\\max}=\\max_{j} r_{j} = \\rho(A)$，因为 $\\rho(A)=\\max_{j} |\\lambda_{j}|$ 且 $\\lambda_{j}\\le 0$。因此，\n$$\n\\Delta t \\,\\rho(A) \\le 2 \\;\\;\\Longleftrightarrow\\;\\; \\Delta t \\le \\frac{2}{\\rho(A)}.\n$$\n因此，保证在前向欧拉方法下所有 DG 模式不被放大的最大时间步长是以下闭式表达式\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2}{\\rho(A)}.\n$$",
            "answer": "$$\\boxed{\\dfrac{2}{\\rho(A)}}$$"
        },
        {
            "introduction": "许多物理问题（如对流扩散）涉及时间尺度差异巨大的过程，这会导致“刚性”ODE系统，此时使用显式方法效率低下。本练习将介绍一种强大的解决方案：隐式-显式（IMEX）龙格-库塔格式。您将对一个对流扩散方程应用IMEX方法，显式处理非刚性的对流项，隐式处理刚性的扩散项，并推导每个阶段需要求解的线性系统 。",
            "id": "3399430",
            "problem": "考虑标量对流扩散方程 $u_{t} + \\partial_{x} f(u) = \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$，它定义在一个一维域上，具有足够光滑的初始和边界数据、常数粘性系数 $\\nu > 0$ 以及光滑通量函数 $f(u)$。设该域被划分为不重叠的单元，并考虑在每个单元上使用固定阶多项式空间的间断 Galerkin (DG) 空间离散化。令 $\\{\\varphi_{i}\\}$ 表示 DG 空间的基，并将 DG 近似写为 $u_{h}(x,t) = \\sum_{i} U_{i}(t)\\,\\varphi_{i}(x)$，其系数向量为 $U(t)$。\n\n对于对流算子，在单元间边界上使用相容的单调数值通量，并在每个单元内对体积项进行分部积分，以获得 DG 对流残差。对于扩散算子，使用对称内部罚 Galerkin (SIPG) 双线性形式，并选择足够大的罚参数以保证稳定性。用 $M$ 表示全局 DG 质量矩阵，用 $C(U)$ 表示组装的全局对流残差向量，用 $K_{\\nu}$ 表示组装的用于扩散的全局 SIPG 刚度矩阵，该矩阵关于 $\\nu$ 是线性的。假设 $\\nu$ 在空间上是常数，因此 $K_{\\nu} = \\nu K$，其中 $K$ 是由网格、罚函数和基确定的对称半正定矩阵。\n\n1. 从 DG 线方法的第一性原理出发，推导出形如 $M\\,\\dot{U}(t) = E\\!\\left(U(t)\\right) + I\\!\\left(U(t)\\right)$ 的半离散系统，并识别出对应于显式对流和隐式扩散贡献的 $E(U)$ 和 $I(U)$。\n\n2. 对系统 $M\\,\\dot{U} = E(U) + I(U)$ 应用加法形式的隐式-显式 Runge–Kutta (IMEX–RK) 时间离散化，使用两步二阶的 Ascher–Ruuth–Spiteri 对（通常表示为 ARS$(2,2,2)$），其 Butcher 表如下。对于显式部分 $E(U)$，使用\n$$\nA = \\begin{pmatrix}\n0  0 \\\\\n1  0\n\\end{pmatrix},\\quad\nb^{\\top} = \\begin{pmatrix}\n1 - \\gamma  \\gamma\n\\end{pmatrix},\\quad\nc = \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix},\n$$\n对于对角隐式部分 $I(U)$，使用\n$\n\\hat{A} = \\begin{pmatrix}\n\\gamma  0 \\\\\n1 - \\gamma  \\gamma\n\\end{pmatrix},\\ \n\\hat{b}^{\\top} = \\begin{pmatrix}\n1 - \\gamma  \\gamma\n\\end{pmatrix},\\\n\\hat{c} = \\begin{pmatrix}\n\\gamma \\\\\n1\n\\end{pmatrix},\n$\n其中 $\\gamma = 1 - 1/\\sqrt{2}$。以质量矩阵形式推导阶段方程和步进更新，并分离出在每个阶段为隐式扩散必须求解的代数系统。\n\n3. 在上述假设下（$\\nu$ 为常数，因此 $K_{\\nu} = \\nu K$，并使用 ARS$(2,2,2)$），确定在每个时间步分解一次并在两个阶段中重复使用的精确对称正定矩阵。以 $M$、$\\Delta t$、$\\gamma$、$\\nu$ 和 $K$ 的精确符号表达式形式给出最终答案。\n\n您的最终答案必须是单个闭式解析表达式。不包括单位。不要近似 $\\gamma$；保留其精确值。",
            "solution": "### 第 1 部分：半离散系统的推导\n\n我们从标量对流扩散方程 $u_{t} + \\partial_{x} f(u) = \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$ 开始。我们可以将其重写为 $u_{t} = -\\partial_{x} f(u) + \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$。\n\n线方法首先对空间算子进行离散化，以获得关于基函数系数的常微分方程 (ODEs) 系统。设计算域 $\\Omega$ 被划分为单元 $E_k$。间断 Galerkin (DG) 近似由 $u_{h}(x,t) = \\sum_{j} U_{j}(t)\\,\\varphi_{j}(x)$ 给出，其中 $\\{\\varphi_j\\}$ 是 DG 有限元空间的基，而 $U_j(t)$ 是随时间变化的自由度。\n\n通过将 PDE 乘以来自同一 DG 空间的测试函数 $v_h$ 并在整个域上积分，可以得到弱形式。由于基的间断性质，这是逐个单元进行的。对于任意测试函数 $v_h = \\varphi_i(x)$ 并对所有单元求和，弱形式为：\n$$\n\\sum_k \\int_{E_k} (\\partial_t u_h) \\varphi_i \\,dx = -\\sum_k \\int_{E_k} (\\partial_x f(u_h)) \\varphi_i \\,dx + \\sum_k \\int_{E_k} \\partial_x(\\nu \\partial_x u_h) \\varphi_i \\,dx\n$$\n\n让我们分析每一项以得到矩阵-向量形式。\n\n1.  **质量矩阵项（左侧）：**\n    代入 $u_h(x,t) = \\sum_{j} U_{j}(t)\\,\\varphi_{j}(x)$，左侧变为：\n    $$\n    \\sum_k \\int_{E_k} \\left(\\sum_j \\dot{U}_j(t) \\varphi_j(x)\\right) \\varphi_i(x) \\,dx = \\sum_j \\left(\\int_{\\Omega} \\varphi_j \\varphi_i \\,dx\\right) \\dot{U}_j(t)\n    $$\n    此处，$\\Omega = \\cup_k E_k $。这些积分构成了全局质量矩阵 $M$ 的元素，其中 $(M)_{ij} = \\int_{\\Omega} \\varphi_i \\varphi_j \\,dx$。因此，左侧是向量 $M\\dot{U}(t)$ 的第 $i$ 个分量。\n\n2.  **对流项（显式部分）：**\n    问题指定对体积项进行分部积分。对流算子 $-\\partial_x f(u)$ 的空间离散化得到向量 $C(U)$。该向量的第 $i$ 个分量由下式获得：\n    $$\n    -\\sum_k \\int_{E_k} (\\partial_x f(u_h)) \\varphi_i \\,dx = \\sum_k \\left( \\int_{E_k} f(u_h) (\\partial_x \\varphi_i) \\,dx - [f(u_h) \\varphi_i]_{\\partial E_k} \\right)\n    $$\n    单元边界 $\\partial E_k$ 上的项 $f(u_h)$ 被一个相容且单调的数值通量替代，记为 $\\hat{f}(u_h^-, u_h^+)$，其中 $u_h^-$ 和 $u_h^+$ 分别是解的内部和外部迹。得到的向量非线性地依赖于系数向量 $U$，这就是问题中所称的“组装的全局对流残差向量”，记为 $C(U)$。此项将被显式处理，因此我们定义 $E(U) = C(U)$。\n\n3.  **扩散项（隐式部分）：**\n    扩散项为 $\\partial_x(\\nu \\partial_x u)$。其空间离散化指定使用对称内部罚 Galerkin (SIPG) 方法。SIPG 公式通常是为负拉普拉斯算子 $-\\partial_x(\\nu \\partial_x u)$ 设计的。构造一个双线性形式 $B_{SIPG}(u_h, v_h)$ 来离散化该算子，从而得到一个全局刚度矩阵 $K_{\\nu}$，其元素由 $(K_\\nu)_{ij} = B_{SIPG}(\\varphi_j, \\varphi_i; \\nu)$ 给出。得到的向量是 $K_{\\nu}U$。由于 PDE 中的算子是 $+\\partial_x(\\nu \\partial_x u)$（SIPG 通常离散化的算子的负数），其对半离散系统的贡献是 $-K_{\\nu}U$。\n    问题指出，对于常数粘性系数 $\\nu$，我们有 $K_{\\nu} = \\nu K$，其中 $K$ 是一个对称半正定矩阵。因此，扩散贡献为 $-\\nu K U$。这个线性项将被隐式处理。我们定义 $I(U) = -\\nu K U$。\n\n结合这些部分，半离散的常微分方程组为：\n$$\nM\\dot{U}(t) = C(U) - \\nu K U\n$$\n这就是所需的形式 $M\\dot{U}(t) = E(U(t)) + I(U(t))$，其中定义为：\n$$\nE(U) = C(U) \\quad \\text{和} \\quad I(U) = -\\nu K U\n$$\n\n### 第 2 部分：IMEX-RK 时间离散化\n\n我们对系统 $M\\dot{U} = E(U) + I(U)$ 应用加法形式的隐式-显式 Runge-Kutta (IMEX-RK) 格式。这种格式的阶段方程的一般形式为：\n$$\nU^{(i)} = U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} \\left(M^{-1}E(U^{(j)})\\right) + \\Delta t \\sum_{j=1}^{i} \\hat{a}_{ij} \\left(M^{-1}I(U^{(j)})\\right)\n$$\n其中 $U^n$ 是在时间 $t_n$ 的解，$U^{(i)}$ 是中间阶段值。乘以质量矩阵 $M$ 得到问题所要求的形式：\n$$\nM U^{(i)} = M U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} E(U^{(j)}) + \\Delta t \\sum_{j=1}^{i} \\hat{a}_{ij} I(U^{(j)})\n$$\n这个方程可以重排以分离出当前阶段 $i$ 的项：\n$$\nM U^{(i)} - \\Delta t \\hat{a}_{ii} I(U^{(i)}) = M U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} E(U^{(j)}) + \\Delta t \\sum_{j=1}^{i-1} \\hat{a}_{ij} I(U^{(j)})\n$$\n使用我们的定义 $I(U) = -\\nu K U$，左侧变为：\n$$\nM U^{(i)} - \\Delta t \\hat{a}_{ii} (-\\nu K U^{(i)}) = (M + \\Delta t \\hat{a}_{ii} \\nu K) U^{(i)}\n$$\n这揭示了在每个阶段必须为 $U^{(i)}$ 求解的线性系统。\n\n让我们将此应用于具体的 ARS$(2,2,2)$ 格式，其中 $\\gamma = 1 - 1/\\sqrt{2}$。Butcher 表作为 $A$（显式）和 $\\hat{A}$（隐式）给出。这是一个两步法 ($i=1,2$)。\n\n**阶段 1 ($i=1$):**\n对于 $j  1$ 的求和为空。第一阶段的方程是：\n$$\n(M + \\Delta t \\hat{a}_{11} \\nu K) U^{(1)} = M U^n\n$$\n从矩阵 $\\hat{A}$ 中，我们有 $\\hat{a}_{11} = \\gamma$。$U^{(1)}$ 的代数系统是：\n$$\n(M + \\Delta t \\gamma \\nu K) U^{(1)} = M U^n\n$$\n\n**阶段 2 ($i=2$):**\n第二阶段的方程是：\n$$\n(M + \\Delta t \\hat{a}_{22} \\nu K) U^{(2)} = M U^n + \\Delta t a_{21} E(U^{(1)}) + \\Delta t \\hat{a}_{21} I(U^{(1)})\n$$\n从矩阵中，我们有 $a_{21}=1$，$\\hat{a}_{21}=1-\\gamma$ 和 $\\hat{a}_{22}=\\gamma$。代入这些值和 $I(U^{(1)}) = -\\nu K U^{(1)}$：\n$$\n(M + \\Delta t \\gamma \\nu K) U^{(2)} = M U^n + \\Delta t E(U^{(1)}) - \\Delta t (1-\\gamma) \\nu K U^{(1)}\n$$\n这是 $U^{(2)}$ 的代数系统。请注意，右侧依赖于第一阶段的解 $U^{(1)}$。\n\n**步进更新：**\n时间 $t_{n+1} = t_n + \\Delta t$ 的最终解是通过阶段值的最终组合计算得出的：\n$$\nM U^{n+1} = M U^n + \\Delta t \\sum_{i=1}^{2} b_i E(U^{(i)}) + \\Delta t \\sum_{i=1}^{2} \\hat{b}_i I(U^{(i)})\n$$\n使用给定的向量 $b^T = \\hat{b}^T = (1-\\gamma, \\gamma)$，我们得到：\n$$\nM U^{n+1} = M U^n + \\Delta t \\left( (1-\\gamma)E(U^{(1)}) + \\gamma E(U^{(2)}) \\right) + \\Delta t \\left( (1-\\gamma)I(U^{(1)}) + \\gamma I(U^{(2)}) \\right)\n$$\n代入 $I(U) = -\\nu K U$，更新变为：\n$$\nM U^{n+1} = M U^n + \\Delta t \\left( (1-\\gamma)E(U^{(1)}) + \\gamma E(U^{(2)}) \\right) - \\Delta t \\nu \\left( (1-\\gamma)K U^{(1)} + \\gamma K U^{(2)} \\right)\n$$\n\n### 第 3 部分：被分解矩阵的确定\n\n在第 2 部分中，我们推导了在每个阶段为求解阶段向量 $U^{(1)}$ 和 $U^{(2)}$ 必须求解的线性代数系统：\n$$\n\\text{阶段 1: } (M + \\Delta t \\gamma \\nu K) U^{(1)} = \\text{RHS}_1\n$$\n$$\n\\text{阶段 2: } (M + \\Delta t \\gamma \\nu K) U^{(2)} = \\text{RHS}_2\n$$\n该格式是一种单对角隐式 RK (SDIRK) 方法，因为隐式 Butcher 表 $\\hat{A}$ 的对角线元素都相等，即 $\\hat{a}_{11} = \\hat{a}_{22} = \\gamma$。这在计算上是有利的，因为待解线性系统左侧的矩阵在两个阶段都是相同的。这个矩阵是：\n$$\nL = M + \\Delta t \\gamma \\nu K\n$$\n这个矩阵可以在每个时间步内只形成和分解一次（例如，使用 Cholesky 或 LU 分解）。然后，该分解被重用于求解具有不同右侧项的 $U^{(1)}$ 和 $U^{(2)}$。\n\n我们必须确认这个矩阵是对称正定的 (SPD)。\n- **对称性：** DG 质量矩阵 $M$ 是对称的。SIPG 刚度矩阵 $K$ 是对称的。由于 $\\Delta t$、$\\gamma$ 和 $\\nu$ 是标量，矩阵 $\\Delta t \\gamma \\nu K$ 也是对称的。两个对称矩阵的和是对称的，因此 $L$ 是对称的。\n- **正定性：** 设 $x$ 是任意适当维度的非零向量。考虑二次型 $x^T L x$：\n$$\nx^T L x = x^T (M + \\Delta t \\gamma \\nu K) x = x^T M x + \\Delta t \\gamma \\nu (x^T K x)\n$$\n- DG 质量矩阵 $M$ 是对称正定的 (SPD)，所以 $x^T M x > 0$。\n- SIPG 刚度矩阵 $K$ 是对称半正定的 (SPS)，所以 $x^T K x \\ge 0$。\n- 参数都为正：$\\Delta t > 0$，$\\nu > 0$，且 $\\gamma = 1 - 1/\\sqrt{2} \\approx 1 - 0.707 > 0$。\n- 因此，项 $\\Delta t \\gamma \\nu (x^T K x)$ 是非负的。\n总和为 $x^T L x = (\\text{正数}) + (\\text{非负数})$，这是严格正的。\n因此，矩阵 $L = M + \\Delta t \\gamma \\nu K$ 是对称正定的。\n\n每个时间步分解一次的精确对称正定矩阵是 $M + \\Delta t \\gamma \\nu K$。",
            "answer": "$$\n\\boxed{M + \\Delta t \\gamma \\nu K}\n$$"
        }
    ]
}