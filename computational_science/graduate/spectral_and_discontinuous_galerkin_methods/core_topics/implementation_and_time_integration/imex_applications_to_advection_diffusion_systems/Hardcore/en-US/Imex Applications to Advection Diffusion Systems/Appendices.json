{
    "hands_on_practices": [
        {
            "introduction": "The primary motivation for using Implicit-Explicit (IMEX) methods is to efficiently handle systems with both stiff and non-stiff components, such as advection-diffusion problems. This exercise provides a concrete, quantitative demonstration of this advantage by asking you to compare the maximum stable time step of an IMEX scheme against a fully explicit one. By applying established scaling laws for the spectral radii of Discontinuous Galerkin (DG) operators, you will calculate the time step restrictions for each method and see firsthand how IMEX schemes overcome the severe stability constraints imposed by stiff diffusion terms .",
            "id": "3391304",
            "problem": "Consider the one-dimensional constant-coefficient advection-diffusion equation $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$ on the periodic domain $x \\in [0,1]$, discretized in space by the Discontinuous Galerkin (DG) method of polynomial degree $p$ on a uniform mesh of size $h$, using an upwind numerical flux for the advective term and the symmetric interior penalty Galerkin (SIPG) form for the diffusive term. Let the semidiscrete system be written in the additive form $u'(t) = L_{A}u(t) + L_{D}u(t)$, where $L_{A}$ is the advection operator and $L_{D}$ is the diffusion operator. It is known from inverse estimates for DG polynomial spaces that the spectral radius of $L_{A}$ scales like $\\omega_{A} = \\frac{a}{h}(2p+1)$ and the spectral radius of $L_{D}$ scales like $\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}$.\n\nYou will advance the semidiscrete system in time with two different time integrators:\n- An Implicit-Explicit (IMEX) Additive Runge-Kutta (ARK) method in which the advection part $L_{A}$ is treated explicitly and the diffusion part $L_{D}$ is treated implicitly. The implicit part is assumed to be A-stable (no restriction from negative real eigenvalues), and the explicit part has a linear stability region whose intersection with the imaginary axis is a known constant $\\alpha_{I} = 2.785$.\n- A fully explicit classical fourth-order Runge-Kutta (RK) method, whose linear stability region intersects the imaginary axis at $\\alpha_{E} = 2.785$ and the negative real axis at $\\beta_{E} = 2.785$.\n\nUsing only the above foundational facts and scaling laws (no other pretabulated stability limits or shortcut formulas), derive the time step restrictions implied by the absolute stability requirement for each integrator, and compute the ratio $R$ of the maximum allowable IMEX time step to the maximum allowable fully explicit RK time step under the following parameter values: $a = 1$, $\\nu = 10^{-3}$, $h = \\frac{1}{128}$, $p = 5$.\n\nRound your final numerical answer for $R$ to four significant figures. Report $R$ as a dimensionless quantity.",
            "solution": "We begin from the semidiscrete representation $u'(t) = L_{A}u(t) + L_{D}u(t)$ resulting from the Discontinuous Galerkin (DG) spatial discretization of $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$. For constant-coefficient linear operators on a uniform mesh, the advection operator $L_{A}$ has eigenvalues that are predominantly purely imaginary due to its skew-adjoint character with upwind flux stabilization, while the diffusion operator $L_{D}$ has eigenvalues that are real and negative due to ellipticity and the symmetric interior penalty Galerkin (SIPG) construction.\n\nThe fundamental DG inverse estimates establish that for polynomials of degree $p$ on elements of size $h$, one has the derivative norm bound and trace inequalities implying that the semidiscrete operator norms scale as:\n$$\n\\omega_{A} = \\frac{a}{h}(2p+1), \\qquad \\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}.\n$$\nThese are well-tested scaling estimates reflecting the largest-magnitude eigenvalues of the advection and diffusion operators, respectively.\n\nAbsolute stability of a Runge-Kutta method applied to a linear system $y' = \\lambda y$ requires that $\\Delta t\\,\\lambda$ lie in the method’s stability region. For purely imaginary $\\lambda$ (from advection), the restriction is governed by the intersection of the stability region with the imaginary axis; for negative real $\\lambda$ (from diffusion), the restriction is governed by the intersection with the negative real axis.\n\nFor the Implicit-Explicit (IMEX) Additive Runge-Kutta (ARK) method:\n- The explicit part advances $L_{A}$, with imaginary eigenvalues bounded by $|\\lambda_{A}| \\leq \\omega_{A}$. The intersection of the explicit stability region with the imaginary axis is at $\\alpha_{I} = 2.785$, so the time step must satisfy\n$$\n\\Delta t_{\\text{IMEX}} \\leq \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- The implicit part is A-stable, so the diffusion eigenvalues on the negative real axis do not impose a restriction on $\\Delta t_{\\text{IMEX}}$.\n\nFor the fully explicit classical fourth-order Runge-Kutta (RK) method:\n- The advection restriction is\n$$\n\\Delta t \\leq \\frac{\\alpha_{E}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- The diffusion restriction is\n$$\n\\Delta t \\leq \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{\\frac{\\nu}{h^{2}}(2p+1)^{2}}.\n$$\nThe fully explicit allowable time step is the minimum of these two.\n\nWe are asked to compute the ratio $R$ of the IMEX maximum time step to the fully explicit RK maximum time step for $a = 1$, $\\nu = 10^{-3}$, $h = \\frac{1}{128}$, and $p = 5$. First, we compute the operator scales:\n$$\n2p+1 = 11, \\quad \\omega_{A} = \\frac{a}{h}(2p+1) = \\frac{1}{h}\\cdot 11 = 11 \\cdot 128 = 1408,\n$$\n$$\n\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2} = \\nu \\cdot \\frac{1}{h^{2}} \\cdot 121 = 10^{-3} \\cdot 16384 \\cdot 121 = 16.384 \\cdot 121 = 1982.464.\n$$\nWe next identify which constraint is active for the fully explicit RK method by comparing the advection and diffusion limits. Since $\\omega_{D} > \\omega_{A}$, the diffusion constraint is stricter:\n$$\n\\Delta t_{\\text{explicit}} = \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{1982.464}.\n$$\nFor the IMEX method, only the advection constraint applies:\n$$\n\\Delta t_{\\text{IMEX}} = \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{1408}.\n$$\nThe ratio simplifies to\n$$\nR = \\frac{\\Delta t_{\\text{IMEX}}}{\\Delta t_{\\text{explicit}}} = \\frac{\\alpha_{I}/\\omega_{A}}{\\beta_{E}/\\omega_{D}} = \\frac{\\alpha_{I}}{\\beta_{E}}\\cdot \\frac{\\omega_{D}}{\\omega_{A}}.\n$$\nGiven $\\alpha_{I} = \\beta_{E} = 2.785$, this becomes\n$$\nR = \\frac{\\omega_{D}}{\\omega_{A}} = \\frac{\\frac{\\nu}{h^{2}}(2p+1)^{2}}{\\frac{a}{h}(2p+1)} = \\frac{\\nu}{a}\\cdot \\frac{2p+1}{h}.\n$$\nSubstituting the parameter values,\n$$\nR = \\frac{10^{-3}}{1}\\cdot \\frac{11}{\\frac{1}{128}} = 10^{-3}\\cdot 11 \\cdot 128 = 1.408.\n$$\nRounded to four significant figures, the ratio is $1.408$. This shows that, under the given parameters, the IMEX method permits a time step larger by a factor of $1.408$ compared to the fully explicit fourth-order Runge-Kutta scheme.",
            "answer": "$$\\boxed{1.408}$$"
        },
        {
            "introduction": "The overall stability of an IMEX scheme is governed by the explicit treatment of the non-stiff term, making the design of the explicit operator critical. This practice problem explores this concept by comparing two common numerical fluxes for the advection operator: pure upwind and Lax-Friedrichs. You will analyze how these different flux choices introduce varying amounts of artificial viscosity, which in turn alters the operator's eigenvalues and impacts the explicit time step (CFL) constraint .",
            "id": "3391296",
            "problem": "Consider the linear scalar advection equation on a uniform one-dimensional mesh,\n$$\nu_t + a\\,u_x = 0,\\quad a\\in\\mathbb{R}\\setminus\\{0\\},\n$$\ndiscretized by a first-order Discontinuous Galerkin (DG) method (piecewise constant basis, equivalent to a conservative finite volume update for cell averages) with interface numerical fluxes. Let the cell size be $h0$ and denote cell averages by $u_j(t)$ over cells $I_j=[x_{j-\\tfrac{1}{2}},x_{j+\\tfrac{1}{2}}]$. The semi-discrete DG update is\n$$\n\\frac{d u_j}{dt} \\;=\\; -\\frac{1}{h}\\left(F_{j+\\tfrac{1}{2}} - F_{j-\\tfrac{1}{2}}\\right),\n$$\nwhere $F_{j\\pm\\tfrac{1}{2}}$ are interface fluxes computed from left and right traces $u^- = u_j$ and $u^+ = u_{j\\pm 1}$. Two fluxes are considered:\n\n- Pure upwind flux for $a0$: $F^{\\text{up}}_{j+\\tfrac{1}{2}} = a\\,u_j$ and $F^{\\text{up}}_{j-\\tfrac{1}{2}} = a\\,u_{j-1}$ (if $a0$ the roles of $u^-$ and $u^+$ are reversed).\n\n- Lax–Friedrichs (also called Rusanov) flux: \n$$\nF^{\\text{LF}}_{j+\\tfrac{1}{2}} \\;=\\; \\frac{a}{2}\\left(u_j + u_{j+1}\\right) \\;-\\; \\frac{\\alpha}{2}\\left(u_{j+1} - u_j\\right),\n$$\nwith a numerical viscosity parameter $\\alpha = \\theta\\,|a|$ for some $\\theta\\ge 1$.\n\nAnswer the following, using only the governing conservation law, the DG semi-discrete update, and Fourier (von Neumann) analysis of the resulting linear constant-coefficient schemes:\n\n- Derive the semi-discrete operator for the Lax–Friedrichs flux and compare it to pure upwind for $a0$; from the Fourier symbol quantify the additional dissipation introduced when $\\theta1$ by expressing the continuum-limit artificial viscosity coefficient multiplying $u_{xx}$.\n\n- Using the stability region of Forward Euler, determine the worst-case explicit time-step bound $\\Delta t$ implied by the explicit advection operator when diffusion is treated implicitly in an Implicit-Explicit scheme for advection-diffusion. Express the scaling with $h$, $|a|$, and $\\theta$.\n\nWhich of the following statements are correct?\n\nA. For the scalar advection equation with constant $a$, the Lax–Friedrichs flux with $\\alpha=|a|$ is algebraically identical to the pure upwind flux; therefore no additional dissipation is introduced and the explicit time-step constraint for the advection operator is unchanged.\n\nB. For $\\alpha=\\theta\\,|a|$ with $\\theta1$, the Lax–Friedrichs flux adds an artificial viscosity term whose continuum-limit coefficient is $\\nu_{\\text{num}}=\\tfrac{(\\alpha-|a|)}{2}\\,h$, and the semi-discrete eigenvalues are shifted further into the negative real axis; under Forward Euler, the worst-case explicit time-step bound scales as $\\Delta t \\le C\\,h/(\\theta\\,|a|)$ with $C$ a method-dependent constant, tightening the advection CFL by a factor of $\\theta$ relative to upwind.\n\nC. The additional dissipation from the Lax–Friedrichs flux with $\\theta1$ relaxes the explicit advection time-step restriction in IMEX because high-frequency modes are damped, allowing $\\Delta t$ to grow like $\\theta\\,h/|a|$.\n\nD. In an IMEX advection-diffusion scheme with diffusion treated implicitly, the choice between pure upwind and Lax–Friedrichs flux for the explicit advection operator does not affect the explicit time-step constraint.",
            "solution": "### Derivation and Analysis\n\nWe are tasked with deriving the semi-discrete operator for the Lax–Friedrichs flux, comparing it to the pure upwind flux, quantifying the artificial viscosity, and determining the explicit time-step constraint.\n\nLet the semi-discrete operator be $\\mathcal{L}_{h}$ such that $\\frac{d u_j}{dt} = (\\mathcal{L}_{h} u)_j$.\n\n**1. Semi-discrete Operator for Lax–Friedrichs Flux**\nThe flux at interface $x_{j+1/2}$ is $F_{j+1/2} = F^{\\text{LF}}(u_j, u_{j+1})$. The flux at $x_{j-1/2}$ is $F_{j-1/2} = F^{\\text{LF}}(u_{j-1}, u_j)$.\n$$\nF^{\\text{LF}}_{j+1/2} = \\frac{a}{2}(u_j + u_{j+1}) - \\frac{\\alpha}{2}(u_{j+1} - u_j)\n$$\n$$\nF^{\\text{LF}}_{j-1/2} = \\frac{a}{2}(u_{j-1} + u_j) - \\frac{\\alpha}{2}(u_j - u_{j-1})\n$$\nThe update for cell $j$ is:\n$$\n\\frac{d u_j}{dt} = -\\frac{1}{h} \\left( F^{\\text{LF}}_{j+1/2} - F^{\\text{LF}}_{j-1/2} \\right)\n$$\nLet's compute the flux difference:\n$$\nF^{\\text{LF}}_{j+1/2} - F^{\\text{LF}}_{j-1/2} = \\left[ \\frac{a}{2}(u_j + u_{j+1}) - \\frac{\\alpha}{2}(u_{j+1} - u_j) \\right] - \\left[ \\frac{a}{2}(u_{j-1} + u_j) - \\frac{\\alpha}{2}(u_j - u_{j-1}) \\right]\n$$\nThe terms $\\frac{a}{2}u_j$ cancel. We rearrange the remaining terms:\n$$\nF^{\\text{LF}}_{j+1/2} - F^{\\text{LF}}_{j-1/2} = \\frac{a}{2}(u_{j+1} - u_{j-1}) - \\frac{\\alpha}{2} \\left[ (u_{j+1} - u_j) - (u_j - u_{j-1}) \\right]\n$$\n$$\nF^{\\text{LF}}_{j+1/2} - F^{\\text{LF}}_{j-1/2} = \\frac{a}{2}(u_{j+1} - u_{j-1}) - \\frac{\\alpha}{2} (u_{j+1} - 2u_j + u_{j-1})\n$$\nSubstituting this into the semi-discrete form:\n$$\n\\frac{d u_j}{dt} = -\\frac{a}{2h}(u_{j+1} - u_{j-1}) + \\frac{\\alpha}{2h}(u_{j+1} - 2u_j + u_{j-1})\n$$\nThis can be written using finite difference operator notation as:\n$$\n\\frac{d u_j}{dt} = -a \\delta_{2x} u_j + \\frac{\\alpha h}{2} \\delta_{xx} u_j\n$$\nwhere $\\delta_{2x}$ is the central difference operator for the first derivative and $\\delta_{xx}$ is the central difference operator for the second derivative. This is the standard Lax-Friedrichs scheme.\n\n**2. Comparison with Upwind Flux and Artificial Viscosity**\n\nLet's first analyze the case $\\alpha = |a|$ (i.e., $\\theta = 1$).\nAssume $a0$. Then $\\alpha = a$. The Lax-Friedrichs scheme becomes:\n$$\n\\frac{d u_j}{dt} = -\\frac{a}{2h}(u_{j+1} - u_{j-1}) + \\frac{a}{2h}(u_{j+1} - 2u_j + u_{j-1})\n$$\n$$\n\\frac{d u_j}{dt} = \\frac{a}{2h} \\left[ -(u_{j+1} - u_{j-1}) + (u_{j+1} - 2u_j + u_{j-1}) \\right]\n$$\n$$\n\\frac{d u_j}{dt} = \\frac{a}{2h} \\left[ -u_{j+1} + u_{j-1} + u_{j+1} - 2u_j + u_{j-1} \\right] = \\frac{a}{2h} [-2u_j + 2u_{j-1}] = -a \\frac{u_j - u_{j-1}}{h}\n$$\nThis is precisely the first-order upwind scheme for $a0$. A similar derivation for $a0$ (where $\\alpha = -a$) shows the Lax-Friedrichs flux reduces to $F^{\\text{LF}}_{j+1/2}=a u_{j+1}$, which is the correct upwind flux, yielding the upwind scheme $-a \\frac{u_{j+1}-u_j}{h}$. Thus, for $\\theta=1$, Lax-Friedrichs is identical to first-order upwind.\n\nNow, consider the continuum limit via Taylor expansion to find the artificial viscosity.\nThe upwind scheme ($a0$) $ -a \\frac{u_j - u_{j-1}}{h}$ approximates the modified PDE $u_t + au_x = \\frac{ah}{2} u_{xx}$. The numerical viscosity is $\\nu_{\\text{up}} = \\frac{|a|h}{2}$.\nThe Lax-Friedrichs scheme $-a \\frac{u_{j+1} - u_{j-1}}{2h} + \\frac{\\alpha}{2h}(u_{j+1} - 2u_j + u_{j-1})$ approximates $u_t + au_x = \\frac{\\alpha h}{2} u_{xx}$. The numerical viscosity is $\\nu_{\\text{LF}} = \\frac{\\alpha h}{2}$.\nThe *additional* dissipation introduced by Lax-Friedrichs with $\\theta  1$ compared to the pure upwind scheme has a coefficient:\n$$\n\\nu_{\\text{add}} = \\nu_{\\text{LF}} - \\nu_{\\text{up}} = \\frac{\\alpha h}{2} - \\frac{|a|h}{2} = \\frac{(\\alpha-|a|)h}{2}\n$$\nSince $\\alpha = \\theta|a|$, this is also $\\nu_{\\text{add}} = \\frac{(\\theta-1)|a|h}{2}$.\n\n**3. Fourier Analysis and Timestep Constraint**\n\nWe perform a von Neumann stability analysis on the semi-discrete operator for the Lax-Friedrichs scheme. We look for eigenvalues $\\lambda$ by substituting $u_j(t) = \\hat{u}(t)e^{ikx_j} = \\hat{u}(t)e^{i\\xi j}$ where $\\xi=kh$ is the dimensionless wavenumber.\n$$\n\\frac{d \\hat{u}}{dt} = \\lambda(\\xi) \\hat{u}\n$$\n$$\n\\lambda(\\xi) = -\\frac{a}{2h}(e^{i\\xi} - e^{-i\\xi}) + \\frac{\\alpha}{2h}(e^{i\\xi} - 2 + e^{-i\\xi})\n$$\n$$\n\\lambda(\\xi) = -\\frac{a}{h}(i\\sin\\xi) + \\frac{\\alpha}{h}(\\cos\\xi - 1)\n$$\nWith $\\alpha = \\theta|a|$, the eigenvalues are:\n$$\n\\lambda(\\xi) = -\\frac{ia}{h}\\sin\\xi - \\frac{\\theta|a|}{h}(1-\\cos\\xi)\n$$\nThe stability of an explicit Forward Euler time integration, $u^{n+1}_j = u^n_j + \\Delta t (\\mathcal{L}_h u^n)_j$, requires that $\\Delta t \\lambda(\\xi)$ lies within the Forward Euler stability region for all $\\xi \\in [-\\pi, \\pi]$. This region is the disk $|1+z| \\le 1$ in the complex plane, where $z = \\Delta t \\lambda(\\xi)$.\nThe eigenvalues $\\lambda(\\xi)$ trace an ellipse in the complex plane centered at $(-\\frac{\\theta|a|}{h}, 0)$, with imaginary semi-axis of length $\\frac{|a|}{h}$ and real semi-axis of length $\\frac{\\theta|a|}{h}$.\nThe stability condition must hold for all eigenvalues. The most restrictive condition comes from the point on the ellipse furthest from the origin along the negative real axis. This occurs at $\\xi=\\pi$, where $\\cos\\pi=-1$ and $\\sin\\pi=0$.\n$$\n\\lambda(\\pi) = -\\frac{\\theta|a|}{h}(1 - (-1)) = -\\frac{2\\theta|a|}{h}\n$$\nThe Forward Euler stability region on the negative real axis is $[-2, 0]$. Therefore, we must satisfy:\n$$\n-2 \\le \\Delta t \\lambda(\\pi) \\le 0\n$$\n$$\n-2 \\le \\Delta t \\left(-\\frac{2\\theta|a|}{h}\\right) \\le 0\n$$\nThe right-hand inequality is satisfied since all quantities are positive. The left-hand inequality gives the stability constraint:\n$$\n\\Delta t \\frac{2\\theta|a|}{h} \\le 2\n$$\n$$\n\\Delta t \\le \\frac{h}{\\theta|a|}\n$$\nFor the upwind scheme ($\\theta=1$), the CFL constraint is $\\Delta t \\le \\frac{h}{|a|}$. For the Lax-Friedrichs scheme with $\\theta  1$, the constraint is tightened by a factor of $\\theta$.\n\n### Option-by-Option Analysis\n\n**A. For the scalar advection equation with constant $a$, the Lax–Friedrichs flux with $\\alpha=|a|$ is algebraically identical to the pure upwind flux; therefore no additional dissipation is introduced and the explicit time-step constraint for the advection operator is unchanged.**\n-   As derived above, for $\\alpha=|a|$ (which corresponds to $\\theta=1$), the semi-discrete operator for the Lax-Friedrichs flux is algebraically identical to the first-order upwind scheme.\n-   Because the schemes are identical, they have the same amount of dissipation (no *additional* dissipation is introduced).\n-   Consequently, they have the same stability properties and the same explicit time-step constraint, $\\Delta t \\le h/|a|$.\n-   **Verdict: Correct.**\n\n**B. For $\\alpha=\\theta\\,|a|$ with $\\theta1$, the Lax–Friedrichs flux adds an artificial viscosity term whose continuum-limit coefficient is $\\nu_{\\text{num}}=\\tfrac{(\\alpha-|a|)}{2}\\,h$, and the semi-discrete eigenvalues are shifted further into the negative real axis; under Forward Euler, the worst-case explicit time-step bound scales as $\\Delta t \\le C\\,h/(\\theta\\,|a|)$ with $C$ a method-dependent constant, tightening the advection CFL by a factor of $\\theta$ relative to upwind.**\n-   The additional artificial viscosity coefficient was derived as $\\nu_{\\text{add}} = \\frac{(\\alpha-|a|)h}{2}$. This is correct.\n-   The real part of the eigenvalues is $\\text{Re}(\\lambda) = -\\frac{\\theta|a|}{h}(1-\\cos\\xi)$. For the upwind scheme, $\\theta=1$, so $\\text{Re}(\\lambda_{\\text{up}}) = -\\frac{|a|}{h}(1-\\cos\\xi)$. For $\\theta1$, the real part is more negative (for $\\xi \\ne 0$), meaning the eigenvalues are shifted further into the left half-plane (i.e., further into the negative real axis for the part of the spectrum on the real axis, and with a more negative real part for the rest). This is correct.\n-   The explicit time-step bound was derived as $\\Delta t \\le \\frac{h}{\\theta|a|}$. This matches the scaling $\\Delta t \\le C\\,h/(\\theta\\,|a|)$ with a constant $C=1$.\n-   Compared to the upwind case ($\\theta=1$, $\\Delta t_{\\text{up}} \\le h/|a|$), the time step for $\\theta1$ is smaller by a factor of $\\theta$. The constraint is indeed tightened.\n-   **Verdict: Correct.**\n\n**C. The additional dissipation from the Lax–Friedrichs flux with $\\theta1$ relaxes the explicit advection time-step restriction in IMEX because high-frequency modes are damped, allowing $\\Delta t$ to grow like $\\theta\\,h/|a|$.**\n-   The additional dissipation (larger negative real part of eigenvalues) pushes the eigenvalues further from the origin along the negative real axis. For an explicit method like Forward Euler, whose stability region is bounded on the negative real axis, this makes the stability condition *stricter*, not more relaxed.\n-   Our derivation showed $\\Delta t \\le \\frac{h}{\\theta|a|}$. As $\\theta$ increases, the allowed $\\Delta t$ decreases. The statement claims $\\Delta t$ can grow, which is the opposite of the truth.\n-   **Verdict: Incorrect.**\n\n**D. In an IMEX advection-diffusion scheme with diffusion treated implicitly, the choice between pure upwind and Lax–Friedrichs flux for the explicit advection operator does not affect the explicit time-step constraint.**\n-   In an IMEX scheme where diffusion is treated implicitly, the explicit part of the scheme (advection) dictates the explicit time-step constraint.\n-   The time-step constraint for the pure upwind advection operator is $\\Delta t \\le \\frac{h}{|a|}$.\n-   The time-step constraint for the Lax-Friedrichs advection operator is $\\Delta t \\le \\frac{h}{\\theta|a|}$.\n-   Unless $\\theta=1$, these two constraints are different. Therefore, the choice of flux explicitly affects the time-step constraint.\n-   **Verdict: Incorrect.**",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "Moving from theory to practical implementation, we must acknowledge that the linear systems arising from the implicit part of an IMEX scheme are almost always solved inexactly using iterative methods. This exercise addresses the crucial question of how the accuracy of the iterative solve affects the overall temporal accuracy of the IMEX integrator. You will analyze how the solver tolerance $\\tau$ must scale with the time step $\\Delta t$ to preserve the method's designed order of accuracy, a fundamental consideration for developing efficient and robust solvers .",
            "id": "3391226",
            "problem": "Consider the linear advection-diffusion initial-value problem on a periodic domain,\n$$\nu_t + a\\,u_x \\;=\\; \\nu\\,u_{xx}, \\qquad x\\in [0,L], \\quad t\\ge 0,\n$$\nwith smooth initial data, where $a\\in\\mathbb{R}$ and $\\nu0$. Suppose the spatial discretization is performed by a high-order Discontinuous Galerkin (DG) method or a Fourier spectral method, yielding a semi-discrete ordinary differential equation (ODE) system\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) \\;=\\; \\mathbf{f}(\\mathbf{u}(t)) \\;+\\; \\mathbf{g}(\\mathbf{u}(t)),\n$$\nwhere $\\mathbf{M}$ is a symmetric positive definite mass matrix, $\\mathbf{f}$ encodes the explicit advection contribution, and $\\mathbf{g}$ encodes the stiff diffusion contribution. Assume $\\mathbf{g}$ is linear and can be written as $\\mathbf{g}(\\mathbf{u})=\\mathbf{L}\\mathbf{u}$ with $\\mathbf{L}$ symmetric negative semi-definite in the $\\mathbf{M}$-inner product. The time integration uses an Implicit-Explicit (IMEX) Additive Runge-Kutta (ARK) method of global order $p\\ge 1$ with an $L$-stable implicit part. At each implicit stage, the linear system for the stage value $\\mathbf{Y}_i$ is solved inexactly by an iterative method that is terminated when the stage equation residual in the $\\mathbf{M}$-norm satisfies\n$$\n\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\;\\le\\; \\tau,\n$$\nwhere $\\tau0$ is a user-specified absolute tolerance and $\\|\\mathbf{v}\\|_{\\mathbf{M}}:=\\sqrt{\\mathbf{v}^\\top \\mathbf{M}\\mathbf{v}}$. Assume there exists a constant $c_\\star$ independent of the time step $\\Delta t$ and the spatial resolution such that, for each implicit stage matrix of the form $\\mathbf{A}_i(\\Delta t):=\\mathbf{M}-\\Delta t\\,\\gamma_i\\,\\mathbf{J}_g$ (with $\\gamma_i0$ the diagonal implicit coefficient and $\\mathbf{J}_g$ the Jacobian of $\\mathbf{g}$, here equal to $\\mathbf{L}$), the inverse is uniformly bounded in the $\\mathbf{M}$-operator norm:\n$\n\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star.\n$\nNeglect spatial discretization error by assuming it is asymptotically smaller than the temporal error for the time steps under consideration.\n\nYou are asked to analyze how the inexactness of the implicit stage solves affects the overall accuracy of the IMEX method. In particular, determine how the tolerance $\\tau$ should scale with the time step $\\Delta t$ in order to retain the designed global order $p$ of the IMEX method for the semi-discrete advection-diffusion system. Choose the best recommendation that guarantees preservation of global order $p$ with minimal oversolving, and justify your choice by reasoning from the semi-discrete ODE, stability of the implicit operator, and the structure of the IMEX ARK method.\n\nWhich recommendation is most appropriate?\n\nA. Choose $\\tau = C\\,\\Delta t^{p}$ (with $C$ independent of $\\Delta t$), enforced as an absolute tolerance on the stage residual in the $\\mathbf{M}$-norm, so that the solver-induced local defect is of the same asymptotic size as the method’s local truncation error.\n\nB. Choose $\\tau = C\\,\\Delta t^{p+1}$ to match the local truncation error directly, because the stage residual contributes to the one-step error without any additional factor of $\\Delta t$.\n\nC. Keep $\\tau$ independent of $\\Delta t$ to avoid unnecessary work at small $\\Delta t$, since the implicit operator is $L$-stable and damps stiffness-originated errors.\n\nD. Choose $\\tau = C\\,\\Delta t^{p-1}$ because diffusion stiffness amplifies stage errors by a factor of order $\\Delta t^{-1}$, requiring tighter stage tolerances than the nominal local truncation error scaling.\n\nHere $C0$ denotes a $\\Delta t$-independent constant that may depend on solution norms and method coefficients. Assume all stability and smoothness conditions needed for classical order $p$ error estimates hold for the exact solves, and focus only on the effect of terminating the implicit stage solves at tolerance $\\tau$ as specified above.",
            "solution": "The goal is to determine how the tolerance $\\tau$ for the inexact linear solves must scale with the time step $\\Delta t$ to ensure the global error of the time integration method remains $\\mathcal{O}(\\Delta t^p)$.\n\n1.  **Local Truncation Error (LTE):** An IMEX ARK method with global order $p$ has a local truncation error of order $\\mathcal{O}(\\Delta t^{p+1})$. This is the error introduced in a single step, assuming the step begins with the exact solution to the ODE system and all stage equations are solved exactly. To maintain the global order $p$, any additional errors introduced within a step must not be of a lower order in $\\Delta t$ than the method's own LTE.\n\n2.  **Analysis of an Inexact Implicit Stage:** Let us consider a generic implicit stage $i$ of the ARK method. The implicit part of the stage equation can be written as:\n    $$(\\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}) \\mathbf{Y}_i = \\mathbf{b}_i$$\n    where $\\mathbf{Y}_i$ is the exact stage solution vector and $\\mathbf{b}_i$ contains information from the previous time step and prior stages. Let $\\mathbf{A}_i := \\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}$. The exact stage solution is $\\mathbf{Y}_i = \\mathbf{A}_i^{-1}\\mathbf{b}_i$.\n\n    The iterative solver computes an approximate stage solution, $\\hat{\\mathbf{Y}}_i$. The solver is terminated when the residual $\\mathbf{r}_i := \\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i$ satisfies $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$.\n\n3.  **Error in the Stage Solution:** The error in the stage solution due to the inexact solve is $\\mathbf{e}_i := \\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i$. We can relate this error to the residual:\n    $$\\mathbf{A}_i \\mathbf{e}_i = \\mathbf{A}_i (\\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i) = (\\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i) - (\\mathbf{A}_i \\mathbf{Y}_i - \\mathbf{b}_i) = \\mathbf{r}_i - \\mathbf{0} = \\mathbf{r}_i$$\n    Therefore, the stage solution error is $\\mathbf{e}_i = \\mathbf{A}_i^{-1} \\mathbf{r}_i$.\n\n4.  **Bounding the Stage Solution Error:** Using the norm induced by the $\\mathbf{M}$-inner product, we can bound the magnitude of this error:\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} = \\|\\mathbf{A}_i^{-1} \\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\|\\mathbf{r}_i\\|_{\\mathbf{M}}$$\n    Using the problem's givens, $\\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ and $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$, we obtain a bound on the stage error:\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} \\le c_\\star \\tau$$\n    This shows that the error in each stage vector is of order $\\mathcal{O}(\\tau)$.\n\n5.  **Contribution to the One-Step Error:** The error in the stage solutions, $\\mathbf{e}_i$, propagates to the final solution update for the step. The solution at the new time level, $\\mathbf{u}_{n+1}$, is computed as a linear combination of the solution at the old time level, $\\mathbf{u}_n$, and terms involving the stage values:\n    $$\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t \\sum_{j=1}^s \\left( b_j^E \\mathbf{f}(\\mathbf{Y}_j) + b_j^I \\mathbf{L}\\mathbf{Y}_j \\right)$$\n    When using the inexact stage solutions $\\hat{\\mathbf{Y}}_j = \\mathbf{Y}_j + \\mathbf{e}_j$, the computed update $\\hat{\\mathbf{u}}_{n+1}$ will differ from the exact-solve update $\\mathbf{u}_{n+1}$. The error induced by the solver in one step, $\\delta_{\\text{step}} := \\hat{\\mathbf{u}}_{n+1} - \\mathbf{u}_{n+1}$, is:\n    $$\\delta_{\\text{step}} = \\Delta t \\sum_{j=1}^s \\left( b_j^E (\\mathbf{f}(\\hat{\\mathbf{Y}}_j) - \\mathbf{f}(\\mathbf{Y}_j)) + b_j^I \\mathbf{L}(\\hat{\\mathbf{Y}}_j - \\mathbf{Y}_j) \\right)$$\n    Assuming the functions are well-behaved (e.g., $\\mathbf{f}$ is Lipschitz continuous), the term inside the summation is of the order of the stage errors, $\\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}}$.\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} \\approx \\mathcal{O}(\\Delta t \\cdot \\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}})$$\n    Since $\\|\\mathbf{e}_j\\|_{\\mathbf{M}} = \\mathcal{O}(\\tau)$, the local error introduced by the inexact solves is:\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} = \\mathcal{O}(\\Delta t \\cdot \\tau)$$\n\n6.  **Matching Error Orders:** To preserve the method's global order of $p$, the local error from the inexact solves must be, at most, of the same order as the method's intrinsic local truncation error.\n    $$\\text{Solver-induced local error} \\le \\text{Method's local truncation error}$$\n    $$\\mathcal{O}(\\Delta t \\cdot \\tau) \\le \\mathcal{O}(\\Delta t^{p+1})$$\n    For this to hold as $\\Delta t \\to 0$, we must have:\n    $$\\tau = \\mathcal{O}(\\Delta t^p)$$\n    Choosing $\\tau = C\\,\\Delta t^p$ for some constant $C$ ensures that the solver-induced local error is $\\mathcal{O}(\\Delta t^{p+1})$, which matches the order of the method's LTE. This choice is optimal in that it is the least stringent requirement on $\\tau$ that preserves the order of accuracy, thus avoiding unnecessary oversolving.\n\n### Option-by-Option Analysis\n\n**A. Choose $\\tau = C\\,\\Delta t^{p}$ (with $C$ independent of $\\Delta t$), enforced as an absolute tolerance on the stage residual in the $\\mathbf{M}$-norm, so that the solver-induced local defect is of the same asymptotic size as the method’s local truncation error.**\nThis recommendation aligns perfectly with our derivation. Setting $\\tau = C\\,\\Delta t^p$ makes the solver-induced local error $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t^{p+1})$, which is the same order as the method's local truncation error. This ensures that the global order $p$ is preserved without making the tolerance unnecessarily strict.\n**Verdict: Correct.**\n\n**B. Choose $\\tau = C\\,\\Delta t^{p+1}$ to match the local truncation error directly, because the stage residual contributes to the one-step error without any additional factor of $\\Delta t$.**\nThe scaling $\\tau = C\\,\\Delta t^{p+1}$ is unnecessarily strict. It leads to a solver-induced local error of $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p+1}) = \\mathcal{O}(\\Delta t^{p+2})$, which is one order smaller than required. This results in \"oversolving\" and unnecessary computational cost. The justification is also flawed; as shown in the derivation, the contribution of stage-level errors to the one-step error is scaled by a factor of $\\Delta t$ arising from the Runge-Kutta update formula.\n**Verdict: Incorrect.**\n\n**C. Keep $\\tau$ independent of $\\Delta t$ to avoid unnecessary work at small $\\Delta t$, since the implicit operator is $L$-stable and damps stiffness-originated errors.**\nIf $\\tau = \\mathcal{O}(1)$ (independent of $\\Delta t$), the solver-induced local error is $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t)$. For any method with order $p \\ge 1$, its LTE is $\\mathcal{O}(\\Delta t^{p+1})$, which is of higher order than $\\mathcal{O}(\\Delta t)$. The total local error would be dominated by the solver error, becoming $\\mathcal{O}(\\Delta t)$. The accumulated global error over $T/\\Delta t$ steps would be $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t) = \\mathcal{O}(1)$, implying a total loss of convergence as $\\Delta t \\to 0$. The $L$-stability is already accounted for in the constant $c_\\star$ and does not eliminate the need to control the tolerance.\n**Verdict: Incorrect.**\n\n**D. Choose $\\tau = C\\,\\Delta t^{p-1}$ because diffusion stiffness amplifies stage errors by a factor of order $\\Delta t^{-1}$, requiring tighter stage tolerances than the nominal local truncation error scaling.**\nThis choice of tolerance $\\tau = C\\,\\Delta t^{p-1}$ leads to a solver-induced local error of $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p-1}) = \\mathcal{O}(\\Delta t^p)$. This error will dominate the method's LTE of $\\mathcal{O}(\\Delta t^{p+1})$. The total local error is $\\mathcal{O}(\\Delta t^p)$, which leads to a global error of $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t^p) = \\mathcal{O}(\\Delta t^{p-1})$. The method's order is reduced from $p$ to $p-1$. The reasoning is also faulty: the assumption $\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ explicitly states that there is no $\\Delta t^{-1}$ amplification. This assumption is a direct consequence of the $L$-stability of the implicit method applied to a dissipative operator.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}