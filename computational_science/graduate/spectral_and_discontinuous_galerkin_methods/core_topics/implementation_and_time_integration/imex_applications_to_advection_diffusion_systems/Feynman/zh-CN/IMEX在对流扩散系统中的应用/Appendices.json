{
    "hands_on_practices": [
        {
            "introduction": "在应用复杂的时间步进格式之前，理解空间离散化如何导出常微分方程组至关重要。本练习将指导你为一个简单的平流问题推导间断 Galerkin (DG) 算子，并分析其稳定性，为后续的时间积分方法奠定基础。通过这个练习，你将从最基本的原理出发，亲手构建并分析一个半离散系统 。",
            "id": "3391299",
            "problem": "考虑周期区间 $[0,1]$ 上平流-扩散系统中的线性平流部分，由标量守恒律 $u_{t} + (a u)_{x} = 0$ 给出，其中平流速度为常数 $a = 1$。在一个包含 $K=2$ 个大小相等（$h = \\frac{1}{2}$）的单元的均匀网格上，使用分片常数基函数（0次多项式）的间断伽辽金（DG）方法来离散化平流算子，并施加周期性边界条件。对界面项使用迎风数值通量，并执行精确积分。组装显式半离散DG平流算子矩阵 $L$，使得半离散系统表示为 $u_{t} = L u$，其中 $u$ 是DG自由度的向量。\n\n从守恒律和每个单元上的DG弱形式出发，推导在该网格上 $L$ 的显式形式。然后计算该矩阵的谱半径 $\\rho(L)$。最后，考虑一种隐式-显式（IMEX）欧拉时间离散格式，其中平流项由显式前向欧拉方法处理，而扩散项（此算子中不存在）将进行隐式处理。利用前向欧拉方法的绝对稳定域，确定该网格上由平流算子所施加的最大线性稳定显式时间步长 $\\Delta t_{\\max}$。\n\n将最终答案以行矩阵 $\\big[ \\rho(L) \\ \\ \\Delta t_{\\max} \\big]$ 的精确形式（无舍入）表示。",
            "solution": "用户想要分析线性平流方程的间断伽辽金（DG）离散。\n\n### 第一步：提取已知条件\n- **偏微分方程 (PDE)**: $u_{t} + (a u)_{x} = 0$\n- **区域**: 周期区间 $[0,1]$\n- **平流速度**: 常数, $a = 1$\n- **离散方法**: 间断伽辽金 (DG)\n- **基函数**: 分片常数 (多项式次数 $p=0$)\n- **网格**: 均匀网格，包含 $K = 2$ 个单元。\n- **单元尺寸**: $h = \\frac{1-0}{K} = \\frac{1}{2}$\n- **单元定义**: $I_1 = [0, \\frac{1}{2}]$, $I_2 = [\\frac{1}{2}, 1]$\n- **数值通量**: 界面项使用迎风通量。\n- **积分**: 使用精确积分。\n- **任务**:\n    1. 组装系统 $u_{t} = L u$ 的半离散DG算子矩阵 $L$。\n    2. 计算谱半径 $\\rho(L)$。\n    3. 确定应用于此算子的前向欧拉格式的最大线性稳定显式时间步长 $\\Delta t_{\\max}$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是偏微分方程数值分析中的一个标准练习，特别是在谱方法和间断伽辽金方法的专题内。\n- **科学依据**：该问题基于成熟的线性平流DG方法，这是计算科学中的一个基本课题。所引用的所有原理（弱形式、数值通量、稳定性分析）都是标准且正确的。\n- **适定性**：问题陈述清晰，包含了推导唯一算子矩阵 $L$ 所需的所有参数（PDE、区域、边界条件、离散化细节）。后续计算其谱半径和相应显式时间步长稳定极限的任务是定义明确的数学过程。\n- **客观性**：问题以精确、无歧义的数学语言表述。\n- **完整性**：设置是完整的。方程、区域、网格、基函数和数值通量均已指定。\n- **结论**：该问题是有效的、自洽的且一致的。\n\n### 第三步：判断与行动\n问题有效。将继续进行求解。\n\n### 半离散系统的推导\n\nPDE $u_t + (au)_x = 0$ 的DG弱形式是通过乘以一个来自相同逼近空间的测试函数 $v_h$ 并在单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分得到的：\n$$\n\\int_{I_j} u_t v_h \\, dx + \\int_{I_j} (au)_x v_h \\, dx = 0\n$$\n对第二项应用分部积分得到：\n$$\n\\int_{I_j} u_t v_h \\, dx - \\int_{I_j} au v_{h,x} \\, dx + [au v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\n展开边界项并将通量 $au$ 替换为数值通量，记作 $(au)^*$，我们得到：\n$$\n\\int_{I_j} u_t v_h \\, dx - \\int_{I_j} au v_{h,x} \\, dx + (au)^*|_{x_{j+1/2}} v_h(x_{j+1/2}^-) - (au)^*|_{x_{j-1/2}} v_h(x_{j-1/2}^+) = 0\n$$\n这里，$v_h(x_{j+1/2}^-)$ 是测试函数在右边界处从单元 $I_j$ 内部取的值，而 $v_h(x_{j-1/2}^+)$ 是在左边界处从单元 $I_j$ 内部取的值。\n\n对于本问题，我们使用分片常数基函数 ($p=0$)。在单元 $I_j$ 上的近似解为 $u_h(x,t) = u_j(t)$，其中 $x \\in I_j$。测试函数在单元上也是一个常数，$v_h(x) = 1$。因此，其导数 $v_{h,x}$ 为 $0$，项 $\\int_{I_j} au v_{h,x} \\, dx$ 消失。公式简化为：\n$$\n\\int_{I_j} \\frac{du_j}{dt} \\cdot 1 \\, dx + (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} = 0\n$$\n由于 $\\int_{I_j} dx = h$，我们有：\n$$\nh \\frac{du_j}{dt} + (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} = 0\n$$\n对时间导数重新整理，得到单元 $j$ 的半离散形式：\n$$\n\\frac{du_j}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} \\right)\n$$\n\n对于平流速度 $a > 0$，指定的迎风通量为 $(au)^* = a u_{\\text{left}}$，其中 $u_{\\text{left}}$ 是界面左侧单元中解的值。给定 $a=1$。\n\n网格由两个单元组成，$I_1 = [0, 1/2]$ 和 $I_2 = [1/2, 1]$，尺寸为 $h=1/2$。自由度为 $u_1$ 和 $u_2$。\n\n**对于单元 $I_1$ (j=1):**\n界面位于 $x_{1/2}=0$ 和 $x_{3/2}=1/2$。方程为：\n$$\n\\frac{du_1}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x=1/2} - (au)^*|_{x=0} \\right)\n$$\n- 在界面 $x=1/2$（$I_1$ 和 $I_2$ 之间），左侧状态为 $u_1$。因此，$(au)^*|_{x=1/2} = a u_1 = u_1$。\n- 在界面 $x=0$ 处，由于周期性边界条件，左侧状态来自区域的末端，即单元 $I_2$。因此，左侧状态为 $u_2$。于是，$(au)^*|_{x=0} = a u_2 = u_2$。\n将这些通量代入 $u_1$ 的方程中：\n$$\n\\frac{du_1}{dt} = - \\frac{1}{h} (u_1 - u_2) = \\frac{1}{h} (-u_1 + u_2)\n$$\n\n**对于单元 $I_2$ (j=2):**\n界面位于 $x_{3/2}=1/2$ 和 $x_{5/2}=1$。方程为：\n$$\n\\frac{du_2}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x=1} - (au)^*|_{x=1/2} \\right)\n$$\n- 在界面 $x=1$ 处，由于周期性边界条件，左侧状态来自单元 $I_2$。因此，$(au)^*|_{x=1} = a u_2 = u_2$。\n- 在界面 $x=1/2$（$I_1$ 和 $I_2$ 之间），左侧状态来自单元 $I_1$，即 $u_1$。因此，$(au)^*|_{x=1/2} = a u_1 = u_1$。\n将这些通量代入 $u_2$ 的方程中：\n$$\n\\frac{du_2}{dt} = - \\frac{1}{h} (u_2 - u_1) = \\frac{1}{h} (u_1 - u_2)\n$$\n\n### 算子矩阵 $L$ 的组装\n常微分方程组为：\n$$\n\\frac{d}{dt} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -u_1 + u_2 \\\\ u_1 - u_2 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}\n$$\n当 $h=1/2$ 时，算子矩阵 $L$ 为：\n$$\nL = \\frac{1}{1/2} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} = 2 \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} -2  2 \\\\ 2  -2 \\end{pmatrix}\n$$\n\n### 谱半径 $\\rho(L)$ 的计算\n$L$ 的特征值 $\\lambda$ 是特征方程 $\\det(L - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} -2-\\lambda  2 \\\\ 2  -2-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-2-\\lambda)^2 - (2)(2) = 0\n$$\n$$\n(2+\\lambda)^2 - 4 = 0\n$$\n$$\n2+\\lambda = \\pm 2\n$$\n两个特征值为：\n$$\n\\lambda_1 = -2 + 2 = 0\n$$\n$$\n\\lambda_2 = -2 - 2 = -4\n$$\n$L$ 的谱为 $\\{0, -4\\}$。谱半径是特征值绝对值的最大值：\n$$\n\\rho(L) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max(|0|, |-4|) = 4\n$$\n\n### 最大稳定时间步长 $\\Delta t_{\\max}$ 的确定\n将前向欧拉方法应用于半离散系统 $u_t = Lu$：\n$$\nu^{n+1} = u^n + \\Delta t L u^n = (I + \\Delta t L) u^n\n$$\n为满足线性稳定性，放大矩阵 $G = I + \\Delta t L$ 的特征值的模必须不大于1。$G$ 的特征值为 $g_i = 1 + \\Delta t \\lambda_i$，其中 $\\lambda_i$ 是 $L$ 的特征值。\n稳定性条件为对所有 $i$ 都有 $|1 + \\Delta t \\lambda_i| \\le 1$。这要求复数 $z = \\Delta t \\lambda_i$ 位于前向欧拉方法的绝对稳定域内，该稳定域是在复平面上以 $-1$ 为中心、半径为 $1$ 的圆盘。\n- 对于 $\\lambda_1 = 0$：$|1 + \\Delta t \\cdot 0| = |1| = 1 \\le 1$。此条件对任何 $\\Delta t$ 都满足。\n- 对于 $\\lambda_2 = -4$：$|1 + \\Delta t (-4)| \\le 1$，即 $|1 - 4 \\Delta t| \\le 1$。\n该不等式等价于 $-1 \\le 1 - 4\\Delta t \\le 1$。\n1.  $1 - 4\\Delta t \\le 1 \\implies -4\\Delta t \\le 0 \\implies \\Delta t \\ge 0$。\n2.  $-1 \\le 1 - 4\\Delta t \\implies 4\\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{4} = \\frac{1}{2}$。\n综合这些条件，我们得到 $0 \\le \\Delta t \\le \\frac{1}{2}$。因此，最大稳定时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{1}{2}\n$$\n\n最终答案要求行矩阵 $[\\rho(L) \\ \\ \\Delta t_{\\max}]$。\n$$\n\\rho(L) = 4, \\quad \\Delta t_{\\max} = \\frac{1}{2}\n$$\n结果矩阵为 $\\begin{pmatrix} 4  \\frac{1}{2} \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "使用 IMEX 方法的主要动机是克服由扩散等刚性项带来的苛刻时间步长限制。本练习  提供了一个具体的定量比较，让你能够计算 IMEX 格式相对于传统全显式方法在典型平流扩散问题上的性能增益。这将帮助你直观地理解算子分裂策略的实际价值。",
            "id": "3391304",
            "problem": "考虑一维常系数平流-扩散方程 $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$，定义在周期性定义域 $x \\in [0,1]$ 上。该方程在尺寸为 $h$ 的均匀网格上，使用多项式次数为 $p$ 的间断伽辽金 (Discontinuous Galerkin, DG) 方法进行空间离散，其中平流项使用迎风格式数值通量，扩散项使用对称内部罚函数伽辽金 (symmetric interior penalty Galerkin, SIPG) 形式。设半离散系统写为加法形式 $u'(t) = L_{A}u(t) + L_{D}u(t)$，其中 $L_{A}$ 是平流算子，$L_{D}$ 是扩散算子。根据 DG 多项式空间的反估计可知，$L_{A}$ 的谱半径按 $\\omega_{A} = \\frac{a}{h}(2p+1)$ 缩放，$L_{D}$ 的谱半径按 $\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}$ 缩放。\n\n您将使用两种不同的时间积分器来推进半离散系统的时间演化：\n- 一种隐式-显式 (Implicit–Explicit, IMEX) 加性龙格-库塔 (Additive Runge–Kutta, ARK) 方法，其中平流部分 $L_{A}$ 被显式处理，扩散部分 $L_{D}$ 被隐式处理。假设隐式部分是 A-稳定的（不受负实特征值的限制），显式部分的线性稳定区域与虚轴的交集是一个已知常数 $\\alpha_{I} = 2.785$。\n- 一种全显式经典四阶龙格-库塔 (Runge–Kutta, RK) 方法，其线性稳定区域与虚轴在 $\\alpha_{E} = 2.785$ 处相交，与负实轴在 $\\beta_{E} = 2.785$ 处相交。\n\n仅使用上述基本事实和缩放定律（不使用任何其他预先制表的稳定性极限或快捷公式），推导每个积分器在绝对稳定性要求下所隐含的时间步长限制，并计算在以下参数值下，允许的最大 IMEX 时间步长与允许的最大全显式 RK 时间步长之比 $R$：$a = 1$，$\\nu = 10^{-3}$，$h = \\frac{1}{128}$，$p = 5$。\n\n将 $R$ 的最终数值答案四舍五入到四位有效数字。将 $R$ 报告为无量纲量。",
            "solution": "我们从半离散表示 $u'(t) = L_{A}u(t) + L_{D}u(t)$ 开始，该表示是由 $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$ 的间断伽辽金 (DG) 空间离散得到的。对于均匀网格上的常系数线性算子，平流算子 $L_{A}$ 的特征值由于其带有迎风通量稳定化的斜伴随特性而主要为纯虚数，而扩散算子 $L_{D}$ 的特征值由于椭圆性和对称内部罚函数伽辽金 (SIPG) 构造而为负实数。\n\n基本的 DG 反估计表明，对于尺寸为 $h$ 的单元上次数为 $p$ 的多项式，导数范数界和迹不等式意味着半离散算子范数按以下方式缩放：\n$$\n\\omega_{A} = \\frac{a}{h}(2p+1), \\qquad \\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}.\n$$\n这些是经过充分检验的缩放估计，分别反映了平流算子和扩散算子的最大模特征值。\n\n将龙格-库塔方法应用于线性系统 $y' = \\lambda y$ 的绝对稳定性要求 $\\Delta t\\,\\lambda$ 位于该方法的稳定区域内。对于纯虚数 $\\lambda$（来自平流），限制由稳定区域与虚轴的交集决定；对于负实数 $\\lambda$（来自扩散），限制由稳定区域与负实轴的交集决定。\n\n对于隐式-显式 (IMEX) 加性龙格-库塔 (ARK) 方法：\n- 显式部分推进 $L_{A}$，其虚数特征值的界为 $|\\lambda_{A}| \\leq \\omega_{A}$。显式稳定区域与虚轴的交点在 $\\alpha_{I} = 2.785$ 处，因此时间步长必须满足\n$$\n\\Delta t_{\\text{IMEX}} \\leq \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- 隐式部分是 A-稳定的，因此负实轴上的扩散特征值不对 $\\Delta t_{\\text{IMEX}}$ 施加限制。\n\n对于全显式经典四阶龙格-库塔 (RK) 方法：\n- 平流限制是\n$$\n\\Delta t \\leq \\frac{\\alpha_{E}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- 扩散限制是\n$$\n\\Delta t \\leq \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{\\frac{\\nu}{h^{2}}(2p+1)^{2}}.\n$$\n全显式允许的时间步长是这两者中的最小值。\n\n我们需要计算在 $a = 1$，$\\nu = 10^{-3}$，$h = \\frac{1}{128}$ 和 $p = 5$ 的条件下，IMEX 最大时间步长与全显式 RK 最大时间步长之比 $R$。首先，我们计算算子尺度：\n$$\n2p+1 = 11, \\quad \\omega_{A} = \\frac{a}{h}(2p+1) = \\frac{1}{h}\\cdot 11 = 11 \\cdot 128 = 1408,\n$$\n$$\n\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2} = \\nu \\cdot \\frac{1}{h^{2}} \\cdot 121 = 10^{-3} \\cdot 16384 \\cdot 121 = 16.384 \\cdot 121 = 1982.464.\n$$\n接下来，我们通过比较平流和扩散的限制来确定哪一个约束对全显式 RK 方法起作用。由于 $\\omega_{D} > \\omega_{A}$，扩散约束更严格：\n$$\n\\Delta t_{\\text{explicit}} = \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{1982.464}.\n$$\n对于 IMEX 方法，只有平流约束适用：\n$$\n\\Delta t_{\\text{IMEX}} = \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{1408}.\n$$\n该比率简化为\n$$\nR = \\frac{\\Delta t_{\\text{IMEX}}}{\\Delta t_{\\text{explicit}}} = \\frac{\\alpha_{I}/\\omega_{A}}{\\beta_{E}/\\omega_{D}} = \\frac{\\alpha_{I}}{\\beta_{E}}\\cdot \\frac{\\omega_{D}}{\\omega_{A}}.\n$$\n给定 $\\alpha_{I} = \\beta_{E} = 2.785$，这变为\n$$\nR = \\frac{\\omega_{D}}{\\omega_{A}} = \\frac{\\frac{\\nu}{h^{2}}(2p+1)^{2}}{\\frac{a}{h}(2p+1)} = \\frac{\\nu}{a}\\cdot \\frac{2p+1}{h}.\n$$\n代入参数值，\n$$\nR = \\frac{10^{-3}}{1}\\cdot \\frac{11}{\\frac{1}{128}} = 10^{-3}\\cdot 11 \\cdot 128 = 1.408.\n$$\n四舍五入到四位有效数字，该比率为 $1.408$。这表明，在给定参数下，与全显式四阶龙格-库塔格式相比，IMEX 方法允许的时间步长要大 $1.408$ 倍。",
            "answer": "$$\\boxed{1.408}$$"
        },
        {
            "introduction": "在实际应用中，IMEX 方法隐式部分产生的线性系统通常通过迭代法求解。本练习  探讨了一个关键的实现细节：迭代求解的精度如何影响整个时间积分的精度。理解这种关系对于设计高效且可靠的求解器至关重要。",
            "id": "3391226",
            "problem": "考虑一个周期域上的线性平流-扩散初值问题，\n$$\nu_t + a\\,u_x \\;=\\; \\nu\\,u_{xx}, \\qquad x\\in [0,L], \\quad t\\ge 0,\n$$\n其初始数据平滑，其中 $a\\in\\mathbb{R}$ 且 $\\nu>0$。假设空间离散化采用高阶间断伽辽金 (DG) 方法或傅里叶谱方法，得到一个半离散的常微分方程 (ODE) 系统\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) \\;=\\; \\mathbf{f}(\\mathbf{u}(t)) \\;+\\; \\mathbf{g}(\\mathbf{u}(t)),\n$$\n其中 $\\mathbf{M}$ 是一个对称正定质量矩阵，$\\mathbf{f}$ 编码了显式平流项的贡献，而 $\\mathbf{g}$ 编码了刚性扩散项的贡献。假设 $\\mathbf{g}$ 是线性的，可以写成 $\\mathbf{g}(\\mathbf{u})=\\mathbf{L}\\mathbf{u}$ 的形式，其中 $\\mathbf{L}$ 在 $\\mathbf{M}$-内积下是对称半负定的。时间积分采用全局阶为 $p\\ge 1$ 的隐式-显式 (IMEX) 附加龙格-库塔 (ARK) 方法，其隐式部分是 L-稳定的。在每个隐式阶段，用于求解阶段值 $\\mathbf{Y}_i$ 的线性系统通过迭代法进行非精确求解，当阶段方程残差的 $\\mathbf{M}$-范数满足以下条件时终止迭代\n$$\n\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\;\\le\\; \\tau,\n$$\n其中 $\\tau>0$ 是用户指定的绝对公差，且 $\\|\\mathbf{v}\\|_{\\mathbf{M}}:=\\sqrt{\\mathbf{v}^\\top \\mathbf{M}\\mathbf{v}}$。假设存在一个与时间步长 $\\Delta t$ 和空间分辨率无关的常数 $c_\\star$，使得对于每个形式为 $\\mathbf{A}_i(\\Delta t):=\\mathbf{M}-\\Delta t\\,\\gamma_i\\,\\mathbf{J}_g$ 的隐式阶段矩阵（其中 $\\gamma_i>0$ 是对角隐式系数，$\\mathbf{J}_g$ 是 $\\mathbf{g}$ 的雅可比矩阵，此处等于 $\\mathbf{L}$），其逆在 $\\mathbf{M}$-算子范数下是一致有界的：\n$\n\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star.\n$\n忽略空间离散误差，假设对于所考虑的时间步长，它渐近地小于时间误差。\n\n你需要分析隐式阶段的非精确求解如何影响 IMEX 方法的整体精度。具体来说，确定公差 $\\tau$ 应如何随时间步长 $\\Delta t$ 缩放，以保持 IMEX 方法对半离散平流-扩散系统所设计的全局阶 $p$。选择能保证保持全局阶 $p$ 且过求解最少的最佳建议，并根据半离散 ODE、隐式算子的稳定性以及 IMEX ARK 方法的结构来论证你的选择。\n\n哪个建议最合适？\n\nA. 选择 $\\tau = C\\,\\Delta t^{p}$（其中 $C$ 与 $\\Delta t$ 无关），作为对阶段残差在 $\\mathbf{M}$-范数下的绝对公差，从而使求解器引起的局部缺陷与方法的局部截断误差具有相同的渐近量级。\n\nB. 选择 $\\tau = C\\,\\Delta t^{p+1}$ 来直接匹配局部截断误差，因为阶段残差对单步误差的贡献没有额外乘以因子 $\\Delta t$。\n\nC. 保持 $\\tau$ 与 $\\Delta t$ 无关以避免在小 $\\Delta t$ 下不必要的工作，因为隐式算子是 L-稳定的，并且会抑制源于刚性的误差。\n\nD. 选择 $\\tau = C\\,\\Delta t^{p-1}$，因为扩散刚性会以 $\\Delta t^{-1}$ 的量级放大阶段误差，这要求比标称的局部截断误差缩放更紧的阶段公差。\n\n此处 $C>0$ 表示一个不依赖于 $\\Delta t$ 的常数，它可能依赖于解的范数和方法的系数。假设对于精确求解，经典 $p$ 阶误差估计所需的所有稳定性和光滑性条件均成立，并且只关注在上述指定的公差 $\\tau$ 下终止隐式阶段求解的影响。",
            "solution": "问题陈述需要进行验证。\n\n### 第 1 步：提取已知条件\n- **控制方程：** 周期域 $x\\in [0,L]$，$t\\ge 0$ 上的线性平流-扩散方程 $u_t + a\\,u_x = \\nu\\,u_{xx}$，其中 $a\\in\\mathbb{R}$，$\\nu>0$，且初始数据平滑。\n- **半离散系统：** $\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) = \\mathbf{f}(\\mathbf{u}(t)) + \\mathbf{g}(\\mathbf{u}(t))$。\n- **质量矩阵 $\\mathbf{M}$：** 对称正定。\n- **平流项 $\\mathbf{f}(\\mathbf{u})$：** 显式处理。\n- **扩散项 $\\mathbf{g}(\\mathbf{u})$：** 刚性，隐式处理。它是线性的，因此 $\\mathbf{g}(\\mathbf{u})=\\mathbf{L}\\mathbf{u}$。\n- **扩散矩阵 $\\mathbf{L}$：** 在 $\\mathbf{M}$-内积下是对称半负定的。\n- **时间积分：** 全局阶为 $p\\ge 1$ 的隐式-显式 (IMEX) 附加龙格-库塔 (ARK) 方法。隐式部分是 L-稳定的。\n- **非精确求解：** 隐式阶段线性系统被非精确求解。\n- **终止准则：** 对每个隐式阶段 $i$ 的迭代求解在阶段方程残差 $\\mathbf{r}_i$ 满足 $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$ 时终止，其中 $\\|\\mathbf{v}\\|_{\\mathbf{M}}:=\\sqrt{\\mathbf{v}^\\top \\mathbf{M}\\mathbf{v}}$ 且 $\\tau>0$ 是一个绝对公差。\n- **隐式阶段矩阵：** 第 $i$ 个隐式阶段的矩阵为 $\\mathbf{A}_i(\\Delta t):=\\mathbf{M}-\\Delta t\\,\\gamma_i\\,\\mathbf{J}_g$，其中 $\\gamma_i>0$ 是隐式龙格-库塔方法的对角系数，$\\mathbf{J}_g=\\mathbf{L}$ 是 $\\mathbf{g}$ 的雅可比矩阵。\n- **有界性假设：** 存在一个与 $\\Delta t$ 和空间分辨率无关的常数 $c_\\star$，使得阶段矩阵的逆在由 $\\mathbf{M}$-范数诱导的算子范数下是一致有界的：$\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star$。\n- **简化假设：** 空间离散误差可忽略。假设经典阶数条件在精确求解情况下成立。\n- **问题：** 确定公差 $\\tau$ 与时间步长 $\\Delta t$ 的缩放关系，以在过求解最少的情况下保持全局精度阶 $p$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：** 该问题是偏微分方程数值分析领域中的一个典型例子。对平流-扩散-反应系统使用 IMEX ARK 方法是一种标准且经过充分研究的技术。离散算子（$\\mathbf{M}$，$\\mathbf{L}$）的性质是间断伽辽金或谱方法等空间离散化方法的典型特征。\n- **适定性：** 该问题是适定的。它要求在数值参数（$\\tau$ 和 $\\Delta t$）之间建立一种特定的关系，以达到期望的理论性质（精度阶）。所提供的假设，特别是隐式阶段矩阵逆的一致有界性，是对此类方法进行严格分析时的标准假设，并且是得出明确结论所必需的。\n- **客观性：** 问题陈述使用了数值分析领域中精确、客观和标准的术语。\n\n问题陈述内部一致、科学上合理且适定。未发现任何缺陷。\n\n### 第 3 步：结论与行动\n问题是 **有效的**。将推导解答。\n\n### 正确公差缩放的推导\n\n目标是确定非精确线性求解的公差 $\\tau$ 必须如何随时间步长 $\\Delta t$ 缩放，以确保时间积分方法的全局误差保持为 $\\mathcal{O}(\\Delta t^p)$。\n\n1.  **局部截断误差 (LTE)：** 一个全局阶为 $p$ 的 IMEX ARK 方法的局部截断误差为 $\\mathcal{O}(\\Delta t^{p+1})$ 阶。这是在假设一个时间步从 ODE 系统的精确解开始，并且所有阶段方程都得到精确求解的情况下，在该步中引入的误差。为了保持全局阶 $p$，在一个时间步内引入的任何额外误差在 $\\Delta t$ 上的阶数不能低于方法自身的 LTE。\n\n2.  **非精确隐式阶段的分析：** 让我们考虑 ARK 方法的一个通用隐式阶段 $i$。阶段方程的隐式部分可以写成：\n    $$(\\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}) \\mathbf{Y}_i = \\mathbf{b}_i$$\n    其中 $\\mathbf{Y}_i$ 是精确的阶段解向量，$\\mathbf{b}_i$ 包含了前一时间步和先前阶段的信息。令 $\\mathbf{A}_i := \\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}$。精确的阶段解是 $\\mathbf{Y}_i = \\mathbf{A}_i^{-1}\\mathbf{b}_i$。\n\n    迭代求解器计算一个近似的阶段解 $\\hat{\\mathbf{Y}}_i$。当残差 $\\mathbf{r}_i := \\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i$ 满足 $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$ 时，求解器终止。\n\n3.  **阶段解中的误差：** 由非精确求解引起的阶段解误差为 $\\mathbf{e}_i := \\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i$。我们可以将此误差与残差关联起来：\n    $$\\mathbf{A}_i \\mathbf{e}_i = \\mathbf{A}_i (\\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i) = (\\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i) - (\\mathbf{A}_i \\mathbf{Y}_i - \\mathbf{b}_i) = \\mathbf{r}_i - \\mathbf{0} = \\mathbf{r}_i$$\n    因此，阶段解误差为 $\\mathbf{e}_i = \\mathbf{A}_i^{-1} \\mathbf{r}_i$。\n\n4.  **对阶段解误差进行定界：** 使用由 $\\mathbf{M}$-内积诱导的范数，我们可以界定此误差的大小：\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} = \\|\\mathbf{A}_i^{-1} \\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\|\\mathbf{r}_i\\|_{\\mathbf{M}}$$\n    利用问题的已知条件 $\\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ 和 $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$，我们得到阶段误差的一个界：\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} \\le c_\\star \\tau$$\n    这表明每个阶段向量中的误差是 $\\mathcal{O}(\\tau)$ 阶的。\n\n5.  **对单步误差的贡献：** 阶段解中的误差 $\\mathbf{e}_i$ 会传播到该步的最终解更新中。新时间层上的解 $\\mathbf{u}_{n+1}$ 是通过旧时间层上的解 $\\mathbf{u}_n$ 与包含阶段值的项的线性组合来计算的：\n    $$\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t \\sum_{j=1}^s \\left( b_j^E \\mathbf{f}(\\mathbf{Y}_j) + b_j^I \\mathbf{L}\\mathbf{Y}_j \\right)$$\n    当使用非精确阶段解 $\\hat{\\mathbf{Y}}_j = \\mathbf{Y}_j + \\mathbf{e}_j$ 时，计算出的更新 $\\hat{\\mathbf{u}}_{n+1}$ 将与精确求解的更新 $\\mathbf{u}_{n+1}$ 不同。求解器在单步中引入的误差 $\\delta_{\\text{step}} := \\hat{\\mathbf{u}}_{n+1} - \\mathbf{u}_{n+1}$ 为：\n    $$\\delta_{\\text{step}} = \\Delta t \\sum_{j=1}^s \\left( b_j^E (\\mathbf{f}(\\hat{\\mathbf{Y}}_j) - \\mathbf{f}(\\mathbf{Y}_j)) + b_j^I \\mathbf{L}(\\hat{\\mathbf{Y}}_j - \\mathbf{Y}_j) \\right)$$\n    假设函数性质良好（例如，$\\mathbf{f}$ 是 Lipschitz 连续的），则求和号内的项与阶段误差 $\\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}}$ 的阶数相同。\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} \\approx \\mathcal{O}(\\Delta t \\cdot \\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}})$$\n    由于 $\\|\\mathbf{e}_j\\|_{\\mathbf{M}} = \\mathcal{O}(\\tau)$，非精确求解引入的局部误差为：\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} = \\mathcal{O}(\\Delta t \\cdot \\tau)$$\n\n6.  **匹配误差阶数：** 为了保持方法的全局阶 $p$，由非精确求解引起的局部误差最多必须与方法固有的局部截断误差同阶。\n    $$\\text{求解器引起的局部误差} \\le \\text{方法的局部截断误差}$$\n    $$\\mathcal{O}(\\Delta t \\cdot \\tau) \\le \\mathcal{O}(\\Delta t^{p+1})$$\n    为了在 $\\Delta t \\to 0$ 时成立，我们必须有：\n    $$\\tau = \\mathcal{O}(\\Delta t^p)$$\n    选择 $\\tau = C\\,\\Delta t^p$（对于某个常数 $C$）可以确保求解器引起的局部误差为 $\\mathcal{O}(\\Delta t^{p+1})$，这与方法的 LTE 阶数相匹配。这个选择是最佳的，因为它是保持精度阶所需的最不严格的 $\\tau$ 条件，从而避免了不必要的过求解。\n\n### 逐项分析\n\n**A. 选择 $\\tau = C\\,\\Delta t^{p}$（其中 $C$ 与 $\\Delta t$ 无关），作为对阶段残差在 $\\mathbf{M}$-范数下的绝对公差，从而使求解器引起的局部缺陷与方法的局部截断误差具有相同的渐近量级。**\n此建议与我们的推导完全一致。设置 $\\tau = C\\,\\Delta t^p$ 使得求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t^{p+1})$，这与方法的局部截断误差的阶数相同。这确保了全局阶 $p$ 得以保持，同时不会使公差变得不必要地严格。\n**结论：正确。**\n\n**B. 选择 $\\tau = C\\,\\Delta t^{p+1}$ 来直接匹配局部截断误差，因为阶段残差对单步误差的贡献没有额外乘以因子 $\\Delta t$。**\n$\\tau = C\\,\\Delta t^{p+1}$ 这一缩放关系过于严格。它会导致求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p+1}) = \\mathcal{O}(\\Delta t^{p+2})$，比所要求的阶数小了一阶。这会导致“过求解”和不必要的计算成本。其理由也是有缺陷的；如推导所示，阶段级误差对单步误差的贡献会因龙格-库塔更新公式而乘以一个因子 $\\Delta t$。\n**结论：不正确。**\n\n**C. 保持 $\\tau$ 与 $\\Delta t$ 无关以避免在小 $\\Delta t$ 下不必要的工作，因为隐式算子是 L-稳定的，并且会抑制源于刚性的误差。**\n如果 $\\tau = \\mathcal{O}(1)$（与 $\\Delta t$ 无关），则求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t)$。对于任何阶数 $p \\ge 1$ 的方法，其 LTE 为 $\\mathcal{O}(\\Delta t^{p+1})$，阶数高于 $\\mathcal{O}(\\Delta t)$。总的局部误差将被求解器误差主导，变为 $\\mathcal{O}(\\Delta t)$。在 $T/\\Delta t$ 步上累积的全局误差将为 $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t) = \\mathcal{O}(1)$，意味着当 $\\Delta t \\to 0$ 时完全不收敛。L-稳定性已在常数 $c_\\star$ 中被考虑，它并不能免除控制公差的需要。\n**结论：不正确。**\n\n**D. 选择 $\\tau = C\\,\\Delta t^{p-1}$，因为扩散刚性会以 $\\Delta t^{-1}$ 的量级放大阶段误差，这要求比标称的局部截断误差缩放更紧的阶段公差。**\n选择公差 $\\tau = C\\,\\Delta t^{p-1}$ 会导致求解器引起的局部误差为 $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p-1}) = \\mathcal{O}(\\Delta t^p)$。该误差将主导方法的 LTE $\\mathcal{O}(\\Delta t^{p+1})$。总的局部误差是 $\\mathcal{O}(\\Delta t^p)$，这会导致全局误差为 $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t^p) = \\mathcal{O}(\\Delta t^{p-1})$。方法的阶数从 $p$ 降至 $p-1$。其理由也是错误的：假设 $\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ 明确指出不存在 $\\Delta t^{-1}$ 的放大效应。这个假设是 L-稳定方法应用于耗散算子的直接结果。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}