{
    "hands_on_practices": [
        {
            "introduction": "Understanding a numerical method begins with assessing its accuracy. This first practice exercise guides you through a fundamental procedure: determining the order of a Diagonally Implicit Runge-Kutta (DIRK) scheme. By applying the method to a standard linear test equation, you will derive its stability function and compare its Taylor series expansion to that of the exact solution, a core skill for analyzing any time integration method .",
            "id": "3378828",
            "problem": "Consider a semi-discrete system obtained from a Discontinuous Galerkin (DG) spatial discretization of a linear hyperbolic conservation law on a periodic domain, which yields an autonomous linear system of ordinary differential equations (ODEs) of the form $\\,\\frac{d\\mathbf{y}}{dt}=\\mathbf{L}\\mathbf{y}\\,$ with constant matrix $\\,\\mathbf{L}\\,$. A common approach is to advance this system in time using a Diagonally Implicit Runge–Kutta (DIRK) method. For stability and stiffness considerations typical in spectral and Discontinuous Galerkin methods, consider the following singly diagonally implicit Runge–Kutta ($\\,\\text{SDIRK}\\,$) scheme with $\\,2\\,$ stages and a single parameter $\\,\\gamma>0\\,$:\n$$\n\\begin{array}{c|cc}\n\\gamma & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n & 1-\\gamma & \\gamma\n\\end{array}\n$$\nWhen this time integrator is applied to the linear test equation $\\,y'=\\lambda y\\,$, define the non-dimensional variable $\\,z=h\\lambda\\,$, where $\\,h\\,$ is the time step. The one-step update takes the form $\\,y_{n+1}=R(z)\\,y_n\\,$, where $\\,R(z)\\,$ is called the stability function. The order of accuracy $\\,p\\,$ of the method is characterized by the condition that the Taylor series of $\\,R(z)\\,$ matches that of $\\,\\exp(z)\\,$ about $\\,z=0\\,$ up to and including terms of order $\\,z^p\\,$, i.e., $\\,R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})\\,$.\n\nStarting from the stage equations and update formula that define this $\\,\\text{SDIRK}\\,$ method, derive $\\,R(z)\\,$ for the test equation $\\,y'=\\lambda y\\,$, expand it as a Taylor series about $\\,z=0\\,$, and determine the largest integer $\\,p\\,$ such that $\\,R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})\\,$. Express your final answer as a single integer $\\,p\\,$. No rounding is necessary.",
            "solution": "The semi-discrete system from a Discontinuous Galerkin (DG) discretization is linearized as $\\,\\frac{d\\mathbf{y}}{dt}=\\mathbf{L}\\mathbf{y}\\,$. To assess the time integration accuracy independently of the spatial discretization, one uses the linear test equation $\\,y'=\\lambda y\\,$, for which the exact solution satisfies $\\,y(t+h)=\\exp(h\\lambda)\\,y(t)\\,$. A Runge–Kutta method applied to $\\,y'=\\lambda y\\,$ yields a rational amplification (stability) function $\\,R(z)\\,$ such that $\\,y_{n+1}=R(z)\\,y_n\\,$ with $\\,z=h\\lambda\\,$. The order $\\,p\\,$ is characterized by matching $\\,R(z)\\,$ to $\\,\\exp(z)\\,$ up to $\\,\\mathcal{O}(z^{p+1})\\,$.\n\nFor the given singly diagonally implicit Runge–Kutta ($\\,\\text{SDIRK}\\,$) method with $\\,2\\,$ stages and parameter $\\,\\gamma>0\\,$,\n$$\n\\begin{array}{c|cc}\n\\gamma & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n & 1-\\gamma & \\gamma\n\\end{array}\n$$\nthe stage equations for $\\,y'=\\lambda y\\,$ with $\\,z=h\\lambda\\,$ are\n$$\nY_1 \\;=\\; y_n \\;+\\; z\\,\\gamma\\,Y_1,\\qquad\nY_2 \\;=\\; y_n \\;+\\; z\\Big[(1-\\gamma)\\,Y_1 \\;+\\; \\gamma\\,Y_2\\Big],\n$$\nand the update is\n$$\ny_{n+1} \\;=\\; y_n \\;+\\; z\\Big[(1-\\gamma)\\,Y_1 \\;+\\; \\gamma\\,Y_2\\Big].\n$$\nSolving the linear stage equations:\n$$\n(1 - z\\gamma)\\,Y_1 = y_n \\;\\;\\Longrightarrow\\;\\; Y_1 \\;=\\; \\frac{y_n}{1 - z\\gamma}.\n$$\nSimilarly,\n$$\n(1 - z\\gamma)\\,Y_2 \\;=\\; y_n \\;+\\; z(1-\\gamma)\\,Y_1\n\\;\\;\\Longrightarrow\\;\\;\nY_2 \\;=\\; \\frac{y_n + z(1-\\gamma)Y_1}{1 - z\\gamma}\n\\;=\\; y_n\\,\\frac{1 + z(1-\\gamma)/(1 - z\\gamma)}{1 - z\\gamma}.\n$$\nIt is convenient to denote $\\,D := 1 - z\\gamma\\,$. Then\n$$\nY_1 \\;=\\; \\frac{y_n}{D},\\qquad\nY_2 \\;=\\; \\frac{y_n + z(1-\\gamma)\\,y_n/D}{D}\n\\;=\\; y_n\\left(\\frac{1}{D} \\;+\\; \\frac{z(1-\\gamma)}{D^2}\\right)\n\\;=\\; y_n\\,\\frac{D + z(1-\\gamma)}{D^2}.\n$$\nSince $\\,D + z(1-\\gamma) = 1 - z\\gamma + z(1-\\gamma) = 1 + z(1 - 2\\gamma)\\,$, we have\n$$\nY_2 \\;=\\; y_n\\,\\frac{1 + z(1 - 2\\gamma)}{D^2}.\n$$\nThe update then gives the stability function $R(z) = y_{n+1}/y_n$:\n$$\nR(z)\n\\;=\\;\n1 \\;+\\; z\\Bigg[(1-\\gamma)\\,\\frac{Y_1}{y_n} \\;+\\; \\gamma\\,\\frac{Y_2}{y_n}\\Bigg]\n\\;=\\; 1 \\;+\\; z\\left[\\frac{1-\\gamma}{1 - z\\gamma} \\;+\\; \\gamma\\,\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\\right].\n$$\nTo determine the order, we expand $\\,R(z)\\,$ as a Taylor series about $\\,z=0\\,$. Using the geometric series expansion $\\frac{1}{1-x} = 1 + x + x^2 + \\dots$:\n$$\nR(z) = 1 + z\\left[ (1-\\gamma)(1+z\\gamma+z^2\\gamma^2) + \\gamma(1+z(1-2\\gamma))(1+2z\\gamma+3z^2\\gamma^2) \\right] + \\mathcal{O}(z^4)\n$$\nExpanding the term in the brackets gives:\n$$\n\\left[ \\dots \\right] = (1-\\gamma+\\gamma) + z(\\gamma(1-\\gamma)+\\gamma) + z^2(\\gamma^2(1-\\gamma) + \\gamma(2\\gamma(1-2\\gamma)+3\\gamma^2)) + \\mathcal{O}(z^3)\n$$\n$$\n\\left[ \\dots \\right] = 1 + z(2\\gamma-\\gamma^2) + z^2(3\\gamma^2-2\\gamma^3) + \\mathcal{O}(z^3)\n$$\nThus, the Taylor expansion of $\\,R(z)\\,$ is\n$$\nR(z) \\;=\\; 1 \\;+\\; z(1) \\;+\\; z^2(2\\gamma-\\gamma^2) \\;+\\; z^3(3\\gamma^2-2\\gamma^3) \\;+\\; \\mathcal{O}(z^4).\n$$\nWe compare this to the expansion of $\\,\\exp(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\mathcal{O}(z^4)\\,$ to find the order $p$.\n- Order 1: The coefficients of $z^1$ match ($1=1$), so the method is at least first order.\n- Order 2: We require the $z^2$ coefficients to match: $2\\gamma-\\gamma^2 = \\frac{1}{2}$, which is equivalent to $\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0$. This has solutions $\\gamma = 1 \\pm \\frac{1}{\\sqrt{2}}$. So, for these values of $\\gamma$, the method is at least second order.\n- Order 3: We would require $3\\gamma^2-2\\gamma^3 = \\frac{1}{6}$. If we substitute $\\gamma^2 = 2\\gamma - \\frac{1}{2}$ from the second-order condition, the coefficient becomes $3(2\\gamma-\\frac{1}{2}) - 2\\gamma(2\\gamma-\\frac{1}{2}) = 6\\gamma-\\frac{3}{2}-4\\gamma^2+ \\gamma = 7\\gamma - \\frac{3}{2} - 4(2\\gamma-\\frac{1}{2}) = 7\\gamma - \\frac{3}{2} - 8\\gamma + 2 = -\\gamma + \\frac{1}{2}$. For either solution for $\\gamma$, $-\\gamma+\\frac{1}{2} \\neq \\frac{1}{6}$.\n\nTherefore, the third-order condition cannot be satisfied. The largest integer $\\,p\\,$ such that $\\,R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})\\,$ is $\\,p=2\\,$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "Beyond basic accuracy, the true power of implicit methods lies in their stability, especially for stiff systems common in Discontinuous Galerkin (DG) discretizations. This exercise shifts the focus from analysis to design, challenging you to construct a specific L-stable Singly Diagonally Implicit Runge-Kutta (SDIRK) method. By enforcing conditions for second-order accuracy, stiff accuracy, and L-stability, you will determine the precise coefficients that give the method its desirable properties for stiff problems .",
            "id": "3378920",
            "problem": "A semi-discrete Discontinuous Galerkin (DG) spatial discretization of a linear diffusion operator on a bounded domain yields an ordinary differential equation of the form $\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{L}\\,\\boldsymbol{u}$, where $\\boldsymbol{L}$ has eigenvalues with large negative real parts due to the stiffness induced by the diffusive fluxes. Consider advancing this system in time using a two-stage Singly Diagonally Implicit Runge-Kutta (SDIRK) method with common diagonal coefficient $\\gamma$ and stiff accuracy, meaning that the last stage equals the step solution and the weights equal the last row of the Runge-Kutta matrix.\n\nLet the Butcher matrix be $\\boldsymbol{A} = \\begin{pmatrix}\\gamma & 0 \\\\ a_{21} & \\gamma\\end{pmatrix}$ with weights $\\boldsymbol{b} = \\begin{pmatrix}b_{1} \\\\ b_{2}\\end{pmatrix}$ satisfying stiff accuracy $\\boldsymbol{b}^{\\top} = \\begin{pmatrix}a_{21} & \\gamma\\end{pmatrix}$, and abscissae $\\boldsymbol{c} = \\begin{pmatrix}c_{1} \\\\ c_{2}\\end{pmatrix}$ given by $c_{i} = \\sum_{j} a_{ij}$. Assume the method is exactly second-order accurate.\n\nStarting from the scalar linear test equation $\\frac{\\mathrm{d} u}{\\mathrm{d} t} = \\lambda u$, define the stability function $R(z)$ with $z = h \\lambda$ by applying the two-stage SDIRK update with stiff accuracy. Impose the requirement of $L$-stability for stiff systems, taken here as the combination of $A$-stability (the region $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\le 0\\}$ is contained in the stability region $\\{z : |R(z)| \\le 1\\}$) and $\\lim_{|z|\\to\\infty} |R(z)| = 0$. Additionally require the abscissae to represent stage times within the step, $0 \\le c_{i} \\le 1$.\n\nDetermine the unique value of $\\gamma$ that satisfies stiff accuracy, second-order accuracy, and $L$-stability under the above constraints. Express your final answer as a closed-form analytic expression for $\\gamma$.",
            "solution": "We determine the unique value of the diagonal coefficient $\\gamma$ by imposing the given constraints on the two-stage SDIRK method.\n\nFirst, we establish the algebraic relations between the method's coefficients. The Butcher tableau has matrix $\\boldsymbol{A} = \\begin{pmatrix}\\gamma & 0 \\\\ a_{21} & \\gamma\\end{pmatrix}$ and weights $\\boldsymbol{b}$.\n-   The **stiff accuracy** condition sets the weights equal to the last row of $\\boldsymbol{A}$: $b_1 = a_{21}$ and $b_2 = \\gamma$.\n-   The **abscissae** $c_i$ are the row sums: $c_1 = \\gamma$ and $c_2 = a_{21} + \\gamma$.\n\nNext, we apply the order of accuracy conditions.\n-   The **first-order condition** is $\\sum b_i = 1$, which gives $a_{21} + \\gamma = 1$. This allows us to express $a_{21} = 1 - \\gamma$. It also fixes the second abscissa, $c_2 = (1 - \\gamma) + \\gamma = 1$.\n-   The **second-order condition** is $\\sum b_i c_i = \\frac{1}{2}$. Substituting the known coefficients gives:\n    $b_1 c_1 + b_2 c_2 = (a_{21})(\\gamma) + (\\gamma)(1) = (1 - \\gamma)\\gamma + \\gamma = \\frac{1}{2}$.\n    This simplifies to $2\\gamma - \\gamma^2 = \\frac{1}{2}$, which rearranges to the quadratic equation $\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0$.\n\nSolving for $\\gamma$ using the quadratic formula gives two solutions:\n$\\gamma = \\frac{2 \\pm \\sqrt{4 - 2}}{2} = 1 \\pm \\frac{\\sqrt{2}}{2}$.\n\nWe apply the constraint that the abscissae must be in the interval $[0, 1]$. Since $c_1 = \\gamma$, we must have $0 \\le \\gamma \\le 1$.\n-   The solution $\\gamma = 1 + \\frac{\\sqrt{2}}{2} \\approx 1.7071$ is rejected.\n-   The solution $\\gamma = 1 - \\frac{\\sqrt{2}}{2} \\approx 0.2929$ is accepted.\n\nFinally, we verify that this unique value of $\\gamma$ yields an $L$-stable method. For a two-stage SDIRK method with stiff accuracy, the stability function is $R(z) = \\frac{1 + z(1-2\\gamma)}{(1-\\gamma z)^2}$.\nWe check the two conditions for $L$-stability:\n1.  **Asymptotic behavior**: We need $\\lim_{|z|\\to\\infty} |R(z)| = 0$. Since the degree of the numerator (1) is less than the degree of the denominator (2), and $\\gamma \\ne 0$, this condition is met.\n2.  **A-stability**: We need $|R(z)| \\le 1$ for all $z$ with $\\operatorname{Re}(z) \\le 0$. It is sufficient to check this on the imaginary axis, $z=iy$. The condition $|R(iy)|^2 \\le 1$ simplifies to $2\\gamma^2 - 4\\gamma + 1 \\le 0$. Our chosen value $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ is a root of the quadratic polynomial $2\\gamma^2 - 4\\gamma + 1$, so the expression evaluates to $0$. The condition $0 \\le 0$ is satisfied.\n\nSince both conditions for L-stability are met, the unique value of $\\gamma$ satisfying all constraints is $1 - \\frac{\\sqrt{2}}{2}$.",
            "answer": "$$\\boxed{1 - \\frac{\\sqrt{2}}{2}}$$"
        },
        {
            "introduction": "A deep understanding of numerical stability requires exploring not only when methods work, but also how they can fail. This final practice delves into the concept of algebraic stability, a crucial property for ensuring a method's contractivity. You will analyze a DIRK scheme that violates this condition and observe the concrete consequence: a loss of contractivity even for a simple dissipative problem, a critical insight into the subtleties of designing robust numerical schemes .",
            "id": "3378945",
            "problem": "Consider the semi-discrete ordinary differential equation obtained from a Discontinuous Galerkin (DG) spatial discretization of a linear convection–diffusion operator, which under standard upwind numerical fluxes and appropriate spectral filtering has a matrix generator with spectrum in the closed left half-plane. For the scalar test equation, this reduces to the linear model problem $u'(t)=\\lambda u(t)$ with $\\operatorname{Re}(\\lambda)\\le 0$. Time integration is performed using a Diagonally Implicit Runge-Kutta (DIRK) method with Butcher tableau\n$$\n\\begin{array}{c|cc}\na & a & 0 \\\\\na+c & c & a \\\\\n\\hline\n & b_1 & b_2\n\\end{array}\n$$\nwhere $A=\\begin{pmatrix} a & 0 \\\\ c & a \\end{pmatrix}$ is lower triangular with identical diagonal entries, and $b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$. Let a specific choice be $a=\\frac{1}{2}$, $c=3$, $b_1=0$, and $b_2=1$, so the stage abscissae are $c_1=a$ and $c_2=a+c$. \n\nStarting from the core definitions of Runge-Kutta methods and algebraic stability, do the following:\n- Explain the notion of algebraic stability via the symmetric matrix condition $M=B A + A^{\\top} B - b b^{\\top}$, where $B=\\operatorname{diag}(b_1,b_2)$, and show that the given DIRK tableau violates algebraic stability.\n- For the linear test equation $u'=\\lambda u$, define the Runge-Kutta stability function $R(z)$ by the amplification relation $u^{n+1}=R(z)\\,u^n$ with $z=h\\lambda$, and derive $R(z)$ symbolically for the given DIRK tableau in terms of $z$.\n- Use $R(z)$ to predict the loss of contractivity along the negative real axis by evaluating the amplification factor at $z=-2$ and determining $|R(-2)|$.\n\nProvide the value of $|R(-2)|$ as an exact number without rounding. No physical units are required.",
            "solution": "We first recall fundamental properties of Runge-Kutta (RK) methods relevant to contractivity and algebraic stability. A RK method with coefficient matrix $A\\in\\mathbb{R}^{s\\times s}$ and weights $b\\in\\mathbb{R}^s$ is algebraically stable if $b_i\\ge 0$ for all $i$ and the symmetric matrix\n$$\nM \\equiv B A + A^{\\top} B - b b^{\\top}, \\quad B=\\operatorname{diag}(b_1,\\dots,b_s),\n$$\nis positive semidefinite. For a $2$-stage DIRK with\n$$\nA=\\begin{pmatrix} a & 0 \\\\ c & a \\end{pmatrix}, \\quad b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix},\n$$\nwe compute $M$ explicitly for the given numerical values $a=\\frac{1}{2}$, $c=3$, $b_1=0$, $b_2=1$. \n\nCompute $B A$ by left-multiplying $A$ with $B=\\operatorname{diag}(0,1)$, which scales the rows:\n$$\nB A = \\begin{pmatrix} 0 & 0 \\\\ 3 & \\frac{1}{2} \\end{pmatrix}.\n$$\nCompute $A^{\\top} B$ by right-multiplying $A^{\\top}$ with $B$, which scales the columns. Since\n$$\nA^{\\top}=\\begin{pmatrix} \\frac{1}{2} & 3 \\\\ 0 & \\frac{1}{2} \\end{pmatrix},\n$$\nwe have\n$$\nA^{\\top} B = \\begin{pmatrix} \\frac{1}{2}\\cdot 0 & 3\\cdot 1 \\\\ 0\\cdot 0 & \\frac{1}{2}\\cdot 1 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 3 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}.\n$$\nFinally, \n$$\nb b^{\\top} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\begin{pmatrix} 0 & 1 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\nTherefore,\n$$\nM = B A + A^{\\top} B - b b^{\\top}\n= \\begin{pmatrix} 0 & 0 \\\\ 3 & \\frac{1}{2} \\end{pmatrix}\n+ \\begin{pmatrix} 0 & 3 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}\n- \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 3 \\\\ 3 & 0 \\end{pmatrix}.\n$$\nThe eigenvalues of $M$ are the roots of the characteristic polynomial $\\det(M-\\mu I)=\\mu^2-9$, hence $\\mu=\\pm 3$. Since $M$ has a negative eigenvalue, $M$ is not positive semidefinite, and the DIRK tableau violates algebraic stability. This violation implies that, even for dissipative linear problems (such as semi-discrete DG systems with $\\operatorname{Re}(\\lambda)\\le 0$), contractivity can be lost for some step sizes.\n\nNext, we derive the Runge-Kutta stability function $R(z)$ for the linear test equation $u'=\\lambda u$ with $z=h\\lambda$. For a general RK method, the amplification factor is given by the formula\n$$\nR(z) = 1 + z\\, b^{\\top} (I - z A)^{-1} e,\n$$\nwhere $e=(1,\\dots,1)^{\\top}$. For our $2$-stage DIRK, $e=\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and\n$$\nI - z A = \\begin{pmatrix} 1 - z a & 0 \\\\ - z c & 1 - z a \\end{pmatrix}.\n$$\nLet $\\alpha \\equiv 1 - z a$. The inverse is\n$$\n(I - z A)^{-1} = \\frac{1}{\\alpha^2} \\begin{pmatrix} \\alpha & 0 \\\\ z c & \\alpha \\end{pmatrix}.\n$$\nTherefore,\n$$\n(I - z A)^{-1} e = \\frac{1}{\\alpha^2} \\begin{pmatrix} \\alpha \\\\ z c + \\alpha \\end{pmatrix}.\n$$\nWith $b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$, we have\n$$\nb^{\\top} (I - z A)^{-1} e\n= \\frac{1}{\\alpha^2} \\left( b_1 \\alpha + b_2(z c + \\alpha) \\right)\n= \\frac{(b_1 + b_2)\\alpha + b_2 z c}{\\alpha^2}.\n$$\nSubstituting into $R(z)$ gives the symbolic form\n$$\nR(z) = 1 + z\\, \\frac{(b_1 + b_2)(1-za) + b_2 z c}{(1-za)^2} = 1 + z\\, \\frac{b_1 + b_2}{1 - z a} + b_2\\, c\\, \\frac{z^{2}}{(1 - z a)^{2}}.\n$$\nFor our specific coefficients $a=\\frac{1}{2}$, $c=3$, $b_1=0$, $b_2=1$, the stability function reduces to\n$$\nR(z) = 1 + \\frac{z}{1 - \\frac{z}{2}} + \\frac{3 z^{2}}{\\left(1 - \\frac{z}{2}\\right)^{2}}.\n$$\nTo quantify the loss of contractivity along the negative real axis, we evaluate at $z=-2$. Then $1 - \\frac{z}{2}=1 - \\left( -1 \\right)=2$, so\n$$\nR(-2) = 1 + \\frac{-2}{2} + \\frac{3\\cdot (-2)^{2}}{2^{2}}\n= 1 - 1 + \\frac{3\\cdot 4}{4}\n= 0 + 3\n= 3.\n$$\nHence $|R(-2)|=3$, which is strictly greater than $1$. This demonstrates the loss of contractivity: for a dissipative mode with $z=-2$, the method amplifies the solution by a factor of $3$ in one time step, consistent with the violation of algebraic stability found above.",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}