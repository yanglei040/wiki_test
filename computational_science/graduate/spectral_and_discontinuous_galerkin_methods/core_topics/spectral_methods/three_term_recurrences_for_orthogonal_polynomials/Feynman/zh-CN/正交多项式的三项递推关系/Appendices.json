{
    "hands_on_practices": [
        {
            "introduction": "三项递推关系不仅适用于经典的连续正交多项式，也可以为离散数据集构建。这个练习将演示如何根据一组离散的数据点，通过一个基本过程来生成相应的递推系数，这是数据拟合和数值方法中的一个核心计算任务。通过这个具体的计算 ，你将亲手实践从数据中提取代数结构的过程。",
            "id": "2192741",
            "problem": "在实验数据的数值分析中，使用一个关于数据点正交的函数基通常是有利的。考虑在坐标 $\\{x_i\\} = \\{0, 1, 3, 6\\}$ 处的一组四个实验测量值。我们感兴趣的是生成一个关于离散内积正交的首一多项式序列 $\\{p_k(x)\\}_{k=0}^\\infty$。\n\n在这个点集上，两个实值函数 $f(x)$ 和 $g(x)$ 的内积定义为：\n$$ \\langle f, g \\rangle = \\sum_{i=1}^{4} f(x_i) g(x_i) $$\n该正交首一多项式序列由三项递推关系生成：\n$$ p_{k+1}(x) = (x - \\alpha_k) p_k(x) - \\beta_k p_{k-1}(x) $$\n对于 $k \\ge 0$，初始条件定义为 $p_0(x) = 1$ 和 $p_{-1}(x) = 0$。\n\n你的任务是确定递推系数 $\\alpha_1$ 的精确值。请将最终答案表示为最简分数形式。",
            "solution": "我们使用给定的离散内积\n$$\\langle f, g \\rangle = \\sum_{i=1}^{4} f(x_{i}) g(x_{i}), \\quad \\{x_{i}\\}=\\{0,1,3,6\\},$$\n以及首一三项递推关系\n$$p_{k+1}(x)=(x-\\alpha_{k})p_{k}(x)-\\beta_{k}p_{k-1}(x), \\quad p_{0}(x)=1,\\; p_{-1}(x)=0.$$\n\n对于首一正交多项式，将递推关系与 $p_{k}$ 作内积可得\n$$\\langle p_{k+1},p_{k}\\rangle=\\langle (x-\\alpha_{k})p_{k},p_{k}\\rangle-\\beta_{k}\\langle p_{k-1},p_{k}\\rangle.$$\n根据正交性，$\\langle p_{k+1},p_{k}\\rangle=0$ 且 $\\langle p_{k-1},p_{k}\\rangle=0$，因此\n$$0=\\langle x p_{k},p_{k}\\rangle-\\alpha_{k}\\langle p_{k},p_{k}\\rangle,$$\n所以\n$$\\alpha_{k}=\\frac{\\langle x p_{k},p_{k}\\rangle}{\\langle p_{k},p_{k}\\rangle}.$$\n\n首先，计算 $\\alpha_{0}$：\n$$\\alpha_{0}=\\frac{\\langle x p_{0},p_{0}\\rangle}{\\langle p_{0},p_{0}\\rangle}\n=\\frac{\\sum_{i=1}^{4} x_{i}}{\\sum_{i=1}^{4} 1}\n=\\frac{0+1+3+6}{4}\n=\\frac{10}{4}\n=\\frac{5}{2}.$$\n因此\n$$p_{1}(x)=x-\\alpha_{0}=x-\\frac{5}{2}.$$\n\n现在使用以下公式计算 $\\alpha_{1}$\n$$\\alpha_{1}=\\frac{\\langle x p_{1},p_{1}\\rangle}{\\langle p_{1},p_{1}\\rangle}\n=\\frac{\\sum_{i=1}^{4} x_{i}\\,p_{1}(x_{i})^{2}}{\\sum_{i=1}^{4} p_{1}(x_{i})^{2}}.$$\n在数据点处计算 $p_{1}(x)$ 的值：\n$$p_{1}(0)=-\\frac{5}{2},\\quad p_{1}(1)=-\\frac{3}{2},\\quad p_{1}(3)=\\frac{1}{2},\\quad p_{1}(6)=\\frac{7}{2}.$$\n平方：\n$$p_{1}(0)^{2}=\\frac{25}{4},\\quad p_{1}(1)^{2}=\\frac{9}{4},\\quad p_{1}(3)^{2}=\\frac{1}{4},\\quad p_{1}(6)^{2}=\\frac{49}{4}.$$\n分母：\n$$\\langle p_{1},p_{1}\\rangle=\\frac{25}{4}+\\frac{9}{4}+\\frac{1}{4}+\\frac{49}{4}=\\frac{84}{4}=21.$$\n分子：\n$$\\langle x p_{1},p_{1}\\rangle=0\\cdot\\frac{25}{4}+1\\cdot\\frac{9}{4}+3\\cdot\\frac{1}{4}+6\\cdot\\frac{294}{4}\n=\\frac{9}{4}+\\frac{3}{4}+\\frac{294}{4}=\\frac{306}{4}=\\frac{153}{2}.$$\n因此\n$$\\alpha_{1}=\\frac{\\frac{153}{2}}{21}=\\frac{153}{42}=\\frac{51}{14}.$$\n这个分数已经是最简形式。",
            "answer": "$$\\boxed{\\frac{51}{14}}$$"
        },
        {
            "introduction": "从离散构造转向连续情况，我们会发现经典正交多项式的递推系数具有优美的封闭形式。本练习  将引导你为重要的勒让德多项式（Legendre polynomials）进行严格的推导，从而将递推关系与罗德里格斯公式（Rodrigues formula）和正交性等基本性质联系起来。这个过程不仅能加深你对理论的理解，还能锻炼你处理复杂数学推导的能力。",
            "id": "3423659",
            "problem": "考虑在区间 $[-1,1]$ 上，权重函数为 $w(x)=1$ 的勒让德多项式族 $\\{P_n(x)\\}_{n=0}^{\\infty}$。仅使用正交多项式的基本定义和性质来完成以下任务。\n\n1. 从罗德里格斯公式 $P_n(x)=\\dfrac{1}{2^n n!}\\dfrac{d^n}{dx^n}\\left(x^2-1\\right)^n$ 以及 $\\{P_n\\}$ 关于内积 $\\langle f,g\\rangle=\\int_{-1}^{1}f(x)g(x)\\,dx$ 是正交的这一事实出发，推导一个三项递推关系，该关系将 $P_{n+1}(x)$ 表示为 $xP_n(x)$ 和 $P_{n-1}(x)$ 的线性组合，对所有整数 $n \\ge 1$ 成立。不要使用任何已有的递推关系；您的推导必须从罗德里格斯公式和所述的正交结构出发。\n\n2. 定义首一勒让德多项式 $\\{p_n(x)\\}_{n=0}^{\\infty}$ 为 $p_n(x)=\\kappa_n P_n(x)$，其中 $\\kappa_n$ 的选择使得 $p_n(x)$ 的首项系数为 $1$。显式地确定 $\\kappa_n$。\n\n3. 将第 1 部分的递推关系重写为首一形式 $p_{n+1}(x)=\\left(x-\\alpha_n\\right)p_n(x)-\\beta_n p_{n-1}(x)$，并将递推系数 $\\alpha_n$ 和 $\\beta_n$ 确定为关于 $n$ 的闭式解析表达式。\n\n将您关于有序对 $(\\alpha_n,\\beta_n)$ 的最终答案表示为单行矩阵。不需要数值近似。",
            "solution": "解答按照题目要求分为三个部分呈现。\n\n**第 1 部分：$P_n(x)$ 的三项递推关系**\n\n由于 $xP_n(x)$ 是一个 $n+1$ 次多项式，它可以写成勒让德多项式的线性组合。基于正交性，该展开式只包含三项：\n$$xP_n(x) = c_{n+1}P_{n+1}(x) + c_n P_n(x) + c_{n-1}P_{n-1}(x)$$\n由于勒让德多项式在对称区间 $[-1,1]$ 上定义且权函数为 1，函数 $x[P_n(x)]^2$ 是奇函数，其积分为零。因此，$c_n = \\frac{\\langle xP_n, P_n \\rangle}{\\langle P_n, P_n \\rangle} = 0$。\n递推关系简化为 $xP_n(x) = c_{n+1}P_{n+1}(x) + c_{n-1}P_{n-1}(x)$。\n为了确定系数，我们首先从罗德里格斯公式计算 $P_n(x)$ 的首项系数 $k_n$。$(x^2-1)^n$ 的最高次项是 $x^{2n}$。其 $n$ 阶导数是 $\\frac{(2n)!}{n!}x^n$。因此，\n$$k_n = \\frac{1}{2^n n!} \\frac{(2n)!}{n!} = \\frac{(2n)!}{2^n (n!)^2}$$\n比较 $xP_n(x)$ 关系式两边的首项系数，我们得到 $k_n = c_{n+1}k_{n+1}$，所以 $c_{n+1} = \\frac{k_n}{k_{n+1}} = \\frac{(n+1)}{2n+1}$。\n同样，考虑 $xP_{n-1}(x)$，其首项系数为 $k_{n-1}$。在 $P_k$ 基下的展开式为 $xP_{n-1}(x) = \\frac{k_{n-1}}{k_n}P_n(x) + \\dots$。利用内积的对称性：\n$$ c_{n-1} = \\frac{\\langle xP_n, P_{n-1} \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle} = \\frac{\\langle P_n, xP_{n-1} \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle} = \\frac{\\langle P_n, \\frac{k_{n-1}}{k_n}P_n + \\dots \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle} = \\frac{k_{n-1}}{k_n}\\frac{\\langle P_n, P_n \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle} $$\n使用标准范数结果 $\\langle P_n, P_n \\rangle = \\frac{2}{2n+1}$ 和 $k_{n-1}/k_n = n/(2n-1)$，我们得到 $c_{n-1} = \\frac{n}{2n-1} \\frac{2/(2n+1)}{2/(2n-1)} = \\frac{n}{2n+1}$。\n因此，标准勒让德多项式的递推关系是 $(2n+1)xP_n(x) = (n+1)P_{n+1}(x) + nP_{n-1}(x)$。\n\n**第 2 部分：首一化常数 $\\kappa_n$**\n\n首一多项式 $p_n(x)$ 的首项系数为 1。由于 $p_n(x) = \\kappa_n P_n(x)$，我们必须有 $\\kappa_n k_n = 1$。因此，\n$$\\kappa_n = \\frac{1}{k_n} = \\frac{2^n (n!)^2}{(2n)!}$$\n\n**第 3 部分：首一多项式的递推系数 $(\\alpha_n, \\beta_n)$**\n\n将 $P_n(x) = p_n(x)/\\kappa_n$ 代入第 1 部分的递推关系：\n$$(2n+1)x\\frac{p_n(x)}{\\kappa_n} = (n+1)\\frac{p_{n+1}(x)}{\\kappa_{n+1}} + n\\frac{p_{n-1}(x)}{\\kappa_{n-1}}$$\n求解 $p_{n+1}(x)$：\n$$p_{n+1}(x) = \\frac{\\kappa_{n+1}(2n+1)}{\\kappa_n(n+1)}x p_n(x) - \\frac{\\kappa_{n+1}n}{\\kappa_{n-1}(n+1)}p_{n-1}(x)$$\n$x p_n(x)$ 的系数是 $\\frac{k_n}{k_{n+1}}\\frac{2n+1}{n+1} = \\frac{n+1}{2n+1}\\frac{2n+1}{n+1}=1$。\n因此，递推关系的形式为 $p_{n+1}(x) = x p_n(x) - \\beta_n p_{n-1}(x)$，这表明 $\\alpha_n = 0$。\n$p_{n-1}(x)$ 的系数是：\n$$\\beta_n = \\frac{\\kappa_{n+1}n}{\\kappa_{n-1}(n+1)} = \\frac{k_{n-1}}{k_{n+1}}\\frac{n}{n+1} = \\left(\\frac{k_{n-1}}{k_n}\\right)\\left(\\frac{k_n}{k_{n+1}}\\right)\\frac{n}{n+1}$$\n代入我们之前计算的比率：\n$$\\beta_n = \\left(\\frac{n}{2n-1}\\right)\\left(\\frac{n+1}{2n+1}\\right)\\frac{n}{n+1} = \\frac{n^2}{(2n-1)(2n+1)} = \\frac{n^2}{4n^2-1}$$\n因此，有序对是 $(\\alpha_n, \\beta_n) = \\left(0, \\frac{n^2}{4n^2-1}\\right)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  \\frac{n^2}{4n^2-1} \\end{pmatrix} } $$"
        },
        {
            "introduction": "正交多项式的理论结构能够催生出高效的数值算法，体现了其在现代科学计算中的实用价值。本练习  将探索与三项递推密切相关的克里斯托费尔-达布核（Christoffel-Darboux kernel）如何帮助我们快速更新p自适应谱方法和间断伽辽金方法中的求积权重。掌握这种技巧，你将明白理论如何转化为避免重复计算、提升算法效率的实用工具。",
            "id": "3423649",
            "problem": "考虑一个坐标为 $x \\in [-1,1]$ 的参考单元和一个严格正的权函数 $\\rho(x)$，该函数定义了内积 $(f,g)_{\\rho} = \\int_{-1}^{1} f(x) g(x) \\rho(x)\\,dx$。设 $\\{\\phi_{n}\\}_{n \\ge 0}$ 是关于 $\\rho(x)$ 的标准正交多项式族，即 $(\\phi_{m},\\phi_{n})_{\\rho} = \\delta_{mn}$，它们满足三项递推关系\n$$\nx\\,\\phi_{n}(x) \\;=\\; a_{n+1}\\,\\phi_{n+1}(x) \\;+\\; b_{n}\\,\\phi_{n}(x) \\;+\\; a_{n}\\,\\phi_{n-1}(x),\n$$\n其中对所有 $n \\ge 1$ 都有 $a_{n} > 0$，并约定 $\\phi_{-1}(x) \\equiv 0$。\n\n一个间断 Galerkin (DG) 单元使用 $p$ 次的模态表示 $u_{p}(x) = \\sum_{n=0}^{p} c_{n}\\,\\phi_{n}(x)$，并通过在具有权重 $\\{w_{i}^{(p)}\\}_{i=1}^{M}$ 的固定节点 $\\{x_{i}\\}_{i=1}^{M}$ 上的离散内积来近似 $L^{2}$ 内积。假设权重被选为 Christoffel 型权重\n$$\nw_{i}^{(p)} \\;=\\; \\frac{1}{K_{p}(x_{i})}, \n\\qquad \nK_{p}(x) \\;=\\; \\sum_{k=0}^{p} \\phi_{k}(x)^{2},\n$$\n使得对于最高 $p$ 次的多项式，该离散内积与连续内积的结果一致。\n\n你希望执行一个从 $p$ 次到 $p+1$ 次的 $p$ 自适应加密，同时：\n- 基于已有的 $\\phi_{p}(x_{i})$ 和 $\\phi_{p-1}(x_{i})$，通过对三项递推关系进行一次扫描来更新 $\\phi_{p+1}(x_{i})$ 的求值，以及\n- 将求积权重 $\\{w_{i}^{(p)}\\}$ 更新为 $\\{w_{i}^{(p+1)}\\}$ 而无需从头重新计算。\n\n仅从三项递推关系、标准正交性以及 $K_{p}(x)$ 的定义出发，推导更新后权重 $w_{i}^{(p+1)}$ 的一个闭式表达式，该表达式仅用 $w_{i}^{(p)}$ 和 $\\phi_{p+1}(x_{i})$ 表示，并对每个节点 $x_{i}$ 有效。\n\n你的最终答案必须是 $w_{i}^{(p+1)}$ 关于 $w_{i}^{(p)}$ 和 $\\phi_{p+1}(x_{i})$ 的单个解析表达式。无需进行数值计算。",
            "solution": "我们的目标是找到 $w_{i}^{(p+1)}$ 的表达式。根据所提供的定义，对于给定的多项式次数 $p$，关键定义如下：\n1.  核函数 $K_{p}(x)$ 定义为：\n    $$K_{p}(x) = \\sum_{k=0}^{p} \\phi_{k}(x)^{2}$$\n2.  Christoffel 型求积权重 $w_{i}^{(p)}$ 定义为：\n    $$w_{i}^{(p)} = \\frac{1}{K_{p}(x_{i})}$$\n\n在 $p$ 自适应加密中，近似次数从 $p$ 增加到 $p+1$。根据定义，$p+1$ 次的权重为：\n$$w_{i}^{(p+1)} = \\frac{1}{K_{p+1}(x_{i})}$$\n\n$p+1$ 次的核函数 $K_{p+1}(x)$ 可以通过其定义展开：\n$$K_{p+1}(x) = \\sum_{k=0}^{p+1} \\phi_{k}(x)^{2}$$\n\n我们可以分解这个和式，以建立 $K_{p+1}(x)$ 与 $K_{p}(x)$ 的关系。通过分离出求和的最后一项，我们得到：\n$$K_{p+1}(x) = \\left(\\sum_{k=0}^{p} \\phi_{k}(x)^{2}\\right) + \\phi_{p+1}(x)^{2}$$\n\n根据定义，括号中的表达式正是 $p$ 次的核函数 $K_{p}(x)$。因此，我们得到了核函数的一个简单递推关系：\n$$K_{p+1}(x) = K_{p}(x) + \\phi_{p+1}(x)^{2}$$\n\n这个关系对每个求积节点 $x_i$ 均成立：\n$$K_{p+1}(x_{i}) = K_{p}(x_{i}) + \\phi_{p+1}(x_{i})^{2}$$\n\n现在我们可以将权重的定义代入此方程。从定义 $w_{i}^{(p)} = 1/K_{p}(x_i)$，我们有以下逆关系：\n$$K_{p}(x_i) = \\frac{1}{w_{i}^{(p)}}$$\n和\n$$K_{p+1}(x_i) = \\frac{1}{w_{i}^{(p+1)}}$$\n\n将这两个表达式代入核函数的递推关系中，得到：\n$$\\frac{1}{w_{i}^{(p+1)}} = \\frac{1}{w_{i}^{(p)}} + \\phi_{p+1}(x_{i})^{2}$$\n\n这个方程将新权重的倒数与旧权重的倒数以及新基函数的值联系起来。为了找到 $w_{i}^{(p+1)}$ 的最终表达式，我们对其进行求解。首先通过通分来合并右侧的项：\n$$\\frac{1}{w_{i}^{(p+1)}} = \\frac{1 + w_{i}^{(p)} \\phi_{p+1}(x_{i})^{2}}{w_{i}^{(p)}}$$\n\n最后，对等式两边取倒数，便得到更新后权重的所需闭式表达式：\n$$w_{i}^{(p+1)} = \\frac{w_{i}^{(p)}}{1 + w_{i}^{(p)} \\phi_{p+1}(x_{i})^{2}}$$\n\n该表达式提供了一个高效的更新规则，完全符合 $p$ 自适应加密过程的目标。",
            "answer": "$$\n\\boxed{\\frac{w_{i}^{(p)}}{1 + w_{i}^{(p)} \\phi_{p+1}(x_{i})^{2}}}\n$$"
        }
    ]
}