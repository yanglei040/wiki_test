{
    "hands_on_practices": [
        {
            "introduction": "谱方法的一个核心优势是其高精度特性，尤其是在微分运算中。本练习旨在揭示谱配置法中微分矩阵的精确性，阐明其不仅仅是一种近似，而是在特定节点上对多项式函数进行精确求导的工具。通过这个实践，你将亲身体会到勒让德多项式的性质与高斯-洛巴托节点的选择之间深刻的内在联系，这是理解谱方法威力的关键一步。",
            "id": "3395725",
            "problem": "考虑一个一维谱配置法场景，在参考区间 $[-1,1]$上，使用多项式次数为 $N=5$ 的勒让德-高斯-洛巴托节点。令 $x_0=-1$，$x_5=1$，且 $x_1,x_2,x_3,x_4\\in(-1,1)$ 为四个内部节点，定义为勒让德多项式 $P_5(x)$ 导数的不同根，即对于 $j=1,2,3,4$，有 $P_5'(x_j)=0$。令 $\\{\\ell_j(x)\\}_{j=0}^{5}$ 表示与这些节点相关的拉格朗日基函数，使得 $\\ell_j(x_i)=\\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ。定义微分矩阵 $D\\in\\mathbb{R}^{6\\times 6}$，其元素为 $D_{ij}=\\ell_j'(x_i)$。\n\n设函数为 $u(x)=P_5(x)$，其中 $P_n(x)$ 表示 $n$ 次勒让德多项式，由罗德里格斯公式 $P_n(x)=\\frac{1}{2^n n!}\\frac{d^n}{dx^n}\\left(x^2-1\\right)^n$ 定义，并满足三项递推关系 $(n+1)P_{n+1}(x)=(2n+1)xP_n(x)-nP_{n-1}(x)$，其中 $P_0(x)=1$ 和 $P_1(x)=x$。\n\n仅使用上述定义，计算精确的节点导数向量 $D\\,\\boldsymbol{u}$，其中 $\\boldsymbol{u}=\\big(u(x_0),u(x_1),u(x_2),u(x_3),u(x_4),u(x_5)\\big)^{\\top}$，并验证其与在节点处求值的解析导数 $\\big(u'(x_0),u'(x_1),u'(x_2),u'(x_3),u'(x_4),u'(x_5)\\big)^{\\top}$ 一致。将你的最终答案以单个行矩阵的形式给出，列出按节点递增顺序 $x_0  x_1  x_2  x_3  x_4  x_5$ 排列的导数值。",
            "solution": "该问题要求在多项式次数为 $N=5$ 的勒让德-高斯-洛巴托 (LGL) 节点上，计算函数 $u(x) = P_5(x)$ 的节点导数向量 $D\\boldsymbol{u}$。然后，我们必须验证该结果与在相同节点上求值的解析导数 $u'(x)$ 的向量相匹配。\n\n首先，让我们确定关键实体。函数为 $u(x) = P_5(x)$，其中 $P_5(x)$ 是 $5$ 次勒让德多项式。节点集 $\\{x_j\\}_{j=0}^{5}$ 是 $N=5$ 的LGL节点，包括端点 $x_0=-1$ 和 $x_5=1$，以及内部节点 $\\{x_j\\}_{j=1}^{4}$，这些内部节点是勒让德多项式 $P_5(x)$ 导数的根，即对于 $j=1,2,3,4$，有 $P_5'(x_j)=0$。\n\n向量 $\\boldsymbol{u}$ 表示函数在这些节点处的值：$\\boldsymbol{u} = (u(x_0), u(x_1), u(x_2), u(x_3), u(x_4), u(x_5))^{\\top}$。\n拉格朗日基函数 $\\{\\ell_j(x)\\}_{j=0}^{5}$ 是次数为 $5$ 的多项式，满足属性 $\\ell_j(x_i) = \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ。微分矩阵 $D$ 由其元素 $D_{ij} = \\ell_j'(x_i)$ 定义。\n\n乘积 $D\\boldsymbol{u}$ 产生一个列向量，其中第 $i$ 个条目由下式给出：\n$$ (D\\boldsymbol{u})_i = \\sum_{j=0}^{5} D_{ij} u_j = \\sum_{j=0}^{5} \\ell_j'(x_i) u(x_j) $$\n\n让我们考虑穿过 $N+1=6$ 个节点 $\\{x_j\\}_{j=0}^5$ 的 $u(x)$ 的多项式插值。这个插值多项式，我们称之为 $p(x)$，可以用拉格朗日形式写成：\n$$ p(x) = \\sum_{j=0}^{5} u(x_j) \\ell_j(x) $$\n由于函数 $u(x)=P_5(x)$ 是一个 $5$ 次多项式，并且我们使用了 $6$ 个不同的节点，因此次数最多为 $5$ 的唯一多项式插值就是函数 $u(x)$ 本身。因此，我们有恒等式：\n$$ u(x) = p(x) = \\sum_{j=0}^{5} u(x_j) \\ell_j(x) $$\n对这个精确表示关于 $x$求导，得到：\n$$ u'(x) = p'(x) = \\frac{d}{dx} \\left( \\sum_{j=0}^{5} u(x_j) \\ell_j(x) \\right) = \\sum_{j=0}^{5} u(x_j) \\ell_j'(x) $$\n现在，我们在每个LGL节点 $x_i$ 处计算这个导数：\n$$ u'(x_i) = \\sum_{j=0}^{5} u(x_j) \\ell_j'(x_i) $$\n将此表达式与 $D\\boldsymbol{u}$ 的第 $i$ 个分量的定义进行比较，我们发现它们是相同的：\n$$ (D\\boldsymbol{u})_i = u'(x_i) $$\n这表明对于次数最高为 $N$ 的多项式，谱配置微分过程是精确的。因此，计算向量 $D\\boldsymbol{u}$ 等价于计算在节点处的解析导数值向量 $(u'(x_0), u'(x_1), u'(x_2), u'(x_3), u'(x_4), u'(x_5))^{\\top}$。这就构成了所要求的验证。\n\n现在我们来计算这些值。函数为 $u(x)=P_5(x)$，所以其导数为 $u'(x)=P_5'(x)$。我们需要在LGL节点 $\\{x_j\\}_{j=0}^5$ 处计算 $P_5'(x)$ 的值。\n\n对于内部节点 $x_1, x_2, x_3, x_4$，它们被定义为 $P_5'(x)$ 的根。因此，根据定义：\n$$ u'(x_j) = P_5'(x_j) = 0 \\quad \\text{for } j=1, 2, 3, 4 $$\n\n对于边界节点 $x_0=-1$ 和 $x_5=1$，我们需要计算 $P_5'(-1)$ 和 $P_5'(1)$。勒让德多项式 $P_n(x)$ 的一个标准性质是它们在端点的导数由以下公式给出：\n$$ P_n'(1) = \\frac{n(n+1)}{2} $$\n$$ P_n'(-1) = (-1)^{n-1} \\frac{n(n+1)}{2} $$\n在我们的情况下，$n=5$。将此值代入公式：\n$$ u'(x_5) = P_5'(1) = \\frac{5(5+1)}{2} = \\frac{5 \\times 6}{2} = 15 $$\n$$ u'(x_0) = P_5'(-1) = (-1)^{5-1} \\frac{5(5+1)}{2} = (-1)^4 \\times 15 = 15 $$\n\n现在我们可以组装完整的节点导数向量 $D\\boldsymbol{u}$：\n$$ D\\boldsymbol{u} = \\begin{pmatrix} u'(x_0) \\\\ u'(x_1) \\\\ u'(x_2) \\\\ u'(x_3) \\\\ u'(x_4) \\\\ u'(x_5) \\end{pmatrix} = \\begin{pmatrix} 15 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 15 \\end{pmatrix} $$\n问题要求结果以单个行矩阵的形式给出。对应于节点 $x_0  x_1  x_2  x_3  x_4  x_5$ 的有序条目是 $(15, 0, 0, 0, 0, 15)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 15  0  0  0  0  15 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从节点上的函数值转向模态系数，我们来探讨勒让德多项式基的一个更强大属性：正交性。在伽辽金方法中，基函数的正交性极大地简化了计算，使得每个模态系数的求解变得独立。本练习将引导你利用正交关系，推导在增加逼近多项式次数时新模态的系数，从而深刻理解正交性在线性无关的投影和算法效率中的核心作用。",
            "id": "3395701",
            "problem": "考虑一维参考单元 $\\Omega = [-1,1]$，其上使用标准勒让德多项式基 $\\{P_{n}(x)\\}_{n\\geq 0}$，其中 $P_{n}(1)=1$，内积定义为 $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,\\mathrm{d}x$。假设采用谱方法或间断 Galerkin 离散，其中模态逼近使用非标准正交的勒让德基 $\\{P_{n}\\}$。\n\n设精确目标函数为 $u(x)=\\exp(\\beta x)$，其中 $\\beta\\in\\mathbb{R}$ 为一个固定参数。现有通过在 $L^{2}(\\Omega)$ 范数下到 $\\operatorname{span}\\{P_{0},P_{1},\\dots,P_{p}\\}$ 上的最小二乘投影构造的 p 次模态解。要求将逼近空间扩充到 $p+2$ 次（即包含 $P_{p+1}$ 和 $P_{p+2}$），并仅使用正交性和内积关系，以闭合形式确定新模态 $P_{p+1}$ 和 $P_{p+2}$ 的最小二乘系数。\n\n推导这两个扩充系数作为 $p$ 和 $\\beta$ 的解析函数的表达式，并以包含这两个系数的单行矩阵形式给出最终答案。无需进行数值取整。",
            "solution": "该问题要求在函数 $u(x) = \\exp(\\beta x)$ 的 p 次谱逼近被扩充到 $(p+2)$ 次逼近时，确定基函数 $P_{p+1}(x)$ 和 $P_{p+2}(x)$ 的系数。该逼近被定义为在 $L^2(\\Omega)$ 范数下的最小二乘投影，其中 $\\Omega = [-1,1]$。\n\n设 $u(x)$ 的 $N$ 次逼近记作 $u_N(x)$，表示为勒让德基多项式 $\\{P_n(x)\\}_{n=0}^N$ 的线性组合：\n$$u_N(x) = \\sum_{n=0}^{N} \\hat{u}_n P_n(x)$$\n系数 $\\hat{u}_n$ 由最小二乘投影确定，这等价于误差 $u(x) - u_N(x)$ 与逼近空间 $\\operatorname{span}\\{P_0, \\dots, P_N\\}$ 正交的 Galerkin 条件。该条件表示为：\n$$\\langle u - u_N, v \\rangle = 0, \\quad \\forall v \\in \\operatorname{span}\\{P_0, \\dots, P_N\\}$$\n通过选择基函数 $v = P_k(x)$ (其中 $k \\in \\{0, 1, \\dots, N\\}$)，我们得到一组方程：\n$$\\langle u(x) - \\sum_{n=0}^{N} \\hat{u}_n P_n(x), P_k(x) \\rangle = 0$$\n$$\\langle u, P_k \\rangle - \\sum_{n=0}^{N} \\hat{u}_n \\langle P_n, P_k \\rangle = 0$$\n标准勒让德多项式在区间 $[-1,1]$ 上关于给定的内积 $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)g(x)\\,\\mathrm{d}x$ 构成一个正交基。它们的正交性为：\n$$\\langle P_n, P_k \\rangle = \\int_{-1}^{1} P_n(x) P_k(x) \\,\\mathrm{d}x = \\frac{2}{2n+1} \\delta_{nk}$$\n其中 $\\delta_{nk}$ 是克罗内克 δ 符号。问题陈述中提到基是“非标准正交的”，我们将其理解为基向量是正交的，但未被归一化为单位范数（即 $\\langle P_n, P_n\\rangle \\neq 1$），这种理解是正确的。这种正交性至关重要，并且题目明确要求使用它。\n\n将正交性代入 Galerkin 条件，求和项坍缩为 $n=k$ 的一项：\n$$\\langle u, P_k \\rangle - \\hat{u}_k \\langle P_k, P_k \\rangle = 0$$\n这使得每个系数 $\\hat{u}_k$ 都可以独立地直接计算：\n$$\\hat{u}_k = \\frac{\\langle u, P_k \\rangle}{\\langle P_k, P_k \\rangle} = \\frac{\\int_{-1}^{1} u(x) P_k(x) \\,\\mathrm{d}x}{\\frac{2}{2k+1}} = \\frac{2k+1}{2} \\int_{-1}^{1} u(x) P_k(x) \\,\\mathrm{d}x$$\n这个公式对展开式中的任何系数 $\\hat{u}_k$ 都有效。正交性的一个关键推论是，系数 $\\hat{u}_k$ 仅依赖于 $u(x)$ 和 $P_k(x)$，而与逼近空间的维度无关。因此，当将逼近从 $p$ 次扩充到 $p+2$ 次时，系数 $\\hat{u}_0, \\dots, \\hat{u}_p$ 保持不变。我们必须求的新系数是模态 $P_{p+1}(x)$ 和 $P_{p+2}(x)$ 的系数，即 $\\hat{u}_{p+1}$ 和 $\\hat{u}_{p+2}$。\n\n目标函数是 $u(x) = \\exp(\\beta x)$。系数为：\n$$\\hat{u}_{p+1} = \\frac{2(p+1)+1}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+1}(x) \\,\\mathrm{d}x = \\frac{2p+3}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+1}(x) \\,\\mathrm{d}x$$\n$$\\hat{u}_{p+2} = \\frac{2(p+2)+1}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+2}(x) \\,\\mathrm{d}x = \\frac{2p+5}{2} \\int_{-1}^{1} \\exp(\\beta x) P_{p+2}(x) \\,\\mathrm{d}x$$\n为了继续计算，我们需要求解积分 $\\int_{-1}^{1} \\exp(\\beta x) P_n(x) \\,\\mathrm{d}x$。这是特殊函数理论中的一个标准积分。其结果用第一类修正球贝塞尔函数 $i_n(z)$ 表示：\n$$\\int_{-1}^{1} \\exp(\\beta x) P_n(x) \\,\\mathrm{d}x = 2 i_n(\\beta)$$\n函数 $i_n(\\beta)$ 是 $\\beta$ 的解析函数，并且可以用初等函数（双曲函数和 $\\beta$ 的幂）来表示。例如，$i_0(\\beta) = \\frac{\\sinh(\\beta)}{\\beta}$ 和 $i_1(\\beta) = \\frac{\\cosh(\\beta)}{\\beta} - \\frac{\\sinh(\\beta)}{\\beta^2}$。问题要求将系数表示为 $p$ 和 $\\beta$ 的解析函数，而使用 $i_n(\\beta)$ 来表示它们是标准且最紧凑的闭合形式。\n\n将此恒等式代入系数的表达式中：\n对于 $P_{p+1}(x)$ 的系数：\n$$\\hat{u}_{p+1} = \\frac{2p+3}{2} \\left( 2 i_{p+1}(\\beta) \\right) = (2p+3) i_{p+1}(\\beta)$$\n对于 $P_{p+2}(x)$ 的系数：\n$$\\hat{u}_{p+2} = \\frac{2p+5}{2} \\left( 2 i_{p+2}(\\beta) \\right) = (2p+5) i_{p+2}(\\beta)$$\n这就是所要求的以 $p$ 和 $\\beta$ 的解析函数表示的闭合形式扩充系数。最终答案应以包含这两个表达式的行矩阵形式呈现。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} (2p+3) i_{p+1}(\\beta)  (2p+5) i_{p+2}(\\beta) \\end{pmatrix} } $$"
        },
        {
            "introduction": "理论必须与实践相结合，尤其是在处理像间断伽辽金（DG）方法这样的高级数值格式时。DG方法求解守恒律时，单元边界上非线性数值通量的精确积分至关重要，它直接关系到整个方案的稳定性和精度。本练习要求你基于第一性原理，通过分析被积函数的最高多项式次数，来确定保证积分精确性的最小高斯求积点数，这是设计和实现可靠DG求解器的基本功。",
            "id": "3395757",
            "problem": "考虑在一维参考单元（坐标 $x \\in [-1,1]$）上一个标量守恒律的间断Galerkin (DG) 半离散格式。设试探空间和检验空间由勒让德多项式 $\\{P_{k}(x)\\}_{k=0}^{p}$ 张成，因此任何解 $u_{h}$ 或检验函数 $v_{h}$ 在由局部坐标 $s \\in [-1,1]$ 参数化的单元面上的迹都是次数至多为 $p$ 的单变量多项式。假设数值通量是一个两点函数 $\\widehat{f}(u^{-},u^{+})$，当物理通量 $f(u)$ 是次数至多为 $r \\in \\mathbb{N}$ 的多项式时，它本身是关于其自变量的总次数至多为 $r$ 的多项式。沿着一个单元面，DG 单元面积分涉及检验迹 $v_{h}(s)$ 与 $\\widehat{f}(u_{h}^{-}(s),u_{h}^{+}(s))$ 的乘积。\n\n仅使用关于代数运算下多项式次数的基本原理和勒让德多项式空间的定义性质，确定在一个单元面上保证对所有 $u_{h},v_{h} \\in \\mathbb{P}_{p}$ 的单元面积分进行精确计算所需的高斯-勒让德求积点 $N_{q}$ 的最小数量，此时 $\\widehat{f}$ 关于其自变量的总多项式次数至多为 $r$。然后，将你的结果特化到对次数至多为 $2p$ 的乘积进行精确积分的要求。\n\n以一个含两个元素的行向量形式提供你的最终答案：第一个元素是 $N_{q}$ 作为 $p$ 和 $r$ 的函数，第二个元素是精确积分所有次数至多为 $2p$ 的乘积所需的最小 $N_{q}$。无需进行数值计算，也不涉及单位。最终答案必须是闭式表达式。",
            "solution": "解决这个问题的基本原理是高斯-勒让德求积的精确性性质。在区间 $[-1,1]$ 上的一个 $N_q$ 点高斯-勒让德求积法则可以精确地积分任何次数至多为 $2N_q - 1$ 的多项式。为了找到最小点数 $N_q$，我们必须首先确定多项式被积函数的最大可能次数。\n\n**第 1 部分：单元面积分求积**\n\n需要计算的单元面积分形式为\n$$\nI = \\int_{-1}^{1} v_{h}(s) \\widehat{f}(u_{h}^{-}(s), u_{h}^{+}(s)) ds\n$$\n将被积函数记为 $g(s) = v_{h}(s) \\widehat{f}(u_{h}^{-}(s), u_{h}^{+}(s))$。我们需要找到 $g(s)$ 的最大可能多项式次数，记为 $\\deg(g)$。\n\n1.  **检验函数迹的次数**：检验函数 $v_h$ 属于空间 $\\mathbb{P}_p$，该空间由次数至多为 $p$ 的多项式组成。因此，它在单元面上的迹 $v_h(s)$ 是关于单元面坐标 $s$ 的多项式，其次数 $\\deg(v_h(s)) \\le p$。\n\n2.  **解的迹的次数**：类似地，解 $u_h$ 属于 $\\mathbb{P}_p$。它在单元面上的内部迹和外部迹 $u_h^-(s)$ 和 $u_h^+(s)$ 都是关于 $s$ 的多项式，各自的次数至多为 $p$。因此，$\\deg(u_h^-(s)) \\le p$ 且 $\\deg(u_h^+(s)) \\le p$。\n\n3.  **数值通量项的次数**：已知数值通量 $\\widehat{f}(A,B)$ 是关于其自变量 $A$ 和 $B$ 的总次数至多为 $r$ 的多项式。这意味着它可以表示为形如 $c_{ij}A^i B^j$（其中 $i+j \\le r$）的项之和。\n    在我们的情况下，自变量是多项式迹，$A = u_h^-(s)$ 和 $B = u_h^+(s)$。$\\widehat{f}(u_h^-(s), u_h^+(s))$ 展开式中单个项的次数为：\n    $$\n    \\deg\\left( (u_h^-(s))^i (u_h^+(s))^j \\right) = i \\cdot \\deg(u_h^-(s)) + j \\cdot \\deg(u_h^+(s))\n    $$\n    为了找到最大可能次数，我们取迹的最大次数：\n    $$\n    \\deg\\left( (u_h^-(s))^i (u_h^+(s))^j \\right) \\le i \\cdot p + j \\cdot p = (i+j)p\n    $$\n    整个数值通量多项式 $\\widehat{f}(u_h^-(s), u_h^+(s))$ 的次数是其各组成项次数的最大值。当和 $i+j$ 最大化时，达到这个最大值。根据问题陈述，$i+j$ 的最大值为 $r$。\n    因此，数值通量作为关于 $s$ 的多项式的最大次数是 $r \\cdot p$。我们将其表示为 $\\deg(\\widehat{f}(\\cdot, \\cdot))_s \\le rp$。\n\n4.  **完整被积函数的次数**：被积函数是乘积 $g(s) = v_h(s) \\cdot \\widehat{f}(u_h^-(s), u_h^+(s))$。多项式乘积的次数是它们次数的和。\n    $$\n    \\deg(g(s)) = \\deg(v_h(s)) + \\deg(\\widehat{f}(u_h^-(s), u_h^+(s)))_s\n    $$\n    因此，被积函数的最大可能次数 $D_{\\text{max}}$ 为：\n    $$\n    D_{\\text{max}} \\le p + rp = p(r+1)\n    $$\n\n5.  **所需求积点数**：为保证精确积分，高斯-勒让德求积法则必须对次数高达 $D_{\\text{max}} = p(r+1)$ 的任何多项式都精确。我们必须满足条件：\n    $$\n    2N_q - 1 \\ge p(r+1)\n    $$\n    解出 $N_q$ 可得：\n    $$\n    N_q \\ge \\frac{p(r+1) + 1}{2}\n    $$\n    由于 $N_q$ 必须是整数，所需的最小求积点数是满足此不等式的最小整数，由向上取整函数给出：\n    $$\n    N_q = \\left\\lceil \\frac{p(r+1) + 1}{2} \\right\\rceil\n    $$\n\n**第 2 部分：对次数至多为 $2p$ 的乘积的特化**\n\n第二部分要求计算精确积分总多项式次数至多为 $2p$ 的乘积所需的最小 $N_q$。这是对相同求积原理的直接应用。\n\n1.  **被积函数的最大次数**：要积分的多项式的最大次数给定为 $D = 2p$。\n\n2.  **所需求积点数**：我们直接应用高斯-勒让德求积的精确性条件：\n    $$\n    2N_q - 1 \\ge 2p\n    $$\n    解出 $N_q$：\n    $$\n    2N_q \\ge 2p+1 \\implies N_q \\ge p + \\frac{1}{2}\n    $$\n    由于 $N_q$ 必须是整数，最小点数是大于或等于 $p + 1/2$ 的最小整数，即：\n    $$\n    N_q = p+1\n    $$\n这个结果对应于精确计算DG方法中体积积分（例如质量矩阵项 $\\int u_h v_h dx$）的标准要求，其中被积函数是两个来自 $\\mathbb{P}_p$ 的多项式的乘积，其结果是一个次数至多为 $2p$ 的多项式。\n\n最终答案是一个包含第 1 部分和第 2 部分结果的、含两个元素的行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left\\lceil \\frac{p(r+1)+1}{2} \\right\\rceil  p+1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}