{
    "hands_on_practices": [
        {
            "introduction": "在非线性谱计算中，伪谱法因其高效性而被广泛应用，但它也可能引入混叠误差。本练习提供了一个具体的计算任务，旨在帮助您理解二次非线性项 $u^2$ 如何产生新的频率分量。通过运用“3/2填充规则”这一标准去混叠技术，我们可以精确地确定哪些频率分量被保留，哪些被滤除，从而深刻理解混叠的产生机理与抑制方法。",
            "id": "3363423",
            "problem": "考虑一个定义在 $[0,2\\pi]$ 上的周期函数 $u(x)$，它在 $N=16$ 个等距点 $x_{j} = \\frac{2\\pi j}{N}$（$j=0,1,\\dots, N-1$）上进行采样。在伪谱法中，非线性积的计算方式是：变换到物理空间，进行逐点相乘，然后再变换回傅里叶空间。混叠现象的产生是由于傅里叶模的离散卷积将高频内容折叠回可分辨的频带中。避免二次非线性项混叠的一种标准方法是“三分之二补零”法：将谱表示补零至 $M = \\frac{3}{2}N$ 个模，变换到 $M$ 个物理点，进行逐点相乘，变换回谱空间，然后通过丢弃原始可分辨频带之外的模，将结果投影到原始的 $N$ 模子空间上。\n\n设 $u(x) = \\sin(3x) + \\sin(5x)$。使用带有三分之二补零的去混叠伪谱评估方法，计算乘积 $u^{2}(x)$ 在投影回原始的 $N=16$ 模子空间后，其去混叠的解析表达式。将最终结果表示为关于 $x$ 的单个简化三角表达式。无需进行数值舍入。",
            "solution": "该问题是有效的，因为它在科学上基于谱方法的原理，是适定且客观的。问题描述中没有矛盾或信息缺失。所描述的用于二次非线性项去混叠的三分之二补零法，是计算物理和工程领域的一项标准技术。因此，我们可以着手求解。\n\n问题要求在使用带有三分之二补零的伪谱法，且网格点数为 $N=16$ 的情况下，求出乘积 $u^2(x)$ 的去混叠表达式，其中 $u(x) = \\sin(3x) + \\sin(5x)$。\n\n首先，我们确定乘积 $u^2(x)$ 的精确解析表达式。这代表了在考虑任何截断或混叠效应之前，在物理空间中进行乘法步骤的结果。\n$$u^2(x) = (\\sin(3x) + \\sin(5x))^2$$\n$$u^2(x) = \\sin^2(3x) + \\sin^2(5x) + 2\\sin(3x)\\sin(5x)$$\n我们使用以下三角恒等式来简化此表达式：\n1. 降幂公式：$\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$\n2. 积化和差公式：$2\\sin(A)\\sin(B) = \\cos(A-B) - \\cos(A+B)$\n\n应用这些恒等式，我们得到：\n$$\\sin^2(3x) = \\frac{1 - \\cos(2 \\cdot 3x)}{2} = \\frac{1}{2} - \\frac{1}{2}\\cos(6x)$$\n$$\\sin^2(5x) = \\frac{1 - \\cos(2 \\cdot 5x)}{2} = \\frac{1}{2} - \\frac{1}{2}\\cos(10x)$$\n$$2\\sin(3x)\\sin(5x) = \\cos(5x - 3x) - \\cos(5x + 3x) = \\cos(2x) - \\cos(8x)$$\n\n将这些代回 $u^2(x)$ 的表达式中：\n$$u^2(x) = \\left(\\frac{1}{2} - \\frac{1}{2}\\cos(6x)\\right) + \\left(\\frac{1}{2} - \\frac{1}{2}\\cos(10x)\\right) + (\\cos(2x) - \\cos(8x))$$\n合并各项，得到精确的乘积为：\n$$u^2(x) = 1 + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x) - \\frac{1}{2}\\cos(10x)$$\n该表达式表明，真实的乘积包含对应于波数 $k \\in \\{0, 2, 6, 8, 10\\}$ 的傅里叶模。\n\n接下来，我们分析去混叠过程。计算是在一个包含 $N=16$ 个点的离散网格上执行的。初始函数 $u(x)$ 包含波数为 $k=3$ 和 $k=5$ 的模。原始网格的奈奎斯特波数为 $k_{Ny,N} = N/2 = 16/2 = 8$。由于 $u(x)$ 中的波数小于 $k_{Ny,N}$，该函数在初始网格上得到了很好的分辨。\n\n去混叠过程涉及将谱表示补零至 $M = \\frac{3}{2}N = \\frac{3}{2}(16) = 24$ 个模。然后，在由 $M=24$ 个点组成的更精细的网格上，于物理空间中计算非线性积。此补零网格的奈奎斯特波数为 $k_{Ny,M} = M/2 = 24/2 = 12$。\n\n为了在这个补零网格上无混叠地计算二次乘积，精确乘积中存在的最高波数必须小于补零网格的奈奎斯特波数 $k_{Ny,M}$。在我们的精确乘积 $u^2(x)$ 中，最高波数是 $k_{max}=10$。\n由于 $k_{max} = 10  k_{Ny,M} = 12$，在 $M=24$ 点网格上的逐点相乘不会产生混叠。将此乘积变换回补零的谱空间，会得到真实乘积 $u^2(x)$ 的精确傅里叶系数。\n\n最后一步是将结果投影到原始的 $N=16$ 模子空间上。这意味着我们必须丢弃所有在原始网格上无法表示的模。对于一个在 $N=16$ 个点上的实值函数，其离散傅里叶表示的基函数通常选择为 $\\{\\cos(kx) \\mid k=0, 1, \\dots, N/2\\}$ 和 $\\{\\sin(kx) \\mid k=1, 2, \\dots, N/2-1\\}$。\n对于 $N=16$，可分辨的余弦波数为 $k \\in \\{0, 1, 2, 3, 4, 5, 6, 7, 8\\}$。乘积 $u^2(x)$ 只包含余弦项。\n\n我们检查精确乘积中各项的波数：\n$u^2(x) = 1\\cdot\\cos(0x) + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x) - \\frac{1}{2}\\cos(10x)$\n- 常数项 $1$ 对应于 $k=0$。这在可分辨频带内（$0 \\le 8$）。\n- 项 $\\cos(2x)$ 的波数为 $k=2$。这在可分辨频带内（$2 \\le 8$）。\n- 项 $-\\frac{1}{2}\\cos(6x)$ 的波数为 $k=6$。这在可分辨频带内（$6 \\le 8$）。\n- 项 $-\\cos(8x)$ 的波数为 $k=8$。这是原始网格的奈奎斯特波数，它包含在余弦基中。这在可分辨频带内（$8 \\le 8$）。\n- 项 $-\\frac{1}{2}\\cos(10x)$ 的波数为 $k=10$。这个波数在可分辨频带之外（$10 > 8$）。\n\n投影操作会丢弃波数为 $k=10$ 的模。因此，在投影回原始 $N=16$ 模子空间后，去混叠的乘积由所有具有可分辨波数的项之和给出。\n\n得到的表达式为：\n$$u^2_{\\text{de-aliased}}(x) = 1 + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x)$$\n这就是去混叠乘积的最终解析表达式。",
            "answer": "$$\\boxed{1 + \\cos(2x) - \\frac{1}{2}\\cos(6x) - \\cos(8x)}$$"
        },
        {
            "introduction": "现在，我们将从傅里叶谱方法过渡到常用于复杂几何区域的多项式谱方法，例如谱元法（SEM）和间断伽辽金法（DG）。本练习将探讨在勒让德多项式基下的混叠问题。我们将对比非线性项的精确 $L^2$ 投影与计算上更便捷但存在近似的配置点乘积，这使我们能够量化多项式表示本身产生的混叠误差。",
            "id": "3363449",
            "problem": "考虑一个一维参考单元，其坐标为 $x \\in [-1,1]$，以及一个次数至多为 $p$ 的多项式空间 $\\mathbb{P}_p$，该空间由模态勒让德基 $\\{P_n(x)\\}_{n=0}^{p}$ 表示，其中 $P_n(x)$ 表示 $n$ 次勒让德多项式。勒让德多项式在 $[-1,1]$ 上关于权重 $1$ 是正交的，对于非负整数 $m$ 和 $n$ 满足 $\\int_{-1}^{1} P_m(x) P_n(x) \\,\\mathrm{d}x = \\frac{2}{2n+1} \\delta_{mn}$。在谱方法或间断伽辽金 (DG) 离散化中，诸如 $u^2$之类的非线性项既可以通过到 $\\mathbb{P}_p$ 上的精确 $L^2$ 投影来表示，也可以通过基于配置的节点乘积，然后从节点值插值回 $\\mathbb{P}_p$ 来表示。当非线性乘积使多项式次数超过 $p$ 时，后者会引入混淆误差。使用以下具体设置来分析和量化混淆误差：\n\n- 取多项式次数 $p=2$ 和模态勒让德基 $\\{P_0(x),P_1(x),P_2(x)\\}$，其中 $P_0(x)=1$，$P_1(x)=x$ 以及 $P_2(x)=\\frac{3x^2-1}{2}$。\n- 令 $u(x) = P_0(x) + P_1(x) + P_2(x)$。\n- 定义精确 $L^2$ 投影 $\\Pi_{\\mathbb{P}_2}(u^2)$ 为 $\\mathbb{P}_2$ 中的唯一多项式，其模态系数 $\\{c_n\\}_{n=0}^{2}$ 满足 $c_n = \\frac{2n+1}{2} \\int_{-1}^{1} u(x)^2 P_n(x) \\,\\mathrm{d}x$。\n- 在 $p=2$ 的勒让德-高斯-洛巴托 (LGL) 节点 $x \\in \\{-1,0,1\\}$ 上定义基于配置的乘积。计算节点值 $v_i = u(x_i)^2$（对于 $x_i \\in \\{-1,0,1\\}$），并令 $w(x) \\in \\mathbb{P}_2$ 为满足 $w(x_i) = v_i$（对于 $x_i \\in \\{-1,0,1\\}$）的唯一 2 次插值多项式。\n- 将混淆误差量化为精确投影与基于配置的多项式之差的 $L^2$ 范数的平方，定义为\n$$E = \\int_{-1}^{1} \\big(\\Pi_{\\mathbb{P}_2}(u^2)(x) - w(x)\\big)^2 \\,\\mathrm{d}x.$$\n\n从上述基本定义推导出所有必需的中间表达式。将您对 $E$ 的最终答案表示为一个精确分数。不要四舍五入。",
            "solution": "所述问题具有科学依据、良定、客观且自洽。它是在数值分析中量化谱方法中混淆误差的一个标准练习。所有定义和数据均已提供，并与既定理论一致。因此，该问题是有效的，将推导求解。\n\n求解过程分四步进行：\n1.  首先，我们确定 $u(x)$ 和 $u(x)^2$ 的显式多项式形式。\n2.  其次，我们计算 $u(x)^2$ 到多项式空间 $\\mathbb{P}_2$ 上的精确 $L^2$ 投影，我们将其记为 $\\Pi_{\\mathbb{P}_2}(u^2)(x)$。\n3.  第三，我们计算在指定的勒让德-高斯-洛巴托 (LGL) 节点上与 $u(x)^2$ 进行配置的插值多项式 $w(x) \\in \\mathbb{P}_2$。\n4.  最后，我们计算这两个多项式之差的 $L^2$ 范数的平方，以求得混淆误差 $E$。\n\n步骤1：表示 $u(x)$ 和 $u(x)^2$。\n函数 $u(x)$ 在勒让德基下给出为 $u(x) = P_0(x) + P_1(x) + P_2(x)$。代入定义 $P_0(x)=1$, $P_1(x)=x$ 和 $P_2(x) = \\frac{3x^2-1}{2}$，我们得到：\n$$u(x) = 1 + x + \\frac{3x^2-1}{2} = \\frac{3}{2}x^2 + x + \\frac{1}{2}$$\n对该表达式求平方得到非线性项 $u(x)^2$：\n$$u(x)^2 = \\left(\\frac{3}{2}x^2 + x + \\frac{1}{2}\\right)^2 = \\frac{9}{4}x^4 + x^2 + \\frac{1}{4} + 2\\left(\\frac{3}{2}x^3\\right) + 2\\left(\\frac{3}{4}x^2\\right) + 2\\left(\\frac{1}{2}x\\right)$$\n$$u(x)^2 = \\frac{9}{4}x^4 + 3x^3 + \\left(1 + \\frac{3}{2}\\right)x^2 + x + \\frac{1}{4} = \\frac{9}{4}x^4 + 3x^3 + \\frac{5}{2}x^2 + x + \\frac{1}{4}$$\n这是一个 4 次多项式。\n\n步骤2：计算精确 $L^2$ 投影 $\\Pi_{\\mathbb{P}_2}(u^2)$。\n精确投影 $\\Pi_{\\mathbb{P}_2}(u^2)$ 是 $u(x)^2$ 位于由 $\\{P_0(x), P_1(x), P_2(x)\\}$ 张成的空间 $\\mathbb{P}_2$ 中的分量。我们可以通过将 $u(x)^2$ 表示在勒让德基中并截断高于 2 次的项来找到它。我们使用标准恒等式：$1=P_0(x)$, $x=P_1(x)$, $x^2 = \\frac{1}{3}P_0(x) + \\frac{2}{3}P_2(x)$, $x^3 = \\frac{3}{5}P_1(x) + \\frac{2}{5}P_3(x)$ 以及 $x^4 = \\frac{1}{5}P_0(x) + \\frac{4}{7}P_2(x) + \\frac{8}{35}P_4(x)$。\n将这些代入 $u(x)^2$ 的表达式中：\n$$u(x)^2 = \\frac{9}{4}\\left(\\frac{1}{5}P_0 + \\frac{4}{7}P_2 + \\frac{8}{35}P_4\\right) + 3\\left(\\frac{3}{5}P_1 + \\frac{2}{5}P_3\\right) + \\frac{5}{2}\\left(\\frac{1}{3}P_0 + \\frac{2}{3}P_2\\right) + P_1 + \\frac{1}{4}P_0$$\n收集每个勒让德多项式的系数：\n- $P_0$ 项：$(\\frac{9}{20} + \\frac{5}{6} + \\frac{1}{4})P_0 = (\\frac{27+50+15}{60})P_0 = \\frac{92}{60}P_0 = \\frac{23}{15}P_0$\n- $P_1$ 项：$(\\frac{9}{5} + 1)P_1 = \\frac{14}{5}P_1$\n- $P_2$ 项：$(\\frac{9}{7} + \\frac{5}{3})P_2 = (\\frac{27+35}{21})P_2 = \\frac{62}{21}P_2$\n- $P_3$ 项：$\\frac{6}{5}P_3$\n- $P_4$ 项：$\\frac{18}{35}P_4$\n精确 $L^2$ 投影通过只保留 $\\mathbb{P}_2$ 中的项得到：\n$$\\Pi_{\\mathbb{P}_2}(u^2)(x) = \\frac{23}{15}P_0(x) + \\frac{14}{5}P_1(x) + \\frac{62}{21}P_2(x)$$\n\n步骤3：计算基于配置的多项式 $w(x)$。\n对于 $p=2$，LGL 节点是 $x_0=-1$, $x_1=0$ 和 $x_2=1$。我们首先在这些节点上计算 $u(x)$：\n- $u(x_0) = u(-1) = \\frac{3}{2}(-1)^2 + (-1) + \\frac{1}{2} = \\frac{3}{2} - 1 + \\frac{1}{2} = 1$\n- $u(x_1) = u(0) = \\frac{3}{2}(0)^2 + (0) + \\frac{1}{2} = \\frac{1}{2}$\n- $u(x_2) = u(1) = \\frac{3}{2}(1)^2 + (1) + \\frac{1}{2} = \\frac{3}{2} + 1 + \\frac{1}{2} = 3$\n用于配置的节点值是 $v_i = u(x_i)^2$：\n- $v_0 = u(-1)^2 = 1^2 = 1$\n- $v_1 = u(0)^2 = (\\frac{1}{2})^2 = \\frac{1}{4}$\n- $v_2 = u(1)^2 = 3^2 = 9$\n我们寻找唯一的插值多项式 $w(x) = ax^2 + bx + c$ 来插值这些值：\n- $w(0) = c = \\frac{1}{4}$\n- $w(1) = a + b + c = 9 \\implies a+b = 9 - \\frac{1}{4} = \\frac{35}{4}$\n- $w(-1) = a - b + c = 1 \\implies a-b = 1 - \\frac{1}{4} = \\frac{3}{4}$\n将最后两个方程相加得到 $2a = \\frac{35}{4} + \\frac{3}{4} = \\frac{38}{4} = \\frac{19}{2}$，所以 $a = \\frac{19}{4}$。\n从第二个方程减去第三个方程得到 $2b = \\frac{35}{4} - \\frac{3}{4} = \\frac{32}{4} = 8$，所以 $b=4$。\n因此，插值多项式是 $w(x) = \\frac{19}{4}x^2 + 4x + \\frac{1}{4}$。\n为便于比较，我们将 $w(x)$ 表示在勒让德基中：\n$$w(x) = \\frac{19}{4}\\left(\\frac{1}{3}P_0 + \\frac{2}{3}P_2\\right) + 4P_1 + \\frac{1}{4}P_0 = \\left(\\frac{19}{12} + \\frac{1}{4}\\right)P_0 + 4P_1 + \\frac{19}{6}P_2$$\n$$w(x) = \\left(\\frac{19+3}{12}\\right)P_0 + 4P_1 + \\frac{19}{6}P_2 = \\frac{22}{12}P_0 + 4P_1 + \\frac{19}{6}P_2 = \\frac{11}{6}P_0(x) + 4P_1(x) + \\frac{19}{6}P_2(x)$$\n\n步骤4：计算混淆误差 $E$。\n混淆误差是差分多项式 $\\Delta(x) = \\Pi_{\\mathbb{P}_2}(u^2)(x) - w(x)$ 的 $L^2$ 范数的平方。\n$$\\Delta(x) = \\left(\\frac{23}{15} - \\frac{11}{6}\\right)P_0(x) + \\left(\\frac{14}{5} - 4\\right)P_1(x) + \\left(\\frac{62}{21} - \\frac{19}{6}\\right)P_2(x)$$\n差的系数是：\n- $P_0$ 系数：$\\frac{23 \\cdot 2 - 11 \\cdot 5}{30} = \\frac{46-55}{30} = -\\frac{9}{30} = -\\frac{3}{10}$\n- $P_1$ 系数：$\\frac{14 - 20}{5} = -\\frac{6}{5}$\n- $P_2$ 系数：$\\frac{62 \\cdot 2 - 19 \\cdot 7}{42} = \\frac{124 - 133}{42} = -\\frac{9}{42} = -\\frac{3}{14}$\n所以，差分多项式是 $\\Delta(x) = -\\frac{3}{10}P_0(x) - \\frac{6}{5}P_1(x) - \\frac{3}{14}P_2(x)$。\n误差 $E$ 是 $\\Delta(x)^2$ 的积分。由于勒让德多项式的正交性，对于 $m \\neq n$ 有 $\\int_{-1}^{1} P_m(x) P_n(x) \\,\\mathrm{d}x = 0$。\n$$E = \\int_{-1}^{1} \\left( -\\frac{3}{10}P_0(x) - \\frac{6}{5}P_1(x) - \\frac{3}{14}P_2(x) \\right)^2 \\,\\mathrm{d}x$$\n$$E = \\left(-\\frac{3}{10}\\right)^2 \\int_{-1}^{1} P_0(x)^2 \\,\\mathrm{d}x + \\left(-\\frac{6}{5}\\right)^2 \\int_{-1}^{1} P_1(x)^2 \\,\\mathrm{d}x + \\left(-\\frac{3}{14}\\right)^2 \\int_{-1}^{1} P_2(x)^2 \\,\\mathrm{d}x$$\n使用正交关系 $\\int_{-1}^{1} P_n(x)^2 \\,\\mathrm{d}x = \\frac{2}{2n+1}$：\n- $\\int_{-1}^{1} P_0(x)^2 \\,\\mathrm{d}x = \\frac{2}{1} = 2$\n- $\\int_{-1}^{1} P_1(x)^2 \\,\\mathrm{d}x = \\frac{2}{3}$\n- $\\int_{-1}^{1} P_2(x)^2 \\,\\mathrm{d}x = \\frac{2}{5}$\n将这些值代入 $E$ 的表达式中：\n$$E = \\frac{9}{100}(2) + \\frac{36}{25}\\left(\\frac{2}{3}\\right) + \\frac{9}{196}\\left(\\frac{2}{5}\\right)$$\n$$E = \\frac{18}{100} + \\frac{24}{25} + \\frac{18}{980} = \\frac{9}{50} + \\frac{24}{25} + \\frac{9}{490}$$\n为了将这些分数相加，我们找到一个公分母。\n$$E = \\frac{9}{50} + \\frac{48}{50} + \\frac{9}{490} = \\frac{57}{50} + \\frac{9}{490}$$\n$50 = 2 \\cdot 5^2$ 和 $490 = 2 \\cdot 5 \\cdot 7^2$ 的最小公倍数是 $2 \\cdot 5^2 \\cdot 7^2 = 2450$。\n$$E = \\frac{57 \\cdot 49}{2450} + \\frac{9 \\cdot 5}{2450} = \\frac{2793}{2450} + \\frac{45}{2450} = \\frac{2793+45}{2450} = \\frac{2838}{2450}$$\n通过将分子和分母除以它们的最大公约数 2 来简化分数：\n$$E = \\frac{1419}{1225}$$\n分子 $1419 = 3 \\cdot 473$ 且分母 $1225=5^2 \\cdot 7^2$。没有公因数，所以分数是最简形式。",
            "answer": "$$\\boxed{\\frac{1419}{1225}}$$"
        },
        {
            "introduction": "本练习将引导您从解析计算转向计算探索。您将编写一个简短的程序，利用一个精心设计的“人造解”（manufactured solution）来测量纯粹的混叠误差。通过构建一个精确解为零的场景，任何由数值方法产生的非零结果都可以明确地归因于混叠效应，这为理解积分不足所引入的误差提供了一个清晰而有力的展示。",
            "id": "3363459",
            "problem": "考虑一个周期为 $2\\pi$ 的一维周期域和复傅里叶空间 $X_K := \\mathrm{span}\\{\\mathrm{e}^{\\mathrm{i} k x} : -K \\le k \\le K\\}$，其中谱截断 $K \\in \\mathbb{N}$ 是给定的。设 $f(x) = \\mathrm{e}^{\\mathrm{i} m x}$ 和 $g(x) = \\mathrm{e}^{\\mathrm{i} n x}$，其中整数 $m,n$ 满足 $|m| \\le K$ 和 $|n| \\le K$。非线性乘积为 $h(x) := f(x)\\,g(x) = \\mathrm{e}^{\\mathrm{i} (m+n) x}$。\n\n通过傅里叶内积定义 $h$ 到 $X_K$ 上的精确伽辽金投影系数 $\\{a_k\\}_{k=-K}^{K}$：\n$$\na_k := \\frac{1}{2\\pi}\\int_{0}^{2\\pi} h(x)\\,\\mathrm{e}^{-\\mathrm{i} k x}\\,\\mathrm{d}x,\\quad -K \\le k \\le K.\n$$\n通过梯形法则定义欠积分伪谱（基于求积）系数 $\\{a_k^{(N)}\\}_{k=-K}^{K}$，其中使用 $N \\in \\mathbb{N}$ 个等距节点 $x_j := \\frac{2\\pi}{N} j$，$j=0,1,\\dots,N-1$：\n$$\na_k^{(N)} := \\frac{1}{N} \\sum_{j=0}^{N-1} h(x_j)\\,\\mathrm{e}^{-\\mathrm{i} k x_j},\\quad -K \\le k \\le K.\n$$\n该设置模拟了欠积分下的混叠现象：当 $N$ 相对于 $K$ 太小时，$h$ 中位于 $[-K,K]$ 之外的高频内容可能会因离散采样而混叠到已解析的频带中。\n\n您的任务是构造一些特设案例，在这些案例中，非线性乘积在 $X_K$ 上的精确投影为零，即 $|m+n|  K$，因此对于所有 $-K \\le k \\le K$ 都有 $a_k = 0$。然后，计算完全由欠积分伪谱系数引入的纯混叠误差。通过欧几里得范数来衡量纯混叠误差：\n$$\nE(K,m,n,N) := \\left( \\sum_{k=-K}^{K} \\left| a_k^{(N)} - a_k \\right|^2 \\right)^{1/2}.\n$$\n\n实现一个程序，该程序：\n- 完全按照上述定义（使用 $a_k$ 和 $a_k^{(N)}$ 的定义）计算 $E(K,m,n,N)$。\n- 使用以下包含四个案例的测试套件，旨在涵盖典型情况、去混叠情况、小频带边缘情况和混合频率情况。所有角度均以弧度为单位。\n  1. $K=8$, $m=8$, $n=8$, $N=17$。\n  2. $K=8$, $m=8$, $n=8$, $N=25$。\n  3. $K=1$, $m=1$, $n=1$, $N=3$。\n  4. $K=8$, $m=8$, $n=7$, $N=17$。\n这些案例满足 $|m+n|  K$，因此精确的已解析投影为零，任何非零结果都完全由欠积分下的混叠引起。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试案例的结果，格式为用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,r4]”）。\n- 每个数字必须打印为十进制小数，精确到小数点后十二位，单位为与弧度一致的无量纲单位。\n\n程序无需用户输入；它必须能直接运行并打印所需的单行结果。",
            "solution": "用户希望我解决一个关于谱方法中混叠的问题。\n\n### 第一步：问题阐述与简化\n\n问题要求计算纯混叠误差，其定义为欧几里得范数：\n$$\nE(K,m,n,N) := \\left( \\sum_{k=-K}^{K} \\left| a_k^{(N)} - a_k \\right|^2 \\right)^{1/2}\n$$\n其中 $\\{a_k\\}_{k=-K}^{K}$ 是精确伽辽金投影系数，$\\{a_k^{(N)}\\}_{k=-K}^{K}$ 是乘积函数 $h(x) = \\mathrm{e}^{\\mathrm{i} (m+n) x}$ 的欠积分伪谱系数。\n\n首先，我们分析精确系数 $a_k$：\n$$\na_k = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} h(x)\\,\\mathrm{e}^{-\\mathrm{i} k x}\\,\\mathrm{d}x = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\mathrm{e}^{\\mathrm{i} (m+n) x}\\,\\mathrm{e}^{-\\mathrm{i} k x}\\,\\mathrm{d}x = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\mathrm{e}^{\\mathrm{i} (m+n-k) x}\\,\\mathrm{d}x\n$$\n复指数在整个周期上的积分仅在频率为零时非零。设 $p = m+n-k$。由于 $m$、$n$ 和 $k$ 是整数，所以 $p$ 是整数。如果 $p=0$，积分值为 $2\\pi$；如果 $p \\neq 0$，积分值为 $0$。因此，系数 $a_k$ 由克罗内克δ函数给出：\n$$\na_k = \\delta_{k, m+n}\n$$\n问题指定所有测试案例的构造都满足 $|m+n|  K$。误差 $E$ 的求和范围是波数 $k \\in [-K, K]$。因此，在该范围内不可能满足条件 $k = m+n$。所以，对于所有相关的波数 $k$，$a_k = 0$。\n\n这将误差度量简化为已解析谱带内伪谱系数的离散 $L^2$-范数：\n$$\nE(K,m,n,N) = \\left( \\sum_{k=-K}^{K} \\left| a_k^{(N)} \\right|^2 \\right)^{1/2}\n$$\n$E$ 的任何非零值都完全源于数值求积引入的混叠误差。\n\n### 第二步：伪谱系数与混叠分析\n\n接下来，我们分析伪谱系数 $a_k^{(N)}$。它们由一个近似连续积分的离散和定义：\n$$\na_k^{(N)} := \\frac{1}{N} \\sum_{j=0}^{N-1} h(x_j)\\,\\mathrm{e}^{-\\mathrm{i} k x_j}\n$$\n代入 $h(x_j) = \\mathrm{e}^{\\mathrm{i} (m+n) x_j}$ 和网格点 $x_j = \\frac{2\\pi j}{N}$：\n$$\na_k^{(N)} = \\frac{1}{N} \\sum_{j=0}^{N-1} \\mathrm{e}^{\\mathrm{i} (m+n) \\frac{2\\pi j}{N}} \\, \\mathrm{e}^{-\\mathrm{i} k \\frac{2\\pi j}{N}} = \\frac{1}{N} \\sum_{j=0}^{N-1} \\mathrm{e}^{\\mathrm{i} (m+n-k) \\frac{2\\pi j}{N}}\n$$\n这是一个有限几何级数，形式为 $\\frac{1}{N}\\sum_{j=0}^{N-1} r^j$，其中 $r = \\mathrm{e}^{\\mathrm{i} (m+n-k) \\frac{2\\pi}{N}}$。\n该和的计算结果为：\n\\begin{itemize}\n    \\item 如果 $r=1$，则为 $N$。这发生在指数 $(m+n-k) \\frac{2\\pi}{N}$ 是 $2\\pi$ 的整数倍时，即对于某个整数 $q$，$m+n-k = qN$。\n    \\item 如果 $r \\neq 1$，则为 $0$。在这种情况下，和为 $\\frac{r^N-1}{r-1}$。由于 $r^N = \\left(\\mathrm{e}^{\\mathrm{i} (m+n-k) \\frac{2\\pi}{N}}\\right)^N = \\mathrm{e}^{\\mathrm{i} (m+n-k) 2\\pi} = 1$（因为 $m+n-k$ 是整数），所以分子为 $0$。\n\\end{itemize}\n因此，伪谱系数为：\n$$\na_k^{(N)} = \\begin{cases} 1  \\text{如果 } m+n-k \\text{ 是 } N \\text{ 的倍数} \\\\ 0  \\text{否则} \\end{cases}\n$$\n这是混叠的数学表现：真实波数 $p_{true} = m+n$ 在离散网格上被感知为任何满足关系 $p_{true} \\equiv k \\pmod{N}$ 的波数 $k$。要对误差 $E$ 有非零贡献，在已解析频带 $[-K, K]$ 中必须至少存在一个波数 $k$ 是 $m+n$ 的混叠。\n\n对于每个测试案例 $(K,m,n,N)$，误差 $E$ 是满足 $k = m+n-qN$（其中 $q$ 是整数）的整数 $k \\in \\{-K, \\dots, K\\}$ 的数量的平方根。\n\n### 第三步：算法设计与实现\n\n程序将通过直接实现 $a_k^{(N)}$ 的公式和简化的误差度量来为每个测试案例计算 $E(K,m,n,N)$。一种高效的方法是利用快速傅里叶变换 (FFT)，因为伪谱系数的定义等同于离散傅里叶变换 (DFT)。\n\n对于每个测试案例 $(K,m,n,N)$，算法如下：\n1.  **构建网格和函数值**：为 $j=0, \\dots, N-1$ 创建一个包含 $N$ 个网格点 $x_j = \\frac{2\\pi j}{N}$ 的数组。在此网格上计算乘积函数 $h(x) = \\mathrm{e}^{\\mathrm{i}(m+n)x}$，得到一个值向量 $h_j = h(x_j)$。\n2.  **通过 FFT 计算伪谱系数**：通过对向量 $h_j$ 进行 FFT 并将结果除以 $N$ 来计算可在网格上表示的所有整数波数 $p$（通常 $p \\in \\{0, \\dots, N-1\\}$ 或一个移位的区间）的伪谱系数向量 $\\{a_p^{(N)}\\}$。\n3.  **筛选与求和**：从计算出的完整系数集中，我们只选择对应于已解析谱带的系数，即波数 $k \\in \\{-K, \\dots, K\\}$。从 FFT 输出索引到整数波数的映射由标准库函数（例如 `numpy.fft.fftfreq`）处理。\n4.  **计算误差**：对所选系数的模的平方求和。最终误差 $E$ 是该和的平方根。\n\n这种方法计算效率高，并直接反映了谱方法的基本数学原理。然后将结果格式化为所需的精度。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_aliasing_error(K, m, n, N):\n    \"\"\"\n    Computes the pure aliasing error E(K, m, n, N) for a nonlinear product.\n\n    This function calculates the error introduced by under-integration (aliasing) when\n    computing the spectral coefficients of the product of two complex exponentials,\n    h(x) = exp(i*m*x) * exp(i*n*x), on a periodic domain.\n\n    The error is defined as E = sqrt( sum_{k=-K to K} |a_k^(N) - a_k|^2 ).\n    Given the problem condition |m+n|  K, the exact Galerkin coefficients a_k are 0\n    for all k in the resolved band [-K, K]. The error simplifies to the L2 norm of the\n    pseudospectral coefficients a_k^(N) within that band.\n\n    Args:\n        K (int): The spectral cut-off, defining the resolved wavenumber band [-K, K].\n        m (int): Wavenumber of the first function.\n        n (int): Wavenumber of the second function.\n        N (int): The number of grid points used for pseudospectral computation.\n\n    Returns:\n        float: The computed pure aliasing error E.\n    \"\"\"\n\n    # 1. Define the grid and evaluate the product function h(x) on it.\n    # Grid points are x_j = 2*pi*j / N for j = 0, ..., N-1.\n    j_vals = np.arange(N)\n    \n    # The nonlinear product function is h(x) = exp(i*(m+n)*x).\n    # We evaluate it at each grid point x_j.\n    h_on_grid = np.exp(1j * (m + n) * (2 * np.pi / N) * j_vals)\n\n    # 2. Compute the pseudospectral coefficients a_k^(N) using the Fast Fourier Transform.\n    # The coefficient a_k^(N) is (1/N) times the k-th component of the Discrete\n    # Fourier Transform of the function values on the grid.\n    all_a_coeffs = np.fft.fft(h_on_grid) / N\n\n    # 3. Identify coefficients corresponding to the resolved band [-K, K].\n    # np.fft.fftfreq provides the integer wavenumbers for each element of the FFT output array.\n    # The scaling d=1.0/N ensures the output corresponds to integer wavenumbers k.\n    fft_wavenumbers = np.fft.fftfreq(N, d=1.0 / N)\n\n    # Create a boolean mask to select only wavenumbers k in the resolved band [-K, K].\n    # All test cases satisfy N > 2K, which ensures that each wavenumber k in [-K, K]\n    # maps to a unique index in the FFT output.\n    mask = (-K = fft_wavenumbers)  (fft_wavenumbers = K)\n    \n    # 4. Calculate the L2 norm of the aliased coefficients in the resolved band.\n    # Since the exact coefficients a_k are zero in this band, this norm is the error E.\n    aliased_coeffs_in_band = all_a_coeffs[mask]\n    sum_of_squares = np.sum(np.abs(aliased_coeffs_in_band)**2)\n    error = np.sqrt(sum_of_squares)\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run the suite of test cases and print the results in the specified format.\n    \"\"\"\n    # The test suite consists of four tuples, each containing (K, m, n, N).\n    test_cases = [\n        (8, 8, 8, 17),  # Case 1: Typical aliasing case where m+n=16 and N=17.\n        (8, 8, 8, 25),  # Case 2: A de-aliased case where N > 3K (2/3 rule).\n        (1, 1, 1, 3),   # Case 3: A small-band edge case where N = 3K.\n        (8, 8, 7, 17),  # Case 4: A mixed-frequency case.\n    ]\n\n    results = []\n    for K, m, n, N in test_cases:\n        # Calculate the error for the current set of parameters.\n        error = calculate_aliasing_error(K, m, n, N)\n        # Format the result to exactly twelve decimal places.\n        results.append(f\"{error:.12f}\")\n\n    # Print the final output as a single comma-separated list enclosed in brackets.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}