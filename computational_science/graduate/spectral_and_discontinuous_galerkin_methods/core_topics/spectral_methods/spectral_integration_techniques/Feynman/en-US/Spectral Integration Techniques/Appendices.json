{
    "hands_on_practices": [
        {
            "introduction": "We begin with a fundamental building block of multi-dimensional spectral methods: the tensor-product quadrature. This exercise guides you through calculating a double integral on a reference square element, demonstrating how the efficiency and exactness of one-dimensional Gaussian quadrature can be extended to higher dimensions. By applying the rule and verifying its exactness, you will solidify your understanding of how these powerful integration techniques operate in practice .",
            "id": "3418941",
            "problem": "Consider the reference square element with coordinates $(x,y) \\in [-1,1] \\times [-1,1]$ as used in spectral element methods and discontinuous Galerkin methods. In this context, quadrature rules are employed to perform exact polynomial integration whenever possible. The Gaussian quadrature rule associated with Legendre polynomials, known as Gauss–Legendre Quadrature (GLQ), has the well-tested property of exactness for one-dimensional polynomials up to degree $2N-1$ when $N$ points are used. The tensor-product of one-dimensional GLQ rules is used to construct multidimensional quadrature on tensor-product domains, such as the reference square.\n\nStarting from Fubini’s theorem and the definition of exactness for GLQ, compute the double integral\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\nusing a tensor-product GLQ with $N_x = N_y = 3$ points in each direction. Then verify, in terms of separate one-dimensional rules applied in $x$ and $y$, why the tensor-product GLQ is exact for this integrand. Express the final value of the integral as an exact real number.",
            "solution": "The problem requires the computation of a double integral over the reference square element using a tensor-product Gauss-Legendre Quadrature (GLQ) rule, and a verification of the exactness of the result.\n\nThe integral to be computed is\n$$\nI = \\int_{-1}^{1}\\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\nThe integrand is $f(x,y) = x^3 y^4$. Since the integrand is a separable function of its variables, $f(x,y) = p_x(x) p_y(y)$ where $p_x(x) = x^3$ and $p_y(y) = y^4$, and the domain of integration is a Cartesian product of intervals, we can apply Fubini’s theorem to separate the double integral into a product of two one-dimensional integrals:\n$$\nI = \\left( \\int_{-1}^{1} x^{3} \\, dx \\right) \\left( \\int_{-1}^{1} y^{4} \\, dy \\right)\n$$\nA tensor-product quadrature rule approximates this structure by applying one-dimensional quadrature rules to each integral separately. The general form of a tensor-product quadrature on the reference square is:\n$$\nI \\approx I_{GLQ} = \\sum_{i=1}^{N_y} \\sum_{j=1}^{N_x} w_j w_i f(x_j, y_i)\n$$\nwhere $\\{x_j, w_j\\}_{j=1}^{N_x}$ are the quadrature points and weights in the $x$-direction, and $\\{y_i, w_i\\}_{i=1}^{N_y}$ are the quadrature points and weights in the $y$-direction. Due to the separability of the integrand, this sum can be factored:\n$$\nI_{GLQ} = \\left( \\sum_{j=1}^{N_x} w_j p_x(x_j) \\right) \\left( \\sum_{i=1}^{N_y} w_i p_y(y_i) \\right)\n$$\nThe problem specifies a Gauss-Legendre Quadrature with $N_x = 3$ points in the $x$-direction and $N_y = 3$ points in the $y$-direction. For a $3$-point GLQ ($N=3$), the quadrature points are the roots of the Legendre polynomial of degree $3$, $P_3(z) = \\frac{1}{2}(5z^3 - 3z)$. The roots are $z_1 = -\\sqrt{\\frac{3}{5}}$, $z_2 = 0$, and $z_3 = \\sqrt{\\frac{3}{5}}$.\nThe corresponding weights are $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, and $w_3 = \\frac{5}{9}$.\n\nWe apply this rule to each one-dimensional integral.\n\nFirst, for the integral in the $x$-direction with $p_x(x) = x^3$:\n$$\n\\int_{-1}^{1} x^3 \\, dx \\approx \\sum_{j=1}^{3} w_j x_j^3 = w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3\n$$\nSubstituting the points and weights:\n$$\n\\sum_{j=1}^{3} w_j x_j^3 = \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^3 + \\left(\\frac{8}{9}\\right) (0)^3 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^3\n$$\n$$\n= \\frac{5}{9} \\left(-\\frac{3\\sqrt{3}}{5\\sqrt{5}}\\right) + 0 + \\frac{5}{9} \\left(\\frac{3\\sqrt{3}}{5\\sqrt{5}}\\right) = -\\frac{3\\sqrt{3}}{9\\sqrt{5}} + \\frac{3\\sqrt{3}}{9\\sqrt{5}} = 0\n$$\n\nSecond, for the integral in the $y$-direction with $p_y(y) = y^4$:\n$$\n\\int_{-1}^{1} y^4 \\, dy \\approx \\sum_{i=1}^{3} w_i y_i^4 = w_1 y_1^4 + w_2 y_2^4 + w_3 y_3^4\n$$\nSubstituting the points and weights:\n$$\n\\sum_{i=1}^{3} w_i y_i^4 = \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^4 + \\left(\\frac{8}{9}\\right) (0)^4 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^4\n$$\n$$\n= \\frac{5}{9} \\left(\\frac{9}{25}\\right) + 0 + \\frac{5}{9} \\left(\\frac{9}{25}\\right) = 2 \\left(\\frac{5 \\cdot 9}{9 \\cdot 25}\\right) = 2 \\left(\\frac{5}{25}\\right) = \\frac{2}{5}\n$$\n\nThe value of the double integral computed by the tensor-product GLQ is the product of these two results:\n$$\nI_{GLQ} = (0) \\times \\left(\\frac{2}{5}\\right) = 0\n$$\n\nNext, we verify the exactness of this result. The one-dimensional Gauss-Legendre Quadrature rule with $N$ points is exact for any polynomial of degree up to $2N-1$.\n\nFor the $x$-direction, we used $N_x = 3$ points to integrate the polynomial $p_x(x) = x^3$. The degree of this polynomial is $d_x = 3$. The rule is exact for polynomials of degree up to $2N_x - 1 = 2(3) - 1 = 5$. Since $d_x = 3 \\le 5$, the quadrature for the $x$-integral is exact. The exact value is $\\int_{-1}^{1} x^3 \\, dx = \\left[\\frac{x^4}{4}\\right]_{-1}^{1} = \\frac{1}{4} - \\frac{1}{4} = 0$, which matches the quadrature result.\n\nFor the $y$-direction, we used $N_y = 3$ points to integrate the polynomial $p_y(y) = y^4$. The degree of this polynomial is $d_y = 4$. The rule is exact for polynomials of degree up to $2N_y - 1 = 2(3) - 1 = 5$. Since $d_y = 4 \\le 5$, the quadrature for the $y$-integral is also exact. The exact value is $\\int_{-1}^{1} y^4 \\, dy = \\left[\\frac{y^5}{5}\\right]_{-1}^{1} = \\frac{1}{5} - \\frac{-1}{5} = \\frac{2}{5}$, which matches the quadrature result.\n\nSince the tensor-product GLQ is equivalent to the product of two one-dimensional GLQ evaluations, and each one-dimensional evaluation was exact for its respective polynomial factor, the final result is exact. The exact value of the double integral is the product of the exact values of the one-dimensional integrals:\n$$\nI_{exact} = \\left( \\int_{-1}^{1} x^{3} \\, dx \\right) \\left( \\int_{-1}^{1} y^{4} \\, dy \\right) = (0) \\times \\left(\\frac{2}{5}\\right) = 0\n$$\nThis confirms that the value $I_{GLQ} = 0$ is the exact value of the integral.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Numerical integration is not an abstract exercise; it's a critical step in solving differential equations with methods like the discontinuous Galerkin (DG) method. This practice connects the theory of quadrature exactness to the assembly of the element mass and stiffness matrices, whose entries are defined by integrals like $M_{ij} = \\int \\phi_{i} \\phi_{j} \\,dx$ and $K_{ij} = \\int \\phi_{i}' \\phi_{j}' \\,dx$. You will derive the minimum number of quadrature points required to ensure these fundamental matrices are computed without error, a crucial consideration for accuracy and stability .",
            "id": "3418922",
            "problem": "Consider a one-dimensional discontinuous Galerkin (DG) discretization on the reference element $\\left[-1,1\\right]$ using a polynomial approximation space of degree at most $p \\in \\mathbb{N}_{0}$. Let $\\{\\phi_{i}(x)\\}_{i=0}^{p}$ be any basis spanning this space. The element mass matrix and the (volume) stiffness matrix are defined by the bilinear forms\n$$\nM_{ij} \\equiv \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x, \n\\qquad\nK_{ij} \\equiv \\int_{-1}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,\\mathrm{d}x.\n$$\nAssume that the numerical integration is performed using either standard Gaussian (Gauss–Legendre) quadrature with $N$ interior points or Gauss–Lobatto–Legendre quadrature with $N$ points including the endpoints. Starting only from the following fundamental bases:\n- the degree properties of products and derivatives of polynomials,\n- the definition of exactness of a quadrature rule for polynomials,\nderive the minimal number of quadrature points $N$ needed by each quadrature rule to compute the mass matrix entries $M_{ij}$ exactly for all $i,j \\in \\{0,\\dots,p\\}$. Then, using the same reasoning, determine the minimal $N$ sufficient to compute the (volume) stiffness matrix entries $K_{ij}$ exactly, and explain the implications for stiffness matrix accuracy when one chooses $N$ that guarantees exactness of the mass matrix.\n\nProvide your final answer as the pair $\\left(N_{\\text{Gauss}},\\,N_{\\text{Gauss–Lobatto}}\\right)$ for mass-matrix exactness, expressed symbolically in terms of $p$, in a single row matrix using $\\texttt{pmatrix}$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the minimal number of quadrature points, $N$, for two types of quadrature rules to exactly compute the mass and stiffness matrices in a discontinuous Galerkin framework on a reference element. The solution will be derived from first principles regarding polynomial degrees and quadrature rule exactness.\n\nLet $\\mathcal{P}_k$ denote the space of polynomials of degree at most $k$. The problem states that the approximation space is the set of polynomials of degree at most $p$, where $p \\in \\mathbb{N}_0 = \\{0, 1, 2, \\dots\\}$. The basis functions $\\{\\phi_i(x)\\}_{i=0}^{p}$ span this space, so each $\\phi_i(x) \\in \\mathcal{P}_p$.\n\nThe fundamental properties we will use are:\n1.  **Degree of a product**: If $f(x) \\in \\mathcal{P}_{d_1}$ and $g(x) \\in \\mathcal{P}_{d_2}$, their product $f(x)g(x)$ is a polynomial in $\\mathcal{P}_{d_1+d_2}$.\n2.  **Degree of a derivative**: If $f(x) \\in \\mathcal{P}_d$ with $d \\ge 1$, its derivative $f'(x)$ is a polynomial in $\\mathcal{P}_{d-1}$. If $f(x) \\in \\mathcal{P}_0$ (a constant), then $f'(x) = 0$.\n3.  **Exactness of Gaussian quadrature**: A standard Gauss-Legendre quadrature rule with $N$ points is exact for any polynomial of degree at most $2N-1$.\n4.  **Exactness of Gauss-Lobatto-Legendre quadrature**: A Gauss-Lobatto-Legendre quadrature rule with $N$ points is exact for any polynomial of degree at most $2N-3$.\n\n**Part 1: Exact Integration of the Mass Matrix ($M_{ij}$)**\n\nThe entries of the mass matrix are defined by the integral $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,\\mathrm{d}x$. The integrand is the product $\\phi_{i}(x)\\phi_{j}(x)$.\nSince $\\phi_i(x) \\in \\mathcal{P}_p$ and $\\phi_j(x) \\in \\mathcal{P}_p$, their product is a polynomial. The maximum degree of this product occurs when both basis functions have the maximal degree $p$. In this case, the degree of the integrand is $p+p=2p$. Therefore, to compute all entries $M_{ij}$ exactly, the quadrature rule must be exact for all polynomials of degree up to $2p$.\n\n*   **For Gauss-Legendre quadrature:**\n    We require the rule to be exact for polynomials of degree at most $2p$. The condition is:\n    $$2N - 1 \\ge 2p$$\n    Solving for $N$ gives:\n    $$2N \\ge 2p + 1 \\implies N \\ge p + \\frac{1}{2}$$\n    Since the number of quadrature points $N$ must be an integer, the minimal number of points is $N_{\\text{Gauss}} = \\lceil p + \\frac{1}{2} \\rceil = p+1$.\n\n*   **For Gauss-Lobatto-Legendre quadrature:**\n    We again require the rule to be exact for polynomials of degree at most $2p$. The condition is:\n    $$2N - 3 \\ge 2p$$\n    Solving for $N$ gives:\n    $$2N \\ge 2p + 3 \\implies N \\ge p + \\frac{3}{2}$$\n    Since $N$ must be an integer, the minimal number of points is $N_{\\text{Gauss-Lobatto}} = \\lceil p + \\frac{3}{2} \\rceil = p+2$.\n\n**Part 2: Exact Integration of the Stiffness Matrix ($K_{ij}$)**\n\nThe entries of the stiffness matrix are defined by $K_{ij} = \\int_{-1}^{1} \\phi_{i}'(x)\\,\\phi_{j}'(x)\\,\\mathrm{d}x$. The integrand is the product $\\phi_{i}'(x)\\phi_{j}'(x)$.\nSince $\\phi_i(x) \\in \\mathcal{P}_p$, its derivative $\\phi_i'(x)$ is a polynomial of degree at most $p-1$. Similarly, $\\phi_j'(x) \\in \\mathcal{P}_{p-1}$. This holds for $p \\ge 1$. If $p=0$, the basis functions are constants, and their derivatives are zero, making the integrand identically zero.\nFor $p \\ge 1$, the product $\\phi_i'(x)\\phi_j'(x)$ is a polynomial of degree at most $(p-1)+(p-1) = 2p-2$. For $p=0$, the integrand is the zero polynomial, which has a degree of $-\\infty$. The integral of zero is zero, and any quadrature rule with at least one point ($N \\ge 1$) will compute this exactly.\nThus, the quadrature rule must be exact for polynomials of degree up to $2p-2$ if $p \\ge 1$, and for the zero polynomial if $p=0$.\n\n*   **For Gauss-Legendre quadrature:**\n    For $p \\ge 1$, we require exactness up to degree $2p-2$:\n    $$2N - 1 \\ge 2p - 2 \\implies 2N \\ge 2p - 1 \\implies N \\ge p - \\frac{1}{2}$$\n    The minimal integer is $N=p$.\n    For $p=0$, we need $N \\ge 1$. The formula $N=p$ gives $N=0$, which is not a valid number of points.\n    Therefore, the minimal number of points is $N=1$ for $p=0$, and $N=p$ for $p \\ge 1$. This can be written compactly as $N_{\\text{Gauss, stiff}} = \\max(1, p)$.\n\n*   **For Gauss-Lobatto-Legendre quadrature:**\n    For $p \\ge 1$, we require exactness up to degree $2p-2$:\n    $$2N - 3 \\ge 2p - 2 \\implies 2N \\ge 2p + 1 \\implies N \\ge p + \\frac{1}{2}$$\n    The minimal integer is $N=p+1$.\n    For $p=0$, the minimal $N$ is $1$. The formula $N=p+1$ gives $N=1$, so it holds for $p=0$ as well.\n    Thus, the minimal number of points is $N_{\\text{Gauss-Lobatto, stiff}} = p+1$ for all $p \\in \\mathbb{N}_0$.\n\n**Part 3: Implications for Stiffness Matrix Accuracy**\n\nThe problem asks for the implication on the stiffness matrix computation if one chooses $N$ to guarantee exactness of the mass matrix.\n\n*   **Using Gauss-Legendre:**\n    We choose $N = p+1$ to exactly integrate the mass matrix. With this choice, the quadrature is exact for polynomials of degree up to $2(p+1) - 1 = 2p+1$. The stiffness matrix integrand has a maximum degree of $2p-2$. Since $2p+1 \\ge 2p-2$ for all $p \\ge 0$ (the inequality is $3 \\ge 0$), the quadrature rule is more than sufficient to integrate the stiffness matrix integrand exactly.\n\n*   **Using Gauss-Lobatto-Legendre:**\n    We choose $N = p+2$ to exactly integrate the mass matrix. This rule is exact for polynomials of degree up to $2(p+2) - 3 = 2p+1$. Again, the stiffness matrix integrand has a maximum degree of $2p-2$. Since $2p+1 \\ge 2p-2$ for all $p \\ge 0$, this choice of $N$ also guarantees the exact integration of the stiffness matrix.\n\n**Conclusion:**\nIn both cases (Gauss-Legendre and Gauss-Lobatto-Legendre), selecting the minimal number of quadrature points $N$ required for exact integration of the mass matrix automatically ensures that the (volume) stiffness matrix is also computed exactly. This is because the polynomial degree of the integrand for the mass matrix ($2p$) is always greater than the polynomial degree of the integrand for the stiffness matrix ($2p-2$). The final answer is the pair of minimal points for mass-matrix exactness.\nFor Gauss-Legendre, $N_{\\text{Gauss}} = p+1$.\nFor Gauss-Lobatto-Legendre, $N_{\\text{Gauss-Lobatto}} = p+2$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np+1 & p+2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While spectral quadrature excels at integrating polynomials, real-world simulations often involve nonlinearities and complex geometric mappings that break the ideal conditions for exactness. This practice presents a computational experiment to investigate the subtle but critical issue of aliasing error, which arises when different parameterizations are used for a shared interface in a discontinuous Galerkin method. You will quantify the resulting break in numerical conservation and explore how techniques like overintegration can be used to mitigate the error, providing insight into the robustness required for industrial-grade codes .",
            "id": "3418934",
            "problem": "Consider a two-dimensional scalar conservation law with a nonlinear flux in the $x$-direction, governed by the partial differential equation $\\partial_t u + \\partial_x f(u) = 0$ on a domain partitioned into two quadrilateral elements that share a straight vertical interior face located at $x = 0.5$ with $y \\in [0,1]$. Let the interior face be parameterized by a reference coordinate $\\eta \\in [-1,1]$ on each adjoining element. The left element parameterizes the face as $y_L(\\eta) = \\frac{1}{2}(\\eta+1)$, while the right element parameterizes the same physical face as $y_R(\\eta) = \\frac{1}{8}(\\eta+1)^3$. For each element, the face measure mapping factor is given by $\\frac{d y_{\\bullet}}{d \\eta}$, where the subscript $\\bullet$ denotes $L$ or $R$.\n\nLet the state be a polynomial field $u(x,y) = x^2 + \\frac{1}{2} x y + \\frac{1}{5} y^3$ and consider the nonlinear flux $f(u) = \\frac{u^2}{2}$. The exact face integral of the mass flux (for the constant test function) is invariant under reparameterization and can be written in either physical or reference coordinates as\n$$\n\\int_{0}^{1} f\\big(u(0.5,y)\\big)\\,dy \\;=\\; \\int_{-1}^{1} f\\big(u(0.5,y_L(\\eta))\\big)\\,\\frac{d y_L}{d \\eta}(\\eta)\\,d\\eta \\;=\\; \\int_{-1}^{1} f\\big(u(0.5,y_R(\\eta))\\big)\\,\\frac{d y_R}{d \\eta}(\\eta)\\,d\\eta.\n$$\nIn a Discontinuous Galerkin (DG) setting, face integrals are computed by quadrature. If each element independently integrates the face flux with an underresolved quadrature in its own reference parameter $\\eta$, the two discrete integrals may not agree due to aliasing induced by the nonlinear flux composition with distinct parameterizations, thereby breaking discrete conservation across the shared face. Two remedies are commonly used: overintegration (using sufficiently high quadrature order) and modal projection onto a common trace space on the physical face.\n\nYour task is to:\n- Implement Gauss–Legendre quadrature in the reference coordinate $\\eta$ to approximate face integrals independently on the left and right parameterizations:\n$$\nI_L(Q) \\;=\\; \\sum_{i=1}^{Q} w_i\\, f\\big(u(0.5,y_L(\\eta_i))\\big)\\,\\left.\\frac{d y_L}{d \\eta}\\right|_{\\eta=\\eta_i}, \\quad\nI_R(Q) \\;=\\; \\sum_{i=1}^{Q} w_i\\, f\\big(u(0.5,y_R(\\eta_i))\\big)\\,\\left.\\frac{d y_R}{d \\eta}\\right|_{\\eta=\\eta_i},\n$$\nwhere $\\{(\\eta_i,w_i)\\}_{i=1}^{Q}$ are the $Q$-point Gauss–Legendre nodes and weights on $[-1,1]$.\n- Quantify the conservation error for a given $Q$ as the absolute discrepancy\n$$\nE(Q) \\;=\\; \\big|\\, I_L(Q) - I_R(Q) \\,\\big|.\n$$\n- Demonstrate overintegration by increasing $Q$ and report the corresponding conservation error.\n- Demonstrate modal projection on the physical face: define the Legendre polynomial basis $\\{L_k(t)\\}_{k=0}^{P}$ on $t \\in [-1,1]$ and the physical coordinate mapping $t = 2y - 1$. Project the nonlinear flux trace $g(y) = f(u(0.5,y))$ onto degree $P$ via the $L^2$ inner product on $y \\in [0,1]$,\n$$\nc_k \\;=\\; \\frac{\\int_{0}^{1} g(y)\\,L_k(2y-1)\\,dy}{\\int_{0}^{1} \\big(L_k(2y-1)\\big)^2\\,dy}, \\quad k=0,1,\\dots,P,\n$$\nand use the identity\n$$\n\\int_{0}^{1} \\sum_{k=0}^{P} c_k\\,L_k(2y-1)\\,dy \\;=\\; c_0,\n$$\nto define a parameterization-invariant corrected face flux integral $I_{\\text{proj}} = c_0$. Report the conservation error after modal projection as\n$$\nE_{\\text{proj}} \\;=\\; \\big|\\, I_{\\text{proj}} - I_{\\text{proj}} \\,\\big| \\;=\\; 0,\n$$\nwhich reflects the use of a single common trace and exact integration of the constant mode.\n\nUse the following test suite to exercise the algorithm:\n- Test $1$: Underresolved quadrature with $Q=2$ using $y_L(\\eta)=\\frac{1}{2}(\\eta+1)$ and $y_R(\\eta)=\\frac{1}{8}(\\eta+1)^3$. Output $E(Q)$ as a float.\n- Test $2$: Underresolved quadrature with $Q=3$ using the same parameterizations. Output $E(Q)$ as a float.\n- Test $3$: Overintegration with $Q=30$ using the same parameterizations. Output $E(Q)$ as a float.\n- Test $4$: Modal projection with degree $P=6$ computed by high-order physical quadrature on $y \\in [0,1]$ to evaluate $c_0$; report $E_{\\text{proj}}$ as a float.\n- Test $5$: Boundary case with matching parameterizations on both sides $y_L(\\eta)=y_R(\\eta)=\\frac{1}{2}(\\eta+1)$ and $Q=2$; output $E(Q)$ as a float.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the float result for the corresponding test case. No physical units are involved in this problem, and angles do not appear.",
            "solution": "The problem is validated as scientifically sound, well-posed, and objective. It presents a canonical issue in Discontinuous Galerkin (DG) methods: the loss of discrete conservation for nonlinear problems when elements sharing a common face use different parameterizations for that face. We will proceed with a full solution.\n\nThe core of the problem lies in the numerical approximation of a face integral for a nonlinear flux. The exact integral, expressed in physical coordinates $y$ over the face at $x = 0.5$, is given by:\n$$\nI_{\\text{exact}} = \\int_{0}^{1} f\\big(u(0.5,y)\\big)\\,dy\n$$\nwhere the state $u$ and flux $f(u)$ are defined as:\n$$\nu(x,y) = x^2 + \\frac{1}{2} x y + \\frac{1}{5} y^3\n$$\n$$\nf(u) = \\frac{u^2}{2}\n$$\nAt the face where $x=0.5$, the state simplifies to a function of $y$ only:\n$$\nu(0.5,y) = (0.5)^2 + \\frac{1}{2}(0.5)y + \\frac{1}{5}y^3 = 0.25 + 0.25y + 0.2y^3\n$$\nThe flux on the face is therefore $g(y) = f(u(0.5,y))$.\n\nIn a DG framework, integrals are computed on a standard reference element, typically over the interval $\\eta \\in [-1,1]$. This requires a mapping from the physical coordinate $y$ to the reference coordinate $\\eta$. The problem specifies two different mappings for the left ($L$) and right ($R$) elements adjoining the face:\n$$\ny_L(\\eta) = \\frac{1}{2}(\\eta+1)\n$$\n$$\ny_R(\\eta) = \\frac{1}{8}(\\eta+1)^3\n$$\nThe change of variables rule for integration states that $\\int_a^b h(y)\\,dy = \\int_c^d h(y(\\eta)) \\frac{dy}{d\\eta}\\,d\\eta$. Thus, the exact integral can be expressed using either parameterization:\n$$\nI_{\\text{exact}} = \\int_{-1}^{1} g(y_L(\\eta)) \\frac{dy_L}{d\\eta}(\\eta)\\,d\\eta = \\int_{-1}^{1} g(y_R(\\eta)) \\frac{dy_R}{d\\eta}(\\eta)\\,d\\eta\n$$\nThe terms $\\frac{dy}{d\\eta}$ are the face measure mapping factors (Jacobians):\n$$\n\\frac{dy_L}{d\\eta} = \\frac{1}{2}\n$$\n$$\n\\frac{dy_R}{d\\eta} = \\frac{3}{8}(\\eta+1)^2\n$$\nThe integrands in the reference coordinate $\\eta$ are distinct functions:\n$$\n\\text{Integrand}_L(\\eta) = f\\big(u(0.5, y_L(\\eta))\\big) \\cdot \\frac{1}{2}\n$$\n$$\n\\text{Integrand}_R(\\eta) = f\\big(u(0.5, y_R(\\eta))\\big) \\cdot \\frac{3}{8}(\\eta+1)^2\n$$\nThe polynomial degree of these integrands is different. The state $u$ is cubic in $y$.\nFor the left element, $y_L$ is linear in $\\eta$, so $u(0.5, y_L(\\eta))$ is cubic in $\\eta$. The flux $f(u) \\propto u^2$ makes the overall expression $f(u(0.5, y_L(\\eta)))$ a polynomial of degree $2 \\times 3 = 6$ in $\\eta$. The integrand, being multiplied by a constant Jacobian, is also of degree $6$.\nFor the right element, $y_R$ is cubic in $\\eta$, so $u(0.5, y_R(\\eta))$ is of degree $3 \\times 3 = 9$ in $\\eta$. The flux $f(u)$ is then of degree $2 \\times 9 = 18$. The integrand, multiplied by the quadratic Jacobian, becomes a polynomial of degree $18 + 2 = 20$ in $\\eta$.\n\nThe DG method approximates the reference-space integrals using $Q$-point Gauss-Legendre quadrature:\n$$\nI_L(Q) = \\sum_{i=1}^{Q} w_i\\, f\\big(u(0.5,y_L(\\eta_i))\\big)\\,\\left.\\frac{d y_L}{d \\eta}\\right|_{\\eta=\\eta_i}\n$$\n$$\nI_R(Q) = \\sum_{i=1}^{Q} w_i\\, f\\big(u(0.5,y_R(\\eta_i))\\big)\\,\\left.\\frac{d y_R}{d \\eta}\\right|_{\\eta=\\eta_i}\n$$\nA $Q$-point Gauss-Legendre rule integrates polynomials of degree up to $2Q-1$ exactly. If $Q$ is too small (underresolved quadrature), the quadrature sum is not equal to the true integral value. Since the integrands for the left and right elements are different polynomials, there is no guarantee that the numerical results $I_L(Q)$ and $I_R(Q)$ will be equal. This discrepancy, $E(Q) = |I_L(Q) - I_R(Q)|$, represents a violation of discrete flux conservation.\n\nWe will now perform the calculations for the specified test cases.\n\n**Test 1: Underresolved quadrature with $Q=2$**\nA $2$-point quadrature is exact for polynomials of degree up to $2(2)-1 = 3$. This is insufficient for either the degree-$6$ (left) or degree-$20$ (right) integrand. We expect a non-zero conservation error $E(2)$.\n\n**Test 2: Underresolved quadrature with $Q=3$**\nA $3$-point quadrature is exact for polynomials of degree up to $2(3)-1 = 5$. This is still insufficient. We expect a non-zero error $E(3)$, likely smaller than $E(2)$ as the quadrature approximation improves.\n\n**Test 3: Overintegration with $Q=30$**\nA $30$-point quadrature integrates polynomials of degree up to $2(30)-1 = 59$ exactly. This is sufficient to exactly integrate both the degree-$6$ and degree-$20$ polynomial integrands. In floating-point arithmetic, both $I_L(30)$ and $I_R(30)$ will be extremely accurate approximations of $I_{\\text{exact}}$, and thus their difference $E(30)$ will be close to machine precision zero.\n\n**Test 4: Modal projection**\nThis method bypasses the issue of differing parameterizations by defining a single, unique representation of the flux trace on the physical face $y \\in [0,1]$. The flux trace $g(y) = f(u(0.5,y))$ is projected onto a common basis, here Legendre polynomials $\\{L_k(2y-1)\\}$, up to degree $P$. The total flux is the integral of the projected function. Due to the orthogonality of the basis, this integral is simply the zeroth modal coefficient, $c_0$:\n$$\nI_{\\text{proj}} = \\int_{0}^{1} \\left(\\sum_{k=0}^{P} c_k L_k(2y-1)\\right) dy = c_0 \\int_0^1 L_0(2y-1) dy = c_0\n$$\nSince both elements use this same, uniquely defined value for the integral, the conservation error is by definition zero: $E_{\\text{proj}} = |I_{\\text{proj}} - I_{\\text{proj}}| = 0$. The problem asks to report this conceptual result.\n\n**Test 5: Matching parameterizations**\nThis is a control case where $y_L(\\eta) = y_R(\\eta) = \\frac{1}{2}(\\eta+1)$. Since both the parameterizations and their Jacobians are identical, the integrands $\\text{Integrand}_L(\\eta)$ and $\\text{Integrand}_R(\\eta)$ are identical functions. When the same quadrature rule with $Q=2$ is applied to identical functions, the resulting numerical values $I_L(2)$ and $I_R(2)$ must be identical. Therefore, the conservation error $E(2)$ will be zero.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No functions from scipy are ultimately required for the specified tasks.\n\ndef solve():\n    \"\"\"\n    Computes conservation errors for face integrals in a DG setting with\n    mismatched and matched face parameterizations.\n    \"\"\"\n\n    # Define the state and flux functions as per the problem statement.\n    # State u is evaluated at the interface x = 0.5.\n    u_face = lambda y: 0.25 + 0.25 * y + 0.2 * y**3\n    # Nonlinear flux f(u)\n    f_flux = lambda u: 0.5 * u**2\n\n    def compute_integral(Q, y_param_func, dy_deta_func):\n        \"\"\"\n        Computes the face integral using Q-point Gauss-Legendre quadrature.\n        \n        Args:\n            Q (int): Number of quadrature points.\n            y_param_func (callable): Face parameterization y(eta).\n            dy_deta_func (callable): Jacobian of the parameterization dy/deta.\n            \n        Returns:\n            float: The approximate integral value.\n        \"\"\"\n        if Q == 0:\n            return 0.0\n        \n        # Get Q-point Gauss-Legendre nodes (eta_i) and weights (w_i) on [-1, 1]\n        eta_i, w_i = np.polynomial.legendre.leggauss(Q)\n        \n        # Map reference coordinates eta_i to physical coordinates y_i\n        y_i = y_param_func(eta_i)\n        \n        # Evaluate state and then flux at quadrature points\n        u_vals = u_face(y_i)\n        f_vals = f_flux(u_vals)\n        \n        # Evaluate the Jacobian at the quadrature nodes\n        jacobian_vals = dy_deta_func(eta_i)\n        \n        # The integrand is f(u(y(eta))) * dy/deta\n        integrand_vals = f_vals * jacobian_vals\n        \n        # Compute the integral by summing weighted integrand values\n        integral = np.sum(w_i * integrand_vals)\n        \n        return integral\n\n    results = []\n\n    # --- Test 1: Underresolved quadrature with Q=2 ---\n    Q1 = 2\n    y_L = lambda eta: 0.5 * (eta + 1)\n    dyL_deta = lambda eta: 0.5 * np.ones_like(np.atleast_1d(eta))\n    y_R = lambda eta: 1/8 * (eta + 1)**3\n    dyR_deta = lambda eta: 3/8 * (eta + 1)**2\n    \n    I_L1 = compute_integral(Q1, y_L, dyL_deta)\n    I_R1 = compute_integral(Q1, y_R, dyR_deta)\n    E1 = abs(I_L1 - I_R1)\n    results.append(E1)\n    \n    # --- Test 2: Underresolved quadrature with Q=3 ---\n    Q2 = 3\n    I_L2 = compute_integral(Q2, y_L, dyL_deta)\n    I_R2 = compute_integral(Q2, y_R, dyR_deta)\n    E2 = abs(I_L2 - I_R2)\n    results.append(E2)\n    \n    # --- Test 3: Overintegration with Q=30 ---\n    Q3 = 30\n    I_L3 = compute_integral(Q3, y_L, dyL_deta)\n    I_R3 = compute_integral(Q3, y_R, dyR_deta)\n    E3 = abs(I_L3 - I_R3)\n    results.append(E3)\n\n    # --- Test 4: Modal projection ---\n    # The problem defines the error for modal projection as |I_proj - I_proj|,\n    # which is conceptually zero as both elements use the same value.\n    E_proj = 0.0\n    results.append(E_proj)\n    \n    # --- Test 5: Matching parameterizations with Q=2 ---\n    Q5 = 2\n    y_match = lambda eta: 0.5 * (eta + 1)\n    dy_match_deta = lambda eta: 0.5 * np.ones_like(np.atleast_1d(eta))\n    \n    # Both integrals are calculated with identical functions and quadrature.\n    I_L5 = compute_integral(Q5, y_match, dy_match_deta)\n    I_R5 = compute_integral(Q5, y_match, dy_match_deta)\n    E5 = abs(I_L5 - I_R5)\n    results.append(E5)\n    \n    # Print the final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}