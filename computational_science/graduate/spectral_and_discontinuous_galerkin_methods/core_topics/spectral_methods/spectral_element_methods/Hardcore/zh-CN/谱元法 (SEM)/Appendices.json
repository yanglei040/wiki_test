{
    "hands_on_practices": [
        {
            "introduction": "在单个谱元内部，解的多项式逼近可以用不同但等价的方式表示。两种最常见的基是基于勒让德多项式等正交多项式的模态基，以及基于高斯-洛巴托-勒让德 (GLL) 等插值节点的节点基。本练习将通过推导连接这两种表示的变换矩阵，帮助您巩固对谱元方法核心构件的理解。",
            "id": "3417899",
            "problem": "考虑在参考区间 $[-1,1]$ 上、多项式次数为 $p$ 的一维谱元表示。设 $\\{P_{k}(x)\\}_{k=0}^{p}$ 表示经典的 Legendre 多项式，它们由递推关系和在 $[-1,1]$ 上关于单位权重的正交性所定义，并被归一化以使得 $P_{0}(x)=1$，$P_{1}(x)=x$，$P_{2}(x)=\\frac{1}{2}(3x^{2}-1)$ 以及 $P_{3}(x)=\\frac{1}{2}(5x^{3}-3x)$。设 $\\{x_{i}\\}_{i=0}^{p}$ 表示 Gauss–Lobatto–Legendre (GLL) 节点，其定义为端点 $x_{0}=-1$ 和 $x_{p}=1$ 以及作为 $P_{p}'(x)$ 的 $p-1$ 个不同根的内点。设 $\\{\\ell_{i}(x)\\}_{i=0}^{p}$ 表示在 GLL 节点上的 Lagrange 基多项式，即对于所有的 $i,j$ 都有 $\\ell_{i}(x_{j})=\\delta_{ij}$。\n\n一个次数至多为 $p$ 的多项式 $u(x)$ 可以用模态 Legendre 展开 $u(x)=\\sum_{k=0}^{p} a_{k} P_{k}(x)$ 表示，其中 $\\{a_{k}\\}$ 为模态系数；或者用节点 Lagrange 形式 $u(x)=\\sum_{i=0}^{p} u_{i} \\ell_{i}(x)$ 表示，其中 $u_{i}=u(x_{i})$ 是在 GLL 节点上的节点值。从 Legendre 多项式和 Lagrange 插值的基本定义出发，推导将模态 Legendre 系数 $\\{a_{k}\\}_{k=0}^{p}$ 映射到 GLL 节点上的节点 Lagrange 值 $\\{u_{i}\\}_{i=0}^{p}$ 的线性变换。然后，对于 $[-1,1]$ 上 $p=3$ 的情况，通过确定矩阵的每个元素的精确形式来显式计算该变换矩阵。\n\n你的最终答案必须是 $p=3$ 时的 $4\\times 4$ 变换矩阵，以包含精确有理数值和根式值的闭合形式写出。不要求也不允许进行四舍五入。",
            "solution": "用户提供的问题陈述已经过分析，并被认为是有效的。它在科学上基于正交多项式和数值分析的数学理论，是适定的，具有唯一且有意义的解，并以客观、正式的语言表述。该问题是自洽的，没有矛盾或歧义。\n\n目标是推导将多项式 $u(x)$ 的模态 Legendre 系数 $\\{a_{k}\\}_{k=0}^{p}$ 映射到其在 Gauss-Lobatto-Legendre (GLL) 节点上的节点值 $\\{u_{i}\\}_{i=0}^{p}$ 的线性变换。然后，我们必须为多项式次数为 $p=3$ 的情况显式计算这个变换矩阵。\n\n设 $u(x)$ 是一个次数至多为 $p$ 的多项式。其在 Legendre 基中的模态表示为\n$$u(x) = \\sum_{k=0}^{p} a_{k} P_{k}(x)$$\n其中 $\\{a_{k}\\}_{k=0}^{p}$ 是模态系数，$\\{P_{k}(x)\\}_{k=0}^{p}$ 是 Legendre 多项式。\n\n同一多项式的节点表示为\n$$u(x) = \\sum_{j=0}^{p} u_{j} \\ell_{j}(x)$$\n其中 $\\{u_{j}\\}_{j=0}^{p}$ 是在 GLL 节点 $\\{x_{j}\\}_{j=0}^{p}$ 上的节点值，即 $u_{j} = u(x_{j})$，而 $\\{\\ell_{j}(x)\\}_{j=0}^{p}$ 是满足 $\\ell_{j}(x_{i}) = \\delta_{ij}$ 的 Lagrange 基多项式。\n\n为了找到模态系数 $\\{a_{k}\\}$ 和节点值 $\\{u_{i}\\}$ 之间的关系，我们在每个 GLL 节点 $x_{i}$（其中 $i=0, 1, \\dots, p$）处对模态表示进行求值：\n$$u_{i} = u(x_{i}) = \\sum_{k=0}^{p} a_{k} P_{k}(x_{i})$$\n该方程提供了一个包含 $p+1$ 个线性方程的方程组，关联了节点值与模态系数。我们可以将这个方程组表示为矩阵形式。设 $\\mathbf{u}$ 为节点值的列向量，$\\mathbf{a}$ 为模态系数的列向量：\n$$\\mathbf{u} = \\begin{pmatrix} u_0 \\\\ u_1 \\\\ \\vdots \\\\ u_p \\end{pmatrix}, \\quad \\mathbf{a} = \\begin{pmatrix} a_0 \\\\ a_1 \\\\ \\vdots \\\\ a_p \\end{pmatrix}$$\n线性变换由 $\\mathbf{u} = T \\mathbf{a}$ 给出，其中 $T$ 是一个 $(p+1) \\times (p+1)$ 的变换矩阵。从求和式中，我们可以确定该矩阵的元素。第 $i$ 个节点值的方程为：\n$$u_i = P_{0}(x_i)a_0 + P_{1}(x_i)a_1 + \\dots + P_{p}(x_i)a_p$$\n因此，矩阵 $T$ 的第 $i$ 行第 $k$ 列的元素（行和列都使用从 0 开始的索引）由下式给出：\n$$T_{ik} = P_{k}(x_{i})$$\n\n现在，我们将为 $p=3$ 的情况显式计算这个矩阵。该矩阵将是一个 $4 \\times 4$ 矩阵，其索引 $i, k$ 的范围为 0 到 3。\n\n首先，我们必须确定 GLL 节点 $\\{x_i\\}_{i=0}^3$。根据定义，这些节点是区间 $[-1, 1]$ 的端点以及 $P_3(x)$ 导数的根。\nLegendre 多项式如下：\n$P_0(x) = 1$\n$P_1(x) = x$\n$P_2(x) = \\frac{1}{2}(3x^2 - 1)$\n$P_3(x) = \\frac{1}{2}(5x^3 - 3x)$\n\n$P_3(x)$ 的导数是：\n$$P_3'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}(5x^3 - 3x)\\right) = \\frac{1}{2}(15x^2 - 3)$$\n令 $P_3'(x) = 0$ 来寻找内部 GLL 节点：\n$$\\frac{1}{2}(15x^2 - 3) = 0 \\implies 15x^2 = 3 \\implies x^2 = \\frac{3}{15} = \\frac{1}{5}$$\n根为 $x = \\pm \\frac{1}{\\sqrt{5}} = \\pm \\frac{\\sqrt{5}}{5}$。\nGLL 节点集从小到大排序为：\n$x_0 = -1$\n$x_1 = -\\frac{\\sqrt{5}}{5}$\n$x_2 = \\frac{\\sqrt{5}}{5}$\n$x_3 = 1$\n\n接下来，我们通过计算 $P_k(x_i)$（其中 $k, i \\in \\{0, 1, 2, 3\\}$）来构造变换矩阵 $T$。\n$$\nT = \\begin{pmatrix}\nP_0(x_0)  P_1(x_0)  P_2(x_0)  P_3(x_0) \\\\\nP_0(x_1)  P_1(x_1)  P_2(x_1)  P_3(x_1) \\\\\nP_0(x_2)  P_1(x_2)  P_2(x_2)  P_3(x_2) \\\\\nP_0(x_3)  P_1(x_3)  P_2(x_3)  P_3(x_3)\n\\end{pmatrix}\n$$\n\n让我们计算每一行的元素：\n\n第 1 行：$x_0 = -1$。使用一般性质 $P_k(-1) = (-1)^k$：\n$T_{00} = P_0(-1) = 1$\n$T_{01} = P_1(-1) = -1$\n$T_{02} = P_2(-1) = 1$\n$T_{03} = P_3(-1) = -1$\n\n第 2 行：$x_1 = -\\frac{\\sqrt{5}}{5}$。\n$T_{10} = P_0(-\\frac{\\sqrt{5}}{5}) = 1$\n$T_{11} = P_1(-\\frac{\\sqrt{5}}{5}) = -\\frac{\\sqrt{5}}{5}$\n$T_{12} = P_2(-\\frac{\\sqrt{5}}{5}) = \\frac{1}{2}\\left(3\\left(-\\frac{\\sqrt{5}}{5}\\right)^2 - 1\\right) = \\frac{1}{2}\\left(3\\left(\\frac{5}{25}\\right) - 1\\right) = \\frac{1}{2}\\left(\\frac{3}{5} - 1\\right) = \\frac{1}{2}\\left(-\\frac{2}{5}\\right) = -\\frac{1}{5}$\n$T_{13} = P_3(-\\frac{\\sqrt{5}}{5}) = \\frac{1}{2}\\left(5\\left(-\\frac{\\sqrt{5}}{5}\\right)^3 - 3\\left(-\\frac{\\sqrt{5}}{5}\\right)\\right) = \\frac{1}{2}\\left(5\\left(-\\frac{5\\sqrt{5}}{125}\\right) + \\frac{3\\sqrt{5}}{5}\\right) = \\frac{1}{2}\\left(-\\frac{\\sqrt{5}}{5} + \\frac{3\\sqrt{5}}{5}\\right) = \\frac{1}{2}\\left(\\frac{2\\sqrt{5}}{5}\\right) = \\frac{\\sqrt{5}}{5}$\n\n第 3 行：$x_2 = \\frac{\\sqrt{5}}{5}$。我们可以使用 Legendre 多项式的对称性：$P_k(-x) = (-1)^k P_k(x)$。\n$T_{20} = P_0(\\frac{\\sqrt{5}}{5}) = P_0(-\\frac{\\sqrt{5}}{5}) = 1$\n$T_{21} = P_1(\\frac{\\sqrt{5}}{5}) = -P_1(-\\frac{\\sqrt{5}}{5}) = -(-\\frac{\\sqrt{5}}{5}) = \\frac{\\sqrt{5}}{5}$\n$T_{22} = P_2(\\frac{\\sqrt{5}}{5}) = P_2(-\\frac{\\sqrt{5}}{5}) = -\\frac{1}{5}$\n$T_{23} = P_3(\\frac{\\sqrt{5}}{5}) = -P_3(-\\frac{\\sqrt{5}}{5}) = -\\frac{\\sqrt{5}}{5}$\n\n第 4 行：$x_3 = 1$。使用一般性质 $P_k(1) = 1$：\n$T_{30} = P_0(1) = 1$\n$T_{31} = P_1(1) = 1$\n$T_{32} = P_2(1) = 1$\n$T_{33} = P_3(1) = 1$\n\n将这些计算出的元素组合成矩阵 $T$，得到最终结果：\n$$\nT = \\begin{pmatrix}\n1  & -1 & 1 & -1 \\\\\n1  & -\\frac{\\sqrt{5}}{5}  & -\\frac{1}{5}  & \\frac{\\sqrt{5}}{5} \\\\\n1  & \\frac{\\sqrt{5}}{5}  & -\\frac{1}{5}  & -\\frac{\\sqrt{5}}{5} \\\\\n1  & 1 & 1 & 1\n\\end{pmatrix}\n$$\n这就是所求的、用于将 $p=3$ 时的模态 Legendre 系数映射到节点 Lagrange 值的 $4 \\times 4$ 变换矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  & -1 & 1 & -1 \\\\\n1  & -\\frac{\\sqrt{5}}{5}  & -\\frac{1}{5}  & \\frac{\\sqrt{5}}{5} \\\\\n1  & \\frac{\\sqrt{5}}{5}  & -\\frac{1}{5}  & -\\frac{\\sqrt{5}}{5} \\\\\n1  & 1 & 1 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "用光滑函数逼近具有跳跃间断等尖锐特征的函数会带来独特的挑战，例如困扰全局谱方法的吉布斯现象。本练习将展示谱元方法的一个关键优势：通过将单元边界与函数间断处对齐，能够将逼近误差严格限制在局部区域内。这凸显了基于单元的方法在处理非光滑解时的强大能力和灵活性。",
            "id": "3417901",
            "problem": "考虑一维定义域 $[0,1]$ 以及在 $x=0.5$ 处存在跳跃间断点的函数 $f:[0,1]\\to\\mathbb{R}$，其定义为\n$$\nf(x)=\\begin{cases}\nx, & 0 \\le x  0.5 \\\\\nx+1,  0.5 \\le x \\le 1\n\\end{cases}\n$$\n您需要在一个将 $[0,1]$ 划分为 $E_{1}=[0,0.5]$ 和 $E_{2}=[0.5,1]$ 的双单元网格上，构建一个间断伽辽金谱元法 (DG-SEM) 近似。在每个单元 $E$ 上，使用 Gauss–Lobatto–Legendre (GLL) 节点基中的 $p=3$ 次多项式。参考单元 $[-1,1]$ 上的 GLL 节点为 $\\xi_{0}=-1$, $\\xi_{1}=-1/\\sqrt{5}$, $\\xi_{2}=1/\\sqrt{5}$ 和 $\\xi_{3}=1$。令 $\\ell_{j}(\\xi)$，$j=0,1,2,3$ 表示相应的 Lagrange 基多项式，满足 $\\ell_{j}(\\xi_{i})=\\delta_{ij}$，并通过仿射映射将参考坐标 $\\xi\\in[-1,1]$ 映射到物理坐标 $x\\in E=[x_{L},x_{R}]$\n$$\nx=\\frac{x_{L}+x_{R}}{2}+\\frac{x_{R}-x_{L}}{2}\\,\\xi.\n$$\n在每个单元 $E$ 上，定义局部节点 DG-SEM 插值为\n$$\nu_{h}^{(E)}(x)=\\sum_{j=0}^{3} f\\!\\left(x(\\xi_{j})\\right)\\,\\ell_{j}\\!\\left(\\xi(x)\\right).\n$$\n任务：\n1. 通过组装在 $[0,0.5]$ 上的局部插值 $u_{h}^{(E_{1})}(x)$ 和在 $[0.5,1]$ 上的局部插值 $u_{h}^{(E_{2})}(x)$，构建在 $[0,1]$ 上的全局 DG-SEM 近似 $u_{h}(x)$，并将其写成关于 $x$ 的单一显式分段多项式表达式。\n2. 从多项式插值和基函数局部性的基本原理出发，严格论证为什么将间断点与单元交界面对齐并使用局部高阶多项式能够减轻吉布斯振荡。\n\n您的最终答案必须是 $u_{h}(x)$ 的显式分段多项式表达式，不带单位。无需四舍五入。",
            "solution": "该问题是有效的。这是一个数值分析中的适定问题，具体涉及间断伽辽金谱元法 (DG-SEM)。所有提供的数据、定义和条件都是标准的、自洽的且科学上合理的。\n\n该问题包含两部分。首先，我们必须在双单元网格上为给定函数 $f(x)$ 构建分段多项式 DG-SEM 近似 $u_h(x)$。其次，我们必须为该方法为何能减轻吉布斯振荡提供严格的论证。\n\n### 第一部分：DG-SEM 近似 $u_h(x)$ 的构建\n\n全局近似 $u_h(x)$ 是通过将每个单元上的局部多项式插值 $u_h^{(E_1)}(x)$ 和 $u_h^{(E_2)}(x)$ 拼接而成的。\n\n**1. 单元 $E_1 = [0, 0.5]$ 上的近似**\n\n对于第一个单元 $E_1 = [0, 0.5]$，左右边界分别为 $x_L=0$ 和 $x_R=0.5$。从参考坐标 $\\xi \\in [-1,1]$到物理坐标 $x \\in E_1$ 的仿射映射为：\n$$\nx(\\xi) = \\frac{0+0.5}{2} + \\frac{0.5-0}{2}\\,\\xi = 0.25 + 0.25\\xi = \\frac{1+\\xi}{4}\n$$\n逆映射为 $\\xi(x) = 4x - 1$。\n\n$p=3$ 的 GLL 节点在参考单元上为 $\\xi_0 = -1$, $\\xi_1 = -1/\\sqrt{5}$, $\\xi_2 = 1/\\sqrt{5}$ 和 $\\xi_3 = 1$。我们将它们映射到 $E_1$ 中的物理坐标：\n- $x_0 = x(\\xi_0) = \\frac{1-1}{4} = 0$\n- $x_1 = x(\\xi_1) = \\frac{1 - 1/\\sqrt{5}}{4} \\approx 0.138$\n- $x_2 = x(\\xi_2) = \\frac{1 + 1/\\sqrt{5}}{4} \\approx 0.362$\n- $x_3 = x(\\xi_3) = \\frac{1+1}{4} = 0.5$\n\n接下来，我们在这些节点上计算函数 $f(x)$ 的值。该函数的定义为：\n$$\nf(x)=\\begin{cases}\nx,  0 \\le x  0.5 \\\\\nx+1,  0.5 \\le x \\le 1\n\\end{cases}\n$$\n- $f(x_0) = f(0) = 0$\n- $f(x_1) = x_1 = \\frac{1 - 1/\\sqrt{5}}{4}$，因为 $x_1  0.5$。\n- $f(x_2) = x_2 = \\frac{1 + 1/\\sqrt{5}}{4}$，因为 $x_2  0.5$。\n- $f(x_3) = f(0.5) = 0.5 + 1 = 1.5$。\n\n$E_1$ 上的局部 DG-SEM 插值由 $u_h^{(E_1)}(x) = \\sum_{j=0}^{3} f(x_j)\\,\\ell_j(\\xi(x))$ 给出，其中 $\\ell_j(\\xi)$ 是 GLL 节点的 Lagrange 多项式。我们可以在参考坐标 $\\xi$ 中表示它：\n$$\nu_h^{(E_1)}(\\xi) = \\sum_{j=0}^{3} f(x_j)\\,\\ell_j(\\xi)\n$$\n我们可以通过注意到对于 $j=0,1,2$，有 $f(x_j)=x_j$ 来简化计算。函数 $g(x)=x$ 在参考坐标中对应于 $g(\\xi) = (1+\\xi)/4$。一个1次多项式的3次插值是该多项式本身。让我们分离出 $x_3=0.5$ 处间断点的贡献。\n$$\nu_h^{(E_1)}(\\xi) = \\left( \\sum_{j=0}^{3} x_j \\ell_j(\\xi) \\right) - x_3 \\ell_3(\\xi) + f(x_3) \\ell_3(\\xi)\n$$\n括号中的和是 $x(\\xi)$ 的精确插值，也就是 $x(\\xi)$ 本身。\n$$\n\\sum_{j=0}^{3} x_j \\ell_j(\\xi) = x(\\xi) = \\frac{1+\\xi}{4}\n$$\n因此，插值变为：\n$$\nu_h^{(E_1)}(\\xi) = \\frac{1+\\xi}{4} - x_3\\ell_3(\\xi) + f(x_3)\\ell_3(\\xi) = \\frac{1+\\xi}{4} + (f(x_3)-x_3)\\ell_3(\\xi)\n$$\n代入 $x_3 = 0.5$ 和 $f(x_3)=1.5$：\n$$\nu_h^{(E_1)}(\\xi) = \\frac{1+\\xi}{4} + (1.5-0.5)\\ell_3(\\xi) = \\frac{1+\\xi}{4} + \\ell_3(\\xi)\n$$\n对应于节点 $\\xi_3=1$ 的 Lagrange 多项式 $\\ell_3(\\xi)$ 是：\n$$\n\\ell_3(\\xi) = \\frac{(\\xi - \\xi_0)(\\xi - \\xi_1)(\\xi - \\xi_2)}{(\\xi_3 - \\xi_0)(\\xi_3 - \\xi_1)(\\xi_3 - \\xi_2)} = \\frac{(\\xi + 1)(\\xi + 1/\\sqrt{5})(\\xi - 1/\\sqrt{5})}{(1 + 1)(1 + 1/\\sqrt{5})(1 - 1/\\sqrt{5})} = \\frac{(\\xi+1)(\\xi^2 - 1/5)}{2(1-1/5)} = \\frac{5}{8}(\\xi^3+\\xi^2-\\frac{1}{5}\\xi-\\frac{1}{5})\n$$\n$$\n\\ell_3(\\xi) = \\frac{1}{8}(5\\xi^3 + 5\\xi^2 - \\xi - 1)\n$$\n将此代入 $u_h^{(E_1)}(\\xi)$ 的表达式中：\n$$\nu_h^{(E_1)}(\\xi) = \\frac{2}{8}(1+\\xi) + \\frac{1}{8}(5\\xi^3 + 5\\xi^2 - \\xi - 1) = \\frac{1}{8}(5\\xi^3 + 5\\xi^2 + \\xi + 1)\n$$\n最后，我们使用 $\\xi = 4x-1$ 将其转换回物理坐标 $x$：\n$$\nu_h^{(E_1)}(x) = \\frac{1}{8}(5(4x-1)^3 + 5(4x-1)^2 + (4x-1) + 1)\n$$\n$$\nu_h^{(E_1)}(x) = \\frac{1}{8}(5(64x^3 - 48x^2 + 12x - 1) + 5(16x^2 - 8x + 1) + 4x)\n$$\n$$\nu_h^{(E_1)}(x) = \\frac{1}{8}(320x^3 - 240x^2 + 60x - 5 + 80x^2 - 40x + 5 + 4x)\n$$\n$$\nu_h^{(E_1)}(x) = \\frac{1}{8}(320x^3 - 160x^2 + 24x) = 40x^3 - 20x^2 + 3x\n$$\n此表达式在 $x \\in E_1 = [0, 0.5]$ 上有效。\n\n**2. 单元 $E_2 = [0.5, 1]$ 上的近似**\n\n对于第二个单元 $E_2 = [0.5, 1]$，我们有 $x_L=0.5$ 和 $x_R=1$。仿射映射为：\n$$\nx(\\xi) = \\frac{0.5+1}{2} + \\frac{1-0.5}{2}\\,\\xi = 0.75 + 0.25\\xi = \\frac{3+\\xi}{4}\n$$\n逆映射为 $\\xi(x) = 4x - 3$。\n物理 GLL 节点为 $x_j = x(\\xi_j)$。对于任意点 $x \\in [0.5, 1]$，函数为 $f(x)=x+1$。因此，对于此单元中的所有节点 $x_j$，我们有 $f(x_j)=x_j+1$。\n局部插值为 $u_h^{(E_2)}(x) = \\sum_{j=0}^{3} f(x_j)\\,\\ell_j(\\xi(x))$。在参考坐标中：\n$$\nu_h^{(E_2)}(\\xi) = \\sum_{j=0}^{3} (x_j+1)\\,\\ell_j(\\xi)\n$$\n根据插值的线性性质，这是 $x(\\xi)$ 的插值与 $1$ 的插值的和：\n$$\nu_h^{(E_2)}(\\xi) = \\left(\\sum_{j=0}^{3} x_j \\ell_j(\\xi)\\right) + \\left(\\sum_{j=0}^{3} 1 \\cdot \\ell_j(\\xi)\\right)\n$$\n由于 $x(\\xi)=\\frac{3+\\xi}{4}$ 和 $1$ 都是次数 $\\le 3$ 的多项式，它们的插值是精确的。\n$$\nu_h^{(E_2)}(\\xi) = x(\\xi) + 1 = \\frac{3+\\xi}{4} + 1 = \\frac{7+\\xi}{4}\n$$\n使用 $\\xi = 4x-3$ 转换回物理坐标 $x$：\n$$\nu_h^{(E_2)}(x) = \\frac{7+(4x-3)}{4} = \\frac{4x+4}{4} = x+1\n$$\n此表达式在 $x \\in E_2 = [0.5, 1]$ 上有效。\n\n**3. 全局近似 $u_h(x)$**\n\n全局 DG-SEM 近似 $u_h(x)$ 是由局部插值定义的分段函数：\n$$\nu_h(x) = \\begin{cases}\nu_h^{(E_1)}(x),  x \\in [0, 0.5] \\\\\nu_h^{(E_2)}(x),  x \\in (0.5, 1]\n\\end{cases}\n$$\n在交界面 $x=0.5$ 处，我们检查两边的值：\n- $u_h^{(E_1)}(0.5) = 40(0.5)^3 - 20(0.5)^2 + 3(0.5) = 40(1/8) - 20(1/4) + 1.5 = 5 - 5 + 1.5 = 1.5$。\n- $u_h^{(E_2)}(0.5) = 0.5+1 = 1.5$。\n由于值匹配，得到的全局近似 $u_h(x)$ 是连续的。我们可以按照 $f(x)$ 定义中的定义域划分来写出最终表达式。\n\n### 第二部分：关于减轻吉布斯振荡的论证\n\n在 DG-SEM 框架中，吉布斯振荡的减轻，特别是在网格与间断点对齐时，源于近似基的局部性原理。\n\n1.  **全局近似中的吉布斯现象：** 当具有跳跃间断点的函数被光滑的、全局支撑的基函数（如傅里叶级数或单个高次多项式）的截断级数近似时，就会出现吉布斯现象。用光滑函数来表示急剧跳跃的尝试会迫使近似在间断点附近产生伪振荡。这些振荡的幅度不会随着基函数数量的增加而衰减，它们仅仅是在空间上向跳跃点压缩。\n\n2.  **DG-SEM 的局部性：** DG-SEM 方法的根本不同之处在于它采用了一种“分而治之”的策略。定义域被划分为一个由不重叠单元组成的网格。在每个单元上，解由一个局部多项式近似，该多项式由支撑集仅限于该单个单元的基函数（例如，Lagrange 多项式）构建。全局解是这些局部多项式的分段集合。\n\n3.  **利用网格对齐：** 此问题中的关键步骤是，单元交界面 $x=0.5$ 被有意地与函数 $f(x)$ 的跳跃间断点对齐。这确保了在*每个单元的内部*，函数 $f(x)$ 是解析的（无限可微的）。\n    -   在单元 $E_1=[0, 0.5)$ 中，函数为 $f(x)=x$。\n    -   在单元 $E_2=[0.5, 1]$ 中，函数为 $f(x)=x+1$。\n\n4.  **振荡的遏制：** 让我们分别分析每个单元上的近似。\n    -   在 $E_2=[0.5, 1]$ 上，待插值的函数是 $f(x)=x+1$，一个1次多项式。其 $p=3$ 次多项式插值是精确的：$u_h^{(E_2)}(x) = x+1$。此单元上误差为零，因此没有振荡。\n    -   在 $E_1=[0, 0.5]$ 上，情况更为微妙。当 $x \\in [0, 0.5)$ 时，函数是 $f(x)=x$，但插值是使用右端点的节点值 $f(0.5)=1.5$ 构建的。这个值属于跳跃的另一侧。因此，$E_1$ 上的插值是在一组并非来自单个光滑函数的采样点上进行的。这种不匹配迫使所得的多项式 $u_h^{(E_1)}(x) = 40x^3 - 20x^2 + 3x$ 偏离了底层的光滑函数 $g(x)=x$。单元上的误差 $E(x) = u_h^{(E_1)}(x) - x$ 表现出振荡。这是一种局部的吉布斯现象。\n    -   然而，关键在于**遏制**。因为与单元 $E_1$ 相关联的 Lagrange 基函数对于所有 $x \\notin E_1$ 都为零，所以 $u_h^{(E_1)}(x)$ 的振荡行为被严格限制在区间 $[0, 0.5]$ 内。它不会传播到或“污染”单元 $E_2$ 上的近似。\n\n5.  **结论：** 通过将网格与间断点对齐，DG-SEM 并没有消除吉布斯现象的根本原因（用光滑多项式近似非光滑特征），但它严格地将其影响局部化。振荡被遏制在与跳跃点相邻的单个单元内。在函数光滑的单元中，近似可以达到很高的（谱）精度。这种遏制正是 DG-SEM 如何减轻吉布斯振荡的本质：它防止了振荡污染整个定义域上的解，而这个问题困扰着基于全局基函数的方法。",
            "answer": "$$\n\\boxed{\nu_{h}(x) = \\begin{cases} 40x^3 - 20x^2 + 3x,  0 \\le x  0.5 \\\\ x+1,  0.5 \\le x \\le 1 \\end{cases}\n}\n$$"
        },
        {
            "introduction": "为了使谱元方法在实际中可行，尤其是在二维和三维问题中，计算必须高效执行。利用四边形或六面体单元上基函数的张量积结构是实现这一目标的关键。本练习将指导您构建一维微分矩阵，并实现一种高效的“无矩阵”方法，通过张量积来计算三维梯度，这是高性能谱元代码的基石。",
            "id": "3417928",
            "problem": "考虑一维参考区间 $[-1,1]$ 上使用 Gauss–Lobatto–Legendre 节点的谱元法。设 $p$ 表示多项式次数，$N=p+1$ 表示插值节点（包括端点）的数量。一维插值基由相对于 Gauss–Lobatto–Legendre 节点 $x_i\\in[-1,1]$ 定义的 Lagrange 多项式 $L_i(x)$（$i=0,\\dots,N-1$）组成。Gauss–Lobatto–Legendre 节点由端点 $x_0=-1$、$x_{N-1}=1$ 给出，内部节点是 $p$ 次 Legendre 多项式导数的零点，记为 $P_p'(x)=0$。Gauss–Lobatto–Legendre 求积权重 $w_i$ 满足恒等式 $w_i0$（$i=0,\\dots,N-1$），并且该求积对于次数最高为 $2p-1$ 的多项式是精确的。\n\n从建立在不同节点集 $\\{x_0,\\dots,x_{N-1}\\}$ 上的 Lagrange 插值多项式 $L_i(x)$ 的定义出发，一维微分矩阵 $D\\in\\mathbb{R}^{N\\times N}$ 定义为 $D_{ij}=L_j'(x_i)$，其中 $L_j'(x)$ 表示 $L_j(x)$ 相对于 $x$ 的导数。在坐标为 $(\\xi,\\eta,\\zeta)$ 的三维参考六面体 $[-1,1]^3$ 中，谱元张量积基为 $L_i(\\xi) L_j(\\eta) L_k(\\zeta)$。任何在三维 Gauss–Lobatto–Legendre 网格 $\\{(\\xi_i,\\eta_j,\\zeta_k)\\}_{i,j,k=0}^{N-1}$ 上采样的节点场 $u(\\xi,\\eta,\\zeta)$，都可以通过沿每个坐标方向张量积应用一维微分矩阵进行微分，以获得梯度分量 $\\partial u/\\partial \\xi$、$\\partial u/\\partial \\eta$ 和 $\\partial u/\\partial \\zeta$。\n\n您的任务是：\n\n1. 从涉及 Legendre 多项式 $P_p(x)$ 及其导数 $P_p'(x)$ 的定义出发，为 $[-1,1]$ 上的 $p=4$ 构建 Gauss–Lobatto–Legendre 节点 $\\{x_i\\}_{i=0}^{N-1}$ 和求积权重 $\\{w_i\\}_{i=0}^{N-1}$。\n2. 仅使用不同节点集上的 Lagrange 插值多项式定义，推导并组合一维微分矩阵 $D\\in\\mathbb{R}^{N\\times N}$，使得对于 $i,j=0,\\dots,N-1$，有 $D_{ij}=L_j'(x_i)$。\n3. 展示一维微分矩阵的张量积如何在参考六面体 $[-1,1]^3$ 上形成三维梯度，并实现一个无矩阵（matrix-free）的求值策略（即，沿每个轴应用一维矩阵，而不组合全局三维微分算子），以计算在 $p=4$（因此每个轴向 $N=5$）的单个六面体单元的所有 Gauss–Lobatto–Legendre 网格点上的 $\\nabla u=(\\partial u/\\partial \\xi,\\partial u/\\partial \\eta,\\partial u/\\partial \\zeta)$。\n\n角度必须以弧度为单位进行解释。不需要物理单位。\n\n为进行验证，请对定义在参考单元上的以下四个测试场 $u(\\xi,\\eta,\\zeta)$ 求值无矩阵梯度：\n\n- 测试 A（恒定场）：$u(\\xi,\\eta,\\zeta)=3.14$。\n- 测试 B（每个坐标上次数最多为 $p$ 的多项式场）：$u(\\xi,\\eta,\\zeta)=\\xi^4+\\eta^3+\\zeta^2$。\n- 测试 C（光滑非多项式场）：$u(\\xi,\\eta,\\zeta)=\\sin(\\xi)\\cos(\\eta)e^{\\zeta}$。\n- 测试 D（各向异性混合场）：$u(\\xi,\\eta,\\zeta)=\\xi\\eta+\\eta\\zeta^4+\\cos(\\xi+\\eta+\\zeta)$。\n\n对于每个测试，在参考单元上解析计算精确梯度，并将其与通过无矩阵张量积求值获得的数值梯度进行比较。对于每个测试，报告一个浮点数，该数等于所有网格点和所有三个梯度分量上的最大绝对误差，即\n$$\nE=\\max_{i,j,k\\in\\{0,\\dots,N-1\\}} \\max\\left( \\left|\\frac{\\partial u}{\\partial \\xi}(\\xi_i,\\eta_j,\\zeta_k) - \\left(\\frac{\\partial u}{\\partial \\xi}\\right)_{\\text{num}}(\\xi_i,\\eta_j,\\zeta_k)\\right|, \\left|\\frac{\\partial u}{\\partial \\eta}(\\xi_i,\\eta_j,\\zeta_k) - \\left(\\frac{\\partial u}{\\partial \\eta}\\right)_{\\text{num}}(\\xi_i,\\eta_j,\\zeta_k)\\right|, \\left|\\frac{\\partial u}{\\partial \\zeta}(\\xi_i,\\eta_j,\\zeta_k) - \\left(\\frac{\\partial u}{\\partial \\zeta}\\right)_{\\text{num}}(\\xi_i,\\eta_j,\\zeta_k)\\right| \\right).\n$$\n\n您的程序应生成单行输出，其中包含四个结果 $[E_A,E_B,E_C,E_D]$，以逗号分隔的列表形式包含在方括号内，顺序分别为测试 A、B、C 和 D。",
            "solution": "该问题要求在多项式次数为 $p=4$ 的三维参考六面体 $[-1,1]^3$ 上，为谱元法实现并验证一个无矩阵梯度算子。这涉及三个主要任务：(1) 确定 Gauss–Lobatto–Legendre (GLL) 节点和求积权重，(2) 构建一维微分矩阵，(3) 实现基于张量积的梯度求值，并与解析解进行对比测试。\n\n**第 1 部分：用于 $p=4$ 的 Gauss–Lobatto–Legendre 节点和权重**\n\n对于多项式次数 $p$，谱元法在参考区间 $[-1,1]$ 上使用 $N=p+1$ 个插值节点。对于 $p=4$，我们有 $N=5$ 个节点。这些点是 Gauss–Lobatto–Legendre (GLL) 节点。它们由区间的端点 $x_0=-1$ 和 $x_{N-1}=1$ 以及 $p$ 次 Legendre 多项式导数的根组成。\n\n$p=4$ 次的 Legendre 多项式由 Rodrigues 公式给出：\n$$ P_4(x) = \\frac{1}{2^4 4!} \\frac{d^4}{dx^4}(x^2-1)^4 = \\frac{1}{8}(35x^4 - 30x^2 + 3) $$\n其导数 $P_4'(x)$ 为：\n$$ P_4'(x) = \\frac{d}{dx} \\left( \\frac{1}{8}(35x^4 - 30x^2 + 3) \\right) = \\frac{1}{8}(140x^3 - 60x) = \\frac{5}{2}x(7x^2-3) $$\n内部 GLL 节点是 $P_4'(x)=0$ 的根，即：\n$$ x(7x^2-3)=0 \\implies x=0, \\quad x = \\pm\\sqrt{\\frac{3}{7}} $$\n将这些内部节点与端点 $\\{-1, 1\\}$ 结合并排序，我们得到 $p=4$ 的五个 GLL 节点，记为 $\\{\\xi_i\\}_{i=0}^4$：\n$$ \\xi_0 = -1, \\quad \\xi_1 = -\\sqrt{\\frac{3}{7}}, \\quad \\xi_2 = 0, \\quad \\xi_3 = \\sqrt{\\frac{3}{7}}, \\quad \\xi_4 = 1 $$\n\n相应的 GLL 求积权重 $w_i$ 由以下公式给出：\n$$ w_i = \\frac{2}{p(p+1)[P_p(\\xi_i)]^2} $$\n对于 $p=4$，这变为 $w_i = \\frac{2}{4(5)[P_4(\\xi_i)]^2} = \\frac{1}{10[P_4(\\xi_i)]^2}$。我们在每个节点 $\\xi_i$ 处计算 $P_4(x)$：\n- $P_4(\\pm 1) = \\frac{1}{8}(35-30+3) = \\frac{8}{8} = 1$\n- $P_4(\\pm\\sqrt{3/7}) = \\frac{1}{8}\\left(35\\left(\\frac{3}{7}\\right)^2 - 30\\left(\\frac{3}{7}\\right) + 3\\right) = \\frac{1}{8}\\left(\\frac{35 \\cdot 9}{49} - \\frac{90}{7} + 3\\right) = \\frac{1}{8}\\left(\\frac{45}{7} - \\frac{90}{7} + \\frac{21}{7}\\right) = \\frac{-24}{56} = -\\frac{3}{7}$\n- $P_4(0) = \\frac{3}{8}$\n\n现在，我们计算权重：\n- $w_0 = w_4 = \\frac{1}{10[P_4(\\pm 1)]^2} = \\frac{1}{10(1)^2} = \\frac{1}{10}$\n- $w_1 = w_3 = \\frac{1}{10[P_4(\\pm\\sqrt{3/7})]^2} = \\frac{1}{10(-3/7)^2} = \\frac{1}{10(9/49)} = \\frac{49}{90}$\n- $w_2 = \\frac{1}{10[P_4(0)]^2} = \\frac{1}{10(3/8)^2} = \\frac{1}{10(9/64)} = \\frac{64}{90} = \\frac{32}{45}$\n\n权重之和为 $\\sum w_i = 2 \\cdot \\frac{1}{10} + 2 \\cdot \\frac{49}{90} + \\frac{64}{90} = \\frac{18}{90} + \\frac{98}{90} + \\frac{64}{90} = \\frac{180}{90} = 2$，这与预期的 $\\int_{-1}^1 1 \\, dx$ 相等。\n\n**第 2 部分：一维微分矩阵**\n\n一维微分矩阵 $D \\in \\mathbb{R}^{N \\times N}$ 的元素为 $D_{ij} = L_j'(\\xi_i)$，其中 $L_j(x)$ 是与节点 $\\xi_j$ 相关联的 Lagrange 插值多项式。对于 GLL 节点的特殊情况，存在著名的 $D$ 元素解析公式。对于 $N=p+1$ 个节点 $\\{\\xi_i\\}_{i=0}^p$ 上的 $p$ 次多项式基：\n$$\nD_{ij} =\n\\begin{cases}\n\\frac{P_p(\\xi_i)}{P_p(\\xi_j)(\\xi_i - \\xi_j)}  i \\neq j \\\\\n-\\frac{p(p+1)}{4}  i=j=0 \\\\\n\\frac{p(p+1)}{4}  i=j=p \\\\\n0  \\text{otherwise for } i=j\n\\end{cases}\n$$\n对于 $p=4$，我们有 $N=5$，索引从 $i,j \\in \\{0, 1, 2, 3, 4\\}$。对角线元素为：\n- $D_{00} = -\\frac{4(5)}{4} = -5$\n- $D_{44} = \\frac{4(5)}{4} = 5$\n- $D_{11} = D_{22} = D_{33} = 0$\n\n非对角线元素 $D_{ij}$ 使用上述公式以及先前计算的 $\\xi_i$ 和 $P_4(\\xi_i)$ 值计算。例如：\n- $D_{01} = \\frac{P_4(\\xi_0)}{P_4(\\xi_1)(\\xi_0 - \\xi_1)} = \\frac{1}{(-3/7)(-1 - (-\\sqrt{3/7}))} = \\frac{7}{3(1-\\sqrt{3/7})}$\n- $D_{10} = \\frac{P_4(\\xi_1)}{P_4(\\xi_0)(\\xi_1 - \\xi_0)} = \\frac{-3/7}{1(-\\sqrt{3/7} - (-1))} = \\frac{-3}{7(1-\\sqrt{3/7})}$\n完整的 $5 \\times 5$ 矩阵 $D$ 将在附带的代码中进行数值组装。该矩阵的一个关键性质是每行之和为零，即对于所有 $i$ 都有 $\\sum_{j=0}^{N-1} D_{ij} = 0$，因为常数函数（由全为一的向量表示）的导数为零。\n\n**第 3 部分：无矩阵三维梯度求值**\n\n在三维空间中，参考六面体 $[-1,1]^3$ 上的函数 $u(\\xi, \\eta, \\zeta)$ 使用张量积基进行近似：\n$$ u^h(\\xi, \\eta, \\zeta) = \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1}\\sum_{k=0}^{N-1} U_{ijk} L_i(\\xi) L_j(\\eta) L_k(\\zeta) $$\n其中 $U_{ijk} = u(\\xi_i, \\eta_j, \\zeta_k)$ 是函数在 GLL 节点网格上的 $N \\times N \\times N$ 值数组。\n\n为了计算在网格点 $(\\xi_a, \\eta_b, \\zeta_c)$ 处关于 $\\xi$ 的偏导数，我们有：\n$$ \\frac{\\partial u^h}{\\partial \\xi}(\\xi_a, \\eta_b, \\zeta_c) = \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1}\\sum_{k=0}^{N-1} U_{ijk} L_i'(\\xi_a) L_j(\\eta_b) L_k(\\zeta_c) $$\n利用 Lagrange 多项式的性质 $L_j(x_b) = \\delta_{jb}$，表达式简化为：\n$$ \\frac{\\partial u^h}{\\partial \\xi}(\\xi_a, \\eta_b, \\zeta_c) = \\sum_{i=0}^{N-1} U_{ibc} L_i'(\\xi_a) = \\sum_{i=0}^{N-1} D_{ai} U_{ibc} $$\n这表明，可以通过将一维微分矩阵 $D$ 沿三维数据数组 $U$ 的第一维度（$\\xi$ 轴）应用，来找到所有网格点处关于 $\\xi$ 的导数。令 $(G_\\xi)_{abc}$ 表示在点 $(\\xi_a, \\eta_b, \\zeta_c)$ 处关于 $\\xi$ 的数值导数。所有三个梯度分量的运算如下：\n- $\\displaystyle (G_\\xi)_{abc} = \\sum_{i=0}^{N-1} D_{ai} U_{ibc}$\n- $\\displaystyle (G_\\eta)_{abc} = \\sum_{j=0}^{N-1} D_{bj} U_{ajc}$\n- $\\displaystyle (G_\\zeta)_{abc} = \\sum_{k=0}^{N-1} D_{ck} U_{abk}$\n\n“无矩阵”策略避免了组合全局的 $N^3 \\times N^3$ 微分算子。相反，我们将 $U$ 存储为一个 $N \\times N \\times N$ 数组，并沿每个维度相继应用小的 $N \\times N$ 矩阵 $D$。这在计算上是高效的，并且需要的内存要少得多。在 NumPy 中，这些张量缩并可以使用 `np.einsum` 优雅地实现。\n\n最后，对于每个测试用例，我们使用此方法计算数值梯度数组 $G_\\xi$、$G_\\eta$、$G_\\zeta$。然后，我们在 GLL 网格上求值解析梯度，以获得精确的梯度数组 $G_{\\xi, \\text{exact}}$、$G_{\\eta, \\text{exact}}$、$G_{\\zeta, \\text{exact}}$。误差 $E$ 是如问题陈述中定义的，数值和精确值在所有网格点和所有三个分量上的最大绝对差。对于测试 A（常数）和测试 B（次数 $\\le p$ 的多项式），谱微分是精确的，因此误差预期处于机器浮点精度水平。对于包含非多项式项的测试 C 和 D，误差反映了谱元法的插值误差。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import legendre, eval_legendre\n\ndef solve():\n    \"\"\"\n    Solves the spectral element problem for p=4.\n    1. Computes GLL nodes and the 1D differentiation matrix.\n    2. Implements a matrix-free 3D gradient operator.\n    3. Evaluates the maximum error for four test cases.\n    \"\"\"\n    p = 4\n    N = p + 1\n\n    def gll_nodes_and_weights(p_deg):\n        \"\"\"\n        Computes Gauss-Lobatto-Legendre nodes and weights for a given polynomial degree p.\n        \"\"\"\n        N_pts = p_deg + 1\n        # Internal nodes are roots of P_p'(x)\n        P_p = legendre(p_deg)\n        P_p_prime = P_p.deriv()\n        internal_nodes = np.sort(P_p_prime.roots)\n\n        # Full set of nodes including endpoints\n        nodes = np.zeros(N_pts)\n        nodes[0] = -1.0\n        nodes[N_pts-1] = 1.0\n        nodes[1:-1] = internal_nodes\n        \n        # Weights\n        weights = 2.0 / (p_deg * (p_deg + 1) * (eval_legendre(p_deg, nodes))**2)\n        \n        return nodes, weights\n\n    def differentiation_matrix(p_deg, nodes):\n        \"\"\"\n        Computes the 1D differentiation matrix for GLL nodes.\n        \"\"\"\n        N_pts = p_deg + 1\n        D = np.zeros((N_pts, N_pts))\n        p_vals = eval_legendre(p_deg, nodes)\n\n        for i in range(N_pts):\n            for j in range(N_pts):\n                if i != j:\n                    D[i, j] = p_vals[i] / (p_vals[j] * (nodes[i] - nodes[j]))\n                else:\n                    if i == 0:\n                        D[i, j] = -p_deg * (p_deg + 1) / 4.0\n                    elif i == N_pts - 1:\n                        D[i, j] = p_deg * (p_deg + 1) / 4.0\n                    else:\n                        D[i, j] = 0.0\n        return D\n\n    # 1. Construct GLL nodes and differentiation matrix for p=4\n    gll_nodes, _ = gll_nodes_and_weights(p)\n    D = differentiation_matrix(p, gll_nodes)\n\n    # 2. Set up the 3D grid\n    xi_grid, eta_grid, zeta_grid = np.meshgrid(gll_nodes, gll_nodes, gll_nodes, indexing='ij')\n\n    # 3. Define test cases\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"u_func\": lambda xi, eta, zeta: 3.14 + 0*xi,\n            \"grad_u_exact\": lambda xi, eta, zeta: (0*xi, 0*eta, 0*zeta),\n        },\n        {\n            \"name\": \"B\",\n            \"u_func\": lambda xi, eta, zeta: xi**4 + eta**3 + zeta**2,\n            \"grad_u_exact\": lambda xi, eta, zeta: (4*xi**3, 3*eta**2, 2*zeta),\n        },\n        {\n            \"name\": \"C\",\n            \"u_func\": lambda xi, eta, zeta: np.sin(xi) * np.cos(eta) * np.exp(zeta),\n            \"grad_u_exact\": lambda xi, eta, zeta: (\n                np.cos(xi) * np.cos(eta) * np.exp(zeta),\n                -np.sin(xi) * np.sin(eta) * np.exp(zeta),\n                np.sin(xi) * np.cos(eta) * np.exp(zeta),\n            ),\n        },\n        {\n            \"name\": \"D\",\n            \"u_func\": lambda xi, eta, zeta: xi*eta + eta*zeta**4 + np.cos(xi+eta+zeta),\n            \"grad_u_exact\": lambda xi, eta, zeta: (\n                eta - np.sin(xi+eta+zeta),\n                xi + zeta**4 - np.sin(xi+eta+zeta),\n                4*eta*zeta**3 - np.sin(xi+eta+zeta),\n            ),\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Evaluate function on the grid\n        U = case[\"u_func\"](xi_grid, eta_grid, zeta_grid)\n\n        # Compute numerical gradient using matrix-free tensor products (einsum)\n        G_xi_num = np.einsum('ai,ijk-ajk', D, U)\n        G_eta_num = np.einsum('bj,ijk-ibk', D, U)\n        G_zeta_num = np.einsum('ck,ijk-ijc', D, U)\n\n        # Evaluate exact analytical gradient on the grid\n        G_xi_exact, G_eta_exact, G_zeta_exact = case[\"grad_u_exact\"](xi_grid, eta_grid, zeta_grid)\n\n        # Calculate errors\n        err_xi = np.abs(G_xi_num - G_xi_exact)\n        err_eta = np.abs(G_eta_num - G_eta_exact)\n        err_zeta = np.abs(G_zeta_num - G_zeta_exact)\n\n        # Find the maximum error over all components and all grid points\n        max_error = np.max([np.max(err_xi), np.max(err_eta), np.max(err_zeta)])\n        results.append(max_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}