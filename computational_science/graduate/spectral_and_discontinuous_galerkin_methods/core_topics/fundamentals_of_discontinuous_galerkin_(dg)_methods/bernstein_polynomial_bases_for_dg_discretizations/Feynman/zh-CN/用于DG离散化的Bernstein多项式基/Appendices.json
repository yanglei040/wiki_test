{
    "hands_on_practices": [
        {
            "introduction": "在为偏微分方程（PDEs）构建任何间断 Galerkin (DG) 方法时，一个核心任务是近似梯度等微分算子。Bernstein 基的一个优雅特性是，在 Bernstein 基中表示的函数的梯度可以精确地表示为低一阶的 Bernstein 基函数线性组合，这自然地导出了稀疏且高效的算子。本练习引导您从重心配坐标的基本定义出发，为一个具体的三角形单元计算此梯度算子，从而加深对单元几何形状与离散微分算子结构之间内在联系的理解。",
            "id": "3366732",
            "problem": "考虑平面上的一个仿射三角形，其顶点为 $\\boldsymbol{v}_{1}=(2,1)$、$\\boldsymbol{v}_{2}=(5,2)$ 和 $\\boldsymbol{v}_{3}=(-1,4)$。设 $(\\lambda_{1},\\lambda_{2},\\lambda_{3})$ 表示该三角形上的重心坐标，使得三角形内的任意点 $\\boldsymbol{x}$ 满足 $\\boldsymbol{x}=\\lambda_{1}\\boldsymbol{v}_{1}+\\lambda_{2}\\boldsymbol{v}_{2}+\\lambda_{3}\\boldsymbol{v}_{3}$，且 $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$。在一种使用单纯形上的 Bernstein 多项式基的不连续 Galerkin (DG) 方法中，与多重索引 $\\alpha=(\\alpha_{1},\\alpha_{2},\\alpha_{3})$（其中 $\\alpha_{1}+\\alpha_{2}+\\alpha_{3}=p$）相关的 $p$ 次 Bernstein 基定义为 $B_{\\alpha}^{p}(\\lambda)=\\dfrac{p!}{\\alpha_{1}!\\,\\alpha_{2}!\\,\\alpha_{3}!}\\,\\lambda_{1}^{\\alpha_{1}}\\lambda_{2}^{\\alpha_{2}}\\lambda_{3}^{\\alpha_{3}}$。从这些定义以及重心坐标和链式法则的第一性原理出发，您将：\n- 计算此三角形上 $j\\in\\{1,2,3\\}$ 的常数梯度 $\\nabla \\lambda_{j}$。\n- 使用规范的 $2$ 次 Bernstein 基排序 $\\big\\{(2,0,0),(1,1,0),(1,0,1),(0,2,0),(0,1,1),(0,0,2)\\big\\}$，显式地组装稀疏梯度算子，该算子将单个 $3$ 次内部系数 $c_{(1,1,1)}$（与 $B_{(1,1,1)}^{3}$ 相关）映射到梯度场的 $x$ 和 $y$ 分量的 $2$ 次系数向量。也就是说，写出两个包含 $6$ 个条目的系数向量，它们按所述顺序在 $2$ 次 Bernstein 基中展开 $(\\nabla B_{(1,1,1)}^{3})_{x}$ 和 $(\\nabla B_{(1,1,1)}^{3})_{y}$。\n\n将您的最终答案表示为单个行向量，其前六个条目为 $x$ 分量的权重，后六个条目为 $y$ 分量的权重，并以精确的有理数形式表示。不需要四舍五入，也不需要单位。最终答案必须是单个闭式解析表达式。",
            "solution": "此问题分两步解决。首先计算给定三角形的重心坐标的梯度，然后确定特定Bernstein基函数梯度的系数。\n\n**1. 计算重心坐标的梯度**\n\n点 $\\boldsymbol{x}=(x,y)$ 与其重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 的关系可通过矩阵形式表示，其中 $\\boldsymbol{v}_1=(2,1)$, $\\boldsymbol{v}_2=(5,2)$, $\\boldsymbol{v}_3=(-1,4)$:\n$$\n\\begin{pmatrix} x \\\\ y \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} x_1 & x_2 & x_3 \\\\ y_1 & y_2 & y_3 \\\\ 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} 2 & 5 & -1 \\\\ 1 & 2 & 4 \\\\ 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix}\n$$\n通过对坐标矩阵 $\\mathbf{M}$ 求逆，我们可以将 $\\lambda_j$ 表示为 $x$ 和 $y$ 的函数。$\\mathbf{M}$ 的行列式为 $\\det(\\mathbf{M}) = 12$。逆矩阵为：\n$$\n\\mathbf{M}^{-1} = \\frac{1}{12} \\begin{pmatrix} -2 & -6 & 22 \\\\ 3 & 3 & -9 \\\\ -1 & 3 & -1 \\end{pmatrix}\n$$\n因此，重心坐标为 $\\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix} = \\mathbf{M}^{-1} \\begin{pmatrix} x \\\\ y \\\\ 1 \\end{pmatrix}$：\n$$\n\\lambda_1 = \\frac{1}{12}(-2x - 6y + 22) \\\\\n\\lambda_2 = \\frac{1}{12}(3x + 3y - 9) \\\\\n\\lambda_3 = \\frac{1}{12}(-x + 3y - 1)\n$$\n对 $x$ 和 $y$ 求偏导数，得到常数梯度：\n$$\n\\nabla \\lambda_1 = \\left(-\\frac{2}{12}, -\\frac{6}{12}\\right) = \\left(-\\frac{1}{6}, -\\frac{1}{2}\\right) \\\\\n\\nabla \\lambda_2 = \\left(\\frac{3}{12}, \\frac{3}{12}\\right) = \\left(\\frac{1}{4}, \\frac{1}{4}\\right) \\\\\n\\nabla \\lambda_3 = \\left(-\\frac{1}{12}, \\frac{3}{12}\\right) = \\left(-\\frac{1}{12}, \\frac{1}{4}\\right)\n$$\n这些梯度的和为零，符合预期。\n\n**2. 计算梯度算子**\n\n$p$ 次 Bernstein 基函数 $B_{\\alpha}^{p}$ 的梯度由以下公式给出：\n$$\n\\nabla B_{\\alpha}^{p} = p \\sum_{j=1}^{3} B_{\\alpha-e_j}^{p-1} \\nabla\\lambda_j\n$$\n其中 $e_j$ 是标准多重索引单位向量。对于 $\\alpha=(1,1,1)$ 和 $p=3$：\n$$\n\\nabla B_{(1,1,1)}^{3} = 3 \\left( B_{(0,1,1)}^{2} \\nabla\\lambda_1 + B_{(1,0,1)}^{2} \\nabla\\lambda_2 + B_{(1,1,0)}^{2} \\nabla\\lambda_3 \\right)\n$$\n这表示梯度场 $\\nabla B_{(1,1,1)}^{3}$ 是一个 $2$ 次 Bernstein 多项式，其系数是向量。非零向量系数 $\\boldsymbol{c}_{\\beta}$ 为：\n$$\n\\boldsymbol{c}_{(0,1,1)} = 3\\nabla\\lambda_1 = 3\\left(-\\frac{1}{6}, -\\frac{1}{2}\\right) = \\left(-\\frac{1}{2}, -\\frac{3}{2}\\right) \\\\\n\\boldsymbol{c}_{(1,0,1)} = 3\\nabla\\lambda_2 = 3\\left(\\frac{1}{4}, \\frac{1}{4}\\right) = \\left(\\frac{3}{4}, \\frac{3}{4}\\right) \\\\\n\\boldsymbol{c}_{(1,1,0)} = 3\\nabla\\lambda_3 = 3\\left(-\\frac{1}{12}, \\frac{1}{4}\\right) = \\left(-\\frac{1}{4}, \\frac{3}{4}\\right)\n$$\n其他系数 $\\boldsymbol{c}_{(2,0,0)}, \\boldsymbol{c}_{(0,2,0)}, \\boldsymbol{c}_{(0,0,2)}$ 均为零向量。将这些系数的 $x$ 和 $y$ 分量按问题要求的基排序 $\\big\\{(2,0,0),(1,1,0),(1,0,1),(0,2,0),(0,1,1),(0,0,2)\\big\\}$ 排列，得到：\n$$\n\\mathbf{g}_x = \\left(0, -\\frac{1}{4}, \\frac{3}{4}, 0, -\\frac{1}{2}, 0\\right) \\\\\n\\mathbf{g}_y = \\left(0, \\frac{3}{4}, \\frac{3}{4}, 0, -\\frac{3}{2}, 0\\right)\n$$\n将这两个向量串联起来，得到最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & -\\frac{1}{4} & \\frac{3}{4} & 0 & -\\frac{1}{2} & 0 & 0 & \\frac{3}{4} & \\frac{3}{4} & 0 & -\\frac{3}{2} & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "间断 Galerkin 方法通过定义在单元边界上的数值通量来处理单元间的耦合，而提升算子 (lifting operator) 负责将这些边界上的贡献转化为在单元体内的表示。提升算子通过一个弱形式（基于 Riesz 表示定理）来定义，巧妙地将边界积分与体积分联系起来。本练习要求您计算一个提升算子的作用，这不仅能巩固其定义，还能展示一个与散度定理相呼应的关键相容性性质，让您深入了解表面现象是如何在 DG 框架中被整合到体自由度中的。",
            "id": "3366699",
            "problem": "考虑在顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的参考三角形 $K$ 上的间断Galerkin (DG) 方法。令 $\\lambda_{1}=1-x-y$、$\\lambda_{2}=x$ 和 $\\lambda_{3}=y$ 表示 $K$ 上的重心坐标。对于总次数 $n=2$， $K$ 上的Bernstein基由 $B^{2}_{i j k} = \\dfrac{2!}{i! j! k!} \\lambda_{1}^{i} \\lambda_{2}^{j} \\lambda_{3}^{k}$ 给出，其中 $i+j+k=2$。令 $f$ 为与 $\\lambda_{1}$ 相关联的顶点相对的边，因此 $f=\\{\\lambda_{1}=0\\}$ 是 $(1,0)$ 和 $(0,1)$ 之间的线段。通过 $(x(t),y(t))=(t,1-t)$，用 $t \\in [0,1]$ 对 $f$ 进行参数化。\n\n在边 $f$ 上，考虑一维2次Bernstein基函数 $b_{0}(t)=(1-t)^{2}$、$b_{1}(t)=2 t (1-t)$ 和 $b_{2}(t)=t^{2}$。通过关于 $L^{2}(K)$ 内积的Riesz表示来定义边提升算子 $L_{f}:\\mathbb{P}^{2}(f)\\to \\mathbb{P}^{2}(K)$：对于任意 $r \\in \\mathbb{P}^{2}(f)$ 和任意 $v \\in \\mathbb{P}^{2}(K)$，\n$$\n\\int_{K} L_{f}(r)\\, v \\, \\mathrm{d}x = \\int_{f} r\\, v \\, \\mathrm{d}s.\n$$\n该提升算子是支集在 $f$ 上的数值通量贡献的典范体积表示。\n\n取特定的边函数 $r=b_{1}(t)=2 t (1-t)$。仅使用上述基本定义以及关于 $K$ 和 $f$ 的标准几何事实，计算标量\n$$\n\\int_{K} L_{f}(r)\\, \\mathrm{d}x,\n$$\n并在 $L_{f}$ 的定义恒等式中选择常数测试函数 $v \\equiv 1$，验证其相应的相容性关系，该关系可被解释为散度定理的离散对应物。你的最终答案必须是积分的精确值，以最简闭式形式表示，不得有数值舍入。",
            "solution": "此问题的目标是计算积分 $\\int_{K} L_{f}(r)\\, \\mathrm{d}x$。根据边提升算子 $L_f$ 的定义，对于任何测试函数 $v \\in \\mathbb{P}^{2}(K)$，我们有：\n$$\n\\int_{K} L_{f}(r)\\, v \\, \\mathrm{d}x = \\int_{f} r\\, v \\, \\mathrm{d}s\n$$\n选择测试函数为 $v \\equiv 1$（这是一个有效的0次多项式，属于 $\\mathbb{P}^{2}(K)$），上述关系式简化为：\n$$\n\\int_{K} L_{f}(r)\\, \\mathrm{d}x = \\int_{f} r \\, \\mathrm{d}s\n$$\n因此，问题简化为计算右侧的边积分。\n\n边 $f$ 由 $\\vec{\\gamma}(t) = (t, 1-t)$ 对 $t \\in [0,1]$ 参数化。弧长微元为 $\\mathrm{d}s = ||\\vec{\\gamma}'(t)|| \\, \\mathrm{d}t = ||(1, -1)|| \\, \\mathrm{d}t = \\sqrt{2} \\, \\mathrm{d}t$。\n\n给定的边函数是 $r=b_{1}(t) = 2t(1-t)$。积分计算如下：\n$$\n\\int_{f} r \\, \\mathrm{d}s = \\int_{0}^{1} 2t(1-t) \\sqrt{2} \\, \\mathrm{d}t = 2\\sqrt{2} \\int_{0}^{1} (t-t^{2}) \\, \\mathrm{d}t = 2\\sqrt{2} \\left[ \\frac{t^{2}}{2} - \\frac{t^{3}}{3} \\right]_{0}^{1} = 2\\sqrt{2} \\left(\\frac{1}{2} - \\frac{1}{3}\\right) = 2\\sqrt{2} \\left(\\frac{1}{6}\\right) = \\frac{\\sqrt{2}}{3}\n$$\n所以，所求的体积分等于此值：\n$$\n\\int_{K} L_{f}(r)\\, \\mathrm{d}x = \\frac{\\sqrt{2}}{3}\n$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{2}}{3}}$$"
        },
        {
            "introduction": "Bernstein 基的一个关键优势在于其凸包性，这一性质极大地简化了保正或保界数值格式的设计，这对于处理具有物理约束（如密度或压力）的问题至关重要。限制器 (limiter) 通过修正多项式系数来强制施加物理边界，同时保持诸如单元平均值之类的守恒特性。本编程练习将指导您在 Bernstein 系数空间中实现一个简单而有效的斜率限制器，通过解决这个问题，您将获得利用 Bernstein 基的独特优势来构建鲁棒数值格式的实践经验。",
            "id": "3366720",
            "problem": "考虑使用 Bernstein 多项式基在一维各单元上的间断 Galerkin (DG) 离散化。在参考区间上，$p$ 次 Bernstein 多项式定义为 $B_i^{p}(x) = \\binom{p}{i} x^i (1-x)^{p-i}$，其中 $i = 0,1,\\dots,p$ 且 $x \\in [0,1]$。一个在 Bernstein 基中表示的局部多项式 $u(x)$ 具有形式 $u(x) = \\sum_{i=0}^{p} c_i B_i^p(x)$，其中 $c_i$ 是 Bernstein 系数。Bernstein 基的两个基本性质是：(1) 凸包性质，即对于所有 $x \\in [0,1]$，都有 $u(x) \\in [\\min_i c_i, \\max_i c_i]$；以及 (2) 积分恒等式 $\\int_0^1 B_i^p(x)\\,dx = \\frac{1}{p+1}$，这意味着单元平均值 $\\bar{u} = \\int_0^1 u(x)\\,dx = \\frac{1}{p+1}\\sum_{i=0}^{p} c_i$。\n\n您需要实现一个在 Bernstein 系数空间中对每个单元独立作用的简单斜率限制器。该限制器必须对每个单元满足以下约束：\n- 必须精确保持单元平均值 $\\bar{u}$。\n- 必须强制执行仅由直接相邻单元的平均值决定的系数界。对于索引为 $j$ 且相邻单元为 $j-1$ 和 $j+1$ 的单元，定义 $L_j = \\min(\\bar{u}_{j-1}, \\bar{u}_{j+1})$ 和 $U_j = \\max(\\bar{u}_{j-1}, \\bar{u}_{j+1})$。在缺少相邻单元的区域边界处，使用该单元自身的平均值代替缺失的相邻单元平均值。受限后的系数 $c_{j,i}^{\\text{lim}}$ 必须满足 $L_j \\le c_{j,i}^{\\text{lim}} \\le U_j$ (对所有 $i$) 和 $\\frac{1}{p+1}\\sum_{i=0}^{p} c_{j,i}^{\\text{lim}} = \\bar{u}_j$。\n\n应仅使用这些约束和基本事实来构造斜率限制器；不要假设任何额外的快捷公式。数值研究必须通过量化限制前后的过冲和平均值保持情况，来分析测试数据中的间断。\n\n实现一个程序，该程序：\n1. 对每个测试用例，根据原始（未受限）的单元平均值计算基于相邻单元的界 $L_j$ 和 $U_j$。\n2. 逐个单元地应用限制器，以生成受限后的 Bernstein 系数，这些系数保持每个单元的原始平均值并满足边界约束。\n3. 对测试用例的整个网格计算：\n   - 限制前的最大系数过冲幅度：$\\max_{j,i}\\left(\\max(c_{j,i}-U_j, 0), \\max(L_j - c_{j,i}, 0)\\right)$。\n   - 限制后的最大系数过冲幅度，定义方式相同，但使用 $c_{j,i}^{\\text{lim}}$。\n   - 限制后的最大绝对平均值误差：$\\max_j \\left|\\frac{1}{p_j+1}\\sum_{i=0}^{p_j} c_{j,i}^{\\text{lim}} - \\frac{1}{p_j+1}\\sum_{i=0}^{p_j} c_{j,i}\\right|$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按顺序汇总所有测试用例的结果，每个测试用例的结果是列表 $[\\text{overshoot\\_before}, \\text{overshoot\\_after}, \\text{mean\\_error}]$。\n\n使用以下测试套件。每个测试用例指定多项式次数 $p$、单元数 $N$ 以及每个单元的 Bernstein 系数数组。以下所有数字均为实数标量。\n\n- 测试用例 A（间断点附近的正常情况）：$p = 3$，$N = 6$，各单元的 Bernstein 系数数组 $[c_{j,0}, c_{j,1}, c_{j,2}, c_{j,3}]$ 对于 $j = 0,1,\\dots,5$：\n  - 单元 0：$[0.0, 0.0, 0.0, 0.0]$。\n  - 单元 1：$[0.0, -0.05, 0.05, 0.0]$。\n  - 单元 2：$[-0.2, 0.1, 0.1, 0.0]$。\n  - 单元 3：$[1.3, 1.1, 0.7, 0.9]$。\n  - 单元 4：$[1.0, 1.0, 1.0, 1.0]$。\n  - 单元 5：$[1.0, 1.05, 0.95, 1.0]$。\n\n- 测试用例 B（更高阶且振荡更强）：$p = 5$，$N = 6$，各单元的数组 $[c_{j,0}, c_{j,1}, c_{j,2}, c_{j,3}, c_{j,4}, c_{j,5}]$：\n  - 单元 0：$[0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$。\n  - 单元 1：$[0.0, -0.1, 0.0, 0.05, -0.05, 0.1]$。\n  - 单元 2：$[-0.3, 0.05, 0.2, 0.1, -0.05, 0.0]$。\n  - 单元 3：$[1.2, 1.1, 0.6, 0.9, 1.0, 1.2]$。\n  - 单元 4：$[1.0, 1.0, 1.0, 1.0, 1.0, 1.0]$。\n  - 单元 5：$[1.0, 0.95, 1.05, 1.0, 1.0, 1.0]$。\n\n- 测试用例 C（已在界内）：$p = 3$，$N = 3$：\n  - 单元 0：$[0.0, 0.0, 0.0, 0.0]$。\n  - 单元 1：$[0.4, 0.5, 0.6, 0.5]$。\n  - 单元 2：$[1.0, 1.0, 1.0, 1.0]$。\n\n- 测试用例 D（边界处理）：$p = 4$，$N = 2$：\n  - 单元 0：$[-0.1, 0.0, 0.2, -0.05, -0.05]$。\n  - 单元 1：$[1.1, 0.8, 1.2, 1.0, 0.9]$。\n\n您的实现应对于任何 $p$、$N$ 和系数数组都具有通用性，但必须在这些指定的测试上运行，无需外部输入。最终输出必须是如上所述打印的单行。",
            "solution": "此问题要求实现一个保持单元平均值并强制执行局部边界的斜率限制器。以下是所用算法的推导和实现逻辑。\n\n**限制器算法**\n\n对于每个单元 $j$，我们寻找一组新的 Bernstein 系数 $\\{c_{j,i}^{\\text{lim}}\\}_{i=0}^p$ 来替换原始系数 $\\{c_{j,i}\\}_{i=0}^p$。限制器必须满足两个条件：\n1.  **平均值守恒**: $\\sum_{i=0}^p c_{j,i}^{\\text{lim}} = \\sum_{i=0}^p c_{j,i}$。\n2.  **边界约束**: 对于所有 $i$，必须有 $L_j \\le c_{j,i}^{\\text{lim}} \\le U_j$，其中 $L_j$ 和 $U_j$ 是根据相邻单元的平均值定义的界限。\n\n为了在保持平均值的同时施加边界，我们使用一个缩放变换，将系数围绕其单元平均值 $\\bar{u}_j$进行收缩：\n$$ c_{j,i}^{\\text{lim}} = \\bar{u}_j + \\theta_j (c_{j,i} - \\bar{u}_j) $$\n其中 $\\theta_j \\in [0, 1]$ 是一个缩放因子。此变换对任何 $\\theta_j$ 都自动满足平均值守恒条件。\n\n为了确定 $\\theta_j$，我们强制执行边界约束。我们需要找到满足以下条件的最大 $\\theta_j \\le 1$：\n-   若 $c_{j,i} > \\bar{u}_j$，则 $\\bar{u}_j + \\theta_j (c_{j,i} - \\bar{u}_j) \\le U_j \\implies \\theta_j \\le \\frac{U_j - \\bar{u}_j}{c_{j,i} - \\bar{u}_j}$。\n-   若 $c_{j,i} < \\bar{u}_j$，则 $\\bar{u}_j + \\theta_j (c_{j,i} - \\bar{u}_j) \\ge L_j \\implies \\theta_j \\le \\frac{L_j - \\bar{u}_j}{c_{j,i} - \\bar{u}_j} = \\frac{\\bar{u}_j - L_j}{\\bar{u}_j - c_{j,i}}$。\n\n为确保所有系数都满足约束，我们必须选择一个对所有 $i$ 都有效的 $\\theta_j$。这通过考虑最大和最小系数来确定：\n$$ \\theta_j = \\min\\left(1, \\theta_j^+, \\theta_j^-\\right) $$\n其中，当 $c_{j,\\max} > \\bar{u}_j$ 时 $\\theta_j^+ = \\frac{U_j - \\bar{u}_j}{c_{j,\\max} - \\bar{u}_j}$，否则不施加限制；当 $c_{j,\\min} < \\bar{u}_j$ 时 $\\theta_j^- = \\frac{\\bar{u}_j - L_j}{\\bar{u}_j - c_{j,\\min}}$，否则不施加限制。如果一个单元的所有系数都已在其边界内，则 $\\theta_j=1$，不应用任何更改。\n\n**实现与评估**\n\n该算法按以下步骤实现：\n1.  计算所有单元的原始平均值 $\\bar{u}_j$。\n2.  对每个单元 $j$，根据问题中定义的规则（包括边界单元的特殊处理）计算界 $L_j$ 和 $U_j$。\n3.  计算限制前的最大过冲。\n4.  对每个需要限制的单元（即至少有一个系数违反边界），计算缩放因子 $\\theta_j$ 并应用变换以获得 $c_{j,i}^{\\text{lim}}$。\n5.  计算限制后的最大过冲（根据构造应为零）和最大平均值误差（也应为零）以验证实现。\n\n在给定的测试用例上运行此过程，会产生问题要求的最终输出字符串。",
            "answer": "[[0.3, 0.0, 0.0], [0.3, 0.0, 0.0], [0.0, 0.0, 0.0], [0.2, 0.0, 0.0]]"
        }
    ]
}