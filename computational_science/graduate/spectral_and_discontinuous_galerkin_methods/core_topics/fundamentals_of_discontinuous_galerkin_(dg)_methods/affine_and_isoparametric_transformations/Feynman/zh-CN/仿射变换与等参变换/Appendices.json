{
    "hands_on_practices": [
        {
            "introduction": "仿射映射是有限元分析中单纯形单元变换的基石。本练习将引导您完成为四面体构建此映射的基本过程，从参考单元和物理单元的顶点坐标出发。通过显式推导变换矩阵及其逆矩阵，您将具体理解单元几何形状如何进行代数编码，以及映射的可逆性如何确保一个有效、非退化的物理单元 。",
            "id": "3362693",
            "problem": "在谱元法和间断 Galerkin 方法中，参考单元和物理单元之间的映射是使用等参变换构建的。对于一个线性单纯形（二维中的三角形或三维中的四面体），等参映射是仿射的，其雅可比矩阵决定了可逆性和定向。考虑标准参考四面体 $\\hat{K}$，其顶点位于 $\\mathbb{R}^{3}$ 中的原点和标准基点，即 $\\hat{v}_{1}=(0,0,0)$、$\\hat{v}_{2}=(1,0,0)$、$\\hat{v}_{3}=(0,1,0)$ 和 $\\hat{v}_{4}=(0,0,1)$。设 $K$ 是 $\\mathbb{R}^{3}$ 中的一个物理四面体，其顶点为 $v_{1}=(2,-1,0)$、$v_{2}=(3,2,1)$、$v_{3}=(1,3,-2)$ 和 $v_{4}=(0,0,4)$。\n\n从以 $\\hat{K}$ 上的线性拉格朗日形函数表示的四面体上的线性等参映射的基本定义出发，推导其仿射形式 $F(\\hat{\\boldsymbol{x}})=A\\,\\hat{\\boldsymbol{x}}+b$，确定 $A$ 和 $b$ 如何依赖于顶点坐标，并为给定的 $K$ 显式地构造 $A$ 和 $b$。然后计算逆映射 $F^{-1}$ 以及 $F$ 是正定向可逆的条件，并用像四面体 $K$ 描述 $F^{-1}$ 的有效域。\n\n最终报告的结果必须是 $F^{-1}(x,y,z)$ 的三个分量函数以及标量 $\\det(A)$，汇集成一个单行矩阵。不需要四舍五入。不包含任何单位。请按规定以 LaTeX 单行矩阵的形式表示最终答案。",
            "solution": "该问题要求推导标准参考四面体 $\\hat{K}$ 与物理四面体 $K$ 之间的仿射映射，计算其逆映射，并求雅可比行列式的值。\n\n标准参考四面体 $\\hat{K}$ 由顶点 $\\hat{v}_{1}=(0,0,0)$、$\\hat{v}_{2}=(1,0,0)$、$\\hat{v}_{3}=(0,1,0)$ 和 $\\hat{v}_{4}=(0,0,1)$ 定义。物理四面体 $K$ 的顶点为 $v_{1}=(2,-1,0)$、$v_{2}=(3,2,1)$、$v_{3}=(1,3,-2)$ 和 $v_{4}=(0,0,4)$。我们将参考单元中的点记为 $\\hat{\\boldsymbol{x}} = (\\hat{x}, \\hat{y}, \\hat{z})^T$，物理单元中的点记为 $\\boldsymbol{x} = (x, y, z)^T$。\n\n线性等参映射 $F: \\hat{K} \\to K$ 是使用与 $\\hat{K}$ 的顶点 $\\hat{v}_i$ 相关联的线性拉格朗日形函数 $\\hat{L}_i(\\hat{\\boldsymbol{x}})$ 构建的。这些形函数由性质 $\\hat{L}_i(\\hat{v}_j) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 δ。对于给定的标准四面体，这些函数即为重心坐标，求得如下：\n$$ \\hat{L}_{1}(\\hat{\\boldsymbol{x}}) = 1 - \\hat{x} - \\hat{y} - \\hat{z} $$\n$$ \\hat{L}_{2}(\\hat{\\boldsymbol{x}}) = \\hat{x} $$\n$$ \\hat{L}_{3}(\\hat{\\boldsymbol{x}}) = \\hat{y} $$\n$$ \\hat{L}_{4}(\\hat{\\boldsymbol{x}}) = \\hat{z} $$\n\n映射 $F$ 是通过使用这些形函数对物理顶点坐标进行插值来定义的：\n$$ \\boldsymbol{x} = F(\\hat{\\boldsymbol{x}}) = \\sum_{i=1}^{4} v_i \\hat{L}_i(\\hat{\\boldsymbol{x}}) $$\n代入 $\\hat{L}_i(\\hat{\\boldsymbol{x}})$ 的表达式：\n$$ \\boldsymbol{x} = v_1(1 - \\hat{x} - \\hat{y} - \\hat{z}) + v_2\\hat{x} + v_3\\hat{y} + v_4\\hat{z} $$\n为将其表示为仿射形式 $F(\\hat{\\boldsymbol{x}}) = A\\hat{\\boldsymbol{x}} + b$，我们通过合并含 $\\hat{x}$、$\\hat{y}$ 和 $\\hat{z}$ 的项来重排方程：\n$$ \\boldsymbol{x} = v_1 + (v_2 - v_1)\\hat{x} + (v_3 - v_1)\\hat{y} + (v_4 - v_1)\\hat{z} $$\n该方程可以写成矩阵形式：\n$$ \\boldsymbol{x} = \\begin{pmatrix} v_{2x}-v_{1x} & v_{3x}-v_{1x} & v_{4x}-v_{1x} \\\\ v_{2y}-v_{1y} & v_{3y}-v_{1y} & v_{4y}-v_{1y} \\\\ v_{2z}-v_{1z} & v_{3z}-v_{1z} & v_{4z}-v_{1z} \\end{pmatrix} \\begin{pmatrix} \\hat{x} \\\\ \\hat{y} \\\\ \\hat{z} \\end{pmatrix} + \\begin{pmatrix} v_{1x} \\\\ v_{1y} \\\\ v_{1z} \\end{pmatrix} $$\n将其与 $\\boldsymbol{x} = A\\hat{\\boldsymbol{x}} + b$ 比较，我们确定矩阵 $A$（变换的雅可比矩阵）和向量 $b$：\n$$ A = \\begin{pmatrix} v_2-v_1 & v_3-v_1 & v_4-v_1 \\end{pmatrix} \\quad , \\quad b = v_1 $$\n$A$ 的列是由起始于顶点 $v_1$ 的物理四面体的棱构成的向量。\n\n现在，我们使用给定的顶点坐标构造 $A$ 和 $b$：\n$v_1 = (2, -1, 0)^T$，$v_2 = (3, 2, 1)^T$，$v_3 = (1, 3, -2)^T$，$v_4 = (0, 0, 4)^T$。\n向量 $b$ 是：\n$$ b = v_1 = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\end{pmatrix} $$\n$A$ 的列是：\n$v_2 - v_1 = (3-2, 2-(-1), 1-0)^T = (1, 3, 1)^T$\n$v_3 - v_1 = (1-2, 3-(-1), -2-0)^T = (-1, 4, -2)^T$\n$v_4 - v_1 = (0-2, 0-(-1), 4-0)^T = (-2, 1, 4)^T$\n所以，矩阵 $A$ 是：\n$$ A = \\begin{pmatrix} 1 & -1 & -2 \\\\ 3 & 4 & 1 \\\\ 1 & -2 & 4 \\end{pmatrix} $$\n\n映射 $F$ 可逆的充要条件是 $A$ 是一个可逆矩阵，即 $\\det(A) \\neq 0$。若 $\\det(A) > 0$，则该映射保向。我们来计算 $A$ 的行列式：\n$$ \\det(A) = 1(4 \\cdot 4 - 1 \\cdot (-2)) - (-1)(3 \\cdot 4 - 1 \\cdot 1) + (-2)(3 \\cdot (-2) - 4 \\cdot 1) $$\n$$ \\det(A) = 1(16 + 2) + 1(12 - 1) - 2(-6 - 4) = 18 + 11 - 2(-10) = 18 + 11 + 20 = 49 $$\n由于 $\\det(A)=49 > 0$，该映射是可逆且保向的。物理顶点构成一个非退化四面体。\n\n逆映射 $F^{-1}: K \\to \\hat{K}$ 可以通过对 $\\boldsymbol{x} = A\\hat{\\boldsymbol{x}} + b$ 求解 $\\hat{\\boldsymbol{x}}$ 得到：\n$$ A\\hat{\\boldsymbol{x}} = \\boldsymbol{x} - b \\implies \\hat{\\boldsymbol{x}} = A^{-1}(\\boldsymbol{x} - b) $$\n$F^{-1}$ 的有效域是物理四面体 $K$。\n为求 $A^{-1}$，我们使用伴随矩阵公式 $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$。伴随矩阵 $\\text{adj}(A)$ 是代数余子式矩阵 $C$ 的转置。\n$A$ 的代数余子式 $C_{ij}$ 为：\n$C_{11} = +(16 - (-2)) = 18$\n$C_{12} = -(12 - 1) = -11$\n$C_{13} = +(-6 - 4) = -10$\n$C_{21} = -(-4 - 4) = 8$\n$C_{22} = +(4 - (-2)) = 6$\n$C_{23} = -(-2 - (-1)) = 1$\n$C_{31} = +(-1 - (-8)) = 7$\n$C_{32} = -(1 - (-6)) = -7$\n$C_{33} = +(4 - (-3)) = 7$\n代数余子式矩阵为 $C = \\begin{pmatrix} 18 & -11 & -10 \\\\ 8 & 6 & 1 \\\\ 7 & -7 & 7 \\end{pmatrix}$。\n伴随矩阵为 $\\text{adj}(A) = C^T = \\begin{pmatrix} 18 & 8 & 7 \\\\ -11 & 6 & -7 \\\\ -10 & 1 & 7 \\end{pmatrix}$。\n因此，逆矩阵为：\n$$ A^{-1} = \\frac{1}{49} \\begin{pmatrix} 18 & 8 & 7 \\\\ -11 & 6 & -7 \\\\ -10 & 1 & 7 \\end{pmatrix} $$\n现在我们可以写出逆映射 $F^{-1}(\\boldsymbol{x}) = \\hat{\\boldsymbol{x}}$ 的显式形式：\n$$ \\begin{pmatrix} \\hat{x} \\\\ \\hat{y} \\\\ \\hat{z} \\end{pmatrix} = \\frac{1}{49} \\begin{pmatrix} 18 & 8 & 7 \\\\ -11 & 6 & -7 \\\\ -10 & 1 & 7 \\end{pmatrix} \\begin{pmatrix} x - 2 \\\\ y - (-1) \\\\ z - 0 \\end{pmatrix} = \\frac{1}{49} \\begin{pmatrix} 18 & 8 & 7 \\\\ -11 & 6 & -7 \\\\ -10 & 1 & 7 \\end{pmatrix} \\begin{pmatrix} x - 2 \\\\ y + 1 \\\\ z \\end{pmatrix} $$\n$F^{-1}(x,y,z)$ 的三个分量函数通过矩阵-向量乘法得到：\n$$ \\hat{x}(x,y,z) = \\frac{1}{49} [18(x-2) + 8(y+1) + 7z] = \\frac{1}{49} (18x - 36 + 8y + 8 + 7z) = \\frac{1}{49} (18x + 8y + 7z - 28) $$\n$$ \\hat{y}(x,y,z) = \\frac{1}{49} [-11(x-2) + 6(y+1) - 7z] = \\frac{1}{49} (-11x + 22 + 6y + 6 - 7z) = \\frac{1}{49} (-11x + 6y - 7z + 28) $$\n$$ \\hat{z}(x,y,z) = \\frac{1}{49} [-10(x-2) + 1(y+1) + 7z] = \\frac{1}{49} (-10x + 20 + y + 1 + 7z) = \\frac{1}{49} (-10x + y + 7z + 21) $$\n问题要求报告这三个函数和 $\\det(A)$ 的值。\n$\\det(A) = 49$。\n$F^{-1}$ 的分量函数是如上推导的 $\\hat{x}(x,y,z)$、$\\hat{y}(x,y,z)$ 和 $\\hat{z}(x,y,z)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{49} (18x + 8y + 7z - 28) & \\frac{1}{49} (-11x + 6y - 7z + 28) & \\frac{1}{49} (-10x + y + 7z + 21) & 49\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然仿射映射非常适用于直边单元，但精确建模真实世界的几何形状通常需要处理弯曲边界，这可以通过使用高阶多项式的等参变换来实现。本练习提供了一个为带有圆弧边界的四边形构建二次映射的实践范例，这是计算力学和物理学中的常见情景 。您将使用张量积基函数，并分析雅可比行列式——这是验证弯曲单元有效性的关键量。",
            "id": "3362702",
            "problem": "考虑参考正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$，其参考坐标为 $(\\xi,\\eta)$。为谱元法和间断 Galerkin 方法中使用的曲边四边形构建一个二次等参映射 $\\boldsymbol{F} : \\hat{\\Omega} \\to \\Omega \\subset \\mathbb{R}^2$，具体如下。\n\n物理单元 $\\Omega$ 具有以下特征：\n- 底边：从 $(-1,-1)$ 到 $(1,-1)$ 的直线段。\n- 左边和右边：分别为从 $(-1,-1)$ 到 $(-1,1)$ 和从 $(1,-1)$ 到 $(1,1)$ 的直线段。\n- 顶边：连接 $(-1,1)$ 到 $(1,1)$ 的圆 $x^2 + y^2 = 2$ 的一段圆弧。\n\n使用张量积二次 Lagrange 插值在 $3 \\times 3$ 网格 $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$ 的节点上构建二次等参几何，其中八个边界节点映射到相应的物理点：\n- 角点：$(-1,-1) \\mapsto (-1,-1)$，$(1,-1) \\mapsto (1,-1)$，$(1,1) \\mapsto (1,1)$，$(-1,1) \\mapsto (-1,1)$，\n- 边中点：$(0,-1) \\mapsto (0,-1)$，$(1,0) \\mapsto (1,0)$，$(-1,0) \\mapsto (-1,0)$，以及 $(0,1) \\mapsto (0,\\sqrt{2})$（圆弧上的顶边中点）。\n设置内部节点 $(0,0) \\mapsto (0,0)$。\n\n1. 使用在每个坐标方向上基于节点 $\\{-1,0,1\\}$ 的张量积二次 Lagrange 基多项式的等参映射定义，推导 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 的显式公式。\n2. 从基本原理出发，计算雅可比矩阵 $\\boldsymbol{J}(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$ 及其行列式 $\\det \\boldsymbol{J}(\\xi,\\eta)$。\n3. 在多项式次数为 $N=2$ 的二维 Legendre–Gauss–Lobatto (LGL) 点上，即在张量积集合 $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$ 上，计算 $\\det \\boldsymbol{J}$ 的值。\n4. 将这九个 $\\det \\boldsymbol{J}$ 值的算术平均值以单一精确的封闭形式表达式给出。请勿对答案进行四舍五入。",
            "solution": "求解过程分四个阶段进行：\n1.  推导等参坐标变换 $\\boldsymbol{F}(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta))$。\n2.  计算雅可比矩阵 $\\boldsymbol{J}(\\xi,\\eta)$ 及其行列式 $\\det\\boldsymbol{J}(\\xi,\\eta)$。\n3.  在九个指定的 Legendre-Gauss-Lobatto (LGL) 点上计算 $\\det\\boldsymbol{J}$ 的值。\n4.  计算这些行列式值的算术平均值。\n\n### 1. 等参映射\n该映射使用张量积二次 Lagrange 基多项式构建。在区间 $[-1,1]$ 上，节点为 $\\{-1, 0, 1\\}$ 的一维 Lagrange 基多项式为：\n$$L_{-1}(\\zeta) = \\frac{(\\zeta-0)(\\zeta-1)}{(-1-0)(-1-1)} = \\frac{1}{2}\\zeta(\\zeta-1)$$\n$$L_0(\\zeta) = \\frac{(\\zeta-(-1))(\\zeta-1)}{(0-(-1))(0-1)} = -(\\zeta+1)(\\zeta-1) = 1-\\zeta^2$$\n$$L_1(\\zeta) = \\frac{(\\zeta-(-1))(\\zeta-0)}{(1-(-1))(1-0)} = \\frac{1}{2}\\zeta(\\zeta+1)$$\n一个有用的性质是它们的和为 1：$\\sum_{i=-1,0,1} L_i(\\zeta) = 1$。\n\n从参考坐标 $(\\xi,\\eta)$ 到物理坐标 $(x,y)$ 的等参映射由下式给出：\n$$x(\\xi,\\eta) = \\sum_{i \\in \\{-1,0,1\\}} \\sum_{j \\in \\{-1,0,1\\}} x_{ij} L_i(\\xi)L_j(\\eta)$$\n$$y(\\xi,\\eta) = \\sum_{i \\in \\{-1,0,1\\}} \\sum_{j \\in \\{-1,0,1\\}} y_{ij} L_i(\\xi)L_j(\\eta)$$\n其中 $(x_{ij}, y_{ij})$ 是对应于参考节点 $(\\xi_i, \\eta_j)$ 的节点的物理坐标。\n\n**推导 $x(\\xi,\\eta)$：**\n节点的物理 $x$ 坐标由 $x_{ij} = \\xi_i \\in \\{-1, 0, 1\\}$ 给出。\n$$x(\\xi,\\eta) = \\sum_{j} \\left( x_{-1,j}L_{-1}(\\xi)L_j(\\eta) + x_{0,j}L_0(\\xi)L_j(\\eta) + x_{1,j}L_1(\\xi)L_j(\\eta) \\right)$$\n$$x(\\xi,\\eta) = \\sum_{j} \\left( (-1)L_{-1}(\\xi)L_j(\\eta) + (0)L_0(\\xi)L_j(\\eta) + (1)L_1(\\xi)L_j(\\eta) \\right)$$\n$$x(\\xi,\\eta) = \\left( L_1(\\xi)-L_{-1}(\\xi) \\right) \\sum_j L_j(\\eta)$$\n使用 $\\sum_j L_j(\\eta) = 1$：\n$$x(\\xi,\\eta) = L_1(\\xi)-L_{-1}(\\xi) = \\frac{1}{2}\\xi(\\xi+1) - \\frac{1}{2}\\xi(\\xi-1) = \\frac{1}{2}(\\xi^2+\\xi - \\xi^2+\\xi) = \\xi$$\n\n**推导 $y(\\xi,\\eta)$：**\n物理 $y$ 坐标 $(y_{ij})$ 已给出。可以直接求和，但一个更有洞察力的方法是将变换看作一个基准仿射映射加上一个非线性修正。仿射映射 $y=\\eta$ 正确地映射了 9 个节点中的 8 个，唯一的偏差在 $(\\xi, \\eta) = (0,1)$ 处，其物理坐标为 $y_{0,1}=\\sqrt{2}$ 而不是 $y=1$。该节点所需的修正量为 $\\sqrt{2}-1$。这个修正量在所有其他节点上必须为零。这可以完美地由对应于节点 $(0,1)$ 的基函数 $L_0(\\xi)L_1(\\eta)$ 来描述。\n因此，$y$ 的映射可以表示为：\n$$y(\\xi,\\eta) = \\eta + (y_{0,1}-1) \\cdot L_0(\\xi)L_1(\\eta)$$\n代入给定的值和基函数：\n$$y(\\xi,\\eta) = \\eta + (\\sqrt{2}-1) (1-\\xi^2) \\left(\\frac{1}{2}\\eta(\\eta+1)\\right)$$\n所以，该映射的显式公式为：\n$$x(\\xi,\\eta) = \\xi$$\n$$y(\\xi,\\eta) = \\eta + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(\\eta^2+\\eta)$$\n\n### 2. 雅可比矩阵和行列式\n变换的雅可比矩阵为 $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\partial x/\\partial \\xi & \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi & \\partial y/\\partial \\eta \\end{pmatrix}$。\n\n首先，我们计算偏导数：\n$$\\frac{\\partial x}{\\partial \\xi} = 1$$\n$$\\frac{\\partial x}{\\partial \\eta} = 0$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\eta + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(\\eta^2+\\eta) \\right] = \\frac{\\sqrt{2}-1}{2}(-2\\xi)(\\eta^2+\\eta) = -(\\sqrt{2}-1)\\xi(\\eta^2+\\eta)$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\eta + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(\\eta^2+\\eta) \\right] = 1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1)$$\n\n雅可比矩阵为：\n$$\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix} 1 & 0 \\\\ -(\\sqrt{2}-1)\\xi(\\eta^2+\\eta) & 1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1) \\end{pmatrix}$$\n\n雅可比行列式为：\n$$\\det\\boldsymbol{J}(\\xi,\\eta) = (1) \\left( 1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1) \\right) - (0) \\left( -(\\sqrt{2}-1)\\xi(\\eta^2+\\eta) \\right)$$\n$$\\det\\boldsymbol{J}(\\xi,\\eta) = 1 + \\frac{\\sqrt{2}-1}{2}(1-\\xi^2)(2\\eta+1)$$\n\n### 3. 在 LGL 点上计算行列式的值\n我们在 9 个点 $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$ 上计算 $\\det\\boldsymbol{J}$ 的值。\n\n情况 1：$\\xi = -1$ 或 $\\xi = 1$。\n对于这些值，项 $(1-\\xi^2) = 1 - (\\pm 1)^2 = 0$。因此，$\\det\\boldsymbol{J} = 1 + 0 = 1$。这适用于 6 个点：\n$\\det\\boldsymbol{J}(-1,-1) = 1$\n$\\det\\boldsymbol{J}(-1,0) = 1$\n$\\det\\boldsymbol{J}(-1,1) = 1$\n$\\det\\boldsymbol{J}(1,-1) = 1$\n$\\det\\boldsymbol{J}(1,0) = 1$\n$\\det\\boldsymbol{J}(1,1) = 1$\n\n情况 2：$\\xi = 0$。\n对于这个值，$(1-\\xi^2) = 1 - 0^2 = 1$。行列式简化为 $\\det\\boldsymbol{J}(0,\\eta) = 1 + \\frac{\\sqrt{2}-1}{2}(2\\eta+1)$。我们对 $\\eta \\in \\{-1,0,1\\}$ 计算该式的值：\n- 对于 $(\\xi,\\eta) = (0,-1)$：\n  $$\\det\\boldsymbol{J}(0,-1) = 1 + \\frac{\\sqrt{2}-1}{2}(2(-1)+1) = 1 - \\frac{\\sqrt{2}-1}{2} = \\frac{2 - (\\sqrt{2}-1)}{2} = \\frac{3-\\sqrt{2}}{2}$$\n- 对于 $(\\xi,\\eta) = (0,0)$：\n  $$\\det\\boldsymbol{J}(0,0) = 1 + \\frac{\\sqrt{2}-1}{2}(2(0)+1) = 1 + \\frac{\\sqrt{2}-1}{2} = \\frac{2 + \\sqrt{2}-1}{2} = \\frac{1+\\sqrt{2}}{2}$$\n- 对于 $(\\xi,\\eta) = (0,1)$：\n  $$\\det\\boldsymbol{J}(0,1) = 1 + \\frac{3(\\sqrt{2}-1)}{2} = \\frac{2 + 3\\sqrt{2}-3}{2} = \\frac{3\\sqrt{2}-1}{2}$$\n\n行列式的九个值为：$1, 1, 1, \\frac{3-\\sqrt{2}}{2}, \\frac{1+\\sqrt{2}}{2}, \\frac{3\\sqrt{2}-1}{2}, 1, 1, 1$。\n\n### 4. 算术平均值\n算术平均值是九个值的和除以 9。\n$$\\text{和} = (1+1+1) + \\left(\\frac{3-\\sqrt{2}}{2} + \\frac{1+\\sqrt{2}}{2} + \\frac{3\\sqrt{2}-1}{2}\\right) + (1+1+1)$$\n$$\\text{和} = 6 + \\frac{(3-\\sqrt{2}) + (1+\\sqrt{2}) + (3\\sqrt{2}-1)}{2}$$\n$$\\text{和} = 6 + \\frac{3 - \\sqrt{2} + 1 + \\sqrt{2} + 3\\sqrt{2} - 1}{2}$$\n$$\\text{和} = 6 + \\frac{(3+1-1) + (-\\sqrt{2}+\\sqrt{2}+3\\sqrt{2})}{2} = 6 + \\frac{3 + 3\\sqrt{2}}{2}$$\n$$\\text{和} = \\frac{12}{2} + \\frac{3 + 3\\sqrt{2}}{2} = \\frac{15 + 3\\sqrt{2}}{2}$$\n\n算术平均值为 $\\frac{1}{9} \\times \\text{和}$：\n$$\\text{平均值} = \\frac{1}{9} \\left(\\frac{15 + 3\\sqrt{2}}{2}\\right) = \\frac{15 + 3\\sqrt{2}}{18}$$\n从分子中提出因子 3：\n$$\\text{平均值} = \\frac{3(5 + \\sqrt{2})}{18} = \\frac{5 + \\sqrt{2}}{6}$$",
            "answer": "$$\\boxed{\\frac{5 + \\sqrt{2}}{6}}$$"
        },
        {
            "introduction": "构建精确的几何映射只是成功的一半；我们还必须能够精确地计算所得弯曲单元上的积分。因此，数值求积规则的选择对于保持高阶方法的整体精度至关重要。这个问题挑战您确定在弯曲六面体上精确积分质量矩阵所需的最小求积阶数，以避免混叠误差 。这个分析将几何映射和解基函数的多项式次数与数值实现的基本要求联系起来。",
            "id": "3362664",
            "problem": "考虑在单个物理六面体单元上进行的谱元法（SEM）或间断伽辽金（DG）离散化，该单元是通过等参变换从参考立方体$[-1,1]^{3}$获得的。解由勒让德-高斯-洛巴托（LGL）节点上次数为$p$的张量积拉格朗日多项式表示，几何映射是相同类型节点上次数为$p_{g}$的等参张量积拉格朗日多项式。单元质量矩阵定义为两个基函数在物理单元上的乘积的积分。假设一个标准事实，即$N$点一维LGL求积可以精确积分最高为$2N-3$次的多项式。为了消除质量矩阵中的求积混叠，需要对被积函数进行精确积分。\n\n给定$p=4$和$p_{g}=4$，确定所需的最小一维LGL求积阶数$N$（即每个坐标方向上的最小点数），以使张量积LGL求积能够精确积分六面体上的质量矩阵。请以单个整数形式提供您的答案，不带单位。",
            "solution": "为了在给定的物理六面体单元上精确积分单元质量矩阵，我们需要确定被积函数的最大多项式次数，并选择一个能够精确积分该次数多项式的求积法则。\n\n首先，我们将质量矩阵的积分从物理单元 $K$ 变换到参考立方体 $\\hat{K} = [-1,1]^3$。物理坐标 $\\mathbf{x} \\in K$ 通过等参映射 $\\mathbf{x} = \\mathbf{F}(\\boldsymbol{\\xi})$ 与参考坐标 $\\boldsymbol{\\xi} \\in \\hat{K}$ 相关联。质量矩阵的积分为：\n$$ M_{ij}^e = \\int_K \\phi_i(\\mathbf{x}) \\phi_j(\\mathbf{x}) \\, d\\mathbf{x} = \\int_{\\hat{K}} \\hat{\\phi}_i(\\boldsymbol{\\xi}) \\hat{\\phi}_j(\\boldsymbol{\\xi}) J(\\boldsymbol{\\xi}) \\, d\\boldsymbol{\\xi} $$\n其中，$\\hat{\\phi}_k$ 是参考单元上的基函数，而 $J(\\boldsymbol{\\xi})$ 是映射 $\\mathbf{F}$ 的雅可比行列式。\n\n为了通过张量积求积精确计算该积分，我们需要确定被积函数 $I(\\boldsymbol{\\xi}) = \\hat{\\phi}_i(\\boldsymbol{\\xi}) \\hat{\\phi}_j(\\boldsymbol{\\xi}) J(\\boldsymbol{\\xi})$ 在每个坐标方向（如 $\\xi$）上的最大多项式次数。\n\n1.  **基函数乘积的次数**：解的基函数 $\\hat{\\phi}_k$ 是次数为 $p$ 的张量积多项式。因此，在 $\\xi$ 方向上，$\\hat{\\phi}_k$ 的次数为 $p$。两个基函数的乘积 $\\hat{\\phi}_i(\\boldsymbol{\\xi}) \\hat{\\phi}_j(\\boldsymbol{\\xi})$ 在 $\\xi$ 方向上的次数为 $p+p=2p$。\n\n2.  **雅可比行列式的次数**：几何映射 $\\mathbf{F}(\\boldsymbol{\\xi})$ 是次数为 $p_g$ 的张量积多项式。雅可比矩阵 $\\mathbf{J}$ 的元素 $\\frac{\\partial F_k}{\\partial \\xi_l}$ 在变量 $\\xi$ 中的多项式次数如下：如果对 $\\xi$ 求导（即 $l=1$），则次数为 $p_g-1$；否则次数为 $p_g$。三维雅可比行列式是其元素的乘积之和。在 $\\xi$ 方向上，次数最高的项来自于三项的乘积，其中一项对 $\\xi$ 求导，另外两项不对 $\\xi$ 求导。例如，行列式展开中的一项 $\\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial z}{\\partial \\zeta}$ 在 $\\xi$ 方向上的次数为 $(p_g - 1) + p_g + p_g = 3p_g - 1$。因此，雅可比行列式 $J(\\boldsymbol{\\xi})$ 在每个坐标方向上的最大多项式次数为 $3p_g - 1$。\n\n3.  **被积函数的总次数**：被积函数 $I(\\boldsymbol{\\xi})$ 在 $\\xi$ 方向上的总多项式次数 $P_{max}$ 是其各部分次数之和：\n    $$ P_{max} = \\deg_{\\xi}(I) = \\deg_{\\xi}(\\hat{\\phi}_i\\hat{\\phi}_j) + \\deg_{\\xi}(J) = 2p + (3p_g - 1) $$\n\n4.  **所需求积阶数**：一个 $N$ 点的一维 LGL 求积法则可以精确积分最高为 $2N-3$ 次的多项式。为了确保精确积分，必须满足：\n    $$ 2N - 3 \\ge P_{max} $$\n    $$ 2N - 3 \\ge 2p + 3p_g - 1 $$\n    解出 $N$：\n    $$ 2N \\ge 2p + 3p_g + 2 $$\n    $$ N \\ge p + \\frac{3}{2}p_g + 1 $$\n\n5.  **计算最终结果**：代入给定的值 $p=4$ 和 $p_g=4$：\n    $$ N \\ge 4 + \\frac{3}{2}(4) + 1 $$\n    $$ N \\ge 4 + 6 + 1 $$\n    $$ N \\ge 11 $$\n    由于 $N$ 必须是整数，因此每个维度所需的最小 LGL 求积点数是 11。",
            "answer": "$$\n\\boxed{11}\n$$"
        }
    ]
}