{
    "hands_on_practices": [
        {
            "introduction": "The foundation of modal methods lies in constructing a basis of orthogonal polynomials on a reference element. This first practice takes us to the simplest case: the one-dimensional interval $[-1,1]$. By starting with the well-known (but unnormalized) Legendre polynomials, this exercise guides you through the process of deriving the scaling factors needed to create a truly orthonormal basis, a cornerstone of spectral and Discontinuous Galerkin theory . This task reinforces the meaning of the mass matrix and the practical steps of transforming an orthogonal set into an orthonormal one.",
            "id": "3400583",
            "problem": "Consider the standard one-dimensional reference element $I = [-1,1]$ used in Spectral and Discontinuous Galerkin (DG) methods. Let $\\{P_{n}\\}_{n=0}^{\\infty}$ denote the unnormalized Legendre polynomials on $I$, characterized by $P_{n}(1)=1$, which form a modal basis on $I$. Define the $L^{2}(I)$ inner product with unit weight by $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,dx$, and let the mass matrix entries be given by $M_{mn} = \\int_{-1}^{1} P_{m}(x)\\,P_{n}(x)\\,dx$. Starting from the definitions of the inner product and mass matrix and using only fundamental properties of Legendre polynomials on $[-1,1]$, derive a closed-form expression for the diagonal entries $M_{nn}$ and determine a scaling factor $\\alpha_{n}$ such that $\\phi_{n}(x) = \\alpha_{n}\\,P_{n}(x)$ yields an $L^{2}(I)$-orthonormal basis, that is, $\\int_{-1}^{1} \\phi_{m}(x)\\,\\phi_{n}(x)\\,dx = \\delta_{mn}$ for all $m,n \\ge 0$. Provide your final answer as a single row matrix containing the expressions for $M_{nn}$ and $\\alpha_{n}$ in terms of $n$. No numerical approximation is required, and no units are involved.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **Reference element:** $I = [-1,1]$.\n- **Basis functions:** $\\{P_{n}\\}_{n=0}^{\\infty}$, the unnormalized Legendre polynomials on $I$.\n- **Normalization condition:** $P_{n}(1)=1$ for all $n \\ge 0$.\n- **Inner product:** $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,dx$.\n- **Mass matrix:** $M_{mn} = \\int_{-1}^{1} P_{m}(x)\\,P_{n}(x)\\,dx$.\n- **Objective 1:** Find a closed-form expression for the diagonal mass matrix entries, $M_{nn}$.\n- **Objective 2:** Find a scaling factor $\\alpha_{n}$ such that $\\{\\phi_{n}(x) = \\alpha_{n}\\,P_{n}(x)\\}$ is an $L^{2}(I)$-orthonormal basis, i.e., $\\int_{-1}^{1} \\phi_{m}(x)\\,\\phi_{n}(x)\\,dx = \\delta_{mn}$.\n- **Constraint:** The derivation must use only fundamental properties of Legendre polynomials on $[-1,1]$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, rooted in the standard theory of orthogonal polynomials and their application in numerical methods for partial differential equations (specifically, spectral and discontinuous Galerkin methods). The concepts of Legendre polynomials, $L^2$ inner products, and orthonormality are well-defined mathematical constructs. The problem is well-posed, stating clear objectives and providing all necessary definitions and constraints. It is objective and free of any ambiguity or subjective claims. The problem does not violate any of the invalidity criteria listed in the prompt.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n**Derivation of the Diagonal Mass Matrix Entries, $M_{nn}$**\n\nThe diagonal entries of the mass matrix are given by $M_{nn} = \\langle P_{n},P_{n}\\rangle = \\int_{-1}^{1} P_{n}(x)^2\\,dx$. We will derive a closed-form expression for $M_{nn}$ by leveraging the three-term recurrence relation for Legendre polynomials, which is a fundamental property. The Legendre polynomials with the normalization $P_{n}(1)=1$ satisfy the following recurrence relation for $n \\ge 1$:\n$$ (n+1)P_{n+1}(x) = (2n+1)xP_{n}(x) - nP_{n-1}(x) $$\nRearranging this for the term $xP_{n}(x)$, we get:\n$$ (2n+1)xP_{n}(x) = (n+1)P_{n+1}(x) + nP_{n-1}(x) $$\nLet's multiply this equation by $P_{n-1}(x)$ and integrate over the interval $I=[-1,1]$:\n$$ (2n+1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = (n+1)\\int_{-1}^{1} P_{n+1}(x)P_{n-1}(x)\\,dx + n\\int_{-1}^{1} P_{n-1}(x)^2\\,dx $$\nA fundamental property of Legendre polynomials is their orthogonality on $[-1,1]$ with respect to the $L^2$ inner product, i.e., $\\int_{-1}^{1} P_{m}(x)P_{n}(x)\\,dx = 0$ for $m \\ne n$. Applying this property, the first integral on the right-hand side is zero. The second integral is, by definition, $M_{n-1,n-1}$. Thus, for $n \\ge 1$:\n$$ (2n+1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = n M_{n-1,n-1} $$\nThis gives a first expression for the integral involving $x$:\n$$ \\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = \\frac{n}{2n+1} M_{n-1,n-1} $$\nNext, we can shift the index in the recurrence relation from $n$ to $n-1$ (for $n \\ge 2$, or more generally by defining $P_{-1}=0$):\n$$ nP_{n}(x) = (2(n-1)+1)xP_{n-1}(x) - (n-1)P_{n-2}(x) $$\nRearranging for $xP_{n-1}(x)$:\n$$ (2n-1)xP_{n-1}(x) = nP_{n}(x) + (n-1)P_{n-2}(x) $$\nNow, multiply this equation by $P_{n}(x)$ and integrate over $I$:\n$$ (2n-1)\\int_{-1}^{1} xP_{n-1}(x)P_{n}(x)\\,dx = n\\int_{-1}^{1} P_{n}(x)^2\\,dx + (n-1)\\int_{-1}^{1} P_{n-2}(x)P_{n}(x)\\,dx $$\nBy orthogonality, the second integral on the right-hand side is zero. The first integral on the right is $M_{nn}$. Therefore, for $n \\ge 1$:\n$$ (2n-1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = n M_{nn} $$\nThis yields a second expression for the same integral:\n$$ \\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = \\frac{n}{2n-1} M_{nn} $$\nEquating the two expressions for the integral $\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx$, we obtain a recurrence relation for $M_{nn}$:\n$$ \\frac{n}{2n-1} M_{nn} = \\frac{n}{2n+1} M_{n-1,n-1} $$\nFor $n \\ge 1$, we can divide by $n$ to get:\n$$ M_{nn} = \\frac{2n-1}{2n+1} M_{n-1,n-1} $$\nTo find a closed-form expression, we need a base case. For $n=0$, $P_0(x)$ is a constant. The condition $P_0(1)=1$ implies $P_0(x)=1$. Thus,\n$$ M_{00} = \\int_{-1}^{1} P_0(x)^2\\,dx = \\int_{-1}^{1} 1^2\\,dx = [x]_{-1}^{1} = 1 - (-1) = 2 $$\nBy repeatedly applying the recurrence relation, we get a telescoping product:\n$$ M_{nn} = \\left(\\frac{2n-1}{2n+1}\\right)M_{n-1,n-1} = \\left(\\frac{2n-1}{2n+1}\\right)\\left(\\frac{2n-3}{2n-1}\\right)M_{n-2,n-2} = \\dots = \\left(\\frac{2n-1}{2n+1}\\right)\\left(\\frac{2n-3}{2n-1}\\right)\\dots\\left(\\frac{1}{3}\\right)M_{00} $$\nThe intermediate terms cancel out, leaving:\n$$ M_{nn} = \\frac{1}{2n+1} M_{00} = \\frac{2}{2n+1} $$\nThis formula holds for all $n \\ge 0$.\n\n**Derivation of the Orthonormal Scaling Factor, $\\alpha_{n}$**\n\nThe basis $\\{\\phi_{n}(x) = \\alpha_{n}P_{n}(x)\\}$ is required to be orthonormal, which means $\\int_{-1}^{1} \\phi_{m}(x)\\phi_{n}(x)\\,dx = \\delta_{mn}$.\nSubstituting the definition of $\\phi_n(x)$:\n$$ \\int_{-1}^{1} (\\alpha_{m}P_{m}(x))(\\alpha_{n}P_{n}(x))\\,dx = \\alpha_{m}\\alpha_{n}\\int_{-1}^{1} P_{m}(x)P_{n}(x)\\,dx = \\alpha_{m}\\alpha_{n}M_{mn} = \\delta_{mn} $$\nThe orthogonality of the Legendre polynomials $\\{P_n\\}$ ensures that $M_{mn} = 0$ for $m \\ne n$, so the condition is already satisfied for off-diagonal terms. For the diagonal terms ($m=n$), we require:\n$$ \\alpha_{n}^2 M_{nn} = 1 $$\nSolving for $\\alpha_n^2$:\n$$ \\alpha_{n}^2 = \\frac{1}{M_{nn}} $$\nUsing the previously derived expression for $M_{nn}$:\n$$ \\alpha_{n}^2 = \\frac{1}{\\frac{2}{2n+1}} = \\frac{2n+1}{2} $$\nBy convention, the scaling factor $\\alpha_n$ is taken to be positive. Therefore, taking the positive square root gives:\n$$ \\alpha_{n} = \\sqrt{\\frac{2n+1}{2}} $$\n\nThe derived closed-form expressions for the diagonal mass matrix entries and the orthonormal scaling factor are $M_{nn} = \\frac{2}{2n+1}$ and $\\alpha_{n} = \\sqrt{\\frac{2n+1}{2}}$, respectively.",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{2n+1} & \\sqrt{\\frac{2n+1}{2}} \\end{pmatrix}} $$"
        },
        {
            "introduction": "Having established the basics in one dimension, we now extend our analysis to two-dimensional reference elements: the triangle and the quadrilateral. The choice of element geometry fundamentally alters the structure of the polynomial space used for approximation . This exercise asks you to compare the growth in the number of basis functions (degrees of freedom) for total-degree spaces on triangles versus tensor-product spaces on quadrilaterals, revealing a key factor in the computational cost and efficiency of different mesh types.",
            "id": "3400513",
            "problem": "Consider the reference triangle $\\hat{T}^2 := \\{(r,s)\\in \\mathbb{R}^2 : r \\ge 0, s \\ge 0, r+s \\le 1\\}$ and the reference quadrilateral $\\hat{Q}^2 := [-1,1]^2$. Let $P^p(\\hat{T}^2)$ denote the space of polynomials in two variables with total degree at most $p$ restricted to $\\hat{T}^2$, and let $Q^p(\\hat{Q}^2)$ denote the tensor-product polynomial space on $\\hat{Q}^2$ formed by polynomials of degree at most $p$ in each coordinate. In the context of spectral and Discontinuous Galerkin (DG) methods, modal bases on $\\hat{T}^2$ and $\\hat{Q}^2$ are typically constructed to span $P^p(\\hat{T}^2)$ and $Q^p(\\hat{Q}^2)$, respectively. Starting from the core definition of these polynomial spaces and basic combinatorial counting of monomials, derive general expressions for $\\dim P^p(\\hat{T}^2)$ and $\\dim Q^p(\\hat{Q}^2)$ in terms of $p$. Then, compute these dimensions explicitly for $p=0,1,2,3$. Finally, interpret the asymptotic growth rates with respect to $p$ and explain, in words, how the difference in growth arises from the total-degree versus tensor-product structure, and how this impacts the number of modal degrees of freedom on $\\hat{T}^2$ compared with $\\hat{Q}^2$ for the same $p$.\n\nFor your final boxed answer, list the eight requested dimensions in a single row matrix, ordered as $\\dim P^0(\\hat{T}^2)$, $\\dim P^1(\\hat{T}^2)$, $\\dim P^2(\\hat{T}^2)$, $\\dim P^3(\\hat{T}^2)$, $\\dim Q^0(\\hat{Q}^2)$, $\\dim Q^1(\\hat{Q}^2)$, $\\dim Q^2(\\hat{Q}^2)$, $\\dim Q^3(\\hat{Q}^2)$. No rounding is required and no physical units are involved.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of polynomial approximation spaces used in numerical analysis, is well-posed with clear and standard definitions, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe core of the problem is to determine the dimensions of two standard polynomial spaces used in spectral and discontinuous Galerkin methods, $P^p(\\hat{T}^2)$ and $Q^p(\\hat{Q}^2)$. The dimension of a vector space is equal to the number of elements in any of its bases. We will determine these dimensions by counting the number of monomials that form a basis for each space.\n\nFirst, let us find the dimension of $P^p(\\hat{T}^2)$, the space of polynomials in two variables (let's use $r$ and $s$) with a total degree of at most $p$. A basis for this space is given by the set of all monomials of the form $r^i s^j$, where $i$ and $j$ are non-negative integers satisfying the condition $i+j \\le p$.\nTo count the number of such pairs $(i, j)$, we can use a combinatorial argument. The problem is equivalent to finding the number of non-negative integer solutions to the inequality $i+j \\le p$. We can introduce a non-negative integer slack variable $k$ such that $k = p - (i+j)$. The inequality then transforms into the equation $i+j+k = p$, where $i \\ge 0$, $j \\ge 0$, and $k \\ge 0$.\nThis is a classic stars-and-bars problem in combinatorics. We are distributing $p$ identical items (stars) into $3$ distinct bins (representing variables $i$, $j$, and $k$). The number of ways to do this is given by the multiset coefficient formula:\n$$ \\dim P^p(\\hat{T}^2) = \\binom{p+3-1}{3-1} = \\binom{p+2}{2} $$\nExpanding the binomial coefficient, we obtain the general expression for the dimension:\n$$ \\dim P^p(\\hat{T}^2) = \\frac{(p+2)!}{2!(p+2-2)!} = \\frac{(p+2)(p+1)}{2} $$\n\nNext, we find the dimension of $Q^p(\\hat{Q}^2)$, the tensor-product polynomial space on $\\hat{Q}^2 = [-1,1]^2$. This space is formed by polynomials of degree at most $p$ in each coordinate variable (let's use $\\xi$ and $\\eta$). A basis for $Q^p(\\hat{Q}^2)$ is the set of monomials $\\xi^i \\eta^j$ where the exponents $i$ and $j$ independently satisfy $0 \\le i \\le p$ and $0 \\le j \\le p$.\nThe number of possible integer values for the exponent $i$ (from $0$ to $p$) is $p+1$.\nSimilarly, the number of possible integer values for the exponent $j$ (from $0$ to $p$) is $p+1$.\nSince the choices for $i$ and $j$ are independent, the total number of basis monomials is the product of the number of choices for each exponent. Therefore, the dimension is:\n$$ \\dim Q^p(\\hat{Q}^2) = (p+1)(p+1) = (p+1)^2 $$\n\nNow, we compute these dimensions for the specific polynomial degrees $p=0, 1, 2, 3$.\n\nFor the triangular element space $P^p(\\hat{T}^2)$:\n- For $p=0$: $\\dim P^0(\\hat{T}^2) = \\frac{(0+2)(0+1)}{2} = \\frac{2 \\cdot 1}{2} = 1$.\n- For $p=1$: $\\dim P^1(\\hat{T}^2) = \\frac{(1+2)(1+1)}{2} = \\frac{3 \\cdot 2}{2} = 3$.\n- For $p=2$: $\\dim P^2(\\hat{T}^2) = \\frac{(2+2)(2+1)}{2} = \\frac{4 \\cdot 3}{2} = 6$.\n- For $p=3$: $\\dim P^3(\\hat{T}^2) = \\frac{(3+2)(3+1)}{2} = \\frac{5 \\cdot 4}{2} = 10$.\n\nFor the quadrilateral element space $Q^p(\\hat{Q}^2)$:\n- For $p=0$: $\\dim Q^0(\\hat{Q}^2) = (0+1)^2 = 1^2 = 1$.\n- For $p=1$: $\\dim Q^1(\\hat{Q}^2) = (1+1)^2 = 2^2 = 4$.\n- For $p=2$: $\\dim Q^2(\\hat{Q}^2) = (2+1)^2 = 3^2 = 9$.\n- For $p=3$: $\\dim Q^3(\\hat{Q}^2) = (3+1)^2 = 4^2 = 16$.\n\nFinally, we interpret the asymptotic growth and the structural differences.\nThe asymptotic growth rate for large $p$ for each dimension is determined by the highest power of $p$ in its formula:\n- $\\dim P^p(\\hat{T}^2) = \\frac{1}{2}p^2 + \\frac{3}{2}p + 1$. The growth is quadratic, with $\\dim P^p(\\hat{T}^2) \\sim \\frac{1}{2}p^2$ as $p \\to \\infty$.\n- $\\dim Q^p(\\hat{Q}^2) = p^2 + 2p + 1$. The growth is also quadratic, with $\\dim Q^p(\\hat{Q}^2) \\sim p^2$ as $p \\to \\infty$.\n\nThe difference in growth arises directly from the differing constraints on the monomial exponents. For $P^p(\\hat{T}^2)$, the exponents $(i,j)$ must satisfy $i \\ge 0, j \\ge 0, i+j \\le p$. If we were to plot these integer pairs in a plane, they would completely fill a discrete triangle with vertices at $(0,0)$, $(p,0)$, and $(0,p)$. For $Q^p(\\hat{Q}^2)$, the exponents must satisfy $0 \\le i \\le p$ and $0 \\le j \\le p$. These integer pairs fill a discrete square with vertices at $(0,0)$, $(p,0)$, $(p,p)$, and $(0,p)$.\n\nFor any $p \\ge 1$, the square region of exponents for $Q^p$ strictly contains the triangular region for $P^p$. The \"extra\" monomials in $Q^p$ are those for which $i+j > p$. These include higher-order interaction terms such as $\\xi^p\\eta^p$, which has a total degree of $2p$. The maximum total degree in $Q^p(\\hat{Q}^2)$ is $2p$, whereas for $P^p(\\hat{T}^2)$ it is $p$ by definition. This structural difference means that for the same polynomial order parameter $p$, the quadrilateral space $Q^p(\\hat{Q}^2)$ contains significantly more basis functions, or degrees of freedom, than the triangular space $P^p(\\hat{T}^2)$. Asymptotically, for large $p$, a quadrilateral element has approximately twice the number of degrees of freedom as a triangular element ($\\lim_{p \\to \\infty} \\frac{\\dim Q^p}{\\dim P^p} = \\frac{p^2}{p^2/2} = 2$). This has direct implications for computational cost in methods like DG, where triangular meshes can be more economical than quadrilateral meshes when using the same polynomial order $p$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 3 & 6 & 10 & 1 & 4 & 9 & 16\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The theoretical elegance of an orthonormal basis, which yields an identity mass matrix, often meets a practical challenge during implementation: integrals must be computed numerically. This final practice explores the crucial interplay between modal bases and numerical quadrature rules . You will analyze how different quadrature choices impact the discrete mass matrix and derive the exact modification that occurs when using a common, but technically suboptimal, integration scheme, revealing a trade-off between mathematical purity and computational efficiency.",
            "id": "3400503",
            "problem": "Consider the one-dimensional reference element $[-1,1]$ and the modal basis $\\{\\phi_{k}\\}_{k=0}^{N}$ defined by $\\phi_{k}(x) = \\sqrt{\\frac{2k+1}{2}}\\,P_{k}(x)$, where $P_{k}(x)$ is the Legendre polynomial of degree $k$. The exact (continuous) mass matrix entries are $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$. By construction, with exact integration, the mass matrix is the identity.\n\nYou are asked to analyze the diagonalization of the mass matrix under quadrature and to quantify the effect of using a suboptimal quadrature rule, starting only from fundamental definitions and widely accepted facts about Legendre polynomials and Gaussian-type quadrature.\n\nTasks:\n1. Using the properties that Gauss-Legendre (GL) quadrature with $Q$ points is exact for polynomials of degree up to $2Q-1$, and Gauss-Lobatto-Legendre (GLL) quadrature with $Q$ points is exact for polynomials of degree up to $2Q-3$ and includes the endpoints, determine the minimal $Q$ (as a function of $N$) required for each rule so that the discrete mass matrix computed by quadrature is exactly diagonal for the chosen modal basis up to degree $N$.\n2. Specialize to GLL with $Q = N+1$ points and prove that the discrete mass matrix remains diagonal but with a modified highest-mode diagonal entry. Use only the following standard facts: \n   - The GLL nodes are $\\{x_{i}\\}_{i=0}^{N}$ consisting of the endpoints $\\pm 1$ and the $N-1$ interior roots of $P'_{N}(x)$.\n   - The associated GLL weights satisfy $w_{0} = w_{N} = \\frac{2}{N(N+1)}$ and, for interior nodes $x_{i}$ with $1 \\le i \\le N-1$, $w_{i} = \\frac{2}{N(N+1)\\,P_{N}(x_{i})^{2}}$.\n   - The endpoint values $P_{N}(\\pm 1) = (\\pm 1)^{N}$.\n   - For degrees $i \\ne j$ with $i+j \\le 2N-1$, the GLL rule with $Q=N+1$ integrates $\\phi_{i}\\phi_{j}$ exactly to zero.\n3. Denote by $M^{\\mathrm{GLL}}_{NN}$ the discrete mass entry for the highest mode computed using GLL with $Q=N+1$. Derive a closed-form expression for $M^{\\mathrm{GLL}}_{NN}$ as a function of $N$.\n\nProvide as your final answer the exact analytic expression for $M^{\\mathrm{GLL}}_{NN}$ in terms of $N$. Do not round. No units are involved. Express your final answer in simplest closed form.",
            "solution": "The problem statement has been validated and is deemed valid. It is a well-posed, scientifically grounded problem in the field of numerical analysis, specifically concerning spectral methods. All definitions and properties are standard and consistently applied.\n\nThe problem asks for an analysis of a discrete mass matrix constructed using a modal basis of normalized Legendre polynomials on the reference interval $[-1, 1]$. The discrete mass matrix entries, computed using a quadrature rule with $Q$ points $\\{x_q\\}$ and weights $\\{w_q\\}$, are given by:\n$$ M^{\\mathrm{Q}}_{ij} = \\sum_{q=0}^{Q-1} w_q \\phi_i(x_q) \\phi_j(x_q) $$\nThis approximates the continuous mass matrix $M_{ij} = \\int_{-1}^{1} \\phi_i(x) \\phi_j(x) dx$. The basis functions are $\\phi_k(x) = \\sqrt{\\frac{2k+1}{2}} P_k(x)$, where $P_k(x)$ is the Legendre polynomial of degree $k$. Due to the orthogonality property of Legendre polynomials, $\\int_{-1}^{1} P_i(x) P_j(x) dx = \\frac{2}{2i+1} \\delta_{ij}$, the continuous mass matrix is the identity matrix:\n$$ M_{ij} = \\sqrt{\\frac{2i+1}{2}} \\sqrt{\\frac{2j+1}{2}} \\int_{-1}^{1} P_i(x) P_j(x) dx = \\frac{\\sqrt{(2i+1)(2j+1)}}{2} \\frac{2}{2i+1} \\delta_{ij} = \\delta_{ij} $$\nWe will now address the three tasks presented.\n\nTask 1: Minimal quadrature points for a diagonal mass matrix.\nThe integrand for the mass matrix entry $M_{ij}$ is $\\phi_i(x)\\phi_j(x)$. This product is a polynomial of degree $i+j$. For a basis of polynomials up to degree $N$, the indices $i$ and $j$ range from $0$ to $N$. The maximum degree of the polynomial to be integrated is therefore $N+N = 2N$, which occurs for the product $\\phi_N(x)\\phi_N(x)$. For the discrete mass matrix to be exactly diagonal (and equal to the identity matrix), the quadrature rule must be exact for all polynomial products $\\phi_i(x)\\phi_j(x)$ for $0 \\le i, j \\le N$. This requires the rule to be exact for polynomials of degree up to at least $2N$.\n\nFor Gauss-Legendre (GL) quadrature with $Q$ points, the rule is exact for polynomials of degree up to $2Q-1$. To ensure exactness for degree $2N$, we require:\n$$ 2Q-1 \\ge 2N $$\n$$ 2Q \\ge 2N+1 $$\n$$ Q \\ge N + \\frac{1}{2} $$\nSince the number of points $Q$ must be an integer, the minimal number of GL points is $Q = N+1$.\n\nFor Gauss-Lobatto-Legendre (GLL) quadrature with $Q$ points, the rule is exact for polynomials of degree up to $2Q-3$. To ensure exactness for degree $2N$, we require:\n$$ 2Q-3 \\ge 2N $$\n$$ 2Q \\ge 2N+3 $$\n$$ Q \\ge N + \\frac{3}{2} $$\nSince $Q$ must be an integer, the minimal number of GLL points is $Q = N+2$.\n\nTask 2: Analysis of the GLL mass matrix with $Q = N+1$ points.\nThis choice of $Q=N+1$ points for GLL quadrature is suboptimal, as determined in Task 1. The rule is exact for polynomials of degree up to $2(N+1)-3 = 2N-1$.\n\nWe analyze the discrete mass matrix entries $M^{\\mathrm{GLL}}_{ij} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)\\phi_{j}(x_q)$.\n\nFor off-diagonal entries ($i \\ne j$, where $0 \\le i, j \\le N$):\nThe degree of the integrand $\\phi_i(x)\\phi_j(x)$ is $i+j$. The maximum possible degree is for $(i,j) = (N, N-1)$ or $(N-1, N)$, which is $2N-1$. For all other pairs $i \\ne j$, the degree $i+j$ is less than $2N-1$. Since the quadrature rule is exact for polynomials of degree up to $2N-1$, the discrete sum equals the exact integral for all off-diagonal terms:\n$$ M^{\\mathrm{GLL}}_{ij} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)\\phi_{j}(x_q) = \\int_{-1}^{1} \\phi_i(x)\\phi_j(x) dx = \\delta_{ij} = 0 \\quad \\text{for } i \\ne j $$\nThis confirms that the discrete mass matrix is diagonal.\n\nFor diagonal entries ($i = j$):\nThe degree of the integrand $\\phi_i(x)^2$ is $2i$.\nFor $i < N$, the maximum degree is $2(N-1) = 2N-2$. Since $2N-2 < 2N-1$, the quadrature rule is exact for these terms.\n$$ M^{\\mathrm{GLL}}_{ii} = \\sum_{q=0}^{N} w_{q} \\phi_{i}(x_q)^2 = \\int_{-1}^{1} \\phi_i(x)^2 dx = 1 \\quad \\text{for } i = 0, 1, \\dots, N-1 $$\nFor the highest mode, $i=N$, the degree of the integrand $\\phi_N(x)^2$ is $2N$. Since $2N > 2N-1$, the quadrature rule is not exact for this term. Therefore, the value of $M^{\\mathrm{GLL}}_{NN}$ will not, in general, be equal to $1$.\nThis proves that the matrix is diagonal but with a specifically modified entry for the highest mode, $M^{\\mathrm{GLL}}_{NN}$.\n\nTask 3: Derivation of the expression for $M^{\\mathrm{GLL}}_{NN}$.\nWe seek to compute the value of $M^{\\mathrm{GLL}}_{NN}$ using the GLL quadrature rule with $Q=N+1$ points, nodes $\\{x_q\\}_{q=0}^N$, and weights $\\{w_q\\}_{q=0}^N$.\n$$ M^{\\mathrm{GLL}}_{NN} = \\sum_{q=0}^{N} w_q \\phi_N(x_q)^2 $$\nSubstituting the definition $\\phi_N(x) = \\sqrt{\\frac{2N+1}{2}} P_N(x)$, we get:\n$$ M^{\\mathrm{GLL}}_{NN} = \\sum_{q=0}^{N} w_q \\left( \\sqrt{\\frac{2N+1}{2}} P_N(x_q) \\right)^2 = \\frac{2N+1}{2} \\sum_{q=0}^{N} w_q P_N(x_q)^2 $$\nWe evaluate the sum by splitting it into endpoint contributions ($q=0, N$) and interior point contributions ($q=1, \\dots, N-1$).\nThe endpoints of the GLL grid are $x_0 = -1$ and $x_N = 1$. The associated weights are given as $w_0 = w_N = \\frac{2}{N(N+1)}$.\nThe endpoint values of the Legendre polynomial are $P_N(1) = 1$ and $P_N(-1) = (-1)^N$.\nThe contribution from the endpoints is:\n$$ w_0 P_N(x_0)^2 + w_N P_N(x_N)^2 = \\frac{2}{N(N+1)} P_N(-1)^2 + \\frac{2}{N(N+1)} P_N(1)^2 $$\n$$ = \\frac{2}{N(N+1)} ((-1)^N)^2 + \\frac{2}{N(N+1)} (1)^2 = \\frac{2}{N(N+1)} (1+1) = \\frac{4}{N(N+1)} $$\nThe interior GLL nodes $\\{x_q\\}_{q=1}^{N-1}$ are the roots of $P'_N(x)$. The weights for these nodes are given as $w_q = \\frac{2}{N(N+1)P_N(x_q)^2}$.\nThe contribution from the interior points is:\n$$ \\sum_{q=1}^{N-1} w_q P_N(x_q)^2 = \\sum_{q=1}^{N-1} \\left( \\frac{2}{N(N+1)P_N(x_q)^2} \\right) P_N(x_q)^2 $$\nThe term $P_N(x_q)^2$ cancels, leaving:\n$$ \\sum_{q=1}^{N-1} \\frac{2}{N(N+1)} $$\nThis is a sum of a constant term over $N-1$ indices.\n$$ (N-1) \\times \\frac{2}{N(N+1)} = \\frac{2(N-1)}{N(N+1)} $$\nThe total sum is the sum of endpoint and interior contributions:\n$$ \\sum_{q=0}^{N} w_q P_N(x_q)^2 = \\frac{4}{N(N+1)} + \\frac{2(N-1)}{N(N+1)} = \\frac{4 + 2N - 2}{N(N+1)} = \\frac{2N+2}{N(N+1)} = \\frac{2(N+1)}{N(N+1)} = \\frac{2}{N} $$\nFinally, we substitute this result back into the expression for $M^{\\mathrm{GLL}}_{NN}$:\n$$ M^{\\mathrm{GLL}}_{NN} = \\frac{2N+1}{2} \\left( \\sum_{q=0}^{N} w_q P_N(x_q)^2 \\right) = \\frac{2N+1}{2} \\cdot \\frac{2}{N} $$\n$$ M^{\\mathrm{GLL}}_{NN} = \\frac{2N+1}{N} $$\nThis can also be written as $2 + \\frac{1}{N}$. This is the closed-form expression for the diagonal entry of the highest mode.",
            "answer": "$$\\boxed{\\frac{2N+1}{N}}$$"
        }
    ]
}