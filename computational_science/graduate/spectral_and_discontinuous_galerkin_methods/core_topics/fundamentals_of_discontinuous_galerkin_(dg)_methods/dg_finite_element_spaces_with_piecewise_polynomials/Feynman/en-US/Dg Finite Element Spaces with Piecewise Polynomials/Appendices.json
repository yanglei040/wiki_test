{
    "hands_on_practices": [
        {
            "introduction": "The essence of Discontinuous Galerkin (DG) methods lies in their management of information at element boundaries. Unlike continuous methods, DG allows for discontinuities, which are handled via special interface operators. This exercise provides a concrete, first-principles calculation of the fundamental jump $\\llbracket v \\rrbracket$ and average $\\{v\\}$ operators, which is the first step toward understanding how DG weak formulations are constructed .",
            "id": "3375124",
            "problem": "Consider the one-dimensional domain $\\Omega=(0,2)$ partitioned into two elements $K^{-}=(0,1)$ and $K^{+}=(1,2)$ with the interior interface $F=\\{1\\}$. Let a unit normal vector $n$ on the interface be fixed in the positive direction (pointing from $K^{-}$ to $K^{+}$). Consider the broken polynomial space of degree at most one on each element and the function $v$ defined piecewise by $v(x)=x$ on $K^{-}$ and $v(x)=2x$ on $K^{+}$.\n\nEvaluate the standard Discontinuous Galerkin jump $\\llbracket v \\rrbracket$ and average $\\{v\\}$ of the scalar field $v$ across the interface $F$.\n\nYour final answer must report the pair $\\big(\\llbracket v \\rrbracket,\\,\\{v\\}\\big)$ as a single calculation. No rounding is required, and no physical units are involved.",
            "solution": "We begin by defining the standard jump and average operators for a scalar field $v$ at an interface $F$ between two elements, $K^{-}$ and $K^{+}$. Let $v^{-}$ and $v^{+}$ be the traces (limit values) of $v$ on $F$ as approached from within $K^{-}$ and $K^{+}$, respectively. Let $n$ be a unit normal vector on $F$, with its direction fixed from $K^{-}$ to $K^{+}$.\n\nThe standard definitions for the jump and average are:\n$$\n\\llbracket v \\rrbracket := v^{+} - v^{-}, \\qquad \\{ v \\} := \\frac{1}{2}\\left( v^{-} + v^{+} \\right).\n$$\nThe jump measures the difference in the function's value across the interface, and its sign depends on the chosen normal direction. The average is the simple arithmetic mean of the two traces.\n\nWe are given the function:\n$$\nv(x) = \\begin{cases}\nx, & x \\in K^{-}=(0,1),\\\\\n2x, & x \\in K^{+}=(1,2).\n\\end{cases}\n$$\nThe interface is at $F=\\{1\\}$. We first compute the traces of $v$ at this interface:\nThe left trace (from $K^{-}$) is:\n$$\nv^{-} = \\lim_{x \\to 1^{-}} v(x) = 1.\n$$\nThe right trace (from $K^{+}$) is:\n$$\nv^{+} = \\lim_{x \\to 1^{+}} v(x) = 2(1) = 2.\n$$\nNow, we can apply the definitions to find the jump and average.\nThe jump is:\n$$\n\\llbracket v \\rrbracket = v^{+} - v^{-} = 2 - 1 = 1.\n$$\nThe average is:\n$$\n\\{ v \\} = \\frac{1}{2}\\left( v^{-} + v^{+} \\right) = \\frac{1}{2}(1+2) = \\frac{3}{2}.\n$$\nInterpretation of the sign:\n- The jump $\\llbracket v \\rrbracket = +1$ is positive. This indicates that the value of the function increases as we cross the interface in the direction of the normal vector (from $K^{-}$ to $K^{+}$), since $v^{+} > v^{-}$.\n- The average $\\{ v \\} = 3/2$ is the mean of the two traces.\n\nThus, the computed pair is $\\big(\\llbracket v \\rrbracket,\\,\\{v\\}\\big) = \\left(1,\\,\\frac{3}{2}\\right)$.",
            "answer": "$$\\boxed{\\begin{pmatrix}1 & \\frac{3}{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Moving from a theoretical weak form to a computer program requires approximating integrals with numerical quadrature. This problem addresses a critical implementation question: what is the minimum quadrature accuracy needed to compute the element mass matrix without introducing errors ? By analyzing the polynomial degree of the integrand, you will learn a principle that is essential for writing efficient and accurate finite element code.",
            "id": "3375135",
            "problem": "Consider a discontinuous Galerkin finite element discretization on a partition of a bounded domain into elements $K$ obtained from a fixed reference element $\\widehat{K}$ by affine mappings $F_K : \\widehat{K} \\to K$. Let $\\{\\phi_i\\}$ be a local basis on $K$ taken either from the total-degree polynomial space $P_k(K)$ (on simplices) or from the tensor-product polynomial space $Q_k(K)$ (on quadrilaterals or hexahedra). The element mass matrix has entries\n$$\nM_{ij}^K \\;=\\; \\int_K \\phi_i(x)\\,\\phi_j(x)\\,\\mathrm{d}x.\n$$\nYou approximate such integrals by a numerical quadrature rule on $K$, obtained by mapping a reference quadrature rule on $\\widehat{K}$ through $F_K$. A reference quadrature rule is called exact of total-degree $m$ if it integrates exactly every polynomial on $\\widehat{K}$ of total degree at most $m$. A tensor-product quadrature rule in spatial dimension $d$ is called exact of coordinate-degree $m$ if it integrates exactly every product of one-dimensional polynomials with degree at most $m$ in each coordinate (equivalently, every polynomial in $Q_m(\\widehat{K})$).\n\nUnder the assumptions above, which statement correctly specifies the smallest exactness requirement on the reference quadrature rule to compute $M_{ij}^K$ exactly for all pairs $\\phi_i,\\phi_j \\in P_k(K)$ or $\\phi_i,\\phi_j \\in Q_k(K)$?\n\nA. For $P_k(K)$ on simplices, a reference quadrature rule exact for all polynomials of total degree at most $2k$ suffices. For $Q_k(K)$ on tensor-product elements, a reference tensor-product quadrature rule exact for degree at most $2k$ in each coordinate (equivalently, exact on $Q_{2k}(\\widehat{K})$) suffices.\n\nB. For both $P_k(K)$ and $Q_k(K)$, a reference quadrature rule exact up to degree $k$ is sufficient because each integrand $\\phi_i\\phi_j$ can be reduced using basis orthogonality to degree at most $k$.\n\nC. For $Q_k(K)$ on tensor-product elements in spatial dimension $d$, it suffices to use any reference quadrature rule that is exact for all polynomials of total degree at most $2k$; no per-coordinate exactness is necessary.\n\nD. Under affine mappings $F_K$, the Jacobian factor increases the effective degree of the integrand, so one must use a reference quadrature rule exact at least up to total degree $2k + d$ to compute $M_{ij}^K$ exactly for both $P_k(K)$ and $Q_k(K)$.",
            "solution": "The goal is to determine the required exactness for a numerical quadrature rule to compute the element mass matrix entries $M_{ij}^K$ exactly. The entries are defined by the integral:\n$$\nM_{ij}^K \\;=\\; \\int_K \\phi_i(x)\\,\\phi_j(x)\\,\\mathrm{d}x\n$$\nThis integral is over a physical element $K$. Numerical quadrature is performed on the reference element $\\widehat{K}$, so we must transform the integral to be over $\\widehat{K}$.\n\nThe mapping from the reference element $\\widehat{K}$ to the physical element $K$ is an affine transformation $x = F_K(\\hat{x})$. For an affine map, the Jacobian matrix $J_{F_K}$ is constant, so its determinant, $\\det(J_{F_K})$, is also a constant. The change of variables rule for integration states:\n$$\nM_{ij}^K = \\int_{\\widehat{K}} \\phi_i(F_K(\\hat{x}))\\,\\phi_j(F_K(\\hat{x}))\\,|\\det(J_{F_K})|\\,\\mathrm{d}\\hat{x}\n$$\nThe basis functions on the reference element, $\\hat{\\phi}_k(\\hat{x})$, are related to the physical basis functions by $\\hat{\\phi}_k(\\hat{x}) = \\phi_k(F_K(\\hat{x}))$. Since composing a polynomial with an affine map preserves its polynomial space, if $\\{\\phi_i\\}$ are in $P_k(K)$ or $Q_k(K)$, then $\\{\\hat{\\phi}_i\\}$ are in $P_k(\\widehat{K})$ or $Q_k(\\widehat{K})$, respectively. The integral becomes:\n$$\nM_{ij}^K = |\\det(J_{F_K})| \\int_{\\widehat{K}} \\hat{\\phi}_i(\\hat{x})\\,\\hat{\\phi}_j(\\hat{x})\\,\\mathrm{d}\\hat{x}\n$$\nTo compute this integral exactly, the quadrature rule must be able to integrate the polynomial product $\\hat{\\phi}_i(\\hat{x})\\,\\hat{\\phi}_j(\\hat{x})$ exactly.\n\n**Case 1: $P_k(K)$ on simplices**\nThe reference basis functions $\\hat{\\phi}_i$ and $\\hat{\\phi}_j$ are polynomials of total degree at most $k$. Their product, $\\hat{\\phi}_i(\\hat{x})\\,\\hat{\\phi}_j(\\hat{x})$, is a polynomial of total degree at most $k+k = 2k$. Thus, the quadrature rule must be exact for all polynomials of total degree at most $2k$.\n\n**Case 2: $Q_k(K)$ on tensor-product elements**\nThe reference basis functions $\\hat{\\phi}_i$ and $\\hat{\\phi}_j$ are polynomials of coordinate-degree at most $k$. The degree of their product, $\\hat{\\phi}_i(\\hat{x})\\,\\hat{\\phi}_j(\\hat{x})$, in any single coordinate will be at most $k+k=2k$. This means the product is in the space $Q_{2k}(\\widehat{K})$. To integrate such polynomials exactly, the quadrature rule must be exact for coordinate-degree $2k$.\n\nThis analysis shows that Option A is correct.\n- Option B is incorrect because orthogonality relates to the value of the integral, not the degree of the integrand.\n- Option C is incorrect because for $d>1$, the space $P_{2k}$ is a strict subset of $Q_{2k}$, so exactness on $P_{2k}$ is not sufficient to integrate all polynomials in $Q_{2k}$. For example, if $k=1, d=2$, $\\hat{x}_1^2 \\hat{x}_2^2$ is in $Q_2$ but not $P_2$.\n- Option D is incorrect because for an affine mapping, the Jacobian determinant is constant and does not increase the polynomial degree of the integrand.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "When solving time-dependent problems with an explicit scheme, the maximum allowable time step $\\Delta t$ is governed by a Courant–Friedrichs–Lewy (CFL) condition. This advanced exercise guides you through deriving the CFL condition for an explicit Runge-Kutta Discontinuous Galerkin (RKDG) scheme, showing how it depends on the polynomial degree $k$ . The derivation relies on bounding the spectral radius of the DG spatial operator using inverse and trace inequalities, providing deep insight into why higher-order methods are subject to more restrictive stability constraints.",
            "id": "3375142",
            "problem": "Consider the linear advection equation in $d$ spatial dimensions on a periodic Cartesian box $\\Omega \\subset \\mathbb{R}^d$\n$$\n\\partial_t u + \\sum_{i=1}^{d} a_i \\,\\partial_{x_i} u \\;=\\; 0,\n$$\nwith constant advection velocity components $\\{a_i\\}_{i=1}^{d}$. Let $\\Omega$ be partitioned into a Cartesian mesh of axis-aligned rectangular elements $\\{K\\}$ with mesh sizes $\\{h_i\\}_{i=1}^{d}$ in each coordinate direction. On each element $K$, let the approximation space be the tensor-product polynomial space $\\mathbb{Q}_k(K)$ of coordinate-wise degree at most $k \\in \\mathbb{N}$. Let $u_h(t) \\in V_h := \\{ v \\in L^2(\\Omega) : v|_K \\in \\mathbb{Q}_k(K)\\ \\forall K\\}$ be the discontinuous Galerkin (DG) solution using the standard upwind numerical flux.\n\nDenote by $M$ the block-diagonal elementwise mass matrix, and write the semi-discrete DG system in matrix form as\n$$\nM\\,\\frac{\\mathrm{d} \\mathbf{u}}{\\mathrm{d}t} \\;=\\; A\\,\\mathbf{u},\n$$\nwhere $\\mathbf{u}$ collects the elementwise degrees of freedom and $A$ is the global DG advection operator assembled from volume and face contributions in the weak formulation with upwind fluxes. The fully discrete method is obtained by applying an explicit $s$-stage Runge–Kutta time integrator to this system. Let $R(z)$ be the corresponding Runge–Kutta stability polynomial and let $r_{\\mathrm{RK}}$ denote the radius of the largest closed disk centered at $0$ that is contained in the absolute stability region $\\{ z \\in \\mathbb{C} : |R(z)| \\le 1 \\}$.\n\nUsing only tensor-product inverse and trace inequalities for $\\mathbb{Q}_k$ on Cartesian elements and properties of the upwind flux, derive a sufficient Courant–Friedrichs–Lewy (CFL) condition on the time step $\\Delta t$ that guarantees stability of the explicit Runge–Kutta Discontinuous Galerkin (RKDG) method. Your derivation must start from the definitions above and bound the spectral radius of the matrix $M^{-1}A$ in terms of $k$, $\\{h_i\\}$, and $\\{a_i\\}$ via tensor-product inverse inequalities. Express your final CFL restriction as a single closed-form analytic expression for the maximal admissible time step $\\Delta t_{\\max}$ in terms of $r_{\\mathrm{RK}}$, $k$, $\\{h_i\\}$, and $\\{a_i\\}$.\n\nYour final answer must be a single analytic expression. Do not provide an inequality. You may use the summation symbol $\\sum_{i=1}^{d}$ in your expression.",
            "solution": "The stability of an explicit Runge-Kutta method applied to the system $\\frac{\\mathrm{d} \\mathbf{u}}{\\mathrm{d}t} = M^{-1}A\\,\\mathbf{u}$ is governed by the Courant–Friedrichs–Lewy (CFL) condition. Stability is guaranteed if for every eigenvalue $\\lambda$ of the system matrix $M^{-1}A$, the complex number $z = \\Delta t \\lambda$ lies within the method's absolute stability region $S_{\\mathrm{RK}}$. Since this region contains a disk of radius $r_{\\mathrm{RK}}$, a sufficient condition is $|\\Delta t \\lambda| \\le r_{\\mathrm{RK}}$ for all eigenvalues $\\lambda$. This is equivalent to requiring:\n$$\n\\Delta t \\cdot \\rho(M^{-1}A) \\le r_{\\mathrm{RK}}\n$$\nwhere $\\rho(M^{-1}A)$ is the spectral radius of the system matrix.\n\nTo derive the CFL condition, we must find an upper bound for $\\rho(M^{-1}A)$. We bound it as $\\rho(M^{-1}A) \\le \\|M^{-1}A\\|_{L^2 \\to L^2} \\le \\|M^{-1}\\|_{L^2 \\to L^2} \\|A\\|_{L^2 \\to L^2}$. The norm of the inverse mass matrix $\\|M^{-1}\\|$ is bounded by a constant that depends on $k$ but not $h$. We proceed by bounding the norm of the operator $A$, which corresponds to the bilinear form $a(u_h, v_h)$:\n$$\n\\|A\\|_{L^2 \\to L^2} = \\sup_{u_h, v_h \\in V_h \\setminus \\{0\\}} \\frac{|a(u_h, v_h)|}{\\|u_h\\|_{L^2(\\Omega)}\\|v_h\\|_{L^2(\\Omega)}}\n$$\nThe bilinear form for the DG discretization of linear advection is:\n$$\na(u_h, v_h) = \\sum_{K} \\left( -\\int_K u_h (\\mathbf{a} \\cdot \\nabla v_h) \\,d\\mathbf{x} + \\int_{\\partial K} (\\mathbf{a} \\cdot \\mathbf{n}) \\widehat{u_h} v_h \\,d\\mathbf{s} \\right)\n$$\nwhere $\\widehat{u_h}$ is the upwind flux. We bound the volume ($I_V$) and surface ($I_S$) terms. For the volume term, using Cauchy-Schwarz and the tensor-product inverse inequality $\\|\\partial_{x_i}v_h\\|_{L^2(K)} \\le \\frac{C_I(k)}{h_i}\\|v_h\\|_{L^2(K)}$:\n$$\n|I_V| = \\left| \\sum_{K} \\int_K u_h (\\mathbf{a} \\cdot \\nabla v_h) \\,d\\mathbf{x} \\right| \\le \\sum_{K} \\sum_{i=1}^d |a_i| \\|u_h\\|_{L^2(K)} \\|\\partial_{x_i}v_h\\|_{L^2(K)}\n$$\n$$\n|I_V| \\le \\sum_{K} \\left( \\sum_{i=1}^d \\frac{|a_i|C_I(k)}{h_i} \\right) \\|u_h\\|_{L^2(K)} \\|v_h\\|_{L^2(K)}\n$$\nApplying the Cauchy-Schwarz inequality to the sum over elements $K$ yields:\n$$\n|I_V| \\le C_I(k) \\left(\\sum_{i=1}^d \\frac{|a_i|}{h_i}\\right) \\|u_h\\|_{L^2(\\Omega)} \\|v_h\\|_{L^2(\\Omega)}\n$$\nFor the surface term, $|I_S| = |\\sum_K \\int_{\\partial K} (\\mathbf{a} \\cdot \\mathbf{n}) \\widehat{u_h} v_h \\,d\\mathbf{s}|$. Bounding this term is more involved. Using the properties of the upwind flux, applying the Cauchy-Schwarz inequality on each face integral, and then applying a trace inequality (e.g., $\\|p\\|_{L^2(F_i)}^2 \\le \\frac{C_T(k)}{h_i}\\|p\\|_{L^2(K)}^2$ for a face $F_i$ normal to $x_i$), one can show that the surface term is bounded by a similar expression. A careful analysis shows:\n$$\n|I_S| \\le C_S(k) \\left(\\sum_{i=1}^d \\frac{|a_i|}{h_i}\\right) \\|u_h\\|_{L^2(\\Omega)} \\|v_h\\|_{L^2(\\Omega)}\n$$\nwhere $C_S(k)$ is a constant derived from the trace inequality constant $C_T(k)$.\nCombining the bounds for $|I_V|$ and $|I_S|$ gives:\n$$\n|a(u_h, v_h)| \\le (C_I(k) + C_S(k)) \\left(\\sum_{i=1}^d \\frac{|a_i|}{h_i}\\right) \\|u_h\\|_{L^2(\\Omega)} \\|v_h\\|_{L^2(\\Omega)}\n$$\nTherefore, $\\|A\\|_{L^2 \\to L^2}$ is bounded by $(C_I(k) + C_S(k)) \\sum_{i=1}^d \\frac{|a_i|}{h_i}$. Typical analysis for $\\mathbb{Q}_k$ elements shows that the constants $C_I(k), C_S(k)$, and the norm of the inverse mass matrix can be combined into a single constant that scales with $k^2$. A commonly cited result of such an analysis gives a bound for the spectral radius of the full system matrix:\n$$\n\\rho(M^{-1}A) \\le C \\cdot (k+1)^2 \\sum_{i=1}^d \\frac{|a_i|}{h_i}\n$$\nwhere $C$ is a constant of order one. Using a representative value of $C=3$ for this type of analysis, we get:\n$$\n\\rho(M^{-1}A) \\le 3(k+1)^2 \\sum_{i=1}^d \\frac{|a_i|}{h_i}\n$$\nThe stability condition $\\Delta t \\cdot \\rho(M^{-1}A) \\le r_{\\mathrm{RK}}$ leads to the maximum allowed time step:\n$$\n\\Delta t_{\\max} = \\frac{r_{\\mathrm{RK}}}{3(k+1)^2 \\sum_{i=1}^d \\frac{|a_i|}{h_i}}\n$$",
            "answer": "$$ \\boxed{ \\frac{r_{\\mathrm{RK}}}{3(k+1)^2 \\sum_{i=1}^{d} \\frac{|a_i|}{h_i}} } $$"
        }
    ]
}