{
    "hands_on_practices": [
        {
            "introduction": "The journey into Discontinuous Galerkin (DG) methods begins with mastering the fundamental mechanics on a single element. This first practice guides you through the essential process of translating a partial differential equation into a discrete system by deriving the local mass and stiffness matrices. By performing element-wise integration by parts and incorporating a numerical flux, you will see firsthand how the DG formulation is constructed, providing a foundational skill for analyzing and implementing these powerful methods .",
            "id": "3382909",
            "problem": "Consider the one-dimensional linear advection initial-value problem on the interval $[0,1]$,\n$$u_{t} + a\\,u_{x} = 0,$$\nwith constant advection speed $a>0$ and inflow boundary data set to zero at $x=0$. Use a single spectral element $K=[0,1]$ with an affine mapping from the reference coordinate $\\xi\\in[-1,1]$ to the physical coordinate $x$ given by $x(\\xi) = \\frac{1}{2}(1+\\xi)$ so that $h=1$ and $dx = \\frac{1}{2}\\,d\\xi$. Employ the Discontinuous Galerkin (DG) method with the following orthonormal modal basis on the reference element:\n$$\\phi_{0}(\\xi) = \\frac{1}{\\sqrt{2}},\\qquad \\phi_{1}(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi.$$\nLet the discrete solution be $u_{h}(x(\\xi),t) = c_{0}(t)\\,\\phi_{0}(\\xi) + c_{1}(t)\\,\\phi_{1}(\\xi)$ and choose the upwind numerical flux $\\widehat{u}$ determined by the sign of $a\\cdot n$ on the element faces. In one dimension, the outward unit normal is $n=-1$ at $\\xi=-1$ and $n=+1$ at $\\xi=+1$, hence $a\\cdot n<0$ at the left face and $a\\cdot n>0$ at the right face. Impose inflow boundary data $u_{\\text{in}}=0$ at $x=0$ (the left face), so that $\\widehat{u}=u_{\\text{in}}=0$ there, and take $\\widehat{u}=u^{-}$ at $x=1$ (the right face), where $u^{-}$ denotes the interior trace.\n\nStarting from the weak form on the element and integrating by parts on $K$, derive the element-level mass matrix entries $M_{ij}$ and advection (stiffness) matrix entries $A_{ij}$ associated with the bilinear forms\n$$M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx,\\qquad\nA_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds,$$\nfor $i,j\\in\\{0,1\\}$, where $ds$ is the measure on the faces. Express the final answer as a single row matrix containing the eight entries in the following order:\n$$(M_{00},\\,M_{01},\\,M_{10},\\,M_{11},\\,A_{00},\\,A_{01},\\,A_{10},\\,A_{11}).$$\nNo rounding is required. Provide your answer as exact algebraic expressions in terms of $a$.",
            "solution": "The user wants to find the mass and stiffness matrix entries for a Discontinuous Galerkin (DG) discretization of a 1D linear advection problem on a single element.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   **PDE:** $u_{t} + a\\,u_{x} = 0$ on the interval $[0,1]$.\n-   **Advection Speed:** $a > 0$, constant.\n-   **Boundary Conditions:** Inflow boundary data $u_{\\text{in}} = 0$ at $x=0$.\n-   **Element:** A single spectral element $K=[0,1]$, so the element size is $h=1$.\n-   **Mapping:** Affine map from reference coordinate $\\xi \\in [-1,1]$ to physical coordinate $x \\in [0,1]$ is $x(\\xi) = \\frac{1}{2}(1+\\xi)$.\n-   **Jacobian:** The differential transformation is $dx = \\frac{1}{2}d\\xi$. The derivative transformation is $\\partial_x = (\\frac{d\\xi}{dx})\\partial_\\xi = 2\\partial_\\xi$.\n-   **Basis Functions:** An orthonormal modal basis on the reference element:\n    -   $\\phi_{0}(\\xi) = \\frac{1}{\\sqrt{2}}$\n    -   $\\phi_{1}(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi$\n-   **Discrete Solution:** $u_{h}(x(\\xi),t) = c_{0}(t)\\,\\phi_{0}(\\xi) + c_{1}(t)\\,\\phi_{1}(\\xi)$.\n-   **Numerical Flux:** Upwind flux $\\widehat{u}$.\n    -   At the left face ($x=0, \\xi=-1$), the outward normal is $n=-1$. Since $a>0$, $a \\cdot n < 0$ (inflow). The flux is $\\widehat{u} = u_{\\text{in}} = 0$.\n    -   At the right face ($x=1, \\xi=1$), the outward normal is $n=+1$. Since $a>0$, $a \\cdot n > 0$ (outflow). The flux is $\\widehat{u} = u^{-}$, where $u^{-}$ is the interior trace of the solution.\n-   **Matrix Definitions:**\n    -   Mass Matrix: $M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx$ for $i,j \\in \\{0,1\\}$.\n    -   Advection Matrix: $A_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$ for $i,j \\in \\{0,1\\}$.\n\n**1.2. Validation**\nThe problem is scientifically grounded, well-posed, objective, and self-contained. It describes a standard procedure in the field of DG methods. The definitions and data are consistent and sufficient to perform the required calculations. The problem is declared **valid**.\n\n### Step 2: Calculation of Matrix Entries\n\n**2.1. Mass Matrix $M_{ij}$**\n\nThe mass matrix entries are defined by $M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx$. We transform the integral from the physical element $K=[0,1]$ to the reference element $\\xi \\in [-1,1]$ using $dx = \\frac{1}{2}d\\xi$.\n$$M_{ij} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,\\frac{1}{2}\\,d\\xi = \\frac{1}{2} \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi$$\nThe basis functions $\\{\\phi_0, \\phi_1\\}$ are given as orthonormal on the reference element, which means $\\int_{-1}^{1} \\phi_{i}(\\xi)\\phi_{j}(\\xi)d\\xi = \\delta_{ij}$ (the Kronecker delta).\nTherefore, $M_{ij} = \\frac{1}{2}\\delta_{ij}$.\n\nThe specific entries are:\n-   $M_{00} = \\frac{1}{2}(1) = \\frac{1}{2}$\n-   $M_{01} = \\frac{1}{2}(0) = 0$\n-   $M_{10} = \\frac{1}{2}(0) = 0$\n-   $M_{11} = \\frac{1}{2}(1) = \\frac{1}{2}$\n\n**2.2. Advection (Stiffness) Matrix $A_{ij}$**\n\nThe advection matrix entries are given by the formula:\n$$A_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$$\nThis expression consists of a volume integral part and a boundary flux part.\n\n**Volume Integral Part:** Let's denote this part by $V_{ij}$.\n$$V_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx$$\nWe transform to the reference element, using $\\partial_x = 2\\partial_\\xi$ and $dx = \\frac{1}{2}d\\xi$:\n$$V_{ij} = -\\int_{-1}^{1} a\\,(2\\partial_{\\xi}\\phi_{i})\\,\\phi_{j}\\,\\frac{1}{2}\\,d\\xi = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{i})\\,\\phi_{j}\\,d\\xi$$\nFirst, we find the derivatives of the basis functions with respect to $\\xi$:\n-   $\\partial_{\\xi}\\phi_{0}(\\xi) = \\partial_{\\xi}(\\frac{1}{\\sqrt{2}}) = 0$\n-   $\\partial_{\\xi}\\phi_{1}(\\xi) = \\partial_{\\xi}(\\sqrt{\\frac{3}{2}}\\xi) = \\sqrt{\\frac{3}{2}}$\n\nNow we compute the entries $V_{ij}$:\n-   $V_{00} = -a\\int_{-1}^{1} (0)\\,\\phi_{0}\\,d\\xi = 0$\n-   $V_{01} = -a\\int_{-1}^{1} (0)\\,\\phi_{1}\\,d\\xi = 0$\n-   $V_{10} = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{1})\\,\\phi_{0}\\,d\\xi = -a\\int_{-1}^{1} \\sqrt{\\frac{3}{2}}\\,\\frac{1}{\\sqrt{2}}\\,d\\xi = -a\\frac{\\sqrt{3}}{2}\\int_{-1}^{1}d\\xi = -a\\frac{\\sqrt{3}}{2}(2) = -a\\sqrt{3}$\n-   $V_{11} = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{1})\\,\\phi_{1}\\,d\\xi = -a\\int_{-1}^{1} \\sqrt{\\frac{3}{2}}\\,\\sqrt{\\frac{3}{2}}\\xi\\,d\\xi = -a\\frac{3}{2}\\int_{-1}^{1}\\xi\\,d\\xi = -a\\frac{3}{2}\\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0$\n\n**Boundary Flux Part:** Let's denote this part's contribution to the matrix by $B_{ij}$. The term is $\\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$. Although $\\widehat{u}$ depends on the full solution $u_h = \\sum_j c_j \\phi_j$, we can deduce the matrix entries $B_{ij}$ by seeing how this term depends on each coefficient $c_j$. The boundary of the element $K=[0,1]$ consists of two faces: $x=0$ and $x=1$. The integral becomes a sum over these points.\n$$\\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds = [a\\,n\\,\\widehat{u}\\,\\phi_{i}]_{x=1} + [a\\,n\\,\\widehat{u}\\,\\phi_{i}]_{x=0}$$\n-   At the left face ($x=0$, $\\xi=-1$): $n=-1$, and the flux is $\\widehat{u}=u_{\\text{in}}=0$. The contribution is $0$.\n-   At the right face ($x=1$, $\\xi=1$): $n=+1$, and the flux is $\\widehat{u}=u^{-} = u_h(1,t)$. The contribution is $a(1)u_h(1,t)\\phi_i(1) = a\\,u_h(1,t)\\phi_i(1)$.\n\nThe total boundary term for the $i$-th equation is $a\\,u_h(1,t)\\phi_i(1)$. Substituting $u_h(1,t) = \\sum_j c_j(t)\\phi_j(1)$:\n$$a\\left(\\sum_{j} c_j(t)\\phi_j(1)\\right)\\phi_i(1) = \\sum_{j} c_j(t) [a\\,\\phi_i(1)\\phi_j(1)]$$\nFrom this, we identify the matrix contribution $B_{ij} = a\\,\\phi_i(1)\\phi_j(1)$.\nWe need the values of the basis functions at $\\xi=1$:\n-   $\\phi_0(1) = \\frac{1}{\\sqrt{2}}$\n-   $\\phi_1(1) = \\sqrt{\\frac{3}{2}}$\n\nNow we compute the entries $B_{ij}$:\n-   $B_{00} = a\\,\\phi_0(1)\\phi_0(1) = a(\\frac{1}{\\sqrt{2}})(\\frac{1}{\\sqrt{2}}) = \\frac{a}{2}$\n-   $B_{01} = a\\,\\phi_0(1)\\phi_1(1) = a(\\frac{1}{\\sqrt{2}})(\\sqrt{\\frac{3}{2}}) = \\frac{a\\sqrt{3}}{2}$\n-   $B_{10} = a\\,\\phi_1(1)\\phi_0(1) = a(\\sqrt{\\frac{3}{2}})(\\frac{1}{\\sqrt{2}}) = \\frac{a\\sqrt{3}}{2}$\n-   $B_{11} = a\\,\\phi_1(1)\\phi_1(1) = a(\\sqrt{\\frac{3}{2}})(\\sqrt{\\frac{3}{2}}) = \\frac{3a}{2}$\n\n**Total Advection Matrix:** $A_{ij} = V_{ij} + B_{ij}$.\n-   $A_{00} = V_{00} + B_{00} = 0 + \\frac{a}{2} = \\frac{a}{2}$\n-   $A_{01} = V_{01} + B_{01} = 0 + \\frac{a\\sqrt{3}}{2} = \\frac{\\sqrt{3}}{2}a$\n-   $A_{10} = V_{10} + B_{10} = -a\\sqrt{3} + \\frac{a\\sqrt{3}}{2} = -\\frac{a\\sqrt{3}}{2} = -\\frac{\\sqrt{3}}{2}a$\n-   $A_{11} = V_{11} + B_{11} = 0 + \\frac{3a}{2} = \\frac{3}{2}a$\n\n### Step 3: Final Answer Assembly\n\nThe problem requires the final answer as a single row matrix containing the eight entries in the order $(M_{00},\\,M_{01},\\,M_{10},\\,M_{11},\\,A_{00},\\,A_{01},\\,A_{10},\\,A_{11})$.\nThe calculated values are:\n-   $M_{00} = \\frac{1}{2}$\n-   $M_{01} = 0$\n-   $M_{10} = 0$\n-   $M_{11} = \\frac{1}{2}$\n-   $A_{00} = \\frac{a}{2}$\n-   $A_{01} = \\frac{\\sqrt{3}}{2}a$\n-   $A_{10} = -\\frac{\\sqrt{3}}{2}a$\n-   $A_{11} = \\frac{3}{2}a$\nAssembling these into the final row matrix gives the solution.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2} & 0 & 0 & \\frac{1}{2} & \\frac{a}{2} & \\frac{\\sqrt{3}}{2}a & -\\frac{\\sqrt{3}}{2}a & \\frac{3}{2}a \\end{pmatrix} } $$"
        },
        {
            "introduction": "While exact integration by parts guarantees an elegant equivalence between weak and strong forms, practical implementations rely on numerical quadrature, which introduces approximation errors. This exercise explores a critical consequence of this approximation: the potential loss of local conservation when the quadrature rule is not sufficiently accurate for the chosen polynomial space . By quantifying the 'conservation defect' in a concrete example, you will develop a deeper understanding of how numerical integration choices impact the fundamental properties of a DG scheme.",
            "id": "3382930",
            "problem": "Consider the one-dimensional scalar conservation law on a single reference element $\\widehat{K}=[-1,1]$,\n$$\nu_{t} + \\partial_{x} f(u) = 0,\n$$\nwith smooth flux $f$. In a Discontinuous Galerkin (DG) formulation, the weak and strong forms are connected by element-wise integration by parts. With exact integration, the identity\n$$\n\\int_{-1}^{1} \\varphi'(x)\\, g(x)\\, dx + \\int_{-1}^{1} \\varphi(x)\\, g'(x)\\, dx = \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}\n$$\nholds for smooth functions $g$ and test functions $\\varphi$. This identity underlies local conservation: choosing $\\varphi(x)=1$ yields that the time-rate of change of the element-average of $u$ equals the net flux across the element boundaries.\n\nNow replace the exact integrals by a quadrature rule of degree $q$ (exact for polynomials up to degree $q$), denoted by the linear functional $Q[\\cdot]$. Define the discrete integration-by-parts residual\n$$\n\\mathcal{E}(\\varphi,g) \\equiv Q\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] - \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\nWhen $\\mathcal{E}(\\varphi,g)\\neq 0$, discrete integration by parts breaks and the strong and weak DG forms are not algebraically equivalent under the chosen quadrature.\n\nTo concretely quantify the resulting loss of local conservation on a single element under underintegration, proceed as follows.\n\n1. Work with $f(u)=u$ (linear advection), so $g(x)=u(x)$ and $g'(x)=u_{x}(x)$.\n2. Use the strong-form volume term $Q\\!\\left[\\varphi(x)\\, u_{x}(x)\\right]$ and a consistent boundary numerical flux equal to the physical flux, so the boundary contribution is $\\left[u(x)\\right]_{x=-1}^{x=1}$ for any $\\varphi$ with $\\varphi(1)=\\varphi(-1)=1$.\n3. Take $\\varphi(x)=1$ and choose a polynomial trial $u(x)=x^{5}$ that belongs to a DG polynomial space of degree $p=6$ (so $q<p$ is satisfied by the quadrature choice below).\n4. Use Simpson’s rule on $[-1,1]$,\n$$\nQ[h] \\;=\\; \\frac{1}{3}\\,\\big(h(-1) + 4\\,h(0) + h(1)\\big),\n$$\nwhich is exact for polynomials up to degree $q=3$.\n\nDefine the scalar local conservation defect for the element as\n$$\n\\mathcal{C} \\;\\equiv\\; Q\\!\\left[u_{x}\\right] \\;-\\; \\big(u(1)-u(-1)\\big).\n$$\n\nStarting only from the exact integration-by-parts identity and the above discrete definitions, evaluate $\\mathcal{C}$ exactly for the specified data. Your final answer must be a single real number. Do not include any units. Do not round; give the exact value.",
            "solution": "We begin from the fundamental integration-by-parts identity on the element $\\widehat{K}=[-1,1]$:\n$$\n\\int_{-1}^{1} \\varphi'(x)\\, g(x)\\, dx + \\int_{-1}^{1} \\varphi(x)\\, g'(x)\\, dx \\;=\\; \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\nIn a Discontinuous Galerkin setting, this identity ensures equivalence of weak and strong formulations when integrals are evaluated exactly. When a quadrature $Q[\\cdot]$ replaces each integral, the discrete counterpart reads\n$$\nQ\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] \\;\\stackrel{?}{=}\\; \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\nIn general, the equality holds whenever the quadrature is exact for the polynomial integrands involved. Otherwise, a residual\n$$\n\\mathcal{E}(\\varphi,g) \\equiv Q\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] - \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}\n$$\nmeasures the breakdown of discrete integration by parts.\n\nLocal conservation for the element is obtained by taking $\\varphi(x)=1$. For the continuous problem with exact integration, we have\n$$\n\\int_{-1}^{1} 1 \\cdot g'(x)\\, dx = \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\nUnder quadrature, the strong-form volume term becomes $Q[g'(x)]$, producing the discrete conservation balance\n$$\nQ[g'(x)] \\;\\stackrel{?}{=}\\; \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\nThus the scalar conservation defect is\n$$\n\\mathcal{C} \\equiv Q[g'(x)] - \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\n\nFor the specified data, we set $f(u)=u$, so $g(x)=u(x)$ and $g'(x)=u_{x}(x)$. We choose $\\varphi(x)=1$, polynomial degree $p=6$, and $u(x)=x^{5}$, which lies in the approximation space $\\mathbb{P}_{6}$. The quadrature is Simpson’s rule on $[-1,1]$,\n$$\nQ[h] = \\frac{1}{3}\\,\\big(h(-1) + 4\\,h(0) + h(1)\\big),\n$$\nwhich has degree of exactness $q=3$, strictly less than $p$.\n\nWe now compute $\\mathcal{C}$:\n1. Compute $u_{x}(x)$:\n$$\nu(x) = x^{5} \\quad\\Rightarrow\\quad u_{x}(x) = 5 x^{4}.\n$$\n2. Evaluate the quadrature of $u_{x}$:\n$$\nQ[u_{x}] = \\frac{1}{3}\\,\\big(u_{x}(-1) + 4\\,u_{x}(0) + u_{x}(1)\\big) = \\frac{1}{3}\\,\\big(5(-1)^{4} + 4\\cdot 5\\, 0^{4} + 5(1)^{4}\\big) = \\frac{1}{3}\\,(5 + 0 + 5) = \\frac{10}{3}.\n$$\n3. Evaluate the boundary difference of $u$:\n$$\nu(1) - u(-1) = 1^{5} - (-1)^{5} = 1 - (-1) = 2.\n$$\n4. Form the conservation defect:\n$$\n\\mathcal{C} = Q[u_{x}] - \\big(u(1) - u(-1)\\big) = \\frac{10}{3} - 2 = \\frac{4}{3}.\n$$\n\nInterpretation. The nonzero value $\\mathcal{C}=\\frac{4}{3}$ quantitatively demonstrates the breakdown of discrete integration by parts and the consequent loss of local conservation on the element when the quadrature is underintegrated (degree $q=3$) relative to the polynomial interactions arising in the strong form for $u \\in \\mathbb{P}_{6}$. With exact integration, $\\mathcal{C}$ would be zero, because $\\int_{-1}^{1} u_{x}\\, dx = u(1) - u(-1)$. Here, Simpson’s rule does not integrate $u_{x}=5x^{4}$ exactly, and the resulting quadrature error directly manifests as the conservation defect.",
            "answer": "$$\\boxed{\\frac{4}{3}}$$"
        },
        {
            "introduction": "Our exploration culminates in the complex and highly relevant setting of curvilinear meshes, where geometry itself introduces profound challenges to conservation. For integration by parts to facilitate perfect flux cancellation across element interfaces, the geometric description of the shared face must be consistent from both sides . This practice provides a compelling counterexample, demonstrating how inconsistent approximation of face metrics can violate this requirement and break discrete conservation, a concept central to the Geometric Conservation Law (GCL).",
            "id": "3382891",
            "problem": "Consider a two-element interface in a spectral element Discontinuous Galerkin (DG) discretization on a curvilinear mesh in two spatial dimensions. The elements share a single interior face that, in physical coordinates, is parameterized by the smooth curve $r(s) = (x(s), y(s))$ with $s \\in [-1, 1]$, where $x(s) = s$ and $y(s) = \\gamma s^{2}$ for a fixed curvature parameter $\\gamma \\in \\mathbb{R}$. Let $|r'(s)|$ denote the metric factor (the physical line element density) on the face, where $r'(s) = \\frac{d r}{d s}(s)$.\n\nIn the DG weak form, element-wise Integration by Parts (IBP) cancellation across the shared interior face relies on the metric identity that the face measure and outward normal factor match exactly when computed consistently on both adjacent elements. Assume the numerical surface integration on the face uses the two-point Gauss–Legendre quadrature on $[-1, 1]$ with nodes $s = \\pm a$ and weights $w = 1$, where $a = 1/\\sqrt{3}$.\n\nSuppose the left element underintegrates the face metric by replacing $|r'(s)|$ with the quadratic interpolant $P(s)$ that matches $|r'(s)|$ at $s = -1$, $s = 0$, and $s = 1$, while the right element uses the exact $|r'(s)|$. Consider a constant physical flux across the face and a constant test function so that the only factor affecting IBP cancellation is the metric factor. Define the discrete mismatch\n$$\n\\Delta(\\gamma) = \\sum_{q=1}^{2} w_{q} \\left( P(s_{q}) - |r'(s_{q})| \\right),\n$$\nwith $(s_{1}, s_{2}) = (-a, a)$ and $(w_{1}, w_{2}) = (1, 1)$. Starting from the geometric definitions and the two-point Gauss–Legendre rule, compute $\\Delta(\\gamma)$ as a closed-form analytic expression in $\\gamma$.\n\nFinally, propose a principled remedy, grounded in the Geometric Conservation Law (GCL), to recover element-wise IBP cancellation on curved faces, via either overintegration or the construction of discrete metric terms that satisfy the metric identities across the shared face. Your final answer must be the analytic expression for $\\Delta(\\gamma)$ without numerical evaluation or rounding.",
            "solution": "The problem statement is found to be valid. It is scientifically grounded in the theory of numerical methods for partial differential equations, specifically Discontinuous Galerkin (DG) methods on curved meshes. The problem is well-posed, with all necessary information provided to derive a unique solution for the discrete mismatch $\\Delta(\\gamma)$. The terminology is objective and standard within the field. Therefore, a full solution is warranted.\n\nThe solution proceeds in three parts. First, we derive the analytic expression for the exact face metric factor $|r'(s)|$. Second, we construct the quadratic interpolant $P(s)$ used by the left element. Third, we compute the discrete mismatch $\\Delta(\\gamma)$ using the specified two-point Gauss-Legendre quadrature rule. Finally, we discuss the Geometric Conservation Law (GCL) and propose remedies for the observed mismatch.\n\n**Step 1: Derivation of the Exact Metric Factor**\n\nThe shared face is parameterized by the curve $r(s) = (x(s), y(s))$ for $s \\in [-1, 1]$, with a specific form given by:\n$$\nx(s) = s\n$$\n$$\ny(s) = \\gamma s^{2}\n$$\nThe tangent vector to the curve is $r'(s) = \\frac{dr}{ds}(s) = (x'(s), y'(s))$. We compute the derivatives:\n$$\nx'(s) = \\frac{d}{ds}(s) = 1\n$$\n$$\ny'(s) = \\frac{d}{ds}(\\gamma s^{2}) = 2\\gamma s\n$$\nThus, the tangent vector is $r'(s) = (1, 2\\gamma s)$.\n\nThe metric factor, which represents the physical line element density, is the magnitude of this tangent vector:\n$$\n|r'(s)| = \\sqrt{(x'(s))^{2} + (y'(s))^{2}} = \\sqrt{1^{2} + (2\\gamma s)^{2}}\n$$\n$$\n|r'(s)| = \\sqrt{1 + 4\\gamma^{2}s^{2}}\n$$\nThis is the exact metric factor used for the face integration on the right element.\n\n**Step 2: Construction of the Quadratic Interpolant**\n\nThe left element approximates the metric factor with a quadratic polynomial $P(s) = As^{2} + Bs + C$ that interpolates the exact metric $|r'(s)|$ at the points $s = -1$, $s = 0$, and $s = 1$.\n\nFirst, we evaluate the exact metric at these interpolation points:\n$$\n|r'(-1)| = \\sqrt{1 + 4\\gamma^{2}(-1)^{2}} = \\sqrt{1 + 4\\gamma^{2}}\n$$\n$$\n|r'(0)| = \\sqrt{1 + 4\\gamma^{2}(0)^{2}} = \\sqrt{1} = 1\n$$\n$$\n|r'(1)| = \\sqrt{1 + 4\\gamma^{2}(1)^{2}} = \\sqrt{1 + 4\\gamma^{2}}\n$$\nThe conditions for the interpolant $P(s)$ are:\n1.  $P(-1) = A(-1)^{2} + B(-1) + C = A - B + C = \\sqrt{1 + 4\\gamma^{2}}$\n2.  $P(0) = A(0)^{2} + B(0) + C = C = 1$\n3.  $P(1) = A(1)^{2} + B(1) + C = A + B + C = \\sqrt{1 + 4\\gamma^{2}}$\n\nSubstituting $C=1$ into the first and third equations gives:\n$$\nA - B + 1 = \\sqrt{1 + 4\\gamma^{2}}\n$$\n$$\nA + B + 1 = \\sqrt{1 + 4\\gamma^{2}}\n$$\nSubtracting the first equation from the second yields $2B = 0$, which implies $B=0$.\nSubstituting $B=0$ and $C=1$ into the third equation gives $A + 1 = \\sqrt{1 + 4\\gamma^{2}}$, which implies $A = \\sqrt{1 + 4\\gamma^{2}} - 1$.\n\nThus, the quadratic interpolant is:\n$$\nP(s) = \\left(\\sqrt{1 + 4\\gamma^{2}} - 1\\right)s^{2} + 1\n$$\n\n**Step 3: Computation of the Discrete Mismatch $\\Delta(\\gamma)$**\n\nThe discrete mismatch is defined by the numerical quadrature of the difference between the approximate and exact metric factors:\n$$\n\\Delta(\\gamma) = \\sum_{q=1}^{2} w_{q} \\left( P(s_{q}) - |r'(s_{q})| \\right)\n$$\nThe problem specifies a two-point Gauss-Legendre quadrature rule on $[-1, 1]$ with nodes $s_{1} = -a$ and $s_{2} = a$, where $a = 1/\\sqrt{3}$, and weights $w_{1} = w_{2} = 1$.\n\nSubstituting these values, we have:\n$$\n\\Delta(\\gamma) = w_{1}(P(s_{1}) - |r'(s_{1})|) + w_{2}(P(s_{2}) - |r'(s_{2})|)\n$$\n$$\n\\Delta(\\gamma) = 1 \\cdot (P(-a) - |r'(-a)|) + 1 \\cdot (P(a) - |r'(a)|)\n$$\nBoth $P(s)$ and $|r'(s)|$ are even functions of $s$ (they depend only on $s^2$). Therefore, $P(-a) = P(a)$ and $|r'(-a)| = |r'(a)|$. The expression simplifies to:\n$$\n\\Delta(\\gamma) = 2 \\left( P(a) - |r'(a)| \\right)\n$$\nWe now evaluate $P(a)$ and $|r'(a)|$ at the quadrature node $a = 1/\\sqrt{3}$. Note that $a^{2} = (1/\\sqrt{3})^{2} = 1/3$.\n\nFirst, the exact metric at $s=a$:\n$$\n|r'(a)| = \\sqrt{1 + 4\\gamma^{2}a^{2}} = \\sqrt{1 + 4\\gamma^{2}\\left(\\frac{1}{3}\\right)} = \\sqrt{1 + \\frac{4\\gamma^{2}}{3}}\n$$\nNext, the approximate metric at $s=a$:\n$$\nP(a) = \\left(\\sqrt{1 + 4\\gamma^{2}} - 1\\right)a^{2} + 1 = \\left(\\sqrt{1 + 4\\gamma^{2}} - 1\\right)\\left(\\frac{1}{3}\\right) + 1\n$$\n$$\nP(a) = \\frac{1}{3}\\sqrt{1 + 4\\gamma^{2}} - \\frac{1}{3} + 1 = \\frac{1}{3}\\sqrt{1 + 4\\gamma^{2}} + \\frac{2}{3}\n$$\nFinally, we substitute these into the expression for $\\Delta(\\gamma)$:\n$$\n\\Delta(\\gamma) = 2 \\left( \\left( \\frac{1}{3}\\sqrt{1 + 4\\gamma^{2}} + \\frac{2}{3} \\right) - \\sqrt{1 + \\frac{4\\gamma^{2}}{3}} \\right)\n$$\nDistributing the factor of $2$ gives the final closed-form expression for the mismatch:\n$$\n\\Delta(\\gamma) = \\frac{2}{3}\\sqrt{1 + 4\\gamma^{2}} + \\frac{4}{3} - 2\\sqrt{1 + \\frac{4\\gamma^{2}}{3}}\n$$\n\n**Principled Remedy based on the Geometric Conservation Law (GCL)**\n\nThe non-zero value of $\\Delta(\\gamma)$ for $\\gamma \\neq 0$ represents a failure of the discrete scheme to maintain conservation at the element interface. This is a violation of the Geometric Conservation Law (GCL). The GCL requires that the numerical scheme be able to exactly represent a constant state, which for a conservation law discretized with an integral formulation translates to the condition that the sum of discrete \"area-weighted normal\" vectors over an element's boundary must be zero. For perfect cancellation of interface fluxes in a DG method, this implies that the geometric factors (metric term times normal) computed by the two adjacent elements for their shared face must be equal and opposite. Since the normals are already equal and opposite by definition ($\\mathbf{n}_{L} = -\\mathbf{n}_{R}$), this requires the computed face measures to be identical: $(J_{q}^{f})_{L} = (J_{q}^{f})_{R}$ at each quadrature point $q$. In our problem, this means we must have $P(s_{q}) = |r'(s_{q})|$ at the quadrature points, which is not true in general.\n\nThe problem asks for remedies grounded in the GCL. Two principled approaches are:\n\n1.  **Sufficiently Accurate Quadrature (Over-integration)**: The problem arises because the left element uses an approximation of the geometry, $P(s)$, while the right uses the exact geometry, $|r'(s)|$. If both elements had used the exact metric factor $|r'(s)|$, there would be no mismatch by construction. However, since $|r'(s)| = \\sqrt{1+4\\gamma^2 s^2}$ is not a polynomial, no finite-order Gauss rule can integrate it exactly. The remedy is to use a quadrature rule of sufficiently high order (over-integration) to compute the integral of $|r'(s)|$ to machine precision on both elements. With a consistent and highly accurate evaluation of the face metric integral, the discrete contributions from both sides of the interface would match, restoring conservation.\n\n2.  **Construction of Discrete Metric Terms**: A more robust and modern approach in high-order methods is to abandon the direct evaluation of the continuous metric factors from the geometry mapping. Instead, one defines discrete metric factors and normal vectors that are constructed specifically to satisfy the GCL. These discrete geometric terms are derived such that the discrete divergence theorem holds by construction. For a shared face between two elements, this procedure guarantees that the calculated face measures are identical by definition, e.g., $(w_{q} J_q)_{L} = (w_{q} J_q)_{R}$. This enforces discrete conservation regardless of the order of the geometric mapping or the quadrature rule, eliminating the root cause of the mismatch. This approach ensures that the numerical method is \"free-stream preserving\" (i.e., exactly balances fluxes for a uniform flow) even on highly distorted, high-order curvilinear meshes. This is the most principled way to achieve element-wise IBP cancellation for DG methods on such meshes.\n\nIn summary, the fundamental remedy is to enforce consistency. Either both elements must use the same highly accurate approximation of the face measure, or they must use discrete geometric terms that are designed from the outset to satisfy the necessary metric identities.",
            "answer": "$$\\boxed{\\frac{4}{3} + \\frac{2}{3}\\sqrt{1 + 4\\gamma^{2}} - 2\\sqrt{1 + \\frac{4\\gamma^{2}}{3}}}$$"
        }
    ]
}