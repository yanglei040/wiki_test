{
    "hands_on_practices": [
        {
            "introduction": "原始丰度的最终预测值高度依赖于核合成开始时的中子-质子比（$n/p$）。这个实践练习将引导你通过建立一个简化的宇宙学模型，亲手计算这个关键比率。你将通过整合弗里德曼方程来追踪宇宙的膨胀与冷却，并考虑自由中子的衰变，从而深刻理解宇宙膨胀历史如何直接决定了轻元素合成的初始条件 ()。",
            "id": "3466425",
            "problem": "考虑一个在太初核合成（BBN）时期由辐射主导的空间平坦的弗里德曼-勒梅特-罗伯逊-沃尔克（FLRW）宇宙。目标是通过从弱相互作用冻结开始演化自由中子衰变，直到达到一个目标光子温度，来计算轻元素形成开始时的中子质子比。\n\n基本原理：\n- 中子丰度 $n(t)$ 满足衰变方程 $dn/dt=-n/\\tau_n$，其中 $\\tau_n$ 为恒定的中子寿命。在所关心的时间尺度上，质子被认为是稳定的。\n- 在弱相互作用冻结时（温度为 $T_f$），中子质子比处于热平衡状态，因此 $(n/p)_{\\mathrm{freeze}}=\\exp(-\\Delta m/T_f)$，其中 $\\Delta m$ 是中子-质子质量差，$T_f$ 与 $\\Delta m$ 使用相同的能量单位进行测量。\n- 宇宙膨胀率由弗里德曼方程 $H^2=(8\\pi G/3)\\,\\rho$ 决定，其中 $\\rho$ 是总能量密度。在 $\\hbar=c=k_B=1$ 的自然单位制中，可以写作 $H^2=\\rho/(3\\,M_{\\mathrm{Pl,red}}^2)$，其中约化普朗克质量 $M_{\\mathrm{Pl,red}}=1/\\sqrt{8\\pi G}$。\n- 对于相对论性粒子，能量密度为 $\\rho=(\\pi^2/30)\\,g_\\rho(T)\\,T^4$，其中 $g_\\rho(T)$ 是相对论性能量自由度的有效数量，$T$ 是以能量单位表示的相关温度。\n- 假设背景由光子、电子-正电子对以及 $N_\\nu$ 种味的中微子和反中微子组成。以下述简化方式假设瞬时 $e^\\pm$ 湮灭和中微子退耦：\n  - 当光子温度 $T_\\gamma>T_{\\mathrm{ann}}$ 时，认为光子、$e^\\pm$ 和中微子都是相对论性的，具有共同的温度 $T_\\gamma$，并将它们全部包含在 $\\rho$ 中。\n  - 当光子温度 $T_\\gamma\\le T_{\\mathrm{ann}}$ 时，假设 $\\rho$ 中不存在 $e^\\pm$，中微子保持相对论性，其温度为 $T_\\nu=\\xi\\,T_\\gamma$，其中 $\\xi=(4/11)^{1/3}$ 源于中微子退耦后电磁部分的熵守恒。\n- 在有效熵自由度恒定的时期之间，光子温度随红移变化，满足 $dT_\\gamma/dt=-H\\,T_\\gamma$。在上述瞬时湮灭近似下，从 $T_f$ 到一个较低的目标温度 $T_{\\mathrm{target}}$ 所流逝的宇宙时间可以通过以下公式计算：\n  $$\\Delta t=\\int_{T_{\\mathrm{target}}}^{T_f}\\frac{dT_\\gamma}{H(T_\\gamma)\\,T_\\gamma},$$\n  其中 $H(T_\\gamma)$ 是使用上述分段构成规则从弗里德曼方程中获得的。\n\n仅使用上述原理，编写一个程序，完成以下任务：\n1. 使用上述积分和以下能量密度模型，计算 $T_f$ 和 $T_{\\mathrm{target}}$ 之间流逝的时间 $\\Delta t$（以秒为单位）：\n   - 光子始终贡献 $\\rho_\\gamma=(\\pi^2/15)\\,T_\\gamma^4$。\n   - 当 $T_\\gamma>T_{\\mathrm{ann}}$ 时，电子-正电子对贡献 $\\rho_{e^\\pm}=(7/8)\\times 4\\times (\\pi^2/30)\\,T_\\gamma^4$；当 $T_\\gamma\\le T_{\\mathrm{ann}}$ 时，贡献为零。\n   - 中微子贡献 $\\rho_\\nu=(7/8)\\times (2N_\\nu)\\times (\\pi^2/30)\\,T_\\nu^4$，其中当 $T_\\gamma>T_{\\mathrm{ann}}$ 时 $T_\\nu=T_\\gamma$，当 $T_\\gamma\\le T_{\\mathrm{ann}}$ 时 $T_\\nu=\\xi\\,T_\\gamma$。\n   - 使用 $M_{\\mathrm{Pl,red}}=2.435\\times 10^{21}\\ \\mathrm{MeV}$、$\\hbar=6.582119569\\times 10^{-22}\\ \\mathrm{MeV\\cdot s}$，并取 $c=1$，$k_B=1$，因此温度直接以 $\\mathrm{MeV}$ 为单位。\n2. 通过以下公式将中子质子比从冻结时刻演化到 $T_{\\mathrm{target}}$：\n   $$(n/p)_{\\mathrm{final}}=(n/p)_{\\mathrm{freeze}}\\times \\exp\\!\\left(-\\frac{\\Delta t}{\\tau_n}\\right),\\quad (n/p)_{\\mathrm{freeze}}=\\exp\\!\\left(-\\frac{\\Delta m}{T_f}\\right).$$\n\n使用的常数和参数：\n- 中子寿命 $\\tau_n=879.4\\ \\mathrm{s}$。\n- 中子-质子质量差 $\\Delta m=1.29333236\\ \\mathrm{MeV}$。\n- 瞬时 $e^\\pm$ 湮灭阈值 $T_{\\mathrm{ann}}=0.2\\ \\mathrm{MeV}$。\n- 湮灭温度以下的中微子温度比 $\\xi=(4/11)^{1/3}$。\n\n数值和单位要求：\n- 所有温度必须以 $\\mathrm{MeV}$ 为单位。\n- 时间必须以 $\\mathrm{s}$ 为单位。\n- 最终答案是无量纲的比值。\n- 对于数值积分，请使用具有足够精度的方法来处理 $T_{\\mathrm{ann}}$ 处的分段变化。如果 $T_f\\le T_{\\mathrm{target}}$，则取 $\\Delta t=0$。\n- 将每个最终的 $(n/p)_{\\mathrm{final}}$ 作为浮点数输出，并四舍五入到六位小数。\n\n测试套件：\n您的程序必须评估以下五个案例，并按如下规定将所有五个结果输出到单行中。\n- 案例1（典型情况）：$T_f=0.8\\ \\mathrm{MeV}$，$T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$，$N_\\nu=3$。\n- 案例2（更早冻结）：$T_f=1.5\\ \\mathrm{MeV}$，$T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$，$N_\\nu=3$。\n- 案例3（更晚冻结）：$T_f=0.6\\ \\mathrm{MeV}$，$T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$，$N_\\nu=3$。\n- 案例4（边界情况）：$T_f=0.07\\ \\mathrm{MeV}$，$T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$，$N_\\nu=3$。\n- 案例5（额外辐射）：$T_f=0.8\\ \\mathrm{MeV}$，$T_{\\mathrm{target}}=0.07\\ \\mathrm{MeV}$，$N_\\nu=4$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个结果，形式为方括号括起来的逗号分隔列表，顺序为案例1到5，每个浮点数四舍五入到六位小数（例如：$\"[0.157000,0.333000,0.092000,0.203000,0.160000]\"$）。",
            "solution": "该问题是有效的，因为它在科学上基于标准宇宙学模型，问题设定适定，有明确的目标和充足的数据，并使用客观、正式的语言进行表述。因此，我们可以着手提供解答。\n\n主要目标是计算在指定光子温度 $T_{\\mathrm{target}}$ 下的最终中子质子比 $(n/p)_{\\mathrm{final}}$。该比值由其在弱相互作用冻结温度 $T_f$ 时的初始值，以及当宇宙从 $T_f$ 冷却到 $T_{\\mathrm{target}}$ 期间流逝的宇宙时间 $\\Delta t$ 内自由中子的后续衰变所决定。计算过程包括三个主要步骤：\n1.  通过对弗里德曼方程积分来确定流逝的时间 $\\Delta t$。\n2.  计算冻结时的初始中子质子比 $(n/p)_{\\mathrm{freeze}}$。\n3.  将此比率随时间演化，求得 $(n/p)_{\\mathrm{final}}$。\n\n**1. 流逝时间 $\\Delta t$ 的计算**\n\n宇宙时间 $t$ 和光子温度 $T_\\gamma$ 之间的关系由微分方程 $dT_\\gamma/dt = -H(T_\\gamma) T_\\gamma$ 给出，其中 $H(T_\\gamma)$ 是哈勃参数。通过对该关系进行积分，可以找到从温度为 $T_f$ 的时期到温度为 $T_{\\mathrm{target}}$ 的时期之间流逝的时间 $\\Delta t$：\n$$\n\\Delta t = \\int_{t(T_f)}^{t(T_{\\mathrm{target}})} dt = \\int_{T_f}^{T_{\\mathrm{target}}} \\frac{dt}{dT_\\gamma} dT_\\gamma = \\int_{T_f}^{T_{\\mathrm{target}}} \\frac{-1}{H(T_\\gamma)T_\\gamma} dT_\\gamma = \\int_{T_{\\mathrm{target}}}^{T_f} \\frac{dT_\\gamma}{H(T_\\gamma)T_\\gamma}\n$$\n哈勃参数 $H$ 由平坦的、辐射主导的宇宙的弗里德曼方程确定：\n$$\nH(T_\\gamma)^2 = \\frac{\\rho(T_\\gamma)}{3 M_{\\mathrm{Pl,red}}^2}\n$$\n其中 $M_{\\mathrm{Pl,red}}$ 是约化普朗克质量，$\\rho(T_\\gamma)$ 是总能量密度。相对论性粒子的能量密度由下式给出：\n$$\n\\rho(T_\\gamma) = g_\\rho(T_\\gamma) \\frac{\\pi^2}{30} T_\\gamma^4\n$$\n此处，$g_\\rho(T_\\gamma)$ 是相对论性能量自由度的有效数量，它随着粒子种类变为非相对论性而改变。题目指定了一个基于瞬时电子-正电子 ($e^\\pm$) 湮灭温度 $T_{\\mathrm{ann}}=0.2\\ \\mathrm{MeV}$ 的简化两阶段模型。\n\n**阶段 1：高温 ($T_\\gamma > T_{\\mathrm{ann}}$)**\n在此阶段，光子 ($\\gamma$)、电子和正电子 ($e^\\pm$)，以及 $N_\\nu$ 种味的中微子和反中微子都是相对论性的，并且共享相同的温度 $T_\\gamma$。能量密度的贡献如下：\n-   光子（2个极化方向，玻色子）：$g_\\gamma = 2$。\n-   电子/正电子（2种粒子，每种2个自旋，费米子）：$g_{e^\\pm} = 4 \\times \\frac{7}{8} = 3.5$。\n-   中微子/反中微子（$N_\\nu$ 种味，每种2个螺旋度，费米子）：$g_\\nu = 2N_\\nu \\times \\frac{7}{8} = 1.75 N_\\nu$。\n总有效自由度，记为 $g_H$，是一个常数：\n$$\ng_H = g_\\gamma + g_{e^\\pm} + g_\\nu = 2 + 3.5 + 1.75 N_\\nu = 5.5 + 1.75 N_\\nu\n$$\n\n**阶段 2：低温 ($T_\\gamma \\le T_{\\mathrm{ann}}$)**\n在 $T_{\\mathrm{ann}}$ 以下，$e^\\pm$ 对已经湮灭。光子被再加热，但已退耦的中微子则没有。中微子温度 $T_\\nu$ 通过 $T_\\nu = \\xi T_\\gamma$ 与光子温度 $T_\\gamma$ 相关联，其中 $\\xi = (4/11)^{1/3}$。能量密度的有效自由度，记为 $g_L$，是：\n$$\ng_L = g_\\gamma + g_\\nu \\left(\\frac{T_\\nu}{T_\\gamma}\\right)^4 = 2 + 1.75 N_\\nu \\xi^4 = 2 + 1.75 N_\\nu \\left(\\frac{4}{11}\\right)^{4/3}\n$$\n\n将 $\\rho(T_\\gamma)$ 和 $H(T_\\gamma)$ 的表达式代入 $\\Delta t$ 的积分中，我们得到：\n$$\nH(T_\\gamma) = \\sqrt{\\frac{g_\\rho(T_\\gamma) \\pi^2 T_\\gamma^4}{90 M_{\\mathrm{Pl,red}}^2}} = \\frac{\\pi T_\\gamma^2}{M_{\\mathrm{Pl,red}}} \\sqrt{\\frac{g_\\rho(T_\\gamma)}{90}}\n$$\n被积函数是 $\\frac{1}{H(T_\\gamma)T_\\gamma} = \\frac{M_{\\mathrm{Pl,red}}}{\\pi T_\\gamma^3} \\sqrt{\\frac{90}{g_\\rho(T_\\gamma)}}$。积分在 $g_\\rho(T_\\gamma)$ 为常数（$g_H$ 或 $g_L$）的区间上进行：\n$$\n\\Delta t [\\mathrm{MeV}^{-1}] = \\int_{T_a}^{T_b} \\frac{M_{\\mathrm{Pl,red}}}{\\pi} \\sqrt{\\frac{90}{g_\\rho}} \\frac{dT_\\gamma}{T_\\gamma^3} = \\frac{M_{\\mathrm{Pl,red}}}{\\pi} \\sqrt{\\frac{90}{g_\\rho}} \\left[-\\frac{1}{2T_\\gamma^2}\\right]_{T_a}^{T_b} = \\frac{M_{\\mathrm{Pl,red}}}{2\\pi} \\sqrt{\\frac{90}{g_\\rho}} \\left(\\frac{1}{T_a^2} - \\frac{1}{T_b^2}\\right)\n$$\n其中 $T_b > T_a$。该积分得到的时间单位是自然单位 $\\mathrm{MeV}^{-1}$。要将其转换为秒，我们乘以约化普朗克常数 $\\hbar$ 的值（单位为 $\\mathrm{MeV \\cdot s}$）。\n\n从 $T_f$ 到 $T_{\\mathrm{target}}$ 的总时间 $\\Delta t$ 是通过将两个温度区间的贡献相加来计算的，如果 $T_f > T_{\\mathrm{ann}} > T_{\\mathrm{target}}$，则在 $T_{\\mathrm{ann}}$ 处分割积分。如果 $T_f \\le T_{\\mathrm{target}}$，则流逝的时间为 $\\Delta t = 0$。\n\n**2. 中子质子比的计算**\n\n冻结时的初始比率由热平衡决定，通过玻尔兹曼因子确定：\n$$\n\\left(\\frac{n}{p}\\right)_{\\mathrm{freeze}} = \\exp\\left(-\\frac{\\Delta m}{T_f}\\right)\n$$\n其中 $\\Delta m$ 是中子-质子质量差。\n\n冻结后，自由中子以平均寿命 $\\tau_n$ 进行衰变。质子是稳定的。中子数 $n(t)$ 随时间减少，关系为 $n(t) = n(t_f) \\exp(-(t-t_f)/\\tau_n)$。质子数实际上是恒定的（相对于重子总数，忽略中子衰变带来的微小变化）。因此，该比率演化如下：\n$$\n\\left(\\frac{n}{p}\\right)_{\\mathrm{final}} = \\left(\\frac{n}{p}\\right)_{\\mathrm{freeze}} \\exp\\left(-\\frac{\\Delta t}{\\tau_n}\\right)\n$$\n其中 $\\Delta t$ 是上一步计算出的以秒为单位的流逝时间。\n\n每个测试案例的算法如下：\n1.  给定 $T_f$、$T_{\\mathrm{target}}$ 和 $N_\\nu$，首先检查是否 $T_f \\le T_{\\mathrm{target}}$。如果是，则 $\\Delta t = 0$。\n2.  否则，计算常数 $g_H$ 和 $g_L$。\n3.  通过对高温范围（如果适用，从 $T_f$ 到 $T_{\\mathrm{ann}}$）和低温范围（如果适用，从 $T_{\\mathrm{ann}}$ 到 $T_{\\mathrm{target}}$）的解析积分结果求和，计算以 $\\mathrm{MeV}^{-1}$ 为单位的流逝时间 $\\Delta t$。\n4.  使用 $\\hbar$ 将 $\\Delta t$ 从 $\\mathrm{MeV}^{-1}$ 转换为秒。\n5.  计算 $(n/p)_{\\mathrm{freeze}} = \\exp(-\\Delta m/T_f)$。\n6.  计算 $(n/p)_{\\mathrm{final}} = (n/p)_{\\mathrm{freeze}} \\exp(-\\Delta t/\\tau_n)$。\n7.  最终结果四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the neutron-to-proton ratio at the onset of light element formation\n    for a set of cosmological parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_f [MeV], T_target [MeV], N_nu)\n        (0.8, 0.07, 3),\n        (1.5, 0.07, 3),\n        (0.6, 0.07, 3),\n        (0.07, 0.07, 3),\n        (0.8, 0.07, 4),\n    ]\n    \n    # Constants and parameters\n    TAU_N = 879.4  # s (neutron lifetime)\n    DELTA_M = 1.29333236  # MeV (neutron-proton mass difference)\n    T_ANN = 0.2  # MeV (e+- annihilation temperature)\n    M_PL_RED = 2.435e21  # MeV (reduced Planck mass)\n    HBAR = 6.582119569e-22  # MeV*s (reduced Planck constant)\n\n    results = []\n    for case in test_cases:\n        Tf, T_target, N_nu = case\n\n        # Step 1: Compute elapsed time delta_t\n        if Tf = T_target:\n            delta_t_s = 0.0\n        else:\n            # Effective number of relativistic degrees of freedom for energy density\n            # For T > T_ann (photons, e+-, neutrinos)\n            g_H = 5.5 + 1.75 * N_nu\n            # For T = T_ann (photons, neutrinos with T_nu  T_gamma)\n            xi_4 = (4.0 / 11.0)**(4.0 / 3.0)\n            g_L = 2.0 + 1.75 * N_nu * xi_4\n            \n            # The time integral evaluates to:\n            # dt [MeV^-1] = (M_pl_red / (2*pi)) * sqrt(90/g) * (1/T_low^2 - 1/T_high^2)\n            # Pre-compute the shared constant factor for efficiency.\n            const_factor = (M_PL_RED / (2.0 * np.pi)) * np.sqrt(90.0)\n\n            delta_t_inv_MeV = 0.0\n            \n            # Integrate from Tf down to T_ann (high-temperature regime)\n            if Tf > T_ANN:\n                const_H = const_factor / np.sqrt(g_H)\n                delta_t_inv_MeV += const_H * (1.0 / T_ANN**2 - 1.0 / Tf**2)\n                current_T_upper = T_ANN\n            else:\n                current_T_upper = Tf\n            \n            # Integrate from current_T_upper down to T_target (low-temperature regime)\n            if current_T_upper > T_target:\n                const_L = const_factor / np.sqrt(g_L)\n                delta_t_inv_MeV += const_L * (1.0 / T_target**2 - 1.0 / current_T_upper**2)\n            \n            # Convert time from natural units (MeV^-1) to seconds\n            delta_t_s = delta_t_inv_MeV * HBAR\n\n        # Step 2: Calculate initial (n/p) ratio at freeze-out\n        # In the extreme case of Tf -> 0, this would diverge, but parameters are physical.\n        np_freeze = np.exp(-DELTA_M / Tf)\n\n        # Step 3: Evolve the ratio considering neutron decay\n        decay_factor = np.exp(-delta_t_s / TAU_N)\n        np_final = np_freeze * decay_factor\n        \n        results.append(\"{:.6f}\".format(np_final))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一旦我们知道了中子-质子比，下一步就是预测可观测的元素丰度，其中最主要的是氦-4（$^4\\mathrm{He}$）。本练习将基于一个简化的模型，推导氦-4质量分数（$Y_p$）与中子寿命（$\\tau_n$）之间的解析关系，并引入灵敏度分析这一强大工具。通过比较解析导数和数值有限差分，你不仅能验证你的物理模型，还能掌握一种在数值宇宙学中评估模型参数影响的核心技能 ()。",
            "id": "3466405",
            "problem": "考虑一个简化的、具有物理动机的大爆炸核合成（BBN）模型，其中氦-4（$^{4}\\mathrm{He}$）的质量分数 $Y_p$ 通过核合成开始时的中子-质子数密度比 $r(t)$ 依赖于中子寿命 $\\tau_n$。您的任务是推导、实现并比较 $Y_p$ 相对于 $\\tau_n$ 的解析和数值灵敏度。\n\n假设和基本依据：\n- 在温度 $T_f$ 发生弱相互作用冻结之后，中子-质子比 $r(t) \\equiv n_n(t) / n_p(t)$ 的演化仅由自由中子经贝塔衰变转变为质子所致，其衰变时间为 $\\tau_n$。控制该过程的速率方程为一阶常微分方程 $dr/dt = - r / \\tau_n$，在时间 $t \\ge t_f$ 时有效。\n- 在弱相互作用平衡期间，紧邻冻结之前，中子-质子比可以很好地用玻尔兹曼因子 $r_f = \\exp(-\\Delta m / T_f)$ 近似，其中 $\\Delta m$ 是中子-质子质量差， $T_f$ 是冻结温度。使用 $\\Delta m = 1.29333236$ MeV，并采用自然单位制，其中玻尔兹曼常数 $k_B = 1$，因此温度以兆电子伏特（MeV）为单位。所有涉及温度的指数函数必须使用单位为 MeV 的 $T_f$ 和单位为 MeV 的 $\\Delta m$。\n- 假设高效核合成的开始发生在冻结后的宇宙时 $t_N$。忽略 $t_f$ 与 $0$ 相对于 $t_N$ 的微小差异（即，近似为 $r(t_N) \\approx r_f \\exp(- t_N / \\tau_n)$）。在假设 $t_N$ 时所有幸存的中子都迅速被捕获到 $^{4}\\mathrm{He}$ 中，并且较重核素和剩余的氘对质量总和的贡献可以忽略不计的情况下，仅根据 $t_N$ 时的重子数守恒，用 $r(t_N)$ 表示来推导 $Y_p$。\n- 您可以假设 $Y_p$ 是无量纲的，所有时间单位为秒。$Y_p$ 的任何灵敏度、导数或有限差分增量也都是无量纲的。\n\n任务：\n1. 从速率方程 $dr/dt = - r / \\tau_n$ 和玻尔兹曼初始条件 $r_f = \\exp(-\\Delta m / T_f)$ 出发，推导 $r(t_N)$ 作为 $\\tau_n$、$t_N$ 和 $T_f$ 的函数的显式解析表达式。\n2. 根据所述假设，使用重子数核算，推导 $Y_p$ 作为 $r(t_N)$ 的函数。\n3. 根据您推导出的 $Y_p(\\tau_n)$，计算在指定的 $(T_f, t_N, \\tau_n)$ 点的解析偏导数 $\\partial Y_p / \\partial \\tau_n$。\n4. 实现一个关于 $\\Delta \\tau_n = 1$ s 的 $Y_p$ 的数值前向有限差分增量，即 $Y_p(\\tau_n + \\Delta \\tau_n) - Y_p(\\tau_n)$，并将其与线性近似增量 $\\left(\\partial Y_p / \\partial \\tau_n\\right) \\Delta \\tau_n$ 进行比较。\n5. 实现一个关于 $\\Delta \\tau_n = 1$ s 的导数的数值中心有限差分估计，即 $\\left[Y_p(\\tau_n + \\Delta \\tau_n) - Y_p(\\tau_n - \\Delta \\tau_n)\\right] / (2 \\Delta \\tau_n)$，并将其与解析导数 $\\partial Y_p / \\partial \\tau_n$ 进行比较。\n\n要求：\n- 所有数学推导均以 $T_f$（单位 MeV）、$t_N$（单位 s）和 $\\tau_n$（单位 s）表示。\n- 所有有限差分计算均使用 $\\Delta \\tau_n = 1$ s。\n- 对于每个测试用例，产生两个无量纲浮点数结果：线性近似增量与前向有限差分增量之间的绝对误差，以及解析导数与中心有限差分导数估计之间的绝对误差。\n\n测试套件：\n评估以下参数集，每组均以 $(T_f, t_N, \\tau_n)$ 给出，其中 $T_f$ 单位为 MeV，时间单位为秒：\n- 案例 1：$(0.80, 180, 879.4)$。\n- 案例 2：$(0.80, 300, 879.4)$。\n- 案例 3：$(0.70, 180, 879.4)$。\n- 案例 4：$(0.80, 180, 2000.0)$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的结果列表，按测试用例排序。对于每个案例，首先包含线性近似增量与前向有限差分增量之间的绝对误差，然后是解析导数与中心有限差分导数估计之间的绝对误差。例如，输出形式应为 $[e_{1,\\mathrm{fwd}}, e_{1,\\mathrm{cen}}, e_{2,\\mathrm{fwd}}, e_{2,\\mathrm{cen}}, e_{3,\\mathrm{fwd}}, e_{3,\\mathrm{cen}}, e_{4,\\mathrm{fwd}}, e_{4,\\mathrm{cen}}]$，其中每个 $e$ 都是一个无量纲浮点数。",
            "solution": "问题陈述已经过验证，被认为是合理的。它提出了一个简化但物理和数学上一致的大爆炸核合成模型，允许对氦-4质量分数与中子寿命的灵敏度进行严格分析。所有必需的常数、方程和参数均已提供，任务也定义明确。因此，我们可以着手进行推导和求解。\n\n解决方案根据问题陈述中概述的任务进行组织。首先，我们推导必要的解析表达式。其次，我们定义用于比较的数值方案。最后，将这些结果在代码中实现，以评估指定的测试用例。\n\n**1. 中子-质子比 $r(t_N)$ 的推导**\n\n在弱相互作用于 $t_f$ 冻结之后的时间 $t$，中子-质子比 $r(t) = n_n(t)/n_p(t)$ 的演化由自由中子衰变的一阶常微分方程决定：\n$$\n\\frac{dr}{dt} = - \\frac{r}{\\tau_n}\n$$\n其中 $\\tau_n$ 是平均中子寿命。该方程是可分离的：\n$$\n\\frac{dr}{r} = - \\frac{1}{\\tau_n} dt\n$$\n我们将此方程从冻结时间 $t_f$ 积分到核合成开始时间 $t_N$：\n$$\n\\int_{r(t_f)}^{r(t_N)} \\frac{dr}{r} = \\int_{t_f}^{t_N} -\\frac{1}{\\tau_n} dt\n$$\n求解积分得到：\n$$\n\\ln(r(t_N)) - \\ln(r(t_f)) = -\\frac{1}{\\tau_n}(t_N - t_f)\n$$\n对两边取指数，得到在时间 $t_N$ 的比率：\n$$\nr(t_N) = r(t_f) \\exp\\left(-\\frac{t_N - t_f}{\\tau_n}\\right)\n$$\n冻结时的初始比率 $r(t_f) = r_f$ 由玻尔兹曼因子给出，该因子描述了冻结前的化学平衡状态：\n$$\nr_f = \\exp\\left(-\\frac{\\Delta m}{T_f}\\right)\n$$\n其中 $\\Delta m = m_n - m_p$ 是中子-质子质量差（$1.29333236 \\text{ MeV}$），$T_f$ 是以 MeV 为单位的冻结温度。\n\n问题指定使用 $t_f$ 相对于 $t_N$ 可忽略不计的近似。应用此近似，我们设 $t_f \\approx 0$：\n$$\nr(t_N) \\approx r_f \\exp\\left(-\\frac{t_N}{\\tau_n}\\right)\n$$\n代入 $r_f$ 的表达式，我们得到核合成开始时中子-质子比的最终解析形式，我们将其表示为 $r_N$：\n$$\nr_N = r(t_N) = \\exp\\left(-\\frac{\\Delta m}{T_f}\\right) \\exp\\left(-\\frac{t_N}{\\tau_n}\\right) = \\exp\\left(-\\frac{\\Delta m}{T_f} - \\frac{t_N}{\\tau_n}\\right)\n$$\n\n**2. 氦-4质量分数 $Y_p$ 的推导**\n\n氦-4质量分数 $Y_p$ 是 $^4\\text{He}$ 的总质量与所有重子总质量之比。我们假设在时间 $t_N$，所有幸存的中子都迅速结合成 $^4\\text{He}$ 核。一个 $^4\\text{He}$ 核包含2个质子和2个中子。因此，形成的 $^4\\text{He}$ 核的数密度 $n_{^4\\text{He}}$ 由可用中子的数密度 $n_n$ 决定：\n$$\nn_{^4\\text{He}} = \\frac{n_n}{2}\n$$\n近似认为核子质量相等 ($m_n \\approx m_p \\equiv m_B$)，单个 $^4\\text{He}$ 核的质量约为 $4m_B$。$^4\\text{He}$ 的质量密度则为：\n$$\n\\rho_{^4\\text{He}} = n_{^4\\text{He}} \\times (4m_B) = \\left(\\frac{n_n}{2}\\right) 4m_B = 2n_n m_B\n$$\n总重子质量密度 $\\rho_{\\text{baryon}}$ 是所有质子和中子质量密度的总和：\n$$\n\\rho_{\\text{baryon}} = (n_n + n_p) m_B\n$$\n其中 $n_p$ 是 $t_N$ 时的质子数密度。质量分数 $Y_p$ 是：\n$$\nY_p = \\frac{\\rho_{^4\\text{He}}}{\\rho_{\\text{baryon}}} = \\frac{2n_n m_B}{(n_n + n_p) m_B} = \\frac{2n_n}{n_n + n_p}\n$$\n为了用比率 $r_N = n_n/n_p$ 来表示，我们将分子和分母同除以 $n_p$：\n$$\nY_p = \\frac{2(n_n/n_p)}{(n_n/n_p) + 1} = \\frac{2r_N}{r_N + 1}\n$$\n\n**3. 解析偏导数 $\\partial Y_p / \\partial \\tau_n$ 的推导**\n\n为了求出 $Y_p$ 对中子寿命 $\\tau_n$ 的灵敏度，我们计算偏导数 $\\partial Y_p / \\partial \\tau_n$。我们应用链式法则：\n$$\n\\frac{\\partial Y_p}{\\partial \\tau_n} = \\frac{d Y_p}{d r_N} \\frac{\\partial r_N}{\\partial \\tau_n}\n$$\n首先，我们使用商法则计算 $Y_p$ 对 $r_N$ 的导数：\n$$\n\\frac{dY_p}{dr_N} = \\frac{d}{dr_N}\\left(\\frac{2r_N}{r_N + 1}\\right) = \\frac{2(r_N + 1) - 2r_N(1)}{(r_N + 1)^2} = \\frac{2}{(r_N + 1)^2}\n$$\n接下来，我们计算 $r_N$ 对 $\\tau_n$ 的偏导数：\n$$\nr_N = \\exp\\left(-\\frac{\\Delta m}{T_f} - \\frac{t_N}{\\tau_n}\\right)\n$$\n$$\n\\frac{\\partial r_N}{\\partial \\tau_n} = \\exp\\left(-\\frac{\\Delta m}{T_f} - \\frac{t_N}{\\tau_n}\\right) \\cdot \\frac{\\partial}{\\partial \\tau_n}\\left(-\\frac{\\Delta m}{T_f} - \\frac{t_N}{\\tau_n}\\right) = r_N \\cdot \\left(0 - t_N(-\\tau_n^{-2})\\right) = r_N \\frac{t_N}{\\tau_n^2}\n$$\n将这两个结果结合起来，我们得到解析导数：\n$$\n\\frac{\\partial Y_p}{\\partial \\tau_n} = \\frac{2}{(r_N + 1)^2} \\cdot \\left(r_N \\frac{t_N}{\\tau_n^2}\\right) = \\frac{2 r_N t_N}{\\tau_n^2 (r_N + 1)^2}\n$$\n这个表达式使我们能够计算在任何给定点 $(T_f, t_N, \\tau_n)$ 处 $Y_p$ 对 $\\tau_n$ 变化的一阶精确灵敏度。\n\n**4.  5. 数值方案与误差计算**\n\n我们的任务是计算两个误差度量，用以比较数值近似与解析结果。所有有限差分都使用步长 $\\Delta \\tau_n = 1$ s。\n\n第一个误差 $e_{\\text{fwd}}$ 是前向有限差分增量与线性近似增量之间的绝对差。\n前向增量为 $\\Delta Y_{p, \\text{fwd}} = Y_p(\\tau_n + \\Delta\\tau_n) - Y_p(\\tau_n)$。\n增量的线性近似为 $\\Delta Y_{p, \\text{lin}} = \\left(\\frac{\\partial Y_p}{\\partial \\tau_n}\\right) \\Delta\\tau_n$。\n误差为：\n$$\ne_{\\text{fwd}} = |\\Delta Y_{p, \\text{fwd}} - \\Delta Y_{p, \\text{lin}}| = \\left| \\left( Y_p(\\tau_n + \\Delta\\tau_n) - Y_p(\\tau_n) \\right) - \\frac{\\partial Y_p}{\\partial \\tau_n} \\Delta\\tau_n \\right|\n$$\n\n第二个误差 $e_{\\text{cen}}$ 是导数的中心有限差分估计与解析导数之间的绝对差。\n中心差分估计为 $(\\frac{\\partial Y_p}{\\partial \\tau_n})_{\\text{cen}} = \\frac{Y_p(\\tau_n + \\Delta\\tau_n) - Y_p(\\tau_n - \\Delta\\tau_n)}{2\\Delta\\tau_n}$。\n误差为：\n$$\ne_{\\text{cen}} = \\left| \\left(\\frac{\\partial Y_p}{\\partial \\tau_n}\\right)_{\\text{cen}} - \\frac{\\partial Y_p}{\\partial \\tau_n} \\right| = \\left| \\frac{Y_p(\\tau_n + \\Delta\\tau_n) - Y_p(\\tau_n - \\Delta\\tau_n)}{2\\Delta\\tau_n} - \\frac{\\partial Y_p}{\\partial \\tau_n} \\right|\n$$\n代码实现将为每个指定的测试用例计算这两个误差值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates analytical and numerical sensitivities of the Helium-4 mass fraction Y_p\n    with respect to the neutron lifetime tau_n in a simplified BBN model.\n    \"\"\"\n    \n    # Define physical constants and problem parameters\n    DELTA_M = 1.29333236  # MeV (neutron-proton mass difference)\n    DELTA_TAUN = 1.0       # s (finite difference step size)\n\n    test_cases = [\n        # (T_f [MeV], t_N [s], tau_n [s])\n        (0.80, 180.0, 879.4),\n        (0.80, 300.0, 879.4),\n        (0.70, 180.0, 879.4),\n        (0.80, 180.0, 2000.0),\n    ]\n\n    def calculate_Yp(T_f, t_N, tau_n):\n        \"\"\"\n        Computes the Helium-4 mass fraction Y_p for a given set of parameters.\n        \n        Y_p = 2*r_N / (r_N + 1)\n        r_N = exp(-DELTA_M/T_f - t_N/tau_n)\n        \"\"\"\n        if tau_n == 0:\n            return 0.0 # Avoid division by zero; physically unrealistic\n        \n        exponent = -(DELTA_M / T_f) - (t_N / tau_n)\n        r_N = np.exp(exponent)\n        \n        # This check is for numerical stability, though unlikely with given inputs\n        if r_N == -1.0:\n            return np.inf\n\n        Yp = (2.0 * r_N) / (r_N + 1.0)\n        return Yp\n\n    def calculate_analytical_derivative(T_f, t_N, tau_n):\n        \"\"\"\n        Computes the analytical partial derivative dYp/d(tau_n).\n        \n        dYp/d(tau_n) = (2 * r_N * t_N) / (tau_n^2 * (r_N + 1)^2)\n        \"\"\"\n        if tau_n == 0:\n            return 0.0\n\n        exponent = -(DELTA_M / T_f) - (t_N / tau_n)\n        r_N = np.exp(exponent)\n        \n        numerator = 2.0 * r_N * t_N\n        denominator = tau_n**2 * (r_N + 1.0)**2\n        \n        if denominator == 0:\n            return np.inf # Avoid division by zero\n            \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        T_f, t_N, tau_n = case\n\n        # --- Calculate quantities needed for error analysis ---\n\n        # 1. Calculate Yp at three points for finite differences\n        Yp_nominal = calculate_Yp(T_f, t_N, tau_n)\n        Yp_plus_dtau = calculate_Yp(T_f, t_N, tau_n + DELTA_TAUN)\n        Yp_minus_dtau = calculate_Yp(T_f, t_N, tau_n - DELTA_TAUN)\n        \n        # 2. Calculate the analytical derivative\n        analytical_deriv = calculate_analytical_derivative(T_f, t_N, tau_n)\n\n        # --- Task 4: Compare forward difference increment to linear approximation ---\n        \n        # Forward finite-difference increment\n        forward_diff_increment = Yp_plus_dtau - Yp_nominal\n        \n        # Linear approximation increment\n        linear_approx_increment = analytical_deriv * DELTA_TAUN\n        \n        # Absolute error for the first metric\n        error_fwd = abs(forward_diff_increment - linear_approx_increment)\n\n        # --- Task 5: Compare central difference derivative to analytical derivative ---\n        \n        # Central finite-difference estimate of the derivative\n        central_diff_deriv = (Yp_plus_dtau - Yp_minus_dtau) / (2.0 * DELTA_TAUN)\n        \n        # Absolute error for the second metric\n        error_cen = abs(central_diff_deriv - analytical_deriv)\n        \n        # Append results for this case\n        results.append(error_fwd)\n        results.append(error_cen)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "前述练习依赖于简化假设，而真实的BBN计算则需要求解一个包含多个物种和反应的复杂网络。这个高级实践将带你深入BBN模拟的核心，构建一个包含关键核反应的动力学方程组的雅可比矩阵。通过计算该矩阵的特征值，你将能识别出反应网络中最快的时间尺度，从而揭示BBN方程组固有的“刚性”（stiffness）问题，并理解为何需要专门的数值方法来求解它们 ()。",
            "id": "3466440",
            "problem": "考虑一个简化的用于物种中子、质子、氘核、氦-3和氦-4的大爆炸核合成反应网络，这些物种由丰度矢量 $\\mathbf{Y} = \\left(Y_{n}, Y_{p}, Y_{d}, Y_{3}, Y_{4}\\right)$ 表示，其中 $Y_{i}$ 是每重子的数量分数。时间导数 $\\dot{Y}_{i}$ 源于一组在均匀条件下通过质量作用动力学建模的反应。假设有以下反应和有效反应率形式，其中温度 $T$ 以兆电子伏特（MeV）表示，时间以秒（s）表示：\n\n- 弱相互转换：\n  - $n \\to p$，单位粒子反应率为 $\\lambda_{np}(T) = a_{w} T^{5}$，\n  - $p \\to n$，单位粒子反应率为 $\\lambda_{pn}(T) = a_{w} T^{5} \\exp\\!\\left(-\\Delta/T\\right)$，\n  其中 $a_{w} = 1.0\\,\\mathrm{s}^{-1}\\,\\mathrm{MeV}^{-5}$ 且 $\\Delta = 1.293\\,\\mathrm{MeV}$。\n\n- 核反应（正向，仅考虑氘的光致蜕变）：\n  - $n + p \\rightleftharpoons d + \\gamma$，正向双体反应率系数为 $k_{np\\to d\\gamma}(T) = 4.5\\times 10^{-27}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$，氘核光致蜕变率为 $\\lambda_{\\gamma d}(T) = 1.0\\times 10^{5}\\,\\mathrm{s}^{-1}\\,T^{3}\\,\\exp\\!\\left(-B_{d}/T\\right)$，其中 $B_{d} = 2.224\\,\\mathrm{MeV}$。\n  - $d + p \\to {}^{3}\\mathrm{He} + \\gamma$，其 $k_{dp\\to 3\\gamma}(T) = 1.0\\times 10^{-26}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$。\n  - $d + d \\to {}^{3}\\mathrm{He} + n$，其 $k_{dd\\to 3n}(T) = 5.0\\times 10^{-27}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$。\n  - ${}^{3}\\mathrm{He} + d \\to {}^{4}\\mathrm{He} + p$，其 $k_{3d\\to 4p}(T) = 1.0\\times 10^{-26}\\,\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}\\,\\sqrt{T/0.1}$。\n\n设重子数密度为 $n_{b}(T) = \\eta\\,n_{\\gamma}(T)$，其中重子-光子比 $\\eta = 6.1\\times 10^{-10}$，光子数密度为\n$$\nn_{\\gamma}(T) = \\frac{2\\,\\zeta(3)}{\\pi^{2}} \\frac{\\left(k_{B} T\\right)^{3}}{\\left(\\hbar c\\right)^{3}},\n$$\n其中 $\\zeta(3) \\approx 1.202056903159594$，$k_{B}$ 是 Boltzmann 常数，$\\hbar$ 是约化 Planck 常数，$c$ 是光速。在这里，当代入上述表达式时，在因子 $k_{B}T$ 中 $T$ 被用作能量，其中 $1\\,\\mathrm{MeV} = 1.602176634\\times 10^{-13}\\,\\mathrm{J}$。\n\n假设 $\\dot{\\mathbf{Y}}$ 的常微分方程遵循质量作用动力学，使用上述反应率和 $n_{b}(T)$，将每重子双体正向反应率处理为 $r = n_{b}(T)\\,k(T)\\,Y_{A}Y_{B}$，单体光致蜕变处理为 $r = \\lambda(T)\\,Y$。对于反应 $d + d \\to {}^{3}\\mathrm{He} + n$，在正向反应率中为相同反应物包含标准因子 $1/2$，使得 $r_{dd\\to 3n} = \\tfrac{1}{2} n_{b}(T) k_{dd\\to 3n}(T) Y_{d}^{2}$。\n\n任务：\n- 从质量作用动力学和重子数守恒出发，写出由上述反应所蕴含的系统 $\\dot{\\mathbf{Y}} = \\mathbf{F}(\\mathbf{Y}; T)$。\n- 构建解析雅可比矩阵 $J(\\mathbf{Y}; T) = \\left[\\partial \\dot{Y}_{i}/\\partial Y_{j}\\right]$。\n- 对于下述每个测试用例，在给定的 $T$ 和 $\\mathbf{Y}$ 下评估 $J$，计算 $J$ 的特征值，并通过取负实部的最大值来确定最快衰变模式，即，\n$$\n\\Gamma_{\\mathrm{fast}}(T,\\mathbf{Y}) = \\max\\left\\{-\\operatorname{Re}\\lambda : \\lambda \\in \\operatorname{eig}\\left(J(\\mathbf{Y};T)\\right),\\ \\operatorname{Re}\\lambda  0\\right\\},\n$$\n约定如果没有特征值具有负实部，则 $\\Gamma_{\\mathrm{fast}} = 0$。\n\n所有输出必须以 $\\mathrm{s}^{-1}$ 为单位，表示为浮点数。你的程序应生成单行输出，其中包含按测试套件顺序排列的结果，形式为方括号括起来的逗号分隔列表，每个值四舍五入到 $6$ 位有效数字。\n\n测试套件（每个用例是一对 $(T,\\mathbf{Y})$；$T$ 的单位是 MeV；$\\mathbf{Y}$ 的顺序是 $(Y_{n},Y_{p},Y_{d},Y_{3},Y_{4})$ 并且满足重子数一致性 $\\sum_{i} A_{i} Y_{i} = 1$，其中质量数 $A_{n}=1$、$A_{p}=1$、$A_{d}=2$、$A_{3}=3$、$A_{4}=4$）：\n- 用例 1：$T = 0.2$，$\\mathbf{Y} = (0.12,\\,0.88,\\,0,\\,0,\\,0)$。\n- 用例 2：$T = 0.1$，$\\mathbf{Y} = (0.12,\\,0.84,\\,0.02,\\,0,\\,0)$。\n- 用例 3：$T = 0.07$，$\\mathbf{Y} = (0.08,\\,0.53,\\,0.02,\\,0.01,\\,0.08)$。\n- 用例 4（所有重子都在氘核中的边缘情况）：$T = 0.1$，$\\mathbf{Y} = (0,\\,0,\\,0.5,\\,0,\\,0)$。\n\n您的程序必须完全按照上述规定实现反应率模型，构建 $J$，为每个用例计算 $\\Gamma_{\\mathrm{fast}}$，并以精确的格式打印单行：例如，$[x_{1},x_{2},x_{3},x_{4}]$，其中每个 $x_{i}$ 是相应测试用例的 $\\Gamma_{\\mathrm{fast}}$ 的四舍五入值，单位为 $\\mathrm{s}^{-1}$。",
            "solution": "我们使用丰度矢量 $\\mathbf{Y} = \\left(Y_{n}, Y_{p}, Y_{d}, Y_{3}, Y_{4}\\right)$ 对一个简化的大爆炸核合成网络进行建模，其中 $Y_{i}$ 是每重子中物种 $i$ 的原子核数量。基本基础是质量作用动力学和热辐射场中光子数密度的表达式。重子数密度为 $n_{b}(T) = \\eta n_{\\gamma}(T)$，其中\n$$\nn_{\\gamma}(T) = \\frac{2\\,\\zeta(3)}{\\pi^{2}} \\frac{\\left(k_{B} T\\right)^{3}}{\\left(\\hbar c\\right)^{3}},\n$$\n并且当代入 $k_{B} T$ 时，应将 $T$ 视为能量，使用 $1\\,\\mathrm{MeV} = 1.602176634\\times 10^{-13}\\,\\mathrm{J}$。在早期宇宙中，重子-光子比 $\\eta$ 被视为一个常数。\n\n反应集和反应率如下：\n- 弱相互转换，单位粒子反应率为 $\\lambda_{np}(T) = a_{w} T^{5}$ 和 $\\lambda_{pn}(T) = a_{w} T^{5} \\exp\\!\\left(-\\Delta/T\\right)$，其中 $a_{w} = 1.0\\,\\mathrm{s}^{-1}\\,\\mathrm{MeV}^{-5}$ 且 $\\Delta = 1.293\\,\\mathrm{MeV}$。这些反应耦合了 $Y_{n}$ 和 $Y_{p}$，而不改变重子数。\n\n- 双体核反应产生每重子反应率 $r = n_{b}(T) k(T) Y_{A} Y_{B}$，其中 $k(T)$ 是热平均反应率系数，单位为 $\\mathrm{m}^{3}\\,\\mathrm{s}^{-1}$。对于相同的反应物 $d + d$，引入了标准的对称因子 $\\tfrac{1}{2}$。氘核的单体光致蜕变反应率为 $r = \\lambda_{\\gamma d}(T) Y_{d}$，其中 $\\lambda_{\\gamma d}(T) = 1.0\\times 10^{5}\\,\\mathrm{s}^{-1}\\,T^{3}\\,\\exp\\!\\left(-B_{d}/T\\right)$ 且 $B_{d} = 2.224\\,\\mathrm{MeV}$。\n\n我们在固定温度 $T$ 下定义以下简写反应率：\n- $n + p \\rightleftharpoons d + \\gamma$：$r_{1f} = n_{b} k_{np\\to d\\gamma}(T) Y_{n} Y_{p}$ 和 $r_{1r} = \\lambda_{\\gamma d}(T) Y_{d}$，\n- $d + p \\to {}^{3}\\mathrm{He} + \\gamma$：$r_{2f} = n_{b} k_{dp\\to 3\\gamma}(T) Y_{d} Y_{p}$，\n- $d + d \\to {}^{3}\\mathrm{He} + n$：$r_{3f} = \\tfrac{1}{2} n_{b} k_{dd\\to 3n}(T) Y_{d}^{2}$，\n- ${}^{3}\\mathrm{He} + d \\to {}^{4}\\mathrm{He} + p$：$r_{4f} = n_{b} k_{3d\\to 4p}(T) Y_{3} Y_{d}$。\n\n应用质量作用动力学和化学计量学，丰度方程为：\n- 对于中子 $n$：\n$$\n\\dot{Y}_{n} = -\\lambda_{np} Y_{n} + \\lambda_{pn} Y_{p} - r_{1f} + r_{1r} + r_{3f}.\n$$\n这些项分别反映了 $n \\to p$ 的损失、$p \\to n$ 的增益、$n+p \\to d$ 的损失、$d \\to n+p$ 的增益以及 $d+d \\to {}^{3}\\mathrm{He} + n$ 的增益。\n\n- 对于质子 $p$：\n$$\n\\dot{Y}_{p} = +\\lambda_{np} Y_{n} - \\lambda_{pn} Y_{p} - r_{1f} + r_{1r} - r_{2f} + r_{4f}.\n$$\n此处，$d+p \\to {}^{3}\\mathrm{He} + \\gamma$ 移除了质子，而 ${}^{3}\\mathrm{He} + d \\to {}^{4}\\mathrm{He} + p$ 产生了质子。\n\n- 对于氘核 $d$：\n$$\n\\dot{Y}_{d} = + r_{1f} - r_{1r} - r_{2f} - 2 r_{3f} - r_{4f}.\n$$\n氘核由 $n+p$ 俘获产生，并通过光致蜕变、与 $p$ 俘获形成 ${}^{3}\\mathrm{He}$、与另一个 $d$ 聚变（每次事件消耗两个 $d$）以及与 ${}^{3}\\mathrm{He}$ 俘获而被消耗。\n\n- 对于氦-3：\n$$\n\\dot{Y}_{3} = + r_{2f} + r_{3f} - r_{4f}.\n$$\n\n- 对于氦-4：\n$$\n\\dot{Y}_{4} = + r_{4f}.\n$$\n\n通过对每个方程的右侧关于 $Y_{j}$ 求导（保持 $T$ 固定），可以得到解析雅可比矩阵 $J = \\left[\\partial \\dot{Y}_{i}/\\partial Y_{j}\\right]$。反应率系数仅依赖于 $T$，因此它们对丰度的导数为零。简写反应率的非零偏导数是：\n- $\\partial r_{1f}/\\partial Y_{n} = n_{b} k_{np\\to d\\gamma} Y_{p}$，$\\partial r_{1f}/\\partial Y_{p} = n_{b} k_{np\\to d\\gamma} Y_{n}$，\n- $\\partial r_{1r}/\\partial Y_{d} = \\lambda_{\\gamma d}$，\n- $\\partial r_{2f}/\\partial Y_{d} = n_{b} k_{dp\\to 3\\gamma} Y_{p}$，$\\partial r_{2f}/\\partial Y_{p} = n_{b} k_{dp\\to 3\\gamma} Y_{d}$，\n- $\\partial r_{3f}/\\partial Y_{d} = n_{b} k_{dd\\to 3n} Y_{d}$，\n- $\\partial r_{4f}/\\partial Y_{d} = n_{b} k_{3d\\to 4p} Y_{3}$，$\\partial r_{4f}/\\partial Y_{3} = n_{b} k_{3d\\to 4p} Y_{d}$。\n\n因此，雅可比矩阵的元素是：\n\n对于中子行：\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{n}} = -\\lambda_{np} - \\frac{\\partial r_{1f}}{\\partial Y_{n}} + 0 + 0 = -\\lambda_{np} - n_{b} k_{np\\to d\\gamma} Y_{p},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{p}} = \\lambda_{pn} - \\frac{\\partial r_{1f}}{\\partial Y_{p}} = \\lambda_{pn} - n_{b} k_{np\\to d\\gamma} Y_{n},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{d}} = \\frac{\\partial r_{1r}}{\\partial Y_{d}} + \\frac{\\partial r_{3f}}{\\partial Y_{d}} = \\lambda_{\\gamma d} + n_{b} k_{dd\\to 3n} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{3}} = 0,\\quad \\frac{\\partial \\dot{Y}_{n}}{\\partial Y_{4}} = 0.\n$$\n\n对于质子行：\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{n}} = \\lambda_{np} - \\frac{\\partial r_{1f}}{\\partial Y_{n}} = \\lambda_{np} - n_{b} k_{np\\to d\\gamma} Y_{p},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{p}} = -\\lambda_{pn} - \\frac{\\partial r_{1f}}{\\partial Y_{p}} - \\frac{\\partial r_{2f}}{\\partial Y_{p}} = -\\lambda_{pn} - n_{b} k_{np\\to d\\gamma} Y_{n} - n_{b} k_{dp\\to 3\\gamma} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{d}} = \\frac{\\partial r_{1r}}{\\partial Y_{d}} - \\frac{\\partial r_{2f}}{\\partial Y_{d}} + \\frac{\\partial r_{4f}}{\\partial Y_{d}} = \\lambda_{\\gamma d} - n_{b} k_{dp\\to 3\\gamma} Y_{p} + n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{3}} = \\frac{\\partial r_{4f}}{\\partial Y_{3}} = n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{p}}{\\partial Y_{4}} = 0.\n$$\n\n对于氘核行：\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{n}} = \\frac{\\partial r_{1f}}{\\partial Y_{n}} = n_{b} k_{np\\to d\\gamma} Y_{p},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{p}} = \\frac{\\partial r_{1f}}{\\partial Y_{p}} - \\frac{\\partial r_{2f}}{\\partial Y_{p}} = n_{b} k_{np\\to d\\gamma} Y_{n} - n_{b} k_{dp\\to 3\\gamma} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{d}} = - \\frac{\\partial r_{1r}}{\\partial Y_{d}} - \\frac{\\partial r_{2f}}{\\partial Y_{d}} - 2 \\frac{\\partial r_{3f}}{\\partial Y_{d}} - \\frac{\\partial r_{4f}}{\\partial Y_{d}} = -\\lambda_{\\gamma d} - n_{b} k_{dp\\to 3\\gamma} Y_{p} - 2 n_{b} k_{dd\\to 3n} Y_{d} - n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{3}} = - \\frac{\\partial r_{4f}}{\\partial Y_{3}} = - n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{d}}{\\partial Y_{4}} = 0.\n$$\n\n对于氦-3行：\n$$\n\\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{n}} = 0,\\quad \\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{p}} = \\frac{\\partial r_{2f}}{\\partial Y_{p}} = n_{b} k_{dp\\to 3\\gamma} Y_{d},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{d}} = \\frac{\\partial r_{2f}}{\\partial Y_{d}} + \\frac{\\partial r_{3f}}{\\partial Y_{d}} - \\frac{\\partial r_{4f}}{\\partial Y_{d}} = n_{b} k_{dp\\to 3\\gamma} Y_{p} + n_{b} k_{dd\\to 3n} Y_{d} - n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{3}} = - \\frac{\\partial r_{4f}}{\\partial Y_{3}} = - n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{3}}{\\partial Y_{4}} = 0.\n$$\n\n对于氦-4行：\n$$\n\\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{n}} = 0,\\quad \\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{p}} = 0,\\quad \\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{d}} = \\frac{\\partial r_{4f}}{\\partial Y_{d}} = n_{b} k_{3d\\to 4p} Y_{3},\n$$\n$$\n\\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{3}} = \\frac{\\partial r_{4f}}{\\partial Y_{3}} = n_{b} k_{3d\\to 4p} Y_{d},\\quad \\frac{\\partial \\dot{Y}_{4}}{\\partial Y_{4}} = 0.\n$$\n\n对于每个测试用例，算法按以下步骤进行：\n- 将以 MeV 为单位的 $T$ 转换为以焦耳为单位的 $k_{B} T$，即 $k_{B} T = (T/\\mathrm{MeV}) \\times 1.602176634\\times 10^{-13}\\,\\mathrm{J}$，代入 $n_{\\gamma}(T)$，并计算 $n_{b}(T) = \\eta n_{\\gamma}(T)$。\n- 在该 $T$ 下评估所有依赖于温度的反应率。\n- 使用上述偏导数构建 $J(\\mathbf{Y};T)$。\n- 计算 $J$ 的特征值并获得 $\\Gamma_{\\mathrm{fast}}(T,\\mathbf{Y}) = \\max\\left\\{-\\operatorname{Re}\\lambda : \\operatorname{Re}\\lambda  0\\right\\}$，如果不存在负实部，则为 $0$。\n- 将 $\\Gamma_{\\mathrm{fast}}$ 四舍五入到 $6$ 位有效数字，并按测试套件的顺序在单个列表中输出。\n\n该构建源于质量作用动力学、通过化学计量一致性实现的重子数守恒，以及利用热浴中的光子数密度从 $\\eta$ 确定重子数密度。雅可比矩阵的特征值表征了网络在指定状态附近的线性化模式：大的负实部对应于快速衰减（刚性）的模式。报告的 $\\Gamma_{\\mathrm{fast}}$ 确定了以 $\\mathrm{s}^{-1}$ 为单位的最快衰变率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nHBAR = 1.054571817e-34       # J*s\nC = 299792458.0              # m/s\nPI = np.pi\nMEV_TO_J = 1.602176634e-13   # 1 MeV in Joules\nZETA3 = 1.202056903159594    # Apery's constant zeta(3)\n\n# Cosmological parameter\nETA = 6.1e-10  # baryon-to-photon ratio\n\ndef n_gamma(T_MeV: float) -> float:\n    \"\"\"\n    Photon number density n_gamma(T) in m^-3.\n    T_MeV is temperature in MeV interpreted as energy scale: k_B T = T_MeV * MEV_TO_J.\n    \"\"\"\n    kT = T_MeV * MEV_TO_J  # J\n    pref = 2.0 * ZETA3 / (PI**2)\n    return pref * (kT**3) / ((HBAR * C)**3)\n\ndef n_baryon(T_MeV: float) -> float:\n    return ETA * n_gamma(T_MeV)\n\ndef rates(T_MeV: float):\n    \"\"\"\n    Compute temperature-dependent rates at T (MeV).\n    Returns a dictionary of scalar rates and rate coefficients.\n    \"\"\"\n    # Weak rates\n    a_w = 1.0  # s^-1 MeV^-5\n    Delta = 1.293  # MeV\n    lam_np = a_w * (T_MeV**5)\n    lam_pn = a_w * (T_MeV**5) * np.exp(-Delta / max(T_MeV, 1e-12))\n\n    # Nuclear rate coefficients (m^3/s), mild T scaling\n    scale = np.sqrt(max(T_MeV, 0.0) / 0.1)\n    k_np_d = 4.5e-27 * scale\n    k_dp_3 = 1.0e-26 * scale\n    k_dd_3n = 5.0e-27 * scale\n    k_3d_4p = 1.0e-26 * scale\n\n    # Photodisintegration of deuteron (s^-1)\n    Bd = 2.224  # MeV\n    lam_gd = 1.0e5 * (T_MeV**3) * np.exp(-Bd / max(T_MeV, 1e-12))\n\n    return {\n        \"lam_np\": lam_np,\n        \"lam_pn\": lam_pn,\n        \"k_np_d\": k_np_d,\n        \"k_dp_3\": k_dp_3,\n        \"k_dd_3n\": k_dd_3n,\n        \"k_3d_4p\": k_3d_4p,\n        \"lam_gd\": lam_gd,\n    }\n\ndef jacobian(Y, T_MeV):\n    \"\"\"\n    Construct the 5x5 Jacobian matrix d(dY/dt)/dY at given abundances Y and temperature T_MeV.\n    Y order: [Y_n, Y_p, Y_d, Y_3, Y_4]\n    \"\"\"\n    Yn, Yp, Yd, Y3, Y4 = Y\n    nb = n_baryon(T_MeV)\n    r = rates(T_MeV)\n\n    lam_np = r[\"lam_np\"]\n    lam_pn = r[\"lam_pn\"]\n    k_np_d = r[\"k_np_d\"]\n    k_dp_3 = r[\"k_dp_3\"]\n    k_dd_3n = r[\"k_dd_3n\"]\n    k_3d_4p = r[\"k_3d_4p\"]\n    lam_gd = r[\"lam_gd\"]\n\n    # Precompute useful combinations for derivatives\n    d_r1f_dYn = nb * k_np_d * Yp\n    d_r1f_dYp = nb * k_np_d * Yn\n    d_r1r_dYd = lam_gd\n    d_r2f_dYd = nb * k_dp_3 * Yp\n    d_r2f_dYp = nb * k_dp_3 * Yd\n    d_r3f_dYd = nb * k_dd_3n * Yd\n    d_r4f_dYd = nb * k_3d_4p * Y3\n    d_r4f_dY3 = nb * k_3d_4p * Yd\n\n    J = np.zeros((5,5), dtype=np.float64)\n\n    # Row for dY_n/dt\n    J[0,0] = -lam_np - d_r1f_dYn\n    J[0,1] = lam_pn - d_r1f_dYp\n    J[0,2] = d_r1r_dYd + d_r3f_dYd\n    J[0,3] = 0.0\n    J[0,4] = 0.0\n\n    # Row for dY_p/dt\n    J[1,0] = lam_np - d_r1f_dYn\n    J[1,1] = -lam_pn - d_r1f_dYp - d_r2f_dYp\n    J[1,2] = d_r1r_dYd - d_r2f_dYd + d_r4f_dYd\n    J[1,3] = d_r4f_dY3\n    J[1,4] = 0.0\n\n    # Row for dY_d/dt\n    J[2,0] = d_r1f_dYn\n    J[2,1] = d_r1f_dYp - d_r2f_dYp\n    J[2,2] = -d_r1r_dYd - d_r2f_dYd - 2.0 * d_r3f_dYd - d_r4f_dYd\n    J[2,3] = -d_r4f_dY3\n    J[2,4] = 0.0\n\n    # Row for dY_3/dt\n    J[3,0] = 0.0\n    J[3,1] = d_r2f_dYp\n    J[3,2] = d_r2f_dYd + d_r3f_dYd - d_r4f_dYd\n    J[3,3] = -d_r4f_dY3\n    J[3,4] = 0.0\n\n    # Row for dY_4/dt\n    J[4,0] = 0.0\n    J[4,1] = 0.0\n    J[4,2] = d_r4f_dYd\n    J[4,3] = d_r4f_dY3\n    J[4,4] = 0.0\n\n    return J\n\ndef fastest_decay_rate(Y, T_MeV):\n    J = jacobian(Y, T_MeV)\n    eigs = np.linalg.eigvals(J)\n    real_parts = np.real(eigs)\n    neg_reals = real_parts[real_parts  0.0]\n    if neg_reals.size == 0:\n        return 0.0\n    return float(np.max(-neg_reals))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_MeV, [Yn, Yp, Yd, Y3, Y4])\n        (0.2,  [0.12, 0.88, 0.0,  0.0,  0.0]),\n        (0.1,  [0.12, 0.84, 0.02, 0.0,  0.0]),\n        (0.07, [0.08, 0.53, 0.02, 0.01, 0.08]),\n        (0.1,  [0.0,  0.0,  0.5,  0.0,  0.0]),\n    ]\n\n    results = []\n    for T, Y in test_cases:\n        gamma_fast = fastest_decay_rate(Y, T)\n        # Round to 6 significant figures\n        results.append(f\"{gamma_fast:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}