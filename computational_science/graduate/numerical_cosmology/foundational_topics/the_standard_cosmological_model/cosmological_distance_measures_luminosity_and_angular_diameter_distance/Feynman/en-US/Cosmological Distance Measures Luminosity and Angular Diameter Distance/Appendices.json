{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of modern cosmology is the flat ΛCDM model, which provides a remarkably successful description of our universe. This first exercise  guides you through the essential task of computing the fundamental luminosity distance ($D_L$) and angular diameter distance ($D_A$) from first principles. By numerically integrating the Friedmann equation, you will translate the universe's expansion history into concrete, observable distance measures, a foundational skill for analyzing real-world cosmological data.",
            "id": "3469306",
            "problem": "You are tasked with designing and implementing a numerical algorithm to compute cosmological distance measures in a spatially flat Lambda Cold Dark Matter (ΛCDM) cosmology. Begin from first principles: the Robertson–Walker metric and the Friedmann equation specialized to a spatially flat geometry with non-relativistic matter and a cosmological constant. Derive the line-of-sight comoving distance based on the expansion history implied by these inputs and then compute both the luminosity distance and the angular diameter distance using the physically valid relationships for metric theories of gravity. Ensure that all definitions and derivations follow consistently from these fundamental bases and do not rely on pre-stated final formulas.\n\nAlgorithmic and physical constraints:\n- Assume a spatially flat Universe, neglecting the radiation component over the redshift range considered.\n- Use the speed of light $c = 299{,}792.458\\,\\mathrm{km\\,s^{-1}}$.\n- The Hubble constant $H_0$ is provided in $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$.\n- All reported distances must be expressed in $\\mathrm{Mpc}$.\n- Use the definition of cosmological redshift $z$ and the appropriate expansion rate consistent with the Friedmann equation for the assumed contents, with matter density parameter $\\Omega_m$ and cosmological constant density parameter satisfying spatial flatness.\n- Implement a numerical integral over redshift to obtain the line-of-sight comoving distance, and from it compute the luminosity distance and angular diameter distance. Use physically justified relations connecting these distances in metric theories.\n\nNumerical output requirements:\n- For each test case, compute the luminosity distance $D_L$ and the angular diameter distance $D_A$, both in $\\mathrm{Mpc}$.\n- Round each reported value to six decimal places.\n- Produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list of the form $[D_L, D_A]$ with both values in $\\mathrm{Mpc}$ rounded to six decimal places. For example: $[[D_{L,1},D_{A,1}],[D_{L,2},D_{A,2}],\\dots]$.\n\nTest suite:\nCompute $[D_L, D_A]$ for the following spatially flat ΛCDM configurations, each specified by $(z, H_0, \\Omega_m)$:\n1. $(z=0.5,\\; H_0=70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}},\\; \\Omega_m=0.3)$.\n2. $(z=0.0,\\; H_0=70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}},\\; \\Omega_m=0.3)$, a boundary case where distances should reflect the local limit.\n3. $(z=10^{-6},\\; H_0=70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}},\\; \\Omega_m=0.3)$, a near-linear Hubble-law regime check.\n4. $(z=2.0,\\; H_0=70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}},\\; \\Omega_m=0.3)$, a higher-redshift case probing the matter-dominated scaling.\n5. $(z=0.5,\\; H_0=67.74\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}},\\; \\Omega_m=0.315)$, a Planck-like cosmology variation.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list $[D_L, D_A]$ with both values in $\\mathrm{Mpc}$ rounded to six decimal places. For example, the output format must be exactly like:\n$[[D_{L,1},D_{A,1}],[D_{L,2},D_{A,2}],[D_{L,3},D_{A,3}],[D_{L,4},D_{A,4}],[D_{L,5},D_{A,5}]]$.",
            "solution": "The problem is valid as it is scientifically grounded in the standard ΛCDM cosmological model, well-posed with sufficient and consistent data, and objectively stated. It presents a standard, non-trivial calculation in numerical cosmology. We will now proceed with the solution, deriving the necessary expressions from first principles.\n\nOur starting point is the Robertson–Walker (RW) metric for a homogeneous and isotropic universe. The problem species a spatially flat geometry, for which the curvature parameter $k=0$. The RW line element $ds^2$ simplifies to:\n$$ ds^2 = c^2 dt^2 - a(t)^2 \\left[ dr^2 + r^2 (d\\theta^2 + \\sin^2\\theta d\\phi^2) \\right] $$\nwhere $c$ is the speed of light, $t$ is the cosmological proper time, $a(t)$ is the dimensionless scale factor (normalized to $a(t_0)=1$ today), and $(r, \\theta, \\phi)$ are the comoving coordinates.\n\nThe dynamics of the scale factor $a(t)$ are governed by the Friedmann equations. For a universe containing non-relativistic matter (density parameter $\\Omega_m$) and a cosmological constant (density parameter $\\Omega_\\Lambda$), and neglecting the radiation component as specified, the first Friedmann equation is:\n$$ \\left(\\frac{\\dot{a}}{a}\\right)^2 = H(t)^2 = H_0^2 \\left[ \\Omega_m a^{-3} + \\Omega_\\Lambda \\right] $$\nHere, $H(t) = \\dot{a}/a$ is the Hubble parameter, and $H_0$ is its value today. The spatial flatness condition imposes the constraint $\\Omega_m + \\Omega_\\Lambda = 1$, so we can write $\\Omega_\\Lambda = 1 - \\Omega_m$.\n\nWe relate the scale factor $a$ to the observable cosmological redshift $z$ via the definition $1+z = a_0/a = 1/a$. Substituting this into the Friedmann equation allows us to express the Hubble parameter as a function of redshift:\n$$ H(z)^2 = H_0^2 \\left[ \\Omega_m (1+z)^3 + 1 - \\Omega_m \\right] $$\nIt is convenient to define the dimensionless Hubble parameter $E(z) = H(z)/H_0$:\n$$ E(z) = \\sqrt{\\Omega_m (1+z)^3 + 1 - \\Omega_m} $$\n\nTo find the distance to an object, we consider a photon traveling from a source at redshift $z$ to an observer at $z=0$. Photons travel along null geodesics, where $ds^2=0$. For a photon traveling radially towards us ($d\\theta=d\\phi=0$), the RW metric gives $c\\,dt = a(t)\\,dr$. The line-of-sight comoving distance, $D_C$, is the comoving coordinate $r$ of the source, obtained by integrating this relation from the time of emission $t_e$ to the time of observation $t_0$:\n$$ D_C = \\int_0^{D_C} dr = \\int_{t_e}^{t_0} \\frac{c}{a(t)} dt $$\nTo perform this integral, we change the integration variable from time $t$ to redshift $z'$. From the definition of the Hubble parameter, $H = \\frac{1}{a}\\frac{da}{dt}$, and the relation $a=(1+z')^{-1}$, we find $dt = \\frac{da}{aH} = -\\frac{dz'}{(1+z')H(z')}$. The integration limits change from $(t_e, t_0)$ to $(z, 0)$.\n$$ D_C(z) = c \\int_z^0 (1+z') \\left( -\\frac{dz'}{(1+z')H(z')} \\right) = c \\int_0^z \\frac{dz'}{H(z')} $$\nSubstituting $H(z') = H_0 E(z')$, we arrive at the integral for the comoving distance:\n$$ D_C(z) = \\frac{c}{H_0} \\int_0^z \\frac{dz'}{\\sqrt{\\Omega_m (1+z')^3 + 1 - \\Omega_m}} $$\nThe quantity $D_H = c/H_0$ is known as the Hubble distance. Given that $c$ is in $\\mathrm{km\\,s^{-1}}$ and $H_0$ is in $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, $D_H$ will be in units of $\\mathrm{Mpc}$. The integral is a dimensionless quantity that must be evaluated numerically.\n\nFrom the comoving distance, we can derive the luminosity distance ($D_L$) and angular diameter distance ($D_A$).\nThe luminosity distance $D_L$ is defined by the flux-luminosity relation $F = L/(4\\pi D_L^2)$. In an expanding universe, the observed flux is reduced by two factors of $(1+z)$: one for the redshifting of photon energy and one for the time dilation of photon arrival rate. This leads to the relation (for a flat universe):\n$$ D_L(z) = (1+z) D_C(z) $$\n\nThe angular diameter distance $D_A$ is defined by the relation between an object's proper transverse size $l$ and its angular size $\\delta\\theta$ via $l = D_A \\delta\\theta$. An object of proper size $l$ at emission time $t_e$ (redshift $z$) spans an angle $\\delta\\theta = l / (a(t_e) D_C(z))$. Since $a(t_e) = 1/(1+z)$, this gives the relation:\n$$ D_A(z) = \\frac{D_C(z)}{1+z} $$\nNote that these two distances are related by the fundamental Etherington reciprocity theorem, $D_L = (1+z)^2 D_A$, which is a consistency check for our derivations.\n\nThe algorithm to be implemented is as follows:\n1. For each test case $(z, H_0, \\Omega_m)$, define the integrand function $f(z') = E(z')^{-1}$.\n2. Handle the trivial case where $z=0$, for which $D_C, D_L, D_A$ are all $0$.\n3. For $z0$, numerically integrate $f(z')$ from $0$ to $z$ using a standard quadrature method, such as that provided by `scipy.integrate.quad`.\n4. Calculate the Hubble distance $D_H = c/H_0$.\n5. Compute the comoving distance $D_C = D_H \\times \\int_0^z f(z') dz'$.\n6. Compute the luminosity distance $D_L = (1+z)D_C$ and the angular diameter distance $D_A = D_C/(1+z)$.\n7. Round the results to six decimal places and format them as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes luminosity and angular diameter distances in a spatially flat\n    Lambda-CDM cosmology.\n    \"\"\"\n    # Define physical constants and test cases as per the problem statement.\n    C_KMS = 299792.458  # Speed of light in km/s\n\n    test_cases = [\n        # (z, H0 in km/s/Mpc, Omega_m)\n        (0.5, 70.0, 0.3),\n        (0.0, 70.0, 0.3),\n        (1.0E-6, 70.0, 0.3),\n        (2.0, 70.0, 0.3),\n        (0.5, 67.74, 0.315)\n    ]\n\n    # The integrand for the comoving distance calculation is 1/E(z), where\n    # E(z) = H(z)/H_0.\n    def integrand(z_prime, omega_m):\n        \"\"\"\n        Integrand function, 1/E(z'), for the comoving distance integral.\n        For a flat universe, Omega_Lambda = 1 - Omega_m.\n        \"\"\"\n        return 1.0 / np.sqrt(omega_m * (1.0 + z_prime)**3 + (1.0 - omega_m))\n\n    results = []\n    for z, h0, omega_m in test_cases:\n        # The boundary case at z=0 results in zero distance.\n        if z == 0.0:\n            dl = 0.0\n            da = 0.0\n        else:\n            # Calculate the Hubble distance in Mpc.\n            # H0 is in km/s/Mpc, c is in km/s, so D_H is in Mpc.\n            d_h = C_KMS / h0\n\n            # Numerically integrate to find the dimensionless comoving distance integral.\n            # The result is the line-of-sight comoving distance D_C in units of D_H.\n            integral_val, _ = integrate.quad(\n                integrand, 0, z, args=(omega_m,)\n            )\n\n            # Calculate the line-of-sight comoving distance D_C in Mpc.\n            d_c = d_h * integral_val\n\n            # The luminosity distance D_L relates to D_C by a factor of (1+z).\n            dl = d_c * (1.0 + z)\n\n            # The angular diameter distance D_A relates to D_C by a factor of 1/(1+z).\n            da = d_c / (1.0 + z)\n        \n        # Round the final distances to six decimal places as required.\n        dl_rounded = round(dl, 6)\n        da_rounded = round(da, 6)\n\n        results.append([dl_rounded, da_rounded])\n\n    # The final output must be a single line, formatted as a list of lists.\n    # The default string representation of a list is used for each [D_L, D_A] pair.\n    # e.g., str([1.23, 4.56]) gives \"[1.23, 4.56]\".\n    # These string representations are then joined by commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "While the assumption of a flat universe is a powerful simplification, a crucial task in cosmology is to test this hypothesis and quantify the effects of potential spatial curvature. This practice  challenges you to extend your calculations to non-flat geometries, exploring how a closed ($\\Omega_k  0$) or open ($\\Omega_k  0$) universe alters the fabric of spacetime. You will compute the transverse comoving distance and directly measure the impact of curvature, gaining a deeper appreciation for the geometric nature of cosmological distances.",
            "id": "3469235",
            "problem": "You are to implement a complete, runnable program that computes the fractional difference between transverse comoving distance in a spatially curved Universe and in a spatially flat Universe, evaluated at specified redshifts. The transverse comoving distance is a foundational cosmological distance measure closely related to both the angular diameter distance and the luminosity distance through Etherington reciprocity. The calculation must be built from the Friedmann–Lemaître–Robertson–Walker (FLRW) geometry and the Friedmann equation with non-relativistic matter and a cosmological constant, treating spatial curvature consistently.\n\nStarting point and assumptions:\n- Use the Friedmann–Lemaître–Robertson–Walker (FLRW) model with scale factor $a(t)$ and neglect radiation. The Hubble parameter is $H(z)$, with present value $H_0$.\n- Use the present-day density parameters $\\Omega_m$, $\\Omega_\\Lambda$, and $\\Omega_k$, which satisfy the closure relation $ \\Omega_m + \\Omega_\\Lambda + \\Omega_k = 1$ when radiation is neglected.\n- Spatial curvature is represented by $\\Omega_k$ with sign convention consistent with the FLRW metric. A closed Universe has $\\Omega_k  0$, a flat Universe has $\\Omega_k = 0$, and an open Universe has $\\Omega_k  0$.\n- The transverse comoving distance $D_M(z)$ must be constructed from first principles using the FLRW radial coordinate distance and spatial curvature mapping, without invoking any pre-provided shortcut formulas in this problem statement.\n\nProgram requirements:\n- Implement a numerical computation of the line-of-sight comoving distance using a one-dimensional quadrature over redshift from $z=0$ to the specified $z$.\n- Map the line-of-sight comoving distance to the transverse comoving distance $D_M(z)$ using the spatial curvature dependent geometry, ensuring the correct treatment for $\\Omega_k  0$, $\\Omega_k = 0$, and $\\Omega_k  0$.\n- Compute the fractional difference defined as\n$$\n\\frac{\\Delta D_M}{D_M} \\equiv \\frac{D_M^{\\mathrm{curved}}(z) - D_M^{\\mathrm{flat}}(z)}{D_M^{\\mathrm{flat}}(z)},\n$$\nwhere $D_M^{\\mathrm{flat}}(z)$ is the transverse comoving distance in the spatially flat Universe with the same $\\Omega_m$ and $\\Omega_\\Lambda$ adjusted by the closure relation for $\\Omega_k=0$.\n\nPhysical constants and units:\n- Use the speed of light $c = 299{,}792.458 \\ \\mathrm{km \\ s^{-1}}$.\n- Use the Hubble constant $H_0 = 70 \\ \\mathrm{km \\ s^{-1} \\ Mpc^{-1}}$.\n- Express all distances internally in $\\mathrm{Mpc}$. The requested fractional difference $\\Delta D_M / D_M$ is dimensionless.\n- Angles appearing in trigonometric or hyperbolic functions must be treated as dimensionless quantities consistent with the FLRW curvature mapping.\n\nTest suite:\nFor each test case, set $\\Omega_\\Lambda$ by the closure relation $ \\Omega_\\Lambda = 1 - \\Omega_m - \\Omega_k$ for the specified $\\Omega_k$ in the curved Universe. For the flat Universe baseline, use $\\Omega_k=0$ and $\\Omega_\\Lambda = 1 - \\Omega_m$. Evaluate the fractional difference $\\Delta D_M / D_M$ for the following cases:\n- Test case $1$: $z=3$, $\\Omega_m=0.3$, curved Universe with $\\Omega_k=-0.01$ (closed; thus $\\Omega_m + \\Omega_\\Lambda = 1.01$).\n- Test case $2$: $z=1$, $\\Omega_m=0.3$, curved Universe with $\\Omega_k=-0.01$ (closed).\n- Test case $3$: $z=3$, $\\Omega_m=0.3$, curved Universe with $\\Omega_k=+0.01$ (open; thus $\\Omega_m + \\Omega_\\Lambda = 0.99$).\n- Test case $4$: $z=3$, $\\Omega_m=0.3$, curved Universe with $\\Omega_k=-10^{-6}$ (nearly flat, closed).\n- Test case $5$: $z=0.1$, $\\Omega_m=0.3$, curved Universe with $\\Omega_k=-0.01$ (closed).\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each value rounded to $8$ decimal places, for example,\n$$\n[\\text{r}_1,\\text{r}_2,\\text{r}_3,\\text{r}_4,\\text{r}_5],\n$$\nwhere each $\\text{r}_i$ is the computed value of $\\Delta D_M / D_M$ for the corresponding test case.\n\nScientific realism and constraints:\n- The numerical integration must be stable and accurate for all specified cases.\n- Handle the $\\Omega_k=0$ case and the nearly flat case $\\Omega_k=-10^{-6}$ robustly.\n- Do not use any external inputs; all parameters are specified above and within the program.",
            "solution": "The user has requested the computation of the fractional difference in transverse comoving distance between a spatially curved Universe and a spatially flat Universe for several test cases. This task requires a rigorous application of cosmological distance measures derived from the Friedmann–Lemaître–Robertson–Walker (FLRW) metric. The solution will be constructed from first principles as specified.\n\n### 1. Theoretical Framework\n\nThe problem is set within the context of the standard cosmological model, described by the FLRW metric. Neglecting radiation as specified, the Universe's dynamics are governed by non-relativistic matter (with present-day density parameter $\\Omega_m$) and a cosmological constant ($\\Omega_\\Lambda$). The spatial geometry is described by the curvature density parameter $\\Omega_k$. These parameters are constrained by the Friedmann equation, which at the present epoch ($z=0$) yields the closure relation:\n$$\n\\Omega_m + \\Omega_\\Lambda + \\Omega_k = 1\n$$\n\nThe fundamental distance measure required is the transverse comoving distance, $D_M(z)$. Its calculation proceeds in two stages: first, computing the line-of-sight comoving distance, $D_C(z)$, and second, mapping $D_C(z)$ to $D_M(z)$ based on the spatial curvature.\n\n### 2. The Hubble Parameter $H(z)$\n\nThe evolution of the Hubble parameter with redshift $z$ is given by the Friedmann equation. Using the scale factor $a = (1+z)^{-1}$ (with $a_0=1$ at present), the Hubble parameter $H(z) = \\dot{a}/a$ evolves as:\n$$\nH(z)^2 = H_0^2 \\left[ \\Omega_m (1+z)^3 + \\Omega_\\Lambda + \\Omega_k (1+z)^2 \\right]\n$$\nwhere $H_0$ is the Hubble constant. It is convenient to define the dimensionless Hubble parameter, $E(z) = H(z)/H_0$, such that:\n$$\nE(z) = \\sqrt{\\Omega_m (1+z)^3 + \\Omega_k (1+z)^2 + \\Omega_\\Lambda}\n$$\n\n### 3. Line-of-Sight Comoving Distance, $D_C(z)$\n\nThe line-of-sight comoving distance to an object at redshift $z$ is the total distance traveled by a photon from the object to the observer, scaled to the present-day size of the Universe. It is calculated by integrating the infinitesimal comoving distance $c \\, dt/a(t)$ over the photon's travel time. By changing the integration variable to redshift $z$ using the relation $dt = -dz / ((1+z)H(z))$, we obtain:\n$$\nD_C(z) = \\int_{t_e}^{t_0} \\frac{c \\, dt}{a(t)} = c \\int_0^z \\frac{dz'}{H(z')}\n$$\nSubstituting $H(z') = H_0 E(z')$, this becomes:\n$$\nD_C(z) = \\frac{c}{H_0} \\int_0^z \\frac{dz'}{E(z')} = D_H \\int_0^z \\frac{dz'}{\\sqrt{\\Omega_m(1+z')^3 + \\Omega_k(1+z')^2 + \\Omega_\\Lambda}}\n$$\nwhere $D_H = c/H_0$ is the Hubble distance. The integral must be evaluated numerically.\n\n### 4. Transverse Comoving Distance, $D_M(z)$\n\nThe transverse comoving distance $D_M(z)$ relates the physical transverse size of an object at redshift $z$ to its angular size on the sky. It is equivalent to the comoving radial coordinate in a specific form of the FLRW metric and is related to $D_C(z)$ through a mapping that depends on the spatial curvature, $\\Omega_k$.\n\nThe relationship is defined as follows:\n- For a spatially **flat** Universe ($\\Omega_k = 0$):\n  $$\n  D_M(z) = D_C(z)\n  $$\n- For a spatially **closed** Universe ($\\Omega_k  0$):\n  $$\n  D_M(z) = \\frac{D_H}{\\sqrt{-\\Omega_k}} \\sin\\left(\\frac{\\sqrt{-\\Omega_k}}{D_H} D_C(z)\\right)\n  $$\n- For a spatially **open** Universe ($\\Omega_k  0$):\n  $$\n  D_M(z) = \\frac{D_H}{\\sqrt{\\Omega_k}} \\sinh\\left(\\frac{\\sqrt{\\Omega_k}}{D_H} D_C(z)\\right)\n  $$\n\nFor cases where $|\\Omega_k|$ is very small, a direct computation of these formulas can be prone to numerical precision errors. A Taylor series expansion provides a more robust calculation. For small $x$, $\\sin(x) \\approx x - x^3/6$ and $\\sinh(x) \\approx x + x^3/6$. Applying this to the formulae for $D_M(z)$ yields a common approximation valid for any small $\\Omega_k$:\n$$\nD_M(z) \\approx D_C(z) \\left(1 + \\frac{\\Omega_k D_C(z)^2}{6 D_H^2}\\right)\n$$\nThis approximation is particularly useful for robustly handling nearly-flat cosmologies, such as the provided test case with $\\Omega_k = -10^{-6}$. In the implementation, this Taylor expansion can be used when $|\\Omega_k|$ falls below a small threshold (e.g., $10^{-8}$) to ensure stability, though standard double-precision floating-point arithmetic is generally sufficient for the magnitudes specified in the test cases.\n\n### 5. Computational Algorithm\n\nThe requested fractional difference is $\\frac{\\Delta D_M}{D_M} = \\frac{D_M^{\\mathrm{curved}}(z) - D_M^{\\mathrm{flat}}(z)}{D_M^{\\mathrm{flat}}(z)}$. For each test case defined by a redshift $z$, a matter density $\\Omega_m$, and a curvature $\\Omega_{k, \\mathrm{curved}}$, the algorithm is as follows:\n\n1.  **Define Constants**: Set the physical constants $c = 299792.458 \\, \\mathrm{km \\, s^{-1}}$ and $H_0 = 70 \\, \\mathrm{km \\, s^{-1} \\, Mpc^{-1}}$. Compute the Hubble distance $D_H = c/H_0$.\n\n2.  **Compute $D_M^{\\mathrm{flat}}(z)$**: This is the baseline for comparison.\n    a.  Set the cosmological parameters for the flat model: $\\Omega_{m, \\mathrm{flat}} = \\Omega_m$ (from the test case), $\\Omega_{k, \\mathrm{flat}} = 0$, and $\\Omega_{\\Lambda, \\mathrm{flat}} = 1 - \\Omega_{m, \\mathrm{flat}}$.\n    b.  Define the integrand $1/E(z')$ for the flat model.\n    c.  Numerically integrate this from $z'=0$ to $z$ to find the dimensionless integral $I_{\\mathrm{flat}}$.\n    d.  Calculate $D_{C, \\mathrm{flat}}(z) = D_H \\times I_{\\mathrm{flat}}$.\n    e.  Since $\\Omega_{k, \\mathrm{flat}} = 0$, $D_{M, \\mathrm{flat}}(z) = D_{C, \\mathrm{flat}}(z)$.\n\n3.  **Compute $D_M^{\\mathrm{curved}}(z)$**: This is the value for the specified curved universe.\n    a.  Set the cosmological parameters for the curved model: $\\Omega_{m, \\mathrm{curved}} = \\Omega_m$, $\\Omega_{k, \\mathrm{curved}} = \\Omega_k$ (from the test case), and $\\Omega_{\\Lambda, \\mathrm{curved}} = 1 - \\Omega_{m, \\mathrm{curved}} - \\Omega_{k, \\mathrm{curved}}$.\n    b.  Define the integrand $1/E(z')$ for the curved model.\n    c.  Numerically integrate this from $z'=0$ to $z$ to find the dimensionless integral $I_{\\mathrm{curved}}$.\n    d.  Calculate $D_{C, \\mathrm{curved}}(z) = D_H \\times I_{\\mathrm{curved}}$.\n    e.  Apply the appropriate curvature-dependent formula to compute $D_{M, \\mathrm{curved}}(z)$ from $D_{C, \\mathrm{curved}}(z)$ and $\\Omega_{k, \\mathrm{curved}}$. For $\\Omega_{k, \\mathrm{curved}}  0$, use the `sin` formula. For $\\Omega_{k, \\mathrm{curved}}  0$, use the `sinh` formula.\n\n4.  **Calculate Fractional Difference**:\n    a.  Compute the nal result: $(\\frac{D_M^{\\mathrm{curved}}(z) - D_M^{\\mathrm{flat}}(z)}{D_M^{\\mathrm{flat}}(z)})$.\n    b.  Repeat for all test cases and format the output as specified.\n\nThis procedure rigorously adheres to the problem statement, constructing the required cosmological distances from fundamental principles and ensuring numerical robustness.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the fractional difference between transverse comoving distance\n    in a spatially curved Universe and in a spatially flat Universe.\n    \"\"\"\n\n    # Define physical constants and test cases as per the problem statement.\n    C_KM_S = 299792.458  # Speed of light in km/s\n    H0 = 70.0  # Hubble constant in km/s/Mpc\n    D_H = C_KM_S / H0  # Hubble distance in Mpc\n\n    test_cases = [\n        # (z, Omega_m, Omega_k_curved)\n        (3.0, 0.3, -0.01),\n        (1.0, 0.3, -0.01),\n        (3.0, 0.3, +0.01),\n        (3.0, 0.3, -1.0e-6),\n        (0.1, 0.3, -0.01),\n    ]\n\n    results = []\n    for z, om_m, om_k_curved in test_cases:\n        # Calculate the fractional difference for each case.\n        result = compute_fractional_difference(z, om_m, om_k_curved, D_H)\n        results.append(result)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join([f'{r:.8f}' for r in results])}]\")\n\ndef compute_fractional_difference(z, om_m, om_k_curved, d_h):\n    \"\"\"\n    Computes the fractional difference for a single cosmological model.\n    \"\"\"\n    # 1. Flat Universe baseline calculation\n    om_l_flat = 1.0 - om_m\n    om_k_flat = 0.0\n\n    def integrand_flat(z_prime):\n        e_z = np.sqrt(om_m * (1 + z_prime)**3 + om_l_flat)\n        return 1.0 / e_z\n\n    integral_flat, _ = quad(integrand_flat, 0, z)\n    d_c_flat = d_h * integral_flat\n    # For a flat universe, D_M = D_C\n    d_m_flat = d_c_flat\n\n    # 2. Curved Universe calculation\n    om_l_curved = 1.0 - om_m - om_k_curved\n\n    def integrand_curved(z_prime):\n        e_z = np.sqrt(om_m * (1 + z_prime)**3 + om_k_curved * (1 + z_prime)**2 + om_l_curved)\n        return 1.0 / e_z\n\n    integral_curved, _ = quad(integrand_curved, 0, z)\n    d_c_curved = d_h * integral_curved\n\n    # Compute transverse comoving distance D_M for the curved universe\n    if om_k_curved == 0:\n        d_m_curved = d_c_curved\n    else:\n        # A small threshold for om_k to switch to Taylor expansion for robustness.\n        # Although for the given test cases, direct computation is numerically stable.\n        om_k_threshold = 1.0e-9 \n        if abs(om_k_curved)  om_k_threshold:\n            # Use Taylor expansion for near-flat case: D_M ≈ D_C * (1 + om_k*D_C^2 / (6*D_H^2))\n            d_m_curved = d_c_curved * (1.0 + om_k_curved * (d_c_curved**2) / (6.0 * d_h**2))\n        else:\n            sqrt_abs_om_k = np.sqrt(abs(om_k_curved))\n            arg = sqrt_abs_om_k * d_c_curved / d_h\n            \n            if om_k_curved > 0: # Open universe\n                d_m_curved = (d_h / sqrt_abs_om_k) * np.sinh(arg)\n            else: # Closed universe\n                d_m_curved = (d_h / sqrt_abs_om_k) * np.sin(arg)\n\n    # 3. Compute the fractional difference\n    if d_m_flat == 0:\n        return 0.0\n    fractional_diff = (d_m_curved - d_m_flat) / d_m_flat\n\n    return fractional_diff\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond brute-force numerical integration, analytical approximations provide powerful physical insights, especially in the low-redshift regime historically accessible to astronomers. This exercise  shifts focus from coding to analytical derivation, guiding you through a Taylor expansion of the luminosity distance. By connecting this expansion to the deceleration parameter $q_0$, you will quantify the subtle but important influence of the universe's radiation content, illustrating how precision measurements help us take a complete inventory of the cosmos.",
            "id": "3469251",
            "problem": "Consider a spatially flat Friedmann–Lemaître–Robertson–Walker (FLRW) universe filled with nonrelativistic matter ($w=0$), radiation ($w=\\frac{1}{3}$), and a cosmological constant ($w=-1$). Let the present-day Hubble parameter be $H_{0} = 70~\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, the speed of light be $c = 299{,}792.458~\\mathrm{km\\,s^{-1}}$, and the present-day density parameters be $\\Omega_{m} = 0.3$, $\\Omega_{r} = 9 \\times 10^{-5}$, with flatness enforcing $\\Omega_{\\Lambda} = 1 - \\Omega_{m} - \\Omega_{r}$.\n\nStarting from the FLRW line element, the definition of the luminosity distance $D_{L}(z)$ in a spatially flat universe, and the Friedmann and Raychaudhuri equations, perform the following:\n\n1. Derive the low-redshift expansion for the luminosity distance $D_{L}(z)$ up to and including the quadratic term in $z$, writing the result in terms of $H_{0}$ and the present-day deceleration parameter $q_{0}$.\n\n2. Express the present-day deceleration parameter $q_{0}$ in terms of the present-day density parameters and equations of state, and then specialize to the mixture $(w_{m}=0, w_{r}=\\frac{1}{3}, w_{\\Lambda}=-1)$ to obtain $q_{0}$ as a function of $\\Omega_{m}$, $\\Omega_{r}$, and $\\Omega_{\\Lambda}$.\n\n3. Using the second-order low-$z$ expansion, quantify the impact of including radiation on the luminosity distance at $z=0.1$ by computing the fractional change\n$$\n\\Delta \\equiv \\frac{D_{L}^{(\\mathrm{with}~\\Omega_{r})}(z=0.1) - D_{L}^{(\\mathrm{no~radiation})}(z=0.1)}{D_{L}^{(\\mathrm{no~radiation})}(z=0.1)}\\,,\n$$\nwhere in the “no radiation” case one sets $\\Omega_{r}=0$ while holding $\\Omega_{m}=0.3$ fixed and imposing flatness. Evaluate $\\Delta$ numerically. Round your answer to four significant figures. Express the final result as a pure number (dimensionless).",
            "solution": "The problem is scientifically grounded, well-posed, and all necessary data for its resolution are provided. We can proceed with a solution. The solution is organized into three parts, corresponding to the three tasks in the problem statement.\n\nThe starting point is the Friedmann–Lemaître–Robertson–Walker (FLRW) line element for a spatially flat ($k=0$) universe:\n$$ds^2 = -c^2 dt^2 + a(t)^2 [dr^2 + r^2(d\\theta^2 + \\sin^2\\theta d\\phi^2)]$$\nwhere $a(t)$ is the scale factor, and $c$ is the speed of light. For a light ray traveling from a source at comoving coordinate $r$ to an observer at the origin ($r=0$) along a radial path ($d\\theta=d\\phi=0$), the null condition $ds^2=0$ implies $c\\,dt = a(t)\\,dr$. Integrating this from the time of emission $t_e$ to the time of observation $t_0$ gives the comoving distance $d_c$:\n$$d_c = \\int_0^r dr' = \\int_{t_e}^{t_0} \\frac{c\\,dt}{a(t)}$$\nBy changing the variable of integration from time $t$ to redshift $z$ using the relations $1+z = a_0/a(t)$ (with $a_0 \\equiv a(t_0)$) and $dt = -dz/((1+z)H(z))$, where $H(z) = \\dot{a}/a$ is the Hubble parameter, the comoving distance to an object at redshift $z$ is:\n$$d_c(z) = c \\int_0^z \\frac{dz'}{H(z')}$$\nThe luminosity distance $D_L$ is defined such that the observed flux $F$ from a source of absolute luminosity $L$ is $F = L/(4\\pi D_L^2)$. In an expanding FLRW universe, this definition yields $D_L(z) = a_0 r (1+z)$. By convention we set $a_0=1$, and noting that $r$ is the comoving distance $d_c(z)$, we have:\n$$D_L(z) = (1+z)d_c(z) = c(1+z)\\int_0^z \\frac{dz'}{H(z')}$$\n\n### Part 1: Low-Redshift Expansion of the Luminosity Distance\n\nTo find the low-redshift expansion of $D_L(z)$, we Taylor expand the integrand $1/H(z')$ around $z'=0$. First, we expand $H(z')$:\n$$H(z') = H(0) + \\left. \\frac{dH}{dz'}\\right|_{z'=0} z' + O(z'^2)$$\nWe know $H(0) = H_0$. The derivative term is related to the deceleration parameter $q = -a\\ddot{a}/\\dot{a}^2$. We have $\\dot{a} = Ha$, and $\\ddot{a} = \\dot{H}a + H\\dot{a} = (\\dot{H}+H^2)a$. Thus, $q = -(\\dot{H}/H^2 + 1)$, which gives $\\dot{H} = -H^2(1+q)$.\nThe chain rule gives $\\frac{dH}{dz'} = \\frac{dH}{dt}\\frac{dt}{dz'} = \\dot{H} \\frac{-1}{(1+z')H(z')}$.\nEvaluating at $z'=0$:\n$$\\left. \\frac{dH}{dz'}\\right|_{z'=0} = \\frac{\\dot{H}_0}{-(1+0)H_0} = \\frac{-H_0^2(1+q_0)}{-H_0} = H_0(1+q_0)$$\nwhere $q_0 = q(z=0)$ is the present-day deceleration parameter.\nThe expansion for $H(z')$ is:\n$$H(z') = H_0(1 + (1+q_0)z' + O(z'^2))$$\nTaking the reciprocal, we get:\n$$\\frac{1}{H(z')} = \\frac{1}{H_0} (1 - (1+q_0)z' + O(z'^2))$$\nNow, we integrate to find the comoving distance:\n$$d_c(z) = c \\int_0^z \\frac{1}{H_0} (1 - (1+q_0)z') dz' = \\frac{c}{H_0} \\left[z' - \\frac{1+q_0}{2}z'^2\\right]_0^z = \\frac{c}{H_0}\\left(z - \\frac{1+q_0}{2}z^2\\right)$$\nFinally, we find the luminosity distance $D_L(z) = (1+z)d_c(z)$:\n$$D_L(z) = (1+z) \\frac{c}{H_0}\\left(z - \\frac{1+q_0}{2}z^2 + O(z^3)\\right)$$\n$$D_L(z) = \\frac{c}{H_0}\\left(z - \\frac{1+q_0}{2}z^2 + z^2 + O(z^3)\\right)$$\n$$D_L(z) = \\frac{c}{H_0}\\left(z + \\left(1 - \\frac{1+q_0}{2}\\right)z^2 + O(z^3)\\right)$$\nThis gives the required second-order expansion for the luminosity distance:\n$$D_L(z) = \\frac{c}{H_0}\\left(z + \\frac{1-q_0}{2}z^2 + O(z^3)\\right)$$\n\n### Part 2: The Deceleration Parameter\n\nThe deceleration parameter $q_0$ is derived from the Friedmann and fluid equations. For a flat universe ($k=0$), the first Friedmann equation is $H^2 = \\frac{8\\pi G}{3c^2}\\rho_{tot}$, where we use energy density $\\rho_{tot}$ in units of energy per volume. The second Friedmann equation (or Raychaudhuri equation) is $\\dot{H} + H^2 = -\\frac{4\\pi G}{3c^2}(\\rho_{tot} + 3P_{tot})$.\nThe deceleration parameter is $q = -\\frac{\\ddot{a}a}{\\dot{a}^2} = -(\\frac{\\dot{H}}{H^2}+1)$.\nSubstituting $\\dot{H} = -\\frac{4\\pi G}{3c^2}(\\rho_{tot} + 3P_{tot}) - H^2$ into the expression for $q$:\n$$q = -\\left(\\frac{-\\frac{4\\pi G}{3c^2}(\\rho_{tot} + 3P_{tot}) - H^2}{H^2} + 1\\right) = \\frac{\\frac{4\\pi G}{3c^2}(\\rho_{tot} + 3P_{tot})}{H^2} = \\frac{\\frac{4\\pi G}{3c^2}(\\rho_{tot} + 3P_{tot})}{\\frac{8\\pi G}{3c^2}\\rho_{tot}}$$\n$$q = \\frac{1}{2}\\frac{\\rho_{tot} + 3P_{tot}}{\\rho_{tot}} = \\frac{1}{2}\\left(1 + 3\\frac{P_{tot}}{\\rho_{tot}}\\right)$$\nThe total energy density and pressure are sums over all components: $\\rho_{tot} = \\sum_i \\rho_i$ and $P_{tot} = \\sum_i P_i$. Each component has an equation of state $P_i = w_i \\rho_i$.\n$$q = \\frac{1}{2}\\left(1 + 3\\frac{\\sum_i w_i \\rho_i}{\\sum_j \\rho_j}\\right)$$\nUsing the definition of the density parameter $\\Omega_i = \\rho_i/\\rho_c$, where $\\rho_c = \\frac{3c^2H^2}{8\\pi G}$ is the critical density. For a flat universe, $\\rho_{tot} = \\rho_c$, so $\\sum_i \\Omega_i = 1$.\nThe expression for $q$ at the present day ($z=0$) becomes:\n$$q_0 = \\frac{1}{2}\\left(1 + 3\\frac{\\sum_i w_i \\Omega_i \\rho_c}{\\sum_j \\Omega_j \\rho_c}\\right) = \\frac{1}{2}\\left(1 + 3\\frac{\\sum_i w_i \\Omega_i}{\\sum_j \\Omega_j}\\right) = \\frac{1}{2}\\left(1 + 3\\sum_i w_i \\Omega_i\\right)$$\nwhere the $\\Omega_i$ here are the present-day values. For the given mixture of non-relativistic matter ($w_m=0$), radiation ($w_r=1/3$), and a cosmological constant ($w_\\Lambda=-1$), this specializes to:\n$$q_0 = \\frac{1}{2}(1 + 3(w_m\\Omega_m + w_r\\Omega_r + w_\\Lambda\\Omega_\\Lambda))$$\n$$q_0 = \\frac{1}{2}(1 + 3(0 \\cdot \\Omega_m + \\frac{1}{3}\\Omega_r - 1 \\cdot \\Omega_\\Lambda)) = \\frac{1}{2}(1 + \\Omega_r - 3\\Omega_\\Lambda)$$\nUsing the flatness condition $\\Omega_m + \\Omega_r + \\Omega_\\Lambda = 1$, we can write $\\Omega_\\Lambda = 1 - \\Omega_m - \\Omega_r$.\n$$q_0 = \\frac{1}{2}(1 + \\Omega_r - 3(1 - \\Omega_m - \\Omega_r)) = \\frac{1}{2}(1 + \\Omega_r - 3 + 3\\Omega_m + 3\\Omega_r)$$\n$$q_0 = \\frac{1}{2}(-2 + 3\\Omega_m + 4\\Omega_r) = \\frac{3}{2}\\Omega_m + 2\\Omega_r - 1$$\nAlternatively, a more common form is:\n$$q_0 = \\frac{1}{2}\\Omega_m + \\Omega_r - \\Omega_\\Lambda$$\nThese two forms are equivalent under the flatness constraint. We will use the latter for simplicity.\n\n### Part 3: Numerical Calculation of Fractional Change\n\nWe need to compute $\\Delta = \\frac{D_{L}^{(\\mathrm{with}~\\Omega_{r})} - D_{L}^{(\\mathrm{no~radiation})}}{D_{L}^{(\\mathrm{no~radiation})}}$ at $z=0.1$.\nUsing the derived expansion $D_L(z) = \\frac{c}{H_0}(z + \\frac{1-q_0}{2}z^2)$, the factor $\\frac{c}{H_0}$ will cancel in the ratio.\n\nCase 1: \"with radiation\"\nThe density parameters are $\\Omega_m = 0.3$, $\\Omega_r = 9 \\times 10^{-5}$.\nFlatness implies $\\Omega_\\Lambda = 1 - \\Omega_m - \\Omega_r = 1 - 0.3 - 0.00009 = 0.69991$.\nThe deceleration parameter is:\n$$q_{0}^{(\\mathrm{with r})} = \\frac{1}{2}\\Omega_{m} + \\Omega_{r} - \\Omega_{\\Lambda} = \\frac{1}{2}(0.3) + 9 \\times 10^{-5} - 0.69991 = 0.15 + 0.00009 - 0.69991 = -0.54982$$\nThe term relevant for $D_L$ at $z=0.1$ is:\n$$X_{\\mathrm{with~r}} \\equiv z + \\frac{1-q_{0}^{(\\mathrm{with r})}}{2}z^2 = 0.1 + \\frac{1 - (-0.54982)}{2}(0.1)^2 = 0.1 + \\frac{1.54982}{2}(0.01) = 0.1 + 0.0077491 = 0.1077491$$\n\nCase 2: \"no radiation\"\nThe density parameters are $\\Omega_m = 0.3$, $\\Omega_r = 0$.\nFlatness implies $\\Omega_\\Lambda = 1 - \\Omega_m = 1 - 0.3 = 0.7$.\nThe deceleration parameter is:\n$$q_{0}^{(\\mathrm{no r})} = \\frac{1}{2}\\Omega_{m} + \\Omega_{r} - \\Omega_{\\Lambda} = \\frac{1}{2}(0.3) + 0 - 0.7 = 0.15 - 0.7 = -0.55$$\nThe term relevant for $D_L$ at $z=0.1$ is:\n$$X_{\\mathrm{no~r}} \\equiv z + \\frac{1-q_{0}^{(\\mathrm{no r})}}{2}z^2 = 0.1 + \\frac{1 - (-0.55)}{2}(0.1)^2 = 0.1 + \\frac{1.55}{2}(0.01) = 0.1 + 0.00775 = 0.10775$$\n\nNow, we compute the fractional change $\\Delta$:\n$$\\Delta = \\frac{D_{L}^{(\\mathrm{with r})} - D_L^{(\\mathrm{no r})}}{D_L^{(\\mathrm{no r})}} = \\frac{\\frac{c}{H_0}X_{\\mathrm{with~r}} - \\frac{c}{H_0}X_{\\mathrm{no~r}}}{\\frac{c}{H_0}X_{\\mathrm{no~r}}} = \\frac{X_{\\mathrm{with~r}} - X_{\\mathrm{no~r}}}{X_{\\mathrm{no~r}}}$$\n$$\\Delta = \\frac{0.1077491 - 0.10775}{0.10775} = \\frac{-0.0000009}{0.10775} \\approx -8.352668 \\times 10^{-6}$$\nRounding the result to four significant figures, we get:\n$$\\Delta \\approx -8.353 \\times 10^{-6}$$\nThe negative sign indicates that including radiation slightly decreases the luminosity distance at this redshift and order of expansion, because radiation contributes more to deceleration than matter for the same energy density, increasing $q_0$, which in turn decreases the $(1-q_0)$ term in the $D_L$ formula.",
            "answer": "$$\\boxed{-8.353 \\times 10^{-6}}$$"
        }
    ]
}