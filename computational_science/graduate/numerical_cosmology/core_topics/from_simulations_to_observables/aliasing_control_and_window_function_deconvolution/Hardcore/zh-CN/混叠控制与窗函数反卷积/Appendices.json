{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将具体地检验你对混叠效应基本原理的理解。通过亲手计算一个特定的高频模式如何被错误地映射到离散网格上的一个低频位置，你将对谱混叠的核心机制获得直观的感受。",
            "id": "3464891",
            "problem": "考虑一个边长为 $L$ 的立方盒子中的三维周期性宇宙学密度场，该场在每个维度有 $N$ 个点的均匀笛卡尔网格上进行采样。设网格间距为 $\\Delta x = L/N$。通过快速傅里叶变换 (FFT) 计算得到的测量离散傅里叶变换 (DFT)，返回在整数波数格点 $\\boldsymbol{r} \\in \\mathbb{Z}^{3}$ 上的傅里叶系数，对于偶数 $N$，每个分量都限制在主立方体 $\\boldsymbol{r} \\in [-N/2,N/2)$ 内。相应的物理波矢量为 $\\boldsymbol{k} = (2\\pi/L)\\,\\boldsymbol{r}$。由于场是经过采样的，DFT 会将所有带外格点模式 $\\boldsymbol{r}_{0} \\notin [-N/2,N/2)$ 通过沿每个笛卡尔分量进行模 $N$ 同余的识别，混叠到主立方体中，这是采样定理和泊松求和公式的结果。质量分配使用 Cloud-In-Cell (CIC) 方案，并通过将测量到的谱除以傅里叶空间 CIC 窗函数来进行窗函数反卷积。CIC 窗函数影响振幅，但不改变整数格点索引之间的混叠映射。\n\n给定以下具体设置：\n- 网格在每个维度上有 $N = 8$ 个点。\n- 底层连续场的支撑集仅限于球形紫外截断 $k_{\\mathrm{cut}} = (2\\pi/L)\\,R$（其中 $R = 10$），即只有满足 $|\\boldsymbol{r}_{0}|^{2} \\le R^{2}$ 的整数格点波矢量 $\\boldsymbol{r}_{0}$ 才能非零，其中 $|\\cdot|$ 表示整数格点上的欧几里得范数。\n- 考虑特定的带外模式 $\\boldsymbol{k}_{0} = (2\\pi/L)\\,(5,-1,5)$，该模式位于主立方体之外，因为每个分量 $r_{0,i}$ 必须满足 $r_{0,i} \\in [-N/2, N/2)$（其中 $N/2 = 4$），而此处有两个分量为 $5$。\n\n任务：\n1. 仅使用 DFT 采样和周期性边界条件的基本事实，计算整数索引 $\\boldsymbol{r}_{0}=(5,-1,5)$ 在混叠作用下映射到的带内混叠格点位置 $\\boldsymbol{r}_{a}$，并由此计算出物理带内波矢量 $\\boldsymbol{k}_{a} = (2\\pi/L)\\,\\boldsymbol{r}_{a}$。\n2. 在紫外截断 $|\\boldsymbol{r}_{0}|^{2} \\le R^{2}$ 内，确定当卷绕到主立方体中时，混叠到同一个 $\\boldsymbol{r}_{a}$ 的不同带外整数格点波矢量 $\\boldsymbol{r}_{0}$ 的重数 $M$。仅计算带外贡献者，即排除任何已经位于主立方体内的 $\\boldsymbol{r}_{0}$。\n3. 将你的最终答案表示为一个单行矩阵，其中包含 $\\boldsymbol{r}_{a}$ 的三个分量，后跟重数 $M$。\n\n无需四舍五入。最终答案中不要报告单位。CIC 窗函数及其反卷积不会改变 $\\boldsymbol{r}_{0}$到 $\\boldsymbol{r}_{a}$ 的映射，但它们为在数值宇宙学中控制混叠提供了动机；请将计算重点放在如上定义的混叠映射和重数上。",
            "solution": "用户想要解决一个关于宇宙学场离散傅里叶变换中混叠的问题。\n\n### 问题验证\n\n首先，我必须验证问题陈述。\n\n**第 1 步：提取已知条件**\n-   考虑一个边长为 $L$ 的立方盒子中的三维周期性宇宙学密度场。\n-   该场在每个维度有 $N$ 个点的均匀笛卡尔网格上采样。\n-   网格间距：$\\Delta x = L/N$。\n-   DFT 通过 FFT 计算。\n-   傅里叶系数位于整数波数格点 $\\boldsymbol{r} \\in \\mathbb{Z}^{3}$ 上。\n-   对于偶数 $N$，主立方体在每个分量上为 $\\boldsymbol{r} \\in [-N/2, N/2)$。\n-   物理波矢量为 $\\boldsymbol{k} = (2\\pi/L)\\,\\boldsymbol{r}$。\n-   混叠规则：带外格点模式 $\\boldsymbol{r}_{0} \\notin [-N/2,N/2)$ 通过沿每个笛卡尔分量进行模 $N$ 同余识别，映射到主立方体中。\n-   质量分配使用 Cloud-In-Cell (CIC)，但其对振幅的影响在本问题中可忽略。\n-   每个维度的网格点数：$N = 8$。\n-   底层连续场有一个紫外截断 $k_{\\mathrm{cut}} = (2\\pi/L)\\,R$，其中 $R = 10$。\n-   这个截断意味着只有满足 $|\\boldsymbol{r}_{0}|^{2} \\le R^{2}$ 的整数格点波矢量 $\\boldsymbol{r}_{0}$ 才能非零。\n-   需要考虑的特定带外模式：$\\boldsymbol{r}_{0}=(5,-1,5)$。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题基于数字信号处理（特别是离散傅里叶变换）在数值宇宙学中应用的标准、成熟的原理。混叠、网格采样和窗函数（如 CIC）是该领域的基本概念。设置是科学合理的。\n-   **适定性：** 问题提供了所有必要的参数（$N=8$, $R=10$, 以及具体模式 $\\boldsymbol{r}_{0}$），并定义了求解唯一解所需的所有术语（主立方体、混叠规则）。任务规定清晰。\n-   **客观性：** 语言精确、技术性强，没有主观性或歧义。\n-   问题没有违反说明中列出的任何无效标准。它是指定领域内一个可形式化且相关的练习。\n\n**第 3 步：结论与行动**\n问题有效。我将继续进行解答。\n\n### 解答\n\n根据问题任务，解答分为两个部分。\n\n**任务 1：计算带内混叠格点位置 $\\boldsymbol{r}_{a}$**\n\n问题指出，一个带外整数格点索引 $\\boldsymbol{r}_{0} = (r_{0,x}, r_{0,y}, r_{0,z})$ 会混叠到主立方体内的一个带内索引 $\\boldsymbol{r}_{a} = (r_{a,x}, r_{a,y}, r_{a,z})$。对于偶数 $N$，主立方体定义为每个分量都在 $[-N/2, N/2)$ 范围内的整数集合。\n\n给定 $N=8$，每个分量的主范围是 $[-8/2, 8/2)$，即 $[-4, 4)$。此范围内的整数为 $\\{-4, -3, -2, -1, 0, 1, 2, 3\\}$。\n\n混叠规则是模 $N$ 同余。一个整数 $j$ 通过关系 $j' = j + mN$ 映射到范围 $[-N/2, N/2)$ 内的一个唯一整数 $j'$，其中整数 $m$ 能将结果带入指定范围。这等同于求 $j$ 对 $N$ 的余数，然后将其调整到对称范围。此映射的一个标准公式是 $j' = (j + N/2) \\pmod{N} - N/2$。让我们将此公式应用于给定带外模式 $\\boldsymbol{r}_{0}=(5,-1,5)$ 的每个分量。\n\n对于 x-分量，$r_{0,x} = 5$：\n$r_{a,x} = (5 + 8/2) \\pmod{8} - 8/2 = (5+4) \\pmod{8} - 4 = 9 \\pmod{8} - 4 = 1 - 4 = -3$。\n值 $r_{a,x}=-3$ 在范围 $[-4, 3]$ 内。\n\n对于 y-分量，$r_{0,y} = -1$：\n$r_{a,y} = (-1 + 8/2) \\pmod{8} - 8/2 = (-1+4) \\pmod{8} - 4 = 3 \\pmod{8} - 4 = 3 - 4 = -1$。\n值 $r_{a,y}=-1$ 在范围 $[-4, 3]$ 内。\n\n对于 z-分量，$r_{0,z} = 5$：\n这与 x-分量相同，所以 $r_{a,z} = -3$。值 $r_{a,z}=-3$ 在范围 $[-4, 3]$ 内。\n\n因此，带内混叠格点位置为 $\\boldsymbol{r}_{a} = (-3, -1, -3)$。相应的物理波矢量为 $\\boldsymbol{k}_{a} = (2\\pi/L)(-3, -1, -3)$。\n\n**任务 2：确定带外贡献者的重数 $M$**\n\n我们需要找到满足以下三个标准的不同整数格点波矢量 $\\boldsymbol{r}_{0}$ 的数量：\n1.  它们混叠到 $\\boldsymbol{r}_{a}=(-3, -1, -3)$。\n2.  它们在紫外截断范围内，即 $|\\boldsymbol{r}_{0}|^{2} \\le R^{2}$，其中 $R=10$。\n3.  它们是“带外的”，意味着它们不等于 $\\boldsymbol{r}_{a}$ 本身。\n\n任何混叠到 $\\boldsymbol{r}_{a}$ 的矢量 $\\boldsymbol{r}_{0}$ 都可以写成 $\\boldsymbol{r}_{0} = \\boldsymbol{r}_{a} + N \\boldsymbol{m}$ 的形式，其中 $\\boldsymbol{m} = (m_x, m_y, m_z) \\in \\mathbb{Z}^{3}$ 是一个整数矢量。\n代入已知值，我们得到：\n$$ \\boldsymbol{r}_{0} = (-3, -1, -3) + 8(m_x, m_y, m_z) = (8m_x - 3, 8m_y - 1, 8m_z - 3) $$\n$\\boldsymbol{r}_{0}$ 是带外的条件意味着 $\\boldsymbol{m} \\neq (0, 0, 0)$。如果 $\\boldsymbol{m}=(0,0,0)$，那么 $\\boldsymbol{r}_{0} = \\boldsymbol{r}_{a}$，这是带内的。\n\n紫外截断条件是 $|\\boldsymbol{r}_{0}|^{2} \\le 10^{2}$，即：\n$$ (8m_x - 3)^2 + (8m_y - 1)^2 + (8m_z - 3)^2 \\le 100 $$\n我们需要找到满足此不等式的整数矢量 $\\boldsymbol{m} \\neq \\mathbf{0}$ 的数量。让我们分别分析 $\\boldsymbol{m}$ 的每个分量可能的整数值。\n\n对于 $m_x$：项 $(8m_x - 3)^2$ 必须小于或等于 $100$。\n$|8m_x - 3| \\le 10 \\implies -10 \\le 8m_x - 3 \\le 10 \\implies -7 \\le 8m_x \\le 13 \\implies -0.875 \\le m_x \\le 1.625$。$m_x$ 可能的整数值为 $0$ 和 $1$。\n\n对于 $m_y$：项 $(8m_y - 1)^2$ 必须小于或等于 $100$。\n$|8m_y - 1| \\le 10 \\implies -10 \\le 8m_y - 1 \\le 10 \\implies -9 \\le 8m_y \\le 11 \\implies -1.125 \\le m_y \\le 1.375$。$m_y$ 可能的整数值为 $-1$、$0$ 和 $1$。\n\n对于 $m_z$：约束条件与 $m_x$ 相同，所以 $m_z$ 可能的整数值为 $0$ 和 $1$。\n\n现在，我们测试集合 $\\{0, 1\\} \\times \\{-1, 0, 1\\} \\times \\{0, 1\\}$ 中 $(m_x, m_y, m_z)$ 的所有可能组合（不包括 $\\boldsymbol{m}=(0,0,0)$），并检查它们是否满足不等式。\n设 $S(\\boldsymbol{m}) = (8m_x - 3)^2 + (8m_y - 1)^2 + (8m_z - 3)^2$。\n\n平方项为：\n-   如果 $m_x=0$：$(8(0)-3)^2=9$。如果 $m_x=1$：$(8(1)-3)^2=25$。\n-   如果 $m_y=-1$：$(8(-1)-1)^2=81$。如果 $m_y=0$：$(8(0)-1)^2=1$。如果 $m_y=1$：$(8(1)-1)^2=49$。\n-   如果 $m_z=0$：$(8(0)-3)^2=9$。如果 $m_z=1$：$(8(1)-3)^2=25$。\n\n我们枚举非零整数矢量 $\\boldsymbol{m}$ 并计算 $S(\\boldsymbol{m})$：\n1.  $\\boldsymbol{m}=(0,0,1)$：$S = 9 + 1 + 25 = 35 \\le 100$。(有效)\n2.  $\\boldsymbol{m}=(0,1,0)$：$S = 9 + 49 + 9 = 67 \\le 100$。(有效)\n3.  $\\boldsymbol{m}=(0,1,1)$：$S = 9 + 49 + 25 = 83 \\le 100$。(有效)\n4.  $\\boldsymbol{m}=(1,0,0)$：$S = 25 + 1 + 9 = 35 \\le 100$。(有效)\n5.  $\\boldsymbol{m}=(1,0,1)$：$S = 25 + 1 + 25 = 51 \\le 100$。(有效)\n6.  $\\boldsymbol{m}=(1,1,0)$：$S = 25 + 49 + 9 = 83 \\le 100$。(有效)\n7.  $\\boldsymbol{m}=(1,1,1)$：$S = 25 + 49 + 25 = 99 \\le 100$。(有效)\n8.  $\\boldsymbol{m}=(0,-1,0)$：$S = 9 + 81 + 9 = 99 \\le 100$。(有效)\n9.  $\\boldsymbol{m}=(0,-1,1)$：$S = 9 + 81 + 25 = 115 > 100$。(无效)\n10. $\\boldsymbol{m}=(1,-1,0)$：$S = 25 + 81 + 9 = 115 > 100$。(无效)\n11. $\\boldsymbol{m}=(1,-1,1)$：$S = 25 + 81 + 25 = 131 > 100$。(无效)\n\n$\\boldsymbol{m}=(0,0,0)$ 的情况对应于带内模式 $\\boldsymbol{r}_a$ 本身，其 $S=9+1+9=19 \\le 100$，但不包括在计数 $M$ 中。\n计算有效的非零矢量 $\\boldsymbol{m}$ 的数量，我们发现有 $8$ 个这样的矢量。每个都对应一个唯一的、不同的、混叠到 $\\boldsymbol{r}_a$ 的带外模式 $\\boldsymbol{r}_0$。\n因此，重数为 $M=8$。\n\n**任务 3：最终答案的构建**\n\n最终答案要求是包含 $\\boldsymbol{r}_{a}$ 的三个分量及重数 $M$ 的单行矩阵。\n$\\boldsymbol{r}_{a}$ 的分量是 $(-3, -1, -3)$，重数是 $M=8$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-3  -1  -3  8\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了混叠效应的基础上，本练习将探讨一种强大的抑制技术：交错采样 (interlacing)。你将为幂律谱分析推导交错采样所能实现的混叠污染减少量，从而定量地理解其有效性。这个练习突显了理论分析如何揭示数值算法的性能。",
            "id": "3464881",
            "problem": "一个共动长度为 $L$ 的一维周期性宇宙学密度场 $\\delta(x)$ 被采样到一个由 $N$ 个单元组成的均匀网格上，网格间距为 $\\Delta x = L/N$。网格采样使用云中单元（CIC）质量分配方案，其一维傅里叶空间窗函数为 $W_{\\mathrm{CIC}}(k) = \\mathrm{sinc}(k \\Delta x / 2)^{2}$，其中 $\\mathrm{sinc}(y) \\equiv \\sin(y)/y$。网格化场的离散傅里叶变换（DFT）用于估计波数 $k$ 在 $0  k \\leq k_{\\mathrm{Ny}}$ 范围内的功率谱 $P(k)$，其中奈奎斯特波数为 $k_{\\mathrm{Ny}} = \\pi/\\Delta x$。为了消除质量分配窗对测量功率的影响，应用了常规的窗函数反卷积，即用测量功率除以 $|W_{\\mathrm{CIC}}(k)|^{2}$。\n\n离散采样会产生混叠：在傅里叶模式 $k$ 处的反卷积估计量包含了来自所有非零整数 $m$ 的波数 $k + 2 m k_{\\mathrm{Ny}}$ 处真实场的贡献。通过将原始网格的DFT与一个偏移了 $\\Delta x/2$ 的第二网格的DFT进行平均来进行交错，这会抵消奇数 $m$ 的贡献。\n\n假设真实的潜在功率谱是纯幂律 $P(k) = A k^{-3}$，其中振幅为常数 $A>0$。定义无量纲波数 $q \\equiv k/k_{\\mathrm{Ny}}$，其中 $0  q \\leq 1$。忽略散粒噪声以及超出前导阶混叠项的任何效应。在这些假设下，并对每种情况仅使用最近的幸存混叠镜像：\n- 对于非交错估计量，保留 $m = +1$ 和 $m = -1$。\n- 对于交错估计量，保留 $m = +2$ 和 $m = -2$（因为奇数 $m$ 被抵消）。\n\n从上述采样和窗函数定义出发，推导非交错、窗函数反卷积估计量的前导阶残余混叠分数 $F_{0}(q)$，其定义为混叠贡献总和与 $k$ 处真实功率的比值。类似地，推导交错、窗函数反卷积估计量的 $F_{\\mathrm{int}}(q)$。然后，提供比值\n$$\nS(q) \\equiv \\frac{F_{\\mathrm{int}}(q)}{F_{0}(q)} \\, ,\n$$\n的封闭形式表达式，作为一个关于 $q$ 的显式解析函数。\n\n将您的最终答案表示为关于 $q$ 的 $S(q)$ 的单个封闭形式解析表达式。无需四舍五入。最终表达式中不需要物理单位。对于 $\\mathrm{sinc}(\\cdot)$ 中隐式涉及的任何三角量，请使用弧度。",
            "solution": "用户希望求出在数值宇宙学中，两种不同功率谱估计量的混叠分数之比。\n\n### 步骤1：提取已知条件\n- **场：** 一个共动长度为 $L$ 的一维周期性宇宙学密度场 $\\delta(x)$。\n- **网格：** 一个由 $N$ 个单元组成的均匀网格，间距为 $\\Delta x = L/N$。\n- **质量分配：** 云中单元（CIC）方案。\n- **CIC窗函数：** $W_{\\mathrm{CIC}}(k) = \\mathrm{sinc}(k \\Delta x / 2)^{2}$，其中 $\\mathrm{sinc}(y) \\equiv \\sin(y)/y$。\n- **波数范围：** $0  k \\leq k_{\\mathrm{Ny}}$。\n- **奈奎斯特波数：** $k_{\\mathrm{Ny}} = \\pi/\\Delta x$。\n- **窗函数反卷积：** 用测量功率除以 $|W_{\\mathrm{CIC}}(k)|^{2}$。\n- **混叠：** 在 $k$ 处的反卷积估计量包含来自所有非零整数 $m$ 的波数 $k_m = k + 2 m k_{\\mathrm{Ny}}$ 的贡献。\n- **交错：** 将原始网格的DFT与一个偏移了 $\\Delta x/2$ 的网格的DFT进行平均，这会抵消来自奇数 $m$ 的贡献。\n- **真实功率谱：** $P(k) = A k^{-3}$，对于一个常数振幅 $A>0$。由于实数场的功率谱必须是偶函数，我们将其解释为 $P(k) = A |k|^{-3}$。\n- **无量纲波数：** $q \\equiv k/k_{\\mathrm{Ny}}$，其中 $0  q \\leq 1$。\n- **近似：**\n    - 忽略散粒噪声和超出前导阶混叠的效应。\n    - 非交错估计量：仅保留 $m = +1$ 和 $m = -1$ 的混叠项。\n    - 交错估计量：仅保留 $m = +2$ 和 $m = -2$ 的混叠项。\n- **混叠分数的定义：**\n    - $F_{0}(q)$：非交错估计量的混叠贡献总和与真实功率之比。\n    - $F_{\\mathrm{int}}(q)$：交错估计量的混叠贡献总和与真实功率之比。\n- **目标：** 求出比值 $S(q) \\equiv F_{\\mathrm{int}}(q) / F_{0}(q)$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题使用了数值宇宙学中的标准概念和术语（CIC方案、混叠、功率谱估计、交错）。使用幂律谱是用于分析的常见且有效的简化。该设定在物理上和数学上是连贯的。\n- **适定性：** 问题提供了所有必要的定义、函数和约束，以推导出所要求的比值 $S(q)$ 的唯一解析解。\n- **客观性：** 语言精确且技术性强，没有主观或含糊的陈述。\n\n问题是自洽的、一致的且科学上合理的。未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。我现在将进行求解。\n\n### 推导\n从网格化场测得的功率谱 $\\hat{P}_{\\mathrm{meas}}(k)$ 包含了在所有混叠到 $k$ 的波数 $k'$ 处，真实功率谱 $P(k')$ 的贡献。测量功率的期望值由所有混叠项的总和给出，每一项都由质量分配窗函数大小的平方加权：\n$$\n\\langle \\hat{P}_{\\mathrm{meas}}(k) \\rangle \\propto \\sum_{m=-\\infty}^{\\infty} |W_{\\mathrm{CIC}}(k_m)|^2 P(k_m)\n$$\n其中 $k_m = k + 2 m k_{\\mathrm{Ny}}$。窗函数给定为 $W_{\\mathrm{CIC}}(k) = \\mathrm{sinc}^2(k\\Delta x/2)$，它是实数且非负的，因此 $|W_{\\mathrm{CIC}}(k)| = W_{\\mathrm{CIC}}(k)$。\n\n问题指出，通过将测量功率除以 $|W_{\\mathrm{CIC}}(k)|^2 = (W_{\\mathrm{CIC}}(k))^2$ 来进行窗函数反卷积。得到的反卷积功率估计量 $P_{\\mathrm{dec}}(k)$ 为：\n$$\nP_{\\mathrm{dec}}(k) = \\frac{\\sum_{m=-\\infty}^{\\infty} (W_{\\mathrm{CIC}}(k_m))^2 P(k_m)}{(W_{\\mathrm{CIC}}(k))^2} = P(k) + \\sum_{m \\neq 0} \\left( \\frac{W_{\\mathrm{CIC}}(k_m)}{W_{\\mathrm{CIC}}(k)} \\right)^2 P(k_m)\n$$\n第一项是真实功率，而求和项代表了混叠的总贡献。\n\n混叠分数 $F(k)$ 是混叠贡献总和与真实功率的比值：\n$$\nF(k) = \\frac{\\sum_{m \\neq 0} \\left( \\frac{W_{\\mathrm{CIC}}(k_m)}{W_{\\mathrm{CIC}}(k)} \\right)^2 P(k_m)}{P(k)} = \\sum_{m \\neq 0} \\left( \\frac{W_{\\mathrm{CIC}}(k_m)}{W_{\\mathrm{CIC}}(k)} \\right)^2 \\frac{P(k_m)}{P(k)}\n$$\n\n为了继续进行，我们将所有量用无量纲波数 $q = k/k_{\\mathrm{Ny}}$ 表示。注意 $k\\Delta x = (q k_{\\mathrm{Ny}})(\\pi/k_{\\mathrm{Ny}}) = q\\pi$。\nsinc函数的自变量变为 $k \\Delta x / 2 = q \\pi / 2$。\n混叠波数为 $k_m = k + 2mk_{\\mathrm{Ny}} = (q+2m)k_{\\mathrm{Ny}}$。它们的大小为 $|k_m| = |q+2m|k_{\\mathrm{Ny}}$。对于 $0  q \\leq 1$，我们有 $|q+2m| = q+2m$（对于 $m > 0$）和 $|q+2m| = |2m|-q$（对于 $m  0$）。\n\n窗函数之比为：\n$$\n\\frac{W_{\\mathrm{CIC}}(k_m)}{W_{\\mathrm{CIC}}(k)} = \\frac{\\mathrm{sinc}^2(k_m \\Delta x / 2)}{\\mathrm{sinc}^2(k \\Delta x / 2)} = \\frac{\\mathrm{sinc}^2((q+2m)\\pi/2)}{\\mathrm{sinc}^2(q\\pi/2)}\n$$\n使用 $\\mathrm{sinc}(y+n\\pi) = \\frac{\\sin(y+n\\pi)}{y+n\\pi} = \\frac{(-1)^n \\sin(y)}{y+n\\pi} = \\frac{(-1)^n y \\mathrm{sinc}(y)}{y+n\\pi}$，我们有：\n$\\mathrm{sinc}^2((q+2m)\\pi/2) = \\mathrm{sinc}^2(q\\pi/2 + m\\pi) = \\left(\\frac{\\sin(q\\pi/2 + m\\pi)}{(q+2m)\\pi/2}\\right)^2 = \\left(\\frac{\\sin(q\\pi/2)}{(q+2m)\\pi/2}\\right)^2$。\n$$\n\\frac{W_{\\mathrm{CIC}}(k_m)}{W_{\\mathrm{CIC}}(k)} = \\frac{(\\sin(q\\pi/2) / ((q+2m)\\pi/2))^2}{(\\sin(q\\pi/2) / (q\\pi/2))^2} = \\left(\\frac{q\\pi/2}{(q+2m)\\pi/2}\\right)^2 = \\left(\\frac{q}{q+2m}\\right)^2\n$$\n\n功率谱之比为：\n$$\n\\frac{P(k_m)}{P(k)} = \\frac{A|k_m|^{-3}}{A|k|^{-3}} = \\left(\\frac{|k_m|}{|k|}\\right)^{-3} = \\left(\\frac{|q+2m|k_{\\mathrm{Ny}}}{q k_{\\mathrm{Ny}}}\\right)^{-3} = \\left(\\frac{|q+2m|}{q}\\right)^{-3} = \\left(\\frac{q}{|q+2m|}\\right)^3\n$$\n\n单个混叠模式 $m$ 对混叠分数的贡献为：\n$$\n\\left( \\frac{W_{\\mathrm{CIC}}(k_m)}{W_{\\mathrm{CIC}}(k)} \\right)^2 \\frac{P(k_m)}{P(k)} = \\left[ \\left(\\frac{q}{q+2m}\\right)^2 \\right]^2 \\left(\\frac{q}{|q+2m|}\\right)^3 = \\frac{q^4}{(q+2m)^4} \\frac{q^3}{|q+2m|^3} = \\frac{q^7}{(q+2m)^4 |q+2m|^3}\n$$\n\n**非交错情况 ($F_0(q)$):**\n我们考虑前导阶混叠 $m=\\pm 1$。\n对于 $m=1$：$q+2m = q+2 > 0$。贡献为 $\\left(\\frac{q}{q+2}\\right)^7$。\n对于 $m=-1$：$q+2m = q-2$。由于 $0  q \\leq 1$，我们有 $|q-2|=2-q$。贡献为 $\\frac{q^7}{(q-2)^4(2-q)^3} = \\frac{q^7}{(2-q)^7}$。\n$$\nF_0(q) = \\left(\\frac{q}{2+q}\\right)^7 + \\left(\\frac{q}{2-q}\\right)^7 = q^7 \\left( \\frac{1}{(2+q)^7} + \\frac{1}{(2-q)^7} \\right) = q^7 \\frac{(2-q)^7 + (2+q)^7}{(4-q^2)^7}\n$$\n\n**交错情况 ($F_{\\mathrm{int}}(q)$):**\n我们考虑前导阶幸存混叠 $m=\\pm 2$。\n对于 $m=2$：$q+2m = q+4 > 0$。贡献为 $\\left(\\frac{q}{q+4}\\right)^7$。\n对于 $m=-2$：$q+2m = q-4$。由于 $0  q \\leq 1$，我们有 $|q-4|=4-q$。贡献为 $\\frac{q^7}{(q-4)^4(4-q)^3} = \\frac{q^7}{(4-q)^7}$。\n$$\nF_{\\mathrm{int}}(q) = \\left(\\frac{q}{4+q}\\right)^7 + \\left(\\frac{q}{4-q}\\right)^7 = q^7 \\left( \\frac{1}{(4+q)^7} + \\frac{1}{(4-q)^7} \\right) = q^7 \\frac{(4-q)^7 + (4+q)^7}{(16-q^2)^7}\n$$\n\n**比值 $S(q)$:**\n$$\nS(q) = \\frac{F_{\\mathrm{int}}(q)}{F_0(q)} = \\frac{q^7 \\frac{(4-q)^7 + (4+q)^7}{(16-q^2)^7}}{q^7 \\frac{(2-q)^7 + (2+q)^7}{(4-q^2)^7}} = \\frac{(4-q)^7 + (4+q)^7}{(2-q)^7 + (2+q)^7} \\frac{(4-q^2)^7}{(16-q^2)^7}\n$$\n由于 $4-q^2$ 和 $16-q^2$ 都是正数，我们可以将指数移到整个分数上：\n$$\nS(q) = \\frac{(4-q)^7 + (4+q)^7}{(2-q)^7 + (2+q)^7} \\left( \\frac{4-q^2}{16-q^2} \\right)^7\n$$\n这就是最终的封闭形式表达式。",
            "answer": "$$\n\\boxed{\\frac{(4+q)^7 + (4-q)^7}{(2+q)^7 + (2-q)^7} \\left( \\frac{4-q^2}{16-q^2} \\right)^7}\n$$"
        },
        {
            "introduction": "最后的这项实践将混叠和窗函数的概念融合到一个实用的数值工具中。你将开发并实现一个算法，用以量化不同质量分配方案（如 NGP、CIC、TSC）和不同底层物理谱下的残余混叠偏差。这项练习展示了如何构建一个计算框架来评估和比较宇宙学中的各种数值方法。",
            "id": "3464904",
            "problem": "您将研究一个各向同性功率谱 $P(k)$ 的估计量中的混叠控制和窗函数反卷积问题。该估计量是根据在一个间距为 $\\Delta x$ 的规则三维笛卡尔网格上采样的密度场构建的。该估计量使用快速傅里叶变换（FFT）实现，并且密度是使用可分离的质量分配核分配到网格上的。您将在以下条件下进行研究：潜在的连续功率谱是一个纯幂律 $P(k)\\propto k^n$，其谱指数为 $n\\in\\mathbb{R}$，并且场是周期性的，其基本域足够大，以至于在本问题中可以忽略有限体积效应。\n\n您的推导必须从以下基本依据出发：\n- 采样定理和规则采样的 Poisson 求和公式，它们意味着在一个规则网格上对连续场进行采样，会使其傅里叶变换在波矢空间中周期性地复制，周期由采样频率决定。\n- 卷积定理，它意味着在位形空间中用质量分配核对场进行卷积，相当于在波矢空间中乘以核的傅里叶变换。\n- 宇宙学中使用的标准质量分配核的可分离性。具体来说，考虑以下实空间质量分配方案及其对应的可分离傅里叶空间窗函数（模去一个在功率谱中抵消的全局相位）：\n  - 最近邻网格点 (NGP)：$W_{\\mathrm{NGP}}(\\mathbf{k})=\\prod_{i\\in\\{x,y,z\\}}\\mathrm{sinc}\\!\\left(\\tfrac{1}{2}k_i\\Delta x\\right)$。\n  - 云中网格 (CIC)：$W_{\\mathrm{CIC}}(\\mathbf{k})=\\prod_{i\\in\\{x,y,z\\}}\\mathrm{sinc}\\!\\left(\\tfrac{1}{2}k_i\\Delta x\\right)^{2}$。\n  - 三角形云 (TSC)：$W_{\\mathrm{TSC}}(\\mathbf{k})=\\prod_{i\\in\\{x,y,z\\}}\\mathrm{sinc}\\!\\left(\\tfrac{1}{2}k_i\\Delta x\\right)^{3}$。\n  此处 $\\mathrm{sinc}(x)\\equiv \\sin(x)/x$ 且 $\\mathrm{sinc}(0)=1$。\n\n定义奈奎斯特波数为 $k_{\\mathrm{Nyq}}=\\pi/\\Delta x$，并让第一布里渊区内的离散傅里叶模式满足 $k_i\\in(-k_{\\mathrm{Nyq}},k_{\\mathrm{Nyq}})$，对于每个笛卡尔分量 $i\\in\\{x,y,z\\}$。\n\n任务：\n- 仅从上述依据出发，不引用任何现成的混叠公式，推导一个在第一布里渊区内模式 $\\mathbf{k}$ 处的反卷积功率谱估计量中残余分数混叠偏差的数学上明确的表达式。这里提到的反卷积估计量是通过将傅里叶变换后的网格化场的模的平方除以在 $\\mathbf{k}$ 处求值的窗函数的模的平方得到的。残余分数混叠偏差定义为所有在第一布里渊区外的谱的傅里叶副本所贡献的污染与目标模式处的真实功率 $P(|\\mathbf{k}|)$之比。\n- 将您的表达式特化到各向同性幂律情况 $P(k)\\propto k^{n}$，并明确展示谱指数 $n$ 如何通过采样引起的副本加权了从 $k>k_{\\mathrm{Nyq}}$ 到 $k",
            "solution": "这是一个定义明确且科学上合理的问题，允许从所提供的基本原理直接推导。我们将着手推导残余分数混叠偏差的表达式，将其特化到幂律谱的情况，然后构建其数值评估的算法。\n\n令连续的、潜在的密度对比度场为 $\\delta(\\mathbf{x})$，其傅里叶变换为 $\\tilde{\\delta}(\\mathbf{k})$。该场的统计特性由功率谱 $P(k)$ 描述，通过傅里叶空间中的两点相关函数定义：\n$$\n\\langle \\tilde{\\delta}(\\mathbf{k}) \\tilde{\\delta}^*(\\mathbf{k}') \\rangle_E = (2\\pi)^3 \\delta_D(\\mathbf{k}-\\mathbf{k}') P(k)\n$$\n其中 $\\langle \\cdot \\rangle_E$ 表示系综平均，$\\delta_D$ 是 Dirac delta 函数。\n\n从网格化场构建功率谱估计量的过程涉及两个主要步骤：质量分配和网格采样。\n\n首先，将连续场 $\\delta(\\mathbf{x})$ 与质量分配核 $K(\\mathbf{x})$ 进行卷积，生成一个平滑场 $\\delta_K(\\mathbf{x}) = (\\delta * K)(\\mathbf{x})$。根据卷积定理，此操作对应于傅里叶空间中的乘法：\n$$\n\\tilde{\\delta}_K(\\mathbf{k}) = \\tilde{\\delta}(\\mathbf{k}) W(\\mathbf{k})\n$$\n其中 $W(\\mathbf{k})$ 是核 $K(\\mathbf{x})$ 的傅里叶变换，称为窗函数。\n\n其次，平滑场 $\\delta_K(\\mathbf{x})$ 在间距为 $\\Delta x$ 的规则笛卡尔网格上进行采样。采样后的场可以写为：\n$$\n\\delta_g(\\mathbf{x}) = \\sum_{\\mathbf{j} \\in \\mathbb{Z}^3} \\delta_K(\\mathbf{j} \\Delta x) \\delta_D(\\mathbf{x} - \\mathbf{j} \\Delta x)\n$$\n采样场的傅里叶变换 $\\tilde{\\delta}_g(\\mathbf{k})$ 由 Poisson 求和公式给出，该公式指出，位形空间中的采样导致波矢空间中连续场傅里叶变换的周期性求和。复制的周期是采样波数 $k_s = 2\\pi / \\Delta x$。对于第一布里渊区内的一个模式 $\\mathbf{k}$（对于 $i \\in \\{x,y,z\\}$，$|k_i|  k_{\\mathrm{Nyq}} = \\pi/\\Delta x$），从网格测得的傅里叶振幅（我们记为 $\\hat{\\delta}_{\\mathbf{k}}$）与所有混叠项的总和成正比：\n$$\n\\hat{\\delta}_{\\mathbf{k}} \\propto \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3} \\tilde{\\delta}_K(\\mathbf{k} + \\mathbf{m} k_s) = \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3} \\tilde{\\delta}(\\mathbf{k} + \\mathbf{m} k_s) W(\\mathbf{k} + \\mathbf{m} k_s)\n$$\n向量 $\\mathbf{m} = (m_x, m_y, m_z)$ 是一个整数三元组，索引原始傅里叶空间的复制副本。\n\n网格上的功率谱估计量 $\\hat{P}(\\mathbf{k})$ 是通过对这些傅里叶振幅的模的平方取系综平均来构建的。利用不同波矢 $\\mathbf{k}'$ 的傅里叶模式 $\\tilde{\\delta}(\\mathbf{k}')$ 的统计独立性，交叉项在取系综平均后消失：\n$$\n\\hat{P}(\\mathbf{k}) = \\langle |\\hat{\\delta}_{\\mathbf{k}}|^2 \\rangle_E \\propto \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3} \\langle |\\tilde{\\delta}(\\mathbf{k} + \\mathbf{m} k_s)|^2 \\rangle_E |W(\\mathbf{k} + \\mathbf{m} k_s)|^2\n$$\n代入功率谱 $P(k)$ 的定义，我们得到混叠功率谱：\n$$\n\\hat{P}(\\mathbf{k}) \\propto \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3} P(|\\mathbf{k} + \\mathbf{m} k_s|) |W(\\mathbf{k} + \\mathbf{m} k_s)|^2\n$$\n“反卷积”功率谱估计量是通过将 $\\hat{P}(\\mathbf{k})$ 除以在目标模式处求值的窗函数的模的平方 $|W(\\mathbf{k})|^2$得到的。我们将其表示为 $P_{\\text{deconv}}(\\mathbf{k})$：\n$$\nP_{\\text{deconv}}(\\mathbf{k}) = \\frac{\\hat{P}(\\mathbf{k})}{|W(\\mathbf{k})|^2} \\propto \\frac{1}{|W(\\mathbf{k})|^2} \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3} P(|\\mathbf{k} + \\mathbf{m} k_s|) |W(\\mathbf{k} + \\mathbf{m} k_s)|^2\n$$\n我们可以将和分解为 $\\mathbf{m}=\\mathbf{0}$ 的项和所有其他副本（$\\mathbf{m}\\neq\\mathbf{0}$）的和：\n$$\nP_{\\text{deconv}}(\\mathbf{k}) \\propto \\frac{P(|\\mathbf{k}|) |W(\\mathbf{k})|^2}{|W(\\mathbf{k})|^2} + \\sum_{\\mathbf{m} \\neq \\mathbf{0}} \\frac{P(|\\mathbf{k} + \\mathbf{m} k_s|) |W(\\mathbf{k} + \\mathbf{m} k_s)|^2}{|W(\\mathbf{k})|^2}\n$$\n第一项 $P(|\\mathbf{k}|)$代表我们旨在测量的真实、未混叠的功率。第二项是来自所有其他傅里叶副本的污染，即混叠误差。\n\n残余分数混叠偏差 $B(\\mathbf{k})$ 定义为该污染与真实功率 $P(|\\mathbf{k}|)$ 的比值。这给出了明确的表达式：\n$$\nB(\\mathbf{k}) = \\frac{1}{P(|\\mathbf{k}|)} \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3, \\mathbf{m} \\neq \\mathbf{0}} P(|\\mathbf{k} + \\mathbf{m} k_s|) \\frac{|W(\\mathbf{k} + \\mathbf{m} k_s)|^2}{|W(\\mathbf{k})|^2}\n$$\n这可以重写为：\n$$\nB(\\mathbf{k}) = \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3, \\mathbf{m} \\neq \\mathbf{0}} \\frac{P(|\\mathbf{k} + \\mathbf{m} k_s|)}{P(|\\mathbf{k}|)} \\frac{|W(\\mathbf{k} + \\mathbf{m} k_s)|^2}{|W(\\mathbf{k})|^2}\n$$\n这是残余分数混叠偏差的一般表达式。\n\n接下来，我们将此表达式特化为各向同性幂律谱 $P(k) \\propto k^n$。比例常数在比率中被抵消：\n$$\n\\frac{P(|\\mathbf{k} + \\mathbf{m} k_s|)}{P(|\\mathbf{k}|)} = \\frac{|\\mathbf{k} + \\mathbf{m} k_s|^n}{|\\mathbf{k}|^n} = \\left(\\frac{|\\mathbf{k} + \\mathbf{m} k_s|}{|\\mathbf{k}|}\\right)^n\n$$\n将此代入 $B(\\mathbf{k})$ 的表达式中得到：\n$$\nB(\\mathbf{k}) = \\sum_{\\mathbf{m} \\in \\mathbb{Z}^3, \\mathbf{m} \\neq \\mathbf{0}} \\left(\\frac{|\\mathbf{k} + \\mathbf{m} k_s|}{|\\mathbf{k}|}\\right)^n \\frac{|W(\\mathbf{k} + \\mathbf{m} k_s)|^2}{|W(\\mathbf{k})|^2}\n$$\n此表达式表明，每个位于 $\\mathbf{k} + \\mathbf{m} k_s$ 的混叠模式的贡献由幂律指数 $n$ 加权。对于随 $k$ 下降的谱（例如 $n0$，在宇宙学中很典型），来自高 $k$ 模式的混叠贡献被抑制。相反，对于上升的谱（$n>0$），混叠效应被放大。\n\n此无穷级数的数值评估需要截断。我们被指示在一个有限的整数三元组 $\\mathbf{m}=(m_x,m_y,m_z)$ 的立方体上求和，其中每个分量 $m_i \\in \\{-M, \\dots, M\\}$，$M=3$，并排除中心项 $\\mathbf{m}=\\mathbf{0}$。这种截断的理由在于窗函数项 $|W(\\mathbf{k} + \\mathbf{m} k_s)|^2$ 随 $|\\mathbf{m}|$ 增加而快速衰减。指定的窗函数形式为 $W_p(\\mathbf{k}) = \\prod_{i\\in\\{x,y,z\\}} \\mathrm{sinc}^p(\\frac{1}{2}k_i\\Delta x)$，其中 $p=1, 2, 3$ 分别对应 NGP、CIC 和 TSC。一个混叠项 $\\mathbf{m}$ 涉及：\n$$\n|W_p(\\mathbf{k} + \\mathbf{m} k_s)|^2 = \\prod_{i\\in\\{x,y,z\\}} \\mathrm{sinc}^{2p}\\left(\\frac{1}{2}(k_i+m_i k_s)\\Delta x\\right) = \\prod_{i\\in\\{x,y,z\\}} \\mathrm{sinc}^{2p}\\left(\\frac{k_i\\Delta x}{2} + m_i \\pi\\right)\n$$\n由于对于大的 $|x|$，$\\mathrm{sinc}(x) \\sim 1/x$，窗函数项随 $|\\mathbf{m}|$ 的增加而迅速衰减。具体来说，对于大的 $|\\mathbf{m}|$，乘积中的每一项至少以 $1/|m_i|^{2p}$ 的速度衰减。对于更高阶的方案（更大的 $p$），抑制作用更强。\n对于 CIC ($p=2$) 和 TSC ($p=3$)，这种衰减异常迅速（在 $\\mathbf{m}$-空间的渐近角落分别约为 $|\\mathbf{m}|^{-12}$ 和 $|\\mathbf{m}|^{-18}$），确保对于典型的谱指数，来自 $|\\mathbf{m}|>3$ 的贡献可以忽略不计。\n对于 NGP ($p=1$)，收敛较慢。然而，通过在 $M=3$ 处指定的截断，该算法仍然对 $(2M+1)^3 - 1 = 7^3-1 = 342$ 个最近且最重要的混叠向量进行求和。这为本问题的目的提供了对总偏差的受控且充分的近似，捕捉了主要的贡献。\n\n算法流程如下：\n1.  将总偏差 $B$ 初始化为 $0$。\n2.  对于给定的测试案例（窗函数类型 $p$，谱指数 $n$，向量 $\\mathbf{k}$），计算分母项 $|\\mathbf{k}|^n$ 和 $|W_p(\\mathbf{k})|^2$。\n3.  遍历整数三元组 $\\mathbf{m} = (m_x, m_y, m_z)$，其中每个分量范围从 $-M$ 到 $M$（$M=3$）。\n4.  如果 $\\mathbf{m} = (0,0,0)$，跳过该次迭代。\n5.  对于每个 $\\mathbf{m} \\neq \\mathbf{0}$，计算混叠波矢 $\\mathbf{k}' = \\mathbf{k} + \\mathbf{m} k_s$。\n6.  计算分子项 $|\\mathbf{k}'|^n$ 和 $|W_p(\\mathbf{k}')|^2$。\n7.  计算被加项 $\\left(\\frac{|\\mathbf{k}'|}{|\\mathbf{k}|}\\right)^n \\frac{|W_p(\\mathbf{k}')|^2}{|W_p(\\mathbf{k})|^2}$ 并将其加到总偏差 $B$ 中。\n8.  循环结束后，$B$ 即为残余分数偏差的最终值。\n此过程将为指定的七个测试案例中的每一个实施。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the aliasing control and window function deconvolution problem\n    by deriving and implementing a formula for the residual fractional bias.\n    \"\"\"\n\n    def custom_sinc(x):\n        \"\"\"\n        Computes sinc(x) = sin(x)/x, with sinc(0) = 1.\n        The input x can be a scalar or a numpy array.\n        \"\"\"\n        # Ensure x is a numpy array for consistent behavior\n        x = np.asarray(x)\n        # Initialize result with ones for the x=0 case\n        res = np.ones_like(x, dtype=float)\n        # Create a mask for non-zero elements\n        non_zero_mask = (x != 0)\n        # Compute sin(x)/x for non-zero elements\n        res[non_zero_mask] = np.sin(x[non_zero_mask]) / x[non_zero_mask]\n        return res\n\n    def window_function_sq(k_vec, p, delta_x):\n        \"\"\"\n        Calculates the squared modulus of the window function |W(k)|^2.\n        \n        Args:\n            k_vec (np.ndarray): The 3D wavevector.\n            p (int): The order of the window function (1=NGP, 2=CIC, 3=TSC).\n            delta_x (float): The grid spacing.\n        \n        Returns:\n            float: The value of |W(k)|^2.\n        \"\"\"\n        # The argument of the sinc function is k_i * delta_x / 2\n        args = 0.5 * k_vec * delta_x\n        sinc_vals = custom_sinc(args)\n        # The window function is a product over dimensions, raised to power 2p\n        return np.prod(sinc_vals**(2 * p))\n\n    def calculate_bias(window_type, n, k_vec, delta_x, M):\n        \"\"\"\n        Calculates the residual fractional aliasing bias.\n        \n        Args:\n            window_type (str): 'NGP', 'CIC', or 'TSC'.\n            n (float): The spectral index of the power law P(k) ~ k^n.\n            k_vec (np.ndarray): The 3D wavevector for which to calculate the bias.\n            delta_x (float): The grid spacing.\n            M (int): The truncation limit for the sum over aliases.\n        \n        Returns:\n            float: The calculated residual fractional bias.\n        \"\"\"\n        window_map = {'NGP': 1, 'CIC': 2, 'TSC': 3}\n        p = window_map[window_type]\n\n        k_s = 2.0 * np.pi / delta_x\n        k_mag = np.linalg.norm(k_vec)\n        \n        # This case is not in the test suite but is a necessary guard.\n        if k_mag == 0.0:\n            # P(0) needs careful definition, but any k0 will result in infinite fractional bias.\n            # Returning 0.0 as a practical matter, assuming P(0) is finite and contamination is 0 at k=0.\n            return 0.0\n\n        # Calculate the denominator of the bias term ratio\n        Wk_sq_denom = window_function_sq(k_vec, p, delta_x)\n        if Wk_sq_denom == 0.0:\n            # This would imply infinite deconvolved power, a pathological case.\n            return np.inf\n\n        total_bias = 0.0\n        \n        m_range = range(-M, M + 1)\n        # Loop over the cube of alias indices m = (mx, my, mz)\n        for mx in m_range:\n            for my in m_range:\n                for mz in m_range:\n                    # Exclude the m=0 (non-aliased) term\n                    if mx == 0 and my == 0 and mz == 0:\n                        continue\n                    \n                    m_vec = np.array([mx, my, mz], dtype=float)\n                    k_alias = k_vec + m_vec * k_s\n                    k_alias_mag = np.linalg.norm(k_alias)\n\n                    # Ratio of power spectrum values: ( |k_alias| / |k| )^n\n                    power_ratio = (k_alias_mag / k_mag)**n\n                    \n                    # Ratio of squared window function values: |W(k_alias)|^2 / |W(k)|^2\n                    Wk_alias_sq = window_function_sq(k_alias, p, delta_x)\n                    window_ratio = Wk_alias_sq / Wk_sq_denom\n                    \n                    # Add the contribution from this alias to the total bias\n                    term = power_ratio * window_ratio\n                    total_bias += term\n        \n        return total_bias\n\n    # Define the test cases from the problem statement.\n    delta_x = 1.0\n    k_nyq = np.pi / delta_x\n    M = 3\n    \n    test_cases = [\n        # Case 1: NGP, n=-2, k low\n        ('NGP', -2.0, np.array([0.1, 0.0, 0.0]) * k_nyq),\n        # Case 2: CIC, n=-2, k low\n        ('CIC', -2.0, np.array([0.1, 0.0, 0.0]) * k_nyq),\n        # Case 3: TSC, n=-2, k low\n        ('TSC', -2.0, np.array([0.1, 0.0, 0.0]) * k_nyq),\n        # Case 4: NGP, n=0, k high\n        ('NGP',  0.0, np.array([0.7, 0.0, 0.0]) * k_nyq),\n        # Case 5: CIC, n=0, k high\n        ('CIC',  0.0, np.array([0.7, 0.0, 0.0]) * k_nyq),\n        # Case 6: TSC, n=0, k high\n        ('TSC',  0.0, np.array([0.7, 0.0, 0.0]) * k_nyq),\n        # Case 7: CIC, n=1.5, k diagonal\n        ('CIC',  1.5, np.array([0.4, 0.4, 0.4]) * k_nyq),\n    ]\n\n    results = []\n    for case in test_cases:\n        window_type, n, k_vec = case\n        bias = calculate_bias(window_type, n, k_vec, delta_x, M)\n        results.append(bias)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}